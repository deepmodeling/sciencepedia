{
    "hands_on_practices": [
        {
            "introduction": "要掌握像霍赫洛夫-扎博洛茨卡娅-库兹涅佐夫（KZK）方程这样复杂的模型，一个有效的方法是研究其在简化极限下的行为。本练习将重点探讨弱信号极限，在这种情况下，KZK方程简化为描述线性衍射的众所周知的傍轴波动方程。通过推导此简化方程并求解高斯声束的演化，你将把KZK模型与光学和声学中的基本衍射概念联系起来 。",
            "id": "4143327",
            "problem": "考虑一个热粘性流体，其特征为环境质量密度 $\\rho_{0}$、环境压力 $p_{0}$、小信号声速 $c_{0}$、非线性参数 $\\beta$ 和声扩散系数 $\\delta$。令 $p(\\mathbf{r}_{\\perp},z,\\tau)$ 表示声压，其中 $\\mathbf{r}_{\\perp}=(x,y)$ 是横向坐标，$z$ 是轴向坐标，$\\tau=t-z/c_{0}$ 是延迟时间。混合导数形式的霍赫洛夫-扎博洛茨卡娅-库兹涅佐夫 (Khokhlov-Zabolotskaya-Kuznetsov, KZK) 方程为\n$$\n\\frac{\\partial^{2}p}{\\partial z\\,\\partial \\tau}\n=\n\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}p\n+\n\\frac{\\delta}{2 c_{0}^{3}}\\,\\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n+\n\\frac{\\beta}{2 \\rho_{0} c_{0}^{3}}\\,\\frac{\\partial^{2}}{\\partial \\tau^{2}}\\big(p^{2}\\big),\n$$\n其中 $\\nabla_{\\perp}^{2}=\\frac{\\partial^{2}}{\\partial x^{2}}+\\frac{\\partial^{2}}{\\partial y^{2}}$ 是横向拉普拉斯算子。假设一个角频率为 $\\omega$ 的单色驱动，因此场可以写为 $p(\\mathbf{r}_{\\perp},z,\\tau)=\\Re\\{P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)\\}$，其中 $P$ 是一个在 $z$ 方向缓变的复振幅。在弱信号区 $p\\ll p_{0}$ 内进行分析，并假设在所关注的轴向距离上热粘性吸收可忽略。\n\nA 部分：从 KZK 方程和上述假设出发，论证其可简化为关于复振幅 $P(\\mathbf{r}_{\\perp},z)$ 的经典线性旁轴衍射方程，并用波数 $k=\\omega/c_{0}$ 表示。清晰地说明忽略了哪些项以及原因，使用已陈述的物理假设，并写出得到的 $P$ 的控制方程。\n\nB 部分：考虑一个在 $z=0$ 处的轴对称高斯声束，其复振幅为\n$$\nP(r,0)=P_{0}\\,\\exp\\!\\left(-\\frac{r^{2}}{w_{0}^{2}}\\right),\n$$\n其中 $r=|\\mathbf{r}_{\\perp}|$，$P_{0}$ 是一个常数，$w_{0}$ 是初始束腰半径。在 A 部分中求得的简化线性旁轴衍射方程下，确定声束束腰 $w(z)$ 的轴向演化，使得横向剖面保持高斯形式，即 $P(r,z)$ 的形式（不计相位因子）保持为 $P(r,z)=C(z)\\exp\\!\\big(-r^{2}/w(z)^{2}\\big)$。提供一个关于 $w(z)$ 的闭式解析表达式，用 $w_{0}$、$k$ 和 $z$ 表示。\n\n将任何长度（例如 $w_{0}$ 和 $z$）以米为单位表示，$k$ 以弧度/米为单位表示。您的最终答案必须是单一的闭式解析表达式。最终的方框答案中不要包含单位。",
            "solution": "我们从给定的混合导数形式的霍赫洛夫-扎博洛茨卡娅-库兹涅佐夫 (KZK) 方程开始，\n$$\n\\frac{\\partial^{2}p}{\\partial z\\,\\partial \\tau}\n=\n\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}p\n+\n\\frac{\\delta}{2 c_{0}^{3}}\\,\\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n+\n\\frac{\\beta}{2 \\rho_{0} c_{0}^{3}}\\,\\frac{\\partial^{2}}{\\partial \\tau^{2}}\\big(p^{2}\\big),\n$$\n其中 $\\tau=t-z/c_{0}$ 是延迟时间。假设一个单色场 $p(\\mathbf{r}_{\\perp},z,\\tau)=\\Re\\{P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)\\}$，并为了推导 $P$ 的控制方程，引入复数表示 $p(\\mathbf{r}_{\\perp},z,\\tau)\\approx P(\\mathbf{r}_{\\perp},z)\\exp(i\\omega \\tau)$。在此表示下，时间导数映射为 $\\frac{\\partial}{\\partial \\tau}\\mapsto i\\omega$。左侧变为\n$$\n\\frac{\\partial^{2}p}{\\partial z\\,\\partial \\tau}\\;\\to\\;i\\omega\\,\\frac{\\partial P}{\\partial z}\\,\\exp(i\\omega \\tau).\n$$\n衍射项映射为\n$$\n\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}p \\;\\to\\; \\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}P\\,\\exp(i\\omega \\tau),\n$$\n热粘性吸收项变为\n$$\n\\frac{\\delta}{2 c_{0}^{3}}\\,\\frac{\\partial^{3}p}{\\partial \\tau^{3}}\n\\;\\to\\;\n\\frac{\\delta}{2 c_{0}^{3}}\\,(i\\omega)^{3}P\\,\\exp(i\\omega \\tau)\n=\n-\\;i\\,\\frac{\\delta\\,\\omega^{3}}{2 c_{0}^{3}}\\,P\\,\\exp(i\\omega \\tau),\n$$\n非线性项读作\n$$\n\\frac{\\beta}{2 \\rho_{0} c_{0}^{3}}\\,\\frac{\\partial^{2}}{\\partial \\tau^{2}}\\big(p^{2}\\big)\n\\;\\to\\;\n\\frac{\\beta}{2 \\rho_{0} c_{0}^{3}}\\,(i\\omega)^{2}\\big(P^{2}\\exp(2 i\\omega \\tau)\\big)\n=\n-\\;\\frac{\\beta\\,\\omega^{2}}{2 \\rho_{0} c_{0}^{3}}\\,P^{2}\\,\\exp(2 i\\omega \\tau).\n$$\n在弱信号区 $p\\ll p_{0}$ 中，与 $P^{2}$ 成正比的非线性项与线性项相比可以忽略，因为它与声马赫数的平方成比例，并驱动频率为 $2\\omega$ 的高次谐波，而这些谐波在小振幅下无法维持。此外，我们假设在所关注的传播距离内吸收可忽略，因此与 $\\delta$ 成正比的项被舍去。于是平衡方程简化为\n$$\ni\\omega\\,\\frac{\\partial P}{\\partial z}\\,\\exp(i\\omega \\tau)\n=\n\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}P\\,\\exp(i\\omega \\tau).\n$$\n消去 $\\exp(i\\omega \\tau)$ 并引入波数 $k=\\omega/c_{0}$，得到\n$$\ni\\omega\\,\\frac{\\partial P}{\\partial z}=\\frac{c_{0}}{2}\\,\\nabla_{\\perp}^{2}P\n\\quad\\Longrightarrow\\quad\n2\\,i\\,k\\,\\frac{\\partial P}{\\partial z}+\\nabla_{\\perp}^{2}P=0.\n$$\n这就是关于复振幅 $P(\\mathbf{r}_{\\perp},z)$ 的经典线性旁轴衍射（旁轴亥姆霍兹）方程。\n\n接下来我们确定高斯束腰在此方程下的演化。假设一个轴对称高斯形式\n$$\nP(r,z)=C(z)\\,\\exp\\!\\big(-a(z)\\,r^{2}\\big),\n$$\n其中 $r=|\\mathbf{r}_{\\perp}|$，$a(z)$ 是复宽度参数，$C(z)$ 是复振幅。$z=0$ 处的初始条件为 $P(r,0)=P_{0}\\exp(-r^{2}/w_{0}^{2})$，这设定了 $C(0)=P_{0}$ 和 $a(0)=1/w_{0}^{2}$。\n\n我们计算导数。径向高斯函数的横向拉普拉斯算子满足\n$$\n\\nabla_{\\perp}^{2}\\big[\\exp(-a r^{2})\\big]\n=\n\\big(-4 a+4 a^{2}r^{2}\\big)\\,\\exp(-a r^{2}),\n$$\n所以\n$$\n\\nabla_{\\perp}^{2}P\n=\nC(z)\\,\\big(-4 a(z)+4 a(z)^{2}r^{2}\\big)\\,\\exp\\!\\big(-a(z)\\,r^{2}\\big).\n$$\n轴向导数为\n$$\n\\frac{\\partial P}{\\partial z}\n=\n\\Big(C'(z)-C(z)\\,a'(z)\\,r^{2}\\Big)\\,\\exp\\!\\big(-a(z)\\,r^{2}\\big).\n$$\n代入旁轴方程 $2\\,i\\,k\\,\\partial_{z}P+\\nabla_{\\perp}^{2}P=0$ 并除以 $P=C(z)\\exp(-a(z)r^{2})$，得到\n$$\n2\\,i\\,k\\left(\\frac{C'(z)}{C(z)}-a'(z)\\,r^{2}\\right)+\\big(-4 a(z)+4 a(z)^{2}r^{2}\\big)=0.\n$$\n令 $r$ 的同次幂系数相等，得到一个耦合系统：\n$$\n-\\,2\\,i\\,k\\,a'(z)+4\\,a(z)^{2}=0,\n\\qquad\n2\\,i\\,k\\,\\frac{C'(z)}{C(z)}-4\\,a(z)=0.\n$$\n宽度参数服从里卡蒂方程\n$$\na'(z)=\\frac{2\\,i}{k}\\,a(z)^{2},\n\\qquad\na(0)=\\frac{1}{w_{0}^{2}}.\n$$\n这个可分离方程积分得\n$$\n\\frac{d a}{a^{2}}=\\frac{2\\,i}{k}\\,dz\n\\quad\\Longrightarrow\\quad\n-\\frac{1}{a(z)}=\\frac{2\\,i}{k}\\,z - \\frac{1}{a(0)}=\\frac{2\\,i}{k}\\,z - w_{0}^{2},\n$$\n所以\n$$\na(z)=\\frac{1}{w_{0}^{2}-\\frac{2\\,i}{k}\\,z}.\n$$\n将 $a(z)$ 用其实部表示，以确定物理束腰 $w(z)$。根据高斯包络的定义，振幅剖面为 $|P(r,z)|\\propto \\exp\\!\\big(-\\operatorname{Re}[a(z)]\\,r^{2}\\big)$，所以束腰满足\n$$\n\\operatorname{Re}\\big[a(z)\\big]=\\frac{1}{w(z)^{2}}.\n$$\n使用 $a(z)=\\big(w_{0}^{2}-i\\,\\alpha\\big)^{-1}$，其中 $\\alpha=(2 z)/k$，我们有\n$$\na(z)=\\frac{w_{0}^{2}+i\\,\\alpha}{w_{0}^{4}+\\alpha^{2}},\n\\qquad\n\\operatorname{Re}\\big[a(z)\\big]=\\frac{w_{0}^{2}}{w_{0}^{4}+\\alpha^{2}}.\n$$\n因此\n$$\n\\frac{1}{w(z)^{2}}=\\frac{w_{0}^{2}}{w_{0}^{4}+\\alpha^{2}}\n\\quad\\Longrightarrow\\quad\nw(z)^{2}=\\frac{w_{0}^{4}+\\alpha^{2}}{w_{0}^{2}}\n=\nw_{0}^{2}+\\frac{\\alpha^{2}}{w_{0}^{2}}\n=\nw_{0}^{2}\\left(1+\\left(\\frac{2 z}{k\\,w_{0}^{2}}\\right)^{2}\\right).\n$$\n取正平方根得到声束束腰的轴向演化：\n$$\nw(z)=w_{0}\\,\\sqrt{1+\\left(\\frac{2 z}{k\\,w_{0}^{2}}\\right)^{2}}.\n$$\n这就是旁轴近似下高斯声束的经典线性衍射定律，其中声学瑞利长度 $z_{R}=k\\,w_{0}^{2}/2$ 由平方根内的分母隐式定义。\n\n以上所有步骤均直接源于 KZK 模型在弱信号极限 $p\\ll p_{0}$（忽略非线性项）和可忽略吸收（舍去热粘性项）的条件下，结合单色激励和旁轴近似推导得出。",
            "answer": "$$\\boxed{w_{0}\\sqrt{1+\\left(\\frac{2 z}{k\\,w_{0}^{2}}\\right)^{2}}}$$"
        },
        {
            "introduction": "在研究了衍射效应之后，我们将注意力转向 KZK 方程中的另外两个关键物理现象：非线性和吸收。通过考虑忽略衍射的平面波极限，我们可以独立地分析和比较这两种相互竞争的效应的强度。本练习将引导你推导激波形成距离和吸收长度等关键指标，从而为判断非线性失真何时变得显著建立起定量的物理直觉 。",
            "id": "4143383",
            "problem": "在热粘性流体中的单色轴对称超声束由霍赫洛夫-扎博洛茨卡娅-库兹涅佐夫 (Khokhlov-Zabolotskaya-Kuznetsov, KZK) 方程建模。在平面波极限（衍射可忽略）下，沿声束轴的演化归结为非线性和吸收的综合效应。从可压缩牛顿流体的一维质量和动量守恒以及二阶状态方程（因此有效二次非线性由系数 $\\,\\beta\\,$ 表征）出发，并利用振幅衰减系数遵循频率的二次定律 $\\,\\alpha(\\omega)=\\alpha_0 \\omega^2\\,$ 的标准线性热粘性结果，完成以下任务：\n\n- 通过分析无粘性极限中的非线性陡峭化，推导角频率为 $\\,\\omega_0\\,$、声压幅值为 $\\,p_0\\,$ 的正弦平面波的激波形成距离 $\\,L_N\\,$，用 $\\,\\rho_0\\,$, $\\,c_0\\,$, $\\,\\beta\\,$, $\\,\\omega_0\\,$ 和 $\\,p_0\\,$ 表示。\n- 使用线性衰减定律，用 $\\,\\alpha(\\omega_0)\\,$ 和波长 $\\,\\lambda_0\\,$ 写出吸收长度 $\\,L_A\\,$ 和每波長衰减 $\\,\\mathcal{A}_\\lambda\\,$ 的表达式。\n- 定义无量纲比率 $\\,R \\equiv L_A/L_N\\,$ 作为吸收与非线性相对重要性的定量度量。如果 $\\,R \\gg 1\\,$，非线性畸变超过吸收；如果 $\\,R \\ll 1\\,$，在发生明显的非线性畸变之前，吸收占主导地位。\n\n给定以下介质和声源参数，计算 $\\,\\mathcal{A}_\\lambda\\,$，然后求 $\\,R\\,$ 的值：\n- 平衡密度 $\\,\\rho_0 = 1000\\,\\mathrm{kg/m^3}$，\n- 小信号声速 $\\,c_0 = 1500\\,\\mathrm{m/s}$，\n- 二次非线性系数 $\\,\\beta = 3.5$，\n- 声压幅值 $\\,p_0 = 3.0 \\times 10^{5}\\,\\mathrm{Pa}$，\n- 载波频率 $\\,f_0 = 1.5 \\times 10^{6}\\,\\mathrm{Hz}$ (所以 $\\,\\omega_0 = 2\\pi f_0\\,$)，\n- 热粘性吸收参数 $\\,\\alpha_0 = 6.0 \\times 10^{-18}\\,\\mathrm{s^2/m}$。\n\n使用 $\\,\\lambda_0 = c_0/f_0\\,$，将 $\\,\\mathcal{A}_\\lambda = \\alpha(\\omega_0)\\lambda_0\\,$ 报告为无量纲的每波长衰减（单位：奈培/波长），然后计算 $\\,R\\,$。将你最终报告的 $\\,R\\,$ 值四舍五入到三位有效数字。将最终答案表示为一个纯数（无量纲）。",
            "solution": "解答过程分三个阶段：首先，推导非线性和吸收的特征长度；其次，构建它们的比率；第三，对所要求的量进行数值计算。\n\n**1. 特征长度的推导**\n\n**激波形成距离, $L_N$**\n在无损耗流体中，声速不是恒定的，而是取决于局部流体性质。对于二阶状态方程，波形上一点的传播速度 $c$ 由 $c = c_0 + \\beta u$ 给出，其中 $c_0$ 是小信号声速，$\\beta$ 是二次非线性系数，$u$ 是质点速度。对于平面行波，声压 $p$ 和质点速度 $u$ 通过介质的特性阻抗相关联，$p = \\rho_0 c_0 u$，其中 $\\rho_0$ 是平衡密度。因此，我们可以用压力来表示局部传播速度：\n$$c = c_0 + \\frac{\\beta p}{\\rho_0 c_0}$$\n该方程表明，较高压力的点比较低压力的点传播得更快。对于一个初始为正弦波 $p(x=0, t) = p_0 \\sin(\\omega_0 t)$，波峰（压力为 $p_0$）以速度 $c_{peak} = c_0 + \\frac{\\beta p_0}{\\rho_0 c_0}$ 传播，而波谷（压力为 $-p_0$）以速度 $c_{trough} = c_0 - \\frac{\\beta p_0}{\\rho_0 c_0}$ 传播。这种速度差异导致波形在传播过程中变陡。\n\n当波形的斜率变为无穷大时，会形成激波或波形中的不连续点。这首先发生在称为激波形成距离 $L_N$ 的地方。一个标准的推导（我们不在此详述）表明，对于初始为正弦的平面波，此距离由下式给出：\n$$L_N = \\frac{c_0^2}{\\beta u_0 \\omega_0}$$\n其中 $u_0 = p_0/(\\rho_0 c_0)$ 是质点速度幅值。代入 $u_0$，我们得到用给定参数表示的激波形成距离：\n$$L_N = \\frac{c_0^2}{\\beta \\left(\\frac{p_0}{\\rho_0 c_0}\\right) \\omega_0} = \\frac{\\rho_0 c_0^3}{\\beta p_0 \\omega_0}$$\n\n**吸收长度, $L_A$, 和每波长衰减, $\\mathcal{A}_\\lambda$**\n问题规定振幅衰减系数 $\\alpha$ 遵循二次频率定律 $\\alpha(\\omega) = \\alpha_0 \\omega^2$，其中 $\\alpha_0$ 是流体的一个特征常数。对于角频率为 $\\omega_0$ 的单色波，衰减系数为 $\\alpha(\\omega_0) = \\alpha_0 \\omega_0^2$。在没有非线性效应的情况下，波幅随距离 $x$ 按 $p_0 \\exp(-\\alpha(\\omega_0) x)$ 指数衰减。吸收长度 $L_A$ 定义为振幅衰减为原来的 $1/e$ 倍时所经过的距离。这意味着 $\\alpha(\\omega_0) L_A = 1$，从而得到：\n$$L_A = \\frac{1}{\\alpha(\\omega_0)} = \\frac{1}{\\alpha_0 \\omega_0^2}$$\n每波长衰减 $\\mathcal{A}_\\lambda$ 是一个无量纲的吸收度量，定义为衰减系数和波长 $\\lambda_0$ 的乘积。波长由 $\\lambda_0 = c_0/f_0 = 2\\pi c_0 / \\omega_0$ 给出。\n$$\\mathcal{A}_\\lambda \\equiv \\alpha(\\omega_0) \\lambda_0 = (\\alpha_0 \\omega_0^2) \\left(\\frac{2\\pi c_0}{\\omega_0}\\right) = 2\\pi \\alpha_0 c_0 \\omega_0$$\n\n**2. 无量纲比率, $R$**\n\n比率 $R = L_A/L_N$ 量化了吸收与非线性的相对重要性。大的 $R$ 值意味着激波形成距离远小于吸收长度，因此非线性效应占主导。小的 $R$ 值意味着波在陡峭化成激波之前就被显著衰减。\n使用上面推导的表达式：\n$$R = \\frac{L_A}{L_N} = \\frac{1/(\\alpha_0 \\omega_0^2)}{(\\rho_0 c_0^3)/(\\beta p_0 \\omega_0)} = \\frac{\\beta p_0 \\omega_0}{\\alpha_0 \\omega_0^2 \\rho_0 c_0^3}$$\n$$R = \\frac{\\beta p_0}{\\alpha_0 \\omega_0 \\rho_0 c_0^3}$$\n这个表达式通常被称为戈德堡数 (Gol'dberg number)，我们将计算它的值。\n\n**3. 数值计算**\n\n给定的参数是：\n- 平衡密度: $\\rho_0 = 1000\\,\\mathrm{kg/m^3}$\n- 小信号声速: $c_0 = 1500\\,\\mathrm{m/s}$\n- 二次非线性系数: $\\beta = 3.5$\n- 声压幅值: $p_0 = 3.0 \\times 10^{5}\\,\\mathrm{Pa}$\n- 载波频率: $f_0 = 1.5 \\times 10^{6}\\,\\mathrm{Hz}$\n- 热粘性吸收参数: $\\alpha_0 = 6.0 \\times 10^{-18}\\,\\mathrm{s^2/m}$\n\n首先，我们计算角频率：\n$$\\omega_0 = 2\\pi f_0 = 2\\pi (1.5 \\times 10^{6}\\,\\mathrm{Hz}) = 3\\pi \\times 10^6\\,\\mathrm{rad/s}$$\n\n现在，我们按要求计算每波长衰减 $\\mathcal{A}_\\lambda$。\n$$\\mathcal{A}_\\lambda = 2\\pi \\alpha_0 c_0 \\omega_0 = 2\\pi (6.0 \\times 10^{-18}\\,\\mathrm{s^2/m})(1500\\,\\mathrm{m/s})(3\\pi \\times 10^6\\,\\mathrm{s^{-1}})$$\n$$\\mathcal{A}_\\lambda = (2\\pi \\times 6.0 \\times 1.5 \\times 10^3 \\times 3\\pi \\times 10^6) \\times 10^{-18} = 54\\pi^2 \\times 10^{-9}$$\n$$\\mathcal{A}_\\lambda \\approx 5.3296 \\times 10^{-7}\\,\\text{（奈培/波长）}$$\n\n接下来，我们计算无量纲比率 $R$：\n$$R = \\frac{\\beta p_0}{\\alpha_0 \\omega_0 \\rho_0 c_0^3}$$\n代入数值：\n$$R = \\frac{(3.5)(3.0 \\times 10^5)}{(6.0 \\times 10^{-18})(3\\pi \\times 10^6)(1000)(1500)^3}$$\n$$R = \\frac{1.05 \\times 10^6}{(6.0 \\times 10^{-18})(3\\pi \\times 10^6)(10^3)(3.375 \\times 10^9)}$$\n$$R = \\frac{1.05 \\times 10^6}{6.0 \\times 3\\pi \\times 3.375 \\times 10^{(-18+6+3+9)}} = \\frac{1.05 \\times 10^6}{60.75\\pi \\times 10^0}$$\n$$R = \\frac{1050000}{60.75\\pi} \\approx 5501.033$$\n问题要求将 $R$ 的最终值四舍五入到三位有效数字。\n$$R \\approx 5.50 \\times 10^3$$\n$R$ 的大值表明，对于给定的参数，非线性效应远强于耗散效应，激波将在波被显著衰减之前早已形成。",
            "answer": "$$\n\\boxed{5.50 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "最后的这项练习旨在搭建起从解析理论到计算实践的桥梁。基于第一个练习的理论基础，你将运用强大的谱方法来实现一个数值求解器，用于模拟线性衍射过程。通过将你的数值计算结果与高斯声束的精确解析解进行比较，你不仅能获得科学计算的实践经验，还能完成代码验证中的一个基本步骤 。",
            "id": "4143330",
            "problem": "考虑一个角频率为 $\\omega$ 的单色轴对称声束，在声速为 $c$ 的热粘性流体中主要沿 $+z$ 方向传播。从线性声波方程和适用于定向声束的缓变包络近似出发，推导 Khokhlov-Zabolotskaya-Kuznetsov (KZK) 方程的线性极限，该极限控制复包络 $U(x,y,z)$ 的衍射，并展示傍轴高斯声束解如何作为所得傍轴模型的精确解出现。然后，设计一个算法，通过数值求解线性傍轴 KZK 模型来计算初始高斯声束的衍射，并将数值结果与您推导的傍轴高斯声束解进行比较。\n\n您的程序必须实现以下内容：\n\n- 使用带有周期性边界条件的二维横向计算域 $(x,y)$ 和谱方法来表示横向拉普拉斯算子。通过选择初始轴对称高斯包络并使用各向同性横向算子来假定轴对称性。不包括非线性或热粘性吸收；严格在线性极限下工作。\n- 对于一组给定的物理参数 $\\{c,\\ f,\\ w_0,\\ z\\}$，其中 $c$ 是声速（单位：$\\mathrm{m/s}$），$f$ 是频率（单位：$\\mathrm{Hz}$），$w_0$ 是初始 $1/e$ 振幅束腰（单位：$\\mathrm{m}$），$z$ 是传播距离（单位：$\\mathrm{m}$），计算\n  - 通过使用单个谱传播步骤求解线性傍轴 KZK 模型，在平面 $z$ 处沿对称线 $y=0$ 的数值包络幅值，以及\n  - 在同一平面沿同一直线的解析傍轴高斯声束包络幅值。\n- 通过在采样线 $y=0$ 上的相对 $\\ell_2$ 误差来衡量差异，该误差定义为数值幅值与解析幅值之差的离散 $\\ell_2$ 范数与解析幅值的离散 $\\ell_2$ 范数之比。这是一个表示为浮点数的无量纲量。\n\n您在解题推导中必须使用的基本原理：\n- 压力脉动 $p$ 的线性声波方程：$\\nabla^2 p - \\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} = 0$。\n- 前向传播声束的缓变包络表示：$p(x,y,z,t) = \\Re\\{U(x,y,z)\\, e^{\\mathrm{i}(k z - \\omega t)}\\}$，其中 $k = \\frac{2\\pi f}{c}$。\n- 忽略后向散射以及包络相对于一阶 $z$ 导数的二阶 $z$ 导数的傍轴、前向散射近似。\n\n数值方法要求：\n- 横向域：选择边长为 $L = 8 w_0$ 的正方形域，并将其在 $N \\times N$ 的均匀网格上离散化，其中 $N=512$，间距为 $\\Delta x = \\Delta y = L/N$（单位：$\\mathrm{m}$）。\n- $z=0$ 处的初始条件：一个轴上振幅为 $U_0 = 1$、 $1/e$ 振幅束腰为 $w_0$ 的轴对称高斯包络，即 $U(x,y,0)$ 在 $r = \\sqrt{x^2 + y^2}$ 上具有高斯振幅。\n- 谱传播：使用空间频率域中线性傍轴 KZK 模型的精确解算子，在单个步骤中从 $z=0$ 传播到 $z$。\n\n解析比较要求：\n- 推导并使用相同参数 $\\{c,\\ f,\\ w_0,\\ z\\}$ 的傍轴高斯声束解，计算沿 $y=0$ 的解析包络幅值。\n- 所有距离单位必须是 $\\mathrm{m}$，频率单位是 $\\mathrm{Hz}$，速度单位是 $\\mathrm{m/s}$。输出的差异必须是一个无量纲的浮点数。\n\n测试套件：\n您的程序必须执行以下四个测试用例。在每个用例中，设置 $U_0 = 1$，$N = 512$，$L = 8 w_0$。\n1. 瑞利范围附近的理想情况：$c = 1500$ $\\mathrm{m/s}$，$f = 1.0 \\times 10^6$ $\\mathrm{Hz}$，$w_0 = 2.0 \\times 10^{-3}$ $\\mathrm{m}$，$z = z_R$，其中 $z_R$ 是您推导所隐含的瑞利范围。\n2. 源平面上的边界条件：与用例 1 相同的 $c$、$f$ 和 $w_0$，但 $z = 0$ $\\mathrm{m}$。\n3. 宽声束（近平面波）在中等距离上的衍射：$c = 1500$ $\\mathrm{m/s}$，$f = 1.0 \\times 10^6$ $\\mathrm{Hz}$，$w_0 = 1.0 \\times 10^{-2}$ $\\mathrm{m}$，$z = 0.05$ $\\mathrm{m}$。\n4. 远场中强衍射的窄声束：$c = 1500$ $\\mathrm{m/s}$，$f = 1.0 \\times 10^6$ $\\mathrm{Hz}$，$w_0 = 5.0 \\times 10^{-4}$ $\\mathrm{m}$，$z = 3 z_R$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的相对 $\\ell_2$ 误差，格式为由方括号括起来的逗号分隔列表，例如 $[e_1,e_2,e_3,e_4]$，其中每个 $e_i$ 是一个浮点数。",
            "solution": "该问题要求从基本声波方程出发，推导线性、无损耗的傍轴波动方程，推导其高斯声束解，并实现一个数值谱方法算法来模拟声束传播，并将其与解析解进行比较。\n\n### 1. 线性傍轴波动方程的推导\n\n我们从均匀、无损耗流体中压力脉动 $p$ 的线性声波方程开始，其声速 $c$ 为常数：\n$$\n\\nabla^2 p - \\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} = 0\n$$\n这里，$\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$ 是拉普拉斯算子。\n\n对于一个角频率为 $\\omega$、主要沿 $+z$ 方向传播的单色声束，我们使用缓变包络近似 (SVEA) 来表示压力场。我们将复压力场 $p_c$ 表示为：\n$$\np_c(x,y,z,t) = U(x,y,z)\\, e^{\\mathrm{i}(k z - \\omega t)}\n$$\n物理压力是该复数的实部，$p = \\Re\\{p_c\\}$。假设复包络 $U(x,y,z)$ 在横向和轴向上的变化相对于波长都非常缓慢。参数 $k = \\omega/c$ 是声波数，其中 $\\omega = 2\\pi f$，$f$ 是频率。\n\n将此假设代入波动方程，我们首先计算导数。时间导数为 $\\frac{\\partial^2 p_c}{\\partial t^2} = (-\\mathrm{i}\\omega)^2 p_c = -\\omega^2 p_c$。因此，波动方程简化为亥姆霍兹方程：\n$$\n\\nabla^2 p_c + \\frac{\\omega^2}{c^2} p_c = 0 \\implies \\nabla^2 p_c + k^2 p_c = 0\n$$\n接下来，我们展开 $p_c = Ue^{\\mathrm{i}kz}$ 的空间导数。拉普拉斯算子为 $\\nabla^2 = \\nabla_\\perp^2 + \\frac{\\partial^2}{\\partial z^2}$，其中 $\\nabla_\\perp^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 是横向拉普拉斯算子。\n\n导数如下：\n$$\n\\nabla_\\perp^2 p_c = (\\nabla_\\perp^2 U) e^{\\mathrm{i}kz}\n$$\n$$\n\\frac{\\partial p_c}{\\partial z} = \\left(\\frac{\\partial U}{\\partial z} + \\mathrm{i}k U\\right) e^{\\mathrm{i}kz}\n$$\n$$\n\\frac{\\partial^2 p_c}{\\partial z^2} = \\left(\\frac{\\partial^2 U}{\\partial z^2} + 2\\mathrm{i}k \\frac{\\partial U}{\\partial z} - k^2 U\\right) e^{\\mathrm{i}kz}\n$$\n将这些代入亥姆霍兹方程并消去公因子 $e^{\\mathrm{i}kz}$，得到：\n$$\n(\\nabla_\\perp^2 U) + \\left(\\frac{\\partial^2 U}{\\partial z^2} + 2\\mathrm{i}k \\frac{\\partial U}{\\partial z} - k^2 U\\right) + k^2 U = 0\n$$\n这简化为关于包络 $U$ 的精确方程：\n$$\n\\nabla_\\perp^2 U + \\frac{\\partial^2 U}{\\partial z^2} + 2\\mathrm{i}k \\frac{\\partial U}{\\partial z} = 0\n$$\n作为 SVEA 核心的傍轴近似假定，包络 $U$ 沿传播轴 $z$ 的变化远慢于声学载波。在数学上，这意味着包络关于 $z$ 的二阶导数与由波数缩放的一阶导数项相比可以忽略不计：\n$$\n\\left|\\frac{\\partial^2 U}{\\partial z^2}\\right| \\ll \\left|2k \\frac{\\partial U}{\\partial z}\\right|\n$$\n应用此近似，我们舍去 $\\frac{\\partial^2 U}{\\partial z^2}$ 项，得到线性傍轴波动方程 (PWE)：\n$$\n\\nabla_\\perp^2 U + 2\\mathrm{i}k \\frac{\\partial U}{\\partial z} = 0\n$$\n重新整理成标准的演化形式，得到待求解的模型：\n$$\n\\frac{\\partial U}{\\partial z} = \\frac{\\mathrm{i}}{2k} \\nabla_\\perp^2 U\n$$\n这就是 Khokhlov-Zabolotskaya-Kuznetsov (KZK) 方程的线性、无损耗极限。\n\n### 2. 解析的傍轴高斯声束解\n\n对于高斯分布的初始条件，傍轴波动方程有一个精确解。对于源平面 $z=0$ 处的轴对称初始声束分布：\n$$\nU(x,y,0) = U_0 \\exp\\left(-\\frac{x^2+y^2}{w_0^2}\\right)\n$$\n其中 $U_0$ 是轴上振幅，$w_0$ 是初始束腰（$1/e$ 振幅半径），PWE 对 $z0$ 的精确解是众所周知的傍轴高斯声束：\n$$\nU(r,z) = U_0 \\frac{w_0}{w(z)} \\exp\\left(-\\frac{r^2}{w(z)^2}\\right) \\exp\\left(-\\mathrm{i}k\\frac{r^2}{2R(z)} + \\mathrm{i}\\zeta(z)\\right)\n$$\n其中 $r = \\sqrt{x^2+y^2}$ 是横向径向坐标。声束的参数随传播距离 $z$ 的演化如下：\n- **束腰：** $w(z) = w_0 \\sqrt{1 + (z/z_R)^2}$。这描述了声束的衍射扩展。\n- **波前曲率半径：** $R(z) = z \\left(1 + (z_R/z)^2\\right)$。这显示了初始的平面波前（$R(0)=\\infty$）如何变为球面。\n- **古依相移：** $\\zeta(z) = \\arctan(z/z_R)$。这是相对于平面波的相移。\n- **瑞利范围：** $z_R = \\frac{k w_0^2}{2} = \\frac{\\pi f w_0^2}{c}$。这个特征距离划分了近场（$z \\ll z_R$）和远场（$z \\gg z_R$）。\n\n为了进行比较，我们需要包络的幅值 $|U(r,z)|$。由于描述相位的复指数项的模为 1，解析幅值为：\n$$\n|U(r,z)| = |U_0| \\frac{w_0}{w(z)} \\exp\\left(-\\frac{r^2}{w(z)^2}\\right)\n$$\n\n### 3. 数值算法：谱传播\n\n问题指定使用谱方法求解 PWE。对于周期域上的常系数线性方程，这是一种高效且高精度的方法。算法过程如下：\n\n1.  **傅里叶变换：** 我们对 PWE $\\frac{\\partial U}{\\partial z} = \\frac{\\mathrm{i}}{2k} \\nabla_\\perp^2 U$ 应用二维空间傅里叶变换 $\\mathcal{F}_{x,y}$。令 $\\hat{U}(k_x, k_y, z) = \\mathcal{F}_{x,y}\\{U(x,y,z)\\}$。该变换将横向偏导数转换为了代数乘法：$\\mathcal{F}_{x,y}\\{\\nabla_\\perp^2 U\\} = -(k_x^2 + k_y^2)\\hat{U}$，其中 $k_x$ 和 $k_y$ 是横向空间频率。\n2.  **常微分方程：** PWE 变换为关于 $z$ 的常微分方程，对每个 $(k_x, k_y)$ 对都成立：\n    $$\n    \\frac{\\partial \\hat{U}}{\\partial z} = -\\frac{\\mathrm{i}(k_x^2 + k_y^2)}{2k} \\hat{U}\n    $$\n3.  **频域解：** 该常微分方程有精确解：\n    $$\n    \\hat{U}(k_x, k_y, z) = \\hat{U}(k_x, k_y, 0) \\exp\\left(-\\frac{\\mathrm{i}(k_x^2 + k_y^2)z}{2k}\\right)\n    $$\n    项 $H(k_x, k_y, z) = \\exp\\left(-\\frac{\\mathrm{i}(k_x^2 + k_y^2)z}{2k}\\right)$ 是传播距离 $z$ 的精确传播算子或传递函数。\n\n数值实现的步骤如下：\n1.  **离散化：** 定义一个大小为 $N \\times N$ 的计算网格 $(x,y)$，边长为 $L = 8w_0$，间距为 $\\Delta x = \\Delta y = L/N$。\n2.  **初始化：** 在此网格上构建初始场 $U(x,y,0)$。\n3.  **正向 FFT：** 通过对 $U(x,y,0)$ 进行二维快速傅里叶变换 (FFT) 计算 $\\hat{U}(k_x,k_y,0)$。\n4.  **传播：** 将 $\\hat{U}(k_x,k_y,0)$ 乘以离散化的传播算子 $H(k_x, k_y, z)$。所需的空间频率 $k_x$ 和 $k_y$ 由网格参数 $N$ 和 $\\Delta x$ 决定。\n5.  **逆向 FFT：** 通过对传播后的频谱 $\\hat{U}(k_x,k_y,z)$ 应用二维逆 FFT 来计算最终场 $U(x,y,z)$。\n6.  **提取：** 获取数值包络幅值 $|U(x,y,z)|$ 并提取沿 $y=0$ 线的分布。\n\n### 4. 比较与误差度量\n\n数值解与解析解之间的差异通过相对 $\\ell_2$ 误差来量化。对于离散的数值分布 $\\mathbf{u}_{\\text{num}}$ 和解析分布 $\\mathbf{u}_{\\text{ana}}$（两者都在 $y=0$ 上的相同网格点上求值），误差 $E$ 为：\n$$\nE = \\frac{\\|\\mathbf{u}_{\\text{num}} - \\mathbf{u}_{\\text{ana}}\\|_2}{\\|\\mathbf{u}_{\\text{ana}}\\|_2} = \\frac{\\sqrt{\\sum_i (u_{\\text{num},i} - u_{\\text{ana},i})^2}}{\\sqrt{\\sum_i u_{\\text{ana},i}^2}}\n$$\n这个无量纲度量衡量了两个解之间的归一化均方根差。由于谱传播方法是 PWE 的一个精确解，误差预计将接近机器精度，仅由浮点运算和离散化效应（如 FFT 引起的混叠）产生。选择 $L=8w_0$ 是为了使其足够大，以最小化这些边界伪影。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the diffraction of an initially Gaussian acoustic beam by numerically\n    solving the linear paraxial KZK model via a spectral method, and compares\n    the result to the analytical Gaussian-beam solution.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # U0, N, and L/w0 ratio are constant across all cases.\n    U0 = 1.0\n    N = 512\n\n    # A list of tuples, each defining a test case:\n    # (c [m/s], f [Hz], w0 [m], z description [str or float])\n    test_params = [\n        (1500.0, 1.0e6, 2.0e-3, 'z_R'),      # Case 1: Happy path at Rayleigh range\n        (1500.0, 1.0e6, 2.0e-3, 0.0),        # Case 2: Boundary condition at source plane\n        (1500.0, 1.0e6, 1.0e-2, 0.05),       # Case 3: Broad beam, near field\n        (1500.0, 1.0e6, 5.0e-4, '3*z_R'),    # Case 4: Narrow beam, far field\n    ]\n\n    results = []\n    for c, f, w0, z_desc in test_params:\n        # --- Physical and Numerical Parameters Setup ---\n        omega = 2.0 * np.pi * f\n        k = omega / c\n        zR = (k * w0**2) / 2.0  # Rayleigh range\n\n        if z_desc == 'z_R':\n            z = zR\n        elif z_desc == '3*z_R':\n            z = 3.0 * zR\n        else:\n            z = float(z_desc)\n\n        L = 8.0 * w0  # Transverse domain side length\n        dx = L / N   # Spatial grid spacing\n        # Centered spatial grid coordinates\n        x = dx * np.arange(-N/2, N/2)\n        xx, yy = np.meshgrid(x, x, indexing='xy')\n\n        # --- Numerical Solution: Spectral Propagation ---\n        \n        # 1. Define initial transverse field U(x,y,0)\n        U_initial = U0 * np.exp(-(xx**2 + yy**2) / w0**2)\n\n        # 2. Shift from centered to FFT-compatible order and perform 2D FFT\n        U_initial_fft_ordered = np.fft.ifftshift(U_initial)\n        U_hat_initial = np.fft.fft2(U_initial_fft_ordered)\n\n        # 3. Define k-space grid and propagation operator\n        # Spatial frequencies corresponding to FFT output order\n        k_vals = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n        kx, ky = np.meshgrid(k_vals, k_vals, indexing='xy')\n\n        # Propagator H = exp(-i * (kx^2+ky^2) * z / (2k))\n        propagator = np.exp(-1j * (kx**2 + ky**2) * z / (2.0 * k))\n\n        # 4. Propagate field in the spatial frequency domain\n        U_hat_z = U_hat_initial * propagator\n\n        # 5. Perform inverse 2D FFT and shift back to centered order\n        U_z_fft_ordered = np.fft.ifft2(U_hat_z)\n        U_z = np.fft.fftshift(U_z_fft_ordered)\n\n        # 6. Extract the numerical result (magnitude along the line y=0)\n        numerical_magnitude_profile = np.abs(U_z[N//2, :])\n\n        # --- Analytical Solution ---\n        # Beam waist at distance z: w(z) = w0 * sqrt(1 + (z/zR)^2)\n        w_z = w0 * np.sqrt(1.0 + (z/zR)**2)\n        \n        # Magnitude |U(x,y=0,z)| = |U0 * w0/w(z) * exp(-x^2/w(z)^2)| with U0=1\n        analytical_magnitude_profile = (w0 / w_z) * np.exp(-x**2 / w_z**2)\n            \n        # --- Error Calculation ---\n        # Relative l2 error = ||numerical - analytical|| / ||analytical||\n        norm_analytical = np.linalg.norm(analytical_magnitude_profile)\n        \n        if norm_analytical == 0:\n            # This case occurs if the analytical solution is identically zero.\n            # Error is 0 only if the numerical one is also zero.\n            error = 0.0 if np.linalg.norm(numerical_magnitude_profile) == 0 else np.inf\n        else:\n            norm_difference = np.linalg.norm(numerical_magnitude_profile - analytical_magnitude_profile)\n            error = norm_difference / norm_analytical\n        \n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}