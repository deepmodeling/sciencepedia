{
    "hands_on_practices": [
        {
            "introduction": "航空声学中的许多重要声源（如湍流）在声学上表现为四极子，因为它们几乎不产生单极子或偶极子辐射。这项练习  旨在巩固这一核心概念，它要求你从 Lighthill 张量 $T_{ij}$ 的具体形式出发，直接推导出典型四极子声源的指向性辐射图样。通过这个过程，你将学会如何将声源的数学结构与其在远场中可观测到的声学特征精准地联系起来。",
            "id": "4128020",
            "problem": "考虑一种可压缩的无粘性流体，其均匀环境密度为 $\\rho_{0}$，声速为 $c_{0}$。令 $\\mathbf{x}$ 表示观测点位置，其中 $r = |\\mathbf{x}|$，单位观测向量为 $\\mathbf{n} = \\mathbf{x}/r$。假设一个特征尺寸为 $a$ 的紧凑声源区，满足 $a \\ll r$ 和小马赫数 $M \\ll 1$，因此线性声学在辐射区有效。从质量守恒和动量守恒出发，在均匀介质的假设下，推导由 Lighthill 应力张量 $T_{ij}(\\mathbf{y}, t)$ 驱动的、控制声压脉动 $p'(\\mathbf{x}, t)$ 的非齐次波动方程。\n\n声源由一个对称的时谐 Lighthill 张量指定，其形式为\n$$\nT_{ij}(\\mathbf{y}, t) = T_{0}\\, S_{ij}\\, g(\\mathbf{y})\\, f(t),\n$$\n其中 $T_{0}$ 是一个常数振幅，$f(t)$ 在时间上是二次连续可微的，$S_{ij}$ 是常数对称矩阵\n$$\nS_{ij} = \\begin{pmatrix}\n-\\frac{1}{2} & 0 & 0 \\\\\n0 & -\\frac{1}{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n$$\n并且 $g(\\mathbf{y})$ 是一个满足以下条件的光滑紧支集函数\n$$\n\\int_{\\mathbb{R}^{3}} g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = 1, \\quad \\int_{\\mathbb{R}^{3}} y_{k}\\, g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = 0 \\quad \\text{for each } k \\in \\{1,2,3\\}.\n$$\n这些积分约束确保了没有净单极子或偶极子成分。令 $\\theta$ 表示 $\\mathbf{n}$ 与 $z$ 轴正向之间的极角，定义为 $\\cos\\theta = n_{z}$，其中 $\\mathbf{n} = (n_{x}, n_{y}, n_{z})$。\n\n在所述假设下，确定由该声源产生的辐射声的主阶远场角向依赖性。定义归一化角向指向性因子 $D(\\theta)$，使得远场压力 $p'(\\mathbf{x}, t)$ 与 $D(\\theta)$ 成正比，随 $1/r$ 衰减，并通过 $f(t - r/c_{0})$ 依赖于推迟时间。将 $D(\\theta)$ 归一化，使其在 $\\theta$ 上的最大值为 $1$。\n\n以 $\\theta$ 的单个闭式解析表达式形式给出 $D(\\theta)$。最终答案中不要包含单位。",
            "solution": "推导始于可压缩流体的基本方程：质量守恒和动量守恒。用 $\\mathbf{u}(\\mathbf{x}, t)$ 表示速度场，用 $p(\\mathbf{x}, t)$ 表示总压力，用 $\\rho(\\mathbf{x}, t)$ 表示总密度。将小振幅声学脉动写为 $p' = p - p_{0}$、$\\rho' = \\rho - \\rho_{0}$，并假设环境是均匀的，因此在线性声学范围内有 $p' = c_{0}^{2}\\, \\rho'$。\n\nLighthill 的声学比拟是通过结合精确的连续性方程和动量方程，并重新整理各项，得到关于密度脉动的非齐次波动方程：\n$$\n\\frac{\\partial^{2} \\rho'}{\\partial t^{2}} - c_{0}^{2}\\, \\nabla^{2} \\rho' = \\frac{\\partial^{2}}{\\partial x_{i}\\, \\partial x_{j}}\\, T_{ij},\n$$\n其中 $T_{ij}$ 是由控制方程的非线性和粘性项构成的 Lighthill 应力张量。使用 $p' = c_{0}^{2}\\, \\rho'$，可以得到声压的非齐次波动方程：\n$$\n\\frac{\\partial^{2} p'}{\\partial t^{2}} - c_{0}^{2}\\, \\nabla^{2} p' = c_{0}^{2}\\, \\frac{\\partial^{2}}{\\partial x_{i}\\, \\partial x_{j}}\\, T_{ij}.\n$$\n\n在自由空间中的形式解可以用波动算子的自由空间格林函数来表示。一种标准方法是进行分部积分，将空间导数从源项转移到格林函数上。在 $a \\ll r$ 的远场中，按 $a/r$ 的幂次进行多极展开是有效的。对于净单极子和偶极子成分为零的声源，领先的非零项是四极子项。该项可以写成 $T_{ij}$ 的体积积分（零阶空间矩）的形式：\n$$\nQ_{ij}(t) \\equiv \\int_{\\mathbb{R}^{3}} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}^{3}\\mathbf{y}.\n$$\n在远场近似下并经过必要的渐近分析后，主阶辐射压力为\n$$\np'(\\mathbf{x}, t) \\sim \\frac{1}{4\\pi\\, c_{0}^{2}\\, r}\\, \\frac{\\mathrm{d}^{2}}{\\mathrm{d} t^{2}} \\left[ n_{i}\\, n_{j}\\, Q_{ij}\\!\\left(t - \\frac{r}{c_{0}}\\right) \\right],\n$$\n其中 $\\mathbf{n} = \\mathbf{x}/r$ 是单位观测方向，$t - r/c_{0}$ 是推迟时间。这种形式展示了与 $Q_{ij}$ 缩并的角向依赖性 $n_{i}\\, n_{j}$，反映了四极子的指向性。\n\n给定指定的声源，\n$$\nT_{ij}(\\mathbf{y}, t) = T_{0}\\, S_{ij}\\, g(\\mathbf{y})\\, f(t),\n$$\n根据 $g(\\mathbf{y})$ 的归一化和矩条件，积分四极矩为\n$$\nQ_{ij}(t) = \\int_{\\mathbb{R}^{3}} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}^{3}\\mathbf{y} = T_{0}\\, S_{ij}\\, f(t)\\, \\int_{\\mathbb{R}^{3}} g(\\mathbf{y})\\, \\mathrm{d}^{3}\\mathbf{y} = T_{0}\\, S_{ij}\\, f(t).\n$$\n因此，\n$$\np'(\\mathbf{x}, t) \\sim \\frac{T_{0}}{4\\pi\\, c_{0}^{2}\\, r}\\, \\frac{\\mathrm{d}^{2}}{\\mathrm{d} t^{2}} \\left[ f\\!\\left(t - \\frac{r}{c_{0}}\\right)\\, n_{i}\\, n_{j}\\, S_{ij} \\right].\n$$\n因子 $n_{i}\\, n_{j}\\, S_{ij}$ 纯粹是角向的。定义归一化角向指向性 $D(\\theta)$ 为这个角向因子，并将其缩放以使其在 $\\theta$ 上的最大值为 $1$。已知\n$$\nS_{ij} = \\begin{pmatrix}\n-\\frac{1}{2} & 0 & 0 \\\\\n0 & -\\frac{1}{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}, \\quad \\mathbf{n} = (n_{x}, n_{y}, n_{z}),\n$$\n我们计算\n$$\nn_{i}\\, n_{j}\\, S_{ij} = -\\frac{1}{2}\\, n_{x}^{2} - \\frac{1}{2}\\, n_{y}^{2} + 1 \\cdot n_{z}^{2}.\n$$\n为观测方向引入球坐标，\n$$\n\\mathbf{n} = (\\sin\\theta\\, \\cos\\phi,\\, \\sin\\theta\\, \\sin\\phi,\\, \\cos\\theta),\n$$\n因此\n$$\nn_{x}^{2} + n_{y}^{2} = \\sin^{2}\\theta, \\quad n_{z}^{2} = \\cos^{2}\\theta.\n$$\n则\n$$\nn_{i}\\, n_{j}\\, S_{ij} = -\\frac{1}{2}\\, \\sin^{2}\\theta + \\cos^{2}\\theta = \\frac{3}{2}\\, \\cos^{2}\\theta - \\frac{1}{2}.\n$$\n此函数在 $\\theta$ 上的最大值出现在 $\\theta = 0$（$z$ 轴正向）处，其值为\n$$\n\\frac{3}{2}\\cdot 1 - \\frac{1}{2} = 1,\n$$\n因此它已经被归一化，最大值为单位 1。因此，归一化的角向指向性因子是\n$$\nD(\\theta) = \\frac{3}{2}\\, \\cos^{2}\\theta - \\frac{1}{2}.\n$$\n这是经典的四极子指向性，与二阶勒让德多项式 $P_{2}(\\cos\\theta)$ 成正比，这与指定的对称无迹源结构以及 Lighthill 声学比拟在远场中的多极展开是一致的。",
            "answer": "$$\\boxed{\\frac{3}{2}\\cos^{2}\\theta - \\frac{1}{2}}$$"
        },
        {
            "introduction": "在现实世界的航空声学问题中，声源很少处于静止状态。这项练习  将引导你从第一性原理出发，通过仔细分析信号的发射时间与接收时间（即延迟时间）之间的运动学关系，来推导著名的多普勒频移公式。这不仅是一个公式的推导，更是对 Lighthill 声学比拟中时空关系的深刻理解，是分析高速喷流噪声等问题的基础。",
            "id": "4128001",
            "problem": "考虑一种环境密度为 $\\rho_0$、声速 $c$ 为常数的无粘性、等熵、可压缩流体。从可压缩流体的连续性方程和动量方程（即可压缩纳维-斯托克斯方程）出发，构建与Lighthill声学比拟相关的、关于密度扰动 $\\,\\rho'(\\mathbf{x}, t)\\,$ 的非齐次声波方程，方程需显式地包含一个紧凑的外部体积力密度 $\\,\\mathbf{b}(\\mathbf{x}, t)\\,$。该力源局域在源点 $\\,\\mathbf{x}_s(t)\\,$ 周围，并以恒定速度 $\\,\\mathbf{U} = U\\,\\hat{\\mathbf{x}}\\,$ 运动，其亚音速马赫数 $\\,M = U/c < 1\\,$。假设 $\\,\\mathbf{b}(\\mathbf{x}, t)\\,$ 产生的净力为零，因此它表现为一个偶极子状源，其支集是紧凑的，特征尺寸远小于声波长。\n\n利用声波算子的自由空间格林函数，写出辐射场的推迟时间表示。在紧凑源（远场）近似下，分析位于固定观测点 $\\,\\mathbf{x}\\,$（该点到源的距离远大于源的尺寸）的接收信号的时间依赖性。设 $\\,\\theta\\,$ 为源的运动速度方向 $\\,\\hat{\\mathbf{x}}\\,$ 与从瞬时源位置到观测点的视线之间的夹角（以弧度为单位）。在源的静止参考系中，偶极矩以角频率 $\\,\\omega_0\\,$ 做简谐振荡。\n\n请从第一性原理出发，不使用任何现成的多普勒公式，通过仔细考虑推迟时间相关性所带来的对流效应，推导观测角频率 $\\,\\omega_{\\mathrm{obs}}\\,$ 关于 $\\,\\omega_0\\,$, $\\,M\\,$ 和 $\\,\\theta\\,$ 的闭式表达式。你的推导必须从控制方程开始，逻辑清晰地推演至推迟时间映射及其对在 $\\,\\mathbf{x}\\,$ 处观测到的瞬时相位的影响。\n\n请以单个解析表达式的形式给出 $\\,\\omega_{\\mathrm{obs}}\\,$ 的最终答案，单位为弧度/秒。无需进行数值计算。",
            "solution": "本题的任务是，从流体动力学的基本方程出发，遵循Lighthill声学比拟的原理，推导由运动偶极子源产生的声波的观测角频率 $\\omega_{\\mathrm{obs}}$ 的表达式。\n\n推导过程主要分为三个步骤：\n1.  建立由外部体积力密度 $\\mathbf{b}$ 产生的密度扰动 $\\rho'$ 的非齐次声波方程。\n2.  分析该方程的推迟时间解的结构，以建立观测信号相位与发射时刻源相位之间的关系。\n3.  对推迟时间关系进行运动学分析，确定源时间与观测者时间之间的映射关系，从而直接得出多普勒频移。\n\n**步骤 1：非齐次声波方程**\n\n我们从受外部体积力密度 $\\mathbf{b}(\\mathbf{x}, t)$ 作用的无粘性流体的可压缩连续性方程和动量方程开始。\n\n连续性方程为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n动量方程（包含体积力的可压缩欧拉方程）为：\n$$\n\\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u} + p \\mathbf{I}) = \\mathbf{b}\n$$\n其中 $\\rho$ 是流体密度，$\\mathbf{u}$ 是流体速度， $p$ 是压力，$\\mathbf{I}$ 是单位张量。\n\n我们考虑在静止、均匀的环境状态（密度为 $\\rho_0$，压力为 $p_0$，速度为 $\\mathbf{u}_0 = \\mathbf{0}$）周围的小扰动。扰动定义为 $\\rho' = \\rho - \\rho_0$ 和 $p' = p - p_0$。题目指出流体是等熵的，这意味着压力扰动和密度扰动之间存在直接关系，$p' = c^2 \\rho'$，其中 $c$ 是恒定的声速。\n\n为了推导波动方程，我们对连续性方程取时间导数，对动量方程取散度。\n对连续性方程取时间导数：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial}{\\partial t}[\\nabla \\cdot (\\rho \\mathbf{u})] = 0\n$$\n对动量方程取散度：\n$$\n\\nabla \\cdot \\left[ \\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} \\right] + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u} + p \\mathbf{I})] = \\nabla \\cdot \\mathbf{b}\n$$\n假设有足够的光滑性，我们可以交换时间和空间导数：\n$$\n\\frac{\\partial}{\\partial t}[\\nabla \\cdot (\\rho \\mathbf{u})] + \\nabla^2 p + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] = \\nabla \\cdot \\mathbf{b}\n$$\n其中 $\\nabla^2 p = \\nabla \\cdot (\\nabla p)$。从此结果中减去对时间求导后的连续性方程，可以消去含 $\\rho \\mathbf{u}$ 的项：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - \\nabla^2 p - \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] = -\\nabla \\cdot \\mathbf{b}\n$$\n这是一个精确方程。Lighthill声学比拟的做法是将此方程重排成非齐次波方程的形式。我们将除波动算子外的所有项移到右边：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\nabla^2(p - c^2 \\rho) + \\nabla \\cdot [\\nabla \\cdot (\\rho \\mathbf{u} \\mathbf{u})] - \\nabla \\cdot \\mathbf{b}\n$$\n代入 $\\rho = \\rho_0 + \\rho'$ 并注意到对于均匀环境状态有 $\\frac{\\partial^2 \\rho_0}{\\partial t^2} - c^2 \\nabla^2 \\rho_0 = 0$，我们得到：\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} - \\frac{\\partial b_i}{\\partial x_i}\n$$\n其中 $T_{ij} = \\rho u_i u_j + (p - p_0 - c^2 \\rho')\\delta_{ij}$ 是Lighthill应力张量。对于主要由外部力 $\\mathbf{b}$ 而非流体自身运动（如湍流）产生的声，主导的源项是涉及 $\\mathbf{b}$ 的项。这等价于考虑线性化极限，其中像 $\\rho u_i u_j$ 这样的项被忽略。线性化的波动方程是：\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = - \\nabla \\cdot \\mathbf{b}(\\mathbf{x}, t)\n$$\n这就是由体积力产生的密度扰动的控制性非齐次波方程。\n\n**步骤 2：推迟时间解与相位分析**\n\n此波动方程的解可以利用波算子 $\\frac{\\partial^2}{\\partial t^2} - c^2 \\nabla^2$ 的自由空间格林函数来形式化地表示。该解的基本性质是因果律，体现在推迟时间的概念中。在观测点 $\\mathbf{x}$ 和时刻 $t$ 的场 $\\rho'(\\mathbf{x}, t)$ 由源在更早的发射时刻 $\\tau$ 的状态决定。\n\n对于一个紧凑源，其体心在发射时刻 $\\tau$ 的位置为 $\\mathbf{x}_s(\\tau)$，接收时刻 $t$ 与发射时刻 $\\tau$ 的关系如下：\n$$\nt = \\tau + \\frac{|\\mathbf{x} - \\mathbf{x}_s(\\tau)|}{c}\n$$\n该方程表明，在时刻 $t$ 接收到的信号是在时刻 $\\tau$ 发射的，并以声速 $c$ 传播了距离 $|\\mathbf{x} - \\mathbf{x}_s(\\tau)|$。\n\n题目指出，源的偶极矩在其静止参考系中以角频率 $\\omega_0$ 进行简谐振荡。这意味着源函数 $\\mathbf{b}$ 的时间依赖性由相位 $\\phi_s(\\tau) = \\omega_0 \\tau$ 控制。由于整个声场 $\\rho'(\\mathbf{x}, t)$ 都由该声源产生，观测者在时刻 $t$ 接收到的信号的相位必须对应于源在发射时刻 $\\tau$ 的相位。\n因此，观测信号的相位由下式给出：\n$$\n\\phi_{\\mathrm{obs}}(t) = \\phi_s(\\tau(t)) = \\omega_0 \\tau(t)\n$$\n其中，$\\tau(t)$ 是由推迟时间方程定义的、与接收时刻 $t$ 对应的发射时刻。\n\n**步骤 3：观测频率的运动学推导**\n\n观测角频率 $\\omega_{\\mathrm{obs}}$ 定义为观测相位的变化率：\n$$\n\\omega_{\\mathrm{obs}} = \\frac{d\\phi_{\\mathrm{obs}}}{dt} = \\frac{d}{dt} [\\omega_0 \\tau(t)] = \\omega_0 \\frac{d\\tau}{dt}\n$$\n为了求得 $\\omega_{\\mathrm{obs}}$，我们必须计算导数 $\\frac{d\\tau}{dt}$。我们通过对推迟时间方程关于 $t$ 进行隐式求导来实现这一点：\n$$\n\\frac{d}{dt}(t) = \\frac{d}{dt} \\left( \\tau + \\frac{|\\mathbf{x} - \\mathbf{x}_s(\\tau)|}{c} \\right)\n$$\n$$\n1 = \\frac{d\\tau}{dt} + \\frac{1}{c} \\frac{d}{dt}|\\mathbf{x} - \\mathbf{x}_s(\\tau)|\n$$\n对第二项使用链式法则，$\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau}$：\n$$\n1 = \\frac{d\\tau}{dt} + \\frac{1}{c} \\left( \\frac{d\\tau}{dt} \\frac{d}{d\\tau}|\\mathbf{x} - \\mathbf{x}_s(\\tau)| \\right)\n$$\n提出因子 $\\frac{d\\tau}{dt}$：\n$$\n1 = \\frac{d\\tau}{dt} \\left( 1 + \\frac{1}{c} \\frac{d}{d\\tau} R(\\tau) \\right)\n$$\n其中 $R(\\tau) = |\\mathbf{x} - \\mathbf{x}_s(\\tau)|$ 是发射时刻源到观测点的距离。\n\n接下来，我们计算导数 $\\frac{dR}{d\\tau}$。我们从 $R^2(\\tau) = (\\mathbf{x} - \\mathbf{x}_s(\\tau)) \\cdot (\\mathbf{x} - \\mathbf{x}_s(\\tau))$ 开始。对 $\\tau$ 求导：\n$$\n2R \\frac{dR}{d\\tau} = 2 (\\mathbf{x} - \\mathbf{x}_s(\\tau)) \\cdot \\left( -\\frac{d\\mathbf{x}_s}{d\\tau} \\right)\n$$\n源以恒定速度 $\\mathbf{U}$ 运动，所以 $\\frac{d\\mathbf{x}_s}{d\\tau} = \\mathbf{U}$。\n$$\n\\frac{dR}{d\\tau} = -\\frac{\\mathbf{x} - \\mathbf{x}_s(\\tau)}{R} \\cdot \\mathbf{U} = -\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}\n$$\n其中 $\\hat{\\mathbf{R}}(\\tau)$ 是从发射时刻 $\\tau$ 的源位置指向固定观测点的单位矢量。\n\n将此结果代回关于 $\\frac{d\\tau}{dt}$ 的方程：\n$$\n1 = \\frac{d\\tau}{dt} \\left( 1 - \\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c} \\right)\n$$\n解出 $\\frac{d\\tau}{dt}$：\n$$\n\\frac{d\\tau}{dt} = \\frac{1}{1 - \\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c}}\n$$\n题目将 $\\theta$ 定义为源的速度方向 $\\hat{\\mathbf{x}}$（其中 $\\mathbf{U} = U\\hat{\\mathbf{x}}$）与指向观测者的视线（即 $\\hat{\\mathbf{R}}(\\tau)$ 的方向）之间的夹角。因此，点积为：\n$$\n\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U} = |\\hat{\\mathbf{R}}(\\tau)| |\\mathbf{U}| \\cos\\theta = U \\cos\\theta\n$$\n分母中的项变为：\n$$\n\\frac{\\hat{\\mathbf{R}}(\\tau) \\cdot \\mathbf{U}}{c} = \\frac{U \\cos\\theta}{c} = M \\cos\\theta\n$$\n其中 $M=U/c$ 是亚音速马赫数。\n\n最后，我们将此代入观测角频率的表达式中：\n$$\n\\omega_{\\mathrm{obs}} = \\omega_0 \\frac{d\\tau}{dt} = \\omega_0 \\left( \\frac{1}{1 - M \\cos\\theta} \\right) = \\frac{\\omega_0}{1 - M \\cos\\theta}\n$$\n这就是按要求从第一性原理推导出的、适用于运动声源和静止观测者的经典多普勒频移公式。",
            "answer": "$$\n\\boxed{\\frac{\\omega_0}{1 - M \\cos\\theta}}\n$$"
        },
        {
            "introduction": "将理论知识转化为可执行的预测模型，是连接物理学与工程应用的桥梁。这项练习  要求你完成这一关键步骤，将从 Lighthill 声学比拟推导出的远场辐射公式编写为一段计算机程序。通过为不同的标准四极子声源计算声压，你不仅能验证你的理论理解，还能掌握在计算声学中建立基准测试案例的核心技能。",
            "id": "4127999",
            "problem": "考虑在密度和声速均匀的无界、均匀、静止流体中的非均匀声波辐射。您需要为Lighthill声学比拟构建并实现一个研究生高年级水平的规范验证案例和解析基准。其基本依据必须是可压缩流体的质量和动量守恒、牛顿定律、小振幅扰动的线性声学以及三维自由空间辐射。仅从这些原理出发，推导由位于原点的紧致、时谐四极子源引起的远场辐射声压。\n\n首先使用爱因斯坦求和约定的索引表示法写出可压缩流体的守恒定律。设$x_i$表示笛卡尔坐标（$i \\in \\{1,2,3\\}$），$t$表示时间，$\\rho$表示密度，$u_i$表示速度分量，$p$表示压力，$\\sigma_{ij}$表示粘性应力张量。对声学涨落使用小扰动线性声学关系$p' = c^2 \\rho'$，其中$c$是声速，撇号表示声学扰动。以此为基础，推导辐射场在自由空间中的非齐次声波方程。然后，通过选择一个合适的自由空间格林函数（Green's function, GF）并应用紧致源近似（观测距离$r$远大于源尺寸），将体积分解简化为一个远场表达式，该表达式依赖于Lighthill源项与辐射方向收缩后的体积分。\n\n将基准测试的规范源定义如下。体积分Lighthill应力张量为\n$$\nQ_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}V_{\\mathbf{y}},\n$$\n并且，对于基准测试，假设其具有时谐形式\n$$\nQ_{ij}(t) = Q_0\\, S_{ij} \\cos(\\omega t),\n$$\n其中$Q_0$是一个单位为牛顿-米的恒定振幅，$\\omega$是一个单位为弧度/秒的角频率，而$S_{ij}$是一个编码四极子方向的恒定、对称、无量纲方向图张量。设$\\mathbf{x}$为观测点位置，$r = \\|\\mathbf{x}\\|$，$\\mathbf{n} = \\mathbf{x}/r$为辐射单位矢量。您必须使用在推迟时间$t_r = t - r/c$处计算的自由空间辐射解。目标是计算在指定的$(\\mathbf{x}, t)$和源参数下，远场声压$p'(\\mathbf{x}, t)$（单位为帕斯卡）。\n\n实现一个完整、可运行的程序，该程序：\n- 为三种基准方向图构建$S_{ij}$：\n  - 与$x$轴对齐的对角四极子，$S_{11} = 1$，所有其他分量为$0$。\n  - 对称非对角四极子，$S_{12} = S_{21} = 1$，所有其他分量为$0$。\n  - 各向同性方向图，$S_{ij} = \\delta_{ij}$。\n- 使用物理上一致的自由空间辐射，包括推迟时间、声速和三维空间中的$1/r$衰减，计算远场紧致源声压$p'(\\mathbf{x}, t)$。\n- 以帕斯卡为单位表示最终结果。\n\n设计您的算法以评估以下测试套件。在所有情况下，以帕斯卡为单位，作为浮点数作答。除非另有说明，否则使用$c = 343$ $\\mathrm{m/s}$。对于每种情况，观测坐标$\\mathbf{x}$以米为单位，时间$t$以秒为单位，振幅$Q_0$以牛顿-米为单位，角频率$\\omega$以弧度/秒为单位。\n\n测试套件：\n1. 正常情况下的紧致对角四极子：$S_{11} = 1$，所有其他$S_{ij} = 0$；$\\mathbf{x} = (1, 2, 2)$；$t = 0.001$；$Q_0 = 10^{-3}$；$\\omega = 2\\pi \\cdot 1000$；$c = 343$。\n2. 各向同性紧致四极子：$S_{ij} = \\delta_{ij}$；$\\mathbf{x} = (3, 4, 0)$；$t = 0.002$；$Q_0 = 10^{-3}$；$\\omega = 2\\pi \\cdot 500$；$c = 343$。\n3. 对称非对角四极子的几何零点：$S_{12} = S_{21} = 1$，所有其他$S_{ij} = 0$；$\\mathbf{x} = (0, 0, 5)$；$t = 0.010$；$Q_0 = 10^{-3}$；$\\omega = 2\\pi \\cdot 200$；$c = 343$。\n4. 零频率边界情况：$S_{11} = 1$，所有其他$S_{ij} = 0$；$\\mathbf{x} = (10, 0, 0)$；$t = 1.000$；$Q_0 = 10^{-3}$；$\\omega = 0$；$c = 343$。\n5. 极远场各向同性四极子：$S_{ij} = \\delta_{ij}$；$\\mathbf{x} = (1000, 0, 0)$；$t = 0.100$；$Q_0 = 10^{-3}$；$\\omega = 2\\pi \\cdot 50$；$c = 343$。\n\n您的程序必须实现从Lighthill声学比拟推导出的远场紧致源解，并生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，顺序与上述案例相同，例如$[p_1, p_2, p_3, p_4, p_5]$，其中每个$p_k$是为案例$k$计算出的浮点数（单位为帕斯卡）。",
            "solution": "用户请求一个Lighthill声学比拟的规范验证案例，从基本原理出发。我将首先验证问题陈述，然后推导所需的公式，最后构建实现。\n\n### 第1步：提取给定条件\n- **基本原理**：可压缩流体的质量和动量守恒；牛顿定律。\n- **本构关系**：小振幅扰动的线性声学关系，$p' = c^2 \\rho'$，其中$p'$是声压，$\\rho'$是声密度， $c$是声速。\n- **问题域**：无界、均匀、静止、密度和声速均匀的流体。\n- **源类型**：位于原点的紧致、时谐四极子源。\n- **近似**：远场观测（$r \\gg$ 源尺寸）和紧致源（$L \\ll \\lambda$）。\n- **目标**：推导远场声压$p'(\\mathbf{x}, t)$并实现一个程序来计算特定案例。\n- **源定义**：体积分Lighthill应力张量为$Q_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)\\, \\mathrm{d}V_{\\mathbf{y}}$，具有时谐形式$Q_{ij}(t) = Q_0\\, S_{ij} \\cos(\\omega t)$。$Q_0$是振幅，$\\omega$是角频率，$S_{ij}$是恒定、对称、无量纲的方向图张量。\n- **解的形式**：必须使用自由空间格林函数、推迟时间$t_r = t - r/c$，并表现出$1/r$衰减。\n- **$S_{ij}$的基准方向图**：\n    1. 对角：$S_{11} = 1$，其他为$0$。\n    2. 对称非对角：$S_{12} = S_{21} = 1$，其他为$0$。\n    3. 各向同性：$S_{ij} = \\delta_{ij}$。\n- **测试套件参数**：\n    1. $S$：对角，$\\mathbf{x} = (1, 2, 2)$ 米，$t = 0.001$ 秒，$Q_0 = 10^{-3}$ 牛·米，$\\omega = 2\\pi \\cdot 1000$ 弧度/秒，$c = 343$ 米/秒。\n    2. $S$：各向同性，$\\mathbf{x} = (3, 4, 0)$ 米，$t = 0.002$ 秒，$Q_0 = 10^{-3}$ 牛·米，$\\omega = 2\\pi \\cdot 500$ 弧度/秒，$c = 343$ 米/秒。\n    3. $S$：非对角，$\\mathbf{x} = (0, 0, 5)$ 米，$t = 0.010$ 秒，$Q_0 = 10^{-3}$ 牛·米，$\\omega = 2\\pi \\cdot 200$ 弧度/秒，$c = 343$ 米/秒。\n    4. $S$：对角，$\\mathbf{x} = (10, 0, 0)$ 米，$t = 1.000$ 秒，$Q_0 = 10^{-3}$ 牛·米，$\\omega = 0$ 弧度/秒，$c = 343$ 米/秒。\n    5. $S$：各向同性，$\\mathbf{x} = (1000, 0, 0)$ 米，$t = 0.100$ 秒，$Q_0 = 10^{-3}$ 牛·米，$\\omega = 2\\pi \\cdot 50$ 弧度/秒，$c = 343$ 米/秒。\n\n### 第2步：使用提取的给定条件进行验证\n- **科学基础扎实**：该问题建立在流体力学的精确守恒定律（质量和动量）之上，这些是基本原理。从这些定律推导出Lighthill声学比拟是空气声学中一个标准且重要的成果。使用自由空间格林函数求解得到的非齐次波方程是一种数学上严谨的技术。所有概念在物理学和工程学中都已得到公认。\n- **适定的**：问题定义清晰。它明确了控制方程、介质、源特性、观测点位置以及期望的输出量（$p'$）。远场和紧致源近似是标准的假设，它们导向一个唯一且明确的解析解。\n- **客观的**：问题以精确、无偏见、数学化和物理化的语言陈述。没有主观或基于意见的元素。\n- **缺陷检查表**：\n    1. **科学/事实不健全**：无。前提在物理和数学上都是健全的。\n    2. **非形式化/不相关**：无。该问题是一个形式化的推导和计算，与Lighthill声学比拟的主题直接相关。\n    3. **不完整/矛盾的设置**：无。推导和测试案例所需的所有常数、变量和条件都已提供且自洽。\n    4. **不切实际/不可行**：该设置是理想化的（例如，无界流体、点状紧致源），但它是一个用于验证和基准测试的标准规范问题。在这种理论背景下，它并非物理上不可能或不合理。\n    5. **不适定/结构不良**：无。问题结构导向一个唯一的解。\n    6. **伪深刻/琐碎**：无。从第一原理进行推导是一个非凡的任务，需要对流体动力学和波物理有扎实的理解，是典型的研究生水平问题。\n    7. **超出科学可验证性**：无。结果是一个可以计算和验证的物理可测量量（压力）。\n\n### 第3步：结论与行动\n该问题有效、适定且科学基础扎实。我将进行完整的推导和求解。\n\n### 远场四极子辐射公式的推导\n\n推导始于可压缩流体中的质量和动量守恒，以笛卡尔张量表示法和爱因斯坦求和约定书写。\n\n质量守恒是：\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial x_j} = 0 $$\n动量守恒（Navier-Stokes方程）是：\n$$ \\frac{\\partial (\\rho u_i)}{\\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_j} $$\n其中$\\rho$是密度，$u_i$是速度分量，$p$是压力，$\\sigma_{ij}$是粘性应力张量。\n\n为了推导Lighthill声学比拟，这些方程被重排成一个非齐次波方程的形式。首先，对质量方程求时间导数，并减去动量方程的散度（对$x_i$求导）：\n$$ \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial x_j}\\right) - \\frac{\\partial}{\\partial x_i}\\left(\\frac{\\partial (\\rho u_i)}{\\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_j}\\right) $$\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial^2 (\\rho u_j)}{\\partial t \\partial x_j} - \\frac{\\partial^2 (\\rho u_i)}{\\partial x_i \\partial t} - \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = \\frac{\\partial^2 p}{\\partial x_i^2} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j} $$\n混合导数项相互抵消。整理后得到：\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} - \\nabla^2 p = \\frac{\\partial^2 (\\rho u_i u_j - \\sigma_{ij})}{\\partial x_i \\partial x_j} $$\n我们在一个静止的环境状态$(\\rho_0, p_0)$周围引入扰动：$\\rho = \\rho_0 + \\rho'$和$p = p_0 + p'$。对于无热传导的理想流体，声学近似通过声速$c$将压力和密度扰动联系起来：$p' = c^2 \\rho'$。我们通过代入$\\rho' = p'/c^2$将方程重写为关于压力扰动$p'$的方程。通过在左侧加上和减去$c^2 \\nabla^2 \\rho'$来对方程进行操作：\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\nabla^2 \\rho' = \\frac{\\partial^2}{\\partial x_i \\partial x_j} (\\rho u_i u_j - \\sigma_{ij} + (p' - c^2 \\rho')\\delta_{ij}) $$\n通过在左侧代入$\\rho' = p'/c^2$以$p'$为主要变量，得到Lighthill方程：\n$$ \\left(\\frac{1}{c^2}\\frac{\\partial^2}{\\partial t^2} - \\nabla^2\\right)p' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j} $$\n其中$T_{ij} = \\rho u_i u_j + (p' - c^2 \\rho')\\delta_{ij} - \\sigma_{ij}$是Lighthill应力张量。这个方程是精确的，是守恒定律的重排。它描述了右侧的源项如何产生声，声由作用在左侧$p'$上的波算子表示。\n\n这个非齐次波方程在无界域中的解是通过使用自由空间格林函数$G(\\mathbf{x}, t | \\mathbf{y}, \\tau) = \\frac{\\delta(t - \\tau - |\\mathbf{x}-\\mathbf{y}|/c)}{4\\pi|\\mathbf{x}-\\mathbf{y}|}$找到的。$p'(\\mathbf{x}, t)$的解是卷积：\n$$ p'(\\mathbf{x}, t) = \\int \\int_{\\mathbb{R}^3} G(\\mathbf{x}, t | \\mathbf{y}, \\tau) \\frac{\\partial^2 T_{ij}(\\mathbf{y}, \\tau)}{\\partial y_i \\partial y_j} d^3\\mathbf{y} \\, d\\tau $$\n假设源项$T_{ij}$在空间上是局域化的，我们可以通过分部积分（两次）将空间导数转移到格林函数上。这给出了形式解：\n$$ p'(\\mathbf{x}, t) = \\int \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, \\tau) \\frac{\\partial^2 G(\\mathbf{x}, t | \\mathbf{y}, \\tau)}{\\partial y_i \\partial y_j} d^3\\mathbf{y} \\, d\\tau $$\n由于对于任何关于$\\mathbf{x}-\\mathbf{y}$的函数，都有$\\partial/\\partial y_i = -\\partial/\\partial x_i$，我们可以写出：\n$$ p'(\\mathbf{x}, t) = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\int \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, \\tau) G(\\mathbf{x}, t | \\mathbf{y}, \\tau) d^3\\mathbf{y} \\, d\\tau $$\n利用delta函数的性质进行时间积分，得到Kirchhoff-Lighthill积分：\n$$ p'(\\mathbf{x}, t) = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\int_{\\mathbb{R}^3} \\frac{T_{ij}(\\mathbf{y}, t-|\\mathbf{x}-\\mathbf{y}|/c)}{4\\pi|\\mathbf{x}-\\mathbf{y}|} d^3\\mathbf{y} $$\n对于位于原点$\\mathbf{y}=0$附近的紧致源和远场（$r = |\\mathbf{x}| \\gg |\\mathbf{y}|$）的观测者，我们应用以下近似：\n1.  在分母中：$|\\mathbf{x}-\\mathbf{y}| \\approx r$。\n2.  在推迟时间中：$t' = t - |\\mathbf{x}-\\mathbf{y}|/c \\approx t-r/c$。这是紧致源近似，其中忽略了源体积内的相位变化。\n积分简化为：\n$$ p'(\\mathbf{x}, t) \\approx \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\frac{1}{4\\pi r} \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t-r/c) d^3\\mathbf{y} \\right] $$\n我们定义体积分Lighthill张量$Q_{ij}(t) = \\int_{\\mathbb{R}^3} T_{ij}(\\mathbf{y}, t)d^3\\mathbf{y}$。表达式变为：\n$$ p'(\\mathbf{x}, t) \\approx \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\frac{Q_{ij}(t_r)}{4\\pi r} \\right] $$\n其中$t_r = t - r/c$是推迟时间。导数同时作用于$r$和$t_r$，因为它们都依赖于$\\mathbf{x}$。在远场中，主要贡献来自$Q_{ij}$的二阶时间导数。应用于$1/r$等项的导数$\\partial/\\partial x_k$会产生比$1/r$衰减更快的项，因此被忽略。对$Q_{ij}(t_r)$使用链式法则得到$\\partial/\\partial x_k \\rightarrow (-n_k/c)d/dt_r$，其中$n_k = x_k/r$是辐射方向矢量。应用两次这样的导数，得到四极子的远场结果：\n$$ p'(\\mathbf{x}, t) = \\frac{n_i n_j}{4\\pi r c^2} \\frac{d^2 Q_{ij}}{dt^2}\\bigg|_{t_r} = \\frac{n_i n_j}{4\\pi r c^2} \\ddot{Q}_{ij}(t - r/c) $$\n对于指定的时谐源，$Q_{ij}(t) = Q_0 S_{ij} \\cos(\\omega t)$。其二阶时间导数为：\n$$ \\ddot{Q}_{ij}(t) = -Q_0 \\omega^2 S_{ij} \\cos(\\omega t) $$\n将此代入远场压力公式并在推迟时间$t_r = t - r/c$处求值，得到用于实现的最终表达式：\n$$ p'(\\mathbf{x}, t) = -\\frac{Q_0 \\omega^2}{4\\pi r c^2} (n_i S_{ij} n_j) \\cos(\\omega(t - r/c)) $$\n项$n_i S_{ij} n_j$是四极子方向性图，是通过辐射矢量$\\mathbf{n}$与源张量$S_{ij}$收缩计算得到的标量。\n\n### 算法设计\n程序将对五个测试案例中的每一个实现上述推导出的最终公式。一个辅助函数将根据源参数和观测点位置计算压力。\n\n1.  对于每个测试案例，定义参数：观测点位置$\\mathbf{x}$、时间$t$、源振幅$Q_0$、角频率$\\omega$、声速$c$以及源方向图张量$S_{ij}$。\n2.  计算观测距离$r = \\|\\mathbf{x}\\|$。\n3.  如果$r=0$，压力是奇异的；然而，所有测试案例的$r>0$。\n4.  计算辐射单位矢量$\\mathbf{n} = \\mathbf{x}/r$。\n5.  计算方向性项$D = n_i S_{ij} n_j = \\mathbf{n}^T \\mathbf{S} \\mathbf{n}$。\n6.  计算推迟时间相位角$\\theta = \\omega (t - r/c)$。\n7.  计算压力振幅因子，其中包括$1/r$衰减和$\\omega^2$依赖性。\n8.  组合这些分量以找到声压$p'(\\mathbf{x}, t)$。对于$\\omega=0$的边界情况，压力为零，公式能正确处理。\n\n此过程将应用于测试套件中的每个案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the far-field acoustic pressure for a set of canonical\n    Lighthill quadrupole source test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"pattern\": \"diagonal\",\n            \"x\": np.array([1.0, 2.0, 2.0]),\n            \"t\": 0.001,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 1000,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"isotropic\",\n            \"x\": np.array([3.0, 4.0, 0.0]),\n            \"t\": 0.002,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 500,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"off_diagonal\",\n            \"x\": np.array([0.0, 0.0, 5.0]),\n            \"t\": 0.010,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 200,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"diagonal\",\n            \"x\": np.array([10.0, 0.0, 0.0]),\n            \"t\": 1.000,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 0,\n            \"c\": 343.0,\n        },\n        {\n            \"pattern\": \"isotropic\",\n            \"x\": np.array([1000.0, 0.0, 0.0]),\n            \"t\": 0.100,\n            \"Q0\": 1e-3,\n            \"omega_hz\": 50,\n            \"c\": 343.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        p_prime = calculate_far_field_pressure(\n            x=case[\"x\"],\n            t=case[\"t\"],\n            Q0=case[\"Q0\"],\n            omega=2 * np.pi * case[\"omega_hz\"],\n            c=case[\"c\"],\n            pattern=case[\"pattern\"],\n        )\n        results.append(p_prime)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\ndef calculate_far_field_pressure(x: np.ndarray, t: float, Q0: float, omega: float, c: float, pattern: str) -> float:\n    \"\"\"\n    Calculates the far-field acoustic pressure from a compact quadrupole source\n    based on Lighthill's acoustic analogy.\n\n    The formula used is:\n    p'(x, t) = - (Q0 * omega^2) / (4 * pi * r * c^2) * (n^T * S * n) * cos(omega * (t - r/c))\n    \"\"\"\n    \n    # Construct the dimensionless pattern tensor S_ij\n    S = np.zeros((3, 3))\n    if pattern == \"diagonal\":\n        S[0, 0] = 1.0\n    elif pattern == \"off_diagonal\":\n        S[0, 1] = 1.0\n        S[1, 0] = 1.0\n    elif pattern == \"isotropic\":\n        S = np.identity(3)\n\n    # Handle the zero-frequency case directly to avoid division by zero if omega is in a denominator.\n    if omega == 0.0:\n        return 0.0\n\n    # Calculate geometric terms: distance r and radiation unit vector n\n    r = np.linalg.norm(x)\n    if r == 0.0:\n        # Pressure is singular at the origin. For this problem, r > 0.\n        return np.inf\n    n = x / r\n\n    # Calculate the quadrupole directivity term (n_i * S_ij * n_j)\n    # Using numpy's @ operator for matrix-vector multiplication: n.T @ S @ n\n    directivity = n @ S @ n\n    \n    # If directivity is zero (geometric null), pressure is zero\n    if directivity == 0.0:\n        return 0.0\n\n    # Calculate the amplitude factor\n    amplitude_factor = -(Q0 * omega**2) / (4 * np.pi * r * c**2)\n    \n    # Calculate the retarded time argument of the cosine term\n    retarded_time_arg = omega * (t - r / c)\n\n    # Calculate the final acoustic pressure\n    pressure = amplitude_factor * directivity * np.cos(retarded_time_arg)\n    \n    return pressure\n\nsolve()\n```"
        }
    ]
}