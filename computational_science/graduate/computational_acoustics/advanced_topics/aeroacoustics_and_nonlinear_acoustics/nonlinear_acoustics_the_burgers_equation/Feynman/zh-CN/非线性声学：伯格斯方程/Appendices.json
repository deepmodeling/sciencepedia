{
    "hands_on_practices": [
        {
            "introduction": "无粘性伯格斯方程是理解非线性声波陡峭化和最终形成冲击波的理想模型。本练习将引导你使用特征线法，从第一性原理出发，精确推导一个光滑的正弦波在何时何地会“破裂”并形成不连续面 。通过这个经典的计算，你将对非线性效应如何导致波形畸变和梯度激增获得深刻的物理洞察。",
            "id": "4131914",
            "problem": "考虑一维无粘性伯格斯方程，它模拟了在没有粘性的情况下可压缩扰动的非线性传播，\n$$\nu_{t} + u\\,u_{x} = 0,\n$$\n其中 $u(x,t)$ 是粒子速度，下标表示偏导数。设初始条件为单模正弦分布\n$$\nu(x,0) = u_{0}(x) = U_{0}\\,\\sin(k x),\n$$\n其中 $U_{0} \\in \\mathbb{R}\\setminus\\{0\\}$ 且 $k>0$。使用特征线法，从一阶拟线性偏微分方程（PDE）的特征曲线第一性原理出发，推导解因梯度爆破（波破）而出现不连续性的最早时间 $t_{s}>0$，并用 $U_{0}$ 和 $k$ 表示 $t_{s}$。然后将 $t_{s}$ 与由下式定义的最大初始斜率联系起来\n$$\nS_{\\max} = \\max_{x \\in \\mathbb{R}}\\,|u_{x}(x,0)|.\n$$\n请以关于 $t_{s}$ 的单一闭式解析表达式的形式给出最终结果。您不需要进行数值计算。如果要报告数值，假设 $U_{0}$ 的单位是米/秒，$k$ 的单位是米⁻¹，则时间单位应为秒。",
            "solution": "该问题陈述经评估有效。它具有科学依据、适定、客观、自洽且一致。该问题是非线性双曲偏微分方程研究中的一个标准问题，提出了一个清晰、可解的任务。\n\n一维无粘性伯格斯方程由下式给出\n$$\nu_{t} + u\\,u_{x} = 0\n$$\n其中 $u=u(x,t)$ 是粒子速度。这是一个一阶拟线性偏微分方程（PDE）。我们在以下初始条件下求解它\n$$\nu(x,0) = u_{0}(x) = U_{0}\\,\\sin(k x)\n$$\n其中 $U_{0} \\in \\mathbb{R}\\setminus\\{0\\}$ 且 $k>0$。我们采用特征线法。\n\n特征曲线 $x(s)$、$t(s)$、$u(s)$ 由以下常微分方程组（ODEs）控制：\n$$\n\\frac{dt}{ds} = 1, \\quad \\frac{dx}{ds} = u, \\quad \\frac{du}{ds} = 0\n$$\n其中 $s$ 是沿特征线的参数。\n\n对第一个常微分方程 $\\frac{dt}{ds} = 1$ 进行积分，并设定积分常数使得在 $t=0$ 时 $s=0$，我们得到 $t=s$。\n\n对第三个常微分方程 $\\frac{du}{ds} = 0$ 进行积分，我们发现 $u$ 沿着任意给定的特征曲线是常数。设这个常数值为 $u_{c}$。特定特征线的 $u_{c}$ 值由该特征线在 $t=0$ 时起始点 $x_0$ 的初始条件决定。因此，\n$$\nu_{c} = u(x_0, 0) = U_{0}\\,\\sin(k x_0)\n$$\n\n对第二个常微分方程 $\\frac{dx}{ds} = u$ 进行积分，并回顾到 $u=u_c$ 沿特征线是常数且 $s=t$，我们得到\n$$\n\\frac{dx}{dt} = u_{c}\n$$\n积分得到 $(x,t)$ 平面中特征线的方程：\n$$\nx(t) = u_{c} t + x_0\n$$\n其中 $x_0$ 是特征线在 $t=0$ 时的位置。\n\n代入 $u_c$ 的表达式，我们得到 $u(x,t)$ 的隐式解。解由以下方程组定义：\n\\begin{align}\nu(x,t) = U_{0}\\,\\sin(k x_0) \\label{eq:1} \\\\\nx = \\left(U_{0}\\,\\sin(k x_0)\\right)t + x_0 \\label{eq:2}\n\\end{align}\n在这里，$x_0$ 被视为标记特征曲线的参数。对于任意给定的 $(x,t)$，原则上可以解第二个方程得到 $x_0$，然后将其代入第一个方程求得 $u(x,t)$。\n\n当解的梯度 $u_x = \\frac{\\partial u}{\\partial x}$ 变为无穷大时，会形成不连续性，即激波。这发生在特征线相交时。为了找到这个“梯度爆破”的时间，我们通过隐式微分计算 $u_x$。我们将 $x_0$ 视为 $x$ 和 $t$ 的函数，即 $x_0(x,t)$。对方程 \\eqref{eq:1} 和 \\eqref{eq:2} 关于 $x$ 求导，同时保持 $t$ 不变，得到：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x_0}\\left(U_{0}\\,\\sin(k x_0)\\right) \\frac{\\partial x_0}{\\partial x} = \\left(U_{0}\\,k\\,\\cos(k x_0)\\right) \\frac{\\partial x_0}{\\partial x}\n$$\n和\n$$\n\\frac{\\partial}{\\partial x}(x) = \\frac{\\partial}{\\partial x}\\left(\\left(U_{0}\\,\\sin(k x_0)\\right)t + x_0\\right)\n$$\n$$\n1 = \\left(U_{0}\\,k\\,\\cos(k x_0)\\,t\\right)\\frac{\\partial x_0}{\\partial x} + \\frac{\\partial x_0}{\\partial x} = \\left(1 + U_{0}\\,k\\,t\\,\\cos(k x_0)\\right)\\frac{\\partial x_0}{\\partial x}\n$$\n解出 $\\frac{\\partial x_0}{\\partial x}$：\n$$\n\\frac{\\partial x_0}{\\partial x} = \\frac{1}{1 + U_{0}\\,k\\,t\\,\\cos(k x_0)}\n$$\n将此代回 $u_x$ 的表达式：\n$$\nu_x(x,t) = \\frac{U_{0}\\,k\\,\\cos(k x_0)}{1 + U_{0}\\,k\\,t\\,\\cos(k x_0)}\n$$\n当分母为零时，梯度 $u_x$ 变为无穷大：\n$$\n1 + U_{0}\\,k\\,t\\,\\cos(k x_0) = 0\n$$\n求解沿从 $x_0$ 开始的特征线的时间 $t$：\n$$\nt(x_0) = -\\frac{1}{U_{0}\\,k\\,\\cos(k x_0)}\n$$\n激波时间 $t_s$ 是对于某个 $x_0$ 满足此条件的最早正时间 $t > 0$。为了使 $t$ 为正，乘积 $U_{0}\\,k\\,\\cos(k x_0)$ 必须为负。为了找到最小的正 $t$，我们必须最大化该乘积的绝对值。项 $\\cos(k x_0)$ 在 $-1$ 和 $1$ 之间变化。\n\n情况 1：$U_{0} > 0$。\n对于 $t > 0$，我们需要 $\\cos(k x_0)  0$。最小正时间发生在分母最小化（即最负）时。这发生在 $\\cos(k x_0)$ 达到其最小值 $-1$ 时。\n$$\nt_s = \\min_{x_0} \\left(-\\frac{1}{U_{0}\\,k\\,(-1)}\\right) = \\frac{1}{U_{0}\\,k}\n$$\n由于 $U_0>0$，这等于 $\\frac{1}{|U_0|k}$。\n\n情况 2：$U_{0}  0$。\n对于 $t > 0$，我们需要 $\\cos(k x_0) > 0$。最小正时间发生在分母 $U_{0}\\,k\\,\\cos(k x_0)$ 最小化（最负）时。由于 $U_0 k  0$，这发生在 $\\cos(k x_0)$ 达到其最大值 $1$ 时。\n$$\nt_s = \\min_{x_0} \\left(-\\frac{1}{U_{0}\\,k\\,(1)}\\right) = -\\frac{1}{U_{0}\\,k}\n$$\n由于 $U_00$，我们可以写成 $U_0 = -|U_0|$，所以 $t_s = -\\frac{1}{-|U_0|k} = \\frac{1}{|U_0|k}$。\n\n在两种情况下，最早的激波形成时间是相同的，由下式给出：\n$$\nt_s = \\frac{1}{|U_0|k}\n$$\n这就是波破或梯度爆破的时间，用给定的参数 $U_0$ 和 $k$ 表示。\n\n现在，我们将此结果与最大初始斜率 $S_{\\max}$ 联系起来。初始斜率由初始条件的导数给出：\n$$\nu_x(x,0) = \\frac{d}{dx} u_0(x) = \\frac{d}{dx} \\left(U_{0}\\,\\sin(k x)\\right) = U_{0}\\,k\\,\\cos(k x)\n$$\n最大初始斜率 $S_{\\max}$ 是此量在所有 $x$ 上的最大绝对值：\n$$\nS_{\\max} = \\max_{x \\in \\mathbb{R}}\\,|u_x(x,0)| = \\max_{x \\in \\mathbb{R}}\\, |U_{0}\\,k\\,\\cos(k x)|\n$$\n由于 $|\\cos(k x)| \\le 1$ 且 $k>0$，当 $|\\cos(k x)|=1$ 时达到最大值。\n$$\nS_{\\max} = |U_{0}\\,k| = |U_0|k\n$$\n将我们的 $t_s$ 表达式与 $S_{\\max}$ 进行比较，我们发现物理关系：\n$$\nt_s = \\frac{1}{|U_0|k} = \\frac{1}{S_{\\max}}\n$$\n这表明激波形成时间是初始速度梯度最大幅值的倒数。或者，激波时间是最大压缩斜率的倒数，因为它发生在 $u_x(x,0)0$ 且具有最大幅值的点，具体来说是 $u_x(x,0) = -|U_0|k$。激波形成时间为 $t_s = -1/\\min(u_x(x,0)) = -1/(-|U_0|k) = 1/(|U_0|k)$。\n\n问题要求以关于 $t_s$ 的单一闭式解析表达式的形式给出最终结果，用 $U_0$ 和 $k$ 表示。",
            "answer": "$$\\boxed{\\frac{1}{|U_{0}|k}}$$"
        },
        {
            "introduction": "在真实流体中，非线性陡峭化效应并非唯一的主导因素；粘性扩散始终在起着平滑波形的作用。本练习引入了完整的伯格斯方程，旨在通过量纲分析的方法，让你比较非线性项与粘性项的相对重要性 。你将推导出一个临界振幅，它定义了由扩散主导和由非线性主导的两种不同物理机制的边界，从而学会判断在何种条件下冲击波的形成会被有效抑制。",
            "id": "4131858",
            "problem": "考虑在平衡密度为 $\\rho_{0}$、小信号声速为 $c_{0}$ 的均匀流体中，一个一维、热粘性、弱非线性的平面声波。从可压缩牛顿流体的质量和动量守恒出发，使用在密度扰动上展开到二阶的状态方程，并采用标准的线性化热粘性损耗模型，在推迟时间坐标 $\\tau = t - x/c_{0}$ 下进行行波简化，可以得到关于质点速度 $u(x,\\tau)$ 的 Burgers 型演化方程：\n$$\n\\frac{\\partial u}{\\partial x} + \\alpha\\, u\\, \\frac{\\partial u}{\\partial \\tau} = \\mu\\, \\frac{\\partial^{2} u}{\\partial \\tau^{2}},\n$$\n其中 $\\alpha>0$ 是有效非线性系数，$\\mu>0$ 是有效热粘性扩散系数。在这里，$\\alpha$ 和 $\\mu$ 都被视为已知的、恒定的材料参数。\n\n在 $x=0$ 处施加一个正弦输入：\n$$\nu(0,\\tau) = U\\, \\sin(\\omega \\tau),\n$$\n其角频率为 $\\omega>0$，振幅为 $U>0$。\n\n基于上述演化方程，使用第一性原理的标度分析，定义并比较特征非线性陡峭长度尺度 $L_{\\mathrm{nl}}$ 和特征扩散长度尺度 $L_{\\mathrm{d}}$。通过此比较，确定对于正弦波形，当扩散与非线性陡峭达到平衡时的临界振幅 $U_{c}$，即满足 $L_{\\mathrm{nl}} = L_{\\mathrm{d}}$ 时的振幅。以国际单位制单位米/秒表示最终的 $U_{c}$。无需进行数值计算或四舍五入；请提供一个以 $\\alpha$、$\\mu$ 和 $\\omega$ 表示的闭式解析表达式。作为推导的一部分，请用一个包含 $U$ 和 $U_{c}$ 的不等式清晰地描述扩散抑制激波形成的条件范围，但最终答案必须仅包含 $U_{c}$ 的解析表达式。",
            "solution": "经评估，问题陈述有效。它有科学依据、良定、客观且内部一致。这是一个计算非线性声学中的标准问题，可以使用第一性原理标度分析来解决。\n\n质点速度 $u(x,\\tau)$ 的演化由 Burgers 方程支配：\n$$\n\\frac{\\partial u}{\\partial x} + \\alpha\\, u\\, \\frac{\\partial u}{\\partial \\tau} = \\mu\\, \\frac{\\partial^{2} u}{\\partial \\tau^{2}}\n$$\n其中 $x$ 是传播距离，$\\tau = t - x/c_{0}$ 是推迟时间。方程中的三项分别代表波的空间演化、非线性陡峭和热粘性扩散。\n\n给定在 $x=0$ 处的正弦输入：\n$$\nu(0,\\tau) = U\\, \\sin(\\omega \\tau)\n$$\n从这个边界条件，我们确定质点速度的特征振幅为 $U$，其变化的特征时间尺度为角频率的倒数 $1/\\omega$。\n\n我们使用标度分析来估计 Burgers 方程中每一项的数量级。设 $L$ 为 $x$ 方向上的一个特征长度尺度，在该尺度上波形发生显著演化。\n空间演化项的量级为：\n$$\n\\left| \\frac{\\partial u}{\\partial x} \\right| \\sim \\frac{U}{L}\n$$\n非线性陡峭项的量级为：\n$$\n\\left| \\alpha\\, u\\, \\frac{\\partial u}{\\partial \\tau} \\right| \\sim \\alpha \\cdot U \\cdot \\frac{U}{1/\\omega} = \\alpha U^{2} \\omega\n$$\n热粘性扩散项的量级为：\n$$\n\\left| \\mu\\, \\frac{\\partial^{2} u}{\\partial \\tau^{2}} \\right| \\sim \\mu \\cdot \\frac{U}{(1/\\omega)^{2}} = \\mu U \\omega^{2}\n$$\n\n特征非线性陡峭长度尺度 $L_{\\mathrm{nl}}$ 是指非线性项引起的畸变与波的初始空间变化率量级相当的传播距离。该尺度通过平衡空间演化项和非线性项得到：\n$$\n\\left| \\frac{\\partial u}{\\partial x} \\right| \\sim \\left| \\alpha\\, u\\, \\frac{\\partial u}{\\partial \\tau} \\right|\n$$\n代入数量级估计，并将长度尺度设为 $L_{\\mathrm{nl}}$：\n$$\n\\frac{U}{L_{\\mathrm{nl}}} \\sim \\alpha U^{2} \\omega\n$$\n解出 $L_{\\mathrm{nl}}$ 可得：\n$$\nL_{\\mathrm{nl}} = \\frac{1}{\\alpha U \\omega}\n$$\n这表示在没有扩散的情况下，激波形成的特征距离。\n\n特征扩散长度尺度 $L_{\\mathrm{d}}$ 是指扩散项引起的效应（例如衰减）与波的初始空间变化率量级相当的传播距离。该尺度通过平衡空间演化项和扩散项得到：\n$$\n\\left| \\frac{\\partial u}{\\partial x} \\right| \\sim \\left| \\mu\\, \\frac{\\partial^{2} u}{\\partial \\tau^{2}} \\right|\n$$\n代入数量级估计，并将长度尺度设为 $L_{\\mathrm{d}}$：\n$$\n\\frac{U}{L_{\\mathrm{d}}} \\sim \\mu U \\omega^{2}\n$$\n解出 $L_{\\mathrm{d}}$ 可得：\n$$\nL_{\\mathrm{d}} = \\frac{1}{\\mu \\omega^{2}}\n$$\n这表示波被显著耗散的特征距离。\n\n问题要求解的是非线性陡峭与扩散相平衡时的临界振幅 $U_{c}$。这种情况发生在它们各自的特征长度尺度相等时：\n$$\nL_{\\mathrm{nl}} = L_{\\mathrm{d}}\n$$\n代入 $L_{\\mathrm{nl}}$ 和 $L_{\\mathrm{d}}$ 的表达式，此时振幅 $U$ 为临界振幅 $U_c$：\n$$\n\\frac{1}{\\alpha U_{c} \\omega} = \\frac{1}{\\mu \\omega^{2}}\n$$\n现在我们可以解出 $U_{c}$：\n$$\n\\alpha U_{c} \\omega = \\mu \\omega^{2}\n$$\n$$\nU_{c} = \\frac{\\mu \\omega^{2}}{\\alpha \\omega}\n$$\n$$\nU_{c} = \\frac{\\mu \\omega}{\\alpha}\n$$\n这个表达式给出了用材料参数 $\\alpha$ 和 $\\mu$ 以及波频率 $\\omega$ 表示的临界振幅。$u$ 的单位是米/秒，量纲分析证实 $U_c$ 的表达式得出的单位也是米/秒。\n\n最后，我们描述扩散抑制激波形成的条件范围。激波形成是占主导地位的非线性效应的结果。扩散通过平滑波形来抵抗这一过程。因此，当扩散变得显著所需的距离短于非线性陡峭形成激波所需的距离时，扩散会抑制激波的形成。这对应于条件 $L_{\\mathrm{d}}  L_{\\mathrm{nl}}$。\n$$\nL_{\\mathrm{d}}  L_{\\mathrm{nl}} \\implies \\frac{1}{\\mu \\omega^2}  \\frac{1}{\\alpha U \\omega}\n$$\n$$\n\\mu \\omega^2 > \\alpha U \\omega\n$$\n$$\n\\mu \\omega > \\alpha U\n$$\n$$\nU  \\frac{\\mu \\omega}{\\alpha}\n$$\n使用临界振幅 $U_{c}$ 的定义，扩散抑制激波形成的范围由以下不等式给出：\n$$\nU  U_{c}\n$$\n相反，当 $U > U_{c}$ 时，非线性效应占主导，预计在波被耗散之前会形成激波。临界情况 $U = U_{c}$ 代表了这两种效应强度相当的阈值。",
            "answer": "$$\n\\boxed{\\frac{\\mu \\omega}{\\alpha}}\n$$"
        },
        {
            "introduction": "虽然解析解为我们提供了宝贵的物理见解，但解决更复杂的非线性声学问题通常需要依赖数值计算。本练习将理论付诸实践，要求你为粘性伯格斯方程设计一个显式有限差分格式，并从第一性原理推导其稳定性条件 。这不仅能让你掌握将对流和扩散项进行离散化的核心计算技巧，还能让你深刻理解保证数值模拟收敛性和准确性的关键——Courant–Friedrichs–Lewy (CFL) 条件。",
            "id": "4131868",
            "problem": "考虑非守恒形式的一维粘性 Burgers 方程，\n$$\n\\partial_t u(x,t) + u(x,t)\\,\\partial_x u(x,t) = \\nu\\,\\partial_{xx} u(x,t),\n$$\n该方程定义在间距为 $\\Delta x$ 的均匀空间网格上，并采用显式时间步长 $\\Delta t$。您的任务是构建一个显式有限差分方法，该方法对对流导数使用迎风离散，对粘性项使用中心二阶差分，然后推导出一个充分的 Courant–Friedrichs–Lewy (CFL) 稳定性条件。该条件应表示为一个不等式，用以根据 $\\Delta x$、运动粘度 $\\nu$ 以及对流速度大小的上限来限制 $\\Delta t$。推导应从以下基本依据出发：(i) 将 Burgers 方程定义为非线性平流和扩散的平衡；(ii) 基于速度 $a$ 的符号，为线性平流算子定义迎风有限差分；以及 (iii) 将中心二阶差分作为拉普拉斯算子的一致逼近。不要引用任何预先推导出的稳定性公式；相反，应仔细进行线性化，并使用第一性原理来得出一个充分的稳定性界限。\n\n完成推导后，设计一个算法，给定 $(\\nu,\\Delta x,U_{\\max},\\Delta t)$，其中 $U_{\\max}$ 是一个预设的界限，满足对于所有相关的 $(x,t)$ 都有 $|u(x,t)| \\le U_{\\max}$，该算法计算您推导出的条件所蕴含的最大稳定时间步长 $\\Delta t_{\\max}$，并评估给定的 $\\Delta t$ 在该条件下是否稳定。在此练习中，所有量均为无量纲；不要附加物理单位。\n\n实现要求：\n- 空间离散化：为整数 $j$ 定义网格点 $x_j = j\\,\\Delta x$，为整数 $n$ 定义时间层 $t^n = n\\,\\Delta t$。\n- 对流：对 $\\partial_x u$ 使用迎风差分，其方向根据局部状态 $u_j^n$ 的符号切换。\n- 扩散：对 $\\partial_{xx} u$ 使用中心二阶差分。\n- 时间步进：在时间上使用前向欧拉法（一阶）。\n\n您的程序只需实现稳定性评估，而不是完整的时间积分。具体来说，对于每个测试用例，计算由您推导的充分条件所蕴含的\n$$\n\\Delta t_{\\max} = \\frac{1}{\\dfrac{U_{\\max}}{\\Delta x} + \\dfrac{2\\,\\nu}{(\\Delta x)^2}},\n$$\n并报告所提供的 $\\Delta t$ 是否满足稳定性不等式（允许取等号）。\n\n测试套件：\n- 用例 1：$(\\nu,\\Delta x,U_{\\max},\\Delta t) = (0.01,\\,0.05,\\,0.8,\\,0.04)$。\n- 用例 2：$(\\nu,\\Delta x,U_{\\max},\\Delta t) = (0,\\,0.02,\\,2.0,\\,0.01)$。\n- 用例 3：$(\\nu,\\Delta x,U_{\\max},\\Delta t) = (0.005,\\,0.01,\\,0,\\,0.012)$。\n- 用例 4：$(\\nu,\\Delta x,U_{\\max},\\Delta t) = (0.0005,\\,0.005,\\,0.3,\\,0.01)$。\n- 用例 5：$(\\nu,\\Delta x,U_{\\max},\\Delta t) = (0,\\,0.001,\\,0.9,\\,0.001)$。\n\n对于每个用例，您的程序必须输出一个由计算出的 $\\Delta t_{\\max}$ 和一个布尔值组成的对，该布尔值指示所提供的 $\\Delta t$ 根据您推导的充分条件是否稳定。在打印前，将每个 $\\Delta t_{\\max}$ 四舍五入到小数点后 $9$ 位。\n\n最终输出格式：\n- 生成单行，其中包含一个包含 $5$ 个对的列表，每个对打印为双元素列表 $[\\Delta t_{\\max},\\mathrm{flag}]$，不含空格。例如，整体输出必须类似于\n$$\n[\\,[\\Delta t_{\\max}^{(1)},\\mathrm{flag}^{(1)}],[\\Delta t_{\\max}^{(2)},\\mathrm{flag}^{(2)}],\\dots,[\\Delta t_{\\max}^{(5)},\\mathrm{flag}^{(5)}]\\,].\n$$\n您的程序应生成单行输出，其中仅包含此列表，每个 $\\Delta t_{\\max}$ 格式化为小数点后 $9$ 位，每个标志为布尔字面量。",
            "solution": "该问题要求为应用于一维粘性 Burgers 方程的显式有限差分格式推导一个充分稳定性条件，然后实现一个算法，根据此推导来评估给定数值参数的稳定性。\n\n控制方程为非守恒形式的粘性 Burgers 方程：\n$$\n\\partial_t u(x,t) + u(x,t)\\,\\partial_x u(x,t) = \\nu\\,\\partial_{xx} u(x,t)\n$$\n其中 $u(x,t)$ 是速度场，$\\nu$ 是运动粘度，假定为非负常数。该方程模拟了非线性对流（由项 $u\\,\\partial_x u$ 表示）与线性扩散（由项 $\\nu\\,\\partial_{xx} u$ 表示）之间的相互作用。\n\n我们在由点 $(x_j, t^n)$ 定义的均匀时空网格上构建一个有限差分近似，其中 $x_j = j\\,\\Delta x$，$t^n = n\\,\\Delta t$，对于整数 $j$ 和 $n$。我们将这些点上解的数值近似表示为 $u_j^n \\approx u(x_j, t^n)$。\n\n问题指定了以下离散化方法：\n1.  **时间导数**：一阶前向欧拉格式：\n    $$\n    \\partial_t u \\Big|_{j}^n \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n    $$\n2.  **粘性项**：拉普拉斯算子的二阶中心差分：\n    $$\n    \\partial_{xx} u \\Big|_{j}^n \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n    $$\n3.  **对流项**：项 $u\\,\\partial_x u$ 近似为 $u_j^n \\, (\\partial_x u)_j^n$。空间导数 $(\\partial_x u)_j^n$ 使用一阶迎风格式离散化。迎风差分的方向取决于局部对流速度 $u_j^n$ 的符号：\n    -   如果 $u_j^n \\ge 0$（向右流动），信息从上游（左侧）获取：\n        $$\n        (\\partial_x u)_j^n \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n        $$\n    -   如果 $u_j^n  0$（向左流动），信息从上游（右侧）获取：\n        $$\n        (\\partial_x u)_j^n \\approx \\frac{u_{j+1}^n - u_j^n}{\\Delta x}\n        $$\n\n将这些近似代入 Burgers 方程，得到显式有限差分方程：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - u_j^n \\, (\\partial_x u)_j^n + \\nu \\, \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n整理以求解 $u_j^{n+1}$，我们得到：\n$$\nu_j^{n+1} = u_j^n - \\Delta t \\, u_j^n \\, (\\partial_x u)_j^n + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\n为了从第一性原理推导稳定性条件，我们进行局部 von Neumann 稳定性分析。由于对流项的非线性，我们将系数 $u_j^n$ “冻结”为一个局部常数值 $a$，从而有效地分析线性对流-扩散方程的稳定性：\n$$\n\\partial_t u + a\\,\\partial_x u = \\nu\\,\\partial_{xx} u\n$$\n然后，通过确保条件对最严格的情况（由 $|u(x,t)|$ 的最大可能值决定）成立，来评估非线性格式的稳定性。\n\n我们根据常数平流速度 $a$ 的符号分析两种情况。\n\n**情况 1：$a \\ge 0$**\n$\\partial_x u$ 的迎风格式是后向差分。有限差分方程变为：\n$$\nu_j^{n+1} = u_j^n - a \\frac{\\Delta t}{\\Delta x}(u_j^n - u_{j-1}^n) + \\frac{\\nu \\Delta t}{(\\Delta x)^2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n我们按时间层 $n$ 的空间索引对各项进行分组：\n$$\nu_j^{n+1} = \\left(\\frac{\\nu \\Delta t}{(\\Delta x)^2}\\right)u_{j+1}^n + \\left(1 - \\frac{a \\Delta t}{\\Delta x} - \\frac{2\\nu \\Delta t}{(\\Delta x)^2}\\right)u_j^n + \\left(\\frac{a \\Delta t}{\\Delta x} + \\frac{\\nu \\Delta t}{(\\Delta x)^2}\\right)u_{j-1}^n\n$$\n该显式格式的一个充分稳定性条件是 $u_j^{n+1}$ 是前一时间层值的凸组合，这要求右侧所有系数均为非负。\n1.  $u_{j+1}^n$ 的系数：$\\frac{\\nu \\Delta t}{(\\Delta x)^2} \\ge 0$。因为 $\\nu \\ge 0$，所以成立。\n2.  $u_{j-1}^n$ 的系数：$\\frac{a \\Delta t}{\\Delta x} + \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\ge 0$。因为 $a \\ge 0$ 且 $\\nu \\ge 0$，所以成立。\n3.  $u_j^n$ 的系数：$1 - \\frac{a \\Delta t}{\\Delta x} - \\frac{2\\nu \\Delta t}{(\\Delta x)^2} \\ge 0$。这对 $\\Delta t$ 提出了一个约束。\n\n**情况 2：$a  0$**\n$\\partial_x u$ 的迎风格式是前向差分。有限差分方程变为：\n$$\nu_j^{n+1} = u_j^n - a \\frac{\\Delta t}{\\Delta x}(u_{j+1}^n - u_j^n) + \\frac{\\nu \\Delta t}{(\\Delta x)^2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n分组各项：\n$$\nu_j^{n+1} = \\left(-\\frac{a \\Delta t}{\\Delta x} + \\frac{\\nu \\Delta t}{(\\Delta x)^2}\\right)u_{j+1}^n + \\left(1 + \\frac{a \\Delta t}{\\Delta x} - \\frac{2\\nu \\Delta t}{(\\Delta x)^2}\\right)u_j^n + \\left(\\frac{\\nu \\Delta t}{(\\Delta x)^2}\\right)u_{j-1}^n\n$$\n应用系数的非负性条件，并令 $|a| = -a$ (因为 $a  0$)：\n1.  $u_{j-1}^n$ 的系数：$\\frac{\\nu \\Delta t}{(\\Delta x)^2} \\ge 0$。成立。\n2.  $u_{j+1}^n$ 的系数：$\\frac{|a| \\Delta t}{\\Delta x} + \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\ge 0$。成立。\n3.  $u_j^n$ 的系数：$1 + \\frac{a \\Delta t}{\\Delta x} - \\frac{2\\nu \\Delta t}{(\\Delta x)^2} = 1 - \\frac{|a| \\Delta t}{\\Delta x} - \\frac{2\\nu \\Delta t}{(\\Delta x)^2} \\ge 0$。这是约束条件。\n\n两种情况都得到了以 $|a|$ 表示的相同形式的稳定性约束：\n$$\n1 - \\frac{|a| \\Delta t}{\\Delta x} - \\frac{2\\nu \\Delta t}{(\\Delta x)^2} \\ge 0\n$$\n重新整理此不等式以求解 $\\Delta t$：\n$$\n1 \\ge \\Delta t \\left( \\frac{|a|}{\\Delta x} + \\frac{2\\nu}{(\\Delta x)^2} \\right)\n$$\n$$\n\\Delta t \\le \\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{2\\nu}{(\\Delta x)^2}}\n$$\n为了获得原始非线性 Burgers 方程的充分稳定性条件，该不等式必须对局部速度 $u(x,t)$ 的所有值都成立。给定预设界限 $|u(x,t)| \\le U_{\\max}$，最严格的（即最小的 $\\Delta t$）条件是通过代入最大可能速度 $|a| \\to U_{\\max}$ 得到的：\n$$\n\\Delta t \\le \\frac{1}{\\frac{U_{\\max}}{\\Delta x} + \\frac{2\\nu}{(\\Delta x)^2}}\n$$\n这是所需的充分 Courant–Friedrichs–Lewy (CFL) 稳定性条件。该不等式的右侧定义了最大允许时间步长 $\\Delta t_{\\max}$。\n\n要实现的算法如下：\n1.  对于给定的一组参数 $(\\nu, \\Delta x, U_{\\max}, \\Delta t)$，使用推导出的公式计算最大稳定时间步长 $\\Delta t_{\\max}$：\n    $$\n    \\Delta t_{\\max} = \\frac{1}{\\frac{U_{\\max}}{\\Delta x} + \\frac{2\\nu}{(\\Delta x)^2}}\n    $$\n2.  通过检查是否满足条件 $\\Delta t \\le \\Delta t_{\\max}$ 来确定所提议的时间步长 $\\Delta t$ 是否稳定。\n3.  每个用例的输出将是一对 $[\\Delta t_{\\max}, \\text{is\\_stable}]$，其中 $\\Delta t_{\\max}$ 四舍五入到小数点后 9 位，`is_stable` 是一个布尔值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stability of a finite-difference scheme for the Burgers equation\n    for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (nu, dx, U_max, dt)\n    test_cases = [\n        (0.01, 0.05, 0.8, 0.04),\n        (0.0, 0.02, 2.0, 0.01),\n        (0.005, 0.01, 0.0, 0.012),\n        (0.0005, 0.005, 0.3, 0.01),\n        (0.0, 0.001, 0.9, 0.001),\n    ]\n\n    results = []\n    for case in test_cases:\n        nu, dx, U_max, dt = case\n\n        # The derived stability condition is:\n        # dt = 1 / (U_max/dx + 2*nu/dx^2)\n        # The denominator represents the sum of inverse time scales for advection and diffusion.\n        # It is guaranteed to be positive for the given test cases as dx > 0 and\n        # U_max >= 0, nu >= 0, with at least one being non-zero in the denominator.\n        denominator = U_max / dx + 2.0 * nu / (dx**2)\n\n        # Calculate the maximum stable time step.\n        dt_max = 1.0 / denominator\n\n        # Check if the given time step dt satisfies the stability condition.\n        # Equality is permitted.\n        is_stable = (dt = dt_max)\n\n        # Append the calculated dt_max and the stability flag to the results.\n        # The problem requires rounding dt_max to 9 decimal places for printing,\n        # which will be handled during final string formatting.\n        results.append((dt_max, is_stable))\n\n    # Format the results into a single string as specified in the problem.\n    # Each dt_max is formatted to 9 decimal places.\n    # Each stability flag is converted to its Python boolean literal ('True' or 'False').\n    result_strings = []\n    for dt_max_val, is_stable_flag in results:\n        # Format dt_max to exactly 9 decimal places.\n        dt_max_str = f\"{dt_max_val:.9f}\"\n        # Convert boolean to string ('True' or 'False').\n        is_stable_str = str(is_stable_flag)\n        # Create the pair string e.g., '[0.041666667,True]'\n        result_strings.append(f\"[{dt_max_str},{is_stable_str}]\")\n\n    # Join all pair strings with commas and enclose in brackets.\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}