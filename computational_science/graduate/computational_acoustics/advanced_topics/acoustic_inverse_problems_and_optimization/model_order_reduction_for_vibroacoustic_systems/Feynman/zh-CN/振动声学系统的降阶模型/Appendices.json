{
    "hands_on_practices": [
        {
            "introduction": "在进行模型降阶之前，我们必须首先深入理解原始全阶模型的动态特性。这项练习  通过一个简化的双自由度耦合振动声学系统，引导您推导其频率响应函数。通过这个过程，您将亲身体会系统的物理参数（如质量、刚度和耦合系数）如何决定其共振行为，为理解模型降阶为何以及如何捕捉关键动态特性打下坚实的基础。",
            "id": "4129351",
            "problem": "通过模态截断得到一个单输入单输出（SISO）的降阶振动声学模型，该模型保留了一个主导结构模态和一个主导声腔模态。保留的广义结构位移为$q_{s}(t)$，其模态质量为$m_{s}$，粘性阻尼为$c_{s}$，刚度为$k_{s}$。保留的广义声学模态坐标为$q_{a}(t)$，其模态质量为$m_{a}$，粘性阻尼为$c_{a}$，刚度为$k_{a}$。结构子系统和声学子系统通过由流固耦合作用产生的对称耦合系数$\\kappa$进行耦合。一个外部广义力$u(t)$作用在结构模态上。测量的输出是声学模态振幅$y(t) = q_{a}(t)$。控制方程以模态坐标表示，由结构的牛顿第二定律和声腔的线性声波方程的模态形式导出，其形式如下\n$$\nm_{s}\\,\\ddot{q}_{s}(t) + c_{s}\\,\\dot{q}_{s}(t) + k_{s}\\,q_{s}(t) + \\kappa\\,q_{a}(t) = u(t), \\\\\nm_{a}\\,\\ddot{q}_{a}(t) + c_{a}\\,\\dot{q}_{a}(t) + k_{a}\\,q_{a}(t) + \\kappa\\,q_{s}(t) = 0.\n$$\n引入一阶状态$x(t) = \\big(q_{s}(t),\\, q_{a}(t),\\, \\dot{q}_{s}(t),\\, \\dot{q}_{a}(t)\\big)^{\\top}$，并将系统写成标准状态空间形式$E\\,\\dot{x}(t) = A\\,x(t) + B\\,u(t)$，$y(t) = C\\,x(t) + D\\,u(t)$，其中$E$、$A$、$B$、$C$、$D$是适当的常数矩阵。\n\n从线性时不变描述符系统的传递函数定义$G(s) = C\\,(sE - A)^{-1}B + D$出发，完成以下任务：\n- 推导该耦合振动声学系统的频率响应$G(i\\omega)$的闭式表达式，该表达式是物理参数$\\{m_{s},c_{s},k_{s},m_{a},c_{a},k_{a},\\kappa\\}$和角频率$\\omega$的函数。\n- 仅使用关于线性系统和传递函数极点的基本原理，阐明在轻阻尼情况下，幅值$|G(i\\omega)|$的峰值与系统极点之间的关系。\n\n最后，考虑无阻尼情况$c_{s} = 0$和$c_{a} = 0$，并定义非耦合固有频率$\\omega_{s} = \\sqrt{k_{s}/m_{s}}$和$\\omega_{a} = \\sqrt{k_{a}/m_{a}}$，以及耦合频率参数$\\beta = \\kappa/\\sqrt{m_{s}m_{a}}$。通过将无阻尼耦合模态频率作为主阶近似，计算在轻阻尼下$|G(i\\omega)|$出现峰值的较低耦合共振频率$\\omega_{-}$（单位为弧度/秒）。以$\\omega_{s}$、$\\omega_{a}$和$\\beta$的单一解析表达式形式提供最终答案。频率以弧度/秒表示。在最终的方框答案中不要包含单位。",
            "solution": "问题要求推导一个二自由度振动声学系统的频率响应函数，解释其共振行为，并计算无阻尼情况下的较低耦合共振频率。对问题陈述的验证已确认其科学合理性和适定性。\n\n首先，我们推导从输入力$u(t)$到输出声学模态振幅$y(t) = q_a(t)$的传递函数$G(s)$。控制方程如下：\n$$\nm_{s}\\,\\ddot{q}_{s}(t) + c_{s}\\,\\dot{q}_{s}(t) + k_{s}\\,q_{s}(t) + \\kappa\\,q_{a}(t) = u(t)\n$$\n$$\nm_{a}\\,\\ddot{q}_{a}(t) + c_{a}\\,\\dot{q}_{a}(t) + k_{a}\\,q_{a}(t) + \\kappa\\,q_{s}(t) = 0\n$$\n我们对这些方程应用拉普拉斯变换，并假设初始条件为零。令$Q_s(s) = \\mathcal{L}\\{q_s(t)\\}$，$Q_a(s) = \\mathcal{L}\\{q_a(t)\\}$，以及$U(s) = \\mathcal{L}\\{u(t)\\}$。变换后的方程为：\n$$\n(m_{s}s^2 + c_{s}s + k_{s})Q_s(s) + \\kappa Q_a(s) = U(s)\n$$\n$$\n(m_{a}s^2 + c_{a}s + k_{a})Q_a(s) + \\kappa Q_s(s) = 0\n$$\n为简化符号，我们定义非耦合模态阻抗为$Z_s(s) = m_{s}s^2 + c_{s}s + k_{s}$和$Z_a(s) = m_{a}s^2 + c_{a}s + k_{a}$。方程组变为：\n$$\nZ_s(s)Q_s(s) + \\kappa Q_a(s) = U(s)\n$$\n$$\n\\kappa Q_s(s) + Z_a(s)Q_a(s) = 0\n$$\n输出为$y(t) = q_a(t)$，因此在拉普拉斯域中的输出为$Y(s) = Q_a(s)$。传递函数为$G(s) = Y(s)/U(s) = Q_a(s)/U(s)$。我们求解该方程组以得到$Q_a(s)$。从第二个方程，我们将$Q_s(s)$表示为$Q_a(s)$的函数：\n$$\nQ_s(s) = -\\frac{Z_a(s)}{\\kappa}Q_a(s)\n$$\n将此代入第一个方程：\n$$\nZ_s(s)\\left(-\\frac{Z_a(s)}{\\kappa}Q_a(s)\\right) + \\kappa Q_a(s) = U(s)\n$$\n$$\n\\left(-\\frac{Z_s(s)Z_a(s)}{\\kappa} + \\kappa\\right)Q_a(s) = U(s)\n$$\n$$\n\\frac{\\kappa^2 - Z_s(s)Z_a(s)}{\\kappa}Q_a(s) = U(s)\n$$\n因此，传递函数$G(s)$为：\n$$\nG(s) = \\frac{Q_a(s)}{U(s)} = \\frac{\\kappa}{\\kappa^2 - Z_s(s)Z_a(s)}\n$$\n代回$Z_s(s)$和$Z_a(s)$的表达式：\n$$\nG(s) = \\frac{\\kappa}{\\kappa^2 - (m_{s}s^2 + c_{s}s + k_{s})(m_{a}s^2 + c_{a}s + k_{a})}\n$$\n频率响应函数$G(i\\omega)$通过代入$s = i\\omega$获得，其中$\\omega$是角频率。\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - (m_{s}(i\\omega)^2 + c_{s}(i\\omega) + k_{s})(m_{a}(i\\omega)^2 + c_{a}(i\\omega) + k_{a})}\n$$\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - (-m_{s}\\omega^2 + ic_{s}\\omega + k_{s})(-m_{a}\\omega^2 + ic_{a}\\omega + k_{a})}\n$$\n整理各项，得到频率响应的最终表达式：\n$$\nG(i\\omega) = \\frac{\\kappa}{\\kappa^2 - ((k_{s} - m_{s}\\omega^2) + ic_{s}\\omega)((k_{a} - m_{a}\\omega^2) + ic_{a}\\omega)}\n$$\n\n接下来，我们讨论幅值$|G(i\\omega)|$的峰值与系统极点之间的关系。传递函数$G(s)$的极点是特征方程的根，该方程通过将分母设为零得到：\n$$\n\\kappa^2 - (m_{s}s^2 + c_{s}s + k_{s})(m_{a}s^2 + c_{a}s + k_{a}) = 0\n$$\n对于一个有阻尼的稳定系统（$c_s > 0, c_a > 0$），极点是具有负实部$\\sigma_k  0$的复共轭对$p_k = \\sigma_k \\pm i\\omega_{d,k}$。频率响应的幅值$|G(i\\omega)| = |\\kappa| / |\\text{denominator}(i\\omega)|$将在分母的幅值最小时出现峰值（共振）。对于一个靠近虚轴的极点$p_k$（轻阻尼，意味着$|\\sigma_k|$很小），当$\\omega$接近极点的虚部$\\omega_{d,k}$时，在$s=i\\omega$处计算的分母函数将具有很小的幅值。因此，对于轻阻尼， $|G(i\\omega)|$的峰值出现在频率$\\omega$约等于靠近虚轴的系统极点的虚部处。\n\n最后，我们考虑无阻尼情况，即$c_{s} = 0$和$c_{a} = 0$。在这种情况下，系统极点位于虚轴上，$s = \\pm i\\omega$，并对应于耦合固有频率。问题要求解这些频率中较低的一个，它对应于一个共振峰。我们通过求解特征方程来找到这些$\\omega$：\n$$\n\\kappa^2 - (m_{s}(i\\omega)^2 + k_{s})(m_{a}(i\\omega)^2 + k_{a}) = 0\n$$\n$$\n\\kappa^2 - (-m_{s}\\omega^2 + k_{s})(-m_{a}\\omega^2 + k_{a}) = 0\n$$\n$$\n\\kappa^2 - (k_{s} - m_{s}\\omega^2)(k_{a} - m_{a}\\omega^2) = 0\n$$\n我们引入非耦合固有频率$\\omega_{s} = \\sqrt{k_{s}/m_{s}}$和$\\omega_{a} = \\sqrt{k_{a}/m_{a}}$，这意味着$k_{s} = m_{s}\\omega_{s}^2$和$k_{a} = m_{a}\\omega_{a}^2$。将这些代入方程中得到：\n$$\n\\kappa^2 - (m_{s}\\omega_{s}^2 - m_{s}\\omega^2)(m_{a}\\omega_{a}^2 - m_{a}\\omega^2) = 0\n$$\n$$\n\\kappa^2 - m_{s}m_{a}(\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\n使用耦合频率参数定义$\\beta = \\kappa/\\sqrt{m_{s}m_{a}}$，我们有$\\kappa^2 = \\beta^2 m_{s}m_{a}$。方程变为：\n$$\n\\beta^2 m_{s}m_{a} - m_{s}m_{a}(\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\n除以$m_s m_a$（它们非零）：\n$$\n\\beta^2 - (\\omega_{s}^2 - \\omega^2)(\\omega_{a}^2 - \\omega^2) = 0\n$$\n我们定义一个新变量$X = \\omega^2$。该方程是关于$X$的二次方程：\n$$\n\\beta^2 - (\\omega_{s}^2\\omega_{a}^2 - (\\omega_{s}^2+\\omega_{a}^2)X + X^2) = 0\n$$\n$$\nX^2 - (\\omega_{s}^2 + \\omega_{a}^2)X + (\\omega_{s}^2\\omega_{a}^2 - \\beta^2) = 0\n$$\n我们使用二次求根公式求解$X$：\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(-(\\omega_{s}^2 + \\omega_{a}^2))^2 - 4(1)(\\omega_{s}^2\\omega_{a}^2 - \\beta^2)}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(\\omega_{s}^4 + 2\\omega_{s}^2\\omega_{a}^2 + \\omega_{a}^4) - 4\\omega_{s}^2\\omega_{a}^2 + 4\\beta^2}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{\\omega_{s}^4 - 2\\omega_{s}^2\\omega_{a}^2 + \\omega_{a}^4 + 4\\beta^2}}{2}\n$$\n$$\nX = \\frac{(\\omega_{s}^2 + \\omega_{a}^2) \\pm \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2}}{2}\n$$\n$\\omega^2$的两个解是$\\omega^2_+$和$\\omega^2_-$。较低的耦合共振频率$\\omega_-$对应于带负号的$\\omega^2$解，我们将其表示为$\\omega_-^2$。\n$$\n\\omega_-^2 = \\frac{1}{2} \\left[ (\\omega_{s}^2 + \\omega_{a}^2) - \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2} \\right]\n$$\n取平方根得到较低的耦合频率$\\omega_{-}$：\n$$\n\\omega_{-} = \\sqrt{\\frac{1}{2} \\left( (\\omega_{s}^2 + \\omega_{a}^2) - \\sqrt{(\\omega_{s}^2 - \\omega_{a}^2)^2 + 4\\beta^2} \\right)}\n$$\n这是较低耦合共振频率的最终解析表达式。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{1}{2} \\left( (\\omega_{s}^{2} + \\omega_{a}^{2}) - \\sqrt{(\\omega_{s}^{2} - \\omega_{a}^{2})^{2} + 4\\beta^{2}} \\right)}}\n$$"
        },
        {
            "introduction": "理论必须通过实践来检验。这项编程练习  将引导您实现一种核心的模型降阶技术——本征正交分解(POD)。您将学习如何根据给定的误差容限 $\\varepsilon$ 来确定所需降阶模型的最小阶数，并进一步将这个抽象的数学容限与一个具体的物理量——声压预测误差——直接联系起来。这项实践旨在将理论知识转化为可量化的工程保证，是构建可靠降阶模型的关键一步。",
            "id": "4129346",
            "problem": "考虑一个通过耦合结构-声学方程的空间离散化得到的线性振动声学系统。结构动力学由二阶形式 $M \\ddot{q}(t) + C \\dot{q}(t) + K q(t) = f(t)$ 表示，其中 $M \\in \\mathbb{R}^{n \\times n}$ 是对称正定质量矩阵，$C \\in \\mathbb{R}^{n \\times n}$ 是阻尼矩阵，$K \\in \\mathbb{R}^{n \\times n}$ 是刚度矩阵，$q(t) \\in \\mathbb{R}^{n}$ 是位移向量，$f(t) \\in \\mathbb{R}^{n}$ 是外力。设 $H \\in \\mathbb{R}^{p \\times n}$ 是一个线性观测算子，它通过一个线性化的耦合模型，将结构位移映射到 $p$ 个麦克风处的声压，因此预测的声压向量为 $p(t) = H q(t)$。\n\n假设 $C$ 和 $K$ 使得系统是稳定的，并且主要关注点是在由 $M$ 导出的加权范数下近似位移 $q(t)$。定义对称正定加权矩阵 $W_x = M$，对于任何向量 $x \\in \\mathbb{R}^{n}$，定义加权范数 $\\|x\\|_{W_x} = \\sqrt{x^{\\mathsf{T}} W_x x}$。声压以 $\\mathrm{Pa}$ 为单位测量，并采用欧几里得范数 $\\|p\\|_{2}$。\n\n给定一个快照矩阵 $S \\in \\mathbb{R}^{n \\times m}$，其列向量为 $m$ 个状态快照 $q(t_j)$，考虑通过投影到加权快照矩阵的前 $r$ 个左奇异向量张成的空间上，构建一个 $r$ 阶的本征正交分解 (Proper Orthogonal Decomposition, POD) 降阶模型 (reduced-order model, ROM)。设 $\\varepsilon  0$ 是在 $W_x$-范数下，快照集上最坏情况下相对投影误差的预定容差。具体来说，我们要求 ROM 阶数 $r$ 满足\n$$\n\\max_{1 \\leq j \\leq m} \\frac{\\|q(t_j) - \\Pi_r q(t_j)\\|_{W_x}}{\\|q(t_j)\\|_{W_x}} \\leq \\varepsilon,\n$$\n其中 $\\Pi_r$ 表示关于 $W_x$-内积到 $r$ 维 POD 子空间的正交投影算子。假设 $m \\geq 1$ 且快照矩阵的秩至少为 $1$。\n\n此外，将此容差与麦克风处诱导的声压预测误差的最坏情况界限联系起来。对于任何快照 $q(t_j)$，声压误差满足\n$$\n\\|H \\left(q(t_j) - \\Pi_r q(t_j)\\right)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\, \\|q(t_j) - \\Pi_r q(t_j)\\|_{W_x},\n$$\n其中 $W_x^{-1/2}$ 表示 $W_x$ 主平方根的逆，$\\|\\cdot\\|_{2}$ 表示矩阵的谱范数和向量的欧几里得范数。使用此关系式，以 $\\varepsilon$、$H$、$W_x$ 和 $S$ 的函数形式，为快照集上的声压误差生成一个最坏情况上界。\n\n您的任务是编写一个完整、可运行的程序，对于指定的测试套件，计算：\n- 保证快照集上最坏情况下相对投影误差在 $W_x$-范数下至多为 $\\varepsilon$ 的最小 POD ROM 阶数 $r$。\n- 相应的快照集上声压预测误差的最坏情况上界，以 $\\mathrm{Pa}$ 为单位表示。\n\n您必须使用以下具体的测试套件。在每种情况下，使用指定的 $W_x$、$H$、$S$ 和 $\\varepsilon$：\n- 测试用例 $1$ (正常路径):\n  - $n = 5$, $m = 8$。\n  - $W_x = M$，其中\n    $$\n    M = \\begin{bmatrix}\n    2.0  0.1  0.0  0.0  0.0 \\\\\n    0.1  1.8  0.05  0.0  0.0 \\\\\n    0.0  0.05  1.5  0.1  0.0 \\\\\n    0.0  0.0  0.1  1.2  0.05 \\\\\n    0.0  0.0  0.0  0.05  1.0\n    \\end{bmatrix}.\n    $$\n  - $H$ 的单位为 $\\mathrm{Pa}/\\mathrm{m}$:\n    $$\n    H = \\begin{bmatrix}\n    100.0  -80.0  60.0  -40.0  20.0 \\\\\n    50.0  40.0  -30.0  20.0  -10.0\n    \\end{bmatrix}.\n    $$\n  - $S$ 的列向量 $s_j$ 由下式给出\n    $$\n    S = \\begin{bmatrix}\n    0.010  0.008  0.006  0.004  0.003  0.002  0.001  0.0005 \\\\\n    0.009  0.007  0.005  0.004  0.003  0.002  0.0015  0.0007 \\\\\n    -0.008  -0.006  -0.005  -0.003  -0.0025  -0.0015  -0.0010  -0.0005 \\\\\n    0.006  0.005  0.004  0.003  0.0020  0.0010  0.0008  0.0004 \\\\\n    -0.004  -0.003  -0.002  -0.0015  -0.0010  -0.0008  -0.0005  -0.0003\n    \\end{bmatrix}.\n    $$\n  - $\\varepsilon = 0.15$。\n\n- 测试用例 $2$ (要求接近满阶的紧容差边界):\n  - 与测试用例 $1$ 相同的 $W_x$、$H$ 和 $S$。\n  - $\\varepsilon = 0.000001$。\n\n- 测试用例 $3$ (强制执行最小阶数的松容差边缘情况):\n  - 与测试用例 $1$ 相同的 $W_x$、$H$ 和 $S$。\n  - $\\varepsilon = 0.5$。\n\n算法要求：\n- 通过使用 Cholesky 分解 $W_x = L^{\\mathsf{T}} L$（其中 $L$ 为上三角矩阵）来分解 $W_x$，然后形成 $Y = L S$，从而计算加权快照矩阵。\n- 计算 $Y$ 的奇异值，并选择满足相对尾部能量 $\\left(\\sum_{i=r+1}^{k} \\sigma_i^2\\right) / \\left(\\sum_{i=1}^{k} \\sigma_i^2\\right) \\leq \\varepsilon^2$ 的最小 $r \\geq 1$，其中 $\\{\\sigma_i\\}_{i=1}^{k}$ 是 $Y$ 的奇异值，且 $k = \\min(n,m)$。\n- 通过构建 $T = H L^{-1}$ 并取 $T$ 的最大奇异值来计算算子范数 $\\|H W_x^{-1/2}\\|_{2}$。\n- 计算快照集上声压误差的最坏情况界限为 $\\varepsilon \\, \\|H W_x^{-1/2}\\|_{2} \\, \\max_{1 \\leq j \\leq m} \\|s_j\\|_{W_x}$，并将此界限表示为以 $\\mathrm{Pa}$ 为单位的浮点数。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果应为一个形式为 $[r,\\mathrm{bound}]$ 的双元素列表，其中 $r$ 是一个整数，$\\mathrm{bound}$ 是计算出的最坏情况声压误差界限，四舍五入到六位小数。例如，输出格式应类似于 $[[r_1,b_1],[r_2,b_2],[r_3,b_3]]$。",
            "solution": "该问题是适定的，并且在科学上是合理的，它基于线性代数、结构动力学和模型降阶的既定原则。所有必要的数据和条件都已提供。我现在将进行求解。\n\n目标是确定一个本征正交分解 (Proper Orthogonal Decomposition, POD) 降阶模型 (reduced-order model, ROM) 的最小阶数 $r$，并计算由此产生的声压误差的上界。分析在一个配备了加权内积的向量空间中进行，这对于能量范数具有物理意义的系统是典型的。\n\n首先，我们在加权内积 $\\langle u, v \\rangle_{W_x} = u^{\\mathsf{T}} W_x v$ 的背景下规范化 POD 过程，其诱导范数为 $\\|u\\|_{W_x} = \\sqrt{u^{\\mathsf{T}} W_x u}$。矩阵 $W_x = M$ 是对称正定的，确保了这是一个有效的内积空间。POD 的目标是找到一个最优地捕获所提供快照数据的低维子空间，这些数据包含在快照矩阵 $S \\in \\mathbb{R}^{n \\times m}$ 的列向量 $s_j = q(t_j)$ 中。\n\n寻找 POD 基的最优化问题通常使用奇异值分解 (Singular Value Decomposition, SVD) 来解决。为了适应加权范数，我们引入坐标变换。问题指定使用加权矩阵的 Cholesky 分解，$W_x = L^{\\mathsf{T}} L$，其中 $L \\in \\mathbb{R}^{n \\times n}$ 是一个上三角矩阵。利用这个因子，向量 $s_j$ 的加权范数可以表示为变换后向量 $y_j$ 的标准欧几里得范数：\n$$\n\\|s_j\\|_{W_x}^2 = s_j^{\\mathsf{T}} W_x s_j = s_j^{\\mathsf{T}} (L^{\\mathsf{T}} L) s_j = (L s_j)^{\\mathsf{T}} (L s_j) = \\|L s_j\\|_2^2 = \\|y_j\\|_2^2\n$$\n其中 $y_j = L s_j$。这种变换有效地相对于加权矩阵 $W_x$ 对数据进行“白化”。我们将加权快照组合成一个矩阵 $Y = [y_1, y_2, \\ldots, y_m] = L S$。对于快照 $S$，在 $W_x$-范数下的 POD 问题现在等同于对于加权快照 $Y$，在欧几里得范数下的标准 POD 问题。\n\n标准 POD 问题的解由快照矩阵的左奇异向量给出。设加权快照矩阵 $Y$ 的 SVD 为 $Y = U \\Sigma \\mathcal{V}^{\\mathsf{T}}$，其中 $U$ 的列是变换后坐标系中的 POD 模态，$\\sigma_1 \\geq \\sigma_2 \\geq \\ldots \\geq \\sigma_k \\geq 0$ 是奇异值，其中 $k = \\min(n, m)$。在聚合的平方 $W_x$-范数下测量的快照总能量与奇异值相关：\n$$\n\\sum_{j=1}^{m} \\|s_j\\|_{W_x}^2 = \\sum_{j=1}^{m} \\|y_j\\|_2^2 = \\|Y\\|_{\\mathrm{F}}^2 = \\sum_{i=1}^{k} \\sigma_i^2\n$$\n其中 $\\|\\cdot\\|_{\\mathrm{F}}$ 是 Frobenius 范数。\n\n问题要求选择满足相对尾部能量条件的最小模型阶数 $r \\geq 1$。一个 $r$ 维 POD 模型捕获的能量是 $\\sum_{i=1}^{r} \\sigma_i^2$。残余能量，即模型未捕获的数据部分，是 $\\sum_{i=r+1}^{k} \\sigma_i^2$。指定的标准是：\n$$\n\\frac{\\sum_{i=r+1}^{k} \\sigma_i^2}{\\sum_{i=1}^{k} \\sigma_i^2} \\leq \\varepsilon^2\n$$\n这等价于找到最小的整数 $r \\geq 1$，使得捕获的能量分数满足某个阈值：\n$$\n\\frac{\\sum_{i=1}^{r} \\sigma_i^2}{\\sum_{i=1}^{k} \\sigma_i^2} \\geq 1 - \\varepsilon^2\n$$\n我们将计算 $Y$ 的奇异值，求其平方 $\\sigma_i^2$，计算这些平方值的累积和，并确定满足此条件的最小 $r \\geq 1$。\n\n接下来，我们推导声压误差的上界。我们得到不等式：\n$$\n\\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\, \\|s_j - \\Pi_r s_j\\|_{W_x}\n$$\n其中 $\\Pi_r$ 是到 $r$ 维 POD 子空间的 $W_x$-正交投影算子。问题还为任何快照指定了最坏情况相对投影误差的容差 $\\varepsilon$：\n$$\n\\frac{\\|s_j - \\Pi_r s_j\\|_{W_x}}{\\|s_j\\|_{W_x}} \\leq \\varepsilon \\quad \\implies \\quad \\|s_j - \\Pi_r s_j\\|_{W_x} \\leq \\varepsilon \\|s_j\\|_{W_x}\n$$\n结合这两个不等式，可以得到单个快照 $s_j$ 的声压误差界：\n$$\n\\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\|H W_x^{-1/2}\\|_{2} \\left( \\varepsilon \\|s_j\\|_{W_x} \\right)\n$$\n为了找到整个快照集上的最坏情况上界，我们对所有 $j \\in \\{1, \\ldots, m\\}$ 取最大值：\n$$\n\\max_{1 \\leq j \\leq m} \\|H (s_j - \\Pi_r s_j)\\|_{2} \\leq \\max_{1 \\leq j \\leq m} \\left( \\varepsilon \\, \\|H W_x^{-1/2}\\|_{2} \\, \\|s_j\\|_{W_x} \\right)\n$$\n由于 $\\varepsilon$ 和矩阵范数 $\\|H W_x^{-1/2}\\|_{2}$ 相对于快照索引 $j$ 是常数，我们可以将界的最终表达式写为：\n$$\n\\text{误差界} = \\varepsilon \\cdot \\|H W_x^{-1/2}\\|_{2} \\cdot \\left( \\max_{1 \\leq j \\leq m} \\|s_j\\|_{W_x} \\right)\n$$\n计算步骤如下：\n1.  计算 $W_x$ 的上三角 Cholesky 因子 $L$，使得 $W_x = L^{\\mathsf{T}} L$。\n2.  形成加权快照矩阵 $Y = L S$。\n3.  计算 $Y$ 的奇异值 $\\sigma_i$。使用这些值找到满足能量标准的最小 ROM 阶数 $r \\geq 1$。\n4.  计算算子范数 $\\|H W_x^{-1/2}\\|_{2}$。根据问题描述，这是通过计算矩阵 $T = H L^{-1}$ 的最大奇异值来实现的，这与 $W_x^{-1/2} = L^{-1}$ 的识别是一致的。\n5.  确定快照的最大加权范数 $\\max_{j} \\|s_j\\|_{W_x}$，这等价于找到 $Y$ 的列的最大欧几里得范数，即 $\\max_{j} \\|y_j\\|_{2}$。\n6.  组合这些量以计算最终的声压误差界。\n\n将对每个指定的测试用例实施此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import cholesky, solve_triangular\n\ndef solve():\n    \"\"\"\n    Solves the model order reduction problem for the given test cases.\n    \"\"\"\n    \n    # Test Case 1 Data\n    W_x1 = np.array([\n        [2.0, 0.1, 0.0, 0.0, 0.0],\n        [0.1, 1.8, 0.05, 0.0, 0.0],\n        [0.0, 0.05, 1.5, 0.1, 0.0],\n        [0.0, 0.0, 0.1, 1.2, 0.05],\n        [0.0, 0.0, 0.0, 0.05, 1.0]\n    ])\n    \n    H1 = np.array([\n        [100.0, -80.0, 60.0, -40.0, 20.0],\n        [50.0, 40.0, -30.0, 20.0, -10.0]\n    ])\n    \n    S1 = np.array([\n        [0.010, 0.008, 0.006, 0.004, 0.003, 0.002, 0.001, 0.0005],\n        [0.009, 0.007, 0.005, 0.004, 0.003, 0.002, 0.0015, 0.0007],\n        [-0.008, -0.006, -0.005, -0.003, -0.0025, -0.0015, -0.0010, -0.0005],\n        [0.006, 0.005, 0.004, 0.003, 0.0020, 0.0010, 0.0008, 0.0004],\n        [-0.004, -0.003, -0.002, -0.0015, -0.0010, -0.0008, -0.0005, -0.0003]\n    ])\n\n    test_cases = [\n        (W_x1, H1, S1, 0.15),\n        (W_x1, H1, S1, 0.000001),\n        (W_x1, H1, S1, 0.5)\n    ]\n\n    results = []\n    \n    for W_x, H, S, epsilon in test_cases:\n        # Step 1: Cholesky factorization W_x = L^T L with L upper triangular\n        # scipy.linalg.cholesky returns lower triangular C where W_x = C @ C.T\n        # We need W_x = L.T @ L where L is upper. So L = C.T\n        try:\n            C = cholesky(W_x, lower=True)\n            L = C.T\n        except np.linalg.LinAlgError:\n            # This should not happen for the given positive definite matrices\n            results.append([\"Error\", \"Cholesky failed\"])\n            continue\n\n        # Step 2: Form the weighted snapshot matrix Y = L S\n        Y = L @ S\n\n        # Step 3: Compute SVD of Y and select ROM order r\n        # We only need the singular values\n        sigma = np.linalg.svd(Y, compute_uv=False)\n        \n        # Sort in descending order just in case, though svd should already do this\n        sigma = np.sort(sigma)[::-1]\n        \n        # Compute squared singular values (energies)\n        sigma_sq = sigma**2\n        \n        # Compute total energy\n        total_energy = np.sum(sigma_sq)\n        \n        # Guard against zero total energy (rank-0 S)\n        if total_energy  np.finfo(float).eps:\n             r = 1 # As per problem, r must be at least 1\n        else:\n            # Compute cumulative energy fraction\n            cum_energy_frac = np.cumsum(sigma_sq) / total_energy\n            \n            # Find the smallest r >= 1 such that the captured energy fraction is\n            # at least 1 - epsilon^2\n            # This is equivalent to finding the first index where this is true\n            # and adding 1 to get the number of modes.\n            required_frac = 1.0 - epsilon**2\n            candidate_indices = np.where(cum_energy_frac >= required_frac)[0]\n            \n            # The order r is the index + 1. If no index is found, it means even with\n            # all modes, the criterion is not met (due to float precision), so take all modes.\n            if candidate_indices.size > 0:\n                r = candidate_indices[0] + 1\n            else:\n                r = len(sigma) # Take all modes\n        \n        # Ensure r is at least 1, as per problem requirement\n        r = max(1, r)\n\n        # Step 4: Compute the operator norm ||H W_x^{-1/2}||_2\n        # This is ||H L^{-1}||_2. We compute T = H @ L^{-1}.\n        # It's more stable to solve L.T @ X = H.T for X, then T = X.T\n        # or solve LX = I for X = L^{-1}\n        I_n = np.identity(L.shape[0])\n        L_inv = solve_triangular(L, I_n, lower=False)\n        T = H @ L_inv\n        \n        # The spectral norm is the largest singular value\n        norm_op = np.linalg.svd(T, compute_uv=False)[0]\n        \n        # Step 5: Compute the maximum weighted norm of the snapshots\n        # max_j ||s_j||_W_x = max_j ||L s_j||_2 = max_j ||y_j||_2\n        # This is the max L2 norm of the columns of Y\n        max_s_norm = np.max(np.linalg.norm(Y, axis=0))\n\n        # Step 6: Compute the worst-case pressure error bound\n        pressure_error_bound = epsilon * norm_op * max_s_norm\n        \n        results.append([r, round(pressure_error_bound, 6)])\n\n    # Format output as a string representing a list of lists.\n    # e.g., [[r1, b1], [r2, b2], [r3, b3]]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "降阶模型的价值最终取决于其在实际预测中的可靠性。这项实践  聚焦于模型开发流程中至关重要的一步：验证。您需要设计并选择一个科学上最严谨的验证协议，以评估参数化降阶模型在未经训练的工况下的泛化能力。这项练习强调了交叉验证、物理可观测量以及综合误差度量的重要性，旨在培养您建立对计算模型信任度的批判性思维和实践技能。",
            "id": "4129280",
            "problem": "一个通过有限元法（FEM）离散化的耦合振动声学系统，可以在频域中建模为一个线性时不变（LTI）二阶系统。设结构位移向量为 $\\,\\mathbf{u}\\in\\mathbb{R}^{n_s}\\,$，声压向量为 $\\,\\mathbf{p}\\in\\mathbb{R}^{n_a}\\,$。对于输入为 $\\,u(\\omega)\\,$ 且输出为 $\\,y(\\omega)\\,$ 的单输入单输出设置，其全阶模型（FOM）的频率响应公式可以写作\n$$\n\\begin{bmatrix}\n-\\omega^2 \\mathbf{M}_s + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_s + \\mathbf{K}_s  \\mathbf{K}_{sa} \\\\\n\\mathbf{K}_{as}  -\\omega^2 \\mathbf{M}_a + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_a + \\mathbf{K}_a\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u}(\\omega) \\\\\n\\mathbf{p}(\\omega)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{B}_s \\\\\n\\mathbf{B}_a\n\\end{bmatrix}\nu(\\omega),\n\\qquad\ny(\\omega) = \\mathbf{L}_s^\\top \\mathbf{u}(\\omega) + \\mathbf{L}_a^\\top \\mathbf{p}(\\omega),\n$$\n其中 $\\,\\mathbf{M}_\\star\\,$, $\\,\\mathbf{C}_\\star\\,$ 和 $\\,\\mathbf{K}_\\star\\,$ 分别表示质量、阻尼和刚度矩阵，$\\,\\mathbf{B}_\\star\\,$ 是输入分布向量，$\\,\\mathbf{L}_\\star\\,$ 将状态映射到可观测测量值（例如，结构速度或传感器处的声压）。降阶模型（ROM）通过投影 $\\,\\mathbf{z}(\\omega)=\\begin{bmatrix}\\mathbf{u}(\\omega)\\\\\\mathbf{p}(\\omega)\\end{bmatrix}\\approx \\mathbf{V}\\,\\mathbf{q}(\\omega)\\,$ 构建，其中 $\\,\\mathbf{q}(\\omega)\\in\\mathbb{R}^{r}\\,$ 是一个低维状态，$\\,\\mathbf{V}\\in\\mathbb{R}^{(n_s+n_a)\\times r}\\,$ 是基。这会产生投影后的算子和相应的降阶传递函数 $\\,G_{\\mathrm{ROM}}(\\omega)\\,$，而全阶模型则导出 $\\,G_{\\mathrm{FOM}}(\\omega)\\,$。\n\n工作场景由参数 $\\,\\boldsymbol{\\mu}\\in\\mathcal{D}\\,$ 参数化，这些参数编码了例如边界阻抗、影响声速 $\\,c(\\boldsymbol{\\mu})\\,$ 的流体属性、阻尼比和激励谱等信息。一个科学上合理的降阶模型验证协议应当评估其在不同 $\\,\\boldsymbol{\\mu}\\,$ 下的泛化能力、关键可观测量的保真度，并报告能够反映在与应用相关的频带 $\\,\\Omega=[\\omega_{\\min},\\omega_{\\max}]\\,$ 内的振动声学性能的误差范数。\n\n从上述控制方程和LTI系统的输入输出传递函数定义出发，选择下面一项科学上合理、且实施了跨工作场景交叉验证、关键可观测量比较以及报告基于振动声学第一性原理的误差范数的协议。\n\nA. 将场景参数集 $\\,\\mathcal{D}\\,$ 划分为不相交的训练子集 $\\,\\mathcal{D}_{\\mathrm{train}}\\,$ 和测试子集 $\\,\\mathcal{D}_{\\mathrm{test}}\\,$，并通过对 $\\,\\mathcal{D}\\,$ 本身进行折叠来执行 $\\,k\\,$-折交叉验证（即，折划分的是场景，而不是时间或频率样本）。对每个 $\\,\\boldsymbol{\\mu}\\in\\mathcal{D}_{\\mathrm{test}}\\,$，在 $\\,\\omega\\in\\Omega\\,$ 上计算 $\\,G_{\\mathrm{FOM}}(\\boldsymbol{\\mu},\\omega)\\,$ 和 $\\,G_{\\mathrm{ROM}}(\\boldsymbol{\\mu},\\omega)\\,$，并比较关键可观测量 $\\,y(\\omega)\\,$，例如麦克风处的声压、加速度计处的结构速度和辐射声功率。对每个 $\\,\\boldsymbol{\\mu}\\,$，报告相对输出误差\n$$\n\\varepsilon_{L^2}(\\boldsymbol{\\mu})=\\frac{\\left\\|y_{\\mathrm{ROM}}(\\cdot;\\boldsymbol{\\mu})-y_{\\mathrm{FOM}}(\\cdot;\\boldsymbol{\\mu})\\right\\|_{L^2(\\Omega)}}{\\left\\|y_{\\mathrm{FOM}}(\\cdot;\\boldsymbol{\\mu})\\right\\|_{L^2(\\Omega)}},\n$$\n$\\,G_{\\mathrm{FOM}}(\\boldsymbol{\\mu},\\cdot)-G_{\\mathrm{ROM}}(\\boldsymbol{\\mu},\\cdot)\\,$ 的 $\\,H_2\\,$ 和 $\\,H_\\infty\\,$ 范数，传感器阵列上的最大声压级差异，以及主导耦合模态的模态置信准则（MAC）。通过检查ROM的正实性或耗散性证书来验证稳定性和无源性的保持。通过中位数、四分位距和 $\\,95\\%\\,$ 百分位数统计数据来总结 $\\,\\mathcal{D}_{\\mathrm{test}}\\,$ 上的误差，并报告每个场景下频率分辨的最坏情况误差 $\\,\\max_{\\omega\\in\\Omega}\\left|y_{\\mathrm{ROM}}(\\omega)-y_{\\mathrm{FOM}}(\\omega)\\right|\\,$。\n\nB. 通过将单个工作场景的时域样本随机分入折中来进行 $\\,k\\,$-折交叉验证。仅比较内部状态向量 $\\,\\mathbf{q}\\,$ 和 $\\,\\mathbf{z}\\,$，使用在采样时间上的均方状态差 $\\,\\frac{1}{N}\\sum_{i=1}^{N}\\left\\|\\mathbf{z}_i-\\mathbf{V}\\mathbf{q}_i\\right\\|_2^2\\,$。仅报告平均状态误差，不进行可观测量比较，并且不区分训练和测试场景，因为状态空间投影已经最小化了状态残差。\n\nC. 通过在ROM基预测的一小组共振频率处检查ROM来进行验证，跳过非共振频带。允许将训练场景包含在验证集中以增加样本量。在那些共振频率处报告内部状态误差的 $\\,L^\\infty\\,$ 范数 $\\,\\left\\|\\mathbf{z}-\\mathbf{V}\\mathbf{q}\\right\\|_\\infty\\,$，并事后调整ROM的阻尼参数，直到输出曲线在那些频带内视觉上匹配。\n\nD. 跨场景执行交叉验证，但仅评估单个可观测量：一个麦克风位置的声压。使用平均绝对误差 $\\,\\frac{1}{|\\Omega|}\\int_{\\Omega}\\left|p_{\\mathrm{ROM}}(\\omega)-p_{\\mathrm{FOM}}(\\omega)\\right|\\,\\mathrm{d}\\omega\\,$ 作为唯一指标。不包括结构可观测量或能量/功率指标，并仅报告所有场景的平均误差，不提供分布统计或最坏情况频率分辨误差。\n\nE. 使用 $\\,\\boldsymbol{\\mu}\\,$ 的蒙特卡洛采样来构建验证集，但用一个更粗糙的模型替换FOM以降低计算成本。将ROM输出上采样到粗化的FOM网格上进行比较，并在时域中比较短时间窗口的脉冲响应，而不映射到频域。仅报告单个激励的 $\\,L^2\\,$ 时域误差，并且不考虑 $\\,\\Omega\\,$ 上的 $\\,H_\\infty\\,$ 类型最坏情况行为。",
            "solution": "在尝试任何解决方案之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统类型**：一个通过有限元法（FEM）离散化的耦合振动声学系统。\n- **模型类型**：频域中的线性时不变（LTI）二阶系统。\n- **状态变量**：结构位移向量 $\\mathbf{u}\\in\\mathbb{R}^{n_s}$ 和声压向量 $\\mathbf{p}\\in\\mathbb{R}^{n_a}$。\n- **全阶模型（FOM）方程**：\n$$\n\\begin{bmatrix}\n-\\omega^2 \\mathbf{M}_s + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_s + \\mathbf{K}_s  \\mathbf{K}_{sa} \\\\\n\\mathbf{K}_{as}  -\\omega^2 \\mathbf{M}_a + \\mathrm{i}\\,\\omega\\,\\mathbf{C}_a + \\mathbf{K}_a\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u}(\\omega) \\\\\n\\mathbf{p}(\\omega)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{B}_s \\\\\n\\mathbf{B}_a\n\\end{bmatrix}\nu(\\omega)\n$$\n- **输出方程**：$y(\\omega) = \\mathbf{L}_s^\\top \\mathbf{u}(\\omega) + \\mathbf{L}_a^\\top \\mathbf{p}(\\omega)$。\n- **系统矩阵**：结构（$\\star=s$）和声学（$\\star=a$）域的质量（$\\mathbf{M}_\\star$）、阻尼（$\\mathbf{C}_\\star$）和刚度（$\\mathbf{K}_\\star$）矩阵。$\\mathbf{K}_{sa}$ 和 $\\mathbf{K}_{as}$ 是耦合矩阵。\n- **输入/输出向量**：$\\mathbf{B}_\\star$ 是单个输入 $u(\\omega)$ 的输入分布向量。$\\mathbf{L}_\\star$ 是单个输出 $y(\\omega)$ 的输出向量。\n- **降阶模型（ROM）**：通过使用基 $\\mathbf{V}\\in\\mathbb{R}^{(n_s+n_a)\\times r}$ 的投影构建，其中 $\\mathbf{z}(\\omega)=\\begin{bmatrix}\\mathbf{u}(\\omega)\\\\\\mathbf{p}(\\omega)\\end{bmatrix}\\approx \\mathbf{V}\\,\\mathbf{q}(\\omega)$ 且 $\\mathbf{q}(\\omega)\\in\\mathbb{R}^{r}$，$r \\ll n_s+n_a$。\n- **传递函数**：$G_{\\mathrm{FOM}}(\\omega)$ 和 $G_{\\mathrm{ROM}}(\\omega)$ 分别是相应模型从输入 $u(\\omega)$ 到输出 $y(\\omega)$ 的传递函数。\n- **参数化**：系统行为取决于参数 $\\boldsymbol{\\mu}\\in\\mathcal{D}$，这些参数影响声速 $c(\\boldsymbol{\\mu})$、阻尼等量。\n- **验证目标**：为ROM选择一个科学上合理的验证协议，该协议能评估跨参数 $\\boldsymbol{\\mu}$ 的泛化能力、关键可观测量的保真度，并报告在频带 $\\Omega=[\\omega_{\\min},\\omega_{\\max}]$ 上的适当误差范数。\n\n### 步骤2：使用提取的已知条件进行验证\n审查问题陈述的有效性。\n- **科学基础**：该公式是频域、有限元离散化、耦合振动声学系统的标准状态空间表示。矩阵（$\\mathbf{M}$, $\\mathbf{C}$, $\\mathbf{K}$）、耦合项（$\\mathbf{K}_{sa}$, $\\mathbf{K}_{as}$）、输入/输出结构以及基于投影的模型降阶方法在计算力学和声学中都已牢固确立。为验证而提到的概念（交叉验证、误差范数如 $L^2$, $H_2$, $H_\\infty$、MAC、稳定性、无源性）是MOR和控制理论领域的标准和核心内容。该问题在科学上是合理的。\n- **适定性**：问题要求从给定列表中确定最科学严谨的验证协议。这是一个概念性问题，基于科学和工程验证的既定原则有明确的答案。它在计算上不是不适定的。\n- **客观性**：语言精确客观，描述了一个标准的工程问题，没有主观或带有偏见的措辞。\n\n没有发现缺陷。该问题没有违反任何基本原则，对于手头的任务而言并非不完整或矛盾，并且代表了计算工程中一个现实的、非平凡的问题。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。现在将通过根据参数化系统模型验证的第一性原理评估每个提议的协议来推导解决方案。\n\n### 解决方案推导\n一个科学上合理的参数化降阶模型（pROM）验证协议必须满足几个关键标准：\n1.  **泛化能力评估**：pROM的主要目的是准确预测其构建过程中未使用的参数值 $\\boldsymbol{\\mu}$ 的系统行为。这需要将参数集 $\\mathcal{D}$ 严格划分为训练集 $\\mathcal{D}_{\\mathrm{train}}$（用于构建ROM）和测试集 $\\mathcal{D}_{\\mathrm{test}}$（用于验证）。\n2.  **物理可观测量评估**：验证应侧重于具有物理和工程意义的量，即系统的输出 $y(\\omega)$（例如，麦克风处的压力，加速度计处的速度）。ROM内部的非物理状态（例如 $\\mathbf{q}$）的误差是次要的。\n3.  **全面误差量化**：必须在整个操作域（即感兴趣的频带 $\\Omega$）上测量误差。适当的度量包括用于平均误差的积分范数（如 $L^2$ 范数）和用于最坏情况误差的上确界范数（如 $H_\\infty$ 范数），后者对于性能保证和稳定性分析至关重要。\n4.  **物理属性保持**：应检查ROM以确保其保留FOM的基本物理属性，例如稳定性（所有系统极点的实部均为负）和无源性（系统不产生能量）。\n5.  **稳健的统计报告**：在测试参数集 $\\mathcal{D}_{\\mathrm{test}}$ 上进行验证时，仅报告平均误差是不够的。需要包括中位数、四分位数以及高百分位数或最坏情况误差在内的统计摘要，以表征ROM的可靠性和稳健性。\n\n以这些原则为基准，对每个选项进行分析。\n\n### 逐项分析\n\n**A. 将场景参数集 $\\ldots$**\n该协议遵守了严格验证的所有原则。\n- 它通过将参数集 $\\mathcal{D}$ 划分为不相交的训练集和测试集（$\\mathcal{D}_{\\mathrm{train}}$, $\\mathcal{D}_{\\mathrm{test}}$）来正确实施交叉验证，这是评估跨工作场景泛化能力的正确方法。\n- 它评估了具有物理意义的输出（$y(\\omega)$）和特定的工程量，如声压、结构速度和辐射功率。\n- 它采用了一套基于系统理论和声学的全面误差度量：相对输出 $L^2$ 误差、误差系统的 $H_2$ 和 $H_\\infty$ 范数，以及领域特定的度量，如声压级（SPL）差异和模态置信准则（MAC）。\n- 它明确包括对基本系统属性（如稳定性和无源性）保持情况的检查。\n- 它提出了对测试集误差进行稳健的统计报告，使用中位数、四分位距（IQR）和百分位数，此外还包括最坏情况的频率分辨误差。\n这个协议是彻底的、多方面的，并且在科学上是合理的。\n**结论：正确**\n\n**B. 通过将单个工作场景的时域样本随机分入折中来进行 $\\,k\\,$-折交叉验证 $\\ldots$**\n这个协议存在根本性缺陷。\n- 它错误地应用了交叉验证。分割单个场景（$\\boldsymbol{\\mu}$）的时间序列数据并不能测试跨不同场景的泛化能力。该问题是在频域中提出的，这使得时域样本分割更加可疑。\n- 它关注内部状态误差（$\\|\\mathbf{z}_i - \\mathbf{V}\\mathbf{q}_i\\|_2^2$），这是一个投影误差，而不是具有物理意义的输出误差。\n- 它明确拒绝区分训练和测试场景，这是验证方法论中的一个致命错误。其提供的理由是荒谬的。\n**结论：不正确**\n\n**C. 通过在ROM基预测的一小组共振频率处检查ROM来进行验证 $\\ldots$**\n这个协议在方法上是不健全的。\n- 仅在共振频率处进行验证，对ROM准确性的描绘是极不完整的。对于系统的动态响应，非共振和反共振行为同样重要。\n- 它允许将训练数据包含在验证集中，这使得任何关于泛化能力的声明都无效。\n- 它提议对模型参数进行事后“调整”以实现“视觉匹配”，这将验证与调整混为一谈，并用主观评估取代了客观度量。这使得测试无效。\n**结论：不正确**\n\n**D. 跨场景执行交叉验证，但仅评估单个可观测量 $\\ldots$**\n这个协议过于简单化且不完整。\n- 虽然它正确地跨场景执行交叉验证，但它将评估限制在单个声压可观测量上。这忽略了耦合的结构动力学，并且没有提供关于其他重要量（如结构速度或基于能量的全局度量，例如辐射功率）的信息。\n- 使用单一误差度量（平均绝对误差）是不够的。它无法捕捉最坏情况下的频率行为（与 $H_\\infty$ 相关）或总能量。\n- 仅报告跨场景的平均误差，未能描述误差分布，并掩盖了在最坏情况场景中可能出现的较差性能。\n**结论：不正确**\n\n**E. 使用 $\\,\\boldsymbol{\\mu}\\,$ 的蒙特卡洛采样来构建验证集，但用一个更粗糙的模型替换FOM $\\ldots$**\n这个协议包含一个致命缺陷。\n- 它将ROM与一个粗化模型进行验证，而不是与原始的高保真FOM。这不是针对基准真相的ROM验证。这是两种不同近似（$\\text{ROM vs. 粗化FOM}$）之间的比较，如果不量化粗化模型本身的误差，所得到的误差是没有意义的。验证的根本基础是与最准确的可用模型（即FOM）进行比较。\n- 它将评估限制在时域脉冲响应和单个 $L^2$ 误差度量上，忽略了模型定义所在的至关重要的频域视角（特别是最坏情况的 $H_\\infty$ 误差）。\n**结论：不正确**\n\n结论：选项 A 是唯一描述了一个全面、多方面且科学严谨的验证协议的选项，该协议正确地处理了泛化能力、物理可观测量、适当的误差度量、系统属性和稳健的统计分析。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}