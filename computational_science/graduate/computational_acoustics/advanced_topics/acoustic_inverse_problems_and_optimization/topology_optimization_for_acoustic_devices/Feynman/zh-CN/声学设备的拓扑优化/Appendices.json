{
    "hands_on_practices": [
        {
            "introduction": "任何拓扑优化结果的可靠性都关键地取决于底层物理仿真的准确性。在计算声学中，一个核心挑战是数值色散，即由于离散化导致的波在网格上传播速度与其实际物理速度不同，这种“污染效应”会严重影响目标函数和灵敏度的计算。本练习将引导您通过一个一维亥姆霍兹方程的简单案例，亲手推导这种基本误差，从而深入理解离散化选择如何影响波速的准确性，为进行可靠的优化奠定基础。",
            "id": "4148050",
            "problem": "在角频率为 $\\omega$ 的声学消声器进行基于密度的拓扑优化时，均匀、无损的一维波导中的压力场 $p(x)$ 由时谐线性声学亥姆霍兹方程建模。对于恒定的质量密度 $\\rho$ 和体积模量 $\\kappa$，该方程简化为 $\\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} + k^{2} p = 0$，其中 $k = \\omega / c$ 且 $c = \\sqrt{\\kappa/\\rho}$。为了量化可能污染拓扑优化中目标和灵敏度评估的数值色散效应，我们考虑一个单元尺寸为 $h$ 的均匀网格，并在无限周期网格上使用标准的伽辽金有限元法（FEM），该方法采用线性形函数和一致质量矩阵。\n\n从弱形式出发，并使用上述离散化选择：\n- 推导内部节点处的组装离散方程，用节点值 $p_{i-1}$、$p_{i}$ 和 $p_{i+1}$ 表示。\n- 使用布洛赫波 ansatz $p_{j} = \\exp(\\mathrm{i} j \\theta)$（其中 $\\theta = k_{h} h$）来获得连续波数 $k$ 和离散波数 $k_{h}$ 之间的离散色散关系。\n- 从此关系中，推导当 $k h \\to 0$ 时相对相位误差 $\\varepsilon(k h) = \\frac{k_{h} - k}{k}$ 的主阶渐近展开。\n\n以 $k$ 和 $h$ 表示的 $\\varepsilon(k h)$ 主阶项的单个闭式解析表达式的形式提供最终答案。最终表达式中不要包含任何等号。无需进行数值四舍五入。最终表达式是无量纲的，因此不应报告任何单位。",
            "solution": "用户希望找到一维亥姆霍兹方程有限元离散化中相对相位误差的主阶项。\n\n验证步骤如下：\n\n### 第1步：提取已知条件\n- **控制方程**：压力场 $p(x)$ 的方程为 $\\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} + k^{2} p = 0$。\n- **常数**：质量密度 $\\rho$，体积模量 $\\kappa$。两者均为常数。\n- **波的性质**：角频率 $\\omega$，波数 $k = \\omega / c$，声速 $c = \\sqrt{\\kappa/\\rho}$。\n- **数值格式**：标准伽辽金有限元法（FEM）。\n- **离散化细节**：单元尺寸为 $h$ 的均匀网格，线性形函数，一致质量矩阵。\n- **域**：无限周期网格。\n- **节点变量**：三个连续节点处的压力值 $p_{i-1}$、$p_{i}$ 和 $p_{i+1}$。\n- **分析工具**：布洛赫波 ansatz $p_{j} = \\exp(\\mathrm{i} j \\theta)$，其中 $\\theta = k_{h} h$，$k_h$ 是离散波数。\n- **目标**：当 $k h \\to 0$ 时，推导相对相位误差 $\\varepsilon(k h) = \\frac{k_{h} - k}{k}$ 的主阶渐近展开。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学基础**：该问题是波传播数值分析中的一个标准练习，特别是针对有限元法的网格色散分析。亥姆霍兹方程、伽辽金法、线性单元、一致质量矩阵和布洛赫波分析都是计算力学和声学中基本且成熟的概念。问题的前提是可靠的。\n- **适定性**：问题陈述清晰，并提供了分步的求解过程。它要求一个具体的、可推导的量（相位误差的主阶项）。问题设定是自洽的，足以推导出唯一答案。\n- **客观性**：语言精确且数学化。没有主观或模糊的术语。\n\n### 第3步：结论与行动\n该问题是有效的，因为它具有科学基础、适定、客观且完整。我将继续进行求解。\n\n解答是通过遵循问题陈述中概述的步骤得出的。\n\n首先，我们建立亥姆霍兹方程的弱形式。我们将控制方程乘以一个合适的检验函数 $v(x)$，并在域上积分。对于内部节点 $i$ 处的方程，在相应基函数 $N_i(x)$ 的支集 $[x_{i-1}, x_{i+1}]$ 上积分就足够了。\n$$ \\int_{x_{i-1}}^{x_{i+1}} v \\left( \\frac{\\mathrm{d}^{2}p}{\\mathrm{d}x^{2}} + k^{2}p \\right) \\mathrm{d}x = 0 $$\n对二阶导数项应用分部积分法，得到：\n$$ \\left[ v \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\right]_{x_{i-1}}^{x_{i+1}} - \\int_{x_{i-1}}^{x_{i+1}} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\mathrm{d}x + k^{2} \\int_{x_{i-1}}^{x_{i+1}} v p \\, \\mathrm{d}x = 0 $$\n在伽辽金法中，检验函数 $v(x)$ 与试探函数选自同一空间。我们选择 $v(x) = N_i(x)$，即以节点 $i$ 为中心的线性“帽子”函数，它在 $x_{i-1}$ 和 $x_{i+1}$ 处为零。因此，边界项消失。节点 $i$ 的弱形式为：\n$$ - \\int_{x_{i-1}}^{x_{i+1}} \\frac{\\mathrm{d}N_i}{\\mathrm{d}x} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\mathrm{d}x + k^{2} \\int_{x_{i-1}}^{x_{i+1}} N_i p \\, \\mathrm{d}x = 0 $$\n接下来，我们使用线性形函数对压力场 $p(x)$ 进行离散化：$p(x) \\approx p_h(x) = \\sum_{j} p_j N_j(x)$，其中 $p_j$ 是节点压力值。将此代入弱形式，得到节点 $i$ 的离散方程：\n$$ \\sum_{j} p_j \\left( - \\int \\frac{\\mathrm{d}N_i}{\\mathrm{d}x} \\frac{\\mathrm{d}N_j}{\\mathrm{d}x} \\mathrm{d}x + k^2 \\int N_i N_j \\mathrm{d}x \\right) = 0 $$\n这可以写成矩阵形式 $(K - k^2 M)\\mathbf{p} = \\mathbf{0}$，其中 $K$ 是刚度矩阵，$M$ 是一致质量矩阵。为了找到节点 $i$ 的具体方程，我们需要长度为 $h$ 的一维线性单元的单元刚度矩阵 $K^e$ 和质量矩阵 $M^e$。它们由以下公式给出：\n$$ K^e = \\frac{1}{h}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad M^e = \\frac{h}{6}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n组装与节点 $i$ 相邻的两个单元（即 $[x_{i-1}, x_i]$ 和 $[x_i, x_{i+1}]$）的贡献，得到全局系统第 $i$ 行的模板：\n刚度部分：$\\frac{1}{h}(-p_{i-1} + 2p_i - p_{i+1})$\n质量部分：$\\frac{h}{6}(p_{i-1} + 4p_i + p_{i+1})$\n内部节点 $i$ 处的组装离散方程为：\n$$ \\frac{1}{h}(-p_{i-1} + 2p_i - p_{i+1}) - k^2 \\frac{h}{6}(p_{i-1} + 4p_i + p_{i+1}) = 0 $$\n现在，我们通过将 ansatz $p_j = \\exp(\\mathrm{i} j \\theta)$（其中 $\\theta = k_h h$）代入该方程来进行布洛赫波分析。这里，$k_h$ 是数值波数。\n$$ \\frac{1}{h}(-\\exp(\\mathrm{i}(i-1)\\theta) + 2\\exp(\\mathrm{i}i\\theta) - \\exp(\\mathrm{i}(i+1)\\theta)) - k^2 \\frac{h}{6}(\\exp(\\mathrm{i}(i-1)\\theta) + 4\\exp(\\mathrm{i}i\\theta) + \\exp(\\mathrm{i}(i+1)\\theta)) = 0 $$\n除以公因子 $\\exp(\\mathrm{i}i\\theta)$：\n$$ \\frac{1}{h}(-\\exp(-\\mathrm{i}\\theta) + 2 - \\exp(\\mathrm{i}\\theta)) - k^2 \\frac{h}{6}(\\exp(-\\mathrm{i}\\theta) + 4 + \\exp(\\mathrm{i}\\theta)) = 0 $$\n使用欧拉公式 $\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta) = 2\\cos(\\theta)$，我们简化方程：\n$$ \\frac{1}{h}(2 - 2\\cos(\\theta)) - k^2 \\frac{h}{6}(4 + 2\\cos(\\theta)) = 0 $$\n这就是离散色散关系。我们求解 $k^2$ 以将其与数值参数关联起来：\n$$ k^2 = \\frac{\\frac{2}{h}(1-\\cos(\\theta))}{\\frac{h}{3}(2+\\cos(\\theta))} = \\frac{6(1-\\cos(\\theta))}{h^2(2+\\cos(\\theta))} $$\n代入 $\\theta = k_h h$ 并使用半角恒等式 $1-\\cos(x) = 2\\sin^2(x/2)$：\n$$ (kh)^2 = \\frac{6(1-\\cos(k_h h))}{2+\\cos(k_h h)} = \\frac{12\\sin^2(k_h h / 2)}{2+\\cos(k_h h)} $$\n为了找到当 $kh \\to 0$ 时 $\\varepsilon(kh) = \\frac{k_h-k}{k}$ 的主阶渐近展开，我们对该关系在小参数下进行泰勒级数展开。设 $\\phi = k_h h$。当 $kh \\to 0$ 时，我们也有 $\\phi \\to 0$。正弦和余弦的泰勒展开式为：\n$$ \\sin(x) = x - \\frac{x^3}{6} + O(x^5), \\quad \\cos(x) = 1 - \\frac{x^2}{2} + \\frac{x^4}{24} + O(x^6) $$\n展开色散关系的分子和分母：\n$$ 12\\sin^2(\\phi/2) = 12 \\left( \\frac{\\phi}{2} - \\frac{1}{6}\\left(\\frac{\\phi}{2}\\right)^3 + \\dots \\right)^2 = 12 \\left( \\frac{\\phi^2}{4} - \\frac{\\phi^4}{48} + \\dots \\right) = 3\\phi^2 - \\frac{\\phi^4}{4} + O(\\phi^6) $$\n$$ 2+\\cos(\\phi) = 2 + \\left( 1 - \\frac{\\phi^2}{2} + \\frac{\\phi^4}{24} + \\dots \\right) = 3 - \\frac{\\phi^2}{2} + \\frac{\\phi^4}{24} + \\dots $$\n将这些代回 $(kh)^2$ 的关系式中：\n$$ (kh)^2 = \\frac{3\\phi^2 - \\frac{\\phi^4}{4} + O(\\phi^6)}{3 - \\frac{\\phi^2}{2} + O(\\phi^4)} = \\frac{\\phi^2(1 - \\frac{\\phi^2}{12} + \\dots)}{1 - \\frac{\\phi^2}{6} + \\dots} $$\n对于小 $x$，使用几何级数近似 $(1-x)^{-1} \\approx 1+x$：\n$$ (kh)^2 \\approx \\phi^2 \\left(1 - \\frac{\\phi^2}{12}\\right) \\left(1 + \\frac{\\phi^2}{6}\\right) \\approx \\phi^2 \\left(1 + \\frac{\\phi^2}{6} - \\frac{\\phi^2}{12}\\right) = \\phi^2 \\left(1 + \\frac{\\phi^2}{12}\\right) = \\phi^2 + \\frac{\\phi^4}{12} $$\n所以我们有 $(kh)^2 = (k_h h)^2 + \\frac{(k_h h)^4}{12} + O((k_h h)^6)$。我们需要反转这个关系式以用 $k$ 来表示 $k_h$。\n$$ (k_h h)^2 = (kh)^2 - \\frac{(k_h h)^4}{12} + \\dots $$\n在修正项中，我们可以做主阶近似 $(k_h h)^4 \\approx (kh)^4$。\n$$ (k_h h)^2 \\approx (kh)^2 - \\frac{(kh)^4}{12} $$\n取平方根并使用二项式近似 $\\sqrt{1-x} \\approx 1-x/2$：\n$$ k_h h \\approx \\sqrt{(kh)^2 \\left(1 - \\frac{(kh)^2}{12}\\right)} = (kh) \\sqrt{1 - \\frac{(kh)^2}{12}} \\approx (kh)\\left(1 - \\frac{(kh)^2}{24}\\right) $$\n$$ k_h h \\approx kh - \\frac{(kh)^3}{24} $$\n除以 $h$：\n$$ k_h \\approx k - \\frac{k^3 h^2}{24} $$\n相对相位误差为 $\\varepsilon(kh) = (k_h - k)/k$。\n$$ \\varepsilon(kh) \\approx \\frac{(k - \\frac{k^3 h^2}{24}) - k}{k} = \\frac{-\\frac{k^3 h^2}{24}}{k} = -\\frac{k^2 h^2}{24} $$\n因此，相对相位误差的主阶项是 $-\\frac{k^2 h^2}{24}$。",
            "answer": "$$\\boxed{-\\frac{k^2 h^2}{24}}$$"
        },
        {
            "introduction": "掌握了数值仿真的基本精度问题后，我们转向一个强大而具体的应用：设计声子晶体等周期性声学器件。由于其无限周期性，分析这些结构需要一种特殊的方法，即布洛赫-弗洛凯定理。本实践将指导您应用该定理，为周期单元推导必要的伪周期边界条件，并将色散分析问题转化为一个广义埃尔米特特征值问题，这是声学带隙工程和超材料设计的基石。",
            "id": "4148066",
            "problem": "考虑一个用于声学器件拓扑优化的二维（$2\\mathrm{D}$）声子晶体。其周期性原胞为方形域 $\\Omega = [0,a] \\times [0,a]$，晶格常数 $a>0$。该设计由一个空间变化的标量场 $\\chi(\\mathbf{x}) \\in [0,1]$ 表示，该场在两个方向上均以 $a$ 为周期，并通过关系式 $\\rho(\\mathbf{x}) = \\rho_{s} \\chi(\\mathbf{x}) + \\rho_{f} (1 - \\chi(\\mathbf{x}))$ 和 $K(\\mathbf{x}) = K_{s} \\chi(\\mathbf{x}) + K_{f} (1 - \\chi(\\mathbf{x}))$ 在密度为 $\\rho_{s}$、体积模量为 $K_{s}$ 的固相与密度为 $\\rho_{f}$、体积模量为 $K_{f}$ 的流体相之间插值材料属性。假设为时谐声学问题，角频率为 $\\omega$，粘性可忽略，且运动学是线性化的。令 $p(\\mathbf{x})$ 表示复声压场。在频域中，非均匀可压缩介质的控制方程为标量亥姆霍兹型方程\n$$\n\\nabla \\cdot \\left( \\frac{1}{\\rho(\\mathbf{x})} \\nabla p(\\mathbf{x}) \\right) + \\omega^{2} \\frac{1}{K(\\mathbf{x})} p(\\mathbf{x}) = 0 \\quad \\text{in } \\Omega,\n$$\n其中材料系数 $\\rho(\\mathbf{x})$ 和 $K(\\mathbf{x})$ 是以 $a$ 为周期的。该晶体在第一布里渊区中给定波矢 $\\mathbf{k} = (k_{x}, k_{y})$ 的情况下，根据 Bloch–Floquet 条件进行分析。\n\n任务：\n- 从材料系数的周期性和上述线性声学控制方程出发，利用 Bloch 定理推导声压 $p(\\mathbf{x})$ 在 $\\Omega$ 相对边界面上必须满足的 Bloch–Floquet 边界条件，并用与波矢 $\\mathbf{k}$ 和晶格平移相关的相位因子明确表示。\n- 使用 Bloch 假设 $p(\\mathbf{x}) = u(\\mathbf{x}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$（其中 $u(\\mathbf{x})$ 是以 $a$ 为周期的），推导原胞 $\\Omega$ 上的弱形式，并证明当通过有限元方法（FEM）离散化后，色散分析可简化为形如 $\\mathbf{K}(\\mathbf{k}) \\mathbf{u} = \\omega^{2} \\mathbf{M} \\mathbf{u}$ 的广义厄米特征问题。清晰地指出定义 $\\mathbf{K}(\\mathbf{k})$ 和 $\\mathbf{M}$ 的双线性形式。\n- 对于原胞均匀且具有恒定属性 $\\rho(\\mathbf{x}) \\equiv \\rho_{0}$ 和 $K(\\mathbf{x}) \\equiv K_{0}$ 的特殊基准情况，考虑截断至仅包含单个基频 Bloch 谐波的平面波展开。推导在整个第一布里渊区上，最低分支色散关系 $\\omega(\\mathbf{k})$ 的闭式解析表达式。\n\n答案形式：\n- 仅提供最低分支色散关系 $\\omega(k_{x}, k_{y})$ 的闭式最终表达式。无需进行数值计算。最终答案框中不要包含单位。",
            "solution": "问题陈述具有科学依据、自洽且适定。它代表了计算声学和声子晶体理论领域的一个标准问题。所有提供的信息都是一致的，并且足以完成所要求的推导。因此，该问题是有效的，下面提供完整解答。\n\n该问题涉及分析声波在二维周期性介质（声子晶体）中的传播。分析基于 Bloch-Floquet 定理，这是描述具有周期性系数的偏微分方程系统的基本结果。\n\n首先，我们推导声压场 $p(\\mathbf{x})$ 的 Bloch-Floquet 边界条件。材料属性 $\\rho(\\mathbf{x})$ 和 $K(\\mathbf{x})$ 相对于晶格平移是周期性的。原胞是一个边长为 $a$ 的正方形，因此晶格矢量由基矢 $\\mathbf{a}_1 = (a, 0)$ 和 $\\mathbf{a}_2 = (0, a)$ 生成。任何晶格平移矢量都可以写成 $\\mathbf{R} = n_1 \\mathbf{a}_1 + n_2 \\mathbf{a}_2$，其中 $n_1, n_2$ 为整数。Bloch 定理指出，对于给定的波矢 $\\mathbf{k}$，控制波动方程的解 $p(\\mathbf{x})$ 必须满足以下条件：\n$$\np(\\mathbf{x} + \\mathbf{R}) = p(\\mathbf{x}) \\exp(i \\mathbf{k} \\cdot \\mathbf{R})\n$$\n我们将此定理应用于原胞 $\\Omega = [0,a] \\times [0,a]$ 的边界。对于位于 $x=0$ 和 $x=a$ 的垂直边界，相关的平移矢量是 $\\mathbf{R} = \\mathbf{a}_1 = (a, 0)$。对于左边界上的任意点 $(0, y)$，其在右边界上的周期性等效点是 $(a, y) = (0, y) + (a, 0)$。应用 Bloch 定理可得：\n$$\np(a, y) = p(0, y) \\exp(i \\mathbf{k} \\cdot (a, 0)) = p(0, y) \\exp(i k_x a)\n$$\n类似地，对于位于 $y=0$ 和 $y=a$ 的水平边界，平移矢量是 $\\mathbf{R} = \\mathbf{a}_2 = (0, a)$。对于下边界上的任意点 $(x, 0)$，其在上边界上的等效点是 $(x, a) = (x, 0) + (0, a)$。这得出：\n$$\np(x, a) = p(x, 0) \\exp(i \\mathbf{k} \\cdot (0, a)) = p(x, 0) \\exp(i k_y a)\n$$\n这些是原胞 $\\Omega$ 上压力场 $p(\\mathbf{x})$ 的 Bloch-Floquet 边界条件。它们是伪周期性边界条件，其周期性由波矢 $\\mathbf{k}$ 决定的相位因子所调制。\n\n第二，我们推导弱形式，并证明它导出一个广义厄米特征问题。Bloch 假设将压力场 $p(\\mathbf{x})$ 分解为一个周期部分 $u(\\mathbf{x})$ 和一个平面波相位因子：\n$$\np(\\mathbf{x}) = u(\\mathbf{x}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n其中 $u(\\mathbf{x})$ 是以 $a$ 为周期的，即 $u(\\mathbf{x}+\\mathbf{R}) = u(\\mathbf{x})$。为了找到 $u(\\mathbf{x})$ 的控制方程，我们将该假设代入原始偏微分方程。$p$ 的梯度为：\n$$\n\\nabla p = \\nabla(u \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = (\\nabla u) \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) + u (i\\mathbf{k}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) = (\\nabla u + i\\mathbf{k}u) \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n我们定义算子 $\\nabla_{\\mathbf{k}} \\equiv \\nabla + i\\mathbf{k}$。则 $\\nabla p = (\\nabla_{\\mathbf{k}} u) \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$。应用散度算子：\n$$\n\\nabla \\cdot \\left( \\frac{1}{\\rho} \\nabla p \\right) = \\nabla \\cdot \\left( \\frac{1}{\\rho} (\\nabla_{\\mathbf{k}} u) \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) \\right) = (\\nabla_{\\mathbf{k}} \\cdot (\\frac{1}{\\rho} \\nabla_{\\mathbf{k}} u)) \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n将此代入控制方程并消去非零因子 $\\exp(i \\mathbf{k} \\cdot \\mathbf{x})$，得到 $u(\\mathbf{x})$ 的偏微分方程：\n$$\n\\nabla_{\\mathbf{k}} \\cdot \\left( \\frac{1}{\\rho} \\nabla_{\\mathbf{k}} u \\right) + \\frac{\\omega^2}{K} u = 0\n$$\n为了获得弱形式，我们乘以一个周期性检验函数 $\\bar{v}(\\mathbf{x})$（其中 $v(\\mathbf{x})$ 与 $u(\\mathbf{x})$ 属于同一函数空间），并在原胞 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} \\bar{v} \\left( \\nabla_{\\mathbf{k}} \\cdot \\left( \\frac{1}{\\rho} \\nabla_{\\mathbf{k}} u \\right) \\right) d\\mathbf{x} + \\omega^2 \\int_{\\Omega} \\frac{1}{K} \\bar{v} u \\, d\\mathbf{x} = 0\n$$\n我们对第一项应用分部积分（Green 第一恒等式）。令 $\\mathbf{F} = \\frac{1}{\\rho} \\nabla_{\\mathbf{k}} u$。则 $\\int_{\\Omega} \\bar{v} (\\nabla_{\\mathbf{k}} \\cdot \\mathbf{F}) d\\mathbf{x} = \\int_{\\Omega} \\bar{v} (\\nabla \\cdot \\mathbf{F} + i\\mathbf{k} \\cdot \\mathbf{F}) d\\mathbf{x}$。\n$$\n\\int_{\\Omega} \\bar{v} (\\nabla \\cdot \\mathbf{F}) d\\mathbf{x} = -\\int_{\\Omega} (\\nabla \\bar{v}) \\cdot \\mathbf{F} \\, d\\mathbf{x} + \\oint_{\\partial \\Omega} \\bar{v} (\\mathbf{F} \\cdot \\mathbf{n}) \\, dS\n$$\n边界积分 $\\oint_{\\partial \\Omega}$ 为零。这是因为被积函数 $\\bar{v} \\frac{1}{\\rho} (\\nabla_{\\mathbf{k}} u) \\cdot \\mathbf{n}$ 在相对边界面上是周期性的（因为 $v$、$\\rho$ 和 $u$ 都是周期性的），而外法向矢量 $\\mathbf{n}$ 的方向相反（例如，$\\mathbf{n}|_{x=a} = -\\mathbf{n}|_{x=0}$）。\n因此，弱形式变为：\n$$\n-\\int_{\\Omega} (\\nabla \\bar{v}) \\cdot (\\frac{1}{\\rho} \\nabla_{\\mathbf{k}} u) d\\mathbf{x} + \\int_{\\Omega} \\bar{v} (i\\mathbf{k}) \\cdot (\\frac{1}{\\rho} \\nabla_{\\mathbf{k}} u) d\\mathbf{x} + \\omega^2 \\int_{\\Omega} \\frac{1}{K} \\bar{v} u \\, d\\mathbf{x} = 0\n$$\n合并前两项：\n$$\n-\\int_{\\Omega} (\\nabla \\bar{v} - i\\mathbf{k} \\bar{v}) \\cdot (\\frac{1}{\\rho} (\\nabla u + i\\mathbf{k} u)) d\\mathbf{x} + \\omega^2 \\int_{\\Omega} \\frac{1}{K} \\bar{v} u \\, d\\mathbf{x} = 0\n$$\n使用性质 $\\nabla \\bar{v} - i\\mathbf{k} \\bar{v} = \\overline{\\nabla v + i\\mathbf{k} v} = \\overline{\\nabla_{\\mathbf{k}} v}$，我们将方程重新整理为典范形式 $a(u,v) = \\lambda b(u,v)$：\n$$\n\\int_{\\Omega} \\frac{1}{\\rho(\\mathbf{x})} \\overline{(\\nabla_{\\mathbf{k}} v)} \\cdot (\\nabla_{\\mathbf{k}} u) \\, d\\mathbf{x} = \\omega^2 \\int_{\\Omega} \\frac{1}{K(\\mathbf{x})} \\bar{v} u \\, d\\mathbf{x}\n$$\n这是一个关于特征对 $(\\omega^2, u)$ 的变分问题。在使用有限元方法进行离散化时，将 $u$ 和 $v$ 在一组形函数 $\\{N_j(\\mathbf{x})\\}$ 基中展开，该方程便产生一个广义矩阵特征问题 $\\mathbf{K}(\\mathbf{k}) \\mathbf{u} = \\omega^2 \\mathbf{M} \\mathbf{u}$。这些矩阵由以下半双线性形式定义：\n刚度矩阵 $\\mathbf{K}(\\mathbf{k})$ 由以下形式导出：\n$$\na(u,v) = \\int_{\\Omega} \\frac{1}{\\rho(\\mathbf{x})} \\overline{(\\nabla v + i\\mathbf{k} v)} \\cdot (\\nabla u + i\\mathbf{k} u) \\, d\\mathbf{x}\n$$\n质量矩阵 $\\mathbf{M}$ 由以下形式导出：\n$$\nb(u,v) = \\int_{\\Omega} \\frac{1}{K(\\mathbf{x})} \\bar{v} u \\, d\\mathbf{x}\n$$\n两种形式 $a(u,v)$ 和 $b(u,v)$ 都是厄米（Hermitian）的（即 $a(u,v) = \\overline{a(v,u)}$），因此得到的矩阵 $\\mathbf{K}(\\mathbf{k})$ 和 $\\mathbf{M}$ 也是厄米矩阵。这保证了特征值 $\\omega^2$ 是实数。\n\n第三，我们推导均匀基准情况下的色散关系，其中 $\\rho(\\mathbf{x}) \\equiv \\rho_0$ 且 $K(\\mathbf{x}) \\equiv K_0$。控制方程简化为标准亥姆霍兹方程：\n$$\n\\nabla \\cdot \\left( \\frac{1}{\\rho_0} \\nabla p \\right) + \\omega^{2} \\frac{1}{K_0} p = 0 \\quad \\implies \\quad \\nabla^2 p + \\frac{\\omega^2 \\rho_0}{K_0} p = 0\n$$\n我们定义均匀介质中的声速为 $c_0 = \\sqrt{K_0 / \\rho_0}$。方程变为：\n$$\n\\nabla^2 p + \\frac{\\omega^2}{c_0^2} p = 0\n$$\n问题要求考虑截断至“单个基频 Bloch 谐波”的展开。在均匀介质中，一个精确解是单一平面波。这对应于 Bloch 假设 $p(\\mathbf{x}) = u(\\mathbf{x})\\exp(i\\mathbf{k}\\cdot\\mathbf{x})$，其中周期部分 $u(\\mathbf{x})$ 是一个常数，$u(\\mathbf{x})=u_0$。因此，我们寻求以下形式的解：\n$$\np(\\mathbf{x}) = u_0 \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n其中 $\\mathbf{k} = (k_x, k_y)$ 是波矢。我们将此假设代入均匀亥姆霍兹方程：\n$$\n\\nabla^2 (u_0 \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) + \\frac{\\omega^2}{c_0^2} (u_0 \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = 0\n$$\n计算拉普拉斯算子：\n$$\n\\nabla (u_0 \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = u_0 (i \\mathbf{k}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n$$\n\\nabla^2 (u_0 \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = \\nabla \\cdot (u_0 (i \\mathbf{k}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = u_0 (i \\mathbf{k}) \\cdot (i \\mathbf{k}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) = - |\\mathbf{k}|^2 u_0 \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n将此代回，我们得到：\n$$\n- |\\mathbf{k}|^2 u_0 \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) + \\frac{\\omega^2}{c_0^2} u_0 \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) = 0\n$$\n对于非平凡解（$u_0 \\neq 0$），我们可以消去公因子以获得色散关系：\n$$\n- |\\mathbf{k}|^2 + \\frac{\\omega^2}{c_0^2} = 0\n$$\n解出角频率 $\\omega$（并取具有物理意义的正根）：\n$$\n\\omega^2 = c_0^2 |\\mathbf{k}|^2 \\implies \\omega(\\mathbf{k}) = c_0 |\\mathbf{k}|\n$$\n代入 $c_0 = \\sqrt{K_0 / \\rho_0}$ 和 $|\\mathbf{k}| = \\sqrt{k_x^2 + k_y^2}$，我们得到最低分支色散关系的闭式表达式：\n$$\n\\omega(k_x, k_y) = \\sqrt{\\frac{K_0}{\\rho_0}} \\sqrt{k_x^2 + k_y^2} = \\sqrt{\\frac{K_0(k_x^2 + k_y^2)}{\\rho_0}}\n$$",
            "answer": "$$\\boxed{\\sqrt{\\frac{K_{0}}{\\rho_{0}}(k_{x}^{2} + k_{y}^{2})}}$$"
        },
        {
            "introduction": "在解决了仿真精度和特定结构建模之后，我们的焦点转移到拓扑优化的核心——“优化”本身。拓扑导数是一种强大的灵敏度分析工具，它能直接告诉我们在何处引入新的材料相（例如，创建一个小孔）能最有效地改善设计。本练习通过一个简化的假设，揭示了其核心物理直觉：目标函数的改变与微扰点的局部能量密度直接相关，这为基于梯度的拓扑演化提供了深刻见解。",
            "id": "4148063",
            "problem": "考虑一个有界域 $\\Omega \\subset \\mathbb{R}^{3}$，其中充满了密度为 $\\rho > 0$、体积模量为 $\\kappa > 0$ 的均匀、无粘、可压缩流体。在角频率为 $\\omega > 0$ 的时谐激励下，声压 $p:\\Omega \\to \\mathbb{C}$ 和质点速度 $v:\\Omega \\to \\mathbb{C}^{3}$ 满足线性声学关系 $v(x) = \\frac{1}{i \\omega \\rho} \\nabla p(x)$ 以及流体中的控制亥姆霍兹型偏微分方程 (PDE)（此处未明确指定边界条件或源，因为局部分析不需要它们）。在 $x \\in \\Omega$ 处的时均声能密度定义为\n$$\nw(x) = \\frac{|p(x)|^{2}}{4 \\kappa} + \\frac{\\rho}{4} |v(x)|^{2}.\n$$\n考虑一个与流体中总储存声能成正比的柔度型目标泛函，\n$$\nJ(\\Omega) = \\int_{\\Omega} w(x)\\, \\mathrm{d}x.\n$$\n假设在点 $x_{0} \\in \\Omega$ 处生成一个半径为 $\\varepsilon$ 的刚性、声硬球形夹杂物 $B_{\\varepsilon}(x_{0})$，从而产生受扰动域 $\\Omega_{\\varepsilon} = \\Omega \\setminus B_{\\varepsilon}(x_{0})$。该刚性夹杂物使其边界上的法向流体速度为零，并且其内部不储存流体声能。$J$ 在 $x_{0}$ 处关于移除流体并插入刚性夹杂物的拓扑导数定义为\n$$\nD_{T}J(x_{0}) = \\lim_{\\varepsilon \\to 0^{+}} \\frac{J(\\Omega \\setminus B_{\\varepsilon}(x_{0})) - J(\\Omega)}{|B_{\\varepsilon}(x_{0})|},\n$$\n其中 $|B_{\\varepsilon}(x_{0})|$ 表示该球的体积。假设插入前的场 $(p,v)$ 在 $x_{0}$ 处是光滑的，并且在 $\\varepsilon$ 的主阶上，$J(\\Omega \\setminus B_{\\varepsilon}(x_{0})) - J(\\Omega)$ 的主要贡献来自于移除 $B_{\\varepsilon}(x_{0})$ 中的流体能量；也就是说，由散射引起的场扰动的贡献为 $o(|B_{\\varepsilon}(x_{0})|)$ 阶。再假设 $w(x_{0}) > 0$。\n\n在这些假设下，计算 $D_{T}J(x_{0})$ 的符号。请用一个无量纲的符号值（负为 $-1$，零为 $0$，正为 $+1$）表示你的最终答案。然后，简要解释此符号的意义，即引入一个刚性夹杂物是局部地减小还是增大了该柔度型目标。不需要四舍五入，最终答案中不应包含任何物理单位。",
            "solution": "该问题要求确定柔度型目标泛函 $J(\\Omega)$ 在点 $x_{0} \\in \\Omega$ 处的拓扑导数 $D_{T}J(x_{0})$ 的符号。泛函 $J$ 表示在充满流体的域 $\\Omega$ 中储存的总时均声能。拓扑扰动包括在 $x_{0}$ 处生成一个小的、刚性（声硬）的球形夹杂物。\n\n拓扑导数定义为：\n$$\nD_{T}J(x_{0}) = \\lim_{\\varepsilon \\to 0^{+}} \\frac{J(\\Omega_{\\varepsilon}) - J(\\Omega)}{|B_{\\varepsilon}(x_{0})|}\n$$\n其中 $\\Omega_{\\varepsilon} = \\Omega \\setminus B_{\\varepsilon}(x_{0})$ 是引入半径为 $\\varepsilon$、体积为 $|B_{\\varepsilon}(x_{0})|$ 的球形夹杂物 $B_{\\varepsilon}(x_{0})$ 后的域，而 $J(\\Omega) = \\int_{\\Omega} w(x)\\, \\mathrm{d}x$ 是目标泛函，其中 $w(x)$ 是时均声能密度。\n\n设 $w(x)$ 是未扰动状态的能量密度，$w_{\\varepsilon}(x)$ 是受扰动域 $\\Omega_{\\varepsilon}$ 中的能量密度。受扰动域的目标泛函为 $J(\\Omega_{\\varepsilon}) = \\int_{\\Omega_{\\varepsilon}} w_{\\varepsilon}(x)\\, \\mathrm{d}x$。我们分析拓扑导数分数中的分子，它表示总储存能量的变化：\n$$\nJ(\\Omega_{\\varepsilon}) - J(\\Omega) = \\int_{\\Omega \\setminus B_{\\varepsilon}(x_{0})} w_{\\varepsilon}(x)\\, \\mathrm{d}x - \\int_{\\Omega} w(x)\\, \\mathrm{d}x\n$$\n我们可以将原域 $\\Omega$ 上的积分分解为两部分：夹杂物外部的区域和夹杂物内部的区域。\n$$\n\\int_{\\Omega} w(x)\\, \\mathrm{d}x = \\int_{\\Omega \\setminus B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x + \\int_{B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x\n$$\n将此代入 $J$ 的变化表达式中，得到：\n$$\nJ(\\Omega_{\\varepsilon}) - J(\\Omega) = \\int_{\\Omega \\setminus B_{\\varepsilon}(x_{0})} w_{\\varepsilon}(x)\\, \\mathrm{d}x - \\left( \\int_{\\Omega \\setminus B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x + \\int_{B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x \\right)\n$$\n重新整理这些项，我们得到：\n$$\nJ(\\Omega_{\\varepsilon}) - J(\\Omega) = \\int_{\\Omega \\setminus B_{\\varepsilon}(x_{0})} (w_{\\varepsilon}(x) - w(x))\\, \\mathrm{d}x - \\int_{B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x\n$$\n这个表达式将能量的变化分为两个部分：\n1. 第一项 $\\int_{\\Omega \\setminus B_{\\varepsilon}(x_{0})} (w_{\\varepsilon}(x) - w(x))\\, \\mathrm{d}x$ 表示由于新夹杂物对声场的散射，周围流体中储存能量的变化。\n2. 第二项 $-\\int_{B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x$ 表示最初储存在体积 $B_{\\varepsilon}(x_{0})$ 中的能量，该体积已被移除并替换为不储存声能的刚性材料。\n\n问题提供了一个关键的简化假设：“在 $\\varepsilon$ 的主阶上，$J(\\Omega \\setminus B_{\\varepsilon}(x_{0})) - J(\\Omega)$ 的主要贡献来自于移除 $B_{\\varepsilon}(x_{0})$ 中的流体能量；也就是说，由散射引起的场扰动的贡献为 $o(|B_{\\varepsilon}(x_{0})|)$ 阶。” 这说明第一项比夹杂物的体积是更高阶的无穷小：\n$$\n\\int_{\\Omega \\setminus B_{\\varepsilon}(x_{0})} (w_{\\varepsilon}(x) - w(x))\\, \\mathrm{d}x = o(|B_{\\varepsilon}(x_{0})|)\n$$\n因此，泛函变化的主阶行为由第二项决定：\n$$\nJ(\\Omega_{\\varepsilon}) - J(\\Omega) = - \\int_{B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x + o(|B_{\\varepsilon}(x_{0})|)\n$$\n现在我们可以计算拓扑导数的极限：\n$$\nD_{T}J(x_{0}) = \\lim_{\\varepsilon \\to 0^{+}} \\frac{- \\int_{B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x + o(|B_{\\varepsilon}(x_{0})|)}{|B_{\\varepsilon}(x_{0})|}\n$$\n$$\nD_{T}J(x_{0}) = - \\lim_{\\varepsilon \\to 0^{+}} \\frac{\\int_{B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x}{|B_{\\varepsilon}(x_{0})|} + \\lim_{\\varepsilon \\to 0^{+}} \\frac{o(|B_{\\varepsilon}(x_{0})|)}{|B_{\\varepsilon}(x_{0})|}\n$$\n根据小o记号的定义，第二个极限为 $0$。第一个极限涉及函数 $w(x)$ 在一个以 $x_{0}$ 为中心且体积趋于零的区域上的积分。由于假设原始声场在 $x_{0}$ 处是光滑的，所以能量密度函数 $w(x)$ 在 $x_{0}$ 处是连续的。根据勒贝格微分定理（或者简单地从积分的导数定义），该极限等于被积函数在点 $x_{0}$ 处的值：\n$$\n\\lim_{\\varepsilon \\to 0^{+}} \\frac{\\int_{B_{\\varepsilon}(x_{0})} w(x)\\, \\mathrm{d}x}{|B_{\\varepsilon}(x_{0})|} = w(x_{0})\n$$\n因此，拓扑导数为：\n$$\nD_{T}J(x_{0}) = -w(x_{0})\n$$\n为了找到 $D_{T}J(x_{0})$ 的符号，我们检查 $w(x_{0})$ 的符号。时均声能密度由下式给出：\n$$\nw(x) = \\frac{|p(x)|^{2}}{4 \\kappa} + \\frac{\\rho}{4} |v(x)|^{2}\n$$\n问题陈述流体密度 $\\rho > 0$ 且体积模量 $\\kappa > 0$。项 $|p(x)|^{2}$ 和 $|v(x)|^{2}$ 是复数模的平方，因此它们总为非负。这意味着对于所有 $x \\in \\Omega$，$w(x) \\geq 0$。\n此外，问题明确假设 $w(x_{0}) > 0$。\n因为 $w(x_{0})$ 是一个严格正实数，所以它的负数 $-w(x_{0})$ 必定是一个严格负实数。\n$$\nD_{T}J(x_{0})  0\n$$\n拓扑导数的符号为负。问题要求将此符号表示为一个无量纲值，所以答案是 $-1$。\n\n这个负号的解释是，在一个声能密度非零的点 $x_0$ 处引入一个小的、刚性（声硬）的夹杂物，会导致总储存声能 $J$ 在一阶上减小。泛函 $J$ 被描述为“柔度型”的，因此如果目标是最小化流体中的总储存能量，那么这种修改可以被看作是一个有利的改变。这是很直观的，因为所考虑的主要效应是从体积 $B_{\\varepsilon}(x_{0})$ 中移除了含能量的流体。",
            "answer": "$$\\boxed{-1}$$"
        }
    ]
}