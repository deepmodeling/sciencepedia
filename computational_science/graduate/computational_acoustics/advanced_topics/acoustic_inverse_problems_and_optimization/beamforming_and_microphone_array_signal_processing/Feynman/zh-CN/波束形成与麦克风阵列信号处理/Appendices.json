{
    "hands_on_practices": [
        {
            "introduction": "在设计任何复杂的信号处理算法之前，麦克风阵列的物理布局是至关重要的第一步。本练习将引导你从第一性原理出发，推导在何种条件下会产生不期望的空间混叠伪影，即栅瓣 (grating lobes) 。掌握这一基本关系，对于避免由阵列几何结构 $d$、信号频率 $f$ 和转向角 $\\theta_0$ 共同决定的空间混叠至关重要，这是任何有效的阵列系统设计的先决条件。",
            "id": "4117593",
            "problem": "一个由 $N \\geq 2$ 个全向麦克风组成的均匀线性阵列 (ULA) 沿 x 轴放置，阵元间距固定为 $d > 0$。假设在声速为 $c > 0$ 的均匀介质中存在远场平面波传播。波束形成器使用相移控制技术将波束指向一个相对于垂射方向的角度 $\\theta_{0}$，所有角度均以弧度为单位。令 $f$ 表示声学频率，$\\lambda = c / f$ 表示波长。\n\n仅使用平面波传播的基本原理和跨阵列阵元的相位对齐定义，推导受控 ULA 的角度相关混叠条件，并确定第一个栅瓣进入可见区域的最小正频率。可见区域由满足 $\\lvert \\sin \\theta \\rvert \\leq 1$ 的物理上可实现的到达角定义。您的推导必须明确地体现出增加 $f$（等效于减小 $\\lambda$）如何以一种依赖于 $\\theta_{0}$ 的方式将栅瓣带入可见区域。\n\n提供一个关于 $d$、$c$ 和 $\\theta_{0}$ 的单一闭式解析表达式，表示过渡频率 $f_{\\mathrm{gl}}(\\theta_{0})$，该频率对应于任何栅瓣可见的最小正频率 $f > 0$。不要计算任何数值。最终答案必须是最终方框内不含单位的单一解析表达式。角度以弧度为单位。",
            "solution": "该问题要求推导均匀线性阵列（ULA）的角度相关混叠条件，并随后确定栅瓣变得可见的最小正频率。\n\n我们首先根据基本原理建立信号模型。考虑一个沿 x 轴放置、有 $N$ 个麦克风的 ULA。第 $n$ 个麦克风（索引从 $n=0$ 到 $N-1$）的位置由向量 $\\vec{p}_n = (nd, 0, 0)$ 给出，其中 $d$ 是阵元间距。一个频率为 $f$、速度为 $c$ 的平面声波从远场传播而来，其到达角 $\\theta$ 是相对于阵列的垂射方向（y 轴）测量的。\n\n相对于位于 $n=0$（原点）的参考麦克风，到达麦克风 $n$ 的波的波程差为 $\\Delta L_n = nd \\sin\\theta$。这对应于一个到达时间延迟：\n$$\n\\tau_n(\\theta) = \\frac{\\Delta L_n}{c} = \\frac{nd \\sin\\theta}{c}\n$$\n在频域中，这个时间延迟表现为相位偏移。对于一个角频率为 $\\omega = 2\\pi f$ 的单色波，麦克风 $n$ 处的信号与参考麦克风 $S_0(\\omega)$ 处的信号关系如下：\n$$\nS_n(\\omega, \\theta) = S_0(\\omega) \\exp(-j\\omega\\tau_n(\\theta)) = S_0(\\omega) \\exp\\left(-j 2\\pi f \\frac{nd \\sin\\theta}{c}\\right)\n$$\n使用关系式 $\\lambda = c/f$（其中 $\\lambda$ 是波长），相位项可以写成：\n$$\nS_n(\\omega, \\theta) = S_0(\\omega) \\exp\\left(-j 2\\pi n \\frac{d}{\\lambda} \\sin\\theta\\right)\n$$\n波束形成器通过对每个麦克风信号施加一组复权重 $w_n$，将阵列指向视向 $\\theta_0$。对于相移控制，这些权重被设计为精确抵消来自 $\\theta_0$ 方向的波的相位延迟，从而使来自该方向的信号相干叠加。第 $n$ 个麦克风的权重是：\n$$\nw_n(\\theta_0) = \\exp(+j\\omega\\tau_n(\\theta_0)) = \\exp\\left(+j 2\\pi n \\frac{d}{\\lambda} \\sin\\theta_0\\right)\n$$\n波束形成器的输出 $Y(\\omega, \\theta, \\theta_0)$ 是对于来自方向 $\\theta$ 的入射波，所有麦克风信号的加权和：\n$$\nY(\\omega, \\theta, \\theta_0) = \\sum_{n=0}^{N-1} w_n(\\theta_0) S_n(\\omega, \\theta) = S_0(\\omega) \\sum_{n=0}^{N-1} \\exp\\left(j 2\\pi n \\frac{d}{\\lambda} \\sin\\theta_0\\right) \\exp\\left(-j 2\\pi n \\frac{d}{\\lambda} \\sin\\theta\\right)\n$$\n合并指数项，我们得到：\n$$\nY(\\omega, \\theta, \\theta_0) = S_0(\\omega) \\sum_{n=0}^{N-1} \\exp\\left(j 2\\pi n \\frac{d}{\\lambda} (\\sin\\theta_0 - \\sin\\theta)\\right)\n$$\n这个求和项被称为阵列因子 $AF(\\theta, \\theta_0)$。当求和中的所有项都同相（即等于 $1$）时，波束形成器响应的幅度达到最大。这发生在指数的宗量是 $2\\pi$ 的整数倍时。设 $\\theta_g$ 是对应于最大响应的角度。最大相长干涉的条件是：\n$$\n2\\pi \\frac{d}{\\lambda} (\\sin\\theta_0 - \\sin\\theta_g) = 2\\pi m, \\quad \\text{for } m \\in \\mathbb{Z}\n$$\n其中 $m$ 是一个整数。简化此方程可得出响应最大值（波瓣）在 $\\sin\\theta$ 上的位置：\n$$\n\\sin\\theta_g = \\sin\\theta_0 - m \\frac{\\lambda}{d}\n$$\n$m=0$ 的情况导致 $\\sin\\theta_g = \\sin\\theta_0$，这对应于正确指向所需视向 $\\theta_0$ 的主瓣。\n$m \\neq 0$ 的情况对应于栅瓣，它们是波束图中不希望出现的极大值。\n\n如果栅瓣对应的角度 $\\theta_g$ 是实数，那么它就具有物理意义，或称“可见”。这等效于条件 $|\\sin\\theta_g| \\le 1$。因此，如果存在一个非零整数 $m$ 使得下式成立，则存在可见栅瓣：\n$$\n-1 \\le \\sin\\theta_0 - m \\frac{\\lambda}{d} \\le 1\n$$\n这个不等式就是角度相关的混叠条件。\n\n为避免任何可见栅瓣，我们必须确保对于所有非零整数 $m$，条件 $|\\sin\\theta_g| > 1$ 都得到满足。\n$$\n\\left| \\sin\\theta_0 - m \\frac{\\lambda}{d} \\right| > 1, \\quad \\forall m \\in \\mathbb{Z} \\setminus \\{0\\}\n$$\n这等效于要求对于每个非零整数 $m$，要么 $\\sin\\theta_0 - m \\frac{\\lambda}{d} > 1$，要么 $\\sin\\theta_0 - m \\frac{\\lambda}{d}  -1$。\n\n让我们分析这两种可能性：\n1. 对于正整数 $m = 1, 2, 3, \\ldots$：条件 $\\sin\\theta_0 - m \\frac{\\lambda}{d} > 1$ 是不可能的，因为 $\\sin\\theta_0 \\le 1$ 且 $m \\frac{\\lambda}{d} > 0$。所以我们必须满足 $\\sin\\theta_0 - m \\frac{\\lambda}{d}  -1$。重新整理得到 $m \\frac{\\lambda}{d} > 1 + \\sin\\theta_0$，或 $\\frac{\\lambda}{d} > \\frac{1 + \\sin\\theta_0}{m}$。为了对所有 $m \\ge 1$ 满足此条件，我们必须满足最严格的情况，即 $m=1$。因此，我们需要 $\\frac{\\lambda}{d} > 1 + \\sin\\theta_0$。\n\n2. 对于负整数 $m = -1, -2, -3, \\ldots$：令 $m = -k$，其中 $k = 1, 2, 3, \\ldots$。条件变为 $|\\sin\\theta_0 + k \\frac{\\lambda}{d}| > 1$。$\\sin\\theta_0 + k \\frac{\\lambda}{d}  -1$ 的可能性是不存在的，因为 $\\sin\\theta_0 \\ge -1$ 且 $k\\frac{\\lambda}{d} > 0$。所以我们必须满足 $\\sin\\theta_0 + k \\frac{\\lambda}{d} > 1$。重新整理得到 $k \\frac{\\lambda}{d} > 1 - \\sin\\theta_0$，或 $\\frac{\\lambda}{d} > \\frac{1 - \\sin\\theta_0}{k}$。为了对所有 $k \\ge 1$ 满足此条件，我们必须满足最严格的情况，即 $k=1$。因此，我们需要 $\\frac{\\lambda}{d} > 1 - \\sin\\theta_0$。\n\n为了没有任何可见栅瓣，两个条件必须同时成立：\n$$\n\\frac{\\lambda}{d} > 1 + \\sin\\theta_0 \\quad \\text{and} \\quad \\frac{\\lambda}{d} > 1 - \\sin\\theta_0\n$$\n这等效于要求 $\\frac{\\lambda}{d}$ 大于两个右侧值的最大值：\n$$\n\\frac{\\lambda}{d} > \\max(1 + \\sin\\theta_0, 1 - \\sin\\theta_0)\n$$\n这两项的最大值可以用一个更紧凑的形式表示。由于 $\\sin\\theta_0$ 是一个介于 $-1$ 和 $1$ 之间的实数，我们有：\n$$\n\\max(1 + \\sin\\theta_0, 1 - \\sin\\theta_0) = 1 + |\\sin\\theta_0|\n$$\n因此，无栅瓣的可见区域的条件是：\n$$\n\\frac{\\lambda}{d} > 1 + |\\sin\\theta_0|\n$$\n问题要求的是第一个栅瓣进入可见区域的最小正频率 $f_{\\mathrm{gl}}(\\theta_0)$。这个频率对应于上述条件的边界。当频率 $f$ 从零开始增加时，波长 $\\lambda = c/f$ 从无穷大开始减小。当 $\\lambda/d$ 首次不满足该不等式时，第一个栅瓣出现在可见区域的边缘，这发生在等式成立的点。设这个过渡波长为 $\\lambda_{\\mathrm{gl}}$。\n$$\n\\frac{\\lambda_{\\mathrm{gl}}}{d} = 1 + |\\sin\\theta_0|\n$$\n代入 $\\lambda_{\\mathrm{gl}} = c / f_{\\mathrm{gl}}(\\theta_0)$，我们有：\n$$\n\\frac{c}{f_{\\mathrm{gl}}(\\theta_0) d} = 1 + |\\sin\\theta_0|\n$$\n解出过渡频率 $f_{\\mathrm{gl}}(\\theta_0)$，得到所求的表达式：\n$$\nf_{\\mathrm{gl}}(\\theta_0) = \\frac{c}{d(1 + |\\sin\\theta_0|)}\n$$\n这个表达式给出了栅瓣将在可见区域边界（$\\sin\\theta_g = \\pm 1$）出现的最低频率，该频率取决于控制角 $\\theta_0$。对于任何频率 $f > f_{\\mathrm{gl}}(\\theta_0)$，可见区域中将至少存在一个栅瓣。",
            "answer": "$$\n\\boxed{\\frac{c}{d(1 + |\\sin\\theta_0|)}}\n$$"
        },
        {
            "introduction": "像最小方差无失真响应 (MVDR) 这样的自适应算法虽然能够提供卓越的干扰抑制能力（即高分辨率），但在实际应用中却常常对模型失配和噪声很敏感。本练习通过引入对角加载 (diagonal loading) 这一关键技术，让你亲身体验在自适应波束形成中一个永恒的主题：在锐利的高分辨率波束与稳定、稳健的性能之间进行权衡 。通过调节加载因子 $\\lambda$，你将量化并掌握这种权衡的艺术。",
            "id": "4117576",
            "problem": "考虑一个窄带平面波入射到一个双传感器线性麦克风阵列上。设期望方向的导向矢量为 $a \\in \\mathbb{C}^{2}$，并假设一个无失真响应波束形成器，即 $w^{H} a = 1$。该阵列采用最小方差无失真响应（MVDR）波束形成和对角加载技术进行操作，该技术通过 $R_{\\lambda} = R + \\lambda I$ 来替换样本协方差 $R \\in \\mathbb{C}^{2 \\times 2}$，其中 $\\lambda \\ge 0$ 是对角加载参数，$I$ 是单位矩阵。白噪声增益（WNG）定义为在单位功率谱密度的空间白噪声条件下，平方无失真响应与输出功率之比。在无失真约束 $w^{H} a = 1$ 下，这等于波束形成权重的欧几里得范数平方的倒数。\n\n从基本原理出发：窄带阵列数据模型，作为约束二次规划的 MVDR 准则的定义，以及空间白噪声下 WNG 的定义。通过推导 WNG 如何依赖于 $\\lambda$ 及其随 $\\lambda$ 变化的行为，展示对角加载如何在鲁棒性与分辨率之间进行权衡。\n\n然后，针对下述具体的、物理上一致的情况，推导满足白噪声增益约束的 $\\lambda$ 的闭式表达式，并计算其值。\n\n数据和要求：\n- 双传感器，期望方向的导向矢量为 $a = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n- 由于麦克风自身噪声功率不同，样本协方差是对角矩阵且各传感器值不等：$R = \\begin{pmatrix} r_{1}  0 \\\\ 0  r_{2} \\end{pmatrix}$，其中 $r_{1} = 5.0 \\times 10^{-6}$，$r_{2} = 1.0 \\times 10^{-6}$（单位：$\\mathrm{Pa}^{2}$）。\n- 白噪声增益目标（约束）：$\\mathrm{WNG} = \\Gamma = 1.6$。\n- 求出满足对角加载 MVDR 波束形成器 WNG 约束的物理有效对角加载参数 $\\lambda$。\n\n任务：\n1) 从对角加载 MVDR 波束形成器的约束最小化定义出发，推导波束形成器权重关于 $R$、$a$ 和 $\\lambda$ 的显式表达式，然后推导 WNG 作为 $\\lambda$ 的显式函数。\n2) 将您的 WNG 表达式具体化到上述指定的双传感器对角矩阵 $R$ 和 $a = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 的情况，将 WNG 约束方程 $\\mathrm{WNG}(\\lambda) = \\Gamma$ 简化为关于 $\\lambda$ 的单变量多项式，并求解使 $R_{\\lambda}$ 保持正定的物理有效的 $\\lambda$。\n3) 通过将权重在 $\\lambda \\to \\infty$ 时的极限行为与非自适应匹配滤波器形式联系起来，分析性地说明为什么增加 $\\lambda$ 会增加鲁棒性（以 WNG 衡量）但会降低分辨率（解释为自适应抑制非期望方向分量的能力）。\n\n将 $\\lambda$ 的最终数值四舍五入到四位有效数字。用 $\\mathrm{Pa}^{2}$ 表示 $\\lambda$ 的单位。",
            "solution": "问题陈述已通过验证，被认为是有效的。它在科学上基于阵列信号处理的原理，问题提法良好，数据充分且一致，表述客观。我们可以开始求解。\n\n根据问题陈述的要求，解答分为三个部分。\n\n任务 1：推导波束形成器权重和白噪声增益（WNG）。\n\n带对角加载的最小方差无失真响应（MVDR）波束形成器旨在找到权重向量 $w \\in \\mathbb{C}^{2}$，该向量解决以下约束优化问题：\n$$\n\\underset{w}{\\text{minimize}} \\quad w^{H} R_{\\lambda} w \\quad \\text{subject to} \\quad w^{H} a = 1\n$$\n其中 $R_{\\lambda} = R + \\lambda I$，$R$ 是样本协方差矩阵，$\\lambda \\ge 0$ 是对角加载参数，$I$ 是单位矩阵，$a$ 是期望方向的导向矢量。\n\n我们使用拉格朗日乘数法来解决此问题。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(w, \\mu) = w^{H} R_{\\lambda} w + \\mu (1 - w^{H} a) + \\mu^{*} (1 - a^{H} w)\n$$\n其中 $\\mu$ 是一个复数拉格朗日乘子。为求最小值，我们对 $\\mathcal{L}$ 关于 $w^{*}$ 求复梯度，并令其为零：\n$$\n\\nabla_{w^{*}} \\mathcal{L} = R_{\\lambda} w - \\mu a = 0\n$$\n这得到 $R_{\\lambda} w = \\mu a$。由于 $R$ 是一个协方差矩阵，它是半正定的。对于 $\\lambda > 0$，$R_{\\lambda}$ 是严格正定的，因此是可逆的。对于 $\\lambda=0$，我们假设 $R$ 是可逆的。因此，我们可以写出：\n$$\nw = \\mu R_{\\lambda}^{-1} a\n$$\n为了求出 $\\mu$ 的值，我们将 $w$ 的这个表达式代入无失真约束 $w^{H} a = 1$ 中：\n$$\n(\\mu R_{\\lambda}^{-1} a)^{H} a = 1 \\implies \\mu^{*} a^{H} (R_{\\lambda}^{-1})^{H} a = 1\n$$\n由于 $R_{\\lambda}$ 是一个埃尔米特矩阵（$R_{\\lambda}^{H} = R_{\\lambda}$），其逆矩阵也是埃尔米特矩阵（$(R_{\\lambda}^{-1})^{H} = R_{\\lambda}^{-1}$）。表达式 $a^{H} R_{\\lambda}^{-1} a$ 是一个正实标量。因此，$\\mu^{*}$ 必须是一个正实标量，这意味着 $\\mu$ 也是一个正实标量。\n$$\n\\mu (a^{H} R_{\\lambda}^{-1} a) = 1 \\implies \\mu = \\frac{1}{a^{H} R_{\\lambda}^{-1} a}\n$$\n将此结果代回 $w$ 的表达式，我们得到对角加载 MVDR 波束形成器的最优权重：\n$$\nw = \\frac{R_{\\lambda}^{-1} a}{a^{H} R_{\\lambda}^{-1} a}\n$$\n在无失真约束下，白噪声增益（WNG）定义为波束形成权重的欧几里得范数平方的倒数。\n$$\n\\mathrm{WNG} = \\frac{1}{\\|w\\|_{2}^{2}} = \\frac{1}{w^{H} w}\n$$\n我们计算 $w^{H}w$：\n$$\nw^{H} w = \\left( \\frac{R_{\\lambda}^{-1} a}{a^{H} R_{\\lambda}^{-1} a} \\right)^{H} \\left( \\frac{R_{\\lambda}^{-1} a}{a^{H} R_{\\lambda}^{-1} a} \\right) = \\frac{a^{H} (R_{\\lambda}^{-1})^{H} R_{\\lambda}^{-1} a}{(a^{H} R_{\\lambda}^{-1} a)^{H} (a^{H} R_{\\lambda}^{-1} a)}\n$$\n同样，由于 $a^{H} R_{\\lambda}^{-1} a$ 是一个实标量且 $R_{\\lambda}^{-1}$ 是埃尔米特矩阵，这可以简化为：\n$$\nw^{H} w = \\frac{a^{H} R_{\\lambda}^{-2} a}{(a^{H} R_{\\lambda}^{-1} a)^{2}}\n$$\n因此，WNG 作为 $\\lambda$ 的显式函数是：\n$$\n\\mathrm{WNG}(\\lambda) = \\frac{(a^{H} R_{\\lambda}^{-1} a)^{2}}{a^{H} R_{\\lambda}^{-2} a}\n$$\n\n任务 2：根据给定数据求解 $\\lambda$。\n\n给定：\n$a = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，$R = \\begin{pmatrix} r_{1}  0 \\\\ 0  r_{2} \\end{pmatrix}$，其中 $r_{1} = 5.0 \\times 10^{-6}$，$r_{2} = 1.0 \\times 10^{-6}$，以及目标 $\\mathrm{WNG} = \\Gamma = 1.6$。\n\n首先，我们求出所需的矩阵：\n$$\nR_{\\lambda} = R + \\lambda I = \\begin{pmatrix} r_{1} + \\lambda  0 \\\\ 0  r_{2} + \\lambda \\end{pmatrix}\n$$\n$$\nR_{\\lambda}^{-1} = \\begin{pmatrix} \\frac{1}{r_{1} + \\lambda}  0 \\\\ 0  \\frac{1}{r_{2} + \\lambda} \\end{pmatrix}\n$$\n$$\nR_{\\lambda}^{-2} = (R_{\\lambda}^{-1})^{2} = \\begin{pmatrix} \\frac{1}{(r_{1} + \\lambda)^{2}}  0 \\\\ 0  \\frac{1}{(r_{2} + \\lambda)^{2}} \\end{pmatrix}\n$$\n接下来，我们计算 WNG 表达式中的二次型：\n$$\na^{H} R_{\\lambda}^{-1} a = \\begin{pmatrix} 1  1 \\end{pmatrix} R_{\\lambda}^{-1} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{r_{1} + \\lambda} + \\frac{1}{r_{2} + \\lambda}\n$$\n$$\na^{H} R_{\\lambda}^{-2} a = \\begin{pmatrix} 1  1 \\end{pmatrix} R_{\\lambda}^{-2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{(r_{1} + \\lambda)^{2}} + \\frac{1}{(r_{2} + \\lambda)^{2}}\n$$\n将这些代入 WNG 表达式并令其等于 $\\Gamma$：\n$$\n\\Gamma = \\frac{\\left( \\frac{1}{r_{1} + \\lambda} + \\frac{1}{r_{2} + \\lambda} \\right)^{2}}{\\frac{1}{(r_{1} + \\lambda)^{2}} + \\frac{1}{(r_{2} + \\lambda)^{2}}} = \\frac{\\left( \\frac{(r_{2} + \\lambda) + (r_{1} + \\lambda)}{(r_{1} + \\lambda)(r_{2} + \\lambda)} \\right)^{2}}{\\frac{(r_{2} + \\lambda)^{2} + (r_{1} + \\lambda)^{2}}{((r_{1} + \\lambda)(r_{2} + \\lambda))^{2}}} = \\frac{((r_{1} + r_{2}) + 2\\lambda)^{2}}{(r_{1} + \\lambda)^{2} + (r_{2} + \\lambda)^{2}}\n$$\n我们展开并重排此方程，以形成一个关于 $\\lambda$ 的单变量多项式：\n$$\n\\Gamma \\left( (r_{1} + \\lambda)^{2} + (r_{2} + \\lambda)^{2} \\right) = ((r_{1} + r_{2}) + 2\\lambda)^{2}\n$$\n$$\n\\Gamma \\left( r_{1}^{2} + 2r_{1}\\lambda + \\lambda^{2} + r_{2}^{2} + 2r_{2}\\lambda + \\lambda^{2} \\right) = (r_{1} + r_{2})^{2} + 4(r_{1} + r_{2})\\lambda + 4\\lambda^{2}\n$$\n$$\n\\Gamma \\left( 2\\lambda^{2} + 2(r_{1} + r_{2})\\lambda + (r_{1}^{2} + r_{2}^{2}) \\right) = 4\\lambda^{2} + 4(r_{1} + r_{2})\\lambda + (r_{1} + r_{2})^{2}\n$$\n按 $\\lambda$ 的幂次合并项：\n$$\n(2\\Gamma - 4)\\lambda^{2} + (2\\Gamma(r_{1} + r_{2}) - 4(r_{1} + r_{2}))\\lambda + (\\Gamma(r_{1}^{2} + r_{2}^{2}) - (r_{1} + r_{2})^{2}) = 0\n$$\n这是一个二次方程 $A\\lambda^{2} + B\\lambda + C = 0$，其系数为：\n$A = 2\\Gamma - 4$\n$B = 2(\\Gamma - 2)(r_{1} + r_{2})$\n$C = \\Gamma(r_{1}^{2} + r_{2}^{2}) - (r_{1} + r_{2})^{2}$\n\n现在，我们代入给定的数值：$\\Gamma = 1.6$，$r_{1} = 5.0 \\times 10^{-6}$，$r_{2} = 1.0 \\times 10^{-6}$。\n$r_{1} + r_{2} = 6.0 \\times 10^{-6}$\n$r_{1}^{2} + r_{2}^{2} = (5.0 \\times 10^{-6})^{2} + (1.0 \\times 10^{-6})^{2} = (25.0 + 1.0) \\times 10^{-12} = 26.0 \\times 10^{-12}$\n$(r_{1} + r_{2})^{2} = (6.0 \\times 10^{-6})^{2} = 36.0 \\times 10^{-12}$\n\n$A = 2(1.6) - 4 = 3.2 - 4 = -0.8$\n$B = 2(1.6 - 2)(6.0 \\times 10^{-6}) = 2(-0.4)(6.0 \\times 10^{-6}) = -4.8 \\times 10^{-6}$\n$C = 1.6(26.0 \\times 10^{-12}) - 36.0 \\times 10^{-12} = 41.6 \\times 10^{-12} - 36.0 \\times 10^{-12} = 5.6 \\times 10^{-12}$\n\n关于 $\\lambda$ 的二次方程是：\n$$\n-0.8\\lambda^{2} - 4.8 \\times 10^{-6}\\lambda + 5.6 \\times 10^{-12} = 0\n$$\n两边乘以 $-1$ 得：\n$$\n0.8\\lambda^{2} + 4.8 \\times 10^{-6}\\lambda - 5.6 \\times 10^{-12} = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$：\n$$\n\\lambda = \\frac{-(4.8 \\times 10^{-6}) \\pm \\sqrt{(4.8 \\times 10^{-6})^{2} - 4(0.8)(-5.6 \\times 10^{-12})}}{2(0.8)}\n$$\n$$\n\\lambda = \\frac{-4.8 \\times 10^{-6} \\pm \\sqrt{23.04 \\times 10^{-12} + 17.92 \\times 10^{-12}}}{1.6}\n$$\n$$\n\\lambda = \\frac{-4.8 \\times 10^{-6} \\pm \\sqrt{40.96 \\times 10^{-12}}}{1.6} = \\frac{-4.8 \\times 10^{-6} \\pm 6.4 \\times 10^{-6}}{1.6}\n$$\n这得到两个解：\n$$\n\\lambda_{1} = \\frac{-4.8 \\times 10^{-6} + 6.4 \\times 10^{-6}}{1.6} = \\frac{1.6 \\times 10^{-6}}{1.6} = 1.0 \\times 10^{-6}\n$$\n$$\n\\lambda_{2} = \\frac{-4.8 \\times 10^{-6} - 6.4 \\times 10^{-6}}{1.6} = \\frac{-11.2 \\times 10^{-6}}{1.6} = -7.0 \\times 10^{-6}\n$$\n对角加载参数 $\\lambda$ 必须是非负的，即 $\\lambda \\ge 0$。此条件也保证了 $R_{\\lambda} = R + \\lambda I$ 保持正定，因为 $R$ 是正定的（$r_1, r_2 > 0$）。因此，唯一物理上有效的解是 $\\lambda = \\lambda_{1} = 1.0 \\times 10^{-6}$。$\\lambda$ 的单位与 $R$ 的元素单位相同，即 $\\mathrm{Pa}^{2}$。\n\n任务 3：鲁棒性与分辨率权衡分析。\n\n增加 $\\lambda$ 会提高鲁棒性（以 WNG 衡量）。我们考察当 $\\lambda \\to \\infty$ 时 $\\mathrm{WNG}(\\lambda)$ 的极限：\n$$\n\\lim_{\\lambda \\to \\infty} \\mathrm{WNG}(\\lambda) = \\lim_{\\lambda \\to \\infty} \\frac{((r_{1} + r_{2}) + 2\\lambda)^{2}}{(r_{1} + \\lambda)^{2} + (r_{2} + \\lambda)^{2}} = \\lim_{\\lambda \\to \\infty} \\frac{4\\lambda^{2} + O(\\lambda)}{\\lambda^{2} + \\lambda^{2} + O(\\lambda)} = \\frac{4\\lambda^{2}}{2\\lambda^{2}} = 2\n$$\n一个双传感器阵列可能的最大 WNG 是 $2$。随着 $\\lambda$ 的增加，$\\mathrm{WNG}(\\lambda)$ 单调地趋近于这个最大值，表明对空间白噪声的鲁棒性增强。\n\n增加 $\\lambda$ 会降低分辨率，分辨率被解释为自适应抑制干扰的能力。为了证明这一点，我们分析当 $\\lambda \\to \\infty$ 时权重 $w$ 的行为：\n$$\nw = \\frac{R_{\\lambda}^{-1} a}{a^{H} R_{\\lambda}^{-1} a} = \\frac{(R + \\lambda I)^{-1} a}{a^{H} (R + \\lambda I)^{-1} a}\n$$\n对于大的 $\\lambda$，我们可以近似其逆矩阵。提出因子 $\\lambda$：\n$$\n(R + \\lambda I)^{-1} = (\\lambda(\\frac{1}{\\lambda}R + I))^{-1} = \\frac{1}{\\lambda}(I + \\frac{1}{\\lambda}R)^{-1}\n$$\n对于小的 $X$，使用一阶泰勒展开 $(I + X)^{-1} \\approx I - X$：\n$$\n(R + \\lambda I)^{-1} \\approx \\frac{1}{\\lambda}(I - \\frac{1}{\\lambda}R) = \\frac{1}{\\lambda}I - \\frac{1}{\\lambda^{2}}R\n$$\n将此代入 $w$ 的表达式中：\n$$\nw \\approx \\frac{(\\frac{1}{\\lambda}I - \\frac{1}{\\lambda^{2}}R)a}{a^{H}(\\frac{1}{\\lambda}I - \\frac{1}{\\lambda^{2}}R)a} = \\frac{\\frac{1}{\\lambda}a - \\frac{1}{\\lambda^{2}}Ra}{\\frac{1}{\\lambda}a^{H}a - \\frac{1}{\\lambda^{2}}a^{H}Ra} = \\frac{a - \\frac{1}{\\lambda}Ra}{a^{H}a - \\frac{1}{\\lambda}a^{H}Ra}\n$$\n取 $\\lambda \\to \\infty$ 的极限：\n$$\n\\lim_{\\lambda \\to \\infty} w = \\frac{a}{a^{H}a}\n$$\n这个极限权重向量对应于一个常规的、非自适应的波束形成器（或匹配滤波器）。它的波束方向图是固定的，仅由期望方向 $a$ 决定，与协方差矩阵 $R$ 无关。因为波束形成器不再适应由 $R$ 描述的噪声和干扰场，它失去了在干扰源方向上形成零点的能力。这种自适应性的丧失对应于分辨率的降低。\n因此，增加 $\\lambda$ 使波束形成器从自适应的 MVDR 类型过渡到非自适应的常规类型，从而用更高的分辨率（自适应置零）换取更高的鲁棒性（WNG）。\n\n按要求将 $\\lambda$ 的最终数值四舍五入到四位有效数字：$\\lambda = 1.0 \\times 10^{-6} \\, \\mathrm{Pa}^{2}$ 变为 $1.000 \\times 10^{-6} \\, \\mathrm{Pa}^{2}$。",
            "answer": "$$\n\\boxed{1.000 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "真实的声学环境很少是静止不变的，这要求波束形成器必须能够实时自适应。这项综合性仿真练习将挑战你构建一个能够跟踪移动声源的自适应系统 。在这个过程中，你必须精心选择遗忘因子 $\\lambda$，以在系统对环境变化的快速响应能力与在噪声背景下的估计稳定性之间找到最佳平衡点。",
            "id": "4117613",
            "problem": "一个阵列处理系统观测一个窄带声场，其中包含一个时变的目标源和一个固定的干扰源。考虑一个由 $M$ 个麦克风组成的均匀线性阵列（ULA），沿 $x$ 轴等距排列，间距为 $d$，浸没在声速为 $c$ 的均匀介质中。一个声学频率为 $f_0$ 的时谐平面波传播到该阵列。在窄带假设下，离散时间索引 $t$ 处的复基带快照建模为\n$$\n\\mathbf{x}[t] = s[t]\\,\\mathbf{a}(\\theta_s[t]) + i[t]\\,\\mathbf{a}(\\theta_i) + \\mathbf{n}[t]\n$$\n其中，$s[t]$ 和 $i[t]$ 分别是方差为 $\\sigma_s^2$ 和 $\\sigma_i^2$ 的零均值圆对称复高斯源幅度，而 $\\mathbf{n}[t]\\sim\\mathcal{CN}(\\mathbf{0},\\sigma_n^2\\mathbf{I}_M)$ 是空间白噪声。导向矢量 $\\mathbf{a}(\\theta)$ 定义为\n$$\n\\mathbf{a}(\\theta) = \\left[ e^{\\mathrm{j} k x_0 \\sin(\\theta)}, e^{\\mathrm{j} k x_1 \\sin(\\theta)}, \\dots, e^{\\mathrm{j} k x_{M-1} \\sin(\\theta)} \\right]^{\\top},\n$$\n其中 $k = \\frac{2\\pi f_0}{c}$ 是声波数，$x_m = m d$ 是第 $m$ 个传感器（$m = 0,1,\\dots,M-1$）的位置。目标源的到达方向（DOA）随时间变化为 $\\theta_s[t]$，而干扰源的DOA $\\theta_i$ 是恒定的。在指定参数时，角度必须以度为单位解释，并在 $\\sin(\\cdot)$ 函数中使用时转换为弧度。\n\n时间 $t$ 处的最小方差无失真响应（MVDR）波束形成器求解以下问题\n$$\n\\min_{\\mathbf{w}\\in\\mathbb{C}^M} \\ \\mathbf{w}^{\\mathrm{H}} \\mathbf{R}[t] \\mathbf{w} \\quad \\text{subject to} \\quad \\mathbf{w}^{\\mathrm{H}}\\mathbf{a}(\\theta_s[t]) = 1,\n$$\n其中 $\\mathbf{R}[t]$ 是时间 $t$ 处的阵列协方差矩阵。对于所述随机模型，精确（理想）协方差为\n$$\n\\mathbf{R}_{\\mathrm{true}}[t] = \\sigma_s^2 \\mathbf{a}(\\theta_s[t])\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t]) + \\sigma_i^2 \\mathbf{a}(\\theta_i)\\mathbf{a}^{\\mathrm{H}}(\\theta_i) + \\sigma_n^2 \\mathbf{I}_M\n$$\nMVDR 解是唯一的矢量\n$$\n\\mathbf{w}_{\\mathrm{MVDR}}[t] = \\frac{\\mathbf{R}^{-1}[t]\\,\\mathbf{a}(\\theta_s[t])}{\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t])\\,\\mathbf{R}^{-1}[t]\\,\\mathbf{a}(\\theta_s[t])}.\n$$\n在实践中，使用指数加权递归协方差估计器：\n$$\n\\widehat{\\mathbf{R}}[t] = \\lambda\\,\\widehat{\\mathbf{R}}[t-1] + (1-\\lambda)\\,\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t],\n$$\n其中 $0  \\lambda  1$ 是遗忘因子，初始 $\\widehat{\\mathbf{R}}[0]$ 为半正定矩阵。自适应 MVDR 使用 $\\widehat{\\mathbf{R}}[t]$ 代替 $\\mathbf{R}[t]$。\n\n从计算声学和统计信号处理的第一性原理出发，推导遗忘因子 $\\lambda$ 应满足的条件，以确保自适应 MVDR 能够以有界误差跟踪由 $\\theta_s[t]$ 引起的 $\\mathbf{R}_{\\mathrm{true}}[t]$ 的时变特性。您的推导必须从平面波阵列模型和 MVDR 优化定义开始，然后说明指数加权递归如何充当作用于协方差轨迹的离散时间线性时不变低通滤波器。建立 $\\lambda$ 与 $\\theta_s[t]$ 变化频率之间的关系（考虑正弦 DOA 变化 $\\theta_s[t] = \\Theta \\sin(2\\pi f_v t)$，其中 $\\Theta$ 以度为单位， $f_v$ 以周/帧为单位），并推导关于 $\\lambda$ 的不等式，以保证在角频率 $\\omega_v = 2\\pi f_v$ 处，根据滤波器幅度响应达到指定的跟踪保真度水平。当输入快照受到加性白噪声污染时，还需推导关于 $\\lambda$ 的方差限制条件，以将估计器方差保持在预定界限以下。明确说明将协方差跟踪与 MVDR 权值跟踪联系起来所需的任何近似。\n\n您必须接着实现一个程序来模拟此场景，并通过比较自适应 MVDR 权值 $\\widehat{\\mathbf{w}}[t]$（使用 $\\widehat{\\mathbf{R}}[t]$ 获得）与理想 MVDR 权值 $\\mathbf{w}_{\\mathrm{MVDR}}[t]$（使用 $\\mathbf{R}_{\\mathrm{true}}[t]$ 获得）来凭经验评估跟踪行为。使用以下科学上合理的参数，并确保在问题陈述中角度以度为单位指定，并在计算中转换为弧度：\n- 麦克风数量：$M = 8$。\n- 传感器间距：$d = 0.035\\,\\mathrm{m}$。\n- 声速：$c = 343\\,\\mathrm{m/s}$。\n- 窄带频率：$f_0 = 3000\\,\\mathrm{Hz}$。\n- 目标源 DOA 变化：$\\theta_s[t] = \\Theta \\sin(2\\pi f_v t)$，振幅 $\\Theta = 30\\,\\mathrm{deg}$。\n- 干扰源 DOA：$\\theta_i = -20\\,\\mathrm{deg}$。\n- 源、干扰和噪声方差：$\\sigma_s^2 = 1.0$，$\\sigma_i^2 = 5.0$，$\\sigma_n^2 = 0.1$（无量纲复基带功率单位）。\n- 帧数：$T = 4000$。\n- 添加到每个协方差逆矩阵的对角加载：一个小常数 $\\gamma = 10^{-3}$，以确保数值稳定性（无量纲）。\n\n将时间 $t$ 的跟踪误差定义为\n$$\ne[t] = \\left\\|\\widehat{\\mathbf{w}}[t] - \\mathbf{w}_{\\mathrm{MVDR}}[t]\\right\\|_2\n$$\n并将总体跟踪误差度量定义为均方根误差\n$$\nE = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T} e[t]^2}.\n$$\n\n您的程序必须运行四个测试用例，通过改变遗忘因子 $\\lambda$ 和 DOA 变化频率 $f_v$（以周/帧为单位）来探究不同的跟踪状态。对于每个用例，计算 $E$ 并将其与指定的阈值 $\\tau$ 进行比较，以生成一个布尔结果来指示跟踪是否成功。使用以下测试套件：\n- 用例 1：$\\lambda = 0.98$，$f_v = \\frac{1}{500}$，阈值 $\\tau = 0.20$。\n- 用例 2：$\\lambda = 0.98$，$f_v = \\frac{1}{50}$，阈值 $\\tau = 0.20$。\n- 用例 3：$\\lambda = 0.90$，$f_v = \\frac{1}{20}$，阈值 $\\tau = 0.25$。\n- 用例 4：$\\lambda = 0.60$，$f_v = \\frac{1}{20}$，阈值 $\\tau = 0.25$。\n\n对于每个测试用例，输出一个布尔值，指示是否满足 $E \\le \\tau$。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果按上述测试用例的顺序排列。\n\n在仿真中，所有角度参数必须以度为单位指定，然后在三角函数中使用时内部转换为弧度。$d$、$c$ 和 $f_0$ 的物理单位必须与指定完全一致：$d$ 的单位是米，$c$ 的单位是米/秒，$f_0$ 的单位是赫兹。输出的布尔值列表没有物理单位。",
            "solution": "我们从声学平面波模型和阵列响应开始。在声速为 $c$ 的均匀介质中传播的角频率为 $\\omega_0 = 2\\pi f_0$ 的时谐平面波，其波数为 $k = \\frac{\\omega_0}{c} = \\frac{2\\pi f_0}{c}$。对于一个沿 $x$ 轴分布、传感器位置为 $x_m = m d$ 的均匀线性阵列（ULA），从方向 $\\theta$（从阵列法线方向测量，以度为单位，在三角函数中使用时转换为弧度）入射的平面波的窄带复基带导向矢量 $\\mathbf{a}(\\theta)$ 为\n$$\n\\mathbf{a}(\\theta) = \\left[e^{\\mathrm{j} k x_0 \\sin(\\theta)}, e^{\\mathrm{j} k x_1 \\sin(\\theta)}, \\dots, e^{\\mathrm{j} k x_{M-1} \\sin(\\theta)}\\right]^{\\top},\n$$\n这源于相位累积 $k\\mathbf{r}\\cdot\\hat{\\mathbf{s}}$，其中 $\\hat{\\mathbf{s}}$ 是单位传播方向矢量。\n\n在窄带叠加模型下，离散时间 $t$ 观测到的快照为\n$$\n\\mathbf{x}[t] = s[t]\\mathbf{a}(\\theta_s[t]) + i[t]\\mathbf{a}(\\theta_i) + \\mathbf{n}[t],\n$$\n其中 $s[t]\\sim\\mathcal{CN}(0,\\sigma_s^2)$，$i[t]\\sim\\mathcal{CN}(0,\\sigma_i^2)$ 和 $\\mathbf{n}[t]\\sim\\mathcal{CN}(\\mathbf{0},\\sigma_n^2\\mathbf{I}_M)$ 相互独立。那么，精确的协方差矩阵是各个协方差之和：\n$$\n\\mathbf{R}_{\\mathrm{true}}[t] = \\mathbb{E}\\left[\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]\\right] = \\sigma_s^2 \\mathbf{a}(\\theta_s[t])\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t]) + \\sigma_i^2 \\mathbf{a}(\\theta_i)\\mathbf{a}^{\\mathrm{H}}(\\theta_i) + \\sigma_n^2 \\mathbf{I}_M.\n$$\n\n最小方差无失真响应（MVDR）波束形成器定义为\n$$\n\\mathbf{w}_{\\mathrm{MVDR}}[t] = \\arg\\min_{\\mathbf{w}} \\ \\mathbf{w}^{\\mathrm{H}}\\mathbf{R}[t]\\mathbf{w} \\quad \\text{subject to} \\quad \\mathbf{w}^{\\mathrm{H}}\\mathbf{a}(\\theta_s[t]) = 1.\n$$\n使用拉格朗日乘子法，其解是众所周知的：\n$$\n\\mathbf{w}_{\\mathrm{MVDR}}[t] = \\frac{\\mathbf{R}^{-1}[t]\\mathbf{a}(\\theta_s[t])}{\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t])\\mathbf{R}^{-1}[t]\\mathbf{a}(\\theta_s[t])}.\n$$\n我们使用对角加载来确保数值稳定性：将 $\\mathbf{R}[t]$ 替换为 $\\mathbf{R}[t]+\\gamma\\mathbf{I}_M$，其中 $\\gamma > 0$ 是一个小数。\n\n在自适应操作中，协方差通过指数加权移动平均（EWMA）进行递归估计：\n$$\n\\widehat{\\mathbf{R}}[t] = \\lambda \\widehat{\\mathbf{R}}[t-1] + (1-\\lambda)\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t], \\quad 0  \\lambda  1,\n$$\n并使用一个半正定的 $\\widehat{\\mathbf{R}}[0]$ 进行初始化。该递归在 $\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]$ 上是线性的，并定义了一个作用于协方差样本 $\\mathbf{S}[t] \\triangleq \\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]$ 轨迹的离散时间线性时不变（LTI）滤波器。对任意标量项 $\\widehat{R}_{mn}[t] = \\lambda \\widehat{R}_{mn}[t-1] + (1-\\lambda) S_{mn}[t]$ 按分量写出递归式，其 $z$ 变换得出\n$$\n\\widehat{R}_{mn}(z) = \\frac{(1-\\lambda)}{1 - \\lambda z^{-1}} S_{mn}(z),\n$$\n因此滤波器传递函数为\n$$\nH(z) = \\frac{(1-\\lambda)}{1 - \\lambda z^{-1}},\n$$\n其极点位于 $z=\\lambda$。在单位圆 $z=e^{\\mathrm{j}\\omega}$ 上求值，其幅度响应为\n$$\n|H(e^{\\mathrm{j}\\omega})| = \\frac{(1-\\lambda)}{\\sqrt{1 + \\lambda^2 - 2\\lambda\\cos\\omega}}.\n$$\n将 $\\mathbf{R}_{\\mathrm{true}}[t]$ 解释为由 DOA 变化驱动的缓慢时变信号，将 $\\mathbf{S}[t]$ 解释为该信号的含噪样本，则 EWMA 对每个协方差项起到一阶低通平滑器的作用。以样本数为单位的有效时间常数约为\n$$\nN_{\\mathrm{eff}} = \\frac{1}{1-\\lambda},\n$$\n因为其冲激响应为 $h[t] = (1-\\lambda)\\lambda^{t} u[t]$，其平均索引为 $\\frac{\\lambda}{1-\\lambda}$，其 $e^{-1}$ 衰减时间在 $\\frac{1}{1-\\lambda}$ 的量级。\n\n跟踪保真度要求：假设由于正弦 DOA $\\theta_s[t] = \\Theta\\sin(2\\pi f_v t)$，目标协方差以角频率 $\\omega_v = 2\\pi f_v$ 近似正弦变化。为确保 EWMA 对协方差变化幅度的衰减不超过指定比例 $\\alpha\\in(0,1]$，施加条件\n$$\n|H(e^{\\mathrm{j}\\omega_v})| \\ge \\alpha.\n$$\n代入幅度响应并将两边平方，我们得到\n$$\n\\frac{(1-\\lambda)^2}{1 + \\lambda^2 - 2\\lambda\\cos\\omega_v} \\ge \\alpha^2,\n$$\n整理后得到关于 $\\lambda$ 的不等式：\n$$\n(1-\\lambda)^2 \\ge \\alpha^2\\left(1 + \\lambda^2 - 2\\lambda\\cos\\omega_v\\right).\n$$\n展开并合并同类项得到\n$$\n1 - 2\\lambda + \\lambda^2 \\ge \\alpha^2 + \\alpha^2\\lambda^2 - 2\\alpha^2\\lambda\\cos\\omega_v.\n$$\n将所有项移到一边，得到一个关于 $\\lambda$ 的二次不等式：\n$$\n(1-\\alpha^2)\\lambda^2 + \\left(-2 + 2\\alpha^2\\cos\\omega_v\\right)\\lambda + (1 - \\alpha^2) \\ge 0.\n$$\n对于选定的 $\\alpha$ 和 $\\omega_v$，该不等式定义了一个 $\\lambda$ 值的区间，在此区间内，$\\omega_v$ 处的通带增益至少达到期望值。在 $\\alpha$ 接近 1 的常见情况下，会出现一个直观的条件 $N_{\\mathrm{eff}} \\ll \\frac{2\\pi}{\\omega_v}$，即滤波器的记忆长度应远小于变化周期：$\\frac{1}{1-\\lambda} \\ll \\frac{2\\pi}{\\omega_v}$，或等效地\n$$\n\\lambda \\ll 1 - \\frac{\\omega_v}{2\\pi}\\cdot c_\\alpha,\n$$\n其中常数 $c_\\alpha$ 由期望的保真度决定（精确界限可由二次不等式得出）。\n\n方差限制要求：EWMA 会降低由白噪声驱动的输入的方差。如果 $S_{mn}[t]$ 包含方差为 $\\sigma_{S}^2$ 的加性白噪声，则 $\\widehat{R}_{mn}[t]$ 处的输出方差为\n$$\n\\mathrm{Var}\\{\\widehat{R}_{mn}[t]\\} = \\sigma_{S}^2 \\sum_{k=0}^{\\infty} (1-\\lambda)^2 \\lambda^{2k} = \\sigma_{S}^2 \\frac{(1-\\lambda)^2}{1 - \\lambda^2}.\n$$\n为将估计器方差限制在 $\\beta^2$ 以内，施加条件\n$$\n\\sigma_{S}^2 \\frac{(1-\\lambda)^2}{1 - \\lambda^2} \\le \\beta^2.\n$$\n求解 $\\lambda$ 得\n$$\n\\frac{(1-\\lambda)^2}{1 - \\lambda^2} \\le \\frac{\\beta^2}{\\sigma_{S}^2} \\quad \\Rightarrow \\quad \\frac{1-\\lambda}{1+\\lambda} \\le \\frac{\\beta}{\\sigma_{S}},\n$$\n这得出\n$$\n\\lambda \\ge \\frac{1 - \\frac{\\beta}{\\sigma_{S}}}{1 + \\frac{\\beta}{\\sigma_{S}}}.\n$$\n因此，$\\lambda$ 必须足够接近 1 以抑制方差，但又不能太接近以至于违反在 $\\omega_v$ 处的跟踪保真度要求。结合保真度和方差界限，可以得到 $\\lambda$ 的一个容许区间。\n\n将协方差跟踪与 MVDR 权值跟踪联系起来：MVDR 权值通过以下方式平滑地依赖于 $\\mathbf{R}^{-1}[t]$\n$$\n\\mathbf{w}[t] = \\frac{\\mathbf{R}^{-1}[t]\\mathbf{a}(\\theta_s[t])}{\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t])\\mathbf{R}^{-1}[t]\\mathbf{a}(\\theta_s[t])}.\n$$\n如果 $\\widehat{\\mathbf{R}}[t]$ 在算子范数下以有界误差跟踪 $\\mathbf{R}_{\\mathrm{true}}[t]$，并保持正定（例如，通过对角加载 $\\gamma\\mathbf{I}_M$），那么根据在正定矩阵锥上矩阵求逆的连续性以及导向矢量映射 $\\theta\\mapsto\\mathbf{a}(\\theta)$ 的平滑性，$\\mathbf{w}[t]$ 中引入的误差是有界的。因此，EWMA 保真度约束 $|H(e^{\\mathrm{j}\\omega_v})|\\ge\\alpha$ 和噪声方差界限可以转化为有界的 MVDR 权值跟踪误差 $E$。\n\n仿真算法实现：\n- 固定 $M$、$d$、$c$ 和 $f_0$，计算 $k = \\frac{2\\pi f_0}{c}$。\n- 使用 $\\sin(\\theta)$ 定义 $\\mathbf{a}(\\theta)$，其中 $\\theta$ 以弧度为单位。\n- 对于每个测试用例，设置 $\\lambda$、$f_v$ 和阈值 $\\tau$；定义 $\\theta_s[t] = \\Theta\\sin(2\\pi f_v t)$，其中 $\\Theta$ 以度为单位，将 $\\theta_s[t]$ 和 $\\theta_i$ 转换为弧度用于计算导向矢量。\n- 初始化 $\\widehat{\\mathbf{R}}[0] = \\sigma_n^2 \\mathbf{I}_M$。\n- 对于 $t=1,\\dots,T$：\n  - 抽取 $s[t]\\sim\\mathcal{CN}(0,\\sigma_s^2)$、$i[t]\\sim\\mathcal{CN}(0,\\sigma_i^2)$ 和 $\\mathbf{n}[t]\\sim\\mathcal{CN}(\\mathbf{0},\\sigma_n^2\\mathbf{I}_M)$。\n  - 构建 $\\mathbf{x}[t] = s[t]\\mathbf{a}(\\theta_s[t]) + i[t]\\mathbf{a}(\\theta_i) + \\mathbf{n}[t]$。\n  - 更新 $\\widehat{\\mathbf{R}}[t] = \\lambda\\widehat{\\mathbf{R}}[t-1] + (1-\\lambda)\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]$。\n  - 使用 $\\sigma_s^2$、$\\sigma_i^2$、$\\sigma_n^2$、$\\mathbf{a}(\\theta_s[t])$ 和 $\\mathbf{a}(\\theta_i)$ 计算 $\\mathbf{R}_{\\mathrm{true}}[t]$。\n  - 使用对角加载 $\\gamma\\mathbf{I}_M$，通过求解线性方程组而不是显式求逆来计算 $\\widehat{\\mathbf{w}}[t]$ 和 $\\mathbf{w}_{\\mathrm{MVDR}}[t]$：令 $\\mathbf{v}_{\\mathrm{hat}}[t]$ 为 $(\\widehat{\\mathbf{R}}[t]+\\gamma\\mathbf{I}_M)\\mathbf{v}=\\mathbf{a}(\\theta_s[t])$ 的解，并设置 $\\widehat{\\mathbf{w}}[t] = \\mathbf{v}_{\\mathrm{hat}}[t]/\\left(\\mathbf{a}^{\\mathrm{H}}(\\theta_s[t])\\mathbf{v}_{\\mathrm{hat}}[t]\\right)$；同样地，使用 $\\mathbf{R}_{\\mathrm{true}}[t]$ 计算理想情况下的值。\n  - 计算 $e[t] = \\left\\|\\widehat{\\mathbf{w}}[t] - \\mathbf{w}_{\\mathrm{MVDR}}[t]\\right\\|_2$。\n- 计算 $E = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T} e[t]^2}$ 并与 $\\tau$ 比较，为该测试用例生成布尔结果。\n\n科学真实性和边缘情况：\n- 由于每次更新都是 $\\widehat{\\mathbf{R}}[t-1]$ 和 $\\mathbf{x}[t]\\mathbf{x}^{\\mathrm{H}}[t]$ 的正凸组合，因此在 $0  \\lambda  1$ 和初始 $\\widehat{\\mathbf{R}}[0]\\succeq \\mathbf{0}$ 条件下的递归保持了半正定性。\n- 对角加载确保了可逆性。\n- 正弦 DOA 变化引入了单一变化频率 $\\omega_v$，使得通过 $|H(e^{\\mathrm{j}\\omega_v})|$ 进行保真度分析是恰当的。\n- 方差界限将 $\\lambda$ 与对快照噪声的鲁棒性联系起来。\n\n测试套件覆盖范围：\n- 用例 1（慢变化，大 $\\lambda$）：$f_v=\\frac{1}{500}$，$\\lambda=0.98$，预期跟踪效果好（$E\\le\\tau$）。\n- 用例 2（较快变化，相同 $\\lambda$）：$f_v=\\frac{1}{50}$，$\\lambda=0.98$，预期跟踪效果下降（$E\\tau$）。\n- 用例 3（中等变化，较小 $\\lambda$）：$f_v=\\frac{1}{20}$，$\\lambda=0.90$，预期权衡可接受（$E\\le\\tau$）。\n- 用例 4（中等变化，小 $\\lambda$）：$f_v=\\frac{1}{20}$，$\\lambda=0.60$，预期估计噪声较大（$E\\tau$）。\n\n程序实现了这些用例，并按顺序将四个布尔值打印在单行中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef steering_vector(theta_deg, k, d, M):\n    \"\"\"\n    Construct ULA steering vector for angle theta_deg (degrees).\n    Uses radians internally for sin.\n    \"\"\"\n    theta_rad = np.deg2rad(theta_deg)\n    # Sensor positions x_m = m*d, m=0..M-1\n    m_idx = np.arange(M)\n    x = m_idx * d\n    return np.exp(1j * k * x * np.sin(theta_rad))\n\ndef mvdr_weights(R, a, gamma=1e-3):\n    \"\"\"\n    MVDR weights with diagonal loading gamma. Avoid explicit inverse by solving.\n    w = R^{-1} a / (a^H R^{-1} a)\n    \"\"\"\n    M = R.shape[0]\n    R_loaded = R + gamma * np.eye(M, dtype=R.dtype)\n    # Solve R_loaded v = a\n    v = np.linalg.solve(R_loaded, a)\n    denom = np.vdot(a, v)  # a^H v\n    # Protect against numerical issues\n    if np.abs(denom)  1e-12:\n        return np.zeros_like(a)\n    return v / denom\n\ndef simulate_case(M, d, c, f0, Theta_deg, theta_i_deg,\n                  sigma_s2, sigma_i2, sigma_n2,\n                  T, lam, f_v, gamma, rng):\n    \"\"\"\n    Simulate adaptive MVDR tracking for a single test case.\n    Returns RMS weight error E.\n    \"\"\"\n    # Wavenumber\n    k = 2.0 * np.pi * f0 / c\n    # Fixed interferer steering\n    a_i = steering_vector(theta_i_deg, k, d, M)\n    # Initialize covariance estimate\n    R_hat = sigma_n2 * np.eye(M, dtype=np.complex128)\n    # Accumulate squared errors\n    err_sq_sum = 0.0\n\n    for t in range(1, T + 1):\n        # Desired DOA varies sinusoidally: theta_s[t] = Theta * sin(2*pi*f_v*t)\n        theta_s_deg = Theta_deg * np.sin(2.0 * np.pi * f_v * t)\n        a_s = steering_vector(theta_s_deg, k, d, M)\n\n        # Draw complex Gaussian amplitudes and noise\n        # Complex CN(0, sigma^2): real and imag ~ N(0, sigma^2/2)\n        s = (np.sqrt(sigma_s2 / 2.0) *\n             (rng.standard_normal() + 1j * rng.standard_normal()))\n        i = (np.sqrt(sigma_i2 / 2.0) *\n             (rng.standard_normal() + 1j * rng.standard_normal()))\n        n = (np.sqrt(sigma_n2 / 2.0) *\n             (rng.standard_normal(M) + 1j * rng.standard_normal(M)))\n\n        # Snapshot\n        x = s * a_s + i * a_i + n\n\n        # Recursive covariance update\n        R_hat = lam * R_hat + (1.0 - lam) * np.outer(x, np.conj(x))\n\n        # Oracle covariance\n        R_true = (sigma_s2 * np.outer(a_s, np.conj(a_s)) +\n                  sigma_i2 * np.outer(a_i, np.conj(a_i)) +\n                  sigma_n2 * np.eye(M, dtype=np.complex128))\n\n        # Weights\n        w_hat = mvdr_weights(R_hat, a_s, gamma=gamma)\n        w_oracle = mvdr_weights(R_true, a_s, gamma=gamma)\n\n        # Error\n        e = np.linalg.norm(w_hat - w_oracle)\n        err_sq_sum += (e * e)\n\n    E = np.sqrt(err_sq_sum / T)\n    return E\n\ndef solve():\n    # Fixed parameters from the problem statement\n    M = 8\n    d = 0.035  # meters\n    c = 343.0  # m/s\n    f0 = 3000.0  # Hz\n    Theta_deg = 30.0  # degrees\n    theta_i_deg = -20.0  # degrees\n    sigma_s2 = 1.0\n    sigma_i2 = 5.0\n    sigma_n2 = 0.1\n    T = 4000\n    gamma = 1e-3\n\n    # Test cases: (lambda, f_v, threshold tau)\n    test_cases = [\n        (0.98, 1.0/500.0, 0.20),  # Case 1\n        (0.98, 1.0/50.0, 0.20),   # Case 2\n        (0.90, 1.0/20.0, 0.25),   # Case 3\n        (0.60, 1.0/20.0, 0.25),   # Case 4\n    ]\n\n    # Seed for reproducibility\n    rng = np.random.default_rng(123456)\n\n    results = []\n    for lam, f_v, tau in test_cases:\n        E = simulate_case(M, d, c, f0, Theta_deg, theta_i_deg,\n                          sigma_s2, sigma_i2, sigma_n2,\n                          T, lam, f_v, gamma, rng)\n        results.append(E = tau)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}