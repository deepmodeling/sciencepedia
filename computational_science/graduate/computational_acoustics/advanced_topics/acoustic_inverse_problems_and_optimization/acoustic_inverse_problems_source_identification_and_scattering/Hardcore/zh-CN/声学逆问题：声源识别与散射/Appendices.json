{
    "hands_on_practices": [
        {
            "introduction": "许多声学逆问题依赖于将未知散射体与散射场之间的关系线性化。玻恩近似是其中最常用的一种线性化方法，它极大地简化了散射的正演模型。本练习将引导你通过推导，量化玻恩近似成立的条件，这是分析和求解散射逆问题前至关重要的一步。",
            "id": "4112999",
            "problem": "一个角频率为 $\\omega$ 的时谐声场在密度为 $\\rho_{0}$、声速为 $c_{0}$ 的均匀背景介质中传播，该介质中仅包含一个以原点为中心、半径为 $a$ 的球形夹杂物。假设密度处处均匀且等于 $\\rho_{0}$，唯一的衬度在于慢度平方。设背景波数为 $k = \\omega / c_{0}$，夹杂物的特征由一个恒定的衬度 \n$$\\chi = \\frac{c_{0}^{2}}{c^{2}} - 1,$$\n所决定，该衬度作用于球体 $D = \\{\\mathbf{r}' \\in \\mathbb{R}^{3} : |\\mathbf{r}'| \\le a\\}$ 上，其中 $c$ 是夹杂物内部的声速。总声压 $p(\\mathbf{r})$ 满足非齐次亥姆霍兹方程\n$$\\nabla^{2} p(\\mathbf{r}) + k^{2} p(\\mathbf{r}) = - k^{2} \\chi \\, \\mathbf{1}_{D}(\\mathbf{r}) \\, p(\\mathbf{r}),$$\n其中 $\\mathbf{1}_{D}$ 是 $D$ 的指示函数，入射场 $p^{\\mathrm{inc}}(\\mathbf{r})$ 是齐次背景方程的解。相应的Lippmann–Schwinger表示为\n$$p(\\mathbf{r}) = p^{\\mathrm{inc}}(\\mathbf{r}) + k^{2} \\int_{D} G_{k}(\\mathbf{r}-\\mathbf{r}') \\, \\chi \\, p(\\mathbf{r}') \\, \\mathrm{d}\\mathbf{r}',$$\n其中 $G_{k}(\\mathbf{r}) = \\exp(i k |\\mathbf{r}|) / (4 \\pi |\\mathbf{r}|)$ 是三维自由空间格林函数。\n\n一阶玻恩近似将体积分内的 $p(\\mathbf{r}')$ 替换为 $p^{\\mathrm{inc}}(\\mathbf{r}')$。该近似有效的一个标准充分条件是，体积分算子\n$$\\mathcal{K}[f](\\mathbf{r}) = k^{2} \\int_{D} G_{k}(\\mathbf{r}-\\mathbf{r}') \\, \\chi \\, f(\\mathbf{r}') \\, \\mathrm{d}\\mathbf{r}'$$\n的算子范数（在本性上确界范数下）严格小于1。定义无量纲玻恩有效性参数 $\\beta$ 为上界\n$$\\beta \\equiv \\sup_{\\mathbf{r} \\in \\mathbb{R}^{3}} \\, k^{2} \\int_{D} |\\chi| \\, |G_{k}(\\mathbf{r}-\\mathbf{r}')| \\, \\mathrm{d}\\mathbf{r}'.$$\n\n从上述基本方程出发，为所述球形夹杂物推导 $\\beta$ 的闭式表达式，并将其简化为仅含 $k$、$a$ 和 $\\chi$ 的函数。除了使用绝对值来限定格林函数核之外，你的推导过程不能包含任何不受控的近似。最后，提供 $\\beta(k,a,\\chi)$ 的最终解析表达式，并简要解释此定量判据如何体现玻恩近似有效性的弱衬度和小 $ka$ 两种情况。\n\n将最终答案表示为单个闭式解析表达式。不要四舍五入。最终答案中不要包含单位。",
            "solution": "该问题是有效的。这是一个声学散射理论中基于标准和科学可靠原理的适定问题。所有必要信息均已提供，且目标明确且可形式化。\n\n任务是为玻恩有效性参数 $\\beta$ 推导一个闭式表达式，其定义如下：\n$$ \\beta \\equiv \\sup_{\\mathbf{r} \\in \\mathbb{R}^{3}} \\, k^{2} \\int_{D} |\\chi| \\, |G_{k}(\\mathbf{r}-\\mathbf{r}')| \\, \\mathrm{d}\\mathbf{r}' $$\n其中 $D$ 是一个以原点为中心、半径为 $a$ 的球体，$\\chi$ 是一个恒定的衬度，$G_{k}$ 是亥姆霍兹方程的三维自由空间格林函数。\n\n首先，我们代入格林函数的表达式，$G_{k}(\\mathbf{r}) = \\frac{\\exp(i k |\\mathbf{r}|)}{4 \\pi |\\mathbf{r}|}$。其模为 $|G_{k}(\\mathbf{r})| = \\frac{|\\exp(i k |\\mathbf{r}|)|}{4 \\pi |\\mathbf{r}|} = \\frac{1}{4 \\pi |\\mathbf{r}|}$，因为 $k$ 和 $|\\mathbf{r}|$ 都是实数，所以 $|\\exp(i k |\\mathbf{r}|)| = 1$。\n\n由于衬度 $\\chi$ 在区域 $D$ 上是常数，我们可以将其模 $|\\chi|$ 提到积分外。$\\beta$ 的表达式变为：\n$$ \\beta = k^{2} |\\chi| \\sup_{\\mathbf{r} \\in \\mathbb{R}^{3}} \\int_{D} \\frac{1}{4 \\pi |\\mathbf{r}-\\mathbf{r}'|} \\, \\mathrm{d}\\mathbf{r}' $$\n让我们将积分项定义为 $V(\\mathbf{r})$：\n$$ V(\\mathbf{r}) = \\frac{1}{4\\pi} \\int_{D} \\frac{1}{|\\mathbf{r}-\\mathbf{r}'|} \\, \\mathrm{d}\\mathbf{r}' $$\n该积分在数学上等价于在球形体积 $D$ 上具有单位密度的均匀电荷分布在位置 $\\mathbf{r}$ 处产生的静电势。由于积分区域 $D$ 的球对称性，势 $V(\\mathbf{r})$ 将仅取决于径向距离 $r = |\\mathbf{r}|$。因此我们可以写作 $V(\\mathbf{r}) = V(r)$。为了找到 $V(\\mathbf{r})$ 的上确界，我们可以计算所有 $r \\ge 0$ 的 $V(r)$ 并找到其最大值。\n\n为了计算积分，我们将坐标系对齐，使点 $\\mathbf{r}$ 位于 $z$ 轴上，即 $\\mathbf{r} = (0, 0, r)$。我们对积分变量 $\\mathbf{r}' = (r', \\theta', \\phi')$ 使用球坐标。体积元是 $\\mathrm{d}\\mathbf{r}' = r'^2 \\sin\\theta' \\, \\mathrm{d}r' \\, \\mathrm{d}\\theta' \\, \\mathrm{d}\\phi'$。距离 $|\\mathbf{r}-\\mathbf{r}'|$ 由余弦定理给出：\n$$ |\\mathbf{r}-\\mathbf{r}'| = \\sqrt{r^2 + r'^2 - 2rr'\\cos\\theta'} $$\n$V(r)$ 的积分为：\n$$ V(r) = \\frac{1}{4\\pi} \\int_0^{2\\pi} \\mathrm{d}\\phi' \\int_0^a r'^2 \\mathrm{d}r' \\int_0^\\pi \\frac{\\sin\\theta'}{\\sqrt{r^2 + r'^2 - 2rr'\\cos\\theta'}} \\mathrm{d}\\theta' $$\n对 $\\phi'$ 的积分得到一个因子 $2\\pi$。\n$$ V(r) = \\frac{1}{2} \\int_0^a r'^2 \\mathrm{d}r' \\int_0^\\pi \\frac{\\sin\\theta'}{\\sqrt{r^2 + r'^2 - 2rr'\\cos\\theta'}} \\mathrm{d}\\theta' $$\n让我们计算关于 $\\theta'$ 的内层积分。令 $u = \\cos\\theta'$，则 $\\mathrm{d}u = -\\sin\\theta' \\mathrm{d}\\theta'$。\n$$ \\int_0^\\pi \\frac{\\sin\\theta'}{\\sqrt{r^2+r'^2 - 2rr'\\cos\\theta'}} \\mathrm{d}\\theta' = \\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\sqrt{r^2+r'^2-2rr'u}} = \\left[ -\\frac{\\sqrt{r^2+r'^2-2rr'u}}{rr'} \\right]_{-1}^{1} $$\n$$ = -\\frac{1}{rr'} \\left( \\sqrt{r^2+r'^2-2rr'} - \\sqrt{r^2+r'^2+2rr'} \\right) = -\\frac{1}{rr'} \\left( \\sqrt{(r-r')^2} - \\sqrt{(r+r')^2} \\right) $$\n$$ = -\\frac{1}{rr'} \\left( |r-r'| - (r+r') \\right) $$\n$|r-r'|$ 的值取决于 $r > r'$ 还是 $r  r'$。\n\n情况1：点 $\\mathbf{r}$ 在球体外部或其表面上（$r \\ge a$）。\n对于任何 $r' \\in [0, a]$，我们有 $r \\ge r'$，因此 $|r-r'| = r-r'$。\n关于 $\\theta'$ 的积分计算结果为：\n$$ -\\frac{1}{rr'} \\left( (r-r') - (r+r') \\right) = -\\frac{1}{rr'} (-2r') = \\frac{2}{r} $$\n将此结果代入 $V(r)$ 的表达式中：\n$$ V(r) = \\frac{1}{2} \\int_0^a r'^2 \\left(\\frac{2}{r}\\right) \\mathrm{d}r' = \\frac{1}{r} \\int_0^a r'^2 \\mathrm{d}r' = \\frac{1}{r} \\left[\\frac{r'^3}{3}\\right]_0^a = \\frac{a^3}{3r} \\quad (\\text{对于 } r \\ge a) $$\n\n情况2：点 $\\mathbf{r}$ 在球体内部（$r \\le a$）。\n关于 $r'$ 的积分必须在 $r'=r$ 处拆分。\n对于 $0 \\le r' \\le r$，$|r-r'| = r-r'$，内层积分为 $\\frac{2}{r}$。\n对于 $r \\le r' \\le a$，$|r-r'| = r'-r$，内层积分为 $-\\frac{1}{rr'} \\left( (r'-r) - (r+r') \\right) = -\\frac{1}{rr'}(-2r) = \\frac{2}{r'}$。\n所以，对于 $r \\le a$，$V(r)$ 变为：\n$$ V(r) = \\frac{1}{2} \\left( \\int_0^r r'^2 \\left(\\frac{2}{r}\\right) \\mathrm{d}r' + \\int_r^a r'^2 \\left(\\frac{2}{r'}\\right) \\mathrm{d}r' \\right) $$\n$$ V(r) = \\frac{1}{r} \\int_0^r r'^2 \\mathrm{d}r' + \\int_r^a r' \\mathrm{d}r' = \\frac{1}{r} \\left[\\frac{r'^3}{3}\\right]_0^r + \\left[\\frac{r'^2}{2}\\right]_r^a $$\n$$ V(r) = \\frac{r^2}{3} + \\left(\\frac{a^2}{2} - \\frac{r^2}{2}\\right) = \\frac{a^2}{2} - \\frac{r^2}{6} \\quad (\\text{对于 } r \\le a) $$\n\n现在我们必须找到 $V(r)$ 在 $r \\ge 0$ 上的上确界。\n对于 $r \\ge a$，$V(r) = \\frac{a^3}{3r}$ 是一个关于 $r$ 的单调递减函数。它在此区域的最大值在 $r=a$ 处取得，此时 $V(a) = \\frac{a^2}{3}$。\n对于 $0 \\le r \\le a$，$V(r) = \\frac{a^2}{2} - \\frac{r^2}{6}$ 是一个关于 $r$ 的抛物线函数，当 $r$ 从 $0$ 增加时该函数值减小。其最大值在 $r=0$ 处取得，此时 $V(0) = \\frac{a^2}{2}$。\n因为对于任何 $a>0$ 都有 $\\frac{a^2}{2} > \\frac{a^2}{3}$，所以 $V(r)$ 的全局最大值（上确界）出现在球心处，即 $r=0$。\n$$ \\sup_{\\mathbf{r} \\in \\mathbb{R}^{3}} V(\\mathbf{r}) = V(0) = \\frac{a^2}{2} $$\n将此结果代回 $\\beta$ 的表达式中：\n$$ \\beta = k^{2} |\\chi| \\left( \\frac{a^2}{2} \\right) = \\frac{1}{2} |\\chi| k^2 a^2 = \\frac{1}{2} |\\chi| (ka)^2 $$\n这就是玻恩有效性参数 $\\beta$ 的闭式表达式。\n\n一阶玻恩近似的有效性条件是 $\\beta  1$，即：\n$$ \\frac{1}{2} |\\chi| (ka)^2  1 $$\n这个单一的不等式包含了两种不同的物理情况：\n1.  **弱衬度情况：** 如果夹杂物的衬度很小，即 $|\\chi| \\ll 1$，那么即使 $ka$ 的值中等偏大，该不等式也可能成立。这意味着夹杂物的材料属性与背景介质的属性非常接近。\n2.  **小 $ka$ 情况：** 如果无量纲参数 $ka = \\frac{\\omega a}{c_0} = 2\\pi \\frac{a}{\\lambda_0}$ 很小，即 $ka \\ll 1$，那么即使衬度 $|\\chi|$ 的值很大，该不等式也可能成立。这对应于散射体尺寸 $a$ 远小于入射声场波长 $\\lambda_0$ 的情况（低频或瑞利散射极限）。\n\n因此，该判据表明，当衬度大小与散射体尺寸与波长之比的平方的乘积很小时，玻恩近似是合理的。",
            "answer": "$$\\boxed{\\frac{1}{2} |\\chi| (ka)^2}$$"
        },
        {
            "introduction": "在建立了正演模型后，声源识别中的一个核心问题是：在存在噪声的情况下，我们能达到的最佳定位精度是多少？克拉默-拉奥下界（CRLB）为任何无偏估计器的方差提供了这一基本限制。本练习将指导你计算一个典型声源定位场景的CRLB，从而将声学物理模型与统计估计理论联系起来，深刻理解定位精度的物理和几何限制。",
            "id": "4113013",
            "problem": "考虑一个自由空间中的时谐点（单极子）声源，其复声源强度 $Q \\in \\mathbb{C}$ 和角频率 $\\omega$ 已知，在一个声速为 $c$ 的均匀流体中辐射。令声波数为 $k = \\omega/c$。由位于 $\\mathbf{s} = (x_{0}, y_{0}, 0)^{\\top}$ 的声源在位置 $\\mathbf{r} \\in \\mathbb{R}^{3}$ 处产生的复声压由自由空间格林函数建模：\n$$\np(\\mathbf{r}; \\mathbf{s}) = Q \\, G(\\|\\mathbf{r}-\\mathbf{s}\\|), \\quad G(R) = \\frac{\\exp(i k R)}{4 \\pi R},\n$$\n其中 $R = \\|\\mathbf{r}-\\mathbf{s}\\|$。\n\n假设有 $N \\geq 3$ 个传感器放置在平面 $z=0$ 内，均匀分布于一个以原点为中心、半径为 $a0$ 的圆上，其已知位置为 $\\{\\mathbf{r}_{n}\\}_{n=1}^{N}$：\n$$\n\\mathbf{r}_{n} = \\big(a \\cos \\varphi_{n}, \\, a \\sin \\varphi_{n}, \\, 0\\big)^{\\top}, \\quad \\varphi_{n} = \\frac{2\\pi (n-1)}{N}.\n$$\n每个传感器提供一个复窄带测量值\n$$\ny_{n} = p(\\mathbf{r}_{n}; \\mathbf{s}) + w_{n},\n$$\n其中 $w_{n}$ 是独立的、零均值、圆对称复高斯噪声，其协方差为 $\\mathbb{E}[w_{n} w_{m}^{\\ast}] = \\sigma^{2} \\delta_{nm}$，且 $\\sigma^{2}  0$ 已知。未知参数向量是声源位置 $\\mathbf{s} = (x_{0}, y_{0}, 0)^{\\top}$；声源强度 $Q$、波数 $k$、半径 $a$、传感器数量 $N$ 以及噪声方差 $\\sigma^{2}$ 均为已知。\n\n假设真实声源位置在原点，即 $(x_{0}, y_{0}) = (0, 0)$。在此配置下，计算任意无偏估计量对每个笛卡尔坐标 $x_{0}$ 和 $y_{0}$ 的方差的克拉默-拉奥下界 (CRLB)，该下界在真实位置处进行评估。您的最终结果必须是关于 $N$、$a$、$k$、$|Q|$ 和 $\\sigma^{2}$ 的函数，表示为公共下界 $\\operatorname{CRLB}_{x} = \\operatorname{CRLB}_{y}$ 的单个闭式解析表达式。请以平方米为单位表示您的答案。请勿简化物理模型或引入此处所述之外的额外近似。",
            "solution": "我们从复测量值的统计模型开始。测量向量 $\\mathbf{y} \\in \\mathbb{C}^{N}$ 的均值为 $\\boldsymbol{\\mu}(\\boldsymbol{\\theta}) \\in \\mathbb{C}^{N}$，协方差为 $\\sigma^{2} \\mathbf{I}_{N}$，其中实参数向量为 $\\boldsymbol{\\theta} = (x_{0}, y_{0})^{\\top}$ 且\n$$\n\\mu_{n}(\\boldsymbol{\\theta}) = Q \\, G(R_{n}), \\quad R_{n} = \\|\\mathbf{r}_{n} - \\mathbf{s}\\| = \\sqrt{(a \\cos \\varphi_{n} - x_{0})^{2} + (a \\sin \\varphi_{n} - y_{0})^{2}}.\n$$\n对于协方差为 $\\sigma^{2} \\mathbf{I}$ 的独立、圆对称复高斯噪声，其似然函数为\n$$\np(\\mathbf{y} \\mid \\boldsymbol{\\theta}) = \\frac{1}{(\\pi \\sigma^{2})^{N}} \\exp\\!\\left( - \\frac{1}{\\sigma^{2}} \\|\\mathbf{y} - \\boldsymbol{\\mu}(\\boldsymbol{\\theta})\\|_{2}^{2} \\right).\n$$\n对于具有实参数和复均值的此类模型，费雪信息矩阵 $\\mathbf{J}(\\boldsymbol{\\theta}) \\in \\mathbb{R}^{2 \\times 2}$ 的元素为\n$$\nJ_{ij}(\\boldsymbol{\\theta}) = \\frac{2}{\\sigma^{2}} \\, \\Re \\!\\left\\{ \\sum_{n=1}^{N} \\frac{\\partial \\mu_{n}^{\\ast}}{\\partial \\theta_{i}} \\, \\frac{\\partial \\mu_{n}}{\\partial \\theta_{j}} \\right\\}, \\quad i,j \\in \\{1,2\\},\n$$\n其中 $\\theta_{1} = x_{0}$，$\\theta_{2} = y_{0}$，$\\Re\\{\\cdot\\}$ 表示实部。\n\n因此，任意无偏估计量 $\\widehat{\\boldsymbol{\\theta}}$ 的克拉默-拉奥下界 (CRLB) 是费雪信息矩阵的逆，\n$$\n\\operatorname{Cov}(\\widehat{\\boldsymbol{\\theta}}) \\succeq \\mathbf{J}(\\boldsymbol{\\theta})^{-1},\n$$\n特别地，$x_{0}$ 和 $y_{0}$ 上的方差下界为 $\\operatorname{CRLB}_{x} = [\\mathbf{J}^{-1}]_{11}$ 和 $\\operatorname{CRLB}_{y} = [\\mathbf{J}^{-1}]_{22}$。\n\n我们来计算所需的偏导数。使用链式法则，\n$$\n\\frac{\\partial \\mu_{n}}{\\partial x_{0}} = Q \\, \\frac{\\partial G}{\\partial R}\\Big|_{R=R_{n}} \\, \\frac{\\partial R_{n}}{\\partial x_{0}}, \\quad\n\\frac{\\partial \\mu_{n}}{\\partial y_{0}} = Q \\, \\frac{\\partial G}{\\partial R}\\Big|_{R=R_{n}} \\, \\frac{\\partial R_{n}}{\\partial y_{0}}.\n$$\n首先，对格林函数关于距离 $R$ 求导：\n$$\nG(R) = \\frac{\\exp(i k R)}{4\\pi R} \\;\\;\\Rightarrow\\;\\; \\frac{\\mathrm{d}G}{\\mathrm{d}R} = \\frac{1}{4\\pi} \\, \\frac{\\mathrm{d}}{\\mathrm{d}R} \\!\\left( \\frac{\\exp(i k R)}{R} \\right) = \\frac{1}{4\\pi} \\, \\exp(i k R) \\, \\frac{i k R - 1}{R^{2}}.\n$$\n接下来，对 $R_{n}$ 关于 $x_{0}$ 和 $y_{0}$ 求导。对于一般的 $(x_{0}, y_{0})$，\n$$\n\\frac{\\partial R_{n}}{\\partial x_{0}} = - \\frac{a \\cos \\varphi_{n} - x_{0}}{R_{n}}, \\quad \\frac{\\partial R_{n}}{\\partial y_{0}} = - \\frac{a \\sin \\varphi_{n} - y_{0}}{R_{n}}.\n$$\n在真实位置 $(x_{0}, y_{0}) = (0,0)$ 处，我们有对所有 $n$，$R_{n} = a$，并且\n$$\n\\left.\\frac{\\partial R_{n}}{\\partial x_{0}}\\right|_{(0,0)} = - \\cos \\varphi_{n}, \\quad\n\\left.\\frac{\\partial R_{n}}{\\partial y_{0}}\\right|_{(0,0)} = - \\sin \\varphi_{n}.\n$$\n因此，\n$$\n\\left.\\frac{\\partial \\mu_{n}}{\\partial x_{0}}\\right|_{(0,0)} = - Q \\, \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\, \\cos \\varphi_{n}, \\quad\n\\left.\\frac{\\partial \\mu_{n}}{\\partial y_{0}}\\right|_{(0,0)} = - Q \\, \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\, \\sin \\varphi_{n}.\n$$\n现在我们将这些代入费雪信息矩阵的元素中。注意所需的乘积是\n$$\n\\left|\\frac{\\partial \\mu_{n}}{\\partial x_{0}}\\right|^{2} = |Q|^{2} \\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2} \\cos^{2} \\varphi_{n}, \\quad\n\\left|\\frac{\\partial \\mu_{n}}{\\partial y_{0}}\\right|^{2} = |Q|^{2} \\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2} \\sin^{2} \\varphi_{n},\n$$\n以及\n$$\n\\left(\\frac{\\partial \\mu_{n}}{\\partial x_{0}}\\right)^{\\!\\ast} \\left(\\frac{\\partial \\mu_{n}}{\\partial y_{0}}\\right) = |Q|^{2} \\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2} \\cos \\varphi_{n} \\sin \\varphi_{n},\n$$\n在本次对称评估中，这些值都是实数，因此实部算子是多余的。在 $R=a$ 处，$\\mathrm{d}G/\\mathrm{d}R$ 的模为\n$$\n\\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2}\n= \\left| \\frac{1}{4\\pi} \\, \\exp(i k a) \\, \\frac{i k a - 1}{a^{2}} \\right|^{2}\n= \\frac{1}{16 \\pi^{2}} \\, \\frac{|i k a - 1|^{2}}{a^{4}}\n= \\frac{1}{16 \\pi^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right).\n$$\n利用均匀的角间距，我们使用以下求和公式\n$$\n\\sum_{n=1}^{N} \\cos^{2} \\varphi_{n} = \\sum_{n=1}^{N} \\sin^{2} \\varphi_{n} = \\frac{N}{2}, \\quad \\sum_{n=1}^{N} \\cos \\varphi_{n} \\sin \\varphi_{n} = 0.\n$$\n因此，在 $(0,0)$ 处的费雪信息矩阵是对角矩阵，且对角元素相等：\n\\begin{align*}\nJ_{xx} = \\frac{2}{\\sigma^{2}} \\sum_{n=1}^{N} \\left| \\frac{\\partial \\mu_{n}}{\\partial x_{0}} \\right|^{2}\n= \\frac{2}{\\sigma^{2}} \\, |Q|^{2} \\left| \\frac{\\mathrm{d}G}{\\mathrm{d}R}\\Big|_{R=a} \\right|^{2} \\sum_{n=1}^{N} \\cos^{2} \\varphi_{n} \\\\\n= \\frac{2}{\\sigma^{2}} \\, |Q|^{2} \\left( \\frac{1}{16 \\pi^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right) \\right) \\left( \\frac{N}{2} \\right)\n= \\frac{N \\, |Q|^{2}}{16 \\pi^{2} \\sigma^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right), \\\\\nJ_{yy} = \\frac{2}{\\sigma^{2}} \\sum_{n=1}^{N} \\left| \\frac{\\partial \\mu_{n}}{\\partial y_{0}} \\right|^{2}\n= \\frac{N \\, |Q|^{2}}{16 \\pi^{2} \\sigma^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right), \\\\\nJ_{xy} = \\frac{2}{\\sigma^{2}} \\sum_{n=1}^{N} \\Re \\!\\left\\{ \\left(\\frac{\\partial \\mu_{n}}{\\partial x_{0}}\\right)^{\\!\\ast} \\left(\\frac{\\partial \\mu_{n}}{\\partial y_{0}}\\right) \\right\\} = 0.\n\\end{align*}\n因此 $\\mathbf{J}$ 是单位矩阵的标量倍，其逆矩阵也是对角矩阵，且对角元素相同。每个坐标方差的 CRLB 是 $J_{xx}$ 的倒数：\n\\begin{align*}\n\\operatorname{CRLB}_{x} = \\operatorname{CRLB}_{y} = \\frac{1}{J_{xx}}\n= \\left[ \\frac{N \\, |Q|^{2}}{16 \\pi^{2} \\sigma^{2}} \\left( \\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}} \\right) \\right]^{-1} \\\\\n= \\frac{16 \\pi^{2} \\sigma^{2}}{N \\, |Q|^{2}} \\left( \\frac{1}{\\frac{k^{2}}{a^{2}} + \\frac{1}{a^{4}}} \\right)\n= \\frac{16 \\pi^{2} \\sigma^{2} a^{4}}{N \\, |Q|^{2} \\left( k^{2} a^{2} + 1 \\right)}.\n\\end{align*}\n该表达式的单位是平方米，符合要求：$a$ 的单位是米，$k$ 的单位是米分之一，而在这种窄带复基带表示法中，$|Q|^{2}/\\sigma^{2}$ 是无量纲的。\n\n因此，在给定 $N$ 个均匀分布于半径为 $a$ 的圆上的传感器，且 $Q$、$k$ 和噪声方差 $\\sigma^{2}$ 已知的情况下，对于原点处任一坐标 $x_{0}$ 或 $y_{0}$ 的任意无偏估计量的方差，其共同的克拉默-拉奥下界为\n$$\n\\operatorname{CRLB}_{x} = \\operatorname{CRLB}_{y} = \\frac{16 \\pi^{2} \\sigma^{2} a^{4}}{N \\, |Q|^{2} \\left( k^{2} a^{2} + 1 \\right)}.\n$$\n以平方米表示，这便是所要求的闭式结果。",
            "answer": "$$\\boxed{\\frac{16 \\pi^{2} \\sigma^{2} a^{4}}{N \\, |Q|^{2} \\left( k^{2} a^{2} + 1 \\right)}}$$"
        },
        {
            "introduction": "将散射理论应用于实际，需要稳健的数值计算方法。边界积分方程（BIE）法是一种求解声散射问题的强大工具，它将无限域中的问题简化为在有限边界上的求解。本练习将提供一个完整的编码实践，通过实现边界积分方程的Nyström离散化，让你掌握处理奇异核函数的关键技术，并学习如何通过与解析解对比来验证数值方法的准确性。",
            "id": "4113021",
            "problem": "考虑在自由空间中由亥姆霍兹方程控制的二维时谐声散射问题。设 $\\Gamma$ 为 $\\mathbb{R}^2$ 中的一条光滑闭合曲线，由一个 $2\\pi$-周期映射 $\\mathbf{x}(\\tau)$ 参数化，其中 $\\tau \\in [0,2\\pi)$，弧长元为 $\\mathrm{d}s = \\lvert \\mathbf{x}'(\\tau)\\rvert \\,\\mathrm{d}\\tau$。外部散射场 $u^{\\mathrm{scat}}$ 满足\n$$\n\\Delta u^{\\mathrm{scat}}(\\mathbf{x}) + k^2 u^{\\mathrm{scat}}(\\mathbf{x}) = 0 \\quad \\text{for } \\mathbf{x} \\in \\mathbb{R}^2 \\setminus \\overline{\\Omega}, \n$$\n并在无穷远处满足 Sommerfeld 辐射条件，其中 $\\Omega$ 是由 $\\Gamma$ 包围的有界域，$k0$ 是波数（单位为 $\\mathrm{m}^{-1}$）。对于软声障体（Dirichlet 边界条件），总场 $u^{\\mathrm{tot}} = u^{\\mathrm{inc}} + u^{\\mathrm{scat}}$ 必须满足\n$$\nu^{\\mathrm{tot}}(\\mathbf{x}) = 0 \\quad \\text{for } \\mathbf{x} \\in \\Gamma,\n$$\n其中 $u^{\\mathrm{inc}}$ 是一个给定的入射场。\n\n散射场的一个经典边界积分表示是单层势\n$$\nu^{\\mathrm{scat}}(\\mathbf{x}) = \\int_{\\Gamma} G_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) \\sigma(\\mathbf{y}) \\,\\mathrm{d}s(\\mathbf{y}),\n$$\n其中 $G_k(r) = \\frac{i}{4} H_0^{(1)}(k r)$ 是二维亥姆霍兹格林函数，$H_0^{(1)}$ 是零阶第一类 Hankel 函数，$\\sigma$ 是 $\\Gamma$ 上的未知密度。施加 Dirichlet 边界条件可得到第一类边界积分方程\n$$\n\\int_{\\Gamma} G_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) \\sigma(\\mathbf{y}) \\,\\mathrm{d}s(\\mathbf{y}) = -u^{\\mathrm{inc}}(\\mathbf{x}) \\quad \\text{for } \\mathbf{x} \\in \\Gamma.\n$$\n\n你需要在一个单位圆上实现该边界积分方程的配置 Nyström 离散化\n$$\n\\Gamma = \\left\\{ \\mathbf{x}(\\tau) = \\left(\\cos \\tau, \\sin \\tau\\right) : \\tau \\in [0,2\\pi) \\right\\},\n$$\n节点为等距分布的 $\\tau_j = \\frac{2\\pi j}{N}$，$j=0,\\dots,N-1$，且 $\\lvert \\mathbf{x}'(\\tau)\\rvert = 1$。在二维情况下，当 $\\mathbf{y} \\to \\mathbf{x}$ 时，积分核 $G_k$ 具有对数奇异性。具体来说，当 $\\mathbf{y}$ 趋近于 $\\mathbf{x}$ 时，有\n$$\nG_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) = -\\frac{1}{2\\pi} \\log \\lVert \\mathbf{x} - \\mathbf{y}\\rVert + \\text{光滑项}.\n$$\n在单位圆上，局部距离满足 $\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert = \\sqrt{2 - 2\\cos(\\tau - \\tau')} = 2 \\left\\lvert \\sin\\left(\\frac{\\tau - \\tau'}{2}\\right)\\right\\rvert$，因此\n$$\n\\log \\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert = \\frac{1}{2} \\log \\left(4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right)\\right).\n$$\n将核函数分裂为一个对数奇异部分和一个光滑余项是有益的，形式如下\n$$\nG_k\\left(\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert \\right) = A_{\\log}\\, \\log \\left( 4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right) \\right) + B_k(\\tau,\\tau'),\n$$\n其中 $A_{\\log} = -\\frac{1}{4\\pi}$ 是一个常系数，$B_k$ 是 $(\\tau,\\tau')$ 的一个光滑函数。光滑余项的对角值为\n$$\nB_k(\\tau,\\tau) = \\frac{i}{4} - \\frac{1}{2\\pi} \\left( \\log\\left(\\frac{k}{2}\\right) + \\gamma \\right),\n$$\n其中 $\\gamma$ 是欧拉-马歇罗尼常数。\n\n实现以下内容：\n\n1. 使用上述分裂方法为单层算子构建 $N \\times N$ 的 Nyström 矩阵。对光滑部分 $B_k(\\tau,\\tau')$ 使用周期梯形法则，对奇异部分使用特殊的对数权重。具体来说，对于等距节点，$\\log\\left(4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right)\\right)$ 对光滑密度的积分的 Kress 对数权重由以下公式给出\n$$\nR_d = \\frac{2\\pi}{N}\\left( -2 \\sum_{n=1}^{N-1} \\frac{1}{n} \\cos\\left(\\frac{2\\pi n d}{N}\\right) \\right), \\quad d = 0,1,\\dots,N-1,\n$$\n在节点差为 $d=\\lvert j-m\\rvert$ 时，对数部分的离散贡献为 $A_{\\log} \\, R_d$。\n\n2. 为未知密度值 $\\sigma_j \\approx \\sigma(\\tau_j)$ 建立线性系统：\n$$\n\\sum_{m=0}^{N-1} \\left( A_{\\log} R_{\\lvert j-m\\rvert} + \\frac{2\\pi}{N} \\, B_k(\\tau_j,\\tau_m) \\right) \\sigma_m = -u^{\\mathrm{inc}}(\\mathbf{x}(\\tau_j)), \\quad j=0,\\dots,N-1.\n$$\n\n3. 使用入射平面波\n$$\nu^{\\mathrm{inc}}(\\mathbf{x}) = e^{i k \\, \\mathbf{d}\\cdot \\mathbf{x}}, \\quad \\mathbf{d} = (1,0),\n$$\n并求解 $\\sigma$。\n\n4. 对于单位圆外的一个目标点 $\\mathbf{x}^\\star$，通过单层势计算散射场\n$$\nu^{\\mathrm{scat}}(\\mathbf{x}^\\star) \\approx \\sum_{m=0}^{N-1} G_k\\left(\\lVert \\mathbf{x}^\\star - \\mathbf{x}(\\tau_m)\\rVert \\right) \\sigma_m \\,\\frac{2\\pi}{N}.\n$$\n\n5. 将数值解与半径为 $a=1$ 的软声圆柱体散射的解析级数进行验证。在极坐标 $(r,\\theta)$（其中 $r1$）处的散射场为\n$$\nu^{\\mathrm{scat}}_{\\mathrm{analytic}}(r,\\theta) = \\sum_{n=-\\infty}^{\\infty} i^n \\, a_n \\, H_n^{(1)}(k r) \\, e^{i n \\theta}, \\quad a_n = -\\frac{J_n(k a)}{H_n^{(1)}(k a)},\n$$\n其中 $J_n$ 是第一类贝塞尔函数，$H_n^{(1)}$ 是第一类汉克尔函数。在 $\\lvert n\\rvert \\leq M$ 处对称地截断级数，其中 $M$ 的选择要对给定的 $k$ 和 $r$ 足够大。\n\n6. 对于每个测试用例，报告绝对误差\n$$\nE = \\left\\lvert u^{\\mathrm{scat}}(\\mathbf{x}^\\star) - u^{\\mathrm{scat}}_{\\mathrm{analytic}}(r,\\theta) \\right\\rvert,\n$$\n以浮点数（无量纲振幅）形式表示。\n\n全程使用弧度作为角度单位。距离单位为米，波数单位为 $\\mathrm{m}^{-1}$。对于单位圆，$a=1\\,\\mathrm{m}$。\n\n测试套件：\n- 案例 1 (正常路径): $k = 3.0\\,\\mathrm{m}^{-1}$，$N = 32$，$(r,\\theta) = (2.0\\,\\mathrm{m},\\,0.7\\,\\mathrm{rad})$。\n- 案例 2 (加密离散化): $k = 3.0\\,\\mathrm{m}^{-1}$，$N = 64$，$(r,\\theta) = (2.0\\,\\mathrm{m},\\,0.7\\,\\mathrm{rad})$。\n- 案例 3 (更高频率，远场): $k = 6.0\\,\\mathrm{m}^{-1}$，$N = 64$，$(r,\\theta) = (5.0\\,\\mathrm{m},\\,1.3\\,\\mathrm{rad})$。\n- 案例 4 (近边界求值): $k = 6.0\\,\\mathrm{m}^{-1}$，$N = 128$，$(r,\\theta) = (1.05\\,\\mathrm{m},\\,2.0\\,\\mathrm{rad})$。\n- 案例 5 (边缘案例，粗糙离散化): $k = 6.0\\,\\mathrm{m}^{-1}$，$N = 16$，$(r,\\theta) = (2.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{rad})$。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”）。每个结果必须是相应测试用例的绝对误差 $E$（一个浮点数），并按上述规定计算。",
            "solution": "当前任务是计算二维软声单位圆散射的声场，并将数值结果与已知的解析解进行验证。控制方程是亥姆霍兹方程，该问题被表述为第一类边界积分方程（BIE）。我们将采用一种带有特殊求积的 Nyström 离散化方法来处理积分核的对数奇异性。\n\n散射场 $u^{\\mathrm{scat}}$ 由边界 $\\Gamma$ 上的单层势表示：\n$$\nu^{\\mathrm{scat}}(\\mathbf{x}) = \\int_{\\Gamma} G_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) \\sigma(\\mathbf{y}) \\,\\mathrm{d}s(\\mathbf{y})\n$$\n此处，$\\sigma$ 是 $\\Gamma$ 上的一个未知密度函数，$G_k(r) = \\frac{i}{4} H_0^{(1)}(k r)$ 是二维亥姆霍兹方程的自由空间格林函数，其中 $H_0^{(1)}$ 是零阶第一类 Hankel 函数。波数用 $k$ 表示。\n\n在 $\\Gamma$ 上施加软声（Dirichlet）边界条件 $u^{\\mathrm{tot}} = u^{\\mathrm{inc}} + u^{\\mathrm{scat}} = 0$，可得到关于未知密度 $\\sigma$ 的第一类 BIE：\n$$\n\\int_{\\Gamma} G_k\\left(\\lVert \\mathbf{x} - \\mathbf{y}\\rVert \\right) \\sigma(\\mathbf{y}) \\,\\mathrm{d}s(\\mathbf{y}) = -u^{\\mathrm{inc}}(\\mathbf{x}) \\quad \\text{for } \\mathbf{x} \\in \\Gamma\n$$\n\n对于单位圆的特定情况，我们将边界 $\\Gamma$ 参数化为 $\\mathbf{x}(\\tau) = (\\cos \\tau, \\sin \\tau)$，其中 $\\tau \\in [0, 2\\pi)$。弧长元为 $\\mathrm{d}s = \\lvert \\mathbf{x}'(\\tau) \\rvert \\mathrm{d}\\tau = \\mathrm{d}\\tau$。BIE 变为：\n$$\n\\int_{0}^{2\\pi} G_k\\left(\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert \\right) \\sigma(\\tau') \\,\\mathrm{d}\\tau' = -u^{\\mathrm{inc}}(\\mathbf{x}(\\tau))\n$$\n\n数值求解该方程的一个重大挑战是当 $\\mathbf{y} \\to \\mathbf{x}$（或 $\\tau' \\to \\tau$）时核函数 $G_k$ 的对数奇异性。为达到高精度，需要一种特殊的求积方法。该问题指定将核函数分裂为一个奇异部分和一个光滑部分：\n$$\nG_k\\left(\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert \\right) = A_{\\log}\\, \\log \\left( 4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right) \\right) + B_k(\\tau,\\tau')\n$$\n其中 $A_{\\log} = -\\frac{1}{4\\pi}$。由于 $\\lVert \\mathbf{x}(\\tau) - \\mathbf{x}(\\tau')\\rVert^2 = 4 \\sin^2((\\tau-\\tau')/2)$，项 $\\log \\left( 4 \\sin^2\\left(\\frac{\\tau - \\tau'}{2}\\right) \\right)$ 捕捉了奇异行为。余项 $B_k(\\tau,\\tau')$ 是一个光滑函数，即使在对角线 $\\tau' = \\tau$ 上也是如此。\n\n数值解通过 Nyström 配置法进行。我们引入 $N$ 个等距配置点 $\\tau_j = \\frac{2\\pi j}{N}$，$j=0, \\dots, N-1$。积分方程在这些点上被强制满足，积分由求积和替代。涉及奇异部分的积分由特殊的 Kress 对数权重处理，而光滑部分的积分则使用高阶精度的周期梯形法则来近似。\n\n离散化的 BIE 为未知密度值 $\\sigma_m \\approx \\sigma(\\tau_m)$ 构成一个 $N \\times N$ 线性系统：\n$$\n\\sum_{m=0}^{N-1} S_{jm} \\sigma_m = -u^{\\mathrm{inc}}(\\mathbf{x}(\\tau_j)), \\quad j=0,\\dots,N-1\n$$\n系统矩阵 $S$ 由两部分组成：\n$$\nS_{jm} = S_{jm}^{\\log} + S_{jm}^{\\text{smooth}}\n$$\n来自奇异部分的贡献由 $S_{jm}^{\\log} = A_{\\log} R_{\\lvert j-m\\rvert}$ 给出，其中 $R_d$ 是所提供的 Kress 对数权重：\n$$\nR_d = \\frac{2\\pi}{N}\\left( -2 \\sum_{n=1}^{N-1} \\frac{1}{n} \\cos\\left(\\frac{2\\pi n d}{N}\\right) \\right), \\quad d = 0,1,\\dots,N-1\n$$\n来自光滑部分的贡献通过梯形法则获得，权重为 $\\frac{2\\pi}{N}$，得到 $S_{jm}^{\\text{smooth}} = \\frac{2\\pi}{N} B_k(\\tau_j, \\tau_m)$。\n\n矩阵 $S$ 的元素按如下方式构造：\n对于非对角元素 ($j \\neq m$)：\n- 令 $r_{jm} = \\lVert \\mathbf{x}(\\tau_j) - \\mathbf{x}(\\tau_m) \\rVert$。\n- 核函数的光滑部分为 $B_k(\\tau_j, \\tau_m) = G_k(r_{jm}) - A_{\\log} \\log(r_{jm}^2) = \\frac{i}{4} H_0^{(1)}(k r_{jm}) + \\frac{1}{2\\pi} \\log(r_{jm})$。\n- $S_{jm} = A_{\\log} R_{\\lvert j-m\\rvert} + \\frac{2\\pi}{N} \\left( \\frac{i}{4} H_0^{(1)}(k r_{jm}) + \\frac{1}{2\\pi} \\log(r_{jm}) \\right)$。\n\n对于对角元素 ($j=m$)：\n- 梯形法则应用于光滑函数 $B_k(\\tau_j, \\tau')$。对于对角项，我们需要极限值 $B_k(\\tau_j, \\tau_j)$。该值由以下公式给出：\n$$\nB_k(\\tau,\\tau) = \\frac{i}{4} - \\frac{1}{2\\pi} \\left( \\log\\left(\\frac{k}{2}\\right) + \\gamma \\right)\n$$\n其中 $\\gamma$ 是欧拉-马歇罗尼常数。\n- $S_{jj} = A_{\\log} R_0 + \\frac{2\\pi}{N} B_k(\\tau_j, \\tau_j)$。\n\n线性系统的右端项由方向为 $\\mathbf{d}=(1,0)$ 的入射平面波 $u^{\\mathrm{inc}}(\\mathbf{x}) = e^{i k \\mathbf{d} \\cdot \\mathbf{x}}$ 导出。在每个配置点 $\\mathbf{x}_j = (\\cos \\tau_j, \\sin \\tau_j)$，右端向量为 $b_j = -e^{i k \\cos \\tau_j}$。\n\n在求解系统 $S\\mathbf{\\sigma} = \\mathbf{b}$ 得到密度向量 $\\mathbf{\\sigma} = (\\sigma_0, \\dots, \\sigma_{N-1})^T$ 后，我们可以使用离散化的单层势在任意外部点 $\\mathbf{x}^\\star$ 计算散射场：\n$$\nu^{\\mathrm{scat}}(\\mathbf{x}^\\star) \\approx \\sum_{m=0}^{N-1} G_k\\left(\\lVert \\mathbf{x}^\\star - \\mathbf{x}(\\tau_m)\\rVert \\right) \\sigma_m \\,\\frac{2\\pi}{N}\n$$\n\n最后一步是将此数值结果与半径为 $a=1\\,\\mathrm{m}$ 的软声圆柱体散射的精确解析解进行验证。在极坐标 $(r,\\theta)$ 处的解析散射场由截断的米氏级数给出：\n$$\nu^{\\mathrm{scat}}_{\\mathrm{analytic}}(r,\\theta) = \\sum_{n=-M}^{M} i^n \\, a_n \\, H_n^{(1)}(k r) \\, e^{i n \\theta}, \\quad \\text{where } a_n = -\\frac{J_n(k a)}{H_n^{(1)}(k a)}\n$$\n$J_n$ 和 $H_n^{(1)}$ 分别是 n 阶贝塞尔函数和 n 阶汉克尔函数。截断指数 $M$ 的选择必须足够大以确保级数的收敛。\n\n然后为每个测试用例计算绝对误差 $E = \\left\\lvert u^{\\mathrm{scat}}(\\mathbf{x}^\\star) - u^{\\mathrm{scat}}_{\\mathrm{analytic}}(r,\\theta) \\right\\rvert$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import jn, hankel1\n\ndef compute_error(k, N, r, theta):\n    \"\"\"\n    Computes the error of the BIE solution for acoustic scattering from a unit circle.\n\n    Args:\n        k (float): Wavenumber.\n        N (int): Number of discretization points.\n        r (float): Radial coordinate of the evaluation point.\n        theta (float): Angular coordinate of the evaluation point.\n\n    Returns:\n        float: The absolute error between the numerical and analytical solutions.\n    \"\"\"\n    a = 1.0  # Radius of the unit circle\n    gamma = np.euler_gamma\n    A_log = -1.0 / (4.0 * np.pi)\n\n    # 1. Setup discretization grid\n    tau = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    nodes = np.vstack((a * np.cos(tau), a * np.sin(tau))).T\n\n    # 2. Construct Nyström matrix for the single-layer operator\n    \n    # 2a. Compute Kress logarithmic weights R_d\n    R = np.zeros(N)\n    n_vec = np.arange(1, N)\n    # d = 0 case\n    if N > 1:\n        R[0] = (2 * np.pi / N) * (-2 * np.sum(1.0 / n_vec))\n    else: # Handle N=1 case\n        R[0] = 0\n\n    # d = 1 to N-1 cases\n    for d_idx in range(1, N):\n        cos_terms = np.cos(2 * np.pi * n_vec * d_idx / N)\n        R[d_idx] = (2 * np.pi / N) * (-2 * np.sum(cos_terms / n_vec))\n\n    # 2b. Assemble the full system matrix S\n    S = np.zeros((N, N), dtype=np.complex128)\n    \n    # Diagonal term of the smooth part B_k\n    B_diag = 1j / 4.0 - (1.0 / (2.0 * np.pi)) * (np.log(k * a / 2.0) + gamma)\n\n    # Loop over rows (j) and columns (m)\n    for j in range(N):\n        for m in range(N):\n            if j == m:\n                # Diagonal entry\n                S[j, j] = A_log * R[0] + (2 * np.pi / N) * B_diag\n            else:\n                # Off-diagonal entry\n                dist = np.linalg.norm(nodes[j, :] - nodes[m, :])\n                \n                # Smooth part B_jm\n                B_jm = (1j / 4.0) * hankel1(0, k * dist) + (1.0 / (2.0 * np.pi)) * np.log(dist)\n                \n                d_idx = abs(j - m)\n                S[j, m] = A_log * R[d_idx] + (2 * np.pi / N) * B_jm\n\n    # 3. Form the right-hand side vector for an incident plane wave\n    # u_inc = exp(i * k * d . x), with d = (1, 0)\n    # x-coordinates of nodes are nodes[:, 0]\n    u_inc = np.exp(1j * k * nodes[:, 0])\n    b = -u_inc\n\n    # 4. Solve for the density sigma\n    sigma = np.linalg.solve(S, b)\n\n    # 5. Evaluate the scattered field at the target point\n    x_star = np.array([r * np.cos(theta), r * np.sin(theta)])\n    dists_to_star = np.linalg.norm(nodes - x_star, axis=1)\n    \n    # Green's function G_k at target distances\n    Gk_vals = (1j / 4.0) * hankel1(0, k * dists_to_star)\n    \n    # Discretized single-layer potential sum\n    u_scat_num = np.sum(Gk_vals * sigma) * (2 * np.pi * a / N)\n\n    # 6. Evaluate the analytic series solution\n    # Truncation number for the series. A safe choice based on k*a.\n    M = int(k * a + 5 * (k * a)**(1/3.0)) + 15\n    n_range = np.arange(-M, M + 1)\n\n    # Bessel and Hankel functions\n    jn_ka = jn(n_range, k * a)\n    hn_ka = hankel1(n_range, k * a)\n    hn_kr = hankel1(n_range, k * r)\n\n    # Coefficients an\n    a_n = -jn_ka / hn_ka\n\n    # Sum the series terms\n    terms = (1j**n_range) * a_n * hn_kr * np.exp(1j * n_range * theta)\n    u_scat_ana = np.sum(terms)\n    \n    # 7. Compute absolute error\n    error = np.abs(u_scat_num - u_scat_ana)\n    \n    return error\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # k, N, (r, theta)\n        (3.0, 32, (2.0, 0.7)),\n        (3.0, 64, (2.0, 0.7)),\n        (6.0, 64, (5.0, 1.3)),\n        (6.0, 128, (1.05, 2.0)),\n        (6.0, 16, (2.0, 1.0)),\n    ]\n\n    results = []\n    for k, N, (r, theta) in test_cases:\n        error = compute_error(k, N, r, theta)\n        results.append(f\"{error:.10e}\")\n\n    print(f\"[{','.join(results)}]\")\n\n# solve() is not called so that this block can be imported without execution.\n# The user of this file should call solve() if they want to run the tests.\n```"
        }
    ]
}