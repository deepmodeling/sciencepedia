{
    "hands_on_practices": [
        {
            "introduction": "近场声全息（NAH）的核心在于计算声场传播的能力。本练习将指导您从亥姆霍兹方程出发，实现基于角谱法的声场传播算子。通过亲手编写正向传播（倏逝波稳定衰减）和逆向传播（倏逝波不稳定增长）的代码，您将深刻理解为何逆向传播是一个不适定的反问题，以及正则化对于稳定重建的必要性 。",
            "id": "4130700",
            "problem": "从由标量亥姆霍兹方程控制的频域线性声学模型出发，在二维空间网格内实现用于近场声全息（NAH）的离散角谱传播算子。假设存在一个角频率为 $\\omega$、波数为 $k$、声速为 $c$ 的时谐声压场，使得压力场 $p(x,y,z)$ 在均匀无损介质中的线性声学常规假设下满足亥姆霍兹方程。使用基于对 $(x,y)$ 进行二维空间傅里叶变换的角谱表示法，以获得关于 $z$ 的针对模态内容的可分离常微分方程，并强制施加出射波（索末菲辐射）条件来确定纵向模态波数的正确分支。以此为出发点，推导笛卡尔网格上的离散传播算子，并正确处理传播分量（横向波数的量值小于声波数）和倏逝分量（横向波数的量值超过声波数），使用与辐射条件一致的适当的复值纵向波数分支。\n\n您的程序必须以自包含的方式实现以下内容：\n\n- 使用时谐压力 $p(x,y,z)$ 满足 $(\\nabla^2 + k^2)p = 0$ 这一基本原理，其中 $k = \\omega/c = 2\\pi f/c$，$f$ 是以赫兹为单位的时间频率，$c$ 是以米/秒为单位的声速。在 $(x,y)$ 上应用二维傅里叶变换以分离变量，并推导每个空间频率模式沿 $z$ 方向的常微分方程。不要假设任何预先推导出的传播算子；需从这些原理出发推导它，并使用辐射条件来强制采用物理上正确的分支。\n- 在大小为 $N_x \\times N_y$、间距为 $\\Delta x$ 和 $\\Delta y$（单位：米）的均匀网格上对空间域进行离散化。使用与物理单位中 $2\\pi$ 周期傅里叶核一致的标准离散傅里叶变换频率约定，构建相应的离散空间频率网格 $k_x$ 和 $k_y$（单位：弧度/米）。\n- 根据 $k$、$k_x$ 和 $k_y$ 构建复值纵向波数 $k_z$，选择能使倏逝模式在 $z$ 方向正向传播时衰减且传播模式为出射波的分支，以符合辐射条件。使用它来为传播距离 $z$（单位：米）构建前向算子 $H_{\\mathrm{fwd}}(k_x,k_y;z)$ 和反向算子 $H_{\\mathrm{back}}(k_x,k_y;z)$。前向算子将场从 $z=0$ 传播到 $z>0$，反向算子将场从 $z>0$ 反向传播到 $z=0$。\n- 为反向算子实现一个仅作用于倏逝内容的高斯锥形窗正则化。具体来说，定义 $k_t=\\sqrt{k_x^2 + k_y^2}$ 和一个无量纲正则化参数 $\\beta>0$。使用锥形窗 $W(k_t) = \\exp\\left(-\\left(\\max(0,k_t-k)/(\\beta k)\\right)^2\\right)$，使得对于 $k_t \\le k$ 有 $W(k_t)=1$，并对 $k_t>k$ 的倏逝分量进行平滑抑制。定义正则化后的反向算子 $H_{\\mathrm{back,reg}} = W \\cdot H_{\\mathrm{back}}$。\n- 通过计算离散网格上算子的以下四个无量纲度量指标，来数值化表征当 $k_t$ 从下方和上方接近 $k$ 时的稳定性：\n  $1)$ 前向算子的最大幅值 $\\max |H_{\\mathrm{fwd}}|$，\n  $2)$ 反向算子的最大幅值 $\\max |H_{\\mathrm{back}}|$，\n  $3)$ 正则化反向算子的最大幅值 $\\max |H_{\\mathrm{back,reg}}|$，\n  $4)$ 传播模式中的最小归一化纵向波数 $\\min_{k_t \\le k} |k_z|/k$。\n- 所有涉及距离的量必须以米表示，所有频率以赫兹表示，所有速度以米/秒表示。所要求的输出是无量纲的。\n\n使用以下参数集测试套件来检验不同情况，包括一般情况、一个 $k_t$ 接近 $k$ 的近掠射边界条件，以及一个长距离反向传播的边缘情况。对于每种情况，请使用给定的 $(N_x,N_y,\\Delta x,\\Delta y,f,c,z,\\beta)$ 值：\n\n- 情况 A（理想路径，具有大量倏逝分量但反向传播距离适中）：$N_x = 128$，$N_y = 128$，$\\Delta x = 8\\times 10^{-3}$ 米，$\\Delta y = 8\\times 10^{-3}$ 米，$f = 3000$ 赫兹，$c = 343$ 米/秒，$z = 5\\times 10^{-2}$ 米，$\\beta = 0.25$。\n- 情况 B（近掠射采样，其中最大横向波数接近 $k$）：$N_x = 128$，$N_y = 128$，$\\Delta x = 5.5\\times 10^{-2}$ 米，$\\Delta y = 5.5\\times 10^{-2}$ 米，$f = 3000$ 赫兹，$c = 343$ 米/秒，$z = 1\\times 10^{-1}$ 米，$\\beta = 0.25$。\n- 情况 C（有/无正则化时的强反向传播放大效应）：$N_x = 128$，$N_y = 128$，$\\Delta x = 8\\times 10^{-3}$ 米，$\\Delta y = 8\\times 10^{-3}$ 米，$f = 3000$ 赫兹，$c = 343$ 米/秒，$z = 2\\times 10^{-1}$ 米，$\\beta = 0.25$。\n\n对于每种情况，按 $[\\max |H_{\\mathrm{fwd}}|,\\ \\max |H_{\\mathrm{back}}|,\\ \\max |H_{\\mathrm{back,reg}}|,\\ \\min_{k_t \\le k} |k_z|/k]$ 的顺序列出上述四个度量指标。您的程序应生成单行输出，其中包含所有三种情况的结果，格式为一个由逗号分隔的列表，该列表包含三个按情况分的子列表，并用方括号括起来，例如 $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]$。输出必须是浮点数。不应打印任何额外文本。",
            "solution": "问题陈述在科学上是合理的、适定的，并提供了推导和实现用于近场声全息的离散角谱传播算子所需的所有信息。其基础模型是标量亥姆霍兹方程，这是线性声学的基石。所要求的推导遵循一个标准且物理上正确的程序，涉及空间傅里叶变换和索末菲辐射条件的应用。测试用例的参数在物理上是现实的，并且其选择旨在突出传播算子的关键行为，例如反向传播的不稳定性以及正则化的效果。因此，该问题被认为是有效的。\n\n推导和实现过程如下。\n\n在均匀无损介质中，角频率为 $\\omega$ 的时谐波的声压场 $p(x,y,z)$ 由标量亥姆霍兹方程控制：\n$$ (\\nabla^2 + k^2)p(x,y,z) = 0 $$\n其中 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$ 是拉普拉斯算子，$k = \\omega/c = 2\\pi f/c$ 是声波数，其中 $f$ 是时间频率，$c$ 是声速。\n\n为了使用角谱法求解此偏微分方程，我们对横向坐标 $(x,y)$ 应用二维空间傅里叶变换。变换对定义为：\n$$ P(k_x, k_y, z) = \\mathcal{F}_{xy}\\{p(x,y,z)\\} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} p(x,y,z) e^{-i(k_x x + k_y y)} dx dy $$\n$$ p(x,y,z) = \\frac{1}{(2\\pi)^2} \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} P(k_x, k_y, z) e^{i(k_x x + k_y y)} dk_x dk_y $$\n在这里，$P(k_x, k_y, z)$ 是压力场的角谱，表示具有横向波矢 $(k_x, k_y)$ 的平面波分量的振幅。将此变换逐项应用于亥姆霍兹方程，并使用傅里叶变换的微分性质 $\\mathcal{F}\\{\\frac{\\partial^n f}{\\partial x^n}\\} = (ik_x)^n \\mathcal{F}\\{f\\}$，我们得到：\n$$ (-k_x^2 - k_y^2 + \\frac{d^2}{dz^2} + k^2) P(k_x, k_y, z) = 0 $$\n令 $k_t = \\sqrt{k_x^2 + k_y^2}$ 为横向波矢的量值，对于每个空间频率分量 $(k_x, k_y)$，该方程简化为关于 $z$ 的二阶常微分方程：\n$$ \\frac{d^2P}{dz^2} + (k^2 - k_t^2)P = 0 $$\n将纵向波数 $k_z$ 定义为 $k_z^2 = k^2 - k_t^2$，方程变为：\n$$ \\frac{d^2P}{dz^2} + k_z^2 P = 0 $$\n此常微分方程的通解为 $P(z) = A e^{ik_z z} + B e^{-ik_z z}$。为确定系数 $A$ 和 $B$，我们强制施加索末菲辐射条件，该条件规定对于无源区域 $z>0$，波必须从源平面（假设在 $z=0$）传播出去，或在 $z \\to \\infty$ 时衰减为零。假设时间依赖关系为 $e^{-i\\omega t}$，则在 $+z$ 方向传播的波的形式为 $e^{i(k_z z - \\omega t)}$。因此，我们必须选择 $e^{ik_z z}$ 项，这意味着 $B=0$。$A$ 的值由 $z=0$ 处的场确定，得出 $A = P(k_x,k_y,0)$。因此，解为：\n$$ P(k_x,k_y,z) = P(k_x,k_y,0) e^{ik_z z} $$\n必须选择 $k_z = \\sqrt{k^2 - k_t^2}$ 的正确分支以满足辐射条件：\n$1$. 对于传播波（$k_t^2 \\le k^2$），$k_z$ 是实数。我们选择正根，$k_z = \\sqrt{k^2 - k_t^2}$，对应于前向传播。\n$2$. 对于倏逝波（$k_t^2 > k^2$），$k_z$ 是虚数。我们必须选择虚部为正的根，$k_z = i\\sqrt{k_t^2 - k^2}$，这样 $e^{ik_z z} = e^{-\\sqrt{k_t^2-k^2}z}$ 就表示一个随 $z$ 增加而衰减的场。\n通过选择 $k^2 - k_t^2$ 的那个实部和虚部均非负的根，这两个条件都可以得到满足。\n\n将场从平面 $z_0=0$ 传播到平面 $z>0$ 的前向传播算子 $H_{\\mathrm{fwd}}$ 由下式给出：\n$$ H_{\\mathrm{fwd}}(k_x,k_y; z) = e^{ik_z z} $$\n反向传播算子 $H_{\\mathrm{back}}$ 从 $z>0$ 处的场重建 $z=0$ 处的场，是前向算子的逆：\n$$ H_{\\mathrm{back}}(k_x,k_y; z) = \\frac{1}{H_{\\mathrm{fwd}}(k_x,k_y; z)} = e^{-ik_z z} $$\n前向算子的幅值为 $|H_{\\mathrm{fwd}}| = |e^{ik_z z}|$。对于传播波，$k_z$ 是实数，$|H_{\\mathrm{fwd}}|=1$。对于倏逝波，$k_z$ 是虚数，$|H_{\\mathrm{fwd}}| = e^{-\\text{Im}(k_z)z}  1$。因此，前向传播是一个稳定的过程。\n相反，反向算子的幅值为 $|H_{\\mathrm{back}}| = |e^{-ik_z z}|$。对于传播波，$|H_{\\mathrm{back}}|=1$。对于倏逝波，$|H_{\\mathrm{back}}| = e^{\\text{Im}(k_z)z}  1$。这种对高频分量（大 $k_t$）的指数级放大使得反向传播成为一个不适定反问题，对噪声高度敏感。\n\n为稳定反向传播，应用了正则化锥形窗 $W$。问题指定了一个仅作用于倏逝内容（$k_t  k$）的高斯锥形窗：\n$$ W(k_t) = \\exp\\left(-\\left(\\frac{\\max(0, k_t - k)}{\\beta k}\\right)^2\\right) $$\n其中 $\\beta  0$ 是一个控制锥形窗宽度的无量纲参数。正则化后的反向算子则为：\n$$ H_{\\mathrm{back,reg}} = W \\cdot H_{\\mathrm{back}} $$\n该锥形窗平滑地抑制了倏逝波的放大，使重建过程更加稳健。\n\n在大小为 $N_x \\times N_y$、间距为 $\\Delta x$ 和 $\\Delta y$ 的离散网格上，连续波数 $(k_x, k_y)$ 被其离散对应物所取代，这些对应物通过离散傅里叶变换（DFT）的频率约定获得：\n$$ k_{x,n} = \\frac{2\\pi n}{N_x \\Delta x}, \\quad k_{y,m} = \\frac{2\\pi m}{N_y \\Delta y} $$\n其中 $n$ 和 $m$ 是对应于DFT单元的整数索引。\n\n然后在此离散网格上计算所需的度量指标：\n$1$. $\\max |H_{\\mathrm{fwd}}|$：前向算子的最大幅值。理论上，此值应为 $1$。\n$2$. $\\max |H_{\\mathrm{back}}|$：不稳定反向算子的最大幅值，它衡量了最坏情况下的放大率。\n$3$. $\\max |H_{\\mathrm{back,reg}}|$：正则化反向算子的最大幅值，用以量化通过正则化实现的稳定性。\n$4$. $\\min_{k_t \\le k} |k_z|/k$：传播模式的最小归一化纵向波数。当网格上的最高频率传播模式越接近 $k_t=k$ 边界时，此度量指标接近 $0$，这种情况发生在“掠射”条件下。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and analyzes the discrete angular-spectrum propagation operator\n    for Near-Field Acoustic Holography (NAH).\n    \"\"\"\n\n    test_cases = [\n        # Case A: Happy path with significant evanescent content\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 8e-3, \"dy\": 8e-3, \n            \"f\": 3000, \"c\": 343, \"z\": 5e-2, \"beta\": 0.25\n        },\n        # Case B: Near-grazing sampling condition\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 5.5e-2, \"dy\": 5.5e-2, \n            \"f\": 3000, \"c\": 343, \"z\": 1e-1, \"beta\": 0.25\n        },\n        # Case C: Strong back-propagation amplification\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 8e-3, \"dy\": 8e-3, \n            \"f\": 3000, \"c\": 343, \"z\": 2e-1, \"beta\": 0.25\n        },\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        Nx = params[\"Nx\"]\n        Ny = params[\"Ny\"]\n        dx = params[\"dx\"]\n        dy = params[\"dy\"]\n        f = params[\"f\"]\n        c = params[\"c\"]\n        z = params[\"z\"]\n        beta = params[\"beta\"]\n\n        # 1. Calculate acoustic wavenumber k\n        k = 2 * np.pi * f / c\n\n        # 2. Create discrete spatial frequency grids (kx, ky) in rad/m\n        kx_vec = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n        ky_vec = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n        kx, ky = np.meshgrid(kx_vec, ky_vec, indexing='ij')\n\n        # 3. Calculate transverse wavenumber grid kt\n        kt_squared = kx**2 + ky**2\n        kt = np.sqrt(kt_squared)\n\n        # 4. Calculate longitudinal wavenumber kz, ensuring correct physical branch\n        # This implementation robustly handles propagating and evanescent modes.\n        kz = np.zeros_like(kt, dtype=np.complex128)\n        \n        # Propagating modes: kt^2 = k^2\n        propagating_mask = kt_squared = k**2\n        kz[propagating_mask] = np.sqrt(k**2 - kt_squared[propagating_mask])\n\n        # Evanescent modes: kt^2 > k^2\n        evanescent_mask = ~propagating_mask\n        kz[evanescent_mask] = 1j * np.sqrt(kt_squared[evanescent_mask] - k**2)\n\n        # 5. Construct propagation operators\n        # Forward operator H_fwd\n        H_fwd = np.exp(1j * kz * z)\n        \n        # Backward operator H_back\n        H_back = np.exp(-1j * kz * z)\n\n        # 6. Construct regularized backward operator H_back_reg\n        # Gaussian taper W(kt)\n        taper_arg = np.maximum(0, kt - k) / (beta * k)\n        W = np.exp(-(taper_arg**2))\n        \n        H_back_reg = W * H_back\n\n        # 7. Compute the four dimensionless metrics\n        \n        # Metric 1: Maximum magnitude of the forward operator\n        max_abs_H_fwd = np.max(np.abs(H_fwd))\n\n        # Metric 2: Maximum magnitude of the backward operator\n        max_abs_H_back = np.max(np.abs(H_back))\n        \n        # Metric 3: Maximum magnitude of the regularized backward operator\n        max_abs_H_back_reg = np.max(np.abs(H_back_reg))\n\n        # Metric 4: Minimum normalized longitudinal wavenumber among propagating modes\n        kz_propagating = kz[propagating_mask]\n        if kz_propagating.size > 0:\n            # np.abs is used for safety, though these kz values should be real\n            min_norm_kz = np.min(np.abs(kz_propagating)) / k\n        else:\n            # This case should not happen as (kx,ky)=(0,0) is always propagating\n            min_norm_kz = 0.0\n\n        case_results = [\n            max_abs_H_fwd,\n            max_abs_H_back,\n            max_abs_H_back_reg,\n            min_norm_kz\n        ]\n        results.append(case_results)\n\n    # Format the final output string as specified in the problem\n    case_results_str = []\n    for r in results:\n        # Format each list of floats into a string \"[f1,f2,f3,f4]\"\n        case_results_str.append(f\"[{','.join(map(str, r))}]\")\n    \n    # Join the case strings into the final format \"[[...],[...],[...]]\"\n    final_output_str = f\"[{','.join(case_results_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "虽然理论上近场声全息可以恢复无限精细的细节，但实际测量总是受到噪声的干扰。本练习旨在探索恢复高频倏逝波（携带精细空间信息）与放大噪声之间的基本权衡。您需要推导出“信息极限”——在该极限下，信号仍可与噪声基底区分开来的最大横向波数 $k_{t,\\\\max}$ 。",
            "id": "4130720",
            "problem": "在密度为 $\\rho$、声速为 $c$ 的均匀无损耗流体中，角频率为 $\\omega$ 的时谐声压场 $p(x,y,z)$ 满足亥姆霍兹方程 $\\nabla^{2} p + k^{2} p = 0$，其中 $k = \\omega / c$。在近场声全息（NAH）中，声场在 $z = z_{0}  0$ 的一个平面测量表面上被记录下来，并通过其关于横向坐标 $(x,y)$ 的二维空间傅里叶变换来表示，其横向波数大小为 $k_{t} = \\sqrt{k_{x}^{2} + k_{y}^{2}}$。对于 $k_{t}  k$ 的情况，相应的频谱分量是倏逝的，并从源平面 $z=0$ 向 $z0$ 的区域衰减。\n\n假设以下科学上符合实际的模型：\n- 约定为 $p(\\mathbf{r},t) = \\Re\\{p(\\mathbf{r}) \\exp(-\\mathrm{i} \\omega t)\\}$。\n- 每个空间傅里叶分量的前向传播场遵循色散关系 $k_{z}^{2} = k^{2} - k_{t}^{2}$，其中 $k_{z}$ 是轴向波数。对于 $k_{t}  k$，记 $k_{z} = \\mathrm{i} \\gamma(k_{t})$，其中 $\\gamma(k_{t}) = \\sqrt{k_{t}^{2} - k^{2}}$，从而产生轴向衰减因子 $\\exp(-\\gamma z)$。\n- 源平面频谱的幅度对于所有 $(k_{x},k_{y})$ 都有界，即 $|P(k_{x},k_{y}; z=0)| \\leq P_{0}$，其中 $P_{0}  0$ 是源平面上声压谱幅值的一个已知界限。\n- 测量系统存在一个加性声压噪声基底，其均方根幅值为 $\\sigma_{p}  0$，并假设在 $(k_{x},k_{y})$ 上是谱白的，且与信号无关。\n\n将测量平面 $z=z_{0}$ 处的最大可用横向波数 $k_{t,\\max}$ 定义为满足 $k_{t}  k$ 的最大值，使得在 $z=z_{0}$ 处，倏逝分量的幅度不被噪声淹没，即当从 $z=0$ 处的最坏情况界限 $P_{0}$ 开始时，其幅度至少等于噪声基底 $\\sigma_{p}$。\n\n从基本亥姆霍兹方程和平面波谱表示出发，推导 $k_{t,\\max}$ 作为 $k$、$z_{0}$、$P_{0}$ 和 $\\sigma_{p}$ 的函数的闭式解析表达式。以弧度/米为单位表示最终答案。不需要数值；仅提供符号表达式。如果 $P_{0} \\leq \\sigma_{p}$，你可以按照惯例假设 $k_{t,\\max} = k$（无可用的倏逝内容），但你推导的表达式应反映 $P_{0}  \\sigma_{p}$ 的一般情况。",
            "solution": "该问题要求在近场声全息（NAH）的背景下，推导最大可用横向波数 $k_{t,\\max}$ 的表达式。此推导从亥姆霍兹方程和声场的平面波谱表示所描述的波传播基本原理开始。\n\n时谐声压场 $p(x,y,z)$ 由亥姆霍兹方程 $\\nabla^{2} p + k^{2} p = 0$ 控制，其中 $k = \\omega/c$ 是声波数。该场可以通过关于横向坐标 $(x,y)$ 的二维空间傅里叶变换表示为平面波的叠加。令 $P(k_x, k_y; z)$ 表示在给定轴向位置 $z$ 处声压场 $p(x,y,z)$ 的空间傅里叶变换。\n\n对于沿 z 轴正方向传播的单个平面波分量，亥姆霍兹方程的解形式为 $P(k_x, k_y; z) = P(k_x, k_y; 0) \\exp(\\mathrm{i} k_z z)$。轴向波数 $k_z$ 由色散关系确定，该关系通过将平面波形式代入亥姆霍兹方程得到：$k_z^2 + k_x^2 + k_y^2 = k^2$。将横向波数大小定义为 $k_t = \\sqrt{k_x^2 + k_y^2}$，色散关系变为 $k_z^2 = k^2 - k_t^2$。\n\n该问题关注的是倏逝波，它对应于 $k_t  k$ 的情况。对于这些分量，$k_z^2$ 是负数。问题指明，对于前向传播场（在 $z0$ 处衰减），我们必须选择 $k_z$ 的具有正虚部的根。我们写作 $k_z = \\mathrm{i} \\sqrt{k_t^2 - k^2}$。这可以用实值衰减常数 $\\gamma(k_t) = \\sqrt{k_t^2 - k^2}$ 来表示，因此 $k_z = \\mathrm{i} \\gamma(k_t)$。\n\n因此，一个倏逝频谱分量从 $z=0$ 的源平面传播到 $z=z_0  0$ 的测量平面，其过程可描述为：\n$$P(k_x, k_y; z_0) = P(k_x, k_y; 0) \\exp(\\mathrm{i} k_z z_0) = P(k_x, k_y; 0) \\exp(\\mathrm{i} (\\mathrm{i} \\gamma(k_t)) z_0) = P(k_x, k_y; 0) \\exp(-\\gamma(k_t) z_0)$$\n对两边取模，得到：\n$$|P(k_x, k_y; z_0)| = |P(k_x, k_y; 0)| \\exp(-\\gamma(k_t) z_0)$$\n这个方程表明，倏逝分量的幅度随与源的距离 $z_0$ 呈指数衰减。由于 $\\gamma(k_t)$ 是 $k_t$ 的增函数，衰减率随 $k_t$ 的增加而增加。\n\n问题将最大可用横向波数 $k_{t,\\max}$ 定义为信号不被噪声淹没的最大 $k_t  k$。这可以通过将测量平面 $z=z_0$ 处的信号幅度设为等于噪声基底 $\\sigma_p$ 来量化。信号幅度在最坏情况（最大）源条件下进行评估，该条件由界限 $|P(k_x, k_y; z=0)| \\leq P_0$ 给出。因此，我们设 $|P(k_x, k_y; z=0)| = P_0$。\n\n因此，$k_{t,\\max}$ 的定义方程是：\n$$P_0 \\exp(-\\gamma(k_{t,\\max}) z_0) = \\sigma_p$$\n我们需要求解 $P_0  \\sigma_p$ 的情况，这确保了存在一个非平凡范围的可用的倏逝波数。我们着手求解 $k_{t,\\max}$：\n$$\\exp(-\\gamma(k_{t,\\max}) z_0) = \\frac{\\sigma_p}{P_0}$$\n对两边取自然对数：\n$$-\\gamma(k_{t,\\max}) z_0 = \\ln\\left(\\frac{\\sigma_p}{P_0}\\right)$$\n使用对数恒等式 $\\ln(a/b) = -\\ln(b/a)$，我们得到：\n$$\\gamma(k_{t,\\max}) z_0 = \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\n解出 $\\gamma(k_{t,\\max})$：\n$$\\gamma(k_{t,\\max}) = \\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\n现在，我们代入衰减常数的定义 $\\gamma(k_t) = \\sqrt{k_t^2 - k^2}$：\n$$\\sqrt{k_{t,\\max}^2 - k^2} = \\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)$$\n为了解出 $k_{t,\\max}$，我们对等式两边进行平方。由于 $k_{t,\\max}  k$ 且我们考虑 $P_0  \\sigma_p$，等式两边都是正数，所以这个操作是有效的。\n$$k_{t,\\max}^2 - k^2 = \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2$$\n最后，我们解出 $k_{t,\\max}^2$ 并取正平方根，因为波数大小必须为非负值：\n$$k_{t,\\max}^2 = k^2 + \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2$$\n$$k_{t,\\max} = \\sqrt{k^2 + \\left(\\frac{1}{z_0} \\ln\\left(\\frac{P_0}{\\sigma_p}\\right)\\right)^2}$$\n这个表达式给出了最大可用横向波数作为给定参数 $k$、$z_0$、$P_0$ 和 $\\sigma_p$ 的函数。单位是一致的：$k$ 的单位是 弧度/米，$z_0$ 的单位是 米，比值 $P_0/\\sigma_p$ 是无量纲的，这使得整个表达式如要求一样，单位为 弧度/米。",
            "answer": "$$ \\boxed{\\sqrt{k^{2} + \\left(\\frac{1}{z_{0}} \\ln\\left(\\frac{P_{0}}{\\sigma_{p}}\\right)\\right)^{2}}} $$"
        },
        {
            "introduction": "任何成像系统的关键性能指标都是其空间分辨率。此练习将抽象的波数带宽概念与瑞利判据下的具体空间分辨率指标 $\\Delta x_{R}(z_{0})$ 联系起来。您将推导出最小可分辨细节如何取决于有效波数截止频率，而该截止频率由系统硬件和前一个练习中探讨的噪声驱动极限共同决定 。",
            "id": "4130738",
            "problem": "一个位于 $z=0$ 的平面传声器阵列测量了复声压场 $p(x,0)$，该声场由位于平面 $z=-z_{0}$ 上的源分布在声速为 $c$ 的均匀无损介质中辐射产生。该声场满足标量亥姆霍兹方程 $\\nabla^{2}p + k^{2}p = 0$，其中 $k = \\omega/c$ 是声波数。近场声全息 (NAH) 通过在横向坐标 $x$ 上进行空间傅里叶变换，并使用平面波因子 $\\exp(i k_{z} z)$（其中 $k_{z} = \\sqrt{k^{2} - k_{x}^{2}}$）进行反向传播，来重建源平面场 $p(x,-z_{0})$。对于 $|k_{x}| \\leq k$，$k_{z}$ 是实数（传播分量）。对于 $|k_{x}|  k$，$k_{z} = i \\alpha$，其中 $\\alpha = \\sqrt{k_{x}^{2} - k^{2}}$（倏逝分量）。\n\n假设重建在横向波数域中采用一个矩形低通滤波器，该滤波器受硬件/处理带宽 $K_{B}$ 的限制（即保留 $|k_{x}| \\leq K_{B}$ 的分量），并应用截断的逆向反传播，丢弃那些逆滤波器幅值会超过由全局测量信噪比 $S_{0}  1$ 指定的无量纲噪声阈值的倏逝分量。也就是说，逆增益 $\\exp(\\alpha z_{0})  S_{0}$ 的倏逝分量被舍弃。考虑在源平面 $z=-z_{0}$ 上，沿 $x$ 方向相距 $\\Delta x$ 的两个等强度、同相的线源。\n\n从亥姆霍兹方程和平面波表示出发，将重建过程视为一个沿 $x$ 方向的带限移不变系统，其点扩展函数是保留的横向频谱的傅里叶逆变换，完成以下任务：\n\n- 为深度 $z_0$ 处的NAH定义一个沿 $x$ 方向的瑞利型分辨率判据，要求最小可分辨间距 $\\Delta x_{R}(z_{0})$ 是使得一个重建的点扩展函数的中心最大值与另一个点扩展函数的第一个零点重合的最小 $\\Delta x$。\n- 推导 $\\Delta x_{R}(z_{0})$ 如何联合地依赖于保留的横向波数带宽和上述由噪声驱动的截断。\n\n将最终分辨率 $\\Delta x_{R}(z_{0})$ 表示为一个以米为单位的闭式解析表达式，用 $k$、$z_{0}$、$K_{B}$ 和 $S_{0}$ 表示。不代入任何数值，也无需四舍五入。最终答案必须是单个解析表达式。",
            "solution": "首先对问题进行验证，以确保其科学上合理、内容自洽且提法得当。\n\n**步骤1：提取已知条件**\n- 控制方程：亥姆霍兹方程，$\\nabla^{2}p + k^{2}p = 0$。\n- 声波数：$k = \\omega/c$。\n- 源平面位置：$z = -z_{0}$。\n- 测量平面位置：$z = 0$。\n- 横向坐标：$x$。\n- 波数域中正向传播的关系：$P(k_x, z_2) = P(k_x, z_1) \\exp(ik_z(z_2-z_1))$。\n- 横向波数 $k_z$ 的定义：\n  - 对于传播波 ($|k_x| \\leq k$): $k_z = \\sqrt{k^2 - k_x^2}$。\n  - 对于倏逝波 ($|k_x|  k$): $k_z = i\\alpha$，其中 $\\alpha = \\sqrt{k_x^2 - k^2}$。\n- 重建约束1（硬件带宽）：$k_x$ 域中的矩形低通滤波器仅保留 $|k_x| \\leq K_B$ 的分量。\n- 重建约束2（噪声截断）：如果倏逝分量的逆滤波器增益 $\\exp(\\alpha z_{0})$ 超过信噪比阈值 $S_{0}  1$，则舍弃该分量。\n- 分辨率判据：瑞利型分辨率 $\\Delta x_{R}(z_{0})$ 是从一个重建的点扩展函数的中心最大值到其第一个零点的距离。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于波传播、傅里叶声学和逆问题理论的原理，这些是近场声全息（NAH）的核心。亥姆霍兹方程和平面波展开是标准模型。所指定的约束，即硬件带宽限制和基于噪声对倏逝波的正则化，代表了一个实用NAH系统的现实（尽管简化了）模型。问题正确地指出了重建倏逝波的不适定性（噪声的指数级放大），并且基于信噪比 $S_0$ 的截断是一种标准的正则化形式。该问题是客观的、提法得当的，并且所有术语都定义清晰，从而可以得到一个唯一的解析解。不存在科学缺陷、矛盾或含糊之处。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**分辨率推导**\n\n从 $z=0$ 平面的测量数据重建源平面 $z=-z_0$ 处的声场是一个逆问题。设 $p(x,z)$ 是复声压场，$P(k_x,z)$ 是其关于横向坐标 $x$ 的空间傅里叶变换。在傅里叶域中，源平面和测量平面上的声场之间的关系由传播算子给出：\n$$ P(k_x, 0) = P(k_x, -z_0) \\exp(ik_z z_0) $$\n重建过程旨在从测量的 $P(k_x, 0)$ 计算 $P(k_x, -z_0)$ 的估计值。这涉及到应用一个逆滤波器，理想情况下为 $H_{ideal}(k_x) = \\exp(-ik_z z_0)$。\n\n问题指出重建是一个线性移不变（LSI）系统。该系统的整体行为由其传递函数 $H(k_x)$ 描述，该函数决定了哪些空间频率分量被保留。如果分量 $k_x$ 满足所有指定约束，则被保留。传递函数 $H(k_x)$ 对于保留的分量为1，对于被舍弃的分量为0。\n\n我们来分析对保留的波数 $k_x$ 的约束条件。\n1.  **硬件带宽限制**：重建受最大横向波数 $K_B$ 的带限，因此只有 $|k_x| \\leq K_B$ 的分量被处理。\n2.  **噪声驱动的截断**：此约束适用于倏逝波，对于倏逝波有 $|k_x|k$ 且 $k_z = i\\alpha = i\\sqrt{k_x^2-k^2}$。这些分量的逆滤波器增益（幅值）为 $|\\exp(-ik_z z_0)| = |\\exp(-i(i\\alpha)z_0)| = \\exp(\\alpha z_0)$。问题陈述，如果此增益大于 $S_0$，则舍弃该分量。因此，倏逝分量仅在以下情况下被保留：\n    $$ \\exp(\\alpha z_0) \\leq S_0 $$\n    代入 $\\alpha = \\sqrt{k_x^2 - k^2}$，我们得到：\n    $$ \\exp\\left(z_0 \\sqrt{k_x^2 - k^2}\\right) \\leq S_0 $$\n    对两边取自然对数（因为 $S_0  1$，所以 $\\ln(S_0)  0$）：\n    $$ z_0 \\sqrt{k_x^2 - k^2} \\leq \\ln(S_0) $$\n    $$ \\sqrt{k_x^2 - k^2} \\leq \\frac{\\ln(S_0)}{z_0} $$\n    将两边平方并重新整理，得到关于 $k_x^2$ 的条件：\n    $$ k_x^2 - k^2 \\leq \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2 $$\n    $$ k_x^2 \\leq k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2 $$\n    这意味着由于噪声，横向波数的幅值有一个上限：\n    $$ |k_x| \\leq \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2} $$\n    我们将这个由噪声施加的截止波数定义为 $K_{noise} = \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}$。\n\n重建系统仅当空间频率分量 $k_x$ *同时*满足硬件和噪声约束时才保留它。这意味着有效通带是这两个区域的交集。因此，最大保留的横向波数 $K_{eff}$ 是两个单独截止波数中的最小值：\n$$ K_{eff} = \\min\\left(K_B, K_{noise}\\right) = \\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right) $$\nLSI重建系统的传递函数是波数域中的一个矩形窗：\n$$ H(k_x) = \\begin{cases} 1  \\text{if } |k_x| \\leq K_{eff} \\\\ 0  \\text{if } |k_x|  K_{eff} \\end{cases} $$\n系统的点扩展函数（PSF） $h(x)$ 是其传递函数 $H(k_x)$ 的傅里叶逆变换。对于一维系统，傅里叶逆变换定义为：\n$$ h(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} H(k_x) e^{ik_x x} dk_x $$\n代入 $H(k_x)$ 的表达式：\n$$ h(x) = \\frac{1}{2\\pi} \\int_{-K_{eff}}^{K_{eff}} (1) \\cdot e^{ik_x x} dk_x $$\n计算积分：\n$$ h(x) = \\frac{1}{2\\pi} \\left[ \\frac{e^{ik_x x}}{ix} \\right]_{-K_{eff}}^{K_{eff}} = \\frac{1}{2\\pi ix} \\left( e^{iK_{eff}x} - e^{-iK_{eff}x} \\right) $$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2i}$，我们可以将其简化为：\n$$ h(x) = \\frac{\\sin(K_{eff}x)}{\\pi x} $$\n该表达式是一个缩放的sinc函数。其中心最大值在 $x=0$ 处。\n\n根据问题中定义的瑞利型分辨率判据，最小可分辨间距 $\\Delta x_R(z_0)$ 是从PSF的中心最大值到其第一个零点的距离。$h(x)$ 的零点出现在分子为零且分母不为零时（即 $x \\neq 0$）。\n$$ \\sin(K_{eff}x) = 0 $$\n当 $K_{eff}x = n\\pi$（对于任何非零整数 $n$）时，此条件成立。第一个零点对应于 $n=1$（或 $n=-1$），这给出：\n$$ K_{eff}|x| = \\pi $$\n到这个第一个零点的距离是 $|x| = \\frac{\\pi}{K_{eff}}$。根据定义，这就是分辨率极限。\n$$ \\Delta x_R(z_0) = \\frac{\\pi}{K_{eff}} $$\n代入 $K_{eff}$ 的表达式：\n$$ \\Delta x_R(z_0) = \\frac{\\pi}{\\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right)} $$\n这是分辨率的最终解析表达式，显示了它对硬件带宽 $K_B$ 和由噪声驱动的截断（其本身取决于 $k$、$z_0$ 和 $S_0$）的联合依赖性。分辨率受到更严格的那个约束的限制（即，给出较小截止波数的那个）。",
            "answer": "$$ \\boxed{\\frac{\\pi}{\\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right)}} $$"
        }
    ]
}