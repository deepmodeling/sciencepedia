## 引言
[近场](@entry_id:269780)声全息（Near-field Acoustic Holography, NAH）是一项革命性的[声学成像](@entry_id:1120699)技术，它能够以前所未有的高分辨率重构声源表面的声学特性，被誉为“声学显微镜”。在工程实践中，精确定位和量化噪声源对于产品设计、故障诊断和噪声控制至关重要。传统[远场](@entry_id:269288)测量方法受限于物理[衍射极限](@entry_id:193662)，难以分辨声源的精细结构。NAH通过在声源近场区域进行测量，捕捉了携带亚波长信息的倏逝波，从而克服了这一根本性难题。然而，这也引入了新的挑战：在逆向重构声源的过程中，倏逝波的指数衰减特性使得问题变得高度“不适定”，微小的[测量噪声](@entry_id:275238)会被急剧放大，导致结果失真。

本文旨在为读者构建一个关于[近场](@entry_id:269780)声全息的完整知识框架，从核心原理到前沿应用。在**“原理与机制”**一章中，我们将深入亥姆霍兹方程和[角谱法](@entry_id:1121014)，揭示声场传播与重构的数学本质，并重点阐述[不适定性](@entry_id:635673)的来源以及作为解决方案的[正则化方法](@entry_id:150559)。随后，在**“应用与跨学科交叉”**一章中，我们将展示NAH如何在[声源定位](@entry_id:153968)、[远场](@entry_id:269288)预测以及与结构声学、[气动声学](@entry_id:266763)乃至天体物理学的交叉领域中发挥其强大威力。最后，通过**“动手实践”**部分引导读者将理论知识应用于具体计算问题，加深对NAH核心概念的理解。通过本次学习，您将掌握NAH背后的物理思想与数学工具，为解决实际声学问题打下坚实基础。

## 原理与机制

本章旨在深入探讨近场声全息（Near-field Acoustic Holography, NAH）方法背后的核心物理原理与数学机制。我们将从声波传播的基本物理模型出发，阐述如何将声场分解为平面[波的叠加](@entry_id:166456)，并在此基础上建立声场正向传播与逆向重构的数学框架。本章的重点在于揭示[近场](@entry_id:269780)声全息作为一个[逆问题](@entry_id:143129)的内在不适定性（ill-posedness），并系统地介绍为克服这一挑战所采用的[正则化技术](@entry_id:261393)。此外，我们还将讨论在实际应用中，离散采样、有限[孔径](@entry_id:172936)和窗函数等因素对重构结果的影响，从而为读者构建一个从理论到实践的完整知识体系。

### 声场的正向传播：[角谱法](@entry_id:1121014)

我们考虑一个在均匀、无损、[静止流体](@entry_id:187621)中传播的单频声场，其时间依赖关系为 $e^{-i\omega t}$，其中 $\omega$ 是[角频率](@entry_id:261565)。在这种情况下，声压的[复振幅](@entry_id:164138) $p(\mathbf{r})$ 满足 **[亥姆霍兹方程](@entry_id:149977)（Helmholtz equation）**：

$$
\nabla^2 p(\mathbf{r}) + k^2 p(\mathbf{r}) = 0
$$

其中 $k = \omega/c$ 是声学波数，$c$ 是介质中的声速。这个方程是[线性声学](@entry_id:1127264)中描述时谐声场空间分布的基本出发点。

近场声全息的核心思想之一是**[角谱法](@entry_id:1121014)（angular spectrum method）**，也称为[平面波分解](@entry_id:169203)法。该方法将任意复杂的声场视为一系列具有不同传播方向的平面波的线性叠加。在数学上，这通过对空间坐标 $(x, y)$ 进行[二维傅里叶变换](@entry_id:273583)来实现。我们将声压场 $p(x, y, z)$ 的[角谱](@entry_id:184925)定义为其在平行于 $xy$ 平面的[二维傅里叶变换](@entry_id:273583)：

$$
P(k_x, k_y, z) = \iint_{-\infty}^{\infty} p(x, y, z) e^{-i(k_x x + k_y y)} dx dy
$$

其中 $(k_x, k_y)$ 是横向波数，它们分别对应于 $x$ 和 $y$ 方向上的空间频率。将该表达式代入亥姆霍兹方程，可以得到一个关于 $z$ 的[常微分方程](@entry_id:147024)：

$$
\frac{d^2 P(k_x, k_y, z)}{dz^2} + (k^2 - k_x^2 - k_y^2) P(k_x, k_y, z) = 0
$$

我们定义轴向波数 $k_z$ 满足 **[色散关系](@entry_id:140395)（dispersion relation）**：

$$
k_x^2 + k_y^2 + k_z^2 = k^2
$$

因此，上述常微分方程可写作 $\frac{d^2 P}{dz^2} + k_z^2 P = 0$。其通解为 $P(z) = A e^{ik_z z} + B e^{-ik_z z}$。对于由 $z \le 0$ 区域的声源辐射到 $z > 0$ [半空间](@entry_id:634770)的声场，物理上合理的解必须满足 **[索末菲辐射条件](@entry_id:168772)（Sommerfeld radiation condition）**，即波在远离声源处应表现为向外传播或衰减。在 $e^{-i\omega t}$ 的时间约定下，这要求我们选择 $e^{ik_z z}$ 形式的解。因此，从 $z=0$ 平面到 $z=z_m$ 平面的声场[传播过程](@entry_id:1132219)，在波[数域](@entry_id:155558)中可以简洁地表示为：

$$
P(k_x, k_y, z_m) = P(k_x, k_y, 0) \cdot e^{i k_z z_m}
$$

这里的 $e^{i k_z z_m}$ 就是从 $z=0$ 到 $z=z_m$ 的 **传播算子（propagator）**。

#### 传播波与[倏逝波](@entry_id:156713)

根据横向波数 $k_t = \sqrt{k_x^2 + k_y^2}$ 与声学波数 $k$ 的相对大小，平面波分量可以分为两类：

1.  **传播波（Propagating Waves）**：当 $k_t^2 \le k^2$ 时，$k_z = \sqrt{k^2 - k_t^2}$ 是实数。这些分量在[传播过程](@entry_id:1132219)中相位发生变化，但振幅保持不变（在无损介质中）。它们是能够将[能量传播](@entry_id:202589)到远场的载体。事实上，声源在[远场](@entry_id:269288)的[辐射方向图](@entry_id:261777)完全由这些传播波分量决定。

2.  **倏逝波（Evanescent Waves）**：当 $k_t^2 > k^2$ 时，$k_z = \sqrt{k^2 - k_t^2}$ 是纯虚数。为了满足[辐射条件](@entry_id:1130495)（场在 $z \to \infty$ 时保持有界），我们必须选择使其在 $+z$ 方向衰减的解。在 $e^{-i\omega t}$ 约定下，这意味着 $k_z$ 的虚部必须为正。因此，我们取 $k_z = i\sqrt{k_t^2 - k^2} = i\alpha$，其中 $\alpha = \sqrt{k_t^2 - k^2}$ 是一个正实数。 此时，传播算子变为 $e^{i(i\alpha)z_m} = e^{-\alpha z_m}$。这表明[倏逝波](@entry_id:156713)的振幅会随着离开声源的距离呈指数衰减。它们不向[远场辐射](@entry_id:265518)能量，而是将能量束缚在声源[近场](@entry_id:269780)区域。然而，正是这些倏逝波携带了关于声源亚波长（sub-wavelength）尺寸的精细空间细节信息，这也是近场声全息能够实现超分辨率成像的关键。

因此，选择正确的 $k_z$ 分支至关重要。统一的规则是，对于向 $+z$ 方向辐射的声场，必须选择满足 $\operatorname{Re}(k_z) \ge 0$ 和 $\operatorname{Im}(k_z) \ge 0$ 的分支。

### [逆问题](@entry_id:143129)：声场的重构与不适定性

[近场](@entry_id:269780)声全息的本质是一个**[逆问题](@entry_id:143129)**：根据在测量平面 $z=z_m$ 上测得的声压 $p(x, y, z_m)$，反向推算（或称“重构”）声源平面 $z=0$ 上的声压 $p(x, y, 0)$。在波[数域](@entry_id:155558)中，这相当于求解：

$$
P(k_x, k_y, 0) = P(k_x, k_y, z_m) \cdot e^{-i k_z z_m}
$$

这里的 $e^{-i k_z z_m}$ 被称为 **逆向传播算子（back-propagation operator）**。

对于传播波分量，$k_z$ 是实数，逆向传播算子只是一个相位因子，其模为1。然而，对于[倏逝波](@entry_id:156713)分量，$k_z = i\alpha$，逆向传播算子变为：

$$
e^{-i(i\alpha)z_m} = e^{\alpha z_m} = e^{\sqrt{k_t^2 - k^2} z_m}
$$

这个算子的模是一个随 $k_t$ 和 $z_m$ [指数增长](@entry_id:141869)的[放大因子](@entry_id:144315)。 这意味着在重构过程中，高[空间频率](@entry_id:270500)的[倏逝波](@entry_id:156713)分量将被指数级放大。

实际测量中，麦克风阵列采集的信号 $p_{meas}(z_m)$ 不可避免地会包含噪声 $n$。在波[数域](@entry_id:155558)中，测得的[角谱](@entry_id:184925) $P_{meas}(z_m)$ 是真实信号[角谱](@entry_id:184925) $P_{true}(z_m)$ 与噪声[角谱](@entry_id:184925) $N$ 的和。经过逆向传播后，重构的声源[角谱](@entry_id:184925)为：

$$
P_{recon}(0) = (P_{true}(z_m) + N) \cdot e^{\alpha z_m} = P_{true}(0) + N \cdot e^{\alpha z_m}
$$

由于倏逝波在正向传播到测量平面时已经经历了指数衰减，其[信噪比](@entry_id:271861)（SNR）通常很低。在逆向传播时，噪声谱 $N$ 被指数因子 $e^{\alpha z_m}$ 极大地放大了。这种对输入数据中微小扰动（噪声）的极端敏感性，正是数学上所谓的**[不适定问题](@entry_id:182873)（ill-posed problem）**。

为了具体理解这个问题的严重性，我们来看一个实例。假设一个声源在空气中（$c = 343 \, \mathrm{m/s}$）辐射一个频率为 $f = 10 \, \mathrm{kHz}$ 的声场。我们在距离声源 $d = z_m = 0.02 \, \mathrm{m}$ 的平面上进行测量。考虑一个横向波数为 $k_t = 250 \, \mathrm{rad/m}$ 的倏逝波分量。首先，我们计算声学波数 $k = 2\pi f / c \approx 183.2 \, \mathrm{rad/m}$。由于 $k_t > k$，该分量确实是倏逝波。其衰减/[放大率](@entry_id:914447) $\alpha = \sqrt{k_t^2 - k^2} \approx \sqrt{250^2 - 183.2^2} \approx 170.1 \, \mathrm{rad/m}$。在逆向传播过程中，该分量的振幅将被放大 $e^{\alpha d} = e^{170.1 \times 0.02} = e^{3.402} \approx 30$ 倍。 这意味着[测量噪声](@entry_id:275238)在该[空间频率](@entry_id:270500)上的分量将被放大30倍，这足以完全淹没真实的信号，导致重构结果充满无意义的伪影。

### 逆问题的稳定化：[正则化方法](@entry_id:150559)

为了从不适定的[逆问题](@entry_id:143129)中获得稳定且有物理意义的解，必须采用**正则化（regularization）**技术。正则化的核心思想是引入关于解的[先验信息](@entry_id:753750)（例如，解应该是平滑的或能量有限的），从而在拟合测量数据和约束解的“不良”行为之间取得平衡。

在NAH中，正则化通常在波[数域](@entry_id:155558)中实现，其作用相当于一个滤波器，它会压制那些噪声被过度放大的高频分量。

#### Tikhonov 正则化

**Tikhonov 正则化**是一种应用广泛且功能强大的[正则化方法](@entry_id:150559)。它通过最小化一个包含数据保真项和正则化项的代价函数来求解：

$$
J(\widehat{x}) = \lVert A \widehat{x} - \widehat{b} \rVert_2^2 + \lambda^2 \lVert \mathbf{L}\widehat{x} \rVert_2^2
$$

其中，$\widehat{x}$ 是待求的声源[角谱](@entry_id:184925) $P(k_x, k_y, 0)$，$\widehat{b}$ 是测量的[角谱](@entry_id:184925) $P(k_x, k_y, z_m)$，$A$ 是正向传播算子 $e^{ik_z z_m}$，$\lambda > 0$ 是 **[正则化参数](@entry_id:162917)**，它控制着数据保真与解的约束之间的权重。$\mathbf{L}$ 是一个线性算子，用于施加对解的约束。

该最小化问题的解在波[数域](@entry_id:155558)中可以表示为一个滤波器作用于测量数据：

$$
\widehat{x}_{reg}(k_x, k_y) = \frac{A^*(k_x, k_y)}{|A(k_x, k_y)|^2 + \lambda^2 |\widehat{L}(k_x, k_y)|^2} \widehat{b}(k_x, k_y)
$$

其中 $A^*$ 是 $A$ 的[复共轭](@entry_id:174690)，$\widehat{L}$ 是算子 $\mathbf{L}$ 在傅里叶域中的符号（或称特征值）。这个滤波器 $W = \frac{A^*}{|A|^2 + \lambda^2 |\widehat{L}|^2}$ 就是Tikhonov滤波器。 对于倏逝波，$|A|^2 = |e^{-\alpha z_m}|^2 = e^{-2\alpha z_m}$，这个值随着 $k_t$ 增大而迅速趋于零。当 $|A|^2$ 远小于正则化项 $\lambda^2 |\widehat{L}|^2$ 时，滤波器将有效衰减该分量，从而抑制了噪声的指数放大。

根据算子 $\mathbf{L}$ 的选择，可以实现不同类型的正则化：

*   **零阶 Tikhonov 正则化**：选择 $\mathbf{L} = \mathbf{I}$ (单位算子)。此时 $|\widehat{L}|^2 = 1$。这种正则化惩罚的是解的总能量（$L_2$ 范数），对所有波数分量施加相同的惩罚。其滤波器形式为 $W_0 = \frac{A^*}{|A|^2 + \lambda^2}$。

*   **一阶 Tikhonov 正则化**：选择 $\mathbf{L} = \nabla_{\parallel} = (\frac{\partial}{\partial x}, \frac{\partial}{\partial y})$ (平面[梯度算子](@entry_id:1125719))。此时 $|\widehat{L}|^2 = k_x^2 + k_y^2 = k_t^2$。这种正则化惩罚的是解的梯度能量，即解的“粗糙度”。其滤波器形式为 $W_1 = \frac{A^*}{|A|^2 + \lambda^2 k_t^2}$。由于惩罚项随 $k_t^2$ 增长，一阶正则化对高频分量的压制作用比零阶更强，通常能产生更平滑的重构结果。

选择合适的[正则化参数](@entry_id:162917) $\lambda$ 和算子 $\mathbf{L}$ 是成功实施NAH的关键步骤，这通常需要根据[信噪比](@entry_id:271861)和对声源特性的先验知识来决定。

### 实际应用中的关键问题

从连续的数学理论到离散的计算机实现，还需要考虑几个关键的实际问题。

#### 空间[采样与[混](@entry_id:268188)叠](@entry_id:146322)

在实际测量中，声压是在一个离散的网格[上采样](@entry_id:275608)的，例如采样间隔为 $(\Delta x, \Delta y)$。根据**[奈奎斯特-香农采样定理](@entry_id:262499)**，为了无失真地表示信号，采样频率必须至少是信号最高频率的两倍。在[空间域](@entry_id:911295)，这意味着采样波数 $2\pi/\Delta x$ 必须大于信号中所包含的最大波数的两倍。

对于声场中的传播波，其最大横向波数为 $k$。因此，为避免传播波发生[混叠](@entry_id:146322)，采样间隔需满足 $\Delta x \le \pi/k = \lambda/2$（半波长采样准则）。 然而，NAH的目标是重构由倏逝波携带的亚波长信息，这些[倏逝波](@entry_id:156713)的波数 $k_t$ 可以远大于 $k$。如果采样间隔不够小，这些高频信息就会发生**[混叠](@entry_id:146322)（aliasing）**，即它们的[频谱](@entry_id:276824)会“折叠”到低频区域，与真实的低频信号相叠加，从而污染整个重构结果。

[混叠](@entry_id:146322)现象可以用[频谱](@entry_id:276824)的周期性来理解。对连续信号进行采样，其效果等同于在波[数域](@entry_id:155558)将原始[连续谱](@entry_id:155477)以 $2\pi/\Delta x$ 和 $2\pi/\Delta y$ 为周期进行复制。[离散傅里叶变换](@entry_id:144032)（DFT）只能观察到主周期（例如 $[-\pi/\Delta x, \pi/\Delta x)$）内的[频谱](@entry_id:276824)。一个真实波数为 $(k_x, k_y)$ 的平面波，在采样后其观测到的[混叠](@entry_id:146322)波数为：

$$
\kappa_{ax} = k_x - m_x \frac{2\pi}{\Delta x}
$$
$$
\kappa_{ay} = k_y - m_y \frac{2\pi}{\Delta y}
$$

其中整数 $(m_x, m_y)$ 是折叠指数，它们的值可以通过将 $(\kappa_{ax}, \kappa_{ay})$ 移入主周期来唯一确定。 例如，要计算折叠指数，我们可以考虑一个具体的案例：声速 $c=343\,\mathrm{m/s}$，频率 $f=5500\,\mathrm{Hz}$，[平面波](@entry_id:189798)[入射角](@entry_id:192705)由 $\sin\theta = 0.9$ 和 $\phi=30^\circ$ 定义，采样间隔为 $\Delta_x=0.10\,\mathrm{m}$ 和 $\Delta_y=0.08\,\mathrm{m}$。通过计算，真实的横向波数约为 $(k_x, k_y) \approx (78.5, 45.3) \, \mathrm{rad/m}$。而 $x$ 和 $y$ 方向的采样波数分别为 $2\pi/\Delta_x \approx 62.8 \, \mathrm{rad/m}$ 和 $2\pi/\Delta_y \approx 78.5 \, \mathrm{rad/m}$。由于 $k_x$ 和 $k_y$ 都超出了各自的奈奎斯特范围（$\pm \pi/\Delta_x$ 和 $\pm \pi/\Delta_y$），混叠必然发生。通过计算，可以确定折叠指数为 $(m_x, m_y)=(1, 1)$。 这意味着该平面波的能量将被错误地识别为一个具有不同方向和波长的波。因此，在NAH实践中，必须确保采样间隔足够小，以容纳所有希望通过正则化保留下来的倏逝波分量。

#### 有限[孔径](@entry_id:172936)与[窗函数](@entry_id:139733)

实际测量总是在一个**有限孔径（finite aperture）**上进行的，这等效于将无限大的真实声场乘以一个空间[窗函数](@entry_id:139733)（最简单的是[矩形窗](@entry_id:262826)）。根据傅里叶变换的[卷积定理](@entry_id:264711)，这会导致在波[数域](@entry_id:155558)中，真实的声场[角谱](@entry_id:184925)与窗函数的[角谱](@entry_id:184925)进行卷积。这个过程会引入两种效应：

1.  **分辨率下降**：窗函数[频谱](@entry_id:276824)的[主瓣宽度](@entry_id:275029)决定了波数分辨率。主瓣越宽，卷积后的[频谱](@entry_id:276824)就越模糊，这限制了区分相近[空间频率](@entry_id:270500)的能力，从而降低了重构图像的空间分辨率。

2.  **频谱泄漏（Spectral Leakage）**：窗函数[频谱](@entry_id:276824)的[旁瓣](@entry_id:270334)会将强信号（通常是低频的传播波）的能量“泄漏”到其他频率区域，特别是[信噪比](@entry_id:271861)很低的[倏逝波](@entry_id:156713)区域。

这些泄漏的能量在逆向传播中同样会被指数放大，产生严重的重构伪影。为了缓解频谱泄漏，通常会对测量数据应用一个边缘平滑的**[窗函数](@entry_id:139733)**，如 **汉宁窗（Hann window）** 或 **图基窗（Tukey window）**。

*   **[矩形窗](@entry_id:262826)**：提供最窄的主瓣（最高分辨率），但[旁瓣](@entry_id:270334)最高（第一[旁瓣](@entry_id:270334)约-13 dB），导致最严重的频谱泄漏。
*   **汉宁窗**：[主瓣宽度](@entry_id:275029)约为[矩形窗](@entry_id:262826)的两倍（分辨率降低），但[旁瓣](@entry_id:270334)极低（最高[旁瓣](@entry_id:270334)约-31 dB），能有效抑制频谱泄漏，提高重构的稳定性和鲁棒性。
*   **图基窗**：通过一个参数 $\alpha$ 在[矩形窗](@entry_id:262826)（$\alpha=0$）和汉宁窗（$\alpha=1$）之间进行插值，提供了一个在分辨率和泄漏抑制之间灵活权衡的工具。

选择合适的窗函数是在高分辨率和高稳定性这两个矛盾的需求之间进行权衡的重要环节。

### 替代理论视角与性能极限

#### Kirchhoff-Helmholtz 积分公式

虽然[角谱法](@entry_id:1121014)在计算上十分高效，但NAH的物理基础也可以通过[空间域](@entry_id:911295)的 **Kirchhoff-Helmholtz (KH) [积分定理](@entry_id:183680)**来理解。KH 定理表明，无源区域内任意点的声压可以由包围该区域的封闭边界面上的声压及其法向导数确定。

对于典型的NAH设置（在一个平面上测量，重构另一个平面），标准的KH积分公式需要同时知道测量面上的声压 $p$ 和法向[质点](@entry_id:186768)振速（与 $\partial p/\partial n$ 相关），这在很多应用中难以实现。幸运的是，通过引入特定的**[格林函数](@entry_id:147802)（Green's function）**，可以规避这一问题。具体来说，通过使用满足[狄利克雷边界条件](@entry_id:173524)（即在测量平面上值为零）的[半空间](@entry_id:634770)[格林函数](@entry_id:147802)，KH积分可以简化为仅包含声压 $p$ 的积分形式，即**瑞利[第一积分](@entry_id:261013)（Rayleigh I integral）**。

对于位于 $z=0$ 的平面，其推导出的积分核为：

$$
\frac{\partial G_D}{\partial n}(\mathbf{r},\mathbf{r}_0)=\frac{e^{ikR}}{2\pi}\,z_0\left(\frac{ik}{R^2}-\frac{1}{R^3}\right)
$$

其中 $R$ 是测量点与重构点之间的距离。这个积分在空间域中执行的卷积操作，与[角谱法](@entry_id:1121014)在波[数域](@entry_id:155558)中执行的乘法操作在数学上是等价的，两者共同构成了NAH的坚实理论基础。

#### 分辨率的根本极限

NAH的分辨率并非无限。它受到测量距离、[信噪比](@entry_id:271861)和物理定律的根本限制。[倏逝波](@entry_id:156713)携带的高频信息随距离指数衰减，当其振幅衰减到噪声水平以下时，信息就永久丢失了，无法通过任何后续处理来恢复。

我们可以量化这一极限。假设我们设定一个可接受的最低[信噪比](@entry_id:271861)阈值 $\Gamma$，那么可重构的最大横向波数 $k_c$（它决定了最高分辨率）就受到限制。对于从 $z=z_r$ 向 $z=0$ 的测量，可以推导出 $k_c$ 与测量距离 $z_r$ 和[信噪比](@entry_id:271861)的关系。一个更精确的模型表明，在倏逝波区域，可恢复的截止波数 $k_c$ 满足：

$$
k_c = \sqrt{k^2 + \left(\frac{1}{z_r}\ln\frac{S_0}{\sigma_n\sqrt{\Gamma}}\right)^2}
$$

其中 $S_0$ 是信号的特征振幅，$\sigma_n$ 是噪声的标准差。这个公式清晰地揭示了NAH的核心权衡：

*   **分辨率随测量距离的增加而降低**：$z_r$ 在分母中，说明测量平面离声源越远，可恢复的[倏逝波](@entry_id:156713)范围越小，分辨率越差。
*   **分辨率随[信噪比](@entry_id:271861)的提高而提高**：更高的[信噪比](@entry_id:271861)（更大的 $S_0/\sigma_n$）允许我们从噪声中“拯救”出更弱的[倏逝波](@entry_id:156713)分量，从而达到更高的分辨率。

这个关系为NAH系统的设计和实验参数的选择提供了重要的理论指导。