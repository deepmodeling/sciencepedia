{
    "hands_on_practices": [
        {
            "introduction": "This first exercise is foundational, guiding you through the implementation of the discrete angular spectrum operator from first principles. This operator is the computational engine for both forward and backward wave propagation in Near-field Acoustic Holography (NAH). This practice will solidify your understanding of how propagating and evanescent waves are handled numerically and reveal the inherent instability of back-propagation that necessitates regularization .",
            "id": "4130700",
            "problem": "Implement a discrete angular-spectrum propagation operator for Near-Field Acoustic Holography (NAH) within a two-dimensional spatial grid, starting from the frequency-domain linear acoustics model governed by the scalar Helmholtz equation. Assume a time-harmonic acoustic pressure field with angular frequency $\\omega$, wavenumber $k$, and sound speed $c$, so that the pressure field $p(x,y,z)$ satisfies the Helmholtz equation under the usual assumptions of linear acoustics in a homogeneous, lossless medium. Use the angular spectrum representation based on the two-dimensional spatial Fourier transform over $(x,y)$ to obtain a separable ordinary differential equation in $z$ for the modal content, and enforce the outgoing-wave (Sommerfeld radiation) condition to determine the correct branch for the longitudinal modal wavenumber. From this starting point, derive the discrete propagation operator on a Cartesian grid, with correct handling of both propagating components (where the transverse wavenumber magnitude is less than the acoustic wavenumber) and evanescent components (where the transverse wavenumber magnitude exceeds the acoustic wavenumber), using the appropriate complex-valued longitudinal wavenumber branch consistent with the radiation condition.\n\nYour program must implement the following in a self-contained way:\n\n- Use the fundamental base that the time-harmonic pressure $p(x,y,z)$ satisfies $(\\nabla^2 + k^2)p = 0$ with $k = \\omega/c = 2\\pi f/c$, where $f$ is the temporal frequency in hertz and $c$ is the speed of sound in meters per second. Apply a two-dimensional Fourier transform in $(x,y)$ to separate variables and deduce the ordinary differential equation for each spatial frequency mode along $z$. Do not assume any pre-derived propagation operator; derive it from these principles and enforce the physically correct branch using the radiation condition.\n- Discretize the spatial domain on a uniform grid of size $N_x \\times N_y$ with spacings $\\Delta x$ and $\\Delta y$ in meters. Form the corresponding discrete spatial frequency grids $k_x$ and $k_y$ (in radians per meter) using the standard discrete Fourier transform frequency conventions consistent with a $2\\pi$-periodic Fourier kernel in physical units.\n- Construct the complex-valued longitudinal wavenumber $k_z$ from $k$, $k_x$, and $k_y$, selecting the branch that yields decaying evanescent modes for forward propagation in $z$ and outgoing propagating modes, consistent with the radiation condition. Use this to build the forward operator $H_{\\mathrm{fwd}}(k_x,k_y;z)$ and the backward operator $H_{\\mathrm{back}}(k_x,k_y;z)$ for a propagation distance $z$ in meters. The forward operator propagates fields from $z=0$ to $z0$, and the backward operator back-propagates fields from $z0$ to $z=0$.\n- Implement a Gaussian taper regularization that acts only on evanescent content for the backward operator. Specifically, define $k_t=\\sqrt{k_x^2 + k_y^2}$ and a dimensionless regularization parameter $\\beta0$. Use a taper $W(k_t) = \\exp\\left(-\\left(\\max(0,k_t-k)/(\\beta k)\\right)^2\\right)$ so that $W(k_t)=1$ for $k_t \\le k$ and smoothly suppresses only evanescent components for $k_tk$. Define the regularized backward operator $H_{\\mathrm{back,reg}} = W \\cdot H_{\\mathrm{back}}$.\n- Numerically characterize the stability as $k_t$ approaches $k$ from below and above by computing the following four dimensionless metrics from the operators on the discrete grid:\n  $1)$ the maximum magnitude of the forward operator $\\max |H_{\\mathrm{fwd}}|$,\n  $2)$ the maximum magnitude of the backward operator $\\max |H_{\\mathrm{back}}|$,\n  $3)$ the maximum magnitude of the regularized backward operator $\\max |H_{\\mathrm{back,reg}}|$,\n  $4)$ the minimum normalized longitudinal wavenumber among propagating modes, $\\min_{k_t \\le k} |k_z|/k$.\n- All quantities involving distances must be expressed in meters, all frequencies in hertz, and all speeds in meters per second. The requested outputs are dimensionless.\n\nUse the following test suite of parameter sets to exercise different regimes, including a general case, a near-grazing boundary condition where $k_t$ approaches $k$, and a longer-distance back-propagation edge case. For each case, use the given values for $(N_x,N_y,\\Delta x,\\Delta y,f,c,z,\\beta)$:\n\n- Case A (happy path with substantial evanescent content but moderate back-propagation distance): $N_x = 128$, $N_y = 128$, $\\Delta x = 8\\times 10^{-3}$ meters, $\\Delta y = 8\\times 10^{-3}$ meters, $f = 3000$ hertz, $c = 343$ meters per second, $z = 5\\times 10^{-2}$ meters, $\\beta = 0.25$.\n- Case B (near-grazing sampling where the maximum transverse wavenumber is close to $k$): $N_x = 128$, $N_y = 128$, $\\Delta x = 5.5\\times 10^{-2}$ meters, $\\Delta y = 5.5\\times 10^{-2}$ meters, $f = 3000$ hertz, $c = 343$ meters per second, $z = 1\\times 10^{-1}$ meters, $\\beta = 0.25$.\n- Case C (strong back-propagation amplification without and with regularization): $N_x = 128$, $N_y = 128$, $\\Delta x = 8\\times 10^{-3}$ meters, $\\Delta y = 8\\times 10^{-3}$ meters, $f = 3000$ hertz, $c = 343$ meters per second, $z = 2\\times 10^{-1}$ meters, $\\beta = 0.25$.\n\nFor each case, compute the four metrics listed above in the order $[\\max |H_{\\mathrm{fwd}}|,\\ \\max |H_{\\mathrm{back}}|,\\ \\max |H_{\\mathrm{back,reg}}|,\\ \\min_{k_t \\le k} |k_z|/k]$. Your program should produce a single line of output containing the results for all three cases as a comma-separated list of the three per-case lists, enclosed in square brackets, for example, $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]$. The outputs must be floating-point numbers. No additional text should be printed.",
            "solution": "The problem statement is scientifically sound, well-posed, and provides all necessary information to derive and implement the discrete angular-spectrum propagation operator for near-field acoustic holography. The underlying model is the scalar Helmholtz equation, a cornerstone of linear acoustics. The requested derivation follows a standard and physically correct procedure involving the spatial Fourier transform and the application of the Sommerfeld radiation condition. The parameters for the test cases are physically realistic and chosen to highlight key behaviors of the propagation operators, such as the instability of back-propagation and the effect of regularization. The problem is therefore deemed valid.\n\nThe derivation and implementation proceed as follows.\n\nThe acoustic pressure field $p(x,y,z)$ for a time-harmonic wave with angular frequency $\\omega$ in a homogeneous, lossless medium is governed by the scalar Helmholtz equation:\n$$ (\\nabla^2 + k^2)p(x,y,z) = 0 $$\nwhere $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$ is the Laplacian operator and $k = \\omega/c = 2\\pi f/c$ is the acoustic wavenumber, with $f$ being the temporal frequency and $c$ the speed of sound.\n\nTo solve this partial differential equation using the angular spectrum method, we apply a two-dimensional spatial Fourier transform with respect to the transverse coordinates $(x,y)$. The transform pair is defined as:\n$$ P(k_x, k_y, z) = \\mathcal{F}_{xy}\\{p(x,y,z)\\} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} p(x,y,z) e^{-i(k_x x + k_y y)} dx dy $$\n$$ p(x,y,z) = \\frac{1}{(2\\pi)^2} \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} P(k_x, k_y, z) e^{i(k_x x + k_y y)} dk_x dk_y $$\nHere, $P(k_x, k_y, z)$ is the angular spectrum of the pressure field, representing the amplitude of the plane wave component with transverse wavevector $(k_x, k_y)$. Applying this transform to the Helmholtz equation term by term, and using the differentiation property of Fourier transforms, $\\mathcal{F}\\{\\frac{\\partial^n f}{\\partial x^n}\\} = (ik_x)^n \\mathcal{F}\\{f\\}$, we obtain:\n$$ (-k_x^2 - k_y^2 + \\frac{d^2}{dz^2} + k^2) P(k_x, k_y, z) = 0 $$\nLetting $k_t = \\sqrt{k_x^2 + k_y^2}$ be the magnitude of the transverse wavevector, the equation simplifies to a second-order ordinary differential equation in $z$ for each spatial frequency component $(k_x, k_y)$:\n$$ \\frac{d^2P}{dz^2} + (k^2 - k_t^2)P = 0 $$\nDefining the longitudinal wavenumber $k_z$ as $k_z^2 = k^2 - k_t^2$, the equation becomes:\n$$ \\frac{d^2P}{dz^2} + k_z^2 P = 0 $$\nThe general solution to this ODE is $P(z) = A e^{ik_z z} + B e^{-ik_z z}$. To determine the coefficients $A$ and $B$, we enforce the Sommerfeld radiation condition, which dictates that for a source-free region $z0$, waves must either propagate away from the source plane (assumed at $z=0$) or decay to zero as $z \\to \\infty$. Assuming a time-dependence of $e^{-i\\omega t}$, a wave propagating in the $+z$ direction has the form $e^{i(k_z z - \\omega t)}$. Thus, we must select the $e^{ik_z z}$ term, which implies $B=0$. The value of $A$ is determined by the field at $z=0$, giving $A = P(k_x,k_y,0)$. The solution is therefore:\n$$ P(k_x,k_y,z) = P(k_x,k_y,0) e^{ik_z z} $$\nThe correct branch for $k_z = \\sqrt{k^2 - k_t^2}$ must be chosen to satisfy the radiation condition:\n$1$. For propagating waves ($k_t^2 \\le k^2$), $k_z$ is real. We choose the positive root, $k_z = \\sqrt{k^2 - k_t^2}$, corresponding to forward propagation.\n$2$. For evanescent waves ($k_t^2  k^2$), $k_z$ is imaginary. We must choose the root with a positive imaginary part, $k_z = i\\sqrt{k_t^2 - k^2}$, so that $e^{ik_z z} = e^{-\\sqrt{k_t^2-k^2}z}$ represents a decaying field as $z$ increases.\nBoth conditions are satisfied by selecting the root of $k^2 - k_t^2$ that has a non-negative real and imaginary part.\n\nThe forward propagation operator $H_{\\mathrm{fwd}}$ that propagates the field from a plane at $z_0=0$ to a plane at $z0$ is given by:\n$$ H_{\\mathrm{fwd}}(k_x,k_y; z) = e^{ik_z z} $$\nThe backward propagation operator $H_{\\mathrm{back}}$, which reconstructs the field at $z=0$ from the field at $z0$, is the inverse of the forward operator:\n$$ H_{\\mathrm{back}}(k_x,k_y; z) = \\frac{1}{H_{\\mathrm{fwd}}(k_x,k_y; z)} = e^{-ik_z z} $$\nThe magnitude of the forward operator is $|H_{\\mathrm{fwd}}| = |e^{ik_z z}|$. For propagating waves, $k_z$ is real and $|H_{\\mathrm{fwd}}|=1$. For evanescent waves, $k_z$ is imaginary and $|H_{\\mathrm{fwd}}| = e^{-\\text{Im}(k_z)z}  1$. Thus, forward propagation is a stable process.\nConversely, the magnitude of the backward operator is $|H_{\\mathrm{back}}| = |e^{-ik_z z}|$. For propagating waves, $|H_{\\mathrm{back}}|=1$. For evanescent waves, $|H_{\\mathrm{back}}| = e^{\\text{Im}(k_z)z}  1$. This exponential amplification of high-frequency components (large $k_t$) makes the backward propagation an ill-posed inverse problem, highly sensitive to noise.\n\nTo stabilize the backward propagation, a regularization taper $W$ is applied. The problem specifies a Gaussian taper that acts only on the evanescent content ($k_t  k$):\n$$ W(k_t) = \\exp\\left(-\\left(\\frac{\\max(0, k_t - k)}{\\beta k}\\right)^2\\right) $$\nwhere $\\beta  0$ is a dimensionless parameter controlling the taper width. The regularized backward operator is then:\n$$ H_{\\mathrm{back,reg}} = W \\cdot H_{\\mathrm{back}} $$\nThis taper smoothly suppresses the amplification of evanescent waves, making the reconstruction process more robust.\n\nOn a discrete grid of size $N_x \\times N_y$ with spacings $\\Delta x$ and $\\Delta y$, the continuous wavenumbers $(k_x, k_y)$ are replaced by their discrete counterparts, obtained from the Discrete Fourier Transform (DFT) frequency conventions:\n$$ k_{x,n} = \\frac{2\\pi n}{N_x \\Delta x}, \\quad k_{y,m} = \\frac{2\\pi m}{N_y \\Delta y} $$\nwhere $n$ and $m$ are integer indices corresponding to the DFT bins.\n\nThe required metrics are then computed on this discrete grid:\n$1$. $\\max |H_{\\mathrm{fwd}}|$: The maximum magnitude of the forward operator. Theoretically, this should be $1$.\n$2$. $\\max |H_{\\mathrm{back}}|$: The maximum magnitude of the unstable backward operator, which measures the worst-case amplification.\n$3$. $\\max |H_{\\mathrm{back,reg}}|$: The maximum magnitude of the regularized backward operator, quantifying the stability achieved by regularization.\n$4$. $\\min_{k_t \\le k} |k_z|/k$: The minimum normalized longitudinal wavenumber for propagating modes. This metric approaches $0$ as the highest-frequency propagating mode on the grid gets closer to the $k_t=k$ boundary, which occurs in \"grazing\" conditions.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and analyzes the discrete angular-spectrum propagation operator\n    for Near-Field Acoustic Holography (NAH).\n    \"\"\"\n\n    test_cases = [\n        # Case A: Happy path with significant evanescent content\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 8e-3, \"dy\": 8e-3, \n            \"f\": 3000, \"c\": 343, \"z\": 5e-2, \"beta\": 0.25\n        },\n        # Case B: Near-grazing sampling condition\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 5.5e-2, \"dy\": 5.5e-2, \n            \"f\": 3000, \"c\": 343, \"z\": 1e-1, \"beta\": 0.25\n        },\n        # Case C: Strong back-propagation amplification\n        {\n            \"Nx\": 128, \"Ny\": 128, \"dx\": 8e-3, \"dy\": 8e-3, \n            \"f\": 3000, \"c\": 343, \"z\": 2e-1, \"beta\": 0.25\n        },\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        Nx = params[\"Nx\"]\n        Ny = params[\"Ny\"]\n        dx = params[\"dx\"]\n        dy = params[\"dy\"]\n        f = params[\"f\"]\n        c = params[\"c\"]\n        z = params[\"z\"]\n        beta = params[\"beta\"]\n\n        # 1. Calculate acoustic wavenumber k\n        k = 2 * np.pi * f / c\n\n        # 2. Create discrete spatial frequency grids (kx, ky) in rad/m\n        kx_vec = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n        ky_vec = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n        kx, ky = np.meshgrid(kx_vec, ky_vec, indexing='ij')\n\n        # 3. Calculate transverse wavenumber grid kt\n        kt_squared = kx**2 + ky**2\n        kt = np.sqrt(kt_squared)\n\n        # 4. Calculate longitudinal wavenumber kz, ensuring correct physical branch\n        # This implementation robustly handles propagating and evanescent modes.\n        kz = np.zeros_like(kt, dtype=np.complex128)\n        \n        # Propagating modes: kt^2 = k^2\n        propagating_mask = kt_squared = k**2\n        kz[propagating_mask] = np.sqrt(k**2 - kt_squared[propagating_mask])\n\n        # Evanescent modes: kt^2  k^2\n        evanescent_mask = ~propagating_mask\n        kz[evanescent_mask] = 1j * np.sqrt(kt_squared[evanescent_mask] - k**2)\n\n        # 5. Construct propagation operators\n        # Forward operator H_fwd\n        H_fwd = np.exp(1j * kz * z)\n        \n        # Backward operator H_back\n        H_back = np.exp(-1j * kz * z)\n\n        # 6. Construct regularized backward operator H_back_reg\n        # Gaussian taper W(kt)\n        taper_arg = np.maximum(0, kt - k) / (beta * k)\n        W = np.exp(-(taper_arg**2))\n        \n        H_back_reg = W * H_back\n\n        # 7. Compute the four dimensionless metrics\n        \n        # Metric 1: Maximum magnitude of the forward operator\n        max_abs_H_fwd = np.max(np.abs(H_fwd))\n\n        # Metric 2: Maximum magnitude of the backward operator\n        max_abs_H_back = np.max(np.abs(H_back))\n        \n        # Metric 3: Maximum magnitude of the regularized backward operator\n        max_abs_H_back_reg = np.max(np.abs(H_back_reg))\n\n        # Metric 4: Minimum normalized longitudinal wavenumber among propagating modes\n        kz_propagating = kz[propagating_mask]\n        if kz_propagating.size  0:\n            # np.abs is used for safety, though these kz values should be real\n            min_norm_kz = np.min(np.abs(kz_propagating)) / k\n        else:\n            # This case should not happen as (kx,ky)=(0,0) is always propagating\n            min_norm_kz = 0.0\n\n        case_results = [\n            max_abs_H_fwd,\n            max_abs_H_back,\n            max_abs_H_back_reg,\n            min_norm_kz\n        ]\n        results.append(case_results)\n\n    # Format the final output string as specified in the problem\n    case_results_str = []\n    for r in results:\n        # Format each list of floats into a string \"[f1,f2,f3,f4]\"\n        case_results_str.append(f\"[{','.join(map(str, r))}]\")\n    \n    # Join the case strings into the final format \"[[...],[...],[...]]\"\n    final_output_str = f\"[{','.join(case_results_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Having implemented the propagator, we can now ask a critical question: what is the smallest detail we can resolve on the source plane? This problem guides you to derive a Rayleigh-type resolution criterion for NAH, linking the achievable resolution to the system's effective wavenumber bandwidth. You will discover how this bandwidth is determined not only by hardware constraints but, more fundamentally, by the measurement noise that limits our ability to reconstruct high-frequency evanescent waves .",
            "id": "4130738",
            "problem": "A planar microphone array at $z=0$ measures the complex acoustic pressure field $p(x,0)$ radiated by a distribution of sources located on the plane $z=-z_{0}$ in a homogeneous, lossless medium of sound speed $c$. The field satisfies the scalar Helmholtz equation $\\nabla^{2}p + k^{2}p = 0$, where $k = \\omega/c$ is the acoustic wavenumber. Near-field Acoustic Holography (NAH) reconstructs the source-plane field $p(x,-z_{0})$ by spatial Fourier transformation in the transverse coordinate $x$, and back-propagation by the plane-wave factor $\\exp(i k_{z} z)$ with $k_{z} = \\sqrt{k^{2} - k_{x}^{2}}$. For $|k_{x}| \\leq k$, $k_{z}$ is real (propagating components). For $|k_{x}|  k$, $k_{z} = i \\alpha$ with $\\alpha = \\sqrt{k_{x}^{2} - k^{2}}$ (evanescent components).\n\nAssume the reconstruction employs a rectangular low-pass in the transverse wavenumber domain, limited by a hardware/processing bandwidth $K_{B}$ (i.e., $|k_{x}| \\leq K_{B}$ are retained), and applies truncated inverse back-propagation that discards evanescent components whose inverse filter magnitude would exceed a dimensionless noise threshold specified by a global measurement signal-to-noise ratio $S_{0}  1$. That is, evanescent components with inverse gain $\\exp(\\alpha z_{0})  S_{0}$ are rejected. Consider two equal-strength, in-phase line sources separated by a distance $\\Delta x$ along $x$ on the source plane $z=-z_{0}$.\n\nStarting from the Helmholtz equation and the plane-wave representation, and treating the reconstruction as a band-limited, shift-invariant system along $x$ whose point-spread function is the inverse Fourier transform of the retained transverse spectrum, do the following:\n\n- Define a Rayleigh-type resolution criterion along $x$ for NAH at depth $z_{0}$ by requiring that the minimal resolvable separation $\\Delta x_{R}(z_{0})$ is the smallest $\\Delta x$ such that the central maximum of one reconstructed point-spread function coincides with the first zero of the other.\n- Derive how $\\Delta x_{R}(z_{0})$ depends jointly on the retained transverse wavenumber bandwidth and the noise-driven truncation described above.\n\nExpress your final resolution $\\Delta x_{R}(z_{0})$ as a closed-form analytic expression in meters, in terms of $k$, $z_{0}$, $K_{B}$, and $S_{0}$. No numerical values are to be substituted and no rounding is required. The final answer must be a single analytic expression.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- Governing equation: Helmholtz equation, $\\nabla^{2}p + k^{2}p = 0$.\n- Acoustic wavenumber: $k = \\omega/c$.\n- Source-plane location: $z = -z_{0}$.\n- Measurement-plane location: $z = 0$.\n- Transverse coordinate: $x$.\n- Wavenumber-domain relationship for forward propagation: $P(k_x, z_2) = P(k_x, z_1) \\exp(ik_z(z_2-z_1))$.\n- Definition of transverse wavenumber $k_z$:\n  - For propagating waves ($|k_x| \\leq k$): $k_z = \\sqrt{k^2 - k_x^2}$.\n  - For evanescent waves ($|k_x|  k$): $k_z = i\\alpha$, with $\\alpha = \\sqrt{k_x^2 - k^2}$.\n- Reconstruction constraint 1 (Hardware Bandwidth): A rectangular low-pass filter in the $k_x$ domain retains only components where $|k_x| \\leq K_B$.\n- Reconstruction constraint 2 (Noise Truncation): Evanescent components are rejected if their inverse filter gain, $\\exp(\\alpha z_{0})$, exceeds a signal-to-noise ratio threshold, $S_{0}  1$.\n- Resolution Criterion: The Rayleigh-type resolution $\\Delta x_{R}(z_{0})$ is the distance from the central maximum of a reconstructed point-spread function to its first zero.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the principles of wave propagation, Fourier acoustics, and inverse problem theory, which are central to near-field acoustic holography (NAH). The Helmholtz equation and the plane-wave expansion are standard models. The specified constraints, a hardware bandwidth limit and a noise-based regularization for evanescent waves, represent a realistic, albeit simplified, model of a practical NAH system. The ill-posed nature of reconstructing evanescent waves (exponential amplification of noise) is correctly identified, and the truncation based on a signal-to-noise ratio $S_0$ is a standard form of regularization. The problem is objective, well-posed, and all terms are clearly defined, enabling a unique, analytical solution. No scientific flaws, contradictions, or ambiguities are present.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation of the Resolution**\n\nThe reconstruction of the acoustic field at the source plane $z=-z_0$ from measurements at the plane $z=0$ is an inverse problem. Let $p(x,z)$ be the complex pressure field and $P(k_x,z)$ be its spatial Fourier transform with respect to the transverse coordinate $x$. The relationship between the fields at the source and measurement planes in the Fourier domain is given by the propagator:\n$$ P(k_x, 0) = P(k_x, -z_0) \\exp(ik_z z_0) $$\nThe reconstruction process seeks to compute an estimate of $P(k_x, -z_0)$ from the measured $P(k_x, 0)$. This involves applying an inverse filter, which ideally is $H_{ideal}(k_x) = \\exp(-ik_z z_0)$.\n\nThe problem states that the reconstruction is a linear, shift-invariant (LSI) system. The overall behavior of this system is described by its transfer function, $H(k_x)$, which dictates which spatial frequency components are retained. A component $k_x$ is retained if it satisfies all specified constraints. The transfer function $H(k_x)$ will be $1$ for retained components and $0$ for rejected components.\n\nLet us analyze the constraints on the retained wavenumbers $k_x$.\n1.  **Hardware Bandwidth Limit**: The reconstruction is band-limited by a maximum transverse wavenumber $K_B$, such that only components with $|k_x| \\leq K_B$ are processed.\n2.  **Noise-Driven Truncation**: This constraint applies to evanescent waves, for which $|k_x|k$ and $k_z = i\\alpha = i\\sqrt{k_x^2-k^2}$. The inverse filter for these components has a gain (magnitude) of $|\\exp(-ik_z z_0)| = |\\exp(-i(i\\alpha)z_0)| = \\exp(\\alpha z_0)$. The problem states that components are rejected if this gain is greater than $S_0$. Therefore, evanescent components are retained only if:\n    $$ \\exp(\\alpha z_0) \\leq S_0 $$\n    Substituting $\\alpha = \\sqrt{k_x^2 - k^2}$, we get:\n    $$ \\exp\\left(z_0 \\sqrt{k_x^2 - k^2}\\right) \\leq S_0 $$\n    Taking the natural logarithm of both sides (since $S_0  1$, $\\ln(S_0)  0$):\n    $$ z_0 \\sqrt{k_x^2 - k^2} \\leq \\ln(S_0) $$\n    $$ \\sqrt{k_x^2 - k^2} \\leq \\frac{\\ln(S_0)}{z_0} $$\n    Squaring both sides and rearranging gives the condition on $k_x^2$:\n    $$ k_x^2 - k^2 \\leq \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2 $$\n    $$ k_x^2 \\leq k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2 $$\n    This implies an upper limit on the magnitude of the transverse wavenumber due to noise:\n    $$ |k_x| \\leq \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2} $$\n    Let us define this noise-imposed cutoff wavenumber as $K_{noise} = \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}$.\n\nThe reconstruction system retains a spatial frequency component $k_x$ only if it satisfies *both* the hardware and noise constraints. This means the effective passband is the intersection of the two regions. The maximum retained transverse wavenumber, $K_{eff}$, is therefore the minimum of the two individual cutoff wavenumbers:\n$$ K_{eff} = \\min\\left(K_B, K_{noise}\\right) = \\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right) $$\nThe transfer function of the LSI reconstruction system is a rectangular window in the wavenumber domain:\n$$ H(k_x) = \\begin{cases} 1  \\text{if } |k_x| \\leq K_{eff} \\\\ 0  \\text{if } |k_x|  K_{eff} \\end{cases} $$\nThe point-spread function (PSF) of the system, $h(x)$, is the inverse Fourier transform of its transfer function $H(k_x)$. For a one-dimensional system, the inverse Fourier transform is defined as:\n$$ h(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} H(k_x) e^{ik_x x} dk_x $$\nSubstituting the expression for $H(k_x)$:\n$$ h(x) = \\frac{1}{2\\pi} \\int_{-K_{eff}}^{K_{eff}} (1) \\cdot e^{ik_x x} dk_x $$\nEvaluating the integral:\n$$ h(x) = \\frac{1}{2\\pi} \\left[ \\frac{e^{ik_x x}}{ix} \\right]_{-K_{eff}}^{K_{eff}} = \\frac{1}{2\\pi ix} \\left( e^{iK_{eff}x} - e^{-iK_{eff}x} \\right) $$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2i}$, we can simplify this to:\n$$ h(x) = \\frac{1}{2\\pi ix} \\left( 2i\\sin\\left(K_{eff}x\\right) \\right) = \\frac{\\sin(K_{eff}x)}{\\pi x} $$\nThis expression is a scaled sinc function. Its central maximum is at $x=0$.\n\nAccording to the Rayleigh-type resolution criterion defined in the problem, the minimal resolvable separation $\\Delta x_R(z_0)$ is the distance from the central maximum of the PSF to its first zero. The zeros of $h(x)$ occur when the numerator is zero, provided the denominator is non-zero (i.e., $x \\neq 0$).\n$$ \\sin(K_{eff}x) = 0 $$\nThis condition is met when $K_{eff}x = n\\pi$ for any non-zero integer $n$. The first zero corresponds to $n=1$ (or $n=-1$), which gives:\n$$ K_{eff}|x| = \\pi $$\nThe distance to this first zero is $|x| = \\frac{\\pi}{K_{eff}}$. By definition, this is the resolution limit.\n$$ \\Delta x_R(z_0) = \\frac{\\pi}{K_{eff}} $$\nSubstituting the expression for $K_{eff}$:\n$$ \\Delta x_R(z_0) = \\frac{\\pi}{\\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right)} $$\nThis is the final analytical expression for the resolution, showing its joint dependence on the hardware bandwidth $K_B$ and the noise-driven truncation, which itself depends on $k$, $z_0$, and $S_0$. The resolution is limited by whichever constraint is more restrictive (i.e., whichever gives a smaller cutoff wavenumber).",
            "answer": "$$ \\boxed{\\frac{\\pi}{\\min\\left(K_B, \\sqrt{k^2 + \\left(\\frac{\\ln(S_0)}{z_0}\\right)^2}\\right)}} $$"
        },
        {
            "introduction": "Simple spectral truncation is a common method for regularizing the NAH inverse problem, but can we do better? This final practice introduces a statistical approach by guiding you through the derivation of an optimal reconstruction filter, a form of the celebrated Wiener filter. You will determine the ideal wavenumber-domain taper that minimizes the mean squared error by optimally balancing the estimated source signal against corrupting measurement noise, offering a more refined solution to the ill-posed nature of NAH .",
            "id": "4130698",
            "problem": "Consider a two-dimensional planar Near-field Acoustic Holography (NAH) experiment at a single angular frequency $\\omega$, with acoustic wavenumber $k = \\omega/c$, where $c$ is the speed of sound. A linear microphone array lies in the measurement plane $z = z_{m}  0$ and records a pressure field $p_{m}(x)$ along the $x$-axis. The goal is to reconstruct the complex acoustic pressure field $p_{s}(x)$ on the source plane $z = 0$ from $p_{m}(x)$ using a wavenumber-domain method that applies back-propagation followed by a spatial taper within a prescribed target bandwidth.\n\nAssume the following data model and simplifications, all of which are standard in computational acoustics:\n- The measurement is corrupted by additive noise: $p_{m}(x) = p_{\\text{true}}(x) + n(x)$, where $n(x)$ is a zero-mean, wide-sense stationary process with flat one-sided power spectral density (PSD) $S_{n}$ along $x$.\n- The true source-plane field $p_{s}(x)$ is a zero-mean, wide-sense stationary process that is spectrally band-limited along $x$ to the target wavenumber band $\\mathcal{B} = \\{k_{x}: |k_{x}| \\leq K_{t}\\}$, with constant PSD $S_{s}$ on $\\mathcal{B}$ and negligible energy outside $\\mathcal{B}$.\n- In the spatial Fourier domain, the measurement spectrum $P_{m}(k_{x})$ and the source spectrum $P_{s}(k_{x})$ are related by a multiplicative propagation factor $P(k_{x})$ so that $P_{m}(k_{x}) = P(k_{x}) P_{s}(k_{x}) + N(k_{x})$, where $N(k_{x})$ is the Fourier transform of $n(x)$.\n- The back-propagation operator is the inverse factor $P(k_{x})^{-1}$ applied to $P_{m}(k_{x})$ within the band $\\mathcal{B}$. Assume the target band $\\mathcal{B}$ is sufficiently narrow that both the source PSD $S_{s}$ and the magnitude of the inverse propagation factor $|P(k_{x})|^{-1}$ can be treated as constants across $\\mathcal{B}$. Denote this approximately constant magnitude by $G  0$, i.e., $|P(k_{x})|^{-1} \\approx G$ for $k_{x} \\in \\mathcal{B}$.\n- The reconstruction applies a constant spatial taper (gain) $a \\in \\mathbb{R}$ within $\\mathcal{B}$ and rejects all content outside $\\mathcal{B}$. That is, the estimator in wavenumber domain is $\\widehat{P}_{s}(k_{x}) = a\\, P(k_{x})^{-1} P_{m}(k_{x})$ for $k_{x} \\in \\mathcal{B}$ and $\\widehat{P}_{s}(k_{x}) = 0$ otherwise.\n\nDefine the mean squared reconstruction error integrated over the target band $\\mathcal{B}$ as\n$$\n\\mathcal{E}(a) = \\int_{-K_{t}}^{K_{t}} \\mathbb{E}\\!\\left[\\,|\\widehat{P}_{s}(k_{x}) - P_{s}(k_{x})|^{2}\\,\\right] \\, \\mathrm{d}k_{x}.\n$$\nUsing only the assumptions stated above and first principles for linear estimation of wide-sense stationary fields in the Fourier domain, derive the value of the constant taper $a$ that minimizes $\\mathcal{E}(a)$. Express your final answer as a closed-form analytic expression in terms of $S_{s}$, $S_{n}$, and $G$. The final answer must be a single analytical expression. No numerical evaluation is required. If you introduce any intermediary quantities, eliminate them in the final expression so that only $S_{s}$, $S_{n}$, and $G$ remain.",
            "solution": "The problem asks for the value of a constant taper, denoted by $a$, that minimizes the mean squared reconstruction error $\\mathcal{E}(a)$ for an acoustic pressure field in a Near-field Acoustic Holography (NAH) setup. The error is defined as the integral of the pointwise mean squared error over a specified wavenumber band $\\mathcal{B} = \\{k_{x}: |k_{x}| \\leq K_{t}\\}$.\n\nThe given mean squared reconstruction error is:\n$$\n\\mathcal{E}(a) = \\int_{-K_{t}}^{K_{t}} \\mathbb{E}\\!\\left[\\,|\\widehat{P}_{s}(k_{x}) - P_{s}(k_{x})|^{2}\\,\\right] \\, \\mathrm{d}k_{x}\n$$\nHere, $\\widehat{P}_{s}(k_{x})$ is the estimator for the source spectrum $P_s(k_x)$, and $\\mathbb{E}[\\cdot]$ denotes the expectation operator.\n\nFor wavenumbers $k_x$ within the target band $\\mathcal{B}$, the estimator is given by:\n$$\n\\widehat{P}_{s}(k_{x}) = a\\, P(k_{x})^{-1} P_{m}(k_{x})\n$$\nThe measured spectrum $P_m(k_x)$ is related to the true source spectrum $P_s(k_x)$ and the noise spectrum $N(k_x)$ by:\n$$\nP_{m}(k_{x}) = P(k_{x}) P_{s}(k_{x}) + N(k_{x})\n$$\nSubstituting this into the estimator expression, we get:\n$$\n\\widehat{P}_{s}(k_{x}) = a\\, P(k_{x})^{-1} \\left( P(k_{x}) P_{s}(k_{x}) + N(k_{x}) \\right) = a P_{s}(k_{x}) + a P(k_{x})^{-1} N(k_{x})\n$$\nThe error term in the integrand, $\\widehat{P}_{s}(k_{x}) - P_{s}(k_{x})$, can now be written as:\n$$\n\\widehat{P}_{s}(k_{x}) - P_{s}(k_{x}) = (a P_{s}(k_{x}) + a P(k_{x})^{-1} N(k_{x})) - P_{s}(k_{x}) = (a-1)P_{s}(k_{x}) + a P(k_{x})^{-1} N(k_{x})\n$$\nNext, we compute the squared magnitude of this error term:\n$$\n|\\widehat{P}_{s}(k_{x}) - P_{s}(k_{x})|^{2} = \\left| (a-1)P_{s}(k_{x}) + a P(k_{x})^{-1} N(k_{x}) \\right|^{2}\n$$\nExpanding this, we have:\n$$\n|\\widehat{P}_{s}(k_{x}) - P_{s}(k_{x})|^{2} = (a-1)^{2}|P_{s}(k_{x})|^{2} + a^{2}|P(k_{x})^{-1}|^{2}|N(k_{x})|^{2} + 2\\text{Re}\\left\\{ (a-1)a P_{s}(k_{x}) (P(k_{x})^{-1})^{*} N(k_{x})^{*} \\right\\}\n$$\nwhere `*` denotes the complex conjugate.\n\nWe now take the expectation of this expression. The problem states that the source field $p_s(x)$ and the noise field $n(x)$ are zero-mean wide-sense stationary (WSS) processes. It's also stated that the measurement noise is additive, which implies the noise is independent of the source signal. Consequently, their Fourier transforms, $P_s(k_x)$ and $N(k_x)$, are uncorrelated. For zero-mean uncorrelated random variables, the expectation of their product is zero:\n$$\n\\mathbb{E}\\left[ P_{s}(k_{x}) N(k_{x})^{*} \\right] = 0\n$$\nThis causes the expectation of the cross-term to vanish. The expectation of the squared magnitude then becomes:\n$$\n\\mathbb{E}\\left[|\\widehat{P}_{s}(k_{x}) - P_{s}(k_{x})|^{2}\\right] = (a-1)^{2} \\mathbb{E}\\left[|P_{s}(k_{x})|^{2}\\right] + a^{2}|P(k_{x})^{-1}|^{2} \\mathbb{E}\\left[|N(k_{x})|^{2}\\right]\n$$\nFor WSS processes, the expectation of the squared magnitude of the Fourier transform is the two-sided Power Spectral Density (PSD). Let $S_{p_s}(k_x)$ be the PSD of the source and $S_{nn}(k_x)$ be the PSD of the noise.\n$$\n\\mathbb{E}\\left[|P_{s}(k_{x})|^{2}\\right] = S_{p_s}(k_x)\n$$\n$$\n\\mathbb{E}\\left[|N(k_{x})|^{2}\\right] = S_{nn}(k_x)\n$$\nAccording to the problem statement, for $k_x \\in \\mathcal{B}$:\n- The source PSD is constant: $S_{p_s}(k_x) = S_s$.\n- The noise PSD is constant: $S_{nn}(k_x) = S_n$.\n- The magnitude of the inverse propagator is approximately constant: $|P(k_{x})^{-1}| \\approx G$.\n\nSubstituting these constants into the expression for the expected squared error at a given $k_x$:\n$$\n\\mathbb{E}\\left[|\\widehat{P}_{s}(k_{x}) - P_{s}(k_{x})|^{2}\\right] \\approx (a-1)^{2} S_{s} + a^{2} G^{2} S_{n} \\quad \\text{for } k_x \\in \\mathcal{B}\n$$\nThe total integrated error $\\mathcal{E}(a)$ is found by integrating this expression from $-K_t$ to $K_t$. Since the integrand is constant with respect to $k_x$ over this interval, the integration is straightforward:\n$$\n\\mathcal{E}(a) = \\int_{-K_{t}}^{K_{t}} \\left( (a-1)^{2} S_{s} + a^{2} G^{2} S_{n} \\right) \\mathrm{d}k_{x} = \\left( (a-1)^{2} S_{s} + a^{2} G^{2} S_{n} \\right) \\int_{-K_{t}}^{K_{t}} \\mathrm{d}k_{x}\n$$\n$$\n\\mathcal{E}(a) = 2K_{t} \\left( (a-1)^{2} S_{s} + a^{2} G^{2} S_{n} \\right)\n$$\nTo find the value of $a$ that minimizes $\\mathcal{E}(a)$, we can minimize the function $f(a) = (a-1)^{2} S_{s} + a^{2} G^{2} S_{n}$, as $2K_{t}$ is a positive constant. We find the stationary point by taking the derivative of $f(a)$ with respect to $a$ and setting it to zero.\n$$\n\\frac{\\mathrm{d}f}{\\mathrm{d}a} = \\frac{\\mathrm{d}}{\\mathrm{d}a} \\left[ (a^{2}-2a+1)S_{s} + a^{2}G^{2}S_{n} \\right] = (2a-2)S_{s} + 2aG^{2}S_{n}\n$$\nSetting the derivative to zero:\n$$\n2(a-1)S_{s} + 2aG^{2}S_{n} = 0\n$$\n$$\na S_{s} - S_{s} + a G^{2}S_{n} = 0\n$$\n$$\na (S_{s} + G^{2}S_{n}) = S_{s}\n$$\nSolving for $a$:\n$$\na = \\frac{S_{s}}{S_{s} + G^{2}S_{n}}\n$$\nTo confirm this is a minimum, we check the second derivative:\n$$\n\\frac{\\mathrm{d}^{2}f}{\\mathrm{d}a^{2}} = 2S_{s} + 2G^{2}S_{n} = 2(S_{s} + G^{2}S_{n})\n$$\nSince PSDs $S_{s}$ and $S_{n}$ are non-negative, and it is given that $G  0$, the sum $S_{s} + G^{2}S_{n}$ is positive (assuming non-trivial signals, $S_s0$ and $S_n0$). Thus, the second derivative is positive, confirming that the derived value of $a$ indeed minimizes the mean squared error $\\mathcal{E}(a)$.",
            "answer": "$$\n\\boxed{\\frac{S_{s}}{S_{s} + G^{2}S_{n}}}\n$$"
        }
    ]
}