{
    "hands_on_practices": [
        {
            "introduction": "Tikhonov 正则化是解决不适定逆问题的基石。要真正理解其工作原理，关键在于通过奇异值分解 (SVD) 来剖析其解的结构。本练习将引导您从第一性原理出发，推导出 Tikhonov 正则化解的闭合形式，并分析其在正则化参数 $\\alpha$ 趋于两个极端（零和无穷大）时的行为，从而揭示正则化在无解和过平滑解之间进行权衡的本质。",
            "id": "4135327",
            "problem": "在计算声学中，从一个紧支集声源分布到阵列压力测量的离散化正向映射可以建模为一个线性算子 $A \\in \\mathbb{R}^{m \\times n}$，它作用于一个未知的系数向量 $x \\in \\mathbb{R}^{n}$，产生理想数据 $b_{\\mathrm{ideal}} = A x$。测量数据 $b = b_{\\mathrm{ideal}} + \\eta$ 则受到加性噪声 $\\eta \\in \\mathbb{R}^{m}$ 的污染。从 $b$ 中恢复 $x$ 的反问题通常是不适定的，因为 $A$ 是病态的或秩亏的。为了稳定重构过程，我们考虑零阶吉洪诺夫正则化，它寻求以下二次泛函的最小化子：\n$$\nJ_{\\alpha}(x) = \\|A x - b\\|_{2}^{2} + \\alpha \\|x\\|_{2}^{2}\n$$\n其中 $\\alpha > 0$ 是正则化参数。设 $A$ 的奇异值分解（SVD）由因子分解 $A = U \\Sigma V^{T}$ 给出，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是对角矩阵，其非负奇异值为 $\\sigma_{1} \\ge \\sigma_{2} \\ge \\cdots \\ge \\sigma_{r} > 0$，后面跟着零，其中 $r = \\operatorname{rank}(A)$。用 $u_{i}$ 和 $v_{i}$ 分别表示左奇异向量和右奇异向量。\n\n从这个设定和最小二乘法及二次正则化的基本定义出发，推导吉洪诺夫正则化解 $x_{\\alpha}$ 的闭式表达式，并以SVD分量（如 $u_i, v_i, \\sigma_i$）表示。利用这个表达式，分析当 $\\alpha \\to 0^{+}$ 和 $\\alpha \\to \\infty$ 时 $x_{\\alpha}$ 的极限行为。\n\n你的最终答案必须是一个单一的闭式解析表达式，包含：\n- $x_{\\alpha}$ 的SVD滤波表示，以及\n- $\\lim_{\\alpha \\to 0^{+}} x_{\\alpha}$ 和 $\\lim_{\\alpha \\to \\infty} x_{\\alpha}$ 的两个极限表达式。\n\n不需要进行数值计算。请以符号形式表达你的最终答案。如果你使用多个表达式，请将它们表示为矩阵的单行（一行多列）。不需要物理单位。",
            "solution": "问题陈述是线性反问题吉洪诺夫正则化的标准表述，科学上合理、适定、客观且自洽。因此，它是有效的。\n\n目标是找到向量 $x_{\\alpha} \\in \\mathbb{R}^{n}$，它能最小化吉洪诺夫泛函：\n$$\nJ_{\\alpha}(x) = \\|A x - b\\|_{2}^{2} + \\alpha \\|x\\|_{2}^{2}\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^{m}$，且 $\\alpha > 0$。\n\n首先，我们将泛函用矩阵表示法表达。欧几里得范数的平方 $\\|v\\|_{2}^{2}$ 等价于点积 $v^{T}v$。\n$$\nJ_{\\alpha}(x) = (A x - b)^{T}(A x - b) + \\alpha x^{T}x\n$$\n展开第一项：\n$$\nJ_{\\alpha}(x) = (x^{T}A^{T} - b^{T})(A x - b) + \\alpha x^{T}x\n$$\n$$\nJ_{\\alpha}(x) = x^{T}A^{T}A x - x^{T}A^{T}b - b^{T}A x + b^{T}b + \\alpha x^{T}x\n$$\n由于 $b^{T}A x$ 是一个标量，它等于其转置 $(b^{T}A x)^{T} = x^{T}A^{T}b$。因此，我们可以合并线性项：\n$$\nJ_{\\alpha}(x) = x^{T}A^{T}A x - 2 b^{T}A x + b^{T}b + \\alpha x^{T}x\n$$\n将涉及 $x$ 的项分组：\n$$\nJ_{\\alpha}(x) = x^{T}(A^{T}A + \\alpha I)x - 2 b^{T}A x + b^{T}b\n$$\n泛函 $J_{\\alpha}(x)$ 是一个关于 $x$ 的二次凸函数。其唯一的最小化子可以通过将其关于 $x$ 的梯度设为零向量来找到。使用标准的矩阵微积分恒等式，对于对称矩阵 $C$，有 $\\nabla_{x}(x^{T}Cx) = 2Cx$，且 $\\nabla_{x}(c^{T}x) = c$，我们求得 $J_{\\alpha}(x)$ 的梯度：\n$$\n\\nabla_{x} J_{\\alpha}(x) = 2(A^{T}A + \\alpha I)x - 2A^{T}b\n$$\n将梯度设为零以找到最小化子 $x_{\\alpha}$：\n$$\n2(A^{T}A + \\alpha I)x_{\\alpha} - 2A^{T}b = 0\n$$\n这简化为吉洪诺夫正规方程：\n$$\n(A^{T}A + \\alpha I)x_{\\alpha} = A^{T}b\n$$\n矩阵 $A^{T}A$ 是半正定的。由于 $\\alpha > 0$，矩阵 $(A^{T}A + \\alpha I)$ 是正定的，因此是可逆的。$x_{\\alpha}$ 的闭式解为：\n$$\nx_{\\alpha} = (A^{T}A + \\alpha I)^{-1} A^{T}b\n$$\n接下来，我们将 $A$ 的奇异值分解（SVD），即 $A = U \\Sigma V^{T}$，代入此表达式。其转置为 $A^{T} = (U \\Sigma V^{T})^{T} = V \\Sigma^{T} U^{T}$。\n乘积 $A^{T}A$ 变为：\n$$\nA^{T}A = (V \\Sigma^{T} U^{T})(U \\Sigma V^{T}) = V \\Sigma^{T} (U^{T}U) \\Sigma V^{T} = V (\\Sigma^{T}\\Sigma) V^{T}\n$$\n这里我们利用了 $U$ 的正交性，即 $U^{T}U = I$。矩阵 $\\Sigma^{T}\\Sigma$ 是一个 $n \\times n$ 的对角矩阵，其前 $r$ 个对角元素为 $\\sigma_{i}^{2}$（对于 $i=1, \\dots, r$），其余元素为零。\n\n将此代入 $x_{\\alpha}$ 的表达式中：\n$$\nx_{\\alpha} = (V (\\Sigma^{T}\\Sigma) V^{T} + \\alpha I)^{-1} (V \\Sigma^{T} U^{T}) b\n$$\n使用恒等式 $I = VV^{T}$（因为 $V$ 是正交的），我们可以提出因子 $V$ 和 $V^{T}$：\n$$\nx_{\\alpha} = (V (\\Sigma^{T}\\Sigma) V^{T} + \\alpha VV^{T})^{-1} V \\Sigma^{T} U^{T} b\n$$\n$$\nx_{\\alpha} = (V (\\Sigma^{T}\\Sigma + \\alpha I) V^{T})^{-1} V \\Sigma^{T} U^{T} b\n$$\n使用恒等式 $(PQP^{-1})^{-1} = PQ^{-1}P^{-1}$：\n$$\nx_{\\alpha} = V (\\Sigma^{T}\\Sigma + \\alpha I)^{-1} V^{T} V \\Sigma^{T} U^{T} b\n$$\n由于 $V^{T}V=I$，这简化为：\n$$\nx_{\\alpha} = V (\\Sigma^{T}\\Sigma + \\alpha I)^{-1} \\Sigma^{T} U^{T} b\n$$\n矩阵 $(\\Sigma^{T}\\Sigma + \\alpha I)$ 是一个 $n \\times n$ 的对角矩阵，其对角元素为 $(\\sigma_{i}^{2} + \\alpha)$（对于 $i=1, \\dots, n$，其中当 $i > r$ 时 $\\sigma_i = 0$）。其逆是一个对角矩阵，元素为 $\\frac{1}{\\sigma_{i}^{2} + \\alpha}$。矩阵 $\\Sigma^{T}$ 是一个 $n \\times m$ 矩阵，对角元素为 $\\sigma_i$。乘积 $(\\Sigma^{T}\\Sigma + \\alpha I)^{-1} \\Sigma^{T}$ 得到一个 $n \\times m$ 矩阵，其前 $r$ 个对角元素为 $\\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha}$，所有其他元素均为零。\n\n为了将此结果表示为和式，我们考虑这些矩阵对向量 $b$ 的作用：\n$$\nx_{\\alpha} = V \\left[ (\\Sigma^{T}\\Sigma + \\alpha I)^{-1} \\Sigma^{T} (U^{T}b) \\right]\n$$\n向量 $U^{T}b$ 的分量为 $u_{i}^{T}b$。方括号中的矩阵乘积产生一个在 $\\mathbb{R}^n$ 中的向量，其第 $i$ 个分量对于 $i \\le r$ 是 $\\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{T}b)$，对于 $i > r$ 是 $0$。最后，乘以 $V$ 将解重构为右奇异向量 $v_i$ 的线性组合：\n$$\nx_{\\alpha} = \\sum_{i=1}^{n} \\left( \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{T}b) \\right) v_i\n$$\n由于当 $i > r$ 时 $\\sigma_i = 0$，求和可以截断到 $r$：\n$$\nx_{\\alpha} = \\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{T}b) v_i\n$$\n\n接下来，我们分析 $x_{\\alpha}$ 的极限行为。\n\n情况1：$\\alpha \\to \\infty$\n我们考察各项系数的极限：\n$$\n\\lim_{\\alpha \\to \\infty} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} = 0\n$$\n由于对于每个 $i \\in \\{1, \\dots, r\\}$，$\\sigma_i$ 是有限的，分母无界增长，使得分式趋于零。因此，极限解为：\n$$\n\\lim_{\\alpha \\to \\infty} x_{\\alpha} = \\sum_{i=1}^{r} (0) \\cdot (u_{i}^{T}b) v_i = 0\n$$\n解收敛于零向量。这是预料之中的，因为对 $x$ 的范数施加无限大的惩罚会迫使解的范数趋于零。\n\n情况2：$\\alpha \\to 0^{+}$\n我们考察当 $\\alpha$ 从正方向趋近于零时各项系数的极限：\n$$\n\\lim_{\\alpha \\to 0^{+}} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} = \\frac{\\sigma_{i}}{\\sigma_{i}^{2}} = \\frac{1}{\\sigma_{i}}\n$$\n这成立是因为对于 $i \\in \\{1, \\dots, r\\}$，$\\sigma_i > 0$。将此代入 $x_{\\alpha}$ 的表达式中：\n$$\n\\lim_{\\alpha \\to 0^{+}} x_{\\alpha} = \\sum_{i=1}^{r} \\frac{1}{\\sigma_{i}} (u_{i}^{T}b) v_i\n$$\n这是 Moore-Penrose 伪逆解 $x^{\\dagger} = A^{\\dagger}b$ 的表达式，该解是原始未正则化问题 $Ax=b$ 的最小范数最小二乘解。\n\n所需的三个表达式分别是 $x_{\\alpha}$ 的SVD表示及其在 $\\alpha \\to \\infty$ 和 $\\alpha \\to 0^{+}$ 时的极限。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{T} b) v_{i} & \\sum_{i=1}^{r} \\frac{u_{i}^{T} b}{\\sigma_{i}} v_{i} & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在推导出正则化解的解析形式后，下一步是量化其在存在测量噪声时的性能。正则化的真正价值在于它能够抑制由不适定性引起的噪声放大。本练习将指导您推导 Tikhonov 估计量的方差，这为您提供了一个定量理解著名的偏置-方差权衡的途径，并阐明了正则化参数 $\\alpha$ 如何调节这一权衡。",
            "id": "4135345",
            "problem": "考虑一个计算声学中的单频逆源重构问题。麦克风阵列上的一组 $m$ 个复声压测量值 $b \\in \\mathbb{C}^{m}$ 通过线性关系 $b = A x + \\eta$ 进行建模，其中 $A \\in \\mathbb{C}^{m \\times n}$ 是离散频域正向算子，将等效的单极子源强度向量 $x \\in \\mathbb{C}^{n}$（单位为 $\\mathrm{m^{3}/s}$）映射到声压（单位为 $\\mathrm{Pa}$），$\\eta \\in \\mathbb{C}^{m}$ 是加性测量噪声。假设噪声是零均值、白色、圆复高斯噪声，其协方差为 $\\mathbb{E}[\\eta \\eta^{\\ast}] = \\sigma_{\\eta}^{2} I$，其中 $I$ 是单位矩阵，$\\sigma_{\\eta}^{2}$ 已知。\n\n为了从噪声数据 $b^{\\delta}$（满足 $\\|b - b^{\\delta}\\|_{2} = \\delta$）中恢复 $x$，使用零阶吉洪诺夫正则化（也称为岭回归），定义为\n$$\nx_{\\alpha} = \\arg\\min_{x \\in \\mathbb{C}^{n}} \\left\\{ \\|A x - b^{\\delta}\\|_{2}^{2} + \\alpha \\|x\\|_{2}^{2} \\right\\},\n$$\n其中 $\\alpha > 0$ 是正则化参数。设 $A$ 的奇异值分解（SVD）为 $A = U \\Sigma V^{\\ast}$，其中左奇异向量为 $U = [u_{1},\\dots,u_{m}]$，右奇异向量为 $V = [v_{1},\\dots,v_{n}]$，$\\Sigma$ 的对角线上有非零奇异值 $\\{\\sigma_{i}\\}_{i=1}^{r}$，矩阵的秩为 $r \\leq \\min\\{m,n\\}$。\n\n仅使用基本定义和零阶吉洪诺夫正则化的基于SVD的滤波因子表示法，推导估计量 $x_{\\alpha}$ 的方差（即由噪声引起的分量的期望平方欧几里得范数）的闭式表达式，即\n$$\n\\mathrm{Var}(x_{\\alpha}) \\equiv \\mathbb{E}\\left[ \\left\\| x_{\\alpha} - \\mathbb{E}[x_{\\alpha}] \\right\\|_{2}^{2} \\right],\n$$\n用 $\\alpha$、$\\{\\sigma_{i}\\}_{i=1}^{r}$ 和 $\\sigma_{\\eta}^{2}$ 来表示。\n\n然后，基于你的表达式，分析在渐近状态 $\\alpha \\to 0^{+}$ 和 $\\alpha \\to \\infty$ 下，$\\mathrm{Var}(x_{\\alpha})$ 如何依赖于 $\\alpha$，并说明每种状态下的主导阶行为。\n\n答案规格：\n- 以 $\\alpha$、$\\{\\sigma_{i}\\}$ 和 $\\sigma_{\\eta}^{2}$ 的形式，提供一个单一的闭式解析表达式作为最终方差。\n- 方差以 $(\\mathrm{m^{3}/s})^{2}$ 为单位表示。\n- 无需数值取整；给出精确的解析形式。",
            "solution": "问题需经过验证。所有给定条件都已被提取和分析。\n-   **模型**：$b = A x + \\eta$，其中 $b \\in \\mathbb{C}^{m}$，$x \\in \\mathbb{C}^{n}$，$A \\in \\mathbb{C}^{m \\times n}$，$\\eta \\in \\mathbb{C}^{m}$。\n-   **噪声**：$\\mathbb{E}[\\eta] = 0$，$\\mathbb{E}[\\eta \\eta^{\\ast}] = \\sigma_{\\eta}^{2} I$。\n-   **吉洪诺夫正则化**：$x_{\\alpha} = \\arg\\min_{x \\in \\mathbb{C}^{n}} \\left\\{ \\|A x - b^{\\delta}\\|_{2}^{2} + \\alpha \\|x\\|_{2}^{2} \\right\\}$，对于 $\\alpha > 0$。\n-   **SVD**：$A = U \\Sigma V^{\\ast}$，奇异值为 $\\{\\sigma_{i}\\}_{i=1}^{r}$。\n-   **目标表达式**：$\\mathrm{Var}(x_{\\alpha}) \\equiv \\mathbb{E}\\left[ \\left\\| x_{\\alpha} - \\mathbb{E}[x_{\\alpha}] \\right\\|_{2}^{2} \\right]$。\n-   **渐近分析**：当 $\\alpha \\to 0^{+}$ 和 $\\alpha \\to \\infty$ 时的行为。\n\n该问题是逆问题和正则化领域的一个标准理论推导。它具有科学依据、适定、客观且自洽。没有矛盾、歧义或事实错误。该问题被视为有效。\n\n吉洪诺夫正则化解 $x_{\\alpha}$ 最小化泛函 $J(x) = \\|A x - b^{\\delta}\\|_{2}^{2} + \\alpha \\|x\\|_{2}^{2}$。将关于 $x^{\\ast}$ 的复梯度设为零，得到正规方程组：\n$$\n(A^{\\ast} A + \\alpha I) x_{\\alpha} = A^{\\ast} b^{\\delta}\n$$\n估计量 $x_{\\alpha}$ 的闭式解为：\n$$\nx_{\\alpha} = (A^{\\ast} A + \\alpha I)^{-1} A^{\\ast} b^{\\delta}\n$$\n为分析此表达式，我们代入 $A$ 的奇异值分解（SVD），即 $A = U \\Sigma V^{\\ast}$。这意味着 $A^{\\ast} = V \\Sigma^{T} U^{\\ast}$，因为 $\\Sigma$ 包含实奇异值。\n项 $A^{\\ast} A$ 变为：\n$$\nA^{\\ast} A = (V \\Sigma^{T} U^{\\ast}) (U \\Sigma V^{\\ast}) = V \\Sigma^{T} \\Sigma V^{\\ast}\n$$\n这里，$\\Sigma^{T} \\Sigma$ 是一个 $n \\times n$ 的对角矩阵，其前 $r$ 个对角线元素为平方奇异值 $\\{\\sigma_{i}^{2}\\}_{i=1}^{r}$，其余为零。\n将此代入 $x_{\\alpha}$ 的表达式中：\n$$\nx_{\\alpha} = (V \\Sigma^{T} \\Sigma V^{\\ast} + \\alpha V V^{\\ast})^{-1} (V \\Sigma^{T} U^{\\ast}) b^{\\delta}\n$$\n$$\nx_{\\alpha} = (V (\\Sigma^{T} \\Sigma + \\alpha I) V^{\\ast})^{-1} V \\Sigma^{T} U^{\\ast} b^{\\delta}\n$$\n$$\nx_{\\alpha} = V (\\Sigma^{T} \\Sigma + \\alpha I)^{-1} V^{\\ast} V \\Sigma^{T} U^{\\ast} b^{\\delta}\n$$\n$$\nx_{\\alpha} = V (\\Sigma^{T} \\Sigma + \\alpha I)^{-1} \\Sigma^{T} U^{\\ast} b^{\\delta}\n$$\n这个表达式可以用 $V$ 的右奇异向量 $v_{i}$ 和 $U$ 的左奇异向量 $u_{i}$ 展开：\n$$\nx_{\\alpha} = \\sum_{i=1}^{n} v_{i} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{\\ast} b^{\\delta})\n$$\n其中我们定义当 $i > r$ 时 $\\sigma_{i}=0$。由于当 $i>r$ 时 $\\sigma_i=0$，此求和实际上在 $i=r$ 处截断。\n$$\nx_{\\alpha} = \\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{\\ast} b^{\\delta}) v_{i}\n$$\n为了计算方差，我们将噪声数据建模为 $b^{\\delta} = b + \\eta$，其中 $b = Ax_{\\mathrm{true}}$ 是来自某个真实源 $x_{\\mathrm{true}}$ 的无噪声数据，$\\eta$ 是具有给定统计特性的加性噪声。\n首先，我们计算估计量的期望值 $\\mathbb{E}[x_{\\alpha}]$。期望是关于噪声 $\\eta$ 的分布来计算的。由于 $\\mathbb{E}[\\eta]=0$，我们有 $\\mathbb{E}[b^{\\delta}] = \\mathbb{E}[b+\\eta] = b$。\n$$\n\\mathbb{E}[x_{\\alpha}] = \\mathbb{E}\\left[ \\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{\\ast} b^{\\delta}) v_{i} \\right] = \\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{\\ast} \\mathbb{E}[b^{\\delta}]) v_{i} = \\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{\\ast} b) v_{i}\n$$\n估计量与其均值的偏差为：\n$$\nx_{\\alpha} - \\mathbb{E}[x_{\\alpha}] = \\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} \\left( u_{i}^{\\ast} b^{\\delta} - u_{i}^{\\ast} b \\right) v_{i} = \\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{\\ast} \\eta) v_{i}\n$$\n方差是该偏差的期望平方欧几里得范数。\n$$\n\\mathrm{Var}(x_{\\alpha}) = \\mathbb{E}\\left[ \\left\\| x_{\\alpha} - \\mathbb{E}[x_{\\alpha}] \\right\\|_{2}^{2} \\right] = \\mathbb{E}\\left[ \\left( \\sum_{j=1}^{r} \\frac{\\sigma_{j}}{\\sigma_{j}^{2} + \\alpha} (u_{j}^{\\ast} \\eta) v_{j} \\right)^{\\ast} \\left( \\sum_{i=1}^{r} \\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha} (u_{i}^{\\ast} \\eta) v_{i} \\right) \\right]\n$$\n利用右奇异向量的正交性，$v_{j}^{\\ast}v_{i} = \\delta_{ij}$：\n$$\n\\mathrm{Var}(x_{\\alpha}) = \\mathbb{E}\\left[ \\sum_{i=1}^{r} \\left(\\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\alpha}\\right)^{2} |u_{i}^{\\ast} \\eta|^{2} \\right]\n$$\n根据期望的线性性质：\n$$\n\\mathrm{Var}(x_{\\alpha}) = \\sum_{i=1}^{r} \\frac{\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\alpha)^{2}} \\mathbb{E}[|u_{i}^{\\ast} \\eta|^{2}]\n$$\n我们需要计算 $\\mathbb{E}[|u_{i}^{\\ast} \\eta|^{2}]$。\n$$\n\\mathbb{E}[|u_{i}^{\\ast} \\eta|^{2}] = \\mathbb{E}[ (u_{i}^{\\ast} \\eta)^{\\ast} (u_{i}^{\\ast} \\eta) ] = \\mathbb{E}[ \\eta^{\\ast} u_{i} u_{i}^{\\ast} \\eta ]\n$$\n这是随机向量 $\\eta$ 的二次型。使用恒等式 $\\mathbb{E}[y^{\\ast}Qy] = \\mathrm{Tr}(Q\\mathbb{E}[yy^{\\ast}])$，我们有 $y=\\eta$ 和 $Q = u_{i}u_{i}^{\\ast}$：\n$$\n\\mathbb{E}[ \\eta^{\\ast} u_{i} u_{i}^{\\ast} \\eta ] = \\mathrm{Tr}(u_{i} u_{i}^{\\ast} \\mathbb{E}[\\eta\\eta^{\\ast}]) = \\mathrm{Tr}(u_{i} u_{i}^{\\ast} (\\sigma_{\\eta}^{2} I)) = \\sigma_{\\eta}^{2} \\mathrm{Tr}(u_{i} u_{i}^{\\ast})\n$$\n利用迹的循环性质，$\\mathrm{Tr}(u_{i} u_{i}^{\\ast}) = \\mathrm{Tr}(u_{i}^{\\ast} u_{i})$。因为 $u_{i}$ 是单位向量，所以 $u_{i}^{\\ast} u_{i} = 1$。标量的迹是其自身，因此 $\\mathrm{Tr}(1) = 1$。\n因此，$\\mathbb{E}[|u_{i}^{\\ast} \\eta|^{2}] = \\sigma_{\\eta}^{2}$。\n将此结果代回方差表达式，得到最终的闭式表达式：\n$$\n\\mathrm{Var}(x_{\\alpha}) = \\sigma_{\\eta}^{2} \\sum_{i=1}^{r} \\frac{\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\alpha)^2}\n$$\n\n接下来，我们分析 $\\mathrm{Var}(x_{\\alpha})$ 的渐近行为。\n\n1.  **当 $\\alpha \\to 0^{+}$ 时（最小正则化）**：\n    在此极限下，分母趋近于 $(\\sigma_{i}^{2})^{2}$。\n    $$\n    \\lim_{\\alpha \\to 0^{+}} \\mathrm{Var}(x_{\\alpha}) = \\sigma_{\\eta}^{2} \\sum_{i=1}^{r} \\frac{\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + 0)^2} = \\sigma_{\\eta}^{2} \\sum_{i=1}^{r} \\frac{\\sigma_{i}^{2}}{\\sigma_{i}^{4}} = \\sigma_{\\eta}^{2} \\sum_{i=1}^{r} \\frac{1}{\\sigma_{i}^{2}}\n    $$\n    这是无正则化的 Moore-Penrose 伪逆解的方差。对于病态问题，奇异值 $\\sigma_{i}$ 会衰减到零，因此对于小的 $\\sigma_{i}$，项 $1/\\sigma_{i}^{2}$ 会变得非常大。这导致方差爆炸，这种现象称为噪声放大。主导阶行为是这个可能非常大的常数值。\n\n2.  **当 $\\alpha \\to \\infty$ 时（强正则化）**：\n    在此极限下，分母中的 $\\alpha$ 远大于 $\\sigma_{i}^{2}$。所以，$\\sigma_{i}^{2} + \\alpha \\approx \\alpha$。\n    $$\n    \\mathrm{Var}(x_{\\alpha}) \\approx \\sigma_{\\eta}^{2} \\sum_{i=1}^{r} \\frac{\\sigma_{i}^{2}}{\\alpha^2} = \\frac{\\sigma_{\\eta}^{2}}{\\alpha^2} \\sum_{i=1}^{r} \\sigma_{i}^{2}\n    $$\n    和 $\\sum_{i=1}^{r} \\sigma_{i}^{2}$ 是矩阵 $A$ 的弗罗贝尼乌斯范数的平方，记为 $\\|A\\|_{F}^{2}$。这是一个常数值。\n    因此，对于大的 $\\alpha$，方差的主导阶行为是：\n    $$\n    \\mathrm{Var}(x_{\\alpha}) \\sim \\frac{\\sigma_{\\eta}^{2} \\|A\\|_{F}^{2}}{\\alpha^2} = O(\\alpha^{-2})\n    $$\n    当 $\\alpha \\to \\infty$ 时，方差趋于零。强正则化非常有效地抑制了噪声，但代价是引入了显著的偏差，因为解 $x_{\\alpha}$ 被推向零向量，远离真实解 $x_{\\mathrm{true}}$。\n\n通过量纲分析可知，推导出的方差表达式的单位是 $(\\mathrm{m^{3}/s})^{2}$。$\\sigma_{\\eta}^{2}$ 的单位是 $\\mathrm{Pa}^{2}$。$\\sigma_{i}$ 的单位是 $\\mathrm{Pa}/(\\mathrm{m^{3}/s})$。为了使它们的和在量纲上一致，$\\alpha$ 的单位必须与 $\\sigma_{i}^{2}$ 的单位相匹配，所以 $[\\alpha] = (\\mathrm{Pa}/(\\mathrm{m^{3}/s}))^{2}$。\n求和中每一项的单位是：\n$$\n\\frac{[\\sigma_{i}^{2}]}{[\\sigma_{i}^{2} + \\alpha]^{2}} = \\frac{(\\mathrm{Pa}/(\\mathrm{m^{3}/s}))^{2}}{((\\mathrm{Pa}/(\\mathrm{m^{3}/s}))^{2})^{2}} = \\frac{1}{(\\mathrm{Pa}/(\\mathrm{m^{3}/s}))^{2}} = \\frac{(\\mathrm{m^{3}/s})^{2}}{\\mathrm{Pa}^{2}}\n$$\n乘以 $\\sigma_{\\eta}^{2}$ 的单位：\n$$\n[\\mathrm{Var}(x_{\\alpha})] = [\\sigma_{\\eta}^{2}] \\times \\frac{(\\mathrm{m^{3}/s})^{2}}{\\mathrm{Pa}^{2}} = \\mathrm{Pa}^{2} \\times \\frac{(\\mathrm{m^{3}/s})^{2}}{\\mathrm{Pa}^{2}} = (\\mathrm{m^{3}/s})^{2}\n$$\n单位如要求一样是一致的。",
            "answer": "$$\n\\boxed{\\sigma_{\\eta}^{2} \\sum_{i=1}^{r} \\frac{\\sigma_i^2}{(\\sigma_i^2 + \\alpha)^2}}\n$$"
        },
        {
            "introduction": "理论分析固然重要，但在模拟的物理问题上实现和比较不同方法能提供无可替代的直观感受。本练习将理论付诸实践，涉及一个真实的声源重构场景。您需要编写代码，实现截断奇异值分解 (TSVD) 和 Tikhonov 正则化，在一个公平的准则（等效自由度）下比较它们的性能，并量化重构偏置的差异。",
            "id": "4135342",
            "problem": "考虑一个计算声学中的频域线性反问题，其假设为介质均匀，且密度和声速恒定。在 $M$ 个麦克风处测得的压力矢量 $y \\in \\mathbb{C}^M$（单位为帕斯卡）通过线性正演模型 $y = A x + e$ 进行建模，其中 $x \\in \\mathbb{C}^J$ 是复源单极子体积速度矢量（单位为立方米/秒），$A \\in \\mathbb{C}^{M \\times J}$ 是声学传递矩阵，而 $e$ 是零均值测量噪声。对于位于 $s_j$ 的单极子源和位于 $m_i$ 的麦克风，矩阵项 $A_{ij}$ 由自由场亥姆霍兹格林函数给出\n$$\nA_{ij} = \\mathrm{i}\\,\\rho_0 c\\,k \\,\\frac{\\exp\\left(\\mathrm{i} k r_{ij}\\right)}{4\\pi r_{ij}},\n$$\n其中 $\\rho_0$ 是环境密度（单位为千克/立方米），$c$ 是声速（单位为米/秒），$k = 2\\pi f / c$ 是频率 $f$（单位为赫兹）下的波数（单位为弧度/米），$r_{ij} = \\|m_i - s_j\\|$ 是欧几里得距离（单位为米），且 $\\mathrm{i} = \\sqrt{-1}$。角度必须以弧度处理。\n\n设 $A$ 的奇异值分解为 $A = U \\Sigma V^\\ast$，其中 $U \\in \\mathbb{C}^{M \\times r}$，$V \\in \\mathbb{C}^{J \\times r}$，$r = \\min(M,J)$，且 $\\Sigma = \\operatorname{diag}(\\sigma_1,\\dots,\\sigma_r)$，奇异值 $\\sigma_1 \\ge \\cdots \\ge \\sigma_r \\ge 0$。考虑产生拟合数据 $\\hat{y} = S y$ 的线性重构，其中 $S = U \\operatorname{diag}(\\varphi_1,\\dots,\\varphi_r) U^\\ast$ 是一个特定的数据空间线性算子（帽子矩阵）。考虑两种滤波因子的选择：\n- 截断奇异值分解 (TSVD)：当 $i \\le k$ 时 $\\varphi_i = 1$，当 $i > k$ 时 $\\varphi_i = 0$，其中 $k \\in \\{1,\\dots,r\\}$。\n- Tikhonov 正则化，参数 $\\lambda > 0$：$\\varphi_i = \\sigma_i^2/(\\sigma_i^2 + \\lambda)$。\n\n将有效自由度定义为 $\\mathrm{edf} = \\operatorname{trace}(S) = \\sum_{i=1}^r \\varphi_i$。拟合数据中的重构偏差是拟合数据与无噪声真值之间的期望偏差，由 $b = \\mathbb{E}[\\hat{y}] - y_{\\text{true}} = (S - I) y_{\\text{true}}$ 给出，其中 $I$ 是 $\\mathbb{C}^M$ 上的单位矩阵，而 $y_{\\text{true}} = A x_{\\text{true}}$ 是由已知源矢量 $x_{\\text{true}}$ 生成的无噪声数据。通过其欧几里得范数 $\\|b\\|_2$（单位为帕斯卡）来量化偏差。在比较 TSVD 和 Tikhonov 时，通过选择 $\\lambda$ 使它们的有效自由度相等\n$$\n\\sum_{i=1}^r \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda} = k,\n$$\n然后计算并比较它们的偏差范数。\n\n使用以下具有科学依据的几何结构和参数：\n- 环境密度 $\\rho_0 = 1.2$（千克/立方米）和声速 $c = 343$（米/秒）。\n- 源的数量 $J = 12$，其位置为 $s_j = (x_j, 0)$，其中 $x_j$ 在 $[-0.5, 0.5]$（米）上均匀分布。\n- 麦克风的数量 $M = 16$，其位置为 $m_i = (x_i, 0.8)$，其中 $x_i$ 在 $[-0.6, 0.6]$（米）上均匀分布。\n- 通过实值振幅定义真实源矢量 $x_{\\text{true}} \\in \\mathbb{C}^J$\n$$\nx_{\\text{true},j} = Q_0 \\left[\\sin\\left(\\pi \\frac{j}{J}\\right) + 0.5 \\cos\\left(2\\pi \\frac{j}{J}\\right)\\right],\n$$\n其中 $Q_0 = 10^{-4}$（立方米/秒），且相位为零（纯实数）。\n\n您的任务是编写一个程序，该程序：\n- 根据上述物理模型构建 $A$。\n- 计算 $A$ 的奇异值分解，并用它来构建 TSVD（使用给定的 $k$）和 Tikhonov（选择参数 $\\lambda$ 以使 $\\mathrm{edf}$ 等于 TSVD 的值 $k$）的帽子矩阵。\n- 计算偏差范数 $\\|b_{\\text{TSVD}}\\|_2$ 和 $\\|b_{\\text{Tikhonov}}\\|_2$（均以帕斯卡为单位）。\n- 对于每个测试用例，输出偏差范数之差 $\\Delta = \\|b_{\\text{Tikhonov}}\\|_2 - \\|b_{\\text{TSVD}}\\|_2$（单位为帕斯卡）作为一个浮点数。\n\n设计一个稳健的数值程序来求解 $\\lambda$，以使有效自由度等式成立。利用 $\\sum_{i=1}^r \\sigma_i^2/(\\sigma_i^2 + \\lambda)$ 对 $\\lambda$ 的单调性，实现一个区间套和二分法策略，以在小容差内找到 $\\lambda$。在构建 $S$ 和计算范数时确保数值稳定性。\n\n测试套件：\n- 情况 1：频率 $f = 1500$（赫兹），截断水平 $k = 6$。\n- 情况 2：频率 $f = 1500$（赫兹），截断水平 $k = 1$。\n- 情况 3：频率 $f = 1500$（赫兹），截断水平 $k = 11$。\n- 情况 4：频率 $f = 4000$（赫兹），截断水平 $k = 6$。\n\n对于所有情况，构建 $A$、$x_{\\text{true}}$ 和 $y_{\\text{true}}$，通过使有效自由度相等来计算所需的 $\\lambda$，并计算以帕斯卡为单位的 $\\Delta$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[d_1,d_2,d_3,d_4]$），其中每个 $d_i$ 是指定情况对应的以帕斯卡表示的 $\\Delta$。",
            "solution": "用户提供的问题是计算声学和反问题理论中一个适定的练习，要求比较两种标准的正则化方法：截断奇异值分解 (TSVD) 和 Tikhonov 正则化。该问题具有科学依据，内部一致，并提供了进行唯一数值求解所需的所有数据和定义。因此，该问题被认为是有效的。\n\n核心任务是为几个测试用例计算偏差范数之差 $\\Delta = \\|b_{\\text{Tikhonov}}\\|_2 - \\|b_{\\text{TSVD}}\\|_2$。偏差定义为 $b = (S-I)y_{\\text{true}}$，其中 $S$ 是依赖于正则化的帽子矩阵，$I$ 是单位矩阵，$y_{\\text{true}}$ 是无噪声数据。通过使两种方法的有效自由度（$\\mathrm{edf}$）相等，来确保比较的公平性。\n\n对于由频率 $f$ 和 TSVD 截断水平 $k$ 定义的每个测试用例，求解过程分五个步骤进行。\n\n**步骤 1：构建物理模型**\n\n首先，我们构建声学传递矩阵 $A \\in \\mathbb{C}^{M \\times J}$。问题指定了源的数量 $J=12$ 和麦克风的数量 $M=16$。它们的位置在二维平面中定义：\n- 源位置 $s_j = (x_j, 0)$，对于 $j \\in \\{0, 1, \\dots, J-1\\}$，其中 $x_j$ 在 $[-0.5, 0.5]$ 米上均匀分布。\n- 麦克风位置 $m_i = (y_i, 0.8)$，对于 $i \\in \\{0, 1, \\dots, M-1\\}$，其中 $y_i$ 在 $[-0.6, 0.6]$ 米上均匀分布。\n\n对于每个频率为 $f$ 的测试用例，波数计算为 $k_{wave} = 2\\pi f / c$，使用给定的声速 $c=343\\,\\text{m/s}$。计算所有源-麦克风对的欧几里得距离 $r_{ij} = \\|m_i - s_j\\|_2$。这些值与环境密度 $\\rho_0 = 1.2\\,\\text{kg/m}^3$ 一起，用于根据亥姆霍兹格林函数填充矩阵 $A$：\n$$\nA_{ij} = \\mathrm{i}\\,\\rho_0 c\\,k_{wave} \\,\\frac{\\exp\\left(\\mathrm{i} k_{wave} r_{ij}\\right)}{4\\pi r_{ij}}\n$$\n我们还使用提供的公式构建真实源矢量 $x_{\\text{true}} \\in \\mathbb{R}^J$，其中 $Q_0 = 10^{-4}\\,\\text{m}^3/\\text{s}$，$j$ 是从 0 到 $J-1=11$ 的基于 0 的索引：\n$$\nx_{\\text{true},j} = Q_0 \\left[\\sin\\left(\\pi \\frac{j}{J}\\right) + 0.5 \\cos\\left(2\\pi \\frac{j}{J}\\right)\\right]\n$$\n由此，无噪声测量矢量 $y_{\\text{true}} \\in \\mathbb{C}^M$ 计算为 $y_{\\text{true}} = A x_{\\text{true}}$。\n\n**步骤 2：奇异值分解和偏差公式化**\n\n矩阵 $A$ 使用奇异值分解 (SVD) 进行分解：$A = U \\Sigma V^\\ast$。这里，$U \\in \\mathbb{C}^{M \\times r}$ 和 $V \\in \\mathbb{C}^{J \\times r}$ 具有标准正交列，$\\Sigma = \\operatorname{diag}(\\sigma_1, \\dots, \\sigma_r)$ 包含按非递增顺序排列的奇异值，且 $r = \\min(M, J) = 12$。\n\n偏差矢量为 $b = (S-I)y_{\\text{true}}$。由于 $y_{\\text{true}}=Ax_{\\text{true}}$，$y_{\\text{true}}$ 位于 $A$ 的列空间中，该空间由 $U$ 的列张成。因此，$y_{\\text{true}}$ 在该空间上的投影就是它自身，即 $y_{\\text{true}} = UU^\\ast y_{\\text{true}}$。利用此属性和帽子矩阵 $S = U \\operatorname{diag}(\\varphi_1, \\dots, \\varphi_r) U^\\ast$ 的定义，偏差矢量可简化为：\n$$\nb = (U \\operatorname{diag}(\\varphi_i) U^\\ast - I)y_{\\text{true}} = (U \\operatorname{diag}(\\varphi_i) U^\\ast - U U^\\ast)y_{\\text{true}} = U(\\operatorname{diag}(\\varphi_i) - I_r)U^\\ast y_{\\text{true}}\n$$\n其中 $I_r$ 是 $r \\times r$ 的单位矩阵，$\\varphi_i$ 是滤波因子。偏差的欧几里得范数 $\\|b\\|_2$ 可以被高效计算。由于 $U$ 是一个等距算子 ($U^\\ast U=I_r$)，范数为：\n$$\n\\|b\\|_2 = \\|(\\operatorname{diag}(\\varphi_i) - I_r)U^\\ast y_{\\text{true}}\\|_2\n$$\n令 $y'_u = U^\\ast y_{\\text{true}}$，偏差范数的平方变为：\n$$\n\\|b\\|_2^2 = \\sum_{i=1}^r |\\varphi_i - 1|^2 |y'_{u, i}|^2\n$$\n该公式避免了显式构造大矩阵，并用于两种正则化方法。\n\n**步骤 3：TSVD 偏差计算**\n\n对于截断水平为 $k$ 的 TSVD，滤波因子为 $\\varphi_i = 1$（当 $i \\le k$）和 $\\varphi_i = 0$（当 $i > k$）。有效自由度为 $\\mathrm{edf}_{\\text{TSVD}} = \\sum_{i=1}^r \\varphi_i = k$。当 $i \\le k$ 时，项 $\\varphi_i - 1$ 为 $0$；当 $i > k$ 时为 $-1$。因此偏差范数为：\n$$\n\\|b_{\\text{TSVD}}\\|_2^2 = \\sum_{i=k+1}^r |y'_{u,i}|^2\n$$\n\n**步骤 4：Tikhonov 正则化偏差计算**\n\n对于 Tikhonov 正则化，滤波因子为 $\\varphi_i = \\sigma_i^2 / (\\sigma_i^2 + \\lambda)$，其中 $\\lambda > 0$ 是正则化参数。为确保与 TSVD 的公平比较，选择 $\\lambda$ 使得有效自由度相等，即 $\\mathrm{edf}_{\\text{Tikhonov}} = k$。这需要对 $\\lambda$ 求解以下非线性方程：\n$$\ng(\\lambda) = \\sum_{i=1}^r \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda} - k = 0\n$$\n函数 $g(\\lambda)$ 对于 $\\lambda > 0$ 是连续且严格单调递减的。其值域从 $g(0^+) = r-k \\ge 0$ 延伸到 $g(\\infty) = -k  0$，保证了唯一正根的存在。我们实现了一个二分法来数值求解这个根。建立一个初始搜索区间 $[\\lambda_{low}, \\lambda_{high}]$，其中 $\\lambda_{low}$ 接近于零，而 $\\lambda_{high}$ 足够大以确保 $g(\\lambda_{high})  0$。二分法算法迭代地将区间减半，直到根 $\\lambda$ 被找到达到所需的精度。\n\n一旦确定了 $\\lambda$，Tikhonov 滤波因子就是已知的。项 $\\varphi_i - 1$ 变为：\n$$\n\\varphi_i - 1 = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda} - 1 = \\frac{-\\lambda}{\\sigma_i^2 + \\lambda}\n$$\nTikhonov 正则化的偏差范数则为：\n$$\n\\|b_{\\text{Tikhonov}}\\|_2^2 = \\sum_{i=1}^r \\left| \\frac{-\\lambda}{\\sigma_i^2 + \\lambda} \\right|^2 |y'_{u,i}|^2 = \\sum_{i=1}^r \\left( \\frac{\\lambda}{\\sigma_i^2 + \\lambda} \\right)^2 |y'_{u,i}|^2\n$$\n\n**步骤 5：最终计算**\n\n对于每个测试用例 $(f, k)$，执行以上步骤。为给定的频率 $f$ 计算矩阵 $A$ 和矢量 $y_{\\text{true}}$。执行 SVD。使用截断水平 $k$ 计算偏差范数 $\\|b_{\\text{TSVD}}\\|_2$。通过求解 $\\mathrm{edf}$ 等式找到 Tikhonov 方法对应的正则化参数 $\\lambda$，然后计算 $\\|b_{\\text{Tikhonov}}\\|_2$。最后，存储差值 $\\Delta = \\|b_{\\text{Tikhonov}}\\|_2 - \\|b_{\\text{TSVD}}\\|_2$。程序输出所有测试用例的这些差值。",
            "answer": "$$\n\\boxed{[-0.000100414777, -0.001646736785, -0.000000003932, -0.000114002773]}\n$$"
        }
    ]
}