{
    "hands_on_practices": [
        {
            "introduction": "The accuracy of a finite difference scheme is paramount for reliable simulations, and this accuracy is determined by the stencil coefficients. This first practice provides a foundational exercise in deriving these coefficients from first principles using Taylor series expansions. By determining the stencils for both a high-order central scheme and a one-sided boundary scheme, you will master the core technique for constructing custom finite difference operators and perform a dispersion analysis to quantify their wave propagation error .",
            "id": "4124043",
            "problem": "Consider one-dimensional linear acoustics in a homogeneous medium, described by the linearized Euler system $u_{t} + \\frac{1}{\\rho_{0}} p_{x} = 0$ and $p_{t} + \\rho_{0} c^{2} u_{x} = 0$, where $p(x,t)$ is the acoustic pressure, $u(x,t)$ is the particle velocity, $c$ is the sound speed, and $\\rho_{0}$ is the ambient density. On a uniform spatial grid $x_{i} = i h$ with grid spacing $h$, suppose one wishes to construct high-order finite difference approximations to the spatial derivative operator for use in a semi-discrete formulation of these equations.\n\nAt interior points, consider a symmetric central finite difference approximation to the first derivative, parameterized by three unknown coefficients $a_{1}, a_{2}, a_{3}$:\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\left[ a_{1}\\left(f_{i+1} - f_{i-1}\\right) + a_{2}\\left(f_{i+2} - f_{i-2}\\right) + a_{3}\\left(f_{i+3} - f_{i-3}\\right) \\right].\n$$\nAt the left boundary $x_{0} = 0$, consider a one-sided forward finite difference approximation using five nodes with unknown coefficients $b_{0}, b_{1}, b_{2}, b_{3}, b_{4}$:\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\left[ b_{0} f_{0} + b_{1} f_{1} + b_{2} f_{2} + b_{3} f_{3} + b_{4} f_{4} \\right].\n$$\n\nStarting only from Taylor series expansions about $x_{i}$ and the plane-wave ansatz $f(x) = \\exp(i k x)$, derive the following:\n\n1. The coefficients $a_{1}, a_{2}, a_{3}$ such that $(\\mathcal{D}_{c} f)_{i}$ is a sixth-order accurate approximation to $f'(x_{i})$, meaning the truncation error is $\\mathcal{O}(h^{6})$.\n2. The leading-order dispersion-truncation coefficient $\\gamma$ for the central operator, defined by the small-$k h$ expansion of the effective wavenumber $k_{\\mathrm{eff}}$ obtained by applying $\\mathcal{D}_{c}$ to the Fourier mode $f_{i} = \\exp(i k x_{i})$, namely\n$$\nk_{\\mathrm{eff}} = k - \\gamma \\, k^{7} h^{6} + \\mathcal{O}(k^{9} h^{8}).\n$$\nExpress $\\gamma$ in closed form as a real constant.\n3. The coefficients $b_{0}, b_{1}, b_{2}, b_{3}, b_{4}$ such that $(\\mathcal{D}_{f} f)_{0}$ is a fourth-order accurate approximation to $f'(x_{0})$, meaning the truncation error is $\\mathcal{O}(h^{4})$.\n\nProvide your final answer as a single row matrix containing, in order, the entries $(a_{1}, a_{2}, a_{3}, \\gamma, b_{0}, b_{1}, b_{2}, b_{3}, b_{4})$. No rounding is required, and all coefficients should be expressed as exact rational numbers. The final answer is dimensionless and requires no units.",
            "solution": "The problem is well-posed and scientifically sound, representing a standard task in the development of numerical methods for partial differential equations. We are asked to derive coefficients for finite difference schemes by enforcing accuracy constraints via Taylor series analysis, and to perform a dispersion analysis on the resulting scheme.\n\nThe problem is divided into three parts. We will address each in sequence.\n\nPart 1: Determination of coefficients for a sixth-order central difference scheme.\n\nWe are given the symmetric central difference operator for the first derivative $f'(x_i)$:\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\left[ a_{1}\\left(f_{i+1} - f_{i-1}\\right) + a_{2}\\left(f_{i+2} - f_{i-2}\\right) + a_{3}\\left(f_{i+3} - f_{i-3}\\right) \\right]\n$$\nTo determine the coefficients $a_1, a_2, a_3$, we expand the function values $f_{i \\pm j} = f(x_i \\pm jh)$ in a Taylor series around $x_i$.\n$$\nf(x_i \\pm jh) = f(x_i) \\pm (jh)f'(x_i) + \\frac{(jh)^2}{2!}f''(x_i) \\pm \\frac{(jh)^3}{3!}f'''(x_i) + \\dots\n$$\nThe difference $f_{i+j} - f_{i-j}$ is given by:\n$$\nf_{i+j} - f_{i-j} = 2jh f'_{i} + 2\\frac{(jh)^3}{3!} f'''_{i} + 2\\frac{(jh)^5}{5!} f^{(5)}_{i} + 2\\frac{(jh)^7}{7!} f^{(7)}_{i} + \\mathcal{O}(h^9)\n$$\nwhere $f_i^{(n)} = f^{(n)}(x_i)$. Substituting this into the operator expression for $j = 1, 2, 3$:\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\sum_{j=1}^{3} a_j \\left( 2jh f'_{i} + \\frac{j^3h^3}{3} f'''_{i} + \\frac{j^5h^5}{60} f^{(5)}_{i} + \\frac{j^7h^7}{2520} f^{(7)}_{i} + \\dots \\right)\n$$\nWe group the terms by the order of the derivative of $f$:\n$$\n(\\mathcal{D}_{c} f)_{i} = \\left(2 \\sum_{j=1}^{3} j a_j\\right) f'_{i} + h^2 \\left(\\frac{1}{3} \\sum_{j=1}^{3} j^3 a_j\\right) f'''_{i} + h^4 \\left(\\frac{1}{60} \\sum_{j=1}^{3} j^5 a_j\\right) f^{(5)}_{i} + h^6 \\left(\\frac{1}{2520} \\sum_{j=1}^{3} j^7 a_j\\right) f^{(7)}_{i} + \\dots\n$$\nFor this operator to be an approximation of $f'_{i}$, the coefficient of $f'_{i}$ must be $1$. For it to be sixth-order accurate, the truncation error must be $\\mathcal{O}(h^6)$, which means the coefficients of the $h^2 f'''_i$ and $h^4 f^{(5)}_i$ terms must be zero. This yields a system of three linear equations for $a_1, a_2, a_3$:\n1. $2(a_1 + 2a_2 + 3a_3) = 1 \\implies a_1 + 2a_2 + 3a_3 = \\frac{1}{2}$\n2. $\\frac{1}{3}(a_1 + 8a_2 + 27a_3) = 0 \\implies a_1 + 8a_2 + 27a_3 = 0$\n3. $\\frac{1}{60}(a_1 + 32a_2 + 243a_3) = 0 \\implies a_1 + 32a_2 + 243a_3 = 0$\n\nWe solve this system. Subtracting the second equation from the third:\n$(a_1 + 32a_2 + 243a_3) - (a_1 + 8a_2 + 27a_3) = 0 \\implies 24a_2 + 216a_3 = 0 \\implies a_2 = -9a_3$.\nSubstitute $a_2 = -9a_3$ into the second equation:\n$a_1 + 8(-9a_3) + 27a_3 = 0 \\implies a_1 - 72a_3 + 27a_3 = 0 \\implies a_1 = 45a_3$.\nNow substitute both $a_1$ and $a_2$ into the first equation:\n$45a_3 + 2(-9a_3) + 3a_3 = \\frac{1}{2} \\implies 45a_3 - 18a_3 + 3a_3 = \\frac{1}{2} \\implies 30a_3 = \\frac{1}{2} \\implies a_3 = \\frac{1}{60}$.\nFrom this, we find $a_1$ and $a_2$:\n$a_1 = 45 \\left(\\frac{1}{60}\\right) = \\frac{45}{60} = \\frac{3}{4}$.\n$a_2 = -9 \\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20}$.\nThe coefficients are $a_1 = \\frac{3}{4}$, $a_2 = -\\frac{3}{20}$, and $a_3 = \\frac{1}{60}$.\n\nPart 2: Determination of the dispersion coefficient $\\gamma$.\n\nWe apply the operator $\\mathcal{D}_c$ to the plane-wave ansatz $f_j = f(x_j) = \\exp(ikx_j)$. The exact derivative is $f'(x_j) = ik \\exp(ikx_j) = ik f_j$. The numerical derivative is defined by $(\\mathcal{D}_c f)_j = ik_{\\mathrm{eff}} f_j$.\n$$\nf_{j+m} - f_{j-m} = \\exp(ik(x_j+mh)) - \\exp(ik(x_j-mh)) = \\exp(ikx_j) (\\exp(ikmh) - \\exp(-ikmh)) = f_j (2i \\sin(kmh))\n$$\nSubstituting this into the definition of $\\mathcal{D}_c$:\n$$\n(\\mathcal D_c f)_j = \\frac{1}{h} \\sum_{m=1}^{3} a_m (f_{j+m} - f_{j-m}) = \\frac{1}{h} \\sum_{m=1}^{3} a_m (2i \\sin(kmh)) f_j = \\frac{2i}{h} \\left( \\sum_{m=1}^{3} a_m \\sin(kmh) \\right) f_j\n$$\nComparing with $(\\mathcal{D}_c f)_j = ik_{\\mathrm{eff}} f_j$, we find the effective wavenumber $k_{\\mathrm{eff}}$:\n$$\nk_{\\mathrm{eff}} = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(kmh)\n$$\nWe expand $\\sin(kmh)$ for small $kh$:\n$$\n\\sin(kmh) = (kmh) - \\frac{(kmh)^3}{3!} + \\frac{(kmh)^5}{5!} - \\frac{(kmh)^7}{7!} + \\mathcal{O}((kh)^9)\n$$\nSubstituting this into the expression for $k_{\\mathrm{eff}}$:\n$$\nk_{\\mathrm{eff}} = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\left( kmh - \\frac{k^3m^3h^3}{6} + \\frac{k^5m^5h^5}{120} - \\frac{k^7m^7h^7}{5040} + \\dots \\right)\n$$\n$$\nk_{\\mathrm{eff}} = k \\left(2\\sum m a_m\\right) - k^3h^2 \\left(\\frac{1}{3}\\sum m^3 a_m\\right) + k^5h^4 \\left(\\frac{1}{60}\\sum m^5 a_m\\right) - k^7h^6 \\left(\\frac{1}{2520}\\sum m^7 a_m\\right) + \\dots\n$$\nFrom the constraints derived in Part 1, we know:\n$2\\sum m a_m = 1$\n$\\sum m^3 a_m = 0$\n$\\sum m^5 a_m = 0$\nThe expression for $k_{\\mathrm{eff}}$ simplifies to:\n$$\nk_{\\mathrm{eff}} = k - \\frac{k^7 h^6}{2520} \\left( \\sum_{m=1}^{3} m^7 a_m \\right) + \\mathcal{O}(k^9h^8)\n$$\nComparing this with the given form $k_{\\mathrm{eff}} = k - \\gamma k^7 h^6 + \\mathcal{O}(k^9h^8)$, we identify $\\gamma$ as:\n$$\n\\gamma = \\frac{1}{2520} \\sum_{m=1}^{3} m^7 a_m = \\frac{1}{2520} (1^7 a_1 + 2^7 a_2 + 3^7 a_3)\n$$\nSubstitute the values of $a_1, a_2, a_3$:\n$$\n\\sum m^7 a_m = (1)\\left(\\frac{3}{4}\\right) + (128)\\left(-\\frac{3}{20}\\right) + (2187)\\left(\\frac{1}{60}\\right) = \\frac{3}{4} - \\frac{384}{20} + \\frac{2187}{60}\n$$\nUsing a common denominator of $60$:\n$$\n\\frac{45}{60} - \\frac{1152}{60} + \\frac{2187}{60} = \\frac{45 - 1152 + 2187}{60} = \\frac{1080}{60} = 18\n$$\nThus, $\\gamma = \\frac{18}{2520}$. Simplifying the fraction:\n$$\n\\gamma = \\frac{18}{2520} = \\frac{1}{140}\n$$\n\nPart 3: Determination of coefficients for a fourth-order forward difference scheme.\n\nWe are given the one-sided forward difference operator:\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\left[ b_{0} f_{0} + b_{1} f_{1} + b_{2} f_{2} + b_{3} f_{3} + b_{4} f_{4} \\right]\n$$\nWe expand $f_j = f(x_j) = f(x_0+jh)$ in a Taylor series about $x_0$:\n$$\nf_j = f_0 + (jh)f'_0 + \\frac{(jh)^2}{2!}f''_0 + \\frac{(jh)^3}{3!}f'''_0 + \\frac{(jh)^4}{4!}f^{(4)}_0 + \\mathcal{O}(h^5)\n$$\nSubstituting this into the operator:\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\sum_{j=0}^{4} b_j \\left(f_0 + (jh)f'_0 + \\frac{j^2h^2}{2}f''_0 + \\dots \\right) = \\left(\\frac{1}{h}\\sum b_j \\right)f_0 + \\left(\\sum j b_j \\right)f'_0 + h\\left(\\frac{1}{2}\\sum j^2 b_j \\right)f''_0 + \\dots\n$$\nFor fourth-order accuracy in approximating $f'_0$, the first five terms must match the Taylor expansion of $f'_0$. This leads to a system of $5$ linear equations for $b_0, \\dots, b_4$:\n1. $\\sum_{j=0}^{4} b_j = 0$\n2. $\\sum_{j=0}^{4} j b_j = 1$\n3. $\\sum_{j=0}^{4} j^2 b_j = 0$\n4. $\\sum_{j=0}^{4} j^3 b_j = 0$\n5. $\\sum_{j=0}^{4} j^4 b_j = 0$\n\nThis Vandermonde-type system can be solved directly. Alternatively, we can use the method of undetermined coefficients based on the forward difference operator $\\Delta_h f(x) = f(x+h) - f(x)$. The derivative operator can be expressed as $D = \\frac{1}{h}\\ln(E) = \\frac{1}{h}\\ln(1+\\Delta_h)$, where $E$ is the shift operator.\n$$\nf'(x_0) = \\frac{1}{h} \\left(\\Delta_h - \\frac{\\Delta_h^2}{2} + \\frac{\\Delta_h^3}{3} - \\frac{\\Delta_h^4}{4} + \\dots \\right) f(x_0)\n$$\nTruncating at the $\\mathcal{O}(h^4)$ term, we have the approximation for $h f'_0$:\n$$\nh f'_0 \\approx \\Delta_h f_0 - \\frac{1}{2}\\Delta_h^2 f_0 + \\frac{1}{3}\\Delta_h^3 f_0 - \\frac{1}{4}\\Delta_h^4 f_0\n$$\nWe express the powers of $\\Delta_h$ in terms of function values $f_j$:\n$\\Delta_h f_0 = f_1 - f_0$\n$\\Delta_h^2 f_0 = f_2 - 2f_1 + f_0$\n$\\Delta_h^3 f_0 = f_3 - 3f_2 + 3f_1 - f_0$\n$\\Delta_h^4 f_0 = f_4 - 4f_3 + 6f_2 - 4f_1 + f_0$\nSubstituting these into the approximation for $h f'_0$:\n$$\nh f'_0 \\approx (f_1-f_0) - \\frac{1}{2}(f_2-2f_1+f_0) + \\frac{1}{3}(f_3-3f_2+3f_1-f_0) - \\frac{1}{4}(f_4-4f_3+6f_2-4f_1+f_0)\n$$\nCollecting coefficients for each $f_j$:\n$b_0$: $-1 - \\frac{1}{2} - \\frac{1}{3} - \\frac{1}{4} = -\\frac{12+6+4+3}{12} = -\\frac{25}{12}$\n$b_1$: $1 - \\frac{1}{2}(-2) + \\frac{1}{3}(3) - \\frac{1}{4}(-4) = 1+1+1+1=4$\n$b_2$: $-\\frac{1}{2}(1) + \\frac{1}{3}(-3) - \\frac{1}{4}(6) = -\\frac{1}{2} - 1 - \\frac{3}{2} = -3$\n$b_3$: $\\frac{1}{3}(1) - \\frac{1}{4}(-4) = \\frac{1}{3} + 1 = \\frac{4}{3}$\n$b_4$: $-\\frac{1}{4}(1) = -\\frac{1}{4}$\nSo, the coefficients are $b_0 = -\\frac{25}{12}$, $b_1 = 4$, $b_2 = -3$, $b_3 = \\frac{4}{3}$, $b_4 = -\\frac{1}{4}$. These coefficients satisfy the system of linear equations derived earlier.\n\nThe final result is the collection of all derived coefficients.\n$a_1 = \\frac{3}{4}$, $a_2 = -\\frac{3}{20}$, $a_3 = \\frac{1}{60}$\n$\\gamma = \\frac{1}{140}$\n$b_0 = -\\frac{25}{12}$, $b_1 = 4$, $b_2 = -3$, $b_3 = \\frac{4}{3}$, $b_4 = -\\frac{1}{4}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{4} & -\\frac{3}{20} & \\frac{1}{60} & \\frac{1}{140} & -\\frac{25}{12} & 4 & -3 & \\frac{4}{3} & -\\frac{1}{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once a finite difference stencil is chosen, it is assembled into a global operator matrix that acts on the entire solution domain. The properties of this matrix, which stem directly from the stencil's design, dictate the behavior of the numerical solution. This hands-on coding exercise challenges you to construct and analyze discrete Helmholtz operators, exploring crucial properties like symmetry, dispersion error, and artificial dissipation for different schemes, thereby revealing the profound impact of stencil choice on simulation fidelity .",
            "id": "4124030",
            "problem": "Consider the one-dimensional time-harmonic acoustic pressure governed by the Helmholtz equation on a periodic domain. The continuous equation is\n$$\\frac{d^2 u}{dx^2} + k^2 u = f,$$\nposed on the interval $[0,L]$ with periodic boundary conditions and a spatially homogeneous medium. Here $u$ is the acoustic pressure amplitude, $k$ is the real wavenumber in radians per meter, and $f$ is a source term. In computational acoustics, the discrete Helmholtz operator is formed by approximating the spatial second derivative with finite differences on a uniform grid of $N$ points with spacing $h = L/N$.\n\nYour task is to derive, implement, and analyze three discrete Helmholtz operators corresponding to the following finite-difference schemes for approximating the second derivative:\n- The forward-forward scheme: use the forward difference for the first derivative and apply it again to approximate the second derivative.\n- The backward-backward scheme: use the backward difference for the first derivative and apply it again to approximate the second derivative.\n- The central scheme: directly use the standard three-point centered second difference.\n\nLet the grid points be $x_j = j h$ for $j = 0,1,\\dots,N-1$, with periodic indexing. For each scheme, form the $N \\times N$ circulant matrix $A$ over $\\mathbb{R}$ that implements the discrete operator $d^2/dx^2 + k^2$ on this grid with periodic boundary conditions. For example, applying $A$ to a grid function $u$ must produce (componentwise) the discrete second derivative of $u$ according to the chosen scheme plus the term $k^2 u$.\n\nStarting from the finite-difference definitions of the forward difference, backward difference, and centered difference, derive the discrete stencils for each scheme and assemble the corresponding circulant matrix $A$ using only the uniform step $h$, the length $L$, and the number of points $N$. For the forward-forward and backward-backward schemes, the second derivative approximation must be formed by applying the same one-sided first-difference operator twice. For the central scheme, use the standard three-point centered stencil.\n\nThen, for each resulting matrix $A$:\n1. Determine if $A$ is symmetric by checking whether $A = A^\\top$ within a small numerical tolerance.\n2. Quantify the dispersion error of the scheme by comparing the discrete eigenvalues of $A$ with the continuous eigenvalues of the Helmholtz operator for the periodic Fourier modes. On the periodic grid, the mode with index $m$ has wavenumber $q_m = 2\\pi m / L$ (in radians per meter). The corresponding continuous eigenvalue is $k^2 - q_m^2$. The discrete eigenvalue for mode $m$ can be obtained by applying $A$ to the discrete Fourier mode vector $v^{(m)}$ defined by $v^{(m)}_j = \\exp(i q_m x_j)$ and taking the Rayleigh quotient $\\lambda_m = \\frac{\\langle v^{(m)}, A v^{(m)}\\rangle}{\\langle v^{(m)}, v^{(m)}\\rangle}$, where $\\langle \\cdot, \\cdot \\rangle$ is the complex inner product. Define the relative dispersion error for mode $m$ by\n$$\\delta_m = \\frac{\\left|\\operatorname{Re}(\\lambda_m) - (k^2 - q_m^2)\\right|}{\\max\\left(10^{-12}, \\left|k^2 - q_m^2\\right|\\right)}.$$\nReport the maximum of $\\delta_m$ over $m = 1,2,\\dots,N-1$. Angles and wavenumbers must be treated in radians.\n3. Assess the positive definiteness of the symmetric part $S = \\frac{1}{2}(A + A^\\top)$ by checking whether all eigenvalues of $S$ are strictly greater than $0$.\n4. Report the maximum absolute value of the imaginary part $\\max_{m} |\\operatorname{Im}(\\lambda_m)|$ over $m = 1,2,\\dots,N-1$.\n\nUse the following test suite with scientifically consistent parameters:\n- Test case $1$: central scheme, $N = 32$, $L = 1$ meter, $k = 70$ radians per meter.\n- Test case $2$: central scheme, $N = 32$, $L = 1$ meter, $k = 64$ radians per meter. This case probes the boundary where the smallest discrete Laplacian eigenvalue magnitude equals $k^2$.\n- Test case $3$: forward-forward scheme, $N = 64$, $L = 1$ meter, $k = 30$ radians per meter.\n- Test case $4$: backward-backward scheme, $N = 64$, $L = 1$ meter, $k = 30$ radians per meter.\n\nFor each test case, your program must output a list with four entries:\n- A boolean indicating whether $A$ is symmetric.\n- A float equal to the maximum relative dispersion error rounded to $6$ decimal places.\n- A boolean indicating whether $S$ is strictly positive definite.\n- A float equal to the maximum absolute imaginary part of the discrete eigenvalues rounded to $6$ decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the same format. For example, the output format must be\n$$[ [\\text{bool}, \\text{float}, \\text{bool}, \\text{float}], [\\text{bool}, \\text{float}, \\text{bool}, \\text{float}], \\dots ].$$\nAll physical quantities must be expressed in meters and seconds where relevant, and angular quantities in radians. No percentage signs are permitted; all ratios must be decimals. Round all floats to $6$ decimal places in the final output.",
            "solution": "The problem requires the derivation, implementation, and analysis of three finite-difference schemes for the one-dimensional Helmholtz equation, $\\frac{d^2 u}{dx^2} + k^2 u = f$, on a periodic domain $[0, L]$. The analysis is to be performed on the discrete Helmholtz operator matrix $A$ for a uniform grid of $N$ points with spacing $h = L/N$. The grid points are $x_j = j h$ for $j=0, 1, \\dots, N-1$.\n\nFirst, we define the fundamental finite-difference operators. For a grid function $u$ with components $u_j = u(x_j)$, the forward and backward difference operators are, respectively:\n$$ (\\Delta_+ u)_j = \\frac{u_{j+1} - u_j}{h} $$\n$$ (\\Delta_- u)_j = \\frac{u_j - u_{j-1}}{h} $$\nAll indices are taken modulo $N$ to enforce periodicity.\n\nThe task is to construct the discrete Helmholtz operator $A$ corresponding to $\\frac{d^2}{dx^2} + k^2$ for three schemes and analyze its properties. The matrix $A$ must be circulant due to the spatial homogeneity and periodic boundary conditions. A circulant matrix is fully defined by its first row, say $(c_0, c_1, \\dots, c_{N-1})$.\n\n### Part 1: Derivation of Discrete Operators\n\n**1. Central Scheme**\nThe standard three-point central difference approximation for the second derivative at grid point $j$ is:\n$$ \\left(\\frac{d^2 u}{dx^2}\\right)_j \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} $$\nThe discrete Helmholtz operator applied to $u$ at point $j$ is:\n$$ (A_C u)_j = \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} + k^2 u_j = \\frac{1}{h^2}u_{j-1} + \\left(k^2 - \\frac{2}{h^2}\\right)u_j + \\frac{1}{h^2}u_{j+1} $$\nThis corresponds to a circulant matrix $A_C$ whose non-zero entries in the first row ($j=0$) are:\n- $c_0 = k^2 - 2/h^2$\n- $c_1 = 1/h^2$\n- $c_{N-1} = 1/h^2$ (due to periodicity, $u_{-1} \\equiv u_{N-1}$)\n\n**2. Forward-Forward Scheme**\nThis scheme is derived by applying the forward difference operator $\\Delta_+$ twice:\n$$ \\left(\\frac{d^2 u}{dx^2}\\right)_j \\approx \\Delta_+ (\\Delta_+ u)_j = \\frac{(\\Delta_+ u)_{j+1} - (\\Delta_+ u)_j}{h} = \\frac{1}{h}\\left(\\frac{u_{j+2}-u_{j+1}}{h} - \\frac{u_{j+1}-u_j}{h}\\right) = \\frac{u_{j+2} - 2u_{j+1} + u_j}{h^2} $$\nThe discrete Helmholtz operator is:\n$$ (A_{FF} u)_j = \\frac{u_j - 2u_{j+1} + u_{j+2}}{h^2} + k^2 u_j = \\left(k^2 + \\frac{1}{h^2}\\right)u_j - \\frac{2}{h^2}u_{j+1} + \\frac{1}{h^2}u_{j+2} $$\nThe first row of the circulant matrix $A_{FF}$ has non-zero entries:\n- $c_0 = k^2 + 1/h^2$\n- $c_1 = -2/h^2$\n- $c_2 = 1/h^2$\n\n**3. Backward-Backward Scheme**\nThis scheme is derived by applying the backward difference operator $\\Delta_-$ twice:\n$$ \\left(\\frac{d^2 u}{dx^2}\\right)_j \\approx \\Delta_- (\\Delta_- u)_j = \\frac{(\\Delta_- u)_j - (\\Delta_- u)_{j-1}}{h} = \\frac{1}{h}\\left(\\frac{u_j-u_{j-1}}{h} - \\frac{u_{j-1}-u_{j-2}}{h}\\right) = \\frac{u_j - 2u_{j-1} + u_{j-2}}{h^2} $$\nThe discrete Helmholtz operator is:\n$$ (A_{BB} u)_j = \\frac{u_j - 2u_{j-1} + u_{j-2}}{h^2} + k^2 u_j = \\frac{1}{h^2}u_{j-2} - \\frac{2}{h^2}u_{j-1} + \\left(k^2 + \\frac{1}{h^2}\\right)u_j $$\nThe first row of the circulant matrix $A_{BB}$ has non-zero entries:\n- $c_0 = k^2 + 1/h^2$\n- $c_{N-2} = 1/h^2$\n- $c_{N-1} = -2/h^2$\n\n### Part 2: Eigenvalue Analysis\n\nThe eigenvectors of an $N \\times N$ circulant matrix are the discrete Fourier modes $v^{(m)}$ with components $v^{(m)}_j = \\exp(i 2\\pi m j / N)$. The problem defines the modes using the physical grid: $v^{(m)}_j = \\exp(i q_m x_j) = \\exp(i (2\\pi m/L)(jh)) = \\exp(i (2\\pi m / L)(j L/N)) = \\exp(i 2\\pi mj/N)$, which is identical.\nThe eigenvalue $\\lambda_m$ corresponding to the eigenvector $v^{(m)}$ for a circulant matrix with first row $(c_0, c_1, \\dots, c_{N-1})$ is given by:\n$$ \\lambda_m = \\sum_{j=0}^{N-1} c_j \\exp(i 2\\pi mj / N) = \\sum_{j=0}^{N-1} c_j \\omega^{mj} \\quad \\text{where} \\quad \\omega = e^{i 2\\pi/N} $$\n\n**1. Central Scheme Eigenvalues**\nWith $c_0 = k^2-2/h^2, c_1=1/h^2, c_{N-1}=1/h^2$:\n$$ \\lambda_m = (k^2 - 2/h^2) + (1/h^2)\\omega^m + (1/h^2)\\omega^{m(N-1)} = k^2 - 2/h^2 + (1/h^2)(\\omega^m + \\omega^{-m}) $$\n$$ \\lambda_m = k^2 - \\frac{2}{h^2} + \\frac{2}{h^2}\\cos(2\\pi m/N) = k^2 + \\frac{2}{h^2}(\\cos(2\\pi m/N)-1) = k^2 - \\frac{4}{h^2}\\sin^2(\\pi m/N) $$\nThese eigenvalues are purely real.\n\n**2. Forward-Forward Scheme Eigenvalues**\nWith $c_0 = k^2+1/h^2, c_1=-2/h^2, c_2=1/h^2$:\n$$ \\lambda_m = (k^2+1/h^2) - (2/h^2)\\omega^m + (1/h^2)\\omega^{2m} = k^2 + \\frac{1}{h^2}(1 - 2\\omega^m + \\omega^{2m}) = k^2 + \\frac{1}{h^2}(1-\\omega^m)^2 $$\nUsing $1 - e^{i\\theta} = e^{i\\theta/2}(-2i\\sin(\\theta/2))$, we get $(1-\\omega^m)^2 = (e^{i\\pi m/N}(-2i\\sin(\\pi m/N)))^2 = e^{i2\\pi m/N}(-4\\sin^2(\\pi m/N))$.\n$$ \\lambda_m = k^2 - \\frac{4}{h^2}\\sin^2(\\pi m/N) \\cdot \\omega^m = k^2 - \\frac{4}{h^2}\\sin^2(\\pi m/N)(\\cos(2\\pi m/N) + i\\sin(2\\pi m/N)) $$\n\n**3. Backward-Backward Scheme Eigenvalues**\nWith $c_0 = k^2+1/h^2, c_{N-2}=1/h^2, c_{N-1}=-2/h^2$:\n$$ \\lambda_m = (k^2+1/h^2) + (1/h^2)\\omega^{m(N-2)} - (2/h^2)\\omega^{m(N-1)} = k^2 + \\frac{1}{h^2}(1+\\omega^{-2m}-2\\omega^{-m}) = k^2 + \\frac{1}{h^2}(1-\\omega^{-m})^2 $$\n$$ \\lambda_m = k^2 - \\frac{4}{h^2}\\sin^2(\\pi m/N) \\cdot \\omega^{-m} = k^2 - \\frac{4}{h^2}\\sin^2(\\pi m/N)(\\cos(2\\pi m/N) - i\\sin(2\\pi m/N)) $$\nThe eigenvalues are complex conjugates of those from the forward-forward scheme.\n\n### Part 3: Matrix Properties Analysis\n\n**1. Symmetry**\n- A matrix $A$ is symmetric if $A=A^\\top$.\n- For the central scheme, the first row $(c_0, c_1, 0, \\dots, 0, c_1)$ shows $c_j = c_{N-j}$ for $j=1,\\dots,N-1$. A circulant matrix with this property is symmetric. Thus, $A_C$ is symmetric.\n- For the forward-forward scheme, the first row is $(c_0, c_1, c_2, 0, \\dots)$. $c_1 \\neq 0$ but $c_{N-1}=0$. The matrix $A_{FF}$ is not symmetric for $N>2$.\n- Similarly, for the backward-backward scheme, $c_{N-1} \\neq 0$ but $c_1=0$, so $A_{BB}$ is not symmetric for $N>2$. In fact, $A_{BB} = A_{FF}^\\top$.\n\n**2. Dispersion Error**\nThe continuous operator $\\frac{d^2}{dx^2}+k^2$ has eigenvalues $k^2 - q_m^2$ for the Fourier modes $\\exp(iq_m x)$, where the continuous wavenumber is $q_m = 2\\pi m/L$. The relative dispersion error for mode $m$ is:\n$$ \\delta_m = \\frac{\\left|\\operatorname{Re}(\\lambda_m) - (k^2 - q_m^2)\\right|}{\\max\\left(10^{-12}, \\left|k^2 - q_m^2\\right|\\right)} $$\nWe compute this for $m=1, \\dots, N-1$ and find the maximum.\n\n**3. Positive Definiteness of Symmetric Part**\nWe analyze the symmetric part $S = \\frac{1}{2}(A + A^\\top)$. A matrix is strictly positive definite if all its eigenvalues are strictly greater than zero. Since $S$ is real and symmetric, its eigenvalues are real.\n- For the central scheme, $A_C$ is symmetric, so $S = A_C$. Its eigenvalues are $\\lambda_m = k^2 - \\frac{4}{h^2}\\sin^2(\\pi m/N)$. For positive definiteness, we need $\\lambda_m > 0$ for all $m=0, \\dots, N-1$. The minimum is for the largest $\\sin^2$ term, which occurs at $m=N/2$ (for even $N$), giving $\\lambda_{N/2} = k^2 - 4/h^2$. The condition is $k^2 > 4/h^2$.\n- For the non-symmetric schemes, $S = \\frac{1}{2}(A_{FF} + A_{BB})$. Since $A_{BB}$ is (related to) the transpose of $A_{FF}$, $S$ is the discrete operator for $\\frac{1}{2}(\\text{Laplacian}_{FF} + \\text{Laplacian}_{BB}) + k^2 I$.\n  $S_{jk}$ is symmetric and circulant. Its first row is $\\frac{1}{2}(c^{FF}+c^{BB})$.\n  $c_0^S = k^2+1/h^2$, $c_1^S = c_{N-1}^S = -1/h^2$, $c_2^S = c_{N-2}^S = 1/(2h^2)$.\n  The eigenvalues of $S$ are real:\n  $\\mu_m = (k^2+1/h^2) - (1/h^2)(\\omega^m+\\omega^{-m}) + \\frac{1}{2h^2}(\\omega^{2m}+\\omega^{-2m})$\n  $\\mu_m = k^2+1/h^2 - (2/h^2)\\cos(2\\pi m/N) + (1/h^2)\\cos(4\\pi m/N)$.\n  We must check if $\\mu_m > 0$ for all $m$.\n\n**4. Maximum Absolute Imaginary Part of Eigenvalues**\n- For the central scheme, eigenvalues $\\lambda_m$ are real, so this is $0$.\n- For the forward-forward scheme, $\\operatorname{Im}(\\lambda_m) = -\\frac{4}{h^2}\\sin^2(\\pi m/N)\\sin(2\\pi m/N)$.\n- For the backward-backward scheme, $\\operatorname{Im}(\\lambda_m) = +\\frac{4}{h^2}\\sin^2(\\pi m/N)\\sin(2\\pi m/N)$.\nIn both cases, we find the maximum of $|\\operatorname{Im}(\\lambda_m)|$ over $m=1, \\dots, N-1$.\nThis completes the theoretical framework for solving the problem. The implementation will perform these calculations for the specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import circulant\n\ndef solve():\n    \"\"\"\n    Solves the computational acoustics problem for the given test cases.\n\n    For each test case, the function:\n    1. Derives the discrete Helmholtz operator matrix A for the specified scheme.\n    2. Checks if A is symmetric.\n    3. Calculates the maximum relative dispersion error.\n    4. Assesses if the symmetric part of A is positive definite.\n    5. Determines the maximum absolute imaginary part of the discrete eigenvalues.\n    \"\"\"\n    test_cases = [\n        # scheme, N, L, k\n        (\"central\", 32, 1.0, 70.0),\n        (\"central\", 32, 1.0, 64.0),\n        (\"forward-forward\", 64, 1.0, 30.0),\n        (\"backward-backward\", 64, 1.0, 30.0),\n    ]\n\n    results = []\n    \n    # Small tolerance for floating point comparisons, especially for checking > 0.\n    TOL = 1e-12\n\n    for case in test_cases:\n        scheme, N, L, k = case\n        h = L / N\n        h2 = h**2\n\n        # 1. Assemble the circulant matrix A\n        # The matrix A is circulant, so it's defined by its first row.\n        c = np.zeros(N, dtype=np.float64)\n        if scheme == \"central\":\n            # Stencil: (u_{j-1} - 2u_j + u_{j+1}) / h^2 + k^2 u_j\n            # First row of matrix a_C:\n            # c[0] = k^2 - 2/h^2\n            # c[1] = 1/h^2\n            # c[N-1] = 1/h^2\n            c[0] = k**2 - 2.0 / h2\n            c[1] = 1.0 / h2\n            c[N-1] = 1.0 / h2\n        elif scheme == \"forward-forward\":\n            # Stencil: (u_j - 2u_{j+1} + u_{j+2}) / h^2 + k^2 u_j\n            # First row of matrix A_FF:\n            # c[0] = k^2 + 1/h^2\n            # c[1] = -2/h^2\n            # c[2] = 1/h^2\n            c[0] = k**2 + 1.0 / h2\n            c[1] = -2.0 / h2\n            c[2] = 1.0 / h2\n        elif scheme == \"backward-backward\":\n            # Stencil: (u_j - 2u_{j-1} + u_{j-2}) / h^2 + k^2 u_j\n            # First row of matrix A_BB:\n            # c[0] = k^2 + 1/h^2\n            # c[N-1] = -2/h^2\n            # c[N-2] = 1/h^2\n            c[0] = k**2 + 1.0 / h2\n            c[N-1] = -2.0 / h2\n            c[N-2] = 1.0 / h2\n        \n        A = circulant(c)\n\n        # Analysis Step 1: Check for symmetry\n        is_symmetric = np.allclose(A, A.T, atol=TOL)\n\n        # Analysis Step 2, 4: Dispersion error and imaginary part of eigenvalues\n        # We can use the analytical formulas for the eigenvalues of circulant matrices,\n        # which is more precise than numerical eigenvector calculations.\n        m = np.arange(1, N) # Modes m=1, ..., N-1\n        \n        # Continuous eigenvalues\n        q_m = 2.0 * np.pi * m / L\n        E_continuous = k**2 - q_m**2\n\n        # Discrete eigenvalues\n        if scheme == \"central\":\n            # lambda_m = k^2 - (4/h^2) * sin^2(pi*m/N)\n            lambda_m = k**2 - (4.0 / h2) * np.sin(np.pi * m / N)**2\n            lambda_m = lambda_m.astype(np.complex128) # ensure complex type for consistency\n        else:\n            # Common term for FF and BB schemes\n            common_term = -(4.0 / h2) * np.sin(np.pi * m / N)**2\n            omega_m = np.exp(1j * 2.0 * np.pi * m / N)\n            if scheme == \"forward-forward\":\n                # lambda_m = k^2 - (4/h^2) * sin^2(pi*m/N) * omega^m\n                lambda_m = k**2 + common_term * omega_m\n            elif scheme == \"backward-backward\":\n                # lambda_m = k^2 - (4/h^2) * sin^2(pi*m/N) * omega^(-m)\n                lambda_m = k**2 + common_term * np.conj(omega_m)\n\n        # Relative dispersion error\n        numerator = np.abs(np.real(lambda_m) - E_continuous)\n        denominator = np.maximum(TOL, np.abs(E_continuous))\n        rel_disp_error = numerator / denominator\n        max_disp_err = np.max(rel_disp_error)\n\n        # Maximum absolute imaginary part of eigenvalues\n        max_imag_eig = np.max(np.abs(np.imag(lambda_m)))\n\n        # Analysis Step 3: Check for positive definiteness of the symmetric part S\n        S = 0.5 * (A + A.T)\n        # For a real symmetric matrix, we can use eigvalsh for efficiency\n        eigvals_S = np.linalg.eigvalsh(S)\n        is_pd = np.all(eigvals_S > TOL)\n\n        # Collect results for this test case\n        results.append([\n            is_symmetric,\n            round(max_disp_err, 6),\n            is_pd,\n            round(max_imag_eig, 6)\n        ])\n\n    # Final print statement in the exact required format\n    # Custom formatting to match bool lowercase requirement of example [[bool, float, bool, float]]\n    formatted_results = []\n    for res_list in results:\n        # Convert boolean to lowercase string\n        str_res = [str(x).lower() if isinstance(x, bool) else str(x) for x in res_list]\n        formatted_results.append(f\"[{','.join(str_res)}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While high-order accuracy is a primary goal, numerical stability is a prerequisite for any useful simulation. Finite difference schemes can suffer from spurious, non-physical oscillations, especially at high wavenumbers, which must be controlled. This problem delves into the practical techniques of adding artificial viscosity and explicit filtering to dampen these grid-scale instabilities, requiring you to use Fourier analysis to derive a condition that balances these two dissipative effects for optimal performance .",
            "id": "4124045",
            "problem": "Consider one-dimensional small-amplitude acoustics in a uniform medium with constant mass density $\\rho_{0}$ and sound speed $c$, described by the linearized first-order system\n$$\np_{t} + \\rho_{0} c^{2} u_{x} = 0, \\qquad u_{t} + \\frac{1}{\\rho_{0}} p_{x} = 0,\n$$\nwhere $p(x,t)$ is acoustic pressure and $u(x,t)$ is particle velocity. Let the spatial domain be discretized on a uniform infinite grid $x_{j} = j \\,\\Delta x$ with grid index $j \\in \\mathbb{Z}$ and grid spacing $\\Delta x > 0$. Consider the explicit forward Euler time-stepping with time step $\\Delta t > 0$, and second-order central finite differences for spatial derivatives. To regularize grid-scale oscillations, augment the semi-discrete scheme with:\n- Artificial viscosity in the velocity equation, modeled as a Laplacian term $\\nu u_{xx}$ with viscosity coefficient $\\nu > 0$.\n- An explicit, symmetric linear filter applied to the pressure after each time update, defined by the discrete operator $p \\mapsto p + \\sigma \\,\\Delta x^{2} D_{xx} p$, where $D_{xx}$ is the second-order central second-difference operator and $\\sigma \\ge 0$ is a dimensionless filter strength.\n\nThe fully discrete update for one time step $t^{n} \\to t^{n+1} = t^{n} + \\Delta t$ is\n$$\np_{j}^{n+1,\\star} = p_{j}^{n} - \\Delta t \\,\\rho_{0} c^{2} \\,D_{x} u_{j}^{n}, \\qquad\nu_{j}^{n+1} = u_{j}^{n} - \\Delta t \\,\\frac{1}{\\rho_{0}} \\,D_{x} p_{j}^{n} + \\Delta t \\,\\nu \\,D_{xx} u_{j}^{n},\n$$\nfollowed by the pressure filter\n$$\np_{j}^{n+1} = p_{j}^{n+1,\\star} + \\sigma \\,\\Delta x^{2} \\,D_{xx} p_{j}^{n+1,\\star},\n$$\nwhere $D_{x} q_{j} = \\frac{q_{j+1} - q_{j-1}}{2 \\Delta x}$ and $D_{xx} q_{j} = \\frac{q_{j+1} - 2 q_{j} + q_{j-1}}{\\Delta x^{2}}$.\n\nPerform a normal-mode (Fourier) analysis of this scheme. Let a single Fourier mode with nondimensional wavenumber $\\kappa = k \\,\\Delta x$ be $q_{j}^{n} = \\widehat{q}^{n} \\exp(i \\kappa j)$, and consider specifically the grid-scale mode at the Nyquist wavenumber $\\kappa = \\pi$. For this mode, compute the one-step amplification factor for $p$ and the one-step amplification factor for $u$, and impose the design requirement that the per-step amplitude reduction of the grid-scale mode is equal for $p$ and $u$.\n\nDerive, in closed form, the filter strength $\\sigma$ expressed in terms of $\\nu$, $\\Delta t$, and $\\Delta x$ that enforces equal per-step damping of the grid-scale mode in both the pressure and velocity fields. Your final answer must be given as a single analytic expression. No rounding is required. Since $\\sigma$ is dimensionless, you do not need to specify units for the final answer.",
            "solution": "The user wants me to solve a problem from the field of computational acoustics. I will first validate the problem statement according to the user's instructions.\n\n### Step 1: Extract Givens\n- **Governing Equations**: Linearized first-order acoustics system: $p_{t} + \\rho_{0} c^{2} u_{x} = 0$, $u_{t} + \\frac{1}{\\rho_{0}} p_{x} = 0$.\n- **Constants**: Uniform medium with constant mass density $\\rho_{0}$ and sound speed $c$.\n- **Spatial Discretization**: Uniform infinite grid $x_{j} = j \\,\\Delta x$ with grid index $j \\in \\mathbb{Z}$ and grid spacing $\\Delta x > 0$.\n- **Temporal Discretization**: Explicit forward Euler time-stepping with time step $\\Delta t > 0$.\n- **Numerical Scheme Modifications**:\n    - Artificial viscosity in the velocity equation: a term $\\nu u_{xx}$ with viscosity coefficient $\\nu > 0$.\n    - Explicit linear filter for pressure: $p \\mapsto p + \\sigma \\,\\Delta x^{2} D_{xx} p$ with dimensionless filter strength $\\sigma \\ge 0$.\n- **Fully Discrete Update Equations**:\n    - Intermediate pressure update: $p_{j}^{n+1,\\star} = p_{j}^{n} - \\Delta t \\,\\rho_{0} c^{2} \\,D_{x} u_{j}^{n}$.\n    - Velocity update: $u_{j}^{n+1} = u_{j}^{n} - \\Delta t \\,\\frac{1}{\\rho_{0}} \\,D_{x} p_{j}^{n} + \\Delta t \\,\\nu \\,D_{xx} u_{j}^{n}$.\n    - Final pressure update (filtering step): $p_{j}^{n+1} = p_{j}^{n+1,\\star} + \\sigma \\,\\Delta x^{2} \\,D_{xx} p_{j}^{n+1,\\star}$.\n- **Finite Difference Operators**:\n    - Second-order central first derivative: $D_{x} q_{j} = \\frac{q_{j+1} - q_{j-1}}{2 \\Delta x}$.\n    - Second-order central second derivative: $D_{xx} q_{j} = \\frac{q_{j+1} - 2 q_{j} + q_{j-1}}{\\Delta x^{2}}$.\n- **Analysis Task**: Perform a normal-mode (Fourier) analysis for a single Fourier mode $q_{j}^{n} = \\widehat{q}^{n} \\exp(i \\kappa j)$, where $\\kappa = k \\,\\Delta x$ is the nondimensional wavenumber.\n- **Specific Case**: The grid-scale mode at the Nyquist wavenumber, $\\kappa = \\pi$.\n- **Design Requirement**: For the $\\kappa = \\pi$ mode, the per-step amplitude reduction is equal for $p$ and $u$.\n- **Objective**: Derive a closed-form expression for $\\sigma$ in terms of $\\nu$, $\\Delta t$, and $\\Delta x$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in the established theory of computational acoustics and numerical analysis. The governing equations represent linear acoustics. The numerical method (Forward Euler in time, central differences in space) is standard. The use of artificial viscosity and explicit filtering are common, practical techniques for stabilizing numerical schemes and damping spurious high-frequency oscillations. The analysis method (von Neumann or Fourier analysis) is the canonical approach for studying the stability and dissipative/dispersive properties of linear finite difference schemes.\n- **Well-Posed**: The problem is clearly defined. It provides all necessary equations and parameters to perform the analysis. The objective is to derive a specific relationship between parameters based on a clear and formalizable design criterion. a unique solution is expected.\n- **Objective**: The problem is stated in precise, technical language, free from subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, self-contained, and well-posed. I will proceed with the detailed solution.\n\nTo perform the normal-mode analysis, we substitute the Fourier mode ansatz $q_{j}^{n} = \\widehat{q}^{n} \\exp(i \\kappa j)$ for $p(x,t)$ and $u(x,t)$ into the fully discrete scheme. We first determine the action of the discrete spatial operators $D_{x}$ and $D_{xx}$ on the spatial part of the mode, $\\exp(i \\kappa j)$.\n\nThe action of the first-derivative operator $D_x$ on the mode is:\n$$\nD_x \\exp(i \\kappa j) = \\frac{\\exp(i \\kappa (j+1)) - \\exp(i \\kappa (j-1))}{2 \\Delta x} = \\frac{\\exp(i \\kappa j) (\\exp(i \\kappa) - \\exp(-i \\kappa))}{2 \\Delta x} = \\frac{\\exp(i \\kappa j) (2i \\sin(\\kappa))}{2 \\Delta x} = \\frac{i \\sin(\\kappa)}{\\Delta x} \\exp(i \\kappa j).\n$$\nThe action of the second-derivative operator $D_{xx}$ on the mode is:\n$$\nD_{xx} \\exp(i \\kappa j) = \\frac{\\exp(i \\kappa (j+1)) - 2\\exp(i \\kappa j) + \\exp(i \\kappa (j-1))}{\\Delta x^2} = \\frac{\\exp(i \\kappa j) (\\exp(i \\kappa) - 2 + \\exp(-i \\kappa))}{\\Delta x^2} = \\frac{\\exp(i \\kappa j) (2\\cos(\\kappa) - 2)}{\\Delta x^2} = \\frac{-4 \\sin^2(\\frac{\\kappa}{2})}{\\Delta x^2} \\exp(i \\kappa j).\n$$\nBy substituting the ansatz into the discrete equations and canceling the common factor $\\exp(i \\kappa j)$, we obtain a system for the time-dependent Fourier amplitudes $\\widehat{p}^n$ and $\\widehat{u}^n$.\n\nThe pressure update becomes:\n$$\n\\widehat{p}^{n+1, \\star} = \\widehat{p}^n - \\Delta t \\, \\rho_0 c^2 \\left(\\frac{i \\sin(\\kappa)}{\\Delta x}\\right) \\widehat{u}^n.\n$$\nThe velocity update becomes:\n$$\n\\widehat{u}^{n+1} = \\widehat{u}^n - \\Delta t \\, \\frac{1}{\\rho_0} \\left(\\frac{i \\sin(\\kappa)}{\\Delta x}\\right) \\widehat{p}^n + \\Delta t \\, \\nu \\left(\\frac{-4 \\sin^2(\\frac{\\kappa}{2})}{\\Delta x^2}\\right) \\widehat{u}^n.\n$$\nThe pressure filtering step becomes:\n$$\n\\widehat{p}^{n+1} = \\widehat{p}^{n+1, \\star} \\left(1 - 4\\sigma \\sin^2\\left(\\frac{\\kappa}{2}\\right)\\right).\n$$\nWe are asked to analyze the grid-scale mode, which corresponds to the Nyquist wavenumber $\\kappa = \\pi$. For this mode, the spatial part is $\\exp(i \\pi j) = (-1)^j$, which represents the highest frequency resolvable on the grid. We evaluate the trigonometric terms at $\\kappa=\\pi$:\n$$\n\\sin(\\pi) = 0.\n$$\n$$\n\\sin^2\\left(\\frac{\\pi}{2}\\right) = (1)^2 = 1.\n$$\nSubstituting these values into the system for the Fourier amplitudes, we observe a significant simplification. The terms involving $\\sin(\\kappa)$ vanish, which means the coupling between the pressure and velocity equations disappears for this specific mode.\n\nThe pressure update at $\\kappa=\\pi$:\nThe intermediate pressure step yields:\n$$\n\\widehat{p}^{n+1, \\star} = \\widehat{p}^n - \\Delta t \\, \\rho_0 c^2 \\left(0\\right) \\widehat{u}^n = \\widehat{p}^n.\n$$\nThe filtering step then gives:\n$$\n\\widehat{p}^{n+1} = \\widehat{p}^{n+1, \\star} \\left(1 - 4\\sigma \\sin^2\\left(\\frac{\\pi}{2}\\right)\\right) = \\widehat{p}^{n} (1 - 4\\sigma(1)) = (1 - 4\\sigma)\\widehat{p}^n.\n$$\nThe velocity update at $\\kappa=\\pi$:\n$$\n\\widehat{u}^{n+1} = \\widehat{u}^n - \\Delta t \\, \\frac{1}{\\rho_0} (0) \\widehat{p}^n + \\Delta t \\, \\nu \\left(\\frac{-4 \\sin^2(\\frac{\\pi}{2})}{\\Delta x^2}\\right) \\widehat{u}^n = \\widehat{u}^n + \\Delta t \\, \\nu \\left(\\frac{-4}{\\Delta x^2}\\right) \\widehat{u}^n = \\left(1 - \\frac{4\\nu\\Delta t}{\\Delta x^2}\\right) \\widehat{u}^n.\n$$\nFrom these two equations, we can identify the one-step amplification factors for the grid-scale mode. Let $g_p(\\kappa)$ and $g_u(\\kappa)$ be the amplification factors for pressure and velocity, respectively. At $\\kappa=\\pi$, we have:\n$$\ng_p(\\pi) = \\frac{\\widehat{p}^{n+1}}{\\widehat{p}^n} = 1 - 4\\sigma.\n$$\n$$\ng_u(\\pi) = \\frac{\\widehat{u}^{n+1}}{\\widehat{u}^n} = 1 - \\frac{4\\nu\\Delta t}{\\Delta x^2}.\n$$\nThe problem states the design requirement that the per-step amplitude reduction is equal for $p$ and $u$. The amplitude reduction is determined by the magnitude of the amplification factor. Thus, this requirement translates to:\n$$\n|g_p(\\pi)| = |g_u(\\pi)|.\n$$\nSubstituting the expressions for the amplification factors:\n$$\n|1 - 4\\sigma| = \\left|1 - \\frac{4\\nu\\Delta t}{\\Delta x^2}\\right|.\n$$\nThe artificial viscosity and the explicit filter are dissipative mechanisms designed to damp, or reduce the amplitude of, high-frequency numerical modes. A purely dissipative effect without phase inversion corresponds to an amplification factor in the range $[0, 1)$. Assuming this intended design behavior, both $g_p(\\pi)$ and $g_u(\\pi)$ are non-negative. With $\\sigma \\ge 0$ and $\\nu > 0$, this requires $1 - 4\\sigma \\ge 0 \\implies \\sigma \\le 1/4$ and $1 - \\frac{4\\nu\\Delta t}{\\Delta x^2} \\ge 0 \\implies \\Delta t \\le \\frac{\\Delta x^2}{4\\nu}$. Under this standard assumption of monotonic damping, the absolute value signs can be removed:\n$$\n1 - 4\\sigma = 1 - \\frac{4\\nu\\Delta t}{\\Delta x^2}.\n$$\nThis is the only physically meaningful choice, as the alternative $g_p = -g_u$ would imply that one dissipative mechanism causes a phase flip while the other does not, which contradicts a consistent design philosophy for damping.\n\nSolving for $\\sigma$:\n$$\n-4\\sigma = - \\frac{4\\nu\\Delta t}{\\Delta x^2}.\n$$\n$$\n\\sigma = \\frac{\\nu\\Delta t}{\\Delta x^2}.\n$$\nThis expression provides the dimensionless filter strength $\\sigma$ that ensures the damping effect of the pressure filter on the Nyquist mode is identical to the damping effect of the artificial viscosity on the same mode in the velocity field.",
            "answer": "$$\\boxed{\\frac{\\nu \\Delta t}{\\Delta x^{2}}}$$"
        }
    ]
}