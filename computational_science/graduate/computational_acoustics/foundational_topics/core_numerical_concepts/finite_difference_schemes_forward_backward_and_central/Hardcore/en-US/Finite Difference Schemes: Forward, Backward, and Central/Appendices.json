{
    "hands_on_practices": [
        {
            "introduction": "This exercise goes back to the fundamentals of numerical differentiation. By applying Taylor series expansions, the cornerstone of finite difference methods, you will systematically derive the coefficients for high-order schemes. This practice hones the essential skill of constructing accurate stencils for both interior grid points and boundaries, and provides a first look at quantifying numerical dispersion. ",
            "id": "4124043",
            "problem": "Consider one-dimensional linear acoustics in a homogeneous medium, described by the linearized Euler system $u_{t} + \\frac{1}{\\rho_{0}} p_{x} = 0$ and $p_{t} + \\rho_{0} c^{2} u_{x} = 0$, where $p(x,t)$ is the acoustic pressure, $u(x,t)$ is the particle velocity, $c$ is the sound speed, and $\\rho_{0}$ is the ambient density. On a uniform spatial grid $x_{i} = i h$ with grid spacing $h$, suppose one wishes to construct high-order finite difference approximations to the spatial derivative operator for use in a semi-discrete formulation of these equations.\n\nAt interior points, consider a symmetric central finite difference approximation to the first derivative, parameterized by three unknown coefficients $a_{1}, a_{2}, a_{3}$:\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\left[ a_{1}\\left(f_{i+1} - f_{i-1}\\right) + a_{2}\\left(f_{i+2} - f_{i-2}\\right) + a_{3}\\left(f_{i+3} - f_{i-3}\\right) \\right].\n$$\nAt the left boundary $x_{0} = 0$, consider a one-sided forward finite difference approximation using five nodes with unknown coefficients $b_{0}, b_{1}, b_{2}, b_{3}, b_{4}$:\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\left[ b_{0} f_{0} + b_{1} f_{1} + b_{2} f_{2} + b_{3} f_{3} + b_{4} f_{4} \\right].\n$$\n\nStarting only from Taylor series expansions about $x_{i}$ and the plane-wave ansatz $f(x) = \\exp(i k x)$, derive the following:\n\n1. The coefficients $a_{1}, a_{2}, a_{3}$ such that $(\\mathcal{D}_{c} f)_{i}$ is a sixth-order accurate approximation to $f'(x_{i})$, meaning the truncation error is $\\mathcal{O}(h^{6})$.\n2. The leading-order dispersion-truncation coefficient $\\gamma$ for the central operator, defined by the small-$k h$ expansion of the effective wavenumber $k_{\\mathrm{eff}}$ obtained by applying $\\mathcal{D}_{c}$ to the Fourier mode $f_{i} = \\exp(i k x_{i})$, namely\n$$\nk_{\\mathrm{eff}} = k - \\gamma \\, k^{7} h^{6} + \\mathcal{O}(k^{9} h^{8}).\n$$\nExpress $\\gamma$ in closed form as a real constant.\n3. The coefficients $b_{0}, b_{1}, b_{2}, b_{3}, b_{4}$ such that $(\\mathcal{D}_{f} f)_{0}$ is a fourth-order accurate approximation to $f'(x_{0})$, meaning the truncation error is $\\mathcal{O}(h^{4})$.\n\nProvide your final answer as a single row matrix containing, in order, the entries $(a_{1}, a_{2}, a_{3}, \\gamma, b_{0}, b_{1}, b_{2}, b_{3}, b_{4})$. No rounding is required, and all coefficients should be expressed as exact rational numbers. The final answer is dimensionless and requires no units.",
            "solution": "The problem is well-posed and scientifically sound, representing a standard task in the development of numerical methods for partial differential equations. We are asked to derive coefficients for finite difference schemes by enforcing accuracy constraints via Taylor series analysis, and to perform a dispersion analysis on the resulting scheme.\n\nThe problem is divided into three parts. We will address each in sequence.\n\nPart 1: Determination of coefficients for a sixth-order central difference scheme.\n\nWe are given the symmetric central difference operator for the first derivative $f'(x_i)$:\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\left[ a_{1}\\left(f_{i+1} - f_{i-1}\\right) + a_{2}\\left(f_{i+2} - f_{i-2}\\right) + a_{3}\\left(f_{i+3} - f_{i-3}\\right) \\right]\n$$\nTo determine the coefficients $a_1, a_2, a_3$, we expand the function values $f_{i \\pm j} = f(x_i \\pm jh)$ in a Taylor series around $x_i$.\n$$\nf(x_i \\pm jh) = f(x_i) \\pm (jh)f'(x_i) + \\frac{(jh)^2}{2!}f''(x_i) \\pm \\frac{(jh)^3}{3!}f'''(x_i) + \\dots\n$$\nThe difference $f_{i+j} - f_{i-j}$ is given by:\n$$\nf_{i+j} - f_{i-j} = 2jh f'_{i} + 2\\frac{(jh)^3}{3!} f'''_{i} + 2\\frac{(jh)^5}{5!} f^{(5)}_{i} + 2\\frac{(jh)^7}{7!} f^{(7)}_{i} + \\mathcal{O}(h^9)\n$$\nwhere $f_i^{(n)} = f^{(n)}(x_i)$. Substituting this into the operator expression for $j = 1, 2, 3$:\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\sum_{j=1}^{3} a_j \\left( 2jh f'_{i} + \\frac{j^3h^3}{3} f'''_{i} + \\frac{j^5h^5}{60} f^{(5)}_{i} + \\frac{j^7h^7}{2520} f^{(7)}_{i} + \\dots \\right)\n$$\nWe group the terms by the order of the derivative of $f$:\n$$\n(\\mathcal{D}_{c} f)_{i} = \\left(2 \\sum_{j=1}^{3} j a_j\\right) f'_{i} + h^2 \\left(\\frac{1}{3} \\sum_{j=1}^{3} j^3 a_j\\right) f'''_{i} + h^4 \\left(\\frac{1}{60} \\sum_{j=1}^{3} j^5 a_j\\right) f^{(5)}_{i} + h^6 \\left(\\frac{1}{2520} \\sum_{j=1}^{3} j^7 a_j\\right) f^{(7)}_{i} + \\dots\n$$\nFor this operator to be an approximation of $f'_{i}$, the coefficient of $f'_{i}$ must be $1$. For it to be sixth-order accurate, the truncation error must be $\\mathcal{O}(h^6)$, which means the coefficients of the $h^2 f'''_i$ and $h^4 f^{(5)}_i$ terms must be zero. This yields a system of three linear equations for $a_1, a_2, a_3$:\n1. $2(a_1 + 2a_2 + 3a_3) = 1 \\implies a_1 + 2a_2 + 3a_3 = \\frac{1}{2}$\n2. $\\frac{1}{3}(a_1 + 8a_2 + 27a_3) = 0 \\implies a_1 + 8a_2 + 27a_3 = 0$\n3. $\\frac{1}{60}(a_1 + 32a_2 + 243a_3) = 0 \\implies a_1 + 32a_2 + 243a_3 = 0$\n\nWe solve this system. Subtracting the second equation from the third:\n$(a_1 + 32a_2 + 243a_3) - (a_1 + 8a_2 + 27a_3) = 0 \\implies 24a_2 + 216a_3 = 0 \\implies a_2 = -9a_3$.\nSubstitute $a_2 = -9a_3$ into the second equation:\n$a_1 + 8(-9a_3) + 27a_3 = 0 \\implies a_1 - 72a_3 + 27a_3 = 0 \\implies a_1 = 45a_3$.\nNow substitute both $a_1$ and $a_2$ into the first equation:\n$45a_3 + 2(-9a_3) + 3a_3 = \\frac{1}{2} \\implies 45a_3 - 18a_3 + 3a_3 = \\frac{1}{2} \\implies 30a_3 = \\frac{1}{2} \\implies a_3 = \\frac{1}{60}$.\nFrom this, we find $a_1$ and $a_2$:\n$a_1 = 45 \\left(\\frac{1}{60}\\right) = \\frac{45}{60} = \\frac{3}{4}$.\n$a_2 = -9 \\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20}$.\nThe coefficients are $a_1 = \\frac{3}{4}$, $a_2 = -\\frac{3}{20}$, and $a_3 = \\frac{1}{60}$.\n\nPart 2: Determination of the dispersion coefficient $\\gamma$.\n\nWe apply the operator $\\mathcal{D}_c$ to the plane-wave ansatz $f_j = f(x_j) = \\exp(ikx_j)$. The exact derivative is $f'(x_j) = ik \\exp(ikx_j) = ik f_j$. The numerical derivative is defined by $(\\mathcal{D}_c f)_j = ik_{\\mathrm{eff}} f_j$.\n$$\nf_{j+m} - f_{j-m} = \\exp(ik(x_j+mh)) - \\exp(ik(x_j-mh)) = \\exp(ikx_j) (\\exp(ikmh) - \\exp(-ikmh)) = f_j (2i \\sin(kmh))\n$$\nSubstituting this into the definition of $\\mathcal{D}_c$:\n$$\n(\\mathcal D_c f)_j = \\frac{1}{h} \\sum_{m=1}^{3} a_m (f_{j+m} - f_{j-m}) = \\frac{1}{h} \\sum_{m=1}^{3} a_m (2i \\sin(kmh)) f_j = \\frac{2i}{h} \\left( \\sum_{m=1}^{3} a_m \\sin(kmh) \\right) f_j\n$$\nComparing with $(\\mathcal{D}_c f)_j = ik_{\\mathrm{eff}} f_j$, we find the effective wavenumber $k_{\\mathrm{eff}}$:\n$$\nk_{\\mathrm{eff}} = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(kmh)\n$$\nWe expand $\\sin(kmh)$ for small $kh$:\n$$\n\\sin(kmh) = (kmh) - \\frac{(kmh)^3}{3!} + \\frac{(kmh)^5}{5!} - \\frac{(kmh)^7}{7!} + \\mathcal{O}((kh)^9)\n$$\nSubstituting this into the expression for $k_{\\mathrm{eff}}$:\n$$\nk_{\\mathrm{eff}} = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\left( kmh - \\frac{k^3m^3h^3}{6} + \\frac{k^5m^5h^5}{120} - \\frac{k^7m^7h^7}{5040} + \\dots \\right)\n$$\n$$\nk_{\\mathrm{eff}} = k \\left(2\\sum m a_m\\right) - k^3h^2 \\left(\\frac{1}{3}\\sum m^3 a_m\\right) + k^5h^4 \\left(\\frac{1}{60}\\sum m^5 a_m\\right) - k^7h^6 \\left(\\frac{1}{2520}\\sum m^7 a_m\\right) + \\dots\n$$\nFrom the constraints derived in Part 1, we know:\n$2\\sum m a_m = 1$\n$\\sum m^3 a_m = 0$\n$\\sum m^5 a_m = 0$\nThe expression for $k_{\\mathrm{eff}}$ simplifies to:\n$$\nk_{\\mathrm{eff}} = k - \\frac{k^7 h^6}{2520} \\left( \\sum_{m=1}^{3} m^7 a_m \\right) + \\mathcal{O}(k^9h^8)\n$$\nComparing this with the given form $k_{\\mathrm{eff}} = k - \\gamma k^7 h^6 + \\mathcal{O}(k^9h^8)$, we identify $\\gamma$ as:\n$$\n\\gamma = \\frac{1}{2520} \\sum_{m=1}^{3} m^7 a_m = \\frac{1}{2520} (1^7 a_1 + 2^7 a_2 + 3^7 a_3)\n$$\nSubstitute the values of $a_1, a_2, a_3$:\n$$\n\\sum m^7 a_m = (1)\\left(\\frac{3}{4}\\right) + (128)\\left(-\\frac{3}{20}\\right) + (2187)\\left(\\frac{1}{60}\\right) = \\frac{3}{4} - \\frac{384}{20} + \\frac{2187}{60}\n$$\nUsing a common denominator of $60$:\n$$\n\\frac{45}{60} - \\frac{1152}{60} + \\frac{2187}{60} = \\frac{45 - 1152 + 2187}{60} = \\frac{1080}{60} = 18\n$$\nThus, $\\gamma = \\frac{18}{2520}$. Simplifying the fraction:\n$$\n\\gamma = \\frac{18}{2520} = \\frac{1}{140}\n$$\n\nPart 3: Determination of coefficients for a fourth-order forward difference scheme.\n\nWe are given the one-sided forward difference operator:\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\left[ b_{0} f_{0} + b_{1} f_{1} + b_{2} f_{2} + b_{3} f_{3} + b_{4} f_{4} \\right]\n$$\nWe expand $f_j = f(x_j) = f(x_0+jh)$ in a Taylor series about $x_0$:\n$$\nf_j = f_0 + (jh)f'_0 + \\frac{(jh)^2}{2!}f''_0 + \\frac{(jh)^3}{3!}f'''_0 + \\frac{(jh)^4}{4!}f^{(4)}_0 + \\mathcal{O}(h^5)\n$$\nSubstituting this into the operator:\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\sum_{j=0}^{4} b_j \\left(f_0 + (jh)f'_0 + \\frac{j^2h^2}{2}f''_0 + \\dots \\right) = \\left(\\frac{1}{h}\\sum b_j \\right)f_0 + \\left(\\sum j b_j \\right)f'_0 + h\\left(\\frac{1}{2}\\sum j^2 b_j \\right)f''_0 + \\dots\n$$\nFor fourth-order accuracy in approximating $f'_0$, the first five terms must match the Taylor expansion of $f'_0$. This leads to a system of $5$ linear equations for $b_0, \\dots, b_4$:\n1. $\\sum_{j=0}^{4} b_j = 0$\n2. $\\sum_{j=0}^{4} j b_j = 1$\n3. $\\sum_{j=0}^{4} j^2 b_j = 0$\n4. $\\sum_{j=0}^{4} j^3 b_j = 0$\n5. $\\sum_{j=0}^{4} j^4 b_j = 0$\n\nThis Vandermonde-type system can be solved directly. Alternatively, we can use the method of undetermined coefficients based on the forward difference operator $\\Delta_h f(x) = f(x+h) - f(x)$. The derivative operator can be expressed as $D = \\frac{1}{h}\\ln(E) = \\frac{1}{h}\\ln(1+\\Delta_h)$, where $E$ is the shift operator.\n$$\nf'(x_0) = \\frac{1}{h} \\left(\\Delta_h - \\frac{\\Delta_h^2}{2} + \\frac{\\Delta_h^3}{3} - \\frac{\\Delta_h^4}{4} + \\dots \\right) f(x_0)\n$$\nTruncating at the $\\mathcal{O}(h^4)$ term, we have the approximation for $h f'_0$:\n$$\nh f'_0 \\approx \\Delta_h f_0 - \\frac{1}{2}\\Delta_h^2 f_0 + \\frac{1}{3}\\Delta_h^3 f_0 - \\frac{1}{4}\\Delta_h^4 f_0\n$$\nWe express the powers of $\\Delta_h$ in terms of function values $f_j$:\n$\\Delta_h f_0 = f_1 - f_0$\n$\\Delta_h^2 f_0 = f_2 - 2f_1 + f_0$\n$\\Delta_h^3 f_0 = f_3 - 3f_2 + 3f_1 - f_0$\n$\\Delta_h^4 f_0 = f_4 - 4f_3 + 6f_2 - 4f_1 + f_0$\nSubstituting these into the approximation for $h f'_0$:\n$$\nh f'_0 \\approx (f_1-f_0) - \\frac{1}{2}(f_2-2f_1+f_0) + \\frac{1}{3}(f_3-3f_2+3f_1-f_0) - \\frac{1}{4}(f_4-4f_3+6f_2-4f_1+f_0)\n$$\nCollecting coefficients for each $f_j$:\n$b_0$: $-1 - \\frac{1}{2} - \\frac{1}{3} - \\frac{1}{4} = -\\frac{12+6+4+3}{12} = -\\frac{25}{12}$\n$b_1$: $1 - \\frac{1}{2}(-2) + \\frac{1}{3}(3) - \\frac{1}{4}(-4) = 1+1+1+1=4$\n$b_2$: $-\\frac{1}{2}(1) + \\frac{1}{3}(-3) - \\frac{1}{4}(6) = -\\frac{1}{2} - 1 - \\frac{3}{2} = -3$\n$b_3$: $\\frac{1}{3}(1) - \\frac{1}{4}(-4) = \\frac{1}{3} + 1 = \\frac{4}{3}$\n$b_4$: $-\\frac{1}{4}(1) = -\\frac{1}{4}$\nSo, the coefficients are $b_0 = -\\frac{25}{12}$, $b_1 = 4$, $b_2 = -3$, $b_3 = \\frac{4}{3}$, $b_4 = -\\frac{1}{4}$. These coefficients satisfy the system of linear equations derived earlier.\n\nThe final result is the collection of all derived coefficients.\n$a_1 = \\frac{3}{4}$, $a_2 = -\\frac{3}{20}$, $a_3 = \\frac{1}{60}$\n$\\gamma = \\frac{1}{140}$\n$b_0 = -\\frac{25}{12}$, $b_1 = 4$, $b_2 = -3$, $b_3 = \\frac{4}{3}$, $b_4 = -\\frac{1}{4}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{4}  -\\frac{3}{20}  \\frac{1}{60}  \\frac{1}{140}  -\\frac{25}{12}  4  -3  \\frac{4}{3}  -\\frac{1}{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from individual derivative operators to a complete simulation framework, this problem tackles the one-dimensional acoustic equations using the highly popular staggered-grid leapfrog method. You will derive the update equations from first principles, perform a von Neumann stability analysis to find the Courant-Friedrichs-Lewy (CFL) condition, and quantify the scheme's phase accuracy. This exercise is key to understanding the interplay between numerical stability and accuracy, and how it constrains our choice of time step $\\Delta t$ and grid spacing $\\Delta x$. ",
            "id": "4124032",
            "problem": "Consider the one-dimensional linearized acoustic equations for pressure $p(x,t)$ and particle velocity $u(x,t)$ in a homogeneous medium with constant mass density $\\rho_0$ and sound speed $c$. The governing equations are the continuity and momentum equations: $$\\frac{\\partial p}{\\partial t} = - \\rho_0 c^2 \\frac{\\partial u}{\\partial x}, \\quad \\frac{\\partial u}{\\partial t} = - \\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x}.$$ All physical quantities use International System of Units (SI): $x$ in meters ($\\mathrm{m}$), $t$ in seconds ($\\mathrm{s}$), $p$ in pascals ($\\mathrm{Pa}$), $u$ in meters per second ($\\mathrm{m/s}$), $\\rho_0$ in kilograms per cubic meter ($\\mathrm{kg/m^3}$), and $c$ in meters per second ($\\mathrm{m/s}$). Use a uniform staggered spatial grid where pressure $p_j^n$ is defined at positions $x_j = j \\Delta x$ with integer index $j$, and particle velocity $u_{j+1/2}^{n+1/2}$ is defined at positions $x_{j+1/2} = (j + 1/2) \\Delta x$ with half-integer index and half-step time $t^{n+1/2} = (n + 1/2) \\Delta t$. Employ a leapfrog time-stepping strategy, in which $u$ is updated at half time steps and $p$ at full time steps, and approximate spatial derivatives by forward or backward differences consistent with the staggering so that the discrete spatial derivatives are centered across adjacent staggered points.\n\nStarting from the above equations and definitions, perform the following tasks:\n\n- Derive the discrete update equations for $u_{j+1/2}^{n+1/2}$ and $p_j^{n+1}$ on the staggered grid using the leapfrog scheme and finite differences that are forward or backward where appropriate and central in time. Do not assume any pre-derived update formulas; begin from the continuous equations and the discrete grid definitions.\n- Using a plane-wave ansatz with angular frequency $\\omega$ and wavenumber $k$, construct a discrete dispersion relation that connects $\\omega$ and $k$ under the derived finite difference scheme.\n- From the discrete dispersion relation, determine the stability condition on the Courant number $r = c \\Delta t / \\Delta x$ and provide the condition under which $\\omega$ remains real-valued.\n- Implement a program that, given $(c, \\Delta x, \\Delta t, N_x)$, computes:\n  1. The Courant number $r = c \\Delta t / \\Delta x$ (dimensionless).\n  2. The set of discrete nondimensional wavenumbers $\\kappa_m = k_m \\Delta x = 2 \\pi m / N_x$ for integer $m$ from $m = 1$ to $m = N_x/2$, assuming periodicity over a uniform grid of $N_x$ points. The angle unit is radians.\n  3. For each $\\kappa_m$, the numerical phase velocity $c_p^{\\mathrm{num}}$ implied by the discrete dispersion relation. Compare it to the physical phase speed $c$ and compute the relative phase speed error $\\left| c_p^{\\mathrm{num}} - c \\right| / c$ (dimensionless).\n  4. The maximum of the relative phase speed error over all modes $m \\in \\{1, \\dots, N_x/2\\}$ (dimensionless). If the scheme is unstable (i.e., if the computed $r$ violates the stability condition), set the maximum error to the float value $-1.0$.\n  5. A stability flag $S$ as a boolean, where $S = \\mathrm{True}$ if stable and $S = \\mathrm{False}$ if unstable.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry corresponds to one test case and must be a two-element list $[E,S]$ where $E$ is the maximum relative phase speed error (a float, dimensionless) and $S$ is the stability boolean. For example, the format should be like $[[E_1,S_1],[E_2,S_2],\\dots]$ with no spaces.\n\nUse the following test suite of parameter values to exercise the implementation:\n\n- Case $1$ (general stable case): $c = 343 \\ \\mathrm{m/s}$, $\\Delta x = 0.01 \\ \\mathrm{m}$, choose $\\Delta t$ such that $r = 0.9$, and $N_x = 128$.\n- Case $2$ (stability boundary): $c = 343 \\ \\mathrm{m/s}$, $\\Delta x = 0.01 \\ \\mathrm{m}$, choose $\\Delta t$ such that $r = 1.0$, and $N_x = 128$.\n- Case $3$ (unstable case): $c = 343 \\ \\mathrm{m/s}$, $\\Delta x = 0.01 \\ \\mathrm{m}$, choose $\\Delta t$ such that $r = 1.1$, and $N_x = 128$.\n- Case $4$ (coarse grid edge case): $c = 343 \\ \\mathrm{m/s}$, $\\Delta x = 0.5 \\ \\mathrm{m}$, choose $\\Delta t$ such that $r = 0.9$, and $N_x = 4$.\n\nAll $c$, $\\Delta x$, and $\\Delta t$ must be interpreted in SI units ($\\mathrm{m/s}$, $\\mathrm{m}$, and $\\mathrm{s}$ respectively); the output error $E$ is dimensionless, and the stability flag $S$ is boolean. The angle unit for any trigonometric quantity is radians. Your program should produce the final output line in the exact format described above.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of acoustics and numerical analysis, is well-posed, objective, and contains all necessary information to derive the requested results and implement the corresponding program.\n\nThe solution proceeds in several steps: first, the derivation of the discrete update equations from the continuous governing equations; second, the derivation of the discrete dispersion relation and the stability condition; third, the formula for the numerical phase velocity and its associated error.\n\n### 1. Derivation of the Discrete Update Equations\n\nThe problem describes a leapfrog time-stepping scheme on a staggered spatial grid. Pressure $p_j^n$ is defined at integer spatial indices $j$ and full time steps $n$, i.e., at $(x_j, t^n) = (j \\Delta x, n \\Delta t)$. Particle velocity $u_{j+1/2}^{n+1/2}$ is defined at half-integer spatial indices and half-integer time steps, i.e., at $(x_{j+1/2}, t^{n+1/2}) = ((j + 1/2) \\Delta x, (n + 1/2) \\Delta t)$.\n\nThe core idea of the leapfrog finite-difference time-domain (FDTD) method is to evaluate the time and space derivatives at locations centered between the grid points being used for the approximation. This leads to a second-order accurate scheme.\n\n**Update Equation for Particle Velocity $u$:**\n\nThe momentum equation is $\\frac{\\partial u}{\\partial t} = - \\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x}$. We update $u$ from time $t^{n-1/2}$ to $t^{n+1/2}$ using pressure values at time $t^n$. This requires evaluating the derivatives at $(x_{j+1/2}, t^n)$.\n\nThe time derivative $\\frac{\\partial u}{\\partial t}$ at $(x_{j+1/2}, t^n)$ is approximated using a central difference in time centered at $t^n$:\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j+1/2, n} \\approx \\frac{u_{j+1/2}^{n+1/2} - u_{j+1/2}^{n-1/2}}{\\Delta t}\n$$\nThe spatial derivative $\\frac{\\partial p}{\\partial x}$ at $(x_{j+1/2}, t^n)$ is approximated using a central difference in space centered at $x_{j+1/2}$:\n$$\n\\frac{\\partial p}{\\partial x} \\bigg|_{j+1/2, n} \\approx \\frac{p_{j+1}^n - p_j^n}{\\Delta x}\n$$\nSubstituting these into the momentum equation yields:\n$$\n\\frac{u_{j+1/2}^{n+1/2} - u_{j+1/2}^{n-1/2}}{\\Delta t} = - \\frac{1}{\\rho_0} \\frac{p_{j+1}^n - p_j^n}{\\Delta x}\n$$\nRearranging for $u_{j+1/2}^{n+1/2}$ gives the first update equation:\n$$\nu_{j+1/2}^{n+1/2} = u_{j+1/2}^{n-1/2} - \\frac{\\Delta t}{\\rho_0 \\Delta x} (p_{j+1}^n - p_j^n)\n$$\n\n**Update Equation for Pressure $p$:**\n\nThe continuity equation is $\\frac{\\partial p}{\\partial t} = - \\rho_0 c^2 \\frac{\\partial u}{\\partial x}$. We update $p$ from time $t^n$ to $t^{n+1}$ using velocity values at time $t^{n+1/2}$. This requires evaluating the derivatives at $(x_j, t^{n+1/2})$.\n\nThe time derivative $\\frac{\\partial p}{\\partial t}$ at $(x_j, t^{n+1/2})$ is approximated using a central difference in time centered at $t^{n+1/2}$:\n$$\n\\frac{\\partial p}{\\partial t} \\bigg|_{j, n+1/2} \\approx \\frac{p_j^{n+1} - p_j^n}{\\Delta t}\n$$\nThe spatial derivative $\\frac{\\partial u}{\\partial x}$ at $(x_j, t^{n+1/2})$ is approximated using a central difference in space centered at $x_j$:\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j, n+1/2} \\approx \\frac{u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2}}{\\Delta x}\n$$\nSubstituting these into the continuity equation yields:\n$$\n\\frac{p_j^{n+1} - p_j^n}{\\Delta t} = - \\rho_0 c^2 \\frac{u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2}}{\\Delta x}\n$$\nRearranging for $p_j^{n+1}$ gives the second update equation:\n$$\np_j^{n+1} = p_j^n - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} (u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2})\n$$\n\n### 2. Discrete Dispersion Relation and Stability Condition\n\nTo analyze the properties of the scheme, we use a plane-wave ansatz for the discrete variables:\n$$\np_j^n = P_0 e^{i(k x_j - \\omega t^n)} = P_0 e^{i(k j \\Delta x - \\omega n \\Delta t)}\n$$\n$$\nu_{j+1/2}^{n+1/2} = U_0 e^{i(k x_{j+1/2} - \\omega t^{n+1/2})} = U_0 e^{i(k (j+1/2) \\Delta x - \\omega (n+1/2) \\Delta t)}\n$$\nwhere $k$ is the wavenumber, $\\omega$ is the angular frequency, and $P_0, U_0$ are complex amplitudes. Substituting the ansatz into the update equation for $u$:\n$$\nU_0 e^{i(k(j+1/2)\\Delta x - \\omega(n+1/2)\\Delta t)} - U_0 e^{i(k(j+1/2)\\Delta x - \\omega(n-1/2)\\Delta t)} = - \\frac{\\Delta t}{\\rho_0 \\Delta x} (P_0 e^{i(k(j+1)\\Delta x - \\omega n \\Delta t)} - P_0 e^{i(kj\\Delta x - \\omega n \\Delta t)})\n$$\nDividing by common factors $e^{i k(j+1/2)\\Delta x} e^{-i\\omega n \\Delta t}$:\n$$\nU_0 (e^{-i\\omega\\Delta t/2} - e^{i\\omega\\Delta t/2}) = - \\frac{\\Delta t P_0}{\\rho_0 \\Delta x} (e^{ik\\Delta x/2} - e^{-ik\\Delta x/2})\n$$\nUsing Euler's formula, $e^{i\\theta} - e^{-i\\theta} = 2i \\sin\\theta$:\n$$\nU_0 (-2i \\sin(\\omega\\Delta t/2)) = - \\frac{\\Delta t P_0}{\\rho_0 \\Delta x} (2i \\sin(k\\Delta x/2))\n$$\n$$\n\\frac{U_0}{P_0} = \\frac{\\Delta t}{\\rho_0 \\Delta x} \\frac{\\sin(k\\Delta x/2)}{\\sin(\\omega\\Delta t/2)} \\quad (1)\n$$\nNext, substituting the ansatz into the update equation for $p$:\n$$\nP_0 (e^{-i\\omega\\Delta t} - 1)e^{i(kj\\Delta x - \\omega n \\Delta t)} = - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} U_0 (e^{ik\\Delta x/2} - e^{-ik\\Delta x/2}) e^{i(kj\\Delta x - \\omega(n+1/2)\\Delta t)}\n$$\n$$\nP_0 e^{-i\\omega\\Delta t/2}(e^{-i\\omega\\Delta t/2} - e^{i\\omega\\Delta t/2}) = - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} U_0 (2i \\sin(k\\Delta x/2)) e^{-i\\omega\\Delta t/2}\n$$\n$$\nP_0 (-2i \\sin(\\omega\\Delta t/2)) = - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} U_0 (2i \\sin(k\\Delta x/2))\n$$\n$$\n\\frac{P_0}{U_0} = \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\frac{\\sin(k\\Delta x/2)}{\\sin(\\omega\\Delta t/2)} \\quad (2)\n$$\nMultiplying equation (1) by equation (2):\n$$\n1 = \\left( \\frac{\\Delta t}{\\rho_0 \\Delta x} \\frac{\\sin(k\\Delta x/2)}{\\sin(\\omega\\Delta t/2)} \\right) \\left( \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\frac{\\sin(k\\Delta x/2)}{\\sin(\\omega\\Delta t/2)} \\right)\n$$\n$$\n1 = c^2 \\left(\\frac{\\Delta t}{\\Delta x}\\right)^2 \\frac{\\sin^2(k\\Delta x/2)}{\\sin^2(\\omega\\Delta t/2)}\n$$\nLetting $r = c \\Delta t / \\Delta x$ be the Courant number, we obtain the discrete dispersion relation:\n$$\n\\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) = r^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nFor a stable, non-amplifying numerical solution, the angular frequency $\\omega$ must be a real number. This implies that $\\sin(\\omega \\Delta t / 2)$ must be real and its value must lie in the range $[-1, 1]$. Therefore, we must have:\n$$\n\\left| r \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right| \\leq 1\n$$\nSince $\\sin(k \\Delta x / 2)$ can be equal to $1$ (e.g., for the Nyquist wavenumber $k = \\pi/\\Delta x$), the condition must hold for the worst case. This requires $|r| \\le 1$. As $c, \\Delta t, \\Delta x$ are positive, the stability condition is:\n$$\nr = \\frac{c \\Delta t}{\\Delta x} \\leq 1\n$$\n\n### 3. Numerical Phase Velocity and Error\n\nFrom the dispersion relation, $\\sin(\\frac{\\omega \\Delta t}{2}) = \\pm r \\sin(\\frac{k \\Delta x}{2})$. For a forward-propagating wave, we take the positive root. Solving for $\\omega$:\n$$\n\\omega = \\frac{2}{\\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)\n$$\nThe numerical phase velocity is $c_p^{\\mathrm{num}} = \\omega/k$.\n$$\nc_p^{\\mathrm{num}} = \\frac{2}{k \\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)\n$$\nTo analyze the error, we compare this to the physical phase speed $c$. The ratio is:\n$$\n\\frac{c_p^{\\mathrm{num}}}{c} = \\frac{2}{c k \\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right) = \\frac{2}{k (r \\Delta x)} \\arcsin\\left(r \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)\n$$\nLet $\\kappa = k \\Delta x$ be the non-dimensional wavenumber. The expression becomes:\n$$\n\\frac{c_p^{\\mathrm{num}}}{c} = \\frac{2}{r \\kappa} \\arcsin\\left(r \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\nThe relative phase speed error is given by $\\left| \\frac{c_p^{\\mathrm{num}}}{c} - 1 \\right|$. The program will compute this error for each discrete wavenumber $\\kappa_m = 2 \\pi m / N_x$ for $m \\in \\{1, \\dots, N_x/2\\}$ and find the maximum value. If the scheme is unstable ($r > 1$), this analysis is invalid as $\\omega$ becomes complex, and the error is assigned a value of $-1.0$.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_metrics(c, dx, r_val, Nx):\n    \"\"\"\n    Calculates stability and maximum relative phase speed error for a given set of parameters.\n\n    Args:\n        c (float): Speed of sound (m/s).\n        dx (float): Spatial grid spacing (m).\n        r_val (float): Courant number.\n        Nx (int): Number of grid points.\n\n    Returns:\n        list: A two-element list [E, S] where E is the max relative error (float)\n              and S is the stability flag (bool).\n    \"\"\"\n    dt = r_val * dx / c\n    r = c * dt / dx\n\n    is_stable = (r = 1.0)\n    \n    if not is_stable:\n        return [-1.0, False]\n\n    # Modes m from 1 to Nx/2\n    # np.arange is exclusive of the stop value, so we need +1\n    m_values = np.arange(1, Nx // 2 + 1)\n    \n    # Nondimensional wavenumbers kappa_m = k_m * dx\n    kappa_values = 2 * np.pi * m_values / Nx\n    \n    # Calculate the ratio of numerical to physical phase velocity\n    # The term inside arcsin must not exceed 1.0, which is guaranteed by the stability check.\n    # A small epsilon is added to avoid potential division by zero if kappa_values could be zero,\n    # though here it starts from m=1, so kappa is never zero.\n    \n    # Expression for c_p_num / c\n    # sin_kappa_half = np.sin(kappa_values / 2) creates a vector of values\n    # The whole expression is vectorized with numpy\n    ratio_c_p_num_c = (2 / (r * kappa_values)) * np.arcsin(r * np.sin(kappa_values / 2))\n    \n    # Relative phase speed error\n    # This is also a vectorized operation\n    relative_errors = np.abs(ratio_c_p_num_c - 1)\n    \n    # Find the maximum error over all computed modes\n    max_relative_error = np.max(relative_errors)\n    \n    return [max_relative_error, True]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the final output.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # Format: (c, delta_x, target_courant_r, Nx)\n    test_cases = [\n        # Case 1: stable case\n        (343.0, 0.01, 0.9, 128),\n        # Case 2: stability boundary\n        (343.0, 0.01, 1.0, 128),\n        # Case 3: unstable case\n        (343.0, 0.01, 1.1, 128),\n        # Case 4: coarse grid edge case\n        (343.0, 0.5, 0.9, 4),\n    ]\n\n    results = []\n    for case in test_cases:\n        c, dx, r_val, Nx = case\n        result = calculate_metrics(c, dx, r_val, Nx)\n        results.append(result)\n\n    # Format the final output string as specified in the problem.\n    # Example: [[E1,S1],[E2,S2]]\n    # str(list) creates the '[E, S]' part, and join forms the comma-separated list of lists.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # The problem asks for no spaces between list elements\n    output_str_no_spaces = output_str.replace(\" \", \"\")\n\n    print(output_str_no_spaces)\n\nsolve()\n```"
        },
        {
            "introduction": "How can we achieve higher accuracy without expanding the computational stencil to include many more points? This practice introduces an elegant solution: implicit, or compact, finite difference schemes. You will derive a sixth-order compact scheme and compare its superior numerical dispersion properties against standard explicit methods, giving you a concrete understanding of why these schemes are a powerful choice for high-fidelity wave propagation modeling. ",
            "id": "4124024",
            "problem": "Consider the one-dimensional linear acoustics governed by the pressure-displacement formulation that reduces to the scalar wave equation\n$$\n\\frac{\\partial^2 p(x,t)}{\\partial t^2} - c^2 \\frac{\\partial^2 p(x,t)}{\\partial x^2} = 0,\n$$\nwhere $p(x,t)$ is the acoustic pressure and $c$ is the sound speed. On a uniform periodic grid with spacing $\\Delta x$ and nodes $x_j = j \\Delta x$, define finite difference approximations to the spatial derivative using three classes of schemes: forward, backward, and central, as well as a compact tridiagonal scheme.\n\nYour task is to construct, analyze, and compare semi-discrete dispersion properties for three second-derivative discretizations of $\\frac{\\partial^2}{\\partial x^2}$ built from first-derivative approximations on the periodic grid:\n\n1. A second derivative formed by applying the backward difference to the forward difference (denoted $D_{\\mathrm{b}} D_{\\mathrm{f}}$).\n2. A second derivative formed by applying the central difference twice (denoted $D_{\\mathrm{c}}^2$).\n3. A second derivative formed by squaring a tridiagonal compact finite difference approximation for the first derivative (denoted $D_{\\mathrm{comp}}^2$).\n\nBegin from the following context-appropriate fundamental bases:\n- The continuous plane-wave solution $p(x,t) = \\Re\\{ \\exp( \\mathrm{i} (k x - \\omega t) ) \\}$ of the wave equation satisfies the continuous dispersion relation $\\omega^2 = c^2 k^2$, where $k$ is the wavenumber and $\\omega$ is the angular frequency.\n- On a uniform periodic grid, any linear, translation-invariant discrete derivative operator acting on a discrete Fourier mode $\\exp(\\mathrm{i} j \\theta)$ is characterized by a discrete Fourier symbol, where $\\theta = k \\Delta x$ is the grid-normalized wavenumber (an angle in radians).\n\nProceed as follows, without using any shortcut formulas not derived from first principles:\n\nA. Derive the discrete Fourier symbols for the first-derivative operators corresponding to forward difference, backward difference, and central difference on the periodic grid. Then derive the discrete Fourier symbols for the three second-derivative operators $D_{\\mathrm{b}} D_{\\mathrm{f}}$, $D_{\\mathrm{c}}^2$, and $D_{\\mathrm{comp}}^2$ in terms of $\\theta$.\n\nB. Construct a tridiagonal compact finite difference scheme for the first derivative of the Pad√© type on the periodic grid with the unknown coefficients $\\,\\alpha\\,,\\,b\\,,\\,c\\,$, of the form\n$$\n\\alpha\\, f'_{j-1} + f'_j + \\alpha\\, f'_{j+1}\n= \\frac{1}{\\Delta x}\\left[\\, b \\left(f_{j+1} - f_{j-1}\\right) + c \\left(f_{j+2} - f_{j-2}\\right) \\,\\right].\n$$\nUsing Taylor series consistency about a smooth function $f(x)$ and the discrete Fourier mode analysis, determine the coefficients $\\,\\alpha\\,,\\,b\\,,\\,c\\,$ that achieve sixth-order accuracy for the first derivative. Then obtain the corresponding discrete Fourier symbol for $D_{\\mathrm{comp}}$ and, by squaring, the symbol for $D_{\\mathrm{comp}}^2$.\n\nC. For each of the three second-derivative discretizations, define the semi-discrete dispersion relation by replacing $k^2$ in the continuous relation $\\omega^2 = c^2 k^2$ with the squared magnitude of the corresponding effective discrete wavenumber $k_{\\mathrm{eff}}(\\theta)$ arising from the second-derivative symbol on a Fourier mode $\\exp(\\mathrm{i} j \\theta)$. From this, define the phase speed ratio\n$$\nR(\\theta) = \\frac{\\omega / k}{c} = \\frac{k_{\\mathrm{eff}}(\\theta)}{k} = \\frac{k_{\\mathrm{eff}}(\\theta)\\,\\Delta x}{\\theta},\n$$\nwhich is dimensionless and depends only on $\\theta$.\n\nD. Implement a program that, for specified test angles $\\,\\theta\\,$, computes the absolute phase speed error $\\,E(\\theta) = \\left| R(\\theta) - 1 \\right|$ for each of the three schemes $D_{\\mathrm{b}} D_{\\mathrm{f}}$, $D_{\\mathrm{c}}^2$, and $D_{\\mathrm{comp}}^2$.\n\nAngles must be expressed in radians. No physical units are required for output because the requested quantity is dimensionless.\n\nTest Suite:\n- Case $1$: $\\theta = \\pi/16$ (long-wave limit).\n- Case $2$: $\\theta = \\pi/2$ (mid-range wavenumber).\n- Case $3$: $\\theta = 0.99\\,\\pi$ (near the Nyquist limit on the grid).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n\\left[ E_{\\mathrm{b}\\mathrm{f}}(\\pi/16),\\, E_{\\mathrm{c}^2}(\\pi/16),\\, E_{\\mathrm{comp}^2}(\\pi/16),\\, E_{\\mathrm{b}\\mathrm{f}}(\\pi/2),\\, E_{\\mathrm{c}^2}(\\pi/2),\\, E_{\\mathrm{comp}^2}(\\pi/2),\\, E_{\\mathrm{b}\\mathrm{f}}(0.99\\pi),\\, E_{\\mathrm{c}^2}(0.99\\pi),\\, E_{\\mathrm{comp}^2}(0.99\\pi) \\right],\n$$\nwhere $E_{\\mathrm{b}\\mathrm{f}}$ denotes the absolute phase speed error for $D_{\\mathrm{b}} D_{\\mathrm{f}}$, $E_{\\mathrm{c}^2}$ for $D_{\\mathrm{c}}^2$, and $E_{\\mathrm{comp}^2}$ for $D_{\\mathrm{comp}}^2$.",
            "solution": "The problem requires the derivation and comparison of dispersion properties for three finite difference approximations to the second spatial derivative $\\frac{\\partial^2}{\\partial x^2}$ in the context of the one-dimensional wave equation. The analysis will be performed in the Fourier domain.\n\nA. Derivation of Discrete Fourier Symbols for Standard Schemes\n\nA discrete operator $D$ is characterized by its Fourier symbol $\\widehat{D}(\\theta)$, defined by its action on a discrete Fourier mode $f_j = \\exp(\\mathrm{i} j \\theta)$, where $\\theta = k \\Delta x$ is the grid-normalized wavenumber. The action is $D f_j = \\widehat{D}(\\theta) f_j$. The exact first derivative operator $\\frac{\\partial}{\\partial x}$ has the symbol $\\frac{\\mathrm{i}k\\exp(\\mathrm{i}kx)}{\\exp(\\mathrm{i}kx)} = \\mathrm{i}k = \\frac{\\mathrm{i}\\theta}{\\Delta x}$.\n\nFirst, we derive the symbols for the first-derivative operators.\n1.  Forward Difference ($D_{\\mathrm{f}}$): $D_{\\mathrm{f}} f_j = \\frac{f_{j+1} - f_j}{\\Delta x}$.\n    Applying this to $f_j = \\exp(\\mathrm{i} j \\theta)$:\n    $$\n    D_{\\mathrm{f}} \\exp(\\mathrm{i} j \\theta) = \\frac{\\exp(\\mathrm{i} (j+1) \\theta) - \\exp(\\mathrm{i} j \\theta)}{\\Delta x} = \\frac{\\exp(\\mathrm{i} \\theta) - 1}{\\Delta x} \\exp(\\mathrm{i} j \\theta)\n    $$\n    Thus, the symbol is $\\widehat{D}_{\\mathrm{f}}(\\theta) = \\frac{\\exp(\\mathrm{i} \\theta) - 1}{\\Delta x}$.\n\n2.  Backward Difference ($D_{\\mathrm{b}}$): $D_{\\mathrm{b}} f_j = \\frac{f_j - f_{j-1}}{\\Delta x}$.\n    Applying this to $f_j = \\exp(\\mathrm{i} j \\theta)$:\n    $$\n    D_{\\mathrm{b}} \\exp(\\mathrm{i} j \\theta) = \\frac{\\exp(\\mathrm{i} j \\theta) - \\exp(\\mathrm{i} (j-1) \\theta)}{\\Delta x} = \\frac{1 - \\exp(-\\mathrm{i} \\theta)}{\\Delta x} \\exp(\\mathrm{i} j \\theta)\n    $$\n    Thus, the symbol is $\\widehat{D}_{\\mathrm{b}}(\\theta) = \\frac{1 - \\exp(-\\mathrm{i} \\theta)}{\\Delta x}$.\n\n3.  Central Difference ($D_{\\mathrm{c}}$): $D_{\\mathrm{c}} f_j = \\frac{f_{j+1} - f_{j-1}}{2 \\Delta x}$.\n    Applying this to $f_j = \\exp(\\mathrm{i} j \\theta)$:\n    $$\n    D_{\\mathrm{c}} \\exp(\\mathrm{i} j \\theta) = \\frac{\\exp(\\mathrm{i} (j+1) \\theta) - \\exp(\\mathrm{i} (j-1) \\theta)}{2 \\Delta x} = \\frac{\\exp(\\mathrm{i} \\theta) - \\exp(-\\mathrm{i} \\theta)}{2 \\Delta x} \\exp(\\mathrm{i} j \\theta) = \\frac{2\\mathrm{i} \\sin(\\theta)}{2 \\Delta x} \\exp(\\mathrm{i} j \\theta)\n    $$\n    Thus, the symbol is $\\widehat{D}_{\\mathrm{c}}(\\theta) = \\frac{\\mathrm{i} \\sin(\\theta)}{\\Delta x}$.\n\nNext, we derive the symbols for the second-derivative operators. The symbol of a composed operator is the product of the individual symbols.\n1.  $D_{\\mathrm{b}} D_{\\mathrm{f}}$:\n    $$\n    \\widehat{D}_{\\mathrm{bf}}(\\theta) = \\widehat{D}_{\\mathrm{b}}(\\theta) \\widehat{D}_{\\mathrm{f}}(\\theta) = \\left( \\frac{1 - \\exp(-\\mathrm{i} \\theta)}{\\Delta x} \\right) \\left( \\frac{\\exp(\\mathrm{i} \\theta) - 1}{\\Delta x} \\right) = \\frac{\\exp(\\mathrm{i} \\theta) - 1 - 1 + \\exp(-\\mathrm{i} \\theta)}{(\\Delta x)^2} = \\frac{2\\cos(\\theta) - 2}{(\\Delta x)^2}\n    $$\n    This is the symbol for the standard second-order central difference for the second derivative, $\\frac{f_{j+1} - 2f_j + f_{j-1}}{(\\Delta x)^2}$.\n\n2.  $D_{\\mathrm{c}}^2$:\n    $$\n    \\widehat{D}_{\\mathrm{c}^2}(\\theta) = \\left( \\widehat{D}_{\\mathrm{c}}(\\theta) \\right)^2 = \\left( \\frac{\\mathrm{i} \\sin(\\theta)}{\\Delta x} \\right)^2 = -\\frac{\\sin^2(\\theta)}{(\\Delta x)^2}\n    $$\n\nB. Derivation of the Sixth-Order Compact Scheme\n\nWe are given the general form of the compact scheme relating the function values $f_j$ to their derivatives $f'_j$:\n$$\n\\alpha\\, f'_{j-1} + f'_j + \\alpha\\, f'_{j+1} = \\frac{1}{\\Delta x}\\left[\\, b \\left(f_{j+1} - f_{j-1}\\right) + c \\left(f_{j+2} - f_{j-2}\\right) \\,\\right]\n$$\nTo find the coefficients $\\alpha$, $b$, and $c$, we require that the discrete operator approximates the continuous derivative as accurately as possible. We substitute the exact relations $f_j = \\exp(\\mathrm{i} j \\theta)$ and $f'_j = \\frac{\\mathrm{i}\\theta}{\\Delta x} \\exp(\\mathrm{i} j \\theta)$ into the scheme's definition:\n$$\n\\alpha \\frac{\\mathrm{i}\\theta}{\\Delta x} e^{\\mathrm{i}(j-1)\\theta} + \\frac{\\mathrm{i}\\theta}{\\Delta x} e^{\\mathrm{i}j\\theta} + \\alpha \\frac{\\mathrm{i}\\theta}{\\Delta x} e^{\\mathrm{i}(j+1)\\theta} = \\frac{1}{\\Delta x}\\left[ b(e^{\\mathrm{i}(j+1)\\theta} - e^{\\mathrm{i}(j-1)\\theta}) + c(e^{\\mathrm{i}(j+2)\\theta} - e^{\\mathrm{i}(j-2)\\theta}) \\right]\n$$\nDividing by $\\frac{1}{\\Delta x}\\exp(\\mathrm{i} j \\theta)$ simplifies the equation to:\n$$\n\\mathrm{i}\\theta (\\alpha e^{-\\mathrm{i}\\theta} + 1 + \\alpha e^{\\mathrm{i}\\theta}) = b(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}) + c(e^{\\mathrm{i}2\\theta} - e^{-\\mathrm{i}2\\theta})\n$$\nUsing Euler's identities, $e^{\\mathrm{i}x} \\pm e^{-\\mathrm{i}x}$, we get:\n$$\n\\mathrm{i}\\theta (1 + 2\\alpha \\cos(\\theta)) = b(2\\mathrm{i} \\sin(\\theta)) + c(2\\mathrm{i} \\sin(2\\theta))\n$$\n$$\n\\theta (1 + 2\\alpha \\cos(\\theta)) = 2b \\sin(\\theta) + 2c \\sin(2\\theta)\n$$\nTo achieve sixth-order accuracy, the Taylor series expansions of both sides around $\\theta=0$ must match up to the term $\\theta^5$, making the leading error term proportional to $\\theta^7$.\nLeft-hand side: $\\theta(1 + 2\\alpha(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots)) = (1+2\\alpha)\\theta - \\alpha\\theta^3 + \\frac{\\alpha}{12}\\theta^5 - O(\\theta^7)$.\nRight-hand side: $2b(\\theta - \\frac{\\theta^3}{6} + \\frac{\\theta^5}{120} - \\dots) + 2c(2\\theta - \\frac{8\\theta^3}{6} + \\frac{32\\theta^5}{120} - \\dots) = (2b+4c)\\theta - (\\frac{b}{3}+\\frac{8c}{3})\\theta^3 + (\\frac{b}{60}+\\frac{32c}{60})\\theta^5 - O(\\theta^7)$.\nMatching coefficients of powers of $\\theta$:\n\\begin{itemize}\n    \\item $\\theta^1$: $1+2\\alpha = 2b+4c$\n    \\item $\\theta^3$: $\\alpha = \\frac{b}{3}+\\frac{8c}{3} \\implies 3\\alpha = b+8c$\n    \\item $\\theta^5$: $\\frac{\\alpha}{12} = \\frac{b}{60}+\\frac{32c}{60} \\implies 5\\alpha = b+32c$\n\\end{itemize}\nWe solve this system of three linear equations for $\\alpha, b, c$. Subtracting the second equation from the third gives $2\\alpha = 24c$, so $c = \\frac{\\alpha}{12}$. Substituting this into the second equation gives $3\\alpha = b + 8(\\frac{\\alpha}{12}) = b + \\frac{2\\alpha}{3}$, which yields $b = \\frac{7\\alpha}{3}$. Finally, substituting $b$ and $c$ into the first equation: $1+2\\alpha = 2(\\frac{7\\alpha}{3}) + 4(\\frac{\\alpha}{12}) = \\frac{14\\alpha}{3} + \\frac{\\alpha}{3} = \\frac{15\\alpha}{3} = 5\\alpha$. This simplifies to $1=3\\alpha$, so $\\alpha = \\frac{1}{3}$.\nThe other coefficients are $b = \\frac{7}{3}(\\frac{1}{3}) = \\frac{7}{9}$ and $c = \\frac{1}{12}(\\frac{1}{3}) = \\frac{1}{36}$.\n\nThe Fourier symbol for the compact first-derivative operator, $\\widehat{D}_{\\mathrm{comp}}(\\theta)$, is obtained by solving for $f'_j/f_j$ in the Fourier domain:\n$$\n\\widehat{D}_{\\mathrm{comp}}(\\theta) = \\frac{\\mathrm{i}}{\\Delta x} \\frac{2b \\sin(\\theta) + 2c \\sin(2\\theta)}{1 + 2\\alpha \\cos(\\theta)}\n$$\nSubstituting the coefficients and simplifying:\n$$\n\\widehat{D}_{\\mathrm{comp}}(\\theta) = \\frac{\\mathrm{i}}{\\Delta x} \\frac{2(\\frac{7}{9}) \\sin(\\theta) + 2(\\frac{1}{36}) \\sin(2\\theta)}{1 + 2(\\frac{1}{3}) \\cos(\\theta)} = \\frac{\\mathrm{i}}{\\Delta x} \\frac{\\frac{14}{9} \\sin(\\theta) + \\frac{1}{18} \\sin(2\\theta)}{1 + \\frac{2}{3} \\cos(\\theta)} = \\frac{\\mathrm{i}}{\\Delta x} \\frac{\\sin(\\theta)(14 + \\cos(\\theta))}{3(3 + 2 \\cos(\\theta))}\n$$\nThe symbol for the second-derivative operator $D_{\\mathrm{comp}}^2$ is the square of the first-derivative symbol:\n$$\n\\widehat{D}_{\\mathrm{comp}^2}(\\theta) = \\left( \\widehat{D}_{\\mathrm{comp}}(\\theta) \\right)^2 = -\\frac{1}{(\\Delta x)^2} \\left[ \\frac{\\sin(\\theta)(14 + \\cos(\\theta))}{3(3 + 2 \\cos(\\theta))} \\right]^2\n$$\n\nC. Semi-Discrete Dispersion Relation and Phase Speed Ratio\n\nThe semi-discrete form of the wave equation is $\\frac{\\partial^2 p}{\\partial t^2} - c^2 D^2 p = 0$, where $D^2$ is one of the discrete second-derivative operators. Substituting a Fourier mode $p_j(t) = \\exp(-\\mathrm{i}\\omega t)\\exp(\\mathrm{i} j \\theta)$ leads to the semi-discrete dispersion relation:\n$$\n(-\\mathrm{i}\\omega)^2 - c^2 \\widehat{D^2}(\\theta) = 0 \\implies \\omega^2 = -c^2 \\widehat{D^2}(\\theta)\n$$\nThe problem defines an effective wavenumber $k_{\\mathrm{eff}}$ such that $\\omega^2 = c^2 k_{\\mathrm{eff}}^2$. Comparing these gives $k_{\\mathrm{eff}}^2 = -\\widehat{D^2}(\\theta)$. For the non-dissipative schemes considered, $\\widehat{D^2}(\\theta)$ is real and non-positive, so $k_{\\mathrm{eff}}$ is real.\nWe define the normalized effective wavenumber as $\\theta_{\\mathrm{eff}}(\\theta) = k_{\\mathrm{eff}}(\\theta)\\Delta x = \\sqrt{-(\\Delta x)^2 \\widehat{D^2}(\\theta)}$.\nThe phase speed ratio is defined as $R(\\theta) = \\frac{\\omega/k}{c} = \\frac{k_{\\mathrm{eff}}}{k} = \\frac{k_{\\mathrm{eff}}\\Delta x}{k\\Delta x} = \\frac{\\theta_{\\mathrm{eff}}(\\theta)}{\\theta}$.\n\n1.  $D_{\\mathrm{b}} D_{\\mathrm{f}}$:\n    $\\theta_{\\mathrm{eff, bf}}^2 = -(\\Delta x)^2 \\left( \\frac{2\\cos(\\theta) - 2}{(\\Delta x)^2} \\right) = 2(1-\\cos\\theta) = 4\\sin^2(\\frac{\\theta}{2})$.\n    For $\\theta \\in [0, \\pi]$, $\\theta_{\\mathrm{eff, bf}}(\\theta) = 2\\sin(\\frac{\\theta}{2})$.\n    $R_{\\mathrm{bf}}(\\theta) = \\frac{2\\sin(\\theta/2)}{\\theta}$.\n\n2.  $D_{\\mathrm{c}}^2$:\n    $\\theta_{\\mathrm{eff, c2}}^2 = -(\\Delta x)^2 \\left( -\\frac{\\sin^2(\\theta)}{(\\Delta x)^2} \\right) = \\sin^2(\\theta)$.\n    For $\\theta \\in [0, \\pi]$, $\\theta_{\\mathrm{eff, c2}}(\\theta) = \\sin(\\theta)$.\n    $R_{\\mathrm{c2}}(\\theta) = \\frac{\\sin(\\theta)}{\\theta}$.\n\n3.  $D_{\\mathrm{comp}}^2$:\n    $\\theta_{\\mathrm{eff, comp2}}^2 = -(\\Delta x)^2 \\left( -\\frac{1}{(\\Delta x)^2} \\left[ \\frac{\\sin(\\theta)(14 + \\cos(\\theta))}{3(3 + 2 \\cos(\\theta))} \\right]^2 \\right) = \\left[ \\frac{\\sin(\\theta)(14 + \\cos(\\theta))}{3(3 + 2 \\cos(\\theta))} \\right]^2$.\n    For $\\theta \\in [0, \\pi]$, all terms in the fraction are positive, thus:\n    $\\theta_{\\mathrm{eff, comp2}}(\\theta) = \\frac{\\sin(\\theta)(14 + \\cos(\\theta))}{3(3 + 2 \\cos(\\theta))}$.\n    $R_{\\mathrm{comp2}}(\\theta) = \\frac{\\sin(\\theta)(14 + \\cos(\\theta))}{3\\theta(3 + 2 \\cos(\\theta))}$.\n\nD. Implementation\n\nThe absolute phase speed error for each scheme is $E(\\theta) = |R(\\theta) - 1|$. The following program will compute this error for the three schemes at the specified angles $\\theta = \\pi/16$, $\\theta = \\pi/2$, and $\\theta = 0.99\\pi$, using the derived expressions for $R(\\theta)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute phase speed error for three finite difference schemes\n    at specified grid-normalized wavenumbers.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        np.pi/16,\n        np.pi/2,\n        0.99 * np.pi\n    ]\n\n    # --- Define functions for the phase speed ratio R(theta) for each scheme ---\n\n    def r_bf(theta: float) - float:\n        \"\"\"Phase speed ratio for the D_b * D_f scheme.\"\"\"\n        # R(theta) = 2*sin(theta/2) / theta\n        if theta == 0:\n            return 1.0\n        return 2.0 * np.sin(theta / 2.0) / theta\n\n    def r_c2(theta: float) - float:\n        \"\"\"Phase speed ratio for the D_c^2 scheme.\"\"\"\n        # R(theta) = sin(theta) / theta\n        if theta == 0:\n            return 1.0\n        return np.sin(theta) / theta\n\n    def r_comp2(theta: float) - float:\n        \"\"\"Phase speed ratio for the D_comp^2 scheme.\"\"\"\n        # R(theta) = [sin(theta)*(14 + cos(theta))] / [3*theta*(3 + 2*cos(theta))]\n        if theta == 0:\n            return 1.0\n        \n        sin_t = np.sin(theta)\n        cos_t = np.cos(theta)\n        \n        numerator = sin_t * (14.0 + cos_t)\n        denominator = 3.0 * theta * (3.0 + 2.0 * cos_t)\n        \n        return numerator / denominator\n\n    results = []\n    schemes = [\n        ('bf', r_bf),\n        ('c2', r_c2),\n        ('comp2', r_comp2)\n    ]\n\n    # Main logic to calculate the absolute error for each case.\n    for theta in test_cases:\n        for name, r_func in schemes:\n            ratio = r_func(theta)\n            error = abs(ratio - 1.0)\n            results.append(error)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}