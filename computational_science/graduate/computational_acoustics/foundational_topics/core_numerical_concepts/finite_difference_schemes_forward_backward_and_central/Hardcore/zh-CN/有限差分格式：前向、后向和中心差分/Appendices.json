{
    "hands_on_practices": [
        {
            "introduction": "构建高精度的有限差分格式是计算科学的基石。本练习将引导你完成一个基本过程：通过系统地匹配泰勒级数展开中的项，来推导高阶格式的系数。通过为内部点构建对称中心差分格式以及为边界点构建单边格式，你将掌握设计精确数值算子的核心原理 。",
            "id": "4124043",
            "problem": "考虑均匀介质中的一维线性声学，由线性化欧拉方程组 $u_{t} + \\frac{1}{\\rho_{0}} p_{x} = 0$ 和 $p_{t} + \\rho_{0} c^{2} u_{x} = 0$ 描述，其中$p(x,t)$是声压，$u(x,t)$是质点速度，$c$是声速，$\\rho_{0}$是环境密度。在一个间距为$h$的均匀空间网格$x_{i} = i h$上，假设我们希望为这些方程的半离散化形式构造空间导数算子的高阶有限差分近似。\n\n在内部点，考虑一阶导数的对称中心有限差分近似，该近似由三个未知系数 $a_{1}, a_{2}, a_{3}$ 参数化：\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\left[ a_{1}\\left(f_{i+1} - f_{i-1}\\right) + a_{2}\\left(f_{i+2} - f_{i-2}\\right) + a_{3}\\left(f_{i+3} - f_{i-3}\\right) \\right].\n$$\n在左边界$x_{0} = 0$处，考虑一个使用五个节点、具有未知系数 $b_{0}, b_{1}, b_{2}, b_{3}, b_{4}$ 的单边前向有限差分近似：\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\left[ b_{0} f_{0} + b_{1} f_{1} + b_{2} f_{2} + b_{3} f_{3} + b_{4} f_{4} \\right].\n$$\n\n仅从$x_{i}$处的泰勒级数展开和平面波拟设 $f(x) = \\exp(i k x)$ 出发，推导以下内容：\n\n1. 系数 $a_{1}, a_{2}, a_{3}$，使得 $(\\mathcal{D}_{c} f)_{i}$ 是 $f'(x_{i})$ 的六阶精确近似，即截断误差为 $\\mathcal{O}(h^{6})$。\n2. 中心算子的主阶色散-截断系数 $\\gamma$，由将 $\\mathcal{D}_{c}$ 应用于傅里叶模式 $f_{i} = \\exp(i k x_{i})$ 得到的有效波数 $k_{\\mathrm{eff}}$ 的小 $k h$ 展开式定义，即\n$$\nk_{\\mathrm{eff}} = k - \\gamma \\, k^{7} h^{6} + \\mathcal{O}(k^{9} h^{8}).\n$$\n将 $\\gamma$ 表示为一个实常数的闭合形式。\n3. 系数 $b_{0}, b_{1}, b_{2}, b_{3}, b_{4}$，使得 $(\\mathcal{D}_{f} f)_{0}$ 是 $f'(x_{0})$ 的四阶精确近似，即截断误差为 $\\mathcal{O}(h^{4})$。\n\n将您的最终答案以单行矩阵的形式给出，其中按顺序包含 $(a_{1}, a_{2}, a_{3}, \\gamma, b_{0}, b_{1}, b_{2}, b_{3}, b_{4})$ 这些项。不需要四舍五入，所有系数都应表示为精确的有理数。最终答案是无量纲的，不需要单位。",
            "solution": "该问题陈述清晰且科学上合理，是偏微分方程数值方法开发中的一个标准任务。我们被要求通过泰勒级数分析施加精度约束来推导有限差分格式的系数，并对所得格式进行色散分析。\n\n问题分为三个部分。我们将按顺序逐一解决。\n\n第1部分：确定六阶中心差分格式的系数。\n\n给定一阶导数 $f'(x_i)$ 的对称中心差分算子：\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\left[ a_{1}\\left(f_{i+1} - f_{i-1}\\right) + a_{2}\\left(f_{i+2} - f_{i-2}\\right) + a_{3}\\left(f_{i+3} - f_{i-3}\\right) \\right]\n$$\n为确定系数 $a_1, a_2, a_3$，我们将函数值 $f_{i \\pm j} = f(x_i \\pm jh)$ 在 $x_i$ 周围展开成泰勒级数。\n$$\nf(x_i \\pm jh) = f(x_i) \\pm (jh)f'(x_i) + \\frac{(jh)^2}{2!}f''(x_i) \\pm \\frac{(jh)^3}{3!}f'''(x_i) + \\dots\n$$\n差值 $f_{i+j} - f_{i-j}$ 由下式给出：\n$$\nf_{i+j} - f_{i-j} = 2jh f'_{i} + 2\\frac{(jh)^3}{3!} f'''_{i} + 2\\frac{(jh)^5}{5!} f^{(5)}_{i} + 2\\frac{(jh)^7}{7!} f^{(7)}_{i} + \\mathcal{O}(h^9)\n$$\n其中 $f_i^{(n)} = f^{(n)}(x_i)$。将此代入 $j = 1, 2, 3$ 的算子表达式中：\n$$\n(\\mathcal{D}_{c} f)_{i} = \\frac{1}{h} \\sum_{j=1}^{3} a_j \\left( 2jh f'_{i} + \\frac{j^3h^3}{3} f'''_{i} + \\frac{j^5h^5}{60} f^{(5)}_{i} + \\frac{j^7h^7}{2520} f^{(7)}_{i} + \\dots \\right)\n$$\n我们按 $f$ 的导数阶数对各项进行分组：\n$$\n(\\mathcal{D}_{c} f)_{i} = \\left(2 \\sum_{j=1}^{3} j a_j\\right) f'_{i} + h^2 \\left(\\frac{1}{3} \\sum_{j=1}^{3} j^3 a_j\\right) f'''_{i} + h^4 \\left(\\frac{1}{60} \\sum_{j=1}^{3} j^5 a_j\\right) f^{(5)}_{i} + h^6 \\left(\\frac{1}{2520} \\sum_{j=1}^{3} j^7 a_j\\right) f^{(7)}_{i} + \\dots\n$$\n为使该算子成为 $f'_{i}$ 的近似，$f'_{i}$ 的系数必须为 $1$。为使其达到六阶精度，截断误差必须为 $\\mathcal{O}(h^6)$，这意味着 $h^2 f'''_i$ 和 $h^4 f^{(5)}_i$ 项的系数必须为零。这就产生了一个关于 $a_1, a_2, a_3$ 的三元线性方程组：\n1. $2(a_1 + 2a_2 + 3a_3) = 1 \\implies a_1 + 2a_2 + 3a_3 = \\frac{1}{2}$\n2. $\\frac{1}{3}(a_1 + 8a_2 + 27a_3) = 0 \\implies a_1 + 8a_2 + 27a_3 = 0$\n3. $\\frac{1}{60}(a_1 + 32a_2 + 243a_3) = 0 \\implies a_1 + 32a_2 + 243a_3 = 0$\n\n我们求解这个方程组。将第三个方程减去第二个方程：\n$(a_1 + 32a_2 + 243a_3) - (a_1 + 8a_2 + 27a_3) = 0 \\implies 24a_2 + 216a_3 = 0 \\implies a_2 = -9a_3$。\n将 $a_2 = -9a_3$ 代入第二个方程：\n$a_1 + 8(-9a_3) + 27a_3 = 0 \\implies a_1 - 72a_3 + 27a_3 = 0 \\implies a_1 = 45a_3$。\n现在将 $a_1$ 和 $a_2$ 都代入第一个方程：\n$45a_3 + 2(-9a_3) + 3a_3 = \\frac{1}{2} \\implies 45a_3 - 18a_3 + 3a_3 = \\frac{1}{2} \\implies 30a_3 = \\frac{1}{2} \\implies a_3 = \\frac{1}{60}$。\n由此，我们求得 $a_1$ 和 $a_2$：\n$a_1 = 45 \\left(\\frac{1}{60}\\right) = \\frac{45}{60} = \\frac{3}{4}$。\n$a_2 = -9 \\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20}$。\n系数为 $a_1 = \\frac{3}{4}$，$a_2 = -\\frac{3}{20}$，以及 $a_3 = \\frac{1}{60}$。\n\n第2部分：确定色散系数 $\\gamma$。\n\n我们将算子 $\\mathcal{D}_c$ 应用于平面波拟设 $f_j = f(x_j) = \\exp(ikx_j)$。精确导数为 $f'(x_j) = ik \\exp(ikx_j) = ik f_j$。数值导数定义为 $(\\mathcal{D}_c f)_j = ik_{\\mathrm{eff}} f_j$。\n$$\nf_{j+m} - f_{j-m} = \\exp(ik(x_j+mh)) - \\exp(ik(x_j-mh)) = \\exp(ikx_j) (\\exp(ikmh) - \\exp(-ikmh)) = f_j (2i \\sin(kmh))\n$$\n将其代入 $\\mathcal{D}_c$ 的定义中：\n$$\n(\\mathcal D_c f)_j = \\frac{1}{h} \\sum_{m=1}^{3} a_m (f_{j+m} - f_{j-m}) = \\frac{1}{h} \\sum_{m=1}^{3} a_m (2i \\sin(kmh)) f_j = \\frac{2i}{h} \\left( \\sum_{m=1}^{3} a_m \\sin(kmh) \\right) f_j\n$$\n与 $(\\mathcal{D}_c f)_j = ik_{\\mathrm{eff}} f_j$ 比较，我们得到有效波数 $k_{\\mathrm{eff}}$：\n$$\nk_{\\mathrm{eff}} = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(kmh)\n$$\n我们将 $\\sin(kmh)$ 对小 $kh$ 进行展开：\n$$\n\\sin(kmh) = (kmh) - \\frac{(kmh)^3}{3!} + \\frac{(kmh)^5}{5!} - \\frac{(kmh)^7}{7!} + \\mathcal{O}((kh)^9)\n$$\n将其代入 $k_{\\mathrm{eff}}$ 的表达式中：\n$$\nk_{\\mathrm{eff}} = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\left( kmh - \\frac{k^3m^3h^3}{6} + \\frac{k^5m^5h^5}{120} - \\frac{k^7m^7h^7}{5040} + \\dots \\right)\n$$\n$$\nk_{\\mathrm{eff}} = k \\left(2\\sum m a_m\\right) - k^3h^2 \\left(\\frac{1}{3}\\sum m^3 a_m\\right) + k^5h^4 \\left(\\frac{1}{60}\\sum m^5 a_m\\right) - k^7h^6 \\left(\\frac{1}{2520}\\sum m^7 a_m\\right) + \\dots\n$$\n根据第1部分推导出的约束条件，我们知道：\n$2\\sum m a_m = 1$\n$\\sum m^3 a_m = 0$\n$\\sum m^5 a_m = 0$\n$k_{\\mathrm{eff}}$ 的表达式简化为：\n$$\nk_{\\mathrm{eff}} = k - \\frac{k^7 h^6}{2520} \\left( \\sum_{m=1}^{3} m^7 a_m \\right) + \\mathcal{O}(k^9h^8)\n$$\n将其与给定形式 $k_{\\mathrm{eff}} = k - \\gamma k^7 h^6 + \\mathcal{O}(k^9h^8)$ 进行比较，我们确定 $\\gamma$ 为：\n$$\n\\gamma = \\frac{1}{2520} \\sum_{m=1}^{3} m^7 a_m = \\frac{1}{2520} (1^7 a_1 + 2^7 a_2 + 3^7 a_3)\n$$\n代入 $a_1, a_2, a_3$ 的值：\n$$\n\\sum m^7 a_m = (1)\\left(\\frac{3}{4}\\right) + (128)\\left(-\\frac{3}{20}\\right) + (2187)\\left(\\frac{1}{60}\\right) = \\frac{3}{4} - \\frac{384}{20} + \\frac{2187}{60}\n$$\n使用公分母 $60$：\n$$\n\\frac{45}{60} - \\frac{1152}{60} + \\frac{2187}{60} = \\frac{45 - 1152 + 2187}{60} = \\frac{1080}{60} = 18\n$$\n因此，$\\gamma = \\frac{18}{2520}$。化简该分数：\n$$\n\\gamma = \\frac{18}{2520} = \\frac{1}{140}\n$$\n\n第3部分：确定四阶前向差分格式的系数。\n\n给定单边前向差分算子：\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\left[ b_{0} f_{0} + b_{1} f_{1} + b_{2} f_{2} + b_{3} f_{3} + b_{4} f_{4} \\right]\n$$\n我们将 $f_j = f(x_j) = f(x_0+jh)$ 在 $x_0$ 处展开为泰勒级数：\n$$\nf_j = f_0 + (jh)f'_0 + \\frac{(jh)^2}{2!}f''_0 + \\frac{(jh)^3}{3!}f'''_0 + \\frac{(jh)^4}{4!}f^{(4)}_0 + \\mathcal{O}(h^5)\n$$\n将此代入算子中：\n$$\n(\\mathcal{D}_{f} f)_{0} = \\frac{1}{h} \\sum_{j=0}^{4} b_j \\left(f_0 + (jh)f'_0 + \\frac{j^2h^2}{2}f''_0 + \\dots \\right) = \\left(\\frac{1}{h}\\sum b_j \\right)f_0 + \\left(\\sum j b_j \\right)f'_0 + h\\left(\\frac{1}{2}\\sum j^2 b_j \\right)f''_0 + \\dots\n$$\n为了在近似 $f'_0$ 时达到四阶精度，前五项必须与 $f'_0$ 的泰勒展开式相匹配。这导出了一个关于 $b_0, \\dots, b_4$ 的 $5$ 元线性方程组：\n1. $\\sum_{j=0}^{4} b_j = 0$\n2. $\\sum_{j=0}^{4} j b_j = 1$\n3. $\\sum_{j=0}^{4} j^2 b_j = 0$\n4. $\\sum_{j=0}^{4} j^3 b_j = 0$\n5. $\\sum_{j=0}^{4} j^4 b_j = 0$\n\n这个范德蒙型方程组可以直接求解。或者，我们可以使用基于前向差分算子 $\\Delta_h f(x) = f(x+h) - f(x)$ 的待定系数法。导数算子可以表示为 $D = \\frac{1}{h}\\ln(E) = \\frac{1}{h}\\ln(1+\\Delta_h)$，其中 $E$ 是位移算子。\n$$\nf'(x_0) = \\frac{1}{h} \\left(\\Delta_h - \\frac{\\Delta_h^2}{2} + \\frac{\\Delta_h^3}{3} - \\frac{\\Delta_h^4}{4} + \\dots \\right) f(x_0)\n$$\n在 $\\mathcal{O}(h^4)$ 项处截断，我们得到 $h f'_0$ 的近似式：\n$$\nh f'_0 \\approx \\Delta_h f_0 - \\frac{1}{2}\\Delta_h^2 f_0 + \\frac{1}{3}\\Delta_h^3 f_0 - \\frac{1}{4}\\Delta_h^4 f_0\n$$\n我们用函数值 $f_j$ 来表示 $\\Delta_h$ 的幂：\n$\\Delta_h f_0 = f_1 - f_0$\n$\\Delta_h^2 f_0 = f_2 - 2f_1 + f_0$\n$\\Delta_h^3 f_0 = f_3 - 3f_2 + 3f_1 - f_0$\n$\\Delta_h^4 f_0 = f_4 - 4f_3 + 6f_2 - 4f_1 + f_0$\n将这些代入 $h f'_0$ 的近似式中：\n$$\nh f'_0 \\approx (f_1-f_0) - \\frac{1}{2}(f_2-2f_1+f_0) + \\frac{1}{3}(f_3-3f_2+3f_1-f_0) - \\frac{1}{4}(f_4-4f_3+6f_2-4f_1+f_0)\n$$\n收集每个 $f_j$ 的系数：\n$b_0$: $-1 - \\frac{1}{2} - \\frac{1}{3} - \\frac{1}{4} = -\\frac{12+6+4+3}{12} = -\\frac{25}{12}$\n$b_1$: $1 - \\frac{1}{2}(-2) + \\frac{1}{3}(3) - \\frac{1}{4}(-4) = 1+1+1+1=4$\n$b_2$: $-\\frac{1}{2}(1) + \\frac{1}{3}(-3) - \\frac{1}{4}(6) = -\\frac{1}{2} - 1 - \\frac{3}{2} = -3$\n$b_3$: $\\frac{1}{3}(1) - \\frac{1}{4}(-4) = \\frac{1}{3} + 1 = \\frac{4}{3}$\n$b_4$: $-\\frac{1}{4}(1) = -\\frac{1}{4}$\n所以，系数为 $b_0 = -\\frac{25}{12}$，$b_1 = 4$，$b_2 = -3$，$b_3 = \\frac{4}{3}$，$b_4 = -\\frac{1}{4}$。这些系数满足前面推导的线性方程组。\n\n最终结果是所有推导出的系数的集合。\n$a_1 = \\frac{3}{4}$, $a_2 = -\\frac{3}{20}$, $a_3 = \\frac{1}{60}$\n$\\gamma = \\frac{1}{140}$\n$b_0 = -\\frac{25}{12}$, $b_1 = 4$, $b_2 = -3$, $b_3 = \\frac{4}{3}$, $b_4 = -\\frac{1}{4}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{4}  -\\frac{3}{20}  \\frac{1}{60}  \\frac{1}{140}  -\\frac{25}{12}  4  -3  \\frac{4}{3}  -\\frac{1}{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "交错网格上的蛙跳格式是求解波动方程最有效且最广泛使用的方法之一。本练习从静态的导数计算转向完整的时域仿真，指导你为这种经典的有限差分时域（FDTD）方法推导其更新方程。随后，你将执行冯·诺依曼分析，以推导出该格式的色散关系和至关重要的库朗稳定性条件，这些都是任何实践者必须掌握的基本知识 。",
            "id": "4124032",
            "problem": "考虑在具有恒定质量密度 $\\rho_0$ 和声速 $c$ 的均匀介质中，压力 $p(x,t)$ 和质点速度 $u(x,t)$ 的一维线性声学方程。控制方程为连续性方程和动量方程：$$\\frac{\\partial p}{\\partial t} = - \\rho_0 c^2 \\frac{\\partial u}{\\partial x}, \\quad \\frac{\\partial u}{\\partial t} = - \\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x}.$$所有物理量均使用国际单位制 (SI)：$x$ 的单位是米 ($\\mathrm{m}$)，$t$ 的单位是秒 ($\\mathrm{s}$)，$p$ 的单位是帕斯卡 ($\\mathrm{Pa}$)，$u$ 的单位是米/秒 ($\\mathrm{m/s}$)，$\\rho_0$ 的单位是千克/立方米 ($\\mathrm{kg/m^3}$)，$c$ 的单位是米/秒 ($\\mathrm{m/s}$)。使用均匀交错空间网格，其中压力 $p_j^n$ 定义在整数索引 $j$ 的位置 $x_j = j \\Delta x$ 上，质点速度 $u_{j+1/2}^{n+1/2}$ 定义在半整数索引的位置 $x_{j+1/2} = (j + 1/2) \\Delta x$ 和半时间步 $t^{n+1/2} = (n + 1/2) \\Delta t$ 上。采用蛙跳时间步进策略，其中 $u$ 在半时间步更新，$p$ 在整时间步更新，并使用与交错网格一致的前向或后向差分来近似空间导数，从而使离散空间导数在相邻的交错点之间中心化。\n\n从上述方程和定义出发，执行以下任务：\n\n- 在交错网格上，使用蛙跳格式和在时间上中心、在空间上适当前向或后向的有限差分，推导 $u_{j+1/2}^{n+1/2}$ 和 $p_j^{n+1}$ 的离散更新方程。不要假设任何预先推导的更新公式；从连续方程和离散网格定义开始。\n- 使用角频率为 $\\omega$、波数为 $k$ 的平面波拟设，构建在推导出的有限差分格式下连接 $\\omega$ 和 $k$ 的离散色散关系。\n- 从离散色散关系中，确定对库朗数 $r = c \\Delta t / \\Delta x$ 的稳定性条件，并给出 $\\omega$ 保持为实值的条件。\n- 实现一个程序，给定 $(c, \\Delta x, \\Delta t, N_x)$，计算：\n  1. 库朗数 $r = c \\Delta t / \\Delta x$（无量纲）。\n  2. 离散无量纲波数集合 $\\kappa_m = k_m \\Delta x = 2 \\pi m / N_x$，其中整数 $m$ 从 $m = 1$ 到 $m = N_x/2$，假设在 $N_x$ 个点的均匀网格上具有周期性。角度单位是弧度。\n  3. 对于每个 $\\kappa_m$，计算由离散色散关系所蕴含的数值相速度 $c_p^{\\mathrm{num}}$。将其与物理相速度 $c$ 进行比较，并计算相对相速度误差 $\\left| c_p^{\\mathrm{num}} - c \\right| / c$（无量纲）。\n  4. 在所有模式 $m \\in \\{1, \\dots, N_x/2\\}$ 上的最大相对相速度误差（无量纲）。如果格式不稳定（即，计算出的 $r$ 违反了稳定性条件），则将最大误差设置为浮点值 $-1.0$。\n  5. 一个布尔类型的稳定性标志 $S$，如果稳定则 $S = \\mathrm{True}$，如果不稳定则 $S = \\mathrm{False}$。\n- 你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个条目对应一个测试用例，并且必须是一个双元素列表 $[E,S]$，其中 $E$ 是最大相对相速度误差（浮点数，无量纲），$S$ 是稳定性布尔值。例如，格式应类似于 $[[E_1,S_1],[E_2,S_2],\\dots]$，不含空格。\n\n使用以下参数值测试套件来运行该实现：\n\n- 情况 1（一般稳定情况）：$c = 343 \\ \\mathrm{m/s}$，$\\Delta x = 0.01 \\ \\mathrm{m}$，选择 $\\Delta t$ 使得 $r = 0.9$，以及 $N_x = 128$。\n- 情况 2（稳定性边界）：$c = 343 \\ \\mathrm{m/s}$，$\\Delta x = 0.01 \\ \\mathrm{m}$，选择 $\\Delta t$ 使得 $r = 1.0$，以及 $N_x = 128$。\n- 情况 3（不稳定情况）：$c = 343 \\ \\mathrm{m/s}$，$\\Delta x = 0.01 \\ \\mathrm{m}$，选择 $\\Delta t$ 使得 $r = 1.1$，以及 $N_x = 128$。\n- 情况 4（粗网格边界情况）：$c = 343 \\ \\mathrm{m/s}$，$\\Delta x = 0.5 \\ \\mathrm{m}$，选择 $\\Delta t$ 使得 $r = 0.9$，以及 $N_x = 4$。\n\n所有的 $c$、$\\Delta x$ 和 $\\Delta t$ 都必须以国际单位制（分别为 $\\mathrm{m/s}$、$\\mathrm{m}$ 和 $\\mathrm{s}$）进行解释；输出误差 $E$ 是无量纲的，稳定性标志 $S$ 是布尔值。任何三角量的角度单位都是弧度。你的程序应以上述确切格式生成最终输出行。",
            "solution": "该问题是有效的，因为它在科学上基于声学和数值分析的原理，是适定、客观的，并包含了推导所需结果和实现相应程序的所有必要信息。\n\n解答过程分几步进行：首先，从连续控制方程推导离散更新方程；其次，推导离散色散关系和稳定性条件；第三，数值相速度及其相关误差的公式。\n\n### 1. 离散更新方程的推导\n\n问题描述了在交错空间网格上的蛙跳时间步进格式。压力 $p_j^n$ 定义在整数空间索引 $j$ 和整时间步 $n$ 上，即在 $(x_j, t^n) = (j \\Delta x, n \\Delta t)$。质点速度 $u_{j+1/2}^{n+1/2}$ 定义在半整数空间索引和半整数时间步上，即在 $(x_{j+1/2}, t^{n+1/2}) = ((j + 1/2) \\Delta x, (n + 1/2) \\Delta t)$。\n\n蛙跳时域有限差分 (FDTD) 方法的核心思想是在用于近似的网格点之间的中心位置评估时间和空间导数。这会得到一个二阶精度的格式。\n\n**质点速度 $u$ 的更新方程：**\n\n动量方程为 $\\frac{\\partial u}{\\partial t} = - \\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x}$。我们使用 $t^n$ 时刻的压力值将 $u$ 从 $t^{n-1/2}$ 时刻更新到 $t^{n+1/2}$ 时刻。这需要在 $(x_{j+1/2}, t^n)$ 处评估导数。\n\n在 $(x_{j+1/2}, t^n)$ 处的时间导数 $\\frac{\\partial u}{\\partial t}$ 使用以 $t^n$ 为中心的时间中心差分来近似：\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j+1/2, n} \\approx \\frac{u_{j+1/2}^{n+1/2} - u_{j+1/2}^{n-1/2}}{\\Delta t}\n$$\n在 $(x_{j+1/2}, t^n)$ 处的空间导数 $\\frac{\\partial p}{\\partial x}$ 使用以 $x_{j+1/2}$ 为中心的空间中心差分来近似：\n$$\n\\frac{\\partial p}{\\partial x} \\bigg|_{j+1/2, n} \\approx \\frac{p_{j+1}^n - p_j^n}{\\Delta x}\n$$\n将这些代入动量方程得到：\n$$\n\\frac{u_{j+1/2}^{n+1/2} - u_{j+1/2}^{n-1/2}}{\\Delta t} = - \\frac{1}{\\rho_0} \\frac{p_{j+1}^n - p_j^n}{\\Delta x}\n$$\n整理得到 $u_{j+1/2}^{n+1/2}$ 的第一个更新方程：\n$$\nu_{j+1/2}^{n+1/2} = u_{j+1/2}^{n-1/2} - \\frac{\\Delta t}{\\rho_0 \\Delta x} (p_{j+1}^n - p_j^n)\n$$\n\n**压力 $p$ 的更新方程：**\n\n连续性方程为 $\\frac{\\partial p}{\\partial t} = - \\rho_0 c^2 \\frac{\\partial u}{\\partial x}$。我们使用 $t^{n+1/2}$ 时刻的速度值将 $p$ 从 $t^n$ 时刻更新到 $t^{n+1}$ 时刻。这需要在 $(x_j, t^{n+1/2})$ 处评估导数。\n\n在 $(x_j, t^{n+1/2})$ 处的时间导数 $\\frac{\\partial p}{\\partial t}$ 使用以 $t^{n+1/2}$ 为中心的时间中心差分来近似：\n$$\n\\frac{\\partial p}{\\partial t} \\bigg|_{j, n+1/2} \\approx \\frac{p_j^{n+1} - p_j^n}{\\Delta t}\n$$\n在 $(x_j, t^{n+1/2})$ 处的空间导数 $\\frac{\\partial u}{\\partial x}$ 使用以 $x_j$ 为中心的空间中心差分来近似：\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j, n+1/2} \\approx \\frac{u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2}}{\\Delta x}\n$$\n将这些代入连续性方程得到：\n$$\n\\frac{p_j^{n+1} - p_j^n}{\\Delta t} = - \\rho_0 c^2 \\frac{u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2}}{\\Delta x}\n$$\n整理得到 $p_j^{n+1}$ 的第二个更新方程：\n$$\np_j^{n+1} = p_j^n - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} (u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2})\n$$\n\n### 2. 离散色散关系和稳定性条件\n\n为了分析该格式的性质，我们对离散变量使用平面波拟设：\n$$\np_j^n = P_0 e^{i(k x_j - \\omega t^n)} = P_0 e^{i(k j \\Delta x - \\omega n \\Delta t)}\n$$\n$$\nu_{j+1/2}^{n+1/2} = U_0 e^{i(k x_{j+1/2} - \\omega t^{n+1/2})} = U_0 e^{i(k (j+1/2) \\Delta x - \\omega (n+1/2) \\Delta t)}\n$$\n其中 $k$ 是波数，$\\omega$ 是角频率，$P_0, U_0$ 是复振幅。将拟设代入 $u$ 的更新方程：\n$$\nU_0 e^{i(k(j+1/2)\\Delta x - \\omega(n+1/2)\\Delta t)} - U_0 e^{i(k(j+1/2)\\Delta x - \\omega(n-1/2)\\Delta t)} = - \\frac{\\Delta t}{\\rho_0 \\Delta x} (P_0 e^{i(k(j+1)\\Delta x - \\omega n \\Delta t)} - P_0 e^{i(kj\\Delta x - \\omega n \\Delta t)})\n$$\n除以公因子 $e^{i k(j+1/2)\\Delta x} e^{-i\\omega n \\Delta t}$：\n$$\nU_0 (e^{-i\\omega\\Delta t/2} - e^{i\\omega\\Delta t/2}) = - \\frac{\\Delta t P_0}{\\rho_0 \\Delta x} (e^{ik\\Delta x/2} - e^{-ik\\Delta x/2})\n$$\n使用欧拉公式 (Euler's formula)，$e^{i\\theta} - e^{-i\\theta} = 2i \\sin\\theta$：\n$$\nU_0 (-2i \\sin(\\omega\\Delta t/2)) = - \\frac{\\Delta t P_0}{\\rho_0 \\Delta x} (2i \\sin(k\\Delta x/2))\n$$\n$$\n\\frac{U_0}{P_0} = \\frac{\\Delta t}{\\rho_0 \\Delta x} \\frac{\\sin(k\\Delta x/2)}{\\sin(\\omega\\Delta t/2)} \\quad (1)\n$$\n接下来，将拟设代入 $p$ 的更新方程：\n$$\nP_0 (e^{-i\\omega\\Delta t} - 1)e^{i(kj\\Delta x - \\omega n \\Delta t)} = - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} U_0 (e^{ik\\Delta x/2} - e^{-ik\\Delta x/2}) e^{i(kj\\Delta x - \\omega(n+1/2)\\Delta t)}\n$$\n$$\nP_0 e^{-i\\omega\\Delta t/2}(e^{-i\\omega\\Delta t/2} - e^{i\\omega\\Delta t/2}) = - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} U_0 (2i \\sin(k\\Delta x/2)) e^{-i\\omega\\Delta t/2}\n$$\n$$\nP_0 (-2i \\sin(\\omega\\Delta t/2)) = - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} U_0 (2i \\sin(k\\Delta x/2))\n$$\n$$\n\\frac{P_0}{U_0} = \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\frac{\\sin(k\\Delta x/2)}{\\sin(\\omega\\Delta t/2)} \\quad (2)\n$$\n将方程 (1) 乘以方程 (2)：\n$$\n1 = \\left( \\frac{\\Delta t}{\\rho_0 \\Delta x} \\frac{\\sin(k\\Delta x/2)}{\\sin(\\omega\\Delta t/2)} \\right) \\left( \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\frac{\\sin(k\\Delta x/2)}{\\sin(\\omega\\Delta t/2)} \\right)\n$$\n$$\n1 = c^2 \\left(\\frac{\\Delta t}{\\Delta x}\\right)^2 \\frac{\\sin^2(k\\Delta x/2)}{\\sin^2(\\omega\\Delta t/2)}\n$$\n令库朗数 $r = c \\Delta t / \\Delta x$，我们得到离散色散关系：\n$$\n\\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) = r^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n对于一个稳定的、非放大的数值解，角频率 $\\omega$ 必须是实数。这意味着 $\\sin(\\omega \\Delta t / 2)$ 必须是实数，并且其值必须在 $[-1, 1]$ 范围内。因此，我们必须有：\n$$\n\\left| r \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right| \\leq 1\n$$\n由于 $\\sin(k \\Delta x / 2)$ 可以等于 $1$（例如，对于奈奎斯特波数 $k = \\pi/\\Delta x$），该条件必须在最坏情况下成立。这要求 $|r| \\le 1$。由于 $c, \\Delta t, \\Delta x$ 均为正值，稳定性条件是：\n$$\nr = \\frac{c \\Delta t}{\\Delta x} \\leq 1\n$$\n\n### 3. 数值相速度和误差\n\n从色散关系可知 $\\sin(\\frac{\\omega \\Delta t}{2}) = \\pm r \\sin(\\frac{k \\Delta x}{2})$。对于前向传播波，我们取正根。求解 $\\omega$：\n$$\n\\omega = \\frac{2}{\\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)\n$$\n数值相速度为 $c_p^{\\mathrm{num}} = \\omega/k$。\n$$\nc_p^{\\mathrm{num}} = \\frac{2}{k \\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)\n$$\n为了分析误差，我们将其与物理相速度 $c$ 进行比较。其比率为：\n$$\n\\frac{c_p^{\\mathrm{num}}}{c} = \\frac{2}{c k \\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right) = \\frac{2}{k (r \\Delta x)} \\arcsin\\left(r \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)\n$$\n令 $\\kappa = k \\Delta x$ 为无量纲波数。表达式变为：\n$$\n\\frac{c_p^{\\mathrm{num}}}{c} = \\frac{2}{r \\kappa} \\arcsin\\left(r \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\n相对相速度误差由 $\\left| \\frac{c_p^{\\mathrm{num}}}{c} - 1 \\right|$ 给出。程序将为每个离散波数 $\\kappa_m = 2 \\pi m / N_x$（其中 $m \\in \\{1, \\dots, N_x/2\\}$）计算此误差，并找到最大值。如果格式不稳定（$r  1$），此分析无效，因为 $\\omega$ 会变为复数，并且误差被赋值为 $-1.0$。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_metrics(c, dx, r_val, Nx):\n    \"\"\"\n    Calculates stability and maximum relative phase speed error for a given set of parameters.\n\n    Args:\n        c (float): Speed of sound (m/s).\n        dx (float): Spatial grid spacing (m).\n        r_val (float): Courant number.\n        Nx (int): Number of grid points.\n\n    Returns:\n        list: A two-element list [E, S] where E is the max relative error (float)\n              and S is the stability flag (bool).\n    \"\"\"\n    dt = r_val * dx / c\n    r = c * dt / dx\n\n    is_stable = (r = 1.0)\n    \n    if not is_stable:\n        return [-1.0, False]\n\n    # Modes m from 1 to Nx/2\n    # np.arange is exclusive of the stop value, so we need +1\n    m_values = np.arange(1, Nx // 2 + 1)\n    \n    # Nondimensional wavenumbers kappa_m = k_m * dx\n    kappa_values = 2 * np.pi * m_values / Nx\n    \n    # Calculate the ratio of numerical to physical phase velocity\n    # The term inside arcsin must not exceed 1.0, which is guaranteed by the stability check.\n    # A small epsilon is added to avoid potential division by zero if kappa_values could be zero,\n    # though here it starts from m=1, so kappa is never zero.\n    \n    # Expression for c_p_num / c\n    # sin_kappa_half = np.sin(kappa_values / 2) creates a vector of values\n    # The whole expression is vectorized with numpy\n    ratio_c_p_num_c = (2 / (r * kappa_values)) * np.arcsin(r * np.sin(kappa_values / 2))\n    \n    # Relative phase speed error\n    # This is also a vectorized operation\n    relative_errors = np.abs(ratio_c_p_num_c - 1)\n    \n    # Find the maximum error over all computed modes\n    max_relative_error = np.max(relative_errors)\n    \n    return [max_relative_error, True]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the final output.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # Format: (c, delta_x, target_courant_r, Nx)\n    test_cases = [\n        # Case 1: stable case\n        (343.0, 0.01, 0.9, 128),\n        # Case 2: stability boundary\n        (343.0, 0.01, 1.0, 128),\n        # Case 3: unstable case\n        (343.0, 0.01, 1.1, 128),\n        # Case 4: coarse grid edge case\n        (343.0, 0.5, 0.9, 4),\n    ]\n\n    results = []\n    for case in test_cases:\n        c, dx, r_val, Nx = case\n        result = calculate_metrics(c, dx, r_val, Nx)\n        results.append(result)\n\n    # Format the final output string as specified in the problem.\n    # Example: [[E1,S1],[E2,S2]]\n    # str(list) creates the '[E, S]' part, and join forms the comma-separated list of lists.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # The problem asks for no spaces between list elements\n    output_str_no_spaces = output_str.replace(\" \", \"\")\n\n    print(output_str_no_spaces)\n\nsolve()\n```"
        },
        {
            "introduction": "波动方程的数值解常常会受到虚假的网格尺度振荡的干扰。本练习提供了一个实践视角，审视如何利用人工粘性和显式滤波这两种常见的稳定化技术来控制这些伪影。通过对离散方程进行傅里叶分析，你将学习如何量化每种方法的阻尼效应，并设计一个能够实现特定稳定化目标的滤波器 。",
            "id": "4124045",
            "problem": "考虑在具有恒定质量密度 $\\rho_{0}$ 和声速 $c$ 的均匀介质中的一维小振幅声学，由以下线性化一阶系统描述\n$$\np_{t} + \\rho_{0} c^{2} u_{x} = 0, \\qquad u_{t} + \\frac{1}{\\rho_{0}} p_{x} = 0,\n$$\n其中 $p(x,t)$ 是声压，$u(x,t)$ 是质点速度。设空间域在均匀无限网格 $x_{j} = j \\,\\Delta x$ 上进行离散化，网格索引为 $j \\in \\mathbb{Z}$，网格间距为 $\\Delta x  0$。考虑使用时间步长为 $\\Delta t  0$ 的显式前向欧拉时间步进法，并对空间导数使用二阶中心有限差分。为了正则化网格尺度的振荡，用以下方式增强半离散格式：\n- 在速度方程中加入人工粘性，建模为拉普拉斯项 $\\nu u_{xx}$，其中粘性系数 $\\nu  0$。\n- 在每次时间更新后，对压力应用一个显式对称线性滤波器，由离散算子 $p \\mapsto p + \\sigma \\,\\Delta x^{2} D_{xx} p$ 定义，其中 $D_{xx}$ 是二阶中心二阶差分算子，$\\sigma \\ge 0$ 是无量纲滤波器强度。\n\n一个时间步 $t^{n} \\to t^{n+1} = t^{n} + \\Delta t$ 的全离散更新为\n$$\np_{j}^{n+1,\\star} = p_{j}^{n} - \\Delta t \\,\\rho_{0} c^{2} \\,D_{x} u_{j}^{n}, \\qquad\nu_{j}^{n+1} = u_{j}^{n} - \\Delta t \\,\\frac{1}{\\rho_{0}} \\,D_{x} p_{j}^{n} + \\Delta t \\,\\nu \\,D_{xx} u_{j}^{n},\n$$\n接着进行压力滤波\n$$\np_{j}^{n+1} = p_{j}^{n+1,\\star} + \\sigma \\,\\Delta x^{2} \\,D_{xx} p_{j}^{n+1,\\star},\n$$\n其中 $D_{x} q_{j} = \\frac{q_{j+1} - q_{j-1}}{2 \\Delta x}$ 且 $D_{xx} q_{j} = \\frac{q_{j+1} - 2 q_{j} + q_{j-1}}{\\Delta x^{2}}$。\n\n对该格式进行简正模 (Fourier) 分析。设无量纲波数为 $\\kappa = k \\,\\Delta x$ 的单个 Fourier 模为 $q_{j}^{n} = \\widehat{q}^{n} \\exp(i \\kappa j)$，并特别考虑 Nyquist 波数 $\\kappa = \\pi$ 处的网格尺度模。对于此模，计算 $p$ 的单步放大因子和 $u$ 的单步放大因子，并施加设计要求，即网格尺度模的每步振幅衰减对 $p$ 和 $u$ 是相等的。\n\n以闭合形式推导出用 $\\nu$、$\\Delta t$ 和 $\\Delta x$ 表示的滤波器强度 $\\sigma$，该强度强制使得压力场和速度场中网格尺度模的每步阻尼相等。你的最终答案必须以单一解析表达式给出。无需四舍五入。由于 $\\sigma$ 是无量纲的，因此你无需为最终答案指定单位。",
            "solution": "用户希望我解决一个计算声学领域的问题。我将首先根据用户的指示验证问题陈述。\n\n### 步骤1：提取已知条件\n- **控制方程**：线性化一阶声学系统：$p_{t} + \\rho_{0} c^{2} u_{x} = 0$, $u_{t} + \\frac{1}{\\rho_{0}} p_{x} = 0$。\n- **常数**：具有恒定质量密度 $\\rho_{0}$ 和声速 $c$ 的均匀介质。\n- **空间离散化**：均匀无限网格 $x_{j} = j \\,\\Delta x$，网格索引 $j \\in \\mathbb{Z}$，网格间距 $\\Delta x  0$。\n- **时间离散化**：显式前向欧拉时间步进，时间步长 $\\Delta t  0$。\n- **数值格式修改**：\n    - 速度方程中的人工粘性：项 $\\nu u_{xx}$，粘性系数 $\\nu  0$。\n    - 压力的显式线性滤波器：$p \\mapsto p + \\sigma \\,\\Delta x^{2} D_{xx} p$，无量纲滤波器强度 $\\sigma \\ge 0$。\n- **全离散更新方程**：\n    - 中间压力更新：$p_{j}^{n+1,\\star} = p_{j}^{n} - \\Delta t \\,\\rho_{0} c^{2} \\,D_{x} u_{j}^{n}$。\n    - 速度更新：$u_{j}^{n+1} = u_{j}^{n} - \\Delta t \\,\\frac{1}{\\rho_{0}} \\,D_{x} p_{j}^{n} + \\Delta t \\,\\nu \\,D_{xx} u_{j}^{n}$。\n    - 最终压力更新（滤波步骤）：$p_{j}^{n+1} = p_{j}^{n+1,\\star} + \\sigma \\,\\Delta x^{2} \\,D_{xx} p_{j}^{n+1,\\star}$。\n- **有限差分算子**：\n    - 二阶中心一阶导数：$D_{x} q_{j} = \\frac{q_{j+1} - q_{j-1}}{2 \\Delta x}$。\n    - 二阶中心二阶导数：$D_{xx} q_{j} = \\frac{q_{j+1} - 2 q_{j} + q_{j-1}}{\\Delta x^{2}}$。\n- **分析任务**：对单个 Fourier 模 $q_{j}^{n} = \\widehat{q}^{n} \\exp(i \\kappa j)$ 进行简正模 (Fourier) 分析，其中 $\\kappa = k \\,\\Delta x$ 是无量纲波数。\n- **特定情况**：Nyquist 波数 $\\kappa = \\pi$ 处的网格尺度模。\n- **设计要求**：对于 $\\kappa = \\pi$ 模，p 和 u 的每步振幅衰减相等。\n- **目标**：以闭合形式推导用 $\\nu$、$\\Delta t$ 和 $\\Delta x$ 表示的 $\\sigma$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学上成立**：该问题在计算声学和数值分析的既有理论中有坚实的基础。控制方程代表线性声学。数值方法（时间上为前向欧拉法，空间上为中心差分）是标准的。使用人工粘性和显式滤波是稳定数值格式和抑制虚假高频振荡的常见实用技术。分析方法（von Neumann 或 Fourier 分析）是研究线性有限差分格式的稳定性和耗散/色散特性的典型方法。\n- **适定的**：问题定义清晰。它提供了进行分析所需的所有必要方程和参数。目标是基于一个清晰且可形式化的设计准则推导出一个特定的参数关系。预期会有一个唯一解。\n- **目标**：问题以精确的技术语言陈述，没有主观性或模糊性。\n\n### 步骤3：结论和行动\n该问题是有效的。它在科学上是合理的、自洽的且适定的。我将继续进行详细求解。\n\n为了进行简正模分析，我们将 Fourier 模试探解 $q_{j}^{n} = \\widehat{q}^{n} \\exp(i \\kappa j)$ 代入全离散格式中，对 $p(x,t)$ 和 $u(x,t)$ 进行替换。我们首先确定离散空间算子 $D_{x}$ 和 $D_{xx}$ 对模的空间部分 $\\exp(i \\kappa j)$ 的作用。\n\n一阶导数算子 $D_x$ 对模的作用是：\n$$\nD_x \\exp(i \\kappa j) = \\frac{\\exp(i \\kappa (j+1)) - \\exp(i \\kappa (j-1))}{2 \\Delta x} = \\frac{\\exp(i \\kappa j) (\\exp(i \\kappa) - \\exp(-i \\kappa))}{2 \\Delta x} = \\frac{\\exp(i \\kappa j) (2i \\sin(\\kappa))}{2 \\Delta x} = \\frac{i \\sin(\\kappa)}{\\Delta x} \\exp(i \\kappa j).\n$$\n二阶导数算子 $D_{xx}$ 对模的作用是：\n$$\nD_{xx} \\exp(i \\kappa j) = \\frac{\\exp(i \\kappa (j+1)) - 2\\exp(i \\kappa j) + \\exp(i \\kappa (j-1))}{\\Delta x^2} = \\frac{\\exp(i \\kappa j) (\\exp(i \\kappa) - 2 + \\exp(-i \\kappa))}{\\Delta x^2} = \\frac{\\exp(i \\kappa j) (2\\cos(\\kappa) - 2)}{\\Delta x^2} = \\frac{-4 \\sin^2(\\frac{\\kappa}{2})}{\\Delta x^2} \\exp(i \\kappa j).\n$$\n通过将试探解代入离散方程并消去公因子 $\\exp(i \\kappa j)$，我们得到了一个关于随时间变化的 Fourier 振幅 $\\widehat{p}^n$ 和 $\\widehat{u}^n$ 的系统。\n\n压力更新变为：\n$$\n\\widehat{p}^{n+1, \\star} = \\widehat{p}^n - \\Delta t \\, \\rho_0 c^2 \\left(\\frac{i \\sin(\\kappa)}{\\Delta x}\\right) \\widehat{u}^n.\n$$\n速度更新变为：\n$$\n\\widehat{u}^{n+1} = \\widehat{u}^n - \\Delta t \\, \\frac{1}{\\rho_0} \\left(\\frac{i \\sin(\\kappa)}{\\Delta x}\\right) \\widehat{p}^n + \\Delta t \\, \\nu \\left(\\frac{-4 \\sin^2(\\frac{\\kappa}{2})}{\\Delta x^2}\\right) \\widehat{u}^n.\n$$\n压力滤波步骤变为：\n$$\n\\widehat{p}^{n+1} = \\widehat{p}^{n+1, \\star} + \\sigma \\Delta x^2 \\left(\\frac{-4 \\sin^2(\\frac{\\kappa}{2})}{\\Delta x^2}\\right) \\widehat{p}^{n+1, \\star} = \\widehat{p}^{n+1, \\star} \\left(1 - 4\\sigma \\sin^2\\left(\\frac{\\kappa}{2}\\right)\\right).\n$$\n我们被要求分析网格尺度模，它对应于 Nyquist 波数 $\\kappa = \\pi$。对于此模，空间部分为 $\\exp(i \\pi j) = (-1)^j$，代表了网格上可分辨的最高频率。我们计算在 $\\kappa=\\pi$ 处的三角函数项：\n$$\n\\sin(\\pi) = 0.\n$$\n$$\n\\sin^2\\left(\\frac{\\pi}{2}\\right) = (1)^2 = 1.\n$$\n将这些值代入 Fourier 振幅的系统中，我们观察到显著的简化。涉及 $\\sin(\\kappa)$ 的项消失了，这意味着对于这个特定的模，压力和速度方程之间的耦合消失了。\n\n在 $\\kappa=\\pi$ 处的压力更新：\n中间压力步骤得到：\n$$\n\\widehat{p}^{n+1, \\star} = \\widehat{p}^n - \\Delta t \\, \\rho_0 c^2 \\left(0\\right) \\widehat{u}^n = \\widehat{p}^n.\n$$\n然后滤波步骤给出：\n$$\n\\widehat{p}^{n+1} = \\widehat{p}^{n+1, \\star} \\left(1 - 4\\sigma \\sin^2\\left(\\frac{\\pi}{2}\\right)\\right) = \\widehat{p}^{n} (1 - 4\\sigma(1)) = (1 - 4\\sigma)\\widehat{p}^n.\n$$\n在 $\\kappa=\\pi$ 处的速度更新：\n$$\n\\widehat{u}^{n+1} = \\widehat{u}^n - \\Delta t \\, \\frac{1}{\\rho_0} (0) \\widehat{p}^n + \\Delta t \\, \\nu \\left(\\frac{-4 \\sin^2(\\frac{\\pi}{2})}{\\Delta x^2}\\right) \\widehat{u}^n = \\widehat{u}^n + \\Delta t \\, \\nu \\left(\\frac{-4}{\\Delta x^2}\\right) \\widehat{u}^n = \\left(1 - \\frac{4\\nu\\Delta t}{\\Delta x^2}\\right) \\widehat{u}^n.\n$$\n从这两个方程中，我们可以识别出网格尺度模的单步放大因子。设 $g_p(\\kappa)$ 和 $g_u(\\kappa)$ 分别是压力和速度的放大因子。在 $\\kappa=\\pi$ 处，我们有：\n$$\ng_p(\\pi) = \\frac{\\widehat{p}^{n+1}}{\\widehat{p}^n} = 1 - 4\\sigma.\n$$\n$$\ng_u(\\pi) = \\frac{\\widehat{u}^{n+1}}{\\widehat{u}^n} = 1 - \\frac{4\\nu\\Delta t}{\\Delta x^2}.\n$$\n问题陈述了设计要求，即 p 和 u 的每步振幅衰减相等。振幅衰减由放大因子的幅值决定。因此，这个要求转化为：\n$$\n|g_p(\\pi)| = |g_u(\\pi)|.\n$$\n代入放大因子的表达式：\n$$\n|1 - 4\\sigma| = \\left|1 - \\frac{4\\nu\\Delta t}{\\Delta x^2}\\right|.\n$$\n人工粘性和显式滤波器是耗散机制，旨在阻尼或减小高频数值模的振幅。一个没有相位反转的纯耗散效应对应于范围在 $[0, 1)$ 内的放大因子。假设这种预期的设计行为，则 $g_p(\\pi)$ 和 $g_u(\\pi)$ 都是非负的。由于 $\\sigma \\ge 0$ 和 $\\nu  0$，这要求 $1 - 4\\sigma \\ge 0 \\implies \\sigma \\le 1/4$ 和 $1 - \\frac{4\\nu\\Delta t}{\\Delta x^2} \\ge 0 \\implies \\Delta t \\le \\frac{\\Delta x^2}{4\\nu}$。在单调阻尼的这个标准假设下，可以去掉绝对值符号：\n$$\n1 - 4\\sigma = 1 - \\frac{4\\nu\\Delta t}{\\Delta x^2}.\n$$\n这是唯一具有物理意义的选择，因为另一种选择 $g_p = -g_u$ 将意味着一个耗散机制导致相位翻转而另一个则不会，这与一致的阻尼设计理念相矛盾。\n\n求解 $\\sigma$：\n$$\n-4\\sigma = - \\frac{4\\nu\\Delta t}{\\Delta x^2}.\n$$\n$$\n\\sigma = \\frac{\\nu\\Delta t}{\\Delta x^2}.\n$$\n该表达式给出了无量纲滤波器强度 $\\sigma$，它确保了压力滤波器对 Nyquist 模的阻尼效应与人工粘性对速度场中相同模的阻尼效应完全相同。",
            "answer": "$$\\boxed{\\frac{\\nu \\Delta t}{\\Delta x^{2}}}$$"
        }
    ]
}