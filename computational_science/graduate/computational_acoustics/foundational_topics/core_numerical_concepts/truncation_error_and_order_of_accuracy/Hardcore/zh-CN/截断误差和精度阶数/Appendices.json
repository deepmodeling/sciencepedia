{
    "hands_on_practices": [
        {
            "introduction": "要掌握截断误差，第一步是精通其核心数学工具——泰勒级数展开。这个练习  旨在通过推导二阶空间导数最常用近似的局部截断误差，来揭示其精度阶数和主导误差项。这是分析更复杂数值格式的基础，也是所有计算科学家必须掌握的基本功。",
            "id": "4149992",
            "problem": "在一维无损线性声学中，声压场 $p(x,t)$ 满足声波方程。在时域有限差分 (FDTD) 空间离散化中，拉普拉斯项 $p_{xx}(x,t)$ 通常在间距为 $h0$ 的均匀网格上使用对称 $3$ 点中心差分进行近似。在固定时间 $t^{\\ast}$，将 $p(\\cdot,t^{\\ast})$ 视为一个标量函数 $p(x)$，它在点 $x$ 的邻域内至少六次连续可微。定义离散算子\n$$\nD_{xx}p(x) \\equiv \\frac{p(x+h)-2\\,p(x)+p(x-h)}{h^{2}}.\n$$\n使用关于 $x$ 的泰勒定理展开 $p(x\\pm h)$，并用大O表示法表示余项，推导局部截断误差（定义为 $D_{xx}p(x)-p_{xx}(x)$）到其关于 $h$ 的首个非零阶。找出常数 $C$ 使得\n$$\nD_{xx}p(x)-p_{xx}(x)=C\\,h^{2}\\,p^{(4)}(x)+\\mathcal{O}(h^{4}),\n$$\n其中 $p^{(4)}(x)$ 表示 $p$ 在 $x$ 处的四阶空间导数。只需提供 $C$ 的值作为最终答案。最终答案是无量纲的，应以精确值给出，无需四舍五入。",
            "solution": "该问题是有效的，因为它代表了数值分析中的一个标准的、适定的练习，特别是关于有限差分格式的局部截断误差的推导。该问题具有科学依据，是客观的，并包含了得到唯一解所需的所有信息。\n\n目标是确定离散拉普拉斯算子 $D_{xx}p(x)$ 的局部截断误差表达式中的常数 $C$。截断误差定义为离散算子与其所近似的连续算子之差，即 $D_{xx}p(x) - p_{xx}(x)$，其中 $p_{xx}(x)$ 表示压力场 $p(x)$ 的二阶空间导数。\n\n离散算子由下式给出：\n$$\nD_{xx}p(x) = \\frac{p(x+h) - 2\\,p(x) + p(x-h)}{h^{2}}\n$$\n为了分析误差，我们使用泰勒定理将 $p(x+h)$ 和 $p(x-h)$ 在点 $x$ 附近展开。问题指出函数 $p(x)$ 至少六次连续可微，这使我们能够写出足够精确的泰勒级数展开式，以确定主阶误差项和后续项。\n\n$p(x+h)$ 关于 $x$ 的泰勒级数展开式为：\n$$\np(x+h) = p(x) + h\\,p^{(1)}(x) + \\frac{h^{2}}{2!}\\,p^{(2)}(x) + \\frac{h^{3}}{3!}\\,p^{(3)}(x) + \\frac{h^{4}}{4!}\\,p^{(4)}(x) + \\frac{h^{5}}{5!}\\,p^{(5)}(x) + \\frac{h^{6}}{6!}\\,p^{(6)}(x) + \\mathcal{O}(h^{7})\n$$\n类似地，$p(x-h)$ 关于 $x$ 的展开式为：\n$$\np(x-h) = p(x) - h\\,p^{(1)}(x) + \\frac{h^{2}}{2!}\\,p^{(2)}(x) - \\frac{h^{3}}{3!}\\,p^{(3)}(x) + \\frac{h^{4}}{4!}\\,p^{(4)}(x) - \\frac{h^{5}}{5!}\\,p^{(5)}(x) + \\frac{h^{6}}{6!}\\,p^{(6)}(x) + \\mathcal{O}(h^{7})\n$$\n其中 $p^{(n)}(x)$ 表示 $p$ 关于 $x$ 的 $n$ 阶导数在点 $x$ 处的值。\n\n现在我们将这些展开式代入 $D_{xx}p(x)$ 表达式的分子中。首先，我们对 $p(x+h)$ 和 $p(x-h)$求和：\n$$\np(x+h) + p(x-h) = 2\\,p(x) + 2\\frac{h^{2}}{2!}\\,p^{(2)}(x) + 2\\frac{h^{4}}{4!}\\,p^{(4)}(x) + 2\\frac{h^{6}}{6!}\\,p^{(6)}(x) + \\mathcal{O}(h^{8})\n$$\n注意，由于展开式的对称性，$h$ 的所有奇次幂项都抵消了。化简阶乘（$2! = 2$, $4! = 24$, $6! = 720$），我们得到：\n$$\np(x+h) + p(x-h) = 2\\,p(x) + h^{2}\\,p^{(2)}(x) + \\frac{h^{4}}{12}\\,p^{(4)}(x) + \\frac{h^{6}}{360}\\,p^{(6)}(x) + \\mathcal{O}(h^{8})\n$$\n现在，我们构造完整的分子 $p(x+h) - 2\\,p(x) + p(x-h)$：\n$$\np(x+h) - 2\\,p(x) + p(x-h) = \\left(2\\,p(x) + h^{2}\\,p^{(2)}(x) + \\frac{h^{4}}{12}\\,p^{(4)}(x) + \\frac{h^{6}}{360}\\,p^{(6)}(x) + \\mathcal{O}(h^{8})\\right) - 2\\,p(x)\n$$\n$$\np(x+h) - 2\\,p(x) + p(x-h) = h^{2}\\,p^{(2)}(x) + \\frac{h^{4}}{12}\\,p^{(4)}(x) + \\frac{h^{6}}{360}\\,p^{(6)}(x) + \\mathcal{O}(h^{8})\n$$\n为了得到 $D_{xx}p(x)$ 的表达式，我们将此结果除以 $h^{2}$：\n$$\nD_{xx}p(x) = \\frac{1}{h^{2}}\\left(h^{2}\\,p^{(2)}(x) + \\frac{h^{4}}{12}\\,p^{(4)}(x) + \\frac{h^{6}}{360}\\,p^{(6)}(x) + \\mathcal{O}(h^{8})\\right)\n$$\n$$\nD_{xx}p(x) = p^{(2)}(x) + \\frac{h^{2}}{12}\\,p^{(4)}(x) + \\frac{h^{4}}{360}\\,p^{(6)}(x) + \\mathcal{O}(h^{6})\n$$\n局部截断误差，我们记为 $T(h)$，是此离散近似与精确二阶导数 $p_{xx}(x) = p^{(2)}(x)$ 之间的差：\n$$\nT(h) = D_{xx}p(x) - p_{xx}(x) = \\left(p^{(2)}(x) + \\frac{h^{2}}{12}\\,p^{(4)}(x) + \\frac{h^{4}}{360}\\,p^{(6)}(x) + \\mathcal{O}(h^{6})\\right) - p^{(2)}(x)\n$$\n$$\nT(h) = \\frac{h^{2}}{12}\\,p^{(4)}(x) + \\frac{h^{4}}{360}\\,p^{(6)}(x) + \\mathcal{O}(h^{6})\n$$\n这个表达式给出了局部截断误差。首个非零项是 $\\frac{h^{2}}{12}\\,p^{(4)}(x)$。该格式的精度阶数是该首项中 $h$ 的幂，即 $2$。\n\n问题要求我们将误差写成 $C\\,h^{2}\\,p^{(4)}(x)+\\mathcal{O}(h^{4})$ 的形式。根据我们推导出的表达式，我们可以写出：\n$$\nD_{xx}p(x) - p_{xx}(x) = \\frac{1}{12}\\,h^{2}\\,p^{(4)}(x) + \\mathcal{O}(h^{4})\n$$\n$\\frac{h^{4}}{360}\\,p^{(6)}(x)$ 项和所有更高阶的项都被吸收到 $\\mathcal{O}(h^{4})$ 表示法中。\n\n通过将我们的结果与指定形式 $C\\,h^{2}\\,p^{(4)}(x)+\\mathcal{O}(h^{4})$ 进行比较，我们可以直接确定常数 $C$：\n$$\nC = \\frac{1}{12}\n$$",
            "answer": "$$\\boxed{\\frac{1}{12}}$$"
        },
        {
            "introduction": "在掌握了单个算子的分析之后，我们将把注意力转向一个完整的偏微分方程数值格式。这个练习  将截断误差的概念与计算稳定性（CFL 条件）这一关键要求联系起来，并展示了误差的结构如何影响数值频散等物理伪影。通过这个练习，你将发现一个深刻的结论：通过巧妙地选择离散参数，主导截断误差项有时可以被消除，从而获得异常精确的解。",
            "id": "4149964",
            "problem": "考虑一维空间中的线性声波方程 $$p_{tt}=c^{2}p_{xx},$$ 其中 $p(x,t)$ 是声压，$c$ 是恒定的声速。在一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，考虑一个在空间和时间上均为二阶精度的显式中心有限差分格式：$$\\frac{p_{j}^{n+1}-2p_{j}^{n}+p_{j}^{n-1}}{\\Delta t^{2}}=c^{2}\\frac{p_{j+1}^{n}-2p_{j}^{n}+p_{j-1}^{n}}{\\Delta x^{2}},$$ 其中 $p_{j}^{n}$ 是对 $p(x_{j},t^{n})$ 的近似，且 $x_{j}=j\\,\\Delta x$ 和 $t^{n}=n\\,\\Delta t$。定义库朗-弗里德里希斯-列维（CFL）数为 $$\\sigma=\\frac{c\\,\\Delta t}{\\Delta x}。$$\n请从第一性原理出发，不使用任何未经证明的简化公式，完成以下任务。\n- 使用冯·诺依曼傅里叶模态假设 $p_{j}^{n}=\\zeta^{n}\\exp\\!\\big(i k x_{j}\\big)$（其中 $k$ 为实波数），推导其放大关系式，并获得保证对所有容许的 $k$ 放大都有界的稳定性条件。确定最大容许库朗数 $\\sigma_{\\max}$。\n- 使用关于 $(x_{j},t^{n})$ 的泰勒展开，推导该格式的局部截断误差，并确定决定精度阶数的主导项。然后，通过特化为满足连续色散关系 $\\omega=c\\,k$ 的简谐平面波解 $p(x,t)=\\Re\\{\\exp\\!\\big(i(kx-\\omega t)\\big)\\}$，简化主导截断误差项，以显示其如何依赖于 $\\sigma$。\n- 基于您的推导，简要讨论在稳定性极限附近（即 $\\sigma$ 接近 $\\sigma_{\\max}$）选择 $\\Delta t$ 如何影响传播谐波分量的截断误差表现，特别是低波数的色散行为。\n将您的最终答案表示为 $\\sigma_{\\max}$ 的单个值。无需单位，也无需四舍五入。",
            "solution": "问题陈述经评估有效。它在科学上基于偏微分方程数值分析的原理，特别是应用于声波方程。该问题是适定的、客观的和自洽的，提供了执行所要求的推导所需的所有必要定义和方程。它代表了计算物理学中一个标准的、非平凡的练习。\n\n我们按要求分三部分进行求解。\n\n控制偏微分方程是一维线性声波方程：\n$$p_{tt}=c^{2}p_{xx}$$\n提出的显式有限差分格式为：\n$$\\frac{p_{j}^{n+1}-2p_{j}^{n}+p_{j}^{n-1}}{\\Delta t^{2}}=c^{2}\\frac{p_{j+1}^{n}-2p_{j}^{n}+p_{j-1}^{n}}{\\Delta x^{2}}$$\n其中库朗数为 $\\sigma=\\frac{c\\,\\Delta t}{\\Delta x}$。\n\n**第一部分：冯·诺依曼稳定性分析**\n\n为了研究该格式的稳定性，我们使用冯·诺依曼傅里叶模态假设 $p_{j}^{n}=\\zeta^{n}\\exp(i k x_{j})$，其中 $\\zeta$ 是复放大因子，$k$ 是实波数，$x_j = j\\Delta x$。将此假设代入有限差分格式，得到：\n$$\\frac{\\zeta^{n+1}\\exp(ikj\\Delta x)-2\\zeta^{n}\\exp(ikj\\Delta x)+\\zeta^{n-1}\\exp(ikj\\Delta x)}{\\Delta t^{2}}=c^{2}\\frac{\\zeta^{n}\\exp(ik(j+1)\\Delta x)-2\\zeta^{n}\\exp(ikj\\Delta x)+\\zeta^{n}\\exp(ik(j-1)\\Delta x)}{\\Delta x^{2}}$$\n我们将整个方程除以公因子 $\\zeta^{n-1}\\exp(ikj\\Delta x)$：\n$$\\frac{\\zeta^{2}-2\\zeta+1}{\\Delta t^{2}}=c^{2}\\frac{\\zeta(\\exp(ik\\Delta x)-2+\\exp(-ik\\Delta x))}{\\Delta x^{2}}$$\n整理并使用定义 $\\sigma^2 = \\frac{c^2 \\Delta t^2}{\\Delta x^2}$，我们得到：\n$$\\zeta^{2}-2\\zeta+1 = \\sigma^2 \\zeta (\\exp(ik\\Delta x) + \\exp(-ik\\Delta x) - 2)$$\n使用恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，表达式变为：\n$$\\zeta^{2}-2\\zeta+1 = \\sigma^2 \\zeta (2\\cos(k\\Delta x) - 2) = -2\\sigma^2\\zeta(1-\\cos(k\\Delta x))$$\n应用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们获得：\n$$\\zeta^{2}-2\\zeta+1 = -4\\sigma^2\\zeta\\sin^2\\left(\\frac{k\\Delta x}{2}\\right)$$\n这是一个关于放大因子 $\\zeta$ 的二次方程：\n$$\\zeta^2 - 2\\left(1-2\\sigma^2\\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\\right)\\zeta + 1 = 0$$\n对于一个稳定的格式，放大因子的模在任何时候都必须是有界的，这要求 $|\\zeta| \\le 1$。设线性项的系数为 $A = 1-2\\sigma^2\\sin^2(k\\Delta x/2)$。二次方程为 $\\zeta^2 - 2A\\zeta + 1 = 0$，其解为 $\\zeta = A \\pm \\sqrt{A^2-1}$。\n如果 $|A|  1$，则 $A^2-1  0$，根 $\\zeta$ 是实数。根的乘积为 1，因此必有一根的模大于 1，导致指数增长和不稳定性。\n如果 $|A| \\le 1$，则 $A^2-1 \\le 0$。根是共轭复数 $\\zeta = A \\pm i\\sqrt{1-A^2}$。这些根的模为 $|\\zeta| = \\sqrt{A^2 + (1-A^2)} = 1$。这对应于一个无耗散的、中性稳定的格式，其中傅里叶模态的振幅不随时间变化。\n因此，稳定性条件是 $|A| \\le 1$，这可以转化为：\n$$-1 \\le 1-2\\sigma^2\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 1$$\n右侧不等式 $1-2\\sigma^2\\sin^2(k\\Delta x/2) \\le 1$ 简化为 $-2\\sigma^2\\sin^2(k\\Delta x/2) \\le 0$，由于 $\\sigma^2 \\ge 0$ 且正弦平方项为非负，该不等式总是成立的。\n左侧不等式是 $-1 \\le 1-2\\sigma^2\\sin^2(k\\Delta x/2)$，简化为：\n$$2\\sigma^2\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 2 \\implies \\sigma^2\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 1$$\n这个条件必须对所有可能的波数 $k$ 都成立。项 $\\sin^2(k\\Delta x/2)$ 在奈奎斯特波数 $k=\\pi/\\Delta x$ 处达到其最大值 1。为了保证所有模态的稳定性，我们必须满足这种最坏情况下的条件：\n$$\\sigma^2 (1) \\le 1 \\implies \\sigma^2 \\le 1$$\n由于 $\\sigma$ 被定义为非负数，稳定性条件是 $\\sigma \\le 1$。这就是此格式的库朗-弗里德里希斯-列维（CFL）条件。最大容许库朗数为 $\\sigma_{\\max}=1$。\n\n**第二部分：局部截断误差**\n\n局部截断误差 $\\tau_j^n$ 是通过将精确解 $p(x,t)$ 代入有限差分算子得到的：\n$$\\tau_j^n = \\frac{p(x_j, t_n+\\Delta t)-2p(x_j, t_n)+p(x_j, t_n-\\Delta t)}{\\Delta t^2}-c^2\\frac{p(x_j+\\Delta x, t_n)-2p(x_j, t_n)+p(x_j-\\Delta x, t_n)}{\\Delta x^2}$$\n我们使用 $p(x,t)$ 关于点 $(x_j, t_n)$ 的泰勒级数展开。对于时间导数项：\n$$p(x_j, t_n \\pm \\Delta t) = p \\pm \\Delta t p_t + \\frac{\\Delta t^2}{2} p_{tt} \\pm \\frac{\\Delta t^3}{6} p_{ttt} + \\frac{\\Delta t^4}{24} p_{tttt} + O(\\Delta t^5)$$\n将 $t_n+\\Delta t$ 和 $t_n-\\Delta t$ 的展开式相加，奇数阶项抵消：\n$$p(x_j, t_n+\\Delta t)+p(x_j, t_n-\\Delta t) = 2p + \\Delta t^2 p_{tt} + \\frac{\\Delta t^4}{12} p_{tttt} + O(\\Delta t^6)$$\n因此，离散时间导数算子近似连续时间导数算子，误差为：\n$$\\frac{p(x_j, t_n+\\Delta t)-2p(x_j, t_n)+p(x_j, t_n-\\Delta t)}{\\Delta t^2} = p_{tt} + \\frac{\\Delta t^2}{12} p_{tttt} + O(\\Delta t^4)$$\n类似地，对于空间导数项：\n$$p(x_j \\pm \\Delta x, t_n) = p \\pm \\Delta x p_x + \\frac{\\Delta x^2}{2} p_{xx} \\pm \\frac{\\Delta x^3}{6} p_{xxx} + \\frac{\\Delta x^4}{24} p_{xxxx} + O(\\Delta x^5)$$\n$$\\frac{p(x_j+\\Delta x, t_n)-2p(x_j, t_n)+p(x_j-\\Delta x, t_n)}{\\Delta x^2} = p_{xx} + \\frac{\\Delta x^2}{12} p_{xxxx} + O(\\Delta x^4)$$\n将这些展开式代入 $\\tau_j^n$ 的表达式：\n$$\\tau_j^n = \\left(p_{tt} + \\frac{\\Delta t^2}{12} p_{tttt} + \\ldots \\right) - c^2\\left(p_{xx} + \\frac{\\Delta x^2}{12} p_{xxxx} + \\ldots \\right)$$\n$$\\tau_j^n = (p_{tt} - c^2p_{xx}) + \\frac{\\Delta t^2}{12}p_{tttt} - \\frac{c^2\\Delta x^2}{12}p_{xxxx} + O(\\Delta t^4, \\Delta x^4)$$\n由于 $p(x,t)$ 是波动方程的精确解，所以 $p_{tt}-c^2p_{xx}=0$。局部截断误差的主导项是：\n$$\\tau_{\\text{lead}} = \\frac{\\Delta t^2}{12}p_{tttt} - \\frac{c^2\\Delta x^2}{12}p_{xxxx}$$\n该格式在时间上是二阶精度 $O(\\Delta t^2)$，在空间上是二阶精度 $O(\\Delta x^2)$。\n现在，我们特化为满足连续色散关系 $\\omega=ck$ 的简谐平面波解 $p(x,t)=\\exp(i(kx-\\omega t))$。我们计算所需的导数：\n$p_{tttt} = (-i\\omega)^4 p = \\omega^4 p = (ck)^4 p = c^4 k^4 p$\n$p_{xxxx} = (ik)^4 p = k^4 p$\n将这些代入主导误差项：\n$$\\tau_{\\text{lead}} = \\frac{\\Delta t^2}{12}(c^4 k^4 p) - \\frac{c^2\\Delta x^2}{12}(k^4 p) = \\frac{k^4 p}{12}(c^4\\Delta t^2 - c^2\\Delta x^2)$$\n提出公因子 $c^2\\Delta x^2$ 并引入 $\\sigma = c\\Delta t/\\Delta x$：\n$$\\tau_{\\text{lead}} = \\frac{c^2 k^4 \\Delta x^2 p}{12}\\left(\\frac{c^2\\Delta t^2}{\\Delta x^2} - 1\\right) = \\frac{c^2 k^4 \\Delta x^2}{12}(\\sigma^2-1)p(x,t)$$\n这表明主导截断误差与 $(\\sigma^2-1)$ 成正比。\n\n**第三部分：关于截断误差和色散的讨论**\n\n稳定性极限是 $\\sigma_{\\max}=1$。局部截断误差的主导项与 $(\\sigma^2 - 1)$ 成正比。一个特别有趣的情况是，当我们选择的库朗数恰好在稳定性极限上时，即 $\\sigma = \\sigma_{\\max} = 1$。在这种情况下，因子 $(\\sigma^2-1)$ 变为 $1^2-1=0$，截断误差的主导项消失。这表明当 $\\sigma=1$ 时，该格式的精度高于二阶。\n\n对于传播的波，截断误差的主要表现是数值色散，即波速依赖于波数。该格式的数值色散关系由 $\\sin(\\tilde{\\omega}\\Delta t/2) = \\sigma \\sin(k\\Delta x/2)$ 给出，其中 $\\tilde{\\omega}$ 是数值频率。数值相速度为 $c_{ph,num} = \\tilde{\\omega}/k$。\n如果我们设置 $\\sigma=1$，数值色散关系变为：\n$$\\sin\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) = \\sin\\left(\\frac{k\\Delta x}{2}\\right)$$\n对于主分支，这意味着 $\\tilde{\\omega}\\Delta t/2 = k\\Delta x/2$，所以 $\\tilde{\\omega}\\Delta t = k\\Delta x$。数值相速度为 $c_{ph,num} = \\tilde{\\omega}/k = \\Delta x/\\Delta t$。\n此外，当 $\\sigma = c\\Delta t/\\Delta x = 1$ 时，我们有 $c = \\Delta x/\\Delta t$。因此，对于 $\\sigma=1$，数值相速度为 $c_{ph,num}=c$。对于所有波数 $k$，数值波速都精确等于物理波速。该格式是完全无色散的。这是主导截断误差项消失的直接结果。\n相比之下，对于任何 $\\sigma  1$，我们可以分析低波数极限（$k\\Delta x \\ll 1$）。数值色散关系的泰勒展开给出 $\\tilde{\\omega} \\approx ck(1 - \\frac{k^2\\Delta x^2}{24}(1-\\sigma^2))$。数值相速度为 $c_{ph,num} \\approx c(1 - \\frac{k^2\\Delta x^2}{24}(1-\\sigma^2))$。由于 $\\sigma  1$，我们有 $1-\\sigma^2  0$，因此 $c_{ph,num}  c$。数值波的传播速度慢于物理波，并且速度依赖于波数 $k$，这就是数值色散的定义。\n总之，选择使 $\\sigma$ 接近 $\\sigma_{\\max}=1$ 的 $\\Delta t$ 可以最小化因子 $(1-\\sigma^2)$，从而最小化主导截断误差和由此产生的数值色散。在极限情况 $\\sigma=1$ 下，该格式变得无色散，并且波传播的数值解沿着网格特征线是精确的。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "本章的最后一个练习旨在连接理论推导与计算实践。网格加密研究是数值程序验证的黄金标准，它使我们能够确认代码是否正确地实现了理论设计的精度。在这个练习  中，你将推导并实施相关公式，从模拟输出中衡量观测到的收敛阶，并学习如何利用理查森外推法（Richardson extrapolation）获得一个更高精度的解估计。",
            "id": "4149943",
            "problem": "您的任务是设计一个数学上严谨的网格加密研究，以估算一个声学求解器的观测精度阶。您将使用在间距为 $h$、$h/2$ 和 $h/4$ 的相继加密的空间网格上计算出的三个解。您的目标是推导观测精度阶的估计量和与之相符的、用于底层声学可观测量的理查德森外推公式，并在一个程序中实现这些公式来评估一组测试用例。\n\n此问题的基本依据是截断误差和精度阶的定义。对于一个逼近光滑声学可观测量（例如，声压样本或空间范数）的一致性数值方法，在间距为 $h$ 的网格上，离散近似值 $S_h$ 在 $h$ 足够小时满足渐近误差模型\n$$\nS_h = S + C h^p + \\mathcal{O}\\left(h^{p+1}\\right),\n$$\n其中 $S$ 是精确的可观测量，$C$ 是一个与 $h$ 无关的常数，$p$ 是（未知的）精度阶。网格加密研究的目的是估计 $p$ 并仅使用 $S_h$、$S_{h/2}$ 和 $S_{h/4}$ 计算 $S$ 的外推近似值。\n\n设计要求：\n- 从上述渐近误差模型出发，使用在加密比 $r = 2$ 下的三个近似值 $S_h$、$S_{h/2}$ 和 $S_{h/4}$，推导一个公式来估计观测阶 $p$。\n- 使用两个最密网格的近似值和您估计的阶数 $p$，推导 $S$ 的理查德森外推公式。\n- 推导过程必须从误差模型出发，通过推理得出最终公式，不得引用任何预先推导的“捷径”公式。\n\n实现要求：\n- 实现一个程序，构造与渐近模型一致的合成“声学求解器”输出。对于每个测试用例，您将获得参数 $(S_\\star, p_{\\text{true}}, C, D, h)$，并且必须通过以下方式定义合成近似值\n$$\nS_h = S_\\star + C h^{p_{\\text{true}}} + D h^{p_{\\text{true}} + 1}, \\quad\nS_{h/2} = S_\\star + C \\left(\\frac{h}{2}\\right)^{p_{\\text{true}}} + D \\left(\\frac{h}{2}\\right)^{p_{\\text{true}} + 1}, \\quad\nS_{h/4} = S_\\star + C \\left(\\frac{h}{4}\\right)^{p_{\\text{true}}} + D \\left(\\frac{h}{4}\\right)^{p_{\\text{true}} + 1}.\n$$\n此处 $S_\\star$ 代表精确的声学可观测量（无量纲），$p_{\\text{true}}$ 是合成模型的真实阶数，$C$ 是主阶误差系数，$D$ 是代表高阶项污染的次阶误差系数。\n- 根据这三个值，使用您推导的公式计算观测阶 $p_{\\text{obs}}$ 和外推解 $S_{\\text{ext}}$。使用最密的网格对 $(h/2,h/4)$ 进行外推，以减少高阶项污染。\n- 为保证数值稳健性，在估算阶数时，在对数函数内部取绝对值，以避免 $C$ 的符号变化引起的问题；您仍须确保比值为正且有限。\n\n测试套件：\n使用以下四个测试用例，每个由 $(S_\\star, p_{\\text{true}}, C, D, h)$ 定义。\n- 用例 1：$(0.75321, 2, 0.5, 0, 0.1)$\n- 用例 2：$(-0.132, 3, -0.3, 0, 0.12)$\n- 用例 3：$(2.5, 4, 1.0, 5.0, 0.08)$\n- 用例 4：$(0.0, 2, 1.0 \\times 10^{-4}, 0, 0.5)$\n\n程序输出规范：\n- 对每个测试用例，输出两个浮点数：观测阶 $p_{\\text{obs}}$ 和外推解 $S_{\\text{ext}}$，均四舍五入到 $6$ 位小数。\n- 将所有四个测试用例的结果汇总到一行输出中，该行包含一个用方括号括起来的逗号分隔列表，顺序如下\n$$\n[p_{\\text{obs}}^{(1)}, S_{\\text{ext}}^{(1)}, p_{\\text{obs}}^{(2)}, S_{\\text{ext}}^{(2)}, p_{\\text{obs}}^{(3)}, S_{\\text{ext}}^{(3)}, p_{\\text{obs}}^{(4)}, S_{\\text{ext}}^{(4)}].\n$$\n由于所有量在构造上都是无量纲的，因此不需要物理单位。输出中不要包含任何额外的文本。",
            "solution": "该问题要求基于网格加密研究中的三个数值解，推导观测精度阶 $p_{\\text{obs}}$ 的估计量和相应的理查德森外推公式 $S_{\\text{ext}}$。在此之后，需要通过一个实现将这些公式应用于一组合成的测试用例。\n\n此分析的基础是在特征间距为 $h$ 的网格上，精确量 $S$ 的数值近似值 $S_h$ 的渐近误差模型：\n$$\nS_h = S + C h^p + \\mathcal{O}\\left(h^{p+1}\\right)\n$$\n这里，$p$ 是数值方法的形式精度阶，$C$ 是主阶误差系数，假定在 $h$ 足够小时为常数。\n\n我们获得了在以常数加密比 $r=2$ 相继加密的网格上计算出的三个解 $S_h$、$S_{h/2}$ 和 $S_{h/4}$。为简化推导，我们将这些解表示为 $S_1 = S_h$、$S_2 = S_{h/2}$ 和 $S_3 = S_{h/4}$。通过截断渐近误差模型并忽略高阶项 $\\mathcal{O}(h^{p+1})$，我们得到一个近似方程组。在 $h \\to 0$ 的渐近极限下，这种截断是有效的。\n\n$$\nS_1 \\approx S + C h^p \\\\\nS_2 \\approx S + C \\left(\\frac{h}{2}\\right)^p = S + C \\frac{h^p}{2^p} \\\\\nS_3 \\approx S + C \\left(\\frac{h}{4}\\right)^p = S + C \\frac{h^p}{4^p}\n$$\n\n**观测精度阶 ($p_{\\text{obs}}$) 的推导**\n\n我们的第一个目标是使用可用的三个解来估计精度阶 $p$。策略是从方程组中消去未知量 $S$ 和 $C$。我们可以通过考虑连续近似值之间的差值来消去 $S$：\n\n$$\nS_1 - S_2 \\approx \\left(S + C h^p\\right) - \\left(S + C \\frac{h^p}{2^p}\\right) = C h^p \\left(1 - \\frac{1}{2^p}\\right)\n$$\n\n$$\nS_2 - S_3 \\approx \\left(S + C \\frac{h^p}{2^p}\\right) - \\left(S + C \\frac{h^p}{4^p}\\right) = C \\frac{h^p}{2^p} \\left(1 - \\frac{1}{2^p}\\right)\n$$\n\n现在，我们可以通过计算这两个差值的比率来消去项 $C h^p \\left(1 - \\frac{1}{2^p}\\right)$。只要分母不为零，这样做就是允许的，对于一个误差不会过早消失的收敛解，这通常是成立的。\n\n$$\n\\frac{S_1 - S_2}{S_2 - S_3} \\approx \\frac{C h^p \\left(1 - \\frac{1}{2^p}\\right)}{C \\frac{h^p}{2^p} \\left(1 - \\frac{1}{2^p}\\right)} = 2^p\n$$\n这个关系提供了一种直接求解 $p$ 的方法。通过对两边取自然对数，我们可以分离出 $p$：\n\n$$\n\\ln\\left(\\frac{S_1 - S_2}{S_2 - S_3}\\right) \\approx \\ln(2^p) = p \\ln(2)\n$$\n\n求解 $p$ 得到观测精度阶的估计量，我们记为 $p_{\\text{obs}}$：\n\n$$\np_{\\text{obs}} = \\frac{\\ln\\left(\\frac{S_h - S_{h/2}}{S_{h/2} - S_{h/4}}\\right)}{\\ln(2)}\n$$\n\n为了数值稳健性，特别是在处理可能包含浮点噪声或非单调收敛行为的真实求解器输出时，如问题所述，在应用对数之前取比率的绝对值是审慎的。\n\n$$\np_{\\text{obs}} = \\frac{\\ln\\left(\\left| \\frac{S_h - S_{h/2}}{S_{h/2} - S_{h/4}} \\right|\\right)}{\\ln(2)}\n$$\n\n**理查德森外推公式 ($S_{\\text{ext}}$) 的推导**\n\n我们的第二个目标是使用可用的近似值推导出精确解 $S$ 的一个更准确的估计。这个过程被称为理查德森外推。问题指定使用两个最密网格的解 $S_2 = S_{h/2}$ 和 $S_3 = S_{h/4}$，以及我们估计的精度阶 $p_{\\text{obs}}$。\n\n我们回到这两个解的截断误差方程，现在使用 $p_{\\text{obs}}$ 作为 $p$ 的估计值：\n\n$$\nS_2 \\approx S + C \\left(\\frac{h}{2}\\right)^{p_{\\text{obs}}} \\\\\nS_3 \\approx S + C \\left(\\frac{h}{4}\\right)^{p_{\\text{obs}}} = S + C \\frac{(h/2)^{p_{\\text{obs}}}}{2^{p_{\\text{obs}}}}\n$$\n\n这是一个关于两个未知数 $S$ 和误差项 $E_2 = C (h/2)^{p_{\\text{obs}}}$ 的二元线性方程组。我们的目标是求解 $S$。让我们重写这个系统：\n\n$$\nS_2 \\approx S + E_2 \\\\\nS_3 \\approx S + \\frac{E_2}{2^{p_{\\text{obs}}}}\n$$\n\n从第一个方程，我们可以将误差项 $E_2$ 表示为 $E_2 \\approx S_2 - S$。将此代入第二个方程得到：\n\n$$\nS_3 \\approx S + \\frac{S_2 - S}{2^{p_{\\text{obs}}}}\n$$\n\n我们现在求解这个方程以得到 $S$。两边乘以 $2^{p_{\\text{obs}}}$ 以消去分母：\n\n$$\nS_3 \\cdot 2^{p_{\\text{obs}}} \\approx S \\cdot 2^{p_{\\text{obs}}} + S_2 - S\n$$\n\n将包含 $S$ 的项组合在一起：\n\n$$\nS_3 \\cdot 2^{p_{\\text{obs}}} - S_2 \\approx S \\left(2^{p_{\\text{obs}}} - 1\\right)\n$$\n\n最后，除以 $(2^{p_{\\text{obs}}} - 1)$ 得到理查德森外推解 $S_{\\text{ext}}$ 的公式。只要 $p_{\\text{obs}} \\neq 0$，这个公式就有效。\n\n$$\nS_{\\text{ext}} = \\frac{S_3 \\cdot 2^{p_{\\text{obs}}} - S_2}{2^{p_{\\text{obs}}} - 1} = \\frac{S_{h/4} \\cdot 2^{p_{\\text{obs}}} - S_{h/2}}{2^{p_{\\text{obs}}} - 1}\n$$\n\n这个外推值 $S_{\\text{ext}}$ 的误差阶比原始近似值的更高，通常为 $\\mathcal{O}(h^{p+1})$，前提是渐近误差模型能准确描述求解器在所用网格上的行为。\n\n实现将首先为每个测试用例生成合成数据点 $S_h$、$S_{h/2}$ 和 $S_{h/4}$。然后，它将应用推导出的 $p_{\\text{obs}}$ 公式，接着应用 $S_{\\text{ext}}$ 的公式，并按规定格式化结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the grid refinement study problem by deriving estimators for the\n    order of accuracy and performing Richardson extrapolation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (S_star, p_true, C, D, h)\n    test_cases = [\n        (0.75321, 2, 0.5, 0, 0.1),\n        (-0.132, 3, -0.3, 0, 0.12),\n        (2.5, 4, 1.0, 5.0, 0.08),\n        (0.0, 2, 1.0e-4, 0, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        S_star, p_true, C, D, h = case\n\n        # 1. Generate synthetic \"acoustic solver\" outputs\n        # S_h = S_star + C*h^p + D*h^(p+1)\n        s_h = S_star + C * h**p_true + D * h**(p_true + 1)\n        # S_h/2\n        s_h_2 = S_star + C * (h / 2)**p_true + D * (h / 2)**(p_true + 1)\n        # S_h/4\n        s_h_4 = S_star + C * (h / 4)**p_true + D * (h / 4)**(p_true + 1)\n\n        # 2. Compute the observed order of accuracy (p_obs)\n        # p_obs = ln(|(S_h - S_h/2) / (S_h/2 - S_h/4)|) / ln(2)\n        numerator = s_h - s_h_2\n        denominator = s_h_2 - s_h_4\n\n        # The problem cases are well-behaved, so denominator won't be zero.\n        ratio = numerator / denominator\n        \n        # Taking the absolute value as per the problem's robustness requirement.\n        p_obs = np.log(np.abs(ratio)) / np.log(2)\n\n        # 3. Compute the extrapolated solution (S_ext)\n        # S_ext = (S_h/4 * 2^p_obs - S_h/2) / (2^p_obs - 1)\n        # This formula is valid for p_obs != 0.\n        power_of_2 = 2**p_obs\n        S_ext = (s_h_4 * power_of_2 - s_h_2) / (power_of_2 - 1)\n\n        # 4. Round results to 6 decimal places and append to the list\n        results.append(round(p_obs, 6))\n        results.append(round(S_ext, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}