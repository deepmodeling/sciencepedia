{
    "hands_on_practices": [
        {
            "introduction": "对偏微分方程进行数值求解时，其基石在于如何精确地近似微分算子。泰勒级数展开为我们提供了一个强有力的理论框架，不仅可以构建这些近似，还能量化其精度。本练习  将引导你完成一个最基础也是最重要的推导：一阶导数的中心差分格式。通过这个过程，你将掌握如何利用泰勒级数分析截断误差，为理解和设计更高阶的数值格式奠定坚实的基础。",
            "id": "3593417",
            "problem": "在一维地震波传播的数值模拟中，沿测线的光滑标量波场 $f(x)$ 的空间梯度，通常使用对称有限差分格式在间距为 $h$ 的均匀网格上进行近似。考虑对空间导数 $f'(x_i)$ 的中心差分近似\n$$\n\\frac{f_{i+1}-f_{i-1}}{2h}\n$$\n，其中 $f_i \\equiv f(x_i)$ 且 $x_{i\\pm 1} = x_i \\pm h$。假设函数 $f$ 在 $x_i$ 附近足够光滑，可以进行泰勒级数展开。\n\n从函数 $f$ 在 $x_i$ 点的泰勒级数出发，推导当使用上述中心差分近似 $f'(x_i)$ 时的精度阶和主截断误差项。您的推导必须从泰勒级数的定义开始，并通过由差分格式对称性所蕴含的项的系统性抵消来进行；不得在没有推导的情况下引用任何误差项公式。\n\n作为最终答案，请提供主阶截断误差项，该项应为一个关于 $h$ 和在 $x_i$ 处求值的 $f$ 的导数的闭合形式解析表达式。无需进行数值舍入，也无需单位。精度阶应在您的推理中得到证明，但不应作为最终方框答案的一部分。",
            "solution": "本题要求推导一阶导数 $f'(x_i)$ 的中心差分近似的精度阶和主截断误差项。该近似由公式 $\\frac{f_{i+1}-f_{i-1}}{2h}$ 给出，其中 $f_j \\equiv f(x_j)$ 且 $x_{i \\pm 1} = x_i \\pm h$。推导必须基于函数 $f(x)$ 在点 $x_i$ 附近的泰勒级数展开。\n\n局部截断误差（我们记为 $\\tau(x_i, h)$）的正式定义是，将有限差分近似应用于精确函数所得到的值，与它所要近似的精确导数之间的差。因此，我们有：\n$$\n\\tau(x_i, h) = \\frac{f(x_i+h) - f(x_i-h)}{2h} - f'(x_i)\n$$\n为分析此表达式，我们使用 $f(x)$ 在点 $x_i$ 附近的泰勒级数展开。题目中 $f(x)$ “足够光滑”的前提保证了此展开的有效性。我们展开 $f(x_i+h)$ 和 $f(x_i-h)$，并将 $f(x)$ 在 $x_i$ 处的 $n$ 阶导数记为 $f^{(n)}(x_i)$。为清晰起见，我们还使用记号 $f_i \\equiv f(x_i)$。\n\n$f(x_i+h)$ 的泰勒级数展开为：\n$$\nf_{i+1} = f(x_i+h) = f(x_i) + h f'(x_i) + \\frac{h^2}{2!} f''(x_i) + \\frac{h^3}{3!} f^{(3)}(x_i) + \\frac{h^4}{4!} f^{(4)}(x_i) + \\frac{h^5}{5!} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n代入阶乘的数值：\n$$\nf_{i+1} = f_i + h f'(x_i) + \\frac{h^2}{2} f''(x_i) + \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) + \\frac{h^5}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n类似地，$f(x_i-h)$ 的泰勒级数展开为：\n$$\nf_{i-1} = f(x_i-h) = f(x_i) + (-h) f'(x_i) + \\frac{(-h)^2}{2!} f''(x_i) + \\frac{(-h)^3}{3!} f^{(3)}(x_i) + \\frac{(-h)^4}{4!} f^{(4)}(x_i) + \\frac{(-h)^5}{5!} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nf_{i-1} = f_i - h f'(x_i) + \\frac{h^2}{2} f''(x_i) - \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) - \\frac{h^5}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n按照题目要求，我们现在系统地展示各项的抵消过程。我们计算差值 $f_{i+1} - f_{i-1}$，它构成了中心差分公式的分子。\n\\begin{align*}\nf_{i+1} - f_{i-1} =  \\left( f_i + h f'(x_i) + \\frac{h^2}{2} f''(x_i) + \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) + \\dots \\right) \\\\\n - \\left( f_i - h f'(x_i) + \\frac{h^2}{2} f''(x_i) - \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) - \\dots \\right)\n\\end{align*}\n按 $f(x)$ 的导数阶数对各项进行分组：\n\\begin{align*}\n\\text{零阶项：} \\quad  f_i - f_i = 0 \\\\\n\\text{一阶项：} \\quad  h f'(x_i) - (-h f'(x_i)) = 2h f'(x_i) \\\\\n\\text{二阶项：} \\quad  \\frac{h^2}{2} f''(x_i) - \\frac{h^2}{2} f''(x_i) = 0 \\\\\n\\text{三阶项：} \\quad  \\frac{h^3}{6} f^{(3)}(x_i) - \\left(-\\frac{h^3}{6} f^{(3)}(x_i)\\right) = 2 \\frac{h^3}{6} f^{(3)}(x_i) = \\frac{h^3}{3} f^{(3)}(x_i) \\\\\n\\text{四阶项：} \\quad  \\frac{h^4}{24} f^{(4)}(x_i) - \\frac{h^4}{24} f^{(4)}(x_i) = 0 \\\\\n\\text{五阶项：} \\quad  \\frac{h^5}{120} f^{(5)}(x_i) - \\left(-\\frac{h^5}{120} f^{(5)}(x_i)\\right) = 2 \\frac{h^5}{120} f^{(5)}(x_i) = \\frac{h^5}{60} f^{(5)}(x_i)\n\\end{align*}\n此计算展示了对称差分格式的一个关键特性：所有对应于偶数阶导数（$f_i$、$f''(x_i)$、$f^{(4)}(x_i)$ 等）的项都相互抵消，而对应于奇数阶导数（$f'(x_i)$、$f^{(3)}(x_i)$、$f^{(5)}(x_i)$ 等）的项则相加。\n\n将非零项相加，差值 $f_{i+1} - f_{i-1}$ 为：\n$$\nf_{i+1} - f_{i-1} = 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n现在，我们除以 $2h$ 来构建完整的中心差分近似：\n$$\n\\frac{f_{i+1} - f_{i-1}}{2h} = \\frac{1}{2h} \\left( 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + \\mathcal{O}(h^7) \\right)\n$$\n$$\n\\frac{f_{i+1} - f_{i-1}}{2h} = f'(x_i) + \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n从两边减去 $f'(x_i)$，我们分离出截断误差 $\\tau(x_i, h)$：\n$$\n\\tau(x_i, h) = \\frac{f_{i+1} - f_{i-1}}{2h} - f'(x_i) = \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n一个数值格式的精度阶由局部截断误差级数展开式中网格间距 $h$ 的最低次幂决定。当 $h \\to 0$ 时，假设 $f^{(3)}(x_i) \\neq 0$，则 $\\frac{h^2}{6} f^{(3)}(x_i)$ 是误差的主部。因此，误差与 $h^2$ 成正比，记作 $\\mathcal{O}(h^2)$。这意味着中心差分近似是二阶精度的。\n\n主阶截断误差项是误差级数中的第一个非零项。根据我们推导出的表达式，该项为：\n$$\n\\frac{h^2}{6} f^{(3)}(x_i)\n$$\n至此，所需推导完成。",
            "answer": "$$\n\\boxed{\\frac{h^2}{6} f^{(3)}(x_i)}\n$$"
        },
        {
            "introduction": "在掌握了一阶导数的近似方法后，我们自然地将目光投向二阶导数，它在波动方程、扩散方程等众多物理模型中扮演着核心角色。本练习  将展示如何将泰勒级数分析方法从一阶导数扩展到二阶导数。通过系统地组合不同点的泰勒展开式，你将推导出用于近似二阶导数的标准三点中心差分格式，并确定其截断误差，这是求解声波方程等二阶偏微分方程的关键技能。",
            "id": "3593483",
            "problem": "在由一维偏微分方程（PDE）控制的地震波传播的数值模拟中，空间导数通常通过均匀网格上的有限差分算子来近似。考虑一个足够光滑的标量场 $f(x)$，它在包含 $x_{i}$ 的区间上至少有四阶连续导数，并在网格间距为 $h > 0$ 的均匀网格 $x_{i} = x_{0} + i h$ 上采样。使用关于点 $x_{i}$ 的泰勒级数展开，推导在 $x_{i}$ 处的二阶空间导数的标准三点中心差分近似。然后，通过在泰勒展开式中系统地保留到四阶导数的项，计算此二阶导数模板的主截断误差项，并用 $f^{(4)}(x_{i})$ 和 $h$ 明确表示。将最终答案表示为单个闭式解析表达式。最终答案无需四舍五入，也不包含单位。",
            "solution": "该问题要求推导二阶导数的三点中心差分公式，并随后确定其主截断误差项。推导将基于一个足够光滑的函数 $f(x)$ 在均匀网格上的点 $x_i$ 附近的泰勒级数展开。假设函数 $f(x)$ 在 $x_i$ 的邻域内至少有四阶连续导数。均匀网格由点 $x_i = x_0 + i h$ 定义，其中 $h > 0$ 是恒定的网格间距。\n\n我们首先写出 $f(x_{i+1}) = f(x_i + h)$ 和 $f(x_{i-1}) = f(x_i - h)$ 关于点 $x_i$ 的泰勒级数展开式。问题指明我们应该保留到四阶导数的项。为了正确确定主误差项，我们将包括余项，它会涉及高于四阶的导数。一种更直接的方法是使用大O符号，这是此类推导的标准做法。\n\n$f(x_i + h)$ 的泰勒级数展开式为：\n$$f(x_{i+1}) = f(x_i) + h f'(x_i) + \\frac{h^2}{2!} f''(x_i) + \\frac{h^3}{3!} f'''(x_i) + \\frac{h^4}{4!} f^{(4)}(x_i) + O(h^5)$$\n使用更紧凑的记法，其中 $f_i = f(x_i)$，$f'_i = f'(x_i)$，依此类推，上式变为：\n$$f_{i+1} = f_i + h f'_i + \\frac{h^2}{2} f''_i + \\frac{h^3}{6} f'''_i + \\frac{h^4}{24} f^{(4)}_i + O(h^5) \\quad (1)$$\n\n类似地，$f(x_i - h)$ 的泰勒级数展开式为：\n$$f(x_{i-1}) = f_i + (-h) f'_i + \\frac{(-h)^2}{2} f''_i + \\frac{(-h)^3}{6} f'''_i + \\frac{(-h)^4}{24} f^{(4)}_i + O((-h)^5)$$\n$$f_{i-1} = f_i - h f'_i + \\frac{h^2}{2} f''_i - \\frac{h^3}{6} f'''_i + \\frac{h^4}{24} f^{(4)}_i + O(h^5) \\quad (2)$$\n注意，在此上下文中 $O((-h)^5)$ 等价于 $O(h^5)$，但写出负号具有指导意义。\n\n我们的目标是找到二阶导数 $f''_i$ 的一个近似。观察方程 $(1)$ 和 $(2)$，我们看到涉及奇数阶导数（$f'_i$，$f'''_i$）的项符号相反。因此，将这两个方程相加将消去这些项。\n将方程 $(1)$ 和方程 $(2)$ 相加：\n$$f_{i+1} + f_{i-1} = (f_i + f_i) + (h f'_i - h f'_i) + \\left(\\frac{h^2}{2} f''_i + \\frac{h^2}{2} f''_i\\right) + \\left(\\frac{h^3}{6} f'''_i - \\frac{h^3}{6} f'''_i\\right) + \\left(\\frac{h^4}{24} f^{(4)}_i + \\frac{h^4}{24} f^{(4)}_i\\right) + O(h^6)$$\n必须小心处理误差项。展开式中的五阶项分别为 $\\frac{h^5}{120}f^{(5)}_i$ 和 $\\frac{(-h)^5}{120}f^{(5)}_i = -\\frac{h^5}{120}f^{(5)}_i$。它们的和为零。因此，展开式相加后的下一个非零项涉及 $h^6$，余项的阶为 $O(h^6)$。\n对各项求和得到：\n$$f_{i+1} + f_{i-1} = 2f_i + h^2 f''_i + \\frac{2h^4}{24} f^{(4)}_i + O(h^6)$$\n$$f_{i+1} + f_{i-1} = 2f_i + h^2 f''_i + \\frac{h^4}{12} f^{(4)}_i + O(h^6)$$\n\n现在，我们可以重新整理此方程以求解二阶导数 $f''_i$。\n$$h^2 f''_i = f_{i+1} - 2f_i + f_{i-1} - \\frac{h^4}{12} f^{(4)}_i - O(h^6)$$\n两边除以 $h^2$：\n$$f''_i = \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2} - \\frac{h^2}{12} f^{(4)}_i - O(h^4)$$\n\n这个方程同时提供了有限差分近似及其误差。问题的第一个部分是推导该近似。通过忽略涉及 $h$ 的项，我们得到二阶导数的标准三点中心差分近似：\n$$f''(x_i) \\approx \\frac{f(x_{i+1}) - 2f(x_i) + f(x_{i-1})}{h^2}$$\n\n问题的第二部分是求主截断误差。截断误差 $\\tau$ 定义为有限差分近似与其所近似的精确微分算子之差。\n$$\\tau = \\left( \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2} \\right) - f''_i$$\n从我们为 $f''_i$ 重新整理的方程中，我们可以直接找到 $\\tau$ 的表达式：\n$$\\tau = \\left( f''_i + \\frac{h^2}{12} f^{(4)}_i + O(h^4) \\right) - f''_i$$\n$$\\tau = \\frac{h^2}{12} f^{(4)}_i + O(h^4)$$\n\n主截断误差项是 $\\tau$ 展开式中 $h$ 的最低次幂项。在本例中，该项为 $\\frac{h^2}{12} f^{(4)}(x_i)$。这表明该近似是二阶精度的，因为误差与 $h^2$ 成比例。该表达式按要求用 $h$ 和 $f^{(4)}(x_i)$ 表示。",
            "answer": "$$\\boxed{\\frac{h^2}{12} f^{(4)}(x_i)}$$"
        },
        {
            "introduction": "在实际的计算声学模拟中，除了处理计算域内部，如何精确地施加边界条件同样至关重要。标准的中心差分格式在计算网格的边界点会失效，因为它需要用到域外的点。本练习  聚焦于这一实际挑战，要求你构建一个仅使用域内网格点的单边差分格式。你将学习使用待定系数法，结合泰勒级数展开，系统地设计出满足特定精度要求的非对称格式，这正是在计算中处理边界问题的核心技术。",
            "id": "4139048",
            "problem": "在一个直的、无损耗管道的一维计算声学模拟中，令 $f(x)$ 表示在固定时间 $t^{n}$ 的声压 $p(x,t^{n})$，并假设它在刚性边界 $x=x_{0}$ 的邻域内足够光滑。为了实现一个模拟有限比声阻抗的 Robin 型边界条件，需要一个法向导数 $f'(x_{0})$ 的单侧空间近似，该近似只使用内部网格点 $x_{0}$、$x_{0}+h$ 和 $x_{0}+2h$，其中 $h>0$ 是均匀的网格间距。\n\n仅从关于 $x_{0}$ 的 Taylor 级数展开和导数作为差商极限的定义出发，推导一个关于 $h$ 是二阶精度的 $f'(x_{0})$ 的单侧近似。然后，确定由下式定义的主阶截断误差常数 $C$：\n$$\nf'(x_{0}) - \\mathcal{D}_{+}f(x_{0}) = C h^{2} f^{(3)}(x_{0}) + \\mathcal{O}(h^{3})\n$$\n其中 $\\mathcal{D}_{+}f(x_{0})$ 表示您推导出的单侧有限差分近似，$f^{(3)}(x_{0})$ 是 $f$ 在 $x_{0}$ 处的三阶导数。\n\n将您的最终答案表示为一个两元行矩阵，其左侧元素是 $\\mathcal{D}_{+}f(x_{0})$ 用 $f(x_{0})$、$f(x_{0}+h)$、$f(x_{0}+2h)$ 和 $h$ 表示的闭式表达式，其右侧元素是常数 $C$。无需进行数值计算。",
            "solution": "目标是利用在网格点 $x_{0}$、$x_{0}+h$ 和 $x_{0}+2h$ 上的函数值，找到一阶导数 $f'(x_{0})$ 的一个单侧、二阶精度的近似。令该近似表示为 $\\mathcal{D}_{+}f(x_{0})$。我们可以将此近似表示为在指定点上函数值的线性组合。为确保正确的物理量纲（因为 $f'(x_{0})$ 的量纲是 $f$ 的量纲除以长度），其一般形式应为：\n$$\n\\mathcal{D}_{+}f(x_{0}) = \\frac{a f(x_{0}) + b f(x_{0}+h) + c f(x_{0}+2h)}{h}\n$$\n其中 $a$、$b$ 和 $c$ 是待确定的无量纲常数。\n\n为了找到这些常数，我们利用 $f(x)$ 在点 $x_{0}$ 附近的 Taylor 级数展开。假设 $f(x)$ 足够光滑，我们有：\n$$\nf(x_{0}+h) = f(x_{0}) + h f'(x_{0}) + \\frac{h^{2}}{2} f''(x_{0}) + \\frac{h^{3}}{6} f^{(3)}(x_{0}) + \\mathcal{O}(h^{4})\n$$\n$$\nf(x_{0}+2h) = f(x_{0}) + (2h) f'(x_{0}) + \\frac{(2h)^{2}}{2} f''(x_{0}) + \\frac{(2h)^{3}}{6} f^{(3)}(x_{0}) + \\mathcal{O}(h^{4})\n$$\n将这些展开式代入 $\\mathcal{D}_{+}f(x_{0})$ 的表达式中，可得：\n$$\n\\mathcal{D}_{+}f(x_{0}) = \\frac{1}{h} \\left[ a f(x_{0}) + b\\left(f(x_{0}) + h f'(x_{0}) + \\frac{h^{2}}{2} f''(x_{0}) + \\frac{h^{3}}{6} f^{(3)}(x_{0}) + \\dots\\right) + c\\left(f(x_{0}) + 2h f'(x_{0}) + 2h^{2} f''(x_{0}) + \\frac{4h^{3}}{3} f^{(3)}(x_{0}) + \\dots\\right) \\right]\n$$\n我们按照 $f$ 在 $x_{0}$ 处的各阶导数对各项进行分组：\n$$\n\\mathcal{D}_{+}f(x_{0}) = \\frac{1}{h}(a+b+c)f(x_{0}) + (b+2c)f'(x_{0}) + h\\left(\\frac{b}{2}+2c\\right)f''(x_{0}) + h^{2}\\left(\\frac{b}{6}+\\frac{4c}{3}\\right)f^{(3)}(x_{0}) + \\mathcal{O}(h^{3})\n$$\n为了使 $\\mathcal{D}_{+}f(x_{0})$ 成为 $f'(x_{0})$ 的一个二阶精度近似，我们需要满足以下条件：\n1.  $f(x_{0})$ 的系数必须为 $0$，以避免出现 $\\mathcal{O}(h^{-1})$ 阶的项。\n    $$a+b+c = 0$$\n2.  $f'(x_{0})$ 的系数必须为 $1$。\n    $$b+2c = 1$$\n3.  $h f''(x_{0})$ 项的系数必须为 $0$，以消除一阶误差，从而使近似达到二阶精度。\n    $$\\frac{b}{2}+2c = 0$$\n\n我们现在求解这个关于 $a$、$b$ 和 $c$ 的三元线性方程组。由第三个方程，我们有 $b/2 = -2c$，这意味着 $b = -4c$。\n将 $b = -4c$ 代入第二个方程：\n$$\n(-4c) + 2c = 1 \\implies -2c = 1 \\implies c = -\\frac{1}{2}\n$$\n现在我们求 $b$：\n$$\nb = -4c = -4\\left(-\\frac{1}{2}\\right) = 2\n$$\n最后，使用第一个方程求 $a$：\n$$\na + b + c = 0 \\implies a + 2 + \\left(-\\frac{1}{2}\\right) = 0 \\implies a + \\frac{3}{2} = 0 \\implies a = -\\frac{3}{2}\n$$\n系数为 $a = -\\frac{3}{2}$、$b = 2$ 和 $c = -\\frac{1}{2}$。将这些系数代回一般形式，得到所需的有限差分近似：\n$$\n\\mathcal{D}_{+}f(x_{0}) = \\frac{-\\frac{3}{2} f(x_{0}) + 2 f(x_{0}+h) - \\frac{1}{2} f(x_{0}+2h)}{h} = \\frac{-3 f(x_{0}) + 4 f(x_{0}+h) - f(x_{0}+2h)}{2h}\n$$\n这是所需答案的第一部分。\n\n接下来，我们必须确定主阶截断误差和常数 $C$。误差项是在匹配了各项之后，$\\mathcal{D}_{+}f(x_{0})$ 展开式中的剩余部分。代入已确定的系数，该展开式变为：\n$$\n\\mathcal{D}_{+}f(x_{0}) = f'(x_{0}) + h^{2}\\left(\\frac{b}{6}+\\frac{4c}{3}\\right)f^{(3)}(x_{0}) + \\mathcal{O}(h^{3})\n$$\n问题将截断误差定义为 $f'(x_{0}) - \\mathcal{D}_{+}f(x_{0})$。对上式进行移项可得：\n$$\nf'(x_{0}) - \\mathcal{D}_{+}f(x_{0}) = -h^{2}\\left(\\frac{b}{6}+\\frac{4c}{3}\\right)f^{(3)}(x_{0}) + \\mathcal{O}(h^{3})\n$$\n将此式与给定的误差表达式 $f'(x_{0})-\\mathcal{D}_{+}f(x_{0}) = C\\,h^{2}\\,f^{(3)}(x_{0}) + \\mathcal{O}(h^{3})$ 进行比较，我们可以确定常数 $C$ 为：\n$$\nC = -\\left(\\frac{b}{6}+\\frac{4c}{3}\\right)\n$$\n代入值 $b=2$ 和 $c=-\\frac{1}{2}$：\n$$\nC = -\\left(\\frac{2}{6}+\\frac{4(-\\frac{1}{2})}{3}\\right) = -\\left(\\frac{1}{3}-\\frac{2}{3}\\right) = -\\left(-\\frac{1}{3}\\right) = \\frac{1}{3}\n$$\n因此，主阶截断误差常数为 $C = \\frac{1}{3}$。\n\n最终答案是一个两元行矩阵，其中包含 $\\mathcal{D}_{+}f(x_{0})$ 的表达式和 $C$ 的值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{-3f(x_{0}) + 4f(x_{0}+h) - f(x_{0}+2h)}{2h} & \\frac{1}{3} \\end{pmatrix}}\n$$"
        }
    ]
}