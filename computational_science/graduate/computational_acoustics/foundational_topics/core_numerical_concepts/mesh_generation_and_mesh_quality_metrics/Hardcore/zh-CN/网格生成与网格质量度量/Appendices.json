{
    "hands_on_practices": [
        {
            "introduction": "为了使网格精确地贴合复杂几何的边界，计算声学中经常使用弯曲的“等参”单元。这种单元通过一个数学映射，将一个简单的参考形状（如标准三角形）变换为物理空间中的弯曲形状。为了保证这个映射在物理上是有效的，它必须是可逆的且保持方向的，这意味着单元不能发生翻转或自相交。这个性质由雅可比行列式 $J$ 的符号决定，它在单元内的任何地方都必须为正。通过这个练习 ，你将从第一性原理出发，为一个二次弯曲三角形计算雅可比行列式，并验证其有效性，从而掌握保证网格几何有效性的核心技能。",
            "id": "4128648",
            "problem": "一个二维声腔使用有限元法 (FEM) 进行离散化，采用弯曲的等参二次三角形单元来贴合光滑边界。考虑一个单独的 $6$ 节点等参二次三角形，其从参考三角形 $(\\xi,\\eta)$（重心坐标为 $\\zeta = 1 - \\xi - \\eta$，区域为 $0 \\leq \\xi, \\eta, \\xi + \\eta \\leq 1$）到物理坐标 $(x,y)$ 的映射由在以下物理节点位置（所有坐标单位为 $\\mathrm{m}$）的二次 Lagrange 插值定义：\n- 顶点节点：节点 $1$ 位于 $(x_{1},y_{1}) = (0,0)$，节点 $2$ 位于 $(x_{2},y_{2}) = (1,0)$，节点 $3$ 位于 $(x_{3},y_{3}) = (0,1)$。\n- 边中节点：边 $1$–$2$ 上的节点 $4$ 位于 $(x_{4},y_{4}) = (0.5, 0.05)$，边 $2$–$3$ 上的节点 $5$ 位于 $(x_{5},y_{5}) = (0.5, 0.55)$，边 $3$–$1$ 上的节点 $6$ 位于 $(x_{6},y_{6}) = (-0.05, 0.5)$。\n\n从等参插值的定义以及参考三角形上二次 Lagrange 多项式的节点插值条件出发，推导出二次形函数 $N_{i}(\\xi,\\eta)$，$i=1,\\dots,6$，并用它们构建等参映射 $(x(\\xi,\\eta), y(\\xi,\\eta)) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) (x_{i}, y_{i})$。直接根据定义，计算雅可比行列式\n$$\nJ(\\xi,\\eta) = \\det\\!\\left( \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} \\right)\n$$\n在整个参数域 $0 \\leq \\xi, \\eta, \\xi + \\eta \\leq 1$ 上的值，并确定其在该域上的最小值。根据这个最小值，判断是否在单元内的所有地方都有 $J(\\xi,\\eta) > 0$，并解释此结果对于计算声学中网格有效性的意义。\n\n以 $\\mathrm{m^{2}}$ 为单位表示雅可比行列式的最终最小值，并将您的答案四舍五入到四位有效数字。",
            "solution": "问题要求计算一个特定的 $6$ 节点等参二次三角形的雅可比行列式的最小值，并讨论该结果的意义。解答过程分四个阶段进行：(1) 在参考单元上定义二次形函数，(2) 构建等参坐标映射，(3) 计算雅可比行列式，(4) 在单元域上找到雅可比行列式的最小值。\n\n步骤1：推导二次形函数 $N_{i}(\\xi,\\eta)$\n该单元是一个 $6$ 节点二次三角形。形函数 $N_i(\\xi, \\eta)$ 定义在 $(\\xi, \\eta)$ 平面内的一个参考三角形上，其顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$。使用重心坐标 $\\zeta = 1 - \\xi - \\eta$、$\\xi$ 和 $\\eta$ 会很方便。一个 $6$ 节点 Lagrange 三角形的形函数由以下公式给出：\n对于顶点节点 $i=1,2,3$：$N_i = L_i(2L_i-1)$\n对于边中节点 $i=4,5,6$：$N_{jk} = 4L_j L_k$\n节点的参考坐标为：\n节点 1: $(\\xi,\\eta)=(0,0)$, 此时 $\\zeta=1$。\n节点 2: $(\\xi,\\eta)=(1,0)$, 此时 $\\xi=1$。\n节点 3: $(\\xi,\\eta)=(0,1)$, 此时 $\\eta=1$。\n节点 4 (1-2 的中点): $(\\xi,\\eta)=(0.5,0)$。\n节点 5 (2-3 的中点): $(\\xi,\\eta)=(0.5,0.5)$。\n节点 6 (3-1 的中点): $(\\xi,\\eta)=(0,0.5)$。\n\n使用重心坐标 $L_1=\\zeta=1-\\xi-\\eta$, $L_2=\\xi$, 和 $L_3=\\eta$, 形函数为：\n顶点节点：\n$N_1(\\xi,\\eta) = \\zeta(2\\zeta-1) = (1-\\xi-\\eta)(2(1-\\xi-\\eta)-1) = (1-\\xi-\\eta)(1-2\\xi-2\\eta)$\n$N_2(\\xi,\\eta) = \\xi(2\\xi-1)$\n$N_3(\\xi,\\eta) = \\eta(2\\eta-1)$\n\n边中节点：\n$N_4(\\xi,\\eta) = 4L_1 L_2 = 4\\zeta\\xi = 4\\xi(1-\\xi-\\eta)$ (对于边 1-2)\n$N_5(\\xi,\\eta) = 4L_2 L_3 = 4\\xi\\eta$ (对于边 2-3)\n$N_6(\\xi,\\eta) = 4L_3 L_1 = 4\\eta\\zeta = 4\\eta(1-\\xi-\\eta)$ (对于边 3-1)\n\n步骤2：构建等参映射\n等参映射使用相同的形函数将物理坐标 $(x,y)$ 与参考坐标 $(\\xi,\\eta)$ 关联起来：\n$$x(\\xi,\\eta) = \\sum_{i=1}^{6} N_i(\\xi,\\eta) x_i$$\n$$y(\\xi,\\eta) = \\sum_{i=1}^{6} N_i(\\xi,\\eta) y_i$$\n给定的物理节点坐标为：\n$(x_1, y_1) = (0,0)$, $(x_2, y_2) = (1,0)$, $(x_3, y_3) = (0,1)$,\n$(x_4, y_4) = (0.5, 0.05)$, $(x_5, y_5) = (0.5, 0.55)$, $(x_6, y_6) = (-0.05, 0.5)$。\n\n将节点坐标和形函数代入 $x(\\xi,\\eta)$ 的表达式中：\n$x(\\xi,\\eta) = x_1 N_1 + x_2 N_2 + x_3 N_3 + x_4 N_4 + x_5 N_5 + x_6 N_6$\n$x(\\xi,\\eta) = (0)N_1 + (1)N_2 + (0)N_3 + (0.5)N_4 + (0.5)N_5 + (-0.05)N_6$\n$x(\\xi,\\eta) = \\xi(2\\xi-1) + 0.5 \\cdot 4\\xi(1-\\xi-\\eta) + 0.5 \\cdot 4\\xi\\eta - 0.05 \\cdot 4\\eta(1-\\xi-\\eta)$\n$x(\\xi,\\eta) = 2\\xi^2-\\xi + 2\\xi(1-\\xi-\\eta) + 2\\xi\\eta - 0.2\\eta(1-\\xi-\\eta)$\n$x(\\xi,\\eta) = 2\\xi^2-\\xi + 2\\xi - 2\\xi^2 - 2\\xi\\eta + 2\\xi\\eta - 0.2\\eta + 0.2\\xi\\eta + 0.2\\eta^2$\n$x(\\xi,\\eta) = \\xi - 0.2\\eta + 0.2\\eta^2 + 0.2\\xi\\eta$\n\n代入 $y(\\xi,\\eta)$ 的表达式：\n$y(\\xi,\\eta) = y_1 N_1 + y_2 N_2 + y_3 N_3 + y_4 N_4 + y_5 N_5 + y_6 N_6$\n$y(\\xi,\\eta) = (0)N_1 + (0)N_2 + (1)N_3 + (0.05)N_4 + (0.55)N_5 + (0.5)N_6$\n$y(\\xi,\\eta) = \\eta(2\\eta-1) + 0.05 \\cdot 4\\xi(1-\\xi-\\eta) + 0.55 \\cdot 4\\xi\\eta + 0.5 \\cdot 4\\eta(1-\\xi-\\eta)$\n$y(\\xi,\\eta) = 2\\eta^2-\\eta + 0.2\\xi-0.2\\xi^2-0.2\\xi\\eta + 2.2\\xi\\eta + 2\\eta-2\\xi\\eta-2\\eta^2$\n$y(\\xi,\\eta) = \\eta + 0.2\\xi - 0.2\\xi^2 + (-0.2+2.2-2.0)\\xi\\eta$\n$y(\\xi,\\eta) = \\eta + 0.2\\xi - 0.2\\xi^2$\n\n步骤3：计算雅可比行列式\n该变换的雅可比矩阵为 $\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$。其分量是映射函数的偏导数：\n$\\frac{\\partial x}{\\partial \\xi} = 1 + 0.2\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = -0.2 + 0.4\\eta + 0.2\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = 0.2 - 0.4\\xi$\n$\\frac{\\partial y}{\\partial \\eta} = 1$\n\n雅可比行列式为 $J(\\xi,\\eta) = \\det(\\mathbf{J}) = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}$：\n$J(\\xi,\\eta) = (1 + 0.2\\eta)(1) - (-0.2 + 0.2\\xi + 0.4\\eta)(0.2 - 0.4\\xi)$\n$J(\\xi,\\eta) = 1 + 0.2\\eta - [-0.04 + 0.08\\xi + 0.04\\xi - 0.08\\xi^2 + 0.08\\eta - 0.16\\xi\\eta]$\n$J(\\xi,\\eta) = 1 + 0.2\\eta - [-0.04 + 0.12\\xi - 0.08\\xi^2 + 0.08\\eta - 0.16\\xi\\eta]$\n$J(\\xi,\\eta) = 1 + 0.2\\eta + 0.04 - 0.12\\xi + 0.08\\xi^2 - 0.08\\eta + 0.16\\xi\\eta$\n$J(\\xi,\\eta) = 1.04 - 0.12\\xi + 0.12\\eta + 0.08\\xi^2 + 0.16\\xi\\eta$\n\n步骤4：求雅可比行列式的最小值\n为了在由 $0 \\leq \\xi$，$0 \\leq \\eta$ 和 $\\xi+\\eta \\leq 1$ 定义的域上找到 $J(\\xi,\\eta)$ 的最小值，我们首先通过将 $J$ 的梯度设为零来检查内部的临界点：\n$\\frac{\\partial J}{\\partial \\xi} = -0.12 + 0.16\\xi + 0.16\\eta = 0$\n$\\frac{\\partial J}{\\partial \\eta} = 0.12 + 0.16\\xi = 0$\n从第二个方程可得 $0.16\\xi = -0.12$，即 $\\xi = -0.12/0.16 = -0.75$。此点位于域外，因此最小值必定位于参考三角形的边界上。边界由三条线段组成：\n1. 边 $\\eta=0$，对于 $0 \\leq \\xi \\leq 1$：\n   $J(\\xi,0) = 1.04 - 0.12\\xi + 0.08\\xi^2$。\n   为求此线段上的最小值，我们对 $\\xi$ 求导：\n   $\\frac{dJ}{d\\xi} = -0.12 + 0.16\\xi = 0 \\implies \\xi = 0.12/0.16 = 0.75$。\n   此点在区间 $[0,1]$ 内。在此点处雅可比行列式的值为：\n   $J(0.75, 0) = 1.04 - 0.12(0.75) + 0.08(0.75)^2 = 1.04 - 0.09 + 0.08(0.5625) = 0.95 + 0.045 = 0.995$。\n   此线段端点处的值为 $J(0,0)=1.04$ 和 $J(1,0)=1.04-0.12+0.08=1$。\n\n2. 边 $\\xi=0$，对于 $0 \\leq \\eta \\leq 1$：\n   $J(0,\\eta) = 1.04 + 0.12\\eta$。这是关于 $\\eta$ 的线性递增函数。其在 $[0,1]$ 上的最小值出现在 $\\eta=0$ 处，得到 $J(0,0)=1.04$。\n\n3. 边 $\\eta=1-\\xi$，对于 $0 \\leq \\xi \\leq 1$：\n   $J(\\xi, 1-\\xi) = 1.04 - 0.12\\xi + 0.12(1-\\xi) + 0.08\\xi^2 + 0.16\\xi(1-\\xi)$\n   $J(\\xi, 1-\\xi) = 1.04 - 0.12\\xi + 0.12 - 0.12\\xi + 0.08\\xi^2 + 0.16\\xi - 0.16\\xi^2$\n   $J(\\xi, 1-\\xi) = 1.16 - 0.08\\xi - 0.08\\xi^2$。\n   导数为 $\\frac{dJ}{d\\xi} = -0.08 - 0.16\\xi$。令其为零得到 $\\xi = -0.5$，这在 $[0,1]$ 之外。由于当 $\\xi \\in [0,1]$ 时导数为负，该函数是递减的。此线段上的最小值出现在 $\\xi=1$ 处，对应于点 $(1,0)$。其值为 $J(1,0)=1$，如前所算。\n\n通过比较所有候选值（$0.995$、$1.04$ 和 $1$），雅可比行列式的最小值为 $J_{\\min} = 0.995$。\n\n结论与意义\n在整个单元上，雅可比行列式的最小值为 $J_{min} = 0.995$。由于节点坐标的单位是米 $(\\mathrm{m})$，雅可比行列式的单位是面积单位 $\\mathrm{m^2}$。\n条件 $J(\\xi,\\eta) > 0$ 在单元内处处成立。这是有限元网格有效的关键要求。\n雅可比行列式严格为正的意义如下：\n1.  **几何有效性**：一个正的 $J$ 确保从参考单元到物理单元的映射是一对一且保向的。这意味着单元不会自我折叠或翻转。在任何一点 $J \\leq 0$ 的单元都被认为是畸变或无效的单元。\n2.  **数值积分**：在有限元法中，物理单元域 $\\Omega_e$ 上的函数积分是通过变换到参考域来计算的：$\\int_{\\Omega_e} f(x,y)\\,dx\\,dy = \\int_0^1 \\int_0^{1-\\xi} f(x(\\xi,\\eta), y(\\xi,\\eta)) J(\\xi,\\eta)\\,d\\eta\\,d\\xi$。如果 $J \\leq 0$，面积微元 $dA=J\\,d\\xi\\,d\\eta$ 将为非正值，这在物理上是无意义的，并会导致不正确的结果。\n3.  **求解器稳定性**：网格中存在雅可比行列式非正的单元通常会导致全局刚度矩阵奇异或病态，从而导致数值求解器失败或产生物理上无意义的结果。因此，对于任何基于有限元法的仿真（包括计算声学），确保所有单元的 $J > 0$ 是网格生成中的一项基本检查。\n\n雅可比行列式的最小值为 $0.995 \\, \\mathrm{m^2}$。四舍五入到四位有效数字，结果是 $0.9950 \\, \\mathrm{m^2}$。",
            "answer": "$$\n\\boxed{0.9950}\n$$"
        },
        {
            "introduction": "一个有效的网格（即所有单元的雅可比行列式均为正）仍然可能包含质量很差的单元，从而影响数值解的精度和稳定性。在三维网格中，一种臭名昭著的病态单元是“薄片”四面体（sliver tetrahedron），其四个顶点几乎共面。这个练习  将让你亲手处理一个这样的病态单元。你将通过计算一个关键的质量度量——归一化体积——来量化该单元的几何质量，并根据阈值将其分类。这项实践将使你从“有效/无效”的二元判断，深入到对网格质量进行连续量化的层面，这对于生成高质量的计算网格至关重要。",
            "id": "4128627",
            "problem": "在计算声学中，声波方程离散化的准确性和稳定性对四面体网格的质量很敏感。在病态单元中，扁片（sliver）是指顶点近乎共面的四面体，其体积相对于边长非常小，这会降低有限元法（FEM）矩阵的条件数并导致色散误差。常用于检测此类扁片的一个无量纲质量度量是归一化体积，定义为 $V/L_{\\max}^{3}$，其中 $V$ 是四面体的体积，$L_{\\max}$ 是其六条边中的最大边长。\n\n考虑一个顶点为 $A=(1,0,0)$、$B=(0,1,0)$、$C=(1,1,10^{-3})$ 和 $D=(0,0,0)$ 的四面体。使用矢量几何的基本原理，并且不调用任何预先制定的网格质量公式，计算其归一化体积 $V/L_{\\max}^{3}$，并根据以下规则将该单元分类为扁片：如果 $V/L_{\\max}^{3}  \\tau$ 则声明为“扁片”（sliver），否则为“非扁片”（non-sliver），其中阈值 $\\tau=10^{-3}$。将该分类编码为一个指示符 $I$，如果单元是扁片，则 $I=1$，否则 $I=0$。\n\n将归一化体积 $V/L_{\\max}^{3}$ 四舍五入到四位有效数字。将最终答案的两个分量都表示为无量纲数。将最终答案以一个二分量行矩阵 $\\begin{pmatrix}V/L_{\\max}^{3}  I\\end{pmatrix}$ 的形式给出。",
            "solution": "该问题被验证为具有科学依据、良态的且客观的。它通过其顶点清晰地定义了四面体，给出了一个待计算的特定质量度量，以及一个精确的分类规则。所有必要信息都已提供且一致。\n\n任务是计算给定四面体的归一化体积 $Q = V/L_{\\max}^{3}$ 并将其分类为扁片。四面体的顶点为 $A=(1,0,0)$、$B=(0,1,0)$、$C=(1,1,10^{-3})$ 和 $D=(0,0,0)$。\n\n首先，我们计算四面体的体积 $V$。对于一个顶点在原点 $D$，其他顶点为 $A$、$B$ 和 $C$ 的四面体，其体积等于向量 $\\vec{DA}$、$\\vec{DB}$ 和 $\\vec{DC}$ 的标量三重积绝对值的六分之一。\n这些向量是：\n$\\vec{DA} = A - D = (1,0,0) - (0,0,0) = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$\\vec{DB} = B - D = (0,1,0) - (0,0,0) = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n$\\vec{DC} = C - D = (1,1,10^{-3}) - (0,0,0) = \\begin{pmatrix} 1 \\\\ 1 \\\\ 10^{-3} \\end{pmatrix}$\n\n标量三重积可以计算为以这些向量为列（或行）的矩阵的行列式。\n$$V = \\frac{1}{6} |(\\vec{DA} \\times \\vec{DB}) \\cdot \\vec{DC}| = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 0  0  10^{-3} \\end{pmatrix} \\right|$$\n沿第一列展开行列式：\n$$ \\det \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 0  0  10^{-3} \\end{pmatrix} = 1 \\cdot \\det \\begin{pmatrix} 1  1 \\\\ 0  10^{-3} \\end{pmatrix} - 0 + 0 = 1 \\cdot (1 \\cdot 10^{-3} - 1 \\cdot 0) = 10^{-3} $$\n因此，体积为：\n$$V = \\frac{1}{6} |10^{-3}| = \\frac{1}{6} \\times 10^{-3}$$\n\n接下来，我们找出四面体六条边中的最大边长 $L_{\\max}$。这些边是 $DA$、$DB$、$DC$、$AB$、$AC$ 和 $BC$。我们计算每条边长的平方以简化比较。\n对应于这些边的向量是：\n$\\vec{DA} = (1,0,0)$\n$\\vec{DB} = (0,1,0)$\n$\\vec{DC} = (1,1,10^{-3})$\n$\\vec{AB} = B - A = (0-1, 1-0, 0-0) = (-1,1,0)$\n$\\vec{AC} = C - A = (1-1, 1-0, 10^{-3}-0) = (0,1,10^{-3})$\n$\\vec{BC} = C - B = (1-0, 1-1, 10^{-3}-0) = (1,0,10^{-3})$\n\n边长的平方是这些向量的模的平方：\n$L_{DA}^2 = 1^2 + 0^2 + 0^2 = 1$\n$L_{DB}^2 = 0^2 + 1^2 + 0^2 = 1$\n$L_{DC}^2 = 1^2 + 1^2 + (10^{-3})^2 = 1 + 1 + 10^{-6} = 2 + 10^{-6}$\n$L_{AB}^2 = (-1)^2 + 1^2 + 0^2 = 1 + 1 = 2$\n$L_{AC}^2 = 0^2 + 1^2 + (10^{-3})^2 = 1 + 10^{-6}$\n$L_{BC}^2 = 1^2 + 0^2 + (10^{-3})^2 = 1 + 10^{-6}$\n\n比较这些平方长度：$1$、$1$、$2+10^{-6}$、$2$、$1+10^{-6}$、$1+10^{-6}$。最大平方长度是 $L_{\\max}^2 = 2 + 10^{-6}$。\n因此，最大边长为 $L_{\\max} = \\sqrt{2 + 10^{-6}}$。\n\n现在，我们计算归一化体积 $Q = V/L_{\\max}^{3}$：\n$$Q = \\frac{V}{L_{\\max}^3} = \\frac{\\frac{1}{6} \\times 10^{-3}}{(\\sqrt{2 + 10^{-6}})^3} = \\frac{10^{-3}}{6(2 + 10^{-6})^{3/2}}$$\n为了获得数值，我们计算该表达式：\n$$(2 + 10^{-6})^{3/2} = (2.000001)^{1.5} \\approx 2.82842924$$\n$$Q \\approx \\frac{10^{-3}}{6 \\times 2.82842924} = \\frac{10^{-3}}{16.97057544} \\approx 0.0589255 \\times 10^{-3}$$\n用科学记数法表示，这是 $5.89255 \\times 10^{-5}$。\n按要求四舍五入到四位有效数字，我们得到：\n$$Q \\approx 5.893 \\times 10^{-5}$$\n\n最后，我们对单元进行分类。规则是：如果 $Q  \\tau$，则分类为“扁片”（sliver），其中阈值为 $\\tau = 10^{-3}$。该分类由一个指示符 $I$ 编码，其中扁片对应 $I=1$，否则 $I=0$。\n我们将计算出的归一化体积 $Q$ 与阈值 $\\tau$ 进行比较：\n$$5.893 \\times 10^{-5}  10^{-3}$$\n该不等式成立，因为 $5.893 \\times 10^{-5} = 0.00005893$ 且 $10^{-3} = 0.001$。\n因此，该单元是扁片，指示符为 $I=1$。\n\n最终答案由四舍五入后的归一化体积和指示符 $I$ 组成，以一个二分量行矩阵 $\\begin{pmatrix} Q  I \\end{pmatrix}$ 的形式呈现。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 5.893 \\times 10^{-5}  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "最终，网格的目的是为了准确地求解物理问题。对于波动问题，一个关键的考量是网格如何影响波的传播特性。由于离散化引入的误差，数值模拟中的波速可能与真实物理波速不同，这种现象被称为“数值色散”。这个练习  将引导你对一维亥姆霍兹方程进行色散分析。你将推导出“有效波数” $k_{\\text{eff}}$，并揭示它如何依赖于网格尺寸 $h$ 而偏离真实的物理波数 $k$。这项基本分析是理解“污染误差”和指导网格设计中“每波长所需节点数”经验法则的理论基础。",
            "id": "4128596",
            "problem": "考虑由无限均匀直线上的标量亥姆霍兹方程所描述的一维时谐声学问题：\n$$\\frac{d^{2} u}{dx^{2}} + k^{2} u = 0,$$\n其中 $u(x)$ 是声压幅值，$k$ 是物理波数（单位：弧度/米）。使用连续分段线性基函数，在单元尺寸为 $h$ 的均匀网格上，通过标准伽辽金有限元法 (FEM) 对该问题进行离散化。假设使用一致（非集中）质量矩阵。设无限均匀网格上的节点自由度表示为 $\\{U_{j}\\}_{j \\in \\mathbb{Z}}$。\n\n从弱形式和线性形函数的单元刚度矩阵和质量矩阵的定义出发，组集全局离散系统，并引入布洛赫波（Bloch-wave）拟设 $U_{j} = \\exp\\!\\left(i j \\theta\\right)$，其中 $\\theta$ 为某个实相位。通过 $\\theta = k_{\\text{eff}} h$ 定义有效（数值）波数 $k_{\\text{eff}}$。推导连接 $k$ 和 $k_{\\text{eff}}$ 的离散色散关系，然后求出 $k_{\\text{eff}}$ 关于无量纲网格分辨率参数 $kh$ 的幂次级数展开式，展开到并包含 $O\\!\\left((kh)^{3}\\right)$ 阶项。\n\n将 $k_{\\text{eff}}$（单位：弧度/米）的最终结果表示为关于 $k$ 和 $h$ 的解析表达式。无需四舍五入。",
            "solution": "用户希望求出一维亥姆霍兹方程在有限元法 (FEM) 离散化中数值波数的级数展开式。\n\n### 步骤 1：问题陈述的验证\n\n**1. 提取已知条件：**\n- **控制方程：** 一维时谐声学由无限均匀直线上的标量亥姆霍兹方程描述：\n$$ \\frac{d^{2} u}{dx^{2}} + k^{2} u = 0 $$\n- **变量和常数：**\n  - $u(x)$：声压幅值。\n  - $k$：物理波数，单位为弧度/米。\n  - $h$：网格的均匀单元尺寸。\n- **方法论：**\n  - 离散化：标准伽辽金有限元法 (FEM)。\n  - 基函数：连续分段线性。\n  - 质量矩阵：一致（非集中）。\n  - 节点自由度：无限均匀网格上的 $\\{U_{j}\\}_{j \\in \\mathbb{Z}}$。\n- **拟设和定义：**\n  - 布洛赫波拟设：$U_{j} = \\exp(i j \\theta)$，其中 $\\theta$ 为某个实相位。\n  - 有效（数值）波数 $k_{\\text{eff}}$ 由 $\\theta = k_{\\text{eff}} h$ 定义。\n- **目标：**\n  - 推导连接 $k$ 和 $k_{\\text{eff}}$ 的离散色散关系。\n  - 求出 $k_{\\text{eff}}$ 关于无量纲参数 $kh$ 的幂次级数展开式，展开到并包含 $O((kh)^{3})$ 阶项。\n  - 将 $k_{\\text{eff}}$ 的最终结果表示为关于 $k$ 和 $h$ 的解析表达式。\n\n**2. 验证分析：**\n- **科学依据：** 该问题牢固地植根于计算声学和偏微分方程数值分析的基本原理。亥姆霍兹方程是时谐波传播的标准模型。伽辽金有限元法是现代计算科学的基石。使用布洛赫波（或冯·诺依曼）拟设进行数值色散分析是评估数值格式准确性的标准且关键的技术。该问题在科学上是合理的，并构成一个经典的教科书练习题。\n- **适定性：** 问题陈述清晰，包含了推导唯一解所需的所有信息。各项说明（线性基函数、一致质量矩阵）是精确的。目标是明确的。\n- **客观性：** 语言是形式化的、数学的，不含任何主观或推测性内容。\n\n**3. 结论和行动：**\n该问题在科学上是合理的、适定的和客观的。它没有违反任何无效性标准。因此，该问题是**有效的**。我们着手推导解答。\n\n### 步骤 2：解答的推导\n\n**A. 弱形式和有限元法离散化**\n亥姆霍兹方程为 $u'' + k^2 u = 0$。通过乘以一个检验函数 $v$ 并在定义域 $\\mathbb{R}$ 上积分来得到弱形式。\n$$ \\int_{-\\infty}^{\\infty} (u'' v + k^2 u v) \\, dx = 0 $$\n对第一项进行分部积分，我们得到：\n$$ \\left[u' v\\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} u' v' \\, dx + k^2 \\int_{-\\infty}^{\\infty} u v \\, dx = 0 $$\n假设场在无穷远处消失，则边界项为零。弱形式为：找到 $u$，使得对于所有合适的检验函数 $v$，\n$$ \\int_{-\\infty}^{\\infty} (u' v' - k^2 u v) \\, dx = 0 $$\n在伽辽金有限元法中，我们将解 $u(x)$ 近似为基函数 $N_j(x)$ 的线性组合：$u_h(x) = \\sum_{j \\in \\mathbb{Z}} U_j N_j(x)$。检验函数选自同一组基函数，即 $v = N_i(x)$。这导出一个代数方程组 $(S - k^2 M) \\mathbf{U} = \\mathbf{0}$。其中 $S$ 是刚度矩阵，$M$ 是质量矩阵。\n\n**B. 线性基函数的单元矩阵**\n对于长度为 $h$ 的一个通用单元，线性形函数的单元刚度矩阵 $S^e$ 和一致质量矩阵 $M^e$ 由下式给出：\n$$ S^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad M^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n**C. 全局系统方程的组集**\n我们为通用节点 $j$ 组集离散方程。第 $j$ 个自由度 $U_j$ 的方程涉及到单元 $[x_{j-1}, x_j]$ 和 $[x_j, x_{j+1}]$ 的贡献。得到的计算模板连接了节点 $j-1$、$j$ 和 $j+1$。\n第 $j$ 行的离散方程为：\n$$ (S_{j,j-1} - k^2 M_{j,j-1})U_{j-1} + (S_{jj} - k^2 M_{jj})U_j + (S_{j,j+1} - k^2 M_{j,j+1})U_{j+1} = 0 $$\n组集后的矩阵项为：\n- $S_{j,j-1} = -\\frac{1}{h}$, $S_{jj} = \\frac{2}{h}$, $S_{j,j+1} = -\\frac{1}{h}$.\n- $M_{j,j-1} = \\frac{h}{6}$, $M_{jj} = \\frac{2h}{3}$, $M_{j,j+1} = \\frac{h}{6}$.\n\n将这些代入节点 $j$ 的方程中：\n$$ \\left(-\\frac{1}{h} - k^2 \\frac{h}{6}\\right)U_{j-1} + \\left(\\frac{2}{h} - k^2 \\frac{2h}{3}\\right)U_j + \\left(-\\frac{1}{h} - k^2 \\frac{h}{6}\\right)U_{j+1} = 0 $$\n整理各项得到计算模板：\n$$ -\\frac{1}{h}(U_{j-1} - 2U_j + U_{j+1}) - k^2 \\frac{h}{6}(U_{j-1} + 4U_j + U_{j+1}) = 0 $$\n\n**D. 离散色散关系**\n我们引入布洛赫波拟设 $U_j = \\exp(ij\\theta)$，其中 $\\theta = k_{\\text{eff}}h$。这得到 $U_{j\\pm 1} = \\exp(\\pm i\\theta) U_j$。将此代入离散方程并除以 $U_j \\neq 0$：\n$$ -\\frac{1}{h}(\\exp(-i\\theta) - 2 + \\exp(i\\theta)) - k^2 \\frac{h}{6}(\\exp(-i\\theta) + 4 + \\exp(i\\theta)) = 0 $$\n使用恒等式 $2\\cos(\\theta) = \\exp(i\\theta) + \\exp(-i\\theta)$，表达式变为：\n$$ -\\frac{1}{h}(2\\cos(\\theta) - 2) - k^2 \\frac{h}{6}(2\\cos(\\theta) + 4) = 0 $$\n$$ \\frac{2}{h}(1 - \\cos(\\theta)) - k^2 \\frac{h}{3}(\\cos(\\theta) + 2) = 0 $$\n解出 $k^2$ 得到离散色散关系：\n$$ k^2 = \\frac{6}{h^2} \\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)} $$\n\n**E. 数值波数的级数展开**\n我们需要求出以 $k$ 表示的 $k_{\\text{eff}}$。为此，我们对小 $\\theta$ 情况下的色散关系进行展开，这对应于一个良好解析的波（$kh \\ll 1$）。我们使用 $\\cos(\\theta)$ 在 $\\theta=0$ 附近的泰勒级数：\n$$ \\cos(\\theta) = 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - O(\\theta^6) $$\n将此代入色散关系：\n$$ k^2 = \\frac{6}{h^2} \\frac{1 - \\left(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\\right)}{2 + \\left(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\\right)} $$\n$$ k^2 = \\frac{6}{h^2} \\frac{\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + O(\\theta^6)}{3 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} + O(\\theta^6)} $$\n两边乘以 $h^2$ 并从分母中提出因子 3：\n$$ (kh)^2 = 2 \\frac{\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + O(\\theta^6)}{1 - \\frac{\\theta^2}{6} + \\frac{\\theta^4}{72} + O(\\theta^6)} $$\n$$ (kh)^2 = \\left(\\theta^2 - \\frac{\\theta^4}{12} + O(\\theta^6)\\right) \\left(1 - \\frac{\\theta^2}{6} + \\frac{\\theta^4}{72} + O(\\theta^6)\\right)^{-1} $$\n使用几何级数展开 $(1-x)^{-1} = 1 + x + x^2 + \\dots$：\n$$ (kh)^2 = \\left(\\theta^2 - \\frac{\\theta^4}{12} + O(\\theta^6)\\right) \\left(1 + \\left(\\frac{\\theta^2}{6} - \\frac{\\theta^4}{72}\\right) + \\left(\\frac{\\theta^2}{6}\\right)^2 + O(\\theta^6)\\right) $$\n$$ (kh)^2 = \\left(\\theta^2 - \\frac{\\theta^4}{12} + O(\\theta^6)\\right) \\left(1 + \\frac{\\theta^2}{6} + \\frac{\\theta^4}{72} + \\dots \\right) $$\n将级数相乘并收集到 $\\theta^4$ 阶的项：\n$$ (kh)^2 = \\theta^2 + \\frac{\\theta^4}{6} - \\frac{\\theta^4}{12} + O(\\theta^6) = \\theta^2 + \\frac{\\theta^4}{12} + O(\\theta^6) $$\n现在我们需要反演这个级数，以 $kh$ 的形式表示 $\\theta$。由于色散关系的对称性，我们假设 $\\theta(kh)$ 是一个奇次幂级数，$\\theta(kh) = c_1(kh) + c_3(kh)^3 + O((kh)^5)$。\n$$ \\theta^2 = c_1^2(kh)^2 + 2c_1c_3(kh)^4 + O((kh)^6) $$\n$$ \\theta^4 = c_1^4(kh)^4 + O((kh)^6) $$\n将这些代入关系式 $(kh)^2 = \\theta^2 + \\frac{1}{12}\\theta^4 + O(\\theta^6)$：\n$$ (kh)^2 = \\left(c_1^2(kh)^2 + 2c_1c_3(kh)^4\\right) + \\frac{1}{12}c_1^4(kh)^4 + O((kh)^6) $$\n通过比较 $kh$ 各次幂的系数：\n- 对于 $(kh)^2$：$1 = c_1^2 \\implies c_1 = 1$（取物理上有意义的根，即当 $kh$ 很小时，$\\theta \\approx kh$）。\n- 对于 $(kh)^4$：$0 = 2c_1c_3 + \\frac{1}{12}c_1^4$。当 $c_1=1$ 时，这得到 $0 = 2c_3 + \\frac{1}{12}$，这意味着 $c_3 = -\\frac{1}{24}$。\n\n因此，$\\theta$ 的级数是：\n$$ \\theta = kh - \\frac{1}{24}(kh)^3 + O((kh)^5) $$\n使用定义 $\\theta = k_{\\text{eff}}h$：\n$$ k_{\\text{eff}}h = kh - \\frac{k^3h^3}{24} + O(k^5h^5) $$\n两边除以 $h$ 得到数值波数 $k_{\\text{eff}}$ 的表达式：\n$$ k_{\\text{eff}} = k - \\frac{k^3h^2}{24} + O(k^5h^4) $$\n$k_{\\text{eff}}$ 关于 $kh$ 幂次的展开式为 $k_{\\text{eff}} = k \\left(1 - \\frac{1}{24}(kh)^2 + O((kh)^4)\\right)$。问题要求展开到并包含 $O((kh)^3)$ 阶项。由于对称性，$(kh)^1$ 和 $(kh)^3$ 项的系数为零，因此所要求的展开式是在 $(kh)^2$ 项后截断的那个。\n\n最终表达式为：\n$$ k_{\\text{eff}} = k - \\frac{k^3 h^2}{24} $$\n此结果表明，对于使用线性单元和一致质量矩阵的伽辽金有限元法，由于 $k_{\\text{eff}}  k$，数值相速度小于物理相速度（相位滞后）。",
            "answer": "$$ \\boxed{k - \\frac{k^{3}h^{2}}{24}} $$"
        }
    ]
}