{
    "hands_on_practices": [
        {
            "introduction": "我们从CFL条件的一个基本应用开始。这个练习将一个振动弦的物理特性与数值模拟的参数联系起来，这是一个在数字音频和乐器建模中常见的场景。通过计算Courant数，你将练习建立稳定显式时域模拟所必需的关键第一步 。",
            "id": "2164724",
            "problem": "一个音频软件工程师团队正在设计一个数字波导模型，以合成被拨动琴弦的声音。琴弦的物理行为由其张力 $T$ 和线密度 $\\mu$ 来表征。这些属性共同决定了横波沿琴弦传播的速度 $c$。\n\n在数值模拟中，琴弦被建模为一个空间步长为 $\\Delta x$ 的一维网格。模拟的状态以大小为 $\\Delta t$ 的离散时间步长进行更新，其中 $\\Delta t$ 是音频采样频率 $f_s$ 的倒数。这类模拟的数值稳定性通常使用 Courant-Friedrichs-Lewy (CFL) 条件进行分析，该条件涉及一个称为 Courant 数的无量纲参数。\n\n给定琴弦的物理参数和模拟设置如下：\n- 琴弦张力， $T = 80.0$ N\n- 线密度， $\\mu = 5.00 \\times 10^{-4}$ kg/m\n- 空间步长， $\\Delta x = 1.00$ cm\n- 音频采样频率， $f_s = 48.0$ kHz\n\n计算此模拟的 Courant 数。将您的最终答案四舍五入到三位有效数字。",
            "solution": "对于张紧弦上的横波，波速由物理关系 $c = \\sqrt{\\frac{T}{\\mu}}$ 给出。一维波动模拟的 Courant 数由 CFL 条件定义为\n$$\n\\lambda = \\frac{c\\,\\Delta t}{\\Delta x}.\n$$\n时间步长是采样频率的倒数，即 $\\Delta t = \\frac{1}{f_{s}}$，给定的空间步长为 $\\Delta x = 1.00\\ \\text{cm} = 0.0100\\ \\text{m}$，且 $f_{s} = 48.0 \\times 10^{3}\\ \\text{Hz}$。\n\n首先，根据给定的琴弦参数 $T = 80.0\\ \\text{N}$ 和 $\\mu = 5.00 \\times 10^{-4}\\ \\text{kg/m}$ 计算波速：\n$$\nc = \\sqrt{\\frac{T}{\\mu}} = \\sqrt{\\frac{80.0}{5.00 \\times 10^{-4}}} = \\sqrt{1.60 \\times 10^{5}} = 400\\ \\text{m/s}.\n$$\n接下来计算 Courant 数：\n$$\n\\lambda = \\frac{c\\,\\Delta t}{\\Delta x} = \\frac{c}{f_{s}\\,\\Delta x} = \\frac{400}{\\left(48.0 \\times 10^{3}\\right)\\left(0.0100\\right)} = \\frac{400}{480} = \\frac{5}{6} \\approx 0.833333\\ldots\n$$\n四舍五入到三位有效数字，Courant 数为 $0.833$。",
            "answer": "$$\\boxed{0.833}$$"
        },
        {
            "introduction": "现实世界中的声学环境很少具有均匀的介质属性。这个问题将分析提升到处理空间变化的声速，这是计算声学中的一个常见情景。它挑战你超越常系数情况来确定全局稳定性约束，并阐明最极端的局部条件（即最大波速）如何决定整个模拟的稳定性 。",
            "id": "4140096",
            "problem": "考虑具有空间变化的声速的一维线性声波方程，$$p_{tt}(x,t) = c(x)^2\\,p_{xx}(x,t),$$ 其中 $p(x,t)$ 是声压，$c(x)$ 是满足 $0  c_{\\min} \\le c(x) \\le c_{\\max}  \\infty$ 的局部声速。设计算域被离散化为均匀网格 $x_j = j\\,\\Delta x$（其中 $j$ 为整数），并使用均匀时间步长 $\\Delta t$ 进行时间推进。通过在时间和空间上使用中心差分近似，可以得到该问题的一个标准的显式二阶精度有限差分格式：\n$$p_j^{n+1} = 2\\,p_j^n - p_j^{n-1} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2}\\left(p_{j+1}^n - 2\\,p_j^n + p_{j-1}^n\\right),$$\n其中 $p_j^n$ 是 $p(x_j, n\\,\\Delta t)$ 的近似值，$c_j = c(x_j)$。假设采用周期性边界条件和线性分析。从控制偏微分方程、上述离散格式以及局部冻结系数傅里叶分析出发，使用基于原理的论证，确定对于空间变化的 $c_j$，哪个关于 $\\Delta t$ 的全局时间步长限制足以确保与 Courant-Friedrichs-Lewy (CFL) 条件一致的线性稳定性。\n\n从以下选项中选择正确的陈述：\n\nA. $\\Delta t \\le \\min_j \\dfrac{\\Delta x}{c_j}$\n\nB. $\\Delta t \\le \\dfrac{\\Delta x}{\\frac{1}{N}\\sum_{j=0}^{N-1} c_j}$\n\nC. $\\Delta t \\le \\max_j \\dfrac{\\Delta x}{c_j}$\n\nD. 当 $c_j$ 变化时，没有单一的全局 $\\Delta t$ 能确保稳定性；必须选择局部时间步长 $\\Delta t_j$ 以使得对每个 $j$ 都有 $\\dfrac{c_j\\,\\Delta t_j}{\\Delta x} \\le 1$\n\nE. 该格式在一维空间中是无条件稳定的，因此对 $\\Delta t$ 没有限制要求",
            "solution": "### 问题验证\n\n**第1步：提取已知条件**\n- 控制偏微分方程 (PDE)：$p_{tt}(x,t) = c(x)^2\\,p_{xx}(x,t)$\n- 变量和常数：$p(x,t)$ 是声压，$c(x)$ 是满足 $0  c_{\\min} \\le c(x) \\le c_{\\max}  \\infty$ 的局部声速。\n- 离散化：均匀网格 $x_j = j\\,\\Delta x$，均匀时间步长 $\\Delta t$。\n- 有限差分格式：$p_j^{n+1} = 2\\,p_j^n - p_j^{n-1} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2}\\left(p_{j+1}^n - 2\\,p_j^n + p_{j-1}^n\\right)$。\n- 记号：$p_j^n$ 是 $p(x_j, n\\,\\Delta t)$ 的近似值，$c_j = c(x_j)$。\n- 边界条件：周期性。\n- 要求的分析方法：“局部冻结系数傅里叶分析”。\n- 目标：确定足以确保线性稳定性的关于 $\\Delta t$ 的全局时间步长限制。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题探讨了线性声波方程标准数值方法的稳定性，这是计算物理和工程领域的一个基本课题。所要求的分析方法，即局部冻结系数傅里叶分析，是解决此类问题的标准技术。整个设置完全符合既定的科学和数学原理。\n- **适定性**：问题陈述清晰，提供了控制方程、数值格式和具体的分析方法。它要求一个唯一的、可推导的条件。所有必要信息都已给出。\n- **客观性**：问题使用精确、明确的数学和技术语言进行表述。它不包含任何主观或基于观点的陈述。\n\n**第3步：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。这是一个有效的数值分析问题。我将继续推导解答。\n\n### 解题推导\n\n该问题要求对给定具有空间变化系数 $c(x)$ 的波动方程的有限差分格式进行稳定性分析。指定的方法是局部冻结系数傅里叶分析，也称为带有冻结系数的冯·诺伊曼稳定性分析 (von Neumann stability analysis)。该方法通过在每个空间点 $x_j$ 分析格式来评估稳定性，就好像系数 $c_j=c(x_j)$ 在该点邻域内是常数一样。\n\n在给定的网格点 $x_j$，我们冻结系数 $c_j$ 并分析该格式：\n$$p_k^{n+1} = 2\\,p_k^n - p_k^{n-1} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2}\\left(p_{k+1}^n - 2\\,p_k^n + p_{k-1}^n\\right)$$\n这里，$k$ 是傅里叶分析中的空间索引，$c_j$ 是此局部分析中的固定常数。我们寻求单一傅里叶模式形式的解，$p_k^n = g^n e^{i \\kappa k \\Delta x}$，其中 $g$ 是每个时间步的放大因子，$\\kappa$ 是波数，$i = \\sqrt{-1}$。为了使格式稳定，对于任何波数，放大因子的模都不能超过1，即 $|g| \\le 1$。\n\n将傅里叶模式代入差分方程：\n$$g^{n+1} e^{i \\kappa k \\Delta x} = 2\\,g^n e^{i \\kappa k \\Delta x} - g^{n-1} e^{i \\kappa k \\Delta x} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\left[ g^n e^{i \\kappa (k+1) \\Delta x} - 2\\,g^n e^{i \\kappa k \\Delta x} + g^n e^{i \\kappa (k-1) \\Delta x} \\right]$$\n两边同除以 $g^{n-1} e^{i \\kappa k \\Delta x}$（假设 $g \\neq 0$ 且 $e^{i \\kappa k \\Delta x} \\neq 0$），得到关于 $g$ 的二次方程：\n$$g^2 = 2g - 1 + g \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\left( e^{i \\kappa \\Delta x} - 2 + e^{-i \\kappa \\Delta x} \\right)$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$，括号中的项变为 $2\\cos(\\kappa\\Delta x) - 2$。这可以利用半角恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$ 进一步简化，得到 $2\\cos(\\kappa\\Delta x) - 2 = -4\\sin^2(\\frac{\\kappa\\Delta x}{2})$。\n\n将其代回，我们得到：\n$$g^2 = 2g - 1 - g \\left( 4 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\right)$$\n整理成标准二次方程形式 $Ag^2 + Bg + C = 0$：\n$$g^2 - \\left[ 2 - 4 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\right] g + 1 = 0$$\n这个方程的形式是 $g^2 - 2\\beta g + 1 = 0$，其根为 $g = \\beta \\pm \\sqrt{\\beta^2 - 1}$，且 $\\beta = 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2})$。为保证稳定性，我们需要 $|g| \\le 1$。如果 $\\beta^2  1$，根是实数且它们的乘积为 $1$，因此必有一根的模大于 $1$，导致不稳定。如果 $\\beta^2 \\le 1$，根是共轭复数，其模为 $|g| = \\sqrt{\\beta^2 + (1-\\beta^2)} = 1$。因此，稳定性条件是 $|\\beta| \\le 1$，即 $-1 \\le \\beta \\le 1$。\n\n我们必须满足：\n$$-1 \\le 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 1$$\n右侧不等式，$1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2}) \\le 1$，简化为 $-2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2}) \\le 0$，由于所有项都是非负的，这个不等式恒成立。\n左侧不等式给出了实际的限制条件：\n$$-1 \\le 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right)$$\n$$2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 2$$\n$$\\frac{c_j^2 \\Delta t^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 1$$\n这个不等式必须对所有波数 $\\kappa$ 成立。最严格的情况（“最坏情况”）发生在 $\\sin^2(\\frac{\\kappa\\Delta x}{2})$ 项取最大值时。其最大值为 $1$，这发生在网格能解析的最高频率模式，即 $\\kappa\\Delta x = \\pi$ 时。\n因此，条件变为：\n$$\\frac{c_j \\Delta t}{\\Delta x} \\le 1$$\n这就是局部点 $x_j$ 的 Courant-Friedrichs-Lewy (CFL) 条件，可以写成对局部时间步长的限制：$\\Delta t \\le \\frac{\\Delta x}{c_j}$。\n\n为了使整个格式在使用单一的全局时间步长 $\\Delta t$ 时保持稳定，这个时间步长必须足够小，以满足域内每个网格点 $j$ 的局部稳定性条件。\n因此，$\\Delta t$ 必须小于或等于所有局部最大时间步长中的最小值：\n$$\\Delta t \\le \\min_{j} \\left( \\frac{\\Delta x}{c_j} \\right)$$\n由于 $\\Delta x$ 是一个正常数，最小化分数 $\\frac{\\Delta x}{c_j}$ 等价于最大化分母 $c_j$。这意味着全局时间步长受到域内最大波速的限制：\n$$\\Delta t \\le \\frac{\\Delta x}{\\max_{j}(c_j)}$$\n表达式 $\\min_j \\left( \\frac{\\Delta x}{c_j} \\right)$ 正是确保这一点的陈述。\n\n### 逐项分析\n\n**A. $\\Delta t \\le \\min_j \\dfrac{\\Delta x}{c_j}$**\n如上所推导，这是在使用单一全局时间步长 $\\Delta t$ 时确保整个计算域稳定性的正确条件。它确保即使在具有最高声速 $c_j$ 的区域（这是最严格的情况），CFL 条件也能得到满足。\n结论：**正确**。\n\n**B. $\\Delta t \\le \\dfrac{\\Delta x}{\\frac{1}{N}\\sum_{j=0}^{N-1} c_j}$**\n该条件使用了声速的算术平均值。这是不正确的。如果域中包含一个声速非常高的小区域（例如，$c_j \\gg \\text{avg}(c)$），则平均速度将远低于局部最大值。基于平均速度的时间步长对于高速区域来说会过大，从而在该处违反局部CFL条件，导致数值不稳定。\n结论：**不正确**。\n\n**C. $\\Delta t \\le \\max_j \\dfrac{\\Delta x}{c_j}$**\n该表达式等价于 $\\Delta t \\le \\dfrac{\\Delta x}{\\min_j c_j}$，因为最大化 $\\frac{\\Delta x}{c_j}$ 等价于最小化 $c_j$。该条件将时间步长基于*最小*声速。这样的时间步长对于声速大于最小值的区域来说会过大，导致严重违反CFL条件并立即产生不稳定性。\n结论：**不正确**。\n\n**D. 当 $c_j$ 变化时，没有单一的全局 $\\Delta t$ 能确保稳定性；必须选择局部时间步长 $\\Delta t_j$ 以使得对每个 $j$ 都有 $\\dfrac{c_j\\,\\Delta t_j}{\\Delta x} \\le 1$**\n这个说法是错误的。虽然局部时间步进对此类问题是一种有效且通常更高效的数值策略，但它并非稳定性的必要条件。根据最严格的局部条件（即基于 $c_{\\max}$）选择一个单一的全局时间步长，完全足以保证整个域的稳定性，正如选项A的推导所示。\n结论：**不正确**。\n\n**E. 该格式在一维空间中是无条件稳定的，因此对 $\\Delta t$ 没有限制要求**\n这是错误的。冯·诺伊曼分析明确推导出了一个依赖于 $\\Delta t$、$\\Delta x$ 和 $c_j$ 的稳定性条件。对于双曲型偏微分方程，像本题给出的这种显式有限差分格式几乎总是条件稳定的。无条件稳定性通常是与隐式格式相关的属性。\n结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "CFL条件的形式不仅取决于物理方程，还取决于所使用的数值方法。这个高级练习探讨了高精度谱方法与强稳定性保持龙格-库塔（SSP-RK3）时间积分器相结合时的稳定性。它展示了稳定性分析如何适应不同的离散化技术，将时间步长限制与傅里叶模态的数量而非简单的网格间距联系起来 。",
            "id": "2164725",
            "problem": "考虑一维线性平流方程 $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0$，该方程定义在空间域 $x \\in [0, 2\\pi]$ 上，并具有周期性边界条件。在此方程中，$u(x,t)$ 是一个标量场，$c$ 是一个代表波速的非零实值常数。\n\n这个偏微分方程将通过数值方法求解。空间离散化采用傅里叶配置谱方法，使用 $N$ 个等距点，其中 $N$ 是一个偶数。这种空间离散化的一个关键特性是，所得到的微分矩阵的特征值是纯虚数，并且该离散化能精确表示波数 $k$ 为整数、最大幅值 $|k|_{max} = N/2$ 的傅里叶模态 $e^{ikx}$。\n\n对于半离散系统的时间积分，该系统形式为自治常微分方程组 $\\frac{d\\mathbf{u}}{dt} = \\mathbf{F}(\\mathbf{u})$，我们采用三阶段三阶强保稳龙格-库塔 (SSP-RK3) 方法。该方法从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的单个时间步的公式如下：\n$$ \\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t \\mathbf{F}(\\mathbf{u}^n) $$\n$$ \\mathbf{u}^{(2)} = \\frac{3}{4} \\mathbf{u}^n + \\frac{1}{4} \\left( \\mathbf{u}^{(1)} + \\Delta t \\mathbf{F}(\\mathbf{u}^{(1)}) \\right) $$\n$$ \\mathbf{u}^{n+1} = \\frac{1}{3} \\mathbf{u}^n + \\frac{2}{3} \\left( \\mathbf{u}^{(2)} + \\Delta t \\mathbf{F}(\\mathbf{u}^{(2)}) \\right) $$\n\n该数值格式的稳定性受到 Courant-Friedrichs-Lewy (CFL) 条件的限制，该条件对时间步长 $\\Delta t$ 施加了一个上界。推导最大可能时间步长 $\\Delta t_{max}$ 的表达式，以确保该方法对所有可分辨的傅里叶模态都是稳定的。最终答案应以波速的幅值 $|c|$ 和配置点数 $N$ 来表示。",
            "solution": "对于具有周期性边界条件的一维线性平流方程 $u_{t} + c u_{x} = 0$，在 $[0,2\\pi]$ 上使用 $N$ 个等距点通过傅里叶配置进行空间离散化后，得到一个半离散 ODE 系统\n$$\n\\frac{d\\mathbf{u}}{dt} = \\mathbf{F}(\\mathbf{u}) = -c D \\mathbf{u},\n$$\n其中 $D$ 是谱一阶导数矩阵。由于傅里叶配置方法能精确表示波数 $k$ 为整数且 $|k| \\leq N/2$ 的傅里叶模态 $e^{ikx}$，因此每个模态都是 $D$ 的一个特征向量，其特征值为 $ik$。因此，半离散算子的特征值为\n$$\n\\lambda_{k} = -i c k,\\quad |k| \\leq \\frac{N}{2}.\n$$\n对于应用到线性测试方程 $y'=\\lambda y$ 的三阶段三阶 SSP-RK3 方法的时间积分，单个时间步满足\n$$\ny^{n+1} = R(z)\\,y^{n},\\quad z = \\lambda \\Delta t,\n$$\n其中该 SSP-RK3 格式的稳定性函数 $R(z)$ 为\n$$\nR(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6}.\n$$\n对于当前的半离散系统，$z = \\lambda_{k} \\Delta t = -i c k \\Delta t$。令 $y = c k \\Delta t$ 并写作 $z = i(-y)$；由于稳定性取决于沿虚轴的 $|z|$，我们只需考虑 $z = i y$，其中 $y$ 为实数。那么\n$$\nR(i y) = 1 + i y - \\frac{y^{2}}{2} - i \\frac{y^{3}}{6},\n$$\n所以\n$$\n|R(i y)|^{2} = \\left(1 - \\frac{y^{2}}{2}\\right)^{2} + \\left(y - \\frac{y^{3}}{6}\\right)^{2}\n= 1 - \\frac{y^{4}}{12} + \\frac{y^{6}}{36}.\n$$\n虚轴上的稳定性边界由 $|R(i y)|^{2} = 1$ 得到，这给出\n$$\n-\\frac{y^{4}}{12} + \\frac{y^{6}}{36} = 0\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{y^{4}}{36}\\left(y^{2} - 3\\right) = 0\n\\;\\;\\Longleftrightarrow\\;\\;\ny^{2} = 3.\n$$\n因此，该方法在 $|y| \\leq \\sqrt{3}$ 时是稳定的，即\n$$\n|c|\\,|k|\\,\\Delta t \\leq \\sqrt{3}.\n$$\n为确保对所有可分辨傅里叶模态的稳定性，将此条件施加于最大可分辨波数幅值 $|k|_{\\max} = N/2$，可得\n$$\n\\Delta t_{\\max} = \\frac{\\sqrt{3}}{|c|\\,|k|_{\\max}} = \\frac{\\sqrt{3}}{|c|\\,(N/2)} = \\frac{2\\sqrt{3}}{|c|\\,N}.\n$$",
            "answer": "$$\\boxed{\\frac{2\\sqrt{3}}{|c|\\,N}}$$"
        }
    ]
}