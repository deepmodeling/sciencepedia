{
    "hands_on_practices": [
        {
            "introduction": "要应用柯朗-弗里德里希斯-列维（CFL）条件，第一步是学会如何计算柯朗数本身。这个练习提供了一个来自数字音频合成领域的具体例子，展示了抽象的数值概念如何在创造逼真声音方面找到实际应用。通过这个练习 ，您将把一个物理系统（一根乐器弦）的属性与数值模拟的参数联系起来，从而计算出这个无量纲数。",
            "id": "2164724",
            "problem": "一个音频软件工程师团队正在设计一个数字波导模型来合成拨动琴弦的声音。琴弦的物理行为由其张力 $T$ 和线性质量密度 $\\mu$ 来表征。这些属性共同决定了横波沿琴弦传播的速度 $c$。\n\n在数值模拟中，琴弦被建模为一个空间步长为 $\\Delta x$ 的一维网格。模拟的状态以大小为 $\\Delta t$ 的离散时间步进行更新，其中 $\\Delta t$ 是音频采样频率 $f_s$ 的倒数。此类模拟的数值稳定性通常使用 Courant-Friedrichs-Lewy (CFL) 条件进行分析，该条件涉及一个称为库朗数的无量纲参数。\n\n给定物理琴弦和模拟设置的以下参数：\n- 琴弦张力, $T = 80.0$ N\n- 线性质量密度, $\\mu = 5.00 \\times 10^{-4}$ kg/m\n- 空间步长, $\\Delta x = 1.00$ cm\n- 音频采样频率, $f_s = 48.0$ kHz\n\n计算此模拟的库朗数。将您的最终答案四舍五入到三位有效数字。",
            "solution": "对于拉伸弦上的横波，波速由物理关系式 $c = \\sqrt{\\frac{T}{\\mu}}$ 给出。一维波模拟的库朗数由 CFL 条件定义为\n$$\n\\lambda = \\frac{c\\,\\Delta t}{\\Delta x}.\n$$\n时间步长是采样频率的倒数，$\\Delta t = \\frac{1}{f_{s}}$，给定的空间步长为 $\\Delta x = 1.00\\ \\text{cm} = 0.0100\\ \\text{m}$，且 $f_{s} = 48.0 \\times 10^{3}\\ \\text{Hz}$。\n\n首先根据给定的琴弦参数 $T = 80.0\\ \\text{N}$ 和 $\\mu = 5.00 \\times 10^{-4}\\ \\text{kg/m}$ 计算波速：\n$$\nc = \\sqrt{\\frac{T}{\\mu}} = \\sqrt{\\frac{80.0}{5.00 \\times 10^{-4}}} = \\sqrt{1.60 \\times 10^{5}} = 400\\ \\text{m/s}.\n$$\n接下来计算库朗数：\n$$\n\\lambda = \\frac{c\\,\\Delta t}{\\Delta x} = \\frac{c}{f_{s}\\,\\Delta x} = \\frac{400}{\\left(48.0 \\times 10^{3}\\right)\\left(0.0100\\right)} = \\frac{400}{480} = \\frac{5}{6} \\approx 0.833333\\ldots\n$$\n四舍五入到三位有效数字，库朗数为 $0.833$。",
            "answer": "$$\\boxed{0.833}$$"
        },
        {
            "introduction": "在计算出柯朗数之后，下一步是利用它来指导我们的模拟。CFL条件的真正威力在于它能帮助我们选择合适的参数以确保稳定性。这个问题  演示了其最直接的应用：确定最大允许时间步长 $ \\Delta t $，以防止模拟结果无限增大而变得无意义。这个场景设定为一位计算物理学家正在调试一个不稳定的模拟，这在实际工作中非常常见。",
            "id": "2164733",
            "problem": "一位计算物理学家正在开发一个模拟拉紧弦上波传播的程序。其物理行为由一维波动方程 $\\frac{\\partial^2 u}{\\partial t^2} = v^2 \\frac{\\partial^2 u}{\\partial x^2}$ 决定，其中 $u$ 是弦的横向位移，$v$ 是波的传播速度，$t$ 是时间，`x` 是沿弦的位置。\n\n该物理学家使用显式有限差分法来数值求解这个方程。对于这类数值格式，其稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定。该条件指出，定义为 $C = \\frac{v \\Delta t}{\\Delta x}$ 的无量纲 Courant 数不能超过一个临界值。对于所使用的特定格式，稳定性条件是 $C \\le 1$。这里，$\\Delta t$ 是时间步长，$\\Delta x$ 是空间网格间距。\n\n在模拟设置中，波速为 $v = 350 \\text{ m/s}$，弦以 $\\Delta x = 7.0 \\text{ mm}$ 的空间步长进行离散化。该物理学家初次尝试使用 $\\Delta t = 25$ 微秒的时间步长，导致了一个数值不稳定的解，其中波的振幅无界增长。\n\n为了修正这个问题，请计算在保证模拟数值稳定性的前提下，可以使用的最大时间步长 $\\Delta t_{max}$。请用微秒 ($\\mu$s) 表示你的答案。",
            "solution": "一维波动方程的显式有限差分格式中，Courant 数 $C$ 定义为\n$$\nC = \\frac{v\\,\\Delta t}{\\Delta x}.\n$$\n稳定性要求 $C \\leq 1$，因此最大稳定时间步长满足\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{v}.\n$$\n给定 $\\Delta x = 7.0 \\text{ mm} = 7.0 \\times 10^{-3} \\text{ m}$ 和 $v = 350 \\text{ m/s}$，计算\n$$\n\\Delta t_{\\max} = \\frac{7.0 \\times 10^{-3}}{350}\\ \\text{s} = \\frac{7.0}{350} \\times 10^{-3}\\ \\text{s} = \\frac{1}{50} \\times 10^{-3}\\ \\text{s} = 2 \\times 10^{-5}\\ \\text{s}.\n$$\n为了用微秒表示，注意到 $1 \\text{ s} = 10^{6}$ 微秒，因此\n$$\n2 \\times 10^{-5}\\ \\text{s} = 2 \\times 10^{-5} \\times 10^{6}\\ \\mu\\text{s} = 2 \\times 10^{1}\\ \\mu\\text{s} = 20\\ \\mu\\text{s}.\n$$\n作为对不稳定尝试的一致性检验，当 $\\Delta t = 25$ 微秒时，Courant 数为\n$$\nC = \\frac{350 \\times 25 \\times 10^{-6}}{7.0 \\times 10^{-3}} = \\frac{350}{7} \\times 25 \\times 10^{-3} = 50 \\times 25 \\times 10^{-3} = 1.25 > 1,\n$$\n这证实了不稳定性。因此，最大稳定时间步长是 $20$ 微秒。",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "现实世界中的许多问题，尤其是在声学领域，都涉及声速 $c$ 随空间位置变化的非均匀介质。这个思想实验  探讨了在这种情况下，CFL条件如何全局适用。它揭示了一个关键原则：整个模拟的稳定性取决于系统中最快的波，这迫使全局时间步长必须足够小，以适应最具限制性的区域。这强调了稳定性是由“最坏情况”决定的，即介质中波速最快的地方。",
            "id": "4140096",
            "problem": "考虑具有空间变化声速的一维线性声波方程，$$p_{tt}(x,t) = c(x)^2\\,p_{xx}(x,t),$$ 其中 $p(x,t)$ 是声压，$c(x)$ 是满足 $0  c_{\\min} \\le c(x) \\le c_{\\max}  \\infty$ 的局部声速。设计算域被离散化为一个均匀网格 $x_j = j\\,\\Delta x$（其中 $j$ 为整数），并使用均匀的时间步长 $\\Delta t$ 来推进时间。通过在时间和空间上使用中心差分近似，可以得到该问题的一个标准的显式二阶精度有限差分格式：\n$$p_j^{n+1} = 2\\,p_j^n - p_j^{n-1} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2}\\left(p_{j+1}^n - 2\\,p_j^n + p_{j-1}^n\\right),$$\n其中 $p_j^n$ 近似于 $p(x_j, n\\,\\Delta t)$，$c_j = c(x_j)$。假设采用周期性边界条件和线性分析。从控制偏微分方程、上述离散格式以及局部冻结系数傅里叶分析出发，通过基于原理的论证，确定对 $\\Delta t$ 的何种全局时间步长限制，足以保证与空间变化的 $c_j$ 的 Courant-Friedrichs-Lewy (CFL) 条件相一致的线性稳定性。\n\n从以下选项中选择正确的陈述：\n\nA. $\\Delta t \\le \\min_j \\dfrac{\\Delta x}{c_j}$\n\nB. $\\Delta t \\le \\dfrac{\\Delta x}{\\frac{1}{N}\\sum_{j=0}^{N-1} c_j}$\n\nC. $\\Delta t \\le \\max_j \\dfrac{\\Delta x}{c_j}$\n\nD. 当 $c_j$ 变化时，没有单个全局 $\\Delta t$ 能确保稳定性；必须选择局部时间步长 $\\Delta t_j$ 以使得对每个 $j$ 都有 $\\dfrac{c_j\\,\\Delta t_j}{\\Delta x} \\le 1$\n\nE. 该格式在一维空间中是无条件稳定的，因此对 $\\Delta t$ 没有限制要求",
            "solution": "### 解答推导\n\n该问题要求对给定具有空间变化系数 $c(x)$ 的波动方程的有限差分格式进行稳定性分析。指定的方法是局部冻结系数傅里叶分析，也称为冯·诺依曼冻结系数稳定性分析。这种方法通过在每个空间点 $x_j$ 分析格式来评估稳定性，就好像系数 $c_j=c(x_j)$ 在该点邻域内是常数一样。\n\n在给定的网格点 $x_j$ 处，我们冻结系数 $c_j$ 并分析该格式：\n$$p_k^{n+1} = 2\\,p_k^n - p_k^{n-1} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2}\\left(p_{k+1}^n - 2\\,p_k^n + p_{k-1}^n\\right)$$\n在这里，$k$ 是傅里叶分析的移动空间索引，$c_j$ 对于此局部分析是一个固定常数。我们寻求单一傅里叶模式形式的解，$p_k^n = g^n e^{i \\kappa k \\Delta x}$，其中 $g$ 是每个时间步的放大因子，$\\kappa$ 是波数，$i = \\sqrt{-1}$。为了使格式稳定，对于任何波数，放大因子的模都不能超过1，即 $|g| \\le 1$。\n\n将傅里叶模式代入差分方程：\n$$g^{n+1} e^{i \\kappa k \\Delta x} = 2\\,g^n e^{i \\kappa k \\Delta x} - g^{n-1} e^{i \\kappa k \\Delta x} + \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\left[ g^n e^{i \\kappa (k+1) \\Delta x} - 2\\,g^n e^{i \\kappa k \\Delta x} + g^n e^{i \\kappa (k-1) \\Delta x} \\right]$$\n两边同除以 $g^{n-1} e^{i \\kappa k \\Delta x}$（假设 $g \\neq 0$ 且 $e^{i \\kappa k \\Delta x} \\neq 0$）得到关于 $g$ 的二次方程：\n$$g^2 = 2g - 1 + g \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\left( e^{i \\kappa \\Delta x} - 2 + e^{-i \\kappa \\Delta x} \\right)$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$，括号中的项变为 $2\\cos(\\kappa\\Delta x) - 2$。这可以利用半角恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$ 进一步简化，得到 $2\\cos(\\kappa\\Delta x) - 2 = -4\\sin^2(\\frac{\\kappa\\Delta x}{2})$。\n\n将其代回，我们得到：\n$$g^2 = 2g - 1 - g \\left( 4 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\right)$$\n整理成标准二次型 $Ag^2 + Bg + C = 0$：\n$$g^2 - \\left[ 2 - 4 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\right] g + 1 = 0$$\n该方程的形式为 $g^2 - 2\\beta g + 1 = 0$，其中根为 $g = \\beta \\pm \\sqrt{\\beta^2 - 1}$ 且 $\\beta = 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2})$。\n为保证稳定性，我们要求 $|g| \\le 1$。如果 $\\beta^2  1$，根是实数且它们的乘积为 1，所以一个根的模必须大于 1，导致不稳定。如果 $\\beta^2 \\le 1$，根是共轭复数，其模为 $|g| = \\sqrt{\\beta^2 + (1-\\beta^2)} = 1$。因此，稳定性条件是 $|\\beta| \\le 1$，即 $-1 \\le \\beta \\le 1$。\n\n我们必须满足：\n$$-1 \\le 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 1$$\n右侧的不等式 $1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2}) \\le 1$ 简化为 $-2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2(\\frac{\\kappa\\Delta x}{2}) \\le 0$，由于所有项都是非负的，该不等式恒成立。\n左侧的不等式提供了实际的限制条件：\n$$-1 \\le 1 - 2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right)$$\n$$2 \\frac{\\Delta t^2\\,c_j^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 2$$\n$$\\frac{c_j^2 \\Delta t^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\le 1$$\n这个不等式必须对所有波数 $\\kappa$ 成立。最严格的情况（“最坏情况”）发生在 $\\sin^2(\\frac{\\kappa\\Delta x}{2})$ 项取最大值时。其最大值为 1，这发生在网格能解析的最高频率模式，即 $\\kappa\\Delta x = \\pi$ 时。\n因此，条件变为：\n$$\\frac{c_j \\Delta t}{\\Delta x} \\le 1$$\n这就是局部点 $x_j$ 的 Courant-Friedrichs-Lewy (CFL) 条件，可以写成对局部时间步长的限制：$\\Delta t \\le \\frac{\\Delta x}{c_j}$。\n\n为了使整个格式在使用单一的全局时间步长 $\\Delta t$ 时保持稳定，这个时间步长必须足够小，以满足域中每个网格点 $j$ 的局部稳定性条件。\n因此，$\\Delta t$ 必须小于或等于所有局部最大时间步长的最小值：\n$$\\Delta t \\le \\min_{j} \\left( \\frac{\\Delta x}{c_j} \\right)$$\n由于 $\\Delta x$ 是一个正常数，最小化分数 $\\frac{\\Delta x}{c_j}$ 等价于最大化分母 $c_j$。这意味着全局时间步长受域内最大波速的限制：\n$$\\Delta t \\le \\frac{\\Delta x}{\\max_{j}(c_j)}$$\n表达式 $\\min_j \\left( \\frac{\\Delta x}{c_j} \\right)$ 正是确保这一点的陈述。\n\n### 逐项分析\n\n**A. $\\Delta t \\le \\min_j \\dfrac{\\Delta x}{c_j}$**\n如上所推导，这是确保整个计算域在使用单一全局时间步长 $\\Delta t$ 时保持稳定的正确条件。它确保了即使在具有最高声速 $c_j$ 的区域（这是最严格的情况），CFL条件也能得到满足。\n结论：**正确**。\n\n**B. $\\Delta t \\le \\dfrac{\\Delta x}{\\frac{1}{N}\\sum_{j=0}^{N-1} c_j}$**\n这个条件使用了声速的算术平均值。这是不正确的。如果域中包含一个声速非常高的小区域（例如，$c_j \\gg \\text{avg}(c)$），平均速度将远低于局部最大值。基于平均速度的时间步长对于高速区域来说会过大，从而在该处违反局部CFL条件，并导致数值不稳定性。\n结论：**不正确**。\n\n**C. $\\Delta t \\le \\max_j \\dfrac{\\Delta x}{c_j}$**\n这个表达式等价于 $\\Delta t \\le \\dfrac{\\Delta x}{\\min_j c_j}$，因为最大化 $\\frac{\\Delta x}{c_j}$ 等价于最小化 $c_j$。这个条件将时间步长建立在*最小*声速的基础上。对于声速大于最小值的区域，这样的时间步长会过大，导致严重违反CFL条件并立即产生不稳定性。\n结论：**不正确**。\n\n**D. 当 $c_j$ 变化时，没有单个全局 $\\Delta t$ 能确保稳定性；必须选择局部时间步长 $\\Delta t_j$ 以使得对每个 $j$ 都有 $\\dfrac{c_j\\,\\Delta t_j}{\\Delta x} \\le 1$**\n这个陈述是错误的。虽然局部时间步进对此类问题是一种有效且通常更高效的数值策略，但它并非稳定性的必要条件。如选项 A 的推导所示，根据最严格的局部条件（即基于 $c_{\\max}$）选择一个单一的全局时间步长，完全足以保证整个域的稳定性。\n结论：**不正确**。\n\n**E. 该格式在一维空间中是无条件稳定的，因此对 $\\Delta t$ 没有限制要求**\n这是错误的。冯·诺依曼分析明确地推导出了一个依赖于 $\\Delta t$、$\\Delta x$ 和 $c_j$ 的稳定性条件。对于双曲型偏微分方程的显式有限差分格式（如本题所给），几乎总是条件稳定的。无条件稳定性通常是与隐式格式相关联的属性。\n结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}