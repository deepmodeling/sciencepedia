{
    "hands_on_practices": [
        {
            "introduction": "This first exercise goes back to the fundamentals of acoustic radiation. By deriving the total radiated power of a simple monopole source directly from the linearized acoustic equations, you will solidify your understanding of how the abstract concept of a source translates into a measurable physical quantity . This foundational practice reinforces the connection between the governing wave equation, the far-field approximation, and the principle of energy conservation in acoustics.",
            "id": "4115033",
            "problem": "Consider an unbounded, homogeneous, inviscid fluid of equilibrium density $\\rho_{0}$ and sound speed $c$. A compact time-harmonic monopole source is located at the origin and injects fluid with complex volume velocity amplitude $Q$ at angular frequency $\\omega$, with physical fields following the convention $p(\\mathbf{r}, t) = \\Re\\{\\tilde{p}(\\mathbf{r}) \\exp(- i \\omega t)\\}$ and $\\mathbf{u}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{u}}(\\mathbf{r}) \\exp(- i \\omega t)\\}$. Assume the source region is acoustically compact, meaning $ka \\ll 1$ with $k = \\omega / c$ and $a$ the characteristic source size, and impose the outgoing radiation condition in free space.\n\nStarting strictly from the linearized equations of acoustics and the free-space Green’s function of the Helmholtz operator as the fundamental base, derive the leading-order far-field pressure amplitude $\\tilde{p}(r)$ of this monopole and the corresponding radial particle velocity amplitude $\\tilde{u}_{r}(r)$ in the region $r \\gg a$, retaining only the term that decays as $1/r$ and discarding reactive near-field terms. From these, compute the time-averaged acoustic intensity $I(r)$ at a radius $r$ defined by $I(r) = \\frac{1}{2} \\Re\\{\\tilde{p}(r) \\tilde{u}_{r}^{*}(r)\\}$, and then integrate $I(r)$ over the surface of a sphere of radius $r$ to obtain the total radiated acoustic power.\n\nExpress the final total radiated acoustic power in terms of $\\omega$, $\\rho_{0}$, $c$, and $|Q|$ only. Provide your final answer as a single closed-form analytic expression. Express the total radiated power in Watts. No numerical evaluation is required and no rounding should be performed.",
            "solution": "The problem requires the derivation of the total acoustic power radiated by a compact time-harmonic monopole source in a uniform fluid. The derivation must start from the linearized equations of acoustics and utilize the free-space Green's function for the Helmholtz equation.\n\nFirst, we establish the governing equation for the acoustic pressure. The linearized equations of mass and momentum conservation for an inviscid, homogeneous fluid with equilibrium density $\\rho_{0}$ are:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\mathbf{u} = q_{m}(\\mathbf{r}, t)\n$$\n$$\n\\rho_{0} \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p'\n$$\nwhere $\\rho'$ and $p'$ are the acoustic density and pressure perturbations, $\\mathbf{u}$ is the particle velocity, and $q_{m}$ is the rate of mass injection per unit volume. The equation of state for a linear acoustic medium relates pressure and density perturbations by $p' = c^2 \\rho'$, where $c$ is the speed of sound.\n\nThe source is a point monopole at the origin, $\\mathbf{r}=\\mathbf{0}$, injecting fluid with a volume velocity $Q_{v}(t)$. This corresponds to a mass source term $q_{m}(\\mathbf{r}, t) = \\rho_{0} Q_{v}(t) \\delta(\\mathbf{r})$, where $\\delta(\\mathbf{r})$ is the Dirac delta function. The time-harmonic convention is given as $f(t) = \\Re\\{\\tilde{f} \\exp(-i\\omega t)\\}$. Applying this to the source gives $Q_{v}(t) = \\Re\\{Q \\exp(-i\\omega t)\\}$. Under this convention, the time derivative operator $\\frac{\\partial}{\\partial t}$ corresponds to multiplication by $-i\\omega$ in the frequency domain.\n\nWe combine the linearized equations to form a single wave equation for the pressure $p'$. Taking the time derivative of the mass conservation equation and the divergence of the momentum equation yields:\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_{0} \\nabla \\cdot \\left(\\frac{\\partial \\mathbf{u}}{\\partial t}\\right) = \\frac{\\partial q_{m}}{\\partial t}\n$$\n$$\n\\rho_{0} \\nabla \\cdot \\left(\\frac{\\partial \\mathbf{u}}{\\partial t}\\right) = -\\nabla^2 p'\n$$\nSubstituting $\\rho' = p'/c^2$ and the divergence of the momentum equation into the time-differentiated mass equation gives the inhomogeneous wave equation:\n$$\n\\frac{1}{c^2} \\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = \\frac{\\partial q_{m}}{\\partial t} = \\rho_{0} \\frac{d Q_{v}}{dt} \\delta(\\mathbf{r})\n$$\nTransforming to the frequency domain for the complex pressure amplitude $\\tilde{p}(\\mathbf{r})$:\n$$\n\\frac{1}{c^2} (-i\\omega)^2 \\tilde{p} - \\nabla^2 \\tilde{p} = \\rho_{0} (-i\\omega Q) \\delta(\\mathbf{r})\n$$\n$$\n-\\frac{\\omega^2}{c^2} \\tilde{p} - \\nabla^2 \\tilde{p} = -i\\omega \\rho_{0} Q \\delta(\\mathbf{r})\n$$\nRearranging this gives the inhomogeneous Helmholtz equation:\n$$\n\\nabla^2 \\tilde{p}(\\mathbf{r}) + k^2 \\tilde{p}(\\mathbf{r}) = i\\omega \\rho_{0} Q \\delta(\\mathbf{r})\n$$\nwhere $k = \\omega/c$ is the acoustic wavenumber.\n\nThe problem specifies using the free-space Green's function for the Helmholtz operator, which satisfies $(\\nabla^2 + k^2)G(\\mathbf{r}|\\mathbf{r}') = -\\delta(\\mathbf{r}-\\mathbf{r}')$ and the outgoing radiation condition. This Green's function is:\n$$\nG(\\mathbf{r}|\\mathbf{r}') = \\frac{\\exp(ik|\\mathbf{r}-\\mathbf{r'}|)}{4\\pi|\\mathbf{r}-\\mathbf{r'}|}\n$$\nThe solution for $\\tilde{p}(\\mathbf{r})$ is given by the convolution of the source term with the negative of the Green's function:\n$$\n\\tilde{p}(\\mathbf{r}) = \\int_{\\mathbb{R}^3} [-i\\omega \\rho_{0} Q \\delta(\\mathbf{r}')] G(\\mathbf{r}|\\mathbf{r}') dV'\n$$\nDue to the sifting property of the delta function at $\\mathbf{r}'=\\mathbf{0}$, this simplifies to:\n$$\n\\tilde{p}(\\mathbf{r}) = -i\\omega \\rho_{0} Q G(\\mathbf{r}|\\mathbf{0}) = -i\\omega \\rho_{0} Q \\frac{\\exp(ik|\\mathbf{r}|)}{4\\pi|\\mathbf{r}|}\n$$\nLetting $r = |\\mathbf{r}|$, the spherically symmetric pressure field is:\n$$\n\\tilde{p}(r) = -i\\omega \\rho_{0} Q \\frac{\\exp(ikr)}{4\\pi r}\n$$\nThis expression already decays as $1/r$, so it represents the leading-order far-field pressure.\n\nNext, we find the corresponding radial particle velocity amplitude $\\tilde{u}_{r}(r)$. From the linearized momentum equation in the frequency domain, $\\tilde{\\mathbf{u}} = \\frac{1}{-i\\omega\\rho_{0}}(-\\nabla \\tilde{p}) = \\frac{1}{i\\omega\\rho_{0}}\\nabla \\tilde{p}$. Since $\\tilde{p}$ is a function of $r$ only, the gradient is $\\nabla\\tilde{p} = \\frac{\\partial \\tilde{p}}{\\partial r} \\hat{\\mathbf{r}}$, and the radial velocity is:\n$$\n\\tilde{u}_{r}(r) = \\frac{1}{i\\omega\\rho_{0}}\\frac{\\partial \\tilde{p}}{\\partial r} = \\frac{1}{i\\omega\\rho_{0}}\\frac{\\partial}{\\partial r}\\left(-i\\omega\\rho_{0} Q \\frac{\\exp(ikr)}{4\\pi r}\\right) = -Q \\frac{1}{4\\pi}\\frac{\\partial}{\\partial r}\\left(\\frac{\\exp(ikr)}{r}\\right)\n$$\n$$\n\\tilde{u}_{r}(r) = -\\frac{Q}{4\\pi}\\left(\\frac{ik\\exp(ikr)}{r} - \\frac{\\exp(ikr)}{r^2}\\right) = \\frac{Q\\exp(ikr)}{4\\pi r^2}(1-ikr)\n$$\nThe problem requires retaining only the term that decays as $1/r$. The term $\\frac{Q\\exp(ikr)}{4\\pi r^2}$ decays as $1/r^2$ and represents the near-field reactive velocity. The term $-ik\\frac{Q\\exp(ikr)}{4\\pi r}$ decays as $1/r$ and represents the far-field propagating velocity. Therefore, the far-field approximation is:\n$$\n\\tilde{u}_{r}(r) \\approx -ik\\frac{Q\\exp(ikr)}{4\\pi r} = \\frac{-i\\omega}{c}\\frac{Q\\exp(ikr)}{4\\pi r}\n$$\nWe can observe that in the far field, $\\tilde{p}(r) = (\\rho_0 c) \\tilde{u}_r(r)$, which is the plane wave impedance relation.\n\nNow, we compute the time-averaged acoustic intensity $I(r)$, defined as $I(r) = \\frac{1}{2} \\Re\\{\\tilde{p}(r) \\tilde{u}_{r}^{*}(r)\\}$, where $*$ denotes the complex conjugate.\n$$\n\\tilde{p}(r) = -i\\omega\\rho_{0} Q \\frac{\\exp(ikr)}{4\\pi r}\n$$\n$$\n\\tilde{u}_{r}^{*}(r) \\approx \\left(-ik\\frac{Q\\exp(ikr)}{4\\pi r}\\right)^{*} = ik\\frac{Q^{*}\\exp(-ikr)}{4\\pi r}\n$$\nThe product $\\tilde{p}(r) \\tilde{u}_{r}^{*}(r)$ is:\n$$\n\\tilde{p}(r) \\tilde{u}_{r}^{*}(r) \\approx \\left(-i\\omega\\rho_{0} Q \\frac{\\exp(ikr)}{4\\pi r}\\right) \\left(ik\\frac{Q^{*}\\exp(-ikr)}{4\\pi r}\\right) = (-i)(ik)(\\omega\\rho_{0}) \\frac{QQ^{*}}{(4\\pi r)^2} = k\\omega\\rho_{0} \\frac{|Q|^2}{16\\pi^2 r^2}\n$$\nThis product is purely real, so the $\\Re$ operator is trivial. Substituting $k=\\omega/c$:\n$$\nI(r) = \\frac{1}{2}\\left(\\frac{\\omega}{c}\\omega\\rho_{0} \\frac{|Q|^2}{16\\pi^2 r^2}\\right) = \\frac{\\omega^2 \\rho_{0} |Q|^2}{32 \\pi^2 c r^2}\n$$\nThe intensity is purely radial and uniform over any sphere centered at the origin.\n\nFinally, we compute the total radiated acoustic power, $W$, by integrating the intensity over the surface of a sphere of radius $r$. The surface element is $dS = r^2 \\sin\\theta d\\theta d\\phi$.\n$$\nW = \\oint_S I(r) dS = I(r) \\times (\\text{Surface area of sphere}) = I(r) \\times (4\\pi r^2)\n$$\n$$\nW = \\left(\\frac{\\omega^2 \\rho_{0} |Q|^2}{32 \\pi^2 c r^2}\\right) (4\\pi r^2)\n$$\nThe $r^2$ terms cancel, showing that the total power is independent of the distance at which it is measured, as required by energy conservation for a non-dissipative medium.\n$$\nW = \\frac{4\\pi \\omega^2 \\rho_{0} |Q|^2}{32 \\pi^2 c} = \\frac{\\omega^2 \\rho_{0} |Q|^2}{8 \\pi c}\n$$\nThis is the final expression for the total radiated acoustic power in terms of the given parameters. The unit of this quantity is Watts in the SI system.",
            "answer": "$$\n\\boxed{\\frac{\\omega^{2} \\rho_{0} |Q|^{2}}{8 \\pi c}}\n$$"
        },
        {
            "introduction": "Building upon the monopole, this practice explores the acoustic dipole, the first and simplest directional source. You will derive its characteristic radiation pattern and quantify its focus using the concept of a $3$ decibel beamwidth . This exercise is key to understanding how source geometry creates acoustic directivity, a fundamental concept in designing and analyzing everything from loudspeakers to sonar arrays.",
            "id": "4115023",
            "problem": "Consider a lossless, homogeneous fluid with mass density $\\rho_{0}$ and sound speed $c_{0}$. Let a time-harmonic acoustic field have angular frequency $\\omega$ with implicit time dependence $\\exp(-i \\omega t)$. In linear acoustics, the steady-state pressure $p(\\mathbf{r})$ satisfies the inhomogeneous Helmholtz equation\n$$\n\\nabla^{2} p(\\mathbf{r}) + k^{2} p(\\mathbf{r}) = - S(\\mathbf{r}),\n$$\nwhere $k = \\omega / c_{0}$ is the wavenumber and $S(\\mathbf{r})$ is a source distribution. A compact acoustic dipole oriented along the $z$-axis may be modeled as two infinitesimal monopoles of equal amplitude and opposite sign, located at $\\mathbf{r}_{+} = \\tfrac{d}{2} \\hat{\\mathbf{z}}$ and $\\mathbf{r}_{-} = -\\tfrac{d}{2} \\hat{\\mathbf{z}}$, with $d \\ll \\lambda$ and $\\lambda = 2 \\pi / k$. The free-space Green’s function for the Helmholtz operator is\n$$\nG(\\mathbf{r};\\mathbf{r}_{0}) = \\frac{\\exp(i k |\\mathbf{r} - \\mathbf{r}_{0}|)}{4 \\pi |\\mathbf{r} - \\mathbf{r}_{0}|}.\n$$\nStarting from the inhomogeneous Helmholtz equation, the free-space Green’s function, superposition, and a far-field ($r \\to \\infty$) and small-separation ($kd \\ll 1$) expansion, derive the leading-order angular dependence of the dipole’s far-field pressure. Then, define the directivity function as the normalized far-field amplitude with respect to polar angle $\\theta$ measured from the dipole axis (the $+z$ direction), and show that the dipole directivity is proportional to $\\cos \\theta$. Finally, by identifying the time-averaged acoustic intensity pattern from the far-field pressure, determine the $3$ decibel (dB) beamwidth of the principal lobe, defined as the total angular width between the two angles where the intensity is one half of its maximum. Express your final answer as a single closed-form analytic expression in radians. Do not round; provide an exact expression.",
            "solution": "The problem asks for the derivation of the far-field pressure of an acoustic dipole, its directivity, and the 3 dB beamwidth of its principal lobe. We begin by validating the problem statement.\n\nThe problem is scientifically grounded in the principles of linear acoustics, utilizing the inhomogeneous Helmholtz equation and the concept of a Green's function, which are standard tools in wave physics. The model of a dipole as two closely spaced monopoles of opposite phase is a fundamental concept. The problem is well-posed, providing all necessary physical parameters ($\\rho_{0}$, $c_{0}$), mathematical definitions (Helmholtz equation, Green's function, time dependence), and geometric setup (dipole orientation and separation). The constraints ($d \\ll \\lambda$, $r \\to \\infty$) are clearly stated and physically meaningful for the required approximations. The definitions for directivity and beamwidth are unambiguous. The problem is objective and contains no a priori contradictions. Therefore, the problem is deemed valid, and we proceed with the solution.\n\nAccording to the principle of superposition for the linear Helmholtz equation, the pressure field $p(\\mathbf{r})$ generated by a source distribution $S(\\mathbf{r})$ can be found by integrating the source contribution weighted by the free-space Green's function $G(\\mathbf{r}; \\mathbf{r}_{0})$:\n$$\np(\\mathbf{r}) = \\int S(\\mathbf{r}_{0}) G(\\mathbf{r}; \\mathbf{r}_{0}) dV_{0}\n$$\nThe problem describes a dipole source oriented along the $z$-axis, composed of two monopoles of equal strength and opposite sign. Let the strength of the source term be $A$. The monopoles are located at $\\mathbf{r}_{+} = \\frac{d}{2} \\hat{\\mathbf{z}}$ and $\\mathbf{r}_{-} = -\\frac{d}{2} \\hat{\\mathbf{z}}$. The source distribution can be written using the Dirac delta function $\\delta(\\mathbf{r})$ as:\n$$\nS(\\mathbf{r}) = A \\delta(\\mathbf{r} - \\mathbf{r}_{+}) - A \\delta(\\mathbf{r} - \\mathbf{r}_{-})\n$$\nSubstituting this source distribution into the integral solution and using the sifting property of the delta function, the pressure is the sum of the fields from the two monopoles:\n$$\np(\\mathbf{r}) = A G(\\mathbf{r}; \\mathbf{r}_{+}) - A G(\\mathbf{r}; \\mathbf{r}_{-})\n$$\nWe are given the Green's function $G(\\mathbf{r};\\mathbf{r}_{0}) = \\frac{\\exp(i k |\\mathbf{r} - \\mathbf{r}_{0}|)}{4 \\pi |\\mathbf{r} - \\mathbf{r}_{0}|}$. Substituting this into the expression for pressure yields:\n$$\np(\\mathbf{r}) = \\frac{A}{4\\pi} \\left( \\frac{\\exp(i k |\\mathbf{r} - \\mathbf{r}_{+}|)}{|\\mathbf{r} - \\mathbf{r}_{+}|} - \\frac{\\exp(i k |\\mathbf{r} - \\mathbf{r}_{-}|)}{|\\mathbf{r} - \\mathbf{r}_{-}|} \\right)\n$$\nWe now apply the far-field approximation, where the observation point distance $r = |\\mathbf{r}|$ is much larger than the dipole separation $d$ ($r \\gg d$). In this limit, we can approximate the distance $|\\mathbf{r} - \\mathbf{r}_{0}|$ which appears in the denominator (amplitude term) and the exponent (phase term).\nFor the amplitude term, a simple approximation is sufficient: $|\\mathbf{r} - \\mathbf{r}_{0}| \\approx r$.\nFor the phase term, a more accurate approximation is needed because the phase is sensitive to small path length differences. We use the binomial expansion:\n$$\n|\\mathbf{r} - \\mathbf{r}_{0}| = \\sqrt{(\\mathbf{r} - \\mathbf{r}_{0}) \\cdot (\\mathbf{r} - \\mathbf{r}_{0})} = \\sqrt{r^2 - 2 \\mathbf{r} \\cdot \\mathbf{r}_{0} + |\\mathbf{r}_{0}|^2} = r \\sqrt{1 - \\frac{2 \\mathbf{r} \\cdot \\mathbf{r}_{0}}{r^2} + \\frac{|\\mathbf{r}_{0}|^2}{r^2}}\n$$\nFor $r \\to \\infty$, we can expand the square root to first order:\n$$\n|\\mathbf{r} - \\mathbf{r}_{0}| \\approx r \\left( 1 - \\frac{\\mathbf{r} \\cdot \\mathbf{r}_{0}}{r^2} \\right) = r - \\hat{\\mathbf{r}} \\cdot \\mathbf{r}_{0}\n$$\nwhere $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ is the unit vector in the direction of observation.\nLet $\\theta$ be the polar angle measured from the $+z$-axis. Then $\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{z}} = \\cos\\theta$. For our two sources:\n$$\n\\hat{\\mathbf{r}} \\cdot \\mathbf{r}_{+} = \\hat{\\mathbf{r}} \\cdot \\left(\\frac{d}{2}\\hat{\\mathbf{z}}\\right) = \\frac{d}{2} \\cos\\theta\n$$\n$$\n\\hat{\\mathbf{r}} \\cdot \\mathbf{r}_{-} = \\hat{\\mathbf{r}} \\cdot \\left(-\\frac{d}{2}\\hat{\\mathbf{z}}\\right) = -\\frac{d}{2} \\cos\\theta\n$$\nSo the phase terms become:\n$$\n|\\mathbf{r} - \\mathbf{r}_{+}| \\approx r - \\frac{d}{2} \\cos\\theta\n$$\n$$\n|\\mathbf{r} - \\mathbf{r}_{-}| \\approx r + \\frac{d}{2} \\cos\\theta\n$$\nSubstituting these approximations into the pressure expression:\n$$\np(\\mathbf{r}) \\approx \\frac{A}{4\\pi r} \\left( \\exp\\left(ik\\left(r - \\frac{d}{2}\\cos\\theta\\right)\\right) - \\exp\\left(ik\\left(r + \\frac{d}{2}\\cos\\theta\\right)\\right) \\right)\n$$\nFactoring out the common term $\\exp(ikr)$:\n$$\np(\\mathbf{r}) \\approx \\frac{A \\exp(ikr)}{4\\pi r} \\left( \\exp\\left(-i\\frac{kd}{2}\\cos\\theta\\right) - \\exp\\left(i\\frac{kd}{2}\\cos\\theta\\right) \\right)\n$$\nUsing Euler's identity, $\\sin(x) = \\frac{\\exp(ix) - \\exp(-ix)}{2i}$, we can write the term in the parentheses as $-2i \\sin\\left(\\frac{kd}{2}\\cos\\theta\\right)$.\n$$\np(\\mathbf{r}) \\approx \\frac{A \\exp(ikr)}{4\\pi r} \\left( -2i \\sin\\left(\\frac{kd}{2}\\cos\\theta\\right) \\right)\n$$\nNext, we apply the small-separation approximation, $kd \\ll 1$. This implies that the argument of the sine function is small, so we can use the first-order Taylor expansion $\\sin(x) \\approx x$.\n$$\n\\sin\\left(\\frac{kd}{2}\\cos\\theta\\right) \\approx \\frac{kd}{2}\\cos\\theta\n$$\nSubstituting this back into the pressure expression gives the leading-order far-field pressure for the dipole:\n$$\np(\\mathbf{r}) \\approx \\frac{A \\exp(ikr)}{4\\pi r} \\left( -2i \\left(\\frac{kd}{2}\\cos\\theta\\right) \\right) = -iAkd \\cos\\theta \\frac{\\exp(ikr)}{4\\pi r}\n$$\nThis expression demonstrates that the leading-order angular dependence of the dipole's far-field pressure is proportional to $\\cos\\theta$.\n\nThe directivity function $D(\\theta)$ is defined as the normalized far-field pressure amplitude. The far-field pressure amplitude $|p(\\mathbf{r})|$ is:\n$$\n|p(\\mathbf{r})| = \\left| -iAkd \\cos\\theta \\frac{\\exp(ikr)}{4\\pi r} \\right| = \\frac{|A|kd}{4\\pi r} |\\cos\\theta|\n$$\nThe amplitude as a function of angle is proportional to $|\\cos\\theta|$. The maximum amplitude occurs when $|\\cos\\theta|=1$ (i.e., at $\\theta=0$ and $\\theta=\\pi$). Let's denote the maximum amplitude at a fixed radius $r$ as $|p|_{\\text{max}} = \\frac{|A|kd}{4\\pi r}$. The directivity function is then:\n$$\nD(\\theta) = \\frac{|p(\\mathbf{r})|}{|p|_{\\text{max}}} = \\frac{\\frac{|A|kd}{4\\pi r} |\\cos\\theta|}{\\frac{|A|kd}{4\\pi r}} = |\\cos\\theta|\n$$\nThe problem asks to show that the directivity is proportional to $\\cos\\theta$. For the principal lobe, typically defined in the hemisphere $0 \\le \\theta \\le \\pi/2$, $\\cos\\theta$ is non-negative, so $D(\\theta) = \\cos\\theta$.\n\nFinally, we determine the 3 dB beamwidth. The time-averaged acoustic intensity $I$ in the far field is proportional to the square of the pressure amplitude:\n$$\nI(\\mathbf{r}) \\propto |p(\\mathbf{r})|^2 \\propto \\left( \\frac{|\\cos\\theta|}{r} \\right)^2 = \\frac{\\cos^2\\theta}{r^2}\n$$\nThe angular dependence of the intensity is given by $I(\\theta) = I_{\\text{max}} \\cos^2\\theta$, where $I_{\\text{max}}$ is the maximum intensity, which occurs on the axis at $\\theta=0$.\nThe 3 dB beamwidth is the total angular width between the two angles where the intensity is half of its maximum. The 3 dB points, or half-power points, are the angles $\\theta_h$ where $I(\\theta_h) = I_{\\text{max}}/2$.\n$$\nI_{\\text{max}} \\cos^2\\theta_h = \\frac{I_{\\text{max}}}{2}\n$$\n$$\n\\cos^2\\theta_h = \\frac{1}{2}\n$$\nTaking the square root gives $|\\cos\\theta_h| = 1/\\sqrt{2}$.\nFor the principal lobe, we consider the angle $\\theta_h$ in the first quadrant ($0 \\le \\theta_h \\le \\pi/2$), so we take the positive root:\n$$\n\\cos\\theta_h = 1/\\sqrt{2}\n$$\nSolving for $\\theta_h$ gives:\n$$\n\\theta_h = \\arccos(1/\\sqrt{2}) = \\frac{\\pi}{4} \\text{ radians}\n$$\nThis angle $\\theta_h$ is the half-angle of the beam. The beamwidth is defined as the *total angular width*, which, due to the symmetry of the $\\cos^2\\theta$ pattern about the axis $\\theta=0$, is twice this value.\n$$\n\\text{Beamwidth} = 2\\theta_h = 2 \\times \\frac{\\pi}{4} = \\frac{\\pi}{2}\n$$\nThus, the 3 dB beamwidth of the principal lobe is $\\frac{\\pi}{2}$ radians.",
            "answer": "$$\n\\boxed{\\frac{\\pi}{2}}\n$$"
        },
        {
            "introduction": "This final practice bridges theory and computational application by tackling a source identification problem. Using a statistical framework, you will develop and implement an algorithm to classify an unknown source from noisy, simulated measurements of its far-field pattern . This exercise highlights the practical challenges of model selection and hypothesis testing in experimental and computational acoustics, where signals are never perfect.",
            "id": "4115002",
            "problem": "You are given angle-resolved far-field acoustic pressure measurements for sources that are known to be axisymmetric about a fixed reference axis in the sense of spherical multipole expansions. Your task is to construct a statistical hypothesis test to decide whether the source is best described as a monopole, dipole, or quadrupole at a specified confidence level, using only the measured far-field directional pattern and an assumed Gaussian measurement noise model. You must implement a complete, runnable program that performs this classification on a small test suite and outputs the results in the exact format specified below.\n\nStart from the linearized acoustic wave equation with a time-harmonic ansatz, which leads to the Helmholtz equation. In the far field, the angular dependence of axisymmetric multipoles can be represented by the first few axisymmetric spherical harmonic factors. Under the assumption of axisymmetry aligned with the measurement reference axis, approximate the angular dependence of the monopole, dipole, and quadrupole by the basis functions $\\phi_0(\\theta) = 1$, $\\phi_1(\\theta) = \\cos\\theta$, and $\\phi_2(\\theta) = \\cos(2\\theta)$ respectively, where $\\theta$ is the polar angle around the axis. Let the measured far-field pressure samples be denoted by $y_i$ at angles $\\theta_i$, and assume an independent and identically distributed Gaussian noise model $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ with known variance $\\sigma^2$.\n\nModel the measurements as the linear regression\n$$\ny_i = c_0\\,\\phi_0(\\theta_i) + c_1\\,\\phi_1(\\theta_i) + c_2\\,\\phi_2(\\theta_i) + \\varepsilon_i,\n$$\nwith unknown coefficients $c_0$, $c_1$, and $c_2$ to be estimated by maximum likelihood under the Gaussian noise assumption, which is equivalent to least squares. Consider the following set of mutually exclusive composite null hypotheses corresponding to pure source types:\n- Monopole hypothesis $H_M$: $c_1 = 0$ and $c_2 = 0$,\n- Dipole hypothesis $H_D$: $c_0 = 0$ and $c_2 = 0$,\n- Quadrupole hypothesis $H_Q$: $c_0 = 0$ and $c_1 = 0$.\n\nConstruct a Generalized Likelihood Ratio (GLR) test for each restricted hypothesis against the full three-parameter model, and control the family-wise error rate at the specified significance level $\\alpha$ by using a Bonferroni correction across the three tests. Additionally, require that the defining nonzero coefficient of an accepted source type be statistically significantly different from zero at the same Bonferroni-corrected level via a two-sided Gaussian test. Implement a classification rule that accepts the source type(s) whose null hypothesis is not rejected and whose defining coefficient is significant, then selects the accepted type with the smallest restricted residual sum of squares. If none of the three types is accepted under these criteria, return the code $-1$ indicating that no pure type is supported by the data at the specified confidence level.\n\nAll angles must be expressed in radians, and pressures in Pascals. The noise standard deviation $\\sigma$ must be interpreted in Pascals. For each test case, generate the angle set as $N$ evenly spaced samples on $[0, 2\\pi)$ and synthetic measurements $y_i$ by combining the corresponding basis function(s) with specified amplitudes and additive Gaussian noise with the given $\\sigma$, using a fixed random seed to ensure reproducibility.\n\nImplement the program to process the following test suite, each specified by ($N$, $c_0$, $c_1$, $c_2$, $\\sigma$, $\\alpha$):\n- Case $1$ (happy path monopole): ($N=360, c_0=2.0$ Pa, $c_1=0.0$ Pa, $c_2=0.0$ Pa, $\\sigma=0.05$ Pa, $\\alpha=0.05$).\n- Case $2$ (happy path dipole, stricter confidence): ($N=180, c_0=0.0$ Pa, $c_1=1.0$ Pa, $c_2=0.0$ Pa, $\\sigma=0.10$ Pa, $\\alpha=0.01$).\n- Case $3$ (happy path quadrupole, higher noise): ($N=90, c_0=0.0$ Pa, $c_1=0.0$ Pa, $c_2=1.5$ Pa, $\\sigma=0.30$ Pa, $\\alpha=0.05$).\n- Case $4$ (mixture, should reject pure types): ($N=120, c_0=0.5$ Pa, $c_1=0.5$ Pa, $c_2=0.0$ Pa, $\\sigma=0.05$ Pa, $\\alpha=0.05$).\n- Case $5$ (low signal, noise-only): ($N=100, c_0=0.0$ Pa, $c_1=0.0$ Pa, $c_2=0.0$ Pa, $\\sigma=0.20$ Pa, $\\alpha=0.05$).\n\nUse a fixed random seed, $s=12345$, for generating the Gaussian noise to make the results deterministic. Encode the classification result for each case as an integer: monopole $\\rightarrow 0$, dipole $\\rightarrow 1$, quadrupole $\\rightarrow 2$, and none $\\rightarrow -1$.\n\nYour program should produce a single line of output containing the results for the above five test cases as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_k$ is the integer code for case $k$ as defined above.",
            "solution": "The problem requires the development of a statistical procedure to classify an axisymmetric acoustic source as a monopole, dipole, or quadrupole. This is accomplished by performing a series of hypothesis tests on measured far-field pressure data, which are modeled using a linear regression framework with specified basis functions.\n\n### 1. Modeling Framework\nThe measured acoustic pressure $y_i$ at a polar angle $\\theta_i$ is modeled as a linear combination of basis functions representing different source types, plus Gaussian noise $\\varepsilon_i$. The model is given by:\n$$\ny_i = c_0\\,\\phi_0(\\theta_i) + c_1\\,\\phi_1(\\theta_i) + c_2\\,\\phi_2(\\theta_i) + \\varepsilon_i\n$$\nwhere the basis functions are defined as $\\phi_0(\\theta) = 1$ (monopole), $\\phi_1(\\theta) = \\cos\\theta$ (dipole), and $\\phi_2(\\theta) = \\cos(2\\theta)$ (quadrupole). The measurement noise $\\varepsilon_i$ is assumed to be independent and identically distributed, following a normal distribution with mean $0$ and known variance $\\sigma^2$, denoted as $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$.\n\nThis can be expressed in matrix form as a general linear model:\n$$\ny = Xc + \\varepsilon\n$$\nHere, $y$ is the $N \\times 1$ vector of $N$ pressure measurements, $c = [c_0, c_1, c_2]^T$ is the $3 \\times 1$ vector of unknown coefficients, and $\\varepsilon$ is the $N \\times 1$ noise vector where $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I_N)$ with $I_N$ being the $N \\times N$ identity matrix. The $N \\times 3$ design matrix $X$ is constructed from the basis functions evaluated at each measurement angle $\\theta_i$:\n$$\nX = \\begin{bmatrix}\n\\phi_0(\\theta_0) & \\phi_1(\\theta_0) & \\phi_2(\\theta_0) \\\\\n\\phi_0(\\theta_1) & \\phi_1(\\theta_1) & \\phi_2(\\theta_1) \\\\\n\\vdots & \\vdots & \\vdots \\\\\n\\phi_0(\\theta_{N-1}) & \\phi_1(\\theta_{N-1}) & \\phi_2(\\theta_{N-1})\n\\end{bmatrix} = \\begin{bmatrix}\n1 & \\cos(\\theta_0) & \\cos(2\\theta_0) \\\\\n1 & \\cos(\\theta_1) & \\cos(2\\theta_1) \\\\\n\\vdots & \\vdots & \\vdots \\\\\n1 & \\cos(\\theta_{N-1}) & \\cos(2\\theta_{N-1})\n\\end{bmatrix}\n$$\nUnder the Gaussian noise assumption, the Maximum Likelihood Estimate (MLE) for the coefficient vector $c$ is identical to the Ordinary Least Squares (OLS) estimate, given by:\n$$\n\\hat{c} = (X^T X)^{-1} X^T y\n$$\n\n### 2. Hypothesis Testing Strategy\nThe classification task is framed as a set of hypothesis tests. The full model, where all three coefficients are potentially non-zero, serves as the alternative hypothesis $H_A$. We test three mutually exclusive, composite null hypotheses corresponding to pure source types:\n- **Monopole Hypothesis $H_M$**: The source is a pure monopole. This imposes the constraints $c_1 = 0$ and $c_2 = 0$.\n- **Dipole Hypothesis $H_D$**: The source is a pure dipole. This imposes the constraints $c_0 = 0$ and $c_2 = 0$.\n- **Quadrupole Hypothesis $H_Q$**: The source is a pure quadrupole. This imposes the constraints $c_0 = 0$ and $c_1 = 0$.\n\nA Generalized Likelihood Ratio (GLR) test is used to compare each restricted model ($H_M$, $H_D$, $H_Q$) against the full model $H_A$. For a linear model with known error variance $\\sigma^2$, the GLR test statistic $\\Lambda$ is based on the change in the Residual Sum of Squares (RSS). Let $RSS_{full} = \\|y - X_{full}\\hat{c}_{full}\\|^2$ be the RSS for the full model and $RSS_{restr} = \\|y - X_{restr}\\hat{c}_{restr}\\|^2$ be the RSS for a restricted model. The test statistic for a given null hypothesis $H_k$ is:\n$$\n\\Lambda_k = \\frac{RSS_k - RSS_{full}}{\\sigma^2}\n$$\nUnder the null hypothesis $H_k$, this statistic follows a chi-squared distribution, $\\Lambda_k \\sim \\chi^2(q_k)$, where $q_k$ is the number of independent linear constraints imposed. For $H_M$, $H_D$, and $H_Q$, the number of constraints is $q=2$ in each case.\n\nSince we are performing three separate tests, we must correct for multiple comparisons to control the family-wise error rate (FWER) at the specified level $\\alpha$. The problem stipulates a Bonferroni correction, which sets the significance level for each individual test to $\\alpha' = \\alpha/3$. A null hypothesis $H_k$ is considered plausible (i.e., not rejected) if its test statistic $\\Lambda_k$ is less than or equal to the critical value $\\chi^2_{1-\\alpha'}(2)$, the $(1-\\alpha')$ quantile of the chi-squared distribution with $2$ degrees of freedom.\n\n### 3. Coefficient Significance Condition\nAn additional criterion for accepting a source type is that its defining coefficient must be statistically significant. This ensures that we do not classify a source based on a negligible component. We test the significance of the coefficients estimated from the full model, $\\hat{c}_{full} = [\\hat{c}_0, \\hat{c}_1, \\hat{c}_2]^T$.\n\nThe covariance matrix of the estimated coefficients is $\\text{Cov}(\\hat{c}_{full}) = \\sigma^2 (X_{full}^T X_{full})^{-1}$. The standard error of a single coefficient estimate $\\hat{c}_j$ is the square root of the corresponding diagonal element of this matrix, $SE(\\hat{c}_j) = \\sqrt{[\\text{Cov}(\\hat{c}_{full})]_{jj}}$.\n\nTo test the significance of $c_j$ (i.e., $H_0: c_j = 0$), we use a Z-test, since $\\sigma$ is known. The test statistic is:\n$$\nZ_j = \\frac{\\hat{c}_j}{SE(\\hat{c}_j)}\n$$\nUnder the null hypothesis $c_j=0$, $Z_j$ follows a standard normal distribution, $Z_j \\sim \\mathcal{N}(0, 1)$. This is a two-sided test, and we apply the same Bonferroni-corrected significance level $\\alpha' = \\alpha/3$. We reject the null hypothesis that $c_j=0$ if $|Z_j| > z_{1-\\alpha'/2}$, where $z_{1-\\alpha'/2}$ is the $(1-\\alpha'/2)$ quantile of the standard normal distribution.\n\n### 4. Algorithmic Classification Rule\nThe final classification is determined by the following step-by-step algorithm:\n\n1.  For each potential source type $k \\in \\{M, D, Q\\}$:\n    a.  Perform the GLR test to check if the data is compatible with the hypothesis $H_k$. The type is plausible if we do not reject $H_k$ at the Bonferroni-corrected level $\\alpha'$.\n    b.  Perform the Z-test to check if the corresponding defining coefficient ($c_0$ for $M$, $c_1$ for $D$, $c_2$ for $Q$) is significantly different from zero, also at level $\\alpha'$.\n2.  A source type is formally \"accepted\" if it satisfies both conditions (a) and (b).\n3.  If no source types are accepted, the classification result is \"none\", encoded as $-1$.\n4.  If one or more source types are accepted, the final classification is the one with the smallest restricted residual sum of squares ($RSS_M$, $RSS_D$, or $RSS_Q$). This selects the simplest plausible model that best fits the data.\n\nThe implementation involves generating synthetic data using a fixed random seed for reproducibility, performing the series of least-squares fits to obtain the necessary RSS values and coefficient estimates, and then systematically applying the statistical tests and classification logic described above.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2, norm\n\ndef classify_source(N, c0_true, c1_true, c2_true, sigma, alpha, rng):\n    \"\"\"\n    Classifies an acoustic source based on synthetic far-field pressure data.\n    \n    Args:\n        N (int): Number of measurement points.\n        c0_true (float): True monopole coefficient.\n        c1_true (float): True dipole coefficient.\n        c2_true (float): True quadrupole coefficient.\n        sigma (float): Standard deviation of Gaussian measurement noise.\n        alpha (float): Family-wise significance level for hypothesis tests.\n        rng (np.random.Generator): NumPy random number generator instance.\n\n    Returns:\n        int: Classification code (0: monopole, 1: dipole, 2: quadrupole, -1: none).\n    \"\"\"\n    # 1. Generate synthetic data\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    phi0 = np.ones(N)\n    phi1 = np.cos(theta)\n    phi2 = np.cos(2 * theta)\n    \n    y_true = c0_true * phi0 + c1_true * phi1 + c2_true * phi2\n    noise = rng.normal(loc=0.0, scale=sigma, size=N)\n    y = y_true + noise\n\n    # 2. Fit full and restricted models using Ordinary Least Squares\n    # Full model: y = c0*phi0 + c1*phi1 + c2*phi2\n    X_full = np.stack([phi0, phi1, phi2], axis=1)\n    c_full, rss_full_arr, _, _ = np.linalg.lstsq(X_full, y, rcond=None)\n    # np.linalg.lstsq returns rss as a 0-d array if y is 1-d\n    rss_full = rss_full_arr[0] if rss_full_arr.size > 0 else 0.0\n\n    # Restricted models\n    # Monopole (H_M): y = c0*phi0\n    X_M = phi0[:, np.newaxis]\n    _, rss_M_arr, _, _ = np.linalg.lstsq(X_M, y, rcond=None)\n    rss_M = rss_M_arr[0] if rss_M_arr.size > 0 else 0.0\n\n    # Dipole (H_D): y = c1*phi1\n    X_D = phi1[:, np.newaxis]\n    _, rss_D_arr, _, _ = np.linalg.lstsq(X_D, y, rcond=None)\n    rss_D = rss_D_arr[0] if rss_D_arr.size > 0 else 0.0\n\n    # Quadrupole (H_Q): y = c2*phi2\n    X_Q = phi2[:, np.newaxis]\n    _, rss_Q_arr, _, _ = np.linalg.lstsq(X_Q, y, rcond=None)\n    rss_Q = rss_Q_arr[0] if rss_Q_arr.size > 0 else 0.0\n\n    # 3. Perform hypothesis tests with Bonferroni correction\n    alpha_corr = alpha / 3.0\n    \n    # 3a. Generalized Likelihood Ratio (GLR) tests\n    # Test statistic is (RSS_restr - RSS_full)/sigma^2 ~ chi2(df=2)\n    # Degrees of freedom for constraints (q) = 3 (full) - 1 (restr) = 2\n    chi2_crit = chi2.ppf(1 - alpha_corr, df=2)\n    \n    lambda_M = (rss_M - rss_full) / (sigma**2)\n    is_plausible_M = lambda_M <= chi2_crit\n    \n    lambda_D = (rss_D - rss_full) / (sigma**2)\n    is_plausible_D = lambda_D <= chi2_crit\n\n    lambda_Q = (rss_Q - rss_full) / (sigma**2)\n    is_plausible_Q = lambda_Q <= chi2_crit\n    \n    # 3b. Coefficient significance Z-tests\n    # Cov(c_hat) = sigma^2 * (X'X)^-1\n    try:\n        cov_c_full = sigma**2 * np.linalg.inv(X_full.T @ X_full)\n        se_c_full = np.sqrt(np.diag(cov_c_full))\n    except np.linalg.LinAlgError:\n        # This case is unlikely with the problem's parameters but is good practice\n        return -1\n\n    z_crit = norm.ppf(1 - alpha_corr / 2.0)\n    \n    is_significant_0 = np.abs(c_full[0] / se_c_full[0]) > z_crit\n    is_significant_1 = np.abs(c_full[1] / se_c_full[1]) > z_crit\n    is_significant_2 = np.abs(c_full[2] / se_c_full[2]) > z_crit\n\n    # 4. Apply classification logic\n    accepted_types = []\n    \n    if is_plausible_M and is_significant_0:\n        accepted_types.append({'rss': rss_M, 'type': 0})\n    \n    if is_plausible_D and is_significant_1:\n        accepted_types.append({'rss': rss_D, 'type': 1})\n        \n    if is_plausible_Q and is_significant_2:\n        accepted_types.append({'rss': rss_Q, 'type': 2})\n\n    if not accepted_types:\n        return -1\n    else:\n        # Select the accepted type with the minimum restricted RSS\n        best_type = min(accepted_types, key=lambda x: x['rss'])\n        return best_type['type']\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Use a single random number generator for all test cases for determinism.\n    rng = np.random.default_rng(12345)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, c0, c1, c2, sigma, alpha)\n        (360, 2.0, 0.0, 0.0, 0.05, 0.05), # Case 1: Monopole\n        (180, 0.0, 1.0, 0.0, 0.10, 0.01), # Case 2: Dipole\n        (90, 0.0, 0.0, 1.5, 0.30, 0.05), # Case 3: Quadrupole\n        (120, 0.5, 0.5, 0.0, 0.05, 0.05), # Case 4: Mixture\n        (100, 0.0, 0.0, 0.0, 0.20, 0.05), # Case 5: Noise-only\n    ]\n\n    results = []\n    for case in test_cases:\n        N, c0, c1, c2, sigma, alpha = case\n        result = classify_source(N, c0, c1, c2, sigma, alpha, rng)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}