{
    "hands_on_practices": [
        {
            "introduction": "Moving from the continuous wave equation to a discrete numerical scheme introduces critical constraints that govern whether a simulation is meaningful. For explicit time-domain methods, the most fundamental of these is the stability condition, which prevents unphysical, exponential growth of errors. This practice guides you through a von Neumann stability analysis to derive the celebrated Courant-Friedrichs-Lewy (CFL) condition for a standard finite-difference scheme in multiple dimensions, a cornerstone of computational wave physics .",
            "id": "4144094",
            "problem": "Consider small-amplitude, lossless acoustic disturbances in a homogeneous medium of constant mass density $\\rho_{0}$ and sound speed $c$. Starting from the linearized conservation of momentum and mass, together with the isentropic equation of state, one may combine these laws to obtain a scalar wave equation for the acoustic pressure perturbation $p(\\mathbf{x},t)$ of the form $\\partial^{2} p / \\partial t^{2} = c^{2} \\nabla^{2} p$ in $d$ spatial dimensions. On a tensor-product uniform grid with spacings $\\Delta x_{i}$ along each coordinate axis $x_{i}$ for $i=1,\\dots,d$, and with time step $\\Delta t$, consider the explicit second-order central-difference finite-difference scheme obtained by approximating the second derivatives in time and space using centered differences at grid index $\\mathbf{j} = (j_{1},\\dots,j_{d})$ and time level $n$:\n$$\n\\frac{p_{\\mathbf{j}}^{n+1} - 2 p_{\\mathbf{j}}^{n} + p_{\\mathbf{j}}^{n-1}}{\\Delta t^{2}} \\;=\\; c^{2} \\sum_{i=1}^{d} \\frac{p_{\\mathbf{j}+\\mathbf{e}_{i}}^{n} - 2 p_{\\mathbf{j}}^{n} + p_{\\mathbf{j}-\\mathbf{e}_{i}}^{n}}{\\Delta x_{i}^{2}},\n$$\nwhere $\\mathbf{e}_{i}$ is the unit offset in the $i$th coordinate direction. Assume periodic boundary conditions so that Fourier analysis in space applies. Analyze the stability of this fully discrete scheme by requiring that discrete Fourier modes do not grow in magnitude over time. Derive the maximum allowable time step $\\Delta t_{\\max}$ for stability as a closed-form analytic expression in terms of $c$ and the spacings $\\Delta x_{i}$. Express your final answer for $\\Delta t_{\\max}$ in seconds. No rounding is required.",
            "solution": "The user wants to find the stability condition for a finite-difference scheme applied to the acoustic wave equation.\n\n### Step 1: Problem Validation\n\n**Extraction of Givens:**\n-   **Governing Equation:** The $d$-dimensional scalar acoustic wave equation for pressure perturbation $p(\\mathbf{x}, t)$ is $\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2} \\nabla^{2} p$.\n-   **Medium Properties:** The medium is homogeneous with constant mass density $\\rho_{0}$ and constant sound speed $c$. The process involves small-amplitude, lossless disturbances.\n-   **Discretization:** The domain is discretized on a tensor-product uniform grid with spatial steps $\\Delta x_{i}$ for $i=1,\\dots,d$, and a time step $\\Delta t$.\n-   **Finite-Difference Scheme:** At grid point $\\mathbf{j}=(j_1, \\dots, j_d)$ and time level $n$, the scheme is given by:\n    $$\n    \\frac{p_{\\mathbf{j}}^{n+1} - 2 p_{\\mathbf{j}}^{n} + p_{\\mathbf{j}}^{n-1}}{\\Delta t^{2}} \\;=\\; c^{2} \\sum_{i=1}^{d} \\frac{p_{\\mathbf{j}+\\mathbf{e}_{i}}^{n} - 2 p_{\\mathbf{j}}^{n} + p_{\\mathbf{j}-\\mathbf{e}_{i}}^{n}}{\\Delta x_{i}^{2}}\n    $$\n    where $\\mathbf{e}_{i}$ is the unit offset vector in the $i$-th coordinate direction.\n-   **Boundary Conditions:** Periodic boundary conditions are assumed.\n-   **Objective:** Derive the maximum allowable time step, $\\Delta t_{\\max}$, for stability by ensuring that discrete Fourier modes do not grow in magnitude over time.\n\n**Validation Verdict:**\nThe problem is **valid**.\n1.  **Scientific Grounding:** The problem is based on the well-established linear acoustic wave equation and a standard second-order finite-difference scheme. The method of analysis, von Neumann stability analysis, is a canonical technique in numerical analysis for PDEs.\n2.  **Well-Posedness:** The problem is well-posed. It asks for the derivation of a stability condition for a fully specified numerical method, which leads to a unique and meaningful result.\n3.  **Objectivity:** The problem is stated in precise, objective mathematical language.\n4.  **Completeness:** All necessary information (the PDE, the numerical scheme, the analysis method) is provided.\n\nThe problem is a standard, non-trivial exercise in computational acoustics and numerical analysis.\n\n### Step 2: Solution Derivation\n\nThe stability of the finite-difference scheme is analyzed using the von Neumann stability analysis method. This method involves substituting a single Fourier mode into the discrete equation and determining the conditions under which the amplitude of this mode does not grow in time.\n\nA general solution $p_{\\mathbf{j}}^{n}$ can be expressed as a superposition of Fourier modes. Due to the linearity of the scheme, we only need to analyze a single mode of the form:\n$$\np_{\\mathbf{j}}^{n} = G^{n}(\\mathbf{k}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}})\n$$\nwhere $\\mathbf{k} = (k_1, \\dots, k_d)$ is the wavevector, $\\mathbf{x}_{\\mathbf{j}} = (j_1 \\Delta x_1, \\dots, j_d \\Delta x_d)$ is the position vector of the grid node $\\mathbf{j}$, and $G(\\mathbf{k})$ is the amplification factor for the mode with wavevector $\\mathbf{k}$. For simplicity, $G$ is written instead of $G(\\mathbf{k})$. The stability of the scheme requires that $|G| \\leq 1$ for all possible wavevectors $\\mathbf{k}$.\n\nLet's define the non-dimensional wavenumber components as $\\xi_i = k_i \\Delta x_i$. The dot product in the exponential becomes $\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}} = \\sum_{l=1}^{d} k_l j_l \\Delta x_l = \\sum_{l=1}^{d} j_l \\xi_l$.\nThe spatial-shift terms can be written as:\n$$\np_{\\mathbf{j}+\\mathbf{e}_{i}}^{n} = G^{n} \\exp\\left(i \\left( \\sum_{l=1}^{d} j_l \\xi_l + \\xi_i \\right) \\right) = p_{\\mathbf{j}}^{n} \\exp(i\\xi_i)\n$$\n$$\np_{\\mathbf{j}-\\mathbf{e}_{i}}^{n} = G^{n} \\exp\\left(i \\left( \\sum_{l=1}^{d} j_l \\xi_l - \\xi_i \\right) \\right) = p_{\\mathbf{j}}^{n} \\exp(-i\\xi_i)\n$$\nSubstituting the Fourier mode ansatz into the finite-difference scheme:\n$$\n\\frac{G^{n+1}p_{\\mathbf{j}}^{0} - 2G^{n}p_{\\mathbf{j}}^{0} + G^{n-1}p_{\\mathbf{j}}^{0}}{\\Delta t^{2}} = c^{2} \\sum_{i=1}^{d} \\frac{G^{n}p_{\\mathbf{j}}^{0}(\\exp(i\\xi_i) - 2 + \\exp(-i\\xi_i))}{\\Delta x_{i}^{2}}\n$$\nwhere $p_{\\mathbf{j}}^{0} = \\exp(i\\sum_l j_l \\xi_l)$. We can divide out the common, non-zero factor $G^{n-1}p_{\\mathbf{j}}^{0}$:\n$$\n\\frac{G^{2} - 2G + 1}{\\Delta t^{2}} = G \\left( c^{2} \\sum_{i=1}^{d} \\frac{\\exp(i\\xi_i) - 2 + \\exp(-i\\xi_i)}{\\Delta x_{i}^{2}} \\right)\n$$\nUsing the identity $2\\cos(\\theta) = \\exp(i\\theta) + \\exp(-i\\theta)$, the term in the parenthesis becomes $2\\cos(\\xi_i) - 2$. We can further simplify this using the half-angle identity $1-\\cos(\\theta) = 2\\sin^{2}(\\theta/2)$, which gives $2\\cos(\\xi_i) - 2 = -4\\sin^{2}(\\xi_i/2)$.\nSubstituting this back into the equation yields:\n$$\n\\frac{(G-1)^{2}}{\\Delta t^{2}} = G \\left( c^{2} \\sum_{i=1}^{d} \\frac{-4\\sin^{2}(\\xi_i/2)}{\\Delta x_{i}^{2}} \\right)\n$$\n$$\n(G-1)^{2} = -G \\left( 4c^{2}\\Delta t^{2} \\sum_{i=1}^{d} \\frac{\\sin^{2}(\\xi_i/2)}{\\Delta x_{i}^{2}} \\right)\n$$\nLet us define the non-negative real quantity $A$ as:\n$$\nA = 4c^{2}\\Delta t^{2} \\sum_{i=1}^{d} \\frac{\\sin^{2}(\\xi_i/2)}{\\Delta x_{i}^{2}}\n$$\nThe equation for the amplification factor $G$ becomes:\n$$\n(G-1)^{2} = -AG\n$$\n$$\nG^{2} - 2G + 1 = -AG\n$$\n$$\nG^{2} + (A-2)G + 1 = 0\n$$\nThis is a quadratic equation for $G$. The roots are given by:\n$$\nG = \\frac{-(A-2) \\pm \\sqrt{(A-2)^{2} - 4}}{2}\n$$\nThe stability condition $|G| \\leq 1$ must hold for both roots.\n\nWe analyze the roots based on the value of the discriminant, $(A-2)^{2} - 4$.\nCase 1: $(A-2)^{2} - 4  0$. This corresponds to $0  A  4$.\nIn this case, the roots are a complex conjugate pair:\n$$\nG = \\frac{2-A \\pm i\\sqrt{4 - (A-2)^{2}}}{2}\n$$\nThe magnitude of the roots is:\n$$\n|G|^{2} = \\left(\\frac{2-A}{2}\\right)^{2} + \\left(\\frac{\\sqrt{4 - (A-2)^{2}}}{2}\\right)^{2} = \\frac{(2-A)^{2} + 4 - (A-2)^{2}}{4} = \\frac{4}{4} = 1\n$$\nSo, for $0  A  4$, we have $|G|=1$. The scheme is stable.\n\nCase 2: $(A-2)^{2} - 4 \\geq 0$. Since $A \\geq 0$, this condition is satisfied for $A \\geq 4$ or $A=0$.\nIf $A=0$ (the trivial case of zero wavenumber), the equation becomes $(G-1)^2=0$, giving $G=1$, which is stable.\nIf $A=4$, the equation becomes $(G+1)^2=0$, giving $G=-1$, so $|G|=1$, which is stable.\nIf $A  4$, the discriminant is positive, and the roots are real and distinct. The product of the roots, from Vieta's formulas for $G^{2} + (A-2)G + 1 = 0$, is $G_1 G_2 = 1$. If the roots are real and their product is $1$, one root must have a magnitude greater than $1$ (unless both are $\\pm 1$, which only happens for $A=0$ or $A=4$). Therefore, for $A  4$, the scheme is unstable.\n\nCombining the cases, the necessary and sufficient condition for stability is $A \\leq 4$.\nThis condition must hold for all possible wavevectors $\\mathbf{k}$, which means it must hold for the maximum possible value of $A$. The maximum value of $A$ occurs when the term $\\sin^{2}(\\xi_i/2) = \\sin^{2}(k_i \\Delta x_i/2)$ is maximized for all $i$. The maximum value of $\\sin^{2}(\\theta)$ is $1$. This occurs for the highest frequency modes resolvable by the grid (the Nyquist frequency, where $k_i \\Delta x_i = \\pi$).\nThus, the most stringent condition is:\n$$\nA_{\\max} = 4c^{2}\\Delta t^{2} \\sum_{i=1}^{d} \\frac{1}{\\Delta x_{i}^{2}} \\leq 4\n$$\nSolving this inequality for $\\Delta t$:\n$$\nc^{2}\\Delta t^{2} \\left( \\sum_{i=1}^{d} \\frac{1}{\\Delta x_{i}^{2}} \\right) \\leq 1\n$$\n$$\n\\Delta t^{2} \\leq \\frac{1}{c^{2} \\left( \\sum_{i=1}^{d} \\frac{1}{\\Delta x_{i}^{2}} \\right)}\n$$\n$$\n\\Delta t \\leq \\frac{1}{c \\sqrt{\\sum_{i=1}^{d} \\frac{1}{\\Delta x_{i}^{2}}}}\n$$\nThe maximum allowable time step, $\\Delta t_{\\max}$, is the upper bound of this inequality, known as the Courant-Friedrichs-Lewy (CFL) condition for this scheme. If the units for $c$ are meters per second and for $\\Delta x_i$ are meters, the resulting unit for $\\Delta t_{\\max}$ is seconds.",
            "answer": "$$\\boxed{\\frac{1}{c \\sqrt{\\sum_{i=1}^{d} \\frac{1}{\\Delta x_{i}^{2}}}}}$$"
        },
        {
            "introduction": "While stability ensures a simulation does not diverge, it does not guarantee accuracy. A primary source of error in simulating wave propagation is numerical dispersion, where the numerical phase velocity of a wave becomes dependent on its frequency and the grid resolution, causing wave packets to distort. In this exercise, you will dissect the popular second-order finite-difference scheme to derive its numerical dispersion relation and quantify the resulting phase velocity error, a crucial step in understanding the fidelity of a numerical wave simulation .",
            "id": "4144103",
            "problem": "Consider the one-dimensional ($1$-D) linear acoustic wave equation for the acoustic pressure $p(x,t)$ in a homogeneous medium with constant sound speed $c$, given by\n$$\n\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} p}{\\partial x^{2}}.\n$$\nOn a uniform spatial grid with spacing $\\Delta x$ and a uniform time step $\\Delta t$, approximate both temporal and spatial second derivatives with centered, second-order accurate finite differences, yielding the explicit update relation\n$$\n\\frac{p_{i}^{n+1} - 2 p_{i}^{n} + p_{i}^{n-1}}{\\Delta t^{2}} = c^{2} \\frac{p_{i+1}^{n} - 2 p_{i}^{n} + p_{i-1}^{n}}{\\Delta x^{2}},\n$$\nwhere $p_{i}^{n}$ approximates $p(x_{i}, t^{n})$ at $x_{i} = i \\Delta x$ and $t^{n} = n \\Delta t$. Assume periodic boundary conditions so that discrete plane waves are admissible, and perform a von Neumann Fourier analysis by substituting a discrete plane-wave ansatz of the form $p_{i}^{n} = \\hat{p} \\exp\\!\\big(\\mathrm{i}(k\\, i\\, \\Delta x - \\omega\\, n\\, \\Delta t)\\big)$, where $k$ is the wavenumber and $\\omega$ is the angular frequency.\n\nDefine the Courant–Friedrichs–Lewy (CFL) number $\\sigma = \\dfrac{c\\, \\Delta t}{\\Delta x}$ and the nondimensional wavenumber $\\kappa = k \\Delta x$. Starting from the governing equation above and the stated discretization, derive the discrete dispersion relation connecting $\\omega$ and $k$, and from it obtain the numerical phase velocity $v_{p} = \\dfrac{\\omega}{k}$. Express the ratio of the numerical phase velocity to the physical sound speed $c$ as a single closed-form analytic expression in terms of $\\sigma$ and $\\kappa$.\n\nYour final answer must be this single expression for $\\dfrac{v_{p}}{c}$. No numerical evaluation is required, and no rounding is necessary. The result is dimensionless, so do not include units in your final expression.",
            "solution": "The user wants to derive the ratio of the numerical phase velocity to the physical sound speed for a finite-difference discretization of the 1-D linear acoustic wave equation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Governing Equation**: The 1-D linear acoustic wave equation is $\\dfrac{\\partial^{2} p}{\\partial t^{2}} = c^{2} \\dfrac{\\partial^{2} p}{\\partial x^{2}}$.\n-   **Finite Difference Scheme**: The explicit update relation is $\\dfrac{p_{i}^{n+1} - 2 p_{i}^{n} + p_{i}^{n-1}}{\\Delta t^{2}} = c^{2} \\dfrac{p_{i+1}^{n} - 2 p_{i}^{n} + p_{i-1}^{n}}{\\Delta x^{2}}$.\n-   **Notation**: $p_{i}^{n}$ approximates $p(x_{i}, t^{n})$ at $x_{i} = i \\Delta x$ and $t^{n} = n \\Delta t$.\n-   **Boundary Conditions**: Periodic boundary conditions are assumed.\n-   **Ansatz**: A discrete plane-wave solution of the form $p_{i}^{n} = \\hat{p} \\exp\\!\\big(\\mathrm{i}(k\\, i\\, \\Delta x - \\omega\\, n\\, \\Delta t)\\big)$ is to be used.\n-   **Definitions**:\n    -   Courant–Friedrichs–Lewy (CFL) number: $\\sigma = \\dfrac{c\\, \\Delta t}{\\Delta x}$.\n    -   Nondimensional wavenumber: $\\kappa = k \\Delta x$.\n-   **Objective**: Derive a closed-form expression for the ratio of the numerical phase velocity $v_{p} = \\dfrac{\\omega}{k}$ to the physical sound speed $c$, i.e., $\\dfrac{v_{p}}{c}$, in terms of $\\sigma$ and $\\kappa$.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem is built upon fundamental concepts in physics (the wave equation) and numerical analysis (finite difference methods, von Neumann analysis). The procedure described is a standard and essential technique for analyzing the properties of numerical schemes for solving partial differential equations. The problem is scientifically and factually sound.\n-   **Well-Posed**: The problem provides all necessary equations and definitions to carry out the derivation. The objective is clearly stated, and a unique analytical solution exists.\n-   **Objective**: The problem is stated in precise, mathematical language, free from any subjective or ambiguous terminology.\n-   **Self-Contained and Consistent**: The givens are sufficient and consistent. No external information or unstated assumptions are needed.\n-   **Other Flaws**: The problem does not exhibit any of the flaws listed in the validation checklist, such as being non-formalizable, incomplete, unrealistic, ill-posed, or trivial.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. I will proceed with the derivation of the solution.\n\n### Derivation of the Numerical Phase Velocity\n\nThe starting point is the provided finite-difference approximation of the 1-D wave equation:\n$$\n\\frac{p_{i}^{n+1} - 2 p_{i}^{n} + p_{i}^{n-1}}{\\Delta t^{2}} = c^{2} \\frac{p_{i+1}^{n} - 2 p_{i}^{n} + p_{i-1}^{n}}{\\Delta x^{2}}\n$$\nWe perform a von Neumann Fourier analysis by substituting the discrete plane-wave ansatz $p_{i}^{n} = \\hat{p} \\exp\\!\\big(\\mathrm{i}(k x_i - \\omega t_n)\\big)$, where $x_i = i \\Delta x$ and $t_n = n \\Delta t$.\nThe different terms in the finite-difference equation can be expressed as:\n-   $p_{i}^{n} = \\hat{p} \\exp(\\mathrm{i}(k i \\Delta x - \\omega n \\Delta t))$\n-   $p_{i}^{n+1} = \\hat{p} \\exp(\\mathrm{i}(k i \\Delta x - \\omega (n+1) \\Delta t)) = p_{i}^{n} \\exp(-\\mathrm{i}\\omega \\Delta t)$\n-   $p_{i}^{n-1} = \\hat{p} \\exp(\\mathrm{i}(k i \\Delta x - \\omega (n-1) \\Delta t)) = p_{i}^{n} \\exp(\\mathrm{i}\\omega \\Delta t)$\n-   $p_{i+1}^{n} = \\hat{p} \\exp(\\mathrm{i}(k (i+1) \\Delta x - \\omega n \\Delta t)) = p_{i}^{n} \\exp(\\mathrm{i}k \\Delta x)$\n-   $p_{i-1}^{n} = \\hat{p} \\exp(\\mathrm{i}(k (i-1) \\Delta x - \\omega n \\Delta t)) = p_{i}^{n} \\exp(-\\mathrm{i}k \\Delta x)$\n\nSubstituting these expressions into the finite-difference equation yields:\n$$\n\\frac{p_{i}^{n} \\exp(-\\mathrm{i}\\omega \\Delta t) - 2 p_{i}^{n} + p_{i}^{n} \\exp(\\mathrm{i}\\omega \\Delta t)}{\\Delta t^{2}} = c^{2} \\frac{p_{i}^{n} \\exp(\\mathrm{i}k \\Delta x) - 2 p_{i}^{n} + p_{i}^{n} \\exp(-\\mathrm{i}k \\Delta x)}{\\Delta x^{2}}\n$$\nAssuming a non-trivial solution ($p_{i}^{n} \\neq 0$), we can divide through by $p_{i}^{n}$:\n$$\n\\frac{\\exp(\\mathrm{i}\\omega \\Delta t) + \\exp(-\\mathrm{i}\\omega \\Delta t) - 2}{\\Delta t^{2}} = c^{2} \\frac{\\exp(\\mathrm{i}k \\Delta x) + \\exp(-\\mathrm{i}k \\Delta x) - 2}{\\Delta x^{2}}\n$$\nUsing Euler's formula, $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)}{2}$, the equation becomes:\n$$\n\\frac{2\\cos(\\omega \\Delta t) - 2}{\\Delta t^{2}} = c^{2} \\frac{2\\cos(k \\Delta x) - 2}{\\Delta x^{2}}\n$$\nWe apply the trigonometric half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$, which implies $2\\cos(\\theta) - 2 = -4\\sin^2(\\frac{\\theta}{2})$.\nSubstituting this into the equation gives:\n$$\n\\frac{-4 \\sin^{2}\\left(\\frac{\\omega \\Delta t}{2}\\right)}{\\Delta t^{2}} = c^{2} \\frac{-4 \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x^{2}}\n$$\nCanceling the factor of $-4$ from both sides, we get:\n$$\n\\frac{\\sin^{2}\\left(\\frac{\\omega \\Delta t}{2}\\right)}{\\Delta t^{2}} = c^{2} \\frac{\\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x^{2}}\n$$\nTaking the square root of both sides, and assuming $\\omega$ and $k$ are positive for a forward-propagating wave, the arguments of the sine functions will be in a range where sine is positive, so we can write:\n$$\n\\frac{\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right)}{\\Delta t} = \\frac{c}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThis is the numerical dispersion relation. Now, we introduce the specified nondimensional parameters: the CFL number $\\sigma = \\dfrac{c \\Delta t}{\\Delta x}$ and the nondimensional wavenumber $\\kappa = k \\Delta x$.\nMultiplying the equation by $\\Delta t$, we have:\n$$\n\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = \\frac{c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) = \\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\n$$\nWe now solve for the angular frequency $\\omega$:\n$$\n\\frac{\\omega \\Delta t}{2} = \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\n$$\n\\omega = \\frac{2}{\\Delta t} \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\nThe numerical phase velocity is defined as $v_{p} = \\dfrac{\\omega}{k}$. Substituting the expression for $\\omega$:\n$$\nv_{p} = \\frac{1}{k} \\left( \\frac{2}{\\Delta t} \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right) \\right) = \\frac{2}{k \\Delta t} \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\nThe problem asks for the ratio of the numerical phase velocity to the physical sound speed, $\\dfrac{v_{p}}{c}$:\n$$\n\\frac{v_{p}}{c} = \\frac{2}{c k \\Delta t} \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\nTo express the pre-factor in terms of $\\sigma$ and $\\kappa$, we use their definitions:\n$$\nc k \\Delta t = \\left(\\frac{c \\Delta t}{\\Delta x}\\right) (k \\Delta x) = \\sigma \\kappa\n$$\nSubstituting this result into the expression for $\\dfrac{v_{p}}{c}$, we obtain the final closed-form expression:\n$$\n\\frac{v_{p}}{c} = \\frac{2}{\\sigma \\kappa} \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\nThis expression quantifies the numerical dispersion of the scheme, showing how the speed of a discrete plane wave depends on its wavenumber $k$ and the discretization parameters $\\Delta x$ and $\\Delta t$.",
            "answer": "$$\\boxed{\\frac{2}{\\sigma \\kappa} \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)}$$"
        },
        {
            "introduction": "The final bridge between numerical theory and reliable results is the process of verification: ensuring your code correctly solves the intended mathematical equations. This hands-on programming exercise consolidates the concepts of stability and accuracy by tasking you with building and testing a complete finite-difference time-domain (FDTD) solver. By performing a grid convergence study and comparing your results against a known analytic solution, you will empirically measure your solver's order of accuracy, a fundamental practice in computational science for building confidence in a numerical tool .",
            "id": "4144095",
            "problem": "Consider the one-dimensional propagation of small-amplitude acoustic pressure disturbances in a homogeneous, lossless medium with constant equilibrium density and speed of sound. Starting from first principles, use the linearized momentum balance, linearized mass conservation, and a linear equation of state to establish the governing equation for the acoustic pressure. Then, construct a numerical solver based on a second-order explicit finite-difference time-domain scheme.\n\nYour tasks are:\n\n- Derive the governing partial differential equation for the acoustic pressure field $p(x,t)$ in one spatial dimension from appropriate linearized continuum laws. Use the following context-appropriate fundamental base: the linearized momentum equation $ \\rho_0 \\,\\partial v/\\partial t = -\\,\\partial p/\\partial x $, the linearized continuity equation $ \\partial \\rho/\\partial t + \\rho_0 \\,\\partial v/\\partial x = 0 $, and a linear equation of state $ p = c^2 \\rho $, where $ \\rho_0 $ is the constant equilibrium density, $ c $ is the constant speed of sound, and $ v(x,t) $ is the particle velocity.\n- Construct a second-order accurate explicit finite-difference time-domain scheme (Finite-Difference Time-Domain (FDTD)) on a uniform spatial grid for $p(x,t)$. Use central differences in space and time, and enforce either periodic or homogeneous Dirichlet boundary conditions, depending on the test case. Do not import or assume any target update formulas; derive them from Taylor expansions and central-difference approximations.\n- For each test case, choose an analytic solution that exactly satisfies the chosen boundary conditions and the governing equation. Initialize the discrete pressure field and its first time level using the analytic solution at $t=0$ and $t=\\Delta t$, respectively, so that the two-step explicit scheme can start without requiring auxiliary approximations for the first step.\n- Perform a grid convergence study: for a set of spatial resolutions $h$ (uniform mesh sizes), integrate the solution to a fixed physical time $T$ (in seconds), compute the discrete spatial $L^2$ error at $t=T$, and fit the observed error $E(h)$ versus $h$ on a log-log scale to estimate the observed order of accuracy $p$ according to $ E(h) \\approx C\\,h^p $. Use a linear least-squares fit of $\\log(E)$ versus $\\log(h)$; report the fitted slope $p$.\n- Use a time step $ \\Delta t $ chosen from a Courant-Friedrichs-Lewy (CFL) condition $ \\mathrm{CFL} = c\\,\\Delta t / h $ with $ \\mathrm{CFL}  1 $ for stability. To hit the final time $T$ exactly while respecting stability, first compute the nominal time step $ \\Delta t_\\mathrm{CFL} = \\mathrm{CFL}\\,h/c $, then choose the number of steps $N_t = \\lceil T/\\Delta t_\\mathrm{CFL} \\rceil$, and set $ \\Delta t = T/N_t $.\n\nDefinitions and numerical details:\n\n- Spatial domain: $ x \\in [0,L] $ with $L$ in meters, speed of sound $ c $ in meters per second, and time $ t $ in seconds.\n- Discrete spatial $L^2$ error at $t=T$: $ E(h) = \\sqrt{ \\sum_{i} \\big(p_i(T) - p_\\mathrm{exact}(x_i,T)\\big)^2\\,h } $, where $ p_i(T) $ is the numerical solution at grid node $ x_i $ and time $T$, and $ p_\\mathrm{exact}(x_i,T) $ is the analytic solution evaluated at $ x_i $ and $ T $.\n- Angle unit: use radians for all trigonometric functions.\n- Physical units: use meters for $L$, meters per second for $c$, and seconds for $T$.\n- Report each observed order $p$ as a floating-point number rounded to $3$ decimal places.\n\nTest suite and parameter coverage:\n\nProvide results for the following three test cases, which probe different boundary conditions and spectral content.\n\n- Case $1$ (periodic boundary, fundamental mode):\n  - Parameters: $ L = 1\\,\\mathrm{m} $, $ c = 343\\,\\mathrm{m/s} $, $ T = 0.001\\,\\mathrm{s} $, $ \\mathrm{CFL} = 0.9 $, wavenumber index $ m = 1 $.\n  - Analytic solution: $ p(x,t) = \\sin\\!\\big( 2\\pi m x / L \\big)\\,\\cos\\!\\big( \\omega t \\big) $ with $ \\omega = c \\, 2\\pi m / L $.\n  - Mesh sizes (number of nodes for periodic grid): $ N_x \\in \\{ 50, 100, 200, 400 \\} $.\n  - Use a uniform grid with spacing $ h = L/N_x $ and periodic wrap for neighbors.\n\n- Case $2$ (homogeneous Dirichlet boundary, second harmonic):\n  - Parameters: $ L = 1\\,\\mathrm{m} $, $ c = 343\\,\\mathrm{m/s} $, $ T = 0.001\\,\\mathrm{s} $, $ \\mathrm{CFL} = 0.9 $, mode index $ m = 2 $.\n  - Analytic solution: $ p(x,t) = \\sin\\!\\big( \\pi m x / L \\big)\\,\\cos\\!\\big( \\omega t \\big) $ with $ \\omega = c \\, \\pi m / L $, which satisfies $ p(0,t) = p(L,t) = 0 $.\n  - Mesh sizes (number of nodes including boundaries): $ N_x \\in \\{ 50, 100, 200, 400 \\} $.\n  - Use a uniform grid with spacing $ h = L/(N_x-1) $ and set boundary nodes to zero at all time levels.\n\n- Case $3$ (periodic boundary, higher mode on coarser grids to probe pre-asymptotic behavior):\n  - Parameters: $ L = 1\\,\\mathrm{m} $, $ c = 343\\,\\mathrm{m/s} $, $ T = 0.001\\,\\mathrm{s} $, $ \\mathrm{CFL} = 0.9 $, wavenumber index $ m = 4 $.\n  - Analytic solution: $ p(x,t) = \\sin\\!\\big( 2\\pi m x / L \\big)\\,\\cos\\!\\big( \\omega t \\big) $ with $ \\omega = c \\, 2\\pi m / L $.\n  - Mesh sizes (number of nodes for periodic grid): $ N_x \\in \\{ 20, 40, 80, 160 \\} $.\n  - Use a uniform grid with spacing $ h = L/N_x $ and periodic wrap for neighbors.\n\nRequired final output format:\n\nYour program should produce a single line of output containing the three observed orders $p$ for the test cases as a comma-separated list enclosed in square brackets, rounded to three decimal places, for example, $ [p_1,p_2,p_3] $. The program must be complete and runnable as-is and must not require any user input, external files, or network access. The only permitted libraries are the Python standard library, Numerical Python (NumPy), and Scientific Python (SciPy). The output quantities are dimensionless floating-point numbers.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the fundamental principles of linear acoustics, mathematically well-posed, and provides a complete and unambiguous specification for the derivation, numerical implementation, and analysis required.\n\n### 1. Derivation of the 1D Acoustic Wave Equation\n\nThe governing partial differential equation for the acoustic pressure $p(x,t)$ is derived from the fundamental principles of continuum mechanics, linearized for small-amplitude disturbances in a quiescent, homogeneous, and lossless medium.\n\nThe provided first-principles equations are:\n1.  The linearized momentum equation:\n    $$ \\rho_0 \\frac{\\partial v}{\\partial t} = - \\frac{\\partial p}{\\partial x} \\quad (1) $$\n    where $\\rho_0$ is the constant equilibrium density and $v(x,t)$ is the particle velocity.\n\n2.  The linearized continuity equation (mass conservation):\n    $$ \\frac{\\partial \\rho}{\\partial t} + \\rho_0 \\frac{\\partial v}{\\partial x} = 0 \\quad (2) $$\n    where $\\rho(x,t)$ is the small perturbation in density.\n\n3.  The linear equation of state:\n    $$ p = c^2 \\rho \\quad (3) $$\n    where $c$ is the constant speed of sound, which relates the acoustic pressure to the acoustic density.\n\nTo derive a single equation for the acoustic pressure $p$, we eliminate the other field variables, $v$ and $\\rho$. The process is as follows:\n\nFirst, differentiate the momentum equation $(1)$ with respect to the spatial coordinate $x$:\n$$ \\rho_0 \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial v}{\\partial t} \\right) = - \\frac{\\partial^2 p}{\\partial x^2} $$\nAssuming sufficient smoothness of the velocity field, we can interchange the order of the partial derivatives (Clairaut's theorem):\n$$ \\rho_0 \\frac{\\partial}{\\partial t} \\left( \\frac{\\partial v}{\\partial x} \\right) = - \\frac{\\partial^2 p}{\\partial x^2} \\quad (4) $$\n\nNext, from the continuity equation $(2)$, we can express the spatial derivative of velocity, $\\frac{\\partial v}{\\partial x}$, in terms of the density perturbation $\\rho$:\n$$ \\frac{\\partial v}{\\partial x} = - \\frac{1}{\\rho_0} \\frac{\\partial \\rho}{\\partial t} $$\n\nSubstitute this expression into equation $(4)$:\n$$ \\rho_0 \\frac{\\partial}{\\partial t} \\left( - \\frac{1}{\\rho_0} \\frac{\\partial \\rho}{\\partial t} \\right) = - \\frac{\\partial^2 p}{\\partial x^2} $$\nThe constant $\\rho_0$ cancels, leading to:\n$$ - \\frac{\\partial^2 \\rho}{\\partial t^2} = - \\frac{\\partial^2 p}{\\partial x^2} \\implies \\frac{\\partial^2 \\rho}{\\partial t^2} = \\frac{\\partial^2 p}{\\partial x^2} \\quad (5) $$\n\nFinally, use the linear equation of state $(3)$ to replace the density perturbation $\\rho$ with the pressure $p$. Since $c$ is a constant, we have $\\rho = p/c^2$. Differentiating this twice with respect to time yields:\n$$ \\frac{\\partial^2 \\rho}{\\partial t^2} = \\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} $$\n\nSubstituting this into equation $(5)$ gives the final governing equation:\n$$ \\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} = \\frac{\\partial^2 p}{\\partial x^2} $$\nThis is the one-dimensional homogeneous acoustic wave equation for pressure, which is conventionally written as:\n$$ \\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2} $$\n\n### 2. Derivation of the Second-Order Finite-Difference Scheme\n\nWe discretize the wave equation on a uniform spatio-temporal grid. Let $p(x_i, t_n) \\equiv p_i^n$, where $x_i = i h$ for a spatial step size $h$, and $t_n = n \\Delta t$ for a temporal step size $\\Delta t$. We approximate the second-order partial an derivatives using central finite differences, which are second-order accurate.\n\nThe Taylor series expansion of $p(t)$ around $t_n$ is:\n$$ p(t_n \\pm \\Delta t) = p(t_n) \\pm \\Delta t \\frac{\\partial p}{\\partial t}\\bigg|_{t_n} + \\frac{(\\Delta t)^2}{2!} \\frac{\\partial^2 p}{\\partial t^2}\\bigg|_{t_n} \\pm \\frac{(\\Delta t)^3}{3!} \\frac{\\partial^3 p}{\\partial t^3}\\bigg|_{t_n} + \\mathcal{O}(\\Delta t^4) $$\nAdding the expansions for $p(t_n + \\Delta t)$ and $p(t_n - \\Delta t)$ cancels the odd-order derivative terms:\n$$ p(t_{n+1}) + p(t_{n-1}) = 2 p(t_n) + (\\Delta t)^2 \\frac{\\partial^2 p}{\\partial t^2}\\bigg|_{t_n} + \\mathcal{O}(\\Delta t^4) $$\nSolving for the second time derivative, we obtain the second-order accurate central difference approximation:\n$$ \\frac{\\partial^2 p}{\\partial t^2}\\bigg|_{x_i, t_n} = \\frac{p_i^{n+1} - 2 p_i^n + p_i^{n-1}}{(\\Delta t)^2} + \\mathcal{O}(\\Delta t^2) $$\n\nAn analogous derivation for the spatial derivative at a fixed time $t_n$ yields:\n$$ \\frac{\\partial^2 p}{\\partial x^2}\\bigg|_{x_i, t_n} = \\frac{p_{i+1}^n - 2 p_i^n + p_{i-1}^n}{h^2} + \\mathcal{O}(h^2) $$\n\nSubstituting these discrete approximations into the wave equation $\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}$:\n$$ \\frac{p_i^{n+1} - 2 p_i^n + p_i^{n-1}}{(\\Delta t)^2} = c^2 \\left( \\frac{p_{i+1}^n - 2 p_i^n + p_{i-1}^n}{h^2} \\right) $$\n\nThis is an explicit scheme. To find the solution at the next time step, $p_i^{n+1}$, we rearrange the equation:\n$$ p_i^{n+1} = 2 p_i^n - p_i^{n-1} + c^2 \\frac{(\\Delta t)^2}{h^2} (p_{i+1}^n - 2 p_i^n + p_{i-1}^n) $$\nIntroducing the Courant-Friedrichs-Lewy (CFL) number, $\\lambda = \\frac{c \\Delta t}{h}$, the update formula simplifies to:\n$$ p_i^{n+1} = 2 p_i^n - p_i^{n-1} + \\lambda^2 (p_{i+1}^n - 2 p_i^n + p_{i-1}^n) $$\nThis is the final explicit Finite-Difference Time-Domain (FDTD) update rule, which is second-order accurate in both space and time, provided the scheme is stable. Stability for this scheme is ensured if $\\lambda \\le 1$.\n\n### 3. Numerical Implementation for Convergence Study\n\nThe solution is implemented in Python to perform a grid convergence study for three distinct test cases. For each case, the order of accuracy is estimated by fitting a line to the logarithm of the error versus the logarithm of the grid spacing.\n\n**Initialization**: The FDTD scheme is a two-step method, requiring data at two previous time levels ($p^n$ and $p^{n-1}$) to compute the next ($p^{n+1}$). To start the simulation without introducing a low-order starting error, we use the provided analytic solution, $p_{\\mathrm{exact}}(x,t)$, to initialize the first two time levels:\n- $p^0$: The pressure field at $t_0 = 0$, set to $p_i^0 = p_{\\mathrm{exact}}(x_i, 0)$.\n- $p^1$: The pressure field at $t_1 = \\Delta t$, set to $p_i^1 = p_{\\mathrm{exact}}(x_i, \\Delta t)$.\n\n**Time Step Selection**: To ensure stability ($\\lambda  1$) and reach the final time $T$ exactly, the time step $\\Delta t$ is determined by first computing a nominal time step based on the specified CFL number, $\\Delta t_{\\mathrm{CFL}} = \\mathrm{CFL} \\cdot h / c$. The number of time steps is then calculated as $N_t = \\lceil T / \\Delta t_{\\mathrm{CFL}} \\rceil$, and the actual time step used is $\\Delta t = T / N_t$. This guarantees that $N_t \\cdot \\Delta t = T$ and the effective CFL number is less than or equal to the specified value.\n\n**Boundary Conditions**:\n- **Periodic**: The domain wraps around such that the neighbor of the rightmost node is the leftmost node, and vice versa. This is implemented efficiently using `numpy.roll` to shift the array of pressure values, such that $p_{i-1}^n$ and $p_{i+1}^n$ are accessed for all $i$ simultaneously in a vectorized manner. For a grid with $N_x$ nodes, the spacing is $h=L/N_x$.\n- **Homogeneous Dirichlet**: The pressure at the boundaries is fixed at zero for all time, i.e., $p(0,t) = p(L,t) = 0$. In the discrete model, $p_0^n = p_{N_x-1}^n = 0$ for all $n$. The FDTD update rule is applied only to the interior grid points. For a grid with $N_x$ nodes (including boundaries), the spacing is $h=L/(N_x-1)$.\n\n**Error Calculation and Convergence**: For each test case, the simulation is run on a sequence of progressively finer grids with sizes $N_x$. At the final time $T$, the discrete spatial $L^2$ error is computed using the formula:\n$$ E(h) = \\sqrt{ \\sum_{i} \\big(p_i(T) - p_\\mathrm{exact}(x_i,T)\\big)^2\\,h } $$\nwhere $p_i(T)$ is the numerical solution and $p_\\mathrm{exact}(x_i,T)$ is the analytic solution at grid point $x_i$ and time $T$. The sum is over all grid points.\nThe theoretical convergence rate is $E(h) \\approx C h^p$, where $p$ is the order of accuracy. By taking the logarithm, we get $\\log(E) \\approx \\log(C) + p \\log(h)$. A linear least-squares fit is performed on the pairs $(\\log(h), \\log(E))$ for the different grid resolutions. The slope of the resulting line provides an estimate of the observed order of accuracy, $p$.\n\nThe implementation systematically follows these steps for each of the three specified test cases, and the fitted slope $p$ is reported for each.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    \n    def run_convergence_study(L, c, T, CFL, m, Nx_values, bc_type, k_factor, p_func):\n        \"\"\"\n        Solves one test case, performs a convergence study, and returns the observed order of accuracy.\n\n        Args:\n            L (float): Domain length.\n            c (float): Speed of sound.\n            T (float): Final simulation time.\n            CFL (float): Courant-Friedrichs-Lewy number for time step selection.\n            m (int): Mode or wavenumber index.\n            Nx_values (list): List of grid sizes (number of nodes).\n            bc_type (str): Boundary condition type ('periodic' or 'dirichlet').\n            k_factor (float): Factor in the analytic solution's wavenumber (e.g., 2*pi).\n            p_func (function): Spatial function in analytic solution (e.g., np.sin).\n\n        Returns:\n            float: The observed order of accuracy.\n        \"\"\"\n        h_values = []\n        errors = []\n\n        for Nx in Nx_values:\n            # 1. Setup grid and time step\n            if bc_type == 'periodic':\n                h = L / Nx\n                x = np.linspace(0, L, Nx, endpoint=False)\n            elif bc_type == 'dirichlet':\n                h = L / (Nx - 1)\n                x = np.linspace(0, L, Nx)\n            else:\n                raise ValueError(\"Unknown boundary condition type.\")\n            \n            h_values.append(h)\n\n            dt_cfl = CFL * h / c\n            # Ensure number of steps is an integer and final time T is met exactly\n            Nt = int(np.ceil(T / dt_cfl))\n            dt = T / Nt\n\n            # 2. Define analytic solution\n            omega = c * k_factor * m / L\n            p_exact = lambda x_grid, time: p_func(k_factor * m * x_grid / L) * np.cos(omega * time)\n\n            # 3. Initialize pressure fields at t=0 and t=dt\n            p_prev = p_exact(x, 0)\n            p_curr = p_exact(x, dt)\n            \n            # The square of the CFL number used in the update\n            lambda_sq = (c * dt / h)**2\n\n            # 4. Time-stepping loop\n            # Start from n=1, loop Nt-1 times to reach t=Nt*dt=T\n            for _ in range(1, Nt):\n                if bc_type == 'periodic':\n                    # Vectorized update using np.roll for periodic boundaries\n                    p_laplacian = np.roll(p_curr, -1) - 2 * p_curr + np.roll(p_curr, 1)\n                    p_next = 2 * p_curr - p_prev + lambda_sq * p_laplacian\n                \n                elif bc_type == 'dirichlet':\n                    p_next = np.zeros_like(p_curr)\n                    # Sliced update for interior points; boundaries remain zero\n                    p_laplacian_interior = p_curr[2:] - 2 * p_curr[1:-1] + p_curr[0:-2]\n                    p_next[1:-1] = 2 * p_curr[1:-1] - p_prev[1:-1] + lambda_sq * p_laplacian_interior\n                \n                # Advance time levels\n                p_prev, p_curr = p_curr, p_next\n\n            # 5. Compute discrete L2 error at the final time T\n            p_final_exact = p_exact(x, T)\n            error = np.sqrt(np.sum((p_curr - p_final_exact)**2 * h))\n            errors.append(error)\n\n        # 6. Perform linear regression on log-log data to find order of accuracy\n        log_h = np.log(np.array(h_values))\n        log_e = np.log(np.array(errors))\n        \n        # Fit a line (degree 1 polynomial) to the data. The slope is the order of accuracy.\n        p, _ = np.polyfit(log_h, log_e, 1)\n\n        return p\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 1.0, \"c\": 343.0, \"T\": 0.001, \"CFL\": 0.9, \"m\": 1,\n            \"Nx_values\": [50, 100, 200, 400], \"bc_type\": \"periodic\",\n            \"k_factor\": 2 * np.pi, \"p_func\": np.sin\n        },\n        {\n            \"L\": 1.0, \"c\": 343.0, \"T\": 0.001, \"CFL\": 0.9, \"m\": 2,\n            \"Nx_values\": [50, 100, 200, 400], \"bc_type\": \"dirichlet\",\n            \"k_factor\": np.pi, \"p_func\": np.sin\n        },\n        {\n            \"L\": 1.0, \"c\": 343.0, \"T\": 0.001, \"CFL\": 0.9, \"m\": 4,\n            \"Nx_values\": [20, 40, 80, 160], \"bc_type\": \"periodic\",\n            \"k_factor\": 2 * np.pi, \"p_func\": np.sin\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        p_observed = run_convergence_study(**case)\n        results.append(p_observed)\n\n    # Format and print the final results as specified.\n    # The output quantities are dimensionless floating-point numbers rounded to 3 decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}