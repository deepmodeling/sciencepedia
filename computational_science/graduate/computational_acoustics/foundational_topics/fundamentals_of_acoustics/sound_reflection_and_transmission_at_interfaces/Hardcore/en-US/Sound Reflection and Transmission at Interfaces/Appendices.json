{
    "hands_on_practices": [
        {
            "introduction": "Understanding how sound waves behave at the boundary between two different materials is fundamental to all of acoustics. This first practice guides you through the derivation of the reflection and transmission coefficients for the classic case of normal incidence, reinforcing the principles of continuity and energy conservation at an interface . Mastering this foundational model is the first step toward analyzing more complex acoustic systems.",
            "id": "4137937",
            "problem": "A time-harmonic plane acoustic wave of angular frequency $\\omega$ propagates in the $+x$ direction in a lossless, homogeneous, inviscid fluid medium $1$ and is normally incident on a planar interface at $x=0$ with a second lossless, homogeneous, inviscid fluid medium $2$. The characteristic acoustic impedances of the two media are $Z_1$ and $Z_2$ (units Pa·s/m). Assume no interfacial mass, stiffness, or dissipation, and that the fields are strictly one-dimensional and time-harmonic with time dependence $\\exp(-i \\omega t)$.\n\nLet $p_i(x)$, $p_r(x)$, and $p_t(x)$ denote the complex pressure amplitudes of the incident, reflected, and transmitted plane waves, respectively. Define the complex pressure reflection coefficient $r$ and complex pressure transmission coefficient $t$ by $r := p_r(0)/p_i(0)$ and $t := p_t(0)/p_i(0)$. The time-averaged acoustic intensity (energy flux) magnitude for a plane progressive wave of complex pressure amplitude $P$ in a medium of characteristic impedance $Z$ is $|P|^2/(2 Z)$.\n\nStarting only from (i) the continuity of pressure and normal particle velocity at $x=0$, and (ii) the relation between plane-wave pressure and particle velocity in each medium, derive expressions for $r$ and $t$ in terms of $Z_1$ and $Z_2$. Then express the dimensionless intensity reflectance $R$ and transmittance $T$ as functions of $r$, $t$, $Z_1$, and $Z_2$, and demonstrate analytically that $R+T=1$.\n\nFinally, for $Z_1 = 1.5\\times 10^{6}$ Pa·s/m and $Z_2 = 3.0\\times 10^{6}$ Pa·s/m, compute numerical values of $r$, $t$, $R$, and $T$. Report your final answer as a row matrix $(r,\\,t,\\,R,\\,T)$, rounded to four significant figures. All reported quantities are dimensionless.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in linear acoustics concerning wave reflection and transmission at a planar interface. All provided information is consistent and sufficient for a complete solution.\n\nThe problem asks for the derivation of the pressure reflection and transmission coefficients, the intensity reflectance and transmittance, a proof of energy conservation, and a numerical calculation for specific impedance values.\n\nLet the interface between medium $1$ (for $x  0$) and medium $2$ (for $x  0$) be at $x=0$. The characteristic acoustic impedances are $Z_1$ and $Z_2$, which are real and positive for the specified lossless media. A time-harmonic plane wave with time dependence $\\exp(-i\\omega t)$ and angular frequency $\\omega$ propagates in the $+x$ direction in medium $1$.\n\nThe spatial complex pressure amplitude of the incident wave is denoted by $p_i(x)$. Since it propagates in the $+x$ direction, its form is $p_i(x) = p_i(0)\\exp(ik_1x)$, where $k_1$ is the wavenumber in medium $1$. The reflected wave propagates in the $-x$ direction, so its form is $p_r(x) = p_r(0)\\exp(-ik_1x)$. The transmitted wave propagates in the $+x$ direction in medium $2$, so its form is $p_t(x) = p_t(0)\\exp(ik_2x)$, where $k_2$ is the wavenumber in medium $2$.\n\nThe total pressure field $p(x)$ is:\nIn medium $1$ ($x0$): $p_1(x) = p_i(x) + p_r(x) = p_i(0)\\exp(ik_1x) + p_r(0)\\exp(-ik_1x)$.\nIn medium $2$ ($x0$): $p_2(x) = p_t(x) = p_t(0)\\exp(ik_2x)$.\n\nThe relationship between the complex pressure amplitude $p$ and the complex normal particle velocity amplitude $u_x$ for a plane wave is required. It stems from the one-dimensional linearized Euler's equation in the frequency domain: $-i\\omega \\rho u_x = -\\frac{\\partial p}{\\partial x}$, which gives $u_x(x) = \\frac{1}{i\\omega\\rho}\\frac{\\partial p}{\\partial x}$.\nFor a wave propagating in the $+x$ direction, $p(x) \\propto \\exp(ikx)$, so $\\frac{\\partial p}{\\partial x} = ikp$. Thus, $u_x = \\frac{ik}{i\\omega\\rho}p = \\frac{k}{\\omega\\rho}p$. Using $k=\\omega/c$ and the definition of characteristic impedance $Z=\\rho c$, we get $u_x = \\frac{\\omega/c}{\\omega\\rho}p = \\frac{1}{\\rho c} p = \\frac{p}{Z}$.\nFor a wave propagating in the $-x$ direction, $p(x) \\propto \\exp(-ikx)$, so $\\frac{\\partial p}{\\partial x} = -ikp$. Thus, $u_x = \\frac{-ik}{i\\omega\\rho}p = -\\frac{k}{\\omega\\rho}p = -\\frac{p}{Z}$.\n\nAt the interface $x=0$, two boundary conditions must be satisfied:\n(i) Continuity of pressure: $p_1(0) = p_2(0)$.\n(ii) Continuity of normal particle velocity: $u_{x,1}(0) = u_{x,2}(0)$.\n\nApplying the first condition:\n$p_i(0)\\exp(0) + p_r(0)\\exp(0) = p_t(0)\\exp(0)$\n$p_i(0) + p_r(0) = p_t(0)$ (Equation 1)\n\nApplying the second condition, we first express the total particle velocity in each medium.\nIn medium $1$, the total velocity is the sum of the velocities of the incident (+x) and reflected (-x) waves:\n$u_{x,1}(x) = \\frac{p_i(x)}{Z_1} - \\frac{p_r(x)}{Z_1}$.\nIn medium $2$, the velocity is that of the transmitted wave (+x):\n$u_{x,2}(x) = \\frac{p_t(x)}{Z_2}$.\nAt $x=0$:\n$\\frac{p_i(0)}{Z_1} - \\frac{p_r(0)}{Z_1} = \\frac{p_t(0)}{Z_2}$ (Equation 2)\n\nThe complex pressure reflection coefficient $r$ and transmission coefficient $t$ are defined as $r := p_r(0)/p_i(0)$ and $t := p_t(0)/p_i(0)$. Dividing Equations 1 and 2 by $p_i(0)$:\n$1 + \\frac{p_r(0)}{p_i(0)} = \\frac{p_t(0)}{p_i(0)} \\implies 1 + r = t$ (Equation 1a)\n$\\frac{1}{Z_1}\\left(1 - \\frac{p_r(0)}{p_i(0)}\\right) = \\frac{1}{Z_2}\\frac{p_t(0)}{p_i(0)} \\implies \\frac{1-r}{Z_1} = \\frac{t}{Z_2}$ (Equation 2a)\n\nWe solve this system for $r$ and $t$. Substitute $t$ from Equation 1a into Equation 2a:\n$\\frac{1-r}{Z_1} = \\frac{1+r}{Z_2}$\n$Z_2(1-r) = Z_1(1+r)$\n$Z_2 - Z_2 r = Z_1 + Z_1 r$\n$Z_2 - Z_1 = r(Z_1 + Z_2)$\n$r = \\frac{Z_2 - Z_1}{Z_1 + Z_2}$\n\nTo find $t$, substitute the expression for $r$ back into Equation 1a:\n$t = 1 + r = 1 + \\frac{Z_2 - Z_1}{Z_1 + Z_2} = \\frac{(Z_1 + Z_2) + (Z_2 - Z_1)}{Z_1 + Z_2} = \\frac{2Z_2}{Z_1 + Z_2}$\n\nNext, we express the dimensionless intensity reflectance $R$ and transmittance $T$. The time-averaged intensity $I$ of a plane wave with complex pressure amplitude $P$ is $I = \\frac{|P|^2}{2Z}$.\nThe incident intensity is $I_i = \\frac{|p_i(0)|^2}{2Z_1}$.\nThe reflected intensity is $I_r = \\frac{|p_r(0)|^2}{2Z_1}$ (the reflected wave propagates in medium $1$).\nThe transmitted intensity is $I_t = \\frac{|p_t(0)|^2}{2Z_2}$ (the transmitted wave propagates in medium $2$).\n\nThe intensity reflectance $R$ is the ratio of reflected to incident intensity:\n$R = \\frac{I_r}{I_i} = \\frac{|p_r(0)|^2 / (2Z_1)}{|p_i(0)|^2 / (2Z_1)} = \\frac{|p_r(0)|^2}{|p_i(0)|^2} = \\left|\\frac{p_r(0)}{p_i(0)}\\right|^2 = |r|^2$.\n\nThe intensity transmittance $T$ is the ratio of transmitted to incident intensity:\n$T = \\frac{I_t}{I_i} = \\frac{|p_t(0)|^2 / (2Z_2)}{|p_i(0)|^2 / (2Z_1)} = \\frac{|p_t(0)|^2}{|p_i(0)|^2} \\frac{Z_1}{Z_2} = \\left|\\frac{p_t(0)}{p_i(0)}\\right|^2 \\frac{Z_1}{Z_2} = |t|^2 \\frac{Z_1}{Z_2}$.\n\nNow we demonstrate that $R+T=1$, which represents conservation of energy at the interface.\n$R = |r|^2 = \\left|\\frac{Z_2 - Z_1}{Z_1 + Z_2}\\right|^2 = \\frac{(Z_2 - Z_1)^2}{(Z_1 + Z_2)^2}$ since $Z_1, Z_2$ are real.\n$T = |t|^2 \\frac{Z_1}{Z_2} = \\left|\\frac{2Z_2}{Z_1 + Z_2}\\right|^2 \\frac{Z_1}{Z_2} = \\frac{4Z_2^2}{(Z_1 + Z_2)^2} \\frac{Z_1}{Z_2} = \\frac{4Z_1Z_2}{(Z_1 + Z_2)^2}$.\n\nSumming $R$ and $T$:\n$R+T = \\frac{(Z_2 - Z_1)^2}{(Z_1 + Z_2)^2} + \\frac{4Z_1Z_2}{(Z_1 + Z_2)^2} = \\frac{(Z_2 - Z_1)^2 + 4Z_1Z_2}{(Z_1 + Z_2)^2}$\nThe numerator is $(Z_2^2 - 2Z_1Z_2 + Z_1^2) + 4Z_1Z_2 = Z_1^2 + 2Z_1Z_2 + Z_2^2 = (Z_1 + Z_2)^2$.\nThus, $R+T = \\frac{(Z_1 + Z_2)^2}{(Z_1 + Z_2)^2} = 1$. This proves the conservation of energy flux.\n\nFinally, we compute the numerical values for $Z_1 = 1.5 \\times 10^6 \\, \\text{Pa}\\cdot\\text{s}/\\text{m}$ and $Z_2 = 3.0 \\times 10^6 \\, \\text{Pa}\\cdot\\text{s}/\\text{m}$.\n$r = \\frac{Z_2 - Z_1}{Z_1 + Z_2} = \\frac{(3.0 - 1.5) \\times 10^6}{(1.5 + 3.0) \\times 10^6} = \\frac{1.5}{4.5} = \\frac{1}{3}$.\nTo four significant figures, $r \\approx 0.3333$.\n\n$t = \\frac{2Z_2}{Z_1 + Z_2} = \\frac{2 \\times (3.0 \\times 10^6)}{(1.5 + 3.0) \\times 10^6} = \\frac{6.0}{4.5} = \\frac{4}{3}$.\nTo four significant figures, $t \\approx 1.333$.\n\n$R = |r|^2 = (1/3)^2 = 1/9$.\nTo four significant figures, $R \\approx 0.1111$.\n\n$T = 1 - R = 1 - 1/9 = 8/9$.\nTo four significant figures, $T \\approx 0.8889$.\nLet's verify $T$ using its formula: $T = |t|^2 \\frac{Z_1}{Z_2} = (4/3)^2 \\frac{1.5 \\times 10^6}{3.0 \\times 10^6} = \\frac{16}{9} \\times \\frac{1}{2} = \\frac{8}{9}$. The verification is successful.\n\nThe final numerical results rounded to four significant figures are:\n$r = 0.3333$\n$t = 1.333$\n$R = 0.1111$\n$T = 0.8889$\n\nThese are presented as a row matrix $(r, t, R, T)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3333  1.333  0.1111  0.8889\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the normal incidence case, we now explore the more general scenario of oblique incidence on an impedance boundary, a model widely used in room acoustics and noise control engineering. This exercise further extends this concept to the design of phase-gradient metasurfaces, demonstrating how engineered interfaces can be used to actively steer and control reflected sound waves . This connects fundamental wave physics to cutting-edge applications in acoustic device design.",
            "id": "4137936",
            "problem": "A time-harmonic acoustic plane wave with angular frequency $\\omega$ propagates in a homogeneous, inviscid fluid medium $j$ of mass density $\\rho_{j}$ and sound speed $c_{j}$. Its complex pressure field is $p_{i}(\\mathbf{r}) = P_{i}\\,\\exp\\!\\big(i\\,\\mathbf{k}_{j}\\cdot\\mathbf{r}\\big)$ with wavevector magnitude $k_{j} = \\omega/c_{j}$ and unit propagation direction $\\hat{\\mathbf{s}}_{i}$. The wave impinges from $z0$ onto the infinite planar boundary $z=0$ at an incidence angle $\\theta_{i}$ measured from the unit normal $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$. The boundary at $z=0$ is characterized by a (possibly complex and spatially varying) acoustic surface impedance $Z_{s}(y)$ that enforces the impedance boundary condition $p(x,y,0) = - Z_{s}(y)\\,v_{n}(x,y,0)$, where $v_{n}$ is the normal component of the particle velocity taken positive in the $+\\hat{\\mathbf{z}}$ direction. Assume far-field specular reflection and neglect diffraction.\n\nPart I (uniform boundary): When $Z_{s}(y)\\equiv Z_{s}$ is uniform, derive from first principles of linear acoustics the angle-dependent complex pressure reflection coefficient $R(\\theta_{i}) = P_{r}/P_{i}$ at $z=0$, expressed in terms of $Z_{s}$, $Z_{j}=\\rho_{j}c_{j}$, and $\\theta_{i}$. Your derivation must start from the linearized momentum balance and the plane-wave relation between pressure and particle velocity, and must rigorously account for the decomposition into normal and tangential components at oblique incidence.\n\nPart II (phase-gradient boundary and beam steering): Now let the boundary be lossless and reactive with a slowly varying impedance of the form $Z_{s}(y) = i\\,X(y)$, and suppose you design $X(y)$ so that the local reflection coefficient has unit magnitude and a prescribed phase $\\phi(y)$, that is, $R(y) = \\exp\\!\\big(i\\,\\phi(y)\\big)$ while $|R(y)|=1$. Under the local plane-wave (geometrical acoustics) approximation, derive how the spatial phase gradient $\\partial\\phi/\\partial y$ modifies the tangential wave number and hence the reflection angle $\\theta_{r}$. Then, for the specific linear phase profile $\\phi(y) = g\\,y$ with constant $g$ (in radians per meter), express $\\theta_{r}$ in closed form in terms of $\\theta_{i}$, $g$, $\\omega$, and $c_{j}$. Express the final angle in radians.\n\nAnswer specification: Provide your final results as two analytic expressions $R(\\theta_{i})$ and $\\theta_{r}$, and present them together as a single row matrix. No numerical evaluation is required.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in linear acoustics concerning wave reflection from an impedance boundary, extended to the modern concept of metasurfaces.\n\n**Part I: Reflection from a Uniform Impedance Boundary**\n\nWe begin by defining the geometry and the wave fields. The boundary is the plane $z=0$. The fluid medium $j$ with properties $\\rho_j$ and $c_j$ occupies the half-space $z0$. An incident plane wave impinges on the boundary from this region. We can orient the coordinate system such that the plane of incidence is the $yz$-plane without loss of generality. The incident wavevector $\\mathbf{k}_i$ thus has no $x$-component. The angle of incidence $\\theta_i$ is measured from the normal $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$. For a wave propagating from $z0$ toward $z=0$, the $z$-component of its wavevector must be negative.\n\nThe incident wavevector is $\\mathbf{k}_i = k_{iy} \\hat{\\mathbf{y}} + k_{iz} \\hat{\\mathbf{z}}$, where $k_{iy} = k_j \\sin\\theta_i$ and $k_{iz} = -k_j \\cos\\theta_i$, with $k_j = \\omega/c_j$ being the wavenumber in the medium. The incident pressure field is given by $p_i(\\mathbf{r}) = P_i \\exp(i \\mathbf{k}_i \\cdot \\mathbf{r}) = P_i \\exp(i(k_j y \\sin\\theta_i - k_j z \\cos\\theta_i))$.\n\nFor specular reflection from a uniform boundary, the angle of reflection equals the angle of incidence, $\\theta_r = \\theta_i$. The tangential component of the wavevector is conserved ($k_{ry} = k_{iy}$), and the normal component reverses sign. The reflected wavevector is $\\mathbf{k}_r = k_j \\sin\\theta_i \\hat{\\mathbf{y}} + k_j \\cos\\theta_i \\hat{\\mathbf{z}}$. The reflected pressure field is $p_r(\\mathbf{r}) = P_r \\exp(i \\mathbf{k}_r \\cdot \\mathbf{r}) = P_r \\exp(i(k_j y \\sin\\theta_i + k_j z \\cos\\theta_i))$.\n\nThe total pressure field for $z0$ is the superposition of the incident and reflected waves:\n$$p(y,z) = p_i(y,z) + p_r(y,z) = \\left[ P_i \\exp(-i k_j z \\cos\\theta_i) + P_r \\exp(i k_j z \\cos\\theta_i) \\right] \\exp(i k_j y \\sin\\theta_i)$$\nThe problem requires a derivation starting from the linearized momentum balance, which for a time-harmonic field (with time-dependence $\\exp(-i\\omega t)$) is $\\rho_j (-i\\omega \\mathbf{v}) = -\\nabla p$. This gives the particle velocity field $\\mathbf{v}$ in terms of the pressure gradient:\n$$\\mathbf{v} = \\frac{1}{i\\omega\\rho_j}\\nabla p$$\nThe normal component of the particle velocity is $v_n = v_z = \\mathbf{v}\\cdot\\hat{\\mathbf{z}} = \\frac{1}{i\\omega\\rho_j} \\frac{\\partial p}{\\partial z}$.\nDifferentiating the total pressure field with respect to $z$:\n$$\\frac{\\partial p}{\\partial z} = \\left[ P_i(-i k_j \\cos\\theta_i)\\exp(-i k_j z \\cos\\theta_i) + P_r(i k_j \\cos\\theta_i)\\exp(i k_j z \\cos\\theta_i) \\right] \\exp(i k_j y \\sin\\theta_i)$$\nThe normal velocity is then:\n$$v_z(y,z) = \\frac{k_j \\cos\\theta_i}{\\omega\\rho_j} \\left[ -P_i \\exp(-i k_j z \\cos\\theta_i) + P_r \\exp(i k_j z \\cos\\theta_i) \\right] \\exp(i k_j y \\sin\\theta_i)$$\nUsing the relations $k_j = \\omega/c_j$ and the characteristic impedance of the medium $Z_j = \\rho_j c_j$, the prefactor simplifies: $\\frac{k_j}{\\omega\\rho_j} = \\frac{\\omega/c_j}{\\omega\\rho_j} = \\frac{1}{\\rho_j c_j} = \\frac{1}{Z_j}$.\nThus, the normal velocity is:\n$$v_z(y,z) = \\frac{\\cos\\theta_i}{Z_j} \\left[ -P_i \\exp(-i k_j z \\cos\\theta_i) + P_r \\exp(i k_j z \\cos\\theta_i) \\right] \\exp(i k_j y \\sin\\theta_i)$$\nNow we apply the uniform impedance boundary condition, $p(x,y,0) = -Z_s v_n(x,y,0)$, at the boundary $z=0$. Note that $v_n$ is specified as the velocity in the $+\\hat{\\mathbf{z}}$ direction, so $v_n = v_z$.\nAt $z=0$, the total pressure and normal velocity become:\n$$p(y,0) = (P_i + P_r) \\exp(i k_j y \\sin\\theta_i)$$\n$$v_z(y,0) = \\frac{\\cos\\theta_i}{Z_j}(-P_i + P_r) \\exp(i k_j y \\sin\\theta_i)$$\nSubstituting these into the boundary condition:\n$$(P_i + P_r)\\exp(i k_j y \\sin\\theta_i) = -Z_s \\left( \\frac{\\cos\\theta_i}{Z_j}(-P_i + P_r) \\exp(i k_j y \\sin\\theta_i) \\right)$$\nThe exponential spatial dependence cancels out, leaving an algebraic relation for the amplitudes:\n$$P_i + P_r = \\frac{Z_s \\cos\\theta_i}{Z_j} (P_i - P_r)$$\nTo find the reflection coefficient $R(\\theta_i) = P_r/P_i$, we divide by $P_i$:\n$$1 + R(\\theta_i) = \\frac{Z_s \\cos\\theta_i}{Z_j} (1 - R(\\theta_i))$$\n$$1 + R(\\theta_i) = \\frac{Z_s \\cos\\theta_i}{Z_j} - R(\\theta_i) \\frac{Z_s \\cos\\theta_i}{Z_j}$$\nRearranging to solve for $R(\\theta_i)$:\n$$R(\\theta_i) \\left( 1 + \\frac{Z_s \\cos\\theta_i}{Z_j} \\right) = \\frac{Z_s \\cos\\theta_i}{Z_j} - 1$$\n$$R(\\theta_i) \\left( \\frac{Z_j + Z_s \\cos\\theta_i}{Z_j} \\right) = \\frac{Z_s \\cos\\theta_i - Z_j}{Z_j}$$\nThe complex pressure reflection coefficient is therefore:\n$$R(\\theta_i) = \\frac{Z_s \\cos\\theta_i - Z_j}{Z_s \\cos\\theta_i + Z_j}$$\n\n**Part II: Reflection from a Phase-Gradient Boundary**\n\nNow, the surface impedance $Z_s(y)$ varies along the $y$-direction. We employ the local plane-wave approximation, which assumes that at each point $(x,y,0)$, the reflection process is governed by the local impedance value $Z_s(y)$, as if it were a uniform infinite plane. The reflection coefficient thus becomes a function of position, $R(y)$. The relationship between the reflected and incident pressure fields on the surface is $p_r(x,y,0) = R(y) p_i(x,y,0)$.\n\nThe incident field on the surface $z=0$ is $p_i(x,y,0) = P_i \\exp(i(k_{ix}x + k_{iy}y))$. For incidence in the $yz$-plane, $k_{ix}=0$ and $k_{iy} = k_j \\sin\\theta_i$.\nThe reflection coefficient is given to have unit magnitude and a prescribed phase $\\phi(y)$, so $R(y) = \\exp(i\\phi(y))$.\nThe reflected pressure field at the boundary is:\n$$p_r(x,y,0) = \\exp(i\\phi(y)) \\left( P_i \\exp(i k_j y \\sin\\theta_i) \\right) = P_i \\exp\\left(i(k_j y \\sin\\theta_i + \\phi(y))\\right)$$\nThe phase of the reflected wave along the surface is $\\Phi_r(y) = k_j y \\sin\\theta_i + \\phi(y)$.\nThe tangential component of the reflected wavevector, $k_{ry}$, is given by the local spatial rate of change of the phase (the phase gradient). For a general surface phase $\\Phi_r(x,y)$, the tangential wavevector is $\\mathbf{k}_{r,t} = \\nabla_t \\Phi_r(x,y)$, where $\\nabla_t = \\hat{\\mathbf{x}}\\frac{\\partial}{\\partial x} + \\hat{\\mathbf{y}}\\frac{\\partial}{\\partial y}$.\nIn our case, the phase varies only with $y$, so we only need the $y$-component:\n$$k_{ry} = \\frac{d\\Phi_r(y)}{dy} = \\frac{d}{dy}\\left( k_j y \\sin\\theta_i + \\phi(y) \\right) = k_j \\sin\\theta_i + \\frac{\\partial\\phi}{\\partial y}$$\nThis equation shows that the phase gradient $\\partial\\phi/\\partial y$ adds to the tangential component of the incident wavevector to produce the tangential component of the reflected wavevector. This is a form of the generalized law of reflection.\n\nThe reflected wave propagates in the medium $j$, so its wavevector $\\mathbf{k}_r$ must have magnitude $k_j$. The reflection angle $\\theta_r$ is defined by the components of $\\mathbf{k}_r$, such that $k_{ry} = k_j \\sin\\theta_r$. Equating the two expressions for $k_{ry}$:\n$$k_j\\sin\\theta_r = k_j \\sin\\theta_i + \\frac{\\partial\\phi}{\\partial y}$$\nDividing by $k_j = \\omega/c_j$:\n$$\\sin\\theta_r = \\sin\\theta_i + \\frac{1}{k_j}\\frac{\\partial\\phi}{\\partial y} = \\sin\\theta_i + \\frac{c_j}{\\omega}\\frac{\\partial\\phi}{\\partial y}$$\nFor the specific linear phase profile $\\phi(y) = g y$, the phase gradient is a constant: $\\frac{\\partial\\phi}{\\partial y} = g$. Substituting this into the equation for the reflection angle gives:\n$$\\sin\\theta_r = \\sin\\theta_i + \\frac{g c_j}{\\omega}$$\nSolving for $\\theta_r$ yields the closed-form expression for the reflection angle in radians:\n$$\\theta_r = \\arcsin\\left(\\sin\\theta_i + \\frac{g c_j}{\\omega}\\right)$$\nThis result describes anomalous reflection, where the angle of reflection is controlled by the engineered phase gradient $g$ on the surface.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{Z_s \\cos\\theta_i - Z_j}{Z_s \\cos\\theta_i + Z_j}  \\arcsin\\left(\\sin\\theta_i + \\frac{g c_j}{\\omega}\\right) \\end{pmatrix}}$$"
        },
        {
            "introduction": "A crucial task in computational acoustics is simulating wave propagation in open, unbounded domains, which requires the use of artificial absorbing boundaries. This practice bridges analytical theory with numerical implementation by analyzing the stability of a Perfectly Matched Layer (PML), a sophisticated absorbing boundary condition used in time-domain simulations . By deriving the conditions for numerical stability, you will gain insight into the practical challenges and constraints of building robust computational models.",
            "id": "4137942",
            "problem": "Consider one-dimensional linear acoustics in a homogeneous medium occupying the half-space adjoining an absorbing interface modeled by a Perfectly Matched Layer (PML). Let the primary acoustic variables be pressure $p(x,t)$ and particle velocity $u(x,t)$. Begin from the linearized equations consistent with Newton's laws and continuity: $\\partial p/\\partial t$ driven by the spatial gradient of $u$, and $\\partial u/\\partial t$ driven by the spatial gradient of $p$, with material parameters mass density $\\rho$ and bulk modulus $K$. In the absorbing layer, include a damping contribution controlled by a nonnegative damping coefficient $\\sigma$ applied to each state variable in time. Assume a spatially discrete representation using a uniform grid with spacing $\\Delta x$ and a central-difference approximation to the spatial derivative acting on Fourier modes $e^{\\mathrm{i} k x}$ with wavenumber $k$, producing a discrete symbol $\\mathrm{i}\\hat{k}$ where $\\hat{k}=\\sin(k\\Delta x)/\\Delta x$. For a single Fourier mode, write the resulting semi-discrete first-order system in time as a linear ordinary differential equation in a $2$-component state vector, and then discretize in time using a single-step explicit scheme with step $\\Delta t$ to obtain a linear update operator $G$ acting on the state at each time step.\n\nYour tasks are:\n- Derive the $2\\times 2$ update operator $G$ for one Fourier mode from the stated physical laws and discretizations.\n- Compute the eigenvalues of $G$, and express the no-growth condition that guarantees non-increasing amplitude per time step in terms of $\\Delta t$, $\\hat{k}$, $\\rho$, $K$, and $\\sigma$.\n- From first principles, derive constraints on the damping coefficient $\\sigma$ (for a given $\\Delta t$, $\\Delta x$, and $k$) ensuring that the spectral radius of $G$ is at most $1$, therefore avoiding growth. Present the allowable interval of $\\sigma$ in closed form, and identify when this interval is empty.\n\nImplement a program that, for each parameter set in the test suite below, constructs the matrix $G$, computes its eigenvalues, evaluates the spectral radius, and computes the allowable interval for $\\sigma$. Treat the medium parameters in International System of Units (SI): $\\rho$ in $\\mathrm{kg/m^3}$, $K$ in $\\mathrm{Pa}$, $\\Delta x$ in $\\mathrm{m}$, $\\Delta t$ in $\\mathrm{s}$, $k$ in $\\mathrm{rad/m}$, and $\\sigma$ in $\\mathrm{s^{-1}}$. Angles must be in radians. The spectral radius is dimensionless. The program must return, for each test case, a list containing: the spectral radius as a float, a boolean indicating whether the given $\\sigma$ avoids growth, the lower bound and upper bound of the allowable $\\sigma$ interval as floats (use $\\mathrm{NaN}$ for bounds if the interval is empty). Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[result1,result2,result3]`).\n\nUse the following test suite of parameter values:\n- Case $1$ (air, happy path): $\\rho=1.2$, $K=1.42\\times 10^{5}$, $\\Delta x=0.01$, $\\Delta t=1.0\\times 10^{-5}$, $k=\\pi/(2\\Delta x)$, $\\sigma=2.0\\times 10^{4}$.\n- Case $2$ (water, boundary): $\\rho=1000.0$, $K=2.2\\times 10^{9}$, $\\Delta x=0.02$, $\\Delta t=1.348106\\times 10^{-5}$, $k=\\pi/(2\\Delta x)$, $\\sigma=7.416198\\times 10^{4}$.\n- Case $3$ (air, zero damping, expected unstable): $\\rho=1.2$, $K=1.42\\times 10^{5}$, $\\Delta x=0.01$, $\\Delta t=2.0\\times 10^{-5}$, $k=\\pi/(2\\Delta x)$, $\\sigma=0.0$.\n- Case $4$ (air, excessive damping, expected unstable): $\\rho=1.2$, $K=1.42\\times 10^{5}$, $\\Delta x=0.01$, $\\Delta t=1.0\\times 10^{-5}$, $k=\\pi/(2\\Delta x)$, $\\sigma=3.0\\times 10^{5}$.\n- Case $5$ (air, zero wavenumber mode): $\\rho=1.2$, $K=1.42\\times 10^{5}$, $\\Delta x=0.01$, $\\Delta t=1.0\\times 10^{-4}$, $k=0.0$, $\\sigma=5.0\\times 10^{3}$.\n\nThe final output must be a single Python list containing one element per test case, where each element is a list [`spectral_radius`, `stable_boolean`, `lower_bound_sigma`, `upper_bound_sigma`].",
            "solution": "The problem requires the derivation and analysis of a numerical scheme for one-dimensional linear acoustics in a medium with damping, modeled as a Perfectly Matched Layer (PML).\n\nThe first step is to establish the governing continuous equations. The problem states that the system is described by the linearized equations for pressure $p(x,t)$ and particle velocity $u(x,t)$. These are derived from the principles of mass continuity and momentum conservation. For a homogeneous medium with bulk modulus $K$ and mass density $\\rho$, these equations are:\n$$\n\\frac{\\partial p}{\\partial t} = -K \\frac{\\partial u}{\\partial x}\n$$\n$$\n\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}\n$$\nThe problem specifies that in the absorbing layer, a damping contribution controlled by a non-negative coefficient $\\sigma$ is applied to each state variable in time. This modifies the equations to:\n$$\n\\frac{\\partial p}{\\partial t} = -K \\frac{\\partial u}{\\partial x} - \\sigma p\n$$\n$$\n\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} - \\sigma u\n$$\nThese equations are to be solved for a single Fourier mode, $e^{\\mathrm{i} k x}$, on a spatially discrete grid. We assume solutions of the form $p(x,t) = \\hat{p}(t)e^{\\mathrm{i} k x}$ and $u(x,t) = \\hat{u}(t)e^{\\mathrm{i} k x}$. The spatial derivative $\\partial/\\partial x$ is approximated using a central-difference scheme, which for a mode $e^{\\mathrm{i} k x}$ acts as multiplication by the symbol $\\mathrm{i}\\hat{k}$, where $\\hat{k} = \\frac{\\sin(k\\Delta x)}{\\Delta x}$. Substituting these into the damped PDEs yields a system of ordinary differential equations (ODEs) for the modal amplitudes $\\hat{p}(t)$ and $\\hat{u}(t)$:\n$$\n\\frac{d\\hat{p}}{dt} = -K (\\mathrm{i}\\hat{k}\\hat{u}) - \\sigma\\hat{p} = -\\sigma\\hat{p} - \\mathrm{i}K\\hat{k}\\hat{u}\n$$\n$$\n\\frac{d\\hat{u}}{dt} = -\\frac{1}{\\rho} (\\mathrm{i}\\hat{k}\\hat{p}) - \\sigma\\hat{u} = -\\mathrm{i}\\frac{\\hat{k}}{\\rho}\\hat{p} - \\sigma\\hat{u}\n$$\nThis semi-discrete system can be written in matrix form. Let the state vector be $V(t) = \\begin{pmatrix} \\hat{p}(t) \\\\ \\hat{u}(t) \\end{pmatrix}$. The system is $\\frac{dV}{dt} = A V$, where the matrix $A$ is:\n$$\nA = \\begin{pmatrix} -\\sigma  -\\mathrm{i} K \\hat{k} \\\\ -\\mathrm{i} \\frac{\\hat{k}}{\\rho}  -\\sigma \\end{pmatrix}\n$$\nNext, we discretize in time using a single-step explicit scheme, the Forward Euler method, with a time step $\\Delta t$. The update rule is $V^{n+1} = V^n + \\Delta t A V^n$, which can be written as $V^{n+1} = G V^n$, where $G$ is the $2\\times 2$ update operator.\n$$\nG = I + \\Delta t A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\Delta t \\begin{pmatrix} -\\sigma  -\\mathrm{i} K \\hat{k} \\\\ -\\mathrm{i} \\frac{\\hat{k}}{\\rho}  -\\sigma \\end{pmatrix} = \\begin{pmatrix} 1-\\sigma\\Delta t  -\\mathrm{i} K \\hat{k} \\Delta t \\\\ -\\mathrm{i} \\frac{\\hat{k}}{\\rho} \\Delta t  1-\\sigma\\Delta t \\end{pmatrix}\n$$\nThis is the derived update operator $G$.\n\nTo ensure numerical stability, the amplitude of the solution must not grow over time. This requires that the spectral radius of the operator $G$, denoted $\\rho(G)$, must be at most $1$. The spectral radius is the maximum of the magnitudes of the eigenvalues of $G$. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(G - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} 1-\\sigma\\Delta t - \\lambda  -\\mathrm{i} K \\hat{k} \\Delta t \\\\ -\\mathrm{i} \\frac{\\hat{k}}{\\rho} \\Delta t  1-\\sigma\\Delta t - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(1-\\sigma\\Delta t - \\lambda)^2 - \\left( -\\mathrm{i} K \\hat{k} \\Delta t \\right) \\left( -\\mathrm{i} \\frac{\\hat{k}}{\\rho} \\Delta t \\right) = 0\n$$\n$$\n(1-\\sigma\\Delta t - \\lambda)^2 - (\\mathrm{i}^2) \\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2 = 0\n$$\n$$\n(1-\\sigma\\Delta t - \\lambda)^2 + \\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2 = 0\n$$\nSolving for $\\lambda$:\n$$\n1-\\sigma\\Delta t - \\lambda = \\pm \\sqrt{-\\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2} = \\pm \\mathrm{i} \\sqrt{\\frac{K}{\\rho}} |\\hat{k}| \\Delta t\n$$\nThe two eigenvalues are $\\lambda_{1,2} = (1-\\sigma\\Delta t) \\pm \\mathrm{i} \\sqrt{\\frac{K}{\\rho}} |\\hat{k}| \\Delta t$. The magnitudes of these complex conjugate eigenvalues are equal:\n$$\n|\\lambda| = \\sqrt{(1-\\sigma\\Delta t)^2 + \\left(\\sqrt{\\frac{K}{\\rho}} |\\hat{k}| \\Delta t\\right)^2} = \\sqrt{(1-\\sigma\\Delta t)^2 + \\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2}\n$$\nThe no-growth condition is $\\rho(G) = |\\lambda| \\le 1$, which is equivalent to $|\\lambda|^2 \\le 1$:\n$$\n(1-\\sigma\\Delta t)^2 + \\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2 \\le 1\n$$\nThis inequality defines the stability constraint on the system parameters.\n\nFinally, we derive the allowable interval for the damping coefficient $\\sigma$. Let $\\Omega^2 = \\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2$. The stability condition is $(1-\\sigma\\Delta t)^2 + \\Omega^2 \\le 1$.\nThis can be rearranged to $(1-\\sigma\\Delta t)^2 \\le 1 - \\Omega^2$. For a real solution for $\\sigma$ to exist, the right-hand side must be non-negative, which implies $\\Omega^2 \\le 1$. If $\\Omega^2  1$, no real $\\sigma$ can stabilize the scheme, and the allowable interval for $\\sigma$ is empty. The condition $\\Omega^2 \\le 1$ is the Courant-Friedrichs-Lewy (CFL) condition for this numerical method, which can be written as $\\Delta t \\le \\frac{1}{|\\hat{k}|\\sqrt{K/\\rho}}$.\n\nAssuming $\\Omega^2 \\le 1$, we can take the square root of the inequality:\n$$\n|1-\\sigma\\Delta t| \\le \\sqrt{1 - \\Omega^2}\n$$\nThis expands to:\n$$\n-\\sqrt{1 - \\Omega^2} \\le 1-\\sigma\\Delta t \\le \\sqrt{1 - \\Omega^2}\n$$\nSolving for $\\sigma\\Delta t$:\n$$\n1 - \\sqrt{1 - \\Omega^2} \\le \\sigma\\Delta t \\le 1 + \\sqrt{1 - \\Omega^2}\n$$\nSince $\\Delta t  0$, we can divide by it without changing the inequalities:\n$$\n\\frac{1 - \\sqrt{1 - \\Omega^2}}{\\Delta t} \\le \\sigma \\le \\frac{1 + \\sqrt{1 - \\Omega^2}}{\\Delta t}\n$$\nSubstituting back $\\Omega^2 = \\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2$, and given the physical constraint $\\sigma \\ge 0$, we find the complete interval. The lower bound is always non-negative since $\\sqrt{1 - \\Omega^2} \\le 1$. Therefore, the allowable closed interval for $\\sigma$ is:\n$$\n\\sigma \\in \\left[ \\frac{1 - \\sqrt{1 - \\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2}}{\\Delta t}, \\frac{1 + \\sqrt{1 - \\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2}}{\\Delta t} \\right]\n$$\nThis interval is non-empty if and only if $\\frac{K}{\\rho} \\hat{k}^2 \\Delta t^2 \\le 1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes stability properties for a discretized acoustic wave equation with damping.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (air, happy path)\n        (1.2, 1.42e5, 0.01, 1.0e-5, np.pi / (2 * 0.01), 2.0e4),\n        # Case 2 (water, boundary)\n        (1000.0, 2.2e9, 0.02, 1.348106e-5, np.pi / (2 * 0.02), 7.416198e4),\n        # Case 3 (air, zero damping, expected unstable)\n        (1.2, 1.42e5, 0.01, 2.0e-5, np.pi / (2 * 0.01), 0.0),\n        # Case 4 (air, excessive damping, expected unstable)\n        (1.2, 1.42e5, 0.01, 1.0e-5, np.pi / (2 * 0.01), 3.0e5),\n        # Case 5 (air, zero wavenumber mode)\n        (1.2, 1.42e5, 0.01, 1.0e-4, 0.0, 5.0e3),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho, K, dx, dt, k, sigma = case\n\n        # 1. Calculate the discrete wavenumber symbol hat(k)\n        # sin(k*dx)/dx. For k=0, this is 0.\n        if dx == 0:\n            k_hat = k # This is a limit case, k_hat -> k as dx -> 0\n        else:\n            k_hat = np.sin(k * dx) / dx\n\n        # 2. Calculate Omega^2 = (K/rho) * hat(k)^2 * dt^2\n        # This term is central to the stability analysis.\n        omega_sq = (K / rho) * (k_hat**2) * (dt**2)\n\n        # 3. Compute the allowable interval for sigma\n        # The interval is empty if Omega^2 > 1 (CFL condition violated)\n        if omega_sq > 1.0:\n            lower_bound_sigma = np.nan\n            upper_bound_sigma = np.nan\n        else:\n            # The interval exists, calculate its bounds\n            sqrt_term = np.sqrt(1.0 - omega_sq)\n            lower_bound_sigma = (1.0 - sqrt_term) / dt\n            upper_bound_sigma = (1.0 + sqrt_term) / dt\n        \n        # 4. Compute the spectral radius of the update matrix G for the given sigma\n        # The eigenvalues are lambda = (1 - sigma*dt) +- i * Omega\n        # The spectral radius is |lambda| = sqrt((1 - sigma*dt)^2 + Omega^2)\n        real_part_sq = (1.0 - sigma * dt)**2\n        spectral_radius = np.sqrt(real_part_sq + omega_sq)\n\n        # 5. Check if the given sigma avoids growth (is stable)\n        # Stability requires spectral_radius = 1.0. A small tolerance is\n        # prudent for floating point comparisons at the boundary.\n        is_stable = spectral_radius = 1.0 or np.isclose(spectral_radius, 1.0)\n        \n        # 6. Collate results for the current test case\n        case_result = [\n            float(spectral_radius),\n            is_stable,\n            float(lower_bound_sigma),\n            float(upper_bound_sigma)\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}