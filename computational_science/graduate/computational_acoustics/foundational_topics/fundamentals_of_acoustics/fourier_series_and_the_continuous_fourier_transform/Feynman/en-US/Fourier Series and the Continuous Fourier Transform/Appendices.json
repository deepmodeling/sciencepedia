{
    "hands_on_practices": [
        {
            "introduction": "Recognizing symmetries in a waveform is a powerful first step in Fourier analysis, often simplifying the problem immensely. This exercise  demonstrates how the odd symmetry of a function guarantees that its Fourier series will be composed entirely of sine terms. You will first prove this fundamental principle and then apply it to calculate the Fourier series for a sawtooth wave, a signal commonly used to model physical phenomena.",
            "id": "4124884",
            "problem": "Consider a one-dimensional computational acoustic model of a rigid-walled duct driven at its inlet by a dimensionless particle velocity waveform with period $2\\pi$ in the dimensionless time variable $t$. Over a fundamental interval $(-\\pi,\\pi)$, the waveform is specified by $g(t)=t$ and extended to all $t\\in\\mathbb{R}$ by odd periodicity, meaning $g(t+2\\pi)=g(t)$ and $g(-t)=-g(t)$. In order to analyze the harmonic content of this inlet driving, the waveform is expanded in a trigonometric Fourier series on $(-\\pi,\\pi)$.\n\nStarting from the inner product structure on $L^{2}(-\\pi,\\pi)$ and the parity properties of the trigonometric basis functions, derive from first principles that the cosine coefficients $a_{n}$ vanish for any odd function on $(-\\pi,\\pi)$. Then compute the sine coefficients $b_{n}$ for the given $g(t)=t$ and provide the corresponding sine-only Fourier series representation over $(-\\pi,\\pi)$.\n\nYour final answer must be a single closed-form analytic expression representing the sine-only series of $g(t)$ as a function of $t$. Do not include an equality sign or any units in the final answer. No numerical rounding is required.",
            "solution": "The user-provided problem has been validated and is deemed valid. It is scientifically grounded in the principles of Fourier analysis, well-posed with a clear and complete setup, and stated objectively. The problem is a standard exercise in the application of Fourier series theory to an odd function, which is a common task in signal processing and wave physics, including acoustics.\n\nThe solution is developed in two parts as requested. First, we derive from first principles that the cosine coefficients in the Fourier series of any odd function on a symmetric interval $(-\\pi, \\pi)$ are zero. Second, we compute the sine coefficients for the specific odd function $g(t)=t$ and construct its Fourier series.\n\nPart 1: Vanishing Cosine Coefficients for an Odd Function\n\nA function $f(t)$ is defined as odd if $f(-t) = -f(t)$ for all $t$ in its domain. The trigonometric Fourier series of a function $f(t)$ on the interval $(-\\pi, \\pi)$ is given by\n$$\nf(t) \\sim \\frac{a_{0}}{2} + \\sum_{n=1}^{\\infty} \\left( a_{n} \\cos(nt) + b_{n} \\sin(nt) \\right)\n$$\nThe coefficients are projections of $f(t)$ onto the orthogonal basis functions. For the series form above, they are calculated as:\n$$\na_{n} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\cos(nt) \\, dt, \\quad \\text{for } n \\ge 0\n$$\n$$\nb_{n} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\sin(nt) \\, dt, \\quad \\text{for } n \\ge 1\n$$\nTo prove that $a_n$ vanishes for an odd function $f(t)$, we analyze the integrand $f(t)\\cos(nt)$. The function $f(t)$ is odd by hypothesis. The cosine function is an even function, meaning $\\cos(n(-t)) = \\cos(nt)$ for any integer $n \\ge 0$. The product of an odd function and an even function is an odd function. Let $h_n(t) = f(t) \\cos(nt)$. Then,\n$$\nh_n(-t) = f(-t)\\cos(n(-t)) = (-f(t))(\\cos(nt)) = -h_n(t)\n$$\nThe definite integral of any odd function over a symmetric interval, such as $(-\\pi, \\pi)$, is zero. This is shown as follows:\n$$\n\\int_{-\\pi}^{\\pi} h_n(t) \\, dt = \\int_{-\\pi}^{0} h_n(t) \\, dt + \\int_{0}^{\\pi} h_n(t) \\, dt\n$$\nIn the first integral, let $u = -t$, which implies $dt = -du$. The limits of integration change from $t=-\\pi$ to $u=\\pi$ and from $t=0$ to $u=0$.\n$$\n\\int_{-\\pi}^{0} h_n(t) \\, dt = \\int_{\\pi}^{0} h_n(-u) (-du) = \\int_{0}^{\\pi} h_n(-u) \\, du = \\int_{0}^{\\pi} -h_n(u) \\, du = -\\int_{0}^{\\pi} h_n(t) \\, dt\n$$\nSubstituting this back, we get:\n$$\n\\int_{-\\pi}^{\\pi} h_n(t) \\, dt = -\\int_{0}^{\\pi} h_n(t) \\, dt + \\int_{0}^{\\pi} h_n(t) \\, dt = 0\n$$\nSince the integrand $f(t)\\cos(nt)$ is an odd function for all $n \\ge 0$, its integral over $(-\\pi, \\pi)$ is zero. Therefore:\n$$\na_{n} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\cos(nt) \\, dt = 0, \\quad \\text{for all } n \\ge 0\n$$\nThis demonstrates from first principles that all cosine coefficients, $a_n$ for $n \\ge 0$, are zero for any odd function on $(-\\pi, \\pi)$.\n\nPart 2: Sine Coefficients and Fourier Series for $g(t)=t$\n\nThe given function is $g(t)=t$ on $(-\\pi, \\pi)$. This is an odd function since $g(-t) = -t = -g(t)$. Based on the result from Part 1, all its cosine coefficients $a_n$ are zero, and its Fourier series is a sine-only series.\n\nThe sine coefficients $b_n$ are given by:\n$$\nb_{n} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} g(t) \\sin(nt) \\, dt\n$$\nSubstituting $g(t)=t$:\n$$\nb_{n} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} t \\sin(nt) \\, dt\n$$\nThe integrand, $t \\sin(nt)$, is the product of two odd functions ($t$ and $\\sin(nt)$), which results in an even function. For an even function, the integral over a symmetric interval is twice the integral over the positive half-interval:\n$$\nb_{n} = \\frac{2}{\\pi} \\int_{0}^{\\pi} t \\sin(nt) \\, dt\n$$\nWe compute this integral using integration by parts, $\\int u \\, dv = uv - \\int v \\, du$. Let $u=t$ and $dv = \\sin(nt) \\, dt$. This gives $du=dt$ and $v = \\int \\sin(nt) \\, dt = -\\frac{1}{n}\\cos(nt)$.\n$$\n\\int_{0}^{\\pi} t \\sin(nt) \\, dt = \\left[ t \\left( -\\frac{1}{n}\\cos(nt) \\right) \\right]_{0}^{\\pi} - \\int_{0}^{\\pi} \\left( -\\frac{1}{n}\\cos(nt) \\right) \\, dt\n$$\n$$\n= \\left[ -\\frac{t}{n}\\cos(nt) \\right]_{0}^{\\pi} + \\frac{1}{n} \\int_{0}^{\\pi} \\cos(nt) \\, dt\n$$\nEvaluating the first term:\n$$\n\\left[ -\\frac{t}{n}\\cos(nt) \\right]_{0}^{\\pi} = \\left(-\\frac{\\pi}{n}\\cos(n\\pi)\\right) - \\left(-\\frac{0}{n}\\cos(0)\\right) = -\\frac{\\pi}{n}(-1)^{n}\n$$\nsince $\\cos(n\\pi) = (-1)^n$ for integer $n$.\nEvaluating the second term (the integral):\n$$\n\\frac{1}{n} \\int_{0}^{\\pi} \\cos(nt) \\, dt = \\frac{1}{n} \\left[ \\frac{1}{n}\\sin(nt) \\right]_{0}^{\\pi} = \\frac{1}{n^2} (\\sin(n\\pi) - \\sin(0)) = \\frac{1}{n^2}(0-0) = 0\n$$\nCombining these results, the integral is $-\\frac{\\pi}{n}(-1)^{n}$. Now, we find the coefficient $b_n$:\n$$\nb_{n} = \\frac{2}{\\pi} \\left( -\\frac{\\pi}{n}(-1)^{n} \\right) = -\\frac{2}{n}(-1)^{n} = \\frac{2}{n}(-1)(-1)^{n} = \\frac{2(-1)^{n+1}}{n}\n$$\nThis holds for $n \\ge 1$. The Fourier series for $g(t)=t$ on $(-\\pi, \\pi)$ is therefore:\n$$\ng(t) \\sim \\sum_{n=1}^{\\infty} b_{n} \\sin(nt) = \\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n} \\sin(nt)\n$$\nThis expression is the required sine-only Fourier series representation.",
            "answer": "$$\\boxed{\\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n} \\sin(nt)}$$"
        },
        {
            "introduction": "Transitioning from continuous-time theory to computational practice requires signal sampling, a process that can introduce artifacts. This practice  delves into the most critical of these artifacts: aliasing. By deriving the spectrum of a sampled sinusoid from first principles, you will uncover the mechanism by which spectral replicas are created and see how a high-frequency tone can be misinterpreted as a lower-frequency one when sampled below the Nyquist rate.",
            "id": "4124902",
            "problem": "An acoustical pressure signal generated by a narrowband source is modeled as a continuous-time sinusoid $p(t)=A\\cos(\\omega_{0}t)$, where $A0$ and $\\omega_{0}0$ are constants. A data acquisition system samples the signal uniformly at sampling period $T_{s}$, where $T_{s}=\\frac{1}{f_{s}}$ and the sampling angular frequency is $\\omega_{s}=2\\pi f_{s}$. The sampled continuous-time signal is $p_{s}(t)=p(t)\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s})$. Assume ideal point sampling and an ideal reconstruction low-pass filter that perfectly passes the baseband $[0,\\omega_{s}/2]$ and rejects all other frequency content.\n\nUsing only the foundational definitions of the continuous Fourier transform and the Fourier series of periodic impulse trains, derive the spectrum of $p_{s}(t)$ from first principles. Then, from the derived spectrum, determine the aliased angular frequency that would appear in the baseband $[0,\\omega_{s}/2]$ after ideal reconstruction. Consider the scientifically realistic case of an ultrasonic tone with $\\omega_{0}=2\\pi\\times 6000\\,\\mathrm{rad/s}$ and a sampling angular frequency $\\omega_{s}=2\\pi\\times 8000\\,\\mathrm{rad/s}$. Report the aliased angular frequency in radians per second. Provide the final answer as a single real number or a single closed-form analytic expression. No rounding is necessary. Express the angle in radians and the frequency in radians per second.",
            "solution": "The goal is to determine the spectrum of the sampled continuous-time signal and identify the frequency that appears in the baseband after ideal reconstruction. The derivation must start from the definition of the continuous Fourier transform and the known Fourier series and transform properties of periodic impulse trains.\n\n1. Definitions and setup:\n- The continuous Fourier transform (also called the Continuous-Time Fourier Transform) of a signal $x(t)$ is defined by\n$$\nX(\\omega)=\\int_{-\\infty}^{\\infty}x(t)\\exp(-\\mathrm{i}\\omega t)\\,\\mathrm{d}t,\n$$\nwith inverse\n$$\nx(t)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}X(\\omega)\\exp(\\mathrm{i}\\omega t)\\,\\mathrm{d}\\omega.\n$$\n- The signal is $p(t)=A\\cos(\\omega_{0}t)$ with $A0$ and $\\omega_{0}0$.\n- The sampling operation is modeled by multiplication with a Dirac impulse train (also called a Dirac comb) $\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s})$.\n\n2. Continuous Fourier transform of the tone:\nUsing the identity $\\cos(\\omega_{0}t)=\\frac{1}{2}\\big(\\exp(\\mathrm{i}\\omega_{0}t)+\\exp(-\\mathrm{i}\\omega_{0}t)\\big)$ and the transform of complex exponentials,\n$$\n\\int_{-\\infty}^{\\infty}\\exp(\\mathrm{i}\\omega_{0}t)\\exp(-\\mathrm{i}\\omega t)\\,\\mathrm{d}t=2\\pi\\,\\delta(\\omega-\\omega_{0}),\\quad\n\\int_{-\\infty}^{\\infty}\\exp(-\\mathrm{i}\\omega_{0}t)\\exp(-\\mathrm{i}\\omega t)\\,\\mathrm{d}t=2\\pi\\,\\delta(\\omega+\\omega_{0}),\n$$\nwe obtain the continuous Fourier transform of $p(t)$:\n$$\nP(\\omega)=\\int_{-\\infty}^{\\infty}A\\cos(\\omega_{0}t)\\exp(-\\mathrm{i}\\omega t)\\,\\mathrm{d}t\n=\\frac{A}{2}\\cdot 2\\pi\\,\\delta(\\omega-\\omega_{0})+\\frac{A}{2}\\cdot 2\\pi\\,\\delta(\\omega+\\omega_{0})\n=\\pi A\\big[\\delta(\\omega-\\omega_{0})+\\delta(\\omega+\\omega_{0})\\big].\n$$\n\n3. Spectrum of the Dirac impulse train and sampling:\nThe impulse train in time is\n$$\ns(t)=\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s}).\n$$\nIt is a periodic signal with period $T_{s}$. Its continuous Fourier transform is a scaled impulse train in angular frequency given by the well-tested result (derivable from the Fourier series of a periodic impulse train or the Poisson summation formula (PSF)):\n$$\nS(\\omega)=\\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-k\\omega_{s}),\\quad \\omega_{s}=\\frac{2\\pi}{T_{s}}.\n$$\nThe sampled continuous-time signal is $p_{s}(t)=p(t)\\,s(t)$, a product in time. The Fourier transform of a product in time is the convolution of transforms in angular frequency, scaled by $\\frac{1}{2\\pi}$:\n$$\nP_{s}(\\omega)=\\frac{1}{2\\pi}\\big(P*S\\big)(\\omega)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}P(\\lambda)\\,S(\\omega-\\lambda)\\,\\mathrm{d}\\lambda.\n$$\nSubstituting $P(\\lambda)=\\pi A[\\delta(\\lambda-\\omega_{0})+\\delta(\\lambda+\\omega_{0})]$ and $S(\\omega-\\lambda)=\\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-\\lambda-k\\omega_{s})$ yields\n$$\nP_{s}(\\omega)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}\\pi A\\big[\\delta(\\lambda-\\omega_{0})+\\delta(\\lambda+\\omega_{0})\\big]\\cdot \\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-\\lambda-k\\omega_{s})\\,\\mathrm{d}\\lambda.\n$$\nEvaluating the integral using the sifting property of the Dirac delta distribution,\n$$\nP_{s}(\\omega)=\\frac{\\pi A}{2\\pi}\\cdot \\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\Big[\\delta\\big(\\omega-\\omega_{0}-k\\omega_{s}\\big)+\\delta\\big(\\omega+\\omega_{0}-k\\omega_{s}\\big)\\Big]\n=\\frac{\\pi A}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\Big[\\delta\\big(\\omega-(\\omega_{0}+k\\omega_{s})\\big)+\\delta\\big(\\omega-(-\\omega_{0}+k\\omega_{s})\\big)\\Big].\n$$\nTherefore, sampling replicates the original line spectrum at shifted angular frequencies\n$$\n\\omega=\\omega_{0}+k\\omega_{s}\\quad\\text{and}\\quad \\omega=-\\omega_{0}+k\\omega_{s},\\quad k\\in\\mathbb{Z},\n$$\nwith amplitudes scaled by $\\frac{\\pi A}{T_{s}}$. This is the classical spectral replication mechanism underlying aliasing.\n\n4. Identifying the aliased baseband line:\nAn ideal reconstruction low-pass filter that passes $[0,\\omega_{s}/2]$ will select whichever spectral line from the set $\\{\\omega_{0}+k\\omega_{s},\\,-\\omega_{0}+k\\omega_{s}\\}$ falls into the passband. For given numerical values,\n$$\n\\omega_{0}=2\\pi\\times 6000=12000\\pi,\\quad \\omega_{s}=2\\pi\\times 8000=16000\\pi,\n$$\nand the baseband is $[0,\\omega_{s}/2]=[0,8000\\pi]$.\n\nWe examine the two sequences of lines:\n- $\\omega=\\omega_{0}+k\\omega_{s}=12000\\pi+16000\\pi\\,k$.\n- $\\omega=-\\omega_{0}+k\\omega_{s}=-12000\\pi+16000\\pi\\,k$.\n\nFor $k=0$, $\\omega=12000\\pi$ is outside the baseband. For $k=1$, the second sequence gives\n$$\n\\omega=-12000\\pi+16000\\pi=4000\\pi,\n$$\nwhich lies in $[0,8000\\pi]$. For other integers $k$, the nearest baseband line would be farther away; for example, $k=-1$ yields $\\omega=-28000\\pi$ or $\\omega=-4000\\pi$ (negative), and $k=2$ yields $\\omega=8000\\pi$ or $\\omega=20000\\pi$, where $\\omega=8000\\pi$ is at the cutoff but the principal aliased tone is the in-band $4000\\pi$. The standard aliasing mapping can be recognized as\n$$\n\\omega_{\\mathrm{alias}}=\\big|\\omega_{0}-\\omega_{s}\\big|=|12000\\pi-16000\\pi|=4000\\pi,\n$$\nwhich is within $[0,\\omega_{s}/2]$.\n\n5. Conclusion:\nThe continuous-time spectrum of the sampled signal consists of line spectra at $\\omega=\\omega_{0}+k\\omega_{s}$ and $\\omega=-\\omega_{0}+k\\omega_{s}$, $k\\in\\mathbb{Z}$, scaled by $\\frac{\\pi A}{T_{s}}$. Under ideal baseband reconstruction, the aliased angular frequency observed is\n$$\n\\omega_{\\mathrm{alias}}=4000\\pi\\ \\text{rad/s}.\n$$\nNo rounding is necessary, and the angle unit is radians.",
            "answer": "$$\\boxed{4000\\pi}$$"
        },
        {
            "introduction": "In practice, we can only ever analyze finite-duration segments of a signal, an operation equivalent to multiplying the signal by a window function. This truncation introduces an artifact known as spectral leakage, which can obscure the true frequency content. This hands-on exercise  guides you through the analysis of this phenomenon, comparing the performance of a simple rectangular window with a more sophisticated Hann window to understand the crucial trade-off between mainlobe resolution and sidelobe suppression.",
            "id": "4124996",
            "problem": "Consider a finite-duration acoustic tone modeled as a complex sinusoid multiplied by a deterministic window. Let $w(t)$ be a real, even window of duration $T$ seconds, supported on $[-T/2,T/2]$, and let the tone be $x(t)=e^{i\\omega_0 t}w(t)$, where $\\omega_0$ is the angular frequency in radians per second. The continuous-time Fourier transform is defined by $X(\\omega)=\\int_{-\\infty}^{\\infty}x(t)e^{-i\\omega t}\\,dt$ for angular frequency $\\omega$ in radians per second. By the frequency shift property, $X(\\omega)=W(\\omega-\\omega_0)$ where $W(\\omega)=\\int_{-\\infty}^{\\infty}w(t)e^{-i\\omega t}\\,dt$ is the continuous-time Fourier transform of the window.\n\nDefine the normalized leakage pattern at frequency offset $\\Delta\\omega=\\omega-\\omega_0$ as $L_w(\\Delta\\omega)=\\dfrac{|W(\\Delta\\omega)|}{|W(0)|}$, so that $L_w(0)=1$. The mainlobe is the central peak around $\\Delta\\omega=0$, and the sidelobes are the oscillatory peaks between consecutive zeros of $L_w(\\Delta\\omega)$.\n\nYou will analyze two windows:\n- The rectangular window $w_{\\mathrm{rect}}(t)=1$ for $t\\in[-T/2,T/2]$ and $w_{\\mathrm{rect}}(t)=0$ otherwise.\n- The Hann (raised-cosine) window $w_{\\mathrm{hann}}(t)=\\dfrac{1}{2}\\left(1+\\cos\\left(\\dfrac{2\\pi t}{T}\\right)\\right)$ for $t\\in[-T/2,T/2]$ and $w_{\\mathrm{hann}}(t)=0$ otherwise.\n\nStarting from the definition of the continuous-time Fourier transform and basic properties (linearity and frequency shift), derive expressions suitable for numerically evaluating $L_{w_{\\mathrm{rect}}}(\\Delta\\omega)$ and $L_{w_{\\mathrm{hann}}}(\\Delta\\omega)$. Using these expressions, compute and report for each window:\n1. The mainlobe width in radians per second, defined as the distance between the two nearest zeros of $L_w(\\Delta\\omega)$ that bracket $\\Delta\\omega=0$.\n2. The first sidelobe level, defined as the maximum of $L_w(\\Delta\\omega)$ over the first sidelobe interval immediately following the first zero on the positive side, expressed in decibels via $20\\log_{10}(\\cdot)$.\n\nAngle units must be in radians and angular frequency in radians per second. All computations should be performed in terms of angular frequency. The program must implement robust numerical evaluation of the first sidelobe level for both windows, without relying on any discrete-time fast Fourier transform shortcuts. For the rectangular window, use first principles to locate the first sidelobe maximum accurately (e.g., by solving the derivative condition). For the Hann window, evaluate $L_{w_{\\mathrm{hann}}}(\\Delta\\omega)$ on a sufficiently fine grid within the first sidelobe interval to locate its maximum.\n\nTest Suite:\nFor each parameter pair $(T,\\omega_0)$ below, compute and return a list with four floating-point values in the order\n$[\\text{mainlobe\\_width\\_rect},\\text{first\\_sidelobe\\_dB\\_rect},\\text{mainlobe\\_width\\_hann},\\text{first\\_sidelobe\\_dB\\_hann}]$.\nUse the following cases:\n- Case A (general): $T=0.02$, $\\omega_0=2\\pi\\cdot 1000$.\n- Case B (longer duration): $T=0.1$, $\\omega_0=2\\pi\\cdot 200$.\n- Case C (very long duration, narrow mainlobe): $T=1.0$, $\\omega_0=2\\pi\\cdot 10$.\n- Case D (very short duration, wide mainlobe): $T=0.001$, $\\omega_0=2\\pi\\cdot 1000$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, with no spaces. For example, for two cases it would look like \"[[a,b,c,d],[e,f,g,h]]\". For the four cases in the test suite, your program must print a single line in the format \"[[r11,r12,r13,r14],[r21,r22,r23,r24],[r31,r32,r33,r34],[r41,r42,r43,r44]]\", where each $r_{ij}$ is a float.",
            "solution": "The problem requires the analysis of the spectral characteristics of two window functions, the rectangular window and the Hann window, within the context of Fourier analysis. We are asked to derive expressions for the spectral leakage patterns and use them to compute the mainlobe width and the first sidelobe level for each window. The problem is scientifically grounded, well-posed, and all definitions are standard in signal processing. The provided parameters are sufficient for a unique solution.\n\nFirst, let us establish the core definitions. The continuous-time Fourier transform (CTFT) of a signal $g(t)$ is $G(\\omega) = \\int_{-\\infty}^{\\infty} g(t) e^{-i\\omega t} dt$. The signal of interest is a complex tone $x(t) = e^{i\\omega_0 t} w(t)$, where $w(t)$ is a window function of duration $T$ supported on $[-T/2, T/2]$. By the frequency-shifting property of the CTFT, the spectrum of $x(t)$ is $X(\\omega) = W(\\omega - \\omega_0)$, where $W(\\omega)$ is the CTFT of the window $w(t)$.\n\nThe analysis focuses on the normalized leakage pattern, defined as $L_w(\\Delta\\omega) = \\frac{|W(\\Delta\\omega)|}{|W(0)|}$, where $\\Delta\\omega = \\omega - \\omega_0$ is the frequency offset from the tone's center frequency. This function describes the shape of the window's spectrum, normalized to have a peak value of $1$ at $\\Delta\\omega = 0$. The quantities to be calculated—mainlobe width and sidelobe level—are properties of $L_w(\\Delta\\omega)$ and thus depend only on the window function $w(t)$ and its duration $T$, not on the tone's specific frequency $\\omega_0$.\n\n**1. Rectangular Window Analysis**\n\nThe rectangular window is defined as:\n$$\nw_{\\mathrm{rect}}(t) = \\begin{cases} 1  \\text{for } |t| \\le T/2 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nIts CTFT, $W_{\\mathrm{rect}}(\\omega)$, is calculated as:\n$$\nW_{\\mathrm{rect}}(\\omega) = \\int_{-T/2}^{T/2} 1 \\cdot e^{-i\\omega t} dt = \\left[ \\frac{e^{-i\\omega t}}{-i\\omega} \\right]_{-T/2}^{T/2} = \\frac{e^{-i\\omega T/2} - e^{i\\omega T/2}}{-i\\omega}\n$$\nUsing Euler's formula, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, we get:\n$$\nW_{\\mathrm{rect}}(\\omega) = \\frac{-2i\\sin(\\omega T/2)}{-i\\omega} = \\frac{2\\sin(\\omega T/2)}{\\omega} = T \\frac{\\sin(\\omega T/2)}{\\omega T/2}\n$$\nThis expression is proportional to the unnormalized sinc function. For the case $\\omega = 0$, we evaluate the integral directly:\n$$\nW_{\\mathrm{rect}}(0) = \\int_{-T/2}^{T/2} 1 \\, dt = T\n$$\nThe normalized leakage pattern for the frequency offset $\\Delta\\omega$ is therefore:\n$$\nL_{w_{\\mathrm{rect}}}(\\Delta\\omega) = \\frac{|W_{\\mathrm{rect}}(\\Delta\\omega)|}{|W_{\\mathrm{rect}}(0)|} = \\frac{\\left| T \\frac{\\sin(\\Delta\\omega T/2)}{\\Delta\\omega T/2} \\right|}{|T|} = \\left| \\frac{\\sin(\\Delta\\omega T/2)}{\\Delta\\omega T/2} \\right|\n$$\nMainlobe Width: The mainlobe is the central region around $\\Delta\\omega=0$ bounded by the first pair of zeros. The zeros of $L_{w_{\\mathrm{rect}}}(\\Delta\\omega)$ occur when the numerator is zero and the denominator is not. This happens when $\\sin(\\Delta\\omega T/2) = 0$, which implies $\\Delta\\omega T/2 = k\\pi$ for any non-zero integer $k$. The first zeros bracketing the origin correspond to $k = \\pm 1$.\n$$\n\\Delta\\omega T/2 = \\pm\\pi \\implies \\Delta\\omega = \\pm\\frac{2\\pi}{T}\n$$\nThe mainlobe width is the distance between these two zeros:\n$$\n\\text{Mainlobe Width}_{\\mathrm{rect}} = \\frac{2\\pi}{T} - \\left(-\\frac{2\\pi}{T}\\right) = \\frac{4\\pi}{T}\n$$\nFirst Sidelobe Level: The first sidelobe occurs between the first and second zeros, i.e., for $\\Delta\\omega T/2 \\in [\\pi, 2\\pi]$. To find its maximum level, we must find the maximum of the function $f(x) = |\\sin(x)/x|$ for $x \\in [\\pi, 2\\pi]$, where $x = \\Delta\\omega T/2$. We find the extrema by setting the derivative to zero:\n$$\n\\frac{d}{dx}\\left(\\frac{\\sin x}{x}\\right) = \\frac{x\\cos x - \\sin x}{x^2} = 0 \\implies x\\cos x = \\sin x \\implies \\tan x = x\n$$\nWe need to find the first positive root of the transcendental equation $\\tan x = x$ in the interval $(\\pi, 2\\pi)$. This must be done numerically. Let the root be $x_{\\mathrm{peak}}$. The maximum amplitude of the first sidelobe is then $| \\sin(x_{\\mathrm{peak}})/x_{\\mathrm{peak}} |$. This value is a constant, independent of $T$. A numerical solver finds $x_{\\mathrm{peak}} \\approx 4.493409$. The corresponding level is $|\\sin(x_{\\mathrm{peak}})/x_{\\mathrm{peak}}| \\approx 0.21723$. In decibels (dB), this is:\n$$\n\\text{First Sidelobe Level}_{\\mathrm{rect}} = 20\\log_{10}(0.21723) \\approx -13.26 \\text{ dB}\n$$\n\n**2. Hann Window Analysis**\n\nThe Hann window is defined as:\n$$\nw_{\\mathrm{hann}}(t) = \\begin{cases} \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{2\\pi t}{T}\\right)\\right)  \\text{for } |t| \\le T/2 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nUsing Euler's formula, we can express the cosine term as complex exponentials:\n$$\nw_{\\mathrm{hann}}(t) = \\left(\\frac{1}{2} + \\frac{1}{4}e^{i\\frac{2\\pi}{T}t} + \\frac{1}{4}e^{-i\\frac{2\\pi}{T}t}\\right) \\cdot w_{\\mathrm{rect}}(t)\n$$\nwhere $w_{\\mathrm{rect}}(t)$ is the rectangular window of duration $T$. Using the linearity and frequency-shifting properties of the CTFT, the transform of the Hann window is a sum of three shifted transforms of the rectangular window:\n$$\nW_{\\mathrm{hann}}(\\omega) = \\frac{1}{2}W_{\\mathrm{rect}}(\\omega) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\omega - \\frac{2\\pi}{T}\\right) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\omega + \\frac{2\\pi}{T}\\right)\n$$\nTo find the normalization factor $W_{\\mathrm{hann}}(0)$, we evaluate the expression at $\\omega=0$:\n$$\nW_{\\mathrm{hann}}(0) = \\frac{1}{2}W_{\\mathrm{rect}}(0) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(-\\frac{2\\pi}{T}\\right) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\frac{2\\pi}{T}\\right)\n$$\nSince $W_{\\mathrm{rect}}(\\pm 2\\pi/T) = 0$ (these are the first zeros of the rectangular window's spectrum) and $W_{\\mathrm{rect}}(0) = T$, we have:\n$$\nW_{\\mathrm{hann}}(0) = \\frac{1}{2}T + \\frac{1}{4}(0) + \\frac{1}{4}(0) = \\frac{T}{2}\n$$\nThe leakage pattern is thus:\n$$\nL_{w_{\\mathrm{hann}}}(\\Delta\\omega) = \\frac{|W_{\\mathrm{hann}}(\\Delta\\omega)|}{|W_{\\mathrm{hann}}(0)|} = \\frac{\\left| \\frac{1}{2}W_{\\mathrm{rect}}(\\Delta\\omega) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\Delta\\omega - \\frac{2pi}{T}\\right) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\Delta\\omega + \\frac{2\\pi}{T}\\right) \\right|}{T/2}\n$$\nSubstituting the expression for $W_{\\mathrm{rect}}(\\omega)$, and letting $S(x) = T\\frac{\\sin(xT/2)}{xT/2}$, we obtain:\n$$\nL_{w_{\\mathrm{hann}}}(\\Delta\\omega) = \\left| \\frac{\\frac{1}{2}S(\\Delta\\omega) + \\frac{1}{4}S(\\Delta\\omega - \\frac{2\\pi}{T}) + \\frac{1}{4}S(\\Delta\\omega + \\frac{2\\pi}{T})}{T/2} \\right|\n$$\nThis expression is best evaluated numerically in this form to avoid issues with removable singularities.\n\nMainlobe Width: The zeros of $W_{\\mathrm{hann}}(\\omega)$ are created by the cancellation of the three shifted sinc functions. It can be shown that the first zeros bracketing the origin are at $\\Delta\\omega = \\pm \\frac{4\\pi}{T}$.\nThe mainlobe width is the distance between these two zeros:\n$$\n\\text{Mainlobe Width}_{\\mathrm{hann}} = \\frac{4\\pi}{T} - \\left(-\\frac{4\\pi}{T}\\right) = \\frac{8\\pi}{T}\n$$\nThis is exactly twice the mainlobe width of the rectangular window.\n\nFirst Sidelobe Level: The first sidelobe for the Hann window lies in the frequency offset range between the second and third zeros of the building-block sinc function, which translates to $\\Delta\\omega \\in [4\\pi/T, 6\\pi/T]$. The problem asks for this value to be determined by evaluating $L_{w_{\\mathrm{hann}}}(\\Delta\\omega)$ on a sufficiently fine grid within this interval and finding the maximum. As with the rectangular window, this sidelobe level is a constant independent of $T$. Numerical evaluation reveals a peak level of approximately $0.0267$, which in decibels is:\n$$\n\\text{First Sidelobe Level}_{\\mathrm{hann}} = 20\\log_{10}(0.0267) \\approx -31.47 \\text{ dB}\n$$\nThis demonstrates the superior sidelobe suppression of the Hann window compared to the rectangular window, at the cost of a wider mainlobe.\n\nThe following Python code implements these calculations for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the Fourier analysis problem for rectangular and Hann windows.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T, omega_0). omega_0 is not used in the calculations.\n    test_cases = [\n        (0.02, 2 * np.pi * 1000),\n        (0.1, 2 * np.pi * 200),\n        (1.0, 2 * np.pi * 10),\n        (0.001, 2 * np.pi * 1000),\n    ]\n\n    # --- Sidelobe level calculations (constants independent of T) ---\n\n    # 1. Rectangular window first sidelobe level\n    # Find the peak of the first sidelobe by solving tan(x) = x.\n    # The first positive root occurs in the interval (pi, 3*pi/2).\n    # The target function is f(x) = tan(x) - x.\n    def tan_minus_x(x):\n        return np.tan(x) - x\n    \n    # Use a bracket slightly smaller than (pi, 3*pi/2) for robustness.\n    sol = root_scalar(tan_minus_x, bracket=[np.pi + 1e-6, 1.5 * np.pi - 1e-6])\n    x_peak_rect = sol.root\n    \n    # Sidelobe level is |sin(x_peak)/x_peak}|\n    sidelobe_level_rect_linear = np.abs(np.sin(x_peak_rect) / x_peak_rect)\n    first_sidelobe_dB_rect = 20 * np.log10(sidelobe_level_rect_linear)\n\n    # 2. Hann window first sidelobe level\n    # Use the normalized sinc function from numpy: np.sinc(x) = sin(pi*x)/(pi*x)\n    # To get sin(u)/u, we must evaluate np.sinc(u/pi).\n    def L_hann_norm(u):\n        # Leakage pattern for Hann window as a function of u = Delta_omega * T / 2\n        term1 = np.sinc(u / np.pi)\n        term2 = 0.5 * np.sinc((u - np.pi) / np.pi)\n        term3 = 0.5 * np.sinc((u + np.pi) / np.pi)\n        return np.abs(term1 + term2 + term3)\n\n    # The first sidelobe is in the interval u in [2*pi, 3*pi].\n    # Search for the maximum on a fine grid.\n    u_grid = np.linspace(2 * np.pi, 3 * np.pi, 20000)\n    sidelobe_levels_hann = L_hann_norm(u_grid)\n    sidelobe_level_hann_linear = np.max(sidelobe_levels_hann)\n    first_sidelobe_dB_hann = 20 * np.log10(sidelobe_level_hann_linear)\n\n    # --- Main loop for processing test cases ---\n    \n    results = []\n    for T, omega_0 in test_cases:\n        # Rectangular window calculations\n        mainlobe_width_rect = 4 * np.pi / T\n        \n        # Hann window calculations\n        mainlobe_width_hann = 8 * np.pi / T\n        \n        case_results = [\n            mainlobe_width_rect,\n            first_sidelobe_dB_rect,\n            mainlobe_width_hann,\n            first_sidelobe_dB_hann\n        ]\n        results.append(case_results)\n\n    # --- Format and print the final output ---\n    # The required format is [[r11,r12,r13,r14],[r21,r22,r23,r24],...] with no spaces.\n    inner_strings = [f\"[{','.join(f'{v:.10f}' for v in inner_list)}]\" for inner_list in results]\n    final_output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}