{
    "hands_on_practices": [
        {
            "introduction": "在计算声学中，许多复杂的周期性声压波形可以被理想化为简单的几何形状，例如方波。这项练习将引导您运用复傅里叶级数的定义，将一个理想方波分解为其谐波分量，并探索傅里叶级数在不连续点处的收敛行为，这对于理解吉布斯现象等数值伪影至关重要。通过这项实践 ，您将掌握分析非连续信号频谱内容的基础理论工具。",
            "id": "4124916",
            "problem": "刚性管道口处的理想化周期性声压波形，在通过基角频率进行无量纲化后，可以建模为周期是 $2\\pi$ 的方波 $f(t) = \\mathrm{sgn}(\\sin t)$。在计算声学中，截断的傅里叶级数展开被用来近似此类边界激励，以用于线性波动方程的谱方法求解器。\n\n仅使用 $2\\pi$ 周期函数的复傅里叶级数系数的定义，以及傅里叶部分和在不连续点处逐点收敛于左右极限平均值这一性质，完成以下任务：\n- 对所有整数 $n$，推导 $f(t)$ 的复傅里叶级数系数 $c_{n}$ 的显式闭式表达式。\n- 基于跳跃平均原理，预测 $N$ 项复傅里叶部分和 $S_{N}(t) = \\sum_{n=-N}^{N} c_{n} \\exp(i n t)$ 在不连续点 $t = k\\pi$（其中 $k$ 为任意整数）处的逐点极限。\n\n请以一个数对的形式提供最终答案，该数对由对所有整数 $n$ 均有效的 $c_{n}$ 表达式和在不连续点处 $S_{N}(t)$ 的预测逐点极限组成。答案无需进行数值取整，也不应包含任何物理单位。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确、客观且内部一致。它提出了傅里叶分析领域中的一个标准问题，该问题在计算声学中有直接应用。\n\n问题要求关于函数 $f(t) = \\mathrm{sgn}(\\sin t)$ 的两个结果：复傅里叶级数系数 $c_{n}$ 以及傅里叶级数在函数不连续点处的逐点极限。该函数的周期为 $T = 2\\pi$，这意味着基角频率为 $\\omega_{0} = \\frac{2\\pi}{T} = 1$。\n\n首先，我们推导对所有整数 $n$ 的复傅里叶级数系数 $c_{n}$。对于一个周期为 $2\\pi$ 的函数 $f(t)$，第 $n$ 个复傅里叶系数的定义由下式给出：\n$$ c_{n} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} f(t) \\exp(-i n t) \\, \\mathrm{d}t $$\n函数 $f(t) = \\mathrm{sgn}(\\sin t)$ 在区间 $[-\\pi, \\pi]$ 上可以分段表示为：\n$$ f(t) = \\begin{cases} 1  \\text{if } 0  t  \\pi \\\\ -1  \\text{if } -\\pi  t  0 \\\\ 0  \\text{if } t=0, \\pm\\pi \\end{cases} $$\n积分可以相应地拆分。我们首先考虑 $n=0$ 的情况。\n$$ c_{0} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} f(t) \\, \\mathrm{d}t = \\frac{1}{2\\pi} \\left( \\int_{-\\pi}^{0} (-1) \\, \\mathrm{d}t + \\int_{0}^{\\pi} (1) \\, \\mathrm{d}t \\right) $$\n计算积分：\n$$ c_{0} = \\frac{1}{2\\pi} \\left( [-t]_{-\\pi}^{0} + [t]_{0}^{\\pi} \\right) = \\frac{1}{2\\pi} \\left( (0 - (-\\pi)) + (\\pi - 0) \\right) = \\frac{1}{2\\pi} (-\\pi + \\pi) = 0 $$\n所以，该函数的平均值为 $0$。\n\n接下来，我们考虑 $n \\neq 0$ 的情况。\n$$ c_{n} = \\frac{1}{2\\pi} \\left( \\int_{-\\pi}^{0} (-1) \\exp(-i n t) \\, \\mathrm{d}t + \\int_{0}^{\\pi} (1) \\exp(-i n t) \\, \\mathrm{d}t \\right) $$\n我们计算积分：\n$$ \\int \\exp(-i n t) \\, \\mathrm{d}t = \\frac{\\exp(-i n t)}{-i n} = \\frac{i \\exp(-i n t)}{n} $$\n将此结果代入 $c_{n}$ 的表达式中：\n$$ c_{n} = \\frac{1}{2\\pi} \\left[ -\\left[ \\frac{i \\exp(-i n t)}{n} \\right]_{-\\pi}^{0} + \\left[ \\frac{i \\exp(-i n t)}{n} \\right]_{0}^{\\pi} \\right] $$\n$$ c_{n} = \\frac{i}{2\\pi n} \\left[ -(\\exp(0) - \\exp(i n \\pi)) + (\\exp(-i n \\pi) - \\exp(0)) \\right] $$\n使用欧拉恒等式，我们知道 $\\exp(i n \\pi) = \\cos(n\\pi) + i\\sin(n\\pi) = (-1)^{n}$ 和 $\\exp(-i n \\pi) = \\cos(-n\\pi) + i\\sin(-n\\pi) = (-1)^{n}$。此外，$\\exp(0)=1$。\n$$ c_{n} = \\frac{i}{2\\pi n} \\left[ -(1 - (-1)^{n}) + ((-1)^{n} - 1) \\right] $$\n$$ c_{n} = \\frac{i}{2\\pi n} \\left[ -1 + (-1)^{n} + (-1)^{n} - 1 \\right] $$\n$$ c_{n} = \\frac{i}{2\\pi n} \\left[ 2(-1)^{n} - 2 \\right] = \\frac{i}{\\pi n} \\left( (-1)^{n} - 1 \\right) $$\n我们分析当 $n$ 为偶数和奇数时（其中 $n \\neq 0$）的结果。\n如果 $n$ 是非零偶数，则 $(-1)^{n} = 1$，所以 $c_{n} = \\frac{i}{\\pi n} (1-1) = 0$。\n如果 $n$ 是奇数，则 $(-1)^{n} = -1$，所以 $c_{n} = \\frac{i}{\\pi n} (-1-1) = -\\frac{2i}{\\pi n}$。\n将这些结果与 $c_{0}=0$ 的情况（注意 $0$ 是一个偶数）相结合，我们可以为所有整数 $n$ 写出一个统一的规则：\n$$ c_{n} = \\begin{cases} 0  \\text{if } n \\text{ is even} \\\\ -\\frac{2i}{\\pi n}  \\text{if } n \\text{ is odd} \\end{cases} $$\n这就是系数 $c_n$ 的显式闭式表达式。\n\n第二，我们预测傅里叶部分和 $S_{N}(t) = \\sum_{n=-N}^{N} c_{n} \\exp(i n t)$ 在不连续点 $t = k\\pi$（其中 $k$ 为任意整数）处的逐点极限。问题指示我们使用跳跃平均原理，这是关于傅里叶级数收敛性的狄利克雷定理 (Dirichlet's theorem) 的一个关键结果。该定理指出，对于在点 $t_{0}$ 处具有左右极限的分段连续函数 $f(t)$，其傅里叶级数收敛于这些极限的平均值：\n$$ \\lim_{N \\to \\infty} S_{N}(t_0) = \\frac{1}{2} \\left[ f(t_{0}^{-}) + f(t_{0}^{+}) \\right] $$\n其中 $f(t_{0}^{-}) = \\lim_{t \\to t_{0}^{-}} f(t)$ 且 $f(t_{0}^{+}) = \\lim_{t \\to t_{0}^{+}} f(t)$。\n\n函数 $f(t) = \\mathrm{sgn}(\\sin t)$ 的不连续点发生在 $\\sin t = 0$ 时，即对所有整数 $k$，在 $t = k\\pi$ 处。我们必须求出在这些点上的左右极限。\n\n情况1：$k$ 为偶数。令 $k = 2m$，其中 $m$ 为某个整数。不连续点位于 $t_{0} = 2m\\pi$。\n左极限为 $f((2m\\pi)^{-}) = \\lim_{\\epsilon \\to 0^{+}} \\mathrm{sgn}(\\sin(2m\\pi - \\epsilon)) = \\mathrm{sgn}(\\sin(-\\epsilon)) = \\mathrm{sgn}(-\\sin\\epsilon) = -1$。\n右极限为 $f((2m\\pi)^{+}) = \\lim_{\\epsilon \\to 0^{+}} \\mathrm{sgn}(\\sin(2m\\pi + \\epsilon)) = \\mathrm{sgn}(\\sin(\\epsilon)) = 1$。\n平均值为 $\\frac{1}{2} [(-1) + 1] = 0$。\n\n情况2：$k$ 为奇数。令 $k = 2m+1$，其中 $m$ 为某个整数。不连续点位于 $t_{0} = (2m+1)\\pi$。\n左极限为 $f(((2m+1)\\pi)^{-}) = \\lim_{\\epsilon \\to 0^{+}} \\mathrm{sgn}(\\sin((2m+1)\\pi - \\epsilon)) = \\mathrm{sgn}(\\sin(\\pi - \\epsilon)) = \\mathrm{sgn}(\\sin\\epsilon) = 1$。\n右极限为 $f(((2m+1)\\pi)^{+}) = \\lim_{\\epsilon \\to 0^{+}} \\mathrm{sgn}(\\sin((2m+1)\\pi + \\epsilon)) = \\mathrm{sgn}(\\sin(\\pi + \\epsilon)) = \\mathrm{sgn}(-\\sin\\epsilon) = -1$。\n平均值为 $\\frac{1}{2} [1 + (-1)] = 0$。\n\n在两种情况下，左右极限的平均值均为 $0$。因此，根据跳跃平均原理，在任意不连续点 $t = k\\pi$ 处，傅里叶级数的逐点极限为 $0$。\n\n最终答案由一个数对组成：$c_n$ 的表达式和预测的极限值。",
            "answer": "$$\\boxed{\\begin{pmatrix} c_n = \\begin{cases} -\\frac{2i}{\\pi n}  \\text{if } n \\text{ is odd} \\\\ 0  \\text{if } n \\text{ is even} \\end{cases}  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然我们可以为简单函数推导出傅里叶系数的解析解，但大多数真实世界的信号和复杂的声学模型都需要数值方法来分析。这项练习旨在搭建理论与计算之间的桥梁，您将通过编写代码，使用数值积分来计算一个平滑周期函数的傅里叶系数。更重要的是，您需要将数值结果与基于特殊函数（贝塞尔函数）的精确解析解进行比较 ，这是验证计算代码准确性的核心实践，也是计算科学家的基本功。",
            "id": "4124913",
            "problem": "考虑一个归一化声压波形 $p(t)$，其周期为 $T = 1\\,\\text{s}$，定义为 $p(t) = \\exp\\!\\big(\\beta \\cos(2\\pi t)\\big)$，其中 $t$ 是以秒为单位的时间，所有角度参数均以弧度为单位。在计算声学中，通过傅里叶级数恢复周期性压力信号的谐波成分是基础性工作。从 $[0,1]$ 上实数傅里叶级数的核心定义出发，\n$$\np(t) = \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} \\big(a_n \\cos(2\\pi n t) + b_n \\sin(2\\pi n t)\\big),\n$$\n其系数定义为\n$$\na_n = \\frac{2}{T}\\int_0^T p(t)\\cos\\left(\\frac{2\\pi n t}{T}\\right)\\,dt,\\quad\nb_n = \\frac{2}{T}\\int_0^T p(t)\\sin\\left(\\frac{2\\pi n t}{T}\\right)\\,dt,\n$$\n您必须使用均匀网格和复合梯形法则进行数值积分，从第一性原理出发，数值计算 $T=1\\,\\text{s}$ 时的系数。然后，利用特殊函数的成熟性质，从定义积分直接获得解析系数，并用其严格验证这些数值系数。具体而言，使用积分定义和正交性来确定 $p(t)$ 的傅里叶系数的解析形式，并用已知特殊函数的标准记法来表示它们。\n\n您的程序必须：\n- 在一个周期 $[0,1]$ 上，使用 $M$ 个采样点的均匀网格，通过复合梯形法则实现对最高为谐波指数 $N$ 的 $a_n$ 和 $b_n$ 的数值评估。\n- 推导并实现根据积分定义和第一类修正贝塞尔函数的性质得出的 $a_n$ 和 $b_n$ 的解析表达式。\n- 对每个测试用例，计算一个单一的标量性能指标，该指标等于所有计算谐波中的最大绝对差异：\n$$\nE_{\\max} = \\max\\left(\\max_{0\\le n\\le N}\\left|a_n^{\\text{num}} - a_n^{\\text{ana}}\\right|,\\;\\max_{1\\le n\\le N}\\left|b_n^{\\text{num}} - b_n^{\\text{ana}}\\right|\\right),\n$$\n其中 $a_n^{\\text{num}}$ 和 $b_n^{\\text{num}}$ 是数值估计值，$a_n^{\\text{ana}}$ 和 $b_n^{\\text{ana}}$ 是您推导的解析系数；请注意，$b_0$ 恒为零，不包含在该指标中。\n\n测试套件：\n- 情况 $1$ (常规路径，高分辨率): $(\\beta, M, N) = (0.5, 4096, 20)$。\n- 情况 $2$ (边界条件 $\\beta=0$): $(\\beta, M, N) = (0.0, 128, 10)$。\n- 情况 $3$ (粗糙网格和更高次谐波的边缘情况): $(\\beta, M, N) = (3.0, 256, 50)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[E_1,E_2,E_3]$），其中每个 $E_i$ 是对应于第 $i$ 个测试用例的 $E_{\\max}$ 浮点数。",
            "solution": "所提出的问题具有科学依据、提法恰当、客观且自成体系，没有明显的矛盾或歧义。它代表了计算科学中的一个标准练习，将傅里叶级数的解析理论与其数值实现和验证联系起来。因此，该问题被认为是有效的。\n\n解决方案分三个阶段进行：首先，推导解析傅里叶系数；其次，基于指定的复合梯形法则制定数值方案；第三，计算指定的误差度量。\n\n### 1. 解析傅里叶系数\n\n给定的压力波形为 $p(t) = \\exp(\\beta \\cos(2\\pi t))$，周期为 $T=1\\,\\text{s}$。在区间 $[0, T]$ 上的实数傅里叶级数系数由下式给出：\n$$a_n = \\frac{2}{T}\\int_0^T p(t)\\cos\\left(\\frac{2\\pi n t}{T}\\right)\\,\\mathrm{d}t$$\n$$b_n = \\frac{2}{T}\\int_0^T p(t)\\sin\\left(\\frac{2\\pi n t}{T}\\right)\\,\\mathrm{d}t$$\n对于 $T=1$，这些简化为：\n$$a_n = 2\\int_0^1 e^{\\beta \\cos(2\\pi t)} \\cos(2\\pi n t)\\,\\mathrm{d}t \\quad (n \\ge 0)$$\n$$b_n = 2\\int_0^1 e^{\\beta \\cos(2\\pi t)} \\sin(2\\pi n t)\\,\\mathrm{d}t \\quad (n \\ge 1)$$\n\n为了计算这些积分，我们首先分析被积函数的对称性。函数 $p(t)$ 是一个偶函数，因为 $p(-t) = \\exp(\\beta \\cos(-2\\pi t)) = \\exp(\\beta \\cos(2\\pi t)) = p(t)$。\n系数 $b_n$ 是一个偶函数 $p(t)$ 和一个奇函数 $\\sin(2\\pi n t)$ 乘积的积分。得到的被积函数 $p(t)\\sin(2\\pi n t)$ 是奇函数。对于一个周期为 $T$ 的函数，在一个周期上的积分与起点无关，因此 $\\int_0^T f(t)\\,\\mathrm{d}t = \\int_{-T/2}^{T/2} f(t)\\,\\mathrm{d}t$。奇函数在对称区间（如 $[-1/2, 1/2]$）上的积分恒为零。因此，解析系数 $b_n$ 全部为零。\n$$b_n^{\\text{ana}} = 0 \\quad \\text{for } n \\ge 1$$\n\n为了求出 $a_n$ 系数，我们在积分定义中进行变量替换。令 $\\theta = 2\\pi t$，这意味着 $\\mathrm{d}t = \\mathrm{d}\\theta / (2\\pi)$。积分区间 $t \\in [0, 1]$ 映射到 $\\theta \\in [0, 2\\pi]$。\n$$a_n = 2 \\int_0^{2\\pi} e^{\\beta \\cos\\theta} \\cos(n\\theta) \\frac{\\mathrm{d}\\theta}{2\\pi} = \\frac{1}{\\pi} \\int_0^{2\\pi} e^{\\beta \\cos\\theta} \\cos(n\\theta) \\,\\mathrm{d}\\theta$$\n被积函数 $g(\\theta) = e^{\\beta \\cos\\theta} \\cos(n\\theta)$ 是 $\\theta$ 的偶函数，并且是 $2\\pi$ 周期的。对于此类函数，我们可以使用性质 $\\int_0^{2\\pi} g(\\theta)\\,\\mathrm{d}\\theta = 2\\int_0^\\pi g(\\theta)\\,\\mathrm{d}\\theta$。\n$$a_n = \\frac{2}{\\pi} \\int_0^{\\pi} e^{\\beta \\cos\\theta} \\cos(n\\theta) \\,\\mathrm{d}\\theta$$\n这个积分是第一类修正贝塞尔函数 $I_n(z)$ 的定义表示，其形式为：\n$$I_n(z) = \\frac{1}{\\pi} \\int_0^{\\pi} e^{z \\cos\\theta} \\cos(n\\theta) \\,\\mathrm{d}\\theta$$\n通过直接比较，我们确定了 $n \\ge 0$ 时系数 $a_n$ 的解析形式。\n$$a_n^{\\text{ana}} = 2 I_n(\\beta)$$\n这个单一公式同样适用于 $n=0$，因为 $\\cos(0)=1$。因此，所需的解析系数为 $a_n^{\\text{ana}} = 2I_n(\\beta)$ 和 $b_n^{\\text{ana}} = 0$。\n\n### 2. 数值傅里叶系数\n\n必须在周期 $[0,1]$ 上使用包含 $M$ 个样本的均匀网格，通过复合梯形法则来数值计算这些系数。对于一个在整个周期上积分的周期函数，使用 $M$ 个等距点 $t_k = k/M$（其中 $k=0, 1, \\dots, M-1$，步长为 $\\Delta t = 1/M$）的梯形法则提供了一个特别精确和简单的近似：\n$$\\int_0^1 f(t)\\,\\mathrm{d}t \\approx \\frac{1}{M} \\sum_{k=0}^{M-1} f(t_k)$$\n将此规则应用于系数积分：\n$$a_n^{\\text{num}} = 2 \\left( \\frac{1}{M} \\sum_{k=0}^{M-1} p(t_k) \\cos(2\\pi n t_k) \\right) = \\frac{2}{M} \\sum_{k=0}^{M-1} p_k \\cos\\left(\\frac{2\\pi nk}{M}\\right)$$\n$$b_n^{\\text{num}} = 2 \\left( \\frac{1}{M} \\sum_{k=0}^{M-1} p(t_k) \\sin(2\\pi n t_k) \\right) = \\frac{2}{M} \\sum_{k=0}^{M-1} p_k \\sin\\left(\\frac{2\\pi nk}{M}\\right)$$\n其中 $p_k = p(t_k)$。这些和可以使用离散傅里叶变换（DFT）高效计算。信号样本 $p_k$ 的DFT定义为：\n$$P_n = \\text{DFT}(p)_n = \\sum_{k=0}^{M-1} p_k e^{-i 2\\pi nk/M} = \\sum_{k=0}^{M-1} p_k \\left( \\cos\\left(\\frac{2\\pi nk}{M}\\right) - i \\sin\\left(\\frac{2\\pi nk}{M}\\right) \\right)$$\n通过将 $P_n$ 的实部和虚部与 $a_n^{\\text{num}}$ 和 $b_n^{\\text{num}}$ 的求和式进行比较，我们建立以下关系：\n$$a_n^{\\text{num}} = \\frac{2}{M} \\text{Re}(P_n) \\quad \\text{for } n \\ge 1$$\n$$b_n^{\\text{num}} = -\\frac{2}{M} \\text{Im}(P_n) \\quad \\text{for } n \\ge 1$$\n对于直流分量 $n=0$，级数项为 $a_0/2 = \\int_0^1 p(t)\\,\\mathrm{d}t$。其数值近似为 $\\frac{a_0^{\\text{num}}}{2} = \\frac{1}{M} \\sum p_k = \\frac{1}{M}P_0$，因此：\n$$a_0^{\\text{num}} = \\frac{2}{M} P_0$$\n由于 $p_k$ 是实数序列，$P_0$ 是实数。这些公式提供了从信号样本的FFT到数值傅里叶系数的直接路径。\n\n### 3. 误差度量计算\n\n最后一步是计算数值系数和解析系数之间的最大绝对差异 $E_{\\max}$。\n$$E_{\\max} = \\max\\left(\\max_{0\\le n\\le N}\\left|a_n^{\\text{num}} - a_n^{\\text{ana}}\\right|,\\;\\max_{1\\le n\\le N}\\left|b_n^{\\text{num}} - b_n^{\\text{ana}}\\right|\\right)$$\n实现中将使用标准库函数计算修正贝塞尔函数来得到 $a_n^{\\text{ana}} = 2I_n(\\beta)$，并设定 $b_n^{\\text{ana}} = 0$。它将使用上述基于FFT的方法计算 $a_n^{\\text{num}}$ 和 $b_n^{\\text{num}}$。计算截至指数 $N$ 的每个所需谐波的绝对差，并报告这些值的最大值作为每个测试用例的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import iv\n\ndef solve():\n    \"\"\"\n    Computes Fourier coefficients for p(t) = exp(beta*cos(2*pi*t)) numerically\n    and analytically, then finds the maximum discrepancy.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (beta, M, N)\n        (0.5, 4096, 20),\n        (0.0, 128, 10),\n        (3.0, 256, 50),\n    ]\n\n    results = []\n    for beta, M, N in test_cases:\n        # 1. Numerical Calculation\n        # Create a uniform time grid of M samples over the interval [0, 1).\n        # The period T=1, so the grid points are t_k = k/M.\n        t = np.arange(M) / M\n        \n        # Sample the pressure waveform p(t) at the grid points.\n        p_samples = np.exp(beta * np.cos(2 * np.pi * t))\n        \n        # Compute the DFT of the signal samples, which is used to find the\n        # numerical Fourier coefficients efficiently.\n        P_dft = np.fft.fft(p_samples)\n        \n        # Initialize arrays for numerical coefficients up to harmonic N.\n        a_num = np.zeros(N + 1)\n        b_num = np.zeros(N + 1)  # Index 0 is unused for b_n but maintains alignment.\n        \n        # Calculate the n=0 coefficient (DC component).\n        # The formula for a_0 differs in the standard Fourier series definition.\n        # a_0 = 2 * integral(p(t) dt) from 0 to 1\n        # which is numerically 2 * (1/M) * sum(p_k) = (2/M) * P_dft[0].\n        a_num[0] = (2.0 / M) * P_dft[0].real\n        \n        # Calculate coefficients for n = 1, ..., N.\n        if N > 0:\n            n_indices = np.arange(1, N + 1)\n            \n            # Extract the relevant complex DFT components.\n            P_positive_freqs = P_dft[n_indices]\n            \n            # a_n = (2/M) * Re(P_n)\n            a_num[1:] = (2.0 / M) * P_positive_freqs.real\n            \n            # b_n = -(2/M) * Im(P_n)\n            b_num[1:] = (-2.0 / M) * P_positive_freqs.imag\n\n        # 2. Analytical Calculation\n        # The analytic coefficients are derived from the integral definitions.\n        # a_n = 2 * I_n(beta), where I_n is the modified Bessel function of the first kind.\n        # b_n = 0, because the function p(t) is even.\n        n_all_indices = np.arange(N + 1)\n        a_ana = 2.0 * iv(n_all_indices, beta)\n        b_ana = np.zeros(N + 1)\n        \n        # 3. Error Metric Calculation\n        # Compute the maximum absolute discrepancy as defined in the problem.\n        \n        # Discrepancy for a_n coefficients for n in [0, N].\n        err_a = np.abs(a_num - a_ana)\n        max_err_a = np.max(err_a)\n        \n        # Discrepancy for b_n coefficients for n in [1, N].\n        # If N=0, there are no b_n coefficients to check.\n        if N > 0:\n            err_b = np.abs(b_num[1:] - b_ana[1:])\n            max_err_b = np.max(err_b)\n        else:\n            max_err_b = 0.0 # No error if there are no coefficients to compare.\n        \n        E_max = max(max_err_a, max_err_b)\n        results.append(E_max)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将连续的声学信号转换为数字信号是计算声学和实验测量的基础，但这一采样过程可能会引入被称为“混叠”的严重失真。本练习将从第一性原理出发，推导信号采样过程的频谱变化，揭示当采样率不足时，高频成分如何“伪装”成低频成分。通过对这一现象的深入分析 ，您将深刻理解奈奎斯特-香农采样定理的实际意义，这对于设计可靠的数据采集系统和避免错误的频谱分析至关重要。",
            "id": "4124902",
            "problem": "一个由窄带源产生的声压信号被建模为一个连续时间正弦信号 $p(t)=A\\cos(\\omega_{0}t)$，其中 $A0$ 和 $\\omega_{0}0$ 是常数。一个数据采集系统以采样周期 $T_{s}$ 对该信号进行均匀采样，其中 $T_{s}=\\frac{1}{f_{s}}$，采样角频率为 $\\omega_{s}=2\\pi f_{s}$。采样后的连续时间信号为 $p_{s}(t)=p(t)\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s})$。假设采用理想点采样和一个理想重构低通滤波器，该滤波器能完美通过基带 $[0,\\omega_{s}/2]$ 并滤除所有其他频率分量。\n\n仅使用连续傅里叶变换的基本定义和周期性冲激串的傅里叶级数，从第一性原理出发推导 $p_{s}(t)$ 的频谱。然后，根据推导出的频谱，确定经过理想重构后会出现在基带 $[0,\\omega_{s}/2]$ 中的混叠角频率。考虑一个科学上符合实际的情况，即一个超声波音调的角频率为 $\\omega_{0}=2\\pi\\times 6000\\ \\mathrm{rad/s}$，采样角频率为 $\\omega_{s}=2\\pi\\times 8000\\ \\mathrm{rad/s}$。报告以弧度/秒为单位的混叠角频率。以单个实数或单个闭式解析表达式的形式给出最终答案。无需四舍五入。角度单位为弧度，频率单位为弧度/秒。",
            "solution": "目标是确定采样后连续时间信号的频谱，并找出经过理想重构后出现在基带中的频率。推导必须从连续傅里叶变换的定义以及已知的周期性冲激串的傅里叶级数和变换性质开始。\n\n1. 定义与设置：\n- 信号 $x(t)$ 的连续傅里叶变换（也称为连续时间傅里叶变换）定义为\n$$\nX(\\omega)=\\int_{-\\infty}^{\\infty}x(t)\\exp(-i\\omega t)\\,\\mathrm{d}t,\n$$\n其逆变换为\n$$\nx(t)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}X(\\omega)\\exp(i\\omega t)\\,\\mathrm{d}\\omega.\n$$\n- 信号为 $p(t)=A\\cos(\\omega_{0}t)$，其中 $A0$ 且 $\\omega_{0}0$。\n- 采样操作被建模为与一个狄拉克冲激串（也称为狄拉克梳状函数）$\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s})$ 的乘积。\n\n2. 音调的连续傅里叶变换：\n使用恒等式 $\\cos(\\omega_{0}t)=\\frac{1}{2}\\big(\\exp(i\\omega_{0}t)+\\exp(-i\\omega_{0}t)\\big)$ 以及复指数的变换，\n$$\n\\int_{-\\infty}^{\\infty}\\exp(i\\omega_{0}t)\\exp(-i\\omega t)\\,\\mathrm{d}t=2\\pi\\,\\delta(\\omega-\\omega_{0}),\\quad\n\\int_{-\\infty}^{\\infty}\\exp(-i\\omega_{0}t)\\exp(-i\\omega t)\\,\\mathrm{d}t=2\\pi\\,\\delta(\\omega+\\omega_{0}),\n$$\n我们得到 $p(t)$ 的连续傅里叶变换：\n$$\nP(\\omega)=\\int_{-\\infty}^{\\infty}A\\cos(\\omega_{0}t)\\exp(-i\\omega t)\\,\\mathrm{d}t\n=\\frac{A}{2}\\cdot 2\\pi\\,\\delta(\\omega-\\omega_{0})+\\frac{A}{2}\\cdot 2\\pi\\,\\delta(\\omega+\\omega_{0})\n=\\pi A\\big[\\delta(\\omega-\\omega_{0})+\\delta(\\omega+\\omega_{0})\\big].\n$$\n\n3. 狄拉克冲激串的频谱与采样：\n时域中的冲激串是\n$$\ns(t)=\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s}).\n$$\n它是一个周期为 $T_s$ 的周期信号。其连续傅里叶变换是一个在角频率域上经过缩放的冲激串，由一个经过充分验证的结果给出（可从周期性冲激串的傅里叶级数或 Poisson 求和公式 (PSF) 推导得出）：\n$$\nS(\\omega)=\\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-k\\omega_{s}),\\quad \\omega_{s}=\\frac{2\\pi}{T_{s}}.\n$$\n采样后的连续时间信号是 $p_{s}(t)=p(t)\\,s(t)$，是一个时域乘积。时域乘积的傅里叶变换是角频率域中变换的卷积，并乘以一个比例因子 $\\frac{1}{2\\pi}$：\n$$\nP_{s}(\\omega)=\\frac{1}{2\\pi}\\big(P*S\\big)(\\omega)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}P(\\lambda)\\,S(\\omega-\\lambda)\\,\\mathrm{d}\\lambda.\n$$\n将 $P(\\lambda)=\\pi A[\\delta(\\lambda-\\omega_{0})+\\delta(\\lambda+\\omega_{0})]$ 和 $S(\\omega-\\lambda)=\\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-\\lambda-k\\omega_{s})$ 代入，得到\n$$\nP_{s}(\\omega)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}\\pi A\\big[\\delta(\\lambda-\\omega_{0})+\\delta(\\lambda+\\omega_{0})\\big]\\cdot \\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-\\lambda-k\\omega_{s})\\,\\mathrm{d}\\lambda.\n$$\n使用狄拉克 delta 分布的筛选性质计算该积分，\n$$\nP_{s}(\\omega)=\\frac{\\pi A}{2\\pi}\\cdot \\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\Big[\\delta\\big(\\omega-\\omega_{0}-k\\omega_{s}\\big)+\\delta\\big(\\omega+\\omega_{0}-k\\omega_{s}\\big)\\Big]\n=\\frac{\\pi A}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\Big[\\delta\\big(\\omega-(\\omega_{0}+k\\omega_{s})\\big)+\\delta\\big(\\omega-(-\\omega_{0}+k\\omega_{s})\\big)\\Big].\n$$\n因此，采样在平移后的角频率 $\\omega=\\omega_{0}+k\\omega_{s}$ 和 $\\omega=-\\omega_{0}+k\\omega_{s}$（$k\\in\\mathbb{Z}$）处复制了原始的线状谱，其幅度按 $\\frac{\\pi A}{T_{s}}$ 缩放。这是混叠现象背后的经典频谱复制机制。\n\n4. 确定混叠的基带谱线：\n一个通过 $[0,\\omega_{s}/2]$ 的理想重构低通滤波器将会选择集合 $\\{\\omega_{0}+k\\omega_{s},\\,-\\omega_{0}+k\\omega_{s}\\}$ 中落入该通带的任何一条谱线。对于给定的数值，\n$$\n\\omega_{0}=2\\pi\\times 6000=12000\\pi,\\quad \\omega_{s}=2\\pi\\times 8000=16000\\pi,\n$$\n且基带为 $[0,\\omega_{s}/2]=[0,8000\\pi]$。\n\n我们考察这两个谱线序列：\n- $\\omega=\\omega_{0}+k\\omega_{s}=12000\\pi+16000\\pi\\,k$。\n- $\\omega=-\\omega_{0}+k\\omega_{s}=-12000\\pi+16000\\pi\\,k$。\n\n对于 $k=0$，$\\omega=12000\\pi$ 在基带之外。对于 $k=1$，第二个序列给出\n$$\n\\omega=-12000\\pi+16000\\pi=4000\\pi,\n$$\n它位于 $[0,8000\\pi]$ 内。对于其他整数 $k$，最近的基带谱线会更远；例如，$k=-1$ 产生 $\\omega=-28000\\pi$ 或 $\\omega=-4000\\pi$（负值），而 $k=2$ 产生 $\\omega=8000\\pi$ 或 $\\omega=20000\\pi$，其中 $\\omega=8000\\pi$ 在截止频率处，但主要的混叠音调是带内的 $4000\\pi$。标准的混叠映射可以被识别为\n$$\n\\omega_{\\mathrm{alias}}=\\big|\\omega_{0}-\\omega_{s}\\big|=|12000\\pi-16000\\pi|=4000\\pi,\n$$\n它在 $[0,\\omega_{s}/2]$ 范围内。\n\n5. 结论：\n采样信号的连续时间频谱由位于 $\\omega=\\omega_{0}+k\\omega_{s}$ 和 $\\omega=-\\omega_{0}+k\\omega_{s}$（$k\\in\\mathbb{Z}$）处的线状谱组成，其幅度按 $\\frac{\\pi A}{T_{s}}$ 缩放。在理想基带重构下，观测到的混叠角频率为\n$$\n\\omega_{\\mathrm{alias}}=4000\\pi\\ \\text{rad/s}.\n$$\n无需四舍五入，角度单位为弧度。",
            "answer": "$$\\boxed{4000\\pi}$$"
        }
    ]
}