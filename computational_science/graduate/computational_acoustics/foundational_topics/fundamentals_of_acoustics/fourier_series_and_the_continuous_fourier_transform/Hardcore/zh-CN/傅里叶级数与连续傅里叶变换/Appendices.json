{
    "hands_on_practices": [
        {
            "introduction": "本练习提供了一个计算傅里叶级数系数的基础实践。通过从第一性原理出发，您将证明函数的对称性如何能够极大地简化分析过程，这在理论研究和实际信号处理中都是一项宝贵的技巧。该练习强化了傅里叶系数作为投影的几何解释，并巩固了您处理声学中常见的周期性信号的能力 。",
            "id": "4124884",
            "problem": "考虑一个刚性壁管道的一维计算声学模型，其入口由一个在无量纲时间变量 $t$ 中周期为 $2\\pi$ 的无量纲质点速度波形驱动。在一个基本区间 $(-\\pi,\\pi)$ 上，该波形被指定为 $g(t)=t$，并通过奇周期性扩展到所有 $t\\in\\mathbb{R}$，即 $g(t+2\\pi)=g(t)$ 且 $g(-t)=-g(t)$。为了分析此入口驱动的谐波含量，该波形在 $(-\\pi,\\pi)$ 上被展开为三角傅里叶级数。\n\n从 $L^{2}(-\\pi,\\pi)$ 上的内积结构和三角基函数的奇偶性出发，根据第一性原理推导对于 $(-\\pi,\\pi)$ 上的任何奇函数，其傅里叶余弦系数 $a_{n}$ 均为零。然后，计算给定函数 $g(t)=t$ 的正弦系数 $b_{n}$，并给出其在 $(-\\pi,\\pi)$ 上的相应纯正弦傅里叶级数表示。\n\n你的最终答案必须是表示 $g(t)$ 的纯正弦级数的单个闭式解析表达式，以 $t$ 为函数。最终答案中不要包含等号或任何单位。不需要进行数值取整。",
            "solution": "用户提供的问题已经过验证，被认为是有效的。它在科学上基于傅里叶分析的原理，问题设定清晰完整，适定性良好，且陈述客观。该问题是将傅里叶级数理论应用于奇函数的一个标准练习，这是信号处理和包括声学在内的波动物理学中的一个常见任务。\n\n按要求，解答分为两部分。首先，我们从第一性原理推导，在对称区间 $(-\\pi, \\pi)$ 上任何奇函数的傅里叶级数中的余弦系数均为零。其次，我们计算特定奇函数 $g(t)=t$ 的正弦系数，并构建其傅里叶级数。\n\n第1部分：奇函数的余弦系数为零\n\n如果对于定义域中的所有 $t$，都有 $f(-t) = -f(t)$，则函数 $f(t)$ 被定义为奇函数。函数 $f(t)$ 在区间 $(-\\pi, \\pi)$ 上的三角傅里叶级数由下式给出\n$$\nf(t) \\sim \\frac{a_{0}}{2} + \\sum_{n=1}^{\\infty} \\left( a_{n} \\cos(nt) + b_{n} \\sin(nt) \\right)\n$$\n系数 $a_n$ 和 $b_n$ 是 $f(t)$ 在 $L^{2}(-\\pi,\\pi)$ 空间中到正交基函数族 $\\{1, \\cos(nt), \\sin(nt)\\}_{n=1}^{\\infty}$ 上的投影。该空间中的内积定义为 $\\langle f, h \\rangle = \\int_{-\\pi}^{\\pi} f(t) h(t) \\, dt$。\n\n系数计算如下：\n$$\na_{n} = \\frac{\\langle f(t), \\cos(nt) \\rangle}{\\langle \\cos(nt), \\cos(nt) \\rangle} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\cos(nt) \\, dt, \\quad \\text{对于 } n \\ge 1\n$$\n$$\na_{0} = \\frac{\\langle f(t), 1 \\rangle}{\\langle 1, 1 \\rangle} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} f(t) \\cdot 1 \\, dt\n$$\n等等，$a_0$ 的归一化通常采用与 $n=0$ 时的一般 $a_n$ 形式相匹配的方式：$\\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\cos(0 \\cdot t) \\, dt = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\, dt$。我们遵循这个标准定义。\n\n为证明对于奇函数 $f(t)$，系数 $a_n$ 为零，我们分析被积函数 $f(t)\\cos(nt)$。根据假设，$f(t)$ 是一个奇函数。余弦函数是一个偶函数，即 $\\cos(n(-t)) = \\cos(nt)$。一个奇函数与一个偶函数的乘积是一个奇函数。令 $h(t) = f(t) \\cos(nt)$。那么，\n$$\nh(-t) = f(-t)\\cos(n(-t)) = (-f(t))(\\cos(nt)) = -f(t)\\cos(nt) = -h(t)\n$$\n任何奇函数在对称区间（如 $(-\\pi, \\pi)$）上的定积分为零。证明如下：\n$$\n\\int_{-\\pi}^{\\pi} h(t) \\, dt = \\int_{-\\pi}^{0} h(t) \\, dt + \\int_{0}^{\\pi} h(t) \\, dt\n$$\n在第一个积分中，令 $u = -t$，这意味着 $dt = -du$。积分限从 $t=-\\pi$ 变为 $u=\\pi$，从 $t=0$ 变为 $u=0$。\n$$\n\\int_{-\\pi}^{0} h(t) \\, dt = \\int_{\\pi}^{0} h(-u) (-du) = \\int_{0}^{\\pi} h(-u) \\, du = \\int_{0}^{\\pi} -h(u) \\, du = -\\int_{0}^{\\pi} h(t) \\, dt\n$$\n将此代回，我们得到：\n$$\n\\int_{-\\pi}^{\\pi} h(t) \\, dt = -\\int_{0}^{\\pi} h(t) \\, dt + \\int_{0}^{\\pi} h(t) \\, dt = 0\n$$\n由于被积函数 $f(t)\\cos(nt)$ 是一个奇函数，其在 $(-\\pi, \\pi)$ 上的积分为零。因此，对于 $n \\ge 1$：\n$$\na_{n} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} \\underbrace{f(t) \\cos(nt)}_{\\text{奇函数}} \\, dt = 0\n$$\n对于系数 $a_0$，被积函数是 $f(t)$ 本身，它也是奇函数。因此，\n$$\na_{0} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\, dt = 0\n$$\n这从第一性原理证明了，对于 $(-\\pi, \\pi)$ 上的任何奇函数，所有余弦系数 $a_n$（对于 $n \\ge 0$）都为零。\n\n第2部分：$g(t)=t$ 的正弦系数和傅里叶级数\n\n给定函数是在 $(-\\pi, \\pi)$ 上的 $g(t)=t$。这是一个奇函数，因为 $g(-t) = -t = -g(t)$。根据第1部分的结果，其所有余弦系数 $a_n$ 都为零，其傅里叶级数是一个纯正弦级数。\n\n正弦系数 $b_n$ 由下式给出：\n$$\nb_{n} = \\frac{\\langle g(t), \\sin(nt) \\rangle}{\\langle \\sin(nt), \\sin(nt) \\rangle} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} g(t) \\sin(nt) \\, dt\n$$\n代入 $g(t)=t$：\n$$\nb_{n} = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} t \\sin(nt) \\, dt\n$$\n被积函数 $t \\sin(nt)$ 是两个奇函数（$t$ 和 $\\sin(nt)$）的乘积，结果是一个偶函数。对于偶函数，其在对称区间上的积分等于其在正半区间上积分的两倍：\n$$\nb_{n} = \\frac{2}{\\pi} \\int_{0}^{\\pi} t \\sin(nt) \\, dt\n$$\n我们使用分部积分法 $\\int u \\, dv = uv - \\int v \\, du$ 来计算这个积分。令 $u=t$ 和 $dv = \\sin(nt) \\, dt$。这得到 $du=dt$ 和 $v = \\int \\sin(nt) \\, dt = -\\frac{1}{n}\\cos(nt)$。\n$$\n\\int_{0}^{\\pi} t \\sin(nt) \\, dt = \\left[ t \\left( -\\frac{1}{n}\\cos(nt) \\right) \\right]_{0}^{\\pi} - \\int_{0}^{\\pi} \\left( -\\frac{1}{n}\\cos(nt) \\right) \\, dt\n$$\n$$\n= \\left[ -\\frac{t}{n}\\cos(nt) \\right]_{0}^{\\pi} + \\frac{1}{n} \\int_{0}^{\\pi} \\cos(nt) \\, dt\n$$\n计算第一项：\n$$\n\\left[ -\\frac{t}{n}\\cos(nt) \\right]_{0}^{\\pi} = \\left(-\\frac{\\pi}{n}\\cos(n\\pi)\\right) - \\left(-\\frac{0}{n}\\cos(0)\\right) = -\\frac{\\pi}{n}(-1)^{n}\n$$\n因为对于整数 $n$，有 $\\cos(n\\pi) = (-1)^n$。\n计算第二项（积分）：\n$$\n\\frac{1}{n} \\int_{0}^{\\pi} \\cos(nt) \\, dt = \\frac{1}{n} \\left[ \\frac{1}{n}\\sin(nt) \\right]_{0}^{\\pi} = \\frac{1}{n^2} (\\sin(n\\pi) - \\sin(0)) = \\frac{1}{n^2}(0-0) = 0\n$$\n结合这些结果，积分为 $-\\frac{\\pi}{n}(-1)^{n}$。现在，我们求系数 $b_n$：\n$$\nb_{n} = \\frac{2}{\\pi} \\left( -\\frac{\\pi}{n}(-1)^{n} \\right) = -\\frac{2}{n}(-1)^{n} = \\frac{2}{n}(-1)(-1)^{n} = \\frac{2(-1)^{n+1}}{n}\n$$\n此式对 $n \\ge 1$ 成立。因此，$g(t)=t$ 在 $(-\\pi, \\pi)$ 上的傅里叶级数为：\n$$\ng(t) \\sim \\sum_{n=1}^{\\infty} b_{n} \\sin(nt) = \\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n} \\sin(nt)\n$$\n此表达式即为所求的纯正弦傅里叶级数表示。",
            "answer": "$$\\boxed{\\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n} \\sin(nt)}$$"
        },
        {
            "introduction": "本练习从连续理论转向数字实践，旨在解决混叠这一关键概念。您将从头推导采样信号的频谱，揭示时域中的采样如何在频域中创建周期性的副本。这个动手推导过程将帮助您深刻、直观地理解奈奎斯特-香农采样定理，以及为什么高于奈奎斯特极限的频率会“伪装”成较低的频率——这是任何数字数据采集系统中都必须考虑的关键问题 。",
            "id": "4124902",
            "problem": "一个由窄带源产生的声压信号被建模为连续时间正弦信号 $p(t)=A\\cos(\\omega_{0}t)$，其中 $A0$ 和 $\\omega_{0}0$ 是常数。一个数据采集系统以采样周期 $T_{s}$ 对该信号进行均匀采样，其中 $T_{s}=\\frac{1}{f_{s}}$，采样角频率为 $\\omega_{s}=2\\pi f_{s}$。采样后的连续时间信号为 $p_{s}(t)=p(t)\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s})$。假设采用理想点采样和一个理想重构低通滤波器，该滤波器能完全通过基带 $[0,\\omega_{s}/2]$ 并滤除所有其他频率成分。\n\n仅使用连续傅里叶变换的基本定义和周期性冲激串的傅里叶级数，从第一性原理推导出 $p_{s}(t)$ 的频谱。然后，根据推导出的频谱，确定经过理想重构后会出现在基带 $[0,\\omega_{s}/2]$ 中的混叠角频率。考虑一个科学上符合实际的情况：一个超声波音调的角频率为 $\\omega_{0}=2\\pi\\times 6000\\ \\text{rad/s}$，采样角频率为 $\\omega_{s}=2\\pi\\times 8000\\ \\text{rad/s}$。以弧度/秒为单位报告混叠角频率。最终答案应为一个实数或一个封闭形式的解析表达式。无需四舍五入。角度以弧度表示，频率以弧度/秒表示。",
            "solution": "目标是确定采样后的连续时间信号的频谱，并识别出经过理想重构后出现在基带中的频率。推导必须从连续傅里叶变换的定义以及周期性冲激串的已知傅里叶级数和变换性质开始。\n\n1. 定义与设置：\n- 信号 $x(t)$ 的连续傅里叶变换（也称为连续时间傅里叶变换）定义为\n$$\nX(\\omega)=\\int_{-\\infty}^{\\infty}x(t)e^{-i\\omega t}\\,\\mathrm{d}t,\n$$\n其逆变换为\n$$\nx(t)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}X(\\omega)e^{i\\omega t}\\,\\mathrm{d}\\omega.\n$$\n- 信号为 $p(t)=A\\cos(\\omega_{0}t)$，其中 $A0$ 且 $\\omega_{0}0$。\n- 采样操作通过与 Dirac 冲激串（也称为 Dirac 梳状函数） $\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s})$ 相乘来建模。\n\n2. 音调的连续傅里叶变换：\n使用恒等式 $\\cos(\\omega_{0}t)=\\frac{1}{2}\\big(e^{i\\omega_{0}t}+e^{-i\\omega_{0}t}\\big)$ 以及复指数的变换，\n$$\n\\int_{-\\infty}^{\\infty}e^{i\\omega_{0}t}e^{-i\\omega t}\\,\\mathrm{d}t=2\\pi\\,\\delta(\\omega-\\omega_{0}),\\quad\n\\int_{-\\infty}^{\\infty}e^{-i\\omega_{0}t}e^{-i\\omega t}\\,\\mathrm{d}t=2\\pi\\,\\delta(\\omega+\\omega_{0}),\n$$\n我们得到 $p(t)$ 的连续傅里叶变换：\n$$\nP(\\omega)=\\int_{-\\infty}^{\\infty}A\\cos(\\omega_{0}t)e^{-i\\omega t}\\,\\mathrm{d}t\n=\\frac{A}{2}\\cdot 2\\pi\\,\\delta(\\omega-\\omega_{0})+\\frac{A}{2}\\cdot 2\\pi\\,\\delta(\\omega+\\omega_{0})\n=\\pi A\\big[\\delta(\\omega-\\omega_{0})+\\delta(\\omega+\\omega_{0})\\big].\n$$\n\n3. Dirac 冲激串的频谱与采样：\n时域中的冲激串是\n$$\ns(t)=\\sum_{n\\in\\mathbb{Z}}\\delta(t-nT_{s}).\n$$\n它是一个周期为 $T_{s}$ 的周期信号。它的连续傅里叶变换是角频率域中的一个缩放后的冲激串，由一个经过充分验证的结果给出（可从周期性冲激串的傅里叶级数或 Poisson 求和公式（PSF）推导）：\n$$\nS(\\omega)=\\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-k\\omega_{s}),\\quad \\omega_{s}=\\frac{2\\pi}{T_{s}}.\n$$\n采样后的连续时间信号为 $p_{s}(t)=p(t)\\,s(t)$，是一个时域乘积。时域乘积的傅里叶变换是角频率域中变换的卷积，并按 $\\frac{1}{2\\pi}$ 缩放：\n$$\nP_{s}(\\omega)=\\frac{1}{2\\pi}\\big(P*S\\big)(\\omega)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}P(\\lambda)\\,S(\\omega-\\lambda)\\,\\mathrm{d}\\lambda.\n$$\n代入 $P(\\lambda)=\\pi A[\\delta(\\lambda-\\omega_{0})+\\delta(\\lambda+\\omega_{0})]$ 和 $S(\\omega-\\lambda)=\\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-\\lambda-k\\omega_{s})$ 可得\n$$\nP_{s}(\\omega)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}\\pi A\\big[\\delta(\\lambda-\\omega_{0})+\\delta(\\lambda+\\omega_{0})\\big]\\cdot \\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\delta(\\omega-\\lambda-k\\omega_{s})\\,\\mathrm{d}\\lambda.\n$$\n利用 Dirac delta 分布的筛选特性计算该积分，\n$$\nP_{s}(\\omega)=\\frac{\\pi A}{2\\pi}\\cdot \\frac{2\\pi}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\Big[\\delta\\big(\\omega-\\omega_{0}-k\\omega_{s}\\big)+\\delta\\big(\\omega+\\omega_{0}-k\\omega_{s}\\big)\\Big]\n=\\frac{\\pi A}{T_{s}}\\sum_{k\\in\\mathbb{Z}}\\Big[\\delta\\big(\\omega-(\\omega_{0}+k\\omega_{s})\\big)+\\delta\\big(\\omega-(-\\omega_{0}+k\\omega_{s})\\big)\\Big].\n$$\n因此，采样将原始线状频谱复制到移位的角频率上\n$$\n\\omega=\\omega_{0}+k\\omega_{s}\\quad\\text{和}\\quad \\omega=-\\omega_{0}+k\\omega_{s},\\quad k\\in\\mathbb{Z},\n$$\n振幅按 $\\frac{\\pi A}{T_{s}}$ 缩放。这就是混叠现象背后的经典频谱复制机制。\n\n4. 识别混叠的基带谱线：\n一个能通过 $[0,\\omega_{s}/2]$ 的理想重构低通滤波器将会选择集合 $\\{\\omega_{0}+k\\omega_{s},\\,-\\omega_{0}+k\\omega_{s}\\}$ 中落入通带的任何一条谱线。对于给定的数值，\n$$\n\\omega_{0}=2\\pi\\times 6000=12000\\pi,\\quad \\omega_{s}=2\\pi\\times 8000=16000\\pi,\n$$\n基带为 $[0,\\omega_{s}/2]=[0,8000\\pi]$。\n\n我们考察这两个谱线序列：\n- $\\omega=\\omega_{0}+k\\omega_{s}=12000\\pi+16000\\pi\\,k$.\n- $\\omega=-\\omega_{0}+k\\omega_{s}=-12000\\pi+16000\\pi\\,k$.\n\n对于 $k=0$，$\\omega=12000\\pi$ 在基带之外。对于 $k=1$，第二个序列给出\n$$\n\\omega=-12000\\pi+16000\\pi=4000\\pi,\n$$\n它位于 $[0,8000\\pi]$ 内。对于其他整数 $k$，最接近的基带谱线会更远；例如，$k=-1$ 得到 $\\omega=-28000\\pi$ 或 $\\omega=-4000\\pi$（负值），而 $k=2$ 得到 $\\omega=8000\\pi$ 或 $\\omega=20000\\pi$，其中 $\\omega=8000\\pi$ 在截止频率上，但主要的混叠音调是带内的 $4000\\pi$。标准的混叠映射可以看作是\n$$\n\\omega_{\\mathrm{alias}}=\\big|\\omega_{0}-\\omega_{s}\\big|=|12000\\pi-16000\\pi|=4000\\pi,\n$$\n其值在 $[0,\\omega_{s}/2]$ 范围内。\n\n5. 结论：\n采样信号的连续时间频谱由位于 $\\omega=\\omega_{0}+k\\omega_{s}$ 和 $\\omega=-\\omega_{0}+k\\omega_{s}$（$k\\in\\mathbb{Z}$）的线状频谱组成，其振幅按 $\\frac{\\pi A}{T_{s}}$ 缩放。在理想基带重构下，观测到的混叠角频率是\n$$\n\\omega_{\\mathrm{alias}}=4000\\pi\\ \\text{rad/s}.\n$$\n无需四舍五入，且角度单位为弧度。",
            "answer": "$$\\boxed{4000\\pi}$$"
        },
        {
            "introduction": "在实际测量中，我们只能在有限的时间内观察信号，这个过程称为加窗。本练习探讨了加窗不可避免的后果：频谱泄漏，即单个频率的能量“泄漏”到相邻的频率仓中。通过分析和比较简单的矩形窗与更复杂的汉宁窗的性能，您将对频谱分析中频率分辨率（主瓣宽度）和动态范围（旁瓣抑制）之间的基本权衡获得宝贵的实践见解 。",
            "id": "4124996",
            "problem": "考虑一个有限时长的声调，其模型为一个复正弦信号与一个确定性窗函数的乘积。设 $w(t)$ 是一个时长为 $T$ 秒的实偶窗函数，其支撑区间为 $[-T/2,T/2]$，声调为 $x(t)=e^{i\\omega_0 t}w(t)$，其中 $\\omega_0$ 是角频率，单位为弧度/秒。连续时间傅里叶变换定义为 $X(\\omega)=\\int_{-\\infty}^{\\infty}x(t)e^{-i\\omega t}\\,dt$，其中角频率 $\\omega$ 的单位为弧度/秒。根据频移特性，$X(\\omega)=W(\\omega-\\omega_0)$，其中 $W(\\omega)=\\int_{-\\infty}^{\\infty}w(t)e^{-i\\omega t}\\,dt$ 是窗函数的连续时间傅里叶变换。\n\n定义在频率偏移 $\\Delta\\omega=\\omega-\\omega_0$ 处的归一化泄漏模式为 $L_w(\\Delta\\omega)=\\dfrac{|W(\\Delta\\omega)|}{|W(0)|}$，因此 $L_w(0)=1$。主瓣是围绕 $\\Delta\\omega=0$ 的中心峰，旁瓣是 $L_w(\\Delta\\omega)$ 的连续零点之间的振荡峰。\n\n您将分析两种窗函数：\n- 矩形窗，$w_{\\mathrm{rect}}(t)=1$ 当 $t\\in[-T/2,T/2]$ 时成立，其他情况下 $w_{\\mathrm{rect}}(t)=0$。\n- 汉宁窗（升余弦窗），$w_{\\mathrm{hann}}(t)=\\dfrac{1}{2}\\left(1+\\cos\\left(\\dfrac{2\\pi t}{T}\\right)\\right)$ 当 $t\\in[-T/2,T/2]$ 时成立，其他情况下 $w_{\\mathrm{hann}}(t)=0$。\n\n从连续时间傅里叶变换的定义和基本性质（线性和频移）出发，推导适用于数值计算 $L_{w_{\\mathrm{rect}}}(\\Delta\\omega)$ 和 $L_{w_{\\mathrm{hann}}}(\\Delta\\omega)$ 的表达式。使用这些表达式，为每种窗函数计算并报告以下内容：\n1. 主瓣宽度，单位为弧度/秒，定义为 $L_w(\\Delta\\omega)$ 在 $\\Delta\\omega=0$ 两侧最近的两个零点之间的距离。\n2. 第一旁瓣电平，定义为在正侧第一个零点之后的第一个旁瓣区间内 $L_w(\\Delta\\omega)$ 的最大值，通过 $20\\log_{10}(\\cdot)$ 表示为分贝。\n\n角度单位必须是弧度，角频率单位必须是弧度/秒。所有计算都应以角频率进行。程序必须实现对两种窗函数的第一旁瓣电平的稳健数值评估，不依赖任何离散时间快速傅里叶变换的捷径。对于矩形窗，使用基本原理精确定位第一旁瓣的最大值（例如，通过求解导数条件）。对于汉宁窗，在第一个旁瓣区间内的足够精细的网格上评估 $L_{w_{\\mathrm{hann}}}(\\Delta\\omega)$ 以定位其最大值。\n\n测试套件：\n对于下面的每个参数对 $(T,\\omega_0)$，计算并返回一个包含四个浮点值的列表，顺序为 $[\\text{mainlobe\\_width\\_rect},\\text{first\\_sidelobe\\_dB\\_rect},\\text{mainlobe\\_width\\_hann},\\text{first\\_sidelobe\\_dB\\_hann}]$。\n使用以下案例：\n- 案例 A (通用): $T=0.02$, $\\omega_0=2\\pi\\cdot 1000$。\n- 案例 B (较长时长): $T=0.1$, $\\omega_0=2\\pi\\cdot 200$。\n- 案例 C (非常长时长，窄主瓣): $T=1.0$, $\\omega_0=2\\pi\\cdot 10$。\n- 案例 D (非常短时长，宽主瓣): $T=0.001$, $\\omega_0=2\\pi\\cdot 1000$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，并用方括号括起来，不含空格。例如，对于两个案例，它看起来像 \"[[a,b,c,d],[e,f,g,h]]\"。对于测试套件中的四个案例，您的程序必须以 \"[[r11,r12,r13,r14],[r21,r22,r23,r24],[r31,r32,r33,r34],[r41,r42,r43,r44]]\" 的格式打印单行，其中每个 $r_{ij}$ 都是一个浮点数。",
            "solution": "该问题要求在傅里叶分析的背景下，分析两种窗函数——矩形窗和汉宁窗——的频谱特性。我们被要求推导频谱泄漏模式的表达式，并用它们来计算每种窗函数的主瓣宽度和第一旁瓣电平。该问题具有科学依据，提法明确，并且所有定义在信号处理中都是标准的。所提供的参数足以得出一个唯一的解。\n\n首先，我们来确定核心定义。信号 $g(t)$ 的连续时间傅里叶变换 (CTFT) 是 $G(\\omega) = \\int_{-\\infty}^{\\infty} g(t) e^{-i\\omega t} dt$。我们感兴趣的信号是一个复音调 $x(t) = e^{i\\omega_0 t} w(t)$，其中 $w(t)$ 是一个时长为 $T$ 的窗函数，支撑区间为 $[-T/2, T/2]$。根据 CTFT 的频移特性，$x(t)$ 的频谱为 $X(\\omega) = W(\\omega - \\omega_0)$，其中 $W(\\omega)$ 是窗函数 $w(t)$ 的 CTFT。\n\n分析的重点是归一化泄漏模式，定义为 $L_w(\\Delta\\omega) = \\frac{|W(\\Delta\\omega)|}{|W(0)|}$，其中 $\\Delta\\omega = \\omega - \\omega_0$ 是相对于音调中心频率的频率偏移。该函数描述了窗函数频谱的形状，并已归一化，使得在 $\\Delta\\omega = 0$ 处的峰值为 $1$。待计算的量——主瓣宽度和旁瓣电平——是 $L_w(\\Delta\\omega)$ 的属性，因此仅取决于窗函数 $w(t)$ 及其时长 $T$，而与音调的具体频率 $\\omega_0$ 无关。\n\n**1. 矩形窗分析**\n\n矩形窗定义为：\n$$\nw_{\\mathrm{rect}}(t) = \\begin{cases} 1  \\text{for } |t| \\le T/2 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n其 CTFT, $W_{\\mathrm{rect}}(\\omega)$, 计算如下：\n$$\nW_{\\mathrm{rect}}(\\omega) = \\int_{-T/2}^{T/2} 1 \\cdot e^{-i\\omega t} dt = \\left[ \\frac{e^{-i\\omega t}}{-i\\omega} \\right]_{-T/2}^{T/2} = \\frac{e^{-i\\omega T/2} - e^{i\\omega T/2}}{-i\\omega}\n$$\n使用欧拉公式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，我们得到：\n$$\nW_{\\mathrm{rect}}(\\omega) = \\frac{-2i\\sin(\\omega T/2)}{-i\\omega} = \\frac{2\\sin(\\omega T/2)}{\\omega} = T \\frac{\\sin(\\omega T/2)}{\\omega T/2}\n$$\n此表达式与未归一化的 sinc 函数成正比。对于 $\\omega = 0$ 的情况，我们直接计算积分：\n$$\nW_{\\mathrm{rect}}(0) = \\int_{-T/2}^{T/2} 1 \\, dt = T\n$$\n因此，频率偏移 $\\Delta\\omega$ 的归一化泄漏模式为：\n$$\nL_{w_{\\mathrm{rect}}}(\\Delta\\omega) = \\frac{|W_{\\mathrm{rect}}(\\Delta\\omega)|}{|W_{\\mathrm{rect}}(0)|} = \\frac{\\left| T \\frac{\\sin(\\Delta\\omega T/2)}{\\Delta\\omega T/2} \\right|}{|T|} = \\left| \\frac{\\sin(\\Delta\\omega T/2)}{\\Delta\\omega T/2} \\right|\n$$\n主瓣宽度：主瓣是围绕 $\\Delta\\omega=0$ 的中心区域，由第一对零点界定。$L_{w_{\\mathrm{rect}}}(\\Delta\\omega)$ 的零点出现在分子为零而分母不为零时。这发生在 $\\sin(\\Delta\\omega T/2) = 0$ 时，即对于任何非零整数 $k$，有 $\\Delta\\omega T/2 = k\\pi$。包围原点的第一对零点对应于 $k = \\pm 1$。\n$$\n\\Delta\\omega T/2 = \\pm\\pi \\implies \\Delta\\omega = \\pm\\frac{2\\pi}{T}\n$$\n主瓣宽度是这两个零点之间的距离：\n$$\n\\text{Mainlobe Width}_{\\mathrm{rect}} = \\frac{2\\pi}{T} - \\left(-\\frac{2\\pi}{T}\\right) = \\frac{4\\pi}{T}\n$$\n第一旁瓣电平：第一旁瓣出现在第一和第二零点之间，即对于 $\\Delta\\omega T/2 \\in [\\pi, 2\\pi]$。为了找到其最大电平，我们必须找到函数 $f(x) = |\\sin(x)/x|$ 在 $x \\in [\\pi, 2\\pi]$ 上的最大值，其中 $x = \\Delta\\omega T/2$。我们通过将导数设为零来找到极值：\n$$\n\\frac{d}{dx}\\left(\\frac{\\sin x}{x}\\right) = \\frac{x\\cos x - \\sin x}{x^2} = 0 \\implies x\\cos x = \\sin x \\implies \\tan x = x\n$$\n我们需要在区间 $(\\pi, 2\\pi)$ 内找到超越方程 $\\tan x = x$ 的第一个正根。这必须通过数值方法完成。设根为 $x_{\\mathrm{peak}}$。那么第一旁瓣的最大振幅是 $| \\sin(x_{\\mathrm{peak}})/x_{\\mathrm{peak}} |$。这个值是一个常数，与 $T$ 无关。数值求解器找到 $x_{\\mathrm{peak}} \\approx 4.493409$。相应的电平是 $|\\sin(x_{\\mathrm{peak}})/x_{\\mathrm{peak}}| \\approx 0.21723$。以分贝 (dB) 表示，即为：\n$$\n\\text{First Sidelobe Level}_{\\mathrm{rect}} = 20\\log_{10}(0.21723) \\approx -13.26 \\text{ dB}\n$$\n\n**2. 汉宁窗分析**\n\n汉宁窗定义为：\n$$\nw_{\\mathrm{hann}}(t) = \\begin{cases} \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{2\\pi t}{T}\\right)\\right)  \\text{for } |t| \\le T/2 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n使用欧拉公式，我们可以将余弦项表示为复指数：\n$$\nw_{\\mathrm{hann}}(t) = \\left(\\frac{1}{2} + \\frac{1}{4}e^{i\\frac{2\\pi}{T}t} + \\frac{1}{4}e^{-i\\frac{2\\pi}{T}t}\\right) \\cdot w_{\\mathrm{rect}}(t)\n$$\n其中 $w_{\\mathrm{rect}}(t)$ 是时长为 $T$ 的矩形窗。利用 CTFT 的线性和频移特性，汉宁窗的变换是三个移位的矩形窗变换之和：\n$$\nW_{\\mathrm{hann}}(\\omega) = \\frac{1}{2}W_{\\mathrm{rect}}(\\omega) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\omega - \\frac{2\\pi}{T}\\right) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\omega + \\frac{2\\pi}{T}\\right)\n$$\n为了找到归一化因子 $W_{\\mathrm{hann}}(0)$，我们在 $\\omega=0$ 处计算该表达式：\n$$\nW_{\\mathrm{hann}}(0) = \\frac{1}{2}W_{\\mathrm{rect}}(0) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(-\\frac{2\\pi}{T}\\right) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\frac{2\\pi}{T}\\right)\n$$\n因为 $W_{\\mathrm{rect}}(\\pm 2\\pi/T) = 0$（这些是矩形窗频谱的第一零点）且 $W_{\\mathrm{rect}}(0) = T$，我们有：\n$$\nW_{\\mathrm{hann}}(0) = \\frac{1}{2}T + \\frac{1}{4}(0) + \\frac{1}{4}(0) = \\frac{T}{2}\n$$\n因此，泄漏模式为：\n$$\nL_{w_{\\mathrm{hann}}}(\\Delta\\omega) = \\frac{|W_{\\mathrm{hann}}(\\Delta\\omega)|}{|W_{\\mathrm{hann}}(0)|} = \\frac{\\left| \\frac{1}{2}W_{\\mathrm{rect}}(\\Delta\\omega) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\Delta\\omega - \\frac{2\\pi}{T}\\right) + \\frac{1}{4}W_{\\mathrm{rect}}\\left(\\Delta\\omega + \\frac{2\\pi}{T}\\right) \\right|}{T/2}\n$$\n代入 $W_{\\mathrm{rect}}(\\omega)$ 的表达式，并令 $S(x) = T\\frac{\\sin(xT/2)}{xT/2}$，我们得到：\n$$\nL_{w_{\\mathrm{hann}}}(\\Delta\\omega) = \\left| \\frac{\\frac{1}{2}S(\\Delta\\omega) + \\frac{1}{4}S(\\Delta\\omega - \\frac{2\\pi}{T}) + \\frac{1}{4}S(\\Delta\\omega + \\frac{2\\pi}{T})}{T/2} \\right|\n$$\n最好以这种形式对该表达式进行数值计算，以避免可去奇点的问题。\n\n主瓣宽度：$W_{\\mathrm{hann}}(\\omega)$ 的零点是由三个移位的 sinc 函数相互抵消而产生的。可以证明，包围原点的第一对零点位于 $\\Delta\\omega = \\pm \\frac{4\\pi}{T}$。\n主瓣宽度是这两个零点之间的距离：\n$$\n\\text{Mainlobe Width}_{\\mathrm{hann}} = \\frac{4\\pi}{T} - \\left(-\\frac{4\\pi}{T}\\right) = \\frac{8\\pi}{T}\n$$\n这恰好是矩形窗主瓣宽度的两倍。\n\n第一旁瓣电平：对于汉宁窗，第一旁瓣位于构建块 sinc 函数的第二和第三个零点之间的频率偏移范围内，这对应于 $\\Delta\\omega \\in [4\\pi/T, 6\\pi/T]$。问题要求通过在此区间内足够精细的网格上评估 $L_{w_{\\mathrm{hann}}}(\\Delta\\omega)$ 并找到最大值来确定此值。与矩形窗一样，此旁瓣电平是一个与 $T$ 无关的常数。数值评估显示峰值电平约为 $0.0267$，以分贝表示为：\n$$\n\\text{First Sidelobe Level}_{\\mathrm{hann}} = 20\\log_{10}(0.0267) \\approx -31.47 \\text{ dB}\n$$\n这表明汉宁窗相比矩形窗具有更优越的旁瓣抑制能力，但代价是主瓣更宽。\n\n以下 Python 代码为给定的测试案例实现了这些计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the Fourier analysis problem for rectangular and Hann windows.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T, omega_0). omega_0 is not used in the calculations.\n    test_cases = [\n        (0.02, 2 * np.pi * 1000),\n        (0.1, 2 * np.pi * 200),\n        (1.0, 2 * np.pi * 10),\n        (0.001, 2 * np.pi * 1000),\n    ]\n\n    # --- Sidelobe level calculations (constants independent of T) ---\n\n    # 1. Rectangular window first sidelobe level\n    # Find the peak of the first sidelobe by solving tan(x) = x.\n    # The first positive root occurs in the interval (pi, 3*pi/2).\n    # The target function is f(x) = tan(x) - x.\n    def tan_minus_x(x):\n        return np.tan(x) - x\n    \n    # Use a bracket slightly smaller than (pi, 3*pi/2) for robustness.\n    sol = root_scalar(tan_minus_x, bracket=[np.pi + 1e-6, 1.5 * np.pi - 1e-6])\n    x_peak_rect = sol.root\n    \n    # Sidelobe level is |sin(x_peak)/x_peak}|\n    sidelobe_level_rect_linear = np.abs(np.sin(x_peak_rect) / x_peak_rect)\n    first_sidelobe_dB_rect = 20 * np.log10(sidelobe_level_rect_linear)\n\n    # 2. Hann window first sidelobe level\n    # Use the normalized sinc function from numpy: np.sinc(x) = sin(pi*x)/(pi*x)\n    # To get sin(u)/u, we must evaluate np.sinc(u/pi).\n    def L_hann_norm(u):\n        # Leakage pattern for Hann window as a function of u = Delta_omega * T / 2\n        term1 = np.sinc(u / np.pi)\n        term2 = 0.5 * np.sinc((u - np.pi) / np.pi)\n        term3 = 0.5 * np.sinc((u + np.pi) / np.pi)\n        return np.abs(term1 + term2 + term3)\n\n    # The first sidelobe is in the interval u in [2*pi, 3*pi].\n    # Search for the maximum on a fine grid.\n    u_grid = np.linspace(2 * np.pi, 3 * np.pi, 20000)\n    sidelobe_levels_hann = L_hann_norm(u_grid)\n    sidelobe_level_hann_linear = np.max(sidelobe_levels_hann)\n    first_sidelobe_dB_hann = 20 * np.log10(sidelobe_level_hann_linear)\n\n    # --- Main loop for processing test cases ---\n    \n    results = []\n    for T, omega_0 in test_cases:\n        # Rectangular window calculations\n        mainlobe_width_rect = 4 * np.pi / T\n        \n        # Hann window calculations\n        mainlobe_width_hann = 8 * np.pi / T\n        \n        case_results = [\n            mainlobe_width_rect,\n            first_sidelobe_dB_rect,\n            mainlobe_width_hann,\n            first_sidelobe_dB_hann\n        ]\n        results.append(case_results)\n\n    # --- Format and print the final output ---\n    # The required format is [[r11,r12,r13,r14],[r21,r22,r23,r24],...] with no spaces.\n    inner_strings = [f\"[{','.join(f'{v:.10f}' for v in inner_list)}]\" for inner_list in results]\n    final_output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}