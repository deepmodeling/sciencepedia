{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds our study in fundamental physics by deriving the classical attenuation coefficient from first principles. You will apply the resulting Stokes-Kirchhoff model to calculate the expected acoustic attenuation in glycerol due to viscosity and thermal conduction. By comparing your prediction to a literature value, this exercise  highlights the power of foundational models and, importantly, reveals their limitations when dealing with complex fluids where other loss mechanisms are significant.",
            "id": "4120329",
            "problem": "In computational acoustics of lossy media, attenuation and dispersion arise from irreversible processes associated with viscosity and heat conduction. Consider plane-wave propagation in an unbounded, homogeneous, Newtonian fluid (glycerol at $25\\,\\mathrm{^\\circ C}$) with parameters\n$ \\rho = 1260\\,\\mathrm{kg\\,m^{-3}}$, $ \\eta = 1.49\\,\\mathrm{Pa\\,s}$, $ \\kappa = 0.285\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $ c_p = 2410\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $ \\gamma = 1.055$, and adiabatic sound speed $ c = 1900\\,\\mathrm{m\\,s^{-1}}$. Assume negligible bulk viscosity (i.e., set the bulk viscosity to zero) and ignore internal relaxation mechanisms other than shear viscosity and thermal conduction. A literature report gives an attenuation coefficient at $f = 1\\,\\mathrm{MHz}$ of $ \\alpha_{\\mathrm{lit}} = 25\\,\\mathrm{Np\\,m^{-1}}$ for glycerol under similar thermodynamic conditions.\n\nStarting from the linearized conservation laws for mass, momentum, and energy, together with a thermodynamic closure appropriate for small-amplitude acoustics in a Newtonian fluid and the plane-wave ansatz, derive the leading-order (small-loss) expression for the plane-wave attenuation coefficient $ \\alpha(\\omega) $ due to shear viscosity and thermal conduction. Then, evaluate the predicted $ \\alpha(\\omega) $ at $ f = 1\\,\\mathrm{MHz} $ using the parameters above, and compute the dimensionless ratio\n$$ R = \\frac{\\alpha_{\\mathrm{pred}}}{\\alpha_{\\mathrm{lit}}}. $$\nRound $ R $ to four significant figures. Express the final answer as a pure number with no units. For the intermediate numerical evaluation of $ \\alpha(\\omega) $, use Nepers per meter for attenuation. The angular frequency is $ \\omega = 2\\pi f $, and the small-loss limit is defined by $ \\alpha \\ll \\omega/c $ so that $ k \\approx \\omega/c + i\\,\\alpha $ holds.",
            "solution": "The problem requires the derivation of the leading-order expression for the plane-wave attenuation coefficient, $\\alpha(\\omega)$, in a lossy fluid, followed by a numerical evaluation for glycerol at a specified frequency and comparison with a literature value.\n\nThe derivation begins with the linearized equations of fluid dynamics: the conservation of mass (continuity), conservation of momentum (Navier-Stokes), and conservation of energy, supplemented by thermodynamic state equations for a Newtonian fluid. For a plane wave of the form $\\exp(i(\\tilde{k}x - \\omega t))$, where $\\tilde{k}$ is the complex wavenumber and $\\omega$ is the angular frequency, these equations can be combined to yield a dispersion relation for $\\tilde{k}$ as a function of $\\omega$ and the fluid properties.\n\nThe standard result for the complex wavenumber squared, $\\tilde{k}^2$, consistent with the $e^{i(kx-\\omega t)}$ wave convention and physical dissipation (which requires $\\mathrm{Im}(\\tilde{k}^2)>0$), is given by:\n$$ \\tilde{k}^2 = \\frac{\\omega^2}{c^2} \\left[ 1 - i \\omega \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) \\right]^{-1} $$\nwhere $c$ is the adiabatic sound speed, $\\rho$ is the density, $\\eta$ is the shear viscosity, $\\eta_B$ is the bulk viscosity, $\\gamma$ is the ratio of specific heats, $\\kappa$ is the thermal conductivity, and $c_p$ is the specific heat at constant pressure.\n\nThe problem specifies the small-loss limit, which implies that the imaginary term in the brackets is much smaller than $1$. We can therefore use the binomial approximation $(1-x)^{-1} \\approx 1+x$ for small $x$. Let\n$$ x = i \\omega \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) $$\nApplying this approximation gives:\n$$ \\tilde{k}^2 \\approx \\frac{\\omega^2}{c^2} \\left[ 1 + i \\omega \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) \\right] $$\nTo find $\\tilde{k}$, we take the square root:\n$$ \\tilde{k} \\approx \\frac{\\omega}{c} \\left[ 1 + i \\omega \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) \\right]^{1/2} $$\nAgain using a binomial approximation, $(1+y)^{1/2} \\approx 1 + \\frac{1}{2}y$ for small $y$:\n$$ \\tilde{k} \\approx \\frac{\\omega}{c} \\left[ 1 + \\frac{i \\omega}{2} \\left( \\frac{\\frac{4}{3}\\eta + \\eta_B}{\\rho c^2} + \\frac{(\\gamma-1)\\kappa}{\\rho c_p c^2} \\right) \\right] $$\n$$ \\tilde{k} \\approx \\frac{\\omega}{c} + i \\frac{\\omega^2}{2\\rho c^3} \\left( \\frac{4}{3}\\eta + \\eta_B + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\nA plane wave propagating in the positive $x$-direction is described by a pressure field $p(x,t) \\propto \\exp(i(\\tilde{k}x - \\omega t))$. We express the complex wavenumber as $\\tilde{k} = k_r + i\\alpha$, so that $p(x,t) \\propto \\exp(-\\alpha x)\\exp(i(k_r x - \\omega t))$, where $\\alpha$ is the attenuation coefficient. By comparing this form with our derived expression for $\\tilde{k}$, we identify the attenuation coefficient $\\alpha$ as the imaginary part of $\\tilde{k}$.\n$$ \\alpha(\\omega) = \\frac{\\omega^2}{2\\rho c^3} \\left( \\frac{4}{3}\\eta + \\eta_B + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\nThe problem states to assume negligible bulk viscosity, so we set $\\eta_B=0$. The resulting leading-order expression is the classical (Stokes-Kirchhoff) attenuation coefficient:\n$$ \\alpha(\\omega) = \\frac{\\omega^2}{2\\rho c^3} \\left( \\frac{4}{3}\\eta + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) $$\nNow, we evaluate this expression using the given parameters for glycerol.\nThe givens are:\n$f = 1\\,\\mathrm{MHz} = 1 \\times 10^6\\,\\mathrm{Hz}$\n$\\rho = 1260\\,\\mathrm{kg\\,m^{-3}}$\n$\\eta = 1.49\\,\\mathrm{Pa\\,s}$\n$\\kappa = 0.285\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$c_p = 2410\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n$\\gamma = 1.055$\n$c = 1900\\,\\mathrm{m\\,s^{-1}}$\n$\\alpha_{\\mathrm{lit}} = 25\\,\\mathrm{Np\\,m^{-1}}$\n\nFirst, calculate the angular frequency $\\omega$:\n$$ \\omega = 2\\pi f = 2\\pi (1 \\times 10^6 \\,\\mathrm{s^{-1}}) = 2\\pi \\times 10^6 \\,\\mathrm{rad\\,s^{-1}} $$\nNext, we evaluate the terms inside the parentheses, which represent the contributions from shear viscosity and thermal conduction.\nViscous contribution:\n$$ \\frac{4}{3}\\eta = \\frac{4}{3}(1.49\\,\\mathrm{Pa\\,s}) \\approx 1.98667\\,\\mathrm{Pa\\,s} $$\nThermal contribution:\n$$ \\frac{(\\gamma-1)\\kappa}{c_p} = \\frac{(1.055 - 1)(0.285\\,\\mathrm{W\\,m^{-1}\\,K^{-1}})}{2410\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}} = \\frac{0.055 \\times 0.285}{2410}\\,\\mathrm{Pa\\,s} \\approx 6.504 \\times 10^{-6}\\,\\mathrm{Pa\\,s} $$\nThe total effective viscosity term is the sum of these two:\n$$ \\delta = \\left( \\frac{4}{3}\\eta + \\frac{(\\gamma-1)\\kappa}{c_p} \\right) \\approx 1.98667\\,\\mathrm{Pa\\,s} + 6.504 \\times 10^{-6}\\,\\mathrm{Pa\\,s} \\approx 1.986677\\,\\mathrm{Pa\\,s} $$\nThe thermal contribution is evidently negligible compared to the viscous contribution for glycerol under these conditions.\n\nNow, we compute the predicted attenuation coefficient, $\\alpha_{\\mathrm{pred}}$:\n$$ \\alpha_{\\mathrm{pred}} = \\frac{(2\\pi \\times 10^6\\,\\mathrm{s^{-1}})^2}{2(1260\\,\\mathrm{kg\\,m^{-3}})(1900\\,\\mathrm{m\\,s^{-1}})^3} \\left( 1.986677\\,\\mathrm{Pa\\,s} \\right) $$\n$$ \\alpha_{\\mathrm{pred}} = \\frac{4\\pi^2 \\times 10^{12}}{2(1260)(6.859 \\times 10^9)} (1.986677)\\,\\mathrm{m^{-1}} $$\n$$ \\alpha_{\\mathrm{pred}} = \\frac{4\\pi^2 \\times 10^{12}}{1.728468 \\times 10^{13}} (1.986677)\\,\\mathrm{m^{-1}} $$\n$$ \\alpha_{\\mathrm{pred}} \\approx (2.28402\\,\\mathrm{m\\,J^{-1}}) (1.986677\\,\\mathrm{Pa\\,s}) \\approx 4.53802\\,\\mathrm{Np\\,m^{-1}} $$\nThe unit $\\mathrm{m\\,J^{-1}} \\times \\mathrm{Pa\\,s} = \\mathrm{m\\,(N\\,m)^{-1}} \\times \\mathrm{N\\,s\\,m^{-2}} \\times \\mathrm{s} = \\mathrm{m^{-1}}$, as expected for an attenuation coefficient in Nepers per meter.\n\nFinally, we compute the dimensionless ratio $R$:\n$$ R = \\frac{\\alpha_{\\mathrm{pred}}}{\\alpha_{\\mathrm{lit}}} = \\frac{4.53802\\,\\mathrm{Np\\,m^{-1}}}{25\\,\\mathrm{Np\\,m^{-1}}} \\approx 0.1815208 $$\nRounding to four significant figures, we get:\n$$ R \\approx 0.1815 $$\nThe significant discrepancy between the predicted and literature values ($R \\ll 1$) is well-known for associated liquids like glycerol and is attributed to relaxation processes (e.g., structural relaxation) not accounted for by the classical Stokes-Kirchhoff theory, as well as the simplifying assumption of zero bulk viscosity, which is not accurate for glycerol. The problem, however, requires the calculation based only on the provided model and parameters.",
            "answer": "$$\n\\boxed{0.1815}\n$$"
        },
        {
            "introduction": "We now shift from a specific physical derivation to the mathematical analysis of a general dispersion relation, a powerful tool for describing wave phenomena. This exercise  presents a common model for a weakly lossy medium through its complex wavenumber $k(\\omega)$. Your task is to use approximation techniques to extract key propagation characteristics—phase velocity ($c_p$), group velocity ($c_g$), and the attenuation coefficient ($\\alpha$)—directly from this relation, demonstrating how it fully encapsulates the medium's behavior.",
            "id": "4120341",
            "problem": "Consider a one-dimensional, homogeneous, isotropic, weakly lossy acoustic medium supporting small-amplitude plane waves. Let the acoustic pressure field be modeled as $p(x,t) = \\Re\\{p_0 \\exp(i(k(\\omega) x - \\omega t))\\}$, where $\\omega$ is the angular frequency, $k(\\omega)$ is the complex wavenumber, and $\\Re\\{\\cdot\\}$ denotes the real part. Assume the medium’s dispersion relation is governed by linearized momentum and continuity equations together with a constitutive response that results in the frequency-domain relation\n$$\nk(\\omega) = \\sqrt{\\frac{\\omega^{2}}{c_{0}^{2}} + i\\, a\\, \\omega^{2}},\n$$\nwhere $c_{0} > 0$ is the reference sound speed of the corresponding lossless medium and $a$ is a small, positive parameter with dimensions such that $a\\,\\omega^{2}$ has dimensions of $k^{2}$. Take the principal branch of the square root for which $\\Re(k(\\omega)) > 0$. For a narrowband wave packet, define the phase velocity $c_{p}(\\omega)$ and group velocity $c_{g}(\\omega)$ by\n$$\nc_{p}(\\omega) = \\frac{\\omega}{\\Re\\{k(\\omega)\\}}, \\qquad c_{g}(\\omega) = \\left(\\frac{d\\,\\Re\\{k(\\omega)\\}}{d\\omega}\\right)^{-1},\n$$\nand define the attenuation coefficient $\\alpha(\\omega)$ by the spatial amplitude decay $\\exp(-\\alpha(\\omega)\\, x)$, i.e., $\\alpha(\\omega) = \\Im\\{k(\\omega)\\}$, where $\\Im\\{\\cdot\\}$ denotes the imaginary part. Working consistently to first order in the small parameter $a$, compute the expressions for $c_{p}(\\omega)$, $c_{g}(\\omega)$, and $\\alpha(\\omega)$ as functions of $\\omega$, and briefly interpret the physical implications of your results. Provide your final expressions in closed form without numerical evaluation. No rounding is required. Do not include units in the final expressions.",
            "solution": "The problem requires finding the first-order approximations for phase velocity ($c_p$), group velocity ($c_g$), and attenuation ($\\alpha$) for a given dispersion relation in a weakly lossy medium.\n\nThe analysis begins with the given dispersion relation for the complex wavenumber $k(\\omega)$:\n$$\nk(\\omega) = \\sqrt{\\frac{\\omega^{2}}{c_{0}^{2}} + i\\, a\\, \\omega^{2}}\n$$\nAssuming $\\omega > 0$, we can factor out the lossless term $\\frac{\\omega}{c_0}$:\n$$\nk(\\omega) = \\frac{\\omega}{c_0} \\sqrt{1 + i a c_0^2}\n$$\nThe problem states that $a$ is a small, positive parameter. The quantity $\\epsilon = a c_0^2$ is therefore a small, positive, dimensionless parameter. The expression for $k(\\omega)$ becomes:\n$$\nk(\\omega) = \\frac{\\omega}{c_0} \\sqrt{1 + i\\epsilon}\n$$\nTo find the real and imaginary parts of $k(\\omega)$, we expand the term $\\sqrt{1 + i\\epsilon}$ for small $\\epsilon$ using the Taylor series for $(1+z)^{1/2}$ around $z=0$, where $z=i\\epsilon$.\n$$\n(1+z)^{1/2} \\approx 1 + \\frac{1}{2}z - \\frac{1}{8}z^2 + \\dots\n$$\nSubstituting $z=i\\epsilon$:\n$$\n\\sqrt{1+i\\epsilon} \\approx 1 + \\frac{1}{2}(i\\epsilon) - \\frac{1}{8}(i\\epsilon)^2 = 1 + i\\frac{\\epsilon}{2} + \\frac{\\epsilon^2}{8}\n$$\nNow, substitute this back into the expression for $k(\\omega)$ and replace $\\epsilon$ with $a c_0^2$:\n$$\nk(\\omega) \\approx \\frac{\\omega}{c_0} \\left[ \\left(1 + \\frac{a^2 c_0^4}{8}\\right) + i\\left(\\frac{a c_0^2}{2}\\right) \\right] = \\left(\\frac{\\omega}{c_0} + \\frac{1}{8}a^2 c_0^3 \\omega\\right) + i\\left(\\frac{a c_0 \\omega}{2}\\right)\n$$\nFrom this approximation, we can identify the real and imaginary parts of $k(\\omega)$:\n$$\n\\Re\\{k(\\omega)\\} \\approx \\frac{\\omega}{c_0} + \\frac{1}{8}a^2 c_0^3 \\omega\n$$\n$$\n\\Im\\{k(\\omega)\\} \\approx \\frac{a c_0 \\omega}{2}\n$$\nWe now compute the requested quantities, consistently to first order in $a$.\n\n**1. Attenuation Coefficient $\\alpha(\\omega)$**\nBy definition, $\\alpha(\\omega) = \\Im\\{k(\\omega)\\}$. This expression is linear in $a$, so it represents the correct first-order approximation.\n$$\n\\alpha(\\omega) = \\frac{a c_0 \\omega}{2}\n$$\n\n**2. Phase Velocity $c_p(\\omega)$**\nBy definition, $c_p(\\omega) = \\frac{\\omega}{\\Re\\{k(\\omega)\\}}$. \n$$\nc_p(\\omega) \\approx \\frac{\\omega}{\\frac{\\omega}{c_0} + \\frac{1}{8}a^2 c_0^3 \\omega} = \\frac{1}{\\frac{1}{c_0} + \\frac{1}{8}a^2 c_0^3} = \\frac{c_0}{1 + \\frac{1}{8}a^2 c_0^4}\n$$\nUsing the approximation $(1+x)^{-1} \\approx 1-x$ for small $x$:\n$$\nc_p(\\omega) \\approx c_0 \\left(1 - \\frac{1}{8}a^2 c_0^4\\right) = c_0 - \\frac{1}{8}a^2 c_0^5\n$$\nThe expression for $c_p(\\omega)$ can be written as a series in $a$: $c_p(\\omega) = c_0 + 0 \\cdot a - (\\frac{1}{8}c_0^5) a^2 + \\dots$. The approximation to first order in $a$ includes terms up to the linear power of $a$. Since the coefficient of $a^1$ is zero, the first-order approximation is the zeroth-order term:\n$$\nc_p(\\omega) = c_0\n$$\n\n**3. Group Velocity $c_g(\\omega)$**\nBy definition, $c_g(\\omega) = \\left(\\frac{d\\,\\Re\\{k(\\omega)\\}}{d\\omega}\\right)^{-1}$. First, we compute the derivative of $\\Re\\{k(\\omega)\\}$ with respect to $\\omega$:\n$$\n\\frac{d}{d\\omega}\\Re\\{k(\\omega)\\} \\approx \\frac{d}{d\\omega} \\left(\\frac{\\omega}{c_0} + \\frac{1}{8}a^2 c_0^3 \\omega\\right) = \\frac{1}{c_0} + \\frac{1}{8}a^2 c_0^3\n$$\nNow, we compute the group velocity by taking the inverse:\n$$\nc_g(\\omega) \\approx \\left(\\frac{1}{c_0} + \\frac{1}{8}a^2 c_0^3\\right)^{-1} = \\frac{c_0}{1 + \\frac{1}{8}a^2 c_0^4}\n$$\nThis is the same expression as for $c_p(\\omega)$ before approximation. Expanding for small $a$, we get:\n$$\nc_g(\\omega) \\approx c_0 \\left(1 - \\frac{1}{8}a^2 c_0^4\\right) = c_0 - \\frac{1}{8}a^2 c_0^5\n$$\nSimilar to the phase velocity, the first-order term in $a$ is zero. Therefore, the group velocity to first order in $a$ is:\n$$\nc_g(\\omega) = c_0\n$$\n\n**Physical Interpretation**\n-   The attenuation coefficient, $\\alpha(\\omega) = \\frac{a c_0 \\omega}{2}$, is directly proportional to the angular frequency $\\omega$. This implies that higher-frequency components of a wave are attenuated more rapidly than lower-frequency components. A broadband pulse propagating through this medium will be distorted, with its high-frequency content being filtered out over distance.\n-   To first order in the loss parameter $a$, both the phase velocity $c_p(\\omega)$ and group velocity $c_g(\\omega)$ are equal to the constant $c_0$. This means that, at this level of approximation, the medium is non-dispersive. The speeds of wave crests and of the overall wave packet envelope are independent of frequency. Any dispersive effects, where waves of different frequencies travel at different speeds, are of second order or higher in the small parameter $a$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nc_0 & c_0 & \\frac{a c_0 \\omega}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Our final practice bridges theory and application by tackling a critical challenge in computational acoustics: the design of effective absorbing boundaries. This exercise  focuses on the Perfectly Matched Layer (PML), where the concept of a complex wavenumber is used to create a non-reflecting artificial medium. You will perform a practical design task by calculating the optimal PML parameters required to suppress reflections below a target threshold, a crucial skill for accurate finite-domain simulations.",
            "id": "4120352",
            "problem": "Consider a two-dimensional linear acoustics setting with a homogeneous, isotropic, lossy medium characterized by the sound speed $c_0$ and a frequency-dependent amplitude attenuation coefficient $\\alpha(\\omega)$ obeying a power-law model $\\alpha(\\omega) = a \\, \\omega^y$ with parameters $a$ and exponent $y$. The acoustic pressure field $p(\\mathbf{x},t)$ satisfies the frequency-domain Helmholtz equation for time-harmonic fields with angular frequency $\\omega = 2 \\pi f$, where $f$ is the frequency in $\\mathrm{Hz}$, and the complex wavenumber is $\\tilde{k}(\\omega) = \\frac{\\omega}{c_0} + i \\alpha(\\omega)$. For a plane wave of incidence angle $\\theta$ (measured from the outward unit normal to the truncation boundary, in radians), the component of the complex wavenumber along the outward normal is $\\tilde{k}_x = \\tilde{k} \\cos\\theta$.\n\nTo truncate the computational domain along the outward normal direction $x$ over a finite thickness $L$ in meters, a Perfectly Matched Layer (PML) based on complex coordinate stretching is used with stretching function $s_x(x) = 1 + i \\frac{\\sigma(x)}{\\omega}$, where the PML conductivity profile is graded as $\\sigma(x) = \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m$ for $0 \\le x \\le L$ and polynomial order $m$ is a non-negative integer. The outer end of the PML at $x=L$ is terminated by a perfectly reflecting rigid boundary. Assume the PML is matched at $x=0$ by enforcing $\\sigma(0) = 0$ so that $s_x(0) = 1$.\n\nFrom fundamental linear acoustics and complex coordinate stretching, the plane-wave amplitude after traversing the PML of thickness $L$ and returning from the rigid termination yields a reflected amplitude at the PML entrance with magnitude\n$$\nR = \\exp\\!\\Big(-2 L \\, \\mathrm{Im}(\\tilde{k}_x)\\Big)\\, \\exp\\!\\Big(-2\\, \\mathrm{Re}(\\tilde{k}_x)\\, A\\Big),\n$$\nwhere\n$$\nA = \\int_0^L \\mathrm{Im}\\big(s_x(\\xi)\\big)\\, d\\xi = \\frac{1}{\\omega}\\int_0^L \\sigma(\\xi)\\, d\\xi = \\frac{\\sigma_{\\max} L}{(m+1)\\, \\omega}.\n$$\nThe target reflection magnitude threshold is defined by $R_{\\mathrm{target}} = 10^{\\frac{-40}{20}}$, which is a dimensionless amplitude ratio equivalent to $-40\\,\\mathrm{dB}$.\n\nYour task is to write a complete program that, for each test case, computes the minimal nonnegative PML peak conductivity $\\sigma_{\\max}$ needed to guarantee $R \\le R_{\\mathrm{target}}$ for a plane wave at the specified oblique incidence, and then verifies the achieved reflection magnitude by evaluating $R$ using the chosen $\\sigma_{\\max}$. You must base your computation on the following fundamental principles and definitions:\n- Linearized acoustics in the frequency domain with lossy media yields the Helmholtz equation $\\nabla^2 p + \\tilde{k}^2 p = 0$, where $\\tilde{k}(\\omega) = \\frac{\\omega}{c_0} + i\\alpha(\\omega)$.\n- A plane wave in a homogeneous isotropic medium has directional wavenumber components given by projecting $\\tilde{k}$ onto the direction of propagation; thus $\\tilde{k}_x = \\tilde{k}\\cos\\theta$ for incidence angle $\\theta$.\n- Complex coordinate stretching replaces $x$ by $x' = \\int_0^x s_x(\\xi) \\, d\\xi$ so that plane-wave solutions acquire exponential factors $\\exp\\!\\big(i \\tilde{k}_x x'\\big)$, and the magnitude effect splits into attenuation from $\\mathrm{Im}(\\tilde{k}_x)$ over real distance $L$ and attenuation from $\\mathrm{Im}(s_x)$ scaled by $\\mathrm{Re}(\\tilde{k}_x)$.\n\nThe minimal $\\sigma_{\\max}$ that achieves the target can be derived from the inequality $R \\le R_{\\mathrm{target}}$ and must satisfy\n$$\n\\sigma_{\\max} \\ge \\max\\!\\left( 0, \\; \\frac{(m+1)\\, \\omega}{2\\, L\\, \\mathrm{Re}(\\tilde{k}_x)} \\left[ \\ln\\!\\Big(\\frac{1}{R_{\\mathrm{target}}}\\Big) - 2\\, L\\, \\mathrm{Im}(\\tilde{k}_x) \\right] \\right),\n$$\nwith the understanding that $\\mathrm{Re}(\\tilde{k}_x) > 0$, which is guaranteed for $0 \\le \\theta < \\frac{\\pi}{2}$ and physical $c_0 > 0$.\n\nPhysical and numerical unit requirements:\n- Express all input quantities using the International System of Units (SI): $c_0$ in $\\mathrm{m/s}$, $f$ in $\\mathrm{Hz}$, $L$ in $\\mathrm{m}$, $a$ in $\\mathrm{m^{-1}\\, s^{-y}}$, and $\\theta$ in radians.\n- All computed reflection magnitudes $R$ are dimensionless amplitude ratios.\n\nTest suite:\nFor each test case, the tuple is $(c_0, f, L, m, \\theta, a, y)$, with the following parameter sets to evaluate and verify:\n1. $(1500, \\; 50\\,000, \\; 0.02, \\; 3, \\; 0, \\; 1\\times 10^{-5}, \\; 1)$\n2. $(1540, \\; 500\\,000, \\; 0.01, \\; 2, \\; \\frac{\\pi}{4}, \\; 2\\times 10^{-6}, \\; 1.2)$\n3. $(343, \\; 2000, \\; 0.05, \\; 4, \\; \\frac{80 \\pi}{180}, \\; 5\\times 10^{-9}, \\; 2)$\n4. $(1540, \\; 1\\,000\\,000, \\; 0.03, \\; 3, \\; 0.3, \\; 9.16\\times 10^{-7}, \\; 1)$\n\nProgram requirements and final output:\n- For each test case, compute $\\omega = 2\\pi f$, then $\\tilde{k} = \\frac{\\omega}{c_0} + i \\, a \\, \\omega^y$, then $\\tilde{k}_x = \\tilde{k} \\cos\\theta$.\n- Compute the minimal nonnegative $\\sigma_{\\max}$ using the inequality above.\n- Using the computed $\\sigma_{\\max}$, evaluate $A = \\frac{\\sigma_{\\max} L}{(m+1)\\omega}$, then compute $R = \\exp\\!\\Big(-2 L \\, \\mathrm{Im}(\\tilde{k}_x)\\Big)\\, \\exp\\!\\Big(-2\\, \\mathrm{Re}(\\tilde{k}_x)\\, A\\Big)$.\n- For each test case, record a boolean result indicating whether $R \\le R_{\\mathrm{target}}$ holds.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[b_1,b_2,b_3,b_4]$, where each $b_i$ is either $\\mathrm{True}$ or $\\mathrm{False}$.\n\nThe program must be self-contained, must not read any input, and must adhere to the specified execution environment and libraries. The output must follow exactly the specified single-line format.",
            "solution": "The problem requires calculating the minimum peak conductivity, $\\sigma_{\\max}$, for a Perfectly Matched Layer (PML) to achieve a specified reflection reduction in a lossy acoustic medium. Subsequently, the achieved reflection magnitude, $R$, must be verified against the target threshold, $R_{\\mathrm{target}}$. The solution is derived from the principles of wave propagation in lossy media and the complex coordinate stretching method for PMLs.\n\nThe procedure for each test case $(c_0, f, L, m, \\theta, a, y)$ is as follows:\n\n1.  **Calculate derived parameters:** The angular frequency is $\\omega = 2 \\pi f$. The target reflection magnitude, corresponding to $-40\\,\\mathrm{dB}$, is $R_{\\mathrm{target}} = 10^{-40/20} = 10^{-2} = 0.01$.\n\n2.  **Determine medium properties:** The attenuation coefficient is modeled as a power law, $\\alpha(\\omega) = a\\,\\omega^y$. The complex wavenumber of the medium is $\\tilde{k}(\\omega) = \\frac{\\omega}{c_0} + i\\alpha(\\omega)$.\n\n3.  **Determine directional wavenumber:** For a plane wave incident at an angle $\\theta$ to the boundary normal, the normal component of the complex wavenumber is $\\tilde{k}_x = \\tilde{k}(\\omega) \\cos\\theta$. We then find its real and imaginary parts:\n    $$\n    \\mathrm{Re}(\\tilde{k}_x) = \\frac{\\omega}{c_0} \\cos\\theta\n    $$\n    $$\n    \\mathrm{Im}(\\tilde{k}_x) = a \\omega^y \\cos\\theta\n    $$\n\n4.  **Calculate minimal required $\\sigma_{\\max}$:** The PML's effect is captured in the reflection magnitude formula. To achieve $R \\le R_{\\mathrm{target}}$, we solve for the minimum non-negative $\\sigma_{\\max}$:\n    $$\n    \\sigma_{\\max} = \\max\\!\\left( 0, \\; \\frac{(m+1)\\, \\omega}{2\\, L\\, \\mathrm{Re}(\\tilde{k}_x)} \\left[ \\ln\\!\\Big(\\frac{1}{R_{\\mathrm{target}}}\\Big) - 2\\, L\\, \\mathrm{Im}(\\tilde{k}_x) \\right] \\right)\n    $$\n\n5.  **Verify the reflection magnitude:** Using the computed minimal $\\sigma_{\\max}$, we calculate the integrated PML effect term $A = \\frac{\\sigma_{\\max} L}{(m+1)\\omega}$ and then evaluate the reflection magnitude $R$ using its definition:\n    $$\n    R = \\exp\\Big(-2 L \\, \\mathrm{Im}(\\tilde{k}_x)\\Big)\\, \\exp\\Big(-2\\, \\mathrm{Re}(\\tilde{k}_x)\\, A\\Big)\n    $$\n\n6.  **Check the condition:** Finally, we verify if the computed reflection $R$ satisfies the design criterion, i.e., whether $R \\le R_{\\mathrm{target}}$. The result for each test case is the boolean outcome of this comparison.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimal PML peak conductivity sigma_max required to achieve a\n    target reflection and verifies the achieved reflection magnitude for a set\n    of test cases in computational acoustics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (c0, f, L, m, theta, a, y)\n    test_cases = [\n        (1500, 50000, 0.02, 3, 0, 1e-5, 1),\n        (1540, 500000, 0.01, 2, np.pi/4, 2e-6, 1.2),\n        (343, 2000, 0.05, 4, 80 * np.pi/180, 5e-9, 2),\n        (1540, 1000000, 0.03, 3, 0.3, 9.16e-7, 1)\n    ]\n\n    R_target = 10**(-40 / 20)\n    results = []\n\n    for case in test_cases:\n        c0, f, L, m, theta, a, y = case\n\n        # Step 1: Calculate angular frequency\n        omega = 2 * np.pi * f\n\n        # Step 2: Calculate attenuation coefficient and complex wavenumber\n        alpha_omega = a * (omega**y)\n        k_tilde = (omega / c0) + 1j * alpha_omega\n\n        # Step 3: Calculate the normal component of the complex wavenumber\n        k_tilde_x = k_tilde * np.cos(theta)\n        re_k_tilde_x = k_tilde_x.real\n        im_k_tilde_x = k_tilde_x.imag\n\n        # Step 4: Calculate the minimal required non-negative sigma_max\n        # The condition Re(k_tilde_x) > 0 is guaranteed by the problem statement.\n        log_inv_R_target = np.log(1 / R_target)\n        \n        # This term inside the parenthesis represents the additional attenuation needed\n        # from the PML after accounting for the medium's own attenuation.\n        term_in_brackets = log_inv_R_target - 2 * L * im_k_tilde_x\n        \n        # Calculate the expression for sigma_max\n        sigma_max_expr = ((m + 1) * omega) / (2 * L * re_k_tilde_x) * term_in_brackets\n        \n        # The minimal required sigma_max must be non-negative.\n        sigma_max = np.maximum(0, sigma_max_expr)\n\n        # Step 5: Verify the achieved reflection magnitude R using the computed sigma_max\n        # First, calculate the integrated PML conductivity term A\n        # The equation for A has omega in the denominator, which is non-zero.\n        A = (sigma_max * L) / ((m + 1) * omega)\n\n        # Then, calculate the total reflection magnitude R\n        # R is a product of attenuation due to the medium and attenuation due to the PML.\n        attenuation_medium = np.exp(-2 * L * im_k_tilde_x)\n        attenuation_pml = np.exp(-2 * re_k_tilde_x * A)\n        R = attenuation_medium * attenuation_pml\n\n        # Step 6: Check if the resulted R is less than or equal to R_target\n        # This should be true by construction, barring floating point inaccuracies.\n        is_le_target = R = R_target\n\n        results.append(is_le_target)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}