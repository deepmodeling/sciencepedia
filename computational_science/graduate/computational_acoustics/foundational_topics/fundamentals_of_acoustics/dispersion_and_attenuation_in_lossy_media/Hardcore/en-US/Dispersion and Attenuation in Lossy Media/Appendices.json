{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp dispersion and attenuation, we must first connect these macroscopic wave phenomena to their microscopic physical origins. This practice guides you through a foundational analysis, starting from the linearized equations of fluid dynamics to derive the classical acoustic attenuation in a gas. By applying this derivation to air, you will quantify the distinct contributions of shear viscosity and thermal conduction, providing a concrete understanding of how energy is dissipated from a sound wave into a medium .",
            "id": "4120336",
            "problem": "Consider a plane, one-dimensional, time-harmonic acoustic wave of angular frequency $\\omega$ propagating in quiescent air at standard conditions. Model the air as a Newtonian, ideal gas with shear viscosity $\\eta$, bulk viscosity $\\zeta$, thermal conductivity $k$, specific heat at constant pressure $c_p$, ratio of specific heats $\\gamma$, and ambient mass density $\\rho_0$. Assume linear acoustics in the small-amplitude limit and neglect molecular relaxation processes, so that dissipation arises solely from shear viscosity and thermal conduction entering the linearized compressible Navier–Stokes equations and the linearized energy equation with Fourier’s law of heat conduction.\n\nStarting from the linearized continuity equation, linearized momentum equation with viscous stresses, the linearized energy equation, and the ideal-gas equation of state, derive the leading-order small-dissipation dispersion relation for a plane wave, and from it identify the attenuation contributions due to shear viscosity and thermal conduction. Using the material parameters for air at $T_0 = 293.15\\,\\mathrm{K}$:\n- $\\rho_0 = 1.204\\,\\mathrm{kg/m^3}$,\n- $\\eta = 1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$,\n- $\\zeta = 0\\,\\mathrm{Pa\\cdot s}$,\n- $k = 2.57 \\times 10^{-2}\\,\\mathrm{W/(m\\cdot K)}$,\n- $c_p = 1.006 \\times 10^{3}\\,\\mathrm{J/(kg\\cdot K)}$,\n- $\\gamma = 1.4$,\n\nand frequency $f = 10\\,\\mathrm{kHz}$ (with $\\omega = 2\\pi f$), compute the relative contributions of shear viscosity and thermal conduction to the attenuation, defined as the dimensionless fractions\n$$\n\\phi_{\\mathrm{shear}} = \\frac{\\alpha_{\\mathrm{shear}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}}\n\\quad\\text{and}\\quad\n\\phi_{\\mathrm{thermal}} = \\frac{\\alpha_{\\mathrm{thermal}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}},\n$$\nwhere $\\alpha_{\\mathrm{shear}}$ and $\\alpha_{\\mathrm{thermal}}$ denote the attenuation contributions attributable to shear viscosity and thermal conduction, respectively, in the leading-order dispersion relation you derive. Express the final answer as two dimensionless numbers in a single row matrix using the LaTeX `pmatrix` environment, and round each number to four significant figures.",
            "solution": "The problem requires the derivation of the leading-order small-dissipation dispersion relation for an acoustic wave in a viscous, heat-conducting gas, and the subsequent calculation of the relative contributions of shear viscosity and thermal conduction to the wave's attenuation.\n\nThe analysis begins with the linearized governing equations for fluid motion, which are the conservation of mass (continuity), momentum (Navier-Stokes), and energy, supplemented by the equation of state for an ideal gas. For a one-dimensional plane wave propagating in the $x$-direction, these equations are:\n\n$1$. **Linearized Continuity Equation**:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n\n$2$. **Linearized Momentum Equation**:\n$$\n\\rho_0 \\frac{\\partial u'}{\\partial t} = -\\frac{\\partial p'}{\\partial x} + \\left(\\zeta + \\frac{4}{3}\\eta\\right) \\frac{\\partial^2 u'}{\\partial x^2}\n$$\n\n$3$. **Linearized Energy Equation**:\n$$\n\\rho_0 c_p \\frac{\\partial T'}{\\partial t} - \\frac{\\partial p'}{\\partial t} = k \\frac{\\partial^2 T'}{\\partial x^2}\n$$\n\n$4$. **Linearized Ideal Gas Equation of State**:\n$$\n\\frac{p'}{p_0} = \\frac{\\rho'}{\\rho_0} + \\frac{T'}{T_0}\n$$\n\nHere, $\\rho'$, $p'$, $u'$, and $T'$ are the small acoustic perturbations in density, pressure, velocity, and temperature, respectively. The ambient quantities are density $\\rho_0$, pressure $p_0$, and temperature $T_0$. The material properties are the shear viscosity $\\eta$, bulk viscosity $\\zeta$, thermal conductivity $k$, specific heat at constant pressure $c_p$, and ratio of specific heats $\\gamma$.\n\nWe assume time-harmonic plane wave solutions of the form $q'(x,t) = \\hat{q} \\exp(i(Kx - \\omega t))$, where $q'$ represents any of the perturbed field variables, $\\hat{q}$ is its complex amplitude, $\\omega$ is the angular frequency, and $K$ is the complex wavenumber. The derivatives transform as $\\frac{\\partial}{\\partial t} \\to -i\\omega$ and $\\frac{\\partial}{\\partial x} \\to iK$. Applying this to the governing equations yields a system of algebraic equations for the amplitudes:\n\n$1$. (Continuity) $-i\\omega \\hat{\\rho} + \\rho_0 (iK) \\hat{u} = 0 \\implies \\omega \\hat{\\rho} = \\rho_0 K \\hat{u}$\n$2$. (Momentum) $\\rho_0(-i\\omega)\\hat{u} = -iK\\hat{p} + (\\zeta + \\frac{4}{3}\\eta)(iK)^2\\hat{u} \\implies \\left[ \\omega\\rho_0 + iK^2\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\hat{u} = K\\hat{p}$\n$3$. (Energy) $\\rho_0 c_p(-i\\omega)\\hat{T} - (-i\\omega)\\hat{p} = k(iK)^2\\hat{T} \\implies \\omega\\hat{p} = (\\omega\\rho_0 c_p + iK^2 k)\\hat{T}$\n$4$. (State) $\\frac{\\hat{p}}{p_0} = \\frac{\\hat{\\rho}}{\\rho_0} + \\frac{\\hat{T}}{T_0}$\n\nFrom the first two equations, we can relate $\\hat{p}$ and $\\hat{\\rho}$:\nFrom $(1)$, $\\hat{u} = \\frac{\\omega}{\\rho_0 K}\\hat{\\rho}$. Substituting this into $(2)$:\n$$\n\\left[ \\omega\\rho_0 + iK^2\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\left(\\frac{\\omega}{\\rho_0 K}\\hat{\\rho}\\right) = K\\hat{p}\n$$\n$$\n\\implies \\left[ \\omega^2 + \\frac{i\\omega K^2}{\\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\hat{\\rho} = K^2\\hat{p} \\quad (\\mathrm{Eq. A})\n$$\nFrom the third and fourth equations, we derive a second relation between $\\hat{p}$ and $\\hat{\\rho}$:\nFrom $(3)$, $\\hat{T} = \\frac{\\omega\\hat{p}}{\\omega\\rho_0 c_p + iK^2 k}$. Substituting this into $(4)$:\n$$\n\\frac{\\hat{\\rho}}{\\rho_0} = \\frac{\\hat{p}}{p_0} - \\frac{\\hat{T}}{T_0} = \\frac{\\hat{p}}{p_0} - \\frac{1}{T_0}\\left(\\frac{\\omega\\hat{p}}{\\omega\\rho_0 c_p + iK^2 k}\\right)\n$$\nUsing the ideal gas relations $p_0 = \\rho_0 R T_0$, $c_0^2 = \\gamma R T_0 = \\gamma p_0/\\rho_0$, and $R=c_p-c_v=c_p(1-1/\\gamma)$, we can write $\\frac{1}{T_0} = \\frac{\\rho_0 R}{p_0} = \\frac{\\rho_0 c_p(\\gamma-1)}{\\gamma p_0}$.\n$$\n\\frac{\\hat{\\rho}}{\\rho_0} = \\frac{\\hat{p}}{p_0}\\left[ 1 - \\frac{\\rho_0 c_p(\\gamma-1)}{\\gamma} \\frac{\\omega}{\\omega\\rho_0 c_p + iK^2 k} \\right] = \\frac{\\hat{p}}{\\gamma p_0}\\left[ \\gamma - \\frac{\\omega \\rho_0 c_p (\\gamma-1)}{\\omega\\rho_0 c_p + iK^2 k} \\right]\n$$\n$$\n\\frac{\\hat{\\rho}}{\\hat{p}} = \\frac{1}{c_0^2} \\left[ \\frac{\\gamma(\\omega\\rho_0 c_p + iK^2 k) - \\omega \\rho_0 c_p (\\gamma-1)}{\\omega\\rho_0 c_p + iK^2 k} \\right] = \\frac{1}{c_0^2}\\left[ \\frac{\\omega\\rho_0 c_p + i\\gamma K^2 k}{\\omega\\rho_0 c_p + iK^2 k} \\right] \\quad (\\mathrm{Eq. B})\n$$\nCombining (A) and (B) gives the exact dispersion relation. For small dissipation ($\\eta, k, \\zeta$ are small), the wavenumber $K$ is close to the ideal value $k_0 = \\omega/c_0$. We approximate $K^2 \\approx k_0^2 = \\omega^2/c_0^2$ in the small dissipative terms.\nFrom (B), expanding for small $k$:\n$$\n\\frac{\\hat{\\rho}}{\\hat{p}} \\approx \\frac{1}{c_0^2}\\left(1 + \\frac{i\\gamma K^2 k}{\\omega\\rho_0 c_p}\\right)\\left(1 - \\frac{iK^2 k}{\\omega\\rho_0 c_p}\\right)^{-1} \\approx \\frac{1}{c_0^2}\\left(1 + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p}\\right)\n$$\nSubstituting this into (A):\n$$\n\\left[ \\omega^2 + \\frac{i\\omega K^2}{\\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right] \\frac{1}{c_0^2}\\left(1 + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p}\\right) = K^2\n$$\n$$\n\\frac{\\omega^2}{c_0^2} \\left[ 1 + \\frac{i\\omega K^2}{\\omega^2 \\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p} \\right] \\approx K^2\n$$\nSolving for $K^2$ and approximating $K^2 \\approx \\omega^2/c_0^2$ on the right-hand side:\n$$\nK^2 \\approx \\frac{\\omega^2}{c_0^2} \\left[ 1 - \\frac{i\\omega}{\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]^{-1}\n$$\nUsing the binomial expansion $(1-x)^{-1} \\approx 1+x$ for small $x$:\n$$\nK^2 \\approx \\frac{\\omega^2}{c_0^2} \\left[ 1 + \\frac{i\\omega}{\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]\n$$\nTaking the square root and using $(1+y)^{1/2} \\approx 1+y/2$ for small $y$:\n$$\nK \\approx \\frac{\\omega}{c_0} \\left[ 1 + \\frac{i\\omega}{2\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]\n$$\nThis is the required leading-order small-dissipation dispersion relation. The complex wavenumber is $K = k_r + i\\alpha$, where $k_r$ is the real wavenumber and $\\alpha$ is the attenuation coefficient. The wave propagates as $\\exp(i(k_r x-\\omega t) - \\alpha x)$.\n$$\nk_r = \\mathrm{Re}(K) \\approx \\frac{\\omega}{c_0}\n$$\n$$\n\\alpha = \\mathrm{Im}(K) \\approx \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right)\n$$\nThe problem specifies that dissipation arises from shear viscosity and thermal conduction, and provides $\\zeta=0$. The total attenuation $\\alpha$ is the sum of a shear viscosity contribution $\\alpha_{\\mathrm{shear}}$ and a thermal conduction contribution $\\alpha_{\\mathrm{thermal}}$:\n$$\n\\alpha_{\\mathrm{shear}} = \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\frac{4}{3}\\eta\\right)\n$$\n$$\n\\alpha_{\\mathrm{thermal}} = \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\frac{(\\gamma-1)k}{c_p}\\right)\n$$\nThe relative contributions are defined as:\n$$\n\\phi_{\\mathrm{shear}} = \\frac{\\alpha_{\\mathrm{shear}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}} \\quad\\text{and}\\quad \\phi_{\\mathrm{thermal}} = \\frac{\\alpha_{\\mathrm{thermal}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}}\n$$\nThe common factor $\\frac{\\omega^2}{2\\rho_0 c_0^3}$ cancels in these ratios. We only need to compare the terms $S = \\frac{4}{3}\\eta$ and $T = \\frac{(\\gamma-1)k}{c_p}$.\n$$\n\\phi_{\\mathrm{shear}} = \\frac{S}{S+T} \\quad\\text{and}\\quad \\phi_{\\mathrm{thermal}} = \\frac{T}{S+T}\n$$\nUsing the provided material parameters for air:\n$\\eta = 1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n$k = 2.57 \\times 10^{-2}\\,\\mathrm{W/(m\\cdot K)}$\n$c_p = 1.006 \\times 10^{3}\\,\\mathrm{J/(kg\\cdot K)}$\n$\\gamma = 1.4$\n$\\zeta = 0$\n\nWe calculate the terms $S$ and $T$:\n$$\nS = \\frac{4}{3}\\eta = \\frac{4}{3}(1.81 \\times 10^{-5}) \\approx 2.41333 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}\n$$\n$$\nT = \\frac{(\\gamma-1)k}{c_p} = \\frac{(1.4 - 1)(2.57 \\times 10^{-2})}{1.006 \\times 10^{3}} = \\frac{0.4 \\times 2.57 \\times 10^{-2}}{1006} \\approx 1.02187 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}\n$$\nThe sum is $S+T \\approx (2.41333 + 1.02187) \\times 10^{-5} = 3.43520 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}$.\n\nNow we compute the dimensionless fractions:\n$$\n\\phi_{\\mathrm{shear}} = \\frac{2.41333 \\times 10^{-5}}{3.43520 \\times 10^{-5}} \\approx 0.702529\n$$\n$$\n\\phi_{\\mathrm{thermal}} = \\frac{1.02187 \\times 10^{-5}}{3.43520 \\times 10^{-5}} \\approx 0.297471\n$$\nRounding to four significant figures, we get:\n$$\n\\phi_{\\mathrm{shear}} = 0.7025\n$$\n$$\n\\phi_{\\mathrm{thermal}} = 0.2975\n$$\nThese values represent the fractional contribution of shear viscosity and thermal conduction to the total classical attenuation of sound in air under the specified conditions.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7025  0.2975\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While deriving loss mechanisms from first principles is fundamental, we often work with established mathematical models for the complex wavenumber $k(\\omega)$. This exercise hones your ability to interpret such models by analyzing a common form for a weakly lossy medium. Using mathematical approximations, you will extract the expressions for phase velocity $c_p(\\omega)$, group velocity $c_g(\\omega)$, and the attenuation coefficient $\\alpha(\\omega)$, revealing how the underlying physics of loss and dispersion manifest in these key observable quantities .",
            "id": "4120341",
            "problem": "Consider a one-dimensional, homogeneous, isotropic, weakly lossy acoustic medium supporting small-amplitude plane waves. Let the acoustic pressure field be modeled as $p(x,t) = \\mathrm{Re}\\{p_0 \\exp(i(\\omega t - k(\\omega) x))\\}$, where $\\omega$ is the angular frequency, $k(\\omega)$ is the complex wavenumber, and $\\mathrm{Re}\\{\\cdot\\}$ denotes the real part. Assume the medium’s dispersion relation is governed by linearized momentum and continuity equations together with a constitutive response that results in the frequency-domain relation\n$$\nk(\\omega) = \\sqrt{\\frac{\\omega^{2}}{c_{0}^{2}} - i\\, a\\, \\omega^{2}},\n$$\nwhere $c_{0}  0$ is the reference sound speed of the corresponding lossless medium and $a$ is a small, positive parameter with dimensions such that $a\\,\\omega^{2}$ has dimensions of $k^{2}$. Take the principal branch of the square root for which $\\mathrm{Re}(k(\\omega))  0$. For a narrowband wave packet, define the phase velocity $c_{p}(\\omega)$ and group velocity $c_{g}(\\omega)$ by\n$$\nc_{p}(\\omega) = \\frac{\\omega}{\\mathrm{Re}\\{k(\\omega)\\}}, \\qquad c_{g}(\\omega) = \\left(\\frac{d\\,\\mathrm{Re}\\{k(\\omega)\\}}{d\\omega}\\right)^{-1},\n$$\nand define the attenuation coefficient $\\alpha(\\omega)$ by the spatial amplitude decay $\\exp(-\\alpha(\\omega)\\, x)$, i.e., $\\alpha(\\omega) = -\\mathrm{Im}\\{k(\\omega)\\}$, where $\\mathrm{Im}\\{\\cdot\\}$ denotes the imaginary part. Working consistently to first order in the small parameter $a$, compute the expressions for $c_{p}(\\omega)$, $c_{g}(\\omega)$, and $\\alpha(\\omega)$ as functions of $\\omega$, and briefly interpret the physical implications of your results. Provide your final expressions in closed form without numerical evaluation. No rounding is required. Do not include units in the final expressions.",
            "solution": "The complex wavenumber is given by:\n$$ k(\\omega) = \\sqrt{\\frac{\\omega^{2}}{c_{0}^{2}} - i a \\omega^{2}} $$\nAssuming $\\omega > 0$, we can factor out the lossless term $\\omega/c_0$:\n$$ k(\\omega) = \\frac{\\omega}{c_0} \\sqrt{1 - i a c_0^2} $$\nThe problem states that $a$ is a small, positive parameter. Thus, the quantity $\\epsilon = a c_0^2$ is a small, positive, dimensionless parameter representing the strength of the loss. The expression becomes:\n$$ k(\\omega) = \\frac{\\omega}{c_0} \\sqrt{1 - i\\epsilon} $$\nTo find the real and imaginary parts of $k(\\omega)$, we use the Taylor series expansion of $(1-z)^{1/2}$ around $z=0$, which is $(1-z)^{1/2} \\approx 1 - \\frac{z}{2} - \\frac{z^2}{8} + O(z^3)$. Substituting $z = i\\epsilon$:\n$$ \\sqrt{1 - i\\epsilon} \\approx 1 - \\frac{i\\epsilon}{2} - \\frac{(i\\epsilon)^2}{8} = 1 - \\frac{i\\epsilon}{2} + \\frac{\\epsilon^2}{8} = \\left(1 + \\frac{\\epsilon^2}{8}\\right) - i\\frac{\\epsilon}{2} $$\nWe substitute this expansion back into the expression for $k(\\omega)$:\n$$ k(\\omega) \\approx \\frac{\\omega}{c_0} \\left[ \\left(1 + \\frac{\\epsilon^2}{8}\\right) - i\\frac{\\epsilon}{2} \\right] $$\nSubstituting $\\epsilon = a c_0^2$:\n$$ k(\\omega) \\approx \\frac{\\omega}{c_0} \\left[ \\left(1 + \\frac{a^2 c_0^4}{8}\\right) - i\\frac{a c_0^2}{2} \\right] = \\left(\\frac{\\omega}{c_0} + \\frac{a^2 c_0^3 \\omega}{8}\\right) - i\\left(\\frac{a c_0 \\omega}{2}\\right) $$\nFrom this approximation, we identify the real and imaginary parts of $k(\\omega)$:\n$$ \\mathrm{Re}\\{k(\\omega)\\} \\approx \\frac{\\omega}{c_0} + \\frac{a^2 c_0^3 \\omega}{8} $$\n$$ \\mathrm{Im}\\{k(\\omega)\\} \\approx -\\frac{a c_0 \\omega}{2} $$\nNote that $\\mathrm{Im}\\{k(\\omega)\\}$ is negative, which correctly corresponds to attenuation for the $e^{i(\\omega t - kx)}$ convention.\n\nNow we can compute the requested quantities to first order in $a$.\n\n**1. Attenuation Coefficient $\\alpha(\\omega)$**\nThe attenuation coefficient is defined by $\\alpha(\\omega) = -\\mathrm{Im}\\{k(\\omega)\\}$.\n$$ \\alpha(\\omega) = -\\mathrm{Im}\\{k(\\omega)\\} \\approx -\\left(-\\frac{a c_0 \\omega}{2}\\right) = \\frac{a c_0 \\omega}{2} $$\nThis expression is first-order in $a$.\n\n**2. Phase Velocity $c_p(\\omega)$**\nBy definition, $c_p(\\omega) = \\frac{\\omega}{\\mathrm{Re}\\{k(\\omega)\\}}$.\n$$ c_p(\\omega) \\approx \\frac{\\omega}{\\frac{\\omega}{c_0} + \\frac{a^2 c_0^3 \\omega}{8}} = \\frac{1}{\\frac{1}{c_0} + \\frac{a^2 c_0^3}{8}} = \\frac{c_0}{1 + \\frac{a^2 c_0^4}{8}} $$\nUsing the approximation $(1+x)^{-1} \\approx 1-x$ for small $x$:\n$$ c_p(\\omega) \\approx c_0 \\left(1 - \\frac{a^2 c_0^4}{8}\\right) = c_0 - \\frac{a^2 c_0^5}{8} $$\nThe correction term is proportional to $a^2$. Therefore, to first order in $a$, the phase velocity is simply:\n$$ c_p(\\omega) = c_0 $$\n\n**3. Group Velocity $c_g(\\omega)$**\nBy definition, $c_g(\\omega) = \\left(\\frac{d\\,\\mathrm{Re}\\{k(\\omega)\\}}{d\\omega}\\right)^{-1}$. First, we compute the derivative of $\\mathrm{Re}\\{k(\\omega)\\}$:\n$$ \\frac{d}{d\\omega}\\mathrm{Re}\\{k(\\omega)\\} \\approx \\frac{d}{d\\omega} \\left(\\frac{\\omega}{c_0} + \\frac{a^2 c_0^3 \\omega}{8}\\right) = \\frac{1}{c_0} + \\frac{a^2 c_0^3}{8} $$\nNow, we take the inverse:\n$$ c_g(\\omega) \\approx \\left(\\frac{1}{c_0} + \\frac{a^2 c_0^3}{8}\\right)^{-1} = \\frac{c_0}{1 + \\frac{a^2 c_0^4}{8}} \\approx c_0 - \\frac{a^2 c_0^5}{8} $$\nSimilar to the phase velocity, the correction is of order $a^2$. To first order in $a$, the group velocity is:\n$$ c_g(\\omega) = c_0 $$\n\n**Physical Interpretation**\n- The attenuation coefficient, $\\alpha(\\omega) = \\frac{a c_0 \\omega}{2}$, is proportional to frequency. This implies that higher-frequency components of a wave are attenuated more rapidly.\n- To first order in the loss parameter $a$, both phase and group velocities are constant and equal to $c_0$. This means the medium is non-dispersive at this level of approximation. Any velocity dispersion is a higher-order effect, proportional to $a^2$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nc_0  c_0  \\frac{a c_0 \\omega}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Translating continuous physical models into discrete numerical simulations is a core task in computational acoustics, but one fraught with potential pitfalls. This final practice addresses a critical challenge: ensuring the numerical method respects the physical law of energy dissipation, or \"passivity.\" Through a combination of theoretical analysis and coding, you will diagnose how a simple time-stepping scheme can introduce unphysical energy gain and demonstrate how a more robust method preserves the correct physical behavior, a crucial lesson for building stable and reliable simulations .",
            "id": "4120334",
            "problem": "Consider a one-dimensional, small-amplitude, monochromatic plane acoustic wave in a uniform lossy fluid, modeled at a fixed spatial location by a scalar amplitude envelope $A(t)$ governed by an effective attenuation rate that depends on angular frequency $\\omega$. Assume the medium’s attenuation follows a thermoviscous-like law $\\alpha(\\omega) = a_0 + a_2 \\,\\omega^2$, with $a_0$ and $a_2$ as real constants, and $\\omega \\ge 0$. The continuous-time evolution of the amplitude is described by the first-order linear ordinary differential equation\n$$\n\\frac{dA(t)}{dt} = -\\alpha(\\omega) \\, A(t).\n$$\nThis equation is consistent with linear acoustics and energy dissipation: a passive medium has $\\alpha(\\omega) \\ge 0$ for all $\\omega$, ensuring non-increasing amplitude.\n\nYour task is to diagnose a non-passive numerical time-integration model that exhibits gain (amplitude growth) at certain frequencies when discretized naively, identify whether the violation is due to an unphysical parameter choice or due to an unstable discretization, and correct the scheme to restore stability and passivity. Specifically:\n\n- Starting only from the continuous-time model above and fundamental principles, derive the discrete-time amplification factors for:\n  - A first-order explicit forward Euler time-stepping method with time step $\\Delta t$.\n  - A trapezoidal rule (Crank–Nicolson) time-stepping method with the same $\\Delta t$.\n- Based on the derived amplification factors and the definition of passivity, provide conditions under which the explicit method becomes non-passive (i.e., exhibits $|r(\\omega)|  1$ at some $\\omega$), and show that the trapezoidal method is passive for any $\\Delta t$ whenever the medium is passive (i.e., $\\alpha(\\omega) \\ge 0$ for all $\\omega$).\n\nFor computational diagnosis, implement a program that:\n- Constructs a uniform frequency grid $\\{\\omega_k\\}_{k=0}^{N_\\omega-1}$ over $[0,\\omega_{\\max}]$ with $N_\\omega$ points.\n- For each test case, evaluates $\\alpha(\\omega_k)$ and the discrete amplification factor $r(\\omega_k)$ for both the explicit forward Euler and the trapezoidal rule.\n- Diagnoses the cause of non-passivity for the explicit method using the following classification codes:\n  - Code $0$: No violation detected; $|r(\\omega_k)| \\le 1$ for all $k$ and $\\alpha(\\omega_k) \\ge 0$ for all $k$.\n  - Code $1$: Violation due to too-large time step with otherwise physically admissible parameters; i.e., $\\alpha(\\omega_k) \\ge 0$ for all $k$, but there exists some $k$ with $|r(\\omega_k)|  1$.\n  - Code $2$: Violation due to unphysical attenuation (negative $\\alpha(\\omega)$ at some frequency); i.e., there exists some $k$ with $\\alpha(\\omega_k)  0$ (regardless of time step).\n- Tests passivity of the corrected trapezoidal method by reporting whether $|r(\\omega_k)| \\le 1$ for all $k$.\n\nUse the following test suite to ensure coverage of different scenarios. In each case, use a uniform grid with $N_\\omega = 1025$ points over $[0,\\omega_{\\max}]$ and report results aggregated over the entire grid:\n- Case $1$ (general happy path): $a_0 = 0.5$, $a_2 = 10^{-6}$, $\\Delta t = 0.01$, $\\omega_{\\max} = 10^4$.\n- Case $2$ (boundary condition): $a_0 = 0.5$, $a_2 = 10^{-6}$, $\\Delta t = \\dfrac{2}{a_0 + a_2 \\,\\omega_{\\max}^2}$, $\\omega_{\\max} = 10^4$.\n- Case $3$ (time-step induced non-passivity): $a_0 = 0.5$, $a_2 = 10^{-6}$, $\\Delta t = 0.05$, $\\omega_{\\max} = 10^4$.\n- Case $4$ (parameter-induced non-passivity): $a_0 = 0.2$, $a_2 = -10^{-6}$, $\\Delta t = 0.01$, $\\omega_{\\max} = 10^4$.\n\nAll quantities are dimensionless for the purpose of this exercise, and the angular frequency $\\omega$ is in radians per unit time. The passivity check uses the criterion $|r(\\omega_k)| \\le 1$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output the explicit-method violation code followed by a boolean indicating whether the trapezoidal method is passive for all frequencies. The final output should therefore have $8$ entries in total corresponding to $4$ cases, in the order:\n$$\n[\\text{code}_1,\\text{passive}_1,\\text{code}_2,\\text{passive}_2,\\text{code}_3,\\text{passive}_3,\\text{code}_4,\\text{passive}_4].\n$$",
            "solution": "The problem requires an analysis of the numerical stability and passivity of two time-integration schemes applied to the ordinary differential equation governing acoustic amplitude decay in a lossy medium. The governing equation is:\n$$\n\\frac{dA(t)}{dt} = -\\alpha(\\omega) \\, A(t)\n$$\nwhere $A(t)$ is the scalar amplitude envelope at a fixed spatial location, $\\omega$ is the angular frequency, and $\\alpha(\\omega)$ is the frequency-dependent attenuation rate. The medium is defined as passive if $\\alpha(\\omega) \\ge 0$ for all physical frequencies $\\omega \\ge 0$. A numerical method is considered passive if its discrete amplification factor $r(\\omega)$ has a magnitude $|r(\\omega)| \\le 1$ whenever the physical medium is passive. A violation of passivity, where $|r(\\omega)|  1$, leads to unphysical amplitude growth. We will derive the amplification factors for the forward Euler and trapezoidal methods and establish the conditions for passivity.\n\nLet $A_n \\approx A(t_n)$ be the numerical approximation of the amplitude at discrete time $t_n = n \\Delta t$, where $\\Delta t$ is the time step. The evolution from one time step to the next is described by $A_{n+1} = r(\\omega) A_n$, where $r(\\omega)$ is the numerical amplification factor.\n\n**1. Explicit Forward Euler Method**\n\nThe first-order explicit forward Euler method approximates the time derivative as a forward difference:\n$$\n\\frac{A_{n+1} - A_n}{\\Delta t} = -\\alpha(\\omega) A_n\n$$\nSolving for $A_{n+1}$ yields the update rule:\n$$\nA_{n+1} = A_n - \\alpha(\\omega) \\Delta t \\, A_n = (1 - \\alpha(\\omega) \\Delta t) A_n\n$$\nFrom this, we identify the amplification factor for the forward Euler method, $r_{FE}(\\omega)$, as:\n$$\nr_{FE}(\\omega) = 1 - \\alpha(\\omega) \\Delta t\n$$\nFor the numerical scheme to be passive (i.e., non-amplifying), the magnitude of the amplification factor must not exceed $1$:\n$$\n|r_{FE}(\\omega)| \\le 1 \\implies |1 - \\alpha(\\omega) \\Delta t| \\le 1\n$$\nThis inequality is equivalent to the two conditions:\n$$\n-1 \\le 1 - \\alpha(\\omega) \\Delta t \\le 1\n$$\nLet us analyze each inequality separately.\nFirst, $1 - \\alpha(\\omega) \\Delta t \\le 1$ implies $-\\alpha(\\omega) \\Delta t \\le 0$. Since $\\Delta t  0$, this is equivalent to $\\alpha(\\omega) \\ge 0$. This condition corresponds to the physical passivity of the medium itself. If the medium is not passive ($\\alpha(\\omega)  0$), the numerical method will also exhibit gain, as expected.\n\nSecond, $-1 \\le 1 - \\alpha(\\omega) \\Delta t$ implies $\\alpha(\\omega) \\Delta t \\le 2$.\n\nCombining these, the forward Euler method is stable and passive if and only if:\n$$\n0 \\le \\alpha(\\omega) \\Delta t \\le 2\n$$\nA violation of passivity ($|r_{FE}(\\omega)|  1$) can therefore occur for two distinct reasons:\n- **Unphysical Parameters:** The medium itself is active, meaning $\\alpha(\\omega)  0$ for some $\\omega$. This violates the first part of the stability condition. This corresponds to a **Code 2** violation.\n- **Numerical Instability:** The medium is passive ($\\alpha(\\omega) \\ge 0$ for all $\\omega$), but the time step $\\Delta t$ is too large, causing $\\alpha(\\omega) \\Delta t  2$ for some $\\omega$. This is a purely numerical artifact. This corresponds to a **Code 1** violation.\nIf neither condition is met for any frequency on the grid, no violation is detected, corresponding to **Code 0**.\n\n**2. Trapezoidal Rule (Crank-Nicolson Method)**\n\nThe trapezoidal rule is an implicit method that approximates the right-hand side of the ODE by averaging its value at time steps $n$ and $n+1$:\n$$\n\\frac{A_{n+1} - A_n}{\\Delta t} = -\\alpha(\\omega) \\frac{A_n + A_{n+1}}{2}\n$$\nTo find the amplification factor, we must solve for $A_{n+1}$:\n$$\nA_{n+1} - A_n = -\\frac{\\alpha(\\omega) \\Delta t}{2} (A_n + A_{n+1})\n$$\n$$\nA_{n+1} \\left(1 + \\frac{\\alpha(\\omega) \\Delta t}{2}\\right) = A_n \\left(1 - \\frac{\\alpha(\\omega) \\Delta t}{2}\\right)\n$$\n$$\nA_{n+1} = \\left( \\frac{1 - \\frac{1}{2}\\alpha(\\omega) \\Delta t}{1 + \\frac{1}{2}\\alpha(\\omega) \\Delta t} \\right) A_n\n$$\nThe amplification factor for the trapezoidal method, $r_{CN}(\\omega)$, is thus:\n$$\nr_{CN}(\\omega) = \\frac{1 - \\frac{1}{2}\\alpha(\\omega) \\Delta t}{1 + \\frac{1}{2}\\alpha(\\omega) \\Delta t}\n$$\nNow, we analyze its passivity. We assume a physically passive medium, so $\\alpha(\\omega) \\ge 0$ for all $\\omega$. Let $x = \\frac{1}{2}\\alpha(\\omega) \\Delta t$. Since $\\alpha(\\omega) \\ge 0$ and $\\Delta t  0$, we have $x \\ge 0$. The amplification factor is $r(x) = \\frac{1-x}{1+x}$. We must show that $|r(x)| \\le 1$ for all $x \\ge 0$.\nThe magnitude is:\n$$\n|r(x)| = \\left| \\frac{1-x}{1+x} \\right| = \\frac{|1-x|}{1+x}\n$$\nsince $x \\ge 0$ implies $1+x  0$.\n- If $0 \\le x \\le 1$, then $|1-x| = 1-x$. The inequality $|r(x)| \\le 1$ becomes $\\frac{1-x}{1+x} \\le 1$. Since $1+x  0$, this is equivalent to $1-x \\le 1+x$, which simplifies to $-x \\le x$, or $0 \\le 2x$. This is true for all $x \\ge 0$.\n- If $x  1$, then $|1-x| = -(1-x) = x-1$. The inequality $|r(x)| \\le 1$ becomes $\\frac{x-1}{x+1} \\le 1$. This is equivalent to $x-1 \\le x+1$, which simplifies to $-1 \\le 1$. This is always true.\n\nTherefore, for any $x \\ge 0$, we have $|r(x)| \\le 1$. This demonstrates that if the medium is passive ($\\alpha(\\omega) \\ge 0$), the trapezoidal method is unconditionally passive for any choice of time step $\\Delta t  0$. This property is known as A-stability. However, if the medium itself is not passive (i.e., $\\alpha(\\omega)  0$ for some $\\omega$), the quantity $x$ can be negative. If $x  0$, let $x = -y$ for $y  0$. Then $r(-y) = \\frac{1+y}{1-y}$. If $0  y  1$, then $|r(-y)|  1$, meaning the trapezoidal scheme will also exhibit gain, correctly reflecting the active nature of the underlying (unphysical) model.\n\nThe computational implementation will follow this derived logic.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing numerical schemes for acoustic attenuation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a0, a2, dt, omega_max)\n    # Case 2's dt is calculated dynamically.\n    omega_max_val = 1e4\n    a0_case2, a2_case2 = 0.5, 1e-6\n    dt_case2 = 2.0 / (a0_case2 + a2_case2 * omega_max_val**2)\n\n    test_cases = [\n        # Case 1 (general happy path)\n        (0.5, 1e-6, 0.01, omega_max_val),\n        # Case 2 (boundary condition)\n        (a0_case2, a2_case2, dt_case2, omega_max_val),\n        # Case 3 (time-step induced non-passivity)\n        (0.5, 1e-6, 0.05, omega_max_val),\n        # Case 4 (parameter-induced non-passivity)\n        (0.2, -1e-6, 0.01, omega_max_val),\n    ]\n\n    # Global parameters for the frequency grid\n    N_omega = 1025\n\n    results = []\n    for case in test_cases:\n        a0, a2, dt, omega_max = case\n\n        # 1. Construct the frequency grid and evaluate attenuation\n        omega_k = np.linspace(0, omega_max, N_omega)\n        alpha_k = a0 + a2 * omega_k**2\n\n        # 2. Diagnose the explicit forward Euler method\n        explicit_code = 0  # Default: No violation\n        if np.any(alpha_k  0):\n            # Violation due to unphysical attenuation\n            explicit_code = 2\n        else:\n            # Physical parameters, check for numerical instability\n            r_fe = 1.0 - alpha_k * dt\n            # Using a tolerance of 1e-12 for floating point comparisons\n            if np.any(np.abs(r_fe) > 1.0 + 1e-12):\n                explicit_code = 1\n        \n        results.append(explicit_code)\n\n        # 3. Test the passivity of the trapezoidal (Crank-Nicolson) method\n        # The denominator can be zero or close to zero if alpha_k is negative.\n        # We handle this to avoid division by zero errors.\n        denominator = 1.0 + 0.5 * alpha_k * dt\n        # If denominator is zero, amplification is infinite.\n        denominator[np.abs(denominator)  1e-16] = 1e-16 \n        \n        r_cn = (1.0 - 0.5 * alpha_k * dt) / denominator\n        \n        # Check if the magnitude of the amplification factor is = 1 for all frequencies\n        is_cn_passive = np.all(np.abs(r_cn) = 1.0 + 1e-12)\n        results.append(is_cn_passive)\n\n    # 4. Final print statement in the exact required format.\n    # The boolean values are converted to string representation 'True' or 'False'\n    # which is then converted to lowercase by Python's str() on a bool. We\n    # need to ensure it matches the desired output if any.\n    # The problem asks for boolean, so Python's default str(bool) is fine.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}