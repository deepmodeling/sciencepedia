{
    "hands_on_practices": [
        {
            "introduction": "声音在空气等真实流体中传播时，能量会因粘滞效应和热传导而耗散。本练习旨在将理论与实际相结合，通过计算声波在空气中衰减时，剪切粘滞和热传导各自的贡献，来加深对经典衰减模型物理内涵的理解。这个过程有助于我们量化分析不同物理机制在声耗散过程中的相对重要性。",
            "id": "4120336",
            "problem": "考虑一个角频率为 $\\omega$ 的平面一维时谐声波，在标准状况下的静止空气中传播。将空气建模为牛顿理想气体，其剪切黏度为 $\\eta$，体积黏度为 $\\zeta$，热导率为 $k$，定压比热容为 $c_p$，比热容比为 $\\gamma$，环境质量密度为 $\\rho_0$。假设在小振幅极限下为线性声学，并忽略分子弛豫过程，因此耗散仅由进入线性化可压缩Navier-Stokes方程和包含傅里叶热传导定律的线性化能量方程的剪切黏度和热传导引起。\n\n从线性化连续性方程、包含黏性应力的线性化动量方程、线性化能量方程以及理想气体状态方程出发，推导平面波在小耗散情况下的主阶色散关系，并从中识别由剪切黏度和热传导引起的衰减贡献。使用空气在 $T_0 = 293.15\\,\\mathrm{K}$ 时的材料参数：\n- $\\rho_0 = 1.204\\,\\mathrm{kg/m^3}$，\n- $\\eta = 1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$，\n- $\\zeta = 0\\,\\mathrm{Pa\\cdot s}$，\n- $k = 2.57 \\times 10^{-2}\\,\\mathrm{W/(m\\cdot K)}$，\n- $c_p = 1.006 \\times 10^{3}\\,\\mathrm{J/(kg\\cdot K)}$，\n- $\\gamma = 1.4$，\n\n并在频率 $f = 10\\,\\mathrm{kHz}$ (其中 $\\omega = 2\\pi f$) 的条件下，计算剪切黏度和热传导对衰减的相对贡献，其定义为无量纲分数\n$$\n\\phi_{\\mathrm{shear}} = \\frac{\\alpha_{\\mathrm{shear}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}}\n\\quad\\text{and}\\quad\n\\phi_{\\mathrm{thermal}} = \\frac{\\alpha_{\\mathrm{thermal}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}},\n$$\n其中 $\\alpha_{\\mathrm{shear}}$ 和 $\\alpha_{\\mathrm{thermal}}$ 分别表示在您推导的主阶色散关系中，可归因于剪切黏度和热传导的衰减贡献。使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境，将最终答案表示为包含两个无量纲数的单行矩阵，并将每个数字四舍五入到四位有效数字。",
            "solution": "该问题要求推导在黏性导热气体中声波的小耗散主阶色散关系，并随后计算剪切黏度和热传导对波衰减的相对贡献。\n\n分析从流体运动的线性化控制方程开始，这些方程包括质量守恒（连续性）方程、动量（Navier-Stokes）方程和能量守恒方程，并辅以理想气体状态方程。对于沿 $x$ 方向传播的一维平面波，这些方程为：\n\n$1$. **线性化连续性方程**：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n\n$2$. **线性化动量方程**：\n$$\n\\rho_0 \\frac{\\partial u'}{\\partial t} = -\\frac{\\partial p'}{\\partial x} + \\left(\\zeta + \\frac{4}{3}\\eta\\right) \\frac{\\partial^2 u'}{\\partial x^2}\n$$\n\n$3$. **线性化能量方程**：\n$$\n\\rho_0 c_p \\frac{\\partial T'}{\\partial t} - \\frac{\\partial p'}{\\partial t} = k \\frac{\\partial^2 T'}{\\partial x^2}\n$$\n\n$4$. **线性化理想气体状态方程**：\n$$\n\\frac{p'}{p_0} = \\frac{\\rho'}{\\rho_0} + \\frac{T'}{T_0}\n$$\n\n此处，$\\rho'$, $p'$, $u'$, 和 $T'$ 分别是密度、压力、速度和温度的声学小扰动量。环境量为密度 $\\rho_0$、压力 $p_0$ 和温度 $T_0$。材料属性为剪切黏度 $\\eta$、体积黏度 $\\zeta$、热导率 $k$、定压比热容 $c_p$ 和比热容比 $\\gamma$。\n\n我们假设时谐平面波解的形式为 $q'(x,t) = \\hat{q} \\exp(i(Kx - \\omega t))$，其中 $q'$ 代表任意一个扰动场变量，$\\hat{q}$ 是其复振幅，$\\omega$ 是角频率，而 $K$ 是复波数。导数变换为 $\\frac{\\partial}{\\partial t} \\to -i\\omega$ 和 $\\frac{\\partial}{\\partial x} \\to iK$。将此应用于控制方程，得到一个关于振幅的代数方程组：\n\n$1$. (连续性方程) $-i\\omega \\hat{\\rho} + \\rho_0 (iK) \\hat{u} = 0 \\implies \\omega \\hat{\\rho} = \\rho_0 K \\hat{u}$\n$2$. (动量方程) $\\rho_0(-i\\omega)\\hat{u} = -iK\\hat{p} + (\\zeta + \\frac{4}{3}\\eta)(iK)^2\\hat{u} \\implies \\left[ \\omega\\rho_0 + iK^2\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\hat{u} = K\\hat{p}$\n$3$. (能量方程) $\\rho_0 c_p(-i\\omega)\\hat{T} - (-i\\omega)\\hat{p} = k(iK)^2\\hat{T} \\implies \\omega\\hat{p} = (\\omega\\rho_0 c_p + ik^2 k)\\hat{T}$\n$4$. (状态方程) $\\frac{\\hat{p}}{p_0} = \\frac{\\hat{\\rho}}{\\rho_0} + \\frac{\\hat{T}}{T_0}$\n\n从前两个方程，我们可以建立 $\\hat{p}$ 和 $\\hat{\\rho}$ 之间的关系：\n由(1)式，$\\hat{u} = \\frac{\\omega}{\\rho_0 K}\\hat{\\rho}$。将其代入(2)式：\n$$\n\\left[ \\omega\\rho_0 + iK^2\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\left(\\frac{\\omega}{\\rho_0 K}\\hat{\\rho}\\right) = K\\hat{p}\n$$\n$$\n\\implies \\left[ \\omega^2 + \\frac{i\\omega K^2}{\\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right]\\hat{\\rho} = K^2\\hat{p} \\quad (\\mathrm{Eq. A})\n$$\n从第三和第四个方程，我们推导 $\\hat{p}$ 和 $\\hat{\\rho}$ 之间的第二个关系：\n由(3)式，$\\hat{T} = \\frac{\\omega\\hat{p}}{\\omega\\rho_0 c_p + iK^2 k}$。将其代入(4)式：\n$$\n\\frac{\\hat{\\rho}}{\\rho_0} = \\frac{\\hat{p}}{p_0} - \\frac{\\hat{T}}{T_0} = \\frac{\\hat{p}}{p_0} - \\frac{1}{T_0}\\left(\\frac{\\omega\\hat{p}}{\\omega\\rho_0 c_p + iK^2 k}\\right)\n$$\n使用理想气体关系式 $p_0 = \\rho_0 R T_0$、$c_0^2 = \\gamma R T_0 = \\gamma p_0/\\rho_0$ 以及 $R=c_p-c_v=c_p(1-1/\\gamma)$，我们可以写出 $\\frac{1}{T_0} = \\frac{\\rho_0 R}{p_0} = \\frac{\\rho_0 c_p(\\gamma-1)}{\\gamma p_0}$。\n$$\n\\frac{\\hat{\\rho}}{\\rho_0} = \\frac{\\hat{p}}{p_0}\\left[ 1 - \\frac{\\rho_0 c_p(\\gamma-1)}{\\gamma} \\frac{\\omega}{\\omega\\rho_0 c_p + iK^2 k} \\right] = \\frac{\\hat{p}}{\\gamma p_0}\\left[ \\gamma - \\frac{\\omega \\rho_0 c_p (\\gamma-1)}{\\omega\\rho_0 c_p + iK^2 k} \\right]\n$$\n$$\n\\frac{\\hat{\\rho}}{\\hat{p}} = \\frac{1}{c_0^2} \\left[ \\frac{\\gamma(\\omega\\rho_0 c_p + iK^2 k) - \\omega \\rho_0 c_p (\\gamma-1)}{\\omega\\rho_0 c_p + iK^2 k} \\right] = \\frac{1}{c_0^2}\\left[ \\frac{\\omega\\rho_0 c_p + i\\gamma K^2 k}{\\omega\\rho_0 c_p + iK^2 k} \\right] \\quad (\\mathrm{Eq. B})\n$$\n结合(A)和(B)得到精确的色散关系。对于小耗散情况（$\\eta, k, \\zeta$ 很小），波数 $K$ 接近理想值 $k_0 = \\omega/c_0$。我们在小的耗散项中近似 $K^2 \\approx k_0^2 = \\omega^2/c_0^2$。\n从(B)式出发，对小 $k$ 进行展开：\n$$\n\\frac{\\hat{\\rho}}{\\hat{p}} \\approx \\frac{1}{c_0^2}\\left(1 + \\frac{i\\gamma K^2 k}{\\omega\\rho_0 c_p}\\right)\\left(1 - \\frac{iK^2 k}{\\omega\\rho_0 c_p}\\right)^{-1} \\approx \\frac{1}{c_0^2}\\left(1 + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p}\\right)\n$$\n将此代入(A)式：\n$$\n\\left[ \\omega^2 + \\frac{i\\omega K^2}{\\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) \\right] \\frac{1}{c_0^2}\\left(1 + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p}\\right) = K^2\n$$\n$$\n\\frac{\\omega^2}{c_0^2} \\left[ 1 + \\frac{i\\omega K^2}{\\omega^2 \\rho_0}\\left(\\zeta + \\frac{4}{3}\\eta\\right) + \\frac{i(\\gamma-1)K^2 k}{\\omega\\rho_0 c_p} \\right] \\approx K^2\n$$\n解出 $K^2$ 并在右侧近似 $K^2 \\approx \\omega^2/c_0^2$：\n$$\nK^2 \\approx \\frac{\\omega^2}{c_0^2} \\left[ 1 - \\frac{i\\omega}{\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]^{-1}\n$$\n对于小的 $x$，使用二项式展开 $(1-x)^{-1} \\approx 1+x$：\n$$\nK^2 \\approx \\frac{\\omega^2}{c_0^2} \\left[ 1 + \\frac{i\\omega}{\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]\n$$\n取平方根，并对小的 $y$ 使用 $(1+y)^{1/2} \\approx 1+y/2$：\n$$\nK \\approx \\frac{\\omega}{c_0} \\left[ 1 + \\frac{i\\omega}{2\\rho_0 c_0^2}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right) \\right]\n$$\n这就是所要求的主阶小耗散色散关系。复波数为 $K = k_r + i\\alpha$，其中 $k_r$ 是实波数，$\\alpha$ 是衰减系数。波的传播形式为 $\\exp(i(k_r x-\\omega t) - \\alpha x)$。\n$$\nk_r = \\mathrm{Re}(K) \\approx \\frac{\\omega}{c_0}\n$$\n$$\n\\alpha = \\mathrm{Im}(K) \\approx \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\zeta + \\frac{4}{3}\\eta + \\frac{(\\gamma-1)k}{c_p}\\right)\n$$\n问题指明耗散来源于剪切黏度和热传导，并给出了 $\\zeta=0$。总衰减 $\\alpha$ 是剪切黏度贡献 $\\alpha_{\\mathrm{shear}}$ 和热传导贡献 $\\alpha_{\\mathrm{thermal}}$ 之和：\n$$\n\\alpha_{\\mathrm{shear}} = \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\frac{4}{3}\\eta\\right)\n$$\n$$\n\\alpha_{\\mathrm{thermal}} = \\frac{\\omega^2}{2\\rho_0 c_0^3}\\left(\\frac{(\\gamma-1)k}{c_p}\\right)\n$$\n相对贡献定义为：\n$$\n\\phi_{\\mathrm{shear}} = \\frac{\\alpha_{\\mathrm{shear}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}} \\quad\\text{and}\\quad \\phi_{\\mathrm{thermal}} = \\frac{\\alpha_{\\mathrm{thermal}}}{\\alpha_{\\mathrm{shear}} + \\alpha_{\\mathrm{thermal}}}\n$$\n公共因子 $\\frac{\\omega^2}{2\\rho_0 c_0^3}$ 在这些比率中被消去。我们只需要比较 $S = \\frac{4}{3}\\eta$ 和 $T = \\frac{(\\gamma-1)k}{c_p}$ 这两项。\n$$\n\\phi_{\\mathrm{shear}} = \\frac{S}{S+T} \\quad\\text{and}\\quad \\phi_{\\mathrm{thermal}} = \\frac{T}{S+T}\n$$\n使用所提供的空气材料参数：\n$\\eta = 1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n$k = 2.57 \\times 10^{-2}\\,\\mathrm{W/(m\\cdot K)}$\n$c_p = 1.006 \\times 10^{3}\\,\\mathrm{J/(kg\\cdot K)}$\n$\\gamma = 1.4$\n$\\zeta = 0$\n\n我们计算 $S$ 和 $T$ 两项：\n$$\nS = \\frac{4}{3}\\eta = \\frac{4}{3}(1.81 \\times 10^{-5}) \\approx 2.41333 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}\n$$\n$$\nT = \\frac{(\\gamma-1)k}{c_p} = \\frac{(1.4 - 1)(2.57 \\times 10^{-2})}{1.006 \\times 10^{3}} = \\frac{0.4 \\times 2.57 \\times 10^{-2}}{1006} \\approx 1.02187 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}\n$$\n两者之和为 $S+T \\approx (2.41333 + 1.02187) \\times 10^{-5} = 3.43520 \\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}$。\n\n现在我们计算无量纲分数：\n$$\n\\phi_{\\mathrm{shear}} = \\frac{2.41333 \\times 10^{-5}}{3.43520 \\times 10^{-5}} \\approx 0.702529\n$$\n$$\n\\phi_{\\mathrm{thermal}} = \\frac{1.02187 \\times 10^{-5}}{3.43520 \\times 10^{-5}} \\approx 0.297471\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\phi_{\\mathrm{shear}} = 0.7025\n$$\n$$\n\\phi_{\\mathrm{thermal}} = 0.2975\n$$\n这些值表示在指定条件下，剪切黏度和热传导对空气中声音总经典衰减的分数贡献。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7025  0.2975\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "介质的色散关系 $k(\\omega)$ 是声波传播理论的核心，它将波的衰减与相速度、群速度等关键特性联系在一起。本练习提供了一个典型的弱耗散介质模型，要求你运用数学分析方法，从复数波数中提取出这些物理量。这不仅能锻炼你的解析能力，还能让你深入理解耗散与色散之间的微妙关系。",
            "id": "4120341",
            "problem": "考虑一个支持小振幅平面波的一维、均匀、各向同性、弱耗散声学介质。设声压场模型为 $p(x,t) = \\Re\\{p_0 \\exp(i(k(\\omega) x - \\omega t))\\}$，其中 $\\omega$ 是角频率，$k(\\omega)$ 是复波数，$\\Re\\{\\cdot\\}$ 表示取实部。假设介质的色散关系由线性化的动量方程和连续性方程以及导致频域关系的本构响应所决定\n$$\nk(\\omega) = \\sqrt{\\frac{\\omega^{2}}{c_{0}^{2}} + i\\, a\\, \\omega^{2}},\n$$\n其中 $c_{0}  0$ 是相应无损介质的参考声速，$a$ 是一个小的正常数，其量纲使得 $a\\,\\omega^{2}$ 与 $k^{2}$ 的量纲相同。取平方根的主支，使得 $\\Re(k(\\omega))  0$。对于窄带波包，定义相速度 $c_{p}(\\omega)$ 和群速度 $c_{g}(\\omega)$ 为\n$$\nc_{p}(\\omega) = \\frac{\\omega}{\\Re\\{k(\\omega)\\}}, \\qquad c_{g}(\\omega) = \\left(\\frac{d\\,\\Re\\{k(\\omega)\\}}{d\\omega}\\right)^{-1},\n$$\n并通过空间振幅衰减 $\\exp(-\\alpha(\\omega)\\, x)$ 定义衰减系数 $\\alpha(\\omega)$，即 $\\alpha(\\omega) = \\Im\\{k(\\omega)\\}$，其中 $\\Im\\{\\cdot\\}$ 表示取虚部。在小参数 $a$ 的一阶近似下，计算 $c_{p}(\\omega)$、$c_{g}(\\omega)$ 和 $\\alpha(\\omega)$ 作为 $\\omega$ 的函数表达式，并简要解释结果的物理含义。以闭合形式给出最终表达式，无需进行数值计算。无需四舍五入。最终表达式中不要包含单位。",
            "solution": "### 求解推导\n\n分析从给定的复波数 $k(\\omega)$ 的色散关系开始：\n$$\nk(\\omega) = \\sqrt{\\frac{\\omega^{2}}{c_{0}^{2}} + i\\, a\\, \\omega^{2}}\n$$\n假设 $\\omega > 0$，我们可以提出无损项 $\\frac{\\omega}{c_0}$：\n$$\nk(\\omega) = \\frac{\\omega}{c_0} \\sqrt{1 + i a c_0^2}\n$$\n问题指出 $a$ 是一个小的正常数。从平方根下各项的量纲一致性可以推断，量 $a c_0^2$ 也是一个小的无量纲量。我们定义一个小的无量纲参数 $\\epsilon = a c_0^2$。$k(\\omega)$ 的表达式变为：\n$$\nk(\\omega) = \\frac{\\omega}{c_0} \\sqrt{1 + i\\epsilon}\n$$\n为了继续，我们需要通过对小 $\\epsilon$ 展开 $\\sqrt{1 + i\\epsilon}$ 项来求得 $k(\\omega)$ 的实部和虚部。我们使用函数 $f(z) = (1+z)^{1/2}$ 在 $z=0$ 附近的泰勒级数展开。展开到二阶：\n$$\nf(z) \\approx f(0) + f'(0)z + \\frac{f''(0)}{2}z^2\n$$\n其中 $f(0)=1$, $f'(z) = \\frac{1}{2}(1+z)^{-1/2} \\implies f'(0) = \\frac{1}{2}$, 且 $f''(z) = -\\frac{1}{4}(1+z)^{-3/2} \\implies f''(0) = -\\frac{1}{4}$。\n代入 $z=i\\epsilon$：\n$$\n\\sqrt{1+i\\epsilon} \\approx 1 + \\frac{1}{2}(i\\epsilon) + \\frac{1}{2}\\left(-\\frac{1}{4}\\right)(i\\epsilon)^2 = 1 + i\\frac{\\epsilon}{2} - \\frac{1}{8}(i^2\\epsilon^2) = 1 + \\frac{\\epsilon^2}{8} + i\\frac{\\epsilon}{2}\n$$\n该展开式表明，实部在 $\\epsilon^2$ 阶有修正，而虚部是 $\\epsilon$ 阶。代入 $\\epsilon = a c_0^2$：\n$$\n\\sqrt{1 + i a c_0^2} \\approx \\left(1 + \\frac{1}{8}a^2 c_0^4\\right) + i\\left(\\frac{a c_0^2}{2}\\right)\n$$\n现在，将此结果代回 $k(\\omega)$ 的表达式中：\n$$\nk(\\omega) \\approx \\frac{\\omega}{c_0} \\left[ \\left(1 + \\frac{1}{8}a^2 c_0^4\\right) + i\\left(\\frac{a c_0^2}{2}\\right) \\right] = \\left(\\frac{\\omega}{c_0} + \\frac{1}{8}a^2 c_0^3 \\omega\\right) + i\\left(\\frac{a c_0 \\omega}{2}\\right)\n$$\n根据这个近似，我们可以确定 $k(\\omega)$ 的实部和虚部：\n$$\n\\Re\\{k(\\omega)\\} \\approx \\frac{\\omega}{c_0} + \\frac{1}{8}a^2 c_0^3 \\omega\n$$\n$$\n\\Im\\{k(\\omega)\\} \\approx \\frac{a c_0 \\omega}{2}\n$$\n我们现在计算所要求的量，并始终保持到 $a$ 的一阶精度。\n\n**1. 衰减系数 $\\alpha(\\omega)$**\n根据定义，$\\alpha(\\omega) = \\Im\\{k(\\omega)\\}$。使用我们推导的表达式：\n$$\n\\alpha(\\omega) = \\frac{a c_0 \\omega}{2}\n$$\n这个表达式是关于 $a$ 的线性表达式。因此，它是衰减的正确一阶近似。\n\n**2. 相速度 $c_p(\\omega)$**\n根据定义，$c_p(\\omega) = \\frac{\\omega}{\\Re\\{k(\\omega)\\}}$。使用我们对 $\\Re\\{k(\\omega)\\}$ 的表达式：\n$$\nc_p(\\omega) \\approx \\frac{\\omega}{\\frac{\\omega}{c_0} + \\frac{1}{8}a^2 c_0^3 \\omega} = \\frac{1}{\\frac{1}{c_0} + \\frac{1}{8}a^2 c_0^3} = \\frac{c_0}{1 + \\frac{1}{8}a^2 c_0^4}\n$$\n为了求得关于 $a$ 的一阶表达式，我们对小 $a$ 展开这个结果。使用近似 $(1+x)^{-1} \\approx 1-x$（对于小 $x$）：\n$$\nc_p(\\omega) \\approx c_0 \\left(1 - \\frac{1}{8}a^2 c_0^4\\right) = c_0 - \\frac{1}{8}a^2 c_0^5\n$$\n$c_p(\\omega)$ 的这个表达式可以写成关于 $a$ 的级数：$c_p(\\omega) = c_0 + 0 \\cdot a - (\\frac{1}{8}c_0^5) a^2 + \\dots$。对 $a$ 的一阶近似包括了直到 $a$ 的线性幂次的项。由于 $a^1$ 的系数为零，一阶近似就是零阶项：\n$$\nc_p(\\omega) = c_0\n$$\n\n**3. 群速度 $c_g(\\omega)$**\n根据定义，$c_g(\\omega) = \\left(\\frac{d\\,\\Re\\{k(\\omega)\\}}{d\\omega}\\right)^{-1}$。首先，我们计算 $\\Re\\{k(\\omega)\\}$ 对 $\\omega$ 的导数：\n$$\n\\frac{d}{d\\omega}\\Re\\{k(\\omega)\\} \\approx \\frac{d}{d\\omega} \\left(\\frac{\\omega}{c_0} + \\frac{1}{8}a^2 c_0^3 \\omega\\right) = \\frac{1}{c_0} + \\frac{1}{8}a^2 c_0^3\n$$\n现在，我们通过取倒数来计算群速度：\n$$\nc_g(\\omega) \\approx \\left(\\frac{1}{c_0} + \\frac{1}{8}a^2 c_0^3\\right)^{-1} = \\frac{c_0}{1 + \\frac{1}{8}a^2 c_0^4}\n$$\n这与 $c_p(\\omega)$ 的表达式相同。对小 $a$ 展开，我们得到：\n$$\nc_g(\\omega) \\approx c_0 \\left(1 - \\frac{1}{8}a^2 c_0^4\\right) = c_0 - \\frac{1}{8}a^2 c_0^5\n$$\n与相速度类似，$a$ 的一阶项为零。因此，群速度对 $a$ 的一阶近似为：\n$$\nc_g(\\omega) = c_0\n$$\n\n**物理释义**\n这些结果对于该介质中的波传播具有明确的物理含义：\n-   衰减系数 $\\alpha(\\omega) = \\frac{a c_0 \\omega}{2}$ 与角频率 $\\omega$ 成正比。这意味着波的高频分量比低频分量衰减得更快。一个宽带脉冲在该介质中传播时会发生畸变，其高频成分会随距离被滤除。\n-   在耗散参数 $a$ 的一阶近似下，相速度 $c_p(\\omega)$ 和群速度 $c_g(\\omega)$ 都等于常数 $c_0$。这意味着，在此近似水平下，介质是无色散的。波峰的速度和整个波包包络的速度都与频率无关。任何色散效应，即不同频率的波以不同速度传播的现象，都是小参数 $a$ 的二阶或更高阶效应。\n\n这三个量对 $a$ 的一阶近似的最终表达式为：\n$c_p(\\omega) = c_0$\n$c_g(\\omega) = c_0$\n$\\alpha(\\omega) = \\frac{a c_0 \\omega}{2}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nc_0  c_0  \\frac{a c_0 \\omega}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "将连续的物理模型转化为离散的数值算法是计算声学中的关键一步，但这一步充满了挑战。本练习聚焦于一个核心问题：数值稳定性与物理被动性。你将通过分析和实现不同的时间积分方案，亲身体验一个物理上耗散的系统为何在不恰当的数值处理下会产生非物理的能量增益，并学习如何诊断和纠正这类问题。",
            "id": "4120334",
            "problem": "考虑在均匀有损流体中的一维、小振幅、单色平面声波，其在固定空间位置上的模型由一个标量振幅包络 $A(t)$ 描述，该包络受一个依赖于角频率 $\\omega$ 的有效衰减率控制。假设介质的衰减遵循一个类热粘性定律 $\\alpha(\\omega) = a_0 + a_2 \\,\\omega^2$，其中 $a_0$ 和 $a_2$ 为实常数，且 $\\omega \\ge 0$。振幅的连续时间演化由以下一阶线性常微分方程描述\n$$\n\\frac{dA(t)}{dt} = -\\alpha(\\omega) \\, A(t).\n$$\n该方程与线性声学及能量耗散一致：无源介质对于所有 $\\omega$ 都有 $\\alpha(\\omega) \\ge 0$，从而确保振幅不会增加。\n\n您的任务是诊断一个非无源的数值时间积分模型，该模型在朴素离散化时会在某些频率下表现出增益（振幅增长），识别这种违背是由于不符合物理的参数选择还是由于不稳定的离散化所致，并修正该方案以恢复稳定性和无源性。具体来说：\n\n- 仅从上述连续时间模型和基本原理出发，推导以下方法的离散时间放大因子：\n  - 时间步长为 $\\Delta t$ 的一阶显式前向欧拉时间步进法。\n  - 时间步长同样为 $\\Delta t$ 的梯形法则（Crank–Nicolson）时间步进法。\n- 基于推导出的放大因子和无源性的定义，给出显式方法变得非无源（即在某些 $\\omega$ 下表现出 $|r(\\omega)|  1$）的条件，并证明只要介质是无源的（即对所有 $\\omega$ 都有 $\\alpha(\\omega) \\ge 0$），梯形方法对于任何 $\\Delta t$ 都是无源的。\n\n为了进行计算诊断，请实现一个程序，该程序能够：\n- 在 $[0,\\omega_{\\max}]$ 上构建一个包含 $N_\\omega$ 个点的均匀频率网格 $\\{\\omega_k\\}_{k=0}^{N_\\omega-1}$。\n- 对于每个测试用例，评估显式前向欧拉法和梯形法则的 $\\alpha(\\omega_k)$ 以及离散放大因子 $r(\\omega_k)$。\n- 使用以下分类代码诊断显式方法非无源的原因：\n  - 代码 $0$：未检测到违背；对所有 $k$ 都有 $|r(\\omega_k)| \\le 1$ 且对所有 $k$ 都有 $\\alpha(\\omega_k) \\ge 0$。\n  - 代码 $1$：因时间步长过大导致的违背，而参数在其他方面是物理上可接受的；即，对所有 $k$ 都有 $\\alpha(\\omega_k) \\ge 0$，但存在某个 $k$ 使得 $|r(\\omega_k)|  1$。\n  - 代码 $2$：因不符合物理的衰减（在某些频率下 $\\alpha(\\omega)$ 为负）导致的违背；即，存在某个 $k$ 使得 $\\alpha(\\omega_k)  0$（与时间步长无关）。\n- 通过报告是否对所有 $k$ 都有 $|r(\\omega_k)| \\le 1$ 来测试修正后的梯形方法的无源性。\n\n使用以下测试套件以确保覆盖不同场景。在每个案例中，使用在 $[0,\\omega_{\\max}]$ 上的包含 $N_\\omega = 1025$ 个点的均匀网格，并报告在整个网格上聚合的结果：\n- 案例 $1$（一般正常路径）：$a_0 = 0.5$，$a_2 = 10^{-6}$，$\\Delta t = 0.01$，$\\omega_{\\max} = 10^4$。\n- 案例 $2$（边界条件）：$a_0 = 0.5$，$a_2 = 10^{-6}$，$\\Delta t = \\dfrac{2}{a_0 + a_2 \\,\\omega_{\\max}^2}$，$\\omega_{\\max} = 10^4$。\n- 案例 $3$（时间步长引起的非无源性）：$a_0 = 0.5$，$a_2 = 10^{-6}$，$\\Delta t = 0.05$，$\\omega_{\\max} = 10^4$。\n- 案例 $4$（参数引起的非无源性）：$a_0 = 0.2$，$a_2 = -10^{-6}$，$\\Delta t = 0.01$，$\\omega_{\\max} = 10^4$。\n\n就本练习而言，所有量均为无量纲，角频率 $\\omega$ 的单位是弧度/单位时间。无源性检查使用准则 $|r(\\omega_k)| \\le 1$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表。对于每个案例，输出显式方法的违背代码，后跟一个布尔值，该布尔值指示梯形方法是否对所有频率都是无源的。因此，最终输出应总共有 $8$ 个条目，对应 $4$ 个案例，顺序如下：\n$$\n[\\text{code}_1,\\text{passive}_1,\\text{code}_2,\\text{passive}_2,\\text{code}_3,\\text{passive}_3,\\text{code}_4,\\text{passive}_4].\n$$",
            "solution": "该问题要求分析两种时间积分方案在应用于控制有损介质中声振幅衰减的常微分方程时的数值稳定性和无源性。控制方程为：\n$$\n\\frac{dA(t)}{dt} = -\\alpha(\\omega) \\, A(t)\n$$\n其中 $A(t)$ 是固定空间位置处的标量振幅包络，$\\omega$ 是角频率，$\\alpha(\\omega)$ 是频率相关的衰减率。如果对于所有物理频率 $\\omega \\ge 0$ 都有 $\\alpha(\\omega) \\ge 0$，则该介质被定义为无源介质。如果一个数值方法的离散放大因子 $r(\\omega)$ 在物理介质是无源的情况下其大小满足 $|r(\\omega)| \\le 1$，则该方法被认为是无源的。违背无源性，即 $|r(\\omega)|  1$，会导致不符合物理的振幅增长。我们将推导前向欧拉法和梯形法的放大因子，并建立无源性的条件。\n\n令 $A_n \\approx A(t_n)$ 为离散时间 $t_n = n \\Delta t$ 处振幅的数值近似，其中 $\\Delta t$ 是时间步长。从一个时间步到下一个时间步的演化由 $A_{n+1} = r(\\omega) A_n$ 描述，其中 $r(\\omega)$ 是数值放大因子。\n\n**1. 显式前向欧拉法**\n\n一阶显式前向欧拉法将时间导数近似为前向差分：\n$$\n\\frac{A_{n+1} - A_n}{\\Delta t} = -\\alpha(\\omega) A_n\n$$\n对 $A_{n+1}$ 求解，得到更新规则：\n$$\nA_{n+1} = A_n - \\alpha(\\omega) \\Delta t \\, A_n = (1 - \\alpha(\\omega) \\Delta t) A_n\n$$\n由此，我们确定前向欧拉法的放大因子 $r_{FE}(\\omega)$ 为：\n$$\nr_{FE}(\\omega) = 1 - \\alpha(\\omega) \\Delta t\n$$\n为使数值方案是无源的（即非放大的），放大因子的大小不得超过 $1$：\n$$\n|r_{FE}(\\omega)| \\le 1 \\implies |1 - \\alpha(\\omega) \\Delta t| \\le 1\n$$\n该不等式等价于两个条件：\n$$\n-1 \\le 1 - \\alpha(\\omega) \\Delta t \\le 1\n$$\n让我们分别分析每个不等式。\n首先，$1 - \\alpha(\\omega) \\Delta t \\le 1$ 意味着 $-\\alpha(\\omega) \\Delta t \\le 0$。由于 $\\Delta t > 0$，这等价于 $\\alpha(\\omega) \\ge 0$。该条件对应于介质本身的物理无源性。如果介质不是无源的（$\\alpha(\\omega)  0$），数值方法也会如预期一样表现出增益。\n\n其次，$-1 \\le 1 - \\alpha(\\omega) \\Delta t$ 意味着 $\\alpha(\\omega) \\Delta t \\le 2$。\n\n综合这些，前向欧拉法是稳定且无源的，当且仅当：\n$$\n0 \\le \\alpha(\\omega) \\Delta t \\le 2\n$$\n因此，违背无源性（$|r_{FE}(\\omega)| > 1$）可能由两个不同的原因引起：\n- **不符合物理的参数：** 介质本身是有源的，意味着对某些 $\\omega$ 有 $\\alpha(\\omega)  0$。这违背了稳定性条件的第一部分。这对应于 **代码 2** 违背。\n- **数值不稳定性：** 介质是无源的（对所有 $\\omega$ 都有 $\\alpha(\\omega) \\ge 0$），但时间步长 $\\Delta t$ 过大，导致对某些 $\\omega$ 有 $\\alpha(\\omega) \\Delta t > 2$。这是一个纯粹的数值假象。这对应于 **代码 1** 违背。\n如果网格上没有任何频率满足上述任一违背条件，则未检测到违背，对应于 **代码 0**。\n\n**2. 梯形法则（Crank-Nicolson 方法）**\n\n梯形法则是一种隐式方法，它通过对时间步 $n$ 和 $n+1$ 处的值进行平均来近似常微分方程的右侧：\n$$\n\\frac{A_{n+1} - A_n}{\\Delta t} = -\\alpha(\\omega) \\frac{A_n + A_{n+1}}{2}\n$$\n为了找到放大因子，我们必须对 $A_{n+1}$ 求解：\n$$\nA_{n+1} - A_n = -\\frac{\\alpha(\\omega) \\Delta t}{2} (A_n + A_{n+1})\n$$\n$$\nA_{n+1} \\left(1 + \\frac{\\alpha(\\omega) \\Delta t}{2}\\right) = A_n \\left(1 - \\frac{\\alpha(\\omega) \\Delta t}{2}\\right)\n$$\n$$\nA_{n+1} = \\left( \\frac{1 - \\frac{1}{2}\\alpha(\\omega) \\Delta t}{1 + \\frac{1}{2}\\alpha(\\omega) \\Delta t} \\right) A_n\n$$\n因此，梯形法的放大因子 $r_{CN}(\\omega)$ 为：\n$$\nr_{CN}(\\omega) = \\frac{1 - \\frac{1}{2}\\alpha(\\omega) \\Delta t}{1 + \\frac{1}{2}\\alpha(\\omega) \\Delta t}\n$$\n现在，我们分析其无源性。我们假设一个物理上无源的介质，因此对所有 $\\omega$ 都有 $\\alpha(\\omega) \\ge 0$。令 $x = \\frac{1}{2}\\alpha(\\omega) \\Delta t$。由于 $\\alpha(\\omega) \\ge 0$ 且 $\\Delta t > 0$，我们有 $x \\ge 0$。放大因子为 $r(x) = \\frac{1-x}{1+x}$。我们必须证明对于所有 $x \\ge 0$ 都有 $|r(x)| \\le 1$。\n其大小为：\n$$\n|r(x)| = \\left| \\frac{1-x}{1+x} \\right| = \\frac{|1-x|}{1+x}\n$$\n因为 $x \\ge 0$ 意味着 $1+x > 0$。\n- 如果 $0 \\le x \\le 1$，那么 $|1-x| = 1-x$。不等式 $|r(x)| \\le 1$ 变为 $\\frac{1-x}{1+x} \\le 1$。由于 $1+x > 0$，这等价于 $1-x \\le 1+x$，可简化为 $-x \\le x$，或 $0 \\le 2x$。这对所有 $x \\ge 0$ 都成立。\n- 如果 $x > 1$，那么 $|1-x| = -(1-x) = x-1$。不等式 $|r(x)| \\le 1$ 变为 $\\frac{x-1}{x+1} \\le 1$。这等价于 $x-1 \\le x+1$，可简化为 $-1 \\le 1$。这永远成立。\n\n因此，对于任何 $x \\ge 0$，我们都有 $|r(x)| \\le 1$。这证明了如果介质是无源的（$\\alpha(\\omega) \\ge 0$），那么梯形方法对于任何时间步长 $\\Delta t > 0$ 的选择都是无条件无源的。此性质被称为 A-稳定性。然而，如果介质本身不是无源的（即对某些 $\\omega$ 有 $\\alpha(\\omega)  0$），量 $x$ 可能是负的。如果 $x  0$，令 $x = -y$，其中 $y > 0$。那么 $r(-y) = \\frac{1+y}{1-y}$。如果 $0  y  1$，那么 $|r(-y)| > 1$，这意味着梯形方案也会表现出增益，从而正确地反映了底层（不符合物理的）模型的有源性质。\n\n计算实现将遵循此推导逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing numerical schemes for acoustic attenuation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a0, a2, dt, omega_max)\n    # Case 2's dt is calculated dynamically.\n    omega_max_val = 1e4\n    a0_case2, a2_case2 = 0.5, 1e-6\n    dt_case2 = 2.0 / (a0_case2 + a2_case2 * omega_max_val**2)\n\n    test_cases = [\n        # Case 1 (general happy path)\n        (0.5, 1e-6, 0.01, omega_max_val),\n        # Case 2 (boundary condition)\n        (a0_case2, a2_case2, dt_case2, omega_max_val),\n        # Case 3 (time-step induced non-passivity)\n        (0.5, 1e-6, 0.05, omega_max_val),\n        # Case 4 (parameter-induced non-passivity)\n        (0.2, -1e-6, 0.01, omega_max_val),\n    ]\n\n    # Global parameters for the frequency grid\n    N_omega = 1025\n\n    results = []\n    for case in test_cases:\n        a0, a2, dt, omega_max = case\n\n        # 1. Construct the frequency grid and evaluate attenuation\n        omega_k = np.linspace(0, omega_max, N_omega)\n        alpha_k = a0 + a2 * omega_k**2\n\n        # 2. Diagnose the explicit forward Euler method\n        explicit_code = 0  # Default: No violation\n        if np.any(alpha_k  0):\n            # Violation due to unphysical attenuation\n            explicit_code = 2\n        else:\n            # Physical parameters, check for numerical instability\n            r_fe = 1.0 - alpha_k * dt\n            # Using a tolerance of 1e-12 for floating point comparisons\n            if np.any(np.abs(r_fe) > 1.0 + 1e-12):\n                explicit_code = 1\n        \n        results.append(explicit_code)\n\n        # 3. Test the passivity of the trapezoidal (Crank-Nicolson) method\n        # The denominator can be zero or close to zero if alpha_k is negative.\n        # We handle this to avoid division by zero errors, although for the given\n        # test cases it does not occur.\n        denominator = 1.0 + 0.5 * alpha_k * dt\n        # Set to a safe value if zero, although its amplification would be infinite.\n        denominator[denominator == 0] = 1e-16 \n        \n        r_cn = (1.0 - 0.5 * alpha_k * dt) / denominator\n        \n        # Check if the magnitude of the amplification factor is = 1 for all frequencies\n        is_cn_passive = np.all(np.abs(r_cn) = 1.0 + 1e-12)\n        results.append(is_cn_passive)\n\n    # 4. Final print statement in the exact required format.\n    # The boolean values are converted to string as 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}