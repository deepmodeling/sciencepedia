{
    "hands_on_practices": [
        {
            "introduction": "本征函数展开是求解有界域中偏微分方程的基石性方法。这项实践将引导我们从第一性原理出发，为矩形腔体内的亥姆霍兹方程构造诺伊曼格林函数 ()。通过这个过程，我们将亲眼见证互易性原理如何从自伴算子的本征函数展开式的对称性中自然产生，并深入分析零频（常数）模式对系统响应的独特贡献。",
            "id": "4125321",
            "problem": "考虑一个三维矩形声腔 $\\Omega = (0,L_{x}) \\times (0,L_{y}) \\times (0,L_{z})$，其中充满了均匀、无损耗的流体。声腔壁是完美刚性的，这意味着声压满足均匀诺伊曼边界条件。在频域中，亥姆霍兹算子的声压格林函数 $G_{N}(\\mathbf{r},\\mathbf{r}';k)$ 满足偏微分方程 (PDE)\n$$\n\\nabla^{2} G_{N}(\\mathbf{r},\\mathbf{r}';k) + k^{2} G_{N}(\\mathbf{r},\\mathbf{r}';k) = -\\delta(\\mathbf{r}-\\mathbf{r}'),\n$$\n且满足均匀诺伊曼边界条件\n$$\n\\frac{\\partial G_{N}}{\\partial n}\\bigg|_{\\partial \\Omega} = 0,\n$$\n其中 $k>0$ 是波数，$\\delta(\\mathbf{r}-\\mathbf{r}')$ 是狄拉克δ分布，$\\partial/\\partial n$ 表示在边界 $\\partial \\Omega$ 上的外法向导数。假设 $k^{2}$ 不等于 $\\Omega$ 的任何非零诺伊曼拉普拉斯算子特征值，因此预解式是良定义的。\n\n从基本原理出发，即具有诺伊曼边界条件的负拉普拉斯算子的自伴性及其本征函数的完备性和正交归一性，构建 $G_{N}(\\mathbf{r},\\mathbf{r}';k)$ 在 $\\Omega$ 中的本征函数展开式。明确指出零特征值（常数）模态，包括其正确的归一化，并利用互易原理来解释此情景下的对称性 $G_{N}(\\mathbf{r},\\mathbf{r}';k) = G_{N}(\\mathbf{r}',\\mathbf{r};k)$。\n\n然后，解析地计算诺伊曼格林函数对其两个自变量的双重体平均：\n$$\n\\langle G_{N} \\rangle := \\frac{1}{V^{2}} \\int_{\\Omega} \\int_{\\Omega} G_{N}(\\mathbf{r},\\mathbf{r}';k)\\, \\mathrm{d}^{3}\\mathbf{r}\\, \\mathrm{d}^{3}\\mathbf{r}',\n$$\n其中 $V = L_{x} L_{y} L_{z}$ 是腔体体积。你的计算必须分离并量化零频率（常数）模态的贡献。\n\n以 $L_{x}$、$L_{y}$、$L_{z}$ 和 $k$ 的形式，给出一个单一、闭合形式的解析表达式作为 $\\langle G_{N} \\rangle$ 的最终结果。最终答案以逆米为单位表示。不需要数值近似。",
            "solution": "问题有待验证。\n\n### 第1步：提取已知条件\n- **域：** 三维矩形声腔 $\\Omega = (0,L_{x}) \\times (0,L_{y}) \\times (0,L_{z})$。\n- **介质：** 均匀、无损耗的流体。\n- **边界条件：** 完美刚性壁，意味着均匀诺伊曼边界条件：$\\frac{\\partial G_{N}}{\\partial n}\\bigg|_{\\partial \\Omega} = 0$。\n- **控制方程：** 格林函数 $G_{N}(\\mathbf{r},\\mathbf{r}';k)$ 的亥姆霍兹方程为 $\\nabla^{2} G_{N}(\\mathbf{r},\\mathbf{r}';k) + k^{2} G_{N}(\\mathbf{r},\\mathbf{r}';k) = -\\delta(\\mathbf{r}-\\mathbf{r}')$，其中 $\\mathbf{r}, \\mathbf{r}' \\in \\Omega$。\n- **参数：** 波数 $k>0$。\n- **约束：** $k^{2}$ 不等于 $\\Omega$ 的任何非零诺伊曼拉普拉斯算子特征值。\n- **任务1：** 构建 $G_{N}(\\mathbf{r},\\mathbf{r}';k)$ 的本征函数展开式，并指出零特征值模态。\n- **任务2：** 利用互易原理来解释对称性 $G_{N}(\\mathbf{r},\\mathbf{r}';k) = G_{N}(\\mathbf{r}',\\mathbf{r};k)$。\n- **任务3：** 解析地计算双重体平均 $\\langle G_{N} \\rangle := \\frac{1}{V^{2}} \\int_{\\Omega} \\int_{\\Omega} G_{N}(\\mathbf{r},\\mathbf{r}';k)\\, \\mathrm{d}^{3}\\mathbf{r}\\, \\mathrm{d}^{3}\\mathbf{r}'$，其中 $V = L_{x} L_{y} L_{z}$。\n- **输出要求：** $\\langle G_{N} \\rangle$ 的最终结果必须是一个以 $L_{x}$、$L_{y}$、$L_{z}$ 和 $k$ 表示的单一、闭合形式的解析表达式，单位为逆米。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，是数学物理和声学中涉及亥姆霍兹方程和格林函数的标准问题。问题是良定的；域、算子和边界条件都得到了清晰的定义。$k^2$ 不是非零特征值的约束确保了格林函数是良定义的并且不会发散，这是可解性的一个关键条件。语言客观而精确。问题是自洽的，没有矛盾或科学缺陷。这是一个不平凡的问题，它考验了关于本征函数展开和正交性的基本概念。\n\n### 第3步：结论和行动\n问题是有效的，可以按所述方式求解。\n\n求解过程首先找到控制算子的本征函数和特征值，然后用它们来构造格林函数。\n\n格林函数 $G_N(\\mathbf{r},\\mathbf{r}';k)$ 是非齐次亥姆霍兹方程的解。令 $L = -\\nabla^2$ 为负拉普拉斯算子。该偏微分方程可写为 $(-L + k^2)G_N(\\mathbf{r}, \\mathbf{r}'; k) = -\\delta(\\mathbf{r}-\\mathbf{r}')$，即 $(L - k^2)G_N(\\mathbf{r}, \\mathbf{r}'; k) = \\delta(\\mathbf{r}-\\mathbf{r}')$。格林函数可以在具有均匀诺伊曼边界条件的算子 $L$ 的完备、正交归一的本征函数基中展开。\n\n首先，我们求解特征值问题 $L\\psi(\\mathbf{r}) = \\lambda \\psi(\\mathbf{r})$，即在 $\\Omega$ 中的 $-\\nabla^2 \\psi(\\mathbf{r}) = \\lambda \\psi(\\mathbf{r})$，其边界条件为 $\\frac{\\partial \\psi}{\\partial n}|_{\\partial\\Omega} = 0$。\n使用分离变量法，我们令 $\\psi(x,y,z) = X(x)Y(y)Z(z)$。这会得到三个常微分方程：\n$$\n-X''(x) = k_x^2 X(x), \\quad -Y''(y) = k_y^2 Y(y), \\quad -Z''(z) = k_z^2 Z(z)\n$$\n边界条件为 $X'(0)=X'(L_x)=0$、$Y'(0)=Y'(L_y)=0$ 和 $Z'(0)=Z'(L_z)=0$。特征值为 $\\lambda = k_x^2 + k_y^2 + k_z^2$。\n满足这些边界条件的解的形式为 $\\cos(\\frac{n_x \\pi x}{L_x})$、$\\cos(\\frac{n_y \\pi y}{L_y})$ 和 $\\cos(\\frac{n_z \\pi z}{L_z})$，其中 $n_x, n_y, n_z$ 是非负整数。\n因此，特征值由三元整数组 $\\mathbf{n}=(n_x, n_y, n_z)$ 索引：\n$$\n\\lambda_{\\mathbf{n}} = k_{\\mathbf{n}}^2 = \\left(\\frac{n_x \\pi}{L_x}\\right)^2 + \\left(\\frac{n_y \\pi}{L_y}\\right)^2 + \\left(\\frac{n_z \\pi}{L_z}\\right)^2\n$$\n相应的未归一化本征函数为 $\\psi_{\\mathbf{n}}(\\mathbf{r}) = \\cos(\\frac{n_x \\pi x}{L_x})\\cos(\\frac{n_y \\pi y}{L_y})\\cos(\\frac{n_z \\pi z}{L_z})$。\n\n这些本征函数必须被归一化，使得 $\\int_\\Omega \\psi_{\\mathbf{n}}(\\mathbf{r})^2 \\,d^3\\mathbf{r} = 1$。我们来计算归一化积分：\n$$\n\\int_0^{L_x} \\cos^2\\left(\\frac{n_x \\pi x}{L_x}\\right)dx = \\begin{cases} L_x  \\text{if } n_x=0 \\\\ L_x/2  \\text{if } n_x>0 \\end{cases}\n$$\n这同样适用于 $y$ 和 $z$ 的积分。我们定义一个因子 $N_j$，当 $n_j=0$ 时 $N_j=1$，当 $n_j>0$ 时 $N_j=2$。归一化常数的平方由下式给出：\n$$\nC_{\\mathbf{n}}^2 \\frac{L_x}{N_x} \\frac{L_y}{N_y} \\frac{L_z}{N_z} = 1 \\implies C_{\\mathbf{n}} = \\sqrt{\\frac{N_x N_y N_z}{V}}\n$$\n其中 $V=L_x L_y L_z$。正交归一的本征函数为：\n$$\n\\psi_{\\mathbf{n}}(\\mathbf{r}) = \\sqrt{\\frac{N_x N_y N_z}{V}} \\cos\\left(\\frac{n_x \\pi x}{L_x}\\right)\\cos\\left(\\frac{n_y \\pi y}{L_y}\\right)\\cos\\left(\\frac{n_z \\pi z}{L_z}\\right)\n$$\n零特征值模态对应于 $\\mathbf{n}=(0,0,0)$。对于此模态，$n_x=n_y=n_z=0$，因此 $N_x=N_y=N_z=1$ 且 $\\lambda_{\\mathbf{0}}=0$。归一化后的本征函数为：\n$$\n\\psi_{\\mathbf{0}}(\\mathbf{r}) = \\sqrt{\\frac{1}{V}} \\cos(0)\\cos(0)\\cos(0) = \\frac{1}{\\sqrt{V}}\n$$\n这是常数模态。\n\n格林函数由本征函数展开式给出：\n$$\nG_N(\\mathbf{r},\\mathbf{r}';k) = \\sum_{\\mathbf{n}} \\frac{\\psi_{\\mathbf{n}}(\\mathbf{r})\\psi_{\\mathbf{n}}(\\mathbf{r}')}{\\lambda_{\\mathbf{n}} - k^2}\n$$\n求和遍及所有非负整数三元组 $\\mathbf{n}=(n_x,n_y,n_z)$。我们可以将零特征值模态从求和中分离出来：\n$$\nG_N(\\mathbf{r},\\mathbf{r}';k) = \\frac{\\psi_{\\mathbf{0}}(\\mathbf{r})\\psi_{\\mathbf{0}}(\\mathbf{r}')}{\\lambda_{\\mathbf{0}} - k^2} + \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{\\psi_{\\mathbf{n}}(\\mathbf{r})\\psi_{\\mathbf{n}}(\\mathbf{r}')}{\\lambda_{\\mathbf{n}} - k^2}\n$$\n代入 $\\psi_{\\mathbf{0}}(\\mathbf{r}) = 1/\\sqrt{V}$ 和 $\\lambda_{\\mathbf{0}}=0$：\n$$\nG_N(\\mathbf{r},\\mathbf{r}';k) = \\frac{(1/\\sqrt{V})(1/\\sqrt{V})}{-k^2} + \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{\\psi_{\\mathbf{n}}(\\mathbf{r})\\psi_{\\mathbf{n}}(\\mathbf{r}')}{\\lambda_{\\mathbf{n}} - k^2} = -\\frac{1}{Vk^2} + \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{\\psi_{\\mathbf{n}}(\\mathbf{r})\\psi_{\\mathbf{n}}(\\mathbf{r}')}{\\lambda_{\\mathbf{n}} - k^2}\n$$\n这是诺伊曼格林函数的本征函数展开式，其中零模态的贡献已被明确指出。\n\n互易原理 $G_N(\\mathbf{r},\\mathbf{r}';k) = G_N(\\mathbf{r}',\\mathbf{r};k)$ 是此展开式结构的直接结果。具有诺伊曼边界条件的算子 $L=-\\nabla^2$ 是自伴的，这保证了其特征值 $\\lambda_{\\mathbf{n}}$ 是实数，其本征函数 $\\psi_{\\mathbf{n}}(\\mathbf{r})$ 可以选择为实函数。在展开式中，项 $\\psi_{\\mathbf{n}}(\\mathbf{r})\\psi_{\\mathbf{n}}(\\mathbf{r}')$ 对于交换 $\\mathbf{r}$ 和 $\\mathbf{r}'$ 显然是对称的。由于求和中的每一项都是对称的，所以整个和，也就是格林函数，也是对称的。这种对称性反映了物理原理，即由位于 $\\mathbf{r}'$ 的声源在 $\\mathbf{r}$ 处引起的声学响应，与由位于 $\\mathbf{r}$ 的相同声源在 $\\mathbf{r}'$ 处引起的响应是相同的。\n\n现在，我们计算双重体平均：\n$$\n\\langle G_{N} \\rangle = \\frac{1}{V^{2}} \\int_{\\Omega} \\int_{\\Omega} G_{N}(\\mathbf{r},\\mathbf{r}';k)\\, \\mathrm{d}^{3}\\mathbf{r}\\, \\mathrm{d}^{3}\\mathbf{r}'\n$$\n代入 $G_N$ 的本征函数展开式，并交换求和与积分的顺序：\n$$\n\\langle G_{N} \\rangle = \\frac{1}{V^{2}} \\sum_{\\mathbf{n}} \\frac{1}{\\lambda_{\\mathbf{n}} - k^2} \\int_{\\Omega} \\int_{\\Omega} \\psi_{\\mathbf{n}}(\\mathbf{r})\\psi_{\\mathbf{n}}(\\mathbf{r}') \\, \\mathrm{d}^{3}\\mathbf{r}\\, \\mathrm{d}^{3}\\mathbf{r}'\n$$\n该双重积分可以分离为两个相同积分的乘积：\n$$\n\\int_{\\Omega} \\int_{\\Omega} \\psi_{\\mathbf{n}}(\\mathbf{r})\\psi_{\\mathbf{n}}(\\mathbf{r}') \\, \\mathrm{d}^{3}\\mathbf{r}\\, \\mathrm{d}^{3}\\mathbf{r}' = \\left( \\int_{\\Omega} \\psi_{\\mathbf{n}}(\\mathbf{r}) \\, \\mathrm{d}^{3}\\mathbf{r} \\right) \\left( \\int_{\\Omega} \\psi_{\\mathbf{n}}(\\mathbf{r}') \\, \\mathrm{d}^{3}\\mathbf{r}' \\right) = \\left( \\int_{\\Omega} \\psi_{\\mathbf{n}}(\\mathbf{r}) \\, \\mathrm{d}^{3}\\mathbf{r} \\right)^2\n$$\n我们来计算积分 $\\int_{\\Omega} \\psi_{\\mathbf{n}}(\\mathbf{r}) \\, \\mathrm{d}^{3}\\mathbf{r}$。这个积分与 $\\psi_{\\mathbf{n}}(\\mathbf{r})$ 和常数函数 $f(\\mathbf{r})=1$ 的内积成正比。由于常数函数与零模态本征函数 $\\psi_{\\mathbf{0}}(\\mathbf{r})$ 成正比，本征函数的正交性意味着对于所有 $\\mathbf{n} \\neq \\mathbf{0}$，这个积分为零。\n让我们明确地验证这一点。\n对于 $\\mathbf{n} = \\mathbf{0}$：\n$$\n\\int_{\\Omega} \\psi_{\\mathbf{0}}(\\mathbf{r}) \\, \\mathrm{d}^{3}\\mathbf{r} = \\int_{\\Omega} \\frac{1}{\\sqrt{V}} \\, \\mathrm{d}^{3}\\mathbf{r} = \\frac{1}{\\sqrt{V}} V = \\sqrt{V}\n$$\n对于 $\\mathbf{n} \\neq \\mathbf{0}$，至少有一个索引 $n_j$ (比如 $n_x$) 是非零的。该积分包含一个因子：\n$$\n\\int_0^{L_x} \\cos\\left(\\frac{n_x \\pi x}{L_x}\\right) \\, dx = \\left[ \\frac{L_x}{n_x \\pi} \\sin\\left(\\frac{n_x \\pi x}{L_x}\\right) \\right]_0^{L_x} = 0 \\quad \\text{for } n_x > 0\n$$\n这使得对于任何 $\\mathbf{n} \\neq \\mathbf{0}$，整个体积分都为零。\n因此，$\\int_{\\Omega} \\psi_{\\mathbf{n}}(\\mathbf{r}) \\, \\mathrm{d}^{3}\\mathbf{r} = \\sqrt{V} \\delta_{\\mathbf{n},\\mathbf{0}}$，其中 $\\delta_{\\mathbf{n},\\mathbf{0}}$ 是克罗内克δ函数。\n\n因此，在 $\\langle G_{N} \\rangle$ 的求和中，所有 $\\mathbf{n} \\neq \\mathbf{0}$ 的项都消失了。只有对应于零频率模态 $\\mathbf{n}=\\mathbf{0}$ 的项存留下来。\n\n来自 $\\mathbf{n}=\\mathbf{0}$ 模态的贡献是：\n$$\n\\langle G_{N} \\rangle = \\frac{1}{V^{2}} \\frac{1}{\\lambda_{\\mathbf{0}} - k^2} \\left( \\int_{\\Omega} \\psi_{\\mathbf{0}}(\\mathbf{r}) \\, \\mathrm{d}^{3}\\mathbf{r} \\right)^2\n$$\n代入 $\\lambda_{\\mathbf{0}}=0$ 和 $\\int_{\\Omega} \\psi_{\\mathbf{0}}(\\mathbf{r}) \\, d^3\\mathbf{r} = \\sqrt{V}$：\n$$\n\\langle G_{N} \\rangle = \\frac{1}{V^{2}} \\frac{1}{-k^2} (\\sqrt{V})^2 = \\frac{1}{V^2} \\frac{V}{-k^2} = -\\frac{1}{Vk^2}\n$$\n对双重体平均的全部贡献都来自零频率（常数）模态。\n代入 $V = L_x L_y L_z$，我们得到最终表达式：\n$$\n\\langle G_{N} \\rangle = -\\frac{1}{L_x L_y L_z k^2}\n$$\n单位与要求一致：$V$ 的单位是 $[\\text{长度}]^3$，$k$ 的单位是 $[\\text{长度}]^{-1}$，所以 $Vk^2$ 的单位是 $[\\text{长度}]$。最终结果 $\\langle G_{N} \\rangle$ 的单位是 $[\\text{长度}]^{-1}$。",
            "answer": "$$ \\boxed{-\\frac{1}{L_x L_y L_z k^2}} $$"
        },
        {
            "introduction": "将连续介质的物理原理转化为离散的计算模型是计算声学的核心任务。本练习旨在搭建从连续理论到有限元方法（FEM）实践的桥梁 ()。我们将探讨声学互易性原理如何在离散系统的矩阵代数中体现为对称性，并量化非对称物理效应（如回转阻尼）对该对称性的破坏程度，从而加深对数值模型中物理守恒律的理解。",
            "id": "4125340",
            "problem": "在线性声学中，对于静止介质，频域声压场 $p(\\mathbf{x},\\omega)$ 满足一个亥姆霍兹型方程。该方程通过有限元法 (FEM) 进行伽辽金离散化后，会得到一个二阶离散系统，其弱形式系数可组装成实对称质量矩阵 $M$ 和实对称刚度矩阵 $K$。当包含阻尼且激励为角频率为 $\\omega$ 的时谐激励时，离散频域平衡由一个动态刚度算子控制，该算子作用于节点压力向量 $u(\\omega)$，并将节点源向量 $f(\\omega)$ 映射到 $u(\\omega)$。离散格林矩阵 $G(\\omega)$ 是将 $f(\\omega)$ 映射到 $u(\\omega)$ 的算子逆，而离散互易性体现为 $G(\\omega)$ 的对称性。\n\n从一个小振幅声场的质量和动量守恒出发，通过有限元弱形式推导离散频域算子结构，并用它来论证离散格林矩阵 $G(\\omega)$ 保持对称的条件。然后，通过无量纲的对称性破缺指数来量化 $G(\\omega)$ 的对称性：\n$$\nr(\\omega) \\;=\\; \\frac{\\|G(\\omega) - G(\\omega)^{\\mathsf{T}}\\|_{F}}{\\|G(\\omega)\\|_{F}},\n$$\n其中 $\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数，$(\\cdot)^{\\mathsf{T}}$ 表示矩阵转置。考虑一个简化的双自由度有限元模型，其具有以下对称的质量和刚度矩阵：\n$$\nM \\;=\\; \\begin{pmatrix} 2  0 \\\\[4pt] 0  1 \\end{pmatrix},\n\\qquad\nK \\;=\\; \\begin{pmatrix} 5  -1 \\\\[4pt] -1  3 \\end{pmatrix},\n$$\n该模型在角频率 $\\omega = 2$ (弧度/秒) 下运行。假设阻尼在两种情景下进行建模：\n- 情景 (i)：比例对称阻尼 $D \\;=\\; \\alpha M + \\beta K$，其中 $\\alpha = 0.1$ 且 $\\beta = 0.05$。\n- 情景 (ii)：在比例阻尼上增加非对称陀螺型贡献 $D \\;=\\; \\alpha M + \\beta K + \\gamma J$，其中 $\\gamma = 0.2$ 且\n$$\nJ \\;=\\; \\begin{pmatrix} 0  1 \\\\[4pt] -1  0 \\end{pmatrix}.\n$$\n在两种情景中，频域动态刚度为\n$$\nA(\\omega) \\;=\\; K \\;-\\; \\omega^{2} M \\;+\\; i\\,\\omega\\, D,\n$$\n且离散格林矩阵为 $G(\\omega) \\;=\\; A(\\omega)^{-1}$。计算两种情景 (i) 和 (ii) 下的对称性破缺指数 $r(\\omega)$。请用包含根式的精确解析形式表示 $r(\\omega)$ 的最终答案；不要进行四舍五入或近似计算。量 $r(\\omega)$ 是无量纲的，因此最终答案不需要物理单位。",
            "solution": "本问题要求论证离散格林矩阵 $G(\\omega)$ 保持对称的条件，然后为一个2自由度系统在两种不同阻尼情景下，计算其无量纲对称性破缺指数 $r(\\omega)$。\n\n首先，我们探讨离散格林矩阵 $G(\\omega)$ 保持对称的条件。离散频域平衡方程由下式给出：\n$$A(\\omega) u(\\omega) = f(\\omega)$$\n其中 $A(\\omega)$ 是动态刚度矩阵，$u(\\omega)$ 是节点压力向量，$f(\\omega)$ 是节点源向量。离散格林矩阵 $G(\\omega)$ 定义为 $A(\\omega)$ 的逆，使得 $u(\\omega) = G(\\omega) f(\\omega)$。\n$$G(\\omega) = A(\\omega)^{-1}$$\n矩阵的一个基本性质是，一个矩阵是对称的当且仅当其逆矩阵也是对称的。因此，$G(\\omega)$ 是对称的，即 $G(\\omega) = G(\\omega)^{\\mathsf{T}}$，当且仅当 $A(\\omega)$ 是对称的，即 $A(\\omega) = A(\\omega)^{\\mathsf{T}}$。\n\n动态刚度矩阵定义为：\n$$A(\\omega) = K - \\omega^{2} M + i\\,\\omega\\, D$$\n其中 $K$ 是刚度矩阵，$M$ 是质量矩阵，$D$ 是阻尼矩阵，$\\omega$ 是角频率，$i$ 是虚数单位。为了检验对称性条件，我们对 $A(\\omega)$ 进行转置：\n$$A(\\omega)^{\\mathsf{T}} = (K - \\omega^{2} M + i\\,\\omega\\, D)^{\\mathsf{T}} = K^{\\mathsf{T}} - (\\omega^{2} M)^{\\mathsf{T}} + (i\\,\\omega\\, D)^{\\mathsf{T}}$$\n由于 $\\omega^{2}$ 和 $i\\,\\omega$ 是标量，上式可简化为：\n$$A(\\omega)^{\\mathsf{T}} = K^{\\mathsf{T}} - \\omega^{2} M^{\\mathsf{T}} + i\\,\\omega\\, D^{\\mathsf{T}}$$\n问题陈述中指出，质量矩阵 $M$ 和刚度矩阵 $K$ 是实对称的，即 $M = M^{\\mathsf{T}}$ 和 $K = K^{\\mathsf{T}}$。将这些代入 $A(\\omega)^{\\mathsf{T}}$ 的表达式中，得到：\n$$A(\\omega)^{\\mathsf{T}} = K - \\omega^{2} M + i\\,\\omega\\, D^{\\mathsf{T}}$$\n为了使 $A(\\omega)$ 对称，我们必须有 $A(\\omega) = A(\\omega)^{\\mathsf{T}}$：\n$$K - \\omega^{2} M + i\\,\\omega\\, D = K - \\omega^{2} M + i\\,\\omega\\, D^{\\mathsf{T}}$$\n该方程成立的充要条件是 $i\\,\\omega\\, D = i\\,\\omega\\, D^{\\mathsf{T}}$。对于任何非零频率 $\\omega \\neq 0$，这简化为阻尼矩阵 $D$ 必须是对称的条件：\n$$D = D^{\\mathsf{T}}$$\n因此，在这个离散系统的背景下，体现为格林矩阵 $G(\\omega)$ 对称性的互易性原理，其成立的充要条件是阻尼矩阵 $D$ 是对称的。\n\n现在，我们计算在 $\\omega = 2$ 时，两种指定情景下的对称性破缺指数 $r(\\omega)$。\n该指数定义为：\n$$r(\\omega) = \\frac{\\|G(\\omega) - G(\\omega)^{\\mathsf{T}}\\|_{F}}{\\|G(\\omega)\\|_{F}}$$\n\n**情景 (i)：比例对称阻尼**\n\n阻尼矩阵由 $D = \\alpha M + \\beta K$ 给出，参数为 $\\alpha = 0.1$, $\\beta = 0.05$。矩阵 $M$ 和 $K$ 如下所示：\n$$M = \\begin{pmatrix} 2   0 \\\\ 0  1 \\end{pmatrix}, \\qquad K = \\begin{pmatrix} 5  -1 \\\\ -1  3 \\end{pmatrix}$$\n由于 $M$ 和 $K$ 是对称的，且 $\\alpha$ 和 $\\beta$ 是标量，因此得到的阻尼矩阵 $D$ 也必须是对称的：\n$$D^{\\mathsf{T}} = (\\alpha M + \\beta K)^{\\mathsf{T}} = \\alpha M^{\\mathsf{T}} + \\beta K^{\\mathsf{T}} = \\alpha M + \\beta K = D$$\n正如我们在推导中确立的，如果 $D$ 是对称的，那么 $A(\\omega)$ 也是对称的，因此其逆矩阵 $G(\\omega)$ 也是对称的。如果 $G(\\omega) = G(\\omega)^{\\mathsf{T}}$，那么差值 $G(\\omega) - G(\\omega)^{\\mathsf{T}}$ 就是零矩阵。零矩阵的弗罗贝尼乌斯范数为 $0$。因此，对于情景 (i)，对称性破缺指数为：\n$$r(2) = \\frac{\\|0\\|_{F}}{\\|G(2)\\|_{F}} = 0$$\n\n**情景 (ii)：非对称陀螺型阻尼**\n\n阻尼矩阵为 $D = \\alpha M + \\beta K + \\gamma J$，其中 $\\alpha = 0.1$, $\\beta = 0.05$, $\\gamma = 0.2$，以及斜对称矩阵：\n$$J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$$\n如情景(i)所示，项 $\\alpha M + \\beta K$ 是对称的。项 $\\gamma J$ 是斜对称的，因为 $J^{\\mathsf{T}} = -J$。完整的阻尼矩阵的转置为：\n$$D^{\\mathsf{T}} = (\\alpha M + \\beta K)^{\\mathsf{T}} + (\\gamma J)^{\\mathsf{T}} = (\\alpha M + \\beta K) - \\gamma J$$\n由于 $\\gamma \\neq 0$ 且 $J$ 不是零矩阵，所以 $D \\neq D^{\\mathsf{T}}$。阻尼矩阵是非对称的。因此，$A(\\omega)$ 和 $G(\\omega)$ 也是非对称的，我们预期 $r(\\omega) \\neq 0$。\n\n我们计算在 $\\omega = 2$ 时的动态刚度矩阵 $A(\\omega)$：\n$A(2) = K - 2^{2} M + i(2) D = K - 4M + 2iD$。\n首先，我们计算 $D$：\n$$D = 0.1 \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} + 0.05 \\begin{pmatrix} 5  -1 \\\\ -1  3 \\end{pmatrix} + 0.2 \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$$\n$$D = \\begin{pmatrix} 0.2  0 \\\\ 0  0.1 \\end{pmatrix} + \\begin{pmatrix} 0.25  -0.05 \\\\ -0.05  0.15 \\end{pmatrix} + \\begin{pmatrix} 0  0.2 \\\\ -0.2  0 \\end{pmatrix} = \\begin{pmatrix} 0.45  0.15 \\\\ -0.25  0.25 \\end{pmatrix}$$\n现在我们组装 $A(2)$：\n$$A(2) = \\begin{pmatrix} 5  -1 \\\\ -1  3 \\end{pmatrix} - 4 \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} + 2i \\begin{pmatrix} 0.45  0.15 \\\\ -0.25  0.25 \\end{pmatrix}$$\n$$A(2) = \\begin{pmatrix} 5-8  -1 \\\\ -1  3-4 \\end{pmatrix} + i \\begin{pmatrix} 0.9  0.3 \\\\ -0.5  0.5 \\end{pmatrix} = \\begin{pmatrix} -3 + 0.9i  -1 + 0.3i \\\\ -1 - 0.5i  -1 + 0.5i \\end{pmatrix}$$\n令 $A = A(2)$。对于 $2 \\times 2$ 情况，指数 $r(2)$ 可以简化为 $r(2) = \\frac{\\sqrt{2}|a_{21} - a_{12}|}{\\|A(2)\\|_{F}}$。\n\n为了精确计算，我们使用分数来计算必要的量。\n$A(2) = \\begin{pmatrix} -3 + \\frac{9}{10}i  -1 + \\frac{3}{10}i \\\\ -1 - \\frac{1}{2}i  -1 + \\frac{1}{2}i \\end{pmatrix}$。\n矩阵元素为 $a_{11}$, $a_{12}$, $a_{21}$, $a_{22}$。\n$a_{21} - a_{12} = (-1 - \\frac{1}{2}i) - (-1 + \\frac{3}{10}i) = -\\frac{1}{2}i - \\frac{3}{10}i = -\\frac{5+3}{10}i = -\\frac{8}{10}i = -\\frac{4}{5}i$。\n$|a_{21} - a_{12}| = |-\\frac{4}{5}i| = \\frac{4}{5}$。\n$r(2)$ 的分子是 $\\sqrt{2} \\cdot \\frac{4}{5} = \\frac{4\\sqrt{2}}{5}$。\n\n分母是 $A(2)$ 的弗罗贝尼乌斯范数：\n$$\\|A(2)\\|_{F} = \\sqrt{|a_{11}|^2 + |a_{12}|^2 + |a_{21}|^2 + |a_{22}|^2}$$\n$|a_{11}|^2 = |-3 + \\frac{9}{10}i|^2 = (-3)^2 + (\\frac{9}{10})^2 = 9 + \\frac{81}{100} = \\frac{981}{100}$。\n$|a_{12}|^2 = |-1 + \\frac{3}{10}i|^2 = (-1)^2 + (\\frac{3}{10})^2 = 1 + \\frac{9}{100} = \\frac{109}{100}$。\n$|a_{21}|^2 = |-1 - \\frac{1}{2}i|^2 = (-1)^2 + (-\\frac{1}{2})^2 = 1 + \\frac{1}{4} = \\frac{5}{4} = \\frac{125}{100}$。\n$|a_{22}|^2 = |-1 + \\frac{1}{2}i|^2 = (-1)^2 + (\\frac{1}{2})^2 = 1 + \\frac{1}{4} = \\frac{5}{4} = \\frac{125}{100}$。\n$$\\|A(2)\\|_{F}^2 = \\frac{981 + 109 + 125 + 125}{100} = \\frac{1340}{100} = \\frac{134}{10} = \\frac{67}{5}$$\n$$\\|A(2)\\|_{F} = \\sqrt{\\frac{67}{5}}$$\n最后，我们计算比率 $r(2)$：\n$$r(2) = \\frac{4\\sqrt{2}/5}{\\sqrt{67/5}} = \\frac{4\\sqrt{2}}{5} \\cdot \\frac{\\sqrt{5}}{\\sqrt{67}} = \\frac{4\\sqrt{10}}{5\\sqrt{67}}$$\n为了使分母有理化，我们将分子和分母同乘以 $\\sqrt{67}$：\n$$r(2) = \\frac{4\\sqrt{10}\\sqrt{67}}{5(\\sqrt{67})^2} = \\frac{4\\sqrt{670}}{5 \\cdot 67} = \\frac{4\\sqrt{670}}{335}$$\n\n对称性破缺指数 $r(2)$ 的最终答案在情景 (i) 中为 $0$，在情景 (ii) 中为 $\\frac{4\\sqrt{670}}{335}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0  \\frac{4\\sqrt{670}}{335} \\end{pmatrix}}$$"
        },
        {
            "introduction": "格林恒等式不仅是理论工具，更是求解声散射等外部问题的强大数值方法（如边界元法）的基础。这项综合性编程实践将理论与计算融为一体 ()。我们将利用基尔霍夫-亥姆霍兹积分公式计算声波与障碍物相互作用产生的远场散射振幅，并通过编写代码来具体验证散射理论中的一个基本定理——远场互易性，从而将抽象的数学原理与可观测的物理量紧密联系起来。",
            "id": "4125280",
            "problem": "考虑在均匀、各向同性、无源的外部区域中的二维时谐声学问题。总声压场 $u_{\\mathrm{tot}}(\\mathbf{x})$ 对于软声障外部的所有观测点 $\\mathbf{x}$ 均满足标量亥姆霍兹方程 $\\Delta u_{\\mathrm{tot}}(\\mathbf{x}) + k^{2} u_{\\mathrm{tot}}(\\mathbf{x}) = 0$，并且在无穷远处满足Sommerfeld辐射条件。障碍物是一个以原点为中心、半径为 $a$ 的圆柱体，在 $|\\mathbf{x}| = a$ 处施加软声边界条件 $u_{\\mathrm{tot}}(\\mathbf{x}) = 0$。一个单位振幅的平面波从方向角 $\\theta_{\\mathrm{i}}$ 入射，记作 $u_{\\mathrm{inc}}(\\mathbf{x}) = \\exp\\!\\big(i k \\, \\hat{\\mathbf{d}}_{\\mathrm{i}} \\cdot \\mathbf{x}\\big)$，其中 $\\hat{\\mathbf{d}}_{\\mathrm{i}} = (\\cos \\theta_{\\mathrm{i}}, \\sin \\theta_{\\mathrm{i}})$，$k$ 是波数。散射场由 $u(\\mathbf{x}) = u_{\\mathrm{tot}}(\\mathbf{x}) - u_{\\mathrm{inc}}(\\mathbf{x})$ 给出，在外部区域同样服从亥姆霍兹方程和辐射条件。\n\n从亥姆霍兹算子的格林第二恒等式和二维基本解（格林函数）出发，推导远场散射振幅 $F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})$ 通过在障碍物边界 $\\Gamma = \\{ \\mathbf{y} : |\\mathbf{y}| = a \\}$ 上的Kirchhoff–Helmholtz积分表示，该表示以散射场的边界迹 $u(\\mathbf{y})$ 和 $\\partial u(\\mathbf{y}) / \\partial n(\\mathbf{y})$ 以及二维格林函数的渐近形式来表达。然后，对于圆形几何，通过在圆柱坐标系中使用分离变量法求解，计算与软声边界条件一致的边界密度 $u(\\mathbf{y})$ 和 $\\partial u(\\mathbf{y}) / \\partial n(\\mathbf{y})$。使用这些边界密度，通过Kirchhoff–Helmholtz积分数值计算远场散射振幅 $F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})$。\n\n最后，通过证明散射振幅对于圆形软声障满足 $F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}) = F(\\theta_{\\mathrm{i}},\\theta_{\\mathrm{s}})$，来验证互易介质中标量声学的互易原理，并量化由您的离散化产生的与精确互易性的数值偏差。\n\n所有角度必须以弧度表示。物理单位必须如下：半径 $a$ 以米为单位，声速 $c$ 以米/秒为单位，频率 $f$ 以赫兹为单位；使用 $k = 2\\pi f / c$ 计算 $k$，其单位为反米。您的程序必须：\n- 通过使用具有 $N$ 个节点的均匀梯形法则沿圆形边界进行数值积分，由Kirchhoff–Helmholtz积分计算散射振幅 $F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})$。\n- 使用分离变量法计算软声圆柱体的精确远场散射振幅，并将其用作参考。\n- 对于每个测试用例，输出两个浮点数：Kirchhoff–Helmholtz积分结果与精确参考之间的绝对差，以及量化互易性的绝对差 $|F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}) - F(\\theta_{\\mathrm{i}},\\theta_{\\mathrm{s}})|$。\n\n使用以下参数值测试套件，其中每个元组为 $(a, c, f, \\theta_{\\mathrm{i}}, \\theta_{\\mathrm{s}}, N)$:\n- 测试用例1（一般情况）：$(0.5, 343.0, 1000.0, 0.7, 2.2, 256)$。\n- 测试用例2（小障碍物，低频）：$(0.1, 343.0, 300.0, 0.0, 1.0, 128)$。\n- 测试用例3（角度重合边界条件）：$(0.3, 343.0, 800.0, 1.1, 1.1, 64)$。\n- 测试用例4（更高频率，更精细求积）：$(0.7, 343.0, 1500.0, 1.3, -0.5, 512)$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4},\\ldots]$），按测试用例排序，并且每个测试用例的两个值连续放置。输出必须是标准十进制表示法的浮点数。",
            "solution": "我们从散射场 $u(\\mathbf{x})$ 在 $\\mathbb{R}^{2} \\setminus \\overline{\\Omega}$ 中满足的标量亥姆霍兹方程 $\\Delta u(\\mathbf{x}) + k^{2} u(\\mathbf{x}) = 0$ 开始，其中 $\\Omega$ 是半径为 $a$ 的圆形障碍物，同时还需满足Sommerfeld辐射条件。在边界 $\\Gamma = \\partial \\Omega$ 上的软声边界条件是 $u_{\\mathrm{tot}}(\\mathbf{y}) = u(\\mathbf{y}) + u_{\\mathrm{inc}}(\\mathbf{y}) = 0$ 对所有 $\\mathbf{y} \\in \\Gamma$ 成立，这意味着在 $\\Gamma$ 上 $u(\\mathbf{y}) = -u_{\\mathrm{inc}}(\\mathbf{y})$，而 $\\partial u(\\mathbf{y}) / \\partial n(\\mathbf{y})$ 必须与亥姆霍兹方程的外部解一致。\n\n亥姆霍兹算子在二维空间中的基本解（格林函数）是 $G(\\mathbf{x},\\mathbf{y}) = \\frac{i}{4} H_{0}^{(1)}\\!\\big(k |\\mathbf{x} - \\mathbf{y}|\\big)$，其中 $H_{\\nu}^{(1)}$ 表示第一类 $\\nu$ 阶汉克尔函数。对于亥姆霍兹方程在由 $\\Gamma$ 界定的区域中的两个解 $u$ 和 $G$，格林第二恒等式给出了对于 $\\Gamma$ 外部的 $\\mathbf{x}$ 的Kirchhoff–Helmholtz表示，\n$$\nu(\\mathbf{x}) = \\int_{\\Gamma} \\left[ u(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} - \\frac{\\partial u(\\mathbf{y})}{\\partial n(\\mathbf{y})} G(\\mathbf{x},\\mathbf{y}) \\right] \\, \\mathrm{d}s(\\mathbf{y}),\n$$\n其中 $\\partial/\\partial n(\\mathbf{y})$ 表示在 $\\mathbf{y}$ 处的外法向导数。\n\n为推导远场模式，我们使用当 $|\\mathbf{x}| = r \\to \\infty$ 且 $\\hat{\\mathbf{x}} = \\mathbf{x}/r$ 固定时汉克尔函数 $H_{0}^{(1)}(k |\\mathbf{x} - \\mathbf{y}|)$ 的大距离渐近形式：\n$$\nH_{0}^{(1)}\\!\\big(k |\\mathbf{x} - \\mathbf{y}|\\big) \\sim \\sqrt{\\frac{2}{\\pi k r}} \\exp\\!\\big(i k r - i \\tfrac{\\pi}{4}\\big) \\exp\\!\\big(-i k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}\\big),\n$$\n以及\n$$\n\\frac{\\partial}{\\partial n(\\mathbf{y})} H_{0}^{(1)}\\!\\big(k |\\mathbf{x} - \\mathbf{y}|\\big) \\sim -i k \\big(\\hat{\\mathbf{x}} \\cdot \\mathbf{n}(\\mathbf{y})\\big) \\sqrt{\\frac{2}{\\pi k r}} \\exp\\!\\big(i k r - i \\tfrac{\\pi}{4}\\big) \\exp\\!\\big(-i k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}\\big).\n$$\n将这些代入Kirchhoff–Helmholtz表示，得到标准的远场形式\n$$\nu(\\mathbf{x}) \\sim \\sqrt{\\frac{2}{\\pi k r}} \\exp\\!\\big(i k r - i \\tfrac{\\pi}{4}\\big) \\, F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}),\n$$\n其中 $\\theta_{\\mathrm{s}}$ 是观测角，使得 $\\hat{\\mathbf{x}} = (\\cos \\theta_{\\mathrm{s}}, \\sin \\theta_{\\mathrm{s}})$，散射振幅 $F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})$ 为\n$$\nF(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}) = \\int_{\\Gamma} \\left[ \\frac{k}{4} \\, u(\\mathbf{y}) \\, \\big(\\hat{\\mathbf{x}} \\cdot \\mathbf{n}(\\mathbf{y})\\big) - \\frac{i}{4} \\, \\frac{\\partial u(\\mathbf{y})}{\\partial n(\\mathbf{y})} \\right] \\exp\\!\\big(-i k \\hat{\\mathbf{x}} \\cdot \\mathbf{y}\\big) \\, \\mathrm{d}s(\\mathbf{y}).\n$$\n\n对于半径为 $a$ 的圆形障碍物，用 $\\mathbf{y}(\\theta) = a (\\cos \\theta, \\sin \\theta)$（其中 $\\theta \\in [0, 2\\pi)$）参数化边界，外法向为 $\\mathbf{n}(\\theta) = (\\cos \\theta, \\sin \\theta)$，线元为 $\\mathrm{d}s = a \\, \\mathrm{d}\\theta$。入射平面波在极坐标 $(r,\\phi)$ 中为 $u_{\\mathrm{inc}}(r,\\phi) = \\exp\\!\\big(i k r \\cos(\\phi - \\theta_{\\mathrm{i}})\\big)$。软声边界条件 $u_{\\mathrm{tot}}(a,\\theta) = 0$ 给出散射场的边界迹 $u(a,\\theta) = -u_{\\mathrm{inc}}(a,\\theta) = -\\exp\\!\\big(i k a \\cos(\\theta - \\theta_{\\mathrm{i}})\\big)$。在 $r = a$ 处散射场的法向导数由圆柱谐波中的分离变量解得到。可以将 $r \\ge a$ 的散射场表示为一个辐射级数\n$$\nu(r,\\theta) = \\sum_{n=-\\infty}^{\\infty} A_{n} \\, H_{n}^{(1)}(k r) \\, e^{i n \\theta},\n$$\n并通过使用雅可比-安格展开来展开入射场，强制执行 $u(a,\\theta) = -u_{\\mathrm{inc}}(a,\\theta)$，这导致傅里叶系数\n$$\nA_{n} = - i^{n} \\, e^{-i n \\theta_{\\mathrm{i}}} \\, \\frac{J_{n}(k a)}{H_{n}^{(1)}(k a)},\n$$\n其中 $J_{n}$ 是第一类 $n$ 阶贝塞尔函数。将级数对 $r$ 求导，得到边界上的法向导数\n$$\n\\left.\\frac{\\partial u}{\\partial n}\\right|_{r=a} = \\left.\\frac{\\partial u}{\\partial r}\\right|_{r=a} = \\sum_{n=-\\infty}^{\\infty} A_{n} \\, k \\, \\frac{\\mathrm{d}}{\\mathrm{d}(k r)} H_{n}^{(1)}(k r) \\bigg|_{r=a} \\, e^{i n \\theta} = k \\sum_{n=-\\infty}^{\\infty} A_{n} \\, H_{n}^{(1)\\prime}(k a) \\, e^{i n \\theta},\n$$\n其中 $H_{n}^{(1)\\prime}$ 表示对其自变量的微分。\n\n已知 $u(a,\\theta)$ 和 $\\partial u/\\partial n (a,\\theta)$，散射振幅变为边界积分\n$$\nF(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}) = a \\int_{0}^{2\\pi} \\left[ \\frac{k}{4} \\, u(a,\\theta) \\, \\cos(\\theta - \\theta_{\\mathrm{s}}) - \\frac{i}{4} \\, \\left.\\frac{\\partial u}{\\partial r}\\right|_{r=a,\\theta} \\right] \\exp\\!\\big(-i k a \\cos(\\theta - \\theta_{\\mathrm{s}})\\big) \\, \\mathrm{d}\\theta,\n$$\n我们使用具有 $N$ 个等距点 $\\theta_{j} = 2\\pi j / N$（其中 $j = 0,1,\\dots,N-1$）的梯形法则对其进行数值计算。\n\n作为参考，软声圆柱体的精确远场散射振幅是通过取级数解中 $H_{n}^{(1)}(k r)$ 的大距离渐近得到的，产生\n$$\nF_{\\mathrm{exact}}(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}) = -\\sum_{n=-\\infty}^{\\infty} \\frac{J_{n}(k a)}{H_{n}^{(1)}(k a)} \\, e^{i n (\\theta_{\\mathrm{s}} - \\theta_{\\mathrm{i}})}.\n$$\n我们将所有级数截断到 $|n| \\le N_{\\mathrm{m}}$，其中 $N_{\\mathrm{m}}$ 根据 $k a$ 自适应选择（例如，$N_{\\mathrm{m}} = \\lceil k a \\rceil + \\text{margin}$，边际值适中），以达到数值收敛。\n\n互易介质中标量声学的互易原理指出，散射振幅满足 $F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}) = F(\\theta_{\\mathrm{i}},\\theta_{\\mathrm{s}})$。对于圆形软声圆柱体，精确级数表达式 $F_{\\mathrm{exact}}(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})$ 在 $(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})$ 中是明显对称的，因为交换后 $e^{i n (\\theta_{\\mathrm{s}} - \\theta_{\\mathrm{i}})}$ 变为 $e^{i n (\\theta_{\\mathrm{i}} - \\theta_{\\mathrm{s}})}$，并且对所有整数阶的求和保持相等。因此，用正确的边界密度计算的Kirchhoff–Helmholtz积分必须产生数值上互易的结果；任何微小的差异都量化了由于离散化和级数截断引起的数值误差。\n\n程序中实现的算法步骤：\n- 对每个测试用例，计算 $k = 2\\pi f / c$ 和 $k a$。\n- 根据 $k a$ 选择一个自适应的截断水平 $N_{\\mathrm{m}}$，以确保级数和的准确性。\n- 对于 $n = -N_{\\mathrm{m}}, \\dots, N_{\\mathrm{m}}$，使用 $A_{n} = - i^{n} e^{-i n \\theta_{\\mathrm{i}}} J_{n}(k a) / H_{n}^{(1)}(k a)$ 组装 $A_{n}$，并利用奇偶关系 $J_{-n}(x) = (-1)^{n} J_{n}(x)$ 和 $H_{-n}^{(1)}(x) = (-1)^{n} H_{n}^{(1)}(x)$ 来避免直接计算负阶。\n- 通过截断级数 $\\left.\\partial u/\\partial r\\right|_{r=a,\\theta} = k \\sum_{n=-N_{\\mathrm{m}}}^{N_{\\mathrm{m}}} A_{n} H_{n}^{(1)\\prime}(k a) e^{i n \\theta}$ 计算边界上的 $\\partial u/\\partial r$。\n- 形成 $u(a,\\theta) = -\\exp\\!\\big(i k a \\cos(\\theta - \\theta_{\\mathrm{i}})\\big)$，并使用 $N$ 点梯形求积法对边界上的 $F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})$ 的Kirchhoff–Helmholtz表达式进行数值积分。\n- 通过截断级数 $-\\sum_{n=-N_{\\mathrm{m}}}^{N_{\\mathrm{m}}} \\big[J_{n}(k a)/H_{n}^{(1)}(k a)\\big] e^{i n (\\theta_{\\mathrm{s}} - \\theta_{\\mathrm{i}})}$ 计算 $F_{\\mathrm{exact}}(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})$。\n- 对每个测试用例，报告绝对差 $\\big|F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}) - F_{\\mathrm{exact}}(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}})\\big|$ 和互易性偏差 $\\big|F(\\theta_{\\mathrm{s}},\\theta_{\\mathrm{i}}) - F(\\theta_{\\mathrm{i}},\\theta_{\\mathrm{s}})\\big|$。\n\n输出是包含一个用方括号括起来的逗号分隔浮点数列表的单行，每个测试用例有两个数字，按问题陈述中指定的顺序排列。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jv, hankel1, h1vp\n\ndef compute_series_truncation(ka: float) - int:\n    \"\"\"\n    Choose a truncation level for the cylindrical-harmonic series\n    based on ka to ensure accurate sums.\n    \"\"\"\n    # Rule of thumb: N_m ~ ka + margin; add extra safety for higher ka.\n    # Ensure at least a modest minimum.\n    return int(np.ceil(ka + 30.0)) if ka  5.0 else int(np.ceil(ka + 20.0))\n\ndef parity_factor(n: int) - int:\n    \"\"\"\n    Return (-1)^|n| for negative n, else 1.\n    \"\"\"\n    if n  0:\n        return -1 if (abs(n) % 2 == 1) else 1\n    else:\n        return 1\n\ndef assemble_coeffs_A_and_derivs(k: float, a: float, theta_i: float, Nm: int):\n    \"\"\"\n    Assemble A_n and Hn'(ka) for n in [-Nm, ..., Nm] using parity relations.\n    Returns:\n        n_vals: array of integers of shape (2*Nm+1,)\n        A: complex array of shape (2*Nm+1,)\n        Hp: complex array of shape (2*Nm+1,) representing H_n^(1)'(ka)\n    \"\"\"\n    ka = k * a\n    orders = np.arange(0, Nm + 1, dtype=int)\n    Jabs = jv(orders, ka)                   # J_n(ka) for n = 0\n    Habs = hankel1(orders, ka)              # H_n^(1)(ka) for n = 0\n    Hpabs = h1vp(orders, ka)                # d/dx H_n^(1)(x) at x=ka, orders = 0\n\n    n_vals = np.arange(-Nm, Nm + 1, dtype=int)\n    A = np.zeros_like(n_vals, dtype=np.complex128)\n    Hp = np.zeros_like(n_vals, dtype=np.complex128)\n\n    for idx, n in enumerate(n_vals):\n        m = abs(n)\n        s = parity_factor(n)  # parity factor for negative orders\n        Jn = s * Jabs[m]\n        Hn = s * Habs[m]\n        Hpn = s * Hpabs[m]\n        A[idx] = - (1j ** n) * np.exp(-1j * n * theta_i) * (Jn / Hn)\n        Hp[idx] = Hpn\n\n    return n_vals, A, Hp\n\ndef du_dr_on_boundary(k: float, a: float, theta_i: float, thetas: np.ndarray, Nm: int) - np.ndarray:\n    \"\"\"\n    Compute the normal derivative du/dr of the scattered field on r=a for all boundary angles 'thetas'.\n    Uses truncated series with coefficients A_n and H_n'(ka).\n    \"\"\"\n    n_vals, A, Hp = assemble_coeffs_A_and_derivs(k, a, theta_i, Nm)\n    # Build e^{i n theta} matrix: shape (num_n, num_theta)\n    exp_matrix = np.exp(1j * np.outer(n_vals, thetas))\n    # Sum over n: du/dr = k * sum_n A_n * Hn'(ka) * e^{i n theta}\n    du_dr = k * (A * Hp) @ exp_matrix\n    return du_dr  # shape (num_theta,)\n\ndef far_field_kirchhoff(a: float, k: float, theta_i: float, theta_s: float, N: int, Nm: int) - complex:\n    \"\"\"\n    Evaluate the far-field scattering amplitude F(theta_s, theta_i) via the Kirchhoff–Helmholtz integral\n    around the circular boundary using N quadrature points and Nm series modes for du/dr.\n    \"\"\"\n    # Boundary parameterization\n    thetas = np.linspace(0.0, 2.0 * np.pi, N, endpoint=False)\n    dtheta = 2.0 * np.pi / N\n\n    # Scattered field on boundary for sound-soft: u(a, theta) = -u_inc(a, theta)\n    u_b = -np.exp(1j * k * a * np.cos(thetas - theta_i))\n\n    # Normal derivative of scattered field on boundary via series\n    du_dr_b = du_dr_on_boundary(k, a, theta_i, thetas, Nm)\n\n    # Observation direction unit vector dot normal: cos(theta - theta_s)\n    cos_term = np.cos(thetas - theta_s)\n    # Plane-wave-like factor from far-field asymptotic\n    phase_factor = np.exp(-1j * k * a * np.cos(thetas - theta_s))\n\n    # Integrand for F (amplitude compatible with 2D far-field scaling)\n    integrand = a * ((k / 4.0) * u_b * cos_term - (1j / 4.0) * du_dr_b) * phase_factor\n\n    # Trapezoidal rule over [0, 2pi]\n    F = np.sum(integrand) * dtheta\n    return F\n\ndef far_field_exact(a: float, k: float, theta_i: float, theta_s: float, Nm: int) - complex:\n    \"\"\"\n    Compute the exact far-field scattering amplitude F(theta_s, theta_i) for a sound-soft circular cylinder\n    via truncated separation-of-variables series.\n    \"\"\"\n    ka = k * a\n    orders = np.arange(0, Nm + 1, dtype=int)\n    Jabs = jv(orders, ka)\n    Habs = hankel1(orders, ka)\n\n    # Sum over n from -Nm to Nm using parity to avoid direct negative-order evaluations\n    F = 0.0 + 0.0j\n    for n in range(-Nm, Nm + 1):\n        m = abs(n)\n        s = parity_factor(n)\n        Jn = s * Jabs[m]\n        Hn = s * Habs[m]\n        term = - (Jn / Hn) * np.exp(1j * n * (theta_s - theta_i))\n        F += term\n    return F\n\ndef run_test_case(a: float, c: float, f: float, theta_i: float, theta_s: float, N: int):\n    \"\"\"\n    Run a single test case and return:\n    - amplitude error: |F_KI - F_exact|\n    - reciprocity error: |F_KI(theta_s, theta_i) - F_KI(theta_i, theta_s)|\n    \"\"\"\n    k = 2.0 * np.pi * f / c\n    ka = k * a\n    Nm = compute_series_truncation(ka)\n\n    F_KI = far_field_kirchhoff(a, k, theta_i, theta_s, N, Nm)\n    F_exact = far_field_exact(a, k, theta_i, theta_s, Nm)\n\n    # Reciprocity check\n    F_KI_swapped = far_field_kirchhoff(a, k, theta_s, theta_i, N, Nm)\n\n    amp_err = abs(F_KI - F_exact)\n    recip_err = abs(F_KI - F_KI_swapped)\n    return amp_err, recip_err\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (a, c, f, theta_i, theta_s, N)\n    test_cases = [\n        (0.5, 343.0, 1000.0, 0.7, 2.2, 256),\n        (0.1, 343.0, 300.0, 0.0, 1.0, 128),\n        (0.3, 343.0, 800.0, 1.1, 1.1, 64),\n        (0.7, 343.0, 1500.0, 1.3, -0.5, 512),\n    ]\n\n    results = []\n    for a, c, f, theta_i, theta_s, N in test_cases:\n        amp_err, recip_err = run_test_case(a, c, f, theta_i, theta_s, N)\n        results.append(amp_err)\n        results.append(recip_err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}