{
    "hands_on_practices": [
        {
            "introduction": "在对声学信号进行任何数字分析之前，首要任务是确保采样过程本身不会破坏信号的频谱完整性。混叠是采样过程中的一个基本陷阱，如果采样率不足，高频分量会伪装成低频分量。此练习将引导您从采样定理的第一性原理出发，推导出一个确保目标频段内无混叠的精确采样率条件，这超越了教科书中简单的奈奎斯特准则，揭示了抗混叠滤波器带宽和目标分析频率之间的深刻联系。",
            "id": "4140893",
            "problem": "一个阵列麦克风记录了一个连续时间声压信号，记为 $p(t)$，其连续时间傅里叶变换为 $P_{c}(f)$。在采样之前，应用了一个理想的低通抗混叠滤波器，使得对于所有 $|f| > B$ 都有 $P_{c}(f) = 0$，其中 $B$ 是一个已知的有限带宽限制，满足 $B > 0$。然后以采样率 $f_{s}$ 对滤波后的信号进行均匀采样，生成 $p[n] = p(n/f_{s})$，其中 $n$ 为整数。随后，计算一个长度为 $N$ 的离散傅里叶变换 (DFT)，并通过快速傅里叶变换 (FFT) 算法进行评估，以获得在网格 $f_{k} = k f_{s}/N$（其中 $k$ 为整数）上的频谱估计。\n\n你的任务是确保在区间 $[0, f_{T}]$ 内的 DFT 幅度谱不受采样操作引入的混叠失真影响，其中目标频率 $f_{T}$ 满足 $0  f_{T} \\leq B$。仅从采样定理和均匀采样相应的频域复制特性出发，推导出一个条件，以保证由采样引入的频谱副本不会落入频率区间 $[0, f_{T}]$。根据此推导，确定能确保 DFT 内容在 $f_{T}$ 以下无混叠的最小采样率，记为 $f_{s,\\min}$。\n\n假设有限长度 DFT 中隐含的时间加窗不改变混叠条件（即，忽略泄露和加窗效应），并且频谱复制的唯一来源是采样过程本身。请以 $f_{T}$ 和 $B$ 的闭式解析表达式形式提供 $f_{s,\\min}$ 的最终答案。请以 $\\mathrm{Hz}$ 为单位表示你的答案。不需要数值近似。",
            "solution": "问题要求推导最小采样率 $f_{s,\\min}$，以保证频率区间 $[0, f_{T}]$ 不受混叠失真影响。该推导必须源于信号采样的基本原理。\n\n以速率 $f_{s}$ 对连续时间信号 $p(t)$ 进行均匀采样以产生离散序列 $p[n]$ 的过程，在频域中具有明确定义的影响。所得离散时间信号的傅里叶变换，称为离散时间傅里叶变换 (DTFT)，是原始连续时间信号傅里叶变换 $P_{c}(f)$ 的周期性求和。此关系由泊松求和公式给出：\n$$\nP_{d}(f) = f_s \\sum_{m=-\\infty}^{\\infty} P_{c}(f - m f_{s})\n$$\n其中 $P_{d}(f)$ 是序列 $p[n]$ 的 DTFT，$m$ 是一个整数索引。\n\n当 $m=0$ 时，项为 $f_s P_{c}(f)$，它是原始信号频谱的缩放版本。这被称为基带频谱。根据问题陈述，一个理想的抗混叠滤波器确保了对于所有频率 $|f| > B$，$P_{c}(f) = 0$。由于声压信号 $p(t)$ 是一个实值物理量，其傅里叶变换必须具有共轭对称性，即 $P_{c}(f) = P_{c}^{*}(-f)$，这意味着 $|P_{c}(f)| = |P_{c}(-f)|$。因此，原始信号的频谱支撑区被限制在区间 $[-B, B]$ 内。\n\n求和中 $m \\neq 0$ 的项代表由采样过程产生的频谱副本或混叠分量。第 $m$ 个副本 $f_s P_{c}(f - m f_{s})$ 是基带频谱的一个拷贝，在频率上移动了采样率的整数倍 $m f_{s}$。第 $m$ 个副本的频谱支撑区是区间 $[m f_{s} - B, m f_{s} + B]$。\n\n任务是确保目标频率区间 $[0, f_{T}]$ 仅包含来自基带频谱（$m=0$）的贡献，并且与频谱副本（$m \\neq 0$）没有任何重叠。为实现这一目标，我们必须对 $f_{s}$ 施加条件，使得任何副本的频谱支撑区都不与 $[0, f_{T}]$ 相交。最接近原点的副本最为关键，因为它们最先可能在低频范围内引起混叠。这些副本对应于 $m=1$ 和 $m=-1$。\n\n让我们分析这两个副本各自的条件：\n\n1.  **$m = 1$ 的副本：** 这个频谱副本以 $f = f_{s}$ 为中心，其支撑区为区间 $[f_{s} - B, f_{s} + B]$。为防止此副本混叠到区间 $[0, f_{T}]$ 中，其最低频率分量 $f_{s} - B$ 必须大于或等于目标区间的最高频率 $f_{T}$。这给出了条件：\n    $$\n    f_{s} - B \\geq f_{T}\n    $$\n    可以重写为：\n    $$\n    f_{s} \\geq B + f_{T}\n    $$\n\n2.  **$m = -1$ 的副本：** 这个频谱副本以 $f = -f_{s}$ 为中心，其支撑区为区间 $[-f_{s} - B, -f_{s} + B]$。为防止此副本混叠到区间 $[0, f_{T}]$ 中，其最高频率分量 $-f_{s} + B$ 必须小于或等于目标区间的最低频率 $0$。这给出了条件：\n    $$\n    -f_{s} + B \\leq 0\n    $$\n    可以重写为：\n    $$\n    f_{s} \\geq B\n    $$\n\n我们现在有两个必须同时满足的条件：\n$$\nf_{s} \\geq B + f_{T} \\quad \\text{and} \\quad f_{s} \\geq B\n$$\n问题陈述指明 $0  f_{T} \\leq B$。由于 $f_{T}$ 是严格正数，量 $B + f_{T}$ 总是严格大于 $B$。因此，条件 $f_{s} \\geq B + f_{T}$ 比 $f_{s} \\geq B$ 更为严格。任何满足 $f_{s} \\geq B + f_{T}$ 的 $f_{s}$ 值都将自动满足 $f_{s} \\geq B$。\n\n因此，保证区间 $[0, f_{T}]$ 不受任何副本混叠失真影响的单一综合条件是：\n$$\nf_{s} \\geq B + f_{T}\n$$\n问题要求满足此条件的最小采样率 $f_{s,\\min}$。当等式成立时达到最小值：\n$$\nf_{s,\\min} = B + f_{T}\n$$\n此表达式表示在所述理想条件下，确保 DFT 幅度谱在频率范围 $[0, f_{T}]$ 内无混叠所需的最小采样率。",
            "answer": "$$\\boxed{B + f_{T}}$$"
        },
        {
            "introduction": "离散傅里叶变换（DFT）的频率轴是离散的，这意味着它只能在特定的频率“点”或“箱”（bin）上提供信息。当一个正弦信号的真实频率恰好落在两个频率箱之间时，其能量会泄露到邻近的频率箱中，导致其在主瓣峰值处的幅度降低，这种现象被称为“扇形损失”（scalloping loss）。通过本练习，您将为最基础的矩形窗定量推导这种最坏情况下的损失，从而深刻理解有限长度观测对频谱分析造成的内在限制。",
            "id": "4140828",
            "problem": "一个声学实验室记录一个窄带平面波压力信号，其采样频率足够高，可以忽略混叠效应。在对 $N$ 个样本的有限观测中，数据与一个矩形分析窗（对于 $n=0,1,\\dots,N-1$ 等于 $1$，否则等于 $0$）相乘，然后通过离散傅里叶变换 (DFT) 计算频谱，其数值实现采用快速傅里叶变换 (FFT)。考虑传感器捕获的离散时间复正弦信号 $x[n] = A \\exp\\!\\big(j 2 \\pi (k_{0}+\\delta) n / N\\big)$，其中 $A \\in \\mathbb{C}$ 是复振幅，$k_{0} \\in \\mathbb{Z}$ 表示一个整数 DFT 频率仓索引，而 $\\delta \\in \\mathbb{R}$ 是一个小数频率仓偏移量。假设 $|\\delta| \\leq \\tfrac{1}{2}$，因此 $k_{0}$ 是最近的频率仓。\n\n将给定窗函数的扇形损失定义为：当正弦波频率处于半个频率仓偏移（$\\delta = \\tfrac{1}{2}$）时与位于频率仓中心（$\\delta = 0$）时，在最近频率仓 $k_{0}$ 处评估的 DFT 幅值之比，这是一个无量纲的振幅比。仅从 DFT 的定义\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-j \\frac{2\\pi k n}{N}\\right),\n$$\n出发，推导矩形窗扇形损失作为 $N$ 的函数的闭式解析表达式。然后确定其在 $N \\to \\infty$ 时的渐近值。将最终的扇形损失表示为一个精确的无量纲数（无单位）。最终报告的值无需四舍五入。",
            "solution": "推导从 DFT 的定义开始。信号为复正弦信号 $x[n] = A \\exp\\big(j 2 \\pi (k_{0}+\\delta) n / N\\big)$，在 $N$ 个样本上捕获并与矩形窗相乘。加窗意味着我们只考虑离散时间索引 $n$ 从 $0$ 到 $N-1$ 的信号。DFT $X[k]$ 由下式给出：\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi k n}{N}\\right)\n$$\n代入 $x[n]$ 的表达式：\n$$\nX[k] = \\sum_{n=0}^{N-1} A \\exp\\left(j \\frac{2\\pi (k_{0}+\\delta) n}{N}\\right) \\exp\\left(-j \\frac{2\\pi k n}{N}\\right)\n$$\n我们需在最近的整数频率仓索引 $k=k_0$ 处评估频谱。\n$$\nX[k_0] = \\sum_{n=0}^{N-1} A \\exp\\left(j \\frac{2\\pi (k_{0}+\\delta) n}{N}\\right) \\exp\\left(-j \\frac{2\\pi k_0 n}{N}\\right)\n$$\n合并指数项得到：\n$$\nX[k_0] = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi (k_0 + \\delta - k_0) n}{N}\\right) = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi \\delta n}{N}\\right)\n$$\n这是一个形式为 $\\sum_{n=0}^{N-1} r^n$ 的几何级数，其公比为 $r = \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)$。使用有限几何级数的求和公式 $\\frac{1-r^N}{1-r}$，我们得到：\n$$\nX[k_0] = A \\frac{1 - \\left(\\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)\\right)^N}{1 - \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)} = A \\frac{1 - \\exp(j 2\\pi \\delta)}{1 - \\exp\\left(j \\frac{2\\pi \\delta}{N}\\right)}\n$$\n为了求出幅值 $|X[k_0]|$，我们使用恒等式 $|1 - \\exp(j\\theta)| = | e^{j\\theta/2} (e^{-j\\theta/2} - e^{j\\theta/2}) | = |-2j e^{j\\theta/2} \\sin(\\frac{\\theta}{2})| = 2|\\sin(\\frac{\\theta}{2})|$。将此应用于分子和分母：\n$$\n|X[k_0]| = |A| \\frac{\\left|2 \\sin\\left(\\frac{2\\pi\\delta}{2}\\right)\\right|}{\\left|2 \\sin\\left(\\frac{2\\pi\\delta}{2N}\\right)\\right|} = |A| \\frac{|\\sin(\\pi\\delta)|}{|\\sin(\\frac{\\pi\\delta}{N})|}\n$$\n这是在频率仓 $k_0$ 处的幅值作为小数频率仓偏移 $\\delta$ 的函数的一般表达式。\n\n扇形损失定义为 $\\delta = \\frac{1}{2}$ 时的幅值与 $\\delta=0$ 时的幅值之比。我们分别评估这两种情况。\n\n情况1：频率仓中心频率，$\\delta=0$。\n在这种情况下，信号频率与一个 DFT 频率仓完全对齐。可以对上述表达式取 $\\delta \\to 0$ 的极限，但更直接的方法是回到求和式：\n$$\nX[k_0]|_{\\delta=0} = A \\sum_{n=0}^{N-1} \\exp\\left(j \\frac{2\\pi (0) n}{N}\\right) = A \\sum_{n=0}^{N-1} \\exp(0) = A \\sum_{n=0}^{N-1} 1 = AN\n$$\n因此，幅值为：\n$$\n|X[k_0]|_{\\delta=0} = |A|N\n$$\n\n情况2：半频率仓偏移，$\\delta=\\frac{1}{2}$。\n这代表了频率失配的最坏情况。我们将 $\\delta=\\frac{1}{2}$ 代入一般幅值表达式。由于 $|\\delta| \\leq \\frac{1}{2}$，这是最大偏移量。\n$$\n|X[k_0]|_{\\delta=1/2} = |A| \\frac{|\\sin(\\pi \\cdot \\frac{1}{2})|}{|\\sin(\\frac{\\pi \\cdot \\frac{1}{2}}{N})|} = |A| \\frac{|\\sin(\\frac{\\pi}{2})|}{|\\sin(\\frac{\\pi}{2N})|}\n$$\n由于 $\\sin(\\frac{\\pi}{2}) = 1$，且对于任何 $N \\geq 1$，都有 $\\frac{\\pi}{2N} \\in (0, \\frac{\\pi}{2}]$，因此 $\\sin(\\frac{\\pi}{2N})$ 是正数。所以，绝对值符号可以去掉。\n$$\n|X[k_0]|_{\\delta=1/2} = |A| \\frac{1}{\\sin(\\frac{\\pi}{2N})}\n$$\n扇形损失 $S_L$ 是这两个幅值的比率：\n$$\nS_L(N) = \\frac{|X[k_0]|_{\\delta=1/2}}{|X[k_0]|_{\\delta=0}} = \\frac{|A| \\frac{1}{\\sin(\\frac{\\pi}{2N})}}{|A|N} = \\frac{1}{N \\sin(\\frac{\\pi}{2N})}\n$$\n这就是矩形窗的扇形损失作为 $N$ 的函数的闭式表达式。\n\n最后一步是确定当 $N \\to \\infty$ 时的渐近值。我们计算以下极限：\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} S_L(N) = \\lim_{N\\to\\infty} \\frac{1}{N \\sin(\\frac{\\pi}{2N})}\n$$\n当 $N \\to \\infty$ 时，正弦函数的自变量 $\\theta = \\frac{\\pi}{2N}$ 趋近于 $0$。我们使用基本三角函数极限 $\\lim_{\\theta\\to 0} \\frac{\\sin(\\theta)}{\\theta} = 1$。我们重新整理表达式以利用此极限。\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} \\frac{1}{N \\sin(\\frac{\\pi}{2N})} = \\lim_{N\\to\\infty} \\frac{1}{N \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N} \\cdot \\frac{\\pi}{2N}}\n$$\n$$\nS_{L, \\infty} = \\lim_{N\\to\\infty} \\frac{1}{\\frac{N\\pi}{2N} \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N}} = \\lim_{N\\to\\infty} \\frac{1}{\\frac{\\pi}{2} \\cdot \\frac{\\sin(\\pi/2N)}{\\pi/2N}}\n$$\n由于当 $N \\to \\infty$ 时 $\\frac{\\pi}{2N} \\to 0$，因此项 $\\frac{\\sin(\\pi/2N)}{\\pi/2N}$ 趋近于 $1$。\n$$\nS_{L, \\infty} = \\frac{1}{\\frac{\\pi}{2} \\cdot 1} = \\frac{2}{\\pi}\n$$\n矩形窗扇形损失的渐近值为 $\\frac{2}{\\pi}$。这个无量纲值约等于 $0.6366$，对应约 $3.92$ 分贝的损失。",
            "answer": "$$\n\\boxed{\\frac{2}{\\pi}}\n$$"
        },
        {
            "introduction": "正如上一个练习所揭示的，频谱泄露是DFT分析中的一个固有挑战，它不仅降低了幅度的准确性，也限制了频率估计的精度。然而，我们可以通过巧妙的后处理技术来突破DFT频率分辨率的限制。此练习将向您介绍一种强大且广泛应用的方法——对频谱峰值进行二次多项式插值——以实现亚频率箱（sub-bin）精度的频率估计，将理论上的局限性转化为工程上的可解问题。",
            "id": "4140831",
            "problem": "一个声学实验室使用一个经过校准的窄带源来产生一个稳态正弦压力音，其真实频率为 $f_{0}$，该频率不是离散傅里叶变换 (DFT) 频率仓间距的整数倍。一个单通道麦克风信号以采样率 $f_{s}$ 采集 $N$ 个样本，在用快速傅里叶变换 (FFT) 算法计算 DFT 之前，先与一个汉宁窗 (Hann window) 相乘。假设在无噪声的单音条件下，加窗后的幅度谱在主峰值附近是局部平滑且单峰的。\n\n给定以下参数和观测值：\n- 采样率 $f_{s} = 48000 \\ \\mathrm{Hz}$。\n- DFT 长度 $N = 4096$。\n- 真实音调频率 $f_{0} = 1000.73 \\ \\mathrm{Hz}$。\n- 幅度谱 $|X[k]|$ 经过归一化，使得主频率仓的幅度为 $1.0$。在峰值频率仓 $k_{p}$ 附近，观测到的三点邻域幅度为\n  $|X[k_{p}-1]| = 0.50$, $|X[k_{p}]| = 1.00$, 和 $|X[k_{p}+1]| = 0.94$。\n\n仅从离散傅里叶变换的定义及其频率仓间距的含义出发，按以下步骤操作：\n1. 确定与 $f_{0}$ 对应的最近整数频率仓索引 $k_{\\mathrm{near}}$，以及将 $f_{0}$ 量化到该频率仓中心频率时产生的有符号频率估计误差 $e_{0}$。使用由 $f_{s}$ 和 $N$ 决定的频率仓间距。\n2. 假设幅度谱在其最大值附近的邻域内可以用关于频率仓索引的二阶多项式进行良好的局部近似，通过对三个相邻的幅度样本 $\\{|X[k_{p}-1]|, |X[k_{p}]|, |X[k_{p}+1]|\\}$ 进行二次拟合，推导出子频率仓峰值位置的估计值。根据此子频率仓位置，构建一个校正后的频率估计值 $\\hat{f}$。\n\n仅报告最终的校正频率估计值 $\\hat{f}$，以 $\\mathrm{Hz}$ 为单位，并四舍五入到六位有效数字。",
            "solution": "**1. 计算频率分辨率并确定最近的频率仓**\n\nDFT的频率仓间距（频率分辨率）为：\n$$ \\Delta f = \\frac{f_s}{N} = \\frac{48000 \\text{ Hz}}{4096} = 11.71875 \\text{ Hz} $$\n真实频率 $f_0$ 对应的非整数频率仓索引为 $k_0 = \\frac{f_0}{\\Delta f} = \\frac{1000.73}{11.71875} \\approx 85.395$。因此，最近的整数频率仓索引 $k_{\\mathrm{near}} = 85$。该仓的中心频率为 $f_{85} = 85 \\times \\Delta f = 996.09375 \\text{ Hz}$。将 $f_0$ 量化到该仓中心产生的有符号频率估计误差为 $e_0 = f_0 - f_{85} = 1000.73 - 996.09375 = 4.63625 \\text{ Hz}$。\n\n**2. 通过二次插值估计子频率仓峰值**\n\n通过对峰值频率仓 $k_p=85$ 及其相邻的三个幅度样本 $\\{|X[k_p-1]|, |X[k_p]|, |X[k_p+1]|\\} = \\{0.50, 1.00, 0.94\\}$ 进行二次插值，可以得到峰值位置相对于中心仓 $k_p$ 的小数偏移量 $\\delta$：\n$$ \\delta = \\frac{|X[k_p-1]| - |X[k_p+1]|}{2(|X[k_p-1]| + |X[k_p+1]| - 2|X[k_p]|)} $$\n代入观测到的幅度值：\n$$ \\delta = \\frac{0.50 - 0.94}{2(0.50 + 0.94 - 2 \\cdot 1.00)} = \\frac{-0.44}{2(1.44 - 2.00)} = \\frac{-0.44}{2(-0.56)} = \\frac{0.44}{1.12} = \\frac{11}{28} \\approx 0.392857 $$\n校正后的频率估计值 $\\hat{f}$ 由下式给出：\n$$ \\hat{f} = (k_p + \\delta) \\Delta f = (85 + \\frac{11}{28}) \\times 11.71875 \\text{ Hz} $$\n$$ \\hat{f} = 85 \\times 11.71875 + \\frac{11}{28} \\times 11.71875 = 996.09375 + 4.6037946... = 1000.69754... \\text{ Hz} $$\n根据要求，将结果四舍五入到六位有效数字，得到 $\\hat{f} = 1000.70 \\text{ Hz}$。",
            "answer": "$$\\boxed{1000.70}$$"
        }
    ]
}