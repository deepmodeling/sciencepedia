{
    "hands_on_practices": [
        {
            "introduction": "The fundamental relationship for sound speed in an ideal gas, often expressed as $c = \\sqrt{\\gamma R T}$, provides a powerful starting point for acoustic analysis. This practice challenges you to apply this principle to a realistic environment by deriving and computing the sound speed profile in the Earth's lower atmosphere (). Starting from first principles like hydrostatic balance, you will model the effects of altitude-dependent temperature and pressure under the International Standard Atmosphere (ISA) model, and quantify the subtle but important influence of humidity on acoustic propagation.",
            "id": "4122536",
            "problem": "You are asked to derive, implement, and evaluate the speed of sound in air as a function of altitude under International Standard Atmosphere (ISA) conditions using a thermodynamically consistent equation of state and the definition of sound speed from first principles, then systematically quantify deviations introduced by humidity and variable gas composition. Your derivation and implementation must start from fundamental laws and definitions only, without shortcut formulas being provided in the problem statement. The task must be executed in the lower troposphere under a standard lapse-rate model.\n\nRequirements and assumptions:\n- Work within the altitude range $0 \\le z \\le 11000$ measured in meters, where the ISA adopts a constant temperature lapse rate.\n- Use hydrostatic balance, ideal gas behavior, and the thermodynamic definition of sound speed at constant entropy to derive the dry-air expression and its humid-air extension.\n- Model water vapor as an ideal gas and air as a binary ideal gas mixture of dry air and water vapor with composition set by relative humidity (RH).\n- Compute the saturation vapor pressure of water as a function of temperature using a well-tested empirical correlation. You may select a correlation of comparable accuracy to widely used standards; your solution must clearly state and implement the chosen correlation and ensure unit consistency.\n- Adopt the following constants (treated as well-tested values):\n  - Standard gravitational acceleration $g_0 = 9.80665$ in $\\mathrm{m/s^2}$.\n  - Sea-level temperature $T_0 = 288.15$ in $\\mathrm{K}$.\n  - Sea-level pressure $p_0 = 101325$ in $\\mathrm{Pa}$.\n  - Tropospheric lapse rate $L = -0.0065$ in $\\mathrm{K/m}$.\n  - Specific gas constant for dry air $R_d = 287.052$ in $\\mathrm{J/(kg\\cdot K)}$.\n  - Specific gas constant for water vapor $R_v = 461.522$ in $\\mathrm{J/(kg\\cdot K)}$.\n  - Constant-pressure specific heat for dry air $c_{p,d} = 1004.685$ in $\\mathrm{J/(kg\\cdot K)}$.\n  - Constant-pressure specific heat for water vapor $c_{p,v} = 1859.0$ in $\\mathrm{J/(kg\\cdot K)}$.\n- Limit attention to $z \\le 11000$ so that temperature is $T(z) = T_0 + L z$ and pressure is obtained by consistent integration of hydrostatic balance with ideal gas behavior for the dry reference atmosphere.\n\nTasks:\n1. Starting from the thermodynamic definition of speed of sound, the ideal gas equation of state, hydrostatic balance, and the ISA temperature structure, derive a dry-air expression for the speed of sound as a function of altitude $z$ in meters. Express the final speed of sound in meters per second.\n2. Extend the derivation to a humid mixture of dry air and water vapor, treating both as ideal gases and using mixture rules appropriate for specific heats and specific gas constants. Use relative humidity to determine the water vapor partial pressure via an empirically accurate saturation vapor pressure correlation. Derive the mixture sound speed at altitude $z$ in meters and relative humidity $\\mathrm{RH}$ (decimal fraction in $[0,1]$). Express the final speed of sound in meters per second.\n3. Implement your derivations in a complete, runnable program that:\n   - Computes the ISA temperature $T(z)$ in Kelvin and pressure $p(z)$ in Pascal for $0 \\le z \\le 11000$.\n   - Computes the water vapor saturation vapor pressure $e_s(T)$ in Pascal from temperature in Kelvin using a correlation of Arden Buck type or equivalent accuracy, applying the correlation over liquid water for $T \\ge 273.15\\,\\mathrm{K}$ and over ice for $T  273.15\\,\\mathrm{K}$.\n   - Computes the vapor partial pressure $e = \\mathrm{RH} \\cdot e_s(T)$ in Pascal, enforcing $0 \\le e  p(z)$.\n   - Computes the mixing ratio $r = \\epsilon \\, e/(p-e)$ with $\\epsilon = R_d/R_v$, and the mass fractions $Y_v = r/(1+r)$ and $Y_d = 1 - Y_v$.\n   - Computes mixture properties $R_{\\mathrm{mix}} = Y_d R_d + Y_v R_v$, $c_{p,\\mathrm{mix}} = Y_d c_{p,d} + Y_v c_{p,v}$, and $c_{v,\\mathrm{mix}} = c_{p,\\mathrm{mix}} - R_{\\mathrm{mix}}$, then evaluates the speed of sound in the mixture at $(z,\\mathrm{RH})$.\n   - Computes the dry-air speed of sound using dry-air properties for the same $T(z)$.\n   - Returns, for each test case, a list with two floats: dry-air speed of sound and humid-air speed of sound at the specified $(z,\\mathrm{RH})$, each in $\\mathrm{m/s}$, rounded to three decimals.\n\nPhysical units and output specification:\n- Altitude $z$ is in meters.\n- Temperature $T$ must be computed in Kelvin.\n- Pressure $p$ and all partial pressures must be in Pascal.\n- The speed of sound must be expressed in $\\mathrm{m/s}$, rounded to three decimals.\n- Relative humidity $\\mathrm{RH}$ must be a decimal fraction in $[0,1]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain one entry per test case, where each entry is the two-element list described above. For example, the printed output should look like $[[c_{1,\\mathrm{dry}},c_{1,\\mathrm{humid}}],[c_{2,\\mathrm{dry}},c_{2,\\mathrm{humid}}],\\ldots]$ with numerical values in place of the symbols.\n\nTest suite:\nUsing the above model and constants, evaluate the following test cases to exercise normal operation, humidity extremes, and boundary conditions:\n- Case $1$: $z = 0$, $\\mathrm{RH} = 0.0$.\n- Case $2$: $z = 0$, $\\mathrm{RH} = 0.9$.\n- Case $3$: $z = 5000$, $\\mathrm{RH} = 1.0$.\n- Case $4$: $z = 11000$, $\\mathrm{RH} = 0.5$.\n\nYour program must compute and print $[[c_{1,\\mathrm{dry}},c_{1,\\mathrm{humid}}],[c_{2,\\mathrm{dry}},c_{2,\\mathrm{humid}}],[c_{3,\\mathrm{dry}},c_{3,\\mathrm{humid}}],[c_{4,\\mathrm{dry}},c_{4,\\mathrm{humid}}]]$ with each $c$ in $\\mathrm{m/s}$, rounded to three decimals.",
            "solution": "The problem is assessed as valid, as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. The problem requires the derivation and implementation of the speed of sound in air as a function of altitude, for both dry and humid conditions, based on first principles of thermodynamics and fluid mechanics within the International Standard Atmosphere (ISA) model.\n\nThe solution proceeds in three main parts:\n1. Derivation of the speed of sound in dry air as a function of altitude.\n2. Derivation of the pressure-altitude relation in the ISA model.\n3. Extension of the derivation to humid air, accounting for mixture effects.\n\n**1. Speed of Sound in an Ideal Gas**\n\nThe speed of sound, $c$, is defined as the propagation speed of an infinitesimal pressure disturbance through a medium. For a fluid, it is given by the square root of the isentropic bulk modulus, which is expressed as the partial derivative of pressure with respect to density at constant entropy $s$:\n$$\nc^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s\n$$\nFor an ideal gas, the equation of state is $p = \\rho R T$, where $p$ is the pressure, $\\rho$ is the density, $T$ is the absolute temperature, and $R$ is the specific gas constant.\nAn isentropic (reversible and adiabatic) process for an ideal gas follows the relation $p \\rho^{-\\gamma} = \\text{constant}$, where $\\gamma = c_p/c_v$ is the heat capacity ratio, with $c_p$ and $c_v$ being the specific heats at constant pressure and constant volume, respectively.\n\nFrom $p = K \\rho^\\gamma$ for some constant $K$, we can take the derivative:\n$$\n\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\gamma K \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho^\\gamma} \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho}\n$$\nSubstituting this into the definition of sound speed and using the ideal gas law ($p/\\rho = RT$):\n$$\nc^2 = \\gamma \\frac{p}{\\rho} = \\gamma R T\n$$\nThus, the speed of sound in an ideal gas is:\n$$\nc = \\sqrt{\\gamma R T}\n$$\nThis fundamental result shows that for a given ideal gas (fixed $\\gamma$ and $R$), the speed of sound depends only on the absolute temperature $T$.\n\n**2. Application to Dry Air in the ISA Troposphere**\n\nFor dry air, we use the specific gas constant for dry air, $R_d$, and the heat capacity ratio for dry air, $\\gamma_d$. The problem provides $R_d = 287.052 \\, \\mathrm{J/(kg\\cdot K)}$ and the constant-pressure specific heat $c_{p,d} = 1004.685 \\, \\mathrm{J/(kg\\cdot K)}$.\nFor an ideal gas, Mayer's relation holds: $c_{p,d} - c_{v,d} = R_d$. We can find $c_{v,d}$:\n$$\nc_{v,d} = c_{p,d} - R_d = 1004.685 - 287.052 = 717.633 \\, \\mathrm{J/(kg\\cdot K)}\n$$\nThe heat capacity ratio for dry air is then:\n$$\n\\gamma_d = \\frac{c_{p,d}}{c_{v,d}} = \\frac{1004.685}{717.633} \\approx 1.4000\n$$\nThe International Standard Atmosphere (ISA) model defines a linear temperature profile in the troposphere (for altitude $z \\le 11000 \\, \\mathrm{m}$):\n$$\nT(z) = T_0 + L z\n$$\nwhere $T_0 = 288.15 \\, \\mathrm{K}$ is the sea-level temperature and $L = -0.0065 \\, \\mathrm{K/m}$ is the tropospheric lapse rate.\nThe speed of sound in dry air as a function of altitude $z$ is therefore:\n$$\nc_d(z) = \\sqrt{\\gamma_d R_d T(z)} = \\sqrt{\\gamma_d R_d (T_0 + L z)}\n$$\n\n**3. ISA Pressure Profile**\n\nTo analyze humid air, we need the total atmospheric pressure $p(z)$. This is found by integrating the hydrostatic balance equation, assuming the atmosphere is in equilibrium:\n$$\n\\frac{dp}{dz} = -\\rho g_0\n$$\nwhere $g_0 = 9.80665 \\, \\mathrm{m/s^2}$ is the standard gravitational acceleration. The ISA model uses the dry air equation of state, $\\rho = p/(R_d T)$, to define the reference pressure profile. Substituting this and the temperature profile $T(z) = T_0 + Lz$ into the hydrostatic equation:\n$$\n\\frac{dp}{dz} = - \\frac{p g_0}{R_d (T_0 + L z)} \\implies \\frac{dp}{p} = -\\frac{g_0}{R_d L} \\frac{L \\, dz}{T_0 + L z}\n$$\nIntegrating from sea level ($z=0$, $p=p_0=101325 \\, \\mathrm{Pa}$) to an altitude $z$:\n$$\n\\int_{p_0}^{p(z)} \\frac{dp'}{p'} = -\\frac{g_0}{R_d L} \\int_0^z \\frac{L \\, dz'}{T_0 + L z'}\n$$\n$$\n\\ln\\left(\\frac{p(z)}{p_0}\\right) = -\\frac{g_0}{R_d L} \\ln\\left(\\frac{T_0 + L z}{T_0}\\right) = \\ln\\left[ \\left(\\frac{T(z)}{T_0}\\right)^{-g_0 / (R_d L)} \\right]\n$$\nThis yields the standard ISA pressure-altitude relation for the troposphere:\n$$\np(z) = p_0 \\left( \\frac{T(z)}{T_0} \\right)^{-g_0 / (R_d L)} = p_0 \\left(1 + \\frac{L z}{T_0}\\right)^{-g_0 / (R_d L)}\n$$\n\n**4. Speed of Sound in Humid Air**\n\nHumid air is a mixture of dry air and water vapor. We model it as a binary ideal gas mixture. The speed of sound in the mixture is given by $c_h = \\sqrt{\\gamma_{\\mathrm{mix}} R_{\\mathrm{mix}} T(z)}$. We must determine the mixture properties $R_{\\mathrm{mix}}$ and $\\gamma_{\\mathrm{mix}}$.\n\nThe composition of the mixture is determined by the relative humidity, $\\mathrm{RH}$, which relates the partial pressure of water vapor, $e$, to the saturation vapor pressure, $e_s(T)$:\n$$\ne = \\mathrm{RH} \\cdot e_s(T)\n$$\nThe saturation vapor pressure $e_s$ is a strong function of temperature. As per the problem specification, we use an accurate empirical correlation of the Arden Buck type. The 1996 Buck equations are chosen for their accuracy. The pressure is in Pascals, and temperature $T$ is in Kelvin. Let $T_C = T - 273.15$ be the temperature in Celsius.\n\nFor $T \\ge 273.15 \\, \\mathrm{K}$ (saturation over liquid water):\n$$\ne_s(T) = 611.21 \\exp \\left( \\frac{(18.678 - T_C/234.5) T_C}{T_C + 257.14} \\right)\n$$\nFor $T  273.15 \\, \\mathrm{K}$ (saturation over ice):\n$$\ne_s(T) = 611.15 \\exp \\left( \\frac{(23.036 - T_C/333.7) T_C}{T_C + 279.82} \\right)\n$$\nThe partial pressure of dry air is $p_d = p(z) - e$. We define the mixing ratio, $r$, as the mass of water vapor per unit mass of dry air:\n$$\nr = \\frac{m_v}{m_d} = \\frac{\\rho_v}{\\rho_d} = \\frac{e/(R_v T)}{(p_d)/(R_d T)} = \\frac{e/(R_v T)}{(p-e)/(R_d T)} = \\frac{R_d}{R_v} \\frac{e}{p-e}\n$$\nLetting $\\epsilon = R_d/R_v = 287.052 / 461.522 \\approx 0.622$, we have $r = \\epsilon \\frac{e}{p-e}$.\n\nThe mass fractions of water vapor ($Y_v$) and dry air ($Y_d$) are:\n$$\nY_v = \\frac{m_v}{m_d + m_v} = \\frac{m_v/m_d}{1 + m_v/m_d} = \\frac{r}{1+r}\n$$\n$$\nY_d = \\frac{m_d}{m_d + m_v} = \\frac{1}{1 + m_v/m_d} = \\frac{1}{1+r} = 1 - Y_v\n$$\nThe mixture properties are found by mass-fraction weighting:\n$$\nR_{\\mathrm{mix}} = Y_d R_d + Y_v R_v\n$$\n$$\nc_{p,\\mathrm{mix}} = Y_d c_{p,d} + Y_v c_{p,v}\n$$\nwhere $R_v = 461.522 \\, \\mathrm{J/(kg\\cdot K)}$ and $c_{p,v} = 1859.0 \\, \\mathrm{J/(kg\\cdot K)}$ are given.\nUsing Mayer's relation for the mixture, $c_{v,\\mathrm{mix}} = c_{p,\\mathrm{mix}} - R_{\\mathrm{mix}}$. The heat capacity ratio for the mixture is:\n$$\n\\gamma_{\\mathrm{mix}} = \\frac{c_{p,\\mathrm{mix}}}{c_{v,\\mathrm{mix}}} = \\frac{c_{p,\\mathrm{mix}}}{c_{p,\\mathrm{mix}} - R_{\\mathrm{mix}}}\n$$\nFinally, the speed of sound in humid air at altitude $z$ and relative humidity $\\mathrm{RH}$ is:\n$$\nc_h(z, \\mathrm{RH}) = \\sqrt{\\gamma_{\\mathrm{mix}} R_{\\mathrm{mix}} T(z)}\n$$\nThis expression, along with the preceding steps, provides the complete model for computation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the speed of sound in dry and humid air under ISA conditions\n    based on derivations from first principles.\n    \"\"\"\n\n    # --- Givens: Constants and ISA Parameters ---\n    g0 = 9.80665      # Standard gravitational acceleration [m/s^2]\n    T0 = 288.15       # Sea-level standard temperature [K]\n    p0 = 101325.0     # Sea-level standard pressure [Pa]\n    L = -0.0065       # Tropospheric lapse rate [K/m]\n    R_d = 287.052     # Specific gas constant for dry air [J/(kg.K)]\n    R_v = 461.522     # Specific gas constant for water vapor [J/(kg.K)]\n    cp_d = 1004.685   # Constant-pressure specific heat for dry air [J/(kg.K)]\n    cp_v = 1859.0     # Constant-pressure specific heat for water vapor [J/(kg.K)]\n    \n    # --- Derived Dry Air Properties ---\n    # Heat capacity at constant volume for dry air\n    cv_d = cp_d - R_d\n    # Heat capacity ratio for dry air\n    gamma_d = cp_d / cv_d\n    \n    # --- Helper Functions ---\n    def get_isa_temp(z):\n        \"\"\"Computes ISA temperature at altitude z.\"\"\"\n        return T0 + L * z\n\n    def get_isa_pressure(z, temp):\n        \"\"\"Computes ISA pressure at altitude z.\"\"\"\n        # This formula is only valid for L != 0\n        return p0 * (temp / T0)**(-g0 / (R_d * L))\n\n    def get_saturation_vapor_pressure(T):\n        \"\"\"\n        Computes saturation vapor pressure using the Arden Buck (1996) equations.\n        T is temperature in Kelvin. Returns pressure in Pascals.\n        \"\"\"\n        T_C = T - 273.15  # Temperature in Celsius\n\n        if T_C = 0:\n            # Saturation vapor pressure over liquid water\n            es = 611.21 * np.exp((18.678 - T_C / 234.5) * (T_C / (257.14 + T_C)))\n        else:\n            # Saturation vapor pressure over ice\n            es = 611.15 * np.exp((23.036 - T_C / 333.7) * (T_C / (279.82 + T_C)))\n        return es\n\n    def calculate_sound_speeds(z, RH):\n        \"\"\"\n        Calculates and returns the speed of sound for dry and humid air.\n        z: altitude [m]\n        RH: relative humidity [0, 1]\n        \"\"\"\n        # --- ISA Conditions at Altitude z ---\n        T_z = get_isa_temp(z)\n        p_z = get_isa_pressure(z, T_z)\n\n        # --- Task 1: Dry Air Sound Speed ---\n        c_dry = np.sqrt(gamma_d * R_d * T_z)\n        \n        # --- Task 2: Humid Air Sound Speed ---\n        if RH == 0.0:\n            c_humid = c_dry\n        else:\n            # Calculate vapor pressure\n            e_s = get_saturation_vapor_pressure(T_z)\n            e = RH * e_s\n            \n            # Constraint check: vapor pressure cannot exceed total pressure\n            if e = p_z:\n                # This physical state implies 100% water vapor or supersaturation\n                # in a way that displaces all air, which is not the model's intent.\n                # For this problem, we cap 'e' to be slightly less than 'p_z'\n                # to avoid division by zero, though test cases do not trigger this.\n                e = p_z * 0.999999\n\n            # Calculate mixing ratio\n            epsilon = R_d / R_v\n            # Avoid division by zero if p_z == e\n            if p_z - e = 0:\n                # Under this extreme, physically unlikely condition, the atmosphere is \n                # pure water vapor. We'll model it as such.\n                r = np.inf\n            else:\n                r = epsilon * e / (p_z - e)\n\n            # Calculate mass fractions\n            if np.isinf(r):\n                Y_v = 1.0\n            else:\n                Y_v = r / (1.0 + r)\n            Y_d = 1.0 - Y_v\n\n            # Calculate mixture properties\n            R_mix = Y_d * R_d + Y_v * R_v\n            cp_mix = Y_d * cp_d + Y_v * cp_v\n            cv_mix = cp_mix - R_mix\n            gamma_mix = cp_mix / cv_mix\n            \n            c_humid = np.sqrt(gamma_mix * R_mix * T_z)\n            \n        return [round(c_dry, 3), round(c_humid, 3)]\n\n    # --- Test Suite ---\n    test_cases = [\n        (0.0, 0.0),       # Case 1: z = 0, RH = 0.0\n        (0.0, 0.9),       # Case 2: z = 0, RH = 0.9\n        (5000.0, 1.0),    # Case 3: z = 5000, RH = 1.0\n        (11000.0, 0.5)    # Case 4: z = 11000, RH = 0.5\n    ]\n\n    results = []\n    for z, RH in test_cases:\n        result = calculate_sound_speeds(z, RH)\n        results.append(result)\n\n    # --- Print Final Output ---\n    # The str() of a list is used to get the inner bracket formatting.\n    # The top-level format is a string of these list strings, comma-separated.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The ideal gas model is often simplified by assuming constant heat capacities, a \"calorically perfect\" gas, which is accurate only over limited temperature ranges. This practice delves into the more physically realistic \"thermally perfect\" gas model, where molecular vibrations at high temperatures cause heat capacities to vary significantly (). By calculating the sound speed in a high-temperature gas mixture, you will explore the physical origins of acoustic dispersion and appreciate the critical distinction between equilibrium and \"frozen\" sound speeds, a key concept in high-speed aerodynamics and combustion acoustics.",
            "id": "4122519",
            "problem": "A binary, ideal gas mixture is composed of oxygen $\\mathrm{O_2}$ (species $A$) and argon $\\mathrm{Ar}$ (species $B$) at thermodynamic equilibrium with no dissociation and no chemical reactions. The mixture is spatially uniform with mole fractions $y_A = 0.4$ and $y_B = 0.6$, and its thermodynamic state is characterized by a uniform temperature $T = 1200~\\mathrm{K}$. The universal gas constant is $R_u = 8.314462618~\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. The molar masses are $M_A = 31.998 \\times 10^{-3}~\\mathrm{kg\\,mol^{-1}}$ and $M_B = 39.948 \\times 10^{-3}~\\mathrm{kg\\,mol^{-1}}$. The species molar isobaric heat capacities are specified as follows:\n- For oxygen, a temperature-dependent model capturing vibrational excitation near $T \\sim 1000~\\mathrm{K}$:\n$$\nc_{p,A}(T) = 28.11 + 3.5\\left(\\frac{T}{1000}\\right) + 4.0\\,\\frac{\\left(\\frac{T}{1000}\\right)^{2}}{1 + \\left(\\frac{T}{1800}\\right)^{2}} \\quad \\text{J\\,mol}^{-1}\\,\\text{K}^{-1}.\n$$\n- For argon, which is monatomic and has nearly temperature-independent heat capacities in this range:\n$$\nc_{p,B}(T) = \\frac{5}{2}\\,R_u \\quad \\text{J\\,mol}^{-1}\\,\\text{K}^{-1}.\n$$\n\nUsing the definition of the small-signal acoustic sound speed as the isentropic derivative and only fundamental thermodynamic identities and the ideal gas law, derive an expression for the local sound speed $c$ in terms of the mixture heat capacities and mixture gas constant. Then, compute the numerical value of $c$ for the given state using mole-fraction averaging of the molar heat capacities to obtain mixture $c_p$ and $c_v$ evaluated at $T = 1200~\\mathrm{K}$. Assume internal modes are in thermodynamic equilibrium and that the mixture behaves as an ideal gas.\n\nFinally, provide a brief discussion that critically examines the limitations of simple mole-fraction averaging of $c_p$ and $c_v$ in computing $c$ when one component exhibits strong temperature dependence in its heat capacities.\n\nRound your final numerical value of $c$ to four significant figures. Express the sound speed in meters per second (m/s).",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Problem Validation**\n\nThe givens are extracted verbatim:\n- A binary, ideal gas mixture of oxygen $\\mathrm{O_2}$ (species $A$) and argon $\\mathrm{Ar}$ (species $B$).\n- Thermodynamic equilibrium, no dissociation, no chemical reactions, spatially uniform.\n- Mole fractions: $y_A = 0.4$, $y_B = 0.6$.\n- Temperature: $T = 1200~\\mathrm{K}$.\n- Universal gas constant: $R_u = 8.314462618~\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Molar masses: $M_A = 31.998 \\times 10^{-3}~\\mathrm{kg\\,mol^{-1}}$, $M_B = 39.948 \\times 10^{-3}~\\mathrm{kg\\,mol^{-1}}$.\n- Molar isobaric heat capacity of $\\mathrm{O_2}$: $c_{p,A}(T) = 28.11 + 3.5\\left(\\frac{T}{1000}\\right) + 4.0\\,\\frac{\\left(\\frac{T}{1000}\\right)^{2}}{1 + \\left(\\frac{T}{1800}\\right)^{2}} \\quad \\text{J\\,mol}^{-1}\\,\\text{K}^{-1}$.\n- Molar isobaric heat capacity of $\\mathrm{Ar}$: $c_{p,B}(T) = \\frac{5}{2}\\,R_u \\quad \\text{J\\,mol}^{-1}\\,\\text{K}^{-1}$.\n- The sound speed $c$ is defined as the small-signal acoustic sound speed from the isentropic derivative.\n- The mixture behaves as an ideal gas, and internal modes are in thermodynamic equilibrium.\n- The calculation requires mole-fraction averaging for mixture $c_p$ and $c_v$.\n\nThe problem is scientifically grounded in classical thermodynamics and gas dynamics. The data provided for the gas mixture are physically realistic; the heat capacity model for $\\mathrm{O_2}$ reasonably accounts for vibrational excitation at high temperatures, and the model for $\\mathrm{Ar}$ is exact for a monatomic ideal gas. All necessary information is provided, the constraints are consistent ($y_A + y_B = 1$), and the tasks are clearly defined. The problem is well-posed and objective. Therefore, the problem is valid.\n\n**Step 2: Derivation and Solution**\n\nThe sound speed squared, $c^2$, is defined by the partial derivative of pressure $p$ with respect to density $\\rho$ at constant entropy $s$:\n$$\nc^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s\n$$\nFor an ideal gas mixture, the equation of state is $p = \\rho R_{mix} T$, where $R_{mix}$ is the specific gas constant of the mixture and $T$ is the temperature. We can write this as $p = \\rho \\frac{R_u}{M_{mix}} T$, where $R_u$ is the universal gas constant and $M_{mix}$ is the mixture molar mass.\n\nTo evaluate the derivative at constant entropy, we use the Gibbs free energy equation $T ds = dh - v dp$, where $h$ is the specific enthalpy and $v = 1/\\rho$ is the specific volume. For an isentropic process, $ds = 0$, so $dh = v dp = \\frac{1}{\\rho} dp$.\nFor an ideal gas (even one with temperature-dependent heat capacities, i.e., a thermally perfect gas), enthalpy is a function of temperature only: $dh = c_{p,mix}(T) dT$, where $c_{p,mix}(T)$ is the mixture specific isobaric heat capacity.\nThus, for an isentropic process in an ideal gas mixture:\n$$\nc_{p,mix}(T) dT = \\frac{1}{\\rho} dp\n$$\nFrom the ideal gas law, $p = \\rho R_{mix} T$, we can find the differential $dp$ by applying the product rule: $dp = R_{mix}(T d\\rho + \\rho dT)$.\nSubstituting this into the previous equation:\n$$\nc_{p,mix}(T) dT = \\frac{R_{mix}}{\\rho} (T d\\rho + \\rho dT) = R_{mix} T \\frac{d\\rho}{\\rho} + R_{mix} dT\n$$\nRearranging the terms to separate variables gives:\n$$\n(c_{p,mix}(T) - R_{mix}) dT = R_{mix} T \\frac{d\\rho}{\\rho}\n$$\nUsing Mayer's relation for an ideal gas mixture, $c_{p,mix}(T) - c_{v,mix}(T) = R_{mix}$, where $c_{v,mix}$ is the mixture specific isochoric heat capacity, we get:\n$$\nc_{v,mix}(T) dT = R_{mix} T \\frac{d\\rho}{\\rho}\n$$\nFrom this, we find the relationship between temperature and density changes along an isentrope:\n$$\n\\frac{dT}{T} = \\frac{R_{mix}}{c_{v,mix}(T)} \\frac{d\\rho}{\\rho} \\implies \\left(\\frac{\\partial T}{\\partial \\rho}\\right)_s = \\frac{T}{\\rho} \\frac{R_{mix}}{c_{v,mix}(T)}\n$$\nNow, we evaluate the original derivative for $c^2$ using the chain rule on $p(\\rho, T(\\rho))$:\n$$\n\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\left(\\frac{\\partial (\\rho R_{mix} T)}{\\partial \\rho}\\right)_s = R_{mix} T + \\rho R_{mix} \\left(\\frac{\\partial T}{\\partial \\rho}\\right)_s\n$$\nSubstituting the expression for $(\\partial T/\\partial \\rho)_s$:\n$$\nc^2 = R_{mix} T + \\rho R_{mix} \\left(\\frac{T}{\\rho} \\frac{R_{mix}}{c_{v,mix}(T)}\\right) = R_{mix} T + \\frac{R_{mix}^2 T}{c_{v,mix}(T)} = R_{mix} T \\left(1 + \\frac{R_{mix}}{c_{v,mix}(T)}\\right)\n$$\nUsing Mayer's relation again, $R_{mix} = c_{p,mix}(T) - c_{v,mix}(T)$:\n$$\nc^2 = R_{mix} T \\left(1 + \\frac{c_{p,mix}(T) - c_{v,mix}(T)}{c_{v,mix}(T)}\\right) = R_{mix} T \\left(\\frac{c_{v,mix}(T) + c_{p,mix}(T) - c_{v,mix}(T)}{c_{v,mix}(T)}\\right) = R_{mix} T \\frac{c_{p,mix}(T)}{c_{v,mix}(T)}\n$$\nDefining the heat capacity ratio $\\gamma_{mix}(T) = \\frac{c_{p,mix}(T)}{c_{v,mix}(T)}$, the expression for the sound speed is:\n$$\nc = \\sqrt{\\gamma_{mix} R_{mix} T} = \\sqrt{\\frac{c_{p,mix}}{c_{v,mix}} \\frac{R_u}{M_{mix}} T}\n$$\nThis expression is valid for a thermally perfect ideal gas, where the heat capacities depend on temperature. The quantities are evaluated at the given thermodynamic state.\n\n**Numerical Calculation**\nWe compute the necessary quantities for the mixture state $T = 1200~\\mathrm{K}$, $y_A = 0.4$, $y_B = 0.6$.\nThe universal gas constant is $R_u = 8.314462618~\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\n1.  **Molar heat capacities of the pure species at $T=1200~\\mathrm{K}$:**\n    - For argon (species B):\n    $$c_{p,B} = \\frac{5}{2} R_u = \\frac{5}{2} (8.314462618) \\approx 20.78616~\\mathrm{J\\,mol^{-1}\\,K^{-1}}$$\n    - For oxygen (species A), with $T/1000 = 1.2$ and $T/1800 = 1200/1800 = 2/3$:\n    $$c_{p,A}(1200) = 28.11 + 3.5(1.2) + 4.0\\,\\frac{(1.2)^{2}}{1 + (2/3)^{2}} = 28.11 + 4.2 + 4.0\\,\\frac{1.44}{1 + 4/9}$$\n    $$c_{p,A}(1200) = 32.31 + 4.0\\,\\frac{1.44}{13/9} = 32.31 + \\frac{5.76 \\times 9}{13} = 32.31 + \\frac{51.84}{13} \\approx 32.31 + 3.98769$$\n    $$c_{p,A}(1200) \\approx 36.29769~\\mathrm{J\\,mol^{-1}\\,K^{-1}}$$\n\n2.  **Mixture molar heat capacities:**\n    Using mole-fraction averaging for the molar heat capacities:\n    $$c_{p,mix} = y_A c_{p,A} + y_B c_{p,B} \\approx (0.4)(36.29769) + (0.6)(20.78616)$$\n    $$c_{p,mix} \\approx 14.51908 + 12.47170 \\approx 26.99078~\\mathrm{J\\,mol^{-1}\\,K^{-1}}$$\n    The mixture molar isochoric heat capacity is found using the mixture's Mayer relation, $c_{v,mix} = c_{p,mix} - R_u$:\n    $$c_{v,mix} \\approx 26.99078 - 8.31446 \\approx 18.67632~\\mathrm{J\\,mol^{-1}\\,K^{-1}}$$\n    This is consistent with mole-fraction averaging $c_v$ for each species, as required by the problem statement.\n\n3.  **Mixture heat capacity ratio $\\gamma_{mix}$:**\n    $$\\gamma_{mix} = \\frac{c_{p,mix}}{c_{v,mix}} \\approx \\frac{26.99078}{18.67632} \\approx 1.44517$$\n\n4.  **Mixture molar mass $M_{mix}$:**\n    $$M_{mix} = y_A M_A + y_B M_B = (0.4)(31.998 \\times 10^{-3}) + (0.6)(39.948 \\times 10^{-3})$$\n    $$M_{mix} = (12.7992 + 23.9688) \\times 10^{-3} = 36.768 \\times 10^{-3}~\\mathrm{kg\\,mol^{-1}}$$\n\n5.  **Sound speed $c$:**\n    $$c = \\sqrt{\\gamma_{mix} \\frac{R_u}{M_{mix}} T} \\approx \\sqrt{1.44517 \\times \\frac{8.314462618}{36.768 \\times 10^{-3}} \\times 1200}$$\n    $$c \\approx \\sqrt{1.44517 \\times (226.132) \\times 1200} \\approx \\sqrt{392095.5}$$\n    $$c \\approx 626.175~\\mathrm{m/s}$$\n    Rounding to four significant figures, the sound speed is $626.2~\\mathrm{m/s}$.\n\n**Step 3: Discussion of Limitations**\n\nThe calculation performed provides the *equilibrium sound speed*. This value assumes that as a sound wave propagates through the gas, causing rapid fluctuations in temperature, all internal energy modes of the molecules adjust instantaneously to these fluctuations. This ensures that the gas remains in thermodynamic equilibrium at each point in the acoustic cycle.\n\nThe primary limitation of this model arises from the finite time required for energy to be exchanged between different modes, a phenomenon known as *relaxation*. For the given mixture:\n- Argon ($\\mathrm{Ar}$) is a monatomic gas, possessing only translational energy modes. Energy exchange between these modes is extremely fast, occurring on the order of the molecular collision time.\n- Oxygen ($\\mathrm{O_2}$) is a diatomic molecule. In addition to translation, it possesses rotational and vibrational energy modes. At $T=1200~\\mathrm{K}$, the vibrational modes are significantly excited, as correctly captured by the temperature-dependent $c_{p,A}(T)$ model.\n\nThe relaxation time for vibrational modes, $\\tau_{vib}$, is typically much longer than for rotational or translational modes. The behavior of the sound speed depends on the comparison between the acoustic frequency, $f$, and the vibrational relaxation rate, $1/\\tau_{vib}$.\n1.  **Low-frequency (equilibrium) limit ($f \\ll 1/\\tau_{vib}$):** The period of the sound wave is much longer than the vibrational relaxation time. The vibrational modes have ample time to equilibrate with the translational temperature during each compression and rarefaction. In this regime, the vibrational modes fully participate in storing and releasing energy, and the heat capacities are the full equilibrium values calculated above. Our calculated sound speed $c \\approx 626.2~\\mathrm{m/s}$ is valid in this limit.\n2.  **High-frequency (frozen) limit ($f \\gg 1/\\tau_{vib}$):** The acoustic period is too short for significant energy exchange with the vibrational modes. These modes are effectively \"frozen\" and do not contribute to the heat capacity over the timescale of the wave. The effective heat capacities, $c_p^*$ and $c_v^*$, will be lower than the equilibrium values because they only account for translational and rotational contributions. This results in a higher heat capacity ratio, $\\gamma^* = c_p^*/c_v^*  \\gamma_{mix}$, and consequently a higher \"frozen\" sound speed.\n3.  **Intermediate frequencies ($f \\sim 1/\\tau_{vib}$):** In this regime, the sound speed is frequency-dependent (a phenomenon called *acoustic dispersion*), and the sound wave is significantly attenuated as energy is dissipated due to the lagging response of the vibrational modes.\n\nTherefore, the critical limitation of the simple calculation method is that it yields a single value for the sound speed, implicitly assuming the low-frequency, equilibrium condition. It fails to capture the physical reality of acoustic dispersion, where the sound speed in a gas with active internal modes (like vibrating $\\mathrm{O_2}$) is a function of frequency. The computed value represents only the lower bound of the possible sound speed in this medium.",
            "answer": "$$\\boxed{626.2}$$"
        },
        {
            "introduction": "A computational model is only as reliable as its underlying equation of state (EOS). A fundamental requirement for physical realism is that any medium must be mechanically stable, which translates to the thermodynamic condition that the squared sound speed, $c^2$, must be positive. This practice guides you through deriving a general, computable test for this condition from the laws of thermodynamics and implementing it to validate parametric EOS models (). This exercise underscores a core responsibility in computational science: ensuring that our numerical tools are built upon physically sound foundations.",
            "id": "4122520",
            "problem": "Consider the physical requirement in computational acoustics that mechanically stable media must have strictly positive isentropic bulk modulus, which is equivalent to strictly positive squared sound speed. Negative compressibility states are mechanically unstable and therefore inadmissible. Starting only from fundamental thermodynamic definitions and laws, derive a computable test that, given a parametric equation of state (equation of state (EOS)), rejects any parameter set that produces nonpositive squared sound speed in any admissible thermodynamic state.\n\nYou are to work with a parametric pressure law of the form\n$$\np(\\rho,e;\\theta) = (\\gamma - 1)\\,\\rho\\,e \\;-\\; \\gamma\\,p_{\\infty} \\;+\\; K\\Big[\\Big(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\Big)^{m} - 1\\Big],\n$$\nwhere the parameter vector is $\\theta = (\\gamma,p_{\\infty},K,m)$, density is $\\rho$, and specific internal energy is $e$. All quantities must be interpreted in International System of Units (SI): $\\rho$ in $\\mathrm{kg/m^3}$, $e$ in $\\mathrm{J/kg}$, $p$ in $\\mathrm{Pa}$, $p_{\\infty}$ in $\\mathrm{Pa}$, $K$ in $\\mathrm{Pa}$, and $\\rho_{\\mathrm{ref}}$ in $\\mathrm{kg/m^3}$. The speed of sound satisfies the core acoustical definition\n$$\nc^2 = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{s},\n$$\nand thermodynamics supplies the First Law in differential form\n$$\n\\mathrm{d}e = T\\,\\mathrm{d}s + \\frac{p}{\\rho^2}\\,\\mathrm{d}\\rho,\n$$\nwith temperature $T$ and entropy $s$. No additional shortcut formulas are to be assumed in the derivation.\n\nAdmissible states are restricted to the rectangular set\n$$\n\\rho \\in [\\rho_{\\min},\\rho_{\\max}],\\quad e \\in [e_{\\min},e_{\\max}],\n$$\nwith fixed values\n$$\n\\rho_{\\mathrm{ref}} = 1000\\,\\mathrm{kg/m^3},\\quad \\rho_{\\min} = 800\\,\\mathrm{kg/m^3},\\quad \\rho_{\\max} = 1400\\,\\mathrm{kg/m^3},\n$$\nand\n$$\ne_{\\min} = 1.0\\times 10^{6}\\,\\mathrm{J/kg},\\quad e_{\\max} = 5.0\\times 10^{6}\\,\\mathrm{J/kg}.\n$$\n\nTask 1 (derivation): Starting from the two fundamental relations above, derive a computable expression for $c^2$ in terms of $\\rho$, $e$, and partial derivatives of $p(\\rho,e;\\theta)$ with respect to $\\rho$ and $e$ at fixed $e$ and fixed $\\rho$, respectively. Justify why strictly positive $c^2$ over the admissible set is equivalent to strictly positive isentropic bulk modulus and hence positive compressibility.\n\nTask 2 (algorithm design): Using your derived expression, design an algorithm that, given a parameter set $\\theta$, evaluates $c^2(\\rho,e;\\theta)$ over a uniform tensor grid that includes the boundaries of the admissible rectangle, detects whether $c^2 \\le 0$ at any sampled state, and returns a boolean indicating rejection (return $\\,\\mathrm{True}\\,$ if and only if there exists at least one sampled state with $c^2 \\le 0$).\n\nUse a uniform grid with\n$$\nN_{\\rho} = 129,\\quad N_{e} = 129\n$$\npoints in $\\rho$ and $e$, respectively, spanning the closed intervals $[\\rho_{\\min},\\rho_{\\max}]$ and $[e_{\\min},e_{\\max}]$.\n\nTest suite: Apply your algorithm to the following five parameter sets $\\theta_k = (\\gamma,p_{\\infty},K,m)$, $k \\in \\{1,2,3,4,5\\}$:\n- $\\theta_1 = (4.4,\\;6.0\\times 10^{8}\\,\\mathrm{Pa},\\;1.0\\times 10^{9}\\,\\mathrm{Pa},\\;2.0)$,\n- $\\theta_2 = (0.8,\\;1.0\\times 10^{5}\\,\\mathrm{Pa},\\;0.0\\,\\mathrm{Pa},\\;2.0)$,\n- $\\theta_3 = (2.0,\\;1.0\\times 10^{5}\\,\\mathrm{Pa},\\;-1.0\\times 10^{9}\\,\\mathrm{Pa},\\;2.0)$,\n- $\\theta_4 = (1.0001,\\;0.0\\,\\mathrm{Pa},\\;0.0\\,\\mathrm{Pa},\\;2.0)$,\n- $\\theta_5 = (1.4,\\;0.0\\,\\mathrm{Pa},\\;1.0\\times 10^{7}\\,\\mathrm{Pa},\\;1.1)$.\n\nYour program must:\n- Implement the derived $c^2(\\rho,e;\\theta)$ formula using only partial derivatives of $p(\\rho,e;\\theta)$ with respect to $\\rho$ and $e$, evaluated at fixed $e$ and fixed $\\rho$, respectively.\n- Sample the admissible set on the specified grid and determine, for each $\\theta_k$, whether there exists any sampled $(\\rho,e)$ with $c^2 \\le 0$.\n- Produce a single line of output containing the results for $k=1,2,3,4,5$ as a comma-separated list of booleans enclosed in square brackets, with entries in order of the parameter sets given above. For example, an output with five boolean results must look like\n$$\n[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True},\\mathrm{False}],\n$$\nbut with the actual values computed by your program. No units are required in the output since the answers are booleans.\n\nScientific realism and units: All constants and parameter values are in SI units, and your implementation must adhere to these units internally. The analysis and algorithm must be universally applicable and independent of programming language specifics; however, your final answer must be a complete and runnable Python program as specified below.",
            "solution": "The user has provided a problem in computational acoustics that requires the derivation of a stability criterion and the design of a computational algorithm to test it. The problem is well-posed, scientifically grounded, and contains all necessary information.\n\n### Task 1: Derivation and Justification\n\nThe first task is to derive a computable expression for the squared speed of sound, $c^2$, and to justify the stability criterion $c^2  0$.\n\n**Derivation of the expression for $c^2$**\n\nWe are tasked to find an expression for the squared speed of sound, defined as the isentropic derivative of pressure with respect to density:\n$$\nc^2 = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{s}\n$$\nThe provided equation of state (EOS) gives pressure $p$ as a function of density $\\rho$ and specific internal energy $e$, i.e., $p = p(\\rho, e)$. The \"natural\" variables for this EOS are $\\rho$ and $e$. Therefore, our goal is to express the derivative at constant entropy $s$, $(\\partial p/\\partial \\rho)_s$, in terms of partial derivatives at constant energy $e$ and constant density $\\rho$, which are $(\\partial p/\\partial \\rho)_e$ and $(\\partial p/\\partial e)_\\rho$, respectively.\n\nWe start with the total differential of pressure, $p(\\rho, e)$:\n$$\n\\mathrm{d}p = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} \\mathrm{d}\\rho + \\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} \\mathrm{d}e\n$$\nNext, we use the provided differential form of the First Law of Thermodynamics:\n$$\n\\mathrm{d}e = T\\,\\mathrm{d}s + \\frac{p}{\\rho^2}\\,\\mathrm{d}\\rho\n$$\nwhere $T$ is temperature and $s$ is specific entropy. This equation relates the differential $\\mathrm{d}e$ to the differentials $\\mathrm{d}s$ and $\\mathrm{d}\\rho$.\n\nWe can substitute the expression for $\\mathrm{d}e$ from the First Law into the total differential of $p$:\n$$\n\\mathrm{d}p = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} \\mathrm{d}\\rho + \\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} \\bigg(T\\,\\mathrm{d}s + \\frac{p}{\\rho^2}\\,\\mathrm{d}\\rho\\bigg)\n$$\nNow, we group the terms by the differentials $\\mathrm{d}\\rho$ and $\\mathrm{d}s$:\n$$\n\\mathrm{d}p = \\left[ \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} + \\frac{p}{\\rho^2}\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} \\right] \\mathrm{d}\\rho + \\left[ T\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} \\right] \\mathrm{d}s\n$$\nThis expression is the total differential of pressure in terms of $\\rho$ and $s$, i.e., $p(\\rho, s)$. By definition, the partial derivative of $p$ with respect to $\\rho$ at constant $s$ is the coefficient of the $\\mathrm{d}\\rho$ term when $\\mathrm{d}s=0$. From the equation above, this coefficient is:\n$$\n\\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{s} = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} + \\frac{p}{\\rho^2}\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho}\n$$\nTherefore, the computable expression for the squared speed of sound is:\n$$\nc^2 = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} + \\frac{p}{\\rho^2}\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho}\n$$\nThis expression depends only on $p$, $\\rho$, and the partial derivatives of the given EOS, $p(\\rho, e)$, with respect to its natural variables.\n\n**Justification for Mechanical Stability**\n\nA medium is considered mechanically stable if it resists compression, meaning an infinitesimal increase in pressure results in an infinitesimal decrease in volume (and thus an increase in density). The quantity that measures this resistance is the bulk modulus. For processes that are sufficiently fast, like the propagation of sound, the relevant quantity is the isentropic bulk modulus, $K_s$. It is defined as:\n$$\nK_s = -V \\Big(\\frac{\\partial p}{\\partial V}\\Big)_s\n$$\nwhere $V$ is the volume. For mechanical stability, the medium must become less voluminous when compressed, so we require $(\\partial p/\\partial V)_s  0$, which implies $K_s  0$.\n\nWe can relate the volume $V$ to the density $\\rho$ via the specific volume $v = 1/\\rho$. Using $v$ in place of $V$ (as they are proportional for a fixed mass), we have:\n$$\nK_s = -v \\Big(\\frac{\\partial p}{\\partial v}\\Big)_s = -\\frac{1}{\\rho} \\Big(\\frac{\\partial p}{\\partial v}\\Big)_s\n$$\nUsing the chain rule, we can change the variable of differentiation from $v$ to $\\rho$:\n$$\n\\Big(\\frac{\\partial p}{\\partial v}\\Big)_s = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_s \\Big(\\frac{\\partial \\rho}{\\partial v}\\Big)\n$$\nSince $\\rho = 1/v$, we have $\\mathrm{d}\\rho/\\mathrm{d}v = -1/v^2 = -\\rho^2$. Substituting this into the chain rule expression gives:\n$$\n\\Big(\\frac{\\partial p}{\\partial v}\\Big)_s = \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_s (-\\rho^2)\n$$\nNow, we substitute this back into the expression for $K_s$:\n$$\nK_s = -\\frac{1}{\\rho} \\left[ \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_s (-\\rho^2) \\right] = \\rho \\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_s\n$$\nRecalling the definition $c^2 = (\\partial p/\\partial \\rho)_s$, we arrive at the fundamental relationship:\n$$\nK_s = \\rho c^2\n$$\nSince density $\\rho$ must be positive, the condition for mechanical stability, $K_s  0$, is equivalent to the condition $c^2  0$. The isentropic compressibility, $\\beta_s = 1/K_s$, must also be positive. Consequently, any state where $c^2 \\le 0$ is mechanically unstable or marginally stable and therefore physically inadmissible.\n\n### Task 2: Algorithm Design\n\nThe second task is to design an algorithm to test for $c^2 \\le 0$ over a discrete grid of admissible states.\n\n**1. Analytical Partial Derivatives**\n\nFirst, we compute the necessary partial derivatives of the given EOS:\n$$\np(\\rho,e;\\theta) = (\\gamma - 1)\\,\\rho\\,e \\;-\\; \\gamma\\,p_{\\infty} \\;+\\; K\\Big[\\Big(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\Big)^{m} - 1\\Big]\n$$\nThe partial derivative with respect to $e$ at fixed $\\rho$ is:\n$$\n\\Big(\\frac{\\partial p}{\\partial e}\\Big)_{\\rho} = \\frac{\\partial}{\\partial e} \\left[ (\\gamma - 1)\\rho e - \\gamma p_{\\infty} + K\\left(\\left(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\right)^m - 1\\right) \\right] = (\\gamma - 1)\\rho\n$$\nThe partial derivative with respect to $\\rho$ at fixed $e$ is:\n$$\n\\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} = \\frac{\\partial}{\\partial \\rho} \\left[ (\\gamma - 1)\\rho e - \\gamma p_{\\infty} + K\\left(\\left(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\right)^m - 1\\right) \\right] = (\\gamma - 1)e + K \\frac{\\partial}{\\partial \\rho} \\left(\\frac{\\rho^m}{\\rho_{\\mathrm{ref}}^m}\\right)\n$$\n$$\n\\Big(\\frac{\\partial p}{\\partial \\rho}\\Big)_{e} = (\\gamma - 1)e + \\frac{K m}{\\rho_{\\mathrm{ref}}^m} \\rho^{m-1} = (\\gamma - 1)e + \\frac{K m}{\\rho} \\left(\\frac{\\rho}{\\rho_{\\mathrm{ref}}}\\right)^m\n$$\n\n**2. Grid-Based Evaluation Algorithm**\n\nThe algorithm tests a given parameter set $\\theta = (\\gamma, p_{\\infty}, K, m)$ for stability.\n\n**Inputs:**\n- Parameter set $\\theta = (\\gamma, p_{\\infty}, K, m)$.\n- Domain boundaries: $\\rho_{\\min}$, $\\rho_{\\max}$, $e_{\\min}$, $e_{\\max}$.\n- Grid resolution: $N_{\\rho}$, $N_{e}$.\n- Reference density: $\\rho_{\\mathrm{ref}}$.\n\n**Procedure:**\n1.  Generate a uniform tensor grid of thermodynamic states. Create a 1D array of $N_{\\rho}$ density points, $\\rho_i$, linearly spaced from $\\rho_{\\min}$ to $\\rho_{\\max}$. Create a 1D array of $N_{e}$ energy points, $e_j$, linearly spaced from $e_{\\min}$ to $e_{\\max}$. This defines a grid of $N_{\\rho} \\times N_{e}$ states $(\\rho_i, e_j)$.\n\n2.  For each point $(\\rho, e)$ on the grid, and for the given $\\theta$:\n    a. Calculate the pressure $p = p(\\rho, e; \\theta)$ using the EOS formula.\n    b. Calculate the partial derivative $(\\partial p/\\partial \\rho)_e$ using its derived formula.\n    c. Calculate the partial derivative $(\\partial p/\\partial e)_\\rho$ using its derived formula.\n    d. Calculate the squared speed of sound $c^2$ using the derived relation: $c^2 = (\\partial p/\\partial \\rho)_e + (p/\\rho^2)(\\partial p/\\partial e)_\\rho$.\n\n3.  Check for instability. After computing $c^2$ for all points on the grid, determine if any of the computed values are non-positive (i.e., if $\\min(c^2) \\le 0$).\n\n**Output:**\n- Return $\\mathrm{True}$ if there exists at least one grid point $(\\rho, e)$ for which $c^2 \\le 0$.\n- Return $\\mathrm{False}$ if $c^2  0$ for all grid points.\n\nThis procedure can be implemented efficiently using vectorized numerical libraries (like NumPy in Python) by evaluating the formulas on the entire grid of $\\rho$ and $e$ values simultaneously.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef check_stability_for_params(params: tuple) - bool:\n    \"\"\"\n    Checks a parameter set for mechanical stability over a specified domain.\n\n    The function evaluates the squared speed of sound c^2 on a grid of\n    (density, specific internal energy) states. It returns True if any\n    sampled state has c^2 = 0, indicating a mechanically unstable or\n    marginally stable region is found.\n\n    Args:\n        params: A tuple containing the equation of state parameters\n                (gamma, p_infinity, K, m).\n\n    Returns:\n        A boolean, True if the parameter set is rejected (instability found),\n        False otherwise.\n    \"\"\"\n    # Unpack the parameter vector theta\n    gamma, p_infinity, K, m = params\n\n    # Define fixed physical constants and domain boundaries in SI units\n    rho_ref = 1000.0  # kg/m^3\n    rho_min = 800.0    # kg/m^3\n    rho_max = 1400.0   # kg/m^3\n    e_min = 1.0e6      # J/kg\n    e_max = 5.0e6      # J/kg\n\n    # Define the grid resolution\n    N_rho = 129\n    N_e = 129\n\n    # Create the uniform tensor grid for density (rho) and specific internal energy (e)\n    rho_grid = np.linspace(rho_min, rho_max, N_rho)\n    e_grid = np.linspace(e_min, e_max, N_e)\n    RHO, E = np.meshgrid(rho_grid, e_grid)\n\n    # --- Vectorized calculation over the grid ---\n\n    # 1. Calculate pressure p(RHO, E)\n    # The EOS is: p = (gamma - 1)*rho*e - gamma*p_inf + K*((rho/rho_ref)^m - 1)\n    # Let's compute term by term for clarity.\n    term1 = (gamma - 1.0) * RHO * E\n    term2 = -gamma * p_infinity\n    term3 = K * (np.power(RHO / rho_ref, m) - 1.0)\n    P = term1 + term2 + term3\n\n    # 2. Calculate partial derivative (dp/de)_rho\n    # (dp/de)_rho = (gamma - 1) * rho\n    dp_de_rho = (gamma - 1.0) * RHO\n\n    # 3. Calculate partial derivative (dp/drho)_e\n    # (dp/drho)_e = (gamma - 1)*e + K*m/rho * (rho/rho_ref)^m\n    # The form (gamma - 1)*e + (K * m / rho_ref**m) * rho**(m-1) is better\n    # to avoid potential division by zero if rho could be zero, though not here.\n    dp_drho_e = (gamma - 1.0) * E + (K * m / np.power(rho_ref, m)) * np.power(RHO, m - 1.0)\n    \n    # 4. Calculate squared speed of sound c^2\n    # c^2 = (dp/drho)_e + (p / rho^2) * (dp/de)_rho\n    c_squared = dp_drho_e + (P / np.power(RHO, 2)) * dp_de_rho\n\n    # 5. Check if any value of c^2 is non-positive\n    # The problem requires rejection if c^2 = 0.\n    is_unstable = np.any(c_squared = 0)\n\n    return is_unstable\n\ndef solve():\n    \"\"\"\n    Main function to run stability checks on all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple theta = (gamma, p_infinity, K, m).\n    test_cases = [\n        (4.4, 6.0e8, 1.0e9, 2.0),      # theta_1\n        (0.8, 1.0e5, 0.0, 2.0),       # theta_2\n        (2.0, 1.0e5, -1.0e9, 2.0),     # theta_3\n        (1.0001, 0.0, 0.0, 2.0),      # theta_4\n        (1.4, 0.0, 1.0e7, 1.1)         # theta_5\n    ]\n\n    results = []\n    for case in test_cases:\n        # For each parameter set, check for stability.\n        # The result is True if rejected, False if stable.\n        result = check_stability_for_params(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The problem example shows [True,False,...], which is the default\n    # string representation of booleans in Python.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}