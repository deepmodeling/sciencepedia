{
    "hands_on_practices": [
        {
            "introduction": "The superposition principle is not merely a descriptive tool; it is a powerful design principle for engineering acoustic fields. A classic example is acoustic beamforming, where an array of sources is phased to constructively interfere in a target direction and destructively interfere elsewhere. This exercise provides hands-on practice in applying superposition to calculate the radiation pattern of a linear array and assessing the impact of element failures, a crucial consideration in the design of robust sonar and ultrasound systems .",
            "id": "4145612",
            "problem": "Consider a Uniform Linear Array (ULA) of $N=13$ identical, mutually non-interacting, narrowband acoustic monopoles placed along the $x$-axis at positions $x_n = n d$ for integer indices $n \\in \\{-6,-5,\\dots,5,6\\}$, where $d$ is the inter-element spacing. The acoustic medium is homogeneous, isotropic, inviscid, and quiescent, and small-signal conditions hold so that linear acoustics applies. Each element is driven at angular frequency $\\omega$ producing a wavenumber $k = \\frac{2\\pi}{\\lambda}$, and all angles are measured in radians.\n\nUnder far-field conditions, suppose beam steering toward a target direction $\\theta_0$ is achieved by complex weights $w_n$ that phase-align the contributions from all active elements toward $\\theta_0$. The superposition principle applies, so the total complex pressure field at an observation direction $\\theta$ is the linear sum of the contributions from each element. A subset of elements suffer failures such that their weights are set to zero: specifically, the elements with indices $n \\in \\mathcal{S} = \\{-5,-4,-1,1,4,5\\}$ are failed, and all other elements remain active with unit-magnitude weights.\n\nAssume half-wavelength spacing $d = \\frac{\\lambda}{2}$ and set $\\sin(\\theta_0) = \\frac{1}{2}$. Let the degraded, steering-compensated, direction-dependent complex array factor be defined as\n$$\nA_{\\mathrm{fail}}(\\theta) = \\frac{1}{N} \\left| \\sum_{n \\in \\{-6,\\dots,6\\} \\setminus \\mathcal{S}} \\exp\\!\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big) \\right|,\n$$\nwhich is normalized by the ideal steering-axis gain of the full $N$-element ULA.\n\nUsing only first principles of linear acoustics and far-field superposition, derive the form of $A_{\\mathrm{fail}}(\\theta)$ and then compute the numerical value of $A_{\\mathrm{fail}}(\\theta)$ at $\\theta = 0$. Round your final numerical answer to four significant figures. The final answer should be unitless.",
            "solution": "The problem requires the derivation and evaluation of the degraded array factor, $A_{\\mathrm{fail}}(\\theta)$, for a specific Uniform Linear Array (ULA) configuration. The evaluation is to be performed at the observation angle $\\theta = 0$. The process will begin by rigorously establishing the form of the array factor from the stated first principles of linear acoustics and superposition, followed by a systematic calculation using the provided parameters.\n\nFirst, we establish the analytical form of the array factor. According to the principle of superposition in linear acoustics, the total acoustic pressure field in the far-field is the sum of the contributions from each individual element of the array. For a single monopole source $n$ located at position $\\mathbf{r}_n$ and driven with angular frequency $\\omega$, its contribution to the complex pressure at a far-field observation point $\\mathbf{r}$ is proportional to $w_n \\exp(i (\\omega t - k |\\mathbf{r} - \\mathbf{r}_n|))$. In the far-field, $|\\mathbf{r} - \\mathbf{r}_n| \\approx r - \\mathbf{\\hat{r}} \\cdot \\mathbf{r}_n$, where $r=|\\mathbf{r}|$ and $\\mathbf{\\hat{r}} = \\mathbf{r}/r$. For the given ULA along the $x$-axis, $\\mathbf{r}_n = x_n \\mathbf{\\hat{x}}$, and for an observation direction $\\theta$ relative to the $y$-axis (broadside), $\\mathbf{\\hat{r}} \\cdot \\mathbf{r}_n = x_n \\sin(\\theta)$. The phase term becomes $\\exp(i k x_n \\sin(\\theta))$.\n\nThe total complex pressure $p(\\theta)$ is the sum of contributions from all elements, weighted by complex coefficients $w_n$:\n$$\np(\\theta) \\propto \\sum_n w_n \\exp(i k x_n \\sin(\\theta))\n$$\nBeam steering toward a target direction $\\theta_0$ is accomplished by choosing weights $w_n$ that cause the individual signal phases to align constructively at $\\theta_0$. This requires $k x_n \\sin(\\theta_0) + \\arg(w_n)$ to be constant for all $n$. A standard choice for the weights, which also satisfies the unit-magnitude constraint for active elements, is $w_n = \\exp(-i k x_n \\sin(\\theta_0))$. For failed elements, the weight is $w_n = 0$. Let $\\mathcal{A}$ be the set of indices of active elements. The resulting pressure field, conventionally called the array factor, is:\n$$\nA(\\theta) = \\sum_{n \\in \\mathcal{A}} \\exp(-i k x_n \\sin(\\theta_0)) \\exp(i k x_n \\sin(\\theta)) = \\sum_{n \\in \\mathcal{A}} \\exp\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big)\n$$\nThe problem defines $A_{\\mathrm{fail}}(\\theta)$ as the magnitude of this array factor, normalized by the ideal steering-axis gain of the full $N$-element ULA. For a full ULA (no failures), the ideal array factor at the steering angle $\\theta=\\theta_0$ would be $\\sum_{n=-6}^{6} \\exp(0) = N$. Thus, the normalization factor is $1/N$. This confirms the provided expression:\n$$\nA_{\\mathrm{fail}}(\\theta) = \\frac{1}{N} \\left| \\sum_{n \\in \\{-6,\\dots,6\\} \\setminus \\mathcal{S}} \\exp\\big(i k x_n [\\sin(\\theta) - \\sin(\\theta_0)]\\big) \\right|\n$$\nThe task is to compute this value for $\\theta = 0$. Substituting $\\sin(\\theta) = 0$ into the expression gives:\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{N} \\left| \\sum_{n \\in \\mathcal{A}} \\exp\\big(-i k x_n \\sin(\\theta_0)\\big) \\right|\n$$\nWe are given the following parameters:\n- Total number of elements: $N = 13$.\n- Element positions: $x_n = n d$.\n- Inter-element spacing: $d = \\frac{\\lambda}{2}$.\n- Wavenumber: $k = \\frac{2\\pi}{\\lambda}$.\n- Steering direction: $\\sin(\\theta_0) = \\frac{1}{2}$.\n- Set of failed element indices: $\\mathcal{S} = \\{-5, -4, -1, 1, 4, 5\\}$.\n\nThe set of active element indices $\\mathcal{A}$ is the complement of $\\mathcal{S}$ in the full set $\\{-6, \\dots, 6\\}$:\n$$\n\\mathcal{A} = \\{-6, -3, -2, 0, 2, 3, 6\\}\n$$\nNext, we evaluate the argument of the exponential term, $-i k x_n \\sin(\\theta_0)$:\n$$\n-i k x_n \\sin(\\theta_0) = -i \\left(\\frac{2\\pi}{\\lambda}\\right) (n d) \\left(\\frac{1}{2}\\right)\n$$\nSubstituting $d = \\frac{\\lambda}{2}$:\n$$\n-i \\left(\\frac{2\\pi}{\\lambda}\\right) \\left(n \\frac{\\lambda}{2}\\right) \\left(\\frac{1}{2}\\right) = -i \\frac{n\\pi}{2}\n$$\nThe expression for $A_{\\mathrm{fail}}(0)$ becomes:\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{13} \\left| \\sum_{n \\in \\{-6, -3, -2, 0, 2, 3, 6\\}} \\exp\\left(-i \\frac{n\\pi}{2}\\right) \\right|\n$$\nWe now evaluate the sum, let it be $S$, term by term for each active index $n \\in \\mathcal{A}$:\n- For $n = -6$: $\\exp\\left(-i \\frac{(-6)\\pi}{2}\\right) = \\exp(i 3\\pi) = \\cos(3\\pi) + i\\sin(3\\pi) = -1$.\n- For $n = -3$: $\\exp\\left(-i \\frac{(-3)\\pi}{2}\\right) = \\exp\\left(i \\frac{3\\pi}{2}\\right) = \\cos\\left(\\frac{3\\pi}{2}\\right) + i\\sin\\left(\\frac{3\\pi}{2}\\right) = -i$.\n- For $n = -2$: $\\exp\\left(-i \\frac{(-2)\\pi}{2}\\right) = \\exp(i \\pi) = \\cos(\\pi) + i\\sin(\\pi) = -1$.\n- For $n = 0$: $\\exp(0) = 1$.\n- For $n = 2$: $\\exp\\left(-i \\frac{2\\pi}{2}\\right) = \\exp(-i \\pi) = \\cos(-\\pi) + i\\sin(-\\pi) = -1$.\n- For $n = 3$: $\\exp\\left(-i \\frac{3\\pi}{2}\\right) = \\cos\\left(-\\frac{3\\pi}{2}\\right) + i\\sin\\left(-\\frac{3\\pi}{2}\\right) = i$.\n- For $n = 6$: $\\exp\\left(-i \\frac{6\\pi}{2}\\right) = \\exp(-i 3\\pi) = \\cos(-3\\pi) + i\\sin(-3\\pi) = -1$.\n\nSumming these complex values:\n$$\nS = (-1) + (-i) + (-1) + (1) + (-1) + (i) + (-1)\n$$\nCollecting the real and imaginary parts:\n$$\nS = ((-1) - 1 + 1 - 1 - 1) + i(-1 + 1) = -3 + i(0) = -3\n$$\nThe magnitude of the sum is $|S| = |-3| = 3$.\n\nFinally, we compute the value of $A_{\\mathrm{fail}}(0)$:\n$$\nA_{\\mathrm{fail}}(0) = \\frac{1}{13} |S| = \\frac{3}{13}\n$$\nTo provide the numerical answer, we compute the decimal value and round to four significant figures:\n$$\n\\frac{3}{13} \\approx 0.23076923...\n$$\nRounding to four significant figures yields $0.2308$.",
            "answer": "$$\\boxed{0.2308}$$"
        },
        {
            "introduction": "While superposition allows for elegant designs like beamformers, its practical implementation is subject to imperfections, as the precise phase control central to many applications can be compromised by physical variations or numerical errors. This practice uses perturbation analysis to explore the sensitivity of a superposed field to small phase errors, revealing how seemingly minor inaccuracies can lead to significant deviations from the intended outcome. Understanding this sensitivity is critical for assessing the robustness of both numerical simulations and physical systems .",
            "id": "4145668",
            "problem": "Consider linear, time-harmonic acoustics in a homogeneous, lossless medium with constant mass density $\\rho$ and sound speed $c$. Let the acoustic pressure be represented in the complex-amplitude (phasor) form $p(\\mathbf{x},t)=\\Re\\{P(\\mathbf{x})\\exp(-\\mathrm{i}\\,\\omega t)\\}$, where $\\omega$ is the angular frequency and $P(\\mathbf{x})$ is the complex pressure. By the superposition principle, the total phasor at a fixed field point $\\mathbf{x}$ due to $N$ independent sources at the same $\\omega$ is $P(\\mathbf{x})=\\sum_{n=1}^{N}P_{n}(\\mathbf{x})$. In a numerical simulation, suppose the nominal prediction for each component is $P_{n}(\\mathbf{x})=A_{n}\\exp(\\mathrm{i}\\,\\phi_{n})$ with $A_{n}>0$ and $\\phi_{n}\\in\\mathbb{R}$, so the nominal total is $P_{0}(\\mathbf{x})=\\sum_{n=1}^{N}A_{n}\\exp(\\mathrm{i}\\,\\phi_{n})$. Due to numerical phase errors, the actual phases are perturbed to $\\phi_{n}+\\delta\\phi_{n}$ with small $\\delta\\phi_{n}$ satisfying $|\\delta\\phi_{n}|\\ll 1$ for all $n$, and the actual total becomes $P(\\mathbf{x})=\\sum_{n=1}^{N}A_{n}\\exp(\\mathrm{i}(\\phi_{n}+\\delta\\phi_{n}))$.\n\nStarting only from the linear superposition principle, the complex representation of time-harmonic fields, and standard Taylor expansions, perform the following at a fixed field point $\\mathbf{x}$:\n- Derive, up to second order in the small phase perturbations $\\{\\delta\\phi_{n}\\}$, an analytic expression for the absolute magnitude error $\\Delta|P|=|P|-|P_{0}|$ in terms of $\\{A_{n}\\}$, $\\{\\phi_{n}\\}$, and $\\{\\delta\\phi_{n}\\}$.\n- Specialize your result to the case of two contributions with equal amplitudes $A_{1}=A_{2}=A$ and nominal phase difference $\\Delta=\\phi_{2}-\\phi_{1}$, subject to antisymmetric phase errors $\\delta\\phi_{1}=\\delta$ and $\\delta\\phi_{2}=-\\delta$, where $\\delta$ is small and expressed in radians.\n- For the special case $\\Delta=\\pi$ (nominal perfect destructive interference), compute the resulting $|P|$ exactly as a function of $A$ and $\\delta$, and interpret it as the absolute magnitude error because $|P_{0}|=0$ in this case.\n\nExpress your final answer for the special case $\\Delta=\\pi$, $\\delta\\phi_{1}=\\delta$, $\\delta\\phi_{2}=-\\delta$ as a single closed-form analytic expression in terms of $A$ and $\\delta$. No numerical rounding is required. State your result for $|P|$ in pascals, and take all angles in radians.",
            "solution": "We work at a fixed field point and suppress the explicit dependence on $\\mathbf{x}$ for brevity. By linearity, the nominal complex total pressure is\n$$\nP_{0}=\\sum_{n=1}^{N}A_{n}\\exp(\\mathrm{i}\\,\\phi_{n}),\n$$\nand the perturbed total, with phase errors $\\delta\\phi_{n}$, is\n$$\nP=\\sum_{n=1}^{N}A_{n}\\exp(\\mathrm{i}(\\phi_{n}+\\delta\\phi_{n}))=\\sum_{n=1}^{N}A_{n}\\exp(\\mathrm{i}\\,\\phi_{n})\\exp(\\mathrm{i}\\,\\delta\\phi_{n}).\n$$\nFor small $|\\delta\\phi_{n}|\\ll 1$, we use the Taylor expansion of the exponential,\n$$\n\\exp(\\mathrm{i}\\,\\delta\\phi_{n})=1+\\mathrm{i}\\,\\delta\\phi_{n}-\\tfrac{1}{2}\\,(\\delta\\phi_{n})^{2}+\\mathcal{O}((\\delta\\phi_{n})^{3}).\n$$\nDefine $p_{n}:=A_{n}\\exp(\\mathrm{i}\\,\\phi_{n})$ so that $P_{0}=\\sum_{n}p_{n}$. Then the total perturbation in complex pressure is\n$$\n\\delta P:=P-P_{0}=\\sum_{n=1}^{N}p_{n}\\left(\\mathrm{i}\\,\\delta\\phi_{n}-\\tfrac{1}{2}\\,(\\delta\\phi_{n})^{2}\\right)+\\mathcal{O}(\\|\\delta\\boldsymbol{\\phi}\\|^{3}).\n$$\nWe split this into first- and second-order parts,\n$$\n\\delta P^{(1)}=\\sum_{n=1}^{N}\\mathrm{i}\\,p_{n}\\,\\delta\\phi_{n},\\qquad \\delta P^{(2)}=\\sum_{n=1}^{N}-\\tfrac{1}{2}\\,p_{n}\\,(\\delta\\phi_{n})^{2}.\n$$\nTo expand the magnitude, write\n$$\n|P|=|P_{0}+\\delta P|=\\sqrt{(P_{0}+\\delta P)(P_{0}^{*}+\\delta P^{*})}=|P_{0}|\\,\\sqrt{1+\\alpha},\n$$\nwhere\n$$\n\\alpha:=\\frac{2\\,\\Re\\{P_{0}^{*}\\delta P\\}}{|P_{0}|^{2}}+\\frac{|\\delta P|^{2}}{|P_{0}|^{2}}.\n$$\nFor small $\\delta P$, we use $\\sqrt{1+\\alpha}=1+\\tfrac{1}{2}\\alpha-\\tfrac{1}{8}\\alpha^{2}+\\mathcal{O}(\\alpha^{3})$. Retaining terms up to second order in $\\{\\delta\\phi_{n}\\}$, we note that $\\alpha=\\mathcal{O}(\\delta\\phi)$ and $\\alpha^{2}=\\mathcal{O}((\\delta\\phi)^{2})$. Moreover,\n$$\n\\Re\\{P_{0}^{*}\\delta P\\}=\\Re\\{P_{0}^{*}\\delta P^{(1)}\\}+\\Re\\{P_{0}^{*}\\delta P^{(2)}\\},\\qquad |\\delta P|^{2}=|\\delta P^{(1)}|^{2}+\\mathcal{O}((\\delta\\phi)^{3}),\n$$\nbecause $\\delta P^{(2)}=\\mathcal{O}((\\delta\\phi)^{2})$ and $\\delta P^{(1)}=\\mathcal{O}(\\delta\\phi)$. Therefore,\n$$\n|P|=|P_{0}|+\\frac{\\Re\\{P_{0}^{*}\\delta P^{(1)}\\}}{|P_{0}|}+\\frac{\\Re\\{P_{0}^{*}\\delta P^{(2)}\\}}{|P_{0}|}+\\frac{1}{2|P_{0}|}\\left(|\\delta P^{(1)}|^{2}-\\frac{\\left(\\Re\\{P_{0}^{*}\\delta P^{(1)}\\}\\right)^{2}}{|P_{0}|^{2}}\\right)+\\mathcal{O}((\\delta\\phi)^{3}).\n$$\nHence the absolute magnitude error $\\Delta|P|:=|P|-|P_{0}|$ up to second order is\n$$\n\\Delta|P|=\\frac{\\Re\\{P_{0}^{*}\\delta P^{(1)}\\}}{|P_{0}|}+\\frac{\\Re\\{P_{0}^{*}\\delta P^{(2)}\\}}{|P_{0}|}+\\frac{1}{2|P_{0}|}\\left(|\\delta P^{(1)}|^{2}-\\frac{\\left(\\Re\\{P_{0}^{*}\\delta P^{(1)}\\}\\right)^{2}}{|P_{0}|^{2}}\\right)+\\mathcal{O}((\\delta\\phi)^{3}).\n$$\nSubstituting $\\delta P^{(1)}$ and $\\delta P^{(2)}$ gives the general second-order sensitivity in terms of $\\{A_{n}\\}$, $\\{\\phi_{n}\\}$, and $\\{\\delta\\phi_{n}\\}$:\n$$\n\\Delta|P|=\\frac{\\Re\\left\\{P_{0}^{*}\\sum_{n=1}^{N}\\mathrm{i}\\,p_{n}\\,\\delta\\phi_{n}\\right\\}}{|P_{0}|}+\\frac{\\Re\\left\\{P_{0}^{*}\\sum_{n=1}^{N}-\\tfrac{1}{2}\\,p_{n}\\,(\\delta\\phi_{n})^{2}\\right\\}}{|P_{0}|}\n+\\frac{1}{2|P_{0}|}\\left(\\left|\\sum_{n=1}^{N}\\mathrm{i}\\,p_{n}\\,\\delta\\phi_{n}\\right|^{2}-\\frac{\\left(\\Re\\left\\{P_{0}^{*}\\sum_{n=1}^{N}\\mathrm{i}\\,p_{n}\\,\\delta\\phi_{n}\\right\\}\\right)^{2}}{|P_{0}|^{2}}\\right)+\\mathcal{O}((\\delta\\phi)^{3}).\n$$\nThis completes the general second-order expression under the assumption $|P_{0}|>0$.\n\nWe now specialize to two contributions with $A_{1}=A_{2}=A$, nominal phase difference $\\Delta=\\phi_{2}-\\phi_{1}$, and antisymmetric phase errors $\\delta\\phi_{1}=\\delta$, $\\delta\\phi_{2}=-\\delta$, where $\\delta$ is small and in radians. The total perturbed complex pressure is\n$$\nP=A\\exp(\\mathrm{i}(\\phi_{1}+\\delta))+A\\exp(\\mathrm{i}(\\phi_{2}-\\delta))=A\\exp(\\mathrm{i}\\phi_{1})\\left(\\exp(\\mathrm{i}\\delta)+\\exp(\\mathrm{i}(\\Delta-\\delta))\\right).\n$$\nFor the special case $\\Delta=\\pi$ (nominal perfect destructive interference),\n$$\nP=A\\exp(\\mathrm{i}\\phi_{1})\\left(\\exp(\\mathrm{i}\\delta)+\\exp(\\mathrm{i}(\\pi-\\delta))\\right)=A\\exp(\\mathrm{i}\\phi_{1})\\left(\\exp(\\mathrm{i}\\delta)-\\exp(-\\mathrm{i}\\delta)\\right)=2\\,\\mathrm{i}\\,A\\,\\exp(\\mathrm{i}\\phi_{1})\\sin(\\delta).\n$$\nTherefore,\n$$\n|P|=2\\,A\\,|\\sin(\\delta)|.\n$$\nSince the nominal magnitude is $|P_{0}|=|A\\exp(\\mathrm{i}\\phi_{1})+A\\exp(\\mathrm{i}(\\phi_{1}+\\pi))|=0$, the absolute magnitude error equals $|P|$ in this case. This is an exact expression for all $\\delta$. For small $|\\delta|\\ll 1$, the leading behavior is $|P|\\approx 2\\,A\\,|\\delta|$, but the exact closed form $2\\,A\\,|\\sin(\\delta)|$ suffices as the requested estimate of the error in $|P|$ induced by the antisymmetric phase perturbations.\n\nThe quantity $|P|$ is to be reported in pascals, and all angles are in radians.",
            "answer": "$$\\boxed{2\\,A\\,|\\sin(\\delta)|}$$"
        },
        {
            "introduction": "The validity of any computational acoustic analysis hinges on the fidelity of the numerical solver to the underlying physical principles. Since superposition is a direct consequence of the linearity of the governing equations, it is essential to verify that our numerical tools preserve this property. This exercise guides you through the process of creating a fundamental verification test for a Helmholtz equation solver, ensuring that the computed field scales correctly with the source amplitude and thus respects the superposition principle at a foundational level .",
            "id": "4145617",
            "problem": "You are to implement, from first principles, a numerical verification of the superposition principle in linear acoustics by checking whether a computed acoustic pressure field scales linearly with source amplitude across a spatial domain, within specified tolerances. The fundamental physical base shall be the linearized equations of acoustics under time-harmonic excitation in a homogeneous, stationary medium of constant density and sound speed. The governing frequency-domain partial differential equation to be discretized is the homogeneous-pressure Helmholtz equation with an inhomogeneous source, subject to homogeneous Dirichlet boundary conditions on a bounded rectangle. All physical and numerical parameters must be handled in a scientifically consistent manner.\n\nFundamental base:\n- The linearized momentum equation for acoustics is $ \\rho_0 \\, \\partial \\mathbf{v} / \\partial t = - \\nabla p $, where $ p $ is acoustic pressure, $ \\mathbf{v} $ is particle velocity, and $ \\rho_0 $ is the ambient density.\n- The linearized continuity equation is $ \\partial \\rho / \\partial t + \\rho_0 \\, \\nabla \\cdot \\mathbf{v} = 0 $.\n- For time-harmonic fields with angular frequency $ \\omega $, assume $ p(\\mathbf{x},t) = \\Re\\{ \\hat{p}(\\mathbf{x}) e^{- i \\omega t} \\} $ and similarly for $ \\mathbf{v} $. In a homogeneous medium with constant sound speed $ c $ and density $ \\rho_0 $, these reduce to the scalar Helmholtz equation for pressure, $ \\nabla^2 \\hat{p} + k^2 \\hat{p} = - \\hat{s} $, where $ k = \\omega / c $ is the acoustic wavenumber and $ \\hat{s} $ is an effective source term representing body forcing. The superposition principle predicts that if $ \\hat{s} $ is scaled by a factor $ \\alpha $, the solution $ \\hat{p} $ should scale by the same factor $ \\alpha $ provided the operator is linear and boundary conditions are homogeneous.\n\nYour program must:\n- Discretize the two-dimensional domain $ \\Omega = [0,L_x] \\times [0,L_y] $ using a uniform Cartesian grid of $ N_x \\times N_y $ points, where $ N_x \\ge 3 $ and $ N_y \\ge 3 $. Use second-order central finite differences to approximate $ \\nabla^2 \\hat{p} $, and impose homogeneous Dirichlet boundary conditions $ \\hat{p} = 0 $ on $ \\partial \\Omega $. The discrete linear system must be assembled for interior nodes only.\n- Construct a spatially localized Gaussian source $ \\hat{s}(x,y) = A_s \\exp\\!\\big( -\\frac{(x-x_0)^2 + (y-y_0)^2}{2 \\sigma^2} \\big) $ centered at $ x_0 = L_x/2 $, $ y_0 = L_y/2 $, with width $ \\sigma $. The amplitude $ A_s $ must be given in pascals per square meter so that the resulting pressure field has units of pascals. Treat $ \\hat{s} $ as a volumetric source term in the Helmholtz equation. The numerical discretization must be scientifically consistent with these units.\n- Solve the discrete linear system $ \\mathbf{A} \\, \\mathbf{p} = - \\mathbf{s} $ for the base source amplitude $ A_s $ to obtain the base interior pressure vector $ \\mathbf{p}_0 $ in pascals. Then, for each scaling factor $ \\alpha $, form the scaled source $ \\alpha \\mathbf{s} $ and solve $ \\mathbf{A} \\, \\mathbf{p}_\\alpha = - \\alpha \\mathbf{s} $ to obtain $ \\mathbf{p}_\\alpha $.\n- Verify numerical linearity by computing the infinity-norm deviation $ \\Delta_\\infty = \\max_i | p_{\\alpha,i} - \\alpha \\, p_{0,i} | $ and the reference magnitude $ M_\\infty = \\max_i | \\alpha \\, p_{0,i} | $. Declare the test to pass if $ \\Delta_\\infty \\le \\varepsilon_{\\mathrm{abs}} + \\varepsilon_{\\mathrm{rel}} \\, M_\\infty $, where $ \\varepsilon_{\\mathrm{abs}} $ is an absolute tolerance in pascals and $ \\varepsilon_{\\mathrm{rel}} $ is a dimensionless relative tolerance.\n\nPhysical constants and units:\n- Sound speed must be set to $ c = 343 \\, \\mathrm{m/s} $.\n- Frequency must be specified in hertz so that $ \\omega = 2 \\pi f $ (radians per second) and $ k = \\omega / c $ (radians per meter).\n- Domain lengths must be specified in meters.\n- All pressures must be in pascals, and tolerances $ \\varepsilon_{\\mathrm{abs}} $ must be in pascals.\n\nAngle unit:\n- Any angle that appears (e.g., in $ \\omega $ or $ k $) is to be treated in radians.\n\nYour program must produce, for the following test suite of parameter sets, a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result must be a boolean indicating whether the linearity check passed for that parameter set.\n\nTest suite (each tuple is $(L_x, L_y, N_x, N_y, f, A_s, \\sigma, \\alpha, \\varepsilon_{\\mathrm{abs}}, \\varepsilon_{\\mathrm{rel}})$):\n1. Happy path: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 2.5, 1.0\\times 10^{-10}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$.\n2. Zero scaling boundary case: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 0.0, 1.0\\times 10^{-12}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$.\n3. Large scaling factor stress test: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 100.0, 1.0\\times 10^{-9}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$.\n4. Coarse grid edge case: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 12, 9, 50\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 5.0, 1.0\\times 10^{-10}\\,\\mathrm{Pa}, 1.0\\times 10^{-12})$.\n5. Tight tolerance failure sentinel: $(1.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 64, 64, 1000\\,\\mathrm{Hz}, 1.0\\,\\mathrm{Pa/m^2}, 0.05\\,\\mathrm{m}, 3.0, 0.0\\,\\mathrm{Pa}, 0.0)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4},\\mathrm{result5}]$, where each $ \\mathrm{resulti} $ is either $ \\mathrm{True} $ or $ \\mathrm{False} $.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of linear acoustics, mathematically well-posed, and provides a complete, consistent, and formalizable set of requirements for a numerical verification task.\n\nThe core of the problem is to verify the superposition principle for the time-harmonic acoustic wave equation, which is the linear Helmholtz equation. The principle of superposition, a direct consequence of linearity, states that if a system's input is scaled by a factor, its output is scaled by the same factor. Here, the input is a source term $ \\hat{s} $ and the output is the acoustic pressure field $ \\hat{p} $.\n\nThe implementation proceeds in four stages: discretization of the governing partial differential equation (PDE), assembly of the resulting linear algebraic system, solution of the system for two different source scalings, and a final quantitative comparison of the solutions.\n\n**1. Discretization of the Helmholtz Equation**\n\nThe governing PDE for the complex pressure amplitude $ \\hat{p}(x,y) $ in a two-dimensional homogeneous medium is the Helmholtz equation:\n$$\n\\nabla^2 \\hat{p} + k^2 \\hat{p} = - \\hat{s}(x,y)\n$$\nwhere $ \\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} $ is the Laplacian operator, $ k = \\omega/c $ is the acoustic wavenumber with angular frequency $ \\omega = 2 \\pi f $ and sound speed $ c $. The problem is defined on a rectangular domain $ \\Omega = [0, L_x] \\times [0, L_y] $ with homogeneous Dirichlet boundary conditions, $ \\hat{p} = 0 $ on the boundary $ \\partial\\Omega $.\n\nWe discretize this domain using a uniform Cartesian grid with $ N_x $ points in the $ x $-direction and $ N_y $ points in the $ y $-direction. The grid spacings are $ h_x = L_x / (N_x - 1) $ and $ h_y = L_y / (N_y - 1) $. A grid point is denoted by $ (x_i, y_j) $ where $ x_i = i h_x $ for $ i=0, \\dots, N_x-1 $ and $ y_j = j h_y $ for $ j=0, \\dots, N_y-1 $. The discrete pressure at this point is $ \\hat{p}_{i,j} $.\n\nThe Laplacian operator is approximated using a second-order central finite difference scheme. At an interior grid point $ (x_i, y_j) $, where $ 1 \\le i \\le N_x-2 $ and $ 1 \\le j \\le N_y-2 $, the PDE becomes:\n$$\n\\frac{\\hat{p}_{i-1,j} - 2\\hat{p}_{i,j} + \\hat{p}_{i+1,j}}{h_x^2} + \\frac{\\hat{p}_{i,j-1} - 2\\hat{p}_{i,j} + \\hat{p}_{i,j+1}}{h_y^2} + k^2 \\hat{p}_{i,j} = - \\hat{s}_{i,j}\n$$\nwhere $ \\hat{s}_{i,j} $ is the source term evaluated at $ (x_i, y_j) $. The boundary conditions $ \\hat{p}=0 $ are enforced by setting the pressure values on the boundary grid points to $ 0 $. Rearranging the terms for the unknown $ \\hat{p}_{i,j} $ gives the discrete linear equation for each interior point:\n$$\n\\frac{1}{h_x^2} \\hat{p}_{i-1,j} + \\frac{1}{h_x^2} \\hat{p}_{i+1,j} + \\frac{1}{h_y^2} \\hat{p}_{i,j-1} + \\frac{1}{h_y^2} \\hat{p}_{i,j+1} + \\left(k^2 - \\frac{2}{h_x^2} - \\frac{2}{h_y^2}\\right) \\hat{p}_{i,j} = - \\hat{s}_{i,j}\n$$\n\n**2. Linear System Formulation**\n\nThe set of discrete equations for all $ (N_x-2)(N_y-2) $ interior points forms a large, sparse system of linear equations, which can be expressed in matrix form as:\n$$\n\\mathbf{A} \\mathbf{p} = \\mathbf{b}\n$$\nHere, $ \\mathbf{p} $ is a vector of length $ N_{int} = (N_x-2)(N_y-2) $ containing the unknown complex pressure amplitudes $ \\hat{p}_{i,j} $ at the interior grid points, ordered using a row-major flattening scheme. The right-hand side vector $ \\mathbf{b} = -\\mathbf{s} $, where $ \\mathbf{s} $ is the flattened vector of source term values at the same interior points. The matrix $ \\mathbf{A} $ is a sparse, complex-valued matrix of size $ N_{int} \\times N_{int} $ representing the discretized Helmholtz operator.\n\nA robust and elegant method for constructing $ \\mathbf{A} $ is via Kronecker products. The discrete 2D Laplacian operator $ L_{2D} $ can be expressed as:\n$$\nL_{2D} = I_y \\otimes L_{1D,x} + L_{1D,y} \\otimes I_x\n$$\nwhere $ L_{1D,x} $ and $ L_{1D,y} $ are the sparse matrices representing the 1D second-order finite difference Laplacian in the $ x $ and $ y $ directions, respectively, and $ I_x $ and $ I_y $ are identity matrices of appropriate sizes. The full system matrix $ \\mathbf{A} $ is then:\n$$\n\\mathbf{A} = L_{2D} + k^2 I\n$$\nwhere $ I $ is the identity matrix of size $ N_{int} $. This construction yields a sparse matrix that can be solved efficiently.\n\n**3. Numerical Verification Procedure**\n\nThe verification of the superposition principle is performed as follows. First, the source vector $ \\mathbf{s} $ is constructed from the specified Gaussian function with base amplitude $ A_s $. The linear system is solved for the base pressure field $ \\mathbf{p}_0 $:\n$$\n\\mathbf{A} \\mathbf{p}_0 = -\\mathbf{s}\n$$\nNext, the source is scaled by a factor $ \\alpha $, and the system is solved again for the scaled pressure field $ \\mathbf{p}_\\alpha $:\n$$\n\\mathbf{A} \\mathbf{p}_\\alpha = -(\\alpha \\mathbf{s})\n$$\nDue to the linearity of the matrix equation, the exact analytical solution for the scaled system is simply $ \\alpha \\mathbf{p}_0 $, since $ \\mathbf{A}(\\alpha \\mathbf{p}_0) = \\alpha (\\mathbf{A} \\mathbf{p}_0) = \\alpha(-\\mathbf{s}) = -(\\alpha\\mathbf{s}) $. However, numerical solutions obtained using finite-precision floating-point arithmetic will exhibit small discrepancies. The goal is to quantify this numerical deviation.\n\nThe deviation is measured by the infinity-norm of the difference between the computed scaled solution $ \\mathbf{p}_\\alpha $ and the scaled base solution $ \\alpha \\mathbf{p}_0 $:\n$$\n\\Delta_\\infty = \\max_i | p_{\\alpha,i} - \\alpha p_{0,i} |\n$$\nThis deviation is compared against a mixed absolute-relative tolerance criterion. The reference magnitude is the infinity-norm of the expected scaled solution:\n$$\nM_\\infty = \\max_i | \\alpha p_{0,i} |\n$$\nThe superposition principle is considered numerically verified if the deviation is within the specified tolerance bounds:\n$$\n\\Delta_\\infty \\le \\varepsilon_{\\mathrm{abs}} + \\varepsilon_{\\mathrm{rel}} M_\\infty\n$$\nwhere $ \\varepsilon_{\\mathrm{abs}} $ is the absolute tolerance (in Pascals) and $ \\varepsilon_{\\mathrm{rel}} $ is the dimensionless relative tolerance. This check confirms that the numerical implementation, including the linear solver, behaves linearly up to a predictable and controllable level of floating-point error. For the special case where $ \\alpha = 0 $, the scaled source is zero, leading to an expected solution of zero. The check simplifies to $ \\Delta_\\infty = \\max_i | p_{\\alpha,i} | \\le \\varepsilon_{\\mathrm{abs}} $.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.sparse\nimport scipy.sparse.linalg\n\ndef _create_laplacian_1d(num_points, h):\n    \"\"\"\n    Creates a 1D finite difference Laplacian matrix for interior points.\n\n    Args:\n        num_points (int): Total number of grid points in the dimension.\n        h (float): Grid spacing.\n\n    Returns:\n        scipy.sparse.csr_matrix: The (num_points-2) x (num_points-2) sparse matrix.\n    \"\"\"\n    M = num_points - 2\n    if M <= 0:\n        return scipy.sparse.csr_matrix((0, 0))\n    \n    # Stencil for d^2/dx^2 is [1, -2, 1] / h^2\n    diag_vals = np.ones(M, dtype=np.float64)\n    offsets = [-1, 0, 1]\n    L_1d = scipy.sparse.spdiags([diag_vals, -2 * diag_vals, diag_vals], offsets, M, M, format='csr') / h**2\n    return L_1d\n\ndef _run_verification(Lx, Ly, Nx, Ny, f, As, sigma, alpha, eps_abs, eps_rel):\n    \"\"\"\n    Performs the superposition principle verification for a single test case.\n    \"\"\"\n    # Physical and numerical constants\n    C_SOUND = 343.0\n    \n    # Discretization parameters\n    hx = Lx / (Nx - 1)\n    hy = Ly / (Ny - 1)\n    \n    # Physics parameters\n    omega = 2.0 * np.pi * f\n    k = omega / C_SOUND\n    \n    # Interior grid dimensions\n    Nx_int = Nx - 2\n    Ny_int = Ny - 2\n    N_int = Nx_int * Ny_int\n\n    if N_int == 0:\n        # No interior points. The pressure vector is empty.\n        # This case is excluded by problem constraints (Nx, Ny >= 3),\n        # but for robustness, we define success as the deviation (0) being\n        # less than or equal to the absolute tolerance.\n        return 0.0 <= eps_abs\n\n    # Assemble the Helmholtz operator matrix A using Kronecker products\n    L_1d_x = _create_laplacian_1d(Nx, hx)\n    L_1d_y = _create_laplacian_1d(Ny, hy)\n    \n    I_x = scipy.sparse.identity(Nx_int)\n    I_y = scipy.sparse.identity(Ny_int)\n    \n    L_2d = scipy.sparse.kron(I_y, L_1d_x) + scipy.sparse.kron(L_1d_y, I_x)\n    A = L_2d + (k**2) * scipy.sparse.identity(N_int)\n    \n    # Use complex numbers as is standard for frequency-domain problems\n    A = A.astype(np.complex128)\n\n    # Assemble the source vector s\n    x_int = np.linspace(hx, Lx - hx, Nx_int)\n    y_int = np.linspace(hy, Ly - hy, Ny_int)\n    X_int, Y_int = np.meshgrid(x_int, y_int)\n    \n    x0, y0 = Lx / 2.0, Ly / 2.0\n    source_grid = As * np.exp(-((X_int - x0)**2 + (Y_int - y0)**2) / (2.0 * sigma**2))\n    s_vec = source_grid.flatten().astype(np.complex128)\n    \n    # We solve Ap = -s. The right-hand side is -s.\n    rhs_base = -s_vec\n    \n    # Solve for the base pressure field p0\n    p0 = scipy.sparse.linalg.spsolve(A, rhs_base)\n    \n    # Solve for the scaled pressure field p_alpha\n    rhs_scaled = -alpha * s_vec\n    p_alpha = scipy.sparse.linalg.spsolve(A, rhs_scaled)\n    \n    # Perform the verification check\n    # The comparison alpha * p0 represents the expected result from linearity\n    expected_p_alpha = alpha * p0\n    \n    # Calculate infinity-norm deviation\n    # Using np.abs for complex magnitude\n    delta_inf = np.max(np.abs(p_alpha - expected_p_alpha))\n    \n    # Calculate reference magnitude\n    M_inf = np.max(np.abs(expected_p_alpha))\n    \n    # Apply the verification criterion\n    passed = delta_inf <= eps_abs + eps_rel * M_inf\n    \n    return passed\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Lx, Ly, Nx, Ny, f, As, sigma, alpha, eps_abs, eps_rel)\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 2.5, 1.0e-10, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 0.0, 1.0e-12, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 100.0, 1.0e-9, 1.0e-12),\n        (1.0, 1.0, 12, 9, 50.0, 1.0, 0.05, 5.0, 1.0e-10, 1.0e-12),\n        (1.0, 1.0, 64, 64, 1000.0, 1.0, 0.05, 3.0, 0.0, 0.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = _run_verification(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}