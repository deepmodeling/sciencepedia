{
    "hands_on_practices": [
        {
            "introduction": "本实践旨在建立声压释放边界条件的基本物理推论。通过从第一性原理推导平面波的反射过程，我们将巩固对此类边界条件如何强制产生特定的相位关系并决定波在相互作用后的传播方向的理解。这是一项波动物理学中的基础性练习()。",
            "id": "4120025",
            "problem": "考虑一种均匀、无粘性、可压缩流体，其占据 $z>0$ 的半空间，具有恒定的密度 $\\rho$ 和声速 $c$。一列角频率为 $\\omega$ 的时谐平面声波从流体内部入射到位于 $z=0$ 的平直边界上。该边界是压力释放（声软）边界，因此声压满足狄利克雷边界条件 $p(x,z=0,t)=0$（对所有 $x$ 和 $t$ 成立）。设入射波矢量与从流体指向边界的单位法向量之间的夹角为 $\\theta \\in (0,\\pi/2)$，并假设问题是二维的，仅依赖于 $x$-$z$ 平面。\n\n从线性声学方程和状态方程出发，在时谐假设下，推导复声压幅值 $p(x,z)$ 所满足的标量亥姆霍兹偏微分方程 (PDE)。然后，仅利用边界条件、介质的均匀性和边界的平移不变性，从第一性原理证明波矢量平行于边界的分量在反射时守恒。最后，确定复声压反射系数 $R_p$，其在 $z=0$ 处定义为 $p_r = R_p\\,p_i$，其中 $p_i$ 和 $p_r$ 分别是入射和反射的复声压场。\n\n最终答案应为 $R_p$ 的一个单一闭式表达式（无量纲）。无需进行数值舍入。如果需要，所有角度都应以弧度为单位。",
            "solution": "该问题要求进行三个与平面声波从压力释放边界反射相关的不同推导。我们将从线性声学的基本原理出发，依次解决每个部分。\n\n在平衡密度为 $\\rho_0$、平衡压力为 $p_0$ 的均匀、无粘性、可压缩流体中，声学的控制方程是线性化欧拉方程（动量守恒）和连续性方程（质量守恒）。对于压力 $p$、密度 $\\rho'$ 和流体速度 $\\mathbf{u}$ 的小扰动，这些方程为：\n$$\n\\rho_0 \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p \\quad \\text{(动量)}\n$$\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{u} = 0 \\quad \\text{(连续性)}\n$$\n该方程组通过线性化状态方程来封闭，该方程关联了等熵过程中的压力和密度扰动：\n$$\np = c^2 \\rho'\n$$\n其中 $c = \\sqrt{(\\partial p/\\partial \\rho)_S}$ 是声速，在这个均匀介质中是常数。\n\n**第一部分：亥姆霍兹方程的推导**\n\n我们的目标是将这三个方程组合成一个关于声压 $p$ 的单一偏微分方程 (PDE)。\n\n首先，我们对动量方程取散度：\n$$\n\\nabla \\cdot \\left( \\rho_0 \\frac{\\partial \\mathbf{u}}{\\partial t} \\right) = -\\nabla \\cdot (\\nabla p)\n$$\n由于 $\\rho_0$ 是常数，且空间和时间导数可交换，我们得到：\n$$\n\\rho_0 \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{u}) = -\\nabla^2 p\n$$\n接下来，我们对连续性方程取时间导数：\n$$\n\\frac{\\partial}{\\partial t} \\left( \\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{u} \\right) = 0\n$$\n$$\n\\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_0 \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n现在，将状态方程中的 $\\rho' = p/c^2$ 代入此结果：\n$$\n\\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} + \\rho_0 \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n我们可以从动量方程的散度中分离出 $\\rho_0 \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{u})$ 项，得到 $\\rho_0 \\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{u}) = -\\nabla^2 p$。将其代入前一个方程可得：\n$$\n\\frac{1}{c^2} \\frac{\\partial^2 p}{\\partial t^2} - \\nabla^2 p = 0\n$$\n这就是关于压力场 $p(x,z,t)$ 的齐次声波方程。\n\n问题指定了角频率为 $\\omega$ 的时谐波。因此，我们对压力采用时谐假设，将总压力场表示为一个复数的实部。遵循物理学和工程学中的标准约定，我们将完整的含时压力写为 $p_{total}(x,z,t) = p(x,z)e^{-i\\omega t}$，其中 $p(x,z)$ 是复声压幅值。将其代入波动方程：\n$$\n\\nabla^2 (p(x,z)e^{-i\\omega t}) - \\frac{1}{c^2} \\frac{\\partial^2}{\\partial t^2} (p(x,z)e^{-i\\omega t}) = 0\n$$\n由于 $p(x,z)$ 不依赖于时间 $t$，我们可以对 $t$ 进行微分：$\\frac{\\partial}{\\partial t} (e^{-i\\omega t}) = -i\\omega e^{-i\\omega t}$ 和 $\\frac{\\partial^2}{\\partial t^2} (e^{-i\\omega t}) = (-i\\omega)^2 e^{-i\\omega t} = -\\omega^2 e^{-i\\omega t}$。方程变为：\n$$\ne^{-i\\omega t} \\nabla^2 p(x,z) - \\frac{1}{c^2} p(x,z) (-\\omega^2 e^{-i\\omega t}) = 0\n$$\n我们可以提出非零项 $e^{-i\\omega t}$：\n$$\n\\nabla^2 p(x,z) + \\frac{\\omega^2}{c^2} p(x,z) = 0\n$$\n定义波数为 $k = \\omega/c$，我们便得到了关于复声压幅值的标量亥姆霍兹偏微分方程：\n$$\n\\nabla^2 p(x,z) + k^2 p(x,z) = 0\n$$\n\n**第二部分：切向波矢量分量的守恒**\n\n流体中的总压力场 $p(x,z)$ 是入射波 $p_i(x,z)$ 和反射波 $p_r(x,z)$ 的叠加：\n$$\np(x,z) = p_i(x,z) + p_r(x,z)\n$$\n作为满足亥姆霍兹方程的平面波，入射场和反射场具有以下一般形式：\n$$\np_i(x,z) = P_i e^{i(k_{ix}x + k_{iz}z)}\n$$\n$$\np_r(x,z) = P_r e^{i(k_{rx}x + k_{rz}z)}\n$$\n其中 $P_i$ 和 $P_r$ 是复振幅，$\\mathbf{k}_i = (k_{ix}, k_{iz})$ 和 $\\mathbf{k}_r = (k_{rx}, k_{rz})$ 分别是入射和反射波矢量。介质的均匀性要求两列波以相同的速度 $c$ 传播，因此它们的波数大小必须相同：$|\\mathbf{k}_i| = |\\mathbf{k}_r| = k = \\omega/c$。\n\n边界条件是位于 $z=0$ 的压力释放表面，这意味着在所有时间，边界上所有点的总声压均为零。用复振幅表示，即：\n$$\np(x,z=0) = 0 \\quad \\text{对所有 } x\n$$\n将入射波和反射波的表达式代入边界条件：\n$$\np_i(x,0) + p_r(x,0) = 0\n$$\n$$\nP_i e^{i(k_{ix}x + k_{iz} \\cdot 0)} + P_r e^{i(k_{rx}x + k_{rz} \\cdot 0)} = 0\n$$\n$$\nP_i e^{ik_{ix}x} + P_r e^{ik_{rx}x} = 0\n$$\n这个方程必须对边界上所有的 $x$ 值都成立。这是边界具有平移不变性的关键推论。函数族 $\\{e^{i\\lambda x} | \\lambda \\in \\mathbb{R}\\}$ 构成一组线性无关的基函数。要使两个此类函数的线性组合对所有 $x$ 恒为零，必须满足以下两个条件之一：\n1. 系数均为零（$P_i=0$ 且 $P_r=0$），这对应于没有波的平凡情况。\n2. 指数相同（$k_{ix} = k_{rx}$），且系数之和为零（$P_i + P_r = 0$）。\n\n假设存在非平凡的入射波（$P_i \\neq 0$），则第二个条件必须成立。因此，我们必须有：\n$$\nk_{ix} = k_{rx}\n$$\n这就从第一性原理（均匀性、平移不变性和边界条件）证明了波矢量平行于边界的分量在反射时是守恒的。这是反射的斯涅尔定律的基础。\n\n**第三部分：压力反射系数的确定**\n\n复声压反射系数 $R_p$ 由在边界 $z=0$ 处求值的关系式 $p_r = R_p p_i$ 定义。\n$$\nR_p = \\frac{p_r(x,z=0)}{p_i(x,z=0)}\n$$\n使用在 $z=0$ 处的平面波表达式：\n$$\nR_p = \\frac{P_r e^{ik_{rx}x}}{P_i e^{ik_{ix}x}}\n$$\n根据第二部分的结果，我们知道 $k_{ix} = k_{rx}$。$R_p$ 的表达式简化为复振幅之比：\n$$\nR_p = \\frac{P_r}{P_i}\n$$\n同样根据第二部分，边界条件要求 $P_i + P_r = 0$，这意味着 $P_r = -P_i$。将此代入 $R_p$ 的表达式：\n$$\nR_p = \\frac{-P_i}{P_i} = -1\n$$\n因此，对于入射到压力释放边界的平面波，其复声压反射系数为 $-1$。这表明在边界处，反射声波的振幅与入射波相同，但相位完全相反（相移为 $\\pi$ 弧度），从而确保它们的和恒为零。此结果与入射角 $\\theta$ 无关。",
            "answer": "$$\n\\boxed{-1}\n$$"
        },
        {
            "introduction": "现实世界中的几何形状常常包含尖角，这会给数值模拟带来巨大挑战。本分析练习旨在探究具有声软边界的凹角附近的声场行为，揭示场奇异性的数学根源()。理解这种现象对于设计精确的计算模型和正确解释其结果至关重要。",
            "id": "4120022",
            "problem": "考虑一个二维时谐声压场 $p(x,y)$，它由标量亥姆霍兹偏微分方程 (PDE) $\\nabla^{2}p + k^{2}p = 0$ 控制，其中波数 $k > 0$ 为实数。该场位于一个平面楔形域中原点附近。在极坐标 $(r,\\theta)$ 中，该楔形域由 $0 < \\theta < \\omega$ 定义，其内角 $\\omega \\in (\\pi,2\\pi)$。楔形边界 $\\theta = 0$ 和 $\\theta = \\omega$ 上施加了压力释放（声软）的狄利克雷边界条件 $p = 0$。假设在顶点处没有源，且解 $p$ 是局部平方可积的。\n\n从应用于亥姆霍兹偏微分方程的极坐标下分离变量法的基本原理出发，构建与楔形相关的局部角向本征问题，并确定容许的角向本征值。利用分离变量中出现的径向方程，推导出当 $r \\to 0$ 时 $p(r,\\theta)$ 的主阶渐近行为，并确定控制顶点附近局部行为的奇异性指数。对于特定的凹角 $\\omega = \\tfrac{3\\pi}{2}$，计算最小的正奇异性指数。\n\n你的最终答案必须是一个实数，表示 $\\omega = \\tfrac{3\\pi}{2}$ 时最小的正奇异性指数。不需要四舍五入。",
            "solution": "解题过程通过将分离变量法应用于极坐标中的亥姆霍兹方程来展开。\n\n二维极坐标 $(r, \\theta)$ 中的亥姆霍兹方程 $\\nabla^{2}p + k^{2}p = 0$ 写为：\n$$\n\\frac{1}{r} \\frac{\\partial}{\\partial r} \\left(r \\frac{\\partial p}{\\partial r}\\right) + \\frac{1}{r^2} \\frac{\\partial^2 p}{\\partial \\theta^2} + k^2 p = 0\n$$\n我们寻求形式为 $p(r, \\theta) = R(r)\\Theta(\\theta)$ 的可分离解。将此代入偏微分方程得到：\n$$\n\\frac{1}{r} (r R')' \\Theta + \\frac{1}{r^2} R \\Theta'' + k^2 R \\Theta = 0\n$$\n其中撇号表示对函数的单个参数求导。乘以 $\\frac{r^2}{R\\Theta}$ 即可分离变量：\n$$\n\\frac{r^2}{R} R'' + \\frac{r}{R} R' + \\frac{\\Theta''}{\\Theta} + k^2 r^2 = 0\n$$\n重新整理各项，分离依赖于 $r$ 的部分和依赖于 $\\theta$ 的部分：\n$$\n\\frac{r^2 R'' + r R'}{R} + k^2 r^2 = - \\frac{\\Theta''}{\\Theta}\n$$\n由于左边只依赖于 $r$，右边只依赖于 $\\theta$，因此两边都必须等于一个常数。设此分离常数为 $\\nu^2$。这产生了两个常微分方程 (ODE)：\n\n1.  **角向本征问题：**\n    $$\n    -\\frac{\\Theta''}{\\Theta} = \\nu^2 \\implies \\Theta''(\\theta) + \\nu^2 \\Theta(\\theta) = 0\n    $$\n    边界条件 $p(r, 0) = 0$ 和 $p(r, \\omega) = 0$ 转化为对于非平凡解（$R(r) \\not\\equiv 0$）有 $\\Theta(0) = 0$ 和 $\\Theta(\\omega) = 0$。此常微分方程的通解为 $\\Theta(\\theta) = A\\cos(\\nu\\theta) + B\\sin(\\nu\\theta)$。\n    应用第一个边界条件 $\\Theta(0) = 0$：\n    $$\n    A\\cos(0) + B\\sin(0) = A = 0\n    $$\n    因此，解必须具有 $\\Theta(\\theta) = B\\sin(\\nu\\theta)$ 的形式。\n    应用第二个边界条件 $\\Theta(\\omega) = 0$：\n    $$\n    B\\sin(\\nu\\omega) = 0\n    $$\n    对于非平凡解，我们需要 $B \\neq 0$，这意味着 $\\sin(\\nu\\omega) = 0$。当 $\\nu\\omega = n\\pi$（对于任意整数 $n$）时，此条件得到满足。\n    因此，容许的本征值为：\n    $$\n    \\nu_n = \\frac{n\\pi}{\\omega}, \\quad \\text{for } n = 1, 2, 3, \\ldots\n    $$\n    我们取 $n$ 为正整数，因为 $n=0$ 会得到平凡解 $\\Theta(\\theta) = 0$，而负整数不会产生新的线性无关的本征函数（因为 $\\sin(-x) = -\\sin(x)$）。相应的本征函数为 $\\Theta_n(\\theta) = \\sin\\left(\\frac{n\\pi}{\\omega}\\theta\\right)$。\n\n2.  **径向方程：**\n    $$\n    r^2 R_n'' + r R_n' + (k^2 r^2 - \\nu_n^2) R_n = 0\n    $$\n    这是阶数为 $\\nu_n$ 的贝塞尔微分方程。其通解是第一类贝塞尔函数 $J_{\\nu_n}(kr)$ 和第二类贝塞尔函数 $Y_{\\nu_n}(kr)$ 的线性组合：\n    $$\n    R_n(r) = C_n J_{\\nu_n}(kr) + D_n Y_{\\nu_n}(kr)\n    $$\n    问题陈述指明解 $p$ 必须是局部平方可积的，并且在顶点处没有源。我们考察当 $r \\to 0$ 时贝塞尔函数的行为。对于非整数 $\\nu > 0$，它们的渐近形式为：\n    $$\n    J_{\\nu}(z) \\sim \\frac{1}{\\Gamma(\\nu+1)}\\left(\\frac{z}{2}\\right)^{\\nu} \\quad \\text{as } z \\to 0^{+}\n    $$\n    $$\n    Y_{\\nu}(z) \\sim -\\frac{\\Gamma(\\nu)}{\\pi}\\left(\\frac{2}{z}\\right)^{\\nu} \\quad \\text{as } z \\to 0^{+}\n    $$\n    在我们的问题中，阶数为 $\\nu_n = \\frac{n\\pi}{\\omega} > 0$。当 $r \\to 0$ 时，$Y_{\\nu_n}(kr)$ 的行为类似于 $r^{-\\nu_n}$，在原点处是奇异的。具有这种行为的项会违反顶点处无源的条件，更严格地说，会违反局部平方可积（或有限局部能量）的条件，该条件要求解的奇异性低于 $r^{-1}$。由于 $\\nu_n > 0$，所以 $Y_{\\nu_n}$ 项总是奇异性过强。因此，我们必须对所有 $n$ 设定 $D_n = 0$。\n\n完整解是所有有效模式的叠加：\n$$\np(r, \\theta) = \\sum_{n=1}^{\\infty} C_n J_{\\nu_n}(kr) \\sin\\left(\\frac{n\\pi}{\\omega}\\theta\\right)\n$$\n我们关心的是当 $r \\to 0$ 时的主阶渐近行为。该行为由级数中衰减最慢（或增长最快）的项主导，这对应于 $r$ 的最小正指数。第 $n$ 项的径向行为由 $J_{\\nu_n}(kr)$ 给出，对于小的 $r$，其行为类似于 $r^{\\nu_n}$：\n$$\nJ_{\\nu_n}(kr) \\propto r^{\\nu_n} = r^{n\\pi/\\omega}\n$$\n指数为 $\\frac{\\pi}{\\omega}, \\frac{2\\pi}{\\omega}, \\frac{3\\pi}{\\omega}, \\ldots$。由于 $\\omega > 0$，最小的正指数在 $n=1$ 时出现。该指数为 $\\nu_1 = \\frac{\\pi}{\\omega}$。\n\n这个主导指数 $\\nu_1$ 就是奇异性指数。它控制着场在顶点附近的局部行为：\n$$\np(r, \\theta) \\sim C_1 r^{\\pi/\\omega} \\sin\\left(\\frac{\\pi}{\\omega}\\theta\\right) \\quad \\text{as } r \\to 0\n$$\n压力的梯度 $\\nabla p$ 的行为将类似于 $r^{(\\pi/\\omega)-1}$。对于凹角，$\\omega > \\pi$，这意味着指数 $(\\pi/\\omega) - 1$ 为负，表明在顶点处梯度是奇异的。\n\n最后，我们针对楔形角为 $\\omega = \\frac{3\\pi}{2}$ 的特定情况，计算这个最小正奇异性指数的值。\n$$\n\\text{奇异性指数} = \\nu_1 = \\frac{\\pi}{\\omega} = \\frac{\\pi}{\\frac{3\\pi}{2}} = \\frac{2}{3}\n$$\n最小的正奇异性指数是 $\\frac{2}{3}$。",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        },
        {
            "introduction": "从连续数学到离散计算的转换，不仅需要近似控制方程，还需要近似求解域的几何形状。本计算实践旨在研究一个常见的误差来源：在笛卡尔网格上对曲面边界的“阶梯式”近似()。通过量化这种误差，我们将对网格分辨率与计算精度之间的权衡建立起实践性的理解，并学习如何制定网格加密策略。",
            "id": "4120000",
            "problem": "考虑由标量亥姆霍兹方程在二维空间中控制的时间谐波声压，该声压在压力释放（声软）边界上，即压力在边界上满足等于零的狄利克雷条件。一个标准的简化公式使用狄利克雷拉普拉斯算子特征问题来表征模态波数。具体来说，对于一个具有光滑边界的有界域，第一阶模态由算子 $-\\Delta$ 的最小特征对给出，且在边界上满足狄利克雷边界条件 $p=0$，即：\n$$\n-\\Delta p = \\lambda p, \\quad p|_{\\partial \\Omega}=0.\n$$\n当边界是弯曲的（例如，圆形）但在笛卡尔网格上进行离散化时，边界会使用阶梯状掩模进行近似。即使内部的有限差分算子名义上是二阶的，这种几何近似也会在计算出的特征值和场中引入误差。您的任务是量化圆盘的第一狄利克雷特征值的阶梯近似误差，并基于第一性原理的标度律提出一个网格加密准则。\n\n从基本定律和核心定义出发，按如下方式构建计算过程：\n- 物理域是一个以原点为中心、半径为 $R$（单位：米）的圆盘，在 $r=R$ 处满足狄利克雷边界条件 $p=0$。\n- 圆盘的连续第一狄利克雷特征值由下式给出：\n$$\n\\lambda_{\\text{anal}} = \\frac{j_{0,1}^2}{R^2},\n$$\n其中 $j_{0,1}$ 是零阶第一类贝塞尔函数的第一个正零点。\n- 在一个间距为 $h$（单位：米）的均匀笛卡尔网格上近似圆盘。如果网格点的坐标 $(x,y)$ 满足 $x^2+y^2 < R^2$，则该点被视为内部点。所有其他点均被施加压力为零的条件，从而形成阶梯状的边界近似。\n- 使用标准的五点有限差分模板来近似负拉普拉斯算子 $-\\Delta_h$。\n- 构建并求解得到的矩阵特征问题，以找到数值近似的最小特征值 $\\lambda_{\\text{num}}$。\n- 将相对误差定义为 $\\varepsilon = |\\lambda_{\\text{num}} - \\lambda_{\\text{anal}}| / \\lambda_{\\text{anal}}$。\n- 假设误差标度律为 $\\varepsilon \\approx C \\frac{h}{R}$，其中 $C$ 是一个无量纲常数。\n- 您的任务是实现一个函数，该函数接收一组测试案例，每个案例包含 $(R, h, \\varepsilon_{\\text{tol}})$，其中 $\\varepsilon_{\\text{tol}}$ 是期望的误差容限。该函数应执行以下操作：\n1. 对于每个测试案例，计算数值特征值 $\\lambda_{\\text{num}}$ 和相对误差 $\\varepsilon$。\n2. 在处理完所有测试案例后，通过计算所有案例的 $\\varepsilon/(h/R)$ 比率的中位数来估计常数 $C$。\n3. 对于每个测试案例，使用估计出的 $C$ 计算达到目标容限 $\\varepsilon_{\\text{tol}}$ 所需的最大网格间距 $h_{\\max} = \\varepsilon_{\\text{tol}}R/C$。\n4. 函数应返回一个列表，其中每个元素都是一个包含三个值的三元组：计算出的相对误差 $\\varepsilon$、建议的最大网格间距 $h_{\\max}$，以及一个布尔值，指示该案例中使用的 $h$ 是否满足准则 $h \\le h_{\\max}$。",
            "solution": "任务是分析在使用有限差分法计算狄利克雷拉普拉斯算子第一特征值时，由圆形边界的阶梯近似所引入的数值误差。我们将构建计算流程，实施该流程以分析具体的测试案例，并根据观察到的误差标度律推导出一个实用的网格加密准则。\n\n**1. 连续特征问题**\n\n物理问题涉及二维域 $\\Omega$ 内的时间谐波声压 $p$。该压力场由标量亥姆霍兹方程控制。对于模态分析，这简化为负拉普拉斯算子 $-\\Delta$ 的特征值问题。域 $\\Omega$ 是一个以原点为中心、半径为 $R$ 的圆盘。边界条件为压力释放或声软类型，对应于边界 $\\partial\\Omega$ 上的齐次狄利克雷条件 $p=0$。因此，问题可表述为：\n$$\n-\\Delta p = \\lambda p \\quad \\text{在 } \\Omega \\text{ 内}, \\qquad p|_{\\partial\\Omega} = 0.\n$$\n该问题的解是特征对 $(\\lambda_k, p_k)$，其中 $\\lambda_k$ 是特征值（与模态波数相关），$p_k$ 是对应的特征函数（模态）。\n\n对于半径为 $R$ 的圆盘，特征函数在极坐标下是可分离变量的。第一阶（或基本）模态是径向对称的。最小特征值 $\\lambda_{\\text{anal}}$ 的解析表达式是已知的，由下式给出：\n$$\n\\lambda_{\\text{anal}} = \\left(\\frac{j_{0,1}}{R}\\right)^2,\n$$\n其中 $j_{0,1}$ 是零阶第一类贝塞尔函数 $J_0(x)$ 的第一个正根。其值约为 $j_{0,1} \\approx 2.4048255577$。$\\lambda$ 的单位是长度的平方的倒数，此处为 $\\text{m}^{-2}$。\n\n**2. 离散近似**\n\n为了数值求解该问题，我们采用有限差分法。连续域被一个间距为 $h$ 的均匀笛卡尔网格上的一组离散点所替代。我们定义一个覆盖方形域 $[-R, R] \\times [-R, R]$ 的计算网格。一个网格点 $(x_i, y_j)$ 如果位于圆盘内部，即 $x_i^2 + y_j^2  R^2$，则被视为*内部*点。所有其他点被视为边界的一部分，其压力固定为 $p=0$。\n\n在每个内部网格点 $(i, j)$，负拉普拉斯算子 $-\\Delta$ 使用标准的五点模板进行近似：\n$$\n(-\\Delta_h p)_{i,j} = \\frac{4p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1}}{h^2}.\n$$\n在每个内部点应用此近似会得到一个线性方程组。设 $N_{\\text{int}}$ 是内部网格点的总数。我们可以将这些点上的压力值 $p$ 表示为一个大小为 $N_{\\text{int}}$ 的向量 $\\mathbf{p}$。离散特征问题可以写成矩阵形式：\n$$\nA \\mathbf{p} = \\lambda \\mathbf{p}.\n$$\n这里，$A$ 是一个 $N_{\\text{int}} \\times N_{\\text{int}}$ 的稀疏矩阵，表示离散算子 $-\\Delta_h$。$A$ 的元素构建如下：\n- 对于每个内部点，将其二维网格坐标 $(i,j)$ 映射到一个唯一的以为索引 $k \\in \\{0, 1, \\dots, N_{\\text{int}}-1\\}$。\n- 对应于点 $k$ 的对角线元素是 $A_{k,k} = 4/h^2$。\n- 对于点 $k$ 的每个同样是内部点（索引为 $k'$）的邻居，设置一个非对角线元素：$A_{k,k'} = -1/h^2$。\n- 如果一个邻居在边界上或边界外，其压力值为 $0$（狄利克雷条件）。这一贡献自然地包含在模板求和中，因此不需要为这些边界相互作用设置特定的矩阵元素。\n\n最终得到的矩阵 $A$ 是实对称正定的。该矩阵的最小特征值，我们记为 $\\lambda_{\\text{num}}$，是 $\\lambda_{\\text{anal}}$ 的数值近似。它可以使用稀疏对称特征求解器高效地计算出来。\n\n**3. 误差分析与标度律**\n\n离散化引入了误差。在此公式中，误差的主要来源是对圆盘光滑、弯曲边界的“阶梯”近似。虽然五点模板在域内部具有二阶精度 $O(h^2)$，但边界处的几何误差仅为一阶 $O(h)$。这个低阶误差主导了总误差。\n\n我们将计算出的特征值的相对误差 $\\varepsilon$ 量化为：\n$$\n\\varepsilon = \\left|\\frac{\\lambda_{\\text{num}}-\\lambda_{\\text{anal}}}{\\lambda_{\\text{anal}}}\\right|.\n$$\n基于域微扰理论，主导阶误差预计与网格间距相对于域大小的比例呈线性关系：\n$$\n\\varepsilon \\approx C \\frac{h}{R},\n$$\n其中 $C$ 是一个无量纲常数，它依赖于几何形状和具体的边界实现方式，但对于小的 $h/R$ 值，它近似独立于 $h$ 和 $R$。\n\n**4. 网格加密准则**\n\n目标是确定一个合适的网格间距 $h$ 以达到期望的误差容限 $\\varepsilon_{\\text{tol}}$。首先，我们凭经验估计常数 $C$。通过对几种 $R$ 和 $h$ 的组合（即给定的测试案例）进行模拟，我们为每个案例计算比率 $\\varepsilon / (h/R)$。通过取这些值的中位数，可以获得对 $C$ 的一个稳健估计。\n\n一旦 $C$ 已知，我们可以反转标度律来确定对于给定的容限 $\\varepsilon_{\\text{tol}}$，最大允许网格间距 $h_{\\max}$：\n$$\n\\varepsilon_{\\text{tol}} \\approx C \\frac{h_{\\max}}{R} \\implies h_{\\max} \\approx \\frac{\\varepsilon_{\\text{tol}} R}{C}.\n$$\n如果一个间距为 $h$ 的给定网格满足准则 $h \\le h_{\\max}$，则认为该网格足够精细。\n\n实现的程序将执行以下步骤：\n1. 对于每个测试案例 $(R, h, \\varepsilon_{\\text{tol}})$，构建矩阵 $A$ 并计算 $\\lambda_{\\text{num}}$。\n2. 计算相应的相对误差 $\\varepsilon$。\n3. 处理完所有案例后，将缩放常数 $C$ 估计为所有计算出的 $\\varepsilon / (h/R)$ 比率的中位数。\n4. 对于每个测试案例，使用估计的 $C$ 和特定案例的 $\\varepsilon_{\\text{tol}}$ 和 $R$ 计算建议的 $h_{\\max}$。\n5. 报告每个案例计算出的三元组 $[\\varepsilon, h_{\\max}, (h \\le h_{\\max})]$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import jn_zeros\nfrom scipy.sparse import coo_matrix\nfrom scipy.sparse.linalg import eigsh\n\ndef solve():\n    \"\"\"\n    Computes staircasing error for the Dirichlet-Laplacian eigenvalue on a disk,\n    estimates the error scaling constant, and proposes a mesh refinement criterion.\n    \"\"\"\n    # The first positive zero of the Bessel function of the first kind of order zero, J0(x).\n    j01 = jn_zeros(0, 1)[0]\n    \n    # Test cases: (R, h, eps_tol)\n    # R: radius in meters\n    # h: grid spacing in meters\n    # eps_tol: target relative error tolerance (dimensionless)\n    test_cases = [\n        (1.0, 0.05, 0.02),\n        (1.0, 0.2, 0.05),\n        (0.5, 0.025, 0.01),\n        (1.0, 0.0125, 0.005),\n    ]\n\n    # --- Pass 1: Compute numerical errors for all test cases ---\n    computed_data = []\n    ratios_for_C = []\n\n    for R, h, eps_tol in test_cases:\n        # 1. Grid and Mask Generation\n        # Create a centered Cartesian grid that encloses the disk.\n        # The number of points from center to edge is determined by floor(R/h).\n        lim = int(np.floor(R / h))\n        coords = np.arange(-lim, lim + 1) * h\n        grid_dim = len(coords)\n        xx, yy = np.meshgrid(coords, coords)\n        \n        # Create a boolean mask for grid points inside the disk.\n        mask = (xx**2 + yy**2)  R**2\n        \n        n_interior = np.sum(mask)\n        \n        # Map 2D grid indices of interior points to 1D linear indices.\n        idx_map = -np.ones((grid_dim, grid_dim), dtype=int)\n        idx_map[mask] = np.arange(n_interior)\n\n        # 2. Matrix Assembly using Coordinate (COO) format for efficiency\n        row_ind, col_ind, data = [], [], []\n        \n        # Iterate over all grid points to build the discrete operator matrix.\n        for i in range(grid_dim):\n            for j in range(grid_dim):\n                if mask[i, j]:\n                    k = idx_map[i, j]\n                    \n                    # Diagonal element from the 5-point stencil (4 * p_ij)\n                    row_ind.append(k)\n                    col_ind.append(k)\n                    data.append(4.0)\n\n                    # Off-diagonal elements for neighbors (-1 * p_neighbor)\n                    # For neighbors outside the mask, the pressure is 0 (Dirichlet BC),\n                    # so they don't contribute to the matrix for interior points.\n                    for ni, nj in [(i - 1, j), (i + 1, j), (i, j - 1), (i, j + 1)]:\n                        if 0 = ni  grid_dim and 0 = nj  grid_dim and mask[ni, nj]:\n                            k_neighbor = idx_map[ni, nj]\n                            row_ind.append(k)\n                            col_ind.append(k_neighbor)\n                            data.append(-1.0)\n        \n        # Scale matrix entries by 1/h^2.\n        mat_data = np.array(data) / (h**2)\n        \n        # Create the sparse matrix and convert to CSR format for fast arithmetic.\n        A = coo_matrix((mat_data, (row_ind, col_ind)), shape=(n_interior, n_interior)).tocsr()\n        \n        # 3. Eigenvalue Computation\n        # Use a sparse symmetric eigensolver to find the smallest magnitude eigenvalue.\n        eigenvalues, _ = eigsh(A, k=1, which='SM')\n        lambda_num = eigenvalues[0]\n        \n        # 4. Error Calculation\n        lambda_anal = (j01 / R)**2\n        epsilon = np.abs(lambda_num - lambda_anal) / lambda_anal\n        \n        # Store results for the second pass.\n        computed_data.append({'R': R, 'h': h, 'eps_tol': eps_tol, 'epsilon': epsilon})\n        ratios_for_C.append(epsilon / (h / R))\n\n    # --- Pass 2: Estimate C, compute h_max, and check criterion ---\n    \n    # Estimate the scaling constant C as the median of the observed ratios.\n    C = np.median(ratios_for_C)\n    \n    final_results = []\n    for data_point in computed_data:\n        R = data_point['R']\n        h = data_point['h']\n        eps_tol = data_point['eps_tol']\n        epsilon = data_point['epsilon']\n        \n        # Calculate the recommended maximum mesh spacing h_max based on the fitted C.\n        h_max = (eps_tol * R) / C\n        \n        # Check if the given mesh spacing h meets the refinement criterion.\n        meets_criterion = h = h_max\n        \n        final_results.append([epsilon, h_max, meets_criterion])\n\n    # --- Format and Print Output ---\n    def format_case_result(res):\n        eps_val, hmax_val, meets_val = res\n        # Format booleans as lowercase 'true'/'false' for consistent output.\n        meets_str = str(meets_val).lower()\n        return f\"[{eps_val},{hmax_val},{meets_str}]\"\n\n    output_str = f\"[{','.join([format_case_result(res) for res in final_results])}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}