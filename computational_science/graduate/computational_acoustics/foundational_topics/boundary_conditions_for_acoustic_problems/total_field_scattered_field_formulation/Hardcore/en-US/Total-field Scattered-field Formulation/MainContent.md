## Introduction
The Total-Field/Scattered-Field (TF/SF) formulation is a cornerstone technique in computational wave physics, providing an elegant and powerful solution to a fundamental challenge: simulating how waves scatter from objects. The core problem it addresses is how to introduce a known incident wave (like a [plane wave](@entry_id:263752)) into a numerical domain and cleanly isolate the resulting scattered field, which contains all the information about the object's interaction. This separation is crucial for accurate analysis in fields ranging from acoustics and electromagnetics to [geophysics](@entry_id:147342).

This article provides a comprehensive overview of the TF/SF method. In the first chapter, **Principles and Mechanisms**, we will dissect the fundamental theory behind the field decomposition, explore its implementation within common [numerical schemes](@entry_id:752822) like FDTD, and discuss critical factors affecting accuracy, such as [numerical dispersion](@entry_id:145368). Following this, the **Applications and Interdisciplinary Connections** chapter will demonstrate the method's remarkable versatility, showcasing its use in advanced engineering analysis, [complex media](@entry_id:190482) like flowing fluids and [porous solids](@entry_id:154776), and in the design of photonic devices. Finally, the **Hands-On Practices** section will guide you through practical exercises to solidify your understanding of the formulation's implementation and validation, bridging the gap between theory and application.

## Principles and Mechanisms

The Total-Field/Scattered-Field (TF/SF) formulation is a powerful and widely used technique in computational wave physics for solving scattering problems. It provides a robust method for introducing a known incident wave into a numerical simulation domain while simultaneously isolating the scattered field, which is typically the quantity of interest. This chapter elucidates the fundamental principles of the TF/SF decomposition, details its numerical implementation mechanisms, and explores advanced concepts related to accuracy and application in [complex media](@entry_id:190482).

### The Fundamental Decomposition

The efficacy of the TF/SF method is predicated on the linearity of the governing acoustic wave equations. For small-amplitude perturbations in a homogeneous, lossless fluid with ambient density $\rho_0$ and sound speed $c$, the first-order equations for acoustic pressure $p$ and particle velocity $\mathbf{v}$ are:

$$
\rho_0 \frac{\partial \mathbf{v}}{\partial t} + \nabla p = \mathbf{0}
$$

$$
\frac{\partial p}{\partial t} + \rho_0 c^2 \nabla \cdot \mathbf{v} = 0
$$

The core idea of the TF/SF method is to decompose the **total field** $(p, \mathbf{v})$ into the sum of a known **incident field** $(p^{\mathrm{inc}}, \mathbf{v}^{\mathrm{inc}})$ and an unknown **scattered field** $(p^{\mathrm{scat}}, \mathbf{v}^{\mathrm{scat}})$:

$$
p = p^{\mathrm{inc}} + p^{\mathrm{scat}}
$$
$$
\mathbf{v} = \mathbf{v}^{\mathrm{inc}} + \mathbf{v}^{\mathrm{scat}}
$$

The incident field is defined as the field that would exist in the absence of any scattering objects. Therefore, $(p^{\mathrm{inc}}, \mathbf{v}^{\mathrm{inc}})$ must be a solution to the homogeneous acoustic equations throughout all of space. By substituting the decomposition into the governing equations, and leveraging the linearity of the [differential operators](@entry_id:275037), we find that the scattered field must also satisfy the same homogeneous acoustic equations in the domain exterior to the scatterer .

The distinction between the fields arises from the boundary conditions. Consider a rigid, impenetrable scatterer with surface $S$ and outward unit normal $\mathbf{n}$. The physical boundary condition requires the total normal velocity to vanish on the surface: $\mathbf{v} \cdot \mathbf{n} = 0$ on $S$. Applying the decomposition yields:

$$
(\mathbf{v}^{\mathrm{inc}} + \mathbf{v}^{\mathrm{scat}}) \cdot \mathbf{n} = 0 \quad \implies \quad \mathbf{v}^{\mathrm{scat}} \cdot \mathbf{n} = - \mathbf{v}^{\mathrm{inc}} \cdot \mathbf{n} \quad \text{on } S
$$

This crucial result transforms the problem. Instead of solving for a total field interacting with a passive boundary, we now solve for a scattered field that is actively generated by a source condition on the boundary $S$. The scattered field is precisely the response needed to enforce the physical boundary condition by canceling the incident velocity normal to the object's surface. To ensure a physically unique solution in an unbounded domain, the scattered field must also satisfy an outgoing-wave radiation condition at infinity, stipulating that scattered energy propagates away from the object.

This decomposition is not merely an algebraic convenience; it is unique. Given a well-posed physical problem (defined by the incident field and scatterer properties), the resulting scattered field is unique. This is a direct consequence of the linearity of the governing equations. If we were to assume two different scattered field solutions, $(p_1^{\mathrm{scat}}, \mathbf{v}_1^{\mathrm{scat}})$ and $(p_2^{\mathrm{scat}}, \mathbf{v}_2^{\mathrm{scat}})$, for the same problem, their difference would satisfy the homogeneous acoustic equations with zero initial conditions and zero boundary source terms. For such a well-posed system, the only possible solution is the trivial one, meaning the difference field is identically zero. Thus, the two solutions must be identical, guaranteeing the uniqueness of the scattered field and, by extension, the decomposition itself .

### The Incident Field and Acoustic Impedance

The incident field is the known input to the scattering problem. A canonical and highly useful form for the incident field is a [monochromatic plane wave](@entry_id:263295). For a pressure wave propagating in the direction of the wavevector $\mathbf{k}$, the incident pressure can be written in complex notation as:

$$
\tilde{p}^{\mathrm{inc}}(\mathbf{x}, t) = P_0 \exp(i(\mathbf{k} \cdot \mathbf{x} - \omega t))
$$

where $p^{\mathrm{inc}} = \Re\{\tilde{p}^{\mathrm{inc}}\}$. The corresponding particle velocity can be derived directly from the linearized momentum equation, $\rho_0 \partial_t \mathbf{v} = -\nabla p$. In the frequency domain, this becomes $-i\omega\rho_0 \tilde{\mathbf{v}}^{\mathrm{inc}} = -i\mathbf{k} \tilde{p}^{\mathrm{inc}}$, which gives:

$$
\tilde{\mathbf{v}}^{\mathrm{inc}} = \frac{\mathbf{k}}{\omega \rho_0} \tilde{p}^{\mathrm{inc}}
$$

For [acoustic waves](@entry_id:174227) in a homogeneous medium, the dispersion relation is $\omega = c |\mathbf{k}|$. Substituting this into the velocity expression and defining the unit propagation direction $\hat{\mathbf{k}} = \mathbf{k}/|\mathbf{k}|$, we find a fundamental relationship between the pressure and velocity fields of a plane wave:

$$
\tilde{\mathbf{v}}^{\mathrm{inc}} = \frac{\hat{\mathbf{k}}}{\rho_0 c} \tilde{p}^{\mathrm{inc}}
$$

This relation shows that for a [plane wave](@entry_id:263752), the particle velocity is always aligned with the propagation direction and is directly proportional to the pressure. The constant of proportionality, $\rho_0 c$, is the **characteristic acoustic impedance** of the medium, often denoted $Z_0$. It represents the ratio of pressure to particle velocity for a progressive [plane wave](@entry_id:263752). If we consider the component of velocity normal to a [wavefront](@entry_id:197956), where the normal $\mathbf{n}$ is aligned with $\hat{\mathbf{k}}$, we find:

$$
\frac{p^{\mathrm{inc}}(\mathbf{x}, t)}{\mathbf{n} \cdot \mathbf{v}^{\mathrm{inc}}(\mathbf{x}, t)} = \frac{p^{\mathrm{inc}}}{\hat{\mathbf{k}} \cdot (\frac{\hat{\mathbf{k}}}{\rho_0 c} p^{\mathrm{inc}})} = \rho_0 c
$$

This constant impedance relationship is a defining feature of [plane waves](@entry_id:189798) and is essential for developing [non-reflecting boundary conditions](@entry_id:174905) and understanding wave propagation across [material interfaces](@entry_id:751731) .

### The TF/SF Interface in Numerical Implementations

In a computational setting, we solve the acoustic equations on a finite grid. The TF/SF formulation is realized by partitioning this grid into two distinct regions: an inner **total-field (TF) region**, $\Omega_{\mathrm{TF}}$, which contains the scattering object, and an outer **scattered-field (SF) region**, $\Omega_{\mathrm{SF}}$, which extends to the domain boundaries. The boundary separating these two regions is a closed, purely numerical construct known as the **TF/SF interface**, $\Gamma$.

The fields computed and stored on the grid represent different physical quantities depending on the region:
- Inside $\Omega_{\mathrm{TF}}$: The numerical variables correspond to the total field, $(p^{\mathrm{T}}, \mathbf{v}^{\mathrm{T}}) = (p^{\mathrm{inc}} + p^{\mathrm{s}}, \mathbf{v}^{\mathrm{inc}} + \mathbf{v}^{\mathrm{s}})$.
- Inside $\Omega_{\mathrm{SF}}$: The numerical variables correspond to the scattered field, $(p^{\mathrm{S}}, \mathbf{v}^{\mathrm{S}}) = (p^{\mathrm{s}}, \mathbf{v}^{\mathrm{s}})$.

Since $\Gamma$ is an artificial boundary with no physical properties, the true physical fields must be continuous across it. This fundamental requirement of continuity for total pressure and total normal velocity allows us to derive the conditions that must be enforced on our computational variables at the interface .

Equating the total pressure from both sides of $\Gamma$:
$$
p^{\text{total}}|_{\text{inside}} = p^{\text{total}}|_{\text{outside}} \quad \implies \quad p^{\mathrm{T}} = p^{\mathrm{inc}} + p^{\mathrm{S}} \quad \implies \quad p^{\mathrm{T}} - p^{\mathrm{S}} = p^{\mathrm{inc}}
$$

Similarly, for the normal component of velocity:
$$
\mathbf{v}^{\text{total}} \cdot \mathbf{n}|_{\text{inside}} = \mathbf{v}^{\text{total}} \cdot \mathbf{n}|_{\text{outside}} \quad \implies \quad \mathbf{v}^{\mathrm{T}} \cdot \mathbf{n} = (\mathbf{v}^{\mathrm{inc}} + \mathbf{v}^{\mathrm{S}}) \cdot \mathbf{n} \quad \implies \quad (\mathbf{v}^{\mathrm{T}} - \mathbf{v}^{\mathrm{S}}) \cdot \mathbf{n} = \mathbf{v}^{\mathrm{inc}} \cdot \mathbf{n}
$$

These "[jump conditions](@entry_id:750965)" are the heart of the TF/SF implementation. They dictate that the difference between the computational variables across the interface must equal the known incident field evaluated at the interface. In practice, these conditions are enforced by adding **corrective source terms** to the numerical update equations for grid nodes located on or immediately adjacent to $\Gamma$.

Let's consider a Finite-Difference Time-Domain (FDTD) scheme on a staggered grid, a common choice for wave problems. In this scheme, pressure nodes might be at cell centers and velocity nodes at face centers. Consider the pressure update for a cell in the TF region, one of whose faces lies on $\Gamma$. The standard FDTD stencil for the divergence term would require a velocity value from that face. However, the velocity stored at that face belongs to the SF region. The physically correct update requires the total-field velocity. The discrepancy is precisely the incident-field velocity. The corrective source term is designed to add this missing contribution back into the update equation.

For a pressure node at location $(i_{\Gamma}, j, k)$ in the TF region, adjacent to the interface $\Gamma$ at $x = (i_{\Gamma}+1/2)\Delta x$, the standard pressure update uses the velocity $v_x$ from the SF region at $(i_{\Gamma}+1/2,j,k)$. The corrective source term $S_p$ to be added to the pressure update equation is derived to be :

$$
S_p = -\frac{\kappa \Delta t}{\Delta x} v_{x,\text{inc}}^{n+1/2}(i_{\Gamma}+1/2,j,k)
$$

where $\kappa = \rho_0 c^2$ is the bulk modulus. A similar correction is applied to the velocity update on the SF side of the interface, which uses a pressure value from the TF region.

A subtle but important implementation detail concerns the choice of which variable's [jump condition](@entry_id:176163) to enforce. On a staggered grid where velocity nodes lie on cell faces and pressure nodes at cell centers, it is natural to define the interface $\Gamma$ to lie along cell faces. In this case, the normal velocity components of the incident field are needed exactly at locations where the grid defines velocity nodes. Enforcing the normal-velocity [jump condition](@entry_id:176163) is therefore direct. Enforcing the pressure jump, by contrast, would require interpolating the incident pressure field from cell centers to the interface, which introduces error. This error manifests as **numerical leakage**, where the incident field is not perfectly canceled in the SF region. Therefore, to minimize leakage, it is preferable to enforce the [jump condition](@entry_id:176163) for the variable that is naturally collocated with the interface in the discrete grid .

### Accuracy, Stability, and Advanced Formulations

The fidelity of a TF/SF simulation depends critically on managing several sources of numerical error.

#### Numerical Dispersion and Leakage Correction

The most significant source of error is often **[numerical dispersion](@entry_id:145368)**. In any discrete grid, the [phase velocity](@entry_id:154045) of a propagating wave depends on its frequency, its direction of propagation relative to the grid axes, and the grid resolution. This is in contrast to the continuous medium, where the speed of sound $c$ is constant. The relationship between the numerical frequency $\tilde{\omega}$ and [wavevector](@entry_id:178620) $\tilde{\mathbf{k}}$ is given by the **[numerical dispersion relation](@entry_id:752786)**, which is derived by substituting a discrete plane wave [ansatz](@entry_id:184384) into the FDTD update equations. For a 2D FDTD scheme, this relation is:

$$
\sin^{2}\left(\frac{\tilde{\omega} \Delta t}{2}\right) = \left(\frac{c \Delta t}{h}\right)^{2} \left[ \sin^{2}\left(\frac{\tilde{k}_{x} h}{2}\right) + \sin^{2}\left(\frac{\tilde{k}_{y} h}{2}\right) \right]
$$

In a TF/SF simulation, the incident field is injected with the continuous frequency $\omega$. The grid, however, will only support a wave at this frequency if it has a numerical wavenumber $\tilde{k}$ that satisfies the above relation. This $\tilde{k}$ is generally not equal to the continuous wavenumber $k = \omega/c$. The difference, $\tilde{k} - k$, leads to a [phase error](@entry_id:162993) that accumulates as the wave propagates. This mismatch between the analytical incident wave and the wave the grid naturally supports is a primary cause of spurious scattering from the TF/SF interface, i.e., numerical leakage .

A powerful technique to mitigate this is to use a **dispersion-corrected** incident field. Instead of defining the incident plane wave with the continuum wavenumber $k_0 = \omega/c$, we analytically solve the [numerical dispersion relation](@entry_id:752786) for the wavenumber $k_d$ that corresponds to the desired frequency $\omega$ and propagation angle $\theta$. For a wave at $\theta = \pi/4$ in a 2D FDTD grid, this corrected wavenumber is :

$$
k_{d} = \frac{2\sqrt{2}}{h} \arcsin\left(\frac{h}{\sqrt{2} c \Delta t} \sin\left(\frac{\omega \Delta t}{2}\right)\right)
$$

By using $k_d$ to define the incident field, we create a wave that is an exact solution to the *discrete* FDTD equations. This wave propagates on the grid without generating spurious numerical artifacts, dramatically reducing leakage and improving the overall accuracy of the simulation.

#### Interaction with Absorbing Boundary Conditions

The SF region must be terminated by an [absorbing boundary condition](@entry_id:168604) (ABC) to prevent outgoing scattered waves from reflecting off the domain edge. The **Perfectly Matched Layer (PML)** is a highly effective type of ABC. A PML is an artificial layer of absorbing material designed to be reflectionless for waves incident upon it. However, this "perfectly matched" property holds only for waves that are solutions to the specific source-free, [homogeneous equations](@entry_id:163650) for which the PML was derived.

This imposes a strict constraint on the placement of the TF/SF interface relative to the PML. If the PML is placed in the TF region, it will be exposed to the total field, which is not a solution to the [homogeneous equations](@entry_id:163650) (due to the scatterer), and to the TF/SF source terms themselves. This will cause the PML to generate significant reflections. Therefore, the correct configuration is to place the entire PML strictly within the scattered-field region. In the SF region, the incident field is identically zero, and the field consists only of outgoing scattered waves, which do satisfy the [homogeneous equations](@entry_id:163650) in the background medium. For these waves, the PML performs as designed. It is also best practice to leave a buffer zone of several grid cells of the normal SF medium between the TF/SF interface and the inner boundary of the PML. This allows any residual numerical noise from the interface to decay before reaching the PML, ensuring optimal absorption .

#### Heterogeneous Media and Characteristic Analysis

The principles discussed so far can be extended to more complex scenarios, such as when the TF/SF interface coincides with a physical boundary between two media with different properties $(\rho_0^-, c^-)$ and $(\rho_0^+, c^+)$. In this case, simply enforcing the continuity of total pressure and velocity is insufficient. The physical interface itself will cause [reflection and transmission](@entry_id:156002) of the scattered wave, and the numerical scheme must capture this correctly while still performing the TF/SF split.

The rigorous approach for such problems is based on the **characteristic analysis** of the hyperbolic system of acoustic equations. The equations can be decomposed into a set of waves, or **Riemann invariants**, that propagate independently. For the 1D acoustic system normal to the interface, these invariants are:

$$
w_+ = p + Z u_n \quad (\text{propagating in the } +n \text{ direction})
$$
$$
w_- = p - Z u_n \quad (\text{propagating in the } -n \text{ direction})
$$

where $Z=\rho_0 c$ is the local [acoustic impedance](@entry_id:267232). The key insight is that at any boundary, one must only specify the value of the [characteristic variables](@entry_id:747282) that are *incoming* to the computational domain.

For a TF/SF interface on a material boundary, we must perform this analysis on each side using the local properties. On the TF side (minus side), the incoming characteristic is $w_-^-$, which must be set to its incident value, $p^{\mathrm{inc}} - Z^- u_n^{\mathrm{inc}}$. On the SF side (plus side), the incoming characteristic is $w_+^+$. To cancel the incident field in this region, its value must be set to zero. The outgoing characteristics on both sides are left free, determined by the solution. This sophisticated approach correctly injects the incident wave into the TF region, cancels it in the SF region, and simultaneously provides the physically correct transmission and reflection conditions for the scattered field at the material interface .