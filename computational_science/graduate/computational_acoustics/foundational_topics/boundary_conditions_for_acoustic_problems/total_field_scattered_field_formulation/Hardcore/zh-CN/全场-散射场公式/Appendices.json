{
    "hands_on_practices": [
        {
            "introduction": "总场/散射场 (Total-field Scattered-field, TF/SF) 方法的核心在于如何精确地在计算区域内引入一个已知的入射波场。本练习将引导你通过一个基本但至关重要的实践：为一个二维亥姆霍兹方程的二阶有限差分格式构建离散等效源项。通过从头推导这些源项并分析其精度，你将深入理解 TF/SF 方法在数值上的实现机制，这是掌握更复杂计算声学模拟的基础。",
            "id": "4148530",
            "problem": "考虑在声速为常数 $c$ 的均匀介质中的二维时谐声学问题。角频率为 $\\omega$ 的复声压 $u(x,y)$ 在自由空间中满足亥姆霍兹方程 $-\\Delta u - k^{2} u = 0$，其中 $k = \\omega/c$ 是波数，$\\Delta$ 是拉普拉斯算子。采用全场/散射场 (TF/SF) 公式将一个已知的入射场 $u^{\\text{inc}}(x,y)$ 注入一个矩形的全场区域，同时允许出射的散射波无反射地通过。\n\n设 TF/SF 边界与间距为 $h$ 的笛卡尔网格对齐，网格点为 $(x_{i},y_{j}) = (x_{0} + i h, y_{0} + j h)$。设 TF/SF 矩形为内部索引集 $\\{(i,j): 1 \\le i \\le N_{x}-1, 1 \\le j \\le N_{y}-1\\}$，使其四个面位于索引线 $i = 0$, $i = N_{x}$, $j = 0$ 和 $j = N_{y}$ 上。考虑作用于网格函数 $v_{i,j}$ 上的标准二阶中心差分离散亥姆霍兹算子 $L_{h}$：\n$$\n(L_{h} v)_{i,j} = \\frac{v_{i+1,j} - 2 v_{i,j} + v_{i-1,j}}{h^{2}} + \\frac{v_{i,j+1} - 2 v_{i,j} + v_{i,j-1}}{h^{2}} + k^{2} v_{i,j},\n$$\n该算子为模板位于 TF/SF 矩形内的内部索引 $(i,j)$ 定义。为了通过 TF/SF 方法注入入射场，我们引入离散等效源 $s_{i,j}$，其仅分布在紧邻每个 TF/SF 面的单层网格厚的内部节点上。配置构造要求，对于其模板引用了 TF/SF 矩形外一个邻居节点的每个内部节点，缺失的邻居节点的贡献必须由一个源项 $s_{i,j}$ 精确替代，该源项由已知入射场在相应鬼点邻居上的采样值计算得出。\n\n假设入射场是光滑的平面波 $u^{\\text{inc}}(x,y) = \\exp(i k_{x} x + i k_{y} y)$，其中 $k_{x}^{2} + k_{y}^{2} = k^{2}$。使用上述配置方法，推导紧邻 TF/SF 四个面的内部层上的等效源强度 $s_{i,j}$ 的显式公式，用在 TF/SF 矩形外一步之遥的相应鬼点上采样的 $u^{\\text{inc}}$ 表示。然后，在假设使用 $L_h$ 和这些源的离散亥姆霍兹问题是稳定的，并且 $k h$ 足够小的条件下，严格分析在 TF/SF 矩形内部对 $u^{\\text{inc}}$ 的内部重构 $u_{h}$ 的形式精度阶 $m$。你的分析应从基本定律和核心定义出发，包括连续亥姆霍兹方程和 $L_h$ 的定义，并且不应引用任何未从这些基础推导出来的快捷公式。将最终阶数 $m$ 表示为单个整数。最终答案中不提供任何不等式。最终答案应只包含 $m$ 的值，不带单位，也无附加文本。",
            "solution": "该问题要求得到关于二维亥姆霍兹方程的全场/散射场 (TF/SF) 公式的两个结果。首先，我们必须推导用于注入入射平面波的离散等效源 $s_{i,j}$ 的显式公式。其次，我们必须确定在全场区域内，对入射场进行纯源重构的形式精度阶 $m$。\n\n该问题是适定的，并且其科学基础在于计算声学和偏微分方程数值分析的原理。所有必要信息均已提供，其设置与 TF/SF 方法的标准（尽管是简化的）实现相一致。因此，我们可以进行完整的求解。\n\n连续亥姆霍兹方程由下式给出\n$$\n\\Delta u + k^{2} u = 0,\n$$\n其中 $k = \\omega/c$ 是波数。入射场是一个平面波 $u^{\\text{inc}}(x,y) = \\exp(i k_{x} x + i k_{y} y)$，当 $k_{x}^{2} + k_{y}^{2} = k^{2}$ 时，它是该方程的精确解。\n\n离散算子 $L_{h}$ 是对亥姆霍兹算子 $\\Delta + k^{2}$ 的标准二阶中心差分近似：\n$$\n(L_{h} v)_{i,j} = \\frac{v_{i+1,j} - 2 v_{i,j} + v_{i-1,j}}{h^{2}} + \\frac{v_{i,j+1} - 2 v_{i,j} + v_{i,j-1}}{h^{2}} + k^{2} v_{i,j}.\n$$\n全场 $u_{i,j}$ 的计算域由网格索引 $\\{(i,j): 1 \\le i \\le N_{x}-1, 1 \\le j \\le N_{y}-1\\}$ 组成。\n\n第一部分：源项 $s_{i,j}$ 的推导\n\n源项 $s_{i,j}$ 仅在紧邻 TF/SF 边界的单层网格厚的内部节点上非零。“配置构造”规定，对于任何其五点模板延伸到计算域外的“鬼点”邻居的节点，该鬼点上的值由在该位置采样的已知入射场值 $u^{\\text{inc}}$ 替代。然后，此修改被视为一个源项。\n\n我们来为域内部但位于边界邻近层上的节点 $(i,j)$ 写出离散方程。考虑一个节点 $(1,j)$，其中 $1  j  N_y - 1$。如果离散亥姆霍兹方程能够被完美满足，则有 $(L_h u)_{1,j} = 0$。展开此式得到：\n$$\n\\frac{u_{2,j} - 2 u_{1,j} + u_{0,j}}{h^{2}} + \\frac{u_{1,j+1} - 2 u_{1,j} + u_{1,j-1}}{h^{2}} + k^{2} u_{1,j} = 0.\n$$\n在此方程中，$u_{1,j}$、$u_{2,j}$、$u_{1,j+1}$ 和 $u_{1,j-1}$ 是域内的未知全场值。节点 $(0,j)$ 是一个鬼点。根据问题的规定，我们用 $u^{\\text{inc}}_{0,j} = u^{\\text{inc}}(x_0, y_j)$ 替换 $u_{0,j}$。方程变为：\n$$\n\\frac{u_{2,j} - 2 u_{1,j} + u^{\\text{inc}}_{0,j}}{h^{2}} + \\frac{u_{1,j+1} - 2 u_{1,j} + u_{1,j-1}}{h^{2}} + k^{2} u_{1,j} = 0.\n$$\n为了将其构造成关于 TF 区域内未知数 $u_{i,j}$ 的线性系统，我们将包含已知入射场的项移到右侧。\n$$\n\\frac{u_{2,j} - 2 u_{1,j}}{h^{2}} + \\frac{u_{1,j+1} - 2 u_{1,j} + u_{1,j-1}}{h^{2}} + k^{2} u_{1,j} = -\\frac{u^{\\text{inc}}_{0,j}}{h^{2}}.\n$$\n右侧即为源项 $s_{1,j}$。我们可以系统地推导所有四个边界邻近层和角点的源。设 $u^{\\text{inc}}_{i,j} = u^{\\text{inc}}(x_{i}, y_j)$。\n\n1.  左边界层 ($i=1, 1  j  N_y - 1$)：模板涉及鬼点 $(0,j)$。\n    $$s_{1,j} = -\\frac{1}{h^{2}} u^{\\text{inc}}_{0,j}$$\n2.  右边界层 ($i=N_x - 1, 1  j  N_y - 1$)：模板涉及鬼点 $(N_x,j)$。\n    $$s_{N_x-1,j} = -\\frac{1}{h^{2}} u^{\\text{inc}}_{N_x, j}$$\n3.  下边界层 ($j=1, 1  i  N_x - 1$)：模板涉及鬼点 $(i,0)$。\n    $$s_{i,1} = -\\frac{1}{h^{2}} u^{\\text{inc}}_{i,0}$$\n4.  上边界层 ($j=N_y - 1, 1  i  N_x - 1$)：模板涉及鬼点 $(i,N_y)$。\n    $$s_{i,N_y-1} = -\\frac{1}{h^{2}} u^{\\text{inc}}_{i,N_y}$$\n角点涉及两个鬼点邻居。\n5.  左下角点 ($i=1, j=1$)：模板涉及鬼点 $(0,1)$ 和 $(1,0)$。\n    $$s_{1,1} = -\\frac{1}{h^{2}} \\left( u^{\\text{inc}}_{0,1} + u^{\\text{inc}}_{1,0} \\right)$$\n6.  右下角点 ($i=N_x-1, j=1$)：模板涉及鬼点 $(N_x,1)$ 和 $(N_x-1,0)$。\n    $$s_{N_x-1,1} = -\\frac{1}{h^{2}} \\left( u^{\\text{inc}}_{N_x,1} + u^{\\text{inc}}_{N_x-1,0} \\right)$$\n7.  左上角点 ($i=1, j=N_y-1$)：模板涉及鬼点 $(0,N_y-1)$ 和 $(1,N_y)$。\n    $$s_{1,N_y-1} = -\\frac{1}{h^{2}} \\left( u^{\\text{inc}}_{0,N_y-1} + u^{\\text{inc}}_{1,N_y} \\right)$$\n8.  右上角点 ($i=N_x-1, j=N_y-1$)：模板涉及鬼点 $(N_x,N_y-1)$ 和 $(N_x-1,N_y)$。\n    $$s_{N_x-1,N_y-1} = -\\frac{1}{h^{2}} \\left( u^{\\text{inc}}_{N_x,N_y-1} + u^{\\text{inc}}_{N_x-1,N_y} \\right)$$\n对于所有其他内部节点 $\\{(i,j): 1  i  N_x-1, 1  j  N_y-1\\}$，源项为零：$s_{i,j}=0$。\n\n第二部分：形式精度阶的分析\n\n形式精度阶由局部截断误差 (LTE) $\\tau_{i,j}$ 的阶数决定。LTE 是将精确连续解 $u^{\\text{inc}}(x,y)$ 代入离散数值格式时得到的残差。\n\n设 $A_h$ 是 TF 区域内未知数的离散算子矩阵，$\\mathbf{s}$ 是上面推导的源项向量。数值解 $\\mathbf{u}_h$ 通过求解线性系统 $A_h \\mathbf{u}_h = \\mathbf{s}$ 得到。\n\n节点 $(i,j)$ 处的 LTE 是 $\\tau_{i,j} = (A_h \\mathbf{u}^{\\text{inc}})_{i,j} - s_{i,j}$，其中 $\\mathbf{u}^{\\text{inc}}$ 是精确解在网格点上的采样值向量。\n\n我们来考察不同节点类型的 $\\tau_{i,j}$。\n- 对于不与边界相邻的节点 $(i,j)$ ($1  i  N_x-1, 1  j  N_y-1$)：离散方程为 $(L_h u_h)_{i,j} = 0$，因此 $(A_h \\mathbf{u}_h)_{i,j} = (L_h u_h)_{i,j}$ 且 $s_{i,j} = 0$。LTE 为 $\\tau_{i,j} = (L_h u^{\\text{inc}})_{i,j} - 0 = (L_h u^{\\text{inc}})_{i,j}$。\n\n- 对于边界层上的节点，例如 $(1,j)$，其中 $1  j  N_y-1$：离散方程为 $\\frac{u_{h,2,j} - 2u_{h,1,j}}{h^2} + \\frac{u_{h,1,j+1} - 2u_{h,1,j} + u_{h,1,j-1}}{h^2} + k^2 u_{h,1,j} = s_{1,j}$。因此，$(A_h \\mathbf{u}^{\\text{inc}})_{1,j} = \\frac{u^{\\text{inc}}_{2,j} - 2u^{\\text{inc}}_{1,j}}{h^2} + \\frac{u^{\\text{inc}}_{1,j+1} - 2u^{\\text{inc}}_{1,j} + u^{\\text{inc}}_{1,j-1}}{h^2} + k^2 u^{\\text{inc}}_{1,j}$。源项为 $s_{1,j} = -u^{\\text{inc}}_{0,j}/h^2$。\nLTE 为：\n$$\n\\tau_{1,j} = \\left(\\frac{u^{\\text{inc}}_{2,j} - 2u^{\\text{inc}}_{1,j}}{h^2} + \\frac{u^{\\text{inc}}_{1,j+1} - 2u^{\\text{inc}}_{1,j} + u^{\\text{inc}}_{1,j-1}}{h^2} + k^2 u^{\\text{inc}}_{1,j}\\right) - \\left(-\\frac{u^{\\text{inc}}_{0,j}}{h^2}\\right)\n$$\n$$\n\\tau_{1,j} = \\frac{u^{\\text{inc}}_{2,j} - 2u^{\\text{inc}}_{1,j} + u^{\\text{inc}}_{0,j}}{h^2} + \\frac{u^{\\text{inc}}_{1,j+1} - 2u^{\\text{inc}}_{1,j} + u^{\\text{inc}}_{1,j-1}}{h^2} + k^2 u^{\\text{inc}}_{1,j} = (L_h u^{\\text{inc}})_{1,j}.\n$$\n这表明，源项的特定选择确保了对于 TF 区域的所有内部节点 $(i,j)$，LTE 具有相同的形式 $\\tau_{i,j} = (L_h u^{\\text{inc}})_{i,j}$。\n\n为了求出 LTE 的阶数，我们对 $u^{\\text{inc}}(x,y)$ 在点 $(x_i, y_j)$ 周围进行泰勒级数展开。设 $u \\equiv u^{\\text{inc}}$，且所有导数均在点 $(x_i, y_j)$ 处求值。\n$$\nu(x_i \\pm h, y_j) = u \\pm h \\frac{\\partial u}{\\partial x} + \\frac{h^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} \\pm \\frac{h^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\frac{h^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} + O(h^5)\n$$\n$x$ 方向二阶导数的中心差分为：\n$$\n\\frac{u(x_i+h,y_j) - 2u(x_i,y_j) + u(x_i-h,y_j)}{h^2} = \\frac{1}{h^2} \\left( (u + h u_x + \\frac{h^2}{2}u_{xx} + \\dots) - 2u + (u - h u_x + \\frac{h^2}{2}u_{xx} - \\dots) \\right)\n$$\n$$\n= \\frac{1}{h^2} \\left( 2\\frac{h^2}{2}u_{xx} + 2\\frac{h^4}{24}u_{xxxx} + O(h^6) \\right) = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h^2}{12}\\frac{\\partial^4 u}{\\partial x^4} + O(h^4).\n$$\n对于 $y$ 方向的导数，有相同的结果。\n现在，我们将这些代入 $\\tau_{i,j}$ 的表达式中：\n$$\n\\tau_{i,j} = (L_h u)_{i,j} = \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h^2}{12}\\frac{\\partial^4 u}{\\partial x^4} + O(h^4) \\right) + \\left( \\frac{\\partial^2 u}{\\partial y^2} + \\frac{h^2}{12}\\frac{\\partial^4 u}{\\partial y^4} + O(h^4) \\right) + k^2 u.\n$$\n合并各项：\n$$\n\\tau_{i,j} = \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + k^2 u \\right) + \\frac{h^2}{12} \\left( \\frac{\\partial^4 u}{\\partial x^4} + \\frac{\\partial^4 u}{\\partial y^4} \\right) + O(h^4).\n$$\n第一个括号中的项是作用于 $u = u^{\\text{inc}}$ 的连续亥姆霍兹算子。由于 $u^{\\text{inc}}$ 是一个精确解，该项为零：\n$$\n\\Delta u^{\\text{inc}} + k^2 u^{\\text{inc}} = 0.\n$$\n因此，局部截断误差为：\n$$\n\\tau_{i,j} = \\frac{h^2}{12} \\left( \\frac{\\partial^4 u^{\\text{inc}}}{\\partial x^4} + \\frac{\\partial^4 u^{\\text{inc}}}{\\partial y^4} \\right) + O(h^4).\n$$\nLTE 中的主阶项是 $h^2$ 阶的。形式精度阶 $m$ 是该主阶项中 $h$ 的指数。因此，$m=2$。稳定性的假设确保了数值解 $u_h$ 的全局误差与 LTE 具有相同的阶数。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "知道了如何数值地注入波场后，下一个关键问题是：我们应该注入一个什么样的波场？本练习探讨了在非均匀介质中应用 TF/SF 方法时一个核心的物理约束。你将分析为何将一个简单的平面波（均匀介质解）注入非均匀背景会产生虚假的散射，并探索如何通过预先计算背景场来解决这一问题，从而确保模拟结果的物理真实性。",
            "id": "4148520",
            "problem": "考虑一个有界计算域 $\\,\\Omega\\,$ 中的线性声学问题，该区域具有空间变化的密度 $\\,\\rho(\\mathbf{x})\\,$ 和声速 $\\,c(\\mathbf{x})\\,$，两者都是光滑且严格为正的。其控制的二阶压力方程为\n$$\nL_b p \\equiv \\frac{1}{c^2(\\mathbf{x})}\\,\\partial_{tt} p(\\mathbf{x},t)\\;-\\;\\nabla\\cdot\\!\\left(\\frac{1}{\\rho(\\mathbf{x})}\\,\\nabla p(\\mathbf{x},t)\\right)\\;=\\;0\\quad\\text{in}\\ \\Omega,\n$$\n此方程定义了非均匀背景算子 $\\,L_b\\,$。在计算声学的总场/散射场 (Total-Field/Scattered-Field, TF/SF) 公式中，将域划分为一个总场子域 $\\,\\Omega_T\\subset\\Omega\\,$、一个散射场子域 $\\,\\Omega_S=\\Omega\\setminus\\overline{\\Omega_T}\\,$ 和一个界面 $\\,\\Gamma=\\partial\\Omega_T\\cap\\partial\\Omega_S\\,$。通过该界面注入入射场，以隔离目标散射。其目标是通过 $\\,\\Gamma\\,$ 注入一个入射场 $\\,p^{\\mathrm{inc}}\\,$，该场会在实际的非均匀背景中传播，从而使得在 $\\,\\Omega_S\\,$ 中记录到的散射仅由 $\\,\\Omega_T\\,$ 中的目标引起。\n\n假设现在尝试注入一个均匀介质平面波 $\\,p^{\\mathrm{pw}}\\,$，它满足\n$$\nL_0 p^{\\mathrm{pw}} \\equiv \\frac{1}{c_0^2}\\,\\partial_{tt} p^{\\mathrm{pw}}(\\mathbf{x},t)\\;-\\;\\frac{1}{\\rho_0}\\,\\Delta p^{\\mathrm{pw}}(\\mathbf{x},t)\\;=\\;0\\quad\\text{in}\\ \\mathbb{R}^d,\n$$\n其中 $\\,\\rho_00\\,$ 和 $\\,c_00\\,$ 是常数，并且在时谐情况下满足通常的平面波关系 $\\,\\|\\mathbf{k}\\|=\\omega/c_0\\,$。在实践中，人们会使用 $\\,p^{\\mathrm{pw}}\\,$ 的迹（及其相关的通量或速度）来驱动 TF/SF 界面 $\\,\\Gamma\\,$，就好像它是背景入射场一样。\n\n请从第一性原理出发，解释为什么即使在 $\\,\\Omega_T\\,$ 中没有物理目标，将此波注入非均匀背景 $\\,L_b\\,$ 通常也会产生伪散射，并提出一种方法，通过在实际的非均匀背景中进行数值射线或偏微分方程 (PDE) 求解，来预计算 $\\,\\Gamma\\,$ 上的入射迹，以消除这种伪散射。您的解释必须从控制算子 $\\,L_b\\,$ 和 $\\,L_0\\,$ 以及 TF/SF 界面概念开始，推导出注入 $\\,p^{\\mathrm{pw}}\\,$ 时产生的残余强迫项，并说明如何消除它。\n\n下列陈述中哪些是正确的？\n\nA. 伪散射的产生是因为 $\\,p^{\\mathrm{pw}}\\,$ 满足 $\\,L_0 p^{\\mathrm{pw}}=0\\,$，而不是 $\\,L_b p^{\\mathrm{pw}}=0\\,$。在 $\\,\\Omega_T\\,$ 内部，作用于 $\\,p^{\\mathrm{pw}}\\,$ 的非均匀算子会产生一个非零残差 $\\,r(\\mathbf{x},t)=(L_b-L_0)p^{\\mathrm{pw}}(\\mathbf{x},t)\\,$，它充当一个等效体力，即使在没有物理目标的情况下也会驱动一个散射场。要消除这个问题，需要注入一个在真实背景中满足 $\\,L_b p^{\\mathrm{bg}}=0\\,$ 的入射场 $\\,p^{\\mathrm{bg}}\\,$。\n\nB. 为了抑制 $\\,\\Gamma\\,$ 处的伪散射，应当通过求解 $\\,L_b p^{\\mathrm{bg}}=0\\,$（例如，通过仅含背景的时域 PDE 求解或高频数值射线）来预计算背景入射场 $\\,p^{\\mathrm{bg}}\\,$，记录压力迹 $\\,p^{\\mathrm{bg}}|_\\Gamma\\,$ 和一致的法向通量迹 $\\,q^{\\mathrm{bg}}|_\\Gamma=\\mathbf{n}\\cdot\\left(\\frac{1}{\\rho(\\mathbf{x})}\\nabla p^{\\mathrm{bg}}(\\mathbf{x},t)\\right)\\big|_{\\Gamma}\\,$，并将这些迹作为特征或双边边界数据施加于 TF/SF 注入。\n\nC. 在高频情况下，仅通过求解程函方程 $\\,\\|\\nabla T(\\mathbf{x})\\|=1/c(\\mathbf{x})\\,$ 预计算相位，然后注入一个具有该相位的恒定振幅波形就足够了。由几何扩散和阻抗引起的振幅变化不影响 $\\,\\Gamma\\,$ 处的伪散射。\n\nD. 在 $\\,\\Gamma\\,$ 周围设置一个具有大阻尼系数的薄海绵层，总能消除因注入违反 $\\,L_b\\,$ 的 $\\,p^{\\mathrm{pw}}\\,$ 所引起的伪散射，无论背景非均匀性如何，从而使预计算入射迹变得不必要。\n\nE. 一种替代预计算背景迹的方法是，在注入 $\\,p^{\\mathrm{pw}}\\,$ 的同时，在 $\\,\\Omega_T\\,$ 中添加一个等于 $\\,f(\\mathbf{x},t)=-(L_b-L_0)p^{\\mathrm{pw}}(\\mathbf{x},t)\\,$ 的体校正源。这在 $\\,\\Omega_T\\,$ 中强制实现 $\\,L_b(p^{\\mathrm{pw}})+f=0\\,$，从而在没有目标的情况下消除残差和相关的伪散射。\n\n选择所有适用项。",
            "solution": "总场/散射场 (TF/SF) 方法依赖于控制波方程的线性。总压力场 $\\,p\\,$ 被分解为入射场 $\\,p^{\\mathrm{inc}}\\,$ 和散射场 $\\,p^{\\mathrm{scat}}\\,$：\n$$\np(\\mathbf{x},t) = p^{\\mathrm{inc}}(\\mathbf{x},t) + p^{\\mathrm{scat}}(\\mathbf{x},t).\n$$\n入射场 $\\,p^{\\mathrm{inc}}\\,$ 被定义为在没有任何散射体的情况下，存在于*背景介质*中的场。散射场 $\\,p^{\\mathrm{scat}}\\,$ 是由散射体的存在对该入射场造成的扰动。为了使 TF/SF 公式是“纯净的”，即在没有物理散射体的情况下计算出的散射场为零（$\\,p^{\\mathrm{scat}}=0\\,$），入射场 $\\,p^{\\mathrm{inc}}\\,$ 必须是背景介质中控制方程的一个解。在这个问题中，背景是非均匀的，所以条件是 $\\,L_b p^{\\mathrm{inc}} = 0\\,$。\n\n问题描述了一种违反此条件的场景。选择的入射场 $\\,p^{\\mathrm{pw}}\\,$ 满足*均匀*介质的波动方程 $\\,L_0 p^{\\mathrm{pw}} = 0\\,$，其中 $\\,L_0\\,$ 不同于真实的背景算子 $\\,L_b\\,$。由于通常情况下 $\\,c(\\mathbf{x}) \\neq c_0\\,$ 或 $\\,\\rho(\\mathbf{x}) \\neq \\rho_0\\,$，因此 $\\,p^{\\mathrm{pw}}\\,$ 不是背景波动方程的解：$\\,L_b p^{\\mathrm{pw}} \\neq 0\\,$。\n\n为了理解其后果，我们将背景算子 $\\,L_b\\,$ 应用于所选的入射场 $\\,p^{\\mathrm{pw}}\\,$：\n$$\nL_b p^{\\mathrm{pw}} = (L_b - L_0) p^{\\mathrm{pw}} + L_0 p^{\\mathrm{pw}}.\n$$\n由于 $\\,L_0 p^{\\mathrm{pw}} = 0\\,$，这可以简化为\n$$\nL_b p^{\\mathrm{pw}} = (L_b - L_0) p^{\\mathrm{pw}}.\n$$\n我们将这个残差项称为 $\\,r(\\mathbf{x},t) = (L_b - L_0) p^{\\mathrm{pw}}(\\mathbf{x},t)\\,$。在背景介质属性 $\\,(\\rho(\\mathbf{x}), c(\\mathbf{x}))\\,$ 与参考常数 $\\,(\\rho_0, c_0)\\,$ 不同的任何地方，该残差项都是非零的。\n\n现在考虑在没有任何物理目标的情况下总场 $\\,p\\,$ 的方程。它必须满足 $\\,L_b p = 0\\,$。如果我们使用错误选择的入射场 $\\,p = p^{\\mathrm{pw}} + p^{\\mathrm{scat}}\\,$ 来分解 $\\,p\\,$，并将其代入控制方程，我们得到：\n$$\nL_b (p^{\\mathrm{pw}} + p^{\\mathrm{scat}}) = 0.\n$$\n根据线性性质，\n$$\nL_b p^{\\mathrm{pw}} + L_b p^{\\mathrm{scat}} = 0.\n$$\n代入残差 $\\,r = L_b p^{\\mathrm{pw}}\\,$，我们得到散射场必须满足的方程：\n$$\nL_b p^{\\mathrm{scat}} = -r(\\mathbf{x},t) = -(L_b - L_0) p^{\\mathrm{pw}}(\\mathbf{x},t).\n$$\n这是一个由非零源项 $\\,-r(\\mathbf{x},t)\\,$ 驱动的散射场 $\\,p^{\\mathrm{scat}}\\,$ 的波动方程。即使没有物理目标，这个源项也存在；它是注入场与背景介质不匹配所产生的人为产物。由该源生成的场 $\\,p^{\\mathrm{scat}}\\,$ 就是*伪散射*。TF/SF 界面 $\\,\\Gamma\\,$ 是数值方案实际上引入这种不一致性的地方，这种不一致性随后表现为一个源。\n\n为了消除这种伪散射，必须使用一个背景问题的真实解 $\\,p^{\\mathrm{bg}}\\,$，即 $\\,L_b p^{\\mathrm{bg}}=0\\,$。由于对于非均匀背景，$\\,p^{\\mathrm{bg}}\\,$ 通常不是解析已知的，它必须通过数值方法预先计算。两种主要方法是：\n1.  **基于 PDE 的预计算：** 在一个代表背景介质的、更大的独立模拟域中求解背景方程 $\\,L_b p=0\\,$。可以使用局部源生成一个在感兴趣区域变为平面的波。将得到的场 $\\,p^{\\mathrm{bg}}(\\mathbf{x},t)\\,$ 及其法向通量 $\\,q^{\\mathrm{bg}} = \\mathbf{n}\\cdot(\\frac{1}{\\rho}\\nabla p^{\\mathrm{bg}})\\,$ 随时间记录在表面 $\\,\\Gamma\\,$ 上。然后，这些记录的迹被用作主 TF/SF 模拟的注入数据。\n2.  **高频渐近法（射线理论）：** 对于高频波，可以使用射线理论（WKBJ近似）来近似 $\\,p^{\\mathrm{bg}}\\,$。这涉及求解程函方程 $\\,\\|\\nabla T\\|=1/c(\\mathbf{x})\\,$ 以获得走时场 $\\,T(\\mathbf{x})\\,$，以及求解输运方程以获得振幅 $\\,A(\\mathbf{x})\\,$，后者考虑了几何扩散和阻抗变化。然后，入射场被构造为 $\\,p^{\\mathrm{bg}} \\approx A(\\mathbf{x})F(t-T(\\mathbf{x}))\\,$。相位和振幅都必须正确计算。\n\n另一种方法是通过校正控制方程本身来避免预计算，如选项 E 所探讨的。\n\n现在，我们评估每个选项。\n\n**A. 伪散射的产生是因为...**\n这个陈述正确地指出了根本原因：$\\,p^{\\mathrm{pw}}\\,$ 不是背景方程 $\\,L_b p=0\\,$ 的解。它正确地将残差 $\\,r(\\mathbf{x},t)=(L_b-L_0)p^{\\mathrm{pw}}(\\mathbf{x},t)\\,$ 识别为驱动伪散射场的“等效体力”（或源项）。这与我们推导出的 $\\,L_b p^{\\mathrm{scat}} = -r\\,$ 完全一致。结论是必须注入一个满足 $\\,L_b p^{\\mathrm{bg}}=0\\,$ 的场 $\\,p^{\\mathrm{bg}}\\,$ 来消除这个问题，这也是正确的。\n**结论：正确。**\n\n**B. 为了抑制 $\\,\\Gamma\\,$ 处的伪散射，应当预计算...**\n这个陈述描述了在非均匀介质中正确实现 TF/SF 的主要标准方法。它正确地指出，必须使用诸如完整的 PDE 求解或数值射线等方法来求解背景问题 $\\,L_b p^{\\mathrm{bg}}=0\\,$。关键是，它指出了必须同时记录压力迹 $\\,p^{\\mathrm{bg}}|_\\Gamma\\,$ 和一致的法向通量迹 $\\,q^{\\mathrm{bg}}|_\\Gamma\\,$。使用压力和通量（或速度）可以实现一个鲁棒的“双边”或基于特征的注入方案，该方案能在总场区域内正确再现场 $\\,p^{\\mathrm{bg}}\\,$，同时确保在仅有背景的情况下外部散射场为零。通量的公式对于给定的算子 $\\,L_b\\,$ 是正确的。\n**结论：正确。**\n\n**C. 在高频情况下，仅预计算相位就足够了...**\n这个陈述是不正确的。高频渐近解的形式为 $\\,p^{\\mathrm{bg}}(\\mathbf{x}, t) \\approx A(\\mathbf{x}) F(t - T(\\mathbf{x}))\\,$。虽然相位（走时 $\\,T(\\mathbf{x})\\,$）由程函方程决定，但振幅 $\\,A(\\mathbf{x})\\,$ 不是恒定的。它根据一个输运方程变化，该方程考虑了波折射时的能量守恒以及介质阻抗 $\\,\\rho(\\mathbf{x})c(\\mathbf{x})\\,$ 的变化。注入一个具有正确相位但恒定（不正确）振幅的波意味着注入的场仍然不满足 $\\,L_b p = 0\\,$，这将产生一个残余源项，从而导致伪散射。振幅和相位的变化都至关重要。\n**结论：不正确。**\n\n**D. 在 $\\,\\Gamma\\,$ 周围设置一个薄海绵层，其阻尼系数较大...**\n这个陈述代表了对 TF/SF 界面和吸收层作用的基本误解。海绵层或完美匹配层 (PML) 放置在计算域的*外部边界*，以吸收出射波并模拟无界介质。在*内部*的 TF/SF 界面 $\\,\\Gamma\\,$ 处放置阻尼层会无差别地衰减所有通过它的场：正在注入的入射场、任何来自目标的期望散射场以及伪散射场。它会破坏物理相互作用并摧毁 TF/SF 分解的逻辑，而不是修复注入错误。问题是源误差，而不是反射误差。\n**结论：不正确。**\n\n**E. 一种替代预计算背景迹的方法是添加一个体校正源...**\n这描述了一种有效且已知的替代技术。目标是使 $\\,p^{\\mathrm{pw}}\\,$ 成为背景模拟中的一个有效解。如果我们将 $\\,\\Omega_T\\,$ 内部的控制方程从 $\\,L_b p = 0\\,$ 修改为 $\\,L_b p = f_{corr}\\,$，我们可以选择源 $\\,f_{corr}\\,$ 使得 $\\,p^{\\mathrm{pw}}\\,$ 成为一个解。这要求 $\\,L_b p^{\\mathrm{pw}} = f_{corr}\\,$。根据我们的推导，我们知道 $\\,L_b p^{\\mathrm{pw}} = (L_b-L_0)p^{\\mathrm{pw}}\\,$。该选项建议在 $\\,L_b p + \\text{sources} = 0\\,$ 形式的方程中添加一个源 $\\,f = -(L_b-L_0)p^{\\mathrm{pw}}\\,$。让我们验证一下：我们希望 $\\,\\Omega_T\\,$ 中的总场是 $\\,p^{\\mathrm{pw}}\\,$（在没有目标的情况下）。我们建议在 $\\,\\Omega_T\\,$ 内部求解方程 $\\,L_b p + f = 0\\,$。让我们测试一下 $\\,p=p^{\\mathrm{pw}}\\,$ 是否是一个解：\n$$\nL_b p^{\\mathrm{pw}} + f = L_b p^{\\mathrm{pw}} - (L_b-L_0)p^{\\mathrm{pw}} = L_b p^{\\mathrm{pw}} - L_b p^{\\mathrm{pw}} + L_0 p^{\\mathrm{pw}} = L_0 p^{\\mathrm{pw}}.\n$$\n由于 $\\,L_0 p^{\\mathrm{pw}} = 0\\,$，方程 $\\,L_b p^{\\mathrm{pw}} + f = 0\\,$ 得到满足。因此，通过在 $\\,\\Omega_T\\,$ 内部添加这个精确定义的校正源，我们修改了问题，使得简单的平面波 $\\,p^{\\mathrm{pw}}\\,$ 成为局部控制方程的一个合法解。这就消除了否则会产生伪散射的残差。这是一个正确解决问题的方法，尽管在计算上有所不同。\n**结论：正确。**",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "实际的科学与工程计算往往追求更高的精度和效率，这通常需要采用高阶数值格式。本练习将带领你从基础的二阶格式迈向更高级的实现，为一种四阶精度的交错网格时域有限差分 (FDTD) 格式推导 TF/SF 校正项。通过这一实践，你将学会如何处理在先进数值方案中实现波场注入所带来的挑战，例如在高阶算子和交錯网格上定义和匹配入射通量。",
            "id": "4148468",
            "problem": "考虑一个均匀、无损耗介质中的一维线性声学问题，该介质的质量密度 $\\rho_{0}$ 和声速 $c$ 为常数，由以下一阶系统控制\n$$\n\\partial_{t} p(x,t) \\;=\\; -\\,\\rho_{0}\\,c^{2}\\,\\partial_{x} u(x,t),\n\\qquad\n\\partial_{t} u(x,t) \\;=\\; -\\,\\frac{1}{\\rho_{0}}\\,\\partial_{x} p(x,t),\n$$\n其中 $p$ 是声压，$u$ 是质点速度。使用均匀的交错网格：压力 $p_{i}^{n}$ 存储在整数空间索引 $x_{i} = i\\,\\Delta x$ 和整数时间 $t^{n} = n\\,\\Delta t$ 处，而速度 $u_{i+1/2}^{n+1/2}$ 存储在半整数空间索引 $x_{i+1/2} = (i+\\tfrac{1}{2})\\,\\Delta x$ 和半整数时间 $t^{n+1/2} = (n+\\tfrac{1}{2})\\,\\Delta t$ 处。更新采用标准的蛙跳格式，\n$$\nu_{i+1/2}^{\\,n+1/2} \\;=\\; u_{i+1/2}^{\\,n-1/2} \\;-\\; \\frac{\\Delta t}{\\rho_{0}}\\,\\big(D_{x} p\\big)_{i+1/2}^{\\,n},\n\\qquad\np_{i}^{\\,n+1} \\;=\\; p_{i}^{\\,n} \\;-\\; \\rho_{0} c^{2} \\Delta t\\,\\big(D_{x} u\\big)_{i}^{\\,n+1/2},\n$$\n其中 $\\big(D_{x} p\\big)_{i+1/2}$ 和 $\\big(D_{x} u\\big)_{i}$ 分别是在相应网格位置上对 $\\partial_{x} p$ 和 $\\partial_{x} u$ 的离散近似。假设两个空间导数都由与交错网格一致的最小对称模板构成的四阶精度中心有限差分来近似。\n\n使用全场/散射场 (Total-Field/Scattered-Field, TF/SF) 方法将一个已知的向右传播的入射平面波注入计算域。在全场/散射场 (TF/SF) 方法中，计算域在接口索引 $i = i_{b}$ 处被划分，使得当 $i \\le i_{b}$ 时，推进的是全场；而当 $i  i_{b}$ 时，仅更新散射场。在 TF/SF 接口处，压力更新中用于 $\\big(D_{x} u\\big)_{i_{b}}$ 的四阶模板跨越了半网格速度值 $u_{i_{b}-3/2}^{\\,n+1/2}$、$u_{i_{b}-1/2}^{\\,n+1/2}$、$u_{i_{b}+1/2}^{\\,n+1/2}$ 和 $u_{i_{b}+3/2}^{\\,n+1/2}$，其中最右边的两项位于全场区域之外，必须与入射波一致地提供。假设入射压力场 $p_{\\text{inc}}(x,t)$ 是解析的且向右传播，因此 $u_{\\text{inc}}(x,t) = p_{\\text{inc}}(x,t)/(\\rho_{0} c)$。为了将入射场耦合到交错的速度位置，使用四阶精度的中点插值，从四个相邻的整数位置压力样本 $\\{p_{\\text{inc}}(x_{i-1},t), p_{\\text{inc}}(x_{i},t), p_{\\text{inc}}(x_{i+1},t), p_{\\text{inc}}(x_{i+2},t)\\}$ 来计算 $x_{i+1/2}$ 处的 $u_{\\text{inc}}$。\n\n从连续的控制方程和在接口附近的泰勒级数展开出发，推导：\n1. 交错网格上 $\\big(D_{x} u\\big)_{i}$ 的四阶精度中心差分模板，用 $u_{i\\pm1/2}$ 和 $u_{i\\pm3/2}$ 表示。\n2. $u_{\\text{inc},\\,i+1/2}(t)$ 的四阶精度中点插值公式，用四个相邻整数位置的入射压力样本以及关系式 $u_{\\text{inc}} = p_{\\text{inc}}/(\\rho_{0}c)$ 表示。\n3. 必须加到索引 $i_{b}$ 处压力更新中的显式全场/散射场校正项 $\\mathcal{C}_{p}(i_{b})$。该项通过第2项中的插值方法，匹配来自鬼点半网格速度 $u_{i_{b}+1/2}^{\\,n+1/2}$ 和 $u_{i_{b}+3/2}^{\\,n+1/2}$ 的入射通量贡献来获得。\n\n将你的最终答案表示为 $\\mathcal{C}_{p}(i_{b})$ 的一个封闭形式解析表达式，用 $j \\in \\{i_{b}-1, i_{b}, i_{b}+1, i_{b}+2, i_{b}+3\\}$ 处的入射压力样本 $\\{p_{\\text{inc},\\,j}^{\\,n+1/2}\\}$ 以及常数 $c$、$\\Delta t$ 和 $\\Delta x$ 表示。无需进行数值舍入。最终的方框答案中不要包含单位。",
            "solution": "线性化的一阶声学系统提供了作为有限差分更新算子基础的连续通量形式。在交错网格上，蛙跳格式在半步长处使用 $p$ 的空间导数更新 $u$，在整数步长处使用 $u$ 的导数更新 $p$。为了在给定的交错网格上构造四阶精度的中心差分算子，我们围绕目标空间位置进行泰勒展开，并构建能够抵消低阶截断项的对称模板。\n\n首先，使用交错的半整数索引推导在整数位置 $x_{i}$ 处 $\\big(D_{x} u\\big)_{i}$ 的四阶中心差分。考虑一个通用的对称四点近似\n$$\n\\big(D_{x} u\\big)_{i} \\;\\approx\\; \\frac{1}{\\Delta x}\\,\\Big[\\,a\\,\\big(u_{i+1/2}-u_{i-1/2}\\big) \\;+\\; b\\,\\big(u_{i+3/2}-u_{i-3/2}\\big)\\,\\Big],\n$$\n其中待定系数 $a$ 和 $b$ 需要被确定，以使近似达到四阶精度。将 $u_{i\\pm 1/2}$ 和 $u_{i\\pm 3/2}$ 在 $x_{i}$ 附近进行泰勒级数展开：\n$$\nu_{i\\pm 1/2} \\;=\\; u(x_{i}) \\;\\pm\\; \\tfrac{1}{2}\\Delta x\\,u'(x_{i}) \\;+\\; \\tfrac{1}{8}\\Delta x^{2}\\,u''(x_{i}) \\;\\pm\\; \\tfrac{1}{48}\\Delta x^{3}\\,u^{(3)}(x_{i}) \\;+\\; \\tfrac{1}{384}\\Delta x^{4}\\,u^{(4)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{5}),\n$$\n$$\nu_{i\\pm 3/2} \\;=\\; u(x_{i}) \\;\\pm\\; \\tfrac{3}{2}\\Delta x\\,u'(x_{i}) \\;+\\; \\tfrac{9}{8}\\Delta x^{2}\\,u''(x_{i}) \\;\\pm\\; \\tfrac{27}{48}\\Delta x^{3}\\,u^{(3)}(x_{i}) \\;+\\; \\tfrac{81}{384}\\Delta x^{4}\\,u^{(4)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{5}).\n$$\n构造差分：\n$$\nu_{i+1/2}-u_{i-1/2} \\;=\\; \\Delta x\\,u'(x_{i}) \\;+\\; \\tfrac{1}{24}\\Delta x^{3}\\,u^{(3)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{5}),\n$$\n$$\nu_{i+3/2}-u_{i-3/2} \\;=\\; 3\\,\\Delta x\\,u'(x_{i}) \\;+\\; \\tfrac{27}{24}\\Delta x^{3}\\,u^{(3)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{5}).\n$$\n代入近似式并合并同类项：\n$$\n\\frac{1}{\\Delta x}\\,\\Big[\\,a\\,(u_{i+1/2}-u_{i-1/2}) + b\\,(u_{i+3/2}-u_{i-3/2})\\Big]\n\\;=\\; (a + 3b)\\,u'(x_{i}) \\;+\\; \\Big(\\tfrac{a}{24} + \\tfrac{27b}{24}\\Big)\\,\\Delta x^{2}\\,u^{(3)}(x_{i}) \\;+\\; \\mathcal{O}(\\Delta x^{4}).\n$$\n为了达到四阶精度，我们需要 $a + 3b = 1$ 来匹配一阶导数，以及 $\\tfrac{a}{24} + \\tfrac{27b}{24} = 0$ 来消去 $\\Delta x^{2}u^{(3)}$ 项。求解得到，\n$$\na + 3b = 1,\\qquad a + 27b = 0 \\;\\;\\Rightarrow\\;\\; b = -\\,\\frac{1}{24},\\quad a = \\frac{9}{8}.\n$$\n因此，\n$$\n\\big(D_{x} u\\big)_{i} \\;=\\; \\frac{1}{\\Delta x}\\,\\left[\\,\\frac{9}{8}\\,\\big(u_{i+1/2}-u_{i-1/2}\\big) \\;-\\; \\frac{1}{24}\\,\\big(u_{i+3/2}-u_{i-3/2}\\big)\\,\\right] \\;+\\; \\mathcal{O}(\\Delta x^{4}).\n$$\n通过在相对的交错网格上进行相同的推理，可得 $\\big(D_{x} p\\big)_{i+1/2}$ 的四阶中心差分为\n$$\n\\big(D_{x} p\\big)_{i+1/2} \\;=\\; \\frac{1}{\\Delta x}\\,\\left[\\,\\frac{9}{8}\\,\\big(p_{i+1}-p_{i}\\big) \\;-\\; \\frac{1}{24}\\,\\big(p_{i+2}-p_{i-1}\\big)\\,\\right] \\;+\\; \\mathcal{O}(\\Delta x^{4}).\n$$\n\n其次，推导将整数位置压力样本映射到半整数索引速度位置的四阶中点插值公式。考虑一个光滑函数 $f$ 的通用中点插值：\n$$\nf_{i+1/2} \\;\\approx\\; w_{-1}\\,f_{i-1} \\;+\\; w_{0}\\,f_{i} \\;+\\; w_{1}\\,f_{i+1} \\;+\\; w_{2}\\,f_{i+2},\n$$\n其中权重 $\\{w_{-1},w_{0},w_{1},w_{2}\\}$ 的选择应使近似在 $x_{i+1/2}$ 处达到四阶精度。在 $x_{i}$ 附近使用泰勒展开：\n$$\nf_{i-1} = f(x_{i}) - \\Delta x\\,f'(x_{i}) + \\tfrac{1}{2}\\Delta x^{2}\\,f''(x_{i}) - \\tfrac{1}{6}\\Delta x^{3}\\,f^{(3)}(x_{i}) + \\tfrac{1}{24}\\Delta x^{4}\\,f^{(4)}(x_{i}) + \\cdots,\n$$\n$$\nf_{i} = f(x_{i}),\n\\qquad\nf_{i+1} = f(x_{i}) + \\Delta x\\,f'(x_{i}) + \\tfrac{1}{2}\\Delta x^{2}\\,f''(x_{i}) + \\tfrac{1}{6}\\Delta x^{3}\\,f^{(3)}(x_{i}) + \\tfrac{1}{24}\\Delta x^{4}\\,f^{(4)}(x_{i}) + \\cdots,\n$$\n$$\nf_{i+2} = f(x_{i}) + 2\\Delta x\\,f'(x_{i}) + 2\\Delta x^{2}\\,f''(x_{i}) + \\tfrac{4}{3}\\Delta x^{3}\\,f^{(3)}(x_{i}) + \\tfrac{2}{3}\\Delta x^{4}\\,f^{(4)}(x_{i}) + \\cdots.\n$$\n此外，\n$$\nf(x_{i+1/2}) = f(x_{i}) + \\tfrac{1}{2}\\Delta x\\,f'(x_{i}) + \\tfrac{1}{8}\\Delta x^{2}\\,f''(x_{i}) + \\tfrac{1}{48}\\Delta x^{3}\\,f^{(3)}(x_{i}) + \\tfrac{1}{384}\\Delta x^{4}\\,f^{(4)}(x_{i}) + \\cdots.\n$$\n通过施加以下条件来匹配直到 $\\Delta x^{4}$ 的系数\n$$\nw_{-1}+w_{0}+w_{1}+w_{2} = 1,\n$$\n$$\n(-1)w_{-1} + 0\\cdot w_{0} + 1\\cdot w_{1} + 2 w_{2} = \\tfrac{1}{2},\n$$\n$$\n\\tfrac{1}{2}w_{-1} + 0\\cdot w_{0} + \\tfrac{1}{2}w_{1} + 2 w_{2} = \\tfrac{1}{8},\n$$\n$$\n-\\tfrac{1}{6}w_{-1} + 0\\cdot w_{0} + \\tfrac{1}{6}w_{1} + \\tfrac{4}{3} w_{2} = \\tfrac{1}{48},\n$$\n$$\n\\tfrac{1}{24}w_{-1} + 0\\cdot w_{0} + \\tfrac{1}{24}w_{1} + \\tfrac{2}{3} w_{2} = \\tfrac{1}{384}.\n$$\n求解该方程组可得到唯一的四阶中点权重\n$$\nw_{-1} = -\\,\\frac{1}{16},\\qquad w_{0} = \\frac{9}{16},\\qquad w_{1} = \\frac{9}{16},\\qquad w_{2} = -\\,\\frac{1}{16}.\n$$\n因此，利用向右传播的平面波关系 $u_{\\text{inc}} = p_{\\text{inc}}/(\\rho_{0}c)$，在半整数索引处对入射速度所需的插值为\n$$\nu_{\\text{inc},\\,i+1/2}(t) \\;=\\; \\frac{1}{\\rho_{0} c}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i-1}(t) \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i}(t) \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i+1}(t) \\;-\\; \\frac{1}{16}\\,p_{\\text{inc},\\,i+2}(t)\\,\\Big].\n$$\n\n第三，推导全场/散射场校正项。在接口索引 $i = i_{b}$ 处，压力更新中出现的 $\\big(D_{x} u\\big)_{i_{b}}$ 的四阶模板包含了来自接口两侧的半网格速度值：\n$$\n\\big(D_{x} u\\big)_{i_{b}} \\;=\\; \\frac{1}{\\Delta x}\\,\\left[\\,\\frac{9}{8}\\,\\big(u_{i_{b}+1/2}-u_{i_{b}-1/2}\\big) \\;-\\; \\frac{1}{24}\\,\\big(u_{i_{b}+3/2}-u_{i_{b}-3/2}\\big)\\,\\right].\n$$\n值 $u_{i_{b}-1/2}^{\\,n+1/2}$ 和 $u_{i_{b}-3/2}^{\\,n+1/2}$ 位于全场区域内，并作为全场进行推进，因此在那里不需要校正。值 $u_{i_{b}+1/2}^{\\,n+1/2}$ 和 $u_{i_{b}+3/2}^{\\,n+1/2}$ 位于区域外；为了持续地注入入射波，这些鬼点贡献的离散通量必须等于入射场的通量。因此，在时间 $n+1$ 时刻，加到 $i_{b}$ 处压力更新的校正项是那些鬼点半网格点的入射通量贡献：\n$$\n\\mathcal{C}_{p}(i_{b}) \\;=\\; -\\,\\rho_{0} c^{2}\\,\\Delta t\\;\\frac{1}{\\Delta x}\\,\\left[\\,\\frac{9}{8}\\,u_{\\text{inc},\\,i_{b}+1/2}^{\\,n+1/2} \\;-\\; \\frac{1}{24}\\,u_{\\text{inc},\\,i_{b}+3/2}^{\\,n+1/2}\\,\\right].\n$$\n对每个所需的半整数索引应用中点插值：\n$$\nu_{\\text{inc},\\,i_{b}+1/2}^{\\,n+1/2} \\;=\\; \\frac{1}{\\rho_{0} c}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}-1}^{\\,n+1/2} \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} \\;-\\; \\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2}\\,\\Big],\n$$\n$$\nu_{\\text{inc},\\,i_{b}+3/2}^{\\,n+1/2} \\;=\\; \\frac{1}{\\rho_{0} c}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} \\;+\\; \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2} \\;-\\; \\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}+3}^{\\,n+1/2}\\,\\Big].\n$$\n代入并使用 $-\\rho_{0} c^{2} \\times (1/(\\rho_{0} c)) = -\\,c$ 进行化简：\n$$\n\\mathcal{C}_{p}(i_{b}) \\;=\\; -\\,\\frac{c\\,\\Delta t}{\\Delta x}\\,\\Bigg\\{\n\\frac{9}{8}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}-1}^{\\,n+1/2} + \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} + \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} - \\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2}\\Big]\n\\;-\\;\n\\frac{1}{24}\\,\\Big[\\,-\\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} + \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} + \\frac{9}{16}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2} - \\frac{1}{16}\\,p_{\\text{inc},\\,i_{b}+3}^{\\,n+1/2}\\Big]\n\\Bigg\\}.\n$$\n合并每个整数索引的系数：\n- 在 $i_{b}-1$ 处：系数 $-\\tfrac{9}{8}\\cdot\\tfrac{1}{16} = -\\tfrac{9}{128}$。\n- 在 $i_{b}$ 处：系数 $\\tfrac{9}{8}\\cdot\\tfrac{9}{16} + \\tfrac{1}{24}\\cdot\\tfrac{1}{16} = \\tfrac{81}{128} + \\tfrac{1}{384} = \\tfrac{244}{384} = \\tfrac{61}{96}$。\n- 在 $i_{b}+1$ 处：系数 $\\tfrac{9}{8}\\cdot\\tfrac{9}{16} - \\tfrac{1}{24}\\cdot\\tfrac{9}{16} = \\tfrac{81}{128} - \\tfrac{9}{384} = \\tfrac{234}{384} = \\tfrac{39}{64}$。\n- 在 $i_{b}+2$ 处：系数 $-\\tfrac{9}{8}\\cdot\\tfrac{1}{16} - \\tfrac{1}{24}\\cdot\\tfrac{9}{16} = -\\tfrac{9}{128} - \\tfrac{9}{384} = -\\tfrac{36}{384} = -\\tfrac{3}{32}$。\n- 在 $i_{b}+3$ 处：系数 $\\tfrac{1}{24}\\cdot\\tfrac{1}{16} = \\tfrac{1}{384}$。\n\n因此，封闭形式的 TF/SF 校正项为\n$$\n\\mathcal{C}_{p}(i_{b}) \\;=\\; -\\,\\frac{c\\,\\Delta t}{\\Delta x}\\,\\left[\\,-\\frac{9}{128}\\,p_{\\text{inc},\\,i_{b}-1}^{\\,n+1/2} \\;+\\; \\frac{61}{96}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2} \\;+\\; \\frac{39}{64}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2} \\;-\\; \\frac{3}{32}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2} \\;+\\; \\frac{1}{384}\\,p_{\\text{inc},\\,i_{b}+3}^{\\,n+1/2} \\right].\n$$\n该表达式为四阶有限差分格式在 TF/SF 接口处实现了入射通量匹配，它使用四阶中点插值从已知的入射压力样本来填充所需的鬼点半网格速度。",
            "answer": "$$\\boxed{-\\frac{c\\,\\Delta t}{\\Delta x}\\left[-\\frac{9}{128}\\,p_{\\text{inc},\\,i_{b}-1}^{\\,n+1/2}+\\frac{61}{96}\\,p_{\\text{inc},\\,i_{b}}^{\\,n+1/2}+\\frac{39}{64}\\,p_{\\text{inc},\\,i_{b}+1}^{\\,n+1/2}-\\frac{3}{32}\\,p_{\\text{inc},\\,i_{b}+2}^{\\,n+1/2}+\\frac{1}{384}\\,p_{\\text{inc},\\,i_{b}+3}^{\\,n+1/2}\\right]}$$"
        }
    ]
}