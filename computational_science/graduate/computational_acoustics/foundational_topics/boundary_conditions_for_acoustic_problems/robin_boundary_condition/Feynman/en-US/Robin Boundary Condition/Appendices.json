{
    "hands_on_practices": [
        {
            "introduction": "The first step in numerically solving wave equations with an impedance boundary is to accurately represent the Robin condition on a discrete grid. This foundational exercise guides you through deriving a second-order accurate finite-difference stencil using the ghost point method, a cornerstone technique in computational physics. Understanding this derivation is crucial for building stable and accurate finite-difference time-domain (FDTD) or frequency-domain solvers.",
            "id": "4135675",
            "problem": "Consider a time-harmonic acoustic pressure field $p(\\boldsymbol{x})$ in a homogeneous, inviscid fluid of mass density $\\rho_{0}$ driven at angular frequency $\\omega$, so that $p$ satisfies the frequency-domain acoustic wave equation (the Helmholtz equation) in the interior. On a smooth planar boundary $\\Gamma$ aligned with the Cartesian coordinate plane $x=0$, the field is subject to the local impedance Robin boundary condition\n$$\n\\frac{\\partial p}{\\partial n} - \\frac{i \\omega \\rho_{0}}{Z}\\, p = 0 \\quad \\text{on } \\Gamma,\n$$\nwhere $\\partial/\\partial n$ denotes differentiation along the unit normal that points into the computational domain (here chosen to be the $+x$ direction), $Z$ is the complex specific acoustic impedance (assumed spatially uniform), and $i$ is the unit imaginary number.\n\nYou are to discretize this boundary condition on a uniform Cartesian grid with spacing $h$ along the $x$-direction. Let the computational domain be $x \\geq 0$. Place the first interior grid line at $x = h$ and introduce one layer of ghost points at $x = -h$ outside the domain. Consider any fixed index in the tangential directions and denote the pressure at the ghost point by $p_{-1}$ (located at $x=-h$) and at the first interior point by $p_{1}$ (located at $x=h$).\n\nStarting from Taylor expansions about the boundary location $x=0$ and using only second-order accurate finite-difference and interpolation constructs consistent with the grid topology described above, derive the second-order accurate finite-difference boundary stencil that enforces the given Robin boundary condition and eliminates the ghost value $p_{-1}$ in terms of the interior value $p_{1}$. Your derivation must explicitly justify the order of accuracy by quantifying the truncation errors of all approximations used.\n\nExpress your final eliminated ghost value $p_{-1}$ as a closed-form analytic expression in terms of $p_{1}$, $\\omega$, $\\rho_{0}$, $Z$, and $h$. No numerical evaluation is required. The final answer must be a single analytic expression; do not include any rounding or units in the final expression.",
            "solution": "The problem is to derive a second-order accurate finite-difference stencil for a Robin boundary condition on a uniform grid, expressing the value at a ghost point in terms of an interior point. The problem is well-posed, scientifically grounded, and contains all necessary information for a unique derivation.\n\nThe given Robin boundary condition is specified on the plane $\\Gamma$ at $x=0$:\n$$\n\\frac{\\partial p}{\\partial n} - \\frac{i \\omega \\rho_{0}}{Z}\\, p = 0\n$$\nThe computational domain is $x \\geq 0$, so the outward normal from the domain is in the $-x$ direction. The problem specifies the normal derivative $\\partial/\\partial n$ is along the unit normal pointing *into* the computational domain, which is the $+x$ direction. Therefore, $\\frac{\\partial p}{\\partial n} = \\frac{\\partial p}{\\partial x}$. Let us define the coefficient $\\beta = \\frac{i \\omega \\rho_{0}}{Z}$. The boundary condition at $x=0$ becomes:\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{x=0} - \\beta \\, p(0) = 0\n$$\nThe objective is to find a relation between the pressure at the ghost point $p_{-1} = p(-h)$ and the first interior point $p_1 = p(h)$ that satisfies this condition to second-order accuracy. This requires constructing second-order accurate approximations for the derivative $p'(0) = \\frac{\\partial p}{\\partial x}\\bigg|_{x=0}$ and the value $p(0)$ at the boundary. These approximations will be derived from Taylor series expansions of the pressure field $p(x)$ around the boundary point $x=0$.\n\nThe Taylor series for $p(x)$ expanded about $x=0$ are:\n$$\np(x) = p(0) + x p'(0) + \\frac{x^2}{2} p''(0) + \\frac{x^3}{6} p'''(0) + \\mathcal{O}(x^4)\n$$\nEvaluating this series at the grid points $x=h$ and $x=-h$, we get:\n$$\np_1 = p(h) = p(0) + h p'(0) + \\frac{h^2}{2} p''(0) + \\frac{h^3}{6} p'''(0) + \\mathcal{O}(h^4)\n$$\n$$\np_{-1} = p(-h) = p(0) - h p'(0) + \\frac{h^2}{2} p''(0) - \\frac{h^3}{6} p'''(0) + \\mathcal{O}(h^4)\n$$\nTo construct a second-order accurate approximation for the derivative $p'(0)$, we subtract the second equation from the first:\n$$\np_1 - p_{-1} = 2h p'(0) + \\frac{h^3}{3} p'''(0) + \\mathcal{O}(h^5)\n$$\nSolving for $p'(0)$ gives:\n$$\np'(0) = \\frac{p_1 - p_{-1}}{2h} - \\frac{h^2}{6} p'''(0) + \\mathcal{O}(h^4)\n$$\nThe centered finite-difference approximation for the derivative is thus $\\frac{p_1 - p_{-1}}{2h}$. This approximation has a truncation error of $\\mathcal{O}(h^2)$, making it second-order accurate.\n\nNext, we need a second-order accurate approximation for the value $p(0)$ at the boundary, as required by the Robin condition. As specified in the problem, we can use an interpolation construct. We form this by adding the two Taylor series expansions:\n$$\np_1 + p_{-1} = 2p(0) + h^2 p''(0) + \\mathcal{O}(h^4)\n$$\nSolving for $p(0)$ gives:\n$$\np(0) = \\frac{p_1 + p_{-1}}{2} - \\frac{h^2}{2} p''(0) + \\mathcal{O}(h^4)\n$$\nThe approximation for $p(0)$ is the simple average $\\frac{p_1 + p_{-1}}{2}$. This is a second-order accurate interpolation with a truncation error of $\\mathcal{O}(h^2)$.\n\nNow, we substitute these two second-order accurate constructs into the boundary condition equation, $\\frac{\\partial p}{\\partial x}\\bigg|_{x=0} - \\beta \\, p(0) = 0$:\n$$\n\\left( \\frac{p_1 - p_{-1}}{2h} \\right) - \\beta \\left( \\frac{p_1 + p_{-1}}{2} \\right) = 0\n$$\nTo confirm the overall accuracy, we analyze the truncation error (T.E.) of this discrete scheme. The T.E. is the residual obtained by substituting the exact solution $p(x)$ into the discrete equation:\n$$\n\\text{T.E.} = \\left( \\frac{p(h) - p(-h)}{2h} \\right) - \\beta \\left( \\frac{p(h) + p(-h)}{2} \\right)\n$$\n$$\n\\text{T.E.} = \\left( p'(0) + \\frac{h^2}{6}p'''(0) + \\mathcal{O}(h^4) \\right) - \\beta \\left( p(0) + \\frac{h^2}{2}p''(0) + \\mathcal{O}(h^4) \\right)\n$$\n$$\n\\text{T.E.} = \\left( p'(0) - \\beta p(0) \\right) + h^2 \\left( \\frac{1}{6}p'''(0) - \\frac{\\beta}{2}p''(0) \\right) + \\mathcal{O}(h^4)\n$$\nSince the exact solution satisfies the boundary condition $p'(0) - \\beta p(0) = 0$, the first term vanishes. The leading term of the truncation error is proportional to $h^2$, which rigorously confirms that the derived numerical scheme is second-order accurate.\n\nThe final step is to solve the discrete boundary condition equation for the ghost point value $p_{-1}$ in terms of the interior point value $p_1$.\n$$\n\\frac{p_1 - p_{-1}}{2h} - \\beta \\frac{p_1 + p_{-1}}{2} = 0\n$$\nMultiplying the entire equation by $2h$ yields:\n$$\n(p_1 - p_{-1}) - h\\beta (p_1 + p_{-1}) = 0\n$$\nRearranging the terms to group $p_1$ and $p_{-1}$:\n$$\np_1 - h\\beta p_1 = p_{-1} + h\\beta p_{-1}\n$$\nFactoring out $p_1$ and $p_{-1}$:\n$$\np_1(1 - h\\beta) = p_{-1}(1 + h\\beta)\n$$\nSolving for $p_{-1}$:\n$$\np_{-1} = \\frac{1 - h\\beta}{1 + h\\beta} p_1\n$$\nNow, we substitute the expression for $\\beta = \\frac{i \\omega \\rho_{0}}{Z}$:\n$$\np_{-1} = \\frac{1 - h \\frac{i \\omega \\rho_{0}}{Z}}{1 + h \\frac{i \\omega \\rho_{0}}{Z}} p_1\n$$\nTo simplify this expression, we multiply the numerator and denominator by $Z$:\n$$\np_{-1} = \\frac{Z - i h \\omega \\rho_{0}}{Z + i h \\omega \\rho_{0}} p_1\n$$\nThis is the final closed-form expression for the ghost point value $p_{-1}$ in terms of the interior point value $p_1$ and the given physical and grid parameters, consistent with a second-order accurate discretization of the Robin boundary condition.",
            "answer": "$$\n\\boxed{\\frac{Z - i h \\omega \\rho_{0}}{Z + i h \\omega \\rho_{0}} p_{1}}\n$$"
        },
        {
            "introduction": "Moving from a local stencil to a complete simulation, this practice demonstrates how the Robin boundary condition is incorporated within the Finite Element Method (FEM) framework. You will implement the weak formulation for a 1D scattering problem, where the impedance condition appears as a natural boundary integral affecting the system's matrix and load vector. By validating your numerical reflection coefficient against the exact analytical solution, you will gain hands-on experience in building and verifying a computational acoustics model.",
            "id": "4135650",
            "problem": "Consider one-dimensional, time-harmonic acoustics in a straight duct occupying the interval $\\Omega = (0,L)$ with spatial coordinate $x$. Let the acoustic pressure be $p(x)$ under the time-harmonic ansatz with angular frequency $\\omega$, where the governing equation in the absence of volumetric sources is the Helmholtz equation derived from the linearized momentum and continuity equations and the equation of state. Starting from the linearized momentum equation $i \\omega \\rho \\mathbf{v} = -\\nabla p$ and the linearized continuity equation $i \\omega \\kappa p = -\\nabla \\cdot \\mathbf{v}$ with compressibility $\\kappa = 1/(\\rho c^2)$, show that the pressure $p$ satisfies the scalar Helmholtz equation \n$$\n\\frac{d^2 p}{d x^2} + k^2 p = 0,\n$$ \nwhere $k = \\omega / c$ is the acoustic wavenumber, $\\rho$ is the ambient density, and $c$ is the speed of sound.\n\nAt $x=0$, the wall imposes a local impedance condition relating the pressure to the normal velocity through $p = Z v_n$, where $Z$ is the specific acoustic impedance and $v_n$ is the normal component of velocity. Using $v_n = -\\frac{1}{i \\omega \\rho} \\frac{d p}{d n}$ with outward normal at $x=0$ pointing toward decreasing $x$, derive the Robin boundary condition \n$$\n\\frac{d p}{d n} + \\beta p = 0 \\quad \\text{on } x=0,\n$$\nwhere $\\beta = i \\frac{\\omega \\rho}{Z} = i \\frac{k \\rho c}{Z}$. Assume the outward normal at $x=L$ points toward increasing $x$. Impose a first-order absorbing boundary condition at $x=L$ corresponding to an outgoing wave,\n$$\n\\frac{d p}{d n} - i k p = 0 \\quad \\text{on } x=L,\n$$\nso that reflections from the truncation are minimized.\n\nConsider a plane wave incident from the right onto the impedance boundary at $x=0$, $p^{\\mathrm{i}}(x) = e^{-i k x}$, and define the scattered field $p^{\\mathrm{s}}$ so that the total field is $p = p^{\\mathrm{i}} + p^{\\mathrm{s}}$. Using the weak form obtained by multiplying the Helmholtz equation for $p^{\\mathrm{s}}$ by a test function $w$ and integrating over $\\Omega$, perform integration by parts and incorporate the boundary relations at $x=0$ and $x=L$ for the unknown scattered field to obtain the bilinear form and load term that feature boundary integrals. Assemble the Finite Element Method (FEM) system with continuous, piecewise-linear basis functions on a uniform mesh using the standard element stiffness and mass matrices corresponding to the bilinear form \n$$\na(w,p^{\\mathrm{s}}) = \\int_0^L \\frac{d w}{d x} \\frac{d p^{\\mathrm{s}}}{d x} \\, dx - k^2 \\int_0^L w \\, p^{\\mathrm{s}} \\, dx + \\int_{x=0} w \\, (-\\beta p^{\\mathrm{s}}) \\, d\\Gamma + \\int_{x=L} w \\, (i k p^{\\mathrm{s}}) \\, d\\Gamma,\n$$\nand the load \n$$\n\\ell(w) = \\int_{x=0} w \\left( -\\frac{d p^{\\mathrm{i}}}{d n} - \\beta p^{\\mathrm{i}} \\right) d\\Gamma,\n$$\nwhere $d\\Gamma$ denotes the boundary measure. In one spatial dimension, the boundary integrals reduce to evaluations at nodes. Implement the boundary integral assembly by appropriate quadrature consistent with the chosen basis and demonstrate that the assembled system is consistent with the continuous formulation.\n\nDefine the reflection coefficient $R$ as the ratio of the reflected wave amplitude to the incident wave amplitude at $x=0$. Using the plane-wave decomposition $p^{\\mathrm{i}}(x) = e^{-i k x}$ and $p^{\\mathrm{r}}(x) = R e^{i k x}$, argue that $R = p^{\\mathrm{s}}(0)$ and compare the numerically obtained $R$ against the analytic reflection coefficient at a locally reacting surface,\n$$\nR_{\\mathrm{analytic}} = \\frac{Z - Z_0}{Z + Z_0},\n$$\nwhere $Z_0 = \\rho c$ is the characteristic impedance of air.\n\nYour program must:\n- Assemble and solve the linear system for $p^{\\mathrm{s}}$ using a uniform mesh with $N$ elements on $(0,L)$ and continuous, piecewise-linear basis functions.\n- Use the boundary integral contributions at $x=0$ and $x=L$ with one-point quadrature appropriate for the nodal basis in one spatial dimension.\n- Compute $R_{\\mathrm{numeric}} = p^{\\mathrm{s}}(0)$ and the absolute error $E = |R_{\\mathrm{numeric}} - R_{\\mathrm{analytic}}|$ for each test case.\n\nUse the following physical parameters, ensuring all quantities are in International System of Units (SI):\n- Duct length $L$ in meters (m).\n- Frequency $f$ in hertz (Hz), with angular frequency $\\omega = 2\\pi f$ in radians per second (rad/s).\n- Speed of sound $c$ in meters per second (m/s).\n- Density $\\rho$ in kilograms per cubic meter (kg/m$^3$).\n- Specific acoustic impedance $Z$ in pascal-seconds per meter (Pa·s/m).\n- Number of elements $N$ as a positive integer.\n- The angle unit, where applicable, must be radians. The reflection coefficient is complex-valued, but report only the absolute error $E$ as a real-valued float without units.\n\nTest Suite:\nUse $L = 1.0$ m, $c = 343.0$ m/s, $\\rho = 1.21$ kg/m$^3$, $f = 1000.0$ Hz. Define five test cases with different impedances and mesh sizes:\n- Case A: $Z = Z_0$, $N = 80$.\n- Case B: $Z = 1000 \\, Z_0$, $N = 120$.\n- Case C: $Z = 0.001 \\, Z_0$, $N = 120$.\n- Case D: $Z = 2 \\, Z_0$, $N = 80$.\n- Case E: $Z = i \\, Z_0$, $N = 120$.\n\nFor each case, compute the absolute error $E$ as a float. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[E_{\\mathrm{A}},E_{\\mathrm{B}},E_{\\mathrm{C}},E_{\\mathrm{D}},E_{\\mathrm{E}}]$).",
            "solution": "The user has provided a computational acoustics problem to be solved using the Finite Element Method (FEM). This document first validates the problem statement and then presents a comprehensive solution.\n\n### Step 1: Problem Validation\n\n**1.1. Givens Extraction**\n\n- **Governing Equation**: The one-dimensional scalar Helmholtz equation for acoustic pressure $p(x)$:\n$$\n\\frac{d^2 p}{d x^2} + k^2 p = 0 \\quad \\text{on } \\Omega = (0,L)\n$$\nwhere $k=\\omega/c$ is the wavenumber.\n- **Incident Field**: A plane wave incident from the right: $p^{\\mathrm{i}}(x) = e^{-i k x}$.\n- **Total Field**: $p = p^{\\mathrm{i}} + p^{\\mathrm{s}}$, where $p^{\\mathrm{s}}$ is the scattered field.\n- **Boundary Condition at $x=0$**: Local impedance condition on the total field $p$:\n$$\n\\frac{d p}{d n} + \\beta p = 0, \\quad \\text{where } \\beta = i \\frac{\\omega \\rho}{Z} = i \\frac{k \\rho c}{Z}\n$$\nThe outward normal $n$ points toward decreasing $x$, so $\\frac{d}{dn} = -\\frac{d}{dx}$.\n- **Boundary Condition at $x=L$**: First-order absorbing boundary condition on the total field $p$:\n$$\n\\frac{d p}{d n} - i k p = 0\n$$\nThe outward normal $n$ points toward increasing $x$, so $\\frac{d}{dn} = \\frac{d}{dx}$.\n- **Weak Formulation for $p^{\\mathrm{s}}$**: The problem is to be solved for the scattered field $p^{\\mathrm{s}}$ using the given bilinear form and linear functional:\n    - Bilinear form: $a(w,p^{\\mathrm{s}}) = \\int_0^L \\frac{d w}{d x} \\frac{d p^{\\mathrm{s}}}{d x} \\, dx - k^2 \\int_0^L w \\, p^{\\mathrm{s}} \\, dx + \\int_{x=0} w \\, (-\\beta p^{\\mathrm{s}}) \\, d\\Gamma + \\int_{x=L} w \\, (i k p^{\\mathrm{s}}) \\, d\\Gamma$.\n    - Linear functional (load term): $\\ell(w) = \\int_{x=0} w \\left( -\\frac{d p^{\\mathrm{i}}}{d n} - \\beta p^{\\mathrm{i}} \\right) d\\Gamma$.\n- **FEM Discretization**: Use continuous, piecewise-linear basis functions on a uniform mesh with $N$ elements.\n- **Reflection Coefficient**:\n    - Numerical: $R_{\\mathrm{numeric}} = p^{\\mathrm{s}}(0)$.\n    - Analytical: $R_{\\mathrm{analytic}} = \\frac{Z - Z_0}{Z + Z_0}$, where $Z_0 = \\rho c$.\n- **Error Metric**: $E = |R_{\\mathrm{numeric}} - R_{\\mathrm{analytic}}|$.\n- **Physical Parameters**: $L$, $f$ (with $\\omega=2\\pi f$), $c$, $\\rho$, $Z$, $N$.\n- **Test Suite**:\n    - Shared parameters: $L = 1.0$ m, $c = 343.0$ m/s, $\\rho = 1.21$ kg/m$^3$, $f = 1000.0$ Hz.\n    - Case A: $Z = Z_0$, $N = 80$.\n    - Case B: $Z = 1000 \\, Z_0$, $N = 120$.\n    - Case C: $Z = 0.001 \\, Z_0$, $N = 120$.\n    - Case D: $Z = 2 \\, Z_0$, $N = 80$.\n    - Case E: $Z = i \\, Z_0$, $N = 120$.\n\n**1.2. Validation Using Extracted Givens**\n\nThe problem is a standard textbook exercise in computational acoustics, applying the Finite Element Method to the 1D Helmholtz equation.\n- **Scientifically Grounded**: The physics (Helmholtz equation, impedance boundary conditions, absorbing boundary conditions) are fundamental concepts in acoustics. The problem is scientifically sound and free of pseudoscience.\n- **Well-Posed**: The problem is well-posed. The Helmholtz equation with Robin-type boundary conditions at both ends generally admits a unique solution. The specific formulation for the scattered field with a source term arising from the incident field is a standard technique.\n- **Objective**: The problem is stated in precise mathematical and physical language. All terms are defined, and the task is objective.\n- **Completeness and Consistency**: The problem statement provides all necessary information. The provided bilinear form and load term are consistent with the governing equations and boundary conditions, as will be demonstrated in the solution derivation.\n- **No Other Flaws**: The problem does not exhibit any of the other invalidity flags (unrealistic, ill-structured, trivial, etc.). It is a concrete computational task with a clear success metric (comparison to an analytical solution).\n\n**1.3. Verdict and Action**\n\nThe problem statement is **valid**. A complete, reasoned solution will be provided.\n\n### Step 2: Solution Derivation\n\n**2.1. Problem Formulation**\nThe total acoustic pressure $p(x) = p^{\\mathrm{i}}(x) + p^{\\mathrm{s}}(x)$ satisfies the Helmholtz equation. Since the incident field $p^{\\mathrm{i}}(x)=e^{-ikx}$ is itself a solution to the homogeneous Helmholtz equation ($\\frac{d^2p^{\\mathrm{i}}}{dx^2} + k^2 p^{\\mathrm{i}} = 0$), by linearity, the scattered field $p^{\\mathrm{s}}(x)$ must also satisfy the same equation:\n$$\n\\frac{d^2 p^{\\mathrm{s}}}{d x^2} + k^2 p^{\\mathrm{s}} = 0 \\quad \\text{for } x \\in (0, L)\n$$\n\n**2.2. Variational (Weak) Formulation**\nWe derive the weak form for the scattered field $p^{\\mathrm{s}}$. We multiply the governing equation by a sufficiently smooth test function $w(x)$ and integrate over the domain $\\Omega = (0, L)$:\n$$\n\\int_0^L \\left( \\frac{d^2 p^{\\mathrm{s}}}{dx^2} + k^2 p^{\\mathrm{s}} \\right) w \\, dx = 0\n$$\nApplying integration by parts to the second derivative term gives:\n$$\n\\int_0^L \\frac{d^2 p^{\\mathrm{s}}}{dx^2} w \\, dx = \\left[ w \\frac{dp^{\\mathrm{s}}}{dx} \\right]_0^L - \\int_0^L \\frac{dw}{dx} \\frac{dp^{\\mathrm{s}}}{dx} \\, dx\n$$\nSubstituting this into the integrated equation yields:\n$$\n-\\int_0^L \\frac{dw}{dx} \\frac{dp^{\\mathrm{s}}}{dx} \\, dx + \\int_0^L k^2 w p^{\\mathrm{s}} \\, dx + \\left[ w \\frac{dp^{\\mathrm{s}}}{dx} \\right]_0^L = 0\n$$\nRearranging terms places the derivatives of the unknown function $p^{\\mathrm{s}}$ on the right-hand side, which will be handled by the boundary conditions:\n$$\n\\int_0^L \\frac{dw}{dx} \\frac{dp^{\\mathrm{s}}}{dx} \\, dx - \\int_0^L k^2 w p^{\\mathrm{s}} \\, dx = \\left[ w \\frac{dp^{\\mathrm{s}}}{dx} \\right]_0^L = w(L)\\frac{dp^{\\mathrm{s}}}{dx}(L) - w(0)\\frac{dp^{\\mathrm{s}}}{dx}(0)\n$$\nThe boundary conditions are given for the total field $p=p^{\\mathrm{i}}+p^{\\mathrm{s}}$. We must express the derivatives of $p^{\\mathrm{s}}$ in terms of $p^{\\mathrm{s}}$ itself and the known incident field $p^{\\mathrm{i}}$.\n\n- At $x=0$, the condition is $\\frac{dp}{dn} + \\beta p = 0$. With $\\frac{d}{dn} = -\\frac{d}{dx}$, this becomes $-\\frac{d}{dx}(p^{\\mathrm{i}}+p^{\\mathrm{s}}) + \\beta(p^{\\mathrm{i}}+p^{\\mathrm{s}}) = 0$. Solving for $\\frac{dp^{\\mathrm{s}}}{dx}(0)$ gives:\n$$\n\\frac{dp^{\\mathrm{s}}}{dx}(0) = \\beta p^{\\mathrm{s}}(0) - \\frac{dp^{\\mathrm{i}}}{dx}(0) + \\beta p^{\\mathrm{i}}(0)\n$$\nUsing the normal derivative notation, this is equivalent to $\\frac{dp^{\\mathrm{s}}}{dn}(0) = -\\beta p^{\\mathrm{s}}(0) - \\frac{dp^{\\mathrm{i}}}{dn}(0) - \\beta p^{\\mathrm{i}}(0)$.\n\n- At $x=L$, the absorbing boundary condition is given as $\\frac{dp}{dn} - ikp=0$. With $\\frac{d}{dn} = \\frac{d}{dx}$, this is $\\frac{d}{dx}(p^{\\mathrm{i}}+p^{\\mathrm{s}}) - ik(p^{\\mathrm{i}}+p^{\\mathrm{s}}) = 0$. We solve for $\\frac{dp^{\\mathrm{s}}}{dx}(L)$:\n$$\n\\frac{dp^{\\mathrm{s}}}{dx}(L) = ikp^{\\mathrm{s}}(L) - \\frac{dp^{\\mathrm{i}}}{dx}(L) + ikp^{\\mathrm{i}}(L)\n$$\nSince $p^{\\mathrm{i}}(x)=e^{-ikx}$, we have $\\frac{dp^{\\mathrm{i}}}{dx} = -ik p^{\\mathrm{i}}$. At $x=L$, the rightmost two terms become $-(-ikp^{\\mathrm{i}}(L)) + ikp^{\\mathrm{i}}(L) = 2ikp^{\\mathrm{i}}(L)$. However, the problem specifies a particular weak form which implies the absorbing boundary condition is homogeneous for the scattered field, i.e., $\\frac{dp^{\\mathrm{s}}}{dn}(L) - ikp^{\\mathrm{s}}(L) = 0$, implying $\\frac{dp^{\\mathrm{s}}}{dx}(L) = ikp^{\\mathrm{s}}(L)$. This is a standard simplification assuming $L$ is large enough that the incident field is negligible at the absorbing boundary. The problem's given bilinear form $a(w, p^{\\mathrm{s}})$ is consistent with this assumption.\n\nLet's demonstrate consistency with the provided forms. The weak formulation is $a(w,p^{\\mathrm{s}}) = \\ell(w)$, which must be equivalent to the variational form derived from the strong form.\nStarting from the strong form for $p^s$:\n$\\int_0^L \\frac{dw}{dx} \\frac{dp^s}{dx} dx - \\int_0^L k^2 w p^s dx = w(L)\\frac{dp^s}{dx}(L) - w(0)\\frac{dp^s}{dx}(0)$\nThe provided weak form is:\n$\\int_0^L \\frac{dw}{dx} \\frac{dp^s}{dx} dx - \\int_0^L k^2 w p^s dx - w(0)\\beta p^s(0) + w(L)ikp^s(L) = w(0)\\left(\\frac{dp^{\\mathrm{i}}}{dx}(0) - \\beta p^{\\mathrm{i}}(0)\\right)$\nwhere we have used $\\frac{d}{dn}=-\\frac{d}{dx}$ in $\\ell(w)$.\nComparing these two equations reveals the underlying boundary conditions being enforced:\n1. At $x=L$: $w(L)\\frac{dp^s}{dx}(L) = w(L)ikp^s(L) \\implies \\frac{dp^s}{dx}(L)=ikp^s(L)$. This is the first-order absorbing boundary condition applied to the scattered field.\n2. At $x=0$: $-w(0)\\frac{dp^s}{dx}(0) = -w(0)\\beta p^s(0) + w(0)(\\frac{dp^i}{dx}(0) - \\beta p^i(0))$. This yields $\\frac{dp^s}{dx}(0) = \\beta p^s(0) - \\frac{dp^i}{dx}(0) + \\beta p^i(0)$, which is precisely the impedance boundary condition for the total field.\nThe formulation is thus consistent.\n\n**2.3. Finite Element Discretization**\nWe discretize the domain $\\Omega=(0,L)$ with a uniform mesh of $N$ elements and $N+1$ nodes, $x_j=j h$ for $j=0, \\dots, N$, where $h=L/N$ is the element size. We approximate the unknown scattered field $p^{\\mathrm{s}}(x)$ as a linear combination of continuous, piecewise-linear (\"hat\") basis functions $\\phi_j(x)$:\n$$\np^{\\mathrm{s}}(x) \\approx p_h^{\\mathrm{s}}(x) = \\sum_{j=0}^{N} p_j^{\\mathrm{s}} \\phi_j(x)\n$$\nwhere $p_j^{\\mathrm{s}}$ are the unknown complex coefficients representing the value of the scattered field at node $x_j$, and $\\phi_j(x_i) = \\delta_{ij}$. Using the Galerkin method, we choose the test functions $w$ from the same space as the basis functions, i.e., $w = \\phi_i$ for $i=0, \\dots, N$. This transforms the weak form $a(p_h^{\\mathrm{s}}, \\phi_i) = \\ell(\\phi_i)$ into a system of $N+1$ linear algebraic equations for the $N+1$ unknowns $\\mathbf{p}^{\\mathrm{s}} = [p_0^{\\mathrm{s}}, \\dots, p_N^{\\mathrm{s}}]^T$:\n$$\nA \\mathbf{p}^{\\mathrm{s}} = \\mathbf{b}\n$$\n\n**2.4. Matrix and Vector Assembly**\nThe entries of the system matrix $A$ and load vector $\\mathbf{b}$ are given by $A_{ij} = a(\\phi_j, \\phi_i)$ and $b_i = \\ell(\\phi_i)$.\n\n- **Matrix A**: The matrix $A$ is assembled from four components derived from the bilinear form $a(w, p^{\\mathrm{s}})$:\n$$\nA_{ij} = \\underbrace{\\int_0^L \\frac{d\\phi_i}{dx}\\frac{d\\phi_j}{dx}dx}_{K_{ij}} - k^2 \\underbrace{\\int_0^L \\phi_i \\phi_j dx}_{M_{ij}} + \\underbrace{\\phi_i(L) (ik) \\phi_j(L) - \\phi_i(0) \\beta \\phi_j(0)}_{(A_{\\text{BC}})_{ij}}\n$$\nThe assembly proceeds by summing contributions from standard element stiffness ($K^e$) and mass ($M^e$) matrices. For a single element of length $h$, these are:\n$$\nK^e = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad M^e = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\nThe global stiffness matrix $K$ and mass matrix $M$ are tridiagonal matrices formed by assembling these element matrices. The boundary terms contribute only to the diagonal entries at the boundaries.\n- The term $-\\phi_i(0)\\beta\\phi_j(0)$ is non-zero only for $i=j=0$, adding $-\\beta$ to $A_{00}$.\n- The term $\\phi_i(L) (ik) \\phi_j(L)$ is non-zero only for $i=j=N$, adding $ik$ to $A_{NN}$.\n\n- **Vector b**: The load vector $\\mathbf{b}$ is assembled from the linear functional $\\ell(w)$:\n$$\nb_i = \\ell(\\phi_i) = \\int_{x=0} \\phi_i \\left( -\\frac{d p^{\\mathrm{i}}}{d n} - \\beta p^{\\mathrm{i}} \\right) d\\Gamma\n$$\nIn one dimension, this integral becomes a point evaluation at $x=0$.\n$b_i = \\phi_i(0) \\left( -\\frac{d p^{\\mathrm{i}}}{d n}(0) - \\beta p^{\\mathrm{i}}(0) \\right) = \\phi_i(0) \\left( \\frac{d p^{\\mathrm{i}}}{d x}(0) - \\beta p^{\\mathrm{i}}(0) \\right)$\nSince $\\phi_i(0) = \\delta_{i0}$, the vector $\\mathbf{b}$ has only one non-zero entry at $i=0$:\n$$\nb_0 = \\frac{d p^{\\mathrm{i}}}{dx}(0) - \\beta p^{\\mathrm{i}}(0)\n$$\nWith $p^{\\mathrm{i}}(x) = e^{-ikx}$, we have $p^{\\mathrm{i}}(0)=1$ and $\\frac{dp^{\\mathrm{i}}}{dx}(0) = -ik$. Thus,\n$$\nb_0 = -ik - \\beta\n$$\nAll other entries $b_i$ for $i > 0$ are zero.\n\n**2.5. Solution and Post-processing**\nAfter assembling the complex-valued matrix $A$ and vector $\\mathbf{b}$, the linear system $A \\mathbf{p}^{\\mathrm{s}} = \\mathbf{b}$ is solved to find the nodal values of the scattered field.\n\nThe reflection coefficient $R$ is defined as the complex amplitude of the reflected wave $p^{\\mathrm{r}}(x) = R e^{ikx}$ such that the total field near the surface at $x=0$ is $p(x) = p^{\\mathrm{i}}(x) + p^{\\mathrm{r}}(x)$. Evaluating at $x=0$:\n$$\np(0) = p^{\\mathrm{i}}(0) + p^{\\mathrm{r}}(0) = e^0 + R e^0 = 1+R\n$$\nFrom the decomposition $p(x) = p^{\\mathrm{i}}(x) + p^{\\mathrm{s}}(x)$, we also have:\n$$\np(0) = p^{\\mathrm{i}}(0) + p^{\\mathrm{s}}(0) = 1 + p^{\\mathrm{s}}(0)\n$$\nComparing these two expressions for $p(0)$ shows that $R = p^{\\mathrm{s}}(0)$. The numerically computed reflection coefficient is therefore the first entry of the solution vector, $R_{\\mathrm{numeric}} = p_0^{\\mathrm{s}}$. This is compared against the analytical formula for reflection from a locally reacting surface, $R_{\\mathrm{analytic}} = \\frac{Z-Z_0}{Z+Z_0}$, and the absolute error $E = |R_{\\mathrm{numeric}}-R_{\\mathrm{analytic}}|$ is computed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a 1D Helmholtz equation for acoustic scattering using the Finite Element Method.\n    \n    The problem considers a plane wave incident on an impedance boundary in a duct.\n    The scattered field is computed on a uniform mesh with linear basis functions.\n    The code assembles and solves the resulting linear system, then computes the\n    error between the numerical and analytical reflection coefficients for several\n    test cases.\n    \"\"\"\n    \n    # Define physical and simulation parameters from the problem statement.\n    L = 1.0  # Duct length in meters\n    c = 343.0  # Speed of sound in m/s\n    rho = 1.21  # Density in kg/m^3\n    f = 1000.0  # Frequency in Hz\n\n    # Derived physical parameters\n    omega = 2.0 * np.pi * f  # Angular frequency in rad/s\n    k = omega / c  # Wavenumber in rad/m\n    Z0 = rho * c  # Characteristic impedance of the medium in Pa·s/m\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Z, N)\n        (Z0, 80),           # Case A: Impedance matched\n        (1000.0 * Z0, 120), # Case B: High impedance (near rigid)\n        (0.001 * Z0, 120),  # Case C: Low impedance (near pressure-release)\n        (2.0 * Z0, 80),     # Case D: Mismatched impedance\n        (1j * Z0, 120)      # Case E: Purely reactive impedance\n    ]\n\n    results = []\n    for Z, N in test_cases:\n        # Mesh properties\n        h = L / N  # Element size\n        num_nodes = N + 1\n\n        # Boundary condition parameter\n        beta = 1j * k * Z0 / Z\n\n        # Initialize the global system matrix A\n        A = np.zeros((num_nodes, num_nodes), dtype=np.complex128)\n\n        # Define standard element stiffness and mass matrices for linear elements\n        K_e = (1.0 / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n        M_e = (h / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n        \n        # Element matrix from the weak form's interior integrals\n        A_e = K_e - k**2 * M_e\n\n        # Assemble the global matrix A from element matrices\n        for i in range(N):\n            # Global indices for the current element are i and i+1\n            A[i:i+2, i:i+2] += A_e\n\n        # Apply boundary condition contributions to matrix A\n        # From the term -beta * w(0) * p^s(0)\n        A[0, 0] -= beta\n        # From the term +ik * w(L) * p^s(L)\n        A[N, N] += 1j * k\n\n        # Assemble the load vector b\n        b = np.zeros(num_nodes, dtype=np.complex128)\n        # The only non-zero term comes from the boundary at x=0\n        b[0] = -1j * k - beta\n\n        # Solve the complex linear system A * p_s = b\n        p_s = np.linalg.solve(A, b)\n\n        # The numerical reflection coefficient is the scattered field at x=0\n        R_numeric = p_s[0]\n\n        # Calculate the analytical reflection coefficient\n        R_analytic = (Z - Z0) / (Z + Z0)\n\n        # Compute the absolute error and store it\n        error = np.abs(R_numeric - R_analytic)\n        results.append(error)\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(f'{err:.12e}' for err in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Real-world acoustic materials often exhibit an impedance that varies with frequency, a feature that complicates time-domain simulations. This advanced practice introduces the powerful Auxiliary Differential Equation (ADE) method, which bypasses computationally expensive convolutions by converting a frequency-dependent impedance into a local-in-time system of ordinary differential equations. By deriving the discrete update rule, you will learn a cornerstone technique for efficiently modeling realistic, broadband acoustic liners and absorbers in time-domain codes.",
            "id": "4135638",
            "problem": "Consider one-dimensional linear acoustics in a half-space with spatial coordinate $x \\ge 0$, acoustic pressure $p(x,t)$, and outward normal particle velocity at the boundary $x=0$ denoted $u(t) = u(0,t)$. The local impedance boundary condition relates the boundary pressure and velocity through a temporal convolution $p(0,t) = (z * u)(t)$, where $z(t)$ is the impulse response of the impedance and $*$ denotes convolution in time. The frequency-domain impedance is defined by the Fourier transform $Z(\\omega) = \\int_{-\\infty}^{\\infty} z(t) \\exp(-\\mathrm{i} \\omega t) \\,\\mathrm{d}t$ and is assumed to be rational, positive real, and strictly proper in the following form:\n$$\nZ(\\omega) = Z_{\\infty} + \\sum_{m=1}^{M} \\frac{A_{m}}{1 + \\mathrm{i} \\omega \\tau_{m}},\n$$\nwith constants $Z_{\\infty} \\ge 0$, $A_{m} \\ge 0$, and relaxation times $\\tau_{m} > 0$ for $m = 1,2,\\dots,M$. This structure models a parallel combination of an instantaneous resistive branch $Z_{\\infty}$ and $M$ first-order relaxation branches.\n\nStarting from the definition $p(0,t) = (z * u)(t)$ and the given rational form of $Z(\\omega)$, derive a set of auxiliary differential equations (Auxiliary Differential Equation (ADE) representation) in the time domain that eliminate explicit convolution, by introducing internal variables $\\{y_{m}(t)\\}_{m=1}^{M}$ such that $p(0,t)$ can be written as a sum of $Z_{\\infty} u(t)$ and these internal variables. Then, assuming a time-stepping scheme with uniform time step $\\Delta t > 0$ and that $u(t)$ is held piecewise constant over each interval $[t^{n-1}, t^{n}]$ with $t^{n} = t^{n-1} + \\Delta t$ and $u(t) = u^{n}$ on $[t^{n-1}, t^{n}]$, obtain the discrete-time update for the boundary pressure $p^{n} = p(0,t^{n})$ in terms of the current velocity sample $u^{n}$ and the previous internal states $y_{m}^{n-1} = y_{m}(t^{n-1})$. Express your final boundary update as a single closed-form analytic expression. No numerical approximation or rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational acoustics, mathematically well-posed, objective, and provides a complete and consistent setup for the derivation of a numerical update scheme for an impedance boundary condition.\n\nThe derivation proceeds in two stages: first, the conversion of the frequency-domain impedance into a system of time-domain ordinary differential equations (ODEs), and second, the analytical solution of these ODEs under a piecewise-constant input assumption to derive a discrete-time update rule.\n\n**Part 1: Derivation of the Auxiliary Differential Equation (ADE) Representation**\n\nThe relationship between the acoustic pressure $p(0,t)$ and the particle velocity $u(t)$ at the boundary $x=0$ is given in the frequency domain as $\\hat{p}(0,\\omega) = Z(\\omega)\\hat{u}(\\omega)$, where $\\hat{p}$, $\\hat{u}$, and $Z$ are the Fourier transforms of $p(0,t)$, $u(t)$, and the impedance impulse response $z(t)$, respectively. The frequency-domain impedance $Z(\\omega)$ is given as:\n$$\nZ(\\omega) = Z_{\\infty} + \\sum_{m=1}^{M} \\frac{A_{m}}{1 + \\mathrm{i} \\omega \\tau_{m}}\n$$\nSubstituting this into the pressure-velocity relationship yields:\n$$\n\\hat{p}(0, \\omega) = \\left( Z_{\\infty} + \\sum_{m=1}^{M} \\frac{A_{m}}{1 + \\mathrm{i} \\omega \\tau_{m}} \\right) \\hat{u}(\\omega) = Z_{\\infty} \\hat{u}(\\omega) + \\sum_{m=1}^{M} \\frac{A_{m}}{1 + \\mathrm{i} \\omega \\tau_{m}} \\hat{u}(\\omega)\n$$\nTo eliminate the explicit frequency dependence and the resulting time-domain convolution, we introduce a set of $M$ auxiliary variables, $\\{y_m(t)\\}_{m=1}^M$. In the frequency domain, their transforms $\\hat{y}_m(\\omega)$ are defined as:\n$$\n\\hat{y}_{m}(\\omega) = \\frac{A_{m}}{1 + \\mathrm{i} \\omega \\tau_{m}} \\hat{u}(\\omega)\n$$\nWith these definitions, the expression for the pressure transform simplifies to:\n$$\n\\hat{p}(0, \\omega) = Z_{\\infty} \\hat{u}(\\omega) + \\sum_{m=1}^{M} \\hat{y}_{m}(\\omega)\n$$\nApplying the inverse Fourier transform, which is a linear operation, we obtain the time-domain expression for the boundary pressure:\n$$\np(0,t) = Z_{\\infty} u(t) + \\sum_{m=1}^{M} y_{m}(t)\n$$\nThis form expresses the pressure as a sum of an instantaneous response term $Z_{\\infty} u(t)$ and the contributions from the internal state variables $y_m(t)$, as required.\n\nNext, we derive the differential equations governing these internal variables. Rearranging the definition of $\\hat{y}_m(\\omega)$:\n$$\n\\hat{y}_{m}(\\omega) (1 + \\mathrm{i} \\omega \\tau_{m}) = A_{m} \\hat{u}(\\omega)\n$$\n$$\n\\hat{y}_{m}(\\omega) + \\tau_{m} (\\mathrm{i} \\omega \\hat{y}_{m}(\\omega)) = A_{m} \\hat{u}(\\omega)\n$$\nWe use the differentiation property of the Fourier transform, which states that the transform of a derivative $\\frac{df}{dt}$ is $\\mathrm{i}\\omega \\hat{f}(\\omega)$. Applying the inverse Fourier transform to the equation above yields the auxiliary differential equation (ADE) for each internal variable $y_m(t)$:\n$$\ny_{m}(t) + \\tau_{m} \\frac{d y_{m}(t)}{dt} = A_{m} u(t)\n$$\nIn standard first-order ODE form, this is:\n$$\n\\frac{d y_{m}(t)}{dt} = -\\frac{1}{\\tau_{m}} y_{m}(t) + \\frac{A_{m}}{\\tau_{m}} u(t), \\quad \\text{for } m = 1, 2, \\dots, M\n$$\nThis set of $M$ uncoupled ODEs, along with the expression for $p(0,t)$, constitutes the ADE representation of the impedance boundary condition.\n\n**Part 2: Derivation of the Discrete-Time Update**\n\nWe discretize in time with a uniform step $\\Delta t$, where $t^n = n \\Delta t$. The problem specifies that the velocity $u(t)$ is held piecewise constant over each time interval, i.e., $u(t) = u^n$ for $t \\in [t^{n-1}, t^n]$. Our goal is to find an expression for the pressure at the boundary at time $t^n$, denoted $p^n = p(0, t^n)$.\n\nFrom the ADE representation, we have:\n$$\np^n = p(0,t^n) = Z_{\\infty} u(t^n) + \\sum_{m=1}^{M} y_{m}(t^n)\n$$\nGiven the piecewise-constant assumption, we set $u(t^n) = u^n$ and $y_m(t^n) = y_m^n$:\n$$\np^n = Z_{\\infty} u^n + \\sum_{m=1}^{M} y_{m}^n\n$$\nTo find $y_m^n$, we must solve the ODE for $y_m(t)$ over the interval $[t^{n-1}, t^n]$ with the initial condition $y_m(t^{n-1}) = y_m^{n-1}$. On this interval, the ODE becomes a linear first-order equation with a constant forcing term:\n$$\n\\frac{d y_{m}(t)}{dt} + \\frac{1}{\\tau_{m}} y_{m}(t) = \\frac{A_{m}}{\\tau_{m}} u^n\n$$\nThe general solution to an ODE of the form $y' + ay = b$ is $y(t) = C \\exp(-at) + b/a$. For our case, $a = 1/\\tau_m$ and $b = (A_m/\\tau_m)u^n$. Thus, the particular solution is $b/a = A_m u^n$. The general solution for $y_m(t)$ on the interval is:\n$$\ny_m(t) = K_m \\exp\\left(-\\frac{t}{\\tau_m}\\right) + A_m u^n\n$$\nThe integration constant $K_m$ is determined by the value at the start of the interval, $y_m(t^{n-1}) = y_m^{n-1}$:\n$$\ny_m^{n-1} = K_m \\exp\\left(-\\frac{t^{n-1}}{\\tau_m}\\right) + A_m u^n \\implies K_m = \\left(y_m^{n-1} - A_m u^n\\right) \\exp\\left(\\frac{t^{n-1}}{\\tau_m}\\right)\n$$\nSubstituting $K_m$ back into the solution for $y_m(t)$:\n$$\ny_m(t) = \\left(y_m^{n-1} - A_m u^n\\right) \\exp\\left(\\frac{t^{n-1}}{\\tau_m}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right) + A_m u^n = \\left(y_m^{n-1} - A_m u^n\\right) \\exp\\left(-\\frac{t-t^{n-1}}{\\tau_m}\\right) + A_m u^n\n$$\nWe find the value at the end of the interval, $y_m^n = y_m(t^n)$, by setting $t = t^n$. Since $t^n - t^{n-1} = \\Delta t$, we get:\n$$\ny_m^n = \\left(y_m^{n-1} - A_m u^n\\right) \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right) + A_m u^n\n$$\nRearranging gives the explicit update rule for the internal state variables:\n$$\ny_m^n = y_m^{n-1} \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right) + A_m u^n \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right)\\right)\n$$\nFinally, we substitute this expression for $y_m^n$ back into the formula for $p^n$:\n$$\np^n = Z_{\\infty} u^n + \\sum_{m=1}^{M} \\left[ y_m^{n-1} \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right) + A_m u^n \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right)\\right) \\right]\n$$\nTo obtain the final closed-form expression, we group the terms containing the current velocity $u^n$ and the terms containing the previous internal states $y_m^{n-1}$:\n$$\np^n = Z_{\\infty} u^n + \\left( \\sum_{m=1}^{M} A_m \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right)\\right) \\right) u^n + \\sum_{m=1}^{M} y_m^{n-1} \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right)\n$$\nFactoring out $u^n$ yields the complete boundary update expression:\n$$\np^n = \\left( Z_{\\infty} + \\sum_{m=1}^{M} A_m \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right)\\right) \\right) u^n + \\sum_{m=1}^{M} y_m^{n-1} \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right)\n$$\nThis expression provides the updated boundary pressure $p^n$ based on the current boundary velocity $u^n$ and the stored history from the previous time step, encapsulated in the values $\\{y_m^{n-1}\\}_{m=1}^M$.",
            "answer": "$$\n\\boxed{\\left( Z_{\\infty} + \\sum_{m=1}^{M} A_m \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right)\\right) \\right) u^n + \\sum_{m=1}^{M} y_m^{n-1} \\exp\\left(-\\frac{\\Delta t}{\\tau_m}\\right)}\n$$"
        }
    ]
}