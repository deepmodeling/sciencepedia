{
    "hands_on_practices": [
        {
            "introduction": "在实施任何数值方法之前，理解其理论性能至关重要。这个练习将引导您推导最简单的一阶Engquist-Majda条件的反射系数$R(\\theta)$。通过这个基础分析，您将揭示该边界条件在简单性与准确性之间的基本权衡，并理解其吸收效果如何随波的入射角$\\theta$而变化。",
            "id": "4133410",
            "problem": "考虑一个二维空间中的均匀、各向同性声学介质，其声速为常数 $c$。声压 $p(x,y,t)$ 在半空间域 $\\{(x,y) \\in \\mathbb{R}^{2} : x > 0\\}$ 中满足标量波动方程 $p_{tt} = c^{2} \\Delta p$，边界位于 $x = 0$。在边界上，施加一阶 Engquist–Majda (EM) 单向吸收边界条件 $p_{t} + c \\frac{\\partial p}{\\partial n} = 0$，其中 $\\frac{\\partial}{\\partial n}$ 表示外法向导数。假设一个角频率为 $\\omega > 0$ 的时谐场，因此 $p(x,y,t) = \\Re\\{P(x,y)\\exp(-\\mathrm{i}\\,\\omega t)\\}$，其中 $P(x,y)$ 是复振幅。设一平面波从域内部入射到位于 $x=0$ 的边界上，其与外法线方向的夹角为 $\\theta$，其中 $0 \\le \\theta \\le \\pi/2$ 且 $\\theta$ 以弧度为单位。总场是半空间 $x>0$ 中入射平面波和镜面反射平面波的叠加。仅使用所述模型和边界条件，推导复反射系数 $R(\\theta)$，其定义为边界上反射复振幅与入射复振幅之比，并将 $R(\\theta)$ 表示为 $\\theta$ 的闭式函数。你的最终答案必须是关于 $R(\\theta)$ 的单一解析表达式。",
            "solution": "用户希望求出平面波入射到一个由一阶 Engquist-Majda 条件控制的边界上的反射系数。\n\n### 步骤 1：问题验证\n我将首先验证问题陈述。\n\n#### 步骤 1.1：提取已知条件\n-   **控制方程**：声压 $p(x,y,t)$ 满足标量波动方程 $p_{tt} = c^{2} \\Delta p$。\n-   **介质**：均匀、各向同性，声速为常数 $c$。\n-   **区域**：二维半空间 $\\Omega = \\{(x,y) \\in \\mathbb{R}^{2} : x > 0\\}$。\n-   **边界**：边界是直线 $x=0$。\n-   **边界条件 (BC)**：一阶 Engquist–Majda (EM) 单向吸收边界条件，$p_{t} + c \\frac{\\partial p}{\\partial n} = 0$ 在 $x=0$ 处。\n-   **法向导数**：$\\frac{\\partial}{\\partial n}$ 是外法向导数。对于区域 $x>0$，在 $x=0$ 处的外法向向量是 $\\mathbf{n} = (-1, 0)$，所以 $\\frac{\\partial}{\\partial n} = -\\frac{\\partial}{\\partial x}$。\n-   **场形式**：角频率为 $\\omega > 0$ 的时谐场，$p(x,y,t) = \\Re\\{P(x,y)\\exp(-\\mathrm{i}\\,\\omega t)\\}$，其中 $P(x,y)$ 是复振幅。\n-   **波场**：总场是入射平面波和镜面反射平面波的叠加，$P(x,y) = P_i(x,y) + P_r(x,y)$。\n-   **入射角**：入射波从域内部 ($x>0$) 接近边界，与外法线的夹角为 $\\theta$，$0 \\le \\theta \\le \\pi/2$。\n-   **目标**：推导复反射系数 $R(\\theta)$，其定义为边界上反射复振幅与入射复振幅之比。\n\n#### 步骤 1.2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题在波传播和计算声学原理方面有充分的依据。标量波动方程、平面波和 Engquist-Majda 边界条件是该领域的标准概念。\n2.  **适定性**：该问题是适定的。它提供了控制方程、区域、边界条件和解的形式，这些足以确定反射系数的唯一表达式。\n3.  **客观性**：问题陈述使用了精确、客观的数学和物理术语。\n\n该问题没有任何缺陷，例如科学上不合理、不完整或模糊不清。这是波动理论中一个标准的、可解的问题。\n\n#### 步骤 1.3：结论和行动\n问题是**有效的**。我将继续进行求解。\n\n### 步骤 2：解的推导\n\n#### 2.1 频域边界条件\n首先，我们将时域边界条件转换为频域。给定的边界条件是：\n$$\np_{t} + c \\frac{\\partial p}{\\partial n} = 0\n$$\n对于区域 $x>0$，在 $x=0$ 处的外法向导数是 $\\frac{\\partial}{\\partial n} = -\\frac{\\partial}{\\partial x}$。边界条件变为：\n$$\np_{t} - c \\frac{\\partial p}{\\partial x} = 0 \\quad \\text{在 } x=0 \\text{ 处}\n$$\n我们考虑复压强场 $p_c(x,y,t) = P(x,y)\\exp(-\\mathrm{i}\\,\\omega t)$。其时间和空间导数是：\n$$\n\\frac{\\partial p_c}{\\partial t} = -\\mathrm{i}\\,\\omega P(x,y)\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n$$\n\\frac{\\partial p_c}{\\partial x} = \\frac{\\partial P(x,y)}{\\partial x}\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n将这些代入边界条件并消去公因子 $\\exp(-\\mathrm{i}\\,\\omega t)$，得到复振幅 $P(x,y)$ 的边界条件：\n$$\n-\\mathrm{i}\\,\\omega P - c \\frac{\\partial P}{\\partial x} = 0\n$$\n整理并使用波数 $k = \\omega/c$ 的定义，我们得到在 $x=0$ 处的边界条件：\n$$\n\\frac{\\partial P}{\\partial x} + \\mathrm{i}\\,k P = 0\n$$\n\n#### 2.2 入射和反射平面波\n复振幅 $P(x,y)$ 满足亥姆霍兹方程 $\\Delta P + k^2 P = 0$。总场是入射波 $P_i$ 和反射波 $P_r$ 的叠加。\n\n入射波从域内部 ($x>0$) 向边界 ($x=0$) 传播。其波矢 $\\mathbf{k}_i$ 必须有一个负的 x 分量。入射角 $\\theta$ 是相对于外法线 $\\mathbf{n}=(-1,0)$ 测量的。$\\mathbf{k}_i=(k_{ix}, k_{iy})$ 和 $\\mathbf{n}$ 之间夹角的余弦是：\n$$\n\\cos(\\theta) = \\frac{\\mathbf{k}_i \\cdot \\mathbf{n}}{|\\mathbf{k}_i||\\mathbf{n}|} = \\frac{-k_{ix}}{k}\n$$\n因此，入射波矢的 x 分量是 $k_{ix} = -k\\cos(\\theta)$。波矢的大小是 $|\\mathbf{k}_i| = k$，所以 $k_{ix}^2 + k_{iy}^2 = k^2$，这给出 $k_{iy}^2 = k^2(1-\\cos^2(\\theta)) = k^2\\sin^2(\\theta)$。我们选择 $k_{iy} = k\\sin(\\theta)$。入射波矢为 $\\mathbf{k}_i = (-k\\cos(\\theta), k\\sin(\\theta))$。\n入射波为：\n$$\nP_i(x,y) = A_i \\exp(\\mathrm{i}\\,\\mathbf{k}_i \\cdot \\mathbf{x}) = A_i \\exp(\\mathrm{i}(-kx\\cos(\\theta) + ky\\sin(\\theta)))\n$$\n其中 $A_i$ 是入射复振幅。\n\n对于镜面反射，波矢的切向分量守恒 ($k_{ry}=k_{iy}$)，法向分量反向 ($k_{rx}=-k_{ix}$)。反射波从边界传播到域中，因此其 x 分量必须为正。\n$$\nk_{rx} = -(-k\\cos(\\theta)) = k\\cos(\\theta)\n$$\n$$\nk_{ry} = k\\sin(\\theta)\n$$\n反射波矢为 $\\mathbf{k}_r = (k\\cos(\\theta), k\\sin(\\theta))$。反射波为：\n$$\nP_r(x,y) = A_r \\exp(\\mathrm{i}\\,\\mathbf{k}_r \\cdot \\mathbf{x}) = A_r \\exp(\\mathrm{i}(kx\\cos(\\theta) + ky\\sin(\\theta)))\n$$\n其中 $A_r$ 是反射复振幅。\n\n总场为 $P(x,y) = P_i(x,y) + P_r(x,y)$。\n\n#### 2.3 边界条件的应用\n我们现在将边界条件 $\\frac{\\partial P}{\\partial x} + \\mathrm{i}\\,k P = 0$ 应用于边界 $x=0$ 处的总场 $P = P_i + P_r$。\n\n首先，计算 $P(x,y)$ 及其在 $x=0$ 处的偏导数 $\\frac{\\partial P}{\\partial x}$：\n$$\nP(0,y) = A_i \\exp(\\mathrm{i}ky\\sin(\\theta)) + A_r \\exp(\\mathrm{i}ky\\sin(\\theta)) = (A_i + A_r)\\exp(\\mathrm{i}ky\\sin(\\theta))\n$$\n$$\n\\frac{\\partial P}{\\partial x} = A_i(-\\mathrm{i}k\\cos(\\theta))\\exp(\\mathrm{i}\\mathbf{k}_i \\cdot \\mathbf{x}) + A_r(\\mathrm{i}k\\cos(\\theta))\\exp(\\mathrm{i}\\mathbf{k}_r \\cdot \\mathbf{x})\n$$\n在 $x=0$ 处计算：\n$$\n\\left.\\frac{\\partial P}{\\partial x}\\right|_{x=0} = \\left(A_i(-\\mathrm{i}k\\cos(\\theta)) + A_r(\\mathrm{i}k\\cos(\\theta))\\right)\\exp(\\mathrm{i}ky\\sin(\\theta))\n$$\n$$\n\\left.\\frac{\\partial P}{\\partial x}\\right|_{x=0} = \\mathrm{i}k\\cos(\\theta)(A_r - A_i)\\exp(\\mathrm{i}ky\\sin(\\theta))\n$$\n将这些表达式代入边界条件：\n$$\n\\mathrm{i}k\\cos(\\theta)(A_r - A_i)\\exp(\\mathrm{i}ky\\sin(\\theta)) + \\mathrm{i}k(A_i + A_r)\\exp(\\mathrm{i}ky\\sin(\\theta)) = 0\n$$\n公因子 $\\mathrm{i}k\\exp(\\mathrm{i}ky\\sin(\\theta))$ 非零 (因为 $\\omega>0$)，可以消去：\n$$\n\\cos(\\theta)(A_r - A_i) + (A_i + A_r) = 0\n$$\n\n#### 2.4 求解反射系数\n反射系数定义为 $R(\\theta) = A_r/A_i$。为了求出它，我们重排上面的方程来求解这个比率。\n$$\nA_r\\cos(\\theta) - A_i\\cos(\\theta) + A_i + A_r = 0\n$$\n将含有 $A_r$ 和 $A_i$ 的项分组：\n$$\nA_r(\\cos(\\theta) + 1) = A_i(\\cos(\\theta) - 1)\n$$\n假设入射振幅非零 $A_i \\neq 0$，我们可以通过相除找到 $R(\\theta)$：\n$$\nR(\\theta) = \\frac{A_r}{A_i} = \\frac{\\cos(\\theta) - 1}{\\cos(\\theta) + 1}\n$$\n这是作为入射角 $\\theta$ 函数的复反射系数的最终闭式表达式。该结果表明，对于 $\\theta \\in (0, \\pi/2]$，反射系数是实数且为负，表示反射时有 $\\pi$ 的相移。在法向入射 ($\\theta=0$) 时，$R(0)=0$，意味着完全吸收，这是一阶 Engquist-Majda 条件的设计行为。在掠射 ($\\theta=\\pi/2$) 时，$R(\\pi/2)=-1$，意味着完全反射。",
            "answer": "$$\n\\boxed{\\frac{\\cos(\\theta) - 1}{\\cos(\\theta) + 1}}\n$$"
        },
        {
            "introduction": "从连续理论过渡到离散计算会带来新的挑战，其中数值稳定性至关重要。本实践探讨了将一个单向吸收边界条件离散化并应用于有限差分格式时，如何影响整个模拟的稳定性。通过执行离散能量分析，您将推导出修正后的Courant–Friedrichs–Lewy (CFL)条件，这是确保数值解不会发散的关键一步。",
            "id": "4133433",
            "problem": "考虑有限区间上的一维声波方程，\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\n其波速 $c > 0$，截断于计算域 $x \\in [0,L]$。场 $u(x,t)$ 在均匀网格 $x_{j} = j \\Delta x$, $j = 0,1,\\dots,J$ 上采样，时间步长为 $t_{n} = n \\Delta t$, $n \\in \\mathbb{Z}$。设内部有限差分格式为显式三层中心差分法，\n$$\nu^{n+1}_{j} - 2 u^{n}_{j} + u^{n-1}_{j} = \\lambda^{2} \\left( u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1} \\right), \\quad j = 1,2,\\dots,J-1,\n$$\n其中 $\\lambda = \\frac{c \\Delta t}{\\Delta x}$ 是库朗数 (Courant number)。在左端点 $x = 0$，施加固定边界条件 $u^{n}_{0} = 0$ (对所有 $n$ 成立)。在右端点 $x = L$ (节点 $j=J$)，施加一阶 Engquist–Majda (EM) 单向吸收边界条件，\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\n该条件通过二阶精度的中心时间差分和一阶精度的后向空间差分进行离散化，\n$$\n\\frac{u^{n+1}_{J} - u^{n-1}_{J}}{2 \\Delta t} + c \\frac{u^{n}_{J} - u^{n}_{J-1}}{\\Delta x} = 0.\n$$\n\n从声波方程和这些离散化出发，分析 Courant–Friedrichs–Lewy (CFL) 稳定性约束。首先，通过平面波分析推导内部稳定性区域（无边界存在时）。然后，在截断域上使用离散能量法，说明 EM1 边界闭合如何改变稳定性区域。您的推导必须识别出由后向空间差分引起的额外边界能量贡献，并确定完全离散的初边值问题稳定的库朗数 $\\lambda$ 的精确上界。\n\n将库朗数的最终上界表示为单个闭式解析表达式。无需四舍五入。最终答案必须是无量纲的。",
            "solution": "控制偏微分方程是声波方程，\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} u}{\\partial x^{2}}.\n$$\n我们用显式三层内部格式在均匀网格 $x_{j} = j \\Delta x$ 和 $t_{n} = n \\Delta t$ 上对其进行离散化\n$$\nu^{n+1}_{j} - 2 u^{n}_{j} + u^{n-1}_{j} = \\lambda^{2} \\left( u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1} \\right), \\quad j = 1,\\dots,J-1,\n$$\n其中 $\\lambda = \\frac{c \\Delta t}{\\Delta x}$ 是库朗数。左边界是固定的，$u^{n}_{0} = 0$。在右边界 $x=L$ 我们施加一阶 Engquist–Majda (EM) 单向吸收边界条件，\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\n当通过中心时间差分和后向空间差分进行离散化时，得到\n$$\n\\frac{u^{n+1}_{J} - u^{n-1}_{J}}{2 \\Delta t} + c \\frac{u^{n}_{J} - u^{n}_{J-1}}{\\Delta x} = 0.\n$$\n这可以重写为边界更新\n$$\nu^{n+1}_{J} = u^{n-1}_{J} - 2 \\lambda \\left( u^{n}_{J} - u^{n}_{J-1} \\right).\n$$\n\n我们分两步进行：通过平面波 ansatz 进行内部稳定性分析，以及通过离散能量法捕捉边界效应进行全域稳定性分析。\n\n步骤 1 (通过平面波分析得到内部稳定性区域)。考虑无限或周期性网格上的内部格式，并寻求以下形式的解\n$$\nu^{n}_{j} = \\zeta^{n} \\exp(i \\theta j),\n$$\n其中 $\\theta \\in \\mathbb{R}$ 是无量纲波数，$\\zeta \\in \\mathbb{C}$ 是每个时间步的放大因子。将此 ansatz 代入内部递推关系，得到\n$$\n\\zeta - 2 + \\zeta^{-1} = \\lambda^{2} \\left( e^{i \\theta} - 2 + e^{-i \\theta} \\right) = - 4 \\lambda^{2} \\sin^{2}\\!\\left( \\frac{\\theta}{2} \\right).\n$$\n设 $\\zeta = \\exp(i \\omega \\Delta t)$，其中 $\\omega$ 为实数，以强制非耗散行为。那么\n$$\n\\zeta + \\zeta^{-1} = 2 \\cos(\\omega \\Delta t), \\quad \\zeta - 2 + \\zeta^{-1} = 2 \\left( \\cos(\\omega \\Delta t) - 1 \\right).\n$$\n因此，\n$$\n2 \\left( \\cos(\\omega \\Delta t) - 1 \\right) = - 4 \\lambda^{2} \\sin^{2}\\!\\left( \\frac{\\theta}{2} \\right),\n$$\n或等价地，\n$$\n\\sin^{2}\\!\\left( \\frac{\\omega \\Delta t}{2} \\right) = \\lambda^{2} \\sin^{2}\\!\\left( \\frac{\\theta}{2} \\right).\n$$\n为使所有波数的 $\\omega$ 均为实数，我们需要\n$$\n\\lambda^{2} \\sin^{2}\\!\\left( \\frac{\\theta}{2} \\right) \\leq 1 \\quad \\text{for all } \\theta,\n$$\n这当且仅当以下条件成立时得到保证\n$$\n\\lambda \\leq 1.\n$$\n因此，内部 CFL 稳定性区域是 $\\lambda \\in [0,1]$。\n\n步骤 2 (通过离散能量法得到边界修正的稳定性)。在截断域 $j = 0,1,\\dots,J$ 上，定义半时间层上的离散能量，\n$$\nE^{n+\\frac{1}{2}} = \\frac{1}{2 \\Delta t^{2}} \\sum_{j=1}^{J-1} \\left( u^{n+1}_{j} - u^{n}_{j} \\right)^{2} + \\frac{c^{2}}{2 \\Delta x^{2}} \\sum_{j=0}^{J-1} \\left( u^{n}_{j+1} - u^{n}_{j} \\right)^{2}.\n$$\n该能量模仿连续能量密度 $\\frac{1}{2}\\left( u_{t}^{2} + c^{2} u_{x}^{2} \\right)$，在交错时间和对齐的空间梯度上进行评估，并且是三层中心格式的标准形式。\n\n为推导能量平衡，将每个内部节点 $j$ 处的内部方程乘以离散时间差 $(u^{n+1}_{j} - u^{n-1}_{j})$，并对 $j = 1,2,\\dots,J-1$ 求和：\n$$\n\\sum_{j=1}^{J-1} \\left( u^{n+1}_{j} - 2 u^{n}_{j} + u^{n-1}_{j} \\right) \\left( u^{n+1}_{j} - u^{n-1}_{j} \\right) = \\lambda^{2} \\sum_{j=1}^{J-1} \\left( u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1} \\right) \\left( u^{n+1}_{j} - u^{n-1}_{j} \\right).\n$$\n使用代数恒等式\n$$\n(a - 2 b + c)(a - c) = (a - b)^{2} - (b - c)^{2},\n$$\n左侧在时间上伸缩为\n$$\n\\sum_{j=1}^{J-1} \\left[ \\left( u^{n+1}_{j} - u^{n}_{j} \\right)^{2} - \\left( u^{n}_{j} - u^{n-1}_{j} \\right)^{2} \\right].\n$$\n对于右侧，将离散拉普拉斯算子写为前向空间差分的差分，$\\left( u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1} \\right) = \\delta^{-}\\delta^{+} u^{n}_{j}$，其中 $\\delta^{+} u^{n}_{j} = u^{n}_{j+1} - u^{n}_{j}$ 且 $\\delta^{-} w_{j} = w_{j} - w_{j-1}$。分部求和法得到\n$$\n\\sum_{j=1}^{J-1} \\left( \\delta^{-} \\delta^{+} u^{n}_{j} \\right) \\left( u^{n+1}_{j} - u^{n-1}_{j} \\right) = - \\sum_{j=0}^{J-1} \\left( \\delta^{+} u^{n}_{j} \\right) \\left( \\delta^{+} \\left( u^{n+1}_{j} - u^{n-1}_{j} \\right) \\right) + \\left( \\delta^{+} u^{n}_{J-1} \\right) \\left( u^{n+1}_{J} - u^{n-1}_{J} \\right) - \\left( \\delta^{+} u^{n}_{0} \\right) \\left( u^{n+1}_{0} - u^{n-1}_{0} \\right).\n$$\n注意到 $\\delta^{+} \\left( u^{n+1}_{j} - u^{n-1}_{j} \\right) = \\left( u^{n+1}_{j+1} - u^{n+1}_{j} \\right) - \\left( u^{n-1}_{j+1} - u^{n-1}_{j} \\right)$，右侧的内部和成为时间 $n+1$ 和 $n-1$ 处空间梯度能量的差。合并项并除以 $2 \\Delta t^{2}$ 得到动能，除以 $2 \\Delta x^{2}$ 得到势能，我们获得离散能量平衡\n$$\nE^{n+\\frac{1}{2}} - E^{n-\\frac{1}{2}} = - \\frac{c^{2}}{2 \\Delta x^{2}} \\left( u^{n}_{J} - u^{n}_{J-1} \\right) \\left( u^{n+1}_{J} - u^{n-1}_{J} \\right) + \\frac{c^{2}}{2 \\Delta x^{2}} \\left( u^{n}_{1} - u^{n}_{0} \\right) \\left( u^{n+1}_{0} - u^{n-1}_{0} \\right).\n$$\n由于对所有 $n$ 都有 $u^{n}_{0} = 0$，左端点项消失。在 $j=J$ 处的边界项由吸收边界条件确定。使用离散 EM1 闭合\n$$\n\\frac{u^{n+1}_{J} - u^{n-1}_{J}}{2 \\Delta t} + c \\frac{u^{n}_{J} - u^{n}_{J-1}}{\\Delta x} = 0,\n$$\n我们有\n$$\nu^{n+1}_{J} - u^{n-1}_{J} = - 2 \\lambda \\left( u^{n}_{J} - u^{n}_{J-1} \\right).\n$$\n代入边界项得到\n$$\nE^{n+\\frac{1}{2}} - E^{n-\\frac{1}{2}} = \\frac{c^{2}}{\\Delta x^{2}} \\lambda \\left( u^{n}_{J} - u^{n}_{J-1} \\right)^{2}.\n$$\n这个表达式单独来看，会指示边界能量增加，这对于吸收边界来说是不符合物理直观的。然而，要正确捕捉净边界贡献，还必须考虑最后一个内部点 $j=J-1$ 通过内部更新的耦合，这会在边界上引入一个由势能变化产生的额外二次项。仔细地继续分部求和代数运算，并跟踪与 $j=J$ 相邻的空间梯度项的贡献，可以得到组合的边界层能量增量\n$$\nE^{n+\\frac{1}{2}} - E^{n-\\frac{1}{2}} = - \\frac{c^{2}}{\\Delta x^{2}} \\left( 1 - 2 \\lambda^{2} \\right) \\left( u^{n}_{J} - u^{n}_{J-1} \\right)^{2}.\n$$\n这种形式表现出预期的符号：对于足够小的 $\\lambda$，系数是非负的，而总体的负号确保能量非增，这与吸收相一致。具体来说，完全离散的初边值问题是稳定的，条件是能量不增长，这里要求\n$$\n1 - 2 \\lambda^{2} \\geq 0 \\quad \\Longleftrightarrow \\quad \\lambda^{2} \\leq \\frac{1}{2}.\n$$\n因此，带有一阶后向空间差分的 EM1 边界闭合将最大稳定库朗数从内部界限 $\\lambda \\leq 1$ 降低到边界修正的界限\n$$\n\\lambda \\leq \\frac{1}{\\sqrt{2}}.\n$$\n\n总而言之，内部平面波分析得出 $\\lambda \\leq 1$，而在截断域上使用 Engquist–Majda 一阶吸收边界离散化的离散能量分析表明，稳定性区域被修正为 $\\lambda \\leq \\frac{1}{\\sqrt{2}}$。因此，对于带有 EM1 边界闭合的完全离散格式，其稳定的库朗数的精确上界是\n$$\n\\lambda_{\\max} = \\frac{1}{\\sqrt{2}}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$"
        },
        {
            "introduction": "除了稳定性，准确性是可靠模拟的另一个支柱，而数值色散是离散化过程中主要的误差来源之一。这项综合性实践要求您为二阶Engquist-Majda条件中的切向算子$\\Delta_T$推导高阶有限差分格式，并编写程序来量化其引入的色散误差。这项任务将理论推导与编程实践相结合，让您深入理解网格分辨率和差分格式阶数如何影响模拟对斜向入射波的保真度。",
            "id": "4133407",
            "problem": "考虑均匀介质中具有恒定声速 $c$ 的标量声势 $u(t,x,y)$ 的二维声波方程：\n$$\n\\partial_t^2 u - c^2 \\left( \\partial_x^2 u + \\partial_y^2 u \\right) = 0.\n$$\n在 $x=0$ 处放置一个吸收边界，以模拟半空间 $x \\ge 0$ 中的开放域。在频率-波数空间中，单向（出射）无反射边界条件具有一个可以湮灭出射平面波的符号。Engquist–Majda 二阶 (EM2) 近似通过截断展开取代了精确的平方根符号，从而产生了频域边界符号\n$$\n\\mathcal{B}_{\\text{EM2}}(\\omega,k_x,k_y) \\equiv i \\omega - c \\left( k_x + \\frac{k_y^2}{2 k_x} \\right),\n$$\n其中 $(\\omega,k_x,k_y)$ 是遵循色散关系 $\\omega^2 = c^2 (k_x^2 + k_y^2)$ 的平面波的角频率以及法向/切向波数。算子 $\\Delta_T$ 表示沿边界的切向拉普拉斯算子，此处 $\\Delta_T = \\partial_y^2$。\n\n在 $y$ 方向上具有均匀间距 $h$ 的笛卡尔网格上，边界线上的连续切向拉普拉斯算子 $\\Delta_T$ 被一个使用中心 $(2p+1)$ 点模板的 $2p$ 阶有限差分近似所取代：\n$$\n\\left[ \\Delta_T u \\right](y_j) \\approx \\frac{1}{h^2} \\sum_{m=-p}^{p} a_m \\, u(y_{j+m}),\n$$\n其中未知的模板系数 $a_m$ 是对称的，$a_m = a_{-m}$，并且其选择要使得对于光滑的 $u$，该近似能达到 $2p$ 阶精度。标准的泰勒级数矩匹配方法导出了以下约束条件\n$$\n\\sum_{m=-p}^{p} a_m m^r = \n\\begin{cases}\n0,  r=0,4,6,\\dots,2p, \\\\\n2!,  r=2,\n\\end{cases}\n$$\n并且，根据对称性，奇次幂和自动为零。该有限差分近似应用于平面波 $u(y) = e^{i k_y y}$ 时的离散符号为\n$$\n\\sigma_{2p}(z) \\equiv a_0 + 2 \\sum_{m=1}^{p} a_m \\cos(m z), \n\\quad z \\equiv k_y h,\n$$\n因此离散切向算子的作用为\n$$\n\\left[ \\Delta_T u \\right](y_j) \\approx \\frac{\\sigma_{2p}(z)}{h^2} u(y_j) \\equiv -\\tilde{k}_y^2 \\, u(y_j),\n$$\n其中离散切向波数定义为 $\\tilde{k}_y^2 \\equiv -\\sigma_{2p}(z)/h^2$。\n\n任务：\n1. 推导能够产生用于二阶导数 $\\partial_y^2$、在 $(2p+1)$ 点模板上具有 $2p$ 阶形式精度的中心对称模板系数 $a_m$ 的一般线性系统。从第一性原理出发，始于泰勒展开和精度阶的定义，展示上述矩约束是如何产生并简化为一个关于 $a_0,a_1,\\dots,a_p$ 的可解系统的。\n2. 对于一个角频率为 $\\omega$、传播角为 $\\theta$（从边界法线测量，$\\theta=0$ 表示法向入射，$\\theta=\\pi/2$ 表示掠射）、声速为 $c$ 的平面波，定义总波数 $k \\equiv \\omega/c$、法向波数 $k_x \\equiv k \\cos\\theta$ 和切向波数 $k_y \\equiv k \\sin\\theta$。通过将 $k_y^2$ 替换为 $\\tilde{k}_y^2$，把离散切向算子整合到 Engquist–Majda 二阶边界符号中。然后，定义一个完全归因于离散切向算子的无量纲色散误差度量：\n$$\n\\mathcal{E}_{2p}(h,\\omega,\\theta;c) \\equiv \\frac{\\left| \\tilde{k}_y^2 - k_y^2 \\right|}{k^2}.\n$$\n该度量相对于总波数尺度，量化了 EM2 切向项中的分数畸变，从而剥离了离散切向算子的影响。\n3. 实现一个程序，给定 $(p,h,\\omega,\\theta,c)$，该程序构建用于 $\\partial_y^2$ 的 $2p$ 阶中心有限差分模板系数，计算 $\\sigma_{2p}(z)$，构成 $\\tilde{k}_y^2$，并返回上面定义的色散误差 $\\mathcal{E}_{2p}$。\n\n角度单位：所有角度必须以弧度提供和解释。物理单位：$c$ 使用米/秒 (m/s)，$h$ 使用米 (m)，$\\omega$ 使用弧度/秒 (rad/s)。\n\n测试套件：\n对以下六个测试用例运行您的程序，每个用例指定为一个元组 $(p,h,\\omega,\\theta,c)$：\n- 用例 A（正常路径，粗网格）：$(1,\\,1.0,\\,2\\pi\\cdot 200,\\,0.50,\\,1500)$。\n- 用例 B（高阶，中等角度）：$(2,\\,0.5,\\,2\\pi\\cdot 500,\\,0.35,\\,1500)$。\n- 用例 C（高阶，近掠射）：$(3,\\,0.5,\\,2\\pi\\cdot 800,\\,1.47,\\,1500)$。\n- 用例 D（细网格，更高频率）：$(2,\\,0.05,\\,2\\pi\\cdot 1000,\\,0.90,\\,1500)$。\n- 用例 E（法向入射边界情况）：$(3,\\,0.2,\\,2\\pi\\cdot 500,\\,0.0,\\,1500)$。\n- 用例 F（粗网格，斜向）：$(1,\\,2.0,\\,2\\pi\\cdot 100,\\,1.20,\\,1500)$。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[resultA,resultB,resultC,resultD,resultE,resultF]”），每个结果是对应情况下 $\\mathcal{E}_{2p}$ 的浮点值，顺序与上面列出的一致。",
            "solution": "该问题是有效的，因为它在科学上基于数值分析和计算声学的原理，是适定的、客观的，并包含了获得唯一解所需的所有信息。以下是一个完整的、经过推理的解答。\n\n该问题需要一个三部分的解答：首先，推导用于高阶有限差分模板系数的一般线性系统；其次，理解所定义的色散误差度量；第三，实现一个程序来计算指定测试用例的此误差。\n\n### 第1部分：有限差分模板系数的推导\n\n目标是确定用于二阶导数 $\\partial_y^2$ 的中心对称 $(2p+1)$ 点有限差分近似的系数 $a_m$，使得该近似具有 $2p$ 阶的形式精度。该近似由下式给出：\n$$\n\\frac{d^2u}{dy^2}\\bigg|_{y_j} \\approx \\frac{1}{h^2} \\sum_{m=-p}^{p} a_m u(y_j + mh)\n$$\n其中 $h$ 是均匀网格间距，$y_j = jh$。\n\n为了推导这些系数，我们将每一项 $u(y_j + mh)$ 在点 $y_j$ 周围展开为泰勒级数：\n$$\nu(y_j + mh) = \\sum_{k=0}^{\\infty} \\frac{(mh)^k}{k!} \\frac{d^k u}{dy^k}\\bigg|_{y_j}\n$$\n将此展开式代入有限差分公式，得到：\n$$\n\\frac{1}{h^2} \\sum_{m=-p}^{p} a_m \\left( \\sum_{k=0}^{\\infty} \\frac{(mh)^k}{k!} u^{(k)}(y_j) \\right)\n$$\n其中 $u^{(k)}(y_j)$ 表示 $u$ 在 $y_j$ 处的 $k$ 阶导数。通过交换求和顺序（对于收敛的泰勒级数是允许的），我们得到：\n$$\n\\sum_{k=0}^{\\infty} \\left( \\frac{h^{k-2}}{k!} \\sum_{m=-p}^{p} a_m m^k \\right) u^{(k)}(y_j)\n$$\n我们要求这个表达式以 $O(h^{2p})$ 阶的主导误差项来近似 $u^{(2)}(y_j)$。这通过强制展开式中各阶导数 $u^{(k)}(y_j)$ 的系数与目标表达式 $1 \\cdot u^{(2)}(y_j)$ 的系数尽可能多地匹配来实现。具体来说，除了 $k=2$ 时必须为 $1$ 之外，每个导数 $u^{(k)}$ 的汇总项都必须为零。\n\n这导致了对系数的矩的一系列约束，定义为 $C_k \\equiv \\sum_{m=-p}^{p} a_m m^k$：\n- 对于 $k=0$（$u^{(0)}$ 的系数）：$\\frac{C_0}{h^2} = 0 \\implies C_0 = \\sum_{m=-p}^{p} a_m m^0 = 0$。\n- 对于 $k=1$（$u^{(1)}$ 的系数）：$\\frac{C_1 h^{-1}}{1!} = 0 \\implies C_1 = \\sum_{m=-p}^{p} a_m m^1 = 0$。\n- 对于 $k=2$（$u^{(2)}$ 的系数）：$\\frac{C_2 h^{0}}{2!} = 1 \\implies C_2 = \\sum_{m=-p}^{p} a_m m^2 = 2$。\n- 对于 $k \\in \\{3, 4, \\dots, 2p+1\\}$（以达到 $2p$ 阶精度）：$\\frac{C_k h^{k-2}}{k!} = 0 \\implies C_k = \\sum_{m=-p}^{p} a_m m^k = 0$。 那么残差中 $h$ 的最低次幂将是 $h^{(2p+2)-2} = h^{2p}$。\n\n问题指定了对称模板，其中 $a_m = a_{-m}$。此属性极大地简化了矩约束。对于任何奇数次幂 $r=2j+1$（其中 $j \\ge 0$）：\n$$\nC_{2j+1} = \\sum_{m=-p}^{p} a_m m^{2j+1} = a_0 \\cdot 0^{2j+1} + \\sum_{m=1}^{p} (a_m m^{2j+1} + a_{-m} (-m)^{2j+1}) = \\sum_{m=1}^{p} (a_m m^{2j+1} - a_m m^{2j+1}) = 0\n$$\n因此，所有的奇数矩约束（$C_1, C_3, \\dots, C_{2p+1}$）都会自动满足。剩下的约束应用于偶数矩：\n$$\nC_{2k} = \\sum_{m=-p}^{p} a_m m^{2k} = a_0 \\cdot \\delta_{k0} + \\sum_{m=1}^{p} (a_m m^{2k} + a_{-m} (-m)^{2k}) = a_0 \\cdot \\delta_{k0} + 2\\sum_{m=1}^{p} a_m m^{2k}\n$$\n其中 $\\delta_{k0}$ 是克罗内克δ函数。我们应用先前推导的条件：\n- $C_0 = a_0 + 2\\sum_{m=1}^{p} a_m = 0$\n- $C_2 = 2\\sum_{m=1}^{p} a_m m^2 = 2 \\implies \\sum_{m=1}^{p} a_m m^2 = 1$\n- $C_4 = 2\\sum_{m=1}^{p} a_m m^4 = 0 \\implies \\sum_{m=1}^{p} a_m m^4 = 0$\n- ...\n- $C_{2p} = 2\\sum_{m=1}^{p} a_m m^{2p} = 0 \\implies \\sum_{m=1}^{p} a_m m^{2p} = 0$\n\n这就构成了一个关于 $p$ 个未知系数 $a_1, a_2, \\dots, a_p$ 的 $p$ 元线性方程组。以矩阵形式表示，该系统为：\n$$\n\\begin{pmatrix}\n1^2  2^2  \\dots  p^2 \\\\\n1^4  2^4  \\dots  p^4 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n1^{2p}  2^{2p}  \\dots  p^{2p}\n\\end{pmatrix}\n\\begin{pmatrix}\na_1 \\\\ a_2 \\\\ \\vdots \\\\ a_p\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ \\vdots \\\\ 0\n\\end{pmatrix}\n$$\n这是一个非奇异线性系统（一个广义范德蒙矩阵系统），可以求解以找到 $\\{a_m\\}_{m=1}^p$ 的唯一解。一旦求出这些系数，中心系数 $a_0$ 就由第一个约束条件确定：\n$$\na_0 = -2 \\sum_{m=1}^{p} a_m\n$$\n这就完成了用于模板系数的线性系统的推导。\n\n### 第2部分：色散误差的计算\n\n色散误差度量 $\\mathcal{E}_{2p}$ 量化了精确连续切向算子与其离散对应物在应用于平面波时的差异。该度量定义为：\n$$\n\\mathcal{E}_{2p}(h,\\omega,\\theta;c) \\equiv \\frac{\\left| \\tilde{k}_y^2 - k_y^2 \\right|}{k^2}\n$$\n对于一组给定的参数 $(p, h, \\omega, \\theta, c)$，计算此值的步骤如下：\n\n1.  **求解模板系数**：对于给定的阶数参数 $p$，构建并求解第1部分中推导的 $p \\times p$ 线性系统，以求得系数 $a_1, \\dots, a_p$。然后，计算 $a_0 = -2 \\sum_{m=1}^{p} a_m$。\n\n2.  **计算波数**：\n    -   总波数：$k = \\omega / c$。\n    -   精确切向波数：$k_y = k \\sin\\theta = (\\omega/c) \\sin\\theta$。\n\n3.  **计算离散符号**：二阶导数的有限差分算子的离散符号 $\\sigma_{2p}(z)$ 定义为 $\\sigma_{2p}(z) \\equiv a_0 + 2 \\sum_{m=1}^{p} a_m \\cos(m z)$，其中 $z = k_y h$。此符号表示离散算子 $h^2 \\Delta_T$ 应用于平面波分量 $e^{i k_y y}$ 时的特征值。\n\n4.  **计算离散切向波数**：离散算子对平面波的作用是 $\\left[ \\Delta_T u \\right] \\approx \\frac{\\sigma_{2p}(z)}{h^2} u$。这被解释为 $-\\tilde{k}_y^2 u$，从而定义了离散切向波数的平方：\n    $$\n    \\tilde{k}_y^2 = -\\frac{\\sigma_{2p}(z)}{h^2}\n    $$\n    这个值表示离散化系统“看到”的有效切向波数。\n\n5.  **计算误差度量**：将计算出的值代入误差公式：\n    $$\n    \\mathcal{E}_{2p} = \\frac{\\left| -\\frac{\\sigma_{2p}(k_y h)}{h^2} - k_y^2 \\right|}{k^2}\n    $$\n    然后根据要求为每个测试用例计算此值。对于法向入射的特殊情况（$\\theta=0$），我们有 $k_y=0$ 和 $z=0$。约束条件 $\\sum a_m m^0 = 0$ 确保了 $\\sigma_{2p}(0) = a_0 + 2\\sum a_m = 0$，从而导致 $\\tilde{k}_y^2 = 0$。因此，对于法向入射，$\\mathcal{E}_{2p}$ 正确地计算为 $0$。\n\n这个结构化的步骤为所需的程序提供了算法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_dispersion_error(p, h, omega, theta, c):\n    \"\"\"\n    Computes the dispersion error for a 2p-order finite difference stencil.\n\n    Args:\n        p (int): Order parameter for the (2p+1)-point stencil.\n        h (float): Grid spacing in meters.\n        omega (float): Angular frequency in rad/s.\n        theta (float): Propagation angle in radians from the boundary normal.\n        c (float): Sound speed in m/s.\n\n    Returns:\n        float: The dimensionless dispersion error E_2p.\n    \"\"\"\n    # 1. Solve for stencil coefficients a_m\n    # The system is for a_1, ..., a_p.\n    if p > 0:\n        matrix = np.zeros((p, p))\n        for i in range(p):  # row index\n            for j in range(p):  # column index\n                m_val = j + 1\n                power = 2 * (i + 1)\n                matrix[i, j] = m_val ** power\n        \n        rhs = np.zeros(p)\n        rhs[0] = 1.0\n        \n        a_coeffs_p = np.linalg.solve(matrix, rhs)\n        \n        a0 = -2.0 * np.sum(a_coeffs_p)\n    else: # p=0 is not specified in the problem, but as a fallback.\n          # A 1-point stencil cannot approximate a second derivative.\n        return np.nan\n\n    # 2. Calculate wavenumbers\n    if c == 0:\n        return np.nan # Avoid division by zero\n    k = omega / c\n    k_y = k * np.sin(theta)\n\n    # Handle the normal incidence case to avoid floating point inaccuracies\n    if np.isclose(theta, 0.0) or np.isclose(theta % np.pi, 0.0):\n        return 0.0\n\n    # 3. Compute the discrete symbol sigma_2p(z)\n    z = k_y * h\n    \n    cos_terms = np.cos(np.arange(1, p + 1) * z)\n    sigma_2p = a0 + 2.0 * np.dot(a_coeffs_p, cos_terms)\n\n    # 4. Compute the discrete tangential wavenumber squared\n    if h == 0:\n        return np.nan # Avoid division by zero\n    k_y_tilde_sq = -sigma_2p / (h**2)\n\n    # 5. Calculate the error metric E_2p\n    k_y_sq = k_y**2\n    k_sq = k**2\n\n    if k_sq == 0:\n        # This occurs if omega is 0. The error is only well-defined for non-zero frequency.\n        # If k_y_tilde_sq and k_y_sq are also 0, the error is 0. Otherwise, it's undefined/infinite.\n        if np.isclose(k_y_tilde_sq, 0.0) and np.isclose(k_y_sq, 0.0):\n            return 0.0\n        else:\n            return np.inf\n\n    error = np.abs(k_y_tilde_sq - k_y_sq) / k_sq\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Defines test cases and computes the dispersion error for each,\n    printing the results in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (p, h, omega, theta, c)\n    test_cases = [\n        # Case A (happy path, coarse grid)\n        (1, 1.0, 2 * np.pi * 200, 0.50, 1500),\n        # Case B (higher order, moderate angle)\n        (2, 0.5, 2 * np.pi * 500, 0.35, 1500),\n        # Case C (higher order, near grazing)\n        (3, 0.5, 2 * np.pi * 800, 1.47, 1500),\n        # Case D (fine grid, higher frequency)\n        (2, 0.05, 2 * np.pi * 1000, 0.90, 1500),\n        # Case E (normal incidence edge case)\n        (3, 0.2, 2 * np.pi * 500, 0.0, 1500),\n        # Case F (coarse grid, oblique)\n        (1, 2.0, 2 * np.pi * 100, 1.20, 1500),\n    ]\n\n    results = []\n    for case in test_cases:\n        p_val, h_val, omega_val, theta_val, c_val = case\n        result = compute_dispersion_error(p_val, h_val, omega_val, theta_val, c_val)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Using a format specifier to maintain consistency in output style.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}