{
    "hands_on_practices": [
        {
            "introduction": "第一个实践将深入探讨完美匹配层（PML）理论的核心。你将推导一个斜向入射的平面波在PML界面处的反射系数$R$。通过这个练习，你将亲自证明在适当的设计下，反射系数$R$为何为零，从而深刻理解其“完美匹配”名称的由来，并为后续更复杂的应用打下坚实的理论基础。",
            "id": "4133649",
            "problem": "考虑在密度为 $\\rho_0$、体积模量为 $K$ 的均匀、无粘性流体中的线性声波传播。假设时间谐波依赖关系因子为 $\\exp(-i \\omega t)$，角频率为 $\\omega$，声速 $c$ 满足 $c^2 = K/\\rho_0$。\n\n一个二维斜平面波，其压力为 $p^{\\text{inc}}(x,y) = p_0 \\exp\\!\\big(i k_x x + i k_y y\\big)$，从半空间 $x  0$ 入射到位于 $x = 0$ 的平面界面上。波数满足 $k_x = k \\cos \\theta$、$k_y = k \\sin \\theta$ 和 $k = \\omega/c$，其中入射角 $\\theta \\in (0,\\pi/2)$ 是一个固定值。半空间 $x \\ge 0$ 被一个完美匹配层（PML）占据，该层通过复坐标拉伸的分裂场公式实现，其中空间导数被修改为 $\\partial_x \\mapsto \\frac{1}{s_x(x)} \\partial_x$ 和 $\\partial_y \\mapsto \\frac{1}{s_y(y)} \\partial_y$。拉伸因子为 $s_x(x) = 1 + i\\sigma_x(x)/\\omega$ 和 $s_y(y) = 1 + i\\sigma_y(y)/\\omega$，其中 $\\sigma_x$ 和 $\\sigma_y$ 分别是 $x \\ge 0$ 和 $y \\in \\mathbb{R}$ 上的分段常数函数。在物理半空间 $x  0$ 中，$s_x = s_y = 1$。假设设计确保 $s_y(0^+) = 1$，以便在入口界面处不施加切向拉伸，而允许 $s_x(0^+) \\neq 1$。\n\n从线性化声学方程和上述PML修改出发，推导反射系数 $R$，其定义为在界面 $x = 0$ 处，给定斜入射条件下，反射压力与入射压力的复振幅比 $R = p^{\\text{ref}}(0,y)/p^{\\text{inc}}(0,y)$。您的推导必须从动量和连续性方程出发，施加适当的边界连续性条件，并确定PML介质中与修正色散关系一致的透射波。将 $R$ 表示为 $\\rho_0$、$K$、$\\omega$、$\\theta$ 以及入口值 $s_x(0^+)$ 和 $s_y(0^+)$ 的闭式解析表达式，然后在所述入口条件 $s_y(0^+) = 1$ 下进行简化，以得出最终答案。最后，利用您推导出的表达式论证，在任何容许的连续剖面 $\\sigma_x(x)$ 和 $\\sigma_y(y)$ 的分段常数近似的连续极限下， $x=0$ 处的反射系数为零。最终答案必须是 $R$ 的单个闭式表达式。无需四舍五入，答案是无量纲的。",
            "solution": "我们从时间谐波依赖关系 $\\exp(-i \\omega t)$ 下的线性化声学方程开始：\n$$\n-i\\omega \\rho_0 \\mathbf{v} = -\\nabla p, \\qquad -i\\omega p = -K \\nabla \\cdot \\mathbf{v},\n$$\n其中 $p$ 是压力，$\\mathbf{v} = (v_x, v_y)$ 是质点速度。这些方程可以改写为 $i\\omega \\rho_0 \\mathbf{v} = \\nabla p$ 和 $i\\omega p = K \\nabla \\cdot \\mathbf{v}$。在均匀的物理介质中（无PML），平面波 $p = A \\exp\\!\\big(i \\mathbf{k} \\cdot \\mathbf{x}\\big)$ 满足 $\\mathbf{v} = \\frac{\\mathbf{k}}{\\omega \\rho_0}\\, p$ 和色散关系 $|\\mathbf{k}|^2 = \\frac{\\omega^2 \\rho_0}{K} = k^2$。\n\n在分裂场完美匹配层（PML）区域，空间导数被修改为\n$$\n\\partial_x \\mapsto \\frac{1}{s_x(x)} \\partial_x, \\qquad \\partial_y \\mapsto \\frac{1}{s_y(y)} \\partial_y,\n$$\n其中\n$$\ns_x(x) = 1 + \\frac{i\\sigma_x(x)}{\\omega}, \\qquad s_y(y) = 1 + \\frac{i\\sigma_y(y)}{\\omega},\n$$\n$\\sigma_x$ 和 $\\sigma_y$ 是非负的分段常数剖面。在入口界面 $x=0$ 附近，我们允许 $s_x(0^+) \\neq 1$，同时假设 $s_y(0^+) = 1$（界面处无切向拉伸）以确保斜入射匹配。\n\nPML修正的动量和连续性方程（在二维情况下，且 $s_x, s_y$ 局部为分段常数）为\n$$\ni\\omega \\rho_0 v_x = \\frac{1}{s_x}\\, \\partial_x p, \\qquad i\\omega \\rho_0 v_y = \\frac{1}{s_y}\\, \\partial_y p,\n$$\n$$\ni\\omega p = K \\left( \\frac{1}{s_x}\\, \\partial_x v_x + \\frac{1}{s_y}\\, \\partial_y v_y \\right).\n$$\n我们考虑PML中的透射平面波，其形式为 $p^{\\text{tr}}(x,y) = T \\exp\\!\\big(i k_x^{\\text{tr}} x + i k_y y\\big)$，其中切向分量 $k_y$ 因沿 $y$ 方向的平移不变性而守恒。将PML动量关系应用于此拟设，得到\n$$\nv_x^{\\text{tr}} = \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, p^{\\text{tr}}, \\qquad v_y^{\\text{tr}} = \\frac{k_y}{\\omega \\rho_0 s_y}\\, p^{\\text{tr}}.\n$$\n将它们代入PML连续性方程，并使用 $\\partial_x p^{\\text{tr}} = i k_x^{\\text{tr}} p^{\\text{tr}}$ 和 $\\partial_y p^{\\text{tr}} = i k_y p^{\\text{tr}}$，我们得到PML色散关系\n$$\n\\frac{(k_x^{\\text{tr}})^2}{s_x^2} + \\frac{k_y^2}{s_y^2} = \\frac{\\omega^2 \\rho_0}{K} = k^2.\n$$\n在界面 $x=0$ 处，流体占据 $x0$ 区域，其中 $s_x = s_y = 1$，而PML占据 $x \\ge 0$ 区域，其局部常数为 $s_x(0^+)$ 和 $s_y(0^+)$。$x0$ 区域的入射场和反射场为\n$$\np^{\\text{inc}} = p_0 \\exp\\!\\big(i k_x x + i k_y y\\big), \\qquad p^{\\text{ref}} = R\\, p_0 \\exp\\!\\big(i (-k_x) x + i k_y y\\big),\n$$\n因此在 $x=0$ 处，$p^{\\text{left}}(0,y) = p_0(1+R) \\exp(i k_y y)$。使用物理动量关系，相应的法向质点速度为\n$$\nv_x^{\\text{inc}} = \\frac{k_x}{\\omega \\rho_0}\\, p^{\\text{inc}}, \\qquad v_x^{\\text{ref}} = \\frac{(-k_x)}{\\omega \\rho_0}\\, p^{\\text{ref}} = -\\frac{k_x}{\\omega \\rho_0}\\, p^{\\text{ref}}.\n$$\n因此，在 $x=0$ 处，$x0$ 区域的总法向速度为\n$$\nv_x^{\\text{left}}(0,y) = \\left( \\frac{k_x}{\\omega \\rho_0}\\, p_0 - \\frac{k_x}{\\omega \\rho_0}\\, R p_0 \\right) \\exp(i k_y y) = \\frac{k_x}{\\omega \\rho_0}\\, p_0 (1 - R)\\, \\exp(i k_y y).\n$$\n在PML一侧，$x=0$ 处的透射压力为 $p^{\\text{tr}}(0,y) = T \\exp(i k_y y)$，相应的法向速度为\n$$\nv_x^{\\text{tr}}(0,y) = \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, T \\exp(i k_y y),\n$$\n其中 $s_x = s_x(0^+)$ 且 $s_y = s_y(0^+)$。$x=0$ 处的边界条件是压力和法向速度的连续性：\n$$\np^{\\text{left}}(0,y) = p^{\\text{tr}}(0,y), \\qquad v_x^{\\text{left}}(0,y) = v_x^{\\text{tr}}(0,y).\n$$\n这得出\n$$\np_0 (1 + R) = T, \\qquad \\frac{k_x}{\\omega \\rho_0}\\, p_0 (1 - R) = \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, T.\n$$\n消去 $T$ 并简化，得到关于 $R$ 的关系式：\n$$\nk_x (1 - R) = \\frac{k_x^{\\text{tr}}}{s_x} (1 + R).\n$$\n解出 $R$：\n$$\nR = \\frac{k_x - \\frac{k_x^{\\text{tr}}}{s_x}}{k_x + \\frac{k_x^{\\text{tr}}}{s_x}}.\n$$\n为了完成求解，我们必须根据入口值 $s_x(0^+)$ 和 $s_y(0^+)$ 从PML色散关系中确定 $k_x^{\\text{tr}}$。PML色散关系要求\n$$\n\\frac{(k_x^{\\text{tr}})^2}{s_x^2} + \\frac{k_y^2}{s_y^2} = k^2.\n$$\n在物理介质中，$k_x^2 + k_y^2 = k^2$。因此，如果在入口界面处 $s_y(0^+) = 1$（无切向拉伸），我们有\n$$\n\\frac{(k_x^{\\text{tr}})^2}{s_x^2} + k_y^2 = k^2 \\quad \\Longrightarrow \\quad \\frac{(k_x^{\\text{tr}})^2}{s_x^2} = k^2 - k_y^2 = k_x^2 \\quad \\Longrightarrow \\quad \\frac{k_x^{\\text{tr}}}{s_x} = \\pm k_x.\n$$\n物理上正确的选择是透射波在 $x \\ge 0$ 中向前衰减。波的形式为 $\\exp(i k_x^{\\text{tr}} x)$。为实现衰减，我们需要 $\\mathrm{Im}(k_x^{\\text{tr}}) > 0$。由 $k_x^{\\text{tr}} = s_x (\\pm k_x)$ 和 $s_x = 1 + i\\sigma_x/\\omega$ (其中 $\\sigma_x > 0$)，我们有 $\\mathrm{Im}(s_x) > 0$。选择正号 $+k_x$ 给出 $k_x^{\\text{tr}} = s_x k_x$，其虚部 $\\mathrm{Im}(k_x^{\\text{tr}}) = k_x \\mathrm{Im}(s_x) > 0$，导致衰减。因此，我们必须选择 $\\frac{k_x^{\\text{tr}}}{s_x} = k_x$。将此代入 $R$ 的表达式中，得到\n$$\nR = \\frac{k_x - k_x}{k_x + k_x} = 0.\n$$\n因此，在所述入口条件 $s_y(0^+) = 1$ 下，并且分裂场PML拉伸应用于法线方向，对于所有的 $\\omega$ 和所有斜入射角 $\\theta \\in (0,\\pi/2)$，反射系数都为零：\n$$\nR = 0.\n$$\n最后，考虑PML内部任何容许的连续剖面 $\\sigma_x(x)$ 和 $\\sigma_y(y)$ 的分段常数近似。在 $x=0$ 处的反射仅取决于入口值 $s_x(0^+)$ 和 $s_y(0^+)$。只要入口设计保持 $s_y(0^+) = 1$ 和 $s_x(0^+) = 1 + i\\sigma_x(0^+)/\\omega$，上述匹配条件 $\\frac{k_x^{\\text{tr}}}{s_x} = k_x$ 就精确成立，因此 $R=0$ 与内部分段结构无关。在分段常数剖面收敛到连续的 $\\sigma_x(x)$ 和 $\\sigma_y(y)$ 的连续极限下，入口值保持不变，因此在连续极限下，$x=0$ 处的反射系数恒为零。因此，最终计算出的反射系数为\n$$\nR = 0.\n$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "将连续的理论付诸离散的计算是计算科学中的关键一步。本实践将研究在时域有限差分（FDTD）格式中实现的PML。通过推导网格上的实际数值衰减率$\\alpha_{\\text{num}}$并将其与理想的连续衰减率$\\alpha_{\\text{cont}}$进行比较，你将分析数值离散化如何影响PML的性能，并揭示数值模型中固有的误差和实际限制。",
            "id": "4133742",
            "problem": "考虑在密度 $\\rho$ 和声速 $c$ 恒定的均匀介质中的一维线性声学问题。其控制一阶方程组为\n$$\n\\frac{\\partial p}{\\partial t} = -\\rho c^2 \\frac{\\partial u}{\\partial x},\\qquad\n\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x},\n$$\n其中 $p(x,t)$ 是声压，$u(x,t)$ 是质点速度。为了截断无界域，通过在 $x$ 方向进行复坐标伸展，引入了完美匹配层 (Perfectly Matched Layer, PML)。在频域中，该伸展定义为\n$$\ns_x = 1 + i \\frac{\\sigma}{\\omega},\n$$\n其中 $\\sigma \\ge 0$ 是 PML 阻尼剖面（单位为 $\\mathrm{s}^{-1}$），$\\omega = 2\\pi f$ 是角频率，$i^2 = -1$。假设 PML 在层内是均匀的，$\\sigma$ 为常数。\n\n我们使用交错网格二阶时域有限差分 (Finite-Difference Time-Domain, FDTD) 格式对时域方程进行离散化，其中压力定义在整数空间索引 $i$ 和整数时间步 $n$ 上，速度定义在半整数空间索引 $i+\\tfrac{1}{2}$ 和半整数时间步 $n+\\tfrac{1}{2}$ 上。空间导数使用中心差分进行近似，网格间距为 $\\Delta x$，时间导数以时间步长 $\\Delta t$ 向前推进。在 PML 内部，通过将离散空间差分算子乘以 $1/s_x$ 来实现复数伸展，这应用于两个更新方程。具体来说，对于均匀的 PML 区域，使用以下离散更新方程：\n$$\nu^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} = u^{n-\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} - \\frac{\\Delta t}{\\rho\\, s_x\\, \\Delta x}\\left(p^{n}_{i+1} - p^{n}_{i}\\right),\n$$\n$$\np^{n+1}_{i} = p^{n}_{i} - \\frac{\\rho c^2 \\Delta t}{s_x\\, \\Delta x}\\left(u^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} - u^{n+\\tfrac{1}{2}}_{i-\\tfrac{1}{2}}\\right).\n$$\n假设在均匀 PML 区域内存在形式如下的单色平面波解\n$$\np^{n}_{i} = P\\, e^{i(i\\,\\kappa - n\\,\\Omega)},\\qquad u^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} = U\\, e^{i\\left((i+\\tfrac{1}{2})\\,\\kappa - (n+\\tfrac{1}{2})\\,\\Omega\\right)},\n$$\n其中 $\\kappa$ 是每单元的复离散空间相位（单位为 $\\mathrm{rad}$/单元），$\\Omega = \\omega \\Delta t$ 是离散角频率（单位为弧度），$P,U$ 是复振幅。定义 Courant 数 $S = c\\,\\Delta t/\\Delta x$。\n\n任务 A：从上述离散更新方程和平面波拟设出发，推导一个关联 $\\kappa$、$\\Omega$、$S$ 和 $s_x$ 的离散色散关系。然后，将 PML 内部每单元的数值衰减（记为 $\\alpha_{\\mathrm{num}}$）表示为从 $\\kappa$ 获得的非负量。\n\n任务 B：从连续复伸展模型中，确定 PML 内部每单位长度的连续衰减，然后以奈培/单元为单位，表示相应的每单元连续衰减 $\\alpha_{\\mathrm{cont}}$。\n\n任务 C：实现一个程序，对下面的每个测试用例，计算：\n- 您推导的离散色散关系所预测的每单元数值衰减 $\\alpha_{\\mathrm{num}}$，以及\n- 复伸展所预测的每单元连续衰减 $\\alpha_{\\mathrm{cont}}$，\n并返回每单元的绝对误差 $|\\alpha_{\\mathrm{num}} - \\alpha_{\\mathrm{cont}}|$，结果为浮点数。\n\n所有角度均使用弧度。使用以下具有物理一致单位的测试套件，并以奈培/单元为单位报告所有衰减和误差：\n- 测试 1 (正常情况)：$c = 1500$ m/s, $\\Delta x = 0.01$ m, $S = 0.5$, $f = 5000$ Hz, $\\sigma = 1000$ s$^{-1}$。\n- 测试 2 (边界情况，无 PML)：$c = 1500$ m/s, $\\Delta x = 0.01$ m, $S = 0.5$, $f = 5000$ Hz, $\\sigma = 0$ s$^{-1}$。\n- 测试 3 (接近 Courant 极限，空气)：$c = 343$ m/s, $\\Delta x = 0.005$ m, $S = 0.99$, $f = 40000$ Hz, $\\sigma = 3000$ s$^{-1}$。\n- 测试 4 (低频，强伸展)：$c = 1500$ m/s, $\\Delta x = 0.02$ m, $S = 0.6$, $f = 100$ Hz, $\\sigma = 500$ s$^{-1}$。\n- 测试 5 (强 PML)：$c = 1500$ m/s, $\\Delta x = 0.005$ m, $S = 0.8$, $f = 10000$ Hz, $\\sigma = 15000$ s$^{-1}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”）。每个条目必须是相应测试用例的绝对误差 $|\\alpha_{\\mathrm{num}} - \\alpha_{\\mathrm{cont}}|$，单位为奈培/单元，格式为浮点数。不应打印任何其他文本。",
            "solution": "用户提供的问题经评估为**有效**。该问题在科学上基于计算声学原理，特别是时域有限差分 (FDTD) 方法和用于波吸收的完美匹配层 (PML)。问题设定良好，目标明确，数据充分，且无内部矛盾。它要求对离散色散关系进行标准推导，并将其与连续解析模型进行比较，这是该领域的一项基础分析。\n\n### 任务 A：离散色散关系与数值衰减的推导\n\n我们从均匀 PML 区域内声压 $p$ 和质点速度 $u$ 的给定二阶 FDTD 更新方程开始：\n$$\nu^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} = u^{n-\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} - \\frac{\\Delta t}{\\rho\\, s_x\\, \\Delta x}\\left(p^{n}_{i+1} - p^{n}_{i}\\right)\n$$\n$$\np^{n+1}_{i} = p^{n}_{i} - \\frac{\\rho c^2 \\Delta t}{s_x\\, \\Delta x}\\left(u^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} - u^{n+\\tfrac{1}{2}}_{i-\\tfrac{1}{2}}\\right)\n$$\n将单色平面波拟设代入这些方程：\n$$\np^{n}_{i} = P\\, e^{i(i\\,\\kappa - n\\,\\Omega)}\n$$\n$$\nu^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} = U\\, e^{i\\left((i+\\tfrac{1}{2})\\,\\kappa - (n+\\tfrac{1}{2})\\,\\Omega\\right)}\n$$\n其中 $\\kappa$ 是每单元的复离散空间相位，$\\Omega = \\omega \\Delta t$ 是离散角频率。\n\n将拟设代入 $u$ 的更新方程：\n$$\nU e^{i\\left((i+\\tfrac{1}{2})\\kappa - (n+\\tfrac{1}{2})\\Omega\\right)} = U e^{i\\left((i+\\tfrac{1}{2})\\kappa - (n-\\tfrac{1}{2})\\Omega\\right)} - \\frac{\\Delta t}{\\rho s_x \\Delta x} \\left( P e^{i((i+1)\\kappa - n\\Omega)} - P e^{i(i\\kappa - n\\Omega)} \\right)\n$$\n我们将整个方程除以公因子 $e^{i((i+1/2)\\kappa - n\\Omega)}$：\n$$\nU e^{-i\\Omega/2} = U e^{i\\Omega/2} - \\frac{\\Delta t P}{\\rho s_x \\Delta x} \\left( e^{i\\kappa/2} - e^{-i\\kappa/2} \\right)\n$$\n重新整理并应用欧拉恒等式 $e^{ix} - e^{-ix} = 2i\\sin(x)$：\n$$\nU (e^{i\\Omega/2} - e^{-i\\Omega/2}) = \\frac{\\Delta t P}{\\rho s_x \\Delta x} (e^{i\\kappa/2} - e^{-i\\kappa/2})\n$$\n$$\nU (2i\\sin(\\Omega/2)) = \\frac{\\Delta t P}{\\rho s_x \\Delta x} (2i\\sin(\\kappa/2))\n$$\n这给出了复振幅 $P$ 和 $U$ 之间的第一个关系：\n$$\nU \\sin(\\Omega/2) = \\frac{\\Delta t}{\\rho s_x \\Delta x} P \\sin(\\kappa/2) \\quad \\quad (1)\n$$\n接下来，我们将拟设代入 $p$ 的更新方程：\n$$\nP e^{i(i\\kappa - (n+1)\\Omega)} = P e^{i(i\\kappa - n\\Omega)} - \\frac{\\rho c^2 \\Delta t}{s_x \\Delta x} \\left( U e^{i((i+\\tfrac{1}{2})\\kappa - (n+\\tfrac{1}{2})\\Omega)} - U e^{i((i-\\tfrac{1}{2})\\kappa - (n+\\tfrac{1}{2})\\Omega)} \\right)\n$$\n除以公因子 $e^{i(i\\kappa - (n+1/2)\\Omega)}$：\n$$\nP e^{-i\\Omega/2} = P e^{i\\Omega/2} - \\frac{\\rho c^2 \\Delta t U}{s_x \\Delta x} \\left( e^{i\\kappa/2} - e^{-i\\kappa/2} \\right)\n$$\n再次重新整理并应用欧拉恒等式：\n$$\nP (2i\\sin(\\Omega/2)) = \\frac{\\rho c^2 \\Delta t U}{s_x \\Delta x} (2i\\sin(\\kappa/2))\n$$\n这产生第二个关系：\n$$\nP \\sin(\\Omega/2) = \\frac{\\rho c^2 \\Delta t}{s_x \\Delta x} U \\sin(\\kappa/2) \\quad \\quad (2)\n$$\n为了求出色散关系，我们消去 $P$ 和 $U$。从 (1) 我们得到 $\\frac{U}{P} = \\frac{\\Delta t}{\\rho s_x \\Delta x} \\frac{\\sin(\\kappa/2)}{\\sin(\\Omega/2)}$，从 (2) 我们得到 $\\frac{P}{U} = \\frac{\\rho c^2 \\Delta t}{s_x \\Delta x} \\frac{\\sin(\\kappa/2)}{\\sin(\\Omega/2)}$。将这两个表达式相乘得到：\n$$\n1 = \\left( \\frac{\\Delta t}{\\rho s_x \\Delta x} \\frac{\\sin(\\kappa/2)}{\\sin(\\Omega/2)} \\right) \\left( \\frac{\\rho c^2 \\Delta t}{s_x \\Delta x} \\frac{\\sin(\\kappa/2)}{\\sin(\\Omega/2)} \\right)\n$$\n$$\n1 = \\frac{c^2 (\\Delta t)^2}{(s_x)^2 (\\Delta x)^2} \\frac{\\sin^2(\\kappa/2)}{\\sin^2(\\Omega/2)}\n$$\n引入 Courant 数 $S = c \\Delta t / \\Delta x$，我们得到：\n$$\n\\sin^2(\\Omega/2) = \\frac{S^2}{(s_x)^2} \\sin^2(\\kappa/2)\n$$\n取平方根（并为前向传播波选择物理分支）得到离散色散关系：\n$$\n\\sin(\\Omega/2) = \\frac{S}{s_x} \\sin(\\kappa/2)\n$$\n为了求出数值衰减，我们求解 $\\kappa$：\n$$\n\\sin(\\kappa/2) = \\frac{s_x}{S} \\sin(\\Omega/2) \\implies \\kappa = 2 \\arcsin\\left(\\frac{s_x}{S} \\sin(\\Omega/2)\\right)\n$$\n波拟设的空间部分是 $e^{i \\cdot i \\kappa} = e^{i \\cdot i (\\mathrm{Re}(\\kappa) + i \\mathrm{Im}(\\kappa))} = e^{i \\cdot i \\mathrm{Re}(\\kappa)} e^{-i \\mathrm{Im}(\\kappa)}$。对于单元索引 $i$ 的每一个单位增量，振幅以 $e^{-\\mathrm{Im}(\\kappa)}$ 的因子衰减。因此，每单元的衰减 $\\alpha_{\\mathrm{num}}$ 是 $\\kappa$ 的虚部。因为我们预期物理 PML 会有衰减，所以 $\\mathrm{Im}(\\kappa)$ 必须为正。\n$$\n\\alpha_{\\mathrm{num}} = \\mathrm{Im}(\\kappa) = \\mathrm{Im}\\left(2 \\arcsin\\left(\\frac{s_x}{S} \\sin(\\frac{\\Omega}{2})\\right)\\right)\n$$\n\n### 任务 B：每单元连续衰减的推导\n\n在连续频域中，一维声波方程为 $\\frac{\\partial^2 \\hat{p}}{\\partial x^2} + k^2 \\hat{p} = 0$，其中 $k = \\omega/c$ 是波数。PML 是通过复坐标伸展引入的，它转换了空间微分算子：$\\frac{\\partial}{\\partial x} \\to \\frac{1}{s_x} \\frac{\\partial}{\\partial x}$。对于 $s_x$ 为常数的均匀 PML，修正后的波动方程变为：\n$$\n\\frac{1}{s_x^2} \\frac{\\partial^2 \\hat{p}}{\\partial x^2} + k^2 \\hat{p} = 0 \\implies \\frac{\\partial^2 \\hat{p}}{\\partial x^2} + (k s_x)^2 \\hat{p} = 0\n$$\n这是一个具有复波数 $k_{\\mathrm{PML}} = k s_x$ 的 Helmholtz 方程。沿 $+x$ 方向传播的平面波具有形式 $\\hat{p}(x) \\propto e^{i k_{\\mathrm{PML}} x}$。代入 $k$ 和 $s_x$ 的定义：\n$$\nk_{\\mathrm{PML}} = \\left(\\frac{\\omega}{c}\\right) \\left(1 + i \\frac{\\sigma}{\\omega}\\right) = \\frac{\\omega}{c} + i\\frac{\\sigma}{c}\n$$\n因此，波解为：\n$$\ne^{i k_{\\mathrm{PML}} x} = e^{i (\\frac{\\omega}{c} + i\\frac{\\sigma}{c}) x} = e^{i \\frac{\\omega}{c} x} e^{-\\frac{\\sigma}{c} x}\n$$\n从 $e^{-(\\sigma/c)x}$ 项中，我们确定衰减常数为 $\\sigma/c$，单位是奈培/单位长度。问题要求的是每单元的连续衰减 $\\alpha_{\\mathrm{cont}}$。由于一个单元的长度为 $\\Delta x$，我们将每单位长度的衰减乘以 $\\Delta x$：\n$$\n\\alpha_{\\mathrm{cont}} = \\frac{\\sigma}{c} \\Delta x\n$$\n\n### 任务 C：误差计算\n\n每单元的绝对误差是 FDTD 格式推导出的数值衰减与理想连续衰减之间的绝对差。这将使用推导出的公式对每个测试用例进行计算。\n$$\n\\text{Error} = |\\alpha_{\\mathrm{num}} - \\alpha_{\\mathrm{cont}}|\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between numerical and continuous PML attenuation\n    for a 1D acoustic FDTD scheme for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c, Delta_x, S, f, sigma)\n    test_cases = [\n        # Test 1: Happy path\n        (1500.0, 0.01, 0.5, 5000.0, 1000.0),\n        # Test 2: Boundary, no PML\n        (1500.0, 0.01, 0.5, 5000.0, 0.0),\n        # Test 3: Near-Courant limit, air\n        (343.0, 0.005, 0.99, 40000.0, 3000.0),\n        # Test 4: Low frequency, strong stretch\n        (1500.0, 0.02, 0.6, 100.0, 500.0),\n        # Test 5: Strong PML\n        (1500.0, 0.005, 0.8, 10000.0, 15000.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        c, delta_x, S, f, sigma = case\n\n        # Calculate intermediate parameters\n        # Angular frequency (omega)\n        omega = 2.0 * np.pi * f\n        \n        # Complex stretch factor (s_x)\n        # Handle f=0 case to avoid division by zero, although not in tests.\n        if omega == 0:\n            s_x = 1.0 + 0.0j\n        else:\n            s_x = 1.0 + 1j * (sigma / omega)\n\n        # Time step (Delta_t)\n        delta_t = S * delta_x / c\n        \n        # Discrete angular frequency (Omega)\n        Omega = omega * delta_t\n        \n        # --- Task B: Compute continuous attenuation per cell (alpha_cont) ---\n        # alpha_cont = (sigma / c) * delta_x\n        # This is a nonnegative real number.\n        alpha_cont = sigma * delta_x / c\n\n        # --- Task A: Compute numerical attenuation per cell (alpha_num) ---\n        # Argument for the arcsin function\n        Z = (s_x / S) * np.sin(Omega / 2.0)\n        \n        # Complex discrete spatial phase per cell (kappa)\n        kappa = 2.0 * np.arcsin(Z)\n        \n        # Numerical attenuation is the imaginary part of kappa.\n        # For a forward-propagating physical wave, this should be nonnegative.\n        alpha_num = np.imag(kappa)\n\n        # --- Task C: Compute the absolute error ---\n        error = np.abs(alpha_num - alpha_cont)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现实世界中的问题通常涉及宽带信号，而非单一频率的波。本实践将应对这一挑战，引入更先进的复频移完美匹配层（CFS-PML）技术，该技术能更有效地吸收低频和倏逝波。你的任务是设计并优化CFS-PML的关键参数（如$\\sigma_{\\max}$和$\\alpha$），以最小化其在整个频带上的总反射，这是一个模拟真实工程设计与优化的综合性练习。",
            "id": "4133786",
            "problem": "考虑在一维均匀介质中，声速为 $c$ 的声波传播，其由压力 $p(x,t)$ 的线性声波方程描述，\n$$\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}.$$\n对于角频率为 $\\omega$ 的时谐分析，并约定 $p(x,t) = \\Re\\{P(x) e^{-i \\omega t}\\}$，场 $P(x)$ 满足亥姆霍兹方程\n$$\\frac{d^2 P}{dx^2} + k_0^2 P = 0,\\quad k_0 = \\frac{\\omega}{c}.$$\n为了在模拟无界介质的同时截断计算域，引入一个厚度为 $L$、占据 $x \\in [0,L]$ 的复频移完全匹配层（Complex-Frequency-Shifted Perfectly Matched Layer, CFS-PML），该层实现复坐标伸展，\n$$\\tilde{x}(x,\\omega) = \\int_0^x s_x(\\xi,\\omega)\\,d\\xi,$$\n其伸展函数为\n$$s_x(x,\\omega) = \\kappa_x(x) + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha},$$\n其中 $\\kappa_x(x)$ 是一个无量纲的缩放因子（实数且为正），$\\sigma_x(x)$ 是一个单位为秒分之一的阻尼剖面，而 $\\alpha$ 是复频移（Complex-Frequency Shift, CFS）参数，单位为弧度每秒。假设阻尼剖面为多项式形式 $\\sigma_x(x) = \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m$，其中整数 $m \\ge 1$，并取 $\\kappa_x(x) \\equiv 1$。一个在 $x=0$ 处进入PML的右行平面波会累积复相位 $i k_0 \\int_0^x s_x(\\xi,\\omega)\\,d\\xi$；其振幅根据伸展函数的虚部衰减。如果PML在 $x=L$ 处以一个完美反射边界终止，那么由于该终止而在物理域中感受到的净反射振幅可以很好地近似为\n$$R(\\omega) \\approx \\exp\\!\\left(-2 k_0 \\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx\\right).$$\n对于上述的CFS-PML伸展函数，请明确写出 $\\operatorname{Im}\\{s_x(x,\\omega)\\}$ 关于 $\\sigma_x(x)$ 和 $\\alpha$ 的表达式，然后对于多项式剖面，计算路径积分 $\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx$。利用此结果，推导 $R(\\omega)$ 关于 $\\omega$、$c$、$L$、$m$、$\\sigma_{\\max}$ 和 $\\alpha$ 的闭式表达式。\n\n设宽带脉冲在角频率带 $[\\omega_{\\min},\\omega_{\\max}]$ 上具有谱权重 $W(\\omega)$。使用高斯权重\n$$W(\\omega) = \\exp\\!\\left(-\\frac{(\\omega - \\omega_0)^2}{2 \\sigma_\\omega^2}\\right),$$\n其中 $\\omega_0$ 是中心角频率，$\\sigma_\\omega$ 是角频率展宽。定义归一化积分反射度量\n$$J(\\sigma_{\\max},\\alpha) = \\frac{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, |R(\\omega)|^2\\, d\\omega}{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, d\\omega}.$$\n您的任务是：\n- 从控制方程和CFS-PML的定义出发，为给定的 $\\sigma_x(x)$ 和 $\\kappa_x(x)$ 推导 $\\operatorname{Im}\\{s_x(x,\\omega)\\}$ 和 $R(\\omega)$ 的表达式。\n- 使用 $R(\\omega)$ 的表达式，实现一个程序，对下面定义的每个测试用例，在有限的 $(\\sigma_{\\max},\\alpha)$ 候选对集合中进行搜索，并返回使 $J(\\sigma_{\\max},\\alpha)$ 最小化的参数对以及 $J$ 的最小值。\n\n假设和单位：\n- 声速 $c$ 的单位是米/秒。\n- PML厚度 $L$ 的单位是米。\n- 阻尼振幅 $\\sigma_{\\max}$ 的单位是秒分之一。\n- 复频移参数 $\\alpha$ 的单位是弧度/秒。\n- 频率的单位是赫兹；通过 $\\omega = 2\\pi f$ 将其转换为单位为弧度/秒的角频率。\n- 将所有输出表示为无单位的纯数字；内部计算必须遵循所述单位。\n\n测试套件：\n- 案例1（理想情况，水，中等厚度PML，宽带）：$c = 1500$ m/s, $L=0.02$ m, $m=3$, $f_{\\min}=1000$ Hz, $f_{\\max}=50000$ Hz, $f_0=20000$ Hz, $\\Delta f = 15000$ Hz 以使 $\\sigma_\\omega = 2\\pi \\Delta f$。候选集：$\\sigma_{\\max} \\in \\{2{\\times}10^5, 5{\\times}10^5, 1{\\times}10^6\\}$ s$^{-1}$, $\\alpha \\in \\{2\\pi\\cdot 500, 2\\pi\\cdot 2000, 2\\pi\\cdot 5000\\}$ rad/s。\n- 案例2（空气中低频主导脉冲，较厚PML，包含无频移边界情况）：$c = 343$ m/s, $L=0.05$ m, $m=3$, $f_{\\min}=100$ Hz, $f_{\\max}=5000$ Hz, $f_0=1000$ Hz, $\\Delta f = 800$ Hz, $\\sigma_{\\max} \\in \\{2{\\times}10^4, 5{\\times}10^4, 1{\\times}10^5\\}$ s$^{-1}$, $\\alpha \\in \\{0, 2\\pi\\cdot 100, 2\\pi\\cdot 500\\}$ rad/s。\n- 案例3（薄PML，水中高频带）：$c = 1500$ m/s, $L=0.005$ m, $m=3$, $f_{\\min}=10000$ Hz, $f_{\\max}=200000$ Hz, $f_0=60000$ Hz, $\\Delta f = 30000$ Hz, $\\sigma_{\\max} \\in \\{1{\\times}10^5, 2{\\times}10^5, 3{\\times}10^5\\}$ s$^{-1}$, $\\alpha \\in \\{2\\pi\\cdot 2000, 2\\pi\\cdot 10000\\}$ rad/s。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个案例的结果，格式为逗号分隔的列表的列表。每个内部列表必须是 $[\\sigma_{\\max},\\kappa,\\alpha,J]$ 的形式，其中 $\\kappa$ 固定为 $1$，$J$ 是该案例的最小归一化积分反射。例如，输出应类似于 $[[\\sigma_{\\max}^{(1)},1,\\alpha^{(1)},J^{(1)}],[\\sigma_{\\max}^{(2)},1,\\alpha^{(2)},J^{(2)}],[\\sigma_{\\max}^{(3)},1,\\alpha^{(3)},J^{(3)}]]$。",
            "solution": "该问题经评估有效。它在科学上基于计算声学的原理，特别是完全匹配层的理论。问题是适定的，所有必要的参数和定义都已提供，足以推导出解决方案并执行指定的数值优化。语言是客观的，要求是明确的。\n\n解决过程包括两个主要阶段：首先，对给定的复频移完全匹配层（CFS-PML）的反射系数 $R(\\omega)$ 进行解析推导；其次，通过数值实现一个搜索算法，以找到使加权积分反射度量 $J$ 最小化的最优PML参数 $(\\sigma_{\\max}, \\alpha)$。\n\n第一步是确定复伸展函数 $s_x(x,\\omega)$ 的虚部。伸展函数定义为：\n$$s_x(x,\\omega) = \\kappa_x(x) + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha}$$\n给定 $\\kappa_x(x) \\equiv 1$，我们有：\n$$s_x(x,\\omega) = 1 + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha}$$\n为求虚部，我们通过将分子和分母乘以分母的复共轭 $(\\omega - i\\alpha)$ 来使复数分数有理化：\n$$\\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha} = \\frac{i\\,\\sigma_x(x)}{(\\omega + i \\alpha)} \\frac{(\\omega - i \\alpha)}{(\\omega - i \\alpha)} = \\frac{i\\omega\\sigma_x(x) - i^2\\alpha\\sigma_x(x)}{\\omega^2 - (i\\alpha)^2} = \\frac{\\alpha\\sigma_x(x) + i\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}$$\n因此，伸展函数可以写成实部和虚部分离的形式：\n$$s_x(x,\\omega) = \\left(1 + \\frac{\\alpha\\sigma_x(x)}{\\omega^2 + \\alpha^2}\\right) + i\\left(\\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}\\right)$$\n负责波衰减的虚部为：\n$$\\operatorname{Im}\\{s_x(x,\\omega)\\} = \\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}$$\n下一步是计算该量在PML厚度 $L$ 上的积分，这决定了总的单程衰减：\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\int_0^L \\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2} \\, dx$$\n项 $\\frac{\\omega}{\\omega^2 + \\alpha^2}$ 与 $x$ 无关，可以从积分中提出。我们已知多项式阻尼剖面 $\\sigma_x(x) = \\sigma_{\\max} (x/L)^m$。\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\frac{\\omega}{\\omega^2 + \\alpha^2} \\int_0^L \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m \\, dx$$\n计算空间剖面的积分：\n$$\\int_0^L \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m \\, dx = \\frac{\\sigma_{\\max}}{L^m} \\int_0^L x^m \\, dx = \\frac{\\sigma_{\\max}}{L^m} \\left[\\frac{x^{m+1}}{m+1}\\right]_0^L = \\frac{\\sigma_{\\max}}{L^m} \\frac{L^{m+1}}{m+1} = \\frac{\\sigma_{\\max}L}{m+1}$$\n将此结果代回，我们得到总衰减积分的解析表达式：\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\frac{\\sigma_{\\max}L}{m+1} \\frac{\\omega}{\\omega^2 + \\alpha^2}$$\n由PML终端引起的反射振幅 $R(\\omega)$ 由往返衰减因子给出：\n$$R(\\omega) \\approx \\exp\\left(-2 k_0 \\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx\\right)$$\n使用 $k_0 = \\omega/c$ 和积分表达式，我们得到：\n$$R(\\omega) = \\exp\\left(-2 \\frac{\\omega}{c} \\left[\\frac{\\sigma_{\\max}L}{m+1} \\frac{\\omega}{\\omega^2 + \\alpha^2}\\right]\\right) = \\exp\\left(-\\frac{2\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)$$\n这就是所需的 $R(\\omega)$ 的闭式表达式。由于指数的参数是实数，所以 $R(\\omega)$ 是一个实值函数。\n\n第二阶段是实现优化。我们需要从一个有限的候选集中找到一对 $(\\sigma_{\\max}, \\alpha)$，以最小化归一化积分反射度量 $J$：\n$$J(\\sigma_{\\max},\\alpha) = \\frac{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, |R(\\omega)|^2\\, d\\omega}{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, d\\omega}$$\n权重函数是一个高斯函数 $W(\\omega) = \\exp\\left(-\\frac{(\\omega - \\omega_0)^2}{2 \\sigma_\\omega^2}\\right)$。由于 $R(\\omega)$ 是实数，所以 $|R(\\omega)|^2 = R(\\omega)^2$。分子中的被积函数是 $W(\\omega) R(\\omega)^2$。\n$$R(\\omega)^2 = \\left[\\exp\\left(-\\frac{2\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)\\right]^2 = \\exp\\left(-\\frac{4\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)$$\n每个测试用例的数值计算步骤如下：\n1. 定义固定参数 $c, L, m$ 以及频率参数 $f_{\\min}, f_{\\max}, f_0, \\Delta f$。通过 $\\omega = 2\\pi f$ 将频率转换为角频率（rad/s）。同时定义 $\\sigma_{\\max}$ 和 $\\alpha$ 的候选集。注意 $\\sigma_\\omega = 2\\pi \\Delta f$。\n2. 计算分母积分 $\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega) \\, d\\omega$。对于给定的测试用例，该值是恒定的，不依赖于PML参数，因此只需计算一次。\n3. 对所有候选对 $(\\sigma_{\\max}, \\alpha)$ 进行网格搜索。对于每一对：\n    a. 计算分子积分 $\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega) R(\\omega)^2 \\, d\\omega$。被积函数依赖于 $\\sigma_{\\max}$ 和 $\\alpha$ 的具体选择。\n    b. 使用稳健的求积方法（如 `scipy.integrate.quad`）对积分进行数值计算。\n    c. 通过将分子积分除以分母积分来计算 $J$ 的值。\n4. 识别出产生最小 $J$ 值的参数对 $(\\sigma_{\\max}, \\alpha)$，并记录这个最小 $J$ 值。\n5. 收集所有测试用例的最优参数和最小 $J$ 值，并将其格式化为所需的输出字符串。按规定，固定值 $\\kappa=1$ 也包含在输出中。\n此过程系统地评估了每个PML设计的性能，并根据指定的度量标准选择最佳设计。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the CFS-PML optimization problem for a set of test cases.\n    It derives the reflection coefficient, defines a performance metric, and\n    searches a parameter space to find the optimal PML design.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"c\": 1500, \"L\": 0.02, \"m\": 3,\n            \"f_min\": 1000, \"f_max\": 50000, \"f_0\": 20000, \"delta_f\": 15000,\n            \"sigma_max_candidates\": [2e5, 5e5, 1e6],\n            \"alpha_candidates\": [2 * np.pi * 500, 2 * np.pi * 2000, 2 * np.pi * 5000]\n        },\n        # Case 2\n        {\n            \"c\": 343, \"L\": 0.05, \"m\": 3,\n            \"f_min\": 100, \"f_max\": 5000, \"f_0\": 1000, \"delta_f\": 800,\n            \"sigma_max_candidates\": [2e4, 5e4, 1e5],\n            \"alpha_candidates\": [0, 2 * np.pi * 100, 2 * np.pi * 500]\n        },\n        # Case 3\n        {\n            \"c\": 1500, \"L\": 0.005, \"m\": 3,\n            \"f_min\": 10000, \"f_max\": 200000, \"f_0\": 60000, \"delta_f\": 30000,\n            \"sigma_max_candidates\": [1e5, 2e5, 3e5],\n            \"alpha_candidates\": [2 * np.pi * 2000, 2 * np.pi * 10000]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        c = case[\"c\"]\n        L = case[\"L\"]\n        m = case[\"m\"]\n        sigma_max_candidates = case[\"sigma_max_candidates\"]\n        alpha_candidates = case[\"alpha_candidates\"]\n\n        # Convert frequencies from Hz to rad/s\n        omega_min = 2 * np.pi * case[\"f_min\"]\n        omega_max = 2 * np.pi * case[\"f_max\"]\n        omega_0 = 2 * np.pi * case[\"f_0\"]\n        sigma_omega = 2 * np.pi * case[\"delta_f\"]\n\n        # Define the Gaussian spectral weight W(omega)\n        def W(omega):\n            return np.exp(-(omega - omega_0)**2 / (2 * sigma_omega**2))\n\n        # Denominator integral is constant for the case\n        denominator_integral, _ = integrate.quad(W, omega_min, omega_max)\n\n        min_J = float('inf')\n        best_sigma_max = None\n        best_alpha = None\n\n        # Perform the grid search over the candidate parameters\n        for sigma_max in sigma_max_candidates:\n            for alpha in alpha_candidates:\n                # Pre-calculate the constant part of the exponent in R(omega)^2\n                pml_const = (4 * sigma_max * L) / (c * (m + 1))\n\n                # Define the integrand for the numerator\n                def numerator_integrand(omega):\n                    # Handle omega=0 and alpha=0 case to avoid 0/0\n                    if omega == 0 and alpha == 0:\n                        reflection_exponent_term = 1.0 # This limit is 1\n                    else:\n                        reflection_exponent_term = (omega**2) / (omega**2 + alpha**2)\n                    \n                    R_squared = np.exp(-pml_const * reflection_exponent_term)\n                    return W(omega) * R_squared\n                \n                # Calculate the numerator integral\n                numerator_integral, _ = integrate.quad(\n                    numerator_integrand, omega_min, omega_max, limit=100\n                )\n\n                # Calculate J\n                if denominator_integral > 0:\n                    current_J = numerator_integral / denominator_integral\n                else: \n                    # This case should not happen with the given parameters\n                    current_J = float('inf')\n\n                # Update if a new minimum is found\n                if current_J  min_J:\n                    min_J = current_J\n                    best_sigma_max = sigma_max\n                    best_alpha = alpha\n        \n        # kappa is fixed to 1\n        kappa = 1\n        results.append([best_sigma_max, kappa, best_alpha, min_J])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}