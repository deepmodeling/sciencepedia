{
    "hands_on_practices": [
        {
            "introduction": "The \"perfectly matched\" property of a PML is not just a descriptive name; it is a direct consequence of its mathematical construction. This foundational exercise guides you through the analytical proof that a split-field PML, when correctly implemented at an interface, produces zero reflection for an obliquely incident plane wave . By deriving the reflection coefficient from the first principles of acoustics and appropriate boundary conditions, you will solidify your understanding of how the complex coordinate stretch creates a seamless, reflectionless transition from the physical domain to the absorbing layer.",
            "id": "4133649",
            "problem": "Consider linear acoustic wave propagation in a homogeneous, inviscid fluid of density $\\rho_0$ and bulk modulus $K$. Assume time-harmonic dependence with factor $\\exp(i \\omega t)$, angular frequency $\\omega$, and speed of sound $c$ satisfying $c^2 = K/\\rho_0$.\n\nA two-dimensional oblique plane wave of pressure $p^{\\text{inc}}(x,y) = p_0 \\exp\\!\\big(i k_x x + i k_y y\\big)$ is incident from the half-space $x < 0$ onto a planar interface at $x = 0$. The wave numbers satisfy $k_x = k \\cos \\theta$, $k_y = k \\sin \\theta$, and $k = \\omega/c$, for a fixed incidence angle $\\theta \\in (0,\\pi/2)$. The half-space $x \\ge 0$ is occupied by a Perfectly Matched Layer (PML), implemented by the split-field formulation of a complex coordinate stretch, where the spatial derivatives are modified as $\\partial_x \\mapsto \\frac{1}{s_x(x)} \\partial_x$ and $\\partial_y \\mapsto \\frac{1}{s_y(y)} \\partial_y$. The stretching factors are $s_x(x) = 1 + \\sigma_x(x)/(i \\omega)$ and $s_y(y) = 1 + \\sigma_y(y)/(i \\omega)$, with $\\sigma_x$ and $\\sigma_y$ piecewise constant functions on $x \\ge 0$ and $y \\in \\mathbb{R}$, respectively. In the physical half-space $x < 0$, $s_x = s_y = 1$. Assume the design ensures $s_y(0^+) = 1$ so that tangential stretching is not applied at the entrance interface, while $s_x(0^+) \\neq 1$ is allowed.\n\nStarting from the linearized equations of acoustics and the above PML modification, derive the reflection coefficient $R$, defined as the complex amplitude ratio $R = p^{\\text{ref}}(0,y)/p^{\\text{inc}}(0,y)$ of the reflected to incident pressure at the interface $x = 0$, for the given oblique incidence. Your derivation must proceed from the momentum and continuity equations, enforce appropriate boundary continuity conditions, and determine the transmitted wave in the PML medium consistent with the modified dispersion relation. Express $R$ as a closed-form analytic expression in terms of $\\rho_0$, $K$, $\\omega$, $\\theta$, and the entrance values $s_x(0^+)$ and $s_y(0^+)$, and then simplify under the stated entrance condition $s_y(0^+) = 1$ to reach the final answer. Finally, argue using your derived expression that in the continuous limit of a piecewise constant approximation of any admissible continuous profile $\\sigma_x(x)$ and $\\sigma_y(y)$, the reflection coefficient at $x=0$ vanishes. The final answer must be a single closed-form expression for $R$. No rounding is required, and the answer is dimensionless.",
            "solution": "We begin with the linearized equations of acoustics under time-harmonic dependence $\\exp(i \\omega t)$:\n\n$$\n\\rho_0\\, i \\omega\\, \\mathbf{v} = - \\nabla p, \\qquad \\frac{i \\omega}{K}\\, p = - \\nabla \\cdot \\mathbf{v},\n$$\n\nwhere $p$ is pressure and $\\mathbf{v} = (v_x, v_y)$ is particle velocity. In a homogeneous physical medium (no PML), a plane wave $p = A \\exp\\!\\big(i \\mathbf{k} \\cdot \\mathbf{x}\\big)$ satisfies $\\mathbf{v} = - \\frac{\\mathbf{k}}{\\omega \\rho_0}\\, p$ and the dispersion relation $|\\mathbf{k}|^2 = \\frac{\\omega^2 \\rho_0}{K} = k^2$.\n\nIn the split-field Perfectly Matched Layer (PML) region, the spatial derivatives are modified as\n\n$$\n\\partial_x \\mapsto \\frac{1}{s_x(x)} \\partial_x, \\qquad \\partial_y \\mapsto \\frac{1}{s_y(y)} \\partial_y,\n$$\n\nwith\n\n$$\ns_x(x) = 1 + \\frac{\\sigma_x(x)}{i \\omega}, \\qquad s_y(y) = 1 + \\frac{\\sigma_y(y)}{i \\omega},\n$$\n\nwhere $\\sigma_x$ and $\\sigma_y$ are nonnegative, piecewise constant profiles. Near the entrance interface $x=0$, we allow $s_x(0^+) \\neq 1$, while assume $s_y(0^+) = 1$ (no tangential stretch at the interface) to ensure oblique-incidence match.\n\nIn frequency domain, the PML-modified momentum and continuity equations (in two dimensions and with piecewise constant $s_x$, $s_y$ locally) read\n\n$$\n\\rho_0\\, i \\omega\\, v_x = - \\frac{1}{s_x}\\, \\partial_x p, \\qquad \\rho_0\\, i \\omega\\, v_y = - \\frac{1}{s_y}\\, \\partial_y p,\n$$\n\n\n$$\n\\frac{i \\omega}{K}\\, p = - \\left( \\frac{1}{s_x}\\, \\partial_x v_x + \\frac{1}{s_y}\\, \\partial_y v_y \\right).\n$$\n\nWe consider a transmitted plane wave in the PML of the form $p^{\\text{tr}}(x,y) = T \\exp\\!\\big(i k_x^{\\text{tr}} x + i k_y y\\big)$, with the tangential component $k_y$ conserved by translational invariance along $y$. Applying the PML momentum relations to this ansatz yields\n\n$$\nv_x^{\\text{tr}} = - \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, p^{\\text{tr}}, \\qquad v_y^{\\text{tr}} = - \\frac{k_y}{\\omega \\rho_0 s_y}\\, p^{\\text{tr}}.\n$$\n\nInserting into the PML continuity equation and using $\\partial_x p^{\\text{tr}} = i k_x^{\\text{tr}} p^{\\text{tr}}$ and $\\partial_y p^{\\text{tr}} = i k_y p^{\\text{tr}}$, we obtain the PML dispersion relation\n\n$$\n\\frac{k_x^{\\text{tr}\\,2}}{s_x^2} + \\frac{k_y^2}{s_y^2} = \\frac{\\omega^2 \\rho_0}{K} = k^2.\n$$\n\nAt the interface $x=0$, the fluid occupies $x<0$ with $s_x = s_y = 1$, and the PML occupies $x \\ge 0$ with local constants $s_x(0^+)$ and $s_y(0^+)$. The incident and reflected fields in $x<0$ are\n\n$$\np^{\\text{inc}} = p_0 \\exp\\!\\big(i k_x x + i k_y y\\big), \\qquad p^{\\text{ref}} = R\\, p_0 \\exp\\!\\big(i (-k_x) x + i k_y y\\big),\n$$\n\nso that at $x=0$, $p^{\\text{left}}(0,y) = p_0(1+R) \\exp(i k_y y)$. The corresponding normal particle velocities, using the physical momentum relation $\\mathbf{v} = - \\frac{\\mathbf{k}}{\\omega \\rho_0} p$, are\n\n$$\nv_x^{\\text{inc}} = - \\frac{k_x}{\\omega \\rho_0}\\, p^{\\text{inc}}, \\qquad v_x^{\\text{ref}} = - \\frac{(-k_x)}{\\omega \\rho_0}\\, p^{\\text{ref}} = \\frac{k_x}{\\omega \\rho_0}\\, p^{\\text{ref}}.\n$$\n\nThus, at $x=0$, the total normal velocity in $x<0$ is\n\n$$\nv_x^{\\text{left}}(0,y) = \\left( - \\frac{k_x}{\\omega \\rho_0}\\, p_0 + \\frac{k_x}{\\omega \\rho_0}\\, R p_0 \\right) \\exp(i k_y y) = - \\frac{k_x}{\\omega \\rho_0}\\, p_0 (1 - R)\\, \\exp(i k_y y).\n$$\n\n\nOn the PML side, the transmitted pressure at $x=0$ is $p^{\\text{tr}}(0,y) = T \\exp(i k_y y)$, and the corresponding normal velocity is\n\n$$\nv_x^{\\text{tr}}(0,y) = - \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, T \\exp(i k_y y),\n$$\n\nwhere $s_x = s_x(0^+)$ and $s_y = s_y(0^+)$. The boundary conditions at $x=0$ are the continuity of pressure and normal velocity:\n\n$$\np^{\\text{left}}(0,y) = p^{\\text{tr}}(0,y), \\qquad v_x^{\\text{left}}(0,y) = v_x^{\\text{tr}}(0,y).\n$$\n\nThese give\n\n$$\np_0 (1 + R) = T, \\qquad - \\frac{k_x}{\\omega \\rho_0}\\, p_0 (1 - R) = - \\frac{k_x^{\\text{tr}}}{\\omega \\rho_0 s_x}\\, T.\n$$\n\nEliminating $T$ and simplifying yields a relation for $R$:\n\n$$\nk_x (1 - R) = \\frac{k_x^{\\text{tr}}}{s_x} (1 + R).\n$$\n\nSolving for $R$,\n\n$$\nR = \\frac{k_x - \\frac{k_x^{\\text{tr}}}{s_x}}{k_x + \\frac{k_x^{\\text{tr}}}{s_x}}.\n$$\n\nTo close this, we must determine $k_x^{\\text{tr}}$ from the PML dispersion for the entrance values $s_x(0^+)$ and $s_y(0^+)$. The PML dispersion imposes\n\n$$\n\\frac{k_x^{\\text{tr}\\,2}}{s_x^2} + \\frac{k_y^2}{s_y^2} = k^2.\n$$\n\nIn the physical medium, $k_x^2 + k_y^2 = k^2$. Therefore, if $s_y(0^+) = 1$ at the entrance interface (no tangential stretch), we have\n\n$$\n\\frac{k_x^{\\text{tr}\\,2}}{s_x^2} + k_y^2 = k^2 \\quad \\Longrightarrow \\quad \\frac{k_x^{\\text{tr}\\,2}}{s_x^2} = k^2 - k_y^2 = k_x^2 \\quad \\Longrightarrow \\quad \\frac{k_x^{\\text{tr}}}{s_x} = \\pm k_x.\n$$\n\nThe physically correct choice takes the transmitted wave to have forward decay in $x \\ge 0$ consistent with $s_x = 1 + \\sigma_x/(i \\omega)$ with $\\Re(s_x) = 1$ and $\\Im(s_x) \\le 0$, yielding $\\frac{k_x^{\\text{tr}}}{s_x} = k_x$. Substituting $\\frac{k_x^{\\text{tr}}}{s_x} = k_x$ into the expression for $R$ gives\n\n$$\nR = \\frac{k_x - k_x}{k_x + k_x} = 0.\n$$\n\nThus, under the stated entrance condition $s_y(0^+) = 1$ and with the split-field PML stretch applied in the normal direction, the reflection coefficient vanishes for all $\\omega$ and all oblique incidence angles $\\theta \\in (0,\\pi/2)$:\n\n$$\nR = 0.\n$$\n\n\nFinally, consider a piecewise constant approximation of any admissible continuous profiles $\\sigma_x(x)$ and $\\sigma_y(y)$ inside the PML. The reflection at $x=0$ depends only on the entrance values $s_x(0^+)$ and $s_y(0^+)$. As long as the entrance design maintains $s_y(0^+) = 1$ and $s_x(0^+) = 1 + \\sigma_x(0^+)/(i \\omega)$, the above matching condition $\\frac{k_x^{\\text{tr}}}{s_x} = k_x$ holds exactly, and therefore $R = 0$ independent of the internal piecewise structure. In the continuous limit where the piecewise constant profiles converge to continuous $\\sigma_x(x)$ and $\\sigma_y(y)$, the entrance values remain the same, and hence the reflection coefficient at $x=0$ is identically zero in the continuous limit. Therefore, the final computed reflection coefficient is\n\n$$\nR = 0.\n$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "While the continuous theory predicts perfect absorption, the performance of a PML in a real simulation depends on its discrete implementation. This practice delves into the world of Finite-Difference Time-Domain (FDTD) schemes, asking you to analyze how discretization affects PML performance . You will derive the numerical dispersion relation for a PML within an FDTD grid and compare the resulting numerical attenuation against the ideal analytical prediction, revealing the inherent trade-offs and sources of error in computational modeling.",
            "id": "4133742",
            "problem": "Consider one-dimensional linear acoustics in a homogeneous medium with constant density $\\rho$ and sound speed $c$. The governing first-order system is\n$$\n\\frac{\\partial p}{\\partial t} = -\\rho c^2 \\frac{\\partial u}{\\partial x},\\qquad\n\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x},\n$$\nwhere $p(x,t)$ is the acoustic pressure and $u(x,t)$ is the particle velocity. To truncate an unbounded domain, a Perfectly Matched Layer (PML) is introduced through complex coordinate stretching in the $x$-direction. In the frequency domain, the stretch is defined by\n$$\ns_x = 1 + i \\frac{\\sigma}{\\omega},\n$$\nwhere $\\sigma \\ge 0$ is the PML damping profile (with units $\\mathrm{s}^{-1}$), $\\omega = 2\\pi f$ is the angular frequency, and $i^2 = -1$. The PML is assumed uniform with constant $\\sigma$ inside the layer.\n\nWe discretize the time-domain equations using a staggered-grid second-order Finite-Difference Time-Domain (FDTD) scheme, where pressure is defined at integer spatial indices $i$ and integer time steps $n$, and velocity at half-integer spatial indices $i+\\tfrac{1}{2}$ and half-integer time steps $n+\\tfrac{1}{2}$. Spatial derivatives are approximated by centered differences with grid spacing $\\Delta x$, and the time derivative is advanced with time step $\\Delta t$. Within the PML, implement the complex stretch by scaling the discrete spatial difference operator by $1/s_x$ in both update equations. Explicitly, use the following discrete updates for a uniform PML region:\n$$\nu^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} = u^{n-\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} - \\frac{\\Delta t}{\\rho\\, s_x\\, \\Delta x}\\left(p^{n}_{i+1} - p^{n}_{i}\\right),\n$$\n$$\np^{n+1}_{i} = p^{n}_{i} - \\frac{\\rho c^2 \\Delta t}{s_x\\, \\Delta x}\\left(u^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} - u^{n+\\tfrac{1}{2}}_{i-\\tfrac{1}{2}}\\right).\n$$\nAssume a monochromatic plane wave solution inside a uniform PML region of the form\n$$\np^{n}_{i} = P\\, e^{i(i\\,\\kappa - n\\,\\Omega)},\\qquad u^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} = U\\, e^{i\\left((i+\\tfrac{1}{2})\\,\\kappa - (n+\\tfrac{1}{2})\\,\\Omega\\right)},\n$$\nwhere $\\kappa$ is the complex discrete spatial phase per cell (with $\\mathrm{rad}$ per cell), $\\Omega = \\omega \\Delta t$ is the discrete angular frequency (in radians), and $P,U$ are complex amplitudes. Define the Courant number $S = c\\,\\Delta t/\\Delta x$.\n\nTask A: Starting from the discrete update equations and the plane-wave ansatz above, derive a discrete dispersion relation that relates $\\kappa$, $\\Omega$, $S$, and $s_x$. Then, express the numerical attenuation per cell inside the PML, denoted $\\alpha_{\\mathrm{num}}$, as a nonnegative quantity obtained from $\\kappa$.\n\nTask B: From the continuous complex stretch model, determine the continuous attenuation per unit length inside the PML and then express the corresponding continuous attenuation per cell, $\\alpha_{\\mathrm{cont}}$, in nepers per cell.\n\nTask C: Implement a program that, for each test case below, computes:\n- the numerical attenuation per cell $\\alpha_{\\mathrm{num}}$ predicted by the discrete dispersion relation you derived, and\n- the continuous attenuation per cell $\\alpha_{\\mathrm{cont}}$ predicted by the complex stretch,\nand returns the absolute error per cell $|\\alpha_{\\mathrm{num}} - \\alpha_{\\mathrm{cont}}|$ as a floating-point number.\n\nUse radians for all angles. Use the following test suite with physically consistent units, and report all attenuations and errors in nepers per cell:\n- Test 1 (happy path): $c = 1500$ m/s, $\\Delta x = 0.01$ m, $S = 0.5$, $f = 5000$ Hz, $\\sigma = 1000$ s$^{-1}$.\n- Test 2 (boundary, no PML): $c = 1500$ m/s, $\\Delta x = 0.01$ m, $S = 0.5$, $f = 5000$ Hz, $\\sigma = 0$ s$^{-1}$.\n- Test 3 (near-Courant limit, air): $c = 343$ m/s, $\\Delta x = 0.005$ m, $S = 0.99$, $f = 40000$ Hz, $\\sigma = 3000$ s$^{-1}$.\n- Test 4 (low frequency, strong stretch): $c = 1500$ m/s, $\\Delta x = 0.02$ m, $S = 0.6$, $f = 100$ Hz, $\\sigma = 500$ s$^{-1}$.\n- Test 5 (strong PML): $c = 1500$ m/s, $\\Delta x = 0.005$ m, $S = 0.8$, $f = 10000$ Hz, $\\sigma = 15000$ s$^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each entry must be the absolute error $|\\alpha_{\\mathrm{num}} - \\alpha_{\\mathrm{cont}}|$ for the corresponding test case, in nepers per cell, as a floating-point number. No other text should be printed.",
            "solution": "The user-provided problem is assessed to be **valid**. It is scientifically grounded in the principles of computational acoustics, specifically the Finite-Difference Time-Domain (FDTD) method and the use of Perfectly Matched Layers (PML) for wave absorption. The problem is well-posed, with a clear objective, sufficient data, and no internal contradictions. It requests a standard derivation of a discrete dispersion relation and its comparison to the continuous analytical model, which is a fundamental analysis in the field.\n\n### Task A: Derivation of the Discrete Dispersion Relation and Numerical Attenuation\n\nWe begin with the provided second-order FDTD update equations for acoustic pressure $p$ and particle velocity $u$ within a uniform PML region:\n$$\nu^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} = u^{n-\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} - \\frac{\\Delta t}{\\rho\\, s_x\\, \\Delta x}\\left(p^{n}_{i+1} - p^{n}_{i}\\right)\n$$\n$$\np^{n+1}_{i} = p^{n}_{i} - \\frac{\\rho c^2 \\Delta t}{s_x\\, \\Delta x}\\left(u^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} - u^{n+\\tfrac{1}{2}}_{i-\\tfrac{1}{2}}\\right)\n$$\nInto these equations, we substitute the monochromatic plane-wave ansatz:\n$$\np^{n}_{i} = P\\, e^{i(i\\,\\kappa - n\\,\\Omega)}\n$$\n$$\nu^{n+\\tfrac{1}{2}}_{i+\\tfrac{1}{2}} = U\\, e^{i\\left((i+\\tfrac{1}{2})\\,\\kappa - (n+\\tfrac{1}{2})\\,\\Omega\\right)}\n$$\nwhere $\\kappa$ is the complex discrete spatial phase per cell and $\\Omega = \\omega \\Delta t$ is the discrete angular frequency.\n\nSubstituting the ansatz into the update equation for $u$:\n$$\nU e^{i\\left((i+\\tfrac{1}{2})\\kappa - (n+\\tfrac{1}{2})\\Omega\\right)} = U e^{i\\left((i+\\tfrac{1}{2})\\kappa - (n-\\tfrac{1}{2})\\Omega\\right)} - \\frac{\\Delta t}{\\rho s_x \\Delta x} \\left( P e^{i((i+1)\\kappa - n\\Omega)} - P e^{i(i\\kappa - n\\Omega)} \\right)\n$$\nWe divide the entire equation by the common factor $e^{i((i+1/2)\\kappa - n\\Omega)}$:\n$$\nU e^{-i\\Omega/2} = U e^{i\\Omega/2} - \\frac{\\Delta t P}{\\rho s_x \\Delta x} \\left( e^{i\\kappa/2} - e^{-i\\kappa/2} \\right)\n$$\nRearranging and applying Euler's identity, $e^{ix} - e^{-ix} = 2i\\sin(x)$:\n$$\nU (e^{i\\Omega/2} - e^{-i\\Omega/2}) = \\frac{\\Delta t P}{\\rho s_x \\Delta x} (e^{i\\kappa/2} - e^{-i\\kappa/2})\n$$\n$$\nU (2i\\sin(\\Omega/2)) = \\frac{\\Delta t P}{\\rho s_x \\Delta x} (2i\\sin(\\kappa/2))\n$$\nThis gives the first relation between the complex amplitudes $P$ and $U$:\n$$\nU \\sin(\\Omega/2) = \\frac{\\Delta t}{\\rho s_x \\Delta x} P \\sin(\\kappa/2) \\quad \\quad (1)\n$$\nNext, we substitute the ansatz into the update equation for $p$:\n$$\nP e^{i(i\\kappa - (n+1)\\Omega)} = P e^{i(i\\kappa - n\\Omega)} - \\frac{\\rho c^2 \\Delta t}{s_x \\Delta x} \\left( U e^{i((i+\\tfrac{1}{2})\\kappa - (n+\\tfrac{1}{2})\\Omega)} - U e^{i((i-\\tfrac{1}{2})\\kappa - (n+\\tfrac{1}{2})\\Omega)} \\right)\n$$\nDivide by the common factor $e^{i(i\\kappa - (n+1/2)\\Omega)}$:\n$$\nP e^{-i\\Omega/2} = P e^{i\\Omega/2} - \\frac{\\rho c^2 \\Delta t U}{s_x \\Delta x} \\left( e^{i\\kappa/2} - e^{-i\\kappa/2} \\right)\n$$\nAgain, rearranging and applying Euler's identity:\n$$\nP (2i\\sin(\\Omega/2)) = \\frac{\\rho c^2 \\Delta t U}{s_x \\Delta x} (2i\\sin(\\kappa/2))\n$$\nThis yields the second relation:\n$$\nP \\sin(\\Omega/2) = \\frac{\\rho c^2 \\Delta t}{s_x \\Delta x} U \\sin(\\kappa/2) \\quad \\quad (2)\n$$\nTo find the dispersion relation, we eliminate $P$ and $U$. From (1) we have $\\frac{U}{P} = \\frac{\\Delta t}{\\rho s_x \\Delta x} \\frac{\\sin(\\kappa/2)}{\\sin(\\Omega/2)}$, and from (2) we have $\\frac{P}{U} = \\frac{\\rho c^2 \\Delta t}{s_x \\Delta x} \\frac{\\sin(\\kappa/2)}{\\sin(\\Omega/2)}$. Multiplying these two expressions gives:\n$$\n1 = \\left( \\frac{\\Delta t}{\\rho s_x \\Delta x} \\frac{\\sin(\\kappa/2)}{\\sin(\\Omega/2)} \\right) \\left( \\frac{\\rho c^2 \\Delta t}{s_x \\Delta x} \\frac{\\sin(\\kappa/2)}{\\sin(\\Omega/2)} \\right)\n$$\n$$\n1 = \\frac{c^2 (\\Delta t)^2}{(s_x)^2 (\\Delta x)^2} \\frac{\\sin^2(\\kappa/2)}{\\sin^2(\\Omega/2)}\n$$\nIntroducing the Courant number $S = c \\Delta t / \\Delta x$, we get:\n$$\n\\sin^2(\\Omega/2) = \\frac{S^2}{(s_x)^2} \\sin^2(\\kappa/2)\n$$\nTaking the square root (and selecting the physical branch for forward-propagating waves) gives the discrete dispersion relation:\n$$\n\\sin(\\Omega/2) = \\frac{S}{s_x} \\sin(\\kappa/2)\n$$\nTo find the numerical attenuation, we solve for $\\kappa$:\n$$\n\\sin(\\kappa/2) = \\frac{s_x}{S} \\sin(\\Omega/2) \\implies \\kappa = 2 \\arcsin\\left(\\frac{s_x}{S} \\sin(\\Omega/2)\\right)\n$$\nThe spatial part of the wave ansatz is $e^{i \\cdot i \\kappa} = e^{i \\cdot i (\\mathrm{Re}(\\kappa) + i \\mathrm{Im}(\\kappa))} = e^{i \\cdot i \\mathrm{Re}(\\kappa)} e^{-i \\mathrm{Im}(\\kappa)}$. The amplitude decays by a factor of $e^{-\\mathrm{Im}(\\kappa)}$ for each unit increase in the cell index $i$. The attenuation per cell, $\\alpha_{\\mathrm{num}}$, is therefore the imaginary part of $\\kappa$. As we expect attenuation for a physical PML, $\\mathrm{Im}(\\kappa)$ must be positive.\n$$\n\\alpha_{\\mathrm{num}} = \\mathrm{Im}(\\kappa) = \\mathrm{Im}\\left(2 \\arcsin\\left(\\frac{s_x}{S} \\sin(\\frac{\\Omega}{2})\\right)\\right)\n$$\n\n### Task B: Derivation of the Continuous Attenuation per Cell\n\nIn the continuous frequency domain, the 1D acoustic wave equation is $\\frac{\\partial^2 \\hat{p}}{\\partial x^2} + k^2 \\hat{p} = 0$, where $k = \\omega/c$ is the wavenumber. The PML is introduced by a complex coordinate stretch, which transforms the spatial derivative operator: $\\frac{\\partial}{\\partial x} \\to \\frac{1}{s_x} \\frac{\\partial}{\\partial x}$. For a uniform PML where $s_x$ is constant, the modified wave equation becomes:\n$$\n\\frac{1}{s_x^2} \\frac{\\partial^2 \\hat{p}}{\\partial x^2} + k^2 \\hat{p} = 0 \\implies \\frac{\\partial^2 \\hat{p}}{\\partial x^2} + (k s_x)^2 \\hat{p} = 0\n$$\nThis is a Helmholtz equation with a complex wavenumber $k_{\\mathrm{PML}} = k s_x$. A plane wave propagating in the $+x$ direction has the form $\\hat{p}(x) \\propto e^{i k_{\\mathrm{PML}} x}$. Substituting the definitions of $k$ and $s_x$:\n$$\nk_{\\mathrm{PML}} = \\left(\\frac{\\omega}{c}\\right) \\left(1 + i \\frac{\\sigma}{\\omega}\\right) = \\frac{\\omega}{c} + i\\frac{\\sigma}{c}\n$$\nThe wave solution is thus:\n$$\ne^{i k_{\\mathrm{PML}} x} = e^{i (\\frac{\\omega}{c} + i\\frac{\\sigma}{c}) x} = e^{i \\frac{\\omega}{c} x} e^{-\\frac{\\sigma}{c} x}\n$$\nFrom the term $e^{-(\\sigma/c)x}$, we identify the attenuation constant as $\\sigma/c$ in units of nepers per unit length. The problem asks for the continuous attenuation per cell, $\\alpha_{\\mathrm{cont}}$. Since one cell has length $\\Delta x$, we multiply the attenuation per length by $\\Delta x$:\n$$\n\\alpha_{\\mathrm{cont}} = \\frac{\\sigma}{c} \\Delta x\n$$\n\n### Task C: Error Calculation\n\nThe absolute error per cell is the absolute difference between the numerical attenuation derived from the FDTD scheme and the ideal continuous attenuation. This will be computed for each test case using the derived formulas.\n$$\n\\text{Error} = |\\alpha_{\\mathrm{num}} - \\alpha_{\\mathrm{cont}}|\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between numerical and continuous PML attenuation\n    for a 1D acoustic FDTD scheme for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c, Delta_x, S, f, sigma)\n    test_cases = [\n        # Test 1: Happy path\n        (1500.0, 0.01, 0.5, 5000.0, 1000.0),\n        # Test 2: Boundary, no PML\n        (1500.0, 0.01, 0.5, 5000.0, 0.0),\n        # Test 3: Near-Courant limit, air\n        (343.0, 0.005, 0.99, 40000.0, 3000.0),\n        # Test 4: Low frequency, strong stretch\n        (1500.0, 0.02, 0.6, 100.0, 500.0),\n        # Test 5: Strong PML\n        (1500.0, 0.005, 0.8, 10000.0, 15000.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        c, delta_x, S, f, sigma = case\n\n        # Calculate intermediate parameters\n        # Angular frequency (omega)\n        omega = 2.0 * np.pi * f\n        \n        # Complex stretch factor (s_x)\n        # Handle f=0 case to avoid division by zero, although not in tests.\n        if omega == 0:\n            s_x = 1.0 + 0.0j\n        else:\n            s_x = 1.0 + 1j * (sigma / omega)\n\n        # Time step (Delta_t)\n        delta_t = S * delta_x / c\n        \n        # Discrete angular frequency (Omega)\n        Omega = omega * delta_t\n        \n        # --- Task B: Compute continuous attenuation per cell (alpha_cont) ---\n        # alpha_cont = (sigma / c) * delta_x\n        # This is a nonnegative real number.\n        alpha_cont = sigma * delta_x / c\n\n        # --- Task A: Compute numerical attenuation per cell (alpha_num) ---\n        # Argument for the arcsin function\n        Z = (s_x / S) * np.sin(Omega / 2.0)\n        \n        # Complex discrete spatial phase per cell (kappa)\n        kappa = 2.0 * np.arcsin(Z)\n        \n        # Numerical attenuation is the imaginary part of kappa.\n        # For a forward-propagating physical wave, this should be nonnegative.\n        alpha_num = np.imag(kappa)\n\n        # --- Task C: Compute the absolute error ---\n        error = np.abs(alpha_num - alpha_cont)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond basic analysis lies the engineering task of designing a PML that performs optimally for a specific problem, such as absorbing a broadband pulse. This exercise introduces the powerful Complex-Frequency-Shifted PML (CFS-PML), which offers enhanced absorption for low-frequency and evanescent waves . You will move into the role of a designer, implementing a model to search for the optimal CFS-PML parameters that minimize reflections across a wide frequency spectrum, a critical task in designing high-fidelity simulations.",
            "id": "4133786",
            "problem": "Consider one-dimensional acoustic wave propagation described by the linear acoustic wave equation for pressure $p(x,t)$ in a homogeneous medium with speed of sound $c$,\n$$\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}.$$\nFor time-harmonic analysis with angular frequency $\\omega$ and the convention $p(x,t) = \\Re\\{P(x) e^{i \\omega t}\\}$, the field $P(x)$ satisfies the Helmholtz equation\n$$\\frac{d^2 P}{dx^2} + k_0^2 P = 0,\\quad k_0 = \\frac{\\omega}{c}.$$\nTo truncate the computational domain while emulating an unbounded medium, introduce a Complex-Frequency-Shifted Perfectly Matched Layer (CFS-PML) of thickness $L$ occupying $x \\in [0,L]$ that implements complex coordinate stretching,\n$$\\tilde{x}(x,\\omega) = \\int_0^x s_x(\\xi,\\omega)\\,d\\xi,$$\nwith stretch\n$$s_x(x,\\omega) = \\kappa_x(x) + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha},$$\nwhere $\\kappa_x(x)$ is a dimensionless scaling (real and positive), $\\sigma_x(x)$ is a damping profile with units of inverse seconds, and $\\alpha$ is the Complex-Frequency Shift (CFS) parameter in radians per second. Assume a polynomial damping profile $\\sigma_x(x) = \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m$ with integer $m \\ge 1$ and take $\\kappa_x(x) \\equiv 1$. A right-going plane wave entering the PML at $x=0$ accumulates complex phase $i k_0 \\int_0^x s_x(\\xi,\\omega)\\,d\\xi$; the amplitude decays according to the imaginary part of the stretch. If the PML terminates at $x=L$ with a perfectly reflecting boundary, the net reflection amplitude experienced back in the physical domain due to the termination is well approximated by\n$$R(\\omega) \\approx \\exp\\!\\left(-2 k_0 \\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx\\right).$$\nFor the CFS-PML stretch above, write $\\operatorname{Im}\\{s_x(x,\\omega)\\}$ explicitly in terms of $\\sigma_x(x)$ and $\\alpha$, and then evaluate the path integral $\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx$ for the polynomial profile. Using this, derive a closed-form expression for $R(\\omega)$ in terms of $\\omega$, $c$, $L$, $m$, and $\\sigma_{\\max}$, and $\\alpha$.\n\nLet the broadband pulse have spectral weight $W(\\omega)$ over an angular-frequency band $[\\omega_{\\min},\\omega_{\\max}]$. Use a Gaussian weight\n$$W(\\omega) = \\exp\\!\\left(-\\frac{(\\omega - \\omega_0)^2}{2 \\sigma_\\omega^2}\\right),$$\nwith $\\omega_0$ the center angular frequency and $\\sigma_\\omega$ the angular-frequency spread. Define the normalized integral reflection measure\n$$J(\\sigma_{\\max},\\alpha) = \\frac{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, |R(\\omega)|^2\\, d\\omega}{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, d\\omega}.$$\nYour tasks are:\n- Starting from the governing equations and the definition of CFS-PML, derive the expression for $\\operatorname{Im}\\{s_x(x,\\omega)\\}$ and $R(\\omega)$ for the given $\\sigma_x(x)$ and $\\kappa_x(x)$.\n- Using the expression for $R(\\omega)$, implement a program that, for each test case defined below, searches a finite candidate set of $(\\sigma_{\\max},\\alpha)$ pairs and returns the pair that minimizes $J(\\sigma_{\\max},\\alpha)$, along with the minimal value of $J$.\n\nAssumptions and units:\n- The speed of sound $c$ is specified in meters per second.\n- The PML thickness $L$ is specified in meters.\n- The damping amplitude $\\sigma_{\\max}$ is specified in inverse seconds.\n- The Complex-Frequency Shift parameter $\\alpha$ is specified in radians per second.\n- Frequencies are specified in hertz; convert to angular frequencies in radians per second via $\\omega = 2\\pi f$.\n- Express all outputs as pure numbers with no units; internal computation must respect the stated units.\n\nTest suite:\n- Case 1 (happy path, water, moderately thin PML, broadband): $c = 1500$ m/s, $L=0.02$ m, $m=3$, $f_{\\min}=1000$ Hz, $f_{\\max}=50000$ Hz, $f_0=20000$ Hz, $\\Delta f = 15000$ Hz so that $\\sigma_\\omega = 2\\pi \\Delta f$. Candidate sets: $\\sigma_{\\max} \\in \\{2\\times10^5, 5\\times10^5, 1\\times10^6\\} \\text{ s}^{-1}$, $\\alpha \\in \\{2\\pi\\cdot 500, 2\\pi\\cdot 2000, 2\\pi\\cdot 5000\\} \\text{ rad/s}$.\n- Case 2 (low-frequency dominated pulse in air, thicker PML, includes unshifted boundary case): $c = 343$ m/s, $L=0.05$ m, $m=3$, $f_{\\min}=100$ Hz, $f_{\\max}=5000$ Hz, $f_0=1000$ Hz, $\\Delta f = 800$ Hz, so that $\\sigma_\\omega = 2\\pi \\Delta f$. Candidate sets: $\\sigma_{\\max} \\in \\{2\\times10^4, 5\\times10^4, 1\\times10^5\\} \\text{ s}^{-1}$, $\\alpha \\in \\{0, 2\\pi\\cdot 100, 2\\pi\\cdot 500\\} \\text{ rad/s}$.\n- Case 3 (thin PML, high-frequency band in water): $c = 1500$ m/s, $L=0.005$ m, $m=3$, $f_{\\min}=10000$ Hz, $f_{\\max}=200000$ Hz, $f_0=60000$ Hz, $\\Delta f = 30000$ Hz, so that $\\sigma_\\omega = 2\\pi \\Delta f$. Candidate sets: $\\sigma_{\\max} \\in \\{1\\times10^5, 2\\times10^5, 3\\times10^5\\} \\text{ s}^{-1}$, $\\alpha \\in \\{2\\pi\\cdot 2000, 2\\pi\\cdot 10000\\} \\text{ rad/s}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the three cases as a comma-separated list of lists. Each inner list must be of the form $[\\sigma_{\\max},\\kappa,\\alpha,J]$, where $\\kappa$ is fixed to $1$, and $J$ is the minimal normalized integral reflection for the case. For example, the output should look like\n$[[\\sigma_{\\max}^{(1)},1,\\alpha^{(1)},J^{(1)}],[\\sigma_{\\max}^{(2)},1,\\alpha^{(2)},J^{(2)}],[\\sigma_{\\max}^{(3)},1,\\alpha^{(3)},J^{(3)}]]$.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of computational acoustics, specifically the theory of perfectly matched layers. The problem is well-posed, with all necessary parameters and definitions provided to derive a solution and perform the specified numerical optimization. The language is objective and the requirements are unambiguous.\n\nThe solution process involves two main stages: first, an analytical derivation of the reflection coefficient $R(\\omega)$ for the given Complex-Frequency-Shifted Perfectly Matched Layer (CFS-PML); second, the numerical implementation of a search algorithm to find the optimal PML parameters $(\\sigma_{\\max}, \\alpha)$ that minimize a weighted, integrated reflection measure $J$.\n\nThe first step is to determine the imaginary part of the complex stretch function, $s_x(x,\\omega)$. The stretch function is defined as:\n$$s_x(x,\\omega) = \\kappa_x(x) + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha}$$\nGiven $\\kappa_x(x) \\equiv 1$, we have:\n$$s_x(x,\\omega) = 1 + \\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha}$$\nTo find the imaginary part, we rationalize the complex fraction by multiplying the numerator and denominator by the complex conjugate of the denominator, $(\\omega - i\\alpha)$:\n$$\\frac{i\\,\\sigma_x(x)}{\\omega + i \\alpha} = \\frac{i\\,\\sigma_x(x)}{(\\omega + i \\alpha)} \\frac{(\\omega - i \\alpha)}{(\\omega - i \\alpha)} = \\frac{i\\omega\\sigma_x(x) - i^2\\alpha\\sigma_x(x)}{\\omega^2 - (i\\alpha)^2} = \\frac{\\alpha\\sigma_x(x) + i\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}$$\nThe stretch function can thus be written with its real and imaginary parts separated:\n$$s_x(x,\\omega) = \\left(1 + \\frac{\\alpha\\sigma_x(x)}{\\omega^2 + \\alpha^2}\\right) + i\\left(\\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}\\right)$$\nThe imaginary part, which is responsible for the wave attenuation, is:\n$$\\operatorname{Im}\\{s_x(x,\\omega)\\} = \\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2}$$\nThe next step is to evaluate the integral of this quantity over the PML thickness $L$, which determines the total one-way attenuation:\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\int_0^L \\frac{\\omega\\sigma_x(x)}{\\omega^2 + \\alpha^2} \\, dx$$\nThe term $\\frac{\\omega}{\\omega^2 + \\alpha^2}$ is independent of $x$ and can be factored out of the integral. We are given the polynomial damping profile $\\sigma_x(x) = \\sigma_{\\max} (x/L)^m$.\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\frac{\\omega}{\\omega^2 + \\alpha^2} \\int_0^L \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m \\, dx$$\nEvaluating the integral of the spatial profile:\n$$\\int_0^L \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m \\, dx = \\frac{\\sigma_{\\max}}{L^m} \\int_0^L x^m \\, dx = \\frac{\\sigma_{\\max}}{L^m} \\left[\\frac{x^{m+1}}{m+1}\\right]_0^L = \\frac{\\sigma_{\\max}}{L^m} \\frac{L^{m+1}}{m+1} = \\frac{\\sigma_{\\max}L}{m+1}$$\nSubstituting this result back, we obtain the analytical expression for the total attenuation integral:\n$$\\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\} \\, dx = \\frac{\\sigma_{\\max}L}{m+1} \\frac{\\omega}{\\omega^2 + \\alpha^2}$$\nThe reflection amplitude $R(\\omega)$ due to the PML termination is given by the round-trip attenuation factor:\n$$R(\\omega) \\approx \\exp\\left(-2 k_0 \\int_0^L \\operatorname{Im}\\{s_x(x,\\omega)\\}\\,dx\\right)$$\nUsing $k_0 = \\omega/c$ and the expression for the integral, we get:\n$$R(\\omega) = \\exp\\left(-2 \\frac{\\omega}{c} \\left[\\frac{\\sigma_{\\max}L}{m+1} \\frac{\\omega}{\\omega^2 + \\alpha^2}\\right]\\right) = \\exp\\left(-\\frac{2\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)$$\nThis is the required closed-form expression for $R(\\omega)$. Since the argument of the exponential is real, $R(\\omega)$ is a real-valued function.\n\nThe second stage is to implement the optimization. We need to find the pair $(\\sigma_{\\max}, \\alpha)$ from a finite candidate set that minimizes the normalized integral reflection measure $J$:\n$$J(\\sigma_{\\max},\\alpha) = \\frac{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, |R(\\omega)|^2\\, d\\omega}{\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega)\\, d\\omega}$$\nThe weighting function is a Gaussian $W(\\omega) = \\exp\\left(-\\frac{(\\omega - \\omega_0)^2}{2 \\sigma_\\omega^2}\\right)$. Since $R(\\omega)$ is real, $|R(\\omega)|^2 = R(\\omega)^2$. The integrand in the numerator is $W(\\omega) R(\\omega)^2$.\n$$R(\\omega)^2 = \\left[\\exp\\left(-\\frac{2\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)\\right]^2 = \\exp\\left(-\\frac{4\\sigma_{\\max}L}{c(m+1)} \\frac{\\omega^2}{\\omega^2 + \\alpha^2}\\right)$$\nThe numerical procedure is as follows for each test case:\n$1$. The fixed parameters $c, L, m$ and the frequency parameters $f_{\\min}, f_{\\max}, f_0, \\Delta f$ are defined. Frequencies are converted to angular frequencies (rad/s) via $\\omega = 2\\pi f$. The candidate sets for $\\sigma_{\\max}$ and $\\alpha$ are also defined. Note that $\\sigma_\\omega = 2\\pi \\Delta f$.\n$2$. The denominator integral, $\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega) \\, d\\omega$, is computed. This value is constant for a given test case and does not depend on the PML parameters, so it is calculated only once.\n$3$. A grid search is performed over all candidate pairs $(\\sigma_{\\max}, \\alpha)$. For each pair:\n    a. The numerator integral, $\\int_{\\omega_{\\min}}^{\\omega_{\\max}} W(\\omega) R(\\omega)^2 \\, d\\omega$, is calculated. The integrand depends on the specific choice of $\\sigma_{\\max}$ and $\\alpha$.\n    b. The integrals are computed numerically using a robust quadrature method, such as `scipy.integrate.quad`.\n    c. The value of $J$ is calculated by dividing the numerator integral by the denominator integral.\n$4$. The pair $(\\sigma_{\\max}, \\alpha)$ that yields the smallest value of $J$ is identified, and this minimum $J$ value is recorded.\n$5$. The optimal parameters and the minimum $J$ are collected for all test cases and formatted into the required output string. The fixed value $\\kappa=1$ is included in the output as specified.\nThis procedure systemically evaluates the performance of each PML design and selects the best one according to the specified metric.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the CFS-PML optimization problem for a set of test cases.\n    It derives the reflection coefficient, defines a performance metric, and\n    searches a parameter space to find the optimal PML design.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"c\": 1500, \"L\": 0.02, \"m\": 3,\n            \"f_min\": 1000, \"f_max\": 50000, \"f_0\": 20000, \"delta_f\": 15000,\n            \"sigma_max_candidates\": [2e5, 5e5, 1e6],\n            \"alpha_candidates\": [2 * np.pi * 500, 2 * np.pi * 2000, 2 * np.pi * 5000]\n        },\n        # Case 2\n        {\n            \"c\": 343, \"L\": 0.05, \"m\": 3,\n            \"f_min\": 100, \"f_max\": 5000, \"f_0\": 1000, \"delta_f\": 800,\n            \"sigma_max_candidates\": [2e4, 5e4, 1e5],\n            \"alpha_candidates\": [0, 2 * np.pi * 100, 2 * np.pi * 500]\n        },\n        # Case 3\n        {\n            \"c\": 1500, \"L\": 0.005, \"m\": 3,\n            \"f_min\": 10000, \"f_max\": 200000, \"f_0\": 60000, \"delta_f\": 30000,\n            \"sigma_max_candidates\": [1e5, 2e5, 3e5],\n            \"alpha_candidates\": [2 * np.pi * 2000, 2 * np.pi * 10000]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        c = case[\"c\"]\n        L = case[\"L\"]\n        m = case[\"m\"]\n        sigma_max_candidates = case[\"sigma_max_candidates\"]\n        alpha_candidates = case[\"alpha_candidates\"]\n\n        # Convert frequencies from Hz to rad/s\n        omega_min = 2 * np.pi * case[\"f_min\"]\n        omega_max = 2 * np.pi * case[\"f_max\"]\n        omega_0 = 2 * np.pi * case[\"f_0\"]\n        sigma_omega = 2 * np.pi * case[\"delta_f\"]\n\n        # Define the Gaussian spectral weight W(omega)\n        def W(omega):\n            return np.exp(-(omega - omega_0)**2 / (2 * sigma_omega**2))\n\n        # Denominator integral is constant for the case\n        denominator_integral, _ = integrate.quad(W, omega_min, omega_max)\n\n        min_J = float('inf')\n        best_sigma_max = None\n        best_alpha = None\n\n        # Perform the grid search over the candidate parameters\n        for sigma_max in sigma_max_candidates:\n            for alpha in alpha_candidates:\n                # Pre-calculate the constant part of the exponent in R(omega)^2\n                pml_const = (4 * sigma_max * L) / (c * (m + 1))\n\n                # Define the integrand for the numerator\n                def numerator_integrand(omega):\n                    # Handle omega=0 and alpha=0 case to avoid 0/0\n                    if omega == 0 and alpha == 0:\n                        reflection_exponent_term = 1.0 # This limit is 1\n                    else:\n                        reflection_exponent_term = (omega**2) / (omega**2 + alpha**2)\n                    \n                    R_squared = np.exp(-pml_const * reflection_exponent_term)\n                    return W(omega) * R_squared\n                \n                # Calculate the numerator integral\n                numerator_integral, _ = integrate.quad(\n                    numerator_integrand, omega_min, omega_max, limit=100\n                )\n\n                # Calculate J\n                if denominator_integral > 0:\n                    current_J = numerator_integral / denominator_integral\n                else: \n                    # This case should not happen with the given parameters\n                    current_J = float('inf')\n\n                # Update if a new minimum is found\n                if current_J  min_J:\n                    min_J = current_J\n                    best_sigma_max = sigma_max\n                    best_alpha = alpha\n        \n        # kappa is fixed to 1\n        kappa = 1\n        results.append([best_sigma_max, kappa, best_alpha, min_J])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}