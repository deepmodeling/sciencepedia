{
    "hands_on_practices": [
        {
            "introduction": "非连续伽辽金（DG）方法的核心是在标准的“参考单元”上构建局部的多项式近似。本练习将探索如何构建一个理想的基，即正交归一基，并展示其对质量矩阵的关键影响，这极大地简化了计算。此练习还将理论积分与其通过高斯求积的实际数值计算联系起来，揭示了当使用足够高阶的求积法则时，数值结果可以精确匹配理论结果。",
            "id": "4140406",
            "problem": "考虑在间断伽辽金 (DG) 方法框架下，在一个单一参考单元$\\Omega_{\\mathrm{ref}}=[-1,1]$上提出的一维线性声学系统。设$\\Omega_{\\mathrm{ref}}$上的近似空间为最高$p$次多项式的张成空间，内积为标准的$L^{2}$内积，权重为单位权重，定义为$\\langle f,g\\rangle=\\int_{-1}^{1} f(x)\\,g(x)\\,\\mathrm{d}x$。单元质量矩阵的分量形式定义为$M_{ij}=\\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x$，其中$\\{\\phi_{n}\\}_{n=0}^{p}$是$\\Omega_{\\mathrm{ref}}$上的一个多项式基。\n\n从$L^{2}([-1,1])$中多项式逼近的基本性质出发，通过适当地标准化经典勒让德多项式$\\{P_{n}\\}_{n=0}^{p}$，在$\\Omega_{\\mathrm{ref}}$上构造一个标准正交基。然后，利用具有$q$个点的高斯-勒让德求积对于最高$2q-1$次的所有多项式被积函数都是精确的这一事实，确定当积分由一个足够丰富、对所有$i,j\\leq p$的乘积$\\phi_{i}\\phi_{j}$都精确的高斯-勒让德法则计算时，质量矩阵的精确对角元。\n\n您的推导必须从计算声学中一个有效的逼近理论基础出发，并且必须清楚地论证为什么所选择的标准化方法能够在$L^{2}([-1,1])$中产生一个标准正交集，以及为什么质量矩阵的对角元能被该求积法则精确地重现。最后，假设使用具有$q=p+1$个点的高斯-勒让德法则，给出一个对任何$n\\in\\{0,1,\\dots,p\\}$都有效的标准化基函数$\\phi_{n}(x)$和相应质量矩阵对角元$M_{nn}$的单一闭式解析表达式。\n\n将您的最终答案表示为一个包含两个条目的单行向量，即$\\phi_{n}(x)$的一般表达式和相应的$M_{nn}$。无需进行数值四舍五入，且不涉及物理单位。",
            "solution": "该问题要求在参考区间$\\Omega_{\\mathrm{ref}} = [-1,1]$上构造一个标准正交多项式基，并随后确定相应质量矩阵的对角元，其中矩阵元是使用特定的高斯-勒让德求积法则计算的。\n\n该框架是区间$[-1,1]$上的$L^{2}$空间，记为$L^{2}([-1,1])$，并配备内积$\\langle f,g\\rangle = \\int_{-1}^{1} f(x)g(x)\\,\\mathrm{d}x$。我们寻求一个最高$p$次多项式空间的基$\\{\\phi_{n}\\}_{n=0}^{p}$，该基关于此内积是标准正交的，即$\\langle \\phi_m, \\phi_n \\rangle = \\delta_{mn}$，其中$\\delta_{mn}$是克罗内克符号。\n\n我们从经典勒让德多项式$\\{P_{n}(x)\\}_{n=0}^{p}$开始。这些多项式构成了$[-1,1]$上多项式空间的一个正交基。它们的基本正交性质由下式给出：\n$$\n\\int_{-1}^{1} P_m(x) P_n(x) \\,\\mathrm{d}x = \\frac{2}{2n+1} \\delta_{mn}\n$$\n此性质表明，当$m \\neq n$时，这些多项式是正交的。当$m=n$时，该积分给出$P_n(x)$的$L^2$-范数的平方：\n$$\n\\|P_n\\|_{L^2}^2 = \\langle P_n, P_n \\rangle = \\int_{-1}^{1} P_n(x)^2 \\,\\mathrm{d}x = \\frac{2}{2n+1}\n$$\n为了构造一个标准正交基$\\{\\phi_n\\}$，我们必须对勒让德多项式进行标准化。一个标准正交函数$\\phi_n(x)$必须具有单位范数，即$\\|\\phi_n\\|_{L^2}=1$。我们将基函数定义为$\\phi_n(x) = c_n P_n(x)$，其中$c_n$是一个实值标准化常数。单位范数的条件是：\n$$\n\\langle \\phi_n, \\phi_n \\rangle = \\langle c_n P_n, c_n P_n \\rangle = c_n^2 \\langle P_n, P_n \\rangle = 1\n$$\n代入$\\langle P_n, P_n \\rangle$的已知值：\n$$\nc_n^2 \\left( \\frac{2}{2n+1} \\right) = 1\n$$\n求解$c_n$（通常取正根）得到标准化常数：\n$$\nc_n = \\sqrt{\\frac{2n+1}{2}}\n$$\n因此，答案的第一部分，即对任何$n \\in \\{0, 1, \\dots, p\\}$均成立的标准正交基函数的表达式为：\n$$\n\\phi_n(x) = \\sqrt{\\frac{2n+1}{2}} P_n(x)\n$$\n通过这种构造，集合$\\{\\phi_n(x)\\}_{n=0}^p$在$\\Omega_{\\mathrm{ref}}=[-1,1]$上是标准正交的。\n\n接下来，我们考虑单元质量矩阵$M$，其元素定义为$M_{ij} = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x)\\,\\mathrm{d}x$。根据内积的定义，这即是$M_{ij} = \\langle \\phi_i, \\phi_j \\rangle$。由于基$\\{\\phi_n\\}$是标准正交的，质量矩阵元的精确解析值为：\n$$\nM_{ij} = \\langle \\phi_i, \\phi_j \\rangle = \\delta_{ij}\n$$\n这意味着精确的质量矩阵是单位矩阵，其对角元对所有$n$均为$M_{nn} = 1$。\n\n问题指出，质量矩阵的积分是使用高斯-勒让德求积法则进行数值计算的。设数值计算得到的质量矩阵为$M^h$。一个具有$q$个点的高斯-勒让德求积法则将积分近似为$\\int_{-1}^{1} f(x)\\,\\mathrm{d}x \\approx \\sum_{k=1}^{q} w_k f(x_k)$，其中$x_k$是求积节点，$w_k$是相应的权重。该法则的一个关键性质是，它对于最高次为$2q-1$的任何多项式被积函数都是精确的。\n\n质量矩阵元$M_{ij}$的被积函数是乘积$\\phi_i(x)\\phi_j(x)$。由于$\\phi_n(x)$是一个$n$次多项式，乘积$\\phi_i(x)\\phi_j(x)$是一个$i+j$次多项式。在一个$p$次多项式逼近空间的背景下，索引$i$和$j$的范围是从$0$到$p$。被积函数的最大可能次数在$i=j=p$时取到，为$p+p=2p$。\n\n问题指定使用具有$q=p+1$个点的高斯-勒让德求积法则。此法则的精确度为$2q-1 = 2(p+1)-1 = 2p+1$。由于任何被积函数$\\phi_i(x)\\phi_j(x)$的最大次数为$2p$，且$2p+1 \\geq 2p$，所选的求积法则足够丰富，可以对所有$i,j \\in \\{0, 1, \\dots, p\\}$的每一个乘积$\\phi_i(x)\\phi_j(x)$进行精确积分。\n\n这意味着数值计算出的质量矩阵与精确的解析质量矩阵完全相同：\n$$\nM^h_{ij} = \\sum_{k=1}^{p+1} w_k \\phi_i(x_k)\\phi_j(x_k) = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x)\\,\\mathrm{d}x = M_{ij} = \\delta_{ij}\n$$\n因此，用此求积法则计算的质量矩阵的对角元精确地为：\n$$\nM_{nn} = 1\n$$\n这对任何$n \\in \\{0, 1, \\dots, p\\}$都成立，并且是所要求答案的第二部分。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{2n+1}{2}} P_n(x)  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在参考单元上完成计算后，我们需要一种方法将这些结果应用到计算网格中任意大小和位置的实际单元上。本练习将演示这一过程的基石：仿射映射。你将推导该映射如何系统地变换积分和导数，从而得出描述物理单元矩阵与参考单元矩阵之间关系的简单缩放法则。理解这种缩放对于任何基于参考单元策略的有限元或DG实现都至关重要。",
            "id": "4140399",
            "problem": "考虑一维线性声学方程，其定义在物理单元$\\Omega_{e} = [x_{L}, x_{R}]$上，以及一个在参考单元$\\hat{\\Omega} = [-1, 1]$上定义的多项式基$\\{\\hat{\\phi}_{i}(\\xi)\\}_{i=0}^{p}$。在非连续伽辽金（DG）方法中，$\\Omega_{e}$上的局部质量矩阵$M^{(e)}$和局部刚度矩阵$K^{(e)}$分别源自标准的$L^{2}$内积和$H^{1}$半范数双线性形式：\n$$\nM^{(e)}_{ij} = \\int_{\\Omega_{e}} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx, \\qquad\nK^{(e)}_{ij} = \\int_{\\Omega_{e}} \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x)\\,dx,\n$$\n其中$\\phi_{i}(x)$是通过从$\\hat{\\Omega}$到$\\Omega_{e}$的仿射映射定义的映射基函数，即$\\phi_{i}(x) = \\hat{\\phi}_{i}(\\xi(x))$。\n\n从基本原理出发——即仿射映射的定义、积分的变量替换公式和微分的链式法则——推导将$\\hat{\\Omega}$映至$\\Omega_{e}$的仿射映射$x(\\xi)$并定义其雅可比$J$。使用此映射将$M^{(e)}_{ij}$和$K^{(e)}_{ij}$表示为在$\\hat{\\Omega}$上的积分，并证明存在与下标$i$和$j$无关的常数$c_{M}$和$c_{K}$，使得\n$$\nM^{(e)}_{ij} = c_{M}\\,\\hat{M}_{ij}, \\qquad K^{(e)}_{ij} = c_{K}\\,\\hat{K}_{ij},\n$$\n其中\n$$\n\\hat{M}_{ij} = \\int_{-1}^{1} \\hat{\\phi}_{i}(\\xi)\\,\\hat{\\phi}_{j}(\\xi)\\,d\\xi, \\qquad\n\\hat{K}_{ij} = \\int_{-1}^{1} \\partial_{\\xi}\\hat{\\phi}_{i}(\\xi)\\,\\partial_{\\xi}\\hat{\\phi}_{j}(\\xi)\\,d\\xi.\n$$\n\n作为具体检验，取$p=1$，基函数为$\\hat{\\phi}_{0}(\\xi) = 1$和$\\hat{\\phi}_{1}(\\xi) = \\xi$，显式计算参考矩阵$\\hat{M}$和$\\hat{K}$，并验证由该映射引起的相应物理矩阵$M^{(e)}$和$K^{(e)}$的缩放关系。\n\n作为最终答案，请以雅可比$J$表示的单个行矩阵形式提供缩放因子对$(c_{M}, c_{K})$。无需数值取整。最终答案必须是单个闭式解析表达式。",
            "solution": "推导过程首先建立仿射映射及其性质，然后应用这些性质将物理质量和刚度矩阵的积分从物理单元$\\Omega_{e}$变换到参考单元$\\hat{\\Omega}$。\n\n**1. 仿射映射与雅可比**\n\n从参考坐标$\\xi$到物理坐标$x$的仿射映射是一个形如下式的线性函数$x(\\xi) = a\\xi + b$。我们要求该映射将参考单元$\\hat{\\Omega} = [-1, 1]$的端点映至物理单元$\\Omega_{e} = [x_{L}, x_{R}]$的端点，这给出两个条件：\n1.  $x(-1) = -a + b = x_{L}$\n2.  $x(1) = a + b = x_{R}$\n\n求解这个关于$a$和$b$的线性方程组，我们得到$a = \\frac{x_{R} - x_{L}}{2}$和$b = \\frac{x_{L} + x_{R}}{2}$。因此，映射为：\n$$x(\\xi) = \\left(\\frac{x_{R} - x_{L}}{2}\\right)\\xi + \\frac{x_{L} + x_{R}}{2}$$\n此变换的雅可比$J$是$x$关于$\\xi$的导数，由于映射是仿射的，它是一个常数：\n$$J = \\frac{dx}{d\\xi} = \\frac{x_{R} - x_{L}}{2}$$\n注意，物理单元的长度为$h_{e} = x_{R} - x_{L}$，所以$J = \\frac{h_{e}}{2}$。\n\n**2. 质量矩阵的变换**\n\n我们通过变量替换将物理质量矩阵$M^{(e)}_{ij} = \\int_{x_L}^{x_R} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$的积分变换到参考单元上。利用$\\phi_{i}(x(\\xi)) = \\hat{\\phi}_{i}(\\xi)$和微分元变换$dx = \\frac{dx}{d\\xi}d\\xi = J\\,d\\xi$，我们得到：\n$$M^{(e)}_{ij} = \\int_{-1}^{1} \\hat{\\phi}_{i}(\\xi)\\,\\hat{\\phi}_{j}(\\xi)\\,(J\\,d\\xi) = J \\int_{-1}^{1} \\hat{\\phi}_{i}(\\xi)\\,\\hat{\\phi}_{j}(\\xi)\\,d\\xi$$\n由于右侧的积分正是参考质量矩阵$\\hat{M}_{ij}$的定义，我们有：\n$$M^{(e)}_{ij} = J\\,\\hat{M}_{ij}$$\n因此，缩放因子$c_{M} = J$。\n\n**3. 刚度矩阵的变换**\n\n对于刚度矩阵$K^{(e)}_{ij} = \\int_{x_L}^{x_R} \\frac{d\\phi_{i}}{dx}(x)\\,\\frac{d\\phi_{j}}{dx}(x)\\,dx$，我们首先使用链式法则变换导数：\n$$\\frac{d\\phi_{i}}{dx} = \\frac{d\\hat{\\phi}_{i}}{d\\xi} \\frac{d\\xi}{dx} = \\frac{d\\hat{\\phi}_{i}}{d\\xi} \\left(\\frac{dx}{d\\xi}\\right)^{-1} = \\frac{1}{J} \\frac{d\\hat{\\phi}_{i}}{d\\xi}$$\n将此代入刚度矩阵的积分中，并应用相同的变量替换：\n$$K^{(e)}_{ij} = \\int_{x_L}^{x_R} \\left( \\frac{1}{J} \\frac{d\\hat{\\phi}_{i}}{d\\xi} \\right) \\left( \\frac{1}{J} \\frac{d\\hat{\\phi}_{j}}{d\\xi} \\right) dx = \\frac{1}{J^2} \\int_{-1}^{1} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi)\\,\\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi)\\,(J\\,d\\xi)$$\n一个因子$J$被消去，得到：\n$$K^{(e)}_{ij} = \\frac{1}{J} \\int_{-1}^{1} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi)\\,\\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi)\\,d\\xi$$\n右侧的积分是参考刚度矩阵$\\hat{K}_{ij}$的定义。因此：\n$$K^{(e)}_{ij} = \\frac{1}{J}\\,\\hat{K}_{ij}$$\n这表明缩放因子$c_{K} = \\frac{1}{J}$。\n\n**4. 具体检验**\n\n对于$p=1$，参考基函数为$\\hat{\\phi}_{0}(\\xi) = 1$和$\\hat{\\phi}_{1}(\\xi) = \\xi$，其导数为$\\partial_{\\xi}\\hat{\\phi}_{0}(\\xi) = 0$和$\\partial_{\\xi}\\hat{\\phi}_{1}(\\xi) = 1$。\n-   **参考矩阵计算**：\n    $$ \\hat{M} = \\begin{pmatrix} \\int_{-1}^1 1\\cdot 1\\,d\\xi  \\int_{-1}^1 1\\cdot\\xi\\,d\\xi \\\\ \\int_{-1}^1 \\xi\\cdot 1\\,d\\xi  \\int_{-1}^1 \\xi\\cdot\\xi\\,d\\xi \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  2/3 \\end{pmatrix} $$\n    $$ \\hat{K} = \\begin{pmatrix} \\int_{-1}^1 0\\cdot 0\\,d\\xi  \\int_{-1}^1 0\\cdot 1\\,d\\xi \\\\ \\int_{-1}^1 1\\cdot 0\\,d\\xi  \\int_{-1}^1 1\\cdot 1\\,d\\xi \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  2 \\end{pmatrix} $$\n-   **缩放关系验证**：\n    根据我们推导的缩放关系，我们期望$M^{(e)} = J \\hat{M} = \\begin{pmatrix} 2J  0 \\\\ 0  2J/3 \\end{pmatrix}$和$K^{(e)} = \\frac{1}{J} \\hat{K} = \\begin{pmatrix} 0  0 \\\\ 0  2/J \\end{pmatrix}$。\n    直接在物理单元上计算：映射后的基函数为$\\phi_{0}(x) = 1$和$\\phi_{1}(x) = \\xi(x) = (x - (x_L+x_R)/2)/J$。它们的导数为$\\partial_{x}\\phi_{0}(x) = 0$和$\\partial_{x}\\phi_{1}(x) = 1/J$。\n    $$ M^{(e)}_{00} = \\int_{x_L}^{x_R} 1 \\cdot 1 \\,dx = x_R-x_L = 2J $$\n    $$ K^{(e)}_{11} = \\int_{x_L}^{x_R} \\left(\\frac{1}{J}\\right)^2 \\,dx = \\frac{1}{J^2}(x_R-x_L) = \\frac{2J}{J^2} = \\frac{2}{J} $$\n    具体检验与我们的推导结果相符。\n\n综上所述，缩放因子对$(c_{M}, c_{K})$是$(J, \\frac{1}{J})$。",
            "answer": "$$\\boxed{\\begin{pmatrix} J  \\frac{1}{J} \\end{pmatrix}}$$"
        }
    ]
}