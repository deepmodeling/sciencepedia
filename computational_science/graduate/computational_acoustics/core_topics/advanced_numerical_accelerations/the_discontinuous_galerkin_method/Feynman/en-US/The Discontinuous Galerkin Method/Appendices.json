{
    "hands_on_practices": [
        {
            "introduction": "The power of the Discontinuous Galerkin method lies in its element-wise construction, which often begins on a simple, standardized reference element. This practice explores the foundational choice of basis functions within this reference space. By constructing an orthonormal basis from Legendre polynomials, you will see firsthand how this choice leads to a maximally simplified (diagonal) mass matrix, a key property that facilitates efficient computation .",
            "id": "4140406",
            "problem": "Consider the one-dimensional linear acoustics system posed on a single reference element $\\Omega_{\\mathrm{ref}}=[-1,1]$ within the Discontinuous Galerkin (DG) method framework. Let the approximation space on $\\Omega_{\\mathrm{ref}}$ be the span of polynomials up to degree $p$, and let the inner product be the standard $L^{2}$ inner product with unit weight, defined by $\\langle f,g\\rangle=\\int_{-1}^{1} f(x)\\,g(x)\\,\\mathrm{d}x$. The elemental mass matrix is defined componentwise by $M_{ij}=\\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x$, where $\\{\\phi_{n}\\}_{n=0}^{p}$ is a polynomial basis on $\\Omega_{\\mathrm{ref}}$.\n\nStarting from fundamental properties of polynomial approximation in $L^{2}([-1,1])$, construct an orthonormal basis on $\\Omega_{\\mathrm{ref}}$ by appropriately normalizing the classical Legendre polynomials $\\{P_{n}\\}_{n=0}^{p}$. Then, using the fact that Gauss–Legendre quadrature with $q$ points is exact for any polynomial integrand of degree up to $2q-1$, determine the exact diagonal entries of the mass matrix when the integral is evaluated by a Gauss–Legendre rule that is sufficiently rich to be exact for all products $\\phi_{i}\\phi_{j}$ with $i,j\\leq p$.\n\nYour derivation must begin from a valid approximation-theoretic base in computational acoustics and must clearly justify why the chosen normalization yields an orthonormal set in $L^{2}([-1,1])$ and why the diagonal mass matrix entries are reproduced exactly by the quadrature. Conclude by giving a single closed-form analytic expression for the normalized basis function $\\phi_{n}(x)$ and the corresponding diagonal mass entry $M_{nn}$, valid for any $n\\in\\{0,1,\\dots,p\\}$, assuming a Gauss–Legendre rule with $q=p+1$ points is used.\n\nExpress your final answer as a single row vector containing two entries, the general expression for $\\phi_{n}(x)$ and the corresponding $M_{nn}$. No numerical rounding is required, and no physical units apply.",
            "solution": "The problem requires the construction of an orthonormal polynomial basis on the reference interval $\\Omega_{\\mathrm{ref}} = [-1,1]$ and the subsequent determination of the diagonal entries of the corresponding mass matrix, where the matrix entries are computed using a specific Gauss-Legendre quadrature rule.\n\nThe framework is the $L^{2}$ space on the interval $[-1,1]$, denoted $L^{2}([-1,1])$, equipped with the inner product $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)g(x)\\,\\mathrm{d}x$. We seek a basis $\\{\\phi_{n}\\}_{n=0}^{p}$ for the space of polynomials of degree up to $p$ that is orthonormal with respect to this inner product, meaning $\\langle \\phi_m, \\phi_n \\rangle = \\delta_{mn}$, where $\\delta_{mn}$ is the Kronecker delta.\n\nWe begin with the classical Legendre polynomials, $\\{P_{n}(x)\\}_{n=0}^{p}$. These polynomials form an orthogonal basis for the space of polynomials on $[-1,1]$. Their fundamental orthogonality property is given by:\n$$\n\\int_{-1}^{1} P_m(x) P_n(x) \\,\\mathrm{d}x = \\frac{2}{2n+1} \\delta_{mn}\n$$\nThis property shows that for $m \\neq n$, the polynomials are orthogonal. For $m=n$, the integral gives the square of the $L^2$-norm of $P_n(x)$:\n$$\n\\|P_n\\|_{L^2}^2 = \\langle P_n, P_n \\rangle = \\int_{-1}^{1} P_n(x)^2 \\,\\mathrm{d}x = \\frac{2}{2n+1}\n$$\nTo construct an orthonormal basis $\\{\\phi_n\\}$, we must normalize the Legendre polynomials. An orthonormal function $\\phi_n(x)$ must have a unit norm, i.e., $\\|\\phi_n\\|_{L^2}=1$. We define our basis functions as $\\phi_n(x) = c_n P_n(x)$, where $c_n$ is a real-valued normalization constant. The condition for unit norm is:\n$$\n\\langle \\phi_n, \\phi_n \\rangle = \\langle c_n P_n, c_n P_n \\rangle = c_n^2 \\langle P_n, P_n \\rangle = 1\n$$\nSubstituting the known value of $\\langle P_n, P_n \\rangle$:\n$$\nc_n^2 \\left( \\frac{2}{2n+1} \\right) = 1\n$$\nSolving for $c_n$ (conventionally taking the positive root) gives the normalization constant:\n$$\nc_n = \\sqrt{\\frac{2n+1}{2}}\n$$\nTherefore, the first part of the answer, the expression for the orthonormal basis functions valid for any $n \\in \\{0, 1, \\dots, p\\}$, is:\n$$\n\\phi_n(x) = \\sqrt{\\frac{2n+1}{2}} P_n(x)\n$$\nBy this construction, the set $\\{\\phi_n(x)\\}_{n=0}^p$ is orthonormal on $\\Omega_{\\mathrm{ref}}=[-1,1]$.\n\nNext, we consider the elemental mass matrix $M$, whose entries are defined by $M_{ij} = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x)\\,\\mathrm{d}x$. By the definition of the inner product, this is $M_{ij} = \\langle \\phi_i, \\phi_j \\rangle$. Since the basis $\\{\\phi_n\\}$ is orthonormal, the exact analytical value of the mass matrix entries is:\n$$\nM_{ij} = \\langle \\phi_i, \\phi_j \\rangle = \\delta_{ij}\n$$\nThis means the exact mass matrix is the identity matrix, and its diagonal entries are $M_{nn} = 1$ for all $n$.\n\nThe problem states that the integral for the mass matrix is evaluated numerically using a Gauss-Legendre quadrature rule. Let the numerically computed mass matrix be denoted by $M^h$. A Gauss-Legendre rule with $q$ points approximates an integral as $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x \\approx \\sum_{k=1}^{q} w_k f(x_k)$, where $x_k$ are the quadrature nodes and $w_k$ are the corresponding weights. A key property of this rule is that it is exact for any polynomial integrand of degree up to $2q-1$.\n\nThe integrand for the mass matrix entry $M_{ij}$ is the product $\\phi_i(x)\\phi_j(x)$. Since $\\phi_n(x)$ is a polynomial of degree $n$, the product $\\phi_i(x)\\phi_j(x)$ is a polynomial of degree $i+j$. In the context of a polynomial approximation space of degree $p$, the indices $i$ and $j$ range from $0$ to $p$. The maximum possible degree of the integrand is for $i=j=p$, which is $p+p=2p$.\n\nThe problem specifies the use of a Gauss-Legendre rule with $q=p+1$ points. The degree of exactness for this rule is $2q-1 = 2(p+1)-1 = 2p+1$. Since the maximum degree of any integrand $\\phi_i(x)\\phi_j(x)$ is $2p$, and $2p+1 \\geq 2p$, the chosen quadrature rule is sufficiently rich to integrate every product $\\phi_i(x)\\phi_j(x)$ exactly for all $i,j \\in \\{0, 1, \\dots, p\\}$.\n\nThis implies that the numerically computed mass matrix is identical to the exact analytical mass matrix:\n$$\nM^h_{ij} = \\sum_{k=1}^{p+1} w_k \\phi_i(x_k)\\phi_j(x_k) = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x)\\,\\mathrm{d}x = M_{ij} = \\delta_{ij}\n$$\nConsequently, the diagonal entries of the mass matrix computed with this quadrature rule are exactly:\n$$\nM_{nn} = 1\n$$\nThis holds for any $n \\in \\{0, 1, \\dots, p\\}$, and it is the second part of the required answer.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{2n+1}{2}} P_n(x) & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While computations are simplified on a reference element, our physical problems exist on arbitrarily shaped and sized domains. This exercise bridges that gap by deriving the affine mapping that connects the idealized reference element to a physical one. You will discover how the geometric properties of an element, encapsulated in the mapping's Jacobian, systematically scale the fundamental mass and stiffness matrices, a cornerstone principle for any practical finite element or DG implementation .",
            "id": "4140399",
            "problem": "Consider the one-dimensional linear acoustics equations on a physical element $\\Omega_{e} = [x_{L}, x_{R}]$, and a polynomial basis $\\{\\hat{\\phi}_{i}(\\xi)\\}_{i=0}^{p}$ defined on the reference element $\\hat{\\Omega} = [-1, 1]$. In the Discontinuous Galerkin (DG) method, the local mass matrix $M^{(e)}$ and the local stiffness matrix $K^{(e)}$ on $\\Omega_{e}$ arise from the standard $L^{2}$ inner product and the $H^{1}$ seminorm bilinear form, respectively:\n$$\nM^{(e)}_{ij} = \\int_{\\Omega_{e}} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx, \\qquad\nK^{(e)}_{ij} = \\int_{\\Omega_{e}} \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x)\\,dx,\n$$\nwhere $\\phi_{i}(x)$ are the mapped basis functions defined by $\\phi_{i}(x) = \\hat{\\phi}_{i}(\\xi(x))$ via an affine mapping from $\\hat{\\Omega}$ to $\\Omega_{e}$.\n\nStarting from first principles—namely, the definition of an affine mapping, the change-of-variables formula for integrals, and the chain rule for differentiation—derive the affine mapping $x(\\xi)$ that sends $\\hat{\\Omega}$ to $\\Omega_{e}$ and define its Jacobian $J$. Use this mapping to express $M^{(e)}_{ij}$ and $K^{(e)}_{ij}$ in terms of integrals over $\\hat{\\Omega}$ and show that there exist constants $c_{M}$ and $c_{K}$, independent of the indices $i$ and $j$, such that\n$$\nM^{(e)}_{ij} = c_{M}\\,\\hat{M}_{ij}, \\qquad K^{(e)}_{ij} = c_{K}\\,\\hat{K}_{ij},\n$$\nwhere\n$$\n\\hat{M}_{ij} = \\int_{-1}^{1} \\hat{\\phi}_{i}(\\xi)\\,\\hat{\\phi}_{j}(\\xi)\\,d\\xi, \\qquad\n\\hat{K}_{ij} = \\int_{-1}^{1} \\partial_{\\xi}\\hat{\\phi}_{i}(\\xi)\\,\\partial_{\\xi}\\hat{\\phi}_{j}(\\xi)\\,d\\xi.\n$$\n\nAs a concrete check, take $p=1$ with the basis $\\hat{\\phi}_{0}(\\xi) = 1$ and $\\hat{\\phi}_{1}(\\xi) = \\xi$, compute the reference matrices $\\hat{M}$ and $\\hat{K}$ and verify the scaling of the corresponding physical matrices $M^{(e)}$ and $K^{(e)}$ induced by the mapping.\n\nProvide, as your final answer, the pair of scaling factors $(c_{M}, c_{K})$ as a single row matrix in terms of the Jacobian $J$. No numerical rounding is required. The final answer must be a single closed-form analytic expression.",
            "solution": "The derivation begins by establishing the affine mapping and its Jacobian, then applying these to transform the integrals for the physical mass and stiffness matrices from the physical element $\\Omega_{e}$ to the reference element $\\hat{\\Omega}$.\n\n**1. Affine Mapping and Jacobian**\n\nAn affine mapping from the reference coordinate $\\xi \\in [-1, 1]$ to the physical coordinate $x \\in [x_L, x_R]$ is a linear function of the form $x(\\xi) = a\\xi + b$. The constants $a$ and $b$ are found by enforcing that the endpoints map correctly:\n1.  $x(-1) = x_{L} \\implies -a + b = x_{L}$\n2.  $x(1) = x_{R} \\implies a + b = x_{R}$\n\nSolving this system gives $a = \\frac{x_{R} - x_{L}}{2}$ and $b = \\frac{x_{L} + x_{R}}{2}$. The Jacobian of this transformation, $J$, is the derivative of $x$ with respect to $\\xi$:\n$$J = \\frac{dx}{d\\xi} = a = \\frac{x_{R} - x_{L}}{2}$$\nSince the mapping is affine, the Jacobian $J$ is constant over the element. It represents half the length of the physical element. The inverse derivative is $\\frac{d\\xi}{dx} = \\frac{1}{J}$.\n\n**2. Transformation of the Mass Matrix**\n\nThe physical mass matrix $M^{(e)}$ is defined by the integral over the physical element $\\Omega_e$. We use the change of variables formula for integration, where the differential element transforms as $dx = \\frac{dx}{d\\xi}d\\xi = J\\,d\\xi$, and the integration limits change from $[x_{L}, x_{R}]$ to $[-1, 1]$. The basis functions are related by $\\phi_{i}(x(\\xi)) = \\hat{\\phi}_{i}(\\xi)$.\n$$\nM^{(e)}_{ij} = \\int_{x_L}^{x_R} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx = \\int_{-1}^{1} \\phi_{i}(x(\\xi))\\,\\phi_{j}(x(\\xi))\\,(J\\,d\\xi)\n$$\nSubstituting the basis function relationship and factoring out the constant Jacobian:\n$$\nM^{(e)}_{ij} = J \\int_{-1}^{1} \\hat{\\phi}_{i}(\\xi)\\,\\hat{\\phi}_{j}(\\xi)\\,d\\xi\n$$\nThe remaining integral is precisely the definition of the reference mass matrix entry, $\\hat{M}_{ij}$. Thus, we have the scaling relationship:\n$$\nM^{(e)}_{ij} = J\\,\\hat{M}_{ij}\n$$\nThis shows that the scaling factor for the mass matrix is $c_{M} = J$.\n\n**3. Transformation of the Stiffness Matrix**\n\nThe physical stiffness matrix $K^{(e)}$ involves derivatives with respect to the physical coordinate $x$. We first transform these derivatives using the chain rule:\n$$\n\\frac{d\\phi_{i}}{dx} = \\frac{d\\hat{\\phi}_{i}}{d\\xi} \\frac{d\\xi}{dx} = \\frac{1}{J} \\frac{d\\hat{\\phi}_{i}}{d\\xi}\n$$\nNow we substitute this into the stiffness matrix definition and apply the same change of variables for the integral:\n$$\nK^{(e)}_{ij} = \\int_{x_L}^{x_R} \\left( \\frac{1}{J} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi(x)) \\right) \\left( \\frac{1}{J} \\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi(x)) \\right) dx = \\frac{1}{J^2} \\int_{x_L}^{x_R} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi(x))\\,\\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi(x))\\,dx\n$$\nApplying the change of variables $dx = J\\,d\\xi$:\n$$\nK^{(e)}_{ij} = \\frac{1}{J^2} \\int_{-1}^{1} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi)\\,\\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi)\\,(J\\,d\\xi)\n$$\nOne factor of $J$ cancels, leaving:\n$$\nK^{(e)}_{ij} = \\frac{1}{J} \\int_{-1}^{1} \\frac{d\\hat{\\phi}_{i}}{d\\xi}(\\xi)\\,\\frac{d\\hat{\\phi}_{j}}{d\\xi}(\\xi)\\,d\\xi\n$$\nThe remaining integral is the definition of the reference stiffness matrix entry, $\\hat{K}_{ij}$. Therefore:\n$$\nK^{(e)}_{ij} = \\frac{1}{J}\\,\\hat{K}_{ij}\n$$\nThis shows that the scaling factor for the stiffness matrix is $c_{K} = \\frac{1}{J}$.\n\n**Conclusion**\nThe scaling factors relating the physical element matrices to the reference element matrices are $c_{M} = J$ and $c_{K} = \\frac{1}{J}$. The pair $(c_{M}, c_{K})$ is $(J, \\frac{1}{J})$.",
            "answer": "$$\\boxed{\\begin{pmatrix} J & \\frac{1}{J} \\end{pmatrix}}$$"
        },
        {
            "introduction": "With the foundational tools of reference elements and mappings in hand, we can now assemble a complete numerical scheme for a time-dependent problem. This practice guides you through the construction of a DG method for the fundamental linear advection equation, from its weak formulation to the final semi-discrete system of ordinary differential equations. You will see how element-local matrices are coupled with numerical fluxes at interfaces to create a full, dynamic model, providing a blueprint for applying DG to more complex conservation laws .",
            "id": "4140358",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + c\\,u_{x} = 0$ on a periodic interval $[0,L]$ with constant wave speed $c>0$. Partition the domain into $N$ uniform elements $\\{K_{e}\\}_{e=1}^{N}$ of size $h=L/N$, and on each element map the reference coordinate $\\xi \\in [-1,1]$ to the physical coordinate via $x(\\xi) = x_{e} + \\frac{h}{2}\\,\\xi$. Seek a Discontinuous Galerkin (DG) approximation of the form $u_{h}|_{K_{e}}(x(\\xi),t) = \\sum_{i=1}^{2} U_{e,i}(t)\\,\\ell_{i}(\\xi)$ with local nodal basis functions $\\ell_{1}(\\xi) = \\frac{1-\\xi}{2}$ and $\\ell_{2}(\\xi) = \\frac{1+\\xi}{2}$. Use the same basis for the test functions. Start from the conservation form $u_{t} + (c u)_{x} = 0$, derive the weak form on $K_{e}$, integrate the flux term by parts, and enforce inter-element coupling with the upwind numerical flux $\\widehat{f}(u^{-},u^{+}) = c\\,u^{-}$, where $u^{-}$ denotes the value taken from the left of an interface. \n\n(a) Derive the semi-discrete element-wise system in the form $M_{e}\\,\\dot{\\boldsymbol{U}}_{e} = c\\,S_{e}\\,\\boldsymbol{U}_{e} - c\\,\\boldsymbol{b}_{e}$, where $\\boldsymbol{U}_{e} = (U_{e,1},U_{e,2})^{\\top}$, and identify explicitly the element mass matrix $M_{e}$, the element volume (derivative) matrix $S_{e}$, and the surface flux contribution $\\boldsymbol{b}_{e}$ in terms of traces at the left and right faces of $K_{e}$. \n\n(b) Specialize $\\boldsymbol{b}_{e}$ using the upwind rule for $c>0$ to eliminate numerical traces in favor of degrees of freedom from $K_{e}$ and its immediate left neighbor $K_{e-1}$. \n\n(c) Multiply by $M_{e}^{-1}$ to write $\\dot{\\boldsymbol{U}}_{e}$ as a linear operator applied to the vector $(U_{e-1,2},\\,U_{e,1},\\,U_{e,2})^{\\top}$. Report the final compact $2\\times 3$ operator matrix $A_{e}$ such that $\\dot{\\boldsymbol{U}}_{e} = A_{e}\\,(U_{e-1,2},\\,U_{e,1},\\,U_{e,2})^{\\top}$, expressed symbolically in terms of $c$ and $h$. \n\nYour final answer must be the single analytic expression for this $2\\times 3$ matrix. No rounding is required and no units are necessary.",
            "solution": "We start by deriving the weak formulation. For an arbitrary test function $v_h$, we multiply the advection equation by $v_h$ and integrate over an element $K_e$:\n$$\n\\int_{K_e} v_h u_t \\,dx + \\int_{K_e} v_h (c u)_x \\,dx = 0\n$$\nApplying integration by parts to the second term yields:\n$$\n\\int_{K_e} v_h u_t \\,dx - \\int_{K_e} (v_h)_x c u \\,dx + [v_h c u]_{x_{e-1/2}}^{x_{e+1/2}} = 0\n$$\nwhere $x_{e-1/2}$ and $x_{e+1/2}$ are the left and right boundaries of $K_e$. In a DG context, the boundary flux $cu$ is replaced by a numerical flux $\\widehat{f}$. Let $\\boldsymbol{n}$ be the outward unit normal. The boundary term is $\\int_{\\partial K_e} v_h \\widehat{f} \\cdot \\boldsymbol{n} \\,ds$. In 1D, this simplifies to $v_h(x_{e+1/2}) \\widehat{f}(x_{e+1/2}) - v_h(x_{e-1/2}) \\widehat{f}(x_{e-1/2})$. The problem specifies the upwind flux $\\widehat{f} = c u^{-}$, where $u^{-}$ is the value from the left of the interface.\nThe weak form becomes:\n$$\n\\int_{K_e} v_h u_t \\,dx = \\int_{K_e} (v_h)_x c u \\,dx - c(v_h(x_{e+1/2}) u^{-}(x_{e+1/2}) - v_h(x_{e-1/2}) u^{-}(x_{e-1/2}))\n$$\nNow we substitute the basis expansions $u_h = \\sum_j U_{e,j}(t) \\ell_j(\\xi)$ and $v_h = \\ell_i(\\xi)$, and perform a change of variables to the reference element $\\xi \\in [-1,1]$. The mapping gives $dx = \\frac{h}{2}d\\xi$ and $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}$.\n$$\n\\sum_j \\dot{U}_{e,j} \\int_{-1}^1 \\ell_i \\ell_j (\\frac{h}{2}d\\xi) = c \\sum_j U_{e,j} \\int_{-1}^1 (\\frac{2}{h}\\ell_i') \\ell_j (\\frac{h}{2}d\\xi) - c(\\ell_i(1)u^{-}(x_{e+1/2}) - \\ell_i(-1)u^{-}(x_{e-1/2}))\n$$\nThis is the semi-discrete system $M_e \\dot{\\boldsymbol{U}}_e = c S_e \\boldsymbol{U}_e - c \\boldsymbol{b}_e$.\n\n**Part (a): Identify Matrices and Vector**\nThe matrices are defined by integrals over the reference element:\n$M_{e,ij} = \\frac{h}{2}\\int_{-1}^1 \\ell_i \\ell_j d\\xi$, $S_{e,ij} = \\int_{-1}^1 \\ell_i' \\ell_j d\\xi$.\nLet's compute them for $\\ell_1(\\xi) = \\frac{1-\\xi}{2}, \\ell_2(\\xi) = \\frac{1+\\xi}{2}$:\n$$\nM_e = \\frac{h}{2} \\begin{pmatrix} 2/3 & 1/3 \\\\ 1/3 & 2/3 \\end{pmatrix} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n$$\nS_e = \\begin{pmatrix} -1/2 & -1/2 \\\\ 1/2 & 1/2 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} -1 & -1 \\\\ 1 & 1 \\end{pmatrix}\n$$\nThe boundary vector components are $\\boldsymbol{b}_{e,i} = \\ell_i(1)u^{-}(x_{e+1/2}) - \\ell_i(-1)u^{-}(x_{e-1/2})$.\nFor $i=1$ ($v_h = \\ell_1$), $\\ell_1(1)=0, \\ell_1(-1)=1$, so $\\boldsymbol{b}_{e,1} = -u^{-}(x_{e-1/2})$.\nFor $i=2$ ($v_h = \\ell_2$), $\\ell_2(1)=1, \\ell_2(-1)=0$, so $\\boldsymbol{b}_{e,2} = u^{-}(x_{e+1/2})$.\nThus, $\\boldsymbol{b}_e = \\begin{pmatrix} -u^{-}(x_{e-1/2}) \\\\ u^{-}(x_{e+1/2}) \\end{pmatrix}$.\n\n**Part (b): Specialize Boundary Vector**\nWith upwinding for $c>0$, the flux is determined by the state to the left of the interface.\nThe value to the left of the right boundary of $K_e$ is the value from $K_e$ itself at its right node ($\\xi=1$): $u^{-}(x_{e+1/2}) = u_h(x_{e+1/2}) = U_{e,2}$.\nThe value to the left of the left boundary of $K_e$ is the value from the neighboring element $K_{e-1}$ at its right node ($\\xi=1$): $u^{-}(x_{e-1/2}) = u_{h,e-1}(x_{e-1/2}) = U_{e-1,2}$.\nSubstituting these into $\\boldsymbol{b}_e$ gives:\n$$\n\\boldsymbol{b}_e = \\begin{pmatrix} -U_{e-1,2} \\\\ U_{e,2} \\end{pmatrix}\n$$\n\n**Part (c): Derive Operator Matrix $A_e$**\nWe need to solve for $\\dot{\\boldsymbol{U}}_e = M_e^{-1} (c S_e \\boldsymbol{U}_e - c \\boldsymbol{b}_e)$.\nFirst, find the inverse of the mass matrix:\n$$\nM_e^{-1} = \\left(\\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\\right)^{-1} = \\frac{6}{h} \\frac{1}{3} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} = \\frac{2}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\nNow, substitute everything into the equation for $\\dot{\\boldsymbol{U}}_e$:\n$$\n\\dot{\\boldsymbol{U}}_e = \\frac{c}{h} \\cdot 2 \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\left( \\frac{1}{2}\\begin{pmatrix} -1 & -1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} U_{e,1} \\\\ U_{e,2} \\end{pmatrix} - \\begin{pmatrix} -U_{e-1,2} \\\\ U_{e,2} \\end{pmatrix} \\right)\n$$\nEvaluate the term in the large parentheses:\n$$\n\\begin{pmatrix} -0.5 U_{e,1} - 0.5 U_{e,2} + U_{e-1,2} \\\\ 0.5 U_{e,1} + 0.5 U_{e,2} - U_{e,2} \\end{pmatrix} = \\begin{pmatrix} U_{e-1,2} - 0.5 U_{e,1} - 0.5 U_{e,2} \\\\ 0.5 U_{e,1} - 0.5 U_{e,2} \\end{pmatrix}\n$$\nNow pre-multiply by $2 \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$:\n$$\n2 \\begin{pmatrix} 2(U_{e-1,2} - 0.5 U_{e,1} - 0.5 U_{e,2}) - (0.5 U_{e,1} - 0.5 U_{e,2}) \\\\ -(U_{e-1,2} - 0.5 U_{e,1} - 0.5 U_{e,2}) + 2(0.5 U_{e,1} - 0.5 U_{e,2}) \\end{pmatrix}\n$$\n$$\n= 2 \\begin{pmatrix} 2U_{e-1,2} - 1.5 U_{e,1} - 0.5 U_{e,2} \\\\ -U_{e-1,2} + 1.5 U_{e,1} - 0.5 U_{e,2} \\end{pmatrix} = \\begin{pmatrix} 4U_{e-1,2} - 3 U_{e,1} - U_{e,2} \\\\ -2U_{e-1,2} + 3 U_{e,1} - U_{e,2} \\end{pmatrix}\n$$\nSo, $\\dot{\\boldsymbol{U}}_e = \\frac{c}{h} \\begin{pmatrix} 4U_{e-1,2} - 3 U_{e,1} - U_{e,2} \\\\ -2U_{e-1,2} + 3 U_{e,1} - U_{e,2} \\end{pmatrix}$.\nThis is in the form $\\dot{\\boldsymbol{U}}_e = A_e (U_{e-1,2}, U_{e,1}, U_{e,2})^\\top$. Reading the coefficients gives the matrix $A_e$:\n$$\nA_e = \\frac{c}{h} \\begin{pmatrix} 4 & -3 & -1 \\\\ -2 & 3 & -1 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\frac{c}{h} \\begin{pmatrix} 4 & -3 & -1 \\\\ -2 & 3 & -1 \\end{pmatrix}}\n$$"
        }
    ]
}