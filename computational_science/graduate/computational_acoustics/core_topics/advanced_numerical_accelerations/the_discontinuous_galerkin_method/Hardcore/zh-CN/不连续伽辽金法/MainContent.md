## 引言
间断 Galerkin (DG) 方法是现代计算科学与工程中一种功能强大且日益普及的数值技术，尤其在求解[双曲型偏微分方程](@entry_id:1126291)（如波动声学方程）方面表现出色。传统连续有限元方法要求解在整个计算域内保持连续，这在处理包含激波、材料界面等不连续现象或复杂几何时面临挑战。DG 方法通过允许解在单元边界上存在间断，打破了这一限制，提供了前所未有的灵活性和鲁棒性。本文旨在系统性地介绍 DG 方法的理论、应用与实践，填补从基础原理到高级应用的知识鸿沟。

在接下来的内容中，读者将踏上一段从理论到实践的学习之旅。第一章“原理与机制”将深入 DG 方法的数学心脏，阐明其如何通过分片多项式和[数值通量](@entry_id:145174)来“驯服”间断，并分析其局部守恒性与[能量稳定性](@entry_id:748991)等关键性质。第二章“应用与交叉学科联系”将展示 DG 方法的强大功能，探讨其如何处理复杂边界条件、非均匀介质，并应用于地球物理、燃烧学等前沿交叉学科领域。最后，第三章“动手实践”将通过一系列精心设计的计算练习，引导读者亲手实现 DG 方法的核心组件，将理论知识转化为解决实际问题的能力。

## 原理与机制

本章深入探讨间断 Galerkin (DG) 方法的核心原理与关键机制。与要求解在整个计算域内连续的传统连续 Galerkin (CG) 方法不同，DG 方法采用了更为灵活的范式，即允许解在单元边界上存在间断。这种设计理念不仅带来了独特的计算优势，也催生了一套独特的数学工具和理论，用以确保数值格式的稳定性和准确性。我们将从 DG 方法的基本思想出发，系统地构建其弱形式，详细阐述作为其核心的数值通量概念，并分析该方法在局部守恒性和[能量稳定性](@entry_id:748991)等方面的基本性质。最后，我们将讨论 DG 方法在求解波动声学中常见的一阶和二阶方程时的具体实现。

### 核心思想：拥抱间断

传统有限元方法（如连续 Galerkin 方法）的理论基础通常建立在要求数值解属于特定[索博列夫空间](@entry_id:141995)（如 $H^1(\Omega)$）之上。这内在地要求了近似解在单元边界上是连续的。然而，间断 Galerkin (DG) 方法采取了截然不同的策略：它允许解在单元边界上是不连续的。

DG 方法的函数空间由分片多项式构成。具体来说，对于一个被剖分为互不重叠单元 $K$ 的区域 $\Omega$，DG 近似解 $u_h$ 在每个单元 $K$ 内部是光滑的（通常是多项式），但在单元之间的交界面上可以有跳跃。这种函数空间被称为**破碎[索博列夫空间](@entry_id:141995)**（broken Sobolev space），形式上可定义为 ：
$$
V_h^p = \{ v \in L^2(\Omega) : v|_K \in \mathbb{P}^p(K) \text{ for all } K \in \mathcal{T}_h \}
$$
其中 $\mathcal{T}_h$ 是区域 $\Omega$ 的一个剖分，$v|_K$ 表示函数 $v$ 在单元 $K$ 上的限制，$\mathbb{P}^p(K)$ 是在单元 $K$ 上次数最高为 $p$ 的[多项式空间](@entry_id:144410)。

这种选择的直接后果是，DG 空间 $V_h^p$ 中的函数通常不属于 $H^1(\Omega)$，因为其[弱导数](@entry_id:189356)在单元交界面上包含狄拉克 $\delta$ 分布，不满足平方可积的条件 。然而，这种局部化的函数定义也带来了显著的计算优势。DG 方法的基函数可以纯粹在单元内部定义，其支集仅限于单个单元。这一特性使得全局**质量矩阵**（即基函数与其自身在 $L^2$ [内积](@entry_id:750660)构成的矩阵）呈现出**[块对角结构](@entry_id:746869)**。每个对角块对应一个单元的局部[质量矩阵](@entry_id:177093)，而不同单元之间的块则为零。这种结构极大地方便了[质量矩阵](@entry_id:177093)的求逆，对于求解时间相关的[偏微分](@entry_id:194612)方程（PDE），尤其是采用显式时间积分格式时，这是一个巨大的计算优势 。例如，如果选择一组在[参考单元](@entry_id:168425)上正交的基函数，并通过[仿射变换](@entry_id:144885)映射到物理单元上，那么局部[质量矩阵](@entry_id:177093)甚至可以是纯[对角矩阵](@entry_id:637782)，使得求逆过程变得非常简单 。

### 弱形式：驯服间断

由于解在单元交界面上是多值的，我们无法像在 CG 方法中那样直接对整个区域进行积分并应用[散度定理](@entry_id:143110)。DG 方法的出发点是在每个单元 $K$ 上独立地推导[弱形式](@entry_id:142897)。考虑一个守恒形式的 PDE $\partial_t u + \nabla \cdot \boldsymbol{f}(u) = 0$。我们将其乘以一个[测试函数](@entry_id:166589) $v_h \in V_h^p$，并在一个单元 $K$ 上积分：
$$
\int_K \frac{\partial u_h}{\partial t} v_h \, d\boldsymbol{x} + \int_K (\nabla \cdot \boldsymbol{f}(u_h)) v_h \, d\boldsymbol{x} = 0
$$
对第二项使用[分部积分](@entry_id:136350)（或[高斯散度定理](@entry_id:188065)），我们将空间导数从通量 $\boldsymbol{f}(u_h)$ 转移到[测试函数](@entry_id:166589) $v_h$ 上：
$$
\int_K \frac{\partial u_h}{\partial t} v_h \, d\boldsymbol{x} - \int_K \boldsymbol{f}(u_h) \cdot \nabla v_h \, d\boldsymbol{x} + \int_{\partial K} (\boldsymbol{f}(u_h) \cdot \boldsymbol{n}_K) v_h \, dS = 0
$$
其中 $\boldsymbol{n}_K$ 是单元 $K$ 边界 $\partial K$ 上的单位外法向向量。

这个过程在每个单元的边界 $\partial K$ 上都产生了一个边界积分项。对于位于区域 $\Omega$ 内部的交界面 $F$，它同时是两个相邻单元（比如 $K^-$ 和 $K^+$）的边界。由于 $u_h$ 在 $F$ 上是间断的，因此来自 $K^-$ 的迹 $u_h^-$ 和来自 $K^+$ 的迹 $u_h^+$ 可能不同，导致物理通量 $\boldsymbol{f}(u_h)$ 在交界面上是双值的。

DG 方法的核心思想是用一个定义明确的单值**[数值通量](@entry_id:145174)**（numerical flux）$\hat{\boldsymbol{f}}$ 来取代物理通量。这个数值通量依赖于交界面两侧的状态，即 $\hat{\boldsymbol{f}}(u_h^-, u_h^+)$。通过在每个单元的[弱形式](@entry_id:142897)中用 $\hat{\boldsymbol{f}}$ 代替 $\boldsymbol{f}(u_h)$ 的边界项，并将所有单元的[弱形式](@entry_id:142897)相加，内部交界面上的贡献得以耦合。考虑一维情况，对所有单元求和后，所有交界面的贡献可以被整理成一个全局求和的形式 ：
$$
\sum_{i=1}^{N} \left(v_h^-_{i+1/2} - v_h^+_{i+1/2}\right) \hat{f}(u_h^-_{i+1/2}, u_h^+_{i+1/2})
$$
这个和式明确地展示了相邻单元的自由度如何通过数值通量和[测试函数](@entry_id:166589)的跳跃 $[v_h] = v_h^- - v_h^+$ 联系在一起。正是这种通过数值通量实现的耦合机制，使得信息可以在整个计算域中传播，同时又保持了 DG 方法的局部化特性。

### [数值通量](@entry_id:145174)：[DG方法](@entry_id:748369)的心脏

对于双曲型守恒律（如波动声学方程），[数值通量](@entry_id:145174)的设计至关重要，它直接决定了数值格式的稳定性和精度。一个合格的数值通量通常必须满足以下三个关键属性 ：

1.  **相容性 (Consistency)**：如果交界面两侧的状态相同，即 $u^- = u^+ = u$，那么[数值通量](@entry_id:145174)必须退化为物理通量：$\hat{f}(u, u) = f(u)$。这保证了当数值解趋于光滑的精确解时，格式能够恢复到原始的[偏微分](@entry_id:194612)方程。

2.  **守恒性 (Conservation)**：在任意内部交界面上，相邻的两个单元必须使用同一个数值通量值。由于它们的法向相反，一个单元的流出通量恰好是另一个单元的流入通量。当对所有单元的弱形式求和时，这些内部通量项会精确抵消，从而确保了全局[质量守恒](@entry_id:204015)。

3.  **稳定性 (Upwinding)**：双曲型方程的信息是沿着特征线传播的。一个稳定的数值格式必须尊重这一物理特性。**[迎风](@entry_id:756372) (upwinding)** 原则指出，[数值通量](@entry_id:145174)应当偏向于信息来源一侧的状态（即上游状态）。对于标量平流问题 $u_t + a u_x = 0$，特征速度为 $a$。如果 $a > 0$，信息从左向右传播，上游状态是 $u^-$，[迎风通量](@entry_id:143931)为 $f(u^-) = a u^-$；如果 $a  0$，信息从右向左传播，上游状态是 $u^+$，[迎风通量](@entry_id:143931)为 $f(u^+) = a u^+$。这种选择性地引入了耗散，能够有效抑制非物理振荡，保证格式的稳定性。

我们以**[线性声学](@entry_id:1127264)**为例，具体阐述如何构造一个精确的[迎风通量](@entry_id:143931)。一维[线性声学](@entry_id:1127264)方程组可写作：
$$
\frac{\partial p}{\partial t} + \kappa \frac{\partial u}{\partial x} = 0, \qquad \frac{\partial u}{\partial t} + \frac{1}{\rho} \frac{\partial p}{\partial x} = 0
$$
其中 $p$ 是声压，$u$ 是质点速度，$\kappa$ 是体积模量，$\rho$ 是密度。该方程组可写成矩阵形式 $\partial_t \mathbf{q} + \mathbf{A} \partial_x \mathbf{q} = 0$，其中 $\mathbf{q} = [p, u]^T$。通过[特征分析](@entry_id:1124210)，可以求得系统矩阵 $\mathbf{A}$ 的特征值（特征速度）为 $\lambda = \pm c$，其中 $c = \sqrt{\kappa/\rho}$ 是声速，以及相应的[特征向量](@entry_id:151813)。这使得我们可以将解分解为沿两个相反方向传播的特征波（或[黎曼不变量](@entry_id:165930)）。

在交界面处，[迎风](@entry_id:756372)原则要求我们构造的界面状态 $(p^*, u^*)$ 是由从左侧传来的右[行波](@entry_id:1133416)和从右侧传来的左行波共同决定的。求解这个线性[黎曼问题](@entry_id:171440)，可以得到精确的界面状态 ：
$$
p^* = \frac{1}{2} (p_L + p_R) + \frac{\rho c}{2} (u_L - u_R)
$$
$$
u^* = \frac{1}{2} (u_L + u_R) + \frac{1}{2 \rho c} (p_L - p_R)
$$
这里的 $(p^*, u^*)$ 构成了数值通量 $\hat{\mathbf{f}}$ 的基础。例如，声压的数值通量 $\hat{p}$ 就是 $p^*$。这些表达式中的 $\rho c$ 是介质的特征[声阻抗](@entry_id:267232)。

### DG 格式的基本性质

#### 局部守恒性

DG 方法一个非常吸引人的特性是其**局部守恒性**。在一个守恒律的 DG 离散格式中，我们可以选择一个特殊的[测试函数](@entry_id:166589) $v_h$，它在某个特定单元 $K$ 上恒为 1，而在所有其他单元上恒为 0。由于 DG [函数空间](@entry_id:143478)是分片的，这样的函数是合法的测试函数。将这个[测试函数](@entry_id:166589)代入单元 $K$ 的[弱形式](@entry_id:142897)，体积积分项 $\int_K \boldsymbol{f}(u_h) \cdot \nabla v_h \, d\boldsymbol{x}$ 因为 $\nabla v_h = 0$ 而消失。方程简化为：
$$
\frac{d}{dt} \int_K u_h \, d\boldsymbol{x} = - \int_{\partial K} \hat{\boldsymbol{f}} \cdot \boldsymbol{n}_K \, dS
$$
这个方程精确地表明，单元 $K$ 内[守恒量](@entry_id:161475) $u_h$ 的总量的变化率，完全由通过其边界的数值通量所决定。这就是局部守恒性。相比之下，标准的 CG 方法不具备此性质，因为上述[测试函数](@entry_id:166589)在单元边界上不连续，不属于 $H^1(\Omega)$ 空间，因此不是一个合法的 CG 测试函数。CG 方法只能保证全局守恒 。

#### 稳定性与能量分析

[迎风通量](@entry_id:143931)的引入不仅仅是为了模仿物理传播方向，它还为数值格式提供了必要的稳定性。我们可以通过能量分析来揭示这一点。考虑[线性声学](@entry_id:1127264)系统，其物理能量密度为 $\mathcal{E} = \frac{p^2}{2\kappa} + \frac{\rho u^2}{2}$。我们可以通过在 DG [弱形式](@entry_id:142897)中选择与能量相容的[测试函数](@entry_id:166589)（例如 $v_p = p_h/\kappa$ 和 $v_u = \rho u_h$）来推导离散能量的变化率。

经过一系列推导，可以证明，整个计算域中离散总能量的时间变化率，完全由所有内部交界面上的贡献之和决定。对于任何一个交界面，其对能量变化率的贡献为  ：
$$
\frac{dE_h}{dt}\bigg|_{\text{interface}} = - \left( \frac{1}{2Z}[p_h]^2 + \frac{Z}{2}[u_h]^2 \right)
$$
其中 $[p_h]$ 和 $[u_h]$ 分别是声压和速度在交界面上的跳跃，$Z = \sqrt{\rho \kappa}$ 是声阻抗。

这个表达式的意义非凡。由于 $Z > 0$，且平方项非负，所以该项总是小于或等于零。这意味着离散系统的总能量永远不会增加，即格式是能量稳定的。更重要的是，能量的耗散（减少）仅在解存在跳跃（$[p_h] \neq 0$ 或 $[u_h] \neq 0$）的地方发生，并且耗散量与跳跃大小的平方成正比。这正是我们所期望的：DG 方法通过在间断处引入[数值耗散](@entry_id:168584)来抑制伪振荡，从而稳定计算，而在解光滑的区域则几乎不引入耗散。

### DG 方法求解二阶方程

上述讨论主要集中在一阶双曲型系统。对于声学中更常见的二阶标量波动方程 $\partial_t^2 p = c^2 \Delta p$，其中 $\Delta$ 是拉普拉斯算子，DG 方法主要有两种处理策略。

#### 策略一：[降阶法](@entry_id:140559)（[LDG](@entry_id:751395)）

**局部间断 Galerkin ([LDG](@entry_id:751395))** 方法通过引入一个辅助变量（例如，$\mathbf{q} = \nabla p$）将二阶方程转化为一个在空间上是一阶的方程组。原始的[波动方程](@entry_id:139839) $\partial_t^2 p = c^2 \Delta p$ 被重写为：
$$
\partial_t^2 p = c^2 \nabla \cdot \mathbf{q}
$$
$$
\mathbf{q} = \nabla p
$$
这样，我们就可以对这个关于 $(p, \mathbf{q})$ 的系统应用为一阶空间导数开发的[数值通量](@entry_id:145174)技术来离散。[LDG](@entry_id:751395) 方法的特点是，在消去辅助变量 $\mathbf{q}$ 后，得到的关于主变量 $p$ 的[系统矩阵](@entry_id:172230)通常是**非对称的**，且其**计算模板**（stencil）会更宽，即一个单元会与邻居的邻居耦合。当使用迎风型通量时，[LDG](@entry_id:751395) 格式通常会引入[数值耗散](@entry_id:168584)，因此不是严格保能量的 。

#### 策略二：直接离散法（SIPG）

另一种方法是直接离散二阶方程。通过在单元弱形式中进行两次分部积分，可以得到一个包含解的跳跃和解的法向导数平均的边界项。**[对称内部罚](@entry_id:755719)函数 Galerkin (SIPG)** 方法是该策略的典范。其[双线性形式](@entry_id:746794)  包含三个关键部分：
1.  **标准 Galerkin 项**：来自两次[分部积分](@entry_id:136350)后的体积积分项。
2.  **相容性项**：包含法向导数平均与解的跳跃的乘积，以及其对称项。这些项确保当精确解足够光滑时，格式是相容的。
3.  **[罚函数](@entry_id:638029)项**：一个对解在交界面上的跳跃进行惩罚的项，形如 $\frac{\eta}{h} [u_h][v_h]$。此项对于保证离散系统的强制性（coercivity）至关重要，其中 $\eta$ 是一个足够大的罚参数。

SIPG 方法的优点在于，其产生的离散系统[刚度矩阵](@entry_id:178659)是**[对称正定](@entry_id:145886)的**。这不仅在理论上具有吸[引力](@entry_id:189550)，也使得可以采用高效的[对称矩阵](@entry_id:143130)求解器。此外，SIPG 格式的计算模板是紧凑的（仅与直接相邻的单元耦合），并且对于[波动方程](@entry_id:139839)，它是**严格保能量的** 。

**SIPG 与 [LDG](@entry_id:751395) 的比较**：选择哪种方法取决于具体应用。如果需要严格的能量守恒和[时间可逆性](@entry_id:274492)（例如，在长时程的无损波传播模拟中），或者希望利用对称[线性求解器](@entry_id:751329)的优势，SIPG 是理想的选择。而当需要更精细地控制[数值耗散](@entry_id:168584)，或者在处理强[非均匀介质](@entry_id:750241)、吸收边界层等复杂问题时，[LDG](@entry_id:751395) 方法在通量层面的灵活性使其更具优势 。

### 从[弱形式](@entry_id:142897)到线性系统：一个具体实例

为了将上述抽象的理论具体化，我们考虑一维线性平流方程 $u_t + c u_x = 0$ ($c > 0$) 在线性基函数（$p=1$）下的 DG 离散过程 。近似解在一个单元 $K_e$ 上表示为 $u_h(x,t) = U_{e,1}(t)\ell_1(\xi) + U_{e,2}(t)\ell_2(\xi)$，其中 $\ell_1, \ell_2$ 是[参考单元](@entry_id:168425)上的线性基函数，$U_{e,1}, U_{e,2}$ 是单元两端节点上的自由度。

通过推导单元[弱形式](@entry_id:142897)、引入[迎风通量](@entry_id:143931) $\hat{f} = c u^-$，并将基函数代入，我们可以得到关于单元自由度向量 $\boldsymbol{U}_e = [U_{e,1}, U_{e,2}]^T$ 的半离散常微分方程组：
$$
M_e \frac{d\boldsymbol{U}_e}{dt} = \dots
$$
其中 $M_e$ 是[单元质量矩阵](@entry_id:748930)。由于 DG 方法的特性，我们可以方便地乘以 $M_e^{-1}$ 来得到显式形式。最终，一个单元 $K_e$ 的自由度的时间变化率，可以表示为其自身自由度以及其左侧相邻单元 $K_{e-1}$ 自由度的线性组合。例如，对于一个特定的设置，该关系可以紧凑地写成：
$$
\frac{d\boldsymbol{U}_e}{dt} = \frac{c}{h} \begin{pmatrix} 4  -3  -1 \\ -2  3  -1 \end{pmatrix} \begin{pmatrix} U_{e-1,2} \\ U_{e,1} \\ U_{e,2} \end{pmatrix}
$$
这个 $2 \times 3$ 的[矩阵算子](@entry_id:269557) $A_e$ 具体地展示了 DG 离散化后，一个单元的演化是如何依赖于其上游邻居的信息的。它将前面讨论的弱形式、数值通量和基函数等概念，最终转化为一个可执行的计算步骤，清晰地揭示了 DG 方法的内在机制。