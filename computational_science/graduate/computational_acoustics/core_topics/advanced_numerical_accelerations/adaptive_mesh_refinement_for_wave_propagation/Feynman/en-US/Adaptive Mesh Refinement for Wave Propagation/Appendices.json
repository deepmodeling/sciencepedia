{
    "hands_on_practices": [
        {
            "introduction": "Before building an adaptive mesh, we must understand the fundamental constraints that govern numerical stability. This exercise guides you through a derivation of the Courant-Friedrichs-Lewy (CFL) condition for a standard explicit scheme used in wave propagation . By connecting this purely numerical constraint to physical parameters like wave speed and frequency, you will grasp the critical link between spatial resolution ($\\Delta x$) and the maximum allowable time step ($\\Delta t$), which forms the theoretical basis for time-step subcycling in AMR.",
            "id": "4116322",
            "problem": "Consider one-dimensional acoustic wave propagation in a homogeneous medium with sound speed $c$, modeled by the scalar second-order wave equation $\\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} u}{\\partial x^{2}}$, where $u(x,t)$ denotes the acoustic pressure fluctuation. An explicit leapfrog time integrator with centered second-order finite differences in space is used, so that the fully discrete scheme on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$ is\n$$\nu_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1} = \\left(\\frac{c \\Delta t}{\\Delta x}\\right)^{2} \\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right),\n$$\nfor integer indices $j$ and $n$. Using a von Neumann plane-wave analysis starting from first principles, derive the Courant–Friedrichs–Lewy (CFL) stability limit for this scheme as a constraint on the Courant number $\\nu$, where $\\nu$ is defined by $\\nu = \\frac{c \\Delta t}{\\Delta x}$. Then, consider an adaptive mesh refinement strategy in which the finest level is chosen to resolve the highest relevant acoustic frequency $f_{\\max}$ with $N_{\\mathrm{ppw}}$ points per wavelength. Using only well-founded physical relations for wavelength and frequency, express the finest-grid spacing $\\Delta x_{\\mathrm{fine}}$ in terms of $c$, $f_{\\max}$, and $N_{\\mathrm{ppw}}$, and determine the maximum allowable global time step $\\Delta t_{\\max}$ that satisfies the CFL limit when the global time step is limited by the finest mesh.\n\nCompute the numerical value of $\\Delta t_{\\max}$ for $c = 1500\\,\\mathrm{m/s}$, $f_{\\max} = 20000\\,\\mathrm{Hz}$, and $N_{\\mathrm{ppw}} = 12$. Round your answer to four significant figures and express it in seconds.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   The governing partial differential equation: $\\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} u}{\\partial x^{2}}$\n-   The discrete finite difference scheme: $u_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1} = \\left(\\frac{c \\Delta t}{\\Delta x}\\right)^{2} \\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right)$\n-   Definition of the Courant number: $\\nu = \\frac{c \\Delta t}{\\Delta x}$\n-   Acoustic medium and parameters: sound speed $c$, highest relevant frequency $f_{\\max}$, points per wavelength $N_{\\mathrm{ppw}}$\n-   Quantities to be determined: The CFL stability limit for $\\nu$, the finest-grid spacing $\\Delta x_{\\mathrm{fine}}$, and the maximum allowable global time step $\\Delta t_{\\max}$.\n-   Numerical values for calculation: $c = 1500\\,\\mathrm{m/s}$, $f_{\\max} = 20000\\,\\mathrm{Hz}$, $N_{\\mathrm{ppw}} = 12$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the canonical one-dimensional acoustic wave equation and a standard, widely-used explicit finite difference time domain (FDTD) method (leapfrog scheme). The method of von Neumann stability analysis is a fundamental tool in the analysis of numerical methods for partial differential equations. The relationship between wavelength, frequency, and wave speed is a cornerstone of wave physics. The problem is entirely grounded in established principles of physics and numerical analysis.\n-   **Well-Posed**: The problem is clearly stated and contains all necessary information to derive the requested analytical expressions and compute the final numerical value. The tasks are sequential and logically connected, leading to a unique and meaningful solution.\n-   **Objective**: The problem is stated in precise, technical language, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. We will now proceed with the solution, which consists of three parts: a) deriving the CFL condition, b) expressing the grid parameters in terms of physical quantities, and c) computing the maximum time step.\n\n**Part 1: Derivation of the CFL Stability Limit**\n\nWe perform a von Neumann stability analysis. We assume a single Fourier mode solution (a plane wave) for a given wavenumber $k$ on the discrete grid $x_j = j \\Delta x$. The solution ansatz is:\n$$\nu_j^n = G^n e^{i k x_j} = G^n e^{i k j \\Delta x}\n$$\nwhere $n$ is the time index, $j$ is the space index, $i = \\sqrt{-1}$, and $G$ is the amplification factor per time step. For the scheme to be stable, the magnitude of the amplification factor must satisfy $|G| \\le 1$.\n\nSubstituting the ansatz into the left-hand side of the discrete scheme gives:\n$$\nu_j^{n+1} - 2u_j^n + u_j^{n-1} = G^{n+1} e^{i k j \\Delta x} - 2G^n e^{i k j \\Delta x} + G^{n-1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} \\left( G - 2 + \\frac{1}{G} \\right)\n$$\nSubstituting into the right-hand side gives:\n$$\n\\nu^2 \\left( u_{j+1}^n - 2u_j^n + u_{j-1}^n \\right) = \\nu^2 \\left( G^n e^{i k (j+1) \\Delta x} - 2G^n e^{i k j \\Delta x} + G^n e^{i k (j-1) \\Delta x} \\right)\n$$\nFactoring out $G^n e^{i k j \\Delta x}$ on the right-hand side:\n$$\n\\nu^2 G^n e^{i k j \\Delta x} \\left( e^{i k \\Delta x} - 2 + e^{-i k \\Delta x} \\right)\n$$\nUsing Euler's formula, $e^{i\\theta} + e^{-i\\theta} = 2 \\cos(\\theta)$, this simplifies to:\n$$\n\\nu^2 G^n e^{i k j \\Delta x} \\left( 2 \\cos(k \\Delta x) - 2 \\right) = -2 \\nu^2 G^n e^{i k j \\Delta x} \\left( 1 - \\cos(k \\Delta x) \\right)\n$$\nNow, using the trigonometric identity $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$:\n$$\n-4 \\nu^2 G^n e^{i k j \\Delta x} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nEquating the transformed left and right sides and dividing by the common factor $G^n e^{i k j \\Delta x}$ (which is non-zero), we obtain an equation for $G$:\n$$\nG - 2 + \\frac{1}{G} = -4 \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nMultiplying by $G$ and rearranging yields a quadratic equation for the amplification factor $G$:\n$$\nG^2 - 2 \\left(1 - 2 \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right) G + 1 = 0\n$$\nThis is an equation of the form $G^2 - 2\\alpha G + 1 = 0$, where $\\alpha = 1 - 2 \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$. The roots are $G = \\alpha \\pm \\sqrt{\\alpha^2 - 1}$. For stability, we require $|G| \\le 1$. If $|\\alpha| > 1$, then $\\alpha^2 - 1 > 0$, and the roots are real. One root will have a magnitude greater than $1$, leading to exponential growth and instability. If $|\\alpha| \\le 1$, then $\\alpha^2 - 1 \\le 0$, and the roots are complex conjugates $G = \\alpha \\pm i\\sqrt{1-\\alpha^2}$. The magnitude of these roots is $|G|^2 = \\alpha^2 + (1-\\alpha^2) = 1$, so $|G|=1$. This corresponds to a stable, non-dissipative scheme.\n\nThus, the stability condition is $|\\alpha| \\le 1$, which translates to:\n$$\n-1 \\le 1 - 2 \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\nThe right-hand inequality, $1 - 2 \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1$, simplifies to $-2 \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 0$, which is always satisfied since $\\nu^2 \\ge 0$ and the sine-squared term is non-negative.\n\nThe left-hand inequality provides the stability constraint:\n$$\n-1 \\le 1 - 2 \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\implies 2 \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 2 \\implies \\nu^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\nThis condition must hold for all wavenumbers $k$ that can be represented on the grid. The term $\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$ is maximized when its argument is an odd multiple of $\\pi/2$. The highest frequency that can be resolved on a grid with spacing $\\Delta x$ is the Nyquist frequency, which corresponds to a wavelength of $2\\Delta x$ and a wavenumber of $k = \\pi/\\Delta x$. For this \"worst-case\" wavenumber, the term becomes $\\sin^2\\left(\\frac{(\\pi/\\Delta x) \\Delta x}{2}\\right) = \\sin^2(\\pi/2) = 1$.\n\nTherefore, the stability condition for all modes is:\n$$\n\\nu^2 \\le 1 \\implies |\\nu| \\le 1\n$$\nSince $\\nu = \\frac{c \\Delta t}{\\Delta x}$ is defined with positive quantities, the CFL stability limit is $\\nu \\le 1$.\n\n**Part 2: Grid Spacing for Adaptive Mesh Refinement**\n\nThe relationship between wavelength $\\lambda$, frequency $f$, and wave speed $c$ is $\\lambda = c/f$. To properly resolve wave phenomena, the spatial grid must be fine enough to sample the shortest wavelength of interest. The shortest wavelength, $\\lambda_{\\min}$, corresponds to the highest frequency, $f_{\\max}$:\n$$\n\\lambda_{\\min} = \\frac{c}{f_{\\max}}\n$$\nThe problem specifies that this shortest wavelength must be resolved by $N_{\\mathrm{ppw}}$ points per wavelength. This means that one wavelength $\\lambda_{\\min}$ must span $N_{\\mathrm{ppw}}$ grid cells of size $\\Delta x_{\\mathrm{fine}}$. Thus,\n$$\nN_{\\mathrm{ppw}} \\Delta x_{\\mathrm{fine}} = \\lambda_{\\min}\n$$\nSolving for the finest-grid spacing $\\Delta x_{\\mathrm{fine}}$ and substituting the expression for $\\lambda_{\\min}$:\n$$\n\\Delta x_{\\mathrm{fine}} = \\frac{\\lambda_{\\min}}{N_{\\mathrm{ppw}}} = \\frac{c}{f_{\\max} N_{\\mathrm{ppw}}}\n$$\n\n**Part 3: Maximum Allowable Global Time Step**\n\nIn an explicit time-stepping scheme with adaptive mesh refinement, the global time step $\\Delta t$ must be small enough to ensure stability on the finest mesh in the domain. The CFL condition must hold on the grid with spacing $\\Delta x_{\\mathrm{fine}}$:\n$$\n\\frac{c \\Delta t}{\\Delta x_{\\mathrm{fine}}} \\le 1\n$$\nThe maximum allowable time step, $\\Delta t_{\\max}$, is found when this condition is at its limit:\n$$\n\\frac{c \\Delta t_{\\max}}{\\Delta x_{\\mathrm{fine}}} = 1 \\implies \\Delta t_{\\max} = \\frac{\\Delta x_{\\mathrm{fine}}}{c}\n$$\nSubstituting the expression for $\\Delta x_{\\mathrm{fine}}$ derived in Part 2:\n$$\n\\Delta t_{\\max} = \\frac{1}{c} \\left( \\frac{c}{f_{\\max} N_{\\mathrm{ppw}}} \\right) = \\frac{1}{f_{\\max} N_{\\mathrm{ppw}}}\n$$\n\n**Part 4: Numerical Calculation**\n\nWe are given $c = 1500\\,\\mathrm{m/s}$, $f_{\\max} = 20000\\,\\mathrm{Hz}$, and $N_{\\mathrm{ppw}} = 12$. The value of $c$ is not needed for the final expression of $\\Delta t_{\\max}$ but was necessary for the intermediate derivation of $\\Delta x_{\\mathrm{fine}}$.\n$$\n\\Delta t_{\\max} = \\frac{1}{f_{\\max} N_{\\mathrm{ppw}}} = \\frac{1}{(20000) \\times 12} = \\frac{1}{240000}\\,\\mathrm{s}\n$$\nConverting this to a decimal value:\n$$\n\\Delta t_{\\max} = 0.0000041666... \\,\\mathrm{s} = 4.1666... \\times 10^{-6}\\,\\mathrm{s}\n$$\nRounding to four significant figures, we get $4.167 \\times 10^{-6}\\,\\mathrm{s}$.",
            "answer": "$$\n\\boxed{4.167 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "The core intelligence of an AMR framework lies in its ability to decide where refinement is needed. This practice puts you in control of this decision-making process by tasking you with the design of a static refinement strategy . You will implement a program that allocates refinement based on two physically-motivated error indicators: the local wavelength and the solution's curvature. This exercise provides direct experience with the logic that enables AMR to focus computational effort efficiently, including the use of amplitude guards to avoid over-refinement in regions of negligible interest.",
            "id": "4116078",
            "problem": "You are given a one-dimensional acoustic medium with spatially varying sound speed and asked to compute an adaptive mesh refinement configuration for a time-harmonic snapshot of the acoustic pressure. The goal is to capture critical small-scale effects due to short wavelengths and sharp amplitude variations while avoiding overrefinement elsewhere. The program must compute, for each test case, a refinement distribution based on first principles and produce an aggregate summary in the specified output format.\n\nThe physical model is the linear acoustic wave equation in one spatial dimension with variable sound speed,\n$$\n\\frac{\\partial^2 p}{\\partial t^2}(x,t) = c(x)^2 \\frac{\\partial^2 p}{\\partial x^2}(x,t),\n$$\nwhere $p(x,t)$ is the acoustic pressure and $c(x)$ is the sound speed. Consider a time-harmonic excitation of frequency $f$ (in $\\mathrm{Hz}$) and define the angular frequency $\\omega = 2\\pi f$. For a slowly varying medium, the local spatial wavenumber is $k(x) \\approx \\omega / c(x)$, and the local wavelength is $\\lambda(x) = c(x) / f$.\n\nWe consider a snapshot at $t=0$ with spatial profile\n$$\np(x) = g(x) \\cos(\\phi(x)),\n$$\nwhere\n$$\ng(x) = \\exp\\!\\left( -\\frac{(x-x_0)^2}{2\\sigma^2} \\right),\n\\quad\n\\phi(x) = \\omega s(x),\n\\quad\ns(x) = \\int_0^x \\frac{1}{c(\\xi)} \\,\\mathrm{d}\\xi,\n$$\nwith $x \\in [0,L]$, $L$ in $\\mathrm{m}$, center $x_0$ in $\\mathrm{m}$, and envelope width parameter $\\sigma$ in $\\mathrm{m}$. The medium is piecewise constant:\n$$\nc(x) =\n\\begin{cases}\nc_1, & 0 \\le x \\le x_s,\\\\\nc_2, & x_s < x \\le L,\n\\end{cases}\n$$\nwith $c_1$ and $c_2$ in $\\mathrm{m/s}$ and interface location $x_s$ in $\\mathrm{m}$. Consequently,\n$$\ns(x) =\n\\begin{cases}\n\\frac{x}{c_1}, & 0 \\le x \\le x_s,\\\\\n\\frac{x_s}{c_1} + \\frac{x-x_s}{c_2}, & x_s < x \\le L.\n\\end{cases}\n$$\n\nYou must construct a static adaptive mesh refinement configuration starting from a uniform base mesh of $N_0$ cells on $[0,L]$ (base cell size $h_0 = L / N_0$). Each base cell $i$ with center $x_i$ can be refined by bisecting into $2^{L_i}$ leaf cells, where $L_i \\in \\{0,1,2,\\dots\\}$ is the local refinement level. The refinement level $L_i$ is determined by the smallest level such that the refined cell size $h_i = h_0 / 2^{L_i}$ satisfies both of the following constraints:\n\n1. Wavelength resolution constraint ensuring at least $M_{\\min}$ points per local wavelength:\n$$\nh_i \\le \\frac{\\lambda(x_i)}{M_{\\min}} = \\frac{c(x_i)}{f\\, M_{\\min}}.\n$$\n\n2. Interpolation error constraint based on the Taylor remainder for a twice continuously differentiable function over a cell of size $h$, which is bounded by a constant times $h^2$ times the supremum of the second derivative. Using the classical bound for linear interpolation error,\n$$\nE_{\\text{lin}} \\le \\frac{h^2}{8} \\sup_{\\text{cell}} \\left| \\frac{\\mathrm{d}^2 p}{\\mathrm{d}x^2} \\right|,\n$$\nenforce\n$$\n\\frac{h_i^2}{8} \\left| p''(x_i) \\right| \\le \\tau,\n$$\nwhere $\\tau$ is a user-specified amplitude error tolerance (dimensionless), yielding the curvature-driven constraint\n$$\nh_i \\le \\sqrt{\\frac{8 \\tau}{\\left| p''(x_i) \\right| + \\varepsilon}},\n$$\nwith a small regularization $\\varepsilon > 0$ to avoid division by zero.\n\nTo avoid overrefinement in regions where the acoustic field is negligible, apply an amplitude guard: if the local amplitude satisfies $\\left| p(x_i) \\right|  A_{\\min}$ (dimensionless), then set $L_i = 0$ regardless of the above constraints. This guard prevents refinement in regions where the field is too small to be of interest.\n\nFor the purposes of this problem, treat $p''(x)$ away from the interface $x_s$ using the product rule with $\\phi''(x)=0$ almost everywhere (since $c(x)$ is piecewise constant). Using $g'(x) = -\\frac{x-x_0}{\\sigma^2} g(x)$ and $g''(x) = \\left( \\frac{(x-x_0)^2}{\\sigma^4} - \\frac{1}{\\sigma^2} \\right) g(x)$, and writing $a(x) = \\cos(\\phi(x))$ and $b(x) = \\sin(\\phi(x))$, one obtains\n$$\np''(x) = g''(x)\\, a(x) \\;-\\; 2 g'(x)\\, \\phi'(x)\\, b(x) \\;-\\; g(x)\\, \\left( \\phi'(x) \\right)^2 a(x),\n$$\nwith $\\phi'(x) = \\omega / c(x)$ and $\\phi''(x)=0$ for $x \\ne x_s$.\n\nDefine the following aggregate outputs per test case:\n- The total number of leaf cells,\n$$\nN_{\\text{leaf}} = \\sum_{i=0}^{N_0-1} 2^{L_i},\n$$\n- The maximum refinement level used,\n$$\nL_{\\max} = \\max_i L_i,\n$$\n- The hypothetical overrefinement ratio without the amplitude guard, computed as the fraction of leaf cells that would be refined in regions with $\\left| p(x_i) \\right|  A_{\\min}$ if the amplitude guard were not applied,\n$$\nR_{\\text{waste}} = \\frac{\\sum_{i: \\left| p(x_i) \\right|  A_{\\min}} 2^{\\widetilde{L}_i}}{\\sum_{i=0}^{N_0-1} 2^{\\widetilde{L}_i}},\n$$\nwhere $\\widetilde{L}_i$ is the refinement level obtained by the same constraints but ignoring the amplitude guard.\n\nAll physical quantities must be in the following units:\n- Domain length $L$ in $\\mathrm{m}$.\n- Sound speeds $c_1$ and $c_2$ in $\\mathrm{m/s}$.\n- Frequency $f$ in $\\mathrm{Hz}$.\n- Amplitude tolerance $\\tau$ is dimensionless.\n- Amplitude guard threshold $A_{\\min}$ is dimensionless.\n- Envelope width parameter $\\sigma$ and positions $x$, $x_0$, $x_s$ in $\\mathrm{m}$.\n\nUse angles in radians. No percentage signs should be used; ratios must be expressed as decimals.\n\nUse the following fixed domain and base mesh for all test cases:\n- Domain $[0,L]$ with $L = 1$.\n- Base number of cells $N_0 = 64$, so $h_0 = L / N_0$.\n- Sound speed values $c_1 = 1500$, $c_2 = 1800$, interface at $x_s = 0.6$.\n\nYour program must compute the adaptive refinement configuration for the four test cases specified below. For each case, use the given parameters and the rules above to compute $N_{\\text{leaf}}$, $L_{\\max}$, and $R_{\\text{waste}}$.\n\nTest suite (each tuple is $(f, \\sigma, M_{\\min}, A_{\\min}, \\tau, x_0)$):\n1. $(8000, 0.03, 12, 0.05, 0.005, 0.30)$\n2. $(20000, 0.02, 16, 0.01, 0.003, 0.40)$\n3. $(1500, 0.08, 10, 0.05, 0.008, 0.25)$\n4. $(12000, 0.025, 14, 0.02, 0.004, 0.58)$\n\nThe final output format must be a single line containing a list of the four results, one per test case, where each result is itself a list in the order $[N_{\\text{leaf}}, L_{\\max}, R_{\\text{waste}}]$. For example, the output must look like\n$$\n[ [N_1, L_{\\max,1}, R_1], [N_2, L_{\\max,2}, R_2], [N_3, L_{\\max,3}, R_3], [N_4, L_{\\max,4}, R_4] ].\n$$",
            "solution": "The problem requires the design of a static adaptive mesh refinement (AMR) configuration for a one-dimensional acoustic wave propagation scenario. The goal is to determine the local refinement level for a set of base cells on a domain, based on criteria that ensure resolution of both the local wavelength and regions of high solution curvature, while avoiding unnecessary refinement where the wave amplitude is negligible.\n\nThe physical model is the linear acoustic wave equation in a medium with a spatially varying sound speed $c(x)$:\n$$\n\\frac{\\partial^2 p}{\\partial t^2}(x,t) = c(x)^2 \\frac{\\partial^2 p}{\\partial x^2}(x,t)\n$$\nWe analyze a time-harmonic snapshot of the pressure field $p(x)$ at $t=0$, given by:\n$$\np(x) = g(x) \\cos(\\phi(x))\n$$\nwhere $g(x)$ is a Gaussian envelope and $\\phi(x)$ is the spatial phase. The components are defined as:\n- Envelope: $g(x) = \\exp\\!\\left( -\\frac{(x-x_0)^2}{2\\sigma^2} \\right)$\n- Phase: $\\phi(x) = \\omega s(x) = 2\\pi f s(x)$, where $s(x)$ is the acoustic travel time from the origin.\n\nThe domain is $x \\in [0, L]$ with $L=1 \\, \\mathrm{m}$. The sound speed $c(x)$ is piecewise constant:\n$$\nc(x) =\n\\begin{cases}\nc_1 = 1500 \\, \\mathrm{m/s},  0 \\le x \\le x_s = 0.6 \\, \\mathrm{m} \\\\\nc_2 = 1800 \\, \\mathrm{m/s},  0.6 \\, \\mathrm{m}  x \\le 1 \\, \\mathrm{m}\n\\end{cases}\n$$\nThis leads to the travel time function:\n$$\ns(x) = \\int_0^x \\frac{1}{c(\\xi)} \\,\\mathrm{d}\\xi =\n\\begin{cases}\n\\frac{x}{c_1},  0 \\le x \\le x_s \\\\\n\\frac{x_s}{c_1} + \\frac{x-x_s}{c_2},  x_s  x \\le L\n\\end{cases}\n$$\nThe computational domain $[0, L]$ is initially discretized into a uniform base mesh of $N_0 = 64$ cells. The base cell size is $h_0 = L / N_0 = 1/64 \\, \\mathrm{m}$. The refinement criteria are evaluated at the center of each base cell $i$, located at $x_i = (i + 0.5)h_0$ for $i = 0, 1, \\dots, N_0-1$.\n\nFor each base cell $i$, we determine a refinement level $L_i \\in \\{0, 1, 2, \\dots\\}$, which corresponds to subdividing the cell into $2^{L_i}$ smaller leaf cells of size $h_i = h_0 / 2^{L_i}$. The level $L_i$ is the smallest non-negative integer that satisfies a set of conditions. The process begins by determining the required level without the amplitude guard, denoted $\\widetilde{L}_i$, and then applying the guard to find the final level $L_i$.\n\nFirst, we compute the required cell size $h_{i, \\text{req}}$ for cell $i$ based on two physical and numerical constraints:\n\n1.  **Wavelength Resolution Constraint**: To accurately represent the oscillatory nature of the wave, the local cell size $h_i$ must be a fraction of the local wavelength $\\lambda(x_i) = c(x_i)/f$. The constraint ensures at least $M_{\\min}$ grid points per wavelength:\n    $$\n    h_i \\le h_{i, \\text{wave}} = \\frac{\\lambda(x_i)}{M_{\\min}} = \\frac{c(x_i)}{f M_{\\min}}\n    $$\n\n2.  **Interpolation Error Constraint**: To limit the error from approximating the solution within a cell (e.g., with linear basis functions), the cell size must be controlled in regions of high curvature. The constraint is based on the Taylor series remainder, which relates the error to the second derivative of the solution, $p''(x_i)$.\n    $$\n    h_i \\le h_{i, \\text{curv}} = \\sqrt{\\frac{8 \\tau}{|p''(x_i)| + \\varepsilon}}\n    $$\n    Here, $\\tau$ is a specified tolerance, and $\\varepsilon$ is a small positive constant (e.g., $\\varepsilon=10^{-12}$) to prevent division by zero where the curvature is null. The second derivative $p''(x)$ for $x \\neq x_s$ is calculated using the product rule:\n    $$\n    p''(x) = g''(x) \\cos(\\phi(x)) - 2g'(x)\\phi'(x) \\sin(\\phi(x)) - g(x) (\\phi'(x))^2 \\cos(\\phi(x))\n    $$\n    with $\\phi'(x) = \\omega/c(x)$, $g'(x) = -\\frac{x-x_0}{\\sigma^2}g(x)$, and $g''(x) = \\left(\\frac{(x-x_0)^2}{\\sigma^4} - \\frac{1}{\\sigma^2}\\right)g(x)$.\n\nThe most restrictive of these two constraints determines the required cell size for cell $i$:\n$$\nh_{i, \\text{req}} = \\min(h_{i, \\text{wave}}, h_{i, \\text{curv}})\n$$\nFrom this, the refinement level $\\widetilde{L}_i$ (without the amplitude guard) is the smallest integer such that $h_0 / 2^{\\widetilde{L}_i} \\le h_{i, \\text{req}}$. This is computed as:\n$$\n\\widetilde{L}_i = \\max\\left(0, \\left\\lceil \\log_2\\left(\\frac{h_0}{h_{i, \\text{req}}}\\right)\\right\\rceil\\right)\n$$\nwhere the ceiling function $\\lceil \\cdot \\rceil$ ensures the inequality is met, and the max function ensures the level is non-negative.\n\nNext, the **Amplitude Guard** is applied. This rule prevents refinement in regions where the solution amplitude is negligible, thereby saving computational resources.\n$$\n\\text{If } |p(x_i)|  A_{\\min}, \\text{ then } L_i = 0. \\text{ Otherwise, } L_i = \\widetilde{L}_i.\n$$\nThis two-step process yields the final refinement level $L_i$ for each base cell.\n\nFinally, for each test case, we compute three aggregate metrics from the set of all levels $\\{L_i\\}$ and $\\{\\widetilde{L}_i\\}$:\n-   **Total Leaf Cells ($N_{\\text{leaf}}$)**: The total number of cells in the final adaptive mesh.\n    $$\n    N_{\\text{leaf}} = \\sum_{i=0}^{N_0-1} 2^{L_i}\n    $$\n-   **Maximum Refinement Level ($L_{\\max}$)**: The deepest level of refinement used anywhere in the domain.\n    $$\n    L_{\\max} = \\max_{i} L_i\n    $$\n-   **Overrefinement Ratio ($R_{\\text{waste}}$)**: The fraction of total cells (in the unguarded mesh) that are located in regions where the amplitude is below the threshold $A_{\\min}$. This quantifies the efficiency gain from the amplitude guard.\n    $$\n    R_{\\text{waste}} = \\frac{\\sum_{i: |p(x_i)|  A_{\\min}} 2^{\\widetilde{L}_i}}{\\sum_{j=0}^{N_0-1} 2^{\\widetilde{L}_j}}\n    $$\n\nThe computational procedure involves iterating through each of the four test cases, setting the corresponding parameters, evaluating the above quantities for all $N_0=64$ base cells, and then computing the final aggregate metrics.",
            "answer": "$$\n[ [468, 5, 0.40726645], [1037, 6, 0.47058824], [102, 2, 0.49019608], [696, 5, 0.28735632] ]\n$$"
        },
        {
            "introduction": "A key challenge in AMR is ensuring that the numerical scheme continues to obey the physical conservation laws of the underlying system across different grid levels. This practice addresses this issue within a finite-volume framework, which is built upon integral conservation principles . You will implement the \"refluxing\" correction, a cornerstone technique that reconciles fluxes at coarse-fine interfaces to guarantee that quantities like mass or energy are perfectly conserved, thereby maintaining the physical fidelity of the simulation.",
            "id": "4116117",
            "problem": "You are to implement the Adaptive Mesh Refinement (AMR) refluxing correction for the Two-Dimensional (2D) linear acoustics pressure update in a finite-volume method. The derivation and implementation must start from first principles: the integral form of conservation for the pressure in linear acoustics. Consider the 2D linear acoustics system with pressure $p$, particle velocities $u$ and $v$, density $\\rho$, and sound speed $c$. The linearized governing equations are $ \\frac{\\partial p}{\\partial t} + \\rho c^2 \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0 $, $ \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0 $, and $ \\frac{\\partial v}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial y} = 0 $. The pressure equation can be written in conservation form with fluxes $F_p^x = \\rho c^2 u$ and $F_p^y = \\rho c^2 v$. For a rectangular coarse cell with dimensions $\\Delta x$ by $\\Delta y$, volume $V_c = \\Delta x \\Delta y$, and coarse time step $\\Delta t_c$, the coarse-grid update over one time step is obtained from the divergence of fluxes integrated over each face and over the coarse time interval.\n\nIn Adaptive Mesh Refinement (AMR), a fine grid of refinement ratio $r$ in space subdivides each coarse face into $r$ equal segments along the face direction. Subcycling in time by a ratio $r_t$ uses a fine time step $\\Delta t_f = \\Delta t_c / r_t$. Let the coarse-grid pressure flux densities across faces be given as $F_{c}^{x,\\text{left}}$, $F_{c}^{x,\\text{right}}$, $F_{c}^{y,\\text{bottom}}$, and $F_{c}^{y,\\text{top}}$, each representing a face-averaged flux density constant over the coarse time step. Let the fine-grid face flux densities be provided as arrays that are piecewise constant over each fine substep and fine face segment: for each face, an $r_t \\times r$ array whose $(k,m)$ entry gives the flux density over fine time substep $k$ and face segment $m$. The fine face segment lengths are $\\Delta y_f = \\Delta y / r$ for vertical faces and $\\Delta x_f = \\Delta x / r$ for horizontal faces.\n\nFrom the integral conservation law, the corrected coarse-cell pressure update over one coarse time step must replace the coarse face-integrated fluxes with the corresponding sum of fine face-integrated fluxes. Implement this refluxing correction purely from the divergence theorem and the integral form of the finite-volume update, without invoking any shortcut formulas. Your program must compute, for each test case, the corrected coarse-cell pressure increment $\\Delta p$ over one coarse time step, expressed in Pascals (Pa).\n\nInput for each test case is implicitly provided inside the program (no external input). Each test case specifies:\n- $\\Delta x$ in meters (m),\n- $\\Delta y$ in meters (m),\n- $\\Delta t_c$ in seconds (s),\n- $r$ (spatial refinement ratio, integer $\\ge 1$),\n- $r_t$ (temporal subcycling ratio, integer $\\ge 1$),\n- Coarse face flux densities $F_{c}^{x,\\text{left}}$, $F_{c}^{x,\\text{right}}$, $F_{c}^{y,\\text{bottom}}$, and $F_{c}^{y,\\text{top}}$ with units of Pascal meter per second (Pa·m/s),\n- Fine face flux density arrays for each face as $r_t \\times r$ lists of floats (Pa·m/s).\n\nUse the following test suite:\n- Test case 1 (general case with small mismatches):\n  - $\\Delta x = 1.0$ m, $\\Delta y = 1.0$ m, $\\Delta t_c = 0.01$ s, $r = 2$, $r_t = 2$,\n  - $F_{c}^{x,\\text{left}} = 0.5$, $F_{c}^{x,\\text{right}} = 0.6$, $F_{c}^{y,\\text{bottom}} = -0.2$, $F_{c}^{y,\\text{top}} = 0.1$,\n  - Fine $x,\\text{right}$: $\\begin{bmatrix} 0.62  0.58 \\\\ 0.59  0.61 \\end{bmatrix}$,\n  - Fine $x,\\text{left}$: $\\begin{bmatrix} 0.49  0.51 \\\\ 0.50  0.50 \\end{bmatrix}$,\n  - Fine $y,\\text{bottom}$: $\\begin{bmatrix} -0.21  -0.19 \\\\ -0.25  -0.20 \\end{bmatrix}$,\n  - Fine $y,\\text{top}$: $\\begin{bmatrix} 0.09  0.11 \\\\ 0.12  0.13 \\end{bmatrix}$.\n- Test case 2 (no mismatch across any face):\n  - $\\Delta x = 2.0$ m, $\\Delta y = 2.0$ m, $\\Delta t_c = 0.02$ s, $r = 2$, $r_t = 2$,\n  - $F_{c}^{x,\\text{left}} = 1.0$, $F_{c}^{x,\\text{right}} = 1.2$, $F_{c}^{y,\\text{bottom}} = 0.0$, $F_{c}^{y,\\text{top}} = 0.0$,\n  - Fine $x,\\text{right}$: $\\begin{bmatrix} 1.2  1.2 \\\\ 1.2  1.2 \\end{bmatrix}$,\n  - Fine $x,\\text{left}$: $\\begin{bmatrix} 1.0  1.0 \\\\ 1.0  1.0 \\end{bmatrix}$,\n  - Fine $y,\\text{bottom}$: $\\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}$,\n  - Fine $y,\\text{top}$: $\\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}$.\n- Test case 3 (boundary case $r=1$ with balanced fluxes):\n  - $\\Delta x = 1.5$ m, $\\Delta y = 1.0$ m, $\\Delta t_c = 0.015$ s, $r = 1$, $r_t = 1$,\n  - $F_{c}^{x,\\text{left}} = 0.3$, $F_{c}^{x,\\text{right}} = 0.3$, $F_{c}^{y,\\text{bottom}} = 0.2$, $F_{c}^{y,\\text{top}} = 0.2$,\n  - Fine $x,\\text{right}$: $\\begin{bmatrix} 0.3 \\end{bmatrix}$,\n  - Fine $x,\\text{left}$: $\\begin{bmatrix} 0.3 \\end{bmatrix}$,\n  - Fine $y,\\text{bottom}$: $\\begin{bmatrix} 0.2 \\end{bmatrix}$,\n  - Fine $y,\\text{top}$: $\\begin{bmatrix} 0.2 \\end{bmatrix}$.\n- Test case 4 (mismatch only on the top face):\n  - $\\Delta x = 1.0$ m, $\\Delta y = 2.0$ m, $\\Delta t_c = 0.02$ s, $r = 2$, $r_t = 2$,\n  - $F_{c}^{x,\\text{left}} = 0.0$, $F_{c}^{x,\\text{right}} = 0.0$, $F_{c}^{y,\\text{bottom}} = 0.5$, $F_{c}^{y,\\text{top}} = 0.5$,\n  - Fine $x,\\text{right}$: $\\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}$,\n  - Fine $x,\\text{left}$: $\\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}$,\n  - Fine $y,\\text{bottom}$: $\\begin{bmatrix} 1.0  1.0 \\\\ 0.0  0.0 \\end{bmatrix}$,\n  - Fine $y,\\text{top}$: $\\begin{bmatrix} 1.2  1.2 \\\\ 0.0  0.0 \\end{bmatrix}$.\n- Test case 5 (temporal subcycling $r_t \\ne r$):\n  - $\\Delta x = 1.0$ m, $\\Delta y = 1.0$ m, $\\Delta t_c = 0.03$ s, $r = 2$, $r_t = 3$,\n  - $F_{c}^{x,\\text{left}} = 0.0$, $F_{c}^{x,\\text{right}} = 0.0$, $F_{c}^{y,\\text{bottom}} = 0.5$, $F_{c}^{y,\\text{top}} = 1.0$,\n  - Fine $x,\\text{right}$: $\\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}$,\n  - Fine $x,\\text{left}$: $\\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}$,\n  - Fine $y,\\text{bottom}$: $\\begin{bmatrix} 0.6  0.4 \\\\ 0.7  0.5 \\\\ 0.5  0.5 \\end{bmatrix}$,\n  - Fine $y,\\text{top}$: $\\begin{bmatrix} 1.0  0.8 \\\\ 1.2  1.0 \\\\ 0.8  0.8 \\end{bmatrix}$.\n\nYour program should produce a single line of output containing the corrected coarse-cell pressure increments for the five test cases, in Pascals, as a comma-separated list enclosed in square brackets. For example, the output format must be exactly like $$[r_1, r_2, r_3, r_4, r_5]$$ where each $r_i$ is a floating-point number representing $\\Delta p$ in Pascals.",
            "solution": "The user wants to implement an Adaptive Mesh Refinement (AMR) refluxing correction for a 2D linear acoustics problem.\n\n### **1. Problem Validation**\n\nFirst, a rigorous validation of the problem statement is performed.\n\n#### **Step 1: Extracted Givens**\n\n- **Governing Equations**:\n  - Pressure evolution: $ \\frac{\\partial p}{\\partial t} + \\rho c^2 \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0 $\n  - Momentum (x): $ \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0 $\n  - Momentum (y): $ \\frac{\\partial v}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial y} = 0 $\n- **Conservation Form**:\n  - Fluxes for the pressure equation: $F_p^x = \\rho c^2 u$ and $F_p^y = \\rho c^2 v$.\n- **Coarse Grid Parameters**:\n  - Cell dimensions: $\\Delta x$, $\\Delta y$ (meters)\n  - Cell volume: $V_c = \\Delta x \\Delta y$\n  - Time step: $\\Delta t_c$ (seconds)\n- **AMR Parameters**:\n  - Spatial refinement ratio: $r$ (integer $\\ge 1$)\n  - Temporal subcycling ratio: $r_t$ (integer $\\ge 1$)\n  - Fine time step: $\\Delta t_f = \\Delta t_c / r_t$\n  - Fine face segment lengths: $\\Delta y_f = \\Delta y / r$ (for vertical faces), $\\Delta x_f = \\Delta x / r$ (for horizontal faces)\n- **Flux Data**:\n  - Coarse face flux densities (constant over face and $\\Delta t_c$): $F_{c}^{x,\\text{left}}$, $F_{c}^{x,\\text{right}}$, $F_{c}^{y,\\text{bottom}}$, $F_{c}^{y,\\text{top}}$ (Pa·m/s)\n  - Fine face flux densities: Provided as $r_t \\times r$ arrays of floats for each face, where the entry $(k,m)$ represents the flux density over fine substep $k$ and fine face segment $m$.\n- **Task**: Compute the corrected coarse-cell pressure increment $\\Delta p$ (Pascals) over one coarse time step, using the fine-grid flux data.\n- **Test Suite**: Five distinct test cases with all necessary parameters are provided.\n\n#### **Step 2: Validation Using Extracted Givens**\n\n- **Scientific Grounding**: The problem is founded on the fundamental principles of linear acoustics and the finite-volume method, a standard numerical technique. The concept of flux refluxing in AMR is a well-established, physically-motivated procedure to enforce conservation laws at coarse-fine grid interfaces. The governing equations and flux definitions are correct. The units are consistent. The problem is scientifically sound.\n- **Well-Posedness**: The problem clearly asks for a specific, computable quantity ($\\Delta p$) and provides all the necessary input data for each test case. The method of derivation is specified (from the integral conservation law), ensuring a unique and stable solution can be determined for each case. The problem is well-posed.\n- **Objectivity**: The problem is formulated in precise, objective mathematical language, free from ambiguity or subjective claims.\n\n#### **Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, well-posed, objective, complete, and consistent. It passes all validation criteria. Therefore, a solution will be provided.\n\n### **2. Derivation of the Corrected Pressure Update**\n\nThe derivation begins from the integral form of the pressure conservation law, as mandated. The pressure equation can be written in conservation form as:\n$$\n\\frac{\\partial p}{\\partial t} + \\nabla \\cdot \\mathbf{F}_p = 0\n$$\nwhere $p$ is the pressure and $\\mathbf{F}_p = (F_p^x, F_p^y)$ is the vector of pressure fluxes.\n\nAccording to the finite-volume method, we integrate this equation over a control volume $V$ (in this case, the coarse cell $\\Omega_c$ of volume $V_c = \\Delta x \\Delta y$) and a time interval from $t^n$ to $t^{n+1} = t^n + \\Delta t_c$.\n$$\n\\int_{t^n}^{t^n+\\Delta t_c} \\int_{\\Omega_c} \\frac{\\partial p}{\\partial t} \\,dV \\,dt + \\int_{t^n}^{t^n+\\Delta t_c} \\int_{\\Omega_c} \\nabla \\cdot \\mathbf{F}_p \\,dV \\,dt = 0\n$$\nApplying the divergence theorem to the second term transforms the volume integral of the divergence into a surface integral of the flux over the boundary $\\partial \\Omega_c$:\n$$\n\\int_{\\Omega_c} (p(t^{n+1}) - p(t^n)) \\,dV + \\int_{t^n}^{t^n+\\Delta t_c} \\oint_{\\partial \\Omega_c} \\mathbf{F}_p \\cdot \\mathbf{n} \\,dS \\,dt = 0\n$$\nLet $p_{avg}$ be the average pressure in the cell. The equation for the change in the average pressure, $\\Delta p = p_{avg}(t^{n+1}) - p_{avg}(t^n)$, is:\n$$\n\\Delta p \\cdot V_c = - \\int_{t^n}^{t^n+\\Delta t_c} \\oint_{\\partial \\Omega_c} \\mathbf{F}_p \\cdot \\mathbf{n} \\,dS \\,dt\n$$\nThus, the pressure increment is given by:\n$$\n\\Delta p = -\\frac{1}{V_c} \\int_{t^n}^{t^n+\\Delta t_c} \\oint_{\\partial \\Omega_c} \\mathbf{F}_p \\cdot \\mathbf{n} \\,dS \\,dt\n$$\nThe boundary integral $\\oint \\mathbf{F}_p \\cdot \\mathbf{n} \\,dS$ is the sum of fluxes through the four faces of the rectangular cell (right, left, top, bottom). The total time-and-space integrated flux is:\n$$\n\\mathcal{F}_{\\text{net}} = \\underbrace{\\int_{t^n}^{t^n+\\Delta t_c} \\int_{\\text{right}} F_p^x \\,dy \\,dt}_{\\mathcal{F}_{\\text{right}}} - \\underbrace{\\int_{t^n}^{t^n+\\Delta t_c} \\int_{\\text{left}} F_p^x \\,dy \\,dt}_{\\mathcal{F}_{\\text{left}}} + \\underbrace{\\int_{t^n}^{t^n+\\Delta t_c} \\int_{\\text{top}} F_p^y \\,dx \\,dt}_{\\mathcal{F}_{\\text{top}}} - \\underbrace{\\int_{t^n}^{t^n+\\Delta t_c} \\int_{\\text{bottom}} F_p^y \\,dx \\,dt}_{\\mathcal{F}_{\\text{bottom}}}\n$$\nThe core principle of the refluxing correction is to use the most accurate available data for the flux integrals. A coarse-grid calculation would approximate these integrals using the coarse fluxes $F_c$. However, at an AMR interface, the fine grid provides a more resolved representation of the flux. The corrected update replaces the coarse-flux integral with a summation over the fine-grid contributions.\n\nLet's calculate the integrated flux for the right face, $\\mathcal{F}_{\\text{right}}$. The fine-grid data provides flux densities $F_{f, k, m}^{x, \\text{right}}$ that are piecewise constant over fine time substeps of duration $\\Delta t_f = \\Delta t_c / r_t$ and fine spatial segments of length $\\Delta y_f = \\Delta y / r$. The integral is therefore approximated by the sum:\n$$\n\\mathcal{F}_{\\text{right}} \\approx \\sum_{k=0}^{r_t-1} \\sum_{m=0}^{r-1} F_{f, k, m}^{x, \\text{right}} \\cdot \\Delta y_f \\cdot \\Delta t_f = \\sum_{k=0}^{r_t-1} \\sum_{m=0}^{r-1} F_{f, k, m}^{x, \\text{right}} \\cdot \\left(\\frac{\\Delta y}{r}\\right) \\cdot \\left(\\frac{\\Delta t_c}{r_t}\\right)\n$$\nWe can define an average flux density $\\langle F_{f}^{x, \\text{right}} \\rangle$ over the coarse face and time step, as computed from the fine grid data:\n$$\n\\langle F_{f}^{x, \\text{right}} \\rangle = \\frac{1}{r_t \\cdot r} \\sum_{k=0}^{r_t-1} \\sum_{m=0}^{r-1} F_{f, k, m}^{x, \\text{right}}\n$$\nWith this definition, the integrated flux is simply $\\mathcal{F}_{\\text{right}} = \\langle F_{f}^{x, \\text{right}} \\rangle \\cdot \\Delta y \\cdot \\Delta t_c$. Applying this to all four faces, the net integrated flux $\\mathcal{F}_{\\text{net}}$ becomes:\n$$\n\\mathcal{F}_{\\text{net}} = \\left( \\langle F_{f}^{x, \\text{right}} \\rangle - \\langle F_{f}^{x, \\text{left}} \\rangle \\right) \\Delta y \\Delta t_c + \\left( \\langle F_{f}^{y, \\text{top}} \\rangle - \\langle F_{f}^{y, \\text{bottom}} \\rangle \\right) \\Delta x \\Delta t_c\n$$\nSubstituting this into the equation for $\\Delta p$ and using $V_c = \\Delta x \\Delta y$:\n$$\n\\Delta p = -\\frac{1}{\\Delta x \\Delta y} \\left[ \\left( \\langle F_{f}^{x, \\text{right}} \\rangle - \\langle F_{f}^{x, \\text{left}} \\rangle \\right) \\Delta y \\Delta t_c + \\left( \\langle F_{f}^{y, \\text{top}} \\rangle - \\langle F_{f}^{y, \\text{bottom}} \\rangle \\right) \\Delta x \\Delta t_c \\right]\n$$\nSimplifying this expression yields the final formula for the corrected pressure increment:\n$$\n\\Delta p = -\\Delta t_c \\left[ \\frac{\\langle F_{f}^{x, \\text{right}} \\rangle - \\langle F_{f}^{x, \\text{left}} \\rangle}{\\Delta x} + \\frac{\\langle F_{f}^{y, \\text{top}} \\rangle - \\langle F_{f}^{y, \\text{bottom}} \\rangle}{\\Delta y} \\right]\n$$\nThis is the discrete analogue of $\\Delta p \\approx -\\Delta t_c (\\nabla \\cdot \\langle\\mathbf{F}_f\\rangle)$. This formula will be implemented to compute the required pressure increment for each test case. Note that the coarse flux values $F_c$ are not used in this final corrected calculation, as they have been superseded by the more accurate, spatially and temporally averaged fine-flux data.",
            "answer": "$$\n[-0.00425, -0.002, 0.0, -0.001, -0.011]\n$$"
        }
    ]
}