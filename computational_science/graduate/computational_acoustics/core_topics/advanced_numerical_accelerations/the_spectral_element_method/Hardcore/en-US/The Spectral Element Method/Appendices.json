{
    "hands_on_practices": [
        {
            "introduction": "The power of the Spectral Element Method begins at the level of a single reference element. This first exercise guides you through the fundamental process of constructing the local mass and stiffness matrices, which are the building blocks of any SEM simulation. By deriving the Gauss-Lobatto-Legendre (GLL) nodes and weights from first principles, you will gain direct insight into why the GLL-based SEM leads to a diagonal (or \"lumped\") mass matrix, a property that is paramount for computational efficiency in explicit time-domain simulations. ",
            "id": "4145034",
            "problem": "Consider the one-dimensional reference element $\\xi \\in [-1,1]$ for the Spectral Element Method (SEM) applied to linear acoustics with unit density and unit bulk modulus so that the bilinear forms reduce to the standard $L^2$ inner product and the $H^1$ seminorm. Let the polynomial degree be $p=4$ and adopt the Gauss–Lobatto–Legendre (GLL) nodal set of $p+1=5$ points on $[-1,1]$. Using fundamental properties of Legendre polynomials, first determine the $5$ GLL nodes $\\{\\xi_{i}\\}_{i=0}^{4}$ and their associated GLL quadrature weights $\\{w_{i}\\}_{i=0}^{4}$. Next, construct the nodal Lagrange basis $\\{\\ell_{i}(\\xi)\\}_{i=0}^{4}$ that interpolates at these nodes, and assemble the local, element-level consistent mass and stiffness matrices,\n$$\nM_{ij} \\equiv \\int_{-1}^{1} \\ell_{i}(\\xi)\\,\\ell_{j}(\\xi)\\,d\\xi,\\qquad\nK_{ij} \\equiv \\int_{-1}^{1} \\frac{d\\ell_{i}}{d\\xi}(\\xi)\\,\\frac{d\\ell_{j}}{d\\xi}(\\xi)\\,d\\xi,\\quad i,j=0,\\dots,4.\n$$\nBegin from the defining properties of Legendre polynomials and the construction of GLL quadrature (endpoints included and interior nodes at the roots of the derivative of the Legendre polynomial of degree $p$), and the definition of nodal Lagrange polynomials. Use only these bases to justify the diagonality of the mass matrix under GLL quadrature collocation and to explain the nonzero pattern (bandwidth) that results for the stiffness matrix on this single reference element.\n\nFinally, report the determinant of the mass matrix $M$ as your answer. Express the final value as an exact rational number. No rounding is required and no units are involved. The final answer must be a single real number presented in exact form.",
            "solution": "The problem is set on the one-dimensional reference element $\\xi \\in [-1,1]$ with a polynomial approximation of degree $p=4$. The nodal basis is constructed using the $p+1=5$ Gauss–Lobatto–Legendre (GLL) points.\n\nFirst, we determine the GLL nodes $\\{\\xi_{i}\\}_{i=0}^{4}$ and their associated quadrature weights $\\{w_{i}\\}_{i=0}^{4}$. For a polynomial degree $p$, the $p+1$ GLL nodes are the roots of the polynomial $(1-\\xi^2)P'_{p}(\\xi)$, where $P_{p}(\\xi)$ is the Legendre polynomial of degree $p$. The endpoints $\\xi=-1$ and $\\xi=1$ are always included. The $p-1$ interior nodes are the roots of $P'_{p}(\\xi)$, the first derivative of the Legendre polynomial.\n\nFor $p=4$, we need the Legendre polynomial $P_4(\\xi)$. The first few Legendre polynomials are:\n$P_0(\\xi) = 1$\n$P_1(\\xi) = \\xi$\n$P_2(\\xi) = \\frac{1}{2}(3\\xi^2 - 1)$\n$P_3(\\xi) = \\frac{1}{2}(5\\xi^3 - 3\\xi)$\n$P_4(\\xi) = \\frac{1}{8}(35\\xi^4 - 30\\xi^2 + 3)$\n\nThe derivative, $P'_4(\\xi)$, is:\n$$ P'_4(\\xi) = \\frac{d}{d\\xi} \\left[ \\frac{1}{8}(35\\xi^4 - 30\\xi^2 + 3) \\right] = \\frac{1}{8}(140\\xi^3 - 60\\xi) = \\frac{5}{2}\\xi(7\\xi^2 - 3) $$\nThe interior GLL nodes are at the roots of $P'_4(\\xi)=0$, which are $\\xi=0$ and $\\xi^2 = \\frac{3}{7}$, yielding $\\xi = \\pm\\sqrt{\\frac{3}{7}}$.\nIncluding the endpoints and ordering the nodes, we have the $5$ GLL nodes:\n$$ \\xi_0 = -1, \\quad \\xi_1 = -\\sqrt{\\frac{3}{7}}, \\quad \\xi_2 = 0, \\quad \\xi_3 = \\sqrt{\\frac{3}{7}}, \\quad \\xi_4 = 1 $$\nThe GLL quadrature weights $w_i$ are given by the formula:\n$$ w_i = \\frac{2}{p(p+1)[P_p(\\xi_i)]^2} $$\nFor $p=4$, this becomes $w_i = \\frac{2}{4(5)[P_4(\\xi_i)]^2} = \\frac{1}{10[P_4(\\xi_i)]^2}$.\nWe evaluate $P_4(\\xi_i)$ for each node:\nFor the endpoints $\\xi_0 = -1$ and $\\xi_4 = 1$, we have $P_4(\\pm 1) = 1$. The weights are:\n$$ w_0 = w_4 = \\frac{1}{10[P_4(1)]^2} = \\frac{1}{10(1)^2} = \\frac{1}{10} $$\nFor the interior node $\\xi_2 = 0$:\n$$ P_4(0) = \\frac{1}{8}(3) = \\frac{3}{8} $$\n$$ w_2 = \\frac{1}{10[P_4(0)]^2} = \\frac{1}{10(\\frac{3}{8})^2} = \\frac{1}{10(\\frac{9}{64})} = \\frac{64}{90} = \\frac{32}{45} $$\nFor the interior nodes $\\xi_1 = -\\sqrt{\\frac{3}{7}}$ and $\\xi_3 = \\sqrt{\\frac{3}{7}}$ (note that $P_4(\\xi)$ is an even function):\n$$ P_4\\left(\\pm\\sqrt{\\frac{3}{7}}\\right) = \\frac{1}{8}\\left(35\\left(\\frac{3}{7}\\right)^2 - 30\\left(\\frac{3}{7}\\right) + 3\\right) = \\frac{1}{8}\\left(35\\frac{9}{49} - \\frac{90}{7} + 3\\right) = \\frac{1}{8}\\left(\\frac{45}{7} - \\frac{90}{7} + \\frac{21}{7}\\right) = \\frac{1}{8}\\left(\\frac{-24}{7}\\right) = -\\frac{3}{7} $$\n$$ w_1 = w_3 = \\frac{1}{10\\left[P_4\\left(\\pm\\sqrt{\\frac{3}{7}}\\right)\\right]^2} = \\frac{1}{10\\left(-\\frac{3}{7}\\right)^2} = \\frac{1}{10\\left(\\frac{9}{49}\\right)} = \\frac{49}{90} $$\nThe set of weights is $\\{w_i\\}_{i=0}^4 = \\{\\frac{1}{10}, \\frac{49}{90}, \\frac{32}{45}, \\frac{49}{90}, \\frac{1}{10}\\}$. As a check, the sum of the weights is:\n$$\n\\sum w_i = 2 \\cdot \\frac{1}{10} + 2 \\cdot \\frac{49}{90} + \\frac{32}{45} = \\frac{9}{45} + \\frac{49}{45} + \\frac{32}{45} = \\frac{90}{45} = 2\n$$\nThis is correct since $\\int_{-1}^1 d\\xi = 2$.\n\nNext, we address the element matrices. The basis functions are the nodal Lagrange polynomials $\\{\\ell_j(\\xi)\\}_{j=0}^4$, which are unique polynomials of degree $p=4$ satisfying the interpolatory property $\\ell_j(\\xi_i) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nThe consistent mass matrix is defined as $M_{ij} = \\int_{-1}^{1} \\ell_{i}(\\xi)\\,\\ell_{j}(\\xi)\\,d\\xi$.\nIn the context of SEM, integrals are typically evaluated using GLL quadrature. The GLL quadrature rule with $p+1$ points is exact for polynomials of degree up to $2p-1$. Here, for $p=4$, the GLL quadrature is exact for polynomials of degree up to $2(4)-1=7$. The integrand $\\ell_i(\\xi)\\ell_j(\\xi)$ is a polynomial of degree up to $2p = 8$. Since $8>7$, GLL quadrature is not exact for the consistent mass matrix.\n\nHowever, a key feature of SEM is \"mass lumping,\" where the integral for the mass matrix is deliberately approximated by GLL quadrature. This is what the problem refers to when asking to \"justify the diagonality of the mass matrix under GLL quadrature collocation\". The collocated, or lumped, mass matrix is:\n$$ M_{ij}^{GLL} = \\sum_{k=0}^{4} w_k \\ell_i(\\xi_k) \\ell_j(\\xi_k) $$\nUsing the property $\\ell_i(\\xi_k) = \\delta_{ik}$, the expression simplifies:\n$$ M_{ij}^{GLL} = \\sum_{k=0}^{4} w_k \\delta_{ik} \\delta_{jk} $$\nThis sum is non-zero only when $k=i$ and $k=j$, which requires $i=j$. Thus, the matrix is diagonal:\n$$ M_{ij}^{GLL} = w_i \\delta_{ij} $$\nThe lumped mass matrix is diagonal, with the quadrature weights as its diagonal entries. This diagonal structure is a major computational advantage of SEM.\n\nThe stiffness matrix is defined as $K_{ij} = \\int_{-1}^{1} \\frac{d\\ell_{i}}{d\\xi}(\\xi)\\,\\frac{d\\ell_{j}}{d\\xi}(\\xi)\\,d\\xi$.\nThe derivative of a Lagrange polynomial of degree $p=4$ is a polynomial of degree $p-1=3$. The integrand $\\frac{d\\ell_{i}}{d\\xi}\\frac{d\\ell_{j}}{d\\xi}$ is therefore a polynomial of degree $2(p-1)=6$. Since $6  7$, GLL quadrature is **exact** for the stiffness matrix. The stiffness matrix is thus computed as:\n$$ K_{ij} = \\sum_{k=0}^{4} w_k \\frac{d\\ell_{i}}{d\\xi}(\\xi_k) \\frac{d\\ell_{j}}{d\\xi}(\\xi_k) $$\nTo explain its non-zero pattern, we consider the matrix of derivatives $D_{ki} = \\frac{d\\ell_{i}}{d\\xi}(\\xi_k)$. Unlike the Lagrange polynomials themselves, their derivatives are generally non-zero at the nodal points (except possibly at a few points due to symmetries). The differentiation matrix $D$ is a dense $5 \\times 5$ matrix. The stiffness matrix can be written in matrix form as $K = D^T W D$, where $W$ is the diagonal matrix of weights. The product of these matrices results in a dense (fully populated) $5 \\times 5$ matrix. Therefore, the nonzero pattern of the local stiffness matrix on this single reference element is that it is a full matrix.\n\nFinally, we are asked to report the determinant of the mass matrix $M$. Given the context and the request to explain the diagonality under GLL collocation, it is standard practice to interpret \"the mass matrix\" in this computational context as the lumped mass matrix $M^{GLL}$. The determinant of the diagonal lumped mass matrix is the product of its diagonal entries, which are the quadrature weights.\n$$ \\det(M) = \\det(M^{GLL}) = \\prod_{i=0}^{4} w_i = w_0 w_1 w_2 w_3 w_4 $$\nSubstituting the calculated weights:\n$$ \\det(M) = \\left(\\frac{1}{10}\\right) \\left(\\frac{49}{90}\\right) \\left(\\frac{32}{45}\\right) \\left(\\frac{49}{90}\\right) \\left(\\frac{1}{10}\\right) $$\n$$ \\det(M) = \\frac{1 \\cdot 49 \\cdot 32 \\cdot 49 \\cdot 1}{10 \\cdot 90 \\cdot 45 \\cdot 90 \\cdot 10} = \\frac{49^2 \\cdot 32}{10^2 \\cdot 90^2 \\cdot 45} = \\frac{2401 \\cdot 32}{100 \\cdot 8100 \\cdot 45} = \\frac{76832}{36450000} $$\nTo simplify this fraction, we use prime factorization:\n$76832 = 2^5 \\cdot 7^4$\n$36450000 = 3645 \\cdot 10^4 = (5 \\cdot 729) \\cdot (2 \\cdot 5)^4 = (5 \\cdot 3^6) \\cdot (2^4 \\cdot 5^4) = 2^4 \\cdot 3^6 \\cdot 5^5$\n$$ \\det(M) = \\frac{2^5 \\cdot 7^4}{2^4 \\cdot 3^6 \\cdot 5^5} = \\frac{2 \\cdot 7^4}{3^6 \\cdot 5^5} = \\frac{2 \\cdot 2401}{729 \\cdot 3125} = \\frac{4802}{2278125} $$\nThis is the final answer as an exact rational number.",
            "answer": "$$ \\boxed{\\frac{4802}{2278125}} $$"
        },
        {
            "introduction": "Before a numerical solver can be trusted for scientific discovery, its correctness must be rigorously verified. This practice introduces the Method of Manufactured Solutions (MMS), a powerful and standard technique for code verification. You will start with a chosen analytic function, treat it as a hypothetical exact solution to the wave equation, and derive the corresponding source terms and boundary data needed to make it so, a critical skill for debugging and validating any numerical method implementation. ",
            "id": "4145097",
            "problem": "Consider linear acoustics in a heterogeneous medium on the rectangular domain $\\Omega = [0,L_{x}] \\times [0,L_{y}]$ with outward unit normal $\\mathbf{n}(\\mathbf{x})$ on the boundary $\\partial \\Omega$. Let the mass density be $\\rho(\\mathbf{x}) = \\rho_{0}(1+\\epsilon x)$ and the bulk modulus be $\\kappa(\\mathbf{x}) = \\kappa_{0}$, where $\\rho_{0} > 0$, $\\kappa_{0} > 0$, and $\\epsilon \\ge 0$ are constants. The acoustic pressure $p(\\mathbf{x},t)$ satisfies the second-order scalar wave equation in strong form\n$$\n\\frac{1}{\\kappa_{0}} \\,\\partial_{tt} p(\\mathbf{x},t) - \\nabla \\cdot \\left( \\frac{1}{\\rho_{0}(1+\\epsilon x)} \\, \\nabla p(\\mathbf{x},t) \\right) = f(\\mathbf{x},t) \\quad \\text{in } \\Omega \\times (0,T],\n$$\nwith appropriate boundary and initial conditions. For the purpose of code verification of a Spectral Element Method (SEM), you will use the Method of Manufactured Solutions (MMS): construct a smooth, nontrivial manufactured solution $p(\\mathbf{x},t)$, and then derive the forcing term $f(\\mathbf{x},t)$, consistent boundary data, and initial data so that this $p(\\mathbf{x},t)$ exactly satisfies the above equation and boundary/initial conditions.\n\nSpecifically, take the manufactured solution\n$$\np(\\mathbf{x},t) = \\sin(k_{x} x)\\,\\sin(k_{y} y)\\,\\cos(\\omega t),\n$$\nwhere $k_{x} > 0$, $k_{y} > 0$, and $\\omega > 0$ are prescribed constants. Using first principles of linear acoustics and the weak form that underlies the Spectral Element Method (SEM), perform the following:\n\n- Starting from the linearized momentum and continuity equations, justify the second-order scalar wave equation with heterogeneous coefficients as posed above, and identify the natural boundary flux that appears from integration by parts in the weak form.\n- Compute the source term $f(\\mathbf{x},t)$ that makes the chosen $p(\\mathbf{x},t)$ an exact solution of the strong form.\n- Derive the Dirichlet boundary data $g_{D}(\\mathbf{x},t)$ and the Neumann boundary flux $g_{N}(\\mathbf{x},t)$ consistent with the weak form for arbitrary boundary segments of $\\partial \\Omega$ with outward unit normal $\\mathbf{n}(\\mathbf{x}) = (n_{x}(\\mathbf{x}), n_{y}(\\mathbf{x}))$.\n- Provide the initial pressure $p(\\mathbf{x},0)$ and initial pressure time derivative $\\partial_{t} p(\\mathbf{x},0)$.\n\nExpress the final result as a single closed-form analytic expression containing, in order, the five quantities $\\big(f(\\mathbf{x},t),\\, g_{D}(\\mathbf{x},t),\\, g_{N}(\\mathbf{x},t),\\, p(\\mathbf{x},0),\\, \\partial_{t} p(\\mathbf{x},0)\\big)$. No numerical evaluation is required.",
            "solution": "#### Justification of the Wave Equation and Weak Form\n\nWe start with the first-order linearized equations of acoustics for a fluid at rest in a heterogeneous medium with density $\\rho(\\mathbf{x})$ and bulk modulus $\\kappa(\\mathbf{x})$. The acoustic pressure is $p(\\mathbf{x},t)$ and the particle velocity is $\\mathbf{u}(\\mathbf{x},t)$.\n\n1.  **Linearized Momentum Equation:**\n    $$ \\rho(\\mathbf{x}) \\frac{\\partial \\mathbf{u}}{\\partial t} (\\mathbf{x},t) = -\\nabla p(\\mathbf{x},t) $$\n2.  **Linearized Continuity Equation:**\n    $$ \\frac{1}{\\kappa(\\mathbf{x})} \\frac{\\partial p}{\\partial t} (\\mathbf{x},t) + \\nabla \\cdot \\mathbf{u}(\\mathbf{x},t) = 0 $$\n\nTo derive the second-order wave equation for pressure, we can eliminate the velocity $\\mathbf{u}$. Differentiating the continuity equation with respect to time $t$ yields:\n$$ \\frac{\\partial}{\\partial t} \\left( \\frac{1}{\\kappa(\\mathbf{x})} \\frac{\\partial p}{\\partial t} \\right) + \\nabla \\cdot \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} \\right) = 0 $$\nSince $\\kappa$ is not a function of time, this simplifies to:\n$$ \\frac{1}{\\kappa(\\mathbf{x})} \\frac{\\partial^2 p}{\\partial t^2} + \\nabla \\cdot \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} \\right) = 0 $$\nFrom the momentum equation, we can express $\\frac{\\partial \\mathbf{u}}{\\partial t}$ as:\n$$ \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\frac{1}{\\rho(\\mathbf{x})} \\nabla p $$\nSubstituting this into the time-differentiated continuity equation, we get:\n$$ \\frac{1}{\\kappa(\\mathbf{x})} \\frac{\\partial^2 p}{\\partial t^2} + \\nabla \\cdot \\left( -\\frac{1}{\\rho(\\mathbf{x})} \\nabla p \\right) = 0 \\implies \\frac{1}{\\kappa(\\mathbf{x})} \\frac{\\partial^2 p}{\\partial t^2} - \\nabla \\cdot \\left( \\frac{1}{\\rho(\\mathbf{x})} \\nabla p \\right) = 0 $$\nAdding an external source term $f(\\mathbf{x},t)$ gives the governing equation specified in the problem statement. Given $\\rho(\\mathbf{x})=\\rho_{0}(1+\\epsilon x)$ and $\\kappa(\\mathbf{x})=\\kappa_{0}$, this matches the problem's PDE.\n\nTo derive the weak form, we multiply the PDE by a suitable test function $v(\\mathbf{x})$ and integrate over the domain $\\Omega$:\n$$ \\int_{\\Omega} v \\left( \\frac{1}{\\kappa_{0}} \\partial_{tt}p - \\nabla \\cdot \\left( \\frac{1}{\\rho(\\mathbf{x})} \\nabla p \\right) \\right) d\\mathbf{x} = \\int_{\\Omega} v f d\\mathbf{x} $$\nApplying Green's first identity (integration by parts) to the divergence term:\n$$ \\int_{\\Omega} -v \\nabla \\cdot \\left( \\frac{1}{\\rho} \\nabla p \\right) d\\mathbf{x} = \\int_{\\Omega} \\nabla v \\cdot \\left(\\frac{1}{\\rho} \\nabla p \\right) d\\mathbf{x} - \\int_{\\partial \\Omega} v \\left( \\frac{1}{\\rho} \\nabla p \\cdot \\mathbf{n} \\right) dS $$\nThe term appearing in the boundary integral, $\\frac{1}{\\rho(\\mathbf{x})} \\nabla p \\cdot \\mathbf{n}$, is the **natural boundary flux**, which is imposed in Neumann-type boundary conditions. This is the flux $g_N(\\mathbf{x},t)$ we need to compute.\n\n#### Source Term $f(\\mathbf{x},t)$\n\nTo find the source term $f(\\mathbf{x},t)$, we substitute the manufactured solution $p(\\mathbf{x},t) = \\sin(k_{x} x)\\sin(k_{y} y)\\cos(\\omega t)$ into the operator on the left-hand side of the PDE. The necessary derivatives of $p$ are:\n$$ \\partial_{tt} p = -\\omega^2 \\sin(k_x x) \\sin(k_y y) \\cos(\\omega t) = -\\omega^2 p $$\n$$ \\nabla p = \\cos(\\omega t) \\begin{pmatrix} k_x \\cos(k_x x) \\sin(k_y y) \\\\ k_y \\sin(k_x x) \\cos(k_y y) \\end{pmatrix} $$\nNext, we compute the divergence term $\\nabla \\cdot (\\frac{1}{\\rho(\\mathbf{x})} \\nabla p)$.\n$$ \\frac{1}{\\rho(\\mathbf{x})}\\nabla p = \\frac{\\cos(\\omega t)}{\\rho_0(1+\\epsilon x)} \\begin{pmatrix} k_x \\cos(k_x x) \\sin(k_y y) \\\\ k_y \\sin(k_x x) \\cos(k_y y) \\end{pmatrix} $$\nTaking the divergence of the above vector field:\n$$ \\nabla \\cdot \\left(\\frac{1}{\\rho} \\nabla p\\right) = -\\frac{\\cos(\\omega t)}{\\rho_0(1+\\epsilon x)} (k_x^2+k_y^2) \\sin(k_x x)\\sin(k_y y) - \\frac{k_x\\epsilon \\cos(k_x x)\\sin(k_y y) \\cos(\\omega t)}{\\rho_0(1+\\epsilon x)^2} $$\nFinally, we assemble the source term $f(\\mathbf{x}, t) = \\frac{1}{\\kappa_0} \\partial_{tt}p - \\nabla \\cdot (\\frac{1}{\\rho} \\nabla p)$:\n$$ f(\\mathbf{x},t) = -\\frac{\\omega^2}{\\kappa_0} \\sin(k_x x)\\sin(k_y y)\\cos(\\omega t) + \\frac{(k_x^2+k_y^2)\\cos(\\omega t)}{\\rho_0(1+\\epsilon x)} \\sin(k_x x)\\sin(k_y y) + \\frac{k_x\\epsilon \\cos(k_x x)\\sin(k_y y) \\cos(\\omega t)}{\\rho_0(1+\\epsilon x)^2} $$\nFactoring terms gives:\n$$ f(\\mathbf{x},t) = \\left( \\left[ \\frac{k_x^2+k_y^2}{\\rho_0(1+\\epsilon x)} - \\frac{\\omega^2}{\\kappa_0} \\right] \\sin(k_x x)\\sin(k_y y) + \\frac{k_x\\epsilon \\cos(k_x x)\\sin(k_y y)}{\\rho_0(1+\\epsilon x)^2} \\right) \\cos(\\omega t) $$\n\n#### Boundary and Initial Data\n\n-   **Dirichlet boundary data, $g_D(\\mathbf{x},t)$:** This is the trace of the manufactured solution on the boundary $\\partial \\Omega$.\n    $$ g_D(\\mathbf{x},t) = p(\\mathbf{x},t)|_{\\mathbf{x} \\in \\partial \\Omega} = \\sin(k_x x) \\sin(k_y y) \\cos(\\omega t) $$\n-   **Neumann boundary flux, $g_N(\\mathbf{x},t)$:** This is the natural boundary flux identified from the weak form.\n    $$ g_N(\\mathbf{x},t) = \\frac{1}{\\rho(\\mathbf{x})} \\nabla p \\cdot \\mathbf{n} = \\frac{1}{\\rho_0(1+\\epsilon x)} (\\partial_x p \\cdot n_x + \\partial_y p \\cdot n_y) $$\n    Substituting the expressions for the partial derivatives of $p$:\n    $$ g_N(\\mathbf{x},t) = \\frac{\\cos(\\omega t)}{\\rho_0(1+\\epsilon x)} \\left( n_x k_x \\cos(k_x x) \\sin(k_y y) + n_y k_y \\sin(k_x x) \\cos(k_y y) \\right) $$\n-   **Initial pressure, $p(\\mathbf{x},0)$:** This is the manufactured solution evaluated at $t=0$.\n    $$ p(\\mathbf{x},0) = \\sin(k_x x) \\sin(k_y y) \\cos(\\omega \\cdot 0) = \\sin(k_x x) \\sin(k_y y) $$\n-   **Initial pressure time derivative, $\\partial_t p(\\mathbf{x},0)$:**\n    $$ \\partial_t p(\\mathbf{x},t) = -\\omega \\sin(k_x x) \\sin(k_y y) \\sin(\\omega t) $$\n    Evaluating at $t=0$:\n    $$ \\partial_t p(\\mathbf{x},0) = -\\omega \\sin(k_x x) \\sin(k_y y) \\sin(\\omega \\cdot 0) = 0 $$",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n\\left( \\left[ \\frac{k_x^2+k_y^2}{\\rho_0(1+\\epsilon x)} - \\frac{\\omega^2}{\\kappa_0} \\right] \\sin(k_x x)\\sin(k_y y) + \\frac{k_x\\epsilon \\cos(k_x x)\\sin(k_y y)}{\\rho_0(1+\\epsilon x)^2} \\right) \\cos(\\omega t)\n\n\\sin(k_x x) \\sin(k_y y) \\cos(\\omega t)\n\n\\frac{\\cos(\\omega t)}{\\rho_0(1+\\epsilon x)} \\left( n_x k_x \\cos(k_x x) \\sin(k_y y) + n_y k_y \\sin(k_x x) \\cos(k_y y) \\right)\n\n\\sin(k_x x) \\sin(k_y y)\n\n0\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "For time-domain wave simulations using explicit schemes, numerical stability is not just a theoretical concern but a practical necessity. This exercise delves into the stability analysis of the Spectral Element Method by connecting the spatial discretization to the maximum allowable time step, a concept embodied in the Courant-Friedrichs-Lewy (CFL) condition. By assembling the global system matrices and analyzing their spectral properties, you will derive the stability limit from first principles, a crucial step for ensuring that numerical solutions remain bounded and physically meaningful. ",
            "id": "4144970",
            "problem": "You are asked to derive, implement, and evaluate the stability-limited explicit time-step for the Spectral Element Method (SEM) applied to one-dimensional linear acoustics. Consider the one-dimensional homogeneous acoustic wave equation on the interval $[0,L]$ with Dirichlet boundary conditions,\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}, \\quad x \\in [0,L], \\quad p(0,t) = 0, \\quad p(L,t) = 0,\n$$\nwhere $p(x,t)$ is the acoustic pressure and $c$ is the sound speed. Use the Spectral Element Method (SEM) with Legendre-Gauss-Lobatto (LGL) nodes and Lagrange interpolating polynomials of polynomial order $p$ on each element. Assume a uniform mesh with $E$ elements, each of length $h = L/E$. Use the LGL quadrature to construct a diagonal mass matrix and the stiffness matrix consistent with the weak form. Impose continuity across element interfaces by assembling a global $C^0$-continuous discretization that includes the shared interface nodes. Enforce the Dirichlet boundary conditions by eliminating the boundary degrees of freedom at $x=0$ and $x=L$ from the assembled system.\n\nFrom a suitable fundamental base, derive how the leapfrog (explicit central difference) time integration scheme applies to the resulting semi-discrete system and determine the maximum stable time-step $\\Delta t$ in seconds constrained by the discrete spatial operator’s spectrum. Do not assume or use any shortcut formulas; start from the weak form and the definition of the leapfrog method to arrive at the stability condition from first principles.\n\nYour program must:\n- Construct the local element matrices from the LGL quadrature on the reference interval $\\xi \\in [-1,1]$, using the mapping $x(\\xi)$ with Jacobian $J = h/2$, the Lagrange basis functions at LGL nodes of order $p$, the nodal derivative matrix with entries of $\\partial \\ell_j / \\partial \\xi$ evaluated at LGL nodes, and the LGL quadrature weights.\n- Assemble the global diagonal mass matrix and global stiffness matrix for the entire domain, with $C^0$ continuity enforced by identifying shared nodes at element interfaces.\n- Apply homogeneous Dirichlet boundary conditions by eliminating the boundary degrees of freedom corresponding to the nodes at $x=0$ and $x=L$.\n- Compute the largest eigenvalue of the generalized eigenproblem given by the assembled matrices, and then deduce the maximum stable $\\Delta t$ for the leapfrog scheme solely from the stability analysis of the semi-discrete system.\n\nUnits and output:\n- All geometric quantities must be handled in meters ($\\mathrm{m}$).\n- The sound speed must be in meters per second ($\\mathrm{m/s}$).\n- The final answers $\\Delta t$ must be expressed in seconds ($\\mathrm{s}$) and rounded to eight decimal places.\n\nTest suite:\nFor each of the following parameter sets $(L,E,p,c)$, compute the maximum stable $\\Delta t$ in seconds, rounded to eight decimal places:\n1. $(L=1.0, E=4, p=4, c=343.0)$\n2. $(L=2.0, E=8, p=6, c=1500.0)$\n3. $(L=1.0, E=1, p=2, c=2000.0)$\n4. $(L=1.0, E=2, p=1, c=1000.0)$\n5. $(L=0.3, E=12, p=8, c=343.0)$\n\nFinal output format:\nYour program should produce a single line of output containing the five results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), in the same order as the test suite above. Each result must be a float rounded to eight decimal places and expressed in seconds.",
            "solution": "The governing equation is the homogeneous 1D acoustic wave equation on a domain $x \\in [0,L]$ with homogeneous Dirichlet boundary conditions:\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}, \\quad p(0,t) = 0, \\quad p(L,t) = 0\n$$\nwhere $p(x,t)$ is the acoustic pressure and $c$ is the speed of sound.\n\n**1. Weak Formulation**\nTo derive the weak form, we multiply the wave equation by a suitable test function $v(x)$ that vanishes at the boundaries ($v(0)=v(L)=0$) and integrate over the domain $[0,L]$.\n$$\n\\int_0^L v \\frac{\\partial^2 p}{\\partial t^2} dx = \\int_0^L v c^2 \\frac{\\partial^2 p}{\\partial x^2} dx\n$$\nApplying integration by parts to the right-hand side and using the boundary conditions on $v(x)$ yields the weak form:\n$$\n\\int_0^L v \\frac{\\partial^2 p}{\\partial t^2} dx = -c^2 \\int_0^L \\frac{\\partial v}{\\partial x} \\frac{\\partial p}{\\partial x} dx\n$$\n\n**2. Spectral Element Discretization**\nThe domain is partitioned into $E$ elements $\\Omega_k$ of length $h=L/E$. Within each element, the solution is approximated using Lagrange polynomials $\\ell_j(\\xi)$ of order $p$ on $p+1$ Legendre-Gauss-Lobatto (LGL) nodes:\n$$\np(x(\\xi), t) \\approx \\sum_{j=0}^{p} p_j^k(t) \\ell_j(\\xi)\n$$\nSubstituting this expansion into the weak form leads to a system of ordinary differential equations (ODEs). For each element, we define the local mass matrix $M^k$ and stiffness matrix $K^k$:\n$$\nM^k_{ij} = \\int_{\\Omega_k} \\ell_i \\ell_j dx = J \\int_{-1}^1 \\ell_i(\\xi) \\ell_j(\\xi) d\\xi\n$$\n$$\nK^k_{ij} = \\int_{\\Omega_k} \\frac{\\partial\\ell_i}{\\partial x} \\frac{\\partial\\ell_j}{\\partial x} dx = \\frac{1}{J} \\int_{-1}^1 \\frac{d\\ell_i}{d\\xi} \\frac{d\\ell_j}{d\\xi} d\\xi\n$$\nwhere $J = h/2$ is the Jacobian. Using LGL quadrature, where the quadrature points are the LGL nodes, the mass matrix becomes diagonal (\"lumped\"):\n$$\nM^k_{ij} = J \\sum_{m=0}^p w_m \\ell_i(\\xi_m) \\ell_j(\\xi_m) = J w_i \\delta_{ij}\n$$\nThe stiffness matrix is evaluated exactly by the same quadrature rule:\n$$\nK^k_{ij} = \\frac{1}{J} \\sum_{m=0}^p w_m \\frac{d\\ell_i}{d\\xi}(\\xi_m) \\frac{d\\ell_j}{d\\xi}(\\xi_m)\n$$\n\n**3. Assembly and Boundary Conditions**\nGlobal matrices $M_{glob}$ and $K_{glob}$ are assembled, enforcing $C^0$ continuity. The homogeneous Dirichlet conditions are applied by eliminating the first and last rows and columns, resulting in matrices $M_{int}$ and $K_{int}$ for the interior degrees of freedom. The semi-discrete system for the vector of interior nodal pressures $\\mathbf{p}_{int}(t)$ is:\n$$\nM_{int} \\frac{d^2\\mathbf{p}_{int}}{dt^2} = -c^2 K_{int} \\mathbf{p}_{int} \\implies \\frac{d^2\\mathbf{p}_{int}}{dt^2} = -c^2 M_{int}^{-1} K_{int} \\mathbf{p}_{int}\n$$\n\n**4. Leapfrog Time Integration and Stability Analysis**\nThe second-order time derivative is discretized using the explicit central difference (leapfrog) scheme:\n$$\n\\frac{\\mathbf{p}_{int}^{n+1} - 2\\mathbf{p}_{int}^n + \\mathbf{p}_{int}^{n-1}}{(\\Delta t)^2} = -c^2 M_{int}^{-1} K_{int} \\mathbf{p}_{int}^n\n$$\nTo analyze stability, we propose a solution of the form $\\mathbf{p}_{int}^n = z^n \\mathbf{v}$, where $\\lambda$ and $\\mathbf{v}$ are an eigenvalue-eigenvector pair of the system matrix $A = c^2 M_{int}^{-1} K_{int}$ and $z$ is a complex amplification factor. Substituting this into the scheme leads to the characteristic equation for $z$:\n$$\nz^2 - 2z + 1 = -\\lambda (\\Delta t)^2 z \\implies z^2 + (\\lambda (\\Delta t)^2 - 2) z + 1 = 0\n$$\nFor the scheme to be stable, the magnitude of the roots must satisfy $|z| \\le 1$. The eigenvalues $\\lambda$ of $A$ are real and non-negative. Stability is maintained if the discriminant of the quadratic equation is non-positive, leading to complex conjugate roots with $|z|=1$.\n$$\n( \\lambda (\\Delta t)^2 - 2 )^2 - 4 \\le 0 \\implies -2 \\le \\lambda (\\Delta t)^2 - 2 \\le 2 \\implies \\lambda (\\Delta t)^2 \\le 4\n$$\nThis condition must hold for all eigenvalues, so the most restrictive constraint comes from the largest eigenvalue, $\\lambda_{\\max}$:\n$$\n\\lambda_{\\max} (\\Delta t)^2 \\le 4\n$$\nTherefore, the maximum stable time-step is:\n$$\n\\Delta t_{\\max} = \\frac{2}{\\sqrt{\\lambda_{\\max}}}\n$$\nwhere $\\lambda_{\\max}$ is the largest eigenvalue of the generalized eigenvalue problem $c^2 K_{int} \\mathbf{v} = \\lambda M_{int} \\mathbf{v}$.\n\n**5. Computational Procedure**\nThe algorithm to compute $\\Delta t_{\\max}$ is:\n1.  For given $(L, E, p, c)$, calculate element geometry $h = L/E$ and $J = h/2$.\n2.  Determine the LGL nodes, weights, and the nodal derivative matrix for order $p$.\n3.  Construct the local diagonal mass matrix and consistent stiffness matrix.\n4.  Assemble the global matrices $M_{glob}$ and $K_{glob}$.\n5.  Extract the interior sub-matrices $M_{int}$ and $K_{int}$ by applying boundary conditions.\n6.  Solve the generalized eigenvalue problem $c^2 K_{int} \\mathbf{v} = \\lambda M_{int} \\mathbf{v}$ to find the maximum eigenvalue $\\lambda_{\\max}$.\n7.  Calculate $\\Delta t_{\\max} = 2 / \\sqrt{\\lambda_{\\max}}$.",
            "answer": "[0.00008542,0.00001740,0.00008333,0.00050000,0.00000305]"
        }
    ]
}