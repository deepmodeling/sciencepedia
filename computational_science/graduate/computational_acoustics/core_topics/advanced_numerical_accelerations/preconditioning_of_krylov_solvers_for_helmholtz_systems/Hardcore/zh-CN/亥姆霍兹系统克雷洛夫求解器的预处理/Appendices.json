{
    "hands_on_practices": [
        {
            "introduction": "理论与实践的第一步是深刻理解问题的根源。本练习将引导你使用傅里叶分析——偏微分方程分析的基石——来揭示离散亥姆霍兹算子的谱特性。通过推导其离散傅里叶符号，你将亲眼看到为什么亥姆霍兹方程本质上难以用标准迭代方法求解，从而为预处理器的必要性奠定坚实的理论基础 ()。",
            "id": "4135003",
            "problem": "考虑一个一维、均匀的声学介质，其处于角频率为 $\\omega$、声速为 $c$ 的时谐状态，使得声压场 $u(x)$ 在长度为 $L$ 的周期性域上满足亥姆霍兹方程 $-\\frac{\\mathrm{d}^{2} u}{\\mathrm{d} x^{2}} - k^{2} u = f(x)$，其中 $k = \\omega / c$ 是波数。用 $n$ 个均匀间隔的网格点 $x_{j} = j h$（$j = 0, 1, \\dots, n-1$）对该域进行离散化，网格间距为 $h = L/n$，并施加周期性边界条件。使用标准的二阶中心有限差分近似来逼近二阶导数，从而构建作用于网格函数 $u_{j}$ 上的离散亥姆霍兹算子 $A$。\n\n从计算声学的第一性原理以及循环矩阵和离散傅里叶分析的基本性质出发，推导算子 $A$ 的离散傅里叶符号 $\\hat{A}(\\theta)$，用网格间距 $h$、波数 $k$ 和傅里叶相位 $\\theta \\in [0, 2\\pi)$ 来表示。然后，利用此符号来近似 $A$ 的特征值 $\\lambda(\\theta)$，并通过分析小 $\\theta$ 行为，解释在亥姆霍兹系统中常见的、谱在负实轴附近的聚集现象，这种现象在诸如广义最小残差（GMRES）算法等 Krylov 子空间方法的背景下经常被观察到。您的解释应量化最负值附近的局部谱密度，并描述这如何影响未预处理的 Krylov 迭代的收敛性，从而阐明在计算声学中使用预条件子的动机。\n\n将离散傅里叶符号 $\\hat{A}(\\theta)$ 的最终结果以单个闭式解析表达式的形式给出。不需要进行数值舍入，最终表达式中也不应包含任何物理单位。",
            "solution": "该问题陈述是计算声学和数值分析领域的一个有效练习。它具有科学依据，是适定的、客观的，并包含了进行完整推导和分析所需的所有信息。\n\n一维亥姆霍兹方程由下式给出\n$$-\\frac{\\mathrm{d}^{2} u}{\\mathrm{d} x^{2}} - k^{2} u = f(x)$$\n在长度为 $L$ 的周期性域上。波数为 $k = \\omega/c$。该域使用 $n$ 个均匀间隔的网格点 $x_{j} = j h$（$j = 0, 1, \\dots, n-1$）进行离散化，网格间距为 $h = L/n$。\n\n在网格点 $x_j$ 处，二阶导数的标准二阶中心有限差分近似为\n$$ \\frac{\\mathrm{d}^{2} u}{\\mathrm{d} x^{2}}\\bigg|_{x_j} \\approx \\frac{u(x_{j+1}) - 2u(x_j) + u(x_{j-1})}{h^2} = \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} $$\n其中 $u_j$ 表示 $u(x_j)$ 的数值近似。将此代入亥姆霍兹方程，得到离散系统：\n$$ -\\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} - k^2 u_j = f_j $$\n这个线性方程组可以写成矩阵形式 $Au = f$。离散亥姆霍兹算子 $A$ 作用于网格函数 $u_j$ 的行为是\n$$ (Au)_j = \\frac{1}{h^2}(2u_j - u_{j+1} - u_{j-1}) - k^2 u_j $$\n由于周期性边界条件，所有下标都以模 $n$ 的方式解释。这种结构使得矩阵 $A$ 成为一个循环矩阵。\n\n为了推导算子 $A$ 的离散傅里叶符号 $\\hat{A}(\\theta)$，我们分析它对离散傅里叶模式 $v_j = \\exp(i \\theta j)$ 的作用，其中 $\\theta \\in [0, 2\\pi)$ 是傅里叶相位。请注意，对于有限周期网格，其特征向量是具有相位 $\\theta_m = 2\\pi m / n$ 的离散傅里叶模式集合。符号 $\\hat{A}(\\theta)$ 是一个连续函数，它给出了无限域差分算子的特征值，并且其在 $\\theta_m$ 处的采样值产生了有限维循环矩阵 $A$ 的特征值。\n将 $A$ 应用于 $v_j$：\n$$ (Av)_j = \\frac{1}{h^2}(2e^{i \\theta j} - e^{i \\theta (j+1)} - e^{i \\theta (j-1)}) - k^2 e^{i \\theta j} $$\n将项 $e^{i \\theta j}$ 因子分解出来：\n$$ (Av)_j = \\left[ \\frac{1}{h^2}(2 - e^{i \\theta} - e^{-i \\theta}) - k^2 \\right] e^{i \\theta j} $$\n使用 Euler 恒等式 $e^{i \\theta} + e^{-i \\theta} = 2\\cos(\\theta)$，我们得到：\n$$ (Av)_j = \\left[ \\frac{2}{h^2}(1 - \\cos(\\theta)) - k^2 \\right] e^{i \\theta j} $$\n最后，应用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$ (Av)_j = \\left[ \\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right) - k^2 \\right] v_j $$\n括号中的表达式是算子 $A$ 的离散傅里叶符号：\n$$ \\hat{A}(\\theta) = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right) - k^2 $$\n\n$n \\times n$ 循环矩阵 $A$ 的特征值通过在离散傅里叶频率 $\\theta_m = 2\\pi m / n$（$m = 0, 1, \\dots, n-1$）处对符号进行采样来获得。\n$$ \\lambda_m = \\hat{A}(\\theta_m) = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi m}{n}\\right) - k^2 $$\n所有特征值的集合 $\\{\\lambda_m\\}_{m=0}^{n-1}$ 构成了 $A$ 的谱。这些特征值是实数，并且位于由 $\\lambda(\\theta) = \\hat{A}(\\theta)$（$\\theta \\in [0, 2\\pi)$）定义的曲线上。\n\n为了分析小 $\\theta$ 行为，我们对小的 $x$ 使用泰勒展开 $\\sin(x) \\approx x$。对于 $\\theta \\ll 1$：\n$$ \\hat{A}(\\theta) \\approx \\frac{4}{h^2}\\left(\\frac{\\theta}{2}\\right)^2 - k^2 = \\frac{\\theta^2}{h^2} - k^2 $$\n如果我们将傅里叶相位 $\\theta$ 与连续波数 $\\xi$ 和网格间距 $h$ 的乘积等同起来，即 $\\theta = \\xi h$，则该近似变为 $\\hat{A}(\\theta) \\approx \\xi^2 - k^2$。这恰好是连续微分算子 $-\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2} - k^2$ 的符号，这证明了有限差分格式对于长波模式（小 $\\xi$，因此小 $\\theta$）的一致性。\n\n谱的聚集与特征值的密度有关。特征值 $\\{\\lambda_m\\}$ 是函数 $\\lambda(\\theta) = \\hat{A}(\\theta)$ 在均匀间隔点 $\\theta_m$ 上的离散采样。特征值的局部密度与导数 $|d\\lambda/d\\theta|$ 的大小成反比。\n$$ \\frac{d\\lambda}{d\\theta} = \\frac{d}{d\\theta}\\left[\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right) - k^2\\right] = \\frac{4}{h^2} \\cdot 2\\sin\\left(\\frac{\\theta}{2}\\right)\\cos\\left(\\frac{\\theta}{2}\\right) \\cdot \\frac{1}{2} = \\frac{2}{h^2}\\sin(\\theta) $$\n导数在 $\\theta = 0$ 和 $\\theta = \\pi$ 处为零。这表明特征值在 $\\lambda$ 的相应值处聚集：\n\\begin{itemize}\n    \\item 在 $\\theta = 0$ 处：$\\lambda(0) = -k^2$。这是最小特征值，对应于低频模式。\n    \\item 在 $\\theta = \\pi$ 处：$\\lambda(\\pi) = \\frac{4}{h^2} - k^2$。这是最大特征值，对应于网格上可分辨的最高频模式。\n\\end{itemize}\n问题询问的是最负值附近的聚集情况，这发生在 $\\theta \\approx 0$ 处，对应于 $\\lambda \\approx -k^2$。\n为了量化这一点，我们可以计算谱密度，或称态密度，$\\rho(\\lambda)$。对于小 $\\theta$，我们有 $\\lambda \\approx \\theta^2/h^2 - k^2$，这意味着对于 $\\lambda > -k^2$，有 $\\theta \\approx h\\sqrt{\\lambda+k^2}$。特征值不大于 $\\lambda$ 的状态数为 $N(\\lambda)$。由于 $\\lambda_m = \\lambda_{n-m}$，除了 $m=0$ 和 $m=n/2$ 外，每个特征值都对应两个模式，所以 $N(\\lambda)$ 与相应的模式指数 $m$ 成正比。由于 $\\theta_m = 2\\pi m/n$，因此 $m=n\\theta_m/(2\\pi)$。因此，$N(\\lambda) \\propto \\theta \\propto \\sqrt{\\lambda+k^2}$。\n那么态密度为\n$$ \\rho(\\lambda) = \\frac{dN}{d\\lambda} \\propto \\frac{d}{d\\lambda}\\sqrt{\\lambda+k^2} = \\frac{1}{2\\sqrt{\\lambda+k^2}} $$\n当 $\\lambda$ 从上方趋近于 $-k^2$ 时，密度 $\\rho(\\lambda)$ 发散。这个数学奇点证实了在谱的最负部分附近存在强烈的特征值聚集。\n\n这种谱分布对像 GMRES 这样的未预处理的 Krylov 子空间求解器的收敛性具有深远的影响。\n\\begin{enumerate}\n    \\item \\textbf{不定性与宽谱}：对于网格能解析波的物理相关场景（例如，$kh \\ll 1$），波数 $k^2$ 远小于离散拉普拉斯谱的上界 $4/h^2$。因此，$A$ 的谱 $[\\,-k^2, 4/h^2-k^2]$ 同时包含负特征值和正特征值。这种不定算子对许多迭代求解器都具有挑战性。此外，随着网格细化（$h \\to 0$），谱宽 $4/h^2$ 增大，从而加剧了收敛问题。\n    \\item \\textbf{病态}：如果 $k^2$ 接近离散拉普拉斯算子的某个特征值 $\\frac{4}{h^2}\\sin^2(\\pi m/n)$，那么矩阵 $A$ 就有一个接近于零的特征值，并且是病态的，导致收敛极其缓慢或停滞。\n    \\item \\textbf{聚集效应}：在 $\\lambda = -k^2$ 附近的高特征值密度意味着许多低频模式具有非常相似的特征值。GMRES 算法在谱上构建一个最优多项式近似，它难以同时解析这个模式簇和宽谱另一端的模式。一个低次多项式无法在这样一个分散且宽泛的值域上都保持很小。\n\\end{enumerate}\n这种不良的谱结构使得预处理成为必要。亥姆霍兹方程的一个好的预条件子，例如移位拉普拉斯预条件子 $P = -\\Delta - (k^2 + i\\epsilon)I$（对于某个小的 $\\epsilon > 0$），将系统转换为 $P^{-1}A u = P^{-1}f$。预处理后算子 $P^{-1}A$ 的特征值为 $\\mu_m = \\frac{\\lambda_m(A)}{\\lambda_m(P)} = \\frac{\\lambda_m(\\text{Laplacian})-k^2}{\\lambda_m(\\text{Laplacian})-k^2-i\\epsilon}$。这些特征值在复平面上聚集在 $1$ 附近，除了少数有问题的特征值（其中 $\\lambda_m(\\text{Laplacian}) \\approx k^2$）被映射到原点附近。这种紧凑、良态的谱使得 GMRES 能够在少量迭代中收敛，并且收敛性在很大程度上独立于网格尺寸 $h$ 和波数 $k$。因此，对离散符号及其产生的特征值分布的分析，为在计算声学中开发先进的预条件子提供了根本动机。",
            "answer": "$$\\boxed{\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) - k^{2}}$$"
        },
        {
            "introduction": "在理解了为什么需要预处理器之后，接下来的实践将通过一个具体例子展示它是如何工作的。通过分析一个小型且易于处理的 $2 \\times 2$ 系统，你可以显式地计算出移位拉普拉斯预处理器的误差传播算子，并理解其谱半径如何直接影响收敛性。这个练习将理论与实践联系起来，让你在一个可控的环境中直观地看到预处理如何改善问题 ()。",
            "id": "4135011",
            "problem": "考虑计算声学中的一维齐次亥姆霍兹边值问题，\n$$-u''(x) - k^{2} u(x) = f(x), \\quad x \\in (0,1),$$\n其齐次狄利克雷边界条件为 $u(0) = u(1) = 0$。使用均匀网格间距 $h = 1/3$ 将区间离散化，设 $N=2$ 个内部点，并用标准中心有限差分公式近似二阶导数。这会得到一个离散亥姆霍兹系统 $A u = b$，其中\n$$A = L - k^{2} I,$$\n其中 $L$ 是离散负拉普拉斯矩阵\n$$L = \\frac{1}{h^{2}}\\begin{pmatrix}2  -1 \\\\ -1  2 \\end{pmatrix}。$$\n采用移位拉普拉斯预条件子\n$$M = L - \\left(k^{2} + \\mathrm{i}\\,\\sigma\\right) I,$$\n其中 $\\mathrm{i}$ 是虚数单位，$\\sigma > 0$ 是一个实数吸收参数。设波数为 $k = 4$，吸收参数为 $\\sigma = 8$。\n\n从离散算子的定义以及具有齐次狄利克雷条件的离散拉普拉斯算子的性质出发，推导误差传播算子\n$$E = I - M^{-1}A,$$\n并利用谱分析计算其谱半径 $\\rho(E)$。\n\n然后，利用广义最小残差方法 (GMRES) 的定义和 $M^{-1}A$ 的谱分解，解释 $E$ 的谱半径和 $M^{-1}A$ 的（非）正规性如何影响 GMRES 残差的衰减，并明确指出特征向量条件数的作用。\n\n最后，给出给定参数下 $\\rho(E)$ 的数值。将答案四舍五入到四位有效数字。最终的数值答案是无量纲的；不要包含任何单位。",
            "solution": "该问题提法明确，科学依据充分，并为得出完整解提供了所有必要信息。我们首先分析指定的矩阵及其谱性质。\n\n对于齐次狄利克雷边界条件，采用 $N=2$ 个内部点和网格间距 $h=1/3$ 的有限差分离散化，得到离散负拉普拉斯矩阵 $L$：\n$$L = \\frac{1}{h^{2}}\\begin{pmatrix}2  -1 \\\\ -1  2 \\end{pmatrix} = \\frac{1}{(1/3)^{2}}\\begin{pmatrix}2  -1 \\\\ -1  2 \\end{pmatrix} = 9 \\begin{pmatrix}2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix}18  -9 \\\\ -9  18 \\end{pmatrix}。$$\n$N \\times N$ 离散拉普拉斯算子的特征值由公式 $\\mu_j = \\frac{4}{h^2} \\sin^2\\left(\\frac{j\\pi}{2(N+1)}\\right)$ 给出，其中 $j=1, \\dots, N$。\n对于 $N=2$ 和 $h=1/3$，我们有：\n$$\\mu_1 = \\frac{4}{(1/3)^2} \\sin^2\\left(\\frac{\\pi}{2(3)}\\right) = 36 \\sin^2\\left(\\frac{\\pi}{6}\\right) = 36 \\left(\\frac{1}{2}\\right)^2 = 9。$$\n$$\\mu_2 = \\frac{4}{(1/3)^2} \\sin^2\\left(\\frac{2\\pi}{2(3)}\\right) = 36 \\sin^2\\left(\\frac{\\pi}{3}\\right) = 36 \\left(\\frac{\\sqrt{3}}{2}\\right)^2 = 27。$$\n作为一个实对称矩阵，$L$ 拥有一组标准正交的特征向量基。\n\n离散亥姆霍兹算子 $A$ 和移位拉普拉斯预条件子 $M$ 定义如下：\n$$A = L - k^{2} I$$\n$$M = L - (k^{2} + \\mathrm{i}\\,\\sigma) I$$\n由于 $A$ 和 $M$ 都是 $L$ 的多项式，它们与 $L$ 共享相同的特征向量。设 $v_j$ 是 $L$ 的一个特征向量，其对应的特征值为 $\\mu_j$。那么，$A$ 和 $M$ 的相应特征值为：\n$$\\lambda_j(A) = \\mu_j - k^2$$\n$$\\lambda_j(M) = \\mu_j - k^2 - \\mathrm{i}\\,\\sigma$$\n\n预处理理查森迭代的误差传播算子是 $E = I - M^{-1}A$。我们可以通过注意到 $A = M + \\mathrm{i}\\,\\sigma I$ 来简化这个表达式。\n$$E = I - M^{-1}(M + \\mathrm{i}\\,\\sigma I) = I - (M^{-1}M + \\mathrm{i}\\,\\sigma M^{-1}) = I - (I + \\mathrm{i}\\,\\sigma M^{-1}) = -\\mathrm{i}\\,\\sigma M^{-1}。$$\n因此，$E$ 的特征值由下式给出：\n$$\\lambda_j(E) = -\\mathrm{i}\\,\\sigma \\lambda_j(M^{-1}) = -\\mathrm{i}\\,\\sigma \\frac{1}{\\lambda_j(M)} = \\frac{-\\mathrm{i}\\,\\sigma}{\\mu_j - k^2 - \\mathrm{i}\\,\\sigma}。$$\n$E$ 的谱半径，记为 $\\rho(E)$，是其特征值模长的最大值：\n$$\\rho(E) = \\max_{j} |\\lambda_j(E)| = \\max_{j} \\left| \\frac{-\\mathrm{i}\\,\\sigma}{\\mu_j - k^2 - \\mathrm{i}\\,\\sigma} \\right| = \\max_{j} \\frac{|\\mathrm{i}\\,\\sigma|}{|\\mu_j - k^2 - \\mathrm{i}\\,\\sigma|} = \\max_{j} \\frac{\\sigma}{\\sqrt{(\\mu_j - k^2)^2 + \\sigma^2}}。$$\n\n给定参数 $k=4$ 和 $\\sigma=8$，我们有 $k^2 = 16$。\n对于第一个特征值 $\\mu_1 = 9$：\n$$|\\lambda_1(E)| = \\frac{8}{\\sqrt{(9 - 16)^2 + 8^2}} = \\frac{8}{\\sqrt{(-7)^2 + 8^2}} = \\frac{8}{\\sqrt{49 + 64}} = \\frac{8}{\\sqrt{113}}。$$\n对于第二个特征值 $\\mu_2 = 27$：\n$$|\\lambda_2(E)| = \\frac{8}{\\sqrt{(27 - 16)^2 + 8^2}} = \\frac{8}{\\sqrt{11^2 + 8^2}} = \\frac{8}{\\sqrt{121 + 64}} = \\frac{8}{\\sqrt{185}}。$$\n为了求谱半径，我们比较这两个值。因为 $113  185$，所以我们有 $\\sqrt{113}  \\sqrt{185}$，因此 $\\frac{1}{\\sqrt{113}}  \\frac{1}{\\sqrt{185}}$。\n因此，谱半径为：\n$$\\rho(E) = \\max\\left(\\frac{8}{\\sqrt{113}}, \\frac{8}{\\sqrt{185}}\\right) = \\frac{8}{\\sqrt{113}}。$$\n\n接下来，我们分析谱性质对 GMRES 方法收敛性的影响。GMRES 迭代作用的矩阵是预处理矩阵 $C = M^{-1}A$。GMRES 的收敛性是复杂的。对于一个可对角化矩阵 $C = VDV^{-1}$，其中 $D$ 是特征值组成的对角矩阵，$V$ 是特征向量组成的矩阵，第 $m$ 次迭代的残差 $r_m$ 有如下上界：\n$$\\frac{\\|r_m\\|_2}{\\|r_0\\|_2} \\le \\kappa_2(V) \\inf_{p \\in \\mathcal{P}_m, p(0)=1} \\max_{\\lambda \\in \\Lambda(C)} |p(\\lambda)|,$$\n其中 $\\mathcal{P}_m$ 是次数至多为 $m$ 的多项式集合，$\\Lambda(C)$ 是 $C$ 的谱，$\\kappa_2(V) = \\|V\\|_2 \\|V^{-1}\\|_2$ 是特征向量矩阵的条件数。\n\n误差算子的谱半径 $\\rho(E) = \\rho(I - M^{-1}A)$ 决定了 GMRES 的渐近收敛速率。$\\rho(E)  1$ 是收敛的必要条件。$\\rho(E)$ 越小，残差的最终渐近衰减越快。\n\n预处理矩阵 $M^{-1}A$ 的（非）正规性决定了 GMRES 的预渐近或瞬态行为。矩阵的正规性与其特征向量的条件数有关。\n一个矩阵是正规的当且仅当它是酉可对角化的，这意味着它的特征向量构成一个标准正交集。在这种情况下，$V$ 可以选择为一个酉矩阵，此时 $\\kappa_2(V) = 1$。当 $M^{-1}A$ 是正规矩阵时，GMRES 的收敛性完全由 $M^{-1}A$ 的特征值决定，并且上述界是紧的。\n然而，如果 $M^{-1}A$ 是非正规的，它的特征向量就不是正交的，并且特征向量矩阵的条件数 $\\kappa_2(V)$ 可能非常大。这就是“特征向量条件数的作用”。一个大的 $\\kappa_2(V)$ 表明特征向量近似线性相关。在这种情况下，即使特征值表现良好且 $\\rho(E)$ 很小，因子 $\\kappa_2(V)$ 也可能在界中占主导地位，导致 GMRES 残差在达到由 $\\rho(E)$ 决定的渐近速率之前，经历一个长时间的停滞期，其间残差下降非常缓慢，甚至可能短暂增加。这种现象是将 GMRES 应用于高度非正规矩阵的一个标志。\n\n在本问题中，$L$ 是一个实对称矩阵。$A$ 和 $M$ 是 $L$ 的多项式。因此，$A$、$M$ 和 $L$ 可以被同一个酉矩阵（在本例中是实正交矩阵）的特征向量同时对角化。因此，预处理矩阵 $M^{-1}A$ 也可以被这同一个酉矩阵对角化，这意味着 $M^{-1}A$ 是一个正规矩阵。对于这个特定的 $2 \\times 2$ 问题，$\\kappa_2(V)=1$，非正规性不是一个影响因素。然而，对于更一般的亥姆霍兹离散化（例如，具有可变系数或在更高维度下），得到的离散算子通常不可交换，预处理矩阵 $M^{-1}A$ 通常是高度非正规的，这使得特征向量条件数成为 GMRES 收敛性的一个关键因素。\n\n最后，我们计算谱半径的数值。\n$$\\rho(E) = \\frac{8}{\\sqrt{113}} \\approx 0.7525795...$$\n四舍五入到四位有效数字，我们得到 $\\rho(E) \\approx 0.7526$。",
            "answer": "$$\\boxed{0.7526}$$"
        },
        {
            "introduction": "在掌握了基础之后，我们将目光投向解决大规模实际问题时面临的工程挑战。先进的预处理器，如多重网格法，虽然功能强大，但其性能依赖于精细的参数调整。本练习将带你进入计算科学的性能建模领域，要求你为使用多重网格作为预处理器的 GMRES 求解器构建一个计算成本模型，并对其进行优化。你将学习如何在预处理器单次迭代的成本与它所带来的迭代次数减少之间做出权衡，以实现总体求解时间的最优化 ()。",
            "id": "4134986",
            "problem": "考虑自由空间中密度和波速恒定的时谐声波方程，该方程可导出亥姆霍兹算子。在包含 $N$ 个内部未知量的均匀三维网格上进行二阶有限差分方法离散后，我们得到一个线性系统 $A u = f$，其中 $A \\in \\mathbb{C}^{N \\times N}$ 是稀疏且不定的。为求解 $A u = f$，考虑使用重启的广义最小残差方法（GMRES），重启参数为 $m$，并采用右预处理。该预处理器是对移位的拉普拉斯算子 $A_{\\alpha} = \\Delta + (1 + \\mathrm{i} \\alpha) k^{2}$（其中 $k  0$ 为定值，$\\alpha  0$ 为移位量）应用单个多重网格V循环。假设一个几何多重网格层级结构，具有 $L \\geq 2$ 个层级，$d=3$ 个空间维度，并且每个空间方向上都以因子2进行均匀粗化，因此每层的未知数数量满足 $N_{\\ell} = N / \\gamma^{\\ell}$，其中 $\\gamma = 2^{d} = 8$，层级索引为 $\\ell = 0, 1, \\dots, L-1$（$\\ell = 0$ 为最细层）。\n\n采用以下计算成本模型，所有成本均以浮点运算次数衡量，并假定与相关网格层级的未知数数量成线性关系：\n\n- 在最细层上，一次与亥姆霍兹矩阵 $A$ 的稀疏矩阵向量乘法的成本为 $c_{A} N$，其中 $c_{A}  0$。\n- 在层级 $\\ell$ 上，一次光滑迭代（例如，应用于 $A_{\\alpha}$ 的 $\\omega$-Jacobi 或 Gauss–Seidel 方法）的成本为 $c_{s} N_{\\ell}$，其中 $c_{s}  0$。每个V循环在除最粗层外的每一层上使用 $s$ 次预光滑和 $s$ 次后光滑迭代，总计 $2 s$ 次光滑迭代。\n- 每个V循环中，在除最粗层外的每一层上，所有非光滑的层级局部操作（例如，使用 $A_{\\alpha}$ 进行残差计算、限制和延拓）的成本被汇总为每层 $c_{0} N_{\\ell}$，其中 $c_{0} \\geq 0$。\n- 最粗层的求解成本为 $c_{c} N_{L-1}$，其中 $c_{c} \\geq 0$。\n- 每次 GMRES 迭代中，针对维度最多为 $m$ 的当前子空间进行的 Arnoldi 正交化和归一化过程，其平均成本模型为 $c_{O} m N$，其中 $c_{O}  0$。\n\n假设应用于右预处理算子 $A M^{-1}$ 的 GMRES 方法具有以下经验校准的迭代次数模型，其中 $M^{-1}$ 表示对 $A_{\\alpha}$ 的多重网格求解器的一个V循环，如上所述，每层有 $s$ 次预光滑和后光滑步骤：\n$$\nI(s) = \\eta + \\frac{\\beta}{s},\n$$\n其中 $\\eta  0$ 和 $\\beta  0$ 均与 $s$ 无关。该模型反映了随着 $s$ 增加而收益递减的现象，以及由于非光滑误差分量和算子的不定性而存在的 $\\eta$ 次迭代的渐近下界。\n\n任务：\n1. 从给定的成本模型和几何粗化出发，推导右预处理 GMRES 的平均每次迭代计算复杂度 $C_{\\mathrm{iter}}(s)$ 的表达式，该表达式是关于 $s$, $N$, $m$, $\\gamma$, $L$ 以及正常数 $c_{A}$, $c_{s}$, $c_{0}$, $c_{c}$ 和 $c_{O}$ 的函数。您的表达式必须是闭式形式，且不得包含逐层求和。\n2. 使用 $C_{\\mathrm{iter}}(s)$ 和上述迭代次数模型 $I(s)$，构建总求解时间代理 $T(s) = I(s)\\, C_{\\mathrm{iter}}(s)$，并确定最小化 $T(s)$ 的实值 $s^{\\star}  0$。用给定符号将 $s^{\\star}$ 表示为闭式形式。不要对 $s$ 施加整数约束。\n\n请仅提供 $s^{\\star}$ 的单个闭式表达式作为最终答案。无需进行数值计算，也无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是科学上成立、适定、客观且自洽的。它提出了一个偏微分方程数值线性代数领域的标准算法分析任务。我们开始进行求解。\n\n问题分为两个任务：\n1. 推导右预处理 GMRES 方法的平均每次迭代计算复杂度 $C_{\\mathrm{iter}}(s)$。\n2. 确定最佳光滑迭代次数 $s^{\\star}$，以最小化总求解时间代理 $T(s) = I(s) C_{\\mathrm{iter}}(s)$。\n\n**第1部分：每次迭代复杂度 $C_{\\mathrm{iter}}(s)$ 的推导**\n\n对于带有预处理器 $M$ 的系统 $A u = f$，单次右预处理 GMRES 迭代包括以下主要计算步骤：\n1. 将预处理器应用于向量 $v$：$w = M^{-1} v$。在本问题中，$M^{-1}$ 是一个多重网格V循环。\n2. 与系统矩阵 $A$ 进行一次稀疏矩阵向量乘法：$z = A w$。\n3. Arnoldi 正交化和归一化步骤。\n\n每次迭代的总成本 $C_{\\mathrm{iter}}(s)$ 是这些部分成本的总和。\n$$\nC_{\\mathrm{iter}}(s) = C_{V\\text{-cycle}}(s) + C_{\\text{MatVec}} + C_{\\text{Arnoldi}}\n$$\n根据问题的成本模型：\n- 稀疏矩阵向量乘法的成本为 $C_{\\text{MatVec}} = c_{A} N$。\n- Arnoldi 过程的成本为 $C_{\\text{Arnoldi}} = c_{O} m N$。\n\n预处理器应用的成本 $C_{V\\text{-cycle}}(s)$ 对应于一个多重网格V循环。V循环在索引为 $\\ell = 0, 1, \\dots, L-1$ 的 $L$ 个层级的层级结构上操作。其成本是每一层上所做工作的总和。\n\n问题指定了每一层上的工作量：\n- 对于任意层级 $\\ell \\in \\{0, 1, \\dots, L-2\\}$（除最粗层外的所有层级），工作包括 $2s$ 次光滑迭代和其他局部操作。层级 $\\ell$ 的成本为 $(2sc_s + c_0)N_\\ell$。\n- 在最粗层 $\\ell = L-1$ 上，执行一次直接求解，成本为 $c_c N_{L-1}$。\n\n一个V循环的总成本是这些成本在所有层级上的总和：\n$$\nC_{V\\text{-cycle}}(s) = \\left( \\sum_{\\ell=0}^{L-2} (2sc_s + c_0) N_\\ell \\right) + c_c N_{L-1}\n$$\n给定关系式 $N_\\ell = N / \\gamma^\\ell$。将其代入V循环成本的表达式中：\n$$\nC_{V\\text{-cycle}}(s) = \\left( \\sum_{\\ell=0}^{L-2} (2sc_s + c_0) \\frac{N}{\\gamma^\\ell} \\right) + c_c \\frac{N}{\\gamma^{L-1}}\n$$\n我们可以将不依赖于求和索引 $\\ell$ 的项提取出来：\n$$\nC_{V\\text{-cycle}}(s) = N(2sc_s + c_0) \\sum_{\\ell=0}^{L-2} \\left(\\frac{1}{\\gamma}\\right)^\\ell + N c_c \\gamma^{-(L-1)}\n$$\n该求和是一个有限几何级数 $\\sum_{k=0}^{n} r^k = \\frac{1-r^{n+1}}{1-r}$。这里，求和是从 $\\ell=0$ 到 $L-2$，所以共有 $L-1$ 项。\n$$\n\\sum_{\\ell=0}^{L-2} \\left(\\frac{1}{\\gamma}\\right)^\\ell = \\frac{1 - (1/\\gamma)^{L-1}}{1 - 1/\\gamma} = \\frac{1 - \\gamma^{-(L-1)}}{(\\gamma-1)/\\gamma} = \\frac{\\gamma(1 - \\gamma^{-(L-1)})}{\\gamma-1}\n$$\n我们用 $S_{L, \\gamma} = \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1}$ 表示这个和。V循环的成本变为：\n$$\nC_{V\\text{-cycle}}(s) = N \\left( (2sc_s + c_0) S_{L, \\gamma} + c_c \\gamma^{-L+1} \\right)\n$$\n现在，我们组合所有部分来求得每次迭代的总成本 $C_{\\mathrm{iter}}(s)$：\n$$\nC_{\\mathrm{iter}}(s) = N \\left( (2sc_s + c_0) S_{L, \\gamma} + c_c \\gamma^{-L+1} \\right) + c_A N + c_O m N\n$$\n提取因子 $N$ 并整理各项，我们得到每次迭代复杂度的闭式表达式：\n$$\nC_{\\mathrm{iter}}(s) = N \\left[ c_A + c_O m + c_c \\gamma^{-L+1} + (2sc_s + c_0) \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1} \\right]\n$$\n\n**第2部分：总求解时间代理 $T(s)$ 的最小化**\n\n总求解时间代理为 $T(s) = I(s) C_{\\mathrm{iter}}(s)$。我们已知迭代次数模型为 $I(s) = \\eta + \\frac{\\beta}{s}$。\n我们想要找到使 $T(s)$ 最小化的 $s^{\\star}  0$。\n\n首先，我们将 $C_{\\mathrm{iter}}(s)$ 表示为 $s$ 的线性函数：$C_{\\mathrm{iter}}(s) = K_1 s + K_2$。\n根据第1部分推导的表达式：\n$$\nK_1 = 2 N c_s \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1}\n$$\n$$\nK_2 = N \\left[ c_A + c_O m + c_c \\gamma^{-L+1} + c_0 \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1} \\right]\n$$\n根据参数的约束条件（$c_A, c_s, c_O, \\eta, \\beta  0$，$c_0, c_c \\ge 0$，$L \\ge 2$，$\\gamma  1$），$K_1$ 和 $K_2$ 都是正常数。\n\n总成本函数为：\n$$\nT(s) = \\left(\\eta + \\frac{\\beta}{s}\\right) (K_1 s + K_2) = \\eta K_1 s + \\eta K_2 + \\beta K_1 + \\frac{\\beta K_2}{s}\n$$\n为了找到最小值，我们计算 $T(s)$ 关于 $s$ 的导数，并令其为零：\n$$\n\\frac{dT}{ds} = \\frac{d}{ds} \\left( \\eta K_1 s + \\eta K_2 + \\beta K_1 + \\beta K_2 s^{-1} \\right) = \\eta K_1 - \\beta K_2 s^{-2}\n$$\n令 $s = s^\\star$ 时的导数为零：\n$$\n\\eta K_1 - \\frac{\\beta K_2}{(s^\\star)^2} = 0 \\implies (s^\\star)^2 = \\frac{\\beta K_2}{\\eta K_1} \\implies s^\\star = \\sqrt{\\frac{\\beta K_2}{\\eta K_1}}\n$$\n我们取正根，因为 $s$ 必须为正。为确认这是一个最小值，我们检查二阶导数：\n$$\n\\frac{d^2 T}{ds^2} = \\frac{d}{ds} (\\eta K_1 - \\beta K_2 s^{-2}) = 2 \\beta K_2 s^{-3}\n$$\n由于 $\\beta  0$，$K_2  0$，并且我们考虑 $s  0$，因此有 $\\frac{d^2 T}{ds^2}  0$。这证实了当 $s0$ 时 $T(s)$ 是一个凸函数，且 $s^\\star$ 对应于一个全局最小值。\n\n最后，我们将 $K_1$ 和 $K_2$ 的表达式代入 $s^\\star$ 的公式中：\n$$\n\\frac{K_2}{K_1} = \\frac{N \\left[ c_A + c_O m + c_c \\gamma^{-L+1} + c_0 \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1} \\right]}{2 N c_s \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1}}\n$$\n因子 $N$ 被消去。我们来化简这个比率：\n$$\n\\frac{K_2}{K_1} = \\frac{c_A + c_O m + c_c \\gamma^{-L+1}}{2 c_s \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1}} + \\frac{c_0 \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1}}{2 c_s \\frac{\\gamma(1 - \\gamma^{-L+1})}{\\gamma-1}} = \\frac{(\\gamma-1)(c_A + c_O m + c_c \\gamma^{-L+1})}{2 c_s \\gamma(1 - \\gamma^{-L+1})} + \\frac{c_0}{2c_s}\n$$\n将此代入 $s^\\star$ 的表达式中：\n$$\ns^\\star = \\sqrt{\\frac{\\beta}{\\eta} \\left( \\frac{(\\gamma-1)(c_A + c_O m + c_c \\gamma^{-L+1})}{2 c_s \\gamma(1 - \\gamma^{-L+1})} + \\frac{c_0}{2c_s} \\right)}\n$$\n为了得到最终答案，可以对该表达式稍作整理。\n$$\ns^\\star = \\sqrt{\\frac{\\beta}{2 \\eta c_s} \\left( \\frac{(\\gamma-1)(c_A + c_O m + c_c \\gamma^{-L+1})}{\\gamma(1 - \\gamma^{-L+1})} + c_0 \\right)}\n$$\n这就是最佳光滑迭代次数 $s^\\star$ 的最终闭式表达式。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{\\beta}{2 \\eta c_{s}} \\left( \\frac{(\\gamma-1)(c_{A} + c_{O} m + c_{c} \\gamma^{1-L})}{\\gamma(1 - \\gamma^{1-L})} + c_{0} \\right)}}\n$$"
        }
    ]
}