{
    "hands_on_practices": [
        {
            "introduction": "掌握基尔霍夫-亥姆霍兹积分定理的第一步是深刻理解其推导过程。本练习旨在引导您将标准的三维推导过程应用于二维情境，这需要您运用格林第二恒等式和奇点处理等核心原理 。通过这个过程，您将不仅仅是记忆公式，而是真正掌握该定理的数学基础。",
            "id": "4143681",
            "problem": "考虑一个有界、单连通、边界光滑的区域 $V \\subset \\mathbb{R}^2$，其边界曲线 $S$ 为正向。设 $p(\\mathbf{r})$ 是一个声压场，在 $V$ 中满足齐次 Helmholtz 方程 $(\\nabla^2 + k^2) p = 0$，其中 $k > 0$ 是声波数，并假设 $p$ 在 $S$ 上是充分光滑的。设 $G(\\mathbf{r},\\mathbf{r}')$ 是二维 Helmholtz 算子的自由空间出射 Green 函数，由 $(\\nabla_{\\mathbf{r}'}^2 + k^2) G(\\mathbf{r},\\mathbf{r}') = -\\delta(\\mathbf{r} - \\mathbf{r}')$ 和 Sommerfeld 辐射条件 (SRC) 定义，其显式形式为 $G(\\mathbf{r},\\mathbf{r}') = \\frac{i}{4} H_0^{(1)}\\!\\left(k \\left\\lVert \\mathbf{r} - \\mathbf{r}' \\right\\rVert \\right)$，其中 $H_\\nu^{(1)}$ 表示第一类 $\\nu$ 阶 Hankel 函数。\n\n从 Helmholtz 方程、Green 第二恒等式和散度定理出发，推导二维的 Kirchhoff-Helmholtz 积分定理（KH 积分定理），以表示内部场点 $\\mathbf{x} \\in V$ 处的 $p(\\mathbf{x})$ 为一个包含 $p$、$G$ 以及在 $S$ 上的外法向导数的线积分。在推导中，将边界积分变量视为 $\\mathbf{y} \\in S$，将 $\\mathbf{y}$ 处的外单位法向量记为 $\\mathbf{n}(\\mathbf{y})$，并使用 $R = \\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert$。然后，选择正确给出 $p(\\mathbf{x})$ 积分表示的选项，该表示使用给定的 $G(\\mathbf{x},\\mathbf{y})$ 及其关于 $\\mathbf{y}$ 的外法向导数，以在 $S$ 上的线积分形式表示。\n\nA. $p(\\mathbf{x}) = \\displaystyle \\int_S \\left[ \\frac{i}{4} H_0^{(1)}(k R)\\, \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) - p(\\mathbf{y})\\, \\frac{i k}{4} H_1^{(1)}(k R)\\, \\frac{(\\mathbf{x} - \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R} \\right] \\, ds(\\mathbf{y})$\n\nB. $p(\\mathbf{x}) = \\displaystyle \\int_S \\left[ p(\\mathbf{y})\\, \\frac{i k}{4} H_1^{(1)}(k R)\\, \\frac{(\\mathbf{x} - \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R} - \\frac{i}{4} H_0^{(1)}(k R)\\, \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) \\right] \\, ds(\\mathbf{y})$\n\nC. $p(\\mathbf{x}) = \\displaystyle \\int_S \\left[ \\frac{i}{4} H_0^{(1)}(k R)\\, \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) - p(\\mathbf{y})\\, \\frac{i}{4} H_1^{(1)}(k R)\\, \\frac{(\\mathbf{x} - \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R} \\right] \\, ds(\\mathbf{y})$\n\nD. $p(\\mathbf{x}) = \\displaystyle \\int_S \\left[ \\frac{i}{4} H_0^{(1)}(k R)\\, \\partial_{n(\\mathbf{x})} p(\\mathbf{x}) - p(\\mathbf{y})\\, \\frac{i k}{4} H_1^{(1)}(k R)\\, \\frac{(\\mathbf{y} - \\mathbf{x}) \\cdot \\mathbf{n}(\\mathbf{x})}{R} \\right] \\, ds(\\mathbf{y})$\n\n这里，$\\partial_{n(\\mathbf{y})}$ 表示在 $S$ 上关于 $\\mathbf{y}$ 的外法向导数，而 $ds(\\mathbf{y})$ 是沿 $S$ 的线元。",
            "solution": "该问题要求推导二维 Kirchhoff-Helmholtz 积分定理，用于表示体积 $V$ 内的一个内部点 $\\mathbf{x}$，并从给定选项中选出正确的积分表示。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   一个有界、单连通、边界光滑的区域 $V \\subset \\mathbb{R}^2$。\n-   一个正向的边界曲线 $S$。\n-   一个声压场 $p(\\mathbf{r})$，在 $V$ 中满足齐次 Helmholtz 方程 $(\\nabla^2 + k^2) p = 0$。\n-   声波数 $k > 0$。\n-   $p$ 在 $S$ 上是充分光滑的。\n-   $G(\\mathbf{r},\\mathbf{r}')$ 是二维 Helmholtz 算子的自由空间出射 Green 函数，满足 $(\\nabla_{\\mathbf{r}'}^2 + k^2) G(\\mathbf{r},\\mathbf{r}') = -\\delta(\\mathbf{r} - \\mathbf{r}')$。\n-   显式形式：$G(\\mathbf{r},\\mathbf{r}') = \\frac{i}{4} H_0^{(1)}\\!\\left(k \\left\\lVert \\mathbf{r} - \\mathbf{r}' \\right\\rVert \\right)$，其中 $H_\\nu^{(1)}$ 是第一类 $\\nu$ 阶 Hankel 函数。\n-   场点：$\\mathbf{x} \\in V$。\n-   边界积分变量：$\\mathbf{y} \\in S$。\n-   $\\mathbf{y}$ 处的外单位法向量：$\\mathbf{n}(\\mathbf{y})$。\n-   距离：$R = \\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert$。\n-   $S$ 上的法向导数算子：$\\partial_{n(\\mathbf{y})}$。\n-   线元：$ds(\\mathbf{y})$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题陈述在科学上是合理的、适定的和客观的。它为二维 Kirchhoff-Helmholtz 积分定理的标准推导提供了所有必要的信息。声压场 $p$ 和 Green 函数 $G$ 的控制方程，以及 $G$ 的显式形式，在声学领域都是标准且正确的。术语精确无歧义。该问题没有违反任何无效性标准。\n\n**步骤 3：结论和行动**\n问题陈述是有效的。我将继续进行推导和求解。\n\n### Kirchhoff-Helmholtz 积分定理的推导\n\n我们的出发点是 Green 第二恒等式，它适用于区域 $V$ (边界为 $S$) 中的两个充分光滑的标量函数 $u$ 和 $v$：\n$$ \\iint_V \\left( u \\nabla^2 v - v \\nabla^2 u \\right) \\, dA = \\int_S \\left( u \\frac{\\partial v}{\\partial n} - v \\frac{\\partial u}{\\partial n} \\right) \\, ds $$\n这里，积分变量隐式地作用于函数的定义域，而 $\\frac{\\partial}{\\partial n}$ 表示沿 $S$ 的外单位法线方向的导数。\n\n我们将函数 $u$ 和 $v$ 与我们的场对应起来，令 $u(\\mathbf{y}) = p(\\mathbf{y})$ 和 $v(\\mathbf{y}) = G(\\mathbf{x}, \\mathbf{y})$，其中 $\\mathbf{y}$ 是积分变量，$\\mathbf{x}$ 是一个固定的场点。拉普拉斯算子和法向导数是关于 $\\mathbf{y}$ 的。\n\n这些场满足：\n1.  $(\\nabla_{\\mathbf{y}}^2 + k^2) p(\\mathbf{y}) = 0 \\implies \\nabla_{\\mathbf{y}}^2 p(\\mathbf{y}) = -k^2 p(\\mathbf{y})$。\n2.  $(\\nabla_{\\mathbf{y}}^2 + k^2) G(\\mathbf{x}, \\mathbf{y}) = -\\delta(\\mathbf{x} - \\mathbf{y}) \\implies \\nabla_{\\mathbf{y}}^2 G(\\mathbf{x}, \\mathbf{y}) = -k^2 G(\\mathbf{x}, \\mathbf{y}) - \\delta(\\mathbf{x} - \\mathbf{y})$。\n\nGreen 函数 $G(\\mathbf{x}, \\mathbf{y})$ 在 $\\mathbf{y} = \\mathbf{x}$ 处有一个奇点。由于 $\\mathbf{x}$ 是 $V$ 的一个内部点，我们不能直接对整个区域 $V$ 应用 Green 恒等式。我们必须通过考虑一个修正区域 $V_\\epsilon = V \\setminus B_\\epsilon(\\mathbf{x})$ 来排除这个奇点，其中 $B_\\epsilon(\\mathbf{x})$ 是一个以 $\\mathbf{x}$ 为中心、半径为 $\\epsilon$ 的小圆盘。$V_\\epsilon$ 的边界是 $\\partial V_\\epsilon = S \\cup S_\\epsilon$，其中 $S_\\epsilon$ 是该圆盘的边界圆周。$S_\\epsilon$ 上的单位法线指向 $V_\\epsilon$ 的外部，也就是指向中心 $\\mathbf{x}$ 的内部。\n\n在区域 $V_\\epsilon$ 内，将 $p$ 和 $G$ 代入 Green 第二恒等式的左侧：\n$$ \\iint_{V_\\epsilon} \\left[ p(\\mathbf{y})\\nabla_{\\mathbf{y}}^2 G - G(\\mathbf{x},\\mathbf{y}) \\nabla_{\\mathbf{y}}^2 p \\right] \\, dA(\\mathbf{y}) = \\iint_{V_\\epsilon} \\left[ p(-k^2G - \\delta) - G(-k^2p) \\right] \\, dA = \\iint_{V_\\epsilon} -p\\delta \\, dA = 0 $$\n因为 $\\mathbf{x}$ 被排除在积分区域之外。因此，边界积分之和为零：\n$$ \\int_S \\left( p \\frac{\\partial G}{\\partial n} - G \\frac{\\partial p}{\\partial n} \\right) ds + \\int_{S_\\epsilon} \\left( p \\frac{\\partial G}{\\partial n} - G \\frac{\\partial p}{\\partial n} \\right) ds = 0 $$\n我们必须在极限 $\\epsilon \\to 0$ 下计算在 $S_\\epsilon$ 上的积分。在 $S_\\epsilon$ 上，从 $V_\\epsilon$ 出发的外法线是 $\\mathbf{n}(\\mathbf{y}) = -(\\mathbf{y}-\\mathbf{x})/\\epsilon$，所以法向导数是 $\\partial_{n} = -\\frac{\\partial}{\\partial R}$，其中 $R = \\left\\lVert\\mathbf{x}-\\mathbf{y}\\right\\rVert = \\epsilon$。\n\n在 $S_\\epsilon$ 上的积分变为：\n$$ I_\\epsilon = \\int_{S_\\epsilon} \\left[ p\\left(-\\frac{\\partial G}{\\partial R}\\right) - G\\left(-\\frac{\\partial p}{\\partial R}\\right) \\right] ds = \\int_{S_\\epsilon} \\left( G\\frac{\\partial p}{\\partial R} - p\\frac{\\partial G}{\\partial R} \\right) ds $$\n对于小宗量 $z$，Hankel 函数具有渐近行为：$H_0^{(1)}(z) \\approx \\frac{2i}{\\pi}\\ln(z)$ 和 $H_1^{(1)}(z) \\approx -\\frac{2i}{\\pi z}$。\n$G(R) = \\frac{i}{4} H_0^{(1)}(kR) \\approx \\frac{i}{4} \\frac{2i}{\\pi} \\ln(kR) = -\\frac{1}{2\\pi}\\ln(kR)$。\n$\\frac{\\partial G}{\\partial R} = -\\frac{ik}{4} H_1^{(1)}(kR) \\approx -\\frac{ik}{4} \\left(-\\frac{2i}{\\pi kR}\\right) = -\\frac{1}{2\\pi R}$。\n\n我们计算当 $\\epsilon \\to 0$ 时 $I_\\epsilon$ 的极限：\n1.  第一项的被积函数 $G\\frac{\\partial p}{\\partial R}$ 在 $\\epsilon \\to 0$ 时表现为 $\\sim \\epsilon \\ln(\\epsilon)$，因此其积分趋于零。\n2.  第二项的被积函数是 $-p\\frac{\\partial G}{\\partial R}$。当 $\\epsilon \\to 0$ 时，$p(\\mathbf{y}) \\to p(\\mathbf{x})$ 并且 $-\\frac{\\partial G}{\\partial R} \\approx \\frac{1}{2\\pi R} = \\frac{1}{2\\pi\\epsilon}$。由于 $ds(\\mathbf{y}) = \\epsilon \\, d\\theta$，该积分变为：\n    $$ \\lim_{\\epsilon\\to 0} \\int_0^{2\\pi} p(\\mathbf{y}) \\left(\\frac{1}{2\\pi\\epsilon}\\right) \\epsilon \\, d\\theta = \\frac{1}{2\\pi} \\int_0^{2\\pi} p(\\mathbf{x}) \\, d\\theta = p(\\mathbf{x}) $$\n因此，$\\lim_{\\epsilon \\to 0} I_\\epsilon = p(\\mathbf{x})$。\n\n我们的方程变为：\n$$ \\int_S \\left( p \\frac{\\partial G}{\\partial n} - G \\frac{\\partial p}{\\partial n} \\right) ds + p(\\mathbf{x}) = 0 $$\n为 $p(\\mathbf{x})$ 重新整理，得到内部点的 Kirchhoff-Helmholtz 积分公式：\n$$ p(\\mathbf{x}) = \\int_S \\left[ G(\\mathbf{x},\\mathbf{y}) \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) - p(\\mathbf{y}) \\partial_{n(\\mathbf{y})} G(\\mathbf{x},\\mathbf{y}) \\right] ds(\\mathbf{y}) $$\n\n现在我们代入 $G$ 及其法向导数的显式表达式。\nGreen 函数是 $G(\\mathbf{x}, \\mathbf{y}) = \\frac{i}{4} H_0^{(1)}(k R)$。\n$G$ 关于 $\\mathbf{y}$ 的法向导数是 $\\partial_{n(\\mathbf{y})} G = \\mathbf{n}(\\mathbf{y}) \\cdot \\nabla_{\\mathbf{y}} G$。\n首先，我们求梯度 $\\nabla_{\\mathbf{y}} G$：\n$$ \\nabla_{\\mathbf{y}} G = \\frac{dG}{dR} \\nabla_{\\mathbf{y}} R $$\n我们有 $R = \\left\\lVert \\mathbf{x} - \\mathbf{y} \\right\\rVert$，所以 $\\nabla_{\\mathbf{y}} R = -\\frac{\\mathbf{x}-\\mathbf{y}}{R}$。\n关于 $R$ 的导数是 $\\frac{dG}{dR} = \\frac{d}{dR}\\left(\\frac{i}{4} H_0^{(1)}(kR)\\right) = \\frac{ik}{4} \\frac{d}{d(kR)} H_0^{(1)}(kR)$。\n使用恒等式 $\\frac{d}{dz} H_0^{(1)}(z) = -H_1^{(1)}(z)$，我们得到 $\\frac{dG}{dR} = -\\frac{ik}{4} H_1^{(1)}(kR)$。\n结合这些结果：\n$$ \\nabla_{\\mathbf{y}} G = \\left(-\\frac{ik}{4} H_1^{(1)}(kR)\\right) \\left(-\\frac{\\mathbf{x}-\\mathbf{y}}{R}\\right) = \\frac{ik}{4} H_1^{(1)}(kR) \\frac{\\mathbf{x}-\\mathbf{y}}{R} $$\n因此，法向导数是：\n$$ \\partial_{n(\\mathbf{y})} G(\\mathbf{x},\\mathbf{y}) = \\mathbf{n}(\\mathbf{y}) \\cdot \\nabla_{\\mathbf{y}} G = \\frac{ik}{4} H_1^{(1)}(kR) \\frac{(\\mathbf{x}-\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R} $$\n最后，将 $G$ 和 $\\partial_{n(\\mathbf{y})}G$ 代入 $p(\\mathbf{x})$ 的积分公式中：\n$$ p(\\mathbf{x}) = \\int_S \\left[ \\left(\\frac{i}{4} H_0^{(1)}(kR)\\right) \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) - p(\\mathbf{y})\\left(\\frac{ik}{4} H_1^{(1)}(kR) \\frac{(\\mathbf{x}-\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R}\\right) \\right] ds(\\mathbf{y}) $$\n$$ p(\\mathbf{x}) = \\int_S \\left[ \\frac{i}{4} H_0^{(1)}(kR) \\, \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) - p(\\mathbf{y}) \\, \\frac{ik}{4} H_1^{(1)}(kR) \\, \\frac{(\\mathbf{x}-\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R} \\right] ds(\\mathbf{y}) $$\n\n### 逐项分析选项\n\n**A. $p(\\mathbf{x}) = \\displaystyle \\int_S \\left[ \\frac{i}{4} H_0^{(1)}(k R)\\, \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) - p(\\mathbf{y})\\, \\frac{i k}{4} H_1^{(1)}(k R)\\, \\frac{(\\mathbf{x} - \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R} \\right] \\, ds(\\mathbf{y})$**\n这个表达式与我们推导出的结果逐项匹配。第一项是 $G \\partial_{n}p$，第二项是 $-p \\partial_{n}G$。系数、函数和向量分量都正确。\n**结论：正确**\n\n**B. $p(\\mathbf{x}) = \\displaystyle \\int_S \\left[ p(\\mathbf{y})\\, \\frac{i k}{4} H_1^{(1)}(k R)\\, \\frac{(\\mathbf{x} - \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R} - \\frac{i}{4} H_0^{(1)}(k R)\\, \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) \\right] \\, ds(\\mathbf{y})$**\n这个表达式的形式是 $\\int_S (p \\partial_n G - G \\partial_n p) ds$，这是正确结果 $\\int_S (G \\partial_n p - p \\partial_n G) ds$ 的负值。除非 $p(\\mathbf{x}) = -p(\\mathbf{x})$，这意味着 $p(\\mathbf{x}) = 0$（通常不成立），否则这个选项是不正确的。它存在一个整体的符号错误。\n**结论：不正确**\n\n**C. $p(\\mathbf{x}) = \\displaystyle \\int_S \\left[ \\frac{i}{4} H_0^{(1)}(k R)\\, \\partial_{n(\\mathbf{y})} p(\\mathbf{y}) - p(\\mathbf{y})\\, \\frac{i}{4} H_1^{(1)}(k R)\\, \\frac{(\\mathbf{x} - \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{R} \\right] \\, ds(\\mathbf{y})$**\n这个选项与选项 A 相同，除了第二项，它缺少了因子 $k$。这个因子是在对 $H_0^{(1)}(kR)$ 关于 $R$ 求导时由链式法则产生的。省略 $k$ 是一个数学错误。\n**结论：不正确**\n\n**D. $p(\\mathbf{x}) = \\displaystyle \\int_S \\left[ \\frac{i}{4} H_0^{(1)}(k R)\\, \\partial_{n(\\mathbf{x})} p(\\mathbf{x}) - p(\\mathbf{y})\\, \\frac{i k}{4} H_1^{(1)}(k R)\\, \\frac{(\\mathbf{y} - \\mathbf{x}) \\cdot \\mathbf{n}(\\mathbf{x})}{R} \\right] \\, ds(\\mathbf{y})$**\n这个选项包含多个基本错误。积分是针对 $\\mathbf{y} \\in S$ 进行的，但被积函数包含了在场点 $\\mathbf{x}$ 处进行的操作，例如法向导数 $\\partial_{n(\\mathbf{x})} p(\\mathbf{x})$。单位法向量 $\\mathbf{n}(\\mathbf{x})$ 未定义，因为 $\\mathbf{x}$ 是 $V$ 的内部点，而不是边界 $S$ 上的点。该表达式混淆了积分变量 $\\mathbf{y}$ 和固定场点 $\\mathbf{x}$ 的角色。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "基尔霍夫-亥姆霍兹积分框架的威力常常通过巧妙选择格林函数来体现，这些格林函数针对特定问题的边界条件量身定制。本练习将演示如何利用镜像法为一个刚性边界的半空间问题构造合适的格林函数 。您将看到，这种方法可以极大地简化甚至消除边界积分，是一种优雅而强大的解析技巧。",
            "id": "4143717",
            "problem": "考虑一个二维上半空间域 $\\mathcal{D} = \\{(x,y) \\in \\mathbb{R}^{2} : y > 0\\}$，该区域由均匀、无损耗的流体占据，其中存在角频率为 $\\omega$、声波数为 $k > 0$ 的时谐声场。设 $u(x,y)$ 表示一个归一化的无量纲标量场，该场在源点之外满足齐次 Helmholtz 方程，\n$$\n\\nabla^{2} u(x,y) + k^{2} u(x,y) = 0 \\quad \\text{for } (x,y) \\in \\mathcal{D} \\setminus \\{(x_{s},y_{s})\\},\n$$\n以及在平面边界 $\\Gamma = \\{(x,0): x \\in \\mathbb{R}\\}$ 上的刚性（Neumann）边界条件，\n$$\n\\frac{\\partial u}{\\partial n}(x,0) = \\frac{\\partial u}{\\partial y}(x,0) = 0,\n$$\n同时满足无穷远处的 Sommerfeld 辐射条件。该场由位于 $(x_{s},y_{s})$（其中 $y_{s} > 0$）的单位强度点源生成，因此\n$$\n\\nabla^{2} u(x,y) + k^{2} u(x,y) = -\\delta(x-x_{s}) \\, \\delta(y-y_{s}) \\quad \\text{in } \\mathcal{D}.\n$$\n\n从 Green 第二恒等式以及定义 $\\mathcal{D}$ 中 Helmholtz 算子的 Neumann 半空间 Green 函数 $G_{N}((x,y);(x',y'))$ 的性质出发——即\n$$\n\\nabla'^{2} G_{N}((x,y);(x',y')) + k^{2} G_{N}((x,y);(x',y')) = -\\delta(x-x') \\, \\delta(y-y'),\n$$\n$$\n\\frac{\\partial G_{N}}{\\partial n'}((x,y);(x',0)) = \\frac{\\partial G_{N}}{\\partial y'}((x,y);(x',0)) = 0,\n$$\n以及关于观察变量的 Sommerfeld 辐射条件——使用 Kirchhoff–Helmholtz 积分定理（KHIT）写出 $u(x,y)$ 在半空间中关于边界和源贡献的积分表达式。然后，为二维上半空间显式构造 $G_{N}$，并在 $y>0$ 的观察点 $(x,y)$ 处计算 KHIT 表达式，以获得 $u(x,y)$ 的闭式解析表达式。\n\n您的最终答案必须是 $u(x,y)$ 的一个单一闭式解析表达式，用 $k$、$(x,y)$ 和 $(x_{s},y_{s})$ 表示，并使用零阶第一类 Hankel 函数表达。不需要数值近似或四舍五入。由于 $u$ 在构造上是归一化且无量纲的，因此在方框内的最终表达式中不需要也不允许使用物理单位。",
            "solution": "我们从控制方程和边界条件开始。上半空间 $\\mathcal{D} = \\{(x,y): y>0\\}$ 中的场 $u(x,y)$ 满足\n$$\n\\nabla^{2} u(x,y) + k^{2} u(x,y) = -\\delta(x-x_{s}) \\, \\delta(y-y_{s}),\n$$\n以及在 $\\Gamma = \\{(x,0)\\}$ 上的刚性边界条件，\n$$\n\\frac{\\partial u}{\\partial n}(x,0) = \\frac{\\partial u}{\\partial y}(x,0) = 0,\n$$\n和确保无穷远处为出射波的 Sommerfeld 辐射条件。\n\n为了推导 Kirchhoff–Helmholtz 积分定理（KHIT）表达式，我们引入一个 Neumann 半空间 Green 函数 $G_{N}((x,y);(x',y'))$，它满足\n$$\n\\nabla'^{2} G_{N}((x,y);(x',y')) + k^{2} G_{N}((x,y);(x',y')) = -\\delta(x-x') \\, \\delta(y-y'),\n$$\n以及\n$$\n\\frac{\\partial G_{N}}{\\partial y'}((x,y);(x',0)) = 0,\n$$\n和关于观察变量 $(x,y)$ 的 Sommerfeld 辐射条件。\n\nKirchhoff-Helmholtz 积分定理源于 Green 第二恒等式。对于一个有源问题 $(\\nabla^2 + k^2)u = f$，解 $u$ 可以表示为：\n$$ u(\\mathbf{x}) = \\int_{\\partial\\mathcal{D}} \\left( G(\\mathbf{x}, \\mathbf{x}') \\frac{\\partial u(\\mathbf{x}')}{\\partial n'} - u(\\mathbf{x}') \\frac{\\partial G(\\mathbf{x}, \\mathbf{x}')}{\\partial n'} \\right) dS' - \\iint_{\\mathcal{D}} G(\\mathbf{x}, \\mathbf{x}') f(\\mathbf{x}') dV' $$\n在本问题中，源项为 $f(\\mathbf{x}') = -\\delta(x'-x_{s})\\delta(y'-y_{s})$，我们使用 Neumann Green 函数 $G_N$。\n边界 $\\partial\\mathcal{D}$ 由平面边界 $\\Gamma$ 和一个半径趋于无穷大的半圆弧组成。由于 $u$ 和 $G_N$ 都满足 Sommerfeld 辐射条件，无穷远处的积分消失。在平面边界 $\\Gamma$ 上，由于刚性边界条件 $\\partial u/\\partial n' = 0$ 和 Neumann Green 函数的定义 $\\partial G_N/\\partial n' = 0$，边界积分也为零：\n$$ \\int_{\\Gamma} \\left( G_N \\frac{\\partial u}{\\partial n'} - u \\frac{\\partial G_N}{\\partial n'} \\right) dS' = \\int_{\\Gamma} \\left( G_N \\cdot 0 - u \\cdot 0 \\right) dS' = 0 $$\n因此，解完全由体积分项决定：\n$$ u(x,y) = - \\iint_{\\mathcal{D}} G_N((x,y);(x',y')) \\left( -\\delta(x'-x_{s}) \\, \\delta(y'-y_{s}) \\right) \\, \\mathrm{d}x' \\mathrm{d}y' $$\n$$ u(x,y) = \\iint_{\\mathcal{D}} G_N((x,y);(x',y')) \\delta(x'-x_{s}) \\, \\delta(y'-y_{s}) \\, \\mathrm{d}x' \\mathrm{d}y' $$\n根据狄拉克 delta 函数的筛选性质，该积分简化为：\n$$ u(x,y) = G_N((x,y);(x_s,y_s)) $$\n这一结果表明，对于一个由内部点源驱动并满足齐次 Neumann 边界条件的问题，其解恰好就是该区域的 Neumann Green 函数。\n\n现在我们使用镜像法为二维上半空间显式构造 $G_{N}$。二维 Helmholtz 算子的自由空间 Green 函数为\n$$\nG_{0}((x,y);(x',y')) = \\frac{i}{4} H_{0}^{(1)}\\!\\left( k \\, R((x,y);(x',y')) \\right),\n$$\n其中\n$$\nR((x,y);(x',y')) = \\sqrt{(x-x')^{2} + (y-y')^{2}},\n$$\n且 $H_{0}^{(1)}(\\cdot)$ 表示零阶第一类 Hankel 函数。\n\n为了在 $y'=0$ 上强制执行 Neumann 边界条件 $\\partial G_{N}/\\partial y' = 0$，我们在边界对面放置一个同相的镜像源。设源点 $(x_{s},y_{s})$ 的镜像点为 $(x_{s},-y_{s})$。则\n$$\nG_{N}((x,y);(x_{s},y_{s})) = G_{0}((x,y);(x_{s},y_{s})) + G_{0}((x,y);(x_{s},-y_{s})).\n$$\n这个构造自动满足边界条件，因为来自真实源和镜像源的场的法向导数在 $y'=0$ 平面上大小相等、方向相反，从而相互抵消。\n\n因此，对于 $y>0$ 的观察点 $(x,y)$，场为\n$$\nu(x,y) = \\frac{i}{4} H_{0}^{(1)}\\!\\left( k \\sqrt{(x-x_{s})^{2} + (y-y_{s})^{2}} \\right) + \\frac{i}{4} H_{0}^{(1)}\\!\\left( k \\sqrt{(x-x_{s})^{2} + (y+y_{s})^{2}} \\right).\n$$\n该表达式是出射的，满足在 $(x_{s},y_{s})$ 处有单位点源的 Helmholtz 方程，并服从 $y=0$ 上的 Neumann 边界条件。\n\n综上所述，KHIT 表达式得出了刚性边界上方的闭式解析场：\n$$\nu(x,y) = \\frac{i}{4} \\left[ H_{0}^{(1)}\\!\\left( k \\sqrt{(x-x_{s})^{2} + (y-y_{s})^{2}} \\right) + H_{0}^{(1)}\\!\\left( k \\sqrt{(x-x_{s})^{2} + (y+y_{s})^{2}} \\right) \\right].\n$$",
            "answer": "$$\\boxed{\\frac{i}{4}\\left[H_{0}^{(1)}\\!\\left(k\\sqrt{(x-x_{s})^{2}+(y-y_{s})^{2}}\\right)+H_{0}^{(1)}\\!\\left(k\\sqrt{(x-x_{s})^{2}+(y+y_{s})^{2}}\\right)\\right]}$$"
        },
        {
            "introduction": "从解析公式到实际计算存在一道巨大的鸿沟。直接计算基尔霍夫-亥姆霍兹积分对于大规模问题而言计算成本极高，因此高效的算法至关重要。本练习旨在探讨快速多极子方法（Fast Multipole Method, FMM）和分层矩阵（Hierarchical Matrices, H-matrices）等先进算法的理论基础和计算复杂度 ，这些都是计算声学工程师必须掌握的关键工具。",
            "id": "4143716",
            "problem": "考虑空间维度 $d = 3$、波数 $k > 0$ 的时谐声学问题，其由 Helmholtz 方程所控制。设 $S$ 是一个包围声学散射体的光滑闭合边界。Kirchhoff-Helmholtz 积分定理 (KH) 指出，外部区域的声压可以通过包含 Helmholtz 算子的自由空间 Green’s 函数及其法向导数的边界层位势来表示。在将 $S$ 空间离散化为 $N$ 个边界元（节点为 $\\{\\mathbf{y}_j\\}_{j=1}^N$，光滑求积权重为 $\\{w_j\\}_{j=1}^N$），并从一个适定的边界积分方程中数值求解得到边界密度 $\\{\\alpha_j\\}_{j=1}^N$ 后，在 $M$ 个场点 $\\{\\mathbf{x}_m\\}_{m=1}^M$ 处计算 KH 表达式的值，就简化为计算如下形式的和：\n\n$$\nu(\\mathbf{x}_m) \\approx \\sum_{j=1}^N \\alpha_j\\,K(\\mathbf{x}_m,\\mathbf{y}_j), \\quad m=1,\\dots,M,\n$$\n\n其中 $K(\\mathbf{x},\\mathbf{y})$ 表示 Helmholtz Green’s 函数核或由 $S$ 上的法向导数产生的相应双层核。直接的朴素求值方法会执行所有 $N M$ 次两两相互作用的计算。\n\n您的任务是设计一种算法策略，以在所有场点高效地计算这些 KH 和，并量化其相对于朴素 $O(N M)$ 方法的计算复杂度。您的策略应基于以下基础：(i) Helmholtz 算子在自由空间中是平移不变的，(ii) 对于分离良好的源-目标簇，自由空间 Helmholtz 核是光滑的，以及 (iii) 分层空间剖分能够将相互作用分离为近场和远场。假设处于中低频区，即 $k a = O(1)$，其中 $a$ 是 $S$ 的特征直径，并设固定的精度容差为 $\\varepsilon \\in (0,1)$。令 $p$ 表示快速多极子方法中使用的多极/局部展开的阶数，令 $r$ 表示层次矩阵表示中可纳远场块的数值秩。\n\n在上述假设下，下列哪个陈述正确地说明了由 $N$ 个边界元在 $M$ 个场点计算 KH 积分的高效策略及其实现的渐近复杂度？选择所有适用项。\n\nA. 通过使用快速多极子方法 (FMM)，在 $\\{\\mathbf{y}_j\\}$ 和 $\\{\\mathbf{x}_m\\}$ 上建立分层树，直接处理近场相互作用，并通过 Helmholtz 核的多极到局部转换来介导远场相互作用。在 $k a = O(1)$ 的低频区，对于固定的精度 $\\varepsilon$，可以选择与 $N$ 和 $M$ 无关的 $p = O(\\log(1/\\varepsilon))$，因此总计算成本为 $O\\!\\big((N+M)\\,p^2\\big) = O(N+M)$（不计取决于 $\\varepsilon$ 的常数），这严格优于 $O(N M)$。\n\nB. 通过构建块-簇树和针对分离良好的源-目标簇的可纳条件，边界到目标的相互作用矩阵可以被压缩成一个层次矩阵 (H-矩阵)，其远场块的秩 $r = O(\\log(1/\\varepsilon))$ 在中低频区与 $N$ 和 $M$ 无关。将该压缩算子应用于边界密度以计算所有 $M$ 个场点的值需要 $O\\!\\big((N+M)\\,r\\,\\log(N+M)\\big)$ 的时间，即相对于 $O(N M)$ 是近线性的（取决于对数因子）。\n\nC. 通过将 $\\{\\mathbf{y}_j\\}$ 和 $\\{\\mathbf{x}_m\\}$ 重采样到均匀笛卡尔网格上，并调用快速傅里叶变换 (FFT) 与自由空间 Helmholtz 核进行卷积，对于任意几何形状和边界分布，可以普遍实现 $O\\!\\big((N+M)\\,\\log(N+M)\\big)$ 的复杂度，从而在一般情况下媲美或优于 FMM 和 H-矩阵。\n\nD. 在高频区 $k a \\gg 1$，振荡必然迫使任何分层分离策略产生 $O\\!\\big(\\sqrt{N M}\\big)$ 的复杂度，即使使用 FMM 的方向性变体或频率感知的 H-矩阵，这个界限也无法改善。\n\nE. 如果通过缓存感知的循环分块和向量化核函数求值来实现，朴素求积已经能够达到 $O(N+M)$ 的复杂度，因此在渐近意义上它是最优的，无需借助 FMM 或 H-矩阵压缩。\n\n通过选择所有正确选项来回答。",
            "solution": "用户提供了一个关于计算声学中 Kirchhoff-Helmholtz (KH) 积分表达式高效求值的问题陈述。任务是验证该问题陈述，如果有效，则从给定选项中找出关于不同算法策略复杂度的正确陈述。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **物理背景**：空间维度 $d = 3$ 的时谐声学。\n*   **控制方程**：波数 $k > 0$ 的 Helmholtz 方程。\n*   **几何**：包围声学散射体的光滑闭合边界 $S$。\n*   **积分公式**：声压由 Kirchhoff-Helmholtz 积分定理表示，涉及边界层位势。核函数是 Helmholtz 算子的自由空间 Green’s 函数及其法向导数。\n*   **离散化**：边界 $S$ 被离散化为 $N$ 个边界元。这产生 $N$ 个节点 $\\{\\mathbf{y}_j\\}_{j=1}^N$、N 个求积权重 $\\{w_j\\}_{j=1}^N$ 和 $N$ 个边界密度 $\\{\\alpha_j\\}_{j=1}^N$。\n*   **求值任务**：位势需要在 $M$ 个场点 $\\{\\mathbf{x}_m\\}_{m=1}^M$ 处进行求值。\n*   **计算形式**：任务简化为计算形式为 $u(\\mathbf{x}_m) \\approx \\sum_{j=1}^N \\alpha_j\\,K(\\mathbf{x}_m,\\mathbf{y}_j)$ 的和，对于 $m=1,\\dots,M$。\n*   **核函数**：$K(\\mathbf{x},\\mathbf{y})$ 是 Helmholtz 方程的单层核或双层核。\n*   **朴素复杂度**：直接求值的计算成本为 $O(N M)$。\n*   **算法基础**：策略应基于 (i) Helmholtz 算子的平移不变性，(ii) 对于分离良好的点，核函数是光滑的，以及 (iii) 分层空间剖分。\n*   **假设**：中低频区：$k a = O(1)$，其中 $a$ 是 $S$ 的特征直径。固定精度容差：$\\varepsilon \\in (0,1)$。\n*   **算法参数**：$p$：多极/局部展开的阶数 (FMM)。$r$：可纳远场块的数值秩 (H-矩阵)。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学基础**：该问题在计算声学，特别是 Helmholtz 方程的边界元方法 (BEM) 这一成熟领域中有坚实的基础。Kirchhoff-Helmholtz 定理、Green's 函数、边界层位势、快速多极子方法 (FMM) 和层次矩阵 (H-矩阵) 都是标准且严格定义的概念。该问题在科学上是合理的。\n2.  **适定性**：该问题要求在指定的标准假设下，识别关于著名数值算法渐近复杂度的正确陈述。该问题是明确的，并且可以根据这些方法的既定理论得到确切答案。\n3.  **客观性**：语言精确、技术性强，没有主观或基于观点的断言。\n4.  **不完整或矛盾的设置**：该设置是完整且自洽的。它提供了分析指定算法复杂度所需的所有必要信息（例如，频区、精度要求、$N、M、p、r$ 的定义）。\n5.  **不切实际或不可行**：所描述的场景是科学计算中的一个典型问题。所讨论的方法是解决此类问题的最先进技术。这些假设是理论分析的标准假设。\n6.  **不适定或结构不良**：该问题结构清晰，是一个要求验证算法性能陈述的多项选择题。术语在数值分析的背景下有明确的定义。\n7.  **故作高深、无聊或同义反复**：这个问题并非无聊。它要求对 FMM 和 H-矩阵等高级算法的复杂度如何依赖于各种问题参数（包括频率 ($k$)、精度 ($\\varepsilon$) 和问题规模 ($N、M$)）有细致的理解。\n\n**步骤 3：结论与行动**\n\n问题陈述是 **有效的**。这是一个精心阐述的、科学上合理的问题，涉及计算声学中标准算法的性能。我现在将通过分析每个选项来继续解答。\n\n### 解答与选项分析\n\n问题的核心是加速矩阵向量乘积 $u = G\\alpha$，其中 $u \\in \\mathbb{C}^M$，$\\alpha \\in \\mathbb{C}^N$，而 $G$ 是一个 $M \\times N$ 的稠密矩阵，其元素为 $G_{mj} = K(\\mathbf{x}_m, \\mathbf{y}_j)$。朴素方法的成本为 $O(NM)$。我们在给定低频区 ($ka = O(1)$) 和固定精度 $\\varepsilon$ 的假设下，分析替代方法的效率。\n\n**A. 通过使用快速多极子方法 (FMM)...**\n\n此选项描述了快速多极子方法的应用。FMM 通过对源和目标进行分层聚类来加速矩阵向量乘积。分离良好（远场）的簇之间的相互作用不是直接计算，而是通过近似来介导。对于 Helmholtz 核，这些近似是多极展开和局部展开。在低频区，$ka=O(1)$，核的行为与 Laplace 核相似。为达到固定精度 $\\varepsilon$ 所需的展开项数 $p$ 对数依赖于精度，即 $p = O(\\log(1/\\varepsilon))$。对频率的依赖形式为 $p = O(\\log(1/\\varepsilon) + \\log(ka))$，但由于 $ka=O(1)$，这简化为 $p = O(\\log(1/\\varepsilon))$。因为 $\\varepsilon$ 是一个固定常数，所以 $p$ 可以被视为一个常数。对于 $d=3$ 中的 $N$ 个源和 $M$ 个目标，FMM 算法的复杂度为 $O((N+M)p^2)$，其中 $p^2$ 因子来自转换算子。当 $p$ 为常数时，总复杂度变为 $O(N+M)$。这代表了对朴素 $O(NM)$ 复杂度的显著渐近改进。该陈述是对 FMM 在此频区性质的正确总结。\n\n**结论：正确。**\n\n**B. 通过构建块-簇树... 层次矩阵 (H-矩阵)...**\n\n此选项描述了层次矩阵 (H-矩阵) 方法。与 FMM 类似，它也使用源和目标的分层剖分。对应于分离良好（可纳）簇的矩阵块不被显式存储，而是通过低秩矩阵来近似。对于像低频区 Helmholtz Green's 函数这样的光滑核，将一个可纳块近似到固定精度 $\\varepsilon$ 所需的数值秩 $r$ 确实与块的大小（因此也与 $N$ 和 $M$）无关。秩依赖于精度和频率，通常形式为 $r = O(\\log^c(1/\\varepsilon))$（其中 $c$ 为某个小整数），并多项式依赖于 $ka$。由于 $ka=O(1)$ 且 $\\varepsilon$ 固定，$r$ 是一个常数。该陈述将依赖关系简化为 $r = O(\\log(1/\\varepsilon))$，这在性质上是正确的。一个 $N \\times M$ 的 H-矩阵与一个向量相乘的计算成本为 $O((N+M)r \\log(\\max(N,M)))$。对数因子源于遍历分层树。该陈述给出的复杂度为 $O((N+M)r \\log(N+M))$，这是一致的。对于固定的 $r$，这是一个近线性的复杂度 $O((N+M)\\log(N+M))$，相比 $O(NM)$ 是一个巨大的改进。\n\n**结论：正确。**\n\n**C. 通过重采样... 到均匀笛卡尔网格上并调用快速傅里叶变换 (FFT)...**\n\n此选项提出了一种基于 FFT 的卷积策略。自由空间 Helmholtz 算子确实是平移不变的，使其作用成为一个卷积。FFT 可以在 $O(L \\log L)$ 复杂度内计算离散卷积，其中 $L$ 是网格点数。然而，源 $\\{\\mathbf{y}_j\\}$ 和目标 $\\{\\mathbf{x}_m\\}$ 位于任意光滑表面和外部区域，而不是在均匀网格上。应用 FFT 需要将源投影到网格上，并将结果从网格插值到目标点。这个投影/插值过程不简单，会引入误差，并且其成本和精度在很大程度上取决于 $S$ 的几何形状。声称该方法对于“任意几何形状”都“普遍实现”这种复杂度，并且“在一般情况下媲美或优于 FMM 和 H-矩阵”是一个严重的夸大。虽然基于 FFT 的方法对于某些问题（例如，在简单域或周期性设置中）非常有效，但像 FMM 和 H-矩阵这样的基于树的方法对于涉及复杂、任意几何形状的问题通常更具灵活性和鲁棒性。\n\n**结论：不正确。**\n\n**D. 在高频区 $ka \\gg 1$...**\n\n此选项将焦点转移到高频区 ($ka \\gg 1$)，这超出了问题的主要假设 ($ka = O(1)$)。它声称分层方法的复杂度必然退化到 $O(\\sqrt{NM})$，并且这个界限“无法改善”。虽然标准的 FMM 和 H-矩阵方法（基于多项式展开）在高频下确实会显著退化（展开阶数 $p$ 和秩 $r$ 必须随 $k$ 扩展），但声称其复杂度无法改善超过某个下界的说法是错误的。整个研究领域都致力于高频快速方法。已经开发出了使用振荡基函数（例如平面波）代替多项式的 FMM 和 H-矩阵的方向性变体，以处理核函数的高度振荡特性。这些方法可以保持近线性的复杂度，例如 $O((N+M)\\log(N+M))$ 或 $O((N+M)k^\\alpha)$（对于小的 $\\alpha$），尽管其前置常数会随 $k$ 增长。该陈述关于一个无法改善的界限的断言在事实上是不正确的。\n\n**结论：不正确。**\n\n**E. 朴素求和声称...**\n\n该陈述声称，如果实现得好，朴素的直接求和可以达到 $O(N+M)$ 的复杂度。朴素方法涉及计算 $N$ 个源点中每一个与 $M$ 个目标点中每一个之间的相互作用，这从根本上需要 $N \\times M$ 次核函数求值。因此，总计算复杂度为 $O(NM)$。像“缓存感知的循环分块和向量化核函数求值”这样的技术是低级性能优化，它们通过更好地利用计算机的内存层次结构和 SIMD 指令来改善复杂度的常数因子。然而，它们不会改变算法的渐近标度。一个 $O(NM)$ 的算法无论如何优化仍然是 $O(NM)$。声称它能达到 $O(N+M)$ 是根本不正确的。例如，如果 $N=M$，朴素方法是 $O(N^2)$，而 $O(N+M)$ 则是 $O(N)$。这两者在渐近上是不同的。\n\n**结论：不正确。**",
            "answer": "$$\\boxed{AB}$$"
        }
    ]
}