{
    "hands_on_practices": [
        {
            "introduction": "The heart of any Boundary Element Method (BEM) implementation is the assembly of the system matrix that represents the discretized integral operator. This exercise provides a concrete guide to constructing the Galerkin matrix for the acoustic single-layer operator, a fundamental building block in computational acoustics. By working through this problem, you will translate the continuous integral formulation into a discrete, computable form, gaining hands-on experience with the essential roles of numerical quadrature, geometric mapping via Jacobians, and the interaction between basis functions .",
            "id": "4118364",
            "problem": "You are to implement and reason about a Galerkin Boundary Element Method (BEM) assembly for the acoustic single-layer operator over a triangulated surface. The governing partial differential equation is the Helmholtz equation for time-harmonic acoustics, which in homogeneous free space reads $\\Delta u + k^2 u = 0$ in $\\mathbb{R}^3 \\setminus \\Gamma$, where $\\Gamma$ is a smooth surface. The free-space Green's function for the Helmholtz equation is\n$$\nG_k(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|},\n$$\nwhere $k$ is the wavenumber, expressed in radians per meter (rad/m). The Galerkin discretization of the single-layer boundary integral operator builds the matrix $V$ whose entries are surface double integrals of the kernel weighted by the basis functions.\n\nStart from the following fundamental base:\n- The Helmholtz equation $\\Delta u + k^2 u = 0$ and its free-space Green's function.\n- The Galerkin method with piecewise-constant basis functions per triangle element, so that the basis function associated with triangle $T_p$ is $1$ on $T_p$ and $0$ elsewhere.\n- The reference triangle with coordinates $(\\xi,\\eta)$ and area $\\tfrac{1}{2}$, and an affine mapping to a physical triangle with vertices $\\mathbf{a}$, $\\mathbf{b}$, and $\\mathbf{c}$, under which the surface Jacobian determinant is constant and equal to $J = 2 A$, where $A$ is the area of the physical triangle.\n\nYou must derive and implement the assembly algorithm for the Galerkin $V$ matrix with the following requirements:\n- The matrix entries are defined by\n$$\nV_{pq} = \\int_{T_p} \\int_{T_q} G_k(\\mathbf{x}, \\mathbf{y}) \\, \\mathrm{d}S_{\\mathbf{x}} \\, \\mathrm{d}S_{\\mathbf{y}},\n$$\nfor triangles $T_p$ and $T_q$ on a triangulated surface. Use piecewise-constant basis functions, so there are no additional basis factors beyond the constant $1$ on each triangle.\n- Use local quadrature rules on the reference triangle to approximate each surface integral. Specifically, let $\\{(\\xi_i,\\eta_i), w_i\\}_{i=1}^{N_q}$ be quadrature nodes and weights on the reference triangle, which has area $\\tfrac{1}{2}$, and map them affinely to each physical triangle. The Jacobian factor $J = 2 A$ must multiply each local weight $w_i$ to account for the area scaling. The double integral is to be approximated by a tensor-product of the triangular quadrature:\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} w_i \\, J_p \\; w_j \\, J_q \\; G_k\\!\\big(\\mathbf{x}_p(\\xi_i,\\eta_i), \\mathbf{y}_q(\\xi_j,\\eta_j)\\big),\n$$\nwhere $J_p = 2 A_p$ and $J_q = 2 A_q$.\n- To ensure numerical stability in the presence of weak singularities, introduce a small regularization parameter $\\varepsilon > 0$ and replace $\\|\\mathbf{x}-\\mathbf{y}\\|$ by $\\max\\{\\|\\mathbf{x}-\\mathbf{y}\\|, \\varepsilon\\}$ in the denominator of $G_k$. This is an algorithmic regularization; justify why it is acceptable in the derivation. The parameter $\\varepsilon$ has units of meters (m).\n- Implement the element loops that iterate over all triangles $T_p$ and $T_q$, perform local quadrature on each, and accumulate contributions using the Jacobian and basis products. You must include the accumulation over quadrature nodes with the tensor-product structure.\n- Use the following deterministic triangulated surface for testing (coordinates in meters):\n    - Triangle $T_0$: vertices $\\mathbf{a}_0 = (0,0,0)$, $\\mathbf{b}_0 = (1,0,0)$, $\\mathbf{c}_0 = (0,1,0)$.\n    - Triangle $T_1$: vertices $\\mathbf{a}_1 = (1,1,0)$, $\\mathbf{b}_1 = (0,1,0)$, $\\mathbf{c}_1 = (1,0,0)$.\n    - Triangle $T_2$: vertices $\\mathbf{a}_2 = (2,0.2,0.3)$, $\\mathbf{b}_2 = (2.4,0.1,0.4)$, $\\mathbf{c}_2 = (2.1,0.5,0.2)$.\n- Use barycentric quadrature rules on the reference triangle:\n    - For order $1$: a single centroid node with barycentric coordinates $(\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3}\\right)$ and weight $w = \\tfrac{1}{2}$.\n    - For order $3$: three nodes at $(\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$, $(\\tfrac{1}{2}, 0, \\tfrac{1}{2})$, and $(0, \\tfrac{1}{2}, \\tfrac{1}{2})$, each with weight $w = \\tfrac{1}{6}$. Convert barycentric coordinates to Cartesian coordinates via $\\mathbf{x} = \\lambda_1 \\mathbf{a} + \\lambda_2 \\mathbf{b} + \\lambda_3 \\mathbf{c}$.\n\nYour program must assemble the $3 \\times 3$ matrix $V$ for each test case specified below and compute its Frobenius norm:\n$$\n\\|V\\|_F = \\left( \\sum_{p=0}^{2} \\sum_{q=0}^{2} |V_{pq}|^2 \\right)^{1/2}.\n$$\n\nTest suite (parameters given as tuples $(k, \\varepsilon, N_q)$ where $k$ is in radians per meter, $\\varepsilon$ in meters, and $N_q$ denotes the chosen quadrature order as defined above):\n- $(0.0, 10^{-6}, 3)$: the Laplace limit with $k = 0$, small regularization, three-point quadrature.\n- $(20.0, 10^{-6}, 3)$: moderate wavenumber, small regularization, three-point quadrature.\n- $(60.0, 10^{-5}, 3)$: higher wavenumber, slightly larger regularization, three-point quadrature.\n- $(60.0, 5 \\times 10^{-2}, 1)$: higher wavenumber, large regularization, centroid-only quadrature.\n\nYour program should produce a single line of output containing the Frobenius norms of $V$ for the four test cases as a comma-separated list enclosed in square brackets (e.g., $\"[r_1,r_2,r_3,r_4]\"$). Express each Frobenius norm in meters cubed ($\\mathrm{m}^3$). No other output is permitted.\n\nYour derivation must show what the $V$ matrix is, why the assembly algorithm is correct, and how it is derived from the fundamental base. You must explicitly include the element loops, local quadrature, Jacobian scaling, and accumulation with basis products in your reasoning. Avoid shortcut formulas beyond the base stated above. Ensure scientific realism in all steps and parameter choices.",
            "solution": "The problem is valid. It is scientifically sound, well-posed, and all necessary data and definitions are provided for the assembly of the Galerkin Boundary Element Method (BEM) matrix for the acoustic single-layer operator. The problem will be solved as stated.\n\nThe analysis begins with the definition of the Galerkin matrix entries $V_{pq}$ for the single-layer boundary integral operator, discretized with piecewise-constant basis functions. For two triangles, $T_p$ and $T_q$, on a surface mesh $\\Gamma$, a matrix entry is given by the double surface integral:\n$$\nV_{pq} = \\int_{T_p} \\int_{T_q} G_k(\\mathbf{x}, \\mathbf{y}) \\, \\mathrm{d}S_{\\mathbf{x}} \\, \\mathrm{d}S_{\\mathbf{y}}\n$$\nHere, $G_k(\\mathbf{x},\\mathbf{y})$ is the free-space Green's function, or fundamental solution, for the Helmholtz equation, which describes time-harmonic acoustic wave propagation. It is given by:\n$$\nG_k(\\mathbf{x},\\mathbf{y}) = \\dfrac{e^{\\mathrm{i} k \\|\\mathbf{x}-\\mathbf{y}\\|}}{4 \\pi \\|\\mathbf{x}-\\mathbf{y}\\|}\n$$\nwhere $k$ is the wavenumber in $\\mathrm{rad/m}$, $\\mathbf{x}$ and $\\mathbf{y}$ are points in $\\mathbb{R}^3$, and $\\mathrm{i} = \\sqrt{-1}$. The piecewise-constant basis functions, being equal to $1$ on their respective triangles and $0$ elsewhere, do not appear explicitly in the integral but define its domain.\n\nThe direct evaluation of this four-dimensional integral is intractable. Therefore, it is approximated using numerical quadrature. The process involves mapping the physical triangles $T_p$ and $T_q$ to a single reference triangle, $T_{ref}$. We consider an affine map $\\mathbf{x}_p(\\boldsymbol{\\xi}): T_{ref} \\to T_p$ for each triangle $T_p$ with vertices $\\mathbf{a}_p, \\mathbf{b}_p, \\mathbf{c}_p$. The problem specifies using barycentric coordinates $\\boldsymbol{\\lambda} = (\\lambda_1, \\lambda_2, \\lambda_3)$ where $\\lambda_1+\\lambda_2+\\lambda_3=1$, such that a point $\\mathbf{x} \\in T_p$ is given by $\\mathbf{x} = \\lambda_1 \\mathbf{a}_p + \\lambda_2 \\mathbf{b}_p + \\lambda_3 \\mathbf{c}_p$. Under this affine transformation, the differential surface element transforms as $\\mathrm{d}S_{\\mathbf{x}} = J_p \\, \\mathrm{d}A_{\\boldsymbol{\\lambda}}$, where $J_p$ is the constant Jacobian determinant of the map. This Jacobian is equal to twice the area of the physical triangle, $J_p = 2A_p$. The area $A_p$ is calculated as $A_p = \\frac{1}{2} \\|(\\mathbf{b}_p - \\mathbf{a}_p) \\times (\\mathbf{c}_p - \\mathbf{a}_p)\\|$.\n\nA surface integral over a physical triangle $T_p$ is thus transformed into an integral over the reference element, which is then approximated by a quadrature rule $\\{\\boldsymbol{\\lambda}_i, w_i\\}_{i=1}^{N_q}$ defined on $T_{ref}$:\n$$\n\\int_{T_p} f(\\mathbf{x}) \\, \\mathrm{d}S_{\\mathbf{x}} = \\int_{T_{ref}} f(\\mathbf{x}_p(\\boldsymbol{\\lambda})) J_p \\, \\mathrm{d}A_{\\boldsymbol{\\lambda}} \\approx \\sum_{i=1}^{N_q} w_i J_p f(\\mathbf{x}_p(\\boldsymbol{\\lambda}_i))\n$$\nThe problem specifies that the weights $\\{w_i\\}$ are defined for a reference triangle of area $\\frac{1}{2}$, so the sum of the weights $\\sum_i w_i = \\frac{1}{2}$.\n\nTo evaluate $V_{pq}$, we apply this approximation process sequentially to the outer and inner integrals. This results in a tensor-product quadrature rule:\n$$\nV_{pq} \\approx \\int_{T_p} \\left( \\sum_{j=1}^{N_q} w_j J_q G_k(\\mathbf{x}, \\mathbf{y}_{q,j}) \\right) \\mathrm{d}S_{\\mathbf{x}}\n$$\nwhere $\\mathbf{y}_{q,j}$ are the physical quadrature points on triangle $T_q$. Applying the quadrature rule to the remaining integral over $T_p$ yields:\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} w_i J_p \\left( \\sum_{j=1}^{N_q} w_j J_q G_k(\\mathbf{x}_{p,i}, \\mathbf{y}_{q,j}) \\right)\n$$\nThis can be rearranged into the final computational formula:\n$$\nV_{pq} \\approx \\sum_{i=1}^{N_q} \\sum_{j=1}^{N_q} (w_i J_p) (w_j J_q) G_k(\\mathbf{x}_{p,i}, \\mathbf{y}_{q,j})\n$$\nwhere $\\mathbf{x}_{p,i}$ and $\\mathbf{y}_{q,j}$ are the $i$-th and $j$-th physical quadrature points on triangles $T_p$ and $T_q$, respectively.\n\nThe kernel $G_k(\\mathbf{x},\\mathbf{y})$ has a $1/\\|\\mathbf{x}-\\mathbf{y}\\|$ singularity as $\\mathbf{x} \\to \\mathbf{y}$. For diagonal entries $V_{pp}$ (coincident triangles) or adjacent triangles, this singularity can cause standard quadrature rules to fail. The problem specifies an algorithmic regularization by replacing $\\|\\mathbf{x}-\\mathbf{y}\\|$ with $\\max\\{\\|\\mathbf{x}-\\mathbf{y}\\|, \\varepsilon\\}$ in the denominator of $G_k$. This bounds the value of the kernel, removing the singularity and allowing the use of a standard quadrature rule. This is an accepted simplification for introductory BEM implementations, though it introduces a modeling error dependent on the value of $\\varepsilon$. For non-touching elements, if $\\varepsilon$ is smaller than the minimum distance between them, this regularization has no effect.\n\nThe assembly algorithm is as follows:\n1. For each triangle $p \\in \\{0, 1, 2\\}$, compute its area $A_p$ and Jacobian $J_p = 2A_p$.\n2. For the specified quadrature order ($1$ or $3$), retrieve the barycentric coordinates $\\{\\boldsymbol{\\lambda}_i\\}$ and weights $\\{w_i\\}$.\n3. For each triangle $p$ and each node $i$, compute the physical-space quadrature point $\\mathbf{x}_{p,i}$.\n4. Initialize a $3 \\times 3$ complex-valued matrix $V$ to zeros.\n5. Iterate through all triangle pairs $(p, q)$, where $p, q \\in \\{0, 1, 2\\}$.\n6. For each pair $(p, q)$, compute $V_{pq}$ by iterating through all quadrature point pairs $(i, j)$:\n   a. Retrieve the physical points $\\mathbf{x} = \\mathbf{x}_{p,i}$ and $\\mathbf{y} = \\mathbf{y}_{q,j}$.\n   b. Compute the regularized Green's function $G_k(\\mathbf{x}, \\mathbf{y})$ using the parameter $\\varepsilon$.\n   c. Add the contribution $(w_i J_p)(w_j J_q)G_k(\\mathbf{x}, \\mathbf{y})$ to $V_{pq}$.\n7. After the loops complete, compute the Frobenius norm $\\|V\\|_F = \\left( \\sum_{p=0}^{2} \\sum_{q=0}^{2} |V_{pq}|^2 \\right)^{1/2}$.\n\nThe units of $V_{pq}$ are $(\\mathrm{m}^{-1}) \\cdot (\\mathrm{m}^2) \\cdot (\\mathrm{m}^2) = \\mathrm{m}^3$, as $G_k$ has units of $1/\\text{length}$ and the two surface differentials $\\mathrm{d}S$ have units of $\\text{length}^2$. Consequently, the Frobenius norm $\\|V\\|_F$ also has units of $\\mathrm{m}^3$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Frobenius norm of the Galerkin BEM matrix for the acoustic\n    single-layer operator for several test cases.\n    \"\"\"\n    \n    # Define the triangulated surface geometry\n    triangles = [\n        np.array([[0.0, 0.0, 0.0], [1.0, 0.0, 0.0], [0.0, 1.0, 0.0]]), # T_0\n        np.array([[1.0, 1.0, 0.0], [0.0, 1.0, 0.0], [1.0, 0.0, 0.0]]), # T_1\n        np.array([[2.0, 0.2, 0.3], [2.4, 0.1, 0.4], [2.1, 0.5, 0.2]])  # T_2\n    ]\n    num_triangles = len(triangles)\n\n    # Pre-compute geometric properties: areas and Jacobians\n    areas = np.zeros(num_triangles)\n    jacobians = np.zeros(num_triangles)\n    for i, tri in enumerate(triangles):\n        v1 = tri[1] - tri[0]  # Vector from vertex a to b\n        v2 = tri[2] - tri[0]  # Vector from vertex a to c\n        cross_product = np.cross(v1, v2)\n        area = 0.5 * np.linalg.norm(cross_product)\n        areas[i] = area\n        jacobians[i] = 2.0 * area # Jacobian is 2 * Area\n\n    # Define barycentric quadrature rules for a reference triangle of area 0.5\n    # Format: {order: (barycentric_coordinates, weights)}\n    quad_rules = {\n        1: (np.array([[1/3, 1/3, 1/3]]), np.array([0.5])),\n        3: (np.array([[0.5, 0.5, 0.0], [0.5, 0.0, 0.5], [0.0, 0.5, 0.5]]), \n            np.array([1/6, 1/6, 1/6]))\n    }\n\n    # Test suite: (k, epsilon, quadrature_order)\n    test_cases = [\n        (0.0, 1e-6, 3),\n        (20.0, 1e-6, 3),\n        (60.0, 1e-5, 3),\n        (60.0, 5e-2, 1)\n    ]\n\n    results = []\n\n    def green_function(x_point, y_point, k, eps):\n        \"\"\"Computes the regularized Helmholtz Green's function.\"\"\"\n        dist = np.linalg.norm(x_point - y_point)\n        # Regularization: denominator is max(dist, eps)\n        reg_dist = max(dist, eps)\n        denominator = 4.0 * np.pi * reg_dist\n        \n        if k == 0.0: # Laplace case\n            return 1.0 / denominator\n        else: # Helmholtz case\n            return np.exp(1j * k * dist) / denominator\n\n    for k_val, eps_val, quad_order in test_cases:\n        bary_coords, weights = quad_rules[quad_order]\n        num_quad_points = len(weights)\n        \n        # Pre-compute physical quadrature points for all triangles\n        physical_quad_points = np.zeros((num_triangles, num_quad_points, 3))\n        for i in range(num_triangles):\n            verts = triangles[i]\n            for j in range(num_quad_points):\n                # Map barycentric coords to physical coords: x = l1*a + l2*b + l3*c\n                physical_quad_points[i, j, :] = (bary_coords[j, 0] * verts[0] +\n                                                 bary_coords[j, 1] * verts[1] +\n                                                 bary_coords[j, 2] * verts[2])\n\n        # Initialize the Galerkin matrix V\n        V = np.zeros((num_triangles, num_triangles), dtype=np.complex128)\n\n        # Assemble the matrix V\n        for p in range(num_triangles):\n            for q in range(num_triangles):\n                vpq_val = 0.0 + 0.0j\n                # Double-loop over quadrature points (tensor product)\n                for i in range(num_quad_points):\n                    for j in range(num_quad_points):\n                        x_pi = physical_quad_points[p, i]\n                        y_qj = physical_quad_points[q, j]\n                        \n                        g_k = green_function(x_pi, y_qj, k_val, eps_val)\n                        \n                        # Accumulate contribution to V_pq\n                        weight_prod = (weights[i] * jacobians[p] * \n                                       weights[j] * jacobians[q])\n                        vpq_val += weight_prod * g_k\n                \n                V[p, q] = vpq_val\n\n        # Calculate and store the Frobenius norm of V\n        norm_f = np.linalg.norm(V, 'fro')\n        results.append(norm_f)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A correctly implemented BEM code can still produce physically incorrect results due to artifacts inherent in the chosen integral equation formulation. This exercise explores the classic problem of spurious resonances, where the numerical system unexpectedly becomes singular at specific frequencies corresponding to the interior eigenvalues of the scattering object. By analytically deriving these resonance frequencies for a simple disk, you will uncover the mathematical origins of this numerical pathology and understand its dramatic effect on the stability and accuracy of the BEM solution .",
            "id": "4118324",
            "problem": "Consider two-dimensional time-harmonic acoustics with angular frequency $\\omega$ and wavenumber $k$, where $k = \\omega / c$ and $c$ is the speed of sound. Let a sound-soft circular obstacle (a disk) of radius $a$ be centered at the origin in the plane. The exterior scattering problem enforces the Dirichlet boundary condition $p = 0$ on the boundary $r = a$, where $p$ is the acoustic pressure satisfying the Helmholtz equation $\\Delta p + k^{2} p = 0$ in the exterior. In the standard collocation Boundary Element Method (BEM), using the pure double-layer boundary integral equation for the exterior Dirichlet problem, non-uniqueness (spurious resonances) can occur at specific wavenumbers tied to the interior Dirichlet eigenvalues of the disk.\n\nStarting from the Helmholtz equation $\\Delta u + k^{2} u = 0$ and the interior Dirichlet boundary condition $u|_{r=a} = 0$, use separation of variables in polar coordinates to derive the eigenvalue condition for the interior of the disk. Then, by connecting this condition to the loss of invertibility of the pure double-layer collocation equation, identify the first three lowest nonzero frequencies (in hertz) at which spurious resonances occur for a disk of radius $a = 0.5$ $\\mathrm{m}$ in air with speed of sound $c = 343$ $\\mathrm{m/s}$. Express each frequency $f$ in hertz via $f = \\omega/(2\\pi) = c k/(2\\pi)$, and round your answers to four significant figures. State the three resonance frequencies in ascending order as a single row vector. In your derivation, justify why these interior eigenvalues cause non-uniqueness in the collocation double-layer BEM and briefly explain the qualitative effect of approaching such a frequency on the collocation solution. The final numerical answer must be given in $\\mathrm{Hz}$ and rounded to four significant figures.",
            "solution": "The problem requires the derivation of the spurious resonance frequencies for a two-dimensional exterior acoustic scattering problem involving a sound-soft circular disk. This is a classic issue in the Boundary Element Method (BEM) when using a pure double-layer potential formulation.\n\nFirst, we must find the eigenvalues of the corresponding interior Dirichlet problem. This involves solving the Helmholtz equation, $\\Delta u + k^{2} u = 0$, inside a disk of radius $a$ subject to the boundary condition $u = 0$ on the boundary $r=a$. We use separation of variables in polar coordinates $(r, \\theta)$. The Helmholtz equation in polar coordinates is:\n$$ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 u}{\\partial \\theta^2} + k^2 u = 0 $$\nLet the solution be of the form $u(r, \\theta) = R(r) \\Theta(\\theta)$. Substituting this into the equation and separating variables yields:\n$$ \\frac{r}{R(r)} \\frac{d}{dr} \\left( r \\frac{dR(r)}{dr} \\right) + k^2r^2 = - \\frac{1}{\\Theta(\\theta)} \\frac{d^2 \\Theta(\\theta)}{d\\theta^2} $$\nBoth sides must equal a constant, which we denote by $n^2$. The requirement that the solution be single-valued in $\\theta$, i.e., $\\Theta(\\theta) = \\Theta(\\theta + 2\\pi)$, restricts $n$ to be an integer, $n \\in \\{0, 1, 2, \\dots\\}$.\n\nThe angular equation is $\\frac{d^2 \\Theta}{d\\theta^2} + n^2 \\Theta = 0$, which has solutions of the form $\\Theta(\\theta) = A_n \\cos(n\\theta) + B_n \\sin(n\\theta)$.\n\nThe radial equation becomes:\n$$ r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} + (k^2r^2 - n^2)R = 0 $$\nThis is Bessel's differential equation of order $n$. Its general solution is a linear combination of the Bessel function of the first kind, $J_n(kr)$, and the Bessel function of the second kind, $Y_n(kr)$. The full solution for $u(r, \\theta)$ is thus:\n$$ u(r, \\theta) = \\sum_{n=0}^{\\infty} \\left[ C_n J_n(kr) + D_n Y_n(kr) \\right] (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) $$\nFor the interior problem, the solution must be finite at the origin ($r=0$). Since the Bessel function of the second kind, $Y_n(z)$, is singular at $z=0$, we must set all coefficients $D_n=0$ to ensure a physically valid solution.\n\nThe solution simplifies to:\n$$ u(r, \\theta) = \\sum_{n=0}^{\\infty} C_n J_n(kr) (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) $$\nApplying the Dirichlet boundary condition $u(a, \\theta) = 0$:\n$$ \\sum_{n=0}^{\\infty} C_n J_n(ka) (A_n \\cos(n\\theta) + B_n \\sin(n\\theta)) = 0 $$\nFor this equation to hold for all $\\theta$, the coefficient of each Fourier mode must be zero. For a non-trivial solution to exist (i.e., not all coefficients $A_n, B_n, C_n$ are zero), we must have:\n$$ J_n(ka) = 0 $$\nThis is the eigenvalue condition for the interior Dirichlet problem. The wavenumbers $k$ that satisfy this condition for any integer $n \\geq 0$ are the eigenvalues. Let $z_{n,m}$ be the $m$-th positive root of the Bessel function $J_n(z)$. Then the resonant wavenumbers are given by $k_{n,m} = z_{n,m}/a$.\n\nThe connection to the non-uniqueness of the collocation BEM for the exterior problem arises from the integral equation formulation. The exterior Dirichlet problem, when formulated with a pure double-layer potential, leads to the boundary integral equation $(\\frac{1}{2}I + K_k) \\mu = 0$, where $K_k$ is the double-layer boundary integral operator (which depends on $k$) and $\\mu$ is the unknown density function. This homogeneous equation has a non-trivial solution $\\mu$ if and only if the operator $(\\frac{1}{2}I + K_k)$ is singular. By the Fredholm alternative and properties of potential operators, this singularity occurs precisely when the wavenumber $k$ is an eigenvalue of the interior Dirichlet problem, i.e., when $J_n(ka) = 0$ for some $n$. These wavenumbers are thus called \"spurious\" because they are artifacts of the mathematical formulation, not a physical resonance of the exterior scattering problem itself.\n\nWhen performing a numerical collocation BEM, the integral operator is discretized into a matrix $A$. As the wavenumber $k$ approaches a spurious resonant wavenumber $k_{n,m}$, the continuous operator approaches singularity, causing the condition number of the matrix $A$ to grow without bound. This ill-conditioning means the numerical system of equations becomes nearly singular, and the computed solution for the density $\\mu$ becomes arbitrarily large and corrupted by numerical errors, leading to a physically meaningless, divergent pressure field.\n\nTo find the first three lowest nonzero frequencies, we need to find the three smallest positive roots $z_{n,m}$ of $J_n(z)=0$. We list the first few roots:\nThe roots of $J_0(z)=0$ are $z_{0,1} \\approx 2.4048$, $z_{0,2} \\approx 5.5201$, ...\nThe roots of $J_1(z)=0$ are $z_{1,1} \\approx 3.8317$, $z_{1,2} \\approx 7.0156$, ...\nThe roots of $J_2(z)=0$ are $z_{2,1} \\approx 5.1356$, $z_{2,2} \\approx 8.4172$, ...\nThe roots of $J_3(z)=0$ are $z_{3,1} \\approx 6.3802$, ...\n\nOrdering all roots $z_{n,m}$ in ascending value gives the sequence:\n$z_{0,1} \\approx 2.4048$\n$z_{1,1} \\approx 3.8317$\n$z_{2,1} \\approx 5.1356$\nThese are the three smallest positive roots.\n\nThe corresponding frequencies $f$ are calculated using the formula $f = \\frac{ck}{2\\pi} = \\frac{c z_{n,m}}{2\\pi a}$.\nGiven the parameters $c = 343 \\, \\mathrm{m/s}$ and $a = 0.5 \\, \\mathrm{m}$:\n$$ f_{n,m} = \\frac{343}{2\\pi(0.5)} z_{n,m} = \\frac{343}{\\pi} z_{n,m} $$\n1. First lowest frequency (from $z_{0,1}$):\n$$ f_1 = f_{0,1} = \\frac{343}{\\pi} \\times 2.404825... \\approx 262.5699... \\, \\mathrm{Hz} $$\nRounding to four significant figures gives $262.6 \\, \\mathrm{Hz}$.\n\n2. Second lowest frequency (from $z_{1,1}$):\n$$ f_2 = f_{1,1} = \\frac{343}{\\pi} \\times 3.831706... \\approx 418.3245... \\, \\mathrm{Hz} $$\nRounding to four significant figures gives $418.3 \\, \\mathrm{Hz}$.\n\n3. Third lowest frequency (from $z_{2,1}$):\n$$ f_3 = f_{2,1} = \\frac{343}{\\pi} \\times 5.135622... \\approx 560.7246... \\, \\mathrm{Hz} $$\nRounding to four significant figures gives $560.7 \\, \\mathrm{Hz}$.\n\nThese three frequencies represent the first three spurious resonances for the specified problem.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n262.6 & 418.3 & 560.7\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond the mathematical artifacts of the integral formulation, the accuracy and stability of a BEM simulation are critically influenced by the geometric features of the domain itself. This practice addresses the crucial challenge of discretizing domains with corners, where solution singularities can corrupt the numerical approximation if not handled carefully. Through this thought experiment, you will analyze and evaluate various practical strategies for placing collocation points near geometric vertices, a key decision that balances the need to capture local physics against the risk of inducing numerical instability .",
            "id": "4118313",
            "problem": "Consider time-harmonic acoustic scattering in $\\mathbb{R}^{2}$ by a sound-soft polygonal obstacle with boundary $\\Gamma$. The total field $u$ satisfies the Helmholtz equation $\\Delta u + k^{2} u = 0$ in the exterior of $\\Gamma$ with Dirichlet data $u = 0$ on $\\Gamma$ and the Sommerfeld radiation condition at infinity. A standard Boundary Integral Equation (BIE) formulation expresses the field in terms of layer potentials built from the free-space Green’s function $G_{k}(x,y)$, whose kernel has a weak singularity as $|x-y| \\to 0$. In a collocation Boundary Element Method (BEM) discretization, the boundary $\\Gamma$ is partitioned into straight panels of typical size $h$, an approximation space of piecewise polynomials is chosen, and the boundary condition is enforced at a set of collocation points on $\\Gamma$.\n\nOn polygonal boundaries, the solution and boundary data exhibit corner singularities that affect both approximation error and the conditioning of the discrete linear system. Suppose one is considering how to place collocation points near vertices of $\\Gamma$ in a piecewise-polynomial collocation BEM for the exterior Dirichlet problem, at a fixed wavenumber $k$ that avoids interior resonances of any auxiliary formulation used. Assume that near a corner with interior angle $\\theta \\in (0,2\\pi)$, the exact boundary data exhibits the standard wedge singularity behavior in terms of distance $r$ to the corner (with exponents depending on $\\theta$), and that the BIE operator has the usual weakly singular and near-singular kernels inherited from $G_{k}$ and its derivatives.\n\nWhich of the following statements about placing collocation points near corners, and about corrective strategies such as oversampling or shifted collocation points, are true? Select all that apply.\n\nA. Aggressively clustering many collocation points arbitrarily close to each polygonal vertex while keeping a uniform mesh and a piecewise-constant basis always reduces the $L^{2}$ error without materially affecting the condition number, because the weakly singular kernel is integrable and thus benign.\n\nB. Enforcing the boundary condition exactly at the geometric vertices (i.e., collocating at the corners) typically deteriorates stability and accuracy, because the corner singularity is sampled at its strongest; shifting the would-be corner collocation points by a distance of order $\\mathcal{O}(h)$ along the adjacent edges or along the angle bisector, or alternatively omitting vertex collocation while oversampling elsewhere, generally improves conditioning at fixed accuracy.\n\nC. Using oversampling, i.e., taking more collocation points than unknowns and solving the resulting overdetermined system in a least-squares sense, can mitigate spurious oscillations and sensitivity near corners caused by under-resolution and near-linear dependencies; it also permits avoiding vertex collocation entirely while maintaining stability.\n\nD. Moving collocation points off the boundary by a small normal offset $\\delta \\sim h$ near corners is invalid in Helmholtz BEM because the fundamental solution is undefined away from $\\Gamma$, so any “shifted points” must remain strictly on $\\Gamma$.\n\nE. For a re-entrant corner with interior angle $\\theta > \\pi$, the leading singular exponent for wedge solutions satisfies $\\lambda_{1} = \\pi/\\theta < 1$, so the boundary data typically behaves like $r^{\\lambda_{1}-1}$; therefore, geometric grading of panel sizes toward the corner or enriching the basis with corner-singular functions reduces approximation error, but if collocation points are packed closer to the corner than the local geometric grading, the discrete system’s condition number tends to blow up like a negative power of the minimum point-to-corner distance.",
            "solution": "The user requires a critical validation of the problem statement, followed by a detailed derivation of the solution and an evaluation of each option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Physical System:** Time-harmonic acoustic scattering in $\\mathbb{R}^{2}$.\n*   **Equation:** Helmholtz equation, $\\Delta u + k^{2} u = 0$, in the exterior of an obstacle.\n*   **Obstacle:** A sound-soft polygonal obstacle with boundary $\\Gamma$.\n*   **Boundary Conditions:**\n    1.  Dirichlet condition: $u = 0$ on $\\Gamma$.\n    2.  Sommerfeld radiation condition at infinity.\n*   **Numerical Method:** Collocation Boundary Element Method (BEM) based on a Boundary Integral Equation (BIE) formulation.\n*   **Integral Kernel:** The BIE involves the free-space Green's function $G_{k}(x,y)$, which has a weak singularity as $|x-y| \\to 0$.\n*   **Discretization:** The boundary $\\Gamma$ is discretized into straight panels of size $h$, and the unknown is approximated using piecewise polynomials.\n*   **Core Issue:** Behavior of the numerical solution near vertices (corners) of the polygon, where the exact solution exhibits singularities.\n*   **Specifics:**\n    *   The interior angle at a corner is denoted by $\\theta \\in (0, 2\\pi)$.\n    *   The exact boundary data has a known singular behavior with respect to the distance $r$ from a corner.\n    *   The wavenumber $k$ is assumed not to be an interior resonance frequency of any auxiliary formulation used, ensuring the underlying continuous BIE is well-posed.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded (Critical):** The problem is firmly rooted in the well-established fields of computational acoustics, numerical analysis, and the theory of partial differential equations. The Helmholtz equation, BEM, and the analysis of singularities on non-smooth domains are standard topics of research and application. The problem is scientifically sound.\n*   **Well-Posed:** The problem statement is well-posed. The exterior Dirichlet problem for the Helmholtz equation is a classic well-posed problem. The assumptions made (e.g., avoidance of characteristic frequencies) ensure the validity of the continuous formulation. The question itself, concerning the properties and pitfalls of a specific numerical discretization (collocation BEM), is a standard and meaningful question in numerical analysis.\n*   **Objective (Critical):** The problem is stated using precise, objective, and standard terminology from mathematics and computational science (e.g., \"collocation points\", \"condition number\", \"$L^2$ error\", \"weakly singular kernel\", \"wedge singularity\"). There are no subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. It presents a standard, well-defined scenario in computational engineering and asks a series of verifiable questions about the behavior of the corresponding numerical method. I will proceed with the detailed solution.\n\n### Solution Derivation\n\nThe problem asks to identify the true statements regarding the placement of collocation points in a BEM for the Helmholtz equation on a polygonal domain, with a focus on behavior near corners.\n\n**Analysis of Option A**\n\nA. Aggressively clustering many collocation points arbitrarily close to each polygonal vertex while keeping a uniform mesh and a piecewise-constant basis always reduces the $L^{2}$ error without materially affecting the condition number, because the weakly singular kernel is integrable and thus benign.\n\nThis statement is **Incorrect**.\n1.  **Condition Number:** Placing collocation points very close to one another is a well-known cause of ill-conditioning in BEM. If two collocation points, $x_i$ and $x_j$, are very close, the corresponding rows in the system matrix become nearly linearly dependent. This is because the integral operators in BEM have kernels that are smooth functions of the collocation point's position (away from the integration variable). Consequently, the matrix rows become nearly identical, causing the condition number to grow significantly.\n2.  **Approximation Error:** Using a uniform mesh and a low-order basis (piecewise-constant) is an inefficient way to approximate functions with singularities. The approximation error will be large near the corner and will converge slowly as $h \\to 0$. Simply clustering collocation points, without a corresponding refinement of the mesh or enrichment of the basis space, does not guarantee a reduction in the global $L^{2}$ error and can introduce spurious oscillations.\n3.  **Kernel Integrability:** The fact that the single-layer kernel ($G_k(x,y)$) is weakly singular and integrable ensures that the corresponding integral operator is bounded on appropriate function spaces. It does not, however, prevent the discrete system from becoming ill-conditioned due to poor placement of collocation points.\n\n**Analysis of Option B**\n\nB. Enforcing the boundary condition exactly at the geometric vertices (i.e., collocating at the corners) typically deteriorates stability and accuracy, because the corner singularity is sampled at its strongest; shifting the would-be corner collocation points by a distance of order $\\mathcal{O}(h)$ along the adjacent edges or along the angle bisector, or alternatively omitting vertex collocation while oversampling elsewhere, generally improves conditioning at fixed accuracy.\n\nThis statement is **Correct**.\nThe unknown function in many BIE formulations for this problem is the normal derivative of the total field, $\\partial_n u$. The solution to the Helmholtz equation near a corner with interior angle $\\theta$ behaves like $u \\sim r^{\\pi/\\theta}$, so its normal derivative behaves like $\\partial_n u \\sim r^{(\\pi/\\theta) - 1}$. Unless $\\theta=\\pi$ (a flat boundary), this function is singular (either blows up, for $\\theta>\\pi$, or has a derivative that blows up, for $\\theta<\\pi$). Attempting to enforce the integral equation at the corner ($r=0$) is numerically unstable and ill-defined. Shifting the collocation points away from the vertices by a small amount (e.g., to the element centers for piecewise constant elements, or to interior Gauss points for higher-order elements) is standard practice. This avoids sampling the singularity at its peak, leading to a much more stable and well-conditioned linear system and, ultimately, a more accurate solution.\n\n**Analysis of Option C**\n\nC. Using oversampling, i.e., taking more collocation points than unknowns and solving the resulting overdetermined system in a least-squares sense, can mitigate spurious oscillations and sensitivity near corners caused by under-resolution and near-linear dependencies; it also permits avoiding vertex collocation entirely while maintaining stability.\n\nThis statement is **Correct**.\nStandard collocation with $N$ unknowns and $N$ collocation points is equivalent to forcing the residual of the integral equation to be zero at exactly those $N$ points. This can be sensitive to the choice of points. Oversampling involves using $M > N$ collocation points, resulting in a rectangular $M \\times N$ system $Ax=b$. Solving this system in a least-squares sense finds the solution $x$ that minimizes the Euclidean norm of the residual, $\\|Ax-b\\|_2$. This approach has several benefits:\n1.  **Regularization/Smoothing:** By averaging the error over many points, it tends to smooth out the solution and suppress the spurious oscillations (Gibbs-like phenomena) that can occur when approximating a singular function with smooth polynomials.\n2.  **Stability:** It makes the system more robust against near-linear dependencies that might arise from having some collocation points close together.\n3.  **Flexibility:** It allows the user to omit collocation points at problematic locations (like corners) and compensate by adding more points in well-behaved regions, thereby maintaining a stable and well-constrained system.\n\n**Analysis of Option D**\n\nD. Moving collocation points off the boundary by a small normal offset $\\delta \\sim h$ near corners is invalid in Helmholtz BEM because the fundamental solution is undefined away from $\\Gamma$, so any “shifted points” must remain strictly on $\\Gamma$.\n\nThis statement is **Incorrect**.\nThe reasoning provided is factually wrong. The fundamental solution (Green's function) $G_{k}(x,y)$ is singular only when the field point $x$ and the source point $y$ coincide. In the BEM context, the source points $y$ are on the boundary $\\Gamma$. If the collocation points $x$ are moved to an offset surface $\\Gamma_{\\text{off}}$ such that $x \\notin \\Gamma$, then $x$ never equals $y$. In this case, the kernel $G_{k}(x,y)$ and its derivatives are perfectly well-defined (in fact, they are analytic functions) for all $x \\in \\Gamma_{\\text{off}}$ and $y \\in \\Gamma$. This strategy, known as off-boundary BEM or the regular BEM, is a valid technique that transforms the singular integrals of conventional BEM into regular integrals, though it has its own challenges regarding the choice of the offset distance $\\delta$.\n\n**Analysis of Option E**\n\nE. For a re-entrant corner with interior angle $\\theta > \\pi$, the leading singular exponent for wedge solutions satisfies $\\lambda_{1} = \\pi/\\theta < 1$, so the boundary data typically behaves like $r^{\\lambda_{1}-1}$; therefore, geometric grading of panel sizes toward the corner or enriching the basis with corner-singular functions reduces approximation error, but if collocation points are packed closer to the corner than the local geometric grading, the discrete system’s condition number tends to blow up like a negative power of the minimum point-to-corner distance.\n\nThis statement is **Correct**.\nIt provides a technically accurate and detailed summary of advanced BEM for corner singularities.\n1.  **Singularity Exponent:** The analysis of the singularity is correct. For a re-entrant corner ($\\theta > \\pi$), the leading exponent for the solution is $\\lambda_1 = \\pi/\\theta < 1$. The normal derivative (the typical unknown \"boundary data\" in the BIE) behaves like $r^{\\lambda_1-1}$, which is an integrable but non-square-integrable singularity (it blows up as $r \\to 0$).\n2.  **Corrective Strategies:** The two state-of-the-art methods for handling these singularities to recover high accuracy are correctly identified: (i) geometric mesh grading, where element sizes are refined towards the corner, and (ii) basis enrichment, where special functions that capture the known singular behavior (like $r^{\\lambda_1-1}$) are added to the approximation space.\n3.  **Conditioning Issues:** The final point is also a known result from the advanced numerical analysis of BEM. Even with a graded mesh, the placement of collocation points matters. If they are placed \"aggressively,\" i.e., much closer to the corner than the local element size would naturally suggest, this re-introduces the problem of near-linear dependence between rows of the matrix, causing the condition number to increase, typically as a negative power of the distance to the corner. This highlights the delicate balance required in designing high-order, singularity-capturing BEM schemes.\n\nTherefore, statements B, C, and E are true.",
            "answer": "$$\\boxed{BCE}$$"
        }
    ]
}