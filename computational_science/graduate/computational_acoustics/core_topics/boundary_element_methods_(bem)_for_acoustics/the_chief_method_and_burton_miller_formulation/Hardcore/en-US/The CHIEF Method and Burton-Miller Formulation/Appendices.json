{
    "hands_on_practices": [
        {
            "introduction": "We begin with a canonical problem in acoustic scattering: the interaction of a plane wave with a sound-soft sphere. This exercise is foundational because it is one of the few scattering problems with a known analytical solution, derived through the method of separation of variables. By working through this derivation, you will not only obtain the exact scattered field but also pinpoint the specific frequencies at which standard Boundary Integral Equation (BIE) methods fail, connecting them to the sphere's interior resonant modes like the one for the $l=0$ mode. This practice provides a crucial theoretical benchmark for understanding the non-uniqueness problem and the conceptual motivation behind the CHIEF and Burton-Miller methods. ",
            "id": "4139725",
            "problem": "Consider time-harmonic acoustic scattering of a plane wave by a sound-soft sphere in a homogeneous, inviscid fluid. Let the total acoustic pressure field $p(\\mathbf{x})$ satisfy the Helmholtz equation $\\nabla^{2} p + k^{2} p = 0$ in the exterior of a sphere of radius $a$, with the Dirichlet boundary condition $p|_{r=a} = 0$, and the Sommerfeld radiation condition at infinity. Assume a time dependence $\\exp(-\\mathrm{i} \\omega t)$, so that $k = \\omega / c$, with $c$ the sound speed. A plane wave of unit amplitude is incident along the $z$-axis, $p^{\\mathrm{i}}(\\mathbf{x}) = \\exp(\\mathrm{i} k z)$.\n\nStarting from the Helmholtz equation and the separation-of-variables representation in spherical coordinates, derive the far-field scattering amplitude $f(\\theta)$ such that in the far field $p^{\\mathrm{s}}(r,\\theta) \\sim \\frac{\\exp(\\mathrm{i} k r)}{r} f(\\theta)$ as $r \\to \\infty$, where $p^{\\mathrm{s}}$ is the scattered field and $\\theta$ is the polar angle. In addition, identify the frequencies at which interior resonances occur for the exterior Dirichlet problem, in the sense that the conventional boundary integral equation possesses non-unique solutions at those frequencies; connect this identification to the modal separation-of-variables analysis.\n\nFinally, for a sphere of radius $a = 0.50$ m in water with sound speed $c = 1.50 \\times 10^{3}$ m/s, compute the lowest positive interior resonant angular frequency $\\omega_{1}$ (in radians per second) associated with the $l=0$ mode. Round your numerical result to four significant figures and express the angular frequency in radians per second. You may assume the following well-tested facts: the plane-wave expansion in spherical harmonics and the far-field asymptotics of spherical Hankel functions. In your derivation, explicitly define the Combined Helmholtz Integral Equation Formulation (CHIEF) and the Burton-Miller combined-field integral equation (Burton-Miller) on their first appearances, and explain at a conceptual level how each removes spurious non-uniqueness due to interior resonances without altering the physical scattering amplitude derived by separation of variables.\n\nYour final answer must consist of two components presented as a single row matrix: the closed-form series expression for $f(\\theta)$, and the computed value of $\\omega_{1}$.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It represents a standard problem in acoustic scattering theory and is therefore valid.\n\nThe total acoustic pressure field $p(\\mathbf{x})$ is the sum of the incident plane wave $p^{\\mathrm{i}}(\\mathbf{x})$ and the scattered field $p^{\\mathrm{s}}(\\mathbf{x})$, so $p(\\mathbf{x}) = p^{\\mathrm{i}}(\\mathbf{x}) + p^{\\mathrm{s}}(\\mathbf{x})$. Both $p$ and $p^{\\mathrm{i}}$ satisfy the Helmholtz equation, $\\nabla^{2} \\phi + k^{2} \\phi = 0$, thus the scattered field $p^{\\mathrm{s}}$ must also satisfy it.\n\nThe incident plane wave propagating along the $z$-axis is given by $p^{\\mathrm{i}}(\\mathbf{x}) = \\exp(\\mathrm{i}kz) = \\exp(\\mathrm{i}kr\\cos\\theta)$. Its expansion in terms of Legendre polynomials $P_l(\\cos\\theta)$ and spherical Bessel functions of the first kind $j_l(kr)$ is:\n$$ p^{\\mathrm{i}}(r, \\theta) = \\sum_{l=0}^{\\infty} \\mathrm{i}^l (2l+1) j_l(kr) P_l(\\cos\\theta) $$\nDue to the azimuthal symmetry of the incident wave and the spherical scatterer, the scattered field $p^{\\mathrm{s}}$ will also be independent of the azimuthal angle $\\phi$. We can express $p^{\\mathrm{s}}$ as a series of partial waves. To satisfy the Sommerfeld radiation condition, which dictates that the scattered wave must be purely outgoing at infinity, we use spherical Hankel functions of the first kind, $h_l^{(1)}(kr)$:\n$$ p^{\\mathrm{s}}(r, \\theta) = \\sum_{l=0}^{\\infty} A_l h_l^{(1)}(kr) P_l(\\cos\\theta) $$\nThe coefficients $A_l$ are determined by the boundary condition on the surface of the sphere. For a sound-soft sphere of radius $a$, the total pressure is zero on the boundary: $p(a, \\theta) = 0$. This implies $p^{\\mathrm{s}}(a, \\theta) = -p^{\\mathrm{i}}(a, \\theta)$.\nSubstituting the series expansions into the boundary condition gives:\n$$ \\sum_{l=0}^{\\infty} A_l h_l^{(1)}(ka) P_l(\\cos\\theta) = - \\sum_{l=0}^{\\infty} \\mathrm{i}^l (2l+1) j_l(ka) P_l(\\cos\\theta) $$\nBy the orthogonality of the Legendre polynomials, we can equate the coefficients for each mode $l$:\n$$ A_l h_l^{(1)}(ka) = - \\mathrm{i}^l (2l+1) j_l(ka) $$\nSolving for the unknown coefficients $A_l$:\n$$ A_l = - (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} $$\nThe scattered field is thus:\n$$ p^{\\mathrm{s}}(r, \\theta) = - \\sum_{l=0}^{\\infty} (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} h_l^{(1)}(kr) P_l(\\cos\\theta) $$\nTo find the far-field scattering amplitude $f(\\theta)$, we examine the asymptotic behavior of $p^{\\mathrm{s}}$ as $r \\to \\infty$. The spherical Hankel functions have the asymptotic form:\n$$ h_l^{(1)}(kr) \\sim \\frac{1}{kr} \\exp\\left(\\mathrm{i}\\left(kr - \\frac{(l+1)\\pi}{2}\\right)\\right) = \\frac{(-\\mathrm{i})^{l+1}}{kr} \\exp(\\mathrm{i}kr) $$\nSubstituting this into the expression for $p^{\\mathrm{s}}$:\n$$ p^{\\mathrm{s}}(r, \\theta) \\sim \\sum_{l=0}^{\\infty} A_l P_l(\\cos\\theta) \\frac{(-\\mathrm{i})^{l+1}}{kr} \\exp(\\mathrm{i}kr) = \\frac{\\exp(\\mathrm{i}kr)}{r} \\left( \\frac{1}{k} \\sum_{l=0}^{\\infty} A_l (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) \\right) $$\nBy comparing this with the definition $p^{\\mathrm{s}}(r,\\theta) \\sim \\frac{\\exp(\\mathrm{i}kr)}{r} f(\\theta)$, we identify the scattering amplitude:\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} A_l (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) $$\nSubstituting the expression for $A_l$:\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} \\left( - (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} \\right) (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) $$\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} [- \\mathrm{i}^l (-\\mathrm{i})^{l+1}] P_l(\\cos\\theta) $$\nThe term in the square brackets simplifies as: $- \\mathrm{i}^l (-1)^{l+1} \\mathrm{i}^{l+1} = (-1)^{l+2} \\mathrm{i}^{2l+1} = (-1)^l (-1)^l \\mathrm{i} = \\mathrm{i}$.\nThus, the far-field scattering amplitude is:\n$$ f(\\theta) = \\frac{\\mathrm{i}}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} P_l(\\cos\\theta) $$\n\nThe problem of interior resonances arises when solving this scattering problem using Boundary Integral Equation (BIE) methods. For an exterior Dirichlet problem (like the sound-soft scatterer), a formulation based on a single-layer potential fails at certain characteristic frequencies. These frequencies correspond to the eigenvalues of the associated interior Dirichlet problem for the Helmholtz equation: $\\nabla^2 u + k^2 u = 0$ inside the volume enclosed by the boundary, with $u=0$ on the boundary.\nThe connection to the modal separation-of-variables analysis is direct. The non-trivial solutions (eigenfunctions) to the interior Dirichlet problem for the sphere exist only at specific wavenumbers $k$. Using separation of variables for the interior, a solution regular at the origin is of the form $u(r,\\theta,\\phi) = \\sum_{l,m} C_{lm} j_l(kr) Y_l^m(\\theta,\\phi)$. The boundary condition $u(a,\\theta,\\phi)=0$ requires that $j_l(ka)=0$ for some non-negative integer $l$. The wavenumbers $k$ satisfying this condition for any $l$ are the resonant wavenumbers. At these wavenumbers, the integral operator has a non-trivial null space, and the BIE is ill-posed.\n\nTo overcome this non-uniqueness, several methods have been developed.\nThe **Combined Helmholtz Integral Equation Formulation (CHIEF)** is a method that enforces the integral representation of the scattered field to be zero at a number of points selected inside the scattering body. The Helmholtz integral representation for the exterior scattered field $p^{\\mathrm{s}}$ yields zero for any point $\\mathbf{x}_{\\text{int}}$ in the interior domain. These additional constraint equations are appended to the original discretized surface BIE, forming an overdetermined system of linear equations. This system is then typically solved in a least-squares sense. The spurious solutions associated with the interior resonances generally do not satisfy these additional interior constraints (unless a CHIEF point happens to lie on a nodal surface of the interior eigenmode), thus ensuring a unique solution is found.\n\nThe **Burton-Miller combined-field integral equation** regularizes the problem by forming a linear combination of the standard surface Helmholtz integral equation and its normal derivative. The resulting combined equation is of the form $\\mathcal{A} + \\alpha \\mathcal{B} = g$, where $\\mathcal{A}$ is the original ill-posed equation, $\\mathcal{B}$ is its normal derivative, and $\\alpha$ is a complex coupling parameter. A common formulation for the exterior Dirichlet problem is to combine the single-layer and hypersingular operators, $(S + \\alpha N) v = g_{\\text{new}}$, where $v$ is the unknown normal derivative and $N$ is the hypersingular operator. It can be proven that if the imaginary part of $\\alpha$ is non-zero (a common choice is $\\alpha = \\mathrm{i}/k$), the combined operator is invertible for all real, positive wavenumbers $k$. This robustly removes the non-uniqueness issue for all geometries and frequencies, unlike CHIEF, which can fail if the interior points are chosen poorly.\n\nFinally, we compute the lowest positive interior resonant angular frequency $\\omega_{1}$ for the $l=0$ mode. This corresponds to the lowest positive wavenumber $k_1$ for which $j_0(k_1a)=0$.\nThe spherical Bessel function of order $0$ is $j_0(x) = \\frac{\\sin(x)}{x}$.\nThe condition $j_0(k_1a) = 0$ requires $\\frac{\\sin(k_1a)}{k_1a} = 0$. Since we are looking for a positive frequency, $k_1 a > 0$, so we must have $\\sin(k_1a)=0$.\nThe smallest positive solution for the argument is $k_1 a = \\pi$.\nThe wavenumber $k$ is related to the angular frequency $\\omega$ by $k = \\omega/c$. Therefore, $k_1 = \\omega_1/c$.\nSubstituting this into our condition:\n$$ \\frac{\\omega_1 a}{c} = \\pi $$\nSolving for $\\omega_1$:\n$$ \\omega_1 = \\frac{\\pi c}{a} $$\nThe problem provides the values $a = 0.50$ m and $c = 1.50 \\times 10^3$ m/s.\n$$ \\omega_1 = \\frac{\\pi (1.50 \\times 10^3 \\text{ m/s})}{0.50 \\text{ m}} = \\pi \\times 3.0 \\times 10^3 \\text{ rad/s} $$\nNumerically, this is $\\omega_1 \\approx 9424.777...$ rad/s.\nRounding to four significant figures, we get $\\omega_1 = 9425$ rad/s, or in scientific notation, $9.425 \\times 10^3$ rad/s.",
            "answer": "$$\n\\boxed{\n\\pmatrix{\n\\frac{\\mathrm{i}}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} P_l(\\cos\\theta) & 9.425 \\times 10^{3}\n}\n}\n$$"
        },
        {
            "introduction": "Having established the concept of interior resonances in three dimensions, we now turn to a two-dimensional case involving a sound-soft circular obstacle. The core issue of non-uniqueness remains, but this practice reveals a critical nuance: the specific type of interior resonance that causes failure depends on the chosen integral equation formulation. This exercise will guide you to identify the 'irregular frequencies' for an exterior sound-soft problem by analyzing the resonant modes of the corresponding *interior Neumann* problem, providing a valuable counterpoint to the previous example and deepening your understanding of the underlying theory. ",
            "id": "4139769",
            "problem": "Consider two-dimensional time-harmonic acoustic scattering by a sound-soft circular obstacle of radius $a$ in air. The exterior acoustic pressure $p$ satisfies the Helmholtz equation $\\nabla^{2} p + k^{2} p = 0$ with wavenumber $k = \\omega / c$, where $\\omega$ is the angular frequency and $c$ is the speed of sound. The sound-soft boundary condition on the obstacle surface imposes $p = 0$ on $r = a$. In conventional boundary integral equation formulations using only a single classical boundary operator, non-uniqueness (irregular frequencies) occurs at those $k$ for which the corresponding interior boundary value problem possesses nontrivial homogeneous solutions. For the sound-soft exterior problem, these irregular frequencies are associated with interior Neumann eigenvalues of the Laplacian on the disk.\n\nStarting from the Helmholtz equation and the appropriate interior Neumann boundary condition, derive the resonance condition that identifies the irregular wavenumbers in terms of Bessel functions. Then, determine the lowest positive irregular frequency for a circular obstacle of radius $a = 0.25\\,\\mathrm{m}$ in air with speed of sound $c = 343\\,\\mathrm{m/s}$. Express your final answer as the frequency in $\\mathrm{Hz}$, and round your result to four significant figures.\n\nIn your reasoning, explain how the Combined Helmholtz Integral Equation Formulation (CHIEF) and the Burton-Miller formulation remove the non-uniqueness at these irregular frequencies, but compute only the requested lowest positive irregular frequency.",
            "solution": "The problem as stated is valid. It is scientifically sound, well-posed, and contains all necessary information for a unique solution.\n\nThe problem asks for the lowest positive irregular frequency associated with the integral equation formulation for acoustic scattering from a sound-soft circular obstacle. For an exterior Dirichlet (sound-soft) problem, where the pressure $p=0$ on the boundary, the irregular frequencies of the standard boundary integral equation (BIE) formulation correspond to the wavenumbers $k$ for which the interior homogeneous Neumann problem has non-trivial solutions. We must therefore find the eigenvalues of the Laplacian for the interior of a disk of radius $a$ with a homogeneous Neumann boundary condition.\n\nThe governing equation is the Helmholtz equation in two dimensions:\n$$ \\nabla^{2} p + k^{2} p = 0 $$\nfor the interior domain $r < a$. The homogeneous Neumann boundary condition on the circle $r=a$ is:\n$$ \\frac{\\partial p}{\\partial n} = 0 \\quad \\text{at} \\quad r=a $$\nwhere $\\vec{n}$ is the outward normal vector. In polar coordinates $(r, \\theta)$, this condition becomes:\n$$ \\frac{\\partial p}{\\partial r} = 0 \\quad \\text{at} \\quad r=a $$\n\nWe solve the Helmholtz equation using the method of separation of variables. Let $p(r, \\theta) = R(r)\\Theta(\\theta)$. Substituting this into the Helmholtz equation expressed in polar coordinates,\n$$ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial p}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 p}{\\partial \\theta^2} + k^2 p = 0 $$\nwe obtain two ordinary differential equations after separation:\n$$ \\frac{d^2 \\Theta}{d \\theta^2} + m^2 \\Theta = 0 $$\n$$ r^2 \\frac{d^2 R}{d r^2} + r \\frac{d R}{d r} + (k^2 r^2 - m^2) R = 0 $$\nwhere $m^2$ is the separation constant. For the solution to be single-valued in $\\theta$, $m$ must be an integer, $m = 0, 1, 2, \\dots$. The solution to the angular equation is a linear combination of $\\cos(m\\theta)$ and $\\sin(m\\theta)$.\n\nThe radial equation is Bessel's differential equation. Its general solution is a linear combination of the Bessel function of the first kind, $J_m(kr)$, and the Bessel function of the second kind, $Y_m(kr)$. Since the physical domain includes the origin ($r=0$) and the solution for the acoustic pressure $p$ must remain finite there, we must discard the Bessel function of the second kind, $Y_m(kr)$, as it is singular at the origin. Thus, the radial solution is $R(r) = J_m(kr)$.\n\nThe general solution for the interior pressure field is a superposition of all possible modes:\n$$ p(r, \\theta) = \\sum_{m=0}^{\\infty} \\left( A_m \\cos(m\\theta) + B_m \\sin(m\\theta) \\right) J_m(kr) $$\nwhere $A_m$ and $B_m$ are constants.\n\nNow, we apply the homogeneous Neumann boundary condition at $r=a$:\n$$ \\left. \\frac{\\partial p}{\\partial r} \\right|_{r=a} = \\sum_{m=0}^{\\infty} \\left( A_m \\cos(m\\theta) + B_m \\sin(m\\theta) \\right) \\left. \\frac{d}{dr} J_m(kr) \\right|_{r=a} = 0 $$\nUsing the chain rule, $\\frac{d}{dr} J_m(kr) = k J'_m(kr)$, where the prime denotes differentiation with respect to the argument. This gives:\n$$ \\sum_{m=0}^{\\infty} k \\left( A_m \\cos(m\\theta) + B_m \\sin(m\\theta) \\right) J'_m(ka) = 0 $$\nFor this equation to hold for all $\\theta \\in [0, 2\\pi)$, the coefficient of each orthogonal basis function ($\\cos(m\\theta)$ and $\\sin(m\\theta)$) must be zero. This means that for each mode $m$, we must have:\n$$ A_m k J'_m(ka) = 0 \\quad \\text{and} \\quad B_m k J'_m(ka) = 0 $$\nWe are seeking non-trivial solutions, which means that for at least one mode $m$, at least one of the coefficients ($A_m$ or $B_m$) must be non-zero. This is only possible if the other factor in the product is zero. Since we are interested in positive frequencies, we require $k > 0$. Therefore, the condition for a non-trivial solution to exist is:\n$$ J'_m(ka) = 0 $$\nfor some integer $m \\geq 0$. The values of $k$ that satisfy this equation are the irregular wavenumbers for the exterior sound-soft problem. Let $z_{mn}$ denote the $n$-th positive root of the equation $J'_m(z) = 0$. The corresponding irregular wavenumbers are given by $k_{mn} a = z_{mn}$, or:\n$$ k_{mn} = \\frac{z_{mn}}{a} $$\n\nTo find the lowest positive irregular frequency, we must find the smallest positive value of $k_{mn}$, which corresponds to finding the overall smallest root $z_{mn}$ for all $m \\geq 0$ and $n \\geq 1$. We list the first few positive roots of $J'_m(z) = 0$ for small $m$:\n- For $m=0$: $z_{01} \\approx 3.8317$, $z_{02} \\approx 7.0156, \\dots$\n- For $m=1$: $z_{11} \\approx 1.8412$, $z_{12} \\approx 5.3314, \\dots$\n- For $m=2$: $z_{21} \\approx 3.0542$, $z_{22} \\approx 6.7061, \\dots$\n- For $m=3$: $z_{31} \\approx 4.2012$, $z_{32} \\approx 8.0152, \\dots$\n\nThe smallest of all these roots is $z_{11} \\approx 1.84118$. This root corresponds to the mode $(m, n) = (1, 1)$. The lowest irregular wavenumber is therefore:\n$$ k_{\\min} = \\frac{z_{11}}{a} $$\nThe angular frequency is $\\omega = ck$, so the lowest irregular angular frequency is $\\omega_{\\min} = c k_{\\min} = \\frac{c z_{11}}{a}$. The frequency in Hertz is $f = \\omega / (2\\pi)$, so the lowest positive irregular frequency is:\n$$ f_{\\min} = \\frac{c k_{\\min}}{2\\pi} = \\frac{c z_{11}}{2\\pi a} $$\nUsing the given values $a = 0.25\\,\\mathrm{m}$ and $c = 343\\,\\mathrm{m/s}$, and the value $z_{11} \\approx 1.84118378$:\n$$ f_{\\min} = \\frac{(343\\,\\mathrm{m/s}) \\times 1.84118378}{2\\pi \\times (0.25\\,\\mathrm{m})} \\approx \\frac{631.52414}{1.570796}\\,\\mathrm{Hz} \\approx 402.0433\\,\\mathrm{Hz} $$\nRounding the result to four significant figures, we get $402.0\\,\\mathrm{Hz}$.\n\nBefore concluding, we address the non-uniqueness problem and its remedies. The use of BIEs based on Green's second identity leads to integral operators that may not be invertible at certain frequencies, known as irregular or fictitious frequencies. As demonstrated, for the exterior sound-soft (Dirichlet) problem, these frequencies match the resonant frequencies of the corresponding interior Neumann problem. At these frequencies, the BIE admits non-unique solutions, corrupting the numerical result. Two common methods to overcome this are the CHIEF and Burton-Miller formulations.\n\nThe Combined Helmholtz Integral Equation Formulation (CHIEF), introduced by H. A. Schenck, circumvents non-uniqueness by supplementing the BIE with additional constraints. The Helmholtz integral representation theorem guarantees that the total field is zero at any point in the interior of the scattering obstacle. CHIEF exploits this by requiring the solution to be zero at a number of selected interior points (CHIEF points). This leads to an overdetermined system of linear equations which is then solved in a least-squares sense. This procedure restores uniqueness, provided the CHIEF points do not lie on the nodal surfaces of the interior resonant mode.\n\nThe Burton-Miller formulation, introduced by A. J. Burton and G. F. Miller, creates a new integral equation by taking a linear combination of the original BIE and its normal derivative. The combined equation is of the form $L p + \\alpha N p = f + \\alpha g$, where $L$ and $N$ are the original and derivative integral operators, and $\\alpha$ is a complex coupling constant (typically purely imaginary, e.g., $\\alpha = i/\\eta$ for some real $\\eta>0$). This combined operator can be proven to be uniquely invertible for all real, positive wavenumbers $k$. The main practical difficulty of the Burton-Miller method is that the normal derivative of the BIE involves hypersingular integral operators, which require special mathematical and numerical treatment for their evaluation.\n\nBoth methods successfully eliminate the problem of irregular frequencies, thus yielding a robust numerical method valid for all frequencies.",
            "answer": "$$\n\\boxed{402.0}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between analytical theory and computational reality. The 'failure' of a boundary integral formulation at a resonant frequency manifests numerically as severe ill-conditioning of the discretized system matrix, leading to unreliable or meaningless results. In this hands-on coding exercise, you will implement the system matrices for a standard direct integral equation, a CHIEF-augmented system, and a Burton-Miller formulation. By comparing the matrix condition numbers at resonant and non-resonant frequencies, you will directly observe and quantify the dramatic stabilizing effect that these advanced formulations provide, turning an ill-posed problem into a robustly solvable one. ",
            "id": "4139731",
            "problem": "Consider time-harmonic acoustic scattering in two spatial dimensions governed by the Helmholtz equation for the total acoustic pressure field $p(\\mathbf{x})$,\n$$\\nabla^2 p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = 0,$$\nwhere $k$ is the acoustic wavenumber expressed in $1/\\mathrm{m}$. The geometry is the unit-radius circle in the plane, namely the set $\\Gamma = \\{\\mathbf{x} \\in \\mathbb{R}^2 : \\|\\mathbf{x}\\| = R\\}$ with $R = 1\\,\\mathrm{m}$, and outward unit normal $\\mathbf{n}_\\Gamma(\\mathbf{y})$ at a boundary point $\\mathbf{y} \\in \\Gamma$. The fundamental solution (Green’s function) of the two-dimensional Helmholtz operator is \n$$G(\\mathbf{x},\\mathbf{y};k) = \\frac{i}{4} H_0^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big),$$\nwhere $H_0^{(1)}$ is the zeroth-order Hankel function of the first kind. The classical double-layer potential operator $D$ and the normal derivative of the single-layer potential operator $P$ (taken with respect to the observation point’s normal $\\partial/\\partial n_{\\mathbf{x}}$) have kernels\n$$K_D(\\mathbf{x},\\mathbf{y};k) = \\frac{\\partial G(\\mathbf{x},\\mathbf{y};k)}{\\partial n_{\\mathbf{y}}} = -\\frac{i k}{4}\\,H_1^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big)\\,\\frac{(\\mathbf{y}-\\mathbf{x})\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y})}{\\|\\mathbf{x}-\\mathbf{y}\\|},$$\n$$K_P(\\mathbf{x},\\mathbf{y};k) = \\frac{\\partial G(\\mathbf{x},\\mathbf{y};k)}{\\partial n_{\\mathbf{x}}} = -\\frac{i k}{4}\\,H_1^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big)\\,\\frac{(\\mathbf{x}-\\mathbf{y})\\cdot \\mathbf{n}_\\Gamma(\\mathbf{x})}{\\|\\mathbf{x}-\\mathbf{y}\\|},$$\nwhere $H_1^{(1)}$ is the first-order Hankel function of the first kind, and all angles are in radians. For a smooth boundary, the direct boundary integral equation for sound-soft (Dirichlet) scattering uses the operator $(\\tfrac{1}{2}I + D)$ acting on an unknown density function; the Burton-Miller formulation combines the direct boundary integral equation with its normal derivative to remove non-uniqueness at interior resonant wavenumbers. The Combined Helmholtz Integral Equation Formulation (CHIEF) adds homogeneous interior field constraints at a set of interior collocation points to stabilize the system at these resonant wavenumbers.\n\nTask: Using the unit circle geometry, discretize the boundary using $N$ equispaced collocation points with trapezoidal-rule weights $w = 2\\pi R / N$, and form three matrices:\n- the direct boundary operator\n$$A(k) = \\tfrac{1}{2}I + D(k),$$\n- the Burton-Miller-style combined operator\n$$A_{\\mathrm{BM}}(k,\\alpha) = \\tfrac{1}{2}I + D(k) + i \\alpha\\,P(k),$$\nwith $\\alpha$ a dimensionless coupling parameter,\n- the CHIEF-augmented operator\n$$A_{\\mathrm{aug}}(k) = \\begin{bmatrix} \\tfrac{1}{2}I + D(k) \\\\ C_{\\mathrm{int}}(k) \\end{bmatrix},$$\nwhere the interior constraint block $C_{\\mathrm{int}}(k)$ evaluates the double-layer potential at $Q$ interior points $\\mathbf{x}_c^\\ell$ (with no jump term on the interior) so that the homogeneous scattered field vanishes at those interior collocation points. In all three matrices, approximate the boundary integrals by the trapezoidal rule, using only off-diagonal kernel evaluations and assigning the diagonal entries of $D(k)$ and $P(k)$ to $0$ while maintaining the $\\tfrac{1}{2}I$ jump term in $A(k)$ and $A_{\\mathrm{BM}}(k,\\alpha)$ as written.\n\nPart (a): Compute the first few interior Dirichlet eigenfrequencies for the unit disk, understood as the smallest positive wavenumbers $k$ (in $1/\\mathrm{m}$) at which there exist nontrivial solutions to the homogeneous interior Helmholtz boundary value problem with $p|_{\\Gamma} = 0$. Use separation of variables and the fact that these wavenumbers occur at the positive zeros of the Bessel functions of the first kind $J_m(kr)$ for integer azimuthal order $m \\in \\mathbb{Z}_{\\ge 0}$. Report the first $5$ smallest such wavenumbers computed from orders $m = 0,1,2$ with up to $2$ zeros per order, sorted ascending. Express all wavenumbers in $1/\\mathrm{m}$.\n\nPart (b): Using the discretization described above with $R = 1\\,\\mathrm{m}$, $N = 64$, $\\alpha = 1$, and $Q = 4$ interior points placed at radius $0.5\\,\\mathrm{m}$ with equispaced angles, compute the $2$-norm condition number $\\kappa_2$ of the square matrices $A(k)$ and $A_{\\mathrm{BM}}(k,\\alpha)$, and the pseudo-condition number of the rectangular matrix $A_{\\mathrm{aug}}(k)$ defined as the ratio of the largest to smallest singular values of $A_{\\mathrm{aug}}(k)$, at the following wavenumbers (all in $1/\\mathrm{m}$):\n- a general case $k = 2.0$,\n- a near-resonant case $k = k_1 - 0.01$, where $k_1$ is the smallest wavenumber obtained in Part (a),\n- an exactly resonant case $k = k_1$.\n\nUse radians for all angle computations. For each case, return three floats: $\\kappa_2\\!\\big(A(k)\\big)$, $\\kappa_2\\!\\big(A_{\\mathrm{BM}}(k,\\alpha)\\big)$, and the pseudo-condition number of $A_{\\mathrm{aug}}(k)$.\n\nTest Suite and Final Output Format:\n- Compute the list of the first $5$ interior wavenumbers from Part (a) as the first output item.\n- Compute the three condition numbers for each of the three specified wavenumbers in Part (b).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, structured as\n[eigs, [cd_1, cbm_1, caug_1], [cd_2, cbm_2, caug_2], [cd_3, cbm_3, caug_3]],\nwhere $\\text{eigs}$ is the list of $5$ floats (in $1/\\mathrm{m}$) for Part (a), and for each $j \\in \\{1,2,3\\}$, $\\text{cd}_j$ is $\\kappa_2\\!\\big(A(k_j)\\big)$, $\\text{cbm}_j$ is $\\kappa_2\\!\\big(A_{\\mathrm{BM}}(k_j,\\alpha)\\big)$, and $\\text{caug}_j$ is the pseudo-condition number of $A_{\\mathrm{aug}}(k_j)$, all reported as floats.",
            "solution": "The user-provided problem is assessed as valid. It is scientifically grounded in the principles of computational acoustics, specifically the boundary integral equation (BIE) method for the Helmholtz equation. The problem is well-posed, with all necessary parameters and definitions provided, and contains no internal contradictions or factual errors. The task is to analyze the numerical stability of three different BIE formulations for acoustic scattering from a circular obstacle, particularly in the context of interior resonance phenomena.\n\nThe solution proceeds in two parts as specified. Part (a) identifies the resonant wavenumbers (interior Dirichlet eigenfrequencies) for the unit disk. Part (b) involves the numerical implementation and analysis of the condition numbers of matrices corresponding to the direct BIE formulation, the Burton-Miller formulation, and the CHIEF method at resonant and non-resonant wavenumbers.\n\n### Part (a): Interior Dirichlet Eigenfrequencies\n\nThe interior Dirichlet problem for the Helmholtz equation, $\\nabla^2 p + k^2 p = 0$, within a disk of radius $R$ subject to the boundary condition $p=0$ on its boundary $\\Gamma$, is a classical eigenvalue problem. The solutions (eigenfunctions) can be found using separation of variables in polar coordinates $(r, \\theta)$. Solutions that are finite at the origin ($r=0$) are of the form\n$$p(r, \\theta) = \\sum_{m=0}^{\\infty} J_m(kr) (A_m \\cos(m\\theta) + B_m \\sin(m\\theta)),$$\nwhere $J_m$ is the Bessel function of the first kind of integer order $m$. The boundary condition $p(R, \\theta) = 0$ for all $\\theta$ imposes the constraint that $J_m(kR) = 0$ for each azimuthal mode $m$.\n\nFor the given unit disk geometry, $R=1\\,\\mathrm{m}$, the condition simplifies to $J_m(k)=0$. The interior resonant wavenumbers $k$ are therefore the positive zeros of the Bessel functions of the first kind, $J_m(x)$, for non-negative integer orders $m$. We are asked to find the first $5$ smallest such wavenumbers, considering orders $m=0, 1, 2$.\n\nLet $z_{m,n}$ denote the $n$-th positive zero of $J_m(x)$. We compute the first two zeros for $m=0, 1, 2$:\n- Zeros of $J_0(x)$: $z_{0,1} \\approx 2.4048$, $z_{0,2} \\approx 5.5201$\n- Zeros of $J_1(x)$: $z_{1,1} \\approx 3.8317$, $z_{1,2} \\approx 7.0156$\n- Zeros of $J_2(x)$: $z_{2,1} \\approx 5.1356$, $z_{2,2} \\approx 8.4172$\n\nCollecting these six values and sorting them in ascending order yields the sequence:\n$2.4048\\dots, 3.8317\\dots, 5.1356\\dots, 5.5201\\dots, 7.0156\\dots, 8.4172\\dots$.\nThe first $5$ smallest resonant wavenumbers (in $1/\\mathrm{m}$) are approximately $2.4048$, $3.8317$, $5.1356$, $5.5201$, and $7.0156$. The smallest of these, which we denote $k_1$, is $k_1 = z_{0,1} \\approx 2.4048\\,\\mathrm{m}^{-1}$.\n\n### Part (b): Matrix Discretization and Condition Number Analysis\n\nWe discretize the circular boundary $\\Gamma$ using $N=64$ equispaced collocation points $\\mathbf{y}_j$ for $j=0, \\dots, N-1$. A point $\\mathbf{y}_j$ is given by $\\mathbf{y}_j = (R\\cos\\theta_j, R\\sin\\theta_j)$ with $R=1\\,\\mathrm{m}$ and $\\theta_j = 2\\pi j/N$. The outward unit normal at $\\mathbf{y}_j$ is $\\mathbf{n}_\\Gamma(\\mathbf{y}_j) = (\\cos\\theta_j, \\sin\\theta_j)$. Boundary integrals are approximated using the trapezoidal rule with uniform weight $w = 2\\pi R / N = \\pi/32$.\n\nThe integral operators are discretized into $N \\times N$ matrices. For an operator with kernel $K(\\mathbf{x}, \\mathbf{y})$, the Nyström discretization leads to matrix entries $K_{ij} = w \\cdot K(\\mathbf{y}_i, \\mathbf{y}_j)$ for off-diagonal elements ($i \\ne j$). As specified, the diagonal entries of the integral operator matrices $D(k)$ and $P(k)$ are set to $0$.\n\n**1. The $D(k)$ and $P(k)$ Operators**\nThe matrices $D(k)$ and $P(k)$ have entries given by $D_{ij} = w \\cdot K_D(\\mathbf{y}_i, \\mathbf{y}_j; k)$ and $P_{ij} = w \\cdot K_P(\\mathbf{y}_i, \\mathbf{y}_j; k)$ for $i \\ne j$. For the specific case of a circle, the kernels $K_D$ and $K_P$ are identical when both points $\\mathbf{x}=\\mathbf{y}_i$ and $\\mathbf{y}=\\mathbf{y}_j$ lie on the boundary. This is because $(\\mathbf{y}_j-\\mathbf{y}_i)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j) = (\\mathbf{y}_i-\\mathbf{y}_j)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_i) = R(1 - \\cos(\\theta_j-\\theta_i))$. Therefore, the matrices are equal: $D(k) = P(k)$. We denote this common matrix as $K_{\\mathrm{mat}}(k)$. Its entries for $i \\neq j$ are:\n$$(K_{\\mathrm{mat}})_{ij} = w \\cdot \\left( -\\frac{i k}{4} H_1^{(1)}\\!\\big(k \\|\\mathbf{y}_i-\\mathbf{y}_j\\|\\big)\\,\\frac{(\\mathbf{y}_j-\\mathbf{y}_i)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j)}{\\|\\mathbf{y}_i-\\mathbf{y}_j\\|} \\right),$$\nwith $(K_{\\mathrm{mat}})_{ii} = 0$.\n\n**2. The $A(k)$ and $A_{\\mathrm{BM}}(k,\\alpha)$ Matrices**\nThe matrices for the direct and Burton-Miller formulations are constructed as:\n- $A(k) = \\frac{1}{2}I + D(k) = \\frac{1}{2}I_N + K_{\\mathrm{mat}}(k)$\n- $A_{\\mathrm{BM}}(k,\\alpha) = \\frac{1}{2}I + D(k) + i \\alpha P(k) = \\frac{1}{2}I_N + (1+i\\alpha)K_{\\mathrm{mat}}(k)$\nWith $\\alpha=1$, this becomes $A_{\\mathrm{BM}}(k,1) = \\frac{1}{2}I_N + (1+i)K_{\\mathrm{mat}}(k)$. These are both $N \\times N$ square matrices.\n\n**3. The CHIEF Matrix $A_{\\mathrm{aug}}(k)$**\nThe CHIEF method augments the direct formulation with $Q=4$ interior constraint equations. The interior points $\\mathbf{x}_c^\\ell$ for $\\ell=0, \\dots, Q-1$ are located at a radius of $r_c = 0.5\\,\\mathrm{m}$ with equispaced angles $\\phi_\\ell = 2\\pi \\ell / Q$. The constraint equations require the scattered field (represented by a double-layer potential) to be zero at these points. This gives rise to a $Q \\times N$ constraint matrix $C_{\\mathrm{int}}(k)$ with entries:\n$$(C_{\\mathrm{int}})_{\\ell j} = w \\cdot K_D(\\mathbf{x}_c^\\ell, \\mathbf{y}_j; k) = w \\cdot \\left( -\\frac{i k}{4} H_1^{(1)}\\!\\big(k \\|\\mathbf{x}_c^\\ell-\\mathbf{y}_j\\|\\big)\\,\\frac{(\\mathbf{y}_j-\\mathbf{x}_c^\\ell)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j)}{\\|\\mathbf{x}_c^\\ell-\\mathbf{y}_j\\|} \\right).$$\nThe augmented matrix is an $(N+Q) \\times N$ rectangular matrix, formed by stacking $A(k)$ and $C_{\\mathrm{int}}(k)$:\n$$A_{\\mathrm{aug}}(k) = \\begin{bmatrix} A(k) \\\\ C_{\\mathrm{int}}(k) \\end{bmatrix}.$$\n\n**4. Condition Number Calculation**\nWe compute the condition numbers at three wavenumbers: a non-resonant case $k=2.0\\,\\mathrm{m}^{-1}$, a near-resonant case $k=k_1-0.01$, and the exact resonant case $k=k_1$.\nFor the square matrices $A(k)$ and $A_{\\mathrm{BM}}(k,1)$, the $2$-norm condition number is $\\kappa_2(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$, where $\\sigma$ are the singular values of $M$. For the rectangular matrix $A_{\\mathrm{aug}}(k)$, the pseudo-condition number is defined identically as the ratio of its largest to its smallest singular value.\nAt the resonant wavenumber $k=k_1$, the operator $\\frac{1}{2}I+D(k)$ has a non-trivial null space, which manifests as an extremely large condition number for its discretization $A(k)$. Both the Burton-Miller and CHIEF formulations are designed to remedy this by creating systems that are well-conditioned at all wavenumbers. The computations will verify this behavior.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jn_zeros, hankel1\n\ndef compute_condition_numbers(k, R, N, alpha, Q, r_c):\n    \"\"\"\n    Computes the condition numbers for the three BEM matrices for a given wavenumber k.\n    \"\"\"\n    # 1. Geometry and Discretization Setup\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    y_boundary = R * np.array([np.cos(theta), np.sin(theta)]).T  # Shape (N, 2)\n    normals_boundary = y_boundary / R  # Shape (N, 2)\n    weight = 2 * np.pi * R / N\n\n    # 2. Assemble K_mat for D(k) and P(k) operators\n    # For a circle, D(k) = P(k)\n    K_mat = np.zeros((N, N), dtype=np.complex128)\n    for i in range(N):\n        for j in range(N):\n            if i == j:\n                continue\n            \n            yi = y_boundary[i, :]\n            yj = y_boundary[j, :]\n            normal_j = normals_boundary[j, :]\n            \n            vec_ji = yj - yi\n            dist = np.linalg.norm(vec_ji)\n            \n            # Kernel for double-layer potential\n            dot_prod = np.dot(vec_ji, normal_j)\n            hankel_val = hankel1(1, k * dist)\n            kernel_val = -1j * k / 4.0 * hankel_val * (dot_prod / dist)\n            \n            K_mat[i, j] = weight * kernel_val\n\n    # 3. Construct A(k) and A_BM(k, alpha)\n    I_N = np.eye(N)\n    A = 0.5 * I_N + K_mat\n    A_BM = 0.5 * I_N + (1.0 + 1j * alpha) * K_mat\n\n    # 4. Assemble CHIEF constraint matrix C_int(k)\n    C_int = np.zeros((Q, N), dtype=np.complex128)\n    phi = np.linspace(0, 2 * np.pi, Q, endpoint=False)\n    x_interior = r_c * np.array([np.cos(phi), np.sin(phi)]).T  # Shape (Q, 2)\n\n    for l in range(Q):\n        for j in range(N):\n            xl = x_interior[l, :]\n            yj = y_boundary[j, :]\n            normal_j = normals_boundary[j, :]\n\n            vec_jl = yj - xl\n            dist = np.linalg.norm(vec_jl)\n            \n            dot_prod = np.dot(vec_jl, normal_j)\n            hankel_val = hankel1(1, k * dist)\n            kernel_val = -1j * k / 4.0 * hankel_val * (dot_prod / dist)\n\n            C_int[l, j] = weight * kernel_val\n\n    # 5. Construct augmented matrix A_aug(k)\n    A_aug = np.vstack([A, C_int])\n\n    # 6. Compute condition numbers\n    cond_A = np.linalg.cond(A)\n    cond_ABM = np.linalg.cond(A_BM)\n    cond_Aaug = np.linalg.cond(A_aug)\n    \n    return [cond_A, cond_ABM, cond_Aaug]\n\n\ndef solve():\n    # Part (a): Compute interior Dirichlet eigenfrequencies\n    # Get first 2 positive zeros for J_0, J_1, J_2\n    zeros_j0 = jn_zeros(0, 2)\n    zeros_j1 = jn_zeros(1, 2)\n    zeros_j2 = jn_zeros(2, 2)\n    \n    # Combine, sort, and take the first 5\n    all_zeros = np.concatenate([zeros_j0, zeros_j1, zeros_j2])\n    eigs = sorted(all_zeros)[:5]\n    \n    k1 = eigs[0] # Smallest resonant wavenumber\n\n    # Part (b): Compute condition numbers\n    \n    # Define parameters\n    R = 1.0\n    N = 64\n    alpha = 1.0\n    Q = 4\n    r_c = 0.5\n\n    # Define wavenumbers for testing\n    k_values = [\n        2.0,           # General case\n        k1 - 0.01,     # Near-resonant case\n        k1             # Exactly resonant case\n    ]\n    \n    results_part_b = []\n    for k_val in k_values:\n        conds = compute_condition_numbers(k_val, R, N, alpha, Q, r_c)\n        results_part_b.append(conds)\n\n    # Format the final output as a single string\n    # The structure is [[eigs], [conds_k1], [conds_k2], [conds_k3]]\n    # where Python's str() on a list gives the '[...]' format.\n    final_results = [eigs] + results_part_b\n    output_str = \",\".join(map(str, final_results))\n    \n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        }
    ]
}