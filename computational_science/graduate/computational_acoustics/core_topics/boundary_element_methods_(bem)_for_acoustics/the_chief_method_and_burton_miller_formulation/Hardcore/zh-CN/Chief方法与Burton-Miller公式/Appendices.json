{
    "hands_on_practices": [
        {
            "introduction": "在深入研究解决唯一性问题的数值方法之前，首先理解这个问题的根源至关重要。本练习通过一个经典的球体散射问题，采用分离变量法进行求解。这种解析方法不仅能为我们提供一个精确的基准解，更重要的是，它揭示了导致边界积分方程失效的波数，恰好对应于散射体内部的共振频率，从而让我们从根本上理解“伪频”的物理本质。",
            "id": "4139725",
            "problem": "考虑在均匀无粘性流体中，一个声软球体对平面波的时谐声散射。设总声压场 $p(\\mathbf{x})$ 在半径为 $a$ 的球体外部满足亥姆霍兹方程 $\\nabla^{2} p + k^{2} p = 0$，同时满足狄利克雷边界条件 $p|_{r=a} = 0$ 和无穷远处的索末菲辐射条件。假设时间依赖关系为 $\\exp(-\\mathrm{i} \\omega t)$，因此 $k = \\omega / c$，其中 $c$ 是声速。一个单位振幅的平面波沿 $z$ 轴入射，其表达式为 $p^{\\mathrm{i}}(\\mathbf{x}) = \\exp(\\mathrm{i} k z)$。\n\n从亥姆霍兹方程和球坐标下的变量分离表示法出发，推导远场散射振幅 $f(\\theta)$，使得在远场中，当 $r \\to \\infty$ 时，$p^{\\mathrm{s}}(r,\\theta) \\sim \\frac{\\exp(\\mathrm{i} k r)}{r} f(\\theta)$，其中 $p^{\\mathrm{s}}$ 是散射场，$\\theta$ 是极角。此外，请确定外狄利克雷问题的内部共振发生的频率，即在这些频率下，常规边界积分方程存在非唯一解；并将此确定过程与模态变量分离分析联系起来。\n\n最后，对于一个在水中半径为 $a = 0.50$ 米的球体，声速 $c = 1.50 \\times 10^{3}$ 米/秒，计算与 $l=0$ 模态相关的最低正内部共振角频率 $\\omega_{1}$（单位为弧度/秒）。将您的数值结果四舍五入到四位有效数字，并以弧度/秒为单位表示角频率。您可以假设以下经过充分验证的事实：平面波的球谐函数展开式以及球汉克尔函数的远场渐近行为。在您的推导中，首次出现时请明确定义组合亥姆霍兹积分方程公式（CHIEF）和 Burton-Miller 组合场积分方程（Burton-Miller），并从概念层面解释每种方法如何在不改变通过变量分离法推导出的物理散射振幅的情况下，消除由内部共振引起的伪非唯一性。\n\n您的最终答案必须包含两个部分，以单行矩阵的形式呈现：$f(\\theta)$ 的闭式级数表达式，以及 $\\omega_{1}$ 的计算值。",
            "solution": "问题陈述具有科学依据、良态、客观且自洽。它代表了声散射理论中的一个标准问题，因此是有效的。\n\n总声压场 $p(\\mathbf{x})$ 是入射平面波 $p^{\\mathrm{i}}(\\mathbf{x})$ 和散射场 $p^{\\mathrm{s}}(\\mathbf{x})$ 的和，即 $p(\\mathbf{x}) = p^{\\mathrm{i}}(\\mathbf{x}) + p^{\\mathrm{s}}(\\mathbf{x})$。$p$ 和 $p^{\\mathrm{i}}$ 都满足亥姆霍兹方程 $\\nabla^{2} \\phi + k^{2} \\phi = 0$，因此散射场 $p^{\\mathrm{s}}$ 也必须满足该方程。\n\n沿 $z$ 轴传播的入射平面波由 $p^{\\mathrm{i}}(\\mathbf{x}) = \\exp(\\mathrm{i}kz) = \\exp(\\mathrm{i}kr\\cos\\theta)$ 给出。其用勒让德多项式 $P_l(\\cos\\theta)$ 和第一类球贝塞尔函数 $j_l(kr)$ 的展开式为：\n$$ p^{\\mathrm{i}}(r, \\theta) = \\sum_{l=0}^{\\infty} \\mathrm{i}^l (2l+1) j_l(kr) P_l(\\cos\\theta) $$\n由于入射波和球形散射体的方位对称性，散射场 $p^{\\mathrm{s}}$ 也将与方位角 $\\phi$ 无关。我们可以将 $p^{\\mathrm{s}}$ 表示为一个分波级数。为了满足索末菲辐射条件，即散射波在无穷远处必须是纯粹的出射波，我们使用第一类球汉克尔函数 $h_l^{(1)}(kr)$：\n$$ p^{\\mathrm{s}}(r, \\theta) = \\sum_{l=0}^{\\infty} A_l h_l^{(1)}(kr) P_l(\\cos\\theta) $$\n系数 $A_l$ 由球体表面的边界条件确定。对于半径为 $a$ 的声软球体，边界上的总压力为零：$p(a, \\theta) = 0$。这意味着 $p^{\\mathrm{s}}(a, \\theta) = -p^{\\mathrm{i}}(a, \\theta)$。\n将级数展开式代入边界条件，得到：\n$$ \\sum_{l=0}^{\\infty} A_l h_l^{(1)}(ka) P_l(\\cos\\theta) = - \\sum_{l=0}^{\\infty} \\mathrm{i}^l (2l+1) j_l(ka) P_l(\\cos\\theta) $$\n根据勒让德多项式的正交性，我们可以令每个模态 $l$ 的系数相等：\n$$ A_l h_l^{(1)}(ka) = - \\mathrm{i}^l (2l+1) j_l(ka) $$\n求解未知系数 $A_l$：\n$$ A_l = - (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} $$\n因此，散射场为：\n$$ p^{\\mathrm{s}}(r, \\theta) = - \\sum_{l=0}^{\\infty} (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} h_l^{(1)}(kr) P_l(\\cos\\theta) $$\n为了找到远场散射振幅 $f(\\theta)$，我们考察 $p^{\\mathrm{s}}$ 在 $r \\to \\infty$ 时的渐近行为。球汉克尔函数具有以下渐近形式：\n$$ h_l^{(1)}(kr) \\sim \\frac{1}{kr} \\exp\\left(\\mathrm{i}\\left(kr - \\frac{(l+1)\\pi}{2}\\right)\\right) = \\frac{(-\\mathrm{i})^{l+1}}{kr} \\exp(\\mathrm{i}kr) $$\n将此代入 $p^{\\mathrm{s}}$ 的表达式中：\n$$ p^{\\mathrm{s}}(r, \\theta) \\sim \\sum_{l=0}^{\\infty} A_l P_l(\\cos\\theta) \\frac{(-\\mathrm{i})^{l+1}}{kr} \\exp(\\mathrm{i}kr) = \\frac{\\exp(\\mathrm{i}kr)}{r} \\left( \\frac{1}{k} \\sum_{l=0}^{\\infty} A_l (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) \\right) $$\n通过与定义 $p^{\\mathrm{s}}(r,\\theta) \\sim \\frac{\\exp(\\mathrm{i}kr)}{r} f(\\theta)$ 进行比较，我们确定散射振幅为：\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} A_l (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) $$\n代入 $A_l$ 的表达式：\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} \\left( - (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} \\right) (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) $$\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} [- \\mathrm{i}^l (-\\mathrm{i})^{l+1}] P_l(\\cos\\theta) $$\n方括号中的项简化为：$- \\mathrm{i}^l (-1)^{l+1} \\mathrm{i}^{l+1} = (-1)^{l+2} \\mathrm{i}^{2l+1} = (-1)^l (-1)^l \\mathrm{i} = \\mathrm{i}$。\n因此，远场散射振幅为：\n$$ f(\\theta) = \\frac{\\mathrm{i}}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} P_l(\\cos\\theta) $$\n\n在使用边界积分方程（BIE）方法解决此散射问题时，会出现内部共振问题。对于外狄利克雷问题（如声软散射体），一种常见方法是对表面上压力的未知法向导数使用直接 BIE 公式。这会导出一个形式为 $S\\phi = g$ 的积分方程，其中 $S$ 是单层势算子。在某些特征频率下，该公式会失效，导致非唯一解。这些频率对应于相关*内部*问题的特征值。对于外狄利克雷问题，相关的内部问题是亥姆霍茲方程的内狄利克雷问题：在边界所包围的体积内 $\\nabla^2 u + k^2 u = 0$，且在边界上 $u=0$。\n这与模态变量分离分析的联系是直接的。球体内狄利克雷问题的非平凡解（特征函数）仅在特定的波数 $k$ 下存在。对内部问题使用变量分离法，原点处正则的解的形式为 $u(r,\\theta,\\phi) = \\sum_{l,m} C_{lm} j_l(kr) Y_l^m(\\theta,\\phi)$。边界条件 $u(a,\\theta,\\phi)=0$ 要求对于某个非负整数 $l$，$j_l(ka)=0$。满足此条件的任何 $l$ 的波数 $k$ 都是共振波数。在这些波数下，积分算子 $S$ 具有非平凡的零空间，BIE 是不适定的。\n\n为了克服这种非唯一性，已经开发了几种方法。\n**组合亥姆霍茲积分方程公式（CHIEF）**是一种通过在散射体内部选择若干点，并强制散射场的积分表示在这些点上为零的方法。对于内部域中的任何点 $\\mathbf{x}_{\\text{int}}$，外部散射场 $p^{\\mathrm{s}}$ 的亥姆霍兹积分表示为零。将这些额外的约束方程附加到原始的离散化表面 BIE 上，形成一个超定线性方程组。然后通常以最小二乘法求解该系统。与内部共振相关的伪解通常不满足这些额外的内部约束（除非 CHIEF 点恰好位于内部特征模态的节面上），从而确保找到唯一解。\n\n**Burton-Miller 组合场积分方程**通过构建标准表面亥姆霍茲积分方程及其法向导数的线性组合来对问题进行正则化。得到的组合方程形式为 $\\mathcal{A} + \\alpha \\mathcal{B} = g$，其中 $\\mathcal{A}$ 是原始的不适定方程，$\\mathcal{B}$ 是其法向导数，$\\alpha$ 是一个复耦合参数。外狄利克雷问题的一种常见公式是组合单层算子和超奇异算子，$(S + \\alpha N) v = g_{\\text{new}}$，其中 $v$ 是未知的法向导数，$N$ 是超奇异算子。可以证明，如果 $\\alpha$ 的虚部非零（一个常见的选择是 $\\alpha = \\mathrm{i}/k$），则对于所有实数正波数 $k$，组合算子都是可逆的。这能稳健地消除所有几何形状和频率下的非唯一性问题，不像 CHIEF 方法，如果内部点选择不当可能会失败。\n\n最后，我们计算 $l=0$ 模态的最低正内部共振角频率 $\\omega_{1}$。这对应于使 $j_0(k_1a)=0$ 的最低正波数 $k_1$。\n0 阶球贝塞尔函数是 $j_0(x) = \\frac{\\sin(x)}{x}$。\n条件 $j_0(k_1a) = 0$ 要求 $\\frac{\\sin(k_1a)}{k_1a} = 0$。因为我们寻找的是正频率，$k_1 a > 0$，所以必须有 $\\sin(k_1a)=0$。\n该参数的最小正解是 $k_1 a = \\pi$。\n波数 $k$ 与角频率 $\\omega$ 的关系是 $k = \\omega/c$。因此，$k_1 = \\omega_1/c$。\n将此代入我们的条件中：\n$$ \\frac{\\omega_1 a}{c} = \\pi $$\n求解 $\\omega_1$：\n$$ \\omega_1 = \\frac{\\pi c}{a} $$\n问题给出的值为 $a = 0.50$ 米 和 $c = 1.50 \\times 10^3$ 米/秒。\n$$ \\omega_1 = \\frac{\\pi (1.50 \\times 10^3 \\text{ m/s})}{0.50 \\text{ m}} = \\pi \\times 3.0 \\times 10^3 \\text{ rad/s} $$\n数值上，这是 $\\omega_1 \\approx 9424.777...$ rad/s。\n四舍五入到四位有效数字，我们得到 $\\omega_1 = 9425$ rad/s，或者用科学记数法表示为 $9.425 \\times 10^3$ rad/s。",
            "answer": "$$\n\\boxed{\n\\pmatrix{\n\\frac{\\mathrm{i}}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} P_l(\\cos\\theta)  & 9.425 \\times 10^{3}\n}\n}\n$$"
        },
        {
            "introduction": "在理论上理解了伪频的来源后，下一步是亲身感受它在数值计算中的具体影响。本练习是一个计算任务，要求您为一个二维圆形障碍物离散化边界积分算子。通过在共振频率附近计算不同积分方程方法（包括直接法、CHIEF 法和 Burton-Miller 法）对应矩阵的条件数，您将能直观地观察到标准方法的失效以及改进方法的有效性，从而将抽象的“病态”概念变得具体可感。",
            "id": "4139731",
            "problem": "考虑二维空间中的时谐声散射，其由总声压场 $p(\\mathbf{x})$ 的亥姆霍兹方程控制：\n$$\\nabla^2 p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = 0,$$\n其中 $k$ 是声波数，单位为 $1/\\mathrm{m}$。几何形状是平面上的单位半径圆，即集合 $\\Gamma = \\{\\mathbf{x} \\in \\mathbb{R}^2 : \\|\\mathbf{x}\\| = R\\}$，其中 $R = 1\\,\\mathrm{m}$，在边界点 $\\mathbf{y} \\in \\Gamma$ 处的向外单位法向量为 $\\mathbf{n}_\\Gamma(\\mathbf{y})$。二维亥姆霍兹算子的基本解（格林函数）为\n$$G(\\mathbf{x},\\mathbf{y};k) = \\frac{i}{4} H_0^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big),$$\n其中 $H_0^{(1)}$ 是零阶第一类汉克尔函数。经典双层势算子 $D$ 和单层势算子 $P$ 的法向导数（相对于观察点的法线 $\\partial/\\partial n_{\\mathbf{x}}$）的核函数为\n$$K_D(\\mathbf{x},\\mathbf{y};k) = \\frac{\\partial G(\\mathbf{x},\\mathbf{y};k)}{\\partial n_{\\mathbf{y}}} = -\\frac{i k}{4}\\,H_1^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big)\\,\\frac{(\\mathbf{y}-\\mathbf{x})\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y})}{\\|\\mathbf{x}-\\mathbf{y}\\|},$$\n$$K_P(\\mathbf{x},\\mathbf{y};k) = \\frac{\\partial G(\\mathbf{x},\\mathbf{y};k)}{\\partial n_{\\mathbf{x}}} = -\\frac{i k}{4}\\,H_1^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big)\\,\\frac{(\\mathbf{x}-\\mathbf{y})\\cdot \\mathbf{n}_\\Gamma(\\mathbf{x})}{\\|\\mathbf{x}-\\mathbf{y}\\|},$$\n其中 $H_1^{(1)}$ 是一阶第一类汉克尔函数，所有角度均以弧度为单位。对于光滑边界，用于软声（狄利克雷）散射的直接边界积分方程使用作用于未知密度函数上的算子 $(\\tfrac{1}{2}I + D)$；Burton-Miller 方程将其直接边界积分方程与其法向导数相结合，以消除内部共振波数处的非唯一性问题。组合亥姆霍兹积分方程公式 (CHIEF) 在一组内部配置点上增加齐次内部场约束，以在这些共振波数处稳定系统。\n\n任务：使用单位圆几何，通过 $N$ 个等距配置点和梯形法则权重 $w = 2\\pi R / N$ 来离散化边界，并构建三个矩阵：\n- 直接边界算子\n$$A(k) = \\tfrac{1}{2}I + D(k),$$\n- Burton-Miller 型组合算子\n$$A_{\\mathrm{BM}}(k,\\alpha) = \\tfrac{1}{2}I + D(k) + i \\alpha\\,P(k),$$\n其中 $\\alpha$ 是一个无量纲耦合参数，\n- CHIEF 增广算子\n$$A_{\\mathrm{aug}}(k) = \\begin{bmatrix} \\tfrac{1}{2}I + D(k) \\\\ C_{\\mathrm{int}}(k) \\end{bmatrix},$$\n其中内部约束块 $C_{\\mathrm{int}}(k)$ 在 $Q$ 个内部点 $\\mathbf{x}_c^\\ell$ 处计算双层势（内部无跳跃项），从而使齐次散射场在这些内部配置点处为零。在所有三个矩阵中，使用梯形法则近似边界积分，仅使用非对角核函数求值，并将 $D(k)$ 和 $P(k)$ 的对角线元素设为 $0$，同时按书写形式保留 $A(k)$ 和 $A_{\\mathrm{BM}}(k,\\alpha)$ 中的 $\\tfrac{1}{2}I$ 跳跃项。\n\n部分 (a)：计算单位圆盘的前几个内部狄利克雷特征频率，理解为存在齐次内部亥姆霍兹边值问题（其中 $p|_{\\Gamma} = 0$）的非平凡解的最小正波数 $k$（单位为 $1/\\mathrm{m}$）。使用分离变量法以及以下事实：这些波数出现在整数方位角阶数 $m \\in \\mathbb{Z}_{\\ge 0}$ 的第一类贝塞尔函数 $J_m(kr)$ 的正零点处。报告从阶数 $m = 0,1,2$ 计算出的前 5 个最小的此类波数，每阶最多取 2 个零点，并按升序排序。所有波数均以 $1/\\mathrm{m}$ 为单位表示。\n\n部分 (b)：使用上述离散化方法，其中 $R = 1\\,\\mathrm{m}$，$N = 64$，$\\alpha = 1$，以及在半径 $0.5\\,\\mathrm{m}$ 处以等距角度放置的 $Q = 4$ 个内部点，计算方形矩阵 $A(k)$ 和 $A_{\\mathrm{BM}}(k,\\alpha)$ 的 $2$-范数条件数 $\\kappa_2$，以及矩形矩阵 $A_{\\mathrm{aug}}(k)$ 的伪条件数（定义为 $A_{\\mathrm{aug}}(k)$ 的最大奇异值与最小奇异值之比），计算时使用以下波数（均以 $1/\\mathrm{m}$ 为单位）：\n- 一般情况 $k = 2.0$，\n- 近共振情况 $k = k_1 - 0.01$，其中 $k_1$ 是在部分 (a) 中获得的最小波数，\n- 精确共振情况 $k = k_1$。\n\n所有角度计算均使用弧度。对于每种情况，返回三个浮点数：$\\kappa_2\\!\\big(A(k)\\big)$、$\\kappa_2\\!\\big(A_{\\mathrm{BM}}(k,\\alpha)\\big)$ 和 $A_{\\mathrm{aug}}(k)$ 的伪条件数。\n\n测试套件和最终输出格式：\n- 将部分 (a) 的前 5 个内部波数列表作为第一个输出项进行计算。\n- 为部分 (b) 中指定的三个波数中的每一个计算三个条件数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结构如下\n$$\\text{[eigs, [cd_1, cbm_1, caug_1], [cd_2, cbm_2, caug_2], [cd_3, cbm_3, caug_3]]},$$\n其中 $\\text{eigs}$ 是部分 (a) 的 5 个浮点数列表（单位为 $1/\\mathrm{m}$），对于每个 $j \\in \\{1,2,3\\}$，$\\text{cd}_j$ 是 $\\kappa_2\\!\\big(A(k_j)\\big)$，$\\text{cbm}_j$ 是 $\\kappa_2\\!\\big(A_{\\mathrm{BM}}(k_j,\\alpha)\\big)$，$\\text{caug}_j$ 是 $A_{\\mathrm{aug}}(k_j)$ 的伪条件数，所有值均以浮点数形式报告。",
            "solution": "用户提供的问题被评估为有效。它在科学上基于计算声学原理，特别是亥姆霍兹方程的边界积分方程 (BIE) 方法。该问题是适定的，提供了所有必要的参数和定义，并且不包含内部矛盾或事实错误。任务是分析三种不同 BIE 公式在圆形障碍物声散射问题中的数值稳定性，特别是在内部共振现象的背景下。\n\n解决方案按规定分为两部分。部分 (a) 确定了单位圆盘的共振波数（内部狄利克雷特征频率）。部分 (b) 涉及在共振和非共振波数下，对直接 BIE 公式、Burton–Miller 方程和 CHIEF 方法对应的矩阵进行数值实现和条件数分析。\n\n### 部分 (a)：内部狄利克雷特征频率\n\n在半径为 $R$ 的圆盘内，受边界条件 $p=0$ 约束的亥姆霍兹方程 $\\nabla^2 p + k^2 p = 0$ 的内部狄利克雷问题是一个经典的特征值问题。其解（特征函数）可以通过在极坐标 $(r, \\theta)$ 中使用分离变量法找到。在原点 ($r=0$) 处有限的解具有以下形式：\n$$p(r, \\theta) = \\sum_{m=0}^{\\infty} J_m(kr) (A_m \\cos(m\\theta) + B_m \\sin(m\\theta)),$$\n其中 $J_m$ 是整数阶 $m$ 的第一类贝塞尔函数。对于所有 $\\theta$，边界条件 $p(R, \\theta) = 0$ 施加了约束，即对每个方位角模式 $m$，都有 $J_m(kR) = 0$。\n\n对于给定的单位圆盘几何，$R=1\\,\\mathrm{m}$，该条件简化为 $J_m(k)=0$。因此，内部共振波数 $k$ 是非负整数阶 $m$ 的第一类贝塞尔函数 $J_m(x)$ 的正零点。我们被要求找出前 5 个最小的此类波数，考虑阶数 $m=0, 1, 2$。\n\n令 $z_{m,n}$ 表示 $J_m(x)$ 的第 $n$ 个正零点。我们计算 $m=0, 1, 2$ 的前两个零点：\n- $J_0(x)$ 的零点：$z_{0,1} \\approx 2.4048$, $z_{0,2} \\approx 5.5201$\n- $J_1(x)$ 的零点：$z_{1,1} \\approx 3.8317$, $z_{1,2} \\approx 7.0156$\n- $J_2(x)$ 的零点：$z_{2,1} \\approx 5.1356$, $z_{2,2} \\approx 8.4172$\n\n收集这六个值并按升序排序，得到序列：\n$2.4048\\dots, 3.8317\\dots, 5.1356\\dots, 5.5201\\dots, 7.0156\\dots, 8.4172\\dots$。\n前 5 个最小的共振波数（单位为 $1/\\mathrm{m}$）大约是 $2.4048$、$3.8317$、$5.1356$、$5.5201$ 和 $7.0156$。其中最小的一个，我们记为 $k_1$，是 $k_1 = z_{0,1} \\approx 2.4048\\,\\mathrm{m}^{-1}$。\n\n### 部分 (b)：矩阵离散化与条件数分析\n\n我们使用 $N=64$ 个等距配置点 $\\mathbf{y}_j$（其中 $j=0, \\dots, N-1$）来离散化圆形边界 $\\Gamma$。点 $\\mathbf{y}_j$ 由 $\\mathbf{y}_j = (R\\cos\\theta_j, R\\sin\\theta_j)$ 给出，其中 $R=1\\,\\mathrm{m}$ 且 $\\theta_j = 2\\pi j/N$。在 $\\mathbf{y}_j$ 处的向外单位法向量是 $\\mathbf{n}_\\Gamma(\\mathbf{y}_j) = (\\cos\\theta_j, \\sin\\theta_j)$。边界积分使用梯形法则近似，权重统一为 $w = 2\\pi R / N = \\pi/32$。\n\n积分算子被离散化为 $N \\times N$ 的矩阵。对于一个核函数为 $K(\\mathbf{x}, \\mathbf{y})$ 的算子，Nyström 离散化方法得到的矩阵元素对于非对角元素（$i \\ne j$）为 $K_{ij} = w \\cdot K(\\mathbf{y}_i, \\mathbf{y}_j)$。按照规定，积分算子矩阵 $D(k)$ 和 $P(k)$ 的对角线元素设为 $0$。\n\n**1. $D(k)$ 和 $P(k)$ 算子**\n矩阵 $D(k)$ 和 $P(k)$ 的元素对于 $i \\ne j$ 分别由 $D_{ij} = w \\cdot K_D(\\mathbf{y}_i, \\mathbf{y}_j; k)$ 和 $P_{ij} = w \\cdot K_P(\\mathbf{y}_i, \\mathbf{y}_j; k)$ 给出。对于圆的特殊情况，当点 $\\mathbf{x}=\\mathbf{y}_i$ 和 $\\mathbf{y}=\\mathbf{y}_j$ 都位于边界上时，核函数 $K_D$ 和 $K_P$ 是相同的。这是因为 $(\\mathbf{y}_j-\\mathbf{y}_i)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j) = (\\mathbf{y}_i-\\mathbf{y}_j)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_i) = R(1 - \\cos(\\theta_j-\\theta_i))$。因此，这两个矩阵相等：$D(k) = P(k)$。我们将这个公共矩阵表示为 $K_{\\mathrm{mat}}(k)$。其对于 $i \\neq j$ 的元素为：\n$$(K_{\\mathrm{mat}})_{ij} = w \\cdot \\left( -\\frac{i k}{4} H_1^{(1)}\\!\\big(k \\|\\mathbf{y}_i-\\mathbf{y}_j\\|\\big)\\,\\frac{(\\mathbf{y}_j-\\mathbf{y}_i)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j)}{\\|\\mathbf{y}_i-\\mathbf{y}_j\\|} \\right),$$\n其中 $(K_{\\mathrm{mat}})_{ii} = 0$。\n\n**2. $A(k)$ 和 $A_{\\mathrm{BM}}(k,\\alpha)$ 矩阵**\n直接法和 Burton-Miller 方程的矩阵构造如下：\n- $A(k) = \\frac{1}{2}I + D(k) = \\frac{1}{2}I_N + K_{\\mathrm{mat}}(k)$\n- $A_{\\mathrm{BM}}(k,\\alpha) = \\frac{1}{2}I + D(k) + i \\alpha P(k) = \\frac{1}{2}I_N + (1+i\\alpha)K_{\\mathrm{mat}}(k)$\n当 $\\alpha=1$ 时，这变为 $A_{\\mathrm{BM}}(k,1) = \\frac{1}{2}I_N + (1+i)K_{\\mathrm{mat}}(k)$。这两个都是 $N \\times N$ 的方阵。\n\n**3. CHIEF 矩阵 $A_{\\mathrm{aug}}(k)$**\nCHIEF 方法通过 $Q=4$ 个内部约束方程来增强直接法。内部点 $\\mathbf{x}_c^\\ell$（其中 $\\ell=0, \\dots, Q-1$）位于半径为 $r_c = 0.5\\,\\mathrm{m}$ 的圆上，角度为等距的 $\\phi_\\ell = 2\\pi \\ell / Q$。约束方程要求散射场（由双层势表示）在这些点上为零。这产生了一个 $Q \\times N$ 的约束矩阵 $C_{\\mathrm{int}}(k)$，其元素为：\n$$(C_{\\mathrm{int}})_{\\ell j} = w \\cdot K_D(\\mathbf{x}_c^\\ell, \\mathbf{y}_j; k) = w \\cdot \\left( -\\frac{i k}{4} H_1^{(1)}\\!\\big(k \\|\\mathbf{x}_c^\\ell-\\mathbf{y}_j\\|\\big)\\,\\frac{(\\mathbf{y}_j-\\mathbf{x}_c^\\ell)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j)}{\\|\\mathbf{x}_c^\\ell-\\mathbf{y}_j\\|} \\right)。$$\n增广矩阵是一个 $(N+Q) \\times N$ 的矩形矩阵，由 $A(k)$ 和 $C_{\\mathrm{int}}(k)$ 堆叠而成：\n$$A_{\\mathrm{aug}}(k) = \\begin{bmatrix} A(k) \\\\ C_{\\mathrm{int}}(k) \\end{bmatrix}。$$\n\n**4. 条件数计算**\n我们在三个波数处计算条件数：一个非共振情况 $k=2.0\\,\\mathrm{m}^{-1}$，一个近共振情况 $k=k_1-0.01$，以及精确共振情况 $k=k_1$。\n对于方阵 $A(k)$ 和 $A_{\\mathrm{BM}}(k,1)$，2-范数条件数是 $\\kappa_2(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$，其中 $\\sigma$ 是 $M$ 的奇异值。对于矩形矩阵 $A_{\\mathrm{aug}}(k)$，伪条件数同样定义为其最大奇异值与最小奇异值之比。\n在共振波数 $k=k_1$ 处，算子 $\\frac{1}{2}I+D(k)$ 具有非平凡的零空间，这在其离散化矩阵 $A(k)$ 中表现为极大的条件数。Burton-Miller 方程和 CHIEF 方程都旨在通过创建在所有波数下都良态的系统来纠正此问题。计算将验证这种行为。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jn_zeros, hankel1\n\ndef compute_condition_numbers(k, R, N, alpha, Q, r_c):\n    \"\"\"\n    Computes the condition numbers for the three BEM matrices for a given wavenumber k.\n    \"\"\"\n    # 1. Geometry and Discretization Setup\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    y_boundary = R * np.array([np.cos(theta), np.sin(theta)]).T  # Shape (N, 2)\n    normals_boundary = y_boundary / R  # Shape (N, 2)\n    weight = 2 * np.pi * R / N\n\n    # 2. Assemble K_mat for D(k) and P(k) operators\n    # For a circle, D(k) = P(k)\n    K_mat = np.zeros((N, N), dtype=np.complex128)\n    for i in range(N):\n        for j in range(N):\n            if i == j:\n                continue\n            \n            yi = y_boundary[i, :]\n            yj = y_boundary[j, :]\n            normal_j = normals_boundary[j, :]\n            \n            vec_ji = yj - yi\n            dist = np.linalg.norm(vec_ji)\n            \n            # Kernel for double-layer potential\n            dot_prod = np.dot(vec_ji, normal_j)\n            hankel_val = hankel1(1, k * dist)\n            kernel_val = -1j * k / 4.0 * hankel_val * (dot_prod / dist)\n            \n            K_mat[i, j] = weight * kernel_val\n\n    # 3. Construct A(k) and A_BM(k, alpha)\n    I_N = np.eye(N)\n    A = 0.5 * I_N + K_mat\n    A_BM = 0.5 * I_N + (1.0 + 1j * alpha) * K_mat\n\n    # 4. Assemble CHIEF constraint matrix C_int(k)\n    C_int = np.zeros((Q, N), dtype=np.complex128)\n    phi = np.linspace(0, 2 * np.pi, Q, endpoint=False)\n    x_interior = r_c * np.array([np.cos(phi), np.sin(phi)]).T  # Shape (Q, 2)\n\n    for l in range(Q):\n        for j in range(N):\n            xl = x_interior[l, :]\n            yj = y_boundary[j, :]\n            normal_j = normals_boundary[j, :]\n\n            vec_jl = yj - xl\n            dist = np.linalg.norm(vec_jl)\n            \n            dot_prod = np.dot(vec_jl, normal_j)\n            hankel_val = hankel1(1, k * dist)\n            kernel_val = -1j * k / 4.0 * hankel_val * (dot_prod / dist)\n\n            C_int[l, j] = weight * kernel_val\n\n    # 5. Construct augmented matrix A_aug(k)\n    A_aug = np.vstack([A, C_int])\n\n    # 6. Compute condition numbers\n    cond_A = np.linalg.cond(A)\n    cond_ABM = np.linalg.cond(A_BM)\n    cond_Aaug = np.linalg.cond(A_aug)\n    \n    return [cond_A, cond_ABM, cond_Aaug]\n\n\ndef solve():\n    # Part (a): Compute interior Dirichlet eigenfrequencies\n    # Get first 2 positive zeros for J_0, J_1, J_2\n    zeros_j0 = jn_zeros(0, 2)\n    zeros_j1 = jn_zeros(1, 2)\n    zeros_j2 = jn_zeros(2, 2)\n    \n    # Combine, sort, and take the first 5\n    all_zeros = np.concatenate([zeros_j0, zeros_j1, zeros_j2])\n    eigs = sorted(all_zeros)[:5]\n    \n    k1 = eigs[0] # Smallest resonant wavenumber\n\n    # Part (b): Compute condition numbers\n    \n    # Define parameters\n    R = 1.0\n    N = 64\n    alpha = 1.0\n    Q = 4\n    r_c = 0.5\n\n    # Define wavenumbers for testing\n    k_values = [\n        2.0,           # General case\n        k1 - 0.01,     # Near-resonant case\n        k1             # Exactly resonant case\n    ]\n    \n    results_part_b = []\n    for k_val in k_values:\n        conds = compute_condition_numbers(k_val, R, N, alpha, Q, r_c)\n        results_part_b.append(conds)\n\n    # Format the final output as a single string\n    # The structure is [[eigs], [conds_k1], [conds_k2], [conds_k3]]\n    # where Python's str() on a list gives the '[...]' format.\n    final_results = [eigs] + results_part_b\n    output_str = \",\".join(map(str, final_results))\n    \n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们已经看到 Burton-Miller 方法能够有效解决伪频问题，但一个更深入的问题是：如何最优地使用它？本练习旨在推导 Burton-Miller 公式中的最佳耦合参数，这是一个更高级的理论探索。该练习将引导您通过对积分算子进行谱分析，来确定耦合参数 $ \\eta $ 的最优选择，并将其与波传播的物理阻抗联系起来，这对于提升迭代求解器的收敛效率至关重要。",
            "id": "4139828",
            "problem": "考虑三维中的时谐声散射，其由亥姆霍兹方程所支配。该方程描述了在角频率 $\\omega$ 下的总声压场 $p(\\mathbf{x})$，其中波数 $k = \\omega / c$，$c$ 是声速。令 $\\Omega^{+}$ 表示一个光滑、严格凸障碍物的无界外域，其边界为 $\\Gamma$，特征尺寸 $a$ 定义为最小外接球的半径。外狄利克雷问题旨在求解在 $\\Omega^{+}$ 中满足 $\\Delta p + k^{2} p = 0$ 且在 $\\Gamma$ 上满足 $p = -p^{\\text{inc}}$ 的 $p$，其中 $p^{\\text{inc}}$ 是给定的入射场。\n\n将与 Burton-Miller 公式相关的组合场积分方程 (CFIE) 算子定义为\n$$\n\\mathcal{A}_{\\eta} := \\left(\\tfrac{1}{2} I + \\mathcal{D}\\right) - i \\eta \\,\\mathcal{S},\n$$\n其中 $\\mathcal{S}$ 是 $\\Gamma$ 上的亥姆霍兹单层边界积分算子，$\\mathcal{D}$ 是 $\\Gamma$ 上的亥姆霍兹双层边界积分算子。组合亥姆霍兹积分方程公式 (CHIEF) 方法通过在选定的内部点评估附加约束来增强边界积分系统，以抑制与内部共振相关的非唯一性。\n\n使用半径为 $a$ 的球体作为典范几何对 $\\mathcal{A}_{\\eta}$ 进行谱分析，并利用伪微分算子理论对光滑凸边界的渐近考虑，确定耦合参数 $\\eta$（在纯虚数设置 $\\alpha = i \\eta$，其中 $\\eta > 0$）的领阶最优选择。该选择应是 $k$ 和 $a$ 的函数，旨在最小化 $\\mathcal{A}_{\\eta}$ 在其表面切向波数与 $k$ 相当的传播模态子集上的条件数。答案应为以 $k$ 和 $a$ 表示的领阶最优 $\\eta$ 的单个闭式解析表达式。该分析必须明确地将 $\\eta$ 的选择与 CFIE 算子谱的平衡联系起来，并解释 CHIEF 在内部共振方面的作用，但最终报告的答案必须仅为 $\\eta$ 的表达式，且不得包含任何不等式。将最终答案表示为不带单位的解析表达式。",
            "solution": "目标是为组合场积分方程 (CFIE) 算子（也称为 Burton-Miller 公式）找到实耦合参数 $\\eta > 0$ 的领阶最优值，该算子定义为\n$$\n\\mathcal{A}_{\\eta} := \\left(\\tfrac{1}{2} I + \\mathcal{D}\\right) - i \\eta \\mathcal{S}\n$$\n最优性定义为在高频状态下（$ka \\gg 1$），特别是在传播模态下，最小化 $\\mathcal{A}_{\\eta}$ 的条件数。\n\nBurton-Miller 公式的设计旨在克服困扰单个单层或双层公式的伪内部共振问题。当波数 $k$ 与相应内部问题的本征波数（例如，双层公式的内部狄利克雷问题）匹配时，就会发生这些共振。CHIEF 方法是通过添加额外的约束方程来纠正此问题的另一种策略。Burton-Miller 公式通过结合两种类型的积分算子，创建了一个当耦合参数选择正确时（例如，在某些公式中 $\\mathrm{Im}(\\eta k) > 0$，或在当前公式中 $\\eta \\neq 0$），对所有实数 $k > 0$ 都保证可逆的算子。然而，对于迭代求解器，仅有可逆性是不够的；高效收敛需要一个良好的条件数。\n\n首先，我们对算子项进行量纲分析。边界积分算子 $\\mathcal{S}$ 和 $\\mathcal{D}$ 将边界 $\\Gamma$ 上的密度函数 $\\phi$ 映射到 $\\Gamma$ 上的一个函数。设 $\\phi$ 为源密度。\n单层算子 $\\mathcal{S}$ 是通过亥姆霍兹基本解 $G(\\mathbf{x}, \\mathbf{y}) = \\exp(ik|\\mathbf{x}-\\mathbf{y}|)/(4\\pi|\\mathbf{x}-\\mathbf{y}|)$ 定义的。核函数 $G$ 的物理单位是长度的倒数，即 $[G] = L^{-1}$。该算子为 $(\\mathcal{S}\\phi)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\phi(\\mathbf{y}) dS_y$。因此，算子 $\\mathcal{S}$ 本身的单位是面积乘以长度的倒数，即 $[\\mathcal{S}]=L$。\n双层算子 $\\mathcal{D}$ 涉及核函数的法向导数 $\\partial G/\\partial n_y$，其单位为 $L^{-2}$。该算子为 $(\\mathcal{D}\\phi)(\\mathbf{x}) = \\int_{\\Gamma} (\\partial G/\\partial n_y) \\phi(\\mathbf{y}) dS_y$。因此，算子 $\\mathcal{D}$ 是无量纲的，即 $[\\mathcal{D}]=1$。\n\n为了使表达式 $\\left(\\tfrac{1}{2} I + \\mathcal{D}\\right) - i \\eta \\mathcal{S}$ 在量纲上保持一致，项 $i \\eta \\mathcal{S}$ 必须是无量纲的，就像 $I$ 和 $\\mathcal{D}$ 一样。这要求耦合参数 $\\eta$ 的单位是长度的倒数，即 $[\\eta] = L^{-1}$。问题中具有这些单位的物理参数是波数 $k$ 和特征尺寸的倒数 $1/a$。因此，最优 $\\eta$ 必须是 $k$ 和 $a$ 的函数，形式为 $\\eta = f(k, a)$，其中 $[f] = L^{-1}$。\n\n$\\eta$ 的最优选择是在相关模态范围内平衡算子的谱特性。问题指明，焦点是“其表面切向波数与 $k$ 相当的传播模态子集”。这引导我们进行高频渐近分析（$ka \\to \\infty$）。\n\n一种确定最优 $\\eta$ 的物理直观方法是将 CFIE 与边界 $\\Gamma$ 上的近似阻抗边界条件联系起来。散射场 $p_s$ 必须在无穷远处满足 Sommerfeld 辐射条件。对于主要沿表面法向传播的波，在边界 $\\Gamma$ 上对此条件的一个局部近似是一阶吸收边界条件：\n$$\n\\frac{\\partial p_s}{\\partial n} \\approx i k p_s\n$$\n这通过一个阻抗关系将场 $p_s$ 与其法向导数 $\\partial p_s/\\partial n$ 联系起来，其中的比例常数为 $ik$。\n\nBurton-Miller 算子源于将散射场表示为单层势 $\\mathcal{S}\\sigma$ 和双层势 $\\mathcal{D}\\mu$ 的线性组合。一个常见的选择是关联这些密度，例如，通过使用组合势表示散射场，从而得到形式为 $\\mathcal{A}_{\\eta}$ 的算子。参数 $\\eta$ 可以解释为对阻抗关系的数值近似。如果我们通过表示 $p_s = \\mathcal{S}\\sigma$ 来寻求解，那么在边界上，我们有 $p_s|_\\Gamma = \\mathcal{S}\\sigma$ 和 $\\partial p_s/\\partial n|_\\Gamma = (\\frac{1}{2}I + \\mathcal{D}')\\sigma$，其中 $\\mathcal{D}'$ 是 $\\mathcal{D}$ 的伴随算子。在边界上施加阻抗关系 $\\partial p_s/\\partial n - i\\eta p_s = 0$ 会得到算子方程：\n$$\n\\left(\\left(\\tfrac{1}{2}I + \\mathcal{D}'\\right) - i \\eta \\mathcal{S}\\right)\\sigma = 0\n$$\n尽管问题陈述中的算子使用 $\\mathcal{D}$ 而不是其伴随算子 $\\mathcal{D}'$，但它们的领阶渐近行为非常相似。问题中的算子 $\\mathcal{A}_{\\eta}$ 对于满足此近似阻抗条件的波场会变得奇异。虽然这可能看起来不理想，但这表明基于物理阻抗来设置 $\\eta$ 是一个深刻的选择，它将正确的出射波物理特性嵌入到边界上的算子中。对于阻抗参数，最自然的物理选择是波数 $k$ 本身。\n\n这个选择，$\\eta = k$，是关于高频声学边界元方法的文献中标准且得到最广泛支持的领阶选择。通过更严格的伪微分算子分析已经证实，选择与 $k$ 成正比的 $\\eta$ 会在 $k \\to \\infty$ 时最小化 $\\mathcal{A}_\\eta$ 条件数的增长。具体来说，通过此选择，条件数仅随 $ka$ 对数增长，即 $\\mathrm{cond}(\\mathcal{A}_k) = O(\\ln(ka))$，这相比于当 $\\eta$ 为常数（例如 $\\eta \\sim 1/a$）时观察到的线性增长 $O(ka)$ 是一个巨大的改进。\n\n问题要求的是作为 $k$ 和 $a$ 函数的领阶选择。在高频极限（$ka \\gg 1$）下，具有短切向波长（与 $1/k$ 相当）的波与边界发生局部相互作用。对此类波而言，局部几何形状看起来是平坦的，全局曲率半径 $a$ 的重要性变得低于由 $k$ 控制的局部波物理。因此，*领阶*最优参数不应依赖于 $a$。对曲率 $1/a$ 的依赖性出现在算子符号渐近展开的低阶项中，因此对 $\\eta$ 的修正会涉及 $a$。由于只要求领阶项，我们发现 $\\eta$ 仅是 $k$ 的函数。\n\n基于阻抗匹配论证及其在专业文献中的验证，最优的领阶选择是 $\\eta=k$。",
            "answer": "$$\\boxed{k}$$"
        }
    ]
}