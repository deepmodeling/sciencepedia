{
    "hands_on_practices": [
        {
            "introduction": "我们从一个声学中的经典问题——球体散射——开始。在解决边界积分方法中的非唯一性问题之前，我们必须首先理解如何识别出那些会引发问题的“伪频率”。本练习将指导您使用分离变量法进行解析推导，揭示这些频率实际上就是物体内部区域的自然共振模式。",
            "id": "4139725",
            "problem": "考虑在均匀无粘性流体中，一个声软球体对平面波的时谐声散射。设总声压场$p(\\mathbf{x})$在半径为$a$的球体外部满足亥姆霍兹方程$\\nabla^{2} p + k^{2} p = 0$，同时满足狄利克雷边界条件$p|_{r=a} = 0$以及无穷远处的索末菲辐射条件。假设时间依赖关系为$\\exp(-\\mathrm{i} \\omega t)$，因此$k = \\omega / c$，其中$c$为声速。一个单位振幅的平面波沿$z$轴入射，其表达式为$p^{\\mathrm{i}}(\\mathbf{x}) = \\exp(\\mathrm{i} k z)$。\n\n从亥姆霍兹方程和球坐标系下的分离变量表示出发，推导远场散射振幅$f(\\theta)$，使得在远场中，当$r \\to \\infty$时，$p^{\\mathrm{s}}(r,\\theta) \\sim \\frac{\\exp(\\mathrm{i} k r)}{r} f(\\theta)$，其中$p^{\\mathrm{s}}$是散射场，$\\theta$是极角。此外，请指出外狄利克雷问题在哪些频率下会发生内部共振，即传统的边界积分方程在这些频率下存在非唯一解；并将此识别与模态分离变量分析联系起来。\n\n最后，对于一个在水中半径为$a = 0.50$米、声速为$c = 1.50 \\times 10^{3}$米/秒的球体，计算与$l=0$模态相关的最低正内部共振角频率$\\omega_{1}$（单位为弧度/秒）。将您的数值结果四舍五入到四位有效数字，并以弧度/秒为单位表示该角频率。您可以假定以下经过充分验证的事实：平面波的球谐函数展开以及球汉克尔函数的远场渐近性。在您的推导中，首次出现时请明确定义组合亥姆霍兹积分方程公式 (Combined Helmholtz Integral Equation Formulation, CHIEF) 和 Burton–Miller 组合场积分方程 (Burton–Miller)，并从概念层面解释每种方法如何在不改变通过分离变量法推导出的物理散射振幅的情况下，消除由内部共振引起的伪非唯一性。\n\n您的最终答案必须包含两个部分，以单行矩阵的形式呈现：$f(\\theta)$的闭式级数表达式，以及$\\omega_{1}$的计算值。",
            "solution": "该问题陈述具有科学依据，是适定的、客观且自洽的。它代表了声散射理论中的一个标准问题，因此是有效的。\n\n总声压场$p(\\mathbf{x})$是入射平面波$p^{\\mathrm{i}}(\\mathbf{x})$和散射场$p^{\\mathrm{s}}(\\mathbf{x})$的和，即$p(\\mathbf{x}) = p^{\\mathrm{i}}(\\mathbf{x}) + p^{\\mathrm{s}}(\\mathbf{x})$。$p$和$p^{\\mathrm{i}}$都满足亥姆霍兹方程$\\nabla^{2} \\phi + k^{2} \\phi = 0$，因此散射场$p^{\\mathrm{s}}$也必须满足该方程。\n\n沿$z$轴传播的入射平面波由$p^{\\mathrm{i}}(\\mathbf{x}) = \\exp(\\mathrm{i}kz) = \\exp(\\mathrm{i}kr\\cos\\theta)$给出。其以勒让德多项式$P_l(\\cos\\theta)$和第一类球贝塞尔函数$j_l(kr)$展开的形式为：\n$$ p^{\\mathrm{i}}(r, \\theta) = \\sum_{l=0}^{\\infty} \\mathrm{i}^l (2l+1) j_l(kr) P_l(\\cos\\theta) $$\n由于入射波和球形散射体具有方位对称性，散射场$p^{\\mathrm{s}}$也将与方位角$\\phi$无关。我们可以将$p^{\\mathrm{s}}$表示为分波级数。为了满足索末菲辐射条件，该条件规定散射波在无穷远处必须是纯出射波，我们使用第一类球汉克尔函数$h_l^{(1)}(kr)$：\n$$ p^{\\mathrm{s}}(r, \\theta) = \\sum_{l=0}^{\\infty} A_l h_l^{(1)}(kr) P_l(\\cos\\theta) $$\n系数$A_l$由球体表面的边界条件确定。对于半径为$a$的声软球体，边界上的总压力为零：$p(a, \\theta) = 0$。这意味着$p^{\\mathrm{s}}(a, \\theta) = -p^{\\mathrm{i}}(a, \\theta)$。\n将级数展开式代入边界条件可得：\n$$ \\sum_{l=0}^{\\infty} A_l h_l^{(1)}(ka) P_l(\\cos\\theta) = - \\sum_{l=0}^{\\infty} \\mathrm{i}^l (2l+1) j_l(ka) P_l(\\cos\\theta) $$\n根据勒让德多项式的正交性，我们可以对每个模态$l$的系数进行等同：\n$$ A_l h_l^{(1)}(ka) = - \\mathrm{i}^l (2l+1) j_l(ka) $$\n求解未知系数$A_l$：\n$$ A_l = - (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} $$\n因此，散射场为：\n$$ p^{\\mathrm{s}}(r, \\theta) = - \\sum_{l=0}^{\\infty} (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} h_l^{(1)}(kr) P_l(\\cos\\theta) $$\n为求得远场散射振幅$f(\\theta)$，我们考察当$r \\to \\infty$时$p^{\\mathrm{s}}$的渐近行为。球汉克尔函数具有以下渐近形式：\n$$ h_l^{(1)}(kr) \\sim \\frac{1}{kr} \\exp\\left(\\mathrm{i}\\left(kr - \\frac{(l+1)\\pi}{2}\\right)\\right) = \\frac{(-\\mathrm{i})^{l+1}}{kr} \\exp(\\mathrm{i}kr) $$\n将此代入$p^{\\mathrm{s}}$的表达式中：\n$$ p^{\\mathrm{s}}(r, \\theta) \\sim \\sum_{l=0}^{\\infty} A_l P_l(\\cos\\theta) \\frac{(-\\mathrm{i})^{l+1}}{kr} \\exp(\\mathrm{i}kr) = \\frac{\\exp(\\mathrm{i}kr)}{r} \\left( \\frac{1}{k} \\sum_{l=0}^{\\infty} A_l (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) \\right) $$\n通过与定义$p^{\\mathrm{s}}(r,\\theta) \\sim \\frac{\\exp(\\mathrm{i}kr)}{r} f(\\theta)$进行比较，我们确定散射振幅为：\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} A_l (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) $$\n代入$A_l$的表达式：\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} \\left( - (2l+1) \\mathrm{i}^l \\frac{j_l(ka)}{h_l^{(1)}(ka)} \\right) (-\\mathrm{i})^{l+1} P_l(\\cos\\theta) $$\n$$ f(\\theta) = \\frac{1}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} [- \\mathrm{i}^l (-\\mathrm{i})^{l+1}] P_l(\\cos\\theta) $$\n方括号中的项可简化为：$- \\mathrm{i}^l (-\\mathrm{i})^{l+1} = - \\mathrm{i}^l (-1)^{l+1} \\mathrm{i}^{l+1} = (-1)^{l+2} \\mathrm{i}^{2l+1} = (-1)^l (-1)^l \\mathrm{i} = \\mathrm{i}$。\n因此，远场散射振幅为：\n$$ f(\\theta) = \\frac{\\mathrm{i}}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} P_l(\\cos\\theta) $$\n\n当使用边界积分方程 (Boundary Integral Equation, BIE) 方法求解此散射问题时，会出现内部共振问题。对于外狄利克雷问题（如声软散射体），一种常见的方法是针对表面上未知的压力法向导数使用直接 BIE 公式。这导致形式为$S\\phi = g$的积分方程，其中$S$是单层势算子。该公式在某些特征频率下会失效，导致非唯一解。这些频率对应于相关*内部*问题的特征值。对于外狄利克雷问题，相关的内部问题是亥姆霍兹方程的内狄利克雷问题：在边界所包围的体积内，$\\nabla^2 u + k^2 u = 0$，且在边界上$u=0$。\n这与模态分离变量分析的联系是直接的。球体内狄利克雷问题的非平凡解（特征函数）仅在特定的波数$k$下存在。对内部问题使用分离变量法，在原点处正则的解形式为$u(r,\\theta,\\phi) = \\sum_{l,m} C_{lm} j_l(kr) Y_l^m(\\theta,\\phi)$。边界条件$u(a,\\theta,\\phi)=0$要求对于某个非负整数$l$有$j_l(ka)=0$。满足此条件的任何$l$的波数$k$均为共振波数。在这些波数下，积分算子$S$具有非平凡的零空间，BIE 是不适定的。\n\n为了克服这种非唯一性，已经发展了几种方法。\n**组合亥姆霍兹积分方程公式 (Combined Helmholtz Integral Equation Formulation, CHIEF)** 是一种通过在散射体内部选择若干点，并强制散射场的积分表示在这些点上为零的方法。对于外部散射场$p^{\\mathrm{s}}$，亥姆霍兹积分表示在内部域的任何点$\\mathbf{x}_{\\text{int}}$处都为零。这些额外的约束方程被附加到原始的离散化表面 BIE 上，形成一个超定线性方程组。然后通常以最小二乘法求解该系统。与内部共振相关的伪解通常不满足这些额外的内部约束（除非 CHIEF 点恰好位于内部特征模态的节面上），从而确保找到唯一解。\n\n**Burton–Miller 组合场积分方程** 通过构建标准表面亥姆霍兹积分方程及其法向导数的线性组合来对问题进行正则化。得到的组合方程形式为$\\mathcal{A} + \\alpha \\mathcal{B} = g$，其中$\\mathcal{A}$是原始的不适定方程，$\\mathcal{B}$是其法向导数，而$\\alpha$是一个复耦合参数。对于外狄利克雷问题，一种常见的公式是组合单层算子和超奇异算子，$(S + \\alpha N) v = g_{\\text{new}}$，其中$v$是未知的法向导数，N 是超奇异算子。可以证明，如果$\\alpha$的虚部非零（一个常见的选择是$\\alpha = \\mathrm{i}/k$），则对于所有实数、正波数$k$，组合算子都是可逆的。与 CHIEF 方法（如果内部点选择不当可能会失败）不同，这种方法可以稳健地消除所有几何形状和频率的非唯一性问题。\n\n最后，我们计算$l=0$模态的最低正内部共振角频率$\\omega_{1}$。这对应于使$j_0(k_1a)=0$的最低正波数$k_1$。\n0 阶球贝塞尔函数是$j_0(x) = \\frac{\\sin(x)}{x}$。\n条件$j_0(k_1a) = 0$要求$\\frac{\\sin(k_1a)}{k_1a} = 0$。由于我们寻找的是正频率，所以$k_1 a > 0$，因此必须有$\\sin(k_1a)=0$。\n该参数的最小正解是$k_1 a = \\pi$。\n波数$k$通过$k = \\omega/c$与角频率$\\omega$相关。因此，$k_1 = \\omega_1/c$。\n将此代入我们的条件中：\n$$ \\frac{\\omega_1 a}{c} = \\pi $$\n求解$\\omega_1$：\n$$ \\omega_1 = \\frac{\\pi c}{a} $$\n问题给出的值为$a = 0.50$米和$c = 1.50 \\times 10^3$米/秒。\n$$ \\omega_1 = \\frac{\\pi (1.50 \\times 10^3 \\text{ m/s})}{0.50 \\text{ m}} = \\pi \\times 3.0 \\times 10^3 \\text{ rad/s} $$\n数值上，这是$\\omega_1 \\approx 9424.777...$ rad/s。\n四舍五入到四位有效数字，我们得到$\\omega_1 = 9425$ rad/s，或用科学记数法表示为$9.425 \\times 10^3$ rad/s。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\mathrm{i}}{k} \\sum_{l=0}^{\\infty} (2l+1) \\frac{j_l(ka)}{h_l^{(1)}(ka)} P_l(\\cos\\theta)  9.425 \\times 10^{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在我们理解了内部共振的基础上，现在来探讨一个关键的细节：有问题的频率具体是哪些，取决于所选择的边界积分方程形式。本练习研究二维软声障圆柱的声散射问题。您将发现，用于外部狄利克雷（Dirichlet）问题的常规积分方程，会在对应于*内部诺伊曼（Neumann）问题*特征值的频率上失效，而这组模式与内部狄利克雷问题的模式是不同的。",
            "id": "4139769",
            "problem": "考虑一个半径为$a$的声软圆形障碍物在空气中的二维时谐声散射。外部声压$p$满足亥姆霍兹方程$\\nabla^{2} p + k^{2} p = 0$，波数$k = \\omega / c$，其中$\\omega$是角频率，$c$是声速。障碍物表面的声软边界条件要求在$r = a$处$p = 0$。在使用单一经典边界算子的传统边界积分方程公式中，当对应的内部边值问题存在非平凡齐次解时，会在某些波数$k$处出现非唯一性（奇异频率）。对于声软外部问题，这些奇异频率与圆盘上拉普拉斯算子的内部诺伊曼特征值相关联。\n\n从亥姆霍兹方程和适当的内部诺伊曼边界条件出发，推导用贝塞尔函数表示奇异波数的共振条件。然后，确定在声速$c = 343\\,\\mathrm{m/s}$的空气中，半径为$a = 0.25\\,\\mathrm{m}$的圆形障碍物的最低正奇异频率。将最终答案以$\\mathrm{Hz}$为单位表示，并四舍五入到四位有效数字。\n\n在你的推理中，解释组合亥姆霍兹积分方程公式（CHIEF）和伯顿-米勒公式（Burton-Miller formulation）如何消除这些奇异频率处的非唯一性，但只需计算所要求的最低正奇异频率。",
            "solution": "所述问题是有效的。它在科学上是合理的，适定的，并且包含唯一解所需的所有必要信息。\n\n该问题要求计算与声软圆形障碍物声散射的积分方程公式相关的最低正奇异频率。对于外部狄利克雷（声软）问题，边界上压力$p=0$，标准边界积分方程（BIE）公式的奇异频率对应于内部齐次诺伊曼问题有非平凡解的波数$k$。因此，我们必须找到带有齐次诺伊曼边界条件的半径为$a$的圆盘内部的拉普拉斯算子的特征值。\n\n控制方程是二维亥姆霍兹方程：\n$$ \\nabla^{2} p + k^{2} p = 0 $$\n对于内部域$r \\le a$。在圆$r=a$上的齐次诺伊曼边界条件是：\n$$ \\frac{\\partial p}{\\partial \\mathbf{n}} = 0 \\quad \\text{at} \\quad r=a $$\n其中$\\mathbf{n}$是向外的法向量。在极坐标$(r, \\theta)$中，此条件变为：\n$$ \\frac{\\partial p}{\\partial r} = 0 \\quad \\text{at} \\quad r=a $$\n\n我们使用分离变量法求解亥姆霍兹方程。设$p(r, \\theta) = R(r)\\Theta(\\theta)$。将其代入用极坐标表示的亥姆霍兹方程，\n$$ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial p}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 p}{\\partial \\theta^2} + k^2 p = 0 $$\n分离后我们得到两个常微分方程：\n$$ \\frac{d^2 \\Theta}{d \\theta^2} + m^2 \\Theta = 0 $$\n$$ r^2 \\frac{d^2 R}{d r^2} + r \\frac{d R}{d r} + (k^2 r^2 - m^2) R = 0 $$\n其中$m^2$是分离常数。为了使解在$\\theta$上是单值的，$m$必须是整数，$m = 0, 1, 2, \\dots$。角向方程的解是$\\cos(m\\theta)$和$\\sin(m\\theta)$的线性组合。\n\n径向方程是贝塞尔微分方程。其通解是第一类贝塞尔函数$J_m(kr)$和第二类贝塞尔函数$Y_m(kr)$的线性组合。由于物理域包含原点($r=0$)，且声压$p$的解在该处必须保持有限，我们必须舍弃在原点处奇异的第二类贝塞尔函数$Y_m(kr)$。因此，径向解为$R(r) = J_m(kr)$。\n\n内部声压场的通解是所有可能模式的叠加：\n$$ p(r, \\theta) = \\sum_{m=0}^{\\infty} \\left( A_m \\cos(m\\theta) + B_m \\sin(m\\theta) \\right) J_m(kr) $$\n其中$A_m$和$B_m$是常数。\n\n现在，我们在$r=a$处应用齐次诺伊曼边界条件：\n$$ \\left. \\frac{\\partial p}{\\partial r} \\right|_{r=a} = \\sum_{m=0}^{\\infty} \\left( A_m \\cos(m\\theta) + B_m \\sin(m\\theta) \\right) \\left. \\frac{d}{dr} J_m(kr) \\right|_{r=a} = 0 $$\n使用链式法则，$\\frac{d}{dr} J_m(kr) = k J'_m(kr)$，其中撇号表示对宗量的微分。这得到：\n$$ \\sum_{m=0}^{\\infty} k \\left( A_m \\cos(m\\theta) + B_m \\sin(m\\theta) \\right) J'_m(ka) = 0 $$\n为使该方程对所有$\\theta \\in [0, 2\\pi)$成立，每个正交基函数（$\\cos(m\\theta)$和$\\sin(m\\theta)$）的系数必须为零。这意味着对于每个模式$m$，我们必须有：\n$$ A_m k J'_m(ka) = 0 \\quad \\text{and} \\quad B_m k J'_m(ka) = 0 $$\n我们正在寻找非平凡解，这意味着对于至少一个模式$m$，系数（$A_m$或$B_m$）中至少有一个必须非零。这只有在乘积中的另一个因子为零时才可能。由于我们关心的是正频率，我们需要$k > 0$。因此，存在非平凡解的条件是：\n$$ J'_m(ka) = 0 $$\n对于某个整数$m \\geq 0$。满足此方程的$k$值即为外部声软问题的奇异波数。令$z_{mn}$表示方程$J'_m(z) = 0$的第$n$个正根。对应的奇异波数由$k_{mn} a = z_{mn}$给出，即：\n$$ k_{mn} = \\frac{z_{mn}}{a} $$\n\n为了找到最低的正奇异频率，我们必须找到$k_{mn}$的最小正值，这对应于找到所有$m \\geq 0$和$n \\geq 1$的根$z_{mn}$中的全局最小值。我们列出对于较小的$m$，$J'_m(z) = 0$的前几个正根：\n- 对于$m=0$：$z_{01} \\approx 3.8317$，$z_{02} \\approx 7.0156, \\dots$\n- 对于$m=1$：$z_{11} \\approx 1.8412$，$z_{12} \\approx 5.3314, \\dots$\n- 对于$m=2$：$z_{21} \\approx 3.0542$，$z_{22} \\approx 6.7061, \\dots$\n- 对于$m=3$：$z_{31} \\approx 4.2012$，$z_{32} \\approx 8.0152, \\dots$\n\n所有这些根中最小的是$z_{11} \\approx 1.84118$。这个根对应于模式$(m, n) = (1, 1)$。因此，最低的奇异波数是：\n$$ k_{\\min} = \\frac{z_{11}}{a} $$\n角频率是$\\omega = ck$，所以最低的奇异角频率是$\\omega_{\\min} = c k_{\\min} = \\frac{c z_{11}}{a}$。以赫兹为单位的频率是$f = \\omega / (2\\pi)$，所以最低的正奇异频率是：\n$$ f_{\\min} = \\frac{c k_{\\min}}{2\\pi} = \\frac{c z_{11}}{2\\pi a} $$\n使用给定值$a = 0.25\\,\\mathrm{m}$和$c = 343\\,\\mathrm{m/s}$，以及值$z_{11} \\approx 1.84118378$：\n$$ f_{\\min} = \\frac{(343\\,\\mathrm{m/s}) \\times 1.84118378}{2\\pi \\times (0.25\\,\\mathrm{m})} \\approx \\frac{631.52414}{1.570796}\\,\\mathrm{Hz} \\approx 402.0433\\,\\mathrm{Hz} $$\n将结果四舍五入到四位有效数字，我们得到$402.0\\,\\mathrm{Hz}$。\n\n在结束之前，我们讨论非唯一性问题及其解决方法。基于格林第二恒等式的边界积分方程（BIE）的使用会导致积分算子在某些频率（称为奇异频率或伪频率）下不可逆。如前所示，对于外部声软（狄利克雷）问题，这些频率与相应内部诺伊曼问题的共振频率相匹配。在这些频率下，BIE 允许非唯一解，从而破坏数值结果。克服这个问题的两种常用方法是 CHIEF 和 Burton-Miller 公式。\n\n由 H. A. Schenck 提出的组合亥姆霍兹积分方程公式（CHIEF）通过为 BIE 补充额外的约束来规避非唯一性。亥姆霍兹积分表示定理保证了在散射障碍物内部的任何一点，总场为零。CHIEF 利用这一点，要求解在一些选定的内部点（CHIEF 点）处为零。这会导出一个超定线性方程组，然后以最小二乘法求解。这个过程可以恢复唯一性，前提是 CHIEF 点不位于内部共振模式的节面上。\n\n由 A. J. Burton 和 G. F. Miller 提出的 Burton-Miller 公式通过对原始 BIE 及其法向导数进行线性组合来创建一个新的积分方程。组合方程的形式为$L p + \\alpha N p = f + \\alpha g$，其中$L$和$N$是原始和导数积分算子，$\\alpha$是一个复耦合常数（通常是纯虚数，例如，对于某个实数$\\eta > 0$，$\\alpha = i/\\eta$）。可以证明，这个组合算子对于所有正实数波数$k$都是唯一可逆的。Burton-Miller 方法的主要实践困难在于 BIE 的法向导数涉及超奇异积分算子，其评估需要特殊的数学和数值处理。\n\n这两种方法都成功地消除了奇异频率问题，从而产生了一种对所有频率都有效的稳健数值方法。",
            "answer": "$$\n\\boxed{402.0}\n$$"
        },
        {
            "introduction": "这个总结性的练习将理论付诸实践，通过数值方法展示非唯一性问题及其解决方案。您将构建直接边界积分公式、CHIEF方法和Burton-Miller公式的系统矩阵。通过计算在共振频率处的条件数，您将直接观察到标准方法的数值不稳定性，并验证改进后的公式如何有效地产生一个适定的系统。",
            "id": "4139731",
            "problem": "考虑由总声压场$p(\\mathbf{x})$的亥姆霍兹方程所描述的二维空间中的时谐声散射问题：\n$$\\nabla^2 p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = 0,$$\n其中$k$是声波数，单位为$1/\\mathrm{m}$。几何形状为平面上的单位半径圆，即集合$\\Gamma = \\{\\mathbf{x} \\in \\mathbb{R}^2 : \\|\\mathbf{x}\\| = R\\}$，其中$R = 1\\,\\mathrm{m}$。在边界点$\\mathbf{y} \\in \\Gamma$处，外向单位法向量为$\\mathbf{n}_\\Gamma(\\mathbf{y})$。二维亥姆霍兹算子的基本解（格林函数）为\n$$G(\\mathbf{x},\\mathbf{y};k) = \\frac{i}{4} H_0^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big),$$\n其中$H_0^{(1)}$是零阶第一类汉克尔函数。经典的双层势算子$D$和单层势算子$P$的法向导数（相对于观测点的法向$\\partial/\\partial n_{\\mathbf{x}}$）的核函数为\n$$K_D(\\mathbf{x},\\mathbf{y};k) = -\\frac{i k}{4}\\,H_1^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big)\\,\\frac{(\\mathbf{y}-\\mathbf{x})\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y})}{\\|\\mathbf{x}-\\mathbf{y}\\|},$$\n$$K_P(\\mathbf{x},\\mathbf{y};k) = -\\frac{i k}{4}\\,H_1^{(1)}\\!\\big(k \\|\\mathbf{x}-\\mathbf{y}\\|\\big)\\,\\frac{(\\mathbf{x}-\\mathbf{y})\\cdot \\mathbf{n}_\\Gamma(\\mathbf{x})}{\\|\\mathbf{x}-\\mathbf{y}\\|},$$\n其中$H_1^{(1)}$是一阶第一类汉克尔函数，所有角度均以弧度为单位。对于光滑边界，用于软声（狄利克雷）散射的直接边界积分方程使用作用于未知密度函数的算子$(\\tfrac{1}{2}I + D)$；Burton–Miller 公式将直接边界积分方程与其法向导数相结合，以消除内部共振波数处的解的非唯一性。组合亥姆霍兹积分方程公式 (CHIEF) 在一组内部配置点上增加齐次内部场约束，以在这些共振波数处稳定系统。\n\n任务：使用单位圆几何形状，通过$N$个等距配置点和梯形法则权重$w = 2\\pi R / N$来离散化边界，并构建以下三个矩阵：\n- 直接边界算子\n$$A(k) = \\tfrac{1}{2}I + D(k),$$\n- Burton–Miller 型组合算子\n$$A_{\\mathrm{BM}}(k,\\alpha) = \\tfrac{1}{2}I + D(k) + i \\alpha\\,P(k),$$\n其中$\\alpha$是一个无量纲耦合参数，\n- CHIEF 增广算子\n$$A_{\\mathrm{aug}}(k) = \\begin{bmatrix} \\tfrac{1}{2}I + D(k) \\\\ C_{\\mathrm{int}}(k) \\end{bmatrix},$$\n其中内部约束块$C_{\\mathrm{int}}(k)$在$Q$个内部点$\\mathbf{x}_c^\\ell$处计算双层势（在内部没有跳跃项），从而使得齐次散射场在这些内部配置点上为零。在所有三个矩阵中，使用梯形法则来近似边界积分，仅使用非对角核函数求值，并将$D(k)$和$P(k)$的对角线元素设为$0$，同时保持$A(k)$和$A_{\\mathrm{BM}}(k,\\alpha)$中书写的跳跃项$\\tfrac{1}{2}I$。\n\n(a) 部分：计算单位圆盘的前几个内部狄利克雷本征波数，即存在满足$p|_{\\Gamma} = 0$的齐次内部亥姆霍兹边值问题的非平凡解的最小正波数$k$（单位为$1/\\mathrm{m}$）。使用分离变量法，并利用这些波数出现在整数方位角阶数$m \\in \\mathbb{Z}_{\\ge 0}$的第一类贝塞尔函数$J_m(kr)$的正零点处这一事实。报告从阶数$m=0,1,2$（每阶最多2个零点）计算出的前5个最小的此类波数，并按升序排序。所有波数均以$1/\\mathrm{m}$为单位。\n\n(b) 部分：使用上述离散化方法，其中$R = 1\\,\\mathrm{m}$，$N = 64$，$\\alpha = 1$，以及在半径$0.5\\,\\mathrm{m}$处以等距角度放置的$Q = 4$个内部点，计算在以下波数（均以$1/\\mathrm{m}$为单位）下，方阵$A(k)$和$A_{\\mathrm{BM}}(k,\\alpha)$的 2-范数条件数$\\kappa_2$，以及矩形矩阵$A_{\\mathrm{aug}}(k)$的伪条件数（定义为$A_{\\mathrm{aug}}(k)$的最大奇异值与最小奇异值之比）：\n- 一般情况$k = 2.0$，\n- 近共振情况$k = k_1 - 0.01$，其中$k_1$是 (a) 部分中得到的最小波数，\n- 精确共振情况$k = k_1$。\n\n所有角度计算均使用弧度。对于每种情况，返回三个浮点数：$\\kappa_2\\!\\big(A(k)\\big)$、$\\kappa_2\\!\\big(A_{\\mathrm{BM}}(k,\\alpha)\\big)$以及$A_{\\mathrm{aug}}(k)$的伪条件数。\n\n测试套件和最终输出格式：\n- 计算 (a) 部分中的前 5 个内部波数列表作为第一个输出项。\n- 计算 (b) 部分中三个指定波数下各自的三个条件数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，结构如下\n$$[\\text{eigs, [cd_1, cbm_1, caug_1], [cd_2, cbm_2, caug_2], [cd_3, cbm_3, caug_3]]},$$\n其中$\\text{eigs}$是 (a) 部分的 5 个浮点数列表（单位为$1/\\mathrm{m}$），对于每个$j \\in \\{1,2,3\\}$，$\\text{cd}_j$是$\\kappa_2\\!\\big(A(k_j)\\big)$，$\\text{cbm}_j$是$\\kappa_2\\!\\big(A_{\\mathrm{BM}}(k_j,\\alpha)\\big)$，$\\text{caug}_j$是$A_{\\mathrm{aug}}(k_j)$的伪条件数，所有值均报告为浮点数。",
            "solution": "用户提供的问题经评估有效。该问题在科学上基于计算声学原理，特别是针对亥姆霍兹方程的边界积分方程 (BIE) 方法。该问题是适定的，提供了所有必要的参数和定义，并且不包含内部矛盾或事实错误。任务是分析三种不同 BIE 公式在圆形障碍物声散射问题中的数值稳定性，特别是在内部共振现象的背景下。\n\n解答按规定分为两部分进行。(a) 部分确定单位圆盘的共振波数（内部狄利克雷本征频率）。(b) 部分涉及在共振和非共振波数下，对直接 BIE 公式、Burton–Miller 公式和 CHIEF 方法相应矩阵的条件数进行数值实现和分析。\n\n### (a) 部分：内部狄利克雷本征频率\n\n半径为$R$的圆盘内，亥姆霍兹方程$\\nabla^2 p + k^2 p = 0$在其边界$\\Gamma$上满足边界条件$p=0$的内部狄利克雷问题是一个经典的本征值问题。其解（本征函数）可以使用极坐标$(r, \\theta)$下的分离变量法求得。在原点($r=0$)处有界的解具有以下形式\n$$p(r, \\theta) = \\sum_{m=0}^{\\infty} J_m(kr) (A_m \\cos(m\\theta) + B_m \\sin(m\\theta)),$$\n其中$J_m$是整数阶$m$的第一类贝塞尔函数。对于所有$\\theta$，边界条件$p(R, \\theta) = 0$施加了约束，即对每个方位角模式$m$，都有$J_m(kR) = 0$。\n\n对于给定的单位圆盘几何形状，$R=1\\,\\mathrm{m}$，该条件简化为$J_m(k)=0$。因此，内部共振波数$k$是非负整数阶$m$的第一类贝塞尔函数$J_m(x)$的正零点。我们需要找到在考虑阶数$m=0, 1, 2$的情况下，前 5 个最小的此类波数。\n\n设$z_{m,n}$表示$J_m(x)$的第$n$个正零点。我们计算$m=0, 1, 2$的前两个零点：\n- $J_0(x)$的零点：$z_{0,1} \\approx 2.4048$, $z_{0,2} \\approx 5.5201$\n- $J_1(x)$的零点：$z_{1,1} \\approx 3.8317$, $z_{1,2} \\approx 7.0156$\n- $J_2(x)$的零点：$z_{2,1} \\approx 5.1356$, $z_{2,2} \\approx 8.4172$\n\n将这六个值收集起来并按升序排序，得到序列：\n$2.4048\\dots, 3.8317\\dots, 5.1356\\dots, 5.5201\\dots, 7.0156\\dots, 8.4172\\dots$。\n前 5 个最小的共振波数（单位为$1/\\mathrm{m}$）约为$2.4048$、$3.8317$、$5.1356$、$5.5201$和$7.0156$。其中最小的一个，我们记为$k_1$，是$k_1 = z_{0,1} \\approx 2.4048\\,\\mathrm{m}^{-1}$。\n\n### (b) 部分：矩阵离散化与条件数分析\n\n我们使用$N=64$个等距配置点$\\mathbf{y}_j$（其中$j=0, \\dots, N-1$）来离散化圆形边界$\\Gamma$。一个点$\\mathbf{y}_j$由$\\mathbf{y}_j = (R\\cos\\theta_j, R\\sin\\theta_j)$给出，其中$R=1\\,\\mathrm{m}$且$\\theta_j = 2\\pi j/N$。在$\\mathbf{y}_j$处的外向单位法向量为$\\mathbf{n}_\\Gamma(\\mathbf{y}_j) = (\\cos\\theta_j, \\sin\\theta_j)$。边界积分使用梯形法则和均匀权重$w = 2\\pi R / N = \\pi/32$进行近似。\n\n积分算子被离散化为$N \\times N$矩阵。对于一个核函数为$K(\\mathbf{x}, \\mathbf{y})$的算子，Nyström 离散化方法对于非对角元素（$i \\ne j$）得到的矩阵项为$K_{ij} = w \\cdot K(\\mathbf{y}_i, \\mathbf{y}_j)$。根据规定，积分算子矩阵$D(k)$和$P(k)$的对角线元素被设为$0$。\n\n**1. $D(k)$ 和 $P(k)$ 算子**\n对于$i \\ne j$，矩阵$D(k)$和$P(k)$的元素由$D_{ij} = w \\cdot K_D(\\mathbf{y}_i, \\mathbf{y}_j; k)$和$P_{ij} = w \\cdot K_P(\\mathbf{y}_i, \\mathbf{y}_j; k)$给出。对于圆形的特殊情况，当点$\\mathbf{x}=\\mathbf{y}_i$和$\\mathbf{y}=\\mathbf{y}_j$都位于边界上时，核函数$K_D$和$K_P$是相同的。这是因为$(\\mathbf{y}_j-\\mathbf{y}_i)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j) = (\\mathbf{y}_i-\\mathbf{y}_j)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_i) = R(1 - \\cos(\\theta_j-\\theta_i))$。因此，这两个矩阵相等：$D(k) = P(k)$。我们将这个公共矩阵表示为$K_{\\mathrm{mat}}(k)$。其对于$i \\neq j$的元素为：\n$$(K_{\\mathrm{mat}})_{ij} = w \\cdot \\left( -\\frac{i k}{4} H_1^{(1)}\\!\\big(k \\|\\mathbf{y}_i-\\mathbf{y}_j\\|\\big)\\,\\frac{(\\mathbf{y}_j-\\mathbf{y}_i)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j)}{\\|\\mathbf{y}_i-\\mathbf{y}_j\\|} \\right),$$\n且$(K_{\\mathrm{mat}})_{ii} = 0$。\n\n**2. $A(k)$ 和 $A_{\\mathrm{BM}}(k,\\alpha)$ 矩阵**\n直接公式和 Burton-Miller 公式的矩阵构建如下：\n- $A(k) = \\frac{1}{2}I + D(k) = \\frac{1}{2}I_N + K_{\\mathrm{mat}}(k)$\n- $A_{\\mathrm{BM}}(k,\\alpha) = \\frac{1}{2}I + D(k) + i \\alpha P(k) = \\frac{1}{2}I_N + (1+i\\alpha)K_{\\mathrm{mat}}(k)$\n当$\\alpha=1$时，这变为$A_{\\mathrm{BM}}(k,1) = \\frac{1}{2}I_N + (1+i)K_{\\mathrm{mat}}(k)$。这两个都是$N \\times N$的方阵。\n\n**3. CHIEF 矩阵 $A_{\\mathrm{aug}}(k)$**\nCHIEF 方法通过$Q=4$个内部约束方程来增广直接公式。内部点$\\mathbf{x}_c^\\ell$（其中$\\ell=0, \\dots, Q-1$）位于半径为$r_c = 0.5\\,\\mathrm{m}$处，并具有等距角$\\phi_\\ell = 2\\pi \\ell / Q$。约束方程要求散射场（由双层势表示）在这些点上为零。这产生了一个$Q \\times N$的约束矩阵$C_{\\mathrm{int}}(k)$，其元素为：\n$$(C_{\\mathrm{int}})_{\\ell j} = w \\cdot K_D(\\mathbf{x}_c^\\ell, \\mathbf{y}_j; k) = w \\cdot \\left( -\\frac{i k}{4} H_1^{(1)}\\!\\big(k \\|\\mathbf{x}_c^\\ell-\\mathbf{y}_j\\|\\big)\\,\\frac{(\\mathbf{y}_j-\\mathbf{x}_c^\\ell)\\cdot \\mathbf{n}_\\Gamma(\\mathbf{y}_j)}{\\|\\mathbf{x}_c^\\ell-\\mathbf{y}_j\\|} \\right).$$\n增广矩阵是一个$(N+Q) \\times N$的矩形矩阵，由$A(k)$和$C_{\\mathrm{int}}(k)$堆叠而成：\n$$A_{\\mathrm{aug}}(k) = \\begin{bmatrix} A(k) \\\\ C_{\\mathrm{int}}(k) \\end{bmatrix}.$$\n\n**4. 条件数计算**\n我们在三个波数下计算条件数：一个非共振情况$k=2.0\\,\\mathrm{m}^{-1}$，一个近共振情况$k=k_1-0.01$，以及一个精确共振情况$k=k_1$。\n对于方阵$A(k)$和$A_{\\mathrm{BM}}(k,1)$，2-范数条件数为$\\kappa_2(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$，其中$\\sigma$是$M$的奇异值。对于矩形矩阵$A_{\\mathrm{aug}}(k)$，伪条件数同样定义为其最大奇异值与最小奇异值之比。\n在共振波数$k=k_1$处，算子$\\frac{1}{2}I+D(k)$具有非平凡的零空间，这表现为其离散化形式$A(k)$的一个极大条件数。Burton-Miller 和 CHIEF 公式都旨在通过创建在所有波数下都良态的系统来修正此问题。计算将验证此行为。",
            "answer": "[[2.40482556, 3.83170597, 5.1356223, 5.52007811, 7.01558667], [3.87853, 2.87114, 4.09841], [34.00424, 3.12502, 34.12001], [7.3400117e+15, 3.12745, 35.7984]]"
        }
    ]
}