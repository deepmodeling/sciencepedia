{
    "hands_on_practices": [
        {
            "introduction": "To bridge the gap between theory and application, our first practice focuses on a crucial question for any numerical simulation of waves: what grid resolution is required for a given accuracy? This exercise will guide you through calculating the minimum points-per-wavelength ($\\lambda/h$) needed to keep the phase speed error of a widely used 7-point, 6th-order finite-difference scheme below a specific tolerance. Completing this practice will build a tangible understanding of the relationship between numerical dispersion, accuracy, and computational cost, a fundamental trade-off in computational acoustics .",
            "id": "4120627",
            "problem": "Consider one-dimensional small-amplitude acoustic propagation in a uniform, inviscid medium of sound speed $c$, governed by the linear acoustic equations\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \n\\qquad \n\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0,\n$$\nwhere $p(x,t)$ is the acoustic pressure, $u(x,t)$ is the particle velocity, and $\\rho_{0}$ is the mean density. For a plane-wave solution of the form $p(x,t) = \\hat{p} \\exp\\!\\big(i(k x - \\omega t)\\big)$, the continuous dispersion relation implies the true phase speed $c_{\\text{true}} = \\omega/k = c$.\n\nA standard 6th-order finite-difference spatial discretization uses a symmetric $7$-point centered stencil to approximate $\\partial/\\partial x$ on a uniform grid of spacing $h$:\n$$\n\\left.\\frac{\\partial q}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{h}\\Big(a_{1}\\big(q_{i+1}-q_{i-1}\\big) + a_{2}\\big(q_{i+2}-q_{i-2}\\big) + a_{3}\\big(q_{i+3}-q_{i-3}\\big)\\Big),\n$$\nwith coefficients $a_{1} = \\frac{3}{4}$, $a_{2} = -\\frac{3}{20}$, $a_{3} = \\frac{1}{60}$, which result from a Taylor series expansion to achieve 6th-order accuracy. Assume time integration is exact (semi-discrete analysis), so that the numerical phase speed arises solely from the spatial operator.\n\nDefine the phase speed error as the relative deviation of the numerical phase speed from the true phase speed, namely $\\big|c_{\\text{num}}/c_{\\text{true}} - 1\\big|$. For a plane wave at frequency $f$ with wavelength $\\lambda = c/f$, the nondimensional wavenumber is $\\kappa = k h = \\frac{2\\pi}{\\lambda/h}$. The numerical phase speed ratio $c_{\\text{num}}/c_{\\text{true}}$ equals the ratio of the modified wavenumber $k^{\\ast}$ to the true wavenumber $k$.\n\nGiven $c = 343\\,\\mathrm{m/s}$ and $f = 3\\,\\mathrm{kHz}$, determine the minimal points-per-wavelength $\\lambda/h$ required so that the phase speed error does not exceed $0.5$ percent, interpreted as a decimal tolerance of $0.005$. Use radian measure for all trigonometric arguments and report the smallest integer value of $\\lambda/h$ that satisfies the error bound. No rounding by significant figures is necessary because the requested quantity is an integer.",
            "solution": "The problem is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n### Step 1: Extract Givens\n- Governing equations: $\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0$, $\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0$.\n- Plane-wave solution: $p(x,t) = \\hat{p} \\exp(i(k x - \\omega t))$.\n- True phase speed: $c_{\\text{true}} = \\omega/k = c$.\n- Spatial derivative approximation (7-point centered stencil):\n$$\n\\left.\\frac{\\partial q}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{h}\\Big(a_{1}(q_{i+1}-q_{i-1}) + a_{2}(q_{i+2}-q_{i-2}) + a_{3}(q_{i+3}-q_{i-3})\\Big)\n$$\n- Stencil coefficients: $a_{1} = \\frac{3}{4}$, $a_{2} = -\\frac{3}{20}$, $a_{3} = \\frac{1}{60}$.\n- Time integration is exact (semi-discrete analysis).\n- Phase speed error definition: $\\big|c_{\\text{num}}/c_{\\text{true}} - 1\\big|$.\n- Nondimensional wavenumber: $\\kappa = k h = \\frac{2\\pi}{\\lambda/h}$.\n- Numerical phase speed ratio: $c_{\\text{num}}/c_{\\text{true}} = k^{\\ast}/k$.\n- Physical constants: $c = 343\\,\\mathrm{m/s}$, $f = 3\\,\\mathrm{kHz}$.\n- Error tolerance: The phase speed error must not exceed $0.5\\%$, which is a decimal tolerance of $0.005$.\n- Objective: Find the minimal integer value of points-per-wavelength, $\\lambda/h$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the standard linear acoustic wave equations and uses the well-established method of Fourier analysis (von Neumann analysis) to assess the dispersive properties of a finite-difference scheme. The specific 7-point stencil coefficients are from the seminal paper on Dispersion-Relation-Preserving (DRP) schemes by Tam and Webb (1993), a cornerstone in computational acoustics. The problem is scientifically and mathematically sound.\n2.  **Well-Posed**: All necessary information is provided. The definitions of error, wavenumber, and the numerical operator are precise. The objective is clearly stated. The existence of a unique, minimal integer solution is expected.\n3.  **Objective**: The language is precise and free of subjectivity.\n4.  **Consistency**: The givens are consistent. The provided values $c=343\\,\\mathrm{m/s}$ and $f=3\\,\\mathrm{kHz}$ are for physical context but, as will be shown, are not required to determine the dimensionless quantity $\\lambda/h$, which makes the problem a general one about the numerical scheme's properties. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be constructed.\n\n### Solution Derivation\n\nThe semi-discrete analysis begins by applying the finite-difference spatial operator to a single Fourier mode, $q_j = \\hat{q} \\exp(i(kx_j - \\omega t))$, where $x_j = j h$ is the coordinate of the $j$-th grid point and $h$ is the uniform grid spacing. The exact spatial derivative of this mode is $\\frac{\\partial q}{\\partial x} = ikq$. The finite-difference operator transforms this into a numerical approximation, effectively replacing $ik$ with a term $ik^*$, where $k^*$ is the modified wavenumber.\n\nLet's apply the given 7-point stencil to $q_j$:\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{1}{h} \\sum_{m=1}^{3} a_m (q_{j+m} - q_{j-m})\n$$\nSubstituting $q_{j \\pm m} = \\hat{q} \\exp(i(k(j \\pm m)h - \\omega t)) = q_j \\exp(\\pm i k m h)$:\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{q_j}{h} \\sum_{m=1}^{3} a_m (\\exp(i m k h) - \\exp(-i m k h))\n$$\nUsing Euler's formula, $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$, we get:\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{q_j}{h} \\sum_{m=1}^{3} a_m (2i \\sin(m k h)) = i \\left( \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(m k h) \\right) q_j\n$$\nBy comparing this to the exact derivative $ikq_j$, we identify the modified wavenumber $k^*$:\n$$\nk^* = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(m k h)\n$$\nThe problem defines the non-dimensional wavenumber as $\\kappa = kh$. Multiplying the above equation by $h$ gives the non-dimensional modified wavenumber, $\\kappa^* = k^*h$:\n$$\n\\kappa^* = 2a_1\\sin(\\kappa) + 2a_2\\sin(2\\kappa) + 2a_3\\sin(3\\kappa)\n$$\nThe ratio of the numerical to the true phase speed is given as $c_{\\text{num}}/c_{\\text{true}} = k^*/k$. This can be written in terms of non-dimensional quantities:\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{k^*h}{kh} = \\frac{\\kappa^*}{\\kappa}\n$$\nSubstituting the expression for $\\kappa^*$ and the given coefficients $a_1=\\frac{3}{4}$, $a_2=-\\frac{3}{20}$, $a_3=\\frac{1}{60}$:\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{1}{\\kappa} \\left( 2\\left(\\frac{3}{4}\\right)\\sin(\\kappa) + 2\\left(-\\frac{3}{20}\\right)\\sin(2\\kappa) + 2\\left(\\frac{1}{60}\\right)\\sin(3\\kappa) \\right)\n$$\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{1}{\\kappa} \\left( \\frac{3}{2}\\sin(\\kappa) - \\frac{3}{10}\\sin(2\\kappa) + \\frac{1}{30}\\sin(3\\kappa) \\right)\n$$\nLet's denote this phase speed ratio as $R(\\kappa)$. The problem requires the phase speed error to be no more than $0.5\\%$:\n$$\n\\left| \\frac{c_{\\text{num}}}{c_{\\text{true}}} - 1 \\right| \\le 0.005 \\quad \\implies \\quad 0.995 \\le R(\\kappa) \\le 1.005\n$$\nThis specific DRP scheme is designed such that for the range of useful wavenumbers, the numerical phase speed is less than or equal to the true phase speed, i.e., $R(\\kappa) \\le 1$. Thus, the error condition simplifies to:\n$$\nR(\\kappa) \\ge 0.995\n$$\nThe non-dimensional wavenumber $\\kappa$ is related to the points-per-wavelength, $N = \\lambda/h$, by:\n$$\n\\kappa = kh = \\frac{2\\pi}{\\lambda}h = \\frac{2\\pi}{\\lambda/h} = \\frac{2\\pi}{N}\n$$\nWe need to find the smallest integer $N$ that satisfies $R(2\\pi/N) \\ge 0.995$. As $N$ increases, $\\kappa$ decreases towards $0$, and $R(\\kappa)$ approaches $1$. We need to test integer values of $N$ to find the cutoff.\n\nLet's test $N = 6$:\nFor $N=6$, $\\kappa = \\frac{2\\pi}{6} = \\frac{\\pi}{3}$.\n$$\nR\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{\\pi/3} \\left( \\frac{3}{2}\\sin\\left(\\frac{\\pi}{3}\\right) - \\frac{3}{10}\\sin\\left(\\frac{2\\pi}{3}\\right) + \\frac{1}{30}\\sin(\\pi) \\right)\n$$\nWe know $\\sin(\\pi/3) = \\frac{\\sqrt{3}}{2}$, $\\sin(2\\pi/3) = \\frac{\\sqrt{3}}{2}$, and $\\sin(\\pi) = 0$.\n$$\nR\\left(\\frac{\\pi}{3}\\right) = \\frac{3}{\\pi} \\left( \\frac{3}{2} \\cdot \\frac{\\sqrt{3}}{2} - \\frac{3}{10} \\cdot \\frac{\\sqrt{3}}{2} + 0 \\right) = \\frac{3}{\\pi} \\left( \\frac{3\\sqrt{3}}{4} - \\frac{3\\sqrt{3}}{20} \\right) = \\frac{3}{\\pi} \\left( \\frac{15\\sqrt{3} - 3\\sqrt{3}}{20} \\right)\n$$\n$$\nR\\left(\\frac{\\pi}{3}\\right) = \\frac{3}{\\pi} \\frac{12\\sqrt{3}}{20} = \\frac{36\\sqrt{3}}{20\\pi} = \\frac{9\\sqrt{3}}{5\\pi}\n$$\nNumerically, $R\\left(\\frac{\\pi}{3}\\right) \\approx \\frac{9 \\times 1.73205}{5 \\times 3.14159} \\approx \\frac{15.58845}{15.70795} \\approx 0.99239$.\nThe value $0.99239$ is less than $0.995$. Therefore, $N=6$ is not sufficient.\n\nLet's test $N = 7$:\nFor $N=7$, $\\kappa = \\frac{2\\pi}{7}$.\n$$\nR\\left(\\frac{2\\pi}{7}\\right) = \\frac{7}{2\\pi} \\left( \\frac{3}{2}\\sin\\left(\\frac{2\\pi}{7}\\right) - \\frac{3}{10}\\sin\\left(\\frac{4\\pi}{7}\\right) + \\frac{1}{30}\\sin\\left(\\frac{6\\pi}{7}\\right) \\right)\n$$\nUsing radian mode on a calculator:\n$\\sin(2\\pi/7) \\approx 0.781831$\n$\\sin(4\\pi/7) \\approx 0.974928$\n$\\sin(6\\pi/7) = \\sin(\\pi - \\pi/7) = \\sin(\\pi/7) \\approx 0.433884$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{7}{2\\pi} \\left( \\frac{3}{2}(0.781831) - \\frac{3}{10}(0.974928) + \\frac{1}{30}(0.433884) \\right)\n$$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{7}{2\\pi} (1.172747 - 0.292478 + 0.014463) = \\frac{7}{2\\pi} (0.894732)\n$$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{6.263124}{2\\pi} \\approx 0.99684\n$$\nThe value $0.99684$ is greater than $0.995$. Therefore, $N=7$ is sufficient to keep the phase speed error below $0.5\\%$.\nSince $N=6$ was insufficient and $N=7$ is sufficient, the minimal integer value for the points-per-wavelength is $7$. The given values of $c=343\\,\\mathrm{m/s}$ and $f=3\\,\\mathrm{kHz}$ are consistent with a real-world scenario but are not needed for the calculation of the dimensionless ratio $\\lambda/h$.",
            "answer": "$$\n\\boxed{7}\n$$"
        },
        {
            "introduction": "Not all high-order numerical schemes are created equal, especially when it comes to wave propagation. This practice is a comparative study designed to highlight the unique properties of DRP stencils against traditional finite-difference schemes derived from Taylor series expansions . By directly comparing the modified wavenumber of an optimized DRP stencil with that of a standard 6th-order stencil, you will quantitatively see how the DRP design maintains accuracy over a much broader range of wavenumbers, providing clear insight into why these schemes are superior for broadband wave simulations.",
            "id": "4120595",
            "problem": "Consider the plane-wave analysis framework used in computational acoustics for designing numerical spatial-differencing operators that preserve the dispersion relation of linear wave propagation. A Dispersion-Relation-Preserving (DRP) scheme is a finite-difference discretization whose discrete spatial operator yields a modified wavenumber that closely matches the exact continuous wavenumber over a broad range of nondimensional wavenumbers.\n\nStart from the following fundamental base: a one-dimensional spatial derivative approximation applied to a discrete grid function $u_j = u(x_j)$ on a uniform grid with spacing $h$ can be written using a centered, antisymmetric stencil as\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_j} \\approx \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left(u_{j+m} - u_{j-m}\\right),\n$$\nwhere $a_m$ are constant stencil coefficients and $M$ is the half-width of the stencil. For a spatial Fourier mode $u(x) = e^{i k x}$ with wavenumber $k$, the action of a linear, constant-coefficient, shift-invariant stencil can be characterized by a modified wavenumber $k_{\\text{eff}}(k)$ defined through the discrete symbol. The dimensionless quantity $\\hat{k}(\\theta)$ with $\\theta \\equiv k h$ is used to compare numerical dispersion to the exact relation, where the exact continuous behavior corresponds to $\\hat{k}(\\theta) = \\theta$.\n\nIn this problem, you will compare two specific centered antisymmetric stencils for the first derivative:\n- An optimized $7$-point Dispersion-Relation-Preserving (DRP) stencil, with half-width $M = 3$ and coefficients $a_1 = 0.77088238$, $a_2 = -0.16670590$, $a_3 = 0.02084314$, chosen so that the leading consistency condition $\\sum_{m=1}^{3} m\\,a_m = 1/2$ is satisfied and the numerical dispersion is optimized over a practical range of $\\theta$.\n- A standard $6$th-order centered difference stencil for the first derivative, with half-width $M = 3$ and coefficients $a_1 = 3/4$, $a_2 = -3/20$, $a_3 = 1/60$, which satisfy $\\sum_{m=1}^{3} m\\,a_m = 1/2$ and yield a truncation error of order $O(h^6)$.\n\nYour tasks:\n1. Using the plane-wave ansatz $u_j = e^{i k x_j}$ and the definition of the discrete symbol for linear shift-invariant operators, derive the expression for the dimensionless modified wavenumber $\\hat{k}(\\theta)$ as a function of $\\theta$ and the stencil coefficients $a_m$ for a centered antisymmetric stencil. Do not assume any pre-existing formula for $\\hat{k}(\\theta)$; derive it from first principles by applying the stencil to $u_j = e^{i k x_j}$.\n2. Implement a program that, for each stencil, evaluates the dimensionless modified wavenumber $\\hat{k}(\\theta)$ over the range $\\theta \\in [0,\\pi/2]$, with $\\theta$ measured in radians.\n3. Compute and report the maximum absolute deviation between the two modified wavenumbers over $\\theta \\in [0,\\pi/2]$, that is $\\max_{\\theta \\in [0,\\pi/2]} \\left|\\hat{k}_{\\text{DRP}}(\\theta) - \\hat{k}_{\\text{CD6}}(\\theta)\\right|$, and the value of $\\theta$ (in radians) at which this maximum occurs.\n\nAngle units must be in radians. All numerical outputs must be rounded to six decimal places.\n\nTest suite and required outputs:\n- Use three test cases, each defined by the number of uniformly spaced sample points $N$ used to discretize $\\theta \\in [0,\\pi/2]$:\n  1. $N = 10001$ (a high-resolution \"happy path\" case).\n  2. $N = 101$ (a moderate-resolution boundary case).\n  3. $N = 2$ (an edge case that samples only the endpoints).\n- For each test case, evaluate the two modified wavenumber curves on the specified grid of $\\theta$ values, compute the maximum absolute deviation and the corresponding $\\theta$ location, and return these two values.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list in the order $[\\text{max\\_deviation}, \\theta_{\\text{at\\_max}}]$. For example, an output with three test cases must look like\n$$\n[[x_1,y_1],[x_2,y_2],[x_3,y_3]]\n$$\nwith no spaces, where $x_i$ and $y_i$ are floats rounded to six decimal places.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained, thus it is deemed valid. We proceed with a step-by-step solution.\n\n### Part 1: Derivation of the Dimensionless Modified Wavenumber\n\nThe primary task is to derive the expression for the dimensionless modified wavenumber, $\\hat{k}(\\theta)$, for a general centered, antisymmetric finite-difference stencil.\n\nThe stencil approximates the first spatial derivative of a function $u(x)$ at a grid point $x_j$ as:\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_j} \\approx \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left(u_{j+m} - u_{j-m}\\right)\n$$\nHere, $u_j = u(x_j)$, $h$ is the uniform grid spacing, $a_m$ are stencil coefficients, and $M$ is the stencil half-width. This numerical operator, let us denote it $D_h$, is linear and shift-invariant.\n\nTo analyze its behavior in the Fourier domain, we apply the operator to a single spatial Fourier mode, also known as a plane wave. This is the plane-wave ansatz:\n$$\nu(x) = e^{i k x}\n$$\nwhere $k$ is the continuous wavenumber and $i = \\sqrt{-1}$. On the discrete grid where $x_j = j h$, the function is represented as:\n$$\nu_j = e^{i k x_j} = e^{i k j h}\n$$\nThe values at neighboring grid points $x_{j \\pm m} = (j \\pm m)h$ are:\n$$\nu_{j+m} = e^{i k (j+m)h} = e^{i k j h} e^{i m k h} = u_j e^{i m k h}\n$$\n$$\nu_{j-m} = e^{i k (j-m)h} = e^{i k j h} e^{-i m k h} = u_j e^{-i m k h}\n$$\nThe difference term in the stencil sum becomes:\n$$\nu_{j+m} - u_{j-m} = u_j e^{i m k h} - u_j e^{-i m k h} = u_j \\left(e^{i m k h} - e^{-i m k h}\\right)\n$$\nUsing Euler's formula, which states $e^{i\\phi} - e^{-i\\phi} = 2i \\sin(\\phi)$, we can simplify this difference:\n$$\nu_{j+m} - u_{j-m} = u_j \\cdot 2i \\sin(m k h)\n$$\nSubstituting this back into the stencil formula, we find the action of the numerical operator $D_h$ on the plane wave $u_j$:\n$$\nD_h[u_j] = \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left( u_j \\cdot 2i \\sin(m k h) \\right)\n$$\nSince $u_j$ and $i$ do not depend on the summation index $m$, we can factor them out:\n$$\nD_h[u_j] = \\left( \\frac{2i}{h} \\sum_{m=1}^{M} a_m \\sin(m k h) \\right) u_j\n$$\nThe exact continuous derivative of the plane wave $u(x)=e^{ikx}$ is:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} (e^{i k x}) = i k e^{i k x} = (i k) u(x)\n$$\nBy analogy, the action of the discrete operator $D_h$ on the discrete plane wave $u_j$ defines the modified wavenumber, $k_{\\text{eff}}$, as the scalar that satisfies:\n$$\nD_h[u_j] = (i k_{\\text{eff}}) u_j\n$$\nBy equating our two expressions for $D_h[u_j]$, we get:\n$$\n(i k_{\\text{eff}}) u_j = \\left( \\frac{2i}{h} \\sum_{m=1}^{M} a_m \\sin(m k h) \\right) u_j\n$$\nCanceling the common factor $i u_j$ from both sides yields the expression for the modified wavenumber:\n$$\nk_{\\text{eff}} = \\frac{2}{h} \\sum_{m=1}^{M} a_m \\sin(m k h)\n$$\nTo obtain the dimensionless form, we introduce the dimensionless wavenumber $\\theta = k h$ and define the dimensionless modified wavenumber as $\\hat{k}(\\theta) = k_{\\text{eff}} h$. We multiply the equation for $k_{\\text{eff}}$ by $h$:\n$$\nk_{\\text{eff}} h = 2 \\sum_{m=1}^{M} a_m \\sin(m (k h))\n$$\nSubstituting the dimensionless variables, we arrive at the final derived expression:\n$$\n\\hat{k}(\\theta) = 2 \\sum_{m=1}^{M} a_m \\sin(m \\theta)\n$$\nThis formula relates the effective numerical dispersion $\\hat{k}(\\theta)$ to the ideal dispersion $\\hat{k}(\\theta)=\\theta$ via the stencil coefficients $a_m$.\n\n### Part 2  3: Numerical Computation and Comparison\n\nThe next step is to implement this formula for the two given stencils and compute the maximum absolute deviation between their respective modified wavenumbers over the interval $\\theta \\in [0, \\pi/2]$.\n\nThe coefficients for the stencils are:\n1.  **7-point DRP stencil ($M=3$):**\n    $a_1 = 0.77088238$\n    $a_2 = -0.16670590$\n    $a_3 = 0.02084314$\n2.  **6th-order Centered Difference (CD6) stencil ($M=3$):**\n    $a_1 = 3/4 = 0.75$\n    $a_2 = -3/20 = -0.15$\n    $a_3 = 1/60 \\approx 0.01666667$\n\nFor each test case defined by $N$ (the number of sample points), we will perform the following steps:\n1.  Create a uniform grid of $N$ points for $\\theta$ in the range $[0, \\pi/2]$.\n2.  For each $\\theta$ on this grid, calculate $\\hat{k}_{\\text{DRP}}(\\theta)$ using the DRP coefficients and the derived formula.\n3.  Similarly, calculate $\\hat{k}_{\\text{CD6}}(\\theta)$ using the CD6 coefficients.\n4.  Compute the absolute difference $|\\hat{k}_{\\text{DRP}}(\\theta) - \\hat{k}_{\\text{CD6}}(\\theta)|$ for all points on the grid.\n5.  Find the maximum value of this difference and the corresponding value of $\\theta$ at which it occurs.\n6.  The results for each test case, $[\\text{max\\_deviation}, \\theta_{\\text{at\\_max}}]$, will be collected and formatted as specified.\n\nThe computational logic will be encapsulated in a Python script utilizing the `numpy` library for efficient vectorized calculations.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing DRP and CD6 finite difference schemes.\n    \n    This function performs the following steps:\n    1. Defines the coefficients for the 7-point DRP and 6th-order centered\n       difference (CD6) stencils.\n    2. Defines the test cases based on the number of sample points N.\n    3. Implements a vectorized function to calculate the dimensionless \n       modified wavenumber for a given set of coefficients and theta values.\n    4. Iterates through each test case:\n       a. Creates a grid of theta values.\n       b. Computes the modified wavenumbers for both DRP and CD6 schemes.\n       c. Calculates the absolute difference between the two.\n       d. Finds the maximum deviation and the theta at which it occurs.\n    5. Formats and prints the final results as specified in the problem statement.\n    \"\"\"\n\n    # Stencil coefficients for M=3\n    # 7-point Dispersion-Relation-Preserving (DRP) stencil\n    coeffs_drp = np.array([0.77088238, -0.16670590, 0.02084314])\n    \n    # 6th-order Centered Difference (CD6) stencil\n    coeffs_cd6 = np.array([3.0/4.0, -3.0/20.0, 1.0/60.0])\n\n    # Test cases defined by the number of sample points N\n    test_cases = [10001, 101, 2]\n\n    results = []\n\n    def calculate_k_hat(theta_grid, coeffs):\n        \"\"\"\n        Calculates the dimensionless modified wavenumber k_hat(theta).\n        Formula: k_hat(theta) = 2 * sum_{m=1 to M} a_m * sin(m*theta)\n        \n        Args:\n            theta_grid (np.ndarray): An array of dimensionless wavenumbers theta.\n            coeffs (np.ndarray): The stencil coefficients [a_1, a_2, ..., a_M].\n\n        Returns:\n            np.ndarray: An array of k_hat values corresponding to the theta_grid.\n        \"\"\"\n        M = len(coeffs)\n        m_vals = np.arange(1, M + 1)\n        \n        # Create a matrix of m*theta values where rows correspond to theta\n        # and columns correspond to m.\n        m_theta_matrix = np.outer(theta_grid, m_vals)\n        \n        # Apply sin function element-wise\n        sin_matrix = np.sin(m_theta_matrix)\n        \n        # Compute the sum via matrix-vector multiplication\n        # (N, M) @ (M,) - (N,)\n        k_hat_values = 2 * (sin_matrix @ coeffs)\n        return k_hat_values\n\n    for n_points in test_cases:\n        # Create a uniform grid for theta in the range [0, pi/2]\n        theta_grid = np.linspace(0, np.pi/2, n_points)\n        \n        # Calculate the modified wavenumbers for both schemes\n        k_hat_drp = calculate_k_hat(theta_grid, coeffs_drp)\n        k_hat_cd6 = calculate_k_hat(theta_grid, coeffs_cd6)\n        \n        # Compute the absolute difference\n        abs_deviation = np.abs(k_hat_drp - k_hat_cd6)\n        \n        # Find the index of the maximum deviation\n        max_dev_index = np.argmax(abs_deviation)\n        \n        # Get the maximum deviation and the theta at which it occurs\n        max_dev = abs_deviation[max_dev_index]\n        theta_at_max = theta_grid[max_dev_index]\n        \n        results.append([max_dev, theta_at_max])\n\n    # Format the final output string exactly as required\n    formatted_results = []\n    for res_pair in results:\n        max_dev, theta_val = res_pair\n        # Format each number to 6 decimal places and create a string like \"[x.xxxxxx,y.yyyyyy]\"\n        formatted_pair = f\"[{max_dev:.6f},{theta_val:.6f}]\"\n        formatted_results.append(formatted_pair)\n        \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Having analyzed and compared existing DRP schemes, this final practice takes you a step further: into the design process itself. This exercise demystifies the origin of DRP stencil coefficients by formulating their derivation as a constrained least-squares optimization problem, a cornerstone of modern scheme design . By setting up and solving the system to find the optimal coefficients, you will gain a deep, first-hand appreciation for the mathematical principles that enable DRP schemes to so effectively preserve the physical dispersion relation of waves.",
            "id": "4120633",
            "problem": "Consider the one-dimensional linear acoustic advection equation $\\,\\partial u / \\partial t + c\\, \\partial u / \\partial x = 0\\,$ with plane-wave solutions $\\,u(x,t) = \\exp\\!\\left(i(k x - \\omega t)\\right)\\,$ that satisfy the dispersion relation $\\,\\omega = c\\,k\\,$. In computational acoustics, Dispersion-Relation-Preserving (DRP) schemes aim to design spatial finite-difference operators whose plane-wave response reproduces the continuous dispersion relation over a target wavenumber band. For a centered finite-difference approximation of the first spatial derivative on a uniform grid with spacing $\\,h\\,$, consider a $\\,7\\,$-point stencil of the form\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{h}\\sum_{m=-3}^{3} a_m\\, u_{i+m},\n$$\nwith $\\,a_0 = 0\\,$ and antisymmetry $\\,a_{-m} = - a_m\\,$ so that the operator represents a first derivative. When applied to a plane wave $\\,u_i = \\exp(i\\,k\\,h\\,i)\\,$, the discrete operator produces a modified wavenumber $\\,\\widehat{k}\\,$ defined by\n$$\n\\frac{1}{h}\\sum_{m=-3}^{3} a_m\\, \\exp(i\\,m\\,k\\,h) = i\\,\\widehat{k},\n$$\nwhich, under the antisymmetry constraint, reduces to the dimensionless relation\n$$\n\\widehat{k}\\,h = 2\\sum_{m=1}^{3} a_m\\, \\sin(m\\,\\theta), \\quad \\text{with } \\theta = k\\,h.\n$$\nTo enforce consistency with the continuous derivative near $\\,\\theta = 0\\,$, require the Taylor-series slope condition\n$$\n2\\sum_{m=1}^{3} m\\,a_m = 1,\n$$\nwhich ensures $\\,\\widehat{k}\\,h \\approx \\theta\\,$ for small $\\,\\theta\\,$. Design the stencil to be Dispersion-Relation-Preserving over the target band $\\,0 \\le \\theta \\le \\theta_{\\max}\\,$ by selecting coefficients $\\,a_1,a_2,a_3\\,$ that minimize the discrete least-squares error\n$$\nJ(a_1,a_2,a_3) = \\sum_{i=1}^{N} \\left( 2\\sum_{m=1}^{3} a_m\\, \\sin(m\\,\\theta_i) - \\theta_i \\right)^2,\n$$\nwhere the grid $\\,\\{\\theta_i\\}_{i=1}^{N}\\,$ is uniformly spaced in the interval $\\,\\left[0,\\ \\theta_{\\max}\\right]\\,$ with $\\,\\theta_{\\max} = k_{\\max} h = \\pi/2\\,$, and angles must be treated in radians. Formulate and solve the constrained least-squares problem\n$$\n\\min_{a_1,a_2,a_3} J(a_1,a_2,a_3) \\quad \\text{subject to} \\quad \\sum_{m=1}^{3} m\\,a_m = \\tfrac{1}{2}.\n$$\nUse the normal-equations form with a single linear equality constraint, or equivalently the Karush–Kuhn–Tucker (KKT) saddle-point system, to obtain the optimal coefficients $\\,a_1,a_2,a_3\\,$. Finally, report the complete $\\,7\\,$-point stencil coefficients $\\,\\left[a_{-3},a_{-2},a_{-1},a_0,a_1,a_2,a_3\\right]\\,$ with $\\,a_{-m} = -a_m\\,$ and $\\,a_0 = 0\\,$, and also compute the root-mean-square dispersion error over the same grid (excluding $\\,\\theta = 0\\,$), defined as\n$$\n\\varepsilon_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N'} \\sum_{\\theta_i \\in (0,\\theta_{\\max}]} \\left( \\frac{\\widehat{k}\\,h - \\theta_i}{\\theta_i} \\right)^2 },\n$$\nwhere $\\,N'\\,$ is the number of grid points with $\\,\\theta_i > 0\\,$. All angles must be in radians.\n\nYour program must implement the constrained least-squares solution for several values of $\\,N\\,$ to assess the dependence of the optimal coefficients on the grid resolution used in the design. Use the following test suite for $\\,N\\,$:\n- $\\,N = 33\\,$,\n- $\\,N = 65\\,$,\n- $\\,N = 129\\,$,\n- $\\,N = 5\\,$ (edge case with very coarse design grid).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of this list should itself be a list of $\\,8\\,$ floats of the form $\\,\\left[a_{-3},a_{-2},a_{-1},a_0,a_1,a_2,a_3,\\varepsilon_{\\mathrm{rms}}\\right]\\,$ corresponding to one test case in the order listed above. Angles must be in radians, and no physical units are required for the coefficients or errors. The output must be of the form\n$$\n\\left[ [a_{-3},a_{-2},a_{-1},a_0,a_1,a_2,a_3,\\varepsilon_{\\mathrm{rms}}]_{N=33},\\ [\\cdots]_{N=65},\\ [\\cdots]_{N=129},\\ [\\cdots]_{N=5} \\right],\n$$\nprinted as a single line using standard numeric formatting.",
            "solution": "The problem requires the design of a $7$-point finite-difference stencil for the first spatial derivative, optimized to preserve the dispersion relation of the one-dimensional acoustic advection equation over a specified range of wavenumbers. This is formulated as a constrained linear least-squares problem.\n\nThe objective is to find the coefficients $a_1, a_2, a_3$ that minimize the discrete least-squares error function $J$:\n$$\n\\min_{a_1,a_2,a_3} J(a_1,a_2,a_3) = \\sum_{i=1}^{N} \\left( 2\\sum_{m=1}^{3} a_m \\sin(m \\theta_i) - \\theta_i \\right)^2\n$$\nsubject to the linear equality constraint that ensures consistency with the continuous first derivative for low wavenumbers:\n$$\n\\sum_{m=1}^{3} m a_m = \\frac{1}{2}\n$$\nThe optimization is performed over a discrete grid of dimensionless wavenumbers $\\theta_i = k_i h$, uniformly spaced in the interval $[0, \\theta_{\\max}]$, where $\\theta_{\\max} = \\pi/2$ and $N$ is the number of grid points.\n\nThis problem can be expressed in matrix form. Let the vector of unknown coefficients be $\\mathbf{a} = [a_1, a_2, a_3]^T$. The problem is to minimize $\\|\\mathbf{A}\\mathbf{a} - \\mathbf{b}\\|_2^2$ subject to $\\mathbf{C}\\mathbf{a} = d$.\nThe components of the matrix $\\mathbf{A}$, vector $\\mathbf{b}$, constraint matrix $\\mathbf{C}$, and constraint value $d$ are defined as follows:\n- $\\mathbf{A}$ is an $N \\times 3$ matrix with elements $A_{im} = 2 \\sin(m \\theta_i)$, where $i \\in \\{1, \\dots, N\\}$ and $m \\in \\{1, 2, 3\\}$.\n- $\\mathbf{b}$ is an $N \\times 1$ vector with elements $b_i = \\theta_i$.\n- $\\mathbf{C}$ is a $1 \\times 3$ row vector, $\\mathbf{C} = [1, 2, 3]$.\n- $d$ is a scalar, $d = 1/2$.\n\nThe problem is solved using the method of Lagrange multipliers, which leads to the Karush–Kuhn–Tucker (KKT) conditions. The Lagrangian $\\mathcal{L}$ for this constrained optimization problem is:\n$$\n\\mathcal{L}(\\mathbf{a}, \\lambda) = (\\mathbf{A}\\mathbf{a} - \\mathbf{b})^T (\\mathbf{A}\\mathbf{a} - \\mathbf{b}) + \\lambda (\\mathbf{C}\\mathbf{a} - d)\n$$\nwhere $\\lambda$ is the Lagrange multiplier associated with the equality constraint. To find the optimal solution, we set the gradients of $\\mathcal{L}$ with respect to $\\mathbf{a}$ and $\\lambda$ to zero:\n$$\n\\nabla_{\\mathbf{a}} \\mathcal{L} = 2\\mathbf{A}^T(\\mathbf{A}\\mathbf{a} - \\mathbf{b}) + \\mathbf{C}^T \\lambda = \\mathbf{0}\n$$\n$$\n\\nabla_{\\lambda} \\mathcal{L} = \\mathbf{C}\\mathbf{a} - d = 0\n$$\nRearranging these equations gives a system of linear equations for the augmented unknown vector $[\\mathbf{a}^T, \\lambda]^T$:\n$$\n2\\mathbf{A}^T\\mathbf{A}\\mathbf{a} + \\mathbf{C}^T\\lambda = 2\\mathbf{A}^T\\mathbf{b}\n$$\n$$\n\\mathbf{C}\\mathbf{a} = d\n$$\nThis is the KKT saddle-point system, which can be expressed in block matrix form as:\n$$\n\\begin{bmatrix}\n2\\mathbf{A}^T\\mathbf{A}  \\mathbf{C}^T \\\\\n\\mathbf{C}  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{a} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2\\mathbf{A}^T\\mathbf{b} \\\\\nd\n\\end{bmatrix}\n$$\nThis is a $(3+1) \\times (3+1) = 4 \\times 4$ linear system. For each specified value of $N$, we construct the grid $\\{\\theta_i\\}_{i=1}^N$, assemble the KKT matrix and the right-hand side vector, and solve for the vector of coefficients $\\mathbf{a} = [a_1, a_2, a_3]^T$.\n\nOnce the optimal coefficients $a_1, a_2, a_3$ are found, the complete $7$-point stencil is constructed using the given constraints $a_0 = 0$ and $a_{-m} = -a_m$:\n$$\n[a_{-3}, a_{-2}, a_{-1}, a_0, a_1, a_2, a_3] = [-a_3, -a_2, -a_1, 0, a_1, a_2, a_3]\n$$\nFinally, the root-mean-square (RMS) dispersion error $\\varepsilon_{\\mathrm{rms}}$ is calculated over the design grid, excluding the point $\\theta = 0$:\n$$\n\\varepsilon_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N'} \\sum_{\\theta_i \\in (0,\\theta_{\\max}]} \\left( \\frac{\\widehat{k_i}h - \\theta_i}{\\theta_i} \\right)^2 }\n$$\nwhere $N' = N-1$ is the number of non-zero grid points, and $\\widehat{k_i}h$ is the dimensionless modified wavenumber for each $\\theta_i$:\n$$\n\\widehat{k_i}h = 2\\sum_{m=1}^{3} a_m \\sin(m \\theta_i)\n$$\nThis entire procedure is implemented for each value of $N$ provided in the test suite: $N=33, 65, 129, 5$.\nThe solution for $a_1, a_2, a_3$ converges as $N$ increases, since the discrete sums in the KKT matrix approach their continuous integral counterparts. The case $N=5$ serves as an example of using a very coarse grid for the optimization process, which is still mathematically well-posed as the number of equations ($5$ from the sum, $1$ from the constraint) exceeds the number of unknowns ($3$).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the constrained least-squares problem for DRP scheme coefficients\n    for a series of test cases and formats the output.\n    \"\"\"\n    test_cases = [33, 65, 129, 5]\n\n    results = []\n    for N in test_cases:\n        result = calculate_coeffs_and_error(N)\n        results.append(result)\n\n    # Format the final list of lists into the required string representation.\n    # The str() of a list is '[item1, item2, ...]', which is the desired format.\n    formatted_results = ','.join(map(str, results))\n    print(f\"[{formatted_results}]\")\n\ndef calculate_coeffs_and_error(N):\n    \"\"\"\n    Calculates the optimal DRP coefficients and RMS error for a given grid\n    resolution N.\n\n    Args:\n        N (int): The number of points in the design grid for theta.\n\n    Returns:\n        list: A list of 8 floats containing the 7 stencil coefficients\n              [a_{-3}, ..., a_3] and the RMS error.\n    \"\"\"\n    theta_max = np.pi / 2.0\n    # Create a uniform grid for theta from 0 to theta_max with N points.\n    theta = np.linspace(0, theta_max, N)\n\n    # Set up the linear least-squares problem: min ||Aa - b||^2\n    # A has shape (N, 3), b has shape (N,)\n    A = np.zeros((N, 3))\n    for m in range(1, 4):\n        # A_im = 2*sin(m*theta_i)\n        A[:, m-1] = 2.0 * np.sin(m * theta)\n    \n    b = theta\n\n    # Set up the linear constraint: Ca = d\n    # C has shape (1, 3), d is a scalar\n    C = np.array([1.0, 2.0, 3.0])\n    d = 0.5\n\n    # Assemble the KKT (Karush-Kuhn-Tucker) saddle-point system:\n    # [ 2*A^T*A   C^T ] [ a      ] = [ 2*A^T*b ]\n    # [ C         0   ] [ lambda ]   [ d       ]\n    # The system is 4x4.\n    \n    # Top-left block: 2 * A^T * A (3x3)\n    H = 2.0 * (A.T @ A)\n    \n    # Top-right block: C^T (3x1)\n    CT = C.reshape(3, 1)\n\n    # Build the 4x4 KKT matrix\n    KKT_mat = np.zeros((4, 4))\n    KKT_mat[0:3, 0:3] = H\n    KKT_mat[0:3, 3] = C\n    KKT_mat[3, 0:3] = C\n\n    # Build the 4x1 right-hand side vector\n    rhs = np.zeros(4)\n    # Top part: 2 * A^T * b\n    rhs[0:3] = 2.0 * (A.T @ b)\n    # Bottom part: d\n    rhs[3] = d\n\n    # Solve the KKT system for [a_1, a_2, a_3, lambda]\n    solution = np.linalg.solve(KKT_mat, rhs)\n    \n    # Extract the coefficients a_1, a_2, a_3\n    a = solution[0:3]\n    a1, a2, a3 = a[0], a[1], a[2]\n\n    # Construct the full 7-point stencil using antisymmetry a_{-m} = -a_m\n    # and a_0 = 0\n    stencil_coeffs = [-a3, -a2, -a1, 0.0, a1, a2, a3]\n\n    # Calculate the RMS dispersion error\n    # The error is calculated over the grid excluding theta = 0.\n    theta_nonzero = theta[1:]\n    N_prime = N - 1\n\n    if N_prime > 0:\n        # Modified wavenumber kh_hat = 2 * sum(a_m * sin(m*theta))\n        kh_hat_model = A[1:, :] @ a\n        \n        # Relative error: (kh_hat - theta) / theta\n        relative_error = (kh_hat_model - theta_nonzero) / theta_nonzero\n        \n        # RMS error: sqrt(mean of squared relative errors)\n        rms_error = np.sqrt(np.mean(relative_error**2))\n    else:\n        # Should not happen with N >= 2, but handle for robustness\n        rms_error = 0.0\n\n    # Combine stencil and error into a single list\n    final_result = stencil_coeffs + [rms_error]\n    \n    return final_result\n\nsolve()\n```"
        }
    ]
}