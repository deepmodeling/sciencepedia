{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a concrete starting point for understanding numerical dispersion. Before running a simulation, a crucial step is determining the necessary grid resolution to ensure accuracy. This problem  guides you through calculating the minimum points-per-wavelength (PPW) required to keep the phase speed error of a standard high-order stencil below a specific tolerance, a fundamental skill for any computational scientist.",
            "id": "4120627",
            "problem": "Consider one-dimensional small-amplitude acoustic propagation in a uniform, inviscid medium of sound speed $c$, governed by the linear acoustic equations\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \n\\qquad \n\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0,\n$$\nwhere $p(x,t)$ is the acoustic pressure, $u(x,t)$ is the particle velocity, and $\\rho_{0}$ is the mean density. For a plane-wave solution of the form $p(x,t) = \\hat{p} \\exp\\!\\big(i(k x - \\omega t)\\big)$, the continuous dispersion relation implies the true phase speed $c_{\\text{true}} = \\omega/k = c$.\n\nA standard sixth-order accurate finite-difference spatial discretization uses a symmetric $7$-point centered stencil to approximate $\\partial/\\partial x$ on a uniform grid of spacing $h$:\n$$\n\\left.\\frac{\\partial q}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{h}\\Big(a_{1}\\big(q_{i+1}-q_{i-1}\\big) + a_{2}\\big(q_{i+2}-q_{i-2}\\big) + a_{3}\\big(q_{i+3}-q_{i-3}\\big)\\Big),\n$$\nwith coefficients $a_{1} = \\frac{3}{4}$, $a_{2} = -\\frac{3}{20}$, $a_{3} = \\frac{1}{60}$, which define a standard sixth-order accurate scheme. Assume time integration is exact (semi-discrete analysis), so that the numerical phase speed arises solely from the spatial operator.\n\nDefine the phase speed error as the relative deviation of the numerical phase speed from the true phase speed, namely $\\big|c_{\\text{num}}/c_{\\text{true}} - 1\\big|$. For a plane wave at frequency $f$ with wavelength $\\lambda = c/f$, the nondimensional wavenumber is $\\kappa = k h = \\frac{2\\pi}{\\lambda/h}$. The numerical phase speed ratio $c_{\\text{num}}/c_{\\text{true}}$ equals the ratio of the modified wavenumber $k^{\\ast}$ to the true wavenumber $k$.\n\nGiven $c = 343\\,\\mathrm{m/s}$ and $f = 3\\,\\mathrm{kHz}$, determine the minimal points-per-wavelength $\\lambda/h$ required so that the phase speed error does not exceed $0.5$ percent, interpreted as a decimal tolerance of $0.005$. Use radian measure for all trigonometric arguments and report the smallest integer value of $\\lambda/h$ that satisfies the error bound. No rounding by significant figures is necessary because the requested quantity is an integer.",
            "solution": "The problem is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n### Step 1: Extract Givens\n- Governing equations: $\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0$, $\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0$.\n- Plane-wave solution: $p(x,t) = \\hat{p} \\exp(i(k x - \\omega t))$.\n- True phase speed: $c_{\\text{true}} = \\omega/k = c$.\n- Spatial derivative approximation (7-point centered stencil):\n$$\n\\left.\\frac{\\partial q}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{h}\\Big(a_{1}(q_{i+1}-q_{i-1}) + a_{2}(q_{i+2}-q_{i-2}) + a_{3}(q_{i+3}-q_{i-3})\\Big)\n$$\n- Stencil coefficients: $a_{1} = \\frac{3}{4}$, $a_{2} = -\\frac{3}{20}$, $a_{3} = \\frac{1}{60}$.\n- Time integration is exact (semi-discrete analysis).\n- Phase speed error definition: $\\big|c_{\\text{num}}/c_{\\text{true}} - 1\\big|$.\n- Nondimensional wavenumber: $\\kappa = k h = \\frac{2\\pi}{\\lambda/h}$.\n- Numerical phase speed ratio: $c_{\\text{num}}/c_{\\text{true}} = k^{\\ast}/k$.\n- Physical constants: $c = 343\\,\\mathrm{m/s}$, $f = 3\\,\\mathrm{kHz}$.\n- Error tolerance: The phase speed error must not exceed $0.5\\%$, which is a decimal tolerance of $0.005$.\n- Objective: Find the minimal integer value of points-per-wavelength, $\\lambda/h$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the standard linear acoustic wave equations and uses the well-established method of Fourier analysis (von Neumann analysis) to assess the dispersive properties of a finite-difference scheme. The specific 7-point stencil coefficients are from the seminal paper on Dispersion-Relation-Preserving (DRP) schemes by Tam and Webb (1993), a cornerstone in computational acoustics. The problem is scientifically and mathematically sound.\n2.  **Well-Posed**: All necessary information is provided. The definitions of error, wavenumber, and the numerical operator are precise. The objective is clearly stated. The existence of a unique, minimal integer solution is expected.\n3.  **Objective**: The language is precise and free of subjectivity.\n4.  **Consistency**: The givens are consistent. The provided values $c=343\\,\\mathrm{m/s}$ and $f=3\\,\\mathrm{kHz}$ are for physical context but, as will be shown, are not required to determine the dimensionless quantity $\\lambda/h$, which makes the problem a general one about the numerical scheme's properties. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be constructed.\n\n### Solution Derivation\n\nThe semi-discrete analysis begins by applying the finite-difference spatial operator to a single Fourier mode, $q_j = \\hat{q} \\exp(i(kx_j - \\omega t))$, where $x_j = j h$ is the coordinate of the $j$-th grid point and $h$ is the uniform grid spacing. The exact spatial derivative of this mode is $\\frac{\\partial q}{\\partial x} = ikq$. The finite-difference operator transforms this into a numerical approximation, effectively replacing $ik$ with a term $ik^*$, where $k^*$ is the modified wavenumber.\n\nLet's apply the given 7-point stencil to $q_j$:\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{1}{h} \\sum_{m=1}^{3} a_m (q_{j+m} - q_{j-m})\n$$\nSubstituting $q_{j \\pm m} = \\hat{q} \\exp(i(k(j \\pm m)h - \\omega t)) = q_j \\exp(\\pm i k m h)$:\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{q_j}{h} \\sum_{m=1}^{3} a_m (\\exp(i m k h) - \\exp(-i m k h))\n$$\nUsing Euler's formula, $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$, we get:\n$$\n\\frac{\\partial q_j}{\\partial x} \\approx \\frac{q_j}{h} \\sum_{m=1}^{3} a_m (2i \\sin(m k h)) = i \\left( \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(m k h) \\right) q_j\n$$\nBy comparing this to the exact derivative $ikq_j$, we identify the modified wavenumber $k^*$:\n$$\nk^* = \\frac{2}{h} \\sum_{m=1}^{3} a_m \\sin(m k h)\n$$\nThe problem defines the non-dimensional wavenumber as $\\kappa = kh$. Multiplying the above equation by $h$ gives the non-dimensional modified wavenumber, $\\kappa^* = k^*h$:\n$$\n\\kappa^* = 2a_1\\sin(\\kappa) + 2a_2\\sin(2\\kappa) + 2a_3\\sin(3\\kappa)\n$$\nThe ratio of the numerical to the true phase speed is given as $c_{\\text{num}}/c_{\\text{true}} = k^*/k$. This can be written in terms of non-dimensional quantities:\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{k^*h}{kh} = \\frac{\\kappa^*}{\\kappa}\n$$\nSubstituting the expression for $\\kappa^*$ and the given coefficients $a_1=\\frac{3}{4}$, $a_2=-\\frac{3}{20}$, $a_3=\\frac{1}{60}$:\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{1}{\\kappa} \\left( 2\\left(\\frac{3}{4}\\right)\\sin(\\kappa) + 2\\left(-\\frac{3}{20}\\right)\\sin(2\\kappa) + 2\\left(\\frac{1}{60}\\right)\\sin(3\\kappa) \\right)\n$$\n$$\n\\frac{c_{\\text{num}}}{c_{\\text{true}}} = \\frac{1}{\\kappa} \\left( \\frac{3}{2}\\sin(\\kappa) - \\frac{3}{10}\\sin(2\\kappa) + \\frac{1}{30}\\sin(3\\kappa) \\right)\n$$\nLet's denote this phase speed ratio as $R(\\kappa)$. The problem requires the phase speed error to be no more than $0.5\\%$:\n$$\n\\left| \\frac{c_{\\text{num}}}{c_{\\text{true}}} - 1 \\right| \\le 0.005 \\quad \\implies \\quad 0.995 \\le R(\\kappa) \\le 1.005\n$$\nThis specific DRP scheme is designed such that for the range of useful wavenumbers, the numerical phase speed is less than or equal to the true phase speed, i.e., $R(\\kappa) \\le 1$. Thus, the error condition simplifies to:\n$$\nR(\\kappa) \\ge 0.995\n$$\nThe non-dimensional wavenumber $\\kappa$ is related to the points-per-wavelength, $N = \\lambda/h$, by:\n$$\n\\kappa = kh = \\frac{2\\pi}{\\lambda}h = \\frac{2\\pi}{\\lambda/h} = \\frac{2\\pi}{N}\n$$\nWe need to find the smallest integer $N$ that satisfies $R(2\\pi/N) \\ge 0.995$. As $N$ increases, $\\kappa$ decreases towards $0$, and $R(\\kappa)$ approaches $1$. We need to test integer values of $N$ to find the cutoff.\n\nLet's test $N = 6$:\nFor $N=6$, $\\kappa = \\frac{2\\pi}{6} = \\frac{\\pi}{3}$.\n$$\nR\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{\\pi/3} \\left( \\frac{3}{2}\\sin\\left(\\frac{\\pi}{3}\\right) - \\frac{3}{10}\\sin\\left(\\frac{2\\pi}{3}\\right) + \\frac{1}{30}\\sin(\\pi) \\right)\n$$\nWe know $\\sin(\\pi/3) = \\frac{\\sqrt{3}}{2}$, $\\sin(2\\pi/3) = \\frac{\\sqrt{3}}{2}$, and $\\sin(\\pi) = 0$.\n$$\nR\\left(\\frac{\\pi}{3}\\right) = \\frac{3}{\\pi} \\left( \\frac{3}{2} \\cdot \\frac{\\sqrt{3}}{2} - \\frac{3}{10} \\cdot \\frac{\\sqrt{3}}{2} + 0 \\right) = \\frac{3}{\\pi} \\left( \\frac{3\\sqrt{3}}{4} - \\frac{3\\sqrt{3}}{20} \\right) = \\frac{3}{\\pi} \\left( \\frac{15\\sqrt{3} - 3\\sqrt{3}}{20} \\right)\n$$\n$$\nR(\\pi/3) = \\frac{3}{\\pi} \\frac{12\\sqrt{3}}{20} = \\frac{36\\sqrt{3}}{20\\pi} = \\frac{9\\sqrt{3}}{5\\pi}\n$$\nNumerically, $R\\left(\\frac{\\pi}{3}\\right) \\approx \\frac{9 \\times 1.73205}{5 \\times 3.14159} \\approx \\frac{15.58845}{15.70795} \\approx 0.99239$.\nThe value $0.99239$ is less than $0.995$. Therefore, $N=6$ is not sufficient.\n\nLet's test $N = 7$:\nFor $N=7$, $\\kappa = \\frac{2\\pi}{7}$.\n$$\nR\\left(\\frac{2\\pi}{7}\\right) = \\frac{7}{2\\pi} \\left( \\frac{3}{2}\\sin\\left(\\frac{2\\pi}{7}\\right) - \\frac{3}{10}\\sin\\left(\\frac{4\\pi}{7}\\right) + \\frac{1}{30}\\sin\\left(\\frac{6\\pi}{7}\\right) \\right)\n$$\nUsing radian mode on a calculator:\n$\\sin(2\\pi/7) \\approx 0.781831$\n$\\sin(4\\pi/7) \\approx 0.974928$\n$\\sin(6\\pi/7) = \\sin(\\pi - \\pi/7) = \\sin(\\pi/7) \\approx 0.433884$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{7}{2\\pi} \\left( \\frac{3}{2}(0.781831) - \\frac{3}{10}(0.974928) + \\frac{1}{30}(0.433884) \\right)\n$$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{7}{2\\pi} (1.172747 - 0.292478 + 0.014463) = \\frac{7}{2\\pi} (0.894732)\n$$\n$$\nR\\left(\\frac{2\\pi}{7}\\right) \\approx \\frac{6.263124}{2\\pi} \\approx 0.99684\n$$\nThe value $0.99684$ is greater than $0.995$. Therefore, $N=7$ is sufficient to keep the phase speed error below $0.5\\%$.\nSince $N=6$ was insufficient and $N=7$ is sufficient, the minimal integer value for the points-per-wavelength is $7$. The given values of $c=343\\,\\mathrm{m/s}$ and $f=3\\,\\mathrm{kHz}$ are consistent with a real-world scenario but are not needed for the calculation of the dimensionless ratio $\\lambda/h$.",
            "answer": "$$\n\\boxed{7}\n$$"
        },
        {
            "introduction": "DRP schemes are not the only way to construct high-order finite difference stencils; traditional methods are often based on maximizing Taylor series accuracy. This practice  offers a direct comparison between an optimized DRP stencil and a standard sixth-order central difference scheme. By computing and contrasting their respective modified wavenumbers, you will gain a deeper appreciation for the unique design philosophy of DRP methods and their superior performance in preserving wave characteristics over a broad range of frequencies.",
            "id": "4120595",
            "problem": "Consider the plane-wave analysis framework used in computational acoustics for designing numerical spatial-differencing operators that preserve the dispersion relation of linear wave propagation. A Dispersion-Relation-Preserving (DRP) scheme is a finite-difference discretization whose discrete spatial operator yields a modified wavenumber that closely matches the exact continuous wavenumber over a broad range of nondimensional wavenumbers.\n\nStart from the following fundamental base: a one-dimensional spatial derivative approximation applied to a discrete grid function $u_j = u(x_j)$ on a uniform grid with spacing $h$ can be written using a centered, antisymmetric stencil as\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_j} \\approx \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left(u_{j+m} - u_{j-m}\\right),\n$$\nwhere $a_m$ are constant stencil coefficients and $M$ is the half-width of the stencil. For a spatial Fourier mode $u(x) = e^{i k x}$ with wavenumber $k$, the action of a linear, constant-coefficient, shift-invariant stencil can be characterized by a modified wavenumber $k_{\\text{eff}}(k)$ defined through the discrete symbol. The dimensionless quantity $\\hat{k}(\\theta)$ with $\\theta \\equiv k h$ is used to compare numerical dispersion to the exact relation, where the exact continuous behavior corresponds to $\\hat{k}(\\theta) = \\theta$.\n\nIn this problem, you will compare two specific centered antisymmetric stencils for the first derivative:\n- An optimized $7$-point Dispersion-Relation-Preserving (DRP) stencil, with half-width $M = 3$ and coefficients $a_1 = 0.77088238$, $a_2 = -0.16670590$, $a_3 = 0.02084314$, chosen so that the leading consistency condition $\\sum_{m=1}^{3} m\\,a_m = 1/2$ is satisfied and the numerical dispersion is optimized over a practical range of $\\theta$.\n- A standard $6$th-order centered difference stencil for the first derivative, with half-width $M = 3$ and coefficients $a_1 = 3/4$, $a_2 = -3/20$, $a_3 = 1/60$, which satisfy $\\sum_{m=1}^{3} m\\,a_m = 1/2$ and yield a truncation error of order $O(h^6)$.\n\nYour tasks:\n1. Using the plane-wave ansatz $u_j = e^{i k x_j}$ and the definition of the discrete symbol for linear shift-invariant operators, derive the expression for the dimensionless modified wavenumber $\\hat{k}(\\theta)$ as a function of $\\theta$ and the stencil coefficients $a_m$ for a centered antisymmetric stencil. Do not assume any pre-existing formula for $\\hat{k}(\\theta)$; derive it from first principles by applying the stencil to $u_j = e^{i k x_j}$.\n2. Implement a program that, for each stencil, evaluates the dimensionless modified wavenumber $\\hat{k}(\\theta)$ over the range $\\theta \\in [0,\\pi/2]$, with $\\theta$ measured in radians.\n3. Compute and report the maximum absolute deviation between the two modified wavenumbers over $\\theta \\in [0,\\pi/2]$, that is $\\max_{\\theta \\in [0,\\pi/2]} \\left|\\hat{k}_{\\text{DRP}}(\\theta) - \\hat{k}_{\\text{CD6}}(\\theta)\\right|$, and the value of $\\theta$ (in radians) at which this maximum occurs.\n\nAngle units must be in radians. All numerical outputs must be rounded to six decimal places.\n\nTest suite and required outputs:\n- Use three test cases, each defined by the number of uniformly spaced sample points $N$ used to discretize $\\theta \\in [0,\\pi/2]$:\n  1. $N = 10001$ (a high-resolution \"happy path\" case).\n  2. $N = 101$ (a moderate-resolution boundary case).\n  3. $N = 2$ (an edge case that samples only the endpoints).\n- For each test case, evaluate the two modified wavenumber curves on the specified grid of $\\theta$ values, compute the maximum absolute deviation and the corresponding $\\theta$ location, and return these two values.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list in the order $[\\text{max\\_deviation}, \\theta_{\\text{at\\_max}}]$. For example, an output with three test cases must look like\n$$\n[[x_1,y_1],[x_2,y_2],[x_3,y_3]]\n$$\nwith no spaces, where $x_i$ and $y_i$ are floats rounded to six decimal places.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained, thus it is deemed valid. We proceed with a step-by-step solution.\n\n### Part 1: Derivation of the Dimensionless Modified Wavenumber\n\nThe primary task is to derive the expression for the dimensionless modified wavenumber, $\\hat{k}(\\theta)$, for a general centered, antisymmetric finite-difference stencil.\n\nThe stencil approximates the first spatial derivative of a function $u(x)$ at a grid point $x_j$ as:\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_j} \\approx \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left(u_{j+m} - u_{j-m}\\right)\n$$\nHere, $u_j = u(x_j)$, $h$ is the uniform grid spacing, $a_m$ are stencil coefficients, and $M$ is the stencil half-width. This numerical operator, let us denote it $D_h$, is linear and shift-invariant.\n\nTo analyze its behavior in the Fourier domain, we apply the operator to a single spatial Fourier mode, also known as a plane wave. This is the plane-wave ansatz:\n$$\nu(x) = e^{i k x}\n$$\nwhere $k$ is the continuous wavenumber and $i = \\sqrt{-1}$. On the discrete grid where $x_j = j h$, the function is represented as:\n$$\nu_j = e^{i k x_j} = e^{i k j h}\n$$\nThe values at neighboring grid points $x_{j \\pm m} = (j \\pm m)h$ are:\n$$\nu_{j+m} = e^{i k (j+m)h} = e^{i k j h} e^{i m k h} = u_j e^{i m k h}\n$$\n$$\nu_{j-m} = e^{i k (j-m)h} = e^{i k j h} e^{-i m k h} = u_j e^{-i m k h}\n$$\nThe difference term in the stencil sum becomes:\n$$\nu_{j+m} - u_{j-m} = u_j e^{i m k h} - u_j e^{-i m k h} = u_j \\left(e^{i m k h} - e^{-i m k h}\\right)\n$$\nUsing Euler's formula, which states $e^{i\\phi} - e^{-i\\phi} = 2i \\sin(\\phi)$, we can simplify this difference:\n$$\nu_{j+m} - u_{j-m} = u_j \\cdot 2i \\sin(m k h)\n$$\nSubstituting this back into the stencil formula, we find the action of the numerical operator $D_h$ on the plane wave $u_j$:\n$$\nD_h[u_j] = \\frac{1}{h} \\sum_{m=1}^{M} a_m \\left( u_j \\cdot 2i \\sin(m k h) \\right)\n$$\nSince $u_j$ and $i$ do not depend on the summation index $m$, we can factor them out:\n$$\nD_h[u_j] = \\left( \\frac{2i}{h} \\sum_{m=1}^{M} a_m \\sin(m k h) \\right) u_j\n$$\nThe exact continuous derivative of the plane wave $u(x)=e^{ikx}$ is:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} (e^{i k x}) = i k e^{i k x} = (i k) u(x)\n$$\nBy analogy, the action of the discrete operator $D_h$ on the discrete plane wave $u_j$ defines the modified wavenumber, $k_{\\text{eff}}$, as the scalar that satisfies:\n$$\nD_h[u_j] = (i k_{\\text{eff}}) u_j\n$$\nBy equating our two expressions for $D_h[u_j]$, we get:\n$$\n(i k_{\\text{eff}}) u_j = \\left( \\frac{2i}{h} \\sum_{m=1}^{M} a_m \\sin(m k h) \\right) u_j\n$$\nCanceling the common factor $i u_j$ from both sides yields the expression for the modified wavenumber:\n$$\nk_{\\text{eff}} = \\frac{2}{h} \\sum_{m=1}^{M} a_m \\sin(m k h)\n$$\nTo obtain the dimensionless form, we introduce the dimensionless wavenumber $\\theta = k h$ and define the dimensionless modified wavenumber as $\\hat{k}(\\theta) = k_{\\text{eff}} h$. We multiply the equation for $k_{\\text{eff}}$ by $h$:\n$$\nk_{\\text{eff}} h = 2 \\sum_{m=1}^{M} a_m \\sin(m (k h))\n$$\nSubstituting the dimensionless variables, we arrive at the final derived expression:\n$$\n\\hat{k}(\\theta) = 2 \\sum_{m=1}^{M} a_m \\sin(m \\theta)\n$$\nThis formula relates the effective numerical dispersion $\\hat{k}(\\theta)$ to the ideal dispersion $\\hat{k}(\\theta)=\\theta$ via the stencil coefficients $a_m$.\n\n### Part 2  3: Numerical Computation and Comparison\n\nThe next step is to implement this formula for the two given stencils and compute the maximum absolute deviation between their respective modified wavenumbers over the interval $\\theta \\in [0, \\pi/2]$.\n\nThe coefficients for the stencils are:\n1.  **7-point DRP stencil ($M=3$):**\n    $a_1 = 0.77088238$\n    $a_2 = -0.16670590$\n    $a_3 = 0.02084314$\n2.  **6th-order Centered Difference (CD6) stencil ($M=3$):**\n    $a_1 = 3/4 = 0.75$\n    $a_2 = -3/20 = -0.15$\n    $a_3 = 1/60 \\approx 0.01666667$\n\nFor each test case defined by $N$ (the number of sample points), we will perform the following steps:\n1.  Create a uniform grid of $N$ points for $\\theta$ in the range $[0, \\pi/2]$.\n2.  For each $\\theta$ on this grid, calculate $\\hat{k}_{\\text{DRP}}(\\theta)$ using the DRP coefficients and the derived formula.\n3.  Similarly, calculate $\\hat{k}_{\\text{CD6}}(\\theta)$ using the CD6 coefficients.\n4.  Compute the absolute difference $|\\hat{k}_{\\text{DRP}}(\\theta) - \\hat{k}_{\\text{CD6}}(\\theta)|$ for all points on the grid.\n5.  Find the maximum value of this difference and the corresponding value of $\\theta$ at which it occurs.\n6.  The results for each test case, $[\\text{max\\_deviation}, \\theta_{\\text{at\\_max}}]$, will be collected and formatted as specified.\n\nThe computational logic will be encapsulated in a Python script utilizing the `numpy` library for efficient vectorized calculations.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing DRP and CD6 finite difference schemes.\n    \n    This function performs the following steps:\n    1. Defines the coefficients for the 7-point DRP and 6th-order centered\n       difference (CD6) stencils.\n    2. Defines the test cases based on the number of sample points N.\n    3. Implements a vectorized function to calculate the dimensionless \n       modified wavenumber for a given set of coefficients and theta values.\n    4. Iterates through each test case:\n       a. Creates a grid of theta values.\n       b. Computes the modified wavenumbers for both DRP and CD6 schemes.\n       c. Calculates the absolute difference between the two.\n       d. Finds the maximum deviation and the theta at which it occurs.\n    5. Formats and prints the final results as specified in the problem statement.\n    \"\"\"\n\n    # Stencil coefficients for M=3\n    # 7-point Dispersion-Relation-Preserving (DRP) stencil\n    coeffs_drp = np.array([0.77088238, -0.16670590, 0.02084314])\n    \n    # 6th-order Centered Difference (CD6) stencil\n    coeffs_cd6 = np.array([3.0/4.0, -3.0/20.0, 1.0/60.0])\n\n    # Test cases defined by the number of sample points N\n    test_cases = [10001, 101, 2]\n\n    results = []\n\n    def calculate_k_hat(theta_grid, coeffs):\n        \"\"\"\n        Calculates the dimensionless modified wavenumber k_hat(theta).\n        Formula: k_hat(theta) = 2 * sum_{m=1 to M} a_m * sin(m*theta)\n        \n        Args:\n            theta_grid (np.ndarray): An array of dimensionless wavenumbers theta.\n            coeffs (np.ndarray): The stencil coefficients [a_1, a_2, ..., a_M].\n\n        Returns:\n            np.ndarray: An array of k_hat values corresponding to the theta_grid.\n        \"\"\"\n        M = len(coeffs)\n        m_vals = np.arange(1, M + 1)\n        \n        # Create a matrix of m*theta values where rows correspond to theta\n        # and columns correspond to m.\n        m_theta_matrix = np.outer(theta_grid, m_vals)\n        \n        # Apply sin function element-wise\n        sin_matrix = np.sin(m_theta_matrix)\n        \n        # Compute the sum via matrix-vector multiplication\n        # (N, M) @ (M,) -> (N,)\n        k_hat_values = 2 * (sin_matrix @ coeffs)\n        return k_hat_values\n\n    for n_points in test_cases:\n        # Create a uniform grid for theta in the range [0, pi/2]\n        theta_grid = np.linspace(0, np.pi/2, n_points)\n        \n        # Calculate the modified wavenumbers for both schemes\n        k_hat_drp = calculate_k_hat(theta_grid, coeffs_drp)\n        k_hat_cd6 = calculate_k_hat(theta_grid, coeffs_cd6)\n        \n        # Compute the absolute difference\n        abs_deviation = np.abs(k_hat_drp - k_hat_cd6)\n        \n        # Find the index of the maximum deviation\n        max_dev_index = np.argmax(abs_deviation)\n        \n        # Get the maximum deviation and the theta at which it occurs\n        max_dev = abs_deviation[max_dev_index]\n        theta_at_max = theta_grid[max_dev_index]\n        \n        results.append([max_dev, theta_at_max])\n\n    # Format the final output string exactly as required\n    formatted_results = []\n    for res_pair in results:\n        max_dev, theta_val = res_pair\n        # Format each number to 6 decimal places and create a string like \"[x.xxxxxx,y.yyyyyy]\"\n        formatted_pair = f\"[{max_dev:.6f},{theta_val:.6f}]\"\n        formatted_results.append(formatted_pair)\n        \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "The theoretical concept of dispersion error can feel abstract, but its effects are very real in long-duration simulations. This final exercise  bridges theory and practice by having you quantify the cumulative phase error in a standing wave simulation over thousands of periods. By calculating the drift between the numerical solution and the exact analytical solution, you will witness firsthand how even small, single-step phase errors can accumulate into significant inaccuracies, underscoring the critical importance of dispersion control in computational acoustics.",
            "id": "4120598",
            "problem": "Consider one-dimensional linearized acoustics in a periodic domain. The governing equations for acoustic pressure $p(x,t)$ and particle velocity $u(x,t)$ are the first-order system\n$p_t + K u_x = 0$ and $u_t + \\frac{1}{\\rho} p_x = 0$, where $K$ is the bulk modulus and $\\rho$ is the density, with sound speed $c = \\sqrt{K/\\rho}$. On the continuous domain of length $L$ with periodic boundary conditions, a standing wave initial condition $p(x,0) = \\cos(k x)$, $u(x,0) = 0$ leads to $p(x,t) = \\cos(k x)\\cos(\\omega t)$ with angular frequency $\\omega = c\\,|k|$. We are interested in the semi-discrete (space-discretized, time-continuous) case where space is discretized by a dispersion-relation-preserving (DRP) centered finite-difference stencil approximating the first spatial derivative, and time is integrated exactly (no time-discretization error). The spatial grid has $M$ points and uniform spacing $\\Delta x = L/M$. The stencil for the discrete first derivative is anti-symmetric and of the form\n$$D[u]_n = \\frac{1}{\\Delta x}\\sum_{j=1}^{J} a_j\\,(u_{n+j} - u_{n-j})$$\nwhere $a_j$ are prescribed coefficients and $J$ is the half-width. Assume the discrete derivative operator is used in the semi-discrete first-order acoustic system. For a mode with wavenumber $k = 2\\pi m/L$ with integer $m$, the semi-discrete system reproduces an oscillation with a numerical angular frequency $\\omega_{\\text{num}}$ determined by the discrete spatial operator. The long-time standing-wave phase error accumulates linearly according to $\\Delta\\phi(T) = (\\omega_{\\text{num}} - \\omega)\\,T$, measured in radians. Define the unwrapped accumulated phase error after $N$ exact continuous periods $T = N\\,\\frac{2\\pi}{\\omega}$ as the scalar\n$\\Delta\\phi_N = (\\omega_{\\text{num}}/\\omega - 1)\\,2\\pi N$,\nwhich is the quantity to be computed.\n\nYour task is to write a complete, runnable program that:\n- Starts from the fundamental acoustic model and the given discrete spatial derivative, and uses Fourier analysis to obtain the semi-discrete dispersion relation from which $\\omega_{\\text{num}}$ follows.\n- Implements the calculation of the accumulated unwrapped phase error $\\Delta\\phi_N$ for each test case listed below.\n- Outputs the results as a single line with a comma-separated list enclosed in square brackets.\n\nAll physical quantities must use the following units: $L$ in $\\mathrm{m}$, $c$ in $\\mathrm{m/s}$, and the accumulated phase error $\\Delta\\phi_N$ must be reported in radians. Angles must be in radians. There is no time-step, since time integration is exact.\n\nStencil coefficient sets to be used (anti-symmetric centered-difference first-derivative stencils):\n- Second-order centered: $J=1$, with $a_1 = 0.5$.\n- Fourth-order centered: $J=2$, with $a_1 = 0.6666666666666666$, $a_2 = -0.08333333333333333$.\n- Seven-point dispersion-relation-preserving optimized (Tam–Webb type): $J=3$, with $a_1 = 0.770882380518225$, $a_2 = -0.166705904414580$, $a_3 = 0.020843142770311$.\n\nTest suite of parameter sets $(\\text{stencil}, L, c, M, m, N)$:\n- Case A (happy path, well-resolved DRP): seven-point DRP, $L = 1.0\\,\\mathrm{m}$, $c = 340.0\\,\\mathrm{m/s}$, $M = 256$, $m = 4$, $N = 1000$.\n- Case B (long-time accumulation at very low wavenumber): seven-point DRP, $L = 1.0\\,\\mathrm{m}$, $c = 340.0\\,\\mathrm{m/s}$, $M = 256$, $m = 1$, $N = 10000$.\n- Case C (Nyquist edge case for centered stencils): second-order centered, $L = 1.0\\,\\mathrm{m}$, $c = 340.0\\,\\mathrm{m/s}$, $M = 128$, $m = 64$, $N = 5$.\n- Case D (moderately resolved, non-DRP high order): fourth-order centered, $L = 1.0\\,\\mathrm{m}$, $c = 340.0\\,\\mathrm{m/s}$, $M = 48$, $m = 9$, $N = 800$.\n\nYour program must:\n- For each test case, compute $\\Delta x = L/M$, the continuous wavenumber $k = 2\\pi m/L$, and use the spatial stencil to obtain the discrete modified wavenumber $\\tilde{k}$ for that $k$.\n- Use exact-time integration behavior of the semi-discrete system to obtain $\\omega_{\\text{num}}$ from the discrete spatial operator, and then compute the accumulated unwrapped phase error $\\Delta\\phi_N$ as defined above.\n- Return the four results in the order of Cases A–D as a single line printed to standard output, containing a Python-like list string of the $4$ floating-point values rounded to $10$ decimal places, for example $[x_1,x_2,x_3,x_4]$.\n\nAnswer in radians. Round each result to $10$ decimal places. The final program must not read input.\n\nYour solution must be reproducible by any developer using any modern programming language, but your final answer must be a complete, runnable program as specified for Python $3.12$ with allowed libraries.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and contains all necessary information to derive a unique solution.\n\nThe solution is derived by analyzing the dispersion properties of the semi-discretized acoustic equations. We begin with the continuous system, establish its dispersion relation, and then contrast it with the numerical dispersion relation that arises from the spatial finite-difference approximation.\n\nThe one-dimensional linearized acoustic equations are given as a first-order system for pressure $p(x,t)$ and particle velocity $u(x,t)$:\n$$\n\\frac{\\partial p}{\\partial t} + K \\frac{\\partial u}{\\partial x} = 0 \\\\\n\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0\n$$\nwhere $K$ is the bulk modulus and $\\rho$ is the density. These equations can be combined into a second-order wave equation by differentiating the first with respect to time $t$ and the second with respect to space $x$, and substituting, which yields:\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\frac{\\partial^2 p}{\\partial x^2}\n$$\nwhere $c = \\sqrt{K/\\rho}$ is the speed of sound.\nTo find the continuous dispersion relation, we consider a plane wave solution of the form $p(x,t) = \\hat{p} e^{i(kx - \\omega t)}$. Substituting this into the wave equation gives:\n$$\n(-i\\omega)^2 e^{i(kx - \\omega t)} = c^2 (ik)^2 e^{i(kx - \\omega t)} \\\\\n-\\omega^2 = -c^2 k^2\n$$\nThis gives the exact dispersion relation $\\omega^2 = c^2 k^2$, or $\\omega = c|k|$, where $k$ is the wavenumber and $\\omega$ is the angular frequency.\n\nIn the semi-discrete approach, the spatial derivatives are approximated using a finite-difference stencil, while time remains continuous. The grid points are defined as $x_n = n \\Delta x$, where $\\Delta x = L/M$ is the grid spacing. The spatial derivative operator is given by:\n$$\nD[f]_n = \\frac{1}{\\Delta x}\\sum_{j=1}^{J} a_j\\,(f_{n+j} - f_{n-j})\n$$\nThe semi-discrete system of equations becomes:\n$$\n\\frac{d p_n}{dt} = -K D[u]_n \\\\\n\\frac{d u_n}{dt} = -\\frac{1}{\\rho} D[p]_n\n$$\nTo analyze the dispersion properties of this system, we examine its behavior on a single spatial Fourier mode, $f_n = e^{ikx_n} = e^{ikn\\Delta x}$. Applying the discrete operator $D$ to this mode yields:\n$$\nD[e^{ikn\\Delta x}] = \\frac{1}{\\Delta x}\\sum_{j=1}^{J} a_j\\,(e^{ik(n+j)\\Delta x} - e^{ik(n-j)\\Delta x}) \\\\\n= \\frac{e^{ikn\\Delta x}}{\\Delta x} \\sum_{j=1}^{J} a_j\\,(e^{ikj\\Delta x} - e^{-ikj\\Delta x})\n$$\nUsing the identity $\\sin(\\theta) = (e^{i\\theta} - e^{-i\\theta})/(2i)$, this simplifies to:\n$$\nD[e^{ikn\\Delta x}] = \\frac{e^{ikn\\Delta x}}{\\Delta x} \\sum_{j=1}^{J} a_j\\,(2i \\sin(kj\\Delta x)) \\\\\n= i \\left( \\frac{2}{\\Delta x} \\sum_{j=1}^{J} a_j \\sin(kj\\Delta x) \\right) e^{ikn\\Delta x}\n$$\nThis demonstrates that for a Fourier mode, the discrete differentiation operator $D$ acts as multiplication by $i\\tilde{k}$, where $\\tilde{k}$ is the *modified wavenumber*:\n$$\n\\tilde{k}(k) = \\frac{2}{\\Delta x} \\sum_{j=1}^{J} a_j \\sin(kj\\Delta x)\n$$\nThe modified wavenumber $\\tilde{k}$ is the effective wavenumber as \"seen\" by the numerical scheme. Any deviation of $\\tilde{k}$ from $k$ leads to dispersion error.\n\nSubstituting the Fourier mode representation $p_n(t) = \\hat{p}(t)e^{ikn\\Delta x}$ and $u_n(t) = \\hat{u}(t)e^{ikn\\Delta x}$ into the semi-discrete system, we obtain a system of ODEs for the time-dependent amplitudes $\\hat{p}(t)$ and $\\hat{u}(t)$:\n$$\n\\frac{d\\hat{p}}{dt} = -K (i\\tilde{k}) \\hat{u} \\\\\n\\frac{d\\hat{u}}{dt} = -\\frac{1}{\\rho} (i\\tilde{k}) \\hat{p}\n$$\nCombining these equations leads to a second-order ODE for $\\hat{p}(t)$:\n$$\n\\frac{d^2\\hat{p}}{dt^2} = -K (i\\tilde{k}) \\frac{d\\hat{u}}{dt} = -K (i\\tilde{k}) \\left(-\\frac{1}{\\rho} (i\\tilde{k}) \\hat{p}\\right) = -\\frac{K}{\\rho}\\tilde{k}^2 \\hat{p} = -c^2 \\tilde{k}^2 \\hat{p}\n$$\nThis is the equation of a harmonic oscillator, $\\frac{d^2\\hat{p}}{dt^2} + (c\\tilde{k})^2 \\hat{p} = 0$, whose solutions oscillate with a numerical angular frequency $\\omega_{\\text{num}}$ satisfying:\n$$\n\\omega_{\\text{num}}^2 = c^2 \\tilde{k}^2 \\implies \\omega_{\\text{num}} = c|\\tilde{k}|\n$$\nThe problem asks for the accumulated unwrapped phase error after $N$ continuous periods, defined as:\n$$\n\\Delta\\phi_N = \\left(\\frac{\\omega_{\\text{num}}}{\\omega} - 1\\right) 2\\pi N\n$$\nSubstituting the expressions for $\\omega = c|k|$ and $\\omega_{\\text{num}} = c|\\tilde{k}|$, we get:\n$$\n\\Delta\\phi_N = \\left(\\frac{c|\\tilde{k}|}{c|k|} - 1\\right) 2\\pi N = \\left(\\frac{|\\tilde{k}|}{|k|} - 1\\right) 2\\pi N\n$$\nFor the given problem setup with non-negative mode numbers $m$, the wavenumber $k = 2\\pi m/L \\ge 0$. The anti-symmetric stencil ensures $\\tilde{k}$ has the same sign as $k$ for wavenumbers below the Nyquist limit, so we can drop the absolute value signs.\n$$\n\\Delta\\phi_N = \\left(\\frac{\\tilde{k}}{k} - 1\\right) 2\\pi N\n$$\nThe ratio $\\tilde{k}/k$ can be expressed in terms of the dimensionless wavenumber $\\alpha = k\\Delta x$:\n$$\n\\frac{\\tilde{k}}{k} = \\frac{1}{k} \\left( \\frac{2}{\\Delta x} \\sum_{j=1}^{J} a_j \\sin(kj\\Delta x) \\right) = \\frac{2}{k\\Delta x} \\sum_{j=1}^{J} a_j \\sin(j(k\\Delta x)) = \\frac{2}{\\alpha} \\sum_{j=1}^{J} a_j \\sin(j\\alpha)\n$$\nFor each test case, we compute the parameters $L, c, M, m, N$, which determine $\\Delta x = L/M$ and $k=2\\pi m/L$. Then we compute $\\alpha = k\\Delta x = 2\\pi m/M$. Using the appropriate stencil coefficients $\\{a_j\\}$, we calculate the ratio $\\tilde{k}/k$ and subsequently the phase error $\\Delta\\phi_N$.\n\nThe specific stencil coefficients are:\n- Second-order centered: $J=1$, with $a_1 = 0.5$.\n- Fourth-order centered: $J=2$, with $a_1 = 2/3 \\approx 0.6666666666666666$, $a_2 = -1/12 \\approx -0.08333333333333333$.\n- Seven-point DRP: $J=3$, with $a_1 = 0.770882380518225$, $a_2 = -0.166705904414580$, $a_3 = 0.020843142770311$.\n\nThe calculation proceeds by direct application of these formulas to each test case.\nFor a given test case $(\\text{stencil type}, L, c, M, m, N)$:\n1. Calculate $\\alpha = 2\\pi m / M$.\n2. Select the coefficients $a_j$ for the specified stencil.\n3. If $\\alpha=0$, the ratio $\\tilde{k}/k = 1$. If $\\alpha \\neq 0$, compute the ratio $\\frac{\\tilde{k}}{k} = \\frac{2}{\\alpha} \\sum_{j=1}^{J} a_j \\sin(j\\alpha)$.\n4. Compute the phase error $\\Delta\\phi_N = (\\tilde{k}/k - 1)2\\pi N$.\nThis procedure yields the required numerical results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the accumulated unwrapped phase error for several\n    semi-discrete acoustic simulation test cases.\n    \"\"\"\n    \n    # Stencil coefficients for the discrete first derivative operator.\n    # D[u]_n = (1/dx) * sum_{j=1 to J} a_j * (u_{n+j} - u_{n-j})\n    stencils = {\n        \"second-order\": {\n            \"J\": 1,\n            \"a\": [0.5]\n        },\n        \"fourth-order\": {\n            \"J\": 2,\n            \"a\": [0.6666666666666666, -0.08333333333333333]\n        },\n        \"seven-point-drp\": {\n            \"J\": 3,\n            \"a\": [0.770882380518225, -0.166705904414580, 0.020843142770311]\n        }\n    }\n\n    # Test suite of parameter sets (stencil_name, L, c, M, m, N)\n    test_cases = [\n        # Case A\n        (\"seven-point-drp\", 1.0, 340.0, 256, 4, 1000),\n        # Case B\n        (\"seven-point-drp\", 1.0, 340.0, 256, 1, 10000),\n        # Case C\n        (\"second-order\", 1.0, 340.0, 128, 64, 5),\n        # Case D\n        (\"fourth-order\", 1.0, 340.0, 48, 9, 800),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        stencil_name, L, c, M, m, N = case\n        \n        # Calculate derived physical and numerical parameters\n        # delta_x = L / M\n        # k = 2 * np.pi * m / L\n        # alpha is the dimensionless wavenumber k * delta_x\n        # which simplifies to 2 * pi * m / M\n        alpha = 2 * np.pi * m / M\n        \n        stencil_data = stencils[stencil_name]\n        a_coeffs = stencil_data[\"a\"]\n        \n        # Calculate the ratio of numerical to exact frequency, which equals\n        # the ratio of modified to exact wavenumber, k_tilde / k.\n        \n        # Handle the case alpha = 0 to avoid division by zero, though not\n        # present in test cases. For alpha->0, k_tilde/k -> 1.\n        if alpha == 0:\n            ratio_k_tilde_over_k = 1.0\n        else:\n            # Calculate the sum term for the modified wavenumber formula\n            sum_term = 0.0\n            for j, a_j in enumerate(a_coeffs, 1):\n                sum_term += a_j * np.sin(j * alpha)\n            \n            # The ratio k_tilde/k = (2/alpha) * sum(...)\n            ratio_k_tilde_over_k = 2 * sum_term / alpha\n\n        # Calculate the unwrapped accumulated phase error\n        # delta_phi_N = (omega_num/omega - 1) * 2 * pi * N\n        # which is (k_tilde/k - 1) * 2 * pi * N\n        phase_error = (ratio_k_tilde_over_k - 1) * 2 * np.pi * N\n        \n        results.append(phase_error)\n\n    # Format output as a list of strings with 10 decimal places.\n    formatted_results = [f\"{res:.10f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}