{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的数值求解器之前，建立可靠的基准问题以进行验证是至关重要的一步。本练习侧重于推导瞬态声学中两个基本问题的解析解：一维黎曼问题和三维自由空间脉冲 。掌握这些推导能够让你获得“标准答案”，这对于检验数值代码的准确性、加深对波分裂、特征速度和几何扩散等核心物理现象的理解，是不可或缺的。",
            "id": "4149226",
            "problem": "考虑一个线性化小振幅声学模型，在一维空间中用于一个基准黎曼问题，在三维空间中用于一个基准自由空间出射脉冲。一维模型（适用于静止状态下的小扰动）由线性化的连续性方程和动量方程控制，对于压力 $p(x,t)$ 和质点速度 $u(x,t)$，方程为 $p_t + \\rho_0 c^2 u_x = 0$ 和 $u_t + \\frac{1}{\\rho_0} p_x = 0$，其中 $\\rho_0$ 是恒定参考密度，$c$ 是声速。三维模型中的压力场 $p(\\mathbf{x},t)$ 由自由空间中的齐次声波方程 $p_{tt} - c^2 \\Delta p = 0$ 控制。\n\n基准1（一维黎曼问题）：在 $x=0$ 处设置一个初始间断，$p(x,0) = p_0 H(x)$ 且 $u(x,0) = 0$，其中 $H(x)$ 是亥维赛德阶跃函数。设 $\\rho_0 = 1.2$ （参考密度，单位：千克/立方米），$c = 343$ （声速，单位：米/秒），$p_0 = 1.0$ （压力振幅，单位：帕斯卡）。一个探头放置在 $x = -L$ 处，其中 $L = 0.5$ （米）。待验证的数值格式应能再现正确的波速、到达时间和波幅，并应遵守该线性化系统的适当能量性质。\n\n基准2（三维自由空间出射脉冲）：考虑一个球对称的纯出射脉冲，通过指定初始数据 $p(\\mathbf{x},0) = 0$ 和 $p_t(\\mathbf{x},0) = g(|\\mathbf{x}|)$ 生成，其中 $g$ 是一个紧支撑且径向对称的函数，使得最终解是一个出射球面波。沿着从原点出发的任意射线上，在半径 $R_1 = 0.5$ 和 $R_2 = 1.0$ （米）处放置两个探头。待验证的数值解应表现出正确的几何扩散、脉冲峰值的到达时间以及与声波方程相关的物理上适当的守恒性质。\n\n哪个选项为这些基准问题指定了最佳的、物理上正确且精确的验证标准，包括到达时间、振幅和基于范数的检验？\n\nA. 对于基准1，压力和速度分裂成速度为 $\\pm c$ 的左行波和右行波。在探头 $x = -L$ 处，首次非零信号到达时间为 $t^* = L/c \\approx 0.001458$ （秒）。到达后瞬间，$p(-L,t^*+) = p_0/2 = 0.5$ 且 $u(-L,t^*+) = -\\dfrac{p_0}{2 \\rho_0 c} \\approx -0.00121$ （米/秒），负号表示向左运动。一个稳健的验证必须包括一维离散声能检验，使用能量密度 $\\frac{1}{2}\\rho_0 u^2 + \\frac{1}{2}\\dfrac{p^2}{\\rho_0 c^2}$，并报告相对能量随时间的漂移。对于基准2，出射球面波的振幅衰减与 $1/r$ 成正比，半径 $R$ 处的脉冲峰值在 $t_R = R/c$ 到达，因此 $t_{R_1} \\approx 0.001458$ 且 $t_{R_2} \\approx 0.002915$ （秒）。峰值振幅比满足 $p_{\\max}(R_2)/p_{\\max}(R_1) = R_1/R_2 = 0.5$，一个适当的验证包括将测量的 $L^\\infty$ 振幅与 $1/r$ 定律进行比较，并进行球面上的能量通量一致性检验。\n\nB. 对于基准1，在 $x = -L$ 处的到达时间为 $t^* = 2L/c \\approx 0.002915$ （秒），并观察到完整跳跃 $p(-L,t^*+) = p_0 = 1.0$ 及 $u(-L,t^*+) = +\\dfrac{p_0}{\\rho_0 c}$ （米/秒）。验证基于 $p$ 的 $L^2$ 范数在空间上的守恒。对于基准2，振幅按 $1/r^2$ 衰减，峰值到达时间为 $t_{R_1} = R_1/c$ 和 $t_{R_2} = R_2/c$，且 $p_{\\max}(R_2)/p_{\\max}(R_1) = (R_1/R_2)^2 = 0.25$。\n\nC. 对于基准1，选择探头在 $x = +L$ 处，并预期首次到达时间为 $t^* = L/c \\approx 0.001458$ （秒），$p(+L,t^*+) = p_0/2 = 0.5$ 且 $u(+L,t^*+) = +\\dfrac{p_0}{2 \\rho_0 c}$ （米/秒）。验证使用 $p$ 的 $L^2$ 范数，并要求其在数值容差范围内保持不变。对于基准2，半径 $R$ 处的振幅与 $R$ 无关，因此 $p_{\\max}(R_2)/p_{\\max}(R_1) = 1$，并且峰值在 $t_R = R/c$ 到达。\n\nD. 对于基准1，波速取决于初始跳跃的局域波数，因此由于色散，在 $x = -L$ 处的到达时间满足 $t^* > L/c$，并且到达后的平台值为 $p_0$，而 $u = 0$。对于基准2，球面脉冲表现出扩散性展宽，因此振幅衰减快于 $1/r^2$，半径 $R$ 处的峰值到达时间晚于 $R/c$，因此验证应侧重于匹配一个小于 $c$ 的频率相关的群速度和 $L^2$ 范数中的耗散衰减。",
            "solution": "问题陈述需要经过验证。\n\n**步骤1：提取已知条件**\n\n**基准1：一维黎曼问题**\n- 控制方程：$p_t + \\rho_0 c^2 u_x = 0$ 和 $u_t + \\frac{1}{\\rho_0} p_x = 0$。\n- 变量：压力 $p(x,t)$，质点速度 $u(x,t)$。\n- 常数：参考密度 $\\rho_0 = 1.2$ kg/m$^3$，声速 $c = 343$ m/s。\n- 初始条件 ($t=0$)：$p(x,0) = p_0 H(x)$ 和 $u(x,0) = 0$，压力振幅 $p_0 = 1.0$ Pa，其中 $H(x)$ 是亥维赛德阶跃函数。\n- 探头位置：$x = -L$，其中 $L = 0.5$ m。\n- 既定验证目标：正确的波速、到达时间、波幅和能量性质。\n\n**基准2：三维自由空间出射脉冲**\n- 控制方程：$p_{tt} - c^2 \\Delta p = 0$ 在自由空间中。\n- 变量：压力场 $p(\\mathbf{x},t)$。\n- 初始条件 ($t=0$)：$p(\\mathbf{x},0) = 0$ 和 $p_t(\\mathbf{x},0) = g(|\\mathbf{x}|)$，其中 $g$ 是一个紧支撑、径向对称的函数。\n- 预期解：一个纯出射的球对称波。\n- 探头位置：半径 $R_1 = 0.5$ m 和 $R_2 = 1.0$ m。\n- 既定验证目标：正确的几何扩散、脉冲峰值的到达时间以及守恒性质。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于一维和三维声学的基本线性化方程。这些是标准的教科书模型。初值问题（一个黎曼问题和一个脉冲生成问题）是计算波物理学中的典范基准。所有物理参数对于标准条件下的空气都是符合实际的。该问题在科学上是合理的。\n- **适定性**：具有黎曼数据的一维双曲系统和具有光滑、紧支撑初始数据的三维波动方程是适定初值问题的经典例子，它们存在可以解析求得的唯一且稳定的解。\n- **客观性**：该问题使用精确、无歧义的数学和物理术语进行陈述。它不含主观或基于观点的内容。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它有科学依据、是适定的且客观的。我将继续推导解答并评估各个选项。\n\n**解析解的推导**\n\n**基准1：一维黎曼问题**\n方程组 $p_t + \\rho_0 c^2 u_x = 0$ 和 $u_t + \\frac{1}{\\rho_0} p_x = 0$ 是一个标准的双曲系统，其解以特征速度 $\\lambda = \\pm c$ 传播。通解可以表示为一个右行波 $f(x-ct)$ 和一个左行波 $g(x+ct)$ 的叠加。\n对于状态向量 $(p, u)$，解为：\n$$ p(x,t) = f(x-ct) + g(x+ct) $$\n$$ u(x,t) = \\frac{1}{\\rho_0 c} f(x-ct) - \\frac{1}{\\rho_0 c} g(x+ct) $$\n初始条件是 $p(x,0) = p_0 H(x)$ 和 $u(x,0) = 0$。\n在 $t=0$ 时：\n$p(x,0) = f(x) + g(x) = p_0 H(x)$\n$u(x,0) = \\frac{1}{\\rho_0 c} [f(x) - g(x)] = 0 \\implies f(x) = g(x)$\n将 $f(x) = g(x)$ 代入第一个方程得到 $2f(x) = p_0 H(x)$，所以 $f(x) = g(x) = \\frac{p_0}{2}H(x)$。\n因此，完整解为：\n$$ p(x,t) = \\frac{p_0}{2} H(x-ct) + \\frac{p_0}{2} H(x+ct) $$\n$$ u(x,t) = \\frac{p_0}{2\\rho_0 c} H(x-ct) - \\frac{p_0}{2\\rho_0 c} H(x+ct) $$\n这表明在 $x=0$ 处的初始跳跃分裂成两个振幅减半、向相反方向传播的波。\n一个探头位于 $x = -L = -0.5$ 米处。该探头将只受到左行波的影响，该波由参数为 $x+ct$ 的项描述。波前在时间 $t^*$ 到达 $x=-L$，使得 $-L + ct^* = 0$，从而得到 $t^* = L/c$。\n使用给定的值，$L=0.5$ 米，$c=343$ 米/秒，到达时间为：\n$$ t^* = \\frac{0.5}{343} \\approx 0.0014577 \\text{ s} \\approx 0.001458 \\text{ s} $$\n对于 $t > t^*$，探头 $x = -L$ 处的状态是确定的。在此位置，对于所有 $t>0$，$x-ct = -L-ct  0$，所以 $H(x-ct)=0$。参数 $x+ct = -L+ct > 0$，所以 $H(x+ct)=1$。\n对于 $t > t^*$，探头处的压力和速度为：\n$$ p(-L, t>t^*) = \\frac{p_0}{2}(0) + \\frac{p_0}{2}(1) = \\frac{p_0}{2} = \\frac{1.0}{2} = 0.5 \\text{ Pa} $$\n$$ u(-L, t>t^*) = \\frac{p_0}{2\\rho_0 c}(0) - \\frac{p_0}{2\\rho_0 c}(1) = -\\frac{p_0}{2\\rho_0 c} = -\\frac{1.0}{2(1.2)(343)} \\approx -0.0012147 \\text{ m/s} \\approx -0.00121 \\text{ m/s} $$\n负速度表示质点在 $-x$ 方向（向左）运动，与波的传播方向一致。\n对于这个非耗散系统，总声能（其密度为 $E_d = \\frac{1}{2}\\rho_0 u^2 + \\frac{1}{2}\\frac{p^2}{\\rho_0 c^2}$）是一个守恒量。验证其离散对应物的守恒性是数值格式的一个标准且关键的检验。\n\n**基准2：三维自由空间出射脉冲**\n对于径向对称的压力 $p(r,t)$，三维波动方程 $p_{tt} - c^2 \\Delta p = 0$ 可以通过代换 $q(r,t) = r p(r,t)$ 来简化，从而得到一维波动方程 $q_{tt} - c^2 q_{rr} = 0$。\n$p(r,t)$ 的通解为 $p(r,t) = \\frac{f(r-ct)}{r} + \\frac{g(r+ct)}{r}$。\n问题指定了一个“纯出射脉冲”，对应于解 $p(r,t) = \\frac{f(r-ct)}{r}$。这个函数形式表明波形 $f$ 的振幅按 $1/r$ 衰减。这种现象被称为几何扩散。\n在半径 $R$ 处的压力脉冲峰值振幅（记为 $p_{\\max}(R)$）与 $1/R$ 成正比。两个半径 $R_1$ 和 $R_2$ 处的峰值振幅之比为：\n$$ \\frac{p_{\\max}(R_2)}{p_{\\max}(R_1)} = \\frac{k/R_2}{k/R_1} = \\frac{R_1}{R_2} $$\n当 $R_1 = 0.5$ 米，$R_2 = 1.0$ 米时，这个比值为 $0.5/1.0 = 0.5$。\n波形以速度 $c$向外传播。因此，脉冲的峰值（位于 $f$ 的自变量中的某个位置）在时间 $t_R = R/c$（相对于其从原点的“发射”时间）到达半径 $R$ 处。\n探头处的到达时间为：\n$$ t_{R_1} = \\frac{R_1}{c} = \\frac{0.5}{343} \\approx 0.001458 \\text{ s} $$\n$$ t_{R_2} = \\frac{R_2}{c} = \\frac{1.0}{343} \\approx 0.002915 \\text{ s} $$\n对于一个三维出射球面波，流过任何包围声源的半径为 $r$ 的球面的总声功率是恒定的。声强（单位面积的功率）为 $I_r \\propto p^2$。总功率为 $P = I_r \\times (\\text{面积}) = I_r \\times (4\\pi r^2)$。由于 $p \\propto 1/r$，则 $I_r \\propto p^2 \\propto 1/r^2$。因此，$P \\propto (1/r^2) \\times (4\\pi r^2)$，这与 $r$ 无关。验证数值计算的能量通量在不同半径的球面上是一致的，这是一个稳健的验证检验。\n\n**逐项分析**\n\n**A. 对于基准1，压力和速度分裂成速度为 $\\pm c$ 的左行波和右行波。在探头 $x = -L$ 处，首次非零信号到达时间为 $t^* = L/c \\approx 0.001458$ （秒）。到达后瞬间，$p(-L,t^*+) = p_0/2 = 0.5$ 且 $u(-L,t^*+) = -\\dfrac{p_0}{2 \\rho_0 c} \\approx -0.00121$ （米/秒），负号表示向左运动。一个稳健的验证必须包括一维离散声能检验，使用能量密度 $\\frac{1}{2}\\rho_0 u^2 + \\frac{1}{2}\\dfrac{p^2}{\\rho_0 c^2}$，并报告相对能量随时间的漂移。对于基准2，出射球面波的振幅衰减与 $1/r$ 成正比，半径 $R$ 处的脉冲峰值在 $t_R = R/c$ 到达，因此 $t_{R_1} \\approx 0.001458$ 且 $t_{R_2} \\approx 0.002915$ （秒）。峰值振幅比满足 $p_{\\max}(R_2)/p_{\\max}(R_1) = R_1/R_2 = 0.5$，一个适当的验证包括将测量的 $L^\\infty$ 振幅与 $1/r$ 定律进行比较，并进行球面上的能量通量一致性检验。**\n- 该选项对基准1的描述与上面推导的解析解完全一致：波的分裂、速度、到达时间以及到达后 $p$ 和 $u$ 的值都是正确的。提议的能量守恒检验是物理上正确的。\n- 对基准2的描述也完全正确：$1/r$ 振幅衰减、峰值到达时间、峰值振幅比以及提议的验证检验（$L^\\infty$ 范数衰减和能量通量）都是适当且准确的。\n- **结论：正确。**\n\n**B. 对于基准1，在 $x = -L$ 处的到达时间为 $t^* = 2L/c \\approx 0.002915$ （秒），并观察到完整跳跃 $p(-L,t^*+) = p_0 = 1.0$ 及 $u(-L,t^*+) = +\\dfrac{p_0}{\\rho_0 c}$ （米/秒）。验证基于 $p$ 的 $L^2$ 范数在空间上的守恒。对于基准2，振幅按 $1/r^2$ 衰减，峰值到达时间为 $t_{R_1} = R_1/c$ 和 $t_{R_2} = R_2/c$，且 $p_{\\max}(R_2)/p_{\\max}(R_1) = (R_1/R_2)^2 = 0.25$。**\n- 基准1：到达时间不正确（应为 $L/c$，不是 $2L/c$）。压力跳跃不正确（应为 $p_0/2$，不是 $p_0$）。速度的幅度和符号都不正确。$p$ 的 $L^2$ 范数对于该系统不是守恒量。\n- 基准2：振幅衰减定律不正确（应为 $1/r$，不是 $1/r^2$）。因此峰值振幅比也不正确。\n- **结论：错误。**\n\n**C. 对于基准1，选择探头在 $x = +L$ 处，并预期首次到达时间为 $t^* = L/c \\approx 0.001458$ （秒），$p(+L,t^*+) = p_0/2 = 0.5$ 且 $u(+L,t^*+) = +\\dfrac{p_0}{2 \\rho_0 c}$ （米/秒）。验证使用 $p$ 的 $L^2$ 范数，并要求其在数值容差范围内保持不变。对于基准2，半径 $R$ 处的振幅与 $R$ 无关，因此 $p_{\\max}(R_2)/p_{\\max}(R_1) = 1$，并且峰值在 $t_R = R/c$ 到达。**\n- 基准1：此选项修改了问题，将探头移至 $x=+L$。虽然对此新位置的物理描述大部分是正确的，但提议的验证度量（$p$ 的 $L^2$ 范数守恒）是不正确的。\n- 基准2：振幅与 $R$ 无关的说法是不正确的；这将描述一个平面波，而不是球面波，并且会违反能量守恒。\n- **结论：错误。**\n\n**D. 对于基准1，波速取决于初始跳跃的局域波数，因此由于色散，在 $x = -L$ 处的到达时间满足 $t^* > L/c$，并且到达后的平台值为 $p_0$，而 $u = 0$。对于基准2，球面脉冲表现出扩散性展宽，因此振幅衰减快于 $1/r^2$，半径 $R$ 处的峰值到达时间晚于 $R/c$，因此验证应侧重于匹配一个小于 $c$ 的频率相关的群速度和 $L^2$ 范数中的耗散衰减。**\n- 基准1：这是不正确的。指定的模型方程是非色散的；所有频率都以速度 $c$ 传播。到达时间恰好是 $L/c$。到达后的状态也是不正确的。\n- 基准2：这是不正确的。波动方程是双曲型的，不是抛物型的，所以它表现出传播，而不是扩散。所描述的现象（扩散性展宽、到达时间晚于 $R/c$、耗散）是不同物理模型（例如粘性流体或导热流体）的特征。\n- **结论：错误。**\n\n基于详细分析，选项 A 是唯一一个为两个基准问题提供了物理上和数学上都正确的验证标准的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在理解了理论基准之后，下一步便是通过构建并测试一个数值求解器来将理论付诸实践。本练习将指导你实现一个用于求解一维线性声学方程的二阶精度时域有限差分（FDTD）格式 。通过进行经验性收敛性研究，并将你的数值结果与已知的精确解进行比较，你将获得代码验证的实践经验，并直接观察到数值格式的理论精度阶数与其实际性能之间的关系。",
            "id": "4149240",
            "problem": "您的任务是设计并实现一个数值实验，以经验性地确定和比较一个瞬态求解器应用于一维线性声学问题时在时间和空间上的收敛率。该问题的控制一阶系统由可压缩介质中小扰动的质量守恒和动量守恒导出，由以下耦合系统给出：\n$$\\frac{\\partial p}{\\partial t} + K \\frac{\\partial u}{\\partial x} = 0,$$\n$$\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0,$$\n其中，$p$ 是声压，单位为 $\\mathrm{Pa}$；$u$ 是质点速度，单位为 $\\mathrm{m/s}$；$K$ 是体积模量，单位为 $\\mathrm{Pa}$；$\\rho$ 是质量密度，单位为 $\\mathrm{kg/m^3}$；$x$ 表示一维空间维度，单位为 $\\mathrm{m}$。波速为 $c = \\sqrt{K/\\rho}$，单位为 $\\mathrm{m/s}$。\n\n考虑空间域 $x \\in [0, L]$，其中 $L = 1$ $\\mathrm{m}$，并采用周期性边界条件。使用以下初始条件：\n$$p(x,0) = \\sin(2\\pi x) \\ \\mathrm{Pa}, \\quad u(x,0) = 0 \\ \\mathrm{m/s},$$\n其中角度应理解为弧度。对于这些数据，上述系统在时间 $t$ 的精确解为：\n$$p_{\\text{exact}}(x,t) = \\sin(2\\pi x)\\cos(2\\pi c t),$$\n$$u_{\\text{exact}}(x,t) = -\\frac{c}{K}\\cos(2\\pi x)\\sin(2\\pi c t).$$\n\n您必须实现一个二阶精度的显式瞬态求解器，该求解器在空间上使用中心差分，并采用时间上交错的蛙跳格式来对上述一阶系统在周期性边界条件下进行积分。设空间网格有 $N_x$ 个点，均匀间距为 $\\Delta x = L/N_x$。对空间导数使用中心差分近似，并交错时间积分，使得 $u$ 在半时间层推进，$p$ 在整数时间层推进。确保时间步长 $\\Delta t$ 满足与类对流双曲系统的显式二阶中心格式一致的 Courant-Friedrichs-Lewy (CFL) 稳定性限制，并在设计中量化经验精度，而不是依赖任何稳定性快捷公式；求解器必须仅依赖于基本定义和广泛接受的数值离散化原则。\n\n对于每次运行，计算声压 $p(x,t)$ 的解，直至达到指定的最终时间 $T$，并根据精确解评估离散 $L^2$ 范数误差：\n$$E = \\left( \\Delta x \\sum_{i=0}^{N_x-1} \\left[p_i(T) - p_{\\text{exact}}(x_i,T)\\right]^2 \\right)^{1/2},$$\n其中 $x_i = i \\Delta x$，$p_i(T)$ 表示在时间 $T$ 时节点 $i$ 处的数值压力。对于两次运行，其特征步长分别为 $h_1$ 和 $h_2$，对应误差分别为 $E_1$ 和 $E_2$，其经验收敛阶 (EOC) 计算如下：\n$$\\mathrm{EOC} = \\frac{\\log(E_1/E_2)}{\\log(h_1/h_2)}.$$\n当在时间上加密时，取 $h = \\Delta t$。当在空间上加密时，取 $h = \\Delta x$。\n\n您的程序必须使用系统性的加密方法计算时间和空间加密的经验收敛率，并将观察到的阶数与理论预测的阶数 $2$ 进行比较。使用以下物理参数：$\\rho = 1.2$ $\\mathrm{kg/m^3}$，$K = 142000$ $\\mathrm{Pa}$，这意味着 $c = \\sqrt{K/\\rho}$，单位为 $\\mathrm{m/s}$。\n\n实施四个测试用例以确保覆盖范围：\n- 测试用例 1（时间加密，理想情况）：$N_x = 1024$，$\\Delta t \\in \\{1.5\\times 10^{-6}, 7.5\\times 10^{-7}, 3.75\\times 10^{-7}\\}$ $\\mathrm{s}$，$T = 3.0\\times 10^{-5}$ $\\mathrm{s}$。计算连续加密 $\\Delta t$ 的误差和 EOC 值，然后报告两个连续对的平均 EOC，以及一个布尔值，指示平均 EOC 是否在理论阶数 $2$ 的 $\\pm 0.2$ 范围内。\n- 测试用例 2（接近稳定性边界的时间加密）：$N_x = 256$，设置 $\\Delta t$ 为 $\\{0.98, 0.49, 0.245\\}\\times \\Delta x / c$（单位 $\\mathrm{s}$），$T = 3.0\\times 10^{-4}$ $\\mathrm{s}$。计算误差、连续的 EOC、平均 EOC，以及一个具有相同 $\\pm 0.2$ 容差（围绕 2）的布尔通过/失败判定。\n- 测试用例 3（空间加密，理想情况）：$N_x \\in \\{64, 128, 256\\}$，其中 $\\Delta t$ 选择为 $\\Delta t = \\sigma \\Delta x^2 / c$（单位 $\\mathrm{s}$），使用 $\\sigma = 0.3$（无量纲），$T = 2.0\\times 10^{-5}$ $\\mathrm{s}$。计算误差、以 $h=\\Delta x$ 计算的连续 EOC、平均 EOC，以及一个具有相同 $\\pm 0.2$ 容差（围绕 2）的布尔通过/失败判定。\n- 测试用例 4（空间加密，粗网格边界）：$N_x \\in \\{16, 32, 64\\}$，其中 $\\Delta t = \\sigma \\Delta x^2 / c$ 同测试用例 3，$T = 2.0\\times 10^{-5}$ $\\mathrm{s}$。计算误差、以 $h=\\Delta x$ 计算的连续 EOC、平均 EOC，以及一个具有相同 $\\pm 0.2$ 容差（围绕 2）的布尔通过/失败判定。\n\n三角函数中的所有角度必须解释为弧度。时间值单位必须为 $\\mathrm{s}$，长度单位必须为 $\\mathrm{m}$，如上所述。您输出的量（EOC 值和布尔值）是无量纲的。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，具体如下：\n$$[\\text{EOC}_1, \\text{pass}_1, \\text{EOC}_2, \\text{pass}_2, \\text{EOC}_3, \\text{pass}_3, \\text{EOC}_4, \\text{pass}_4],$$\n其中 $\\text{EOC}_k$ 是测试用例 $k$ 的平均经验收敛阶，$\\text{pass}_k$ 是一个布尔值，指示测试用例 $k$ 的平均 EOC 是否在容差区间 $[2-0.2, 2+0.2]$ 内。",
            "solution": "该问题是有效的，因为它提出了一个适定的、有科学依据的计算声学任务，该任务是完整的、一致的，并且需要一个非平凡的数值解和分析。所有提供的数据、方程和条件都是标准的、可验证的。\n\n解决方案涉及实现一个用于一维线性声学方程的时域有限差分 (FDTD) 求解器，并进行经验收敛性研究。其方法分步详述如下。\n\n**1. 控制方程与离散化**\n\n该问题由声学的一阶线性系统控制：\n$$ \\frac{\\partial p}{\\partial t} + K \\frac{\\partial u}{\\partial x} = 0 $$\n$$ \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0 $$\n其中 $p$ 是声压，$u$ 是质点速度，$K$ 是体积模量，$\\rho$ 是质量密度。空间域为 $x \\in [0, L]$，其中 $L=1$ m，我们施加周期性边界条件。\n\n我们将空间域离散为 $N_x$ 个点 $x_i = i \\Delta x$，其中 $i = 0, 1, \\dots, N_x-1$，$\\Delta x = L/N_x$。时间以 $\\Delta t$ 的步长离散化。采用交错蛙跳格式，其中压力 $p_i^n$ 在整数时间步 $t^n = n \\Delta t$ 评估，速度 $u_i^{n+1/2}$ 在半整数时间步 $t^{n+1/2} = (n+1/2) \\Delta t$ 评估。\n\n空间导数使用二阶精度中心差分模板来近似：\n$$ \\frac{\\partial f}{\\partial x}\\bigg|_{x_i} \\approx \\frac{f_{i+1} - f_{i-1}}{2 \\Delta x} $$\n时间导数使用二阶中心差分（蛙跳）方法来近似：\n$$ \\frac{\\partial p}{\\partial t}\\bigg|_{(x_i, t^{n+1/2})} \\approx \\frac{p_i^{n+1} - p_i^n}{\\Delta t} $$\n$$ \\frac{\\partial u}{\\partial t}\\bigg|_{(x_i, t^{n})} \\approx \\frac{u_i^{n+1/2} - u_i^{n-1/2}}{\\Delta t} $$\n\n**2. 数值格式：交错蛙跳 (FDTD)**\n\n将离散近似代入控制方程，得到显式更新规则。$\\partial p / \\partial t$ 的方程在时间 $t^{n+1/2}$ 居中，$\\partial u / \\partial t$ 的方程在时间 $t^n$ 居中。这与标准的 Yee 交错网格在记法上略有不匹配，但得到的数值格式是相同且正确的。更一致的中心化将是：\n$$ \\frac{p_i^{n+1} - p_i^n}{\\Delta t} = -K \\frac{u_{i+1}^{n+1/2} - u_{i-1}^{n+1/2}}{2 \\Delta x} $$\n$$ \\frac{u_i^{n+1/2} - u_i^{n-1/2}}{\\Delta t} = -\\frac{1}{\\rho} \\frac{p_{i+1}^n - p_{i-1}^n}{2 \\Delta x} $$\n重新整理这些方程得到求解器的显式更新方程：\n1. 速度 $u$ 的更新：\n$$ u_i^{n+1/2} = u_i^{n-1/2} - \\frac{\\Delta t}{\\rho (2 \\Delta x)} (p_{i+1}^n - p_{i-1}^n) $$\n2. 压力 $p$ 的更新：\n$$ p_i^{n+1} = p_i^n - K \\frac{\\Delta t}{2 \\Delta x} (u_{i+1}^{n+1/2} - u_{i-1}^{n+1/2}) $$\n此格式在时间和空间上均为二阶精度，$O(\\Delta t^2, \\Delta x^2)$。\n\n**3. 格式初始化**\n\n模拟从 $t=0$ 开始，给定初始条件 $p(x,0)$ 和 $u(x,0)$。我们设置 $p_i^0 = \\sin(2\\pi x_i)$ 和 $u_i^0 = 0$。蛙跳格式需要 $u$ 在半时间步才能开始。为了求得 $u_i^{1/2}$，我们对 $u$ 从 $t=0$ 到 $t=\\Delta t/2$ 执行一次向前欧拉半步更新：\n$$ u_i^{1/2} = u_i^0 - \\frac{\\Delta t/2}{\\rho} \\left(\\frac{\\partial p}{\\partial x}\\right)_i^0 \\approx u_i^0 - \\frac{\\Delta t/2}{\\rho} \\frac{p_{i+1}^0 - p_{i-1}^0}{2\\Delta x} $$\n由于 $u_i^0=0$，这简化为：\n$$ u_i^{1/2} = - \\frac{\\Delta t}{4 \\rho \\Delta x} (p_{i+1}^0 - p_{i-1}^0) $$\n这个“启动”步骤的局部截断误差为 $O(\\Delta t^2)$，这与主蛙跳算法的全局二阶精度一致，并且不会降低整体收敛率。\n\n**4. 边界条件**\n\n周期性边界条件 $f(0,t) = f(L,t)$ 的实现方法是，确保对于网格点 $i$，当 $i=0$ 时其 $i-1$ 邻居为 $N_x-1$，当 $i=N_x-1$ 时其 $i+1$ 邻居为 $0$。在基于向量的实现中，这可以通过使用 `numpy.roll` 对表示场 $p$ 和 $u$ 的数组执行循环移位来高效处理。\n\n**5. 误差分析与经验收敛阶 (EOC)**\n\n数值解运行至最终时间 $T_{final}$。最终时间由 $T_{final} = N_t \\Delta t$ 确定，其中 $N_t = \\lceil T/\\Delta t \\rceil$，以确保模拟时间至少达到目标时间 $T$。数值压力 $p_i(T_{final})$ 的精度通过与精确解 $p_{\\text{exact}}(x_i, T_{final})$ 的离散 $L^2$ 范数来衡量：\n$$ E = \\left( \\Delta x \\sum_{i=0}^{N_x-1} \\left[p_i(T_{final}) - p_{\\text{exact}}(x_i, T_{final})\\right]^2 \\right)^{1/2} $$\n经验收敛阶 (EOC) 由两次运行计算得出，其特征步长分别为 $h_1$ 和 $h_2$（其中 $h$ 可以是 $\\Delta t$ 或 $\\Delta x$），对应误差为 $E_1$ 和 $E_2$：\n$$ \\mathrm{EOC} = \\frac{\\log(E_1/E_2)}{\\log(h_1/h_2)} $$\n对于 $h_2=h_1/2$ 的加密，这简化为 $\\mathrm{EOC} = \\log_2(E_1/E_2)$。\n\n**6. 收敛性研究设计**\n\n四个测试用例旨在验证该格式在时间和空间上的理论二阶收敛性。\n- **时间加密（用例 1  2）**：空间分辨率 $N_x$ 保持不变，而时间步长 $\\Delta t$ 被系统地加密。预计误差将由时间离散化主导，相对于 $\\Delta t$ 的 EOC 应约为 $2$。用例 1 使用精细的空间网格和小的 Courant 数，代表了理想情况。用例 2 探究接近稳定性极限（Courant 数 $\\approx 1$）的行为。\n- **空间加密（用例 3  4）**：空间分辨率 $N_x$ 被加密，时间步长 $\\Delta t$ 通过 $\\Delta t = \\sigma \\Delta x^2 / c$ 与空间步长耦合。总误差的形式为 $O(\\Delta t^2, \\Delta x^2) = O((\\Delta x^2)^2, \\Delta x^2) = O(\\Delta x^4, \\Delta x^2)$。随着 $\\Delta x$ 减小，$O(\\Delta x^2)$ 项将占主导地位。这种设计有效地隔离了空间收敛率，预计其约为 $2$。用例 3 使用相对精细的网格，而用例 4 使用粗糙的网格，其中前渐近效应可能会降低观察到的 EOC。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_solver(Nx, dt, T, L, K, rho, c):\n    \"\"\"\n    Solves the 1D linear acoustic equations using a second-order FDTD scheme.\n\n    Args:\n        Nx (int): Number of spatial grid points.\n        dt (float): Time step size.\n        T (float): Target final time.\n        L (float): Length of the spatial domain.\n        K (float): Bulk modulus.\n        rho (float): Mass density.\n        c (float): Wave speed.\n\n    Returns:\n        float: The L2-norm of the error in pressure at the final time.\n    \"\"\"\n    # Discretization parameters\n    dx = L / Nx\n    x = np.linspace(0, L, Nx, endpoint=False)\n    \n    # Adjust final time to be an integer multiple of dt\n    Nt = int(np.ceil(T / dt))\n    T_final = Nt * dt\n    \n    # Initialize fields based on initial conditions\n    # p is at t=0\n    p = np.sin(2 * np.pi * x)\n    # u is at t=0\n    u = np.zeros(Nx)\n    \n    # Kick-start: advance u to the first half-time step (t=dt/2)\n    # This uses a second-order accurate starter. A simpler one is fine too.\n    dpdx_0 = (np.roll(p, -1) - np.roll(p, 1)) / (2 * dx)\n    u = u - (dt / 2.0) / rho * dpdx_0\n    \n    # Main leapfrog time-stepping loop\n    # At start of loop n, p is at time n*dt and u is at (n-1/2)*dt\n    # The code implements a slightly different but valid leapfrog variant:\n    # Start: p at t=0, u at t=dt/2\n    # Loop: update p to t+dt, then update u to t+dt+dt/2\n    for _ in range(Nt):\n        # Update pressure p using u at the current half-step\n        # p^{n+1} = p^n - K*dt*grad(u^{n+1/2})\n        dudx_half = (np.roll(u, -1) - np.roll(u, 1)) / (2 * dx)\n        p = p - K * dt * dudx_half\n        \n        # Update velocity u using the just-computed p at the next full-step\n        # This is a bit unusual. A standard leapfrog would be u^{n+3/2} = u^{n+1/2} - dt/rho * grad(p^{n+1})\n        # The current code is u_new = u_old - dt/rho*grad(p_new)\n        dpdx_full = (np.roll(p, -1) - np.roll(p, 1)) / (2 * dx)\n        u = u - dt / rho * dpdx_full\n\n    # After the loop, p is evaluated at T_final\n    # Compute the exact solution for pressure at the final time\n    p_exact = np.sin(2 * np.pi * x) * np.cos(2 * np.pi * c * T_final)\n    \n    # Compute the discrete L2-norm of the error\n    error = np.sqrt(dx * np.sum((p - p_exact)**2))\n    \n    return error\n\ndef calculate_eoc(errors, h_steps):\n    \"\"\"Calculates the average EOC from a series of errors and step sizes.\"\"\"\n    eoc1 = np.log(errors[0] / errors[1]) / np.log(h_steps[0] / h_steps[1])\n    eoc2 = np.log(errors[1] / errors[2]) / np.log(h_steps[1] / h_steps[2])\n    avg_eoc = (eoc1 + eoc2) / 2.0\n    return avg_eoc\n\ndef solve():\n    \"\"\"\n    Main function to run the four test cases for the convergence study.\n    \"\"\"\n    # Define physical parameters\n    rho = 1.2\n    K = 142000.0\n    L = 1.0\n    c = np.sqrt(K / rho)\n    \n    all_results = []\n\n    # --- Test Case 1: Time refinement, happy path ---\n    Nx_1 = 1024\n    dts_1 = [1.5e-6, 7.5e-7, 3.75e-7]\n    T_1 = 3.0e-5\n    errors_1 = [run_solver(Nx_1, dt, T_1, L, K, rho, c) for dt in dts_1]\n    eoc_avg_1 = calculate_eoc(errors_1, dts_1)\n    pass_1 = 1.8 = eoc_avg_1 = 2.2\n    all_results.extend([eoc_avg_1, pass_1])\n\n    # --- Test Case 2: Time refinement near stability boundary ---\n    Nx_2 = 256\n    dx_2 = L / Nx_2\n    cfl_factors = [0.98, 0.49, 0.245]\n    dts_2 = [f * dx_2 / c for f in cfl_factors]\n    T_2 = 3.0e-4\n    errors_2 = [run_solver(Nx_2, dt, T_2, L, K, rho, c) for dt in dts_2]\n    eoc_avg_2 = calculate_eoc(errors_2, dts_2)\n    pass_2 = 1.8 = eoc_avg_2 = 2.2\n    all_results.extend([eoc_avg_2, pass_2])\n\n    # --- Test Case 3: Space refinement, happy path ---\n    Nxs_3 = [64, 128, 256]\n    sigma_3 = 0.3\n    T_3 = 2.0e-5\n    errors_3 = []\n    dxs_3 = []\n    for nx_val in Nxs_3:\n        dx_val = L / nx_val\n        dt_val = sigma_3 * dx_val**2 / c\n        errors_3.append(run_solver(nx_val, dt_val, T_3, L, K, rho, c))\n        dxs_3.append(dx_val)\n    eoc_avg_3 = calculate_eoc(errors_3, dxs_3)\n    pass_3 = 1.8 = eoc_avg_3 = 2.2\n    all_results.extend([eoc_avg_3, pass_3])\n    \n    # --- Test Case 4: Space refinement, coarse-grid boundary ---\n    Nxs_4 = [16, 32, 64]\n    sigma_4 = 0.3\n    T_4 = 2.0e-5\n    errors_4 = []\n    dxs_4 = []\n    for nx_val in Nxs_4:\n        dx_val = L / nx_val\n        dt_val = sigma_4 * dx_val**2 / c\n        errors_4.append(run_solver(nx_val, dt_val, T_4, L, K, rho, c))\n        dxs_4.append(dx_val)\n    eoc_avg_4 = calculate_eoc(errors_4, dxs_4)\n    pass_4 = 1.8 = eoc_avg_4 = 2.2\n    all_results.extend([eoc_avg_4, pass_4])\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "当你拥有一个经过验证的数值工具后，就可以用它来探索更复杂的物理现象和建模近似。本练习将比较材料平板瞬态散射的精确解与计算上更简单的初次玻恩近似解 。通过这种比较，你将学习如何运用瞬态分析技术来评估物理模型的有效性，并量化近似在不同频率和物理条件下的误差，这是科学建模中的一项关键技能。",
            "id": "4149281",
            "problem": "考虑一个法向入射的平面波被嵌入均匀背景介质中的有限厚度夹杂物所引起的一维瞬态声散射问题，此问题基于线性声学和无损介质的假设。设背景介质的声速为 $c_1$，质量密度为 $\\rho_1$，夹杂物为一厚度为 $L$ 的均匀平板，其声速为 $c_2$，质量密度为 $\\rho_2$。声阻抗为 $Z = \\rho c$，角频率为 $\\omega$，对应的波数为 $k = \\omega / c$。该平板两侧均嵌入在背景介质中。一个入射时域压力波形 $p_{\\mathrm{inc}}(t)$ 从左侧入射到平板上，产生一个在入射侧测量的反射（散射）压力 $p_{\\mathrm{sc}}(t)$。\n\n从线性声学的基本原理出发，在界面处施加压力和质点速度的连续性条件，并假设平面波在法向入射下传播。使用以下物理上一致且被广泛接受的事实：\n\n- 对于阻抗分别为 $Z_i$ 和 $Z_j$ 的介质之间的单个界面，在法向入射时，压力振幅的反射系数为 $r_{ij} = (Z_j - Z_i) / (Z_j + Z_i)$。\n- 对于对称嵌入介质1中的厚度为 $L$ 的均匀平板（介质2），其精确的频域反射系数 $R_{\\mathrm{exact}}(\\omega)$ 可以通过对多次内部反射形成的无穷级数求和来构建（Fabry–Perot 公式）。\n- 在弱对比度情况下，一阶玻恩近似 $R_{\\mathrm{Born}}(\\omega)$ 只保留单次散射项，并忽略了多次内部反射。\n\n你的任务是实现一个完整的、可运行的程序，该程序能够：\n\n$1.$ 构建一个高斯调制的余弦实数入射波形\n$$\np_{\\mathrm{inc}}(t) = \\exp\\!\\left(-\\frac{(t - t_0)^2}{2 \\tau^2}\\right)\\cos(2\\pi f_0 t),\n$$\n其中 $t_0$ 是时间偏移，$\\tau$ 是根据所需相对带宽选择的高斯标准差。对于基带高斯，时域高斯标准差与频域标准差之间的关系为 $\\sigma_f = \\frac{1}{2\\pi \\tau}$。使用此关系，针对中心频率为 $f_0$ 的目标相对带宽 $\\mathrm{BW}$，设置 $\\tau = \\frac{1}{2\\pi\\,\\mathrm{BW}\\,f_0}$。\n\n$2.$ 在频域中，使用以下公式计算两侧嵌入相同背景介质中的平板的精确反射系数\n$$\nr = \\frac{Z_2 - Z_1}{Z_2 + Z_1}, \\quad Z_1 = \\rho_1 c_1, \\quad Z_2 = \\rho_2 c_2, \\quad \\beta(\\omega)=k_2 L=\\frac{\\omega L}{c_2},\n$$\n和精确反射系数\n$$\nR_{\\mathrm{exact}}(\\omega) = \\frac{r \\left(1 - e^{2 i \\beta(\\omega)}\\right)}{1 - r^2 e^{2 i \\beta(\\omega)}}.\n$$\n\n$3.$ 计算一阶玻恩近似反射系数\n$$\nR_{\\mathrm{Born}}(\\omega) = r \\left(1 - e^{2 i \\beta(\\omega)}\\right),\n$$\n这对应于各单界面反射的总和，并考虑了穿过平板的相应相位累积，但忽略了多次内部反射。\n\n$4.$ 形成散射谱 $P_{\\mathrm{sc,exact}}(\\omega) = R_{\\mathrm{exact}}(\\omega) P_{\\mathrm{inc}}(\\omega)$ 和 $P_{\\mathrm{sc,Born}}(\\omega) = R_{\\mathrm{Born}}(\\omega) P_{\\mathrm{inc}}(\\omega)$，其中 $P_{\\mathrm{inc}}(\\omega)$ 是 $p_{\\mathrm{inc}}(t)$ 的离散傅里叶变换 (DFT)。然后通过逆DFT计算时域散射信号 $p_{\\mathrm{sc,exact}}(t)$ 和 $p_{\\mathrm{sc,Born}}(t)$。\n\n$5.$ 在时域和频域中量化近似误差：\n- 时域归一化均方根误差 (NRMSE)：\n$$\nE_t = \\sqrt{\\frac{\\sum_{n} \\left( p_{\\mathrm{sc,exact}}(t_n) - p_{\\mathrm{sc,Born}}(t_n) \\right)^2}{\\sum_{n} \\left( p_{\\mathrm{sc,exact}}(t_n) \\right)^2}}.\n$$\n- 由入射谱加权的频域NRMSE：\n$$\nE_f = \\sqrt{\\frac{\\sum_{m} \\left| \\left(R_{\\mathrm{exact}}(\\omega_m) - R_{\\mathrm{Born}}(\\omega_m)\\right) P_{\\mathrm{inc}}(\\omega_m) \\right|^2}{\\sum_{m} \\left| R_{\\mathrm{exact}}(\\omega_m) P_{\\mathrm{inc}}(\\omega_m) \\right|^2}}.\n$$\n\n对所有测试用例使用以下数值离散化方案，以确保一致的采样和带宽覆盖：总时间窗口 $T = 0.1\\,\\mathrm{s}$，采样点数 $N = 32768$（2的幂），采样间隔 $\\Delta t = T / N$。将高斯脉冲中心置于 $t_0 = 0.03\\,\\mathrm{s}$。角度和相位必须以弧度为单位。所有物理量必须在国际单位制（SI）下解释：$c$ 单位为 $\\mathrm{m/s}$，$\\rho$ 单位为 $\\mathrm{kg/m^3}$，$L$ 单位为 $\\mathrm{m}$，$t$ 单位为 $\\mathrm{s}$，$f$ 单位为 $\\mathrm{Hz}$。最终的误差度量 $E_t$ 和 $E_f$ 是无量纲浮点数。\n\n实现该程序以评估以下参数集测试套件，这些测试套件的选择旨在覆盖一般情况、极弱对比度情况、强调内部多路径的厚板情况以及薄板边界情况：\n\n- 测试用例1（一般“理想”情况）：$c_1 = 1500\\,\\mathrm{m/s}$，$\\rho_1 = 1000\\,\\mathrm{kg/m^3}$， $c_2 = 1450\\,\\mathrm{m/s}$，$\\rho_2 = 1020\\,\\mathrm{kg/m^3}$，$L = 0.4\\,\\mathrm{m}$，$f_0 = 5000\\,\\mathrm{Hz}$，$\\mathrm{BW} = 0.3$。\n- 测试用例2（极弱对比度）：$c_1 = 1500\\,\\mathrm{m/s}$，$\\rho_1 = 1000\\,\\mathrm{kg/m^3}$，$c_2 = 1497\\,\\mathrm{m/s}$，$\\rho_2 = 1001\\,\\mathrm{kg/m^3}$，$L = 0.4\\,\\mathrm{m}$，$f_0 = 5000\\,\\mathrm{Hz}$，$\\mathrm{BW} = 0.3$。\n- 测试用例3（厚板）：$c_1 = 1500\\,\\mathrm{m/s}$，$\\rho_1 = 1000\\,\\mathrm{kg/m^3}$，$c_2 = 1450\\,\\mathrm{m/s}$，$\\rho_2 = 1020\\,\\mathrm{kg/m^3}$，$L = 3.0\\,\\mathrm{m}$，$f_0 = 5000\\,\\mathrm{Hz}$，$\\mathrm{BW} = 0.3$。\n- 测试用例4（薄板边界）：$c_1 = 1500\\,\\mathrm{m/s}$，$\\rho_1 = 1000\\,\\mathrm{kg/m^3}$，$c_2 = 1450\\,\\mathrm{m/s}$，$\\rho_2 = 1020\\,\\mathrm{kg/m^3}$，$L = 0.001\\,\\mathrm{m}$，$f_0 = 5000\\,\\mathrm{Hz}$，$\\mathrm{BW} = 0.3$。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表按顺序汇总了所有测试用例的误差度量，格式为 $[E_{t,1},E_{f,1},E_{t,2},E_{f,2},E_{t,3},E_{f,3},E_{t,4},E_{f,4}]$，其中 $E_{t,i}$ 和 $E_{f,i}$ 分别对应测试用例 $i$ 的时域和频域NRMSE。每个条目必须是浮点数。",
            "solution": "该问题要求对均匀平板一维声散射的精确模型和近似模型进行对比分析。该分析将通过模拟瞬态声脉冲的反射，在时域和频域中进行。解决方案涉及数值信号处理和波传播基本原理的应用。\n\n第一步是建立计算域。总时间窗口为 $T = 0.1\\,\\mathrm{s}$，采样点数为 $N = 32768$，这定义了时间网格。时间步长为 $\\Delta t = T / N$。离散时间点为 $t_n = n \\Delta t$，$n = 0, 1, \\dots, N-1$。相应的频域由与离散傅里叶变换 (DFT) 相关的角频率 $\\omega_m$ 定义。这些频率由采样率 $f_s = 1/\\Delta t$ 和采样点数 $N$ 决定。离散角频率由 $\\omega_m = 2 \\pi f_m$ 给出，其中频率 $f_m$ 的范围从负值到正值，这是DFT分析中的标准做法。\n\n入射压力波形 $p_{\\mathrm{inc}}(t)$ 是一个中心位于 $t_0 = 0.03\\,\\mathrm{s}$ 的高斯调制余弦脉冲：\n$$\np_{\\mathrm{inc}}(t) = \\exp\\left(-\\frac{(t - t_0)^2}{2 \\tau^2}\\right)\\cos(2\\pi f_0 t)\n$$\n参数 $\\tau$ 控制脉冲持续时间，并与其频率带宽相关。对于高斯包络，频域标准差 $\\sigma_f$ 与时域标准差 $\\tau$ 的关系为 $\\sigma_f = 1/(2\\pi\\tau)$。问题在中心频率 $f_0$ 处定义了一个相对带宽 $\\mathrm{BW}$。通过将带宽与频域标准差关联，我们设置 $\\sigma_f = \\mathrm{BW} \\cdot f_0$，由此得到 $\\tau$ 的表达式：\n$$\n\\tau = \\frac{1}{2\\pi \\sigma_f} = \\frac{1}{2\\pi\\,\\mathrm{BW}\\,f_0}\n$$\n该入射波形被生成为离散时间序列 $p_{\\mathrm{inc}}(t_n)$。其频域表示 $P_{\\mathrm{inc}}(\\omega)$ 使用快速傅里叶变换 (FFT) 计算，这是一种用于DFT的高效算法。\n\n问题的核心在于对来自平板的反射进行建模。厚度为 $L$、声速为 $c_2$、密度为 $\\rho_2$ 的平板嵌入在属性为 $c_1$ 和 $\\rho_1$ 的背景介质中。声学特性被封装在声阻抗 $Z = \\rho c$ 中。两种介质之间的阻抗失配决定了反射。对于从介质1入射到介质2的波，其压力的单界面反射系数为：\n$$\nr = \\frac{Z_2 - Z_1}{Z_2 + Z_1} \\quad \\text{where} \\quad Z_1 = \\rho_1 c_1, \\ Z_2 = \\rho_2 c_2\n$$\n当波遇到平板时，它会在前后界面之间经历一系列无穷多次的内部反射。平板的精确反射系数 $R_{\\mathrm{exact}}(\\omega)$ 考虑了所有这些多次反射。它是通过对反射回声源方向的波所形成的几何级数求和得出的。这个求和过程得到了所提供的 Fabry-Perot 公式：\n$$\nR_{\\mathrm{exact}}(\\omega) = \\frac{r \\left(1 - e^{2 i \\beta(\\omega)}\\right)}{1 - r^2 e^{2 i \\beta(\\omega)}}\n$$\n此处，$\\beta(\\omega) = k_2 L = \\omega L/c_2$ 是在角频率 $\\omega$ 下，波单程穿过平板厚度 $L$ 时累积的相移。项 $e^{2i\\beta(\\omega)}$ 代表往返的相位变化。分母项 $1 - r^2 e^{2i\\beta(\\omega)}$ 则考虑了所有多次反射波的干涉效应。\n\n一阶玻恩近似通过只考虑单次散射事件来简化这一图像。这对应于一个弱散射假设，即反射系数 $r$ 很小（$|r| \\ll 1$），使得 $r^2$ 及更高阶项可以忽略不计。将 $R_{\\mathrm{exact}}(\\omega)$ 展开为 $r^2$ 的幂级数：\n$$\nR_{\\mathrm{exact}}(\\omega) = r \\left(1 - e^{2 i \\beta(\\omega)}\\right) \\sum_{n=0}^{\\infty} \\left(r^2 e^{2 i \\beta(\\omega)}\\right)^n = r \\left(1 - e^{2 i \\beta(\\omega)}\\right) \\left[1 + r^2 e^{2 i \\beta(\\omega)} + O(r^4)\\right]\n$$\n如问题中所定义，一阶玻恩近似只保留该级数的首项（$n=0$），从而实际上忽略了平板内的所有多次反射：\n$$\nR_{\\mathrm{Born}}(\\omega) = r \\left(1 - e^{2 i \\beta(\\omega)}\\right)\n$$\n该表达式在物理上可以解释为来自前界面的反射（项 $r$）和来自后界面的反射（项 $-r e^{2i\\beta(\\omega)}$）之间的干涉，并假设透射系数近似为1。\n\n有了入射脉冲的频域表示 $P_{\\mathrm{inc}}(\\omega)$ 以及反射系数 $R_{\\mathrm{exact}}(\\omega)$ 和 $R_{\\mathrm{Born}}(\\omega)$，散射压力谱可通过乘法计算：\n$$\nP_{\\mathrm{sc,exact}}(\\omega) = R_{\\mathrm{exact}}(\\omega) P_{\\mathrm{inc}}(\\omega)\n$$\n$$\nP_{\\mathrm{sc,Born}}(\\omega) = R_{\\mathrm{Born}}(\\omega) P_{\\mathrm{inc}}(\\omega)\n$$\n然后使用快速傅里叶逆变换 (IFFT) 将这些谱变换回时域，以获得散射压力信号 $p_{\\mathrm{sc,exact}}(t)$ 和 $p_{\\mathrm{sc,Born}}(t)$。由于输入的物理信号是实数，因此取IFFT结果的实部。\n\n最后，使用时域和频域中的归一化均方根误差 (NRMSE) 来量化玻恩近似的误差。时域误差 $E_t$ 测量了两个散射波形之间的归一化差异：\n$$\nE_t = \\sqrt{\\frac{\\sum_{n} \\left( p_{\\mathrm{sc,exact}}(t_n) - p_{\\mathrm{sc,Born}}(t_n) \\right)^2}{\\sum_{n} \\left( p_{\\mathrm{sc,exact}}(t_n) \\right)^2}}\n$$\n频域误差 $E_f$ 比较了散射谱，并通过入射谱进行加权，以关注信号能量所在的频带：\n$$\nE_f = \\sqrt{\\frac{\\sum_{m} \\left| \\left(R_{\\mathrm{exact}}(\\omega_m) - R_{\\mathrm{Born}}(\\omega_m)\\right) P_{\\mathrm{inc}}(\\omega_m) \\right|^2}{\\sum_{m} \\left| R_{\\mathrm{exact}}(\\omega_m) P_{\\mathrm{inc}}(\\omega_m) \\right|^2}} = \\sqrt{\\frac{\\sum_{m} \\left| P_{\\mathrm{sc,exact}}(\\omega_m) - P_{\\mathrm{sc,Born}}(\\omega_m) \\right|^2}{\\sum_{m} \\left| P_{\\mathrm{sc,exact}}(\\omega_m) \\right|^2}}\n$$\n这一完整流程将应用于每个测试用例，并汇总所得的误差度量。在 $E_f$ 的误差计算中，分子测量的是误差信号的积分功率，而分母测量的则是真实散射信号的积分功率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft, ifft, fftfreq\n\ndef solve():\n    \"\"\"\n    Solves the acoustic scattering problem for the given test cases.\n    \"\"\"\n    # Numerical discretization parameters\n    T = 0.1  # s\n    N = 32768\n    t0 = 0.03  # s\n    dt = T / N\n\n    # Time and frequency vectors\n    t = np.arange(N) * dt\n    freq = fftfreq(N, dt)\n    omega = 2 * np.pi * freq\n\n    # (c1, rho1, c2, rho2, L, f0, BW)\n    test_cases = [\n        (1500.0, 1000.0, 1450.0, 1020.0, 0.4, 5000.0, 0.3),\n        (1500.0, 1000.0, 1497.0, 1001.0, 0.4, 5000.0, 0.3),\n        (1500.0, 1000.0, 1450.0, 1020.0, 3.0, 5000.0, 0.3),\n        (1500.0, 1000.0, 1450.0, 1020.0, 0.001, 5000.0, 0.3),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c1, rho1, c2, rho2, L, f0, BW = case\n\n        # 1. Construct incident waveform\n        # Avoid division by zero if f0 or BW is zero\n        if f0 == 0 or BW == 0:\n            tau = float('inf')\n        else:\n            tau = 1.0 / (2 * np.pi * BW * f0)\n        \n        p_inc_t = np.exp(-(t - t0)**2 / (2 * tau**2)) * np.cos(2 * np.pi * f0 * t)\n\n        # 2. Compute spectrum of incident waveform\n        p_inc_w = fft(p_inc_t)\n\n        # 3. Compute reflection coefficients\n        Z1 = rho1 * c1\n        Z2 = rho2 * c2\n        r = (Z2 - Z1) / (Z2 + Z1)\n        \n        # Add a small epsilon to c2 to prevent division by zero for omega if c2 were 0\n        beta = omega * L / (c2 + 1e-12)\n        \n        exp_term = np.exp(2j * beta)\n        \n        # Numerator is common for both R_exact and R_born\n        numerator_R = r * (1 - exp_term)\n        \n        # Denominator for R_exact\n        denominator_R_exact = 1 - r**2 * exp_term\n        \n        # Handle potential division by zero, though unlikely with given params\n        # if any part of denominator is zero, we'd get a warning.\n        # This is physically a resonance, but we handle it numerically.\n        R_exact_w = np.divide(numerator_R, denominator_R_exact, \n                              out=np.zeros_like(numerator_R, dtype=np.complex128),\n                              where=denominator_R_exact!=0)\n        \n        R_born_w = numerator_R\n        \n        # 4. Form scattered spectra and time-domain signals\n        p_sc_exact_w = R_exact_w * p_inc_w\n        p_sc_born_w = R_born_w * p_inc_w\n\n        p_sc_exact_t = np.real(ifft(p_sc_exact_w))\n        p_sc_born_t = np.real(ifft(p_sc_born_w))\n\n        # 5. Quantify approximation error\n        \n        # Time-domain NRMSE\n        diff_t_sq = np.square(p_sc_exact_t - p_sc_born_t)\n        norm_t_sq = np.square(p_sc_exact_t)\n        sum_norm_t_sq = np.sum(norm_t_sq)\n        \n        if sum_norm_t_sq == 0:\n            # If the exact signal is zero, error is 0 only if approx is also zero\n            e_t = 0.0 if np.sum(diff_t_sq) == 0 else float('inf')\n        else:\n            e_t = np.sqrt(np.sum(diff_t_sq) / sum_norm_t_sq)\n\n        # Frequency-domain NRMSE\n        diff_f_sq = np.square(np.abs(p_sc_exact_w - p_sc_born_w))\n        norm_f_sq = np.square(np.abs(p_sc_exact_w))\n        sum_norm_f_sq = np.sum(norm_f_sq)\n\n        if sum_norm_f_sq == 0:\n            e_f = 0.0 if np.sum(diff_f_sq) == 0 else float('inf')\n        else:\n            e_f = np.sqrt(np.sum(diff_f_sq) / sum_norm_f_sq)\n            \n        results.extend([e_t, e_f])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}