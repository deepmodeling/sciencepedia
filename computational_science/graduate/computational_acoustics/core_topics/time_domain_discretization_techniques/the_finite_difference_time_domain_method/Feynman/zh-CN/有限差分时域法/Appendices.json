{
    "hands_on_practices": [
        {
            "introduction": "在着手构建复杂的数值模型之前，进行“信封背面”式的计算来预估所需计算资源是至关重要的。这项练习将向您展示如何估算FDTD模拟所需的随机存取存储器（RAM），这是规划任何大规模数值项目时关键的第一步。通过这个实践，您将学会如何将网格大小和场分量等抽象参数与实际的硬件约束联系起来。",
            "id": "1581133",
            "problem": "一位研究人员正在使用时域有限差分 (FDTD) 方法开发一个一维 (1D) 模拟，以模拟波的传播。该模拟的空间域被离散化为一个由 1,250,000 个单元组成的网格。在这个简化的 1D 模型中，每个时间步都必须追踪两个不同的场分量（一个电场分量，一个磁场分量）。这两个分量中每一个的值都必须为网格中的每个单元进行存储。每个场值由一个双精度浮点数表示，占用 8 字节的计算机内存。\n\n计算在单个时间步内，存储整个网格上这两个场分量数据所需的最小随机存取存储器 (RAM) 容量。为便于计算，定义 1 兆字节 (MB) 等于 $10^6$ 字节。请以兆字节 (MB) 为单位表示最终答案。",
            "solution": "目标是计算存储一维 FDTD 模拟网格的场数据所需的总内存。我们已知单元数量、每个单元的场分量数量、每个场值的内存占用，以及字节到兆字节的转换因子。\n\n**第 1 步：确定已知量。**\n- 网格单元数，$N_{cells} = 1,250,000$。\n- 每个单元需存储的场分量数，$N_{fields} = 2$。\n- 存储一个场值所需的内存，$M_{value} = 8$ 字节。\n- 转换因子：1 兆字节 (MB) = $10^6$ 字节。\n\n**第 2 步：计算需要存储的数据点总数。**\n模拟需要在网格的每个单元中存储两个场分量。因此，需要存储在内存中的独立浮点值的总数是单元数与每个单元场分量数的乘积。\n$$ \\text{数据点总数} = N_{cells} \\times N_{fields} $$\n$$ \\text{数据点总数} = 1,250,000 \\times 2 = 2,500,000 $$\n\n**第 3 步：计算以字节为单位的总内存需求。**\n这些数据点中的每一个都是一个占用 8 字节的双精度数。要计算以字节为单位的总内存需求，我们将数据点总数乘以每个数据点的内存大小。\n$$ \\text{总内存（字节）} = (\\text{数据点总数}) \\times M_{value} $$\n$$ \\text{总内存（字节）} = 2,500,000 \\times 8 \\text{ 字节} = 20,000,000 \\text{ 字节} $$\n\n**第 4 步：将总内存从字节转换为兆字节。**\n题目规定 1 MB 等于 $10^6$ 字节。我们可以使用这个转换因子将结果表示为所需的单位。\n$$ \\text{总内存（MB）} = \\frac{\\text{总内存（字节）}}{\\text{每 MB 的字节数}} $$\n$$ \\text{总内存（MB）} = \\frac{20,000,000 \\text{ 字节}}{10^6 \\text{ 字节/MB}} $$\n$$ \\text{总内存（MB）} = 20 \\text{ MB} $$\n\n因此，在模拟的单个时间步中，需要至少 20 MB 的 RAM 来存储指定的场数据。",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "FDTD方法的稳定性由著名的Courant-Friedrichs-Lewy（CFL）条件决定，该条件将空间离散步长 $\\Delta z$ 与时间离散步长 $\\Delta t$ 联系起来。这项基础练习将指导您计算模拟中的最大稳定时间步长，这是防止解出现非物理性的爆炸性增长所必须遵守的步骤。掌握CFL条件是成功运行任何FDTD模拟的前提。",
            "id": "1581145",
            "problem": "一位研究人员正在开发一个用于模拟光在硅基集成光子电路中传播的数值模型。该模型使用时域有限差分（FDTD）方法沿对应于直波导核心的一维路径求解麦克斯韦方程组。空间域被离散化为一个均匀网格，单元尺寸为 $\\Delta z = 1.50 \\, \\mu\\text{m}$。波导核心由硅制成，可将其建模为一种简单的、非磁性的、无损耗的电介质，其相对介电常数为 $\\epsilon_r = 11.68$。\n\n为确保 FDTD 模拟保持数值稳定并产生具有物理意义的结果，必须谨慎选择模拟中使用的时间步长 $\\Delta t$。计算能保证此一维模拟稳定性的最大可能时间步长 $\\Delta t_{\\text{max}}$。\n\n在您的计算中，使用真空中的光速 $c = 2.998 \\times 10^8 \\, \\text{m/s}$。\n\n请用飞秒（$fs$）表示您的最终答案。将您的最终答案四舍五入至三位有效数字。",
            "solution": "对于一维 Yee FDTD 格式，库朗稳定性条件要求基于介质中波速的库朗数满足\n$$\nS \\equiv \\frac{v\\,\\Delta t}{\\Delta z} \\leq 1,\n$$\n其中 $v$ 是电磁波在介质中的传播速度。因此，最大稳定时间步长为\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z}{v}.\n$$\n在相对介电常数为 $\\epsilon_{r}$ 且 $\\mu_{r}=1$ 的简单、非磁性、无损耗电介质中，波速为\n$$\nv=\\frac{1}{\\sqrt{\\mu \\epsilon}}=\\frac{c}{\\sqrt{\\epsilon_{r}}},\n$$\n因此\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z\\,\\sqrt{\\epsilon_{r}}}{c}.\n$$\n\n代入给定值 $\\Delta z=1.50 \\times 10^{-6}\\, \\text{m}$，$\\epsilon_{r}=11.68$ 和 $c=2.998 \\times 10^{8}\\, \\text{m/s}$，\n$$\n\\Delta t_{\\text{max}}=\\frac{\\left(1.50 \\times 10^{-6}\\right)\\sqrt{11.68}}{2.998 \\times 10^{8}}\\, \\text{s}.\n$$\n计算 $\\sqrt{11.68} \\approx 3.4176$，得到\n$$\n\\Delta t_{\\text{max}}=\\frac{1.50 \\times 10^{-6} \\times 3.4176}{2.998 \\times 10^{8}}\\, \\text{s}\n=\\frac{5.1264 \\times 10^{-6}}{2.998 \\times 10^{8}}\\, \\text{s}\n=\\left(\\frac{5.1264}{2.998}\\right)\\times 10^{-14}\\, \\text{s}\n\\approx 1.70995 \\times 10^{-14}\\, \\text{s}.\n$$\n使用 $1\\, \\text{fs}=10^{-15}\\, \\text{s}$ 将其转换为飞秒，\n$$\n\\Delta t_{\\text{max}} \\approx 17.0995\\, \\text{fs}.\n$$\n四舍五入至三位有效数字，得到 $17.1\\, \\text{fs}$。",
            "answer": "$$\\boxed{17.1}$$"
        },
        {
            "introduction": "虽然应用CFL条件是实际操作中的必需步骤，但理解其理论根源是精通数值方法的关键。这项高级练习要求您执行冯·诺依曼稳定性分析，通过推导放大因子 $\\lambda$ 来从解析上证明当Courant数 $\\sigma$ 超出其极限时，FDTD格式为何以及如何变得不稳定。这项实践将加深您对数值色散和稳定性的理论理解。",
            "id": "4141995",
            "problem": "考虑由标量波动方程描述的一维无损线性声学，该方程针对声压 $p(x,t)$：\n$$\n\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2}\\,\\frac{\\partial^{2} p}{\\partial x^{2}},\n$$\n其中 $c$ 是声速。在均匀网格上使用标准的二阶中心差分格式对该方程进行空间和时间上的离散化，且空间和时间网格点位于同一位置（无交错）。也就是说，令 $x_i = i\\,\\Delta x$ 和 $t^n = n\\,\\Delta t$（其中 $i$ 和 $n$ 为整数），并用中心有限差分近似二阶导数，以获得一个时域有限差分 (FDTD) 类型的完全显式时间推进格式，其中时域有限差分 (FDTD) 指的是用有限差分代替连续导数，并以离散时间步长推进。\n\n执行冯·诺依曼 (von Neumann) 稳定性分析（傅里叶分析）：假设一个离散傅里叶模式 $p_i^n = \\lambda^n \\exp(\\mathrm{i} k x_i)$，并推导放大因子 $\\lambda$ 所满足的标量二次方程，该方程是无量纲 Courant 数 $\\sigma = c\\,\\Delta t / \\Delta x$ 和无量纲波数 $\\theta = k\\,\\Delta x$ 的函数。利用此方程获得两个根 $\\lambda_{\\pm}(\\theta)$ 及其模的解析表达式。\n\n现在，提供一个具体的数值示例，其中 $c = 343$ m/s（室温下空气中的声速），$\\Delta x = 0.01$ m，并选择 $\\Delta t$ 使 Courant 数等于 $\\sigma = c\\,\\Delta t/\\Delta x = 1.05$。对于均匀网格上最关键的离散空间傅里叶模式，即 $\\theta = \\pi$ 的奈奎斯特模式，计算不稳定根的模 $|\\lambda|$。将答案四舍五入到四位有效数字。最终结果以无量纲数表示（无单位）。在此过程中，通过证明对于该模式有 $|\\lambda| > 1$，来解析地说明为什么当 $\\sigma = 1.05$ 时该格式变得不稳定。",
            "solution": "本题要求验证一个关于一维声学波动方程的时域有限差分 (FDTD) 格式稳定性的问题，并在问题有效的情况下进行求解。\n\n### 问题验证\n\n**第1步：提取给定信息**\n-   **控制方程**：$\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2}\\,\\frac{\\partial^{2} p}{\\partial x^{2}}$，用于声压 $p(x,t)$ 和声速 $c$。\n-   **离散化**：在均匀、非交错网格上采用标准的空间和时间二阶中心差分格式。\n-   **网格**：$x_i = i\\,\\Delta x$ 和 $t^n = n\\,\\Delta t$。\n-   **分析方法**：冯·诺依曼 (von Neumann) 稳定性分析（傅里叶分析）。\n-   **拟设**：离散傅里叶模式 $p_i^n = \\lambda^n \\exp(\\mathrm{i} k x_i)$。\n-   **定义**：Courant 数 $\\sigma = c\\,\\Delta t / \\Delta x$；无量纲波数 $\\theta = k\\,\\Delta x$。\n-   **任务**：\n    1.  推导放大因子 $\\lambda$ 的标量二次方程。\n    2.  求出根 $\\lambda_{\\pm}(\\theta)$ 及其模的解析表达式。\n    3.  对于数值示例 $c = 343$ m/s, $\\Delta x = 0.01$ m, $\\sigma = 1.05$，分析奈奎斯特模式 ($\\theta = \\pi$)。\n    4.  解析地证明为何对于这些参数，该格式是不稳定的。\n    5.  计算不稳定根的模 $|\\lambda|$，并四舍五入到四位有效数字。\n\n**第2步：使用提取的给定信息进行验证**\n-   **科学基础**：该问题基于基本的线性波动方程，并采用标准、严谨的数值分析技术（FDTD、冯·诺依曼稳定性分析）。所有概念都是计算物理和工程领域的基础内容。给定的物理常数是现实的。该问题在科学上是合理的。\n-   **适定性**：问题陈述清晰，提供了所有必要信息：偏微分方程、具体的数值方法、分析技术以及数值计算所需的所有参数。它导向一个唯一且有意义的解。\n-   **客观性**：该问题使用精确、无歧义的技术语言表述。诸如“二阶中心差分”、“奈奎斯特模式”和“Courant 数”等术语具有标准的、客观的定义。\n\n**第3步：结论与行动**\n该问题具有科学性、适定性和客观性，是有效的。它不包含可辨别的缺陷。将提供完整的解答。\n\n### 解答\n\n**1. 波动方程的离散化**\n\n一维波动方程由下式给出：\n$$\n\\frac{\\partial^{2} p}{\\partial t^{2}} = c^{2}\\,\\frac{\\partial^{2} p}{\\partial x^{2}}\n$$\n我们在均匀网格上离散化该方程，其中 $p(x_i, t^n)$ 表示为 $p_i^n$。我们使用二阶精度的中心有限差分来近似二阶导数：\n$$\n\\frac{\\partial^{2} p}{\\partial t^{2}}\\bigg|_{i,n} \\approx \\frac{p_i^{n+1} - 2p_i^n + p_i^{n-1}}{(\\Delta t)^{2}}\n$$\n$$\n\\frac{\\partial^{2} p}{\\partial x^{2}}\\bigg|_{i,n} \\approx \\frac{p_{i+1}^n - 2p_i^n + p_{i-1}^n}{(\\Delta x)^{2}}\n$$\n将这些近似代入波动方程得到：\n$$\n\\frac{p_i^{n+1} - 2p_i^n + p_i^{n-1}}{(\\Delta t)^{2}} = c^{2} \\frac{p_{i+1}^n - 2p_i^n + p_{i-1}^n}{(\\Delta x)^{2}}\n$$\n整理各项以获得 $p_i^{n+1}$ 的显式表达式：\n$$\np_i^{n+1} = 2p_i^n - p_i^{n-1} + \\frac{c^{2}(\\Delta t)^{2}}{(\\Delta x)^{2}} (p_{i+1}^n - 2p_i^n + p_{i-1}^n)\n$$\n引入 Courant 数 $\\sigma = c\\,\\Delta t / \\Delta x$，该格式变为：\n$$\np_i^{n+1} = 2p_i^n - p_i^{n-1} + \\sigma^{2} (p_{i+1}^n - 2p_i^n + p_{i-1}^n)\n$$\n这可以重新组合为：\n$$\np_i^{n+1} = \\sigma^{2} p_{i+1}^n + 2(1-\\sigma^{2})p_i^n + \\sigma^{2} p_{i-1}^n - p_i^{n-1}\n$$\n\n**2. 冯·诺依曼稳定性分析**\n\n我们通过将傅里叶模式拟设 $p_i^n = \\lambda^n \\exp(\\mathrm{i} k x_i)$ 代入离散方程来分析其稳定性。注意到 $x_i = i\\,\\Delta x$ 并定义无量纲波数 $\\theta = k\\,\\Delta x$，该拟设为 $p_i^n = \\lambda^n \\exp(\\mathrm{i} i \\theta)$。格式中的各项变为：\n- $p_i^{n\\pm 1} = \\lambda^{n\\pm 1} \\exp(\\mathrm{i} i \\theta)$\n- $p_{i\\pm 1}^n = \\lambda^{n} \\exp(\\mathrm{i} (i\\pm 1) \\theta) = \\lambda^{n} \\exp(\\mathrm{i} i \\theta) \\exp(\\pm\\mathrm{i} \\theta)$\n\n将这些代入 FDTD 格式：\n$$\n\\lambda^{n+1}\\exp(\\mathrm{i}i\\theta) = 2p_i^n - \\lambda^{n-1}\\exp(\\mathrm{i}i\\theta) + \\sigma^{2} (\\lambda^{n}\\exp(\\mathrm{i}(i+1)\\theta) - 2\\lambda^{n}\\exp(\\mathrm{i}i\\theta) + \\lambda^{n}\\exp(\\mathrm{i}(i-1)\\theta))\n$$\n提取并消去公因子 $\\lambda^{n-1} \\exp(\\mathrm{i} i \\theta)$（假设 $\\lambda \\neq 0$）：\n$$\n\\lambda^{2} = 2\\lambda - 1 + \\sigma^{2} \\lambda (\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta))\n$$\n使用欧拉恒等式 $\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta) = 2\\cos(\\theta)$：\n$$\n\\lambda^{2} = 2\\lambda - 1 + \\sigma^{2} \\lambda (2\\cos(\\theta) - 2)\n$$\n$$\n\\lambda^{2} - 2\\lambda + 1 - 2\\sigma^{2}\\lambda(\\cos(\\theta) - 1) = 0\n$$\n整理成关于放大因子 $\\lambda$ 的标准二次方程 $a\\lambda^2+b\\lambda+c=0$ 的形式：\n$$\n\\lambda^{2} - 2(1 + \\sigma^{2}(\\cos(\\theta) - 1))\\lambda + 1 = 0\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^{2}(\\theta/2)$，我们得到 $\\cos(\\theta) - 1 = -2\\sin^{2}(\\theta/2)$。关于 $\\lambda$ 的二次方程为：\n$$\n\\lambda^{2} - 2(1 - 2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2}))\\lambda + 1 = 0\n$$\n\n**3. 根及其模**\n\n这是一个形式为 $\\lambda^{2} - 2A\\lambda + 1 = 0$ 的二次方程，其中 $A = 1 - 2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2})$。\n根 $\\lambda_{\\pm}$ 由二次方程求根公式给出：\n$$\n\\lambda_{\\pm}(\\theta) = \\frac{2A \\pm \\sqrt{4A^{2} - 4}}{2} = A \\pm \\sqrt{A^{2}-1}\n$$\n$$\n\\lambda_{\\pm}(\\theta) = \\left(1 - 2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2})\\right) \\pm \\sqrt{\\left(1 - 2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2})\\right)^{2} - 1}\n$$\n为了使格式稳定，放大因子的模必须对所有可能的 $\\theta$ 满足 $|\\lambda| \\le 1$。\n-   如果判别式 $A^{2}-1 \\le 0$，即 $|A| \\le 1$，则根是复共轭的：$\\lambda_{\\pm} = A \\pm \\mathrm{i}\\sqrt{1-A^{2}}$。它们的模是 $|\\lambda_{\\pm}| = \\sqrt{A^{2} + (1-A^{2})} = \\sqrt{1} = 1$。对于这些模式，格式是中性稳定的。\n-   如果判别式 $A^{2}-1  0$，即 $|A|  1$，则根是实数。由于它们的积为 $\\lambda_{+}\\lambda_{-} = 1$，一个根的模必须大于1，另一个根的模必须小于1。这表明存在不稳定性。\n\n因此，稳定性的条件是 $|A| \\le 1$，这等价于：\n$$\n-1 \\le 1 - 2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2}) \\le 1\n$$\n不等式右边，$1 - 2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2}) \\le 1$，简化为 $-2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2}) \\le 0$，这总是成立的。\n不等式左边，$-1 \\le 1 - 2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2})$，得到 $2\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2}) \\le 2$，或 $\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2}) \\le 1$。\n由于 $\\sin^{2}(\\frac{\\theta}{2})$ 的最大值为 $1$（对于奈奎斯特模式 $\\theta = \\pi$），该条件必须对这种最坏情况成立，从而得出著名的 Courant-Friedrichs-Lewy (CFL) 稳定性条件：\n$$\n\\sigma \\le 1\n$$\n\n**4. 不稳定情况分析**\n\n该问题提供了一个 $\\sigma = 1.05$ 的数值示例。由于 $\\sigma > 1$，预计该格式对于某些模式是不稳定的。最关键的模式是奈奎斯特模式，$\\theta = \\pi$。\n\n我们解析地检查稳定性条件 $\\sigma^{2}\\sin^{2}(\\frac{\\theta}{2}) \\le 1$ 是否满足。\n对于 $\\sigma = 1.05$ 和 $\\theta = \\pi$：\n$$\n\\sigma^{2}\\sin^{2}(\\frac{\\pi}{2}) = (1.05)^{2} \\times 1^{2} = 1.1025\n$$\n由于 $1.1025 > 1$，稳定性条件被违反。这解析地证明了对于此 Courant 数和空间模式，该格式是不稳定的。\n在这种情况下，量 $A$ 是：\n$$\nA = 1 - 2\\sigma^{2}\\sin^{2}(\\frac{\\pi}{2}) = 1 - 2(1.1025) = 1 - 2.205 = -1.205\n$$\n由于 $A = -1.205  -1$，我们处于不稳定区域，其中根是实数。不稳定的根是模大于 $1$ 的那个。根是 $\\lambda_{\\pm} = A \\pm \\sqrt{A^{2}-1}$。由于 $A  0$，两个根都是负数。根 $\\lambda_{-} = A - \\sqrt{A^{2}-1}$ 将具有更大的模。\n$|\\lambda_{-}| = -(A - \\sqrt{A^{2}-1}) = -A + \\sqrt{A^{2}-1}$。由于 $A  -1$，所以 $-A > 1$，因此 $|\\lambda_{-}| > 1$。\n\n**5. 数值计算**\n\n我们现在计算 $A = -1.205$ 时不稳定根的模。不稳定根的模为：\n$$\n|\\lambda_{\\text{unstable}}| = -A + \\sqrt{A^{2}-1} = -(-1.205) + \\sqrt{(-1.205)^{2} - 1}\n$$\n$$\n|\\lambda_{\\text{unstable}}| = 1.205 + \\sqrt{1.452025 - 1}\n$$\n$$\n|\\lambda_{\\text{unstable}}| = 1.205 + \\sqrt{0.452025}\n$$\n$$\n|\\lambda_{\\text{unstable}}| = 1.205 + 0.67232805...\n$$\n$$\n|\\lambda_{\\text{unstable}}| = 1.87732805...\n$$\n将结果四舍五入到四位有效数字，我们得到 $1.877$。\n这证实了对于一个仅比稳定性极限高5%的 Courant 数，网格上的最高频率模式在每个时间步长增长约88%，导致快速的数值不稳定性。",
            "answer": "$$\\boxed{1.877}$$"
        }
    ]
}