{
    "hands_on_practices": [
        {
            "introduction": "任何时域有限差分（FDTD）仿真的第一步都是建立一个稳定的数值网格。这需要仔细选择时间步长 $\\Delta t$ 与空间步长 $\\Delta z$ 之间的关系，以防止数值解出现无界的指数增长。这个练习将让你计算保证一维仿真稳定性的最大时间步长，这是由 Courant-Friedrichs-Lewy (CFL) 条件决定的基本要求，也是所有 FDTD 从业者必须掌握的基础技能。",
            "id": "1581145",
            "problem": "一位研究人员正在开发一个用于模拟光在硅基集成光子电路中传播的数值模型。该模型使用时域有限差分 (FDTD) 方法沿对应于直波导核心的一维路径求解麦克斯韦方程组。空间域被离散化为一个均匀网格，单元尺寸为 $\\Delta z = 1.50 \\, \\mu\\text{m}$。波导核心由硅制成，可将其建模为一种简单的、非磁性的、无损耗的电介质，其相对介电常数为 $\\epsilon_r = 11.68$。\n\n为确保 FDTD 模拟保持数值稳定并产生具有物理意义的结果，必须谨慎选择模拟中使用的时间步长 $\\Delta t$。计算能保证此一维模拟稳定性的最大可能时间步长 $\\Delta t_{\\text{max}}$。\n\n在您的计算中，使用真空中的光速 $c = 2.998 \\times 10^8 \\, \\text{m/s}$。\n\n以飞秒 ($\\text{fs}$) 为单位表示您的最终答案。将您的最终答案四舍五入到三位有效数字。",
            "solution": "对于一维 Yee FDTD 格式，Courant 稳定性条件要求基于介质中波速的 Courant 数满足\n$$\nS \\equiv \\frac{v\\,\\Delta t}{\\Delta z} \\leq 1,\n$$\n其中 $v$ 是电磁波在介质中的传播速度。因此，最大稳定时间步长为\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z}{v}.\n$$\n在一个相对介电常数为 $\\epsilon_{r}$ 且 $\\mu_{r}=1$ 的简单、非磁性、无损耗的电介质中，波速为\n$$\nv=\\frac{1}{\\sqrt{\\mu \\epsilon}}=\\frac{c}{\\sqrt{\\epsilon_{r}}},\n$$\n所以\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z\\,\\sqrt{\\epsilon_{r}}}{c}.\n$$\n\n代入给定值 $\\Delta z = 1.50 \\times 10^{-6} \\, \\text{m}$，$\\epsilon_{r}=11.68$ 和 $c = 2.998 \\times 10^{8} \\, \\text{m/s}$，\n$$\n\\Delta t_{\\text{max}}=\\frac{\\left(1.50 \\times 10^{-6}\\right)\\sqrt{11.68}}{2.998 \\times 10^{8}}\\ \\text{s}.\n$$\n计算 $\\sqrt{11.68} \\approx 3.4176$，得到\n$$\n\\Delta t_{\\text{max}}=\\frac{1.50 \\times 10^{-6} \\times 3.4176}{2.998 \\times 10^{8}}\\ \\text{s}\n=\\frac{5.1264 \\times 10^{-6}}{2.998 \\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{5.1264}{2.998}\\right)\\times 10^{-14}\\ \\text{s}\n\\approx 1.70995 \\times 10^{-14}\\ \\text{s}.\n$$\n使用 $1 \\, \\text{fs}=10^{-15} \\, \\text{s}$ 转换为飞秒，\n$$\n\\Delta t_{\\text{max}} \\approx 17.0995\\ \\text{fs}.\n$$\n四舍五入到三位有效数字，得到 $17.1 \\, \\text{fs}$。",
            "answer": "$$\\boxed{17.1}$$"
        },
        {
            "introduction": "在 FDTD 仿真中正确地引入声源至关重要，因为它是驱动整个物理系统的“引擎”。一个设计不当的源波形可能会在整个计算域中引入一个非物理的、持久的直流（DC）压力偏移，即使有完美的吸收边界条件也无法消除。这个练习探讨了如何通过确保离散源信号的“零均值”特性来防止这种常见的数值伪影，这是获得精确物理结果的一个微妙但关键的步骤。",
            "id": "4141938",
            "problem": "在计算声学中，时域有限差分（FDTD）方法中一种常见的波激发方式是，在压力更新方程中，于某一点以附加项的形式注入一个紧支集源波形。考虑一个由线性化的动量方程和连续性方程描述的一维（1D）线性声学介质，其压力为 $p(x,t)$，质点速度为 $u(x,t)$，质量密度为 $\\rho_0$，声速为 $c$，等熵压缩率为 $\\kappa = 1/(\\rho_0 c^2)$。在一个标准交错网格上，使用常规的二阶精度显式格式，压力 $p$ 在整数时间索引 $n$ 处更新，而速度 $u$ 在半整数索引 $n+\\tfrac{1}{2}$ 处更新。一个点源通过在 $n = 0, \\dots, N-1$ 的 $p$ 更新过程中，在单个压力网格点上作为一个附加项 $q^n$ 来实现，其中 $q^n$ 是时间步长为 $\\Delta t$ 的采样源序列 $s^n$。空间域很大，并由一个完美匹配层（PML）终止，该PML被选择用来有效吸收出射的时变波，并产生最小的反射。\n\n如果源波形没有经过适当的条件处理，即使PML已经设置，在源脉冲过后，压力 $p$ 中也可能出现伪直流（DC）偏移，即一个非零的准静态偏置。对于此类源注入，下列哪个陈述正确解释了在FDTD声压场中防止伪直流偏移的设计步骤？选择所有适用项。\n\nA. 在激励窗口上强制执行离散时间零均值条件，具体而言，选择 $s^n$ 使得 $\\sum_{n=0}^{N-1} s^n \\Delta t = 0$ 成立，否则一个净偏置会通过离散压力更新过程累积起来。\n\nB. 确保连续时间条件 $\\int_{0}^{T} s(t)\\,\\mathrm{d}t = 0$ (对于某个 $T = N \\Delta t$) 总是足够的；任何由于采样导致的 $\\sum_{n=0}^{N-1} s^n \\Delta t$ 与零的偏差都将被PML移除。\n\nC. 将源精确地放置在交错网格的压力节点上可以消除直流偏移，而无需强制 $s^n$ 为零均值，因为网格的交错结构会固有地抵消任何静态偏置。\n\nD. 通过减去其离散均值来对离散源进行预处理，即使用 $s^n_{\\text{zc}} = s^n - \\bar{s}$，其中 $\\bar{s} = \\frac{1}{N}\\sum_{n=0}^{N-1} s^n$，这样 $\\sum_{n=0}^{N-1} s^n_{\\text{zc}} \\Delta t = 0$ 且没有净偏置被注入。\n\nE. 仅依靠PML就足够了：即使 $\\sum_{n=0}^{N-1} s^n \\Delta t \\neq 0$，PML也会像吸收出射波一样吸收任何静态偏移。",
            "solution": "一维线性化声学方程为：\n1.  **连续性方程：** $\\kappa \\frac{\\partial p}{\\partial t} + \\frac{\\partial u}{\\partial x} = 0$\n2.  **动量方程：** $\\rho_0 \\frac{\\partial u}{\\partial t} + \\frac{\\partial p}{\\partial x} = 0$\n\n在交错网格上使用标准的二阶有限差分格式，其中压力 $p$ 定义在整数空间索引 $i$ 和时间索引 $n$ 上，速度 $u$ 定义在半整数空间索引 $i+\\tfrac{1}{2}$ 和时间索引 $n+\\tfrac{1}{2}$ 上，更新方程为：\n\n$$ p_i^{n+1} = p_i^n - \\frac{\\Delta t}{\\kappa \\Delta x} \\left( u_{i+1/2}^{n+1/2} - u_{i-1/2}^{n+1/2} \\right) $$\n$$ u_{i+1/2}^{n+1/2} = u_{i+1/2}^{n-1/2} - \\frac{\\Delta t}{\\rho_0 \\Delta x} \\left( p_{i+1}^{n} - p_i^{n} \\right) $$\n\n其中 $\\Delta t$ 是时间步长，$\\Delta x$ 是网格间距。\n\n问题陈述一个源在单个压力网格点（比如 $i_s$）上作为附加项 $q^n = s^n$ 被引入。这种类型的源通常被称为“软源”。在源位置的压力更新方程变为：\n\n$$ p_{i_s}^{n+1} = p_{i_s}^n - \\frac{\\Delta t}{\\kappa \\Delta x} \\left( u_{i_s+1/2}^{n+1/2} - u_{i_s-1/2}^{n+1/2} \\right) + C \\cdot s^n $$\n\n常数 $C$ 取决于源项的归一化和解释。在许多实现中，它被取为 $C=\\Delta t$ 或简单地取为 $C=1$。让我们分析源项总和的影响。假设系统从静止开始，即对所有 $i$，有 $p_i^0 = 0$ 和 $u_{i+1/2}^{-1/2} = 0$。\n\n考虑在整个空间网格上求和的总压力 $\\sum_i p_i$。将压力更新方程对所有 $i$ 求和：\n$$ \\sum_i p_i^{n+1} = \\sum_i p_i^n - \\frac{\\Delta t}{\\kappa \\Delta x} \\sum_i \\left( u_{i+1/2}^{n+1/2} - u_{i-1/2}^{n+1/2} \\right) + C \\cdot s^n $$\n项 $\\sum_i (u_{i+1/2}^{n+1/2} - u_{i-1/2}^{n+1/2})$ 是一个伸缩求和，其结果是计算域边界处速度的差值。对于吸收边界（PMLs），此项表示流出域的声能净通量。\n\n现在让我们考虑源结束后（对于 $n \\ge N$）系统的状态。源项 $s^n$ 为零。我们来检验一个恒定压力场 $p_i = P_0$ 和零速度场 $u_{i+1/2} = 0$ 是否是齐次FDTD方程的稳定解。\n如果对所有 $i$ 都有 $p_i^n = P_0$，速度更新方程给出：\n$$ u_{i+1/2}^{n+1/2} = u_{i+1/2}^{n-1/2} - \\frac{\\Delta t}{\\rho_0 \\Delta x} \\left( P_0 - P_0 \\right) = u_{i+1/2}^{n-1/2} $$\n如果速度场在某个点变为零，它将保持为零。\n如果对所有 $i$ 都有 $u_{i+1/2}^{n+1/2} = 0$，压力更新方程给出：\n$$ p_i^{n+1} = p_i^n - \\frac{\\Delta t}{\\kappa \\Delta x} \\left( 0 - 0 \\right) = p_i^n $$\n如果压力场在某个点变为常数，它将保持为常数。\n因此，一个具有均匀非零压力 $P_0$ 和零速度的状态是齐次离散方程的一个有效的稳态解。\n\n这意味着，如果源注入过程导致了无法辐射出去的压力净累积，系统就会稳定在这种直流偏移状态。注入到网格中的总压力“电荷”量与源函数的时间积分有关。在离散域中，这个积分由一个和来近似。让我们将源注入项在源的持续时间内（从 $n=0$ 到 $N-1$）求和。总注入量与 $\\sum_{n=0}^{N-1} s^n$ 成正比。如果这个和不为零，就会引入一个净直流偏移。为避免这种情况，我们必须确保源序列的离散时间积分为零。离散积分被恰当地表示为 $\\sum_{n=0}^{N-1} s^n \\Delta t$。\n\nPML的作用是吸收出射的*时变*波（$\\omega \\neq 0$）。静态直流偏移对应于零频率（$\\omega = 0$）场。标准的PML公式具有通常与频率成正比的阻尼参数，这意味着它们在 $\\omega=0$ 时不提供任何阻尼。因此，PML在吸收静态压力偏移方面是无效的。\n\n### 逐项分析\n\n**A. 在激励窗口上强制执行离散时间零均值条件，具体而言，选择 $s^n$ 使得 $\\sum_{n=0}^{N-1} s^n \\Delta t = 0$ 成立，否则一个净偏置会通过离散压力更新过程累积起来。**\n这个陈述正确地指出了核心问题。如上所述，离散FDTD方程允许恒定压力偏移作为稳定解。附加源项随时间的总和 $\\sum s^n$ 代表注入系统的净“电荷”或压力。如果这个和非零，一个净偏置 $P_0 \\neq 0$ 就会被产生并持续存在。条件 $\\sum_{n=0}^{N-1} s^n \\Delta t = 0$ 确保了源的离散时间积分为零，从而防止了这种偏置的净累积。\n**结论：正确。**\n\n**B. 确保连续时间条件 $\\int_{0}^{T} s(t)\\,\\mathrm{d}t = 0$ (对于某个 $T = N \\Delta t$) 总是足够的；任何由于采样导致的 $\\sum_{n=0}^{N-1} s^n \\Delta t$ 与零的偏差都将被PML移除。**\n这个陈述不正确，原因有二。首先，FDTD模拟操作的是离散序列 $s^n$，而不是连续函数 $s(t)$。虽然一个连续函数可能积分为零，但由于离散化误差，其采样表示 $s^n$ 的和可能不为零（即 $\\sum s^n \\Delta t \\neq 0$）。重要的是离散和的性质。其次，如推导中所解释的，PML被设计用来吸收时变波，并且对于静态（$\\omega=0$）直流偏移通常是无效的。不能依靠它来移除由源引入的偏置。\n**结论：不正确。**\n\n**C. 将源精确地放置在交错网格的压力节点上可以消除直流偏移，而无需强制 $s^n$ 为零均值，因为网格的交错结构会固有地抵消任何静态偏置。**\n这是不正确的。问题陈述了源已经被放置在压力节点上，这是标准做法。上面的推导表明直流偏移可以持续存在，而该推导正是基于这种配置。交错网格的结构允许静态压力偏移作为齐次方程的有效稳态解。网格本身不提供任何机制来抵消由非零均值源注入的偏置。\n**结论：不正确。**\n\n**D. 通过减去其离散均值来对离散源进行预处理，即使用 $s^n_{\\text{zc}} = s^n - \\bar{s}$，其中 $\\bar{s} = \\frac{1}{N}\\sum_{n=0}^{N-1} s^n$，这样 $\\sum_{n=0}^{N-1} s^n_{\\text{zc}} \\Delta t = 0$ 且没有净偏置被注入。**\n这个陈述描述了一个有效且常见的确保零均值条件的实用程序。让我们验证一下数学。新源序列 $s^n_{\\text{zc}}$ 的和是：\n$$ \\sum_{n=0}^{N-1} s^n_{\\text{zc}} = \\sum_{n=0}^{N-1} \\left( s^n - \\bar{s} \\right) = \\left( \\sum_{n=0}^{N-1} s^n \\right) - \\sum_{n=0}^{N-1} \\bar{s} = \\left( \\sum_{n=0}^{N-1} s^n \\right) - N \\bar{s} $$\n代入 $\\bar{s}$ 的定义：\n$$ \\sum_{n=0}^{N-1} s^n_{\\text{zc}} = \\left( \\sum_{n=0}^{N-1} s^n \\right) - N \\left( \\frac{1}{N} \\sum_{n=0}^{N-1} s^n \\right) = 0 $$\n由于和为零，离散时间积分 $\\sum_{n=0}^{N-1} s^n_{\\text{zc}} \\Delta t$ 也为零。这个程序有效地从离散源信号中移除了直流分量，从而防止了净压力偏置的注入。这个陈述是选项A中描述的原则的一个正确的实际实现。\n**结论：正确。**\n\n**E. 仅依靠PML就足够了：即使 $\\sum_{n=0}^{N-1} s^n \\Delta t \\neq 0$，PML也会像吸收出射波一样吸收任何静态偏移。**\n这个陈述是错误的。它从根本上误解了PML的工作原理。PML被设计用来创建一个非物理的吸收介质，该介质与物理域对传播波是阻抗匹配的，以防止反射。这种阻抗匹配是频率依赖的。对于静态（DC，$\\omega=0$）场，没有波的传播，标准PML的阻尼机制是无效的。静态偏移不是一个“出射波”，不会被吸收。\n**结论：不正确。**",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "在编写了复杂的 FDTD 代码后，我们如何系统地验证它确实在正确地求解目标偏微分方程？人造解法（Method of Manufactured Solutions, MMS）是一种强大而严谨的代码验证技术，它通过一个非零的源项来“强制”一个已知的解析函数成为方程的精确解。本练习将引导你完成 MMS 过程的一个关键思想步骤：为一个预设的解析解推导相应的源项，这让你能够以数学精度检验你的代码实现，是确保计算结果可靠性的基石。",
            "id": "4141942",
            "problem": "考虑一个二维均匀、无粘性的声学介质，其声速 $c0$ 和质量密度均为常数。为了验证计算声学中的二阶时域有限差分 (FDTD) 方法，您采用人造解法。设声压场规定为\n$$\np(x,y,t) = \\sin\\!\\big(k_x x + k_y y - \\omega t\\big),\n$$\n其中 $k_x$ 和 $k_y$ 是实值空间波数，$\\omega$ 是实值时间角频率，受色散关系 $\\omega = c\\sqrt{k_x^2 + k_y^2}$ 的约束。假设在矩形域上采用周期性边界条件，以使平面波与该域兼容。\n\n从带有附加源项的标量声波方程出发，\n$$\n\\frac{1}{c^2}\\,\\frac{\\partial^2 p}{\\partial t^2} - \\nabla^2 p \\;=\\; s(x,y,t),\n$$\n推导显式的人造源项 $s(x,y,t)$，使得规定的 $p(x,y,t)$ 成为上述连续方程的精确解。将您的最终结果表示为关于 $k_x$, $k_y$, $c$, $\\omega$, $x$, $y$ 和 $t$ 的单个封闭形式符号表达式，并尽可能简化。无需四舍五入，最终表达式中不应包含单位。",
            "solution": "目标是根据给定的声压场 $p(x,y,t)$，为标量声波方程推导人造源项 $s(x,y,t)$。控制偏微分方程 (PDE) 为：\n$$\n\\frac{1}{c^2}\\,\\frac{\\partial^2 p}{\\partial t^2} - \\nabla^2 p = s(x,y,t)\n$$\n这里，$\\nabla^2$ 是二维拉普拉斯算子，$\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$。源项 $s(x,y,t)$ 是通过将波算子 $\\mathcal{L} \\equiv \\frac{1}{c^2}\\frac{\\partial^2}{\\partial t^2} - \\nabla^2$ 应用于规定的人造解 $p(x,y,t)$ 得到的。\n\n规定的声压场以平面波形式给出：\n$$\np(x,y,t) = \\sin(k_x x + k_y y - \\omega t)\n$$\n为了求得 $s(x,y,t)$，我们必须计算 $p(x,y,t)$ 的必要偏导数。设波的相位表示为 $\\phi(x,y,t) = k_x x + k_y y - \\omega t$。则 $p(x,y,t) = \\sin(\\phi)$。\n\n首先，我们计算 $p$ 关于时间 $t$ 的二阶偏导数。使用链式法则：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{\\partial}{\\partial t}\\big(\\sin(\\phi)\\big) = \\cos(\\phi) \\cdot \\frac{\\partial \\phi}{\\partial t}\n$$\n相位 $\\phi$ 关于 $t$ 的偏导数为：\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial t}(k_x x + k_y y - \\omega t) = -\\omega\n$$\n将其代回得到：\n$$\n\\frac{\\partial p}{\\partial t} = -\\omega \\cos(\\phi)\n$$\n现在，我们再次对 $t$求导：\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = \\frac{\\partial}{\\partial t}\\big(-\\omega \\cos(\\phi)\\big) = -\\omega \\big(-\\sin(\\phi)\\big) \\cdot \\frac{\\partial \\phi}{\\partial t} = \\omega \\sin(\\phi) \\cdot (-\\omega) = -\\omega^2 \\sin(\\phi)\n$$\n由于 $p = \\sin(\\phi)$，我们有：\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = -\\omega^2 p(x,y,t)\n$$\n\n接下来，我们计算 $p$ 的拉普拉斯算子，即 $\\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2}$。我们从对空间变量 $x$ 的偏导数开始：\n$$\n\\frac{\\partial p}{\\partial x} = \\frac{\\partial}{\\partial x}\\big(\\sin(\\phi)\\big) = \\cos(\\phi) \\cdot \\frac{\\partial \\phi}{\\partial x}\n$$\n相位 $\\phi$ 关于 $x$ 的偏导数为：\n$$\n\\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x}(k_x x + k_y y - \\omega t) = k_x\n$$\n所以，一阶空间导数为：\n$$\n\\frac{\\partial p}{\\partial x} = k_x \\cos(\\phi)\n$$\n再次对 $x$ 求导：\n$$\n\\frac{\\partial^2 p}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\big(k_x \\cos(\\phi)\\big) = k_x \\big(-\\sin(\\phi)\\big) \\cdot \\frac{\\partial \\phi}{\\partial x} = -k_x \\sin(\\phi) \\cdot k_x = -k_x^2 \\sin(\\phi)\n$$\n这可以简化为：\n$$\n\\frac{\\partial^2 p}{\\partial x^2} = -k_x^2 p(x,y,t)\n$$\n通过对空间变量 $y$ 执行相同的过程，我们得到：\n$$\n\\frac{\\partial^2 p}{\\partial y^2} = -k_y^2 p(x,y,t)\n$$\n$p$ 的拉普拉斯算子是这两个二阶导数之和：\n$$\n\\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} = -k_x^2 p(x,y,t) - k_y^2 p(x,y,t) = -(k_x^2 + k_y^2) p(x,y,t)\n$$\n\n现在我们将 $\\frac{\\partial^2 p}{\\partial t^2}$ 和 $\\nabla^2 p$ 的表达式代入控制偏微分方程，以求得源项 $s(x,y,t)$：\n$$\ns(x,y,t) = \\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} - \\nabla^2 p = \\frac{1}{c^2}\\big(-\\omega^2 p(x,y,t)\\big) - \\big(-(k_x^2 + k_y^2) p(x,y,t)\\big)\n$$\n将 $p(x,y,t)$ 因子提出：\n$$\ns(x,y,t) = \\left( -\\frac{\\omega^2}{c^2} + k_x^2 + k_y^2 \\right) p(x,y,t)\n$$\n问题陈述提供了一个关键约束：色散关系 $\\omega = c\\sqrt{k_x^2 + k_y^2}$。由于 $c > 0$ 且波数是实数，我们可以对该关系式两边平方得到：\n$$\n\\omega^2 = c^2 (k_x^2 + k_y^2)\n$$\n两边除以 $c^2$（因为 $c^2 > 0$）：\n$$\n\\frac{\\omega^2}{c^2} = k_x^2 + k_y^2\n$$\n该关系表明，规定的平面波 $p(x,y,t)$ 实际上是齐次声波方程的精确解。\n\n将此结果代入我们关于 $s(x,y,t)$ 的表达式中：\n$$\ns(x,y,t) = \\left( -(k_x^2 + k_y^2) + k_x^2 + k_y^2 \\right) p(x,y,t)\n$$\n括号中的项计算结果为零：\n$$\ns(x,y,t) = (0) \\cdot p(x,y,t) = 0\n$$\n因此，对于所有的 $(x, y, t)$，要使给定的 $p(x,y,t)$ 成为非齐次波动方程的精确解，所需的人造源项恒等于零。这是规定的声压场及相关色散关系约束的直接结果。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}