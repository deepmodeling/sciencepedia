{
    "hands_on_practices": [
        {
            "introduction": "要理解数值色散的根源，最直接的方法就是亲自推导离散系统中的色散关系。本练习将指导你完成这一核心分析过程。通过将一个平面波解代入一维声学FDTD格式，你将发现数值频率和数值波数之间存在一个由离散化参数（如网格大小和时间步长）决定的特定关系，这与连续介质中的线性关系有所不同。这个推导是分析任何FDTD方法精度的基石 。",
            "id": "4132831",
            "problem": "考虑在平衡密度为 $\\rho_{0}$、声速为 $c$ 的均匀介质中的一维线性声学问题。压强 $p(x,t)$ 和质点速度 $u(x,t)$ 的线性化方程为\n$$\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x}, \\qquad \\frac{\\partial p}{\\partial t} = -\\rho_{0} c^{2} \\frac{\\partial u}{\\partial x}.$$\n使用交错网格时域有限差分 (FDTD) 格式（时域有限差分法是一种二阶、显式、蛙跳格式）在间距为 $\\Delta x$ 的均匀空间网格和时间步长为 $\\Delta t$ 的情况下对该系统进行离散化。将 $p$ 置于整数空间索引 $i$ 和整数时间索引 $n$ 处，并将 $u$ 置于空间和时间上的半整数索引处。完全离散的更新方程为\n$$u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = u_{i+\\frac{1}{2}}^{n-\\frac{1}{2}} - \\frac{\\Delta t}{\\rho_{0}\\,\\Delta x} \\left(p_{i+1}^{n} - p_{i}^{n}\\right),$$\n$$p_{i}^{n+1} = p_{i}^{n} - \\rho_{0} c^{2} \\frac{\\Delta t}{\\Delta x} \\left(u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{i-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right).$$\n假设单色平面波解的形式为\n$$p_{i}^{n} = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(i\\,\\kappa - n\\,\\Omega\\right)\\right), \\qquad u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - \\left(n+\\tfrac{1}{2}\\right)\\Omega\\right)\\right),$$\n其中 $\\kappa = k\\,\\Delta x$ 是无量纲波数，$\\Omega = \\omega\\,\\Delta t$ 是无量纲角频率，$k$ 和 $\\omega$ 分别是连续波数和角频率。令库朗数 (Courant number) 为 $\\sigma = \\dfrac{c\\,\\Delta t}{\\Delta x}$。使用这些定义，通过消去 $\\hat{p}$ 和 $\\hat{u}$ 来推导离散色散关系，并提供一个关于 $\\kappa$ 和 $\\sigma$ 的 $\\Omega$ 的单一闭式解析表达式。三角函数使用弧度制。您的最终答案必须是 $\\Omega(\\kappa,\\sigma)$ 的单一闭式表达式。",
            "solution": "目标是为给定的时域有限差分 (FDTD) 格式推导离散色散关系。这可以通过将假设的单色平面波解代入离散更新方程来实现。\n\n给定的 FDTD 更新方程为：\n$$u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = u_{i+\\frac{1}{2}}^{n-\\frac{1}{2}} - \\frac{\\Delta t}{\\rho_{0}\\,\\Delta x} \\left(p_{i+1}^{n} - p_{i}^{n}\\right) \\quad (1)$$\n$$p_{i}^{n+1} = p_{i}^{n} - \\rho_{0} c^{2} \\frac{\\Delta t}{\\Delta x} \\left(u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{i-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right) \\quad (2)$$\n平面波解为：\n$$p_{i}^{n} = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(i\\,\\kappa - n\\,\\Omega\\right)\\right)$$\n$$u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - \\left(n+\\tfrac{1}{2}\\right)\\Omega\\right)\\right)$$\n其中 $\\mathrm{i}$ 是虚数单位，$\\kappa = k\\Delta x$ 是无量纲波数，$\\Omega=\\omega\\Delta t$ 是无量纲角频率。\n\n首先，我们将平面波形式代入方程 (1)。为简化代数运算，我们将所有项表示为相对于一个公共时空点，我们选择模板的中心，即空间上的 $(i+\\frac{1}{2})\\Delta x$ 和时间上的 $n\\Delta t$。那么，不同网格点上的场变量为：\n$$u_{i+\\frac{1}{2}}^{n\\pm\\frac{1}{2}} = \\hat{u} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - \\left(n\\pm\\tfrac{1}{2}\\right)\\Omega\\right)\\right) = \\hat{u} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - n\\Omega\\right)\\right) \\exp(\\mp \\mathrm{i}\\Omega/2)$$\n$$p_{i+1}^{n} = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+1\\right)\\kappa - n\\Omega\\right)\\right) = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - n\\Omega\\right)\\right) \\exp(\\mathrm{i}\\kappa/2)$$\n$$p_{i}^{n} = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(i\\kappa - n\\Omega\\right)\\right) = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - n\\Omega\\right)\\right) \\exp(-\\mathrm{i}\\kappa/2)$$\n将这些代入方程 (1) 并从所有项中消去公因子 $\\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\frac{1}{2}\\right)\\kappa - n\\Omega\\right)\\right)$，我们得到：\n$$\\hat{u} \\exp(-\\mathrm{i}\\Omega/2) = \\hat{u} \\exp(\\mathrm{i}\\Omega/2) - \\frac{\\Delta t}{\\rho_0 \\Delta x} \\left[ \\hat{p} \\exp(\\mathrm{i}\\kappa/2) - \\hat{p} \\exp(-\\mathrm{i}\\kappa/2) \\right]$$\n重新整理各项以对 $\\hat{u}$ 和 $\\hat{p}$ 进行分组：\n$$\\hat{u} \\left( \\exp(\\mathrm{i}\\Omega/2) - \\exp(-\\mathrm{i}\\Omega/2) \\right) = \\frac{\\Delta t}{\\rho_0 \\Delta x} \\hat{p} \\left( \\exp(\\mathrm{i}\\kappa/2) - \\exp(-\\mathrm{i}\\kappa/2) \\right)$$\n使用欧拉公式 $\\sin(x) = \\frac{\\exp(\\mathrm{i}x) - \\exp(-\\mathrm{i}x)}{2\\mathrm{i}}$，上式可简化为：\n$$\\hat{u} \\left( 2\\mathrm{i}\\sin(\\Omega/2) \\right) = \\frac{\\Delta t}{\\rho_0 \\Delta x} \\hat{p} \\left( 2\\mathrm{i}\\sin(\\kappa/2) \\right)$$\n$$\\hat{u} \\sin(\\Omega/2) = \\frac{\\Delta t}{\\rho_0 \\Delta x} \\hat{p} \\sin(\\kappa/2) \\quad (3)$$\n\n接下来，我们对(2)重复此过程。此模板的时空中心位于 $i\\Delta x$ 和 $(n+\\frac{1}{2})\\Delta t$。我们将变量表示为相对于此点：\n$$p_{i}^{n+1} = \\hat{p} \\exp(\\mathrm{i}(i\\kappa - (n+1)\\Omega)) = \\hat{p} \\exp(\\mathrm{i}(i\\kappa - (n+\\tfrac{1}{2})\\Omega)) \\exp(-\\mathrm{i}\\Omega/2)$$\n$$p_{i}^{n} = \\hat{p} \\exp(\\mathrm{i}(i\\kappa - n\\Omega)) = \\hat{p} \\exp(\\mathrm{i}(i\\kappa - (n+\\tfrac{1}{2})\\Omega)) \\exp(\\mathrm{i}\\Omega/2)$$\n$$u_{i\\pm\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u} \\exp(\\mathrm{i}((i\\pm\\tfrac{1}{2})\\kappa - (n+\\tfrac{1}{2})\\Omega)) = \\hat{u} \\exp(\\mathrm{i}(i\\kappa - (n+\\tfrac{1}{2})\\Omega)) \\exp(\\pm\\mathrm{i}\\kappa/2)$$\n代入方程 (2) 并消去公因子 $\\exp(\\mathrm{i}(i\\kappa - (n+\\frac{1}{2})\\Omega))$：\n$$\\hat{p} \\exp(-\\mathrm{i}\\Omega/2) = \\hat{p} \\exp(\\mathrm{i}\\Omega/2) - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\left[ \\hat{u} \\exp(\\mathrm{i}\\kappa/2) - \\hat{u} \\exp(-\\mathrm{i}\\kappa/2) \\right]$$\n重新整理并应用欧拉公式：\n$$\\hat{p} \\left( \\exp(\\mathrm{i}\\Omega/2) - \\exp(-\\mathrm{i}\\Omega/2) \\right) = \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\hat{u} \\left( \\exp(\\mathrm{i}\\kappa/2) - \\exp(-\\mathrm{i}\\kappa/2) \\right)$$\n$$\\hat{p} \\left( 2\\mathrm{i}\\sin(\\Omega/2) \\right) = \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\hat{u} \\left( 2\\mathrm{i}\\sin(\\kappa/2) \\right)$$\n$$\\hat{p} \\sin(\\Omega/2) = \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\hat{u} \\sin(\\kappa/2) \\quad (4)$$\n\n方程 (3) 和 (4) 构成了一个关于振幅 $\\hat{p}$ 和 $\\hat{u}$ 的齐次线性方程组。为使非平凡解（即 $(\\hat{p}, \\hat{u}) \\neq (0,0)$）存在，系数矩阵的行列式必须为零。该方程组可以写成：\n$$\\begin{pmatrix} \\sin(\\Omega/2)  -\\frac{\\Delta t}{\\rho_0 \\Delta x} \\sin(\\kappa/2) \\\\ -\\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\sin(\\kappa/2)  \\sin(\\Omega/2) \\end{pmatrix} \\begin{pmatrix} \\hat{u} \\\\ \\hat{p} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n将行列式设为零，得到色散关系：\n$$\\sin^2(\\Omega/2) - \\left( \\frac{\\Delta t}{\\rho_0 \\Delta x} \\sin(\\kappa/2) \\right) \\left( \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\sin(\\kappa/2) \\right) = 0$$\n$$\\sin^2(\\Omega/2) - c^2 \\left(\\frac{\\Delta t}{\\Delta x}\\right)^2 \\sin^2(\\kappa/2) = 0$$\n我们已知库朗数 (Courant number) 的定义，$\\sigma = \\frac{c\\Delta t}{\\Delta x}$。将其代入方程，得到：\n$$\\sin^2(\\Omega/2) = \\sigma^2 \\sin^2(\\kappa/2)$$\n对两边取平方根，我们考虑对应于前向传播波且具有物理意义的正根：\n$$\\sin(\\Omega/2) = \\sigma \\sin(\\kappa/2)$$\n最后，我们对两边取反正弦并乘以 2 来求解 $\\Omega$：\n$$\\frac{\\Omega}{2} = \\arcsin\\left(\\sigma \\sin(\\kappa/2)\\right)$$\n$$\\Omega = 2 \\arcsin\\left(\\sigma \\sin(\\kappa/2)\\right)$$\n这就是给定交错网格 FDTD 格式的离散色散关系，它将无量纲频率 $\\Omega$ 表示为无量纲波数 $\\kappa$ 和库朗数 $\\sigma$ 的函数。",
            "answer": "$$\\boxed{2 \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)}$$"
        },
        {
            "introduction": "在理想化的无损均匀介质模型之上，我们进一步探讨更贴近现实世界的复杂情况。本练习将分析扩展到包含物理损耗和介质非均匀性的声学系统。你将推导一个更复杂的离散色散关系，它同时包含了相位变化（色散）和振幅衰减（耗散）的信息，并通过编程计算具体案例，直观地观察不同物理参数和离散参数对波传播数值解的影响 。",
            "id": "4132822",
            "problem": "考虑由声压 $p(x,t)$ 和质点速度 $u(x,t)$ 的耦合一阶系统所描述的一维线性声学。该系统位于一个空间变化的介质中，其质量密度为 $\\rho(x)$，体积模量为 $K(x)$，线性损耗由速度阻尼系数 $\\sigma_u(x)$ 和压力阻尼系数 $\\sigma_p(x)$ 表征。连续方程为\n$$\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho(x)}\\frac{\\partial p}{\\partial x} - \\sigma_u(x)\\,u,$$\n$$\\frac{\\partial p}{\\partial t} = -K(x)\\frac{\\partial u}{\\partial x} - \\sigma_p(x)\\,p,$$\n其中声速 $c(x)$ 定义为 $c(x) = \\sqrt{\\frac{K(x)}{\\rho(x)}}$。在一维情况下，采用交错网格时域有限差分 (FDTD) 离散化，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。其中，$p$ 在整数空间索引 $i$ 和整数时间索引 $n$ 处采样，而 $u$ 在半整数空间索引 $i+\\frac{1}{2}$ 和半整数时间索引 $n+\\frac{1}{2}$ 处采样。对双曲项使用蛙跳格式，对线性损耗项使用梯形法则，使得离散更新的形式如下\n$$u^{n+\\frac{1}{2}}_{i+\\frac{1}{2}} = \\alpha_u\\,u^{n-\\frac{1}{2}}_{i+\\frac{1}{2}} - \\frac{\\Delta t}{\\rho_{i+\\frac{1}{2}}\\Delta x\\,\\left(1+\\frac{\\sigma_{u,i+\\frac{1}{2}}\\Delta t}{2}\\right)}\\left(p^n_{i+1}-p^n_i\\right),$$\n$$p^{n+1}_{i} = \\alpha_p\\,p^{n}_{i} - \\frac{K_{i}\\Delta t}{\\Delta x\\,\\left(1+\\frac{\\sigma_{p,i}\\Delta t}{2}\\right)}\\left(u^{n+\\frac{1}{2}}_{i+\\frac{1}{2}}-u^{n+\\frac{1}{2}}_{i-\\frac{1}{2}}\\right),$$\n其中阻尼乘子为 $\\alpha_u = \\frac{1-\\frac{\\sigma_{u}\\Delta t}{2}}{1+\\frac{\\sigma_{u}\\Delta t}{2}}$ 和 $\\alpha_p = \\frac{1-\\frac{\\sigma_{p}\\Delta t}{2}}{1+\\frac{\\sigma_{p}\\Delta t}{2}}$。\n\n在一个具有恒定 $\\rho$、$K$、$\\sigma_u$ 和 $\\sigma_p$ 的均匀区域中，假设存在局部平面波解，其形式为 $p^n_i = P\\,z^n\\,e^{\\mathrm{i}i\\theta}$ 和 $u^{n+\\frac{1}{2}}_{i+\\frac{1}{2}} = U\\,z^{n+\\frac{1}{2}}\\,e^{\\mathrm{i}(i+\\frac{1}{2})\\theta}$，其中 $\\theta = k\\,\\Delta x$ 是离散波数（$k$ 的单位为弧度/米），$z$ 是时间上的单步放大因子。从连续方程和给定的离散格式出发，推导在均匀有损情况下的离散色散关系，该关系将 $z$ 约束为 $\\Delta x$、$\\Delta t$、$c$、$k$、$\\sigma_u$ 和 $\\sigma_p$ 的函数。根据 $z$，在无损极限下通过 $z = \\exp(-\\mathrm{i}\\,\\omega_{\\mathrm{num}}\\Delta t)$ 定义数值角频率 $\\omega_{\\mathrm{num}}$，对于非零损耗，通过 $|z| = A_{\\mathrm{step}}$ 定义每步振幅比 $A_{\\mathrm{step}}$，其中 $A_{\\mathrm{step}} \\in (0,1]$。为以下每个测试用例计算数值相速度 $v_{\\mathrm{ph}} = \\omega_{\\mathrm{num}}/k$ 和 $A_{\\mathrm{step}}$。\n\n您必须实现一个完整的、可运行的程序，该程序针对每个测试用例，求解推导出的离散色散关系并输出所要求的指标。在非均匀双区域情况下，将每个区域视为局部均匀，并分别报告每个区域的指标对。\n\n必须遵守所有物理单位：以米/秒 (m/s) 为单位将 $v_{\\mathrm{ph}}$ 报告为浮点数，将 $A_{\\mathrm{step}}$ 报告为无量纲浮点数。角度必须以弧度为单位，波数 $k$ 必须以弧度/米为单位。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于均匀情况，每个测试用例贡献一个二元列表 $[v_{\\mathrm{ph}},A_{\\mathrm{step}}]$；对于非均匀情况，则贡献一个四元列表 $[v_{\\mathrm{ph,A}},A_{\\mathrm{step,A}},v_{\\mathrm{ph,B}},A_{\\mathrm{step,B}}]$。\n\n测试套件：\n- 用例1 (均匀，无损，理想路径)：$\\Delta x = 0.01$ m, $\\Delta t = 2\\times 10^{-5}$ s, $c = 343$ m/s, $\\rho = 1.2$ kg/m$^3$, $K = \\rho c^2$, $\\sigma_u = 0$ s$^{-1}$, $\\sigma_p = 0$ s$^{-1}$, $k = 50$ rad/m.\n- 用例2 (均匀，接近稳定性边界，高波数)：$\\Delta x = 0.005$ m, $c = 1500$ m/s, $\\rho = 1000$ kg/m$^3$, $K = \\rho c^2$, $\\Delta t = 0.999\\times \\frac{\\Delta x}{c}$ s, $\\sigma_u = 0$ s$^{-1}$, $\\sigma_p = 0$ s$^{-1}$, $k = 0.9\\times \\frac{\\pi}{\\Delta x}$ rad/m.\n- 用例3 (均匀，有损)：$\\Delta x = 0.01$ m, $\\Delta t = 2\\times 10^{-5}$ s, $c = 343$ m/s, $\\rho = 1.2$ kg/m$^3$, $K = \\rho c^2$, $\\sigma_u = 300$ s$^{-1}$, $\\sigma_p = 300$ s$^{-1}$, $k = 100$ rad/m.\n- 用例4 (非均匀，双区域，有损)：$\\Delta x = 0.002$ m, 区域 A 的参数为 $c_A = 2000$ m/s, $\\rho_A = 1200$ kg/m$^3$, $K_A = \\rho_A c_A^2$, $\\sigma_{u,A} = 100$ s$^{-1}$, $\\sigma_{p,A} = 50$ s$^{-1}$；区域 B 的参数为 $c_B = 1000$ m/s, $\\rho_B = 800$ kg/m$^3$, $K_B = \\rho_B c_B^2$, $\\sigma_{u,B} = 20$ s$^{-1}$, $\\sigma_{p,B} = 30$ s$^{-1}$。使用 $\\Delta t = 0.8\\times \\min\\left(\\frac{\\Delta x}{c_A},\\frac{\\Delta x}{c_B}\\right)$ s 和 $k = 1000$ rad/m。报告 $[v_{\\mathrm{ph,A}},A_{\\mathrm{step,A}},v_{\\mathrm{ph,B}},A_{\\mathrm{step,B}}]$。\n- 用例5 (均匀，长波长，无损边缘情况)：$\\Delta x = 0.01$ m, $\\Delta t = 2\\times 10^{-5}$ s, $c = 343$ m/s, $\\rho = 1.2$ kg/m$^3$, $K = \\rho c^2$, $\\sigma_u = 0$ s$^{-1}$, $\\sigma_p = 0$ s$^{-1}$, $k = 1$ rad/m.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按用例1到5的顺序排列，例如 $[[v_1,A_1],[v_2,A_2],[v_{3},A_{3}],[v_{A,4},A_{A,4},v_{B,4},A_{B,4}],[v_5,A_5]]$，其中每个 $v$ 的单位为 m/s，每个 $A$ 为无量纲。",
            "solution": "本问题要求推导用于含阻尼线性声学方程的一维时域有限差分 (FDTD) 格式的离散色散关系，并随后使用该关系为几个测试用例计算数值相速度和振幅衰减。\n\n出发点是关于声压 $p(x,t)$ 和质点速度 $u(x,t)$ 的连续、一阶、耦合偏微分方程组：\n$$\n\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho(x)}\\frac{\\partial p}{\\partial x} - \\sigma_u(x)\\,u\n$$\n$$\n\\frac{\\partial p}{\\partial t} = -K(x)\\frac{\\partial u}{\\partial x} - \\sigma_p(x)\\,p\n$$\n这些方程在交错网格上进行离散化，对双曲部分使用蛙跳格式，对阻尼项使用梯形法则。对于均匀介质，其中 $\\rho$、 $K$、 $\\sigma_u$ 和 $\\sigma_p$ 是常数，更新方程为：\n$$\nu^{n+\\frac{1}{2}}_{i+\\frac{1}{2}} = \\alpha_u\\,u^{n-\\frac{1}{2}}_{i+\\frac{1}{2}} - \\frac{\\Delta t}{\\rho\\Delta x\\,\\beta_u}\\left(p^n_{i+1}-p^n_i\\right) \\quad (1)\n$$\n$$\np^{n+1}_{i} = \\alpha_p\\,p^{n}_{i} - \\frac{K\\Delta t}{\\Delta x\\,\\beta_p}\\left(u^{n+\\frac{1}{2}}_{i+\\frac{1}{2}}-u^{n+\\frac{1}{2}}_{i-\\frac{1}{2}}\\right) \\quad (2)\n$$\n其中我们定义了 $\\beta_u = 1+\\frac{\\sigma_u\\Delta t}{2}$ 和 $\\beta_p = 1+\\frac{\\sigma_p\\Delta t}{2}$。阻尼乘子则为 $\\alpha_u = \\frac{1-\\sigma_{u}\\Delta t/2}{1+\\sigma_{u}\\Delta t/2} = \\frac{2-\\beta_u}{\\beta_u}$ 和 $\\alpha_p = \\frac{1-\\sigma_{p}\\Delta t/2}{1+\\sigma_{p}\\Delta t/2} = \\frac{2-\\beta_p}{\\beta_p}$。\n\n为求得离散色散关系，我们进行 von Neumann 分析，方法是将一个离散平面波解（差分算子的一个本征模）代入该格式中。试探解为：\n$$\np^n_i = P\\,z^n\\,e^{\\mathrm{i}i\\theta}\n$$\n$$\nu^{n+\\frac{1}{2}}_{i+\\frac{1}{2}} = U\\,z^{n+\\frac{1}{2}}\\,e^{\\mathrm{i}(i+\\frac{1}{2})\\theta}\n$$\n这里，$z$ 是每时间步的复放大因子，$\\theta = k\\Delta x$ 是离散波数，$k$ 是连续波数，$P$ 和 $U$ 分别是压力和速度的复振幅。\n\n将试探解代入方程 (1)：\n$$\nU z^{n+\\frac{1}{2}} e^{\\mathrm{i}(i+\\frac{1}{2})\\theta} = \\alpha_u U z^{n-\\frac{1}{2}} e^{\\mathrm{i}(i+\\frac{1}{2})\\theta} - \\frac{\\Delta t}{\\rho\\Delta x \\beta_u} \\left(P z^n e^{\\mathrm{i}(i+1)\\theta} - P z^n e^{\\mathrm{i}i\\theta}\\right)\n$$\n两边同除以 $z^{n-\\frac{1}{2}}e^{\\mathrm{i}i\\theta}$ 并进行因式分解，我们得到：\n$$\nU z e^{\\mathrm{i}\\frac{\\theta}{2}} = \\alpha_u U e^{\\mathrm{i}\\frac{\\theta}{2}} - \\frac{\\Delta t}{\\rho\\Delta x \\beta_u} P z^{\\frac{1}{2}} (e^{\\mathrm{i}\\theta} - 1)\n$$\n使用恒等式 $e^{\\mathrm{i}\\theta} - 1 = e^{\\mathrm{i}\\frac{\\theta}{2}}(e^{\\mathrm{i}\\frac{\\theta}{2}}-e^{-\\mathrm{i}\\frac{\\theta}{2}}) = 2\\mathrm{i}e^{\\mathrm{i}\\frac{\\theta}{2}}\\sin(\\frac{\\theta}{2})$ 并化简：\n$$\nU (z - \\alpha_u) = - \\frac{2\\mathrm{i}\\Delta t}{\\rho\\Delta x \\beta_u} P z^{\\frac{1}{2}} \\sin\\left(\\frac{\\theta}{2}\\right) \\quad (3)\n$$\n\n接着，将试探解代入方程 (2)：\n$$\nP z^{n+1} e^{\\mathrm{i}i\\theta} = \\alpha_p P z^n e^{\\mathrm{i}i\\theta} - \\frac{K\\Delta t}{\\Delta x \\beta_p} \\left( U z^{n+\\frac{1}{2}}e^{\\mathrm{i}(i+\\frac{1}{2})\\theta} - U z^{n+\\frac{1}{2}}e^{\\mathrm{i}(i-\\frac{1}{2})\\theta} \\right)\n$$\n两边同除以 $z^n e^{\\mathrm{i}i\\theta}$ 并进行因式分解：\n$$\nP z = \\alpha_p P - \\frac{K\\Delta t}{\\Delta x \\beta_p} U z^{\\frac{1}{2}} (e^{\\mathrm{i}\\frac{\\theta}{2}} - e^{-\\mathrm{i}\\frac{\\theta}{2}})\n$$\n使用恒等式 $e^{\\mathrm{i}\\frac{\\theta}{2}}-e^{-\\mathrm{i}\\frac{\\theta}{2}} = 2\\mathrm{i}\\sin(\\frac{\\theta}{2})$：\n$$\nP(z - \\alpha_p) = - \\frac{2\\mathrmi K\\Delta t}{\\Delta x \\beta_p} U z^{\\frac{1}{2}} \\sin\\left(\\frac{\\theta}{2}\\right) \\quad (4)\n$$\n\n现在我们得到了一个关于 $P$ 和 $U$ 的二元线性方程组。为使该方程组有非平凡解，其系数矩阵的行列式必须为零。整理方程 (3) 和 (4) 得：\n$$\n(z - \\alpha_u)U + \\left(\\frac{2\\mathrm{i}\\Delta t \\sin(\\theta/2)}{\\rho\\Delta x \\beta_u} z^{\\frac{1}{2}}\\right)P = 0\n$$\n$$\n\\left(\\frac{2\\mathrmi K\\Delta t \\sin(\\theta/2)}{\\Delta x \\beta_p} z^{\\frac{1}{2}}\\right)U + (z - \\alpha_p)P = 0\n$$\n行列式为：\n$$\n(z - \\alpha_u)(z - \\alpha_p) - \\left(\\frac{2\\mathrmi K\\Delta t \\sin(\\theta/2)}{\\Delta x \\beta_p} z^{\\frac{1}{2}}\\right) \\left(\\frac{2\\mathrmi \\Delta t \\sin(\\theta/2)}{\\rho\\Delta x \\beta_u} z^{\\frac{1}{2}}\\right) = 0\n$$\n$$\n(z - \\alpha_u)(z - \\alpha_p) - (\\mathrm{i}^2) \\frac{4 K \\Delta t^2 \\sin^2(\\theta/2)}{\\rho \\Delta x^2 \\beta_u \\beta_p} z = 0\n$$\n使用 $c^2 = K/\\rho$ 和 $\\mathrm{i}^2 = -1$：\n$$\n(z - \\alpha_u)(z - \\alpha_p) + \\left(\\frac{2c\\Delta t}{\\Delta x}\\sin\\left(\\frac{\\theta}{2}\\right)\\right)^2 \\frac{z}{\\beta_u \\beta_p} = 0\n$$\n展开第一项并重新整理，得到离散色散关系，这是一个关于 $z$ 的二次方程：\n$$\nz^2 - (\\alpha_u + \\alpha_p)z + \\alpha_u\\alpha_p + \\left(\\frac{2c\\Delta t}{\\Delta x}\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)^2 \\frac{z}{\\beta_u \\beta_p} = 0\n$$\n$$\nz^2 + \\left[ -\\left(\\alpha_u + \\alpha_p\\right) + \\frac{4}{\\beta_u\\beta_p}\\left(\\frac{c\\Delta t}{\\Delta x}\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)^2 \\right]z + \\alpha_u\\alpha_p = 0\n$$\n其形式为 $Az^2+Bz+C=0$，其中 $A=1$，\n$$\nB = -\\left(\\alpha_u + \\alpha_p\\right) + \\frac{4}{\\beta_u\\beta_p}\\left(\\frac{c\\Delta t}{\\Delta x}\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)^2\n$$\n$$\nC = \\alpha_u\\alpha_p\n$$\n$z$ 的两个解由二次方程求根公式给出：$z = \\frac{-B \\pm \\sqrt{B^2-4C}}{2}$。这两个根通常对应一个前向传播的物理模和一个反向传播或伪数值模。物理波模是衰减最小的那个模。因此，我们选择模较大的根。如果两个根是复共轭的（这在振荡解中很常见），它们的模相等，我们选择对应于时间上正向传播的根，该根通常具有非正虚部（因为 $\\omega_{\\text{num}}  0$ 且相位按 $e^{-\\mathrm{i}\\omega_{\\text{num}}t}$ 演化）。\n\n从选定的根 $z$ 中，我们提取所需的指标。每步振幅比是它的模：\n$$\nA_{\\mathrm{step}} = |z|\n$$\n数值角频率 $\\omega_{\\mathrm{num}}$ 从 $z$ 的相位导出。单个时间步 $t \\to t+\\Delta t$ 对应于乘以 $z$。复相位演化为 $e^{-\\mathrm{i}\\omega_{\\mathrm{num}}\\Delta t}$。因此，我们认定 $z/|z| = e^{-\\mathrm{i}\\omega_{\\mathrm{num}}\\Delta t}$。\n$$\n-\\omega_{\\mathrm{num}}\\Delta t = \\arg(z)\n$$\n$$\n\\omega_{\\mathrm{num}} = -\\frac{\\arg(z)}{\\Delta t}\n$$\n其中 $\\arg(z)$ 是 $z$ 的辐角，通常计算为 `atan2(Im(z), Re(z))`。数值相速度则为：\n$$\nv_{\\mathrm{ph}} = \\frac{\\omega_{\\mathrm{num}}}{k}\n$$\n对于非均匀测试用例，此分析被局部应用于每个区域，将其视为具有各自参数集的均匀介质，但共享全局离散化参数 $\\Delta x$、$\\Delta t$ 和波数 $k$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for numerical phase velocity and per-step amplitude ratio for a 1D lossy FDTD scheme.\n    \"\"\"\n\n    def calculate_metrics(dx, dt, c, k, sigma_u, sigma_p):\n        \"\"\"\n        Calculates v_ph and A_step for a set of homogeneous parameters.\n        \n        Args:\n            dx (float): Spatial step in meters.\n            dt (float): Time step in seconds.\n            c (float): Sound speed in m/s.\n            k (float): Wavenumber in rad/m.\n            sigma_u (float): Velocity damping coefficient in s^-1.\n            sigma_p (float): Pressure damping coefficient in s^-1.\n\n        Returns:\n            tuple: A tuple containing (numerical_phase_velocity, per_step_amplitude_ratio).\n        \"\"\"\n        # Ensure k is not zero to avoid division by zero for v_ph\n        if k == 0:\n            # The long-wavelength limit velocity is c, amplitude is damped by exp(-sigma*dt)\n            # This case is not in the test suite, but would be the physical limit.\n            # Here we can return NaN or raise an error as per problem constraints.\n            # Since problem cases have k  0, this is just for robustness.\n            return (np.nan, np.nan)\n\n        # Intermediate parameters\n        beta_u = 1.0 + sigma_u * dt / 2.0\n        beta_p = 1.0 + sigma_p * dt / 2.0\n        \n        alpha_u = (1.0 - sigma_u * dt / 2.0) / beta_u\n        alpha_p = (1.0 - sigma_p * dt / 2.0) / beta_p\n        \n        # Courant number combined with sine term\n        courant_sine_term = (c * dt / dx) * np.sin(k * dx / 2.0)\n\n        # Coefficients of the quadratic equation Az^2 + Bz + C = 0, with A=1\n        B = -(alpha_u + alpha_p) + 4.0 * (courant_sine_term**2) / (beta_u * beta_p)\n        C = alpha_u * alpha_p\n        \n        # Solve the quadratic equation for z\n        # Use complex math to handle the discriminant\n        discriminant = np.lib.scimath.sqrt(B**2 - 4.0 * C)\n        z1 = (-B + discriminant) / 2.0\n        z2 = (-B - discriminant) / 2.0\n\n        # Choose the correct root.\n        # The physical mode is the least damped, so it has the larger magnitude.\n        # If magnitudes are equal (complex conjugate roots), choose the one with\n        # non-positive imaginary part, for forward time evolution.\n        z = z1\n        if np.abs(z1)  np.abs(z2):\n            z = z2\n        elif np.isclose(np.abs(z1), np.abs(z2)):\n            if z1.imag  z2.imag:\n                z = z2\n\n        # Calculate metrics from the chosen root z\n        A_step = np.abs(z)\n        \n        # Numerical angular frequency, omega_num\n        # omega_num * dt = -arg(z)\n        omega_num = -np.angle(z) / dt\n\n        # Numerical phase velocity\n        v_ph = omega_num / k\n        \n        return v_ph, A_step\n\n    # Test Suite\n    test_cases = [\n        # Case 1: homogeneous, lossless, happy path\n        {'type': 'homo', 'params': {'dx': 0.01, 'dt': 2e-5, 'c': 343.0, 'rho': 1.2, 'sigma_u': 0.0, 'sigma_p': 0.0, 'k': 50.0}},\n        \n        # Case 2: homogeneous, near stability boundary, high wavenumber\n        {'type': 'homo', 'params': {'dx': 0.005, 'c': 1500.0, 'rho': 1000.0, 'sigma_u': 0.0, 'sigma_p': 0.0, 'k': 0.9 * np.pi / 0.005}},\n        \n        # Case 3: homogeneous, lossy\n        {'type': 'homo', 'params': {'dx': 0.01, 'dt': 2e-5, 'c': 343.0, 'rho': 1.2, 'sigma_u': 300.0, 'sigma_p': 300.0, 'k': 100.0}},\n\n        # Case 4: heterogeneous, two regions, lossy\n        {'type': 'hetero', 'params': {\n            'dx': 0.002,\n            'k': 1000.0,\n            'A': {'c': 2000.0, 'rho': 1200.0, 'sigma_u': 100.0, 'sigma_p': 50.0},\n            'B': {'c': 1000.0, 'rho': 800.0, 'sigma_u': 20.0, 'sigma_p': 30.0}\n        }},\n\n        # Case 5: homogeneous, long wavelength, lossless edge case\n        {'type': 'homo', 'params': {'dx': 0.01, 'dt': 2e-5, 'c': 343.0, 'rho': 1.2, 'sigma_u': 0.0, 'sigma_p': 0.0, 'k': 1.0}}\n    ]\n\n    # Special parameter calculations\n    # Case 2: dt is dependent on c and dx\n    c2_dx = test_cases[1]['params']['dx']\n    c2_c = test_cases[1]['params']['c']\n    test_cases[1]['params']['dt'] = 0.999 * c2_dx / c2_c\n\n    # Case 4: dt is dependent on properties of both regions\n    c4_dx = test_cases[3]['params']['dx']\n    c4_cA = test_cases[3]['params']['A']['c']\n    c4_cB = test_cases[3]['params']['B']['c']\n    test_cases[3]['params']['dt'] = 0.8 * min(c4_dx / c4_cA, c4_dx / c4_cB)\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'homo':\n            p = case['params']\n            res = calculate_metrics(p['dx'], p['dt'], p['c'], p['k'], p['sigma_u'], p['sigma_p'])\n            results.append(list(res))\n        \n        elif case['type'] == 'hetero':\n            p = case['params']\n            dx = p['dx']\n            k = p['k']\n            dt = p['dt']\n            \n            p_A = p['A']\n            res_A = calculate_metrics(dx, dt, p_A['c'], k, p_A['sigma_u'], p_A['sigma_p'])\n\n            p_B = p['B']\n            res_B = calculate_metrics(dx, dt, p_B['c'], k, p_B['sigma_u'], p_B['sigma_p'])\n            \n            results.append([res_A[0], res_A[1], res_B[0], res_B[1]])\n            \n    # Format the final output string\n    # E.g., [[val1, val2], [val3, val4], ...]\n    # map(str, list) converts each inner list to its string representation\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "理论上的稳定性并不总能保证实际计算中的长期可靠性。本练习通过一个思想实验，探讨了在FDTD模拟中设置时间步长的一个关键实践问题。即使数值格式在理论稳定性极限（即CFL数等于1）下是保能量且非耗散的，有限精度计算中不可避免的舍入误差会如何影响长期模拟的结果？通过分析，你将理解为什么在实践中必须引入一个安全系数，以确保模拟的鲁棒性并抑制误差的累积增长 。",
            "id": "3335878",
            "problem": "考虑在一维均匀 Yee 网格上，对真空中的 Maxwell 方程组进行时域有限差分法 (FDTD) 离散化，并采用周期性边界条件。连续方程是来自经典电磁学的旋度方程，\n$$\n\\frac{\\partial E(x,t)}{\\partial t}=\\frac{1}{\\epsilon}\\frac{\\partial H(x,t)}{\\partial x},\\qquad\n\\frac{\\partial H(x,t)}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E(x,t)}{\\partial x},\n$$\n其中 $E$ 和 $H$ 分别是电场和磁场，$\\epsilon$ 和 $\\mu$ 分别是自由空间的介电常数和磁导率，波速为 $c=\\frac{1}{\\sqrt{\\epsilon\\mu}}$。标准 Yee 格式在空间和时间上交错配置 $E$ 和 $H$。设离散场为空间索引 $i$ 和时间 $t^{n+\\frac{1}{2}}$ 处的 $E_i^{n+\\frac{1}{2}}$，以及空间索引 $i+\\frac{1}{2}$ 和时间 $t^n$ 处的 $H_{i+\\frac{1}{2}}^{n}$，网格间距为 $\\Delta x$ 和 $\\Delta t$。更新方程为\n$$\nE_i^{n+\\frac{1}{2}}=E_i^{n-\\frac{1}{2}}+\\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\left(H_{i+\\frac{1}{2}}^{n}-H_{i-\\frac{1}{2}}^{n}\\right),\n$$\n$$\nH_{i+\\frac{1}{2}}^{n+1}=H_{i+\\frac{1}{2}}^{n}+\\frac{\\Delta t}{\\mu\\,\\Delta x}\\left(E_{i+1}^{n+\\frac{1}{2}}-E_i^{n+\\frac{1}{2}}\\right).\n$$\n定义时间步 $n$ 的离散能量为\n$$\n\\mathcal{E}^n=\\sum_i \\left(\\frac{\\epsilon}{2}\\left(E_i^{n+\\frac{1}{2}}\\right)^2+\\frac{\\mu}{2}\\left(H_{i+\\frac{1}{2}}^n\\right)^2\\right).\n$$\n从能量方法和 von Neumann 分析可知，必须满足形式为\n$$\n\\Delta t\\le \\Delta t_{\\mathrm{CFL}}=\\frac{\\Delta x}{c}\n$$\n的 Courant–Friedrichs–Lewy (CFL) 稳定性条件，以防止在无损耗、周期性设置中 $\\mathcal{E}^n$ 的增长。傅里叶模式分析表明，在 CFL 极限 $\\Delta t=\\Delta t_{\\mathrm{CFL}}$ 处，每个可分辨模式的放大因子的模为 1，即，在理想化的真空情况下，该格式是中性稳定的且完全非耗散的。\n\n在计算电磁学中典型的高精度、长时间仿真中，必须考虑有限精度算法以及并非严格无损耗的建模要素（例如，吸收边界层或弱损耗材料）。假设浮点舍入被建模为在每个时间步对更新量施加的一个微小加性扰动，其相对于场振幅的特征大小为 $\\epsilon_{\\mathrm{mach}}$，并假设仿真运行了大量的步数 $N\\gg 10^5$。请从离散能量和放大因子的角度解释，为什么选择恰好在 CFL 极限处的 $\\Delta t$ 会导致由舍入误差和不足的数值阻尼驱动的寄生长时间能量增长，并提出了一个合理的安全因子 $\\alpha\\in(0,1)$，使得 $\\Delta t=\\alpha\\,\\Delta t_{\\mathrm{CFL}}$ 在实践中能获得鲁棒的长时间稳定性。\n\n以下哪个陈述最能概括正确的推理和对 $\\alpha$ 的适当选择？\n\nA. 在 CFL 极限处，Yee 格式对所有可分辨模式都是中性稳定的，即 $|\\lambda|=1$，因此来自浮点舍入误差或不完美吸收边界的微小持续扰动不会被阻尼，并可能在非常多的时间步后累积成寄生增长。一个审慎的选择是取 $\\alpha\\approx 0.95$，即 $\\Delta t=0.95\\,\\Delta t_{\\mathrm{CFL}}$，这在存在现实的吸收项或损耗项时提供了一个严格的谱半径裕度，并能抑制在 $N\\gg 10^5$ 步长内的增长。\n\nB. 在 CFL 极限处，该格式是强耗散的，即 $|\\lambda|0.5$，因此舍入误差会被自动消除。所以最安全且最高效的选择是 $\\alpha=1.0$。\n\nC. 舍入噪声只影响长波模式，而这些模式会被数值色散消除。为避免增长，必须总是取 $\\alpha=0.5$，而无需考虑网格和材料。\n\nD. 在 CFL 极限处，放大因子满足 $|\\lambda|1$，因此该格式是无条件不稳定的；唯一的安全做法是将时间步减半，在所有情况下都选择 $\\alpha=0.5$。",
            "solution": "用户需要对一个关于一维时域有限差分法 (FDTD) 长时间稳定性的问题进行批判性分析。\n\n### 问题验证\n\n首先，我将通过提取给定信息并评估其科学有效性来验证问题陈述（不包括选项）。\n\n**步骤 1：提取已知条件**\n\n- **控制方程 (一维 Maxwell 方程组):**\n  $$\n  \\frac{\\partial E(x,t)}{\\partial t}=\\frac{1}{\\epsilon}\\frac{\\partial H(x,t)}{\\partial x},\\qquad\n  \\frac{\\partial H(x,t)}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E(x,t)}{\\partial x}\n  $$\n- **参数：** 介电常数 $\\epsilon$，磁导率 $\\mu$，波速 $c=\\frac{1}{\\sqrt{\\epsilon\\mu}}$。\n- **离散化 (Yee 格式)：** 具有间距 $\\Delta x$ 和 $\\Delta t$ 的交错网格。离散场为 $E_i^{n+\\frac{1}{2}}$ 和 $H_{i+\\frac{1}{2}}^{n}$。\n- **更新方程：**\n  $$\n  E_i^{n+\\frac{1}{2}}=E_i^{n-\\frac{1}{2}}+\\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\left(H_{i+\\frac{1}{2}}^{n}-H_{i-\\frac{1}{2}}^{n}\\right)\n  $$\n  $$\n  H_{i+\\frac{1}{2}}^{n+1}=H_{i+\\frac{1}{2}}^{n}+\\frac{\\Delta t}{\\mu\\,\\Delta x}\\left(E_{i+1}^{n+\\frac{1}{2}}-E_i^{n+\\frac{1}{2}}\\right)\n  $$\n- **离散能量：**\n  $$\n  \\mathcal{E}^n=\\sum_i \\left(\\frac{\\epsilon}{2}\\left(E_i^{n+\\frac{1}{2}}\\right)^2+\\frac{\\mu}{2}\\left(H_{i+\\frac{1}{2}}^n\\right)^2\\right)\n  $$\n- **稳定性条件 (CFL):**\n  $$\n  \\Delta t\\le \\Delta t_{\\mathrm{CFL}}=\\frac{\\Delta x}{c}\n  $$\n- **CFL 极限下的性质：** 在 $\\Delta t=\\Delta t_{\\mathrm{CFL}}$ 处，任何模式的放大因子 $\\lambda$ 满足 $|\\lambda|=1$。该格式是中性稳定且非耗散的。\n- **背景：** 长时间仿真 ($N\\gg 10^5$ 步)，使用有限精度算法（舍入误差 $\\epsilon_{\\mathrm{mach}}$）和非理想元件（吸收边界、损耗材料）。\n- **问题：** 解释为什么选择 $\\Delta t=\\Delta t_{\\mathrm{CFL}}$ 对长时间稳定性存在问题，并为 $\\Delta t=\\alpha\\,\\Delta t_{\\mathrm{CFL}}$ 提出一个安全因子 $\\alpha\\in(0,1)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题陈述是 Maxwell 方程组 FDTD 方法的经典阐述。所有提供的方程、定义（Yee 网格、CFL 条件）和所述性质（极限处的中性稳定性）都是计算电磁学的基石。\n- **适定性：** 该问题是适定的。它要求解释数值模拟中一个有充分文献记载的现象——时间步长需要安全裕度——并为一个实际选择提供合理依据。所提供的信息是充分且内部一致的。\n- **客观性：** 语言技术性强、精确且客观。\n\n问题陈述没有科学缺陷、矛盾或歧义。它描述了偏微分方程数值分析中的一个标准、有效的问题。\n\n**步骤 3：结论与行动**\n\n问题是 **有效的**。解决过程将继续。\n\n### 解答推导\n\n该问题要求解释为什么在 Courant–Friedrichs–Lewy (CFL) 极限 $\\Delta t = \\Delta t_{\\mathrm{CFL}}$ 处使用时间步长 $\\Delta t$ 对于长时间、高精度的仿真是不切实际的，尽管该格式在此极限下理论上是稳定的。\n\n根本原因是该格式的 **中性稳定性**。如问题所述并通过 von Neumann 分析证实，对于理想的无损耗情况，只要满足 CFL 条件 $\\Delta t \\le \\Delta t_{\\mathrm{CFL}}$，任何傅里叶模式的放大因子 $\\lambda$ 都满足 $|\\lambda|=1$。一个模为单位值的放大因子意味着模式的振幅不随时间增长或衰减；它在每个时间步仅仅发生相移。\n\n在实际的计算环境中，这种中性稳定性有两个关键后果：\n\n1.  **扰动的累积：** 在使用有限精度浮点运算的实际仿真中，每次计算都会引入一个小的舍入误差，这可以被建模为在每个时间步添加的一个小振幅扰动 $\\epsilon_{\\mathrm{mach}}$。由于数值格式没有内在的阻尼机制（即它不是耗散的），这些误差不会被抑制。相反，它们在仿真中持续存在。在大量的时间步（$N \\gg 10^5$）之后，这些持续的、随机相位的误差的累积效应可能导致总误差场出现类似随机游走的增长。这表现为总离散能量 $\\mathcal{E}^n$ 的缓慢、不符合物理规律的增加，通常被称为寄生能量增长。\n\n2.  **非理想组件导致的不稳定性：** 真实的 FDTD 仿真很少只对带有周期性边界的简单真空进行建模。它几乎总是包含更复杂的特征，如吸收边界条件（例如，完美匹配层或 PMLs）或具有频率相关特性的材料。对于这种复合系统（Yee 格式 + PML + 复杂材料）的稳定性分析比单独的真空情况更为严格。这样一个系统的真实稳定性极限 $\\Delta t_{\\mathrm{stable}}$ 通常严格小于真空的 CFL 极限，即 $\\Delta t_{\\mathrm{stable}}  \\Delta t_{\\mathrm{CFL}}$。选择 $\\Delta t = \\Delta t_{\\mathrm{CFL}}$ 将意味着对于某些与非理想组件相互作用的模式，系统运行在不稳定区域（$|\\lambda|1$），导致场的快速、指数级增长和仿真的灾难性失败。\n\n为了确保鲁棒的长时间稳定性，必须让仿真在稳定区域内舒适地运行，而不是在其边界上。这通过引入一个 **安全因子** $\\alpha  1$ 并将时间步长设置为 $\\Delta t=\\alpha\\,\\Delta t_{\\mathrm{CFL}}$ 来实现。这提供了一个“安全裕度”，保证了整个复合系统的稳定性。虽然在特殊的一维情况下，这不会在真空 Yee 格式本身引入数值耗散，但它对于稳定与 PML 和其他组件的相互作用至关重要。在更一般的二维和三维情况下，选择 $\\alpha  1$ 也会为不沿网格轴传播的模式引入少量数值耗散，这有助于抑制虚假的高频噪声。\n\n安全因子的一个常见且审慎的选择是取一个略小于 1 的值，例如 $\\alpha \\approx 0.95$ 或 $\\alpha \\approx 0.99$。这个选择是一种权衡：它足够接近 1 以保持计算效率（更小的 $\\Delta t$ 需要更多的时间步来完成相同的仿真时间），但又足够小以提供一个针对不稳定性的鲁棒裕度。\n\n### 选项评估\n\n**A. 在 CFL 极限处，Yee 格式对所有可分辨模式都是中性稳定的，即 $|\\lambda|=1$，因此来自浮点舍入误差或不完美吸收边界的微小持续扰动不会被阻尼，并可能在非常多的时间步后累积成寄生增长。一个审慎的选择是取 $\\alpha\\approx 0.95$，即 $\\Delta t=0.95\\,\\Delta t_{\\mathrm{CFL}}$，这在存在现实的吸收项或损耗项时提供了一个严格的谱半径裕度，并能抑制在 $N\\gg 10^5$ 步长内的增长。**\n\n- **理由：** 这个陈述准确地反映了上述分析。它正确地指出了中性稳定性（$|\\lambda|=1$）是核心问题，导致了来自舍入误差和不完美边界的扰动的累积。它正确地解释了当包含现实组件时需要一个安全裕度（“严格的谱半径裕度”）。所提出的值 $\\alpha \\approx 0.95$ 是这样一个安全因子的标准、合理选择。\n- **结论：** **正确**。\n\n**B. 在 CFL 极限处，该格式是强耗散的，即 $|\\lambda|0.5$，因此舍入误差会被自动消除。所以最安全且最高效的选择是 $\\alpha=1.0$。**\n\n- **理由：** 这个陈述在事实上是错误的。问题正确地指出（且分析也证实）理想的 Yee 格式在 CFL 极限处是中性稳定的（$|\\lambda|=1$），而不是强耗散的。耗散意味着 $|\\lambda|1$。前提是错误的，因此结论无效。\n- **结论：** **错误**。\n\n**C. 舍入噪声只影响长波模式，而这些模式会被数值色散消除。为避免增长，必须总是取 $\\alpha=0.5$，而无需考虑网格和材料。**\n\n- **理由：** 这个陈述包含几个错误。首先，舍入噪声通常是宽带的，影响所有模式，而不仅仅是长波模式。其次，数值色散是波的相速度误差，而不是一种消除或阻尼模式的机制。第三，选择 $\\alpha=0.5$ 是任意保守的，并非普遍要求；它不必要地将计算效率减半。\n- **结论：** **错误**。\n\n**D. 在 CFL 极限处，放大因子满足 $|\\lambda|1$，因此该格式是无条件不稳定的；唯一的安全做法是将时间步减半，在所有情况下都选择 $\\alpha=0.5$。**\n\n- **理由：** 这个陈述是错误的。FDTD 格式是条件稳定的，在 CFL 极限 $\\Delta t = \\Delta t_{\\mathrm{CFL}}$ 处，它是中性稳定的（$|\\lambda|=1$），而不是不稳定的（$|\\lambda|1$）。只有当 $\\Delta t  \\Delta t_{\\mathrm{CFL}}$ 时，格式才会变得不稳定。前提是错误的，使得结论无效。\n- **结论：** **错误**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}