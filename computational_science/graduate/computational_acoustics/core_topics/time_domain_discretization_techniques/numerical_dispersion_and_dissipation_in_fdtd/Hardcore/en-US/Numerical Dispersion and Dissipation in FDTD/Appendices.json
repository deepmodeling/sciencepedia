{
    "hands_on_practices": [
        {
            "introduction": "The first step in understanding the accuracy of any wave simulation is to analyze how the numerical scheme represents a simple plane wave. This foundational exercise guides you through the derivation of the discrete dispersion relation for the standard 1D acoustic FDTD scheme. By performing this analysis, you will see precisely how the discretization process transforms the linear relationship between frequency and wavenumber of the continuous world into a non-linear one, giving rise to numerical dispersion and a phase velocity that depends on wavelength and grid resolution .",
            "id": "4132831",
            "problem": "Consider one-dimensional linear acoustics in a homogeneous medium with equilibrium density $\\rho_{0}$ and sound speed $c$. The linearized equations for pressure $p(x,t)$ and particle velocity $u(x,t)$ are\n$$\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x}, \\qquad \\frac{\\partial p}{\\partial t} = -\\rho_{0} c^{2} \\frac{\\partial u}{\\partial x}.$$\nDiscretize this system on a uniform spatial grid with spacing $\\Delta x$ and temporal step $\\Delta t$ using a staggered Finite-Difference Time-Domain (FDTD) scheme (Finite-Difference Time-Domain (FDTD) is a second-order, explicit, leapfrog scheme). Place $p$ at integer spatial indices $i$ and integer time indices $n$, and $u$ at half-integer indices in both space and time. The fully discrete update equations are\n$$u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = u_{i+\\frac{1}{2}}^{n-\\frac{1}{2}} - \\frac{\\Delta t}{\\rho_{0}\\,\\Delta x} \\left(p_{i+1}^{n} - p_{i}^{n}\\right),$$\n$$p_{i}^{n+1} = p_{i}^{n} - \\rho_{0} c^{2} \\frac{\\Delta t}{\\Delta x} \\left(u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{i-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right).$$\nAssume monochromatic plane-wave solutions of the form\n$$p_{i}^{n} = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(i\\,\\kappa - n\\,\\Omega\\right)\\right), \\qquad u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - \\left(n+\\tfrac{1}{2}\\right)\\Omega\\right)\\right),$$\nwhere $\\kappa = k\\,\\Delta x$ is the dimensionless wavenumber, $\\Omega = \\omega\\,\\Delta t$ is the dimensionless angular frequency, and $k$ and $\\omega$ are the continuous wavenumber and angular frequency. Let the Courant number be $\\sigma = \\dfrac{c\\,\\Delta t}{\\Delta x}$. Using these definitions, derive the discrete dispersion relation by eliminating $\\hat{p}$ and $\\hat{u}$, and provide a single closed-form analytic expression for $\\Omega$ in terms of $\\kappa$ and $\\sigma$. Use radians for trigonometric functions. Your final answer must be a single closed-form expression for $\\Omega(\\kappa,\\sigma)$.",
            "solution": "The objective is to derive the discrete dispersion relation for the given Finite-Difference Time-Domain (FDTD) scheme. This is achieved by substituting the assumed monochromatic plane-wave solutions into the discrete update equations.\n\nThe provided FDTD update equations are:\n$$u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = u_{i+\\frac{1}{2}}^{n-\\frac{1}{2}} - \\frac{\\Delta t}{\\rho_{0}\\,\\Delta x} \\left(p_{i+1}^{n} - p_{i}^{n}\\right) \\quad (1)$$\n$$p_{i}^{n+1} = p_{i}^{n} - \\rho_{0} c^{2} \\frac{\\Delta t}{\\Delta x} \\left(u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{i-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right) \\quad (2)$$\nThe plane-wave solutions are:\n$$p_{i}^{n} = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(i\\,\\kappa - n\\,\\Omega\\right)\\right)$$\n$$u_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - \\left(n+\\tfrac{1}{2}\\right)\\Omega\\right)\\right)$$\nwhere $\\mathrm{i}$ is the imaginary unit, $\\kappa = k\\Delta x$ is the dimensionless wavenumber, and $\\Omega=\\omega\\Delta t$ is the dimensionless angular frequency.\n\nFirst, we substitute the plane-wave forms into equation (1). To simplify the algebra, we express all terms relative to a common spatiotemporal point, for which we choose the center of the stencil, $(i+\\frac{1}{2})\\Delta x$ in space and $n\\Delta t$ in time. The field variables at different grid points are then:\n$$u_{i+\\frac{1}{2}}^{n\\pm\\frac{1}{2}} = \\hat{u} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - \\left(n\\pm\\tfrac{1}{2}\\right)\\Omega\\right)\\right) = \\hat{u} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - n\\Omega\\right)\\right) \\exp(\\mp \\mathrm{i}\\Omega/2)$$\n$$p_{i+1}^{n} = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+1\\right)\\kappa - n\\Omega\\right)\\right) = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - n\\Omega\\right)\\right) \\exp(\\mathrm{i}\\kappa/2)$$\n$$p_{i}^{n} = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(i\\kappa - n\\Omega\\right)\\right) = \\hat{p} \\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\tfrac{1}{2}\\right)\\kappa - n\\Omega\\right)\\right) \\exp(-\\mathrm{i}\\kappa/2)$$\nSubstituting these into equation (1) and cancelling the common factor $\\exp\\!\\left(\\mathrm{i}\\left(\\left(i+\\frac{1}{2}\\right)\\kappa - n\\Omega\\right)\\right)$ from all terms, we obtain:\n$$\\hat{u} \\exp(-\\mathrm{i}\\Omega/2) = \\hat{u} \\exp(\\mathrm{i}\\Omega/2) - \\frac{\\Delta t}{\\rho_0 \\Delta x} \\left[ \\hat{p} \\exp(\\mathrm{i}\\kappa/2) - \\hat{p} \\exp(-\\mathrm{i}\\kappa/2) \\right]$$\nRearranging the terms to group $\\hat{u}$ and $\\hat{p}$:\n$$\\hat{u} \\left( \\exp(\\mathrm{i}\\Omega/2) - \\exp(-\\mathrm{i}\\Omega/2) \\right) = \\frac{\\Delta t}{\\rho_0 \\Delta x} \\hat{p} \\left( \\exp(\\mathrm{i}\\kappa/2) - \\exp(-\\mathrm{i}\\kappa/2) \\right)$$\nUsing Euler's formula, $\\sin(x) = \\frac{\\exp(\\mathrm{i}x) - \\exp(-\\mathrm{i}x)}{2\\mathrm{i}}$, this simplifies to:\n$$\\hat{u} \\left( 2\\mathrm{i}\\sin(\\Omega/2) \\right) = \\frac{\\Delta t}{\\rho_0 \\Delta x} \\hat{p} \\left( 2\\mathrm{i}\\sin(\\kappa/2) \\right)$$\n$$\\hat{u} \\sin(\\Omega/2) = \\frac{\\Delta t}{\\rho_0 \\Delta x} \\hat{p} \\sin(\\kappa/2) \\quad (3)$$\n\nNext, we repeat the process for equation (2). The spatiotemporal center of this stencil is at $i\\Delta x$ and $(n+\\frac{1}{2})\\Delta t$. We express the variables relative to this point:\n$$p_{i}^{n+1} = \\hat{p} \\exp(\\mathrm{i}(i\\kappa - (n+1)\\Omega)) = \\hat{p} \\exp(\\mathrm{i}(i\\kappa - (n+\\tfrac{1}{2})\\Omega)) \\exp(-\\mathrm{i}\\Omega/2)$$\n$$p_{i}^{n} = \\hat{p} \\exp(\\mathrm{i}(i\\kappa - n\\Omega)) = \\hat{p} \\exp(\\mathrm{i}(i\\kappa - (n+\\tfrac{1}{2})\\Omega)) \\exp(\\mathrm{i}\\Omega/2)$$\n$$u_{i\\pm\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u} \\exp(\\mathrm{i}((i\\pm\\tfrac{1}{2})\\kappa - (n+\\tfrac{1}{2})\\Omega)) = \\hat{u} \\exp(\\mathrm{i}(i\\kappa - (n+\\tfrac{1}{2})\\Omega)) \\exp(\\pm\\mathrm{i}\\kappa/2)$$\nSubstituting into equation (2) and cancelling the common factor $\\exp(\\mathrm{i}(i\\kappa - (n+\\frac{1}{2})\\Omega))$:\n$$\\hat{p} \\exp(-\\mathrm{i}\\Omega/2) = \\hat{p} \\exp(\\mathrm{i}\\Omega/2) - \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\left[ \\hat{u} \\exp(\\mathrm{i}\\kappa/2) - \\hat{u} \\exp(-\\mathrm{i}\\kappa/2) \\right]$$\nRearranging and applying Euler's formula:\n$$\\hat{p} \\left( \\exp(\\mathrm{i}\\Omega/2) - \\exp(-\\mathrm{i}\\Omega/2) \\right) = \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\hat{u} \\left( \\exp(\\mathrm{i}\\kappa/2) - \\exp(-\\mathrm{i}\\kappa/2) \\right)$$\n$$\\hat{p} \\left( 2\\mathrm{i}\\sin(\\Omega/2) \\right) = \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\hat{u} \\left( 2\\mathrm{i}\\sin(\\kappa/2) \\right)$$\n$$\\hat{p} \\sin(\\Omega/2) = \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\hat{u} \\sin(\\kappa/2) \\quad (4)$$\n\nEquations (3) and (4) form a homogeneous linear system for the amplitudes $\\hat{p}$ and $\\hat{u}$. For a non-trivial solution to exist (i.e., $(\\hat{p}, \\hat{u}) \\neq (0,0)$), the determinant of the coefficient matrix must be zero. The system can be written as:\n$$\\begin{pmatrix} \\sin(\\Omega/2)  -\\frac{\\Delta t}{\\rho_0 \\Delta x} \\sin(\\kappa/2) \\\\ -\\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\sin(\\kappa/2)  \\sin(\\Omega/2) \\end{pmatrix} \\begin{pmatrix} \\hat{u} \\\\ \\hat{p} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\nSetting the determinant to zero gives the dispersion relation:\n$$\\sin^2(\\Omega/2) - \\left( \\frac{\\Delta t}{\\rho_0 \\Delta x} \\sin(\\kappa/2) \\right) \\left( \\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\sin(\\kappa/2) \\right) = 0$$\n$$\\sin^2(\\Omega/2) - c^2 \\left(\\frac{\\Delta t}{\\Delta x}\\right)^2 \\sin^2(\\kappa/2) = 0$$\nWe are given the definition of the Courant number, $\\sigma = \\frac{c\\Delta t}{\\Delta x}$. Substituting this into the equation yields:\n$$\\sin^2(\\Omega/2) = \\sigma^2 \\sin^2(\\kappa/2)$$\nTaking the square root of both sides, we consider the physically meaningful positive root which corresponds to forward-propagating waves:\n$$\\sin(\\Omega/2) = \\sigma \\sin(\\kappa/2)$$\nFinally, we solve for $\\Omega$ by taking the arcsin of both sides and multiplying by $2$:\n$$\\frac{\\Omega}{2} = \\arcsin\\left(\\sigma \\sin(\\kappa/2)\\right)$$\n$$\\Omega = 2 \\arcsin\\left(\\sigma \\sin(\\kappa/2)\\right)$$\nThis is the discrete dispersion relation for the given staggered FDTD scheme, expressing the dimensionless frequency $\\Omega$ as a function of the dimensionless wavenumber $\\kappa$ and the Courant number $\\sigma$.",
            "answer": "$$\\boxed{2 \\arcsin\\left(\\sigma \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)}$$"
        },
        {
            "introduction": "Real-world acoustic problems rarely involve lossless, homogeneous media. This practice extends the fundamental analysis to more realistic scenarios that include physical damping and spatially varying material properties. By deriving the dispersion relation for a lossy, heterogeneous medium and implementing it in code, you will bridge the gap between theory and practical application, learning to quantify the combined effects of physical dissipation and numerical dispersion on wave amplitude and phase velocity .",
            "id": "4132822",
            "problem": "Consider one-dimensional linear acoustics governed by the coupled first-order system for acoustic pressure $p(x,t)$ and particle velocity $u(x,t)$ in a spatially varying medium with mass density $\\rho(x)$, bulk modulus $K(x)$, and linear loss characterized by velocity damping coefficient $\\sigma_u(x)$ and pressure damping coefficient $\\sigma_p(x)$. The continuous equations are\n$$\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho(x)}\\frac{\\partial p}{\\partial x} - \\sigma_u(x)\\,u,$$\n$$\\frac{\\partial p}{\\partial t} = -K(x)\\frac{\\partial u}{\\partial x} - \\sigma_p(x)\\,p,$$\nwith sound speed $c(x)$ defined by $c(x) = \\sqrt{\\frac{K(x)}{\\rho(x)}}$. Adopt a staggered-grid Finite-Difference Time-Domain (FDTD) discretization in one dimension with spatial step $\\Delta x$ and time step $\\Delta t$, where $p$ is sampled at integer spatial indices $i$ and integer time indices $n$, and $u$ is sampled at half-integer spatial indices $i+\\frac{1}{2}$ and half-integer time indices $n+\\frac{1}{2}$. Use the leapfrog scheme for the hyperbolic terms and the trapezoidal rule for the linear loss terms, so that the discrete updates are of the form\n$$u^{n+\\frac{1}{2}}_{i+\\frac{1}{2}} = \\alpha_u\\,u^{n-\\frac{1}{2}}_{i+\\frac{1}{2}} - \\frac{\\Delta t}{\\rho_{i+\\frac{1}{2}}\\Delta x\\,\\left(1+\\frac{\\sigma_{u,i+\\frac{1}{2}}\\Delta t}{2}\\right)}\\left(p^n_{i+1}-p^n_i\\right),$$\n$$p^{n+1}_{i} = \\alpha_p\\,p^{n}_{i} - \\frac{K_{i}\\Delta t}{\\Delta x\\,\\left(1+\\frac{\\sigma_{p,i}\\Delta t}{2}\\right)}\\left(u^{n+\\frac{1}{2}}_{i+\\frac{1}{2}}-u^{n+\\frac{1}{2}}_{i-\\frac{1}{2}}\\right),$$\nwhere the damping multipliers are $\\alpha_u = \\frac{1-\\frac{\\sigma_{u}\\Delta t}{2}}{1+\\frac{\\sigma_{u}\\Delta t}{2}}$ and $\\alpha_p = \\frac{1-\\frac{\\sigma_{p}\\Delta t}{2}}{1+\\frac{\\sigma_{p}\\Delta t}{2}}$.\n\nAssume local plane-wave solutions in a homogeneous region with constant $\\rho$, $K$, $\\sigma_u$, and $\\sigma_p$, of the form $p^n_i = P\\,z^n\\,e^{\\mathrm{i}i\\theta}$ and $u^{n+\\frac{1}{2}}_{i+\\frac{1}{2}} = U\\,z^{n+\\frac{1}{2}}\\,e^{\\mathrm{i}(i+\\frac{1}{2})\\theta}$, where $\\theta = k\\,\\Delta x$ is the discrete wavenumber with $k$ in radians per meter, and $z$ is the one-step amplification factor in time. Starting from the continuous equations and the given discrete scheme, derive the discrete dispersion relation in the homogeneous lossy case that constrains $z$ as a function of $\\Delta x$, $\\Delta t$, $c$, $k$, $\\sigma_u$, and $\\sigma_p$. From $z$, define the numerical angular frequency $\\omega_{\\mathrm{num}}$ and per-step amplitude ratio $A_{\\mathrm{step}}$ by $z = \\exp(-\\mathrm{i}\\,\\omega_{\\mathrm{num}}\\Delta t)$ in the lossless limit and $|z| = A_{\\mathrm{step}}$ with $A_{\\mathrm{step}} \\in (0,1]$ for nonzero losses. Compute the numerical phase velocity $v_{\\mathrm{ph}} = \\omega_{\\mathrm{num}}/k$ and $A_{\\mathrm{step}}$ for each test case below.\n\nYou must implement a complete, runnable program that, for each test case, solves the derived discrete dispersion relation and outputs the requested metrics. In heterogeneous two-region cases, treat each region as locally homogeneous and report the pair of metrics for each region separately.\n\nAll physical units must be respected: report $v_{\\mathrm{ph}}$ in meters per second (m/s) as a float, and $A_{\\mathrm{step}}$ as a dimensionless float. Angles must be in radians, and wavenumbers $k$ must be in radians per meter. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case contributing either a two-element list $[v_{\\mathrm{ph}},A_{\\mathrm{step}}]$ for homogeneous cases or a four-element list $[v_{\\mathrm{ph,A}},A_{\\mathrm{step,A}},v_{\\mathrm{ph,B}},A_{\\mathrm{step,B}}]$ for the heterogeneous case.\n\nTest Suite:\n- Case $1$ (homogeneous, lossless, happy path): $\\Delta x = 0.01$ m, $\\Delta t = 2\\times 10^{-5}$ s, $c = 343$ m/s, $\\rho = 1.2$ kg/m$^3$, $K = \\rho c^2$, $\\sigma_u = 0$ s$^{-1}$, $\\sigma_p = 0$ s$^{-1}$, $k = 50$ rad/m.\n- Case $2$ (homogeneous, near stability boundary, high wavenumber): $\\Delta x = 0.005$ m, $c = 1500$ m/s, $\\rho = 1000$ kg/m$^3$, $K = \\rho c^2$, $\\Delta t = 0.999\\times \\frac{\\Delta x}{c}$ s, $\\sigma_u = 0$ s$^{-1}$, $\\sigma_p = 0$ s$^{-1}$, $k = 0.9\\times \\frac{\\pi}{\\Delta x}$ rad/m.\n- Case $3$ (homogeneous, lossy): $\\Delta x = 0.01$ m, $\\Delta t = 2\\times 10^{-5}$ s, $c = 343$ m/s, $\\rho = 1.2$ kg/m$^3$, $K = \\rho c^2$, $\\sigma_u = 300$ s$^{-1}$, $\\sigma_p = 300$ s$^{-1}$, $k = 100$ rad/m.\n- Case $4$ (heterogeneous, two regions, lossy): $\\Delta x = 0.002$ m, region A has $c_A = 2000$ m/s, $\\rho_A = 1200$ kg/m$^3$, $K_A = \\rho_A c_A^2$, $\\sigma_{u,A} = 100$ s$^{-1}$, $\\sigma_{p,A} = 50$ s$^{-1}$; region B has $c_B = 1000$ m/s, $\\rho_B = 800$ kg/m$^3$, $K_B = \\rho_B c_B^2$, $\\sigma_{u,B} = 20$ s$^{-1}$, $\\sigma_{p,B} = 30$ s$^{-1}$. Use $\\Delta t = 0.8\\times \\min\\left(\\frac{\\Delta x}{c_A},\\frac{\\Delta x}{c_B}\\right)$ s and $k = 1000$ rad/m. Report $[v_{\\mathrm{ph,A}},A_{\\mathrm{step,A}},v_{\\mathrm{ph,B}},A_{\\mathrm{step,B}}]$.\n- Case $5$ (homogeneous, long wavelength, lossless edge case): $\\Delta x = 0.01$ m, $\\Delta t = 2\\times 10^{-5}$ s, $c = 343$ m/s, $\\rho = 1.2$ kg/m$^3$, $K = \\rho c^2$, $\\sigma_u = 0$ s$^{-1}$, $\\sigma_p = 0$ s$^{-1}$, $k = 1$ rad/m.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of cases $1$ through $5$, for example, $[[v_1,A_1],[v_2,A_2],[v_{3},A_{3}],[v_{A,4},A_{A,4},v_{B,4},A_{B,4}],[v_5,A_5]]$ with each $v$ in m/s and each $A$ dimensionless.",
            "solution": "The present problem requires the derivation of the discrete dispersion relation for a one-dimensional finite-difference time-domain (FDTD) scheme for the linear acoustic equations with damping, and its subsequent use to compute numerical phase velocity and amplitude decay for several test cases.\n\nThe starting point is the set of continuous, first-order, coupled partial differential equations for acoustic pressure $p(x,t)$ and particle velocity $u(x,t)$:\n$$\n\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho(x)}\\frac{\\partial p}{\\partial x} - \\sigma_u(x)\\,u\n$$\n$$\n\\frac{\\partial p}{\\partial t} = -K(x)\\frac{\\partial u}{\\partial x} - \\sigma_p(x)\\,p\n$$\nThese equations are discretized on a staggered grid using a leapfrog scheme for the hyperbolic part and the trapezoidal rule for the damping terms. For a homogeneous medium, where $\\rho$, $K$, $\\sigma_u$, and $\\sigma_p$ are constant, the update equations are:\n$$\nu^{n+\\frac{1}{2}}_{i+\\frac{1}{2}} = \\alpha_u\\,u^{n-\\frac{1}{2}}_{i+\\frac{1}{2}} - \\frac{\\Delta t}{\\rho\\Delta x\\,\\beta_u}\\left(p^n_{i+1}-p^n_i\\right) \\quad (1)\n$$\n$$\np^{n+1}_{i} = \\alpha_p\\,p^{n}_{i} - \\frac{K\\Delta t}{\\Delta x\\,\\beta_p}\\left(u^{n+\\frac{1}{2}}_{i+\\frac{1}{2}}-u^{n+\\frac{1}{2}}_{i-\\frac{1}{2}}\\right) \\quad (2)\n$$\nwhere we have defined $\\beta_u = 1+\\frac{\\sigma_u\\Delta t}{2}$ and $\\beta_p = 1+\\frac{\\sigma_p\\Delta t}{2}$. The damping multipliers are then $\\alpha_u = \\frac{1-\\sigma_{u}\\Delta t/2}{1+\\sigma_{u}\\Delta t/2} = \\frac{2-\\beta_u}{\\beta_u}$ and $\\alpha_p = \\frac{1-\\sigma_{p}\\Delta t/2}{1+\\sigma_{p}\\Delta t/2} = \\frac{2-\\beta_p}{\\beta_p}$.\n\nTo find the discrete dispersion relation, we perform a von Neumann analysis by substituting a discrete plane-wave solution (an eigenmode of the difference operators) into the scheme. The ansatz is:\n$$\np^n_i = P\\,z^n\\,e^{\\mathrm{i}i\\theta}\n$$\n$$\nu^{n+\\frac{1}{2}}_{i+\\frac{1}{2}} = U\\,z^{n+\\frac{1}{2}}\\,e^{\\mathrm{i}(i+\\frac{1}{2})\\theta}\n$$\nHere, $z$ is the complex amplification factor per time step, $\\theta = k\\Delta x$ is the discrete wavenumber, $k$ is the continuous wavenumber, and $P$ and $U$ are the complex amplitudes of pressure and velocity, respectively.\n\nSubstituting the ansatz into Equation (1):\n$$\nU z^{n+\\frac{1}{2}} e^{\\mathrm{i}(i+\\frac{1}{2})\\theta} = \\alpha_u U z^{n-\\frac{1}{2}} e^{\\mathrm{i}(i+\\frac{1}{2})\\theta} - \\frac{\\Delta t}{\\rho\\Delta x \\beta_u} \\left(P z^n e^{\\mathrm{i}(i+1)\\theta} - P z^n e^{\\mathrm{i}i\\theta}\\right)\n$$\nDividing by $z^{n-\\frac{1}{2}}e^{\\mathrm{i}i\\theta}$ and factoring, we obtain:\n$$\nU z e^{\\mathrm{i}\\frac{\\theta}{2}} = \\alpha_u U e^{\\mathrm{i}\\frac{\\theta}{2}} - \\frac{\\Delta t}{\\rho\\Delta x \\beta_u} P z^{\\frac{1}{2}} (e^{\\mathrm{i}\\theta} - 1)\n$$\nUsing the identity $e^{\\mathrm{i}\\theta} - 1 = e^{\\mathrm{i}\\frac{\\theta}{2}}(e^{\\mathrm{i}\\frac{\\theta}{2}}-e^{-\\mathrm{i}\\frac{\\theta}{2}}) = 2\\mathrm{i}e^{\\mathrm{i}\\frac{\\theta}{2}}\\sin(\\frac{\\theta}{2})$ and simplifying:\n$$\nU (z - \\alpha_u) = - \\frac{2\\mathrm{i}\\Delta t}{\\rho\\Delta x \\beta_u} P z^{\\frac{1}{2}} \\sin\\left(\\frac{\\theta}{2}\\right) \\quad (3)\n$$\n\nNext, substituting the ansatz into Equation (2):\n$$\nP z^{n+1} e^{\\mathrm{i}i\\theta} = \\alpha_p P z^n e^{\\mathrm{i}i\\theta} - \\frac{K\\Delta t}{\\Delta x \\beta_p} \\left( U z^{n+\\frac{1}{2}}e^{\\mathrm{i}(i+\\frac{1}{2})\\theta} - U z^{n+\\frac{1}{2}}e^{\\mathrm{i}(i-\\frac{1}{2})\\theta} \\right)\n$$\nDividing by $z^n e^{\\mathrm{i}i\\theta}$ and factoring:\n$$\nP z = \\alpha_p P - \\frac{K\\Delta t}{\\Delta x \\beta_p} U z^{\\frac{1}{2}} (e^{\\mathrm{i}\\frac{\\theta}{2}} - e^{-\\mathrm{i}\\frac{\\theta}{2}})\n$$\nUsing the identity $e^{\\mathrm{i}\\frac{\\theta}{2}}-e^{-\\mathrm{i}\\frac{\\theta}{2}} = 2\\mathrm{i}\\sin(\\frac{\\theta}{2})$:\n$$\nP(z - \\alpha_p) = - \\frac{2\\mathrm{i} K\\Delta t}{\\Delta x \\beta_p} U z^{\\frac{1}{2}} \\sin\\left(\\frac{\\theta}{2}\\right) \\quad (4)\n$$\n\nWe now have a system of two linear equations for $P$ and $U$. For a non-trivial solution to exist, the determinant of the coefficient matrix must be zero. Rearranging (3) and (4):\n$$\n(z - \\alpha_u)U + \\left(\\frac{2\\mathrm{i}\\Delta t \\sin(\\theta/2)}{\\rho\\Delta x \\beta_u} z^{\\frac{1}{2}}\\right)P = 0\n$$\n$$\n\\left(\\frac{2\\mathrm{i} K\\Delta t \\sin(\\theta/2)}{\\Delta x \\beta_p} z^{\\frac{1}{2}}\\right)U + (z - \\alpha_p)P = 0\n$$\nThe determinant is:\n$$\n(z - \\alpha_u)(z - \\alpha_p) - \\left(\\frac{2\\mathrm{i} K\\Delta t \\sin(\\theta/2)}{\\Delta x \\beta_p} z^{\\frac{1}{2}}\\right) \\left(\\frac{2\\mathrm{i} \\Delta t \\sin(\\theta/2)}{\\rho\\Delta x \\beta_u} z^{\\frac{1}{2}}\\right) = 0\n$$\n$$\n(z - \\alpha_u)(z - \\alpha_p) - (\\mathrm{i}^2) \\frac{4 K \\Delta t^2 \\sin^2(\\theta/2)}{\\rho \\Delta x^2 \\beta_u \\beta_p} z = 0\n$$\nUsing $c^2 = K/\\rho$ and $\\mathrm{i}^2 = -1$:\n$$\n(z - \\alpha_u)(z - \\alpha_p) + \\left(\\frac{2c\\Delta t}{\\Delta x}\\sin\\left(\\frac{\\theta}{2}\\right)\\right)^2 \\frac{z}{\\beta_u \\beta_p} = 0\n$$\nExpanding the first term and rearranging gives the discrete dispersion relation, which is a quadratic equation in $z$:\n$$\nz^2 - (\\alpha_u + \\alpha_p)z + \\alpha_u\\alpha_p + \\left(\\frac{2c\\Delta t}{\\Delta x}\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)^2 \\frac{z}{\\beta_u \\beta_p} = 0\n$$\n$$\nz^2 + \\left[ -\\left(\\alpha_u + \\alpha_p\\right) + \\frac{4}{\\beta_u\\beta_p}\\left(\\frac{c\\Delta t}{\\Delta x}\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)^2 \\right]z + \\alpha_u\\alpha_p = 0\n$$\nThis is of the form $Az^2+Bz+C=0$ with $A=1$,\n$$\nB = -\\left(\\alpha_u + \\alpha_p\\right) + \\frac{4}{\\beta_u\\beta_p}\\left(\\frac{c\\Delta t}{\\Delta x}\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)^2\n$$\n$$\nC = \\alpha_u\\alpha_p\n$$\nThe two solutions for $z$ are given by the quadratic formula: $z = \\frac{-B \\pm \\sqrt{B^2-4C}}{2}$. These two roots typically correspond to a forward-propagating physical mode and a backward-propagating or spurious numerical mode. The physical wave mode is the one that is least attenuated. We therefore select the root with the larger magnitude. If the roots are complex conjugates (as is common for oscillatory solutions), their magnitudes are equal, and we choose the root corresponding to forward propagation in time, which conventionally has a non-positive imaginary part (since $\\omega_{\\text{num}} > 0$ and the phase evolves as $e^{-\\mathrm{i}\\omega_{\\text{num}}t}$).\n\nFrom the chosen root $z$, we extract the required metrics. The per-step amplitude ratio is its magnitude:\n$$\nA_{\\mathrm{step}} = |z|\n$$\nThe numerical angular frequency $\\omega_{\\mathrm{num}}$ is derived from the phase of $z$. A single time step $t \\to t+\\Delta t$ corresponds to multiplication by $z$. The complex phase evolution is $e^{-\\mathrm{i}\\omega_{\\mathrm{num}}\\Delta t}$. Thus we identify $z/|z| = e^{-\\mathrm{i}\\omega_{\\mathrm{num}}\\Delta t}$.\n$$\n-\\omega_{\\mathrm{num}}\\Delta t = \\arg(z)\n$$\n$$\n\\omega_{\\mathrm{num}} = -\\frac{\\arg(z)}{\\Delta t}\n$$\nwhere $\\arg(z)$ is the argument of $z$, often computed as `atan2(Im(z), Re(z))`. The numerical phase velocity is then:\n$$\nv_{\\mathrm{ph}} = \\frac{\\omega_{\\mathrm{num}}}{k}\n$$\nFor the heterogeneous test case, this analysis is applied locally to each region, treating it as a homogeneous medium with its own set of parameters, but sharing the global discretization parameters $\\Delta x$, $\\Delta t$, and the wavenumber $k$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for numerical phase velocity and per-step amplitude ratio for a 1D lossy FDTD scheme.\n    \"\"\"\n\n    def calculate_metrics(dx, dt, c, k, sigma_u, sigma_p):\n        \"\"\"\n        Calculates v_ph and A_step for a set of homogeneous parameters.\n        \n        Args:\n            dx (float): Spatial step in meters.\n            dt (float): Time step in seconds.\n            c (float): Sound speed in m/s.\n            k (float): Wavenumber in rad/m.\n            sigma_u (float): Velocity damping coefficient in s^-1.\n            sigma_p (float): Pressure damping coefficient in s^-1.\n\n        Returns:\n            tuple: A tuple containing (numerical_phase_velocity, per_step_amplitude_ratio).\n        \"\"\"\n        # Ensure k is not zero to avoid division by zero for v_ph\n        if k == 0:\n            # The long-wavelength limit velocity is c, amplitude is damped by exp(-sigma*dt)\n            # This case is not in the test suite, but would be the physical limit.\n            # Here we can return NaN or raise an error as per problem constraints.\n            # Since problem cases have k>0, this is just for robustness.\n            return (np.nan, np.nan)\n\n        # Intermediate parameters\n        beta_u = 1.0 + sigma_u * dt / 2.0\n        beta_p = 1.0 + sigma_p * dt / 2.0\n        \n        alpha_u = (1.0 - sigma_u * dt / 2.0) / beta_u\n        alpha_p = (1.0 - sigma_p * dt / 2.0) / beta_p\n        \n        # Courant number combined with sine term\n        courant_sine_term = (c * dt / dx) * np.sin(k * dx / 2.0)\n\n        # Coefficients of the quadratic equation Az^2 + Bz + C = 0, with A=1\n        B = -(alpha_u + alpha_p) + 4.0 * (courant_sine_term**2) / (beta_u * beta_p)\n        C = alpha_u * alpha_p\n        \n        # Solve the quadratic equation for z\n        # Use complex math to handle the discriminant\n        discriminant = np.lib.scimath.sqrt(B**2 - 4.0 * C)\n        z1 = (-B + discriminant) / 2.0\n        z2 = (-B - discriminant) / 2.0\n\n        # Choose the correct root.\n        # The physical mode is the least damped, so it has the larger magnitude.\n        # If magnitudes are equal (complex conjugate roots), choose the one with\n        # non-positive imaginary part, for forward time evolution.\n        z = z1\n        if np.abs(z1)  np.abs(z2):\n            z = z2\n        elif np.isclose(np.abs(z1), np.abs(z2)):\n            if z1.imag > z2.imag:\n                z = z2\n\n        # Calculate metrics from the chosen root z\n        A_step = np.abs(z)\n        \n        # Numerical angular frequency, omega_num\n        # omega_num * dt = -arg(z)\n        omega_num = -np.angle(z) / dt\n\n        # Numerical phase velocity\n        v_ph = omega_num / k\n        \n        return v_ph, A_step\n\n    # Test Suite\n    test_cases = [\n        # Case 1: homogeneous, lossless, happy path\n        {'type': 'homo', 'params': {'dx': 0.01, 'dt': 2e-5, 'c': 343.0, 'rho': 1.2, 'sigma_u': 0.0, 'sigma_p': 0.0, 'k': 50.0}},\n        \n        # Case 2: homogeneous, near stability boundary, high wavenumber\n        {'type': 'homo', 'params': {'dx': 0.005, 'c': 1500.0, 'rho': 1000.0, 'sigma_u': 0.0, 'sigma_p': 0.0, 'k': 0.9 * np.pi / 0.005}},\n        \n        # Case 3: homogeneous, lossy\n        {'type': 'homo', 'params': {'dx': 0.01, 'dt': 2e-5, 'c': 343.0, 'rho': 1.2, 'sigma_u': 300.0, 'sigma_p': 300.0, 'k': 100.0}},\n\n        # Case 4: heterogeneous, two regions, lossy\n        {'type': 'hetero', 'params': {\n            'dx': 0.002,\n            'k': 1000.0,\n            'A': {'c': 2000.0, 'rho': 1200.0, 'sigma_u': 100.0, 'sigma_p': 50.0},\n            'B': {'c': 1000.0, 'rho': 800.0, 'sigma_u': 20.0, 'sigma_p': 30.0}\n        }},\n\n        # Case 5: homogeneous, long wavelength, lossless edge case\n        {'type': 'homo', 'params': {'dx': 0.01, 'dt': 2e-5, 'c': 343.0, 'rho': 1.2, 'sigma_u': 0.0, 'sigma_p': 0.0, 'k': 1.0}}\n    ]\n\n    # Special parameter calculations\n    # Case 2: dt is dependent on c and dx\n    case2_params = test_cases[1]['params']\n    case2_params['dt'] = 0.999 * case2_params['dx'] / case2_params['c']\n\n    # Case 4: dt is dependent on properties of both regions\n    case4_params = test_cases[3]['params']\n    dx4 = case4_params['dx']\n    c4A = case4_params['A']['c']\n    c4B = case4_params['B']['c']\n    case4_params['dt'] = 0.8 * min(dx4 / c4A, dx4 / c4B)\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'homo':\n            p = case['params']\n            res = calculate_metrics(p['dx'], p['dt'], p['c'], p['k'], p['sigma_u'], p['sigma_p'])\n            results.append(list(res))\n        \n        elif case['type'] == 'hetero':\n            p = case['params']\n            dx = p['dx']\n            k = p['k']\n            dt = p['dt']\n            \n            p_A = p['A']\n            res_A = calculate_metrics(dx, dt, p_A['c'], k, p_A['sigma_u'], p_A['sigma_p'])\n\n            p_B = p['B']\n            res_B = calculate_metrics(dx, dt, p_B['c'], k, p_B['sigma_u'], p_B['sigma_p'])\n            \n            results.append([res_A[0], res_A[1], res_B[0], res_B[1]])\n            \n    # Format the final output string\n    # E.g., [[val1, val2], [val3, val4], ...]\n    # map(str, list) converts each inner list to its string representation\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "While the Courant–Friedrichs–Lewy (CFL) condition defines the theoretical limit for stability, running a simulation precisely at this limit can lead to unphysical results over long durations. Although this problem is framed in the context of electromagnetics, the underlying principle of neutral stability is identical for acoustic FDTD. This exercise challenges you to think critically about the practical consequences of running a non-dissipative scheme, revealing how the accumulation of imperceptible round-off errors can compromise the physical fidelity of a long-term simulation .",
            "id": "3335878",
            "problem": "Consider the one-dimensional Finite-Difference Time-Domain (FDTD) discretization of Maxwell’s equations in vacuum on a uniform Yee grid with periodic boundary conditions. The continuous equations are the curl equations from classical electromagnetism,\n$$\n\\frac{\\partial E(x,t)}{\\partial t}=\\frac{1}{\\epsilon}\\frac{\\partial H(x,t)}{\\partial x},\\qquad\n\\frac{\\partial H(x,t)}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E(x,t)}{\\partial x},\n$$\nwhere $E$ and $H$ are the electric and magnetic fields, and $\\epsilon$ and $\\mu$ are the permittivity and permeability of free space, with wave speed $c=\\frac{1}{\\sqrt{\\epsilon\\mu}}$. The standard Yee scheme staggers $E$ and $H$ in space and time. Let the discrete fields be $E_i^{n+\\frac{1}{2}}$ at spatial index $i$ and time $t^{n+\\frac{1}{2}}$, and $H_{i+\\frac{1}{2}}^{n}$ at spatial index $i+\\frac{1}{2}$ and time $t^n$, with grid spacings $\\Delta x$ and $\\Delta t$. The update equations are\n$$\nE_i^{n+\\frac{1}{2}}=E_i^{n-\\frac{1}{2}}+\\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\left(H_{i+\\frac{1}{2}}^{n}-H_{i-\\frac{1}{2}}^{n}\\right),\n$$\n$$\nH_{i+\\frac{1}{2}}^{n+1}=H_{i+\\frac{1}{2}}^{n}+\\frac{\\Delta t}{\\mu\\,\\Delta x}\\left(E_{i+1}^{n+\\frac{1}{2}}-E_i^{n+\\frac{1}{2}}\\right).\n$$\nDefine the discrete energy at step $n$ by\n$$\n\\mathcal{E}^n=\\sum_i \\left(\\frac{\\epsilon}{2}\\left(E_i^{n+\\frac{1}{2}}\\right)^2+\\frac{\\mu}{2}\\left(H_{i+\\frac{1}{2}}^n\\right)^2\\right).\n$$\nIt is known from the energy method and von Neumann analysis that a Courant–Friedrichs–Lewy (CFL) stability condition of the form\n$$\n\\Delta t\\le \\Delta t_{\\mathrm{CFL}}=\\frac{\\Delta x}{c}\n$$\nmust hold to prevent growth of $\\mathcal{E}^n$ in the lossless, periodic setting. A Fourier-mode analysis shows that, at the CFL limit $\\Delta t=\\Delta t_{\\mathrm{CFL}}$, the amplification factor for each resolvable mode has magnitude $1$, i.e., the scheme is neutrally stable and exactly non-dissipative in the idealized vacuum case.\n\nIn high-accuracy, long-time simulations typical in computational electromagnetics, one must account for finite precision arithmetic and modeling ingredients that are not strictly lossless (for example, absorbing boundary layers or weakly lossy materials). Suppose floating-point rounding is modeled as a small additive perturbation to the update at each time step, with characteristic size $\\epsilon_{\\mathrm{mach}}$ relative to the field amplitudes, and assume the simulation runs for a large number $N\\gg 10^5$ of steps. Explain, based on the discrete energy and amplification-factor viewpoint, why choosing $\\Delta t$ exactly at the CFL limit can lead to parasitic long-time energy growth driven by roundoff and insufficient numerical damping, and propose a rational safety factor $\\alpha\\in(0,1)$ so that $\\Delta t=\\alpha\\,\\Delta t_{\\mathrm{CFL}}$ yields robust long-time stability in practice.\n\nWhich of the following statements best captures the correct reasoning and an appropriate choice of $\\alpha$?\n\nA. At the CFL limit the Yee scheme is neutrally stable with $|\\lambda|=1$ for all resolvable modes, so small persistent perturbations from floating-point roundoff or imperfect absorbing boundaries are not damped and can accumulate into parasitic growth over very many steps. A prudent choice is to take $\\alpha\\approx 0.95$, i.e., $\\Delta t=0.95\\,\\Delta t_{\\mathrm{CFL}}$, which provides a strict spectral-radius margin when realistic absorbing or lossy terms are present and suppresses growth over $N\\gg 10^5$ steps.\n\nB. At the CFL limit the scheme is strongly dissipative with $|\\lambda|0.5$, so roundoff errors are automatically eliminated. Therefore the safest and most efficient choice is $\\alpha=1.0$.\n\nC. Roundoff noise only affects long-wavelength modes, which are eliminated by numerical dispersion. To avoid growth one must always take $\\alpha=0.5$, irrespective of the grid and materials.\n\nD. At the CFL limit the amplification factor satisfies $|\\lambda|1$, so the scheme is unconditionally unstable; the only safe practice is to halve the time step, choosing $\\alpha=0.5$ in all cases.",
            "solution": "The user wants a critical analysis of a problem concerning the long-time stability of the one-dimensional Finite-Difference Time-Domain (FDTD) method.\n\n### Problem Validation\n\nFirst, I will validate the problem statement—excluding the options—by extracting the given information and assessing its scientific validity.\n\n**Step 1: Extract Givens**\n\n- **Governing Equations (1D Maxwell's):**\n  $$\n  \\frac{\\partial E(x,t)}{\\partial t}=\\frac{1}{\\epsilon}\\frac{\\partial H(x,t)}{\\partial x},\\qquad\n  \\frac{\\partial H(x,t)}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E(x,t)}{\\partial x}\n  $$\n- **Parameters:** Permittivity $\\epsilon$, permeability $\\mu$, wave speed $c=\\frac{1}{\\sqrt{\\epsilon\\mu}}$.\n- **Discretization (Yee Scheme):** Staggered grid with spacings $\\Delta x$ and $\\Delta t$. Discrete fields are $E_i^{n+\\frac{1}{2}}$ and $H_{i+\\frac{1}{2}}^{n}$.\n- **Update Equations:**\n  $$\n  E_i^{n+\\frac{1}{2}}=E_i^{n-\\frac{1}{2}}+\\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\left(H_{i+\\frac{1}{2}}^{n}-H_{i-\\frac{1}{2}}^{n}\\right)\n  $$\n  $$\n  H_{i+\\frac{1}{2}}^{n+1}=H_{i+\\frac{1}{2}}^{n}+\\frac{\\Delta t}{\\mu\\,\\Delta x}\\left(E_{i+1}^{n+\\frac{1}{2}}-E_i^{n+\\frac{1}{2}}\\right)\n  $$\n- **Discrete Energy:**\n  $$\n  \\mathcal{E}^n=\\sum_i \\left(\\frac{\\epsilon}{2}\\left(E_i^{n+\\frac{1}{2}}\\right)^2+\\frac{\\mu}{2}\\left(H_{i+\\frac{1}{2}}^n\\right)^2\\right)\n  $$\n- **Stability Condition (CFL):**\n  $$\n  \\Delta t\\le \\Delta t_{\\mathrm{CFL}}=\\frac{\\Delta x}{c}\n  $$\n- **Property at the CFL Limit:** At $\\Delta t=\\Delta t_{\\mathrm{CFL}}$, the amplification factor $\\lambda$ for any mode satisfies $|\\lambda|=1$. The scheme is neutrally stable and non-dissipative.\n- **Context:** Long-time simulations ($N\\gg 10^5$ steps) with finite precision arithmetic (roundoff error $\\epsilon_{\\mathrm{mach}}$) and non-ideal elements (absorbing boundaries, lossy materials).\n- **Question:** Explain why choosing $\\Delta t=\\Delta t_{\\mathrm{CFL}}$ is problematic for long-time stability and propose a safety factor $\\alpha\\in(0,1)$ for $\\Delta t=\\alpha\\,\\Delta t_{\\mathrm{CFL}}$.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem statement is a canonical exposition of the FDTD method for Maxwell's equations. All provided equations, definitions (Yee grid, CFL condition), and stated properties (neutral stability at the limit) are cornerstones of computational electromagnetics.\n- **Well-Posed:** The problem is well-posed. It asks for an explanation of a well-documented phenomenon in numerical simulations—the need for a safety margin in the time step—and the justification for a practical choice. The provided information is sufficient and internally consistent.\n- **Objective:** The language is technical, precise, and objective.\n\nThe problem statement is free of scientific flaws, contradictions, and ambiguities. It describes a standard, valid problem in numerical analysis for partial differential equations.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. The solution process will proceed.\n\n### Derivation of the Solution\n\nThe problem requires an explanation for why using a time step $\\Delta t$ at the Courant–Friedrichs–Lewy (CFL) limit, $\\Delta t = \\Delta t_{\\mathrm{CFL}}$, is impractical for long, high-accuracy simulations, even though the scheme is theoretically stable at this limit.\n\nThe fundamental reason is the scheme's **neutral stability**. As stated in the problem and confirmed by von Neumann analysis, for the ideal lossless case, the amplification factor $\\lambda$ for any Fourier mode satisfies $|\\lambda|=1$ whenever the CFL condition $\\Delta t \\le \\Delta t_{\\mathrm{CFL}}$ is met. An amplification factor with unit magnitude means that the amplitude of a mode neither grows nor decays over time; it is merely phase-shifted at each time step.\n\nThis neutral stability has two critical consequences in a practical computational setting:\n\n1.  **Accumulation of Perturbations:** In a real simulation using finite-precision floating-point arithmetic, each calculation introduces a small roundoff error, which can be modeled as a small-amplitude perturbation $\\epsilon_{\\mathrm{mach}}$ added at each time step. Since the numerical scheme has no inherent damping mechanism (i.e., it is not dissipative), these errors are not suppressed. Instead, they persist in the simulation. Over a large number of time steps ($N \\gg 10^5$), the cumulative effect of these persistent, randomly-phased errors can lead to a random-walk-like growth in the total error field. This manifests as a slow, unphysical increase in the total discrete energy $\\mathcal{E}^n$, often called parasitic energy growth.\n\n2.  **Instability with Non-Ideal Components:** A realistic FDTD simulation rarely models a simple vacuum with periodic boundaries. It almost always includes more complex features such as absorbing boundary conditions (e.g., Perfectly Matched Layers or PMLs) or materials with frequency-dependent properties. The stability analysis for the composite system (Yee scheme + PML + complex materials) is more stringent than for the vacuum case alone. The true stability limit, $\\Delta t_{\\mathrm{stable}}$, for such a system is often strictly less than the vacuum CFL limit, i.e., $\\Delta t_{\\mathrm{stable}}  \\Delta t_{\\mathrm{CFL}}$. Choosing $\\Delta t = \\Delta t_{\\mathrm{CFL}}$ would mean operating in an unstable regime ($|\\lambda|1$) for certain modes interacting with the non-ideal components, leading to rapid, exponential growth of fields and a catastrophic failure of the simulation.\n\nTo ensure robust, long-time stability, one must operate the simulation comfortably inside the stable region, not on its boundary. This is achieved by introducing a **safety factor** $\\alpha  1$ and setting the time step to $\\Delta t=\\alpha\\,\\Delta t_{\\mathrm{CFL}}$. This provides a \"safety margin\" that guarantees the stability of the entire composite system. While in the special 1D case this does not introduce numerical dissipation into the vacuum Yee scheme itself, it is crucial for stabilizing interactions with PMLs and other components. In the more general 2D and 3D cases, choosing $\\alpha  1$ also introduces a slight amount of numerical dissipation for modes not propagating along the grid axes, which can help damp spurious high-frequency noise.\n\nA common and prudent choice for the safety factor is a value slightly less than $1$, such as $\\alpha \\approx 0.95$ or $\\alpha \\approx 0.99$. This choice is a trade-off: it is close enough to $1$ to maintain computational efficiency (a smaller $\\Delta t$ requires more steps for the same simulation time) but small enough to provide a robust margin against instabilities.\n\n### Evaluation of Options\n\n**A. At the CFL limit the Yee scheme is neutrally stable with $|\\lambda|=1$ for all resolvable modes, so small persistent perturbations from floating-point roundoff or imperfect absorbing boundaries are not damped and can accumulate into parasitic growth over very many steps. A prudent choice is to take $\\alpha\\approx 0.95$, i.e., $\\Delta t=0.95\\,\\Delta t_{\\mathrm{CFL}}$, which provides a strict spectral-radius margin when realistic absorbing or lossy terms are present and suppresses growth over $N\\gg 10^5$ steps.**\n\n- **Justification:** This statement accurately reflects the analysis above. It correctly identifies neutral stability ($|\\lambda|=1$) as the core issue, leading to the accumulation of perturbations from roundoff and imperfect boundaries. It correctly explains the need for a safety margin (\"strict spectral-radius margin\") when realistic components are included. The proposed value $\\alpha \\approx 0.95$ is a standard, reasonable choice for such a safety factor.\n- **Verdict:** **Correct**.\n\n**B. At the CFL limit the scheme is strongly dissipative with $|\\lambda|0.5$, so roundoff errors are automatically eliminated. Therefore the safest and most efficient choice is $\\alpha=1.0$.**\n\n- **Justification:** This statement is factually incorrect. The problem correctly states (and analysis confirms) that the ideal Yee scheme is neutrally stable ($|\\lambda|=1$) at the CFL limit, not strongly dissipative. Dissipation implies $|\\lambda|1$. The premise is false, and therefore the conclusion is invalid.\n- **Verdict:** **Incorrect**.\n\n**C. Roundoff noise only affects long-wavelength modes, which are eliminated by numerical dispersion. To avoid growth one must always take $\\alpha=0.5$, irrespective of the grid and materials.**\n\n- **Justification:** This statement contains several errors. First, roundoff noise is typically wideband and affects all modes, not just long-wavelength ones. Second, numerical dispersion is an error in the phase velocity of the waves, not a mechanism for eliminating or damping modes. Third, the choice $\\alpha=0.5$ is arbitrarily conservative and not a general requirement; it unnecessarily halves the computational efficiency.\n- **Verdict:** **Incorrect**.\n\n**D. At the CFL limit the amplification factor satisfies $|\\lambda|1$, so the scheme is unconditionally unstable; the only safe practice is to halve the time step, choosing $\\alpha=0.5$ in all cases.**\n\n- **Justification:** This statement is false. The FDTD scheme is conditionally stable, and at the CFL limit $\\Delta t = \\Delta t_{\\mathrm{CFL}}$, it is neutrally stable ($|\\lambda|=1$), not unstable ($|\\lambda|1$). The scheme only becomes unstable if $\\Delta t  \\Delta t_{\\mathrm{CFL}}$. The premise is wrong, making the conclusion invalid.\n- **Verdict:** **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}