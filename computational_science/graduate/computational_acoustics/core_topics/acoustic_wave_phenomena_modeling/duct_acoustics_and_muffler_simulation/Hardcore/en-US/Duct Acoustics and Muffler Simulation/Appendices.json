{
    "hands_on_practices": [
        {
            "introduction": "This first practice solidifies the foundational principles of wave propagation in ducts. By deriving the modal behavior from first principles and calculating a specific cutoff frequency, you will gain a tangible understanding of how duct geometry dictates which sound frequencies can propagate and in what form . This skill is critical for predicting and controlling noise in any system involving guided waves, from HVAC ducts to engine exhausts.",
            "id": "4121356",
            "problem": "Consider a three-dimensional rectangular duct with rigid (acoustically hard) walls, occupying the domain $x \\in [0,a]$, $y \\in [0,b]$, and $z \\in \\mathbb{R}$. The duct is filled with a quiescent, inviscid, compressible fluid of uniform density $\\rho_{0}$ and speed of sound $c_{0}$. Let $p'(x,y,z,t)$ denote the acoustic pressure perturbation and $\\boldsymbol{u}'(x,y,z,t)$ the acoustic particle velocity perturbation. Assume small-amplitude acoustics so that linearized dynamics apply. \n\nStarting only from the linearized equations of motion for an inviscid compressible fluid (continuity, momentum, and an isentropic equation of state), derive the governing wave equation for $p'(x,y,z,t)$. Using time-harmonic dependence and separation of variables in the axial and transverse directions, formulate the transverse eigenvalue problem in the rectangular cross-section subject to rigid-wall boundary conditions. From this, obtain the modal transverse wavenumbers and the associated cutoff condition that determines the cutoff frequency for each mode.\n\nThen, for a rectangular duct of width $a = 0.15\\,\\mathrm{m}$ and height $b = 0.10\\,\\mathrm{m}$, and sound speed $c_{0} = 343\\,\\mathrm{m/s}$, evaluate the transverse modal wavenumber and the corresponding cutoff frequency for the mode indices $m=2$ and $n=1$. \n\nRound your numerical results to four significant figures. Express the transverse modal wavenumber in $\\mathrm{rad/m}$ and the cutoff frequency in $\\mathrm{Hz}$. Provide your final answer as a two-entry row matrix $\\bigl(\\gamma_{mn}, f_{mn}\\bigr)$.",
            "solution": "The problem asks for a derivation of the acoustic wave equation, the formulation of the transverse eigenvalue problem for a rectangular duct with rigid walls, the resulting modal characteristics, and a specific numerical calculation.\n\nThe derivation begins with the linearized governing equations for a quiescent, inviscid, compressible fluid. These are:\n1.  The continuity equation:\n    $$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = 0 $$\n2.  The momentum equation (Euler's equation):\n    $$ \\rho_{0} \\frac{\\partial \\boldsymbol{u}'}{\\partial t} = -\\nabla p' $$\n3.  The isentropic equation of state, which relates the pressure perturbation $p'$ to the density perturbation $\\rho'$:\n    $$ p' = c_{0}^{2} \\rho' $$\nHere, $\\rho_{0}$ is the mean fluid density, $c_{0}$ is the speed of sound, $\\boldsymbol{u}'$ is the acoustic particle velocity, and $p'$ is the acoustic pressure.\n\nTo derive the wave equation for the acoustic pressure $p'$, we combine these three equations. First, we express $\\rho'$ in terms of $p'$ using the equation of state: $\\rho' = p'/c_{0}^{2}$. Taking the time derivative gives:\n$$ \\frac{\\partial \\rho'}{\\partial t} = \\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} $$\nSubstituting this into the continuity equation yields:\n$$ \\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = 0 \\quad \\implies \\quad \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' = -\\frac{1}{c_{0}^{2}} \\frac{\\partial p'}{\\partial t} $$\nNext, we take the divergence of the momentum equation. Assuming the mean density $\\rho_{0}$ is uniform in space, we can commute the divergence and time derivative operators:\n$$ \\nabla \\cdot \\left( \\rho_{0} \\frac{\\partial \\boldsymbol{u}'}{\\partial t} \\right) = \\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}') = -\\nabla \\cdot (\\nabla p') = -\\nabla^{2} p' $$\nNow, we differentiate the rearranged continuity equation with respect to time:\n$$ \\frac{\\partial}{\\partial t} \\left( \\rho_{0} \\nabla \\cdot \\boldsymbol{u}' \\right) = \\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}') = -\\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} $$\nBy equating the two expressions for $\\rho_{0} \\frac{\\partial}{\\partial t} (\\nabla \\cdot \\boldsymbol{u}')$, we obtain:\n$$ -\\nabla^{2} p' = -\\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} $$\nThis simplifies to the homogeneous acoustic wave equation:\n$$ \\nabla^{2} p' - \\frac{1}{c_{0}^{2}} \\frac{\\partial^{2} p'}{\\partial t^{2}} = 0 $$\nTo analyze wave propagation along the duct (the $z$-axis), we assume a time-harmonic solution of the form $p'(x,y,z,t) = p(x,y,z) e^{i\\omega t}$, where $\\omega = 2\\pi f$ is the angular frequency. Substituting this into the wave equation gives the Helmholtz equation for the complex pressure amplitude $p(x,y,z)$:\n$$ \\nabla^{2} p + \\left(\\frac{\\omega}{c_{0}}\\right)^{2} p = 0 \\quad \\implies \\quad \\nabla^{2} p + k^{2} p = 0 $$\nwhere $k = \\omega/c_{0}$ is the acoustic wavenumber.\n\nWe use the method of separation of variables to solve the Helmholtz equation. For waves propagating in the $z$-direction, we look for solutions of the form $p(x,y,z) = \\psi(x,y) e^{\\pm ik_z z}$, where $\\psi(x,y)$ is the transverse mode shape and $k_z$ is the axial wavenumber. The Laplacian operator is $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$. Substituting the separated form into the Helmholtz equation:\n$$ \\left( \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}} \\right)\\psi e^{\\pm ik_z z} + \\psi \\frac{\\partial^{2}}{\\partial z^{2}} e^{\\pm ik_z z} + k^{2} \\psi e^{\\pm ik_z z} = 0 $$\n$$ e^{\\pm ik_z z} \\left[ \\left( \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}} \\right)\\psi \\right] + \\psi (-k_z^2) e^{\\pm ik_z z} + k^{2} \\psi e^{\\pm ik_z z} = 0 $$\nDividing by $e^{\\pm ik_z z}$ and rearranging for the transverse part gives:\n$$ \\frac{\\partial^{2}\\psi}{\\partial x^{2}} + \\frac{\\partial^{2}\\psi}{\\partial y^{2}} = -(k^{2} - k_z^{2})\\psi $$\nThis is a two-dimensional eigenvalue problem. We define the transverse wavenumber $\\gamma$ such that $\\gamma^{2} = k^{2} - k_z^{2}$. This equation, known as the dispersion relation, links the acoustic, axial, and transverse wavenumbers. The transverse eigenvalue problem is then:\n$$ \\frac{\\partial^{2}\\psi}{\\partial x^{2}} + \\frac{\\partial^{2}\\psi}{\\partial y^{2}} + \\gamma^{2}\\psi = 0 $$\nThe boundary conditions are determined by the rigid (acoustically hard) walls. At a rigid surface, the normal component of the particle velocity must be zero. From the time-harmonic momentum equation, $\\boldsymbol{u} = \\frac{i}{\\omega \\rho_{0}} \\nabla p$. Thus, the condition $\\boldsymbol{u} \\cdot \\hat{n} = 0$, where $\\hat{n}$ is the normal vector to the wall, implies $\\nabla p \\cdot \\hat{n} = 0$. For the rectangular duct, this means:\n$$ \\frac{\\partial p}{\\partial x} = 0 \\text{ at } x=0, a \\quad \\text{and} \\quad \\frac{\\partial p}{\\partial y} = 0 \\text{ at } y=0, b $$\nSince $p(x,y,z) = \\psi(x,y) e^{\\pm ik_z z}$, these conditions apply directly to the mode shape $\\psi(x,y)$.\nWe solve the transverse eigenvalue problem by further separation of variables, $\\psi(x,y) = X(x)Y(y)$. This leads to two ordinary differential equations:\n$$ \\frac{d^{2}X}{dx^{2}} + k_{x}^{2}X = 0 \\quad \\text{and} \\quad \\frac{d^{2}Y}{dy^{2}} + k_{y}^{2}Y = 0 $$\nwhere $\\gamma^{2} = k_{x}^{2} + k_{y}^{2}$. The general solution for $X(x)$ is $A \\cos(k_x x) + B \\sin(k_x x)$. Applying the boundary conditions:\n$\\frac{dX}{dx}|_{x=0} = B k_x = 0 \\implies B=0$. So, $X(x) = A \\cos(k_x x)$.\n$\\frac{dX}{dx}|_{x=a} = -A k_x \\sin(k_x a) = 0 \\implies \\sin(k_x a) = 0$.\nThis requires $k_x a = m\\pi$ for integers $m=0, 1, 2, ...$. Thus, $k_x = \\frac{m\\pi}{a}$.\nSimilarly, for $Y(y)$, the boundary conditions yield $k_y = \\frac{n\\pi}{b}$ for integers $n=0, 1, 2, ...$.\nThe modal transverse wavenumber for the $(m,n)$ mode is therefore:\n$$ \\gamma_{mn} = \\sqrt{k_{x}^{2} + k_{y}^{2}} = \\sqrt{\\left(\\frac{m\\pi}{a}\\right)^{2} + \\left(\\frac{n\\pi}{b}\\right)^{2}} = \\pi \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} $$\nA mode can propagate only if its axial wavenumber $k_z = \\sqrt{k^2 - \\gamma_{mn}^2}$ is real, which requires $k^2 \\geq \\gamma_{mn}^2$. The transition from non-propagating (evanescent) to propagating occurs at the cutoff frequency, where $k_z=0$. This condition is $k = \\gamma_{mn}$, or $\\omega/c_0 = \\gamma_{mn}$. The cutoff angular frequency is $\\omega_{mn} = c_0 \\gamma_{mn}$. The cutoff frequency in Hertz is $f_{mn} = \\omega_{mn}/(2\\pi)$:\n$$ f_{mn} = \\frac{c_{0}\\gamma_{mn}}{2\\pi} = \\frac{c_{0}}{2\\pi} \\pi \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} = \\frac{c_{0}}{2} \\sqrt{\\left(\\frac{m}{a}\\right)^{2} + \\left(\\frac{n}{b}\\right)^{2}} $$\n\nNow, we perform the numerical evaluation for the given parameters: $a = 0.15\\,\\mathrm{m}$, $b = 0.10\\,\\mathrm{m}$, $c_{0} = 343\\,\\mathrm{m/s}$, and mode indices $m=2$, $n=1$.\n\nFirst, we calculate the transverse modal wavenumber $\\gamma_{21}$:\n$$ \\gamma_{21} = \\pi \\sqrt{\\left(\\frac{2}{0.15}\\right)^{2} + \\left(\\frac{1}{0.10}\\right)^{2}} $$\n$$ \\gamma_{21} = \\pi \\sqrt{\\left(\\frac{40}{3}\\right)^{2} + (10)^{2}} = \\pi \\sqrt{\\frac{1600}{9} + 100} = \\pi \\sqrt{\\frac{1600+900}{9}} = \\pi \\sqrt{\\frac{2500}{9}} = \\frac{50\\pi}{3} $$\nNumerically, this is:\n$$ \\gamma_{21} \\approx 52.359877... \\, \\mathrm{rad/m} $$\nRounding to four significant figures, $\\gamma_{21} = 52.36 \\, \\mathrm{rad/m}$.\n\nNext, we calculate the corresponding cutoff frequency $f_{21}$:\n$$ f_{21} = \\frac{c_{0}}{2} \\sqrt{\\left(\\frac{2}{0.15}\\right)^{2} + \\left(\\frac{1}{0.10}\\right)^{2}} = \\frac{343}{2} \\sqrt{\\frac{2500}{9}} = \\frac{343}{2} \\left(\\frac{50}{3}\\right) = \\frac{343 \\times 25}{3} = \\frac{8575}{3} $$\nNumerically, this is:\n$$ f_{21} \\approx 2858.333... \\, \\mathrm{Hz} $$\nRounding to four significant figures, $f_{21} = 2858 \\, \\mathrm{Hz}$.\n\nThe final answer is the pair $(\\gamma_{21}, f_{21})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n52.36  2858\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "We now shift from the general physics of wave propagation to the practical analysis of a common acoustic device: the Helmholtz resonator. This exercise introduces the powerful lumped-element modeling technique, which simplifies complex acoustic components into an equivalent circuit, especially at low frequencies . Through this practice, you will investigate how a resonator's performance is affected by its interaction with the sound source, providing key insights into the crucial role of acoustic impedance in system design.",
            "id": "4121359",
            "problem": "A one-dimensional ducted source drives a side-branch Helmholtz-type muffler under low-frequency, small-amplitude, lossless, linear conditions. The source at $x=0$ is not perfectly rigid; instead, its finite upstream impedance is modeled as an acoustic compliance $C_{s}$ representing an upstream plenum of volume $V_{s}$, where $C_{s} = V_{s}/(\\rho_{0} c^{2})$, with $\\rho_{0}$ the ambient density and $c$ the small-signal sound speed. The muffler consists of a neck of uniform cross-section $S$ and effective length $\\ell$ (including any end correction) connecting the source node to a downstream cavity of volume $V_{h}$ whose acoustic compliance is $C_{h} = V_{h}/(\\rho_{0} c^{2})$. The neck is modeled as an acoustic inertance $L_{n} = \\rho_{0} \\ell / S$. The downstream termination beyond the cavity is assumed anechoic so that no additional reactive contribution modifies the resonance in the frequency range of interest. Assume a lumped-element regime in which the acoustic wavelength is much larger than all characteristic geometric dimensions of the neck and cavities.\n\nStarting from the linearized one-dimensional continuity equation and the linearized momentum (Euler) equation, and using the linearized equation of state $p' = c^{2} \\rho'$, derive the low-frequency lumped constitutive relations for acoustic compliance and inertance in terms of pressure $p(t)$ and volume velocity $U(t)$. Then, applying conservation of volume velocity at each node and the constitutive relations, obtain the resonance condition for the coupled sourceâ€“muffler system. Using this, determine the analytic expression for the fractional shift in the resonance frequency due to finite $C_{s}$, defined as $(f - f_{0})/f_{0}$, where $f$ is the resonance frequency of the coupled system and $f_{0}$ is the resonance frequency in the limit $C_{s} \\to \\infty$ (rigid source). Express your final answer solely in terms of $C_{s}$ and $C_{h}$. Your final answer must be a single closed-form expression. No numerical evaluation is required, and no units should be included in the final answer.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of linear acoustics, specifically using the widely accepted lumped-element approximation for low-frequency analysis. The problem is well-posed, objective, and contains sufficient information to derive a unique analytical solution. Although the terminology \"rigid source\" is used unconventionally to describe the limit $C_{s} \\to \\infty$ (a pressure-release or zero-impedance condition, whereas a rigid wall is typically infinite impedance, $C_{s} \\to 0$), the mathematical definition provided is unambiguous. The solution will proceed by adhering strictly to the provided definitions.\n\nFirst, we derive the low-frequency lumped constitutive relations for acoustic compliance and inertance as requested. We use $p(t)$ for the acoustic pressure and $U(t)$ for the volume velocity.\n\nFor an acoustic compliance, we consider a volume $V$ and apply the linearized continuity equation in integral form, which expresses conservation of mass:\n$$\n\\frac{d}{dt} \\int_{V} \\rho' dV = - \\oint_{\\partial V} \\rho_{0} \\mathbf{u} \\cdot d\\mathbf{A}\n$$\nwhere $\\rho'$ is the acoustic density perturbation, $\\rho_{0}$ is the ambient density, and $\\mathbf{u}$ is the particle velocity vector. For a lumped volume, we assume the density perturbation is uniform throughout, $\\int_{V} \\rho' dV = \\rho' V$. The right-hand side represents the net mass flow into the volume. If $U(t)$ is the volume velocity entering the volume, the net mass influx is $\\rho_{0} U(t)$. Thus, the equation becomes:\n$$\nV \\frac{d\\rho'}{dt} = \\rho_{0} U(t)\n$$\nUsing the linearized equation of state, $p' = c^{2} \\rho'$, and differentiating with respect to time, we get $\\frac{dp'}{dt} = c^{2} \\frac{d\\rho'}{dt}$. Substituting for $\\frac{d\\rho'}{dt}$:\n$$\nV \\frac{1}{c^{2}} \\frac{dp'}{dt} = \\rho_{0} U(t)\n$$\nRearranging and defining the acoustic compliance $C = V/(\\rho_{0} c^{2})$, we obtain the constitutive relation for a compliance:\n$$\nU(t) = C \\frac{dp(t)}{dt}\n$$\nThis applies to both the source compliance $C_{s}$ and the Helmholtz cavity compliance $C_{h}$.\n\nFor an acoustic inertance, we consider a narrow tube of length $\\ell$ and cross-sectional area $S$. We use the one-dimensional linearized momentum (Euler) equation:\n$$\n\\rho_{0} \\frac{\\partial u}{\\partial t} = -\\frac{\\partial p}{\\partial x}\n$$\nWe integrate this equation along the length of the tube from $x=0$ to $x=\\ell$. Assuming the velocity $u$ is uniform along the short tube:\n$$\n\\int_{0}^{\\ell} \\rho_{0} \\frac{du}{dt} dx = - \\int_{0}^{\\ell} \\frac{\\partial p}{\\partial x} dx\n$$\n$$\n\\rho_{0} \\ell \\frac{du}{dt} = - (p(\\ell) - p(0)) = p(0) - p(\\ell) = \\Delta p(t)\n$$\nThe volume velocity is $U(t) = S u(t)$, so $u(t) = U(t)/S$. Substituting this into the equation:\n$$\n\\rho_{0} \\ell \\frac{d}{dt} \\left( \\frac{U(t)}{S} \\right) = \\Delta p(t)\n$$\nDefining the acoustic inertance $L_{n} = \\rho_{0} \\ell / S$, we obtain the constitutive relation for an inertance:\n$$\n\\Delta p(t) = L_{n} \\frac{dU(t)}{dt}\n$$\n\nNext, we model the coupled source-muffler system. The problem describes a single \"source node\" where the source compliance, the Helmholtz muffler, and the downstream termination are connected. To find the undamped resonance frequency of the system, we consider the reactive elements in the absence of any driver or dissipation (the anechoic termination is purely resistive and is thus ignored for calculating the natural frequency). The system consists of the source compliance $C_{s}$ connected in parallel with the Helmholtz resonator. The resonator itself is a series combination of the neck inertance $L_{n}$ and the cavity compliance $C_{h}$.\n\nLet $p(t)$ be the acoustic pressure at the common node. Let $U_{s}(t)$ be the volume velocity into the source compliance, and $U_{n}(t)$ be the volume velocity into the neck of the resonator. For natural oscillations, the law of conservation of volume velocity at the node requires the sum of currents leaving the node to be zero:\n$$\nU_{s}(t) + U_{n}(t) = 0\n$$\nLet $p_{h}(t)$ be the pressure inside the Helmholtz cavity. We write the constitutive relations for each element:\n1. Source compliance: $U_{s}(t) = C_{s} \\frac{dp(t)}{dt}$\n2. Neck inertance: $p(t) - p_{h}(t) = L_{n} \\frac{dU_{n}(t)}{dt}$\n3. Cavity compliance: $U_{n}(t) = C_{h} \\frac{dp_{h}(t)}{dt}$\n\nWe seek a sinusoidal solution by setting $p(t) = \\hat{p} e^{j\\omega t}$, $U(t) = \\hat{U} e^{j\\omega t}$, etc., where $\\omega = 2\\pi f$ is the angular frequency. The time derivative operator becomes multiplication by $j\\omega$. The equations become (dropping the hats for simplicity):\n1. $U_{s} = j\\omega C_{s} p$\n2. $p - p_{h} = j\\omega L_{n} U_{n}$\n3. $U_{n} = j\\omega C_{h} p_{h} \\implies p_{h} = \\frac{U_{n}}{j\\omega C_{h}}$\nThe conservation law is $U_{s} + U_{n} = 0$, or $U_{s} = -U_{n}$.\n\nSubstitute $p_{h}$ from (3) into (2):\n$$\np - \\frac{U_{n}}{j\\omega C_{h}} = j\\omega L_{n} U_{n}\n$$\n$$\np = U_{n} \\left( j\\omega L_{n} + \\frac{1}{j\\omega C_{h}} \\right)\n$$\nNow substitute $U_s$ from (1) and the conservation relation $U_n = -U_s$:\n$$\np = (-U_{s}) \\left( j\\omega L_{n} + \\frac{1}{j\\omega C_{h}} \\right) = -(j\\omega C_{s} p) \\left( j\\omega L_{n} + \\frac{1}{j\\omega C_{h}} \\right)\n$$\nFor a non-trivial solution ($p \\neq 0$), we can divide by $p$:\n$$\n1 = -j\\omega C_{s} \\left( j\\omega L_{n} + \\frac{1}{j\\omega C_{h}} \\right)\n$$\n$$\n1 = -j\\omega C_{s} \\left( j\\omega L_{n} \\right) - j\\omega C_{s} \\left( \\frac{1}{j\\omega C_{h}} \\right)\n$$\n$$\n1 = \\omega^{2} C_{s} L_{n} - \\frac{C_{s}}{C_{h}}\n$$\nThis equation is incorrect. Let's re-trace the algebra.\n$p = -(j\\omega C_{s} p) (\\frac{1-\\omega^2 L_n C_h}{j\\omega C_h})$.\nDivide by $p$ and $j\\omega$:\n$1 = - (C_s) (\\frac{1-\\omega^2 L_n C_h}{C_h})$.\n$C_h = -C_s (1-\\omega^2 L_n C_h) = -C_s + \\omega^2 C_s L_n C_h$.\n$C_s + C_h = \\omega^2 L_n C_s C_h$.\nSolving for the resonance angular frequency $\\omega$ of the coupled system:\n$$\n\\omega^{2} = \\frac{C_{s} + C_{h}}{L_{n} C_{s} C_{h}} = \\frac{1}{L_{n}} \\left( \\frac{1}{C_{h}} + \\frac{1}{C_{s}} \\right)\n$$\nThe resonance frequency $f = \\omega/(2\\pi)$ is therefore:\n$$\nf = \\frac{1}{2\\pi} \\sqrt{\\frac{1}{L_{n}} \\left( \\frac{1}{C_{h}} + \\frac{1}{C_{s}} \\right)}\n$$\nThe problem defines the reference frequency, $f_{0}$, as the resonance frequency in the limit $C_{s} \\to \\infty$. Taking this limit:\n$$\nf_{0} = \\lim_{C_{s} \\to \\infty} \\left[ \\frac{1}{2\\pi} \\sqrt{\\frac{1}{L_{n}} \\left( \\frac{1}{C_{h}} + \\frac{1}{C_{s}} \\right)} \\right]\n$$\nAs $C_{s} \\to \\infty$, the term $1/C_{s} \\to 0$. The expression simplifies to:\n$$\nf_{0} = \\frac{1}{2\\pi} \\sqrt{\\frac{1}{L_{n} C_{h}}}\n$$\nThis is the standard resonance frequency of an isolated Helmholtz resonator, which is physically correct for a source with zero acoustic impedance ($C_s \\to \\infty$).\n\nFinally, we compute the fractional shift in resonance frequency, $(f - f_{0})/f_{0}$:\n$$\n\\frac{f - f_{0}}{f_{0}} = \\frac{f}{f_{0}} - 1\n$$\nWe compute the ratio $f/f_{0}$:\n$$\n\\frac{f}{f_{0}} = \\frac{\\frac{1}{2\\pi} \\sqrt{\\frac{1}{L_{n}} \\left( \\frac{1}{C_{h}} + \\frac{1}{C_{s}} \\right)}}{\\frac{1}{2\\pi} \\sqrt{\\frac{1}{L_{n} C_{h}}}} = \\sqrt{\\frac{\\frac{1}{L_{n}} \\left( \\frac{1}{C_{h}} + \\frac{1}{C_{s}} \\right)}{\\frac{1}{L_{n} C_{h}}}}\n$$\n$$\n\\frac{f}{f_{0}} = \\sqrt{\\frac{\\frac{1}{C_{h}} + \\frac{1}{C_{s}}}{\\frac{1}{C_{h}}}} = \\sqrt{1 + \\frac{1/C_{s}}{1/C_{h}}} = \\sqrt{1 + \\frac{C_{h}}{C_{s}}}\n$$\nThe fractional shift is therefore:\n$$\n\\frac{f - f_{0}}{f_{0}} = \\sqrt{1 + \\frac{C_{h}}{C_{s}}} - 1\n$$\nThis expression depends only on $C_{s}$ and $C_{h}$ as required.",
            "answer": "$$\\boxed{\\sqrt{1 + \\frac{C_{h}}{C_{s}}} - 1}$$"
        },
        {
            "introduction": "Our final practice introduces a cornerstone of computational acoustics: the two-port network formalism. This framework provides a systematic way to model and assemble complex acoustic systems, such as modern mufflers, from individual components . By characterizing a perforated plate with a transfer matrix and converting it to other standard forms, you will develop the practical skills needed to build sophisticated simulation tools for acoustic design and analysis.",
            "id": "4121377",
            "problem": "You are asked to implement, verify, and apply parameter conversions for one-dimensional, linear acoustic two-ports that connect duct sections, and to use these conversions to analyze a perforated plate used as an in-duct element. The two-port is characterized by port variables pressure $p$ (units $\\mathrm{Pa}$) and volume velocity $U$ (units $\\mathrm{m^3/s}$). The fundamental base of this problem is the linearized, plane-wave acoustics in ducts and the network relationships that define two-port parameters.\n\nStart from the standard transfer (also called transmission) parameter representation, defined by the linear relation\n$$\n\\begin{bmatrix}\np_1 \\\\\nU_1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n\\begin{bmatrix}\np_2 \\\\\nU_2\n\\end{bmatrix},\n$$\nwhere $A$, $B$, $C$, and $D$ are complex frequency-dependent functions, and $p_1$, $U_1$, $p_2$, and $U_2$ are the complex phasor amplitudes of pressure and volume velocity at the two ports under the one-dimensional plane-wave assumption. Also define the admittance parameter representation by\n$$\n\\begin{bmatrix}\nU_1 \\\\\nU_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nY_{11}  Y_{12} \\\\\nY_{21}  Y_{22}\n\\end{bmatrix}\n\\begin{bmatrix}\np_1 \\\\\np_2\n\\end{bmatrix},\n$$\nwhere $Y_{ij}$ are complex entries of the admittance matrix with units $\\mathrm{m^3/(Pa\\cdot s)}$.\n\nYour tasks are:\n- Derive, from first principles of the above definitions, algebraic conversions between the transfer parameters $(A,B,C,D)$ and the admittance parameters $(Y_{11},Y_{12},Y_{21},Y_{22})$. Do not assume any pre-existing shortcut formulas; derive the relations by eliminating variables and solving the linear system.\n- Implement functions that convert from transfer parameters $(A,B,C,D)$ to admittance parameters $(Y_{11},Y_{12},Y_{21},Y_{22})$ and vice versa, ensuring numerical robustness when parameters are finite and non-singular.\n- Model a perforated plate inserted inline in a duct as a series acoustic impedance $Z_{\\mathrm{plate}}$ between the two ports. Use a physically justified model that includes viscous losses and inertia of the oscillatory flow through circular holes:\n  - For a circular hole of radius $a$ and plate thickness $t$, approximate the viscous (Poiseuille) resistance per hole as\n    $$\n    R_{\\mathrm{hole}} = \\frac{8\\,\\mu\\,t}{\\pi\\,a^4},\n    $$\n    where $\\mu$ is the dynamic viscosity of air, and the inertial mass per hole as\n    $$\n    M_{\\mathrm{hole}} = \\frac{\\rho_0\\,L_{\\mathrm{eff}}}{S_{\\mathrm{hole}}}, \\quad L_{\\mathrm{eff}} = t + 1.7\\,a, \\quad S_{\\mathrm{hole}} = \\pi a^2,\n    $$\n    with $\\rho_0$ the ambient air density. The per-hole impedance is\n    $$\n    Z_{\\mathrm{hole}}(\\omega) = R_{\\mathrm{hole}} + j\\,\\omega\\,M_{\\mathrm{hole}},\n    $$\n    where $\\omega$ is the angular frequency in $\\mathrm{rad/s}$ and $j$ is the imaginary unit. For $N$ identical holes in parallel, the plate impedance is\n    $$\n    Z_{\\mathrm{plate}}(\\omega) = \\frac{Z_{\\mathrm{hole}}(\\omega)}{N}.\n    $$\n- Express the perforated plate as a series element two-port with transfer matrix\n  $$\n  \\begin{bmatrix}\n  A  B \\\\\n  C  D\n  \\end{bmatrix}\n  =\n  \\begin{bmatrix}\n  1  Z_{\\mathrm{plate}} \\\\\n  0  1\n  \\end{bmatrix},\n  $$\n  and use your conversion functions to obtain the admittance parameters $(Y_{11},Y_{12},Y_{21},Y_{22})$ for the perforated plate.\n- Verify numerically the correctness of your conversion functions by performing a round-trip conversion on the perforated plate: transfer to admittance and back to transfer, and compute the maximum relative deviation across $(A,B,C,D)$.\n\nUse the following air properties and constants, which must be taken as given:\n- Ambient air density: $\\rho_0 = 1.204\\,\\mathrm{kg/m^3}$.\n- Dynamic viscosity of air: $\\mu = 1.84\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$.\n- Speed of sound (used only for context, not directly needed below): $c_0 = 343\\,\\mathrm{m/s}$.\n\nImplement your program to compute results for the following four scientifically plausible test cases, which cover varied regimes of viscous and inertial dominance:\n\n- Test case $1$: frequency $f = 500\\,\\mathrm{Hz}$, hole radius $a = 2\\times 10^{-3}\\,\\mathrm{m}$, plate thickness $t = 2\\times 10^{-3}\\,\\mathrm{m}$, number of holes $N = 100$.\n- Test case $2$: frequency $f = 2000\\,\\mathrm{Hz}$, hole radius $a = 2\\times 10^{-3}\\,\\mathrm{m}$, plate thickness $t = 8\\times 10^{-3}\\,\\mathrm{m}$, number of holes $N = 100$.\n- Test case $3$: frequency $f = 500\\,\\mathrm{Hz}$, hole radius $a = 5\\times 10^{-3}\\,\\mathrm{m}$, plate thickness $t = 2\\times 10^{-3}\\,\\mathrm{m}$, number of holes $N = 500$.\n- Test case $4$: frequency $f = 2000\\,\\mathrm{Hz}$, hole radius $a = 5\\times 10^{-4}\\,\\mathrm{m}$, plate thickness $t = 10\\times 10^{-3}\\,\\mathrm{m}$, number of holes $N = 50$.\n\nFor each test case, your program must produce three outputs:\n- The real part of $Y_{11}$ (units $\\mathrm{m^3/(Pa\\cdot s)}$).\n- The imaginary part of $Y_{11}$ (units $\\mathrm{m^3/(Pa\\cdot s)}$).\n- The maximum relative error of the round-trip conversion $(A,B,C,D)\\rightarrow (Y_{11},Y_{12},Y_{21},Y_{22})\\rightarrow (A,B,C,D)$, expressed as a decimal (unitless).\n\nFinal output format:\n- Your program should produce a single line of output containing the $12$ results (three per test case, in order for test cases $1$ through $4$) as a comma-separated list enclosed in square brackets, for example [$y_{11,r}^{(1)},y_{11,i}^{(1)},\\epsilon^{(1)},y_{11,r}^{(2)},y_{11,i}^{(2)},\\epsilon^{(2)},y_{11,r}^{(3)},y_{11,i}^{(3)},\\epsilon^{(3)},y_{11,r}^{(4)},y_{11,i}^{(4)},\\epsilon^{(4)}$], where each $y_{11,r}^{(k)}$ and $y_{11,i}^{(k)}$ is in $\\mathrm{m^3/(Pa\\cdot s)}$ and each $\\epsilon^{(k)}$ is a decimal.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in linear acoustics and two-port network theory, well-posed, and contains all necessary information for a unique solution.\n\nThe solution proceeds in three stages: first, deriving the algebraic conversions between transfer and admittance matrix representations from first principles; second, modeling the perforated plate as a series acoustic impedance and determining its transfer matrix; and third, implementing these models and conversions computationally to analyze the specified test cases and verify the implementation via a round-trip calculation.\n\n### $1$. Derivation of Two-Port Parameter Conversions\n\nThe relationship between pressure $p$ and volume velocity $U$ at the two ports of a linear acoustic element can be described by different matrix formalisms. We are given the transfer matrix and admittance matrix definitions.\n\nThe transfer matrix relation is:\n$$\n\\begin{bmatrix}\np_1 \\\\\nU_1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n\\begin{bmatrix}\np_2 \\\\\nU_2\n\\end{bmatrix}\n$$\nThis can be written as two separate linear equations:\n$$\np_1 = A p_2 + B U_2 \\quad (1)\n$$\n$$\nU_1 = C p_2 + D U_2 \\quad (2)\n$$\n\nThe admittance matrix relation is:\n$$\n\\begin{bmatrix}\nU_1 \\\\\nU_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nY_{11}  Y_{12} \\\\\nY_{21}  Y_{22}\n\\end{bmatrix}\n\\begin{bmatrix}\np_1 \\\\\np_2\n\\end{bmatrix}\n$$\nThis can also be written as two separate linear equations:\n$$\nU_1 = Y_{11} p_1 + Y_{12} p_2 \\quad (3)\n$$\n$$\nU_2 = Y_{21} p_1 + Y_{22} p_2 \\quad (4)\n$$\n\nOur objective is to find the elements of one matrix in terms of the elements of the other by algebraic manipulation.\n\n**$1.1$. Transfer Matrix to Admittance Matrix ($T \\rightarrow Y$)**\n\nTo find the admittance parameters ($Y_{11}, Y_{12}, Y_{21}, Y_{22}$), we need to express $U_1$ and $U_2$ as functions of $p_1$ and $p_2$ using equations $(1)$ and $(2)$.\n\nFrom equation $(1)$, we can solve for $U_2$, assuming $B \\neq 0$:\n$$\nB U_2 = p_1 - A p_2 \\implies U_2 = \\frac{1}{B} p_1 - \\frac{A}{B} p_2\n$$\nThis equation is in the form of equation $(4)$, $U_2 = Y_{21} p_1 + Y_{22} p_2$. By direct comparison, we find:\n$$\nY_{21} = \\frac{1}{B}\n$$\n$$\nY_{22} = -\\frac{A}{B}\n$$\nNow, we substitute the expression for $U_2$ into equation $(2)$:\n$$\nU_1 = C p_2 + D \\left( \\frac{1}{B} p_1 - \\frac{A}{B} p_2 \\right)\n$$\nRearranging the terms to group by $p_1$ and $p_2$:\n$$\nU_1 = \\frac{D}{B} p_1 + \\left( C - \\frac{AD}{B} \\right) p_2 = \\frac{D}{B} p_1 - \\frac{AD - BC}{B} p_2\n$$\nThis equation is in the form of equation $(3)$, $U_1 = Y_{11} p_1 + Y_{12} p_2$. By comparison:\n$$\nY_{11} = \\frac{D}{B}\n$$\n$$\nY_{12} = -\\frac{AD - BC}{B}\n$$\nThe term $AD - BC = \\det(T)$ is the determinant of the transfer matrix. For passive, reciprocal two-ports, this determinant is unity, i.e., $AD-BC=1$. The perforated plate model given is reciprocal.\n\n**$1.2$. Admittance Matrix to Transfer Matrix ($Y \\rightarrow T$)**\n\nTo find the transfer parameters ($A, B, C, D$), we need to express $p_1$ and $U_1$ as functions of $p_2$ and $U_2$ using equations $(3)$ and $(4)$.\n\nFrom equation $(4)$, we can solve for $p_1$, assuming $Y_{21} \\neq 0$:\n$$\nY_{21} p_1 = U_2 - Y_{22} p_2 \\implies p_1 = -\\frac{Y_{22}}{Y_{21}} p_2 + \\frac{1}{Y_{21}} U_2\n$$\nThis equation is in the form of equation $(1)$, $p_1 = A p_2 + B U_2$. By comparison:\n$$\nA = -\\frac{Y_{22}}{Y_{21}}\n$$\n$$\nB = \\frac{1}{Y_{21}}\n$$\nNow, substitute the expression for $p_1$ into equation $(3)$:\n$$\nU_1 = Y_{11} \\left( -\\frac{Y_{22}}{Y_{21}} p_2 + \\frac{1}{Y_{21}} U_2 \\right) + Y_{12} p_2\n$$\nRearranging the terms to group by $p_2$ and $U_2$:\n$$\nU_1 = \\left( Y_{12} - \\frac{Y_{11}Y_{22}}{Y_{21}} \\right) p_2 + \\frac{Y_{11}}{Y_{21}} U_2 = -\\frac{Y_{11}Y_{22} - Y_{12}Y_{21}}{Y_{21}} p_2 + \\frac{Y_{11}}{Y_{21}} U_2\n$$\nThis equation is in the form of equation $(2)$, $U_1 = C p_2 + D U_2$. The term $Y_{11}Y_{22} - Y_{12}Y_{21} = \\det(Y)$ is the determinant of the admittance matrix. By comparison:\n$$\nC = -\\frac{\\det(Y)}{Y_{21}}\n$$\n$$\nD = \\frac{Y_{11}}{Y_{21}}\n$$\nThese derived formulas allow for direct conversion between the two representations, provided the denominators ($B$ and $Y_{21}$ respectively) are non-zero.\n\n### $2$. Acoustic Model of the Perforated Plate\n\nThe perforated plate is modeled as a simple series acoustic impedance, $Z_{\\mathrm{plate}}(\\omega)$, where $\\omega = 2\\pi f$ is the angular frequency. The impedance accounts for viscous losses and inertial effects of air oscillating through the holes.\n\nThe total impedance is determined by the parallel combination of $N$ identical holes. The impedance of a single hole, $Z_{\\mathrm{hole}}$, is the sum of a resistive part, $R_{\\mathrm{hole}}$, and an inertial (mass-like) reactance, $j\\omega M_{\\mathrm{hole}}$.\n$$\nZ_{\\mathrm{hole}}(\\omega) = R_{\\mathrm{hole}} + j\\omega M_{\\mathrm{hole}}\n$$\nThe resistive term is given by the Poiseuille flow resistance for a circular tube of radius $a$ and length (plate thickness) $t$:\n$$\nR_{\\mathrm{hole}} = \\frac{8\\mu t}{\\pi a^4}\n$$\nwhere $\\mu$ is the dynamic viscosity of air. The inertial mass term includes an end correction to account for the fluid mass moving with the air just outside the hole openings. The effective length, $L_{\\mathrm{eff}}$, is the plate thickness plus this correction:\n$$\nL_{\\mathrm{eff}} = t + 1.7a\n$$\nThe mass per hole is then the total mass in this effective volume divided by the area, $S_{\\mathrm{hole}} = \\pi a^2$:\n$$\nM_{\\mathrm{hole}} = \\frac{\\rho_0 L_{\\mathrm{eff}}}{S_{\\mathrm{hole}}}\n$$\nwhere $\\rho_0$ is the ambient air density.\n\nFor $N$ identical holes in parallel, the total plate impedance is:\n$$\nZ_{\\mathrm{plate}}(\\omega) = \\frac{Z_{\\mathrm{hole}}(\\omega)}{N}\n$$\nA series element with impedance $Z$ in a duct corresponds to a two-port where the volume velocity is continuous ($U_1 = U_2$) and the pressure drops across the element ($p_1 - p_2 = Z U_1$). This yields the specific transfer matrix:\n$$\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1  Z_{\\mathrm{plate}} \\\\\n0  1\n\\end{bmatrix}\n$$\n\n### $3$. Computational Procedure and Verification\n\nThe overall algorithm for each test case is as follows:\n$1$. Given the test case parameters ($f, a, t, N$) and physical constants ($\\rho_0, \\mu$), calculate the complex acoustic impedance $Z_{\\mathrm{plate}}(\\omega)$.\n$2$. Construct the initial transfer matrix $T_{\\mathrm{orig}}$ for the plate: $A=1$, $B=Z_{\\mathrm{plate}}$, $C=0$, $D=1$. All are complex numbers, though $A, C, D$ have zero imaginary parts initially.\n$3$. Apply the derived $T \\rightarrow Y$ conversion formulas to find the admittance parameters $(Y_{11}, Y_{12}, Y_{21}, Y_{22})$. For this specific T-matrix, since $A=D=1$, $C=0$, and $AD-BC = 1$, the formulas simplify to $Y_{11} = 1/Z_{\\mathrm{plate}}$, $Y_{12} = -1/Z_{\\mathrm{plate}}$, $Y_{21} = 1/Z_{\\mathrm{plate}}$, and $Y_{22} = -1/Z_{\\mathrm{plate}}$. The required outputs, $\\mathrm{Re}(Y_{11})$ and $\\mathrm{Im}(Y_{11})$, are then extracted.\n$4$. To verify the correctness of the conversion functions, perform a round-trip conversion. Apply the $Y \\rightarrow T$ conversion to the calculated admittance matrix to obtain a new transfer matrix, $T_{\\mathrm{new}} = [A', B', C', D']$.\n$5$. In theory, $T_{\\mathrm{new}}$ should be identical to $T_{\\mathrm{orig}}$. Any difference is due to floating-point numerical precision errors. The maximum relative error, $\\epsilon$, is computed to quantify this deviation. Given that some original parameters are $0$ or $1$, a mixed absolute/relative error metric is appropriate:\n$$\n\\epsilon = \\max\\left( \\left|A' - 1\\right|, \\left|\\frac{B' - B}{B}\\right|, \\left|C' - 0\\right|, \\left|D' - 1\\right| \\right)\n$$\nThis procedure is executed for all four test cases, and the results ($\\mathrm{Re}(Y_{11})$, $\\mathrm{Im}(Y_{11})$, $\\epsilon$) for each are aggregated into a final list.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the duct acoustics problem for perforated plates.\n    This involves deriving and implementing two-port parameter conversions,\n    modeling the plate impedance, and running several test cases.\n    \"\"\"\n    \n    # Define physical constants from the problem statement.\n    RHO_0 = 1.204  # Ambient air density in kg/m^3\n    MU = 1.84e-5   # Dynamic viscosity of air in Pa.s\n\n    def _calculate_plate_impedance(f, a, t, N):\n        \"\"\"\n        Calculates the acoustic impedance of the perforated plate based on\n        the provided physical model.\n\n        Args:\n            f (float): Frequency in Hz.\n            a (float): Hole radius in m.\n            t (float): Plate thickness in m.\n            N (int): Number of holes.\n\n        Returns:\n            complex: The complex acoustic impedance Z_plate.\n        \"\"\"\n        omega = 2 * np.pi * f\n        s_hole = np.pi * a**2\n        \n        # Viscous resistance per hole\n        r_hole = (8 * MU * t) / (np.pi * a**4)\n        \n        # Inertial mass per hole with end correction\n        l_eff = t + 1.7 * a\n        m_hole = (RHO_0 * l_eff) / s_hole\n        \n        # Impedance per hole (complex)\n        z_hole = r_hole + 1j * omega * m_hole\n        \n        # Total impedance for N holes in parallel\n        z_plate = z_hole / N\n        return z_plate\n\n    def _transfer_to_admittance(A, B, C, D):\n        \"\"\"\n        Converts transfer matrix parameters (A, B, C, D) to admittance\n        matrix parameters (Y11, Y12, Y21, Y22).\n        \"\"\"\n        if np.abs(B)  1e-15: # Avoid division by zero\n            raise ValueError(\"Cannot convert to admittance matrix: parameter B is zero.\")\n        det_T = A * D - B * C\n        Y11 = D / B\n        Y12 = -det_T / B\n        Y21 = 1 / B\n        Y22 = -A / B\n        return Y11, Y12, Y21, Y22\n\n    def _admittance_to_transfer(Y11, Y12, Y21, Y22):\n        \"\"\"\n        Converts admittance matrix parameters back to transfer matrix parameters\n        for verification.\n        \"\"\"\n        if np.abs(Y21)  1e-15:  # Avoid division by zero\n            raise ValueError(\"Cannot convert to transfer matrix: parameter Y21 is zero.\")\n        det_Y = Y11 * Y22 - Y12 * Y21\n        A = -Y22 / Y21\n        B = 1 / Y21\n        C = -det_Y / Y21\n        D = Y11 / Y21\n        return A, B, C, D\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (frequency f, hole radius a, plate thickness t, number of holes N)\n        (500, 2e-3, 2e-3, 100),\n        (2000, 2e-3, 8e-3, 100),\n        (500, 5e-3, 2e-3, 500),\n        (2000, 5e-4, 10e-3, 50),\n    ]\n\n    results = []\n    for f, a, t, N in test_cases:\n        # 1. Model plate and get its original transfer matrix T_orig\n        z_plate = _calculate_plate_impedance(f, a, t, N)\n        A_orig, B_orig, C_orig, D_orig = 1.0, z_plate, 0.0, 1.0\n\n        # 2. Convert T_orig to admittance matrix Y\n        Y11, Y12, Y21, Y22 = _transfer_to_admittance(A_orig, B_orig, C_orig, D_orig)\n        \n        # 3. Store required outputs: Re(Y11) and Im(Y11)\n        results.append(Y11.real)\n        results.append(Y11.imag)\n\n        # 4. Perform round-trip conversion: Y back to T_new for verification\n        A_new, B_new, C_new, D_new = _admittance_to_transfer(Y11, Y12, Y21, Y22)\n\n        # 5. Compute the maximum deviation to quantify numerical error\n        # Use absolute error for components that are originally 0 or 1.\n        # Use relative error for B, which is complex and non-zero.\n        err_A = np.abs(A_new - A_orig)\n        err_B = np.abs((B_new - B_orig) / B_orig) if np.abs(B_orig)  0 else np.abs(B_new)\n        err_C = np.abs(C_new - C_orig)\n        err_D = np.abs(D_new - D_orig)\n        \n        max_error = np.max([err_A, err_B, err_C, err_D])\n        results.append(max_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}