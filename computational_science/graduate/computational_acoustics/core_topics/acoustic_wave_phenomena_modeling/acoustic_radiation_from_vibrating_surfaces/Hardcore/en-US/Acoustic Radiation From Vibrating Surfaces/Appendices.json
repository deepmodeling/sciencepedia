{
    "hands_on_practices": [
        {
            "introduction": "Before we can analyze the sound radiated from a vibrating surface, we must first establish the correct mathematical language to describe a wave that travels away from its source. The Helmholtz equation allows for two types of spherical wave solutions, one traveling outwards and one inwards. This exercise challenges you to use the fundamental physical principle of energy conservation—specifically, that a source must radiate energy outwards—to determine which mathematical form correctly represents a physically radiating wave for a given time convention. Mastering this foundational concept is the first step in correctly modeling any acoustic radiation phenomenon .",
            "id": "4113997",
            "problem": "A time-harmonic acoustic field radiated by a compact, spherically symmetric vibrating surface into an unbounded quiescent fluid of equilibrium density $\\,\\rho_{0}\\,$ and sound speed $\\,c\\,$ satisfies the scalar Helmholtz equation $\\,\\nabla^{2} p + k^{2} p = 0\\,$ in the exterior domain, with time dependence $\\,e^{-i \\omega t}\\,$ and wavenumber $\\,k = \\omega/c  0\\,$. In the far field, spherical solutions behave as $\\,p(r) \\sim \\dfrac{A_{\\pm}\\,e^{\\pm i k r}}{r}\\,$ for large $\\,r\\,$, where $\\,A_{\\pm}\\,$ are complex amplitudes and $\\,r\\,$ is the radial coordinate.\n\nUsing only first principles appropriate to linear acoustics (for example, the linearized momentum balance and the definition of the time-averaged acoustic intensity), determine which sign in $\\,e^{\\pm i k r}/r\\,$ corresponds to physically radiating outgoing waves for the chosen time convention $\\,e^{-i \\omega t}\\,$. Your reasoning must make explicit use of the direction of the far-field energy flux or an equivalent radiation condition at infinity, and it must be consistent with $\\,k=\\omega/c0\\,$.\n\nWhich option is correct?\n\nA. For $\\,e^{-i \\omega t}\\,$, the physically outgoing wave is $\\,e^{+ i k r}/r\\,$ (and $\\,e^{- i k r}/r\\,$ is incoming).\n\nB. For $\\,e^{-i \\omega t}\\,$, the physically outgoing wave is $\\,e^{- i k r}/r\\,$ (and $\\,e^{+ i k r}/r\\,$ is incoming).\n\nC. Both $\\,e^{+ i k r}/r\\,$ and $\\,e^{- i k r}/r\\,$ describe outgoing radiation in the far field; the sign choice is arbitrary if $\\,\\omega0\\,$.\n\nD. The sign cannot be determined without additional material parameters; if $\\,k0\\,$ then $\\,e^{- i k r}/r\\,$ is outgoing, whereas if $\\,k0\\,$ then $\\,e^{+ i k r}/r\\,$ is outgoing.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Governing Equation:** The time-harmonic acoustic pressure field, $p$, satisfies the scalar Helmholtz equation, $\\nabla^{2} p + k^{2} p = 0$.\n- **Source/Domain:** The field is radiated by a compact, spherically symmetric vibrating surface into an unbounded quiescent fluid in the exterior domain.\n- **Fluid Properties:** The fluid has equilibrium density $\\rho_{0}$ and sound speed $c$.\n- **Time Convention:** The time dependence is $e^{-i \\omega t}$.\n- **Wavenumber:** The wavenumber is $k = \\omega/c  0$.\n- **Far-field Behavior:** As radial distance $r \\to \\infty$, the pressure behaves as $p(r) \\sim \\dfrac{A_{\\pm}\\,e^{\\pm i k r}}{r}$, where $A_{\\pm}$ are complex amplitudes.\n- **Task:** Determine which sign in the exponential, $\\pm$, corresponds to physically radiating outgoing waves.\n- **Methodological Constraint:** The determination must use first principles, explicitly considering the direction of the far-field energy flux (time-averaged acoustic intensity) or an equivalent radiation condition, and must be consistent with the given time convention and $k0$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is fundamentally sound. It describes a canonical problem in physical acoustics: determining the form of an outgoing spherical wave. The Helmholtz equation, the assumed time dependence, the far-field asymptotic form, and the concepts of acoustic intensity and radiation conditions are all standard and well-established principles in wave theory and acoustics.\n- **Well-Posedness:** The problem is well-posed. It provides a specific time convention ($e^{-i \\omega t}$) and a physical criterion (outgoing energy flux), which together uniquely determine the correct mathematical form of the outgoing wave.\n- **Objectivity:** The problem is stated in precise, objective, and quantitative terms. There are no subjective or ambiguous statements.\n- **Completeness and Consistency:** All necessary information is provided. The time convention, the governing equation, the physical properties of the medium, and the mathematical form of the potential solutions are given. There are no internal contradictions. For example, the condition $k=\\omega/c  0$ is consistent with standard physical assumptions where frequency $\\omega$ and sound speed $c$ are positive.\n\n**Step 3: Verdict and Action**\n- **Verdict:** The problem is valid, scientifically sound, and well-posed.\n- **Action:** Proceed with the derivation of the solution.\n\n**Derivation**\n\nThe physical requirement for a radiating wave created by a source is that the net flow of energy in the far field must be directed away from the source. The quantity that describes the rate and direction of energy flow per unit area is the acoustic intensity. For a time-harmonic field, we consider the time-averaged acoustic intensity, $\\langle \\mathbf{I} \\rangle$.\n\n1.  **Relation between Pressure and Velocity:** The linearized momentum equation for a fluid is Euler's equation:\n    $$ \\rho_0 \\frac{\\partial \\mathbf{v}(\\mathbf{x}, t)}{\\partial t} = -\\nabla P(\\mathbf{x}, t) $$\n    where $P(\\mathbf{x}, t)$ is the instantaneous acoustic pressure and $\\mathbf{v}(\\mathbf{x}, t)$ is the instantaneous fluid particle velocity. The problem specifies a time dependency of $e^{-i \\omega t}$. The physical quantities are the real parts of their complex phasor representations:\n    $$ P(\\mathbf{x}, t) = \\text{Re}[p(\\mathbf{x}) e^{-i \\omega t}] $$\n    $$ \\mathbf{v}(\\mathbf{x}, t) = \\text{Re}[\\mathbf{u}(\\mathbf{x}) e^{-i \\omega t}] $$\n    Substituting these into the momentum equation gives:\n    $$ \\text{Re}[\\rho_0 (-i \\omega) \\mathbf{u}(\\mathbf{x}) e^{-i \\omega t}] = \\text{Re}[-\\nabla p(\\mathbf{x}) e^{-i \\omega t}] $$\n    This implies the relationship between the complex amplitudes (phasors) $p$ and $\\mathbf{u}$:\n    $$ -i \\omega \\rho_0 \\mathbf{u} = -\\nabla p $$\n    $$ \\mathbf{u} = \\frac{1}{i \\omega \\rho_0} \\nabla p $$\n\n2.  **Time-Averaged Acoustic Intensity:** The instantaneous intensity is $\\mathbf{I}(t) = P(t) \\mathbf{v}(t)$. The time average over one period $T = 2\\pi/\\omega$ is given by the standard formula for the product of two harmonically varying quantities:\n    $$ \\langle \\mathbf{I} \\rangle = \\frac{1}{2} \\text{Re}[p \\mathbf{u}^*] $$\n    where $\\mathbf{u}^*$ is the complex conjugate of $\\mathbf{u}$.\n\n3.  **Far-Field Analysis:** The problem states that in the far field, the pressure behaves as $p(r) \\sim \\dfrac{A_{\\pm} e^{\\pm i k r}}{r}$. Since the radiation is spherically symmetric, we are interested in the radial component of the intensity. We first need the radial component of the velocity, which requires the radial component of the pressure gradient. In spherical coordinates, for a function that depends only on $r$, $\\nabla p = \\hat{\\mathbf{r}} \\frac{dp}{dr}$.\n    $$ \\frac{dp}{dr} = \\frac{d}{dr} \\left( \\frac{A_{\\pm} e^{\\pm i k r}}{r} \\right) = A_{\\pm} \\left( \\frac{\\pm i k e^{\\pm i k r}}{r} - \\frac{e^{\\pm i k r}}{r^2} \\right) = \\left( \\pm i k - \\frac{1}{r} \\right) \\frac{A_{\\pm} e^{\\pm i k r}}{r} = \\left( \\pm i k - \\frac{1}{r} \\right) p(r) $$\n    In the far field, as $r \\to \\infty$, the term $1/r$ becomes negligible compared to the constant $k$. Thus, we have the asymptotic relationship:\n    $$ \\frac{dp}{dr} \\sim (\\pm i k) p(r) $$\n\n4.  **Far-Field Velocity and Intensity:** Substituting this into the expression for the velocity phasor $\\mathbf{u}$:\n    $$ \\mathbf{u} \\sim \\hat{\\mathbf{r}} \\frac{1}{i \\omega \\rho_0} (\\pm i k) p = \\hat{\\mathbf{r}} \\frac{\\pm k}{\\omega \\rho_0} p $$\n    Using the given relation $k = \\omega/c$, this simplifies to:\n    $$ \\mathbf{u} \\sim \\hat{\\mathbf{r}} \\frac{\\pm (\\omega/c)}{\\omega \\rho_0} p = \\hat{\\mathbf{r}} \\frac{\\pm 1}{\\rho_0 c} p $$\n    Now we can calculate the time-averaged radial intensity $\\langle I_r \\rangle$:\n    $$ \\langle I_r \\rangle = \\frac{1}{2} \\text{Re}[p u_r^*] \\sim \\frac{1}{2} \\text{Re}\\left[p \\left(\\frac{\\pm 1}{\\rho_0 c} p\\right)^*\\right] $$\n    Since $\\rho_0$ and $c$ are real, positive physical constants:\n    $$ \\langle I_r \\rangle \\sim \\frac{1}{2} \\text{Re}\\left[p \\frac{\\pm 1}{\\rho_0 c} p^*\\right] = \\frac{\\pm 1}{2 \\rho_0 c} \\text{Re}[p p^*] $$\n    For any complex number $z$, $z z^* = |z|^2$, which is real and non-negative. Therefore, $p p^* = |p|^2$.\n    $$ \\langle I_r \\rangle \\sim \\frac{\\pm 1}{2 \\rho_0 c} |p|^2 $$\n\n5.  **Physical Condition for Outgoing Waves:** For an outgoing wave, the energy must flow away from the source at the origin. This means the radial intensity must be positive, $\\langle I_r \\rangle  0$. Since $|p|^2$, $2$, $\\rho_0$, and $c$ are all positive, the sign of $\\langle I_r \\rangle$ is determined by the $\\pm$ symbol. To have $\\langle I_r \\rangle  0$, we must choose the `+' sign.\n    This `+' sign traces back to the pressure form $p \\sim \\dfrac{A_+ e^{+ikr}}{r}$.\n\nAs a secondary check, we can examine the phase propagation. The full complex wave is proportional to $e^{\\pm ikr} e^{-i\\omega t}$.\n- For the `+' sign: $e^{+ikr} e^{-i\\omega t} = e^{i(kr - \\omega t)}$. A surface of constant phase is defined by $kr - \\omega t = \\text{const}$. Differentiating with respect to time gives $k \\frac{dr}{dt} - \\omega = 0$, so the phase velocity is $\\frac{dr}{dt} = \\frac{\\omega}{k} = c$. Since $c  0$, the wave propagates in the direction of increasing $r$ (outgoing).\n- For the `-' sign: $e^{-ikr} e^{-i\\omega t} = e^{-i(kr + \\omega t)}$. A surface of constant phase is defined by $kr + \\omega t = \\text{const}$. Differentiating gives $k \\frac{dr}{dt} + \\omega = 0$, so the phase velocity is $\\frac{dr}{dt} = -\\frac{\\omega}{k} = -c$. The wave propagates in the direction of decreasing $r$ (incoming).\n\nBoth methods confirm that for the time convention $e^{-i \\omega t}$, the term $e^{+ikr}/r$ represents a physically radiating outgoing wave.\n\n**Option-by-Option Analysis**\n\n**A. For $\\,e^{-i \\omega t}\\,$, the physically outgoing wave is $\\,e^{+ i k r}/r\\,$ (and $\\,e^{- i k r}/r\\,$ is incoming).**\nThis statement is consistent with our derivation. The requirement of an outward energy flux (positive time-averaged intensity) for the given time convention $e^{-i\\omega t}$ and $k0$ uniquely selects the form $e^{+ikr}/r$ for the outgoing wave. The form $e^{-ikr}/r$ yields an inward energy flux and represents an incoming wave.\n**Verdict: Correct.**\n\n**B. For $\\,e^{-i \\omega t}\\,$, the physically outgoing wave is $\\,e^{- i k r}/r\\,$ (and $\\,e^{+ i k r}/r\\,$ is incoming).**\nThis statement is the opposite of the derived result. It would be correct for the alternative time convention $e^{+i\\omega t}$, but the problem explicitly specifies $e^{-i \\omega t}$.\n**Verdict: Incorrect.**\n\n**C. Both $\\,e^{+ i k r}/r\\,$ and $\\,e^{- i k r}/r\\,$ describe outgoing radiation in the far field; the sign choice is arbitrary if $\\,\\omega0\\,$.**\nThis statement is physically incorrect. The sign choice is not arbitrary; it is determined by the physics of energy propagation. One sign corresponds to outgoing energy flux, and the other to incoming energy flux. A source of radiation must produce a net outflow of energy.\n**Verdict: Incorrect.**\n\n**D. The sign cannot be determined without additional material parameters; if $\\,k0\\,$ then $\\,e^{- i k r}/r\\,$ is outgoing, whereas if $\\,k0\\,$ then $\\,e^{+ i k r}/r\\,$ is outgoing.**\nThe first clause is false; the sign is determined by the time convention and the direction of energy flow, using the given parameters. The first part of the second clause, \"if $k0$ then $e^{-ikr}/r$ is outgoing,\" is false for the given time convention, as shown by the derivation. The case $k0$ is excluded by the problem statement $k=\\omega/c  0$. Therefore, this option is fundamentally flawed.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once we can mathematically describe a radiating wave, a crucial engineering question is: how much energy does it carry? This practice guides you through the process of quantifying acoustic energy flow. You will start by deriving the expression for the time-averaged acoustic intensity, $\\langle \\mathbf{I} \\rangle$, from first principles, which represents the net flow of energy per unit area. You will then apply this concept to the canonical problem of a baffled circular piston, integrating the far-field intensity to calculate the total radiated acoustic power, a key performance metric for any sound source .",
            "id": "4114020",
            "problem": "An inviscid, compressible fluid of mass density $\\rho_{0}$ and sound speed $c$ supports small-amplitude, time-harmonic acoustic fields with angular frequency $\\omega$. Let the acoustic pressure and particle velocity fields be represented by their real-valued instantaneous forms $p(\\mathbf{x},t)$ and $\\mathbf{v}(\\mathbf{x},t)$, respectively, and by their complex phasors $p(\\mathbf{x})$ and $\\mathbf{v}(\\mathbf{x})$ under the convention $p(\\mathbf{x},t) = \\Re\\{p(\\mathbf{x})\\exp(-i \\omega t)\\}$ and $\\mathbf{v}(\\mathbf{x},t) = \\Re\\{\\mathbf{v}(\\mathbf{x})\\exp(-i \\omega t)\\}$.\n\n1) Starting from the linear acoustic momentum and continuity equations in the time domain and the definition of the instantaneous acoustic intensity $\\mathbf{I}(t) = p(\\mathbf{x},t)\\,\\mathbf{v}(\\mathbf{x},t)$, derive from first principles an expression for the time-averaged acoustic intensity vector $\\langle \\mathbf{I} \\rangle$ in terms of the complex phasors $p(\\mathbf{x})$ and $\\mathbf{v}(\\mathbf{x})$. Express your result solely in terms of $p(\\mathbf{x})$ and $\\mathbf{v}(\\mathbf{x})$ and their complex conjugates.\n\n2) A rigid, infinite planar baffle occupies the plane $z=0$. A circular piston of radius $a$ embedded in the baffle, centered at the origin, vibrates with spatially uniform normal velocity phasor $V_{0}$ in the $+z$ direction, i.e., $\\mathbf{v}(\\mathbf{x}) \\cdot \\hat{\\mathbf{z}} = V_{0}$ for $\\sqrt{x^{2}+y^{2}} \\le a$ and $z=0$, and zero normal velocity elsewhere on the baffle. The fluid occupies the half-space $z0$. Using the Kirchhoff–Helmholtz representation with the free-space Green’s function for the Helmholtz equation, derive the time-averaged total radiated acoustic power into the half-space $z0$ by integrating the outward normal component of the time-averaged intensity over a control surface in the acoustic far field. Your derivation must begin from the fundamental field equations and the result from part (1), and it must not invoke any small- or large-argument approximations in $k a$, where $k = \\omega/c$ is the acoustic wavenumber. Express your final closed-form answer in terms of $\\rho_{0}$, $c$, $a$, $k$, $V_{0}$, and the Bessel function of the first kind $J_{1}(\\cdot)$.\n\nExpress the final total radiated power in Watts. The final answer must be a single closed-form analytic expression. No numerical evaluation is required.",
            "solution": "The analysis of this problem is performed in two parts as requested. Part (1) requires the derivation of the time-averaged acoustic intensity from first principles. Part (2) applies this result to compute the total acoustic power radiated by a vibrating circular piston in an infinite baffle.\n\n### Part 1: Derivation of Time-Averaged Acoustic Intensity\n\nThe problem is situated in the context of linear acoustics for an inviscid, compressible fluid. The governing equations are the linearized continuity and momentum equations.\nThe continuity equation is:\n$$ \\frac{\\partial \\rho'(\\mathbf{x},t)}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{v}(\\mathbf{x},t) = 0 $$\nwhere $\\rho'$ is the acoustic density perturbation. The momentum equation is:\n$$ \\rho_0 \\frac{\\partial \\mathbf{v}(\\mathbf{x},t)}{\\partial t} = -\\nabla p(\\mathbf{x},t) $$\nThese equations establish the physical relationship between the acoustic pressure $p(\\mathbf{x},t)$ and particle velocity $\\mathbf{v}(\\mathbf{x},t)$. The instantaneous acoustic intensity vector $\\mathbf{I}(\\mathbf{x},t)$ is defined as the rate of energy flow per unit area and is given by the product of the instantaneous pressure and particle velocity:\n$$ \\mathbf{I}(\\mathbf{x},t) = p(\\mathbf{x},t) \\mathbf{v}(\\mathbf{x},t) $$\nThe problem considers time-harmonic fields with angular frequency $\\omega$. The real-valued instantaneous fields are related to their complex-valued phasors, $p(\\mathbf{x})$ and $\\mathbf{v}(\\mathbf{x})$, by the convention:\n$$ p(\\mathbf{x},t) = \\Re\\{p(\\mathbf{x}) \\exp(-i \\omega t)\\} $$\n$$ \\mathbf{v}(\\mathbf{x},t) = \\Re\\{\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t)\\} $$\nwhere $\\Re\\{Z\\}$ denotes the real part of a complex number $Z$.\n\nTo find the time-averaged acoustic intensity $\\langle \\mathbf{I} \\rangle$, we average $\\mathbf{I}(\\mathbf{x},t)$ over one period of oscillation, $T = 2\\pi/\\omega$.\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{T} \\int_0^T \\mathbf{I}(\\mathbf{x},t) dt = \\frac{1}{T} \\int_0^T p(\\mathbf{x},t) \\mathbf{v}(\\mathbf{x},t) dt $$\nWe express the real-valued fields in terms of their complex phasors and their complex conjugates, denoted by a superscript asterisk ($*$). For any complex quantity $Z$, its real part is $\\Re\\{Z\\} = \\frac{1}{2}(Z + Z^*)$.\nApplying this to the pressure and velocity phasors:\n$$ p(\\mathbf{x},t) = \\frac{1}{2} [p(\\mathbf{x}) \\exp(-i \\omega t) + p^*(\\mathbf{x}) \\exp(i \\omega t)] $$\n$$ \\mathbf{v}(\\mathbf{x},t) = \\frac{1}{2} [\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t) + \\mathbf{v}^*(\\mathbf{x}) \\exp(i \\omega t)] $$\nSubstituting these expressions into the definition of instantaneous intensity:\n$$ \\mathbf{I}(\\mathbf{x},t) = \\frac{1}{4} [p(\\mathbf{x}) \\exp(-i \\omega t) + p^*(\\mathbf{x}) \\exp(i \\omega t)] [\\mathbf{v}(\\mathbf{x}) \\exp(-i \\omega t) + \\mathbf{v}^*(\\mathbf{x}) \\exp(i \\omega t)] $$\nExpanding the product gives four terms:\n$$ \\mathbf{I}(\\mathbf{x},t) = \\frac{1}{4} [p(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) \\exp(-2i \\omega t) + p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) \\exp(2i \\omega t)] $$\nNow, we perform the time average over one period $T$. The time-dependent terms involve integrals of complex exponentials:\n$$ \\frac{1}{T} \\int_0^T \\exp(\\pm 2i \\omega t) dt = \\frac{1}{T} \\left[ \\frac{\\exp(\\pm 2i \\omega t)}{\\pm 2i \\omega} \\right]_0^T = \\frac{1}{T} \\frac{\\exp(\\pm 2i \\omega T) - 1}{\\pm 2i \\omega} $$\nSince $T=2\\pi/\\omega$, we have $\\exp(\\pm 2i \\omega T) = \\exp(\\pm i 4\\pi) = 1$. Thus, the integrals of the time-dependent terms are zero. The remaining two terms are time-independent, so their average is simply their value.\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{4} [p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x})] $$\nThis expression can also be written using the real part operator. Since $p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x}) = (p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}))^*$, the sum in the brackets is a complex number plus its conjugate, which equals twice its real part.\n$$ \\langle \\mathbf{I}(\\mathbf{x}) \\rangle = \\frac{1}{4} [2\\Re\\{p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x})\\}] = \\frac{1}{2} \\Re\\{p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x})\\} $$\nThe problem asks for the result solely in terms of the phasors and their conjugates, for which the form $\\frac{1}{4}[p(\\mathbf{x}) \\mathbf{v}^*(\\mathbf{x}) + p^*(\\mathbf{x}) \\mathbf{v}(\\mathbf{x})]$ is the more explicit representation. However, the form using the real part operator is standard, and we will use it in the subsequent derivation in Part 2.\n\n### Part 2: Total Radiated Power from a Piston\n\nThe total time-averaged radiated acoustic power, $\\Pi_{rad}$, is found by integrating the normal component of the time-averaged intensity vector, $\\langle\\mathbf{I}\\rangle$, over a closed surface $S$ enclosing the source. We choose $S$ to be a hemisphere of very large radius $R$ in the far field, covering the half-space $z0$, plus the plane $z=0$. Since the velocity on the baffle is zero for $ra$ and the pressure contribution from the hemisphere at $z=0$ can be neglected, we only need to consider the hemisphere at infinity.\n$$ \\Pi_{rad} = \\iint_S \\langle \\mathbf{I} \\rangle \\cdot d\\mathbf{S} $$\nIn the far field, the acoustic field behaves locally as an outgoing spherical wave. The particle velocity is radial and in phase with the pressure (in terms of spatial dependence, but not necessarily in terms of complex phase), related by the characteristic impedance of the medium, $Z_0 = \\rho_0 c$.\n$$ \\mathbf{v}(\\mathbf{x}) \\approx \\frac{p(\\mathbf{x})}{\\rho_0 c} \\hat{\\mathbf{r}} $$\nwhere $\\hat{\\mathbf{r}}$ is the unit vector in the radial direction. The time-averaged intensity is then radially directed:\n$$ \\langle \\mathbf{I} \\rangle = \\frac{1}{2} \\Re\\left\\{p(\\mathbf{x}) \\left(\\frac{p(\\mathbf{x})}{\\rho_0 c} \\hat{\\mathbf{r}}\\right)^*\\right\\} = \\frac{1}{2 \\rho_0 c} \\Re\\{|p(\\mathbf{x})|^2 \\hat{\\mathbf{r}}\\} = \\frac{|p(\\mathbf{x})|^2}{2 \\rho_0 c} \\hat{\\mathbf{r}} $$\nTo find the power, we need the far-field pressure $p(\\mathbf{x})$. For a planar source in an infinite baffle ($z=0$), the pressure in the half-space $z0$ is given by the Rayleigh integral:\n$$ p(\\mathbf{x}) = \\frac{i\\omega\\rho_0}{2\\pi} \\iint_{S_{source}} v_n(\\mathbf{x}') \\frac{\\exp(ik|\\mathbf{x}-\\mathbf{x}'|)}{|\\mathbf{x}-\\mathbf{x}'|} dS' $$\nHere, $v_n(\\mathbf{x}') = V_0$ on the piston surface (a disk of radius $a$) and $0$ elsewhere. Let the field point $\\mathbf{x}$ be at $(R, \\theta, \\phi)$ in spherical coordinates and the source point $\\mathbf{x}'$ be at $(r', \\phi', 0)$ in cylindrical coordinates. In the far field ($R \\gg a$), we use the approximations:\n$|\\mathbf{x}-\\mathbf{x}'| \\approx R$ in the denominator (amplitude).\n$|\\mathbf{x}-\\mathbf{x}'| \\approx R - \\hat{\\mathbf{r}} \\cdot \\mathbf{x}' = R - r'\\sin\\theta\\cos(\\phi-\\phi')$ in the exponent (phase).\nThe pressure integral becomes:\n$$ p(R,\\theta,\\phi) \\approx \\frac{i\\omega\\rho_0 V_0}{2\\pi} \\frac{\\exp(ikR)}{R} \\int_0^a \\int_0^{2\\pi} \\exp(-ikr'\\sin\\theta\\cos(\\phi-\\phi')) r' d\\phi' dr' $$\nThe integral over $\\phi'$ can be evaluated using the integral representation of the Bessel function of the first kind of order zero, $J_0(Z) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\exp(iZ\\cos\\psi)d\\psi$. This gives:\n$$ \\int_0^{2\\pi} \\exp(-ikr'\\sin\\theta\\cos(\\phi-\\phi')) d\\phi' = 2\\pi J_0(kr'\\sin\\theta) $$\nThe pressure is then axially symmetric (independent of $\\phi$):\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 \\exp(ikR)}{R} \\int_0^a J_0(kr'\\sin\\theta) r' dr' $$\nTo evaluate the remaining integral, we use the identity $\\int u J_0(u) du = u J_1(u)$. Let $b=k\\sin\\theta$.\n$$ \\int_0^a r' J_0(br') dr' = \\frac{1}{b^2} \\int_0^{ba} u J_0(u) du = \\frac{1}{b^2} [u J_1(u)]_0^{ba} = \\frac{ba J_1(ba)}{b^2} = \\frac{a}{b} J_1(ba) $$\nSubstituting $b = k\\sin\\theta$, the integral is $\\frac{a}{k\\sin\\theta}J_1(ka\\sin\\theta)$. The far-field pressure is:\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 \\exp(ikR)}{R} \\frac{a}{k\\sin\\theta} J_1(ka\\sin\\theta) $$\nIt is conventional to write this in terms of the piston area $A = \\pi a^2$ and a directivity function $D(\\theta)$:\n$$ p(R,\\theta) \\approx \\frac{i\\omega\\rho_0 V_0 (\\pi a^2) \\exp(ikR)}{2\\pi R} \\left[ \\frac{2 J_1(ka\\sin\\theta)}{ka\\sin\\theta} \\right] $$\nThe magnitude squared of the pressure is:\n$$ |p(R,\\theta)|^2 = \\left( \\frac{\\omega\\rho_0 V_0 a}{R k\\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) = \\left( \\frac{\\rho_0 c V_0 a}{R \\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) $$\nwhere we used $k=\\omega/c$.\nThe total radiated power is obtained by integrating the intensity over the far-field hemisphere ($0 \\le \\theta \\le \\pi/2$, $0 \\le \\phi \\le 2\\pi$). The surface element is $d\\mathbf{S} = \\hat{\\mathbf{r}} R^2 \\sin\\theta d\\theta d\\phi$.\n$$ \\Pi_{rad} = \\int_0^{2\\pi} \\int_0^{\\pi/2} \\frac{|p(R,\\theta)|^2}{2\\rho_0 c} (R^2 \\sin\\theta) d\\theta d\\phi $$\nSince the integrand is independent of $\\phi$, the integration over $\\phi$ yields $2\\pi$. The $R^2$ terms cancel.\n$$ \\Pi_{rad} = \\frac{2\\pi}{2\\rho_0 c} \\int_0^{\\pi/2} \\left( \\frac{\\rho_0 c V_0 a}{\\sin\\theta} \\right)^2 J_1^2(ka\\sin\\theta) \\sin\\theta d\\theta $$\n$$ \\Pi_{rad} = \\frac{\\pi (\\rho_0 c V_0 a)^2}{\\rho_0 c} \\int_0^{\\pi/2} \\frac{J_1^2(ka\\sin\\theta)}{\\sin^2\\theta} \\sin\\theta d\\theta $$\n$$ \\Pi_{rad} = \\pi \\rho_0 c V_0^2 a^2 \\int_0^{\\pi/2} \\frac{J_1^2(ka\\sin\\theta)}{\\sin\\theta} d\\theta $$\nThe integral is a standard result from the theory of Bessel functions. For $x0$, the identity is:\n$$ \\int_0^{\\pi/2} \\frac{J_1^2(x\\sin\\theta)}{\\sin\\theta} d\\theta = \\frac{1}{2} \\left[ 1 - \\frac{J_1(2x)}{x} \\right] $$\nLetting $x = ka$, and assuming $V_0$ is a real-valued phasor magnitude, i.e., $|V_0|^2=V_0^2$, we substitute this identity into the expression for power:\n$$ \\Pi_{rad} = \\pi \\rho_0 c V_0^2 a^2 \\left( \\frac{1}{2} \\left[ 1 - \\frac{J_1(2ka)}{ka} \\right] \\right) $$\nThis is the final closed-form expression for the total radiated power, which has units of Watts in the SI system.\n\nThe result can also be expressed in terms of the radiation resistance $R_m$ of the piston, where $\\Pi_{rad} = \\frac{1}{2}R_m V_0^2$. Comparing expressions gives the well-known formula for the radiation resistance: $R_m = \\rho_0 c (\\pi a^2) \\left[ 1 - \\frac{J_1(2ka)}{ka} \\right]$. The derivation presented here obtains this result from first principles by integrating the far-field intensity, as required.",
            "answer": "$$ \\boxed{ \\frac{\\pi \\rho_0 c a^2 V_0^2}{2} \\left( 1 - \\frac{J_1(2ka)}{ka} \\right) } $$"
        },
        {
            "introduction": "While analytical solutions are invaluable, most real-world engineering problems require computational models like the Boundary Element Method (BEM). A critical task in computational acoustics is verifying that these numerical models are implemented correctly. This hands-on programming exercise demonstrates how a profound physical principle—reciprocity—can be transformed into a practical and elegant consistency check for a BEM simulation. By implementing and comparing a \"forward\" transfer function with its \"swapped\" counterpart, you will gain direct experience in using fundamental physics to validate the integrity of a computational tool .",
            "id": "4114007",
            "problem": "Consider a homogeneous, lossless, reciprocal acoustic medium of constant mass density $\\rho_0$ and sound speed $c$. Let $\\omega$ denote the angular frequency, $k$ the wavenumber defined by $k = \\omega / c$, and let $\\mathbf{r} \\in \\mathbb{R}^3$ denote a field point. The acoustic pressure $p(\\mathbf{r})$ in the exterior region satisfies the Helmholtz equation and can be represented by a single-layer potential over a vibrating boundary surface $\\mathcal{S}$ endowed with normal velocity $u_n(\\mathbf{s})$, where $\\mathbf{s} \\in \\mathcal{S}$. The free-space Green's function for the Helmholtz operator is the fundamental solution that satisfies reciprocity, namely $G(\\mathbf{r},\\mathbf{r}') = G(\\mathbf{r}',\\mathbf{r})$ for all distinct $\\mathbf{r},\\mathbf{r}'$.\n\nIn a Boundary Element Method (BEM) collocation framework, the surface $\\mathcal{S}$ is discretized into a finite set of boundary elements with centroids acting as collocation points. The field is sampled at off-surface test points. A reciprocity-based consistency check for such a discretization can be formulated by swapping the roles of a collocation point and a test point and comparing the two transfer functions that map a unit normal velocity amplitude on a chosen boundary element to the resulting pressure at the chosen test point, and vice versa, interpreted as the pressure at the chosen collocation point due to an equivalent point source placed at the test point with strength chosen to preserve the physical conjugate pairing induced by the single-layer operator.\n\nStarting from fundamental laws and core definitions, namely linear acoustics in a reciprocal medium, the Helmholtz equation, and the Green's function symmetry, derive a discrete transfer function evaluation that enables the following test. Let the vibrating surface be a rectangular, planar baffled plate in the plane $z = 0$ with its center at the origin, whose normal is aligned with the $+z$ axis. Consider a single rectangular boundary element (a patch) centered at the origin with width $W$ and height $H$, such that its area is $A = W H$. Let a field (test) point be located at $\\mathbf{r}_f = (x_f,y_f,z_f)$ with $z_f  0$, and let the collocation point of the boundary element be its centroid $\\mathbf{r}_c = (0,0,0)$. Assume a uniform normal velocity over the patch of magnitude $u_0$ expressed in $\\mathrm{m/s}$.\n\nDefine the following two complex-valued transfer evaluations:\n- The forward transfer, from the boundary element to the field point, as the pressure at $\\mathbf{r}_f$ induced by the uniform normal velocity $u_0$ over the patch, computed by numerically integrating the single-layer potential using a quadrature rule over the patch area.\n- The swapped transfer, from the field point to the collocation point, as the pressure at $\\mathbf{r}_c$ due to an equivalent monopole point source located at $\\mathbf{r}_f$ with source strength $Q$ chosen such that the conjugate pairing between normal velocity and pressure implied by the single-layer operator is preserved under swapping. Use this to define $Q$ in terms of $\\rho_0$, $\\omega$, $u_0$, and $A$.\n\nImplement a program that, for a suite of test cases specified below, computes the forward transfer and the swapped transfer and reports the dimensionless reciprocity consistency error\n$$\n\\varepsilon = \\frac{\\left|p_{\\text{forward}} - p_{\\text{swapped}}\\right|}{\\left|p_{\\text{forward}}\\right|}.\n$$\nYour numerical integration of the forward transfer must use a tensor-product Gauss–Legendre quadrature over the rectangular patch. The Green's function must be the three-dimensional free-space Helmholtz Green's function. All physical quantities must be in International System of Units (SI units), with $c$ in $\\mathrm{m/s}$, $\\rho_0$ in $\\mathrm{kg/m^3}$, frequency $f$ in $\\mathrm{Hz}$, and geometry in $\\mathrm{m}$.\n\nTest suite specification:\n- Use $\\rho_0 = 1.225$ expressed in $\\mathrm{kg/m^3}$, $c = 343$ expressed in $\\mathrm{m/s}$, and $u_0 = 1$ expressed in $\\mathrm{m/s}$ for all tests. Let $\\omega = 2\\pi f$ and $k = \\omega / c$.\n- Case $1$ (happy path): $f = 1000$ expressed in $\\mathrm{Hz}$, $W = 0.05$ expressed in $\\mathrm{m}$, $H = 0.05$ expressed in $\\mathrm{m}$, $\\mathbf{r}_f = (0,0,0.5)$ expressed in $\\mathrm{m}$, quadrature orders $N_x = 12$, $N_y = 12$.\n- Case $2$ (near field): $f = 1000$ expressed in $\\mathrm{Hz}$, $W = 0.10$ expressed in $\\mathrm{m}$, $H = 0.10$ expressed in $\\mathrm{m}$, $\\mathbf{r}_f = (0,0,0.05)$ expressed in $\\mathrm{m}$, quadrature orders $N_x = 48$, $N_y = 48$.\n- Case $3$ (high frequency): $f = 5000$ expressed in $\\mathrm{Hz}$, $W = 0.05$ expressed in $\\mathrm{m}$, $H = 0.05$ expressed in $\\mathrm{m}$, $\\mathbf{r}_f = (0,0,1.0)$ expressed in $\\mathrm{m}$, quadrature orders $N_x = 24$, $N_y = 24$.\n- Case $4$ (off-axis field point): $f = 1500$ expressed in $\\mathrm{Hz}$, $W = 0.07$ expressed in $\\mathrm{m}$, $H = 0.05$ expressed in $\\mathrm{m}$, $\\mathbf{r}_f = (0.02,-0.015,0.3)$ expressed in $\\mathrm{m}$, quadrature orders $N_x = 24$, $N_y = 24$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$\\text{result1}$,$\\text{result2}$,$\\text{result3}$,$\\text{result4}$]\"), where each $\\text{result}$ is the floating-point value of $\\varepsilon$ for the corresponding test case expressed as a decimal number without a unit. The program must be self-contained, must not read input, and must not access any external resources.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of linear acoustics, mathematically well-posed, and objectively stated. It presents a non-trivial computational task to verify a fundamental physical principle, reciprocity, within the context of a numerical method (BEM). All necessary data and definitions are provided.\n\nThe foundation of this problem is the time-harmonic acoustic field in a homogeneous, lossless, reciprocal medium. The acoustic pressure $p(\\mathbf{r})$ for a time dependency of $e^{-i\\omega t}$ is governed by the Helmholtz equation:\n$$\n(\\nabla^2 + k^2) p(\\mathbf{r}) = 0\n$$\nwhere $\\omega$ is the angular frequency, $k = \\omega / c$ is the wavenumber, $c$ is the speed of sound, and $\\mathbf{r}$ is a point in the field.\n\nFor a vibrating planar surface in an infinite rigid baffle (the condition implied by a \"planar baffled plate\"), the pressure in the half-space $z  0$ is given by the Rayleigh integral:\n$$\np(\\mathbf{r}) = \\frac{i\\omega\\rho_0}{2\\pi} \\int_{\\mathcal{S}} u_n(\\mathbf{s}) \\frac{e^{ik|\\mathbf{r}-\\mathbf{s}|}}{|\\mathbf{r}-\\mathbf{s}|} dS(\\mathbf{s})\n$$\nwhere $\\rho_0$ is the medium density, $u_n(\\mathbf{s})$ is the normal velocity on the surface element $dS$ at position $\\mathbf{s} \\in \\mathcal{S}$, and the term $G_R(\\mathbf{r},\\mathbf{s}) = \\frac{e^{ik|\\mathbf{r}-\\mathbf{s}|}}{|\\mathbf{r}-\\mathbf{s}|}$ is the kernel of the integral. This integral formulation is a specific form of the single-layer potential for a baffled surface. The formulation inherently relies on the free-space Green's function, doubled to account for the baffle, and the source density is identified as being proportional to the normal velocity, $\\sigma(\\mathbf{s}) \\propto i\\omega\\rho_0 u_n(\\mathbf{s})$.\n\nThe problem requires the computation and comparison of two transfer functions.\n\n**1. Forward Transfer ($p_{\\text{forward}}$)**\n\nThe forward transfer is defined as the pressure $p_{\\text{forward}}$ at the field point $\\mathbf{r}_f = (x_f, y_f, z_f)$ generated by the vibrating patch. The patch is a rectangle $\\mathcal{S}$ of width $W$ and height $H$, centered at the origin in the $z=0$ plane, so $\\mathcal{S} = [-W/2, W/2] \\times [-H/2, H/2] \\times \\{0\\}$. The normal velocity is uniform, $u_n(\\mathbf{s}) = u_0$.\n\nSubstituting these into the Rayleigh integral, we get:\n$$\np_{\\text{forward}} = p(\\mathbf{r}_f) = \\frac{i\\omega\\rho_0 u_0}{2\\pi} \\int_{-W/2}^{W/2} \\int_{-H/2}^{H/2} \\frac{e^{ik\\sqrt{(x_f-x)^2 + (y_f-y)^2 + z_f^2}}}{\\sqrt{(x_f-x)^2 + (y_f-y)^2 + z_f^2}} dx dy\n$$\nThis integral is computed numerically using a tensor-product Gauss-Legendre quadrature. We perform a change of variables to map the integration domain from $[ -W/2, W/2 ] \\times [ -H/2, H/2 ]$ to the canonical square $[-1, 1] \\times [-1, 1]$. Let $x = (W/2)\\xi$ and $y = (H/2)\\eta$. The differential area element becomes $dx dy = (WH/4) d\\xi d\\eta = (A/4) d\\xi d\\eta$, where $A=WH$ is the area of the patch. The integral becomes:\n$$\np_{\\text{forward}} = \\frac{i\\omega\\rho_0 u_0 A}{8\\pi} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{e^{ik R(\\xi, \\eta)}}{R(\\xi, \\eta)} d\\xi d\\eta\n$$\nwhere $R(\\xi, \\eta) = \\sqrt{(x_f - \\frac{W}{2}\\xi)^2 + (y_f - \\frac{H}{2}\\eta)^2 + z_f^2}$. Applying the quadrature rule with $N_x \\times N_y$ points, with nodes $\\{\\xi_i, \\eta_j\\}$ and weights $\\{w_i, w_j\\}$, gives the discrete approximation:\n$$\np_{\\text{forward}} \\approx \\frac{i\\omega\\rho_0 u_0 A}{8\\pi} \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} w_i w_j \\frac{e^{ik R_{ij}}}{R_{ij}}\n$$\nwhere $R_{ij} = \\sqrt{(x_f - \\frac{W}{2}\\xi_i)^2 + (y_f - \\frac{H}{2}\\eta_j)^2 + z_f^2}$.\n\n**2. Swapped Transfer ($p_{\\text{swapped}}$)**\n\nThe swapped transfer, $p_{\\text{swapped}}$, is the pressure at the patch's collocation point (its centroid, $\\mathbf{r}_c = (0,0,0)$) due to an equivalent monopole point source of strength $Q$ located at the field point $\\mathbf{r}_f$.\n\nThe pressure field from a monopole point source of volume velocity strength $Q$ (in $\\mathrm{m^3/s}$) at $\\mathbf{r}_f$ in a baffled environment is given by:\n$$\np_{\\text{source}}(\\mathbf{r}) = \\frac{i\\omega\\rho_0 Q}{2\\pi} \\frac{e^{ik|\\mathbf{r}-\\mathbf{r}_f|}}{|\\mathbf{r}-\\mathbf{r}_f|}\n$$\nEvaluating this at the collocation point $\\mathbf{r}_c$ gives the swapped pressure:\n$$\np_{\\text{swapped}} = p_{\\text{source}}(\\mathbf{r}_c) = \\frac{i\\omega\\rho_0 Q}{2\\pi} \\frac{e^{ik|\\mathbf{r}_c-\\mathbf{r}_f|}}{|\\mathbf{r}_c-\\mathbf{r}_f|}\n$$\nThe source strength $Q$ must be defined to preserve the physical pairing. The principle of reciprocity, embodied in the symmetry of the Green's function, provides the link. The pressure at $\\mathbf{r}_f$ due to the distributed source $\\sigma(\\mathbf{s}) = i\\omega\\rho_0 u_n(\\mathbf{s})$ over the patch $\\mathcal{S}$ is:\n$$\np_{\\text{forward}} = \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{r}_f, \\mathbf{s}) dS(\\mathbf{s}) = \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{s}, \\mathbf{r}_f) dS(\\mathbf{s})\n$$\nwhere $G_{\\text{baffled}}(\\mathbf{r}, \\mathbf{r}') = \\frac{e^{ik|\\mathbf{r}-\\mathbf{r}'|}}{2\\pi|\\mathbf{r}-\\mathbf{r}'|}$. A key approximation in collocation BEM is to assume that the integral of a product can be approximated by evaluating the smooth part of the kernel at the collocation point $\\mathbf{r}_c$:\n$$\n\\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) G_{\\text{baffled}}(\\mathbf{s}, \\mathbf{r}_f) dS(\\mathbf{s}) \\approx G_{\\text{baffled}}(\\mathbf{r}_c, \\mathbf{r}_f) \\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) dS(\\mathbf{s})\n$$\nThe right-hand side of this approximation is an alternative way to express the swapped transfer. The total source strength on the patch is $\\int_{\\mathcal{S}} \\sigma(\\mathbf{s}) dS = \\int_{\\mathcal{S}} i\\omega\\rho_0 u_0 dS = i\\omega\\rho_0 u_0 A$. So the swapped pressure is:\n$$\np_{\\text{swapped}} = \\left( \\frac{e^{ik|\\mathbf{r}_c-\\mathbf{r}_f|}}{2\\pi|\\mathbf{r}_c-\\mathbf{r}_f|} \\right) (i\\omega\\rho_0 u_0 A)\n$$\nBy comparing this to the monopole source pressure equation, we see that $i\\omega\\rho_0 Q$ must be equivalent to the total source strength $i\\omega\\rho_0 u_0 A$. This leads to the definition of the equivalent source strength:\n$$\nQ = u_0 A\n$$\nThis is physically intuitive: the equivalent point source has a volume velocity equal to the total volume velocity of the vibrating patch. With this, the final expression for the swapped pressure is:\n$$\np_{\\text{swapped}} = \\frac{i\\omega\\rho_0 (u_0 A)}{2\\pi} \\frac{e^{ik|\\mathbf{r}_f|}}{|\\mathbf{r}_f|}\n$$\nsince $\\mathbf{r}_c$ is the origin.\n\n**3. Reciprocity Consistency Error ($\\varepsilon$)**\n\nThe dimensionless error $\\varepsilon$ quantifies the discrepancy between the exact integral for the forward transfer and the single-point collocation approximation used to derive the swapped transfer. It is a measure of how well the patch can be represented by its centroid for this interaction.\n$$\n\\varepsilon = \\frac{\\left|p_{\\text{forward}} - p_{\\text{swapped}}\\right|}{\\left|p_{\\text{forward}}\\right|}\n$$\nThe numerical implementation will calculate $p_{\\text{forward}}$ via quadrature and $p_{\\text{swapped}}$ via its analytical formula, then compute $\\varepsilon$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Computes the reciprocity consistency error for a set of acoustic radiation problems.\n    \"\"\"\n    RHO_0 = 1.225  # kg/m^3\n    C = 343.0    # m/s\n    U_0 = 1.0      # m/s\n\n    test_cases = [\n        # Case 1: happy path\n        {'f': 1000.0, 'W': 0.05, 'H': 0.05, 'rf': (0.0, 0.0, 0.5), 'Nx': 12, 'Ny': 12},\n        # Case 2: near field\n        {'f': 1000.0, 'W': 0.10, 'H': 0.10, 'rf': (0.0, 0.0, 0.05), 'Nx': 48, 'Ny': 48},\n        # Case 3: high frequency\n        {'f': 5000.0, 'W': 0.05, 'H': 0.05, 'rf': (0.0, 0.0, 1.0), 'Nx': 24, 'Ny': 24},\n        # Case 4: off-axis field point\n        {'f': 1500.0, 'W': 0.07, 'H': 0.05, 'rf': (0.02, -0.015, 0.3), 'Nx': 24, 'Ny': 24},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        f = case['f']\n        W = case['W']\n        H = case['H']\n        xf, yf, zf = case['rf']\n        Nx = case['Nx']\n        Ny = case['Ny']\n\n        # Derived physical parameters\n        omega = 2.0 * np.pi * f\n        k = omega / C\n        A = W * H\n\n        # --- 1. Forward Transfer Calculation (p_forward) ---\n        # Get Gauss-Legendre quadrature nodes and weights for the interval [-1, 1]\n        xi_nodes, xi_weights = leggauss(Nx)\n        eta_nodes, eta_weights = leggauss(Ny)\n\n        # Create meshgrid for vectorized calculation\n        xi_grid, eta_grid = np.meshgrid(xi_nodes, eta_nodes)\n        wi_grid, wj_grid = np.meshgrid(xi_weights, eta_weights)\n\n        # Map quadrature points to physical coordinates on the patch\n        xs = (W / 2.0) * xi_grid\n        ys = (H / 2.0) * eta_grid\n\n        # Calculate distance from each source point on the patch to the field point\n        R = np.sqrt((xf - xs)**2 + (yf - ys)**2 + zf**2)\n\n        # Calculate the integrand of the Rayleigh integral\n        integrand = np.exp(1j * k * R) / R\n\n        # Perform the numerical integration\n        integral_sum = np.sum(wi_grid * wj_grid * integrand)\n\n        # The change of variables introduced a Jacobian of (W/2)*(H/2) = A/4\n        # The integral is multiplied by this Jacobian and the other constants\n        p_forward = (1j * omega * RHO_0 * U_0 / (2.0 * np.pi)) * (A / 4.0) * integral_sum\n        \n        # --- 2. Swapped Transfer Calculation (p_swapped) ---\n        # The collocation point is the origin\n        rc = np.array([0.0, 0.0, 0.0])\n        rf_vec = np.array([xf, yf, zf])\n\n        # Distance from collocation point to field point\n        R_cf = np.linalg.norm(rf_vec - rc)\n        \n        # Equivalent monopole source strength\n        Q = U_0 * A\n\n        # Calculate the pressure at rc from the point source at rf\n        if R_cf == 0:\n            # This case should not occur based on problem description (zf > 0)\n            # but is included for numerical stability.\n            p_swapped = np.inf\n        else:\n            p_swapped = (1j * omega * RHO_0 * Q / (2.0 * np.pi)) * (np.exp(1j * k * R_cf) / R_cf)\n\n        # --- 3. Reciprocity Consistency Error (epsilon) ---\n        if np.abs(p_forward) == 0:\n            error = np.inf if np.abs(p_forward - p_swapped) > 0 else 0.0\n        else:\n            error = np.abs(p_forward - p_swapped) / np.abs(p_forward)\n        \n        results.append(error)\n\n    # Format the final output\n    # Using f-string formatting to control the number representation\n    formatted_results = [f\"{res:.10e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}