{
    "hands_on_practices": [
        {
            "introduction": "Understanding sound absorption begins with the physical mechanisms of energy dissipation. While bulk viscosity and thermal conductivity contribute to attenuation in free space, the presence of boundaries introduces dominant loss mechanisms within thin thermoviscous boundary layers. This first practice  challenges you to derive and quantify this boundary-induced attenuation for a wave propagating in a duct, a canonical problem in acoustics. By applying the Kirchhoff-Helmholtz theory in the wide-tube limit, you will connect first-principles fluid dynamics to a practical attenuation model and develop skills in applying asymptotic approximations.",
            "id": "4129911",
            "problem": "A rigid, thermally conducting circular tube of radius $a = 5 \\times 10^{-3}\\ \\mathrm{m}$ is filled with quiescent air at ambient conditions. A small-amplitude, axisymmetric plane acoustic wave of frequency $f = 2.0 \\times 10^{3}\\ \\mathrm{Hz}$ propagates in the $x$ direction. Model the propagation including viscous and thermal effects in the air and no-slip, isothermal wall boundary conditions. Use the following air properties representative of $T \\approx 293\\ \\mathrm{K}$: ratio of specific heats $\\gamma = 1.4$, speed of sound $c_{0} = 343\\ \\mathrm{m/s}$, kinematic viscosity $\\nu = 1.50 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$, and thermal diffusivity $\\alpha = 2.15 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$. Assume linear acoustics with time-harmonic convention $\\exp(-i \\omega t)$.\n\nStarting from the linearized conservation of mass, momentum (including viscous stresses), and energy (including thermal conduction), derive the dispersion relation for the complex axial wavenumber $k$ for the fundamental plane mode in a circular duct in terms of cross-sectional thermoviscous correction functions. In the limit of thin boundary layers relative to the radius, justify the leading-order approximation of these correction functions and obtain an explicit approximation for the attenuation coefficient (the excess attenuation relative to the no-loss plane-wave prediction) as the imaginary part of $k$.\n\nCompute the excess attenuation per unit length at the specified frequency and radius for air, and express your final numerical answer in Nepers per meter (Np/m). Round your answer to four significant figures.",
            "solution": "The propagation of a small-amplitude, axisymmetric acoustic wave in a viscous and thermally conducting fluid is governed by the linearized equations of mass, momentum, and energy. Assuming a time-harmonic dependence of the form $\\exp(-i\\omega t)$, where $\\omega = 2\\pi f$ is the angular frequency, these equations can be solved for the complex axial wavenumber $k$. For the fundamental (plane) wave mode in a rigid, isothermal circular tube of radius $a$, the exact dispersion relation is given by the Kirchhoff-Helmholtz theory:\n$$ k^2 = k_0^2 \\frac{1 + (\\gamma - 1) F_t(\\xi_t)}{1 - F_v(\\xi_v)} $$\nwhere $k_0 = \\omega/c_0$ is the free-space wavenumber and $\\gamma$ is the ratio of specific heats.\n\nThe terms $F_v$ and $F_t$ are the cross-sectional thermoviscous correction functions, which account for the effects of the viscous and thermal boundary layers at the tube wall. For a circular cross-section, they are defined in terms of Bessel functions of the first kind ($J_0$ and $J_1$):\n$$ F_v(\\xi_v) = \\frac{2 J_1(i\\xi_v)}{i\\xi_v J_0(i\\xi_v)} \\quad \\text{and} \\quad F_t(\\xi_t) = \\frac{2 J_1(i\\xi_t)}{i\\xi_t J_0(i\\xi_t)} $$\nThe arguments of these functions are the non-dimensional parameters $\\xi_v$ and $\\xi_t$, which relate the tube radius to the characteristic viscous and thermal boundary layer thicknesses:\n$$ \\xi_v = a\\sqrt{\\frac{\\omega}{\\nu}} \\quad \\text{and} \\quad \\xi_t = a\\sqrt{\\frac{\\omega}{\\alpha}} $$\nNote the arguments of the Bessel functions are complex, $i\\xi_v = a\\sqrt{i^2\\omega/\\nu} = a \\sqrt{-\\omega/\\nu}$. An alternative and more common formulation uses arguments $k_v a$ and $k_t a$, where $k_v = \\sqrt{i\\omega/\\nu}$ and $k_t = \\sqrt{i\\omega/\\alpha}$. This gives:\n$$ F_v(k_v a) = \\frac{2 J_1(k_v a)}{k_v a J_0(k_v a)} \\quad \\text{and} \\quad F_t(k_t a) = \\frac{2 J_1(k_t a)}{k_t a J_0(k_t a)} $$\nThe dispersion relation remains $k^2 = k_0^2 [1 + (\\gamma-1)F_t] / [1 - F_v]$.\n\nThe problem asks for the solution in the limit of thin boundary layers, which corresponds to the wide-tube or high-frequency limit. This approximation is valid when the boundary layer thicknesses, $\\delta_v = \\sqrt{2\\nu/\\omega}$ (viscous) and $\\delta_t = \\sqrt{2\\alpha/\\omega}$ (thermal), are much smaller than the tube radius $a$. Let's verify this condition with the given parameters.\n\nFirst, we calculate $\\omega$:\n$$ \\omega = 2\\pi f = 2\\pi (2.0 \\times 10^3\\ \\mathrm{Hz}) = 4000\\pi\\ \\mathrm{rad/s} \\approx 12566\\ \\mathrm{rad/s} $$\nNext, the boundary layer thicknesses:\n$$ \\delta_v = \\sqrt{\\frac{2\\nu}{\\omega}} = \\sqrt{\\frac{2(1.50 \\times 10^{-5}\\ \\mathrm{m^2/s})}{4000\\pi\\ \\mathrm{rad/s}}} \\approx 4.88 \\times 10^{-5}\\ \\mathrm{m} $$\n$$ \\delta_t = \\sqrt{\\frac{2\\alpha}{\\omega}} = \\sqrt{\\frac{2(2.15 \\times 10^{-5}\\ \\mathrm{m^2/s})}{4000\\pi\\ \\mathrm{rad/s}}} \\approx 5.85 \\times 10^{-5}\\ \\mathrm{m} $$\nThe ratios to the radius $a = 5 \\times 10^{-3}\\ \\mathrm{m}$ are:\n$$ \\frac{\\delta_v}{a} \\approx \\frac{4.88 \\times 10^{-5}}{5 \\times 10^{-3}} \\approx 0.00976 \\ll 1 $$\n$$ \\frac{\\delta_t}{a} \\approx \\frac{5.85 \\times 10^{-5}}{5 \\times 10^{-3}} \\approx 0.0117 \\ll 1 $$\nThe thin-boundary-layer condition is well satisfied. This justifies using an asymptotic approximation for the correction functions. The arguments of the Bessel functions are $|k_v a| = a\\sqrt{\\omega/\\nu} = a/(\\delta_v/\\sqrt{2}) = a\\sqrt{2}/\\delta_v \\approx 145 \\gg 1$ and $|k_t a| = a\\sqrt{2}/\\delta_t \\approx 121 \\gg 1$. For a complex argument $z$ with a large magnitude and $\\mathrm{arg}(z) = \\pi/4$, such as $k_v a = a\\sqrt{i\\omega/\\nu} = a(1+i)/\\delta_v$, the asymptotic behavior of the Bessel function ratio is:\n$$ \\frac{J_1(z)}{J_0(z)} \\to i \\quad \\text{as} \\quad |z| \\to \\infty $$\nApplying this approximation to the correction functions $F_v$ and $F_t$:\n$$ F_v(k_v a) \\approx \\frac{2i}{k_v a} \\quad \\text{and} \\quad F_t(k_t a) \\approx \\frac{2i}{k_t a} $$\nSubstituting these approximations into the dispersion relation:\n$$ k^2 \\approx k_0^2 \\frac{1 + (\\gamma - 1) \\frac{2i}{k_t a}}{1 - \\frac{2i}{k_v a}} $$\nSince the correction terms are small in magnitude $(|2i/(k_v a)| = \\sqrt{2}\\delta_v/a \\ll 1)$, we can use the binomial approximation $(1-x)^{-1} \\approx 1+x$:\n$$ k^2 \\approx k_0^2 \\left(1 + (\\gamma - 1) \\frac{2i}{k_t a}\\right) \\left(1 + \\frac{2i}{k_v a}\\right) $$\nExpanding and neglecting the second-order term (the product of the two corrections):\n$$ k^2 \\approx k_0^2 \\left(1 + \\frac{2i(\\gamma - 1)}{k_t a} + \\frac{2i}{k_v a}\\right) $$\nNow, taking the square root and using the approximation $\\sqrt{1+\\epsilon} \\approx 1+\\epsilon/2$ for small $\\epsilon$:\n$$ k \\approx k_0 \\left(1 + \\frac{i(\\gamma - 1)}{k_t a} + \\frac{i}{k_v a}\\right) $$\nTo find the attenuation, we substitute $k_v = (1+i)/\\delta_v$ and $k_t = (1+i)/\\delta_t$:\n$$ \\frac{1}{k_v a} = \\frac{\\delta_v}{a(1+i)} = \\frac{\\delta_v(1-i)}{2a} $$\n$$ \\frac{1}{k_t a} = \\frac{\\delta_t}{a(1+i)} = \\frac{\\delta_t(1-i)}{2a} $$\nSubstituting these into the expression for $k$:\n$$ k \\approx k_0 \\left(1 + \\frac{i(\\gamma-1)\\delta_t(1-i)}{2a} + \\frac{i\\delta_v(1-i)}{2a} \\right) $$\n$$ k \\approx k_0 \\left(1 + \\frac{(\\gamma-1)\\delta_t(i+1)}{2a} + \\frac{\\delta_v(i+1)}{2a} \\right) $$\n$$ k \\approx k_0 \\left(1 + \\frac{(\\gamma-1)\\delta_t + \\delta_v}{2a} (1+i) \\right) $$\n$$ k \\approx \\frac{\\omega}{c_0} \\left( \\left[1 + \\frac{(\\gamma-1)\\delta_t + \\delta_v}{2a}\\right] + i \\left[\\frac{(\\gamma-1)\\delta_t + \\delta_v}{2a}\\right] \\right) $$\nThe complex wavenumber is $k = \\beta + iA$, where $\\beta$ is the propagation constant and $A$ is the attenuation coefficient. The problem asks for the excess attenuation, which is the imaginary part of $k$.\n$$ A = \\mathrm{Im}(k) = \\frac{\\omega}{c_0} \\left( \\frac{(\\gamma-1)\\delta_t + \\delta_v}{2a} \\right) $$\nSubstituting the definitions of $\\delta_t$ and $\\delta_v$:\n$$ A = \\frac{\\omega}{2ac_0} \\left( (\\gamma-1)\\sqrt{\\frac{2\\alpha}{\\omega}} + \\sqrt{\\frac{2\\nu}{\\omega}} \\right) $$\n$$ A = \\frac{\\sqrt{\\omega}}{2ac_0} \\left( (\\gamma-1)\\sqrt{2\\alpha} + \\sqrt{2\\nu} \\right) = \\frac{\\sqrt{2\\omega}}{2ac_0} \\left( (\\gamma-1)\\sqrt{\\alpha} + \\sqrt{\\nu} \\right) $$\nThis is the explicit approximation for the attenuation coefficient. Now we compute the numerical value.\n\nGiven values:\n$\\omega = 4000\\pi\\ \\mathrm{rad/s}$\n$a = 5 \\times 10^{-3}\\ \\mathrm{m}$\n$c_0 = 343\\ \\mathrm{m/s}$\n$\\gamma = 1.4$\n$\\nu = 1.50 \\times 10^{-5}\\ \\mathrm{m^2/s}$\n$\\alpha = 2.15 \\times 10^{-5}\\ \\mathrm{m^2/s}$\n\n$$ A = \\frac{\\sqrt{2 (4000\\pi)}}{2 (5 \\times 10^{-3}) (343)} \\left( (1.4 - 1) \\sqrt{2.15 \\times 10^{-5}} + \\sqrt{1.50 \\times 10^{-5}} \\right) $$\n$$ A = \\frac{\\sqrt{8000\\pi}}{3.43} \\left( 0.4 \\sqrt{2.15 \\times 10^{-5}} + \\sqrt{1.50 \\times 10^{-5}} \\right) $$\nLet's compute the terms:\n$$ \\sqrt{8000\\pi} \\approx 158.53309 $$\n$$ \\sqrt{2.15 \\times 10^{-5}} \\approx 0.004636809 $$\n$$ \\sqrt{1.50 \\times 10^{-5}} \\approx 0.003872983 $$\n$$ A \\approx \\frac{158.53309}{3.43} \\left( 0.4 \\times 0.004636809 + 0.003872983 \\right) $$\n$$ A \\approx 46.21956 \\left( 0.001854724 + 0.003872983 \\right) $$\n$$ A \\approx 46.21956 \\left( 0.005727707 \\right) $$\n$$ A \\approx 0.264713\\ \\mathrm{Np/m} $$\nRounding to four significant figures, the excess attenuation is $0.2647\\ \\mathrm{Np/m}$.",
            "answer": "$$\\boxed{0.2647}$$"
        },
        {
            "introduction": "Moving from analytical models to general-purpose numerical methods like the Finite Element Method (FEM) allows us to tackle complex geometries and material properties. However, introducing damping, especially when it varies spatially, fundamentally alters the mathematical nature of the underlying acoustic system. This exercise  guides you through the process of formulating a finite element model for a cavity with spatially varying damping, revealing how it leads to a non-Hermitian eigenvalue problem. You will explore the resulting concepts of complex modes and biorthogonality, which are essential for correctly performing and interpreting modal analysis in damped systems.",
            "id": "4129968",
            "problem": "A three-dimensional rigid-walled acoustic cavity occupies a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{3}$ with outward unit normal $\\mathbf{n}$. The acoustic pressure field $p(\\mathbf{x},t)$ satisfies the linearized equations of continuity and momentum, and the medium is modeled as an effective single-phase fluid with spatially varying dynamic density that captures material damping. Specifically, assume the effective density is $\\rho_{\\mathrm{eff}}(\\mathbf{x},\\omega) = \\rho_{0}(\\mathbf{x})\\left(1 + \\mathrm{i}\\,\\eta(\\mathbf{x})\\right)$, where $\\rho_{0}(\\mathbf{x}) > 0$ is real-valued, $\\eta(\\mathbf{x}) \\ge 0$ is a bounded spatially varying loss factor, and $\\omega$ is the angular frequency. Let the bulk modulus $K_{0}(\\mathbf{x})>0$ be real-valued and lossless. Consider the time-harmonic ansatz $p(\\mathbf{x},t) = \\Re\\{P(\\mathbf{x})\\exp(-\\mathrm{i}\\omega t)\\}$ and homogeneous Neumann boundary conditions representing rigid walls, $\\frac{\\partial P}{\\partial \\mathbf{n}}=0$ on $\\partial\\Omega$.\n\nStarting from the linearized conservation laws and constitutive relations, derive the frequency-domain governing equation for $P(\\mathbf{x})$ in $\\Omega$. Then, derive its standard weak form with test functions $Q(\\mathbf{x})$ in the Sobolev space $H^{1}(\\Omega)$, and show how the spatially varying loss factor $\\eta(\\mathbf{x})$ enters the weak form as a complex-valued coefficient in the bilinear form associated with the gradient term. Using a conforming Finite Element Method (FEM) discretization with nodal basis $\\{N_{i}(\\mathbf{x})\\}_{i=1}^{N}$, demonstrate that the discrete homogeneous cavity modes satisfy a generalized eigenvalue problem of the form\n$$\n\\mathbf{K}(\\eta)\\,\\boldsymbol{v}_{n} \\;=\\; \\lambda_{n}\\,\\mathbf{M}\\,\\boldsymbol{v}_{n},\n$$\nwhere $\\lambda_{n}=\\omega_{n}^{2}$ are generally complex due to damping, $\\mathbf{M}$ is real symmetric positive-definite, and $\\mathbf{K}(\\eta)$ is non-Hermitian because of the spatially varying damping. Define the left (adjoint) eigenvectors $\\boldsymbol{w}_{n}$ satisfying\n$$\n\\mathbf{K}(\\eta)^{\\dagger}\\,\\boldsymbol{w}_{n} \\;=\\; \\bar{\\lambda}_{n}\\,\\mathbf{M}\\,\\boldsymbol{w}_{n},\n$$\nwhere $\\dagger$ denotes the conjugate transpose and the bar denotes complex conjugation. Using these definitions, derive the orthogonality relation between distinct complex modes and discuss the completeness of the set of right and left eigenvectors in the discrete FEM space under the assumption that the pencil $\\left(\\mathbf{K}(\\eta),\\mathbf{M}\\right)$ is diagonalizable. Conclude by writing the resolution-of-identity (completeness) relation in the discrete FEM space that encodes both the biorthogonality and completeness of the complex modes in the presence of spatially varying damping.\n\nYour final answer must be a single closed-form analytic expression for this resolution-of-identity relation. No numerical evaluation is required and no units should be included in the final boxed expression.",
            "solution": "We begin by deriving the time-harmonic acoustic wave equation from the linearized conservation laws. The linearized momentum equation for a time-harmonic velocity field $\\mathbf{V}(\\mathbf{x})$ and pressure field $P(\\mathbf{x})$ is given by:\n$$ -\\mathrm{i}\\omega \\rho_{\\mathrm{eff}}(\\mathbf{x}) \\mathbf{V}(\\mathbf{x}) = -\\nabla P(\\mathbf{x}) $$\nHere, the complex effective density $\\rho_{\\mathrm{eff}}(\\mathbf{x}) = \\rho_{0}(\\mathbf{x})(1 + \\mathrm{i}\\eta(\\mathbf{x}))$ models the material damping. This gives an expression for the velocity field:\n$$ \\mathbf{V}(\\mathbf{x}) = \\frac{1}{\\mathrm{i}\\omega \\rho_{\\mathrm{eff}}(\\mathbf{x})} \\nabla P(\\mathbf{x}) $$\nThe linearized equation of continuity, combined with the constitutive relation for the bulk modulus $K_0(\\mathbf{x})$, can be written in the frequency domain as:\n$$ -\\mathrm{i}\\omega P(\\mathbf{x}) = -K_0(\\mathbf{x}) \\nabla \\cdot \\mathbf{V}(\\mathbf{x}) $$\nSubstituting the expression for $\\mathbf{V}(\\mathbf{x})$ into the continuity equation yields:\n$$ -\\mathrm{i}\\omega P(\\mathbf{x}) = -K_0(\\mathbf{x}) \\nabla \\cdot \\left( \\frac{1}{\\mathrm{i}\\omega \\rho_{\\mathrm{eff}}(\\mathbf{x})} \\nabla P(\\mathbf{x}) \\right) $$\nMultiplying by $\\mathrm{i}\\omega$ and rearranging terms, we arrive at the governing partial differential equation for the complex pressure amplitude $P(\\mathbf{x})$:\n$$ \\nabla \\cdot \\left( \\frac{1}{\\rho_{\\mathrm{eff}}(\\mathbf{x})} \\nabla P(\\mathbf{x}) \\right) + \\frac{\\omega^2}{K_0(\\mathbf{x})} P(\\mathbf{x}) = 0 \\quad \\text{in } \\Omega $$\nThe boundary condition on the rigid walls $\\partial\\Omega$ is the homogeneous Neumann condition $\\frac{\\partial P}{\\partial\\mathbf{n}} = 0$.\n\nNext, we derive the standard weak form. We multiply the governing equation by an arbitrary test function $Q(\\mathbf{x})$ from the Sobolev space $H^{1}(\\Omega)$ and integrate over the domain $\\Omega$:\n$$ \\int_{\\Omega} Q \\left[ \\nabla \\cdot \\left( \\frac{1}{\\rho_{\\mathrm{eff}}} \\nabla P \\right) + \\frac{\\omega^2}{K_0} P \\right] d\\Omega = 0 $$\nApplying integration by parts (Green's first identity) to the first term gives:\n$$ \\int_{\\Omega} Q \\nabla \\cdot \\left( \\frac{1}{\\rho_{\\mathrm{eff}}} \\nabla P \\right) d\\Omega = \\oint_{\\partial\\Omega} Q \\frac{1}{\\rho_{\\mathrm{eff}}} \\frac{\\partial P}{\\partial\\mathbf{n}} dS - \\int_{\\Omega} \\nabla Q \\cdot \\left( \\frac{1}{\\rho_{\\mathrm{eff}}} \\nabla P \\right) d\\Omega $$\nThe boundary integral vanishes because $\\frac{\\partial P}{\\partial\\mathbf{n}} = 0$ on $\\partial\\Omega$. Substituting this back into the integrated equation, we obtain the weak form: Find $P \\in H^{1}(\\Omega)$ such that for all $Q \\in H^{1}(\\Omega)$,\n$$ - \\int_{\\Omega} \\frac{1}{\\rho_{\\mathrm{eff}}} \\nabla Q \\cdot \\nabla P \\, d\\Omega + \\omega^2 \\int_{\\Omega} \\frac{1}{K_0} Q P \\, d\\Omega = 0 $$\nRearranging to the canonical form for an eigenvalue problem, we have:\n$$ \\int_{\\Omega} \\frac{1}{\\rho_{0}(1 + \\mathrm{i}\\eta)} \\nabla P \\cdot \\nabla Q \\, d\\Omega = \\omega^2 \\int_{\\Omega} \\frac{1}{K_0} P Q \\, d\\Omega $$\nThe spatially varying loss factor $\\eta(\\mathbf{x})$ appears in the complex coefficient $\\frac{1}{\\rho_{0}(1 + \\mathrm{i}\\eta)}$ of the bilinear form associated with the gradient term, which we can denote $k(P,Q)$.\n\nTo discretize the problem using the Finite Element Method (FEM), we expand the pressure field $P(\\mathbf{x})$ in terms of $N$ nodal basis functions $\\{N_{j}(\\mathbf{x})\\}_{j=1}^{N}$:\n$$ P(\\mathbf{x}) = \\sum_{j=1}^{N} v_{j} N_{j}(\\mathbf{x}) $$\nwhere $\\boldsymbol{v} = [v_1, v_2, \\dots, v_N]^T$ is the vector of nodal values for $P$. Using the Galerkin method, we choose the test functions $Q(\\mathbf{x})$ to be the basis functions $N_{i}(\\mathbf{x})$ for $i=1, \\dots, N$. Substituting these into the weak form yields a system of algebraic equations:\n$$ \\sum_{j=1}^{N} \\left( \\int_{\\Omega} \\frac{1}{\\rho_{\\mathrm{eff}}} \\nabla N_{i} \\cdot \\nabla N_{j} \\, d\\Omega \\right) v_{j} = \\omega^2 \\sum_{j=1}^{N} \\left( \\int_{\\Omega} \\frac{1}{K_0} N_{i} N_{j} \\, d\\Omega \\right) v_{j} $$\nThis system can be written as a generalized eigenvalue problem $\\mathbf{K}(\\eta)\\boldsymbol{v} = \\omega^2 \\mathbf{M}\\boldsymbol{v}$. The entries of the stiffness matrix $\\mathbf{K}(\\eta)$ and mass matrix $\\mathbf{M}$ are:\n$$ K_{ij} = \\int_{\\Omega} \\frac{1}{\\rho_{0}(1 + \\mathrm{i}\\eta)} \\nabla N_{i} \\cdot \\nabla N_{j} \\, d\\Omega $$\n$$ M_{ij} = \\int_{\\Omega} \\frac{1}{K_0} N_{i} N_{j} \\, d\\Omega $$\nThe mass matrix $\\mathbf{M}$ is real, symmetric, and positive-definite since $K_0(\\mathbf{x}) > 0$. The stiffness matrix $\\mathbf{K}(\\eta)$ is complex symmetric ($K_{ij} = K_{ji}$), but non-Hermitian for $\\eta(\\mathbf{x}) \\neq 0$, because $\\overline{K_{ij}} \\neq K_{ij}$. Let $\\lambda_n = \\omega_n^2$ be the eigenvalues. The right eigenvectors $\\boldsymbol{v}_n$ satisfy:\n$$ \\mathbf{K}(\\eta)\\,\\boldsymbol{v}_{n} = \\lambda_{n}\\,\\mathbf{M}\\,\\boldsymbol{v}_{n} \\quad (1) $$\nThe left eigenvectors $\\boldsymbol{w}_m$ are defined by the adjoint problem:\n$$ \\mathbf{K}(\\eta)^{\\dagger}\\,\\boldsymbol{w}_{m} = \\bar{\\lambda}_{m}\\,\\mathbf{M}\\,\\boldsymbol{w}_{m} \\quad (2) $$\nTo derive the biorthogonality relation, we take the conjugate transpose of equation $(2)$:\n$$ (\\mathbf{K}(\\eta)^{\\dagger}\\,\\boldsymbol{w}_{m})^{\\dagger} = (\\bar{\\lambda}_{m}\\,\\mathbf{M}\\,\\boldsymbol{w}_{m})^{\\dagger} \\implies \\boldsymbol{w}_{m}^{\\dagger}\\mathbf{K}(\\eta) = \\lambda_{m}\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}^{\\dagger} $$\nSince $\\mathbf{M}$ is real and symmetric, $\\mathbf{M}^{\\dagger} = \\mathbf{M}$. Thus, $\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{K}(\\eta) = \\lambda_{m}\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}$. Now, we pre-multiply equation $(1)$ for eigenvector $\\boldsymbol{v}_n$ by $\\boldsymbol{w}_{m}^{\\dagger}$:\n$$ \\boldsymbol{w}_{m}^{\\dagger}\\mathbf{K}(\\eta)\\boldsymbol{v}_{n} = \\lambda_{n}\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{v}_{n} $$\nSubstituting the transposed adjoint relation into the left-hand side gives:\n$$ \\lambda_{m}\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{v}_{n} = \\lambda_{n}\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{v}_{n} $$\n$$ (\\lambda_{n} - \\lambda_{m})\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{v}_{n} = 0 $$\nFor distinct eigenvalues ($\\lambda_n \\neq \\lambda_m$), this implies the biorthogonality condition with respect to the mass matrix $\\mathbf{M}$:\n$$ \\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{v}_{n} = 0 \\quad \\text{for } m \\neq n $$\nFor $m=n$, the normalization constant $\\alpha_n = \\boldsymbol{w}_{n}^{\\dagger}\\mathbf{M}\\boldsymbol{v}_{n}$ is generally non-zero, a consequence of the assumed diagonalizability of the pencil $(\\mathbf{K}(\\eta), \\mathbf{M})$. We can combine these results as $\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{v}_{n} = \\alpha_n \\delta_{mn}$, where $\\delta_{mn}$ is the Kronecker delta.\n\nFinally, we derive the resolution-of-identity (completeness) relation. The assumption that the pencil is diagonalizable implies that the set of right eigenvectors $\\{\\boldsymbol{v}_n\\}_{n=1}^N$ forms a complete basis for the discrete space $\\mathbb{C}^N$. Any vector $\\boldsymbol{u} \\in \\mathbb{C}^N$ can be expanded as:\n$$ \\boldsymbol{u} = \\sum_{n=1}^{N} c_n \\boldsymbol{v}_n $$\nTo find the coefficients $c_m$, we pre-multiply by $\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}$ and use the biorthogonality relation:\n$$ \\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{u} = \\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M} \\sum_{n=1}^{N} c_n \\boldsymbol{v}_n = \\sum_{n=1}^{N} c_n (\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{v}_n) = \\sum_{n=1}^{N} c_n \\alpha_n \\delta_{mn} = c_m \\alpha_m $$\nThus, the coefficient $c_m$ is given by $c_m = \\frac{\\boldsymbol{w}_{m}^{\\dagger}\\mathbf{M}\\boldsymbol{u}}{\\alpha_m}$. Substituting this back into the expansion for $\\boldsymbol{u}$:\n$$ \\boldsymbol{u} = \\sum_{n=1}^{N} \\left( \\frac{\\boldsymbol{w}_{n}^{\\dagger}\\mathbf{M}\\boldsymbol{u}}{\\alpha_n} \\right) \\boldsymbol{v}_n $$\nSince the term in parentheses is a scalar, we can rearrange the expression:\n$$ \\boldsymbol{u} = \\sum_{n=1}^{N} \\frac{1}{\\alpha_n} \\boldsymbol{v}_n ( \\boldsymbol{w}_{n}^{\\dagger}\\mathbf{M}\\boldsymbol{u} ) = \\left( \\sum_{n=1}^{N} \\frac{\\boldsymbol{v}_n \\boldsymbol{w}_{n}^{\\dagger}\\mathbf{M}}{\\alpha_n} \\right) \\boldsymbol{u} $$\nThis equation must hold for any vector $\\boldsymbol{u}$. Therefore, the expression in parentheses must be the identity matrix $\\mathbf{I}$. This gives the resolution-of-identity relation, which explicitly shows the an arbitrary vector is resolved into its components in the eigenvector basis:\n$$ \\mathbf{I} = \\sum_{n=1}^{N} \\frac{\\boldsymbol{v}_{n} \\boldsymbol{w}_{n}^{\\dagger} \\mathbf{M}}{\\alpha_n} = \\sum_{n=1}^{N} \\frac{\\boldsymbol{v}_{n} \\boldsymbol{w}_{n}^{\\dagger} \\mathbf{M}}{\\boldsymbol{w}_{n}^{\\dagger} \\mathbf{M} \\boldsymbol{v}_{n}} $$\nThis relation represents the identity operator as a sum over projectors onto the right eigenvectors, weighted by the corresponding left eigenvectors and the matrix $\\mathbf{M}$.",
            "answer": "$$\n\\boxed{\\sum_{n=1}^{N} \\frac{\\boldsymbol{v}_{n} \\boldsymbol{w}_{n}^{\\dagger} \\mathbf{M}}{\\boldsymbol{w}_{n}^{\\dagger} \\mathbf{M} \\boldsymbol{v}_{n}}}\n$$"
        },
        {
            "introduction": "A robust numerical model is one that has been rigorously verified. For problems involving damping and impedance, where complex arithmetic is pervasive, ensuring your code is bug-free and correctly implemented is paramount. This final practice  introduces the Method of Manufactured Solutions (MMS), a powerful technique for code verification. You will design a test case with a known analytical solution to systematically assess the accuracy of a finite difference scheme, learning an indispensable skill for developing and validating computational acoustics software.",
            "id": "4129953",
            "problem": "Consider the one-dimensional frequency-domain acoustic pressure field governed by the linear Helmholtz equation with material damping modeled by a complex wavenumber. On a domain $[0,L]$ with outward unit normal pointing toward decreasing $x$ at $x=0$ and toward increasing $x$ at $x=L$, the model problem is\n$$\n\\frac{d^2 u}{dx^2} + k^2 u = f(x), \\quad x \\in (0,L),\n$$\nsubject to impedance boundary conditions at both ends,\n$$\n\\frac{\\partial u}{\\partial n}(0) + i k Z_0 u(0) = g_0, \\quad \\frac{\\partial u}{\\partial n}(L) + i k Z_L u(L) = g_L,\n$$\nwhere $u$ is the complex acoustic pressure amplitude, $k \\in \\mathbb{C}$ is the complex wavenumber (its imaginary part encodes material damping), $Z_0,Z_L \\in \\mathbb{C}$ are the normalized boundary impedances, and $i$ is the imaginary unit. The outward normal derivative is $\\frac{\\partial u}{\\partial n}(0)=-\\frac{du}{dx}(0)$ and $\\frac{\\partial u}{\\partial n}(L)=+\\frac{du}{dx}(L)$. Design a manufactured solution to verify a numerical codeâ€™s implementation of material damping and impedance absorption, and compute the observed order of accuracy.\n\nStarting from first principles appropriate for frequency-domain acoustics: the linearized continuity and momentum equations imply, after assuming harmonic time dependence with angular frequency $\\omega$ and eliminating velocity, a spatial Helmholtz equation with complex wavenumber $k$ that can represent attenuation when $\\operatorname{Im}(k)>0$. An impedance boundary condition enforces a proportionality between pressure and normal particle velocity, which, in this formulation, reduces to a Robin condition $\\frac{\\partial u}{\\partial n} + i k Z u = g$.\n\nYour tasks are:\n\n- Use the method of manufactured solutions to choose an exact solution $u_{\\text{ex}}(x)$ and derive the corresponding source term $f(x)$ and boundary data $g_0,g_L$ so that $u_{\\text{ex}}$ satisfies the model for arbitrary complex boundary impedances $Z_0,Z_L$.\n- Discretize the interior differential operator with a second-order centered finite difference on a uniform mesh of $N+1$ grid points with spacing $h=L/N$. Discretize the boundary normal derivatives with second-order one-sided finite differences. Assemble and solve the resulting linear system for the nodal values of $u$.\n- Compute the discrete $L^2$ error between the numerical solution and the exact manufactured solution,\n$$\n\\|e\\|_{h} = \\left( h \\sum_{j=0}^{N} \\left| u_j - u_{\\text{ex}}(x_j) \\right|^2 \\right)^{1/2},\n$$\nwhere $x_j = j h$. For a sequence of refinements with $N$ doubling, estimate the observed order of accuracy (OOA) between successive meshes as\n$$\np \\approx \\frac{\\log\\left(\\|e\\|_{h_1}/\\|e\\|_{h_2}\\right)}{\\log\\left(h_1/h_2\\right)}.\n$$\n\nManufactured solution design requirement:\n- Take $u_{\\text{ex}}(x) = e^{i k x}$, with $k \\in \\mathbb{C}$ given. Derive $f(x)$, $g_0$, and $g_L$ so that $u_{\\text{ex}}$ exactly satisfies the problem for arbitrary $Z_0,Z_L$.\n\nNumerical discretization requirement:\n- Interior points $x_j$ for $j=1,\\dots,N-1$ must use the standard second-order centered finite difference for $\\frac{d^2 u}{dx^2}$.\n- Boundary conditions must use second-order one-sided differences for the first derivative consistent with the outward normals at $x=0$ and $x=L$.\n\nTest suite:\nFor each test case below, use the specified parameters and grids, compute the $L^2$ errors on each grid, and report the observed order of accuracy computed between the last two refinements in each case.\n\n- Case $1$ (general, moderate damping and mixed impedances): $L=1$, $k = 20 + 2 i$, $Z_0 = 0.7 + 0.2 i$, $Z_L = 1.3 - 0.1 i$, with $N \\in \\{ 50, 100, 200, 400 \\}$.\n- Case $2$ (short domain, stronger damping): $L=0.2$, $k = 30 + 5 i$, $Z_0 = 2.0 + 0.0 i$, $Z_L = 0.5 + 0.5 i$, with $N \\in \\{ 40, 80, 160, 320 \\}$.\n- Case $3$ (weak damping, symmetric impedances): $L=1.0$, $k = 40 + 0.1 i$, $Z_0 = 1.0 + 0.0 i$, $Z_L = 1.0 + 0.0 i$, with $N \\in \\{ 80, 160, 320, 640 \\}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The $j$-th entry must be the observed order of accuracy for Case $j$, rounded to three decimal places, in the order of Cases $1,2,3$. For example: $\\left[ p_1, p_2, p_3 \\right]$ as a string like $[2.000,2.000,2.000]$.",
            "solution": "The problem requires the design and verification of a numerical method for the one-dimensional Helmholtz equation, which models time-harmonic acoustic pressure fields. The model includes material damping through a complex wavenumber and energy absorption at the boundaries via impedance conditions. The verification will be conducted using the Method of Manufactured Solutions (MMS).\n\nThe process consists of three main parts:\n1.  **Analytical Derivation**: An exact, or \"manufactured,\" solution is chosen. This solution is substituted into the governing partial differential equation (PDE) and boundary conditions (BCs) to derive the corresponding source term $f(x)$ and boundary data $g_0$ and $g_L$.\n2.  **Numerical Discretization**: The continuous problem is approximated by a system of linear algebraic equations using a finite difference method on a uniform grid.\n3.  **Verification**: The numerical scheme is implemented and solved for a sequence of refining grids. The error between the numerical and exact solutions is calculated, and the observed order of accuracy (OOA) is estimated to verify that the implementation achieves the theoretical convergence rate.\n\n**1. Derivation via Method of Manufactured Solutions**\n\nThe governing model on the domain $x \\in [0,L]$ is:\n$$\n\\frac{d^2 u}{dx^2} + k^2 u = f(x)\n$$\n$$\n-\\frac{du}{dx}(0) + i k Z_0 u(0) = g_0\n$$\n$$\n\\frac{du}{dx}(L) + i k Z_L u(L) = g_L\n$$\nHere, $k, Z_0, Z_L$ are complex constants, and the outward normal derivatives are correctly specified as $\\frac{\\partial u}{\\partial n}(0) = -\\frac{du}{dx}(0)$ and $\\frac{\\partial u}{\\partial n}(L) = \\frac{du}{dx}(L)$.\n\nWe are given the manufactured solution $u_{\\text{ex}}(x) = e^{i k x}$. We must find $f(x)$, $g_0$, and $g_L$ such that $u_{\\text{ex}}$ is the exact solution.\n\nFirst, we find the derivatives of $u_{\\text{ex}}$:\n$$\n\\frac{du_{\\text{ex}}}{dx} = \\frac{d}{dx}(e^{i k x}) = i k e^{i k x}\n$$\n$$\n\\frac{d^2 u_{\\text{ex}}}{dx^2} = \\frac{d}{dx}(i k e^{i k x}) = (i k)^2 e^{i k x} = -k^2 e^{i k x}\n$$\n\nTo find the source term $f(x)$, we substitute $u_{\\text{ex}}$ into the Helmholtz equation:\n$$\nf(x) = \\frac{d^2 u_{\\text{ex}}}{dx^2} + k^2 u_{\\text{ex}} = (-k^2 e^{i k x}) + k^2(e^{i k x}) = 0\n$$\nThus, the volume source term is identically zero, $f(x) \\equiv 0$.\n\nNext, we derive the boundary data $g_0$ and $g_L$.\nFor the boundary at $x=0$:\n$$\nu_{\\text{ex}}(0) = e^{i k (0)} = 1\n$$\n$$\n\\frac{du_{\\text{ex}}}{dx}(0) = i k e^{i k (0)} = i k\n$$\nSubstituting these into the boundary condition at $x=0$:\n$$\ng_0 = -\\frac{du_{\\text{ex}}}{dx}(0) + i k Z_0 u_{\\text{ex}}(0) = -(i k) + i k Z_0 (1) = i k (Z_0 - 1)\n$$\n\nFor the boundary at $x=L$:\n$$\nu_{\\text{ex}}(L) = e^{i k L}\n$$\n$$\n\\frac{du_{\\text{ex}}}{dx}(L) = i k e^{i k L}\n$$\nSubstituting these into the boundary condition at $x=L$:\n$$\ng_L = \\frac{du_{\\text{ex}}}{dx}(L) + i k Z_L u_{\\text{ex}}(L) = (i k e^{i k L}) + i k Z_L (e^{i k L}) = i k (1 + Z_L) e^{i k L}\n$$\nWith these derived terms $f(x)$, $g_0$, and $g_L$, the function $u_{\\text{ex}}(x) = e^{i k x}$ becomes the exact solution to the boundary value problem.\n\n**2. Finite Difference Discretization**\n\nWe discretize the domain $[0,L]$ with $N+1$ uniformly spaced grid points $x_j = j h$ for $j=0, 1, \\dots, N$, where the grid spacing is $h=L/N$. Let $u_j$ be the numerical approximation of $u(x_j)$.\n\nFor interior points $x_j$ where $j=1, \\dots, N-1$, we use a second-order centered difference for the second derivative:\n$$\n\\frac{d^2 u}{dx^2}(x_j) \\approx \\frac{u_{j-1} - 2u_j + u_{j+1}}{h^2}\n$$\nThe discretized PDE at an interior node is:\n$$\n\\frac{u_{j-1} - 2u_j + u_{j+1}}{h^2} + k^2 u_j = f(x_j) = 0\n$$\nMultiplying by $h^2$ and rearranging gives the equation for row $j$ of the linear system:\n$$\nu_{j-1} + (h^2 k^2 - 2)u_j + u_{j+1} = 0\n$$\n\nFor the boundary conditions, we use second-order one-sided finite differences for the first derivative.\n\nAt $x=0$ (node $j=0$), we use the second-order forward difference:\n$$\n\\frac{du}{dx}(0) \\approx \\frac{-3u_0 + 4u_1 - u_2}{2h}\n$$\nThe outward normal derivative is $\\frac{\\partial u}{\\partial n}(0) = -\\frac{du}{dx}(0) \\approx -(\\frac{-3u_0 + 4u_1 - u_2}{2h}) = \\frac{3u_0 - 4u_1 + u_2}{2h}$.\nThe discretized boundary condition at $x=0$ is:\n$$\n\\frac{3u_0 - 4u_1 + u_2}{2h} + i k Z_0 u_0 = g_0\n$$\nMultiplying by $2h$ gives the equation for the first row ($j=0$) of the system:\n$$\n(3 + 2h i k Z_0)u_0 - 4u_1 + u_2 = 2h g_0\n$$\n\nAt $x=L$ (node $j=N$), we use the second-order backward difference:\n$$\n\\frac{du}{dx}(L) \\approx \\frac{3u_N - 4u_{N-1} + u_{N-2}}{2h}\n$$\nThe outward normal derivative is $\\frac{\\partial u}{\\partial n}(L) = \\frac{du}{dx}(L)$.\nThe discretized boundary condition at $x=L$ is:\n$$\n\\frac{3u_N - 4u_{N-1} + u_{N-2}}{2h} + i k Z_L u_N = g_L\n$$\nMultiplying by $2h$ gives the equation for the last row ($j=N$) of the system:\n$$\nu_{N-2} - 4u_{N-1} + (3 + 2h i k Z_L)u_N = 2h g_L\n$$\n\nThese $N+1$ linear equations for the unknowns $u_0, u_1, \\dots, u_N$ form a matrix system $A\\mathbf{u} = \\mathbf{b}$, where $A$ is an $(N+1) \\times (N+1)$ complex matrix, $\\mathbf{u} = [u_0, \\dots, u_N]^T$ is the vector of numerical solutions, and $\\mathbf{b}$ is the right-hand side vector. This system can be solved using a standard linear algebra library.\n\n**3. Error Analysis and Order of Accuracy**\n\nOnce the numerical solution $\\mathbf{u} = [u_0, \\dots, u_N]^T$ has been computed, we evaluate the exact solution at the grid points: $\\mathbf{u}_{\\text{ex}} = [u_{\\text{ex}}(x_0), \\dots, u_{\\text{ex}}(x_N)]^T$.\nThe error is measured using the discrete $L^2$ norm:\n$$\n\\|e\\|_h = \\left( h \\sum_{j=0}^{N} |u_j - u_{\\text{ex}}(x_j)|^2 \\right)^{1/2}\n$$\nTo determine the observed order of accuracy (OOA), we compute this error for a sequence of two meshes, a coarser mesh with spacing $h_1$ and error $\\|e\\|_{h_1}$, and a finer mesh with spacing $h_2$ and error $\\|e\\|_{h_2}$. If the method is of order $p$, the error behaves as $\\|e\\|_h \\approx C h^p$ for some constant $C$. The OOA is then estimated as:\n$$\np \\approx \\frac{\\log(\\|e\\|_{h_1} / \\|e\\|_{h_2})}{\\log(h_1 / h_2)}\n$$\nFor the specified test cases, the mesh is refined by doubling $N$, which means $h_1/h_2 = 2$. The formula simplifies to:\n$$\np \\approx \\frac{\\log(\\|e\\|_{h_1} / \\|e\\|_{h_2})}{\\log(2)}\n$$\nSince all finite difference approximations used are second-order accurate, the expected OOA is $p=2$. The numerical implementation below will compute this value for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(L, k, Z0, ZL, N):\n    \"\"\"\n    Solves the 1D Helmholtz equation using a finite difference method\n    and returns the discrete L2 error against the manufactured solution.\n\n    Args:\n        L (float): Domain length.\n        k (complex): Wavenumber.\n        Z0 (complex): Impedance at x=0.\n        ZL (complex): Impedance at x=L.\n        N (int): Number of intervals in the grid.\n\n    Returns:\n        tuple: A tuple containing the L2 error (float) and grid spacing h (float).\n    \"\"\"\n    h = L / N\n    # Grid points from 0 to L\n    x = np.linspace(0, L, N + 1)\n\n    # Manufactured solution source terms\n    g0 = 1j * k * (Z0 - 1)\n    gL = 1j * k * (1 + ZL) * np.exp(1j * k * L)\n\n    # Initialize the linear system Ax = b\n    A = np.zeros((N + 1, N + 1), dtype=np.complex128)\n    b = np.zeros(N + 1, dtype=np.complex128)\n\n    # Row 0: Boundary condition at x=0\n    # (3 + 2*h*i*k*Z0)*u_0 - 4*u_1 + u_2 = 2*h*g0\n    A[0, 0] = 3.0 + 2.0 * h * 1j * k * Z0\n    A[0, 1] = -4.0\n    A[0, 2] = 1.0\n    b[0] = 2.0 * h * g0\n\n    # Rows 1 to N-1: Interior points (Helmholtz equation)\n    # u_{j-1} + (h^2*k^2 - 2)*u_j + u_{j+1} = 0\n    for j in range(1, N):\n        A[j, j - 1] = 1.0\n        A[j, j] = h**2 * k**2 - 2.0\n        A[j, j + 1] = 1.0\n        # b[j] is already 0.0\n\n    # Row N: Boundary condition at x=L\n    # u_{N-2} - 4*u_{N-1} + (3 + 2*h*i*k*ZL)*u_N = 2*h*gL\n    A[N, N - 2] = 1.0\n    A[N, N - 1] = -4.0\n    A[N, N] = 3.0 + 2.0 * h * 1j * k * ZL\n    b[N] = 2.0 * h * gL\n\n    # Solve the linear system\n    u_numerical = np.linalg.solve(A, b)\n\n    # Exact manufactured solution on the grid\n    u_exact = np.exp(1j * k * x)\n\n    # Compute the discrete L2 error\n    # ||e||_h = sqrt(h * sum(|u_num - u_ex|^2))\n    error_L2 = np.sqrt(h * np.sum(np.abs(u_numerical - u_exact)**2))\n\n    return error_L2, h\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and compute observed orders of accuracy.\n    \"\"\"\n    test_cases = [\n        # Case 1: general, moderate damping and mixed impedances\n        {'L': 1.0, 'k': 20.0 + 2.0j, 'Z0': 0.7 + 0.2j, 'ZL': 1.3 - 0.1j, 'N_list': [50, 100, 200, 400]},\n        # Case 2: short domain, stronger damping\n        {'L': 0.2, 'k': 30.0 + 5.0j, 'Z0': 2.0 + 0.0j, 'ZL': 0.5 + 0.5j, 'N_list': [40, 80, 160, 320]},\n        # Case 3: weak damping, symmetric impedances\n        {'L': 1.0, 'k': 40.0 + 0.1j, 'Z0': 1.0 + 0.0j, 'ZL': 1.0 + 0.0j, 'N_list': [80, 160, 320, 640]}\n    ]\n\n    results = []\n    for case in test_cases:\n        errors = []\n        h_values = []\n        for N in case['N_list']:\n            error, h = run_simulation(\n                case['L'], case['k'], case['Z0'], case['ZL'], N\n            )\n            errors.append(error)\n            h_values.append(h)\n        \n        # OOA is computed between the last two refinements\n        e1 = errors[-2]  # Coarser grid error\n        e2 = errors[-1]  # Finer grid error\n        h1 = h_values[-2] # Coarser grid spacing\n        h2 = h_values[-1] # Finer grid spacing\n\n        # OOA = log(e1/e2) / log(h1/h2)\n        # Since N doubles, h1/h2 is always 2\n        ooa = np.log(e1 / e2) / np.log(2.0)\n        results.append(f\"{ooa:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}