{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of understanding forced harmonic response is the single-degree-of-freedom (SDOF) oscillator. This exercise guides you through building this fundamental model for an acoustic radiator from first principles. By incorporating structural damping through the elegant formalism of a complex stiffness, you will discover how energy dissipation is mathematically represented and see its crucial role in taming the otherwise infinite response at resonance . This practice is essential for building an intuition for how real-world structures behave under harmonic excitation.",
            "id": "4124575",
            "problem": "Consider a single-degree-of-freedom (SDOF) acoustic radiator comprising a rigid circular piston of area $S$ mounted on a linear support with modal mass $m$ and modal stiffness $k$, radiating into a quiescent compressible fluid of density $\\rho_{0}$ and sound speed $c$ through an infinite rigid baffle. The piston is driven by a harmonic force $F(t)=\\Re\\{F_{0}e^{i\\omega t}\\}$, where $F_{0}\\in\\mathbb{C}$ and $\\omega>0$ is the angular frequency. The structural damping of the support is modeled by a small, frequency-independent structural loss factor $\\eta$, such that the constitutive relation for the restoring force is represented by an effective complex stiffness $k(1+i\\eta)$ with $0<\\eta\\ll 1$. The fluid loading due to radiation is assumed to be sufficiently weak that the mechanical resonance is dominated by the structural dynamics, and linear acoustics holds throughout.\n\nStarting solely from Newton’s second law, the linear time-harmonic ansatz, and the structural damping representation above, carry out a forced harmonic response analysis to:\n\n- Derive the homogeneous frequency condition that determines the complex resonance frequencies of the SDOF system in the presence of structural damping.\n- Show how the structural loss factor $\\eta$ modifies the complex resonance frequencies and reduces the acoustic radiation peaks by altering the steady-state velocity amplitude at resonance.\n- Quantify, to leading order in $\\eta$, the complex fractional shift of the resonance angular frequency from its undamped value $\\omega_{0}$, where $\\omega_{0}=\\sqrt{k/m}$.\n\nProvide your final answer as a single closed-form analytic expression for the fractional complex shift $\\Delta\\omega/\\omega_{0}$, where $\\Delta\\omega=\\tilde{\\omega}-\\omega_{0}$ and $\\tilde{\\omega}$ is the complex resonance angular frequency in the presence of structural damping. No numerical evaluation is required. Express the final answer without units.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It describes a standard single-degree-of-freedom (SDOF) system with hysteretic (structural) damping, a common model in mechanical vibrations and acoustics. All necessary parameters are provided, and the objective is clearly stated.\n\nLet $x(t)$ be the displacement of the piston from its equilibrium position. The system is driven by a harmonic force $F(t) = \\Re\\{F_0 e^{i\\omega t}\\}$. We adopt the linear time-harmonic ansatz for the displacement, $x(t) = \\Re\\{X_0 e^{i\\omega t}\\}$, where $X_0$ is the complex amplitude of the displacement. The velocity and acceleration are then $\\dot{x}(t) = \\Re\\{i\\omega X_0 e^{i\\omega t}\\}$ and $\\ddot{x}(t) = \\Re\\{-\\omega^2 X_0 e^{i\\omega t}\\}$, respectively.\n\nNewton's second law for the SDOF system is given by the balance of forces:\n$$ m \\ddot{x}(t) + F_{restoring}(t) = F(t) $$\nwhere $m\\ddot{x}(t)$ is the inertial force and $F_{restoring}(t)$ is the restoring force from the support.\n\nThe problem states that the support has a complex stiffness $k_{eff} = k(1+i\\eta)$. In the frequency domain, this means the complex amplitude of the restoring force, $F_{r,0}$, is related to the complex amplitude of the displacement, $X_0$, by $F_{r,0} = k(1+i\\eta)X_0$.\n\nBy substituting the complex representations of the forces and motion into Newton's second law, we obtain the equation of motion in the frequency domain:\n$$ m(-\\omega^2 X_0) + k(1+i\\eta)X_0 = F_0 $$\nThis can be rearranged to:\n$$ \\left( -m\\omega^2 + k(1+i\\eta) \\right) X_0 = F_0 $$\n\n### Derivation of the Homogeneous Frequency Condition\n\nThe complex resonance frequencies of the system correspond to the frequencies of free vibration, where the external force is zero ($F_0=0$). The homogeneous equation is:\n$$ \\left( -m\\omega^2 + k(1+i\\eta) \\right) X_0 = 0 $$\nFor a non-trivial solution ($X_0 \\neq 0$), the term in the parenthesis must be zero. Let $\\tilde{\\omega}$ denote the complex resonance angular frequency. The condition is:\n$$ -m\\tilde{\\omega}^2 + k(1+i\\eta) = 0 $$\nRearranging this equation gives the homogeneous frequency condition:\n$$ \\tilde{\\omega}^2 = \\frac{k}{m}(1+i\\eta) $$\nIntroducing the undamped natural angular frequency $\\omega_0 = \\sqrt{k/m}$, the condition becomes:\n$$ \\tilde{\\omega}^2 = \\omega_0^2(1+i\\eta) $$\n\n### Effect of the Structural Loss Factor $\\eta$\n\nThe presence of the structural loss factor $\\eta > 0$ makes the right-hand side of the frequency condition complex. Consequently, the resonance frequency $\\tilde{\\omega}$ must also be complex. Let $\\tilde{\\omega} = \\omega_r + i\\omega_i$. A complex frequency signifies that the system's free vibrations are not purely oscillatory but are damped sinusoids of the form $e^{i\\tilde{\\omega}t} = e^{-\\omega_i t} e^{i\\omega_r t}$. The positive imaginary part $\\omega_i > 0$ represents temporal decay, which is characteristic of a stable, energy-dissipating system.\n\nTo see how $\\eta$ reduces acoustic radiation peaks, we examine the steady-state velocity amplitude under forced excitation. The displacement amplitude is:\n$$ X_0(\\omega) = \\frac{F_0}{-m\\omega^2 + k(1+i\\eta)} = \\frac{F_0}{(k - m\\omega^2) + i k\\eta} $$\nThe velocity amplitude is $V_0(\\omega) = i\\omega X_0(\\omega)$. The magnitude of the velocity amplitude is:\n$$ |V_0(\\omega)| = \\frac{\\omega |F_0|}{|(k - m\\omega^2) + i k\\eta|} = \\frac{\\omega |F_0|}{\\sqrt{(k - m\\omega^2)^2 + (k\\eta)^2}} $$\nThe resonance peak in the response occurs at the frequency where the denominator is minimal. For the hysteretic damping model, the displacement amplitude $|X_0(\\omega)|$ is maximized when $k - m\\omega^2=0$, which occurs at $\\omega = \\sqrt{k/m} = \\omega_0$. At this frequency, the velocity amplitude is:\n$$ |V_0(\\omega_0)| = \\frac{\\omega_0 |F_0|}{\\sqrt{0^2 + (k\\eta)^2}} = \\frac{\\omega_0 |F_0|}{k\\eta} $$\nIn the absence of damping ($\\eta \\to 0$), the velocity amplitude at resonance would become infinite. The structural loss factor $\\eta$ makes the resonant velocity amplitude finite and inversely proportional to $\\eta$. Since the radiated acoustic power is proportional to the square of the piston velocity amplitude, the damping serves to limit the radiation peaks at resonance.\n\n### Quantification of the Complex Fractional Frequency Shift\n\nThe problem requires finding the complex fractional shift $\\Delta\\omega/\\omega_0$ to leading order in $\\eta$, where $\\Delta\\omega = \\tilde{\\omega} - \\omega_0$.\nFrom the homogeneous frequency condition, we have:\n$$ \\tilde{\\omega} = \\omega_0 \\sqrt{1+i\\eta} $$\nWe select the principal root, which has a positive real part, consistent with the definition of $\\omega_0>0$.\n\nThe fractional shift is given by:\n$$ \\frac{\\Delta\\omega}{\\omega_0} = \\frac{\\tilde{\\omega} - \\omega_0}{\\omega_0} = \\frac{\\tilde{\\omega}}{\\omega_0} - 1 = \\sqrt{1+i\\eta} - 1 $$\nSince we are given that $\\eta \\ll 1$, we can use the binomial series expansion for $(1+z)^n$ around $z=0$, where $z=i\\eta$ and $n=1/2$:\n$$ (1+z)^n = 1 + nz + \\frac{n(n-1)}{2!}z^2 + O(z^3) $$\nTo find the leading-order term of the shift, we need the expansion up to the first order in $z$:\n$$ (1+i\\eta)^{1/2} \\approx 1 + \\left(\\frac{1}{2}\\right)(i\\eta) $$\nSubstituting this approximation into the expression for the fractional shift:\n$$ \\frac{\\Delta\\omega}{\\omega_0} \\approx \\left(1 + i\\frac{\\eta}{2}\\right) - 1 $$\n$$ \\frac{\\Delta\\omega}{\\omega_0} \\approx i\\frac{\\eta}{2} $$\nThis expression represents the complex fractional shift to leading order in $\\eta$. The shift is purely imaginary at this order, indicating that to first order, the damping affects the decay rate of oscillations but not their frequency. The change in the real part of the frequency is of order $\\eta^2$, which can be seen by carrying the expansion to the next term: $(1+i\\eta)^{1/2} \\approx 1 + i\\frac{\\eta}{2} - \\frac{\\eta^2}{8}$. The shift would then be $\\frac{\\Delta\\omega}{\\omega_0} \\approx -\\frac{\\eta^2}{8} + i\\frac{\\eta}{2}$. The leading-order term is the one with the lowest power of $\\eta$, which is the imaginary term of order $\\eta^1$.",
            "answer": "$$\\boxed{i\\frac{\\eta}{2}}$$"
        },
        {
            "introduction": "Once we have a model for a resonant system, the next step is to characterize its behavior from its Frequency Response Function (FRF). This practice focuses on the quantitative analysis of a resonance peak, a dominant feature in the FRF of any lightly damped structure. By applying calculus to the FRF, you will derive expressions for the peak frequency and the half-power bandwidth—two of the most important metrics used in engineering to describe a resonance . This exercise also illuminates the distinction between a system's intrinsic properties, like natural frequency and damping, and the modal residue, which describes how strongly a mode is excited and observed.",
            "id": "4124574",
            "problem": "An acoustic cavity with weak distributed damping is driven by a time-harmonic monopole source of complex volume velocity amplitude $\\hat{Q}$ at angular frequency $\\omega$. The acoustic pressure field $p(\\mathbf{x},t)$ in the linear regime satisfies the inhomogeneous Helmholtz equation obtained from the linearized wave equation under steady-state harmonic forcing, and the scalar Frequency Response Function (FRF) $H(\\omega)$ between a source located at $\\mathbf{x}_s$ and a receiver at $\\mathbf{x}_r$ is defined by $p(\\mathbf{x}_r,t) = \\Re\\{H(\\omega)\\,\\hat{Q}\\,e^{i\\omega t}\\}$. Using separation of variables and the completeness of cavity eigenfunctions, the pressure FRF admits a convergent modal representation\n$$\nH(\\omega) \\;=\\; \\sum_{m=1}^{\\infty} \\frac{R_m}{\\omega_m^2 - \\omega^2 + i\\,2\\,\\zeta_m\\,\\omega_m\\,\\omega},\n$$\nwhere $\\omega_m$ is the undamped natural frequency of mode $m$, $\\zeta_m$ is its modal damping ratio, and $R_m$ is the complex modal residue encapsulating the source–receiver coupling through mode $m$.\n\nAssume a narrow frequency band around a single isolated mode $p$ dominates the response so that\n$$\nH(\\omega) \\;\\approx\\; \\frac{R}{\\omega_p^2 - \\omega^2 + i\\,2\\,\\zeta\\,\\omega_p\\,\\omega},\n$$\nwith $R \\equiv R_p$ a complex constant, $0<\\zeta\\ll 1$, and $\\omega_p>0$ fixed. Starting from the above physical model and the definitions of complex conjugation and magnitude, perform the following, strictly from first principles without invoking any pre-memorized resonance-location or bandwidth formulas:\n\n1) Differentiate the squared magnitude $|H(\\omega)|^2$ with respect to $\\omega$ and express $\\frac{d}{d\\omega}|H(\\omega)|^2$ explicitly in terms of $R$, $\\omega_p$, $\\zeta$, and $\\omega$. Use this to write the extremum condition $\\frac{d}{d\\omega}|H(\\omega)|^2=0$ and solve it to leading order in $\\zeta$ to obtain an asymptotic expression for the peak frequency $\\omega_{\\text{peak}}$ of $|H(\\omega)|$ near $\\omega_p$.\n\n2) Using the curvature of $|H(\\omega)|^2$ about $\\omega_{\\text{peak}}$, or equivalently by solving the half-power condition $|H(\\omega_{\\pm})|^2 = \\tfrac{1}{2}\\,|H(\\omega_{\\text{peak}})|^2$ to leading order in $\\zeta$, derive a first-order asymptotic estimate of the half-power bandwidth $\\Delta\\omega \\equiv \\omega_{+}-\\omega_{-}$ in terms of $\\omega_p$ and $\\zeta$.\n\n3) Interpret the role of the complex modal residue $R$ in the derivative $\\frac{d}{d\\omega}|H(\\omega)|^2$ and in the location of $\\omega_{\\text{peak}}$ and $\\Delta\\omega$; explain which features depend on $R$ and which do not, and why.\n\nFinally, for a specific acoustic mode with parameters $\\omega_p = 2\\pi \\times 800$ and $\\zeta = 0.015$, compute the numerical value of the half-power bandwidth $\\Delta\\omega$ in $\\mathrm{rad/s}$ using your first-order asymptotic estimate. Round your answer to four significant figures.\n\nProvide the single numerical value of $\\Delta\\omega$ in $\\mathrm{rad/s}$, rounded to four significant figures, as your final answer.",
            "solution": "The problem asks for the derivation of the peak frequency and half-power bandwidth for a single-mode approximation of a frequency response function (FRF), an interpretation of one of the model parameters, and a final numerical calculation. The analysis will be performed from first principles as stipulated.\n\nThe given single-mode approximation for the FRF is:\n$$\nH(\\omega) = \\frac{R}{\\omega_p^2 - \\omega^2 + i\\,2\\,\\zeta\\,\\omega_p\\,\\omega}\n$$\nwhere $R$ is a complex constant, $\\omega_p > 0$ is the undamped natural frequency, $\\zeta$ is the modal damping ratio satisfying $0 < \\zeta \\ll 1$, and $\\omega$ is the angular frequency.\n\nFirst, we establish the expression for the squared magnitude of the FRF, $|H(\\omega)|^2$. Using the definition $|z|^2 = z \\bar{z}$, where $\\bar{z}$ is the complex conjugate:\n$$\n|H(\\omega)|^2 = H(\\omega) \\overline{H(\\omega)} = \\frac{R}{\\omega_p^2 - \\omega^2 + i\\,2\\,\\zeta\\,\\omega_p\\,\\omega} \\cdot \\frac{\\overline{R}}{\\omega_p^2 - \\omega^2 - i\\,2\\,\\zeta\\,\\omega_p\\,\\omega}\n$$\n$$\n|H(\\omega)|^2 = \\frac{|R|^2}{(\\omega_p^2 - \\omega^2)^2 + (2\\,\\zeta\\,\\omega_p\\,\\omega)^2}\n$$\nFor convenience, let the denominator be $D(\\omega) = (\\omega_p^2 - \\omega^2)^2 + 4\\,\\zeta^2\\,\\omega_p^2\\,\\omega^2$.\n\n**1) Derivation of the Peak Frequency $\\omega_{\\text{peak}}$**\n\nThe peak frequency $\\omega_{\\text{peak}}$ is the frequency at which $|H(\\omega)|$, and thus $|H(\\omega)|^2$, is maximum. Since the numerator $|R|^2$ is a positive constant with respect to $\\omega$, maximizing $|H(\\omega)|^2$ is equivalent to minimizing the denominator $D(\\omega)$. To find the minimum of $D(\\omega)$, we must find the roots of its derivative with respect to $\\omega$.\n\nThe derivative of $D(\\omega)$ is:\n$$\n\\frac{dD}{d\\omega} = \\frac{d}{d\\omega}\\left[ (\\omega_p^2 - \\omega^2)^2 + 4\\,\\zeta^2\\,\\omega_p^2\\,\\omega^2 \\right]\n$$\n$$\n\\frac{dD}{d\\omega} = 2(\\omega_p^2 - \\omega^2)(-2\\omega) + 4\\,\\zeta^2\\,\\omega_p^2(2\\omega)\n$$\n$$\n\\frac{dD}{d\\omega} = -4\\omega(\\omega_p^2 - \\omega^2) + 8\\,\\zeta^2\\,\\omega_p^2\\,\\omega = 4\\omega \\left[ -(\\omega_p^2 - \\omega^2) + 2\\,\\zeta^2\\,\\omega_p^2 \\right]\n$$\n$$\n\\frac{dD}{d\\omega} = 4\\omega \\left[ \\omega^2 - \\omega_p^2(1 - 2\\,\\zeta^2) \\right]\n$$\nThe derivative of the squared magnitude is then:\n$$\n\\frac{d}{d\\omega}|H(\\omega)|^2 = \\frac{d}{d\\omega} \\left( \\frac{|R|^2}{D(\\omega)} \\right) = -|R|^2 \\frac{1}{D(\\omega)^2} \\frac{dD}{d\\omega} = - \\frac{4\\omega|R|^2 \\left[ \\omega^2 - \\omega_p^2(1 - 2\\,\\zeta^2) \\right]}{\\left( (\\omega_p^2 - \\omega^2)^2 + 4\\,\\zeta^2\\,\\omega_p^2\\,\\omega^2 \\right)^2}\n$$\nThe extremum condition $\\frac{d}{d\\omega}|H(\\omega)|^2 = 0$ requires the numerator to be zero. Since we are interested in a peak near $\\omega_p > 0$, we assume $\\omega \\neq 0$. The condition simplifies to:\n$$\n\\omega^2 - \\omega_p^2(1 - 2\\,\\zeta^2) = 0\n$$\nSolving for $\\omega$ gives the exact peak frequency $\\omega_{\\text{peak}}$:\n$$\n\\omega_{\\text{peak}}^2 = \\omega_p^2(1 - 2\\,\\zeta^2) \\implies \\omega_{\\text{peak}} = \\omega_p \\sqrt{1 - 2\\,\\zeta^2}\n$$\nSince $\\zeta \\ll 1$, we can use the binomial approximation $(1-x)^a \\approx 1-ax$ for small $x$. With $x=2\\zeta^2$ and $a=1/2$, the asymptotic expression for $\\omega_{\\text{peak}}$ to leading order in $\\zeta^2$ is:\n$$\n\\omega_{\\text{peak}} \\approx \\omega_p \\left(1 - \\frac{1}{2}(2\\,\\zeta^2)\\right) = \\omega_p (1 - \\zeta^2)\n$$\nThis frequency is often called the damped natural frequency. The shift from $\\omega_p$ is of order $\\zeta^2$, which is very small for weak damping.\n\n**2) Derivation of the Half-Power Bandwidth $\\Delta\\omega$**\n\nThe half-power frequencies $\\omega_{\\pm}$ are defined by the condition $|H(\\omega_{\\pm})|^2 = \\frac{1}{2}|H(\\omega_{\\text{peak}})|^2$.\nFirst, let's evaluate $|H(\\omega_{\\text{peak}})|^2$. We found $D(\\omega)$ is minimized at $\\omega_{\\text{peak}}$. Using $\\omega_{\\text{peak}}^2 = \\omega_p^2(1 - 2\\,\\zeta^2)$, we have $\\omega_p^2 - \\omega_{\\text{peak}}^2 = 2\\,\\zeta^2\\,\\omega_p^2$.\nThe denominator at the peak is:\n$$\nD(\\omega_{\\text{peak}}) = (2\\,\\zeta^2\\,\\omega_p^2)^2 + 4\\,\\zeta^2\\,\\omega_p^2\\,\\omega_{\\text{peak}}^2 = 4\\,\\zeta^4\\,\\omega_p^4 + 4\\,\\zeta^2\\,\\omega_p^2 \\left( \\omega_p^2(1 - 2\\,\\zeta^2) \\right)\n$$\n$$\nD(\\omega_{\\text{peak}}) = 4\\,\\zeta^4\\,\\omega_p^4 + 4\\,\\zeta^2\\,\\omega_p^4 - 8\\,\\zeta^4\\,\\omega_p^4 = 4\\,\\zeta^2\\,\\omega_p^4(1-\\zeta^2)\n$$\nFor a first-order estimate in $\\zeta$, we can use the approximation that the peak occurs very near $\\omega_p$, i.e., $\\omega_{\\text{peak}} \\approx \\omega_p$. The peak magnitude squared is then approximated as:\n$$\n|H(\\omega_{\\text{peak}})|^2 \\approx |H(\\omega_p)|^2 = \\frac{|R|^2}{(\\omega_p^2 - \\omega_p^2)^2 + 4\\,\\zeta^2\\,\\omega_p^2\\,\\omega_p^2} = \\frac{|R|^2}{4\\,\\zeta^2\\,\\omega_p^4}\n$$\nThe half-power condition becomes:\n$$\n|H(\\omega_{\\pm})|^2 = \\frac{|R|^2}{(\\omega_p^2 - \\omega_{\\pm}^2)^2 + 4\\,\\zeta^2\\,\\omega_p^2\\,\\omega_{\\pm}^2} = \\frac{1}{2} \\frac{|R|^2}{4\\,\\zeta^2\\,\\omega_p^4} = \\frac{|R|^2}{8\\,\\zeta^2\\,\\omega_p^4}\n$$\nThis implies:\n$$\n(\\omega_p^2 - \\omega_{\\pm}^2)^2 + 4\\,\\zeta^2\\,\\omega_p^2\\,\\omega_{\\pm}^2 = 8\\,\\zeta^2\\,\\omega_p^4\n$$\nWe seek solutions $\\omega_{\\pm}$ near $\\omega_p$. We can make the following approximations, valid for $\\omega \\approx \\omega_p$:\n1. $\\omega_p^2 - \\omega^2 = (\\omega_p - \\omega)(\\omega_p + \\omega) \\approx (\\omega_p - \\omega)(2\\omega_p)$.\n2. In the damping term, which is already small due to the factor $\\zeta^2$, we can approximate $\\omega_{\\pm} \\approx \\omega_p$.\nSubstituting these into the equation:\n$$\n\\left( (\\omega_p - \\omega_{\\pm})(2\\omega_p) \\right)^2 + 4\\,\\zeta^2\\,\\omega_p^2(\\omega_p^2) \\approx 8\\,\\zeta^2\\,\\omega_p^4\n$$\n$$\n4\\omega_p^2(\\omega_p - \\omega_{\\pm})^2 + 4\\,\\zeta^2\\,\\omega_p^4 \\approx 8\\,\\zeta^2\\,\\omega_p^4\n$$\n$$\n4\\omega_p^2(\\omega_p - \\omega_{\\pm})^2 \\approx 4\\,\\zeta^2\\,\\omega_p^4\n$$\n$$\n(\\omega_p - \\omega_{\\pm})^2 \\approx \\zeta^2\\,\\omega_p^2\n$$\nTaking the square root gives:\n$$\n\\omega_p - \\omega_{\\pm} \\approx \\pm \\zeta\\omega_p \\implies \\omega_{\\pm} \\approx \\omega_p \\mp \\zeta\\omega_p\n$$\nThus, the two half-power frequencies are $\\omega_{+} = \\omega_p + \\zeta\\omega_p$ and $\\omega_{-} = \\omega_p - \\zeta\\omega_p$.\nThe half-power bandwidth $\\Delta\\omega$ is the difference between these two frequencies:\n$$\n\\Delta\\omega = \\omega_{+} - \\omega_{-} = (\\omega_p + \\zeta\\omega_p) - (\\omega_p - \\zeta\\omega_p) = 2\\zeta\\omega_p\n$$\nThis is the first-order asymptotic estimate for the bandwidth.\n\n**3) Interpretation of the Role of the Complex Modal Residue $R$**\n\nThe complex modal residue $R$ appears in the expression for the FRF as a multiplicative constant. Let $R = |R|e^{i\\phi_R}$.\n\nThe derivative $\\frac{d}{d\\omega}|H(\\omega)|^2$ contains the term $|R|^2$ as a simple multiplicative factor. The extremum condition $\\frac{d}{d\\omega}|H(\\omega)|^2=0$ leads to the equation $\\omega^2 - \\omega_p^2(1 - 2\\,\\zeta^2) = 0$. This equation, which determines the peak frequency $\\omega_{\\text{peak}}$, is completely independent of $R$ (both its magnitude and phase).\n\nSimilarly, the half-power condition $|H(\\omega_{\\pm})|^2 = \\frac{1}{2}|H(\\omega_{\\text{peak}})|^2$ can be written as $\\frac{|R|^2}{D(\\omega_{\\pm})} = \\frac{1}{2} \\frac{|R|^2}{D(\\omega_{\\text{peak}})}$. The term $|R|^2$ cancels from both sides, leaving an equation $D(\\omega_{\\pm}) = 2D(\\omega_{\\text{peak}})$ that depends only on the denominator parameters $\\omega_p$ and $\\zeta$. Therefore, the half-power frequencies $\\omega_{\\pm}$ and the resulting bandwidth $\\Delta\\omega$ are also independent of $R$.\n\nThe role of $R$ is as follows:\n- The magnitude $|R|$ acts as a scaling factor for the entire amplitude response. The peak amplitude is $|H(\\omega_{\\text{peak}})| \\approx \\frac{|R|}{2\\zeta\\omega_p^2}$. Thus, $|R|$ determines the height of the resonance peak but not its location or relative width. Physically, it represents the strength of the coupling between the source, the receiver, and the mode.\n- The phase $\\phi_R$ of the complex residue $R$ adds a constant phase offset to the overall phase response of the system, $\\arg(H(\\omega)) = \\phi_R - \\arctan\\left(\\frac{2\\zeta\\omega_p\\omega}{\\omega_p^2 - \\omega^2}\\right)$. It does not affect the magnitude response curve.\n\nIn summary, the shape of the normalized resonance curve (i.e., its center frequency and relative width) is determined by the system's intrinsic properties $\\omega_p$ and $\\zeta$. The residue $R$ determines the absolute amplitude and phase of the response at a specific source-receiver pair.\n\n**4) Numerical Calculation of Half-Power Bandwidth $\\Delta\\omega$**\n\nGiven the parameters:\n- Natural frequency $\\omega_p = 2\\pi \\times 800 \\, \\mathrm{rad/s}$\n- Damping ratio $\\zeta = 0.015$\n\nUsing the derived first-order asymptotic estimate for the half-power bandwidth:\n$$\n\\Delta\\omega = 2\\zeta\\omega_p\n$$\nSubstituting the numerical values:\n$$\n\\Delta\\omega = 2 \\times 0.015 \\times (2\\pi \\times 800)\n$$\n$$\n\\Delta\\omega = 0.03 \\times 1600\\pi\n$$\n$$\n\\Delta\\omega = 48\\pi\n$$\nNow, we compute the numerical value and round to four significant figures:\n$$\n\\Delta\\omega \\approx 150.796447... \\, \\mathrm{rad/s}\n$$\nRounding to four significant figures gives:\n$$\n\\Delta\\omega \\approx 150.8 \\, \\mathrm{rad/s}\n$$",
            "answer": "$$\\boxed{150.8}$$"
        },
        {
            "introduction": "This practice bridges the gap between analytical theory and computational reality. While the previous exercises analyzed a clean, analytical FRF, real-world systems are often too complex for such formulas, requiring numerical simulation. This exercise challenges you to design an adaptive algorithm to efficiently and accurately capture the sharp resonance peaks we have studied, a central task in computational acoustics . By using the function's own curvature to guide mesh refinement, you will implement a \"smart\" frequency sweep that concentrates computational effort only where it's needed, a powerful technique used in modern simulation software.",
            "id": "4124586",
            "problem": "You are asked to design and implement an adaptive frequency sweep for forced harmonic response analysis in computational acoustics. The objective is to refine sampling near peaks of the magnitude of the transfer function by monitoring curvature of the magnitude and to quantify interpolation error. The algorithm must be tested on a set of cases and produce a single line of output in the prescribed format.\n\nBegin from linear acoustics fundamentals. Consider the linear wave equation for acoustic pressure, $$\\nabla^2 p(\\mathbf{x},t) - \\frac{1}{c^2}\\frac{\\partial^2 p(\\mathbf{x},t)}{\\partial t^2} = s(\\mathbf{x},t),$$ where $p$ is acoustic pressure, $c$ is sound speed, and $s$ is a source term. For time-harmonic forcing with angular frequency $\\omega$ satisfying $s(\\mathbf{x},t) = \\Re\\{S(\\mathbf{x}) e^{i \\omega t}\\}$, a steady-state response can be sought of the form $p(\\mathbf{x},t) = \\Re\\{P(\\mathbf{x},\\omega) e^{i \\omega t}\\}$. A standard finite element or modal decomposition of the governing equations yields a linear time-invariant (LTI) second-order system in the frequency domain, $$(-\\omega^2 \\mathbf{M} + i \\omega \\mathbf{C} + \\mathbf{K}) \\mathbf{q}(\\omega) = \\mathbf{f},$$ where $\\mathbf{M}$ is the mass matrix, $\\mathbf{C}$ is the damping matrix, $\\mathbf{K}$ is the stiffness matrix, $\\mathbf{q}(\\omega)$ are modal coordinates, and $\\mathbf{f}$ is the forcing vector. Under modal diagonalization, the forced harmonic response from a scalar input to a scalar output can be represented as a sum of single-degree-of-freedom modal contributions. The scalar transfer function $H(\\omega)$ from input amplitude to output pressure can therefore be represented as $$H(\\omega) = \\sum_{m=1}^{M} \\frac{A_m}{\\omega_m^2 - \\omega^2 + i\\,2 \\zeta_m \\omega_m \\omega},$$ where $A_m$ are real scalar coupling coefficients that encapsulate mode shapes and input-output coupling, $\\omega_m$ are natural angular frequencies (in $\\mathrm{rad/s}$), and $\\zeta_m$ are dimensionless modal damping ratios. The quantity of interest is the magnitude $$|H(\\omega)| = \\left|\\sum_{m=1}^{M} \\frac{A_m}{\\omega_m^2 - \\omega^2 + i\\,2 \\zeta_m \\omega_m \\omega}\\right|.$$\n\nYour task is to implement an adaptive frequency sweep algorithm that samples $\\omega$ over a prescribed interval, refines sampling near peaks by monitoring the curvature of $|H(\\omega)|$, and quantifies interpolation error. The curvature proxy is taken as the absolute value of the second derivative with respect to $\\omega$ of the magnitude, i.e., $$C(\\omega) = \\left|\\frac{\\mathrm{d}^2}{\\mathrm{d}\\omega^2} |H(\\omega)|\\right|.$$ You must discretize $\\omega$, compute $|H(\\omega)|$ on that grid, and estimate the second derivative on a nonuniform grid using a three-point central finite difference formula. For points $\\omega_{i-1}$, $\\omega_i$, and $\\omega_{i+1}$ with corresponding function values $f_{i-1} = |H(\\omega_{i-1})|$, $f_i = |H(\\omega_i)|$, and $f_{i+1} = |H(\\omega_{i+1})|$, the nonuniform central approximation to the second derivative at $\\omega_i$ is\n$$f''(\\omega_i) \\approx \\frac{2}{\\omega_{i+1}-\\omega_{i-1}} \\left( \\frac{f_{i+1}-f_i}{\\omega_{i+1}-\\omega_i} - \\frac{f_i-f_{i-1}}{\\omega_i-\\omega_{i-1}} \\right).$$\nUse this to construct interval-wise curvature proxies. For an interval $[\\omega_i, \\omega_{i+1}]$ of length $h = \\omega_{i+1}-\\omega_i$, define the interval curvature proxy $C_{i,i+1}$ as the maximum of the adjacent pointwise curvature estimates,\n$$C_{i,i+1} = \\max\\left( |f''(\\omega_i)|, |f''(\\omega_{i+1})| \\right).$$\n\nYou must also quantify the interpolation error of piecewise linear interpolation of $|H(\\omega)|$. Provide both an error bound and an empirical error estimate. For a twice continuously differentiable function, the linear interpolation error on an interval of length $h$ admits the bound\n$$E_{\\mathrm{bound}} \\le \\frac{h^2}{8} \\max_{\\xi \\in [\\omega_i,\\omega_{i+1}]} \\left| f''(\\xi) \\right|.$$\nUse $C_{i,i+1}$ to approximate the maximum second derivative on the interval and compute the bound\n$$E_{\\mathrm{bound},i} = \\frac{h^2}{8} C_{i,i+1}.$$\nCompute an empirical error by comparing the exact midpoint value to the linear interpolant at the midpoint,\n$$E_{\\mathrm{mid},i} = \\left| f\\!\\left(\\frac{\\omega_i+\\omega_{i+1}}{2}\\right) - \\frac{f_i+f_{i+1}}{2} \\right|.$$\n\nAdaptive refinement rule: starting from an initial uniform grid of $N_0$ points in $[\\omega_{\\min}, \\omega_{\\max}]$, iteratively insert midpoints into any interval $[\\omega_i,\\omega_{i+1}]$ that violates either of the following two criteria:\n- Curvature criterion: $$C_{i,i+1} \\cdot h > \\kappa_{\\mathrm{thresh}},$$ where $\\kappa_{\\mathrm{thresh}}$ is a given threshold (units consistent with $|H|$ times $\\mathrm{s}$).\n- Error criterion: $$E_{\\mathrm{bound},i} > \\varepsilon_{\\mathrm{thresh}},$$ where $\\varepsilon_{\\mathrm{thresh}}$ is a given bound threshold (dimensionless since $|H|$ is dimensionless).\n\nTerminate when no interval violates the criteria or when a prescribed maximum number of points $N_{\\max}$ is reached. Track the total number of refinements performed. All angular frequencies must be treated in radians per second (in $\\mathrm{rad/s}$), and all calculations of angles must be in radians.\n\nImplement the algorithm and apply it to the following test suite. In all cases, use the transfer function\n$$H(\\omega) = \\sum_{m=1}^{M} \\frac{A_m}{\\omega_m^2 - \\omega^2 + i\\,2 \\zeta_m \\omega_m \\omega},$$\nwith the parameters specified below. For each case, report the following per-case results as a list of four entries: the final number of frequency samples $N_{\\mathrm{final}}$ (an integer), the maximum bound on interpolation error $\\max_i E_{\\mathrm{bound},i}$ (a float), the maximum empirical midpoint interpolation error $\\max_i E_{\\mathrm{mid},i}$ (a float), and the total number of refinements performed $N_{\\mathrm{refine}}$ (an integer).\n\nCase $1$: single lightly damped mode near the center.\n- Modal parameters: $M = 1$, $\\omega_1 = 1000\\,\\mathrm{rad/s}$, $\\zeta_1 = 0.01$, $A_1 = 1.0$.\n- Sweep range: $\\omega_{\\min} = 500\\,\\mathrm{rad/s}$, $\\omega_{\\max} = 1500\\,\\mathrm{rad/s}$.\n- Initial grid size: $N_0 = 16$.\n- Thresholds: $\\kappa_{\\mathrm{thresh}} = 0.5$, $\\varepsilon_{\\mathrm{thresh}} = 0.005$.\n- Maximum number of points: $N_{\\max} = 500$.\n\nCase $2$: two closely spaced modes to stress refinement near overlapping resonances.\n- Modal parameters: $M = 2$, $\\omega_1 = 900\\,\\mathrm{rad/s}$, $\\omega_2 = 950\\,\\mathrm{rad/s}$, $\\zeta_1 = 0.02$, $\\zeta_2 = 0.02$, $A_1 = 1.0$, $A_2 = 0.8$.\n- Sweep range: $\\omega_{\\min} = 800\\,\\mathrm{rad/s}$, $\\omega_{\\max} = 1100\\,\\mathrm{rad/s}$.\n- Initial grid size: $N_0 = 16$.\n- Thresholds: $\\kappa_{\\mathrm{thresh}} = 0.8$, $\\varepsilon_{\\mathrm{thresh}} = 0.003$.\n- Maximum number of points: $N_{\\max} = 600$.\n\nCase $3$: single heavily damped mode yielding broad, low-curvature response.\n- Modal parameters: $M = 1$, $\\omega_1 = 1000\\,\\mathrm{rad/s}$, $\\zeta_1 = 0.20$, $A_1 = 1.0$.\n- Sweep range: $\\omega_{\\min} = 500\\,\\mathrm{rad/s}$, $\\omega_{\\max} = 1500\\,\\mathrm{rad/s}$.\n- Initial grid size: $N_0 = 16$.\n- Thresholds: $\\kappa_{\\mathrm{thresh}} = 0.5$, $\\varepsilon_{\\mathrm{thresh}} = 0.010$.\n- Maximum number of points: $N_{\\max} = 400$.\n\nCase $4$: three modes widely spaced within a broader band.\n- Modal parameters: $M = 3$, $\\omega_1 = 600\\,\\mathrm{rad/s}$, $\\omega_2 = 1200\\,\\mathrm{rad/s}$, $\\omega_3 = 1800\\,\\mathrm{rad/s}$, $\\zeta_1 = 0.015$, $\\zeta_2 = 0.030$, $\\zeta_3 = 0.015$, $A_1 = 1.0$, $A_2 = 0.5$, $A_3 = 0.7$.\n- Sweep range: $\\omega_{\\min} = 400\\,\\mathrm{rad/s}$, $\\omega_{\\max} = 2000\\,\\mathrm{rad/s}$.\n- Initial grid size: $N_0 = 16$.\n- Thresholds: $\\kappa_{\\mathrm{thresh}} = 0.6$, $\\varepsilon_{\\mathrm{thresh}} = 0.005$.\n- Maximum number of points: $N_{\\max} = 700$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each per-case result must itself be a list in the order $[N_{\\mathrm{final}}, \\max_i E_{\\mathrm{bound},i}, \\max_i E_{\\mathrm{mid},i}, N_{\\mathrm{refine}}]$. For example, the output format must look like $$[ [n_1, e_{b,1}, e_{m,1}, r_1], [n_2, e_{b,2}, e_{m,2}, r_2], [n_3, e_{b,3}, e_{m,3}, r_3], [n_4, e_{b,4}, e_{m,4}, r_4] ],$$ where $n_k$ are integers and $e_{b,k}$ and $e_{m,k}$ are floats. All angular frequencies must be in $\\mathrm{rad/s}$ and angles in radians. The interpolation errors are dimensionless.",
            "solution": "The user has requested the design and implementation of an adaptive frequency sweep algorithm for forced harmonic response analysis. The problem is scientifically valid, well-posed, and provides all necessary information to construct a solution. The core of the problem lies in numerically implementing an iterative grid refinement strategy based on local curvature and interpolation error estimates.\n\nThe physical system is modeled by a scalar transfer function $H(\\omega)$, which represents the frequency-dependent ratio of a scalar output (e.g., acoustic pressure at a point) to a scalar input for a linear time-invariant system. This function is given as a sum of modal responses:\n$$H(\\omega) = \\sum_{m=1}^{M} \\frac{A_m}{\\omega_m^2 - \\omega^2 + i\\,2 \\zeta_m \\omega_m \\omega}$$\nHere, $\\omega$ is the angular frequency, $A_m$ are real-valued coupling coefficients, $\\omega_m$ are the system's natural frequencies, and $\\zeta_m$ are the modal damping ratios. The objective is to accurately and efficiently compute the magnitude of this function, $|H(\\omega)|$, across a specified frequency range $[\\omega_{\\min}, \\omega_{\\max}]$. The challenge is that $|H(\\omega)|$ exhibits sharp peaks (resonances) near the natural frequencies $\\omega_m$, especially for small damping ratios $\\zeta_m$. A uniform frequency grid would be inefficient, either being too coarse to capture the peaks or wastefully dense in flat regions.\n\nThe proposed algorithm addresses this by adaptively refining the frequency grid. The process starts with a coarse, uniform grid and iteratively inserts new points into intervals where the function $|H(\\omega)|$ is changing most rapidly, i.e., where its curvature is high or where the linear interpolation error is large.\n\nThe algorithm proceeds as follows:\n\n1.  **Initialization**: A grid of $N_0$ equally spaced frequency points is created over the interval $[\\omega_{\\min}, \\omega_{\\max}]$. The function magnitude $|H(\\omega)|$ is evaluated at each of these points. A counter for the number of refinements, $N_{\\mathrm{refine}}$, is initialized to $0$.\n\n2.  **Curvature Estimation**: The key to the adaptive strategy is estimating the local curvature of the function magnitude, which we denote as $f(\\omega) = |H(\\omega)|$. The curvature is related to the second derivative, $f''(\\omega)$. For a non-uniform grid of points $\\omega_{i-1}, \\omega_i, \\omega_{i+1}$, the second derivative at the central point $\\omega_i$ is approximated using a three-point central finite difference formula:\n    $$f''(\\omega_i) \\approx \\frac{2}{\\omega_{i+1}-\\omega_{i-1}} \\left( \\frac{f(\\omega_{i+1})-f(\\omega_i)}{\\omega_{i+1}-\\omega_i} - \\frac{f(\\omega_i)-f(\\omega_{i-1})}{\\omega_i-\\omega_{i-1}} \\right)$$\n    This formula is applied to all interior points of the grid. For the purpose of evaluating the refinement criteria at the boundary-adjacent intervals, a pragmatic approach is taken. The curvature at the domain endpoints $\\omega_0$ and $\\omega_{N-1}$ is not defined by this formula. Therefore, for an interval $[\\omega_i, \\omega_{i+1}]$ of length $h = \\omega_{i+1}-\\omega_i$, the interval curvature proxy, $C_{i,i+1}$, is defined as:\n    $$\n    C_{i,i+1} =\n    \\begin{cases}\n    |f''(\\omega_{1})| & \\text{if } i=0 \\\\\n    |f''(\\omega_{N-2})| & \\text{if } i=N-2 \\\\\n    \\max\\left( |f''(\\omega_i)|, |f''(\\omega_{i+1})| \\right) & \\text{otherwise}\n    \\end{cases}\n    $$\n    This proxy serves as a conservative estimate of the maximum curvature within the interval.\n\n3.  **Refinement Criteria**: An interval $[\\omega_i, \\omega_{i+1}]$ is flagged for refinement if it violates either of two conditions:\n    -   A curvature-based criterion: $C_{i,i+1} \\cdot (\\omega_{i+1}-\\omega_i) > \\kappa_{\\mathrm{thresh}}$. This condition identifies intervals where the curvature is high relative to the interval's width.\n    -   An error-bound criterion: $E_{\\mathrm{bound},i} > \\varepsilon_{\\mathrm{thresh}}$. The error bound for linear interpolation on the interval is given by $E_{\\mathrm{bound},i} = \\frac{(\\omega_{i+1}-\\omega_i)^2}{8} C_{i,i+1}$. This directly targets intervals where the estimated interpolation error exceeds a specified tolerance.\n\n4.  **Iterative Refinement**: The algorithm enters a loop. In each iteration, it identifies all intervals that meet the refinement criteria. If no such intervals exist, the grid is considered sufficiently refined, and the loop terminates. The loop also terminates if the number of points in the grid has reached the prescribed maximum, $N_{\\max}$. If refinement is to proceed, a new point is inserted at the midpoint of each flagged interval. The value of $|H(\\omega)|$ is computed at each new point. The total count of inserted points, $N_{\\mathrm{refine}}$, is updated. To ensure correct indexing when inserting into the list of points, the flagged intervals are processed in reverse order of their indices.\n\n5.  **Termination and Final Analysis**: Once the iterative refinement loop terminates, a final analysis is performed on the resulting grid.\n    -   The final number of points is $N_{\\mathrm{final}}$.\n    -   The maximum theoretical interpolation error bound, $\\max_i E_{\\mathrm{bound},i}$, is calculated over all final intervals.\n    -   A more direct measure of error, the maximum empirical midpoint error, $\\max_i E_{\\mathrm{mid},i}$, is also computed. For each interval $[\\omega_i, \\omega_{i+1}]$, this is the absolute difference between the true function value at the midpoint and the value predicted by linear interpolation:\n        $$E_{\\mathrm{mid},i} = \\left| f\\!\\left(\\frac{\\omega_i+\\omega_{i+1}}{2}\\right) - \\frac{f(\\omega_i)+f(\\omega_{i+1})}{2} \\right|$$\n    The results for each test case consist of the four quantities: $N_{\\mathrm{final}}$, $\\max_i E_{\\mathrm{bound},i}$, $\\max_i E_{\\mathrm{mid},i}$, and $N_{\\mathrm{refine}}$.\nThis principle-based design ensures that computational effort is focused on the regions of the frequency spectrum where it is most needed, yielding an accurate representation of the transfer function's magnitude with an efficient number of function evaluations.",
            "answer": "$$[[111, 0.00499690130985474, 0.001614051084252329, 95], [105, 0.00299611277156942, 0.0008542031023714243, 89], [16, 0.00940540453303101, 0.002353347072551532, 0], [185, 0.004997092984021267, 0.0013775924765660604, 169]]$$"
        }
    ]
}