{
    "hands_on_practices": [
        {
            "introduction": "在进行任何计算声学仿真之前，首要任务是将物理现象转化为一个精确的数学边值问题。本练习  将指导你完成这一关键步骤，从最基本的物理定律出发，推导出频域亥姆霍兹方程。更重要的是，它将展示如何对一个符合物理实际的阻抗边界条件进行建模，并将其转化为适用于数值求解器的无量纲形式，从而揭示亥姆霍兹数 $\\kappa$ 等关键参数的作用。",
            "id": "4142381",
            "problem": "一个静止的均匀流体，其平衡质量密度为 $\\,\\rho_{0}\\,$，绝热声速为 $\\,c_{0}\\,$，占据一个有界域 $\\,\\Omega \\subset \\mathbb{R}^{3}\\,$。该域的边界为 $\\,\\Gamma\\,$，其上的外向单位法向量为 $\\,\\mathbf{n}\\,$。假设为时谐小振幅声学问题，并采用相量约定 $\\,\\exp(-i \\omega t)\\,$。基本控制律为线性化的质量守恒、线性化的动量平衡和一个线性状态方程：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_{0}\\,\\nabla \\cdot \\mathbf{v} = q(\\mathbf{x},t), \\qquad\n\\rho_{0}\\,\\frac{\\partial \\mathbf{v}}{\\partial t} = -\\nabla p, \\qquad\np = c_{0}^{2}\\,\\rho',\n$$\n其中 $\\,p(\\mathbf{x},t)\\,$ 是声压，$\\,\\rho'(\\mathbf{x},t)\\,$ 是密度涨落，$\\,\\mathbf{v}(\\mathbf{x},t)\\,$ 是质点速度，$\\,q(\\mathbf{x},t)\\,$ 是一个体积质量注入源。在边界 $\\,\\Gamma\\,$ 上，材料是局部反应的，其阻抗定律为 $\\,p = Z_{s}(\\omega)\\,v_{n}\\,$，其中 $\\,v_{n} = \\mathbf{v} \\cdot \\mathbf{n}\\,$，表面阻抗由下式建模：\n$$\nZ_{s}(\\omega) = \\rho_{0}\\,c_{0}\\,A\\left(\\frac{\\omega}{\\omega_{0}}\\right)^{m}\\left[\\,1 - i\\,B\\left(\\frac{\\omega}{\\omega_{0}}\\right)^{-n}\\right],\n$$\n其中 $\\,A0\\,$, $\\,B0\\,$, $\\,m0\\,$, $\\,n0\\,$ 为给定的正常数，$\\,\\omega_{0}0\\,$ 为参考角频率。设 $\\,L\\,$ 为该域的一个特征长度，并引入无量纲变量 $\\,\\mathbf{x}' = \\mathbf{x}/L\\,$ 和 $\\,p' = p/p_{\\star}\\,$，其中 $\\,p_{\\star}\\,$ 是一个任意的正压力标度。定义亥姆霍兹数 $\\,\\kappa = k\\,L\\,$，其中波数 $\\,k = \\omega/c_{0}\\,$。\n\n仅从所述的基本定律出发，推导在 $\\,\\Omega\\,$ 中关于 $\\,p(\\mathbf{x})\\,$ 的频域亥姆霍兹方程，以及在 $\\,\\Gamma\\,$ 上的相应阻抗边界条件，并对边界条件进行无量纲化，以获得在 $\\,\\Gamma\\,$ 上的无量纲罗宾形式 $\\,\\partial p'/\\partial n' + \\beta\\,p' = 0\\,$，其中 $\\,\\partial/\\partial n' = \\mathbf{n}\\cdot \\nabla_{\\mathbf{x}'}\\,$。将无量纲罗宾系数 $\\,\\beta\\,$ 完全用 $\\,\\kappa\\,$, $\\,A\\,$, $\\,B\\,$, $\\,m\\,$, $\\,n\\,$, $\\,c_{0}\\,$, $\\,\\omega_{0}\\,$ 和 $\\,L\\,$ 表示，消去 $\\,\\omega\\,$ 而用 $\\,\\kappa\\,$ 表示。请以单个闭式解析表达式的形式给出你的最终答案。无需四舍五入，由于 $\\,\\beta\\,$ 是无量纲的，请不要包含单位。",
            "solution": "该问题是适定的、有科学依据的、客观的，并包含了进行严格推导所需的所有信息。因此，我们可以开始求解。推导过程分三个阶段：首先，推导频域亥姆霍兹方程；其次，推导压力相量的阻抗边界条件；第三，对此边界条件进行无量纲化，以求出系数 $\\beta$ 的表达式。\n\n**1. 亥姆霍兹方程的推导**\n\n我们从给定的时域线性化声学方程开始：\n1. 质量守恒：$\\frac{\\partial \\rho'}{\\partial t} + \\rho_{0}\\,\\nabla \\cdot \\mathbf{v} = q(\\mathbf{x},t)$\n2. 动量平衡：$\\rho_{0}\\,\\frac{\\partial \\mathbf{v}}{\\partial t} = -\\nabla p$\n3. 状态方程：$p = c_{0}^{2}\\,\\rho'$\n\n我们假设所有场变量都具有时谐行为，形式为 $f(\\mathbf{x},t) = f(\\mathbf{x}) \\exp(-i \\omega t)$，其中 $f(\\mathbf{x})$ 是复值相量。在此假设下，时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为乘以 $-i\\omega$。频域中的控制方程变为：\n1.  $-i\\omega \\rho'(\\mathbf{x}) + \\rho_{0}\\,\\nabla \\cdot \\mathbf{v}(\\mathbf{x}) = Q(\\mathbf{x})$\n2.  $-i\\omega \\rho_{0}\\,\\mathbf{v}(\\mathbf{x}) = -\\nabla p(\\mathbf{x})$\n3.  $p(\\mathbf{x}) = c_{0}^{2}\\,\\rho'(\\mathbf{x})$\n\n此处，$p(\\mathbf{x})$、$\\rho'(\\mathbf{x})$、$\\mathbf{v}(\\mathbf{x})$ 和 $Q(\\mathbf{x})$ 分别是压力、密度涨落、质点速度和质量源率的相量。\n\n从动量方程(2)，我们可以用压力梯度表示速度相量 $\\mathbf{v}$：\n$$\n\\mathbf{v}(\\mathbf{x}) = \\frac{1}{i\\omega \\rho_{0}} \\nabla p(\\mathbf{x})\n$$\n从状态方程(3)，我们用压力相量 $p$ 表示密度涨落相量 $\\rho'$：\n$$\n\\rho'(\\mathbf{x}) = \\frac{1}{c_{0}^{2}} p(\\mathbf{x})\n$$\n现在，我们将 $\\mathbf{v}$ 和 $\\rho'$ 的这些表达式代入质量守恒方程(1)：\n$$\n-i\\omega \\left(\\frac{1}{c_{0}^{2}} p(\\mathbf{x})\\right) + \\rho_{0}\\,\\nabla \\cdot \\left(\\frac{1}{i\\omega \\rho_{0}} \\nabla p(\\mathbf{x})\\right) = Q(\\mathbf{x})\n$$\n简化此表达式：\n$$\n-\\frac{i\\omega}{c_{0}^{2}} p(\\mathbf{x}) + \\frac{\\rho_{0}}{i\\omega \\rho_{0}} \\nabla \\cdot (\\nabla p(\\mathbf{x})) = Q(\\mathbf{x})\n$$\n$$\n-\\frac{i\\omega}{c_{0}^{2}} p(\\mathbf{x}) + \\frac{1}{i\\omega} \\nabla^2 p(\\mathbf{x}) = Q(\\mathbf{x})\n$$\n为消除分母中的复数，我们将整个方程乘以 $i\\omega$：\n$$\n(i\\omega)\\left(-\\frac{i\\omega}{c_{0}^{2}} p(\\mathbf{x})\\right) + (i\\omega)\\left(\\frac{1}{i\\omega} \\nabla^2 p(\\mathbf{x})\\right) = i\\omega Q(\\mathbf{x})\n$$\n$$\n\\frac{\\omega^2}{c_{0}^{2}} p(\\mathbf{x}) + \\nabla^2 p(\\mathbf{x}) = i\\omega Q(\\mathbf{x})\n$$\n定义波数为 $k = \\omega/c_{0}$，我们得到在域 $\\Omega$ 中声压相量 $p(\\mathbf{x})$ 的非齐次亥姆霍兹方程：\n$$\n\\nabla^2 p(\\mathbf{x}) + k^2 p(\\mathbf{x}) = i\\omega Q(\\mathbf{x})\n$$\n\n**2. 阻抗边界条件的推导**\n\n$\\Gamma$ 上的边界条件由阻抗定律 $p = Z_{s}(\\omega) v_{n}$ 给出，其中 $v_{n} = \\mathbf{v} \\cdot \\mathbf{n}$ 是质点速度的法向分量，$\\mathbf{n}$ 是外向单位法向量。\n\n使用频域动量方程，我们得到 $\\mathbf{v}(\\mathbf{x}) = \\frac{1}{i\\omega \\rho_{0}} \\nabla p(\\mathbf{x})$。与 $\\mathbf{n}$ 做点积得到法向速度：\n$$\nv_{n} = \\mathbf{v} \\cdot \\mathbf{n} = \\frac{1}{i\\omega \\rho_{0}} (\\nabla p \\cdot \\mathbf{n})\n$$\n压力的法向导数定义为 $\\frac{\\partial p}{\\partial n} = \\nabla p \\cdot \\mathbf{n}$。因此，\n$$\nv_{n} = \\frac{1}{i\\omega \\rho_{0}} \\frac{\\partial p}{\\partial n}\n$$\n将此代入阻抗定律 $p = Z_{s}(\\omega) v_{n}$：\n$$\np(\\mathbf{x}) = Z_{s}(\\omega) \\left(\\frac{1}{i\\omega \\rho_{0}} \\frac{\\partial p}{\\partial n}\\right)\n$$\n重排此方程以用压力表示法向导数，得到有量纲的阻抗边界条件：\n$$\n\\frac{\\partial p}{\\partial n} = \\frac{i\\omega \\rho_{0}}{Z_{s}(\\omega)} p(\\mathbf{x})\n$$\n\n**3. 无量纲化与 $\\beta$ 的确定**\n\n我们引入无量纲变量 $\\mathbf{x}' = \\mathbf{x}/L$ 和 $p' = p/p_{\\star}$。根据这些定义，我们有 $\\mathbf{x} = L\\mathbf{x}'$ 和 $p = p_{\\star}p'$。原始坐标系中的梯度算子 $\\nabla_{\\mathbf{x}}$ 可以通过链式法则与无量纲系统中的梯度算子 $\\nabla_{\\mathbf{x}'}$ 关联起来：\n$$\n\\nabla_{\\mathbf{x}} = \\frac{\\partial}{\\partial \\mathbf{x}} = \\frac{\\partial \\mathbf{x}'}{\\partial \\mathbf{x}} \\frac{\\partial}{\\partial \\mathbf{x}'} = \\frac{1}{L} \\nabla_{\\mathbf{x}'}\n$$\n有量纲的法向导数 $\\frac{\\partial p}{\\partial n}$ 可以用无量纲量表示：\n$$\n\\frac{\\partial p}{\\partial n} = \\mathbf{n} \\cdot \\nabla_{\\mathbf{x}} p = \\mathbf{n} \\cdot \\left(\\frac{1}{L} \\nabla_{\\mathbf{x}'}\\right) (p_{\\star} p') = \\frac{p_{\\star}}{L} (\\mathbf{n} \\cdot \\nabla_{\\mathbf{x}'} p') = \\frac{p_{\\star}}{L} \\frac{\\partial p'}{\\partial n'}\n$$\n现在，我们将 $p=p_{\\star}p'$ 和 $\\frac{\\partial p}{\\partial n}$ 的表达式代入有量纲的边界条件：\n$$\n\\frac{p_{\\star}}{L} \\frac{\\partial p'}{\\partial n'} = \\frac{i\\omega \\rho_{0}}{Z_{s}(\\omega)} (p_{\\star}p')\n$$\n任意压力标度 $p_{\\star}$ 从两侧消去：\n$$\n\\frac{1}{L} \\frac{\\partial p'}{\\partial n'} = \\frac{i\\omega \\rho_{0}}{Z_{s}(\\omega)} p'\n$$\n乘以 $L$ 得到：\n$$\n\\frac{\\partial p'}{\\partial n'} = \\frac{i\\omega \\rho_{0} L}{Z_{s}(\\omega)} p'\n$$\n题目要求此方程的形式为 $\\frac{\\partial p'}{\\partial n'} + \\beta p' = 0$。通过比较这两种形式，我们确定无量纲罗宾系数 $\\beta$ 为：\n$$\n\\beta = -\\frac{i\\omega \\rho_{0} L}{Z_{s}(\\omega)}\n$$\n我们现在代入给定的表面阻抗 $Z_{s}(\\omega)$ 的表达式：\n$$\nZ_{s}(\\omega) = \\rho_{0}\\,c_{0}\\,A\\left(\\frac{\\omega}{\\omega_{0}}\\right)^{m}\\left[\\,1 - i\\,B\\left(\\frac{\\omega}{\\omega_{0}}\\right)^{-n}\\right]\n$$\n$$\n\\beta = -\\frac{i\\omega \\rho_{0} L}{\\rho_{0}\\,c_{0}\\,A\\left(\\frac{\\omega}{\\omega_{0}}\\right)^{m}\\left[\\,1 - i\\,B\\left(\\frac{\\omega}{\\omega_{0}}\\right)^{-n}\\right]}\n$$\n$\\rho_{0}$ 项被消掉。我们还可以将 $\\omega L / c_{0}$ 重写为 $(\\omega/c_{0})L = kL = \\kappa$，即亥姆霍兹数。\n$$\n\\beta = -\\frac{i\\kappa}{A\\left(\\frac{\\omega}{\\omega_{0}}\\right)^{m}\\left[\\,1 - i\\,B\\left(\\frac{\\omega}{\\omega_{0}}\\right)^{-n}\\right]}\n$$\n最后，我们必须用指定的参数表示 $\\omega$。根据定义 $\\kappa = kL$ 和 $k=\\omega/c_0$，我们有 $\\omega = kc_0 = (\\kappa/L)c_0$。将此代入 $\\beta$ 的表达式中：\n$$\n\\frac{\\omega}{\\omega_{0}} = \\frac{(\\kappa/L)c_{0}}{\\omega_{0}} = \\frac{c_{0}\\kappa}{L\\omega_{0}}\n$$\n这就得出了无量纲罗宾系数 $\\beta$ 的最终表达式：\n$$\n\\beta = - \\frac{i\\kappa}{A\\left(\\frac{c_{0}\\kappa}{L\\omega_{0}}\\right)^{m}\\left[1 - i B \\left(\\frac{c_{0}\\kappa}{L\\omega_{0}}\\right)^{-n}\\right]}\n$$\n这个表达式只包含指定的参数 $\\kappa$, $A$, $B$, $m$, $n$, $c_{0}$, $\\omega_{0}$ 和 $L$，并且是所要求的单个闭式解析表达式。",
            "answer": "$$\n\\boxed{- \\frac{i\\kappa}{A\\left(\\frac{c_{0}\\kappa}{L\\omega_{0}}\\right)^{m}\\left[1 - i B \\left(\\frac{c_{0}\\kappa}{L\\omega_{0}}\\right)^{-n}\\right]}}\n$$"
        },
        {
            "introduction": "将连续的偏微分方程转化为离散的计算机模型不可避免地会引入误差。本练习  提供了一个分析这些误差的重要工具——离散色散分析的实践机会。通过研究一个简单的有限差分格式如何改变波的传播特性，你将更深入地理解数值污染效应，并领会“每波长采样点数”这一经验法则背后的数学原理。",
            "id": "4142418",
            "problem": "考虑在声速为常数$c$的均匀无损介质中的时谐声学问题，其中角频率为$\\omega$的声压场$p(\\mathbf{x})$满足频域亥姆霍兹方程$\\nabla^{2} p + k^{2} p = 0$，其中$k = \\omega / c$。在一个在$x$和$y$方向上间距均为$h$的均匀二维笛卡尔网格上，使用标准五点有限差分（FD）格式近似拉普拉斯算子$\\nabla^{2}$。这得到离散方程\n$$(p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4 p_{i,j})/h^{2} + k^{2} p_{i,j} = 0.$$\n假设网格上的平面波拟设具有$p_{i,j} = \\exp\\!\\big(\\mathrm{i}\\,\\tilde{k}\\,\\cos(\\theta)\\, i h + \\mathrm{i}\\,\\tilde{k}\\,\\sin(\\theta)\\, j h\\big)$的形式，其中$\\theta$是从$x$轴测量的传播角，以弧度表示，$\\tilde{k}$是由离散算子引起的数值波数。定义无量纲物理波数$\\kappa = k h$和无量纲数值波数$\\tilde{\\kappa} = \\tilde{k} h$。相对相位误差为$\\varepsilon(\\theta,\\kappa) = (\\tilde{k} - k)/k = \\tilde{\\kappa}/\\kappa - 1$。\n仅从连续亥姆霍兹方程、给定的有限差分离散化和平面波拟设出发，推导离散色散关系，然后进行小$\\kappa$渐近展开，以提取相对相位误差$\\varepsilon(\\theta,\\kappa)$的主阶项，作为$\\theta$和$\\kappa$的显式函数。请以关于$\\kappa$和$\\theta$（其中$\\theta$以弧度为单位）的符号形式，给出$\\kappa$的主阶项的闭式解析表达式。最终答案中不要包含高阶项或大O符号。",
            "solution": "用户希望找到二维亥姆霍兹方程有限差分离散化的相对相位误差的主阶项。\n\n### 步骤 1：问题验证\n\n问题陈述清晰、自洽地描述了计算声学中的一种标准分析技术，即亥姆霍兹方程有限差分格式的色散分析。\n\n**已知条件：**\n-   连续亥姆霍兹方程：$\\nabla^{2} p + k^{2} p = 0$。\n-   物理波数：$k = \\omega / c$。\n-   离散亥姆霍兹方程（五点格式）：$(p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4 p_{i,j})/h^{2} + k^{2} p_{i,j} = 0$。\n-   离散平面波拟设：$p_{i,j} = \\exp\\!\\big(\\mathrm{i}\\,\\tilde{k}\\,\\cos(\\theta)\\, i h + \\mathrm{i}\\,\\tilde{k}\\,\\sin(\\theta)\\, j h\\big)$。\n-   无量纲物理波数：$\\kappa = k h$。\n-   无量纲数值波数：$\\tilde{\\kappa} = \\tilde{k} h$。\n-   相对相位误差：$\\varepsilon(\\theta,\\kappa) = (\\tilde{k} - k)/k = \\tilde{\\kappa}/\\kappa - 1$。\n\n**验证：**\n-   **科学基础：** 该问题牢固地植根于偏微分方程数值分析的既定原则，特别是针对波传播问题。所有概念（亥姆霍兹方程、有限差分、色散分析、相位误差）都是标准的且科学上是合理的。这是理解数值方法准确性的一个关键练习。\n-   **适定性：** 问题是适定的。它要求基于一套完整的初始定义和方程推导出一个特定的量。求解路径涉及标准的数学技术（代数代入、泰勒级数展开），并导向一个唯一的、有意义的结果。\n-   **客观性：** 问题以精确、客观、无歧义的数学语言陈述。\n\n该问题被认为是有效的，因为它具有科学依据、适定且客观。它是计算科学与工程领域一个标准的、非平凡的问题。\n\n### 步骤 2：求解推导\n\n求解过程首先是获得离散色散关系，该关系将物理波数$k$与数值波数$\\tilde{k}$联系起来。这通过将平面波拟设代入离散亥姆霍兹方程来实现。\n\n离散方程为：\n$$ \\frac{p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4 p_{i,j}}{h^{2}} + k^{2} p_{i,j} = 0 $$\n平面波拟设由下式给出：\n$$ p_{i,j} = \\exp\\big(\\mathrm{i}\\,\\tilde{k} h (i \\cos\\theta + j \\sin\\theta)\\big) = \\exp\\big(\\mathrm{i}\\,\\tilde{\\kappa} (i \\cos\\theta + j \\sin\\theta)\\big) $$\n其中$\\tilde{\\kappa} = \\tilde{k}h$是无量纲数值波数。\n\n我们计算相对于$p_{i,j}$的相邻项：\n$$ p_{i+1,j} = p_{i,j} \\exp(\\mathrm{i}\\,\\tilde{\\kappa} \\cos\\theta) $$\n$$ p_{i-1,j} = p_{i,j} \\exp(-\\mathrm{i}\\,\\tilde{\\kappa} \\cos\\theta) $$\n$$ p_{i,j+1} = p_{i,j} \\exp(\\mathrm{i}\\,\\tilde{\\kappa} \\sin\\theta) $$\n$$ p_{i,j-1} = p_{i,j} \\exp(-\\mathrm{i}\\,\\tilde{\\kappa} \\sin\\theta) $$\n\n将这些表达式代入离散方程，并除以非零公因子$p_{i,j}$，得到：\n$$ \\frac{1}{h^{2}} \\big( \\exp(\\mathrm{i}\\,\\tilde{\\kappa} \\cos\\theta) + \\exp(-\\mathrm{i}\\,\\tilde{\\kappa} \\cos\\theta) + \\exp(\\mathrm{i}\\,\\tilde{\\kappa} \\sin\\theta) + \\exp(-\\mathrm{i}\\,\\tilde{\\kappa} \\sin\\theta) - 4 \\big) + k^{2} = 0 $$\n\n使用欧拉恒等式$2\\cos(x) = \\exp(\\mathrm{i}x) + \\exp(-\\mathrm{i}x)$，我们简化表达式：\n$$ \\frac{1}{h^{2}} \\big( 2\\cos(\\tilde{\\kappa} \\cos\\theta) + 2\\cos(\\tilde{\\kappa} \\sin\\theta) - 4 \\big) + k^{2} = 0 $$\n整理以求解$k^2$：\n$$ k^{2} = \\frac{4 - 2\\cos(\\tilde{\\kappa} \\cos\\theta) - 2\\cos(\\tilde{\\kappa} \\sin\\theta)}{h^{2}} = \\frac{2}{h^{2}} \\big( (1 - \\cos(\\tilde{\\kappa} \\cos\\theta)) + (1 - \\cos(\\tilde{\\kappa} \\sin\\theta)) \\big) $$\n使用半角恒等式$1 - \\cos(x) = 2\\sin^2(x/2)$：\n$$ k^{2} = \\frac{2}{h^{2}} \\left( 2\\sin^2\\left(\\frac{\\tilde{\\kappa} \\cos\\theta}{2}\\right) + 2\\sin^2\\left(\\frac{\\tilde{\\kappa} \\sin\\theta}{2}\\right) \\right) = \\frac{4}{h^{2}} \\left( \\sin^2\\left(\\frac{\\tilde{\\kappa} \\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{\\kappa} \\sin\\theta}{2}\\right) \\right) $$\n这就是离散色散关系。两边乘以$h^2$并使用无量纲波数$\\kappa = kh$，我们得到：\n$$ \\kappa^2 = 4 \\left( \\sin^2\\left(\\frac{\\tilde{\\kappa} \\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{\\kappa} \\sin\\theta}{2}\\right) \\right) $$\n\n接下来，我们进行小$\\kappa$渐近展开。在这种情况下，我们预期$\\tilde{\\kappa} \\approx \\kappa$，所以$\\tilde{\\kappa}$也很小。我们使用泰勒级数$\\sin(x) = x - x^3/6 + O(x^5)$展开$\\sin$函数。这意味着$\\sin^2(x) = (x - x^3/6 + \\dots)^2 = x^2 - x^4/3 + O(x^6)$。\n将此应用于色散关系：\n$$ \\sin^2\\left(\\frac{\\tilde{\\kappa} \\cos\\theta}{2}\\right) = \\left(\\frac{\\tilde{\\kappa} \\cos\\theta}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\tilde{\\kappa} \\cos\\theta}{2}\\right)^4 + O(\\tilde{\\kappa}^6) = \\frac{\\tilde{\\kappa}^2 \\cos^2\\theta}{4} - \\frac{\\tilde{\\kappa}^4 \\cos^4\\theta}{48} + O(\\tilde{\\kappa}^6) $$\n$$ \\sin^2\\left(\\frac{\\tilde{\\kappa} \\sin\\theta}{2}\\right) = \\frac{\\tilde{\\kappa}^2 \\sin^2\\theta}{4} - \\frac{\\tilde{\\kappa}^4 \\sin^4\\theta}{48} + O(\\tilde{\\kappa}^6) $$\n将这些代入无量纲色散关系：\n$$ \\kappa^2 = 4 \\left( \\frac{\\tilde{\\kappa}^2 \\cos^2\\theta}{4} - \\frac{\\tilde{\\kappa}^4 \\cos^4\\theta}{48} + \\frac{\\tilde{\\kappa}^2 \\sin^2\\theta}{4} - \\frac{\\tilde{\\kappa}^4 \\sin^4\\theta}{48} + O(\\tilde{\\kappa}^6) \\right) $$\n$$ \\kappa^2 = \\tilde{\\kappa}^2 (\\cos^2\\theta + \\sin^2\\theta) - \\frac{\\tilde{\\kappa}^4}{12}(\\cos^4\\theta + \\sin^4\\theta) + O(\\tilde{\\kappa}^6) $$\n使用恒等式$\\cos^2\\theta + \\sin^2\\theta = 1$：\n$$ \\kappa^2 = \\tilde{\\kappa}^2 - \\frac{\\tilde{\\kappa}^4}{12}(\\cos^4\\theta + \\sin^4\\theta) + O(\\tilde{\\kappa}^6) $$\n我们需要求解作为$\\kappa$函数的$\\tilde{\\kappa}$。我们进行级数反演。令$\\tilde{\\kappa} = \\kappa + c_3 \\kappa^3 + O(\\kappa^5)$。那么$\\tilde{\\kappa}^2 = \\kappa^2 + 2c_3 \\kappa^4 + O(\\kappa^6)$且$\\tilde{\\kappa}^4 = \\kappa^4 + O(\\kappa^6)$。将这些代入展开后的关系式：\n$$ \\kappa^2 = (\\kappa^2 + 2c_3 \\kappa^4) - \\frac{\\kappa^4}{12}(\\cos^4\\theta + \\sin^4\\theta) + O(\\kappa^6) $$\n令等式两边$\\kappa^4$项的系数相等，得到：\n$$ 0 = 2c_3 - \\frac{1}{12}(\\cos^4\\theta + \\sin^4\\theta) \\implies c_3 = \\frac{1}{24}(\\cos^4\\theta + \\sin^4\\theta) $$\n因此，$\\tilde{\\kappa}$的展开式为：\n$$ \\tilde{\\kappa} = \\kappa + \\frac{\\kappa^3}{24}(\\cos^4\\theta + \\sin^4\\theta) + O(\\kappa^5) $$\n相对相位误差定义为$\\varepsilon(\\theta,\\kappa) = \\tilde{\\kappa}/\\kappa - 1$。\n$$ \\varepsilon(\\theta,\\kappa) = \\frac{1}{\\kappa} \\left( \\kappa + \\frac{\\kappa^3}{24}(\\cos^4\\theta + \\sin^4\\theta) + O(\\kappa^5) \\right) - 1 $$\n$$ \\varepsilon(\\theta,\\kappa) = 1 + \\frac{\\kappa^2}{24}(\\cos^4\\theta + \\sin^4\\theta) + O(\\kappa^4) - 1 $$\n$$ \\varepsilon(\\theta,\\kappa) = \\frac{\\kappa^2}{24}(\\cos^4\\theta + \\sin^4\\theta) + O(\\kappa^4) $$\n相对相位误差的主阶项是此展开式中的第一项。\n问题要求以闭式表达式给出此项。\n\n主阶项的最终表达式：\n$$ \\frac{\\kappa^2}{24}(\\cos^4\\theta + \\sin^4\\theta) $$",
            "answer": "$$\n\\boxed{\\frac{\\kappa^2}{24}(\\cos^4\\theta + \\sin^4\\theta)}\n$$"
        },
        {
            "introduction": "本练习将通过一个编码任务，将理论与实践联系起来。我们将介绍边界元法 (BEM)，这是一种功能强大的数值方法，尤其适用于求解外部声学问题，可作为有限差分等域内方法的替代方案。此实践  将引导你实现一个基于 Nyström 离散的 BEM 求解器，并在此过程中解决奇异积分求积和近共振频率下方程的病态问题等关键挑战。",
            "id": "4142405",
            "problem": "考虑满足频域亥姆霍兹方程的时谐声压场。令 $\\Omega \\subset \\mathbb{R}^2$ 为一个具有光滑边界 $\\Gamma$ 的有界单连通域，并令 $p(\\mathbf{x})$ 表示角频率为 $\\omega$ 时，在空间点 $\\mathbf{x} \\in \\mathbb{R}^2$ 处的复值声压场。在声速 $c$ 恒定的无损耗均匀介质中，场 $p$ 在无源区域满足亥姆霍兹方程 $\\nabla^2 p + k^2 p = 0$，其中 $k = \\omega/c$ 是声波数（单位：弧度/米）。\n\n从格林第二恒等式和二维亥姆霍兹算子的自由空间格林函数出发，推导内部狄利克雷问题的边界积分表示，该表示应以双层势的形式给出。具体来说，对于 $\\mathbf{x} \\in \\Omega$，将 $p(\\mathbf{x})$ 表示为一个边界密度为 $\\mu(\\mathbf{y})$ 的双层势，并从内部逼近边界时（$\\mathbf{x} \\to \\Gamma$）获得极限边界积分方程。此极限过程会引入一个柯西主值奇异积分和一个跳跃项；请解释此跳跃项的来源以及在数值稳定的求积中处理奇点所需的方法。\n\n然后，基于 Nyström 离散化，实现一种边界元法（BEM），该方法在圆形边界 $\\Gamma = \\{\\mathbf{r}(\\theta) = a(\\cos \\theta, \\sin \\theta): \\theta \\in [0, 2\\pi)\\}$ 上使用均匀梯形求积。该边界的外向单位法向量为 $\\mathbf{n}(\\theta) = (\\cos \\theta, \\sin \\theta)$，微分弧长元为 $\\mathrm{d}\\Gamma = a\\,\\mathrm{d}\\theta$。您的离散化必须：\n- 使用 $N$ 个均匀分布的角度 $\\theta_j = 2\\pi j / N$（角度单位：弧度）。\n- 通过在求积节点上计算自由空间亥姆霍兹格林函数的法向导数，并乘以求积权重 $w = a \\Delta \\theta$（其中 $\\Delta \\theta = 2\\pi/N$），来构建双层算子。\n- 通过从梯形和中排除对角线贡献，并在边界积分方程的左侧添加解析跳跃项 $- \\tfrac{1}{2} \\mu$ 来处理源点和目标点重合时的核函数奇点，这对应于内部极限。\n\n为验证实现，基于传播方向为 $\\mathbf{d} = (1, 0)$ 的平面波 $p_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(i k \\mathbf{d} \\cdot \\mathbf{x})$ 来指定一个狄利克雷边界条件 $g(\\theta) = p_{\\mathrm{inc}}(\\mathbf{r}(\\theta))$。求解得到的线性系统以获得边界密度 $\\mu$，并使用相同的双层势计算内部点 $\\mathbf{x}_0 = (0, 0)$ 处的场。计算两个误差度量：\n1. 相对边界残差范数 $\\|(-\\tfrac{1}{2} I + D)\\mu - g\\|_2 / \\|g\\|_2$（无量纲），其中 $D$ 表示作用于 $\\mu$ 的离散化双层算子。\n2. 在 $\\mathbf{x}_0$ 处的绝对内部误差，定义为 $|p(\\mathbf{x}_0) - p_{\\mathrm{inc}}(\\mathbf{x}_0)|$（无量纲）。\n\n使用以下参数值测试套件来评估奇异求积和整体算法的性能：\n- 测试用例 1（一般情况）：$a = 1.0$ 米, $k = 3.0$ 弧度/米, $N = 64$。\n- 测试用例 2（更高频率分辨率）：$a = 1.0$ 米, $k = 10.0$ 弧度/米, $N = 256$。\n- 测试用例 3（接近内部共振）：$a = 1.0$ 米, $k = 5.5201$ 弧度/米, $N = 128$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：$[残差_1, 内部误差_1, 残差_2, 内部误差_2, 残差_3, 内部误差_3]$。所有角度必须以弧度为单位，所有长度必须以米为单位。输出值必须是浮点数（无量纲），表示每个测试用例的误差大小。",
            "solution": "该问题要求推导并实现一种边界元法（BEM），以解决二维亥姆霍茲方程的内部狄利克雷问题。此过程首先验证问题陈述，然后进行详细的理论推导，最后实现数值算法。\n\n### 问题验证\n根据有效性标准对问题陈述进行评估。\n\n*   **提取的已知条件**：\n    -   **方程**：$\\nabla^2 p + k^2 p = 0$ 在无源区域 $\\Omega \\subset \\mathbb{R}^2$ 中。\n    -   **定义**：$p$ 是复声压，$k=\\omega/c$ 是波数。\n    -   **任务1（理论）**：为内部狄利克雷问题推导 $p(\\mathbf{x})$, $\\mathbf{x} \\in \\Omega$ 的双层势表示，从而得到一个当 $\\mathbf{x} \\to \\Gamma$ 时包含跳跃项和奇异积分的边界积分方程（BIE）。\n    -   **任务2（实现）**：为圆形边界 $\\Gamma = \\{\\mathbf{r}(\\theta) = a(\\cos \\theta, \\sin \\theta)\\}$ 实现一个 Nyström 离散化的边界元法。\n    -   **离散化**：$N$ 个均匀节点 $\\theta_j=2\\pi j/N$，梯形求积权重 $w=a\\Delta\\theta=a(2\\pi/N)$。\n    -   **奇点处理**：从求和中排除对角线贡献，并在边界积分方程的左侧添加解析跳跃项 $-\\frac{1}{2}\\mu$。\n    -   **验证案例**：来自平面波 $p_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(i k \\mathbf{d} \\cdot \\mathbf{x})$ 且 $\\mathbf{d}=(1,0)$ 的狄利克雷边界条件 $g(\\theta) = p_{\\mathrm{inc}}(\\mathbf{r}(\\theta))$。\n    -   **评估**：计算 $\\mathbf{x}_0=(0,0)$ 处的场并找到两个误差度量：相对边界残差范数 $\\|(-\\tfrac{1}{2} I + D)\\mu - g\\|_2 / \\|g\\|_2$ 和绝对内部误差 $|p(\\mathbf{x}_0) - p_{\\mathrm{inc}}(\\mathbf{x}_0)|$。\n    -   **测试套件**：\n        1.  $a = 1.0$, $k = 3.0$, $N = 64$。\n        2.  $a = 1.0$, $k = 10.0$, $N = 256$。\n        3.  $a = 1.0$, $k = 5.5201$, $N = 128$。\n\n*   **验证结论**：\n    -   **科学依据**：该问题基于成熟的亥姆霍兹方程和边界积分方程理论，这些都是声学和波传播领域的标准内容。格林函数、势理论和 Nyström 离散化的使用都是标准的、严谨的方法。测试用例3正确地指出了一个对应于内部共振的波数（$ka \\approx 5.5201$ 是 Bessel 函数 $J_0(z)$ 的第二个零点），在此波数下，所指定的积分方程公式是已知的病态问题。这是对一个已知局限性的有效测试，而不是问题陈述中的缺陷。\n    -   **适定性**：问题结构清晰，为唯一的求解路径提供了所有必要的数据和定义。\n    -   **客观性**：问题以精确的数学和计算术语陈述，没有歧义或主观语言。\n\n该问题被判定为 **有效**。我们可以继续进行求解。\n\n### 理论推导与算法设计\n\n**1. 积分表示**\n\n亥姆霍兹方程 $(\\nabla^2 + k^2)p = 0$ 在域 $\\Omega$ 内的解可以使用格林第二恒等式来表示。令 $p(\\mathbf{y})$ 为声压，$G(\\mathbf{x}, \\mathbf{y})$ 为自由空间格林函数，其满足 $(\\nabla_\\mathbf{y}^2 + k^2)G(\\mathbf{x}, \\mathbf{y}) = -\\delta(\\mathbf{x}-\\mathbf{y})$。格林第二恒等式表述为：\n$$ \\int_\\Omega \\left( p(\\mathbf{y}) \\nabla_\\mathbf{y}^2 G(\\mathbf{x}, \\mathbf{y}) - G(\\mathbf{x}, \\mathbf{y}) \\nabla_\\mathbf{y}^2 p(\\mathbf{y}) \\right) \\,\\mathrm{d}\\Omega(\\mathbf{y}) = \\int_\\Gamma \\left( p(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n_\\mathbf{y}} - G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial p(\\mathbf{y})}{\\partial n_\\mathbf{y}} \\right) \\,\\mathrm{d}\\Gamma(\\mathbf{y}) $$\n其中 $\\mathbf{n}_\\mathbf{y}$ 是在 $\\mathbf{y} \\in \\Gamma$ 处的外向单位法向量。代入 $p$ 和 $G$ 的控制方程，左侧可简化为：\n$$ \\int_\\Omega \\left( p(\\mathbf{y})[-k^2 G - \\delta(\\mathbf{x}-\\mathbf{y})] - G(\\mathbf{y})[-k^2 p(\\mathbf{y})] \\right) \\,\\mathrm{d}\\Omega(\\mathbf{y}) = -\\int_\\Omega p(\\mathbf{y})\\delta(\\mathbf{x}-\\mathbf{y})\\,\\mathrm{d}\\Omega(\\mathbf{y}) = -p(\\mathbf{x}) $$\n对于 $\\mathbf{x} \\in \\Omega$。这就得到了 Kirchhoff-Helmholtz 积分公式：\n$$ p(\\mathbf{x}) = \\int_\\Gamma \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial p(\\mathbf{y})}{\\partial n_\\mathbf{y}} - p(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n_\\mathbf{y}} \\right) \\,\\mathrm{d}\\Gamma(\\mathbf{y}) $$\n该公式用场在边界 $\\Gamma$ 上的值及其法向导数来表示场 $p(\\mathbf{x})$。这些积分分别被称为单层势和双层势。\n\n对于内部狄利克雷问题，其中 $p(\\mathbf{y})=g(\\mathbf{y})$ 在 $\\Gamma$ 上已知，但 $\\partial p/\\partial n$ 未知，我们可以寻求一个纯粹以双层势形式表示的解，其密度函数 $\\mu(\\mathbf{y})$ 未知：\n$$ p(\\mathbf{x}) = \\mathcal{D}[\\mu](\\mathbf{x}) := \\int_\\Gamma \\mu(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n_\\mathbf{y}} \\,\\mathrm{d}\\Gamma(\\mathbf{y}) $$\n二维亥姆霍兹方程的自由空间格林函数是 $G(\\mathbf{x}, \\mathbf{y}) = \\frac{i}{4} H_0^{(1)}(k|\\mathbf{x}-\\mathbf{y}|)$，其中 $H_0^{(1)}$ 是零阶第一类 Hankel 函数。\n\n**2. 边界积分方程 (BIE)**\n\n为了找到未知的密度 $\\mu$，我们通过从 $\\Omega$ 内部取 $p(\\mathbf{x})$ 表示式的极限（当 $\\mathbf{x} \\to \\mathbf{x}_s \\in \\Gamma$ 时）来施加狄利克雷边界条件。众所周知，双层势在跨越边界时会表现出跳跃不连续性。对于光滑边界，其极限为：\n$$ \\lim_{\\mathbf{x} \\to \\mathbf{x}_s^{-}} \\mathcal{D}[\\mu](\\mathbf{x}) = \\left(-\\frac{1}{2}I + K\\right)[\\mu](\\mathbf{x}_s) $$\n其中 $I$ 是恒等算子，K 是由柯西主值积分定义的双层边界积分算子：\n$$ K[\\mu](\\mathbf{x}_s) = \\text{P.V.} \\int_\\Gamma \\mu(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}_s, \\mathbf{y})}{\\partial n_\\mathbf{y}} \\,\\mathrm{d}\\Gamma(\\mathbf{y}) $$\n跳跃项 $-\\frac{1}{2}\\mu(\\mathbf{x}_s)$ 源于当 $\\mathbf{y} \\to \\mathbf{x}_s$ 时核函数 $\\frac{\\partial G}{\\partial n_\\mathbf{y}}$ 中奇点的立体角贡献。这可以通过在内侧围绕 $\\mathbf{x}_s$ 用一个无穷小的半圆形路径来隔离奇点进行计算，该路径在极限情况下贡献了 $-\\frac{1}{2}\\mu(\\mathbf{x}_s)$。\n\n将极限值设为给定的边界数据 $g(\\mathbf{x}_s)$，即可得到关于 $\\mu$ 的边界积分方程：\n$$ g(\\mathbf{x}_s) = -\\frac{1}{2}\\mu(\\mathbf{x}_s) + \\int_\\Gamma \\mu(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}_s, \\mathbf{y})}{\\partial n_\\mathbf{y}} \\,\\mathrm{d}\\Gamma(\\mathbf{y}) $$\n\n**3. 数值离散化 (Nyström BEM)**\n\n我们使用 Nyström 方法对边界积分方程进行离散化，在圆形边界上设置 $N$ 个均匀分布的配置点 $\\mathbf{x}_j = \\mathbf{r}(\\theta_j)$，其中 $\\theta_j=2\\pi j/N$，对于 $j=0, \\dots, N-1$。该积分通过梯形法则近似，对于光滑的周期性被积函数，该法则是谱精确的。边界积分方程变成一个线性系统：\n$$ g_j = -\\frac{1}{2}\\mu_j + \\sum_{l=0}^{N-1} D_{jl} \\mu_l $$\n其中 $g_j=g(\\mathbf{x}_j)$，$\\mu_j=\\mu(\\mathbf{x}_j)$，且 $D_{jl}$ 是离散化矩阵的元素。该算子的核函数为：\n$$ K(\\mathbf{x}, \\mathbf{y}) = \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n_\\mathbf{y}} = \\frac{ik}{4} H_1^{(1)}(k|\\mathbf{x}-\\mathbf{y}|) \\frac{(\\mathbf{x}-\\mathbf{y})\\cdot\\mathbf{n}_\\mathbf{y}}{|\\mathbf{x}-\\mathbf{y}|} $$\n这里我们使用了 $\\frac{d}{dz}H_0^{(1)}(z) = -H_1^{(1)}(z)$。对于半径为 $a$ 的圆上的离散点 $\\mathbf{x}_j$ 和 $\\mathbf{y}_l$，我们有：\n- $|\\mathbf{x}_j-\\mathbf{y}_l| = 2a|\\sin((\\theta_j-\\theta_l)/2)|$。\n- $(\\mathbf{x}_j-\\mathbf{y}_l)\\cdot\\mathbf{n}_\\mathbf{y_l} = a(\\cos(\\theta_j-\\theta_l) - 1)$。\n求积权重为 $w_l = a \\Delta\\theta = a (2\\pi/N)$。当 $j \\neq l$ 时，矩阵元素为 $D_{jl} = K(\\mathbf{x}_j, \\mathbf{y}_l) w_l$。\n\n当 $j=l$ 时，核函数是奇异的。按照规定，对角线贡献 $l=j$ 从求和中排除，实际上是设置 $D_{jj}=0$。由于抵消特性，此过程对于这种特定的求积法则能够正确地近似柯西主值积分。因此，边界积分方程被离散化为：\n$$ \\mathbf{g} = \\left(-\\frac{1}{2}I + D\\right)\\boldsymbol{\\mu} $$\n其中 $D_{jj}=0$。求解该系统以获得未知密度向量 $\\boldsymbol{\\mu} = [\\mu_0, \\dots, \\mu_{N-1}]^T$。\n\n**4. 场计算与误差度量**\n\n一旦求得 $\\boldsymbol{\\mu}$，任意内部点 $\\mathbf{x}_{int}$ 处的压力可通过离散化积分表示式来计算：\n$$ p(\\mathbf{x}_{int}) \\approx \\sum_{l=0}^{N-1} \\mu_l K(\\mathbf{x}_{int}, \\mathbf{y}_l) w_l $$\n对于中心点 $\\mathbf{x}_0=(0,0)$，核函数不是奇异的，并且由于 $|\\mathbf{x}_0-\\mathbf{y}_l| = a$ 和 $(\\mathbf{x}_0-\\mathbf{y}_l)\\cdot\\mathbf{n}_{\\mathbf{y}_l} = -a$ 而显著简化。\n$$ K(\\mathbf{x}_0, \\mathbf{y}_l) = -\\frac{ik}{4} H_1^{(1)}(ka) $$\n入射平面波为 $p_{\\mathrm{inc}}(\\mathbf{x}) = \\exp(ikx)$，因此边界条件是 $g(\\theta_j) = \\exp(ika\\cos\\theta_j)$，精确的内部值为 $p_{\\mathrm{inc}}(\\mathbf{x}_0)=1$。然后按照规定计算误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import hankel1\nfrom scipy.linalg import solve as linsolve\nfrom numpy.linalg import norm\n\ndef solve_bem_case(a, k, N):\n    \"\"\"\n    Solves the 2D interior Helmholtz Dirichlet problem on a circle using BEM.\n\n    Args:\n        a (float): Radius of the circular boundary.\n        k (float): Wavenumber.\n        N (int): Number of discretization points.\n\n    Returns:\n        tuple[float, float]: A tuple containing the relative boundary residual\n                             norm and the absolute interior error at the origin.\n    \"\"\"\n    # 1. Discretization of the boundary\n    theta = 2 * np.pi * np.arange(N) / N\n    delta_theta = 2 * np.pi / N\n    quad_weight = a * delta_theta\n\n    # Collocation points (x_j) and integration points (y_l) are the same set\n    pts = a * np.stack((np.cos(theta), np.sin(theta)), axis=1)\n\n    # 2. Assemble the BEM matrix and RHS vector\n    D = np.zeros((N, N), dtype=np.complex128)\n    g = np.exp(1j * k * pts[:, 0]) # RHS: p_inc on the boundary, d=(1,0)\n\n    # Populate the off-diagonal elements of the double-layer operator matrix D\n    for j in range(N):\n        for l in range(N):\n            if j == l:\n                D[j, l] = 0.0 # Diagonal is excluded from sum\n                continue\n\n            # Vector from source y_l to target x_j\n            r_vec = pts[j, :] - pts[l, :]\n            r_norm = norm(r_vec)\n\n            # Outward normal at source point y_l\n            n_l = pts[l, :] / a\n\n            # Kernel components\n            # Note: The problem uses a representation p(x) = D[mu](x), which leads\n            # to the BIE (-1/2*I + K)mu = g. The kernel calculation here is for K.\n            # Kernel K(x,y) = dG(x,y)/dn_y\n            # dG/dn_y = grad_y(G) . n_y\n            # grad_y(G) = ik/4 * H1(kr) * (x-y)/r\n            # So, K(x,y) = ik/4 * H1(kr) * ((x-y).n_y)/r\n            \n            x_minus_y_dot_n = np.dot(pts[j, :] - pts[l, :], n_l)\n            \n            kernel_val = (1j * k / 4.0) * hankel1(1, k * r_norm) * (x_minus_y_dot_n / r_norm)\n            \n            D[j, l] = kernel_val * quad_weight\n\n    # Full system matrix A = -0.5*I + D\n    A = -0.5 * np.eye(N) + D\n\n    # 3. Solve for the density mu\n    mu = linsolve(A, g)\n\n    # 4. Calculate error metrics\n    # Metric 1: Relative boundary residual norm\n    residual_vec = A @ mu - g\n    boundary_residual_norm = norm(residual_vec) / norm(g)\n\n    # Metric 2: Absolute interior error at x0 = (0,0)\n    # The true solution is p_inc(0,0) = exp(ik*0) = 1.0\n    \n    # Kernel for evaluation at the origin x0=(0,0)\n    p_x0 = 0.0\n    \n    # Sum over all source points\n    for l in range(N):\n        r_vec_0l = np.array([0.0, 0.0]) - pts[l, :]\n        r_norm_0l = norm(r_vec_0l) # This is just 'a'\n        n_l = pts[l, :] / a\n        \n        x0_minus_yl_dot_nl = np.dot(r_vec_0l, n_l) # This is -a\n        \n        kernel_val_0l = (1j * k / 4.0) * hankel1(1, k * r_norm_0l) * (x0_minus_yl_dot_nl / r_norm_0l)\n        \n        p_x0 += mu[l] * kernel_val_0l * quad_weight\n        \n    p_inc_x0 = 1.0 # p_inc(x)=(exp(ikx)), p_inc(0)=1\n    interior_error = np.abs(p_x0 - p_inc_x0)\n    \n    return boundary_residual_norm, interior_error\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, k, N)\n        (1.0, 3.0, 64),    # Test Case 1\n        (1.0, 10.0, 256),  # Test Case 2\n        (1.0, 5.5201, 128)  # Test Case 3 (near resonance)\n    ]\n\n    results = []\n    for a, k, N in test_cases:\n        boundary_err, interior_err = solve_bem_case(a, k, N)\n        results.append(boundary_err)\n        results.append(interior_err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}