{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握有限元法，必须从理论走向实践。第一个练习将指导您完成从基本声波方程推导单元刚度矩阵和质量矩阵，并实现它们以解决一个经典问题：计算刚性壁空腔的声学本征模态的完整过程。通过将您的数值结果与已知的解析解进行比较，您将获得整个有限元工作流程的实践经验，并对离散化误差建立直观的理解 。",
            "id": "4122219",
            "problem": "您的任务是推导并数值实现二维刚性壁声腔压力本征模态的有限元列式。该区域是一个边长为 $L_x$ 和 $L_y$（单位：$\\mathrm{m}$）的矩形。假设声学介质是无损、无粘、可压缩的，其行为由压力 $p(\\mathbf{x},t)$ 的线性声波方程控制，并假设壁面为刚性（边界上没有法向质点速度）。使用双线性四边形单元离散化空间域，并采用标准伽辽金法来获得单元刚度、质量和阻尼矩阵。使用这些单元矩阵组装全局矩阵，并求解广义特征值问题以获得最低的几个腔体特征对。将数值波数与刚性壁矩形腔的解析模态进行比较，并量化离散误差。\n\n推导必须从基本原理开始。从均匀介质中压力形式的线性声波方程开始，其中声速为 $c$（单位：$\\mathrm{m/s}$）：\n$$\n\\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} - \\nabla^2 p = 0,\n$$\n在矩形域 $\\Omega$ 中，其边界 $\\partial\\Omega$ 上的外向单位法向量为 $\\mathbf{n}$，刚性壁边界条件要求法向质点速度为零。利用时谐设想 $p(\\mathbf{x},t)=\\Re\\{ \\hat{p}(\\mathbf{x}) e^{\\mathrm{i}\\omega t} \\}$，推导空间亥姆霍兹方程、其弱形式以及使用双线性形函数在参考正方形上进行等参映射到每个单元的有限元离散化。从弱形式出发，通过在每个单元上积分形函数及其梯度的适当乘积，来推导单元刚度、质量和阻尼矩阵。您不能假设或引用任何预先推导好的有限元矩阵；相反，必须从弱形式和使用雅可比矩阵和高斯积分的等参映射来推导它们。\n\n解析参考。对于具有诺伊曼边界条件的刚性壁矩形腔，其解析本征函数是可分离的余弦乘积，波数满足\n$$\nk_{n_x,n_y}^2 = \\left(\\frac{n_x\\pi}{L_x}\\right)^2 + \\left(\\frac{n_y\\pi}{L_y}\\right)^2,\n$$\n其中 $n_x\\ge 0$, $n_y\\ge 0$ 为整数。$n_x=n_y=0$ 的模态是 $k=0$ 的均匀压力场，在比较非平凡模态时可以忽略。角频率为 $\\omega=c\\,k$，频率为 $f=\\omega/(2\\pi)$，但在此任务中，您必须比较波数 $k$（单位：$\\mathrm{m}^{-1}$）。\n\n计算任务：\n- 推导弱形式和有限元矩阵。根据单元贡献组装全局刚度矩阵 $K$ 和质量矩阵 $M$。同时，推导一个与建模为与压力变化率成正比的线性体积损耗相一致的单元阻尼矩阵 $C$；然而，在进行特征对比较时，请使用零阻尼。\n- 求解广义对称正定特征值问题\n$$\nK \\mathbf{p} = \\lambda M \\mathbf{p},\n$$\n其中 $\\lambda = k^2$，$k$ 是波数（单位：$\\mathrm{m}^{-1}$）。通过对最小的几个正特征值 $\\lambda$ 取平方根，提取出最低的几个正波数 $k$。\n- 为相同域生成解析的非平凡波数 $k_{n_x,n_y}$，并将其前几个按索引与数值进行比较。\n- 对于下方的每个测试用例，计算前 $m$ 个非平凡模态的平均绝对相对误差：\n$$\n\\mathrm{err} = \\frac{1}{m}\\sum_{i=1}^{m} \\left| \\frac{k_i^{\\mathrm{num}} - k_i^{\\mathrm{anal}}}{k_i^{\\mathrm{anal}}} \\right|,\n$$\n该误差是无量纲的，必须以小数形式报告。\n\n在等参参考正方形中使用标准的 $2\\times 2$ 高斯积分的双线性四边形单元。您的实现应具有足够的通用性，以处理任何矩形尺寸和均匀网格。\n\n测试套件：\n- 案例 1：$L_x=1.0$ $\\mathrm{m}$，$L_y=0.8$ $\\mathrm{m}$，$x$ 方向 2 个单元，$y$ 方向 2 个单元，$c=343$ $\\mathrm{m/s}$，$m=4$ 个模态。\n- 案例 2：$L_x=1.0$ $\\mathrm{m}$，$L_y=0.8$ $\\mathrm{m}$，$N_x=4$，$N_y=4$，$c=343$ $\\mathrm{m/s}$，$m=4$ 个模态。\n- 案例 3：$L_x=1.0$ $\\mathrm{m}$，$L_y=0.8$ $\\mathrm{m}$，$N_x=8$，$N_y=8$，$c=343$ $\\mathrm{m/s}$，$m=4$ 个模态。\n- 案例 4：$L_x=1.0$ $\\mathrm{m}$，$L_y=0.8$ $\\mathrm{m}$，$N_x=16$，$N_y=16$，$c=343$ $\\mathrm{m/s}$，$m=4$ 个模态。\n\n单位与输出：\n- 所有长度必须以 $\\mathrm{m}$ 为单位，声速以 $\\mathrm{m/s}$ 为单位，波数以 $\\mathrm{m}^{-1}$ 为单位。\n- 将每个测试用例的平均绝对相对误差报告为无量纲小数。\n- 您的程序应产生单行输出，其中包含四个测试用例的平均误差，格式为方括号内以逗号分隔的列表，例如 $[e_1,e_2,e_3,e_4]$，其中每个 $e_i$ 都是一个小数。\n\n科学真实性与约束条件：\n- 仅使用概述的假设和推导，从给定的基本定律开始。不要对单元矩阵使用任何快捷公式。\n- 最终比较必须忽略平凡的零波数模态。\n- 通过在取平方根时滤除低于小容差的特征值 $\\lambda$ 来确保数值稳定性。\n\n您的最终答案必须是一个完整的、可运行的程序，该程序执行这些步骤并按指定格式打印结果。",
            "solution": "用户提供了一个有效且适定的问题，要求推导并实现二维有限元方法（FEM），以求解刚性壁矩形腔的声学本征模态。推导将从基本的线性声波方程开始，进而得到亥姆霍兹方程及其对应的弱形式。随后，将推导等参双线性四边形单元的单元刚度、质量和阻尼矩阵。最后，这些单元将构成一个数值程序的基础，用于解决指定的特征值问题，并量化与已知解析解相比的离散误差。\n\n线性、无粘、无损声学的控制方程是声压 $p(\\mathbf{x}, t)$ 的波动方程，其中 $\\mathbf{x} = (x, y)$ 是空间坐标，$t$ 是时间：\n$$\n\\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} - \\nabla^2 p = 0\n$$\n这里，$c$ 是介质中的声速，$\\nabla^2$ 是拉普拉斯算子。区域为矩形 $\\Omega = [0, L_x] \\times [0, L_y]$。边界壁是刚性的，这意味着法向质点速度为零。根据线性化的欧拉方程 $\\rho_0 \\frac{\\partial \\mathbf{v}}{\\partial t} = -\\nabla p$，此边界条件转化为压力上的齐次诺伊曼条件：\n$$\n\\frac{\\partial p}{\\partial n} = \\nabla p \\cdot \\mathbf{n} = 0 \\quad \\text{在 } \\partial\\Omega \\text{ 上}\n$$\n其中 $\\mathbf{n}$ 是边界 $\\partial\\Omega$ 上的外向单位法向量。\n\n为了找到腔体的本征模态（固有频率和模态振型），我们假设一个时谐解形式为 $p(\\mathbf{x},t) = \\Re\\{ \\hat{p}(\\mathbf{x}) e^{\\mathrm{i}\\omega t} \\}$，其中 $\\hat{p}(\\mathbf{x})$ 是复压力幅值，$\\omega$ 是角频率，$\\mathrm{i} = \\sqrt{-1}$。将此设想代入波动方程，得到关于 $\\hat{p}(\\mathbf{x})$ 的不含时亥姆霍兹方程（为简化符号，下文省略帽子）：\n$$\n\\nabla^2 p + \\frac{\\omega^2}{c^2} p = 0 \\quad \\implies \\quad \\nabla^2 p + k^2 p = 0\n$$\n其中 $k = \\omega/c$ 是声学波数。\n\n为了推导有限元列式，我们首先构建亥姆霍兹方程的弱形式。我们用一个足够光滑的检验函数 $w(\\mathbf{x})$ 乘以方程，并在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} w (\\nabla^2 p + k^2 p) \\,d\\Omega = 0\n$$\n对拉普拉斯项应用分部积分（格林第一恒等式）得到：\n$$\n\\int_{\\Omega} (-\\nabla w \\cdot \\nabla p + k^2 w p) \\,d\\Omega + \\int_{\\partial\\Omega} w (\\nabla p \\cdot \\mathbf{n}) \\,dS = 0\n$$\n由于刚性壁边界条件 $\\nabla p \\cdot \\mathbf{n} = 0$，边界积分消失。这样就得到了问题的弱形式：找到 $p \\in H^1(\\Omega)$，使得对于所有检验函数 $w \\in H^1(\\Omega)$：\n$$\n\\int_{\\Omega} \\nabla w \\cdot \\nabla p \\,d\\Omega - k^2 \\int_{\\Omega} w p \\,d\\Omega = 0\n$$\n\n下一步是将域 $\\Omega$ 离散化为由不重叠的有限元 $\\Omega_e$ 组成的网格。在每个单元内，压力场 $p$ 通过节点值 $p_j$ 和形函数 $N_j(\\mathbf{x})$ 的线性组合来近似：\n$$\np(\\mathbf{x}) \\approx p_h(\\mathbf{x}) = \\sum_{j=1}^{N_{\\text{nodes}}} p_j N_j(\\mathbf{x})\n$$\n在伽辽金方法中，检验函数 $w$ 从与试探函数相同的基函数中选取，即对于 $i=1, \\dots, N_{\\text{nodes}}$，$w = N_i(\\mathbf{x})$。将这些代入弱形式，我们得到关于节点压力值 $p_j$ 的线性方程组：\n$$\n\\sum_{j=1}^{N_{\\text{nodes}}} \\left( \\int_{\\Omega} \\nabla N_i \\cdot \\nabla N_j \\,d\\Omega \\right) p_j - k^2 \\sum_{j=1}^{N_{\\text{nodes}}} \\left( \\int_{\\Omega} N_i N_j \\,d\\Omega \\right) p_j = 0\n$$\n该方程对每个基函数 $i=1, \\dots, N_{\\text{nodes}}$ 都必须成立，从而导出矩阵特征值问题：\n$$\n\\mathbf{K} \\mathbf{p} = k^2 \\mathbf{M} \\mathbf{p}\n$$\n其中 $\\mathbf{p}$ 是节点压力向量，全局刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$ 的项为：\n$$\nK_{ij} = \\int_{\\Omega} \\nabla N_i \\cdot \\nabla N_j \\,d\\Omega \\quad \\text{和} \\quad M_{ij} = \\int_{\\Omega} N_i N_j \\,d\\Omega\n$$\n这些全局矩阵是通过对每个单元的贡献求和来组装的：\n$$\nK_{ij} = \\sum_e K_{ij}^e = \\sum_e \\int_{\\Omega_e} \\nabla N_i \\cdot \\nabla N_j \\,d\\Omega \\quad \\text{和} \\quad M_{ij} = \\sum_e M_{ij}^e = \\sum_e \\int_{\\Omega_e} N_i N_j \\,d\\Omega\n$$\n\n我们使用四节点等参四边形单元。几何和场变量都使用相同的形函数进行插值。我们在一个具有局部坐标 $(\\xi, \\eta)$ 的标准参考方域 $\\hat{\\Omega} = [-1, 1] \\times [-1, 1]$ 中定义单元。双线性形函数为：\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n从参考坐标 $(\\xi, \\eta)$ 到物理坐标 $(x, y)$ 的映射由 $\\mathbf{x}(\\xi, \\eta) = \\sum_{a=1}^4 \\mathbf{x}_a N_a(\\xi, \\eta)$ 给出，其中 $\\mathbf{x}_a$ 是单元四个节点的物理坐标。\n\n物理坐标中的导数通过变换的雅可比矩阵 $\\mathbf{J}$ 与参考坐标中的导数相关联：\n$$\n\\begin{pmatrix} \\partial/\\partial\\xi \\\\ \\partial/\\partial\\eta \\end{pmatrix} = \\begin{pmatrix} \\partial x/\\partial\\xi  \\partial y/\\partial\\xi \\\\ \\partial x/\\partial\\eta  \\partial y/\\partial\\eta \\end{pmatrix} \\begin{pmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{pmatrix} = \\mathbf{J}^T \\begin{pmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{pmatrix}\n$$\n雅可比矩阵的标准约定是 $\\mathbf{J} = \\begin{pmatrix} \\partial x/\\partial\\xi  \\partial x/\\partial\\eta \\\\ \\partial y/\\partial\\xi  \\partial y/\\partial\\eta \\end{pmatrix}$。因此 $\\nabla_{\\mathbf{x}} N_a = \\mathbf{J}^{-T} \\nabla_{\\boldsymbol{\\xi}} N_a$。形函数在物理坐标中的梯度为 $\\nabla N_a = (\\partial N_a/\\partial x, \\partial N_a/\\partial y)^T$。\n\n单元矩阵积分必须转换到参考域。面积微元变换为 $d\\Omega = dx\\,dy = \\det(\\mathbf{J}) d\\xi\\,d\\eta$。对于一个具有局部节点索引 $a, b \\in \\{1,2,3,4\\}$ 的单元 '$e$'，其单元刚度矩阵和质量矩阵为：\n$$\nK_{ab}^e = \\int_{-1}^1 \\int_{-1}^1 \\left( \\nabla_{\\mathbf{x}} N_a \\cdot \\nabla_{\\mathbf{x}} N_b \\right) \\det(\\mathbf{J}) \\,d\\xi\\,d\\eta\n$$\n$$\nM_{ab}^e = \\int_{-1}^1 \\int_{-1}^1 N_a N_b \\det(\\mathbf{J}) \\,d\\xi\\,d\\eta\n$$\n这些积分使用 $2 \\times 2$ 高斯积分进行数值计算。对于一个函数 $f(\\xi, \\eta)$，其积分近似为 $\\int_{-1}^1 \\int_{-1}^1 f(\\xi, \\eta) \\,d\\xi\\,d\\eta \\approx \\sum_{g=1}^4 w_g f(\\xi_g, \\eta_g)$，其中 $(\\xi_g, \\eta_g)$ 是高斯点，$w_g$ 是对应的权重。对于 $2 \\times 2$ 积分，点是 $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$，所有权重都是 $1$。\n\n题目还要求了阻尼矩阵。将与压力变化率成正比的线性体积损耗建模，会给波动方程增加一项 $\\beta \\frac{\\partial p}{\\partial t}$。\n$$\n\\frac{1}{c^2}\\frac{\\partial^2 p}{\\partial t^2} + \\beta \\frac{\\partial p}{\\partial t} - \\nabla^2 p = 0\n$$\n应用时谐设想得到 $\\left(-\\frac{\\omega^2}{c^2} + \\mathrm{i}\\omega\\beta \\right) p - \\nabla^2 p = 0$。弱形式增加了一项 $\\int_\\Omega \\mathrm{i}\\omega\\beta w p \\,d\\Omega$。在无阻尼情况下，这将离散化为一个时域矩阵方程 $\\frac{1}{c^2}\\mathbf{M} \\ddot{\\mathbf{p}} + \\mathbf{C} \\dot{\\mathbf{p}} + \\mathbf{K} \\mathbf{p} = \\mathbf{0}$，其中单元阻尼矩阵 $\\mathbf{C}^e$ 由下式给出：\n$$\nC_{ab}^e = \\int_{\\Omega_e} c^2 \\beta N_a N_b \\, d\\Omega = c^2 \\beta \\int_{-1}^1 \\int_{-1}^1 N_a N_b \\det(\\mathbf{J}) \\,d\\xi\\,d\\eta = c^2 \\beta M_{ab}^e\n$$\n所以，阻尼矩阵与质量矩阵成正比。对于特征值分析，阻尼被忽略（$\\beta=0$）。\n\n最终的步骤是：根据单元对应项组装全局矩阵 $\\mathbf{K}$ 和 $\\mathbf{M}$，求解广义特征值问题 $\\mathbf{K} \\mathbf{p} = \\lambda \\mathbf{M} \\mathbf{p}$ 以得到特征值 $\\lambda_i = k_i^2$，然后计算波数 $k_i = \\sqrt{\\lambda_i}$。将计算出的数值波数与矩形腔的解析值 $k_{n_x, n_y} = \\sqrt{(\\frac{n_x\\pi}{L_x})^2 + (\\frac{n_y\\pi}{L_y})^2}$进行比较，以量化误差。在此比较中，忽略 $k=0$ 的平凡模态（$n_x=n_y=0$）。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the 2D acoustic eigenproblem for a rectangular cavity using FEM\n    and computes the error against the analytical solution for several mesh densities.\n    \"\"\"\n\n    test_cases = [\n        # (Lx, Ly, Nx, Ny, c, m)\n        (1.0, 0.8, 2, 2, 343.0, 4),\n        (1.0, 0.8, 4, 4, 343.0, 4),\n        (1.0, 0.8, 8, 8, 343.0, 4),\n        (1.0, 0.8, 16, 16, 343.0, 4),\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, Nx, Ny, c, m = case\n        error = compute_fem_error(Lx, Ly, Nx, Ny, m)\n        results.append(f\"{error:.8f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef get_analytical_wavenumbers(Lx, Ly, num_modes):\n    \"\"\"\n    Computes the analytical wavenumbers for a rigid-walled rectangular cavity.\n    \"\"\"\n    nx_max = num_modes + 4  # Search a larger space to ensure correct ordering\n    ny_max = num_modes + 4\n    \n    k_sq_anal = []\n    # Generate a set of modes to sort\n    for nx in range(nx_max):\n        for ny in range(ny_max):\n            # The mode (0,0) is the trivial k=0 mode\n            if nx == 0 and ny == 0:\n                continue\n            k_sq = (nx * np.pi / Lx)**2 + (ny * np.pi / Ly)**2\n            k_sq_anal.append(k_sq)\n    \n    # Get unique sorted squared wavenumbers\n    k_sq_anal = sorted(list(set(k_sq_anal)))\n    \n    # Return the first `num_modes` non-trivial wavenumbers\n    return np.sqrt(k_sq_anal[:num_modes])\n\ndef compute_fem_error(Lx, Ly, Nx, Ny, m):\n    \"\"\"\n    Computes the mean absolute relative error for a given FEM setup.\n    \n    Args:\n        Lx, Ly (float): Domain dimensions.\n        Nx, Ny (int): Number of elements in each direction.\n        m (int): Number of non-trivial modes to compare.\n\n    Returns:\n        float: The mean absolute relative error.\n    \"\"\"\n    \n    # 1. Mesh Generation\n    num_nodes_x = Nx + 1\n    num_nodes_y = Ny + 1\n    total_nodes = num_nodes_x * num_nodes_y\n    total_elements = Nx * Ny\n\n    x_coords = np.linspace(0, Lx, num_nodes_x)\n    y_coords = np.linspace(0, Ly, num_nodes_y)\n    nodes = np.array([[x, y] for y in y_coords for x in x_coords])\n\n    elements = np.zeros((total_elements, 4), dtype=int)\n    for iy in range(Ny):\n        for ix in range(Nx):\n            el_idx = iy * Nx + ix\n            n1 = iy * num_nodes_x + ix\n            n2 = n1 + 1\n            n3 = (iy + 1) * num_nodes_x + ix + 1\n            n4 = (iy + 1) * num_nodes_x + ix\n            elements[el_idx] = [n1, n2, n3, n4]\n\n    # 2. FEM Assembly\n    # Gauss quadrature points and weights for 2x2 scheme\n    gp = 1.0 / np.sqrt(3.0)\n    gauss_points = [(-gp, -gp), (gp, -gp), (gp, gp), (-gp, gp)]\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    # Shape functions and their derivatives in reference coordinates\n    def N_vals(xi, eta):\n        return 0.25 * np.array([(1-xi)*(1-eta), (1+xi)*(1-eta), (1+xi)*(1+eta), (1-xi)*(1+eta)])\n\n    def dN_dxi_eta(xi, eta):\n        return 0.25 * np.array([\n            [-(1-eta),  (1-eta), (1+eta), -(1+eta)],  # dN/dxi\n            [-(1-xi),  -(1+xi), (1+xi),  (1-xi)]   # dN/deta\n        ])\n\n    K_global = np.zeros((total_nodes, total_nodes))\n    M_global = np.zeros((total_nodes, total_nodes))\n\n    for el_nodes_indices in elements:\n        el_nodes_coords = nodes[el_nodes_indices]\n        Ke = np.zeros((4, 4))\n        Me = np.zeros((4, 4))\n\n        for i, (xi, eta) in enumerate(gauss_points):\n            w = gauss_weights[i]\n            \n            # Shape functions and their derivatives at the Gauss point\n            N = N_vals(xi, eta)\n            dN_dref = dN_dxi_eta(xi, eta)\n\n            # Jacobian\n            J = np.dot(dN_dref, el_nodes_coords)\n            detJ = np.linalg.det(J)\n            J_inv = np.linalg.inv(J)\n\n            # Derivatives in physical coordinates\n            dN_dphys = np.dot(J_inv, dN_dref)\n\n            # Accumulate element matrices\n            Ke += np.dot(dN_dphys.T, dN_dphys) * detJ * w\n            Me += np.outer(N, N) * detJ * w\n        \n        # Assemble into global matrices\n        ix = np.ix_(el_nodes_indices, el_nodes_indices)\n        K_global[ix] += Ke\n        M_global[ix] += Me\n\n    # 3. Solve Eigenvalue Problem\n    # K.p = lambda * M.p, where lambda = k^2\n    # eigh returns sorted eigenvalues\n    eigenvalues, _ = eigh(K_global, M_global)\n\n    # Filter out small numerical noise (physically, lambda = 0)\n    # The first eigenvalue corresponds to the trivial k=0 mode.\n    # We are interested in the first m non-trivial modes.\n    positive_eigenvalues = eigenvalues[eigenvalues  1e-9]\n    k_num = np.sqrt(positive_eigenvalues[:m])\n\n    # 4. Get Analytical Wavenumbers\n    k_anal = get_analytical_wavenumbers(Lx, Ly, m)\n\n    # 5. Compute Error\n    relative_errors = np.abs((k_num - k_anal) / k_anal)\n    mean_abs_relative_error = np.mean(relative_errors)\n\n    return mean_abs_relative_error\n\nsolve()\n```"
        },
        {
            "introduction": "除了直接的实现，理解刚度矩阵和质量矩阵的数学性质对于稳健的数值模拟至关重要。本练习通过无量纲化的方法，重点分析这些矩阵如何随问题的物理尺寸进行缩放。这个理论练习将揭示为什么数值模型会变得病态，尤其是在高频时，以及适当的缩放如何能够带来更稳定和准确的解 。",
            "id": "4122161",
            "problem": "考虑在声速为常数 $c$、密度为常数 $\\rho$ 的均匀流体中的线性无损声学问题，该流体占据一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$，其中 $d \\in \\{1,2,3\\}$。令 $p(\\mathbf{x},t)$ 表示声压场。从二阶波动方程出发\n$$\n\\frac{1}{c^{2}} \\frac{\\partial^{2} p}{\\partial t^{2}} - \\nabla^{2} p = 0 \\quad \\text{in } \\Omega \\times \\mathbb{R},\n$$\n假设一个角频率为 $\\omega  0$ 的时谐拟设 $p(\\mathbf{x},t) = \\Re\\{ \\hat{p}(\\mathbf{x}) \\exp(-\\mathrm{i}\\,\\omega t) \\}$，这导致了关于复振幅 $\\hat{p}(\\mathbf{x})$ 的 Helmholtz 问题。使用标准 Galerkin 方法，其协调 $H^{1}(\\Omega)$ 有限元空间由基函数 $\\{\\varphi_{j}\\}_{j=1}^{n}$ 张成，得到的半离散系统形式为\n$$\n\\left( \\mathbf{K} - \\frac{\\omega^{2}}{c^{2}} \\mathbf{M} \\right) \\mathbf{u} = \\mathbf{0},\n$$\n其中，逐单元装配的刚度矩阵 $K$ 和质量矩阵 $M$ 的各项由以下公式给出\n$$\nK_{ij} = \\int_{\\Omega} \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}V, \n\\qquad\nM_{ij} = \\int_{\\Omega} \\varphi_{i} \\, \\varphi_{j} \\, \\mathrm{d}V,\n$$\n并且 $\\mathbf{u} \\in \\mathbb{C}^{n}$ 收集了 $\\hat{p}$ 的节点系数。令 $L0$ 为 $\\Omega$ 的特征长度，$p_{0}0$ 为特征压力尺度。引入无量纲变量 $\\tilde{\\mathbf{x}} = \\mathbf{x}/L$ 和 $\\tilde{p} = \\hat{p}/p_{0}$。\n\n从变分形式出发，基于 $(\\tilde{\\mathbf{x}},\\tilde{p})$ 进行无量纲化，并推导刚度矩阵和质量矩阵在用无量纲域 $\\tilde{\\Omega}$ 上的积分表示时，如何随 $L$ 和 $c$ 缩放。具体来说，将离散算子分解为\n$$\nK - \\frac{\\omega^{2}}{c^{2}} M \\;=\\; S(L)\\,\\Big( \\tilde{K} \\;-\\; \\kappa^{2} \\,\\tilde{M} \\Big),\n$$\n其中 $S(L)$ 是一个正标量前因子，$\\kappa$ 是一个无量纲波数，$\\tilde{K}$ 和 $\\tilde{M}$ 是无量纲矩阵，其各项是关于 $\\tilde{\\mathbf{x}}$ 在 $\\tilde{\\Omega}$ 上的积分。用文字解释为什么这种无量纲化能够改善大 $\\omega$ 情况下离散系统的条件数。\n\n答案规格：\n- 以单行矩阵的形式提供三元组 $\\big(a_{K},\\,a_{M},\\,\\kappa\\big)$ 作为你的最终答案，其中 $a_{K}$ 和 $a_{M}$ 是变量替换下的 $L$-缩放因子，使得 $K \\sim a_{K}$ 和 $M \\sim a_{M}$，$\\kappa$ 是由你的缩放定义的无量纲频率。使用符号形式；最终答案框中不要包含单位，也不要提供任何额外文本。",
            "solution": "这个问题是有效的，因为它在科学上基于计算声学和有限元方法的原理，问题本身是良定的，有明确的目标，并且没有任何方法论中列出的导致问题无效的缺陷。\n\n我们从 Helmholtz 方程的变分形式开始，该形式通过将方程乘以一个测试函数 $v \\in H^{1}(\\Omega)$ 并在域 $\\Omega$ 上积分得到。问题是找到 $\\hat{p} \\in H^{1}(\\Omega)$，使得对于所有 $v \\in H^{1}(\\Omega)$：\n$$\n\\int_{\\Omega} \\left( -\\nabla^{2} \\hat{p} - \\frac{\\omega^{2}}{c^{2}} \\hat{p} \\right) v \\, \\mathrm{d}V = 0\n$$\n应用 Green 第一恒等式，并假设齐次 Neumann 边界条件（在 $\\partial\\Omega$上 $\\nabla \\hat{p} \\cdot \\mathbf{n} = 0$），这在给定的离散系统形式中是隐含的，我们得到弱形式：\n$$\n\\int_{\\Omega} \\nabla \\hat{p} \\cdot \\nabla v \\, \\mathrm{d}V - \\frac{\\omega^{2}}{c^{2}} \\int_{\\Omega} \\hat{p} v \\, \\mathrm{d}V = 0\n$$\n在 Galerkin 有限元方法中，未知压力振幅场 $\\hat{p}(\\mathbf{x})$ 和测试函数 $v(\\mathbf{x})$ 被近似为一组 $n$ 个基函数 $\\{\\varphi_{j}(\\mathbf{x})\\}_{j=1}^{n}$ 的线性组合：\n$$\n\\hat{p}(\\mathbf{x}) \\approx \\sum_{j=1}^{n} u_{j} \\varphi_{j}(\\mathbf{x}), \\qquad v(\\mathbf{x}) = \\varphi_{i}(\\mathbf{x})\n$$\n将这些代入弱形式，得到关于系数 $\\mathbf{u} = (u_1, \\dots, u_n)^T$ 的线性方程组：\n$$\n\\sum_{j=1}^{n} \\left( \\int_{\\Omega} \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}V \\right) u_{j} - \\frac{\\omega^{2}}{c^{2}} \\sum_{j=1}^{n} \\left( \\int_{\\Omega} \\varphi_{i} \\varphi_{j} \\, \\mathrm{d}V \\right) u_{j} = 0\n$$\n这就是矩阵系统 $(\\mathbf{K} - \\frac{\\omega^{2}}{c^{2}} \\mathbf{M}) \\mathbf{u} = \\mathbf{0}$，其中刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$ 的各项由以下公式给出：\n$$\nK_{ij} = \\int_{\\Omega} \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}V, \\qquad M_{ij} = \\int_{\\Omega} \\varphi_{i} \\varphi_{j} \\, \\mathrm{d}V\n$$\n现在，我们使用变量替换 $\\mathbf{x} = L\\tilde{\\mathbf{x}}$ 进行无量纲化，其中 $L$ 是特征长度。这将物理域 $\\Omega$ 映射到无量纲域 $\\tilde{\\Omega}$。微分体积元变换为 $\\mathrm{d}V = L^{d} \\, \\mathrm{d}\\tilde{V}$，其中 $d$ 是空间维度。\n根据链式法则，梯度算子变换如下：\n$$\n\\nabla_{\\mathbf{x}} = \\frac{\\partial}{\\partial \\mathbf{x}} = \\frac{\\partial \\tilde{\\mathbf{x}}}{\\partial \\mathbf{x}} \\frac{\\partial}{\\partial \\tilde{\\mathbf{x}}} = \\frac{1}{L} \\nabla_{\\tilde{\\mathbf{x}}}\n$$\n基函数 $\\{\\varphi_j\\}$ 定义在物理域 $\\Omega$ 上。我们在无量纲域 $\\tilde{\\Omega}$ 上定义一组对应的基函数 $\\{\\tilde{\\varphi}_j\\}$，使得 $\\varphi_{j}(\\mathbf{x}) = \\tilde{\\varphi}_{j}(\\tilde{\\mathbf{x}})$。这是有限元实现中的一个标准选择，其中对物理网格中的所有单元都使用单个参考单元。\n\n让我们将此变量替换应用于刚度矩阵的各项 $K_{ij}$：\n$$\nK_{ij} = \\int_{\\Omega} \\nabla_{\\mathbf{x}} \\varphi_{i}(\\mathbf{x}) \\cdot \\nabla_{\\mathbf{x}} \\varphi_{j}(\\mathbf{x}) \\, \\mathrm{d}V\n$$\n代入变换后的量：\n$$\nK_{ij} = \\int_{\\tilde{\\Omega}} \\left( \\frac{1}{L} \\nabla_{\\tilde{\\mathbf{x}}} \\tilde{\\varphi}_{i}(\\tilde{\\mathbf{x}}) \\right) \\cdot \\left( \\frac{1}{L} \\nabla_{\\tilde{\\mathbf{x}}} \\tilde{\\varphi}_{j}(\\tilde{\\mathbf{x}}) \\right) (L^{d} \\, \\mathrm{d}\\tilde{V})\n$$\n$$\nK_{ij} = \\frac{L^{d}}{L^{2}} \\int_{\\tilde{\\Omega}} \\nabla_{\\tilde{\\mathbf{x}}} \\tilde{\\varphi}_{i}(\\tilde{\\mathbf{x}}) \\cdot \\nabla_{\\tilde{\\mathbf{x}}} \\tilde{\\varphi}_{j}(\\tilde{\\mathbf{x}}) \\, \\mathrm{d}\\tilde{V} = L^{d-2} \\tilde{K}_{ij}\n$$\n其中 $\\tilde{K}_{ij} = \\int_{\\tilde{\\Omega}} \\nabla_{\\tilde{\\mathbf{x}}} \\tilde{\\varphi}_{i} \\cdot \\nabla_{\\tilde{\\mathbf{x}}} \\tilde{\\varphi}_{j} \\, \\mathrm{d}\\tilde{V}$ 是无量纲刚度矩阵 $\\tilde{\\mathbf{K}}$ 的一项。因此，刚度矩阵缩放为 $\\mathbf{K} = L^{d-2} \\tilde{\\mathbf{K}}$。缩放因子是 $a_{K} = L^{d-2}$。\n\n接下来，我们将此变量替换应用于质量矩阵的各项 $M_{ij}$：\n$$\nM_{ij} = \\int_{\\Omega} \\varphi_{i}(\\mathbf{x}) \\varphi_{j}(\\mathbf{x}) \\, \\mathrm{d}V\n$$\n代入变换后的量：\n$$\nM_{ij} = \\int_{\\tilde{\\Omega}} \\tilde{\\varphi}_{i}(\\tilde{\\mathbf{x}}) \\tilde{\\varphi}_{j}(\\tilde{\\mathbf{x}}) (L^{d} \\, \\mathrm{d}\\tilde{V})\n$$\n$$\nM_{ij} = L^{d} \\int_{\\tilde{\\Omega}} \\tilde{\\varphi}_{i}(\\tilde{\\mathbf{x}}) \\tilde{\\varphi}_{j}(\\tilde{\\mathbf{x}}) \\, \\mathrm{d}\\tilde{V} = L^{d} \\tilde{M}_{ij}\n$$\n其中 $\\tilde{M}_{ij} = \\int_{\\tilde{\\Omega}} \\tilde{\\varphi}_{i} \\tilde{\\varphi}_{j} \\, \\mathrm{d}\\tilde{V}$ 是无量纲质量矩阵 $\\tilde{\\mathbf{M}}$ 的一项。因此，质量矩阵缩放为 $\\mathbf{M} = L^{d} \\tilde{\\mathbf{M}}$。缩放因子是 $a_{M} = L^{d}$。\n\n现在我们将这些缩放后的矩阵代回离散系统：\n$$\n\\mathbf{K} - \\frac{\\omega^{2}}{c^{2}} \\mathbf{M} = L^{d-2}\\tilde{\\mathbf{K}} - \\frac{\\omega^{2}}{c^{2}} (L^{d}\\tilde{\\mathbf{M}})\n$$\n我们提取公因子 $L^{d-2}$ 以匹配目标形式：\n$$\n\\mathbf{K} - \\frac{\\omega^{2}}{c^{2}} \\mathbf{M} = L^{d-2} \\left( \\tilde{\\mathbf{K}} - \\frac{\\omega^{2} L^{d}}{c^{2} L^{d-2}} \\tilde{\\mathbf{M}} \\right) = L^{d-2} \\left( \\tilde{\\mathbf{K}} - \\frac{\\omega^{2} L^{2}}{c^{2}} \\tilde{\\mathbf{M}} \\right)\n$$\n此表达式与目标形式 $S(L) ( \\tilde{\\mathbf{K}} - \\kappa^{2} \\tilde{\\mathbf{M}} )$ 相匹配，从中我们可以确定前因子 $S(L) = L^{d-2}$ 和平方的无量纲波数 $\\kappa^{2} = (\\omega L / c)^{2}$。因此，无量纲波数为：\n$$\n\\kappa = \\frac{\\omega L}{c}\n$$\n所求量的三元组为 $(a_{K}, a_{M}, \\kappa) = (L^{d-2}, L^{d}, \\frac{\\omega L}{c})$。\n\n关于条件数，无量纲化改善了离散系统的数值稳定性，尤其是在处理浮点运算时。在原始系统 $K - (\\omega^2/c^2)M$ 中，矩阵项取决于特征长度 $L$。对于 $d=3$，$K_{ij} \\sim L$ 且 $M_{ij} \\sim L^3$。如果选择的物理单位使得 $L$ 非常大或非常小，那么 $K$ 和 $M$ 中各项的量级可能会有巨大差异。此外，对于大 $\\omega$，项 $(\\omega^2/c^2)M$ 可能会比 $K$ 大好几个数量级。这会产生一个病态平衡的矩阵，其中对量级悬殊的项求和可能导致显著的精度损失（灾难性抵消），这是一种数值病态。\n\n通过对问题进行缩放，我们得到了系统 $\\tilde{K} - \\kappa^2 \\tilde{M}$。矩阵 $\\tilde{K}$ 和 $\\tilde{M}$ 定义在特征尺寸为1的参考域 $\\tilde{\\Omega}$ 上。它们的项与物理单位或绝对尺度 $L$ 无关，并且通常量级为1。所有来自物理长度和频率的缩放效应都被隔离到单一的标量无量纲参数 $\\kappa = \\omega L / c$ 中。这使得矩阵系统平衡性更好，其中数值挑战由 $\\kappa$ 的大小清晰地表示，而不是与单位的选择纠缠在一起。这种分离提高了鲁棒性，并最大限度地减少了困扰着缩放不良的数值问题的与精度相关的误差。",
            "answer": "$$\\boxed{\\begin{pmatrix} L^{d-2}  L^d  \\frac{\\omega L}{c} \\end{pmatrix}}$$"
        },
        {
            "introduction": "有限元框架的强大之处在于其能够模拟复杂的物理相互作用。最后一个练习通过要求您使用阻抗边界条件来模拟流固耦合界面——具体来说是一个弹性板——来展示这一点。您将推导板的机械特性——其质量、刚度和阻尼——如何转化为一个频率相关的边界矩阵，从而提供一个关于这些概念如何用于解决振动声学中实际工程问题的实践范例 。",
            "id": "4122202",
            "problem": "考虑一个薄弹性板片，它将一个静止的可压缩流体域与自由空间分隔开。流体由线性时谐声场建模。在已知表面积上承受均匀声压载荷时，该板片表现出弹性行为，并产生微小的横向位移。您必须从第一性原理出发，推导出该板片的有效声阻抗 $Z(\\omega)$，并使用有限元法（FEM）将其实现为声学域中的边界矩阵贡献。然后，您必须评估该阻抗及由此产生的边界矩阵对角频率的依赖性。角频率使用弧度/秒，并用指定单位表示任何需要物理单位的量。\n\n使用的基本原理：\n- 频域中的声学线性动量平衡，其中环境密度为 $\\rho_0$ 的流体遵循声压与质点速度之间的线性化关系。\n- 用于板片横向运动的小变形结构动力学，其中单元质量、阻尼和刚度的定义应保持一致（如果载荷对称性、板片的均匀性和薄性证明其合理，则允许模态降阶至单个广义坐标）。\n- 声阻抗的定义，即边界处声压与法向质点速度的复数比。\n\n任务：\n1. 从上述基本定律和定义出发，推导流体所见的板片有效声阻抗 $Z(\\omega)$ 的表达式，明确显示单元质量、阻尼和刚度如何包含在内。您的推导必须与通过板片区域上的均匀压力载荷实现的物理上有意义的耦合相一致。\n2. 使用流体中压力的亥姆霍兹方程的标准弱形式，推导在使用双节点线性形函数、在长度为 $L$ 的直边界段上施加阻抗边界条件时所产生的边界矩阵形式。乘以边界内积的系数必须用 $\\omega$、$\\rho_0$ 和 $Z(\\omega)$ 表示，并且边界单元矩阵的各项必须通过对单元上的形函数乘积进行精确积分得到。\n3. 实现一个程序，对下方的每个测试用例，计算：\n   - $Z(\\omega)$ 的实部（单位：$\\mathrm{Pa\\cdot s/m}$）。\n   - $Z(\\omega)$ 的虚部（单位：$\\mathrm{Pa\\cdot s/m}$）。\n   - 对于长度为 $L$、使用双节点线性形函数的直边界段，所得 $2\\times 2$ 边界单元矩阵的弗罗贝尼乌斯范数（无量纲）。\n   您的程序必须使用推导出的表达式，并且不得依赖外部数据。\n\n采用的假设：\n- 板片很薄，在其面积上受到均匀压力作用时，其行为如同一个单自由度振子，具有广义质量 $m$、粘性阻尼 $c$、刚度 $k$ 和总受载面积 $A$。\n- 时间依赖性为 $\\mathrm{e}^{\\mathrm{i}\\omega t}$ 的谐波形式，其中 $\\mathrm{i}$ 是虚数单位。\n- 声学网格中的边界段是直的，长度为 $L$，并且在该段上阻抗是恒定的。\n\n单位：\n- 质量 $m$ 单位为 $\\mathrm{kg}$。\n- 阻尼 $c$ 单位为 $\\mathrm{N\\cdot s/m}$。\n- 刚度 $k$ 单位为 $\\mathrm{N/m}$。\n- 面积 $A$ 单位为 $\\mathrm{m^2}$。\n- 环境密度 $\\rho_0$ 单位为 $\\mathrm{kg/m^3}$。\n- 边界段长度 $L$ 单位为 $\\mathrm{m}$。\n- 角频率 $\\omega$ 单位为 $\\mathrm{rad/s}$。\n- 阻抗 $Z(\\omega)$ 单位为 $\\mathrm{Pa\\cdot s/m}$。\n- 边界矩阵的弗罗贝尼乌斯范数是无量纲的。\n\n测试套件：\n为以下参数集提供结果，这些参数集旨在覆盖一个代表性的“理想路径”、小阻尼下的近共振行为以及一个高频状态：\n\n- 工况 1（理想路径）：$m=2.0$, $c=10.0$, $k=5000.0$, $A=0.5$, $\\rho_0=1.225$, $L=1.0$, $\\omega=10.0$。\n- 工况 2（近共振，小阻尼）：$m=2.0$, $c=0.1$, $k=5000.0$, $A=0.5$, $\\rho_0=1.225$, $L=1.0$, $\\omega=50.0$。\n- 工况 3（高频）：$m=2.0$, $c=10.0$, $k=5000.0$, $A=0.5$, $\\rho_0=1.225$, $L=0.2$, $\\omega=200.0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例必须按顺序贡献一个包含三个浮点数的列表 $[\\Re(Z),\\Im(Z),\\|B\\|_F]$，其中 $\\Re(Z)$ 和 $\\Im(Z)$ 的单位是 $\\mathrm{Pa\\cdot s/m}$，$\\|B\\|_F$ 是无量纲的。将每个浮点数四舍五入到 $5$ 位小数。例如：$[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$。",
            "solution": "已根据指定标准对用户提供的问题进行了分析和验证。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n- **物理系统**：一个分隔静止可压缩流体域与自由空间的薄弹性板。\n- **流体模型**：由线性化动量平衡控制的线性时谐声场，环境流体密度为 $\\rho_0$。\n- **结构模型**：板被建模为单自由度振子，具有广义质量 $m$、粘性阻尼 $c$ 和刚度 $k$，在表面积 $A$ 上对均匀声压产生微小横向位移响应。\n- **时间约定**：谐波时间依赖性形式为 $\\mathrm{e}^{\\mathrm{i}\\omega t}$，其中 $\\mathrm{i}$ 为虚数单位，$\\omega$ 为角频率。\n- **声阻抗定义**：$Z(\\omega)$ 是流固界面处声压与法向质点速度的复数比。\n- **有限元（FEM）公式**：任务要求使用压力的亥姆霍兹方程的弱形式，在长度为 $L$ 的直边界段上施加阻抗条件。离散化使用双节点线性形函数。\n- **单位**：所有物理量都指定了相应的国际单位制（SI）单位：$m$（kg），$c$（$\\mathrm{N\\cdot s/m}$），$k$（$\\mathrm{N/m}$），$A$（$\\mathrm{m^2}$），$\\rho_0$（$\\mathrm{kg/m^3}$），$L$（$\\mathrm{m}$），$\\omega$（$\\mathrm{rad/s}$），$Z(\\omega)$（$\\mathrm{Pa\\cdot s/m}$）。\n- **测试数据**：为计算提供了三个特定的参数集（测试用例）。\n\n#### 步骤2：使用提取的已知条件进行验证\n- **科学依据（关键）**：该问题基于线性声学（亥姆霍兹方程）、结构动力学（单自由度振子模型）及其通过阻抗边界条件耦合的基本原理。这些是计算振动声学中的标准且成熟的概念。单自由度模型是对均匀载荷下板片低频响应的有效且常见的简化。\n- **适定性**：问题是适定的。它提供了一套完整的物理参数、模型假设和数学定义，足以推导出阻抗和相应边界矩阵的唯一解析表达式。计算任务定义明确。\n- **客观性（关键）**：问题以客观、精确和标准的科学语言表述，没有歧义或主观论断。\n- **完整性与一致性**：问题是自洽且内部一致的。没有缺失的参数或矛盾的约束。\n- **可行性**：物理模型和参数是现实的，并且在计算上是可行的。\n- **结论**：该问题没有验证清单中列出的任何缺陷。它是一个有效、公式完善的计算声学问题。\n\n#### 步骤3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 推导与求解\n\n解答按要求分为三部分：板的声阻抗推导、相应有限元边界矩阵的推导以及计算实现计划。\n\n#### 第一部分：声阻抗 $Z(\\omega)$ 的推导\n\n我们首先将弹性板建模为单自由度（SDOF）系统。设 $u(t)$ 为板的广义横向位移。该系统在外部力 $F(t)$ 作用下的运动方程为：\n$$ m \\frac{d^2u}{dt^2} + c \\frac{du}{dt} + k u = F(t) $$\n板在其表面积 $A$ 上受到均匀声压 $p(t)$ 的加载。因此总力为 $F(t) = p(t)A$。运动方程变为：\n$$ m \\ddot{u} + c \\dot{u} + k u = p(t)A $$\n我们假设所有动态变量都具有 $\\mathrm{e}^{\\mathrm{i}\\omega t}$ 形式的时谐依赖性。位移和压力可以写成 $u(t) = \\hat{u}\\mathrm{e}^{\\mathrm{i}\\omega t}$ 和 $p(t) = \\hat{p}\\mathrm{e}^{\\mathrm{i}\\omega t}$，其中 $\\hat{u}$ 和 $\\hat{p}$ 是复振幅。时间导数为 $\\dot{u}(t) = \\mathrm{i}\\omega \\hat{u}\\mathrm{e}^{\\mathrm{i}\\omega t}$ 和 $\\ddot{u}(t) = -\\omega^2 \\hat{u}\\mathrm{e}^{\\mathrm{i}\\omega t}$。将这些代入运动方程并除以公因子 $\\mathrm{e}^{\\mathrm{i}\\omega t}$，得到频域方程：\n$$ (-\\omega^2 m + \\mathrm{i}\\omega c + k) \\hat{u} = \\hat{p}A $$\n求解复位移振幅 $\\hat{u}$ 得：\n$$ \\hat{u} = \\frac{\\hat{p}A}{k - \\omega^2 m + \\mathrm{i}\\omega c} $$\n流固界面处的法向质点速度 $v_n(t)$ 是板位移的时间导数，即 $v_n(t) = \\dot{u}(t)$。在频域中，速度的复振幅为 $\\hat{v}_n = \\mathrm{i}\\omega \\hat{u}$。代入 $\\hat{u}$ 的表达式：\n$$ \\hat{v}_n = \\frac{\\mathrm{i}\\omega \\hat{p}A}{k - \\omega^2 m + \\mathrm{i}\\omega c} $$\n声阻抗 $Z(\\omega)$ 定义为边界处复声压振幅与复法向质点速度振幅之比：\n$$ Z(\\omega) = \\frac{\\hat{p}}{\\hat{v}_n} $$\n代入 $\\hat{v}_n$ 的表达式，我们得到板的阻抗：\n$$ Z(\\omega) = \\frac{\\hat{p}}{\\frac{\\mathrm{i}\\omega \\hat{p}A}{k - \\omega^2 m + \\mathrm{i}\\omega c}} = \\frac{k - \\omega^2 m + \\mathrm{i}\\omega c}{\\mathrm{i}\\omega A} $$\n为了求出实部和虚部，我们分离各项：\n$$ Z(\\omega) = \\frac{\\mathrm{i}\\omega c}{\\mathrm{i}\\omega A} + \\frac{k - \\omega^2 m}{\\mathrm{i}\\omega A} = \\frac{c}{A} - \\mathrm{i}\\frac{k - \\omega^2 m}{\\omega A} = \\frac{c}{A} + \\mathrm{i}\\left(\\frac{\\omega^2 m - k}{\\omega A}\\right) $$\n因此，阻抗的实部和虚部分别为：\n$$ \\Re(Z(\\omega)) = \\frac{c}{A} $$\n$$ \\Im(Z(\\omega)) = \\frac{\\omega m}{A} - \\frac{k}{\\omega A} $$\n\n#### 第二部分：有限元边界矩阵的推导\n\n线性声场由复压力振幅 $\\hat{p}$ 的亥姆霍兹方程控制：\n$$ \\nabla^2 \\hat{p} + k_w^2 \\hat{p} = 0 $$\n其中 $k_w = \\omega/c_0$ 是声波数，$c_0$ 是流体中的声速。弱形式通过乘以一个测试函数 $w$ 并在流体域 $\\Omega$ 上积分得到：\n$$ \\int_{\\Omega} (\\nabla^2 \\hat{p} + k_w^2 \\hat{p})w \\,d\\Omega = 0 $$\n对拉普拉斯项应用格林第一恒等式，得到：\n$$ \\int_{\\Omega} (-\\nabla \\hat{p} \\cdot \\nabla w + k_w^2 \\hat{p}w) \\,d\\Omega + \\int_{\\partial \\Omega} w \\frac{\\partial \\hat{p}}{\\partial n} \\,dS = 0 $$\n频域中的线性化动量方程为 $\\nabla \\hat{p} = -\\mathrm{i}\\omega\\rho_0 \\hat{\\mathbf{v}}$，其中 $\\hat{\\mathbf{v}}$ 是复质点速度矢量。压力的法向导数与法向质点速度 $\\hat{v}_n$ 的关系为：\n$$ \\frac{\\partial \\hat{p}}{\\partial n} = \\mathbf{n}\\cdot\\nabla \\hat{p} = -\\mathrm{i}\\omega\\rho_0 (\\mathbf{n}\\cdot\\hat{\\mathbf{v}}) = -\\mathrm{i}\\omega\\rho_0 \\hat{v}_n $$\n使用阻抗关系 $\\hat{p} = Z(\\omega)\\hat{v}_n$，我们可以将 $\\hat{v}_n$ 表示为 $\\hat{v}_n = \\hat{p}/Z(\\omega)$。将其代入压力梯度的表达式中：\n$$ \\frac{\\partial \\hat{p}}{\\partial n} = -\\mathrm{i}\\omega\\rho_0 \\frac{\\hat{p}}{Z(\\omega)} $$\n将此阻抗边界条件代入弱形式的边界积分中：\n$$ \\int_{\\partial \\Omega} w \\left(-\\mathrm{i}\\omega\\rho_0 \\frac{\\hat{p}}{Z(\\omega)}\\right) \\,dS = -\\mathrm{i}\\omega\\rho_0 \\int_{\\partial \\Omega} \\frac{1}{Z(\\omega)} \\hat{p}w \\,dS $$\n完整的弱形式则为：\n$$ \\int_{\\Omega} (\\nabla \\hat{p} \\cdot \\nabla w - k_w^2 \\hat{p}w) \\,d\\Omega - \\mathrm{i}\\omega\\rho_0 \\int_{\\partial \\Omega_I} \\frac{1}{Z(\\omega)} \\hat{p}w \\,dS = 0 $$\n此处我们重新整理了各项，$\\partial\\Omega_I$ 是具有阻抗 $Z(\\omega)$ 的边界部分。边界积分项产生了边界矩阵的贡献。用形函数 $N_i$ 将压力离散化为 $\\hat{p} = \\sum_j P_j N_j$，并设测试函数 $w = N_i$，则边界矩阵 $\\mathbf{B}$ 的各项为：\n$$ \\mathbf{B}_{ij} = \\mathrm{i}\\omega\\rho_0 \\frac{1}{Z(\\omega)} \\int_{\\Gamma_e} N_i N_j \\,dS $$\n对于一个长度为 $L$ 的2节点线性单元，在局部坐标 $\\xi \\in [-1, 1]$ 中的形函数是 $N_1 = (1-\\xi)/2$ 和 $N_2 = (1+\\xi)/2$。积分是在单元长度上进行的，$dS=dx = (L/2)d\\xi$。形函数乘积的积分矩阵是：\n$$ \\int_{\\Gamma_e} \\begin{pmatrix} N_1^2  N_1 N_2 \\\\ N_2 N_1  N_2^2 \\end{pmatrix} \\,dS = \\int_{-1}^1 \\begin{pmatrix} (\\frac{1-\\xi}{2})^2  \\frac{1-\\xi^2}{4} \\\\ \\frac{1-\\xi^2}{4}  (\\frac{1+\\xi}{2})^2 \\end{pmatrix} \\frac{L}{2} \\,d\\xi = \\frac{L}{2} \\begin{pmatrix} 2/3  1/3 \\\\ 1/3  2/3 \\end{pmatrix} = \\frac{L}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n最终的 $2 \\times 2$ 边界单元矩阵 $\\mathbf{B}$ 是：\n$$ \\mathbf{B}(\\omega) = \\frac{\\mathrm{i}\\omega\\rho_0}{Z(\\omega)} \\frac{L}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n#### 第三部分：计算公式\n\n每个测试用例需要计算的量是 $\\Re(Z(\\omega))$、$\\Im(Z(\\omega))$ 和弗罗贝尼乌斯范数 $\\|\\mathbf{B}\\|_F$。\n阻抗分量已在第一部分推导得出：\n$$ \\Re(Z) = \\frac{c}{A}, \\quad \\Im(Z) = \\frac{\\omega m - k/\\omega}{A} $$\n矩阵 $\\mathbf{B}$ 的弗罗贝尼乌斯范数定义为 $\\|\\mathbf{B}\\|_F = \\sqrt{\\sum_{i,j} |B_{ij}|^2}$。设标量前置因子为 $\\alpha = \\frac{\\mathrm{i}\\omega\\rho_0 L}{6Z(\\omega)}$。则 $\\mathbf{B} = \\alpha \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$。\n范数的平方是：\n$$ \\|\\mathbf{B}\\|_F^2 = |2\\alpha|^2 + |\\alpha|^2 + |\\alpha|^2 + |2\\alpha|^2 = (4+1+1+4)|\\alpha|^2 = 10|\\alpha|^2 $$\n范数为 $\\|\\mathbf{B}\\|_F = \\sqrt{10}|\\alpha|$。标量 $\\alpha$ 的模为：\n$$ |\\alpha| = \\left|\\frac{\\mathrm{i}\\omega\\rho_0 L}{6Z(\\omega)}\\right| = \\frac{|\\mathrm{i}|\\omega\\rho_0 L}{6|Z(\\omega)|} = \\frac{\\omega\\rho_0 L}{6|Z(\\omega)|} $$\n其中 $|Z(\\omega)| = \\sqrt{(\\Re(Z))^2 + (\\Im(Z))^2}$。\n因此，弗罗贝尼乌斯范数的最终公式为：\n$$ \\|\\mathbf{B}\\|_F = \\frac{\\sqrt{10} \\omega\\rho_0 L}{6 \\sqrt{(\\frac{c}{A})^2 + (\\frac{\\omega m - k/\\omega}{A})^2}} $$\n这些公式在提供的Python代码中实现，以生成指定测试用例的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective acoustic impedance and boundary matrix norm for a\n    panel-fluid interface based on a derived analytical model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (m, c, k, A, rho0, L, omega)\n    test_cases = [\n        # Case 1 (happy path)\n        (2.0, 10.0, 5000.0, 0.5, 1.225, 1.0, 10.0),\n        # Case 2 (near resonance, small damping)\n        (2.0, 0.1, 5000.0, 0.5, 1.225, 1.0, 50.0),\n        # Case 3 (high frequency)\n        (2.0, 10.0, 5000.0, 0.5, 1.225, 0.2, 200.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current test case\n        m, c, k, A, rho0, L, omega = case\n\n        # 1. Compute the real and imaginary parts of the acoustic impedance Z(omega)\n        # Re(Z) = c / A\n        # Im(Z) = (omega * m - k / omega) / A\n        \n        # Guard against omega being zero, although not in test cases\n        if omega == 0:\n            # At omega=0, Im(Z) is undefined. Handle as an error or special case.\n            # For this problem's constraints, we can assume omega  0.\n            # As a practical matter, impedance would be stiffness dominated and very large.\n            # We'll proceed assuming omega  0 as per the test suite.\n            pass\n\n        re_Z = c / A\n        im_Z = (omega * m - k / omega) / A\n\n        # 2. Compute the Frobenius norm of the boundary element matrix B\n        # ||B||_F = sqrt(10) * |alpha|\n        # alpha = i * omega * rho0 * L / (6 * Z)\n        # |alpha| = omega * rho0 * L / (6 * |Z|)\n        # |Z| = sqrt(Re(Z)^2 + Im(Z)^2)\n        \n        abs_Z = np.sqrt(re_Z**2 + im_Z**2)\n        \n        # Guard against zero impedance (pure resonance with zero damping)\n        if abs_Z == 0:\n            # The norm would be infinite. In the given cases, damping c  0,\n            # so Re(Z)  0 and thus abs_Z  0.\n            frobenius_norm_B = float('inf')\n        else:\n            frobenius_norm_B = (np.sqrt(10) * omega * rho0 * L) / (6 * abs_Z)\n\n        # Store the results for this case, rounded to 5 decimal places\n        case_result = [\n            round(re_Z, 5), \n            round(im_Z, 5), \n            round(frobenius_norm_B, 5)\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format: [[r1,i1,n1],[r2,i2,n2],...]\n    # Using a custom formatter to prevent scientific notation and ensure consistency.\n    def format_list(lst):\n        return f\"[{','.join(f'{x:.5f}' for x in lst)}]\"\n\n    output_str = f\"[{','.join(format_list(res) for res in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}