{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the Finite Element Method lies in transforming a continuous problem, defined by a partial differential equation, into a system of algebraic equations. This exercise guides you through the essential steps of this process at the most fundamental level: a single element . By deriving the weak form from the Helmholtz equation and then computing the entries of the element stiffness and mass matrices for a simple triangular element, you will gain hands-on experience with the core mechanics of FEM in computational acoustics.",
            "id": "4145890",
            "problem": "Consider a time-harmonic acoustic pressure field $p$ in a homogeneous medium with constant mass density and sound speed, modeled in a two-dimensional domain by the scalar Helmholtz equation with wave number $k>0$. Let the strong form be given by $-\\Delta p - k^{2} p = 0$ in an open set $\\Omega \\subset \\mathbb{R}^{2}$, together with a real-valued impedance (Robin) boundary condition $\\partial_{n} p + \\alpha p = 0$ on part of the boundary $\\Gamma_{R} \\subset \\partial \\Omega$, where $\\alpha>0$ is a given constant and $\\partial_{n}$ denotes the outward normal derivative. Assume the remaining boundary is Neumann with zero flux. Using the Finite Element Method (FEM) with linear Lagrange basis functions on a single triangular element $K$, let $K$ have vertices at $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(1,0)$, and $(x_{3},y_{3})=(0,2)$. Assume the edge from node $1$ to node $2$ lies on $\\Gamma_{R}$, and the other edges are interior edges.\n\nStarting from the strong form, derive the variational (weak) formulation on $K$ and specify the linear Lagrange shape functions $\\phi_{1}, \\phi_{2}, \\phi_{3}$ associated with the three vertices of $K$. Then, for this element, compute the element-level bilinear form entries\n$$\na_{ij}^{(K)} \\;=\\; \\int_{K} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j} \\, dx \\;-\\; k^{2} \\int_{K} \\phi_{i}\\,\\phi_{j}\\, dx \\;+\\; \\int_{\\partial K \\cap \\Gamma_{R}} \\alpha\\, \\phi_{i}\\,\\phi_{j}\\, ds\n$$\nfor all $i,j \\in \\{1,2,3\\}$.\n\nExpress the final answer as a single row matrix in the order $\\left(a_{11}^{(K)},\\,a_{12}^{(K)},\\,a_{13}^{(K)},\\,a_{21}^{(K)},\\,a_{22}^{(K)},\\,a_{23}^{(K)},\\,a_{31}^{(K)},\\,a_{32}^{(K)},\\,a_{33}^{(K)}\\right)$, using exact arithmetic and leaving $k$ and $\\alpha$ as symbolic parameters. No rounding is required, and no units need to be specified.",
            "solution": "The governing equation for time-harmonic acoustics in a homogeneous medium is the scalar Helmholtz equation. Starting from the conservation of mass and momentum for small-amplitude disturbances and applying the time-harmonic ansatz $p(\\mathbf{x},t)=\\Re\\{P(\\mathbf{x})\\exp(-\\mathrm{i}\\omega t)\\}$ with angular frequency $\\omega$, one obtains for the spatial amplitude $P$ the boundary value problem $-\\Delta P - k^{2} P = 0$, where $k=\\omega/c$ is the wave number. Imposing a real impedance (Robin) boundary condition $\\partial_{n} P + \\alpha P = 0$ on $\\Gamma_{R}$ and homogeneous Neumann condition elsewhere, the variational (weak) formulation on a subdomain $K \\subset \\Omega$ is obtained by multiplying the strong form by a test function $v$ and integrating by parts:\n$$\n\\int_{K} (-\\Delta p)\\, v \\, dx - k^{2} \\int_{K} p\\, v \\, dx = 0.\n$$\nUsing the identity\n$$\n\\int_{K} (-\\Delta p)\\, v \\, dx = \\int_{K} \\nabla p \\cdot \\nabla v \\, dx - \\int_{\\partial K} \\partial_{n} p \\, v \\, ds,\n$$\nand imposing the boundary conditions, the natural boundary contribution on the Robin edge is\n$$\n-\\int_{\\partial K \\cap \\Gamma_{R}} \\partial_{n} p \\, v \\, ds = \\int_{\\partial K \\cap \\Gamma_{R}} \\alpha \\, p \\, v \\, ds,\n$$\nwhile Neumann boundary with zero flux adds nothing to the bilinear form. Therefore, the element-level bilinear form is\n$$\na^{(K)}(p,v) \\;=\\; \\int_{K} \\nabla p \\cdot \\nabla v \\, dx \\;-\\; k^{2} \\int_{K} p\\, v \\, dx \\;+\\; \\int_{\\partial K \\cap \\Gamma_{R}} \\alpha\\, p\\, v\\, ds.\n$$\nIn the Finite Element Method (FEM) using linear Lagrange basis functions on the triangle $K$ with vertices $(0,0)$, $(1,0)$, $(0,2)$, the standard nodal shape functions $\\{\\phi_{i}\\}_{i=1}^{3}$ are the barycentric coordinates. Using the area-coordinate representation,\n$$\n\\phi_{i}(x,y) \\;=\\; \\frac{a_{i} + b_{i} x + c_{i} y}{2A},\n$$\nwhere $A$ is the area of $K$, and for each vertex $i$, $(a_{i},b_{i},c_{i})$ are computed from the other two vertices $(x_{j},y_{j})$ and $(x_{k},y_{k})$ as\n$$\na_{i} = x_{j} y_{k} - x_{k} y_{j}, \\quad b_{i} = y_{j} - y_{k}, \\quad c_{i} = x_{k} - x_{j}.\n$$\nFor our triangle, the area is\n$$\nA \\;=\\; \\frac{1}{2} \\, |(x_{2}-x_{1})(y_{3}-y_{1}) - (x_{3}-x_{1})(y_{2}-y_{1})| \\;=\\; \\frac{1}{2}\\,(1\\cdot 2 - 0\\cdot 0) \\;=\\; 1.\n$$\nCompute $(a_{i},b_{i},c_{i})$:\n- For $i=1$ with $(j,k)=(2,3)$,\n$$\na_{1} = x_{2} y_{3} - x_{3} y_{2} = 1\\cdot 2 - 0\\cdot 0 = 2,\\quad b_{1} = y_{2} - y_{3} = 0 - 2 = -2,\\quad c_{1} = x_{3} - x_{2} = 0 - 1 = -1,\n$$\nso\n$$\n\\phi_{1}(x,y) = \\frac{2 - 2x - y}{2} = 1 - x - \\frac{y}{2}.\n$$\n- For $i=2$ with $(j,k)=(3,1)$,\n$$\na_{2} = x_{3} y_{1} - x_{1} y_{3} = 0\\cdot 0 - 0\\cdot 2 = 0,\\quad b_{2} = y_{3} - y_{1} = 2 - 0 = 2,\\quad c_{2} = x_{1} - x_{3} = 0 - 0 = 0,\n$$\nso\n$$\n\\phi_{2}(x,y) = \\frac{0 + 2x + 0\\cdot y}{2} = x.\n$$\n- For $i=3$ with $(j,k)=(1,2)$,\n$$\na_{3} = x_{1} y_{2} - x_{2} y_{1} = 0\\cdot 0 - 1\\cdot 0 = 0,\\quad b_{3} = y_{1} - y_{2} = 0 - 0 = 0,\\quad c_{3} = x_{2} - x_{1} = 1 - 0 = 1,\n$$\nso\n$$\n\\phi_{3}(x,y) = \\frac{0 + 0\\cdot x + 1\\cdot y}{2} = \\frac{y}{2}.\n$$\nThe gradients are constant on $K$:\n$$\n\\nabla \\phi_{i} = \\frac{1}{2A}\\,(b_{i},\\,c_{i}) = \\frac{1}{2}\\,(b_{i},\\,c_{i}),\n$$\ngiving\n$$\n\\nabla \\phi_{1} = \\left(-1,\\,-\\frac{1}{2}\\right),\\quad \\nabla \\phi_{2} = (1,\\,0),\\quad \\nabla \\phi_{3} = \\left(0,\\,\\frac{1}{2}\\right).\n$$\nBecause these are constant, the stiffness-like contribution\n$$\n\\int_{K} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, dx = A\\, \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j} = \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j},\n$$\nwith $A=1$. Compute all dot products:\n$$\n\\nabla \\phi_{1} \\cdot \\nabla \\phi_{1} = 1 + \\frac{1}{4} = \\frac{5}{4},\\quad \\nabla \\phi_{1} \\cdot \\nabla \\phi_{2} = -1,\\quad \\nabla \\phi_{1} \\cdot \\nabla \\phi_{3} = -\\frac{1}{4},\n$$\n$$\n\\nabla \\phi_{2} \\cdot \\nabla \\phi_{2} = 1,\\quad \\nabla \\phi_{2} \\cdot \\nabla \\phi_{3} = 0,\\quad \\nabla \\phi_{3} \\cdot \\nabla \\phi_{3} = \\frac{1}{4}.\n$$\nNext, the consistent $P_{1}$ mass-like contribution on a triangle with area $A=1$ is given by the formula:\n$$\n\\int_{K} \\phi_{i}\\,\\phi_{j}\\, dx = A \\frac{1+\\delta_{ij}}{12} =\n\\begin{cases}\n\\frac{1}{6}, & i=j \\\\\n\\frac{1}{12}, & i\\neq j\n\\end{cases}\n$$\nwhich can be verified either by direct integration or by standard formulas for linear triangular elements. Therefore, the internal bilinear entries are\n$$\n\\left[\\int_{K} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, dx\\right] - k^{2}\\left[\\int_{K} \\phi_{i}\\,\\phi_{j}\\, dx\\right]\n=\n\\begin{cases}\n\\frac{5}{4} - \\frac{k^{2}}{6}, & (i,j)=(1,1) \\\\\n-1 - \\frac{k^{2}}{12}, & (i,j)=(1,2)\\text{ or }(2,1) \\\\\n-\\frac{1}{4} - \\frac{k^{2}}{12}, & (i,j)=(1,3)\\text{ or }(3,1) \\\\\n1 - \\frac{k^{2}}{6}, & (i,j)=(2,2) \\\\\n0 - \\frac{k^{2}}{12} = -\\frac{k^{2}}{12}, & (i,j)=(2,3)\\text{ or }(3,2) \\\\\n\\frac{1}{4} - \\frac{k^{2}}{6}, & (i,j)=(3,3)\n\\end{cases}\n$$\nNow include the Robin boundary integral on $\\partial K \\cap \\Gamma_{R}$, which is the edge from node $1$ to node $2$. Parameterize this edge by $x \\in [0,1]$ with $y=0$ and $ds=dx$. The restricted shape functions are $\\phi_{1}(x,0) = 1 - x$, $\\phi_{2}(x,0) = x$, and $\\phi_{3}(x,0) = 0$. The boundary contributions are\n$$\n\\int_{\\partial K \\cap \\Gamma_{R}} \\alpha\\, \\phi_{1}\\,\\phi_{1}\\, ds = \\alpha \\int_{0}^{1} (1-x)^{2}\\, dx = \\alpha \\cdot \\frac{1}{3} = \\frac{\\alpha}{3},\n$$\n$$\n\\int_{\\partial K \\cap \\Gamma_{R}} \\alpha\\, \\phi_{2}\\,\\phi_{2}\\, ds = \\alpha \\int_{0}^{1} x^{2}\\, dx = \\alpha \\cdot \\frac{1}{3} = \\frac{\\alpha}{3},\n$$\n$$\n\\int_{\\partial K \\cap \\Gamma_{R}} \\alpha\\, \\phi_{1}\\,\\phi_{2}\\, ds = \\alpha \\int_{0}^{1} x(1-x)\\, dx = \\alpha \\cdot \\frac{1}{6} = \\frac{\\alpha}{6},\n$$\nand all terms involving $\\phi_{3}$ vanish on that edge. Summing internal and boundary contributions yields the complete element bilinear entries:\n$$\na_{11}^{(K)} = \\frac{5}{4} - \\frac{k^{2}}{6} + \\frac{\\alpha}{3},\\quad\na_{12}^{(K)} = -1 - \\frac{k^{2}}{12} + \\frac{\\alpha}{6},\\quad\na_{13}^{(K)} = -\\frac{1}{4} - \\frac{k^{2}}{12},\n$$\n$$\na_{21}^{(K)} = -1 - \\frac{k^{2}}{12} + \\frac{\\alpha}{6},\\quad\na_{22}^{(K)} = 1 - \\frac{k^{2}}{6} + \\frac{\\alpha}{3},\\quad\na_{23}^{(K)} = -\\frac{k^{2}}{12},\n$$\n$$\na_{31}^{(K)} = -\\frac{1}{4} - \\frac{k^{2}}{12},\\quad\na_{32}^{(K)} = -\\frac{k^{2}}{12},\\quad\na_{33}^{(K)} = \\frac{1}{4} - \\frac{k^{2}}{6}.\n$$\nThese are symmetric in $i$ and $j$ as expected. The requested ordering for the final row matrix is $\\left(a_{11}^{(K)},\\,a_{12}^{(K)},\\,a_{13}^{(K)},\\,a_{21}^{(K)},\\,a_{22}^{(K)},\\,a_{23}^{(K)},\\,a_{31}^{(K)},\\,a_{32}^{(K)},\\,a_{33}^{(K)}\\right)$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{5}{4} - \\frac{k^{2}}{6} + \\frac{\\alpha}{3} & -1 - \\frac{k^{2}}{12} + \\frac{\\alpha}{6} & -\\frac{1}{4} - \\frac{k^{2}}{12} & -1 - \\frac{k^{2}}{12} + \\frac{\\alpha}{6} & 1 - \\frac{k^{2}}{6} + \\frac{\\alpha}{3} & -\\frac{k^{2}}{12} & -\\frac{1}{4} - \\frac{k^{2}}{12} & -\\frac{k^{2}}{12} & \\frac{1}{4} - \\frac{k^{2}}{6}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "Realistic acoustic models must accurately capture the behavior of sound at domain boundaries, which often involves energy absorption or radiation. This practice focuses on the variational treatment of impedance boundary conditions, which are crucial for modeling such phenomena . You will derive the specific boundary integral term that arises in the weak formulation and learn how to compute its contribution to the finite element system matrix for a linear edge element, connecting the abstract formulation to concrete, computable quantities.",
            "id": "4145860",
            "problem": "Consider time-harmonic linear acoustics in a bounded domain $\\Omega \\subset \\mathbb{R}^{2}$ with acoustic pressure $p$ governed by the Helmholtz equation and an impedance (Robin-type) boundary condition on a portion of the boundary. Let the governing strong form be\n$$\n\\Delta p + k^{2} p = 0 \\quad \\text{in } \\Omega,\n$$\nwith the boundary condition on $\\Gamma_{\\eta} \\subset \\partial \\Omega$\n$$\n\\frac{\\partial p}{\\partial n} + i \\eta\\, p = 0,\n$$\nwhere $k$ is the wavenumber, $n$ is the outward unit normal, $i$ is the imaginary unit, and $\\eta > 0$ is a real impedance parameter. Derive the weak formulation by multiplying the governing equation by a test function $q$ and integrating by parts. Identify the impedance boundary term that appears on $\\Gamma_{\\eta}$.\n\nNow, consider the Finite Element Method (FEM) with continuous, piecewise linear shape functions on a triangular mesh. Focus on a single straight boundary edge $e = [\\mathbf{x}_{a}, \\mathbf{x}_{b}] \\subset \\Gamma_{\\eta}$ connecting nodes $a$ and $b$, with coordinates $\\mathbf{x}_{a} = (x_{a}, y_{a})$ and $\\mathbf{x}_{b} = (x_{b}, y_{b})$. Using the standard linear shape functions $N_{1}(\\xi) = (1 - \\xi)/2$ and $N_{2}(\\xi) = (1 + \\xi)/2$ defined on the reference segment $\\xi \\in [-1, 1]$, and the arc-length mapping with Jacobian $J_{e} = L_{e}/2$, where\n$$\nL_{e} = \\sqrt{(x_{b} - x_{a})^{2} + (y_{b} - y_{a})^{2}},\n$$\nderive explicit, closed-form expressions for the impedance boundary integrals\n$$\ni \\eta \\int_{e} \\phi_{i}\\,\\phi_{j}\\,ds \\quad \\text{for } i,j \\in \\{a,b\\},\n$$\nin terms of $\\eta$ and $L_{e}$, where $\\phi_{a}$ and $\\phi_{b}$ are the local edge shape functions restricted to $e$ (equal to $N_{1}$ and $N_{2}$ under the reference mapping). Show how to compute these integrals exactly by analytic evaluation on the reference segment, and state the minimum-point Gauss–Legendre quadrature (GLQ) rule that yields exact results for these products.\n\nFinally, instantiate the coordinates and impedance as $x_{a} = 1$, $y_{a} = 2$, $x_{b} = 4$, $y_{b} = 6$, and $\\eta = \\frac{9}{5}$, and provide the resulting $2 \\times 2$ local edge matrix for the impedance term\n$$\n\\left[ i \\eta \\int_{e} \\phi_{i}\\,\\phi_{j}\\,ds \\right]_{i,j \\in \\{a,b\\}}\n$$\nas a single, closed-form analytic expression. No rounding is required, and no units should be included in your final expression.",
            "solution": "The problem statement has been rigorously validated and is determined to be scientifically grounded, well-posed, objective, and complete. It presents a standard, non-trivial problem in computational acoustics that requires the application of fundamental principles of the Finite Element Method (FEM). All necessary data and definitions are provided. We may therefore proceed with the solution.\n\nThe solution is presented in four parts, corresponding to the tasks set forth in the problem.\n\nFirst, we derive the variational (weak) formulation of the governing acoustic problem. The strong form is given by the Helmholtz equation in a domain $\\Omega \\subset \\mathbb{R}^{2}$:\n$$\n\\Delta p + k^{2} p = 0 \\quad \\text{in } \\Omega,\n$$\nwhere $p$ is the complex acoustic pressure amplitude and $k$ is the wavenumber. The boundary condition on a portion of the boundary $\\Gamma_{\\eta} \\subset \\partial \\Omega$ is of the Robin (impedance) type:\n$$\n\\frac{\\partial p}{\\partial n} + i \\eta p = 0 \\quad \\text{on } \\Gamma_{\\eta}.\n$$\nHere, $n$ is the outward unit normal, $i$ is the imaginary unit, and $\\eta > 0$ is a real-valued impedance parameter.\n\nTo derive the weak form, we multiply the Helmholtz equation by an arbitrary test function $q$ belonging to a suitable function space (typically, the Sobolev space $H^{1}(\\Omega)$) and integrate over the domain $\\Omega$:\n$$\n\\int_{\\Omega} q (\\Delta p + k^{2} p) \\, dV = 0.\n$$\nThis can be written as:\n$$\n\\int_{\\Omega} q (\\Delta p) \\, dV + \\int_{\\Omega} k^{2} p q \\, dV = 0.\n$$\nWe apply Green's first identity (which is the multi-dimensional analogue of integration by parts) to the Laplacian term:\n$$\n\\int_{\\Omega} q (\\Delta p) \\, dV = \\int_{\\partial \\Omega} q \\frac{\\partial p}{\\partial n} \\, ds - \\int_{\\Omega} \\nabla q \\cdot \\nabla p \\, dV.\n$$\nSubstituting this back into the integrated equation gives:\n$$\n\\int_{\\partial \\Omega} q \\frac{\\partial p}{\\partial n} \\, ds - \\int_{\\Omega} \\nabla q \\cdot \\nabla p \\, dV + \\int_{\\Omega} k^{2} p q \\, dV = 0.\n$$\nThe boundary integral extends over the entire boundary $\\partial \\Omega$. We now incorporate the impedance boundary condition. The problem only specifies the condition on $\\Gamma_{\\eta}$. Assuming the remainder of the boundary, $\\Gamma_h = \\partial \\Omega \\setminus \\Gamma_{\\eta}$, is a sound-hard wall (a homogeneous Neumann condition, $\\frac{\\partial p}{\\partial n} = 0$), the boundary integral becomes:\n$$\n\\int_{\\partial \\Omega} q \\frac{\\partial p}{\\partial n} \\, ds = \\int_{\\Gamma_{\\eta}} q \\frac{\\partial p}{\\partial n} \\, ds + \\int_{\\Gamma_{h}} q \\frac{\\partial p}{\\partial n} \\, ds = \\int_{\\Gamma_{\\eta}} q (-i \\eta p) \\, ds + \\int_{\\Gamma_{h}} q (0) \\, ds = -i \\eta \\int_{\\Gamma_{\\eta}} p q \\, ds.\n$$\nSubstituting this result into the main equation yields the final weak formulation:\n$$\n\\int_{\\Omega} \\nabla q \\cdot \\nabla p \\, dV - \\int_{\\Omega} k^{2} p q \\, dV + i \\eta \\int_{\\Gamma_{\\eta}} p q \\, ds = 0.\n$$\nThis equation must hold for all admissible test functions $q$. The impedance boundary term that appears on $\\Gamma_{\\eta}$ is precisely $i \\eta \\int_{\\Gamma_{\\eta}} p q \\, ds$.\n\nSecond, we derive the explicit expressions for the local impedance matrix on a boundary edge $e = [\\mathbf{x}_{a}, \\mathbf{x}_{b}] \\subset \\Gamma_{\\eta}$. In the FEM framework, the pressure field $p$ and the test function $q$ are approximated as a sum of products of nodal values and shape functions. Restricted to the edge $e$, these approximations are $p(s) \\approx p_{a}\\phi_a(s) + p_{b}\\phi_b(s)$ and $q(s) \\approx q_{a}\\phi_a(s) + q_{b}\\phi_b(s)$. Substituting these into the impedance boundary integral over the edge $e$ gives rise to a $2 \\times 2$ local matrix, whose entries are given by:\n$$\nM_{ij} = i \\eta \\int_{e} \\phi_i \\phi_j \\, ds \\quad \\text{for } i,j \\in \\{a,b\\}.\n$$\nTo compute these integrals, we map the physical edge $e$ to a reference segment $\\xi \\in [-1, 1]$. The local shape functions $\\phi_a$ and $\\phi_b$ on $e$ correspond to the reference linear shape functions $N_1(\\xi) = (1-\\xi)/2$ and $N_2(\\xi) = (1+\\xi)/2$, respectively. The differential arc length element $ds$ transforms as $ds = J_e d\\xi$, where the Jacobian $J_e = L_e/2$ and $L_e$ is the length of the edge $e$.\n\nThe four entries of the matrix are computed as follows:\n$M_{aa} = i \\eta \\int_{e} \\phi_a^2 \\, ds = i \\eta \\int_{-1}^{1} N_1(\\xi)^2 J_e \\, d\\xi = i \\eta \\frac{L_e}{2} \\int_{-1}^{1} \\left(\\frac{1-\\xi}{2}\\right)^2 d\\xi$.\n$M_{ab} = M_{ba} = i \\eta \\int_{e} \\phi_a \\phi_b \\, ds = i \\eta \\int_{-1}^{1} N_1(\\xi)N_2(\\xi) J_e \\, d\\xi = i \\eta \\frac{L_e}{2} \\int_{-1}^{1} \\frac{1-\\xi}{2}\\frac{1+\\xi}{2} d\\xi$.\n$M_{bb} = i \\eta \\int_{e} \\phi_b^2 \\, ds = i \\eta \\int_{-1}^{1} N_2(\\xi)^2 J_e \\, d\\xi = i \\eta \\frac{L_e}{2} \\int_{-1}^{1} \\left(\\frac{1+\\xi}{2}\\right)^2 d\\xi$.\n\nWe evaluate the integrals on the reference segment analytically:\n$\\int_{-1}^{1} N_1(\\xi)^2 d\\xi = \\frac{1}{4} \\int_{-1}^{1} (1 - 2\\xi + \\xi^2) d\\xi = \\frac{1}{4} \\left[\\xi - \\xi^2 + \\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{1}{4} \\left( (\\frac{1}{3}) - (-\\frac{7}{3}) \\right) = \\frac{1}{4}(\\frac{8}{3}) = \\frac{2}{3}$.\n$\\int_{-1}^{1} N_2(\\xi)^2 d\\xi = \\frac{1}{4} \\int_{-1}^{1} (1 + 2\\xi + \\xi^2) d\\xi = \\frac{1}{4} \\left[\\xi + \\xi^2 + \\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{1}{4} \\left( (\\frac{7}{3}) - (-\\frac{1}{3}) \\right) = \\frac{1}{4}(\\frac{8}{3}) = \\frac{2}{3}$.\n$\\int_{-1}^{1} N_1(\\xi)N_2(\\xi) d\\xi = \\frac{1}{4} \\int_{-1}^{1} (1 - \\xi^2) d\\xi = \\frac{1}{4} \\left[\\xi - \\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{1}{4} \\left( (\\frac{2}{3}) - (-\\frac{2}{3}) \\right) = \\frac{1}{4}(\\frac{4}{3}) = \\frac{1}{3}$.\n\nSubstituting these results back, we obtain the explicit closed-form expressions for the matrix entries in terms of $\\eta$ and $L_e$:\n$M_{aa} = i \\eta \\frac{L_e}{2} \\cdot \\frac{2}{3} = i \\eta \\frac{L_e}{3}$.\n$M_{ab} = M_{ba} = i \\eta \\frac{L_e}{2} \\cdot \\frac{1}{3} = i \\eta \\frac{L_e}{6}$.\n$M_{bb} = i \\eta \\frac{L_e}{2} \\cdot \\frac{2}{3} = i \\eta \\frac{L_e}{3}$.\nThe local impedance matrix is therefore:\n$$\n\\mathbf{M}_e = \\begin{pmatrix} M_{aa} & M_{ab} \\\\ M_{ba} & M_{bb} \\end{pmatrix} = i \\eta \\frac{L_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\n\nThird, we determine the minimum-point Gauss-Legendre quadrature (GLQ) rule that integrates these matrix entries exactly. The integrands are products of the linear shape functions, such as $N_1(\\xi)^2$ or $N_1(\\xi)N_2(\\xi)$. Since the shape functions are polynomials of degree $1$ in $\\xi$, the integrands are polynomials of degree $2$. A GLQ rule with $N_p$ points integrates polynomials of degree up to $2 N_p - 1$ exactly. To exactly integrate a polynomial of degree $2$, we must have $2 N_p - 1 \\ge 2$, which implies $2 N_p \\ge 3$, or $N_p \\ge 1.5$. Since the number of points must be an integer, the minimum number of points required is $N_p = 2$. Therefore, the $2$-point Gauss-Legendre quadrature rule is the minimum-point rule that yields exact results for these integrals.\n\nFourth, we instantiate the problem with the given numerical values and compute the final matrix. The nodal coordinates are $\\mathbf{x}_{a} = (1, 2)$ and $\\mathbf{x}_{b} = (4, 6)$. The length of the edge $e$ is:\n$$\nL_e = \\sqrt{(x_b - x_a)^2 + (y_b - y_a)^2} = \\sqrt{(4-1)^2 + (6-2)^2} = \\sqrt{3^2 + 4^2} = \\sqrt{9+16} = \\sqrt{25} = 5.\n$$\nThe impedance parameter is given as $\\eta = \\frac{9}{5}$.\nWe substitute these values into the derived local edge matrix formula:\n$$\n\\mathbf{M}_e = i \\eta \\frac{L_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = i \\left(\\frac{9}{5}\\right) \\frac{5}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = i \\frac{45}{30} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = i \\frac{3}{2} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\nMultiplying the scalar into the matrix gives the final result:\n$$\n\\mathbf{M}_e = i \\begin{pmatrix} \\frac{3}{2} \\cdot 2 & \\frac{3}{2} \\cdot 1 \\\\ \\frac{3}{2} \\cdot 1 & \\frac{3}{2} \\cdot 2 \\end{pmatrix} = i \\begin{pmatrix} 3 & \\frac{3}{2} \\\\ \\frac{3}{2} & 3 \\end{pmatrix} = \\begin{pmatrix} 3i & \\frac{3}{2}i \\\\ \\frac{3}{2}i & 3i \\end{pmatrix}.\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3i & \\frac{3}{2}i \\\\\n\\frac{3}{2}i & 3i\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Solving for the resonant modes of an acoustic cavity is a classic eigenvalue problem, but it comes with important mathematical subtleties. This exercise explores the nature of the Laplace–Neumann eigenproblem, which governs sound in a perfectly rigid cavity . You will investigate why a zero eigenvalue, corresponding to a non-physical constant pressure mode, naturally appears and learn the standard variational technique used to constrain the function space, ensuring the problem is well-posed and the resulting solutions are physically meaningful.",
            "id": "4145876",
            "problem": "Consider a homogeneous, inviscid acoustic fluid of constant mass density $\\rho_0$ and speed of sound $c$ occupying a bounded, connected domain $\\Omega \\subset \\mathbb{R}^d$ with sufficiently smooth boundary $\\Gamma$. The linearized equations for small-amplitude acoustics are the continuity equation $\\partial_t \\rho' + \\rho_0 \\nabla \\cdot \\mathbf{u} = 0$, the momentum equation $\\rho_0 \\partial_t \\mathbf{u} = -\\nabla p'$, and the constitutive relation $p' = c^2 \\rho'$, where $\\rho'$ is the density fluctuation, $\\mathbf{u}$ is the particle velocity, and $p'$ is the acoustic pressure fluctuation. On a perfectly rigid wall, the normal velocity vanishes, so $\\mathbf{u} \\cdot \\mathbf{n} = 0$ on $\\Gamma$, where $\\mathbf{n}$ is the outward unit normal.\n\nAssume time-harmonic fields with angular frequency $\\omega > 0$, so $p'(\\mathbf{x}, t) = \\Re\\{ p(\\mathbf{x}) e^{\\mathrm{i} \\omega t} \\}$ and $\\mathbf{u}(\\mathbf{x}, t) = \\Re\\{ \\mathbf{u}(\\mathbf{x}) e^{\\mathrm{i} \\omega t} \\}$, which leads to the Helmholtz equation $-\\Delta p = k^2 p$ in $\\Omega$ with $k = \\omega / c$, and the Neumann boundary condition $\\partial_n p = 0$ on $\\Gamma$. Consider the associated Laplace–Neumann eigenproblem: find eigenpairs $(\\lambda, p)$ with $p \\not\\equiv 0$ such that\n$$\n-\\Delta p = \\lambda p \\quad \\text{in } \\Omega, \\qquad \\partial_n p = 0 \\quad \\text{on } \\Gamma.\n$$\nIts variational (weak) formulation is: find $(\\lambda, p)$ with $p \\in H^1(\\Omega) \\setminus \\{0\\}$ such that\n$$\n\\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x} = \\lambda \\int_{\\Omega} p \\, q \\, \\mathrm{d}\\mathbf{x} \\quad \\text{for all } q \\in H^1(\\Omega).\n$$\n\nWhich option correctly explains, from first principles, why a zero eigenvalue is present in this Neumann eigenproblem, and also states an appropriate variational constraint to remove the constant mode from the variational space so that the bilinear form becomes coercive on the constrained space?\n\nA. The constant functions satisfy $\\partial_n p = 0$ on $\\Gamma$ and have $\\nabla p = \\mathbf{0}$ in $\\Omega$, so they belong to the kernel of the bilinear form and produce the eigenvalue $\\lambda = 0$. To remove this mode, restrict to the mean-zero subspace $V_0 = \\{ v \\in H^1(\\Omega) : \\int_{\\Omega} v \\, \\mathrm{d}\\mathbf{x} = 0 \\}$.\n\nB. The zero eigenvalue appears because boundary curvature creates surface modes with $\\lambda = 0$; removing them requires imposing the constraint $\\int_{\\Gamma} \\partial_n v \\, \\mathrm{d}s = 0$ on the variational space.\n\nC. The zero eigenvalue arises from the invariance of the physics under uniform pressure offsets due to compressibility; it can be removed by fixing the pressure at a single point, $v(\\mathbf{x}_0) = 0$ for some $\\mathbf{x}_0 \\in \\Omega$.\n\nD. The zero eigenvalue is a consequence of the gradient operator being divergence-free on a closed domain; removal is achieved by requiring $\\int_{\\Omega} \\nabla v \\, \\mathrm{d}\\mathbf{x} = \\mathbf{0}$ in the variational space.\n\nE. The Neumann boundary condition $\\partial_n p = 0$ makes the weak bilinear form coercive, so there is no zero eigenvalue; to avoid any constant mode, add absorption by replacing the bilinear form with $\\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x} + \\alpha \\int_{\\Omega} p \\, q \\, \\mathrm{d}\\mathbf{x}$ for some $\\alpha > 0$.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n- **Governing Equations (Linearized Acoustics):**\n    - Continuity: $\\partial_t \\rho' + \\rho_0 \\nabla \\cdot \\mathbf{u} = 0$\n    - Momentum: $\\rho_0 \\partial_t \\mathbf{u} = -\\nabla p'$\n    - Constitutive: $p' = c^2 \\rho'$\n- **Physical Parameters:**\n    - $\\rho_0$: constant mass density\n    - $c$: constant speed of sound\n- **Domain:**\n    - A bounded, connected domain $\\Omega \\subset \\mathbb{R}^d$ with a sufficiently smooth boundary $\\Gamma$.\n- **Time-Harmonic Assumption:**\n    - $p'(\\mathbf{x}, t) = \\Re\\{ p(\\mathbf{x}) e^{\\mathrm{i} \\omega t} \\}$\n    - $\\mathbf{u}(\\mathbf{x}, t) = \\Re\\{ \\mathbf{u}(\\mathbf{x}) e^{\\mathrm{i} \\omega t} \\}$\n    - $\\omega > 0$ is the angular frequency.\n- **Resulting Strong Form (Helmholtz Equation):**\n    - Equation: $-\\Delta p = k^2 p$ in $\\Omega$, with $k = \\omega / c$.\n    - Boundary Condition (Perfectly Rigid Wall): $\\mathbf{u} \\cdot \\mathbf{n} = 0$ on $\\Gamma$, which implies $\\partial_n p = 0$ on $\\Gamma$.\n- **Associated Laplace–Neumann Eigenproblem (Strong Form):**\n    - Find eigenpairs $(\\lambda, p)$ with $p \\not\\equiv 0$ such that:\n    $$-\\Delta p = \\lambda p \\quad \\text{in } \\Omega, \\qquad \\partial_n p = 0 \\quad \\text{on } \\Gamma.$$\n- **Laplace–Neumann Eigenproblem (Variational/Weak Form):**\n    - Find $(\\lambda, p)$ with $p \\in H^1(\\Omega) \\setminus \\{0\\}$ such that:\n    $$ \\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x} = \\lambda \\int_{\\Omega} p \\, q \\, \\mathrm{d}\\mathbf{x} \\quad \\text{for all } q \\in H^1(\\Omega). $$\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is a standard exposition of the Laplace-Neumann eigenproblem, derived from the physics of small-amplitude acoustics in a rigid cavity.\n\n- **Scientifically Grounded:** The derivation from linearized acoustic equations to the Helmholtz equation and the corresponding Neumann boundary condition for a rigid wall is standard and correct. The formulation of the Laplace-Neumann eigenproblem and its variational form are fundamental topics in partial differential equations and functional analysis. All principles invoked are well-established.\n- **Well-Posed:** The problem asks for an explanation of a known property of the Laplace-Neumann eigenproblem (the zero eigenvalue) and the standard method to handle it in the variational setting. The question is precise and has a unique, correct answer based on the theory of elliptic PDEs.\n- **Objective:** The language is formal and objective. All terms like $H^1(\\Omega)$, bilinear form, coercivity, etc., have precise mathematical definitions.\n\nThe problem statement is valid. It is scientifically sound, mathematically rigorous, self-contained, and poses a clear, objective question.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution derivation.\n\n## Solution Derivation\n\nThe problem asks for an explanation of the zero eigenvalue in the Laplace–Neumann eigenproblem and a method to restore coercivity to the associated variational form.\n\nThe variational form of the eigenvalue problem is: find $(\\lambda, p) \\in \\mathbb{R} \\times (H^1(\\Omega) \\setminus \\{0\\})$ such that for all test functions $q \\in H^1(\\Omega)$,\n$$ a(p, q) = \\lambda m(p,q) $$\nwhere the bilinear form $a(p,q)$ and the mass form $m(p,q)$ are defined as:\n$$ a(p, q) = \\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x} $$\n$$ m(p, q) = \\int_{\\Omega} p \\, q \\, \\mathrm{d}\\mathbf{x} $$\n\n**1. Explanation of the Zero Eigenvalue ($\\lambda = 0$)**\n\nAn eigenvalue $\\lambda$ is a value for which a non-trivial eigenfunction $p$ exists. Let's test the case $\\lambda = 0$. The variational equation becomes: find $p \\in H^1(\\Omega) \\setminus \\{0\\}$ such that\n$$ a(p, q) = \\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x} = 0 \\quad \\text{for all } q \\in H^1(\\Omega). $$\nTo find what this condition implies for $p$, we can make the specific choice of test function $q = p$. This is permissible since $p \\in H^1(\\Omega)$. The equation then becomes:\n$$ \\int_{\\Omega} \\nabla p \\cdot \\nabla p \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} |\\nabla p|^2 \\, \\mathrm{d}\\mathbf{x} = 0. $$\nSince the integrand $|\\nabla p|^2$ is non-negative, the integral can only be zero if the integrand is zero almost everywhere in $\\Omega$. That is,\n$$ |\\nabla p|^2 = 0 \\implies \\nabla p = \\mathbf{0} \\quad \\text{almost everywhere in } \\Omega. $$\nFor a function in $H^1(\\Omega)$ on a connected domain $\\Omega$, having a zero gradient implies that the function must be a constant, i.e., $p(\\mathbf{x}) = C$ for some constant $C$. Since we are looking for a non-trivial eigenfunction ($p \\not\\equiv 0$), we must have $C \\neq 0$.\nThus, any non-zero constant function is an eigenfunction corresponding to the eigenvalue $\\lambda = 0$.\n\nMathematically, this means the kernel of the Laplace operator with Neumann boundary conditions is the space of constant functions. In the variational setting, the set of constant functions constitutes the kernel of the bilinear form $a(\\cdot, \\cdot)$, since for $p=C$, $a(C,q) = \\int_\\Omega \\nabla C \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x} = \\int_\\Omega \\mathbf{0} \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x} = 0$ for all $q$.\n\n**2. Coercivity and the Variational Constraint**\n\nThe bilinear form $a(v,v)$ defines the square of the $H^1$ semi-norm: $\\|v\\|_{H^1, \\text{semi}}^2 = \\int_{\\Omega} |\\nabla v|^2 \\, \\mathrm{d}\\mathbf{x}$. For many theoretical results and numerical stability, this bilinear form needs to be coercive on the function space $V$. Coercivity requires that there exists a constant $\\alpha > 0$ such that for all $v \\in V$:\n$$ a(v,v) \\ge \\alpha \\|v\\|_{H^1}^2 $$\nwhere the squared $H^1$ norm is $\\|v\\|_{H^1}^2 = \\int_{\\Omega} v^2 \\, \\mathrm{d}\\mathbf{x} + \\int_{\\Omega} |\\nabla v|^2 \\, \\mathrm{d}\\mathbf{x}$.\n\nOn the full space $V = H^1(\\Omega)$, the form $a(v,v)$ is not coercive. As shown above, for any non-zero constant function $v=C$, we have $a(C,C) = 0$, but $\\|C\\|_{H^1}^2 = \\int_\\Omega C^2 \\, \\mathrm{d}\\mathbf{x} = C^2|\\Omega| > 0$. The condition $0 \\ge \\alpha (C^2|\\Omega|)$ cannot be satisfied for any $\\alpha > 0$.\n\nTo make the bilinear form coercive, we must restrict the space $H^1(\\Omega)$ to a subspace that does not contain the kernel of the semi-norm (i.e., the constant functions). A standard way to do this is to enforce a constraint that is violated by any non-zero constant function. The most common and natural constraint is to require functions to have a zero mean value. We define the constrained space:\n$$ V_0 = \\left\\{ v \\in H^1(\\Omega) : \\int_{\\Omega} v \\, \\mathrm{d}\\mathbf{x} = 0 \\right\\}. $$\nFor any non-zero constant function $v=C$, $\\int_\\Omega C \\, \\mathrm{d}\\mathbf{x} = C|\\Omega| \\neq 0$, so non-zero constants are excluded from $V_0$. On this space $V_0$, the Poincaré-Wirtinger inequality holds, which states that there is a constant $C_P > 0$ (depending on $\\Omega$) such that for all $v \\in V_0$:\n$$ \\int_{\\Omega} v^2 \\, \\mathrm{d}\\mathbf{x} \\le C_P \\int_{\\Omega} |\\nabla v|^2 \\, \\mathrm{d}\\mathbf{x}. $$\nUsing this, we can check for coercivity on $V_0$:\n$$ \\|v\\|_{H^1}^2 = \\int_{\\Omega} v^2 \\, \\mathrm{d}\\mathbf{x} + \\int_{\\Omega} |\\nabla v|^2 \\, \\mathrm{d}\\mathbf{x} \\le C_P \\int_{\\Omega} |\\nabla v|^2 \\, \\mathrm{d}\\mathbf{x} + \\int_{\\Omega} |\\nabla v|^2 \\, \\mathrm{d}\\mathbf{x} = (C_P+1) a(v,v). $$\nTherefore, for any $v \\in V_0$:\n$$ a(v,v) \\ge \\frac{1}{C_P+1} \\|v\\|_{H^1}^2. $$\nWith $\\alpha = 1/(C_P+1) > 0$, the bilinear form $a(\\cdot, \\cdot)$ is coercive on the mean-zero subspace $V_0$.\n\n## Option-by-Option Analysis\n\n**A. The constant functions satisfy $\\partial_n p = 0$ on $\\Gamma$ and have $\\nabla p = \\mathbf{0}$ in $\\Omega$, so they belong to the kernel of the bilinear form and produce the eigenvalue $\\lambda = 0$. To remove this mode, restrict to the mean-zero subspace $V_0 = \\{ v \\in H^1(\\Omega) : \\int_{\\Omega} v \\, \\mathrm{d}\\mathbf{x} = 0 \\}$.**\nThis option correctly identifies that constant functions are the eigenfunctions for $\\lambda=0$. The reasoning is precise: a constant $p$ has $\\nabla p = \\mathbf{0}$, which makes it an element of the kernel of the bilinear form $a(p,q) = \\int \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x}$. It also correctly identifies the standard method for restoring coercivity: restricting the variational space to functions with zero mean.\n**Verdict: Correct.**\n\n**B. The zero eigenvalue appears because boundary curvature creates surface modes with $\\lambda = 0$; removing them requires imposing the constraint $\\int_{\\Gamma} \\partial_n v \\, \\mathrm{d}s = 0$ on the variational space.**\nThe explanation for the zero eigenvalue is incorrect. The mode is a constant (bulk) function, not a surface mode related to curvature. The problem exists even for domains with no curvature, like a square or cube. The proposed constraint is also ineffective; any constant function $v=C$ has $\\partial_n v = 0$, so $\\int_{\\Gamma} \\partial_n v \\, \\mathrm{d}s = \\int_{\\Gamma} 0 \\, \\mathrm{d}s = 0$. This constraint does not exclude constants.\n**Verdict: Incorrect.**\n\n**C. The zero eigenvalue arises from the invariance of the physics under uniform pressure offsets due to compressibility; it can be removed by fixing the pressure at a single point, $v(\\mathbf{x}_0) = 0$ for some $\\mathbf{x}_0 \\in \\Omega$.**\nThe physical intuition about invariance to pressure offsets is valid (it comes from the momentum equation containing $\\nabla p'$). However, the explanation is less precise than A in the context of the variational problem. The proposed constraint, fixing the function value at a point, does indeed remove constant functions and can lead to coercivity via a Poincaré-type inequality. However, this method is less canonical than the mean-zero constraint for this problem, and its validity depends on Sobolev embedding theorems that may not hold for all $d$. The explanation and method in A are more standard and direct.\n**Verdict: Incorrect.**\n\n**D. The zero eigenvalue is a consequence of the gradient operator being divergence-free on a closed domain; removal is achieved by requiring $\\int_{\\Omega} \\nabla v \\, \\mathrm{d}\\mathbf{x} = \\mathbf{0}$ in the variational space.**\nThe explanation \"gradient operator being divergence-free\" is mathematically confused. The divergence of a gradient is the Laplacian, $\\nabla \\cdot (\\nabla v) = \\Delta v$. The condition $\\Delta v = 0$ is part of the problem for $\\lambda=0$, not an explanation for it. The proposed constraint is $\\int_{\\Omega} \\nabla v \\, \\mathrm{d}\\mathbf{x} = \\mathbf{0}$. By the divergence theorem, this is equivalent to $\\int_{\\Gamma} v\\mathbf{n} \\, \\mathrm{d}s = \\mathbf{0}$. A constant function $v=C$ satisfies this constraint since $\\int_{\\Gamma} C\\mathbf{n} \\, \\mathrm{d}s = C\\int_{\\Gamma}\\mathbf{n} \\, \\mathrm{d}s = C \\cdot \\mathbf{0} = \\mathbf{0}$. Thus, the constraint does not remove the constant mode.\n**Verdict: Incorrect.**\n\n**E. The Neumann boundary condition $\\partial_n p = 0$ makes the weak bilinear form coercive, so there is no zero eigenvalue; to avoid any constant mode, add absorption by replacing the bilinear form with $\\int_{\\Omega} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\mathbf{x} + \\alpha \\int_{\\Omega} p \\, q \\, \\mathrm{d}\\mathbf{x}$ for some $\\alpha > 0$.**\nThis option starts with a false premise. As demonstrated, the bilinear form is *not* coercive on $H^1(\\Omega)$ for the pure Neumann problem, and a zero eigenvalue *does* exist. The proposed modification of adding a term to the bilinear form changes the original eigenvalue problem into a different problem, rather than properly constraining the space for the original problem.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}