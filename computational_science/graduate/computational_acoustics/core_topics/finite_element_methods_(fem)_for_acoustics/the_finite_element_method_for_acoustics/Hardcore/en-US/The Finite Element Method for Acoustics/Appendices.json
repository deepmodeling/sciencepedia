{
    "hands_on_practices": [
        {
            "introduction": "A successful finite element simulation begins with a firm grasp of the connection between the physical problem and the numerical model. This practice focuses on translating tangible acoustic properties into the dimensionless parameters that govern numerical accuracy and behavior. By calculating quantities like the mesh-to-wavelength ratio $kh$ and the normalized boundary impedance, you will build intuition for designing effective meshes and implementing meaningful boundary conditions .",
            "id": "4141647",
            "problem": "An inviscid, homogeneous, isotropic fluid domain is modeled using the Finite Element Method (FEM) for time-harmonic acoustics under small-amplitude assumptions. A monochromatic plane wave at frequency $f$ propagates in air at temperature $20^\\circ\\text{C}$, with fluid mass density $\\rho$ and speed of sound $c$. The computational mesh uses linear elements with characteristic size $h$. The exterior boundary is modeled by an impedance boundary condition representing a locally reacting liner with real, frequency-independent specific acoustic impedance $Z_b$. The analysis focuses on the non-dimensional measures $kh$ (the product of the acoustic wavenumber $k$ and the element size $h$) and the impedance ratio $Z_b/Z$, where $Z$ is the plane-wave acoustic impedance of the fluid.\n\nGiven the following physically consistent parameters: $f=850\\,\\text{Hz}$, $\\rho=1.20\\,\\text{kg}\\,\\text{m}^{-3}$, $c=343\\,\\text{m}\\,\\text{s}^{-1}$, $h=0.030\\,\\text{m}$, and $Z_b=330\\,\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}$, use fundamental plane-wave acoustics to:\n- Determine the wavenumber $k$ and the dimensionless discretization parameter $kh$.\n- Determine the fluid plane-wave impedance $Z$ and the impedance ratio $Z_b/Z$.\n- Finally, under normal incidence of the plane wave on the impedance boundary, compute the magnitude of the normal-incidence reflection coefficient based on these quantities.\n\nExpress the final reflection coefficient magnitude as a pure number and round your answer to four significant figures. Do not include units in your final numeric answer.",
            "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n- Frequency: $f=850\\,\\text{Hz}$\n- Fluid mass density: $\\rho=1.20\\,\\text{kg}\\,\\text{m}^{-3}$\n- Speed of sound: $c=343\\,\\text{m}\\,\\text{s}^{-1}$\n- Characteristic element size: $h=0.030\\,\\text{m}$\n- Specific acoustic impedance of the boundary: $Z_b=330\\,\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}$\n- The problem concerns a monochromatic plane wave at normal incidence on an impedance boundary.\n- The final requested quantity is the magnitude of the normal-incidence reflection coefficient, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific and Factual Soundness:** The problem is based on the fundamental principles of linear acoustics. The provided values for the properties of air at $20^\\circ\\text{C}$ (density $\\rho$ and speed of sound $c$) are standard textbook values. The concepts of wavenumber, acoustic impedance, and reflection coefficient are central to wave physics. The units are consistent: the characteristic impedance $Z = \\rho c$ has units of $(\\text{kg}\\,\\text{m}^{-3}) \\times (\\text{m}\\,\\text{s}^{-1}) = \\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$. The unit of pressure, the Pascal, is $\\text{Pa} = \\text{N}\\,\\text{m}^{-2} = (\\text{kg}\\,\\text{m}\\,\\text{s}^{-2})\\,\\text{m}^{-2} = \\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-2}$. Therefore, the unit of specific impedance, $\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}$, is $(\\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-2}) \\times \\text{s} \\times \\text{m}^{-1} = \\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$, which is dimensionally consistent with $Z$.\n- **Well-Posed and Complete:** The problem provides all necessary data to compute the requested quantities. The formulas required are standard and yield a unique solution. The context related to the Finite Element Method (FEM) and the parameter $kh$ serves as a realistic setting for the calculation but does not introduce ambiguity.\n- **Objectivity:** The problem statement is expressed in precise, technical language with no subjective or vague terms.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe solution proceeds in three parts as requested.\n\n**Part 1: Wavenumber $k$ and dimensionless parameter $kh$**\n\nThe acoustic wavenumber $k$ is related to the angular frequency $\\omega$ and the speed of sound $c$. The angular frequency is $\\omega = 2\\pi f$. Thus, the wavenumber is given by:\n$$\nk = \\frac{\\omega}{c} = \\frac{2\\pi f}{c}\n$$\nSubstituting the given values $f=850\\,\\text{Hz}$ and $c=343\\,\\text{m}\\,\\text{s}^{-1}$:\n$$\nk = \\frac{2\\pi(850)}{343} \\approx 15.587\\,\\text{rad}\\,\\text{m}^{-1}\n$$\nThe dimensionless discretization parameter $kh$ is the product of the wavenumber $k$ and the characteristic element size $h=0.030\\,\\text{m}$:\n$$\nkh = \\left(\\frac{2\\pi f}{c}\\right) h = \\frac{2\\pi(850)(0.030)}{343} \\approx 0.4676\n$$\nThis value indicates that the mesh resolution is adequate for a linear element formulation at the given frequency, as it respects the common rule of thumb requiring at least $10$ elements per wavelength.\n\n**Part 2: Fluid impedance $Z$ and impedance ratio $Z_b/Z$**\n\nThe characteristic specific acoustic impedance of the fluid medium, $Z$, for a plane wave is the product of its density $\\rho$ and the speed of sound $c$:\n$$\nZ = \\rho c\n$$\nSubstituting the given values $\\rho=1.20\\,\\text{kg}\\,\\text{m}^{-3}$ and $c=343\\,\\text{m}\\,\\text{s}^{-1}$:\n$$\nZ = (1.20)\\,(343) = 411.6\\,\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}\n$$\nThe impedance ratio is the ratio of the boundary's specific acoustic impedance $Z_b$ to the fluid's characteristic impedance $Z$. The given value is $Z_b=330\\,\\text{Pa}\\,\\text{s}\\,\\text{m}^{-1}$.\n$$\n\\frac{Z_b}{Z} = \\frac{330}{411.6} \\approx 0.80175\n$$\n\n**Part 3: Normal-incidence reflection coefficient magnitude $|R|$**\n\nFor a plane wave at normal incidence upon a surface with normal specific acoustic impedance $Z_b$, the pressure reflection coefficient $R$ is given by:\n$$\nR = \\frac{Z_b - Z}{Z_b + Z}\n$$\nThis can be expressed in terms of the impedance ratio $\\frac{Z_b}{Z}$:\n$$\nR = \\frac{\\frac{Z_b}{Z} - 1}{\\frac{Z_b}{Z} + 1}\n$$\nSubstituting the values for $Z_b$ and $Z$:\n$$\nR = \\frac{330 - 411.6}{330 + 411.6} = \\frac{-81.6}{741.6} \\approx -0.110032\n$$\nThe problem asks for the magnitude of the reflection coefficient, $|R|$:\n$$\n|R| = \\left| \\frac{-81.6}{741.6} \\right| = \\frac{81.6}{741.6} \\approx 0.110032\n$$\nRounding this result to four significant figures gives $0.1100$.",
            "answer": "$$\n\\boxed{0.1100}\n$$"
        },
        {
            "introduction": "One of the most important skills in computational science is verification: ensuring your code correctly solves the mathematical equations. This hands-on exercise guides you through the process of building and verifying a 2D acoustic finite element solver. You will compute the resonant eigenfrequencies of a rectangular cavity and validate your numerical results against the known analytical solution, a classic benchmark for any acoustics code .",
            "id": "4141646",
            "problem": "Consider a two-dimensional rectangular acoustic cavity with rigid walls whose domain is $\\Omega = (0,L_x)\\times(0,L_y)$. Assume a homogeneous, lossless fluid characterized by constant mass density $\\rho$ and speed of sound $c$, with small perturbations so that linear acoustics applies. Starting from the fundamental linearized balance laws and constitutive relation for a compressible fluid, the acoustic pressure $p(x,y,t)$ obeys the scalar wave equation and, for time-harmonic fields $p(x,y,t) = \\Re\\{\\phi(x,y)\\,e^{-i\\omega t}\\}$ with angular frequency $\\omega$, the spatial field $\\phi(x,y)$ satisfies the Helmholtz equation with rigid-wall boundary condition on $\\partial\\Omega$. The rigid walls impose a vanishing normal particle velocity, which corresponds to homogeneous Neumann boundary condition on acoustic pressure. Formulate the frequency-domain weak problem on $\\Omega$ and discretize it using the finite element method (FEM) with conforming piecewise-linear (affine) shape functions on a triangulation of the rectangular domain obtained by splitting each rectangular cell of a structured grid into two triangles. Assemble the global symmetric stiffness and mass matrices and solve the resulting generalized eigenvalue problem to approximate the lowest non-zero eigenfrequencies of the cavity.\n\nFor validation, derive the analytical modal frequencies for a rectangular cavity with rigid walls. The analytical wavenumbers are given by combinations that satisfy the Neumann boundary condition, and yield analytical eigenfrequencies that depend on $(m,n)\\in\\mathbb{N}_0^2$ with the trivial uniform-pressure mode excluded.\n\nYour task is to:\n- Derive the appropriate weak formulation from the base physical laws and boundary conditions specified.\n- Implement a conforming linear-triangle FEM that assembles the global stiffness and mass matrices on a structured triangulation of $\\Omega$, and solves the generalized symmetric eigenvalue problem to obtain the first $N$ non-zero eigenfrequencies.\n- Compute the corresponding first $N$ analytical rigid-wall modal frequencies for the same cavity, and compare the FEM results to the analytical ones by reporting the maximum relative error across the first $N$ non-zero modes.\n\nUse the following test suite of parameter sets, where each parameter set is a tuple $(L_x,L_y,c,N_x,N_y,N)$:\n- Test case $1$: $(L_x,L_y,c,N_x,N_y,N) = (\\,1.2\\,\\text{m},\\,0.8\\,\\text{m},\\,343\\,\\text{m/s},\\,30,\\,20,\\,5\\,)$.\n- Test case $2$: $(L_x,L_y,c,N_x,N_y,N) = (\\,1.0\\,\\text{m},\\,1.0\\,\\text{m},\\,343\\,\\text{m/s},\\,10,\\,10,\\,5\\,)$.\n- Test case $3$: $(L_x,L_y,c,N_x,N_y,N) = (\\,2.0\\,\\text{m},\\,0.5\\,\\text{m},\\,343\\,\\text{m/s},\\,40,\\,10,\\,6\\,)$.\n- Test case $4$: $(L_x,L_y,c,N_x,N_y,N) = (\\,1.0\\,\\text{m},\\,1.0\\,\\text{m},\\,343\\,\\text{m/s},\\,40,\\,40,\\,6\\,)$.\n\nIn each case, $L_x$ and $L_y$ are lengths in meters, $c$ is the speed of sound in meters per second, $(N_x,N_y)$ specifies the number of subdivisions along the $x$- and $y$-directions used to generate the structured grid (which produces $(N_x+1)\\times(N_y+1)$ nodes), and $N$ is the number of non-zero modes to be compared. You must assume rigid-wall (Neumann) boundary conditions on all sides.\n\nPhysical units:\n- Express all eigenfrequencies in hertz (Hz).\n- Compute relative errors as decimal values (unitless) using the formula $|f_{\\text{FEM}}-f_{\\text{analytical}}|/f_{\\text{analytical}}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is the maximum relative error across the first $N$ non-zero modes for that case, rounded to six decimal places (e.g., $[0.012345,0.001234,0.000567,0.045678]$).",
            "solution": "The problem posed is to determine the acoustic eigenfrequencies of a two-dimensional rectangular cavity with rigid walls using the finite element method (FEM) and to validate the numerical results against an analytical solution. The problem is scientifically grounded, well-posed, and provides all necessary information for a complete solution. We proceed with the derivation and implementation.\n\nThe physical system is governed by the scalar wave equation for acoustic pressure $p$. For time-harmonic solutions of the form $p(x,y,t) = \\Re\\{\\phi(x,y)e^{-i\\omega t}\\}$, the spatial pressure distribution $\\phi(x,y)$ within the domain $\\Omega = (0,L_x)\\times(0,L_y)$ satisfies the Helmholtz equation:\n$$ \\nabla^2 \\phi + k^2 \\phi = 0 $$\nwhere $k = \\omega/c$ is the wavenumber, $\\omega$ is the angular frequency, and $c$ is the constant speed of sound. The rigid walls impose a homogeneous Neumann boundary condition, as the normal component of particle velocity is zero, which translates to a zero normal gradient of the pressure field:\n$$ \\frac{\\partial \\phi}{\\partial n} = \\nabla \\phi \\cdot \\mathbf{n} = 0 \\quad \\text{on } \\partial\\Omega $$\nThis constitutes an eigenvalue problem for the squared wavenumber $k^2$.\n\nTo formulate the weak problem, we employ the method of weighted residuals. Multiplying the Helmholtz equation by an arbitrary test function $v$ from the Sobolev space $H^1(\\Omega)$ and integrating over the domain $\\Omega$ yields:\n$$ \\int_{\\Omega} v(\\nabla^2 \\phi + k^2 \\phi) \\, d\\Omega = 0 $$\nApplying Green's first identity to the Laplacian term, we obtain:\n$$ \\int_{\\Omega} (-\\nabla v \\cdot \\nabla \\phi + v k^2 \\phi) \\, d\\Omega + \\oint_{\\partial\\Omega} v \\frac{\\partial \\phi}{\\partial n} \\, dS = 0 $$\nThe boundary integral $\\oint_{\\partial\\Omega} v \\frac{\\partial \\phi}{\\partial n} \\, dS$ vanishes due to the homogeneous Neumann boundary condition. This is a natural boundary condition within this variational framework. The resulting weak formulation is to find $\\phi \\in H^1(\\Omega)$ and $k^2 \\in \\mathbb{R}$ such that for all $v \\in H^1(\\Omega)$:\n$$ \\int_{\\Omega} \\nabla v \\cdot \\nabla \\phi \\, d\\Omega = k^2 \\int_{\\Omega} v \\phi \\, d\\Omega $$\n\nFor the finite element discretization, we partition the domain $\\Omega$ into a mesh of triangular elements. The solution $\\phi$ is approximated within a finite-dimensional subspace $V_h \\subset H^1(\\Omega)$ as a linear combination of nodal basis functions (or shape functions) $N_j(x,y)$:\n$$ \\phi_h(x,y) = \\sum_{j=1}^{N_{nodes}} \\phi_j N_j(x,y) $$\nwhere $\\phi_j$ are the unknown coefficients, representing the value of the pressure field at node $j$, and $N_{nodes}$ is the total number of nodes in the mesh. We use conforming piecewise-linear basis functions, where $N_j$ is equal to $1$ at node $j$ and $0$ at all other nodes. Substituting this approximation for both the solution $\\phi$ and the test function $v$ (using the Galerkin method, where the test functions are the basis functions themselves, $v = N_i$), we obtain a system of linear equations:\n$$ \\sum_{j=1}^{N_{nodes}} \\left( \\int_{\\Omega} \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega \\right) \\phi_j = k^2 \\sum_{j=1}^{N_{nodes}} \\left( \\int_{\\Omega} N_i N_j \\, d\\Omega \\right) \\phi_j \\quad \\text{for } i = 1, \\dots, N_{nodes} $$\nThis can be written in matrix form as a generalized eigenvalue problem:\n$$ \\mathbf{K} \\mathbf{\\Phi} = k^2 \\mathbf{M} \\mathbf{\\Phi} $$\nHere, $\\mathbf{\\Phi}$ is the vector of nodal unknowns, $\\lambda = k^2$ is the eigenvalue, and $\\mathbf{K}$ and $\\mathbf{M}$ are the global stiffness and mass matrices, respectively. Their entries are given by:\n$$ K_{ij} = \\int_{\\Omega} \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega \\quad \\text{and} \\quad M_{ij} = \\int_{\\Omega} N_i N_j \\, d\\Omega $$\nThese global matrices are assembled by summing contributions from each element. For a linear triangular element $e$ with area $A_e$ and nodes $(x_1, y_1), (x_2, y_2), (x_3, y_3)$, the local $3 \\times 3$ element stiffness matrix $\\mathbf{K}^e$ and mass matrix $\\mathbf{M}^e$ are computed. The gradients of linear shape functions are constant over the element. The entry $(i,j)$ of the element stiffness matrix is $K_{ij}^e = (\\nabla N_i \\cdot \\nabla N_j) A_e = (b_i b_j + c_i c_j) A_e$, where the gradient coefficients are $b_k = (y_{k+1}-y_{k+2})/(2A_e)$ and $c_k = (x_{k+2}-x_{k+1})/(2A_e)$ (with cyclic index permutation). The element mass matrix for a linear triangle is given by the standard formula:\n$$ \\mathbf{M}^e = \\frac{A_e}{12} \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix} $$\nThe solved eigenvalues $\\lambda_i = k_i^2$ correspond to the squared wavenumbers. The first eigenvalue, $\\lambda_0$, is zero (or numerically close to zero), corresponding to the trivial constant-pressure mode $(k=0)$. We are interested in the non-zero eigenfrequencies, which are calculated from the subsequent eigenvalues $\\lambda_i > 0$ using the relation $f_i = \\omega_i/(2\\pi) = c k_i/(2\\pi) = c\\sqrt{\\lambda_i}/(2\\pi)$.\n\nFor validation, we derive the analytical solution. The Helmholtz equation with homogeneous Neumann boundary conditions on the rectangle $\\Omega = (0,L_x)\\times(0,L_y)$ is separable. The eigenfunctions are of the form $\\phi_{mn}(x,y) = \\cos(\\frac{m\\pi x}{L_x})\\cos(\\frac{n\\pi y}{L_y})$ for non-negative integer mode indices $m$ and $n$. The corresponding wavenumbers $k_{mn}$ must satisfy:\n$$ k_{mn}^2 = \\left(\\frac{m\\pi}{L_x}\\right)^2 + \\left(\\frac{n\\pi}{L_y}\\right)^2 $$\nThe analytical eigenfrequencies in Hertz are therefore:\n$$ f_{mn} = \\frac{c k_{mn}}{2\\pi} = \\frac{c}{2} \\sqrt{\\left(\\frac{m}{L_x}\\right)^2 + \\left(\\frac{n}{L_y}\\right)^2} $$\nThe trivial mode corresponds to $(m,n)=(0,0)$, which yields $f_{00}=0$. The first $N$ non-zero modes are found by computing $f_{mn}$ for various pairs $(m,n)$ and sorting the results in ascending order, taking care to account for degenerate modes where different pairs $(m,n)$ yield the same frequency. The comparison between the $i$-th FEM frequency $f_{i, \\text{FEM}}$ and the $i$-th analytical frequency $f_{i, \\text{analytical}}$ is performed using the relative error, and the maximum error over the first $N$ non-zero modes is reported.",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import eigsh\n\ndef compute_max_error(Lx, Ly, c, Nx, Ny, N):\n    \"\"\"\n    Computes the maximum relative error for acoustic eigenfrequencies in a 2D cavity.\n\n    This function performs the following steps:\n    1. Generates a structured triangular mesh for the rectangular domain.\n    2. Assembles the global stiffness (K) and mass (M) matrices using linear finite elements.\n    3. Solves the generalized eigenvalue problem K*phi = lambda*M*phi for the lowest eigenmodes.\n    4. Calculates the first N non-zero FEM eigenfrequencies.\n    5. Calculates the first N non-zero analytical eigenfrequencies.\n    6. Computes the maximum relative error between the FEM and analytical results.\n    \"\"\"\n    # 1. Mesh Generation\n    num_nodes = (Nx + 1) * (Ny + 1)\n    dx = Lx / Nx\n    dy = Ly / Ny\n    \n    nodes = np.zeros((num_nodes, 2))\n    node_map = np.zeros((Nx + 1, Ny + 1), dtype=int)\n    idx = 0\n    for iy in range(Ny + 1):\n        for ix in range(Nx + 1):\n            nodes[idx, 0] = ix * dx\n            nodes[idx, 1] = iy * dy\n            node_map[ix, iy] = idx\n            idx += 1\n\n    elements = []\n    for iy in range(Ny):\n        for ix in range(Nx):\n            n1 = node_map[ix, iy]      # Bottom-left\n            n2 = node_map[ix + 1, iy]  # Bottom-right\n            n3 = node_map[ix + 1, iy + 1] # Top-right\n            n4 = node_map[ix, iy + 1]   # Top-left\n            # Split rectangle into two triangles along the n1-n3 diagonal\n            elements.append((n1, n2, n3))\n            elements.append((n1, n3, n4))\n\n    # 2. FEM Assembly\n    K = lil_matrix((num_nodes, num_nodes))\n    M = lil_matrix((num_nodes, num_nodes))\n    \n    M_const = np.array([[2, 1, 1], [1, 2, 1], [1, 1, 2]])\n    \n    for el_nodes in elements:\n        p1_idx, p2_idx, p3_idx = el_nodes\n        p1, p2, p3 = nodes[p1_idx], nodes[p2_idx], nodes[p3_idx]\n        \n        # Element area and shape function gradients\n        area = 0.5 * np.abs(p1[0]*(p2[1]-p3[1]) + p2[0]*(p3[1]-p1[1]) + p3[0]*(p1[1]-p2[1]))\n        \n        b = np.array([p2[1]-p3[1], p3[1]-p1[1], p1[1]-p2[1]]) / (2 * area)\n        c_grad = np.array([p3[0]-p2[0], p1[0]-p3[0], p2[0]-p1[0]]) / (2 * area)\n        \n        # Element stiffness matrix\n        Ke = np.zeros((3, 3))\n        for i in range(3):\n            for j in range(3):\n                Ke[i, j] = (b[i] * b[j] + c_grad[i] * c_grad[j]) * area\n        \n        # Element mass matrix\n        Me = (area / 12.0) * M_const\n        \n        # Assembly (add element matrices to global matrices)\n        ix_ = np.ix_(el_nodes, el_nodes)\n        K[ix_] += Ke\n        M[ix_] += Me\n\n    # 3. Eigenvalue Solver\n    # Convert to CSR format for efficient computation\n    K_csr = K.tocsr()\n    M_csr = M.tocsr()\n\n    # Solve the generalized eigenvalue problem. Request N+1 smallest magnitude eigenvalues.\n    # The smallest should be the zero-frequency mode.\n    # Using sigma=-0.1 targets eigenvalues close to zero, which is more robust.\n    try:\n        eigenvalues, _ = eigsh(K_csr, k=N + 1, M=M_csr, sigma=-0.1, which='LM')\n    except Exception:\n        # Fallback to smallest magnitude if sigma method fails\n        eigenvalues, _ = eigsh(K_csr, k=N + 1, M=M_csr, which='SM')\n        \n    # 4. Post-processing FEM results\n    # Eigenvalues from eigsh with sigma are not guaranteed to be sorted.\n    eigenvalues = np.sort(eigenvalues)\n    # The first eigenvalue corresponds to the k=0 mode and should be close to 0. We discard it.\n    fem_lambdas = eigenvalues[1 : N + 1]\n    fem_freqs = (c / (2 * np.pi)) * np.sqrt(np.maximum(0, fem_lambdas))\n\n    # 5. Analytical Frequencies\n    analytical_freqs_list = []\n    # A generous search space for (m,n) pairs to ensure we find the first N modes\n    m_max = int(N * (Lx/Ly if Ly  0 else 1)) + 5\n    n_max = int(N * (Ly/Lx if Lx  0 else 1)) + 5\n    for m in range(m_max + 1):\n        for n in range(n_max + 1):\n            if m == 0 and n == 0:\n                continue\n            freq = (c / 2.0) * np.sqrt((m / Lx)**2 + (n / Ly)**2)\n            analytical_freqs_list.append(freq)\n    \n    # Sort frequencies to find the lowest N non-zero modes\n    analytical_freqs_list.sort()\n    analytical_freqs = np.array(analytical_freqs_list[:N])\n\n    # 6. Error Calculation\n    if len(fem_freqs) != N or len(analytical_freqs) != N:\n        raise ValueError(\"Could not find the required number of modes.\")\n        \n    relative_errors = np.abs(fem_freqs - analytical_freqs) / analytical_freqs\n    max_relative_error = np.max(relative_errors)\n    \n    return max_relative_error\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (1.2, 0.8, 343, 30, 20, 5),\n        (1.0, 1.0, 343, 10, 10, 5),\n        (2.0, 0.5, 343, 40, 10, 6),\n        (1.0, 1.0, 343, 40, 40, 6),\n    ]\n\n    results = []\n    for params in test_cases:\n        Lx, Ly, c, Nx, Ny, N = params\n        error = compute_max_error(Lx, Ly, c, Nx, Ny, N)\n        results.append(f\"{error:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The output of a numerical simulation is never exact; it always contains errors from various sources. A critical task for the computational scientist is to identify and control these errors. This exercise explores the fundamental distinction between discretization error, which arises from approximating the continuous problem on a mesh, and algebraic error, which stems from the incomplete convergence of iterative solvers, challenging you to correctly interpret the results of a convergence study .",
            "id": "4141624",
            "problem": "Consider a two-dimensional bounded domain $\\Omega \\subset \\mathbb{R}^2$ with Lipschitz boundary $\\partial \\Omega$ on which time-harmonic acoustics with attenuation is modeled. Let the complex acoustic pressure be $p(\\mathbf{x})$ at angular frequency $\\omega$, with mass density $\\rho(\\mathbf{x})0$ and bulk modulus $K(\\mathbf{x})0$, and let attenuation be introduced through a complex wavenumber $k = \\omega/c(1 + i\\eta)$ with $\\eta0$ so that the sesquilinear form is coercive. The governing equation in strong form is\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\rho} \\nabla p\\right) - k^2 p = s \\quad \\text{in } \\Omega,\n$$\nsupplemented by a first-order impedance boundary condition\n$$\n\\frac{1}{\\rho} \\frac{\\partial p}{\\partial n} + i\\beta p = 0 \\quad \\text{on } \\partial \\Omega,\n$$\nwhere $s(\\mathbf{x})$ is a given source, $n$ is the outward unit normal, and $\\beta0$ is the impedance parameter. The weak form reads: find $p \\in H^1(\\Omega)$ such that for all $q \\in H^1(\\Omega)$,\n$$\na(p,q) = \\ell(q),\n$$\nwith\n$$\na(p,q) = \\int_{\\Omega} \\frac{1}{\\rho} \\nabla p \\cdot \\overline{\\nabla q}\\, d\\mathbf{x} - \\int_{\\Omega} k^2 p \\overline{q}\\, d\\mathbf{x} + \\int_{\\partial \\Omega} i\\beta p \\overline{q}\\, ds, \\quad \\ell(q) = \\int_{\\Omega} s \\overline{q}\\, d\\mathbf{x}.\n$$\nDue to $\\eta0$ and $\\beta0$, $a(\\cdot,\\cdot)$ is coercive on $H^1(\\Omega)$ in an energy norm $\\|\\cdot\\|_E$ equivalent to $\\|\\cdot\\|_{H^1(\\Omega)}$.\n\nUsing the Finite Element Method (FEM) with continuous Lagrange elements of polynomial degree $p_{\\text{FE}}=1$ (piecewise linear), one obtains the discrete linear system\n$$\nA_h x_h = b_h,\n$$\nwhere $A_h \\in \\mathbb{C}^{N_h \\times N_h}$ is the stiffness matrix associated with $a(\\cdot,\\cdot)$ on a quasiuniform mesh of size $h$, $b_h$ is the load vector, and $x_h$ is the vector of nodal values of $p_h$. Let $u$ denote the exact solution in $H^1(\\Omega)$, $u_h^\\star$ the exact discrete solution satisfying $A_h u_h^\\star = b_h$, and $u_{h,\\tau}$ the computed solution returned by a Krylov subspace method (e.g., Generalized Minimal Residual (GMRES)) stopped when the relative residual satisfies\n$$\n\\frac{\\|r_h\\|_2}{\\|b_h\\|_2} \\le \\tau, \\quad r_h = b_h - A_h u_{h,\\tau}.\n$$\nDefine the total error split as\n$$\nu - u_{h,\\tau} = (u - u_h^\\star) + (u_h^\\star - u_{h,\\tau}) = e_{\\text{disc}} + e_{\\text{alg}}.\n$$\nAssume the classical a priori estimate $\\|e_{\\text{disc}}\\|_E \\le C h^{\\alpha}$ with $\\alpha=1$ for $p_{\\text{FE}}=1$ on quasiuniform meshes, and that the algebraic error is bounded by $\\|e_{\\text{alg}}\\|_E \\le \\|A_h^{-1}\\| \\, \\|r_h\\|_2$. Suppose a mesh refinement study is performed on three meshes with sizes $h_1$, $h_2 = h_1/2$, and $h_3 = h_2/2$. On each mesh, GMRES is used with two different tolerances, $\\tau = 10^{-2}$ and $\\tau = 10^{-6}$. The observed energy-norm differences between successive mesh solutions are:\n$$\n\\|u_{h_2,10^{-2}} - u_{h_1,10^{-2}}\\|_E = 1.8 \\times 10^{-2}, \\quad \\|u_{h_3,10^{-2}} - u_{h_2,10^{-2}}\\|_E = 1.7 \\times 10^{-2},\n$$\nand\n$$\n\\|u_{h_2,10^{-6}} - u_{h_1,10^{-6}}\\|_E = 8.0 \\times 10^{-3}, \\quad \\|u_{h_3,10^{-6}} - u_{h_2,10^{-6}}\\|_E = 4.0 \\times 10^{-3}.\n$$\nAdditionally, the estimated spectral condition numbers obey $\\kappa(A_{h_1}) \\approx 500$, $\\kappa(A_{h_2}) \\approx 900$, and $\\kappa(A_{h_3}) \\approx 1700$, and the operator norm $\\|A_h\\|$ is $O(1)$ independent of $h$ due to coercivity.\n\nWhich of the following strategies correctly separates discretization error from iterative solver error and yields a reliable estimate of the discretization convergence rate for this acoustics FEM problem?\n\nA. Keep a fixed loose tolerance $\\tau = 10^{-2}$ on all meshes and interpret the observed inter-mesh differences as discretization error. If the differences do not decrease under refinement, conclude the problem is ill-posed.\n\nB. Choose a mesh-dependent tolerance $\\tau_h \\propto h^{\\alpha+1}$ so that the residual decays faster than the discretization error, and then infer the discretization rate from inter-mesh differences without any verification by tightening $\\tau$.\n\nC. For each mesh, select $\\tau_h$ such that $\\|A_h^{-1}\\| \\, \\tau_h \\, \\|b_h\\|_2 \\le 0.1 \\, C h^{\\alpha}$, and verify algebraic error negligibility by further reducing $\\tau_h$ and checking that $u_{h,\\tau}$ changes insignificantly. Then, with algebraic error below the discretization scale, use the sequence $\\|u_{h_{l},\\tau} - u_{h_{l-1},\\tau}\\|_E$ to estimate $\\alpha$ via refinement ratios (e.g., Richardson-type analysis).\n\nD. Increase $\\tau$ until the Krylov solver stagnates on each mesh; once stagnation is observed, accept the inter-mesh differences as dominated by discretization error.\n\nE. Use a single absolute residual tolerance $\\|r_h\\|_2 \\le 10^{-8}$ on all meshes regardless of $\\|b_h\\|_2$ and $\\kappa(A_h)$; if the observed inter-mesh differences decrease, conclude the discretization rate has been isolated without further checks.",
            "solution": "### Problem Validation\nThe problem statement describes a standard numerical experiment in computational science known as a verification study, specifically focused on separating discretization error from algebraic (iterative solver) error.\n- **Scientific Soundness:** The setup is scientifically rigorous. It correctly defines the Helmholtz equation with damping, the corresponding weak form, the FEM discretization, the error decomposition into discretization and algebraic components, and standard error estimates.\n- **Well-Posedness:** The problem correctly states that the presence of attenuation ($\\eta > 0$) and impedance ($\\beta > 0$) makes the sesquilinear form coercive, guaranteeing a well-posed continuous and discrete problem. The question itself is a well-posed conceptual problem about numerical methodology.\n- **Objectivity and Completeness:** The problem is stated objectively, providing all necessary mathematical context and numerical data to arrive at a logical conclusion. The data is internally consistent and reflects behavior commonly seen in such studies.\n\n**Verdict:** The problem is valid and represents an excellent advanced question on numerical verification.\n\n### Solution Analysis\nThe core of the problem is to determine the correct procedure for measuring the discretization error, $e_{\\text{disc}} = u - u_h^\\star$, which is the error inherent in approximating the continuous problem on a finite mesh. Since we cannot compute the true solution $u$, we estimate the convergence rate by observing how the numerical solution changes as the mesh is refined. The key challenge is that we compute $u_{h,\\tau}$, not the exact discrete solution $u_h^\\star$. The total error has two parts: $e_{\\text{disc}}$ and the algebraic error, $e_{\\text{alg}} = u_h^\\star - u_{h,\\tau}$. To measure the discretization error, the algebraic error must be rendered negligible.\n\nLet's analyze the provided numerical data:\n- **With a loose tolerance $\\tau = 10^{-2}$:** The difference between solutions on refined meshes stagnates: $\\|u_{h_2,\\tau} - u_{h_1,\\tau}\\|_E \\approx 1.8 \\times 10^{-2}$ and $\\|u_{h_3,\\tau} - u_{h_2,\\tau}\\|_E \\approx 1.7 \\times 10^{-2}$. The ratio of these differences is nearly 1, not the factor of $2^1=2$ expected for first-order convergence. This is a classic sign that the error is dominated by the algebraic error floor set by the loose solver tolerance, not the discretization error.\n- **With a tight tolerance $\\tau = 10^{-6}$:** The difference between solutions halves upon mesh halving: $\\|u_{h_3,\\tau} - u_{h_2,\\tau}\\|_E / \\|u_{h_2,\\tau} - u_{h_1,\\tau}\\|_E = (4.0 \\times 10^{-3}) / (8.0 \\times 10^{-3}) = 0.5$. This indicates an observed convergence rate of $\\log_2(1/0.5) = 1$, which matches the theoretical rate $\\alpha=1$ for linear elements. This demonstrates that for $\\tau=10^{-6}$, the algebraic error is small enough not to pollute the measurement of the discretization error.\n\nNow we evaluate the proposed strategies based on this understanding.\n\n**A. Incorrect.** This strategy corresponds to the $\\tau=10^{-2}$ experiment. The conclusion that the problem is ill-posed is wrong. The stagnation of error is due to the dominance of the algebraic error from the iterative solver, not a fundamental issue with the PDE.\n\n**B. Incorrect.** While the principle of choosing a mesh-dependent tolerance $\\tau_h$ is sound, the phrase \"without any verification\" is a critical flaw. A priori error estimates contain unknown constants ($C$, $\\|A_h^{-1}\\|$, etc.), so one must always empirically confirm that the chosen tolerance is tight enough. The data in the problem proves the necessity of this verification.\n\n**C. Correct.** This strategy outlines the gold standard for verification studies. It correctly articulates the theoretical goal: make the algebraic error bound ($ \\approx \\|A_h^{-1}\\| \\, \\tau_h \\, \\|b_h\\|_2$) a small fraction of the expected discretization error ($C h^{\\alpha}$). Crucially, it includes the indispensable practical step: \"verify algebraic error negligibility by further reducing $\\tau_h$ and checking that $u_{h,\\tau}$ changes insignificantly.\" Once the algebraic error is confirmed to be under control, the inter-mesh differences can be confidently used to estimate the discretization convergence rate. This procedure precisely matches the logic demonstrated by the successful $\\tau=10^{-6}$ experiment.\n\n**D. Incorrect.** This is the opposite of the correct procedure. Increasing the tolerance $\\tau$ increases the algebraic error, moving further away from the goal of isolating the discretization error. Solver stagnation is a failure mode, not a sign of accuracy.\n\n**E. Incorrect.** Using a fixed *absolute* residual tolerance is not robust. The algebraic error is bounded by $\\|e_{\\text{alg}}\\|_E \\le \\|A_h^{-1}\\| \\, \\|r_h\\|_2$. As the mesh is refined, the condition number $\\kappa(A_h)$ grows, implying that $\\|A_h^{-1}\\|$ also grows. Therefore, to keep the algebraic error $\\|e_{\\text{alg}}\\|_E$ from increasing, the absolute residual $\\|r_h\\|_2$ would need to decrease. A fixed tolerance is insufficient. A *relative* tolerance is generally preferred as it scales with the problem size. This option also lacks the necessary verification step.\n\nTherefore, strategy C is the only one that is both theoretically sound and methodologically complete.",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}