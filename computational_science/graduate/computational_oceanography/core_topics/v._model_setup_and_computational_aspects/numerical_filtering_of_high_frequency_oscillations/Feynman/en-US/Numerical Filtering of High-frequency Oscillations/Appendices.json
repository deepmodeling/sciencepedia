{
    "hands_on_practices": [
        {
            "introduction": "Before any analysis can be performed, data must be collected correctly. This exercise () connects the physical dynamics of inertial oscillations, a ubiquitous feature in the ocean, with the fundamental Nyquist-Shannon sampling theorem. By calculating the minimum sampling rate needed to observe these motions without distortion, you will develop a first-principles understanding of how to design an effective observational program and prevent aliasing.",
            "id": "3803618",
            "problem": "An ocean mooring at latitude $\\phi=45^{\\circ}$ records horizontal current velocity to study inertial oscillations. In the absence of pressure gradients and friction, the horizontal momentum equations on an $f$-plane are governed by the Coriolis acceleration with parameter $f=2\\Omega\\sin\\phi$, where $\\Omega$ is the Earth's rotation rate. You are tasked with designing the sampling strategy so that subsequent numerical filtering does not suffer from aliasing of the inertial band into lower frequencies.\n\nStarting from the linearized momentum equations and the definition of angular frequency, derive the condition on the sampling rate $f_{s}$ (in Hertz, $\\mathrm{s}^{-1}$) required to avoid aliasing of inertial oscillations, and then compute the minimum $f_{s}$ at $\\phi=45^{\\circ}$ using $\\Omega=7.2921159\\times 10^{-5}\\ \\mathrm{s}^{-1}$. Justify the choice of $f_{s}$ from first principles, explicitly invoking the Nyquist-Shannon sampling theorem. Express the final sampling rate in Hertz ($\\mathrm{s}^{-1}$), and round your numerical result to four significant figures.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique and meaningful solution. It will be addressed by first deriving the frequency of inertial oscillations from the governing equations of motion and then applying the Nyquist-Shannon sampling theorem to determine the minimum required sampling rate.\n\nThe horizontal momentum equations on an $f$-plane, in the absence of pressure gradients and friction, describe a balance solely between the local acceleration and the Coriolis force. For a fluid parcel with velocity components $u$ (zonal, positive eastward) and $v$ (meridional, positive northward), these equations are:\n$$\n\\frac{du}{dt} - fv = 0 \\quad (1)\n$$\n$$\n\\frac{dv}{dt} + fu = 0 \\quad (2)\n$$\nHere, $f = 2\\Omega\\sin\\phi$ is the Coriolis parameter, where $\\Omega$ is the Earth's angular rotation rate and $\\phi$ is the latitude.\n\nTo find the characteristic frequency of this system, we can form a single second-order differential equation. Differentiating equation $(1)$ with respect to time $t$ gives:\n$$\n\\frac{d^2u}{dt^2} - f\\frac{dv}{dt} = 0\n$$\nWe can substitute for $\\frac{dv}{dt}$ using equation $(2)$:\n$$\n\\frac{d^2u}{dt^2} - f(-fu) = 0\n$$\n$$\n\\frac{d^2u}{dt^2} + f^2 u = 0\n$$\nThis is the canonical form of the equation for a simple harmonic oscillator, $\\frac{d^2x}{dt^2} + \\omega^2 x = 0$. By direct comparison, the angular frequency of the motion, known as the inertial angular frequency, is:\n$$\n\\omega_{\\text{inertial}} = |f|\n$$\nThe cyclical frequency, $\\nu_{\\text{inertial}}$, is related to the angular frequency by $\\nu = \\frac{\\omega}{2\\pi}$. Therefore, the frequency of inertial oscillations is:\n$$\n\\nu_{\\text{inertial}} = \\frac{|f|}{2\\pi}\n$$\nAt the specified latitude $\\phi=45^{\\circ}$, which is in the Northern Hemisphere, $\\sin\\phi > 0$ and thus $f > 0$. Consequently, $|f| = f$.\n$$\n\\nu_{\\text{inertial}} = \\frac{f}{2\\pi}\n$$\nThis represents the highest frequency component in the idealized system described.\n\nTo prevent aliasing, we must invoke the Nyquist-Shannon sampling theorem. The theorem states that for a bandlimited signal with a maximum frequency component $\\nu_{\\text{max}}$, the sampling frequency $f_s$ must be strictly greater than twice this maximum frequency. This minimum bound, $2\\nu_{\\text{max}}$, is known as the Nyquist frequency. The condition to avoid aliasing is:\n$$\nf_s > 2\\nu_{\\text{max}}\n$$\nIn our case, the maximum frequency of the physical process is the inertial frequency, so $\\nu_{\\text{max}} = \\nu_{\\text{inertial}}$. The condition on the sampling rate is therefore:\n$$\nf_s > 2\\nu_{\\text{inertial}} = 2\\left(\\frac{f}{2\\pi}\\right) = \\frac{f}{\\pi}\n$$\nThe problem asks for the minimum sampling rate required to avoid aliasing. This corresponds to the Nyquist frequency of the system:\n$$\nf_{s, \\text{min}} = 2\\nu_{\\text{inertial}} = \\frac{f}{\\pi} = \\frac{2\\Omega\\sin\\phi}{\\pi}\n$$\nWe are given the values:\n$\\Omega = 7.2921159 \\times 10^{-5}\\ \\mathrm{s}^{-1}$\n$\\phi = 45^{\\circ}$\n\nFirst, we calculate the Coriolis parameter $f$:\n$$\nf = 2 \\times (7.2921159 \\times 10^{-5}\\ \\mathrm{s}^{-1}) \\times \\sin(45^{\\circ})\n$$\nSince $\\sin(45^{\\circ}) = \\frac{\\sqrt{2}}{2}$:\n$$\nf = 2 \\times (7.2921159 \\times 10^{-5}\\ \\mathrm{s}^{-1}) \\times \\frac{\\sqrt{2}}{2} = \\sqrt{2} \\times 7.2921159 \\times 10^{-5}\\ \\mathrm{s}^{-1}\n$$\n$$\nf \\approx 1.03126402 \\times 10^{-4}\\ \\mathrm{s}^{-1}\n$$\nNow, we can compute the minimum required sampling rate $f_{s}$:\n$$\nf_{s} = \\frac{f}{\\pi} \\approx \\frac{1.03126402 \\times 10^{-4}\\ \\mathrm{s}^{-1}}{\\pi} \\approx 3.282639 \\times 10^{-5}\\ \\mathrm{s}^{-1}\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\nf_{s} \\approx 3.283 \\times 10^{-5}\\ \\mathrm{s}^{-1}\n$$\nThis sampling rate is specified in Hertz ($\\mathrm{s}^{-1}$). In practice, one would sample at a rate somewhat higher than this minimum to ensure a clear separation between the signal and the Nyquist frequency. However, the theoretical minimum is what the problem demands.",
            "answer": "$$\n\\boxed{3.283 \\times 10^{-5}}\n$$"
        },
        {
            "introduction": "Once a time series is collected, a common next step is to analyze its frequency content using the Discrete Fourier Transform (DFT). However, the finite length of any real-world dataset introduces an artifact known as spectral leakage, which can obscure the true spectrum. This practice () provides a hands-on method to quantify leakage from a tidal signal and demonstrates the dramatic improvement offered by applying a standard windowing function, a crucial technique for accurate spectral analysis.",
            "id": "3803554",
            "problem": "You are tasked with quantifying spectral leakage of a single harmonic constituent in a discretely sampled oceanographic time series, using two different temporal windows. Consider a single, noiseless, complex sinusoid representing the principal lunar semidiurnal tide (M2) with angular frequency $\\omega_{M2} = 2\\pi / (12.42\\ \\mathrm{h})$. The sinusoid is sampled uniformly in time at interval $\\Delta t$ (expressed in seconds), generating $N$ samples. Analyze the Discrete Fourier Transform (DFT) bin-to-bin leakage caused by windowing.\n\nFundamental base and definitions:\n- The continuous-time sinusoid has angular frequency $\\omega_{0} = \\omega_{M2}$ in $\\mathrm{rad/s}$.\n- Samples are $x[n] = \\exp\\{i \\omega_{0} n \\Delta t\\}$ for $n = 0, 1, \\dots, N-1$, where $i^2 = -1$.\n- The DFT of a length-$N$ sequence $y[n]$ is $Y[k] = \\sum_{n=0}^{N-1} y[n] \\exp\\{-i 2\\pi nk/N\\}$ for $k = 0, 1, \\dots, N-1$.\n- A window $w[n]$ multiplies the time series: $y[n] = w[n] x[n]$.\n- The rectangular window is $w_{\\mathrm{rect}}[n] = 1$ for $0 \\le n \\le N-1$.\n- The Hamming window is $w_{\\mathrm{ham}}[n] = 0.54 - 0.46 \\cos\\left( 2\\pi n/(N-1) \\right)$ for $0 \\le n \\le N-1$.\n- Define the power spectrum as $P[k] = |Y[k]|^{2}$.\n- Let $k_{0}$ be the integer index of the largest-magnitude DFT bin for the windowed sinusoid, $k_{0} = \\arg\\max_{k} |Y[k]|$. Define the neighboring bins as $k_{-} = (k_{0}-1)\\ \\pmod N$ and $k_{+} = (k_{0}+1)\\ \\pmod N$.\n- Define the leakage fraction into neighboring bins for a given window $w$ as\n$$\nL(w) = \\frac{P[k_{-}] + P[k_{+}]}{\\sum_{k=0}^{N-1} P[k]}.\n$$\n\nTasks:\n- For each specified test case, compute $L(w_{\\mathrm{rect}})$ and $L(w_{\\mathrm{ham}})$ and the improvement factor\n$$\nI = \\frac{L(w_{\\mathrm{rect}})}{L(w_{\\mathrm{ham}})}.\n$$\nA value $I > 1$ indicates that the Hamming window reduces leakage into the immediate neighboring bins relative to the rectangular window under the defined metric, while $I  1$ indicates the opposite.\n\nAngle and unit conventions:\n- Use radians for angular quantities.\n- Use seconds for time intervals.\n- $\\omega_{M2}$ must be computed in $\\mathrm{rad/s}$ from the given tidal period in hours by converting hours to seconds using $1\\ \\mathrm{h} = 3600\\ \\mathrm{s}$.\n\nAlgorithmic instructions:\n- Generate the complex sinusoid $x[n]$ with unit amplitude and angular frequency $\\omega_{0}$.\n- Apply each window $w[n]$ separately to form $y[n] = w[n] x[n]$.\n- Compute the $N$-point DFT of $y[n]$ and the corresponding power spectrum $P[k]$.\n- Find $k_{0}$, then compute $L(w)$ as defined.\n- Report $L(w_{\\mathrm{rect}})$, $L(w_{\\mathrm{ham}})$, and $I$ for each test case.\n\nTest suite:\nUse the following four parameter sets, covering a typical case, odd versus even $N$ behavior, and coarse versus fine spectral resolution. For each case, $\\omega_{0} = \\omega_{M2}$.\n\n- Case A (typical month-long hourly sampling): $\\Delta t = 3600\\ \\mathrm{s}$, $N = 744$.\n- Case B (odd length, half-hour sampling to probe near half-bin offsets): $\\Delta t = 1800\\ \\mathrm{s}$, $N = 4095$.\n- Case C (short record, coarse resolution): $\\Delta t = 3600\\ \\mathrm{s}$, $N = 97$.\n- Case D (fine sampling, long record): $\\Delta t = 600\\ \\mathrm{s}$, $N = 10001$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a sub-list of three floating-point numbers in the order $[L(w_{\\mathrm{rect}}), L(w_{\\mathrm{ham}}), I]$.\n- The overall output must therefore be a list of lists, in the order of Cases A, B, C, D, e.g., $[[\\ell_{A,\\mathrm{rect}},\\ell_{A,\\mathrm{ham}},I_{A}], [\\ell_{B,\\mathrm{rect}},\\ell_{B,\\mathrm{ham}},I_{B}], [\\ell_{C,\\mathrm{rect}},\\ell_{C,\\mathrm{ham}},I_{C}], [\\ell_{D,\\mathrm{rect}},\\ell_{D,\\mathrm{ham}},I_{D}]]$.\n- Each number should be printed as a floating-point value. No physical units should be included in the output line.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of digital signal processing (DSP), well-posed with all necessary definitions and parameters provided, and objective in its formulation. The task is to quantify spectral leakage for a discrete time series representing the principal lunar semidiurnal tide ($M2$) when sampled with different time windows. We will proceed with a full solution.\n\nThe core of the problem lies in understanding the consequences of analyzing a finite-length segment of a continuous signal. The Discrete Fourier Transform (DFT) implicitly assumes the finite signal segment repeats periodically. If the true signal frequency does not correspond precisely to one of the DFT's basis frequencies (the frequency \"bins\"), the signal's energy \"leaks\" into adjacent frequency bins. This phenomenon is known as spectral leakage. Windowing is a technique used to mitigate this effect by tapering the signal at its ends, reducing the sharp discontinuities that the DFT would otherwise perceive at the boundaries of the time-domain segment.\n\nOur procedure will be to systematically implement the definitions provided for each test case.\n\nFirst, we establish the fundamental angular frequency of the $M2$ tide, $\\omega_{0}$. Given the period $T_{M2} = 12.42\\ \\mathrm{h}$, we convert this to seconds and compute the angular frequency in $\\mathrm{rad/s}$:\n$$ T_{M2} = 12.42\\ \\mathrm{h} \\times 3600\\ \\mathrm{s/h} = 44712\\ \\mathrm{s} $$\n$$ \\omega_{0} = \\omega_{M2} = \\frac{2\\pi}{T_{M2}} = \\frac{2\\pi}{44712}\\ \\mathrm{rad/s} $$\n\nFor each test case, defined by a sampling interval $\\Delta t$ and a number of samples $N$, we execute the following steps:\n\n1.  **Signal Generation**: We generate the discrete, noiseless, complex sinusoidal signal $x[n]$ for time indices $n = 0, 1, \\dots, N-1$.\n    $$ x[n] = \\exp\\{i \\omega_0 n \\Delta t\\} $$\n    This represents the sampled M2 tidal constituent. The use of a complex exponential simplifies the analysis by placing all the signal's energy at a single positive frequency.\n\n2.  **Window Generation**: We create the two window functions, each of length $N$.\n    -   The rectangular window, $w_{\\mathrm{rect}}[n]$, is a sequence of ones:\n        $$ w_{\\mathrm{rect}}[n] = 1 \\quad \\text{for } n = 0, 1, \\dots, N-1 $$\n    -   The Hamming window, $w_{\\mathrm{ham}}[n]$, is a raised cosine function designed to have lower sidelobes in its frequency response compared to the rectangular window:\n        $$ w_{\\mathrm{ham}}[n] = 0.54 - 0.46 \\cos\\left( \\frac{2\\pi n}{N-1} \\right) \\quad \\text{for } n = 0, 1, \\dots, N-1 $$\n\n3.  **Windowing and DFT Computation**: For each window $w[n]$ (first $w_{\\mathrm{rect}}[n]$, then $w_{\\mathrm{ham}}[n]$), we perform the following:\n    -   The window is applied to the signal via element-wise multiplication to produce the windowed signal $y[n]$:\n        $$ y[n] = w[n] x[n] $$\n    -   We compute the $N$-point Discrete Fourier Transform (DFT) of $y[n]$ to obtain its spectrum, $Y[k]$:\n        $$ Y[k] = \\sum_{n=0}^{N-1} y[n] \\exp\\left\\{-i \\frac{2\\pi nk}{N}\\right\\} \\quad \\text{for } k = 0, 1, \\dots, N-1 $$\n\n4.  **Power Spectrum and Leakage Calculation**:\n    -   From the DFT output $Y[k]$, we compute the power spectrum $P[k]$:\n        $$ P[k] = |Y[k]|^2 $$\n    -   We locate the frequency bin $k_0$ containing the most power, which corresponds to the peak of the signal's main lobe in the spectrum:\n        $$ k_0 = \\arg\\max_{k} P[k] $$\n    -   The power that has leaked into the immediately adjacent bins is the sum of the power in bins $k_{-} = (k_0 - 1) \\pmod{N}$ and $k_{+} = (k_0 + 1) \\pmod{N}$.\n    -   The total power in the signal is the sum of power across all frequency bins, $\\sum_{k=0}^{N-1} P[k]$.\n    -   The leakage fraction, $L(w)$, is then computed according to the provided definition:\n        $$ L(w) = \\frac{P[k_{-}] + P[k_{+}]}{\\sum_{k=0}^{N-1} P[k]} $$\n\n5.  **Improvement Factor Calculation**: After computing the leakage fraction for both the rectangular window, $L(w_{\\mathrm{rect}})$, and the Hamming window, $L(w_{\\mathrm{ham}})$, we calculate the improvement factor $I$. This factor quantifies the reduction in adjacent-bin leakage achieved by the Hamming window relative to the rectangular window for this specific metric.\n    $$ I = \\frac{L(w_{\\mathrm{rect}})}{L(w_{\\mathrm{ham}})} $$\n    A value of $I > 1$ indicates that the Hamming window performed better (i.e., resulted in less leakage into neighboring bins) than the rectangular window.\n\nThis entire procedure is applied to each of the four test cases (A, B, C, D), and the resulting triplets $[L(w_{\\mathrm{rect}}), L(w_{\\mathrm{ham}}), I]$ are collected. The final output is an aggregation of these results in the specified list-of-lists format.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spectral leakage for a complex sinusoid representing the M2 tide,\n    using rectangular and Hamming windows for different sampling scenarios.\n    \"\"\"\n    \n    # Define test cases: (sampling interval in seconds, number of samples)\n    test_cases = [\n        (3600, 744),   # Case A: Typical month-long hourly sampling\n        (1800, 4095),  # Case B: Odd length, half-hour sampling\n        (3600, 97),    # Case C: Short record, coarse resolution\n        (600, 10001),  # Case D: Fine sampling, long record\n    ]\n\n    results = []\n    \n    # Define the angular frequency of the M2 tide in rad/s\n    T_m2_hours = 12.42\n    T_m2_seconds = T_m2_hours * 3600.0\n    omega_0 = 2.0 * np.pi / T_m2_seconds\n    \n    for dt, N in test_cases:\n        # Generate time indices n = 0, 1, ..., N-1\n        n = np.arange(N)\n        \n        # Generate the complex sinusoidal signal\n        x = np.exp(1j * omega_0 * n * dt)\n\n        # Generate the two window functions\n        # 1. Rectangular window\n        w_rect = np.ones(N)\n        \n        # 2. Hamming window, as defined in the problem\n        # The denominator is N-1; handle the N=1 case, though not present in test suite.\n        if N > 1:\n            w_ham = 0.54 - 0.46 * np.cos(2 * np.pi * n / (N - 1))\n        else:\n            w_ham = np.ones(N)\n\n        leakage_values = []\n        for w in [w_rect, w_ham]:\n            # Apply the window to the signal\n            y = w * x\n            \n            # Compute the N-point DFT\n            Y = np.fft.fft(y)\n            \n            # Compute the power spectrum\n            P = np.abs(Y)**2\n            \n            # Calculate total power. Use a tolerance to prevent division by zero.\n            total_power = np.sum(P)\n            if total_power  1e-15:\n                 leakage_values.append(0.0)\n                 continue\n\n            # Find the index of the largest-magnitude DFT bin\n            k0 = np.argmax(P)\n            \n            # Find the indices of the neighboring bins using modulo arithmetic\n            k_minus = (k0 - 1) % N\n            k_plus = (k0 + 1) % N\n            \n            # Sum the power in the neighboring bins\n            neighbor_power = P[k_minus] + P[k_plus]\n            \n            # Compute the leakage fraction\n            L = neighbor_power / total_power\n            leakage_values.append(L)\n\n        L_rect, L_ham = leakage_values\n        \n        # Calculate the improvement factor. Guard against division by zero.\n        if L_ham  1e-15:\n            I = np.inf if L_rect > 1e-15 else 1.0\n        else:\n            I = L_rect / L_ham\n            \n        results.append([L_rect, L_ham, I])\n\n    # Format the output string manually to match the required format:\n    # `[[val1,val2,val3],[val4,val5,val6],...]` without extra spaces.\n    sublist_strings = []\n    for res in results:\n        sublist_str_parts = [f\"{val}\" for val in res]\n        sublist_str = f\"[{','.join(sublist_str_parts)}]\"\n        sublist_strings.append(sublist_str)\n    \n    final_output = f\"[{','.join(sublist_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Often, the goal of data analysis is to isolate a weak signal from strong, known oscillations like tides, which requires moving beyond simple analysis to active signal processing with digital filters. This exercise () will guide you through the practical design of a high-performance Butterworth band-stop, or \"notch,\" filter. You will learn how to translate physical requirements, such as desired attenuation levels and transition sharpness, into a concrete filter design using standard computational tools.",
            "id": "3803585",
            "problem": "You are given a uniformly sampled time series of sea surface height and asked to design digital filters that remove the dominant semi-diurnal tidal constituents by attenuating frequency content around the principal lunar semi-diurnal tide and the principal solar semi-diurnal tide. The principal lunar semi-diurnal tide has angular frequency $\\,\\omega_{M2}\\,$, and the principal solar semi-diurnal tide has angular frequency $\\,\\omega_{S2}\\,$, defined by $\\,\\omega = 2\\pi/T\\,$ where $\\,T\\,$ is the period in seconds. For this problem, use $\\,T_{M2} = 44712\\,\\mathrm{s}\\,$ and $\\,T_{S2} = 43200\\,\\mathrm{s}\\,$, so that $\\,\\omega_{M2} = 2\\pi/44712\\,$ and $\\,\\omega_{S2} = 2\\pi/43200\\,$ in radians per second.\n\nYou must construct, for each specified test case, two separate digital Butterworth band-stop filters (one centered at $\\,\\omega_{M2}\\,$ and one centered at $\\,\\omega_{S2}\\,$) with explicitly defined stopband half-widths and transition half-widths, and determine the minimal filter order needed to guarantee at least $\\,40\\,\\mathrm{dB}\\,$ attenuation in the stopband. Assume a passband ripple of $\\,1\\,\\mathrm{dB}\\,$ is allowed. Treat each band-stop filter independently and then form a cascaded filter that applies both notches in sequence.\n\nStart from the following fundamental base:\n- The sampling theorem and discrete-time frequency normalization: with sampling interval $\\,\\Delta t\\,$ (in seconds), sampling frequency $\\,f_s = 1/\\Delta t\\,$ (in cycles per second), Nyquist frequency $\\,f_N = f_s/2\\,$, and normalized digital frequency $\\,W = f/f_N\\,$ where $\\,f = \\omega/(2\\pi)\\,$.\n- The Butterworth magnitude response for the low-pass prototype, which yields a monotonic response characterized by order $\\,n\\,$ and cutoff, and standard frequency transformations to create band-stop filters.\n- The definition of attenuation and ripple in decibels: an attenuation of $\\,A\\,\\mathrm{dB}\\,$ corresponds to a magnitude ratio $\\,10^{-A/20}\\,$, and passband ripple of $\\,R\\,\\mathrm{dB}\\,$ corresponds to a magnitude deviation characterized by $\\,10^{R/20}\\,$.\n\nDesign requirements for each band-stop filter in a test case:\n1. Let the center angular frequency be $\\,\\omega_0 \\in \\{\\omega_{M2}, \\omega_{S2}\\}\\,$. Convert it to cycles per second $\\,f_0 = \\omega_0/(2\\pi)\\,$ and normalize by $\\,f_N\\,$ to obtain the normalized center $\\,W_0 = f_0/f_N\\,$.\n2. You are given a stopband half-width $\\,\\delta\\omega_{\\mathrm{stop}}\\,$ and a transition half-width $\\,\\delta\\omega_{\\mathrm{trans}}\\,$, both in radians per second. Convert them to cycles per second via $\\,\\delta f_{\\mathrm{stop}} = \\delta\\omega_{\\mathrm{stop}}/(2\\pi)\\,$ and $\\,\\delta f_{\\mathrm{trans}} = \\delta\\omega_{\\mathrm{trans}}/(2\\pi)\\,$.\n3. Define the stopband edges in cycles per second as $\\,f_{s1} = f_0 - \\delta f_{\\mathrm{stop}}\\,$ and $\\,f_{s2} = f_0 + \\delta f_{\\mathrm{stop}}\\,$. Define the passband edges just outside the stopband as $\\,f_{p1} = f_0 - \\delta f_{\\mathrm{stop}} - \\delta f_{\\mathrm{trans}}\\,$ and $\\,f_{p2} = f_0 + \\delta f_{\\mathrm{stop}} + \\delta f_{\\mathrm{trans}}\\,$. Normalize all edges by $\\,f_N\\,$ to get $\\,W_{s1}, W_{s2}, W_{p1}, W_{p2}\\,$ with $\\,W_{x} = f_x/f_N\\,$.\n4. Use a Butterworth order computation consistent with these band-stop specifications and the given passband ripple $\\,g_{\\mathrm{pass}} = 1\\,\\mathrm{dB}\\,$ and stopband attenuation $\\,g_{\\mathrm{stop}} = 40\\,\\mathrm{dB}\\,$ to determine the minimal order $\\,n\\,$ for each band-stop filter. Then design the corresponding digital Butterworth band-stop filter.\n5. Cascade the two band-stop filters (one for $\\,\\omega_{M2}\\,$ and one for $\\,\\omega_{S2}\\,$). For the purpose of reporting the total order, use the sum of the individual minimal orders determined for the two constituent filters.\n\nYour program must compute, for each test case, the triple $[n_{M2}, n_{S2}, n_{\\mathrm{total}}]$ where $\\,n_{M2}\\,$ is the minimal order for the $\\,\\omega_{M2}\\,$ band-stop filter, $\\,n_{S2}\\,$ is the minimal order for the $\\,\\omega_{S2}\\,$ band-stop filter, and $\\,n_{\\mathrm{total}} = n_{M2} + n_{S2}\\,$ is the order of the cascaded design in terms of the sum of the orders of its constituent filters. The final output must be a single line containing a list of these triples for all test cases.\n\nAngle unit: radians per second for all angular frequencies and widths. No other angle units are allowed.\n\nUse the following test suite, which spans typical oceanographic sampling scenarios and transition sharpnesses:\n- Test Case 1 (happy path): $\\,\\Delta t = 900\\,\\mathrm{s}\\,$, $\\,\\delta\\omega_{\\mathrm{stop}} = 2\\pi \\times 1.0\\times 10^{-6}\\,\\mathrm{rad/s}\\,$, $\\,\\delta\\omega_{\\mathrm{trans}} = 2\\pi \\times 4.0\\times 10^{-7}\\,\\mathrm{rad/s}\\,$.\n- Test Case 2 (sharper transition with finer sampling): $\\,\\Delta t = 600\\,\\mathrm{s}\\,$, $\\,\\delta\\omega_{\\mathrm{stop}} = 2\\pi \\times 7.0\\times 10^{-7}\\,\\mathrm{rad/s}\\,$, $\\,\\delta\\omega_{\\mathrm{trans}} = 2\\pi \\times 2.0\\times 10^{-7}\\,\\mathrm{rad/s}\\,$.\n- Test Case 3 (coarser sampling with wider transition): $\\,\\Delta t = 3600\\,\\mathrm{s}\\,$, $\\,\\delta\\omega_{\\mathrm{stop}} = 2\\pi \\times 1.2\\times 10^{-6}\\,\\mathrm{rad/s}\\,$, $\\,\\delta\\omega_{\\mathrm{trans}} = 2\\pi \\times 6.0\\times 10^{-7}\\,\\mathrm{rad/s}\\,$.\n\nFor each test case, apply the design to both $\\,\\omega_{M2}\\,$ and $\\,\\omega_{S2}\\,$ using the provided widths. If any intermediate frequency edges would fall outside the valid normalized range $\\,0  W  1\\,$, clamp them to be strictly inside this interval while preserving the ordering $\\,W_{p1}  W_{s1}  W_{s2}  W_{p2}\\,$. If clamping prevents a valid ordering, the test case should be treated as infeasible; in this test suite all cases are feasible.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list $[n_{M2},n_{S2},n_{\\mathrm{total}}]$ for the corresponding test case, in the same order as listed above. For example, the output format should look like $\\,[[n_{M2}^{(1)},n_{S2}^{(1)},n_{\\mathrm{total}}^{(1)}],[n_{M2}^{(2)},n_{S2}^{(2)},n_{\\mathrm{total}}^{(2)}],[n_{M2}^{(3)},n_{S2}^{(3)},n_{\\mathrm{total}}^{(3)}]]\\,$. All numbers must be integers with no units in the output.",
            "solution": "The problem as stated is scientifically and mathematically sound, well-posed, and contains all necessary information for a unique solution. It requests the design of digital filters based on canonical principles of signal processing within a realistic oceanographic context. Therefore, a solution is warranted.\n\nThe core task is to determine the minimum order for two separate Butterworth band-stop filters, designed to attenuate the principal lunar ($M2$) and solar ($S2$) semi-diurnal tidal components in a time series of sea surface height. The problem then requires summing these orders to find the order of a conceptually cascaded filter.\n\nThe fundamental tidal frequencies are given by their periods, $T_{M2} = 44712\\,\\mathrm{s}$ and $T_{S2} = 43200\\,\\mathrm{s}$. The corresponding angular frequencies are $\\omega_{M2} = 2\\pi/T_{M2}$ and $\\omega_{S2} = 2\\pi/T_{S2}$. In cycles per second (Hz), these are $f_{M2} = 1/T_{M2}$ and $f_{S2} = 1/T_{S2}$.\n\nThe design of a digital filter requires that all frequencies be normalized with respect to the Nyquist frequency. Given a sampling interval $\\Delta t$, the sampling frequency is $f_s = 1/\\Delta t$, and the Nyquist frequency is $f_N = f_s/2$. An analog frequency $f$ (in Hz) is mapped to a normalized digital frequency $W$ via the relation $W = f/f_N$. The normalized frequency range is $W \\in [0, 1]$, where $W=0$ corresponds to DC and $W=1$ corresponds to the Nyquist frequency.\n\nA band-stop filter is defined by a stopband, where frequencies are attenuated, and passbands, where frequencies are largely unaffected. The specifications for our filters are:\n1.  A passband ripple of no more than $g_{\\mathrm{pass}} = 1\\,\\mathrm{dB}$. This means the magnitude response in the passband must not drop below $10^{-g_{\\mathrm{pass}}/20} \\approx 0.891$.\n2.  A stopband attenuation of at least $g_{\\mathrm{stop}} = 40\\,\\mathrm{dB}$. This means the magnitude response in the stopband must not exceed $10^{-g_{\\mathrm{stop}}/20} = 0.01$.\n\nThe design procedure for each tidal component, centered at an angular frequency $\\omega_0$ (either $\\omega_{M2}$ or $\\omega_{S2}$), is as follows:\n\nFirst, we convert all specifications from angular frequency (rad/s) to cycles per second (Hz). The center frequency is $f_0 = \\omega_0 / (2\\pi)$. The stopband half-width is $\\delta f_{\\mathrm{stop}} = \\delta\\omega_{\\mathrm{stop}} / (2\\pi)$ and the transition half-width is $\\delta f_{\\mathrm{trans}} = \\delta\\omega_{\\mathrm{trans}} / (2\\pi)$.\n\nSecond, we define the critical frequencies that delineate the passbands and stopband:\n-   Stopband edges: $f_{s1} = f_0 - \\delta f_{\\mathrm{stop}}$ and $f_{s2} = f_0 + \\delta f_{\\mathrm{stop}}$.\n-   Passband edges: $f_{p1} = f_{s1} - \\delta f_{\\mathrm{trans}}$ and $f_{p2} = f_{s2} + \\delta f_{\\mathrm{trans}}$.\n\nThird, these frequencies are normalized by the Nyquist frequency $f_N = 1/(2\\Delta t)$:\n- Passband edges: $W_{p1} = f_{p1}/f_N$ and $W_{p2} = f_{p2}/f_N$.\n- Stopband edges: $W_{s1} = f_{s1}/f_N$ and $W_{s2} = f_{s2}/f_N$.\nThe problem requires that these normalized frequencies must lie strictly between $0$ and $1$. If any calculated edge falls outside this range, it must be clamped to be within it, for instance within a small margin $[\\epsilon, 1-\\epsilon]$ for a small $\\epsilon>0$.\n\nFourth, we determine the minimum filter order $n$ for a Butterworth filter that meets these specifications. The order of a Butterworth filter dictates the steepness of its transition from passband to stopband. For a given set of specifications ($W_p$, $W_s$, $g_{\\mathrm{pass}}$, $g_{\\mathrm{stop}}$), there is a minimum integer order $n$ that can satisfy them. This calculation involves mapping the band-stop specifications to an equivalent low-pass prototype filter, accounting for the frequency warping inherent in the standard bilinear transform used to create digital filters from analog prototypes. The order $n$ of the analog low-pass prototype is given by:\n$$ n \\ge \\frac{\\log_{10}\\left(\\frac{10^{0.1 g_{\\mathrm{stop}}} - 1}{10^{0.1 g_{\\mathrm{pass}}} - 1}\\right)}{2\\log_{10}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)} $$\nwhere $\\Omega_s$ and $\\Omega_p$ are the stopband and passband edge frequencies of the warped prototype. Standard computational libraries provide functions that encapsulate this entire procedure, taking the digital frequency specifications and returning the minimum integer order $n$.\n\nThis process is executed independently for the $M2$ and $S2$ components for each test case, yielding the minimal orders $n_{M2}$ and $n_{S2}$. The total order of the cascaded filter, which applies both filtering operations, is defined as the sum of the individual orders: $n_{\\mathrm{total}} = n_{M2} + n_{S2}$. This represents the complexity of a filter whose transfer function is the product of the two individual filter transfer functions.\n\nThe following Python program implements this design procedure for the provided test cases. It calculates the necessary frequency parameters, normalizes them, and then uses the `buttord` function from the `scipy.signal` library to find the minimum filter order for each component. The results are then aggregated and formatted as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy.signal import buttord\n\ndef solve():\n    \"\"\"\n    Designs Butterworth band-stop filters for tidal constituents and computes their minimal orders.\n    \"\"\"\n    # Define physical constants for tidal constituents\n    # Period of principal lunar semi-diurnal tide (s)\n    T_M2 = 44712.0\n    # Period of principal solar semi-diurnal tide (s)\n    T_S2 = 43200.0\n\n    # Angular frequencies in rad/s\n    omega_M2 = 2 * np.pi / T_M2\n    omega_S2 = 2 * np.pi / T_S2\n    \n    # Filter specifications\n    g_pass = 1.0  # Passband ripple (dB)\n    g_stop = 40.0 # Stopband attenuation (dB)\n\n    test_cases = [\n        # (delta_t, d_omega_stop, d_omega_trans)\n        (900.0, 2 * np.pi * 1.0e-6, 2 * np.pi * 4.0e-7),\n        (600.0, 2 * np.pi * 7.0e-7, 2 * np.pi * 2.0e-7),\n        (3600.0, 2 * np.pi * 1.2e-6, 2 * np.pi * 6.0e-7),\n    ]\n\n    results = []\n\n    def calculate_order(omega_0, delta_t, d_omega_stop, d_omega_trans):\n        \"\"\"\n        Calculates the minimum Butterworth filter order for a single band-stop filter.\n\n        Args:\n            omega_0 (float): Center angular frequency of the stopband (rad/s).\n            delta_t (float): Sampling interval (s).\n            d_omega_stop (float): Stopband half-width (rad/s).\n            d_omega_trans (float): Transition half-width (rad/s).\n\n        Returns:\n            int: The minimal filter order.\n        \"\"\"\n        # Calculate sampling and Nyquist frequencies in Hz\n        f_s = 1.0 / delta_t\n        f_N = f_s / 2.0\n\n        # Convert angular frequencies (rad/s) to standard frequencies (Hz)\n        f_0 = omega_0 / (2 * np.pi)\n        df_stop = d_omega_stop / (2 * np.pi)\n        df_trans = d_omega_trans / (2 * np.pi)\n\n        # Define band-stop and passband edges in Hz\n        f_s1 = f_0 - df_stop\n        f_s2 = f_0 + df_stop\n        f_p1 = f_s1 - df_trans\n        f_p2 = f_s2 + df_trans\n\n        # Normalize frequencies by the Nyquist frequency\n        W_p1 = f_p1 / f_N\n        W_p2 = f_p2 / f_N\n        W_s1 = f_s1 / f_N\n        W_s2 = f_s2 / f_N\n        \n        # Clamp frequencies to be strictly within (0, 1) as per problem statement\n        # A small epsilon is used to avoid boundary issues.\n        epsilon = 1e-9\n        W_p1 = np.clip(W_p1, epsilon, 1.0 - epsilon)\n        W_p2 = np.clip(W_p2, epsilon, 1.0 - epsilon)\n        W_s1 = np.clip(W_s1, epsilon, 1.0 - epsilon)\n        W_s2 = np.clip(W_s2, epsilon, 1.0 - epsilon)\n\n        # Use scipy.signal.buttord to find the minimum order\n        # wp: Passband edge frequencies (normalized)\n        # ws: Stopband edge frequencies (normalized)\n        wp = [W_p1, W_p2]\n        ws = [W_s1, W_s2]\n        \n        order, _ = buttord(wp, ws, g_pass, g_stop, analog=False)\n        return int(order)\n\n    for case in test_cases:\n        delta_t, d_omega_stop, d_omega_trans = case\n\n        # Calculate minimal order for M2 tide component\n        n_M2 = calculate_order(omega_M2, delta_t, d_omega_stop, d_omega_trans)\n\n        # Calculate minimal order for S2 tide component\n        n_S2 = calculate_order(omega_S2, delta_t, d_omega_stop, d_omega_trans)\n\n        # Total order of the cascaded filter\n        n_total = n_M2 + n_S2\n\n        results.append([n_M2, n_S2, n_total])\n\n    # Format the final output string\n    # e.g., [[1, 2, 3],[4, 5, 9]] -> \"[[1, 2, 3],[4, 5, 9]]\"\n    result_str = \",\".join(map(str, results))\n    final_output = f\"[{result_str.replace(' ', '')}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}