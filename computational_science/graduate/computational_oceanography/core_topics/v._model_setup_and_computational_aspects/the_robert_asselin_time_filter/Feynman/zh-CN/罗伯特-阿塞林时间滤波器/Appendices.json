{
    "hands_on_practices": [
        {
            "introduction": "理解任何数值滤波器的第一步是分析它对波动解的影响。本练习的核心是推导离散色散关系，它揭示了 Robert-Asselin 滤波器如何改变物理上正确的波和由蛙跳格式引入的伪计算模式。这项分析是评估滤波器稳定性和色散特性的基石 。",
            "id": "3816242",
            "problem": "考虑一维线性平流方程 $u_{t} + c\\,u_{x} = 0$，其定义在空间间隔为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上。该场在空间上使用中心差分进行离散，在时间上使用蛙跳格式，并可选择性地应用 Robert–Asselin 时间滤波器 (RA)。设网格点 $x_{j} = j\\,\\Delta x$ 和时间 $t^{n} = n\\,\\Delta t$ 处的离散状态为 $u_{j}^{n}$。蛙跳格式的更新由 $u_{x}$ 的中心差分近似和 $u_{t}$ 的时间中心近似定义。RA 滤波器的系数为 $\\epsilon \\in [0,1)$，并根据 Robert–Asselin 时间滤波器 (RA) 的标准做法，在每个蛙跳步之后应用于中间时间层，即将 $u_{j}^{n}$ 替换为 $u_{j}^{n} + \\epsilon\\,(u_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1})$。\n\n采用简正模假设 $u_{j}^{n} = \\hat{u}\\,\\exp\\!\\big(i\\,k\\,x_{j}\\big)\\,\\lambda^{n}$，其中 $k$ 是连续波数，$\\kappa \\equiv k\\,\\Delta x$ 是无量纲网格波数，$\\lambda$ 是单步放大因子。定义 Courant 数 $\\mu \\equiv c\\,\\Delta t / \\Delta x$。从偏微分方程和上述离散化定义出发，推导单步放大因子 $\\lambda$ 作为 $\\mu$ 和 $\\kappa$ 的函数的闭式离散色散关系：\n- 不使用 Robert–Asselin 时间滤波器（即 $\\epsilon = 0$）。\n- 使用系数为 $\\epsilon$ 的 Robert–Asselin 时间滤波器。\n\n将两个最终关系表示为物理（平流）模态的放大因子的闭式解析表达式，用 $\\mu$、$\\kappa$ 和 $\\epsilon$ 表示。不要给出中间方程；只提供最终表达式。不需要四舍五入，也不需要报告单位。",
            "solution": "该问题要求推导线性平流方程在使用蛙跳格式离散化（包含使用和不使用 Robert-Asselin (RA) 时间滤波器两种情况）后的离散色散关系，特别是单步放大因子 $\\lambda$。\n\n一维线性平流方程为：\n$$\nu_{t} + c\\,u_{x} = 0\n$$\n其中 $u$ 是场变量，$t$ 是时间，$x$ 是空间坐标，$c$ 是恒定的平流速度。\n\n该问题在空间间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上进行离散化。状态表示为 $u_j^n = u(j\\Delta x, n\\Delta t)$。蛙跳格式在时间上使用中心差分，空间导数用中心差分近似：\n$$\n\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0\n$$\n这可以重新排列以表示新时间层 $n+1$ 处的状态：\n$$\nu_j^{n+1} = u_j^{n-1} - \\frac{c\\Delta t}{\\Delta x} (u_{j+1}^n - u_{j-1}^n)\n$$\n使用 Courant 数的定义 $\\mu \\equiv c\\,\\Delta t / \\Delta x$，更新规则变为：\n$$\nu_j^{n+1} = u_j^{n-1} - \\mu (u_{j+1}^n - u_{j-1}^n)\n$$\n为了分析此格式的稳定性和色散性，我们使用 von Neumann 方法，将简正模假设 $u_j^n = \\hat{u}\\,\\exp\\!\\big(i\\,k\\,x_{j}\\big)\\,\\lambda^{n}$ 代入离散方程。这里 $i = \\sqrt{-1}$，$k$ 是波数，$\\lambda$ 是每时间步的放大因子，$\\hat{u}$ 是常数振幅。代入 $x_j=j\\Delta x$ 得到 $u_j^n = \\hat{u} \\lambda^n e^{ikj\\Delta x}$。\n\n将该假设代入离散方程：\n$$\n\\hat{u}\\lambda^{n+1} e^{ikj\\Delta x} = \\hat{u}\\lambda^{n-1} e^{ikj\\Delta x} - \\mu \\left( \\hat{u}\\lambda^{n} e^{ik(j+1)\\Delta x} - \\hat{u}\\lambda^{n} e^{ik(j-1)\\Delta x} \\right)\n$$\n两边同除以 $\\hat{u}\\lambda^{n-1} e^{ikj\\Delta x}$（假设其非零）：\n$$\n\\lambda^2 = 1 - \\mu \\lambda (e^{ik\\Delta x} - e^{-ik\\Delta x})\n$$\n使用恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和无量纲波数的定义 $\\kappa \\equiv k\\Delta x$：\n$$\n\\lambda^2 = 1 - \\mu \\lambda (2i\\sin\\kappa)\n$$\n这就得到了放大因子 $\\lambda$ 的特征多项式：\n$$\n\\lambda^2 + 2i\\mu\\sin(\\kappa)\\lambda - 1 = 0\n$$\n\n**情况1：不使用 Robert–Asselin 时间滤波器 ($\\epsilon = 0$)**\n\n这是标准的蛙跳格式。特征方程是上面推导出的二次方程。我们求解 $\\lambda$：\n$$\n\\lambda = \\frac{-2i\\mu\\sin\\kappa \\pm \\sqrt{(2i\\mu\\sin\\kappa)^2 - 4(1)(-1)}}{2} = \\frac{-2i\\mu\\sin\\kappa \\pm \\sqrt{-4\\mu^2\\sin^2\\kappa + 4}}{2}\n$$\n$$\n\\lambda = -i\\mu\\sin\\kappa \\pm \\sqrt{1 - \\mu^2\\sin^2\\kappa}\n$$\n这个方程产生两个 $\\lambda$ 的根，分别对应一个物理模态和一个计算模态。物理模态是近似真实解的解析放大因子 $e^{-i\\omega\\Delta t} = e^{-ikc\\Delta t} = e^{-i\\mu\\kappa}$ 的那个根。对于小的 $\\mu$ 和 $\\kappa$，$e^{-i\\mu\\kappa} \\approx 1 - i\\mu\\kappa - \\frac{1}{2}(\\mu\\kappa)^2$。\n带有正号的根的泰勒展开式为 $\\lambda \\approx -i\\mu\\kappa + (1 - \\frac{1}{2}\\mu^2\\kappa^2) = 1 - i\\mu\\kappa - \\frac{1}{2}\\mu^2\\kappa^2$，这与解析解的展开式相匹配。因此，物理模态是：\n$$\n\\lambda_{\\text{physical}} = -i\\mu\\sin\\kappa + \\sqrt{1 - \\mu^2\\sin^2\\kappa}\n$$\n\n**情况2：使用系数为 $\\epsilon$ 的 Robert–Asselin 时间滤波器**\n\nRA 滤波器是顺序应用的。首先，使用蛙跳步计算一个临时值 $u_j^{*,n+1}$。然后，使用这个临时值更新中心时间层的值 $u_j^n$。\n1.  **预报步（蛙跳）：** $u_j^{*,n+1} = u_j^{n-1} - \\mu(u_{j+1}^n - u_{j-1}^n)$\n2.  **校正步（滤波）：** 将 $u_j^n$ 的值替换为 $\\bar{u}_j^n = u_j^n + \\epsilon(u_j^{*,n+1} - 2u_j^n + u_j^{n-1})$。\n传递到下一个时间步的新状态由 $(\\bar{u}_j^n, u_j^{n+1})$ 组成，其中 $u_j^{n+1} = u_j^{*,n+1}$。\n\n我们对这个两阶段过程进行傅里叶分析。设 $\\hat{u}^n$ 是 $u_j^n$ 的傅里叶振幅。空间差分算子变成乘以 $2i\\sin\\kappa$。设 $\\sigma = \\mu\\sin\\kappa$。\n傅里叶空间中的系统是：\n1.  $\\hat{u}^{*,n+1} = \\hat{u}^{n-1} - 2i\\sigma \\hat{u}^n$\n2.  $\\bar{u}^n = \\hat{u}^n + \\epsilon(\\hat{u}^{*,n+1} - 2\\hat{u}^n + \\hat{u}^{n-1})$\n\n任何时间的状态都可以用两个连续时间层的振幅向量来描述，$V_n = \\begin{pmatrix} \\hat{u}^n \\\\ \\hat{u}^{n-1} \\end{pmatrix}$。到下一个状态 $V_{n+1} = \\begin{pmatrix} \\hat{u}^{n+1} \\\\ \\bar{u}^n \\end{pmatrix}$ 的演化由一个矩阵 $G$ 给出：$V_{n+1} = G V_n$。\n$V_{n+1}$ 的分量是：\n$\\hat{u}^{n+1} = \\hat{u}^{*,n+1} = -2i\\sigma \\hat{u}^n + \\hat{u}^{n-1}$\n$\\bar{u}^n = \\hat{u}^n + \\epsilon((\\hat{u}^{n-1} - 2i\\sigma \\hat{u}^n) - 2\\hat{u}^n + \\hat{u}^{n-1}) = (1 - 2\\epsilon - 2i\\sigma\\epsilon)\\hat{u}^n + 2\\epsilon \\hat{u}^{n-1}$\n\n因此，放大矩阵 $G$ 是：\n$$\nG = \\begin{pmatrix} -2i\\sigma  & 1 \\\\ 1 - 2\\epsilon(1+i\\sigma)  & 2\\epsilon \\end{pmatrix}\n$$\n放大因子 $\\lambda$ 是 $G$ 的特征值，通过求解 $\\det(G - \\lambda I) = 0$ 得到：\n$$\n\\det\\begin{pmatrix} -2i\\sigma - \\lambda  & 1 \\\\ 1 - 2\\epsilon(1+i\\sigma)  & 2\\epsilon - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-2i\\sigma - \\lambda)(2\\epsilon - \\lambda) - (1 - 2\\epsilon(1+i\\sigma)) = 0\n$$\n展开此行列式得到特征方程：\n$$\n\\lambda^2 - 2\\epsilon\\lambda + 2i\\sigma\\lambda - 4i\\sigma\\epsilon - 1 + 2\\epsilon + 2i\\sigma\\epsilon = 0\n$$\n$$\n\\lambda^2 + 2(i\\sigma - \\epsilon)\\lambda + (2\\epsilon - 1 - 2i\\sigma\\epsilon) = 0\n$$\n解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = -(i\\sigma - \\epsilon) \\pm \\sqrt{(i\\sigma - \\epsilon)^2 - (2\\epsilon - 1 - 2i\\sigma\\epsilon)}\n$$\n$$\n\\lambda = \\epsilon - i\\sigma \\pm \\sqrt{(-\\sigma^2 - 2i\\sigma\\epsilon + \\epsilon^2) - (2\\epsilon - 1 - 2i\\sigma\\epsilon)}\n$$\n$$\n\\lambda = \\epsilon - i\\sigma \\pm \\sqrt{-\\sigma^2 + \\epsilon^2 - 2\\epsilon + 1} = \\epsilon - i\\sigma \\pm \\sqrt{(1-\\epsilon)^2 - \\sigma^2}\n$$\n将 $\\sigma = \\mu\\sin\\kappa$ 代回：\n$$\n\\lambda = \\epsilon - i\\mu\\sin\\kappa \\pm \\sqrt{(1-\\epsilon)^2 - \\mu^2\\sin^2\\kappa}\n$$\n为了识别物理模态，我们考察 $\\epsilon \\to 0$ 时的极限。表达式变为 $-i\\mu\\sin\\kappa \\pm \\sqrt{1 - \\mu^2\\sin^2\\kappa}$，这与未滤波格式的结果相同。如前所述，物理模态对应于取平方根的正号。因此，使用 RA 滤波器时物理模态的放大因子为：\n$$\n\\lambda_{\\text{physical}} = \\epsilon - i\\mu\\sin\\kappa + \\sqrt{(1-\\epsilon)^2 - \\mu^2\\sin^2\\kappa}\n$$\n当 $\\epsilon=0$ 时，该表达式正确地简化为未滤波的物理模态放大因子。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -i\\mu\\sin(\\kappa) + \\sqrt{1 - \\mu^{2}\\sin^{2}(\\kappa)}  & \\epsilon - i\\mu\\sin(\\kappa) + \\sqrt{(1-\\epsilon)^{2} - \\mu^{2}\\sin^{2}(\\kappa)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了滤波器效应的理论基础后，下一步自然是学习如何对其进行调节。本练习设置了一个涉及惯性振荡的真实场景，这是海洋模型中的一个关键特征。您需要确定滤波器系数 $\\alpha$，以满足对计算模式的特定阻尼要求，同时最小化对物理模式的不必要阻尼，从而阐明滤波器设计中的关键权衡 。",
            "id": "3816225",
            "problem": "考虑一个$f$平面上的线性惯性振荡，其单个傅里叶分量由复振幅方程 $\\frac{dy}{dt} = i \\omega y$ 建模，其中 $\\omega = f$，$f$是科里奥利参数。状态$y$使用时间步长为$\\Delta t$的蛙跳格式进行时间推进，并且每一步都应用一个Robert-Asselin (RA)时间滤波系数$\\alpha$来抑制计算模。定义无量纲频率 $\\mu = \\omega \\Delta t$。蛙跳格式的更新是 $y^{n+1} = y^{n-1} + 2 i \\mu y^n$，之后在下一次更新前，对中间时间层$y^n$应用RA滤波：$y^n \\leftarrow y^n + \\alpha \\left(y^{n+1} - 2 y^n + y^{n-1}\\right)$。\n\n将一个完整的蛙跳加滤波周期视为作用于状态向量 $\\left(y^n, y^{n-1}\\right)$ 的线性映射，该映射有两个放大特征模：一个物理模和一个计算模。计算特征模必须被阻尼，使其在一个周期后的幅值不大于一个预设阈值 $\\rho_c$，而物理模的阻尼必须保持在容差 $\\delta_p$ 以下，意味着物理模在一个周期后的幅值满足 $|\\lambda_p| \\geq 1 - \\delta_p$。\n\n对于一个开阔大洋的惯性振荡，其$f = 1.0 \\times 10^{-4}\\,\\mathrm{s}^{-1}$ 且 $\\Delta t = 1800\\,\\mathrm{s}$，取阈值 $\\rho_c = 0.85$ 和 $\\delta_p = 0.0014$。确定Robert-Asselin滤波系数$\\alpha$的值，该值将计算模的幅值精确地设定在$\\rho_c$，同时保持物理模的阻尼在容差范围内。将你的最终答案表示为一个纯数（无量纲），并四舍五入到四位有效数字。",
            "solution": "用户要求我解决一个关于Robert-Asselin时间滤波器的问题。\n\n### 步骤1：提取已知条件\n-   **控制方程**：复振幅演化由 $\\frac{dy}{dt} = i \\omega y$ 建模。\n-   **频率**：$\\omega = f$。\n-   **科里奥利参数**：$f = 1.0 \\times 10^{-4}\\,\\mathrm{s}^{-1}$。\n-   **时间步长**：$\\Delta t = 1800\\,\\mathrm{s}$。\n-   **无量纲频率**：$\\mu = \\omega \\Delta t$。\n-   **数值格式（蛙跳法）**：$y^{n+1} = y^{n-1} + 2 i \\mu y^n$。\n-   **数值格式（Robert-Asselin滤波）**：滤波器应用于中间时间层，形式为 $y^n \\leftarrow y^n + \\alpha \\left(y^{n+1} - 2 y^n + y^{n-1}\\right)$。\n-   **计算模约束**：计算模放大因子$\\lambda_c$的幅值$|\\lambda_c|$必须精确等于预设阈值 $\\rho_c = 0.85$。\n-   **物理模约束**：物理模放大因子$\\lambda_p$的幅值$|\\lambda_p|$必须满足 $|\\lambda_p| \\geq 1 - \\delta_p$，其中容差为 $\\delta_p = 0.0014$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题牢固地植根于计算流体力学领域，特别是地球物理模型中使用的数值格式分析。蛙跳格式、惯性振荡和Robert-Asselin滤波器是该领域的标准课题。该问题在科学上是合理的。\n-   **适定的**：该问题提供了所有必要的方程、参数和约束，以唯一确定滤波系数$\\alpha$的值。该设置允许直接的数学求解。\n-   **客观的**：该问题使用精确、明确的数学和物理语言进行描述。没有主观或基于意见的陈述。\n-   **其他标准**：该问题是自洽的、一致的，并对数值方法的分析提出了一个现实的挑战。它没有违反任何其他无效性标准。\n\n### 步骤3：结论与行动\n问题是有效的。将提供完整解答。\n\n### 解题推导\n该问题描述了蛙跳格式与Robert-Asselin (RA)滤波器结合的一个完整周期。我们首先建立一个周期的传递矩阵，从中可以找到放大因子（特征值）。\n\n设一个周期开始时系统的状态由向量 $\\mathbf{Y}^n = \\begin{pmatrix} y^n \\\\ y^{n-1} \\end{pmatrix}$ 描述。根据问题定义，该周期包括两个步骤：\n1.  一个蛙跳更新，用于找到下一个时间步的试验值，我们称之为$y_{tent}^{n+1}$：\n    $$y_{tent}^{n+1} = y^{n-1} + 2 i \\mu y^n$$\n2.  一个RA滤波应用，用于更新中间时间层的值$y^n$。我们称滤波后的值为$\\bar{y}^n$：\n    $$\\bar{y}^n = y^n + \\alpha \\left(y_{tent}^{n+1} - 2 y^n + y^{n-1}\\right)$$\n下一个周期开始时的状态向量是 $\\mathbf{Y}^{n+1} = \\begin{pmatrix} y^{n+1} \\\\ \\bar{y}^n \\end{pmatrix}$。问题指出，蛙跳更新$y^{n+1} = ...$之后是滤波器，这意味着$y^{n+1} = y_{tent}^{n+1}$。所以，我们得到新的状态向量$(y^{n+1}, \\bar{y}^n)^T$。\n\n让我们用旧状态向量的分量$y^n$和$y^{n-1}$来表示新状态向量的分量。\n第一个分量很直接：\n$$y^{n+1} = (2 i \\mu) y^n + (1) y^{n-1}$$\n对于第二个分量，我们将$y_{tent}^{n+1}$的表达式代入滤波器方程：\n$$\\bar{y}^n = y^n + \\alpha \\left((y^{n-1} + 2 i \\mu y^n) - 2 y^n + y^{n-1}\\right)$$\n$$\\bar{y}^n = y^n + \\alpha \\left((2 i \\mu - 2) y^n + 2 y^{n-1}\\right)$$\n$$\\bar{y}^n = (1 - 2\\alpha + 2 i \\alpha \\mu) y^n + (2\\alpha) y^{n-1}$$\n\n我们现在可以将状态向量的演化写成矩阵-向量乘积的形式：\n$$\\begin{pmatrix} y^{n+1} \\\\ \\bar{y}^n \\end{pmatrix} = \\begin{pmatrix} 2 i \\mu  & 1 \\\\ 1 - 2\\alpha + 2 i \\alpha \\mu  & 2\\alpha \\end{pmatrix} \\begin{pmatrix} y^n \\\\ y^{n-1} \\end{pmatrix}$$\n设传递矩阵为 $\\mathbf{M}$：\n$$\\mathbf{M} = \\begin{pmatrix} 2 i \\mu  & 1 \\\\ 1 - 2\\alpha + 2 i \\alpha \\mu  & 2\\alpha \\end{pmatrix}$$\n放大因子 $\\lambda$ 是 $\\mathbf{M}$ 的特征值。它们是特征方程 $\\det(\\mathbf{M} - \\lambda \\mathbf{I}) = 0$ 的根。\n$$\\det \\begin{pmatrix} 2 i \\mu - \\lambda  & 1 \\\\ 1 - 2\\alpha + 2 i \\alpha \\mu  & 2\\alpha - \\lambda \\end{pmatrix} = 0$$\n$$(2 i \\mu - \\lambda)(2\\alpha - \\lambda) - (1 - 2\\alpha + 2 i \\alpha \\mu) = 0$$\n$$\\lambda^2 - (2\\alpha + 2 i \\mu)\\lambda + 4 i \\alpha \\mu - 1 + 2\\alpha - 2 i \\alpha \\mu = 0$$\n$$\\lambda^2 - 2(\\alpha + i \\mu)\\lambda + (2\\alpha - 1 + 2 i \\alpha \\mu) = 0$$\n我们解这个关于$\\lambda$的二次方程：\n$$\\lambda = \\frac{2(\\alpha + i \\mu) \\pm \\sqrt{4(\\alpha + i \\mu)^2 - 4(2\\alpha - 1 + 2 i \\alpha \\mu)}}{2}$$\n$$\\lambda = (\\alpha + i \\mu) \\pm \\sqrt{(\\alpha + i \\mu)^2 - (2\\alpha - 1 + 2 i \\alpha \\mu)}$$\n我们简化平方根下的项：\n$$(\\alpha^2 - \\mu^2 + 2 i \\alpha \\mu) - (2\\alpha - 1 + 2 i \\alpha \\mu) = \\alpha^2 - \\mu^2 - 2\\alpha + 1 = (1-\\alpha)^2 - \\mu^2$$\n所以，特征值是：\n$$\\lambda = (\\alpha + i \\mu) \\pm \\sqrt{(1-\\alpha)^2 - \\mu^2}$$\n首先，我们计算无量纲频率$\\mu$：\n$$\\mu = f \\Delta t = (1.0 \\times 10^{-4}\\,\\mathrm{s}^{-1})(1800\\,\\mathrm{s}) = 0.18$$\n对于典型的较小$\\alpha$值，我们有 $(1-\\alpha)^2 > \\mu^2$，因此平方根是实数。设 $S = \\sqrt{(1-\\alpha)^2 - \\mu^2}$。\n两个特征值是 $\\lambda_1 = (\\alpha+S) + i\\mu$ 和 $\\lambda_2 = (\\alpha-S) + i\\mu$。\n\n物理模的放大因子 $\\lambda_p$ 应接近 $e^{i\\mu}$，对于小 $\\mu$ 而言，约等于 $1+i\\mu$。其实部应接近 1。\n$\\lambda_1$的实部是 $\\alpha+S \\approx \\alpha + (1-\\alpha) = 1$。所以 $\\lambda_1$ 是物理模因子 $\\lambda_p$。\n计算模的放大因子 $\\lambda_c$ 的实部应接近 -1。\n$\\lambda_2$的实部是 $\\alpha-S \\approx \\alpha - (1-\\alpha) = 2\\alpha-1 \\approx -1$。所以 $\\lambda_2$ 是计算模因子 $\\lambda_c$。\n\n我们已知计算模的幅值为 $|\\lambda_c| = \\rho_c$。\n$$|\\lambda_c|^2 = (\\operatorname{Re}(\\lambda_c))^2 + (\\operatorname{Im}(\\lambda_c))^2 = (\\alpha-S)^2 + \\mu^2$$\n$$|\\lambda_c|^2 = \\alpha^2 - 2\\alpha S + S^2 + \\mu^2$$\n代入 $S^2 = (1-\\alpha)^2 - \\mu^2$:\n$$|\\lambda_c|^2 = \\alpha^2 - 2\\alpha S + (1-\\alpha)^2 - \\mu^2 + \\mu^2 = \\alpha^2 - 2\\alpha S + 1 - 2\\alpha + \\alpha^2$$\n$$|\\lambda_c|^2 = 1 - 2\\alpha + 2\\alpha^2 - 2\\alpha S = 1 - 2\\alpha(1 - \\alpha + S)$$\n代入$S$的表达式：\n$$\\rho_c^2 = 1 - 2\\alpha(1 - \\alpha + \\sqrt{(1-\\alpha)^2 - \\mu^2})$$\n必须求解该方程以得到 $\\alpha$。我们将其重新排列以分离平方根项。\n$$\\frac{1 - \\rho_c^2}{2\\alpha} = 1 - \\alpha + \\sqrt{(1-\\alpha)^2 - \\mu^2}$$\n$$\\frac{1 - \\rho_c^2}{2\\alpha} - (1 - \\alpha) = \\sqrt{(1-\\alpha)^2 - \\mu^2}$$\n两边平方：\n$$\\left(\\frac{1 - \\rho_c^2}{2\\alpha} - (1 - \\alpha)\\right)^2 = (1-\\alpha)^2 - \\mu^2$$\n展开左边：\n$$\\left(\\frac{1 - \\rho_c^2}{2\\alpha}\\right)^2 - 2\\frac{1 - \\rho_c^2}{2\\alpha}(1-\\alpha) + (1-\\alpha)^2 = (1-\\alpha)^2 - \\mu^2$$\n$(1-\\alpha)^2$项消掉。\n$$\\frac{(1 - \\rho_c^2)^2}{4\\alpha^2} - \\frac{(1 - \\rho_c^2)(1-\\alpha)}{\\alpha} = -\\mu^2$$\n乘以 $4\\alpha^2$:\n$$(1 - \\rho_c^2)^2 - 4\\alpha(1 - \\rho_c^2)(1-\\alpha) = -4\\mu^2\\alpha^2$$\n设 $C_1 = 1 - \\rho_c^2$ 和 $C_2 = 4\\mu^2$。\n$$C_1^2 - 4\\alpha C_1(1-\\alpha) = -C_2\\alpha^2$$\n$$C_1^2 - 4C_1\\alpha + 4C_1\\alpha^2 = -C_2\\alpha^2$$\n$$(4C_1 + C_2)\\alpha^2 - 4C_1\\alpha + C_1^2 = 0$$\n这是一个关于 $\\alpha$ 的二次方程。现在，我们代入数值。\n$\\mu = 0.18 \\implies \\mu^2 = 0.0324$。\n$\\rho_c = 0.85 \\implies \\rho_c^2 = 0.7225$。\n$C_1 = 1 - 0.7225 = 0.2775$。\n$C_2 = 4 \\times 0.0324 = 0.1296$。\n\n关于$\\alpha$的二次方程变为：\n$$(4 \\times 0.2775 + 0.1296)\\alpha^2 - (4 \\times 0.2775)\\alpha + (0.2775)^2 = 0$$\n$$(1.11 + 0.1296)\\alpha^2 - 1.11\\alpha + 0.07700625 = 0$$\n$$1.2396\\alpha^2 - 1.11\\alpha + 0.07700625 = 0$$\n求解$\\alpha$：\n$$\\alpha = \\frac{1.11 \\pm \\sqrt{(-1.11)^2 - 4(1.2396)(0.07700625)}}{2(1.2396)}$$\n$$\\alpha = \\frac{1.11 \\pm \\sqrt{1.2321 - 0.38183883}}{2.4792}$$\n$$\\alpha = \\frac{1.11 \\pm \\sqrt{0.85026117}}{2.4792}$$\n$$\\alpha = \\frac{1.11 \\pm 0.92209607}{2.4792}$$\n这给出了$\\alpha$的两个可能解：\n$$\\alpha_1 = \\frac{1.11 + 0.92209607}{2.4792} = \\frac{2.03209607}{2.4792} \\approx 0.81966$$\n$$\\alpha_2 = \\frac{1.11 - 0.92209607}{2.4792} = \\frac{0.18790393}{2.4792} \\approx 0.07579$$\n滤波系数 $\\alpha$ 必须是一个小值，因此我们选择第二个根 $\\alpha_2$。\n$\\alpha \\approx 0.07579$。\n\n最后，我们必须验证这个 $\\alpha$ 值满足物理模阻尼约束：$|\\lambda_p| \\ge 1 - \\delta_p$。\n当 $\\delta_p = 0.0014$时，条件是 $|\\lambda_p| \\ge 0.9986$。这等价于 $|\\lambda_p|^2 \\ge (0.9986)^2 \\approx 0.99720196$。\n物理模的幅值由下式给出：\n$$|\\lambda_p|^2 = (\\alpha+S)^2 + \\mu^2 = \\alpha^2 + 2\\alpha S + S^2 + \\mu^2$$\n$$|\\lambda_p|^2 = \\alpha^2 + 2\\alpha S + (1-\\alpha)^2 - \\mu^2 + \\mu^2 = 1 - 2\\alpha + 2\\alpha^2 + 2\\alpha S$$\n$$|\\lambda_p|^2 = 1 - 2\\alpha(1 - \\alpha - S) = 1 - 2\\alpha(1 - \\alpha - \\sqrt{(1-\\alpha)^2 - \\mu^2})$$\n使用 $\\alpha \\approx 0.07579$：\n$1-\\alpha \\approx 0.92421$。\n$(1-\\alpha)^2 \\approx 0.85416$。\n$\\mu^2 = 0.0324$。\n$\\sqrt{(1-\\alpha)^2 - \\mu^2} \\approx \\sqrt{0.85416 - 0.0324} = \\sqrt{0.82176} \\approx 0.90651$。\n$|\\lambda_p|^2 \\approx 1 - 2(0.07579)(0.92421 - 0.90651) = 1 - 0.15158(0.0177) = 1 - 0.002683 \\approx 0.997317$。\n由于 $0.997317 > 0.997202$，物理模的条件得到满足。\n\n要求的 $\\alpha$ 值，四舍五入到四位有效数字，是 $0.07579$。",
            "answer": "$$\n\\boxed{0.07579}\n$$"
        },
        {
            "introduction": "功能强大的滤波器也可能带来意想不到的副作用。这最后一个练习通过一个数值实验，来研究 Robert-Asselin 滤波器的一个关键副作用：它对数值格式形式精度的影响。通过在不同的 $\\alpha$ 选择策略下测量收敛阶，您将验证理论预测，并学习如何在不降低解的精度的前提下应用该滤波器——这是严谨科学建模的一项至关重要的技能 。",
            "id": "3816241",
            "problem": "考虑从不含压力梯度的科里奥利力作用下的水平动量方程得到的线性惯性振荡，这是计算海洋学中的一个标准测试。设 $u(t)$ 和 $v(t)$ 分别表示纬向和经向速度分量。控制方程为\n$$\n\\frac{d u}{d t} = f\\, v, \\qquad \\frac{d v}{d t} = -f\\, u,\n$$\n其中 $f$ 是科里奥利参数，单位为 $\\mathrm{s}^{-1}$。引入复变量 $z(t) = u(t) + i\\, v(t)$，得到标量常微分方程\n$$\n\\frac{d z}{d t} = i\\, f\\, z,\n$$\n其精确解为 $z(t) = z(0)\\, e^{i f t}$，该解对所有 $t$ 都是光滑的。惯性周期为 $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ 秒。\n\n地球物理流体动力学中一种常见的显式时间离散化方法是蛙跳格式（leapfrog scheme）。对于时间步长 $\\Delta t$（单位为秒），该标量方程的蛙跳格式更新步骤为\n$$\nz^{n+1} = z^{n-1} + 2\\, \\Delta t\\, i\\, f\\, z^{n},\n$$\n其中 $z^{n}$ 是 $z(n \\Delta t)$ 的近似值。已知蛙跳格式对于光滑解在时间上是二阶精确的，但它会产生一个解耦的计算模式。一种广泛使用的稳定化方法是 Robert–Asselin 时间滤波器（RA 滤波器），其定义为平滑操作\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right),\n$$\n其中 $\\alpha$ 是一个无量纲的滤波器参数。RA 滤波器可以抑制计算模式，但可能会根据 $\\alpha$ 相对于 $\\Delta t$ 的缩放关系而改变物理模式的理论精度阶数。\n\n您的任务是设计并实现一个数值测试，以测量在使用不同 $\\alpha$ 缩放关系的情况下，带 RA 滤波器的蛙跳格式对于光滑精确解 $z(t) = e^{i f t}$ 的观测精度阶数。从上述基本原理（惯性振荡和蛙跳格式）出发，构建一个程序来执行以下操作：\n\n1. 使用蛙跳格式积分一个惯性周期 $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$，并在每个内部时间层级应用 RA 滤波器。\n2. 使用精确值 $z^{0} = 1$ 和 $z^{1} = e^{i f \\Delta t}$ 进行初始化，以确保启动过程不会污染渐近精度的测量。\n3. 对于一系列时间步长 $\\Delta t_{k} = \\frac{T_{\\mathrm{I}}}{N_{k}}$（其中 $N_{k} \\in \\{32, 64, 128, 256\\}$），计算在 $t = T_{\\mathrm{I}}$ 时的数值解 $z^{N_{k}}$ 和绝对误差 $E(\\Delta t_{k}) = \\left| z^{N_{k}} - e^{i f T_{\\mathrm{I}}} \\right|$，该误差是无量纲的。\n4. 通过对 $(\\log(\\Delta t_{k}), \\log(E(\\Delta t_{k})))$ 进行直线拟合并取其斜率 $p$ 来估计观测精度阶数 $p$（因为一个 $p$ 阶方法对于小的 $\\Delta t$ 满足 $E(\\Delta t) \\approx C\\, \\Delta t^{p}$）。\n\n在以下三种情况下执行上述测试：\n\n- 情况 A（无滤波器）：$\\alpha = 0$。\n- 情况 B（恒定 RA 滤波器）：$\\alpha = 0.05$。\n- 情况 C（二次缩放）：$\\alpha = \\kappa\\, \\Delta t^{2}$，其中 $\\kappa = \\dfrac{0.05}{T_{\\mathrm{I}}^{2}}$，使得 $\\alpha$ 随 $\\Delta t^{2}$ 减小。\n\n使用 $f = 10^{-4}\\ \\mathrm{s}^{-1}$ 并精确积分一个惯性周期 $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ 秒。角度通过 $e^{i f t}$ 隐式地以弧度为单位进行测量，但无需输出角度单位。误差是一个没有物理单位的浮点数。最终报告的观测阶数 $p$ 是无单位的浮点数。\n\n您的程序应计算与上述情况相对应的三个观测阶数 $p$，并生成一行输出，其中包含这三个值，顺序为 [情况 A, 情况 B, 情况 C]，形式为方括号内由逗号分隔的列表，并四舍五入到三位小数（例如，“[2.001,0.998,2.000]”）。\n\n测试套件和覆盖范围：\n\n- 正常路径：情况 A（无滤波器）应展示蛙跳格式的二阶收敛性。\n- 显著修改：情况 B（恒定 $\\alpha$）预计会改变观测阶数。\n- 缩放边界情况：情况 C（$\\alpha \\propto \\Delta t^{2}$）预计将恢复与蛙跳格式核心一致的高阶行为。\n\n您的实现必须是一个完整、可运行的程序，执行这些实验并按要求的单行格式输出结果。所有计算中，时间单位应为秒，$f$ 的单位应为 $\\mathrm{s}^{-1}$。该测试唯一的数值输入是指定的 $f$、集合 $\\{N_{k}\\}$ 以及上面定义的 $\\alpha$ 的缩放关系。输出是从对数-对数斜率估计出的三个浮点数。",
            "solution": "惯性振荡方程是测试时间精度的经典基础，因为它们能产生光滑的正弦解，并能分离出时间离散化的影响。从科里奥利力作用下的水平动量方程出发，\n$$\n\\frac{d u}{d t} = f\\, v, \\qquad \\frac{d v}{d t} = -f\\, u,\n$$\n通过 $z = u + i v$ 可获得标量复常微分方程，\n$$\n\\frac{d z}{d t} = i\\, f\\, z, \\quad z(t) = z(0)\\, e^{i f t}.\n$$\n该精确解是光滑的周期函数，其惯性周期为 $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$。\n\n蛙跳格式是通过用中心差分近似 $t^{n}$ 处的时间导数，\n$$\n\\left.\\frac{d z}{d t}\\right|_{t^{n}} \\approx \\frac{z^{n+1} - z^{n-1}}{2 \\Delta t},\n$$\n并使其等于右侧项 $i f z^{n}$ 而得到的。由此得出\n$$\nz^{n+1} = z^{n-1} + 2\\, \\Delta t\\, i\\, f\\, z^{n}.\n$$\n对精确解进行泰勒级数展开表明，对于足够光滑的 $z(t)$，蛙跳格式的局部截断误差为 $O(\\Delta t^3)$，全局误差为 $O(\\Delta t^2)$。然而，蛙跳格式会产生一个与奇偶时间层级解耦相关的计算模式，这在实际应用中会污染解。\n\n为了抑制计算模式，Robert–Asselin 时间滤波器在计算出 $z^{n+1}$ 后，对当前时间层级应用平滑操作：\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right).\n$$\n括号中的项是二阶时间差分，通过在 $t^{n}$ 附近对 $z^{n\\pm 1}$ 进行泰勒展开，可得\n$$\nz^{n-1} - 2 z^{n} + z^{n+1} = \\Delta t^{2}\\, \\frac{d^{2} z}{d t^{2}}(t^{n}) + \\frac{\\Delta t^{4}}{12}\\, \\frac{d^{4} z}{d t^{4}}(t^{n}) + O(\\Delta t^6).\n$$\n如果将此平滑操作对连续解应用一次，其主阶变化将表现为 $O(\\alpha \\Delta t^2)$。然而，在离散多步格式的背景下，RA 滤波器会扰动蛙跳格式的时间中心特性，因为它使用 $z^{n+1}$ 来更新 $z^{n}$，破坏了两时间层级模板的严格对称性。对蛙跳格式加滤波器的组合方法进行修正方程分析表明，物理模式会获得一个与 $\\alpha$ 乘以低阶时间导数成正比的主导误差项，并且当 $\\alpha$ 保持恒定时，在每个时间步上应用滤波器，在 $O(1)$ 时间区间内的累积效应会产生一个 $O(\\Delta t)$ 的全局误差缩放。因此：\n- 当 $\\alpha = 0$ 时，该方法是标准的蛙跳格式，具有二阶精度。\n- 当 $\\alpha$ 为常数（例如，$\\alpha = 0.05$）时，滤波器在每一步都会引入持续的非对称性，全局误差通常按 $O(\\Delta t)$ 缩放，因此观测阶数约为 1。\n- 如果 $\\alpha$ 的缩放使其随 $\\Delta t$ 足够快地衰减，则滤波器的扰动将变为高阶。一种常被引用的充分缩放关系是 $\\alpha = O(\\Delta t^2)$，此时每步的附加扰动为 $O(\\Delta t^4)$，在 $O(\\Delta t^{-1})$ 步数上的累积全局误差的主导项仍为 $O(\\Delta t^3)$。在这种情况下，蛙跳格式的核心二阶行为在观测全局误差中得以恢复。\n\n基于这些原理，我们设计如下数值测试。我们设定 $f = 10^{-4}\\ \\mathrm{s}^{-1}$ 并精确积分一个惯性周期 $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ 秒。为确保覆盖范围和渐近行为，我们选择步数 $N \\in \\{32, 64, 128, 256\\}$ 及相应的时间步长 $\\Delta t = T_{\\mathrm{I}}/N$。对于每个 $\\Delta t$，我们根据精确解初始化 $z^{0} = 1$ 和 $z^{1} = e^{i f \\Delta t}$ 以避免启动误差。然后我们对 $n = 1, 2, \\dots, N-1$ 进行迭代：\n1. 计算蛙跳格式更新 $z^{n+1} = z^{n-1} + 2\\, \\Delta t\\, i\\, f\\, z^{n}$。\n2. 根据所考虑情况的指定 $\\alpha$ 缩放关系，对 $z^{n}$ 应用 RA 滤波器：\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right).\n$$\n我们不对 $z^{0}$ 或 $z^{N}$ 进行滤波。\n\n经过 $N$ 步后，我们计算误差 $E(\\Delta t) = \\left| z^{N} - e^{i f T_{\\mathrm{I}}} \\right|$。由于 $e^{i f T_{\\mathrm{I}}} = e^{i 2\\pi} = 1$，这可简化为 $E(\\Delta t) = \\left| z^{N} - 1 \\right|$。对于每种情况（无滤波器、恒定 $\\alpha = 0.05$ 以及二次缩放 $\\alpha = \\kappa \\Delta t^{2}$ 且 $\\kappa = \\frac{0.05}{T_{\\mathrm{I}}^{2}}$），我们计算四个 $\\Delta t$ 值对应的 $E(\\Delta t)$，并通过对数据点对 $(\\log(\\Delta t), \\log(E(\\Delta t)))$ 进行最小二乘法直线拟合来估计观测阶数 $p$。如果 $E(\\Delta t) \\approx C\\, \\Delta t^{p}$，则 $\\log(E(\\Delta t)) \\approx \\log C + p \\log(\\Delta t)$，因此斜率 $p$ 就是观测阶数。\n\n基于上述分析，预期的结果是：\n- 情况 A ($\\alpha = 0$)：$p \\approx 2$（二阶）。\n- 情况 B ($\\alpha = 0.05$)：$p \\approx 1$（由于持续的滤波器非对称性导致一阶）。\n- 情况 C ($\\alpha = \\kappa \\Delta t^{2}$)：$p \\approx 2$（由于滤波器扰动随 $\\Delta t$ 呈二次方消失，恢复了二阶精度）。\n\n算法实现遵循这些步骤，最终程序按要求输出一行，其中包含与三种情况相对应的三个观测 $p$ 值的浮点数，四舍五入到三位小数并用方括号括起来。所有带物理单位的变量都以秒或秒的倒数为单位指定，输出是无单位的浮点数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef inertial_period(f):\n    return 2.0 * np.pi / f\n\ndef exact_solution(f, t):\n    # z(t) = exp(i f t)\n    return np.exp(1j * f * t)\n\ndef leapfrog_ra_integrate(f, dt, N, alpha_mode, T_I):\n    \"\"\"\n    Integrate z' = i f z over N steps of size dt using leapfrog and RA filter.\n    alpha_mode: 'none', 'const', or 'quad'\n    \"\"\"\n    # Determine alpha for this dt\n    if alpha_mode == 'none':\n        alpha = 0.0\n    elif alpha_mode == 'const':\n        alpha = 0.05\n    elif alpha_mode == 'quad':\n        # alpha = k * dt^2, with k = 0.05 / T_I^2 to keep scale comparable\n        alpha = 0.05 * (dt**2) / (T_I**2)\n    else:\n        raise ValueError(\"Unknown alpha_mode\")\n\n    # Initialize with exact values\n    z_prev = exact_solution(f, 0.0)                 # z^0\n    z_curr = exact_solution(f, dt)                  # z^1\n\n    # Time stepping\n    for n in range(1, N):\n        # Leapfrog update to get z^{n+1}\n        z_next = z_prev + 2.0 * dt * 1j * f * z_curr\n        # Apply RA filter to z^n (current)\n        # z^n - z^n + alpha (z^{n-1} - 2 z^n + z^{n+1})\n        z_curr = z_curr + alpha * (z_prev - 2.0 * z_curr + z_next)\n        # Shift for next iteration: (n+1) becomes current, filtered z^n becomes previous\n        z_prev, z_curr = z_curr, z_next\n\n    # After N steps, z_curr is z^N (unfiltered at final level)\n    return z_curr\n\ndef observed_order(log_dt, log_err):\n    # Fit log(err) = a + p * log(dt); return p\n    # Use least squares linear fit\n    p, a = np.polyfit(log_dt, log_err, 1)\n    return p\n\ndef solve():\n    # Define the test cases from the problem statement.\n    f = 1e-4  # s^-1\n    T_I = inertial_period(f)  # seconds, one inertial period\n\n    # Numbers of steps for dt = T_I / N\n    N_list = [32, 64, 128, 256]\n\n    # Alpha modes to test: Case A, Case B, Case C\n    alpha_modes = ['none', 'const', 'quad']\n\n    results = []\n    for mode in alpha_modes:\n        dt_list = []\n        err_list = []\n        for N in N_list:\n            dt = T_I / N\n            zN = leapfrog_ra_integrate(f, dt, N, mode, T_I)\n            # Exact at T_I is exp(i f T_I) = exp(i 2 pi) = 1\n            exact_T = 1.0 + 0.0j\n            err = abs(zN - exact_T)\n            dt_list.append(dt)\n            err_list.append(err)\n\n        # Compute observed order via log-log slope\n        log_dt = np.log(np.array(dt_list))\n        log_err = np.log(np.array(err_list))\n        p = observed_order(log_dt, log_err)\n        results.append(p)\n\n    # Final print statement in the exact required format: three values rounded to three decimals\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}