{
    "hands_on_practices": [
        {
            "introduction": "The leapfrog scheme is powerful but introduces an unphysical computational mode. To understand how the Robert-Asselin filter addresses this, we must analyze its effect on the numerical propagation of waves. This exercise guides you through deriving the discrete dispersion relation, which reveals precisely how the filter coefficient $\\epsilon$ modifies the amplification factor $\\lambda$ of both the physical and computational modes .",
            "id": "3816242",
            "problem": "Consider one-dimensional linear advection, $u_{t} + c\\,u_{x} = 0$, on a uniform grid with spatial interval $\\Delta x$ and time step $\\Delta t$. The field is discretized with centered differences in space and the leapfrog scheme in time, and the Robert-Asselin time filter (RA) is optionally applied. Let the discrete state at grid point $x_{j} = j\\,\\Delta x$ and time $t^{n} = n\\,\\Delta t$ be $u_{j}^{n}$. The leapfrog update is defined by the centered-difference approximation for $u_{x}$ and the centered-in-time approximation for $u_{t}$. The RA filter has coefficient $\\epsilon \\in [0,1)$ and is applied after each leapfrog step to the intermediate time level according to the standard practice for the Robert-Asselin time filter (RA), namely replacing $u_{j}^{n}$ by $u_{j}^{n} + \\epsilon\\,(u_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1})$.\n\nAdopt a normal-mode ansatz $u_{j}^{n} = \\hat{u}\\,\\exp\\!\\big(i\\,k\\,x_{j}\\big)\\,\\lambda^{n}$, where $k$ is the continuous wavenumber, $\\kappa \\equiv k\\,\\Delta x$ is the dimensionless grid wavenumber, and $\\lambda$ is the one-step amplification factor. Define the Courant number $\\mu \\equiv c\\,\\Delta t / \\Delta x$. Starting from the partial differential equation and the above discretization definitions, derive the closed-form discrete dispersion relations for the one-step amplification factor $\\lambda$ as functions of $\\mu$ and $\\kappa$:\n- Without the Robert-Asselin time filter (i.e., $\\epsilon = 0$).\n- With the Robert-Asselin time filter of coefficient $\\epsilon$.\n\nExpress both final relations as closed-form analytic expressions for the amplification factor of the physical (advecting) mode, in terms of $\\mu$, $\\kappa$, and $\\epsilon$. Do not present intermediate equations; provide only the final expressions. No rounding is required, and no units are to be reported.",
            "solution": "The problem requires the derivation of the discrete dispersion relation, specifically the one-step amplification factor $\\lambda$, for the linear advection equation discretized using the leapfrog scheme, both with and without the Robert-Asselin (RA) time filter.\n\nThe one-dimensional linear advection equation is given by:\n$$\nu_{t} + c\\,u_{x} = 0\n$$\nwhere $u$ is the field variable, $t$ is time, $x$ is the spatial coordinate, and $c$ is the constant advection speed.\n\nThe problem is discretized on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$. The state is denoted $u_j^n = u(j\\Delta x, n\\Delta t)$. The leapfrog scheme uses a centered difference in time, and the spatial derivative is approximated by a centered difference:\n$$\n\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0\n$$\nThis can be rearranged to express the state at the new time level $n+1$:\n$$\nu_j^{n+1} = u_j^{n-1} - \\frac{c\\Delta t}{\\Delta x} (u_{j+1}^n - u_{j-1}^n)\n$$\nUsing the definition of the Courant number $\\mu \\equiv c\\,\\Delta t / \\Delta x$, the update rule becomes:\n$$\nu_j^{n+1} = u_j^{n-1} - \\mu (u_{j+1}^n - u_{j-1}^n)\n$$\nTo analyze the stability and dispersion of this scheme, we use the von Neumann method, substituting the normal-mode ansatz $u_j^n = \\hat{u}\\,\\exp\\!\\big(i\\,k\\,x_{j}\\big)\\,\\lambda^{n}$ into the discrete equation. Here $i = \\sqrt{-1}$, $k$ is the wavenumber, $\\lambda$ is the amplification factor per time step, and $\\hat{u}$ is a constant amplitude. Substituting $x_j=j\\Delta x$ gives $u_j^n = \\hat{u} \\lambda^n e^{ikj\\Delta x}$.\n\nPlugging the ansatz into the discrete equation:\n$$\n\\hat{u}\\lambda^{n+1} e^{ikj\\Delta x} = \\hat{u}\\lambda^{n-1} e^{ikj\\Delta x} - \\mu \\left( \\hat{u}\\lambda^{n} e^{ik(j+1)\\Delta x} - \\hat{u}\\lambda^{n} e^{ik(j-1)\\Delta x} \\right)\n$$\nDividing by $\\hat{u}\\lambda^{n-1} e^{ikj\\Delta x}$ (assuming it is non-zero):\n$$\n\\lambda^2 = 1 - \\mu \\lambda (e^{ik\\Delta x} - e^{-ik\\Delta x})\n$$\nUsing the identity $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ and the definition of the dimensionless wavenumber $\\kappa \\equiv k\\Delta x$:\n$$\n\\lambda^2 = 1 - \\mu \\lambda (2i\\sin\\kappa)\n$$\nThis gives the characteristic polynomial for the amplification factor $\\lambda$:\n$$\n\\lambda^2 + 2i\\mu\\sin(\\kappa)\\lambda - 1 = 0\n$$\n\n**Case 1: Without the Robert-Asselin time filter ($\\epsilon = 0$)**\n\nThis is the standard leapfrog scheme. The characteristic equation is the quadratic equation derived above. We solve for $\\lambda$:\n$$\n\\lambda = \\frac{-2i\\mu\\sin\\kappa \\pm \\sqrt{(2i\\mu\\sin\\kappa)^2 - 4(1)(-1)}}{2} = \\frac{-2i\\mu\\sin\\kappa \\pm \\sqrt{-4\\mu^2\\sin^2\\kappa + 4}}{2}\n$$\n$$\n\\lambda = -i\\mu\\sin\\kappa \\pm \\sqrt{1 - \\mu^2\\sin^2\\kappa}\n$$\nThis equation yields two roots for $\\lambda$, corresponding to a physical mode and a computational mode. The physical mode is the one that approximates the analytical amplification factor of the true solution, which is $e^{-i\\omega\\Delta t} = e^{-ikc\\Delta t} = e^{-i\\mu\\kappa}$. For small $\\mu$ and $\\kappa$, $e^{-i\\mu\\kappa} \\approx 1 - i\\mu\\kappa - \\frac{1}{2}(\\mu\\kappa)^2$.\nThe Taylor expansion of the root with the positive sign is $\\lambda \\approx -i\\mu\\kappa + (1 - \\frac{1}{2}\\mu^2\\kappa^2) = 1 - i\\mu\\kappa - \\frac{1}{2}\\mu^2\\kappa^2$, which matches the expansion of the analytical solution. Thus, the physical mode is:\n$$\n\\lambda_{\\text{physical}} = -i\\mu\\sin\\kappa + \\sqrt{1 - \\mu^2\\sin^2\\kappa}\n$$\n\n**Case 2: With the Robert-Asselin time filter of coefficient $\\epsilon$**\n\nThe RA filter is applied sequentially. First, a provisional value $u_j^{*,n+1}$ is computed using the leapfrog step. Then, the value at the central time level, $u_j^n$, is updated using this provisional value.\n1.  **Predictor step (Leapfrog):** $u_j^{*,n+1} = u_j^{n-1} - \\mu(u_{j+1}^n - u_{j-1}^n)$\n2.  **Corrector step (Filter):** The value $u_j^n$ is replaced by $\\bar{u}_j^n = u_j^n + \\epsilon(u_j^{*,n+1} - 2u_j^n + u_j^{n-1})$.\nThe new state carried forward to the next time step consists of $(\\bar{u}_j^n, u_j^{n+1})$, where $u_j^{n+1} = u_j^{*,n+1}$.\n\nWe perform a Fourier analysis of this two-stage process. Let $\\hat{u}^n$ be the Fourier amplitude of $u_j^n$. The spatial difference operator becomes a multiplication by $2i\\sin\\kappa$. Let $\\sigma = \\mu\\sin\\kappa$.\nThe system in Fourier space is:\n1.  $\\hat{u}^{*,n+1} = \\hat{u}^{n-1} - 2i\\sigma \\hat{u}^n$\n2.  $\\bar{u}^n = \\hat{u}^n + \\epsilon(\\hat{u}^{*,n+1} - 2\\hat{u}^n + \\hat{u}^{n-1})$\n\nThe state at any time can be described by a vector of amplitudes at two consecutive time levels, $V_n = \\begin{pmatrix} \\hat{u}^n \\\\ \\hat{u}^{n-1} \\end{pmatrix}$. The evolution to the next state $V_{n+1} = \\begin{pmatrix} \\hat{u}^{n+1} \\\\ \\bar{u}^n \\end{pmatrix}$ is given by a matrix $G$: $V_{n+1} = G V_n$.\nThe components of $V_{n+1}$ are:\n$\\hat{u}^{n+1} = \\hat{u}^{*,n+1} = -2i\\sigma \\hat{u}^n + \\hat{u}^{n-1}$\n$\\bar{u}^n = \\hat{u}^n + \\epsilon((\\hat{u}^{n-1} - 2i\\sigma \\hat{u}^n) - 2\\hat{u}^n + \\hat{u}^{n-1}) = (1 - 2\\epsilon - 2i\\sigma\\epsilon)\\hat{u}^n + 2\\epsilon \\hat{u}^{n-1}$\n\nThe amplification matrix $G$ is therefore:\n$$\nG = \\begin{pmatrix} -2i\\sigma & 1 \\\\ 1 - 2\\epsilon(1+i\\sigma) & 2\\epsilon \\end{pmatrix}\n$$\nThe amplification factors $\\lambda$ are the eigenvalues of $G$, found by solving $\\det(G - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} -2i\\sigma - \\lambda & 1 \\\\ 1 - 2\\epsilon(1+i\\sigma) & 2\\epsilon - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-2i\\sigma - \\lambda)(2\\epsilon - \\lambda) - (1 - 2\\epsilon(1+i\\sigma)) = 0\n$$\nExpanding this determinant gives the characteristic equation:\n$$\n\\lambda^2 - 2\\epsilon\\lambda + 2i\\sigma\\lambda - 4i\\sigma\\epsilon - 1 + 2\\epsilon + 2i\\sigma\\epsilon = 0\n$$\n$$\n\\lambda^2 + 2(i\\sigma - \\epsilon)\\lambda + (2\\epsilon - 1 - 2i\\sigma\\epsilon) = 0\n$$\nSolving this quadratic equation for $\\lambda$:\n$$\n\\lambda = -(i\\sigma - \\epsilon) \\pm \\sqrt{(i\\sigma - \\epsilon)^2 - (2\\epsilon - 1 - 2i\\sigma\\epsilon)}\n$$\n$$\n\\lambda = \\epsilon - i\\sigma \\pm \\sqrt{(-\\sigma^2 - 2i\\sigma\\epsilon + \\epsilon^2) - (2\\epsilon - 1 - 2i\\sigma\\epsilon)}\n$$\n$$\n\\lambda = \\epsilon - i\\sigma \\pm \\sqrt{-\\sigma^2 + \\epsilon^2 - 2\\epsilon + 1} = \\epsilon - i\\sigma \\pm \\sqrt{(1-\\epsilon)^2 - \\sigma^2}\n$$\nSubstituting $\\sigma = \\mu\\sin\\kappa$ back:\n$$\n\\lambda = \\epsilon - i\\mu\\sin\\kappa \\pm \\sqrt{(1-\\epsilon)^2 - \\mu^2\\sin^2\\kappa}\n$$\nTo identify the physical mode, we examine the limit as $\\epsilon \\to 0$. The expression becomes $-i\\mu\\sin\\kappa \\pm \\sqrt{1 - \\mu^2\\sin^2\\kappa}$, which is the result for the unfiltered scheme. As established before, the physical mode corresponds to taking the positive sign for the square root. Thus, the amplification factor for the physical mode with the RA filter is:\n$$\n\\lambda_{\\text{physical}} = \\epsilon - i\\mu\\sin\\kappa + \\sqrt{(1-\\epsilon)^2 - \\mu^2\\sin^2\\kappa}\n$$\nThis expression correctly reduces to the unfiltered physical mode amplification factor when $\\epsilon=0$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -i\\mu\\sin(\\kappa) + \\sqrt{1 - \\mu^{2}\\sin^{2}(\\kappa)} & \\epsilon - i\\mu\\sin(\\kappa) + \\sqrt{(1-\\epsilon)^{2} - \\mu^{2}\\sin^{2}(\\kappa)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With a theoretical understanding of the filter's mechanism, the next step is practical application. Choosing the filter coefficient $\\alpha$ is a balancing act; if it's too small the computational mode remains, and if it's too large the physical solution is overly damped. This practice puts you in the role of a model developer, tasked with calculating the specific value of $\\alpha$ that meets precise damping criteria for both the computational and physical modes in a simulation of inertial oscillations .",
            "id": "3816225",
            "problem": "Consider a linear inertial oscillation on an $f$-plane, modeled for a single Fourier component by the complex amplitude equation $\\frac{dy}{dt} = i \\omega y$ with $\\omega = f$, where $f$ is the Coriolis parameter. The state $y$ is advanced in time using the leapfrog scheme with timestep $\\Delta t$, and a Robert-Asselin (RA) time filter with coefficient $\\alpha$ is applied at each step to suppress the computational mode. Define the nondimensional frequency $\\mu = \\omega \\Delta t$. The leapfrog update is $y^{n+1} = y^{n-1} + 2 i \\mu y^n$, followed by the RA filter applied to the middle time level $y^n \\leftarrow y^n + \\alpha \\left(y^{n+1} - 2 y^n + y^{n-1}\\right)$ before the next update.\n\nTreating one full leapfrog-plus-filter cycle as a linear map on the state vector $\\left(y^n, y^{n-1}\\right)$, the map has two amplification eigenmodes: a physical mode and the computational mode. The computational eigenmode must be critically damped so that its magnitude after one cycle is not greater than a prescribed threshold $\\rho_c$, while the physical-mode damping must remain below a tolerance $\\delta_p$, meaning the physical-mode magnitude after one cycle satisfies $|\\lambda_p| \\geq 1 - \\delta_p$.\n\nFor an open-ocean inertial oscillation with $f = 1.0 \\times 10^{-4}\\,\\mathrm{s}^{-1}$ and $\\Delta t = 1800\\,\\mathrm{s}$, take the thresholds $\\rho_c = 0.85$ and $\\delta_p = 0.0014$. Determine the value of the Robert-Asselin filter coefficient $\\alpha$ that sets the computational-mode magnitude exactly at $\\rho_c$ while keeping the physical-mode damping within tolerance. Express your final answer as a pure number (dimensionless), and round your answer to four significant figures.",
            "solution": "The user wants me to solve a problem involving the Robert-Asselin time filter.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: The complex amplitude evolution is modeled by $\\frac{dy}{dt} = i \\omega y$.\n-   **Frequency**: $\\omega = f$.\n-   **Coriolis Parameter**: $f = 1.0 \\times 10^{-4}\\,\\mathrm{s}^{-1}$.\n-   **Time Step**: $\\Delta t = 1800\\,\\mathrm{s}$.\n-   **Nondimensional Frequency**: $\\mu = \\omega \\Delta t$.\n-   **Numerical Scheme (Leapfrog)**: $y^{n+1} = y^{n-1} + 2 i \\mu y^n$.\n-   **Numerical Scheme (Robert-Asselin Filter)**: The filter is applied to the middle time level as $y^n \\leftarrow y^n + \\alpha \\left(y^{n+1} - 2 y^n + y^{n-1}\\right)$.\n-   **Computational Mode Constraint**: The magnitude of the computational mode amplification factor, $|\\lambda_c|$, must be exactly a prescribed threshold $\\rho_c = 0.85$.\n-   **Physical Mode Constraint**: The magnitude of the physical mode amplification factor, $|\\lambda_p|$, must satisfy $|\\lambda_p| \\geq 1 - \\delta_p$, where the tolerance is $\\delta_p = 0.0014$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is firmly rooted in the field of computational fluid dynamics, specifically the analysis of numerical schemes used in geophysical models. The leapfrog scheme, inertial oscillations, and the Robert-Asselin filter are standard topics in this domain. The problem is scientifically sound.\n-   **Well-Posed**: The problem provides all necessary equations, parameters, and constraints to uniquely determine the value of the filter coefficient $\\alpha$. The setup allows for a direct mathematical solution.\n-   **Objective**: The problem is described using precise, unambiguous mathematical and physical language. There are no subjective or opinion-based statements.\n-   **Other Criteria**: The problem is self-contained, consistent, and poses a realistic challenge in the analysis of numerical methods. It does not violate any of the other invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\nThe problem describes a full cycle of the leapfrog scheme combined with a Robert-Asselin (RA) filter. We first establish the transfer matrix for one cycle, from which we can find the amplification factors (eigenvalues).\n\nLet the state of the system at the beginning of a cycle be described by the vector $\\mathbf{Y}^n = \\begin{pmatrix} y^n \\\\ y^{n-1} \\end{pmatrix}$. The cycle consists of two steps as defined in the problem:\n1.  A leapfrog update to find a tentative value for the next time step, let's call it $y_{tent}^{n+1}$:\n    $$y_{tent}^{n+1} = y^{n-1} + 2 i \\mu y^n$$\n2.  An RA filter application that updates the value at the middle time level, $y^n$. Let's call the filtered value $\\bar{y}^n$:\n    $$\\bar{y}^n = y^n + \\alpha \\left(y_{tent}^{n+1} - 2 y^n + y^{n-1}\\right)$$\nThe state vector for the beginning of the next cycle is $\\mathbf{Y}^{n+1} = \\begin{pmatrix} y^{n+1} \\\\ \\bar{y}^n \\end{pmatrix}$. The problem states the leapfrog update $y^{n+1} = ...$ is followed by the filter, implying $y^{n+1} = y_{tent}^{n+1}$. So, we have the new state vector $(y^{n+1}, \\bar{y}^n)^T$.\n\nLet's express the components of the new state vector in terms of the old state vector's components, $y^n$ and $y^{n-1}$.\nThe first component is straightforward:\n$$y^{n+1} = (2 i \\mu) y^n + (1) y^{n-1}$$\nFor the second component, we substitute the expression for $y_{tent}^{n+1}$ into the filter equation:\n$$\\bar{y}^n = y^n + \\alpha \\left((y^{n-1} + 2 i \\mu y^n) - 2 y^n + y^{n-1}\\right)$$\n$$\\bar{y}^n = y^n + \\alpha \\left((2 i \\mu - 2) y^n + 2 y^{n-1}\\right)$$\n$$\\bar{y}^n = (1 - 2\\alpha + 2 i \\alpha \\mu) y^n + (2\\alpha) y^{n-1}$$\n\nWe can now write the evolution of the state vector as a matrix-vector product:\n$$\\begin{pmatrix} y^{n+1} \\\\ \\bar{y}^n \\end{pmatrix} = \\begin{pmatrix} 2 i \\mu & 1 \\\\ 1 - 2\\alpha + 2 i \\alpha \\mu & 2\\alpha \\end{pmatrix} \\begin{pmatrix} y^n \\\\ y^{n-1} \\end{pmatrix}$$\nLet the transfer matrix be $\\mathbf{M}$:\n$$\\mathbf{M} = \\begin{pmatrix} 2 i \\mu & 1 \\\\ 1 - 2\\alpha + 2 i \\alpha \\mu & 2\\alpha \\end{pmatrix}$$\nThe amplification factors, $\\lambda$, are the eigenvalues of $\\mathbf{M}$. They are the roots of the characteristic equation $\\det(\\mathbf{M} - \\lambda \\mathbf{I}) = 0$.\n$$\\det \\begin{pmatrix} 2 i \\mu - \\lambda & 1 \\\\ 1 - 2\\alpha + 2 i \\alpha \\mu & 2\\alpha - \\lambda \\end{pmatrix} = 0$$\n$$(2 i \\mu - \\lambda)(2\\alpha - \\lambda) - (1 - 2\\alpha + 2 i \\alpha \\mu) = 0$$\n$$\\lambda^2 - (2\\alpha + 2 i \\mu)\\lambda + 4 i \\alpha \\mu - 1 + 2\\alpha - 2 i \\alpha \\mu = 0$$\n$$\\lambda^2 - 2(\\alpha + i \\mu)\\lambda + (2\\alpha - 1 + 2 i \\alpha \\mu) = 0$$\nWe solve this quadratic equation for $\\lambda$:\n$$\\lambda = \\frac{2(\\alpha + i \\mu) \\pm \\sqrt{4(\\alpha + i \\mu)^2 - 4(2\\alpha - 1 + 2 i \\alpha \\mu)}}{2}$$\n$$\\lambda = (\\alpha + i \\mu) \\pm \\sqrt{(\\alpha + i \\mu)^2 - (2\\alpha - 1 + 2 i \\alpha \\mu)}$$\nLet's simplify the term under the square root:\n$$(\\alpha^2 - \\mu^2 + 2 i \\alpha \\mu) - (2\\alpha - 1 + 2 i \\alpha \\mu) = \\alpha^2 - \\mu^2 - 2\\alpha + 1 = (1-\\alpha)^2 - \\mu^2$$\nSo, the eigenvalues are:\n$$\\lambda = (\\alpha + i \\mu) \\pm \\sqrt{(1-\\alpha)^2 - \\mu^2}$$\nFirst, we calculate the nondimensional frequency $\\mu$:\n$$\\mu = f \\Delta t = (1.0 \\times 10^{-4}\\,\\mathrm{s}^{-1})(1800\\,\\mathrm{s}) = 0.18$$\nFor typical small values of $\\alpha$, we have $(1-\\alpha)^2 > \\mu^2$, so the square root is real. Let $S = \\sqrt{(1-\\alpha)^2 - \\mu^2}$.\nThe two eigenvalues are $\\lambda_1 = (\\alpha+S) + i\\mu$ and $\\lambda_2 = (\\alpha-S) + i\\mu$.\n\nThe physical mode's amplification factor $\\lambda_p$ should be close to $e^{i\\mu}$, which for small $\\mu$ is approximately $1+i\\mu$. The real part should be close to $1$.\nThe real part of $\\lambda_1$ is $\\alpha+S \\approx \\alpha + (1-\\alpha) = 1$. So $\\lambda_1$ is the physical mode factor $\\lambda_p$.\nThe computational mode's amplification factor $\\lambda_c$ should have a real part close to $-1$.\nThe real part of $\\lambda_2$ is $\\alpha-S \\approx \\alpha - (1-\\alpha) = 2\\alpha-1 \\approx -1$. So $\\lambda_2$ is the computational mode factor $\\lambda_c$.\n\nWe are given that the magnitude of the computational mode is $|\\lambda_c| = \\rho_c$.\n$$|\\lambda_c|^2 = (\\operatorname{Re}(\\lambda_c))^2 + (\\operatorname{Im}(\\lambda_c))^2 = (\\alpha-S)^2 + \\mu^2$$\n$$|\\lambda_c|^2 = \\alpha^2 - 2\\alpha S + S^2 + \\mu^2$$\nSubstitute $S^2 = (1-\\alpha)^2 - \\mu^2$:\n$$|\\lambda_c|^2 = \\alpha^2 - 2\\alpha S + (1-\\alpha)^2 - \\mu^2 + \\mu^2 = \\alpha^2 - 2\\alpha S + 1 - 2\\alpha + \\alpha^2$$\n$$|\\lambda_c|^2 = 1 - 2\\alpha + 2\\alpha^2 - 2\\alpha S = 1 - 2\\alpha(1 - \\alpha + S)$$\nSubstituting the expression for $S$:\n$$\\rho_c^2 = 1 - 2\\alpha(1 - \\alpha + \\sqrt{(1-\\alpha)^2 - \\mu^2})$$\nThis equation must be solved for $\\alpha$. Let's rearrange it to isolate the square root term.\n$$\\frac{1 - \\rho_c^2}{2\\alpha} = 1 - \\alpha + \\sqrt{(1-\\alpha)^2 - \\mu^2}$$\n$$\\frac{1 - \\rho_c^2}{2\\alpha} - (1 - \\alpha) = \\sqrt{(1-\\alpha)^2 - \\mu^2}$$\nSquaring both sides:\n$$\\left(\\frac{1 - \\rho_c^2}{2\\alpha} - (1 - \\alpha)\\right)^2 = (1-\\alpha)^2 - \\mu^2$$\nExpanding the left side:\n$$\\left(\\frac{1 - \\rho_c^2}{2\\alpha}\\right)^2 - 2\\frac{1 - \\rho_c^2}{2\\alpha}(1-\\alpha) + (1-\\alpha)^2 = (1-\\alpha)^2 - \\mu^2$$\nThe $(1-\\alpha)^2$ terms cancel.\n$$\\frac{(1 - \\rho_c^2)^2}{4\\alpha^2} - \\frac{(1 - \\rho_c^2)(1-\\alpha)}{\\alpha} = -\\mu^2$$\nMultiply by $4\\alpha^2$:\n$$(1 - \\rho_c^2)^2 - 4\\alpha(1 - \\rho_c^2)(1-\\alpha) = -4\\mu^2\\alpha^2$$\nLet $C_1 = 1 - \\rho_c^2$ and $C_2 = 4\\mu^2$.\n$$C_1^2 - 4\\alpha C_1(1-\\alpha) = -C_2\\alpha^2$$\n$$C_1^2 - 4C_1\\alpha + 4C_1\\alpha^2 = -C_2\\alpha^2$$\n$$(4C_1 + C_2)\\alpha^2 - 4C_1\\alpha + C_1^2 = 0$$\nThis is a quadratic equation for $\\alpha$. Now, we substitute the numerical values.\n$\\mu = 0.18 \\implies \\mu^2 = 0.0324$.\n$\\rho_c = 0.85 \\implies \\rho_c^2 = 0.7225$.\n$C_1 = 1 - 0.7225 = 0.2775$.\n$C_2 = 4 \\times 0.0324 = 0.1296$.\n\nThe quadratic equation for $\\alpha$ becomes:\n$$(4 \\times 0.2775 + 0.1296)\\alpha^2 - (4 \\times 0.2775)\\alpha + (0.2775)^2 = 0$$\n$$(1.11 + 0.1296)\\alpha^2 - 1.11\\alpha + 0.07700625 = 0$$\n$$1.2396\\alpha^2 - 1.11\\alpha + 0.07700625 = 0$$\nSolving for $\\alpha$:\n$$\\alpha = \\frac{1.11 \\pm \\sqrt{(-1.11)^2 - 4(1.2396)(0.07700625)}}{2(1.2396)}$$\n$$\\alpha = \\frac{1.11 \\pm \\sqrt{1.2321 - 0.38183883}}{2.4792}$$\n$$\\alpha = \\frac{1.11 \\pm \\sqrt{0.85026117}}{2.4792}$$\n$$\\alpha = \\frac{1.11 \\pm 0.92209607}{2.4792}$$\nThis gives two possible solutions for $\\alpha$:\n$$\\alpha_1 = \\frac{1.11 + 0.92209607}{2.4792} \\approx 0.81966$$\n$$\\alpha_2 = \\frac{1.11 - 0.92209607}{2.4792} = \\frac{0.18790393}{2.4792} \\approx 0.07579$$\nThe filter coefficient $\\alpha$ must be a small value, so we choose the second root, $\\alpha_2$.\n$\\alpha \\approx 0.07579$.\n\nFinally, we must verify that this value of $\\alpha$ satisfies the physical mode damping constraint: $|\\lambda_p| \\ge 1 - \\delta_p$.\nWith $\\delta_p = 0.0014$, the condition is $|\\lambda_p| \\ge 0.9986$. This is equivalent to $|\\lambda_p|^2 \\ge (0.9986)^2 \\approx 0.99720196$.\nThe magnitude of the physical mode is given by:\n$$|\\lambda_p|^2 = (\\alpha+S)^2 + \\mu^2 = \\alpha^2 + 2\\alpha S + S^2 + \\mu^2$$\n$$|\\lambda_p|^2 = \\alpha^2 + 2\\alpha S + (1-\\alpha)^2 - \\mu^2 + \\mu^2 = 1 - 2\\alpha + 2\\alpha^2 + 2\\alpha S$$\n$$|\\lambda_p|^2 = 1 - 2\\alpha(1 - \\alpha - S) = 1 - 2\\alpha(1 - \\alpha - \\sqrt{(1-\\alpha)^2 - \\mu^2})$$\nUsing $\\alpha \\approx 0.07579$:\n$1-\\alpha \\approx 0.92421$.\n$(1-\\alpha)^2 \\approx 0.85416$.\n$\\mu^2 = 0.0324$.\n$\\sqrt{(1-\\alpha)^2 - \\mu^2} \\approx \\sqrt{0.85416 - 0.0324} = \\sqrt{0.82176} \\approx 0.90651$.\n$|\\lambda_p|^2 \\approx 1 - 2(0.07579)(0.92421 - 0.90651) = 1 - 0.15158(0.0177) = 1 - 0.002683 \\approx 0.997317$.\nSince $0.997317 > 0.997202$, the condition on the physical mode is satisfied.\n\nThe required value of $\\alpha$, rounded to four significant figures, is $0.07579$.",
            "answer": "$$\n\\boxed{0.07579}\n$$"
        },
        {
            "introduction": "The benefits of the Robert-Asselin filter come with a significant side effect: a potential reduction in the numerical scheme's accuracy. This numerical experiment will allow you to measure the order of accuracy of the leapfrog scheme and see firsthand how a constant filter coefficient $\\alpha$ degrades it from second-order to first-order. By testing an alternative scaling where $\\alpha$ varies with the time step $\\Delta t$, you will verify how to mitigate this issue and preserve the scheme's formal accuracy .",
            "id": "3816241",
            "problem": "Consider the linear inertial oscillation obtained from the horizontal momentum equations under the Coriolis force with no pressure gradients, which is a standard test in computational oceanography. Let $u(t)$ and $v(t)$ denote the zonal and meridional velocity components, respectively. The governing equations are\n$$\n\\frac{d u}{d t} = f\\, v, \\qquad \\frac{d v}{d t} = -f\\, u,\n$$\nwhere $f$ is the Coriolis parameter in $\\mathrm{s}^{-1}$. Introducing the complex variable $z(t) = u(t) + i\\, v(t)$ gives the scalar ordinary differential equation\n$$\n\\frac{d z}{d t} = -i\\, f\\, z,\n$$\nwith exact solution $z(t) = z(0)\\, e^{-i f t}$, which is smooth for all $t$. The inertial period is $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ seconds.\n\nA common explicit time-discretization in geophysical fluid dynamics is the leapfrog scheme. For a time step $\\Delta t$ (in seconds), the leapfrog update for the scalar equation is\n$$\nz^{n+1} = z^{n-1} - 2\\, \\Delta t\\, i\\, f\\, z^{n},\n$$\nwhere $z^{n}$ approximates $z(n \\Delta t)$. The leapfrog method is known to be second-order accurate in time for smooth solutions, but it admits a decoupled computational mode. A widespread stabilization is the Robert-Asselin time filter (RA filter), defined by the smoothing operation\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right),\n$$\nwhere $\\alpha$ is a dimensionless filter parameter. The RA filter suppresses the computational mode but may alter the formal order of accuracy of the physical mode depending on the scaling of $\\alpha$ with $\\Delta t$.\n\nYour task is to design and implement a numerical test to measure the observed order of accuracy of the leapfrog scheme with the RA filter for the smooth exact solution $z(t) = e^{-i f t}$ under different scalings of $\\alpha$. Start from the fundamental basis given above (the inertial oscillation and the leapfrog scheme), and construct a procedure to:\n\n1. Integrate one inertial period $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ using the leapfrog scheme with the RA filter applied at every interior time level.\n2. Initialize using the exact values $z^{0} = 1$ and $z^{1} = e^{-i f \\Delta t}$ so that the starting procedure does not contaminate the asymptotic accuracy measurement.\n3. For a sequence of time step sizes $\\Delta t_{k} = \\frac{T_{\\mathrm{I}}}{N_{k}}$ with $N_{k} \\in \\{32, 64, 128, 256\\}$, compute the numerical solution $z^{N_{k}}$ at $t = T_{\\mathrm{I}}$ and the absolute error $E(\\Delta t_{k}) = \\left| z^{N_{k}} - e^{-i f T_{\\mathrm{I}}} \\right|$, which is unitless.\n4. Estimate the observed order of accuracy $p$ by fitting a straight line to ($\\log(\\Delta t_k)$, $\\log(E(\\Delta t_k))$) and taking the slope $p$ (since a method of order $p$ satisfies $E(\\Delta t) \\approx C\\, \\Delta t^{p}$ for small $\\Delta t$).\n\nPerform the above test under the following three cases:\n\n- Case A (no filter): $\\alpha = 0$.\n- Case B (constant RA filter): $\\alpha = 0.05$.\n- Case C (quadratic scaling): $\\alpha = \\kappa\\, \\Delta t^{2}$ with $\\kappa = \\dfrac{0.05}{T_{\\mathrm{I}}^{2}}$ so that $\\alpha$ decreases as $\\Delta t^{2}$.\n\nUse $f = 10^{-4}\\ \\mathrm{s}^{-1}$ and integrate exactly one inertial period $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ seconds. Angles are measured in radians implicitly through $e^{-i f t}$, but no angle unit need be output. The error is a float with no physical unit. The final reported observed orders $p$ are unitless floats.\n\nYour program should compute the three observed orders $p$ corresponding to the above cases and produce a single line of output containing the three values, in the order [Case A, Case B, Case C], as a comma-separated list enclosed in square brackets, rounded to three decimal places (for example, \"[2.001,0.998,2.000]\").\n\nTest suite and coverage:\n\n- Happy path: Case A (no filter) should demonstrate second-order convergence for the leapfrog method.\n- Significant modification: Case B (constant $\\alpha$) is expected to alter the observed order.\n- Scaling edge: Case C ($\\alpha \\propto \\Delta t^{2}$) is expected to recover higher-order behavior consistent with the leapfrog core.\n\nYour implementation must be a complete, runnable program that performs these experiments and outputs the required single-line format. All computations should be carried out in seconds for time and with $f$ in $\\mathrm{s}^{-1}$. The only numerical inputs to the test are the prescribed $f$, the set $\\{N_{k}\\}$, and the scalings of $\\alpha$ defined above. The outputs are three floats estimated from the log–log slope.",
            "solution": "The inertial oscillation equations are a canonical base for testing temporal accuracy because they produce smooth sinusoidal solutions and isolate the effect of time discretization. Starting from the horizontal momentum equations under the Coriolis force,\n$$\n\\frac{d u}{d t} = f\\, v, \\qquad \\frac{d v}{d t} = -f\\, u,\n$$\none obtains the scalar complex ordinary differential equation via $z = u + i v$,\n$$\n\\frac{d z}{d t} = -i\\, f\\, z, \\quad z(t) = z(0)\\, e^{-i f t}.\n$$\nThis exact solution is smooth and periodic with inertial period $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$.\n\nThe leapfrog method is derived by approximating the time derivative at $t^{n}$ by a centered difference,\n$$\n\\left.\\frac{d z}{d t}\\right|_{t^{n}} \\approx \\frac{z^{n+1} - z^{n-1}}{2 \\Delta t},\n$$\nand setting it equal to the right-hand side $-i f z^{n}$. This yields\n$$\nz^{n+1} = z^{n-1} - 2\\, \\Delta t\\, i\\, f\\, z^{n}.\n$$\nA Taylor series expansion of the exact solution shows that the local truncation error of leapfrog is $O(\\Delta t^3)$, and the global error is $O(\\Delta t^2)$ for sufficiently smooth $z(t)$. However, leapfrog admits a computational mode associated with the decoupling of even and odd time levels, which can pollute solutions in practical settings.\n\nTo suppress the computational mode, the Robert-Asselin time filter applies a smoothing operation to the current time level after computing $z^{n+1}$:\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right).\n$$\nThe term in parentheses is the second time-difference, which, by Taylor expansion of $z^{n\\pm 1}$ around $t^{n}$, satisfies\n$$\nz^{n-1} - 2 z^{n} + z^{n+1} = \\Delta t^{2}\\, \\frac{d^{2} z}{d t^{2}}(t^{n}) + \\frac{\\Delta t^{4}}{12}\\, \\frac{d^{4} z}{d t^{4}}(t^{n}) + O(\\Delta t^{6}).\n$$\nIf this smoothing were applied to a continuous solution once, its leading-order change would appear to be $O(\\alpha\\, \\Delta t^2)$. However, in the discrete multistep context, the RA filter perturbs the time-centering property of leapfrog because it updates $z^{n}$ using $z^{n+1}$, breaking the strict symmetry of the two-time-level stencil. A modified equation analysis for the combined leapfrog-plus-filter method reveals that the physical mode acquires a leading error term proportional to $\\alpha$ times lower-order time derivatives, and the cumulative effect of applying the filter at every time level over an $O(1)$ time interval produces a global error scaling as $O(\\Delta t)$ when $\\alpha$ is held constant. Therefore:\n- With $\\alpha = 0$, the method is the standard leapfrog scheme, which is second-order accurate.\n- With $\\alpha$ constant (for example, $\\alpha = 0.05$), the filter introduces a persistent asymmetry each step, and the global error typically scales as $O(\\Delta t)$, so the observed order is approximately one.\n- If $\\alpha$ is scaled to decay sufficiently rapidly with $\\Delta t$, the filter’s perturbation becomes a higher-order term. While the standard scaling to preserve second-order accuracy is $\\alpha = O(\\Delta t)$, the scaling tested in Case C, $\\alpha = O(\\Delta t^2)$, is more stringent. For this case, the local error introduced by the filter is $O(\\Delta t^4)$, leading to a cumulative global error of $O(\\Delta t^3)$. Because this error from the filter is of a higher order than the leapfrog scheme's own $O(\\Delta t^2)$ error, the core second-order behavior is recovered.\n\nBased on these principles, we design the numerical test as follows. We set $f = 10^{-4}\\ \\mathrm{s}^{-1}$ and integrate exactly one inertial period $T_{\\mathrm{I}} = \\frac{2\\pi}{f}$ seconds. To ensure coverage and asymptotic behavior, we choose numbers of steps $N \\in \\{32, 64, 128, 256\\}$ and corresponding time steps $\\Delta t = T_{\\mathrm{I}}/N$. For each $\\Delta t$, we initialize $z^{0} = 1$ and $z^{1} = e^{-i f \\Delta t}$ from the exact solution to avoid startup errors. Then we iterate for $n = 1, 2, \\dots, N-1$:\n1. Compute the leapfrog update $z^{n+1} = z^{n-1} - 2\\, \\Delta t\\, i\\, f\\, z^{n}$.\n2. Apply the RA filter to $z^{n}$ using the prescribed $\\alpha$ scaling for the case under consideration:\n$$\nz^{n} \\leftarrow z^{n} + \\alpha \\left( z^{n-1} - 2 z^{n} + z^{n+1} \\right).\n$$\nWe do not filter $z^{0}$ or $z^{N}$.\n\nAfter $N$ steps, we compute the error $E(\\Delta t) = \\left| z^{N} - e^{-i f T_{\\mathrm{I}}} \\right|$. Since $e^{-i f T_{\\mathrm{I}}} = e^{-i 2\\pi} = 1$, this reduces to $E(\\Delta t) = \\left| z^{N} - 1 \\right|$. For each case (no filter, constant $\\alpha = 0.05$, and quadratic scaling $\\alpha = \\kappa \\Delta t^{2}$ with $\\kappa = \\frac{0.05}{T_{\\mathrm{I}}^{2}}$), we compute $E(\\Delta t)$ for the four $\\Delta t$ values and estimate the observed order $p$ by least-squares fitting of a straight line to the pairs ($\\log(\\Delta t)$, $\\log(E(\\Delta t))$). If $E(\\Delta t) \\approx C\\, \\Delta t^{p}$, then $\\log(E(\\Delta t)) \\approx \\log C + p \\log(\\Delta t)$, so the slope $p$ is the observed order.\n\nThe expected outcomes, grounded in the above analysis, are:\n- Case A ($\\alpha = 0$): $p \\approx 2$ (second order).\n- Case B ($\\alpha = 0.05$): $p \\approx 1$ (first order due to persistent filter asymmetry).\n- Case C ($\\alpha = \\kappa \\Delta t^{2}$): $p \\approx 2$ (second order recovered because the filter perturbation vanishes quadratically with $\\Delta t$).\n\nThe algorithmic implementation follows these steps, and the final program outputs a single line containing three floats corresponding to the observed $p$ values for the three cases, rounded to three decimal places and enclosed in square brackets, as required. All variables with physical units are specified in seconds or inverse seconds, and the outputs are unitless floats.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef inertial_period(f):\n    return 2.0 * np.pi / f\n\ndef exact_solution(f, t):\n    # z(t) = exp(-i f t)\n    return np.exp(-1j * f * t)\n\ndef leapfrog_ra_integrate(f, dt, N, alpha_mode, T_I):\n    \"\"\"\n    Integrate z' = -i f z over N steps of size dt using leapfrog and RA filter.\n    alpha_mode: 'none', 'const', or 'quad'\n    \"\"\"\n    # Determine alpha for this dt\n    if alpha_mode == 'none':\n        alpha = 0.0\n    elif alpha_mode == 'const':\n        alpha = 0.05\n    elif alpha_mode == 'quad':\n        # alpha = k * dt^2, with k = 0.05 / T_I^2 to keep scale comparable\n        alpha = 0.05 * (dt**2) / (T_I**2)\n    else:\n        raise ValueError(\"Unknown alpha_mode\")\n\n    # Initialize with exact values\n    z_prev = exact_solution(f, 0.0)                 # z^0\n    z_curr = exact_solution(f, dt)                  # z^1\n\n    # Time stepping\n    for n in range(1, N):\n        # Leapfrog update to get z^{n+1}\n        z_next = z_prev - 2.0 * dt * 1j * f * z_curr\n        # Apply RA filter to z^n (current)\n        # z^n <- z^n + alpha (z^{n-1} - 2 z^n + z^{n+1})\n        z_curr = z_curr + alpha * (z_prev - 2.0 * z_curr + z_next)\n        # Shift for next iteration: (n+1) becomes current, filtered z^n becomes previous\n        z_prev, z_curr = z_curr, z_next\n\n    # After N steps, z_curr is z^N (unfiltered at final level)\n    return z_curr\n\ndef observed_order(log_dt, log_err):\n    # Fit log(err) = a + p * log(dt); return p\n    # Use least squares linear fit\n    p, a = np.polyfit(log_dt, log_err, 1)\n    return p\n\ndef solve():\n    # Define the test cases from the problem statement.\n    f = 1e-4  # s^-1\n    T_I = inertial_period(f)  # seconds, one inertial period\n\n    # Numbers of steps for dt = T_I / N\n    N_list = [32, 64, 128, 256]\n\n    # Alpha modes to test: Case A, Case B, Case C\n    alpha_modes = ['none', 'const', 'quad']\n\n    results = []\n    for mode in alpha_modes:\n        dt_list = []\n        err_list = []\n        for N in N_list:\n            dt = T_I / N\n            zN = leapfrog_ra_integrate(f, dt, N, mode, T_I)\n            # Exact at T_I is exp(-i f T_I) = exp(-i 2 pi) = 1\n            exact_T = 1.0 + 0.0j\n            err = abs(zN - exact_T)\n            dt_list.append(dt)\n            err_list.append(err)\n\n        # Compute observed order via log-log slope\n        log_dt = np.log(np.array(dt_list))\n        log_err = np.log(np.array(err_list))\n        p = observed_order(log_dt, log_err)\n        results.append(p)\n\n    # Final print statement in the exact required format: three values rounded to three decimals\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}