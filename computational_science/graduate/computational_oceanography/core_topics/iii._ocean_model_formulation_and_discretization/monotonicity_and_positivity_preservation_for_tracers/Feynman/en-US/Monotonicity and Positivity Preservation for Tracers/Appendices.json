{
    "hands_on_practices": [
        {
            "introduction": "To build robust numerical models, we must first understand how to derive stability conditions from first principles. This exercise guides you through the process of creating a positivity-preserving scheme for the combined advection-diffusion equation, a ubiquitous model in oceanography . By ensuring the update can be written as a convex combination, you will derive the composite time-step constraint that guarantees a physically meaningful, non-negative solution.",
            "id": "3802486",
            "problem": "Consider a conservative transport of a passive tracer concentration $C(x,y,t)$ in the ocean mixed layer governed by the two-dimensional advection–diffusion equation without sources or sinks,\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial (u\\,C)}{\\partial x} + \\frac{\\partial (v\\,C)}{\\partial y} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(K_x \\frac{\\partial C}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\!\\left(K_y \\frac{\\partial C}{\\partial y}\\right),\n$$\nwhere $u$ and $v$ are constant horizontal velocities (units $\\mathrm{m}\\,\\mathrm{s}^{-1}$), and $K_x$ and $K_y$ are constant horizontal diffusivities (units $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$). The domain is periodic in both directions and is discretized on a uniform Cartesian grid with spacings $\\Delta x$ and $\\Delta y$. Let $C_{i,j}^n$ denote the cell-averaged concentration in cell $(i,j)$ at time level $t^n$.\n\nConstruct an explicit, single-step, conservative finite-volume update for $C_{i,j}^{n+1}$ using forward Euler in time. At each vertical cell face $(i+\\tfrac{1}{2},j)$, approximate the advective flux with the donor-cell upwind flux splitting $u^{+} C_{i,j}^n + u^{-} C_{i+1,j}^n$, where $u^{+}=\\max(u,0)$ and $u^{-}=\\min(u,0)$, and approximate the diffusive flux with the centered difference $-\\,K_x\\,(C_{i+1,j}^n - C_{i,j}^n)/\\Delta x$. Use the analogous formulas at horizontal faces for the $y$-direction with $v$, $K_y$, and $\\Delta y$.\n\nAssuming nonnegative initial data $C_{i,j}^0 \\ge 0$ for all $(i,j)$ and periodic boundaries, derive a necessary and sufficient condition on the time step $\\Delta t$ such that the scheme preserves nonnegativity, i.e., $C_{i,j}^{n} \\ge 0$ for all $n \\in \\mathbb{N}$ implies $C_{i,j}^{n+1} \\ge 0$ for all $(i,j)$. Your derivation must start from conservation over each control volume and produce a convex-combination form of the update with nonnegative coefficients that sum to $1$.\n\nExpress your final result as a single closed-form analytic expression for the maximum allowable time step $\\Delta t_{\\max}$ in seconds, in terms of $|u|$, $|v|$, $\\Delta x$, $\\Delta y$, $K_x$, and $K_y$. Do not provide an inequality; provide only the explicit expression for $\\Delta t_{\\max}$.",
            "solution": "The governing partial differential equation (PDE) for the transport of the tracer concentration $C$ is\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial (uC)}{\\partial x} + \\frac{\\partial (vC)}{\\partial y} = \\frac{\\partial}{\\partial x}\\left(K_x \\frac{\\partial C}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(K_y \\frac{\\partial C}{\\partial y}\\right)\n$$\nSince the velocities $u$ and $v$ and the diffusivities $K_x$ and $K_y$ are constant, we can rewrite the equation in conservative form:\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(uC - K_x \\frac{\\partial C}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(vC - K_y \\frac{\\partial C}{\\partial y}\\right) = 0\n$$\nThis is of the form $\\frac{\\partial C}{\\partial t} + \\nabla \\cdot \\mathbf{F} = 0$, where the total flux vector is $\\mathbf{F} = (F_x, F_y)$ with component fluxes $F_x = uC - K_x \\frac{\\partial C}{\\partial x}$ and $F_y = vC - K_y \\frac{\\partial C}{\\partial y}$.\n\nWe apply the finite-volume method by integrating the PDE over a control volume $\\Omega_{i,j} = [x_{i-1/2}, x_{i+1/2}] \\times [y_{j-1/2}, y_{j+1/2}]$ of area $\\Delta x \\Delta y$. The cell-averaged concentration is defined as $C_{i,j}(t) = \\frac{1}{\\Delta x \\Delta y} \\iint_{\\Omega_{i,j}} C(x,y,t) \\,dx\\,dy$.\nIntegrating the PDE and applying the divergence theorem yields the exact evolution equation for the cell-averaged concentration:\n$$\n\\frac{d C_{i,j}}{dt} = -\\frac{1}{\\Delta x} \\left( F_{x, i+1/2, j} - F_{x, i-1/2, j} \\right) - \\frac{1}{\\Delta y} \\left( F_{y, i, j+1/2} - F_{y, i, j-1/2} \\right)\n$$\nHere, $F_{x, i+1/2, j}$ is the flux across the right face of the cell, and so on.\n\nWe discretize this equation in time using the forward Euler method, with fluxes evaluated at time level $n$:\n$$\n\\frac{C_{i,j}^{n+1} - C_{i,j}^n}{\\Delta t} = \\frac{1}{\\Delta x} \\left( F_{x, i-1/2, j}^n - F_{x, i+1/2, j}^n \\right) + \\frac{1}{\\Delta y} \\left( F_{y, i, j-1/2}^n - F_{y, i, j+1/2}^n \\right)\n$$\nThe problem specifies the discretization of the total fluxes. The total flux at face $(i+\\tfrac{1}{2}, j)$ is the sum of the advective and diffusive fluxes:\n$$\nF_{x, i+1/2, j}^n = \\left( u^{+}C_{i,j}^n + u^{-}C_{i+1,j}^n \\right) - K_x \\frac{C_{i+1,j}^n - C_{i,j}^n}{\\Delta x}\n$$\nSimilarly, the flux at the left face $(i-\\tfrac{1}{2}, j)$ is:\n$$\nF_{x, i-1/2, j}^n = \\left( u^{+}C_{i-1,j}^n + u^{-}C_{i,j}^n \\right) - K_x \\frac{C_{i,j}^n - C_{i-1,j}^n}{\\Delta x}\n$$\nThe fluxes in the $y$-direction are analogous:\n$$\nF_{y, i, j+1/2}^n = \\left( v^{+}C_{i,j}^n + v^{-}C_{i,j+1}^n \\right) - K_y \\frac{C_{i,j+1}^n - C_{i,j}^n}{\\Delta y}\n$$\n$$\nF_{y, i, j-1/2}^n = \\left( v^{+}C_{i,j-1}^n + v^{-}C_{i,j}^n \\right) - K_y \\frac{C_{i,j}^n - C_{i,j-1}^n}{\\Delta y}\n$$\nNow, we substitute these discrete fluxes into the time-marching equation:\n$$\nC_{i,j}^{n+1} = C_{i,j}^n + \\frac{\\Delta t}{\\Delta x} \\left( F_{x, i-1/2, j}^n - F_{x, i+1/2, j}^n \\right) + \\frac{\\Delta t}{\\Delta y} \\left( F_{y, i, j-1/2}^n - F_{y, i, j+1/2}^n \\right)\n$$\nLet's compute the net flux term for the $x$-direction:\n$$\nF_{x, i-1/2, j}^n - F_{x, i+1/2, j}^n = \\left[ u^{+}C_{i-1,j}^n + u^{-}C_{i,j}^n - K_x \\frac{C_{i,j}^n - C_{i-1,j}^n}{\\Delta x} \\right] - \\left[ u^{+}C_{i,j}^n + u^{-}C_{i+1,j}^n - K_x \\frac{C_{i+1,j}^n - C_{i,j}^n}{\\Delta x} \\right]\n$$\nGrouping terms by cell index:\n$$\n= C_{i-1,j}^n \\left( u^{+} + \\frac{K_x}{\\Delta x} \\right) + C_{i+1,j}^n \\left( -u^{-} + \\frac{K_x}{\\Delta x} \\right) + C_{i,j}^n \\left( u^{-} - u^{+} - \\frac{2K_x}{\\Delta x} \\right)\n$$\nUsing the identities $u=u^++u^-$ and $|u|=u^+-u^-$, we have $u^--u^+ = -|u|$. The net $x$-flux becomes:\n$$\n= C_{i-1,j}^n \\left( u^{+} + \\frac{K_x}{\\Delta x} \\right) + C_{i+1,j}^n \\left( -u^{-} + \\frac{K_x}{\\Delta x} \\right) - C_{i,j}^n \\left( |u| + \\frac{2K_x}{\\Delta x} \\right)\n$$\nThe net $y$-flux is analogous:\n$$\nF_{y, i, j-1/2}^n - F_{y, i, j+1/2}^n = C_{i,j-1}^n \\left( v^{+} + \\frac{K_y}{\\Delta y} \\right) + C_{i,j+1}^n \\left( -v^{-} + \\frac{K_y}{\\Delta y} \\right) - C_{i,j}^n \\left( |v| + \\frac{2K_y}{\\Delta y} \\right)\n$$\nSubstituting these into the update equation for $C_{i,j}^{n+1}$:\n$$\nC_{i,j}^{n+1} = C_{i,j}^n + \\frac{\\Delta t}{\\Delta x} \\left[ C_{i-1,j}^n \\left( u^{+} + \\frac{K_x}{\\Delta x} \\right) + C_{i+1,j}^n \\left( -u^{-} + \\frac{K_x}{\\Delta x} \\right) - C_{i,j}^n \\left( |u| + \\frac{2K_x}{\\Delta x} \\right) \\right] + \\frac{\\Delta t}{\\Delta y} \\left[ C_{i,j-1}^n \\left( v^{+} + \\frac{K_y}{\\Delta y} \\right) + C_{i,j+1}^n \\left( -v^- + \\frac{K_y}{\\Delta y} \\right) - C_{i,j}^n \\left( |v| + \\frac{2K_y}{\\Delta y} \\right) \\right]\n$$\nTo obtain the convex-combination form $C_{i,j}^{n+1} = \\sum \\alpha C^n$, we collect coefficients for each stencil point:\n$$\nC_{i,j}^{n+1} = \\alpha_{0,0} C_{i,j}^n + \\alpha_{1,0} C_{i+1,j}^n + \\alpha_{-1,0} C_{i-1,j}^n + \\alpha_{0,1} C_{i,j+1}^n + \\alpha_{0,-1} C_{i,j-1}^n\n$$\nThe coefficients are:\n$\\alpha_{1,0} = \\frac{\\Delta t}{\\Delta x} \\left( -u^{-} + \\frac{K_x}{\\Delta x} \\right)$\n$\\alpha_{-1,0} = \\frac{\\Delta t}{\\Delta x} \\left( u^{+} + \\frac{K_x}{\\Delta x} \\right)$\n$\\alpha_{0,1} = \\frac{\\Delta t}{\\Delta y} \\left( -v^{-} + \\frac{K_y}{\\Delta y} \\right)$\n$\\alpha_{0,-1} = \\frac{\\Delta t}{\\Delta y} \\left( v^{+} + \\frac{K_y}{\\Delta y} \\right)$\n$\\alpha_{0,0} = 1 - \\frac{\\Delta t}{\\Delta x} \\left( |u| + \\frac{2K_x}{\\Delta x} \\right) - \\frac{\\Delta t}{\\Delta y} \\left( |v| + \\frac{2K_y}{\\Delta y} \\right)$\n$\\alpha_{0,0} = 1 - \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{2K_x}{\\Delta x^2} + \\frac{|v|}{\\Delta y} + \\frac{2K_y}{\\Delta y^2} \\right)$\n\nFor the scheme to be a convex combination, the coefficients must be non-negative and sum to $1$. Let's first check the sum:\n$\\sum \\alpha = \\alpha_{0,0} + \\alpha_{1,0} + \\alpha_{-1,0} + \\alpha_{0,1} + \\alpha_{0,-1}$\n$= 1 - \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{2K_x}{\\Delta x^2} + \\frac{|v|}{\\Delta y} + \\frac{2K_y}{\\Delta y^2} \\right) + \\frac{\\Delta t}{\\Delta x} \\left( u^{+}-u^{-} + \\frac{2K_x}{\\Delta x} \\right) + \\frac{\\Delta t}{\\Delta y} \\left( v^{+}-v^{-} + \\frac{2K_y}{\\Delta y} \\right)$\nUsing $|u|=u^+-u^-$ and $|v|=v^+-v^-$:\n$= 1 - \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{2K_x}{\\Delta x^2} + \\frac{|v|}{\\Delta y} + \\frac{2K_y}{\\Delta y^2} \\right) + \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{2K_x}{\\Delta x^2} \\right) + \\Delta t \\left( \\frac{|v|}{\\Delta y} + \\frac{2K_y}{\\Delta y^2} \\right) = 1$\nThe sum of coefficients is $1$, so the scheme is conservative.\n\nNext, we enforce non-negativity for each coefficient.\n- Since $\\Delta t > 0$, $\\Delta x > 0$, $K_x \\ge 0$, $u^{+} \\ge 0$, and $-u^{-} \\ge 0$, the coefficients $\\alpha_{1,0}$ and $\\alpha_{-1,0}$ are always non-negative.\n- Similarly, $\\alpha_{0,1}$ and $\\alpha_{0,-1}$ are always non-negative.\n- The condition for non-negativity preservation thus depends entirely on the central coefficient, $\\alpha_{0,0}$. We must have $\\alpha_{0,0} \\ge 0$.\n$$\n1 - \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{2K_x}{\\Delta x^2} + \\frac{|v|}{\\Delta y} + \\frac{2K_y}{\\Delta y^2} \\right) \\ge 0\n$$\nSolving for $\\Delta t$:\n$$\n\\Delta t \\le \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{2K_x}{\\Delta x^2} + \\frac{2K_y}{\\Delta y^2}}\n$$\nThis condition is necessary and sufficient. If it holds, all coefficients are non-negative and sum to $1$. Given $C_{i,j}^n \\ge 0$ for all $(i,j)$, the update $C_{i,j}^{n+1}$ is a weighted sum of non-negative values with non-negative weights, and is therefore also non-negative. If the condition is violated, $\\alpha_{0,0}  0$, and one can construct initial data (e.g., $C_{i,j}^n=1$, all others $0$) that yields $C_{i,j}^{n+1} = \\alpha_{0,0}  0$.\n\nThe maximum allowable time step, $\\Delta t_{\\max}$, is the largest value of $\\Delta t$ that satisfies this inequality.\n$$\n\\Delta t_{\\max} = \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{2K_x}{\\Delta x^2} + \\frac{2K_y}{\\Delta y^2}}\n$$\nThis can be written in a more compact form.",
            "answer": "$$\n\\boxed{\\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{2K_x}{\\Delta x^2} + \\frac{2K_y}{\\Delta y^2} \\right)^{-1}}\n$$"
        },
        {
            "introduction": "Theoretical stability analysis must be validated with practical implementation. This coding exercise challenges you to compare the positivity-preserving capabilities of a Strong Stability Preserving (SSP) Runge-Kutta scheme against a standard non-SSP alternative for a classic linear advection problem . Through this experiment, you will gain crucial insights into why SSP methods are a cornerstone of modern tracer transport models, especially when pushing Courant numbers towards the stability limit.",
            "id": "3802482",
            "problem": "Consider one-dimensional passive tracer advection in a periodic domain where the tracer concentration satisfies the linear advection equation $ \\partial_t c(x,t) + u \\, \\partial_x c(x,t) = 0 $, with constant velocity $ u  0 $. Assume a uniform grid with $ N $ cells over domain length $ L $ in meters, grid spacing $ \\Delta x = L/N $, and periodic boundary conditions. The initial condition is a step function $ c(x,0) = 1 $ for $ x  x_0 $ and $ c(x,0) = 0 $ for $ x \\ge x_0 $, where $ x_0 \\in [0,L) $. Treat $ c $ as dimensionless and $ u $ in meters per second. The simulation end time is one advective period $ T = L/u $ in seconds.\n\nSpatial discretization is first-order upwind finite volume for $ u  0 $, with the semi-discrete operator $ \\mathcal{L}(c)_i = -\\frac{u}{\\Delta x} \\left( c_i - c_{i-1} \\right) $ under periodic indexing. Time stepping uses a fixed time step $ \\Delta t $ chosen from a specified Courant number $ \\nu = \\frac{u \\Delta t}{\\Delta x} $ (dimensionless). You must compare the positivity performance of two explicit Runge–Kutta schemes under identical Courant numbers $ \\nu $:\n- Strong Stability Preserving (SSP) Runge–Kutta of order two with two stages, denoted $ \\mathrm{SSPRK}(2,2) $:\n  1. $ c^{(1)} = c^n + \\Delta t \\, \\mathcal{L}(c^n) $\n  2. $ c^{n+1} = \\frac{1}{2} c^n + \\frac{1}{2} \\left( c^{(1)} + \\Delta t \\, \\mathcal{L}(c^{(1)}) \\right) $\n- A non-Strong Stability Preserving (non-SSP) explicit midpoint Runge–Kutta scheme:\n  1. $ c^{(1)} = c^n + \\frac{\\Delta t}{2} \\, \\mathcal{L}(c^n) $\n  2. $ c^{n+1} = c^n + \\Delta t \\, \\mathcal{L}(c^{(1)}) $\n\nDefine positivity preservation as the condition that $ c_i^n \\ge 0 $ for all grid indices $ i $ and all time levels $ n $ throughout the simulation. Use a numerical tolerance where values $ c_i^n \\ge -10^{-12} $ are considered nonnegative to account for floating-point roundoff. At each time step and for each stage, enforce periodic boundary conditions consistently in $ \\mathcal{L}(c) $ via cyclic indexing.\n\nImplement both schemes for the same set of parameters, and for each specified Courant number $ \\nu $, determine whether positivity is preserved for the entire simulation by each scheme. Report results as booleans.\n\nAll physical quantities must be expressed in meters and seconds as specified, but the outputs are dimensionless booleans. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $ [\\text{SSPRK case 1}, \\text{non-SSP case 1}, \\text{SSPRK case 2}, \\text{non-SSP case 2}, \\dots] $.\n\nUse the following test suite of parameter values to exercise different regimes:\n- Test case $ 1 $ (happy path, small time step): $ L = 1 $ meter, $ u = 1 $ meter per second, $ N = 200 $, $ x_0 = L/3 $, $ \\nu = 0.2 $.\n- Test case $ 2 $ (near-stability limit but below): $ L = 1 $ meter, $ u = 1 $ meter per second, $ N = 200 $, $ x_0 = L/3 $, $ \\nu = 0.9 $.\n- Test case $ 3 $ (boundary condition at the stability threshold): $ L = 1 $ meter, $ u = 1 $ meter per second, $ N = 200 $, $ x_0 = L/3 $, $ \\nu = 1.0 $.\n- Test case $ 4 $ (beyond stability limit): $ L = 1 $ meter, $ u = 1 $ meter per second, $ N = 200 $, $ x_0 = L/3 $, $ \\nu = 1.1 $.\n\nFor each test case, integrate to $ T = L/u $ seconds using $ \\Delta t = \\nu \\, \\Delta x / u $. If $ T/\\Delta t $ is not an integer, perform $ \\lfloor T/\\Delta t \\rfloor $ full steps of size $ \\Delta t $ and one final step of size $ T - \\lfloor T/\\Delta t \\rfloor \\Delta t $, using the same formulas as above but with the shortened last step to reach $ T $ exactly.\n\nYour program should produce a single line of output containing the eight booleans in the order described, as a comma-separated list enclosed in square brackets, for example $ [\\text{True},\\text{False},\\dots] $.",
            "solution": "The core of the problem is to compare the positivity-preserving characteristics of two second-order explicit Runge-Kutta schemes for the linear advection equation, $ \\partial_t c + u \\, \\partial_x c = 0 $, discretized in space with a first-order upwind finite volume method. The semi-discrete form for the average concentration $c_i$ in cell $i$ is given by:\n$$\n\\frac{d c_i}{dt} = \\mathcal{L}(c)_i = -\\frac{u}{\\Delta x} \\left( c_i - c_{i-1} \\right)\n$$\nwhere $u > 0$ is the constant velocity, $\\Delta x$ is the uniform grid spacing, and periodic boundary conditions are assumed.\n\nA numerical scheme is positivity-preserving if, given an initial state with non-negative values ($c_i^n \\ge 0$ for all $i$), the state at the next time level also has non-negative values ($c_i^{n+1} \\ge 0$). We analyze this property for the given schemes.\n\nFirst, consider the simplest explicit time-stepping scheme, Forward Euler (FE):\n$$\nc_i^{n+1} = c_i^n + \\Delta t \\, \\mathcal{L}(c_i^n)\n$$\nSubstituting the discrete operator $\\mathcal{L}(c)_i$:\n$$\nc_i^{n+1} = c_i^n + \\Delta t \\left( -\\frac{u}{\\Delta x} (c_i^n - c_{i-1}^n) \\right)\n$$\nDefining the Courant number $\\nu = \\frac{u \\Delta t}{\\Delta x}$, the equation becomes:\n$$\nc_i^{n+1} = c_i^n - \\nu (c_i^n - c_{i-1}^n) = (1 - \\nu) c_i^n + \\nu c_{i-1}^n\n$$\nFor $c_i^{n+1}$ to be non-negative, assuming $c_i^n \\ge 0$ and $c_{i-1}^n \\ge 0$, the coefficients of these terms must be non-negative. Since $u, \\Delta t, \\Delta x$ are positive, $\\nu \\ge 0$. The remaining condition is $1 - \\nu \\ge 0$, which implies $\\nu \\le 1$. Thus, the first-order upwind scheme combined with Forward Euler time-stepping is positivity-preserving if and only if the Courant-Friedrichs-Lewy (CFL) condition $\\nu \\le 1$ is satisfied.\n\nNext, we analyze the Strong Stability Preserving (SSP) Runge-Kutta scheme, SSPRK(2,2). SSP schemes are specifically designed to preserve stability properties (like positivity or monotonicity) of the underlying FE step. An explicit SSP scheme can be expressed as a convex combination of FE-like steps. The SSPRK(2,2) scheme is:\n1. $c^{(1)} = c^n + \\Delta t \\, \\mathcal{L}(c^n)$\n2. $c^{n+1} = \\frac{1}{2} c^n + \\frac{1}{2} \\left( c^{(1)} + \\Delta t \\, \\mathcal{L}(c^{(1)}) \\right)$\n\nThe first stage, $c^{(1)}$, is a simple FE step. If $\\nu \\le 1$ and $c^n \\ge 0$, then $c^{(1)} \\ge 0$. The term inside the parenthesis in the second stage, $c^{(1)} + \\Delta t \\, \\mathcal{L}(c^{(1)})$, is another FE step, this time applied to $c^{(1)}$. If $c^{(1)} \\ge 0$ and $\\nu \\le 1$, this term will also be non-negative. The final update for $c^{n+1}$ is a convex combination (coefficients $\\frac{1}{2}, \\frac{1}{2}$) of non-negative quantities ($c^n$ and the result from the second stage). Therefore, $c^{n+1}$ is guaranteed to be non-negative provided the FE step is positivity-preserving, i.e., for $\\nu \\le 1$.\n\nFinally, we analyze the non-SSP explicit midpoint Runge-Kutta scheme:\n1. $c^{(1)} = c^n + \\frac{\\Delta t}{2} \\, \\mathcal{L}(c^n)$\n2. $c^{n+1} = c^n + \\Delta t \\, \\mathcal{L}(c^{(1)})$\n\nThe first stage is an FE step with time step $\\Delta t/2$, corresponding to a Courant number of $\\nu/2$. This stage preserves positivity if $\\nu/2 \\le 1$, or $\\nu \\le 2$. To determine the positivity of the full step, we express $c^{n+1}$ directly in terms of $c^n$.\nSubstituting $\\mathcal{L}(c)_i$ into the second stage:\n$$\nc_i^{n+1} = c_i^n - \\nu \\left( c_i^{(1)} - c_{i-1}^{(1)} \\right)\n$$\nAnd substituting the expression for $c^{(1)}$:\n$$\nc_i^{(1)} = c_i^n - \\frac{\\nu}{2}(c_i^n - c_{i-1}^n) = \\left(1-\\frac{\\nu}{2}\\right)c_i^n + \\frac{\\nu}{2}c_{i-1}^n\n$$\nPlugging this into the update for $c^{n+1}$:\n$$\nc_i^{n+1} = c_i^n - \\nu \\left[ \\left(\\left(1-\\frac{\\nu}{2}\\right)c_i^n + \\frac{\\nu}{2}c_{i-1}^n\\right) - \\left(\\left(1-\\frac{\\nu}{2}\\right)c_{i-1}^n + \\frac{\\nu}{2}c_{i-2}^n\\right) \\right]\n$$\nGrouping terms by cell index:\n$$\nc_i^{n+1} = \\left(1 - \\nu\\left(1-\\frac{\\nu}{2}\\right)\\right)c_i^n + \\left(-\\nu\\frac{\\nu}{2} + \\nu\\left(1-\\frac{\\nu}{2}\\right)\\right)c_{i-1}^n + \\left(\\nu\\frac{\\nu}{2}\\right)c_{i-2}^n\n$$\n$$\nc_i^{n+1} = \\left(1 - \\nu + \\frac{\\nu^2}{2}\\right) c_i^n + \\left(\\nu - \\nu^2\\right) c_{i-1}^n + \\left(\\frac{\\nu^2}{2}\\right) c_{i-2}^n\n$$\nFor positivity, all three coefficients must be non-negative:\n1. Coefficient of $c_i^n$: $1 - \\nu + \\frac{\\nu^2}{2}$. The quadratic $x^2 - 2x + 2$ has no real roots and opens upwards, so this term is always positive for any real $\\nu$.\n2. Coefficient of $c_{i-1}^n$: $\\nu - \\nu^2 = \\nu(1-\\nu)$. Since $\\nu > 0$, this requires $1-\\nu \\ge 0$, or $\\nu \\le 1$.\n3. Coefficient of $c_{i-2}^n$: $\\frac{\\nu^2}{2}$. This is always non-negative.\n\nThe analysis reveals that for this specific linear problem, the non-SSP midpoint scheme is also positivity-preserving under the same condition as the FE and SSPRK(2,2) schemes: $\\nu \\le 1$. The \"non-SSP\" designation is a general one, indicating that the scheme does not universally preserve properties like positivity for all (e.g., nonlinear) problems for which FE does. However, for the 1D linear advection equation with first-order upwinding, it coincidentally shares the same positivity bound.\n\nTherefore, the theoretical prediction is that both schemes will preserve positivity for test cases with $\\nu = 0.2, 0.9, 1.0$ and will fail to preserve positivity for $\\nu = 1.1$.\n\nThe implementation will follow this analysis. A function for each time-stepping scheme will be created. A main loop iterates through the test cases, running each for a full advective period $T = L/u$. The number of time steps is determined by $\\Delta t = \\nu \\Delta x/u$. The specific instruction to handle a non-integer number of steps by performing $\\lfloor T/\\Delta t \\rfloor$ full steps and one final smaller step is followed precisely. At each step and substage, positivity is checked against a tolerance of $-10^{-12}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D advection problem for multiple test cases and schemes,\n    checking for positivity preservation.\n    \"\"\"\n    # Test cases as specified in the problem statement.\n    # Format: (L, u, N, x0_fraction, nu)\n    test_cases = [\n        (1.0, 1.0, 200, 1.0/3.0, 0.2),\n        (1.0, 1.0, 200, 1.0/3.0, 0.9),\n        (1.0, 1.0, 200, 1.0/3.0, 1.0),\n        (1.0, 1.0, 200, 1.0/3.0, 1.1),\n    ]\n\n    results = []\n    \n    for L, u, N, x0_fraction, nu in test_cases:\n        # Run simulation for SSPRK(2,2)\n        ssp_positivity = run_simulation(L, u, N, x0_fraction, nu, 'ssp')\n        results.append(ssp_positivity)\n        \n        # Run simulation for non-SSP midpoint RK\n        nonssp_positivity = run_simulation(L, u, N, x0_fraction, nu, 'non-ssp')\n        results.append(nonssp_positivity)\n\n    # Format the final output string exactly as required.\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef run_simulation(L, u, N, x0_fraction, nu, scheme_type):\n    \"\"\"\n    Runs a single simulation for a given set of parameters and scheme type.\n\n    Args:\n        L (float): Domain length.\n        u (float): Advection velocity.\n        N (int): Number of grid cells.\n        x0_fraction (float): Position of the initial step as a fraction of L.\n        nu (float): Courant number.\n        scheme_type (str): 'ssp' or 'non-ssp'.\n\n    Returns:\n        bool: True if positivity is preserved, False otherwise.\n    \"\"\"\n    dx = L / N\n    T = L / u\n    dt = nu * dx / u\n    x0 = L * x0_fraction\n    negativity_tolerance = -1.0e-12\n\n    # Define cell-centered grid and initial condition\n    x = (np.arange(N) + 0.5) * dx\n    c = np.where(x  x0, 1.0, 0.0)\n\n    # Spatial operator L(c) = -u/dx * (c_i - c_{i-1}) with periodic boundaries\n    def op(c_state):\n        c_prev = np.roll(c_state, 1)\n        return -(u / dx) * (c_state - c_prev)\n\n    # Define the time-stepping functions\n    def step_ssp(c_n, current_dt):\n        if np.any(c_n  negativity_tolerance): return c_n, False\n        # Stage 1\n        c1 = c_n + current_dt * op(c_n)\n        if np.any(c1  negativity_tolerance): return c1, False\n        # Stage 2\n        c_next = 0.5 * c_n + 0.5 * (c1 + current_dt * op(c1))\n        return c_next, np.all(c_next = negativity_tolerance)\n\n    def step_nonssp(c_n, current_dt):\n        if np.any(c_n  negativity_tolerance): return c_n, False\n        # Stage 1\n        c1 = c_n + 0.5 * current_dt * op(c_n)\n        if np.any(c1  negativity_tolerance): return c1, False\n        # Stage 2\n        c_next = c_n + current_dt * op(c1)\n        return c_next, np.all(c_next = negativity_tolerance)\n\n    stepper = step_ssp if scheme_type == 'ssp' else step_nonssp\n    \n    # Handle cases where dt or T might be zero to avoid division by zero\n    if abs(T)  1e-14 or abs(dt)  1e-14:\n        return True\n\n    # Determine number of full and final time steps\n    num_steps_float = T / dt\n    # Check if T/dt is very close to an integer to handle floating point inaccuracies\n    if np.isclose(num_steps_float, np.round(num_steps_float)):\n        num_full_steps = int(np.round(num_steps_float))\n        dt_final = 0.0\n    else:\n        num_full_steps = int(np.floor(num_steps_float))\n        dt_final = T - num_full_steps * dt\n\n    # Time integration loop for full steps\n    for _ in range(num_full_steps):\n        c, is_positive = stepper(c, dt)\n        if not is_positive:\n            return False\n\n    # Final, potentially smaller, time step\n    if dt_final  1e-15:  # Use a small tolerance to see if a final step is needed\n        c, is_positive = stepper(c, dt_final)\n        if not is_positive:\n            return False\n            \n    return True\n\nsolve()\n```"
        },
        {
            "introduction": "Real-world ocean models often couple fluid dynamics with non-linear biogeochemical reactions. This advanced practice introduces an operator-split approach for a coupled nitrate-phytoplankton system, forcing you to confront new challenges to positivity preservation that arise from the reaction terms themselves . You will diagnose how an explicit time step for biological uptake can lead to unphysical negative concentrations, a critical consideration in the design of stable ecosystem models.",
            "id": "3802464",
            "problem": "Consider two biogeochemical tracers in a one-dimensional periodic ocean column: nitrate and phytoplankton, with concentrations denoted by $N(x,t)$ and $P(x,t)$, respectively, measured in millimoles of nitrogen per cubic meter ($\\mathrm{mmol\\,N\\,m^{-3}}$). The tracers evolve under linear advection with a constant, positive velocity $u$ (meters per second), and local uptake/reaction with stoichiometric yield. The governing conservation laws are the tracer conservation equations with source terms:\n$$\n\\frac{\\partial N}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u N\\right) = -U(N,P), \\qquad\n\\frac{\\partial P}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u P\\right) = Y\\,U(N,P) - m\\,P,\n$$\nwhere $U(N,P)$ is an uptake rate, $Y \\in (0,1]$ is a dimensionless yield (phytoplankton nitrogen produced per unit nitrate consumed), and $m \\ge 0$ is a linear mortality rate (per second). The uptake is given by the well-tested Michaelis–Menten form:\n$$\nU(N,P) = \\mu \\,\\frac{N\\,P}{K + N},\n$$\nwith $\\mu$ the maximum specific uptake rate (per second) and $K>0$ a half-saturation constant (in $\\mathrm{mmol\\,N\\,m^{-3}}$).\n\nYou will implement one operator-split time step, composed of an advection substep followed by a reaction substep, on a uniform periodic grid with spacing $\\Delta x$ (meters) and a constant time step $\\Delta t$ (seconds). For advection, use the first-order upwind scheme appropriate for $u0$:\n$$\nC_i^{*} = C_i^{n} - \\lambda \\left(C_i^{n} - C_{i-1}^{n}\\right), \\quad \\lambda = \\frac{u\\,\\Delta t}{\\Delta x},\n$$\napplied separately to $C=N$ and $C=P$, where periodic indexing is used for $i-1$. For the reaction substep, use explicit forward Euler applied pointwise:\n$$\nU_i^{*} = \\mu\\,\\frac{N_i^{*}\\,P_i^{*}}{K + N_i^{*}}, \\quad\nN_i^{n+1} = N_i^{*} - \\Delta t\\,U_i^{*}, \\quad\nP_i^{n+1} = P_i^{*} + Y\\,\\Delta t\\,U_i^{*} - m\\,\\Delta t\\,P_i^{*}.\n$$\n\nDefine the following numerical properties to test after this one time step:\n\n- Positivity preservation: $N_i^{n+1} \\ge 0$ and $P_i^{n+1} \\ge 0$ for all grid indices $i$.\n- Monotonicity after advection: for each tracer $C\\in\\{N,P\\}$, the post-advection values $C_i^{*}$ satisfy $C_i^{*}\\in\\left[\\min_j C_j^{n},\\,\\max_j C_j^{n}\\right]$ for all $i$.\n- Stoichiometric upper bound under uptake: for all indices $i$, the post-reaction phytoplankton satisfies $P_i^{n+1} \\le P_i^{*} + Y\\,N_i^{*}$, which encodes that explicit uptake cannot produce more phytoplankton nitrogen than is available nitrate in the same cell during that time step when yield is $Y$.\n\nImplement the above on a domain with $N_x$ uniform cells, total length $L = N_x \\,\\Delta x$, and periodic boundary conditions. Initialize the tracer fields at time $t^n$ with spatially varying, smooth profiles:\n$$\nN_i^{n} = 2.0 + 1.5 \\sin\\left( \\frac{2\\pi x_i}{L} \\right), \\qquad\nP_i^{n} = 0.8 + 0.7 \\cos\\left( \\frac{2\\pi x_i}{L} \\right),\n$$\nwhere $x_i = i\\,\\Delta x$ for $i=0,1,\\dots,N_x-1$. These initial conditions are in $\\mathrm{mmol\\,N\\,m^{-3}}$.\n\nYour program must implement the one-step update and evaluate the three properties above for each of the following test cases (all angles are in radians, all distances in meters, all times in seconds, all concentrations in $\\mathrm{mmol\\,N\\,m^{-3}}$):\n\n- Test Case 1 (happy path, moderate uptake, moderate Courant number): $N_x=128$, $\\Delta x=1000$, $u=0.5$, $\\Delta t=1200$, $\\mu=0.005$, $K=0.5$, $Y=0.8$, $m=0.0$.\n- Test Case 2 (boundary Courant number $\\lambda=1$, unit yield): $N_x=128$, $\\Delta x=1000$, $u=1.0$, $\\Delta t=1000$, $\\mu=0.02$, $K=0.5$, $Y=1.0$, $m=0.0$.\n- Test Case 3 (strong uptake leading to potential violation): $N_x=128$, $\\Delta x=1000$, $u=0.2$, $\\Delta t=4000$, $\\mu=2.0$, $K=0.2$, $Y=0.9$, $m=0.0$.\n- Test Case 4 (mortality-dominated decay edge case): $N_x=128$, $\\Delta x=1000$, $u=0.2$, $\\Delta t=4000$, $\\mu=0.0$, $K=0.5$, $Y=0.8$, $m=0.001$.\n\nFor each test case, compute the three booleans: positivity preserved, stoichiometric upper bound preserved, monotonicity after advection preserved. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each element itself a list of three booleans in the order described above, for the four test cases. For example, the output format must be exactly like:\n$[ [b_{11},b_{12},b_{13}], [b_{21},b_{22},b_{23}], [b_{31},b_{32},b_{33}], [b_{41},b_{42},b_{43}] ]$,\nwhere each $b_{ij}$ is either $\\mathrm{True}$ or $\\mathrm{False}$.",
            "solution": "The governing equations embody tracer conservation with source terms:\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u C\\right) = S_C, \\quad C\\in\\{N,P\\},\n$$\nwith $S_N = -U(N,P)$ and $S_P = Y U(N,P) - mP$. The uptake $U(N,P) = \\mu \\,\\frac{N\\,P}{K+N}$ is monotone increasing with respect to both $N$ and $P$ and nonnegative when $N\\ge 0$ and $P\\ge 0$. The discretization adopts a first-order upwind scheme for advection and explicit forward Euler for reactions. The operator splitting sequence is advection first, followed by reactions, leveraging the recognizably robust practice in ocean tracer modeling.\n\nFor advection, the one-dimensional upwind update for $u>0$ on a uniform grid is:\n$$\nC_i^{*} = C_i^{n} - \\lambda \\left(C_i^{n} - C_{i-1}^{n}\\right),\n$$\nwith the Courant number $\\lambda = \\frac{u\\Delta t}{\\Delta x}$. This formula can be written as a convex combination:\n$$\nC_i^{*} = (1-\\lambda) C_i^{n} + \\lambda C_{i-1}^{n}.\n$$\nWhen $0 \\le \\lambda \\le 1$, this convex combination implies two key properties:\n\n- Positivity preservation under advection: If $C_i^{n}\\ge 0$ for all $i$, then $C_i^{*}\\ge 0$ for all $i$ because a nonnegative convex combination of nonnegative numbers is nonnegative.\n- Monotonicity, specifically no creation of new extrema: Each $C_i^{*}$ lies within the interval spanned by $C_i^{n}$ and $C_{i-1}^{n}$; hence $C_i^{*}\\in\\left[\\min(C_i^{n},C_{i-1}^{n}),\\,\\max(C_i^{n},C_{i-1}^{n})\\right]$. Consequently, the global minimum cannot decrease and the global maximum cannot increase, i.e., $C_i^{*}\\in\\left[\\min_j C_j^{n},\\,\\max_j C_j^{n}\\right]$ for all $i$.\n\nThese properties arise from the linearity and the convexity structure of the first-order upwind discretization of the linear advection operator with constant velocity.\n\nFor the reaction step, the explicit forward Euler update applies pointwise after advection:\n$$\nU_i^{*} = \\mu\\,\\frac{N_i^{*}\\,P_i^{*}}{K + N_i^{*}}, \\quad\nN_i^{n+1} = N_i^{*} - \\Delta t\\,U_i^{*}, \\quad\nP_i^{n+1} = P_i^{*} + Y\\,\\Delta t\\,U_i^{*} - m\\,\\Delta t\\,P_i^{*}.\n$$\nTwo crucial properties are examined:\n\n- Positivity preservation: From the update, $N_i^{n+1}\\ge 0$ requires $\\Delta t\\,U_i^{*} \\le N_i^{*}$, equivalently $\\Delta t \\,\\mu \\,\\frac{N_i^{*}\\,P_i^{*}}{K + N_i^{*}} \\le N_i^{*}$, which simplifies to $\\Delta t \\,\\mu \\,\\frac{P_i^{*}}{K + N_i^{*}} \\le 1$. For phytoplankton, $P_i^{n+1}\\ge 0$ requires $P_i^{*} + Y\\,\\Delta t\\,U_i^{*} - m\\,\\Delta t\\,P_i^{*} \\ge 0$. In the mortality-dominated scenario ($U_i^{*}=0$), this reduces to $1 - m\\,\\Delta t \\ge 0$. Under strong uptake, explicit Euler can violate these inequalities if $\\Delta t$ is too large, driving $N_i^{n+1}$ negative and possibly $P_i^{n+1}$ negative when $m\\,\\Delta t > 1$ or when numerical overshoot combines with decay.\n\n- Stoichiometric upper bound under uptake: Because uptake consumes nitrate and produces phytoplankton at yield $Y$, a physically meaningful bound over a single explicit Euler step is\n$$\nP_i^{n+1} \\le P_i^{*} + Y\\,N_i^{*}.\n$$\nThis bound enforces that phytoplankton nitrogen production cannot exceed the available nitrate nitrogen in the same cell and time step when the yield is $Y$. From the explicit Euler formula, this inequality holds whenever $\\Delta t\\,U_i^{*} \\le N_i^{*}$ (the same condition that prevents nitrate from becoming negative). If explicit Euler drives $\\Delta t\\,U_i^{*} > N_i^{*}$, then both nitrate positivity and the stoichiometric upper bound can be violated under strong uptake, signaling that the time step is too large or that the reaction integration needs a positivity-preserving modification.\n\nThe algorithmic steps are:\n\n- Initialize $N_i^{n}$ and $P_i^{n}$ with smooth spatial profiles that ensure positivity and nontrivial gradients.\n- Compute the advection step via first-order upwind with periodic boundary conditions for both $N$ and $P$, obtaining $N_i^{*}$ and $P_i^{*}$.\n- Check monotonicity after advection by verifying $N_i^{*},P_i^{*}\\in[\\min_j C_j^{n},\\max_j C_j^{n}]$ for each tracer $C$ across all indices.\n- Compute the uptake $U_i^{*}$ and apply the explicit Euler reaction update to obtain $N_i^{n+1}$ and $P_i^{n+1}$.\n- Check positivity ($N_i^{n+1}\\ge 0$, $P_i^{n+1}\\ge 0$ for all $i$) and the stoichiometric upper bound ($P_i^{n+1} \\le P_i^{*} + Y\\,N_i^{*}$ for all $i$).\n\nApplying these steps to the specified test suite:\n\n- Test Case $1$ has $\\lambda = \\frac{0.5 \\times 1200}{1000} = 0.6 \\in [0,1]$; advection is monotone and positivity-preserving. Uptake is moderate ($\\mu = 0.005$), and $\\Delta t$ is modest, so $\\Delta t\\,U_i^{*} \\ll N_i^{*}$ across the domain. We expect positivity and the upper bound to be preserved.\n- Test Case $2$ has $\\lambda = \\frac{1.0 \\times 1000}{1000} = 1$; advection remains monotone and positivity-preserving at the boundary Courant number. With $\\mu = 0.02$ and $\\Delta t = 1000$, the uptake still yields $\\Delta t\\,U_i^{*} \\lesssim N_i^{*}$ for the given initial fields, preserving positivity and the upper bound.\n- Test Case $3$ has $\\lambda = \\frac{0.2 \\times 4000}{1000} = 0.8 \\in [0,1]$, so advection monotonicity holds. However, strong uptake ($\\mu = 2.0$) with large $\\Delta t = 4000$ produces $\\Delta t\\,U_i^{*} \\gg N_i^{*}$ in portions of the domain, driving $N_i^{n+1}0$ and violating $P_i^{n+1} \\le P_i^{*} + Y\\,N_i^{*}$ due to excessive explicit consumption. Positivity and the upper bound fail.\n- Test Case $4$ has $\\lambda = \\frac{0.2 \\times 4000}{1000} = 0.8$, so advection monotonicity is again satisfied. Uptake is zero ($\\mu=0$), but mortality is significant with $m\\,\\Delta t = 0.001 \\times 4000 = 4$. The reaction update gives $P_i^{n+1} = P_i^{*}(1 - 4) = -3 P_i^{*}$, making phytoplankton negative everywhere; hence positivity fails. The upper bound $P_i^{n+1} \\le P_i^{*} + Y\\,N_i^{*}$ holds trivially because $P_i^{n+1}$ is negative and the right-hand side is positive.\n\nThe program will compute these updates numerically using the specified discretizations and report, for each test case, three booleans indicating whether positivity, the stoichiometric upper bound, and advection monotonicity are preserved. The output is a single list of four lists, each containing three booleans in the prescribed order.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef upwind_advection_positive_velocity(C, u, dt, dx):\n    \"\"\"\n    First-order upwind advection for constant positive velocity with periodic BC.\n    C: array of tracer concentration at time n\n    Returns C_star after advection substep.\n    \"\"\"\n    lam = u * dt / dx  # Courant number\n    # Periodic left neighbor\n    C_left = np.roll(C, 1)\n    C_star = C - lam * (C - C_left)\n    return C_star, lam\n\ndef reaction_euler(N_star, P_star, mu, K, Y, m, dt):\n    \"\"\"\n    Explicit Euler reaction update:\n    U = mu * N_star * P_star / (K + N_star)\n    N_new = N_star - dt * U\n    P_new = P_star + Y * dt * U - m * dt * P_star\n    \"\"\"\n    # Prevent division issues: K  0 per problem statement; N_star may be zero.\n    U = mu * N_star * P_star / (K + N_star)\n    N_new = N_star - dt * U\n    P_new = P_star + Y * dt * U - m * dt * P_star\n    return N_new, P_new, U\n\ndef check_monotonicity_after_advection(C_old, C_star, tol=1e-12):\n    \"\"\"\n    Check that each entry of C_star lies within [min(C_old), max(C_old)].\n    \"\"\"\n    cmin = np.min(C_old)\n    cmax = np.max(C_old)\n    return np.all(C_star = cmin - tol) and np.all(C_star = cmax + tol)\n\ndef run_case(Nx, dx, u, dt, mu, K, Y, m):\n    # Domain setup\n    L = Nx * dx\n    x = np.arange(Nx) * dx\n\n    # Initial conditions (mmol N m^-3)\n    N0 = 2.0 + 1.5 * np.sin(2.0 * np.pi * x / L)\n    P0 = 0.8 + 0.7 * np.cos(2.0 * np.pi * x / L)\n\n    # Advection substep\n    N_star, lam_N = upwind_advection_positive_velocity(N0, u, dt, dx)\n    P_star, lam_P = upwind_advection_positive_velocity(P0, u, dt, dx)\n\n    # Monotonicity checks for advection\n    mono_N = check_monotonicity_after_advection(N0, N_star)\n    mono_P = check_monotonicity_after_advection(P0, P_star)\n    monotonicity_preserved = mono_N and mono_P\n\n    # Reaction substep\n    N_new, P_new, U_star = reaction_euler(N_star, P_star, mu, K, Y, m, dt)\n\n    # Positivity check\n    tol = 1e-12\n    positivity_preserved = (np.all(N_new = -tol) and np.all(P_new = -tol))\n\n    # Stoichiometric upper bound: P_new = P_star + Y * N_star\n    upper_bound_preserved = np.all(P_new = P_star + Y * N_star + tol)\n\n    return [positivity_preserved, upper_bound_preserved, monotonicity_preserved]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nx, dx, u, dt, mu, K, Y, m)\n        (128, 1000.0, 0.5, 1200.0, 0.005, 0.5, 0.8, 0.0),   # Test Case 1\n        (128, 1000.0, 1.0, 1000.0, 0.02, 0.5, 1.0, 0.0),    # Test Case 2\n        (128, 1000.0, 0.2, 4000.0, 2.0, 0.2, 0.9, 0.0),     # Test Case 3\n        (128, 1000.0, 0.2, 4000.0, 0.0, 0.5, 0.8, 0.001),   # Test Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, dx, u, dt, mu, K, Y, m = case\n        result = run_case(Nx, dx, u, dt, mu, K, Y, m)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Python's print of list of lists matches the specified bracketed, comma-separated format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}