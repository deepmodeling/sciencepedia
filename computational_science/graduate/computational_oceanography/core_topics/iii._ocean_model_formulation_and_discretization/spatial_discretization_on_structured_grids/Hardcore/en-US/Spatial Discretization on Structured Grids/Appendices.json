{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any finite difference model lies in the accurate approximation of spatial derivatives. Before implementing complex simulations, it is essential to understand how these discrete operators are constructed from first principles. This exercise  challenges you to derive the coefficients for a centered, arbitrary-order finite difference scheme, providing a rigorous grounding in the Taylor series methods that underpin much of numerical discretization. Mastering this derivation equips you with the tools to not only use existing schemes but also to develop new ones tailored to specific needs.",
            "id": "3810594",
            "problem": "Consider the one-dimensional zonal gradient of a smooth tracer field $u(x)$ sampled on a uniform, structured ocean model grid with spacing $h$. You wish to approximate $\\partial_{x} u$ at a grid point $x_{i}$ using a centered stencil of width $2m+1$ points, with $m \\in \\mathbb{N}$, via\n$$\n\\partial_{x} u(x_{i}) \\approx \\frac{1}{h} \\sum_{j=-m}^{m} c_{j} \\, u(x_{i} + j h),\n$$\nwhere the coefficients $c_{j}$ are dimensionless and independent of $h$ and $x_{i}$. Using Taylor series matching conditions about $x_{i}$, derive the coefficients $c_{j}$ that yield a truncation error of order $\\mathcal{O}(h^{2m})$ for $\\partial_{x} u(x_{i})$ on this uniform grid. Your derivation should start from the Taylor expansion of $u(x_{i} + j h)$ about $x_{i}$, impose exactness for polynomials up to degree $2m$, and enforce the necessary symmetry properties implied by a centered stencil for the first derivative. Express your final result as a single closed-form analytical expression for $c_{j}$ in terms of $m$ and $j$.\n\nNo numerical values are required. Provide the expression for general $m$ and $j$. The final answer must be a single closed-form analytical expression (no units).",
            "solution": "The user wants me to solve the following problem:\nConsider the one-dimensional zonal gradient of a smooth tracer field $u(x)$ sampled on a uniform, structured ocean model grid with spacing $h$. You wish to approximate $\\partial_{x} u$ at a grid point $x_{i}$ using a centered stencil of width $2m+1$ points, with $m \\in \\mathbb{N}$, via\n$$\n\\partial_{x} u(x_{i}) \\approx \\frac{1}{h} \\sum_{j=-m}^{m} c_{j} \\, u(x_{i} + j h),\n$$\nwhere the coefficients $c_{j}$ are dimensionless and independent of $h$ and $x_{i}$. Using Taylor series matching conditions about $x_{i}$, derive the coefficients $c_{j}$ that yield a truncation error of order $\\mathcal{O}(h^{2m})$ for $\\partial_{x} u(x_{i})$ on this uniform grid. Your derivation should start from the Taylor expansion of $u(x_{i} + j h)$ about $x_{i}$, impose exactness for polynomials up to degree $2m$, and enforce the necessary symmetry properties implied by a centered stencil for the first derivative. Express your final result as a single closed-form analytical expression for $c_{j}$ in terms of $m$ and $j$.\n\nNo numerical values are required. Provide the expression for general $m$ and $j$. The final answer must be a single closed-form analytical expression (no units).\n\n### Step 1: Extract Givens\n- The field to be differentiated is a smooth function $u(x)$.\n- The grid is uniform and structured with spacing $h$.\n- The approximation for the first derivative $\\partial_x u$ at a point $x_i$ is given by the formula: $\\partial_{x} u(x_{i}) \\approx \\frac{1}{h} \\sum_{j=-m}^{m} c_{j} \\, u(x_{i} + j h)$.\n- The stencil is centered and has a width of $2m+1$ points, where $m \\in \\mathbb{N}$.\n- The coefficients $c_j$ are dimensionless and independent of $h$ and $x_i$.\n- The desired truncation error is of order $\\mathcal{O}(h^{2m})$.\n- The derivation method is to use Taylor series matching, which is equivalent to requiring the formula to be exact for all polynomials up to degree $2m$.\n- The symmetry properties of a centered stencil for the first derivative must be enforced.\n- The final goal is a single closed-form analytical expression for $c_j$ in terms of $m$ and $j$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it is a fundamental problem in numerical analysis for the development of finite difference schemes, which are widely used in computational science and engineering, including computational oceanography. The problem is well-posed; it asks for a unique set of coefficients for a given stencil size and accuracy order, which is a standard procedure known as the method of undetermined coefficients. The problem statement is objective and uses precise mathematical language. There are no contradictions, missing information, or unrealistic assumptions. The problem is non-trivial and requires a rigorous mathematical derivation.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed to derive the solution.\n\n### Derivation\nThe problem is to find the coefficients $c_j$ for the finite difference approximation\n$$\n\\partial_{x} u(x_{i}) \\approx \\frac{1}{h} \\sum_{j=-m}^{m} c_{j} u(x_{i} + j h)\n$$\nsuch that the approximation has a truncation error of order $\\mathcal{O}(h^{2m})$.\n\nWe begin by expanding $u(x_{i} + jh)$ in a Taylor series about the point $x_i$:\n$$\nu(x_i + jh) = \\sum_{k=0}^{\\infty} \\frac{(jh)^k}{k!} \\frac{d^k u}{dx^k}\\bigg|_{x=x_i}\n$$\nSubstituting this expansion into the finite difference formula gives:\n$$\n\\frac{1}{h} \\sum_{j=-m}^{m} c_{j} \\sum_{k=0}^{\\infty} \\frac{(jh)^k}{k!} u^{(k)}(x_i)\n$$\nwhere $u^{(k)}(x_i)$ denotes the $k$-th derivative of $u$ at $x_i$. We can swap the order of summation:\n$$\n\\sum_{k=0}^{\\infty} \\frac{h^{k-1}}{k!} u^{(k)}(x_i) \\left( \\sum_{j=-m}^{m} c_j j^k \\right)\n$$\nWe want this expression to be the best possible approximation of $\\partial_x u(x_i) = u^{(1)}(x_i)$. This means we must match the coefficients of $u^{(k)}(x_i)$ in the series with those in the target expression, $1 \\cdot u^{(1)}(x_i)$.\nThis leads to a system of linear equations for the coefficients $c_j$:\n$$\n\\frac{h^{k-1}}{k!} \\left( \\sum_{j=-m}^{m} c_j j^k \\right) = \\delta_{k,1}\n$$\nwhere $\\delta_{k,1}$ is the Kronecker delta. This must hold for as many values of $k$ as possible. The stencil has $2m+1$ points, allowing us to specify $2m+1$ constraints. For the scheme to have a truncation error of $\\mathcal{O}(h^{2m})$, we must ensure the formula is exact for polynomials of degree up to $2m$, which corresponds to satisfying the conditions for $k=0, 1, \\dots, 2m$.\nThe system of equations is:\n$$\n\\sum_{j=-m}^{m} c_j j^k = \\delta_{k,1}, \\quad \\text{for } k = 0, 1, 2, \\dots, 2m\n$$\n- For $k=0$: $\\sum_{j=-m}^{m} c_j = 0$\n- For $k=1$: $\\sum_{j=-m}^{m} c_j j = 1$\n- For $k \\in \\{2, 3, \\dots, 2m\\}$: $\\sum_{j=-m}^{m} c_j j^k = 0$\n\nAn elegant and constructive method to solve this system is to consider the differentiation of a Lagrange interpolating polynomial. Let's construct a polynomial $P(x)$ of degree at most $2m$ that interpolates the function $u(x)$ at the $2m+1$ stencil points $\\{x_i + jh\\}_{j=-m}^m$. The approximation to the derivative is then $u'(x_i) \\approx P'(x_i)$.\n\nLet's define a local coordinate $s = (x-x_i)/h$, so the interpolation nodes are the integers $s \\in \\{-m, \\dots, m\\}$. The Lagrange basis polynomial for node $j$ is:\n$$\n\\ell_j(s) = \\prod_{\\substack{k=-m \\\\ k \\neq j}}^{m} \\frac{s-k}{j-k}\n$$\nThe interpolating polynomial is $p(s) = \\sum_{j=-m}^{m} u(x_i+jh) \\ell_j(s)$. The derivative with respect to $x$ is related to the derivative with respect to $s$ by the chain rule: $\\frac{d}{dx} = \\frac{ds}{dx}\\frac{d}{ds} = \\frac{1}{h}\\frac{d}{ds}$.\nEvaluating the derivative at $x=x_i$ (which corresponds to $s=0$) gives:\n$$\nP'(x_i) = \\frac{1}{h} \\frac{dp}{ds}\\bigg|_{s=0} = \\frac{1}{h} \\sum_{j=-m}^{m} u(x_i+jh) \\ell_j'(0)\n$$\nBy comparing this with the given finite difference formula, we identify the coefficients as $c_j = \\ell_j'(0)$.\n\nTo calculate $\\ell_j'(0)$, we write $\\ell_j(s) = N_j(s)/D_j$, where the numerator is $N_j(s) = \\prod_{k=-m, k \\neq j}^{m} (s-k)$ and the denominator is the constant $D_j = \\prod_{k=-m, k \\neq j}^{m} (j-k)$.\nFirst, we analyze the case $j \\neq 0$. We can express $N_j(s)$ as $\\frac{P(s)}{s-j}$, where $P(s) = \\prod_{k=-m}^{m} (s-k)$.\nThe derivative is $N_j'(s) = \\frac{P'(s)(s-j) - P(s)}{(s-j)^2}$.\nAt $s=0$, this gives $N_j'(0) = \\frac{P'(0)(-j) - P(0)}{(-j)^2}$. Since $P(s)$ contains the factor $s$, we have $P(0)=0$.\nThus, $N_j'(0) = \\frac{-j P'(0)}{j^2} = -\\frac{P'(0)}{j}$.\nTo find $P'(0)$, we write $P(s) = s \\prod_{k=1}^{m} (s-k) \\prod_{k=1}^{m} (s+k) = s \\prod_{k=1}^{m} (s^2-k^2)$.\nDifferentiating with respect to $s$ yields $P'(s) = \\prod_{k=1}^{m} (s^2-k^2) + s \\frac{d}{ds}\\left(\\prod_{k=1}^{m} (s^2-k^2)\\right)$.\nEvaluating at $s=0$: $P'(0) = \\prod_{k=1}^{m} (-k^2) = (\\prod_{k=1}^{m} (-1)) (\\prod_{k=1}^{m} k^2) = (-1)^m (m!)^2$.\nSo, for $j \\neq 0$, $N_j'(0) = -\\frac{(-1)^m (m!)^2}{j}$.\n\nNext, we calculate the denominator $D_j = \\prod_{k=-m, k \\neq j}^{m} (j-k)$.\n$D_j = \\left(\\prod_{k=-m}^{j-1} (j-k)\\right) \\left(\\prod_{k=j+1}^{m} (j-k)\\right)$.\nThe first part is $(j-(-m))\\cdots(j-(j-1)) = (j+m)\\cdots(1) = (j+m)!$.\nThe second part is $(j-(j+1))\\cdots(j-m) = (-1)\\cdots(j-m)$. There are $m-j$ terms, so this product is $(-1)^{m-j}(m-j)!$.\nThus, $D_j = (m+j)! (-1)^{m-j} (m-j)!$.\n\nCombining these results to find $c_j$ for $j \\neq 0$:\n$$\nc_j = \\frac{N_j'(0)}{D_j} = \\frac{-\\frac{(-1)^m (m!)^2}{j}}{(-1)^{m-j}(m+j)!(m-j)!} = \\frac{(-1)^{1+m-(m-j)}}{j} \\frac{(m!)^2}{(m+j)!(m-j)!}\n$$\n$$\nc_j = \\frac{(-1)^{j+1}}{j} \\frac{(m!)^2}{(m+j)!(m-j)!}\n$$\nThis formula is valid for $j \\in \\{-m, \\ldots, -1, 1, \\ldots, m\\}$.\n\nFor the case $j=0$, we must find $c_0 = \\ell'_0(0)$.\nThe problem specifies a centered stencil for a first derivative, which implies anti-symmetry, $c_{-j} = -c_j$. For $j=0$, this requires $c_0 = -c_0$, which means $c_0=0$.\nAlternatively, from our system of equations, the condition $\\sum_{j=-m}^{m} c_j = 0$ must hold.\nThe derived coefficients for $j \\neq 0$ satisfy the anti-symmetry property:\n$$\nc_{-j} = \\frac{(-1)^{-j+1}}{-j} \\frac{(m!)^2}{(m-j)!(m+j)!} = - \\frac{(-1)^{-j+1}}{j} \\frac{(m!)^2}{(m-j)!(m+j)!} = - \\frac{(-1)^{j+1}}{j} \\frac{(m!)^2}{(m+j)!(m-j)!} = -c_j\n$$\nsince $(-1)^{-j+1} = (-1)^{-j+1+2j} = (-1)^{j+1}$.\nUsing this, the sum for $k=0$ becomes:\n$$\n\\sum_{j=-m}^{m} c_j = c_0 + \\sum_{j=1}^{m} (c_j + c_{-j}) = c_0 + \\sum_{j=1}^{m} (c_j - c_j) = c_0\n$$\nSince this sum must be zero, we must have $c_0=0$. Therefore, the coefficient for the center point is zero.\n\nThe final expression for the coefficients $c_j$ is given by:\n$c_0=0$ and for $j \\in \\{-m, \\dots, m\\}$ with $j \\neq 0$:\n$$\nc_j = \\frac{(-1)^{j+1}}{j} \\frac{(m!)^2}{(m+j)!(m-j)!}\n$$\nThis formula provides the coefficients for the $(2m+1)$-point centered difference formula for the first derivative, which is accurate to order $\\mathcal{O}(h^{2m})$.",
            "answer": "$$\n\\boxed{\\frac{(-1)^{j+1}}{j} \\frac{(m!)^2}{(m+j)!(m-j)!}}\n$$"
        },
        {
            "introduction": "A robust numerical model must do more than just approximate derivatives; it must respect the fundamental conservation laws of physics. This hands-on coding practice  bridges theory and application by tasking you with verifying discrete mass conservation within a finite volume framework. By implementing various boundary conditions and testing them against a divergence-free velocity field, you will gain practical insight into how a conservative discretization ensures that mass is not spuriously created or destroyed, a critical property for the physical realism of any ocean model.",
            "id": "3810605",
            "problem": "Consider a two-dimensional, horizontally incompressible ocean flow field on a structured, uniform, rectangular grid. Begin from the conservation of mass for a constant-density fluid, which reduces to the statement that the divergence of the horizontal velocity is zero, i.e., $\\nabla \\cdot \\mathbf{u} = 0$. By the divergence theorem, the integral of the divergence over the domain equals the net flux through the boundary. In a Finite Volume (FV) discretization on a uniform grid, the divergence in each cell is the net outward flux per unit area computed from the face-normal flows. In this problem, you will design a conservative discrete operator on a uniform Cartesian grid and verify that the discrete integrated divergence over all cells equals the net boundary flux. For incompressible test fields with either periodic boundaries or closed boundaries with zero normal flow, this net flux must be zero. For specified open boundaries, the net flux must equal the prescribed boundary inflow minus outflow.\n\nYou are given a uniform grid with $N_x$ cells in the $x$-direction and $N_y$ cells in the $y$-direction spanning a domain of length $L_x$ (in meters) and $L_y$ (in meters). The cell widths are $\\Delta x = L_x / N_x$ and $\\Delta y = L_y / N_y$. The cell centers are located at $(x_i, y_j)$ with $x_i = (i + 1/2)\\Delta x$ and $y_j = (j + 1/2)\\Delta y$, where $i \\in \\{0, 1, \\dots, N_x - 1\\}$ and $j \\in \\{0, 1, \\dots, N_y - 1\\}$.\n\nDefine the test velocity field from a smooth streamfunction $\\psi(x,y)$ to ensure incompressibility at the continuous level, with $u(x,y) = \\partial \\psi / \\partial y$ and $v(x,y) = - \\partial \\psi / \\partial x$, where $u$ is the $x$-component and $v$ is the $y$-component of the velocity in meters per second. Use the analytic streamfunction $\\psi(x,y) = A \\sin\\left( 2\\pi x / L_x \\right)\\sin\\left( 2\\pi y / L_y \\right)$, where $A$ has units of square meters per second and $x$ and $y$ are in meters, so that $u$ and $v$ are well-defined and smooth across the domain. Compute $u$ and $v$ at cell centers by analytic differentiation of $\\psi$.\n\nFor the discrete FV divergence, adopt the following design decisions:\n- For interior faces, linearly interpolate the cell-centered velocity to the face by arithmetic averaging of the adjacent cell-centered values to obtain the face-normal velocity, and multiply by the face length to obtain the face-normal flux in square meters per second.\n- For periodic boundaries, wrap indices so that faces at $i = N_x - 1$ connect to $i = 0$ and faces at $j = N_y - 1$ connect to $j = 0$, thereby treating those faces equivalently to interior faces.\n- For closed boundaries (no-normal-flow walls), set the normal flux on the external boundary faces to zero.\n- For open boundaries, prescribe uniform boundary-normal velocities on the $x$-normal faces: $u_{\\text{west}}$ at the western boundary ($i=0$) and $u_{\\text{east}}$ at the eastern boundary ($i=N_x-1$), each in meters per second. On the $y$-normal boundaries, set the normal flux to zero (no-normal-flow walls) for this problem unless specified otherwise. The prescribed boundary velocities are used directly to compute the boundary face-normal fluxes by multiplying by the face length.\n\nDefine the discrete net flux as the area-integral of the discrete divergence, computed as the sum over all cells of the discrete divergence multiplied by the cell area $\\Delta x \\Delta y$. Equivalently, this sum equals the algebraic sum of the outward face-normal fluxes over all external boundary faces for a conservative FV scheme. The unit of the discrete net flux is square meters per second.\n\nImplement a program that:\n- Constructs the grid and the analytic velocity field from the streamfunction for each test case.\n- Computes the face-normal fluxes using arithmetic averaging for interior faces and the specified boundary rules for boundary faces.\n- Computes the discrete net flux as the sum over all cells of the net outward flux contributions.\n- Checks whether the absolute value of the net flux is below a tolerance scaled to the problem, thereby confirming discrete mass conservation. The tolerance must be computed as $\\epsilon = 10^{-9} \\max(L_x, L_y) U_{\\text{scale}} + 10^{-12}$ in square meters per second, where $U_{\\text{scale}}$ is the maximum of the absolute values of the interior $u$ and $v$ speeds and any prescribed boundary speeds.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one boolean per test case indicating whether discrete mass conservation is confirmed. For instance, the format must be exactly like $[ \\text{True}, \\text{False}, \\dots ]$ with no additional text.\n\nUse the following test suite, which explores periodicity, wall boundaries, balanced open boundaries, and an imbalanced open boundary case:\n\n- Test case $1$ (periodic domain, incompressible analytic field):\n  - $N_x = 64$, $N_y = 64$, $L_x = 10^5$ meters, $L_y = 2\\times 10^5$ meters, $A = 10^4$ square meters per second.\n  - $x$-boundary condition is periodic, $y$-boundary condition is periodic.\n\n- Test case $2$ (closed walls, incompressible analytic field):\n  - $N_x = 64$, $N_y = 64$, $L_x = 10^5$ meters, $L_y = 2\\times 10^5$ meters, $A = 10^4$ square meters per second.\n  - $x$-boundary condition is closed wall (zero normal flux), $y$-boundary condition is closed wall (zero normal flux).\n\n- Test case $3$ (open $x$-boundaries with balanced inflow/outflow, walls in $y$):\n  - $N_x = 64$, $N_y = 64$, $L_x = 10^5$ meters, $L_y = 2\\times 10^5$ meters, $A = 10^4$ square meters per second.\n  - $x$-boundary condition is open with uniform prescribed velocities $u_{\\text{west}} = 0.3$ meters per second and $u_{\\text{east}} = 0.3$ meters per second, $y$-boundary condition is closed wall (zero normal flux).\n\n- Test case $4$ (open $x$-boundaries with imbalanced inflow/outflow, walls in $y$):\n  - $N_x = 64$, $N_y = 64$, $L_x = 10^5$ meters, $L_y = 2\\times 10^5$ meters, $A = 10^4$ square meters per second.\n  - $x$-boundary condition is open with uniform prescribed velocities $u_{\\text{west}} = 0.3$ meters per second and $u_{\\text{east}} = 0.25$ meters per second, $y$-boundary condition is closed wall (zero normal flux).\n\nYour program must evaluate the discrete net flux in square meters per second for each test case, apply the tolerance check described above, and output the boolean results in the precise format $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$ on a single line.",
            "solution": "The scientific foundation is the conservation of mass for a constant-density fluid, which in two dimensions states that $\\nabla \\cdot \\mathbf{u} = 0$. The divergence theorem asserts that $\\int_{\\Omega} \\nabla \\cdot \\mathbf{u}\\, \\mathrm{d}A = \\oint_{\\partial \\Omega} \\mathbf{u} \\cdot \\mathbf{n}\\, \\mathrm{d}s$, where $\\Omega$ is the domain and $\\partial \\Omega$ is the boundary. In a Finite Volume (FV) discretization on a uniform structured grid, the divergence of $\\mathbf{u}$ in a cell is defined as the net outward flux per unit area, computed from face-normal fluxes. Summing the discrete divergence over all cells and multiplying by the cell area $\\Delta x \\Delta y$ yields a telescoping sum in which internal face contributions cancel pairwise, leaving only external boundary flux contributions. Therefore, the discrete net flux equals the algebraic sum of external boundary fluxes, consistent with the continuous divergence theorem. For an incompressible test field in a periodic domain or a domain with closed walls (zero normal flux), the discrete net flux must be zero, whereas for open boundaries the net flux equals the prescribed inflow minus outflow.\n\nWe construct a uniform Cartesian grid with $N_x$ cells in the $x$-direction and $N_y$ cells in the $y$-direction over lengths $L_x$ and $L_y$. The cell widths are $\\Delta x = L_x / N_x$ and $\\Delta y = L_y / N_y$. Cell centers are at $(x_i, y_j)$ with $x_i = (i + 1/2)\\Delta x$ and $y_j = (j + 1/2)\\Delta y$.\n\nTo ensure incompressibility at the continuous level, we define a streamfunction $\\psi(x,y) = A \\sin\\left( 2\\pi x / L_x \\right)\\sin\\left( 2\\pi y / L_y \\right)$, with $A$ in square meters per second. The velocities follow from $\\mathbf{u} = (u,v)$ with $u(x,y) = \\partial \\psi / \\partial y = A \\left( \\frac{2\\pi}{L_y} \\right) \\sin\\left( \\frac{2\\pi x}{L_x} \\right)\\cos\\left( \\frac{2\\pi y}{L_y} \\right)$ and $v(x,y) = -\\partial \\psi / \\partial x = -A \\left( \\frac{2\\pi}{L_x} \\right)\\cos\\left( \\frac{2\\pi x}{L_x} \\right)\\sin\\left( \\frac{2\\pi y}{L_y} \\right)$. These analytic formulas are evaluated at cell centers $(x_i, y_j)$ to produce $u_{i,j}$ and $v_{i,j}$.\n\nIn the FV framework, the face-normal flux is the face-normal velocity times the face length. For interior faces, we linearly interpolate the normal velocity to the face by arithmetic averaging of adjacent cell-centered velocities. Specifically, for the east and west faces of a cell $(i,j)$, the face-normal velocity is approximated by the average of $u_{i,j}$ and its adjacent neighbor in the $x$-direction; for the north and south faces, the face-normal velocity is approximated by the average of $v_{i,j}$ and its adjacent neighbor in the $y$-direction. The face-normal flux is then the interpolated velocity times the face length ($\\Delta y$ for $x$-normal faces and $\\Delta x$ for $y$-normal faces). For periodic boundaries, index wrapping is used so that faces at $i = N_x - 1$ connect to $i = 0$ and faces at $j = N_y - 1$ connect to $j = 0$. For closed walls, the external boundary face-normal flux is set to zero. For open boundaries, the boundary face-normal flux is prescribed from the given uniform boundary-normal velocity: $u_{\\text{west}} \\Delta y$ on the western boundary and $u_{\\text{east}} \\Delta y$ on the eastern boundary; $y$-normal boundaries remain closed (zero flux) unless otherwise specified.\n\nThe discrete divergence in cell $(i,j)$ is computed as the net outward flux per unit area using the four faces. When computing the discrete net flux over the whole domain, it is efficient to sum the net outward flux contributions $(F_{\\text{east}} - F_{\\text{west}}) + (F_{\\text{north}} - F_{\\text{south}})$ directly per cell, which equals the cell divergence times $\\Delta x \\Delta y$. Summing this quantity over all cells yields cancellation of internal face contributions (because each internal face flux appears once with a positive sign for one cell and once with a negative sign for its neighbor) and leaves only the algebraic sum of the external boundary fluxes. The result has units of square meters per second.\n\nTo confirm discrete mass conservation, we compare the absolute value of the discrete net flux to a tolerance scaled to the flow magnitude and domain size. We define $U_{\\text{scale}}$ as the maximum of the absolute values of the interior velocities $u_{i,j}$ and $v_{i,j}$ and any prescribed boundary speeds. The tolerance is $\\epsilon = 10^{-9} \\max(L_x, L_y) U_{\\text{scale}} + 10^{-12}$, in square meters per second. If the absolute net flux is less than or equal to $\\epsilon$, we declare conservation as confirmed (boolean $\\text{True}$), otherwise $\\text{False}$.\n\nFor the test suite:\n- Test case $1$ uses periodic boundaries in both directions and the analytic incompressible field. Internal cancellations and periodic wrapping imply zero discrete net flux; the boolean should be $\\text{True}$.\n- Test case $2$ uses closed walls in both directions. All external boundary fluxes are zero, hence the net flux should be zero; the boolean should be $\\text{True}$.\n- Test case $3$ uses open boundaries in the $x$-direction with balanced inflow and outflow ($u_{\\text{west}} = u_{\\text{east}} = 0.3$ meters per second) and closed walls in the $y$-direction. The external boundary fluxes on the east and west cancel, leading to zero net flux; the boolean should be $\\text{True}$.\n- Test case $4$ uses open boundaries in the $x$-direction with imbalanced inflow and outflow ($u_{\\text{west}} = 0.3$ meters per second, $u_{\\text{east}} = 0.25$ meters per second) and closed walls in the $y$-direction. The net flux is approximately $(u_{\\text{east}} - u_{\\text{west}}) L_y \\approx (0.25 - 0.3)\\times 2\\times 10^5 = -10^4$ square meters per second (negative indicates net inflow), with magnitude far exceeding the tolerance, so the boolean should be $\\text{False}$.\n\nThe program computes the discrete net flux for each test case, applies the tolerance check, and outputs a single line with a list of booleans $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$ in the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef construct_velocity_field(Nx, Ny, Lx, Ly, A):\n    \"\"\"\n    Construct analytic divergence-free velocity field from streamfunction:\n    psi(x,y) = A * sin(2*pi*x/Lx) * sin(2*pi*y/Ly)\n    u = dpsi/dy, v = -dpsi/dx\n    Evaluated at cell centers.\n    \"\"\"\n    dx = Lx / Nx\n    dy = Ly / Ny\n    i = np.arange(Nx)\n    j = np.arange(Ny)\n    x = (i + 0.5) * dx  # cell center x\n    y = (j + 0.5) * dy  # cell center y\n    X, Y = np.meshgrid(x, y, indexing=\"ij\")\n    # Analytic velocities\n    u = A * (2.0 * np.pi / Ly) * np.sin(2.0 * np.pi * X / Lx) * np.cos(2.0 * np.pi * Y / Ly)\n    v = -A * (2.0 * np.pi / Lx) * np.cos(2.0 * np.pi * X / Lx) * np.sin(2.0 * np.pi * Y / Ly)\n    return u, v, dx, dy\n\ndef compute_net_flux(u, v, dx, dy, bc_x, bc_y, U_west=0.0, U_east=0.0, V_south=0.0, V_north=0.0):\n    \"\"\"\n    Compute discrete net flux (m^2/s) by summing per-cell net outward flux contributions.\n    bc_x, bc_y: 'periodic', 'wall', or 'open'\n    For 'open' in x, use U_west and U_east (m/s). For y, V_south and V_north (m/s), though\n    test suite keeps y closed.\n    \"\"\"\n    Nx, Ny = u.shape\n    flux_sum = 0.0\n\n    # Helper functions to get face fluxes\n    for i in range(Nx):\n        for j in range(Ny):\n            # East face flux\n            if bc_x == 'periodic':\n                u_e = 0.5 * (u[i, j] + u[(i + 1) % Nx, j])\n                F_e = u_e * dy\n            else:\n                if i < Nx - 1:\n                    u_e = 0.5 * (u[i, j] + u[i + 1, j])\n                    F_e = u_e * dy\n                else:\n                    if bc_x == 'open':\n                        F_e = U_east * dy\n                    else:  # 'wall'\n                        F_e = 0.0\n\n            # West face flux\n            if bc_x == 'periodic':\n                u_w = 0.5 * (u[i, j] + u[(i - 1) % Nx, j])\n                F_w = u_w * dy\n            else:\n                if i > 0:\n                    u_w = 0.5 * (u[i - 1, j] + u[i, j])\n                    F_w = u_w * dy\n                else:\n                    if bc_x == 'open':\n                        F_w = U_west * dy\n                    else:  # 'wall'\n                        F_w = 0.0\n\n            # North face flux\n            if bc_y == 'periodic':\n                v_n = 0.5 * (v[i, j] + v[i, (j + 1) % Ny])\n                F_n = v_n * dx\n            else:\n                if j < Ny - 1:\n                    v_n = 0.5 * (v[i, j] + v[i, j + 1])\n                    F_n = v_n * dx\n                else:\n                    if bc_y == 'open':\n                        F_n = V_north * dx\n                    else:  # 'wall'\n                        F_n = 0.0\n\n            # South face flux\n            if bc_y == 'periodic':\n                v_s = 0.5 * (v[i, j] + v[i, (j - 1) % Ny])\n                F_s = v_s * dx\n            else:\n                if j > 0:\n                    v_s = 0.5 * (v[i, j - 1] + v[i, j])\n                    F_s = v_s * dx\n                else:\n                    if bc_y == 'open':\n                        F_s = V_south * dx\n                    else:  # 'wall'\n                        F_s = 0.0\n\n            # Net outward flux contribution for this cell equals divergence * area\n            flux_sum += (F_e - F_w) + (F_n - F_s)\n\n    return flux_sum\n\ndef tolerance(Lx, Ly, u, v, U_west=0.0, U_east=0.0, V_south=0.0, V_north=0.0):\n    \"\"\"\n    Compute tolerance epsilon = 1e-9 * max(Lx, Ly) * U_scale + 1e-12 (m^2/s),\n    where U_scale is max of interior speeds and boundary speeds.\n    \"\"\"\n    U_scale_interior = max(np.max(np.abs(u)), np.max(np.abs(v)))\n    U_scale_boundary = max(abs(U_west), abs(U_east), abs(V_south), abs(V_north))\n    U_scale = max(U_scale_interior, U_scale_boundary)\n    eps = 1e-9 * max(Lx, Ly) * U_scale + 1e-12\n    return eps\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1: periodic in both directions\n        {\n            \"Nx\": 64, \"Ny\": 64, \"Lx\": 1e5, \"Ly\": 2e5, \"A\": 1e4,\n            \"bc_x\": \"periodic\", \"bc_y\": \"periodic\",\n            \"U_west\": 0.0, \"U_east\": 0.0, \"V_south\": 0.0, \"V_north\": 0.0,\n        },\n        # Test case 2: closed walls in both directions\n        {\n            \"Nx\": 64, \"Ny\": 64, \"Lx\": 1e5, \"Ly\": 2e5, \"A\": 1e4,\n            \"bc_x\": \"wall\", \"bc_y\": \"wall\",\n            \"U_west\": 0.0, \"U_east\": 0.0, \"V_south\": 0.0, \"V_north\": 0.0,\n        },\n        # Test case 3: open x-boundaries with balanced inflow/outflow, walls in y\n        {\n            \"Nx\": 64, \"Ny\": 64, \"Lx\": 1e5, \"Ly\": 2e5, \"A\": 1e4,\n            \"bc_x\": \"open\", \"bc_y\": \"wall\",\n            \"U_west\": 0.3, \"U_east\": 0.3, \"V_south\": 0.0, \"V_north\": 0.0,\n        },\n        # Test case 4: open x-boundaries with imbalanced inflow/outflow, walls in y\n        {\n            \"Nx\": 64, \"Ny\": 64, \"Lx\": 1e5, \"Ly\": 2e5, \"A\": 1e4,\n            \"bc_x\": \"open\", \"bc_y\": \"wall\",\n            \"U_west\": 0.3, \"U_east\": 0.25, \"V_south\": 0.0, \"V_north\": 0.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx = case[\"Nx\"]; Ny = case[\"Ny\"]\n        Lx = case[\"Lx\"]; Ly = case[\"Ly\"]\n        A = case[\"A\"]\n        bc_x = case[\"bc_x\"]; bc_y = case[\"bc_y\"]\n        U_west = case[\"U_west\"]; U_east = case[\"U_east\"]\n        V_south = case[\"V_south\"]; V_north = case[\"V_north\"]\n\n        # Construct analytic divergence-free velocity field and grid metrics\n        u, v, dx, dy = construct_velocity_field(Nx, Ny, Lx, Ly, A)\n\n        # Compute discrete net flux (m^2/s)\n        net_flux = compute_net_flux(\n            u, v, dx, dy, bc_x, bc_y,\n            U_west=U_west, U_east=U_east, V_south=V_south, V_north=V_north\n        )\n\n        # Tolerance for conservation check\n        eps = tolerance(Lx, Ly, u, v, U_west=U_west, U_east=U_east, V_south=V_south, V_north=V_north)\n\n        # Conservation confirmed if |net_flux| <= eps\n        results.append(abs(net_flux) <= eps)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Choosing a discretization scheme involves trade-offs, as numerical errors can manifest as non-physical wave behavior. This practice  introduces modified wavenumber analysis, a powerful diagnostic tool for quantifying a scheme's performance in Fourier space. By analyzing first-order and third-order upwind schemes, you will learn to calculate numerical dispersion (errors in phase speed) and numerical dissipation (amplitude damping), providing a deeper understanding of how a scheme's design impacts the fidelity of tracer advection.",
            "id": "3810592",
            "problem": "Consider linear advection of a passive tracer in one spatial dimension on a uniform, structured grid. The governing equation is the linear advection equation, a well-tested foundation for geophysical transport, given by $$\\frac{\\partial T}{\\partial t} + c \\frac{\\partial T}{\\partial x} = 0,$$ where $T(x,t)$ is the tracer concentration and $c$ is a constant background velocity. The domain is discretized by a uniform grid with spacing $\\Delta x$ and grid points $x_i = i \\Delta x$, where $i$ is an integer index.\n\nAssume a sinusoidal tracer profile with physical wavenumber $k$ given by $$T(x,0) = A \\sin(k x),$$ where $A$ is a real amplitude and $k = \\frac{2\\pi}{\\lambda}$ for physical wavelength $\\lambda$. In discrete modified wavenumber analysis, we analyze the action of a discrete spatial derivative operator on the complex Fourier mode $$T_i = \\exp(\\mathrm{i} k x_i) = \\exp(\\mathrm{i} i \\theta),$$ where $\\theta = k \\Delta x$. For any linear, translation-invariant finite difference operator approximating $\\frac{\\partial}{\\partial x}$, its action on $T_i$ is equivalent to multiplication by a complex symbol $S(\\theta)$, defined by $$D[T]_i = S(\\theta) \\, T_i.$$ The exact derivative corresponds to $S_{\\text{exact}}(\\theta) = \\mathrm{i} k$. The discrete modified wavenumber $k^\\ast$ is defined so that $$\\mathrm{i} k^\\ast = S(\\theta),$$ and therefore $$k^\\ast = -\\mathrm{i} S(\\theta).$$ The real part $\\operatorname{Re}(k^\\ast)$ characterizes numerical dispersion, and the imaginary part $\\operatorname{Im}(k^\\ast)$ characterizes numerical dissipation induced by the spatial discretization. The semi-discrete amplitude evolution under the linear advection equation is governed by the growth (or decay) rate $$\\sigma = c \\, \\operatorname{Im}(k^\\ast),$$ which has units of inverse seconds and is negative for dissipative schemes when $c > 0$.\n\nYour task is to derive and implement the symbols $S(\\theta)$ and the associated modified wavenumber $k^\\ast$ and dissipation rate $\\sigma$ for the following two upwind schemes suitable for $c > 0$:\n\n- First-order upwind scheme (one-sided, using points $\\{x_i, x_{i-1}\\}$), which is consistent and first-order accurate in space.\n- Third-order upwind-biased scheme (one-sided, using points $\\{x_i, x_{i-1}, x_{i-2}, x_{i-3}\\}$), which is consistent and third-order accurate in space.\n\nStarting from the definition of order conditions via Taylor expansion about $x_i$ on a uniform mesh, derive the finite difference coefficients for each scheme that ensure the targeted spatial accuracy and consistency. Then, using the discrete Fourier mode $T_i = \\exp(\\mathrm{i} i \\theta)$, construct the corresponding discrete symbols $S(\\theta)$, compute $$k^\\ast(\\theta) = -\\mathrm{i} S(\\theta),$$ and evaluate $$\\sigma(\\theta) = c \\, \\operatorname{Im}\\big(k^\\ast(\\theta)\\big).$$ Report $\\operatorname{Re}(k^\\ast)$ and $\\operatorname{Im}(k^\\ast)$ in radians per meter and $\\sigma$ in inverse seconds.\n\nImplement a program that evaluates these quantities for the following test suite, which probes different resolution regimes:\n\n- Case $1$: $\\Delta x = 1000$ meters, $\\lambda = 10000$ meters, $c = 0.5$ meters per second.\n- Case $2$: $\\Delta x = 1000$ meters, $\\lambda = 2000$ meters, $c = 0.5$ meters per second.\n- Case $3$: $\\Delta x = 5000$ meters, $\\lambda = 500000$ meters, $c = 0.2$ meters per second.\n- Case $4$: $\\Delta x = 1000$ meters, $\\lambda = 4000$ meters, $c = 0.5$ meters per second.\n\nFor each case, compute and return a single list containing the six floats $$\\big[\\operatorname{Re}(k^\\ast_{\\text{FOU}}), \\operatorname{Im}(k^\\ast_{\\text{FOU}}), \\sigma_{\\text{FOU}}, \\operatorname{Re}(k^\\ast_{\\text{U3}}), \\operatorname{Im}(k^\\ast_{\\text{U3}}), \\sigma_{\\text{U3}}\\big],$$ where $\\text{FOU}$ denotes the first-order upwind scheme and $\\text{U3}$ denotes the third-order upwind-biased scheme. Values must be expressed with $\\operatorname{Re}(k^\\ast)$ and $\\operatorname{Im}(k^\\ast)$ in radians per meter and $\\sigma$ in inverse seconds, each rounded to $8$ decimal places.\n\nYour program should produce a single line of output containing the results for all cases as a comma-separated list of lists enclosed in square brackets, for example $$[\\text{case1\\_list},\\text{case2\\_list},\\text{case3\\_list},\\text{case4\\_list}].$$ No other output is permitted.",
            "solution": "The problem requires the derivation and implementation of the modified wavenumber $k^\\ast$ and the numerical dissipation rate $\\sigma$ for two upwind finite difference schemes used to approximate the spatial derivative in the linear advection equation, $\\frac{\\partial T}{\\partial t} + c \\frac{\\partial T}{\\partial x} = 0$. The analysis is performed on a uniform grid with spacing $\\Delta x$ for a discrete Fourier mode $T_i = \\exp(\\mathrm{i} k x_i) = \\exp(\\mathrm{i} i \\theta)$, where $\\theta = k \\Delta x$ is the dimensionless wavenumber.\n\nThe general form of a finite difference approximation to $\\frac{\\partial T}{\\partial x}$ at grid point $x_i$ is given by\n$$\nD[T]_i = \\frac{1}{\\Delta x} \\sum_{j} a_j T_{i+j}\n$$\nThe coefficients $a_j$ are determined by expanding each $T_{i+j}$ in a Taylor series about $x_i$ and matching the coefficients of the resulting expansion to the Taylor series of the exact derivative, which is simply $T'(x_i)$. The action of this discrete operator on the Fourier mode $T_i$ is $D[T]_i = S(\\theta) T_i$, where $S(\\theta)$ is the symbol of the operator. The modified wavenumber $k^\\ast$ is then defined as $k^\\ast = -\\mathrm{i} S(\\theta)$, and the dissipation rate is $\\sigma = c \\, \\operatorname{Im}(k^\\ast)$.\n\n### First-Order Upwind (FOU) Scheme\n\nThis scheme uses the stencil $\\{x_i, x_{i-1}\\}$ for a positive velocity $c > 0$. The approximation is\n$$\n\\frac{\\partial T}{\\partial x} \\bigg|_{x_i} \\approx \\frac{a_0 T_i + a_{-1} T_{i-1}}{\\Delta x}\n$$\nExpanding $T_{i-1} = T(x_i - \\Delta x)$ in a Taylor series:\n$$\nT_{i-1} = T_i - \\Delta x T'_i + \\frac{(\\Delta x)^2}{2!} T''_i - O((\\Delta x)^3)\n$$\nSubstituting this into the approximation gives:\n$$\n\\frac{a_0 T_i + a_{-1} (T_i - \\Delta x T'_i + \\dots)}{\\Delta x} = \\frac{(a_0+a_{-1})}{\\Delta x}T_i - a_{-1} T'_i + O(\\Delta x)\n$$\nTo approximate $T'_i$, we set the coefficient of $T_i$ to $0$ and the coefficient of $T'_i$ to $1$.\n\\begin{itemize}\n    \\item $a_0 + a_{-1} = 0$\n    \\item $-a_{-1} = 1 \\implies a_{-1} = -1$\n\\end{itemize}\nThis gives $a_0 = 1$. The scheme is\n$$\nD_{\\text{FOU}}[T]_i = \\frac{T_i - T_{i-1}}{\\Delta x}\n$$\nThe leading error term is $-\\frac{\\Delta x}{2} T''_i$, so the scheme is first-order accurate.\n\nTo find the symbol $S_{\\text{FOU}}(\\theta)$, we apply the operator to $T_i = \\exp(\\mathrm{i} i \\theta)$:\n$$\nD_{\\text{FOU}}[e^{\\mathrm{i} i \\theta}]_i = \\frac{e^{\\mathrm{i} i \\theta} - e^{\\mathrm{i} (i-1) \\theta}}{\\Delta x} = \\frac{e^{\\mathrm{i} i \\theta}(1 - e^{-\\mathrm{i}\\theta})}{\\Delta x}\n$$\nThus, the symbol is $S_{\\text{FOU}}(\\theta) = \\frac{1 - e^{-\\mathrm{i}\\theta}}{\\Delta x}$.\n\nThe modified wavenumber $k^\\ast_{\\text{FOU}}$ is:\n$$\nk^\\ast_{\\text{FOU}} = -\\mathrm{i} S_{\\text{FOU}}(\\theta) = -\\mathrm{i} \\frac{1 - e^{-\\mathrm{i}\\theta}}{\\Delta x} = -\\mathrm{i} \\frac{1 - (\\cos\\theta - \\mathrm{i}\\sin\\theta)}{\\Delta x} = \\frac{\\sin\\theta - \\mathrm{i}(1-\\cos\\theta)}{\\Delta x}\n$$\nThe real and imaginary parts are:\n$$\n\\operatorname{Re}(k^\\ast_{\\text{FOU}}) = \\frac{\\sin\\theta}{\\Delta x}\n$$\n$$\n\\operatorname{Im}(k^\\ast_{\\text{FOU}}) = -\\frac{1-\\cos\\theta}{\\Delta x}\n$$\nThe dissipation rate $\\sigma_{\\text{FOU}}$ is:\n$$\n\\sigma_{\\text{FOU}} = c \\operatorname{Im}(k^\\ast_{\\text{FOU}}) = -c \\frac{1-\\cos\\theta}{\\Delta x}\n$$\nSince $c > 0$ and $1-\\cos\\theta \\ge 0$, $\\sigma_{\\text{FOU}}$ is always non-positive, indicating that this scheme is dissipative.\n\n### Third-Order Upwind-biased (U3) Scheme\n\nThis scheme uses the stencil $\\{x_i, x_{i-1}, x_{i-2}, x_{i-3}\\}$ and aims for third-order accuracy. The approximation is\n$$\n\\frac{\\partial T}{\\partial x} \\bigg|_{x_i} \\approx \\frac{a_0 T_i + a_{-1} T_{i-1} + a_{-2} T_{i-2} + a_{-3} T_{i-3}}{\\Delta x}\n$$\nWe expand $T_{i-j}$ for $j=1, 2, 3$ and require the approximation to be exact for polynomials of degree up to $3$. This leads to a system of linear equations for the coefficients $a_j$:\n\\begin{align*}\n    a_0 + a_{-1} + a_{-2} + a_{-3} &= 0 \\\\\n    -(a_{-1} + 2a_{-2} + 3a_{-3}) &= 1 \\\\\n    a_{-1} + 4a_{-2} + 9a_{-3} &= 0 \\\\\n    a_{-1} + 8a_{-2} + 27a_{-3} &= 0\n\\end{align*}\nSolving this system yields the coefficients:\n$$\na_0 = \\frac{11}{6}, \\quad a_{-1} = -3, \\quad a_{-2} = \\frac{3}{2}, \\quad a_{-3} = -\\frac{1}{3}\n$$\nThe scheme is:\n$$\nD_{\\text{U3}}[T]_i = \\frac{1}{\\Delta x} \\left( \\frac{11}{6} T_i - 3 T_{i-1} + \\frac{3}{2} T_{i-2} - \\frac{1}{3} T_{i-3} \\right)\n$$\nTo find the symbol $S_{\\text{U3}}(\\theta)$, we apply the operator to $T_i = \\exp(\\mathrm{i} i \\theta)$:\n$$\nD_{\\text{U3}}[e^{\\mathrm{i} i \\theta}]_i = \\frac{e^{\\mathrm{i} i \\theta}}{\\Delta x} \\left( \\frac{11}{6} - 3 e^{-\\mathrm{i}\\theta} + \\frac{3}{2} e^{-2\\mathrm{i}\\theta} - \\frac{1}{3} e^{-3\\mathrm{i}\\theta} \\right)\n$$\nThe symbol is $S_{\\text{U3}}(\\theta) = \\frac{1}{\\Delta x} \\left( \\frac{11}{6} - 3 e^{-\\mathrm{i}\\theta} + \\frac{3}{2} e^{-2\\mathrm{i}\\theta} - \\frac{1}{3} e^{-3\\mathrm{i}\\theta} \\right)$.\n\nThe modified wavenumber $k^\\ast_{\\text{U3}}$ is:\n$$\nk^\\ast_{\\text{U3}} = -\\mathrm{i} S_{\\text{U3}}(\\theta) = -\\frac{\\mathrm{i}}{\\Delta x} \\left[ \\frac{11}{6} - 3\\cos\\theta + \\frac{3}{2}\\cos(2\\theta) - \\frac{1}{3}\\cos(3\\theta) + \\mathrm{i} \\left( 3\\sin\\theta - \\frac{3}{2}\\sin(2\\theta) + \\frac{1}{3}\\sin(3\\theta) \\right) \\right]\n$$\nSeparating the real and imaginary parts:\n$$\n\\operatorname{Re}(k^\\ast_{\\text{U3}}) = \\frac{1}{\\Delta x} \\left( 3\\sin\\theta - \\frac{3}{2}\\sin(2\\theta) + \\frac{1}{3}\\sin(3\\theta) \\right)\n$$\n$$\n\\operatorname{Im}(k^\\ast_{\\text{U3}}) = -\\frac{1}{\\Delta x} \\left( \\frac{11}{6} - 3\\cos\\theta + \\frac{3}{2}\\cos(2\\theta) - \\frac{1}{3}\\cos(3\\theta) \\right)\n$$\nThe dissipation rate $\\sigma_{\\text{U3}}$ is:\n$$\n\\sigma_{\\text{U3}} = c \\operatorname{Im}(k^\\ast_{\\text{U3}}) = -\\frac{c}{\\Delta x} \\left( \\frac{11}{6} - 3\\cos\\theta + \\frac{3}{2}\\cos(2\\theta) - \\frac{1}{3}\\cos(3\\theta) \\right)\n$$\nThe implementation will evaluate these formulas for the specified test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates modified wavenumber and dissipation rates for FOU and U3 schemes.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (delta_x, lambda, c)\n        (1000.0, 10000.0, 0.5),\n        (1000.0, 2000.0, 0.5),\n        (5000.0, 500000.0, 0.2),\n        (1000.0, 4000.0, 0.5),\n    ]\n\n    results = []\n    for dx, lam, c in test_cases:\n        # Calculate physical and dimensionless wavenumbers\n        k = 2 * np.pi / lam\n        theta = k * dx\n\n        # --- First-Order Upwind (FOU) Scheme ---\n        # Re(k*) = (1/dx) * sin(theta)\n        # Im(k*) = -(1/dx) * (1 - cos(theta))\n        # sigma = c * Im(k*)\n        \n        re_k_star_fou = (1 / dx) * np.sin(theta)\n        im_k_star_fou = -(1 / dx) * (1 - np.cos(theta))\n        sigma_fou = c * im_k_star_fou\n        \n        # --- Third-Order Upwind-Biased (U3) Scheme ---\n        # Re(k*) = (1/dx) * (3*sin(theta) - 1.5*sin(2*theta) + (1/3)*sin(3*theta))\n        # Im(k*) = -(1/dx) * (11/6 - 3*cos(theta) + 1.5*cos(2*theta) - (1/3)*cos(3*theta))\n        # sigma = c * Im(k*)\n\n        re_k_star_u3 = (1 / dx) * (\n            3 * np.sin(theta) - 1.5 * np.sin(2 * theta) + (1 / 3) * np.sin(3 * theta)\n        )\n        \n        im_k_star_u3 = -(1 / dx) * (\n            11 / 6\n            - 3 * np.cos(theta)\n            + 1.5 * np.cos(2 * theta)\n            - (1 / 3) * np.cos(3 * theta)\n        )\n        \n        sigma_u3 = c * im_k_star_u3\n        \n        # Collect results for the current case\n        case_result = [\n            re_k_star_fou, im_k_star_fou, sigma_fou,\n            re_k_star_u3, im_k_star_u3, sigma_u3\n        ]\n        results.append(case_result)\n\n    # Format the final output string as a list of lists, with each value\n    # rounded to 8 decimal places and no spaces within the sublists.\n    case_strings = []\n    for case_result in results:\n        # Format each float to 8 decimal places and join into a comma-separated string\n        s = \",\".join(f\"{val:.8f}\" for val in case_result)\n        case_strings.append(f\"[{s}]\")\n    \n    final_output = f\"[{','.join(case_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}