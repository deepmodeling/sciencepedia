{
    "hands_on_practices": [
        {
            "introduction": "The essence of achieving higher-than-first-order accuracy in finite volume methods lies in reconstructing a more detailed profile of the solution within each grid cell. A common choice is a piecewise-linear reconstruction, but this risks introducing new, non-physical oscillations near sharp gradients. This practice  delves into the core of the Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) approach: calculating interface states from a slope-limited linear profile, which is fundamental to building robust, high-order schemes that remain Total Variation Diminishing (TVD).",
            "id": "3794865",
            "problem": "Consider one-dimensional advection of a passive tracer in a uniform grid relevant to computational oceanography. Let the tracer field satisfy the conservation law $\\partial_{t} q + u\\,\\partial_{x} q = 0$ with constant velocity $u > 0$ and a uniform grid of spacing $\\Delta x$. A finite-volume method evolves cell averages $q_{i}(t)$ using numerical fluxes at cell interfaces $x_{i \\pm 1/2}$. To achieve second-order spatial accuracy while preserving monotonicity, use a piecewise-linear reconstruction in each cell with a slope limited by the minmod limiter. \n\nTasks:\n- Starting from the finite-volume integral form and a piecewise-linear reconstruction $q_{i}(x) \\approx q_{i} + s_{i} (x - x_{i})$, derive the second-order left and right interface states $q_{i+1/2}^{-}$ and $q_{i+1/2}^{+}$ in terms of the limited slopes $s_{i}$ and $s_{i+1}$ produced by the minmod limiter. Clearly state the algebraic definition of the minmod limiter you adopt and justify why the resulting scheme is Total Variation Diminishing (TVD), highlighting the role of the limiter in preventing new extrema.\n- From your expressions, deduce explicit conditions on the one-sided differences under which the minmod-limited slope becomes zero and the reconstruction degenerates to a first-order upwind method at an interface. State these conditions in terms of local discrete gradients.\n- Now evaluate the interface states at $x_{i+1/2}$ for the following data representing a nondimensional passive tracer: $\\Delta x = 10^{3}$, $u = 0.25$, $q_{i-1} = 1.00$, $q_{i} = 1.30$, $q_{i+1} = 1.45$, and $q_{i+2} = 1.20$. Use the minmod limiter with two arguments based on the backward and forward differences in each cell. Compute $q_{i+1/2}^{-}$ and $q_{i+1/2}^{+}$.\n\nReport as your final answer the numerical value of the left state $q_{i+1/2}^{-}$ for the given data. Round your answer to four significant figures.",
            "solution": "The problem considers the one-dimensional linear advection equation, $\\partial_{t} q + u\\,\\partial_{x} q = 0$, with a constant positive velocity $u > 0$, to be solved using a finite-volume method on a uniform grid with spacing $\\Delta x$. The method evolves cell averages $q_i$, where $q_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x, t) dx$. Integrating the advection equation over the cell $[x_{i-1/2}, x_{i+1/2}]$ gives:\n$$ \\frac{d q_i}{dt} + \\frac{1}{\\Delta x} [u q(x_{i+1/2}, t) - u q(x_{i-1/2}, t)] = 0 $$\nUsing numerical fluxes $F_{i\\pm 1/2}$ at the cell interfaces, this becomes $\\frac{d q_i}{dt} = -\\frac{1}{\\Delta x}(F_{i+1/2} - F_{i-1/2})$. For linear advection, the flux is $F(q) = uq$. Since $u > 0$, information propagates from left to right. An upwind scheme thus sets the flux at an interface to be determined by the state on the upwind (left) side. For the interface at $x_{i+1/2}$, the flux is $F_{i+1/2} = u q_{i+1/2}^{-}$, where $q_{i+1/2}^{-}$ is the value of the conserved variable $q$ at the interface, reconstructed from the data in the upwind cell $i$.\n\nThe problem specifies a piecewise-linear reconstruction of the solution within each cell $i$:\n$$ q(x) \\approx q_i + s_i(x - x_i) \\quad \\text{for } x \\in [x_{i-1/2}, x_{i+1/2}] $$\nHere, $q_i$ is the cell-average value, $x_i$ is the coordinate of the cell center, and $s_i$ is a limited slope.\n\nThe left state at interface $x_{i+1/2}$, denoted $q_{i+1/2}^{-}$, is obtained by evaluating the reconstruction from cell $i$ at the location $x=x_{i+1/2}$. The cell interface is located at a distance of $\\Delta x/2$ from the cell center, so $x_{i+1/2} = x_i + \\Delta x/2$:\n$$ q_{i+1/2}^{-} = q_i + s_i(x_{i+1/2} - x_i) = q_i + s_i \\frac{\\Delta x}{2} $$\nThe right state at the same interface, $q_{i+1/2}^{+}$, is obtained by evaluating the reconstruction from cell $i+1$ at $x=x_{i+1/2}$. The same location is at a distance of $-\\Delta x/2$ from the center of cell $i+1$, so $x_{i+1/2} = x_{i+1} - \\Delta x/2$:\n$$ q_{i+1/2}^{+} = q_{i+1} + s_{i+1}(x_{i+1/2} - x_{i+1}) = q_{i+1} - s_{i+1} \\frac{\\Delta x}{2} $$\nThese expressions give the interface states in terms of the limited slopes $s_i$ and $s_{i+1}$.\n\nThe slope $s_i$ for cell $i$ is limited using the minmod limiter, which takes as arguments the backward and forward difference gradients. The algebraic definition of the minmod function is:\n$$ \\text{minmod}(a, b) = \\begin{cases} \\text{sgn}(a) \\min(|a|, |b|) & \\text{if } ab > 0 \\\\ 0 & \\text{if } ab \\le 0 \\end{cases} $$\nThe arguments are the gradients, so the limited slope $s_i$ is:\n$$ s_i = \\text{minmod}\\left(\\frac{q_i - q_{i-1}}{\\Delta x}, \\frac{q_{i+1} - q_i}{\\Delta x}\\right) $$\nA scheme is Total Variation Diminishing (TVD) if it does not create new local extrema in the solution. This property is ensured if the reconstructed values at the interfaces are bounded by the cell averages of the two adjacent cells. The minmod limiter achieves this. If the data is monotonic around cell $i$ (e.g., $q_{i-1} \\le q_i \\le q_{i+1}$), the signs of the forward and backward differences are the same. The limited slope $s_i$ will be the smaller of the two gradients, ensuring that the reconstructed line does not \"overshoot\" the neighboring cell averages. Specifically, one can show that $q_i \\le q_{i+1/2}^{-} \\le q_{i+1}$. If the data is not monotonic (i.e., $q_i$ is a local extremum), the signs of the differences are opposite, causing the minmod limiter to return a slope of zero. This locally reduces the scheme to first-order accuracy, preventing the growth of spurious oscillations. This mechanism of preventing new extrema is the reason the scheme is TVD.\n\nThe scheme degenerates to a first-order upwind method if the slope used for the upwind reconstruction is zero. For the flux $F_{i+1/2}$, this occurs when $s_i=0$. From the definition of the minmod function, the slope $s_i$ is zero if and only if the arguments have different signs or one of them is zero. This condition, in terms of the one-sided differences $\\delta_b = q_i - q_{i-1}$ and $\\delta_f = q_{i+1} - q_i$, is $\\delta_b \\delta_f \\le 0$. In terms of local discrete gradients, the condition is:\n$$ \\left(\\frac{q_i - q_{i-1}}{\\Delta x}\\right) \\left(\\frac{q_{i+1} - q_i}{\\Delta x}\\right) \\le 0 $$\nThis inequality holds when $q_i$ is a local maximum or minimum relative to its neighbors $q_{i-1}$ and $q_{i+1}$.\n\nWe now apply these formulas to the given data: $\\Delta x = 10^3$, $u = 0.25$, $q_{i-1} = 1.00$, $q_{i} = 1.30$, $q_{i+1} = 1.45$, and $q_{i+2} = 1.20$.\n\nThe task is to find the left state at the interface $x_{i+1/2}$, which is $q_{i+1/2}^{-}$. First, we compute the limited slope $s_i$ for cell $i$. The two arguments for the minmod limiter are the backward and forward difference gradients:\n$$ \\text{Backward gradient} = \\frac{q_i - q_{i-1}}{\\Delta x} = \\frac{1.30 - 1.00}{10^3} = \\frac{0.30}{1000} = 3.0 \\times 10^{-4} $$\n$$ \\text{Forward gradient} = \\frac{q_{i+1} - q_i}{\\Delta x} = \\frac{1.45 - 1.30}{10^3} = \\frac{0.15}{1000} = 1.5 \\times 10^{-4} $$\nBoth gradients are positive. The minmod function will return the value with the smaller magnitude:\n$$ s_i = \\text{minmod}(3.0 \\times 10^{-4}, 1.5 \\times 10^{-4}) = 1.5 \\times 10^{-4} $$\nNow, we can calculate the left interface state $q_{i+1/2}^{-}$:\n$$ q_{i+1/2}^{-} = q_i + s_i \\frac{\\Delta x}{2} = 1.30 + (1.5 \\times 10^{-4}) \\times \\frac{10^3}{2} $$\n$$ q_{i+1/2}^{-} = 1.30 + (1.5 \\times 10^{-4}) \\times 500 $$\n$$ q_{i+1/2}^{-} = 1.30 + 0.075 $$\n$$ q_{i+1/2}^{-} = 1.375 $$\nThe value is $1.375$. The problem requests the answer to be rounded to four significant figures. The number $1.375$ already has exactly four significant figures, so no further rounding is needed.",
            "answer": "$$\\boxed{1.375}$$"
        },
        {
            "introduction": "Building upon the concept of interface reconstruction, this exercise  assembles the components to perform a complete time-step update. You will apply the MUSCL methodology to compute fluxes across cell boundaries and advance the cell-averaged solution in time. This practice emphasizes the practical application of the method within a small domain and introduces the critical task of handling inflow and outflow boundary conditions, a ubiquitous challenge in computational modeling.",
            "id": "3794851",
            "problem": "Consider the one-dimensional linear advection of a passive tracer concentration field governed by the conservation law $\\partial C / \\partial t + \\partial(uC) / \\partial x = 0$ on a uniform grid of $N = 5$ finite-volume cells indexed by $i = 1, 2, 3, 4, 5$ with cell width $\\Delta x = 1000\\,\\mathrm{m}$. The constant velocity is $u = 0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ directed from left to right, and the time step is $\\Delta t = 600\\,\\mathrm{s}$. The initial cell-averaged concentrations at time level $n$ are given by\n$C_1^n = 1.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $C_2^n = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $C_3^n = 1.4\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $C_4^n = 1.6\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and $C_5^n = 1.8\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$. The left boundary at $x = 0$ is an inflow with prescribed Dirichlet value $C_{\\mathrm{in}} = 2.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and the right boundary is an outflow with zero-gradient closure.\n\nUsing a conservative finite-volume method with second-order spatial reconstruction via a flux-limited Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) approach, compute the limited interface states at each internal face $x_{i+1/2}$ and the boundary fluxes consistent with an upwind Godunov flux for linear advection. Use the Total Variation Diminishing (TVD) minmod slope limiter defined by\n$\\operatorname{minmod}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|), & \\text{if } a\\,b > 0,\\\\\n0, & \\text{otherwise}.\n\\end{cases}$\nFor the outflow boundary closure, adopt a zero-gradient ghost cell equal to the last interior value.\n\nThen, perform one explicit Euler time update of the cell averages. Report the updated concentration in cell $i=3$, namely $C_3^{n+1}$, after one time step. Round your answer to four significant figures and express it in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$.",
            "solution": "The evolution of the cell-averaged concentration $C_i$ in a finite volume cell $i$ is governed by the conservation law in discrete form:\n$$\nC_i^{n+1} = C_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\nwhere $C_i^n$ is the concentration in cell $i$ at time level $n$, $\\Delta t$ is the time step, $\\Delta x$ is the cell width, and $F_{i\\pm1/2}$ are the numerical fluxes at the cell interfaces.\n\nThe Courant number, $c$, is a dimensionless quantity representing the fraction of a cell that the fluid travels in one time step:\n$$\nc = \\frac{u \\Delta t}{\\Delta x} = \\frac{(0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (600\\,\\mathrm{s})}{1000\\,\\mathrm{m}} = \\frac{300}{1000} = 0.3\n$$\nThe update equation can be written as:\n$$\nC_i^{n+1} = C_i^n - \\frac{c}{u} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\nFor linear advection with constant velocity $u > 0$, the upwind Godunov flux at an interface is determined by the tracer concentration on the left (upwind) side of the interface. The flux at interface $x_{i+1/2}$ is $F_{i+1/2} = u C_{i+1/2}^L$, where $C_{i+1/2}^L$ is the reconstructed concentration value at the left side of the interface.\n\nThe MUSCL scheme provides a second-order accurate reconstruction of the interface values from the cell averages. The value on the left side of the interface $x_{i+1/2}$ (which is the right edge of cell $i$) is reconstructed as:\n$$\nC_{i+1/2}^L = C_i^n + \\frac{1}{2} \\sigma_i\n$$\nHere, $\\sigma_i$ is the limited difference of the concentration profile within cell $i$. The difference is calculated using the provided `minmod` limiter to ensure the scheme is Total Variation Diminishing (TVD). The arguments to the `minmod` function are the backward and forward differences:\n$$\n\\sigma_i = \\operatorname{minmod}(C_i^n - C_{i-1}^n, C_{i+1}^n - C_i^n)\n$$\nThe problem asks for the updated concentration in cell $i=3$, $C_3^{n+1}$. The specific update formula is:\n$$\nC_3^{n+1} = C_3^n - \\frac{\\Delta t}{\\Delta x} (F_{3+1/2} - F_{2+1/2}) = C_3^n - c (C_{3+1/2}^L - C_{2+1/2}^L)\n$$\nThis requires the calculation of the limited differences $\\sigma_2$ and $\\sigma_3$ to determine the interface states $C_{2+1/2}^L$ and $C_{3+1/2}^L$.\n\n1.  **Calculate the limited difference in cell $i=2$, $\\sigma_2$**:\n    The neighboring concentrations are $C_1^n=1.0$, $C_2^n=1.2$, and $C_3^n=1.4$.\n    The backward difference is $a = C_2^n - C_1^n = 1.2 - 1.0 = 0.2$.\n    The forward difference is $b = C_3^n - C_2^n = 1.4 - 1.2 = 0.2$.\n    Since $a \\cdot b = (0.2)(0.2) = 0.04 > 0$, we apply the `minmod` function:\n    $$\n    \\sigma_2 = \\operatorname{minmod}(0.2, 0.2) = \\operatorname{sign}(0.2) \\min(|0.2|, |0.2|) = 1 \\times 0.2 = 0.2\n    $$\n\n2.  **Calculate the limited difference in cell $i=3$, $\\sigma_3$**:\n    The neighboring concentrations are $C_2^n=1.2$, $C_3^n=1.4$, and $C_4^n=1.6$.\n    The backward difference is $a = C_3^n - C_2^n = 1.4 - 1.2 = 0.2$.\n    The forward difference is $b = C_4^n - C_3^n = 1.6 - 1.4 = 0.2$.\n    Since $a \\cdot b = (0.2)(0.2) = 0.04 > 0$, the difference is:\n    $$\n    \\sigma_3 = \\operatorname{minmod}(0.2, 0.2) = \\operatorname{sign}(0.2) \\min(|0.2|, |0.2|) = 1 \\times 0.2 = 0.2\n    $$\n\n3.  **Compute the limited interface states**:\n    The interface state at $x_{2+1/2}$ is reconstructed from cell $2$:\n    $$\n    C_{2+1/2}^L = C_2^n + \\frac{1}{2} \\sigma_2 = 1.2 + \\frac{1}{2}(0.2) = 1.2 + 0.1 = 1.3\n    $$\n    The interface state at $x_{3+1/2}$ is reconstructed from cell $3$:\n    $$\n    C_{3+1/2}^L = C_3^n + \\frac{1}{2} \\sigma_3 = 1.4 + \\frac{1}{2}(0.2) = 1.4 + 0.1 = 1.5\n    $$\n\n4.  **Perform the time update for cell $i=3$**:\n    Now substitute all the calculated values into the update equation for $C_3^{n+1}$:\n    $$\n    C_3^{n+1} = C_3^n - c (C_{3+1/2}^L - C_{2+1/2}^L)\n    $$\n    $$\n    C_3^{n+1} = 1.4 - 0.3 \\times (1.5 - 1.3)\n    $$\n    $$\n    C_3^{n+1} = 1.4 - 0.3 \\times (0.2)\n    $$\n    $$\n    C_3^{n+1} = 1.4 - 0.06\n    $$\n    $$\n    C_3^{n+1} = 1.34\n    $$\n\nThe problem requires the answer to be rounded to four significant figures. This gives $1.340$. The result has units of $\\mathrm{kg}\\,\\mathrm{m}^{-3}$.",
            "answer": "$$\n\\boxed{1.340}\n$$"
        },
        {
            "introduction": "Flux-Corrected Transport (FCT) offers a conceptually different, yet equally powerful, framework for creating high-resolution, monotone advection schemes. Instead of limiting slopes within a reconstruction, FCT operates by correcting a diffusive, low-order flux with a limited portion of a high-order \"antidiffusive\" flux. This practice  provides a detailed, step-by-step walkthrough of the FCT algorithm, revealing how to enforce physical bounds by carefully limiting these corrective fluxes to prevent over- and undershoots.",
            "id": "3794841",
            "problem": "Consider one-dimensional advection of a nondimensional tracer concentration $q$ governed by the conservation law $\\partial q / \\partial t + \\partial (u q) / \\partial x = 0$ on a uniform grid of four control volumes with periodic boundary conditions. The grid spacing is $\\Delta x = 1$ and the constant velocity is $u = 1$. The time step is $\\Delta t = 0.5$, so the Courant number is $\\nu = u \\Delta t / \\Delta x = 0.5$. The initial cell-averaged values at time level $n$ are $q^{n} = [q_{1}^{n}, q_{2}^{n}, q_{3}^{n}, q_{4}^{n}] = [0, 1, 0.2, 0.8]$, with periodic indexing (so $q_{0}^{n} \\equiv q_{4}^{n}$ and $q_{5}^{n} \\equiv q_{1}^{n}$).\n\nYou will apply Flux-Corrected Transport (FCT), defined as follows. Use the donor-cell (upwind) low-order numerical flux for $u>0$: $F^{L}_{i+1/2} = u\\,q_{i}^{n}$. Use the second-order Lax–Wendroff high-order numerical flux: $F^{H}_{i+1/2} = u\\left[q_{i}^{n} + \\tfrac{1}{2}(1-\\nu)\\left(q_{i+1}^{n} - q_{i}^{n}\\right)\\right]$. Define the raw antidiffusive flux $A_{i+1/2} = F^{H}_{i+1/2} - F^{L}_{i+1/2}$. Compute the provisional low-order update $q_{i}^{L} = q_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F^{L}_{i+1/2} - F^{L}_{i-1/2}\\right)$.\n\nAssume known global physical bounds for the tracer, $q_{\\min} = 0$ and $q_{\\max} = 1$, applicable to every cell. With these bounds, construct the Zalesak-type flux limiter in one dimension as follows. For each cell $i$, define the allowable positive and negative “antidiffusive inflow capacities”\n$P_{i}^{+} = (q_{\\max} - q_{i}^{L})\\,\\Delta x / \\Delta t$ and $P_{i}^{-} = (q_{\\min} - q_{i}^{L})\\,\\Delta x / \\Delta t$. Define the incoming antidiffusive flux sums\n$S_{i}^{+} = \\max\\{0, A_{i-1/2}\\} + \\max\\{0, -A_{i+1/2}\\}$ and $S_{i}^{-} = \\min\\{0, A_{i-1/2}\\} + \\min\\{0, -A_{i+1/2}\\}$. Then set the cell-based limiting factors\n$R_{i}^{+} = \\min\\{1, P_{i}^{+}/S_{i}^{+}\\}$ if $S_{i}^{+} > 0$ and $R_{i}^{+} = 1$ otherwise; $R_{i}^{-} = \\min\\{1, P_{i}^{-}/S_{i}^{-}\\}$ if $S_{i}^{-} < 0$ and $R_{i}^{-} = 1$ otherwise. The face-based limiter is\n$\\alpha_{i+1/2} = \\min\\{R_{i}^{+}, R_{i+1}^{-}\\}$ if $A_{i+1/2} > 0$, and $\\alpha_{i+1/2} = \\min\\{R_{i}^{-}, R_{i+1}^{+}\\}$ if $A_{i+1/2} < 0$, while $\\alpha_{i+1/2} = 1$ if $A_{i+1/2} = 0$. The limited antidiffusive flux is $\\widetilde{A}_{i+1/2} = \\alpha_{i+1/2} A_{i+1/2}$, and the corrected update is $q_{i}^{n+1} = q_{i}^{L} - \\frac{\\Delta t}{\\Delta x}\\left(\\widetilde{A}_{i+1/2} - \\widetilde{A}_{i-1/2}\\right)$.\n\nCompute the limited antidiffusive fluxes $\\widetilde{A}_{i+1/2}$ at all faces and the corrected cell averages $q_{i}^{n+1}$ after one time step. As your final answer, report the corrected cell average in cell $i=3$, $q_{3}^{n+1}$, rounded to six significant figures. Express your answer as a nondimensional number.",
            "solution": "We begin from the conservative advection equation $\\partial q / \\partial t + \\partial (u q) / \\partial x = 0$ discretized in finite-volume form. The Flux-Corrected Transport (FCT) method blends a low-order, monotone scheme with a high-order, low-dissipation scheme via limited antidiffusive fluxes so that the corrected solution honors the physical bounds.\n\nGiven $u = 1$, $\\Delta x = 1$, and $\\Delta t = 0.5$, the Courant number is $\\nu = u \\Delta t / \\Delta x = 0.5$. Periodicity implies $q_{0}^{n} \\equiv q_{4}^{n}$ and $q_{5}^{n} \\equiv q_{1}^{n}$. The initial data are $q_{1}^{n} = 0$, $q_{2}^{n} = 1$, $q_{3}^{n} = 0.2$, $q_{4}^{n} = 0.8$.\n\n1) Low-order fluxes and provisional update. For $u > 0$, the donor-cell (upwind) flux is\n$F^{L}_{i+1/2} = u q_{i}^{n} = q_{i}^{n}$.\nThus,\n$F^{L}_{1+1/2} = q_{1}^{n} = 0$, $F^{L}_{2+1/2} = q_{2}^{n} = 1$, $F^{L}_{3+1/2} = q_{3}^{n} = 0.2$, $F^{L}_{4+1/2} = q_{4}^{n} = 0.8$.\nThe low-order update is $q_{i}^{L} = q_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F^{L}_{i+1/2} - F^{L}_{i-1/2}\\right)$. With $F^{L}_{i+1/2} = u q_i^n$ and $\\nu = u \\Delta t / \\Delta x$, this becomes $q_{i}^{L} = q_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(u q_{i}^{n} - u q_{i-1}^{n}\\right) = q_{i}^{n} - \\nu\\left(q_{i}^{n} - q_{i-1}^{n}\\right) = (1-\\nu) q_{i}^{n} + \\nu q_{i-1}^{n}$.\nWith $\\nu = 0.5$, we have $q_{i}^{L} = 0.5 q_{i}^{n} + 0.5 q_{i-1}^{n}$.\nTherefore,\n- $q_{1}^{L} = 0.5 q_{1}^{n} + 0.5 q_{4}^{n} = 0.5 \\cdot 0 + 0.5 \\cdot 0.8 = 0.4$,\n- $q_{2}^{L} = 0.5 q_{2}^{n} + 0.5 q_{1}^{n} = 0.5 \\cdot 1 + 0.5 \\cdot 0 = 0.5$,\n- $q_{3}^{L} = 0.5 q_{3}^{n} + 0.5 q_{2}^{n} = 0.5 \\cdot 0.2 + 0.5 \\cdot 1 = 0.1 + 0.5 = 0.6$,\n- $q_{4}^{L} = 0.5 q_{4}^{n} + 0.5 q_{3}^{n} = 0.5 \\cdot 0.8 + 0.5 \\cdot 0.2 = 0.4 + 0.1 = 0.5$.\n\n2) High-order fluxes and raw antidiffusive fluxes. The Lax–Wendroff flux is\n$F^{H}_{i+1/2} = u\\left[q_{i}^{n} + \\tfrac{1}{2}(1-\\nu)\\left(q_{i+1}^{n} - q_{i}^{n}\\right)\\right]$.\nWith $u = 1$ and $\\nu = 0.5$, we have $\\tfrac{1}{2}(1-\\nu) = \\tfrac{1}{2} \\cdot 0.5 = 0.25$, so\n$F^{H}_{i+1/2} = q_{i}^{n} + 0.25 \\left(q_{i+1}^{n} - q_{i}^{n}\\right) = 0.75 q_{i}^{n} + 0.25 q_{i+1}^{n}$.\nThus,\n- $F^{H}_{1+1/2} = 0.75 q_{1}^{n} + 0.25 q_{2}^{n} = 0.75 \\cdot 0 + 0.25 \\cdot 1 = 0.25$,\n- $F^{H}_{2+1/2} = 0.75 q_{2}^{n} + 0.25 q_{3}^{n} = 0.75 \\cdot 1 + 0.25 \\cdot 0.2 = 0.75 + 0.05 = 0.8$,\n- $F^{H}_{3+1/2} = 0.75 q_{3}^{n} + 0.25 q_{4}^{n} = 0.75 \\cdot 0.2 + 0.25 \\cdot 0.8 = 0.15 + 0.2 = 0.35$,\n- $F^{H}_{4+1/2} = 0.75 q_{4}^{n} + 0.25 q_{5}^{n} = 0.75 \\cdot 0.8 + 0.25 \\cdot 0 = 0.6$.\nThe raw antidiffusive fluxes $A_{i+1/2} = F^{H}_{i+1/2} - F^{L}_{i+1/2}$ are\n- $A_{1+1/2} = 0.25 - 0 = 0.25$,\n- $A_{2+1/2} = 0.8 - 1 = -0.2$,\n- $A_{3+1/2} = 0.35 - 0.2 = 0.15$,\n- $A_{4+1/2} = 0.6 - 0.8 = -0.2$.\n\n3) Bounds, capacities, and incoming sums. The global bounds are $q_{\\min} = 0$ and $q_{\\max} = 1$. The capacity factors use $\\Delta x / \\Delta t = 1 / 0.5 = 2$:\n- $P_{i}^{+} = (q_{\\max} - q_{i}^{L}) \\cdot 2$, and $P_{i}^{-} = (q_{\\min} - q_{i}^{L}) \\cdot 2 = -2 q_{i}^{L}$.\nHence\n- $P_{1}^{+} = (1 - 0.4) \\cdot 2 = 1.2$, $P_{1}^{-} = -2 \\cdot 0.4 = -0.8$,\n- $P_{2}^{+} = (1 - 0.5) \\cdot 2 = 1.0$, $P_{2}^{-} = -2 \\cdot 0.5 = -1.0$,\n- $P_{3}^{+} = (1 - 0.6) \\cdot 2 = 0.8$, $P_{3}^{-} = -2 \\cdot 0.6 = -1.2$,\n- $P_{4}^{+} = (1 - 0.5) \\cdot 2 = 1.0$, $P_{4}^{-} = -2 \\cdot 0.5 = -1.0$.\n\nThe incoming sums for each cell $i$ use $A_{i-1/2}$ from the left face and $-A_{i+1/2}$ from the right face:\n$S_{i}^{+} = \\max\\{0, A_{i-1/2}\\} + \\max\\{0, -A_{i+1/2}\\}$ and $S_{i}^{-} = \\min\\{0, A_{i-1/2}\\} + \\min\\{0, -A_{i+1/2}\\}$.\nWith periodicity, $A_{1-1/2} = A_{4+1/2}$.\nCompute:\n- Cell $i=1$: $A_{1-1/2} = A_{4+1/2} = -0.2$, $-A_{1+1/2} = -0.25$.\nThen $S_{1}^{+} = \\max\\{0, -0.2\\} + \\max\\{0, -0.25\\} = 0 + 0 = 0$, and $S_{1}^{-} = \\min\\{0, -0.2\\} + \\min\\{0, -0.25\\} = -0.2 + (-0.25) = -0.45$.\n- Cell $i=2$: $A_{2-1/2} = A_{1+1/2} = 0.25$, $-A_{2+1/2} = -(-0.2) = 0.2$.\nThen $S_{2}^{+} = \\max\\{0, 0.25\\} + \\max\\{0, 0.2\\} = 0.25 + 0.2 = 0.45$, and $S_{2}^{-} = \\min\\{0, 0.25\\} + \\min\\{0, 0.2\\} = 0 + 0 = 0$.\n- Cell $i=3$: $A_{3-1/2} = A_{2+1/2} = -0.2$, $-A_{3+1/2} = -0.15$.\nThen $S_{3}^{+} = \\max\\{0, -0.2\\} + \\max\\{0, -0.15\\} = 0 + 0 = 0$, and $S_{3}^{-} = \\min\\{0, -0.2\\} + \\min\\{0, -0.15\\} = -0.2 + (-0.15) = -0.35$.\n- Cell $i=4$: $A_{4-1/2} = A_{3+1/2} = 0.15$, $-A_{4+1/2} = -(-0.2) = 0.2$.\nThen $S_{4}^{+} = \\max\\{0, 0.15\\} + \\max\\{0, 0.2\\} = 0.15 + 0.2 = 0.35$, and $S_{4}^{-} = \\min\\{0, 0.15\\} + \\min\\{0, 0.2\\} = 0 + 0 = 0$.\n\n4) Cell-based limiting factors. Using the rules, if $S_{i}^{+} = 0$ then $R_{i}^{+} = 1$, and if $S_{i}^{-} = 0$ then $R_{i}^{-} = 1$. Otherwise use the ratios:\n- Cell $i=1$: $S_{1}^{+} = 0 \\Rightarrow R_{1}^{+} = 1$; $S_{1}^{-} = -0.45$, so $R_{1}^{-} = \\min\\{1, P_{1}^{-}/S_{1}^{-}\\} = \\min\\{1, (-0.8)/(-0.45)\\} = \\min\\{1, 1.777\\ldots\\} = 1$.\n- Cell $i=2$: $S_{2}^{+} = 0.45$, so $R_{2}^{+} = \\min\\{1, 1.0/0.45\\} = 1$; $S_{2}^{-} = 0 \\Rightarrow R_{2}^{-} = 1$.\n- Cell $i=3$: $S_{3}^{+} = 0 \\Rightarrow R_{3}^{+} = 1$; $S_{3}^{-} = -0.35$, so $R_{3}^{-} = \\min\\{1, (-1.2)/(-0.35)\\} = 1$.\n- Cell $i=4$: $S_{4}^{+} = 0.35$, so $R_{4}^{+} = \\min\\{1, 1.0/0.35\\} = 1$; $S_{4}^{-} = 0 \\Rightarrow R_{4}^{-} = 1$.\n\nThus all cell factors are unity: $R_{i}^{+} = R_{i}^{-} = 1$ for all $i$.\n\n5) Face-based limiter and limited antidiffusive fluxes. For each face:\n- If $A_{i+1/2} > 0$, $\\alpha_{i+1/2} = \\min\\{R_{i}^{+}, R_{i+1}^{-}\\} = \\min\\{1, 1\\} = 1$.\n- If $A_{i+1/2} < 0$, $\\alpha_{i+1/2} = \\min\\{R_{i}^{-}, R_{i+1}^{+}\\} = \\min\\{1, 1\\} = 1$.\nTherefore, $\\alpha_{i+1/2} = 1$ at all faces, and the limited antidiffusive fluxes equal the raw ones:\n$\\widetilde{A}_{1+1/2} = 0.25$, $\\widetilde{A}_{2+1/2} = -0.2$, $\\widetilde{A}_{3+1/2} = 0.15$, $\\widetilde{A}_{4+1/2} = -0.2$.\n\n6) Corrected update. The final corrected solution is $q_{i}^{n+1} = q_{i}^{L} - \\frac{\\Delta t}{\\Delta x}\\left(\\widetilde{A}_{i+1/2} - \\widetilde{A}_{i-1/2}\\right)$. With $\\Delta t / \\Delta x = 0.5 / 1 = 0.5$, we have:\n- $q_{1}^{n+1} = 0.4 - 0.5\\left(0.25 - (-0.2)\\right) = 0.4 - 0.5 \\cdot 0.45 = 0.4 - 0.225 = 0.175$,\n- $q_{2}^{n+1} = 0.5 - 0.5\\left((-0.2) - 0.25\\right) = 0.5 - 0.5 \\cdot (-0.45) = 0.5 + 0.225 = 0.725$,\n- $q_{3}^{n+1} = 0.6 - 0.5\\left(0.15 - (-0.2)\\right) = 0.6 - 0.5 \\cdot 0.35 = 0.6 - 0.175 = 0.425$,\n- $q_{4}^{n+1} = 0.5 - 0.5\\left((-0.2) - 0.15\\right) = 0.5 - 0.5 \\cdot (-0.35) = 0.5 + 0.175 = 0.675$.\n\nThe requested quantity is $q_{3}^{n+1} = 0.425$. Rounded to six significant figures, this is $0.425000$.",
            "answer": "$$\\boxed{0.425000}$$"
        }
    ]
}