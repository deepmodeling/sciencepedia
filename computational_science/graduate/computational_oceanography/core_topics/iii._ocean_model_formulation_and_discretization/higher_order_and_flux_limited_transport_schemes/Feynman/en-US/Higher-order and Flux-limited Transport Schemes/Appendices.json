{
    "hands_on_practices": [
        {
            "introduction": "Higher-order schemes achieve accuracy by reconstructing a sub-grid distribution of the tracer field, but this can create spurious oscillations near sharp gradients. Slope limiters are essential tools that constrain these reconstructions to preserve monotonicity, forming the basis of Total Variation Diminishing (TVD) schemes. This exercise provides direct, hands-on practice in calculating a limited slope using the `minmod` function and finding the resulting interface values, which are the fundamental building blocks of modern transport methods .",
            "id": "3794861",
            "problem": "Consider one-dimensional advection of a passive tracer field governed by the conservation law $\\partial_t q + \\partial_x (u q) = 0$ with constant velocity $u > 0$. A finite volume method on a uniform grid with spacing $\\Delta x$ represents the tracer field by cell averages $\\bar{q}_j$ over cells centered at $x_j$. To achieve second-order spatial accuracy while preserving nonlinear stability in the sense of total variation diminishing (TVD), a piecewise linear reconstruction is performed in each cell with a slope that is limited by the classical minmod flux limiter applied to one-sided discrete gradients formed from neighboring cell averages. The reconstructed interface values at $x_{i \\pm 1/2}$ are defined consistently with this piecewise linear reconstruction. \n\nFor the specific data $\\bar{q}_{i-1} = 1.0$, $\\bar{q}_i = 1.5$, and $\\bar{q}_{i+1} = 2.0$, determine the minmod-limited slope in cell $i$ and the corresponding reconstructed values at the left and right interfaces $x_{i-1/2}$ and $x_{i+1/2}$. Express the slope symbolically in terms of $\\Delta x$, and provide the two interface values as exact numbers. Do not assume any particular numerical value for $\\Delta x$.\n\nExpress your final answer as a row matrix containing, in order, the limited slope in cell $i$, the reconstructed value at $x_{i-1/2}$ traced from cell $i$, and the reconstructed value at $x_{i+1/2}$ traced from cell $i$. No rounding is required, and no units are needed.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It provides a standard exercise in the application of finite volume methods for hyperbolic conservation laws, a core topic in computational science and engineering. All necessary data are provided, the terminology is precise, and the question is formally solvable. Therefore, the problem is valid, and a solution will be provided.\n\nThe problem requires the determination of a limited slope and reconstructed interface values for a piecewise linear finite volume scheme. The tracer field $q(x)$ within cell $i$, which spans the interval $[x_i - \\frac{\\Delta x}{2}, x_i + \\frac{\\Delta x}{2}]$, is approximated by a linear function:\n$$q_i(x) = \\bar{q}_i + \\sigma_i (x - x_i)$$\nwhere $\\bar{q}_i$ is the cell-averaged value of the tracer, $x_i$ is the cell center, and $\\sigma_i$ is the limited slope of the tracer distribution in cell $i$.\n\nTo ensure the scheme is total variation diminishing (TVD), the slope $\\sigma_i$ is limited. The problem specifies the use of the classical minmod limiter applied to one-sided discrete gradients. These gradients are the backward and forward difference slopes, which are calculated using the cell averages of the neighboring cells.\n\nThe backward difference slope, $\\sigma_i^B$, is given by:\n$$\\sigma_i^B = \\frac{\\bar{q}_i - \\bar{q}_{i-1}}{\\Delta x}$$\nThe forward difference slope, $\\sigma_i^F$, is given by:\n$$\\sigma_i^F = \\frac{\\bar{q}_{i+1} - \\bar{q}_i}{\\Delta x}$$\n\nThe given cell-average values are $\\bar{q}_{i-1} = 1.0$, $\\bar{q}_i = 1.5$, and $\\bar{q}_{i+1} = 2.0$. For clarity and precision, we convert these to fractions: $\\bar{q}_{i-1} = 1$, $\\bar{q}_i = \\frac{3}{2}$, and $\\bar{q}_{i+1} = 2$.\n\nWe can now compute the one-sided slopes:\n$$\\sigma_i^B = \\frac{\\frac{3}{2} - 1}{\\Delta x} = \\frac{\\frac{1}{2}}{\\Delta x} = \\frac{1}{2\\Delta x}$$\n$$\\sigma_i^F = \\frac{2 - \\frac{3}{2}}{\\Delta x} = \\frac{\\frac{1}{2}}{\\Delta x} = \\frac{1}{2\\Delta x}$$\n\nThe limited slope $\\sigma_i$ is obtained by applying the minmod function to these two slopes:\n$$\\sigma_i = \\text{minmod}(\\sigma_i^B, \\sigma_i^F)$$\nThe minmod function is defined as:\n$$\\text{minmod}(a, b) = \\begin{cases} \\min(|a|, |b|) & \\text{if } \\text{sgn}(a) = \\text{sgn}(b) \\\\ 0 & \\text{if } \\text{sgn}(a) \\neq \\text{sgn}(b) \\end{cases}$$\nIn this case, both arguments $\\sigma_i^B$ and $\\sigma_i^F$ are equal and positive. Therefore, the minmod function returns their common value:\n$$\\sigma_i = \\text{minmod}\\left(\\frac{1}{2\\Delta x}, \\frac{1}{2\\Delta x}\\right) = \\frac{1}{2\\Delta x}$$\nThis is the minmod-limited slope in cell $i$, expressed symbolically in terms of $\\Delta x$.\n\nNext, we determine the reconstructed values at the cell interfaces $x_{i-1/2}$ and $x_{i+1/2}$. These interfaces are located at $x_{i-1/2} = x_i - \\frac{\\Delta x}{2}$ and $x_{i+1/2} = x_i + \\frac{\\Delta x}{2}$. The reconstructed values are found by evaluating the linear function $q_i(x)$ at these points.\n\nThe reconstructed value at the left interface, $x_{i-1/2}$, traced from cell $i$, is denoted $q_{i,L}$:\n$$q_{i,L} = q_i(x_{i-1/2}) = \\bar{q}_i + \\sigma_i \\left( (x_i - \\frac{\\Delta x}{2}) - x_i \\right) = \\bar{q}_i - \\sigma_i \\frac{\\Delta x}{2}$$\nSubstituting the values for $\\bar{q}_i$ and $\\sigma_i$:\n$$q_{i,L} = \\frac{3}{2} - \\left(\\frac{1}{2\\Delta x}\\right) \\frac{\\Delta x}{2} = \\frac{3}{2} - \\frac{1}{4} = \\frac{6}{4} - \\frac{1}{4} = \\frac{5}{4}$$\n\nThe reconstructed value at the right interface, $x_{i+1/2}$, traced from cell $i$, is denoted $q_{i,R}$:\n$$q_{i,R} = q_i(x_{i+1/2}) = \\bar{q}_i + \\sigma_i \\left( (x_i + \\frac{\\Delta x}{2}) - x_i \\right) = \\bar{q}_i + \\sigma_i \\frac{\\Delta x}{2}$$\nSubstituting the values for $\\bar{q}_i$ and $\\sigma_i$:\n$$q_{i,R} = \\frac{3}{2} + \\left(\\frac{1}{2\\Delta x}\\right) \\frac{\\Delta x}{2} = \\frac{3}{2} + \\frac{1}{4} = \\frac{6}{4} + \\frac{1}{4} = \\frac{7}{4}$$\n\nAs a verification, note that the data is monotonic ($\\bar{q}_{i-1} < \\bar{q}_i < \\bar{q}_{i+1}$), and the reconstruction preserves monotonicity since the reconstructed interface values $q_{i,L} = 1.25$ and $q_{i,R} = 1.75$ lie between the neighboring cell averages $\\bar{q}_{i-1} = 1$ and $\\bar{q}_{i+1} = 2$, and they properly bracket the cell average $\\bar{q}_i = 1.5$. This is consistent with the TVD property of the minmod limiter.\n\nThe final answer consists of the limited slope $\\sigma_i$, the left interface value $q_{i,L}$, and the right interface value $q_{i,R}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2\\Delta x} & \\frac{5}{4} & \\frac{7}{4} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Moving from a single reconstruction to a full simulation requires integrating these concepts into a conservative finite-volume framework and handling realistic boundary conditions. The Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) approach uses the limited interface values to compute fluxes for a time update, as demonstrated in this problem . By calculating a full time step for a domain with specified inflow and outflow, you will solidify your understanding of how slope-limited reconstructions translate into a robust, high-resolution transport algorithm applicable to practical oceanographic scenarios.",
            "id": "3794851",
            "problem": "Consider the one-dimensional linear advection of a passive tracer concentration field governed by the conservation law $\\partial C / \\partial t + u\\,\\partial C / \\partial x = 0$ on a uniform grid of $N = 5$ finite-volume cells indexed by $i = 1, 2, 3, 4, 5$ with cell width $\\Delta x = 1000\\,\\mathrm{m}$. The constant velocity is $u = 0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ directed from left to right, and the time step is $\\Delta t = 600\\,\\mathrm{s}$. The initial cell-averaged concentrations at time level $n$ are given by\n$C_1^n = 1.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $C_2^n = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $C_3^n = 1.4\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $C_4^n = 1.6\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and $C_5^n = 1.8\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$. The left boundary at $x = 0$ is an inflow with prescribed Dirichlet value $C_{\\mathrm{in}} = 2.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and the right boundary is an outflow with zero-gradient closure.\n\nUsing a conservative finite-volume method with second-order spatial reconstruction via a flux-limited Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) approach, compute the limited interface states at each internal face $x_{i+1/2}$ and the boundary fluxes consistent with an upwind Godunov flux for linear advection. Use the Total Variation Diminishing (TVD) minmod slope limiter defined by\n$$\n\\operatorname{minmod}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|) & \\text{if } a\\,b > 0\\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nFor the outflow boundary closure, adopt a zero-gradient ghost cell equal to the last interior value.\n\nThen, perform one explicit Euler time update of the cell averages. Report the updated concentration in cell $i=3$, namely $C_3^{n+1}$, after one time step. Round your answer to four significant figures and express it in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$.",
            "solution": "## PROBLEM VALIDATION\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- **Governing Equation**: One-dimensional linear advection, $\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = 0$.\n- **Grid**: Uniform finite-volume grid with $N = 5$ cells, indexed $i = 1, 2, 3, 4, 5$.\n- **Cell Width**: $\\Delta x = 1000\\,\\mathrm{m}$.\n- **Velocity**: Constant velocity $u = 0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- **Time Step**: $\\Delta t = 600\\,\\mathrm{s}$.\n- **Initial Conditions**: Cell-averaged concentrations at time level $n$:\n  - $C_1^n = 1.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n  - $C_2^n = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n  - $C_3^n = 1.4\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n  - $C_4^n = 1.6\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n  - $C_5^n = 1.8\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- **Boundary Conditions**:\n  - Left boundary (inflow at $x=0$): Prescribed Dirichlet value $C_{\\mathrm{in}} = 2.0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\n  - Right boundary (outflow): Zero-gradient closure, implemented as a ghost cell with value equal to the last interior cell ($C_6^n = C_5^n$).\n- **Numerical Method**:\n  - Conservative finite-volume method.\n  - Second-order spatial reconstruction using a flux-limited MUSCL approach.\n  - Upwind Godunov flux for linear advection.\n  - Explicit Euler time update.\n- **Slope Limiter**: TVD minmod slope limiter defined as:\n  $$ \\operatorname{minmod}(a,b) = \\begin{cases} \\operatorname{sign}(a)\\,\\min(|a|,|b|) & \\text{if } a\\,b > 0\\\\ 0 & \\text{otherwise} \\end{cases} $$\n- **Task**: Compute the updated concentration in cell $i=3$, $C_3^{n+1}$, after one time step.\n- **Reporting**: Round the final answer to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria:\n- **Scientifically Grounded**: The problem describes the advection of a passive tracer, a fundamental process in physics and oceanography, governed by the linear advection equation. The numerical method (finite volume with MUSCL and minmod limiter) is a standard, well-established technique in computational fluid dynamics. The setup is scientifically sound.\n- **Well-Posed**: All necessary parameters ($u$, $\\Delta x$, $\\Delta t$), initial conditions, and boundary conditions are provided. The Courant number $c = \\frac{u \\Delta t}{\\Delta x} = \\frac{0.5 \\times 600}{1000} = 0.3$, which is less than $1$, satisfying the CFL condition for stability of the explicit Euler scheme. A unique, stable solution is expected.\n- **Objective**: The problem is stated using precise, unambiguous terminology common to numerical modeling. There are no subjective or opinion-based elements.\n- **Completeness and Consistency**: The problem provides a complete set of data and constraints for a single time step calculation. There are no internal contradictions.\n- **Realism**: The values for velocity, grid spacing, and time step are plausible for a coarse-resolution computational oceanography model.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-posed, scientifically grounded problem from computational fluid dynamics. A complete solution will be provided.\n\n## SOLUTION\n\nThe evolution of the cell-averaged concentration $C_i$ in a finite volume cell $i$ is governed by the conservation law in discrete form:\n$$\nC_i^{n+1} = C_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\nwhere $C_i^n$ is the concentration in cell $i$ at time level $n$, $\\Delta t$ is the time step, $\\Delta x$ is the cell width, and $F_{i\\pm1/2}$ are the numerical fluxes at the cell interfaces.\n\nThe Courant number, $c$, is a dimensionless quantity representing the fraction of a cell that the fluid travels in one time step:\n$$\nc = \\frac{u \\Delta t}{\\Delta x} = \\frac{(0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (600\\,\\mathrm{s})}{1000\\,\\mathrm{m}} = \\frac{300}{1000} = 0.3\n$$\nThe update equation can be written as:\n$$\nC_i^{n+1} = C_i^n - \\frac{c}{u} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\nFor linear advection with constant velocity $u > 0$, the upwind Godunov flux at an interface is determined by the tracer concentration on the left (upwind) side of the interface. The flux at interface $x_{i+1/2}$ is $F_{i+1/2} = u C_{i+1/2}^L$, where $C_{i+1/2}^L$ is the reconstructed concentration value at the left side of the interface. The update becomes $C_i^{n+1} = C_i^n - c(C_{i+1/2}^L - C_{i-1/2}^L)$.\n\nThe MUSCL scheme provides a second-order accurate reconstruction of the interface values from the cell averages. The value on the left side of the interface $x_{i+1/2}$ (which is the right edge of cell $i$) is reconstructed as:\n$$\nC_{i+1/2}^L = C_i^n + \\frac{1}{2} \\sigma_i\n$$\nHere, $\\sigma_i$ is the limited slope (a dimensionless difference) of the concentration profile within cell $i$. The slope is calculated using the provided `minmod` limiter to ensure the scheme is Total Variation Diminishing (TVD) and avoids spurious oscillations. The arguments to the `minmod` function are the backward and forward differences:\n$$\n\\sigma_i = \\operatorname{minmod}(C_i^n - C_{i-1}^n, C_{i+1}^n - C_i^n)\n$$\nWe need to calculate the updated concentration in cell $i=3$, which is $C_3^{n+1}$. The specific formula is:\n$$\nC_3^{n+1} = C_3^n - c (C_{3+1/2}^L - C_{2+1/2}^L)\n$$\nThis requires the calculation of the limited slopes $\\sigma_2$ and $\\sigma_3$ to determine the interface states $C_{2+1/2}^L$ and $C_{3+1/2}^L$.\n\n1.  **Calculate the slope in cell $i=2$, $\\sigma_2$**:\n    The neighboring concentrations are $C_1^n=1.0$, $C_2^n=1.2$, and $C_3^n=1.4$.\n    The backward difference is $a = C_2^n - C_1^n = 1.2 - 1.0 = 0.2$.\n    The forward difference is $b = C_3^n - C_2^n = 1.4 - 1.2 = 0.2$.\n    Since $a \\cdot b = (0.2)(0.2) = 0.04 > 0$, we apply the `minmod` function:\n    $$\n    \\sigma_2 = \\operatorname{minmod}(0.2, 0.2) = \\operatorname{sign}(0.2) \\min(|0.2|, |0.2|) = 1 \\times 0.2 = 0.2\n    $$\n\n2.  **Calculate the slope in cell $i=3$, $\\sigma_3$**:\n    The neighboring concentrations are $C_2^n=1.2$, $C_3^n=1.4$, and $C_4^n=1.6$.\n    The backward difference is $a = C_3^n - C_2^n = 1.4 - 1.2 = 0.2$.\n    The forward difference is $b = C_4^n - C_3^n = 1.6 - 1.4 = 0.2$.\n    Since $a \\cdot b = (0.2)(0.2) = 0.04 > 0$, the slope is:\n    $$\n    \\sigma_3 = \\operatorname{minmod}(0.2, 0.2) = \\operatorname{sign}(0.2) \\min(|0.2|, |0.2|) = 1 \\times 0.2 = 0.2\n    $$\n\n3.  **Compute the limited interface states**:\n    The interface state at $x_{2+1/2}$ is reconstructed from cell $2$:\n    $$\n    C_{2+1/2}^L = C_2^n + \\frac{1}{2} \\sigma_2 = 1.2 + \\frac{1}{2}(0.2) = 1.2 + 0.1 = 1.3\n    $$\n    The interface state at $x_{3+1/2}$ is reconstructed from cell $3$:\n    $$\n    C_{3+1/2}^L = C_3^n + \\frac{1}{2} \\sigma_3 = 1.4 + \\frac{1}{2}(0.2) = 1.4 + 0.1 = 1.5\n    $$\n\n4.  **Perform the time update for cell $i=3$**:\n    Now substitute all the calculated values into the update equation for $C_3^{n+1}$:\n    $$\n    C_3^{n+1} = C_3^n - c (C_{3+1/2}^L - C_{2+1/2}^L)\n    $$\n    $$\n    C_3^{n+1} = 1.4 - 0.3 \\times (1.5 - 1.3)\n    $$\n    $$\n    C_3^{n+1} = 1.4 - 0.3 \\times (0.2)\n    $$\n    $$\n    C_3^{n+1} = 1.4 - 0.06\n    $$\n    $$\n    C_3^{n+1} = 1.34\n    $$\n\nThe problem requires the answer to be rounded to four significant figures. This gives $1.340$. The result has units of $\\mathrm{kg}\\,\\mathrm{m}^{-3}$.",
            "answer": "$$\n\\boxed{1.340}\n$$"
        },
        {
            "introduction": "While MUSCL schemes limit the reconstruction slope, an alternative and historically significant approach is Flux-Corrected Transport (FCT), which directly blends a low-order (monotonic) flux with a high-order (accurate) flux. FCT computes an \"antidiffusive\" flux, representing the difference between the high- and low-order fluxes, and then limits this correction to ensure the final solution remains bounded and free of new oscillations. This detailed calculation walks you through the entire FCT algorithm, offering insight into a different philosophy for achieving high-resolution, non-oscillatory results .",
            "id": "3794841",
            "problem": "Consider one-dimensional advection of a nondimensional tracer concentration $q$ governed by the conservation law $\\partial q / \\partial t + \\partial (u q) / \\partial x = 0$ on a uniform grid of four control volumes with periodic boundary conditions. The grid spacing is $\\Delta x = 1$ and the constant velocity is $u = 1$. The time step is $\\Delta t = 0.5$, so the Courant number is $\\nu = u \\Delta t / \\Delta x = 0.5$. The initial cell-averaged values at time level $n$ are $q^{n} = [q_{1}^{n}, q_{2}^{n}, q_{3}^{n}, q_{4}^{n}] = [0, 1, 0.2, 0.8]$, with periodic indexing (so $q_{0}^{n} \\equiv q_{4}^{n}$ and $q_{5}^{n} \\equiv q_{1}^{n}$).\n\nYou will apply Flux-Corrected Transport (FCT), defined as follows. Use the donor-cell (upwind) low-order numerical flux for $u>0$: $F^{L}_{i+1/2} = u\\,q_{i}^{n}$. Use the second-order Lax–Wendroff high-order numerical flux: $F^{H}_{i+1/2} = u\\left[q_{i}^{n} + \\tfrac{1}{2}(1-\\nu)\\left(q_{i+1}^{n} - q_{i}^{n}\\right)\\right]$. Define the raw antidiffusive flux $A_{i+1/2} = F^{H}_{i+1/2} - F^{L}_{i+1/2}$. Compute the provisional low-order update $q_{i}^{L} = q_{i}^{n} - \\nu\\left(F^{L}_{i+1/2}/u - F^{L}_{i-1/2}/u\\right)$.\n\nAssume known global physical bounds for the tracer, $q_{\\min} = 0$ and $q_{\\max} = 1$, applicable to every cell. With these bounds, construct the Zalesak-type flux limiter in one dimension as follows. For each cell $i$, define the allowable positive and negative “antidiffusive inflow capacities” as $P_{i}^{+} = (q_{\\max} - q_{i}^{L})\\,\\Delta x / \\Delta t$ and $P_{i}^{-} = (q_{\\min} - q_{i}^{L})\\,\\Delta x / \\Delta t$. Define the incoming antidiffusive flux sums as $S_{i}^{+} = \\max\\{0, A_{i-1/2}\\} + \\max\\{0, -A_{i+1/2}\\}$ and $S_{i}^{-} = \\min\\{0, A_{i-1/2}\\} + \\min\\{0, -A_{i+1/2}\\}$. Then set the cell-based limiting factors as $R_{i}^{+} = \\min\\{1, P_{i}^{+}/S_{i}^{+}\\}$ if $S_{i}^{+} > 0$, and $R_{i}^{+} = 1$ otherwise; and $R_{i}^{-} = \\min\\{1, P_{i}^{-}/S_{i}^{-}\\}$ if $S_{i}^{-}  0$, and $R_{i}^{-} = 1$ otherwise. The face-based limiter is $\\alpha_{i+1/2} = \\min\\{R_{i}^{+}, R_{i+1}^{-}\\}$ if $A_{i+1/2} > 0$, and $\\alpha_{i+1/2} = \\min\\{R_{i}^{-}, R_{i+1}^{+}\\}$ if $A_{i+1/2}  0$, while $\\alpha_{i+1/2} = 1$ if $A_{i+1/2} = 0$. The limited antidiffusive flux is $\\widetilde{A}_{i+1/2} = \\alpha_{i+1/2} A_{i+1/2}$, and the corrected update is $q_{i}^{n+1} = q_{i}^{L} - (\\Delta t / \\Delta x)\\left(\\widetilde{A}_{i+1/2} - \\widetilde{A}_{i-1/2}\\right)$.\n\nCompute the limited antidiffusive fluxes $\\widetilde{A}_{i+1/2}$ at all faces and the corrected cell averages $q_{i}^{n+1}$ after one time step. As your final answer, report the corrected cell average in cell $i=3$, $q_{3}^{n+1}$, rounded to six significant figures. Express your answer as a nondimensional number.",
            "solution": "We begin from the conservative advection equation $\\partial q / \\partial t + \\partial (u q) / \\partial x = 0$ discretized in finite-volume form with numerical fluxes at cell interfaces to ensure conservation. The Flux-Corrected Transport (FCT) method blends a low-order, monotone scheme with a high-order, low-dissipation scheme via limited antidiffusive fluxes so that the corrected solution honors the physical bounds.\n\nGiven $u = 1$, $\\Delta x = 1$, and $\\Delta t = 0.5$, the Courant number is $\\nu = u \\Delta t / \\Delta x = 0.5$. Periodicity implies $q_{0}^{n} \\equiv q_{4}^{n}$ and $q_{5}^{n} \\equiv q_{1}^{n}$. The initial data are $q_{1}^{n} = 0$, $q_{2}^{n} = 1$, $q_{3}^{n} = 0.2$, $q_{4}^{n} = 0.8$.\n\n1) Low-order fluxes and provisional update. For $u > 0$, the donor-cell (upwind) flux is\n$F^{L}_{i+1/2} = u q_{i}^{n} = q_{i}^{n}$.\nThus,\n$F^{L}_{1+1/2} = q_{1}^{n} = 0$, $F^{L}_{2+1/2} = q_{2}^{n} = 1$, $F^{L}_{3+1/2} = q_{3}^{n} = 0.2$, $F^{L}_{4+1/2} = q_{4}^{n} = 0.8$.\nThe low-order update is\n$q_{i}^{L} = q_{i}^{n} - \\nu\\left(q_{i}^{n} - q_{i-1}^{n}\\right) = (1-\\nu) q_{i}^{n} + \\nu q_{i-1}^{n}$.\nWith $\\nu = 0.5$, we have $q_{i}^{L} = 0.5 q_{i}^{n} + 0.5 q_{i-1}^{n}$.\nTherefore,\n- $q_{1}^{L} = 0.5 q_{1}^{n} + 0.5 q_{4}^{n} = 0.5 \\cdot 0 + 0.5 \\cdot 0.8 = 0.4$,\n- $q_{2}^{L} = 0.5 q_{2}^{n} + 0.5 q_{1}^{n} = 0.5 \\cdot 1 + 0.5 \\cdot 0 = 0.5$,\n- $q_{3}^{L} = 0.5 q_{3}^{n} + 0.5 q_{2}^{n} = 0.5 \\cdot 0.2 + 0.5 \\cdot 1 = 0.1 + 0.5 = 0.6$,\n- $q_{4}^{L} = 0.5 q_{4}^{n} + 0.5 q_{3}^{n} = 0.5 \\cdot 0.8 + 0.5 \\cdot 0.2 = 0.4 + 0.1 = 0.5$.\n\n2) High-order fluxes and raw antidiffusive fluxes. The Lax–Wendroff flux is\n$F^{H}_{i+1/2} = u\\left[q_{i}^{n} + \\tfrac{1}{2}(1-\\nu)\\left(q_{i+1}^{n} - q_{i}^{n}\\right)\\right]$.\nWith $u = 1$ and $\\nu = 0.5$, we have $\\tfrac{1}{2}(1-\\nu) = \\tfrac{1}{2} \\cdot 0.5 = 0.25$, so\n$F^{H}_{i+1/2} = q_{i}^{n} + 0.25 \\left(q_{i+1}^{n} - q_{i}^{n}\\right) = 0.75 q_{i}^{n} + 0.25 q_{i+1}^{n}$.\nThus,\n- $F^{H}_{1+1/2} = 0.75 q_{1}^{n} + 0.25 q_{2}^{n} = 0.75 \\cdot 0 + 0.25 \\cdot 1 = 0.25$,\n- $F^{H}_{2+1/2} = 0.75 q_{2}^{n} + 0.25 q_{3}^{n} = 0.75 \\cdot 1 + 0.25 \\cdot 0.2 = 0.75 + 0.05 = 0.8$,\n- $F^{H}_{3+1/2} = 0.75 q_{3}^{n} + 0.25 q_{4}^{n} = 0.75 \\cdot 0.2 + 0.25 \\cdot 0.8 = 0.15 + 0.2 = 0.35$,\n- $F^{H}_{4+1/2} = 0.75 q_{4}^{n} + 0.25 q_{1}^{n} = 0.75 \\cdot 0.8 + 0.25 \\cdot 0 = 0.6$.\nThe raw antidiffusive fluxes $A_{i+1/2} = F^{H}_{i+1/2} - F^{L}_{i+1/2}$ are\n- $A_{1+1/2} = 0.25 - 0 = 0.25$,\n- $A_{2+1/2} = 0.8 - 1 = -0.2$,\n- $A_{3+1/2} = 0.35 - 0.2 = 0.15$,\n- $A_{4+1/2} = 0.6 - 0.8 = -0.2$.\n\n3) Bounds, capacities, and incoming sums. The global bounds are $q_{\\min} = 0$ and $q_{\\max} = 1$. The capacity factors use $\\Delta x / \\Delta t = 1 / 0.5 = 2$:\n$P_{i}^{+} = (q_{\\max} - q_{i}^{L}) \\cdot 2$, and $P_{i}^{-} = (q_{\\min} - q_{i}^{L}) \\cdot 2 = -2 q_{i}^{L}$.\nHence\n- $P_{1}^{+} = (1 - 0.4) \\cdot 2 = 1.2$, $P_{1}^{-} = -2 \\cdot 0.4 = -0.8$,\n- $P_{2}^{+} = (1 - 0.5) \\cdot 2 = 1.0$, $P_{2}^{-} = -2 \\cdot 0.5 = -1.0$,\n- $P_{3}^{+} = (1 - 0.6) \\cdot 2 = 0.8$, $P_{3}^{-} = -2 \\cdot 0.6 = -1.2$,\n- $P_{4}^{+} = (1 - 0.5) \\cdot 2 = 1.0$, $P_{4}^{-} = -2 \\cdot 0.5 = -1.0$.\n\nThe incoming sums for each cell $i$ use $A_{i-1/2}$ from the left face and $-A_{i+1/2}$ from the right face:\n$S_{i}^{+} = \\max\\{0, A_{i-1/2}\\} + \\max\\{0, -A_{i+1/2}\\}$ and $S_{i}^{-} = \\min\\{0, A_{i-1/2}\\} + \\min\\{0, -A_{i+1/2}\\}$.\nWith periodicity, $A_{0+1/2} = A_{4+1/2}$.\nCompute:\n- Cell $i=1$: $A_{0+1/2} = A_{4+1/2} = -0.2$, $-A_{1+1/2} = -0.25$.\nThen $S_{1}^{+} = \\max\\{0, -0.2\\} + \\max\\{0, -0.25\\} = 0 + 0 = 0$, and $S_{1}^{-} = \\min\\{0, -0.2\\} + \\min\\{0, -0.25\\} = -0.2 + (-0.25) = -0.45$.\n- Cell $i=2$: $A_{1+1/2} = 0.25$, $-A_{2+1/2} = -(-0.2) = 0.2$.\nThen $S_{2}^{+} = \\max\\{0, 0.25\\} + \\max\\{0, 0.2\\} = 0.25 + 0.2 = 0.45$, and $S_{2}^{-} = \\min\\{0, 0.25\\} + \\min\\{0, 0.2\\} = 0 + 0 = 0$.\n- Cell $i=3$: $A_{2+1/2} = -0.2$, $-A_{3+1/2} = -0.15$.\nThen $S_{3}^{+} = \\max\\{0, -0.2\\} + \\max\\{0, -0.15\\} = 0 + 0 = 0$, and $S_{3}^{-} = \\min\\{0, -0.2\\} + \\min\\{0, -0.15\\} = -0.2 + (-0.15) = -0.35$.\n- Cell $i=4$: $A_{3+1/2} = 0.15$, $-A_{4+1/2} = -(-0.2) = 0.2$.\nThen $S_{4}^{+} = \\max\\{0, 0.15\\} + \\max\\{0, 0.2\\} = 0.15 + 0.2 = 0.35$, and $S_{4}^{-} = \\min\\{0, 0.15\\} + \\min\\{0, 0.2\\} = 0 + 0 = 0$.\n\n4) Cell-based limiting factors. Using the rules, if $S_{i}^{+} = 0$ then $R_{i}^{+} = 1$, and if $S_{i}^{-} = 0$ then $R_{i}^{-} = 1$. Otherwise use the ratios:\n- Cell $i=1$: $S_{1}^{+} = 0 \\Rightarrow R_{1}^{+} = 1$; $S_{1}^{-} = -0.45$, so $R_{1}^{-} = \\min\\{1, P_{1}^{-}/S_{1}^{-}\\} = \\min\\{1, (-0.8)/(-0.45)\\} = \\min\\{1, 1.777\\ldots\\} = 1$.\n- Cell $i=2$: $S_{2}^{+} = 0.45$, so $R_{2}^{+} = \\min\\{1, P_{2}^{+}/S_{2}^{+}\\} = \\min\\{1, 1.0/0.45\\} = 1$; $S_{2}^{-} = 0 \\Rightarrow R_{2}^{-} = 1$.\n- Cell $i=3$: $S_{3}^{+} = 0 \\Rightarrow R_{3}^{+} = 1$; $S_{3}^{-} = -0.35$, so $R_{3}^{-} = \\min\\{1, P_{3}^{-}/S_{3}^{-}\\} = \\min\\{1, (-1.2)/(-0.35)\\} = 1$.\n- Cell $i=4$: $S_{4}^{+} = 0.35$, so $R_{4}^{+} = \\min\\{1, P_{4}^{+}/S_{4}^{+}\\} = \\min\\{1, 1.0/0.35\\} = 1$; $S_{4}^{-} = 0 \\Rightarrow R_{4}^{-} = 1$.\n\nThus all cell factors are unity: $R_{i}^{+} = R_{i}^{-} = 1$ for all $i$.\n\n5) Face-based limiter and limited antidiffusive fluxes. For each face:\n- If $A_{i+1/2}  0$, $\\alpha_{i+1/2} = \\min\\{R_{i}^{+}, R_{i+1}^{-}\\} = \\min\\{1, 1\\} = 1$.\n- If $A_{i+1/2}  0$, $\\alpha_{i+1/2} = \\min\\{R_{i}^{-}, R_{i+1}^{+}\\} = \\min\\{1, 1\\} = 1$.\nTherefore, $\\alpha_{i+1/2} = 1$ at all faces, and the limited antidiffusive fluxes equal the raw ones:\n$\\widetilde{A}_{1+1/2} = 0.25$, $\\widetilde{A}_{2+1/2} = -0.2$, $\\widetilde{A}_{3+1/2} = 0.15$, $\\widetilde{A}_{4+1/2} = -0.2$.\n\n6) Corrected update. The final corrected solution is\n$q_{i}^{n+1} = q_{i}^{L} - (\\Delta t/\\Delta x)\\left(\\widetilde{A}_{i+1/2} - \\widetilde{A}_{i-1/2}\\right)$. Since $\\Delta t/\\Delta x = \\nu/u = 0.5/1 = 0.5$.\nCompute each:\n- $q_{1}^{n+1} = 0.4 - 0.5\\left(0.25 - (-0.2)\\right) = 0.4 - 0.5 \\cdot 0.45 = 0.4 - 0.225 = 0.175$,\n- $q_{2}^{n+1} = 0.5 - 0.5\\left((-0.2) - 0.25\\right) = 0.5 - 0.5 \\cdot (-0.45) = 0.5 + 0.225 = 0.725$,\n- $q_{3}^{n+1} = 0.6 - 0.5\\left(0.15 - (-0.2)\\right) = 0.6 - 0.5 \\cdot 0.35 = 0.6 - 0.175 = 0.425$,\n- $q_{4}^{n+1} = 0.5 - 0.5\\left((-0.2) - 0.15\\right) = 0.5 - 0.5 \\cdot (-0.35) = 0.5 + 0.175 = 0.675$.\n\nThe requested quantity is $q_{3}^{n+1} = 0.425$. Rounded to six significant figures, this is $0.425000$.",
            "answer": "$$\\boxed{0.425000}$$"
        }
    ]
}