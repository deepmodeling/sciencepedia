## 应用与跨学科联系

### 引言

在前面的章节中，我们已经探讨了带有部分底层网格（partial bottom cells）的z-level坐标系的基本原理和机制。我们了解到，这种方法通过允许最底层的网格单元被地形截断，从而以阶梯状的方式精确匹配真实的海底地形。本章旨在超越这些基本原理，探索这一技术在真实世界海洋模型中的广泛应用，并揭示其与[地球物理流体动力学](@entry_id:150356)、计算科学以及其他[地球科学](@entry_id:749876)分支的深刻跨学科联系。

部分底层网格不仅仅是一种几何上的优化，更是一种增强模型物理真实性和数值稳定性的关键技术。其核心优势在于，它极大地减少了与简单的阶梯状z-level坐标系相关的压力梯度误差（Pressure Gradient Error），同时又避免了[地形跟随坐标](@entry_id:1132950)系（terrain-following coordinates）所固有的复杂性和其他误差源。在本章中，我们将通过一系列应用场景，展示部分底层网格如何帮助研究人员构建更稳健、更精确的[海洋环流](@entry_id:195237)模型，以应对从海岸动力学到全球气候模拟的各种挑战。

### [数值稳定性](@entry_id:175146)与守恒性

一个可靠的数值模型必须在长时间积分中保持稳定并严格遵守物理守恒定律。部分底层网格的引入，虽然提高了地形表达的精度，但也对数值方案的设计提出了新的挑战。合理的实现对于确保模型的稳定性和守恒性至关重要。

#### 海底摩擦的[参数化](@entry_id:265163)

海洋模型中的一个基本物理过程是水流与海床之间的摩擦，这通过海[底应力](@entry_id:1121796)（bottom stress）边界条件来[参数化](@entry_id:265163)。一个常用的[参数化](@entry_id:265163)方案是二次拖曳定律，其形式为 $\boldsymbol{\tau}_b = \rho C_d |\boldsymbol{U}_b| \boldsymbol{U}_b$，其中 $\boldsymbol{\tau}_b$ 是海[底应力](@entry_id:1121796)，$\rho$ 是密度，$C_d$ 是无量纲的拖曳系数，$\boldsymbol{U}_b$ 是近底层流速。在有限体积模型中，这个应力在一个控制体上产生一个作用力，进而改变其动量。

当底层网格是部分单元时，一个关键问题是如何计算这个作用力。如果将应力作用在整个网格单元的水平面积上，那么当部分单元的厚度 $h_b$ 趋于零时，一个有限的力作用在趋于零的质量上，会导致无限大的加速度，从而引发数值不稳定。一个稳健的方案，通常被称为“刮削单元”（shaved cell）方法，是将拖曳力作用的有效海底面积 $A_b$ 与该单元的体积成比例缩放。例如，如果部分单元的厚度是标准厚度 $\Delta z$ 的一部分，即 $h_b = f \Delta z$（其中 $f$ 是厚度分数），那么有效接触面积也相应缩减为 $A_b = f A$，其中 $A$ 是网格的水平面积。通过这种方式，由海[底应力](@entry_id:1121796)引起的动量倾向（单位质量的动量变化率，即加速度）变为 $a_u = - \tau_b^u A_b / (\rho A h_b) = - \tau_b^u (fA) / (\rho A f \Delta z) = - \tau_b^u / (\rho \Delta z)$。这个结果表明，加速度的大小仅取决于标准层厚 $\Delta z$，而与部分厚度分数 $f$ 无关。这种处理方式避免了在部分单元极薄时出现奇异性，从而极大地增强了模型的稳定性  。

#### 保证通量守恒

质量、热量和盐量的守恒是海洋模型长期积分正确的基石。在有限体积框架中，守恒性是通过确保离开一个网格单元的通量精确等于进入相邻单元的通量来实现的。当使用部分底层网格时，相邻两个水柱的底层单元厚度可能不同，这给通量的计算带来了挑战。

如果在计算跨越两个部分单元 $i$ 和 $i+1$ 之间界面的通量时，使用了不一致的侧面面积——例如，流出单元 $i$ 的通量使用 $i$ 单元的厚度 $h_p(i)$ 计算，而流入单元 $i+1$ 的通量使用 $i+1$ 单元的厚度 $h_p(i+1)$ 计算——这将导致一个虚假的体积源或汇。如果 $h_p(i) \ne h_p(i+1)$，通量计算将不再是反对称的，从而在全局积分时产生净的质量不守恒。在一个封闭域模型中，这种不一致性会导致总水量随时间发生虚假漂移，破坏模型的物理真实性 。为了避免这个问题，一个严谨的[守恒格式](@entry_id:747714)必须在两个相邻单元之间的共享界面上定义一个唯一的、一致的通量面积，通常是取两个相邻部分单元厚度的最小值。

#### 在压力求解器中的作用

在现代海洋模型中，常采用分离式时间步进方案，其中[正压模](@entry_id:1121351)（barotropic mode）使用短时间步来解析快速的[表面重力波](@entry_id:1132678)，而正斜模（baroclinic mode）使用长的时间步。正压模的求解通常涉及一个压力投影方法，需要求解一个关于海面高度 $\eta$ 的椭圆方程。

这个过程的数值稳定性和能量守恒性对模型至关重要。为了确保能量守恒，即[压力修正](@entry_id:753714)步骤不会虚假地产生或消耗动能，投影算子必须在一个由动能定义的[加权内积](@entry_id:163877)下是正交的。动能本身是按水柱的真[实质](@entry_id:149406)量（或体积）加权的。这意味着，在构建压力求解器的离散算子时，所使用的“[质量矩阵](@entry_id:177093)” $M$ 必须精确地反映每个位置的实际水深 $H$。由于部分底层网格精确地描述了水深 $H$，将这一信息一致地纳入[质量矩阵](@entry_id:177093)（例如，令 $M$ 与 $H$ 成正比）是至关重要的。这样做不仅可以保证能量守恒，还能确保得到的[椭圆算子](@entry_id:181616)具有对称正定（SPD）的良好数学性质，从而保证[解的唯一性](@entry_id:143619)和稳定性 。

### [地球物理流体动力学](@entry_id:150356)（GFD）的联系

部分底层网格不仅改善了模型的数值特性，还使其能够更准确地表达[地球物理流体动力学](@entry_id:150356)（GFD）中的基本概念和过程。

#### 对[波动力学](@entry_id:166256)的影响

长波（如潮汐和海啸）的传播速度由水深决定。对于正压模，其相速度由 $c = \sqrt{gH_{\mathrm{eff}}}$ 给出，其中 $g$ 是[重力加速度](@entry_id:173411)，$H_{\mathrm{eff}}$ 是有效水深。在离散模型中，$H_{\mathrm{eff}}$ 是通过对所有湿润网格层的厚度求和得到的。

部分底层网格通过精确表示海底地形，提供了比阶梯状z-level网格更准确的局部有效水深 $H_{\mathrm{eff}}$。局部水深由所有全厚度层和最底部的部分单元厚度共同构成，即 $H_{\mathrm{eff}} = \sum \Delta z_k + h_b$ 。这种精度的提升直接影响了模型的波动力学特性。例如，在包含部分单元的离散化中，有效水深 $H_{\mathrm{eff}}$ 直接依赖于底层单元的厚度分数。因此，波的频散关系 $\omega^2 = f^2 + g H_{\mathrm{eff}} K^2$（其中 $\omega$ 是频率，$f$ 是[科里奥利参数](@entry_id:1123077)，$K$ 是波数）能够更真实地反映地形的亚网格尺度变化。这意味着模型能够更准确地模拟长波在大陆架和斜坡等地形复杂区域的传播和变形 。

#### 位涡的精确计算

位涡（Potential Vorticity, PV）是GFD中的一个核心动力学示踪物，其守恒性制约着大规模的[海洋环流](@entry_id:195237)。一个简化的PV形式可以写作 $\mathrm{PV}^* \equiv \frac{\zeta + f_0}{h} \frac{\partial \rho}{\partial z}$，它包含了绝对涡度（$\zeta + f_0$）、层厚（$h$）和层结（$\frac{\partial \rho}{\partial z}$）三个关键物理量。

在数值模型中准确计算PV对于模拟正确的动力学过程至关重要。部分底层网格通过两种方式影响了近底层PV的计算。首先，在PV表达式中，层厚 $h$ 对应于部分单元的实际厚度 $\Delta z_{\mathrm{bot}}$，而不是名义上的标准厚度。其次，垂直密度梯度 $\frac{\partial \rho}{\partial z}$ 的计算也受到影响。由于底部单元被截断，计算其中心密度梯度需要使用一个非均匀的差分格式，例如，涉及底部单元中心和其上方单元中心的真实距离，即 $\frac{1}{2}\Delta z_{\mathrm{bot}} + \frac{1}{2}\Delta z_{k_b-1}$。这两种效应共同作用，使得模型能够在斜坡地形附近更精确地捕捉由于水柱拉伸或压缩产生的PV变化，这对于模拟涡旋生成和西边界强流的分离等过程至关重要 。

### 在海洋[过程模拟](@entry_id:634927)和跨学科研究中的应用

部分底层网格的精确性和稳健性使其在模拟各种海洋现象和促进跨学科研究方面发挥着不可或缺的作用。

#### 大规模环流与输运计算

诊断和理解全球[海洋环流](@entry_id:195237)，如[经向翻转环流](@entry_id:1127799)（Meridional Overturning Circulation, MOC），依赖于精确计算跨越特定断面（如大西洋特定纬度）的体积输运。体积输运是通过对断面上所有网格单元的法向流速和其湿润面积的乘积进行积分得到的。

与使用粗糙阶梯状地形的z-level模型相比，采用部分底层网格的模型能够更精确地表示断面的总湿润面积和每一层的湿润面积。这种改进对于总输运（正压输运）和[翻转环流](@entry_id:1129255)的垂向结构（正斜输运）的计算都至关重要。不准确的地形表达会导致对深水通道、海脊和大陆架坡折等关键地形特征的错误描述，从而严重影响输运计算的准确性。部分底层网格通过提供更真实的几何边界，为我们研究大规模物质和热量输运提供了更可靠的工具 。

#### 海岸过程：潮汐滩的[润湿](@entry_id:147044)与干涸

在海岸和河口区域，潮汐的涨落会导致大片区域（如潮滩）周期性地被淹没和暴露。准确模拟这种[润湿](@entry_id:147044)与干涸（wetting and drying）过程是海岸工程和[生态学研究](@entry_id:916745)的基础。部分底层网格为此类模拟提供了理想的框架。

当海面高度下降，水深接近于零时，最底层的网格单元自然地成为一个厚度逐渐减小的部分单元。一个稳健的[润湿](@entry_id:147044)-干涸方案通常包含以下要素：首先，使用带有迟滞效应（hysteresis）的判据，即设定一个较小的[润湿](@entry_id:147044)阈值 $h_{\mathrm{wet}}$ 和一个更小的干涸阈值 $h_{\mathrm{dry}}$，以防止在[临界深度](@entry_id:275576)附近由于微小波动引起的数值振荡。其次，必须严格保证质量守恒，当一个单元的计算水深变为负值时，这个“质量赤字”必须通过从邻近湿润单元“借取”的方式来补偿，而不是简单地将其设为零。最后，所有通过单元侧面的通量（包括动量和示踪物）必须与随时间变化的湿润面积成比例缩放，以确保当单元变干时通量平滑地趋于零，维持模型的稳定性 。

#### 海底边界层动力学

海底边界层（Bottom Boundary Layer, BBL）是动量、热量和物质在海洋内部和底床之间交换的主要区域。准确解析或[参数化](@entry_id:265163)BBL对于模拟[沉积物输运](@entry_id:1131379)、[海洋生物地球化学](@entry_id:1129047)循环和耗散大规模环流能量至关重要。

z-level网格的一个特点是其垂向分辨率是固定的。虽然部分底层网格能精确表示海床位置，但它并不能改变垂向分辨率本身。这意味着，在水深较浅的大陆架区域，固定的z-level网格可能无法提供足够的分辨率来解析BBL的内部结构（例如，由埃克曼层厚度 $\delta_b = \sqrt{2 A_v / |f|}$ 定义的物理尺度）。这与垂向分辨率随水深变化的$\sigma$-坐标系形成了对比，后者在浅水区自然具有更高的垂向分辨率。因此，在使用带有部分底层网格的z-level模型进行BBL研究时，研究者必须仔细评估其垂向分辨率是否足够，或者是否需要采用嵌入式BBL[参数化](@entry_id:265163)方案来弥补分辨率的不足  。这是一个在[模型选择](@entry_id:155601)和配置中需要权衡的关键问题。

#### 与[冰冻圈](@entry_id:1123254)的耦合：海冰[压力模](@entry_id:159654)拟

现代[地球系统模型](@entry_id:1124096)日益关注不同圈层之间的相互作用。一个重要的例子是海洋与[冰冻圈](@entry_id:1123254)（cryosphere）的耦合，特别是在极地地区。海冰的存在会对海洋表面施加一个压力载荷。

在z-level模型中，这种表面压力载荷（$P_{\text{ice}}$）可以被优雅地整合到驱动[正压模](@entry_id:1121351)的有效[表面压](@entry_id:152856)力项中，即 $p_{\text{surf}} = P_{\text{ice}} + g \rho_0 \eta$。这个有效表面压力的水平梯度驱动了正压流。这种表述的一个重要优点是它的模块化和稳健性：表面压力的处理完全独立于模型内部的[静压](@entry_id:275419)计算和底层地形的表示。无论底层是全厚度单元还是极薄的部分单元，[静压](@entry_id:275419)的垂向积分都从海床向上进行，而[表面压](@entry_id:152856)力则作为一个顶层边界条件。这种[解耦](@entry_id:160890)确保了即使在有海冰和复杂地形的情况下，模型也能保持内部[静压](@entry_id:275419)平衡，并且不会因为地形的变化而产生虚假的正压驱动力 。

#### [次网格尺度过程](@entry_id:1132602)的[参数化](@entry_id:265163)

海洋中许多重要过程（如垂向对流）发生在小于模型网格的尺度上，必须通过[参数化](@entry_id:265163)方案来表示。对流调整（convective adjustment）就是这样一种方案：当模型计算出密度倒置（即[上层](@entry_id:198114)水比下层水更密）的静力不稳定状态时，该方案会瞬间混合不稳定的水柱，以恢复静力稳定。

在实施这类方案时，必须严格保证热量和盐量在混合前后是守恒的。在z-level模型中，这意味着混合计算必须考虑每个参与混合的网格单元的真实体积。这对于顶层和底层单元尤其重要，因为顶层单元的厚度会随海面高度变化，而底层单元的厚度则由局部地形决定。因此，一个守恒的对流调整方案必须能够精确处理这些变化的单元体积，以确保混合过程不会虚假地创造或销毁总的示踪物含量 。

### 总结

本章我们探讨了带有部分底层网格的z-level坐标系在现代海洋模拟中的多样化应用。我们看到，这项技术远不止是对地形的简单几何拟合，它深刻地影响着模型的数值行为、物理真实性以及与其他科学领域的交叉能力。

从数值角度看，通过精心设计，部分底层网格能够确保模型在处理海底摩擦和跨单元通量时的稳定性和守恒性，并与先进的压力求解器无缝集成。从[地球物理流体动力学](@entry_id:150356)的角度看，它通过提供更精确的有效水深和几何边界，使得模型能够更真实地模拟波动和位涡等基本动力学过程。

在应用层面，部分底层网格是准确模拟大规模环流、海岸带[润湿](@entry_id:147044)-干涸过程以及与海冰等其他地球系统组分相互作用的关键。它代表了一种在计算精度和效率之间的有力折中，相比简单的阶梯状z-grid显著减少了压力梯度误差，同时又避免了[地形跟随坐标](@entry_id:1132950)系自身的一些固有难题。当然，这种方法也带来了自身的挑战，例如在设计守恒的[参数化](@entry_id:265163)方案和权衡浅水区边界层分辨率时需要特别注意。总而言之，对部分底层网格的深入理解和审慎实施，已成为构建高保真度z-level海洋模型的基石。