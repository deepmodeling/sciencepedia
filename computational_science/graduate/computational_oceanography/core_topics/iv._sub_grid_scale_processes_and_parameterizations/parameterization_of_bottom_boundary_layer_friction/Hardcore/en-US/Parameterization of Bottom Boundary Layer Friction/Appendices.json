{
    "hands_on_practices": [
        {
            "introduction": "To effectively parameterize bottom friction, we must first understand the connection between the physical structure of the near-bed flow and the simplified coefficients used in models. This practice starts with the foundational \"Law of the Wall\" to derive the quadratic drag coefficient, $C_d$, from the more physically-based roughness length, $z_0$. By working through this derivation , you will see how the drag coefficient is not an arbitrary parameter but is deeply rooted in the turbulent boundary layer theory.",
            "id": "3806846",
            "problem": "A steady, horizontally uniform, neutrally stratified bottom boundary layer (BBL) over a hydraulically rough seabed can be described using Reynolds-averaged Navier–Stokes (RANS) theory together with a Prandtl–von Kármán mixing-length closure in which the mixing length is $l=\\kappa z$, where $\\kappa$ is the von Kármán constant and $z$ is the distance above the bed. In such flows, the near-bed mean velocity profile $U(z)$, the bed shear stress $\\tau_b$, and the friction velocity $u_*$ emerge from the turbulent momentum balance and the closure assumptions. The roughness length $z_0$ parameterizes the effective momentum-absorbing height of the bed.\n\nStarting from these foundations, derive the relationship linking $U(z)$, $u_*$, and $z_0$ and the connection between $\\tau_b$ and $u_*$. Define the drag coefficient at a reference height $z_r$ by $C_d \\equiv \\tau_b/\\left(\\rho\\,U(z_r)^2\\right)$, where $\\rho$ is the seawater density. Then, for seawater with $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$, a von Kármán constant $\\kappa=0.4$, reference velocity $U(z_r)=0.25\\,\\mathrm{m\\,s^{-1}}$ measured at $z_r=1\\,\\mathrm{m}$ above the bed, and roughness length $z_0=0.01\\,\\mathrm{m}$, compute $C_d$, $u_*$, and $\\tau_b$.\n\nRound each quantity to four significant figures. Express $u_*$ in $\\mathrm{m\\,s^{-1}}$, $\\tau_b$ in $\\mathrm{N\\,m^{-2}}$, and note that $C_d$ is dimensionless.",
            "solution": "The problem requires the derivation of fundamental relationships for a neutrally stratified, steady, horizontally uniform turbulent bottom boundary layer and the subsequent calculation of key parameters. We begin from first principles.\n\nFor a steady ($\\partial/\\partial t = 0$), horizontally uniform ($\\partial/\\partial x = \\partial/\\partial y = 0$) flow, the Reynolds-averaged momentum equation in the horizontal direction simplifies. Assuming the only forcing is a pressure gradient balanced by friction (as in a geostrophic flow with an Ekman layer, but we are concerned only with the near-bed layer where rotation is often negligible for the momentum balance), the dominant balance in the near-bed region is between the vertical divergence of the turbulent stress and a pressure gradient/Coriolis term. For a simple channel flow or a boundary layer far from the upper surface, this balance simplifies further. The problem implies a constant-stress layer, a standard assumption near the boundary. In this layer, the vertical flux of momentum, or shear stress $\\tau$, is constant with height $z$ and equal to the bed shear stress, $\\tau_b$.\n$$\n\\tau(z) = \\tau_b = \\text{constant}\n$$\nThe shear stress is composed of viscous and turbulent (Reynolds) stresses. For a hydraulically rough flow, the turbulent stress dominates, so $\\tau \\approx -\\rho \\overline{u'w'}$, where $\\rho$ is the fluid density and $\\overline{u'w'}$ is the time-averaged product of horizontal and vertical velocity fluctuations.\n\nThe Prandtl–von Kármán mixing-length model provides a closure for the Reynolds stress:\n$$\n-\\overline{u'w'} = \\nu_T \\frac{dU}{dz}\n$$\nwhere $\\nu_T$ is the eddy viscosity and $\\frac{dU}{dz}$ is the mean velocity shear. The eddy viscosity is parameterized using a mixing length $l$:\n$$\n\\nu_T = l^2 \\left|\\frac{dU}{dz}\\right|\n$$\nThe problem specifies the mixing length as $l = \\kappa z$, where $\\kappa$ is the von Kármán constant. The velocity $U$ is expected to increase with $z$, so $\\frac{dU}{dz} > 0$. Combining these gives:\n$$\n\\tau = \\rho (\\kappa z)^2 \\left(\\frac{dU}{dz}\\right)^2\n$$\nBy definition, the friction velocity $u_*$ is related to the bed shear stress $\\tau_b$ by:\n$$\nu_* \\equiv \\sqrt{\\frac{\\tau_b}{\\rho}}\n$$\nThis implies the first requested relationship, $\\tau_b = \\rho u_*^2$. Since the stress is constant in the layer, $\\tau(z) = \\tau_b$, we can write:\n$$\nu_*^2 = (\\kappa z)^2 \\left(\\frac{dU}{dz}\\right)^2\n$$\nTaking the positive square root (since $u_* > 0$, $\\kappa > 0$, $z > 0$, and $dU/dz > 0$):\n$$\nu_* = \\kappa z \\frac{dU}{dz}\n$$\nThis is a separable first-order ordinary differential equation for the velocity profile $U(z)$. We rearrange and integrate to find $U(z)$:\n$$\ndU = \\frac{u_*}{\\kappa} \\frac{dz}{z}\n$$\nTo solve this, we must establish a boundary condition. For a hydraulically rough surface, the velocity profile extrapolates to zero not at the bed itself ($z=0$), but at a height $z_0$ known as the roughness length. Thus, the lower limit of integration is $U(z_0) = 0$.\n$$\n\\int_{0}^{U(z)} dU' = \\int_{z_0}^{z} \\frac{u_*}{\\kappa} \\frac{dz'}{z'}\n$$\n$$\nU(z) - 0 = \\frac{u_*}{\\kappa} \\left[ \\ln(z') \\right]_{z_0}^{z}\n$$\nThis yields the logarithmic velocity profile, or the \"Law of the Wall\" for a rough surface:\n$$\nU(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)\n$$\nThis is the relationship linking $U(z)$, $u_*$, and $z_0$.\n\nNow, we proceed to compute the requested quantities. The drag coefficient $C_d$ is defined at a reference height $z_r$:\n$$\nC_d \\equiv \\frac{\\tau_b}{\\rho U(z_r)^2}\n$$\nWe can substitute our derived expressions for $\\tau_b$ and $U(z_r)$ into this definition:\n$$\n\\tau_b = \\rho u_*^2\n$$\n$$\nU(z_r) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z_r}{z_0}\\right)\n$$\nSubstituting these into the expression for $C_d$:\n$$\nC_d = \\frac{\\rho u_*^2}{\\rho \\left( \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z_r}{z_0}\\right) \\right)^2} = \\frac{\\rho u_*^2}{\\rho \\frac{u_*^2}{\\kappa^2} \\left( \\ln\\left(\\frac{z_r}{z_0}\\right) \\right)^2}\n$$\nThe terms $\\rho$ and $u_*^2$ cancel, leading to a simple expression for the drag coefficient that depends only on the reference height, roughness length, and the von Kármán constant:\n$$\nC_d = \\left( \\frac{\\kappa}{\\ln(z_r/z_0)} \\right)^2\n$$\nUsing the provided values: $\\kappa = 0.4$, $z_r = 1\\,\\mathrm{m}$, and $z_0 = 0.01\\,\\mathrm{m}$.\n$$\nC_d = \\left( \\frac{0.4}{\\ln(1 / 0.01)} \\right)^2 = \\left( \\frac{0.4}{\\ln(100)} \\right)^2\n$$\nNumerically, $\\ln(100) \\approx 4.605170185988092$.\n$$\nC_d \\approx \\left( \\frac{0.4}{4.605170} \\right)^2 \\approx (0.0868588...)^2 \\approx 0.00754415...\n$$\nRounding to four significant figures, $C_d \\approx 0.007544$.\n\nNext, we calculate the friction velocity $u_*$. We can rearrange the Law of the Wall evaluated at $z=z_r$:\n$$\nu_* = \\frac{\\kappa U(z_r)}{\\ln(z_r/z_0)}\n$$\nUsing the given values: $U(z_r) = 0.25\\,\\mathrm{m\\,s^{-1}}$, $\\kappa=0.4$, $z_r=1\\,\\mathrm{m}$, $z_0=0.01\\,\\mathrm{m}$.\n$$\nu_* = \\frac{0.4 \\times 0.25}{\\ln(100)} = \\frac{0.1}{\\ln(100)}\n$$\n$$\nu_* \\approx \\frac{0.1}{4.605170} \\approx 0.0217147... \\,\\mathrm{m\\,s^{-1}}\n$$\nRounding to four significant figures, $u_* \\approx 0.02171\\,\\mathrm{m\\,s^{-1}}$.\n\nFinally, we calculate the bed shear stress $\\tau_b$ using its definition in terms of $u_*$:\n$$\n\\tau_b = \\rho u_*^2\n$$\nUsing the value $\\rho = 1025\\,\\mathrm{kg\\,m^{-3}}$ and the unrounded value of $u_*$ for precision:\n$$\n\\tau_b = 1025 \\times (0.0217147...)^2 = 1025 \\times (0.00047151...)\\,\\mathrm{N\\,m^{-2}}\n$$\n$$\n\\tau_b \\approx 0.483299... \\,\\mathrm{N\\,m^{-2}}\n$$\nRounding to four significant figures, $\\tau_b \\approx 0.4833\\,\\mathrm{N\\,m^{-2}}$.\n\nThe computed quantities, rounded to four significant figures, are:\nThe drag coefficient $C_d = 0.007544$.\nThe friction velocity $u_* = 0.02171\\,\\mathrm{m\\,s^{-1}}$.\nThe bed shear stress $\\tau_b = 0.4833\\,\\mathrm{N\\,m^{-2}}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.007544  0.02171  0.4833\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from mean flow properties to the turbulence model itself, this exercise explores how the logarithmic layer theory provides boundary conditions for advanced computational models. You will derive the \"wall functions\" for turbulent kinetic energy ($k$) and its dissipation rate ($\\epsilon$) based on the assumption of local equilibrium . This practice illuminates a critical aspect of computational fluid dynamics: how theoretical profiles are used to bridge the gap between the physical boundary and the first grid point of a numerical model.",
            "id": "3806841",
            "problem": "A coastal ocean model uses a first-order turbulence closure based on the standard turbulent kinetic energy–dissipation rate ($k$–$\\epsilon$) framework in a steady, neutrally stratified, horizontally homogeneous bottom boundary layer over a hydraulically rough seabed. The vertical coordinate $z$ is measured upward from the physical bottom, and the bed roughness is characterized by a hydrodynamic roughness length $z_0$. The model places its first prognostic point for turbulence at height $z_1$ above the bottom. Assume the following foundational basis:\n\n1. The mean momentum balance in the overlap layer admits the logarithmic law of the wall for the mean velocity profile,\n$$\nU(z) \\;=\\; \\frac{u_*}{\\kappa}\\,\\ln\\!\\left(\\frac{z}{z_0}\\right),\n$$\nwith von Kármán constant $\\kappa$ and friction velocity $u_*$ defined by the turbulent stress at the bed.\n\n2. In the equilibrium overlap layer, the turbulent kinetic energy (TKE) production balances dissipation, $P=\\epsilon$, where production per unit mass is $P \\;=\\; \\nu_t \\left(\\frac{dU}{dz}\\right)^2$, and the eddy viscosity is parameterized by the standard $k$–$\\epsilon$ closure $\\nu_t \\;=\\; C_\\mu\\,\\frac{k^2}{\\epsilon}$ with model constant $C_\\mu$.\n\nGiven\n- $u_* \\;=\\; 0.015~\\mathrm{m~s^{-1}}$,\n- $\\kappa \\;=\\; 0.41$,\n- $C_\\mu \\;=\\; 0.09$,\n- $z_0 \\;=\\; 1.0\\times 10^{-3}~\\mathrm{m}$,\n- $z_1 \\;=\\; 2.0\\times 10^{-2}~\\mathrm{m}$,\n\nperform the following:\n\n(a) Using only the foundational basis above, derive expressions for the wall-function values $k(z_1)$ and $\\epsilon(z_1)$ implied by equilibrium in the logarithmic layer, and then compute their numerical values.\n\n(b) To assess the impact of placing $z_1$ too close to $z_0$, suppose the actual near-wall shear departs from the ideal overlap-layer form such that the true mean shear is better represented by replacing $z$ with $z+z_0$ in the logarithmic gradient. Under this modified gradient assumption, the “true” dissipation at $z_1$ would be $\\epsilon_{\\text{true}}(z_1)$, whereas the wall-function value remains $\\epsilon_{\\text{wf}}(z_1)$ from part (a). Derive the relative bias\n$$\n\\delta_\\epsilon \\;=\\; \\frac{\\epsilon_{\\text{wf}}(z_1) - \\epsilon_{\\text{true}}(z_1)}{\\epsilon_{\\text{true}}(z_1)}\n$$\nas a closed-form expression in terms of $z_1$ and $z_0$, and compute its numerical value.\n\nReport your final numerical answers for $k(z_1)$ in $\\mathrm{m^2~s^{-2}}$, $\\epsilon(z_1)$ in $\\mathrm{m^2~s^{-3}}$, and $\\delta_\\epsilon$ as a dimensionless decimal. Round all three to four significant figures.",
            "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, and objective. It presents a standard problem in turbulence modeling within the context of geophysical fluid dynamics. All necessary data and physical assumptions are provided, and the problem is free of contradictions or ambiguities.\n\nPart (a): Derivation of wall-function values for $k(z_1)$ and $\\epsilon(z_1)$.\n\nWe begin with the provided logarithmic law of the wall for the mean velocity profile $U(z)$:\n$$\nU(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)\n$$\nThe mean velocity shear, $\\frac{dU}{dz}$, is found by differentiating $U(z)$ with respect to $z$:\n$$\n\\frac{dU}{dz} = \\frac{d}{dz} \\left( \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right) \\right) = \\frac{u_*}{\\kappa} \\cdot \\frac{1}{z}\n$$\nIn the equilibrium overlap layer, the production of turbulent kinetic energy (TKE), $P$, balances the dissipation rate, $\\epsilon$. The production per unit mass is given by $P = u_*^2 \\left(\\frac{dU}{dz}\\right)$, which represents the rate of work done by the mean flow against the turbulent stress, where the turbulent stress in the constant-stress layer is $\\tau = \\rho u_*^2$. Therefore, the local equilibrium condition $P=\\epsilon$ yields:\n$$\n\\epsilon(z) = u_*^2 \\left(\\frac{dU}{dz}\\right) = u_*^2 \\left(\\frac{u_*}{\\kappa z}\\right) = \\frac{u_*^3}{\\kappa z}\n$$\nThis expression provides the dissipation rate $\\epsilon$ as a function of height $z$ in the logarithmic layer. Evaluating this at $z=z_1$ gives the wall-function value for dissipation, which we denote $\\epsilon_{\\text{wf}}(z_1)$:\n$$\n\\epsilon_{\\text{wf}}(z_1) = \\frac{u_*^3}{\\kappa z_1}\n$$\nTo find the TKE, $k$, we use the two provided definitions for the eddy viscosity, $\\nu_t$. First, from the $k-\\epsilon$ closure:\n$$\n\\nu_t = C_\\mu \\frac{k^2}{\\epsilon}\n$$\nSecond, from the definition of friction velocity in the constant stress layer, $u_*^2 = \\nu_t \\frac{dU}{dz}$. Substituting the expression for the shear, we find:\n$$\nu_*^2 = \\nu_t \\left(\\frac{u_*}{\\kappa z}\\right) \\implies \\nu_t = u_* \\kappa z\n$$\nEquating the two expressions for $\\nu_t$:\n$$\nC_\\mu \\frac{k^2}{\\epsilon} = u_* \\kappa z\n$$\nNow, we can solve for $k$. We substitute our previously derived expression for $\\epsilon(z) = \\frac{u_*^3}{\\kappa z}$:\n$$\nC_\\mu \\frac{k^2}{\\left(\\frac{u_*^3}{\\kappa z}\\right)} = u_* \\kappa z\n$$\n$$\nC_\\mu \\frac{k^2 \\kappa z}{u_*^3} = u_* \\kappa z\n$$\nAssuming $z > 0$, we can cancel $\\kappa z$ from both sides:\n$$\nC_\\mu \\frac{k^2}{u_*^3} = u_* \\implies C_\\mu k^2 = u_*^4\n$$\nSolving for $k$, we find:\n$$\nk^2 = \\frac{u_*^4}{C_\\mu} \\implies k = \\frac{u_*^2}{\\sqrt{C_\\mu}}\n$$\nThis result indicates that under the assumption of local equilibrium in the logarithmic layer, the TKE, $k$, is constant with height. The wall-function value at $z_1$ is therefore:\n$$\nk(z_1) = \\frac{u_*^2}{\\sqrt{C_\\mu}}\n$$\nWe now compute the numerical values using the given constants: $u_* = 0.015~\\mathrm{m~s^{-1}}$, $\\kappa = 0.41$, $C_\\mu = 0.09$, $z_0 = 1.0\\times 10^{-3}~\\mathrm{m}$, and $z_1 = 2.0\\times 10^{-2}~\\mathrm{m}$.\n\nFor $k(z_1)$:\n$$\nk(z_1) = \\frac{(0.015)^2}{\\sqrt{0.09}} = \\frac{2.25 \\times 10^{-4}}{0.3} = 7.5 \\times 10^{-4}~\\mathrm{m^2~s^{-2}}\n$$\nRounding to four significant figures, $k(z_1) = 7.500 \\times 10^{-4}~\\mathrm{m^2~s^{-2}}$.\n\nFor $\\epsilon(z_1)$, which we label $\\epsilon_{\\text{wf}}(z_1)$ for part (b):\n$$\n\\epsilon_{\\text{wf}}(z_1) = \\frac{(0.015)^3}{(0.41)(2.0 \\times 10^{-2})} = \\frac{3.375 \\times 10^{-6}}{8.2 \\times 10^{-3}} \\approx 4.11585 \\times 10^{-4}~\\mathrm{m^2~s^{-3}}\n$$\nRounding to four significant figures, $\\epsilon_{\\text{wf}}(z_1) \\approx 4.116 \\times 10^{-4}~\\mathrm{m^2~s^{-3}}$.\n\nPart (b): Derivation and computation of the relative bias $\\delta_\\epsilon$.\n\nThe problem posits a \"true\" mean shear that is better represented by replacing $z$ with $z+z_0$ in the logarithmic gradient. The standard gradient was $\\frac{u_*}{\\kappa z}$. The modified \"true\" gradient is therefore:\n$$\n\\left(\\frac{dU}{dz}\\right)_{\\text{true}} = \\frac{u_*}{\\kappa(z+z_0)}\n$$\nAssuming the relation $\\epsilon = u_*^2 \\left(\\frac{dU}{dz}\\right)$ remains valid for this \"true\" state, the true dissipation rate at height $z_1$ is:\n$$\n\\epsilon_{\\text{true}}(z_1) = u_*^2 \\left(\\frac{dU}{dz}\\right)_{\\text{true}} \\bigg|_{z=z_1} = \\frac{u_*^3}{\\kappa(z_1+z_0)}\n$$\nThe wall-function dissipation, $\\epsilon_{\\text{wf}}(z_1)$, is the value derived in part (a):\n$$\n\\epsilon_{\\text{wf}}(z_1) = \\frac{u_*^3}{\\kappa z_1}\n$$\nThe relative bias $\\delta_\\epsilon$ is defined as:\n$$\n\\delta_\\epsilon = \\frac{\\epsilon_{\\text{wf}}(z_1) - \\epsilon_{\\text{true}}(z_1)}{\\epsilon_{\\text{true}}(z_1)}\n$$\nSubstituting the derived expressions for $\\epsilon_{\\text{wf}}(z_1)$ and $\\epsilon_{\\text{true}}(z_1)$:\n$$\n\\delta_\\epsilon = \\frac{\\frac{u_*^3}{\\kappa z_1} - \\frac{u_*^3}{\\kappa(z_1+z_0)}}{\\frac{u_*^3}{\\kappa(z_1+z_0)}}\n$$\nThe common factor $\\frac{u_*^3}{\\kappa}$ cancels from the numerator and denominator:\n$$\n\\delta_\\epsilon = \\frac{\\frac{1}{z_1} - \\frac{1}{z_1+z_0}}{\\frac{1}{z_1+z_0}}\n$$\nTo simplify this complex fraction, we can write the expression as $\\delta_\\epsilon = \\frac{\\epsilon_{\\text{wf}}(z_1)}{\\epsilon_{\\text{true}}(z_1)} - 1$:\n$$\n\\delta_\\epsilon = \\frac{\\frac{u_*^3}{\\kappa z_1}}{\\frac{u_*^3}{\\kappa(z_1+z_0)}} - 1 = \\frac{z_1+z_0}{z_1} - 1\n$$\n$$\n\\delta_\\epsilon = \\left(1 + \\frac{z_0}{z_1}\\right) - 1 = \\frac{z_0}{z_1}\n$$\nThis is the closed-form expression for the relative bias. It shows that the bias is simply the ratio of the roughness length to the height of the first grid point.\nNow, we compute the numerical value:\n$$\n\\delta_\\epsilon = \\frac{1.0 \\times 10^{-3}~\\mathrm{m}}{2.0 \\times 10^{-2}~\\mathrm{m}} = \\frac{1}{20} = 0.05\n$$\nRounding to four significant figures, this dimensionless value is $0.05000$.\n\nThe final results, rounded to four significant figures, are:\n- $k(z_1) = 7.500 \\times 10^{-4}~\\mathrm{m^2~s^{-2}}$\n- $\\epsilon(z_1) = 4.116 \\times 10^{-4}~\\mathrm{m^2~s^{-3}}$\n- $\\delta_\\epsilon = 0.05000$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 7.500 \\times 10^{-4}  4.116 \\times 10^{-4}  0.05000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This final practice synthesizes theory and computation into a realistic data analysis workflow. Using a set of synthetic velocity profile measurements, you will fit the logarithmic law to estimate the roughness length, calculate the bottom stress, and, most importantly, quantify its uncertainty using a nonparametric bootstrap . This hands-on coding exercise provides experience with a complete research task, from processing raw data to producing a robust, uncertainty-aware estimate of a key physical parameter.",
            "id": "3806865",
            "problem": "You are provided with multiple near-bed current velocity measurements at known heights above the seabed within the Bottom Boundary Layer (BBL), along with the water density. The task is to compute the bottom shear stress $\\tau_b$ using a quadratic drag formulation in which the drag coefficient $C_d$ is determined from a fitted roughness length $z_0$ via the neutral log-law of the wall. You must also quantify uncertainty in $\\tau_b$ at the specified reference height using a nonparametric bootstrap of the measured pairs.\n\nFundamental base:\n- For a Newtonian fluid in the BBL under steady, neutrally stratified, horizontally homogeneous conditions, the streamwise mean velocity profile satisfies the logarithmic law: \n$$ U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right), $$\nwhere $U(z)$ is the magnitude of the mean current speed at height $z$, $u_*$ is the friction velocity defined by $u_* = \\sqrt{\\tau_b/\\rho}$, $\\rho$ is the fluid density, $\\kappa$ is the von Kármán constant, and $z_0$ is the hydrodynamic roughness length.\n- The quadratic bottom stress parameterization at a reference height $z_r$ with mean speed $U_r = U(z_r)$ is \n$$ \\tau_b = \\rho \\, C_d(z_r) \\, U_r^2, $$\nwith a drag coefficient $C_d(z_r)$ that must be derived from the log-law and the fitted $z_0$.\n\nYour program must:\n1. Fit the log-law parameters by linear least squares using the model $U(z) = A \\ln(z) + B$ to estimate $A$ and $B$, then recover the roughness length as $z_0 = \\exp\\!\\left(-\\frac{B}{A}\\right)$. Use $\\kappa = 0.41$.\n2. From the fitted $z_0$, derive the drag coefficient at the specified reference height $z_r$:\n$$ C_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0)}\\right)^2. $$\n3. Compute the point estimate $\\hat{\\tau}_b$ using the given $\\rho$ and the measured $U_r$ at $z_r$.\n4. Assess the uncertainty in $\\tau_b$ using a nonparametric bootstrap: resample the $(z_i, U_i)$ pairs with replacement, refit $A$, $B$, recompute $z_0$, $C_d(z_r)$, and $\\tau_b$ for each bootstrap replicate. Use $N = 2000$ bootstrap replicates with a fixed random seed $42$. Exclude any bootstrap replicate where the fitted $A \\le 0$ or where $\\ln(z_r / z_0) \\le 0$ (which would be non-physical for the neutral log-law application at the given $z_r$). From the valid replicates, report the $2.5\\%$ and $97.5\\%$ empirical percentiles as the bounds of a $95\\%$ confidence interval for $\\tau_b$.\n5. Express $\\tau_b$ in pascals ($\\mathrm{Pa}$) as floating-point values; $C_d$ is unitless.\n\nTest suite:\n- Case 1 (general scenario):\n  - Heights: $z = [0.2, 0.5, 1.0, 1.5, 2.0] \\, \\mathrm{m}$\n  - Speeds: $U = [0.224, 0.271, 0.303, 0.322, 0.337] \\, \\mathrm{m/s}$\n  - Density: $\\rho = 1025 \\, \\mathrm{kg/m^3}$\n  - Reference height: $z_r = 1.0 \\, \\mathrm{m}$\n  - Reference speed: $U_r = 0.303 \\, \\mathrm{m/s}$\n- Case 2 (smooth-bed boundary-like condition):\n  - Heights: $z = [0.05, 0.1, 0.2, 0.5, 1.0] \\, \\mathrm{m}$\n  - Speeds: $U = [0.152, 0.176, 0.200, 0.215, 0.224] \\, \\mathrm{m/s}$\n  - Density: $\\rho = 1027 \\, \\mathrm{kg/m^3}$\n  - Reference height: $z_r = 0.5 \\, \\mathrm{m}$\n  - Reference speed: $U_r = 0.215 \\, \\mathrm{m/s}$\n- Case 3 (sparse data edge case):\n  - Heights: $z = [0.3, 0.6, 1.2] \\, \\mathrm{m}$\n  - Speeds: $U = [0.299, 0.350, 0.400] \\, \\mathrm{m/s}$\n  - Density: $\\rho = 1024 \\, \\mathrm{kg/m^3}$\n  - Reference height: $z_r = 0.6 \\, \\mathrm{m}$\n  - Reference speed: $U_r = 0.350 \\, \\mathrm{m/s}$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for all three test cases as a comma-separated list enclosed in square brackets, where each test case’s result is itself a list in the order $[\\hat{\\tau}_b, \\tau_{b,\\mathrm{low}}, \\tau_{b,\\mathrm{high}}, \\hat{C}_d]$. Here $\\hat{\\tau}_b$ is the point estimate, $\\tau_{b, \\mathrm{low}}$ and $\\tau_{b, \\mathrm{high}}$ are the lower and upper bounds of the $95\\%$ confidence interval from bootstrapping, and $\\hat{C}_d$ is the point estimate of the drag coefficient at $z_r$. For example, the output should look like \n$$ [ [x_1,y_1,z_1,w_1], [x_2,y_2,z_2,w_2], [x_3,y_3,z_3,w_3] ] $$\nwith numeric values in place of $x_i, y_i, z_i, w_i$.",
            "solution": "The problem requires the computation of bottom shear stress, $\\tau_b$, and its associated uncertainty from near-bed velocity profile measurements. The method prescribed is based on the logarithmic law of the wall, a fundamental principle of turbulent boundary layer theory, combined with a quadratic drag law formulation and nonparametric bootstrapping for uncertainty analysis.\n\nThe process begins by validating the problem statement.\n\n### Step 1: Extract Givens\n- **Governing Equation (Logarithmic Law of the Wall):** For a steady, neutrally stratified, horizontally homogeneous Bottom Boundary Layer (BBL), the mean current speed $U(z)$ at a height $z$ above the seabed is given by:\n$$ U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right) $$\n- **Friction Velocity Definition:** $u_* = \\sqrt{\\tau_b/\\rho}$, where $\\tau_b$ is the bottom shear stress and $\\rho$ is the fluid density.\n- **Quadratic Drag Law:** The bottom shear stress at a reference height $z_r$ is parameterized as:\n$$ \\tau_b = \\rho \\, C_d(z_r) \\, U_r^2 $$\nwhere $U_r = U(z_r)$ is the speed at $z_r$ and $C_d(z_r)$ is the drag coefficient at that height.\n- **Linear Model for Fitting:** The log-law is to be fitted using the linear model $U(z) = A \\ln(z) + B$.\n- **Parameter Recovery:** The hydrodynamic roughness length $z_0$ is recovered from the fit parameters $A$ and $B$ using the formula:\n$$ z_0 = \\exp\\!\\left(-\\frac{B}{A}\\right) $$\n- **Drag Coefficient Formula:** The drag coefficient $C_d(z_r)$ is derived from the fitted $z_0$:\n$$ C_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0)}\\right)^2 $$\n- **Constants:** The von Kármán constant is $\\kappa = 0.41$.\n- **Bootstrap Parameters:** The number of bootstrap replicates is $N = 2000$, and the random seed is fixed at $42$.\n- **Bootstrap Filtering Conditions:** Exclude replicates where the fitted slope $A \\le 0$ or where $\\ln(z_r / z_0) \\le 0$.\n- **Uncertainty Quantification:** The $95\\%$ confidence interval for $\\tau_b$ is defined by the $2.5\\%$ and $97.5\\%$ empirical percentiles of the valid bootstrap replicates.\n- **Test Cases:** Three distinct test cases are provided, each with a set of heights $z$, corresponding speeds $U$, fluid density $\\rho$, a reference height $z_r$, and the speed at that reference height $U_r$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in the classical theory of turbulent boundary layers. The logarithmic law of the wall is a cornerstone of fluid dynamics, and the quadratic drag law is a standard parameterization in oceanography and meteorology. The provided equations are consistent with fundamental principles. The value of $\\kappa = 0.41$ is a standard, widely-used value. The problem is scientifically sound.\n- **Well-Posed:** The problem is well-posed. It specifies a clear sequence of operations: linear least-squares fitting, direct calculation of physical parameters, and a standard statistical procedure (nonparametric bootstrapping) for uncertainty estimation. The filtering conditions for the bootstrap procedure prevent non-physical or mathematically undefined results, ensuring robustness. The existence and uniqueness of the solution for each step are guaranteed under normal conditions (e.g., non-uniform data points).\n- **Objective:** The problem is stated with objective and precise language. All required data, constants, and formulas are provided unambiguously. There are no subjective elements.\n- **Other Flaws:** The problem is self-contained, with no missing information or contradictions. The requested conditions and data are physically plausible for oceanic bottom boundary layers. The structure is logical, and the task is a standard data analysis problem in the field, not trivial or tautological.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, objective, and complete. A step-by-step solution can be computed.\n\n### Solution Derivation\n\nThe solution proceeds in four main stages for each test case: (1) fitting the log-law to determine the profile parameters, (2) calculating point estimates of the drag coefficient $C_d$ and bottom stress $\\tau_b$, (3) performing a bootstrap analysis to quantify uncertainty in $\\tau_b$, and (4) reporting the results.\n\n**1. Log-Law Profile Fitting**\nThe relationship $U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)$ can be rewritten as $U(z) = \\frac{u_*}{\\kappa} \\ln(z) - \\frac{u_*}{\\kappa} \\ln(z_0)$. This matches the linear form $U(z) = A \\ln(z) + B$, where the slope is $A = u_*/\\kappa$ and the intercept is $B = - (u_*/\\kappa) \\ln(z_0)$.\nGiven a set of measurement pairs $(z_i, U_i)$, we first transform the heights to $x_i = \\ln(z_i)$. We then perform a linear least-squares regression on the $(x_i, U_i)$ pairs to find the best-fit coefficients $\\hat{A}$ and $\\hat{B}$.\nFrom these coefficients, the hydrodynamic roughness length $\\hat{z}_0$ is estimated. Since $\\hat{B}/\\hat{A} = -\\ln(\\hat{z}_0)$, we have:\n$$ \\hat{z}_0 = \\exp\\left(-\\frac{\\hat{B}}{\\hat{A}}\\right) $$\n\n**2. Point Estimates of $C_d$ and $\\tau_b$**\nWith the estimated roughness length $\\hat{z}_0$, the drag coefficient $\\hat{C}_d$ at the specified reference height $z_r$ is calculated. This formula is derived by combining the definition of $C_d$ with the log-law:\n$C_d(z_r) = (u_*/U_r)^2$ and $U_r = (u_*/\\kappa)\\ln(z_r/z_0)$, which gives $u_*/U_r = \\kappa/\\ln(z_r/z_0)$. Therefore:\n$$ \\hat{C}_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / \\hat{z}_0)}\\right)^2 $$\nThe point estimate for the bottom shear stress, $\\hat{\\tau}_b$, is then computed using the quadratic drag law with the given density $\\rho$, the measured reference speed $U_r$, and the estimated drag coefficient $\\hat{C}_d(z_r)$:\n$$ \\hat{\\tau}_b = \\rho \\, \\hat{C}_d(z_r) \\, U_r^2 $$\n\n**3. Bootstrap Uncertainty Quantification**\nTo assess the uncertainty in $\\tau_b$ arising from the variability in the velocity measurements, we employ a nonparametric bootstrap. This statistical technique involves repeated resampling of the original data to simulate a distribution of possible outcomes. The procedure is as follows:\n- A fixed random seed ($42$) is used to ensure reproducibility.\n- A total of $N=2000$ bootstrap replicates are generated. For each replicate:\n    a. A new dataset of $(z_i, U_i)$ pairs is created by drawing with replacement from the original set of measurements. The size of the new dataset is the same as the original.\n    b. The log-law fitting procedure is repeated on this resampled dataset to obtain a new set of coefficients, $A^*$ and $B^*$.\n    c. The new coefficients are validated. If $A^* \\le 0$, the replicate is discarded as it implies a non-physical zero or negative friction velocity.\n    d. A new roughness length $z_0^* = \\exp(-B^*/A^*)$ is computed.\n    e. The applicability of the log-law at the reference height is checked. If $\\ln(z_r/z_0^*) \\le 0$ (i.e., $z_r \\le z_0^*$), the reference height is below the roughness length, which is non-physical. The replicate is discarded.\n    f. For valid replicates, a bootstrap estimate of the drag coefficient $C_d^*(z_r)$ and bottom stress $\\tau_b^*$ are calculated:\n    $$ C_d^*(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0^*)}\\right)^2 $$\n    $$ \\tau_b^* = \\rho \\, C_d^*(z_r) \\, U_r^2 $$\n- After generating all replicates, the collection of valid $\\tau_b^*$ values forms the bootstrap distribution of the bottom shear stress.\n\n**4. Confidence Interval and Reporting**\nThe $95\\%$ confidence interval for $\\tau_b$ is determined from the empirical bootstrap distribution. The lower bound, $\\tau_{b, \\text{low}}$, is the $2.5$-th percentile, and the upper bound, $\\tau_{b, \\text{high}}$, is the $97.5$-th percentile of the sorted $\\tau_b^*$ values.\nFor each test case, the final result is a collection of four values: the point estimate of the shear stress $\\hat{\\tau}_b$, the lower and upper bounds of its confidence interval ($\\tau_{b, \\text{low}}$, $\\tau_{b, \\text{high}}$), and the point estimate of the drag coefficient $\\hat{C}_d(z_r)$. These results are then formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the bottom boundary layer friction problem for the given test cases.\n    \"\"\"\n    \n    KAPPA = 0.41\n    N_BOOTSTRAP = 2000\n    RANDOM_SEED = 42\n    \n    test_cases = [\n        {\n            \"z\": np.array([0.2, 0.5, 1.0, 1.5, 2.0]),\n            \"U\": np.array([0.224, 0.271, 0.303, 0.322, 0.337]),\n            \"rho\": 1025.0,\n            \"z_r\": 1.0,\n            \"U_r\": 0.303\n        },\n        {\n            \"z\": np.array([0.05, 0.1, 0.2, 0.5, 1.0]),\n            \"U\": np.array([0.152, 0.176, 0.200, 0.215, 0.224]),\n            \"rho\": 1027.0,\n            \"z_r\": 0.5,\n            \"U_r\": 0.215\n        },\n        {\n            \"z\": np.array([0.3, 0.6, 1.2]),\n            \"U\": np.array([0.299, 0.350, 0.400]),\n            \"rho\": 1024.0,\n            \"z_r\": 0.6,\n            \"U_r\": 0.350\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        z = case[\"z\"]\n        U = case[\"U\"]\n        rho = case[\"rho\"]\n        z_r = case[\"z_r\"]\n        U_r = case[\"U_r\"]\n        \n        # --- Point Estimate Calculations ---\n        # Fit U = A*ln(z) + B\n        log_z = np.log(z)\n        A, B = np.polyfit(log_z, U, 1)\n        \n        # Calculate z0, Cd, and tau_b\n        z0_hat = np.exp(-B / A)\n        log_zr_z0 = np.log(z_r / z0_hat)\n        Cd_hat = (KAPPA / log_zr_z0)**2\n        tau_b_hat = rho * Cd_hat * (U_r**2)\n        \n        # --- Bootstrap for Uncertainty ---\n        rng = np.random.default_rng(RANDOM_SEED)\n        n_points = len(z)\n        tau_b_samples = []\n        \n        for _ in range(N_BOOTSTRAP):\n            indices = rng.choice(n_points, size=n_points, replace=True)\n            z_sample = z[indices]\n            U_sample = U[indices]\n            \n            # Ensure unique points for fitting to avoid singular matrix\n            if len(np.unique(np.log(z_sample)))  2:\n                continue\n\n            # Fit the resampled data\n            log_z_sample = np.log(z_sample)\n            A_star, B_star = np.polyfit(log_z_sample, U_sample, 1)\n            \n            # Filter non-physical results\n            if A_star = 0:\n                continue\n            \n            z0_star = np.exp(-B_star / A_star)\n            log_zr_z0_star = np.log(z_r / z0_star)\n            \n            if log_zr_z0_star = 0:\n                continue\n            \n            # Calculate bootstrap replicate of tau_b\n            Cd_star = (KAPPA / log_zr_z0_star)**2\n            tau_b_star = rho * Cd_star * (U_r**2)\n            tau_b_samples.append(tau_b_star)\n\n        # Calculate 95% confidence interval\n        if len(tau_b_samples)  0:\n            tau_b_low = np.percentile(tau_b_samples, 2.5)\n            tau_b_high = np.percentile(tau_b_samples, 97.5)\n        else: # Should not happen with this data, but for robustness\n            tau_b_low = np.nan\n            tau_b_high = np.nan\n\n        results.append([tau_b_hat, tau_b_low, tau_b_high, Cd_hat])\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list includes spaces, which\n    # is consistent with the example format \"[ [x_1,y_1,z_1,w_1], ... ]\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}