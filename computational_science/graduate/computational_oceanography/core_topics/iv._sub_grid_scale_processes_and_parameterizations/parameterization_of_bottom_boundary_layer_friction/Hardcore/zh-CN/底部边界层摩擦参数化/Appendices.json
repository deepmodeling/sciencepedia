{
    "hands_on_practices": [
        {
            "introduction": "在海洋模型中，二次拖曳定律是一种方便的底摩擦参数化方案，但其中的拖曳系数 $C_d$ 并非一个随意设定的常数。本练习将引导你从经典的壁面律（即对数流速剖面）出发，推导 $C_d$ 的表达式，并将其与更具物理意义的海底粗糙度长度 $z_0$ 联系起来。通过这个实践 ，你将深刻理解二次拖曳定律背后的物理基础，并掌握如何根据底层物理特性来确定其关键参数。",
            "id": "3806846",
            "problem": "在水力粗糙海床上方的稳态、水平均匀、中性层结的底部边界层（BBL）可以使用雷诺平均纳维-斯托克斯（RANS）理论和普朗特-冯·卡门混合长度闭合来描述，其中混合长度为 $l=\\kappa z$，$\\kappa$ 是冯·卡门常数，$z$ 是离床高度。\n\n在此类流动中，近床平均速度剖面 $U(z)$、床面切应力 $\\tau_b$ 和摩阻流速 $u_*$ 可由湍流动量平衡和闭合假设得出。粗糙度长度 $z_0$ 参数化了床面的有效动量吸收高度。\n\n从这些基础出发，推导连接 $U(z)$、$u_*$ 和 $z_0$ 的关系式，以及 $\\tau_b$ 和 $u_*$ 之间的联系。将参考高度 $z_r$ 处的拖曳系数定义为 $C_d \\equiv \\tau_b/\\left(\\rho\\,U(z_r)^2\\right)$，其中 $\\rho$ 是海水密度。然后，对于海水密度 $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$、冯·卡门常数 $\\kappa=0.4$、在离床 $z_r=1\\,\\mathrm{m}$ 处测得的参考速度 $U(z_r)=0.25\\,\\mathrm{m\\,s^{-1}}$，以及粗糙度长度 $z_0=0.01\\,\\mathrm{m}$，计算 $C_d$、$u_*$ 和 $\\tau_b$。\n\n将每个量取四位有效数字。$u_*$ 的单位为 $\\mathrm{m\\,s^{-1}}$，$\\tau_b$ 的单位为 $\\mathrm{N\\,m^{-2}}$，并注意 $C_d$ 是无量纲的。",
            "solution": "该问题要求推导中性层结、稳态、水平均匀的湍流底部边界层的基本关系，并随后计算关键参数。我们从第一性原理开始。\n\n对于稳态（$\\partial/\\partial t = 0$）、水平均匀（$\\partial/\\partial x = \\partial/\\partial y = 0$）的流动，雷诺平均动量方程在水平方向上得以简化。假设唯一的强迫是与摩擦力平衡的压力梯度（如在地转流中的 Ekman 层），但我们只关注近床层，在此处旋转对动量平衡的影响通常可以忽略不计，近床区域的主导平衡在于湍流应力的垂直散度与压力梯度/Coriolis 项之间。对于简单的渠道流或远离上表面的边界层，该平衡进一步简化。问题暗示了一个恒应力层，这是边界附近的一个标准假设。在该层中，动量的垂直通量，即切应力 $\\tau$，不随高度 $z$ 变化，且等于床面切应力 $\\tau_b$。\n$$\n\\tau(z) = \\tau_b = \\text{constant}\n$$\n切应力由粘性应力和湍流（雷诺）应力组成。对于水力粗糙流，湍流应力占主导地位，因此 $\\tau \\approx -\\rho \\overline{u'w'}$，其中 $\\rho$ 是流体密度，$\\overline{u'w'}$ 是水平和垂直速度脉动乘积的时间平均值。\n\nPrandtl–von Kármán 混合长度模型为雷诺应力提供了一个闭合：\n$$\n-\\overline{u'w'} = \\nu_T \\frac{dU}{dz}\n$$\n其中 $\\nu_T$ 是涡粘性系数，$\\frac{dU}{dz}$ 是平均速度切变。涡粘性系数使用混合长度 $l$ 进行参数化：\n$$\n\\nu_T = l^2 \\left|\\frac{dU}{dz}\\right|\n$$\n问题指定混合长度为 $l = \\kappa z$，其中 $\\kappa$ 是 von Kármán 常数。速度 $U$ 预计随 $z$ 增加，因此 $\\frac{dU}{dz} > 0$。将这些结合起来得到：\n$$\n\\tau = \\rho (\\kappa z)^2 \\left(\\frac{dU}{dz}\\right)^2\n$$\n根据定义，摩阻流速 $u_*$ 与床面切应力 $\\tau_b$ 的关系为：\n$$\nu_* \\equiv \\sqrt{\\frac{\\tau_b}{\\rho}}\n$$\n这就得到了第一个所求的关系式，$\\tau_b = \\rho u_*^2$。由于该层中的应力是恒定的，$\\tau(z) = \\tau_b$，我们可以写出：\n$$\nu_*^2 = (\\kappa z)^2 \\left(\\frac{dU}{dz}\\right)^2\n$$\n取正平方根（因为 $u_* > 0$，$\\kappa > 0$，$z > 0$，且 $dU/dz > 0$）：\n$$\nu_* = \\kappa z \\frac{dU}{dz}\n$$\n这是一个关于速度剖面 $U(z)$ 的可分离一阶常微分方程。我们重新整理并积分以求得 $U(z)$：\n$$\ndU = \\frac{u_*}{\\kappa} \\frac{dz}{z}\n$$\n为求解此方程，我们必须建立一个边界条件。对于水力粗糙表面，速度剖面外推至零的位置不是在床面本身（$z=0$），而是在一个称为粗糙度长度的高度 $z_0$ 处。因此，积分下限为 $U(z_0) = 0$。\n$$\n\\int_{0}^{U(z)} dU' = \\int_{z_0}^{z} \\frac{u_*}{\\kappa} \\frac{dz'}{z'}\n$$\n$$\nU(z) - 0 = \\frac{u_*}{\\kappa} \\left[ \\ln(z') \\right]_{z_0}^{z}\n$$\n这就得出了对数速度剖面，或称为粗糙表面的“壁面律”：\n$$\nU(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)\n$$\n这就是连接 $U(z)$、$u_*$ 和 $z_0$ 的关系式。\n\n现在，我们开始计算所求的量。拖曳系数 $C_d$ 在参考高度 $z_r$ 处定义为：\n$$\nC_d \\equiv \\frac{\\tau_b}{\\rho U(z_r)^2}\n$$\n我们可以将推导出的 $\\tau_b$ 和 $U(z_r)$ 的表达式代入此定义中：\n$$\n\\tau_b = \\rho u_*^2\n$$\n$$\nU(z_r) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z_r}{z_0}\\right)\n$$\n将这些代入 $C_d$ 的表达式中：\n$$\nC_d = \\frac{\\rho u_*^2}{\\rho \\left( \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z_r}{z_0}\\right) \\right)^2} = \\frac{\\rho u_*^2}{\\rho \\frac{u_*^2}{\\kappa^2} \\left( \\ln\\left(\\frac{z_r}{z_0}\\right) \\right)^2}\n$$\n$\\rho$ 和 $u_*^2$ 项相互抵消，从而得到一个仅依赖于参考高度、粗糙度长度和 von Kármán 常数的拖曳系数的简单表达式：\n$$\nC_d = \\left( \\frac{\\kappa}{\\ln(z_r/z_0)} \\right)^2\n$$\n使用给定值：$\\kappa = 0.4$，$z_r = 1\\,\\mathrm{m}$，以及 $z_0 = 0.01\\,\\mathrm{m}$。\n$$\nC_d = \\left( \\frac{0.4}{\\ln(1 / 0.01)} \\right)^2 = \\left( \\frac{0.4}{\\ln(100)} \\right)^2\n$$\n数值上，$\\ln(100) \\approx 4.605170185988092$。\n$$\nC_d \\approx \\left( \\frac{0.4}{4.605170} \\right)^2 \\approx (0.0868588...)^2 \\approx 0.00754415...\n$$\n四舍五入到四位有效数字，$C_d \\approx 0.007544$。\n\n接下来，我们计算摩阻流速 $u_*$。我们可以重新整理在 $z=z_r$ 处的壁面律：\n$$\nu_* = \\frac{\\kappa U(z_r)}{\\ln(z_r/z_0)}\n$$\n使用给定值：$U(z_r) = 0.25\\,\\mathrm{m\\,s^{-1}}$，$\\kappa=0.4$，$z_r=1\\,\\mathrm{m}$，$z_0=0.01\\,\\mathrm{m}$。\n$$\nu_* = \\frac{0.4 \\times 0.25}{\\ln(100)} = \\frac{0.1}{\\ln(100)}\n$$\n$$\nu_* \\approx \\frac{0.1}{4.605170} \\approx 0.0217147... \\,\\mathrm{m\\,s^{-1}}\n$$\n四舍五入到四位有效数字，$u_* \\approx 0.02171\\,\\mathrm{m\\,s^{-1}}$。\n\n最后，我们使用 $\\tau_b$ 关于 $u_*$ 的定义来计算床面切应力：\n$$\n\\tau_b = \\rho u_*^2\n$$\n使用 $\\rho = 1025\\,\\mathrm{kg\\,m^{-3}}$ 和未经四舍五入的 $u_*$ 值以确保精度：\n$$\n\\tau_b = 1025 \\times (0.0217147...)^2 = 1025 \\times (0.00047151...)\\,\\mathrm{N\\,m^{-2}}\n$$\n$$\n\\tau_b \\approx 0.483299... \\,\\mathrm{N\\,m^{-2}}\n$$\n四舍五入到四位有效数字，$\\tau_b \\approx 0.4833\\,\\mathrm{N\\,m^{-2}}$。\n\n计算出的量，四舍五入到四位有效数字，为：\n拖曳系数 $C_d = 0.007544$。\n摩阻流速 $u_* = 0.02171\\,\\mathrm{m\\,s^{-1}}$。\n床面切应力 $\\tau_b = 0.4833\\,\\mathrm{N\\,m^{-2}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.007544  0.02171  0.4833\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了底摩擦参数化的基本理论后，下一步是了解如何将其应用于先进的计算模型中。许多海洋环流模型采用 $k-\\epsilon$ 等湍流闭合方案，这要求在底部边界为湍流变量（如湍动能 $k$ 和耗散率 $\\epsilon$）设定精确的“壁面函数”。本练习  演示了如何利用对数律层中的平衡假设来推导这些边界条件，这是将理论无缝集成到数值模拟中的关键一步。",
            "id": "3806841",
            "problem": "一个海岸海洋模型在一个稳定的、中性分层的、水平均匀的、位于水力粗糙海床上的底部边界层中，使用基于标准湍动能-耗散率（$k$–$\\epsilon$）框架的一阶湍流闭合。垂直坐标 $z$ 从物理底部向上测量，床面粗糙度由水动力粗糙度长度 $z_0$ 表征。该模型将其第一个湍流预报点设置在距离底部高度为 $z_1$ 的位置。假设以下基本前提：\n\n1. 重叠层中的平均动量平衡遵循壁面律对数律的平均速度剖面，\n$$\nU(z) \\;=\\; \\frac{u_*}{\\kappa}\\,\\ln\\!\\left(\\frac{z}{z_0}\\right),\n$$\n其中 von Kármán 常数 $\\kappa$ 和摩擦速度 $u_*$ 由床面湍流应力定义。\n\n2. 在平衡重叠层中，湍动能（TKE）的生成与耗散平衡，$P=\\epsilon$，其中单位质量的生成率为 $P \\;=\\; \\nu_t \\left(\\frac{dU}{dz}\\right)^2$，涡粘性系数通过标准 $k$–$\\epsilon$ 闭合 $\\nu_t \\;=\\; C_\\mu\\,\\frac{k^2}{\\epsilon}$ 进行参数化，模型常数为 $C_\\mu$。\n\n给定\n- $u_* \\;=\\; 0.015~\\mathrm{m~s^{-1}}$,\n- $\\kappa \\;=\\; 0.41$,\n- $C_\\mu \\;=\\; 0.09$,\n- $z_0 \\;=\\; 1.0\\times 10^{-3}~\\mathrm{m}$,\n- $z_1 \\;=\\; 2.0\\times 10^{-2}~\\mathrm{m}$,\n\n执行以下操作：\n\n(a) 仅使用上述基本前提，推导由对数层中的平衡所隐含的壁面函数值 $k(z_1)$ 和 $\\epsilon(z_1)$ 的表达式，然后计算它们的数值。\n\n(b) 为评估将 $z_1$ 放置得太靠近 $z_0$ 的影响，假设实际的近壁面切变偏离了理想的重叠层形式，使得真实的平均切变可以通过在对数梯度中用 $z+z_0$ 替换 $z$ 来更好地表示。在此修正的梯度假设下，$z_1$ 处的“真实”耗散率为 $\\epsilon_{\\text{true}}(z_1)$，而壁面函数值仍为 (a) 部分的 $\\epsilon_{\\text{wf}}(z_1)$。推导相对偏差\n$$\n\\delta_\\epsilon \\;=\\; \\frac{\\epsilon_{\\text{wf}}(z_1) - \\epsilon_{\\text{true}}(z_1)}{\\epsilon_{\\text{true}}(z_1)}\n$$\n的闭式表达式（用 $z_1$ 和 $z_0$ 表示），并计算其数值。\n\n报告您最终的数值答案，$k(z_1)$ 的单位为 $\\mathrm{m^2~s^{-2}}$，$\\epsilon(z_1)$ 的单位为 $\\mathrm{m^2~s^{-3}}$，$\\delta_\\epsilon$ 为无量纲小数。将所有三个数值四舍五入至四位有效数字。",
            "solution": "该问题陈述已经过验证，被认为是具有科学依据、良定且客观的。它提出了一个在地球物理流体动力学背景下湍流模拟的标准问题。所有必要的数据和物理假设都已提供，问题没有矛盾或含糊之处。\n\n(a) 部分：$k(z_1)$ 和 $\\epsilon(z_1)$ 壁面函数值的推导。\n\n我们从给定的平均速度剖面 $U(z)$ 的壁面律对数律开始：\n$$\nU(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)\n$$\n平均速度切变 $\\frac{dU}{dz}$ 通过对 $U(z)$ 关于 $z$ 求导得到：\n$$\n\\frac{dU}{dz} = \\frac{d}{dz} \\left( \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right) \\right) = \\frac{u_*}{\\kappa} \\cdot \\frac{1}{z}\n$$\n在平衡重叠层中，湍动能（TKE）的生成率 $P$ 与耗散率 $\\epsilon$ 相平衡。单位质量的生成率由 $P = u_*^2 \\left(\\frac{dU}{dz}\\right)$ 给出，这表示平均流对湍流应力做功的速率，其中恒应力层中的湍流应力为 $\\tau = \\rho u_*^2$。因此，局部平衡条件 $P=\\epsilon$ 得出：\n$$\n\\epsilon(z) = u_*^2 \\left(\\frac{dU}{dz}\\right) = u_*^2 \\left(\\frac{u_*}{\\kappa z}\\right) = \\frac{u_*^3}{\\kappa z}\n$$\n该表达式给出了对数层中耗散率 $\\epsilon$ 作为高度 $z$ 的函数。在 $z=z_1$ 处计算该值，得到耗散的壁面函数值，我们将其记为 $\\epsilon_{\\text{wf}}(z_1)$：\n$$\n\\epsilon_{\\text{wf}}(z_1) = \\frac{u_*^3}{\\kappa z_1}\n$$\n为了求得 TKE, $k$，我们使用涡粘性系数 $\\nu_t$ 的两个给定定义。首先，从 $k-\\epsilon$ 闭合：\n$$\n\\nu_t = C_\\mu \\frac{k^2}{\\epsilon}\n$$\n其次，根据恒应力层中摩擦速度的定义 $u_*^2 = \\nu_t \\frac{dU}{dz}$。代入切变的表达式，我们发现：\n$$\nu_*^2 = \\nu_t \\left(\\frac{u_*}{\\kappa z}\\right) \\implies \\nu_t = u_* \\kappa z\n$$\n令 $\\nu_t$ 的两个表达式相等：\n$$\nC_\\mu \\frac{k^2}{\\epsilon} = u_* \\kappa z\n$$\n现在，我们可以求解 $k$。我们代入先前推导出的 $\\epsilon(z) = \\frac{u_*^3}{\\kappa z}$ 表达式：\n$$\nC_\\mu \\frac{k^2}{\\left(\\frac{u_*^3}{\\kappa z}\\right)} = u_* \\kappa z\n$$\n$$\nC_\\mu \\frac{k^2 \\kappa z}{u_*^3} = u_* \\kappa z\n$$\n假设 $z > 0$，我们可以消去两边的 $\\kappa z$：\n$$\nC_\\mu \\frac{k^2}{u_*^3} = u_* \\implies C_\\mu k^2 = u_*^4\n$$\n求解 $k$，我们得到：\n$$\nk^2 = \\frac{u_*^4}{C_\\mu} \\implies k = \\frac{u_*^2}{\\sqrt{C_\\mu}}\n$$\n这个结果表明，在对数层局部平衡的假设下，TKE, $k$ 是随高度不变的常量。因此，$z_1$ 处的壁面函数值为：\n$$\nk(z_1) = \\frac{u_*^2}{\\sqrt{C_\\mu}}\n$$\n我们现在使用给定的常数计算数值：$u_* = 0.015~\\mathrm{m~s^{-1}}$，$\\kappa = 0.41$，$C_\\mu = 0.09$，$z_0 = 1.0\\times 10^{-3}~\\mathrm{m}$，以及 $z_1 = 2.0\\times 10^{-2}~\\mathrm{m}$。\n\n对于 $k(z_1)$：\n$$\nk(z_1) = \\frac{(0.015)^2}{\\sqrt{0.09}} = \\frac{2.25 \\times 10^{-4}}{0.3} = 7.5 \\times 10^{-4}~\\mathrm{m^2~s^{-2}}\n$$\n四舍五入到四位有效数字，$k(z_1) = 7.500 \\times 10^{-4}~\\mathrm{m^2~s^{-2}}$。\n\n对于 $\\epsilon(z_1)$，为(b)部分需要，我们将其标记为 $\\epsilon_{\\text{wf}}(z_1)$：\n$$\n\\epsilon_{\\text{wf}}(z_1) = \\frac{(0.015)^3}{(0.41)(2.0 \\times 10^{-2})} = \\frac{3.375 \\times 10^{-6}}{8.2 \\times 10^{-3}} \\approx 4.11585 \\times 10^{-4}~\\mathrm{m^2~s^{-3}}\n$$\n四舍五入到四位有效数字，$\\epsilon_{\\text{wf}}(z_1) \\approx 4.116 \\times 10^{-4}~\\mathrm{m^2~s^{-3}}$。\n\n(b) 部分：相对偏差 $\\delta_\\epsilon$ 的推导和计算。\n\n题目假设一个“真实”的平均切变，可以通过在对数梯度中用 $z+z_0$ 替换 $z$ 来更好地表示。标准梯度为 $\\frac{u_*}{\\kappa z}$。因此，修正后的“真实”梯度为：\n$$\n\\left(\\frac{dU}{dz}\\right)_{\\text{true}} = \\frac{u_*}{\\kappa(z+z_0)}\n$$\n假设关系式 $\\epsilon = u_*^2 \\left(\\frac{dU}{dz}\\right)$ 对这个“真实”状态仍然有效，那么高度 $z_1$ 处的真实耗散率为：\n$$\n\\epsilon_{\\text{true}}(z_1) = u_*^2 \\left(\\frac{dU}{dz}\\right)_{\\text{true}} \\bigg|_{z=z_1} = \\frac{u_*^3}{\\kappa(z_1+z_0)}\n$$\n壁面函数耗散 $\\epsilon_{\\text{wf}}(z_1)$ 是在(a)部分推导出的值：\n$$\n\\epsilon_{\\text{wf}}(z_1) = \\frac{u_*^3}{\\kappa z_1}\n$$\n相对偏差 $\\delta_\\epsilon$ 定义为：\n$$\n\\delta_\\epsilon = \\frac{\\epsilon_{\\text{wf}}(z_1) - \\epsilon_{\\text{true}}(z_1)}{\\epsilon_{\\text{true}}(z_1)}\n$$\n代入推导出的 $\\epsilon_{\\text{wf}}(z_1)$ 和 $\\epsilon_{\\text{true}}(z_1)$ 的表达式：\n$$\n\\delta_\\epsilon = \\frac{\\frac{u_*^3}{\\kappa z_1} - \\frac{u_*^3}{\\kappa(z_1+z_0)}}{\\frac{u_*^3}{\\kappa(z_1+z_0)}}\n$$\n公共因子 $\\frac{u_*^3}{\\kappa}$ 从分子和分母中消去：\n$$\n\\delta_\\epsilon = \\frac{\\frac{1}{z_1} - \\frac{1}{z_1+z_0}}{\\frac{1}{z_1+z_0}}\n$$\n为了简化这个繁分数，我们可以将表达式写为 $\\delta_\\epsilon = \\frac{\\epsilon_{\\text{wf}}(z_1)}{\\epsilon_{\\text{true}}(z_1)} - 1$：\n$$\n\\delta_\\epsilon = \\frac{\\frac{u_*^3}{\\kappa z_1}}{\\frac{u_*^3}{\\kappa(z_1+z_0)}} - 1 = \\frac{z_1+z_0}{z_1} - 1\n$$\n$$\n\\delta_\\epsilon = \\left(1 + \\frac{z_0}{z_1}\\right) - 1 = \\frac{z_0}{z_1}\n$$\n这就是相对偏差的闭式表达式。它表明偏差就是粗糙度长度与第一个网格点高度之比。\n现在，我们计算其数值：\n$$\n\\delta_\\epsilon = \\frac{1.0 \\times 10^{-3}~\\mathrm{m}}{2.0 \\times 10^{-2}~\\mathrm{m}} = \\frac{1}{20} = 0.05\n$$\n四舍五入到四位有效数字，这个无量纲值为 $0.05000$。\n\n最终结果，四舍五入到四位有效数字，为：\n- $k(z_1) = 7.500 \\times 10^{-4}~\\mathrm{m^2~s^{-2}}$\n- $\\epsilon(z_1) = 4.116 \\times 10^{-4}~\\mathrm{m^2~s^{-3}}$\n- $\\delta_\\epsilon = 0.05000$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 7.500 \\times 10^{-4}  4.116 \\times 10^{-4}  0.05000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论和数值实现最终必须与真实世界的观测数据相结合。这个综合性练习将引导你完成一个从原始数据到最终科学结论的完整工作流程。你将利用一组近底层流速剖面观测数据，通过拟合对数律来估算底切应力，并采用非参数自举法（bootstrap）来量化结果的不确定性。这个练习  不仅巩固了理论知识，更重要的是培养了在计算海洋学研究中处理真实数据和评估不确定性的关键技能。",
            "id": "3806865",
            "problem": "给定海底边界层（BBL）内多个已知离底高度的近底层水流速度测量值，以及水的密度。任务是使用二次拖曳公式计算底切应力 $ \\tau_b $，其中拖曳系数 $ C_d $ 是通过中性对数律-壁面律从拟合的粗糙度长度 $ z_0 $ 确定的。你还必须使用测量数据对的非参数自举法来量化指定参考高度上 $ \\tau_b $ 的不确定性。\n\n基本原理：\n- 对于稳定、中性分层、水平均匀条件下的海底边界层中的牛顿流体，顺流平均速度剖面满足对数律：\n$$ U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right), $$\n其中，$ U(z) $ 是高度 $ z $ 处的平均流速大小，$ u_* $ 是由 $ u_* = \\sqrt{\\tau_b/\\rho} $ 定义的摩阻流速，$ \\rho $ 是流体密度，$ \\kappa $ 是 von Kármán 常数，$ z_0 $ 是水动力粗糙度长度。\n- 在参考高度 $ z_r $ 处，平均流速为 $ U_r = U(z_r) $ 的二次底切应力参数化表示为\n$$ \\tau_b = \\rho \\, C_d(z_r) \\, U_r^2, $$\n其拖曳系数 $ C_d(z_r) $ 必须从对数律和拟合的 $ z_0 $ 导出。\n\n你的程序必须：\n1. 使用模型 $ U(z) = A \\ln(z) + B $，通过线性最小二乘法拟合对数律参数以估计 $ A $ 和 $ B $，然后计算粗糙度长度 $ z_0 = \\exp\\!\\left(-\\frac{B}{A}\\right) $。使用 $ \\kappa = 0.41 $。\n2. 根据拟合的 $ z_0 $，导出指定参考高度 $ z_r $ 处的拖曳系数：\n$$ C_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0)}\\right)^2. $$\n3. 使用给定的 $ \\rho $ 和测量的 $ z_r $ 处的 $ U_r $ 计算点估计值 $ \\hat{\\tau}_b $。\n4. 使用非参数自举法评估 $ \\tau_b $ 的不确定性：对 $ (z_i, U_i) $ 数据对进行有放回的重采样，为每个自举样本重新拟合 $ A $、$ B $，重新计算 $ z_0 $、$ C_d(z_r) $ 和 $ \\tau_b $。使用 $ N = 2000 $ 个自举样本和固定的随机种子 $ 42 $。排除任何拟合的 $ A \\le 0 $ 或 $ \\ln(z_r / z_0) \\le 0 $ 的自举样本（这对于在给定 $ z_r $ 处应用中性对数律而言是非物理的）。从有效样本中，报告 $ 2.5\\% $ 和 $ 97.5\\% $ 的经验百分位数作为 $ \\tau_b $ 的 $ 95\\% $ 置信区间的边界。\n5. 将 $ \\tau_b $ 以帕斯卡（$ \\mathrm{Pa} $）为单位表示为浮点值；$ C_d $ 是无量纲的。\n\n测试套件：\n- 案例1（一般情况）：\n  - 高度：$ z = [0.2, 0.5, 1.0, 1.5, 2.0] \\ \\mathrm{m} $\n  - 速度：$ U = [0.224, 0.271, 0.303, 0.322, 0.337] \\ \\mathrm{m/s} $\n  - 密度：$ \\rho = 1025 \\ \\mathrm{kg/m^3} $\n  - 参考高度：$ z_r = 1.0 \\ \\mathrm{m} $\n  - 参考速度：$ U_r = 0.303 \\ \\mathrm{m/s} $\n- 案例2（类光滑床边界条件）：\n  - 高度：$ z = [0.05, 0.1, 0.2, 0.5, 1.0] \\ \\mathrm{m} $\n  - 速度：$ U = [0.152, 0.176, 0.200, 0.215, 0.224] \\ \\mathrm{m/s} $\n  - 密度：$ \\rho = 1027 \\ \\mathrm{kg/m^3} $\n  - 参考高度：$ z_r = 0.5 \\ \\mathrm{m} $\n  - 参考速度：$ U_r = 0.215 \\ \\mathrm{m/s} $\n- 案例3（稀疏数据边缘案例）：\n  - 高度：$ z = [0.3, 0.6, 1.2] \\ \\mathrm{m} $\n  - 速度：$ U = [0.299, 0.350, 0.400] \\ \\mathrm{m/s} $\n  - 密度：$ \\rho = 1024 \\ \\mathrm{kg/m^3} $\n  - 参考高度：$ z_r = 0.6 \\ \\mathrm{m} $\n  - 参考速度：$ U_r = 0.350 \\ \\mathrm{m/s} $\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含所有三个测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，每个测试用例的结果本身是按 $ [\\hat{\\tau}_b, \\tau_{b,\\mathrm{low}}, \\tau_{b,\\mathrm{high}}, \\hat{C}_d] $ 顺序排列的列表。这里 $ \\hat{\\tau}_b $ 是点估计值，$ \\tau_{b,\\mathrm{low}} $ 和 $ \\tau_{b,\\mathrm{high}} $ 是通过自举法得到的 $ 95\\% $ 置信区间的下限和上限，$ \\hat{C}_d $ 是在 $ z_r $ 处的拖曳系数的点估计值。例如，输出应如下所示\n$$ [ [x_1,y_1,z_1,w_1], [x_2,y_2,z_2,w_2], [x_3,y_3,z_3,w_3] ] $$\n其中 $ x_i, y_i, z_i, w_i $ 为数值。",
            "solution": "该问题要求根据近底层速度剖面测量值计算底切应力 $\\tau_b$ 及其相关的不确定性。所规定的方法基于壁面-对数律（湍流边界层理论的基本原理），并结合二次拖曳律公式和非参数自举法进行不确定性分析。\n\n该过程首先验证问题陈述。\n\n### 第1步：提取已知信息\n- **控制方程（壁面-对数律）：**对于稳定、中性分层、水平均匀的海底边界层（BBL），离底高度为 $z$ 处的平均流速 $U(z)$ 由下式给出：\n$$ U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right) $$\n- **摩阻流速定义：**$u_* = \\sqrt{\\tau_b/\\rho}$，其中 $\\tau_b$ 是底切应力，$\\rho$ 是流体密度。\n- **二次拖曳律：**参考高度 $z_r$ 处的底切应力参数化为：\n$$ \\tau_b = \\rho \\, C_d(z_r) \\, U_r^2 $$\n其中 $U_r = U(z_r)$ 是 $z_r$ 处的速度，$C_d(z_r)$ 是该高度处的拖曳系数。\n- **拟合线性模型：**对数律将使用线性模型 $U(z) = A \\ln(z) + B$ 进行拟合。\n- **参数恢复：**水动力粗糙度长度 $z_0$ 从拟合参数 $A$ 和 $B$ 中通过以下公式恢复：\n$$ z_0 = \\exp\\!\\left(-\\frac{B}{A}\\right) $$\n- **拖曳系数公式：**拖曳系数 $C_d(z_r)$ 从拟合的 $z_0$ 导出：\n$$ C_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0)}\\right)^2 $$\n- **常数：**von Kármán 常数为 $\\kappa = 0.41$。\n- **自举参数：**自举样本数量为 $N = 2000$，随机种子固定为 $42$。\n- **自举筛选条件：**排除拟合斜率 $A \\le 0$ 或 $\\ln(z_r / z_0) \\le 0$ 的样本。\n- **不确定性量化：**$\\tau_b$ 的 $95\\%$ 置信区间由有效自举样本的 $2.5\\%$ 和 $97.5\\%$ 经验百分位数定义。\n- **测试案例：**提供了三个不同的测试案例，每个案例都包含一组高度 $z$、对应的速度 $U$、流体密度 $\\rho$、一个参考高度 $z_r$ 以及该参考高度下的速度 $U_r$。\n\n### 第2步：使用提取的已知信息进行验证\n- **科学依据：**该问题牢固地植根于经典的湍流边界层理论。壁面-对数律是流体动力学的基石，二次拖曳律是海洋学和气象学中的标准参数化方法。所提供的方程与基本原理一致。$\\kappa = 0.41$ 的值是一个标准且广泛使用的值。该问题在科学上是合理的。\n- **适定性：**该问题是适定的。它明确了一系列清晰的操作：线性最小二乘拟合、物理参数的直接计算，以及用于不确定性估计的标准统计程序（非参数自举法）。自举程序的筛选条件可防止出现非物理或数学上无定义的结果，从而确保了稳健性。在正常条件下（例如，非均匀数据点），保证了每一步解的存在性和唯一性。\n- **客观性：**问题陈述语言客观、精确。所有必需的数据、常数和公式都已明确给出，没有主观因素。\n- **其他缺陷：**该问题是自洽的，没有缺失信息或矛盾之处。所要求的条件和数据对于海洋海底边界层是物理上合理的。结构逻辑清晰，任务是该领域一个标准的数据分析问题，既不琐碎也不赘述。\n\n### 第3步：结论与行动\n问题有效。它在科学上合理、适定、客观且完整。可以计算出分步解。\n\n### 求解推导\n\n对每个测试案例，求解过程分为四个主要阶段：（1）拟合对数律以确定剖面参数，（2）计算拖曳系数 $C_d$ 和底切应力 $\\tau_b$ 的点估计值，（3）执行自举分析以量化 $\\tau_b$ 的不确定性，以及（4）报告结果。\n\n**1. 对数律剖面拟合**\n关系式 $U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)$ 可以改写为 $U(z) = \\frac{u_*}{\\kappa} \\ln(z) - \\frac{u_*}{\\kappa} \\ln(z_0)$。这与线性形式 $U(z) = A \\ln(z) + B$ 相匹配，其中斜率为 $A = u_*/\\kappa$，截距为 $B = - (u_*/\\kappa) \\ln(z_0)$。给定一组测量数据对 $(z_i, U_i)$，我们首先将高度转换为 $x_i = \\ln(z_i)$。然后，我们对 $(x_i, U_i)$ 数据对进行线性最小二乘回归，以找到最佳拟合系数 $\\hat{A}$ 和 $\\hat{B}$。根据这些系数，可以估计水动力粗糙度长度 $\\hat{z}_0$。由于 $\\hat{B}/\\hat{A} = -\\ln(\\hat{z}_0)$，我们有：\n$$ \\hat{z}_0 = \\exp\\left(-\\frac{\\hat{B}}{\\hat{A}}\\right) $$\n\n**2. $C_d$ 和 $\\tau_b$ 的点估计**\n利用估计的粗糙度长度 $\\hat{z}_0$，计算指定参考高度 $z_r$ 处的拖曳系数 $\\hat{C}_d$。该公式是通过将 $C_d$ 的定义与对数律相结合得出的：$C_d(z_r) = (u_*/U_r)^2$ 且 $U_r = (u_*/\\kappa)\\ln(z_r/z_0)$，这得出 $u_*/U_r = \\kappa/\\ln(z_r/z_0)$。因此：\n$$ \\hat{C}_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / \\hat{z}_0)}\\right)^2 $$\n然后，使用二次拖曳律，根据给定的密度 $\\rho$、测量的参考速度 $U_r$ 和估计的拖曳系数 $\\hat{C}_d(z_r)$，计算底切应力的点估计值 $\\hat{\\tau}_b$：\n$$ \\hat{\\tau}_b = \\rho \\, \\hat{C}_d(z_r) \\, U_r^2 $$\n\n**3. 自举法不确定性量化**\n为了评估由速度测量变异性引起的 $\\tau_b$ 的不确定性，我们采用非参数自举法。这种统计技术涉及对原始数据的重复重采样，以模拟可能结果的分布。其步骤如下：\n- 使用固定的随机种子（$42$）以确保可复现性。\n- 总共生成 $N=2000$ 个自举样本。对于每个样本：\n    a. 通过从原始测量数据集中有放回地抽样，创建一个新的 $(z_i, U_i)$ 数据对数据集。新数据集的大小与原始数据集相同。\n    b. 在此重采样数据集上重复对数律拟合过程，以获得一组新的系数 $A^*$ 和 $B^*$。\n    c. 对新系数进行验证。如果 $A^* \\le 0$，则丢弃该样本，因为它意味着非物理的零或负摩阻流速。\n    d. 计算新的粗糙度长度 $z_0^* = \\exp(-B^*/A^*)$。\n    e. 检查对数律在参考高度的适用性。如果 $\\ln(z_r/z_0^*) \\le 0$（即 $z_r \\le z_0^*$），则参考高度低于粗糙度长度，这是非物理的。丢弃该样本。\n    f. 对于有效样本，计算拖曳系数 $C_d^*(z_r)$ 和底切应力 $\\tau_b^*$ 的自举估计值：\n    $$ C_d^*(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0^*)}\\right)^2 $$\n    $$ \\tau_b^* = \\rho \\, C_d^*(z_r) \\, U_r^2 $$\n- 生成所有样本后，有效的 $\\tau_b^*$ 值集合构成了底切应力的自举分布。\n\n**4. 置信区间与报告**\n$\\tau_b$ 的 $95\\%$ 置信区间是根据经验自举分布确定的。下限 $\\tau_{b, \\text{low}}$ 是排序后的 $\\tau_b^*$ 值的第 $2.5$ 百分位数，上限 $\\tau_{b, \\text{high}}$ 是第 $97.5$ 百分位数。\n对于每个测试案例，最终结果是四个值的集合：切应力的点估计值 $\\hat{\\tau}_b$、其置信区间的下限和上限（$\\tau_{b, \\text{low}}$，$\\tau_{b, \\text{high}}$），以及拖曳系数的点估计值 $\\hat{C}_d(z_r)$。然后按规定格式化这些结果。",
            "answer": "[[0.2319041, 0.187313, 0.3129486, 0.0024468], [0.1030365, 0.0768638, 0.1652751, 0.0021799], [0.3700079, 0.2359417, 0.5898084, 0.0029582]]"
        }
    ]
}