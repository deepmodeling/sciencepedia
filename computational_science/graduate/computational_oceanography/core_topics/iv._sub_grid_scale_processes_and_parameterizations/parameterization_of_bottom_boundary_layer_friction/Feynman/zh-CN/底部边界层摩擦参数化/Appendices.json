{
    "hands_on_practices": [
        {
            "introduction": "在计算海洋学模型中，拖曳系数 $C_d$ 是一个关键参数，但它并非一个随意设定的数值。该系数的物理基础植根于边界附近的流速剖面形状。本练习将引导你从经典的“壁面律”出发，推导拖曳系数与水动力粗糙度长度 $z_0$ 之间的关系，从而揭示底层摩擦参数化的物理内涵。",
            "id": "3806846",
            "problem": "在水力粗糙海床上方的稳定、水平均匀、中性分层的底部边界层 (BBL) 可以使用雷诺平均纳维-斯托克斯 (RANS) 理论，并结合普朗特-冯·卡门混合长度闭合来描述，其中混合长度为 $l=\\kappa z$，$ \\kappa $ 是冯·卡门常数，$ z $ 是离床底的距离。在这类流动中，近床底平均速度剖面 $U(z)$、床底切应力 $\\tau_b$ 和摩阻流速 $u_*$ 可由湍流动量平衡和闭合假设推导得出。粗糙度长度 $z_0$ 参数化了床底的有效动量吸收高度。\n\n从这些基础出发，推导连接 $U(z)$、$u_*$ 和 $z_0$ 的关系，以及 $\\tau_b$ 和 $u_*$ 之间的联系。将参考高度 $z_r$ 处的拖曳系数定义为 $C_d \\equiv \\tau_b/\\left(\\rho\\,U(z_r)^2\\right)$，其中 $\\rho$ 是海水密度。然后，对于海水密度 $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$、冯·卡门常数 $\\kappa=0.4$、在床底上方 $z_r=1\\,\\mathrm{m}$ 处测得的参考速度 $U(z_r)=0.25\\,\\mathrm{m\\,s^{-1}}$，以及粗糙度长度 $z_0=0.01\\,\\mathrm{m}$ 的情况，计算 $C_d$、$u_*$ 和 $\\tau_b$。\n\n将每个量四舍五入到四位有效数字。$u_*$ 以 $\\mathrm{m\\,s^{-1}}$ 为单位表示，$\\tau_b$ 以 $\\mathrm{N\\,m^{-2}}$ 为单位表示，并注意 $C_d$ 是无量纲的。",
            "solution": "该问题要求推导中性分层、稳定、水平均匀的湍流底部边界层的基本关系，并随后计算关键参数。我们从第一性原理出发。\n\n对于稳定 ($\\partial/\\partial t = 0$)、水平均匀 ($\\partial/\\partial x = \\partial/\\partial y = 0$) 的流动，水平方向的雷诺平均动量方程得以简化。假设唯一的强迫是由摩擦力平衡的压强梯度（如带有埃克曼层的地转流，但我们只关心近床底层，在此层中旋转对动量平衡的影响通常可以忽略），近床底区域的主要平衡是湍流应力的垂直散度和压强梯度/科里奥利项之间的平衡。对于简单的槽道流或远离上表面的边界层，这种平衡进一步简化。问题暗示了一个恒应力层，这是边界附近的一个标准假设。在这一层中，动量的垂直通量，即切应力 $\\tau$，不随高度 $z$ 变化，且恒等于床底切应力 $\\tau_b$。\n$$\n\\tau(z) = \\tau_b = \\text{constant}\n$$\n切应力由粘性应力和湍流（雷诺）应力组成。对于水力粗糙流，湍流应力占主导地位，因此 $\\tau \\approx -\\rho \\overline{u'w'}$，其中 $\\rho$ 是流体密度，$\\overline{u'w'}$ 是水平和垂直速度脉动的时间平均乘积。\n\n普朗特-冯·卡门混合长度模型为雷诺应力提供了闭合：\n$$\n-\\overline{u'w'} = \\nu_T \\frac{dU}{dz}\n$$\n其中 $\\nu_T$ 是涡粘性系数，$\\frac{dU}{dz}$ 是平均速度切变。涡粘性系数使用混合长度 $l$ 进行参数化：\n$$\n\\nu_T = l^2 \\left|\\frac{dU}{dz}\\right|\n$$\n问题将混合长度指定为 $l = \\kappa z$，其中 $\\kappa$ 是冯·卡门常数。速度 $U$ 预期随 $z$ 增加，因此 $\\frac{dU}{dz} > 0$。将这些结合起来得到：\n$$\n\\tau = \\rho (\\kappa z)^2 \\left(\\frac{dU}{dz}\\right)^2\n$$\n根据定义，摩阻流速 $u_*$ 与床底切应力 $\\tau_b$ 的关系为：\n$$\nu_* \\equiv \\sqrt{\\frac{\\tau_b}{\\rho}}\n$$\n这就得到了第一个所求的关系式 $\\tau_b = \\rho u_*^2$。由于该层中的应力是恒定的，即 $\\tau(z) = \\tau_b$，我们可以写出：\n$$\nu_*^2 = (\\kappa z)^2 \\left(\\frac{dU}{dz}\\right)^2\n$$\n取正平方根（因为 $u_* > 0$, $\\kappa > 0$, $z > 0$ 且 $dU/dz > 0$）：\n$$\nu_* = \\kappa z \\frac{dU}{dz}\n$$\n这是一个关于速度剖面 $U(z)$ 的可分离一阶常微分方程。我们重新整理并积分以求得 $U(z)$：\n$$\ndU = \\frac{u_*}{\\kappa} \\frac{dz}{z}\n$$\n为了求解该方程，我们必须建立一个边界条件。对于水力粗糙表面，速度剖面不是在床底本身 ($z=0$) 处外推到零，而是在一个称为粗糙度长度的高度 $z_0$ 处。因此，积分下限为 $U(z_0) = 0$。\n$$\n\\int_{0}^{U(z)} dU' = \\int_{z_0}^{z} \\frac{u_*}{\\kappa} \\frac{dz'}{z'}\n$$\n$$\nU(z) - 0 = \\frac{u_*}{\\kappa} \\left[ \\ln(z') \\right]_{z_0}^{z}\n$$\n这就得到了对数速度剖面，或称为粗糙表面的“壁面律”：\n$$\nU(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)\n$$\n这就是连接 $U(z)$、$u_*$ 和 $z_0$ 的关系。\n\n现在，我们开始计算所求的量。拖曳系数 $C_d$ 在参考高度 $z_r$ 处定义为：\n$$\nC_d \\equiv \\frac{\\tau_b}{\\rho U(z_r)^2}\n$$\n我们可以将我们推导出的 $\\tau_b$ 和 $U(z_r)$ 的表达式代入此定义中：\n$$\n\\tau_b = \\rho u_*^2\n$$\n$$\nU(z_r) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z_r}{z_0}\\right)\n$$\n将这些代入 $C_d$ 的表达式中：\n$$\nC_d = \\frac{\\rho u_*^2}{\\rho \\left( \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z_r}{z_0}\\right) \\right)^2} = \\frac{\\rho u_*^2}{\\rho \\frac{u_*^2}{\\kappa^2} \\left( \\ln\\left(\\frac{z_r}{z_0}\\right) \\right)^2}\n$$\n$\\rho$ 和 $u_*^2$ 项相互抵消，从而得到一个仅取决于参考高度、粗糙度长度和冯·卡门常数的拖曳系数的简单表达式：\n$$\nC_d = \\left( \\frac{\\kappa}{\\ln(z_r/z_0)} \\right)^2\n$$\n使用给定的值：$\\kappa = 0.4$，$z_r = 1\\,\\mathrm{m}$ 和 $z_0 = 0.01\\,\\mathrm{m}$。\n$$\nC_d = \\left( \\frac{0.4}{\\ln(1 / 0.01)} \\right)^2 = \\left( \\frac{0.4}{\\ln(100)} \\right)^2\n$$\n数值上，$\\ln(100) \\approx 4.605170185988092$。\n$$\nC_d \\approx \\left( \\frac{0.4}{4.605170} \\right)^2 \\approx (0.0868588...)^2 \\approx 0.00754415...\n$$\n四舍五入到四位有效数字，$C_d \\approx 0.007544$。\n\n接下来，我们计算摩阻流速 $u_*$。我们可以将在 $z=z_r$ 处的壁面律重新整理得到：\n$$\nu_* = \\frac{\\kappa U(z_r)}{\\ln(z_r/z_0)}\n$$\n使用给定的值：$U(z_r) = 0.25\\,\\mathrm{m\\,s^{-1}}$，$\\kappa=0.4$，$z_r=1\\,\\mathrm{m}$，$z_0=0.01\\,\\mathrm{m}$。\n$$\nu_* = \\frac{0.4 \\times 0.25}{\\ln(100)} = \\frac{0.1}{\\ln(100)}\n$$\n$$\nu_* \\approx \\frac{0.1}{4.605170} \\approx 0.0217147... \\,\\mathrm{m\\,s^{-1}}\n$$\n四舍五入到四位有效数字，$u_* \\approx 0.02171\\,\\mathrm{m\\,s^{-1}}$。\n\n最后，我们使用以 $u_*$ 表示的定义来计算床底切应力 $\\tau_b$：\n$$\n\\tau_b = \\rho u_*^2\n$$\n使用 $\\rho = 1025\\,\\mathrm{kg\\,m^{-3}}$ 的值和未经四舍五入的 $u_*$ 值以确保精度：\n$$\n\\tau_b = 1025 \\times (0.0217147...)^2 = 1025 \\times (0.00047151...)\\,\\mathrm{N\\,m^{-2}}\n$$\n$$\n\\tau_b \\approx 0.483299... \\,\\mathrm{N\\,m^{-2}}\n$$\n四舍五入到四位有效数字，$\\tau_b \\approx 0.4833\\,\\mathrm{N\\,m^{-2}}$。\n\n计算出的量，四舍五入到四位有效数字后为：\n拖曳系数 $C_d = 0.007544$。\n摩阻流速 $u_* = 0.02171\\,\\mathrm{m\\,s^{-1}}$。\n床底切应力 $\\tau_b = 0.4833\\,\\mathrm{N\\,m^{-2}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.007544  & 0.02171 & 0.4833\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "不同的科学与工程领域，如土木工程与物理海洋学，各自发展了描述流动摩擦的经验公式。在跨学科研究与建模中，能够在这些不同框架之间进行转换是一项至关重要的技能。本练习将探讨如何将广泛应用于明渠流计算的曼宁糙率系数 $n$ 与海洋模型中常用的二次拖曳系数 $C_d$ 联系起来，展示参数化方案之间的内在联系。",
            "id": "3806852",
            "problem": "一股直线的沿陆架流流经一个缓坡大陆架，形成一个湍流底边界层 (BBL)。海床糙度在操作上由曼宁糙率系数 $n=0.02$ 来表征，水流几何形状由水力半径 $R=50\\,\\mathrm{m}$ 表示。大尺度的正压压力梯度由一个均匀的自由水面坡度 $S=10^{-4}$ 设定。海水密度为 $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$。假设重力加速度 $g=9.81\\,\\mathrm{m\\,s^{-2}}$。在海洋环流模型中，海床应力通过一个二次拖曳力定律 $|\\boldsymbol{\\tau}_{b}|=\\rho\\,C_{d}\\,|\\boldsymbol{U}|^{2}$ 进行参数化，其中 $C_{d}$ 是一个标量拖曳系数，而 $|\\boldsymbol{U}|$ 是深度平均流的大小。\n\n从明渠流的雷诺平均、稳定、均匀、静水动量平衡出发，并使用与曼宁公式一致的标准的基于糙度的阻力表示法，推导等效二次拖曳系数 $C_{d}$ 关于 $g$、$n$ 和 $R$ 的表达式。然后，使用推导出的 $C_{d}$，计算在深度平均流速为 $|\\boldsymbol{U}|=0.5\\,\\mathrm{m\\,s^{-1}}$ 和给定 $\\rho$ 的情况下，海床剪切应力的大小 $|\\boldsymbol{\\tau}_{b}|$。将您的 $|\\boldsymbol{\\tau}_{b}|$ 的最终数值答案四舍五入到三位有效数字。最终答案以 $\\mathrm{N\\,m^{-2}}$ 为单位表示。",
            "solution": "按要求，解答分为两部分：首先，推导拖曳系数 $C_d$，其次，计算海床剪切应力 $|\\boldsymbol{\\tau}_{b}|$。\n\n**第 1 部分：等效二次拖曳系数 $C_d$ 的推导**\n\n推导从稳定、均匀明渠流的动量平衡开始。在这种流动中，沿坡度作用的重力分量（驱动水流）与海床施加的摩擦剪切应力精确平衡。\n\n考虑一个长度为 $L$、横截面积为 $A$ 的流体元。沿河道坡度 $S$ 的重力分量由 $F_{g} = (\\rho A L) g \\sin(\\theta)$ 给出，其中 $\\theta$ 是坡度角。对于在这种情况下典型的缓坡，我们使用近似 $\\sin(\\theta) \\approx \\tan(\\theta) = S$。因此，驱动力为 $F_{g} = \\rho g A L S$。\n\n阻力是作用在湿润表面积上的海床剪切应力 $|\\boldsymbol{\\tau}_{b}|$，该面积是湿周 $P$ 乘以长度 $L$。所以，$F_{f} = |\\boldsymbol{\\tau}_{b}| P L$。\n\n对于稳定、均匀流，这些力处于平衡状态：$F_g = F_f$。\n$$ \\rho g A L S = |\\boldsymbol{\\tau}_{b}| P L $$\n两边除以 $P L$，并认识到水力半径 $R$ 定义为 $R = A/P$，我们得到海床应力与能量坡度之间的关系：\n$$ |\\boldsymbol{\\tau}_{b}| = \\rho g \\frac{A}{P} S = \\rho g R S $$\n\n接下来，我们引入曼宁公式，这是一个计算明渠中平均流速 $|\\boldsymbol{U}|$ 的经验公式。在国际单位制中，它是：\n$$ |\\boldsymbol{U}| = \\frac{1}{n} R^{\\frac{2}{3}} S^{\\frac{1}{2}} $$\n其中 $n$ 是曼宁糙率系数。\n\n问题要求我们为二次拖曳力定律找到一个等效的拖曳系数 $C_d$：\n$$ |\\boldsymbol{\\tau}_{b}| = \\rho C_{d} |\\boldsymbol{U}|^{2} $$\n\n为了找到用 $g$、$n$ 和 $R$ 表示 $C_d$ 的表达式，我们必须组合这三个方程以消去 $|\\boldsymbol{\\tau}_{b}|$、 $|\\boldsymbol{U}|$ 和 $S$。\n\n首先，令 $|\\boldsymbol{\\tau}_{b}|$ 的两个表达式相等：\n$$ \\rho g R S = \\rho C_{d} |\\boldsymbol{U}|^{2} $$\n解出 $C_d$ 得到：\n$$ C_{d} = \\frac{g R S}{|\\boldsymbol{U}|^{2}} $$\n这个表达式仍然包含 $S$ 和 $|\\boldsymbol{U}|$。我们可以使用曼宁公式将 $S$ 与 $|\\boldsymbol{U}|$ 联系起来。从曼宁公式中，我们解出坡度 $S$：\n$$ S^{\\frac{1}{2}} = \\frac{n |\\boldsymbol{U}|}{R^{\\frac{2}{3}}} \\implies S = \\left( \\frac{n |\\boldsymbol{U}|}{R^{\\frac{2}{3}}} \\right)^{2} = \\frac{n^{2} |\\boldsymbol{U}|^{2}}{R^{\\frac{4}{3}}} $$\n现在，将这个 $S$ 的表达式代入 $C_d$ 的方程中：\n$$ C_{d} = \\frac{g R}{|\\boldsymbol{U}|^{2}} \\left( \\frac{n^{2} |\\boldsymbol{U}|^{2}}{R^{\\frac{4}{3}}} \\right) $$\n$|\\boldsymbol{U}|^{2}$ 项被消去，这表明在此框架内，等效拖曳系数与流速无关。这对于其在模型中的参数化是一个至关重要的结果。\n$$ C_{d} = g n^{2} \\frac{R}{R^{\\frac{4}{3}}} = g n^{2} R^{1 - \\frac{4}{3}} = g n^{2} R^{-\\frac{1}{3}} $$\n这就是所要求的用 $g$、$n$ 和 $R$ 表示 $C_d$ 的表达式。\n\n**第 2 部分：海床剪切应力 $|\\boldsymbol{\\tau}_{b}|$ 的计算**\n\n首先，我们使用给定值计算无量纲拖曳系数 $C_d$ 的数值：$g=9.81\\,\\mathrm{m\\,s^{-2}}$，$n=0.02$，以及 $R=50\\,\\mathrm{m}$。\n$$ C_{d} = (9.81) (0.02)^{2} (50)^{-\\frac{1}{3}} = (9.81)(0.0004) \\frac{1}{\\sqrt[3]{50}} $$\n$$ C_{d} = \\frac{0.003924}{\\sqrt[3]{50}} \\approx \\frac{0.003924}{3.684031} \\approx 0.00106514 $$\n\n现在，我们使用二次拖曳力定律，根据指定的深度平均流速 $|\\boldsymbol{U}|=0.5\\,\\mathrm{m\\,s^{-1}}$ 和密度 $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$ 来计算海床剪切应力的大小 $|\\boldsymbol{\\tau}_{b}|$。\n$$ |\\boldsymbol{\\tau}_{b}| = \\rho C_{d} |\\boldsymbol{U}|^{2} $$\n代入数值：\n$$ |\\boldsymbol{\\tau}_{b}| = (1025\\,\\mathrm{kg\\,m^{-3}}) (0.00106514) (0.5\\,\\mathrm{m\\,s^{-1}})^{2} $$\n$$ |\\boldsymbol{\\tau}_{b}| = (1025) (0.00106514) (0.25) \\,\\mathrm{N\\,m^{-2}} $$\n$$ |\\boldsymbol{\\tau}_{b}| \\approx 0.272942\\,\\mathrm{N\\,m^{-2}} $$\n\n最后，按要求将结果四舍五入到三位有效数字。\n$$ |\\boldsymbol{\\tau}_{b}| \\approx 0.273\\,\\mathrm{N\\,m^{-2}} $$\n单位 $\\mathrm{N\\,m^{-2}}$ 等同于帕斯卡 ($\\mathrm{Pa}$)。",
            "answer": "$$\n\\boxed{0.273}\n$$"
        },
        {
            "introduction": "理论模型为我们提供了理想化的框架，但在实际应用中，我们处理的是离散且含有噪声的观测数据。这项综合性的计算练习将理论与实践相结合。你将利用真实的近底层流速剖面数据，通过拟合对数律来估算底床粗糙度和切应力，并应用统计学中的自助法（bootstrapping）来量化这些估计值的不确定性，这是现代计算科学研究中的一项核心技能。",
            "id": "3806865",
            "problem": "您将获得在底部边界层 (BBL) 内海床上方多个已知高度处的近底床流速测量值，以及水密度。任务是使用二次拖曳力公式计算底部剪切应力 $ \\tau_b $，其中拖曳系数 $ C_d $ 是通过中性对数律壁面定律由拟合的粗糙度长度 $ z_0 $ 确定的。您还必须使用测量数据对的非参数自举法来量化指定参考高度处 $ \\tau_b $ 的不确定性。\n\n基本原理：\n- 对于在稳定、中性分层、水平均匀条件下的BBL中的牛顿流体，其顺流向平均速度剖面满足对数律：\n$$ U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right), $$\n其中 $ U(z) $ 是高度 $ z $ 处的平均流速大小，$ u_* $ 是摩擦速度，定义为 $ u_* = \\sqrt{\\tau_b/\\rho} $，$ \\rho $ 是流体密度，$ \\kappa $ 是 von Kármán 常数，$ z_0 $ 是水动力粗糙度长度。\n- 在参考高度 $ z_r $ 处，平均速度为 $ U_r = U(z_r) $ 的二次底部应力参数化为\n$$ \\tau_b = \\rho \\, C_d(z_r) \\, U_r^2, $$\n其中拖曳系数 $ C_d(z_r) $ 必须从对数律和拟合的 $ z_0 $ 推导得出。\n\n您的程序必须：\n1. 使用模型 $ U(z) = A \\ln(z) + B $，通过线性最小二乘法拟合对数律参数以估计 $ A $ 和 $ B $，然后计算粗糙度长度 $ z_0 = \\exp\\!\\left(-\\frac{B}{A}\\right) $。使用 $ \\kappa = 0.41 $。\n2. 根据拟合的 $ z_0 $，推导在指定参考高度 $ z_r $ 处的拖曳系数：\n$$ C_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0)}\\right)^2. $$\n3. 使用给定的 $ \\rho $ 和在 $ z_r $ 处测得的 $ U_r $，计算点估计值 $ \\hat{\\tau}_b $。\n4. 使用非参数自举法评估 $ \\tau_b $ 的不确定性：有放回地重采样 $ (z_i, U_i) $ 数据对，对每个自举复制样本重新拟合 $ A $、$ B $，重新计算 $ z_0 $、$ C_d(z_r) $ 和 $ \\tau_b $。使用 $ N = 2000 $ 个自举复制样本，固定随机种子为 $ 42 $。排除任何拟合的 $ A \\le 0 $ 或 $ \\ln(z_r / z_0) \\le 0 $（这对于在给定的 $ z_r $ 处应用中性对数律来说是非物理的）的自举复制样本。从有效的复制样本中，报告 $ 2.5\\% $ 和 $ 97.5\\% $ 的经验百分位数，作为 $ \\tau_b $ 的 $ 95\\% $ 置信区间的边界。\n5. 将 $ \\tau_b $ 以帕斯卡（$ \\mathrm{Pa} $）为单位表示为浮点值；$ C_d $ 是无单位的。\n\n测试套件：\n- 情况1（一般场景）：\n  - 高度：$ z = [0.2, 0.5, 1.0, 1.5, 2.0] \\mathrm{m} $\n  - 速度：$ U = [0.224, 0.271, 0.303, 0.322, 0.337] \\mathrm{m/s} $\n  - 密度：$ \\rho = 1025 \\mathrm{kg/m^3} $\n  - 参考高度：$ z_r = 1.0 \\mathrm{m} $\n  - 参考速度：$ U_r = 0.303 \\mathrm{m/s} $\n- 情况2（类似光滑床边界的条件）：\n  - 高度：$ z = [0.05, 0.1, 0.2, 0.5, 1.0] \\mathrm{m} $\n  - 速度：$ U = [0.152, 0.176, 0.200, 0.215, 0.224] \\mathrm{m/s} $\n  - 密度：$ \\rho = 1027 \\mathrm{kg/m^3} $\n  - 参考高度：$ z_r = 0.5 \\mathrm{m} $\n  - 参考速度：$ U_r = 0.215 \\mathrm{m/s} $\n- 情况3（稀疏数据边缘情况）：\n  - 高度：$ z = [0.3, 0.6, 1.2] \\mathrm{m} $\n  - 速度：$ U = [0.299, 0.350, 0.400] \\mathrm{m/s} $\n  - 密度：$ \\rho = 1024 \\mathrm{kg/m^3} $\n  - 参考高度：$ z_r = 0.6 \\mathrm{m} $\n  - 参考速度：$ U_r = 0.350 \\mathrm{m/s} $\n\n要求的最终输出格式：\n- 您的程序应生成一行输出，其中包含所有三个测试用例的结果，形式为一个用方括号括起来的逗号分隔列表，其中每个测试用例的结果本身就是一个列表，顺序为 $ [\\hat{\\tau}_b, \\tau_{b,\\mathrm{low}}, \\tau_{b,\\mathrm{high}}, \\hat{C}_d] $。这里 $ \\hat{\\tau}_b $ 是点估计值，$ \\tau_{b,\\mathrm{low}} $ 和 $ \\tau_{b,\\mathrm{high}} $ 是通过自举法得到的 $ 95\\% $ 置信区间的下限和上限，$ \\hat{C}_d $ 是在 $ z_r $ 处的拖曳系数的点估计值。例如，输出应如下所示\n$$ [ [x_1,y_1,z_1,w_1], [x_2,y_2,z_2,w_2], [x_3,y_3,z_3,w_3] ] $$\n其中 $ x_i, y_i, z_i, w_i $ 被替换为数值。",
            "solution": "该问题要求根据近底床速度剖面测量值计算底部剪切应力 $\\tau_b$ 及其相关的不确定性。所指定的方法基于湍流边界层理论的一个基本原理——壁面-对数律，并结合了二次拖曳力公式和用于不确定性分析的非参数自举法。\n\n此过程首先验证问题陈述。\n\n### 步骤1：提取给定条件\n- **控制方程（壁面-对数律）：** 对于稳定、中性分层、水平均匀的底部边界层（BBL），海床以上高度为 $z$ 处的平均流速 $U(z)$ 由下式给出：\n$$ U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right) $$\n- **摩擦速度定义：** $u_* = \\sqrt{\\tau_b/\\rho}$，其中 $\\tau_b$ 是底部剪切应力，$\\rho$ 是流体密度。\n- **二次拖曳力定律：** 在参考高度 $z_r$ 处的底部剪切应力参数化为：\n$$ \\tau_b = \\rho \\, C_d(z_r) \\, U_r^2 $$\n其中 $U_r = U(z_r)$ 是在 $z_r$ 处的速度，$C_d(z_r)$ 是该高度的拖曳系数。\n- **用于拟合的线性模型：** 对数律将使用线性模型 $U(z) = A \\ln(z) + B$ 进行拟合。\n- **参数恢复：** 水动力粗糙度长度 $z_0$ 从拟合参数 $A$ 和 $B$ 中恢复，使用公式：\n$$ z_0 = \\exp\\!\\left(-\\frac{B}{A}\\right) $$\n- **拖曳系数公式：** 拖曳系数 $C_d(z_r)$ 从拟合的 $z_0$ 推导得出：\n$$ C_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0)}\\right)^2 $$\n- **常数：** von Kármán 常数为 $\\kappa = 0.41$。\n- **自举法参数：** 自举复制样本数为 $N = 2000$，随机种子固定为 $42$。\n- **自举法筛选条件：** 排除拟合斜率 $A \\le 0$ 或 $\\ln(z_r / z_0) \\le 0$ 的复制样本。\n- **不确定性量化：** $\\tau_b$ 的 $95\\%$ 置信区间由有效自举复制样本的 $2.5\\%$ 和 $97.5\\%$ 经验百分位数定义。\n- **测试用例：** 提供了三个不同的测试用例，每个用例都有一组高度 $z$、对应的速度 $U$、流体密度 $\\rho$、一个参考高度 $z_r$ 以及在该参考高度的速度 $U_r$。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学依据：** 该问题牢固地植根于经典的湍流边界层理论。壁面-对数律是流体动力学的基石，二次拖曳力定律是海洋学和气象学中的标准参数化方法。所提供的方程与基本原理一致。$\\kappa = 0.41$ 的值是一个标准的、被广泛使用的值。该问题在科学上是合理的。\n- **适定性：** 该问题是适定的。它明确了一系列清晰的操作：线性最小二乘拟合、物理参数的直接计算，以及用于不确定性估计的标准统计程序（非参数自举法）。自举程序的筛选条件可以防止出现非物理或数学上未定义的结果，从而确保了鲁棒性。在正常条件下（例如，非一致的数据点），每一步解的存在性和唯一性都得到保证。\n- **客观性：** 该问题以客观和精确的语言陈述。所有必需的数据、常数和公式都已明确提供。没有主观因素。\n- **其他缺陷：** 该问题是自洽的，没有缺失信息或矛盾之处。所要求的条件和数据对于海洋底部边界层来说是物理上合理的。结构逻辑清晰，该任务是该领域一个标准的数据分析问题，并非无关紧要或同义反复。\n\n### 步骤3：结论与行动\n该问题是有效的。它在科学上合理、适定、客观且完整。可以计算出分步解。\n\n### 求解推导\n\n对于每个测试用例，求解过程分四个主要阶段进行：(1) 拟合对数律以确定剖面参数，(2) 计算拖曳系数 $C_d$ 和底部应力 $\\tau_b$ 的点估计值，(3) 执行自举分析以量化 $\\tau_b$ 的不确定性，以及 (4) 报告结果。\n\n**1. 对数律剖面拟合**\n关系式 $U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)$ 可以改写为 $U(z) = \\frac{u_*}{\\kappa} \\ln(z) - \\frac{u_*}{\\kappa} \\ln(z_0)$。这与线性形式 $U(z) = A \\ln(z) + B$ 相匹配，其中斜率为 $A = u_*/\\kappa$，截距为 $B = - (u_*/\\kappa) \\ln(z_0)$。\n给定一组测量数据对 $(z_i, U_i)$，我们首先将高度转换为 $x_i = \\ln(z_i)$。然后，我们对 $(x_i, U_i)$ 数据对执行线性最小二乘回归，以找到最佳拟合系数 $\\hat{A}$ 和 $\\hat{B}$。\n根据这些系数，可以估算出水动力粗糙度长度 $\\hat{z}_0$。由于 $\\hat{B}/\\hat{A} = -\\ln(\\hat{z}_0)$，我们有：\n$$ \\hat{z}_0 = \\exp\\left(-\\frac{\\hat{B}}{\\hat{A}}\\right) $$\n\n**2. $C_d$ 和 $\\tau_b$ 的点估计**\n利用估计的粗糙度长度 $\\hat{z}_0$，可以计算出在指定参考高度 $z_r$ 处的拖曳系数 $\\hat{C}_d$。该公式是通过将 $C_d$ 的定义与对数律相结合推导得出的：$C_d(z_r) = (u_*/U_r)^2$ 且 $U_r = (u_*/\\kappa)\\ln(z_r/z_0)$，这给出 $u_*/U_r = \\kappa/\\ln(z_r/z_0)$。因此：\n$$ \\hat{C}_d(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / \\hat{z}_0)}\\right)^2 $$\n然后，使用二次拖曳力定律，根据给定的密度 $\\rho$、测量的参考速度 $U_r$ 和估计的拖曳系数 $\\hat{C}_d(z_r)$，计算底部剪切应力的点估计值 $\\hat{\\tau}_b$：\n$$ \\hat{\\tau}_b = \\rho \\, \\hat{C}_d(z_r) \\, U_r^2 $$\n\n**3. 自举法不确定性量化**\n为了评估由速度测量值变异性引起的 $\\tau_b$ 的不确定性，我们采用非参数自举法。这种统计技术涉及对原始数据进行重复重采样，以模拟可能结果的分布。过程如下：\n- 使用固定的随机种子（$42$）以确保可复现性。\n- 共生成 $N=2000$ 个自举复制样本。对于每个复制样本：\n    a. 通过从原始测量数据集中有放回地抽取，创建一个新的 $(z_i, U_i)$ 数据对数据集。新数据集的大小与原始数据集相同。\n    b. 对这个重采样的数据集重复对数律拟合过程，以获得一组新的系数 $A^*$ 和 $B^*$。\n    c. 对新系数进行验证。如果 $A^* \\le 0$，则该复制样本被丢弃，因为它意味着非物理的零或负摩擦速度。\n    d. 计算一个新的粗糙度长度 $z_0^* = \\exp(-B^*/A^*)$。\n    e. 检查对数律在参考高度的适用性。如果 $\\ln(z_r/z_0^*) \\le 0$（即 $z_r \\le z_0^*$），则参考高度低于粗糙度长度，这是非物理的。该复制样本被丢弃。\n    f. 对于有效的复制样本，计算拖曳系数 $C_d^*(z_r)$ 和底部应力 $\\tau_b^*$ 的自举估计值：\n    $$ C_d^*(z_r) = \\left(\\frac{\\kappa}{\\ln(z_r / z_0^*)}\\right)^2 $$\n    $$ \\tau_b^* = \\rho \\, C_d^*(z_r) \\, U_r^2 $$\n- 生成所有复制样本后，所有有效的 $\\tau_b^*$ 值集合构成了底部剪切应力的自举分布。\n\n**4. 置信区间与报告**\n$\\tau_b$ 的 $95\\%$ 置信区间由经验自举分布确定。下限 $\\tau_{b, \\text{low}}$ 是排序后 $\\tau_b^*$ 值的第 $2.5$ 百分位数，上限 $\\tau_{b, \\text{high}}$ 是第 $97.5$ 百分位数。\n对于每个测试用例，最终结果是四个值的集合：剪切应力的点估计值 $\\hat{\\tau}_b$、其置信区间的下限和上限（$\\tau_{b, \\text{low}}$、$\\tau_{b, \\text{high}}$），以及拖曳系数的点估计值 $\\hat{C}_d(z_r)$。然后将这些结果按照指定格式进行格式化。",
            "answer": "[ [0.15545084, 0.13309118, 0.18096055, 0.00164805], [0.04633785, 0.03822479, 0.05313936, 0.00097693], [0.20786438, 0.08182414, 0.45663445, 0.00165502] ]"
        }
    ]
}