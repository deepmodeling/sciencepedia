{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex parameterizations, it is crucial to understand why they are necessary. This first exercise uses fundamental scaling analysis to reveal the vast disparity between advective and molecular transport scales in a typical oceanic mixed layer. By calculating the Reynolds and Péclet numbers, you will quantify this scale separation and grasp the physical justification for representing unresolved turbulent mixing with eddy coefficients .",
            "id": "3791297",
            "problem": "Consider a horizontally homogeneous oceanic mixed layer that is well-stirred by turbulence and approximately unstratified over its depth. Assume the flow is governed by the incompressible momentum equations and a passive scalar advection–diffusion equation, and take the characteristic scales to be a velocity scale $U$, a length scale $L$ representative of the mixed layer depth, a kinematic viscosity $\\nu$ of seawater, and a molecular diffusivity $\\kappa$ of the scalar (temperature). Starting from the momentum and scalar transport equations, perform a nondimensionalization using the scales $U$ and $L$ and identify the nondimensional parameters that measure the relative importance of advective to diffusive processes in momentum and scalar transport. Then, using the following scientifically plausible values representative of a mid-latitude wind-mixed surface layer:\n- $U = 0.30 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$,\n- $L = 60 \\ \\mathrm{m}$,\n- $\\nu = 1.05 \\times 10^{-6} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$ (kinematic viscosity of seawater at moderate temperature),\n- $\\kappa = 1.40 \\times 10^{-7} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$ (molecular thermal diffusivity of seawater),\n\ncompute the Reynolds number (denoted $\\mathrm{Re}$) and the Péclet number (denoted $\\mathrm{Pe}$) for this mixed layer. Based on the magnitudes of these dimensionless numbers from your derivation, infer whether representing unresolved turbulent transport via eddy viscosity and eddy diffusivity coefficients is appropriate in computational oceanography for this scenario. Express your final numerical results for $\\mathrm{Re}$ and $\\mathrm{Pe}$ as a row matrix $\\left( \\mathrm{Re} \\ \\mathrm{Pe} \\right)$ and round to three significant figures. Since these are dimensionless numbers, no physical units should be included in the final answer.",
            "solution": "The problem is first validated and found to be scientifically grounded, well-posed, objective, and self-contained. The provided physical parameters are realistic for the specified oceanographic scenario. Therefore, a full solution is warranted.\n\nThe problem requires us to analyze the relative importance of advective and diffusive transport mechanisms for momentum and a passive scalar in an oceanic mixed layer. This is accomplished by nondimensionalizing the governing equations.\n\nLet the velocity field be $\\mathbf{u}(\\mathbf{x}, t)$ and the passive scalar concentration be $C(\\mathbf{x}, t)$. The flow is governed by the incompressible momentum (Navier-Stokes) equations, and the scalar transport is governed by an advection-diffusion equation. We focus on the terms representing advection and diffusion.\n\nThe momentum equation for an incompressible fluid is:\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\mathbf{f} + \\nu \\nabla^2 \\mathbf{u}\n$$\nwhere the term $(\\mathbf{u} \\cdot \\nabla)\\mathbf{u}$ represents the advection of momentum (inertia) and the term $\\nu \\nabla^2 \\mathbf{u}$ represents the viscous diffusion of momentum. Here, $\\rho$ is the fluid density, $p$ is the pressure, $\\mathbf{f}$ represents body forces (like gravity and Coriolis force), and $\\nu$ is the kinematic viscosity.\n\nThe transport equation for a passive scalar $C$ is:\n$$\n\\frac{\\partial C}{\\partial t} + (\\mathbf{u} \\cdot \\nabla)C = \\kappa \\nabla^2 C\n$$\nwhere the term $(\\mathbf{u} \\cdot \\nabla)C$ represents the advection of the scalar and $\\kappa \\nabla^2 C$ represents its molecular diffusion. Here, $\\kappa$ is the molecular diffusivity of the scalar.\n\nTo nondimensionalize these equations, we introduce dimensionless variables, denoted by a superscript $*$. We use the characteristic velocity scale $U$ and length scale $L$:\n$$\n\\mathbf{x} = L\\mathbf{x}^* \\quad \\implies \\quad \\nabla = \\frac{1}{L}\\nabla^*\n$$\n$$\n\\mathbf{u} = U\\mathbf{u}^*\n$$\nThe characteristic time scale for advection is $T = L/U$, so we define dimensionless time as:\n$$\nt = \\frac{L}{U}t^* \\quad \\implies \\quad \\frac{\\partial}{\\partial t} = \\frac{U}{L}\\frac{\\partial}{\\partial t^*}\n$$\nWe define a dimensionless scalar $C^*$ in a similar manner, $C = C_{scale}C^*$, where $C_{scale}$ is a characteristic scale for the scalar.\n\nSubstituting these into the momentum advection and diffusion terms:\n- Advective term: $(\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = (U\\mathbf{u}^* \\cdot \\frac{1}{L}\\nabla^*)(U\\mathbf{u}^*) = \\frac{U^2}{L}(\\mathbf{u}^* \\cdot \\nabla^*)\\mathbf{u}^*$\n- Viscous term: $\\nu \\nabla^2 \\mathbf{u} = \\nu \\left(\\frac{1}{L^2}\\nabla^{*2}\\right)(U\\mathbf{u}^*) = \\frac{\\nu U}{L^2}\\nabla^{*2}\\mathbf{u}^*$\n\nThe ratio of the magnitude of the advective term to the viscous term is:\n$$\n\\frac{|(\\mathbf{u} \\cdot \\nabla)\\mathbf{u}|}{|\\nu \\nabla^2 \\mathbf{u}|} \\sim \\frac{U^2/L}{\\nu U/L^2} = \\frac{UL}{\\nu}\n$$\nThis dimensionless number is the Reynolds number, $\\mathrm{Re}$.\n$$\n\\mathrm{Re} = \\frac{UL}{\\nu}\n$$\nIt represents the ratio of inertial forces to viscous forces.\n\nSimilarly, substituting the dimensionless variables into the scalar transport equation:\n- Advective term: $(\\mathbf{u} \\cdot \\nabla)C = (U\\mathbf{u}^* \\cdot \\frac{1}{L}\\nabla^*)(C_{scale}C^*) = \\frac{U C_{scale}}{L}(\\mathbf{u}^* \\cdot \\nabla^*)C^*$\n- Diffusive term: $\\kappa \\nabla^2 C = \\kappa \\left(\\frac{1}{L^2}\\nabla^{*2}\\right)(C_{scale}C^*) = \\frac{\\kappa C_{scale}}{L^2}\\nabla^{*2}C^*$\n\nThe ratio of the magnitude of the advective term to the diffusive term is:\n$$\n\\frac{|(\\mathbf{u} \\cdot \\nabla)C|}{|\\kappa \\nabla^2 C|} \\sim \\frac{U C_{scale}/L}{\\kappa C_{scale}/L^2} = \\frac{UL}{\\kappa}\n$$\nThis dimensionless number is the Péclet number, $\\mathrm{Pe}$.\n$$\n\\mathrm{Pe} = \\frac{UL}{\\kappa}\n$$\nIt represents the ratio of the rate of advection of a physical quantity by the flow to the rate of diffusion of the same quantity driven by an appropriate gradient.\n\nNow we compute the values of $\\mathrm{Re}$ and $\\mathrm{Pe}$ using the given data:\n- $U = 0.30 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$\n- $L = 60 \\ \\mathrm{m}$\n- $\\nu = 1.05 \\times 10^{-6} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$\n- $\\kappa = 1.40 \\times 10^{-7} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$\n\nThe Reynolds number is:\n$$\n\\mathrm{Re} = \\frac{UL}{\\nu} = \\frac{(0.30 \\ \\mathrm{m} \\ \\mathrm{s}^{-1})(60 \\ \\mathrm{m})}{1.05 \\times 10^{-6} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}} = \\frac{18}{1.05 \\times 10^{-6}} \\approx 17142857\n$$\nRounding to three significant figures, $\\mathrm{Re} = 1.71 \\times 10^7$.\n\nThe Péclet number is:\n$$\n\\mathrm{Pe} = \\frac{UL}{\\kappa} = \\frac{(0.30 \\ \\mathrm{m} \\ \\mathrm{s}^{-1})(60 \\ \\mathrm{m})}{1.40 \\times 10^{-7} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}} = \\frac{18}{1.40 \\times 10^{-7}} \\approx 128571428\n$$\nRounding to three significant figures, $\\mathrm{Pe} = 1.29 \\times 10^8$.\n\nThe calculated Reynolds number, $\\mathrm{Re} \\approx 1.71 \\times 10^7$, is exceptionally large. For most fluid flows, a transition to turbulence occurs at $\\mathrm{Re}$ values of the order of $10^3 - 10^5$. A Reynolds number of this magnitude indicates that the flow is highly turbulent. In such a regime, the advective transport of momentum (inertia) overwhelms the molecular viscous diffusion by many orders of magnitude.\n\nSimilarly, the Péclet number, $\\mathrm{Pe} \\approx 1.29 \\times 10^8$, is also extremely large. This signifies that the advective transport of the scalar (temperature) by the flow is vastly dominant over its diffusion at the molecular level.\n\nIn computational oceanography, numerical models discretize the ocean onto a grid. The grid resolution is typically on the order of kilometers in the horizontal and meters to tens of meters in the vertical. These grid spacings are far too coarse to resolve the smallest scales of turbulent motion (the Kolmogorov scale) or scalar mixing (the Batchelor scale), which are on the order of millimeters or smaller in such energetic environments.\n\nSince the direct effects of molecular viscosity and diffusivity are completely negligible at the scales resolved by the model, but the collective effect of the unresolved turbulent eddies is to mix momentum and scalars very efficiently, these sub-grid-scale turbulent transport processes must be parameterized. The concept of eddy viscosity ($A_v$) and eddy diffusivity ($K_v$) is a common, albeit simplified, method for this parameterization. These eddy coefficients are not properties of the fluid itself but are properties of the flow, representing the enhanced mixing due to turbulence. They are typically orders of magnitude larger than their molecular counterparts ($\\nu$ and $\\kappa$).\n\nTherefore, the extremely large values of $\\mathrm{Re}$ and $\\mathrm{Pe}$ definitively confirm that the flow is in a turbulent regime where molecular transport is insignificant compared to advection at the large scale. This provides the fundamental physical justification for needing to parameterize unresolved turbulent mixing. The use of eddy viscosity and eddy diffusivity coefficients is a standard and appropriate approach to represent these effects in computational ocean models for this scenario.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.71 \\times 10^{7}  1.29 \\times 10^{8}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With the need for eddy coefficients established, a practical question arises: how do we estimate their values from observations? This exercise guides you through the derivation of a widely used model linking diapycnal diffusivity ($K_{\\rho}$) to the turbulent kinetic energy (TKE) dissipation rate ($\\epsilon$) and stratification ($N^2$). You will then apply error propagation techniques to quantify how measurement uncertainties affect the final diffusivity estimate, a crucial skill for interpreting real-world oceanographic data .",
            "id": "3791296",
            "problem": "A diapycnal mixing study in the ocean interior uses microstructure measurements to estimate the turbulent kinetic energy (TKE) dissipation rate $\\epsilon$ and the buoyancy frequency squared $N^{2}$ over a vertically homogeneous patch. The goal is to infer the diapycnal diffusivity $K_{\\rho}$ and quantify the uncertainty imparted by measurement errors in $\\epsilon$ and $N^{2}$. Begin from first principles: the steady-state TKE budget and the definition of the diapycnal buoyancy flux, and the concept of a constant mixing efficiency $\\Gamma$ (assumed independent of $\\epsilon$ and $N^{2}$ over the patch). Derive an expression linking $K_{\\rho}$ to $\\epsilon$, $N^{2}$, and $\\Gamma$ without invoking any shortcut formulas. Then perform a first-order uncertainty propagation treating $K_{\\rho}$ as a function of the measured quantities.\n\nAssume the following scientifically realistic conditions and data:\n- The mixing efficiency is constant and equal to $\\Gamma = 0.2$ over the patch.\n- The measured mean dissipation rate is $\\epsilon = 5.0 \\times 10^{-10}$ in watt per kilogram.\n- The measured mean buoyancy frequency squared is $N^{2} = 2.0 \\times 10^{-5}$ in per second squared.\n- The fractional (relative) one-sigma uncertainties of the two measured means are Gaussian with zero mean, with standard deviations $\\sigma_{\\epsilon,\\mathrm{rel}} = 0.40$ and $\\sigma_{N^{2},\\mathrm{rel}} = 0.20$.\n- The fractional errors in $\\epsilon$ and $N^{2}$ have a correlation coefficient $r = 0.25$ due to common environmental variability during sampling.\n\nUsing a linearization about the measured means, propagate these errors to obtain the one-sigma standard uncertainty in $K_{\\rho}$. Express the final uncertainty in square meters per second, and round your answer to three significant figures.",
            "solution": "The problem asks for the derivation of the diapycnal diffusivity $K_{\\rho}$ from first principles and the subsequent calculation of its uncertainty based on given measurement errors.\n\nFirst, we derive the expression for $K_{\\rho}$. The derivation begins with the definition of the diapycnal buoyancy flux, $B$, which represents the rate of work per unit mass done by turbulent motions against the stable density stratification. It is a sink of turbulent kinetic energy (TKE) and a source of mean potential energy. The buoyancy flux is defined as:\n$$ B = \\frac{g}{\\rho_0} \\overline{w' \\rho'} $$\nwhere $g$ is the acceleration due to gravity, $\\rho_0$ is a reference density, and $\\overline{w' \\rho'}$ is the mean turbulent density flux in the vertical direction. For turbulent mixing to occur in a stable stratification, there must be a net upward transport of denser water and downward transport of lighter water, relative to their mean positions. This corresponds to a positive correlation between vertical velocity fluctuations $w'$ and density fluctuations $\\rho'$, hence $\\overline{w' \\rho'}  0$ and $B  0$.\n\nThe turbulent density flux is parameterized using an eddy diffusivity, or diapycnal diffusivity, $K_{\\rho}$:\n$$ \\overline{w' \\rho'} = -K_{\\rho} \\frac{d\\bar{\\rho}}{dz} $$\nwhere $\\frac{d\\bar{\\rho}}{dz}$ is the mean vertical density gradient. Substituting this into the definition of $B$ gives:\n$$ B = \\frac{g}{\\rho_0} \\left( -K_{\\rho} \\frac{d\\bar{\\rho}}{dz} \\right) = K_{\\rho} \\left( -\\frac{g}{\\rho_0} \\frac{d\\bar{\\rho}}{dz} \\right) $$\nThe term in the parentheses is the definition of the buoyancy frequency squared, $N^2$:\n$$ N^2 = -\\frac{g}{\\rho_0} \\frac{d\\bar{\\rho}}{dz} $$\nFor a stable stratification, $\\frac{d\\bar{\\rho}}{dz}  0$, so $N^2  0$. Thus, we establish a relationship between buoyancy flux, diapycnal diffusivity, and stratification:\n$$ B = K_{\\rho} N^2 $$\n\nThe problem states to use the concept of a constant mixing efficiency, $\\Gamma$. In the context of a steady-state TKE budget (where production balances dissipation and buoyancy flux, $P = \\epsilon + B$), the mixing efficiency is formally the ratio of buoyancy flux to TKE production, $\\Gamma = B/P$. A common and simpler model, advanced by Osborn (1980), parameterizes the buoyancy flux as a fraction of the TKE dissipation rate, $\\epsilon$. This model effectively defines the mixing efficiency as:\n$$ \\Gamma = \\frac{B}{\\epsilon} $$\nThis model assumes that the energy dissipated is a good proxy for the total energy available to the turbulent cascade. Combining this with our expression for $B$, we get:\n$$ \\Gamma \\epsilon = K_{\\rho} N^2 $$\nSolving for the diapycnal diffusivity $K_{\\rho}$ yields the desired expression:\n$$ K_{\\rho} = \\frac{\\Gamma \\epsilon}{N^2} $$\n\nNext, we perform a first-order uncertainty propagation to find the standard uncertainty in $K_{\\rho}$. The quantity $K_{\\rho}$ is a function of the measured variables $\\epsilon$ and $N^2$. The mixing efficiency $\\Gamma$ is given as a constant with no uncertainty. The general formula for the variance $\\sigma_{K_{\\rho}}^2$ of a function of two correlated variables, $K_{\\rho}(\\epsilon, N^2)$, is:\n$$ \\sigma_{K_{\\rho}}^2 \\approx \\left(\\frac{\\partial K_{\\rho}}{\\partial \\epsilon}\\right)^2 \\sigma_{\\epsilon}^2 + \\left(\\frac{\\partial K_{\\rho}}{\\partial N^2}\\right)^2 \\sigma_{N^2}^2 + 2 \\left(\\frac{\\partial K_{\\rho}}{\\partial \\epsilon}\\right) \\left(\\frac{\\partial K_{\\rho}}{\\partial N^2}\\right) \\mathrm{Cov}(\\epsilon, N^2) $$\nwhere $\\sigma_{\\epsilon}^2$ and $\\sigma_{N^2}^2$ are the variances of $\\epsilon$ and $N^2$, and $\\mathrm{Cov}(\\epsilon, N^2)$ is their covariance. The partial derivatives are evaluated at the mean values of the variables.\n\nIt is more convenient to work with fractional (relative) uncertainties. We can express the above formula in terms of relative variance, $\\sigma_{K_{\\rho},\\mathrm{rel}}^2 = \\sigma_{K_{\\rho}}^2 / K_{\\rho}^2$. For a function of the form $K_{\\rho} = \\Gamma \\epsilon^a (N^2)^b$ with $a=1$ and $b=-1$, the relative variance is given by:\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx a^2 \\sigma_{\\epsilon,\\mathrm{rel}}^2 + b^2 \\sigma_{N^2,\\mathrm{rel}}^2 + 2ab \\, r \\, \\sigma_{\\epsilon,\\mathrm{rel}} \\sigma_{N^2,\\mathrm{rel}} $$\nwhere $\\sigma_{\\epsilon,\\mathrm{rel}} = \\sigma_{\\epsilon}/\\epsilon$ and $\\sigma_{N^2,\\mathrm{rel}} = \\sigma_{N^2}/N^2$ are the relative standard uncertainties, and $r$ is the correlation coefficient between the fractional errors in $\\epsilon$ and $N^2$. Substituting $a=1$ and $b=-1$:\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx (1)^2 \\sigma_{\\epsilon,\\mathrm{rel}}^2 + (-1)^2 \\sigma_{N^2,\\mathrm{rel}}^2 + 2(1)(-1) r \\, \\sigma_{\\epsilon,\\mathrm{rel}} \\sigma_{N^2,\\mathrm{rel}} $$\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx \\sigma_{\\epsilon,\\mathrm{rel}}^2 + \\sigma_{N^2,\\mathrm{rel}}^2 - 2 r \\, \\sigma_{\\epsilon,\\mathrm{rel}} \\sigma_{N^2,\\mathrm{rel}} $$\nWe are given the following values:\n-   $\\sigma_{\\epsilon,\\mathrm{rel}} = 0.40$\n-   $\\sigma_{N^2,\\mathrm{rel}} = 0.20$\n-   $r = 0.25$\n\nSubstituting these values into the equation for the relative variance of $K_{\\rho}$:\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx (0.40)^2 + (0.20)^2 - 2(0.25)(0.40)(0.20) $$\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx 0.16 + 0.04 - (0.5)(0.08) $$\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}}^2 \\approx 0.20 - 0.04 = 0.16 $$\nThe relative standard uncertainty in $K_{\\rho}$ is the square root of this value:\n$$ \\sigma_{K_{\\rho},\\mathrm{rel}} = \\sqrt{0.16} = 0.40 $$\n\nTo find the absolute standard uncertainty, $\\sigma_{K_{\\rho}}$, we must first calculate the mean value of $K_{\\rho}$ using the given mean values for $\\epsilon$ and $N^2$, and the constant $\\Gamma$:\n-   $\\Gamma = 0.2$\n-   $\\epsilon = 5.0 \\times 10^{-10} \\text{ W/kg} = 5.0 \\times 10^{-10} \\text{ m}^2/\\text{s}^3$\n-   $N^2 = 2.0 \\times 10^{-5} \\text{ s}^{-2}$\n\n$$ K_{\\rho} = \\frac{\\Gamma \\epsilon}{N^2} = \\frac{(0.2)(5.0 \\times 10^{-10} \\text{ m}^2/\\text{s}^3)}{2.0 \\times 10^{-5} \\text{ s}^{-2}} $$\n$$ K_{\\rho} = \\frac{1.0 \\times 10^{-10} \\text{ m}^2/\\text{s}^3}{2.0 \\times 10^{-5} \\text{ s}^{-2}} = 0.5 \\times 10^{-5} \\text{ m}^2/\\text{s} = 5.0 \\times 10^{-6} \\text{ m}^2/\\text{s} $$\nThe absolute one-sigma standard uncertainty in $K_{\\rho}$ is then:\n$$ \\sigma_{K_{\\rho}} = K_{\\rho} \\times \\sigma_{K_{\\rho},\\mathrm{rel}} = (5.0 \\times 10^{-6} \\text{ m}^2/\\text{s}) \\times 0.40 $$\n$$ \\sigma_{K_{\\rho}} = 2.0 \\times 10^{-6} \\text{ m}^2/\\text{s} $$\nThe problem requires the answer to be rounded to three significant figures.\n$$ \\sigma_{K_{\\rho}} = 2.00 \\times 10^{-6} \\text{ m}^2/\\text{s} $$",
            "answer": "$$\n\\boxed{2.00 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "Having established the physical basis and an observational estimation method for eddy diffusivity, we now turn to its implementation within a numerical model. This final practice challenges you to derive the discrete form of the vertical diffusion operator as it appears in many ocean models. By discretizing the diffusion equation on a staggered grid and using an implicit time-stepping scheme, you will construct the tridiagonal matrix system that forms the core of the numerical solver .",
            "id": "3791243",
            "problem": "Consider a one-dimensional vertical column of ocean water in hydrostatic balance, in which the evolution of a passive tracer concentration $T(z,t)$ is governed solely by vertical turbulent diffusion with an eddy diffusivity $K(z)$. Starting from the tracer conservation law and Fick's law of diffusion, the governing equation in continuous form is\n$$\n\\frac{\\partial T}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial z}\\!\\left(K(z)\\,\\frac{\\partial T}{\\partial z}\\right).\n$$\nAssume a finite-volume discretization on a staggered vertical grid: tracer unknowns $T_i$ are located at cell centers $z_i$ for $i=1,\\dots,N$, and turbulent fluxes with eddy diffusivity $K$ are evaluated at cell interfaces $z_{i+1/2}$ for $i=1,\\dots,N-1$. Let the cell thicknesses be $\\Delta z_i = z_{i+1/2} - z_{i-1/2}$ and the center-to-center distances be $\\Delta z_{i+1/2} = z_{i+1} - z_i$. Denote the interface eddy diffusivities by $K_{i+1/2} = K(z_{i+1/2})$. Impose no-flux boundary conditions at the top and bottom boundaries, meaning the diffusive flux $F_{1/2}$ and $F_{N+1/2}$ vanish.\n\nUsing a backward Euler (BE) implicit time discretization with time step $\\Delta t$ for the diffusion term alone, derive the discrete vertical diffusion operator in finite-volume form and assemble the resulting linear system for the unknown vector $\\boldsymbol{T}^{n+1} = (T_1^{n+1},\\dots,T_N^{n+1})^{\\top}$ at the new time level $t^{n+1}$. Your derivation must begin from the continuous tracer conservation law and Fick's law, express fluxes and their divergences consistently on the staggered grid, and carefully account for nonuniform vertical spacing.\n\nFinally, write down the tridiagonal matrix form used in the implicit solver by giving closed-form analytic expressions for the interior stencil coefficients $a_i$, $b_i$, and $c_i$ for $i = 2,\\dots,N-1$, where $a_i$ multiplies $T_{i-1}^{n+1}$, $b_i$ multiplies $T_i^{n+1}$, and $c_i$ multiplies $T_{i+1}^{n+1}$. Express your final answer as a single analytic expression for $(a_i, b_i, c_i)$ in terms of $\\Delta t$, $K_{i\\pm 1/2}$, $\\Delta z_i$, and $\\Delta z_{i\\pm 1/2}$. No numerical evaluation is required. If you introduce any acronyms, define them on first use (for example, write \"Backward Euler (BE)\" the first time it appears).",
            "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in computational fluid dynamics, requiring the derivation of a standard numerical scheme.\n\nThe derivation begins with the integral form of the tracer conservation law for a control volume. For a one-dimensional vertical column, we consider a finite volume, or cell, $V_i$ for the tracer $T$. This cell $i$ is centered at $z_i$ and extends from the interface at $z_{i-1/2}$ to the interface at $z_{i+1/2}$. The tracer conservation law states that the rate of change of the total amount of tracer in the volume is equal to the net flux of the tracer across its boundaries.\nLet the vertical diffusive flux be denoted by $F(z,t)$. The conservation law for cell $i$ is:\n$$\n\\frac{d}{dt} \\int_{z_{i-1/2}}^{z_{i+1/2}} T(z,t) \\, dz = F(z_{i-1/2}, t) - F(z_{i+1/2}, t)\n$$\nIn the finite-volume method, we approximate the integral by the product of the cell-averaged concentration, $T_i(t)$, and the volume (here, thickness) of the cell, $\\Delta z_i = z_{i+1/2} - z_{i-1/2}$:\n$$\n\\int_{z_{i-1/2}}^{z_{i+1/2}} T(z,t) \\, dz \\approx T_i(t) \\Delta z_i\n$$\nSubstituting this into the conservation law gives the semi-discrete equation for the cell-averaged concentration:\n$$\n\\Delta z_i \\frac{d T_i}{dt} = F_{i-1/2} - F_{i+1/2}\n$$\nwhere $F_{i\\pm 1/2}$ represents the flux at the cell interfaces $z_{i\\pm 1/2}$.\n\nThe problem statement provides the relationship between the flux and the tracer gradient, which is a form of Fick's law, within the governing equation $\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial z}\\left(K(z)\\,\\frac{\\partial T}{\\partial z}\\right)$. This implies that the diffusive flux is $F = -K(z)\\frac{\\partial T}{\\partial z}$ and the conservation law is $\\frac{\\partial T}{\\partial t} + \\frac{\\partial F}{\\partial z} = 0$. So we have $F_{i+1/2} = - \\left( K(z)\\frac{\\partial T}{\\partial z} \\right)_{z=z_{i+1/2}}$.\nOn the staggered grid, the gradient at the interface $z_{i+1/2}$ is approximated using the tracer values at the adjacent cell centers $z_i$ and $z_{i+1}$:\n$$\n\\left(\\frac{\\partial T}{\\partial z}\\right)_{z=z_{i+1/2}} \\approx \\frac{T_{i+1}(t) - T_i(t)}{z_{i+1} - z_i} = \\frac{T_{i+1}(t) - T_i(t)}{\\Delta z_{i+1/2}}\n$$\nThe eddy diffusivity at the interface is given as $K_{i+1/2}$. Therefore, the discrete flux at the upper interface of cell $i$ is:\n$$\nF_{i+1/2} = -K_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta z_{i+1/2}}\n$$\nSimilarly, the flux at the lower interface is:\n$$\nF_{i-1/2} = -K_{i-1/2} \\frac{T_i - T_{i-1}}{\\Delta z_{i-1/2}}\n$$\nSubstituting these discrete fluxes into the semi-discrete conservation law yields:\n$$\n\\Delta z_i \\frac{d T_i}{dt} = \\left(-K_{i-1/2} \\frac{T_i - T_{i-1}}{\\Delta z_{i-1/2}}\\right) - \\left(-K_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta z_{i+1/2}}\\right)\n$$\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta z_i} \\left( K_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta z_{i+1/2}} - K_{i-1/2} \\frac{T_i - T_{i-1}}{\\Delta z_{i-1/2}} \\right)\n$$\nThis is the system of ordinary differential equations that describes the time evolution of the discrete tracer concentrations.\n\nNext, we discretize in time using the Backward Euler (BE) implicit scheme with a time step $\\Delta t$. For an equation of the form $\\frac{dy}{dt} = f(y)$, the BE scheme is $\\frac{y^{n+1}-y^n}{\\Delta t} = f(y^{n+1})$. We apply this to our semi-discrete equation, evaluating the right-hand side (the diffusion term) at the new time level $n+1$:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{1}{\\Delta z_i} \\left( K_{i+1/2} \\frac{T_{i+1}^{n+1} - T_i^{n+1}}{\\Delta z_{i+1/2}} - K_{i-1/2} \\frac{T_i^{n+1} - T_{i-1}^{n+1}}{\\Delta z_{i-1/2}} \\right)\n$$\nOur goal is to assemble a linear system of the form $\\mathbf{A} \\boldsymbol{T}^{n+1} = \\boldsymbol{T}^n$, which requires rearranging the equation to group terms with unknowns $T_j^{n+1}$ on the left-hand side and knowns $T_i^n$ on the right.\nFirst, multiply by $\\Delta t$:\n$$\nT_i^{n+1} - T_i^n = \\frac{\\Delta t}{\\Delta z_i} \\left( K_{i+1/2} \\frac{T_{i+1}^{n+1} - T_i^{n+1}}{\\Delta z_{i+1/2}} - K_{i-1/2} \\frac{T_i^{n+1} - T_{i-1}^{n+1}}{\\Delta z_{i-1/2}} \\right)\n$$\nNow, expand and collect terms multiplying $T_{i-1}^{n+1}$, $T_i^{n+1}$, and $T_{i+1}^{n+1}$:\n$$\nT_i^{n+1} - T_i^n = \\left(\\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\\right) T_{i+1}^{n+1} - \\left(\\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\\right) T_i^{n+1} - \\left(\\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\\right) T_i^{n+1} + \\left(\\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\\right) T_{i-1}^{n+1}\n$$\nMoving all terms with superscript $n+1$ to the left side:\n$$\n-\\left(\\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\\right) T_{i-1}^{n+1} + \\left(1 + \\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}} + \\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\\right) T_i^{n+1} - \\left(\\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\\right) T_{i+1}^{n+1} = T_i^n\n$$\nThis is the linear equation for the interior grid point $i$, for $i=2,\\dots,N-1$. The equation has the tridiagonal form $a_i T_{i-1}^{n+1} + b_i T_i^{n+1} + c_i T_{i+1}^{n+1} = T_i^n$.\nBy comparing the coefficients, we can identify $a_i$, $b_i$, and $c_i$:\n\n- The coefficient of $T_{i-1}^{n+1}$ is $a_i$:\n$$\na_i = - \\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}\n$$\n- The coefficient of $T_i^{n+1}$ is $b_i$:\n$$\nb_i = 1 + \\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}} + \\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\n$$\n- The coefficient of $T_{i+1}^{n+1}$ is $c_i$:\n$$\nc_i = - \\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}\n$$\nThese are the closed-form analytic expressions for the interior stencil coefficients of the tridiagonal matrix used in the implicit solver.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}}  1 + \\frac{\\Delta t K_{i-1/2}}{\\Delta z_i \\Delta z_{i-1/2}} + \\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}}  -\\frac{\\Delta t K_{i+1/2}}{\\Delta z_i \\Delta z_{i+1/2}} \\end{pmatrix}}\n$$"
        }
    ]
}