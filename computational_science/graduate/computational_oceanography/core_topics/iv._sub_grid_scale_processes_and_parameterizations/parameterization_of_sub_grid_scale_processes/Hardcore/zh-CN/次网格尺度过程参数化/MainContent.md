## 引言
在[计算海洋学](@entry_id:1122801)乃至整个[地球系统科学](@entry_id:175035)中，一个无法回避的根本挑战是：我们永远无法用有限的计算资源来模拟海洋和大气中存在的所有尺度的运动。从驱动全球气候的巨大洋流，到决定局部混合的微小[湍流](@entry_id:151300)涡旋，这些过程跨越了极其广阔的时空尺度。数值模型通过在离散的网格上求解控制方程来预测未来状态，但网格的分辨率天然地设定了一个界限，将流动划分为可被直接解析的“网格尺度”过程和尺度过小而无法解析的“次网格尺度”（sub-grid scale, SGS）过程。

然而，这些未被解析的小尺度过程并非无足轻重。通过[非线性](@entry_id:637147)相互作用，它们持续地与[大尺度流动](@entry_id:263652)交换能量和物质，对其演化产生着至关重要的影响。忽略这些效应会导致模型结果与现实产生巨大偏差。因此，[参数化](@entry_id:265163)——即在不直接模拟次网格过程的情况下，将其对已解析流动的净效应以数学形式表达出来的过程——成为了现代数值建[模的基](@entry_id:156416)石。本文旨在系统性地介绍[次网格尺度过程](@entry_id:1132602)[参数化](@entry_id:265163)的核心思想、关键技术及其在不同领域的应用。

在接下来的内容中，我们将分三部分展开：第一章“原理与机制”将深入探讨[参数化](@entry_id:265163)问题的起源，即闭合问题，并介绍从经典的降梯[度理论](@entry_id:636058)到更高级的各向异性及非局域闭合方案的演进逻辑，同时强调物理和数值约束的重要性。第二章“应用与跨学科联系”将展示这些原理如何在海洋、大气、陆面乃至天体物理等不同场景中具体应用，并探讨与数据同化、机器学习等前沿方法的深刻联系。最后，在第三章“动手实践”中，您将通过三个精心设计的计算练习，亲身体验如何量化次网格尺度、应用[参数化](@entry_id:265163)方案以及辨别物理与数值效应，从而将理论知识转化为实践技能。

## 原理与机制

在[海洋环流](@entry_id:195237)模型中，由于计算资源的限制，我们无法直接解析海洋中存在的所有尺度的运动。模型所使用的计算网格，其分辨率（例如，水平网格间距为 $\Delta$）决定了能够被直接模拟的最小尺度。那些特征尺度小于或接近网格分辨率的物理过程，其动力学行为无法在离散的网格上得到准确表达，这些过程被称为**次网格尺度（sub-grid scale, SGS）过程**。然而，这些未被解析的过程通过[非线性](@entry_id:637147)相互作用，仍然对我们关心的、可被解析的大尺度流动（**网格尺度**或**已解析尺度**过程）产生着至关重要的影响。因此，我们必须找到一种方法，在不直接模拟这些小尺度运动的情况下，将其对[大尺度流动](@entry_id:263652)的净效应（net effect）包含在我们的模型中。这一过程，就是**[参数化](@entry_id:265163)**。本章将深入探讨驱动[参数化](@entry_id:265163)方案发展的核心原理与关键机制。

### [次网格尺度过程](@entry_id:1132602)的起源：滤波与闭合问题

为了系统地理解[次网格尺度过程](@entry_id:1132602)的来源，我们首先需要一个数学工具来明确地区分“已解析”和“未解析”的运动。这个工具就是**[空间滤波](@entry_id:202429)**。给定一个连续的速度场 $\boldsymbol{u}(\boldsymbol{x}, t)$，我们可以定义一个**已解析场** $\overline{\boldsymbol{u}}$，它是通过一个特征宽度为 $\Delta$ 的低通[空间滤波器](@entry_id:1132038) $\mathcal{G}_{\Delta}$ 作用于原始场得到的：

$$
\overline{\boldsymbol{u}} = \mathcal{G}_{\Delta}[\boldsymbol{u}]
$$

相应地，**未解析场**（或称次网格场）$\boldsymbol{u}'$ 就是原始场与已解析场之差：

$$
\boldsymbol{u}' = \boldsymbol{u} - \overline{\boldsymbol{u}}
$$

从物理上讲，一个特征水平尺度为 $L$ 的过程，如果其尺度远大于网格间距（$L \gg \Delta$），那么它就是可被解析的。相反，如果 $L \lesssim \Delta$，那么该过程的动力学细节就会在滤波过程中被平滑掉，成为[次网格尺度过程](@entry_id:1132602) 。

值得注意的是，这种基于[空间滤波](@entry_id:202429)的分解（常见于**[大涡模拟](@entry_id:153702), Large Eddy Simulation, LES**）与经典的**雷诺平均（Reynolds Averaging）**在概念上有所不同。雷诺平均通常采用系综平均（ensemble average），即对大量统计上相同的流动实现进行平均，$\overline{\boldsymbol{u}} = \mathbb{E}[\boldsymbol{u}]$。根据定义，系综平均作用于一个未解析场（或称脉动场）$\boldsymbol{u}'$ 的结果为零，即 $\overline{\boldsymbol{u}'} = \mathbb{E}[\boldsymbol{u}'] = 0$。而空间滤波则不同，它是一个确定性的卷积操作，对一个已滤波的场再次滤波通常不改变该场（对于某些特定滤波器），但对未解析场进行滤波通常不为零（$\overline{\boldsymbol{u}'} \neq 0$）。在实际应用中，如果流动在时间或空间上满足统计平稳或均匀的条件，那么根据**[各态历经假说](@entry_id:147104)（ergodicity assumption）**，系综平均可以用时间平均或[空间平均](@entry_id:203499)来代替，这使得[雷诺平均](@entry_id:754341)的框架在某些情况下可以与滤波方法联系起来 。

[参数化](@entry_id:265163)问题的核心，即**闭合问题（closure problem）**，源于将滤波操作应用于[非线性](@entry_id:637147)的流体动力学方程。让我们以[不可压缩流体](@entry_id:181066)的动量方程为例，其[非线性平流](@entry_id:1128854)项可以写作[散度形式](@entry_id:748608) $\partial_j (u_i u_j)$。对该项进行滤波，我们得到 $\overline{\partial_j (u_i u_j)}$。假设滤波操作可以与[微分](@entry_id:158422)互换，则有 $\partial_j \overline{(u_i u_j)}$。问题在于，已滤波的变量乘积 $\overline{u_i u_j}$ 不等于已滤波变量的乘积 $\overline{u_i} \overline{u_j}$。它们之间的差异定义了**次网格尺度[应力张量](@entry_id:148973)（sub-grid scale stress tensor）** $\tau_{ij}$：

$$
\tau_{ij} \equiv \overline{u_i u_j} - \overline{u_i} \overline{u_j}
$$

将这个定义代入滤波后的动量方程，可以得到已解析速度场 $\overline{\boldsymbol{u}}$ 的[演化方程](@entry_id:268137)：

$$
\frac{\partial \overline{u_i}}{\partial t} + \overline{u_j} \frac{\partial \overline{u_i}}{\partial x_j} = \text{RHS} - \frac{\partial \tau_{ij}}{\partial x_j}
$$

其中 RHS 代表滤波后的压力梯度、科里奥利力等项。这个方程明确地显示，已解析流场 $\overline{\boldsymbol{u}}$ 的演化不仅取决于已解析量自身，还取决于一个我们未知的、源于[次网格尺度](@entry_id:1132591)运动的应力项 $\tau_{ij}$ 的散度。由于 $\tau_{ij}$ 的定义依赖于我们无法得到的完整速度场 $\boldsymbol{u}$，因此方程组是不封闭的。闭合问题的本质，就是要寻找一个模型或**[参数化](@entry_id:265163)方案**，将未知的 $\tau_{ij}$ 表示为已知的已解析场 $\overline{\boldsymbol{u}}$ 及其梯度的函数 。

### 局部降梯度闭合：K-理论及其局限性

最简单、最经典的[参数化](@entry_id:265163)方法建立在**尺度分离（scale separation）**的假设之上。该假设认为，未解析的次网格尺度运动与已解析的网格尺度运动在时空尺度上存在显著的差距。具体而言，未解析涡旋的特征长度 $L_{\mathrm{SGS}}$ 远小于已解析流动的特征长度 $L_{\mathrm{res}}$（$L_{\mathrm{SGS}} \ll L_{\mathrm{res}}$），并且其[特征时间尺度](@entry_id:276738) $\tau_{\mathrm{SGS}}$ 也远小于已解析流动的时间尺度 $\tau_{\mathrm{res}}$（$\tau_{\mathrm{SGS}} \ll \tau_{\mathrm{res}}$）。这意味着，快速、小的次网格涡旋能够迅速适应缓慢变化的大尺度环境，并与其达到一种[准平衡](@entry_id:1130431)状态 。

这一假设极大地简化了闭合问题。它意味着次网格应力 $\tau_{ij}$ 在某一点 $(\boldsymbol{x}, t)$ 的值，可以仅仅通过该点局部的已解析场量来确定，而无需考虑流动的历史（时间局域性）或远处的流动状态（空间局域性）。这种思想催生了**降梯度输运（down-gradient transport）**模型，也称为**K-理论（K-theory）**。

K-理论借鉴了分子扩散的**斐克定律（Fick's law）**，假设[湍流](@entry_id:151300)涡旋的作用类似于分子碰撞，总是将物质或动量从高浓度区域输运到低浓度区域。例如，对于一个被动示踪剂 $\phi$，其垂直方向的次网格[湍流标量通量](@entry_id:1133523) $F_\phi = \overline{w'\phi'}$ 可以被[参数化](@entry_id:265163)为与平均标量梯度的乘积：

$$
F_\phi = -K_\phi \frac{\partial \overline{\phi}}{\partial z}
$$

这里的 $K_\phi > 0$ 被称为**涡动扩散系数（eddy diffusivity）**，负号表示通量总是指向平均梯度下降的方向。类似地，次网格[动量通量](@entry_id:199796)（即[SGS应力](@entry_id:1131521)）也可以与已解析流动的[应变率张量](@entry_id:266108) $S_{ij} = \frac{1}{2}(\partial_j \overline{u_i} + \partial_i \overline{u_j})$ 联系起来，形成**涡动黏性（eddy viscosity）**模型。一个著名的例子是**[Smagorinsky模型](@entry_id:276289)**，它将涡动黏性 $\nu_t$ 与网格尺度 $\Delta$ 和已解析[应变率](@entry_id:154778)的大小 $|S| = \sqrt{2 S_{mn} S_{mn}}$ 联系起来 ：

$$
\tau_{ij}^{d} = -2\nu_t S_{ij}, \quad \text{其中} \quad \nu_t = (C_s \Delta)^2 |S|
$$

这里 $\tau_{ij}^{d}$ 是[SGS应力张量](@entry_id:1131522)的偏量部分，$C_s$ 是一个无量纲的Smagorinsky系数。例如，对于一个给定的已解析[剪切流](@entry_id:266817)场 $\overline{u}(y) = A \sin(ky), \overline{v}=0$，我们可以通过计算该流场的应变率张量 $S_{ij}$，进而得到涡动黏性 $\nu_t$，最终计算出次网格应力分量，如 $\tau_{12} = -2 \nu_t S_{12}$ 。

然而，K-理论的有效性严格依赖于其基本假设。它只在[湍流](@entry_id:151300)处于**局部平衡**（即[湍流](@entry_id:151300)能的产生与耗散在局部近似相等）、输运确实是**局部的**、并且是**降梯度的**情况下才适用。在许多现实的海洋和大气场景中，这些假设并不成立 。

### 超越K-理论：各向异性与非局域闭合

在真实的地球流体中，旋转和层结的存在打破了空间的三维各向同性，使得简单的标量[涡动扩散系数](@entry_id:196515)和黏性系数模型变得不再适用。

#### 各向异性混合

地球的自转和稳定的密度层结是[海洋环流](@entry_id:195237)最显著的特征。**旋转**通过科里奥利效应，倾向于使流动准二维化（Taylor-Proudman效应），从而抑制垂直方向的动量交换。**稳定层结**则意味着流体在垂直方向上移动需要克服[浮力](@entry_id:154088)做功，因此相比于在水平方向（或更准确地说，是沿着等密度面）的运动，垂直运动受到极大的抑制 。

这两个效应共同导致了[湍流混合](@entry_id:202591)的强烈**各向异性（anisotropy）**。在等密度面上（**等密度混合**）或中性面上（**中性混合**）的混合要比穿过这些面（**跨[等密度面混合](@entry_id:1126771)**或**穿中性面混合**）的混合强得多，通常要强上好几个数量级。因此，一个物理上更真实的[参数化](@entry_id:265163)方案必须使用一个**张量**形式的涡动扩散（黏性）系数，以区分不同方向上的混合速率。一个简单的形式是在大地坐标系中使用对角张量，其水平分量远大于垂直分量（例如，$K_h \gg K_v$）。一个更精确的方法是定义一个与局部中性面方向对齐的扩散张量，它具有很强的沿中性面分量和很弱的穿中性面分量。当这一张量被投影到模型使用的大地坐标系（z坐标系）中时，就会自然地产生非对角项，这对于正确模拟斜压区的中尺度涡旋输运至关重要 。

#### 非局域闭合与逆梯度输运

在某些重要的物理情境下，例如由地表加热驱动的海洋或大气[混合层](@entry_id:926526)，[湍流](@entry_id:151300)并非由许多无关的小涡旋组成，而是由贯穿整个边界层深度的、有组织的大尺度相干结构（如上升的[热羽流](@entry_id:156277)）主导。这些大涡旋可以将物质从边界层的底部直接输运到顶部，其运动尺度与平均梯度的变化尺度相当，甚至更大。在这种情况下，[尺度分离假设](@entry_id:1131494)完全失效，通量不再仅仅由局部梯度决定。

为了描述这种现象，需要发展**非局域闭合（nonlocal closure）**方案。一个非局域模型承认，在点 $\boldsymbol{x}$ 处的次网格通量 $\boldsymbol{\tau}_C$ 不仅依赖于 $\boldsymbol{x}$ 处的平均梯度，还依赖于 $\boldsymbol{x}$ 周围一个有限区域内所有点 $\boldsymbol{x'}$ 的梯度信息。数学上，这通常通过一个积分核函数 $\mathbf{K}(\boldsymbol{x}, \boldsymbol{x'})$ 来表示 ：

$$
\boldsymbol{\tau}_C(\boldsymbol{x}) = -\int_{\Omega} \mathbf{K}(\boldsymbol{x},\boldsymbol{x'}) \cdot \nabla \overline{C}(\boldsymbol{x'})\,\mathrm{d}\mathbf{x'}
$$

更进一步，这些有组织的大涡旋甚至可以导致**逆梯度输运（counter-gradient transport）**。例如，一个从表面获得[浮力](@entry_id:154088)的[热羽流](@entry_id:156277)，凭借其惯性可以冲入上方平均浓度梯度为正（$\partial_z \overline{\phi} > 0$）的区域，但仍然实现向上的通量（$F_\phi > 0$）。这种现象是任何形式的降梯度模型（$F_\phi \propto -\partial_z \overline{\phi}$）都无法描述的。

为了模拟逆梯度输运，通常在K-理论的基础上增加一个独立的非局域项 $\Gamma_\phi$ ：

$$
F_\phi = -K_\phi \frac{\partial \overline{\phi}}{\partial z} + \Gamma_\phi
$$

这个非局域项 $\Gamma_\phi$ 不依赖于局部梯度，而是由驱动大尺度[湍流](@entry_id:151300)的物理过程（如表面[浮力通量](@entry_id:261821)）来[参数化](@entry_id:265163)。在大气或[海洋对流](@entry_id:1129051)[混合层](@entry_id:926526)中，依据[混合层](@entry_id:926526)相似性理论，$\Gamma_\phi$ 可以被表示为对流速度尺度 $w_*$、对流标量尺度 $\phi_*$ 和[混合层](@entry_id:926526)深度 $z_i$ 的函数，例如具有 $\Gamma_\phi \propto w_* \phi_* f(z/z_i)$ 的形式，其中 $f$ 是一个在边界层上下边界为零的无量纲形状函数 。

### [参数化](@entry_id:265163)的基本约束

无论[参数化](@entry_id:265163)方案的具体形式如何，它都必须遵守一些源于物理和[数值稳定性](@entry_id:175146)的基本约束。一个不满足这些约束的方案，即使形式复杂，也可能产生非物理的结果。

#### 能量约束

[次网格尺度过程](@entry_id:1132602)的最终物理效应是将能量从可解析的大尺度级联到更小的尺度，并最终通过分子黏性耗散掉。因此，[参数化](@entry_id:265163)方案在整体上必须是**耗散的**，即它只能从已解析的能量中移除能量，而不能凭空创造能量。这被称为**[能量一致性](@entry_id:1124457)（energetic consistency）**。

通过推导已解析动能（KE）和[有效势能](@entry_id:1124192)（APE）的收支方程，我们可以得到次网格项对总能量变化率的贡献。对于一个孤立系统，这个贡献必须是负定或半负定的（$\le 0$）。例如，对于一个涡动黏性模型，其[应力张量](@entry_id:148973)的偏量部分被建模为 $\boldsymbol{\tau}^d = -2\nu_t \boldsymbol{S}$ (其中 $\nu_t \ge 0$)，其对动能的贡献（$\int_V \boldsymbol{\tau}^d:\boldsymbol{S} dV$）为 $-\int_V 2\nu_t (\boldsymbol{S}:\boldsymbol{S}) \, \mathrm{d}V \le 0$。同样，一个降梯度的标量[扩散模型](@entry_id:142185) $\boldsymbol{J}_{b,\mathrm{sgs}} = -K_b \nabla b$ (其中 $K_b \ge 0$)，其对有效势能的贡献也为负。这些简单的降梯度模型天然地满足能量耗散的要求 。

#### 动力学约束：位涡守恒

在旋转层结流体中，一个比能量更强的动力学约束是**厄特尔位[势涡](@entry_id:1129997)度（Ertel Potential Vorticity, PV）**的守恒。在理想（无摩擦、绝热）的条件下，PV是物质守恒的。这意味着[参数化](@entry_id:265163)方案，特别是那些旨在模拟绝热、无黏性过程（如中尺度涡旋搅拌）的方案，不应引入虚假的PV源或汇。

通过PV的收支方程可以发现，次网格[浮力](@entry_id:154088)源项 $S_b$ 和动量[强迫项](@entry_id:165986)的旋度 $\nabla \times \mathbf{F}_m$ 是PV的源汇项。因此，为了避免虚假的PV源，[参数化](@entry_id:265163)方案必须被精心设计。
*   用于模拟涡旋搅拌的**Gent-McWilliams (GM)**方案，通过引入一个满足特定约束（无辐散且沿等密度面）的“[涡致速度](@entry_id:1124135)” $\boldsymbol{u}^*$，确保其对[浮力](@entry_id:154088)的贡献为零（$\boldsymbol{u}^* \cdot \nabla b = 0$），从而在绝热意义上不产生PV源 。
*   **Redi**等密度扩散方案，通过将扩散张量设计为只沿着等密度面方向作用（数学上表示为 $\mathbf{K}\nabla b = \mathbf{0}$），同样保证了对[浮力](@entry_id:154088)本身的混合效应为零，因而是绝热的，不产生PV源 。
更深刻的是，一个物理上自洽的绝热、无黏性[参数化](@entry_id:265163)方案（如[GM方案](@entry_id:1125691)），其对PV收支的净贡献应该可以写成一个PV通量的[散度形式](@entry_id:748608)。这意味着该方案仅仅是在空间上**重新分布**PV，而不在内部产生或销毁它 。

#### 数值约束：正定性与[单调性](@entry_id:143760)

海洋中的许多示踪剂，如盐度或生物化学物质，其浓度在物理上必须是**正定（positive）**的。此外，物理混合过程总是趋向于平滑极值，而不会凭空创造出比周围环境更高或更低的值。因此，一个理想的数值方案（包括其中的[参数化](@entry_id:265163)部分）应保持**单调性（monotonicity）**，即不产生新的[局部极值](@entry_id:144991) 。

这些特性对[参数化](@entry_id:265163)方案提出了要求。因为次网格过程本质上是输运和混合，它们物理上不会创造新的极值。所以，[参数化](@entry_id:265163)方案的设计必须确保，当与离散化的平流方案结合时，不会导致非物理的过冲（overshoots）或下冲（undershoots）。这通常通过在[参数化](@entry_id:265163)方案中使用**通量限制器（flux limiters）**等技术来实现，以保证离散格式满足正定性和单调性约束 。

#### 区分物理与数值混合

最后，一个至关重要的实践问题是区分[参数化](@entry_id:265163)所代表的**物理混合**与离散化平流方案本身带来的**数值混合**。任何非完美的平流方案，其[截断误差](@entry_id:140949)中都包含着类似扩散的项。例如，[一阶迎风格式](@entry_id:749417)的[截断误差](@entry_id:140949)中就包含一个正比于网格间距 $\Delta x$ 的数值扩散项 。

在海洋模型中，这个问题尤为尖锐。当平流项作用于一个倾斜的等密度面时，即使流动是完全沿着等密度面的，在水平-垂直网格上进行离散化也会不可避免地产生一个跨越网格的输运分量，其[截断误差](@entry_id:140949)将表现为虚假的**数值跨[等密度面混合](@entry_id:1126771)（numerical diapycnal mixing）**。对于一阶格式，这种数值混合的等效扩散系数正比于网格间距 $\Delta x$ 和等密度面坡度的平方。在许多情况下，这种数值混合可能远大于真实的物理跨[等密度面混合](@entry_id:1126771)，从而严重污染模型的模拟结果，导致错误的温盐水团性质和环流结构 。因此，选择高精度、低[数值扩散](@entry_id:136300)的平流方案，是有效实施物理参数化方案的前提。

总之，[次网格尺度过程](@entry_id:1132602)的[参数化](@entry_id:265163)是计算海洋学中的一个核心挑战，它深刻地交织了物理学、流[体力](@entry_id:174230)学和[数值分析](@entry_id:142637)。一个成功的[参数化](@entry_id:265163)方案不仅需要准确地捕捉关键的物理机制，如各向异性和[非局域输运](@entry_id:1128882)，还必须严格遵守能量、位涡和示踪剂性质等基本约束，并与[数值离散化](@entry_id:752782)的特性相协调。