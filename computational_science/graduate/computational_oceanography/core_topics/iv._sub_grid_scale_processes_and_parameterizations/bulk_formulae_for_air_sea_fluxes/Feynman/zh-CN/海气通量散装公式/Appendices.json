{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将直接应用整体空气动力学公式。通过计算一个典型中纬度情景下的感热通量 $H$ 和潜热通量 $E$，您将对它们的相对重要性获得切实的感受，并对海洋表面的主要能量传输机制建立起直观的认识。",
            "id": "4020233",
            "problem": "考虑一个数值天气预报模式中的中性层结海洋大气近地层，其中空气在海洋上流动，参考风速在标准高度测量。海面与大气之间的湍流感热和潜热交换将使用一阶湍流闭合和近地层相似性理论来表示。从湍流通量的雷诺平均定义和适用于近地层的适当闭合假设出发，推导向上感热通量和向上潜热通量的整体空气动力学表达式，该表达式应以空气密度、热力学常数、地表与上层空气之间标量的近地表差异、一个输送系数和参考风速来表示。然后，根据以下科学上 realistic 的情况计算感热通量和潜热通量，并评论它们的相对大小及其对地表能量收支和气候模拟中通量调整的物理意义。\n\n使用以下参数值，所有参数均参考海洋上方的标准近地表高度：\n- 空气密度 $\\,\\rho = 1.2\\,\\mathrm{kg\\,m^{-3}}$。\n- 空气定压比热 $\\,c_{p} = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 蒸发潜热 $\\,L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。\n- 参考风速 $\\,U = 6\\,\\mathrm{m\\,s^{-1}}$。\n- 海-气温差 $\\,T_{s} - T_{a} = 2\\,\\mathrm{K}$。\n- 海-气比湿差 $\\,q_{s} - q_{a} = 4 \\times 10^{-3}$。\n- 中性输送系数 $\\,C_{H} = C_{E} = 1.2 \\times 10^{-3}$。\n\n采用符号约定，从海面到大气的向上通量为正。在推导整体表达式后，使用给定参数数值计算感热通量 $\\,H\\,$ 和潜热通量 $\\,E\\,$。将两种通量均以 $\\mathrm{W\\,m^{-2}}$ 表示，并将最终数值结果四舍五入至四位有效数字。最后，简要评估哪种通量占主导地位，并解释其物理原因，包括简要说明输送系数或近地表标量差异的调整将如何影响气候模式中地表能量的分配。",
            "solution": "该问题要求从第一性原理出发，推导感热和潜热通量的整体空气动力学公式，然后进行数值计算并对结果进行物理解释。该问题具有科学依据，设定良好，并提供了所有必要的参数。\n\n**第1部分：整体空气动力学公式的推导**\n\n大气近地层中的热量和湿度的湍流通量是基于雷诺平均定义的。设 $w$ 为垂直速度，$T$ 为温度，$q$ 为比湿。每个变量都可以分解为一个平均分量（例如 $\\overline{w}$）和一个湍流脉动分量（例如 $w'$），使得 $w = \\overline{w} + w'$。根据定义，脉动分量的平均值为零，即 $\\overline{w'} = 0$。对于水平均匀的近地层，假定平均垂直速度 $\\overline{w}$ 为零。\n\n一个通用标量 $\\phi$ 的垂直湍流通量由垂直速度脉动与标量脉动的协方差给出，即 $\\overline{w' \\phi'}$。\n\n向上的感热通量 $H$ 是位温 $\\theta$ 的湍流通量乘以空气密度 $\\rho$ 和定压比热 $c_p$。在近地层中，位温 $\\theta$ 和绝对温度 $T$ 之间的差异很小，因此我们可以使用 $T$ 来近似通量。\n$$H = \\rho c_p \\overline{w' T'}$$\n向上的潜热通量 $E$ 是水汽的湍流质量通量 $\\overline{w' q'}$ 乘以空气密度 $\\rho$ 和蒸发潜热 $L_v$。\n$$E = \\rho L_v \\overline{w' q'}$$\n符号约定为向上通量（从海洋到大气）为正。当平均而言，上升的气块（$w' > 0$）比下沉的气块（$w' < 0$）更暖（$T' > 0$）和更湿（$q' > 0$），而下沉的气块更冷（$T' < 0$）和更干（$q' < 0$）时，就会出现这种情况，从而导致协方差 $\\overline{w' \\phi'}$ 为正。\n\n为了闭合这个系统（即用已知的平均量来表示未知的协方差），我们采用一阶闭合，也称为K理论。该理论假设湍流混合类似于分子扩散，即通量与平均量的梯度成正比。\n$$\\overline{w' T'} = -K_H \\frac{\\partial \\overline{T}}{\\partial z}$$\n$$\\overline{w' q'} = -K_E \\frac{\\partial \\overline{q}}{\\partial z}$$\n这里，$z$ 是垂直坐标，$K_H$ 是热量的涡动扩散系数，$K_E$ 是湿度的涡动扩散系数。负号表示通量沿着梯度的反方向（从高值到低值）。\n\n将这些闭合假设代入通量定义中，我们得到：\n$$H = -\\rho c_p K_H \\frac{\\partial \\overline{T}}{\\partial z}$$\n$$E = -\\rho L_v K_E \\frac{\\partial \\overline{q}}{\\partial z}$$\n整体空气动力学方法通过将梯度在大气近地层上进行积分来简化此过程，从地表本身（高度 $z=0$，用下标 $s$ 表示）到空气中的参考高度（高度 $z_a$，用下标 $a$ 表示）。梯度由有限差分近似：\n$$\\frac{\\partial \\overline{T}}{\\partial z} \\approx \\frac{\\overline{T}_a - T_s}{z_a - 0} = \\frac{T_a - T_s}{z_a}$$\n$$\\frac{\\partial \\overline{q}}{\\partial z} \\approx \\frac{\\overline{q}_a - q_s}{z_a - 0} = \\frac{q_a - q_s}{z_a}$$\n这里，$T_s$ 和 $q_s$ 是海面的温度和比湿，而 $T_a$ 和 $q_a$ 是参考高度处的值。\n\n将这些近似值代入通量方程：\n$$H \\approx -\\rho c_p K_H \\frac{T_a - T_s}{z_a} = \\rho c_p \\frac{K_H}{z_a} (T_s - T_a)$$\n$$E \\approx -\\rho L_v K_E \\frac{q_a - q_s}{z_a} = \\rho L_v \\frac{K_E}{z_a} (q_s - q_a)$$\n这些表达式证实了对于 $T_s > T_a$ 或 $q_s > q_a$ 的情况，通量为正（向上），这与约定一致。\n\n最后一步是将涡动扩散系数项与可直接测量的量联系起来。近地层相似性理论和经验证据表明，湍流输送的效率取决于参考高度处的平均风速 $U$。定义整体输送系数 $C_H$ 和 $C_E$ 来概括湍流混合的综合效应，使得：\n$$\\frac{K_H}{z_a} = C_H U$$\n$$\\frac{K_E}{z_a} = C_E U$$\n因此，整体空气动力学公式的最终形式定义为：\n$$H = \\rho c_p C_H U (T_s - T_a)$$\n$$E = \\rho L_v C_E U (q_s - q_a)$$\n这些表达式就是所要求的结果。它们将湍流通量与平均大气状态变量（$\\rho, U$）、热力学常数（$c_p, L_v$）、跨界面的平均差异（$T_s - T_a, q_s - q_a$）以及经验确定的输送系数（$C_H, C_E$）联系起来。问题指出这些是中性系数，意味着它们不依赖于大气稳定度，这是一个对给定的中性层结条件有效的简化。\n\n**第2部分：数值计算**\n\n给定以下参数值：\n- $\\rho = 1.2\\,\\mathrm{kg\\,m^{-3}}$\n- $c_{p} = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- $L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$\n- $U = 6\\,\\mathrm{m\\,s^{-1}}$\n- $T_{s} - T_{a} = 2\\,\\mathrm{K}$\n- $q_{s} - q_{a} = 4 \\times 10^{-3}$\n- $C_{H} = C_{E} = 1.2 \\times 10^{-3}$\n\n首先，我们计算感热通量 $H$：\n$$H = \\rho c_p C_H U (T_s - T_a)$$\n$$H = (1.2\\,\\mathrm{kg\\,m^{-3}}) \\times (1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) \\times (1.2 \\times 10^{-3}) \\times (6\\,\\mathrm{m\\,s^{-1}}) \\times (2\\,\\mathrm{K})$$\n$$H = 1.2 \\times 1004 \\times 1.2 \\times 10^{-3} \\times 6 \\times 2\\,\\mathrm{W\\,m^{-2}}$$\n$$H = 17.34912\\,\\mathrm{W\\,m^{-2}}$$\n四舍五入到四位有效数字，我们得到 $H = 17.35\\,\\mathrm{W\\,m^{-2}}$。\n\n接下来，我们计算潜热通量 $E$：\n$$E = \\rho L_v C_E U (q_s - q_a)$$\n$$E = (1.2\\,\\mathrm{kg\\,m^{-3}}) \\times (2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}) \\times (1.2 \\times 10^{-3}) \\times (6\\,\\mathrm{m\\,s^{-1}}) \\times (4 \\times 10^{-3})$$\n$$E = 1.2 \\times 2.5 \\times 10^6 \\times 1.2 \\times 10^{-3} \\times 6 \\times 4 \\times 10^{-3}\\,\\mathrm{W\\,m^{-2}}$$\n$$E = 86.4\\,\\mathrm{W\\,m^{-2}}$$\n为了用四位有效数字表示，我们写作 $E = 86.40\\,\\mathrm{W\\,m^{-2}}$。\n\n**第3部分：评估与物理解释**\n\n比较这两个通量，$H = 17.35\\,\\mathrm{W\\,m^{-2}}$ 和 $E = 86.40\\,\\mathrm{W\\,m^{-2}}$，很明显潜热通量远大于感热通量。它们的量级之比为 $E/H \\approx 86.40 / 17.35 \\approx 4.98$。这对于开阔海洋来说是一个典型结果。定义为 $B = H/E$ 的波文比约为 $0.2$，证实了潜热通量的主导地位。\n\n这种主导地位的物理原因有两个方面：\n1.  **高的蒸发潜热（$L_v$）：** $L_v = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$ 的值非常大。这意味着蒸发少量水需要巨大的能量。因此，即使从海面蒸发少量水，也会以潜热的形式将大量能量输送到大气中。\n2.  **充足的水源供应：** 海洋为蒸发提供了几乎无限的水源。因此，潜热通量主要受限于可用能量和上层空气吸收水分的能力，而这又由湿度梯度（$q_s - q_a$）和风速（$U$）决定。\n\n相比之下，感热通量受限于相对较小的空气比热（$c_p$）和通常较小的温度梯度。海洋的高热惯性意味着其表面温度（$T_s$）变化缓慢，从而调节了海-气温差（$T_s - T_a$）。\n\n关于气候模式中的通量调整，整体公式表明计算出的通量与输送系数（$C_H, C_E$）和海-气差异（$\\Delta T, \\Delta q$）成正比。在海-气耦合模式中，预测的海面温度或近地表大气属性的微小系统性偏差可能导致地表通量出现巨大且持续的误差，从而导致模式的气候在长期积分中“漂移”。例如，一个具有大气冷偏差的模式会产生过大的 $T_s - T_a$，导致海洋出现虚假的热量损失。为了抵消这种漂移，早期的模式通常采用人为的“通量调整”。由于潜热通量是海洋上空湍流能量交换的主要组成部分，地表能量收支对湿度场的偏差和 $C_E$ 的参数化方案尤其敏感。对 $C_H$ 或 $C_E$ 或对平均差异 $\\Delta T$ 和 $\\Delta q$ 的调整，会直接改变地表能量在感热和潜热形式之间的分配。现代模式旨在通过改进耦合过程的底层物理参数化方案来减少和消除这些临时的调整。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n17.35 & 86.40\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在第一个练习的基础上，本实践将深入探讨海气通量对大气和海洋条件变化的敏感性。通过应用偏导数，您将定量地确定哪些变量——如风速或温度梯度——对热量和水分交换具有最显著的影响，这项技能对于理解和诊断数值模型至关重要。",
            "id": "3786625",
            "problem": "考虑中纬度开阔大洋场景，大气层结近于中性，且条件稳定、均匀。从海气界面的湍标量通量的梯度输运假说和水汽含量的热力学定义出发。使用以下科学标准作为基础：\n- 在海洋表面，被动标量 $\\phi$ 的湍标量通量与空气密度、一个输运效率、一个近地表速度尺度以及海气标量差成正比，这与 Monin–Obukhov 相似性理论 (MOST) 一致。\n- 潜热通量 $Q_{L}$ 等于蒸发潜热乘以水汽的质量通量。\n- 感热通量 $Q_{S}$ 等于定压比热乘以湍热通量。\n- 比湿 $q$ 通过湿热力学定义 $q = \\frac{0.622\\,e}{p - 0.378\\,e}$ 与水汽压 $e$ 和总气压 $p$ 相关联，液态水在温度 $T$（单位：摄氏度）下的饱和水汽压可以从克劳修斯–克拉佩龙关系的一个经过充分检验的经验近似公式中获得。\n\n假设在 $10\\,\\mathrm{m}$ 高度和海气界面有以下典型的海洋大气条件：\n- $10\\,\\mathrm{m}$ 处的风速：$U_{10} = 8\\,\\mathrm{m\\,s^{-1}}$。\n- 海表温度 (SST)：$T_{s} = 301\\,\\mathrm{K}$。\n- 气温：$T_{a} = 298\\,\\mathrm{K}$。\n- 海平面气压：$p = 101325\\,\\mathrm{Pa}$。\n- 近地表相对湿度：$\\mathrm{RH} = 0.80$。\n- 空气密度：$\\rho = 1.22\\,\\mathrm{kg\\,m^{-3}}$。\n- 蒸发潜热：$L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。\n- 定压比热：$c_{p} = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 中性稳定度下的交换系数：水汽为 $C_{E} = 1.2 \\times 10^{-3}$，热量为 $C_{H} = 1.1 \\times 10^{-3}$。\n- 饱和水汽压近似公式（温度单位：摄氏度）：$e_{s}(T_{C}) = 6.112 \\exp\\!\\left(\\frac{17.67\\,T_{C}}{T_{C} + 243.5}\\right)\\,\\mathrm{hPa}$。\n\n任务：\n1. 从上述基础出发，推导用输入变量 $U_{10}$、$q_{s}$、$q_{a}$、$T_{s}$ 和 $T_{a}$ 表示的 $Q_{L}$ 和 $Q_{S}$ 的表达式，其中 $q_{s}$ 是海表面的饱和比湿，$q_{a}$ 是由给定的 $\\mathrm{RH}$ 和 $T_{a}$ 决定的环境空气比湿。\n2. 使用给定的热力学关系和常数，在所述条件下计算 $q_{s}$ 和 $q_{a}$ 的值。\n3. 在所述条件下，计算偏导数 $\\frac{\\partial Q_{L}}{\\partial U_{10}}$、$\\frac{\\partial Q_{L}}{\\partial q_{s}}$、$\\frac{\\partial Q_{L}}{\\partial q_{a}}$ 以及 $\\frac{\\partial Q_{S}}{\\partial U_{10}}$、$\\frac{\\partial Q_{S}}{\\partial T_{s}}$、$\\frac{\\partial Q_{S}}{\\partial T_{a}}$。\n4. 为每个输入变量定义一个典型扰动：$\\delta U_{10} = 1\\,\\mathrm{m\\,s^{-1}}$、$\\delta q_{s} = 0.001\\,\\mathrm{kg\\,kg^{-1}}$、$\\delta q_{a} = 0.001\\,\\mathrm{kg\\,kg^{-1}}$、$\\delta T_{s} = 1\\,\\mathrm{K}$ 和 $\\delta T_{a} = 1\\,\\mathrm{K}$。对于每种通量，根据乘积 $|\\frac{\\partial Q}{\\partial x}\\,\\delta x|$ 的大小对主要贡献者进行排序。\n5. 设优势指数 $D$ 为各自变量集合中最大的 $|\\frac{\\partial Q_{L}}{\\partial x}\\,\\delta x|$ 与最大的 $|\\frac{\\partial Q_{S}}{\\partial x}\\,\\delta x|$ 的比值。在所述条件下计算 $D$。\n\n将 $D$ 的最终值四舍五入到四位有效数字。将 $D$ 表示为一个无单位的纯数。",
            "solution": "该问题已经过验证，被认为是有效的。它在科学上基于海气相互作用物理学和热力学的既定原理，在数学上是适定的、客观的、自洽的，并且没有矛盾或歧义。所有必要信息都已提供，以推导出唯一解。\n\n解题过程遵循问题陈述中列出的五个任务。\n\n任务1：通量表达式的推导\n梯度输运假说，在近中性条件下的地表层（即块体空气动力学方法）中，将标量 $\\phi$ 的湍流通量模型化为与该标量的平均垂直梯度成正比。对于海气界面的通量，其表达式为：\n$$ F_{\\phi} = \\rho C_{\\phi} U_{10} (\\phi_s - \\phi_a) $$\n此处，$F_{\\phi}$ 是 $\\phi$ 的湍流通量，$\\rho$ 是空气密度，$C_{\\phi}$ 是标量 $\\phi$ 的无量纲块体输运系数，$U_{10}$ 是参考高度 $10\\,\\mathrm{m}$ 处的风速，$\\phi_s$ 是海表面的标量值，而 $\\phi_a$ 是参考高度处环境空气中的标量值。\n\n对于潜热通量 $Q_L$，相关标量是比湿 $q$。水汽的质量通量，记为 $E$（蒸发），由下式给出：\n$$ E = \\rho C_E U_{10} (q_s - q_a) $$\n其中 $C_E$ 是水汽的输运系数，$q_s$ 是海表面的比湿（假定在海表温度下达到饱和），$q_a$ 是空气的比湿。问题指出，潜热通量 $Q_L$ 是蒸发潜热 $L_v$ 和质量通量 $E$ 的乘积：\n$$ Q_L = L_v E = L_v \\rho C_E U_{10} (q_s - q_a) $$\n\n对于感热通量 $Q_S$，相关标量是位温 $\\theta$。对于近地表计算，使用绝对温度 $T$ 代替 $\\theta$ 是一个可接受的近似。标准块体公式是：\n$$ Q_S = \\rho c_p C_H U_{10} (T_s - T_a) $$\n其中 $C_H$ 是热量的输运系数，$T_s$ 是海表温度，$T_a$ 是气温。我们将使用此标准公式。\n\n任务2：$q_s$ 和 $q_a$ 的计算\n首先，将给定的开尔文温度转换为摄氏度，以便在饱和水汽压公式中使用：\n海表温度为 $T_s = 301\\,\\mathrm{K}$，所以 $T_{s,C} = 301 - 273.15 = 27.85\\,^\\circ\\mathrm{C}$。\n气温为 $T_a = 298\\,\\mathrm{K}$，所以 $T_{a,C} = 298 - 273.15 = 24.85\\,^\\circ\\mathrm{C}$。\n\n接下来，使用提供的公式计算海表面的饱和水汽压 $e_s(T_s)$，其中 $p$ 的单位是帕斯卡，$e_s$ 的单位是百帕：\n$$ e_s(T_{s,C}) = 6.112 \\exp\\left(\\frac{17.67 \\times 27.85}{27.85 + 243.5}\\right) = 6.112 \\exp\\left(\\frac{492.1095}{271.35}\\right) \\approx 37.4790\\,\\mathrm{hPa} $$\n转换为帕斯卡（$1\\,\\mathrm{hPa} = 100\\,\\mathrm{Pa}$），我们得到 $e_s(T_s) \\approx 3747.90\\,\\mathrm{Pa}$。\n饱和比湿 $q_s$ 是在海表面计算的，假定该处的空气在温度 $T_s$ 下被水汽饱和：\n$$ q_s = \\frac{0.622\\,e_s(T_s)}{p - 0.378\\,e_s(T_s)} = \\frac{0.622 \\times 3747.90}{101325 - 0.378 \\times 3747.90} \\approx \\frac{2331.19}{101325 - 1416.71} \\approx \\frac{2331.19}{99908.29} \\approx 0.023333\\,\\mathrm{kg\\,kg^{-1}} $$\n\n接下来，计算环境空气比湿 $q_a$。首先，求出气温下的饱和水汽压 $e_s(T_a)$：\n$$ e_s(T_{a,C}) = 6.112 \\exp\\left(\\frac{17.67 \\times 24.85}{24.85 + 243.5}\\right) = 6.112 \\exp\\left(\\frac{439.1}{268.35}\\right) \\approx 31.3915\\,\\mathrm{hPa} $$\n这对应于 $e_s(T_a) \\approx 3139.15\\,\\mathrm{Pa}$。\n空气的实际水汽压 $e_a$ 由相对湿度 $\\mathrm{RH} = 0.80$ 决定：\n$$ e_a = \\mathrm{RH} \\times e_s(T_a) = 0.80 \\times 3139.15 \\approx 2511.32\\,\\mathrm{Pa} $$\n现在，计算空气比湿 $q_a$：\n$$ q_a = \\frac{0.622\\,e_a}{p - 0.378\\,e_a} = \\frac{0.622 \\times 2511.32}{101325 - 0.378 \\times 2511.32} \\approx \\frac{1562.04}{101325 - 949.28} \\approx \\frac{1562.04}{100375.72} \\approx 0.015562\\,\\mathrm{kg\\,kg^{-1}} $$\n\n任务3：偏导数的计算\n通量的表达式为：\n$Q_L = L_v \\rho C_E U_{10} (q_s - q_a)$\n$Q_S = c_p \\rho C_H U_{10} (T_s - T_a)$\n\n$Q_L$ 的偏导数为：\n$$ \\frac{\\partial Q_L}{\\partial U_{10}} = L_v \\rho C_E (q_s - q_a) $$\n$$ \\frac{\\partial Q_L}{\\partial q_s} = L_v \\rho C_E U_{10} $$\n$$ \\frac{\\partial Q_L}{\\partial q_a} = -L_v \\rho C_E U_{10} $$\n代入给定值和计算值：\n$L_v = 2.5 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$，$\\rho = 1.22\\,\\mathrm{kg\\,m^{-3}}$，$C_E = 1.2 \\times 10^{-3}$，$U_{10} = 8\\,\\mathrm{m\\,s^{-1}}$。\n$q_s - q_a \\approx 0.023333 - 0.015562 = 0.007771\\,\\mathrm{kg\\,kg^{-1}}$。\n$$ \\frac{\\partial Q_L}{\\partial U_{10}} \\approx (2.5 \\times 10^6)(1.22)(1.2 \\times 10^{-3})(0.007771) = 3660 \\times 0.007771 \\approx 28.45\\,\\mathrm{W\\,s\\,m^{-3}} $$\n$$ \\frac{\\partial Q_L}{\\partial q_s} = 3660 \\times 8 = 29280\\,\\mathrm{W\\,m^{-2}} $$\n$$ \\frac{\\partial Q_L}{\\partial q_a} = -29280\\,\\mathrm{W\\,m^{-2}} $$\n\n$Q_S$ 的偏导数为：\n$$ \\frac{\\partial Q_S}{\\partial U_{10}} = c_p \\rho C_H (T_s - T_a) $$\n$$ \\frac{\\partial Q_S}{\\partial T_s} = c_p \\rho C_H U_{10} $$\n$$ \\frac{\\partial Q_S}{\\partial T_a} = -c_p \\rho C_H U_{10} $$\n代入给定值：\n$c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$\\rho = 1.22\\,\\mathrm{kg\\,m^{-3}}$，$C_H = 1.1 \\times 10^{-3}$，$U_{10} = 8\\,\\mathrm{m\\,s^{-1}}$。\n$T_s - T_a = 301 - 298 = 3\\,\\mathrm{K}$。\n$$ \\frac{\\partial Q_S}{\\partial U_{10}} \\approx (1004)(1.22)(1.1 \\times 10^{-3})(3) \\approx 1.3474 \\times 3 \\approx 4.042\\,\\mathrm{W\\,s\\,m^{-3}} $$\n$$ \\frac{\\partial Q_S}{\\partial T_s} = (1004)(1.22)(1.1 \\times 10^{-3})(8) \\approx 1.3474 \\times 8 \\approx 10.779\\,\\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n$$ \\frac{\\partial Q_S}{\\partial T_a} = -10.779\\,\\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n\n任务4：主要贡献者的排序\n我们针对给定的扰动，通过 $\\frac{\\partial Q}{\\partial x}\\delta x$ 来近似评估通量变化 $\\delta Q$。\n对于潜热通量 ($Q_L$)：\n$$ |\\frac{\\partial Q_L}{\\partial U_{10}}\\delta U_{10}| = |28.45\\,\\mathrm{W\\,s\\,m^{-3}}| \\times |1\\,\\mathrm{m\\,s^{-1}}| \\approx 28.45\\,\\mathrm{W\\,m^{-2}} $$\n$$ |\\frac{\\partial Q_L}{\\partial q_s}\\delta q_s| = |29280\\,\\mathrm{W\\,m^{-2}}| \\times |0.001| = 29.28\\,\\mathrm{W\\,m^{-2}} $$\n$$ |\\frac{\\partial Q_L}{\\partial q_a}\\delta q_a| = |-29280\\,\\mathrm{W\\,m^{-2}}| \\times |0.001| = 29.28\\,\\mathrm{W\\,m^{-2}} $$\n基于数值大小对 $Q_L$ 的贡献者进行排序：\n1. 海气湿度差（由 $q_s$ 和 $q_a$ 驱动）：$29.28\\,\\mathrm{W\\,m^{-2}}$。\n2. 风速 ($U_{10}$)：$28.45\\,\\mathrm{W\\,m^{-2}}$。\n\n对于感热通量 ($Q_S$)：\n$$ |\\frac{\\partial Q_S}{\\partial U_{10}}\\delta U_{10}| = |4.042\\,\\mathrm{W\\,s\\,m^{-3}}| \\times |1\\,\\mathrm{m\\,s^{-1}}| \\approx 4.042\\,\\mathrm{W\\,m^{-2}} $$\n$$ |\\frac{\\partial Q_S}{\\partial T_s}\\delta T_s| = |10.779\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}| \\times |1\\,\\mathrm{K}| \\approx 10.779\\,\\mathrm{W\\,m^{-2}} $$\n$$ |\\frac{\\partial Q_S}{\\partial T_a}\\delta T_a| = |-10.779\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}| \\times |1\\,\\mathrm{K}| \\approx 10.779\\,\\mathrm{W\\,m^{-2}} $$\n基于数值大小对 $Q_S$ 的贡献者进行排序：\n1. 海气温度差（由 $T_s$ 和 $T_a$ 驱动）：$10.779\\,\\mathrm{W\\,m^{-2}}$。\n2. 风速 ($U_{10}$)：$4.042\\,\\mathrm{W\\,m^{-2}}$。\n\n任务5：优势指数 $D$ 的计算\n优势指数 $D$ 是 $Q_L$ 的最大灵敏度大小与 $Q_S$ 的最大灵敏度大小的比值。\n$$ D = \\frac{\\max(|\\frac{\\partial Q_{L}}{\\partial x}\\,\\delta x|)}{\\max(|\\frac{\\partial Q_{S}}{\\partial x}\\,\\delta x|)} $$\n根据任务4：\n最大的 $|\\frac{\\partial Q_{L}}{\\partial x}\\,\\delta x|$ 是 $29.28\\,\\mathrm{W\\,m^{-2}}$。\n最大的 $|\\frac{\\partial Q_{S}}{\\partial x}\\,\\delta x|$ 是 $10.779\\,\\mathrm{W\\,m^{-2}}$。\n$$ D = \\frac{29.28}{10.779} \\approx 2.71641... $$\n四舍五入到四位有效数字，优势指数 $D$ 为 $2.716$。这个无量纲数表明，对于给定的典型扰动，潜热通量的响应强度大约是感热通量响应强度的 $2.7$ 倍。",
            "answer": "$$\\boxed{2.716}$$"
        },
        {
            "introduction": "最后的这项实践将从应用整体公式转向构建其关键组成部分。您将实现一个迭代数值方案，来求解中性拖曳系数 $C_{D,N}$。该系数并非一个固定常数，而是通过查诺克关系 (Charnock relation) 依赖于摩擦速度 $u_*$ 本身。本练习为您求解现代海气相互作用参数化方案背后耦合的非线性方程组提供了基础训练。",
            "id": "3786683",
            "problem": "您的任务是使用基于 Monin–Obukhov 相似理论和 Charnock 关系的、有物理基础的迭代方法来计算中性 10 米拖曳系数。该场景假设在海洋上方存在一个中性分层的海洋大气边界层。\n\n基本原理：\n- 中性分层的对数风廓线指出，高度 $z$ 处的平均风速与摩擦速度 $u_*$ 和粗糙度长度 $z_{0m}$ 的关系如下：\n$$\nU(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_{0m}}\\right),\n$$\n其中 $\\kappa$ 是 von Kármán 常数。\n- Charnock 关系给出了动量粗糙度长度：\n$$\nz_{0m} = \\alpha \\frac{u_*^2}{g},\n$$\n其中 $g$ 是重力加速度，$\\alpha$ 是 Charnock 参数。\n- 高度 $z$ 处的中性拖曳系数由风应力和风速之间的关系定义。对于 $z = 10 \\,\\mathrm{m}$ 处的中性条件，中性 10 米拖曳系数 $C_{D,N}$ 定义为：\n$$\nC_{D,N} = \\frac{u_*^2}{U_{10}^2},\n$$\n其中 $U_{10}$ 是 $z = 10 \\,\\mathrm{m}$ 处的平均风速。\n\n任务：\n- 对于给定的配对 $(U_{10}, \\alpha)$，通过联立对数风廓线和 $z = 10 \\,\\mathrm{m}$ 处的 Charnock 关系得到的隐式方程，迭代求解摩擦速度 $u_*$：\n$$\nU_{10} = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10}{\\alpha u_*^2 / g}\\right),\n$$\n然后计算 $C_{D,N}$。\n- 在获得 $C_{D,N}$ 后，使用对数灵敏度分析其对 Charnock 参数 $\\alpha$ 的局部灵敏度：\n$$\nS_{\\alpha} = \\frac{\\partial \\ln C_{D,N}}{\\partial \\ln \\alpha},\n$$\n该灵敏度通过对 $\\alpha$ 施加一个指定的微小相对扰动，并使用对称有限差分进行数值近似。\n\n常数：\n- 使用 $\\kappa = 0.4$（无量纲）。\n- 使用 $g = 9.80665 \\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n- 所有计算都假设中性稳定度和对数风廓线的有效性。\n- 摩擦速度 $u_*$ 必须严格为正，并且数值方案必须确保收敛到具有物理意义的解。\n\n数值要求：\n- 基于隐式方程的单调性，为 $u_*$ 实现一个稳健的迭代求根方案，例如在区间 $u_* \\in (0, u_{\\max})$ 上使用二分法，其中 $u_{\\max} > 0$ 足够大以将根括入区间内。\n- 使用相对扰动因子 $r = 0.01$（即 $1\\%$）来计算 $S_{\\alpha}$ 的有限差分近似：\n$$\nS_{\\alpha} \\approx \\frac{\\ln C_{D,N}(\\alpha(1+r)) - \\ln C_{D,N}(\\alpha(1-r))}{\\ln(\\alpha(1+r)) - \\ln(\\alpha(1-r))}.\n$$\n\n单位和输出：\n- 输入风速 $U_{10}$ 的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 重力加速度 $g$ 的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n- Charnock 参数 $\\alpha$ 是无量纲的。\n- 拖曳系数 $C_{D,N}$ 是无量纲的。\n- 灵敏度 $S_{\\alpha}$ 是无量纲的。\n- 将每个输出值表示为四舍五入到六位小数的浮点数。\n\n测试套件：\n对以下六个测试用例评估程序，每个用例指定为 $(U_{10}, \\alpha)$：\n1. $(10.0, 0.011)$\n2. $(5.0, 0.018)$\n3. $(20.0, 0.011)$\n4. $(1.0, 0.011)$\n5. $(30.0, 0.020)$\n6. $(8.0, 0.005)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有六个测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，其中每个元素是包含该测试用例的 $[C_{D,N}, S_{\\alpha}]$ 的双项列表。\n- 例如：\n\"[[c1,s1],[c2,s2],[c3,s3],[c4,s4],[c5,s5],[c6,s6]]\"",
            "solution": "根据既定标准，对问题陈述进行了严格审查和验证。\n\n### 第 1 步：提取已知信息\n- **对数风廓线**：$U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_{0m}}\\right)$\n- **粗糙度长度的 Charnock 关系**：$z_{0m} = \\alpha \\frac{u_*^2}{g}$\n- **中性 10 米拖曳系数定义**：$C_{D,N} = \\frac{u_*^2}{U_{10}^2}$，其中 $U_{10} = U(z=10 \\,\\mathrm{m})$\n- **摩擦速度的隐式方程**：$U_{10} = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10g}{\\alpha u_*^2}\\right)$\n- **$C_{D,N}$ 对 $\\alpha$ 的对数灵敏度**：$S_{\\alpha} = \\frac{\\partial \\ln C_{D,N}}{\\partial \\ln \\alpha}$\n- **灵敏度的数值近似**：$S_{\\alpha} \\approx \\frac{\\ln C_{D,N}(\\alpha(1+r)) - \\ln C_{D,N}(\\alpha(1-r))}{\\ln(\\alpha(1+r)) - \\ln(\\alpha(1-r))}$\n- **常数**：von Kármán 常数 $\\kappa = 0.4$，重力加速度 $g = 9.80665 \\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n- **数值参数**：用于灵敏度计算的相对扰动因子 $r = 0.01$。\n- **约束条件**：计算假设为中性稳定度。摩擦速度 $u_*$ 必须严格为正。\n- **测试套件**：提供了六对 $(U_{10}, \\alpha)$：$(10.0, 0.011)$、$(5.0, 0.018)$、$(20.0, 0.011)$、$(1.0, 0.011)$、$(30.0, 0.020)$、$(8.0, 0.005)$。\n- **输出要求**：对于每个测试用例，输出一个双项列表 $[C_{D,N}, S_{\\alpha}]$，其值四舍五入到六位小数。最终输出是表示这些列表的列表的单行字符串。\n\n### 第 2 步：使用提取的已知信息进行验证\n对问题进行验证。\n- **科学依据**：该问题基于边界层气象学的基石原理，即 Monin–Obukhov 相似理论和关于海面空气动力学粗糙度的 Charnock 关系。所提供的方程是这些原理在中性分层海洋大气边界层中的标准表示。该问题在事实上和科学上都是合理的。\n- **适定性**：该问题需要求解一个关于摩擦速度 $u_*$ 的超越方程。令待求解的函数为 $f(u_*) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10g}{\\alpha u_*^2}\\right) - U_{10} = 0$。对此函数的分析表明，在给定的物理参数范围内，它有两个正根。较小的根对应于风浪生成中的物理现实解，而较大的根通常被认为是非物理的。通过将求根算法的搜索区间限制在适当的范围（例如 $u_* \\in (0, 3]$），可以唯一确定较小的、具有物理意义的根。因此，该问题是适定的。\n- **客观性**：问题陈述使用了精确、无歧义的数学和物理术语。它不含主观或基于观点的论断。\n- **完整性和一致性**：所有必需的常数、方程和数值参数都已提供。定义内部一致，并与标准文献保持一致。\n- **真实性**：提供的风速 $U_{10}$、Charnock 参数 $\\alpha$ 以及物理常数 $\\kappa$ 和 $g$ 的值是现实的，并能代表地球的海洋-大气系统。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。这是一个在计算海洋学中定义明确、有科学依据的问题。将开发一个解决方案。\n\n### 算法设计与原理\n\n该解决方案的结构是首先计算中性拖曳系数 $C_{D,N}$，然后利用此结果确定其对 Charnock 参数的灵敏度 $S_{\\alpha}$。\n\n**1. 中性拖曳系数 $C_{D,N}$ 的计算**\n\n问题的核心是通过求解给定的 10 米风速 $U_{10}$ 和 Charnock 参数 $\\alpha$ 的隐式方程来找到摩擦速度 $u_*$：\n$$\nU_{10} = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10g}{\\alpha u_*^2}\\right)\n$$\n该方程无法解析求解 $u_*$。因此，需要一种数值求根方法。我们定义一个函数 $f(u_*)$，并寻求其根：\n$$\nf(u_*) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{10g}{\\alpha u_*^2}\\right) - U_{10}\n$$\n问题指定使用像二分法这样的迭代方案。要应用此方法，我们必须确定一个将单个根括入的区间 $[a, b]$，即 $f(a)$ 和 $f(b)$ 符号相反。\n\n让我们分析 $f(u_*)$:\n- 当 $u_* \\to 0^+$ 时，项 $u_* \\ln(1/u_*^2) = -2u_* \\ln(u_*)$ 趋近于 $0$。因此，$f(u_*) \\to -U_{10}$。函数初始为负。\n- 函数增加到最大值然后减少。对于给定的风速，存在一个具有物理意义的解。可以建立一个合适的搜索区间，例如 $[10^{-6}, 3.0]$。下界是一个小的正数，以避免 $u_*=0$ 处的奇点，而上界是一个足够大的 $u_*$ 值，以确保对于所有测试用例，$f(3.0)$ 的符号与 $f(10^{-6})$ 相反，从而将物理根括入区间。\n\n二分法算法如下：\n1. 初始化区间 $[a, b]$ 和一个容差 $\\epsilon$。\n2. 计算中点 $c = (a+b)/2$。\n3. 如果 $f(c)$ 足够接近 $0$（即 $|f(c)| < \\epsilon$）或区间宽度 $(b-a)/2$ 小于 $\\epsilon$，则算法终止，c 是近似根。\n4. 否则，如果 $f(a)$ 和 $f(c)$ 符号相同，则根位于 $[c, b]$ 中，因此我们设置 $a=c$。\n5. 如果它们符号相反，则根位于 $[a, c]$ 中，因此我们设置 $b=c$。\n6. 从第 2 步重复。\n\n一旦获得 $u_*$ 的收敛值，中性 10 米拖曳系数 $C_{D,N}$ 就可以直接根据其定义计算得出：\n$$\nC_{D,N} = \\left(\\frac{u_*}{U_{10}}\\right)^2\n$$\n\n**2. 对数灵敏度 $S_{\\alpha}$ 的计算**\n\n对数灵敏度 $S_{\\alpha} = \\frac{\\partial \\ln C_{D,N}}{\\partial \\ln \\alpha}$ 量化了 $C_{D,N}$ 相对于 $\\alpha$ 相对变化的相对变化。它将使用对称有限差分格式进行近似。提供的公式是：\n$$\nS_{\\alpha} \\approx \\frac{\\ln C_{D,N}(\\alpha(1+r)) - \\ln C_{D,N}(\\alpha(1-r))}{\\ln(\\alpha(1+r)) - \\ln(\\alpha(1-r))}\n$$\n其中 $r = 0.01$ 是相对扰动。\n\n为了提高数值精度，可以简化分母：\n$$\n\\ln(\\alpha(1+r)) - \\ln(\\alpha(1-r)) = \\ln(\\alpha) + \\ln(1+r) - (\\ln(\\alpha) + \\ln(1-r)) = \\ln\\left(\\frac{1+r}{1-r}\\right)\n$$\n$S_{\\alpha}$ 的计算过程如下：\n1. 对于给定的配对 $(U_{10}, \\alpha)$，定义扰动后的 Charnock 参数：$\\alpha_{+} = \\alpha(1+r)$ 和 $\\alpha_{-} = \\alpha(1-r)$。\n2. 通过使用 $\\alpha_{+}$ 和 $U_{10}$ 求解 $u_*$ 来计算 $C_{D,N}(\\alpha_{+})$，然后计算拖曳系数。\n3. 通过使用 $\\alpha_{-}$ 和 $U_{10}$ 求解 $u_*$ 来计算 $C_{D,N}(\\alpha_{-})$，然后计算拖曳系数。\n4. 将这些值代入灵敏度公式：\n$$\nS_{\\alpha} \\approx \\frac{\\ln(C_{D,N}(\\alpha_{+})) - \\ln(C_{D,N}(\\alpha_{-}))}{\\ln\\left(\\frac{1+r}{1-r}\\right)}\n$$\n\n**3. 最终实现**\n\n整体算法遍历六个测试用例中的每一个。对于每个用例 $(U_{10}, \\alpha)$：\n1. 调用一个函数 `calculate_C_D_N(U10, alpha)` 来计算拖曳系数。该函数内部实现了二分法来找到 $u_*$。\n2. 计算未扰动 $\\alpha$ 的基础拖曳系数 $C_{D,N}$。\n3. 计算扰动后的拖曳系数 $C_{D,N}(\\alpha_{+})$ 和 $C_{D,N}(\\alpha_{-})$。\n4. 使用有限差分公式计算灵敏度 $S_{\\alpha}$。\n5. 将得到的配对 $[C_{D,N}, S_{\\alpha}]$ 四舍五入到六位小数并存储。\n6. 处理完所有测试用例后，将收集到的结果按规定格式化为单个字符串并打印。",
            "answer": "[[0.001328,-0.282920],[0.001095,-0.217351],[0.001650,-0.334053],[0.000729,-0.147318],[0.002027,-0.380290],[0.001174,-0.260840]]"
        }
    ]
}