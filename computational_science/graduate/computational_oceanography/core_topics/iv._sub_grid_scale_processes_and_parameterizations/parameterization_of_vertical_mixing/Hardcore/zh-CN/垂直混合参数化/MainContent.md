## 引言
在现代海洋和气候模拟中，准确描绘海洋的垂直结构与动力过程至关重要。海洋中的垂直混合，即动量、热量、盐分及其他物质在垂直方向上的输运，是决定水团特性、控制海-气相互作用、并最终影响全球环流和气候系统的关键物理过程。然而，驱动这些混合过程的[湍流](@entry_id:151300)涡旋尺度极小，远小于当代[海洋环流](@entry_id:195237)模型的网格分辨率，因此无法被直接解析。这一知识鸿沟催生了本章的核心主题：**垂直混合的[参数化](@entry_id:265163)**，即如何用数学和物理模型来表示这些未被解析的亚网格尺度过程对大尺度平均场的影响。

本文旨在系统性地阐述垂直混合[参数化](@entry_id:265163)的理论基础、实现方法及其在[地球科学](@entry_id:749876)中的广泛应用。我们将从基础出发，逐步深入，为读者构建一个完整的知识框架。
-   在“**原理与机制**”一章中，我们将追溯到[湍流封闭问题](@entry_id:268973)的根源，探讨控制混合的关键物理机制（如层结稳定度和表面强迫），并深入剖析两种主流[参数化](@entry_id:265163)方案——KPP和[Mellor-Yamada](@entry_id:1127770)——的设计哲学与内部运作。
-   在“**应用与跨学科联系**”一章中，我们将展示这些[参数化](@entry_id:265163)方案如何驱动[海洋边界层](@entry_id:1129048)动力学，如何与海浪、地形等其他物理过程相互作用，并揭示其在全球气候模拟、[生物地球化学循环](@entry_id:147568)、数据同化及高性能计算等领域的核心作用。
-   最后，在“**动手实践**”部分，我们将通过一系列编码练习，将理论知识转化为实际的计算技能，加深对关键算法和数值实现问题的理解。

通过学习本文，读者将不仅掌握垂直混合[参数化](@entry_id:265163)的核心理论，还将理解其在解决真实世界海洋与气候问题中的关键地位。现在，让我们从构建这些[参数化](@entry_id:265163)方案所依据的基本物理原理开始。

## 原理与机制

在上一章中，我们明确了在[海洋环流](@entry_id:195237)模型中[参数化](@entry_id:265163)垂直混合过程的必要性。由于计算资源的限制，海洋模型无法解析所有尺度的运动，特别是那些尺度小于模型网格的[湍流](@entry_id:151300)涡旋。然而，这些未被解析的涡旋对动量、热量、盐分和其他示踪剂的垂直输运起着至关重要的作用。本章将深入探讨[参数化](@entry_id:265163)这些过程所依据的核心物理原理和具体机制。我们将从[湍流理论](@entry_id:264896)的基本问题出发，逐步建立起理解现代垂直混合方案所需的物理框架，并详细剖析两种主流[参数化](@entry_id:265163)方案——K-廓线[参数化](@entry_id:265163)（KPP）和[Mellor-Yamada](@entry_id:1127770)（MY）闭合方案——的设计思想与运作方式。

### [雷诺平均](@entry_id:754341)与[湍流封闭问题](@entry_id:268973)

海洋中的物理量（如速度 $u$ 和示踪剂浓度 $\chi$）可以被分解为一个平均部分（$\overline{u}$, $\overline{\chi}$）和一个脉动部分（$u'$, $\chi'$），即 $u = \overline{u} + u'$。这个过程被称为**[雷诺分解](@entry_id:267756)**（Reynolds decomposition）。将此分解代入流体运动的原始控制方程（如[Navier-Stokes](@entry_id:276387)方程和[示踪剂守恒方程](@entry_id:1133277)）并进行平均，我们得到的是关于平均量的[演化方程](@entry_id:268137)，即**[雷诺平均](@entry_id:754341)Navier-Stokes（RANS）方程**。

然而，这个平均过程会产生新的未知项。例如，在水平动量方程和[示踪剂守恒方程](@entry_id:1133277)的垂直方向上，会出现形如 $\frac{\partial}{\partial z}(\overline{u'w'})$ 和 $\frac{\partial}{\partial z}(\overline{w'\chi'})$ 的项 。其中，$w'$ 是垂直速度脉动。$\overline{u'w'}$ 和 $\overline{w'\chi'}$ 分别代表了由[湍流](@entry_id:151300)脉动引起的动量和示踪剂的垂直通量，通常被称为**雷诺应力**（Reynolds stress）和**湍流通量**（turbulent flux）。这些[二阶相关](@entry_id:190427)项（即两个脉动量乘积的平均）是未知的，而我们只有关于一阶量（平均场）的方程。这导致方程组中的未知数多于方程数，系统因此是不封闭的。这个问题被称为经典的**[湍流封闭问题](@entry_id:268973)**（turbulence closure problem）。

为了解决这个问题，我们需要引入额外的假设或关系式，将这些未知的湍流通量与已知的平均场量联系起来。这个过程就是**[湍流](@entry_id:151300)闭合**（turbulence closure），其具体表达式即为**[参数化](@entry_id:265163)方案**（parameterization scheme）。

最简单也是最广泛使用的闭合假设是**[梯度扩散假说](@entry_id:1125716)**（gradient-diffusion hypothesis），也称为**K-理论**。该假说认为，[湍流](@entry_id:151300)的作用类似于分子扩散，即将物质从高浓度区域输运到低浓度区域，且通量大小与平均场梯度成正比。据此，垂直湍流通量可以表示为：

$$
\overline{u'w'} = -K_m \frac{\partial \overline{u}}{\partial z}
$$

$$
\overline{w'\chi'} = -K_\chi \frac{\partial \overline{\chi}}{\partial z}
$$

这里的 $K_m$ 和 $K_\chi$ 分别是**[湍流](@entry_id:151300)涡黏性系数**（eddy viscosity for momentum）和**[湍流](@entry_id:151300)涡扩散系数**（eddy diffusivity for tracers）。它们合称为**[湍流](@entry_id:151300)交换系数**（eddy coefficients）。负号确保了当梯度存在时，输运方向是“顺梯度”的，即从高值区到低值区。例如，如果示踪剂浓度随深度增加（$\frac{\partial \overline{\chi}}{\partial z} < 0$），那么湍流通量 $\overline{w'\chi'}$ 将为正，表示向上的净输运 。

必须强调，[湍流](@entry_id:151300)交换系数 $K$ 与分子的黏性或扩散系数在物理本质和数量级上都有着天壤之别 。[分子扩散系数](@entry_id:752110)（如[热扩散](@entry_id:148740)系数 $\kappa_m \approx 1.4 \times 10^{-7} \, \mathrm{m^2\,s^{-1}}$）是流体本身的物理属性，取决于分子运动。而[湍流](@entry_id:151300)交换系数 $K$ 则是**流场本身的属性**，它表征了[宏观湍流](@entry_id:161560)涡旋的混合效率，其大小取决于[湍流](@entry_id:151300)的强度和尺度。一个简单的标度分析表明，$K$ 的量级约等于一个特征[湍流](@entry_id:151300)速度尺度 $u'$ 乘以一个特征[混合长度](@entry_id:199968)尺度 $\ell$（$K \sim u' \ell$）。在海洋上边界层中，一个中等风速事件下，$u'$ 可由摩擦速度 $u_* \approx 10^{-2} \, \mathrm{m\,s^{-1}}$ 代表，混合长度 $\ell$ 可达 $0.5 \, \mathrm{m}$，因此 $K \sim 5 \times 10^{-3} \, \mathrm{m^2\,s^{-1}}$。这个值比[分子扩散系数](@entry_id:752110)大了超过四个数量级（$K/\kappa_m \sim 10^4$）。这表明在海洋[上层](@entry_id:198114)，湍流混合的效率远超分子扩散。因此，[参数化](@entry_id:265163)方案的核心任务就是准确地确定 $K$ 值如何随流场条件变化。

### 控制垂直混合的关键物理过程

[湍流](@entry_id:151300)的产生与耗散受到两大主要物理过程的控制：流速的[垂直切变](@entry_id:1133795)和[浮力](@entry_id:154088)效应。

#### [浮力](@entry_id:154088)、静力稳定度与[Brunt-Väisälä频率](@entry_id:158167)

海洋中的水体通常是层结的，即密度随深度变化。考虑一个静止的、密度为 $\rho(z)$ 的流体环境（$z$ 轴向上为正），一个流体微团从其平衡位置 $z_0$ 被垂直扰动了微小距离 $\eta$。假设该过程是绝热的，微团自身密度保持为 $\rho(z_0)$。而其新位置 $z_0+\eta$ 处的环境密度约为 $\rho(z_0) + \eta \frac{\partial \rho}{\partial z}$。微团受到的净力（[浮力](@entry_id:154088)）与其和环境的密度差成正比。根据[牛顿第二定律](@entry_id:274217)，在[Boussinesq近似](@entry_id:147239)下，微团的[运动方程](@entry_id:264286)为：

$$
\rho_0 \frac{d^2\eta}{dt^2} = -g (\rho_p - \rho_a) = -g \left( \rho(z_0) - \left[ \rho(z_0) + \eta \frac{\partial \rho}{\partial z} \right] \right) = -g \eta \frac{\partial \rho}{\partial z}
$$

整理后得到一个简谐振动方程：

$$
\frac{d^2\eta}{dt^2} + N^2 \eta = 0
$$

其中，

$$
N^2 = -\frac{g}{\rho_0} \frac{\partial \rho}{\partial z}
$$

$N^2$ 被称为**[Brunt-Väisälä频率](@entry_id:158167)**的平方，或**[浮力频率](@entry_id:1121933)**的平方 。它直接衡量了海洋的**静力稳定度**（static stability）。
-   当密度随深度增加（$\frac{\partial \rho}{\partial z} < 0$）时，$N^2 > 0$。此时，被扰动的微团会受到一个恢复力，使其在[平衡位置](@entry_id:272392)附近振荡，形成[内波](@entry_id:261048)。这种情况被称为**稳定层结**（stable stratification）。稳定层结会抑制垂直运动，因为[湍流](@entry_id:151300)涡旋需要做功来对抗[浮力](@entry_id:154088)，从而消耗湍动能，抑制垂直混合。
-   当密度随深度减小（$\frac{\partial \rho}{\partial z} > 0$）时，$N^2 < 0$。此时，扰动会[指数增长](@entry_id:141869)，导致不稳定的对流。这种情况被称为**不稳定层结**（unstable stratification），它会极大地促进垂直混合。

因此，$N^2$ 是所有垂直混合[参数化](@entry_id:265163)方案中描述层结效应的核心参数。

#### 表面强迫与相似性理论标度

海洋上边界层直接受到大气强迫的影响，主要是风应力和浮力通量（由热通量和淡水通量决定）。根据**[Monin-Obukhov相似性理论](@entry_id:1128126)**，边界层近表面的[湍流](@entry_id:151300)特性可以由几个关键参数来标度 。

1.  **[摩擦速度](@entry_id:267882) ($u_*$)**: 它由表面风应力 $\boldsymbol{\tau}$ 定义，是近表面由切变产生的[湍流](@entry_id:151300)的速度尺度。
    $$
    u_*^2 = \frac{|\boldsymbol{\tau}|}{\rho_0}
    $$
    $u_*$ 直接反映了风场向海洋注入动量和湍动能的速率。

2.  **[Monin-Obukhov长度](@entry_id:1128125) ($L$)**: 这是一个长度尺度，它定义了由切变产生的[湍流](@entry_id:151300)和由[浮力](@entry_id:154088)产生的[湍流](@entry_id:151300)相抗衡的深度。
    $$
    L = -\frac{u_*^3}{\kappa B_0}
    $$
    其中，$\kappa$ 是[von Kármán常数](@entry_id:261117)（约0.4），$B_0$ 是表面[浮力通量](@entry_id:261821)。$B_0 > 0$ 对应于不稳定强迫（如海表冷却），$B_0 < 0$ 对应于稳定强迫（如海表加热）。
    -   **不稳定/对流情况 ($B_0 > 0$)**: 此时 $L < 0$。$|L|$ 代表了这样一个深度：在比 $|L|$ 浅的区域，[湍流](@entry_id:151300)主要由风切变产生；在比 $|L|$ 深的区域，由[浮力](@entry_id:154088)驱动的对流开始占主导。
    -   **稳定情况 ($B_0 < 0$)**: 此时 $L > 0$。$L$ 代表了[湍流](@entry_id:151300)能够克服稳定层结向上发展的最大高度。
    -   **中性情况 ($B_0 = 0$)**: 此时 $|L| \to \infty$，表示[浮力](@entry_id:154088)效应可以忽略，[湍流](@entry_id:151300)完全由切变驱动。

这两个参数，$u_*$ 和 $L$，是构建上边界层混合[参数化](@entry_id:265163)方案（特别是KPP）的基石。

### 理查森数：稳定度与切变的相对作用

我们已经看到，稳定层结（由 $N^2$ 量化）抑制[湍流](@entry_id:151300)，而[速度切变](@entry_id:267235)（由 $S^2 = (\frac{\partial \overline{u}}{\partial z})^2 + (\frac{\partial \overline{v}}{\partial z})^2$ 量化）则通过从平均流中提取能量来产生[湍流](@entry_id:151300)。这两者之间的竞争关系可以用一个无量纲参数——**[梯度理查森数](@entry_id:276161)**（gradient Richardson number）来衡量：

$$
Ri_g = \frac{N^2}{S^2}
$$

$Ri_g$ 是衡量局地动力稳定性的关键指标。理论和实验表明，当 $Ri_g$ 超过某个临界值（通常认为是 $0.25$）时，层结的抑制作用强于切变的生产作用，[湍流](@entry_id:151300)会衰减并最终消失。因此，几乎所有的[参数化](@entry_id:265163)方案都以某种形式将[湍流](@entry_id:151300)交换系数 $K$ 构建为 $Ri_g$ 的减函数，即随着 $Ri_g$ 的增大，$K$ 值减小。

更进一步，我们可以从[湍动能收支](@entry_id:1133209)的角度来理解混合效率的差异 。在[稳态](@entry_id:139253)[湍流](@entry_id:151300)中，[湍动能](@entry_id:262712)的产生项（切变产生 $P = K_m S^2$ 和[浮力](@entry_id:154088)产生 $B = -K_h N^2$）与耗散项 $\epsilon$ 平衡：$P + B - \epsilon = 0$。定义**通量[理查森数](@entry_id:151448)** $R_f = -B/P$，它表示被用于克服[浮力](@entry_id:154088)做功的能量占总产生的[湍动能](@entry_id:262712)的比例。为了维持[湍流](@entry_id:151300)，$R_f$ 必须小于一个临界值（$R_f < R_{f,c} \approx 0.17$）。

将 $P$ 和 $B$ 的表达式代入 $R_f$ 的定义，我们得到：

$$
R_f = \frac{K_h N^2}{K_m S^2} = \frac{K_h}{K_m} Ri_g
$$

这引出了一个重要的关系，即**[湍流普朗特数](@entry_id:153739)**（turbulent Prandtl number） $Pr_t = K_m/K_h$：

$$
Pr_t = \frac{Ri_g}{R_f}
$$

在稳定层结条件下（$Ri_g > 0$），观测和理论均表明，[湍流](@entry_id:151300)可以在 $Ri_g$ 远大于 $R_{f,c}$ 的情况下存在（例如，$Ri_g$ 可以达到1甚至更高）。为了使上述关系成立，必须有 $Pr_t > 1$，即 $K_m > K_h$。这背后的物理原因是，稳定层结对垂直运动的抑制作用直接影响了需要垂直交换水团的标量（如[浮力](@entry_id:154088)）混合，因此对 $K_h$ 的压制更强。而动量可以通过压力脉动等机制进行输运，受到的直接抑制相对较弱。因此，在稳定层结中，动量的混合效率高于热量和盐分的混合效率。先进的[参数化](@entry_id:265163)方案，如KPP和MY，都内建了这种依赖于稳定度的、大于1的湍流普朗特数。

### 先进的垂直混合[参数化](@entry_id:265163)方案

简单的K-理论虽然直观，但在某些关键情境下会失效。这催生了更复杂的[参数化](@entry_id:265163)方案。

#### 局地闭合方案的局限性：对流边界层中的非局地输运

考虑一个由海表冷却驱动的对流边界层 。在这种情况下，强烈的垂直混合会使得边界层内的示踪剂（如温度）分布非常均匀，即平均梯度 $\frac{\partial \overline{c}}{\partial z} \approx 0$。然而，由于表面持续冷却，必然存在一个从海洋内部向上的、非零的热量通量（即 $\overline{w'c'} \neq 0$）来平衡海表的能量损失。

此时，一个纯粹的局地梯度扩散模型 $\overline{w'c'} = -K_c \frac{\partial \overline{c}}{\partial z}$ 会预测通量为零，这与物理现实严重不符。这种“零梯度、非零通量”的现象，被称为**逆梯度输运**（counter-gradient transport）。其物理根源在于，输运是由贯穿整个边界层的大尺度相干结构（即对流羽）完成的。一个从海表下沉的冷水团可以一直运动到边界层底部，它的运动并不取决于其途经路径上的局地梯度。这种由大尺度涡旋主导的输运被称为**非局地输运**（nonlocal transport）。为了准确刻画这种情况，[参数化](@entry_id:265163)方案必须包含非局地项。

#### K-廓线[参数化](@entry_id:265163)方案（KPP）

[KPP方案](@entry_id:1126967)（K-Profile Parameterization）正是一个为处理上边界层混合而设计的、包含非局地输运的**诊断型**方案  。它的核心思想是：

1.  **诊断边界层深度 ($h$)**: KPP首先根据一个**[整体理查森数](@entry_id:1121930)**（bulk Richardson number, $Ri_b$）准则来诊断出海洋上边界层的深度 $h$。$Ri_b$ 比较的是整个边界层顶底的密度差和速度差，从而确定[混合层](@entry_id:926526)的范围。

2.  **构建K-廓线**: 在边界层内部（$0 \le z \le h$），$K_m$ 和 $K_\chi$ 的廓线被指定为一个依赖于表面强迫（$u_*, B_0$）、边界层深度 $h$ 和无量纲深度 $z/h$ 的特定形状函数。这个形状函数的设计保证了在近表面区域与[Monin-Obukhov相似性理论](@entry_id:1128126)相符，并确保在表面 $z=0$ 处 $K=0$。

3.  **非局地输运项 ($\Gamma$)**: [KPP方案](@entry_id:1126967)的精髓在于，它在示踪剂的通量方程中加入了一个非局地项 $\Gamma$：
    $$
    \overline{w'\chi'} = -K_\chi \left( \frac{\partial \overline{\chi}}{\partial z} - \Gamma \right)
    $$
    这个 $\Gamma$ 项仅在不稳定/对流条件下（即 $B_0 > 0$）对示踪剂（而非动量）生效。它代表了由大型对流羽流驱动的向下输运，即使在局地梯度很小的情况下也能产生显著的通量，从而解决了逆梯度输运的问题 。

4.  **内部混合**: 在边界层之下（$z > h$），KPP匹配一个用于描述海洋内部混合的方案，通常该方案依赖于局地[梯度理查森数](@entry_id:276161) $Ri_g$ 来描述由[内波](@entry_id:261048)破碎等过程引起的混合。

由于KPP是诊断式的（即 $K$ 值由当前平均场直接计算得出），计算量相对较小，且其非局地项使其在模拟受表面强迫驱动的[混合层](@entry_id:926526)（特别是对流混合层）时表现优异。

#### [Mellor-Yamada](@entry_id:1127770)（MY）闭合方案

与KPP不同，[Mellor-Yamada](@entry_id:1127770)方案是一个**预报型**的**局地**闭合方案 。它不直接规定 $K$ 的廓线，而是通过求解[湍流](@entry_id:151300)自身的演化方程来动态地计算 $K$ 值。MY方案有一个完整的理论层级，其中MY 2.5级（MY2.5）在海洋模型中被广泛使用。其核心思想是：

1.  **预报湍动能和长度尺度**: MY2.5方案引入了两个新的预报变量：[湍动能](@entry_id:262712) $q^2/2$（$q$ 是特征[湍流](@entry_id:151300)速度）和一个与[湍流](@entry_id:151300)长度尺度 $\lambda$ 相关的量 $q^2\lambda$。模型会求解这两个量的完整[输运方程](@entry_id:174281)，方程中包含了[湍流](@entry_id:151300)的产生、[浮力](@entry_id:154088)效应、耗散和输运等所有相关物理过程。

2.  **诊断[湍流](@entry_id:151300)交换系数**: 在每个时间步，模型根据预报得到的局地 $q$ 和 $\lambda$ 值，以及平均场的局地梯度（$S^2$ 和 $N^2$），通过代数关系式来诊断出 $K_m$ 和 $K_h$。
    $$
    K_m = q \lambda S_m(Ri_g)
    $$
    $$
    K_h = q \lambda S_h(Ri_g)
    $$

3.  **稳定度函数**: 这里的 $S_m$ 和 $S_h$ 是**稳定度函数**，它们是局地[梯度理查森数](@entry_id:276161) $Ri_g$ 的函数。这些函数源自对[雷诺应力](@entry_id:263788)方程的简化，它们是MY方案的理论核心。它们的作用是根据局地层结的稳定度来调整混合的效率，确保在强稳定层结下混合被抑制，并自然地产生 $Pr_t > 1$ 的效应 。一个具体的计算实例可以展示这一过程：首先根据局地 $N^2$ 和 $\frac{\partial\overline{u}}{\partial z}$ 计算 $Ri_g$，然后代入稳定度函数表达式计算 $S_m$，再结合预报的 $q$ 和 $\lambda$ 计算出 $K_m$，最后得到[动量通量](@entry_id:199796) 。

由于MY2.5方案求解额外的[偏微分](@entry_id:194612)方程，其计算成本高于KPP。作为一个局地闭合方案，它不包含显式的非局地输运项，因此在模拟强对流边界层方面可能不如KPP。然而，其预报性的本质和对局地剪切、层结的精细响应，使其在模拟稳定层结下的剪切驱动[湍流](@entry_id:151300)（如海洋内部、赤道潜流和底层边界层）方面具有优势。

### 方案比较与应用

总结来说，KPP和MY代表了两种解决垂直混合[参数化](@entry_id:265163)问题的不同哲学 。

-   **KPP** 是一个为海洋上边界层“量身定做”的方案。它基于物理直觉和相似性理论，通过诊断边界层深度和引入非局地项，出色地捕捉了表面强迫下的[混合层](@entry_id:926526)动力学，特别是对流过程。它计算效率高，鲁棒性好。
-   **MY2.5** 是一个更具“普适性”的方案。它从[湍流](@entry_id:151300)二阶矩闭合的更一般理论出发，通过预报[湍流](@entry_id:151300)状态来决定混合强度。它对局地剪切和层结的变化响应更灵敏，理论基础更连贯，但计算成本更高，且在模拟强对流时因缺乏非局地项而可能存在不足。

在实际应用中，选择何种方案取决于具体的研究问题。若研究重点是[海气相互作用](@entry_id:1120897)和[上层](@entry_id:198114)海洋的[热力学](@entry_id:172368)结构，KPP常是首选。若研究重点是海洋内部的混合过程、深水形成或底层边界层动力学，MY这类预报型方案可能更为合适。许多现代海洋模型甚至提供了选项，允许用户根据自己的需求选择不同的垂直混合[参数化](@entry_id:265163)方案。