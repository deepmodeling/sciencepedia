{
    "hands_on_practices": [
        {
            "introduction": "The Boussinesq approximation greatly simplifies the momentum equations by treating density as a constant reference value, $\\rho_0$, in all terms except for the buoyancy force. This first practice provides a rigorous justification for this simplification by asking you to quantify the error introduced in the inertial term . By performing a scale analysis, you will derive an expression for the maximum possible error, demonstrating why this aspect of the approximation is so effective for typical oceanic conditions.",
            "id": "3813996",
            "problem": "Consider a variable-density oceanic flow described by the momentum equation derived from Newton’s second law for a continuum fluid,\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) = -\\nabla p - 2\\rho\\,\\boldsymbol{\\Omega}\\times \\boldsymbol{u} + \\rho\\,\\boldsymbol{g} + \\mu\\nabla^{2}\\boldsymbol{u},\n$$\nwhere $\\rho$ is the density, $\\boldsymbol{u}$ is the velocity, $p$ is the pressure, $\\boldsymbol{\\Omega}$ is the planetary rotation vector, $\\boldsymbol{g}$ is gravitational acceleration, and $\\mu$ is the dynamic viscosity. In the Boussinesq approximation, one replaces $\\rho$ by a constant reference density $\\rho_{0}$ in the inertial term $\\rho(\\partial\\boldsymbol{u}/\\partial t + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u})$ and in the Coriolis and viscous terms, while retaining density variations only in the buoyancy term $\\rho\\,\\boldsymbol{g}$. Let the density be decomposed as $\\rho(\\boldsymbol{x},t) = \\rho_{0} + \\rho'(\\boldsymbol{x},t)$ with $|\\rho'| \\le \\Delta \\rho \\ll \\rho_{0}$.\n\nDefine the fractional error in the inertial term induced by replacing $\\rho$ by $\\rho_{0}$ as\n$$\nE \\equiv \\frac{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) - \\rho_{0}\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}.\n$$\nUsing scale analysis with characteristic velocity scale $U$ and length scale $L$ for typical ocean flows, so that $\\left|\\partial \\boldsymbol{u}/\\partial t + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right|$ scales like $U^{2}/L$, derive a closed-form expression for the maximum possible fractional error $E_{\\max}$ over all admissible $\\rho'$ satisfying $|\\rho'| \\le \\Delta \\rho$. Evaluate $E_{\\max}$ for a weakly stratified ocean with $\\Delta \\rho / \\rho_{0} \\le 5 \\times 10^{-3}$. Express the final answer as a single dimensionless number or a single closed-form analytic expression; no units are required, and no rounding is necessary.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- The momentum equation for a variable-density oceanic flow:\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) = -\\nabla p - 2\\rho\\,\\boldsymbol{\\Omega}\\times \\boldsymbol{u} + \\rho\\,\\boldsymbol{g} + \\mu\\nabla^{2}\\boldsymbol{u}\n$$\n- Density decomposition: $\\rho(\\boldsymbol{x},t) = \\rho_{0} + \\rho'(\\boldsymbol{x},t)$.\n- Constraint on density perturbation: $|\\rho'| \\le \\Delta \\rho$.\n- Boussinesq condition: $\\Delta \\rho \\ll \\rho_{0}$.\n- The Boussinesq approximation involves replacing $\\rho$ with $\\rho_0$ in all terms except the buoyancy term $\\rho\\boldsymbol{g}$.\n- Definition of the fractional error $E$ in the inertial term:\n$$\nE \\equiv \\frac{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) - \\rho_{0}\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}\n$$\n- Scaling argument: $|\\partial \\boldsymbol{u}/\\partial t + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}|$ is non-zero, scaling as $U^2/L$.\n- Condition for evaluation: $\\Delta \\rho / \\rho_{0} \\le 5 \\times 10^{-3}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically sound, as it is based on the standard Navier-Stokes equations and the Boussinesq approximation, which are fundamental to geophysical fluid dynamics. The problem is well-posed, providing a clear definition of the quantity to be calculated ($E_{\\max}$) and all necessary constraints. The language is objective and precise. The numerical value provided for $\\Delta \\rho / \\rho_{0}$ is physically realistic for oceanic flows. The problem is self-contained and does not contain any contradictions or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\nThe objective is to find the maximum possible value of the fractional error $E$ in the inertial term, given the constraints on the density perturbation $\\rho'$.\n\nThe definition of the fractional error is:\n$$\nE \\equiv \\frac{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) - \\rho_{0}\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}{\\left|\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)\\right|}\n$$\nLet the material derivative of velocity be denoted by the vector $\\boldsymbol{a} \\equiv \\frac{D\\boldsymbol{u}}{Dt} = \\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}$. The problem statement implies through its scale analysis that this term is non-zero, i.e., $\\boldsymbol{a} \\neq \\boldsymbol{0}$. The expression for $E$ can be rewritten as:\n$$\nE = \\frac{|\\rho \\boldsymbol{a} - \\rho_{0} \\boldsymbol{a}|}{|\\rho \\boldsymbol{a}|}\n$$\nFactoring out the vector $\\boldsymbol{a}$ from the numerator and denominator:\n$$\nE = \\frac{|(\\rho - \\rho_{0}) \\boldsymbol{a}|}{|\\rho \\boldsymbol{a}|} = \\frac{|\\rho - \\rho_{0}| |\\boldsymbol{a}|}{|\\rho| |\\boldsymbol{a}|}\n$$\nSince $\\boldsymbol{a} \\neq \\boldsymbol{0}$, we can cancel the magnitude $|\\boldsymbol{a}|$:\n$$\nE = \\frac{|\\rho - \\rho_{0}|}{|\\rho|}\n$$\nUsing the density decomposition $\\rho = \\rho_{0} + \\rho'$, the term in the numerator becomes $|\\rho - \\rho_{0}| = |(\\rho_{0} + \\rho') - \\rho_{0}| = |\\rho'|$.\nThe term in the denominator is $|\\rho| = |\\rho_{0} + \\rho'|$. Since the problem is rooted in a physical context where $\\Delta \\rho \\ll \\rho_{0}$, and $\\rho_0$ is a positive reference density, the total density $\\rho = \\rho_{0} + \\rho'$ must be positive. Thus, $|\\rho| = \\rho = \\rho_{0} + \\rho'$.\nSubstituting these back into the expression for $E$:\n$$\nE = \\frac{|\\rho'|}{\\rho_{0} + \\rho'}\n$$\nWe need to find the maximum value of $E$, denoted $E_{\\max}$, subject to the constraint $|\\rho'| \\le \\Delta \\rho$, which is equivalent to $-\\Delta \\rho \\le \\rho' \\le \\Delta \\rho$. Let us analyze the function $f(\\rho') = \\frac{|\\rho'|}{\\rho_{0} + \\rho'}$.\n\nCase 1: $0 \\le \\rho' \\le \\Delta \\rho$.\nIn this range, $|\\rho'| = \\rho'$, so the function is $E(\\rho') = \\frac{\\rho'}{\\rho_{0} + \\rho'}$. To find the maximum, we can examine its derivative with respect to $\\rho'$:\n$$\n\\frac{dE}{d\\rho'} = \\frac{(1)(\\rho_{0} + \\rho') - (\\rho')(1)}{(\\rho_{0} + \\rho')^2} = \\frac{\\rho_{0}}{(\\rho_{0} + \\rho')^2}\n$$\nSince $\\rho_{0}  0$, the derivative is always positive. This means $E(\\rho')$ is a monotonically increasing function of $\\rho'$. The maximum value in this interval will occur at the upper bound, $\\rho' = \\Delta \\rho$.\nThe value is $E_1 = \\frac{\\Delta \\rho}{\\rho_{0} + \\Delta \\rho}$.\n\nCase 2: $-\\Delta \\rho \\le \\rho'  0$.\nIn this range, $|\\rho'| = -\\rho'$, so the function is $E(\\rho') = \\frac{-\\rho'}{\\rho_{0} + \\rho'}$. The derivative is:\n$$\n\\frac{dE}{d\\rho'} = \\frac{(-1)(\\rho_{0} + \\rho') - (-\\rho')(1)}{(\\rho_{0} + \\rho')^2} = \\frac{-\\rho_{0} - \\rho' + \\rho'}{(\\rho_{0} + \\rho')^2} = \\frac{-\\rho_{0}}{(\\rho_{0} + \\rho')^2}\n$$\nSince $\\rho_{0}  0$, the derivative is always negative. This means $E(\\rho')$ is a monotonically decreasing function of $\\rho'$. The maximum value in this interval will occur at the lower bound, $\\rho' = -\\Delta \\rho$.\nThe value is $E_2 = \\frac{-(-\\Delta \\rho)}{\\rho_{0} + (-\\Delta \\rho)} = \\frac{\\Delta \\rho}{\\rho_{0} - \\Delta \\rho}$.\n\nNow we must find the overall maximum, $E_{\\max}$, by comparing $E_1$ and $E_2$:\n$$\nE_1 = \\frac{\\Delta \\rho}{\\rho_{0} + \\Delta \\rho} \\quad \\text{and} \\quad E_2 = \\frac{\\Delta \\rho}{\\rho_{0} - \\Delta \\rho}\n$$\nSince $\\rho_{0}  0$ and $\\Delta \\rho  0$, we have $0  \\rho_{0} - \\Delta \\rho  \\rho_{0} + \\Delta \\rho$. Taking the reciprocal reverses the inequality:\n$$\n\\frac{1}{\\rho_{0} - \\Delta \\rho}  \\frac{1}{\\rho_{0} + \\Delta \\rho}\n$$\nMultiplying by the positive quantity $\\Delta \\rho$ preserves the inequality:\n$$\n\\frac{\\Delta \\rho}{\\rho_{0} - \\Delta \\rho}  \\frac{\\Delta \\rho}{\\rho_{0} + \\Delta \\rho}\n$$\nTherefore, $E_2  E_1$. The maximum possible fractional error is $E_{\\max} = E_2$.\n$$\nE_{\\max} = \\frac{\\Delta \\rho}{\\rho_{0} - \\Delta \\rho}\n$$\nTo express this in terms of the given ratio $\\Delta \\rho / \\rho_{0}$, we divide the numerator and denominator by $\\rho_{0}$:\n$$\nE_{\\max} = \\frac{\\Delta \\rho / \\rho_{0}}{(\\rho_{0} - \\Delta \\rho)/\\rho_{0}} = \\frac{\\Delta \\rho / \\rho_{0}}{1 - \\Delta \\rho / \\rho_{0}}\n$$\nThis is the required closed-form expression for $E_{\\max}$.\n\nFinally, we evaluate this expression for the specified condition $\\Delta \\rho / \\rho_{0} \\le 5 \\times 10^{-3}$. The maximum error will occur for the maximum value of the ratio, so we take $\\Delta \\rho / \\rho_{0} = 5 \\times 10^{-3} = 0.005$.\n$$\nE_{\\max} = \\frac{0.005}{1 - 0.005} = \\frac{0.005}{0.995}\n$$\nThis fraction can be simplified:\n$$\nE_{\\max} = \\frac{5/1000}{995/1000} = \\frac{5}{995}\n$$\nDividing the numerator and denominator by $5$:\n$$\nE_{\\max} = \\frac{1}{199}\n$$\nThis is the final numerical answer for the maximum possible fractional error.",
            "answer": "$$\n\\boxed{\\frac{1}{199}}\n$$"
        },
        {
            "introduction": "A cornerstone of the Boussinesq approximation is the simplification of the mass conservation equation to the incompressibility condition, $\\nabla \\cdot \\mathbf{u} = 0$. This practice explores the physical and mathematical implications of this choice by contrasting it with the seemingly more accurate condition of a divergence-free mass flux, $\\nabla \\cdot (\\rho \\mathbf{u}) = 0$ . You will derive the spurious velocity divergence that arises from this alternative constraint, offering a clear insight into why a solenoidal velocity field is the correct formulation in this regime.",
            "id": "3813981",
            "problem": "An ocean model implementing the Boussinesq approximation computes a solenoidal velocity field. Consider a stratified flow with density written as $\\rho = \\rho_{0} + \\rho'$, where $\\rho_{0}$ is a constant reference density and $\\rho'$ is a small perturbation such that $|\\rho'| / \\rho_{0} \\ll 1$. The fundamental mass conservation law states $\\partial \\rho / \\partial t + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$, where $\\mathbf{u}$ is the velocity field. In the Boussinesq approximation, the model enforces a divergence-free velocity $\\nabla \\cdot \\mathbf{u} = 0$. A colleague proposes instead to numerically enforce a divergence-free mass flux $\\nabla \\cdot (\\rho \\mathbf{u}) = 0$ while still treating $\\rho_{0}$ as constant in the momentum equation, arguing that this is a more general constraint when $\\rho'$ varies.\n\nUsing only the fundamental mass conservation law and standard rules of vector calculus, and treating $|\\rho'| / \\rho_{0}$ as a small parameter, derive the leading-order relationship between the two constraints and quantify the impact of enforcing $\\nabla \\cdot (\\rho \\mathbf{u}) = 0$ on the velocity-field divergence. Define a characteristic velocity scale $U$ and a density-gradient length scale $L$ such that $|\\mathbf{u}| \\sim U$ and $|\\nabla \\rho| \\sim |\\rho'|/L$. Define the dimensionless error $E$ as the normalized magnitude of the spurious divergence incurred by enforcing $\\nabla \\cdot (\\rho \\mathbf{u}) = 0$ instead of $\\nabla \\cdot \\mathbf{u} = 0$,\n$$\nE \\equiv \\frac{|\\nabla \\cdot \\mathbf{u}|}{U/L}.\n$$\nAssuming the Boussinesq regime with $|\\rho'| / \\rho_{0} \\sim 10^{-3}$, compute $E$ to leading order in $|\\rho'|/\\rho_{0}$. Express your final answer as a dimensionless decimal, rounded to three significant figures. Do not include any units.",
            "solution": "The problem requires an analysis of the consequences of enforcing a divergence-free mass flux, $\\nabla \\cdot (\\rho \\mathbf{u}) = 0$, within the context of the Boussinesq approximation, and a quantification of the resulting error in the velocity field divergence.\n\nThe fundamental principle of mass conservation in a fluid is given by the continuity equation:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nHere, $\\rho$ is the fluid density, $t$ is time, and $\\mathbf{u}$ is the velocity field. The Boussinesq approximation, typically applied to stratified flows where density variations are small, simplifies the governing equations. For the continuity equation, this approximation leads to the constraint of a divergence-free velocity field:\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\nThis is justified because for slow, nearly incompressible flows, density changes following a fluid parcel are very small, and thus the term $\\frac{1}{\\rho}\\frac{D\\rho}{Dt}$ is negligible compared to velocity gradients, leading to $\\nabla \\cdot \\mathbf{u} \\approx 0$.\n\nThe colleague's proposal is to enforce an alternative constraint:\n$$\n\\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nIf this constraint is enforced, the fundamental mass conservation law, $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$, implies that the numerical model is forced to satisfy $\\frac{\\partial \\rho}{\\partial t} = 0$. This means the density at any fixed point in space cannot change with time, a highly restrictive condition that prevents the model from representing time-evolving phenomena such as internal waves or the advection of stratification.\n\nOur task is to determine the artificial velocity divergence, $\\nabla \\cdot \\mathbf{u}$, that arises from imposing the colleague's constraint. We start with the constraint itself and apply the vector calculus product rule for the divergence of a scalar field ($\\rho$) multiplied by a vector field ($\\mathbf{u}$):\n$$\n\\nabla \\cdot (\\rho \\mathbf{u}) = (\\nabla \\rho) \\cdot \\mathbf{u} + \\rho (\\nabla \\cdot \\mathbf{u})\n$$\nSetting this expression to zero as per the proposal:\n$$\n(\\nabla \\rho) \\cdot \\mathbf{u} + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\nWe can solve this algebraic equation for the velocity divergence, $\\nabla \\cdot \\mathbf{u}$:\n$$\n\\nabla \\cdot \\mathbf{u} = - \\frac{(\\nabla \\rho) \\cdot \\mathbf{u}}{\\rho}\n$$\nThis equation provides the exact, non-zero value of the velocity divergence that is implicitly generated by enforcing a divergence-free mass flux.\n\nNext, we analyze this expression within the framework of the Boussinesq approximation. The density $\\rho$ is decomposed into a constant reference density $\\rho_{0}$ and a small perturbation $\\rho'$:\n$$\n\\rho = \\rho_{0} + \\rho'\n$$\nwhere $|\\rho'| / \\rho_{0} \\ll 1$. Since $\\rho_{0}$ is a spatial constant, its gradient is zero, so $\\nabla \\rho = \\nabla (\\rho_{0} + \\rho') = \\nabla \\rho'$. Substituting these into the expression for the divergence gives:\n$$\n\\nabla \\cdot \\mathbf{u} = - \\frac{(\\nabla \\rho') \\cdot \\mathbf{u}}{\\rho_{0} + \\rho'}\n$$\nTo find the leading-order relationship, we perform a Taylor expansion of the term $\\frac{1}{\\rho_{0} + \\rho'}$ for small $\\rho'/\\rho_{0}$:\n$$\n\\frac{1}{\\rho_{0} + \\rho'} = \\frac{1}{\\rho_{0}(1 + \\rho'/\\rho_{0})} = \\frac{1}{\\rho_{0}} \\left(1 - \\frac{\\rho'}{\\rho_{0}} + O\\left(\\left(\\frac{\\rho'}{\\rho_{0}}\\right)^2\\right)\\right)\n$$\nKeeping only the leading-order term, we find the approximate spurious divergence:\n$$\n\\nabla \\cdot \\mathbf{u} \\approx - \\frac{(\\nabla \\rho') \\cdot \\mathbf{u}}{\\rho_{0}}\n$$\nThis is the leading-order relationship between the colleague's constraint and the resulting velocity divergence.\n\nTo quantify the typical magnitude of this divergence, we perform a scale analysis. The magnitude of the divergence is:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\approx \\left|- \\frac{(\\nabla \\rho') \\cdot \\mathbf{u}}{\\rho_{0}}\\right| = \\frac{|(\\nabla \\rho') \\cdot \\mathbf{u}|}{\\rho_{0}}\n$$\nUsing the property of the dot product, $|(\\nabla \\rho') \\cdot \\mathbf{u}| \\le |\\nabla \\rho'| |\\mathbf{u}|$. For a scale analysis, we assume the vectors are not systematically orthogonal and relate their characteristic scales:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\sim \\frac{|\\nabla \\rho'| |\\mathbf{u}|}{\\rho_{0}}\n$$\nThe problem defines the characteristic velocity scale $|\\mathbf{u}| \\sim U$ and the density-gradient length scale $L$ such that $|\\nabla \\rho| \\sim |\\rho'|/L$. Since $\\nabla\\rho = \\nabla\\rho'$, this implies $|\\nabla \\rho'| \\sim |\\rho'|/L$. Substituting these scales into the expression for the divergence magnitude yields:\n$$\n|\\nabla \\cdot \\mathbf{u}| \\sim \\frac{(|\\rho'|/L) U}{\\rho_{0}} = \\frac{U}{L} \\frac{|\\rho'|}{\\rho_{0}}\n$$\nThe problem defines the dimensionless error $E$ as the normalized magnitude of the spurious divergence:\n$$\nE \\equiv \\frac{|\\nabla \\cdot \\mathbf{u}|}{U/L}\n$$\nSubstituting our scaled expression for $|\\nabla \\cdot \\mathbf{u}|$:\n$$\nE \\sim \\frac{\\frac{U}{L} \\frac{|\\rho'|}{\\rho_{0}}}{U/L} = \\frac{|\\rho'|}{\\rho_{0}}\n$$\nThus, to leading order, the dimensionless error incurred in the velocity divergence is equal to the fractional density perturbation.\n\nFinally, we are asked to compute a numerical value for $E$ given that in the Boussinesq regime, $|\\rho'|/\\rho_{0} \\sim 10^{-3}$.\n$$\nE \\sim 10^{-3} = 0.001\n$$\nThe problem requires this result as a dimensionless decimal rounded to three significant figures. To express $0.001$ with three significant figures, we write it as $0.00100$.",
            "answer": "$$\\boxed{0.00100}$$"
        },
        {
            "introduction": "Having established the theoretical underpinnings of the Boussinesq approximation, we now turn to its application in a canonical geophysical fluid dynamics problem. This exercise examines a lock-exchange scenario, which models the behavior of gravity currents—a crucial process in ocean circulation . By applying the Boussinesq framework and the concept of reduced gravity, $g'$, you will derive the propagation speed of the resulting internal fronts, showcasing the approximation's power to yield elegant and physically important results.",
            "id": "3813977",
            "problem": "Consider a one-dimensional, inviscid, hydrostatic two-layer flow in a long rectangular channel of constant total depth $H$ under the Boussinesq approximation, where small density differences are retained only in buoyancy terms and the free surface is constrained by a rigid-lid condition so that barotropic motions are suppressed. The upper layer has density $\\rho_{1}$ and the lower layer has density $\\rho_{2}$ with $\\rho_{2}  \\rho_{1}$, and the reduced gravity is $g' = g \\frac{\\rho_{2} - \\rho_{1}}{\\rho_{0}}$, where $\\rho_{0}$ is a constant reference density. Initially, the system is at rest with equal layer thicknesses $H/2$. At $x=0$ a lock is released that produces a symmetric initial state: to the left, the interface is displaced upward and to the right it is displaced downward, so that two gravity currents (internal bores) begin to propagate away from $x=0$ into quiescent fluid. \n\nStarting from the fundamental conservation of mass and momentum for each layer, assumed hydrostatic and depth-averaged, and enforcing the rigid-lid constraint, derive the baroclinic long-wave characteristic speed for the internal mode and show that, for this symmetric lock-exchange configuration, the gravity current fronts propagate at that speed. Express the gravity current front speed $c$ as a single closed-form analytic expression in terms of $g'$ and $H$. Provide the final expression only; do not include any numerical evaluation. Express your final answer symbolically in terms of $g'$ and $H$.",
            "solution": "The user wants to solve a problem in geophysical fluid dynamics concerning a two-layer flow under the Boussinesq approximation.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n\n*   **System:** One-dimensional, inviscid, hydrostatic two-layer flow.\n*   **Geometry:** Long rectangular channel of constant total depth $H$.\n*   **Approximation:** Boussinesq approximation.\n*   **Boundary Condition:** Rigid-lid at the free surface.\n*   **Layer Properties:** Upper layer density $\\rho_{1}$, lower layer density $\\rho_{2}$, with $\\rho_{2}  \\rho_{1}$.\n*   **Reduced Gravity:** $g' = g \\frac{\\rho_{2} - \\rho_{1}}{\\rho_{0}}$, for a reference density $\\rho_{0}$.\n*   **Initial Conditions (far-field/undisturbed):** System at rest, with equal layer thicknesses $h_1 = h_2 = H/2$.\n*   **Perturbation:** A lock at $x=0$ is released, creating a symmetric initial state that generates two gravity currents propagating into the quiescent fluid.\n*   **Governing Principles:** Start from conservation of mass and momentum for each layer (hydrostatic, depth-averaged).\n*   **Objective:** Derive the baroclinic long-wave characteristic speed. Show that the gravity current front in the symmetric lock-exchange propagates at this speed. Provide the final expression for the front speed $c$ in terms of $g'$ and $H$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding:** The problem is a canonical example in geophysical fluid dynamics, based on the well-established shallow water equations for a layered fluid. The concepts of the Boussinesq approximation, rigid-lid condition, hydrostatic balance, and lock-exchange are fundamental to the field. The problem is scientifically sound.\n*   **Well-Posedness:** The problem provides a clear initial state and boundary conditions and requests the derivation of a specific physical quantity (wave/front speed). It is self-contained and has a unique, well-defined solution.\n*   **Objectivity:** The problem is stated using precise, formal language common to physics and fluid dynamics, free of subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. It is a standard, well-posed problem grounded in established physical principles. The solution process may proceed.\n\n### **Detailed Solution**\n\nThe problem consists of two parts: first, deriving the characteristic speed of long internal waves in the specified system, and second, showing that the front of a gravity current generated by a symmetric lock-exchange propagates at this same speed.\n\n**Part 1: Derivation of the Internal Long-Wave Characteristic Speed**\n\nWe begin with the one-dimensional, hydrostatic, Boussinesq equations for two layers. Let $h_1(x,t)$ and $h_2(x,t)$ be the thicknesses of the upper and lower layers, and $u_1(x,t)$ and $u_2(x,t)$ be their respective depth-averaged horizontal velocities.\n\nThe conservation of mass for each layer is:\n$$\n\\frac{\\partial h_1}{\\partial t} + \\frac{\\partial (u_1 h_1)}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial h_2}{\\partial t} + \\frac{\\partial (u_2 h_2)}{\\partial x} = 0\n$$\n\nThe rigid-lid condition imposes that the total depth is constant: $h_1 + h_2 = H$. Differentiating with respect to time gives $\\frac{\\partial h_1}{\\partial t} = -\\frac{\\partial h_2}{\\partial t}$. Summing the two mass conservation equations yields:\n$$\n\\frac{\\partial (h_1 + h_2)}{\\partial t} + \\frac{\\partial (u_1 h_1 + u_2 h_2)}{\\partial x} = 0\n$$\nSince $h_1 + h_2 = H$ (a constant), the first term is zero, which implies $\\frac{\\partial}{\\partial x}(u_1 h_1 + u_2 h_2) = 0$. This means the total volume transport, $Q = u_1 h_1 + u_2 h_2$, is constant in space. As the flow originates from a state of rest in a closed basin, this constant must be zero. Therefore, a key consequence of the rigid-lid approximation is the zero net transport condition:\n$$\nu_1 h_1 + u_2 h_2 = 0\n$$\n\nThe hydrostatic momentum equations under the Boussinesq approximation, after eliminating the barotropic pressure gradient (which is associated with the free surface elevation, suppressed by the rigid lid), can be combined to form an equation for the evolution of the velocity difference:\n$$\n\\frac{\\partial (u_1 - u_2)}{\\partial t} + u_1 \\frac{\\partial u_1}{\\partial x} - u_2 \\frac{\\partial u_2}{\\partial x} = g' \\frac{\\partial h_2}{\\partial x}\n$$\nHere we use the fact that the interfacial pressure gradient is proportional to the slope of the interface, $\\frac{\\partial h_2}{\\partial x} = - \\frac{\\partial h_1}{\\partial x}$.\n\nTo find the characteristic speed of long waves, we linearize these equations around a state of rest ($u_1=0$, $u_2=0$) with mean layer thicknesses $H_1$ and $H_2$. Let the interface be perturbed by a small amount $\\eta(x,t)$, such that $h_2 = H_2 + \\eta$ and $h_1 = H_1 - \\eta$. The velocities $u_1$ and $u_2$ are also considered small perturbations.\n\nThe linearized mass conservation for the lower layer is:\n$$\n\\frac{\\partial \\eta}{\\partial t} + H_2 \\frac{\\partial u_2}{\\partial x} = 0\n$$\n\nThe linearized zero net transport condition is:\n$$\nu_1 H_1 + u_2 H_2 = 0 \\implies u_1 = -\\frac{H_2}{H_1} u_2\n$$\n\nThe linearized momentum difference equation is:\n$$\n\\frac{\\partial (u_1 - u_2)}{\\partial t} = g' \\frac{\\partial \\eta}{\\partial x}\n$$\n\nSubstitute the expression for $u_1$ from the transport condition into the momentum equation:\n$$\n\\frac{\\partial}{\\partial t} \\left(-\\frac{H_2}{H_1} u_2 - u_2\\right) = g' \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n-\\left(\\frac{H_1 + H_2}{H_1}\\right) \\frac{\\partial u_2}{\\partial t} = g' \\frac{\\partial \\eta}{\\partial x}\n$$\nSince $H_1 + H_2 = H$, we have:\n$$\n-\\frac{H}{H_1} \\frac{\\partial u_2}{\\partial t} = g' \\frac{\\partial \\eta}{\\partial x}\n$$\n\nNow we combine the linearized mass and momentum equations. Differentiate the momentum equation with respect to $x$ and the mass equation with respect to $t$:\n$$\n-\\frac{H}{H_1} \\frac{\\partial^2 u_2}{\\partial t \\partial x} = g' \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + H_2 \\frac{\\partial^2 u_2}{\\partial t \\partial x} = 0 \\implies \\frac{\\partial^2 u_2}{\\partial t \\partial x} = -\\frac{1}{H_2} \\frac{\\partial^2 \\eta}{\\partial t^2}\n$$\n\nSubstitute the second result into the first:\n$$\n-\\frac{H}{H_1} \\left(-\\frac{1}{H_2} \\frac{\\partial^2 \\eta}{\\partial t^2}\\right) = g' \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\n$$\n\\frac{H}{H_1 H_2} \\frac{\\partial^2 \\eta}{\\partial t^2} = g' \\frac{\\partial^2 \\eta}{\\partial x^2}\n$$\nThis rearranges into the standard wave equation form, $\\frac{\\partial^2 \\eta}{\\partial t^2} = c^2 \\frac{\\partial^2 \\eta}{\\partial x^2}$, where $c^2$ is the squared phase speed:\n$$\nc^2 = g' \\frac{H_1 H_2}{H}\n$$\n\nFor the specific case given in the problem, the undisturbed state has equal layer thicknesses, so $H_1 = H_2 = H/2$. Substituting these values gives the baroclinic long-wave characteristic speed:\n$$\nc^2 = g' \\frac{(H/2)(H/2)}{H} = g' \\frac{H^2/4}{H} = \\frac{g'H}{4}\n$$\n$$\nc = \\sqrt{\\frac{g'H}{4}} = \\frac{1}{2}\\sqrt{g'H}\n$$\n\n**Part 2: Connection to the Gravity Current Front Speed**\n\nThe release of a lock in a two-fluid system generates non-linear bores, or gravity currents, that propagate away from the initial discontinuity. The speed of these fronts is determined by the non-linear jump conditions (the Rankine-Hugoniot relations for the shallow water equations).\n\nFor the specific symmetric lock-exchange configuration described, the problem is a two-fluid analogue of the classic dam-break problem. The solution involves two propagating fronts (shocks) and rarefaction waves. A remarkable result from the theory of such flows is that for a symmetric initial condition (equivalent to a full lock-exchange where a volume of dense fluid is released into a volume of light fluid of the same depth), the speed of the leading edge of the gravity current is precisely equal to the linear long-wave speed derived above.\n\nThis can be understood through a combination of hydraulic theory and energy arguments.\n1.  **Critical Flow:** By symmetry, the flow at the location of the original lock ($x=0$) must have the interface at the midpoint, $h_1=h_2=H/2$. The flow at this point is \"critical,\" meaning the composite internal Froude number is unity. This condition sets the flow velocities at the center.\n2.  **Front Conditions:** The front of the gravity current propagates into a quiescent fluid. The relationship between the front speed $c$ and the properties of the flow behind it is complex. However, established theory for energy-conserving gravity current heads (e.g., by T. B. Benjamin) provides a formula for the front speed.\n3.  **Special Case of $h=H/2$:** For the specific case where the gravity current head occupies half the total channel depth ($h_{head} = H/2$), which is the case for a symmetric lock exchange, Benjamin's theory predicts a front speed of $c = \\frac{1}{2}\\sqrt{g'H}$.\n\nThis result shows that the speed of the non-linear bore generated in a symmetric lock exchange is identical to the speed of infinitesimal-amplitude long waves in the undisturbed medium. Although the front itself is a highly non-linear feature where energy is dissipated, its propagation speed is governed by this simple expression.\n\nTherefore, the gravity current front speed is:\n$$\nc = \\frac{1}{2}\\sqrt{g'H}\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}\\sqrt{g'H}}$$"
        }
    ]
}