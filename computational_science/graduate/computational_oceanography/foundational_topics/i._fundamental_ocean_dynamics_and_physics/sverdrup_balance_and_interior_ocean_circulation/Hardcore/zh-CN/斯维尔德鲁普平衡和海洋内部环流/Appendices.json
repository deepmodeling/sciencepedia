{
    "hands_on_practices": [
        {
            "introduction": "要理解广阔而缓慢的海洋内部运动，我们无需在任何地方都求解完整而复杂的运动方程。本练习将指导您进行尺度分析——这是一个强大的工具，可以帮助我们识别其中起主导作用的力。通过比较不同项的量级，您将定量地证明，对于大尺度环流，我们可以将动力学简化为科里奥利力与压力梯度之间的主要平衡，从而为斯韦尔德鲁普平衡等理论铺平道路 。",
            "id": "3812738",
            "problem": "考虑一个中纬度、静力、旋转、Boussinesq近似的、忽略底摩擦的海洋内部。对于深度积分流，水平平均的动量方程可以示意性地写为局地加速度、非线性平流、科里奥利力、水平压力梯度和风应力强迫之间的平衡。设特征水平速度尺度为 $U$，水平长度尺度为 $L$，海洋深度为 $H$。取常数参考密度为 $\\rho_0$，科里奥利参数为 $f$，地表风应力矢量的大小为 $\\tau$。对于非定常性，采用平流时间尺度 $T=L/U$。\n\n使用基于原始水平动量方程的尺度分析，估计以下各项加速度的量级（单位为 $\\mathrm{m\\,s}^{-2}$）：局地加速度（$\\partial_t u$）、非线性平流（$u\\partial_x u + v\\partial_y u$）、科里奥利加速度（$fU$）、水平压力梯度加速度（$-(1/\\rho_0)\\nabla_h p$）以及深度平均的风应力加速度（$\\tau/(\\rho_0 H)$）。然后，计算各项与科里奥利加速度的无量纲比值，并解释它们的相对大小，以证明风生环流内部涡度平衡的特征。\n\n使用以下科学上合理的中纬度数值：$U=0.05\\ \\mathrm{m\\,s}^{-1}$，$L=1000\\ \\mathrm{km}$，$H=4000\\ \\mathrm{m}$，$\\tau=0.1\\ \\mathrm{N\\,m}^{-2}$，$\\rho_0=1025\\ \\mathrm{kg\\,m}^{-3}$ 以及 $f=1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$。将最终答案表示为从这些值获得的罗斯贝数 $Ro=U/(fL)$ 的值。将您的答案四舍五入到三位有效数字。最终答案是无量纲的；不要包含单位。",
            "solution": "对问题陈述进行验证。\n\n### 步骤1：提取给定条件\n-   特征水平速度尺度：$U=0.05\\ \\mathrm{m\\,s}^{-1}$\n-   水平长度尺度：$L=1000\\ \\mathrm{km}$\n-   海洋深度：$H=4000\\ \\mathrm{m}$\n-   地表风应力矢量的大小：$\\tau=0.1\\ \\mathrm{N\\,m}^{-2}$\n-   常数参考密度：$\\rho_0=1025\\ \\mathrm{kg\\,m}^{-3}$\n-   科里奥利参数：$f=1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$\n-   用于非定常性的平流时间尺度：$T = L/U$\n\n### 步骤2：使用提取的给定条件进行验证\n1.  **科学依据**：该问题基于原始运动方程，这是地球物理流体动力学的基础。尺度分析、地转平衡、罗斯贝数和风生环流等概念是物理海洋学的核心。所提供的数值对于中纬度海洋环流是标准且科学合理的。\n2.  **适定性**：该问题提供了所有必要的参数和一组明确的任务：进行尺度分析，在海洋环流理论的背景下解释结果，并计算一个特定的无量纲数（$Ro$）。存在唯一解。\n3.  **客观性**：语言技术性强且精确，没有主观性或歧义。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个关于大尺度海洋环流控制方程尺度分析的标准、适定的练习。将提供完整解答。\n\n### 解答\n该问题要求对大尺度海洋内部流动的深度平均水平动量方程进行尺度分析。对于速度场 $\\mathbf{u}_h = (u,v)$，水平面（$x, y$）上的示意性动量方程可以写为：\n$$\n\\underbrace{\\frac{\\partial \\mathbf{u}_h}{\\partial t}}_{\\text{Local Acceleration}} + \\underbrace{(\\mathbf{u}_h \\cdot \\nabla_h) \\mathbf{u}_h}_{\\text{Nonlinear Advection}} + \\underbrace{f \\mathbf{k} \\times \\mathbf{u}_h}_{\\text{Coriolis}} = \\underbrace{-\\frac{1}{\\rho_0} \\nabla_h p}_{\\text{Pressure Gradient}} + \\underbrace{\\frac{\\boldsymbol{\\tau}}{\\rho_0 H}}_{\\text{Wind Stress}}\n$$\n我们将使用提供的尺度来估计每一项的特征量级。首先，我们确保长度尺度 $L$ 的单位一致：\n$L = 1000\\ \\mathrm{km} = 1000 \\times 10^3\\ \\mathrm{m} = 10^6\\ \\mathrm{m}$。\n\n偏导数的特征尺度为 $\\partial/\\partial t \\sim 1/T$，$\\partial/\\partial x \\sim 1/L$ 和 $\\partial/\\partial y \\sim 1/L$。速度尺度为 $U$。\n\n1.  **加速度项的量级估计：**\n\n    *   **局地加速度**：时间尺度为 $T=L/U$。该项的量级尺度为：\n        $$ \\left|\\frac{\\partial \\mathbf{u}_h}{\\partial t}\\right| \\sim \\frac{U}{T} = \\frac{U}{L/U} = \\frac{U^2}{L} $$\n        代入数值：\n        $$ \\frac{(0.05\\ \\mathrm{m\\,s}^{-1})^2}{10^6\\ \\mathrm{m}} = \\frac{0.0025\\ \\mathrm{m}^2\\,\\mathrm{s}^{-2}}{10^6\\ \\mathrm{m}} = 2.5 \\times 10^{-9}\\ \\mathrm{m\\,s}^{-2} $$\n\n    *   **非线性平流**：像 $u \\partial_x u$ 这样的项的尺度为 $U \\cdot (U/L) = U^2/L$。因此其量级为：\n        $$ |(\\mathbf{u}_h \\cdot \\nabla_h) \\mathbf{u}_h| \\sim \\frac{U^2}{L} = 2.5 \\times 10^{-9}\\ \\mathrm{m\\,s}^{-2} $$\n\n    *   **科里奥利加速度**：该项的量级尺度为：\n        $$ |f \\mathbf{k} \\times \\mathbf{u}_h| \\sim fU $$\n        代入数值：\n        $$ (1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}) \\cdot (0.05\\ \\mathrm{m\\,s}^{-1}) = 5.0 \\times 10^{-6}\\ \\mathrm{m\\,s}^{-2} $$\n\n    *   **水平压力梯度加速度**：在大尺度海洋内部，主要的平衡是地转平衡，即科里奥利力与压力梯度力相平衡。因此，该项必须与科里奥利项具有相同的尺度：\n        $$ \\left|-\\frac{1}{\\rho_0} \\nabla_h p\\right| \\sim fU \\approx 5.0 \\times 10^{-6}\\ \\mathrm{m\\,s}^{-2} $$\n\n    *   **深度平均的风应力加速度**：该项的量级由其尺度形式直接给出：\n        $$ \\left|\\frac{\\boldsymbol{\\tau}}{\\rho_0 H}\\right| \\sim \\frac{\\tau}{\\rho_0 H} $$\n        代入数值：\n        $$ \\frac{0.1\\ \\mathrm{N\\,m}^{-2}}{(1025\\ \\mathrm{kg\\,m}^{-3}) \\cdot (4000\\ \\mathrm{m})} = \\frac{0.1}{4.1 \\times 10^6}\\ \\mathrm{m\\,s}^{-2} \\approx 2.439 \\times 10^{-8}\\ \\mathrm{m\\,s}^{-2} $$\n\n2.  **无量纲比值与解释：**\n\n    为了理解这些项的相对重要性，我们计算它们相对于科里奥利加速度的无量纲比值，科里奥利加速度通常是大尺度地球物理流动中最大的一项。\n\n    *   **惯性项**（局地加速度和非线性平流）与科里奥利项的比值：\n        $$ \\frac{U^2/L}{fU} = \\frac{U}{fL} = \\text{Ro} $$\n        这个比值是罗斯贝数 $Ro$。其值为：\n        $$ \\frac{2.5 \\times 10^{-9}\\ \\mathrm{m\\,s}^{-2}}{5.0 \\times 10^{-6}\\ \\mathrm{m\\,s}^{-2}} = 5.0 \\times 10^{-4} $$\n\n    *   **压力梯度**与科里奥利项的比值：\n        $$ \\frac{|-(1/\\rho_0)\\nabla_h p|}{|fU|} \\sim \\frac{fU}{fU} = 1 $$\n\n    *   **风应力**与科里奥利项的比值：\n        $$ \\frac{\\tau/(\\rho_0 H)}{fU} \\approx \\frac{2.439 \\times 10^{-8}\\ \\mathrm{m\\,s}^{-2}}{5.0 \\times 10^{-6}\\ \\mathrm{m\\,s}^{-2}} \\approx 4.88 \\times 10^{-3} $$\n\n    **解释**：该分析揭示了一个清晰的尺度等级。科里奥利项和压力梯度项是最大的，量级约为 $5.0 \\times 10^{-6}\\ \\mathrm{m\\,s}^{-2}$。次大的项是风应力强迫，其量级小了大约两个数量级（$\\sim 10^{-8}\\ \\mathrm{m\\,s}^{-2}$）。惯性项（局地加速度和平流）是最小的，比科里奥利项小了近三个数量级（$\\sim 10^{-9}\\ \\mathrm{m\\,s}^{-2}$）。\n\n    罗斯贝数 $Ro = U/(fL) \\approx 5.0 \\times 10^{-4} \\ll 1$ 这一事实，是风生大尺度海洋环流理论的基本依据。它表明，在一个非常好的首级近似下，流动处于 **地转平衡** 状态：\n    $$ f \\mathbf{k} \\times \\mathbf{u}_h \\approx -\\frac{1}{\\rho_0} \\nabla_h p $$\n    在主导阶的动量平衡中，可以忽略惯性加速度。海洋内部的特征涡度平衡（Sverdrup 平衡）是通过考虑更小的、非地转的项得出的。风应力的旋度由行星涡度的经向平流（$\\beta v$，其中 $\\beta = \\partial f/\\partial y$）来平衡，而后者本身依赖于对纯地转的微小偏离。该尺度分析证实了这些简化假设的有效性。\n\n3.  **最终计算：**\n\n    问题要求计算罗斯贝数 $Ro=U/(fL)$ 的值，并四舍五入到三位有效数字。\n    $$ Ro = \\frac{U}{fL} = \\frac{0.05\\ \\mathrm{m\\,s}^{-1}}{(1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}) \\cdot (10^6\\ \\mathrm{m})} $$\n    $$ Ro = \\frac{0.05}{1.0 \\times 10^2} = \\frac{0.05}{100} = 0.0005 $$\n    四舍五入到三位有效数字，我们用科学记数法表示为：\n    $$ Ro = 5.00 \\times 10^{-4} $$",
            "answer": "$$\\boxed{5.00 \\times 10^{-4}}$$"
        },
        {
            "introduction": "一旦我们确定了海洋内部主要处于地转平衡状态，我们就可以推导出一个异常简洁的关系式，用来描述风与海洋的南北向输运。本练习是斯韦尔德鲁普平衡理论的一个经典应用 。您将从第一性原理出发推导斯韦尔德鲁普关系，然后利用它为一个给定的风应力模式计算海洋的输运流函数，从而将大气强迫与海盆尺度环流直接联系起来。",
            "id": "3812699",
            "problem": "考虑一个位于中纬度β平面上的矩形海盆，其密度$\\rho_0$和深度均为常数，水平坐标为$(x,y)$，其中$x$向东增加，$y$向北增加。区域范围为 $0 \\le x \\le L$ 和 $0 \\le y \\le W$，其中$L>0$和$W>0$。假设海盆内部是稳定的、线性的、无粘性的，受地转和连续性方程控制，摩擦力仅限于薄的表层埃克曼层。海盆由水平变化的风应力$\\boldsymbol{\\tau}(x,y) = (\\tau_x(x,y), \\tau_y(x,y))$驱动。风应力旋度的垂直分量由下式给出：\n$$\n\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_z(x,y) = \\rho_0 \\, \\beta \\, U_0 \\, \\cos\\!\\left(\\frac{\\pi x}{L}\\right),\n$$\n其中$\\beta>0$是科里奥利参数的经向梯度，$U_0>0$是一个常数，其量纲为单位纬向长度上的垂直积分经向输运。令$\\psi(x,y)$表示正压输运流函数，使得垂直积分的水平输运$(U,V)$满足$U(x,y) = -\\partial \\psi/\\partial y$和$V(x,y) = \\partial \\psi/\\partial x$。\n\n从β平面上稳定内部涡度动力学的适当基本平衡出发，推导将垂直积分经向输运与所施加的风应力旋度联系起来的内部关系。然后，对于给定的$\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_z(x,y)$，沿纬向积分以获得与内部平衡一致的$\\psi(x,y)$。在$x=0$和$x=L$处施加无垂向流动的侧壁边界条件，并通过选择东边界参考值$\\psi(L,y)=0$来确定剩余的积分常数。请用$U_0$和$L$将你的最终答案表示为$\\psi(x,y)$的单一简化解析表达式。不需要进行数值计算或四舍五入，并且最终表达式中不应包含物理单位。",
            "solution": "该问题要求在给定特定风应力旋度的条件下，求解矩形海盆内部的正压输运流函数$\\psi(x,y)$。我们首先验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- 区域：矩形海盆，$0 \\le x \\le L$ 且 $0 \\le y \\le W$。\n- 坐标：$x$ 向东，$y$ 向北。\n- 流体性质：恒定密度 $\\rho_0$，恒定深度。\n- 动力学：中纬度 β 平面上的稳定、线性、无粘性内部。摩擦力仅限于表层埃克曼层。\n- 风应力旋度：$\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_z(x,y) = \\rho_0 \\, \\beta \\, U_0 \\, \\cos\\left(\\frac{\\pi x}{L}\\right)$，其中 $\\beta>0$ 且 $U_0>0$。\n- 正压输运流函数 $\\psi(x,y)$：垂直积分的水平输运为 $U(x,y) = -\\partial \\psi/\\partial y$ 和 $V(x,y) = \\partial \\psi/\\partial x$。\n- 边界条件：在 $x=0$ 和 $x=L$ 处无垂向流动。东边界参考值为 $\\psi(L,y)=0$。\n\n### 步骤2：使用已知条件进行验证\n- **科学依据**：该问题是物理海洋学中的一个经典习题，基于成熟的斯韦尔德鲁普平衡（Sverdrup balance）理论。控制方程、β平面的概念、埃克曼抽吸（Ekman pumping）和正压流函数都是地球物理流体动力学的基本原理。该问题的设定在科学上是合理的。\n- **适定性**：问题要求推导斯韦尔德鲁普关系，并在给定风强迫和边界条件下求解。斯韦尔德鲁普平衡方程是关于$x$的一阶微分方程，可以通过积分求解。问题提供了一个边界条件$\\psi(L,y)=0$来确定积分常数，这使得内部解的问题是适定的。斯韦尔德鲁普内部解并不期望满足封闭海盆的所有边界条件（特别是在西边界），但问题正确地聚焦于内部动力学，并提供了一个有效的东边界条件。\n- **客观性**：问题陈述没有主观性语言，并使用了该领域精确、标准的术语。\n\n### 步骤3：结论与行动\n问题是有效的。我们将继续进行求解。\n\n海洋内部动力学的出发点是β平面上稳态、线性的涡度方程。对于无粘性的正压流体，平衡关系存在于行星涡度的平流和涡旋拉伸之间。这表示为：\n$$\n\\beta v = f \\frac{\\partial w}{\\partial z}\n$$\n其中$v$是经向速度，$w$是垂直速度，$f$是科里奥利参数，$\\beta = df/dy$是$f$的恒定经向梯度。\n\n我们将此方程在整个水柱上进行垂直积分，从海底$z=-H$到我们近似为$z=0$的海面：\n$$\n\\int_{-H}^{0} \\beta v \\, dz = \\int_{-H}^{0} f \\frac{\\partial w}{\\partial z} \\, dz\n$$\n由于在此模型中$\\beta$和$f$与深度无关，我们可以写出：\n$$\n\\beta \\int_{-H}^{0} v \\, dz = f \\int_{-H}^{0} \\frac{\\partial w}{\\partial z} \\, dz\n$$\n垂直积分的经向输运定义为 $V = \\int_{-H}^{0} v \\, dz$。垂直速度梯度的积分为：\n$$\n\\int_{-H}^{0} \\frac{\\partial w}{\\partial z} \\, dz = w(0) - w(-H)\n$$\n在平坦的海底$z=-H$处，垂直速度必须为零，所以$w(-H)=0$。在海面$z=0$处，垂直速度$w(0)$是由表面风应力引起的速度，称为埃克曼抽吸速度$w_E$。因此，积分后的涡度平衡变为：\n$$\n\\beta V = f w_E\n$$\n埃克曼抽吸速度$w_E$与风应力旋度$\\boldsymbol{\\tau}$的关系为：\n$$\nw_E = \\frac{1}{\\rho_0 f} \\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_z\n$$\n其中$\\rho_0$是水的恒定密度。将$w_E$的这个表达式代入涡度平衡方程，得到：\n$$\n\\beta V = f \\left( \\frac{1}{\\rho_0 f} \\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_z \\right)\n$$\n科里奥利参数$f$被消去，从而得到斯韦尔德鲁普平衡关系，该关系将内部经向输运与风应力旋度直接联系起来：\n$$\n\\beta V = \\frac{1}{\\rho_0} \\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_z\n$$\n这就是问题所要求的内部关系。\n\n现在，我们利用给定的风应力旋度来求解正压流函数$\\psi(x,y)$。垂直积分的经向输运$V$与$\\psi$的关系为$V = \\partial \\psi/\\partial x$。将此关系以及给定的风应力旋度表达式$\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_z = \\rho_0 \\, \\beta \\, U_0 \\, \\cos\\left(\\frac{\\pi x}{L}\\right)$代入斯韦尔德鲁普平衡方程：\n$$\n\\beta \\frac{\\partial \\psi}{\\partial x} = \\frac{1}{\\rho_0} \\left( \\rho_0 \\, \\beta \\, U_0 \\, \\cos\\left(\\frac{\\pi x}{L}\\right) \\right)\n$$\n方程两边的$\\rho_0$和$\\beta$项被消去，得到一个关于$\\psi$在$x$方向上的简单常微分方程：\n$$\n\\frac{\\partial \\psi}{\\partial x} = U_0 \\cos\\left(\\frac{\\pi x}{L}\\right)\n$$\n我们对该方程关于$x$进行积分，从东边界$x=L$积到一个任意内部点$x$：\n$$\n\\int_L^x \\frac{\\partial \\psi}{\\partial \\xi} d\\xi = \\int_L^x U_0 \\cos\\left(\\frac{\\pi \\xi}{L}\\right) d\\xi\n$$\n$$\n\\psi(x,y) - \\psi(L,y) = U_0 \\left[ \\frac{L}{\\pi} \\sin\\left(\\frac{\\pi \\xi}{L}\\right) \\right]_L^x\n$$\n$$\n\\psi(x,y) - \\psi(L,y) = U_0 \\frac{L}{\\pi} \\left( \\sin\\left(\\frac{\\pi x}{L}\\right) - \\sin\\left(\\frac{\\pi L}{L}\\right) \\right)\n$$\n$$\n\\psi(x,y) - \\psi(L,y) = U_0 \\frac{L}{\\pi} \\left( \\sin\\left(\\frac{\\pi x}{L}\\right) - \\sin(\\pi) \\right)\n$$\n由于$\\sin(\\pi) = 0$，上式简化为：\n$$\n\\psi(x,y) - \\psi(L,y) = \\frac{U_0 L}{\\pi} \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n问题指定了东边界条件$\\psi(L,y) = 0$。应用此条件：\n$$\n\\psi(x,y) - 0 = \\frac{U_0 L}{\\pi} \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n因此，海洋内部的正压输运流函数为：\n$$\n\\psi(x,y) = \\frac{U_0 L}{\\pi} \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n我们注意到，问题还陈述了在纬向边界$x=0$和$x=L$处的无垂向流动条件。垂向流动即为纬向输运$U$。我们检查我们的解是否满足此条件：\n$$\nU(x,y) = -\\frac{\\partial \\psi}{\\partial y} = -\\frac{\\partial}{\\partial y} \\left( \\frac{U_0 L}{\\pi} \\sin\\left(\\frac{\\pi x}{L}\\right) \\right) = 0\n$$\n由于得到的流函数与$y$无关，因此在斯韦尔德鲁普内部，纬向输运$U$处处为零。这恰好满足了在$x=0$和$x=L$处的无垂向流动条件$U=0$。这是风应力旋度与$y$无关所带来的一个特殊结果。该解是完整的，并且与所有给定的内部流动约束条件一致。",
            "answer": "$$\\boxed{\\frac{U_0 L}{\\pi} \\sin\\left(\\frac{\\pi x}{L}\\right)}$$"
        },
        {
            "introduction": "斯韦尔德鲁普平衡描述的是一种定常状态，但海洋在风场变化后是如何达到这种平衡的呢？答案在于缓慢向西传播的罗斯贝波。这个计算练习将让您通过模拟一个扰动如何跨越海盆传播，来仿真这一调整过程，从而为您提供一个关于内部环流建立过程的动态视角 。",
            "id": "3812746",
            "problem": "考虑一个中纬度海洋盆地对脉冲性风应力旋度事件的内部调整，重点关注向西传播的斜压罗斯贝波以及相关的Sverdrup内部平衡的出现。使用一个沿经度方向（东西方向）的一维纬向模型，纬向坐标表示为 $x \\in [0, L_x]$，西边界位于 $x=0$。假设罗斯贝数很小，动力学是线性的，并且具有beta平面上第一斜压模典型的长纬向尺度。从旋转浅水动力学、静力平衡、地转平衡和准地转位涡守恒的有效基本基础出发。基于这些基础，推导适用于斜压罗斯贝波西传的长波极限，以及相应的有效一维演化方程，用于在 $t=0$ 时刻进行脉冲性风事件的数值起旋实验。\n\n您的程序必须：\n- 为推导出的演化方程实现一个一维纬向有限差分解算器，使用带有Courant–Friedrichs–Lewy (CFL)控制的适当稳定数值格式。\n- 通过一个初始条件 $a(x,0)$ 来表示脉冲性风强迫，该初始条件是一个中心位于 $x_0$、振幅为 $A_0$、宽度为 $\\sigma$ 的高斯包络，其中 $a(x,t)$ 表示您推导的长波近似所对应的演化标量场。\n- 传播信号并随时间追踪西边界处的振幅 $a(0,t)$。将 $a(0,t)$ 达到最大值的时间估计为数值到达时间。同时，根据推导出的长波传播速度以及初始中心到西边界的距离，计算理论到达时间。\n- 所有到达时间均以天为单位表示。使用每天 $86400$ 秒的转换因子。\n\n科学真实性要求：\n- 使用与中纬度海洋一致的参数值：背景科里奥利参数 $f_0$、行星涡度梯度 (beta) $\\beta$、第一斜压变形半径 $R_d$ 和盆地宽度 $L_x$。将脉冲性风事件仅视为提供初始条件；没有后续强迫。\n\n测试套件：\n对以下所有参数集运行程序。对于每种情况，设置高斯宽度为 $\\sigma = \\gamma L_x$ (其中 $\\gamma = 0.06$)，振幅 $A_0 = 1.0$ (无量纲)，并使用CFL数为 $0.8$ 的迎风格式。网格在 $[0, L_x]$ 上使用 $N_x$ 个均匀间隔的点。\n\n- 案例1 (理想路径，中纬度，中等盆地):\n  - $L_x = 3.0 \\times 10^6$ 米,\n  - $R_d = 4.0 \\times 10^4$ 米,\n  - $\\beta = 2.0 \\times 10^{-11}$ 米$^{-1}$ 秒$^{-1}$,\n  - $f_0 = 1.0 \\times 10^{-4}$ 秒$^{-1}$,\n  - $x_0 = 0.8 L_x$,\n  - $N_x = 401$。\n\n- 案例2 (较小盆地，较快调整):\n  - $L_x = 5.0 \\times 10^5$ 米,\n  - $R_d = 3.0 \\times 10^4$ 米,\n  - $\\beta = 2.0 \\times 10^{-11}$ 米$^{-1}$ 秒$^{-1}$,\n  - $f_0 = 1.0 \\times 10^{-4}$ 秒$^{-1}$,\n  - $x_0 = 0.9 L_x$,\n  - $N_x = 301$。\n\n- 案例3 (大盆地，缓慢调整):\n  - $L_x = 4.0 \\times 10^6$ 米,\n  - $R_d = 2.0 \\times 10^4$ 米,\n  - $\\beta = 2.0 \\times 10^{-11}$ 米$^{-1}$ 秒$^{-1}$,\n  - $f_0 = 1.0 \\times 10^{-4}$ 秒$^{-1}$,\n  - $x_0 = 0.75 L_x$,\n  - $N_x = 501$。\n\n对于每个测试案例，您的程序必须：\n- 从所述基础中推导出长波西传速度，并计算理论到达时间 $T_{\\mathrm{th}}$，即从 $x_0$ 到西边界的距离除以传播速度的大小。\n- 进行数值积分，直到至少是理论到达时间的 $1.5$ 倍，以确保捕捉到边界处的峰值。将 $a(0,t)$ 达到其最大值的时间估计为数值到达时间 $T_{\\mathrm{num}}$。\n- 通过除以 $86400$ 将 $T_{\\mathrm{num}}$ 和 $T_{\\mathrm{th}}$ 从秒转换为天。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于每种情况，输出两个以天为单位的浮点数：首先是 $T_{\\mathrm{num}}$，然后是 $T_{\\mathrm{th}}$。按顺序连接三个案例的结果。例如，输出应如下所示：\n$[T_{\\mathrm{num,1}},T_{\\mathrm{th,1}},T_{\\mathrm{num,2}},T_{\\mathrm{th,2}},T_{\\mathrm{num,3}},T_{\\mathrm{th,3}}]$。",
            "solution": "所提出的问题是计算物理海洋学中一个有效且适定的练习。它要求推导并数值求解长斜压罗斯贝波的控制方程，这是海洋盆地中信息向西传播的物理机制，最终导致在风强迫变化后建立Sverdrup内部平衡。所提供的参数在科学上是现实的，数值任务也定义明确。\n\n推导始于β平面上单个斜压模的无强迫、线性化的准地转位涡(QG PV)方程。地转流函数异常 $\\psi(x, y, t)$ 的演化由下式给出：\n$$\n\\frac{\\partial q}{\\partial t} + \\beta v = 0\n$$\n此处，$q$ 是位涡异常，$v$ 是经向地转速度，$\\beta$ 是假定为常数的行星涡度梯度。对于第一斜压模，位涡异常 $q$ 和经向速度 $v$ 通过以下关系与流函数 $\\psi$ 相关联：\n$$\nq = \\nabla^2\\psi - \\frac{1}{R_d^2}\\psi\n\\qquad \\text{和} \\qquad\nv = \\frac{\\partial \\psi}{\\partial x}\n$$\n其中 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 是水平拉普拉斯算子，$R_d$ 是第一斜压罗斯贝变形半径。科里奥利参数 $f_0$ 是构建此扰动理论的背景态的一部分，但它不显式出现在最终的长波方程中。将这些关系代入QG PV方程，得到：\n$$\n\\frac{\\partial}{\\partial t}\\left( \\frac{\\partial^2\\psi}{\\partial x^2} + \\frac{\\partial^2\\psi}{\\partial y^2} - \\frac{\\psi}{R_d^2} \\right) + \\beta \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n为确定传播特性，我们寻找形式为 $\\psi(x,y,t) = \\hat{\\psi} e^{i(kx + ly - \\omega t)}$ 的平面波解，其中 $k$ 和 $l$ 分别是纬向和经向波数，$\\omega$ 是频率。将此代入偏微分方程(PDE)得到斜压罗斯贝波的色散关系：\n$$\n-i\\omega \\left( -k^2 - l^2 - \\frac{1}{R_d^2} \\right) + i\\beta k = 0\n$$\n$$\n\\omega \\left( k^2 + l^2 + \\frac{1}{R_d^2} \\right) = -\\beta k\n$$\n$$\n\\omega = -\\frac{\\beta k}{k^2 + l^2 + R_d^{-2}}\n$$\n问题指定了一个一维纬向模型和长波极限。在此背景下，“长波”指的是行星尺度的运动，其波长远大于罗斯贝变形半径。这对应于波数很小的极限，即 $k^2+l^2 \\ll R_d^{-2}$。此外，纯一维纬向模型意味着在经向上没有变化，因此我们设 $l=0$。色散关系随后显著简化为：\n$$\n\\omega \\approx -\\frac{\\beta k}{R_d^{-2}} = -(\\beta R_d^2) k\n$$\n这是一个形式为 $\\omega = c k$ 的线性色散关系，表明这些波是非频散的。相速度 $c_p = \\omega/k$ 和群速度 $c_g = \\partial\\omega/\\partial k$ 相等：\n$$\nc_p = c_g = c = -\\beta R_d^2\n$$\n负号证实了这些波严格向西（负 $x$ 方向）以恒定速度传播，其大小为 $c_R = \\beta R_d^2$。受这种非频散动力学控制的任何任意波形在传播时都不会改变形状。\n\n描述一个场 $a(x,t)$ 以速度 $u$ 进行非频散传播的一般偏微分方程是一维线性平流方程：\n$$\n\\frac{\\partial a}{\\partial t} + u \\frac{\\partial a}{\\partial x} = 0\n$$\n代入我们推导出的波速 $u = c = -\\beta R_d^2 = -c_R$，我们得到该问题的控制演化方程：\n$$\n\\frac{\\partial a}{\\partial t} - c_R \\frac{\\partial a}{\\partial x} = 0\n$$\n其中 $a(x,t)$ 可以被视作流函数 $\\psi$ 或一个与之成比例的量，$c_R = \\beta R_d^2$ 是正定的西传速度。这个方程的解的形式为 $a(x,t) = F(x+c_R t)$，代表一个向负x方向（西向）传播的波形。脉冲性风事件的问题通过设置初始条件 $a(x,0)$ 并求解此偏微分方程（对于 $t>0$）来建模。\n\n对于数值解，我们在一个间距为 $\\Delta x = L_x / (N_x - 1)$ 的均匀网格上使用有限差分法，并采用固定的时间步长 $\\Delta t$。该演化方程描述了速度为 $-c_R$ 的平流。合适的稳定格式是一阶迎风法。对于负速度，这对应于用向前差分离散化空间导数：\n$$\n\\frac{a_i^{n+1} - a_i^n}{\\Delta t} - c_R \\left( \\frac{a_{i+1}^n - a_i^n}{\\Delta x} \\right) = 0\n$$\n其中 $a_i^n \\approx a(i\\Delta x, n\\Delta t)$。为下一时间步 $a_i^{n+1}$ 重新整理，得到更新规则：\n$$\na_i^{n+1} = a_i^n + \\frac{c_R \\Delta t}{\\Delta x} (a_{i+1}^n - a_i^n)\n$$\n定义 Courant–Friedrichs–Lewy (CFL) 数 $C_{cfl} = \\frac{c_R \\Delta t}{\\Delta x}$，格式为：\n$$\na_i^{n+1} = (1 - C_{cfl}) a_i^n + C_{cfl} a_{i+1}^n\n$$\n该格式在 $0 \\le C_{cfl} \\le 1$ 时稳定。问题指定 $C_{cfl}=0.8$。因此时间步长 $\\Delta t$ 由 $\\Delta t = C_{cfl} \\Delta x / c_R$ 确定。\n\n计算域为 $x \\in [0, L_x]$。由于传播是向西的，位于 $x=L_x$ 的东边界是流入边界。我们施加一个零扰动条件，$a(L_x, t) = 0$。位于 $x=0$ 的西边界是流出边界，其值由内部点的数值格式确定，不需要显式边界条件。初始状态是一个高斯脉冲，$a(x,0) = A_0 \\exp(-\\frac{(x - x_0)^2}{2\\sigma^2})$。\n\n理论到达时间 $T_{\\mathrm{th}}$ 是初始扰动的峰值从 $x_0$ 以长波速度 $c_R$ 传播到西边界 $x=0$ 所需的时间：\n$$\nT_{\\mathrm{th}} = \\frac{x_0}{c_R} = \\frac{x_0}{\\beta R_d^2}\n$$\n数值到达时间 $T_{\\mathrm{num}}$ 通过模拟 $a(x,t)$ 的演化并记录西边界振幅 $a(0,t)$ 达到其最大值的时间来找到。两个时间都通过除以 $86400$ 从秒转换为天。每个案例的模拟运行到 $t = 1.5 T_{\\mathrm{th}}$，以确保峰值完全通过边界。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D Rossby wave advection problem for three test cases.\n    \n    The code derives the long-wave propagation speed, computes theoretical\n    and numerical arrival times of a Gaussian pulse at the western boundary\n    of an ocean basin.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case 1 (mid-latitude, moderate basin)\",\n            \"Lx\": 3.0e6,      # Basin width (m)\n            \"Rd\": 4.0e4,      # Deformation radius (m)\n            \"beta\": 2.0e-11,  # Planetary vorticity gradient (m^-1 s^-1)\n            \"f0\": 1.0e-4,     # Coriolis parameter (s^-1) - not used in long-wave speed\n            \"x0_factor\": 0.8, # Factor for initial pulse center\n            \"Nx\": 401,        # Number of grid points\n        },\n        {\n            \"name\": \"Case 2 (smaller basin, faster adjustment)\",\n            \"Lx\": 5.0e5,\n            \"Rd\": 3.0e4,\n            \"beta\": 2.0e-11,\n            \"f0\": 1.0e-4,\n            \"x0_factor\": 0.9,\n            \"Nx\": 301,\n        },\n        {\n            \"name\": \"Case 3 (large basin, slow adjustment)\",\n            \"Lx\": 4.0e6,\n            \"Rd\": 2.0e4,\n            \"beta\": 2.0e-11,\n            \"f0\": 1.0e-4,\n            \"x0_factor\": 0.75,\n            \"Nx\": 501,\n        }\n    ]\n    \n    # Shared parameters\n    gamma = 0.06      # Factor for Gaussian width\n    A0 = 1.0          # Initial amplitude (dimensionless)\n    CFL = 0.8         # Courant-Friedrichs-Lewy number\n    SEC_PER_DAY = 86400.0\n\n    results = []\n\n    for case in test_cases:\n        # Extract parameters for the current case\n        Lx = case[\"Lx\"]\n        Rd = case[\"Rd\"]\n        beta = case[\"beta\"]\n        x0_factor = case[\"x0_factor\"]\n        Nx = case[\"Nx\"]\n\n        # --- Theoretical Calculations ---\n        \n        # Long-wave Rossby wave speed (westward propagation magnitude)\n        c_R = beta * Rd**2\n        \n        # Initial pulse position\n        x0 = x0_factor * Lx\n        \n        # Theoretical arrival time in seconds\n        T_th_sec = x0 / c_R\n        \n        # Theoretical arrival time in days\n        T_th_days = T_th_sec / SEC_PER_DAY\n\n        # --- Numerical Setup ---\n        \n        # Spatial grid\n        dx = Lx / (Nx - 1)\n        x = np.linspace(0, Lx, Nx)\n        \n        # Time step from CFL condition\n        dt = CFL * dx / c_R\n        \n        # Total simulation time\n        T_end = 1.5 * T_th_sec\n        num_steps = int(np.ceil(T_end / dt))\n        \n        # --- Initial Condition ---\n        \n        # Gaussian pulse width\n        sigma = gamma * Lx\n        \n        # Initial field a(x, 0)\n        a = A0 * np.exp(-((x - x0)**2) / (2 * sigma**2))\n        \n        # --- Numerical Integration (Upwind Scheme) ---\n        \n        # Store the history of the amplitude at the western boundary (x=0)\n        a_boundary_history = np.zeros(num_steps + 1)\n        a_boundary_history[0] = a[0]\n        \n        a_old = np.copy(a)\n        a_new = np.zeros_like(a)\n\n        for n in range(num_steps):\n            # Apply the first-order upwind scheme for negative velocity\n            # a_i^{n+1} = (1 - C) * a_i^n + C * a_{i+1}^n\n            # This is vectorized for indices i = 0 to Nx-2\n            a_new[0:Nx-1] = (1 - CFL) * a_old[0:Nx-1] + CFL * a_old[1:Nx]\n            \n            # Apply boundary condition at the eastern (inflow) boundary\n            a_new[Nx-1] = 0.0\n\n            # Update the field for the next iteration\n            a_old[:] = a_new[:]\n            \n            # Record the amplitude at the western boundary\n            a_boundary_history[n + 1] = a_old[0]\n            \n        # --- Post-processing ---\n        \n        # Find the time of the maximum amplitude at the western boundary\n        peak_index = np.argmax(a_boundary_history)\n        T_num_sec = peak_index * dt\n        \n        # Numerical arrival time in days\n        T_num_days = T_num_sec / SEC_PER_DAY\n        \n        results.append(T_num_days)\n        results.append(T_th_days)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}