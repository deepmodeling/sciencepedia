{
    "hands_on_practices": [
        {
            "introduction": "在分析埃克曼层内的流动之前，我们必须首先了解其特征垂直尺度。这个尺度，即埃克曼深度，决定了风的影响能穿透到海洋内部多远。这项练习  将引导你通过标度分析，直观地理解埃克曼层厚度如何依赖于旋转和粘性。随后，通过计算一个具体数值，你将巩固对控制埃克曼螺线这一基本方面的物理平衡的理解。",
            "id": "3791540",
            "problem": "考虑一个均质海洋上由表面均匀风应力驱动的稳定、水平均匀的海洋埃克曼边界层 (EBL)。假设湍流可以通过一个恒定的涡粘性系数 $A$ 进行参数化，并且在旋转坐标系中，主导的水平动量平衡是科里奥利加速度与垂直湍流应力散度之间的平衡。设科里奥利参数为 $f=2\\,\\Omega\\,\\sin\\phi$，其中 $\\Omega$ 是地球的自转速率，$\\phi$ 是纬度。\n\n从旋转坐标系的动量方程和垂直湍流应力的恒定涡粘性闭合方案出发，利用标度分析推导特征 EBL 厚度 $\\delta$ 对 $A$ 和 $|f|$ 的依赖关系，并证明 $\\delta$ 随 $A$ 的增加而增加，随 $|f|$ 的增加而减小。然后，采用恒定涡粘性系数的埃克曼螺线中水平速度大小的 e-折叠深度作为层厚的业务定义，计算在纬度 $\\phi=45^{\\circ}$ 时，当 $A=0.05\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 和 $\\Omega=7.2921159\\times 10^{-5}\\,\\mathrm{s}^{-1}$ 时的 $\\delta$ 值。以米为单位表示最终厚度，并将答案四舍五入至四位有效数字。在你的推导中，任何内部角度请使用弧度制，并按照惯例，在北半球取 $f0$。",
            "solution": "对于旋转坐标系中稳定、水平均匀的流动，设 $z$ 从海面向上为正，其水平动量方程由科里奥利力与垂直湍流应力散度之间的平衡给出。设 $u$ 和 $v$ 分别是 $x$ 和 $y$ 方向的速度分量。方程为：\n$$ -fv = \\frac{\\partial}{\\partial z}\\left(A \\frac{\\partial u}{\\partial z}\\right) $$\n$$ fu = \\frac{\\partial}{\\partial z}\\left(A \\frac{\\partial v}{\\partial z}\\right) $$\n由于涡粘性系数 $A$ 假定为常数，这些方程简化为：\n$$ -fv = A \\frac{\\partial^2 u}{\\partial z^2} $$\n$$ fu = A \\frac{\\partial^2 v}{\\partial z^2} $$\n\n首先，我们进行标度分析，以确定埃克曼层的特征厚度 $\\delta$ 如何依赖于 $A$ 和 $|f|$。设 $U$ 为特征水平速度标度，$\\delta$ 为特征垂直长度标度。动量方程中的各项可以按如下方式进行标度：\n-   科里奥利项：$|f|U$\n-   湍流应力项：$A \\frac{U}{\\delta^2}$\n\n埃克曼层的核心动力学是这两项之间的平衡。令它们的标度相等，可得：\n$$ |f|U \\sim \\frac{A U}{\\delta^2} $$\n速度标度 $U$ 消去，得到长度标度 $\\delta$ 的关系式：\n$$ |f| \\sim \\frac{A}{\\delta^2} \\implies \\delta^2 \\sim \\frac{A}{|f|} $$\n$$ \\delta \\sim \\sqrt{\\frac{A}{|f|}} $$\n该标度律表明，埃克曼层厚度 $\\delta$ 与涡粘性系数 $A$ 的平方根成正比，与科里奥利参数 $|f|$ 大小的平方根成反比。因此，$\\delta$ 随 $A$ 的增加而增加（更强的垂直混合使层加深），并随 $|f|$ 的增加而减小（更强的旋转将流动限制在更浅的层中）。这完成了任务的前两个部分。\n\n接下来，我们求解精确解以确定 e-折叠深度。我们将两个动量方程组合成一个关于复速度 $w(z) = u(z) + iv(z)$ 的单一方程。将第二个动量方程乘以 $i$ 并加到第一个方程上，得到：\n$$ -fv + i(fu) = A \\frac{\\partial^2 u}{\\partial z^2} + i\\left(A \\frac{\\partial^2 v}{\\partial z^2}\\right) $$\n$$ if(u+iv) = A \\frac{\\partial^2}{\\partial z^2}(u+iv) $$\n$$ \\frac{d^2 w}{dz^2} - \\frac{if}{A} w = 0 $$\n这是一个二阶线性齐次常微分方程。其特征方程为 $r^2 - \\frac{if}{A} = 0$，因此 $r = \\pm\\sqrt{\\frac{if}{A}}$。\n对于北半球情况（$f  0$），我们有 $\\sqrt{i} = \\frac{1+i}{\\sqrt{2}}$。因此，根为：\n$$ r = \\pm \\sqrt{\\frac{f}{A}} \\frac{1+i}{\\sqrt{2}} = \\pm \\frac{1+i}{\\sqrt{2A/f}} $$\n我们定义埃克曼深度标度 $d_E = \\sqrt{2A/|f|}$。对于 $f0$，$d_E = \\sqrt{2A/f}$。根变为 $r = \\pm \\frac{1+i}{d_E}$。\n通解为：\n$$ w(z) = C_1 \\exp\\left(\\frac{(1+i)z}{d_E}\\right) + C_2 \\exp\\left(-\\frac{(1+i)z}{d_E}\\right) $$\n我们应用边界条件。在海洋深处，当 $z \\to -\\infty$ 时，风生流必须消失，所以 $w(z) \\to 0$。项 $\\exp\\left(-\\frac{(1+i)z}{d_E}\\right) = \\exp\\left(-\\frac{z}{d_E}\\right)\\exp\\left(-\\frac{iz}{d_E}\\right)$ 在 $z \\to -\\infty$ 时呈指数增长（因为 $-z/d_E  0$）。为满足边界条件，其系数必须为零，所以 $C_2=0$。\n解的形式为 $w(z) = C_1 \\exp\\left(\\frac{(1+i)z}{d_E}\\right)$。常数 $C_1$ 由表面（$z=0$）的风应力确定，但对于确定速度大小的 e-折叠深度而言，它是不必要的。\n\n复速度的大小为：\n$$ |w(z)| = \\left| C_1 \\exp\\left(\\frac{(1+i)z}{d_E}\\right) \\right| = |C_1| \\left| \\exp\\left(\\frac{z}{d_E}\\right) \\exp\\left(\\frac{iz}{d_E}\\right) \\right| $$\n因为对于任何实数 $\\theta$，都有 $|\\exp(i\\theta)|=1$，所以上式简化为：\n$$ |w(z)| = |C_1| \\exp\\left(\\frac{z}{d_E}\\right) $$\n在表面（$z=0$），速度大小为 $|w(0)| = |C_1|$。因此，在任何深度 $z \\le 0$ 处，速度大小为 $|w(z)| = |w(0)|\\exp(z/d_E)$。\n\n问题将埃克曼层厚度 $\\delta$ 定义为水平速度大小的 e-折叠深度。这是指速度大小减小到其表面值的 $1/e$ 时的深度 $h = -z  0$。\n$$ |w(-h)| = \\frac{1}{e} |w(0)| $$\n使用我们的解：\n$$ |w(0)|\\exp\\left(\\frac{-h}{d_E}\\right) = \\frac{1}{e} |w(0)| = |w(0)|\\exp(-1) $$\n比较指数，我们发现：\n$$ \\frac{-h}{d_E} = -1 \\implies h = d_E $$\n因此，埃克曼层厚度的业务定义是 $\\delta = h = d_E$。根据我们对 $d_E$ 的定义，我们有：\n$$ \\delta = \\sqrt{\\frac{2A}{|f|}} $$\n这个解析结果与我们的标度分析一致，只是多了一个 $\\sqrt{2}$ 的前置因子。\n\n最后，我们根据给定的值计算 $\\delta$。\n给定：$A = 0.05\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\phi = 45^{\\circ}$，以及 $\\Omega = 7.2921159 \\times 10^{-5}\\,\\mathrm{s}^{-1}$。\n首先，计算科里奥利参数 $f$。由于纬度为 $45^{\\circ}$，并且我们约定 $f0$，我们使用北半球的 $\\phi=45^{\\circ}$。\n$$ f = 2 \\Omega \\sin\\phi = 2 \\times (7.2921159 \\times 10^{-5}\\,\\mathrm{s}^{-1}) \\times \\sin(45^{\\circ}) $$\n使用 $\\sin(45^{\\circ}) = \\frac{\\sqrt{2}}{2}$：\n$$ f = 2 \\times (7.2921159 \\times 10^{-5}\\,\\mathrm{s}^{-1}) \\times \\frac{\\sqrt{2}}{2} = \\sqrt{2} \\times 7.2921159 \\times 10^{-5}\\,\\mathrm{s}^{-1} $$\n$$ f \\approx 1.0312546 \\times 10^{-4}\\,\\mathrm{s}^{-1} $$\n现在我们可以计算埃克曼层厚度 $\\delta$：\n$$ \\delta = \\sqrt{\\frac{2A}{f}} = \\sqrt{\\frac{2 \\times 0.05\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}}{1.0312546 \\times 10^{-4}\\,\\mathrm{s}^{-1}}} $$\n$$ \\delta = \\sqrt{\\frac{0.1}{1.0312546 \\times 10^{-4}}}\\,\\mathrm{m} \\approx \\sqrt{969.69183}\\,\\mathrm{m} $$\n$$ \\delta \\approx 31.1400358\\,\\mathrm{m} $$\n四舍五入到四位有效数字，我们得到 $\\delta = 31.14\\,\\mathrm{m}$。",
            "answer": "$$ \\boxed{31.14} $$"
        },
        {
            "introduction": "埃克曼螺线最重要的宏观效应，并非其复杂的流速廓线本身，而是它所产生的净、深度积分的水体输运，即埃克曼输运。这种输运是理解风生大洋环流的基石。在这个练习中 ，你将直接从动量方程出发，推导埃克曼输运矢量。此练习揭示了一个重要结论：净输运量独立于未知的湍流参数，并且其方向（在北半球）垂直于风应力方向，并向右偏转$90^{\\circ}$。",
            "id": "3791577",
            "problem": "考虑一个稳定的、水平均匀的、半无限深度的海洋边界层，它占据 $z \\le 0$ 的区域，自由表面位于 $z=0$，且 $z$ 轴向上为正。假设涡黏性系数 $A_z$ 为常数，海水密度 $\\rho=1025\\,\\mathrm{kg\\,m}^{-3}$ 为常数。设水平速度场为 $\\boldsymbol{u}(z)=(u(z),v(z))$，在一个笛卡尔坐标系中，$x$ 轴指向东，$y$ 轴指向北。湍流动量通量（应力）为 $\\boldsymbol{\\tau}(z)=(\\tau_x(z),\\tau_y(z))$，并满足本构关系 $\\boldsymbol{\\tau}(z)=\\rho A_z \\,\\partial \\boldsymbol{u}/\\partial z$。科里奥利参数为 $f$，流动由施加在自由表面的均匀风应力 $\\boldsymbol{\\tau}(0)=\\boldsymbol{\\tau}_a$ 驱动，深处没有应力传递，即 $\\lim_{z\\to -\\infty}\\boldsymbol{\\tau}(z)=\\boldsymbol{0}$。忽略边界层内的水平气压梯度和任何斜压效应。\n\n从稳定的水平动量平衡方程（该方程将科里奥利加速度与湍流应力的垂直散度相等）出发，并利用上述边界条件，推导深度积分的埃克曼输送矢量 $\\boldsymbol{M}_E=\\displaystyle\\int_{-\\infty}^{0}\\boldsymbol{u}(z)\\,\\mathrm{d}z$，用表面应力 $\\boldsymbol{\\tau}_a$、海水密度 $\\rho$ 和科里奥利参数 $f$ 来表示。然后，对于特定情况 $\\boldsymbol{\\tau}_a=(0.1\\,\\mathrm{N\\,m}^{-2},\\,0)$ 和 $f=10^{-4}\\,\\mathrm{s}^{-1}$，计算 $\\boldsymbol{M}_E$ 的大小和方向。$\\boldsymbol{M}_E$ 的方向是从正东轴逆时针测量的弧度角，主值取在 $[0,2\\pi)$ 区间内。大小以 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 为单位表示，并将大小四舍五入至三位有效数字。以精确形式给出角度。",
            "solution": "问题陈述指出，稳定的水平动量平衡将科里奥利加速度与湍流应力的垂直散度相等。单位质量的科里奥利力由 $\\boldsymbol{f_c} = \\boldsymbol{f} \\times \\boldsymbol{u}$ 给出，其中 $\\boldsymbol{f}=(0,0,f)$ 是科里奥利矢量，$\\boldsymbol{u}=(u,v,0)$ 是水平速度。单位体积的应力散度力是 $\\nabla \\cdot \\boldsymbol{\\mathcal{T}}$，其中 $\\boldsymbol{\\mathcal{T}}$ 是应力张量。对于水平均匀的流动，这简化为 $\\frac{\\partial \\boldsymbol{\\tau}}{\\partial z}$，其中 $\\boldsymbol{\\tau}$ 是水平应力矢量。因此，动量平衡为 $\\rho(\\boldsymbol{f} \\times \\boldsymbol{u}) = \\frac{\\partial \\boldsymbol{\\tau}}{\\partial z}$。\n\n用分量形式写出：\n$\\boldsymbol{f} \\times \\boldsymbol{u} = (0,0,f) \\times (u,v,0) = (-fv, fu, 0)$。\n动量方程是：\n$$ - \\rho f v = \\frac{\\partial \\tau_x}{\\partial z} $$\n$$ \\rho f u = \\frac{\\partial \\tau_y}{\\partial z} $$\n\n埃克曼输送矢量 $\\boldsymbol{M}_E$ 定义为深度积分的速度：\n$$ \\boldsymbol{M}_E = (M_{Ex}, M_{Ey}) = \\left(\\int_{-\\infty}^{0} u(z)\\,\\mathrm{d}z, \\int_{-\\infty}^{0} v(z)\\,\\mathrm{d}z\\right) $$\n\n为了求出 $\\boldsymbol{M}_E$ 的分量，我们将动量方程对 $z$ 从 $-\\infty$ 到 $0$ 进行积分。\n\n首先，我们对 $y$ 方向的动量方程进行积分：\n$$ \\int_{-\\infty}^{0} \\rho f u(z) \\,\\mathrm{d}z = \\int_{-\\infty}^{0} \\frac{\\partial \\tau_y}{\\partial z} \\,\\mathrm{d}z $$\n由于 $\\rho$ 和 $f$ 是常数，我们可以将它们从左侧的积分中提出来。右侧可以用微积分基本定理进行求值。\n$$ \\rho f \\int_{-\\infty}^{0} u(z) \\,\\mathrm{d}z = \\left[ \\tau_y(z) \\right]_{-\\infty}^{0} $$\n$$ \\rho f M_{Ex} = \\tau_y(0) - \\lim_{z\\to-\\infty} \\tau_y(z) $$\n使用边界条件 $\\boldsymbol{\\tau}(0) = \\boldsymbol{\\tau}_a = (\\tau_{ax}, \\tau_{ay})$ 和 $\\lim_{z\\to -\\infty} \\boldsymbol{\\tau}(z) = \\boldsymbol{0}$，我们有：\n$$ \\rho f M_{Ex} = \\tau_{ay} - 0 $$\n$$ M_{Ex} = \\frac{\\tau_{ay}}{\\rho f} $$\n\n接下来，我们对 $x$ 方向的动量方程进行积分：\n$$ \\int_{-\\infty}^{0} -\\rho f v(z) \\,\\mathrm{d}z = \\int_{-\\infty}^{0} \\frac{\\partial \\tau_x}{\\partial z} \\,\\mathrm{d}z $$\n$$ -\\rho f \\int_{-\\infty}^{0} v(z) \\,\\mathrm{d}z = \\left[ \\tau_x(z) \\right]_{-\\infty}^{0} $$\n$$ -\\rho f M_{Ey} = \\tau_x(0) - \\lim_{z\\to-\\infty} \\tau_x(z) $$\n再次使用边界条件：\n$$ -\\rho f M_{Ey} = \\tau_{ax} - 0 $$\n$$ M_{Ey} = -\\frac{\\tau_{ax}}{\\rho f} $$\n\n组合各分量，埃克曼输送矢量为：\n$$ \\boldsymbol{M}_E = (M_{Ex}, M_{Ey}) = \\left(\\frac{\\tau_{ay}}{\\rho f}, -\\frac{\\tau_{ax}}{\\rho f}\\right) $$\n该表达式用表面应力 $\\boldsymbol{\\tau}_a$、密度 $\\rho$ 和科里奥利参数 $f$ 给出了埃克曼输送，符合题目要求。\n\n现在，我们针对给定的具体情况进行计算：\n$\\boldsymbol{\\tau}_a = (0.1\\,\\mathrm{N\\,m}^{-2},\\,0)$，这意味着 $\\tau_{ax} = 0.1\\,\\mathrm{N\\,m}^{-2}$ 和 $\\tau_{ay} = 0\\,\\mathrm{N\\,m}^{-2}$。\n$f = 10^{-4}\\,\\mathrm{s}^{-1}$。\n$\\rho = 1025\\,\\mathrm{kg\\,m}^{-3}$。\n\n埃克曼输送矢量的分量是：\n$$ M_{Ex} = \\frac{0}{\\rho f} = 0\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} $$\n$$ M_{Ey} = -\\frac{0.1\\,\\mathrm{N\\,m}^{-2}}{(1025\\,\\mathrm{kg\\,m}^{-3})(10^{-4}\\,\\mathrm{s}^{-1})} = -\\frac{0.1}{1025 \\times 10^{-4}}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} $$\n$$ M_{Ey} = -\\frac{0.1}{0.1025}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} \\approx -0.9756097... \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} $$\n所以，$\\boldsymbol{M}_E \\approx (0, -0.9756)\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n\n埃克曼输送的大小是：\n$$ |\\boldsymbol{M}_E| = \\sqrt{M_{Ex}^2 + M_{Ey}^2} = \\sqrt{0^2 + M_{Ey}^2} = |M_{Ey}| $$\n$$ |\\boldsymbol{M}_E| = \\frac{0.1}{0.1025}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} \\approx 0.9756097...\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} $$\n四舍五入到三位有效数字，大小为 $0.976\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n\n$\\boldsymbol{M}_E$ 的方向是它与正 $x$ 轴（东向）逆时针方向所成的角 $\\theta$。该矢量是 $\\boldsymbol{M}_E = (0, M_{Ey})$ 且 $M_{Ey}  0$。该矢量直接指向负 $y$ 轴（南向）。从正 $x$ 轴逆时针测量到负 $y$ 轴的角度是 $270^\\circ$。以弧度表示，这是：\n$$ \\theta = 270^\\circ \\times \\frac{\\pi}{180^\\circ} = \\frac{3\\pi}{2} $$\n该值在所要求的主值范围 $[0, 2\\pi)$ 内。问题要求以精确形式给出角度，即 $\\frac{3\\pi}{2}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.976  \\frac{3\\pi}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在真实海洋中，风应力并非均匀分布。风的空间变化导致埃克曼输运汇聚或辐散，从而在埃克曼层底部驱动垂直水流运动——这一过程被称为埃克曼抽吸。这是驱动大规模上升流和下降流的主要机制。这项总结性练习  通过让你编写程序计算埃克曼抽吸，将理论与实践联系起来。通过比较数值解（基于输运的散度）和解析解（基于风应力的旋度），你将验证这一关键的动力学联系，并获得计算海洋学中数值方法的实践经验。",
            "id": "3791570",
            "problem": "您将设计并实现一个程序，以两种独立的方法计算双周期矩形海洋域中的埃克曼抽吸（Ekman pumping）的垂直速度：(i) 数值方法：通过对从给定风应力场获得的深度积分埃克曼输送场进行微分；以及 (ii) 解析方法：通过从稳态、深度积分的动量和质量连续性定律推导表达式。目标是针对一小组给定的风应力场测试集，量化数值结果与解析结果之间的误差。\n\n从适用于计算海洋学的有效基本基础出发：包含风应力强迫和科里奥利加速度的稳态水平动量平衡，以及不可压缩流体的质量连续性方程。将海洋视为密度恒定的均匀流体，并假设埃克曼层相对于其他尺度是薄的，从而允许在埃克曼层上使用深度积分的输送公式。假设科里奥利参数是恒定的。使用一个在每个方向上都有均匀网格间距的二维（2D）双周期域。\n\n您必须：\n- 从稳态深度积分动量方程和质量连续性方程出发，推导出关于给定风应力场的埃克曼抽吸速度的解析表达式。不要使用预先记下的快捷公式；从第一性原理推导该表达式。\n- 实现一个数值方法，该方法：\n  1. 在域上构建给定的风应力场。\n  2. 使用稳态深度积分动量平衡，从风应力计算深度积分的埃克曼输送矢量场。\n  3. 使用中心差分和双向周期性边界条件，通过计算输送场的散度来计算数值埃克曼抽吸速度。\n  4. 通过对风应力场进行解析微分，为每个给定的风应力计算解析埃克曼抽吸速度。\n- 对每个测试用例，计算数值和解析埃克曼抽吸速度场之间的均方根误差。将这些误差以浮点数形式表示，单位为米每秒（$\\mathrm{m}\\,\\mathrm{s}^{-1}$）。\n\n域和离散化：\n- 域为矩形且双周期，在 $x$ 方向和 $y$ 方向上的长度分别为 $L_x$ 和 $L_y$（单位：$\\mathrm{m}$），在 $x$ 方向有 $N_x$ 个点、 $y$ 方向有 $N_y$ 个点的均匀网格上进行离散化。使用位于 $x_i = i\\,\\Delta x$ 和 $y_j = j\\,\\Delta y$ 的网格节点，其中 $i \\in \\{0,\\dots,N_x-1\\}$ 和 $j \\in \\{0,\\dots,N_y-1\\}$，且 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。将场视为在两个方向上都是周期的。\n\n物理和单位：\n- 密度 $\\rho$ 为恒定值，单位为千克每立方米（$\\mathrm{kg}\\,\\mathrm{m}^{-3}$）。\n- 科里奥利参数 $f$ 为恒定值，单位为每秒（$\\mathrm{s}^{-1}$）。\n- 风应力分量 $\\tau_x(x,y)$ 和 $\\tau_y(x,y)$ 的单位为牛顿每平方米（$\\mathrm{N}\\,\\mathrm{m}^{-2}$）。\n- 埃克曼输送分量必须根据动量平衡一致地计算，具有正确的矢量方向和单位。\n- 埃克曼抽吸速度 $w_E(x,y)$ 的单位为米每秒（$\\mathrm{m}\\,\\mathrm{s}^{-1}$）。\n- 三角函数中的角度以弧度为单位。\n\n数值微分：\n- 使用带有周期性边界条件的中心差分来近似 $\\partial/\\partial x$ 和 $\\partial/\\partial y$，以计算输送场的散度。对于网格上的场 $A(x_i,y_j)$，在 $(i,j)$ 点的 $\\partial A/\\partial x$ 可通过 $(A(i+1,j)-A(i-1,j))/(2\\,\\Delta x)$ 近似，使用周期性索引，$\\partial A/\\partial y$ 类似。\n\n测试集：\n对于下方的每个测试用例，构建风应力并计算所需的误差。使用所提供的确切值，包括单位。\n\n1. 在 $x$ 和 $y$ 方向具有不同周期性的平滑、不可分的三角函数风应力：\n   - $N_x = 101$, $N_y = 117$。\n   - $L_x = 1.0\\times 10^6\\ \\mathrm{m}$, $L_y = 0.8\\times 10^6\\ \\mathrm{m}$。\n   - $\\rho = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$。\n   - $\\tau_0 = 0.2\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$。\n   - 定义 $k_x = 2\\pi/L_x$ 和 $k_y = 2\\pi/L_y$。\n   - 给定 $\\tau_x(x,y) = \\tau_0\\,\\sin(k_x x)\\,\\cos(k_y y)$ 和 $\\tau_y(x,y) = \\tau_0\\,\\cos(k_x x)\\,\\sin(k_y y)$。\n   - 通过对 $\\tau_x$ 和 $\\tau_y$ 进行解析微分来计算解析埃克曼抽吸。\n\n2. 均匀风应力：\n   - $N_x = 64$, $N_y = 48$。\n   - $L_x = 1.2\\times 10^6\\ \\mathrm{m}$, $L_y = 1.0\\times 10^6\\ \\mathrm{m}$。\n   - $\\rho = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$。\n   - $\\tau_0 = 0.1\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$。\n   - 给定 $\\tau_x(x,y) = \\tau_0$ 和 $\\tau_y(x,y) = 0$。\n   - 通过对 $\\tau_x$ 和 $\\tau_y$ 进行解析微分来计算解析埃克曼抽吸。\n\n3. 势风应力（解析旋度为零），具有标量势 $\\phi(x,y)$：\n   - $N_x = 97$, $N_y = 91$。\n   - $L_x = 2.0\\times 10^6\\ \\mathrm{m}$, $L_y = 2.5\\times 10^6\\ \\mathrm{m}$。\n   - $\\rho = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$。\n   - $\\tau_0 = 0.5\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$。\n   - 定义 $k_x = 2\\pi/L_x$ 和 $k_y = 2\\pi/L_y$，整数乘子为 $m_x = 2$, $m_y = 3$。\n   - 设 $\\phi(x,y) = \\tau_0\\,\\sin(m_x k_x x)\\,\\sin(m_y k_y y)$，并给定 $\\tau_x(x,y) = \\partial \\phi/\\partial x$ 和 $\\tau_y(x,y) = \\partial \\phi/\\partial y$。\n   - 通过对 $\\tau_x$ 和 $\\tau_y$ 进行解析微分来计算解析埃克曼抽吸。\n\n4. 高频三角函数风应力：\n   - $N_x = 128$, $N_y = 96$。\n   - $L_x = 1.0\\times 10^6\\ \\mathrm{m}$, $L_y = 0.9\\times 10^6\\ \\mathrm{m}$。\n   - $\\rho = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$。\n   - $\\tau_0 = 0.3\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$。\n   - 定义 $k_x = 2\\pi/L_x$ 和 $k_y = 2\\pi/L_y$，整数乘子为 $m_x = 12$, $m_y = 9$。\n   - 给定 $\\tau_x(x,y) = \\tau_0\\,\\sin(m_x k_x x)\\,\\cos(m_y k_y y)$ 和 $\\tau_y(x,y) = \\tau_0\\,\\cos(m_x k_x x)\\,\\sin(m_y k_y y)$。\n   - 通过对 $\\tau_x$ 和 $\\tau_y$ 进行解析微分来计算解析埃克曼抽吸。\n\n答案规格：\n- 对每个测试用例，计算数值和解析埃克曼抽吸场之间的均方根误差，以浮点数形式表示，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 您的程序应产生单行输出，其中包含四个测试用例的误差值，格式为逗号分隔的列表，并用方括号括起来（例如，$[\\text{err}_1,\\text{err}_2,\\text{err}_3,\\text{err}_4]$），无其他文本。",
            "solution": "### 埃克曼抽吸的解析推导\n\n推导始于旋转坐标系中的稳态、线性、水平动量方程，其中表层埃克曼层内的主要平衡是科里奥利力与湍流应力的垂直散度之间的平衡。\n\n动量方程为：\n$$\n-f v = \\frac{1}{\\rho} \\frac{\\partial \\sigma_{xz}}{\\partial z}\n$$\n$$\nf u = \\frac{1}{\\rho} \\frac{\\partial \\sigma_{yz}}{\\partial z}\n$$\n其中 $(u, v)$ 分别是 $x$ 和 $y$ 方向的水平速度分量，$f$ 是科里奥利参数，$\\rho$ 是恒定的水密度，$\\sigma_{xz}$ 和 $\\sigma_{yz}$ 是垂直湍流应力分量。\n\n我们将这些方程在埃克曼层的深度范围内进行积分，从其底部 $z = -H_E$ 到海面 $z = 0$。\n$$\n\\int_{-H_E}^{0} -f v \\,dz = \\frac{1}{\\rho} \\int_{-H_E}^{0} \\frac{\\partial \\sigma_{xz}}{\\partial z} \\,dz\n$$\n$$\n\\int_{-H_E}^{0} f u \\,dz = \\frac{1}{\\rho} \\int_{-H_E}^{0} \\frac{\\partial \\sigma_{yz}}{\\partial z} \\,dz\n$$\n埃克曼输送分量定义为深度积分的速度：$U_E = \\int_{-H_E}^{0} u \\,dz$ 和 $V_E = \\int_{-H_E}^{0} v \\,dz$。将微积分基本定理应用于右侧，得到：\n$$\n-f V_E = \\frac{1}{\\rho} \\left[ \\sigma_{xz} \\right]_{z=-H_E}^{z=0} = \\frac{1}{\\rho} (\\sigma_{xz}(0) - \\sigma_{xz}(-H_E))\n$$\n$$\nf U_E = \\frac{1}{\\rho} \\left[ \\sigma_{yz} \\right]_{z=-H_E}^{z=0} = \\frac{1}{\\rho} (\\sigma_{yz}(0) - \\sigma_{yz}(-H_E))\n$$\n在海面（$z=0$），湍流应力等于风应力：$\\sigma_{xz}(0) = \\tau_x$ 和 $\\sigma_{yz}(0) = \\tau_y$。在埃克曼层底部（$z=-H_E$），假设应力已衰减为零：$\\sigma_{xz}(-H_E) = 0$ 和 $\\sigma_{yz}(-H_E) = 0$。\n输送方程简化为：\n$$\n-f V_E = \\frac{\\tau_x}{\\rho} \\quad \\implies \\quad V_E = -\\frac{\\tau_x}{\\rho f}\n$$\n$$\nf U_E = \\frac{\\tau_y}{\\rho} \\quad \\implies \\quad U_E = \\frac{\\tau_y}{\\rho f}\n$$\n这些方程根据风应力矢量 $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ 定义了埃克曼输送矢量 $\\mathbf{U}_E = (U_E, V_E)$。\n\n接下来，我们使用不可压缩流体的质量连续性方程：\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0\n$$\n我们再次在同一深度范围（从 $z=-H_E$ 到 $z=0$）内积分此方程：\n$$\n\\int_{-H_E}^{0} \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) dz + \\int_{-H_E}^{0} \\frac{\\partial w}{\\partial z} dz = 0\n$$\n由于积分限是常数，我们可以交换微分和积分的顺序（根据莱布尼茨法则）：\n$$\n\\frac{\\partial}{\\partial x} \\left( \\int_{-H_E}^{0} u \\,dz \\right) + \\frac{\\partial}{\\partial y} \\left( \\int_{-H_E}^{0} v \\,dz \\right) + \\left[ w \\right]_{z=-H_E}^{z=0} = 0\n$$\n代入埃克曼输送的定义，变为：\n$$\n\\frac{\\partial U_E}{\\partial x} + \\frac{\\partial V_E}{\\partial y} + w(0) - w(-H_E) = 0\n$$\n海面的垂直速度假定为零，$w(0) = 0$（刚盖近似）。埃克曼层底部的垂直速度 $w(-H_E)$ 定义为埃克曼抽吸速度 $w_E$。该速度代表从表层边界层泵入海洋内部或从内部泵出的水量。方程变为：\n$$\n\\frac{\\partial U_E}{\\partial x} + \\frac{\\partial V_E}{\\partial y} - w_E = 0\n$$\n这给出了 $w_E$ 作为埃克曼输送散度的第一个所需表达式：\n$$\nw_E = \\nabla \\cdot \\mathbf{U}_E = \\frac{\\partial U_E}{\\partial x} + \\frac{\\partial V_E}{\\partial y}\n$$\n这是 **数值方法** 的基础。\n\n为了获得 **解析表达式**，我们将 $U_E$ 和 $V_E$ 关于风应力的关系式代入 $w_E$ 的方程中：\n$$\nw_E = \\frac{\\partial}{\\partial x} \\left( \\frac{\\tau_y}{\\rho f} \\right) + \\frac{\\partial}{\\partial y} \\left( -\\frac{\\tau_x}{\\rho f} \\right)\n$$\n由于 $\\rho$ 和 $f$ 是常数，它们可以从导数中提出：\n$$\nw_E = \\frac{1}{\\rho f} \\left( \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y} \\right)\n$$\n这是第二个所需表达式，它将埃克曼抽吸速度直接与风应力场的旋度 $\\mathbf{k} \\cdot (\\nabla \\times \\boldsymbol{\\tau}) = \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}$ 联系起来，其中 $\\mathbf{k}$ 是 $z$ 方向的单位向量。\n\n### 数值实现策略\n\n程序将为每个测试用例执行以下步骤：\n1.  **网格生成：** 使用 `numpy.meshgrid`（带有 `indexing='ij'`）创建形状为 $(N_x, N_y)$ 的二维坐标数组 `xx` 和 `yy`，代表计算域。\n2.  **风应力场：** 在网格上评估给定的 $\\tau_x(x,y)$ 和 $\\tau_y(x,y)$ 函数，以创建数组 `tau_x` 和 `tau_y`。\n3.  **解析埃克曼抽吸：** 在网格上评估解析推导出的 $w_E(x, y)$ 表达式，以创建参考解数组 `w_ana_field`。对于风应力旋度解析为零的情况，此场将是一个零数组。\n4.  **数值埃克曼抽吸：**\n    a.  计算埃克曼输送分量数组：`U_E = tau_y / (rho * f)` 和 `V_E = -tau_x / (rho * f)`。\n    b.  数值计算输送场的散度。偏导数 $\\partial U_E / \\partial x$ 和 $\\partial V_E / \\partial y$ 使用周期性网格上的中心差分格式进行近似。`numpy.roll` 函数非常适合实现周期性边界条件。\n    $$\n    \\frac{\\partial A}{\\partial x}\\bigg|_{i,j} \\approx \\frac{A_{i+1, j} - A_{i-1, j}}{2\\Delta x} \\quad \\text{和} \\quad \\frac{\\partial A}{\\partial y}\\bigg|_{i,j} \\approx \\frac{A_{i, j+1} - A_{i, j-1}}{2\\Delta y}\n    $$\n    得到的数组是 `w_num_field`。\n5.  **误差计算：** 计算数值场和解析场之间的均方根误差：$ \\text{RMSE} = \\sqrt{\\langle (w_{\\text{num\\_field}} - w_{\\text{ana\\_field}})^2 \\rangle} $，其中 $\\langle \\cdot \\rangle$ 表示在整个域上的空间平均。\n对所有四个测试用例重复此过程，并收集得到的RMSE值。",
            "answer": "```python\nimport numpy as np\n\ndef compute_ekman_error(params: dict) - float:\n    \"\"\"\n    Computes the RMS error between analytical and numerical Ekman pumping\n    for a given set of parameters and wind stress field.\n    \"\"\"\n    # Unpack domain and physical parameters\n    Nx, Ny = params['Nx'], params['Ny']\n    Lx, Ly = params['Lx'], params['Ly']\n    rho, f, tau0 = params['rho'], params['f'], params['tau0']\n    \n    # Create grid\n    dx = Lx / Nx\n    dy = Ly / Ny\n    x = np.arange(Nx) * dx\n    y = np.arange(Ny) * dy\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    # Define wavenumbers\n    kx = 2.0 * np.pi / Lx\n    ky = 2.0 * np.pi / Ly\n\n    # Branch based on test case ID to define wind stress and analytical solution\n    case_id = params['case_id']\n    if case_id == 1:\n        # Case 1: Smooth, non-separable trigonometric wind stress\n        tau_x = tau0 * np.sin(kx * xx) * np.cos(ky * yy)\n        tau_y = tau0 * np.cos(kx * xx) * np.sin(ky * yy)\n        \n        # w_ana = (1/(rho*f)) * (d(tau_y)/dx - d(tau_x)/dy)\n        # d(tau_y)/dx = -tau0 * kx * sin(kx*x) * sin(ky*y)\n        # d(tau_x)/dy = -tau0 * ky * sin(kx*x) * sin(ky*y)\n        # curl = tau0 * (ky - kx) * sin(kx*x) * sin(ky*y)\n        w_ana_field = (tau0 * (ky - kx) / (rho * f)) * np.sin(kx * xx) * np.sin(ky * yy)\n        \n    elif case_id == 2:\n        # Case 2: Uniform wind stress\n        tau_x = tau0 * np.ones_like(xx)\n        tau_y = np.zeros_like(xx)\n        \n        # curl is zero for constant fields\n        w_ana_field = np.zeros_like(xx)\n        \n    elif case_id == 3:\n        # Case 3: Potential wind stress (zero analytical curl)\n        mx, my = params['m_xy']\n        \n        # tau = grad(phi), where phi = tau0 * sin(mx*kx*x) * sin(my*ky*y)\n        # tau_x = d(phi)/dx = tau0 * (mx*kx) * cos(mx*kx*x) * sin(my*ky*y)\n        # tau_y = d(phi)/dy = tau0 * (my*ky) * sin(mx*kx*x) * cos(my*ky*y)\n        tau_x = tau0 * (mx * kx) * np.cos(mx * kx * xx) * np.sin(my * ky * yy)\n        tau_y = tau0 * (my * ky) * np.sin(mx * kx * xx) * np.cos(my * ky * yy)\n\n        # Curl of a gradient is analytically zero\n        w_ana_field = np.zeros_like(xx)\n\n    elif case_id == 4:\n        # Case 4: High-frequency trigonometric wind stress\n        mx, my = params['m_xy']\n        kx_m = mx * kx\n        ky_m = my * ky\n        \n        tau_x = tau0 * np.sin(kx_m * xx) * np.cos(ky_m * yy)\n        tau_y = tau0 * np.cos(kx_m * xx) * np.sin(ky_m * yy)\n        \n        # Same form as case 1, with modified wavenumbers\n        w_ana_field = (tau0 * (ky_m - kx_m) / (rho * f)) * np.sin(kx_m * xx) * np.sin(ky_m * yy)\n        \n    else:\n        raise ValueError(f\"Invalid case_id: {case_id}\")\n\n    # --- Numerical Calculation ---\n    \n    # 1. Compute Ekman transport\n    # U_E = tau_y / (rho * f)\n    # V_E = -tau_x / (rho * f)\n    U_E = tau_y / (rho * f)\n    V_E = -tau_x / (rho * f)\n\n    # 2. Compute numerical divergence of transport field\n    # w_E = d(U_E)/dx + d(V_E)/dy\n    # Using centered differences with periodic boundaries via np.roll\n    # axis=0 corresponds to x-direction (since indexing='ij')\n    # axis=1 corresponds to y-direction\n    \n    dUe_dx = (np.roll(U_E, -1, axis=0) - np.roll(U_E, 1, axis=0)) / (2.0 * dx)\n    dVe_dy = (np.roll(V_E, -1, axis=1) - np.roll(V_E, 1, axis=1)) / (2.0 * dy)\n    \n    w_num_field = dUe_dx + dVe_dy\n\n    # --- Error Calculation ---\n    \n    # Compute Root-Mean-Square Error\n    rmse = np.sqrt(np.mean((w_num_field - w_ana_field)**2))\n    \n    return rmse\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"case_id\": 1,\n            \"Nx\": 101, \"Ny\": 117,\n            \"Lx\": 1.0e6, \"Ly\": 0.8e6,\n            \"rho\": 1025.0, \"f\": 1.0e-4,\n            \"tau0\": 0.2,\n        },\n        {\n            \"case_id\": 2,\n            \"Nx\": 64, \"Ny\": 48,\n            \"Lx\": 1.2e6, \"Ly\": 1.0e6,\n            \"rho\": 1025.0, \"f\": 1.0e-4,\n            \"tau0\": 0.1,\n        },\n        {\n            \"case_id\": 3,\n            \"Nx\": 97, \"Ny\": 91,\n            \"Lx\": 2.0e6, \"Ly\": 2.5e6,\n            \"rho\": 1025.0, \"f\": 1.0e-4,\n            \"tau0\": 0.5,\n            \"m_xy\": (2, 3),\n        },\n        {\n            \"case_id\": 4,\n            \"Nx\": 128, \"Ny\": 96,\n            \"Lx\": 1.0e6, \"Ly\": 0.9e6,\n            \"rho\": 1025.0, \"f\": 1.0e-4,\n            \"tau0\": 0.3,\n            \"m_xy\": (12, 9),\n        },\n    ]\n\n    results = []\n    for case_params in test_cases:\n        error = compute_ekman_error(case_params)\n        results.append(error)\n\n    # Format output as specified: a list of floats\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}