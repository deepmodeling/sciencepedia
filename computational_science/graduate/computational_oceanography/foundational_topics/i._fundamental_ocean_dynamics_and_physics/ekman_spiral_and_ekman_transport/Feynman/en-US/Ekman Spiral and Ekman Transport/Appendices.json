{
    "hands_on_practices": [
        {
            "introduction": "The foundation of Ekman theory lies in a simple yet powerful balance of forces. This first exercise guides you through the core derivation of Ekman transport, starting directly from the steady-state momentum equations. By integrating the balance between the Coriolis force and the vertical divergence of turbulent stress, you will derive the classic result that the net transport of water is perpendicular to the applied wind stress and independent of the details of the turbulent mixing . This practice is essential for understanding how wind energy is transferred into large-scale ocean currents.",
            "id": "3791577",
            "problem": "Consider a steady, horizontally homogeneous oceanic boundary layer of semi-infinite depth, occupying $z \\le 0$ with the free surface at $z=0$ and $z$ increasing upward. Assume a constant eddy viscosity $A_z$ and a constant seawater density $\\rho=1025\\,\\mathrm{kg\\,m}^{-3}$. Let the horizontal velocity field be $\\boldsymbol{u}(z)=(u(z),v(z))$ in a Cartesian coordinate system with $x$ pointing east and $y$ pointing north. The turbulent momentum flux (stress) is $\\boldsymbol{\\tau}(z)=(\\tau_x(z),\\tau_y(z))$ and satisfies the constitutive relation $\\boldsymbol{\\tau}(z)=\\rho A_z \\,\\partial \\boldsymbol{u}/\\partial z$. The Coriolis parameter is $f$, and the flow is forced by a uniform, imposed air-side stress at the free surface $\\boldsymbol{\\tau}(0)=\\boldsymbol{\\tau}_a$, with no stress transmitted at depth, $\\lim_{z\\to -\\infty}\\boldsymbol{\\tau}(z)=\\boldsymbol{0}$. Neglect horizontal pressure gradients and any baroclinic effects in the boundary layer.\n\nStarting from the steady horizontal momentum balances that equate the Coriolis acceleration to the vertical divergence of turbulent stress, and using the above boundary conditions, derive the depth-integrated Ekman transport vector $\\boldsymbol{M}_E=\\displaystyle\\int_{-\\infty}^{0}\\boldsymbol{u}(z)\\,\\mathrm{d}z$ in terms of the surface stress $\\boldsymbol{\\tau}_a$, the seawater density $\\rho$, and the Coriolis parameter $f$. Then, for the specific case $\\boldsymbol{\\tau}_a=(0.1\\,\\mathrm{N\\,m}^{-2},\\,0)$ and $f=10^{-4}\\,\\mathrm{s}^{-1}$, compute the magnitude of $\\boldsymbol{M}_E$ and the direction of $\\boldsymbol{M}_E$ as an angle in radians measured counterclockwise from the positive eastward axis, with the principal value taken in $[0,2\\pi)$. Express the magnitude in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, and round the magnitude to three significant figures. Provide the angle in exact form.",
            "solution": "The user wants me to validate the problem statement and, if valid, provide a complete solution.\n\n### Step 1: Extract Givens\n- **Domain**: Semi-infinite depth, $z \\le 0$, with the free surface at $z=0$.\n- **Coordinate System**: $z$ increases upward, $x$ points east, $y$ points north.\n- **Physical Constants**:\n    - Eddy viscosity $A_z$ is constant.\n    - Seawater density $\\rho=1025\\,\\mathrm{kg\\,m}^{-3}$ is constant.\n    - Coriolis parameter is $f$.\n- **Fields and Relations**:\n    - Horizontal velocity: $\\boldsymbol{u}(z)=(u(z),v(z))$.\n    - Turbulent stress: $\\boldsymbol{\\tau}(z)=(\\tau_x(z),\\tau_y(z))$.\n    - Constitutive relation: $\\boldsymbol{\\tau}(z)=\\rho A_z \\,\\partial \\boldsymbol{u}/\\partial z$.\n- **Governing Principles**: Steady horizontal momentum balance: Coriolis acceleration equals the vertical divergence of turbulent stress.\n- **Boundary Conditions**:\n    - Surface stress: $\\boldsymbol{\\tau}(0)=\\boldsymbol{\\tau}_a$.\n    - Deep stress: $\\lim_{z\\to -\\infty}\\boldsymbol{\\tau}(z)=\\boldsymbol{0}$.\n- **Assumptions**: Steady flow, horizontally homogeneous, negligible horizontal pressure gradients, no baroclinic effects.\n- **Task 1**: Derive the depth-integrated Ekman transport $\\boldsymbol{M}_E=\\displaystyle\\int_{-\\infty}^{0}\\boldsymbol{u}(z)\\,\\mathrm{d}z$ in terms of $\\boldsymbol{\\tau}_a$, $\\rho$, and $f$.\n- **Task 2**: For the specific case $\\boldsymbol{\\tau}_a=(0.1\\,\\mathrm{N\\,m}^{-2},\\,0)$, $f=10^{-4}\\,\\mathrm{s}^{-1}$, and $\\rho=1025\\,\\mathrm{kg\\,m}^{-3}$, compute:\n    - The magnitude of $\\boldsymbol{M}_E$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, rounded to three significant figures.\n    - The direction of $\\boldsymbol{M}_E$ as an angle in radians measured counterclockwise from the positive eastward axis, in exact form and in the interval $[0,2\\pi)$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes the idealized, classic Ekman layer model, a fundamental concept in physical oceanography. All principles, assumptions, and equations are standard and scientifically sound.\n- **Well-Posed**: The problem is well-defined. It provides all necessary information (governing equations, boundary conditions, constants) to derive the requested quantity and compute its value. a unique solution exists.\n- **Objective**: The problem is stated using precise, quantitative, and unbiased language.\n- **Flaw Analysis**:\n    1.  **Scientific/Factual Unsoundness**: None. The setup is a standard textbook case.\n    2.  **Non-Formalizable/Irrelevant**: None. The problem is a formalizable physics problem directly pertaining to Ekman transport in computational oceanography.\n    3.  **Incomplete/Contradictory**: None. The problem is self-contained and consistent. The assumptions lead to a well-known, solvable system.\n    4.  **Unrealistic/Infeasible**: The assumptions (e.g., constant $A_z$, semi-infinite depth) are idealizations but are standard for deriving the foundational theory. The numerical values provided are physically realistic for the upper ocean.\n    5.  **Ill-Posed**: None. The problem has a unique, stable solution.\n    6.  **Pseudo-Profound/Trivial**: None. The derivation requires correct application of vector calculus and physical principles, representing a substantive problem.\n    7.  **Outside Scientific Verifiability**: None. The model and its results are verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe problem states that the steady horizontal momentum balance equates the Coriolis acceleration to the vertical divergence of turbulent stress. The Coriolis force per unit mass is given by $\\boldsymbol{f_c} = \\boldsymbol{f} \\times \\boldsymbol{u}$, where $\\boldsymbol{f}=(0,0,f)$ is the Coriolis vector and $\\boldsymbol{u}=(u,v,0)$ is the horizontal velocity. The force due to stress divergence per unit volume is $\\nabla \\cdot \\boldsymbol{\\mathcal{T}}$, where $\\boldsymbol{\\mathcal{T}}$ is the stress tensor. For a horizontally homogeneous flow, this simplifies to $\\frac{\\partial \\boldsymbol{\\tau}}{\\partial z}$, where $\\boldsymbol{\\tau}$ is the horizontal stress vector. The momentum balance is therefore $\\rho(\\boldsymbol{f} \\times \\boldsymbol{u}) = \\frac{\\partial \\boldsymbol{\\tau}}{\\partial z}$.\n\nWriting this in component form:\n$\\boldsymbol{f} \\times \\boldsymbol{u} = (0,0,f) \\times (u,v,0) = (-fv, fu, 0)$.\nThe momentum equations are:\n$$ - \\rho f v = \\frac{\\partial \\tau_x}{\\partial z} $$\n$$ \\rho f u = \\frac{\\partial \\tau_y}{\\partial z} $$\n\nThe Ekman transport vector $\\boldsymbol{M}_E$ is defined as the depth-integrated velocity:\n$$ \\boldsymbol{M}_E = (M_{Ex}, M_{Ey}) = \\left(\\int_{-\\infty}^{0} u(z)\\,\\mathrm{d}z, \\int_{-\\infty}^{0} v(z)\\,\\mathrm{d}z\\right) $$\n\nTo find the components of $\\boldsymbol{M}_E$, we integrate the momentum equations with respect to $z$ from $-\\infty$ to $0$.\n\nFirst, we integrate the $y$-momentum equation:\n$$ \\int_{-\\infty}^{0} \\rho f u(z) \\,\\mathrm{d}z = \\int_{-\\infty}^{0} \\frac{\\partial \\tau_y}{\\partial z} \\,\\mathrm{d}z $$\nSince $\\rho$ and $f$ are constants, we can take them out of the integral on the left side. The right side can be evaluated using the Fundamental Theorem of Calculus.\n$$ \\rho f \\int_{-\\infty}^{0} u(z) \\,\\mathrm{d}z = \\left[ \\tau_y(z) \\right]_{-\\infty}^{0} $$\n$$ \\rho f M_{Ex} = \\tau_y(0) - \\lim_{z\\to-\\infty} \\tau_y(z) $$\nUsing the boundary conditions $\\boldsymbol{\\tau}(0) = \\boldsymbol{\\tau}_a = (\\tau_{ax}, \\tau_{ay})$ and $\\lim_{z\\to -\\infty} \\boldsymbol{\\tau}(z) = \\boldsymbol{0}$, we have:\n$$ \\rho f M_{Ex} = \\tau_{ay} - 0 $$\n$$ M_{Ex} = \\frac{\\tau_{ay}}{\\rho f} $$\n\nNext, we integrate the $x$-momentum equation:\n$$ \\int_{-\\infty}^{0} -\\rho f v(z) \\,\\mathrm{d}z = \\int_{-\\infty}^{0} \\frac{\\partial \\tau_x}{\\partial z} \\,\\mathrm{d}z $$\n$$ -\\rho f \\int_{-\\infty}^{0} v(z) \\,\\mathrm{d}z = \\left[ \\tau_x(z) \\right]_{-\\infty}^{0} $$\n$$ -\\rho f M_{Ey} = \\tau_x(0) - \\lim_{z\\to-\\infty} \\tau_x(z) $$\nUsing the boundary conditions again:\n$$ -\\rho f M_{Ey} = \\tau_{ax} - 0 $$\n$$ M_{Ey} = -\\frac{\\tau_{ax}}{\\rho f} $$\n\nCombining the components, the Ekman transport vector is:\n$$ \\boldsymbol{M}_E = (M_{Ex}, M_{Ey}) = \\left(\\frac{\\tau_{ay}}{\\rho f}, -\\frac{\\tau_{ax}}{\\rho f}\\right) $$\nThis expression gives the Ekman transport in terms of the surface stress $\\boldsymbol{\\tau}_a$, the density $\\rho$, and the Coriolis parameter $f$, as requested.\n\nNow, we evaluate this for the given specific case:\n$\\boldsymbol{\\tau}_a = (0.1\\,\\mathrm{N\\,m}^{-2},\\,0)$, which means $\\tau_{ax} = 0.1\\,\\mathrm{N\\,m}^{-2}$ and $\\tau_{ay} = 0\\,\\mathrm{N\\,m}^{-2}$.\n$f = 10^{-4}\\,\\mathrm{s}^{-1}$.\n$\\rho = 1025\\,\\mathrm{kg\\,m}^{-3}$.\n\nThe components of the Ekman transport vector are:\n$$ M_{Ex} = \\frac{0}{\\rho f} = 0\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} $$\n$$ M_{Ey} = -\\frac{0.1\\,\\mathrm{N\\,m}^{-2}}{(1025\\,\\mathrm{kg\\,m}^{-3})(10^{-4}\\,\\mathrm{s}^{-1})} = -\\frac{0.1}{1025 \\times 10^{-4}}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} $$\n$$ M_{Ey} = -\\frac{0.1}{0.1025}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} \\approx -0.9756097... \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} $$\nSo, $\\boldsymbol{M}_E \\approx (0, -0.9756)\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n\nThe magnitude of the Ekman transport is:\n$$ |\\boldsymbol{M}_E| = \\sqrt{M_{Ex}^2 + M_{Ey}^2} = \\sqrt{0^2 + M_{Ey}^2} = |M_{Ey}| $$\n$$ |\\boldsymbol{M}_E| = \\frac{0.1}{0.1025}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} \\approx 0.9756097...\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} $$\nRounding to three significant figures, the magnitude is $0.976\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n\nThe direction of $\\boldsymbol{M}_E$ is the angle $\\theta$ it makes with the positive $x$-axis (eastward), measured counterclockwise. The vector is $\\boldsymbol{M}_E = (0, M_{Ey})$ with $M_{Ey} < 0$. This vector points directly along the negative $y$-axis (south). An angle measured counterclockwise from the positive $x$-axis to the negative $y$-axis is $270^\\circ$. In radians, this is:\n$$ \\theta = 270^\\circ \\times \\frac{\\pi}{180^\\circ} = \\frac{3\\pi}{2} $$\nThis value is in the required principal value range of $[0, 2\\pi)$. The problem asks for the angle in exact form, which is $\\frac{3\\pi}{2}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.976 & \\frac{3\\pi}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A robust model is built on physically sound assumptions, especially at its boundaries where it interfaces with other systems. This practice challenges you to think critically about how wind forcing is represented in the Ekman model, contrasting a stress boundary condition with a prescribed velocity condition . By analyzing the physical implications of each, you will solidify your understanding of why continuity of stress—not velocity—is the correct principle for modeling the air-sea interface and how this choice leads to the fundamental properties of Ekman transport.",
            "id": "3791578",
            "problem": "A homogeneous ocean of constant density $\\rho$ occupies $z<0$ beneath the atmosphere. On an $f$-plane with constant Coriolis parameter $f>0$ (Northern Hemisphere), consider a steady, horizontally homogeneous, incompressible flow with velocity $\\boldsymbol{u}(z) = (u(z), v(z))$ driven by a uniform wind stress $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ applied at the sea surface $z=0$. Turbulent momentum mixing in the ocean is parameterized by a constant eddy viscosity $A>0$, and the vertical momentum balance reduces to a competition between the Coriolis force and vertical diffusion. At great depth $z \\to -\\infty$, the velocity tends to zero.\n\nTwo different surface boundary conditions are proposed for implementing Ekman dynamics in a one-dimensional column model:\n(i) a stress boundary condition $A\\,\\partial \\boldsymbol{u}/\\partial z\\big|_{z=0} = \\boldsymbol{\\tau}/\\rho$, and\n(ii) a prescribed surface velocity $\\boldsymbol{u}(0) = \\boldsymbol{u}_s$, where $\\boldsymbol{u}_s$ is a given vector independent of $\\boldsymbol{\\tau}$.\n\nFrom first principles of continuum mechanics and the momentum equations appropriate to this setting, reason about how each boundary condition communicates the wind forcing into the ocean and about the implications for the vertically integrated Ekman transport $\\boldsymbol{M} = \\int_{-\\infty}^{0} \\boldsymbol{u}(z)\\,\\mathrm{d}z$ (its dependence on $\\boldsymbol{\\tau}$, $A$, and $f$, and its orientation relative to $\\boldsymbol{\\tau}$). Which statement is most physically appropriate for Ekman dynamics?\n\nA. The stress boundary condition $A\\,\\partial \\boldsymbol{u}/\\partial z\\big|_{z=0} = \\boldsymbol{\\tau}/\\rho$ is physically appropriate because the air–sea interface enforces continuity of tangential stress rather than velocity; it yields an Ekman transport whose magnitude is set by $\\boldsymbol{\\tau}$ and $f$ (not by $A$) and is rotated by $90^{\\circ}$ relative to $\\boldsymbol{\\tau}$. Prescribing $\\boldsymbol{u}(0)$ generally produces a transport that depends on $\\boldsymbol{u}_s$ and $A$, and does not recover the expected scaling or orientation.\n\nB. Prescribing $\\boldsymbol{u}(0)$ is equivalent to prescribing the surface stress when $A$ is constant, because $A\\,\\partial \\boldsymbol{u}/\\partial z$ and $\\boldsymbol{u}(0)$ are linearly related in steady state; both boundary conditions therefore yield identical Ekman transports that are independent of $A$.\n\nC. The physically appropriate boundary condition is $\\boldsymbol{u}(0)=\\boldsymbol{0}$ (no-slip), since the ocean and atmosphere are in contact at $z=0$; this ensures zero shear at the surface and produces a finite Ekman transport determined solely by $f$.\n\nD. Either boundary condition is acceptable; the Ekman transport depends only on $A$ and $f$, not on $\\boldsymbol{\\tau}$ or $\\boldsymbol{u}(0)$, because the Coriolis force alone controls the flow orientation and magnitude.",
            "solution": "The user has provided a problem concerning the classic Ekman layer in a homogeneous ocean. My task is to validate the problem statement, and if valid, derive the solution from first principles to evaluate the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Ocean: Homogeneous, constant density $\\rho$, occupies domain $z<0$.\n-   Frame of reference: $f$-plane, constant Coriolis parameter $f>0$ (Northern Hemisphere).\n-   Flow: Steady, horizontally homogeneous, incompressible, velocity $\\boldsymbol{u}(z) = (u(z), v(z))$.\n-   Forcing: Uniform wind stress $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ at $z=0$.\n-   Turbulence: Constant eddy viscosity $A>0$.\n-   Momentum Balance: Coriolis force versus vertical diffusion.\n-   Bottom Boundary Condition: $\\boldsymbol{u}(z) \\to \\boldsymbol{0}$ as $z \\to -\\infty$.\n-   Proposed Surface Boundary Conditions ($z=0$):\n    -   (i) Stress condition: $A\\,\\partial \\boldsymbol{u}/\\partial z\\big|_{z=0} = \\boldsymbol{\\tau}/\\rho$.\n    -   (ii) Velocity condition: $\\boldsymbol{u}(0) = \\boldsymbol{u}_s$, with $\\boldsymbol{u}_s$ independent of $\\boldsymbol{\\tau}$.\n-   Quantity of Interest: Vertically integrated Ekman transport $\\boldsymbol{M} = \\int_{-\\infty}^{0} \\boldsymbol{u}(z)\\,\\mathrm{d}z$.\n-   Question: Evaluate the physical appropriateness of the boundary conditions and their implications for $\\boldsymbol{M}$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem describes the canonical setup for the idealized Ekman layer, a fundamental concept in physical oceanography. The governing physics (Coriolis-viscous balance) and the idealizations (constant $\\rho, f, A$) are standard for deriving the analytical solution.\n-   **Well-Posed**: The problem is well-posed. The governing second-order differential equations, combined with one boundary condition at $z=0$ and another at $z \\to -\\infty$, yield a unique solution for each case presented.\n-   **Objective**: The problem is stated using precise, standard terminology from fluid dynamics. There is no subjective or ambiguous language.\n-   **Verdict**: The problem statement is valid. It is scientifically sound, well-posed, objective, and contains all necessary information for a rigorous analysis.\n\n### Derivation and Analysis\n\nThe governing momentum equations for a steady, horizontally homogeneous flow where the balance is between Coriolis and vertical turbulent diffusion are:\n$$\n-f v = A \\frac{d^2 u}{d z^2} \\quad (1)\n$$\n$$\nf u = A \\frac{d^2 v}{d z^2} \\quad (2)\n$$\nwhere $A$ is the constant eddy viscosity. These equations have been divided by the constant density $\\rho$.\n\nTo solve this system, we introduce the complex velocity $U(z) = u(z) + iv(z)$. Multiplying equation $(2)$ by $i$ and adding it to equation $(1)$ yields:\n$$\n-fv + ifu = A \\frac{d^2 u}{d z^2} + iA \\frac{d^2 v}{d z^2}\n$$\n$$\nif(u+iv) = A \\frac{d^2}{dz^2}(u+iv)\n$$\n$$\nA \\frac{d^2 U}{d z^2} - ifU = 0\n$$\nThis is a second-order linear ordinary differential equation. The characteristic equation is $k^2 - \\frac{if}{A} = 0$, so $k = \\pm\\sqrt{\\frac{if}{A}}$.\nUsing $i = e^{i\\pi/2}$, we find $\\sqrt{i} = e^{i\\pi/4} = \\frac{1+i}{\\sqrt{2}}$.\nThus, $k = \\pm \\sqrt{\\frac{f}{A}} \\frac{1+i}{\\sqrt{2}} = \\pm \\frac{1+i}{\\delta}$, where $\\delta = \\sqrt{2A/f}$ is the Ekman layer depth scale.\n\nThe general solution is:\n$$\nU(z) = C_1 e^{(1+i)z/\\delta} + C_2 e^{-(1+i)z/\\delta}\n$$\nThe boundary condition at great depth, $\\boldsymbol{u}(z) \\to \\boldsymbol{0}$ as $z \\to -\\infty$, requires $U(z) \\to 0$ as $z \\to -\\infty$. For $z<0$, the term $e^{-(1+i)z/\\delta}$ grows exponentially as $z \\to -\\infty$. Therefore, we must have $C_2=0$. The solution is of the form:\n$$\nU(z) = C_1 e^{(1+i)z/\\delta}\n$$\nThe constant $C_1$ is determined by the surface boundary condition.\n\n**Case (i): Stress Boundary Condition**\nThe boundary condition is $A\\,\\partial \\boldsymbol{u}/\\partial z\\big|_{z=0} = \\boldsymbol{\\tau}/\\rho$. In complex notation, letting $T = \\tau_x + i\\tau_y$, this is $A \\frac{dU}{dz}\\Big|_{z=0} = T/\\rho$.\nFrom our solution, $\\frac{dU}{dz} = C_1 \\frac{1+i}{\\delta} e^{(1+i)z/\\delta}$. At $z=0$, we have $A C_1 \\frac{1+i}{\\delta} = T/\\rho$.\nSolving for $C_1$: $C_1 = \\frac{T}{\\rho A} \\frac{\\delta}{1+i}$. This constant represents the surface velocity $U(0)$.\n\nNow, we calculate the complex Ekman transport $M = M_x + i M_y = \\int_{-\\infty}^{0} U(z) \\, \\mathrm{d}z$:\n$$\nM = \\int_{-\\infty}^{0} C_1 e^{(1+i)z/\\delta} \\, \\mathrm{d}z = C_1 \\left[ \\frac{\\delta}{1+i} e^{(1+i)z/\\delta} \\right]_{-\\infty}^{0} = C_1 \\frac{\\delta}{1+i}\n$$\nSubstituting the expression for $C_1$:\n$$\nM = \\left( \\frac{T}{\\rho A} \\frac{\\delta}{1+i} \\right) \\left( \\frac{\\delta}{1+i} \\right) = \\frac{T \\delta^2}{\\rho A (1+i)^2}\n$$\nUsing $\\delta^2 = 2A/f$ and $(1+i)^2 = 2i$:\n$$\nM = \\frac{T (2A/f)}{\\rho A (2i)} = \\frac{T}{i\\rho f} = -i \\frac{T}{\\rho f}\n$$\nIn component form: $M_x + iM_y = -i \\frac{\\tau_x + i\\tau_y}{\\rho f} = \\frac{\\tau_y - i\\tau_x}{\\rho f}$.\nThis gives a transport vector $\\boldsymbol{M} = (M_x, M_y) = (\\frac{\\tau_y}{\\rho f}, -\\frac{\\tau_x}{\\rho f})$.\nThe magnitude of the transport is $|\\boldsymbol{M}| = \\frac{\\sqrt{\\tau_y^2 + (-\\tau_x)^2}}{\\rho f} = \\frac{|\\boldsymbol{\\tau}|}{\\rho f}$. This is independent of the eddy viscosity $A$.\nThe orientation relative to the stress is found by the dot product: $\\boldsymbol{M} \\cdot \\boldsymbol{\\tau} = (\\frac{\\tau_y}{\\rho f})\\tau_x + (-\\frac{\\tau_x}{\\rho f})\\tau_y = 0$. The transport is perpendicular to the stress. For $f>0$ (Northern Hemisphere), the transport is rotated $90^{\\circ}$ to the right (clockwise) of the wind stress. This is the classic Ekman transport result.\nPhysically, this boundary condition is appropriate because the wind exerts a tangential stress on the sea surface. The continuity of stress at the air-sea interface is the mechanism by which momentum is transferred from the atmosphere to the ocean.\n\n**Case (ii): Prescribed Velocity Boundary Condition**\nThe boundary condition is $\\boldsymbol{u}(0) = \\boldsymbol{u}_s$, or $U(0) = U_s = u_s + iv_s$.\nFrom $U(z) = C_1 e^{(1+i)z/\\delta}$, we find at $z=0$ that $U(0) = C_1$. Thus, $C_1 = U_s$.\nThe velocity profile is $U(z) = U_s e^{(1+i)z/\\delta}$.\n\nThe Ekman transport is:\n$$\nM = \\int_{-\\infty}^{0} U_s e^{(1+i)z/\\delta} \\, \\mathrm{d}z = U_s \\frac{\\delta}{1+i}\n$$\nSubstituting $\\delta = \\sqrt{2A/f}$:\n$$\nM = U_s \\frac{\\sqrt{2A/f}}{1+i} = U_s \\sqrt{\\frac{A}{f}} \\frac{\\sqrt{2}(1-i)}{2} = U_s \\sqrt{\\frac{A}{f}} e^{-i\\pi/4}\n$$\nThe magnitude of this transport is $|\\boldsymbol{M}| = |\\boldsymbol{u}_s|\\sqrt{A/f}$. This transport depends on the eddy viscosity $A$. It also depends on the prescribed surface velocity $\\boldsymbol{u}_s$, which the problem states is independent of the wind stress $\\boldsymbol{\\tau}$. This divorces the ocean's response from the primary physical forcing. Such a boundary condition is physically inappropriate for modeling wind-driven circulation, as the surface velocity is a result of the wind stress, not an independent input. The resulting transport does not match the classic Ekman result both in its dependency on $A$ and its relationship (or lack thereof) to $\\boldsymbol{\\tau}$.\n\n### Option-by-Option Analysis\n\n**A. The stress boundary condition $A\\,\\partial \\boldsymbol{u}/\\partial z\\big|_{z=0} = \\boldsymbol{\\tau}/\\rho$ is physically appropriate because the air–sea interface enforces continuity of tangential stress rather than velocity; it yields an Ekman transport whose magnitude is set by $\\boldsymbol{\\tau}$ and $f$ (not by $A$) and is rotated by $90^{\\circ}$ relative to $\\boldsymbol{\\tau}$. Prescribing $\\boldsymbol{u}(0)$ generally produces a transport that depends on $\\boldsymbol{u}_s$ and $A$, and does not recover the expected scaling or orientation.**\nThis statement is a complete and accurate summary of the physics and the results of our derivation. The stress condition is physically correct for wind forcing. The resulting transport properties (magnitude set by $|\\boldsymbol{\\tau}|$ and $f$, independent of $A$; orientation $90^{\\circ}$ to the right of $\\boldsymbol{\\tau}$) are correctly stated. The critique of the prescribed velocity condition is also correct: it leads to a transport that depends on $\\boldsymbol{u}_s$ and $A$, which is inconsistent with the fundamental theory of wind-driven Ekman transport.\n**Verdict: Correct**\n\n**B. Prescribing $\\boldsymbol{u}(0)$ is equivalent to prescribing the surface stress when $A$ is constant, because $A\\,\\partial \\boldsymbol{u}/\\partial z$ and $\\boldsymbol{u}(0)$ are linearly related in steady state; both boundary conditions therefore yield identical Ekman transports that are independent of $A$.**\nWhile it is true that for the given solution form there is a linear relationship between the surface velocity $\\boldsymbol{u}(0)$ and the surface shear stress $A\\,\\partial \\boldsymbol{u}/\\partial z$, it is physically incorrect to call the boundary conditions \"equivalent\" for modeling wind forcing. The wind stress $\\boldsymbol{\\tau}$ is the external forcing, which should be an input to the model, not a result calculated from a prescribed velocity. Most importantly, the conclusion is false: our derivation shows that the transports are not identical. The stress-forced transport is independent of $A$, while the velocity-forced transport depends on $\\sqrt{A}$.\n**Verdict: Incorrect**\n\n**C. The physically appropriate boundary condition is $\\boldsymbol{u}(0)=\\boldsymbol{0}$ (no-slip), since the ocean and atmosphere are in contact at $z=0$; this ensures zero shear at the surface and produces a finite Ekman transport determined solely by $f$.**\nA no-slip condition, $\\boldsymbol{u}(0)=\\boldsymbol{0}$, is appropriate for a stationary solid boundary, not a fluid-fluid interface being forced by wind. If we apply $\\boldsymbol{u}(0)=\\boldsymbol{0}$ to our general solution (with $\\boldsymbol{u} \\to \\boldsymbol{0}$ at depth), we get $C_1=0$, which results in $\\boldsymbol{u}(z) \\equiv \\boldsymbol{0}$ for all $z$. This means zero flow, zero shear, and zero transport, which contradicts the premise of a wind-driven flow. The statement that this ensures zero shear is also false; in general, a no-slip condition at a boundary in a sheared flow results in maximum shear at that boundary, not zero.\n**Verdict: Incorrect**\n\n**D. Either boundary condition is acceptable; the Ekman transport depends only on $A$ and $f$, not on $\\boldsymbol{\\tau}$ or $\\boldsymbol{u}(0)$, because the Coriolis force alone controls the flow orientation and magnitude.**\nThis statement is incorrect on multiple counts. The two boundary conditions are not equally acceptable from a physical standpoint. Our derivation explicitly shows that the physically relevant transport (from stress forcing) depends on $\\boldsymbol{\\tau}$ and $f$, but not $A$. The transport from the velocity forcing depends on $\\boldsymbol{u}_s$, $A$, and $f$. The claim that transport depends only on $A$ and $f$ is false. The concluding reason, that Coriolis alone controls the flow, is an oversimplification; the flow is a result of the balance between Coriolis, friction, and the applied forcing.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Ekman transport's spatial variations are a primary driver of vertical motion in the upper ocean, a phenomenon known as Ekman pumping. This computational exercise bridges theory and practice by tasking you with verifying the relationship between wind stress curl and the divergence of Ekman transport . By implementing a numerical model and comparing its output to the analytical solution, you will not only reinforce your theoretical knowledge but also develop practical skills in computational fluid dynamics and model verification.",
            "id": "3791570",
            "problem": "You will design and implement a program to compute the vertical velocity of Ekman pumping in a doubly periodic rectangular ocean domain by two independent methods: (i) numerically, by differentiating the depth-integrated Ekman transport field that you obtain from a prescribed wind stress, and (ii) analytically, by deriving the expression from the steady, depth-integrated momentum and mass continuity laws. The goal is to quantify the error between the numerical and analytical results for a small test suite of prescribed wind stress fields.\n\nStart from a valid fundamental base appropriate for computational oceanography: the steady horizontal momentum balance with wind stress forcing and Coriolis acceleration, and the mass continuity equation for an incompressible fluid. Treat the ocean as homogeneous of constant density and assume the Ekman layer is thin relative to other scales, allowing a depth-integrated transport formulation over the Ekman layer. Assume a constant Coriolis parameter. Use a two-dimensional (2D) doubly periodic domain with uniform grid spacing in each direction.\n\nYou must:\n- Derive, from the steady depth-integrated momentum equations together with mass continuity, an analytical expression for the Ekman pumping velocity in terms of the prescribed wind stress field. Do not use pre-memorized shortcut formulas; derive the expression from first principles.\n- Implement a numerical method that:\n  1. Constructs prescribed wind stress fields over the domain.\n  2. Computes the depth-integrated Ekman transport vector field from the wind stress using the steady depth-integrated momentum balance.\n  3. Computes the numerical Ekman pumping velocity as the divergence of the transport field using centered finite differences with periodic boundary conditions in both directions.\n  4. Computes the analytical Ekman pumping velocity for each prescribed wind stress by analytically differentiating the wind stress fields.\n- Compute, for each test case, the root-mean-square error between the numerical and analytical Ekman pumping velocity fields. Express these errors in meters per second ($\\mathrm{m}\\,\\mathrm{s}^{-1}$) as floating-point numbers.\n\nDomain and discretization:\n- The domain is rectangular and doubly periodic with lengths $L_x$ and $L_y$ in $\\mathrm{m}$, discretized on a uniform grid with $N_x$ points in the $x$ direction and $N_y$ points in the $y$ direction. Use grid nodes at $x_i = i\\,\\Delta x$ and $y_j = j\\,\\Delta y$ for $i \\in \\{0,\\dots,N_x-1\\}$ and $j \\in \\{0,\\dots,N_y-1\\}$ with $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$, and treat the fields as periodic in both directions.\n\nPhysics and units:\n- Density $\\rho$ in kilograms per cubic meter ($\\mathrm{kg}\\,\\mathrm{m}^{-3}$) is constant.\n- Coriolis parameter $f$ in inverse seconds ($\\mathrm{s}^{-1}$) is constant.\n- Wind stress components $\\tau_x(x,y)$ and $\\tau_y(x,y)$ are in newtons per square meter ($\\mathrm{N}\\,\\mathrm{m}^{-2}$).\n- Ekman transport components must be computed consistently from the momentum balance with correct vector directions and units.\n- Ekman pumping velocity $w_E(x,y)$ is in meters per second ($\\mathrm{m}\\,\\mathrm{s}^{-1}$).\n- Angles in trigonometric functions are in radians.\n\nNumerical differentiation:\n- Use centered finite differences with periodic boundary conditions to approximate $\\partial/\\partial x$ and $\\partial/\\partial y$ for the divergence of the transport field. For a field $A(x_i,y_j)$ on the grid, approximate $\\partial A/\\partial x$ at $(i,j)$ by $(A(i+1,j)-A(i-1,j))/(2\\,\\Delta x)$ using periodic indexing, and similarly for $\\partial A/\\partial y$.\n\nTest Suite:\nFor each test case below, construct the wind stress and compute the required errors. Use the exact values provided, including units.\n\n1. Smooth, non-separable trigonometric wind stress with different periodicities in $x$ and $y$:\n   - $N_x = 101$, $N_y = 117$.\n   - $L_x = 1.0\\times 10^6\\ \\mathrm{m}$, $L_y = 0.8\\times 10^6\\ \\mathrm{m}$.\n   - $\\rho = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$.\n   - $\\tau_0 = 0.2\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$.\n   - Define $k_x = 2\\pi/L_x$ and $k_y = 2\\pi/L_y$.\n   - Prescribe $\\tau_x(x,y) = \\tau_0\\,\\sin(k_x x)\\,\\cos(k_y y)$ and $\\tau_y(x,y) = \\tau_0\\,\\cos(k_x x)\\,\\sin(k_y y)$.\n   - Compute the analytical Ekman pumping by analytically differentiating $\\tau_x$ and $\\tau_y$.\n\n2. Uniform wind stress:\n   - $N_x = 64$, $N_y = 48$.\n   - $L_x = 1.2\\times 10^6\\ \\mathrm{m}$, $L_y = 1.0\\times 10^6\\ \\mathrm{m}$.\n   - $\\rho = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$.\n   - $\\tau_0 = 0.1\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$.\n   - Prescribe $\\tau_x(x,y) = \\tau_0$ and $\\tau_y(x,y) = 0$.\n   - Compute the analytical Ekman pumping by analytically differentiating $\\tau_x$ and $\\tau_y$.\n\n3. Potential wind stress (zero analytical curl), with scalar potential $\\phi(x,y)$:\n   - $N_x = 97$, $N_y = 91$.\n   - $L_x = 2.0\\times 10^6\\ \\mathrm{m}$, $L_y = 2.5\\times 10^6\\ \\mathrm{m}$.\n   - $\\rho = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$.\n   - $\\tau_0 = 0.5\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$.\n   - Define $k_x = 2\\pi/L_x$ and $k_y = 2\\pi/L_y$, with integer multipliers $m_x = 2$, $m_y = 3$.\n   - Let $\\phi(x,y) = \\tau_0\\,\\sin(m_x k_x x)\\,\\sin(m_y k_y y)$, and prescribe $\\tau_x(x,y) = \\partial \\phi/\\partial x$ and $\\tau_y(x,y) = \\partial \\phi/\\partial y$.\n   - Compute the analytical Ekman pumping by analytically differentiating $\\tau_x$ and $\\tau_y$.\n\n4. High-frequency trigonometric wind stress:\n   - $N_x = 128$, $N_y = 96$.\n   - $L_x = 1.0\\times 10^6\\ \\mathrm{m}$, $L_y = 0.9\\times 10^6\\ \\mathrm{m}$.\n   - $\\rho = 1025\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$.\n   - $\\tau_0 = 0.3\\ \\mathrm{N}\\,\\mathrm{m}^{-2}$.\n   - Define $k_x = 2\\pi/L_x$ and $k_y = 2\\pi/L_y$, with integer multipliers $m_x = 12$, $m_y = 9$.\n   - Prescribe $\\tau_x(x,y) = \\tau_0\\,\\sin(m_x k_x x)\\,\\cos(m_y k_y y)$ and $\\tau_y(x,y) = \\tau_0\\,\\cos(m_x k_x x)\\,\\sin(m_y k_y y)$.\n   - Compute the analytical Ekman pumping by analytically differentiating $\\tau_x$ and $\\tau_y$.\n\nAnswer specification:\n- For each test case, compute the root-mean-square error between the numerical and analytical Ekman pumping fields, expressed in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ as a floating-point number.\n- Your program should produce a single line of output containing the four error values for the test cases as a comma-separated list enclosed in square brackets (for example, $[\\text{err}_1,\\text{err}_2,\\text{err}_3,\\text{err}_4]$), with no other text.",
            "solution": "The user has provided a well-posed problem in computational oceanography. I will first validate the problem, then provide a detailed derivation of the analytical solution, and finally present the numerical implementation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Objective:** Compute the Ekman pumping velocity, $w_E$, using two methods: (i) numerically, as the divergence of the Ekman transport field $\\mathbf{U}_E$, and (ii) analytically, as the curl of the wind stress $\\boldsymbol{\\tau}$. Calculate the root-mean-square (RMS) error between the two methods for a suite of test cases.\n- **Governing Equations:** Steady horizontal momentum balance and mass continuity for an incompressible fluid.\n- **Assumptions:** Homogeneous fluid of constant density $\\rho$; constant Coriolis parameter $f$; thin Ekman layer; depth-integrated formulation.\n- **Domain:** A doubly periodic rectangle of size $L_x \\times L_y$, discretized on a uniform grid of $N_x \\times N_y$ points. Grid points are $x_i = i\\,\\Delta x$ for $i \\in \\{0, \\dots, N_x-1\\}$ and $y_j = j\\,\\Delta y$ for $j \\in \\{0, \\dots, N_y-1\\}$, with $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$.\n- **Numerical Method:** Centered finite differences with periodic boundary conditions for spatial derivatives. For a field $A(i,j)$, $\\frac{\\partial A}{\\partial x} \\approx \\frac{A(i+1,j) - A(i-1,j)}{2\\,\\Delta x}$.\n- **Physical Parameters:** $\\rho$ ($\\mathrm{kg}\\,\\mathrm{m}^{-3}$), $f$ ($\\mathrm{s}^{-1}$), $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ ($\\mathrm{N}\\,\\mathrm{m}^{-2}$).\n- **Test Cases:** Four specific cases are defined with all necessary parameters ($N_x, N_y, L_x, L_y, \\rho, f, \\tau_0$) and functional forms for the wind stress fields $\\tau_x(x,y)$ and $\\tau_y(x,y)$.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem is a standard exercise in geophysical fluid dynamics, based on the well-established theory of the Ekman layer. All principles are fundamental to the field.\n- **Well-Posed:** The problem is clearly defined and provides all necessary constants, boundary conditions, and functional forms to derive and compute a unique, stable, and meaningful solution.\n- **Objective:** The problem is stated in precise mathematical and physical terms, free of any subjectivity or ambiguity.\n- **All other criteria for validity (completeness, consistency, realism, structure) are met.** The problem is a standard verification test for a numerical ocean model component.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. I will proceed with the derivation and solution.\n\n### Analytical Derivation of Ekman Pumping\n\nThe derivation begins with the steady, linear, horizontal momentum equations in a rotating frame, where the primary balance in the surface Ekman layer is between the Coriolis force and the vertical divergence of turbulent stress.\n\nThe momentum equations are:\n$$\n-f v = \\frac{1}{\\rho} \\frac{\\partial \\sigma_{xz}}{\\partial z}\n$$\n$$\nf u = \\frac{1}{\\rho} \\frac{\\partial \\sigma_{yz}}{\\partial z}\n$$\nwhere $(u, v)$ are the horizontal velocity components in the $x$ and $y$ directions, respectively, $f$ is the Coriolis parameter, $\\rho$ is the constant water density, and $\\sigma_{xz}$ and $\\sigma_{yz}$ are the vertical turbulent stress components.\n\nWe integrate these equations over the depth of the Ekman layer, from its base at $z = -H_E$ to the sea surface at $z = 0$.\n$$\n\\int_{-H_E}^{0} -f v \\,dz = \\frac{1}{\\rho} \\int_{-H_E}^{0} \\frac{\\partial \\sigma_{xz}}{\\partial z} \\,dz\n$$\n$$\n\\int_{-H_E}^{0} f u \\,dz = \\frac{1}{\\rho} \\int_{-H_E}^{0} \\frac{\\partial \\sigma_{yz}}{\\partial z} \\,dz\n$$\nThe Ekman transport components are defined as the depth-integrated velocities: $U_E = \\int_{-H_E}^{0} u \\,dz$ and $V_E = \\int_{-H_E}^{0} v \\,dz$. Applying the fundamental theorem of calculus to the right-hand side gives:\n$$\n-f V_E = \\frac{1}{\\rho} \\left[ \\sigma_{xz} \\right]_{z=-H_E}^{z=0} = \\frac{1}{\\rho} (\\sigma_{xz}(0) - \\sigma_{xz}(-H_E))\n$$\n$$\nf U_E = \\frac{1}{\\rho} \\left[ \\sigma_{yz} \\right]_{z=-H_E}^{z=0} = \\frac{1}{\\rho} (\\sigma_{yz}(0) - \\sigma_{yz}(-H_E))\n$$\nAt the sea surface ($z=0$), the turbulent stress equals the wind stress: $\\sigma_{xz}(0) = \\tau_x$ and $\\sigma_{yz}(0) = \\tau_y$. At the base of the Ekman layer ($z=-H_E$), the stress is assumed to have decayed to zero: $\\sigma_{xz}(-H_E) = 0$ and $\\sigma_{yz}(-H_E) = 0$.\nThe transport equations simplify to:\n$$\n-f V_E = \\frac{\\tau_x}{\\rho} \\quad \\implies \\quad V_E = -\\frac{\\tau_x}{\\rho f}\n$$\n$$\nf U_E = \\frac{\\tau_y}{\\rho} \\quad \\implies \\quad U_E = \\frac{\\tau_y}{\\rho f}\n$$\nThese equations define the Ekman transport vector $\\mathbf{U}_E = (U_E, V_E)$ in terms of the wind stress vector $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$.\n\nNext, we use the mass continuity equation for an incompressible fluid:\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0\n$$\nWe integrate this equation over the same depth range, from $z=-H_E$ to $z=0$:\n$$\n\\int_{-H_E}^{0} \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) dz + \\int_{-H_E}^{0} \\frac{\\partial w}{\\partial z} dz = 0\n$$\nSince the limits of integration are constant, we can interchange differentiation and integration (by the Leibniz rule):\n$$\n\\frac{\\partial}{\\partial x} \\left( \\int_{-H_E}^{0} u \\,dz \\right) + \\frac{\\partial}{\\partial y} \\left( \\int_{-H_E}^{0} v \\,dz \\right) + \\left[ w \\right]_{z=-H_E}^{z=0} = 0\n$$\nSubstituting the definitions of Ekman transport, this becomes:\n$$\n\\frac{\\partial U_E}{\\partial x} + \\frac{\\partial V_E}{\\partial y} + w(0) - w(-H_E) = 0\n$$\nThe vertical velocity at the sea surface is taken to be zero, $w(0) = 0$ (the rigid-lid approximation). The vertical velocity at the base of the Ekman layer, $w(-H_E)$, is defined as the Ekman pumping velocity, $w_E$. This velocity represents the water being pumped into or out of the ocean interior from the surface boundary layer. The equation becomes:\n$$\n\\frac{\\partial U_E}{\\partial x} + \\frac{\\partial V_E}{\\partial y} - w_E = 0\n$$\nThis gives the first required expression for $w_E$ as the divergence of the Ekman transport:\n$$\nw_E = \\nabla \\cdot \\mathbf{U}_E = \\frac{\\partial U_E}{\\partial x} + \\frac{\\partial V_E}{\\partial y}\n$$\nThis is the basis for the **numerical method**.\n\nTo obtain the **analytical expression**, we substitute the relations for $U_E$ and $V_E$ in terms of the wind stress into the equation for $w_E$:\n$$\nw_E = \\frac{\\partial}{\\partial x} \\left( \\frac{\\tau_y}{\\rho f} \\right) + \\frac{\\partial}{\\partial y} \\left( -\\frac{\\tau_x}{\\rho f} \\right)\n$$\nSince $\\rho$ and $f$ are constants, they can be factored out of the derivatives:\n$$\nw_E = \\frac{1}{\\rho f} \\left( \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y} \\right)\n$$\nThis is the second required expression, relating the Ekman pumping velocity directly to the curl of the wind stress field, $\\mathbf{k} \\cdot (\\nabla \\times \\boldsymbol{\\tau}) = \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}$, where $\\mathbf{k}$ is the unit vector in the $z$ direction.\n\n### Numerical Implementation Strategy\n\nThe program will execute the following steps for each test case:\n1.  **Grid Generation:** Create 2D coordinate arrays `xx` and `yy` of shape $(N_x, N_y)$ representing the domain, using `numpy.meshgrid` with `indexing='ij'`.\n2.  **Wind Stress Fields:** Evaluate the given functions for $\\tau_x(x,y)$ and $\\tau_y(x,y)$ on the grid to create arrays `tau_x` and `tau_y`.\n3.  **Analytical Ekman Pumping:** Evaluate the analytically derived expressions for $w_E(x, y)$ on the grid to create the reference solution array `w_ana_field`. For cases where the curl of the wind stress is analytically zero, this field will be an array of zeros.\n4.  **Numerical Ekman Pumping:**\n    a.  Compute the Ekman transport component arrays: `U_E = tau_y / (rho * f)` and `V_E = -tau_x / (rho * f)`.\n    b.  Numerically compute the divergence of the transport field. The partial derivatives $\\partial U_E / \\partial x$ and $\\partial V_E / \\partial y$ are approximated using a centered finite difference scheme on the periodic grid. The `numpy.roll` function is ideally suited for implementing periodic boundary conditions.\n    $$\n    \\frac{\\partial A}{\\partial x}\\bigg|_{i,j} \\approx \\frac{A_{i+1, j} - A_{i-1, j}}{2\\Delta x} \\quad \\text{and} \\quad \\frac{\\partial A}{\\partial y}\\bigg|_{i,j} \\approx \\frac{A_{i, j+1} - A_{i, j-1}}{2\\Delta y}\n    $$\n    The resulting array is `w_num_field`.\n5.  **Error Calculation:** Compute the root-mean-square error between the numerical and analytical fields: $ \\text{RMSE} = \\sqrt{\\langle (w_{\\text{num\\_field}} - w_{\\text{ana\\_field}})^2 \\rangle} $, where $\\langle \\cdot \\rangle$ denotes the spatial average over the entire domain.\nThe process is repeated for all four test cases, and the resulting RMSE values are collected.",
            "answer": "```python\nimport numpy as np\n\ndef compute_ekman_error(params: dict) -> float:\n    \"\"\"\n    Computes the RMS error between analytical and numerical Ekman pumping\n    for a given set of parameters and wind stress field.\n    \"\"\"\n    # Unpack domain and physical parameters\n    Nx, Ny = params['Nx'], params['Ny']\n    Lx, Ly = params['Lx'], params['Ly']\n    rho, f, tau0 = params['rho'], params['f'], params['tau0']\n    \n    # Create grid\n    dx = Lx / Nx\n    dy = Ly / Ny\n    x = np.arange(Nx) * dx\n    y = np.arange(Ny) * dy\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    # Define wavenumbers\n    kx = 2.0 * np.pi / Lx\n    ky = 2.0 * np.pi / Ly\n\n    # Branch based on test case ID to define wind stress and analytical solution\n    case_id = params['case_id']\n    if case_id == 1:\n        # Case 1: Smooth, non-separable trigonometric wind stress\n        tau_x = tau0 * np.sin(kx * xx) * np.cos(ky * yy)\n        tau_y = tau0 * np.cos(kx * xx) * np.sin(ky * yy)\n        \n        # w_ana = (1/(rho*f)) * (d(tau_y)/dx - d(tau_x)/dy)\n        # d(tau_y)/dx = -tau0 * kx * sin(kx*x) * sin(ky*y)\n        # d(tau_x)/dy = -tau0 * ky * sin(kx*x) * sin(ky*y)\n        # curl = tau0 * (ky - kx) * sin(kx*x) * sin(ky*y)\n        w_ana_field = (tau0 * (ky - kx) / (rho * f)) * np.sin(kx * xx) * np.sin(ky * yy)\n        \n    elif case_id == 2:\n        # Case 2: Uniform wind stress\n        tau_x = tau0 * np.ones_like(xx)\n        tau_y = np.zeros_like(xx)\n        \n        # curl is zero for constant fields\n        w_ana_field = np.zeros_like(xx)\n        \n    elif case_id == 3:\n        # Case 3: Potential wind stress (zero analytical curl)\n        mx, my = params['m_xy']\n        \n        # tau = grad(phi), where phi = tau0 * sin(mx*kx*x) * sin(my*ky*y)\n        # tau_x = d(phi)/dx = tau0 * (mx*kx) * cos(mx*kx*x) * sin(my*ky*y)\n        # tau_y = d(phi)/dy = tau0 * (my*ky) * sin(mx*kx*x) * cos(my*ky*y)\n        tau_x = tau0 * (mx * kx) * np.cos(mx * kx * xx) * np.sin(my * ky * yy)\n        tau_y = tau0 * (my * ky) * np.sin(mx * kx * xx) * np.cos(my * ky * yy)\n\n        # Curl of a gradient is analytically zero\n        w_ana_field = np.zeros_like(xx)\n\n    elif case_id == 4:\n        # Case 4: High-frequency trigonometric wind stress\n        mx, my = params['m_xy']\n        kx_m = mx * kx\n        ky_m = my * ky\n        \n        tau_x = tau0 * np.sin(kx_m * xx) * np.cos(ky_m * yy)\n        tau_y = tau0 * np.cos(kx_m * xx) * np.sin(ky_m * yy)\n        \n        # Same form as case 1, with modified wavenumbers\n        w_ana_field = (tau0 * (ky_m - kx_m) / (rho * f)) * np.sin(kx_m * xx) * np.sin(ky_m * yy)\n        \n    else:\n        raise ValueError(f\"Invalid case_id: {case_id}\")\n\n    # --- Numerical Calculation ---\n    \n    # 1. Compute Ekman transport\n    # U_E = tau_y / (rho * f)\n    # V_E = -tau_x / (rho * f)\n    U_E = tau_y / (rho * f)\n    V_E = -tau_x / (rho * f)\n\n    # 2. Compute numerical divergence of transport field\n    # w_E = d(U_E)/dx + d(V_E)/dy\n    # Using centered differences with periodic boundaries via np.roll\n    # axis=0 corresponds to x-direction (since indexing='ij')\n    # axis=1 corresponds to y-direction\n    \n    dUe_dx = (np.roll(U_E, -1, axis=0) - np.roll(U_E, 1, axis=0)) / (2.0 * dx)\n    dVe_dy = (np.roll(V_E, -1, axis=1) - np.roll(V_E, 1, axis=1)) / (2.0 * dy)\n    \n    w_num_field = dUe_dx + dVe_dy\n\n    # --- Error Calculation ---\n    \n    # Compute Root-Mean-Square Error\n    rmse = np.sqrt(np.mean((w_num_field - w_ana_field)**2))\n    \n    return rmse\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"case_id\": 1,\n            \"Nx\": 101, \"Ny\": 117,\n            \"Lx\": 1.0e6, \"Ly\": 0.8e6,\n            \"rho\": 1025.0, \"f\": 1.0e-4,\n            \"tau0\": 0.2,\n        },\n        {\n            \"case_id\": 2,\n            \"Nx\": 64, \"Ny\": 48,\n            \"Lx\": 1.2e6, \"Ly\": 1.0e6,\n            \"rho\": 1025.0, \"f\": 1.0e-4,\n            \"tau0\": 0.1,\n        },\n        {\n            \"case_id\": 3,\n            \"Nx\": 97, \"Ny\": 91,\n            \"Lx\": 2.0e6, \"Ly\": 2.5e6,\n            \"rho\": 1025.0, \"f\": 1.0e-4,\n            \"tau0\": 0.5,\n            \"m_xy\": (2, 3),\n        },\n        {\n            \"case_id\": 4,\n            \"Nx\": 128, \"Ny\": 96,\n            \"Lx\": 1.0e6, \"Ly\": 0.9e6,\n            \"rho\": 1025.0, \"f\": 1.0e-4,\n            \"tau0\": 0.3,\n            \"m_xy\": (12, 9),\n        },\n    ]\n\n    results = []\n    for case_params in test_cases:\n        error = compute_ekman_error(case_params)\n        results.append(error)\n\n    # Format output as specified: a list of floats\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}