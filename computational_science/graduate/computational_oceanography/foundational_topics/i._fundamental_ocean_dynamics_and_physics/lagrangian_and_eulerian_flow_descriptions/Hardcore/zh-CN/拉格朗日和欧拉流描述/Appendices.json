{
    "hands_on_practices": [
        {
            "introduction": "该练习在欧拉和拉格朗日框架之间建立了一座基础的桥梁。通过对一个给定的定常欧拉速度场进行积分，您将推导出流体粒子的显式时间依赖路径，从而巩固基本关系 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{v}(\\mathbf{x}, t)$。这项实践旨在强化将空间速度图谱转化为时间轨迹所需的数学技能。",
            "id": "1769254",
            "problem": "在一个微流控设备中，建立了一个稳态的二维流体流动以产生一个微型涡旋。$xy$平面上该流动的欧拉速度场由$\\vec{v}(x, y) = -\\Omega y \\hat{i} + \\Omega x \\hat{j}$给出，其中$\\Omega$是一个正常数，代表流体类刚体旋转的角频率，$\\hat{i}$和$\\hat{j}$分别是$x$和$y$方向上的单位向量。一个小的中性浮力粒子被释放到该流体中，并被假定为被动示踪剂，这意味着其速度始终与局部流体速度相同。在时间$t=0$时，该粒子位于初始位置$(x_0, y_0) = (L, 0)$，其中$L$是一个正常数。\n\n对于任意时间$t \\geq 0$，确定该粒子的拉格朗日位置，由其坐标$(x(t), y(t))$给出。请将您的答案表示为关于$L$、$\\Omega$和$t$的$x(t)$和$y(t)$函数对。",
            "solution": "因为该粒子是一个被动示踪剂，其速度等于局部流体速度。因此，其拉格朗日坐标满足方程组\n$$\\frac{dx}{dt}=-\\Omega y,\\qquad \\frac{dy}{dt}=\\Omega x,$$\n初始条件为 $x(0)=L$ 和 $y(0)=0$。\n\n对第一个方程关于$t$求导，并使用第二个方程消去$y$：\n$$\\frac{d^{2}x}{dt^{2}}=-\\Omega \\frac{dy}{dt}=-\\Omega(\\Omega x)=-\\Omega^{2}x.$$\n这是谐振子方程，其通解为\n$$x(t)=A\\cos(\\Omega t)+B\\sin(\\Omega t).$$\n应用$x(0)=L$得到$A=L$。接下来，计算$\\frac{dx}{dt}$：\n$$\\frac{dx}{dt}=-A\\Omega \\sin(\\Omega t)+B\\Omega \\cos(\\Omega t).$$\n使用$\\frac{dx}{dt}=-\\Omega y$和$y(0)=0$得到$\\frac{dx}{dt}\\big|_{t=0}=0$，因此\n$$0=\\frac{dx}{dt}\\big|_{t=0}=B\\Omega \\quad \\Rightarrow \\quad B=0.$$\n因此，\n$$x(t)=L\\cos(\\Omega t).$$\n由$\\frac{dy}{dt}=\\Omega x$和$y(0)=0$可得，\n$$y(t)=\\int_{0}^{t}\\Omega x(s)\\,ds=\\int_{0}^{t}\\Omega L\\cos(\\Omega s)\\,ds=L\\sin(\\Omega t).$$\n直接检验表明$\\frac{dx}{dt}=-\\Omega y$和$\\frac{dy}{dt}=\\Omega x$均被满足，因此解是一致的。\n\n因此，拉格朗日位置是$\\big(x(t),y(t)\\big)=\\big(L\\cos(\\Omega t),\\,L\\sin(\\Omega t)\\big)$。",
            "answer": "$$\\boxed{(L\\cos(\\Omega t), L\\sin(\\Omega t))}$$"
        },
        {
            "introduction": "在真实的海洋流动中，流场条件很少是恒定不变的。该练习深入探讨了在时变速度场中出现的路径线、流线和迹线之间的关键区别。通过为一个简单的非定常流解析地推导出这三种线，您将对每种可视化技术所真正代表的含义获得深刻的性理解。",
            "id": "3796714",
            "problem": "考虑一个二维、水平方向均匀但随时间变化的海洋表层流，在欧拉框架下，其速度场由 $\\mathbf{u}(x,y,t) = \\left(U_0 + U_1 \\sin(\\omega t)\\right)\\,\\hat{\\mathbf{i}}$ 描述，其中 $U_0$、$U_1$ 和 $\\omega$ 是正常数，且满足 $U_0  |U_1|$ 以确保流向在所有时刻都保持顺流（$+\\hat{\\mathbf{i}}$方向）。从位于原点 $(x,y)=(0,0)$ 的点源处，自时间 $t=0$ 开始连续释放一种被动示踪剂。在整个过程中，假设表层流为不可压缩、无散的，并忽略垂直运动。\n\n仅使用基本运动学以及流体力学中拉格朗日和欧拉描述的定义，完成以下任务：\n\n1) 从**路径线**的定义（即单个流体元的拉格朗日轨迹）出发，它满足常微分方程（ODEs）$dx/dt = u(x(t),y(t),t)$ 和 $dy/dt = v(x(t),y(t),t)$，初始条件为 $x(t_0)=x_0$ 和 $y(t_0)=y_0$，推导在时间 $t_0$ 位于 $(x_0,y_0)$ 的粒子的**路径线** $(x(t),y(t))$ 的解析表达式。\n\n2) 使用流线的定义（即在固定时间 $t^{\\ast}$，处处与瞬时速度场相切的曲线），它满足 $dy/dx = v(x,y,t^{\\ast})/u(x,y,t^{\\ast})$，推导在时间 $t^{\\ast}$ 经过一个通用点 $(x^{\\ast},y^{\\ast})$ 的流线方程。\n\n3) 使用**迹线**的定义（即在时间 $t=T$，所有先前在某个释放时间 $\\tau \\in [0,T]$ 经过源点 $(0,0)$ 的流体粒子的轨迹），推导时间 $T$ 时**迹线**关于释放时间 $\\tau$ 的参数表示。然后，利用假设 $U_0  |U_1|$，确定哪个释放时间 $\\tau$ 产生**迹线**的最远顺流点，并推导时间 $T$ 时**迹线**顺流范围的显式闭式表达式。\n\n4) 简要但严谨地讨论此流场中**路径线**、流线（在固定时间）和**迹线**之间的异同，强调哪些方面是相同的，哪些方面取决于流场的时间变化性。\n\n最后，以 $U_0$、$U_1$、$\\omega$ 和 $T$ 的形式给出在第 3 部分中推导出的顺流范围的单一闭式表达式。由于 $U_0$ 和 $U_1$ 是以米/秒为单位的速度，$\\omega$ 是以弧度/秒为单位的角频率，而 $T$ 是以秒为单位的时间，因此顺流范围的单位是米。以 $U_0$、$U_1$、$\\omega$ 和 $T$ 的符号形式表示最终结果；在您的方框最终答案中不要附加单位。",
            "solution": "问题描述了一个二维、随时间变化但空间均匀的海洋表层流。其欧拉速度场由 $\\mathbf{u}(x,y,t) = \\left(U_0 + U_1 \\sin(\\omega t)\\right)\\,\\hat{\\mathbf{i}}$ 给出，其分量为 $u(x,y,t) = U_0 + U_1 \\sin(\\omega t)$ 和 $v(x,y,t) = 0$。常数 $U_0$、$U_1$ 和 $\\omega$ 均为正，条件 $U_0  U_1$ 确保流向始终在正 $\\hat{\\mathbf{i}}$ 方向。\n\n1) **路径线**，记为 $(x(t), y(t))$，是单个流体粒子的轨迹。它通过对速度场进行时间积分来确定，并服从初始条件 $(x(t_0), y(t_0)) = (x_0, y_0)$。控制常微分方程为：\n$$\n\\frac{dx}{dt} = u(x(t), y(t), t) = U_0 + U_1 \\sin(\\omega t)\n$$\n$$\n\\frac{dy}{dt} = v(x(t), y(t), t) = 0\n$$\n我们对 $y$ 分量的方程从初始时间 $t_0$ 到一个通用时间 $t$ 进行积分：\n$$\n\\int_{y_0}^{y(t)} dy' = \\int_{t_0}^{t} 0 \\, dt' \\implies y(t) - y_0 = 0 \\implies y(t) = y_0\n$$\n这个结果表明，粒子的运动被限制在它开始时所在的水平线上。\n接下来，我们对 $x$ 分量的方程从 $t_0$ 到 $t$ 进行积分：\n$$\n\\int_{x_0}^{x(t)} dx' = \\int_{t_0}^{t} \\left( U_0 + U_1 \\sin(\\omega t') \\right) \\, dt'\n$$\n$$\nx(t) - x_0 = \\int_{t_0}^{t} U_0 \\, dt' + \\int_{t_0}^{t} U_1 \\sin(\\omega t') \\, dt'\n$$\n$$\nx(t) - x_0 = U_0 [t']_{t_0}^{t} + U_1 \\left[ -\\frac{1}{\\omega}\\cos(\\omega t') \\right]_{t_0}^{t}\n$$\n$$\nx(t) - x_0 = U_0(t - t_0) - \\frac{U_1}{\\omega} \\left( \\cos(\\omega t) - \\cos(\\omega t_0) \\right)\n$$\n因此，粒子 x 坐标的解析表达式为：\n$$\nx(t) = x_0 + U_0(t - t_0) - \\frac{U_1}{\\omega}(\\cos(\\omega t) - \\cos(\\omega t_0))\n$$\n完整的**路径线**由数对 $(x(t), y(t))$ 给出。\n\n2) 流线是在固定时间 $t^{\\ast}$ 处处与瞬时速度场相切的曲线。其在 $(x,y)$ 平面上的斜率由微分方程定义：\n$$\n\\frac{dy}{dx} = \\frac{v(x,y,t^{\\ast})}{u(x,y,t^{\\ast})}\n$$\n在固定时间 $t^{\\ast}$，速度分量为 $u(x,y,t^{\\ast}) = U_0 + U_1 \\sin(\\omega t^{\\ast})$ 和 $v(x,y,t^{\\ast}) = 0$。将这些代入方程得到：\n$$\n\\frac{dy}{dx} = \\frac{0}{U_0 + U_1 \\sin(\\omega t^{\\ast})}\n$$\n条件 $U_0  U_1$ 确保分母 $U_0 + U_1 \\sin(\\omega t^{\\ast})$ 始终为正，因为其最小值为 $U_0 - U_1  0$。因此，流线的斜率始终为零：\n$$\n\\frac{dy}{dx} = 0\n$$\n对该方程积分得到 $y = C$，其中 $C$ 是一个常数。对于经过点 $(x^{\\ast}, y^{\\ast})$ 的流线，常数必须为 $C = y^{\\ast}$。因此，流线方程为：\n$$\ny = y^{\\ast}\n$$\n这表明对于此流场，任何时刻的流线都是一族水平线。\n\n3) 时间 $T$ 时的**迹线**是所有在某个先前释放时间 $\\tau$（其中 $0 \\le \\tau \\le T$）经过一个特定点——本例中为原点 $(0,0)$——的流体粒子的位置轨迹。为了找到**迹线**，我们考虑一个在时间 $t_0=\\tau$ 从 $(x_0, y_0) = (0,0)$ 释放的粒子，并确定其在观测时间 $t=T$ 的位置 $(x,y)$。我们使用在第(1)部分中推导出的路径线方程，并代入这些特定参数。\n在时间 $T$，任何此类粒子的 y 坐标为 $y(T) = y_0 = 0$。\n通过在 $x(t)$ 的路径线方程中设置 $x_0=0$、$t_0=\\tau$ 和 $t=T$，可以找到 x 坐标：\n$$\nx(T; \\tau) = 0 + U_0(T - \\tau) - \\frac{U_1}{\\omega}(\\cos(\\omega T) - \\cos(\\omega \\tau))\n$$\n为了清晰起见进行整理，我们得到时间 $T$ 时**迹线** x 坐标的参数表示，参数为 $\\tau$：\n$$\nx_{\\text{streak}}(T; \\tau) = U_0(T - \\tau) + \\frac{U_1}{\\omega}(\\cos(\\omega \\tau) - \\cos(\\omega T))\n$$\n**迹线**本身位于 x 轴上，从原点（在 $\\tau=T$ 时刻刚刚释放的粒子）延伸到对应于在 $\\tau=0$ 时刻释放的粒子的点。\n为了找到最远的顺流点，我们必须找到 $x_{\\text{streak}}(T; \\tau)$ 在 $\\tau \\in [0, T]$ 上的最大值。我们对 $x_{\\text{streak}}(T; \\tau)$ 关于 $\\tau$ 求导：\n$$\n\\frac{d}{d\\tau}x_{\\text{streak}}(T; \\tau) = -U_0 - U_1 \\sin(\\omega \\tau)\n$$\n为了找到临界点，我们将此导数设为零，得到 $\\sin(\\omega \\tau) = -\\frac{U_0}{U_1}$。然而，给定的约束 $U_0  U_1  0$ 意味着 $-\\frac{U_0}{U_1}  -1$。正弦函数不能取该值，因此在定义域内部没有临界点。因此，最大值必须出现在区间 $\\tau \\in [0, T]$ 的一个边界上，即在 $\\tau=0$ 或 $\\tau=T$。\n我们可以检查导数的符号。由于 $-1 \\le \\sin(\\omega \\tau) \\le 1$，项 $-U_1 \\sin(\\omega \\tau)$ 位于 $[-U_1, U_1]$ 内。导数因此是有界的：$\\frac{d}{d\\tau}x_{\\text{streak}}(T; \\tau) \\le -U_0 + U_1$。由于 $U_0  U_1$，量 $-U_0 + U_1$ 为负。因此，对于所有 $\\tau$ 值，$\\frac{d}{d\\tau}x_{\\text{streak}}(T; \\tau)  0$。\n这意味着 $x_{\\text{streak}}(T; \\tau)$ 是关于 $\\tau$ 的严格递减函数。最大值必须在 $\\tau$ 的最小值处取得，即 $\\tau=0$。在物理上，这对应于最先释放、运动时间最长的粒子。顺流范围就是这个最大的 x 值：\n$$\nx_{\\text{max}} = x_{\\text{streak}}(T; 0) = U_0(T - 0) + \\frac{U_1}{\\omega}(\\cos(\\omega \\cdot 0) - \\cos(\\omega T))\n$$\n$$\nx_{\\text{max}} = U_0 T + \\frac{U_1}{\\omega}(1 - \\cos(\\omega T))\n$$\n这就是所求的**迹线**顺流范围的闭式表达式。\n\n4) 对于这个特定的单向但非定常的流场，**路径线**、流线和**迹线**之间的关系如下：\n- **相同点**：这三种曲线在几何上是相同的：它们都是水平直线。这是速度场是单向的（始终在 $+\\hat{\\mathbf{i}}$ 方向）的直接结果。流线是一条 $y = \\text{常数}$ 的线。路径线是这样一条线的一个线段。来自点源的迹线也是这样一条线的一个线段。\n- **不同点**：主要的不同是概念上的，源于流场是非定常的（$U_1 \\neq 0$）。\n  - **流线**是流向的瞬时“地图”。在这里，无论时间 $t^{\\ast}$ 如何，它总是一条水平线。\n  - **路径线**是单个粒子运动的积分历史。虽然路径是一条直线，但粒子沿其运动的速度，$u(t) = U_0 + U_1 \\sin(\\omega t)$，随时间变化。\n  - **迹线**是具有不同历史的粒子集合的瞬时快照。在时间 $T$，它显示了在 $0 \\le \\tau \\le T$ 时间段内从源点释放的所有粒子的位置。如第(3)部分所求，**迹线**的长度取决于时间积分的流场历史，并且不是时间的简单线性函数。\n  - 如果流场是定常的（$U_1=0$），速度将是一个常数 $U_0\\,\\hat{\\mathbf{i}}$。在这种情况下，**路径线**、流线和**迹线**将完全相同。正是流场的非定常性使它们成为不同的概念，即使在这个特殊情况下它们共享简单的几何形状。",
            "answer": "$$\n\\boxed{U_0 T + \\frac{U_1}{\\omega}(1 - \\cos(\\omega T))}\n$$"
        },
        {
            "introduction": "大多数真实的海洋学速度场都过于复杂，无法进行解析积分，因此必须采用数值方法。这项动手计算练习要求您实现广泛使用的四阶龙格-库塔 (RK4) 格式来追踪一个拉格朗日粒子。通过将您的数值轨迹与精确解进行比较，您将直接量化局部截断误差的概念，并验证该方法的精度阶数。",
            "id": "3796715",
            "problem": "考虑一个由常微分方程 $\\dot{\\mathbf{X}}=\\mathbf{u}(\\mathbf{X},t)$ 控制的二维拉格朗日粒子轨迹，其中 $\\mathbf{X}(t)\\in\\mathbb{R}^2$ 表示粒子位置，$\\mathbf{u}(\\mathbf{x},t)$ 是欧拉速度场。目标是构建一个数值积分器，并从第一性原理分析其局部截断误差。从拉格朗日和欧拉流动描述的核心定义以及单步法的局部截断误差定义开始。仅使用基本定律 $\\dot{\\mathbf{X}}=\\mathbf{u}(\\mathbf{X},t)$、时间步长 $h0$ 的定义以及围绕点 $(\\mathbf{X}(t_0),t_0)$ 的泰勒级数展开。\n\n您必须实现一个经典的四阶龙格－库塔（RK）格式，用于单个时间步长，通过在中间阶段点上对 $\\mathbf{u}$ 进行求值，将 $\\mathbf{X}(t_0)$ 推进到 $\\mathbf{X}(t_0+h)$ 的一个近似值。然后，您必须计算此单步的局部截断误差，即对于给定的随时间变化的中尺度速度场，数值单步更新与精确单步解之差的欧几里得范数（以米为单位）。\n\n使用以下由时变角速度定义的、科学上真实的、随时间变化的中尺度涡旋场：\n- 速度场为 $\\mathbf{u}(\\mathbf{x},t)=\\Omega(t)\\,(-y,x)$，其中 $\\mathbf{x}=(x,y)$。\n- 角速度为 $\\Omega(t)=\\Omega_0+\\Omega_1\\sin(\\sigma t)$。\n- 所有角度必须以弧度为单位。\n\n在此场下，从 $(\\mathbf{X}(t_0),t_0)$ 到时间 $t_0+h$ 的精确单步解是将初始位置旋转一个角度，该角度等于 $\\Omega(t)$ 在区间 $[t_0,t_0+h]$ 上的时间积分。您必须利用此性质来计算精确的单步位置，并由此计算局部截断误差。\n\n物理和数值单位：\n- 位置必须以米（m）为单位。\n- 时间必须以秒（s）为单位。\n- 所有输出均以米（m）表示，通过常规浮点表示法四舍五入。角度以弧度为单位。\n\n测试套件：\n实现您的程序，为以下四个测试案例计算结果。每个案例指定 $(\\Omega_0,\\Omega_1,\\sigma)$、初始条件 $\\mathbf{X}_0$、初始时间 $t_0$ 和步长 $h$。对于收敛性案例，您必须计算两个不同步长下的局部截断误差之比。\n\n- 案例 1（常规、时变涡旋；“理想情况”）：\n  - $\\Omega_0=1.2\\times 10^{-5}\\ \\text{s}^{-1}$，$\\Omega_1=4.0\\times 10^{-6}\\ \\text{s}^{-1}$，$\\sigma=\\dfrac{2\\pi}{5\\times 86400}\\ \\text{rad}\\,\\text{s}^{-1}$。\n  - $\\mathbf{X}_0=(5.0\\times 10^{4},-2.5\\times 10^{4})\\ \\text{m}$。\n  - $t_0=0\\ \\text{s}$。\n  - $h=3600\\ \\text{s}$。\n  - 以浮点数形式输出局部截断误差（单位：米）。\n\n- 案例 2（通过误差比观察阶数）：\n  - $\\Omega_0=9.5\\times 10^{-6}\\ \\text{s}^{-1}$，$\\Omega_1=3.5\\times 10^{-6}\\ \\text{s}^{-1}$，$\\sigma=\\dfrac{2\\pi}{3\\times 86400}\\ \\text{rad}\\,\\text{s}^{-1}$。\n  - $\\mathbf{X}_0=(8.0\\times 10^{4},3.0\\times 10^{4})\\ \\text{m}$。\n  - $t_0=2\\times 86400\\ \\text{s}$。\n  - 计算在 $h=7200\\ \\text{s}$ 和 $h/2=3600\\ \\text{s}$ 时的局部截断误差，并以浮点数形式输出比值 $E(h)/E(h/2)$（无单位）。对于四阶格式的局部截断误差行为，此比值应接近 $2^{5}$。\n\n- 案例 3（边界条件：零初始位置）：\n  - $\\Omega_0=1.0\\times 10^{-5}\\ \\text{s}^{-1}$，$\\Omega_1=6.0\\times 10^{-6}\\ \\text{s}^{-1}$，$\\sigma=\\dfrac{2\\pi}{7\\times 86400}\\ \\text{rad}\\,\\text{s}^{-1}$。\n  - $\\mathbf{X}_0=(0,0)\\ \\text{m}$。\n  - $t_0=1\\times 86400\\ \\text{s}$。\n  - $h=3600\\ \\text{s}$。\n  - 以浮点数形式输出局部截断误差（单位：米）。由于原点处的流场对称性，理论上该值应精确为 $0$。\n\n- 案例 4（边缘案例：快速变化的角速度）：\n  - $\\Omega_0=1.0\\times 10^{-5}\\ \\text-s^{-1}$，$\\Omega_1=1.0\\times 10^{-5}\\ \\text-s^{-1}$，$\\sigma=\\dfrac{2\\pi}{0.5\\times 86400}\\ \\text{rad}\\,\\text{s}^{-1}$。\n  - $\\mathbf{X}_0=(2.0\\times 10^{4},2.0\\times 10^{4})\\ \\text{m}$。\n  - $t_0=0.25\\times 86400\\ \\text{s}$。\n  - $h=1800\\ \\text{s}$。\n  - 以浮点数形式输出局部截断误差（单位：米）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$），列表中的条目分别对应案例 1 到 4 的结果。不应打印任何其他文本。",
            "solution": "我们从拉格朗日运动描述开始，其中流体质点的轨迹 $\\mathbf{X}(t)$ 满足 $\\dot{\\mathbf{X}}(t)=\\mathbf{u}(\\mathbf{X}(t),t)$。欧拉速度场 $\\mathbf{u}(\\mathbf{x},t)$ 给出在固定位置和时间的瞬时速度。数值任务是使用单步法从 $\\mathbf{X}(t_0)$ 近似计算 $\\mathbf{X}(t_0+h)$，并评估局部截断误差，该误差定义为从相同初始数据出发，经过一个步长后，数值更新与精确解之间的差异。\n\n基于原理的经典四阶龙格－库塔（RK）单步法推导过程，是通过匹配初始值问题 $\\dot{\\mathbf{X}}=\\mathbf{u}(\\mathbf{X},t)$，$\\mathbf{X}(t_0)=\\mathbf{X}_0$ 精确解的泰勒级数来进行的。设 $h0$ 为步长并展开精确解：\n$$\n\\mathbf{X}(t_0+h) = \\mathbf{X}_0 + h\\,\\dot{\\mathbf{X}}_0 + \\frac{h^2}{2}\\,\\ddot{\\mathbf{X}}_0 + \\frac{h^3}{6}\\,\\mathbf{X}^{(3)}_0 + \\frac{h^4}{24}\\,\\mathbf{X}^{(4)}_0 + \\mathcal{O}(h^5),\n$$\n其中导数在 $t_0$ 处求值。使用 $\\dot{\\mathbf{X}}=\\mathbf{u}(\\mathbf{X},t)$ 和链式法则，\n$$\n\\ddot{\\mathbf{X}} = \\frac{d}{dt}\\mathbf{u}(\\mathbf{X},t) = \\partial_t \\mathbf{u} + (\\nabla_{\\mathbf{X}}\\mathbf{u})\\,\\dot{\\mathbf{X}} = \\partial_t \\mathbf{u} + (\\nabla_{\\mathbf{X}}\\mathbf{u})\\,\\mathbf{u},\n$$\n更高阶的导数可以类似地表示为 $\\mathbf{u}$ 的时间导数和空间导数与 $\\mathbf{X}(t)$ 的复合函数。\n\n龙格－库塔方法通过在中间阶段点上对速度进行加权组合来构造一个近似解，这些中间阶段点经过选择，以使该解的泰勒级数与精确解的泰勒级数在给定阶数上相匹配。经典的四阶格式使用四个阶段\n$$\n\\mathbf{k}_1 = \\mathbf{u}(\\mathbf{X}_0,t_0),\n\\quad\n\\mathbf{k}_2 = \\mathbf{u}\\!\\left(\\mathbf{X}_0 + \\frac{h}{2}\\mathbf{k}_1,\\, t_0 + \\frac{h}{2}\\right),\n\\quad\n\\mathbf{k}_3 = \\mathbf{u}\\!\\left(\\mathbf{X}_0 + \\frac{h}{2}\\mathbf{k}_2,\\, t_0 + \\frac{h}{2}\\right),\n\\quad\n\\mathbf{k}_4 = \\mathbf{u}\\!\\left(\\mathbf{X}_0 + h\\,\\mathbf{k}_3,\\, t_0 + h\\right),\n$$\n并进行更新\n$$\n\\mathbf{X}_{\\text{RK4}}(t_0+h) = \\mathbf{X}_0 + \\frac{h}{6}\\left(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4\\right).\n$$\n通过泰勒展开和阶数条件（可以编码在布彻表(Butcher tableau)中）来匹配系数，确保该方法达到四阶精度，即\n$$\n\\mathbf{X}(t_0+h) - \\mathbf{X}_{\\text{RK4}}(t_0+h) = \\mathcal{O}(h^5).\n$$\n局部截断误差（LTE）是此单步差异的范数。对于足够光滑的 $\\mathbf{u}$，局部截断误差有一个渐近展开\n$$\n\\|\\mathbf{X}(t_0+h) - \\mathbf{X}_{\\text{RK4}}(t_0+h)\\|_2 \\sim C(\\mathbf{X}_0,t_0)\\,h^5 \\quad \\text{as } h\\to 0,\n$$\n其中 $C(\\mathbf{X}_0,t_0)$ 依赖于 $\\mathbf{u}$ 沿轨迹的导数。因此，将步长减半会得到误差比\n$$\n\\frac{E(h)}{E(h/2)} \\approx \\frac{C\\,h^5}{C\\,(h/2)^5} = 2^5 = 32,\n$$\n这为局部截断误差的缩放行为提供了一个阶数观测检验。\n\n对于给定的速度场，其精确单步解可从其结构中获得。对于 $\\mathbf{u}(\\mathbf{x},t)=\\Omega(t)\\,(-y,x)=\\Omega(t)\\,\\mathbf{J}\\,\\mathbf{x}$，其中\n$$\n\\mathbf{J}=\\begin{pmatrix}0  -1 \\\\ 1  0\\end{pmatrix},\n$$\n该系统是线性的，具有一个时变标量系数乘以一个固定矩阵。由于 $\\mathbf{J}$ 是常数，且矩阵 $\\Omega(t_1)\\mathbf{J}$ 和 $\\Omega(t_2)\\mathbf{J}$ 可交换，因此在 $[t_0,t_0+h]$ 上的基本矩阵是一个旋转，其旋转角度为\n$$\n\\theta = \\int_{t_0}^{t_0+h} \\Omega(t)\\,dt = \\Omega_0\\,h + \\frac{\\Omega_1}{\\sigma}\\left[\\cos(\\sigma t_0) - \\cos\\!\\big(\\sigma (t_0+h)\\big)\\right].\n$$\n因此，\n$$\n\\mathbf{X}_{\\text{exact}}(t_0+h) = \\mathbf{R}(\\theta)\\,\\mathbf{X}_0,\n\\quad\n\\mathbf{R}(\\theta) = \\begin{pmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{pmatrix}.\n$$\n大小为 $h$ 的单步局部截断误差则为\n$$\nE(h)=\\left\\|\\mathbf{X}_{\\text{RK4}}(t_0+h) - \\mathbf{X}_{\\text{exact}}(t_0+h)\\right\\|_2,\n$$\n以米（m）为单位表示。\n\n算法设计：\n- 实现 $\\Omega(t)=\\Omega_0+\\Omega_1\\sin(\\sigma t)$。\n- 实现 $\\mathbf{u}(\\mathbf{x},t)=\\Omega(t)\\,(-y,x)$。\n- 使用四个阶段 $\\mathbf{k}_1,\\mathbf{k}_2,\\mathbf{k}_3,\\mathbf{k}_4$ 和加权组合实现单步经典四阶龙格－库塔方法。\n- 使用如上所述的 $\\theta$ 实现精确的单步旋转，并计算 $\\mathbf{X}_{\\text{exact}}(t_0+h)=\\mathbf{R}(\\theta)\\,\\mathbf{X}_0$。\n- 计算局部截断误差 $E(h)$，即 RK4 更新与精确更新之差的欧几里得范数。\n- 对于收敛性测试，计算 $E(h)$ 和 $E(h/2)$，并构成比值 $E(h)/E(h/2)$。\n\n测试套件的科学真实性与覆盖范围：\n- 案例 1 使用与中尺度一致的参数，其中 $\\Omega_0$ 的量级为 $10^{-5}\\ \\text{s}^{-1}$，并具有周期为 5 天（$5\\times 86400\\ \\text{s}$）的中等正弦调制。\n- 案例 2 通过构建误差比来检查观测阶数，应产生一个接近 32 的值。\n- 案例 3 验证了涡旋中心的边界条件，该处运动为零，数值更新和精确更新一致，从而产生 $0$ 误差。\n- 案例 4 探讨了一个具有快速调制（周期 0.5 天）的边缘案例，以确保在更快速变化的 $\\Omega(t)$ 条件下计算方法的局部截断误差行为。\n\n您的程序必须生成单行输出，其中包含案例 1 到 4 的结果，并严格遵循指定的顺序和格式，即 $[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$，其中 $\\text{result1}$、$\\text{result3}$ 和 $\\text{result4}$ 是以米为单位的浮点数，而 $\\text{result2}$ 是一个无单位的浮点数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef omega(t, params):\n    \"\"\"Angular velocity Omega(t) = Omega0 + Omega1 * sin(sigma * t).\"\"\"\n    return params[\"Omega0\"] + params[\"Omega1\"] * np.sin(params[\"sigma\"] * t)\n\ndef velocity(x, t, params):\n    \"\"\"Velocity field u(x,t) = Omega(t) * (-y, x).\"\"\"\n    om = omega(t, params)\n    return np.array([-om * x[1], om * x[0]])\n\ndef rk4_step(x, t, h, params):\n    \"\"\"Classical fourth-order Runge–Kutta one-step update for x' = u(x,t).\"\"\"\n    k1 = velocity(x, t, params)\n    k2 = velocity(x + 0.5 * h * k1, t + 0.5 * h, params)\n    k3 = velocity(x + 0.5 * h * k2, t + 0.5 * h, params)\n    k4 = velocity(x + h * k3, t + h, params)\n    return x + (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n\ndef exact_step(x, t, h, params):\n    \"\"\"Exact one-step solution via rotation by theta = integral Omega(t) dt over [t, t+h].\"\"\"\n    # theta = Omega0*h + (Omega1/sigma) * [cos(sigma t) - cos(sigma (t+h))]\n    if params[\"sigma\"] == 0:\n        theta = params[\"Omega0\"] * h\n    else:\n        theta = params[\"Omega0\"] * h + (params[\"Omega1\"] / params[\"sigma\"]) * (\n            np.cos(params[\"sigma\"] * t) - np.cos(params[\"sigma\"] * (t + h))\n        )\n    c, s = np.cos(theta), np.sin(theta)\n    R = np.array([[c, -s], [s, c]])\n    return R @ x\n\ndef local_truncation_error(x, t, h, params):\n    \"\"\"Euclidean norm of the local truncation error for one RK4 step.\"\"\"\n    if np.array_equal(x, np.array([0.0, 0.0])):\n        return 0.0\n    x_rk = rk4_step(x, t, h, params)\n    x_ex = exact_step(x, t, h, params)\n    return float(np.linalg.norm(x_rk - x_ex))\n\ndef solve():\n    days = 86400.0  # seconds in a day\n\n    results = []\n\n    # Case 1: general time-dependent vortex; happy path\n    params1 = {\n        \"Omega0\": 1.2e-5,\n        \"Omega1\": 4.0e-6,\n        \"sigma\": 2.0 * np.pi / (5.0 * days),\n    }\n    X01 = np.array([50e3, -25e3])\n    t01 = 0.0\n    h1 = 3600.0\n    err1 = local_truncation_error(X01, t01, h1, params1)\n    results.append(err1)\n\n    # Case 2: observed order via error ratio E(h)/E(h/2)\n    params2 = {\n        \"Omega0\": 9.5e-6,\n        \"Omega1\": 3.5e-6,\n        \"sigma\": 2.0 * np.pi / (3.0 * days),\n    }\n    X02 = np.array([80e3, 30e3])\n    t02 = 2.0 * days\n    h2_big = 7200.0\n    h2_small = h2_big / 2.0\n    err2_big = local_truncation_error(X02, t02, h2_big, params2)\n    err2_small = local_truncation_error(X02, t02, h2_small, params2)\n    ratio2 = err2_big / err2_small if err2_small != 0.0 else float(\"nan\")\n    results.append(ratio2)\n\n    # Case 3: boundary condition at origin; exact error is zero\n    params3 = {\n        \"Omega0\": 1.0e-5,\n        \"Omega1\": 6.0e-6,\n        \"sigma\": 2.0 * np.pi / (7.0 * days),\n    }\n    X03 = np.array([0.0, 0.0])\n    t03 = 1.0 * days\n    h3 = 3600.0\n    err3 = local_truncation_error(X03, t03, h3, params3)\n    results.append(err3)\n\n    # Case 4: edge case with rapidly varying angular velocity\n    params4 = {\n        \"Omega0\": 1.0e-5,\n        \"Omega1\": 1.0e-5,\n        \"sigma\": 2.0 * np.pi / (0.5 * days),\n    }\n    X04 = np.array([20e3, 20e3])\n    t04 = 0.25 * days\n    h4 = 1800.0\n    err4 = local_truncation_error(X04, t04, h4, params4)\n    results.append(err4)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}