{
    "hands_on_practices": [
        {
            "introduction": "To understand ocean stratification, we must account for the effects of pressure on density. This practice explores the core concept of potential density, demonstrating how the relative density of two water parcels can change depending on the reference pressure chosen for comparison. By calculating the specific pressure at which their density contrast vanishes, you will gain a tangible understanding of thermobaricity and its crucial role in stability analysis .",
            "id": "3808340",
            "problem": "Consider two water parcels measured at the same in-situ pressure $p_0$ in the mid-latitude North Atlantic interior. Parcel $\\mathcal{A}$ has potential temperature $\\theta_{\\mathcal{A}} = 2.0$ (degrees Celsius) and Practical Salinity Scale of 1978 (PSS-78) salinity $S_{\\mathcal{A}} = 34.85$, while parcel $\\mathcal{B}$ has potential temperature $\\theta_{\\mathcal{B}} = 3.0$ (degrees Celsius) and salinity $S_{\\mathcal{B}} = 35.05$. Assume small property contrasts so that first-order linearization about the local state is justified.\n\nPotential density referenced to pressure $p_r$, denoted $\\sigma_{p_r}$, is defined as the density a parcel would have if moved adiabatically to $p_r$, minus a constant offset that cancels in differences. The dependence of the density on potential temperature and salinity at a fixed reference pressure is governed by the thermal expansion coefficient $\\alpha$ and haline contraction coefficient $\\beta$, defined by\n$$\n\\alpha \\equiv -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_{S,p}, \n\\qquad\n\\beta \\equiv \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{T,p},\n$$\nwhere $\\rho$ is the in-situ density, $T$ is absolute temperature, $S$ is salinity treated as a dimensionless concentration on PSS-78, and $p$ is pressure. Treat the difference between degrees Celsius and Kelvin as irrelevant for increments (i.e., $\\Delta T = \\Delta \\theta$).\n\nIn the narrow $(S,\\theta)$ range of interest, suppose that when evaluated at the reference pressure $p_r$ (in decibars), the coefficients $\\alpha$ and $\\beta$ vary approximately linearly with $p_r$:\n$$\n\\alpha(p_r) = \\alpha_0 + a\\,p_r, \n\\qquad\n\\beta(p_r) = \\beta_0 + b\\,p_r,\n$$\nwith constants\n$$\n\\alpha_0 = 2.1 \\times 10^{-4}\\,\\mathrm{K}^{-1}, \\quad a = -1.0 \\times 10^{-8}\\,\\mathrm{K^{-1}\\,dbar^{-1}}, \\quad\n\\beta_0 = 7.6 \\times 10^{-4}\\,(\\mathrm{PSS-78})^{-1}, \\quad b = 2.0 \\times 10^{-8}\\,(\\mathrm{PSS-78})^{-1}\\,\\mathrm{dbar}^{-1}.\n$$\nAssume the density scale factor $\\rho(p_r)$ entering linearizations of density at $p_r$ may be treated as constant with respect to $p_r$ over the range of interest (you may take $\\rho \\approx 1027\\,\\mathrm{kg\\,m^{-3}}$, but you will find that it cancels in the sign calculation).\n\nStarting from the core definitions above and first principles for potential temperature and potential density, derive the analytic expression for the reference-pressure-dependent potential density difference $\\Delta \\sigma_{p_r}$ between parcels $\\mathcal{B}$ and $\\mathcal{A}$ in terms of $\\alpha(p_r)$, $\\beta(p_r)$, $\\Delta \\theta \\equiv \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}$, and $\\Delta S \\equiv S_{\\mathcal{B}} - S_{\\mathcal{A}}$. Then, using the provided numerical coefficients, compute the unique reference pressure $p_r^{\\ast}$ (in decibars) at which the sign of $\\Delta \\sigma_{p_r}$ changes (that is, $\\Delta \\sigma_{p_r^{\\ast}} = 0$). Round your final $p_r^{\\ast}$ to four significant figures and express it in decibars.",
            "solution": "The problem asks for two results: first, an analytic expression for the potential density difference, $\\Delta \\sigma_{p_r}$, between two water parcels, $\\mathcal{B}$ and $\\mathcal{A}$; and second, the specific reference pressure, $p_r^{\\ast}$, at which this difference is zero. The solution is derived from first principles using the provided definitions and a linear approximation.\n\nThe potential density referenced to pressure $p_r$, denoted $\\sigma_{p_r}$, is the density a parcel would have at pressure $p_r$, minus a constant. Since the constant offset cancels when taking a difference, the potential density difference $\\Delta \\sigma_{p_r}$ is equal to the difference in the actual densities, $\\Delta \\rho(p_r)$, evaluated at the reference pressure $p_r$ with the parcels' respective potential temperatures $(\\theta)$ and salinities $(S)$.\n$$\n\\Delta \\sigma_{p_r} = \\sigma_{p_r, \\mathcal{B}} - \\sigma_{p_r, \\mathcal{A}} = \\rho(\\theta_{\\mathcal{B}}, S_{\\mathcal{B}}, p_r) - \\rho(\\theta_{\\mathcal{A}}, S_{\\mathcal{A}}, p_r)\n$$\nThe problem states that the property contrasts are small, justifying a first-order Taylor expansion (linearization) of the density function $\\rho(\\theta, S, p_r)$. We can expand the density for parcel $\\mathcal{B}$ around the state of parcel $\\mathcal{A}$:\n$$\n\\rho(\\theta_{\\mathcal{B}}, S_{\\mathcal{B}}, p_r) \\approx \\rho(\\theta_{\\mathcal{A}}, S_{\\mathcal{A}}, p_r) + \\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} (\\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}) + \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} (S_{\\mathcal{B}} - S_{\\mathcal{A}})\n$$\nThe partial derivatives are evaluated at a representative state $(\\theta, S)$ and the reference pressure $p_r$. Rearranging this approximation gives the linearized density difference:\n$$\n\\Delta \\sigma_{p_r} \\approx \\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} \\Delta \\theta + \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} \\Delta S\n$$\nwhere $\\Delta \\theta \\equiv \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}$ and $\\Delta S \\equiv S_{\\mathcal{B}} - S_{\\mathcal{A}}$.\n\nThe problem supplies definitions for the thermal expansion coefficient, $\\alpha$, and the haline contraction coefficient, $\\beta$, at a given pressure $p$:\n$$\n\\alpha \\equiv -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_{S,p}, \\qquad \\beta \\equiv \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{T,p}\n$$\nWe are instructed to treat increments in potential temperature $\\theta$ (in degrees Celsius) as equivalent to increments in absolute temperature $T$ (in Kelvin), so we can replace $\\partial/\\partial T$ with $\\partial/\\partial \\theta$. The partial derivatives of density can be expressed in terms of $\\alpha(p_r)$ and $\\beta(p_r)$ as:\n$$\n\\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} = -\\rho(p_r) \\alpha(p_r), \\qquad \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} = \\rho(p_r) \\beta(p_r)\n$$\nThe density $\\rho(p_r)$ is a reference density at pressure $p_r$, which is assumed to be a constant scaling factor, denoted here as $\\rho_{\\text{ref}}$. Substituting these into the expression for $\\Delta \\sigma_{p_r}$:\n$$\n\\Delta \\sigma_{p_r} = [-\\rho_{\\text{ref}} \\alpha(p_r)] \\Delta \\theta + [\\rho_{\\text{ref}} \\beta(p_r)] \\Delta S\n$$\nFactoring out the reference density yields the required analytical expression for the potential density difference:\n$$\n\\Delta \\sigma_{p_r} = \\rho_{\\text{ref}} (\\beta(p_r) \\Delta S - \\alpha(p_r) \\Delta \\theta)\n$$\nThis completes the first part of the problem.\n\nFor the second part, we must find the reference pressure $p_r^{\\ast}$ for which $\\Delta \\sigma_{p_r^{\\ast}} = 0$.\n$$\n\\rho_{\\text{ref}} (\\beta(p_r^{\\ast}) \\Delta S - \\alpha(p_r^{\\ast}) \\Delta \\theta) = 0\n$$\nSince $\\rho_{\\text{ref}}$ is a non-zero positive constant, this condition simplifies to:\n$$\n\\beta(p_r^{\\ast}) \\Delta S = \\alpha(p_r^{\\ast}) \\Delta \\theta\n$$\nThe problem specifies linear models for the pressure dependence of the coefficients:\n$$\n\\alpha(p_r) = \\alpha_0 + a p_r, \\qquad \\beta(p_r) = \\beta_0 + b p_r\n$$\nSubstituting these expressions at $p_r = p_r^{\\ast}$:\n$$\n(\\beta_0 + b p_r^{\\ast}) \\Delta S = (\\alpha_0 + a p_r^{\\ast}) \\Delta \\theta\n$$\nWe solve this linear equation for $p_r^{\\ast}$:\n$$\n\\beta_0 \\Delta S + b p_r^{\\ast} \\Delta S = \\alpha_0 \\Delta \\theta + a p_r^{\\ast} \\Delta \\theta\n$$\n$$\np_r^{\\ast} (b \\Delta S - a \\Delta \\theta) = \\alpha_0 \\Delta \\theta - \\beta_0 \\Delta S\n$$\n$$\np_r^{\\ast} = \\frac{\\alpha_0 \\Delta \\theta - \\beta_0 \\Delta S}{b \\Delta S - a \\Delta \\theta}\n$$\nNext, we substitute the provided numerical values. First, we calculate the differences in potential temperature and salinity:\n$$\n\\Delta \\theta = \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}} = 3.0 - 2.0 = 1.0\\,\\mathrm{K}\n$$\n$$\n\\Delta S = S_{\\mathcal{B}} - S_{\\mathcal{A}} = 35.05 - 34.85 = 0.20\\,(\\mathrm{PSS-78})\n$$\nThe given constants are:\n$$\n\\alpha_0 = 2.1 \\times 10^{-4}\\,\\mathrm{K}^{-1}, \\quad a = -1.0 \\times 10^{-8}\\,\\mathrm{K^{-1}\\,dbar^{-1}}\n$$\n$$\n\\beta_0 = 7.6 \\times 10^{-4}\\,(\\mathrm{PSS-78})^{-1}, \\quad b = 2.0 \\times 10^{-8}\\,(\\mathrm{PSS-78})^{-1}\\,\\mathrm{dbar}^{-1}\n$$\nThe numerator of the expression for $p_r^{\\ast}$ is:\n$$\n\\text{Numerator} = (2.1 \\times 10^{-4}\\,\\mathrm{K}^{-1})(1.0\\,\\mathrm{K}) - (7.6 \\times 10^{-4}\\,(\\mathrm{PSS-78})^{-1})(0.20\\,(\\mathrm{PSS-78}))\n$$\n$$\n\\text{Numerator} = 2.1 \\times 10^{-4} - 1.52 \\times 10^{-4} = 0.58 \\times 10^{-4}\n$$\nThe denominator is:\n$$\n\\text{Denominator} = (2.0 \\times 10^{-8}\\,(\\mathrm{PSS-78})^{-1}\\,\\mathrm{dbar}^{-1})(0.20\\,(\\mathrm{PSS-78})) - (-1.0 \\times 10^{-8}\\,\\mathrm{K^{-1}\\,dbar^{-1}})(1.0\\,\\mathrm{K})\n$$\n$$\n\\text{Denominator} = 0.4 \\times 10^{-8}\\,\\mathrm{dbar}^{-1} + 1.0 \\times 10^{-8}\\,\\mathrm{dbar}^{-1} = 1.4 \\times 10^{-8}\\,\\mathrm{dbar}^{-1}\n$$\nFinally, we compute the value of $p_r^{\\ast}$:\n$$\np_r^{\\ast} = \\frac{0.58 \\times 10^{-4}}{1.4 \\times 10^{-8}}\\,\\mathrm{dbar} = \\frac{5.8 \\times 10^{-5}}{1.4 \\times 10^{-8}}\\,\\mathrm{dbar} = \\frac{5.8}{1.4} \\times 10^3\\,\\mathrm{dbar}\n$$\n$$\np_r^{\\ast} = \\left(\\frac{29}{7}\\right) \\times 10^3\\,\\mathrm{dbar} \\approx 4142.857...\\,\\mathrm{dbar}\n$$\nRounding this result to four significant figures as requested:\n$$\np_r^{\\ast} \\approx 4143\\,\\mathrm{dbar}\n$$",
            "answer": "$$\n\\boxed{4143}\n$$"
        },
        {
            "introduction": "While potential density provides a more consistent framework than in-situ density, interpreting it on property diagrams requires care. This exercise delves into the non-linear nature of the seawater equation of state, a phenomenon known as cabbeling, where mixing water of the same density creates a denser product. You will use a second-order approximation to quantify this effect, gaining critical insight for accurately analyzing water masses on a potential temperature-salinity ($\\theta-S$) diagram .",
            "id": "3808268",
            "problem": "In computational oceanography, water mass analysis frequently uses contours of potential density anomaly referenced to the sea surface, denoted by $\\sigma_{0}$, on potential temperature–salinity ($\\theta$–$S$) diagrams to approximate isopycnals. Potential temperature $\\theta$ is defined as the temperature a seawater parcel would have if moved adiabatically and without exchange of matter to a reference pressure of $p = 0$ decibar, and potential density anomaly $\\sigma_{0}$ is defined as $\\sigma_{0}(\\theta, S) = \\rho(\\theta, S, p=0) - 1000$, where $\\rho$ is the in situ density and the anomaly is in kilograms per cubic meter. The Thermodynamic Equation of Seawater 2010 (TEOS-10) provides a well-tested equation of state that, in a small neighborhood around a reference state $(\\theta_{0}, S_{0})$, can be represented by a Taylor expansion of $\\sigma_{0}$ up to second order in $\\Delta \\theta = \\theta - \\theta_{0}$ and $\\Delta S = S - S_{0}$.\n\nCabbeling is the density increase that occurs when two water parcels on a nominally “constant-density” curve are mixed, due to the nonlinear equation of state. This effect biases water mass analysis when isopycnals are approximated by $\\sigma_{0}$ contours using only first-order (linear) information on the $\\theta$–$S$ plane.\n\nConsider a local analysis at the reference point $(\\theta_{0}, S_{0})$ with $\\theta$ in degrees Celsius and $S$ as Absolute Salinity in grams per kilogram. Assume the following partial derivatives of $\\sigma_{0}$ (all evaluated at $(\\theta_{0}, S_{0})$ and $p = 0$ decibar) are known from the Thermodynamic Equation of Seawater 2010 (TEOS-10):\n$$\\sigma_{\\theta} = \\frac{\\partial \\sigma_{0}}{\\partial \\theta} = -0.205\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}}, \\quad \\sigma_{S} = \\frac{\\partial \\sigma_{0}}{\\partial S} = 0.780\\,\\mathrm{kg\\,m^{-3}\\,(\\mathrm{g\\,kg^{-1}})^{-1}},$$\nand second derivatives\n$$\\sigma_{\\theta \\theta} = \\frac{\\partial^{2} \\sigma_{0}}{\\partial \\theta^{2}} = -0.0030\\,\\mathrm{kg\\,m^{-3}\\,K^{-2}}, \\quad \\sigma_{\\theta S} = \\frac{\\partial^{2} \\sigma_{0}}{\\partial \\theta \\, \\partial S} = -0.018\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}\\,(\\mathrm{g\\,kg^{-1}})^{-1}},$$\n$$\\sigma_{S S} = \\frac{\\partial^{2} \\sigma_{0}}{\\partial S^{2}} = 0.00035\\,\\mathrm{kg\\,m^{-3}\\,(\\mathrm{g\\,kg^{-1}})^{-2}}.$$\n\nTwo equal-volume water parcels, $\\text{A}$ and $\\text{B}$, are chosen symmetrically about $(\\theta_{0}, S_{0})$ with small offsets $(\\Delta \\theta/2, \\Delta S/2)$ and $(-\\Delta \\theta/2, -\\Delta S/2)$ respectively. They are constrained to lie on the same local $\\sigma_{0}$ contour to first order, i.e., they satisfy the linearized constant-$\\sigma_{0}$ condition\n$$\\sigma_{\\theta} \\, \\Delta \\theta + \\sigma_{S} \\, \\Delta S = 0,$$\nwith a prescribed potential temperature separation of $\\Delta \\theta = 0.8$.\n\nDefine the cabbeling-induced bias $\\Delta \\sigma_{\\text{cab}}$ as the difference between the mixed parcel’s $\\sigma_{0}$ (obtained by equal-volume mixing of $\\text{A}$ and $\\text{B}$, which yields $(\\theta_{0}, S_{0})$) and the common $\\sigma_{0}$ of the endpoints under the linear contour approximation. Using the provided derivatives, quantify $\\Delta \\sigma_{\\text{cab}}$ to second order in the offsets, and report the result in kilograms per cubic meter. Round your answer to three significant figures.",
            "solution": "The problem asks for the quantification of the cabbeling-induced density bias, $\\Delta \\sigma_{\\text{cab}}$, which arises from the nonlinear nature of the seawater equation of state. Cabbeling is defined in the problem as the \"density increase that occurs when two water parcels ... are mixed.\" This means we must calculate the potential density anomaly of the mixed parcel and subtract the average potential density anomaly of the two initial parcels.\n\nLet the reference state be $(\\theta_{0}, S_{0})$ with a potential density anomaly of $\\sigma_{0,ref} = \\sigma_{0}(\\theta_{0}, S_{0})$. The potential density anomaly $\\sigma_{0}(\\theta, S)$ in the vicinity of this reference point can be approximated by a second-order Taylor expansion:\n$$\n\\sigma_{0}(\\theta, S) \\approx \\sigma_{0,ref} + \\sigma_{\\theta}(\\theta - \\theta_0) + \\sigma_{S}(S - S_0) + \\frac{1}{2} \\left[ \\sigma_{\\theta\\theta}(\\theta - \\theta_0)^2 + 2\\sigma_{\\theta S}(\\theta - \\theta_0)(S - S_0) + \\sigma_{SS}(S - S_0)^2 \\right]\n$$\nwhere the partial derivatives $\\sigma_{\\theta}$, $\\sigma_{S}$, $\\sigma_{\\theta\\theta}$, $\\sigma_{\\theta S}$, and $\\sigma_{SS}$ are all evaluated at the reference point $(\\theta_{0}, S_{0})$.\n\nWe are given two water parcels, A and B, which are symmetric about the reference point. Their properties are:\nParcel A: $(\\theta_{A}, S_{A}) = (\\theta_{0} + \\frac{\\Delta \\theta}{2}, S_{0} + \\frac{\\Delta S}{2})$\nParcel B: $(\\theta_{B}, S_{B}) = (\\theta_{0} - \\frac{\\Delta \\theta}{2}, S_{0} - \\frac{\\Delta S}{2})$\n\nWhen these two equal-volume parcels are mixed, the resulting parcel has the average properties of the initial parcels, which is $(\\theta_{0}, S_{0})$. The potential density anomaly of the mixed parcel is therefore $\\sigma_{0,mix} = \\sigma_{0}(\\theta_{0}, S_{0}) = \\sigma_{0,ref}$.\n\nThe cabbeling-induced density increase is the difference between the density of the mixture and the average density of the initial parcels:\n$$\n\\Delta \\sigma_{\\text{cab}} = \\sigma_{0,mix} - \\frac{\\sigma_{0}(\\theta_{A}, S_{A}) + \\sigma_{0}(\\theta_{B}, S_{B})}{2}\n$$\n\nWe use the Taylor expansion to find the density anomalies of parcels A and B. For parcel A, the offsets are $h = \\frac{\\Delta \\theta}{2}$ and $k = \\frac{\\Delta S}{2}$. For parcel B, the offsets are $h = -\\frac{\\Delta \\theta}{2}$ and $k = -\\frac{\\Delta S}{2}$.\n\n$$\n\\sigma_{0}(\\theta_{A}, S_{A}) \\approx \\sigma_{0,ref} + \\sigma_{\\theta}\\left(\\frac{\\Delta \\theta}{2}\\right) + \\sigma_{S}\\left(\\frac{\\Delta S}{2}\\right) + \\frac{1}{2} \\left[ \\sigma_{\\theta\\theta}\\left(\\frac{\\Delta \\theta}{2}\\right)^2 + 2\\sigma_{\\theta S}\\left(\\frac{\\Delta \\theta}{2}\\right)\\left(\\frac{\\Delta S}{2}\\right) + \\sigma_{SS}\\left(\\frac{\\Delta S}{2}\\right)^2 \\right]\n$$\n$$\n\\sigma_{0}(\\theta_{B}, S_{B}) \\approx \\sigma_{0,ref} + \\sigma_{\\theta}\\left(-\\frac{\\Delta \\theta}{2}\\right) + \\sigma_{S}\\left(-\\frac{\\Delta S}{2}\\right) + \\frac{1}{2} \\left[ \\sigma_{\\theta\\theta}\\left(-\\frac{\\Delta \\theta}{2}\\right)^2 + 2\\sigma_{\\theta S}\\left(-\\frac{\\Delta \\theta}{2}\\right)\\left(-\\frac{\\Delta S}{2}\\right) + \\sigma_{SS}\\left(-\\frac{\\Delta S}{2}\\right)^2 \\right]\n$$\n\nThe average of these two is:\n$$\n\\frac{\\sigma_{0,A} + \\sigma_{0,B}}{2} \\approx \\sigma_{0,ref} + \\frac{1}{2} \\left[ \\sigma_{\\theta\\theta}\\left(\\frac{\\Delta \\theta}{2}\\right)^2 + 2\\sigma_{\\theta S}\\left(\\frac{\\Delta \\theta}{2}\\right)\\left(\\frac{\\Delta S}{2}\\right) + \\sigma_{SS}\\left(\\frac{\\Delta S}{2}\\right)^2 \\right]\n$$\nThe first-order terms cancel out. Simplifying the second-order term:\n$$\n\\frac{\\sigma_{0,A} + \\sigma_{0,B}}{2} \\approx \\sigma_{0,ref} + \\frac{1}{8} \\left[ \\sigma_{\\theta\\theta}(\\Delta \\theta)^2 + 2\\sigma_{\\theta S}\\Delta \\theta \\Delta S + \\sigma_{SS}(\\Delta S)^2 \\right]\n$$\n\nNow, we substitute this back into the expression for $\\Delta \\sigma_{\\text{cab}}$:\n$$\n\\Delta \\sigma_{\\text{cab}} \\approx \\sigma_{0,ref} - \\left( \\sigma_{0,ref} + \\frac{1}{8} \\left[ \\sigma_{\\theta\\theta}(\\Delta \\theta)^2 + 2\\sigma_{\\theta S}\\Delta \\theta \\Delta S + \\sigma_{SS}(\\Delta S)^2 \\right] \\right)\n$$\n$$\n\\Delta \\sigma_{\\text{cab}} \\approx -\\frac{1}{8} \\left[ \\sigma_{\\theta\\theta}(\\Delta \\theta)^2 + 2\\sigma_{\\theta S}\\Delta \\theta \\Delta S + \\sigma_{SS}(\\Delta S)^2 \\right]\n$$\n\nThe parcels are constrained to lie on the same local $\\sigma_{0}$ contour to first order, which gives the relation:\n$$\n\\sigma_{\\theta} \\, \\Delta \\theta + \\sigma_{S} \\, \\Delta S = 0\n$$\nWe can solve for $\\Delta S$ in terms of $\\Delta \\theta$:\n$$\n\\Delta S = -\\frac{\\sigma_{\\theta}}{\\sigma_{S}} \\Delta \\theta\n$$\n\nNow we substitute the given numerical values:\n$\\sigma_{\\theta} = -0.205\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}}$\n$\\sigma_{S} = 0.780\\,\\mathrm{kg\\,m^{-3}\\,(\\mathrm{g\\,kg^{-1}})^{-1}}$\n$\\Delta \\theta = 0.8\\,\\mathrm{K}$\n\n$$\n\\Delta S = -\\frac{-0.205}{0.780} \\times 0.8 = \\frac{0.164}{0.780} = \\frac{164}{780} = \\frac{41}{195}\\,\\mathrm{g\\,kg^{-1}}\n$$\n\nNext, we calculate the quadratic term in the expression for $\\Delta \\sigma_{\\text{cab}}$ using the provided second derivatives:\n$\\sigma_{\\theta \\theta} = -0.0030\\,\\mathrm{kg\\,m^{-3}\\,K^{-2}}$\n$\\sigma_{\\theta S} = -0.018\\,\\mathrm{kg\\,m^{-3}\\,K^{-1}\\,(\\mathrm{g\\,kg^{-1}})^{-1}}$\n$\\sigma_{S S} = 0.00035\\,\\mathrm{kg\\,m^{-3}\\,(\\mathrm{g\\,kg^{-1}})^{-2}}$\n\nLet $Q = \\sigma_{\\theta\\theta}(\\Delta \\theta)^2 + 2\\sigma_{\\theta S}\\Delta \\theta \\Delta S + \\sigma_{SS}(\\Delta S)^2$. We compute each part of $Q$:\nThe first term is:\n$$\n\\sigma_{\\theta\\theta}(\\Delta \\theta)^2 = (-0.0030) \\times (0.8)^2 = (-0.0030) \\times (0.64) = -0.00192\n$$\nThe second term is:\n$$\n2\\sigma_{\\theta S}\\Delta \\theta \\Delta S = 2 \\times (-0.018) \\times (0.8) \\times \\left(\\frac{41}{195}\\right) = -0.0288 \\times \\left(\\frac{41}{195}\\right) = -\\frac{1.1808}{195} \\approx -0.00605538\n$$\nThe third term is:\n$$\n\\sigma_{SS}(\\Delta S)^2 = (0.00035) \\times \\left(\\frac{41}{195}\\right)^2 = (0.00035) \\times \\frac{1681}{38025} = \\frac{0.58835}{38025} \\approx 0.00001547\n$$\nSumming these three terms to find $Q$:\n$$\nQ \\approx -0.00192 - 0.00605538 + 0.00001547 = -0.00795991\\,\\mathrm{kg\\,m^{-3}}\n$$\n\nFinally, we calculate $\\Delta \\sigma_{\\text{cab}}$:\n$$\n\\Delta \\sigma_{\\text{cab}} \\approx -\\frac{1}{8} Q = -\\frac{1}{8} (-0.00795991) \\approx 0.00099498875\\,\\mathrm{kg\\,m^{-3}}\n$$\n\nThe problem asks to round the result to three significant figures.\n$$\n\\Delta \\sigma_{\\text{cab}} \\approx 0.000995\\,\\mathrm{kg\\,m^{-3}}\n$$\nThis positive value is consistent with cabbeling being a \"density increase.\"",
            "answer": "$$\n\\boxed{0.000995}\n$$"
        },
        {
            "introduction": "The cabbeling effect highlights a fundamental limitation: potential temperature ($\\theta$) is not a conserved quantity in mixing processes. This final practice introduces Conservative Temperature ($\\Theta$), a modern variable from TEOS-10 that is proportional to heat content and thus mixes linearly. By deriving and computing the difference between $\\Theta$ and $\\theta$, you will discover where this correction is most critical for accurate modeling of deep ocean circulation and heat budgets .",
            "id": "3808332",
            "problem": "You are asked to build a numerical program that, for a fixed Absolute Salinity (in grams per kilogram), quantifies the difference between Conservative Temperature and potential temperature as a function of in-situ pressure and temperature using physically grounded relationships from the Thermodynamic Equation Of Seawater - $2010$ (TEOS-$10$). Let Conservative Temperature be denoted by $\\Theta$ and potential temperature by $\\theta$. The goal is to derive from first principles the dependence of $\\Theta - \\theta$ on pressure and temperature, implement it, and compute the resulting values for a defined test suite.\n\nUse the following foundational base and modeling assumptions, which are consistent with TEOS-$10$ and commonly used first-principles approximations in computational oceanography:\n\n- Absolute Salinity (TEOS-$10$ uses Absolute Salinity) is fixed at $S_A = 35\\,\\mathrm{g\\,kg^{-1}}$ for all computations.\n- Start from the First Law of Thermodynamics for seawater and the definition of adiabatic motion: entropy conservation implies an adiabatic temperature change with pressure governed by the adiabatic lapse rate. A well-tested leading-order expression relates the adiabatic temperature gradient to the thermal expansion coefficient, density, and specific heat capacity:\n  $$\\gamma(T,S_A,p) \\equiv \\left(\\frac{\\partial T}{\\partial p}\\right)_{\\eta,S_A} \\approx \\frac{\\alpha(T,S_A)\\,T}{\\rho(T,S_A,p)\\,c_p(T,S_A,p)} \\ ,$$\n  where $\\alpha$ is the thermal expansion coefficient, $\\rho$ is density, $c_p$ is the specific heat capacity at constant pressure, $T$ is absolute temperature in kelvin, and $p$ is pressure in pascals.\n- Define potential temperature $\\theta$ as the temperature a parcel would have if moved adiabatically and without exchange to a reference pressure $p_{\\mathrm{ref}} = 0\\,\\mathrm{dbar}$, i.e.,\n  $$\\theta(T,p) = T - \\int_{0}^{p} \\gamma\\big(T,S_A,p'\\big)\\,dp' \\ ,$$\n  where $p$ is given in decibars and must be converted to pascals for the integration via $p_{\\mathrm{Pa}} = p \\times 10^4$.\n- Define Conservative Temperature $\\Theta$ via potential enthalpy $h^0$ at the reference pressure: TEOS-$10$ defines $\\Theta$ so that\n  $$h^0 = c_p^0\\,\\Theta + \\mathrm{constant} \\ ,$$\n  where $c_p^0$ is a standard reference specific heat capacity. To make the computation tractable, approximate $c_p(T,S_A,p)$ by a linear function of temperature around a reference temperature:\n  $$c_p(T) \\approx c_p^0 \\left[1 + b_1\\,(T - T_{\\mathrm{ref}})\\right] \\ ,$$\n  with a small slope $b_1$ capturing the leading temperature dependence of $c_p$. Let the reference absolute temperature be $T_{\\mathrm{ref}} = 273.15\\,\\mathrm{K}$. Under this model and neglecting weak pressure dependence of $c_p$ in the enthalpy integral, the difference $\\Theta - \\theta$ arises from the temperature dependence of $c_p$ in enthalpy and is given by\n  $$\\Theta - \\theta \\approx \\frac{1}{c_p^0}\\int_{T_{\\mathrm{ref}}}^{\\theta} c_p(T')\\,dT' \\;-\\; (\\theta - T_{\\mathrm{ref}}) = \\frac{1}{2}\\,b_1\\,\\big(\\theta - T_{\\mathrm{ref}}\\big)^2 \\ .$$\n\nFor numerical implementation, use the following physically plausible constants:\n- Reference specific heat capacity $c_p^0 = 3991.86795711963\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- Reference absolute temperature $T_{\\mathrm{ref}} = 273.15\\,\\mathrm{K}$.\n- Density $\\rho \\approx 1027\\,\\mathrm{kg\\,m^{-3}}$ (treated as constant for leading-order estimation).\n- Thermal expansion coefficient modeled as linear in in-situ temperature in degrees Celsius: $\\alpha(T_{\\mathrm{C}}) = \\alpha_0 + \\alpha_1\\,T_{\\mathrm{C}}$ with $\\alpha_0 = 1.5\\times 10^{-4}\\,\\mathrm{K^{-1}}$ and $\\alpha_1 = 3.5\\times 10^{-6}\\,\\mathrm{K^{-1}\\,(^{\\circ}C)^{-1}}$.\n- Specific heat capacity slope parameter $b_1 = 1.0\\times 10^{-4}\\,\\mathrm{K^{-1}}$.\n\nThe program must:\n1. Accept a fixed set of test cases defined below, each with in-situ temperature in degrees Celsius and pressure in decibars, assume $S_A = 35\\,\\mathrm{g\\,kg^{-1}}$, convert temperature to kelvin when required, convert pressure to pascals for the adiabatic lapse calculation, compute $\\theta$ using the integral approximation with a constant $\\gamma$ evaluated at the given in-situ temperature, and then compute $\\Theta - \\theta$ using the enthalpy-based approximation above.\n2. Produce the final differences as floating-point numbers in kelvin, rounded to six decimal places.\n\nTest Suite (each case is $(T_{\\mathrm{C}}, p_{\\mathrm{dbar}})$):\n- Case $1$: $(25.0, 0)$.\n- Case $2$: $(25.0, 1000)$.\n- Case $3$: $(2.0, 4000)$.\n- Case $4$: $(-1.8, 0)$.\n- Case $5$: $(0.0, 6000)$.\n- Case $6$: $(10.0, 500)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\ldots\\right]$). Each $\\mathrm{result}_i$ must be the value of $\\Theta - \\theta$ in $\\mathrm{K}$, rounded to six decimal places.\n\nIn addition to coding the computation, the program must be based on your derivation from the fundamental laws and definitions stated above and the assumptions given. No other external inputs are allowed.\n\nFinally, after computing the numerical differences, discuss in your written solution where in the ocean this difference is dynamically important and why, referring to implications for density and buoyancy when using potential temperature versus Conservative Temperature. That discussion is part of the analytical solution, not the program.\n\nAll angles, if any were to appear, must be expressed in radians; however, this problem does not require angles. All physical outputs must be expressed in kelvin ($\\mathrm{K}$) and rounded to six decimal places.",
            "solution": "The problem is scientifically grounded, well-posed, and provides all necessary information to derive a solution from the stated first principles and approximations. Therefore, the problem is valid. We proceed with the derivation and computational implementation.\n\nThe objective is to quantify the difference between Conservative Temperature, $\\Theta$, and potential temperature, $\\theta$, for seawater at a fixed Absolute Salinity $S_A = 35\\,\\mathrm{g\\,kg^{-1}}$, as a function of in-situ temperature and pressure. The derivation will follow the approximations provided, consistent with the TEOS-$10$ framework.\n\n**Step 1: Derivation and Calculation of Potential Temperature ($\\theta$)**\n\nPotential temperature, $\\theta$, is defined as the temperature a fluid parcel would attain if moved adiabatically from its in-situ pressure, $p$, and temperature, $T$, to a reference pressure, $p_{\\mathrm{ref}}$. In this problem, $p_{\\mathrm{ref}} = 0\\,\\mathrm{dbar}$. The change in temperature during an adiabatic pressure change is governed by the adiabatic lapse rate, $\\gamma$.\n\nThe formal definition provided is:\n$$ \\theta(T,p) = T - \\int_{p_{\\mathrm{ref}}}^{p} \\gamma\\big(T,S_A,p'\\big)\\,dp' $$\nThe problem specifies using the reference pressure $p_{\\mathrm{ref}} = 0$, and the pressure variable in the integral is in Pascals. Given an in-situ pressure $p_{\\mathrm{dbar}}$ in decibars, the upper limit of integration is $p_{\\mathrm{Pa}} = p_{\\mathrm{dbar}} \\times 10^4$.\n\nThe adiabatic lapse rate, $\\gamma$, is given by the approximation:\n$$ \\gamma(T,S_A,p) \\approx \\frac{\\alpha(T,S_A)\\,T}{\\rho(T,S_A,p)\\,c_p(T,S_A,p)} $$\nwhere $T$ is the absolute temperature in Kelvin, $\\alpha$ is the thermal expansion coefficient, $\\rho$ is the density, and $c_p$ is the specific heat capacity. The problem provides the following models and constants for these parameters:\n- Density is constant: $\\rho \\approx 1027\\,\\mathrm{kg\\,m^{-3}}$.\n- Thermal expansion coefficient is a linear function of Celsius temperature ($T_C$): $\\alpha(T_{\\mathrm{C}}) = \\alpha_0 + \\alpha_1\\,T_{\\mathrm{C}}$, with $\\alpha_0 = 1.5\\times 10^{-4}\\,\\mathrm{K^{-1}}$ and $\\alpha_1 = 3.5\\times 10^{-6}\\,\\mathrm{K^{-1}\\,(^{\\circ}C)^{-1}}$.\n- The specific heat capacity $c_p$ in the denominator of $\\gamma$ can be approximated by the reference constant $c_p^0 = 3991.86795711963\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, which is consistent with the leading-order nature of this calculation.\n\nThe problem instructs us to approximate the integral for $\\theta$ by treating $\\gamma$ as a constant, evaluated at the given in-situ temperature and pressure. This simplifies the integral to a simple product:\n$$ \\int_{0}^{p_{\\mathrm{Pa}}} \\gamma(T, S_A, p') \\,dp' \\approx \\gamma(T_{\\mathrm{in-situ}}, S_A, p_{\\mathrm{in-situ}}) \\times (p_{\\mathrm{Pa}} - 0) = \\gamma \\cdot p_{\\mathrm{Pa}} $$\nThus, the computational formula for potential temperature $\\theta$ (in Kelvin) is:\n$$ \\theta = T_K - \\left( \\frac{(\\alpha_0 + \\alpha_1 T_C) \\, T_K}{\\rho \\, c_p^0} \\right) \\cdot (p_{\\mathrm{dbar}} \\times 10^4) $$\nwhere $T_K = T_C + 273.15$ is the in-situ temperature in Kelvin.\n\n**Step 2: Derivation and Calculation of the Difference ($\\Theta - \\theta$)**\n\nConservative Temperature, $\\Theta$, is defined from potential enthalpy, $h^0$, by the relation $h^0 = c_p^0\\,\\Theta + \\text{constant}$. This definition makes $\\Theta$ a direct proxy for the heat content of seawater, a property not held by potential temperature $\\theta$ due to the temperature and pressure dependence of $c_p$.\n\nThe problem provides a tractable formula for the difference $\\Theta - \\theta$, which arises from the temperature dependence of $c_p$:\n$$ \\Theta - \\theta \\approx \\frac{1}{2}\\,b_1\\,\\big(\\theta - T_{\\mathrm{ref}}\\big)^2 $$\nThis formula is derived from the expression:\n$$ \\Theta - \\theta \\approx \\frac{1}{c_p^0}\\int_{T_{\\mathrm{ref}}}^{\\theta} c_p(T')\\,dT' - (\\theta - T_{\\mathrm{ref}}) $$\nUsing the given linear approximation for $c_p(T')$:\n$$ c_p(T') \\approx c_p^0 \\left[1 + b_1\\,(T' - T_{\\mathrm{ref}})\\right] $$\nwhere $b_1 = 1.0\\times 10^{-4}\\,\\mathrm{K^{-1}}$ and $T_{\\mathrm{ref}} = 273.15\\,\\mathrm{K}$. Substituting this into the integral yields:\n$$ \\int_{T_{\\mathrm{ref}}}^{\\theta} c_p^0 \\left[1 + b_1(T' - T_{\\mathrm{ref}})\\right] dT' = c_p^0 \\left[ T' + \\frac{b_1}{2}(T' - T_{\\mathrm{ref}})^2 \\right]_{T_{\\mathrm{ref}}}^{\\theta} = c_p^0 \\left( (\\theta - T_{\\mathrm{ref}}) + \\frac{b_1}{2}(\\theta - T_{\\mathrm{ref}})^2 \\right) $$\nPlugging this result back into the expression for $\\Theta - \\theta$:\n$$ \\Theta - \\theta \\approx \\frac{1}{c_p^0} \\left[ c_p^0 \\left( (\\theta - T_{\\mathrm{ref}}) + \\frac{b_1}{2}(\\theta - T_{\\mathrm{ref}})^2 \\right) \\right] - (\\theta - T_{\\mathrm{ref}}) $$\n$$ \\Theta - \\theta \\approx (\\theta - T_{\\mathrm{ref}}) + \\frac{b_1}{2}(\\theta - T_{\\mathrm{ref}})^2 - (\\theta - T_{\\mathrm{ref}}) = \\frac{1}{2}b_1(\\theta - T_{\\mathrm{ref}})^2 $$\nThis confirms the provided formula. Our computational algorithm is therefore a two-step process: first, calculate $\\theta$ from the in-situ conditions, and second, use this value of $\\theta$ to calculate the difference $\\Theta - \\theta$.\n\n**Step 3: Algorithm Summary**\n\nFor each test case $(T_C, p_{\\mathrm{dbar}})$:\n1. Convert the in-situ temperature from Celsius to Kelvin: $T_K = T_C + 273.15$.\n2. Calculate the thermal expansion coefficient: $\\alpha = \\alpha_0 + \\alpha_1 T_C$.\n3. Calculate the adiabatic lapse rate: $\\gamma = (\\alpha T_K) / (\\rho c_p^0)$.\n4. Convert the in-situ pressure to Pascals: $p_{\\mathrm{Pa}} = p_{\\mathrm{dbar}} \\times 10^4$.\n5. Calculate the potential temperature in Kelvin: $\\theta = T_K - \\gamma p_{\\mathrm{Pa}}$.\n6. Calculate the final difference: $\\Delta_{\\Theta\\theta} = \\frac{1}{2} b_1 (\\theta - T_{\\mathrm{ref}})^2$.\n7. Round the result to six decimal places for output.\n\n**Discussion on Dynamic Importance**\n\nThe difference between Conservative Temperature ($\\Theta$) and potential temperature ($\\theta$) is fundamentally a measure of the effect of the temperature-dependence of the specific heat capacity $c_p$ on the heat content (enthalpy) of seawater. Although the numerical difference $\\Theta - \\theta$ is typically small (on the order of $10^{-3}$ to $10^{-1}\\,\\mathrm{K}$), its implications for ocean dynamics are significant, particularly in the deep ocean and in studies of mixing and water mass transformation.\n\nThe core issue is that ocean buoyancy and mixing are governed by density and enthalpy, respectively. Static stability is determined by the vertical gradient of density. Traditionally, oceanographers used potential density, $\\sigma_\\theta = \\rho(S_A, \\theta, p_{\\mathrm{ref}})$, to assess stability. However, this framework is flawed because $\\theta$ is not a conserved quantity under mixing. If two water parcels with the same $\\theta$ but different depths (and thus different in-situ temperatures and pressures) are mixed, the resulting mixture's $\\theta$ is not conserved. This non-conservative behavior stems from the non-linearity of the equation of state and the variability of $c_p$.\n\nConservative Temperature $\\Theta$ was introduced in TEOS-$10$ to rectify this. By definition, $\\Theta$ is proportional to potential enthalpy, which is the thermodynamically correct quantity representing heat content that is conserved in mixing processes. Consequently, $\\Theta$ mixes nearly linearly. This makes $\\Theta$ a superior variable for water mass analysis and for modeling heat transport and budgets.\n\nThe dynamic importance of using $\\Theta$ over $\\theta$ becomes most apparent in the deep ocean. Waters below $2000\\,\\mathrm{m}$ are characterized by high pressures and near-freezing temperatures. In these conditions:\n1.  **Stability Calculations:** The vertical stratification is often very weak. A small error in the temperature variable used to calculate the vertical density gradient can lead to incorrect conclusions about static stability (i.e., whether the water column is stable, neutral, or unstable). The difference $\\Theta - \\theta$ can be large enough to alter the sign of the calculated stability parameter in such regions.\n2.  **Thermobaricity:** This is the effect where the compressibility of cold water is greater than that of warm water. A parcel of cold water compressed adiabatically becomes denser relative to its surroundings more rapidly than a warm water parcel does. This process, crucial for deep convection, is more accurately captured using enthalpy-based variables like $\\Theta$.\n3.  **Heat Budgets:** Global and basin-scale heat budget calculations require an accurate representation of heat content. Using $\\theta$ introduces systematic errors because it is not a proxy for enthalpy. The deep ocean is the largest heat reservoir on the planet, and accurately quantifying changes in its heat content is critical for climate science. Using $\\Theta$ is essential for this purpose.\n\nIn summary, the difference $\\Theta - \\theta$ is a correction that accounts for the thermodynamic reality that heat content is not linearly proportional to potential temperature. This correction is dynamically crucial for accurate modeling of deep ocean circulation, mixing, stability, and climate-relevant heat storage.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference between Conservative Temperature and potential\n    temperature based on TEOS-10 first-principle approximations.\n    \"\"\"\n    # Define physical constants and model parameters from the problem statement.\n    SA = 35.0  # Absolute Salinity (g/kg), fixed\n    CP0 = 3991.86795711963  # Reference specific heat capacity (J kg^-1 K^-1)\n    T_REF_K = 273.15  # Reference absolute temperature (K)\n    RHO = 1027.0  # Constant density (kg m^-3)\n    ALPHA0 = 1.5e-4  # Thermal expansion coefficient parameter (K^-1)\n    ALPHA1 = 3.5e-6  # Thermal expansion coefficient parameter (K^-1 degC^-1)\n    B1 = 1.0e-4  # Specific heat capacity slope parameter (K^-1)\n\n    # Define the test suite: list of tuples (T_in-situ_C, p_in-situ_dbar)\n    test_cases = [\n        (25.0, 0),\n        (25.0, 1000),\n        (2.0, 4000),\n        (-1.8, 0),\n        (0.0, 6000),\n        (10.0, 500),\n    ]\n\n    results = []\n    for t_c, p_dbar in test_cases:\n        # Step 1: Convert in-situ temperature to Kelvin.\n        t_k = t_c + 273.15\n\n        # Step 2: Calculate the thermal expansion coefficient alpha.\n        alpha = ALPHA0 + ALPHA1 * t_c\n\n        # Step 3: Calculate the adiabatic lapse rate gamma (approximated).\n        # gamma is in K/Pa.\n        gamma = (alpha * t_k) / (RHO * CP0)\n\n        # Step 4: Convert pressure from decibars to Pascals.\n        p_pa = p_dbar * 1.0e4\n\n        # Step 5: Calculate potential temperature theta (in Kelvin) using the\n        # simplified integral, which becomes a simple product.\n        theta_k = t_k - gamma * p_pa\n\n        # Step 6: Calculate the difference between Conservative and potential temperature.\n        # The formula is Delta = 0.5 * b1 * (theta - T_ref)^2\n        # theta is in Kelvin, T_ref is in Kelvin.\n        theta_conserv_diff = 0.5 * B1 * (theta_k - T_REF_K)**2\n\n        # Step 7: Format the result to six decimal places.\n        # The f-string formatting handles rounding to the nearest value.\n        results.append(f\"{theta_conserv_diff:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}