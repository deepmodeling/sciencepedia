{
    "hands_on_practices": [
        {
            "introduction": "将理论付诸实践的第一步是理解基本变量是如何从第一性原理计算出来的，而不仅仅是将其作为“黑箱”函数来使用。本练习将指导您从零开始，通过数值方法实现计算位温所依据的基本热力学常微分方程。这项实践不仅能让您深入了解海洋学标准软件库（如 TEOS-10）背后的计算核心，也是计算海洋学家的必备技能。",
            "id": "3808321",
            "problem": "您的任务是设计并实现一个基准测试，用于从第一性原理计算海洋学中的位温，并在一个科学上真实的测试套件中量化数值积分误差。海水包裹的位温 $\\,\\theta\\,$ 是指当该水块被绝热地移动到指定的参考压力 $\\,p_{\\mathrm{ref}} = 0\\,\\mathrm{dbar}\\,$ 时所具有的温度。您的基准测试必须在一个固定步长的 $\\,\\theta\\,$ 数值积分器与一个高精度参考计算之间进行比较，该参考计算模拟了 2010 年海水热力学方程 (TEOS-10) 库的结果（例如，函数 $\\,\\mathrm{gsw\\_pt\\_from\\_t}\\,$ 的行为），并遵循以下约束和要求：\n\n1. 基本原理。从海水绝热温度变化的热力学恒等式和静力学关系出发，结合一个经过充分测试的海水密度状态方程。基于这些，构建在绝对盐度 $\\,S_A\\,$ 固定的情况下，绝热、等熵位移下的 $\\,t(p)\\,$ 常微分方程 (ODE)：\n   - 使用静力平衡 $\\,\\mathrm{d}p/\\mathrm{d}z = \\rho g\\,$，其中 $\\,\\rho\\,$ 是密度，$\\,g\\,$ 是重力加速度。\n   - 使用通过热膨胀系数 $\\,\\alpha\\,$、定压比热 $\\,C_p\\,$ 和密度 $\\,\\rho\\,$ 将绝热温度变化与压力联系起来的热力学关系。\n   - 将热膨胀系数定义为 $\\,\\alpha = -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_{S,p}\\,$，并认识到绝热恒等式中的 $\\,T\\,$ 是以开尔文为单位的绝对温度。\n\n   在您的实现中，不得使用任何预打包的 TEOS-10 函数调用。相反，您应使用联合国教育、科学及文化组织 (UNESCO) 1983 年海水状态方程（一个广泛使用、经过充分测试的经验多项式）来计算密度 $\\,\\rho(S_A,t,p)\\,$，并通过在固定的 $\\,S_A\\,$ 和 $\\,p\\,$下对 $\\,t\\,$ 进行数值微分，从 $\\,\\rho\\,$ 计算 $\\,\\alpha\\,$。在本练习中，将绝对盐度 $\\,S_A\\,$ 在数值上视为等同于实用盐度。对海水定压比热 $\\,C_p\\,$ 使用一个恒定的、符合实际的值。压力变量 $\\,p\\,$ 必须以分巴 ($\\,\\mathrm{dbar}\\,$) 为单位处理，并在基本物理关系需要时正确转换为帕斯卡。\n\n2. 需实现的数值方法。\n   - 实现一个在 $\\,p\\,$ 上具有固定步长的四阶龙格-库塔方法，用于将 $\\,\\mathrm{d}t/\\mathrm{d}p\\,$ 从初始压力 $\\,p_0\\,$ 积分到 $\\,p_{\\mathrm{ref}} = 0\\,\\mathrm{dbar}\\,$，同时保持 $\\,S_A\\,$ 恒定并在每个子步骤中更新 $\\,\\rho$ 和 $\\,\\alpha$。此积分器的结果即为您计算出的位温 $\\,\\theta\\,.$\n   - 实现一个高精度自适应常微分方程求解器，通过以非常严格的容差和自动步长控制来积分相同的常微分方程，以计算参考位温 $\\,\\theta_{\\mathrm{ref}}\\,$，这在精神上代表了 TEOS-10 库的结果。这将作为误差量化的内部“库基准”。\n\n3. 位密度异常。使用您计算出的 $\\,\\theta\\,$ 和 $\\,\\theta_{\\mathrm{ref}}\\,$, 计算参考于 $\\,p=0\\,$ 的相应位密度异常，其定义为 $\\,\\sigma_0 = \\rho(S_A,\\theta,0) - 1000\\,$ 和 $\\,\\sigma_{0,\\mathrm{ref}} = \\rho(S_A,\\theta_{\\mathrm{ref}},0) - 1000\\,$，其中 $\\,\\rho\\,$ 使用 UNESCO 1983 状态方程计算。\n\n4. 误差度量和单位。对于每个测试案例，计算：\n   - 位温的绝对误差 $\\,|\\theta - \\theta_{\\mathrm{ref}}|\\,$，单位为开尔文。\n   - 位密度异常的绝对误差 $\\,|\\sigma_0 - \\sigma_{0,\\mathrm{ref}}|\\,$，单位为千克/立方米。\n\n   报告每个案例的两种误差度量。\n\n5. 测试套件。在以下五个测试案例上评估您的程序，这些案例涵盖了海洋中遇到的绝对盐度 $\\,S_A\\,$、现场温度 $\\,t\\,$ 和压力 $\\,p\\,$ 的范围，并包括边界和边缘情景：\n   - 案例 1 (常规情况): $\\,S_A = 35\\,\\mathrm{g/kg},\\; t = 10\\,^\\circ\\mathrm{C},\\; p = 1000\\,\\mathrm{dbar}\\,$.\n   - 案例 2 (边界压力): $\\,S_A = 0\\,\\mathrm{g/kg},\\; t = 0\\,^\\circ\\mathrm{C},\\; p = 0\\,\\mathrm{dbar}\\,$.\n   - 案例 3 (深海): $\\,S_A = 35\\,\\mathrm{g/kg},\\; t = 2\\,^\\circ\\mathrm{C},\\; p = 6000\\,\\mathrm{dbar}\\,$.\n   - 案例 4 (暖、咸): $\\,S_A = 37\\,\\mathrm{g/kg},\\; t = 25\\,^\\circ\\mathrm{C},\\; p = 2000\\,\\mathrm{dbar}\\,$.\n   - 案例 5 (冷、淡): $\\,S_A = 5\\,\\mathrm{g/kg},\\; t = -1.5\\,^\\circ\\mathrm{C},\\; p = 500\\,\\mathrm{dbar}\\,$.\n\n6. 最终输出格式。您的程序应生成单行输出，其中包含五个测试案例的误差结果，格式为方括号内以逗号分隔的浮点数列表，并按上述顺序列出每个案例的温度误差和位密度异常误差，两者交错排列。例如，输出必须采用\n$\\,\\big[ e_{\\theta,1}, e_{\\sigma_0,1}, e_{\\theta,2}, e_{\\sigma_0,2}, e_{\\theta,3}, e_{\\sigma_0,3}, e_{\\theta,4}, e_{\\sigma_0,4}, e_{\\theta,5}, e_{\\sigma_0,5} \\big]\\,$的形式，\n其中 $\\,e_{\\theta,i}\\,$ 的单位是开尔文，$\\,e_{\\sigma_0,i}\\,$ 的单位是千克/立方米。\n\n您的实现必须科学上真实且数值上自洽，所有计算都必须明确遵循物理单位：以开尔文报告温度误差，以千克/立方米报告位密度异常误差。本问题不涉及角度。本问题不涉及百分比。代码必须是自包含的，并且除了明确允许的库之外，不依赖于外部文件或库。",
            "solution": "用户提供了一个需要在计算海洋学中设计和实现数值基准测试的问题。核心任务是通过从第一性原理出发，积分绝热温度变化的热力学方程，来计算海水包裹的位温 $\\theta$。然后将此计算值与高精度参考解进行比较，以量化固定步长积分器的数值误差。该问题在科学上是适定的，基于基础热力学和流体动力学，并使用了一个标准（尽管是历史性的）海水状态方程，即 UNESCO 1983 公式。\n\n### 1. 问题验证\n问题陈述已经过验证，被认为是合理的。它具有科学依据、适定且客观。它包含了构建解决方案所需的所有必要信息，仅有少数数值参数（$C_p$、数值步长和求解器容差）除外。作为该领域的主题专家，我将为这些参数选择标准的、可辩护的值：\n- 定压比热，$C_p = 3996.0 \\, \\mathrm{J} \\cdot \\mathrm{kg}^{-1} \\cdot \\mathrm{K}^{-1}$。这是海水的典型平均值。\n- 龙格-库塔积分器的固定步长，$\\Delta p = -10.0 \\, \\mathrm{dbar}$。步长为负，因为积分从较高的初始压力 $p_0$ 向下进行到参考压力 $p_{\\mathrm{ref}}=0 \\, \\mathrm{dbar}$。\n- 用于数值微分密度以求得 $\\alpha$ 的步长，$\\Delta t = 10^{-5} \\,^{\\circ}\\mathrm{C}$。\n- 高精度参考求解器（`scipy.integrate.solve_ivp`）的容差，`rtol=1e-12` 和 `atol=1e-12`。\n\n指定这些参数后，问题就完全确定且可解。\n\n### 2. 理论构建\n\n位温 $\\theta$ 是通过求解一个描述流体包裹在绝热压缩或膨胀下温度变化的常微分方程 (ODE) 来找到的。\n\n**绝热温度梯度：**\n对于一个等熵（绝热且可逆）过程，温度 $T$ 随压力 $p$ 的变化由以下热力学关系给出：\n$$\n\\left(\\frac{\\partial T}{\\partial p}\\right)_S = \\frac{T \\alpha}{\\rho C_p}\n$$\n在此， $T$ 是以开尔文为单位的绝对温度，$\\rho$ 是现场密度，$C_p$ 是定压比热容，$\\alpha$ 是热膨胀系数。下标 $S$ 表示此导数是在盐度恒定的情况下求得的。\n\n**热膨胀系数：**\n热膨胀系数 $\\alpha$ 定义为：\n$$\n\\alpha = -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_{p,S}\n$$\n在此问题中，我们被要求使用应用于 UNESCO 1983 海水密度状态方程 $\\rho(S_A, t, p)$ 的数值有限差分近似来计算 $\\alpha$。\n\n**用于数值积分的常微分方程：**\n该问题使用摄氏度 ($^{\\circ}\\mathrm{C}$) 为单位的现场温度 $t$ 和分巴 ($\\mathrm{dbar}$) 为单位的压力 $p$。热力学关系使用开尔文 ($\\mathrm{K}$) 为单位的绝对温度 $T$ 和帕斯卡 ($\\mathrm{Pa}$) 为单位的压力 $p$。我们必须进行必要的单位转换。\n- $T[\\mathrm{K}] = t[^{\\circ}\\mathrm{C}] + 273.15$\n- $p[\\mathrm{Pa}] = p[\\mathrm{dbar}] \\times 10^4$\n\n微分变换为：$\\mathrm{d}T = \\mathrm{d}t$ 和 $\\mathrm{d}p_{\\mathrm{Pa}} = 10^4 \\mathrm{d}p_{\\mathrm{dbar}}$。以分巴为单位的压力 $p$ 的函数 $t$ 的常微分方程是：\n$$\n\\frac{\\mathrm{d}t}{\\mathrm{d}p_{\\mathrm{dbar}}} = \\frac{\\mathrm{d}T}{\\mathrm{d}p_{\\mathrm{Pa}}} \\frac{\\mathrm{d}p_{\\mathrm{Pa}}}{\\mathrm{d}p_{\\mathrm{dbar}}} = \\left(\\frac{(t + 273.15) \\alpha}{\\rho C_p}\\right) \\times 10^4\n$$\n这是一个一阶常微分方程，$\\frac{\\mathrm{d}t}{\\mathrm{d}p} = f(p, t, S_A)$，我们将从初始状态 $(t_0, p_0)$ 积分到参考压力 $p_{\\mathrm{ref}}=0 \\, \\mathrm{dbar}$。最终的温度 $t(p=0)$ 就是位温 $\\theta$。\n\n### 3. 数值实现策略\n\n**状态方程 (EOS)：**\n密度函数 $\\rho(S_A, t, p)$ 将根据 UNESCO 1983 (EOS-80) 标准实现。这涉及一组多项式，分别用于纯水密度、表层压力下盐度的影响，以及通过正割体积模量 $K(S_A, t, p)$ 实现的压力（可压缩性）影响。在转录多项式系数时需格外小心以确保准确性。\n\n**数值微分：**\n热膨胀系数 $\\alpha$ 将使用二阶中心差分公式计算：\n$$\n\\alpha(S_A, t, p) \\approx -\\frac{1}{\\rho(S_A, t, p)} \\frac{\\rho(S_A, t+\\Delta t, p) - \\rho(S_A, t-\\Delta t, p)}{2 \\Delta t}\n$$\n其中步长很小，$\\Delta t = 10^{-5} \\,^{\\circ}\\mathrm{C}$。\n\n**常微分方程求解器：**\n将实现两种方法来解决该初值问题：\n1.  **固定步长四阶龙格-库塔 (RK4)：** 将从头编写一个函数来执行 RK4 积分。给定步长 $\\Delta p$，下一步的温度按如下方式更新：\n    $$\n    t_{i+1} = t_i + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n    $$\n    其中\n    $k_1 = \\Delta p \\cdot f(p_i, t_i, S_A)$\n    $k_2 = \\Delta p \\cdot f(p_i + \\frac{\\Delta p}{2}, t_i + \\frac{k_1}{2}, S_A)$\n    $k_3 = \\Delta p \\cdot f(p_i + \\frac{\\Delta p}{2}, t_i + \\frac{k_2}{2}, S_A)$\n    $k_4 = \\Delta p \\cdot f(p_i + \\Delta p, t_i + k_3, S_A)$\n\n2.  **高精度自适应求解器：** 将使用 `scipy.integrate.solve_ivp` 函数作为高精度参考。它采用自适应步长控制算法（我们将使用默认的 'RK45'）和非常严格的绝对和相对容差 ($10^{-12}$) 来生成“基准真相”结果 $\\theta_{\\mathrm{ref}}$。\n\n**误差量化：**\n对于每个测试案例，在通过 RK4 方法计算出位温 ($\\theta$) 和通过参考方法计算出位温 ($\\theta_{\\mathrm{ref}}$) 之后，我们计算位密度异常 $\\sigma_0$。\n- $\\sigma_0 = \\rho(S_A, \\theta, 0) - 1000$\n- $\\sigma_{0, \\mathrm{ref}} = \\rho(S_A, \\theta_{\\mathrm{ref}}, 0) - 1000$\n\n最终的误差度量是绝对差：$|\\theta - \\theta_{\\mathrm{ref}}|$ 和 $|\\sigma_0 - \\sigma_{0, \\mathrm{ref}}|$。当初始压力为 $0 \\, \\mathrm{dbar}$ 时，这是一个平凡情况，此时 $\\theta = t$，误差为零。\n\n解决方案将以一个自包含的 Python 脚本形式呈现，该脚本为提供的测试套件执行这些步骤，并以指定格式打印结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the computational oceanography benchmark problem.\n\n    This function implements the entire workflow:\n    1. Defines physical and numerical constants.\n    2. Implements the UNESCO 1983 equation of state for seawater density.\n    3. Defines the ODE for adiabatic temperature change.\n    4. Implements a fixed-step fourth-order Runge-Kutta integrator.\n    5. Loops through the test suite, computing potential temperature with both the\n       RK4 method and a high-accuracy reference solver (Scipy's solve_ivp).\n    6. Computes errors in potential temperature and potential density anomaly.\n    7. Prints the results in the specified format.\n    \"\"\"\n    \n    # --- 1. Constants and Parameters ---\n    # Physical Constants\n    T0_KELVIN = 273.15  # Conversion from Celsius to Kelvin\n    DBAR_TO_PA = 1e4    # Conversion from dbar to Pascals\n    CP_SVP = 3996.0     # Specific heat of seawater, J/kg/K (constant)\n\n    # Numerical Parameters\n    RK4_STEP_DBAR = -10.0   # Fixed step size for RK4 integrator (dbar)\n    DT_FOR_ALPHA = 1e-5     # Step size for numerical differentiation (degC)\n    RTOL_REF = 1e-12        # Relative tolerance for reference solver\n    ATOL_REF = 1e-12        # Absolute tolerance for reference solver\n    \n    # --- 2. UNESCO 1983 (EOS-80) Equation of State for Seawater Density ---\n    def rho_unesco83(S, t, p):\n        \"\"\"\n        Computes seawater density using the UNESCO 1983 (EOS-80) polynomial.\n        \n        Args:\n            S (float): Salinity (PSU, g/kg)\n            t (float): Temperature (degC, ITS-90)\n            p (float): Pressure (dbar)\n\n        Returns:\n            float: Density (kg/m^3)\n        \"\"\"\n        # Coefficients from Fofonoff, N.P. and R.C. Millard Jr, 1983,\n        # UNESCO Tech. Pap. in Mar. Sci., No. 44.\n\n        # Part 1: Density of pure water at 1 atm\n        rho_w = (999.842594 + 6.793952e-2 * t - 9.095290e-3 * t**2 + \n                 1.001685e-4 * t**3 - 1.120083e-6 * t**4 + 6.536332e-9 * t**5)\n\n        # Part 2: Density of seawater at 1 atm\n        A_t = (8.24493e-1 - 4.0899e-3 * t + 7.6438e-5 * t**2 - \n               8.2467e-7 * t**3 + 5.3875e-9 * t**4)\n        B_t = -5.72466e-3 + 1.0227e-4 * t - 1.6546e-6 * t**2\n        C_t = 4.8314e-4\n        rho_S_t_0 = rho_w + A_t * S + B_t * S**1.5 + C_t * S**2\n\n        # Part 3: Secant Bulk Modulus K(S, t, p)\n        # Pressure in bars for this formula\n        p_bar = p / 10.0\n        \n        # K for pure water\n        K_w = (19652.21 + 148.4206 * t - 2.327105 * t**2 + \n               1.360477e-2 * t**3 - 5.155288e-5 * t**4)\n        \n        # Salinity terms for K at p=0\n        a = (54.6746 - 0.603459 * t + 1.09987e-2 * t**2 - 6.1670e-5 * t**3)\n        b = 7.944e-2 + 1.6483e-2 * t - 5.3009e-4 * t**2\n        K_S_t_0 = K_w + a * S + b * S**1.5\n        \n        # Pressure terms for K\n        A_w = 3.239908 + 1.43713e-3 * t + 1.16092e-4 * t**2 - 5.77905e-7 * t**3\n        i_term = 2.2838e-3 - 1.0981e-5 * t - 1.6078e-6 * t**2\n        j_term = 1.91075e-4\n        A = A_w + i_term * S + j_term * S**1.5\n        \n        B_w = 8.50935e-5 - 6.12293e-6 * t + 5.2787e-8 * t**2\n        k_term = -9.9348e-7 + 2.0816e-8 * t + 9.1697e-10 * t**2\n        B = B_w + k_term * S\n\n        K = K_S_t_0 + A * p_bar + B * p_bar**2\n        \n        # Final density calculation\n        rho = rho_S_t_0 / (1.0 - p / K)\n        return rho\n\n    # --- 3. ODE and Supporting Functions ---\n    def alpha_thermex(S, t, p):\n        \"\"\"Computes thermal expansion coefficient via central difference.\"\"\"\n        rho_plus = rho_unesco83(S, t + DT_FOR_ALPHA, p)\n        rho_minus = rho_unesco83(S, t - DT_FOR_ALPHA, p)\n        rho_center = rho_unesco83(S, t, p)\n        d_rho_d_t = (rho_plus - rho_minus) / (2 * DT_FOR_ALPHA)\n        return -d_rho_d_t / rho_center\n\n    def dt_dp_func(p, t, S):\n        \"\"\"\n        The ODE function dt/dp for adiabatic temperature change.\n        p is in dbar, t is in degC.\n        \"\"\"\n        rho_val = rho_unesco83(S, t, p)\n        alpha_val = alpha_thermex(S, t, p)\n        T_val = t + T0_KELVIN\n        \n        # RHS of the ODE: dt/dp_dbar = (T*alpha / (rho*Cp)) * 10^4\n        return (T_val * alpha_val) / (rho_val * CP_SVP) * DBAR_TO_PA\n\n    # --- 4. Numerical Integrators ---\n    def rk4_integrator(f, y0, p_span, S, dp):\n        \"\"\"A simple fixed-step 4th-order Runge-Kutta integrator.\"\"\"\n        p0, pf = p_span\n        y = y0\n        p = p0\n        \n        n_steps = int(np.floor((pf - p0) / dp))\n        \n        for _ in range(n_steps):\n            k1 = dp * f(p, y, S)\n            k2 = dp * f(p + 0.5 * dp, y + 0.5 * k1, S)\n            k3 = dp * f(p + 0.5 * dp, y + 0.5 * k2, S)\n            k4 = dp * f(p + dp, y + k3, S)\n            y += (k1 + 2*k2 + 2*k3 + k4) / 6.0\n            p += dp\n            \n        # Final smaller step if needed\n        dp_final = pf - p\n        if abs(dp_final) > 1e-9:\n             k1 = dp_final * f(p, y, S)\n             k2 = dp_final * f(p + 0.5 * dp_final, y + 0.5 * k1, S)\n             k3 = dp_final * f(p + 0.5 * dp_final, y + 0.5 * k2, S)\n             k4 = dp_final * f(p + dp_final, y + k3, S)\n             y += (k1 + 2*k2 + 2*k3 + k4) / 6.0\n        \n        return y\n\n    # --- 5. Test Suite and Main Calculation Loop ---\n    test_cases = [\n        (35.0, 10.0, 1000.0),  # Case 1 (happy path)\n        (0.0, 0.0, 0.0),      # Case 2 (boundary pressure)\n        (35.0, 2.0, 6000.0),   # Case 3 (abyssal)\n        (37.0, 25.0, 2000.0),  # Case 4 (warm, saline)\n        (5.0, -1.5, 500.0)    # Case 5 (cold, fresh)\n    ]\n\n    results = []\n    p_ref = 0.0\n\n    for S_A, t_insitu, p_insitu in test_cases:\n        p_span = (p_insitu, p_ref)\n        \n        # Handle trivial case where p_insitu is already at reference\n        if p_insitu == p_ref:\n            theta_rk4 = t_insitu\n            theta_ref = t_insitu\n        else:\n            # Compute potential temperature using RK4\n            theta_rk4 = rk4_integrator(dt_dp_func, t_insitu, p_span, S_A, RK4_STEP_DBAR)\n            \n            # Compute reference potential temperature using high-accuracy solver\n            sol = solve_ivp(dt_dp_func, p_span, [t_insitu], args=(S_A,),\n                            method='RK45', rtol=RTOL_REF, atol=ATOL_REF)\n            theta_ref = sol.y[0, -1]\n\n        # --- 6. Compute Potential Density Anomaly and Errors ---\n        rho_rk4 = rho_unesco83(S_A, theta_rk4, p_ref)\n        rho_ref = rho_unesco83(S_A, theta_ref, p_ref)\n        \n        sigma0_rk4 = rho_rk4 - 1000.0\n        sigma0_ref = rho_ref - 1000.0\n        \n        error_theta = abs(theta_rk4 - theta_ref)\n        error_sigma0 = abs(sigma0_rk4 - sigma0_ref)\n        \n        results.extend([error_theta, error_sigma0])\n\n    # --- 7. Final Output ---\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了位势属性的计算方法之后，下一步是理解海水状态方程中的精妙之处。本练习聚焦于“密增效应”（cabbeling），这是一种关键的非线性现象，即混合两个等密度水团会产生一个密度更高的混合水团。通过在 $\\theta-S$ 图上分析这一现象，您将更深刻地理解等密面为何是弯曲的，以及这一特性如何影响水团分析。",
            "id": "3808268",
            "problem": "在计算海洋学中，水团分析经常使用位温-盐度（$\\theta$–$S$）图上参考海面的位密异常（用 $\\sigma_{0}$ 表示）等值线来近似等密线。位温 $\\theta$ 定义为一个海水包裹在绝热且无物质交换的情况下移动到参考压力 $p = 0$ 分巴时的温度，而位密异常 $\\sigma_{0}$ 定义为 $\\sigma_{0}(\\theta, S) = \\rho(\\theta, S, p=0) - 1000$，其中 $\\rho$ 是现场密度，异常的单位是千克/立方米。2010年海水热力学方程 (TEOS-10) 提供了一个经过充分检验的状态方程，在一个参考状态 $(\\theta_{0}, S_{0})$ 的小邻域内，$\\sigma_{0}$ 可以表示为关于 $\\Delta \\theta = \\theta - \\theta_{0}$ 和 $\\Delta S = S - S_{0}$ 的二阶泰勒展开。\n\nCabbeling（密增效应）是指当名义上位于“恒定密度”曲线上的两个水包裹因非线性状态方程而混合时发生的密度增加。当在 $\\theta$–$S$ 平面上仅使用一阶（线性）信息，用 $\\sigma_{0}$ 等值线来近似等密线时，这种效应会给水团分析带来偏差。\n\n考虑在参考点 $(\\theta_{0}, S_{0})$ 进行局部分析，其中 $\\theta$ 的单位是摄氏度，$S$ 是绝对盐度，单位是克/千克。假设从2010年海水热力学方程 (TEOS-10) 中可知以下 $\\sigma_{0}$ 的偏导数（均在 $(\\theta_{0}, S_{0})$ 和 $p = 0$ 分巴处求值）：\n$$\\sigma_{\\theta} = \\frac{\\partial \\sigma_{0}}{\\partial \\theta} = -0.205 \\ \\text{kg m}^{-3} \\ \\text{K}^{-1}, \\quad \\sigma_{S} = \\frac{\\partial \\sigma_{0}}{\\partial S} = 0.780 \\ \\text{kg m}^{-3} \\ (\\text{g kg}^{-1})^{-1},$$\n以及二阶导数\n$$\\sigma_{\\theta \\theta} = \\frac{\\partial^{2} \\sigma_{0}}{\\partial \\theta^{2}} = -0.0030 \\ \\text{kg m}^{-3} \\ \\text{K}^{-2}, \\quad \\sigma_{\\theta S} = \\frac{\\partial^{2} \\sigma_{0}}{\\partial \\theta \\, \\partial S} = -0.018 \\ \\text{kg m}^{-3} \\ \\text{K}^{-1} (\\text{g kg}^{-1})^{-1},$$\n$$\\sigma_{S S} = \\frac{\\partial^{2} \\sigma_{0}}{\\partial S^{2}} = 0.00035 \\ \\text{kg m}^{-3} \\ (\\text{g kg}^{-1})^{-2}.$$\n\n选取两个等体积的水包裹 $\\text{A}$ 和 $\\text{B}$，它们关于 $(\\theta_{0}, S_{0})$ 对称，偏移量分别为 $(\\Delta \\theta/2, \\Delta S/2)$ 和 $(-\\Delta \\theta/2, -\\Delta S/2)$。它们被约束在一阶上位于同一局部 $\\sigma_{0}$ 等值线上，即它们满足线性化的恒定-$\\sigma_{0}$ 条件\n$$\\sigma_{\\theta} \\, \\Delta \\theta + \\sigma_{S} \\, \\Delta S = 0,$$\n且给定的位温差为 $\\Delta \\theta = 0.8$。\n\n将cabbeling引起的偏差 $\\Delta \\sigma_{\\text{cab}}$ 定义为混合包裹的 $\\sigma_{0}$（由$\\text{A}$和$\\text{B}$等体积混合得到，结果为$(\\theta_{0}, S_{0})$）与在线性等值线近似下端点共同的 $\\sigma_{0}$ 之间的差值。使用提供的导数，将 $\\Delta \\sigma_{\\text{cab}}$ 量化到偏移量的二阶，并以千克/立方米为单位报告结果。将您的答案四舍五入到三位有效数字。",
            "solution": "问题要求量化由海水状态方程的非线性性质引起的cabbeling密度偏差 $\\Delta \\sigma_{\\text{cab}}$。问题中将cabbeling定义为“当两个水包裹……混合时发生的密度增加”。这意味着我们必须计算混合包裹的位密异常，并减去两个初始包裹的平均位密异常。\n\n设参考状态为 $(\\theta_{0}, S_{0})$，其位密异常为 $\\sigma_{0,ref} = \\sigma_{0}(\\theta_{0}, S_{0})$。在该参考点附近的位密异常 $\\sigma_{0}(\\theta, S)$ 可以通过二阶泰勒展开来近似：\n$$\n\\sigma_{0}(\\theta, S) \\approx \\sigma_{0,ref} + \\sigma_{\\theta}(\\theta - \\theta_0) + \\sigma_{S}(S - S_0) + \\frac{1}{2} \\left[ \\sigma_{\\theta\\theta}(\\theta - \\theta_0)^2 + 2\\sigma_{\\theta S}(\\theta - \\theta_0)(S - S_0) + \\sigma_{SS}(S - S_0)^2 \\right]\n$$\n其中偏导数 $\\sigma_{\\theta}$, $\\sigma_{S}$, $\\sigma_{\\theta\\theta}$, $\\sigma_{\\theta S}$, 和 $\\sigma_{SS}$ 均在参考点 $(\\theta_{0}, S_{0})$ 处求值。\n\n我们已知两个水包裹 A 和 B，它们关于参考点对称。它们的性质是：\n水包裹 A：$(\\theta_{A}, S_{A}) = (\\theta_{0} + \\frac{\\Delta \\theta}{2}, S_{0} + \\frac{\\Delta S}{2})$\n水包裹 B：$(\\theta_{B}, S_{B}) = (\\theta_{0} - \\frac{\\Delta \\theta}{2}, S_{0} - \\frac{\\Delta S}{2})$\n\n当这两个等体积的包裹混合时，得到的包裹具有初始包裹的平均性质，即 $(\\theta_{0}, S_{0})$。因此，混合包裹的位密异常为 $\\sigma_{0,mix} = \\sigma_{0}(\\theta_{0}, S_{0}) = \\sigma_{0,ref}$。\n\ncabbeling引起的密度增加是混合物密度与初始包裹平均密度之差：\n$$\n\\Delta \\sigma_{\\text{cab}} = \\sigma_{0,mix} - \\frac{\\sigma_{0}(\\theta_{A}, S_{A}) + \\sigma_{0}(\\theta_{B}, S_{B})}{2}\n$$\n\n我们使用泰勒展开来求包裹 A 和 B 的密度异常。对于包裹 A，偏移量为 $h = \\frac{\\Delta \\theta}{2}$ 和 $k = \\frac{\\Delta S}{2}$。对于包裹 B，偏移量为 $h = -\\frac{\\Delta \\theta}{2}$ 和 $k = -\\frac{\\Delta S}{2}$。\n\n$$\n\\sigma_{0}(\\theta_{A}, S_{A}) \\approx \\sigma_{0,ref} + \\sigma_{\\theta}\\left(\\frac{\\Delta \\theta}{2}\\right) + \\sigma_{S}\\left(\\frac{\\Delta S}{2}\\right) + \\frac{1}{2} \\left[ \\sigma_{\\theta\\theta}\\left(\\frac{\\Delta \\theta}{2}\\right)^2 + 2\\sigma_{\\theta S}\\left(\\frac{\\Delta \\theta}{2}\\right)\\left(\\frac\\Delta S}{2}\\right) + \\sigma_{SS}\\left(\\frac{\\Delta S}{2}\\right)^2 \\right]\n$$\n$$\n\\sigma_{0}(\\theta_{B}, S_{B}) \\approx \\sigma_{0,ref} + \\sigma_{\\theta}\\left(-\\frac{\\Delta \\theta}{2}\\right) + \\sigma_{S}\\left(-\\frac{\\Delta S}{2}\\right) + \\frac{1}{2} \\left[ \\sigma_{\\theta\\theta}\\left(-\\frac{\\Delta \\theta}{2}\\right)^2 + 2\\sigma_{\\theta S}\\left(-\\frac{\\Delta \\theta}{2}\\right)\\left(-\\frac{\\Delta S}{2}\\right) + \\sigma_{SS}\\left(-\\frac{\\Delta S}{2}\\right)^2 \\right]\n$$\n\n这两者的平均值是：\n$$\n\\frac{\\sigma_{0,A} + \\sigma_{0,B}}{2} \\approx \\sigma_{0,ref} + \\frac{1}{2} \\left[ \\sigma_{\\theta\\theta}\\left(\\frac{\\Delta \\theta}{2}\\right)^2 + 2\\sigma_{\\theta S}\\left(\\frac{\\Delta \\theta}{2}\\right)\\left(\\frac{\\Delta S}{2}\\right) + \\sigma_{SS}\\left(\\frac{\\Delta S}{2}\\right)^2 \\right]\n$$\n一阶项相互抵消。化简二阶项：\n$$\n\\frac{\\sigma_{0,A} + \\sigma_{0,B}}{2} \\approx \\sigma_{0,ref} + \\frac{1}{8} \\left[ \\sigma_{\\theta\\theta}(\\Delta \\theta)^2 + 2\\sigma_{\\theta S}\\Delta \\theta \\Delta S + \\sigma_{SS}(\\Delta S)^2 \\right]\n$$\n\n现在，我们将此代回 $\\Delta \\sigma_{\\text{cab}}$ 的表达式中：\n$$\n\\Delta \\sigma_{\\text{cab}} \\approx \\sigma_{0,ref} - \\left( \\sigma_{0,ref} + \\frac{1}{8} \\left[ \\sigma_{\\theta\\theta}(\\Delta \\theta)^2 + 2\\sigma_{\\theta S}\\Delta \\theta \\Delta S + \\sigma_{SS}(\\Delta S)^2 \\right] \\right)\n$$\n$$\n\\Delta \\sigma_{\\text{cab}} \\approx -\\frac{1}{8} \\left[ \\sigma_{\\theta\\theta}(\\Delta \\theta)^2 + 2\\sigma_{\\theta S}\\Delta \\theta \\Delta S + \\sigma_{SS}(\\Delta S)^2 \\right]\n$$\n\n包裹被约束在一阶上位于同一局部 $\\sigma_{0}$ 等值线上，这给出了关系式：\n$$\n\\sigma_{\\theta} \\, \\Delta \\theta + \\sigma_{S} \\, \\Delta S = 0\n$$\n我们可以用 $\\Delta \\theta$ 求解 $\\Delta S$：\n$$\n\\Delta S = -\\frac{\\sigma_{\\theta}}{\\sigma_{S}} \\Delta \\theta\n$$\n\n现在我们代入给定的数值：\n$\\sigma_{\\theta} = -0.205 \\ \\text{kg m}^{-3} \\ \\text{K}^{-1}$\n$\\sigma_{S} = 0.780 \\ \\text{kg m}^{-3} \\ (\\text{g kg}^{-1})^{-1}$\n$\\Delta \\theta = 0.8 \\ \\text{K}$\n\n$$\n\\Delta S = -\\frac{-0.205}{0.780} \\times 0.8 = \\frac{0.164}{0.780} = \\frac{164}{780} = \\frac{41}{195} \\ \\text{g kg}^{-1}\n$$\n\n接下来，我们使用提供的二阶导数计算 $\\Delta \\sigma_{\\text{cab}}$ 表达式中的二次项：\n$\\sigma_{\\theta \\theta} = -0.0030 \\ \\text{kg m}^{-3} \\ \\text{K}^{-2}$\n$\\sigma_{\\theta S} = -0.018 \\ \\text{kg m}^{-3} \\ \\text{K}^{-1} (\\text{g kg}^{-1})^{-1}$\n$\\sigma_{S S} = 0.00035 \\ \\text{kg m}^{-3} \\ (\\text{g kg}^{-1})^{-2}$\n\n设 $Q = \\sigma_{\\theta\\theta}(\\Delta \\theta)^2 + 2\\sigma_{\\theta S}\\Delta \\theta \\Delta S + \\sigma_{SS}(\\Delta S)^2$。我们计算 Q 的每个部分：\n第一项是：\n$$\n\\sigma_{\\theta\\theta}(\\Delta \\theta)^2 = (-0.0030) \\times (0.8)^2 = (-0.0030) \\times (0.64) = -0.00192\n$$\n第二项是：\n$$\n2\\sigma_{\\theta S}\\Delta \\theta \\Delta S = 2 \\times (-0.018) \\times (0.8) \\times \\left(\\frac{41}{195}\\right) = -0.0288 \\times \\left(\\frac{41}{195}\\right) = -\\frac{1.1808}{195} \\approx -0.00605538\n$$\n第三项是：\n$$\n\\sigma_{SS}(\\Delta S)^2 = (0.00035) \\times \\left(\\frac{41}{195}\\right)^2 = (0.00035) \\times \\frac{1681}{38025} = \\frac{0.58835}{38025} \\approx 0.00001547\n$$\n将这三项相加以求得 $Q$：\n$$\nQ \\approx -0.00192 - 0.00605538 + 0.00001547 = -0.00795991 \\ \\text{kg m}^{-3}\n$$\n\n最后，我们计算 $\\Delta \\sigma_{\\text{cab}}$：\n$$\n\\Delta \\sigma_{\\text{cab}} \\approx -\\frac{1}{8} Q = -\\frac{1}{8} (-0.00795991) \\approx 0.00099498875 \\ \\text{kg m}^{-3}\n$$\n\n问题要求将结果四舍五入到三位有效数字。\n$$\n\\Delta \\sigma_{\\text{cab}} \\approx 0.000995 \\ \\text{kg m}^{-3}\n$$\n这个正值与cabbeling是“密度增加”的说法是一致的。",
            "answer": "$$\n\\boxed{0.000995}\n$$"
        },
        {
            "introduction": "我们的最后一个练习将探讨另一个关键的复杂性：压力在密度比较中的作用。我们将研究“温盐效应”（thermobaricity），即水团的相对浮力取决于其所处的压力。本练习通过一个思想实验，揭示了为何使用单一参考压力的位密可能会产生误导，并为理解更复杂的“中性面”（neutral surfaces）概念提供了物理基础。",
            "id": "3808340",
            "problem": "考虑在北大西洋中纬度内部，于相同的现场压力 $p_0$ 下测量的两个水团。水团 $\\mathcal{A}$ 的位温 $\\theta_{\\mathcal{A}} = 2.0$（摄氏度），1978年实用盐标（PSS-78）盐度 $S_{\\mathcal{A}} = 34.85$；而水团 $\\mathcal{B}$ 的位温 $\\theta_{\\mathcal{B}} = 3.0$（摄氏度），盐度 $S_{\\mathcal{B}} = 35.05$。假设性质差异很小，因此可以对局部状态进行一阶线性化。\n\n参考压力为 $p_r$ 的位密，记作 $\\sigma_{p_r}$，其定义为将一个水团绝热地移动到压力 $p_r$ 处时所具有的密度，再减去一个在计算差值时会抵消的常数偏移量。在固定的参考压力下，密度对位温和盐度的依赖关系由热膨胀系数 $\\alpha$ 和盐收缩系数 $\\beta$ 决定，其定义为\n$$\n\\alpha \\equiv -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_{S,p}, \n\\qquad\n\\beta \\equiv \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{T,p},\n$$\n其中 $\\rho$ 是现场密度，$T$ 是绝对温度，$S$ 是基于 PSS-78 的无量纲浓度的盐度，$p$ 是压力。对于增量而言，可以忽略摄氏度和开尔文之间的差异（即 $\\Delta T = \\Delta \\theta$）。\n\n在所关心的狭窄 $(S,\\theta)$ 范围内，假设在参考压力 $p_r$（单位为分巴）下进行评估时，系数 $\\alpha$ 和 $\\beta$ 近似地随 $p_r$ 线性变化：\n$$\n\\alpha(p_r) = \\alpha_0 + a\\,p_r, \n\\qquad\n\\beta(p_r) = \\beta_0 + b\\,p_r,\n$$\n其中常数为\n$$\n\\alpha_0 = 2.1 \\times 10^{-4} \\ \\text{K}^{-1}, \\quad a = -1.0 \\times 10^{-8} \\ \\text{K}^{-1}\\,\\text{dbar}^{-1}, \\quad\n\\beta_0 = 7.6 \\times 10^{-4} \\ \\text{(PSS-78)}^{-1}, \\quad b = 2.0 \\times 10^{-8} \\ \\text{(PSS-78)}^{-1}\\,\\text{dbar}^{-1}.\n$$\n假设在所关心的范围内，进入密度在 $p_r$ 处线性化的密度比例因子 $\\rho(p_r)$ 可被视为不随 $p_r$ 变化（你可以取 $\\rho \\approx 1027$ $\\text{kg}\\,\\text{m}^{-3}$，但你会发现在符号计算中它会被抵消）。\n\n从上述核心定义和关于位温与位密的第一性原理出发，推导水团 $\\mathcal{B}$ 和 $\\mathcal{A}$ 之间依赖于参考压力的位密差 $\\Delta \\sigma_{p_r}$ 的解析表达式，该表达式应使用 $\\alpha(p_r)$、$\\beta(p_r)$、$\\Delta \\theta \\equiv \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}$ 和 $\\Delta S \\equiv S_{\\mathcal{B}} - S_{\\mathcal{A}}$ 来表示。然后，使用所提供的数值系数，计算使得 $\\Delta \\sigma_{p_r}$ 符号发生变化的唯一参考压力 $p_r^{\\ast}$（单位为分巴）（即 $\\Delta \\sigma_{p_r^{\\ast}} = 0$）。将最终的 $p_r^{\\ast}$ 四舍五入到四位有效数字，并以分巴表示。",
            "solution": "该问题要求两个结果：首先，是两个水团 $\\mathcal{B}$ 和 $\\mathcal{A}$ 之间位密差 $\\Delta \\sigma_{p_r}$ 的解析表达式；其次，是使该差值为零的特定参考压力 $p_r^{\\ast}$。解法是基于所提供的定义和线性近似，从第一性原理推导得出。\n\n参考压力为 $p_r$ 的位密，记作 $\\sigma_{p_r}$，是一个水团在压力 $p_r$ 下的密度减去一个常数。由于在求差时常数偏移量会抵消，位密差 $\\Delta \\sigma_{p_r}$ 等于在参考压力 $p_r$ 下，使用各水团各自的位温 $(\\theta)$ 和盐度 $(S)$ 计算出的实际密度差 $\\Delta \\rho(p_r)$。\n$$\n\\Delta \\sigma_{p_r} = \\sigma_{p_r, \\mathcal{B}} - \\sigma_{p_r, \\mathcal{A}} = \\rho(\\theta_{\\mathcal{B}}, S_{\\mathcal{B}}, p_r) - \\rho(\\theta_{\\mathcal{A}}, S_{\\mathcal{A}}, p_r)\n$$\n问题中指出，性质差异很小，这为对密度函数 $\\rho(\\theta, S, p_r)$ 进行一阶泰勒展开（线性化）提供了依据。我们可以在水团 $\\mathcal{A}$ 的状态周围展开水团 $\\mathcal{B}$ 的密度：\n$$\n\\rho(\\theta_{\\mathcal{B}}, S_{\\mathcal{B}}, p_r) \\approx \\rho(\\theta_{\\mathcal{A}}, S_{\\mathcal{A}}, p_r) + \\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} (\\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}) + \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} (S_{\\mathcal{B}} - S_{\\mathcal{A}})\n$$\n偏导数是在一个代表性状态 $(\\theta, S)$ 和参考压力 $p_r$ 下计算的。重新整理这个近似式，得到线性化的密度差：\n$$\n\\Delta \\sigma_{p_r} \\approx \\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} \\Delta \\theta + \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} \\Delta S\n$$\n其中 $\\Delta \\theta \\equiv \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}$ 且 $\\Delta S \\equiv S_{\\mathcal{B}} - S_{\\mathcal{A}}$。\n\n问题给出了在给定压力 $p$ 下热膨胀系数 $\\alpha$ 和盐收缩系数 $\\beta$ 的定义：\n$$\n\\alpha \\equiv -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_{S,p}, \\qquad \\beta \\equiv \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{T,p}\n$$\n根据题目要求，我们将位温 $\\theta$（单位为摄氏度）的增量视为与绝对温度 $T$（单位为开尔文）的增量等效，因此我们可以用 $\\partial/\\partial \\theta$ 替换 $\\partial/\\partial T$。密度的偏导数可以用 $\\alpha(p_r)$ 和 $\\beta(p_r)$ 表示为：\n$$\n\\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} = -\\rho(p_r) \\alpha(p_r), \\qquad \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} = \\rho(p_r) \\beta(p_r)\n$$\n密度 $\\rho(p_r)$ 是在压力 $p_r$ 下的参考密度，这里假设它是一个常数比例因子，记为 $\\rho_{\\text{ref}}$。将这些代入 $\\Delta \\sigma_{p_r}$ 的表达式中：\n$$\n\\Delta \\sigma_{p_r} = [-\\rho_{\\text{ref}} \\alpha(p_r)] \\Delta \\theta + [\\rho_{\\text{ref}} \\beta(p_r)] \\Delta S\n$$\n提出参考密度因子，得到所要求的位密差的解析表达式：\n$$\n\\Delta \\sigma_{p_r} = \\rho_{\\text{ref}} (\\beta(p_r) \\Delta S - \\alpha(p_r) \\Delta \\theta)\n$$\n这完成了问题的第一部分。\n\n对于第二部分，我们必须找到使 $\\Delta \\sigma_{p_r^{\\ast}} = 0$ 的参考压力 $p_r^{\\ast}$。\n$$\n\\rho_{\\text{ref}} (\\beta(p_r^{\\ast}) \\Delta S - \\alpha(p_r^{\\ast}) \\Delta \\theta) = 0\n$$\n由于 $\\rho_{\\text{ref}}$ 是一个非零正常数，该条件简化为：\n$$\n\\beta(p_r^{\\ast}) \\Delta S = \\alpha(p_r^{\\ast}) \\Delta \\theta\n$$\n问题给出了系数对压力依赖性的线性模型：\n$$\n\\alpha(p_r) = \\alpha_0 + a p_r, \\qquad \\beta(p_r) = \\beta_0 + b p_r\n$$\n将这些表达式在 $p_r = p_r^{\\ast}$ 处代入：\n$$\n(\\beta_0 + b p_r^{\\ast}) \\Delta S = (\\alpha_0 + a p_r^{\\ast}) \\Delta \\theta\n$$\n我们求解这个关于 $p_r^{\\ast}$ 的线性方程：\n$$\n\\beta_0 \\Delta S + b p_r^{\\ast} \\Delta S = \\alpha_0 \\Delta \\theta + a p_r^{\\ast} \\Delta \\theta\n$$\n$$\np_r^{\\ast} (b \\Delta S - a \\Delta \\theta) = \\alpha_0 \\Delta \\theta - \\beta_0 \\Delta S\n$$\n$$\np_r^{\\ast} = \\frac{\\alpha_0 \\Delta \\theta - \\beta_0 \\Delta S}{b \\Delta S - a \\Delta \\theta}\n$$\n接下来，我们代入所提供的数值。首先，我们计算位温和盐度的差值：\n$$\n\\Delta \\theta = \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}} = 3.0 - 2.0 = 1.0 \\, \\text{K}\n$$\n$$\n\\Delta S = S_{\\mathcal{B}} - S_{\\mathcal{A}} = 35.05 - 34.85 = 0.20 \\, \\text{(PSS-78)}\n$$\n给定的常数是：\n$$\n\\alpha_0 = 2.1 \\times 10^{-4} \\, \\text{K}^{-1}, \\quad a = -1.0 \\times 10^{-8} \\, \\text{K}^{-1}\\,\\text{dbar}^{-1}\n$$\n$$\n\\beta_0 = 7.6 \\times 10^{-4} \\, \\text{(PSS-78)}^{-1}, \\quad b = 2.0 \\times 10^{-8} \\, \\text{(PSS-78)}^{-1}\\,\\text{dbar}^{-1}\n$$\n$p_r^{\\ast}$ 表达式的分子是：\n$$\n\\text{Numerator} = (2.1 \\times 10^{-4} \\, \\text{K}^{-1})(1.0 \\, \\text{K}) - (7.6 \\times 10^{-4} \\, \\text{(PSS-78)}^{-1})(0.20 \\, \\text{(PSS-78)})\n$$\n$$\n\\text{Numerator} = 2.1 \\times 10^{-4} - 1.52 \\times 10^{-4} = 0.58 \\times 10^{-4}\n$$\n分母是：\n$$\n\\text{Denominator} = (2.0 \\times 10^{-8} \\, \\text{(PSS-78)}^{-1}\\,\\text{dbar}^{-1})(0.20 \\, \\text{(PSS-78)}) - (-1.0 \\times 10^{-8} \\, \\text{K}^{-1}\\,\\text{dbar}^{-1})(1.0 \\, \\text{K})\n$$\n$$\n\\text{Denominator} = 0.4 \\times 10^{-8} \\, \\text{dbar}^{-1} + 1.0 \\times 10^{-8} \\, \\text{dbar}^{-1} = 1.4 \\times 10^{-8} \\, \\text{dbar}^{-1}\n$$\n最后，我们计算 $p_r^{\\ast}$ 的值：\n$$\np_r^{\\ast} = \\frac{0.58 \\times 10^{-4}}{1.4 \\times 10^{-8}} \\, \\text{dbar} = \\frac{0.58}{1.4} \\times 10^4 \\, \\text{dbar} \\approx 4142.857... \\, \\text{dbar}\n$$\n按照要求将此结果四舍五入到四位有效数字：\n$$\np_r^{\\ast} \\approx 4143 \\, \\text{dbar}\n$$",
            "answer": "$$\n\\boxed{4143}\n$$"
        }
    ]
}