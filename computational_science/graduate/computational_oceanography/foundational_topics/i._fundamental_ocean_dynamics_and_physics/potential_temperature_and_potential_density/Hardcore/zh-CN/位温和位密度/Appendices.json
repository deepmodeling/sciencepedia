{
    "hands_on_practices": [
        {
            "introduction": "势密度旨在通过将水块移动到共同的参考压力下来比较它们的浮力。然而，参考压力的选择本身并非无足轻重，尤其是在分析具有大压力范围的水体时。这项练习  将通过一个计算思想实验，展示两个水块的相对浮力如何根据所选参考压力的不同而发生逆转，揭示了“温盐压力效应”(thermobaricity) 这一关键概念。",
            "id": "3808340",
            "problem": "考虑在中纬度北大西洋内部，在相同的原位压力 $p_0$ 下测量的两个水团。水团 $\\mathcal{A}$ 的位温为 $\\theta_{\\mathcal{A}} = 2.0$（摄氏度），1978年实用盐度标准（PSS-78）的盐度为 $S_{\\mathcal{A}} = 34.85$；而水团 $\\mathcal{B}$ 的位温为 $\\theta_{\\mathcal{B}} = 3.0$（摄氏度），盐度为 $S_{\\mathcal{B}} = 35.05$。假设性质差异很小，因此可以对局部状态进行一阶线性化。\n\n参考压力为 $p_r$ 的位密，记作 $\\sigma_{p_r}$，定义为一个水团绝热地移动到压力 $p_r$ 时所具有的密度，减去一个在计算差值时会抵消的常数偏移量。在固定的参考压力下，密度对位温和盐度的依赖关系由热膨胀系数 $\\alpha$ 和盐缩系数 $\\beta$ 决定，其定义如下\n$$\n\\alpha \\equiv -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_{S,p}, \n\\qquad\n\\beta \\equiv \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{T,p},\n$$\n其中 $\\rho$ 是原位密度，$T$ 是绝对温度，$S$ 是根据 PSS-78 标准作为无量纲浓度的盐度，$p$ 是压力。对于增量，可以忽略摄氏度和开尔文之间的差异（即 $\\Delta T = \\Delta \\theta$）。\n\n在所关注的狭窄 $(S,\\theta)$ 范围内，假设在参考压力 $p_r$（单位为分巴）下评估时，系数 $\\alpha$ 和 $\\beta$ 近似地随 $p_r$ 线性变化：\n$$\n\\alpha(p_r) = \\alpha_0 + a\\,p_r, \n\\qquad\n\\beta(p_r) = \\beta_0 + b\\,p_r,\n$$\n其中常数为\n$$\n\\alpha_0 = 2.1 \\times 10^{-4} \\ \\text{K}^{-1}, \\quad a = -1.0 \\times 10^{-8} \\ \\text{K}^{-1}\\,\\text{dbar}^{-1}, \\quad\n\\beta_0 = 7.6 \\times 10^{-4} \\ \\text{(PSS-78)}^{-1}, \\quad b = 2.0 \\times 10^{-8} \\ \\text{(PSS-78)}^{-1}\\,\\text{dbar}^{-1}.\n$$\n假设在所关注的范围内，进入密度在 $p_r$ 处线性化的密度比例因子 $\\rho(p_r)$ 可以被视为相对于 $p_r$ 是一个常数（您可以取 $\\rho \\approx 1027$ $\\text{kg}\\,\\text{m}^{-3}$，但您会发现在符号计算中它会被抵消）。\n\n从上述核心定义和位温、位密的第一性原理出发，推导水团 $\\mathcal{B}$ 和 $\\mathcal{A}$ 之间依赖于参考压力的位密差 $\\Delta \\sigma_{p_r}$ 的解析表达式，该表达式用 $\\alpha(p_r)$、$\\beta(p_r)$、$\\Delta \\theta \\equiv \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}$ 和 $\\Delta S \\equiv S_{\\mathcal{B}} - S_{\\mathcal{A}}$ 来表示。然后，使用所提供的数值系数，计算出唯一的参考压力 $p_r^{\\ast}$（单位为分巴），在该压力下 $\\Delta \\sigma_{p_r}$ 的符号发生变化（即 $\\Delta \\sigma_{p_r^{\\ast}} = 0$）。将最终的 $p_r^{\\ast}$ 四舍五入到四位有效数字，并以分巴为单位表示。",
            "solution": "该问题要求两个结果：首先，是两个水团 $\\mathcal{B}$ 和 $\\mathcal{A}$ 之间位密差 $\\Delta \\sigma_{p_r}$ 的解析表达式；其次，是该差值为零时的特定参考压力 $p_r^{\\ast}$。解法是根据所提供的定义和线性近似，从第一性原理推导出来的。\n\n参考压力为 $p_r$ 的位密，记作 $\\sigma_{p_r}$，是一个水团在压力 $p_r$ 下的密度减去一个常数。由于在计算差值时常数偏移量会抵消，所以位密差 $\\Delta \\sigma_{p_r}$ 等于在参考压力 $p_r$ 下，使用各水团的位温 $(\\theta)$ 和盐度 $(S)$ 计算出的实际密度差 $\\Delta \\rho(p_r)$。\n$$\n\\Delta \\sigma_{p_r} = \\sigma_{p_r, \\mathcal{B}} - \\sigma_{p_r, \\mathcal{A}} = \\rho(\\theta_{\\mathcal{B}}, S_{\\mathcal{B}}, p_r) - \\rho(\\theta_{\\mathcal{A}}, S_{\\mathcal{A}}, p_r)\n$$\n问题陈述性质差异很小，这为密度函数 $\\rho(\\theta, S, p_r)$ 的一阶泰勒展开（线性化）提供了依据。我们可以将水团 $\\mathcal{B}$ 的密度在水团 $\\mathcal{A}$ 的状态附近展开：\n$$\n\\rho(\\theta_{\\mathcal{B}}, S_{\\mathcal{B}}, p_r) \\approx \\rho(\\theta_{\\mathcal{A}}, S_{\\mathcal{A}}, p_r) + \\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} (\\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}) + \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} (S_{\\mathcal{B}} - S_{\\mathcal{A}})\n$$\n偏导数是在一个代表性状态 $(\\theta, S)$ 和参考压力 $p_r$ 下计算的。重新整理这个近似式，得到线性化的密度差：\n$$\n\\Delta \\sigma_{p_r} \\approx \\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} \\Delta \\theta + \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} \\Delta S\n$$\n其中 $\\Delta \\theta \\equiv \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}}$ 且 $\\Delta S \\equiv S_{\\mathcal{B}} - S_{\\mathcal{A}}$。\n\n问题提供了在给定压力 $p$ 下热膨胀系数 $\\alpha$ 和盐缩系数 $\\beta$ 的定义：\n$$\n\\alpha \\equiv -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_{S,p}, \\qquad \\beta \\equiv \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{T,p}\n$$\n根据题目要求，我们将位温 $\\theta$（单位为摄氏度）的增量视为等同于绝对温度 $T$（单位为开尔文）的增量，因此我们可以用 $\\partial/\\partial \\theta$ 替换 $\\partial/\\partial T$。密度的偏导数可以用 $\\alpha(p_r)$ 和 $\\beta(p_r)$ 表示为：\n$$\n\\left(\\frac{\\partial \\rho}{\\partial \\theta}\\right)_{p_r} = -\\rho(p_r) \\alpha(p_r), \\qquad \\left(\\frac{\\partial \\rho}{\\partial S}\\right)_{p_r} = \\rho(p_r) \\beta(p_r)\n$$\n密度 $\\rho(p_r)$ 是在压力 $p_r$ 下的参考密度，这里假设它是一个常数比例因子，记为 $\\rho_{\\text{ref}}$。将这些代入 $\\Delta \\sigma_{p_r}$ 的表达式中：\n$$\n\\Delta \\sigma_{p_r} = [-\\rho_{\\text{ref}} \\alpha(p_r)] \\Delta \\theta + [\\rho_{\\text{ref}} \\beta(p_r)] \\Delta S\n$$\n将参考密度因子提出来，得到所要求的位密差的解析表达式：\n$$\n\\Delta \\sigma_{p_r} = \\rho_{\\text{ref}} (\\beta(p_r) \\Delta S - \\alpha(p_r) \\Delta \\theta)\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须找到使 $\\Delta \\sigma_{p_r^{\\ast}} = 0$ 的参考压力 $p_r^{\\ast}$。\n$$\n\\rho_{\\text{ref}} (\\beta(p_r^{\\ast}) \\Delta S - \\alpha(p_r^{\\ast}) \\Delta \\theta) = 0\n$$\n由于 $\\rho_{\\text{ref}}$ 是一个非零正常数，此条件可简化为：\n$$\n\\beta(p_r^{\\ast}) \\Delta S = \\alpha(p_r^{\\ast}) \\Delta \\theta\n$$\n问题给出了系数对压力依赖性的线性模型：\n$$\n\\alpha(p_r) = \\alpha_0 + a p_r, \\qquad \\beta(p_r) = \\beta_0 + b p_r\n$$\n将这些表达式在 $p_r = p_r^{\\ast}$ 处代入：\n$$\n(\\beta_0 + b p_r^{\\ast}) \\Delta S = (\\alpha_0 + a p_r^{\\ast}) \\Delta \\theta\n$$\n我们求解这个关于 $p_r^{\\ast}$ 的线性方程：\n$$\n\\beta_0 \\Delta S + b p_r^{\\ast} \\Delta S = \\alpha_0 \\Delta \\theta + a p_r^{\\ast} \\Delta \\theta\n$$\n$$\np_r^{\\ast} (b \\Delta S - a \\Delta \\theta) = \\alpha_0 \\Delta \\theta - \\beta_0 \\Delta S\n$$\n$$\np_r^{\\ast} = \\frac{\\alpha_0 \\Delta \\theta - \\beta_0 \\Delta S}{b \\Delta S - a \\Delta \\theta}\n$$\n接下来，我们代入所提供的数值。首先，计算位温和盐度的差值：\n$$\n\\Delta \\theta = \\theta_{\\mathcal{B}} - \\theta_{\\mathcal{A}} = 3.0 - 2.0 = 1.0 \\, \\text{K}\n$$\n$$\n\\Delta S = S_{\\mathcal{B}} - S_{\\mathcal{A}} = 35.05 - 34.85 = 0.20 \\, \\text{(PSS-78)}\n$$\n给定的常数是：\n$$\n\\alpha_0 = 2.1 \\times 10^{-4} \\, \\text{K}^{-1}, \\quad a = -1.0 \\times 10^{-8} \\, \\text{K}^{-1}\\,\\text{dbar}^{-1}\n$$\n$$\n\\beta_0 = 7.6 \\times 10^{-4} \\, \\text{(PSS-78)}^{-1}, \\quad b = 2.0 \\times 10^{-8} \\, \\text{(PSS-78)}^{-1}\\,\\text{dbar}^{-1}\n$$\n$p_r^{\\ast}$ 表达式的分子是：\n$$\n\\text{Numerator} = (2.1 \\times 10^{-4} \\, \\text{K}^{-1})(1.0 \\, \\text{K}) - (7.6 \\times 10^{-4} \\, \\text{(PSS-78)}^{-1})(0.20 \\, \\text{(PSS-78)})\n$$\n$$\n\\text{Numerator} = 2.1 \\times 10^{-4} - 1.52 \\times 10^{-4} = 0.58 \\times 10^{-4}\n$$\n分母是：\n$$\n\\text{Denominator} = (2.0 \\times 10^{-8} \\, \\text{(PSS-78)}^{-1}\\,\\text{dbar}^{-1})(0.20 \\, \\text{(PSS-78)}) - (-1.0 \\times 10^{-8} \\, \\text{K}^{-1}\\,\\text{dbar}^{-1})(1.0 \\, \\text{K})\n$$\n$$\n\\text{Denominator} = 0.4 \\times 10^{-8} \\, \\text{dbar}^{-1} + 1.0 \\times 10^{-8} \\, \\text{dbar}^{-1} = 1.4 \\times 10^{-8} \\, \\text{dbar}^{-1}\n$$\n最后，我们计算 $p_r^{\\ast}$ 的值：\n$$\np_r^{\\ast} = \\frac{0.58 \\times 10^{-4}}{1.4 \\times 10^{-8}} \\, \\text{dbar} = \\frac{5.8 \\times 10^{-5}}{1.4 \\times 10^{-8}} \\, \\text{dbar} = \\frac{5.8}{1.4} \\times 10^3 \\, \\text{dbar}\n$$\n$$\np_r^{\\ast} = \\left(\\frac{29}{7}\\right) \\times 10^3 \\, \\text{dbar} \\approx 4142.857... \\, \\text{dbar}\n$$\n按照要求将此结果四舍五入到四位有效数字：\n$$\np_r^{\\ast} \\approx 4143 \\, \\text{dbar}\n$$",
            "answer": "$$\n\\boxed{4143}\n$$"
        },
        {
            "introduction": "虽然势温 ($\\theta$) 消除了绝热压缩效应，但在混合过程中它并不守恒，因为海水的比热容是变化的。为了解决这个问题，TEOS-10 框架引入了保守温度 ($\\Theta$)，它更准确地代表了热含量。这项练习  将指导你推导和计算 $\\Theta$ 与 $\\theta$ 之间的差异，从而揭示这个现代海洋学关键变量背后的物理原理。",
            "id": "3808332",
            "problem": "要求您构建一个数值程序，在固定绝对盐度（单位：克/千克）的条件下，使用基于2010年海水热力学方程（TEOS-$10$）的物理关系，量化保守温度与位温之差随现场压力和温度的变化。设保守温度为$\\Theta$，位温为$\\theta$。目标是从第一性原理推导$\\Theta - \\theta$对压力和温度的依赖关系，并将其实现，然后为一组定义的测试用例计算结果。\n\n使用以下基本依据和模型假设，这些假设与TEOS-$10$以及计算海洋学中常用的第一性原理近似一致：\n\n- 在所有计算中，绝对盐度（TEOS-$10$使用绝对盐度）固定为 $S_A = 35 \\ \\mathrm{g\\,kg^{-1}}$。\n- 从海水的热力学第一定律和绝热运动的定义出发：熵守恒意味着随压力的绝热温度变化由绝热直减率决定。一个经过充分检验的主阶表达式将绝热温度梯度与热膨胀系数、密度和比热容联系起来：\n  $$\\gamma(T,S_A,p) \\equiv \\left(\\frac{\\partial T}{\\partial p}\\right)_{\\eta,S_A} \\approx \\frac{\\alpha(T,S_A)\\,T}{\\rho(T,S_A,p)\\,c_p(T,S_A,p)} \\ ,$$\n  其中 $\\alpha$ 是热膨胀系数，$\\rho$ 是密度，$c_p$ 是定压比热容，$T$ 是绝对温度（单位：开尔文），$p$ 是压力（单位：帕斯卡）。\n- 定义位温 $\\theta$ 为一个水块在绝热且无物质交换地移动到参考压力 $p_{\\mathrm{ref}} = 0 \\ \\mathrm{dbar}$ 时所具有的温度，即：\n  $$\\theta(T,p) = T - \\int_{0}^{p} \\gamma\\big(T,S_A,p'\\big)\\,dp' \\ ,$$\n  其中 $p$ 以分巴为单位，在积分时必须通过 $p_{\\mathrm{Pa}} = p \\times 10^4$ 转换为帕斯卡。\n- 通过参考压力下的位焓 $h^0$ 来定义保守温度 $\\Theta$：TEOS-$10$ 定义 $\\Theta$ 使得\n  $$h^0 = c_p^0\\,\\Theta + \\mathrm{constant} \\ ,$$\n  其中 $c_p^0$ 是一个标准参考比热容。为使计算易于处理，将 $c_p(T,S_A,p)$ 在一个参考温度附近近似为温度的线性函数：\n  $$c_p(T) \\approx c_p^0 \\left[1 + b_1\\,(T - T_{\\mathrm{ref}})\\right] \\ ,$$\n  其中一个小的斜率 $b_1$ 捕捉了 $c_p$ 的主要温度依赖性。设参考绝对温度为 $T_{\\mathrm{ref}} = 273.15 \\ \\mathrm{K}$。在此模型下，并忽略焓积分中 $c_p$ 微弱的压力依赖性，差值 $\\Theta - \\theta$ 源于焓中 $c_p$ 的温度依赖性，并由下式给出：\n  $$\\Theta - \\theta \\approx \\frac{1}{c_p^0}\\int_{T_{\\mathrm{ref}}}^{\\theta} c_p(T')\\,dT' \\;-\\; (\\theta - T_{\\mathrm{ref}}) = \\frac{1}{2}\\,b_1\\,\\big(\\theta - T_{\\mathrm{ref}}\\big)^2 \\ .$$\n\n对于数值实现，使用以下物理上合理的常数：\n- 参考比热容 $c_p^0 = 3991.86795711963 \\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 参考绝对温度 $T_{\\mathrm{ref}} = 273.15 \\ \\mathrm{K}$。\n- 密度 $\\rho \\approx 1027 \\ \\mathrm{kg\\,m^{-3}}$ （在主阶估算中视为常数）。\n- 热膨胀系数建模为现场摄氏温度的线性函数：$\\alpha(T_{\\mathrm{C}}) = \\alpha_0 + \\alpha_1\\,T_{\\mathrm{C}}$，其中 $\\alpha_0 = 1.5\\times 10^{-4} \\ \\mathrm{K^{-1}}$ 且 $\\alpha_1 = 3.5\\times 10^{-6} \\ \\mathrm{K^{-1}\\,^{\\circ}C^{-1}}$。\n- 比热容斜率参数 $b_1 = 1.0\\times 10^{-4} \\ \\mathrm{K^{-1}}$。\n\n程序必须：\n1. 接受下面定义的一组固定测试用例，每个用例包含现场摄氏温度和分巴压力，假设 $S_A = 35 \\ \\mathrm{g\\,kg^{-1}}$，在需要时将温度转换为开尔文，为计算绝热直减率将压力转换为帕斯卡，使用在给定现场温度下评估的常数 $\\gamma$ 的积分近似来计算 $\\theta$，然后使用上述基于焓的近似计算 $\\Theta - \\theta$。\n2. 以开尔文为单位，生成浮点数形式的最终差值，并四舍五入到六位小数。\n\n测试集（每个用例为 $(T_{\\mathrm{C}}, p_{\\mathrm{dbar}})$）：\n- 用例 1：$(25.0, 0)$。\n- 用例 2：$(25.0, 1000)$。\n- 用例 3：$(2.0, 4000)$。\n- 用例 4：$(-1.8, 0)$。\n- 用例 5：$(0.0, 6000)$。\n- 用例 6：$(10.0, 500)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\ldots\\right]$）。每个 $\\mathrm{result}_i$ 必须是 $\\Theta - \\theta$ 的值，单位为 $\\mathrm{K}$，并四舍五入到六位小数。\n\n除了编码计算过程，程序必须基于您从上述基本定律、定义和给定假设的推导。不允许使用其他外部输入。\n\n最后，在计算出数值差异后，请在您的书面解决方案中讨论这个差异在海洋的哪个区域具有动力学重要性，并解释原因，需提及使用位温与保守温度对密度和浮力的影响。该讨论是解析解的一部分，而非程序的一部分。\n\n所有角度（如果出现）必须以弧度表示；然而，此问题不涉及角度。所有物理输出必须以开尔文（$\\mathrm{K}$）表示，并四舍五入到六位小数。",
            "solution": "目标是量化在固定绝对盐度 $S_A = 35 \\ \\mathrm{g\\,kg^{-1}}$ 下，海水保守温度 $\\Theta$ 与位温 $\\theta$ 之间的差异，作为现场温度和压力的函数。推导将遵循所提供的、与 TEOS-$10$ 框架一致的近似方法。\n\n**步骤1：位温（$\\theta$）的推导与计算**\n\n位温 $\\theta$ 定义为一个流体块从其现场压力 $p$ 和温度 $T$ 绝热地移动到参考压力 $p_{\\mathrm{ref}}$ 时所达到的温度。在此问题中，$p_{\\mathrm{ref}} = 0 \\ \\mathrm{dbar}$。绝热压力变化过程中的温度变化由绝热直减率 $\\gamma$ 决定。\n\n提供的正式定义是：\n$$ \\theta(T,p) = T - \\int_{p_{\\mathrm{ref}}}^{p} \\gamma\\big(T,S_A,p'\\big)\\,dp' $$\n问题指定使用参考压力 $p_{\\mathrm{ref}} = 0$，且积分中的压力变量单位为帕斯卡。给定现场压力 $p_{\\mathrm{dbar}}$（单位：分巴），积分上限为 $p_{\\mathrm{Pa}} = p_{\\mathrm{dbar}} \\times 10^4$。\n\n绝热直减率 $\\gamma$ 由以下近似式给出：\n$$ \\gamma(T,S_A,p) \\approx \\frac{\\alpha(T,S_A)\\,T}{\\rho(T,S_A,p)\\,c_p(T,S_A,p)} $$\n其中 $T$ 是绝对温度（单位：开尔文），$\\alpha$ 是热膨胀系数，$\\rho$ 是密度，$c_p$ 是比热容。问题为这些参数提供了以下模型和常数：\n- 密度为常数：$\\rho \\approx 1027 \\ \\mathrm{kg\\,m^{-3}}$。\n- 热膨胀系数是摄氏温度（$T_C$）的线性函数：$\\alpha(T_{\\mathrm{C}}) = \\alpha_0 + \\alpha_1\\,T_{\\mathrm{C}}$，其中 $\\alpha_0 = 1.5\\times 10^{-4} \\ \\mathrm{K^{-1}}$ 且 $\\alpha_1 = 3.5\\times 10^{-6} \\ \\mathrm{K^{-1}\\,^{\\circ}C^{-1}}$。\n- $\\gamma$ 分母中的比热容 $c_p$ 可以用参考常数 $c_p^0 = 3991.86795711963 \\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 近似，这与该计算的主阶性质一致。\n\n问题要求我们通过将 $\\gamma$ 视为一个在给定现场温度和压力下评估的常数来近似 $\\theta$ 的积分。这将积分简化为一个简单的乘积：\n$$ \\int_{0}^{p_{\\mathrm{Pa}}} \\gamma(T, S_A, p') \\,dp' \\approx \\gamma(T_{\\mathrm{in-situ}}, S_A, p_{\\mathrm{in-situ}}) \\times (p_{\\mathrm{Pa}} - 0) = \\gamma \\cdot p_{\\mathrm{Pa}} $$\n因此，位温 $\\theta$（单位：开尔文）的计算公式为：\n$$ \\theta = T_K - \\left( \\frac{(\\alpha_0 + \\alpha_1 T_C) \\, T_K}{\\rho \\, c_p^0} \\right) \\cdot (p_{\\mathrm{dbar}} \\times 10^4) $$\n其中 $T_K = T_C + 273.15$ 是现场温度（单位：开尔文）。\n\n**步骤2：差值（$\\Theta - \\theta$）的推导与计算**\n\n保守温度 $\\Theta$ 由位焓 $h^0$ 通过关系式 $h^0 = c_p^0\\,\\Theta + \\text{constant}$ 定义。这个定义使得 $\\Theta$ 成为海水热含量的直接代理量，而由于 $c_p$ 对温度和压力的依赖性，位温 $\\theta$ 不具备此性质。\n\n问题提供了一个易于处理的差值 $\\Theta - \\theta$ 公式，该公式源于 $c_p$ 的温度依赖性：\n$$ \\Theta - \\theta \\approx \\frac{1}{2}\\,b_1\\,\\big(\\theta - T_{\\mathrm{ref}}\\big)^2 $$\n该公式从以下表达式推导而来：\n$$ \\Theta - \\theta \\approx \\frac{1}{c_p^0}\\int_{T_{\\mathrm{ref}}}^{\\theta} c_p(T')\\,dT' - (\\theta - T_{\\mathrm{ref}}) $$\n使用给定的 $c_p(T')$ 线性近似：\n$$ c_p(T') \\approx c_p^0 \\left[1 + b_1\\,(T' - T_{\\mathrm{ref}})\\right] $$\n其中 $b_1 = 1.0\\times 10^{-4} \\ \\mathrm{K^{-1}}$ 且 $T_{\\mathrm{ref}} = 273.15 \\ \\mathrm{K}$。将此代入积分可得：\n$$ \\int_{T_{\\mathrm{ref}}}^{\\theta} c_p^0 \\left[1 + b_1(T' - T_{\\mathrm{ref}})\\right] dT' = c_p^0 \\left[ T' + \\frac{b_1}{2}(T' - T_{\\mathrm{ref}})^2 \\right]_{T_{\\mathrm{ref}}}^{\\theta} = c_p^0 \\left( (\\theta - T_{\\mathrm{ref}}) + \\frac{b_1}{2}(\\theta - T_{\\mathrm{ref}})^2 \\right) $$\n将此结果代回 $\\Theta - \\theta$ 的表达式中：\n$$ \\Theta - \\theta \\approx \\frac{1}{c_p^0} \\left[ c_p^0 \\left( (\\theta - T_{\\mathrm{ref}}) + \\frac{b_1}{2}(\\theta - T_{\\mathrm{ref}})^2 \\right) \\right] - (\\theta - T_{\\mathrm{ref}}) $$\n$$ \\Theta - \\theta \\approx (\\theta - T_{\\mathrm{ref}}) + \\frac{b_1}{2}(\\theta - T_{\\mathrm{ref}})^2 - (\\theta - T_{\\mathrm{ref}}) = \\frac{1}{2}b_1(\\theta - T_{\\mathrm{ref}})^2 $$\n这证实了所提供的公式。因此，我们的计算算法是一个两步过程：首先，根据现场条件计算 $\\theta$；其次，使用这个 $\\theta$ 值计算差值 $\\Theta - \\theta$。\n\n**步骤3：算法总结**\n\n对于每个测试用例 $(T_C, p_{\\mathrm{dbar}})$：\n1. 将现场温度从摄氏度转换为开尔文：$T_K = T_C + 273.15$。\n2. 计算热膨胀系数：$\\alpha = \\alpha_0 + \\alpha_1 T_C$。\n3. 计算绝热直减率：$\\gamma = (\\alpha T_K) / (\\rho c_p^0)$。\n4. 将现场压力转换为帕斯卡：$p_{\\mathrm{Pa}} = p_{\\mathrm{dbar}} \\times 10^4$。\n5. 计算位温（单位：开尔文）：$\\theta = T_K - \\gamma p_{\\mathrm{Pa}}$。\n6. 计算最终差值：$\\Delta_{\\Theta\\theta} = \\frac{1}{2} b_1 (\\theta - T_{\\mathrm{ref}})^2$。\n7. 将结果四舍五入到六位小数以供输出。\n\n**关于动力学重要性的讨论**\n\n保守温度（$\\Theta$）与位温（$\\theta$）之间的差异，从根本上是衡量比热容 $c_p$ 的温度依赖性对海水热含量（焓）影响的指标。尽管数值差异 $\\Theta - \\theta$ 通常很小（在 $10^{-3}$ 到 $10^{-1} \\ \\mathrm{K}$ 的量级），但其对海洋动力学的影响是显著的，尤其是在深海以及混合和水团变性的研究中。\n\n核心问题在于，海洋的浮力和混合分别由密度和焓决定。静力稳定度由密度的垂直梯度确定。传统上，海洋学家使用位密 $\\sigma_\\theta = \\rho(S_A, \\theta, p_{\\mathrm{ref}})$ 来评估稳定度。然而，这个框架存在缺陷，因为在混合过程中 $\\theta$ 不是一个守恒量。如果将两个具有相同 $\\theta$ 但深度不同（因此现场温度和压力也不同）的水块混合，所得混合物的 $\\theta$ 并不守恒。这种非守恒行为源于状态方程的非线性以及 $c_p$ 的可变性。\n\n保守温度 $\\Theta$ 是在 TEOS-$10$ 中引入以纠正此问题的。根据定义，$\\Theta$ 与位焓成正比，而位焓是代表在混合过程中守恒的热含量的热力学正确物理量。因此，$\\Theta$ 在混合时近似呈线性关系。这使得 $\\Theta$ 成为一个更优越的变量，适用于水团分析以及热量输运和收支的建模。\n\n在深海中，使用 $\\Theta$ 相较于 $\\theta$ 的动力学重要性变得最为明显。深度超过 $2000 \\ \\mathrm{m}$ 的海水特点是高压和近冰点的温度。在这些条件下：\n1.  **稳定度计算：** 垂直层结通常非常弱。用于计算垂直密度梯度的温度变量中的一个微小误差，可能导致对静力稳定度的错误结论（即水柱是稳定、中性还是不稳定的）。在这些区域，$\\Theta - \\theta$ 的差异可能大到足以改变所计算的稳定度参数的符号。\n2.  **温盐效应（Thermobaricity）：** 这是指冷水的可压缩性大于暖水的效果。一个冷水块在绝热压缩时，其密度相对于周围环境增加的速度比暖水块更快。这个对深对流至关重要的过程，使用像 $\\Theta$ 这样基于焓的变量可以更准确地捕捉。\n3.  **热量收支：** 全球和海盆尺度的热量收支计算需要对热含量进行精确的表示。使用 $\\theta$ 会引入系统性误差，因为它不是焓的代理量。深海是地球上最大的热储库，准确量化其热含量的变化对气候科学至关重要。为此，使用 $\\Theta$ 是必不可少的。\n\n总之，差值 $\\Theta - \\theta$ 是一个修正项，它解释了热含量与位温不成线性正比这一热力学事实。这个修正在动力学上对于精确模拟深海环流、混合、稳定度以及与气候相关的热量储存至关重要。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference between Conservative Temperature and potential\n    temperature based on TEOS-10 first-principle approximations.\n    \"\"\"\n    # Define physical constants and model parameters from the problem statement.\n    SA = 35.0  # Absolute Salinity (g/kg), fixed\n    CP0 = 3991.86795711963  # Reference specific heat capacity (J kg^-1 K^-1)\n    T_REF_K = 273.15  # Reference absolute temperature (K)\n    RHO = 1027.0  # Constant density (kg m^-3)\n    ALPHA0 = 1.5e-4  # Thermal expansion coefficient parameter (K^-1)\n    ALPHA1 = 3.5e-6  # Thermal expansion coefficient parameter (K^-1 degC^-1)\n    B1 = 1.0e-4  # Specific heat capacity slope parameter (K^-1)\n\n    # Define the test suite: list of tuples (T_in-situ_C, p_in-situ_dbar)\n    test_cases = [\n        (25.0, 0),\n        (25.0, 1000),\n        (2.0, 4000),\n        (-1.8, 0),\n        (0.0, 6000),\n        (10.0, 500),\n    ]\n\n    results = []\n    for t_c, p_dbar in test_cases:\n        # Step 1: Convert in-situ temperature to Kelvin.\n        t_k = t_c + 273.15\n\n        # Step 2: Calculate the thermal expansion coefficient alpha.\n        alpha = ALPHA0 + ALPHA1 * t_c\n\n        # Step 3: Calculate the adiabatic lapse rate gamma (approximated).\n        # gamma is in K/Pa.\n        gamma = (alpha * t_k) / (RHO * CP0)\n\n        # Step 4: Convert pressure from decibars to Pascals.\n        p_pa = p_dbar * 1.0e4\n\n        # Step 5: Calculate potential temperature theta (in Kelvin) using the\n        # simplified integral, which becomes a simple product.\n        theta_k = t_k - gamma * p_pa\n\n        # Step 6: Calculate the difference between Conservative and potential temperature.\n        # The formula is Delta = 0.5 * b1 * (theta - T_ref)^2\n        # theta is in Kelvin, T_ref is in Kelvin.\n        theta_conserv_diff = 0.5 * B1 * (theta_k - T_REF_K)**2\n\n        # Step 7: Format the result to six decimal places.\n        # The f-string formatting handles rounding to the nearest value.\n        results.append(f\"{theta_conserv_diff:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "由于状态方程的非线性，海洋中存在一种称为“盐差增密”(cabbeling) 的现象，即混合两个密度相同的水块会产生一个密度更大的混合水块。这个过程是水团改造的一个重要机制。在本练习  中，你将构建一个简化的数值模型来模拟等密度面扩散，并量化由盐差增密引起的跨密度面密度变化。",
            "id": "3808267",
            "problem": "你需要构建并分析一个最小化的、科学上一致的数值实验，该实验旨在分离由作用于温度锋上的等中性面扩散引起的位势密度异常的跨等密面变化。目标是预测位势密度异常的跨等密面变化的幅度，然后实现一个程序，为一小组测试用例生成这些预测的幅度。该实验应基于以下具有物理基础的元素和约束。\n\n基本基础：\n- 使用位温，记为 $\\theta$（单位：摄氏度），和实用盐度，记为 $S$（单位：克/千克）。\n- 使用参考于海表面的位势密度异常，记为 $\\sigma_0$（单位：千克/立方米），由零参考压力下的原位密度定义为 $\\sigma_0 = \\rho - 1000$，其中 $\\rho$ 是密度（单位：千克/立方米）。\n- 将等中性面扩散表示为跨越初始中性锋面的水平方向上的小幅度混合：两个相邻的水块初始 $\\sigma_0$ 相等，但 $\\theta$ 和 $S$ 不同。扩散混合步骤将每个水块的示踪物替换为其邻居值的凸组合，权重 $m \\in [0,1]$ 与等中性面扩散率 $K_{\\mathrm{iso}}$ 相关。\n- 引入混合增密的物理原因：状态方程的非线性导致等密度端元的混合物密度超过端元密度，即使扩散沿中性方向作用，也会引起跨等密面变化。\n\n状态方程模型：\n- 实现一个简化的多项式状态方程，该方程捕捉了导致混合增密的基本非线性，同时保持计算上的易处理性：\n$$\n\\rho(\\theta,S) = \\rho_0\\left[1 - \\alpha\\left(\\theta - \\theta_{\\mathrm{ref}}\\right) + \\beta\\left(S - S_{\\mathrm{ref}}\\right)\\right] + \\rho_0\\,\\gamma\\left(\\theta - \\theta_{\\mathrm{ref}}\\right)^2,\n$$\n其中 $\\rho_0$ 是一个恒定的参考密度，$\\alpha$ 是热膨胀系数，$\\beta$ 是盐缩系数，$\\gamma$ 是一个控制非线性的小曲率系数。选择数值上合理的常数：\n- $\\rho_0 = 1027$（千克/立方米），\n- $\\alpha = 2.0\\times 10^{-4}$（每摄氏度），\n- $\\beta = 8.0\\times 10^{-4}$（每克每千克），\n- $\\gamma = -1.5\\times 10^{-5}$（每摄氏度平方），\n- $\\theta_{\\mathrm{ref}} = 10$（摄氏度），\n- $S_{\\mathrm{ref}} = 35$（克/千克）。\n$\\gamma$ 的负号使得 $\\rho$ 沿混合路径具有凹性，这与混合增密在混合时增加密度相一致。\n\n等中性面混合模型：\n- 考虑一个一维网格，在左、右端元之间有一个单一界面。仅在左侧界面单元，根据右侧邻居对 $\\theta$ 和 $S$ 执行一个显式欧拉扩散步（初始化时，左侧邻居与左侧界面单元相同），因此更新公式为\n$$\n\\theta_{\\mathrm{new}} = \\theta_{\\mathrm{L}} + r\\left(\\theta_{\\mathrm{R}} - \\theta_{\\mathrm{L}}\\right), \\quad S_{\\mathrm{new}} = S_{\\mathrm{L}} + r\\left(S_{\\mathrm{R}} - S_{\\mathrm{L}}\\right),\n$$\n其中无量纲混合分数 $r$ 来自于标准的二阶扩散离散化，\n$$\nr = \\frac{K_{\\mathrm{iso}}\\,\\Delta t}{\\Delta x^2},\n$$\n其中 $K_{\\mathrm{iso}}$ 单位为平方米/秒，$\\Delta t$ 单位为秒，$\\Delta x$ 单位为米。对于一维显式格式，稳定性要求 $r \\leq 0.5$。\n\n初始锋面构建：\n- 对于每个测试用例，将左端元的位温设置为 $\\theta_{\\mathrm{L}}$，盐度设置为 $S_{\\mathrm{L}} = 35$（克/千克）。将右端元的位温设置为 $\\theta_{\\mathrm{R}}$，并选择 $S_{\\mathrm{R}}$，使得两个端元在海表面的初始密度相等，\n$$\n\\rho\\left(\\theta_{\\mathrm{L}}, S_{\\mathrm{L}}\\right) = \\rho\\left(\\theta_{\\mathrm{R}}, S_{\\mathrm{R}}\\right).\n$$\n这强制形成一个初始中性/等密面锋。然后计算单个等中性面扩散步骤后，左侧单元的位势密度异常变化，\n$$\n\\Delta \\sigma_0 = \\left[\\rho\\left(\\theta_{\\mathrm{new}}, S_{\\mathrm{new}}\\right) - 1000\\right] - \\left[\\rho\\left(\\theta_{\\mathrm{L}}, S_{\\mathrm{L}}\\right) - 1000\\right],\n$$\n单位为千克/立方米。\n\n预测目标：\n- 从第一性原理出发，使用状态方程沿混合路径的二阶泰勒展开，推导出一个闭式预测公式，用于计算一步之后左侧界面单元由混合增密引起的跨等密面变化 $\\Delta \\sigma_0$ 的幅度。该公式应仅用 $\\rho_0$、$\\gamma$、混合分数 $r$ 和温度差 $\\Delta \\theta = \\theta_{\\mathrm{L}} - \\theta_{\\mathrm{R}}$ 表示。除所述基础外，不要假设任何预先给定的公式。最终答案以千克/立方米为单位表示。\n\n单位和数值输出：\n- 所有物理量必须使用上述指定的单位；预测的幅度 $\\Delta \\sigma_0$ 必须以千克/立方米为单位表示，并四舍五入到六位小数的浮点数。\n\n测试套件：\n对于每个元组，条目为 $(\\theta_{\\mathrm{L}}, \\theta_{\\mathrm{R}}, K_{\\mathrm{iso}}, \\Delta t, \\Delta x)$，单位为 $(\\mathrm{^{\\circ}C}, \\mathrm{^{\\circ}C}, \\mathrm{m^2/s}, \\mathrm{s}, \\mathrm{m})$：\n1. $(12,\\;8,\\;1000,\\;300,\\;1000)$：典型的梯度和中等强度的等中性面混合，预期混合增密引起的 $\\Delta \\sigma_0$ 为正。\n2. $(12,\\;8,\\;0,\\;300,\\;1000)$：零扩散率，预期 $\\Delta \\sigma_0$ 等于 $0$。\n3. $(14,\\;8,\\;1000,\\;500,\\;1000)$：更大的温度差，在 $r=0.5$ 的显式稳定性边缘。\n4. $(10.5,\\;10.0,\\;1000,\\;100,\\;1000)$：小温度差和弱混合。\n\n程序规范：\n- 实现上述内容，计算每个测试用例预测的由混合增密引起的 $\\Delta \\sigma_0$，并生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如 $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4\\right]$。",
            "solution": "需要分离的科学机制是混合增密（cabbeling）：混合两个位势密度异常 $\\sigma_0$ 相等但位温 $\\theta$ 和盐度 $S$ 不同的水体，由于海水状态方程的非线性，会产生一个位势密度异常更高的混合物。我们从基本定义和一个易于处理的非线性模型出发。\n\n首先从位温和海表面的位势密度异常开始。海表面的密度由以下模型给出：\n$$\n\\rho(\\theta,S) = \\rho_0\\Big[1 - \\alpha(\\theta - \\theta_{\\mathrm{ref}}) + \\beta(S - S_{\\mathrm{ref}})\\Big] + \\rho_0\\gamma(\\theta - \\theta_{\\mathrm{ref}})^2,\n$$\n其中 $\\rho_0$ 是一个恒定的参考密度，$\\alpha$ 是热膨胀系数，$\\beta$ 是盐缩系数，$\\gamma$ 是密度函数关于温度的曲率编码。我们使用 $\\rho_0 = 1027$，$\\alpha = 2.0\\times 10^{-4}$，$\\beta = 8.0\\times 10^{-4}$，$\\gamma = -1.5\\times 10^{-5}$，$\\theta_{\\mathrm{ref}} = 10$ 和 $S_{\\mathrm{ref}} = 35$，单位一致。位势密度异常为 $\\sigma_0 = \\rho - 1000$。\n\n为确保初始为中性锋面，我们要求端元 $(\\theta_{\\mathrm{L}}, S_{\\mathrm{L}})$ 和 $(\\theta_{\\mathrm{R}}, S_{\\mathrm{R}})$ 具有相等的密度：\n$$\n\\rho\\left(\\theta_{\\mathrm{L}}, S_{\\mathrm{L}}\\right) = \\rho\\left(\\theta_{\\mathrm{R}}, S_{\\mathrm{R}}\\right).\n$$\n解此方程得到 $S_{\\mathrm{R}}$：\n$$\nS_{\\mathrm{R}} = S_{\\mathrm{ref}} + \\frac{\\rho\\left(\\theta_{\\mathrm{L}}, S_{\\mathrm{L}}\\right) - \\rho_0\\left[1 - \\alpha\\left(\\theta_{\\mathrm{R}} - \\theta_{\\mathrm{ref}}\\right)\\right] - \\rho_0\\gamma\\left(\\theta_{\\mathrm{R}} - \\theta_{\\mathrm{ref}}\\right)^2}{\\rho_0 \\beta}.\n$$\n等中性面扩散表示为沿 $x$ 方向的单个显式欧拉步。对于左侧界面单元，其左邻居相同，右邻居不同，更新变为：\n$$\n\\theta_{\\mathrm{new}} = \\theta_{\\mathrm{L}} + r\\left(\\theta_{\\mathrm{R}} - \\theta_{\\mathrm{L}}\\right), \\quad S_{\\mathrm{new}} = S_{\\mathrm{L}} + r\\left(S_{\\mathrm{R}} - S_{\\mathrm{L}}\\right),\n$$\n其中\n$$\nr = \\frac{K_{\\mathrm{iso}}\\,\\Delta t}{\\Delta x^2}.\n$$\n左侧界面单元的位势密度异常变化为：\n$$\n\\Delta \\sigma_0 = \\Big[\\rho\\left(\\theta_{\\mathrm{new}}, S_{\\mathrm{new}}\\right) - 1000\\Big] - \\Big[\\rho\\left(\\theta_{\\mathrm{L}}, S_{\\mathrm{L}}\\right) - 1000\\Big].\n$$\n\n为了预测由混合增密产生的幅度，我们使用 $\\rho(\\theta,S)$ 沿混合路径的二阶泰勒展开来分析非线性的影响。定义混合参数 $\\lambda \\in [0,1]$，其中\n$$\n\\theta(\\lambda) = \\lambda \\theta_{\\mathrm{L}} + (1 - \\lambda)\\theta_{\\mathrm{R}}, \\quad S(\\lambda) = \\lambda S_{\\mathrm{L}} + (1 - \\lambda)S_{\\mathrm{R}}.\n$$\n对于密度相等的端元的等中性面混合，密度函数中的线性项在端点处一阶上沿弦线抵消。因此，与线性的主要偏离来自于温度的曲率，即 $\\gamma$ 项。通过计算混合物的密度与端元密度的加权平均值之间的差异，根据 Jensen 不等式和二次函数的精确代数，得到：\n$$\n\\rho\\big(\\theta(\\lambda), S(\\lambda)\\big) - \\lambda \\rho\\left(\\theta_{\\mathrm{L}}, S_{\\mathrm{L}}\\right) - (1 - \\lambda)\\rho\\left(\\theta_{\\mathrm{R}}, S_{\\mathrm{R}}\\right) = \\rho_0\\gamma \\left[\\left(\\theta(\\lambda) - \\theta_{\\mathrm{ref}}\\right)^2 - \\lambda\\left(\\theta_{\\mathrm{L}} - \\theta_{\\mathrm{ref}}\\right)^2 - (1-\\lambda)\\left(\\theta_{\\mathrm{R}} - \\theta_{\\mathrm{ref}}\\right)^2\\right].\n$$\n使用恒等式\n$$\n\\lambda a^2 + (1-\\lambda) b^2 - \\big(\\lambda a + (1-\\lambda) b\\big)^2 = \\lambda(1-\\lambda) (a - b)^2,\n$$\n我们得到\n$$\n\\rho\\big(\\theta(\\lambda), S(\\lambda)\\big) - \\lambda \\rho\\left(\\theta_{\\mathrm{L}}, S_{\\mathrm{L}}\\right) - (1 - \\lambda)\\rho\\left(\\theta_{\\mathrm{R}}, S_{\\mathrm{R}}\\right) = -\\rho_0 \\gamma\\, \\lambda(1-\\lambda)\\,\\big(\\theta_{\\mathrm{L}} - \\theta_{\\mathrm{R}}\\big)^2.\n$$\n由于端元在海表面的密度相等，端元密度的平均值等于该共同密度。因此，混合物密度与端元密度的偏离为\n$$\n\\delta \\rho_{\\mathrm{cab}}(\\lambda) = -\\rho_0 \\gamma\\, \\lambda(1-\\lambda)\\,\\big(\\Delta \\theta\\big)^2,\n$$\n其中 $\\Delta \\theta = \\theta_{\\mathrm{L}} - \\theta_{\\mathrm{R}}$。由于 $\\gamma  0$，量 $-\\gamma$ 为正，且 $\\delta \\rho_{\\mathrm{cab}}  0$，这与混合增密增加密度相符。\n\n对于左侧界面单元的离散显式扩散步，一步后的混合权重为 $(\\lambda, 1 - \\lambda) = (1 - r, r)$，因此 $\\lambda = 1 - r$。代入后得到预测的位势密度异常的跨等密面变化（单位：千克/立方米）：\n$$\n\\Delta \\sigma_0^{\\mathrm{pred}} = \\delta \\rho_{\\mathrm{cab}}(1 - r) = -\\rho_0 \\gamma\\, r(1 - r)\\, \\big(\\Delta \\theta\\big)^2.\n$$\n该预测完全用 $\\rho_0$、$\\gamma$、 $r$ 和 $\\Delta \\theta$ 表示，符合要求。由于 $\\gamma  0$，它为正值，并且在极限 $r \\to 0$ 和 $r \\to 1$ 时趋于零，在 $r = \\tfrac{1}{2}$ 时达到最大值。\n\n程序的算法设计：\n- 对于每个测试用例 $(\\theta_{\\mathrm{L}}, \\theta_{\\mathrm{R}}, K_{\\mathrm{iso}}, \\Delta t, \\Delta x)$，计算 $r = K_{\\mathrm{iso}}\\,\\Delta t / \\Delta x^2$。\n- 计算 $\\Delta \\theta = \\theta_{\\mathrm{L}} - \\theta_{\\mathrm{R}}$。\n- 使用以下公式评估预测的由混合增密引起的跨等密面变化：\n$$\n\\Delta \\sigma_0^{\\mathrm{pred}} = -\\rho_0 \\gamma\\, r(1 - r)\\, \\big(\\Delta \\theta\\big)^2,\n$$\n单位为千克/立方米。\n- 将每个结果四舍五入到六位小数，并以指定的单行格式输出列表。\n\n该设计直接与基础物理联系：位温和位势密度异常的定义、作为 $\\theta$ 和 $S$ 中沿中性面的守恒操作的等中性面混合，以及由状态方程曲率（由 $\\gamma$ 量化）产生的混合增密。离散权重 $r$ 将连续的扩散率 $K_{\\mathrm{iso}}$ 映射到单步混合分数，而预测则遵循二阶展开原理，不依赖于所述基础之外的捷径公式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Physical and model constants (units noted in comments)\n    rho0 = 1027.0          # kg/m^3\n    alpha = 2.0e-4         # 1/degC\n    beta = 8.0e-4          # 1/(g/kg)\n    gamma = -1.5e-5        # 1/(degC^2) curvature coefficient\n    theta_ref = 10.0       # degC\n    S_ref = 35.0           # g/kg\n\n    # Test cases: (theta_L [degC], theta_R [degC], K_iso [m^2/s], dt [s], dx [m])\n    test_cases = [\n        (12.0, 8.0, 1000.0, 300.0, 1000.0),   # happy path\n        (12.0, 8.0, 0.0,    300.0, 1000.0),   # zero diffusivity\n        (14.0, 8.0, 1000.0, 500.0, 1000.0),   # boundary r=0.5 with larger delta theta\n        (10.5,10.0,1000.0,  100.0, 1000.0),   # small temperature contrast\n    ]\n\n    def rho(theta, S):\n        # Simplified polynomial EOS for density at surface pressure\n        return rho0 * (1.0 - alpha * (theta - theta_ref) + beta * (S - S_ref)) + rho0 * gamma * (theta - theta_ref) ** 2\n\n    results = []\n\n    for theta_L, theta_R, K_iso, dt, dx in test_cases:\n        # Left salinity is set to reference typical ocean value\n        S_L = 35.0\n\n        # Compute target equal density for left endmember\n        rho_left = rho(theta_L, S_L)\n\n        # Solve for S_R such that rho(theta_R, S_R) == rho_left\n        # rho_left = rho0*(1 - alpha*(theta_R - theta_ref) + beta*(S_R - S_ref)) + rho0*gamma*(theta_R - theta_ref)^2\n        # = beta*rho0*(S_R - S_ref) = rho_left - rho0*(1 - alpha*(dtheta_R)) - rho0*gamma*(dtheta_R)^2\n        dtheta_R = theta_R - theta_ref\n        S_R = S_ref + (rho_left - rho0 * (1.0 - alpha * dtheta_R) - rho0 * gamma * dtheta_R ** 2) / (rho0 * beta)\n\n        # Mixing fraction r from explicit diffusion CFL\n        r = (K_iso * dt) / (dx ** 2)\n\n        # Clamp r to [0, 1] for robustness (though stability demands r = 0.5)\n        if r  0.0:\n            r = 0.0\n        # We allow r up to 0.5 as per the stated scheme; any larger would be unstable.\n        if r > 0.5:\n            r = 0.5\n\n        # Predicted cabbeling-induced diapycnal change in sigma0 after one step:\n        # Delta_sigma0_pred = -rho0 * gamma * r * (1 - r) * (Delta_theta)^2\n        delta_theta = theta_L - theta_R\n        delta_sigma0_pred = -rho0 * gamma * r * (1.0 - r) * (delta_theta ** 2)\n\n        # Round to six decimal places\n        results.append(f\"{delta_sigma0_pred:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}