{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你从地转平衡和静力平衡这两个基本动力学关系出发，亲手推导出热成风方程。这个过程不仅能加深你对理论基础的理解，还能让你学会如何运用该关系，并结合海洋中典型的参数值，来定量估算洋流的垂直切变。这是掌握热成风平衡概念的基石。",
            "id": "3816946",
            "problem": "假设一个稳定层化的 Boussinesq 海洋位于 $f$ 平面上，处于大尺度、定常、无粘流动中，该流动满足水平地转平衡和垂直静力平衡。仅从这些基本平衡关系和 Brunt–Väisälä 频率的定义出发，推导连接地转速度沿 $x$ 分量的垂直导数与经向密度梯度的关系。然后，利用该关系，根据以下参数估算垂直地转切变的大小，以及在 $500\\ \\text{m}$ 的垂直距离上，地转速度沿 $x$ 分量的相应速度差的大小：\n- 科里奥利参数 $f = 10^{-4}\\ \\text{s}^{-1}$，\n- 重力加速度 $g = 9.81\\ \\text{m s}^{-2}$，\n- Brunt–Väisälä 频率 $N = 10^{-3}\\ \\text{s}^{-1}$，\n- 经向密度梯度 $\\partial \\rho/\\partial y = 10^{-4}\\ \\text{kg m}^{-4}$，\n- 参考密度 $\\rho_0 = 1025\\ \\text{kg m}^{-3}$。\n\n将 $f$、$g$ 和 $\\rho_0$ 视为不随深度变化的常数。清楚地说明所有符号约定并计算其大小。\n\n将最终答案表示为 $500\\ \\text{m}$ 垂直距离上的地转速度差的大小，单位为米/秒，并四舍五入至三位有效数字。不要在最终的方框答案中包含单位。",
            "solution": "该问题要求推导热成风关系，并应用该关系估算地转速度差。我们首先建立物理框架和坐标系。我们采用一个标准的笛卡尔坐标系，其中 $x$ 指向纬向（东向），$y$ 指向经向（北向），$z$ 指向垂直向上。科里奥利参数 $f$ 是一个给定的正常数，$f = 10^{-4}\\ \\text{s}^{-1}$，这适用于北半球。\n\n假设流动在 Boussinesq 流体内处于大尺度、定常、无粘、地转和静力平衡状态。描述该状态的控制方程为：\n\n1.  **水平地转平衡**：气压梯度力与科里奥利力相平衡。对于速度的纬向分量 $u_g$，这表示为：\n    $$f u_g = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y}$$\n    其中 $p$ 是压力，$\\rho_0$ 是恒定的参考密度。\n\n2.  **垂直静力平衡**：垂直气压梯度与重力相平衡：\n    $$\\frac{\\partial p}{\\partial z} = -\\rho g$$\n    其中 $\\rho$ 是总密度，$g$ 是重力加速度。\n\n主要任务是推导热成风关系，它将地转速度的垂直切变（$\\partial u_g/\\partial z$）与水平密度梯度（$\\partial \\rho/\\partial y$）联系起来。我们从纬向地转平衡方程开始：\n$$f u_g = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y}$$\n然后，我们对该方程关于垂直坐标 $z$ 求偏导数。按照规定将 $f$ 和 $\\rho_0$ 视为常数，我们得到：\n$$f \\frac{\\partial u_g}{\\partial z} = -\\frac{1}{\\rho_0} \\frac{\\partial}{\\partial z}\\left(\\frac{\\partial p}{\\partial y}\\right)$$\n假设压力场 $p(y, z)$ 是二阶连续可微的，我们可以交换偏导数的顺序（根据关于混合偏导数相等的 Clairaut's theorem）：\n$$f \\frac{\\partial u_g}{\\partial z} = -\\frac{1}{\\rho_0} \\frac{\\partial}{\\partial y}\\left(\\frac{\\partial p}{\\partial z}\\right)$$\n接下来，我们将静力平衡关系 $\\frac{\\partial p}{\\partial z} = -\\rho g$ 代入方程的右边：\n$$f \\frac{\\partial u_g}{\\partial z} = -\\frac{1}{\\rho_0} \\frac{\\partial}{\\partial y}(-\\rho g)$$\n由于假定重力加速度 $g$ 是常数，我们可以将其移到导数之外：\n$$f \\frac{\\partial u_g}{\\partial z} = \\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial y}$$\n最后，我们求解垂直地转切变 $\\frac{\\partial u_g}{\\partial z}$：\n$$\\frac{\\partial u_g}{\\partial z} = \\frac{g}{f \\rho_0} \\frac{\\partial \\rho}{\\partial y}$$\n这就是地转速度纬向分量的热成风关系。它直接源于地转平衡和静力平衡。尽管问题陈述中提到从 Brunt–Väisälä 频率 $N$ 的定义出发，但该量并未出现在此关系的常规推导中。所提供的 $N$ 值是层结的度量，是该物理机制的必要条件，但对于所要求的具体计算而言并非必需。\n\n现在我们可以使用给定的参数计算垂直地转切变的大小：\n- $g = 9.81\\ \\text{m s}^{-2}$\n- $f = 10^{-4}\\ \\text{s}^{-1}$\n- $\\rho_0 = 1025\\ \\text{kg m}^{-3}$\n- $\\frac{\\partial \\rho}{\\partial y} = 10^{-4}\\ \\text{kg m}^{-4}$\n\n将这些值代入热成风关系：\n$$\\frac{\\partial u_g}{\\partial z} = \\frac{(9.81\\ \\text{m s}^{-2})}{(10^{-4}\\ \\text{s}^{-1}) (1025\\ \\text{kg m}^{-3})} (10^{-4}\\ \\text{kg m}^{-4})$$\n$$\\frac{\\partial u_g}{\\partial z} = \\frac{9.81 \\cdot 10^{-4}}{1025 \\cdot 10^{-4}}\\ \\text{s}^{-1} = \\frac{9.81}{1025}\\ \\text{s}^{-1} \\approx 0.0095707\\ \\text{s}^{-1}$$\n垂直地转切变的大小约为 $9.57 \\times 10^{-3}\\ \\text{s}^{-1}$。\n\n最后一步是估算在 $\\Delta z = 500\\ \\text{m}$ 的垂直距离上，沿 $x$ 方向的地转速度差 $\\Delta u_g$ 的大小。假设切变 $\\frac{\\partial u_g}{\\partial z}$ 在此深度范围内是恒定的，我们可以将速度差近似为：\n$$\\Delta u_g \\approx \\frac{\\partial u_g}{\\partial z} \\Delta z$$\n由于我们关心的是大小，并且所有量都为正：\n$$|\\Delta u_g| \\approx \\left| \\frac{9.81}{1025}\\ \\text{s}^{-1} \\right| \\times 500\\ \\text{m}$$\n$$|\\Delta u_g| \\approx (0.0095707\\ \\text{s}^{-1}) \\times 500\\ \\text{m} \\approx 4.785365\\ \\text{m s}^{-1}$$\n按照要求将结果四舍五入到三位有效数字，我们得到速度差的大小。\n$$|\\Delta u_g| \\approx 4.79\\ \\text{m s}^{-1}$$",
            "answer": "$$\\boxed{4.79}$$"
        },
        {
            "introduction": "任何物理模型都有其适用范围。本练习旨在培养你的批判性思维，通过探讨当科里奥利参数 $f$ 在赤道附近趋近于零时，热成风平衡为何会失效。通过计算罗斯贝数（Rossby number），你将能够诊断地转假设失效的原因，并深刻体会到理解模型适用范围的重要性。",
            "id": "3816993",
            "problem": "考虑一个大尺度的、稳定的、层结的海洋，其中 Boussinesq 近似、静力平衡和地转平衡均成立。水平地转动量平衡可以写为 $f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}_g = -\\frac{1}{\\rho_0}\\nabla_h p$，静力平衡可以写为 $\\frac{\\partial p}{\\partial z} = - g\\,\\rho$，其中 $f$ 是科里奥利参数，$\\boldsymbol{u}_g$ 是地转流速，$\\rho_0$ 是一个常数参考密度，$p$ 是压力，$g$ 是重力加速度，$\\rho$ 是原位密度。取 $f = 2\\,\\Omega\\,\\sin\\phi$，其中 $\\Omega$ 是地球自转速率，$\\phi$ 是纬度。要求您根据网格化的水文数据诊断纬向地转流速的垂直切变。\n\n假设在一个水平长度尺度 $L = 10^5\\,\\mathrm{m}$ 上，存在一个准均匀的经向密度梯度，其大小为 $\\left|\\frac{\\partial \\rho}{\\partial y}\\right| = 5\\times 10^{-6}\\,\\mathrm{kg\\,m^{-4}}$，并且 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$\\rho_0 = 1025\\,\\mathrm{kg\\,m^{-3}}$，以及 $\\Omega = 7.292\\times 10^{-5}\\,\\mathrm{s^{-1}}$。从上述平衡关系出发，并且不使用任何快捷公式，推导纬向地转流速 $u_g(z)$ 的垂直切变与经向密度梯度的关系式，并用它来估计在纬度 $\\phi = 10^{\\circ}$ 和 $\\phi = 1^{\\circ}$ 处的垂直切变大小 $\\left|\\frac{\\partial u_g}{\\partial z}\\right|$。然后，使用典型的速度尺度 $U = 0.5\\,\\mathrm{m\\,s^{-1}}$ 和相同的长度尺度 $L$，评估罗斯贝数 ($\\text{Ro}$) 在这两个纬度之间如何变化，并讨论该推导在赤道极限情况下的物理有效性。\n\n哪个选项最能描述当赤道附近 $f\\to 0$ 时诊断出的切变的标度关系、上述两个纬度对应的数值估计，以及当罗斯贝数增加时其基本假设失效的原因？\n\nA. 对于固定的水平密度梯度，地转垂直切变与 $f$ 成反比，因此随着纬度的降低而变大；使用给定参数，在 $\\phi=10^{\\circ}$ 时其值约为 $1.9\\times 10^{-3}\\,\\mathrm{s^{-1}}$，在 $\\phi=1^{\\circ}$ 时约为 $1.9\\times 10^{-2}\\,\\mathrm{s^{-1}}$。随着 $f$ 的减小，罗斯贝数增加，并可能接近或超过1，这使得非地转项变得不可忽略，并导致地转-静力推导在赤道附近失效。\n\nB. 对于固定的水平密度梯度，地转垂直切变与纬度无关；随着纬度的降低，罗斯贝数减小，因此地转-静力假设在赤道附近变得越来越有效。\n\nC. 无论纬度如何，地转垂直切变都受浮力频率的限制；推导在赤道附近的失效主要是由于当 $f$ 很小时静力近似的失败。\n\nD. 随着纬度的降低，地转垂直切变有所增加但保持适中，因为 $\\beta$ 平面使 $f\\to 0$ 的极限正则化；尽管 $f$ 很小，罗斯贝数仍然很小，因此地转-静力假设在赤道及其附近仍然有效。",
            "solution": "问题陈述提供了 Boussinesq 海洋中大尺度、稳定、地转和静力流动的控制方程。该问题具有科学依据，提法恰当，并且所有给定参数都符合物理实际。因此，我们可以进行推导和分析。\n\n出发点是水平地转动量平衡和静力平衡。\n地转平衡由下式给出：\n$$f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}_g = -\\frac{1}{\\rho_0}\\nabla_h p$$\n其中 $\\boldsymbol{u}_g = u_g \\hat{\\boldsymbol{i}} + v_g \\hat{\\boldsymbol{j}}$ 是地转流速矢量，$f$ 是科里奥利参数，$\\rho_0$ 是一个常数参考密度，$\\nabla_h p$ 是水平压力梯度。以分量形式表示，该平衡为：\n$$f v_g = \\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x}$$\n$$-f u_g = \\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y} \\implies u_g = -\\frac{1}{f \\rho_0} \\frac{\\partial p}{\\partial y}$$\n\n静力平衡由下式给出：\n$$\\frac{\\partial p}{\\partial z} = - g\\,\\rho$$\n其中 $g$ 是重力加速度，$\\rho$ 是原位密度。\n\n为了求出纬向地转流速的垂直切变 $\\frac{\\partial u_g}{\\partial z}$，我们将 $u_g$ 的表达式对垂直坐标 $z$ 求导：\n$$\\frac{\\partial u_g}{\\partial z} = \\frac{\\partial}{\\partial z} \\left( -\\frac{1}{f \\rho_0} \\frac{\\partial p}{\\partial y} \\right)$$\n假设 $f$ 和 $\\rho_0$ 与 $z$ 无关（这是推导局地热成风平衡的一个标准假设），我们可以交换偏导数的顺序：\n$$\\frac{\\partial u_g}{\\partial z} = -\\frac{1}{f \\rho_0} \\frac{\\partial}{\\partial y} \\left( \\frac{\\partial p}{\\partial z} \\right)$$\n现在，我们将静力平衡代入此方程：\n$$\\frac{\\partial u_g}{\\partial z} = -\\frac{1}{f \\rho_0} \\frac{\\partial}{\\partial y} (-g \\rho)$$\n假设 $g$ 是常数，我们得到纬向速度的热成风关系：\n$$\\frac{\\partial u_g}{\\partial z} = \\frac{g}{f \\rho_0} \\frac{\\partial \\rho}{\\partial y}$$\n该方程表明，纬向地转流速的垂直切变与经向密度梯度成正比，与科里奥利参数 $f$ 成反比。当接近赤道时，$\\phi \\to 0$，这意味着 $f = 2\\Omega\\sin\\phi \\to 0$。对于一个非零的经向密度梯度 $\\frac{\\partial \\rho}{\\partial y}$，该关系预测切变 $\\frac{\\partial u_g}{\\partial z}$ 将变得无限大。\n\n接下来，我们使用所提供的数据来估计在指定纬度处的切变大小 $\\left|\\frac{\\partial u_g}{\\partial z}\\right|$：\n$g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n$\\rho_0 = 1025\\,\\mathrm{kg\\,m^{-3}}$\n$\\left|\\frac{\\partial \\rho}{\\partial y}\\right| = 5\\times 10^{-6}\\,\\mathrm{kg\\,m^{-4}}$\n$\\Omega = 7.292\\times 10^{-5}\\,\\mathrm{s^{-1}}$\n其大小由下式给出：\n$$\\left|\\frac{\\partial u_g}{\\partial z}\\right| = \\frac{g}{|f| \\rho_0} \\left|\\frac{\\partial \\rho}{\\partial y}\\right|$$\n\n在纬度 $\\phi = 10^{\\circ}$ 处：\n科里奥利参数为 $f_{10} = 2\\,\\Omega\\,\\sin(10^{\\circ}) \\approx 2 \\times (7.292\\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times 0.1736 \\approx 2.532\\times 10^{-5}\\,\\mathrm{s^{-1}}$。\n切变大小为：\n$$\\left|\\frac{\\partial u_g}{\\partial z}\\right|_{10^{\\circ}} = \\frac{(9.81\\,\\mathrm{m\\,s^{-2}})}{(2.532\\times 10^{-5}\\,\\mathrm{s^{-1}}) (1025\\,\\mathrm{kg\\,m^{-3}})} (5\\times 10^{-6}\\,\\mathrm{kg\\,m^{-4}}) \\approx 1.89\\times 10^{-3}\\,\\mathrm{s^{-1}}$$\n\n在纬度 $\\phi = 1^{\\circ}$ 处：\n科里奥利参数为 $f_1 = 2\\,\\Omega\\,\\sin(1^{\\circ}) \\approx 2 \\times (7.292\\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times 0.01745 \\approx 2.545\\times 10^{-6}\\,\\mathrm{s^{-1}}$。\n切变大小为：\n$$\\left|\\frac{\\partial u_g}{\\partial z}\\right|_{1^{\\circ}} = \\frac{(9.81\\,\\mathrm{m\\,s^{-2}})}{(2.545\\times 10^{-6}\\,\\mathrm{s^{-1}}) (1025\\,\\mathrm{kg\\,m^{-3}})} (5\\times 10^{-6}\\,\\mathrm{kg\\,m^{-4}}) \\approx 1.88\\times 10^{-2}\\,\\mathrm{s^{-1}}$$\n数值估计值在 $\\phi=10^{\\circ}$ 时约为 $1.9\\times 10^{-3}\\,\\mathrm{s^{-1}}$，在 $\\phi=1^{\\circ}$ 时约为 $1.9\\times 10^{-2}\\,\\mathrm{s^{-1}}$。\n\n最后，我们评估罗斯贝数 $\\text{Ro}$，它衡量惯性力与科里奥利力的比值。一个常见的尺度定义是 $\\text{Ro} = \\frac{U}{fL}$，其中 $U$ 是特征速度，$L$ 是特征长度尺度。当地转平衡有效时，$\\text{Ro} \\ll 1$。\n使用给定的尺度 $U = 0.5\\,\\mathrm{m\\,s^{-1}}$ 和 $L = 10^5\\,\\mathrm{m}$：\n\n在纬度 $\\phi = 10^{\\circ}$ 处：\n$$\\text{Ro}_{10} = \\frac{U}{f_{10}L} = \\frac{0.5\\,\\mathrm{m\\,s^{-1}}}{(2.532\\times 10^{-5}\\,\\mathrm{s^{-1}}) (10^5\\,\\mathrm{m})} \\approx \\frac{0.5}{2.532} \\approx 0.198$$\n在这里，$\\text{Ro}$ 很小，因此地转近似是合理的。\n\n在纬度 $\\phi = 1^{\\circ}$ 处：\n$$\\text{Ro}_{1} = \\frac{U}{f_{1}L} = \\frac{0.5\\,\\mathrm{m\\,s^{-1}}}{(2.545\\times 10^{-6}\\,\\mathrm{s^{-1}}) (10^5\\,\\mathrm{m})} \\approx \\frac{0.5}{0.2545} \\approx 1.96$$\n在这里，罗斯贝数约为2，这个值不小。这表明动量方程中的惯性项（平流）大于科里奥利项。因此，地转平衡近似无效。热成风关系是从地转平衡推导出来的，因此也无效。在赤道处出现无限大切变的非物​​理预测，是地转基本假设失效的直接后果。被忽略的非地转项变得占主导地位，必须被包含进来才能正确描述赤道附近的动力学。\n\n现在我们评估给定的选项：\n\nA. 对于固定的水平密度梯度，地转垂直切变与 $f$ 成反比，因此随着纬度的降低而变大；使用给定参数，在 $\\phi=10^{\\circ}$ 时其值约为 $1.9\\times 10^{-3}\\,\\mathrm{s^{-1}}$，在 $\\phi=1^{\\circ}$ 时约为 $1.9\\times 10^{-2}\\,\\mathrm{s^{-1}}$。随着 $f$ 的减小，罗斯贝数增加，并可能接近或超过1，这使得非地转项变得不可忽略，并导致地转-静力推导在赤道附近失效。\n这个陈述与我们的推导和分析完全一致。与 $f$ 的标度关系是正确的，数值估计是准确的，罗斯贝数的行为被正确描述，并且近似失效的原因（由于大的 $\\text{Ro}$ 导致地转平衡失效）也被正确地指出了。因此，该选项是**正确的**。\n\nB. 对于固定的水平密度梯度，地转垂直切变与纬度无关；随着纬度的降低，罗斯贝数减小，因此地转-静力假设在赤道附近变得越来越有效。\n这个陈述在多个方面都是不正确的。切变与依赖于纬度的 $f$ 成反比。罗斯贝数随着纬度的降低而增加，而不是减小。假设变得无效，而不是更有效。因此，该选项是**不正确的**。\n\nC. 无论纬度如何，地转垂直切变都受浮力频率的限制；推导在赤道附近的失效主要是由于当 $f$ 很小时静力近似的失败。\n热成风关系本身预测当 $f \\to 0$ 时切变是无界的。虽然其他物理过程（例如，与理查森数 $Ri = N^2/(\\partial u/\\partial z)^2$ 相关的切变不稳定性）可能会限制切变，但地转关系本身不包含这个界限。更重要的是，失效的主要原因是地转平衡的失败（大的 $\\text{Ro}$），而不是静力近似的失败，后者对于大尺度运动通常即使在赤道也成立。因此，该选项是**不正确的**。\n\nD. 随着纬度的降低，地转垂直切变有所增加但保持适中，因为 $\\beta$ 平面使 $f\\to 0$ 的极限正则化；尽管 $f$ 很小，罗斯贝数仍然很小，因此地转-静力假设在赤道及其附近仍然有效。\n这个陈述是不正确的。标准的热成风关系在 $f=0$ 处不会“正则化”；它会变得奇异。虽然需要一个更完整的赤道理论（包含 $\\beta$ 效应，$\\beta = \\frac{df}{dy}$）来正确处理动力学，但这并不能阻止地转平衡本身的失效。罗斯贝数并不会保持很小；我们的计算表明它变得很大。因此，假设仍然有效的结论是错误的。该选项是**不正确的**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "本练习将理论与实际应用相结合，指导你设计一个完整的计算流程，从三维的温度和盐度场数据中计算出地转流的垂直切变。你将学习如何以数值方式实现热成风方程，并采用基于TEOS-10海水状态方程的物理一致性方法。这项练习旨在锻炼你作为一名计算海洋学家所必需的核心编程与数据处理技能。",
            "id": "3816979",
            "problem": "给定水平变化的三维绝对盐度 $S_A(x,y,z)$ (单位 $\\mathrm{g}\\,\\mathrm{kg}^{-1}$) 和保守温度 $\\Theta(x,y,z)$ (单位 $\\mathrm{^\\circ C}$) 场，它们位于恒定纬度 $\\phi$ (单位 $\\mathrm{degrees}$) 的均匀直线网格上。从一个有效的物理基础出发，设计并实现一个计算流程，该流程计算物理上一致的海水密度场 $\\rho(x,y,z)$，然后评估由旋转、层结和静水压力平衡所蕴含的垂直地转切变。您的流程必须明确且一致地使用海水热力学方程 (TEOS-10) 的导数结构，而不是对可能带有噪声的 $\\rho(x,y,z)$ 场进行数值微分。推导必须从旋转坐标系下的动量方程和静水近似开始，并逻辑地推导出垂直切变和水平密度梯度之间的热成风关系。您的算法必须使用国际单位制 (SI) 表示所有量，并清楚地说明所做的假设和近似。\n\n使用以下科学合理且被广泛接受的基础：\n- 在海洋中，稳定、无粘、大尺度条件下的旋转坐标系动量方程允许水平地转平衡，而垂直动量允许静水平衡。\n- Boussinesq近似适用于大尺度海洋流动。\n- 保守和绝对热力学变量遵循 TEOS-10，其导数结构可以在参考条件附近进行线性化。\n\n您必须在以下条件和参数下实现该流程：\n- 设网格为均匀的，有 $N_x=32$、$N_y=32$、$N_z=40$ 个点，间距为 $d_x=d_y=10^4\\,\\mathrm{m}$ 和 $d_z=50\\,\\mathrm{m}$，其中 $x$ 指向东，$y$ 指向北，$z$ 向下为正。\n- 使用参考密度 $\\rho_0=1027\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，重力加速度 $g=9.80665\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，以及地球自转速率 $\\Omega=7.292115\\times 10^{-5}\\,\\mathrm{s}^{-1}$。科里奥利参数为 $f=2\\Omega\\sin(\\phi_\\mathrm{rad})$，其中 $\\phi_\\mathrm{rad}$ 是以 $\\mathrm{radians}$ 为单位的纬度。\n- 压力通过静水近似为 $p(z)=\\rho_0 g z$ (单位 $\\mathrm{Pa}$)，并假设自由表面是平的 ($\\nabla_h p=0$)。\n- 在参考条件 $(S_{\\mathrm{ref}},\\Theta_{\\mathrm{ref}},p_{\\mathrm{ref}})$ 处，使用常数系数对 TEOS-10 状态方程的导数进行线性化：热膨胀系数 $\\alpha=2.0\\times 10^{-4}\\,\\mathrm{K}^{-1}$，盐缩系数 $\\beta=7.6\\times 10^{-4}\\,(\\mathrm{g}\\,\\mathrm{kg}^{-1})^{-1}$，以及一个代表性的绝热压缩率 $\\gamma=4.5\\times 10^{-10}\\,\\mathrm{Pa}^{-1}$。使用 $(S_{\\mathrm{ref}},\\Theta_{\\mathrm{ref}},p_{\\mathrm{ref}})=(35\\,\\mathrm{g}\\,\\mathrm{kg}^{-1},10\\,\\mathrm{^\\circ C},0\\,\\mathrm{Pa})$。\n- 密度计算公式为 $\\rho(x,y,z)=\\rho_0\\left[1-\\alpha\\left(\\Theta(x,y,z)-\\Theta_{\\mathrm{ref}}\\right)+\\beta\\left(S_A(x,y,z)-S_{\\mathrm{ref}}\\right)+\\gamma\\left(p(z)-p_{\\mathrm{ref}}\\right)\\right]$，并且通过 TEOS-10 的导数（链式法则）计算水平密度梯度，而不是通过直接对 $\\rho$ 进行差分：$\\nabla_h \\rho=\\rho_0\\left[\\beta\\,\\nabla_h S_A-\\alpha\\,\\nabla_h \\Theta\\right]$，因为根据假设 $\\nabla_h p=0$。\n- 使用您推导出的关系评估大尺度平衡所蕴含的垂直地转切变。\n\n您的程序必须在内部实现二阶精度的中心有限差分来计算水平梯度，正确处理矢量值的切变，并如下文所述从三维数组中汇总一个标量度量。角度在内部必须以 $\\mathrm{radians}$ 为单位处理。\n\n设计一个测试套件，涵盖一般情况、近赤道小 $f$ 值情况、零水平梯度情况和强盐锋情况。对于每种情况，使用归一化坐标 $\\xi=x/L_x$、$\\eta=y/L_y$ 和 $\\zeta=z/L_z$（其中 $L_x=N_x d_x$、$L_y=N_y d_y$ 和 $L_z=N_z d_z$），从解析的、网格分辨的模式构建 $S_A(x,y,z)$ 和 $\\Theta(x,y,z)$，确保物理真实性和自洽性：\n\n- 情况A（中纬度层结，同时存在盐度和温度梯度）：纬度 $\\phi=45\\,\\mathrm{degrees}$，$S_A(x,y,z)=S_{\\mathrm{ref}}+0.008\\,\\xi+0.012\\,\\eta+0.002\\,\\zeta$，$\\Theta(x,y,z)=\\Theta_{\\mathrm{ref}}+0.15\\,\\xi+0.05\\,\\eta-1.5\\,\\zeta$。\n- 情况B（近赤道小 $f$ 值）：纬度 $\\phi=1\\,\\mathrm{degree}$，$S_A(x,y,z)=S_{\\mathrm{ref}}+0.000\\,\\xi+0.010\\,\\eta+0.002\\,\\zeta$，$\\Theta(x,y,z)=\\Theta_{\\mathrm{ref}}+0.20\\,\\xi+0.000\\,\\eta-0.5\\,\\zeta$。\n- 情况C（无水平梯度）：纬度 $\\phi=30\\,\\mathrm{degrees}$，$S_A(x,y,z)=S_{\\mathrm{ref}}+0.000\\,\\xi+0.000\\,\\eta+0.002\\,\\zeta$，$\\Theta(x,y,z)=\\Theta_{\\mathrm{ref}}+0.000\\,\\xi+0.000\\,\\eta-0.5\\,\\zeta$。\n- 情况D（强盐锋，伴有混合温度梯度）：纬度 $\\phi=60\\,\\mathrm{degrees}$，$S_A(x,y,z)=S_{\\mathrm{ref}}+0.000\\,\\xi+0.030\\,\\eta+0.001\\,\\zeta$，$\\Theta(x,y,z)=\\Theta_{\\mathrm{ref}}+0.050\\,\\xi+0.050\\,\\eta-0.2\\,\\zeta$。\n\n对于每种情况，计算每个网格点上垂直地转切变矢量的大小，定义为 $\\left\\|\\partial \\mathbf{u}_g / \\partial z\\right\\|=\\sqrt{\\left(\\partial u_g/\\partial z\\right)^2+\\left(\\partial v_g/\\partial z\\right)^2}$，并为每种情况返回一个标量，该标量等于整个三维网格上的算术平均值。返回的标量以 $\\mathrm{s}^{-1}$ 为单位，表示为四舍五入到 $6$ 位小数的十进制浮点数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4\\right]$）。",
            "solution": "该问题要求设计并实现一个计算流程，用于根据三维的绝对盐度 $S_A(x,y,z)$ 和保守温度 $\\Theta(x,y,z)$ 场计算垂直地转切变。该解决方案基于地球物理流体动力学原理，特别是热成风平衡，该平衡源于层结旋转流体中的地转和静水均衡。\n\n### 步骤 1：热成风方程的理论推导\n\n推导从旋转参考系中稳定、无粘性、Boussinesq近似下的水平动量方程开始，其中地转平衡成立。坐标系定义为 $x$ 指向东（纬向），$y$ 指向北（经向），$z$ 向下为正。地转速度分量 $u_g$（纬向）和 $v_g$（经向）与压力 $p$ 的关系如下：\n$$ -f v_g = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x} \\quad (1) $$\n$$ f u_g = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y} \\quad (2) $$\n这里，$f=2\\Omega\\sin(\\phi)$ 是纬度 $\\phi$ 处的科里奥利参数（$\\Omega$ 是地球自转速率），$\\rho_0$ 是一个常数参考密度。\n\n垂直动量平衡由静水近似给出：\n$$ \\frac{\\partial p}{\\partial z} = \\rho g \\quad (3) $$\n其中 $g$ 是重力加速度，$\\rho(x,y,z)$ 是原位海水密度。\n\n热成风关系描述了地转流的垂直切变。它是通过对地转方程 ($1$) 和 ($2$) 求垂直导数（$\\partial/\\partial z$）并与静水方程 ($3$) 结合而得出的。假设 $f$ 随深度不变（传统近似，在所考虑的垂直尺度上有效），我们继续推导。\n\n对式 ($2$) 求 $\\partial/\\partial z$：\n$$ f \\frac{\\partial u_g}{\\partial z} = -\\frac{1}{\\rho_0} \\frac{\\partial^2 p}{\\partial z \\partial y} $$\n假设压力场足够光滑，我们可以交换微分顺序（Clairaut定理）：\n$$ f \\frac{\\partial u_g}{\\partial z} = -\\frac{1}{\\rho_0} \\frac{\\partial}{\\partial y} \\left( \\frac{\\partial p}{\\partial z} \\right) $$\n代入静水平衡（式 $3$）：\n$$ f \\frac{\\partial u_g}{\\partial z} = -\\frac{1}{\\rho_0} \\frac{\\partial (\\rho g)}{\\partial y} = -\\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial y} $$\n这就得到了热成风切变的纬向分量：\n$$ \\frac{\\partial u_g}{\\partial z} = -\\frac{g}{f \\rho_0} \\frac{\\partial \\rho}{\\partial y} \\quad (4) $$\n\n类似地，对式 ($1$) 求 $\\partial/\\partial z$：\n$$ -f \\frac{\\partial v_g}{\\partial z} = -\\frac{1}{\\rho_0} \\frac{\\partial^2 p}{\\partial z \\partial x} = -\\frac{1}{\\rho_0} \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial p}{\\partial z} \\right) $$\n代入静水平衡：\n$$ -f \\frac{\\partial v_g}{\\partial z} = -\\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial x} $$\n这就得到了热成风切变的经向分量：\n$$ \\frac{\\partial v_g}{\\partial z} = \\frac{g}{f \\rho_0} \\frac{\\partial \\rho}{\\partial x} \\quad (5) $$\n方程 ($4$) 和 ($5$) 是热成风方程。它们将水平地转流的垂直切变与密度场的水平梯度联系起来。\n\n### 步骤 2：结合线性化的状态方程\n\n问题指定使用在参考条件 ($S_{\\mathrm{ref}}$, $\\Theta_{\\mathrm{ref}}$, $p_{\\mathrm{ref}}$) 附近线性化的 TEOS-10 状态方程的导数结构。水平密度梯度 $\\nabla_h \\rho = (\\partial\\rho/\\partial x, \\partial\\rho/\\partial y)$ 是通过对线性化状态方程 $\\rho = \\rho(S_A, \\Theta, p)$ 应用链式法则得到的。\n$$ \\nabla_h \\rho = \\frac{\\partial \\rho}{\\partial S_A} \\nabla_h S_A + \\frac{\\partial \\rho}{\\partial \\Theta} \\nabla_h \\Theta + \\frac{\\partial \\rho}{\\partial p} \\nabla_h p $$\n问题提供了常数线性化系数：$\\partial\\rho/\\partial S_A \\approx \\rho_0 \\beta$ 和 $\\partial\\rho/\\partial\\Theta \\approx -\\rho_0 \\alpha$，其中 $\\alpha$ 是热膨胀系数，$\\beta$ 是盐缩系数。它还指定了一个简化的压力模型，其中水平压力梯度对密度计算本身没有贡献，即在状态方程中 $\\nabla_h p \\approx 0$。这是与 Boussinesq 近似一致的常见简化。因此，水平密度梯度为：\n$$ \\nabla_h \\rho = \\rho_0 \\left( \\beta \\nabla_h S_A - \\alpha \\nabla_h \\Theta \\right) $$\n用分量形式表示：\n$$ \\frac{\\partial \\rho}{\\partial x} = \\rho_0 \\left( \\beta \\frac{\\partial S_A}{\\partial x} - \\alpha \\frac{\\partial \\Theta}{\\partial x} \\right) \\quad (6) $$\n$$ \\frac{\\partial \\rho}{\\partial y} = \\rho_0 \\left( \\beta \\frac{\\partial S_A}{\\partial y} - \\alpha \\frac{\\partial \\Theta}{\\partial y} \\right) \\quad (7) $$\n该公式遵循了不直接对计算出的 $\\rho(x,y,z)$ 场进行微分的要求。\n\n将方程 ($6$) 和 ($7$) 代入热成风方程 ($4$) 和 ($5$)，消除了中间的密度计算并抵消了参考密度 $\\rho_0$：\n$$ \\frac{\\partial u_g}{\\partial z} = -\\frac{g}{f \\rho_0} \\left[ \\rho_0 \\left( \\beta \\frac{\\partial S_A}{\\partial y} - \\alpha \\frac{\\partial \\Theta}{\\partial y} \\right) \\right] = -\\frac{g}{f} \\left( \\beta \\frac{\\partial S_A}{\\partial y} - \\alpha \\frac{\\partial \\Theta}{\\partial y} \\right) \\quad (8) $$\n$$ \\frac{\\partial v_g}{\\partial z} = \\frac{g}{f \\rho_0} \\left[ \\rho_0 \\left( \\beta \\frac{\\partial S_A}{\\partial x} - \\alpha \\frac{\\partial \\Theta}{\\partial x} \\right) \\right] = \\frac{g}{f} \\left( \\beta \\frac{\\partial S_A}{\\partial x} - \\alpha \\frac{\\partial \\Theta}{\\partial x} \\right) \\quad (9) $$\n这些是垂直地转切变分量的最终可计算形式。\n\n### 步骤 3：计算流程设计\n\n该算法为四个指定的测试用例中的每一个计算平均地转切变大小。\n\n1.  **常数与网格设置**：定义所有物理常数（$g, \\rho_0, \\Omega, \\alpha, \\beta, S_{\\mathrm{ref}}, \\Theta_{\\mathrm{ref}}$）和网格参数（$N_x, N_y, N_z, d_x, d_y, d_z$）。所有单位都转换为国际单位制。\n\n2.  **遍历测试用例**：对每种情况：\n    a. **科里奥利参数**：计算 $f = 2\\Omega\\sin(\\phi_{\\mathrm{rad}})$，其中情况的纬度 $\\phi$ 从度转换为弧度。注意，对于 $\\phi=1^{\\circ}$，$f$ 很小但非零，使得计算有效。对于 $\\phi=0$，$f=0$，热成风平衡失效；此情况未被测试。\n    b. **生成输入场**：构建绝对盐度 $S_A(x,y,z)$ 和保守温度 $\\Theta(x,y,z)$ 的三维场。这通过首先在网格上创建归一化坐标数组 $\\xi, \\eta, \\zeta$ 来完成，其中 $\\xi_i = i/N_x$, $\\eta_j = j/N_y$, and $\\zeta_k = k/N_z$。然后，在这些归一化网格上评估为每种情况提供的解析函数。\n    c. **计算水平梯度**：数值计算 $S_A$ 和 $\\Theta$ 的水平梯度（$\\partial S_A/\\partial x, \\partial S_A/\\partial y, \\partial \\Theta/\\partial x, \\partial \\Theta/\\partial y$）。根据问题规范，使用二阶精度的中心有限差分方案。`numpy.gradient` 函数为此提供了一个稳健的实现，它在内部点使用中心差分，在边界点使用一阶单边差分。这被应用于 $x$（轴 0）和 $y$（轴 1）方向，并使用各自的网格间距 $d_x$ 和 $d_y$。\n    d. **计算切变分量**：使用计算出的梯度和推导出的方程 ($8$) 和 ($9$)，在每个网格点计算切变分量 $\\partial u_g/\\partial z$ 和 $\\partial v_g/\\partial z$ 的三维场。\n    e. **计算切变大小**：在每个网格点使用欧几里得范数计算垂直地转切变矢量的大小：\n    $$ \\left\\|\\frac{\\partial \\mathbf{u}_g}{\\partial z}\\right\\| = \\sqrt{\\left(\\frac{\\partial u_g}{\\partial z}\\right)^2 + \\left(\\frac{\\partial v_g}{\\partial z}\\right)^2} $$\n    f. **汇总并存储结果**：计算整个三维网格上切变大小的算术平均值。将得到的标量值四舍五入到 6 位小数并存储。对于情况 C，其中水平梯度为零，切变被正确计算为 $0$。\n\n3.  **最终输出**：将所有情况下存储的平均切变大小列表格式化为指定的字符串格式：`[result_A,result_B,result_C,result_D]`。\n\n该流程系统地将热成风平衡的基本物理原理转化为具体的数值算法，并严格遵守问题的约束和科学最佳实践。",
            "answer": "$$\\boxed{[0.001646,0.012586,0.0,0.003444]}$$"
        }
    ]
}