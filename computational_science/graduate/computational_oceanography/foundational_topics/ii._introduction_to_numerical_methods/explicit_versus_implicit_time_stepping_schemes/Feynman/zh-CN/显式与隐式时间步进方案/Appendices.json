{
    "hands_on_practices": [
        {
            "introduction": "显式时间步进格式因其简单性而备受青睐，但其稳定性受到严格的限制。本练习将引导您应用基本的 Courant-Friedrichs-Lewy (CFL) 稳定性条件，这是显式格式的核心。您将学会当模型中同时存在多种物理过程（如平流和重力波）时，如何计算允许的最大稳定时间步长，并理解为何最快的过程会成为决定整个模型时间步长的“瓶颈”。",
            "id": "3792437",
            "problem": "考虑计算海洋学中使用的一维正压沿岸通道模型，其沿 $x$ 方向具有均匀的网格间距 $\\Delta x$。两个双曲过程控制着最快的信号传播，必须通过显式时间步进格式来解析：(i) 速度为 $u$ 的均匀平均流对被动标量的平流；以及 (ii) 与浅水动量-连续性耦合相关的、相速度为 $c$ 的线性化正压重力波的传播。假设被动标量的平流满足守恒律 $\\partial q/\\partial t + u\\,\\partial q/\\partial x = 0$，而正压重力波源于线性浅水系统 $\\partial u/\\partial t = -g\\,\\partial \\eta/\\partial x$ 和 $\\partial \\eta/\\partial t = -H\\,\\partial u/\\partial x$，产生特征波速 $c = \\sqrt{gH}$。该模型对平流采用显式一阶迎风空间离散，结合单步显式时间更新；对线性化浅水动量-连续性系统采用显式前向-后向耦合。\n\n使用关于双曲偏微分方程的依赖域和显式格式稳定性的第一性原理，推导分别由平流和重力波约束时间步长 $\\Delta t$ 的稳定性要求。然后，使用给定参数 $u = 1\\,\\mathrm{m/s}$、$c = 50\\,\\mathrm{m/s}$ 和 $\\Delta x = 10\\,\\mathrm{km}$，计算每个约束条件所允许的最大显式时间步长的数值，并确定满足两个约束条件的单个最大显式时间步长。指出哪个物理过程是约束性限制。以秒为单位表示最终答案，并将最终结果四舍五入到四位有效数字。",
            "solution": "模型动力学由两个双曲过程控制，当在时间上显式推进时，它们具有不同的特征速度和数值稳定性约束。对于显式格式，稳定性由 Courant–Friedrichs–Lewy (CFL) 条件决定，该条件指出数值依赖域必须包含物理依赖域。对于间距为 $\\Delta x$ 的一维均匀网格和显式时间步长 $\\Delta t$，这要求以速度 $v$ 传播的最快信号在一个时间步长内移动的距离不超过一个网格间距，从而对离散化系统中的每个相关特征速度 $v$ 产生形式为 $v\\,\\Delta t \\leq \\Delta x$ 的约束。\n\n**平流约束**\n具有恒定速度 $u$ 的线性平流方程为 $\\partial q/\\partial t + u\\,\\partial q/\\partial x = 0$。对于显式格式，CFL 条件要求\n$$\n\\Delta t \\;\\leq\\; \\frac{\\Delta x}{|u|}.\n$$\n\n**重力波约束**\n线性化浅水方程支持相速度为 $c = \\sqrt{gH}$ 的正压重力波。对于显式格式，CFL 条件要求\n$$\n\\Delta t \\;\\leq\\; \\frac{\\Delta x}{c}.\n$$\n\n**组合约束**\n显式时间步长必须同时满足两个限制，因此必须取两者中的较小值：\n$$\n\\Delta t_{\\max} \\;=\\; \\min\\!\\left(\\frac{\\Delta x}{|u|},\\,\\frac{\\Delta x}{c}\\right).\n$$\n\n**数值计算**\n给定参数为 $u = 1\\,\\mathrm{m/s}$，$c = 50\\,\\mathrm{m/s}$，以及 $\\Delta x = 10\\,\\mathrm{km} = 1.0 \\times 10^{4}\\,\\mathrm{m}$。我们分别计算每个约束：\n- 平流限制：\n$$\n\\Delta t_{\\text{adv}} \\;=\\; \\frac{\\Delta x}{|u|} \\;=\\; \\frac{1.0 \\times 10^{4}\\,\\mathrm{m}}{1\\,\\mathrm{m/s}} \\;=\\; 1.0 \\times 10^{4}\\,\\mathrm{s}.\n$$\n- 重力波限制：\n$$\n\\Delta t_{\\text{gw}} \\;=\\; \\frac{\\Delta x}{c} \\;=\\; \\frac{1.0 \\times 10^{4}\\,\\mathrm{m}}{50\\,\\mathrm{m/s}} \\;=\\; 2.0 \\times 10^{2}\\,\\mathrm{s}.\n$$\n\n取最小值，得到最终的稳定性约束：\n$$\n\\Delta t_{\\max} \\;=\\; \\min\\!\\left(1.0 \\times 10^{4}\\,\\mathrm{s},\\,2.0 \\times 10^{2}\\,\\mathrm{s}\\right) \\;=\\; 2.0 \\times 10^{2}\\,\\mathrm{s}.\n$$\n四舍五入到四位有效数字并以秒表示，最大显式时间步长为 $2.000 \\times 10^{2}\\,\\mathrm{s}$。约束性限制是由传播速度更快的正压重力波设定的，因为 $c \\gg |u|$ 使得 $\\Delta x/c$ 成为两个限制中较小的一个。",
            "answer": "$$\\boxed{2.000 \\times 10^{2}}$$"
        },
        {
            "introduction": "隐式格式可以突破显式方法严格的时间步长限制，但这种稳定性是有代价的。本练习将通过一个经典的一维垂直扩散问题，探讨显式与隐式格式之间的权衡。您将为显式和隐式两种格式推导稳定性判据，并关键性地理解为何一个“无条件稳定”的隐式方法仍需受到精度要求的约束，才能产生有物理意义的结果。",
            "id": "3792451",
            "problem": "考虑海洋中被动示踪剂的一维垂直扩散，其控制方程为偏微分方程 $\\frac{\\partial C}{\\partial t}=\\frac{\\partial}{\\partial z}\\left(\\nu_{z}\\frac{\\partial C}{\\partial z}\\right)$，其中 $C(z,t)$ 为示踪剂浓度，$z$ 为垂直坐标，$t$ 为时间，$\\nu_{z}$ 为常数垂直扩散系数。使用间距为 $\\Delta z$ 的均匀垂直网格。在此网格上考虑两种时间步进格式：(i) 显式向前差分、中心差分格式和 (ii) 隐式向后差分、中心差分格式。\n\n从给定的控制方程出发，使用傅里叶模态稳定性分析，根据无量纲扩散 Courant–Friedrichs–Lewy (CFL) 数 $r=\\nu_{z}\\Delta t/\\Delta z^{2}$ 推导显式格式的稳定性约束，并确定此网格上最大的稳定显式时间步长 $\\Delta t_{\\mathrm{exp}}$。然后，推导隐式格式的放大因子，并证明其是无条件稳定的。为了在科学上有意义的基础上，将一个实际的隐式时间步长选择与显式稳定性极限进行比较，我们对隐式格式施加一个精度要求：选择最大的隐式时间步长 $\\Delta t_{\\mathrm{imp}}$，使得对于波数为 $k=\\pi/\\Delta z$ 的网格尺度傅里叶模态，隐式格式的放大因子与精确扩散衰减因子之间的单步相对误差不大于 $0.1$。\n\n对于 $\\nu_{z}=10^{-2}\\,\\mathrm{m^{2}/s}$ 和 $\\Delta z=1\\,\\mathrm{m}$，计算 $\\Delta t_{\\mathrm{exp}}$ 和 $\\Delta t_{\\mathrm{imp}}$。两个最终答案都以秒为单位表示。将隐式时间步长四舍五入到四位有效数字。显式时间步长不需要四舍五入。",
            "solution": "控制方程为一维扩散方程：\n$$\n\\frac{\\partial C}{\\partial t} = \\nu_{z} \\frac{\\partial^2 C}{\\partial z^2}\n$$\n其中扩散系数 $\\nu_{z}$ 为常数。\n\n**显式 (FTCS) 格式稳定性分析**\n\n显式向前差分、中心差分 (FTCS) 格式可写为：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} = \\nu_{z} \\frac{C_{j+1}^n - 2C_j^n + C_{j-1}^n}{\\Delta z^2}\n$$\n使用傅里叶模态稳定性分析，代入单个傅里叶模态 $C_j^n = A^n e^{ikj\\Delta z}$，可推导出放大因子 $A$ 为：\n$$\nA = 1 - 4r \\sin^2\\left(\\frac{k\\Delta z}{2}\\right)\n$$\n其中 $r = \\frac{\\nu_{z}\\Delta t}{\\Delta z^{2}}$ 是无量纲扩散数。为保证稳定性，要求 $|A| \\le 1$ 对所有波数 $k$ 成立。最严格的条件发生在奈奎斯特模态（$k\\Delta z = \\pi$），此时 $\\sin^2\\left(\\frac{k\\Delta z}{2}\\right)=1$。这导致稳定性约束为 $r \\le \\frac{1}{2}$。因此，最大的稳定显式时间步长为：\n$$\n\\Delta t_{\\mathrm{exp}} = \\frac{\\Delta z^{2}}{2\\nu_{z}}\n$$\n\n**隐式 (BTCS) 格式稳定性分析**\n\n隐式向后差分、中心差分 (BTCS) 格式为：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} = \\nu_{z} \\frac{C_{j+1}^{n+1} - 2C_j^{n+1} + C_{j-1}^{n+1}}{\\Delta z^2}\n$$\n类似的傅里叶分析得出隐式格式的放大因子 $A_{\\mathrm{imp}}$ 为：\n$$\nA_{\\mathrm{imp}} = \\frac{1}{1 + 4r \\sin^2\\left(\\frac{k\\Delta z}{2}\\right)}\n$$\n由于 $r > 0$，分母总是大于或等于1，因此 $|A_{\\mathrm{imp}}| \\le 1$ 对所有 $r$ 和 $k$ 都成立。该格式是无条件稳定的。\n\n**受精度限制的隐式时间步长**\n\n对于单个傅里叶模态，偏微分方程的精确解在一个时间步长 $\\Delta t$ 内的放大因子为：\n$$\nA_{\\mathrm{exact}} = \\exp(-\\nu_z k^2 \\Delta t) = \\exp\\left(-k^2 \\Delta z^2 r\\right)\n$$\n我们比较在网格尺度模态 $k=\\pi/\\Delta z$ 处，数值放大因子与精确放大因子。\n$$\nA_{\\mathrm{imp}}(k=\\pi/\\Delta z) = \\frac{1}{1+4r}, \\quad A_{\\mathrm{exact}}(k=\\pi/\\Delta z) = \\exp(-\\pi^2 r)\n$$\n相对误差约束为 $|\\frac{A_{\\mathrm{imp}} - A_{\\mathrm{exact}}}{A_{\\mathrm{exact}}}| \\le 0.1$。数值格式的放大因子大于精确解，因此我们求解：\n$$\n\\frac{A_{\\mathrm{imp}}}{A_{\\mathrm{exact}}} - 1 \\le 0.1 \\implies \\frac{1/(1+4r)}{\\exp(-\\pi^2 r)} \\le 1.1\n$$\n这等价于求解 $r$ 满足的不等式：\n$$\n(1+4r)\\exp(-\\pi^2 r) \\ge \\frac{1}{1.1}\n$$\n这是一个关于 $r$ 的超越方程。通过数值求解，我们找到满足等式的临界值 $r_{\\mathrm{imp}} \\approx 0.015913$。最大的隐式时间步长 $\\Delta t_{\\mathrm{imp}}$ 就基于这个 $r$ 值。\n\n**数值计算**\n\n给定 $\\nu_z = 10^{-2}\\,\\mathrm{m^2/s}$ 和 $\\Delta z = 1\\,\\mathrm{m}$。\n\n1.  **最大显式时间步长**：\n    $$\n    \\Delta t_{\\mathrm{exp}} = \\frac{(1\\,\\mathrm{m})^2}{2 \\times 10^{-2}\\,\\mathrm{m^2/s}} = \\frac{1}{0.02}\\,\\mathrm{s} = 50\\,\\mathrm{s}\n    $$\n2.  **受精度限制的最大隐式时间步长**：\n    $$\n    \\Delta t_{\\mathrm{imp}} = \\frac{r_{\\mathrm{imp}} \\Delta z^2}{\\nu_z} = \\frac{0.015913 \\times (1\\,\\mathrm{m})^2}{10^{-2}\\,\\mathrm{m^2/s}} \\approx 1.5913\\,\\mathrm{s}\n    $$\n    四舍五入到四位有效数字，我们得到 $\\Delta t_{\\mathrm{imp}} = 1.591\\,\\mathrm{s}$。\n\n因此，最大的稳定显式时间步长为 $50\\,\\mathrm{s}$，而满足精度要求的最大隐式时间步长为 $1.591\\,\\mathrm{s}$。这说明了尽管隐式方法无条件稳定，但为了准确解析物理过程，其时间步长仍受精度限制。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 50 & 1.591 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实的海洋模型通常包含非线性过程，例如海底摩擦，这对数值格式构成了挑战。本练习将带您从理论走向实践，要求您为一个非线性摩擦项实现一个隐式求解器。您将使用稳健的牛顿-拉弗森方法来求解非线性方程，从而获得处理隐式格式中常见的非线性问题的实践经验。",
            "id": "3792416",
            "problem": "你需要为一个垂向平均、深度积分的海洋动量模型实现一个速度的隐式时间步更新，该模型包含非线性二次底摩擦。从水平速度 $u(t)$ 的一维、深度平均动量平衡方程开始，\n$$\n\\frac{du}{dt} = F(t) - \\frac{\\tau(u)}{\\rho h},\n$$\n其中 $h$ 是恒定的水深，$\\rho$ 是水的密度，而 $F(t)$ 是一个已知的单位质量外部加速度（例如，由压力梯度或风应力除以密度和深度引起）。底应力由非线性摩擦定律给出\n$$\n\\tau(u) = \\rho C_d \\lvert u \\rvert u,\n$$\n其中 $C_d$ 是一个已知的、恒定的拖曳系数。因此，控制方程简化为\n$$\n\\frac{du}{dt} = F(t) - \\frac{C_d}{h} \\lvert u \\rvert u.\n$$\n考虑从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 的单个时间步，其中摩擦项被隐式处理，外部加速度在时间 $t^n$ 被显式处理。使用一个与时间上一阶精度一致的单步法，推导确定 $u^{n+1}$ 的标量非线性方程，该方程用 $u^n$、$\\Delta t$、$C_d$、$h$ 和 $F^n \\equiv F(t^n)$ 表示。分析此标量方程的结构，以证明 $u^{n+1}$ 解的存在性和唯一性。\n\n设计一个鲁棒的牛顿迭代法来求解 $u^{n+1}$，该方法应满足：\n- 从初始猜测 $u^{(0)} = u^n$ 开始。\n- 在标量残差对 $u$ 的导数存在的地方使用其精确导数，并在 $u=0$ 处使用一个数学上一致的值。\n- 当残差的绝对值小于预设容差，或当连续迭代值之差小于预设容差时终止。\n- 使用最大迭代次数上限以确保在所有情况下都能终止。如果一个完整的牛顿步未能减小绝对残差，则应用回溯策略，通过将步长减半，直到残差减小或步长变得足够小为止。\n\n实现一个程序，为下面的每个测试用例计算 $u^{n+1}$。所有物理量必须使用国际单位制（SI）处理：速度单位为米/秒（$\\mathrm{m/s}$），时间单位为秒（$\\mathrm{s}$），深度单位为米（$\\mathrm{m}$）。拖曳系数 $C_d$ 是无量纲的，外部加速度 $F^n$ 的单位是米/平方秒（$\\mathrm{m/s^2}$）。你的程序必须将测试集得到的速度 $u^{n+1}$ 列表作为单行输出，格式为方括号内、无空格的逗号分隔列表，每个数字四舍五入到八位小数，且每个条目的隐含单位是 $\\mathrm{m/s}$。\n\n测试集（每个元组为 $(u^n,\\Delta t,C_d,h,F^n)$，单位为 $(\\mathrm{m/s},\\mathrm{s},-,\\mathrm{m},\\mathrm{m/s^2})$）：\n- 情况 A（一般情况）： $(0.5, 600.0, 2.5\\times 10^{-3}, 50.0, 1.0\\times 10^{-4})$\n- 情况 B（边界，零状态）： $(0.0, 600.0, 3.0\\times 10^{-3}, 20.0, 0.0)$\n- 情况 C（符号变化趋势）： $(-0.2, 3600.0, 3.0\\times 10^{-3}, 10.0, 5.0\\times 10^{-4})$\n- 情况 D（刚性摩擦，大时间步）： $(2.0, 21600.0, 3.0\\times 10^{-3}, 5.0, 0.0)$\n- 情况 E（深水，弱摩擦）： $(-1.5, 900.0, 1.0\\times 10^{-3}, 500.0, -2.0\\times 10^{-4})$\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含一个用方括号括起来、无空格的逗号分隔列表，每个条目四舍五入到八位小数，例如：“[0.12345678,-0.87654321,0.00000000]”。",
            "solution": "该问题要求为带非线性二次底摩擦的一维、深度平均动量方程推导并实现一个一阶、半隐式时间步长格式。求解新时间步的速度 $u^{n+1}$ 需要使用鲁棒的 Newton-Raphson 方法来解一个标量非线性方程。\n\n### 半隐式格式的推导\n\n水平速度 $u(t)$ 的控制常微分方程如下：\n$$\n\\frac{du}{dt} = F(t) - \\frac{C_d}{h} \\lvert u \\rvert u\n$$\n其中 $u$ 是速度，$t$ 是时间，$F(t)$ 是外部加速度，$C_d$ 是无量纲拖曳系数，$h$ 是恒定水深。\n\n为了推导一个时间上一阶精确的数值格式，我们使用时间步长 $\\Delta t = t^{n+1} - t^n$ 上的向前差分来离散化时间导数：\n$$\n\\frac{du}{dt} \\approx \\frac{u^{n+1} - u^n}{\\Delta t}\n$$\n问题指定了一个半隐式格式，其中外部加速度 $F(t)$ 被显式处理（在时间 $t^n$ 求值），非线性摩擦项被隐式处理（在时间 $t^{n+1}$ 求值）。\n\n将离散化的时间导数等于离散化的右侧项，得到：\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = F^n - \\frac{C_d}{h} \\lvert u^{n+1} \\rvert u^{n+1}\n$$\n其中 $u^n = u(t^n)$，$u^{n+1} = u(t^{n+1})$，以及 $F^n = F(t^n)$。\n\n为了求解未知数 $u^{n+1}$，我们将此方程重排为一个标准的求根形式 $R(x)=0$，其中 $x = u^{n+1}$。\n$$\nu^{n+1} + \\frac{\\Delta t C_d}{h} \\lvert u^{n+1} \\rvert u^{n+1} - u^n - \\Delta t F^n = 0\n$$\n这就是关于 $u^{n+1}$ 的标量非线性方程。为方便起见，我们定义两个常数：无量纲摩擦参数 $\\alpha = \\frac{\\Delta t C_d}{h}$ 和显式预测项 $\\beta = u^n + \\Delta t F^n$。关于 $x = u^{n+1}$ 的方程简化为：\n$$\nx + \\alpha \\lvert x \\rvert x - \\beta = 0\n$$\n因此，需要通过牛顿迭代求解的残差函数是：\n$$\nR(x) = x + \\alpha \\lvert x \\rvert x - \\beta\n$$\n\n### 解的存在性与唯一性\n\n为了证明 $u^{n+1}$ 解的存在性与唯一性，我们分析函数 $g(x) = x + \\alpha \\lvert x \\rvert x$ 的性质。待解方程为 $g(x) = \\beta$。物理参数 $\\Delta t$、$C_d$ 和 $h$ 都是正的，因此系数 $\\alpha = \\frac{\\Delta t C_d}{h}$ 也是正的。$g(x)$ 的导数为：\n$$\ng'(x) = 1 + 2\\alpha \\lvert x \\rvert\n$$\n由于 $\\alpha > 0$ 且 $\\lvert x \\rvert \\geq 0$，导数 $g'(x)$ 总是大于或等于 $1$。一个导数严格为正的函数是严格单调递增的。此外，当 $x \\to \\pm\\infty$ 时，$g(x) \\to \\pm\\infty$。一个连续且严格单调的函数，其值域覆盖整个实数轴，因此对于任何实数 $\\beta$，都存在唯一的实数解 $x = u^{n+1}$。\n\n### 牛顿迭代格式\n\n我们使用 Newton-Raphson 方法求解非线性方程 $R(x) = 0$。迭代更新公式为：\n$$\nx^{(k+1)} = x^{(k)} - \\frac{R(x^{(k)})}{R'(x^{(k)})}\n$$\n其中 $x^{(k)}$ 是第 $k$ 次迭代时根的估计值。\n\n- **残差及其导数**：\n  残差为 $R(x) = x + \\alpha \\lvert x \\rvert x - \\beta$。\n  其导数是 $R'(x) = 1 + 2\\alpha \\lvert x \\rvert$。该导数对于所有 $x$ 都是连续且良定义的，包括 $x=0$（此时 $R'(0) = 1$）。\n\n- **迭代更新**：牛顿步 $\\Delta x^{(k)}$ 的计算如下：\n  $$\n  \\Delta x^{(k)} = - \\frac{x^{(k)} + \\alpha \\lvert x^{(k)} \\rvert x^{(k)} - \\beta}{1 + 2\\alpha \\lvert x^{(k)} \\rvert}\n  $$\n  下一个迭代值为 $x^{(k+1)} = x^{(k)} + \\Delta x^{(k)}$。\n\n- **回溯线搜索**：为了增强鲁棒性，如果一个完整的牛顿步没有减小残差的绝对值，则步长 $\\lambda$ 将被连续减半。更新变为 $x^{(k+1)} = x^{(k)} + \\lambda \\Delta x^{(k)}$。\n\n- **终止准则**：当残差的绝对值或步长小于预设容差，或达到最大迭代次数时，迭代终止。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the updated velocity u^{n+1} using a semi-implicit scheme\n    for a 1D ocean momentum model with quadratic bottom friction.\n    The resulting nonlinear scalar equation is solved with a robust Newton's method.\n    \"\"\"\n\n    test_cases = [\n        # Case A (general): (u^n, Δt, C_d, h, F^n)\n        (0.5, 600.0, 2.5e-3, 50.0, 1.0e-4),\n        # Case B (boundary, zero state):\n        (0.0, 600.0, 3.0e-3, 20.0, 0.0),\n        # Case C (sign change tendency):\n        (-0.2, 3600.0, 3.0e-3, 10.0, 5.0e-4),\n        # Case D (stiff friction, large time step):\n        (2.0, 21600.0, 3.0e-3, 5.0, 0.0),\n        # Case E (deep water, weak friction):\n        (-1.5, 900.0, 1.0e-3, 500.0, -2.0e-4),\n    ]\n\n    def solve_newton_step(un, dt, Cd, h, Fn):\n        \"\"\"\n        Computes u^{n+1} by solving the nonlinear equation using Newton's method.\n        The equation is R(x) = x + alpha*|x|*x - beta = 0, where x = u^{n+1}.\n        \"\"\"\n        alpha = dt * Cd / h\n        beta = un + dt * Fn\n\n        def R(x):\n            return x + alpha * np.abs(x) * x - beta\n\n        def R_prime(x):\n            return 1.0 + 2.0 * alpha * np.abs(x)\n\n        # Newton iteration parameters\n        max_iter = 100\n        tol_res = 1e-12   # Tolerance for the absolute residual\n        tol_step = 1e-12  # Tolerance for the absolute step size\n        min_lambda = 1e-5 # Minimum backtracking step factor\n\n        x_k = un  # Initial guess x^(0) = u^n\n\n        for _ in range(max_iter):\n            res_k = R(x_k)\n            \n            # Check for convergence on residual before taking the step\n            if np.abs(res_k)  tol_res:\n                return x_k\n\n            res_prime_k = R_prime(x_k)\n            # R_prime is always >= 1 for alpha > 0, so no division by zero\n\n            delta_x = -res_k / res_prime_k\n\n            # Backtracking line search\n            lam = 1.0\n            abs_res_k = np.abs(res_k)\n            \n            # Loop to find a step that reduces the residual\n            while True:\n                x_kp1 = x_k + lam * delta_x\n                res_kp1 = R(x_kp1)\n                \n                if np.abs(res_kp1)  abs_res_k:\n                    # Step accepted, break backtracking loop\n                    break\n                \n                lam /= 2.0\n                \n                # If step becomes too small, backtracking fails\n                if lam  min_lambda:\n                    # Unable to find a better point. Terminate iteration and return current best.\n                    return x_k\n            \n            # Check for convergence after finding a valid step\n            # 1. On residual at the new point\n            if np.abs(res_kp1)  tol_res:\n                return x_kp1\n            # 2. On step size\n            if np.abs(x_kp1 - x_k)  tol_step:\n                return x_kp1\n            \n            # Update for next iteration\n            x_k = x_kp1\n\n        # Return the last computed value if max_iter is reached\n        return x_k\n\n    results = []\n    for case in test_cases:\n        un, dt, Cd, h, Fn = case\n        result = solve_newton_step(un, dt, Cd, h, Fn)\n        results.append(result)\n\n    # Format the final output string as specified in the problem\n    results_str = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}