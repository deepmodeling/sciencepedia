{
    "hands_on_practices": [
        {
            "introduction": "在计算海洋学中，显式时间步进方案的稳定性是首要考虑的问题。时间步长的选择受到模型中最快物理过程传播速度的严格限制，这一原则被称为 Courant–Friedrichs–Lewy (CFL) 条件。本练习将通过一个简化的海岸通道模型，带您亲手计算并比较由平流和重力波这两种不同物理过程所施加的稳定性约束，从而确定控制模型稳定性的主导因素。",
            "id": "3792437",
            "problem": "考虑一个用于计算海洋学的一维正压海岸通道模型，其沿 $x$ 方向具有均匀的网格间距 $\\Delta x$。两个双曲过程控制着最快信号的传播，这必须通过一个显式时间步进格式来解析：(i) 速度为 $u$ 的均匀平均流对被动标量的平流，以及 (ii) 与浅水动量-连续性耦合相关的、相速度为 $c$ 的线性化正压重力波的传播。假设被动标量的平流满足守恒定律 $\\partial q/\\partial t + u\\,\\partial q/\\partial x = 0$，而正压重力波源于线性浅水系统 $\\partial u/\\partial t = -g\\,\\partial \\eta/\\partial x$ 和 $\\partial \\eta/\\partial t = -H\\,\\partial u/\\partial x$，得到特征波速 $c = \\sqrt{gH}$。该模型对平流采用一阶迎风空间离散结合单步显式时间更新，对线性化浅水动量-连续性系统采用显式前向-后向耦合。\n\n使用关于双曲偏微分方程的依赖域和显式格式稳定性的基本原理，推导分别由平流和重力波所带来的约束时间步长 $\\Delta t$ 的稳定性要求。然后，使用给定参数 $u = 1\\,\\mathrm{m/s}$、$c = 50\\,\\mathrm{m/s}$ 和 $\\Delta x = 10\\,\\mathrm{km}$，计算每个约束条件所允许的最大显式时间步长的数值，并确定满足两个约束条件的单一最大显式时间步长。确定哪个物理过程是决定性的约束条件。以秒为单位表示最终答案，并将最终结果四舍五入到四位有效数字。",
            "solution": "当模型在时间上显式推进时，其动力学由两个具有不同特征速度和数值稳定性约束的双曲过程控制。对于显式格式，稳定性由 Courant–Friedrichs–Lewy (CFL) 条件决定，该条件指出数值依赖域必须包含物理依赖域。对于间距为 $\\Delta x$ 的一维均匀网格和显式时间步长 $\\Delta t$，这要求以速度 $v$ 传播的最快信号在一个时间步内移动的距离不超过一个网格区间，从而对离散化系统中的每个相关特征速度 $v$ 产生形式为 $v\\,\\Delta t \\leq \\Delta x$ 的约束。\n\n平流约束。考虑具有恒定速度 $u$ 的线性平流方程 $\\partial q/\\partial t + u\\,\\partial q/\\partial x = 0$。使用一阶迎风空间离散和单步显式时间更新，通过 Von Neumann (正规模态) 稳定性分析得到的放大因子为\n$$\nG(k) \\;=\\; 1 \\;-\\; \\lambda\\left(1 - \\exp(-\\mathrm{i}k\\,\\Delta x)\\right),\n$$\n其中 $k$ 是波数，$\\lambda = \\dfrac{u\\,\\Delta t}{\\Delta x}$ 是 Courant 数。稳定性要求对所有 $k$ 都有 $|G(k)| \\leq 1$，对于迎风格式，这简化为\n$$\n0 \\;\\leq\\; \\lambda \\;\\leq\\; 1.\n$$\n因此平流约束为\n$$\n\\Delta t \\;\\leq\\; \\frac{\\Delta x}{|u|}.\n$$\n\n重力波约束。线性化浅水方程\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\,g\\,\\frac{\\partial \\eta}{\\partial x}, \n\\qquad\n\\frac{\\partial \\eta}{\\partial t} \\;=\\; -\\,H\\,\\frac{\\partial u}{\\partial x},\n$$\n支持相速度为 $c = \\sqrt{gH}$、特征线为 $x \\pm c\\,t = \\text{constant}$ 的正压重力波。对于动量和连续性的显式前向-后向耦合，Von Neumann 稳定性分析得出一个 CFL 条件，要求波在每个时间步内移动的距离不超过一个网格单元，即\n$$\n\\Delta t \\;\\leq\\; \\frac{\\Delta x}{c}.\n$$\n这与双曲波的依赖域论证相一致。\n\n组合约束。显式时间步长必须同时满足这两个限制：\n$$\n\\Delta t_{\\max} \\;=\\; \\min\\!\\left(\\frac{\\Delta x}{|u|},\\,\\frac{\\Delta x}{c}\\right).\n$$\n\n数值计算。给定参数为 $u = 1\\,\\mathrm{m/s}$、$c = 50\\,\\mathrm{m/s}$ 和 $\\Delta x = 10\\,\\mathrm{km} = 1.0 \\times 10^{4}\\,\\mathrm{m}$。计算每个约束：\n- 平流限制：\n$$\n\\Delta t_{\\text{adv}} \\;=\\; \\frac{\\Delta x}{|u|} \\;=\\; \\frac{1.0 \\times 10^{4}\\,\\mathrm{m}}{1\\,\\mathrm{m/s}} \\;=\\; 1.0 \\times 10^{4}\\,\\mathrm{s}.\n$$\n- 重力波限制：\n$$\n\\Delta t_{\\text{gw}} \\;=\\; \\frac{\\Delta x}{c} \\;=\\; \\frac{1.0 \\times 10^{4}\\,\\mathrm{m}}{50\\,\\mathrm{m/s}} \\;=\\; 2.0 \\times 10^{2}\\,\\mathrm{s}.\n$$\n\n取最小值，\n$$\n\\Delta t_{\\max} \\;=\\; \\min\\!\\left(1.0 \\times 10^{4},\\,2.0 \\times 10^{2}\\right)\\,\\mathrm{s} \\;=\\; 2.0 \\times 10^{2}\\,\\mathrm{s}.\n$$\n四舍五入到四位有效数字并以秒表示，最大显式时间步长为 $2.000 \\times 10^{2}\\,\\mathrm{s}$。决定性的约束是由正压重力波设定的，因为 $c \\gg |u|$ 使得 $\\Delta x/c$ 成为两个限制中较小的一个。",
            "answer": "$$\\boxed{2.000 \\times 10^{2}}$$"
        },
        {
            "introduction": "与波动过程相比，扩散过程对显式时间步长的限制可能更为严苛，尤其是在高分辨率网格上。本练习旨在揭示显式方案在模拟扩散时的这一固有局限性，并引入无条件稳定的隐式方案作为对比。更重要的是，本练习将引导您思考一个关键的权衡：即使隐式方案在理论上是稳定的，为了保证计算结果的准确性，时间步长的选择仍然会受到限制。",
            "id": "3792451",
            "problem": "考虑海洋中被动示踪剂的一维垂直扩散，其由偏微分方程 $\\frac{\\partial C}{\\partial t}=\\frac{\\partial}{\\partial z}\\left(\\nu_{z}\\frac{\\partial C}{\\partial z}\\right)$ 控制，其中 $C(z,t)$ 是示踪剂浓度，$z$ 是垂直坐标，$t$ 是时间，$\\nu_{z}$ 是恒定的垂直扩散系数。使用间距为 $\\Delta z$ 的均匀垂直网格。在该网格上考虑两种时间步进格式：(i) 显式的时间向前、空间中心格式；(ii) 隐式的时间向后、空间中心格式。\n\n从给定的控制方程出发，使用傅里叶模态稳定性分析，推导显式格式的稳定性约束（用无量纲的扩散 Courant–Friedrichs–Lewy (CFL) 数 $r=\\nu_{z}\\Delta t/\\Delta z^{2}$ 表示），并确定此网格上最大的稳定显式时间步长 $\\Delta t_{\\mathrm{exp}}$。然后，推导隐式格式的放大因子，并证明其是无条件稳定的。为了在科学上有意义的基础上，将一个实用的隐式时间步长选择与显式稳定性极限进行比较，对隐式格式施加一个精度要求：选择最大的隐式时间步长 $\\Delta t_{\\mathrm{imp}}$，使得对于波数为 $k=\\pi/\\Delta z$ 的网格尺度傅里叶模态，隐式格式的放大因子与精确的扩散衰减因子之间的单步相对误差不大于 $0.1$。\n\n对于 $\\nu_{z}=10^{-2}\\,\\mathrm{m^{2}/s}$ 和 $\\Delta z=1\\,\\mathrm{m}$，计算 $\\Delta t_{\\mathrm{exp}}$ 和 $\\Delta t_{\\mathrm{imp}}$。将两个最终答案以秒为单位表示。将隐式时间步长四舍五入到四位有效数字。显式时间步长不需要四舍五入。",
            "solution": "控制方程为一维扩散方程：\n$$\n\\frac{\\partial C}{\\partial t} = \\nu_{z} \\frac{\\partial^2 C}{\\partial z^2}\n$$\n其中扩散系数 $\\nu_{z}$ 是常数。我们使用间距为 $\\Delta z$ 的网格和时间步长 $\\Delta t$。令 $C_j^n$ 表示 $C(j\\Delta z, n\\Delta t)$ 的数值近似。\n\n**第 1 部分：显式（FTCS）格式稳定性分析**\n\n时间向前、空间中心（FTCS）的显式格式由下式给出：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} = \\nu_{z} \\frac{C_{j+1}^n - 2C_j^n + C_{j-1}^n}{\\Delta z^2}\n$$\n整理并引入无量纲的扩散 Courant–Friedrichs–Lewy (CFL) 数 $r = \\frac{\\nu_{z}\\Delta t}{\\Delta z^{2}}$，我们得到：\n$$\nC_j^{n+1} = C_j^n + r \\left( C_{j+1}^n - 2C_j^n + C_{j-1}^n \\right)\n$$\n对于傅里叶模态稳定性分析，我们代入单个傅里叶模态 $C_j^n = A^n e^{ikj\\Delta z}$，其中 $A$ 是放大因子，$k$ 是波数。\n$$\nA^{n+1} e^{ikj\\Delta z} = A^n e^{ikj\\Delta z} + r \\left( A^n e^{ik(j+1)\\Delta z} - 2A^n e^{ikj\\Delta z} + A^n e^{ik(j-1)\\Delta z} \\right)\n$$\n两边同除以 $A^n e^{ikj\\Delta z}$ 得到放大因子 $A = A^{n+1}/A^n$：\n$$\nA = 1 + r \\left( e^{ik\\Delta z} - 2 + e^{-ik\\Delta z} \\right)\n$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，上式简化为：\n$$\nA = 1 + 2r \\left( \\cos(k\\Delta z) - 1 \\right)\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\nA = 1 - 4r \\sin^2\\left(\\frac{k\\Delta z}{2}\\right)\n$$\n为保证稳定性，对于任何波数 $k$，放大因子的模都不能超过1，即 $|A| \\le 1$。由于 $r > 0$ 且 $\\sin^2(\\cdot) \\ge 0$，我们有 $A \\le 1$。因此，稳定性受限于条件 $A \\ge -1$：\n$$\n1 - 4r \\sin^2\\left(\\frac{k\\Delta z}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4r \\sin^2\\left(\\frac{k\\Delta z}{2}\\right) \\implies r \\le \\frac{1}{2\\sin^2\\left(\\frac{k\\Delta z}{2}\\right)}\n$$\n这个条件必须对所有 $k$ 成立。最严格的（最坏情况）场景发生在 $\\sin^2\\left(\\frac{k\\Delta z}{2}\\right)$ 最大时。最大值为1，这发生在网格尺度的奈奎斯特模态，其中 $k\\Delta z = \\pi$。因此，稳定性约束为：\n$$\nr \\le \\frac{1}{2}\n$$\n最大稳定显式时间步长 $\\Delta t_{\\mathrm{exp}}$ 对应于等式：\n$$\n\\frac{\\nu_{z}\\Delta t_{\\mathrm{exp}}}{\\Delta z^{2}} = \\frac{1}{2} \\implies \\Delta t_{\\mathrm{exp}} = \\frac{\\Delta z^{2}}{2\\nu_{z}}\n$$\n\n**第 2 部分：隐式（BTCS）格式稳定性分析**\n\n时间向后、空间中心（BTCS）的隐式格式在未来的时间层 $n+1$ 上计算空间导数：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} = \\nu_{z} \\frac{C_{j+1}^{n+1} - 2C_j^{n+1} + C_{j-1}^{n+1}}{\\Delta z^2}\n$$\n整理得到：\n$$\nC_j^n = C_j^{n+1} - r \\left( C_{j+1}^{n+1} - 2C_j^{n+1} + C_{j-1}^{n+1} \\right)\n$$\n代入傅里叶模态 $C_j^n = A^n e^{ikj\\Delta z}$：\n$$\nA^n e^{ikj\\Delta z} = A^{n+1} e^{ikj\\Delta z} - r \\left( A^{n+1} e^{ik(j+1)\\Delta z} - 2A^{n+1} e^{ikj\\Delta z} + A^{n+1} e^{ik(j-1)\\Delta z} \\right)\n$$\n两边同除以 $e^{ikj\\Delta z}$ 并提出 $A^{n+1}$：\n$$\nA^n = A^{n+1} \\left[ 1 - r \\left( e^{ik\\Delta z} - 2 + e^{-ik\\Delta z} \\right) \\right]\n$$\n$$\nA^n = A^{n+1} \\left[ 1 - 2r \\left( \\cos(k\\Delta z) - 1 \\right) \\right] = A^{n+1} \\left[ 1 + 4r \\sin^2\\left(\\frac{k\\Delta z}{2}\\right) \\right]\n$$\n隐式格式的放大因子 $A = A^{n+1}/A^n$ 为：\n$$\nA_{\\mathrm{imp}} = \\frac{1}{1 + 4r \\sin^2\\left(\\frac{k\\Delta z}{2}\\right)}\n$$\n为保证稳定性，我们要求 $|A_{\\mathrm{imp}}| \\le 1$。由于 $r > 0$ 且 $\\sin^2(\\cdot) \\ge 0$，分母总是大于或等于1。因此，对于所有 $r$ 和 $k$ 的值，$0  A_{\\mathrm{imp}} \\le 1$。该格式是无条件稳定的。\n\n**第 3 部分：精度限制的隐式时间步长**\n\n我们首先找到精确的放大因子。对于单个傅里叶模态 $C(z,t) = \\hat{C}(t)e^{ikz}$，偏微分方程 $\\frac{\\partial C}{\\partial t} = \\nu_z \\frac{\\partial^2 C}{\\partial z^2}$ 变为 $\\frac{d\\hat{C}}{dt} = -\\nu_z k^2 \\hat{C}$。解为 $\\hat{C}(t) = \\hat{C}(0)\\exp(-\\nu_z k^2 t)$。在一个时间步长 $\\Delta t$ 内的精确放大因子为：\n$$\nA_{\\mathrm{exact}} = \\exp(-\\nu_z k^2 \\Delta t)\n$$\n问题要求对波数为 $k = \\pi/\\Delta z$ 的网格尺度模态进行精度比较。对于此模态，$k\\Delta z = \\pi$。\n此模态的隐式放大因子为：\n$$\nA_{\\mathrm{imp}}(k=\\pi/\\Delta z) = \\frac{1}{1 + 4r \\sin^2\\left(\\frac{\\pi}{2}\\right)} = \\frac{1}{1+4r}\n$$\n此模态的精确放大因子为：\n$$\nA_{\\mathrm{exact}}(k=\\pi/\\Delta z) = \\exp\\left(-\\nu_z \\left(\\frac{\\pi}{\\Delta z}\\right)^2 \\Delta t\\right) = \\exp\\left(-\\pi^2 \\frac{\\nu_z \\Delta t}{\\Delta z^2}\\right) = \\exp(-\\pi^2 r)\n$$\n相对误差约束为 $|\\frac{A_{\\mathrm{imp}} - A_{\\mathrm{exact}}}{A_{\\mathrm{exact}}}| \\le 0.1$。由于数值放大因子 $A_{\\mathrm{imp}}$ 大于精确放大因子 $A_{\\mathrm{exact}}$（即数值格式的耗散性不足），该误差条件主要由 $\\frac{A_{\\mathrm{imp}}}{A_{\\mathrm{exact}}} - 1 \\le 0.1$ 决定，即：\n$$\n\\frac{A_{\\mathrm{imp}}}{A_{\\mathrm{exact}}} \\le 1.1\n$$\n代入放大因子的表达式：\n$$\n\\frac{1/(1+4r)}{\\exp(-\\pi^2 r)} \\le 1.1 \\implies (1+4r)\\exp(-\\pi^2 r) \\ge \\frac{1}{1.1}\n$$\n令 $f(r) = (1+4r)\\exp(-\\pi^2 r)$。函数 $f(r)$ 对于 $r \\ge 0$ 是单调递减的，因为 $f'(r) = (4-\\pi^2 - 4\\pi^2 r)\\exp(-\\pi^2 r)  0$。因此，为了找到满足不等式的最大 $r$，我们解这个等式：\n$$\n(1+4r)\\exp(-\\pi^2 r) = \\frac{1}{1.1}\n$$\n这是一个关于 $r$ 的超越方程。通过数值求解（例如，使用像牛顿法这样的求根算法），我们得到 $r_{\\mathrm{imp}} \\approx 0.015913$。最大隐式时间步长 $\\Delta t_{\\mathrm{imp}}$ 基于此 $r$ 值。\n\n**第 4 部分：数值计算**\n\n已知 $\\nu_z = 10^{-2}\\,\\mathrm{m^2/s}$ 和 $\\Delta z = 1\\,\\mathrm{m}$。\n\n1.  **显式时间步长限制**：\n    $$\n    \\Delta t_{\\mathrm{exp}} = \\frac{\\Delta z^2}{2\\nu_z} = \\frac{(1\\,\\mathrm{m})^2}{2 \\times 10^{-2}\\,\\mathrm{m^2/s}} = \\frac{1}{0.02}\\,\\mathrm{s} = 50\\,\\mathrm{s}\n    $$\n2.  **隐式时间步长限制**：\n    使用精度限制的 CFL 数 $r_{\\mathrm{imp}} \\approx 0.015913$：\n    $$\n    \\Delta t_{\\mathrm{imp}} = \\frac{r_{\\mathrm{imp}} \\Delta z^2}{\\nu_z} = \\frac{0.015913 \\times (1\\,\\mathrm{m})^2}{10^{-2}\\,\\mathrm{m^2/s}} = 1.5913\\,\\mathrm{s}\n    $$\n    四舍五入到四位有效数字，我们得到 $\\Delta t_{\\mathrm{imp}} = 1.591\\,\\mathrm{s}$。\n\n最大稳定显式时间步长为 $50\\,\\mathrm{s}$。隐式时间步长虽然无条件稳定，但必须限制在 $1.591\\,\\mathrm{s}$ 以内，以满足对网格上可分辨的最短波长的指定精度约束。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 50  1.591 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "前面的练习主要关注线性问题，但真实的海洋模型充满了非线性项，例如底摩擦，这些项通常是“刚性”的，对显式方案的稳定性构成巨大挑战。本练习将带领您从理论走向实践，学习如何通过隐式方法处理非线性底摩擦项。您将推导出一个非线性方程，并设计一个牛顿迭代求解器来求解，这正是现代海洋模型中处理此类刚性非线性问题的核心技术之一。",
            "id": "3792416",
            "problem": "您需要为一个具有非线性二次底摩擦的垂直平均、深度积分的海洋动量模型，实现速度的隐式时间步更新。从一维、深度平均的水平速度 $u(t)$ 的动量平衡方程开始：\n$$\n\\frac{du}{dt} = F(t) - \\frac{\\tau(u)}{\\rho h},\n$$\n其中 $h$ 是恒定的水深，$\\rho$ 是水的密度，$F(t)$ 是一个已知的单位质量外部加速度（例如，由压力梯度或风应力除以密度和深度引起）。底应力由非线性摩擦定律给出：\n$$\n\\tau(u) = \\rho C_d \\lvert u \\rvert u,\n$$\n其中 $C_d$ 是一个已知的、恒定的拖曳系数。因此，控制方程简化为：\n$$\n\\frac{du}{dt} = F(t) - \\frac{C_d}{h} \\lvert u \\rvert u.\n$$\n考虑从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 的单个时间步，其中摩擦项被隐式处理，而外部加速度在时间 $t^n$ 被显式处理。使用一个与时间上一阶精度一致的单步法，推导出以 $u^n$、$\\Delta t$、$C_d$、$h$ 和 $F^n \\equiv F(t^n)$ 表示的、确定 $u^{n+1}$ 的标量非线性方程。分析此标量方程的结构，以证明解 $u^{n+1}$ 的存在性和唯一性。\n\n设计一个稳健的牛顿迭代法来求解 $u^{n+1}$，该方法应满足：\n- 从初始猜测 $u^{(0)} = u^n$ 开始。\n- 在标量残差关于 $u$ 的导数存在的地方使用其精确导数，并在 $u=0$ 处使用一个数学上一致的值。\n- 当残差的绝对值小于预设公差，或连续迭代值之差小于预设公差时终止。\n- 使用最大迭代次数上限以确保在所有情况下都能终止。如果一个完整的牛顿步没有减小绝对残差，则应用回溯策略，将步长减半，直到残差减小或步长变得足够小。\n\n实现一个程序，为以下每个测试用例计算 $u^{n+1}$。所有物理量必须使用国际单位制（SI）处理：速度单位为米/秒（$\\mathrm{m/s}$），时间单位为秒（$\\mathrm{s}$），深度单位为米（$\\mathrm{m}$）。拖曳系数 $C_d$ 是无量纲的，外部加速度 $F^n$ 的单位为米/秒平方（$\\mathrm{m/s^2}$）。您的程序必须将测试套件得到的速度 $u^{n+1}$ 列表作为单行输出，格式为一个用方括号括起来的逗号分隔列表，没有空格，每个数字四舍五入到八位小数，且每个条目的隐含单位是 $\\mathrm{m/s}$。\n\n测试套件（每个元组为 $(u^n,\\Delta t,C_d,h,F^n)$，单位为 $(\\mathrm{m/s},\\mathrm{s},-,\\mathrm{m},\\mathrm{m/s^2})$）：\n- 情况 A（一般情况）：$(0.5, 600.0, 2.5\\times 10^{-3}, 50.0, 1.0\\times 10^{-4})$\n- 情况 B（边界，零状态）：$(0.0, 600.0, 3.0\\times 10^{-3}, 20.0, 0.0)$\n- 情况 C（符号变化趋势）：$(-0.2, 3600.0, 3.0\\times 10^{-3}, 10.0, 5.0\\times 10^{-4})$\n- 情况 D（刚性摩擦，大时间步）：$(2.0, 21600.0, 3.0\\times 10^{-3}, 5.0, 0.0)$\n- 情况 E（深水，弱摩擦）：$(-1.5, 900.0, 1.0\\times 10^{-3}, 500.0, -2.0\\times 10^{-4})$\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果，没有空格，每个条目四舍五入到八位小数，例如：\"[0.12345678,-0.87654321,0.00000000]\"。",
            "solution": "该问题要求推导并实现一个针对带非线性二次底摩擦的一维、深度平均动量方程的一阶半隐式时间步方案。新时间步的速度解 $u^{n+1}$ 涉及使用稳健的牛顿-拉夫逊方法求解一个标量非线性方程。\n\n### 半隐式方案的推导\n\n水平速度 $u(t)$ 的控制常微分方程如下：\n$$\n\\frac{du}{dt} = F(t) - \\frac{C_d}{h} \\lvert u \\rvert u\n$$\n其中 $u$ 是速度，$t$ 是时间，$F(t)$ 是外部加速度，$C_d$ 是无量纲拖曳系数，$h$ 是恒定水深。\n\n为了推导一个时间上具有一阶精度的数值方案，我们使用向前差分来离散化时间导数，时间步长为 $\\Delta t = t^{n+1} - t^n$：\n$$\n\\frac{du}{dt} \\approx \\frac{u^{n+1} - u^n}{\\Delta t}\n$$\n问题指定了一个半隐式方案，其中外部加速度 $F(t)$ 被显式处理（在时间 $t^n$ 评估），而非线性摩擦项被隐式处理（在时间 $t^{n+1}$ 评估）。这种方法通常称为 IMEX（隐式-显式），是通过隐式处理像摩擦这样的刚性项来提高稳定性的标准方法。\n\n将离散化的时间导数与离散化的右侧项相等，得到：\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = F^n - \\frac{C_d}{h} \\lvert u^{n+1} \\rvert u^{n+1}\n$$\n其中 $u^n = u(t^n)$，$u^{n+1} = u(t^{n+1})$，以及 $F^n = F(t^n)$。\n\n为了求解未知数 $u^{n+1}$，我们将此方程重排为标准的求根形式 $R(x)=0$，其中 $x = u^{n+1}$。\n两边乘以 $\\Delta t$ 并重新整理各项，我们得到：\n$$\nu^{n+1} - u^n = \\Delta t F^n - \\frac{\\Delta t C_d}{h} \\lvert u^{n+1} \\rvert u^{n+1}\n$$\n$$\nu^{n+1} + \\frac{\\Delta t C_d}{h} \\lvert u^{n+1} \\rvert u^{n+1} - u^n - \\Delta t F^n = 0\n$$\n这就是关于 $u^{n+1}$ 的标量非线性方程。为方便起见，我们为给定的时间步定义两个常数：无量纲摩擦参数 $\\alpha = \\frac{\\Delta t C_d}{h}$ 和显式预测项 $\\beta = u^n + \\Delta t F^n$。关于 $x = u^{n+1}$ 的方程简化为：\n$$\nx + \\alpha \\lvert x \\rvert x - \\beta = 0\n$$\n因此，需要通过牛顿迭代求解的残差函数是：\n$$\nR(x) = x + \\alpha \\lvert x \\rvert x - \\beta\n$$\n\n### 解的存在性与唯一性\n\n为了证明解 $u^{n+1}$ 的存在性和唯一性，我们分析函数 $g(x) = x + \\alpha \\lvert x \\rvert x$ 的性质。需要求解的方程是 $g(x) = \\beta$。\n\n物理参数 $\\Delta t$、$C_d$ 和 $h$ 都是严格为正的，所以系数 $\\alpha = \\frac{\\Delta t C_d}{h}$ 也严格为正。\n\n我们研究 $g(x)$ 对 $x$ 的导数。项 $\\lvert x \\rvert x$ 对于 $x \\geq 0$ 可写为 $x^2$，对于 $x  0$ 可写为 $-x^2$。它对 $x$ 的导数，当 $x>0$ 时是 $2x$，当 $x0$ 时是 $-2x$。在 $x=0$ 处，函数 $\\lvert x \\rvert x$ 是可微的，其导数为 $0$。因此，$\\lvert x \\rvert x$ 的导数对所有 $x \\in \\mathbb{R}$ 都是 $2\\lvert x \\rvert$。\n\n函数 $g(x)$ 的导数则为：\n$$\ng'(x) = \\frac{d}{dx} (x + \\alpha \\lvert x \\rvert x) = 1 + \\alpha \\frac{d}{dx}(\\lvert x \\rvert x) = 1 + 2\\alpha \\lvert x \\rvert\n$$\n由于 $\\alpha > 0$ 且 $\\lvert x \\rvert \\geq 0$，导数 $g'(x)$ 总是大于或等于 $1$：\n$$\ng'(x) = 1 + 2\\alpha \\lvert x \\rvert \\ge 1 \\quad \\forall x \\in \\mathbb{R}\n$$\n一个导数严格为正的函数是严格单调递增的。一个严格单调的函数是单射的（一对一）。\n\n此外，我们考察 $g(x)$ 的极限：\n- 当 $x \\to \\infty$ 时，$g(x) = x(1 + \\alpha x) \\to \\infty$。\n- 当 $x \\to -\\infty$ 时，$g(x) = x(1 - \\alpha x) \\to -\\infty$。\n\n由于 $g(x)$ 是连续的，且其值域为 $(-\\infty, \\infty)$，根据介值定理，对于任何实数 $\\beta$，保证存在至少一个 $x$ 使得 $g(x) = \\beta$。结合严格单调性（这意味着单射性），我们得出结论：对于任何给定的 $\\beta$，存在唯一的实数解 $x = u^{n+1}$。这确保了该问题是适定的。\n\n### 牛顿迭代方案\n\n我们使用牛顿-拉夫逊方法求解非线性方程 $R(x) = 0$。迭代更新公式为：\n$$\nx^{(k+1)} = x^{(k)} - \\frac{R(x^{(k)})}{R'(x^{(k)})}\n$$\n其中 $x^{(k)}$ 是在第 $k$ 次迭代时对根的估计。\n\n- **残差及其导数**：\n  残差是 $R(x) = x + \\alpha \\lvert x \\rvert x - \\beta$。\n  其导数，如为 $g'(x)$ 推导的那样，是 $R'(x) = 1 + 2\\alpha \\lvert x \\rvert$。这个导数对于所有 $x$（包括 $x=0$）都是连续且良定义的，在 $x=0$ 处 $R'(0) = 1$。问题中关于“在 $u=0$ 处使用一个数学上一致的值”的要求自然得到满足。\n\n- **初始猜测**：如指定，迭代从前一个时间步的速度开始：$x^{(0)} = u^n$。\n\n- **迭代更新**：牛顿步长 $\\Delta x^{(k)}$ 计算如下：\n  $$\n  \\Delta x^{(k)} = - \\frac{R(x^{(k)})}{R'(x^{(k)})} = - \\frac{x^{(k)} + \\alpha \\lvert x^{(k)} \\rvert x^{(k)} - \\beta}{1 + 2\\alpha \\lvert x^{(k)} \\rvert}\n  $$\n  下一次迭代值为 $x^{(k+1)} = x^{(k)} + \\Delta x^{(k)}$。\n\n- **回溯线搜索**：为了增强稳健性，特别是对于较差的初始猜测，采用了回溯策略。如果一个完整的牛顿步（步长 $\\lambda=1$）没有减小残差的绝对值（即 $|R(x^{(k+1)})| \\ge |R(x^{(k)})|$），步长 $\\lambda$ 将被连续减半（$\\lambda \\to \\lambda/2$）。更新变为 $x^{(k+1)} = x^{(k)} + \\lambda \\Delta x^{(k)}$。重复此过程，直到获得更小的残差或 $\\lambda$ 低于某个最小阈值。\n\n- **终止准则**：当满足以下任一条件时，迭代终止：\n  1. 残差的绝对值低于指定的公差 $\\epsilon_{res}$：$|R(x^{(k+1)})|  \\epsilon_{res}$。\n  2. 连续迭代值之间的绝对差低于公差 $\\epsilon_{step}$：$|x^{(k+1)} - x^{(k)}|  \\epsilon_{step}$。\n  3. 达到最大迭代次数 $k_{max}$。这是防止不收敛的保障措施。\n\n这种稳健的牛顿求解器与回溯线搜索的结合，为寻找唯一解 $u^{n+1}$ 提供了一种高效可靠的方法。",
            "answer": "[0.55109537,0.00000000,0.44199972,0.07683473,-1.67809629]"
        }
    ]
}