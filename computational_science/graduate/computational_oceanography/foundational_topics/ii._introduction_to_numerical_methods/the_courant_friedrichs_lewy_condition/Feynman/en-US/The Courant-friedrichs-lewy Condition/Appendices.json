{
    "hands_on_practices": [
        {
            "introduction": "Our first practice focuses on the fundamental application of the Courant-Friedrichs-Lewy (CFL) condition. By working with the one-dimensional linear advection equation, you will directly manipulate the core parameters of a numerical simulation—propagation speed, grid spacing, and the time step. This exercise  is designed to build a foundational understanding of how the Courant number links the physical properties of a system to the numerical grid, a crucial first step for designing any stable explicit scheme.",
            "id": "2139558",
            "problem": "A team of computational scientists is simulating the propagation of a signal along a one-dimensional transmission line. The behavior of the signal's voltage, $u(x, t)$, is modeled by the linear advection equation:\n$$ \\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = 0 $$\nwhere $v$ is the constant propagation speed of the signal.\n\nThe simulation uses a finite difference scheme on a grid with a uniform spatial step size of $\\Delta x$. The chosen numerical method is known to be stable only if the Courant-Friedrichs-Lewy (CFL) condition is satisfied. The Courant number, $C$, is defined as $C = |v| \\frac{\\Delta t}{\\Delta x}$, where $\\Delta t$ is the time step.\n\nFor this specific simulation, the propagation speed is $v = 2.5 \\times 10^8$ m/s, and the spatial step is $\\Delta x = 1.25$ cm. To ensure high accuracy and avoid numerical oscillations, the team decides to operate at a Courant number of exactly $C = 0.75$.\n\nWhat is the required time step, $\\Delta t$, for this simulation? Express your answer in nanoseconds (ns), rounded to two significant figures.",
            "solution": "We use the Courant number definition for the linear advection equation discretization:\n$$\nC=\\frac{|v|\\,\\Delta t}{\\Delta x}.\n$$\nSolving for the time step gives\n$$\n\\Delta t=\\frac{C\\,\\Delta x}{|v|}.\n$$\nSubstitute the given values, converting the spatial step to meters: $\\Delta x=1.25\\times 10^{-2}\\ \\text{m}$, $|v|=2.5\\times 10^{8}\\ \\text{m s}^{-1}$, and $C=0.75$:\n$$\n\\Delta t=\\frac{0.75\\,(1.25\\times 10^{-2})}{2.5\\times 10^{8}}\\ \\text{s}.\n$$\nCompute the numerical factor:\n$$\n\\Delta t=\\frac{0.9375\\times 10^{-2}}{2.5\\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{0.9375}{2.5}\\right)\\times 10^{-10}\\ \\text{s}\n=0.375\\times 10^{-10}\\ \\text{s}\n=3.75\\times 10^{-11}\\ \\text{s}.\n$$\nConvert to nanoseconds using $1\\ \\text{ns}=10^{-9}\\ \\text{s}$:\n$$\n\\Delta t=3.75\\times 10^{-11}\\ \\text{s}=3.75\\times 10^{-2}\\ \\text{ns}=0.0375\\ \\text{ns}.\n$$\nRounding to two significant figures yields $0.038\\ \\text{ns}$.",
            "answer": "$$\\boxed{0.038}$$"
        },
        {
            "introduction": "Numerical instability is a common pitfall in computational modeling, often manifesting as non-physical oscillations or catastrophic floating-point overflows. This practice  places you in the role of a debugger tasked with diagnosing a failing simulation of the linear advection equation. You will apply Von Neumann stability analysis to derive the CFL limit for the upwind scheme and use this theoretical foundation to identify the cause of the error and calculate a robust, stable time step.",
            "id": "3220109",
            "problem": "A developer reports that a one-dimensional explicit finite-difference solver for the linear advection equation produces \"Not a Number\" values, and suspects the time step selection is incorrect. You must diagnose the stability error and compute a corrected time step using the Courant-Friedrichs-Lewy (CFL) condition. Work in purely mathematical terms and use dimensioned physical units consistently.\n\nConsider the linear advection equation\n$$\nu_t + a\\,u_x = 0,\n$$\nwhere $u(x,t)$ is a scalar field, $a$ is a constant advection speed, $x$ is position, and $t$ is time. The solver uses a uniform grid of $n_x$ points over a periodic domain of length $L$, with grid spacing $\\Delta x = L / n_x$. The solver uses an explicit first-order upwind scheme with forward time stepping. For $a > 0$, the spatial discretization is the Forward-Time Backward-Space (FTBS) scheme,\n$$\nu_j^{n+1} = u_j^n - C\\left(u_j^n - u_{j-1}^n\\right),\n$$\nand for $a  0$, it switches to the Forward-Time Forward-Space (FTFS) scheme,\n$$\nu_j^{n+1} = u_j^n - C\\left(u_{j+1}^n - u_j^n\\right),\n$$\nwhere $C$ is the Courant number\n$$\nC = \\frac{a\\,\\Delta t}{\\Delta x},\n$$\n$\\Delta t$ is the time step, $j$ indexes grid points, and $n$ indexes time steps. The code initializes $u(x,0)$ to a smooth periodic field and evolves using periodic boundary conditions.\n\nStarting from the fundamental base that solutions to linear constant-coefficient difference equations can be analyzed via discrete Fourier modes, and that explicit advection schemes require the wave information not to outrun the numerical stencil, derive the stability constraint on $C$ that ensures the amplification factor does not exceed unity in magnitude. Then use this to explain why an incorrectly calculated time step may cause growth so rapid that floating-point overflow yields \"Not a Number\" values in subsequent arithmetic. Finally, compute a corrected, CFL-limited $\\Delta t$ with a strict safety factor to avoid borderline equality.\n\nYour task is to write a program that, for each provided test case:\n- Computes $\\Delta x = L/n_x$.\n- Computes the Courant number $C = a\\,\\Delta t_{\\mathrm{buggy}}/\\Delta x$ using the provided (possibly incorrect) time step $\\Delta t_{\\mathrm{buggy}}$.\n- Determines a boolean flag that is true if the CFL stability criterion is violated (and therefore the code is expected to produce \"Not a Number\" values due to instability), and false otherwise. Use the logically derived criterion you establish; do not simulate the partial differential equation.\n- Computes a corrected time step in seconds as\n$$\n\\Delta t_{\\mathrm{correct}} = s \\frac{\\Delta x}{|a|},\n$$\nwhere $s$ is a strict safety factor $s = 0.9$.\n\nExpress all time steps in seconds. Angles, if any, must be in radians, but no angle inputs or outputs are used here. The final output should aggregate, for each test case in order, the instability boolean followed immediately by the corrected time step as a float. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example\n$$\n[\\text{true},0.0045,\\text{false},0.006]\n$$\nusing lowercase literals \"true\" or \"false\" or their programming-language equivalents.\n\nUse the following test suite, which covers a general case, a boundary case, a negative-speed case, and a couple of additional edge cases:\n1. $a = 2.0$ $\\mathrm{m/s}$, $L = 1.0$ $\\mathrm{m}$, $n_x = 100$, $\\Delta t_{\\mathrm{buggy}} = 0.006$ $\\mathrm{s}$.\n2. $a = 1.5$ $\\mathrm{m/s}$, $L = 2.0$ $\\mathrm{m}$, $n_x = 200$, $\\Delta t_{\\mathrm{buggy}} = L/(n_x a)$ $\\mathrm{s}$ (i.e., $\\Delta t_{\\mathrm{buggy}} = \\Delta x/a$) exactly at the stability boundary.\n3. $a = -3.0$ $\\mathrm{m/s}$, $L = 1.0$ $\\mathrm{m}$, $n_x = 100$, $\\Delta t_{\\mathrm{buggy}} = 0.8\\,L/|a|$ $\\mathrm{s}$ (a bug caused by using the domain length instead of the grid spacing).\n4. $a = 0.5$ $\\mathrm{m/s}$, $L = 1.0$ $\\mathrm{m}$, $n_x = 400$, $\\Delta t_{\\mathrm{buggy}} = 0.004$ $\\mathrm{s}$.\n5. $a = 2.0$ $\\mathrm{m/s}$, $L = 1.0$ $\\mathrm{m}$, $n_x = 50$, $\\Delta t_{\\mathrm{buggy}} = 0.012$ $\\mathrm{s}$.\n\nYour program must use only the provided parameters for each case, perform the calculations described, and output a single list combining the instability booleans and corrected time steps in seconds in the specified format.",
            "solution": "The problem requires an analysis of the numerical stability of a first-order upwind scheme for the linear advection equation, $u_t + a\\,u_x = 0$. This analysis will be used to diagnose reported floating-point errors and to compute a corrected, stable time step, $\\Delta t$. The core of the analysis is to derive the Courant-Friedrichs-Lewy (CFL) condition for the given scheme using Von Neumann stability analysis.\n\nA numerical scheme is stable if errors (such as round-off errors) do not grow in an unbounded manner as the simulation progresses. For linear, constant-coefficient partial differential equations on a periodic domain, Von Neumann analysis examines the amplification of individual Fourier modes of the solution. We represent a component of the numerical solution at time level $n$ and spatial position $j$ as a single Fourier mode:\n$$\nu_j^n = \\hat{u}^n(k) e^{i k x_j}\n$$\nwhere $k$ is the wavenumber, $x_j = j\\Delta x$ is the grid point location, $i = \\sqrt{-1}$, and $\\hat{u}^n(k)$ is the amplitude of the mode at time step $n$. The stability of the scheme depends on the amplification factor, $G(k)$, defined by the relation $\\hat{u}^{n+1}(k) = G(k) \\hat{u}^n(k)$. For stability, it is necessary that the magnitude of the amplification factor does not exceed unity for all possible wavenumbers, i.e., $|G(k)| \\leq 1$.\n\nThe problem specifies two schemes based on the sign of the advection speed $a$. We analyze each case separately.\n\n**Case 1: $a > 0$, Forward-Time Backward-Space (FTBS) Scheme**\n\nThe FTBS scheme is given by:\n$$\nu_j^{n+1} = u_j^n - C(u_j^n - u_{j-1}^n)\n$$\nwhere $C = a\\,\\Delta t/\\Delta x$ is the Courant number. Since $a > 0$, $\\Delta t > 0$, and $\\Delta x > 0$, we have $C > 0$. Substituting the Fourier mode into the difference equation yields:\n$$\n\\hat{u}^{n+1}(k) e^{i k j \\Delta x} = \\hat{u}^n(k) e^{i k j \\Delta x} - C \\left( \\hat{u}^n(k) e^{i k j \\Delta x} - \\hat{u}^n(k) e^{i k (j-1) \\Delta x} \\right)\n$$\nDividing by $\\hat{u}^n(k) e^{i k j \\Delta x}$ gives the amplification factor $G(k)$:\n$$\nG(k) = \\frac{\\hat{u}^{n+1}(k)}{\\hat{u}^n(k)} = 1 - C(1 - e^{-i k \\Delta x})\n$$\nTo find the stability constraint, we evaluate the squared magnitude of $G(k)$:\n$$\n|G(k)|^2 = |1 - C(1 - \\cos(k \\Delta x) + i \\sin(k \\Delta x))|^2\n$$\n$$\n|G(k)|^2 = |(1 - C + C\\cos(k \\Delta x)) - i C\\sin(k \\Delta x)|^2\n$$\n$$\n|G(k)|^2 = (1 - C + C\\cos(k \\Delta x))^2 + (- C\\sin(k \\Delta x))^2\n$$\n$$\n|G(k)|^2 = (1 - C)^2 + 2C(1-C)\\cos(k \\Delta x) + C^2\\cos^2(k \\Delta x) + C^2\\sin^2(k \\Delta x)\n$$\n$$\n|G(k)|^2 = 1 - 2C + C^2 + 2C\\cos(k \\Delta x) - 2C^2\\cos(k \\Delta x) + C^2\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos(k \\Delta x) = 1 - 2C(1-C)(1 - \\cos(k \\Delta x))\n$$\nUsing the identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$\n|G(k)|^2 = 1 - 4C(1-C)\\sin^2(k \\Delta x/2)\n$$\nFor stability, we require $|G(k)|^2 \\leq 1$. This implies $1 - 4C(1-C)\\sin^2(k \\Delta x/2) \\leq 1$, which simplifies to $-4C(1-C)\\sin^2(k \\Delta x/2) \\leq 0$. Since $\\sin^2(k \\Delta x/2) \\geq 0$, this requires $C(1-C) \\geq 0$. As $C > 0$, the condition becomes $1-C \\geq 0$, or $C \\leq 1$. Thus, for $a>0$, the stability condition is $0 \\leq C \\leq 1$.\n\n**Case 2: $a  0$, Forward-Time Forward-Space (FTFS) Scheme**\n\nThe FTFS scheme is given by:\n$$\nu_j^{n+1} = u_j^n - C(u_{j+1}^n - u_j^n)\n$$\nHere, $C = a\\,\\Delta t/\\Delta x$ is negative. Substituting the Fourier mode:\n$$\n\\hat{u}^{n+1}(k) e^{i k j \\Delta x} = \\hat{u}^n(k) e^{i k j \\Delta x} - C \\left( \\hat{u}^n(k) e^{i k (j+1) \\Delta x} - \\hat{u}^n(k) e^{i k j \\Delta x} \\right)\n$$\nThe amplification factor is:\n$$\nG(k) = 1 - C(e^{i k \\Delta x} - 1)\n$$\nFollowing a similar procedure for its squared magnitude:\n$$\n|G(k)|^2 = |1 - C(\\cos(k \\Delta x) - 1) - i C \\sin(k \\Delta x)|^2\n$$\n$$\n|G(k)|^2 = (1 - C(\\cos(k \\Delta x) - 1))^2 + (-C \\sin(k \\Delta x))^2\n$$\n$$\n|G(k)|^2 = 1 + 2C(1 - \\cos(k \\Delta x)) + C^2(1 - \\cos(k \\Delta x))^2 + C^2 \\sin^2(k \\Delta x)\n$$\n$$\n|G(k)|^2 = 1 + 2C(1 - \\cos(k \\Delta x)) + C^2((1-2\\cos(k \\Delta x)+\\cos^2(k \\Delta x)) + \\sin^2(k \\Delta x)) = 1 + 2C(1-\\cos(k \\Delta x)) + 2C^2(1-\\cos(k \\Delta x))\n$$\n$$\n|G(k)|^2 = 1 + (2C + 2C^2)(1 - \\cos(k \\Delta x)) = 1 + 2C(1+C)(1 - \\cos(k \\Delta x))\n$$\nThe stability condition $|G(k)|^2 \\leq 1$ requires $2C(1+C)(1 - \\cos(k \\Delta x)) \\leq 0$. Since $1 - \\cos(k \\Delta x) \\geq 0$, this means $C(1+C) \\leq 0$. As $C  0$, the condition becomes $1+C \\geq 0$, or $C \\geq -1$. Thus, for $a0$, the stability condition is $-1 \\leq C \\leq 0$.\n\n**Combined Stability Condition (CFL Condition)**\n\nCombining both cases, the first-order upwind scheme is stable if and only if:\n- $0 \\leq C \\leq 1$ for $a > 0$\n- $-1 \\leq C \\leq 0$ for $a  0$\n\nThis can be expressed compactly using the absolute value of the Courant number:\n$$\n|C| = \\left|\\frac{a \\Delta t}{\\Delta x}\\right| = \\frac{|a| \\Delta t}{\\Delta x} \\leq 1\n$$\nThis is the CFL condition for this scheme. It has a clear physical interpretation: the numerical domain of dependence ($[x_{j-1}, x_j]$ for FTBS, $[x_j, x_{j+1}]$ for FTFS) must contain the physical domain of dependence of the point $(x_j, t^{n+1})$. In one time step $\\Delta t$, the characteristic wave travels a distance $a \\Delta t$. The condition $|a \\Delta t| \\leq \\Delta x$ ensures this information does not travel further than one grid cell, thus remaining within the stencil.\n\n**Cause of \"Not a Number\" (NaN) Errors**\n\nWhen the stability condition is violated, i.e., $|C| > 1$, the amplification factor $|G(k)|$ will be greater than $1$ for some wavenumbers. The amplitude of these Fourier modes will grow exponentially with each time step. For example, for FTBS with $C > 1$, the fastest growing mode has $|G| = 2C-1 > 1$. After $N$ steps, its amplitude is multiplied by $(2C-1)^N$. This extremely rapid growth quickly exceeds the maximum representable value for standard floating-point data types (e.g., ~$1.8 \\times 10^{308}$ for double precision), resulting in a value of `inf` (infinity). Subsequent arithmetic operations, such as `inf - inf`, are undefined and produce `NaN` (Not a Number), which then contaminates the entire solution array.\n\n**Computational Task**\n\nThe program will implement the derived condition. For each test case, it will:\n1.  Compute the grid spacing $\\Delta x = L/n_x$.\n2.  Compute the effective Courant number using the provided potentially incorrect time step $\\Delta t_{\\mathrm{buggy}}$: $C'_{\\mathrm{buggy}} = |a|\\Delta t_{\\mathrm{buggy}}/\\Delta x$.\n3.  Determine if the scheme is unstable. This occurs if $C'_{\\mathrm{buggy}} > 1$. The case $C'_{\\mathrm{buggy}} = 1$ is an edge case but is considered stable.\n4.  Compute a corrected, safe time step $\\Delta t_{\\mathrm{correct}}$. We enforce a Courant number of $s = 0.9$ as a safety factor:\n    $$\n    s = \\frac{|a| \\Delta t_{\\mathrm{correct}}}{\\Delta x} \\implies \\Delta t_{\\mathrm{correct}} = s \\frac{\\Delta x}{|a|} = 0.9 \\frac{\\Delta x}{|a|}\n    $$\n\nThis procedure provides a direct diagnosis of the instability and a robust correction based on the fundamental principles of numerical stability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stability of a first-order upwind scheme for several test cases,\n    determines if the given time step leads to instability, and computes a\n    corrected, stable time step based on the CFL condition.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains: (a, L, n_x, dt_buggy_str)\n    # dt_buggy_str is a string to be evaluated.\n    test_cases = [\n        (2.0, 1.0, 100, \"0.006\"),\n        (1.5, 2.0, 200, \"L/(n_x * a)\"),\n        (-3.0, 1.0, 100, \"0.8 * L / abs(a)\"),\n        (0.5, 1.0, 400, \"0.004\"),\n        (2.0, 1.0, 50, \"0.012\"),\n    ]\n\n    results = []\n    safety_factor = 0.9\n\n    for a, L, n_x, dt_buggy_str in test_cases:\n        # Evaluate the potentially buggy time step using the provided formula\n        # This allows handling cases like dt = L/(n_x*a)\n        dt_buggy = eval(dt_buggy_str, {\"L\": L, \"n_x\": n_x, \"a\": a})\n        \n        # 1. Compute grid spacing dx\n        dx = L / n_x\n        \n        # 2. Compute the Courant number for the buggy timestep\n        # The CFL condition is based on the magnitude of the velocity\n        # C' = |a|*dt/dx\n        # Handle the case a=0 to avoid division by zero, though not in test set.\n        if a == 0:\n            courant_buggy = 0.0 # Any timestep is stable if a=0\n        else:\n            courant_buggy = np.abs(a) * dt_buggy / dx\n            \n        # 3. Determine if the stability criterion is violated\n        # The first-order upwind scheme is unstable if C'  1.\n        # The case C'=1 is marginally stable.\n        is_unstable = courant_buggy  1.0\n        \n        # 4. Compute the corrected, CFL-limited time step with a safety factor\n        # dt_correct = s * dx / |a|\n        if a == 0:\n            # If a is 0, the equation is u_t=0, any dt is stable.\n            # We can set dt_correct to a large number, e.g., representing infinity\n            # For this problem, we just need a valid float. Let's use dt_buggy or 1.0\n            dt_correct = 1.0 \n        else:\n            dt_correct = safety_factor * dx / np.abs(a)\n            \n        results.append(str(is_unstable).lower())\n        results.append(dt_correct)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "We now elevate our analysis from one-dimensional models to a scenario of direct relevance in computational oceanography: simulating basin-scale dynamics. This advanced practice  addresses the stability of an explicit time-stepping scheme for the two-dimensional shallow-water equations, the foundation of barotropic ocean models. By calculating the maximum permissible time step for a realistic model of the Atlantic Ocean, you will gain a critical appreciation for why the CFL condition, driven by fast-moving surface gravity waves with speed $c = \\sqrt{gH}$, imposes such a stringent constraint on model performance and design.",
            "id": "3814555",
            "problem": "Consider a split-explicit barotropic update for a basin-scale ocean model intended to represent the Atlantic, with uniform horizontal grid spacing and constant depth. The external (barotropic) mode is governed by the linearized, inviscid shallow-water equations on an $f$-plane, linearized about a state of rest:\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x}, \\quad\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y}, \\quad\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0,\n$$\nwhere $u$ and $v$ are the barotropic velocities, $\\eta$ is the free-surface elevation, $g$ is gravitational acceleration, $H$ is the constant depth, and $f$ is the Coriolis parameter. Assume that for the purpose of the stability constraint of fast barotropic gravity waves one may neglect the Coriolis terms when estimating the most restrictive Courant-Friedrichs-Lewy (CFL) condition.\n\nThe external mode is advanced explicitly with a standard forward–backward time-stepping and second-order centered spatial differences on a uniform square grid with $\\Delta x = \\Delta y$. Denote the time step by $\\Delta t$. Perform a von Neumann stability analysis of the discrete scheme for plane-wave solutions to derive the CFL stability requirement in terms of the external gravity-wave speed, the grid spacing, and the time step. Then, using $ \\Delta x = 10\\,\\text{km}$, $ \\Delta y = 10\\,\\text{km}$, $ H = 4000\\,\\text{m}$, and $ g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$, compute the maximum stable $\\Delta t$ implied by the barotropic CFL constraint.\n\nFinally, briefly discuss the implications of this $\\Delta t$ for representing the principal lunar semidiurnal ($\\mathrm{M2}$) tide with an explicitly integrated external mode, noting its period $T_{\\mathrm{M2}} \\approx 12.42\\,\\text{hours}$, and the resulting sampling and computational considerations.\n\nExpress the final numerical answer for the maximum stable $\\Delta t$ in seconds (s) and round your answer to three significant figures. The final answer must be a single real-valued number.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of geophysical fluid dynamics and numerical analysis, is well-posed, and all necessary information is provided.\n\nThe first step is to derive the Courant-Friedrichs-Lewy (CFL) stability requirement for the given system. The problem asks to neglect the Coriolis terms ($f=0$) for the purpose of analyzing the stability constraint imposed by fast barotropic gravity waves. The linearized shallow-water equations then simplify to:\n$$\n\\frac{\\partial u}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{\\partial v}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial y}\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0\n$$\nTo analyze the propagation of gravity waves, we can combine these three first-order partial differential equations (PDEs) into a single second-order PDE for the free-surface elevation $\\eta$. We differentiate the third equation with respect to time $t$:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + H\\left(\\frac{\\partial}{\\partial t}\\frac{\\partial u}{\\partial x} + \\frac{\\partial}{\\partial t}\\frac{\\partial v}{\\partial y}\\right) = 0\n$$\nAssuming the fields are sufficiently smooth, we can swap the order of differentiation:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + H\\left(\\frac{\\partial}{\\partial x}\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial y}\\frac{\\partial v}{\\partial t}\\right) = 0\n$$\nNow, substitute the first two equations (the momentum equations) into this expression:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + H\\left(\\frac{\\partial}{\\partial x}\\left(-g \\frac{\\partial \\eta}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(-g \\frac{\\partial \\eta}{\\partial y}\\right)\\right) = 0\n$$\nSince $g$ and $H$ are constants, we obtain the two-dimensional linear wave equation:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} = gH \\left(\\frac{\\partial^2 \\eta}{\\partial x^2} + \\frac{\\partial^2 \\eta}{\\partial y^2}\\right)\n$$\nThis equation describes the propagation of waves with a phase speed $c = \\sqrt{gH}$.\n\nNext, we perform a von Neumann stability analysis on the discretized form of this wave equation. The problem specifies second-order centered differences for space and a standard explicit time-stepping scheme, which for the second-order wave equation is the centered-in-time, centered-in-space (CTCS) or leapfrog scheme. Let $\\eta_{j,k}^n$ denote the numerical approximation of $\\eta(j\\Delta x, k\\Delta y, n\\Delta t)$. The discretized equation is:\n$$\n\\frac{\\eta_{j,k}^{n+1} - 2\\eta_{j,k}^n + \\eta_{j,k}^{n-1}}{(\\Delta t)^2} = c^2 \\left( \\frac{\\eta_{j+1,k}^n - 2\\eta_{j,k}^n + \\eta_{j-1,k}^n}{(\\Delta x)^2} + \\frac{\\eta_{j,k+1}^n - 2\\eta_{j,k}^n + \\eta_{j,k-1}^n}{(\\Delta y)^2} \\right)\n$$\nWe seek solutions of the form of a single Fourier mode:\n$$\n\\eta_{j,k}^n = \\lambda^n \\exp(i(k_x j \\Delta x + k_y k \\Delta y))\n$$\nwhere $\\lambda$ is the amplification factor, $k_x$ and $k_y$ are the components of the wavenumber vector, and $i = \\sqrt{-1}$. Substituting this into the finite-difference equation yields:\n$$\n\\frac{\\lambda^{n+1} - 2\\lambda^n + \\lambda^{n-1}}{(\\Delta t)^2} \\exp(i(k_x j \\Delta x + k_y k \\Delta y)) = c^2 \\lambda^n \\left[ \\frac{\\exp(ik_x(j+1)\\Delta x) - 2\\exp(ik_xj\\Delta x) + \\exp(ik_x(j-1)\\Delta x)}{(\\Delta x)^2} + \\dots \\right] \\exp(i(k_y k \\Delta y))\n$$\nDividing by $\\lambda^{n-1} \\exp(i(k_x j \\Delta x + k_y k \\Delta y))$ gives:\n$$\n\\frac{\\lambda^2 - 2\\lambda + 1}{(\\Delta t)^2} = c^2 \\lambda \\left[ \\frac{\\exp(ik_x\\Delta x) - 2 + \\exp(-ik_x\\Delta x)}{(\\Delta x)^2} + \\frac{\\exp(ik_y\\Delta y) - 2 + \\exp(-ik_y\\Delta y)}{(\\Delta y)^2} \\right]\n$$\nUsing the identity $2\\cos\\theta = e^{i\\theta} + e^{-i\\theta}$, this becomes:\n$$\n\\frac{\\lambda^2 - 2\\lambda + 1}{(\\Delta t)^2} = c^2 \\lambda \\left[ \\frac{2\\cos(k_x\\Delta x) - 2}{(\\Delta x)^2} + \\frac{2\\cos(k_y\\Delta y) - 2}{(\\Delta y)^2} \\right]\n$$\nUsing the half-angle identity $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$\n\\lambda^2 - 2\\lambda + 1 = -4 c^2 (\\Delta t)^2 \\lambda \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right]\n$$\nThis is a quadratic equation for the amplification factor $\\lambda$:\n$$\n\\lambda^2 - 2\\lambda \\left( 1 - 2 c^2 (\\Delta t)^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right] \\right) + 1 = 0\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must satisfy $|\\lambda| \\le 1$. A a quadratic equation of the form $\\lambda^2 - 2B\\lambda + 1 = 0$ has roots with magnitude equal to $1$ if and only if $|B| \\le 1$. In our case,\n$$\nB = 1 - 2 c^2 (\\Delta t)^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right]\n$$\nThe condition $B \\le 1$ is always satisfied since the term subtracted from $1$ is non-negative. The stability condition is therefore determined by $B \\ge -1$:\n$$\n1 - 2 c^2 (\\Delta t)^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right] \\ge -1\n$$\n$$\nc^2 (\\Delta t)^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right] \\le 1\n$$\nThis condition must hold for all possible wavenumbers. The most restrictive (worst-case) scenario occurs when the left-hand side is maximized. This happens for the shortest resolvable wavelengths (the Nyquist frequency), where $k_x = \\pi/\\Delta x$ and $k_y = \\pi/\\Delta y$. For these wavenumbers, $\\sin^2(k_x\\Delta x/2) = \\sin^2(\\pi/2) = 1$ and $\\sin^2(k_y\\Delta y/2) = \\sin^2(\\pi/2) = 1$. The stability criterion becomes:\n$$\nc^2 (\\Delta t)^2 \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) \\le 1\n$$\nThis is the general CFL condition for this scheme. Since the problem specifies $\\Delta x = \\Delta y$, this simplifies to:\n$$\nc^2 (\\Delta t)^2 \\left( \\frac{2}{(\\Delta x)^2} \\right) \\le 1\n$$\nSolving for $\\Delta t$ gives the stability requirement:\n$$\n\\Delta t \\le \\frac{\\Delta x}{c\\sqrt{2}}\n$$\nNow, we compute the maximum stable time step, $\\Delta t_{max}$, using the given values: $\\Delta x = 10\\,\\text{km} = 10 \\times 10^3\\,\\text{m}$, $H = 4000\\,\\text{m}$, and $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$.\nFirst, we calculate the barotropic gravity wave speed $c$:\n$$\nc = \\sqrt{gH} = \\sqrt{(9.81\\,\\text{m}\\,\\text{s}^{-2})(4000\\,\\text{m})} = \\sqrt{39240}\\,\\text{m}\\,\\text{s}^{-1} \\approx 198.09\\,\\text{m}\\,\\text{s}^{-1}\n$$\nNow we can compute $\\Delta t_{max}$:\n$$\n\\Delta t_{max} = \\frac{\\Delta x}{c\\sqrt{2}} = \\frac{10000\\,\\text{m}}{\\sqrt{2gH}} = \\frac{10000\\,\\text{m}}{\\sqrt{2 \\times 9.81\\,\\text{m}\\,\\text{s}^{-2} \\times 4000\\,\\text{m}}} = \\frac{10000}{\\sqrt{78480}}\\,\\text{s}\n$$\n$$\n\\Delta t_{max} \\approx 35.6960...\\,\\text{s}\n$$\nRounding to three significant figures, the maximum stable time step is $35.7\\,\\text{s}$.\n\nFinally, we discuss the implications for representing the principal lunar semidiurnal tide ($\\mathrm{M2}$), which has a period of $T_{\\mathrm{M2}} \\approx 12.42\\,\\text{hours}$.\nThe M2 period in seconds is $T_{\\mathrm{M2}} \\approx 12.42\\,\\text{h} \\times 3600\\,\\text{s/h} \\approx 44712\\,\\text{s}$.\nThe number of time steps required to sample one M2 period is $N = T_{\\mathrm{M2}} / \\Delta t \\approx 44712\\,\\text{s} / 35.7\\,\\text{s} \\approx 1252$.\nFrom a sampling perspective, having over $1200$ points per period provides excellent temporal resolution, far exceeding the Nyquist criterion and sufficient for high-accuracy representation of the M2 tide's temporal evolution.\nThe primary implication is related to computational cost. The small time step of $\\Delta t \\approx 35.7\\,\\text{s}$ is a severe constraint. In a split-explicit model, the three-dimensional baroclinic (internal) dynamics are integrated with a much larger time step, $\\Delta t_{int}$, perhaps on the order of an hour ($3600\\,\\text{s}$). For each single step of the baroclinic mode, the two-dimensional barotropic (external) mode must be advanced for $N_{sub} = \\Delta t_{int}/\\Delta t$ sub-cycles. In this case, $N_{sub} \\approx 3600/35.7 \\approx 101$. This means the computationally cheaper 2D barotropic model must be run about $100$ times for every one step of the expensive 3D model. Although this is more efficient than running the full 3D model with the small barotropic time step, the integration of the external mode still constitutes a significant fraction of the total computational expense, especially for long simulations required for tidal studies. This severe limitation is the primary motivation for developing alternative time-stepping schemes, such as semi-implicit or fully implicit methods for the free surface, which are not bound by this CFL condition.",
            "answer": "$$\n\\boxed{35.7}\n$$"
        }
    ]
}