{
    "hands_on_practices": [
        {
            "introduction": "Mastering the CFL condition begins with its most direct application. This first exercise  focuses on the 1D linear advection equation, the canonical model for transport phenomena. By calculating the necessary time step for a given propagation speed and grid spacing, you will practice the fundamental arithmetic of numerical stability and build an intuition for how these crucial simulation parameters are interconnected.",
            "id": "2139558",
            "problem": "A team of computational scientists is simulating the propagation of a signal along a one-dimensional transmission line. The behavior of the signal's voltage, $u(x, t)$, is modeled by the linear advection equation:\n$$ \\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = 0 $$\nwhere $v$ is the constant propagation speed of the signal.\n\nThe simulation uses a finite difference scheme on a grid with a uniform spatial step size of $\\Delta x$. The chosen numerical method is known to be stable only if the Courant-Friedrichs-Lewy (CFL) condition is satisfied. The Courant number, $C$, is defined as $C = |v| \\frac{\\Delta t}{\\Delta x}$, where $\\Delta t$ is the time step.\n\nFor this specific simulation, the propagation speed is $v = 2.5 \\times 10^8$ m/s, and the spatial step is $\\Delta x = 1.25$ cm. To ensure high accuracy and avoid numerical oscillations, the team decides to operate at a Courant number of exactly $C = 0.75$.\n\nWhat is the required time step, $\\Delta t$, for this simulation? Express your answer in nanoseconds (ns), rounded to two significant figures.",
            "solution": "We use the Courant number definition for the linear advection equation discretization:\n$$\nC=\\frac{|v|\\,\\Delta t}{\\Delta x}.\n$$\nSolving for the time step gives\n$$\n\\Delta t=\\frac{C\\,\\Delta x}{|v|}.\n$$\nSubstitute the given values, converting the spatial step to meters: $\\Delta x=1.25\\times 10^{-2}\\ \\text{m}$, $|v|=2.5\\times 10^{8}\\ \\text{m s}^{-1}$, and $C=0.75$:\n$$\n\\Delta t=\\frac{0.75\\,(1.25\\times 10^{-2})}{2.5\\times 10^{8}}\\ \\text{s}.\n$$\nCompute the numerical factor:\n$$\n\\Delta t=\\frac{0.9375\\times 10^{-2}}{2.5\\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{0.9375}{2.5}\\right)\\times 10^{-10}\\ \\text{s}\n=0.375\\times 10^{-10}\\ \\text{s}\n=3.75\\times 10^{-11}\\ \\text{s}.\n$$\nConvert to nanoseconds using $1\\ \\text{ns}=10^{-9}\\ \\text{s}$:\n$$\n\\Delta t=3.75\\times 10^{-11}\\ \\text{s}=3.75\\times 10^{-2}\\ \\text{ns}=0.0375\\ \\text{ns}.\n$$\nRounding to two significant figures yields $0.038\\ \\text{ns}$.",
            "answer": "$$\\boxed{0.038}$$"
        },
        {
            "introduction": "Building on the basics, we now explore how the CFL condition adapts to different physical systems. This problem  involves the one-dimensional wave equation, which governs phenomena like vibrations on a string or voltage pulses in a cable. Your task is to first identify the wave propagation speed, $c$, from the structure of the partial differential equation itself, and then use it to determine the maximum stable time step, reinforcing the idea that stability analysis must always be tailored to the specific equations being solved.",
            "id": "2139541",
            "problem": "An engineer is developing a numerical simulation for voltage pulse propagation along a specialized coaxial cable. In a simplified one-dimensional model, the voltage $u(x, t)$ at position $x$ and time $t$ is governed by the wave equation:\n$$ \\frac{\\partial^2 u}{\\partial t^2} = 16 \\frac{\\partial^2 u}{\\partial x^2} $$\nwhere $x$ is in meters and $t$ is in seconds.\n\nThe engineer decides to use a standard explicit finite difference scheme to solve this equation numerically. The spatial grid for the simulation is set up with a uniform spacing of $\\Delta x = 0.05$ meters. To ensure the stability of the numerical solution, the time step $\\Delta t$ must be chosen carefully.\n\nWhat is the maximum possible time step $\\Delta t$ that can be used while satisfying the Courant-Friedrichs-Lewy (CFL) stability condition for this scheme? Express your answer in seconds, rounded to three significant figures.",
            "solution": "We start from the one-dimensional wave equation written in the standard form\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nwhere, by comparison with the given equation $\\frac{\\partial^{2} u}{\\partial t^{2}}=16\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$, the wave speed is $c=4$.\n\nA standard explicit second-order finite difference discretization (centered in time and space) on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$ is\n$$\n\\frac{u_{j}^{n+1}-2u_{j}^{n}+u_{j}^{n-1}}{(\\Delta t)^{2}}=c^{2}\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\nRearranging gives the update formula\n$$\nu_{j}^{n+1}=2u_{j}^{n}-u_{j}^{n-1}+r^{2}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\nwhere the Courant number is defined by\n$$\nr=\\frac{c\\,\\Delta t}{\\Delta x}.\n$$\n\nTo determine the stability constraint, perform a von Neumann analysis by seeking Fourier mode solutions of the form $u_{j}^{n}=G^{n}\\exp(\\mathrm{i}\\kappa j\\Delta x)$, where $G$ is the amplification factor and $\\kappa$ is the wavenumber. Substituting into the update yields\n$$\nG-2+G^{-1}=r^{2}\\left(e^{\\mathrm{i}\\kappa\\Delta x}-2+e^{-\\mathrm{i}\\kappa\\Delta x}\\right)=-4r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right).\n$$\nEquivalently,\n$$\nG+G^{-1}=2\\left[1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right)\\right].\n$$\nThis implies the dispersion relation\n$$\n\\cos(\\omega\\Delta t)=1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right),\n$$\nso that stability, which requires $|G|=1$ for all modes, holds provided the right-hand side lies in the interval $[-1,1]$ for all $\\kappa$. Since $\\sin^{2}(\\cdot)\\in[0,1]$, the minimum of the right-hand side over all $\\kappa$ is $1-2r^{2}$. Requiring $1-2r^{2}\\geq -1$ gives\n$$\nr^{2}\\leq 1 \\quad\\Longleftrightarrow\\quad r\\leq 1.\n$$\nTherefore, the Courant-Friedrichs-Lewy stability condition for this explicit scheme is\n$$\n\\frac{c\\,\\Delta t}{\\Delta x}\\leq 1 \\quad\\Longrightarrow\\quad \\Delta t\\leq \\frac{\\Delta x}{c}.\n$$\n\nFor the given data, $\\Delta x=0.05$ and $c=4$, hence the maximum stable time step is\n$$\n\\Delta t_{\\max}=\\frac{0.05}{4}=0.0125.\n$$\nRounded to three significant figures, this value is $0.0125$ seconds.",
            "answer": "$$\\boxed{0.0125}$$"
        },
        {
            "introduction": "This final practice problem  bridges theory and application, immersing you in a scenario typical of computational oceanography. Here, you will analyze the stability of a 2D model for fast-moving surface gravity waves, which often impose the most stringent time step constraints in large-scale ocean simulations. By deriving the 2D CFL condition and calculating the time step for an Atlantic-scale model, you will confront the real-world computational trade-offs between model resolution, stability, and the ability to accurately represent critical oceanic processes like tides.",
            "id": "3814555",
            "problem": "Consider a split-explicit barotropic update for a basin-scale ocean model intended to represent the Atlantic, with uniform horizontal grid spacing and constant depth. The external (barotropic) mode is governed by the linearized, inviscid shallow-water equations on an $f$-plane, linearized about a state of rest:\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x}, \\quad\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y}, \\quad\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0,\n$$\nwhere $u$ and $v$ are the barotropic velocities, $\\eta$ is the free-surface elevation, $g$ is gravitational acceleration, $H$ is the constant depth, and $f$ is the Coriolis parameter. Assume that for the purpose of the stability constraint of fast barotropic gravity waves one may neglect the Coriolis terms when estimating the most restrictive Courant-Friedrichs-Lewy (CFL) condition.\n\nThe external mode is advanced explicitly with a standard forwardâ€“backward time-stepping and second-order centered spatial differences on a uniform square grid with $ \\Delta x = \\Delta y$. Denote the time step by $ \\Delta t$. Perform a von Neumann stability analysis of the discrete scheme for plane-wave solutions to derive the CFL stability requirement in terms of the external gravity-wave speed, the grid spacing, and the time step. Then, using $ \\Delta x = 10\\,\\text{km}$, $ \\Delta y = 10\\,\\text{km}$, $ H = 4000\\,\\text{m}$, and $ g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$, compute the maximum stable $ \\Delta t$ implied by the barotropic CFL constraint.\n\nFinally, briefly discuss the implications of this $ \\Delta t$ for representing the principal lunar semidiurnal ($\\mathrm{M2}$) tide with an explicitly integrated external mode, noting its period $T_{\\mathrm{M2}} \\approx 12.42\\,\\text{hours}$, and the resulting sampling and computational considerations.\n\nExpress the final numerical answer for the maximum stable $ \\Delta t$ in seconds (s) and round your answer to three significant figures. The final answer must be a single real-valued number.",
            "solution": "The first step is to derive the Courant-Friedrichs-Lewy (CFL) stability requirement for the given system. The problem asks to neglect the Coriolis terms ($f=0$) for the purpose of analyzing the stability constraint imposed by fast barotropic gravity waves. The linearized shallow-water equations then simplify to:\n$$\n\\frac{\\partial u}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{\\partial v}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial y}\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0\n$$\nTo analyze the propagation of gravity waves, we can combine these three first-order partial differential equations (PDEs) into a single second-order PDE for the free-surface elevation $\\eta$. We differentiate the third equation with respect to time $t$:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + H\\left(\\frac{\\partial}{\\partial t}\\frac{\\partial u}{\\partial x} + \\frac{\\partial}{\\partial t}\\frac{\\partial v}{\\partial y}\\right) = 0\n$$\nAssuming the fields are sufficiently smooth, we can swap the order of differentiation:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + H\\left(\\frac{\\partial}{\\partial x}\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial y}\\frac{\\partial v}{\\partial t}\\right) = 0\n$$\nNow, substitute the first two equations (the momentum equations) into this expression:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} + H\\left(\\frac{\\partial}{\\partial x}\\left(-g \\frac{\\partial \\eta}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(-g \\frac{\\partial \\eta}{\\partial y}\\right)\\right) = 0\n$$\nSince $g$ and $H$ are constants, we obtain the two-dimensional linear wave equation:\n$$\n\\frac{\\partial^2 \\eta}{\\partial t^2} = gH \\left(\\frac{\\partial^2 \\eta}{\\partial x^2} + \\frac{\\partial^2 \\eta}{\\partial y^2}\\right)\n$$\nThis equation describes the propagation of waves with a phase speed $c = \\sqrt{gH}$.\n\nNext, we perform a von Neumann stability analysis on the discretized form of this wave equation. The problem specifies second-order centered differences for space and a standard explicit time-stepping scheme, which for the second-order wave equation is the centered-in-time, centered-in-space (CTCS) or leapfrog scheme. Let $\\eta_{j,k}^n$ denote the numerical approximation of $\\eta(j\\Delta x, k\\Delta y, n\\Delta t)$. The discretized equation is:\n$$\n\\frac{\\eta_{j,k}^{n+1} - 2\\eta_{j,k}^n + \\eta_{j,k}^{n-1}}{(\\Delta t)^2} = c^2 \\left( \\frac{\\eta_{j+1,k}^n - 2\\eta_{j,k}^n + \\eta_{j-1,k}^n}{(\\Delta x)^2} + \\frac{\\eta_{j,k+1}^n - 2\\eta_{j,k}^n + \\eta_{j,k-1}^n}{(\\Delta y)^2} \\right)\n$$\nWe seek solutions of the form of a single Fourier mode:\n$$\n\\eta_{j,k}^n = \\lambda^n \\exp(i(k_x j \\Delta x + k_y k \\Delta y))\n$$\nwhere $\\lambda$ is the amplification factor, $k_x$ and $k_y$ are the components of the wavenumber vector, and $i = \\sqrt{-1}$. Substituting this into the finite-difference equation yields:\n$$\n\\frac{\\lambda^{n+1} - 2\\lambda^n + \\lambda^{n-1}}{(\\Delta t)^2} = c^2 \\lambda^n \\left[ \\frac{\\exp(ik_x\\Delta x) - 2 + \\exp(-ik_x\\Delta x)}{(\\Delta x)^2} + \\frac{\\exp(ik_y\\Delta y) - 2 + \\exp(-ik_y\\Delta y)}{(\\Delta y)^2} \\right]\n$$\nDividing by $\\lambda^{n-1}$ (and canceling the spatial exponential terms which are common to all terms) gives:\n$$\n\\frac{\\lambda^2 - 2\\lambda + 1}{(\\Delta t)^2} = c^2 \\lambda \\left[ \\frac{2\\cos(k_x\\Delta x) - 2}{(\\Delta x)^2} + \\frac{2\\cos(k_y\\Delta y) - 2}{(\\Delta y)^2} \\right]\n$$\nUsing the half-angle identity $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$\n\\lambda^2 - 2\\lambda + 1 = -4 c^2 (\\Delta t)^2 \\lambda \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right]\n$$\nThis is a quadratic equation for the amplification factor $\\lambda$:\n$$\n\\lambda^2 - 2\\lambda \\left( 1 - 2 c^2 (\\Delta t)^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right] \\right) + 1 = 0\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must satisfy $|\\lambda| \\le 1$. A a quadratic equation of the form $\\lambda^2 - 2B\\lambda + 1 = 0$ has roots with magnitude equal to $1$ if and only if $|B| \\le 1$. In our case,\n$$\nB = 1 - 2 c^2 (\\Delta t)^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right]\n$$\nThe condition $B \\le 1$ is always satisfied since the term subtracted from $1$ is non-negative. The stability condition is therefore determined by $B \\ge -1$:\n$$\n1 - 2 c^2 (\\Delta t)^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right] \\ge -1\n$$\n$$\nc^2 (\\Delta t)^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{(\\Delta x)^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{(\\Delta y)^2} \\right] \\le 1\n$$\nThis condition must hold for all possible wavenumbers. The most restrictive (worst-case) scenario occurs when the left-hand side is maximized. This happens for the shortest resolvable wavelengths (the Nyquist frequency), where $k_x = \\pi/\\Delta x$ and $k_y = \\pi/\\Delta y$. For these wavenumbers, $\\sin^2(k_x\\Delta x/2) = \\sin^2(\\pi/2) = 1$ and $\\sin^2(k_y\\Delta y/2) = \\sin^2(\\pi/2) = 1$. The stability criterion becomes:\n$$\nc^2 (\\Delta t)^2 \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) \\le 1\n$$\nThis is the general CFL condition for this scheme. Since the problem specifies $\\Delta x = \\Delta y$, this simplifies to:\n$$\nc^2 (\\Delta t)^2 \\left( \\frac{2}{(\\Delta x)^2} \\right) \\le 1\n$$\nSolving for $\\Delta t$ gives the stability requirement:\n$$\n\\Delta t \\le \\frac{\\Delta x}{c\\sqrt{2}}\n$$\nNow, we compute the maximum stable time step, $\\Delta t_{max}$, using the given values: $\\Delta x = 10\\,\\text{km} = 10 \\times 10^3\\,\\text{m}$, $H = 4000\\,\\text{m}$, and $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$.\nFirst, we calculate the barotropic gravity wave speed $c$:\n$$\nc = \\sqrt{gH} = \\sqrt{(9.81\\,\\text{m}\\,\\text{s}^{-2})(4000\\,\\text{m})} = \\sqrt{39240}\\,\\text{m}\\,\\text{s}^{-1}\n$$\nNow we can compute $\\Delta t_{max}$:\n$$\n\\Delta t_{max} = \\frac{\\Delta x}{c\\sqrt{2}} = \\frac{\\Delta x}{\\sqrt{2gH}} = \\frac{10000\\,\\text{m}}{\\sqrt{2 \\times 9.81\\,\\text{m}\\,\\text{s}^{-2} \\times 4000\\,\\text{m}}} = \\frac{10000}{\\sqrt{78480}}\\,\\text{s}\n$$\n$$\n\\Delta t_{max} \\approx 35.6960...\\,\\text{s}\n$$\nRounding to three significant figures, the maximum stable time step is $35.7\\,\\text{s}$.\n\nFinally, we discuss the implications for representing the principal lunar semidiurnal tide ($\\mathrm{M2}$), which has a period of $T_{\\mathrm{M2}} \\approx 12.42\\,\\text{hours}$.\nThe M2 period in seconds is $T_{\\mathrm{M2}} \\approx 12.42\\,\\text{h} \\times 3600\\,\\text{s/h} \\approx 44712\\,\\text{s}$.\nThe number of time steps required to sample one M2 period is $N = T_{\\mathrm{M2}} / \\Delta t \\approx 44712\\,\\text{s} / 35.7\\,\\text{s} \\approx 1252$.\nFrom a sampling perspective, having over $1200$ points per period provides excellent temporal resolution, far exceeding the Nyquist criterion and sufficient for high-accuracy representation of the M2 tide's temporal evolution.\nThe primary implication is related to computational cost. The small time step of $\\Delta t \\approx 35.7\\,\\text{s}$ is a severe constraint. In a split-explicit model, the three-dimensional baroclinic (internal) dynamics are integrated with a much larger time step, $\\Delta t_{int}$, perhaps on the order of an hour ($3600\\,\\text{s}$). For each single step of the baroclinic mode, the two-dimensional barotropic (external) mode must be advanced for $N_{sub} = \\Delta t_{int}/\\Delta t$ sub-cycles. In this case, $N_{sub} \\approx 3600/35.7 \\approx 101$. This means the computationally cheaper 2D barotropic model must be run about $100$ times for every one step of the expensive 3D model. Although this is more efficient than running the full 3D model with the small barotropic time step, the integration of the external mode still constitutes a significant fraction of the total computational expense, especially for long simulations required for tidal studies. This severe limitation is the primary motivation for developing alternative time-stepping schemes, such as semi-implicit or fully implicit methods for the free surface, which are not bound by this CFL condition.",
            "answer": "$$\n\\boxed{35.7}\n$$"
        }
    ]
}