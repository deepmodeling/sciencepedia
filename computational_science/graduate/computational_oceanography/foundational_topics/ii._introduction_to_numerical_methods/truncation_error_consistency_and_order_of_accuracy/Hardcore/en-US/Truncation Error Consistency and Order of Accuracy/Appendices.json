{
    "hands_on_practices": [
        {
            "introduction": "Understanding the accuracy of any numerical method begins with a rigorous analysis of the error it introduces in a single step. This fundamental exercise guides you through the process of deriving the local truncation error for Heun's method, a widely used second-order Runge-Kutta scheme. By meticulously applying Taylor series expansions, you will not only quantify the leading-order error but also gain a deep appreciation for how a method's local behavior dictates its global order of accuracy .",
            "id": "3817323",
            "problem": "A classical one-dimensional ocean mixed-layer model approximates the evolution of a vertically uniform tracer (for example, temperature) in a control volume by the scalar ordinary differential equation $T^{\\prime}(t) = f(t, T(t))$, where $f$ is sufficiently smooth in both arguments and arises from conservation of heat with specified sources and sinks. Consider advancing this model in time from $t_n$ to $t_{n+1} = t_n + h$ using Heun’s method (also known as the explicit trapezoidal rule or explicit second-order Runge–Kutta method), defined by\n- $k_1 = f(t_n, T_n)$,\n- $k_2 = f(t_n + h, T_n + h k_1)$,\n- $T_{n+1}^{H} = T_n + \\frac{h}{2}\\left(k_1 + k_2\\right)$,\nwhere $T_n$ approximates $T(t_n)$.\n\nStarting from the exact value $T(t_n)$ in place of $T_n$, derive the one-step local truncation error $\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}$ by Taylor expanding all terms about $(t_n, T(t_n))$ and retaining all contributions up to and including order $h^3$. Express your result in a closed analytic form in terms of time derivatives $T^{\\prime\\prime}(t_n)$, $T^{(3)}(t_n)$ and the partial derivative $f_T(t_n, T(t_n)) \\equiv \\partial f/\\partial T$ evaluated on the exact solution at $t_n$. Use this defect to justify the second-order global accuracy of Heun’s method for this ocean mixed-layer ordinary differential equation under smoothness and stability assumptions appropriate for consistent one-step methods.\n\nYour final answer must be a single closed-form analytic expression for the leading-order term of $\\tau_{n+1}$ in terms of $h$, $T^{\\prime\\prime}(t_n)$, $T^{(3)}(t_n)$, and $f_T(t_n, T(t_n))$. Do not include units. Do not round.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard task in numerical analysis: the derivation of the local truncation error for a well-known Runge-Kutta method (Heun's method) and the subsequent analysis of its order of accuracy. All definitions and conditions are standard and self-consistent. Therefore, the problem is valid and we may proceed with the solution.\n\nThe objective is to derive the one-step local truncation error, $\\tau_{n+1}$, for Heun's method. The local truncation error is defined as the difference between the exact solution at time $t_{n+1}$ and the numerical approximation obtained by taking a single step from the exact solution at time $t_n$. Let $T(t)$ be the exact solution to the ordinary differential equation $T^{\\prime}(t) = f(t, T(t))$. The local truncation error is thus given by $\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}$, where the numerical step $T_{n+1}^{H}$ is computed starting from the exact value $T_n = T(t_n)$.\n\nFirst, we expand the exact solution $T(t_{n+1})$ around $t_n$ using a Taylor series, where $t_{n+1} = t_n + h$.\n$$T(t_{n+1}) = T(t_n + h) = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) + O(h^4)$$\nThe derivatives of $T(t)$ are evaluated at $t_n$.\n\nNext, we analyze the numerical solution $T_{n+1}^{H}$ obtained from one step of Heun's method starting from the exact solution value $T(t_n)$:\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2}(k_1 + k_2)$$\nThe coefficients $k_1$ and $k_2$ are defined as:\n$$k_1 = f(t_n, T(t_n))$$\n$$k_2 = f(t_n + h, T(t_n) + h k_1)$$\nSince $T(t)$ is the exact solution, we have $T^{\\prime}(t) = f(t, T(t))$. Therefore, $k_1 = T^{\\prime}(t_n)$.\n\nTo find an expression for $T_{n+1}^{H}$ comparable to the Taylor series for $T(t_{n+1})$, we must expand $k_2$ in a Taylor series for a function of two variables around the point $(t_n, T(t_n))$. Let $f_t = \\frac{\\partial f}{\\partial t}$, $f_T = \\frac{\\partial f}{\\partial T}$, $f_{tt} = \\frac{\\partial^2 f}{\\partial t^2}$, $f_{tT} = \\frac{\\partial^2 f}{\\partial t \\partial T}$, and $f_{TT} = \\frac{\\partial^2 f}{\\partial T^2}$, with all partial derivatives evaluated at $(t_n, T(t_n))$. The expansion is:\n$$k_2 = f(t_n+h, T(t_n)+hk_1) = f(t_n, T(t_n)) + h f_t + (hk_1) f_T + \\frac{1}{2}\\left(h^2 f_{tt} + 2h(hk_1)f_{tT} + (hk_1)^2 f_{TT}\\right) + O(h^3)$$\nSubstituting $k_1 = T^{\\prime}(t_n)$ and $f(t_n, T(t_n)) = T^{\\prime}(t_n)$:\n$$k_2 = T^{\\prime}(t_n) + h \\left(f_t + T^{\\prime}(t_n) f_T\\right) + \\frac{h^2}{2}\\left(f_{tt} + 2T^{\\prime}(t_n) f_{tT} + (T^{\\prime}(t_n))^2 f_{TT}\\right) + O(h^3)$$\n\nNow, we relate the partial derivatives of $f$ to the total time derivatives of $T$. Using the chain rule on $T^{\\prime}(t) = f(t, T(t))$:\n$$T^{\\prime\\prime}(t) = \\frac{d}{dt}f(t, T(t)) = \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial T}\\frac{dT}{dt} = f_t + f_T T^{\\prime}(t)$$\nDifferentiating again with respect to $t$:\n$$T^{(3)}(t) = \\frac{d}{dt}\\left(f_t + f_T T^{\\prime}(t)\\right) = \\left(\\frac{\\partial f_t}{\\partial t} + \\frac{\\partial f_t}{\\partial T}\\frac{dT}{dt}\\right) + \\left(\\frac{\\partial f_T}{\\partial t} + \\frac{\\partial f_T}{\\partial T}\\frac{dT}{dt}\\right)T^{\\prime}(t) + f_T T^{\\prime\\prime}(t)$$\n$$T^{(3)}(t) = (f_{tt} + f_{tT}T^{\\prime}) + (f_{Tt} + f_{TT}T^{\\prime})T^{\\prime} + f_T T^{\\prime\\prime}$$\nSince $f$ is assumed to be sufficiently smooth, the mixed partial derivatives are equal, $f_{tT} = f_{Tt}$.\n$$T^{(3)}(t_n) = f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} + f_T T^{\\prime\\prime}(t_n)$$\nFrom this, we can express the term in the $O(h^2)$ part of the $k_2$ expansion:\n$$f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} = T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)$$\n\nSubstituting these total derivative expressions back into the expansion for $k_2$:\n$$k_2 = T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}\\left(T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n)\\right) + O(h^3)$$\n\nNow we substitute the expressions for $k_1$ and $k_2$ into the formula for $T_{n+1}^{H}$:\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ T^{\\prime}(t_n) + \\left( T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ 2T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4}\\left( T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\n\nFinally, we compute the local truncation error $\\tau_{n+1} = T(t_{n+1}) - T_{n+1}^{H}$:\n$$\\tau_{n+1} = \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) \\right) - \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4} T^{(3)}(t_n) - \\frac{h^3}{4} f_T T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\nThe terms of order $h^0$, $h^1$, and $h^2$ cancel out. We collect the terms of order $h^3$:\n$$\\tau_{n+1} = \\left(\\frac{1}{6} - \\frac{1}{4}\\right) h^3 T^{(3)}(t_n) + \\frac{h^3}{4} f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\n$$\\tau_{n+1} = -\\frac{1}{12} h^3 T^{(3)}(t_n) + \\frac{3}{12} h^3 f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\nThe leading-order term of the local truncation error is:\n$$\\tau_{n+1} = \\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right) + O(h^4)$$\n\nTo justify the second-order global accuracy, we analyze this result. A numerical method is said to be of order $p$ if its local truncation error $\\tau_{n+1}$ is of order $h^{p+1}$. In this case, we have found that $\\tau_{n+1} = O(h^3)$, which implies that the method is of order $p=2$.\nThe method is consistent because $\\lim_{h\\to 0} \\frac{\\tau_{n+1}}{h} = \\lim_{h\\to 0} O(h^2) = 0$.\nThe fundamental theorem of numerical analysis for ODEs (attributed to Dahlquist) states that for a consistent one-step method, stability is a sufficient condition for convergence. Moreover, if the method is of order $p$ and stable (which for Runge-Kutta methods is guaranteed if $f$ is Lipschitz continuous, a consequence of the smoothness assumption), then the global error $E_N = T(t_N) - T_N$ at a fixed time $t_N = t_0 + Nh$ is of order $p$.\nSince Heun's method has order $p=2$, its global error is $O(h^2)$. Thus, the method has second-order global accuracy.\nThe leading-order term of the local truncation error is the expression of order $h^3$.",
            "answer": "$$\\boxed{\\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right)}$$"
        },
        {
            "introduction": "When discretizing partial differential equations, we must account for errors arising from both spatial and temporal approximations. This practice explores the interaction between these error sources within the method-of-lines framework. It poses a critical question: what happens when a high-order spatial scheme is paired with a lower-order time integrator? By analyzing this scenario, you will discover the \"weakest link\" principle, a crucial concept for designing efficient and balanced numerical schemes where the overall accuracy is not needlessly compromised by one component .",
            "id": "3817314",
            "problem": "Consider the one-dimensional linear advection equation on a periodic domain,\n$$\nu_{t} + c\\,u_{x} = 0,\n$$\nwith a constant wave speed $c \\neq 0$ and a smooth initial condition. A method-of-lines discretization is used: the spatial derivative $u_{x}$ is approximated on a uniform grid with spacing $h$ by a consistent, centered fourth-order finite-difference operator, yielding a semi-discrete system. Time integration of the semi-discrete system is performed with the explicit two-stage Second-Order Runge–Kutta (RK2) method. A Courant–Friedrichs–Lewy (CFL) number $\\lambda$ is held fixed by choosing the time step $\\Delta t$ proportional to the grid spacing, specifically\n$$\n\\Delta t = \\lambda\\,\\frac{h}{|c|},\n$$\nwhere $\\lambda$ satisfies the linear stability constraint for the described scheme. Assume the exact solution is sufficiently smooth so that all derivatives required for truncation error analysis exist and are bounded for $t \\in [0,T]$, and that the numerical scheme is stable under the stated CFL choice.\n\nUsing only foundational definitions of truncation error, consistency, stability, and order of accuracy, determine the highest achievable global order of accuracy (with respect to $h$) of the fully discrete numerical solution at a fixed final time $T > 0$ as $h \\to 0$ under the given CFL scaling. Express your final answer as a single integer.",
            "solution": "The problem requires the determination of the global order of accuracy for a numerical method solving the one-dimensional linear advection equation, $u_t + c u_x = 0$, where $c \\neq 0$ is a constant wave speed.\n\nThe solution strategy involves three main steps:\n$1$. Determine the local truncation error (LTE) of the fully discrete scheme by combining the errors from the spatial and temporal discretization components.\n$2$. Relate the local truncation error to the global error at a fixed final time $T > 0$.\n$3$. Apply the given Courant–Friedrichs–Lewy (CFL) scaling, $\\Delta t \\propto h$, to express the global error as a function of the spatial grid spacing $h$ only, and identify the dominant term as $h \\to 0$.\n\nFirst, we analyze the components of the numerical scheme. The method of lines is employed, where the partial differential equation (PDE) is first discretized in space to form a system of ordinary differential equations (ODEs), which is then integrated in time.\n\nThe spatial derivative, $u_x$, is approximated using a \"consistent, centered fourth-order finite-difference operator.\" A scheme is defined as $p$-th order if its local truncation error is $O(h^p)$. Thus, the spatial discretization introduces an error of order $h^4$. The semi-discrete approximation to the PDE can be written as $\\frac{d\\mathbf{v}}{dt} = -c D_x\\mathbf{v}$, where $\\mathbf{v}$ is the vector of numerical solution values on the grid and $D_x$ is the matrix representing the fourth-order difference operator. The local truncation error contribution from this spatial approximation, $\\tau_{space}$, is:\n$$\n\\tau_{space} = O(h^4)\n$$\n\nThe resulting system of ODEs is integrated using the \"explicit two-stage Second-Order Runge–Kutta (RK$2$) method.\" A time integration method is of order $q$ if its local truncation error is $O(\\Delta t^q)$. For the $2$-nd order RK$2$ method, $q=2$. Therefore, the local truncation error contribution from the time integration, $\\tau_{time}$, is:\n$$\n\\tau_{time} = O(\\Delta t^2)\n$$\n\nFor the method-of-lines approach, the total local truncation error, $\\tau$, of the fully discrete scheme is the sum of the local truncation errors from the spatial and temporal components.\n$$\n\\tau = \\tau_{time} + \\tau_{space} = O(\\Delta t^2) + O(h^4)\n$$\nA scheme is consistent if its LTE goes to zero as $\\Delta t \\to 0$ and $h \\to 0$, which is the case here.\n\nNext, we relate the local error to the global error. The problem statement guarantees that the scheme is stable. The Lax Equivalence Theorem states that for a consistent linear scheme, stability is the necessary and sufficient condition for convergence. A key consequence of this theorem is that the order of the global error is the same as the order of the local truncation error. The global error, $E_g(T)$, at a fixed final time $T$ is therefore:\n$$\nE_g(T) = O(\\Delta t^2) + O(h^4)\n$$\n\nThe final step is to incorporate the specified scaling between the time step $\\Delta t$ and the grid spacing $h$. A constant CFL number $\\lambda$ is maintained via the relation:\n$$\n\\Delta t = \\lambda \\frac{h}{|c|}\n$$\nSince $\\lambda$ and $c$ are fixed non-zero constants, $\\Delta t$ is directly proportional to $h$. We can express this as $\\Delta t = K h$ for a constant $K = \\lambda/|c|$.\n\nSubstituting this relationship into the global error expression allows us to analyze the convergence with respect to $h$ alone:\n$$\nE_g(T) = O((K h)^2) + O(h^4)\n$$\nAs $K$ is a constant, this simplifies to:\n$$\nE_g(T) = O(h^2) + O(h^4)\n$$\n\nTo find the overall order of accuracy, we must identify the dominant error term as $h \\to 0$. The error is a sum of a term proportional to $h^2$ and a term proportional to $h^4$. For small values of $h$, the term with the lower power of $h$ will be larger and will therefore dominate the total error. Since $2 < 4$, the $O(h^2)$ term dominates the $O(h^4)$ term.\n$$\n\\lim_{h\\to 0} \\frac{O(h^4)}{O(h^2)} = 0\n$$\nThus, the asymptotic behavior of the global error is governed by the $O(h^2)$ term:\n$$\nE_g(T) = O(h^2) \\quad \\text{as } h \\to 0\n$$\n\nThe global order of accuracy of a numerical scheme is the exponent of $h$ in the leading term of the global error. In this case, the exponent is $2$. Despite the use of a $4$-th order spatial scheme, the overall accuracy is limited by the $2$-nd order temporal scheme due to the linear scaling between $\\Delta t$ and $h$. The highest achievable global order of accuracy for the specified scheme is $2$.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "Theoretical analysis reveals a scheme's formal order of accuracy, but how do we verify that a complex computer program actually achieves it? This exercise introduces the Method of Manufactured Solutions (MMS), a cornerstone of modern code verification. You will design a test problem for the advection-diffusion equation by first choosing a desired \"manufactured\" solution and then deriving the corresponding source term that makes it exact, providing a perfect benchmark against which to measure numerical errors and confirm the convergence rate of your code .",
            "id": "3817444",
            "problem": "Consider a passive tracer concentration field $C(x,y,t)$ governed by the two-dimensional advection–diffusion equation with a source/sink term $Q(x,y,t)$ on a doubly periodic domain, $x \\in [0,L_x]$, $y \\in [0,L_y]$, with smooth, divergence-free velocity. The governing equation is\n$$\n\\frac{\\partial C}{\\partial t} + u(x,y)\\,\\frac{\\partial C}{\\partial x} + v(x,y)\\,\\frac{\\partial C}{\\partial y} = \\kappa\\,\\left(\\frac{\\partial^2 C}{\\partial x^2} + \\frac{\\partial^2 C}{\\partial y^2}\\right) + Q(x,y,t),\n$$\nwhere $\\kappa>0$ is a constant molecular diffusivity. In a computational oceanography setting, one often validates a numerical implementation and its claimed spatial–temporal accuracy using the Method of Manufactured Solutions (MMS). The MMS requires selecting a sufficiently smooth $C(x,y,t)$ that respects the domain periodicity and then deriving the exact $Q(x,y,t)$ so that the chosen $C(x,y,t)$ is an exact solution of the continuous problem for the prescribed $\\kappa$, $u(x,y)$, and $v(x,y)$.\n\nYou are tasked with the following:\n\n- Starting from the definitions of truncation error, consistency, and order of accuracy for partial differential equation discretizations, explain why selecting a smooth manufactured solution with nontrivial spatiotemporal variation is necessary to probe a claimed second-order spatial–temporal scheme. Your base must be the governing advection–diffusion equation, the periodicity of the domain, and the divergence-free kinematics implied by a streamfunction representation.\n\n- Let the velocity field be generated by a streamfunction $\\psi(x,y)$ so that $u(x,y) = \\frac{\\partial \\psi}{\\partial y}$ and $v(x,y) = -\\frac{\\partial \\psi}{\\partial x}$. Choose the streamfunction\n$$\n\\psi(x,y) = \\Psi_0\\,\\sin(k_x x)\\,\\sin(k_y y),\n$$\nwith $k_x = \\frac{2\\pi}{L_x}$ and $k_y = \\frac{2\\pi}{L_y}$, where $\\Psi_0>0$ is a constant amplitude. This ensures $u_x+v_y=0$. Now, design a manufactured tracer $C(x,y,t)$ whose structure is compatible with the periodic domain and which simultaneously exercises both advection and diffusion. Use\n$$\nC(x,y,t) = \\exp(\\gamma t)\\,\\sin(k_x x)\\,\\cos(k_y y) + \\cos(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y),\n$$\nwith $\\gamma>0$ and $\\omega>0$ constants. Derive, from first principles and without invoking any shortcut formulas, the exact forcing $Q(x,y,t)$ that makes this $C(x,y,t)$ an exact solution of the advection–diffusion equation with the given $\\psi(x,y)$ and diffusivity $\\kappa$.\n\n- Briefly justify, using Taylor-series arguments applied to smooth functions and operators, what asymptotic refinement behavior is expected for the global error of a formally second-order method in both space and time when applied to this manufactured problem under grid refinement in $h$ and $\\Delta t$, assuming the computed solution is compared to the exact manufactured $C(x,y,t)$.\n\nYour final answer must be the closed-form analytic expression for $Q(x,y,t)$ as a single expression. No numerical evaluation is required. If you introduce any additional constants, you must define them. No units are required in the final answer. If you find it helpful to introduce intermediate expressions during derivation, do so, but present the final $Q(x,y,t)$ in a single, simplified analytic form.",
            "solution": "The appropriate base for analysis is the governing advection–diffusion equation and the streamfunction representation of a divergence-free velocity field. On a periodic domain, any trigonometric manufactured solution with wavenumbers compatible with the domain length respects periodicity. The Method of Manufactured Solutions (MMS) proceeds by selecting a smooth $C(x,y,t)$ that exercises the operators in the equation and then algebraically computing $Q(x,y,t)$ by substituting the manufactured solution into the left-hand side minus the diffusive terms to match the right-hand side. This ensures the continuous partial differential equation is satisfied exactly by construction, allowing discretization errors to be isolated and measured.\n\nWith $\\psi(x,y) = \\Psi_0\\,\\sin(k_x x)\\,\\sin(k_y y)$, the velocity field components are\n$$\nu(x,y) = \\frac{\\partial \\psi}{\\partial y} = \\Psi_0\\,k_y\\,\\cos(k_y y)\\,\\sin(k_x x),\n\\qquad\nv(x,y) = -\\frac{\\partial \\psi}{\\partial x} = -\\Psi_0\\,k_x\\,\\cos(k_x x)\\,\\sin(k_y y),\n$$\nwhich satisfy $u_x + v_y = 0$. The manufactured tracer is\n$$\nC(x,y,t) = \\exp(\\gamma t)\\,\\sin(k_x x)\\,\\cos(k_y y) + \\cos(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y),\n$$\nwith constants $\\gamma>0$, $\\omega>0$, and $k_x = \\frac{2\\pi}{L_x}$, $k_y = \\frac{2\\pi}{L_y}$. We compute the necessary derivatives.\n\nTime derivative:\n$$\n\\frac{\\partial C}{\\partial t} = \\gamma\\,\\exp(\\gamma t)\\,\\sin(k_x x)\\,\\cos(k_y y) - \\omega\\,\\sin(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y).\n$$\n\nSpatial first derivatives:\n$$\n\\frac{\\partial C}{\\partial x} = \\exp(\\gamma t)\\,k_x\\,\\cos(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,k_x\\,\\sin(k_x x)\\,\\sin(k_y y),\n$$\n$$\n\\frac{\\partial C}{\\partial y} = -\\exp(\\gamma t)\\,k_y\\,\\sin(k_x x)\\,\\sin(k_y y) + \\cos(\\omega t)\\,k_y\\,\\cos(k_x x)\\,\\cos(k_y y).\n$$\n\nSpatial second derivatives:\n$$\n\\frac{\\partial^2 C}{\\partial x^2} = -\\exp(\\gamma t)\\,k_x^{2}\\,\\sin(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,k_x^{2}\\,\\cos(k_x x)\\,\\sin(k_y y),\n$$\n$$\n\\frac{\\partial^2 C}{\\partial y^2} = -\\exp(\\gamma t)\\,k_y^{2}\\,\\sin(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,k_y^{2}\\,\\cos(k_x x)\\,\\sin(k_y y).\n$$\nThus, the Laplacian is\n$$\n\\frac{\\partial^2 C}{\\partial x^2} + \\frac{\\partial^2 C}{\\partial y^2} = -\\exp(\\gamma t)\\,(k_x^{2}+k_y^{2})\\,\\sin(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,(k_x^{2}+k_y^{2})\\,\\cos(k_x x)\\,\\sin(k_y y).\n$$\n\nThe advection contribution $u\\,C_x + v\\,C_y$ is\n\\begin{align*}\nu\\,\\frac{\\partial C}{\\partial x} &= \\Psi_0\\,k_y\\,\\cos(k_y y)\\,\\sin(k_x x)\\,\\left(\\exp(\\gamma t)\\,k_x\\,\\cos(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,k_x\\,\\sin(k_x x)\\,\\sin(k_y y)\\right) \\\\\n&= \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\\,\\cos^{2}(k_y y)\n- \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin^{2}(k_x x)\\,\\cos(k_y y)\\,\\sin(k_y y),\n\\end{align*}\nand\n\\begin{align*}\nv\\,\\frac{\\partial C}{\\partial y} &= -\\Psi_0\\,k_x\\,\\cos(k_x x)\\,\\sin(k_y y)\\,\\left(-\\exp(\\gamma t)\\,k_y\\,\\sin(k_x x)\\,\\sin(k_y y) + \\cos(\\omega t)\\,k_y\\,\\cos(k_x x)\\,\\cos(k_y y)\\right) \\\\\n&= \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\\,\\sin^{2}(k_y y)\n- \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\cos^{2}(k_x x)\\,\\sin(k_y y)\\,\\cos(k_y y).\n\\end{align*}\nSumming,\n\\begin{align*}\nu\\,\\frac{\\partial C}{\\partial x} + v\\,\\frac{\\partial C}{\\partial y}\n&= \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\\,\\left(\\cos^{2}(k_y y)+\\sin^{2}(k_y y)\\right) \\\\\n&\\quad - \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y)\\,\\left(\\sin^{2}(k_x x)+\\cos^{2}(k_x x)\\right) \\\\\n&= \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\n- \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y).\n\\end{align*}\n\nWe now assemble $Q(x,y,t)$ from the governing equation:\n$$\nQ(x,y,t) = \\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} + v\\,\\frac{\\partial C}{\\partial y} - \\kappa\\,\\left(\\frac{\\partial^{2} C}{\\partial x^{2}} + \\frac{\\partial^{2} C}{\\partial y^{2}}\\right).\n$$\nSubstituting the derived terms,\n\\begin{align*}\nQ(x,y,t)\n&= \\left[\\gamma\\,\\exp(\\gamma t)\\,\\sin(k_x x)\\,\\cos(k_y y) - \\omega\\,\\sin(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y)\\right] \\\\\n&\\quad + \\left[\\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\n- \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y)\\right] \\\\\n&\\quad - \\kappa\\,\\left[-\\exp(\\gamma t)\\,(k_x^{2}+k_y^{2})\\,\\sin(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,(k_x^{2}+k_y^{2})\\,\\cos(k_x x)\\,\\sin(k_y y)\\right].\n\\end{align*}\nSimplifying signs,\n\\begin{align*}\nQ(x,y,t)\n&= \\exp(\\gamma t)\\,\\left(\\gamma + \\kappa\\,(k_x^{2}+k_y^{2})\\right)\\,\\sin(k_x x)\\,\\cos(k_y y) \\\\\n&\\quad + \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x) \\\\\n&\\quad + \\cos(\\omega t)\\,\\kappa\\,(k_x^{2}+k_y^{2})\\,\\cos(k_x x)\\,\\sin(k_y y) \\\\\n&\\quad - \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y) \\\\\n&\\quad - \\omega\\,\\sin(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y).\n\\end{align*}\nThis is the closed-form forcing that makes the chosen $C(x,y,t)$ an exact solution of the advection–diffusion equation with the given streamfunction velocity and diffusivity.\n\nRegarding truncation error, consistency, and order of accuracy, a method is consistent if the local truncation error tends to zero as $h \\to 0$ and $\\Delta t \\to 0$. Taylor-series analysis of smooth functions and operators shows that central differences in space and a second-order time integrator (such as a trapezoidal or Crank–Nicolson update) yield leading truncation errors that scale like $\\mathcal{O}(h^{2})$ and $\\mathcal{O}(\\Delta t^{2})$, respectively, provided the solution and coefficients are sufficiently smooth. For the MMS with the above $C(x,y,t)$, the exact source enforces smoothness, and one expects a properly implemented second-order spatial–temporal scheme to exhibit a global error norm $E(h,\\Delta t)$ that asymptotically behaves like $\\mathcal{O}(h^{2}) + \\mathcal{O}(\\Delta t^{2})$ under joint refinement, enabling clear verification of second-order convergence in both space and time when comparing the computed solution against the manufactured $C(x,y,t)$.",
            "answer": "$$\\boxed{\\exp(\\gamma t)\\,\\left(\\gamma + \\kappa\\,(k_x^{2}+k_y^{2})\\right)\\,\\sin(k_x x)\\,\\cos(k_y y)\\;+\\;\\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\\;+\\;\\cos(\\omega t)\\,\\kappa\\,(k_x^{2}+k_y^{2})\\,\\cos(k_x x)\\,\\sin(k_y y)\\;-\\;\\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y)\\;-\\;\\omega\\,\\sin(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y)}$$"
        }
    ]
}