{
    "hands_on_practices": [
        {
            "introduction": "动手实践的第一步是掌握分析数值方法的基本功。我们从一个常微分方程（ODE）求解器——经典的休恩方法（Heun's method）——开始，它常用于简化版的海洋模型中。通过对该方法进行泰勒级数展开，我们可以从第一性原理出发，推导出其局部截断误差，这是衡量单步计算精度的关键指标 。这项练习旨在训练你通过严谨的数学推导来确定一个数值格式的精度阶，并理解局部误差与全局精度之间的重要联系。",
            "id": "3817323",
            "problem": "一个经典的一维海洋混合层模型通过标量常微分方程 $T^{\\prime}(t) = f(t, T(t))$ 来近似一个控制体积内垂直均匀示踪剂（例如温度）的演化，其中 $f$ 对其两个参数都足够光滑，并且源于具有指定源和汇的热量守恒。考虑使用 Heun 方法（也称为显式梯形法则或显式二阶 Runge–Kutta 方法）将此模型从 $t_n$ 推进到 $t_{n+1} = t_n + h$，该方法定义如下\n- $k_1 = f(t_n, T_n)$,\n- $k_2 = f(t_n + h, T_n + h k_1)$,\n- $T_{n+1}^{H} = T_n + \\frac{h}{2}\\left(k_1 + k_2\\right)$,\n其中 $T_n$ 近似 $T(t_n)$。\n\n从精确值 $T(t_n)$（代替 $T_n$）出发，通过将所有项在 $\\,(t_n, T(t_n))\\,$ 附近进行泰勒展开，并保留所有直至 $h^3$ 阶的贡献项，推导单步局部截断误差 $\\,\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}\\,$。将你的结果用时间导数 $T^{\\prime\\prime}(t_n)$、$T^{(3)}(t_n)$ 和在 $t_n$ 处精确解上求值的偏导数 $f_T(t_n, T(t_n)) \\equiv \\partial f/\\partial T$ 表示为一个封闭的解析形式。利用这个误差，在适用于相容单步法的光滑性和稳定性假设下，证明 Heun 方法对于此海洋混合层常微分方程具有二阶全局精度。\n\n你的最终答案必须是 $\\,\\tau_{n+1}\\,$ 的主阶项关于 $\\,h\\,$, $\\,T^{\\prime\\prime}(t_n)\\,$, $\\,T^{(3)}(t_n)\\,$ 和 $\\,f_T(t_n, T(t_n))\\,$ 的一个单一封闭形式解析表达式。不包含单位。不要四舍五入。",
            "solution": "该问题陈述具有科学依据、适定且客观。它提出了一个数值分析中的标准任务：推导一种著名的 Runge-Kutta 方法（Heun 方法）的局部截断误差，并随后分析其精度阶。所有定义和条件都是标准的且自洽的。因此，该问题是有效的，我们可以进行求解。\n\n目标是推导 Heun 方法的单步局部截断误差 $\\tau_{n+1}$。局部截断误差定义为在时间 $t_{n+1}$ 的精确解与从时间 $t_n$ 的精确解出发进行单步计算得到的数值近似解之间的差值。设 $T(t)$ 是常微分方程 $T^{\\prime}(t) = f(t, T(t))$ 的精确解。因此局部截断误差由 $\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}$ 给出，其中数值解 $T_{n+1}^{H}$ 是从精确值 $T_n = T(t_n)$ 开始计算的。\n\n首先，我们使用泰勒级数将精确解 $T(t_{n+1})$ 在 $t_n$ 附近展开，其中 $t_{n+1} = t_n + h$。\n$$T(t_{n+1}) = T(t_n + h) = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) + O(h^4)$$\n$T(t)$ 的导数在 $t_n$ 处求值。\n\n接下来，我们分析从精确解值 $T(t_n)$ 出发，通过 Heun 方法单步计算得到的数值解 $T_{n+1}^{H}$：\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2}(k_1 + k_2)$$\n系数 $k_1$ 和 $k_2$ 定义为：\n$$k_1 = f(t_n, T(t_n))$$\n$$k_2 = f(t_n + h, T(t_n) + h k_1)$$\n由于 $T(t)$ 是精确解，我们有 $T^{\\prime}(t) = f(t, T(t))$。因此，$k_1 = T^{\\prime}(t_n)$。\n\n为了找到一个与 $T(t_{n+1})$ 的泰勒级数相当的 $T_{n+1}^{H}$ 表达式，我们必须将 $k_2$ 作为一个二元函数在点 $(t_n, T(t_n))$ 附近展开为泰勒级数。设 $f_t = \\frac{\\partial f}{\\partial t}$, $f_T = \\frac{\\partial f}{\\partial T}$, $f_{tt} = \\frac{\\partial^2 f}{\\partial t^2}$, $f_{tT} = \\frac{\\partial^2 f}{\\partial t \\partial T}$, 以及 $f_{TT} = \\frac{\\partial^2 f}{\\partial T^2}$，所有偏导数均在 $(t_n, T(t_n))$ 处求值。展开式为：\n$$k_2 = f(t_n+h, T(t_n)+hk_1) = f(t_n, T(t_n)) + h f_t + (hk_1) f_T + \\frac{1}{2}\\left(h^2 f_{tt} + 2h(hk_1)f_{tT} + (hk_1)^2 f_{TT}\\right) + O(h^3)$$\n代入 $k_1 = T^{\\prime}(t_n)$ 和 $f(t_n, T(t_n)) = T^{\\prime}(t_n)$:\n$$k_2 = T^{\\prime}(t_n) + h \\left(f_t + T^{\\prime}(t_n) f_T\\right) + \\frac{h^2}{2}\\left(f_{tt} + 2T^{\\prime}(t_n) f_{tT} + (T^{\\prime}(t_n))^2 f_{TT}\\right) + O(h^3)$$\n\n现在，我们将 $f$ 的偏导数与 $T$ 的全时间导数联系起来。对 $T^{\\prime}(t) = f(t, T(t))$ 使用链式法则：\n$$T^{\\prime\\prime}(t) = \\frac{d}{dt}f(t, T(t)) = \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial T}\\frac{dT}{dt} = f_t + f_T T^{\\prime}(t)$$\n再次对 $t$ 求导：\n$$T^{(3)}(t) = \\frac{d}{dt}\\left(f_t + f_T T^{\\prime}(t)\\right) = \\left(\\frac{\\partial f_t}{\\partial t} + \\frac{\\partial f_t}{\\partial T}\\frac{dT}{dt}\\right) + \\left(\\frac{\\partial f_T}{\\partial t} + \\frac{\\partial f_T}{\\partial T}\\frac{dT}{dt}\\right)T^{\\prime}(t) + f_T T^{\\prime\\prime}(t)$$\n$$T^{(3)}(t) = (f_{tt} + f_{tT}T^{\\prime}) + (f_{Tt} + f_{TT}T^{\\prime})T^{\\prime} + f_T T^{\\prime\\prime}$$\n由于假设 $f$ 足够光滑，混合偏导数相等，$f_{tT} = f_{Tt}$。\n$$T^{(3)}(t_n) = f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} + f_T T^{\\prime\\prime}(t_n)$$\n由此，我们可以表示出 $k_2$ 展开式中 $O(h^2)$ 部分的项：\n$$f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} = T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)$$\n\n将这些全导数表达式代回到 $k_2$ 的展开式中：\n$$k_2 = T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}\\left(T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n)\\right) + O(h^3)$$\n\n现在我们将 $k_1$ 和 $k_2$ 的表达式代入 $T_{n+1}^{H}$ 的公式中：\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ T^{\\prime}(t_n) + \\left( T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ 2T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4}\\left( T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\n\n最后，我们计算局部截断误差 $\\tau_{n+1} = T(t_{n+1}) - T_{n+1}^{H}$：\n$$\\tau_{n+1} = \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) \\right) - \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4} T^{(3)}(t_n) - \\frac{h^3}{4} f_T T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\n$h^0$, $h^1$ 和 $h^2$ 阶的项相互抵消。我们收集 $h^3$ 阶的项：\n$$\\tau_{n+1} = \\left(\\frac{1}{6} - \\frac{1}{4}\\right) h^3 T^{(3)}(t_n) + \\frac{h^3}{4} f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\n$$\\tau_{n+1} = -\\frac{1}{12} h^3 T^{(3)}(t_n) + \\frac{3}{12} h^3 f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\n局部截断误差的主阶项为：\n$$\\tau_{n+1} = \\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right) + O(h^4)$$\n\n为了证明其二阶全局精度，我们分析这个结果。如果一个数值方法的局部截断误差 $\\tau_{n+1}$ 是 $h^{p+1}$ 阶，则称该方法为 $p$ 阶方法。在本例中，我们发现 $\\tau_{n+1} = O(h^3)$，这意味着该方法是 $p=2$ 阶的。\n该方法是相容的，因为 $\\lim_{h\\to 0} \\frac{\\tau_{n+1}}{h} = \\lim_{h\\to 0} O(h^2) = 0$。\n常微分方程数值分析的基本定理（归功于 Dahlquist）指出，对于一个相容的单步法，稳定性是收敛的充分条件。此外，如果方法是 $p$ 阶且稳定的（对于 Runge-Kutta 方法，如果 $f$ 是 Lipschitz 连续的，稳定性就得到保证，这是光滑性假设的一个推论），那么在固定时间 $t_N = t_0 + Nh$ 的全局误差 $E_N = T(t_N) - T_N$ 是 $p$ 阶的。\n由于 Heun 方法是 $p=2$ 阶的，其全局误差为 $O(h^2)$。因此，该方法具有二阶全局精度。\n局部截断误差的主阶项是 $h^3$ 阶的表达式。",
            "answer": "$$\\boxed{\\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right)}$$"
        },
        {
            "introduction": "在理想的周期性区域中分析数值格式后，我们必须面对一个更现实的挑战：处理计算区域的边界。一个数值方案的整体精度往往受限于其在边界处的表现，而非内部格式。本练习将探讨一个朴素的边界处理方式如何降低一个高阶格式的精度，并引导你使用“虚拟单元”（ghost-cell）方法来设计一个能恢复所需精度阶的边界条件 。通过这个实践，你将深刻理解边界条件在计算科学中的关键作用，并掌握维持全局高精度的重要技巧。",
            "id": "4000115",
            "problem": "考虑在区域 $x \\in [0,L]$ 内的一根均匀杆中的一维稳态热传导，其热导率 $k$ 为常数。设温度场为 $T(x)$，假定其足够光滑，并设傅里叶热传导定律指出热通量为 $q(x) = -k \\,\\frac{dT}{dx}(x)$。位于 $x=0$ 的左边界保持在固定温度 $T(0)=T_{b}$（狄利克雷条件）。使用均匀的有限体积网格将区域离散化，该网格包含 $N$ 个宽度为 $h = L/N$ 的控制体积，单元中心位于 $x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$（$i=1,2,\\dots,N$），左边界面位于 $x=\\tfrac{1}{2}(x_{0}+x_{1})=0$。此处 $x_{0}=-\\tfrac{h}{2}$ 是为了在边界处能够使用内部格式而引入的虚拟单元中心的位置。相邻单元中心之间的面法向温度梯度的内部二阶中心差分近似为\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=(x_{i}+x_{i+1})/2} \\approx \\frac{T_{i+1}-T_{i}}{h}.\n$$\n在左边界面处，假设通过使用朴素的单侧面心格式来近似面法向梯度，从而施加狄利克雷边界条件，而无需任何特殊的边界修正\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=0} \\approx \\frac{T_{1} - T_{b}}{h/2}.\n$$\n使用关于 $x=0$ 的泰勒级数展开以及截断误差和相容性的定义，确定此朴素边界近似对面法向梯度的局部精度阶数，并将其与内部的二阶精度进行比较。然后，提出并推导一个边界修正方案，通过选择一个表示为 $T_{b}$、$T_{1}$ 和 $T_{2}$ 线性组合的合适的虚拟单元值 $T_{0}$，在左边界处恢复二阶精度，同时允许使用内部中心差分格式 $\\left(T_{1}-T_{0}\\right)/h$。\n\n你的任务是：\n- 推导朴素边界近似 $\\left(T_{1}-T_{b}\\right)/(h/2)$ 对 $\\left.dT/dx\\right|_{x=0}$ 的截断误差，并说明其关于 $h$ 的阶数。\n- 确定相对于内部二阶近似，边界处产生的精度阶数损失。\n- 通过选择 $T_0$ 推导一个二阶精度的边界修正，使得内部中心差分格式 $(T_{1}-T_{0})/h$ 能以二阶精度近似 $\\left.dT/dx\\right|_{x=0}$，并提供 $T_{0}$ 关于 $T_{b}$、$T_{1}$ 和 $T_{2}$ 的显式表达式。\n\n将你的最终答案表示为一个行矩阵，其中包含：\n1) 边界处的整数阶精度损失，以及\n2) 用 $T_{b}$、$T_{1}$ 和 $T_{2}$ 符号表示的修正后的虚拟单元值 $T_{0}$。\n\n不需要进行数值计算；请提供精确的符号表达式。最终答案中无需报告物理单位。",
            "solution": "该问题要求解决三项内容：温度梯度的朴素边界近似的精度阶数，与内部格式相比产生的精度阶数损失，以及推导一个能够在边界处恢复二阶精度的虚拟单元值 $T_{0}$。我们将使用泰勒级数分析依次解决每个任务。\n\n区域被离散化，单元中心位于 $x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$。因此，第一个单元中心位于 $x_{1} = h/2$，第二个单元中心位于 $x_{2} = 3h/2$。狄利克雷边界位于 $x=0$，其中 $T(0) = T_{b}$。我们假设温度场 $T(x)$ 足够光滑，允许进行泰勒级数展开。\n\n首先，我们分析梯度 $\\left.\\frac{dT}{dx}\\right|_{x=0}$ 的朴素边界近似的截断误差。该近似由下式给出：\n$$\nD_{\\text{naive}} = \\frac{T_{1} - T_{b}}{h/2}\n$$\n其中 $T_{1}$ 是第一个单元中心的温度 $T(x_1) = T(h/2)$，$T_b$ 是边界温度 $T(0)$。为求截断误差，我们将 $T(h/2)$ 在 $x=0$ 处进行泰勒级数展开：\n$$\nT_{1} = T(h/2) = T(0) + \\left.\\frac{dT}{dx}\\right|_{x=0} \\left(\\frac{h}{2}\\right) + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{(h/2)^2}{2!} + \\left.\\frac{d^3T}{dx^3}\\right|_{x=0} \\frac{(h/2)^3}{3!} + \\dots\n$$\n代入 $T(0) = T_{b}$ 并化简：\n$$\nT_{1} = T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3)\n$$\n现在，将此展开式代入 $D_{\\text{naive}}$ 的公式中：\n$$\nD_{\\text{naive}} = \\frac{1}{h/2} \\left[ \\left( T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right) - T_{b} \\right]\n$$\n$$\nD_{\\text{naive}} = \\frac{2}{h} \\left[ \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right]\n$$\n$$\nD_{\\text{naive}} = \\left.\\frac{dT}{dx}\\right|_{x=0} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h}{4} + O(h^2)\n$$\n截断误差 $\\tau_{\\text{naive}}$ 是近似值与精确值之差：\n$$\n\\tau_{\\text{naive}} = D_{\\text{naive}} - \\left.\\frac{dT}{dx}\\right|_{x=0} = \\frac{h}{4} \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} + O(h^2)\n$$\n误差中的主导项与 $h^1$ 成正比，因此朴素的边界近似是一阶精度的，即其精度阶数为 $p_{\\text{naive}} = 1$。\n\n问题陈述中提到，内部近似是二阶精度的（$p_{\\text{int}} = 2$）。边界处的精度阶数损失是内部阶数与边界阶数之差：\n$$\n\\text{Order Loss} = p_{\\text{int}} - p_{\\text{naive}} = 2 - 1 = 1\n$$\n至此完成了前两个任务。\n\n对于第三个任务，我们需要找到一个虚拟单元温度值 $T_0$，使得中心差分格式 $\\frac{T_1 - T_0}{h}$ 能为边界处的梯度 $\\left.\\frac{dT}{dx}\\right|_{x=0}$ 提供一个二阶精度的近似。该格式是中心差分，因为它使用了点 $x_1 = h/2$ 和虚拟单元中心 $x_0 = -h/2$，并且以它们的中点 $x=0$ 为中心。\n已知此中心差分格式的截断误差是二阶的：\n$$\n\\frac{T(h/2) - T(-h/2)}{h} = \\left.\\frac{dT}{dx}\\right|_{x=0} + O(h^2)\n$$\n为达到此精度，我们必须将 $T_0$ 定义为 $T(-h/2)$ 的一个二阶精度近似。我们可以通过对已知值 $T_b = T(0)$、$T_1 = T(h/2)$ 和 $T_2 = T(3h/2)$ 进行外插来构造这样的近似。我们可以用一个二次多项式 $P(x)$ 拟合这三个点，并在 $x=-h/2$ 处求值。\n设插值多项式为 $P(x) = ax^2 + bx + c$。那么 $T_0$ 的值就是 $P(-h/2)$。\n求 $P(-h/2)$ 的一个直接方法是使用拉格朗日插值公式。这三个点是 $(0, T_b)$、$(h/2, T_1)$ 和 $(3h/2, T_2)$。我们想要求出插值多项式在 $x = -h/2$ 处的值。\n$$\nP(x) = T_b L_0(x) + T_1 L_1(x) + T_2 L_2(x)\n$$\n其中 $L_i(x)$ 是拉格朗日基多项式。我们需要在 $x=-h/2$ 处对它们求值。\n对于 $L_0(x) = \\frac{(x-h/2)(x-3h/2)}{(0-h/2)(0-3h/2)}$:\n$$\nL_0(-h/2) = \\frac{(-h/2-h/2)(-h/2-3h/2)}{(0-h/2)(0-3h/2)} = \\frac{(-h)(-2h)}{3h^2/4} = \\frac{2h^2}{3h^2/4} = \\frac{8}{3}\n$$\n对于 $L_1(x) = \\frac{(x-0)(x-3h/2)}{(h/2-0)(h/2-3h/2)}$:\n$$\nL_1(-h/2) = \\frac{(-h/2)(-h/2-3h/2)}{(h/2)(-h)} = \\frac{(-h/2)(-2h)}{-h^2/2} = \\frac{h^2}{-h^2/2} = -2\n$$\n对于 $L_2(x) = \\frac{(x-0)(x-h/2)}{(3h/2-0)(3h/2-h/2)}$:\n$$\nL_2(-h/2) = \\frac{(-h/2)(-h/2-h/2)}{(3h/2)(h)} = \\frac{(-h/2)(-h)}{3h^2/2} = \\frac{h^2/2}{3h^2/2} = \\frac{1}{3}\n$$\n现在，我们组合这些结果来求 $T_0 = P(-h/2)$：\n$$\nT_0 = T_b L_0(-h/2) + T_1 L_1(-h/2) + T_2 L_2(-h/2) = T_b \\left(\\frac{8}{3}\\right) + T_1(-2) + T_2\\left(\\frac{1}{3}\\right)\n$$\n$$\nT_0 = \\frac{8}{3}T_b - 2T_1 + \\frac{1}{3}T_2\n$$\n整理此表达式可得到虚拟单元值的最终形式：\n$$\nT_0 = \\frac{8T_b - 6T_1 + T_2}{3}\n$$\n使用这个 $T_0$ 值可确保格式 $\\frac{T_1 - T_0}{h}$ 以二阶精度近似 $\\left.\\frac{dT}{dx}\\right|_{x=0}$。\n\n最终答案的两个部分是整数阶精度损失（为 $1$）和推导出的 $T_0$ 表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{8T_b - 6T_1 + T_2}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "最后的实践旨在连接理论分析与计算验证，形成一个完整的知识闭环。我们将研究用于求解平流方程的著名Lax-Wendroff格式，它是计算流体动力学中的一个基石。此练习分为两部分：首先，你将像之前一样，从理论上推导该格式的局部截断误差；然后，你将编写代码，通过一个已知的精确解来数值计算误差，并验证所观察到的精度阶是否与理论预测相符 。这项综合性练习展示了理论分析如何指导我们的预期，以及计算实验如何被用来验证代码的正确性，这是构建可靠科学软件的根本。",
            "id": "3817399",
            "problem": "考虑一个周期性海洋通道中被动标量浓度场的一维平流。其控制方程为线性平流方程 $c_t + U c_x = 0$，其中 $c(x,t)$ 是标量浓度，$U$ 是恒定的平流速度，下标表示对时间 $t$ 和空间 $x$ 的偏导数。角度必须以弧度处理。假设一个长度为 $L$ 的无量纲域，具有周期性边界条件，并使用无量纲公式，其中所有物理量均为无量纲。\n\n一个精确的行波解是 $c(x,t) = \\sin(k x - \\omega t)$，其中 $\\omega = U k$，$k$ 是空间波数，$\\omega$ 是角频率。该解在 $x$ 和 $t$ 上都是严格周期的，并且在给定的关系 $\\omega = U k$ 下满足平流方程。\n\n我们考虑在均匀网格上对平流方程进行如下的显式、两步时空离散化，网格间距为 $\\Delta x$，时间步长为 $\\Delta t$，该方法被称为Lax–Wendroff (LW) 格式（此处为常数 $U$ 和正数 $U$ 定义）：\n$$\nc_i^{n+1} = c_i^n - \\frac{\\lambda}{2} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{\\lambda^2}{2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right),\n$$\n其中 $c_i^n$ 表示在网格点 $x_i$ 和时间 $t^n$ 的数值近似解，$\\lambda = \\frac{U \\Delta t}{\\Delta x}$ 是Courant–Friedrichs–Lewy (CFL) 数。为了施加周期性边界条件，索引 $i+1$ 和 $i-1$ 对网格点总数取模。\n\n任务1（推导）：从线性平流方程 $c_t + U c_x = 0$ 和上述LW离散格式出发，推导LW格式的局部截断误差 $\\tau(x,t;\\Delta x,\\Delta t)$，通过将精确解 $c(x,t)$ 代入LW更新方程，围绕点 $(x,t)$ 进行时间和空间上的泰勒展开，并使用控制方程消去时间导数，以空间导数代之。你的推导必须将 $\\tau$ 表示为关于 $\\Delta x$ 和 $\\Delta t$ 的主阶渐近级数，从而证明该格式的相容性并确定其精度阶。\n\n任务2（从离散残差计算观测阶）：当使用精确解时，将在网格点 $x_i$ 和时间层 $t^n$ 的离散残差定义为\n$$\nR_i^n = c(x_i,t^{n+1}) - \\left[ c(x_i,t^n) - \\frac{\\lambda}{2}\\left(c(x_{i+1},t^n) - c(x_{i-1},t^n)\\right) + \\frac{\\lambda^2}{2}\\left(c(x_{i+1},t^n) - 2c(x_i,t^n) + c(x_{i-1},t^n)\\right) \\right].\n$$\n那么在 $(x_i,t^n)$ 处的局部截断误差为 $\\tau_i^n = \\frac{R_i^n}{\\Delta t}$。使用离散 $\\ell^2$ 范数\n$$\n\\|\\tau\\|_2 = \\left( \\Delta x \\sum_{i} (\\tau_i^n)^2 \\right)^{1/2}\n$$\n来衡量在固定时间 $t^n$ 下整个空间网格上局部截断误差的大小。对于每个测试用例，在一系列加密的网格上计算 $\\|\\tau\\|_2$，并使用两个最精细的网格间距 $\\Delta x_{\\text{fine}}$ 和 $\\Delta x_{\\text{finer}}$ 来估计观测阶 $p$：\n$$\np \\approx \\frac{\\log\\left(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}}\\right)}{\\log\\left(\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}}\\right)}.\n$$\n\n实现要求：\n- 使用精确解 $c(x,t) = \\sin(k x - \\omega t)$，其中 $\\omega = U k$。\n- 使用均匀网格，其中 $x_i = i \\Delta x$，$i = 0,1,\\dots,N_x-1$，并采用周期性边界条件。在计算 $R_i^n$ 和 $\\tau_i^n$ 时，设置 $t^n = 0$，并定义 $t^{n+1} = t^n + \\Delta t$。\n- 对于每个网格，通过测试用例中提供的固定CFL数 $\\lambda = \\frac{U \\Delta t}{\\Delta x}$ 来设置 $\\Delta t$，以平衡截断误差中空间和时间部分的贡献。\n- 角度以弧度为单位。所有物理量均为无量纲。\n\n测试套件：\n对于每个测试用例，参数为 $(U,k,L,\\lambda,\\{N_x\\})$，其中 $L$ 是域长度，$\\lambda$ 是CFL数，$\\{N_x\\}$ 是用于估计阶数的网格分辨率集合。使用以下三个测试用例：\n1. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 2\\pi, 1, 0.4, \\{50, 100, 200\\})$。\n2. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 10\\pi, 1, 0.4, \\{100, 200, 400\\})$。\n3. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 4\\pi, 1, 0.9, \\{60, 120, 240\\})$。\n\n答案规格：\n- 你的程序必须对每个测试用例，使用 $\\{N_x\\}$ 中两个最精细的网格计算观测阶 $p$，并将每个 $p$ 四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含三个结果，格式为逗号分隔的列表并用方括号括起来，例如 $[p_1,p_2,p_3]$。",
            "solution": "该问题被评估为有效。这是一个在计算科学领域内适定且具有科学依据的问题，具体涉及偏微分方程的数值分析。所有参数、方程和步骤都已明确定义，从而可以得到唯一且可验证的解。我们将着手执行所概述的两项任务。\n\n### 任务1：局部截断误差的推导\n\n第一项任务是推导应用于线性平流方程 $c_t + U c_x = 0$ 的Lax-Wendroff (LW) 格式的局部截断误差 $\\tau$。局部截断误差是通过将精确解 $c(x,t)$ 代入有限差分格式并量化其残差来求得的。\n\nLW格式由下式给出：\n$$\nc_i^{n+1} = c_i^n - \\frac{\\lambda}{2} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{\\lambda^2}{2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\n其中 $\\lambda = \\frac{U \\Delta t}{\\Delta x}$。为了求截断误差，我们重排该格式，以表示其所近似的微分算子 $L = \\partial_t + U \\partial_x$。\n\n首先，我们两边同除以 $\\Delta t$：\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = - \\frac{U \\Delta t}{2 \\Delta x \\Delta t} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{U^2 (\\Delta t)^2}{2 (\\Delta x)^2 \\Delta t} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = - \\frac{U}{2 \\Delta x} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{U^2 \\Delta t}{2 (\\Delta x)^2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\n截断误差 $\\tau(x,t)$ 定义为将精确解 $c(x,t)$ 代入数值算子后得到的残差。我们在点 $(x,t)$（对应于 $(x_i, t^n)$）处计算所有项。\n$$\n\\tau(x,t) = \\frac{c(x, t+\\Delta t) - c(x, t)}{\\Delta t} + U \\frac{c(x+\\Delta x, t) - c(x-\\Delta x, t)}{2 \\Delta x} - \\frac{U^2 \\Delta t}{2} \\frac{c(x+\\Delta x, t) - 2c(x, t) + c(x-\\Delta x, t)}{(\\Delta x)^2}\n$$\n现在我们对每一项围绕点 $(x,t)$ 进行泰勒级数展开。为清晰起见，我们使用下标表示法表示偏导数（例如，$c_t = \\frac{\\partial c}{\\partial t}$，$c_{xx} = \\frac{\\partial^2 c}{\\partial x^2}$）。\n\n第1项（时间上的向前差分）：\n$$\n\\frac{c(x, t+\\Delta t) - c(x, t)}{\\Delta t} = \\frac{1}{\\Delta t} \\left[ \\left(c + \\Delta t c_t + \\frac{(\\Delta t)^2}{2} c_{tt} + \\frac{(\\Delta t)^3}{6} c_{ttt} + \\dots \\right) - c \\right] = c_t + \\frac{\\Delta t}{2} c_{tt} + \\frac{(\\Delta t)^2}{6} c_{ttt} + O((\\Delta t)^3)\n$$\n第2项（$c_x$ 的空间中心差分）：\n$$\nU \\frac{c(x+\\Delta x, t) - c(x-\\Delta x, t)}{2 \\Delta x} = \\frac{U}{2 \\Delta x} \\left[ \\left(c + \\Delta x c_x + \\frac{(\\Delta x)^2}{2} c_{xx} + \\frac{(\\Delta x)^3}{6} c_{xxx} + \\dots \\right) - \\left(c - \\Delta x c_x + \\frac{(\\Delta x)^2}{2} c_{xx} - \\frac{(\\Delta x)^3}{6} c_{xxx} + \\dots \\right) \\right]\n$$\n$$\n= \\frac{U}{2 \\Delta x} \\left[ 2 \\Delta x c_x + \\frac{(\\Delta x)^3}{3} c_{xxx} + O((\\Delta x)^5) \\right] = U c_x + \\frac{U (\\Delta x)^2}{6} c_{xxx} + O((\\Delta x)^4)\n$$\n第3项（$c_{xx}$ 的空间中心差分）：\n$$\n- \\frac{U^2 \\Delta t}{2} \\frac{c(x+\\Delta x, t) - 2c(x, t) + c(x-\\Delta x, t)}{(\\Delta x)^2} = - \\frac{U^2 \\Delta t}{2} \\left[ c_{xx} + \\frac{(\\Delta x)^2}{12} c_{xxxx} + O((\\Delta x)^4) \\right] = - \\frac{U^2 \\Delta t}{2} c_{xx} - \\frac{U^2 \\Delta t (\\Delta x)^2}{24} c_{xxxx} + O(\\Delta t(\\Delta x)^4)\n$$\n将这些展开式合并到 $\\tau(x,t)$ 的表达式中：\n$$\n\\tau(x,t) = \\left( c_t + \\frac{\\Delta t}{2} c_{tt} + \\frac{(\\Delta t)^2}{6} c_{ttt} \\right) + \\left( U c_x + \\frac{U (\\Delta x)^2}{6} c_{xxx} \\right) - \\left( \\frac{U^2 \\Delta t}{2} c_{xx} \\right) + \\text{H.O.T.}\n$$\n我们按导数对各项进行分组：\n$$\n\\tau(x,t) = (c_t + U c_x) + \\frac{\\Delta t}{2} (c_{tt} - U^2 c_{xx}) + \\frac{(\\Delta t)^2}{6} c_{ttt} + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\n精确解满足控制方程 $c_t + U c_x = 0$。这意味着该格式是*相容的*，因为 $\\tau$ 的主项不是零阶的。此外，我们可以使用控制方程将高阶时间导数表示为空间导数：\n$c_{t} = -U c_{x}$\n$c_{tt} = \\partial_t(-U c_x) = -U c_{xt} = -U \\partial_x(c_t) = -U \\partial_x(-U c_x) = U^2 c_{xx}$\n$c_{ttt} = \\partial_t(U^2 c_{xx}) = U^2 c_{xxt} = U^2 \\partial_{xx}(-U c_x) = -U^3 c_{xxx}$\n\n将这些关系代回 $\\tau(x,t)$ 的表达式中：\n1. 项 $(c_t + U c_x)$ 为 $0$。\n2. 项 $\\frac{\\Delta t}{2} (c_{tt} - U^2 c_{xx}) = \\frac{\\Delta t}{2} (U^2 c_{xx} - U^2 c_{xx})$ 也为 $0$。这种抵消是Lax-Wendroff构造方法的标志，它提高了格式的精度。\n\n余下的主阶项是：\n$$\n\\tau(x,t) = \\frac{(\\Delta t)^2}{6} c_{ttt} + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\n代入 $c_{ttt} = -U^3 c_{xxx}$：\n$$\n\\tau(x,t) = \\frac{(\\Delta t)^2}{6} (-U^3 c_{xxx}) + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\n$$\n\\tau(x,t) = \\frac{U c_{xxx}}{6} \\left( (\\Delta x)^2 - U^2 (\\Delta t)^2 \\right) + \\text{H.O.T.}\n$$\n使用CFL数的定义 $\\lambda = \\frac{U \\Delta t}{\\Delta x}$，我们可以写出 $\\Delta t = \\frac{\\lambda \\Delta x}{U}$。表达式变为：\n$$\n\\tau(x,t) = \\frac{U c_{xxx}}{6} \\left( (\\Delta x)^2 - U^2 \\frac{\\lambda^2 (\\Delta x)^2}{U^2} \\right) + \\text{H.O.T.} = \\frac{U (\\Delta x)^2}{6} (1 - \\lambda^2) c_{xxx} + \\text{H.O.T.}\n$$\n主误差项也包含 $(\\Delta t)^2$，所以我们可以写出 $\\tau(x,t) = O((\\Delta x)^2, (\\Delta t)^2)$。由于数值实验固定了 $\\lambda$，$\\Delta t$ 与 $\\Delta x$ 成正比。因此，总体精度阶为二阶，我们预期观测阶 $p$ 为 $2$。\n\n### 任务2：观测精度阶\n\n第二项任务是数值验证精度阶。这包括在一系列网格上计算截断误差，并利用结果估计收敛阶 $p$。方法如下：\n1.  对于每个测试用例 $(U, k, L, \\lambda, \\{N_x\\})$，我们遍历提供的网格分辨率 $N_x$。\n2.  对于给定的 $N_x$，我们定义网格参数：网格间距 $\\Delta x = L / N_x$ 和时间步长 $\\Delta t = \\lambda \\Delta x / U$。\n3.  我们定义空间网格 $x_i = i \\Delta x$，$i = 0, 1, \\dots, N_x-1$。\n4.  我们在时间 $t^n=0$ 和 $t^{n+1}=\\Delta t$ 处计算精确解：\n    $c(x_i, t^n) = \\sin(k x_i)$\n    $c(x_i, t^{n+1}) = \\sin(k x_i - \\omega \\Delta t)$，其中 $\\omega = U k$。\n5.  我们通过将LW算子应用于 $t^n$ 时的精确解，来计算 $t^{n+1}$ 时的数值解，记为 $c_i^{n+1, \\text{num}}$：\n    $c_i^{n+1, \\text{num}} = c(x_i,t^n) - \\frac{\\lambda}{2}(c(x_{i+1},t^n) - c(x_{i-1},t^n)) + \\frac{\\lambda^2}{2}(c(x_{i+1},t^n) - 2c(x_i,t^n) + c(x_{i-1},t^n))$\n6.  离散残差计算为 $R_i^n = c(x_i,t^{n+1}) - c_i^{n+1, \\text{num}}$。\n7.  每个网格点上的局部截断误差为 $\\tau_i^n = R_i^n / \\Delta t$。\n8.  误差场的大小使用离散 $\\ell^2$ 范数来衡量：$\\|\\tau\\|_2 = \\sqrt{\\Delta x \\sum_{i=0}^{N_x-1} (\\tau_i^n)^2}$。\n9.  在为两个最精细的网格（对应网格间距 $\\Delta x_{\\text{fine}}$ 和 $\\Delta x_{\\text{finer}}$）计算出 $\\|\\tau\\|_2$ 后，观测阶 $p$ 使用以下公式计算：\n    $$\n    p \\approx \\frac{\\log\\left(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}}\\right)}{\\log\\left(\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}}\\right)}\n    $$\n由于每个测试用例中的分辨率选择使得 $\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}} = 2$，这可以简化为 $p \\approx \\log_2(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}})$。根据理论推导，预期的结果是 $p \\approx 2$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by computing the observed order of accuracy for the\n    Lax-Wendroff scheme for three test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (U, k, L, lambda, {N_x})\n        (1, 2 * np.pi, 1, 0.4, [50, 100, 200]),\n        (1, 10 * np.pi, 1, 0.4, [100, 200, 400]),\n        (1, 4 * np.pi, 1, 0.9, [60, 120, 240]),\n    ]\n\n    results = []\n    for case in test_cases:\n        U, k, L, lamb, Nx_list = case\n        \n        norms = []\n        dx_list = []\n\n        for Nx in Nx_list:\n            # 1. Set up grid parameters\n            dx = L / Nx\n            dt = lamb * dx / U\n            omega = U * k\n            \n            # Store dx for order calculation\n            dx_list.append(dx)\n            \n            # 2. Define spatial grid\n            x = np.arange(Nx) * dx\n            \n            # 3. Evaluate exact solution at t=0 and t=dt\n            # c(x, t=0)\n            c_n = np.sin(k * x)\n            # c(x, t=dt)\n            c_exact_np1 = np.sin(k * x - omega * dt)\n\n            # 4. Apply LW operator to exact solution at t=0\n            # Get neighbor values using periodic boundary conditions with np.roll\n            c_ip1 = np.roll(c_n, -1)\n            c_im1 = np.roll(c_n, 1)\n\n            # Compute numerical solution at t=dt, c_num_np1\n            term_central_diff = - (lamb / 2) * (c_ip1 - c_im1)\n            term_diffusion = (lamb**2 / 2) * (c_ip1 - 2 * c_n + c_im1)\n            c_num_np1 = c_n + term_central_diff + term_diffusion\n\n            # 5. Compute residual and truncation error\n            # R_i^n = c(x_i, t^{n+1}) - c_i^{n+1, num}\n            R_vec = c_exact_np1 - c_num_np1\n            # tau_i^n = R_i^n / dt\n            tau_vec = R_vec / dt\n\n            # 6. Compute the l2 norm of the truncation error\n            # ||tau||_2 = (dx * sum(tau_i^2))^(1/2)\n            norm_tau = np.sqrt(dx * np.sum(tau_vec**2))\n            norms.append(norm_tau)\n            \n        # 7. Compute observed order of accuracy p\n        # Use the two finest grids\n        norm_fine = norms[-2]\n        norm_finer = norms[-1]\n        \n        dx_fine = dx_list[-2]\n        dx_finer = dx_list[-1]\n        \n        # p = log(norm_ratio) / log(dx_ratio)\n        p = np.log(norm_fine / norm_finer) / np.log(dx_fine / dx_finer)\n        \n        # Round to six decimal places as specified\n        results.append(round(p, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}