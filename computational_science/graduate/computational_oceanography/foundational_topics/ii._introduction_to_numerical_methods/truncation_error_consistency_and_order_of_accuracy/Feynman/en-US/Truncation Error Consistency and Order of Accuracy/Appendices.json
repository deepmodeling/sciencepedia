{
    "hands_on_practices": [
        {
            "introduction": "Understanding a numerical method's accuracy begins with deriving its local truncation error. This practice provides a foundational exercise in this essential skill by analyzing Heun's method, a widely used second-order Runge-Kutta scheme. By meticulously applying Taylor series expansions, you will not only quantify the error made in a single time step but also understand the connection between the local truncation error's order and the method's global accuracy .",
            "id": "3817323",
            "problem": "A classical one-dimensional ocean mixed-layer model approximates the evolution of a vertically uniform tracer (for example, temperature) in a control volume by the scalar ordinary differential equation $T^{\\prime}(t) = f(t, T(t))$, where $f$ is sufficiently smooth in both arguments and arises from conservation of heat with specified sources and sinks. Consider advancing this model in time from $t_n$ to $t_{n+1} = t_n + h$ using Heun’s method (also known as the explicit trapezoidal rule or explicit second-order Runge–Kutta method), defined by\n- $k_1 = f(t_n, T_n)$,\n- $k_2 = f(t_n + h, T_n + h k_1)$,\n- $T_{n+1}^{H} = T_n + \\frac{h}{2}\\left(k_1 + k_2\\right)$,\nwhere $T_n$ approximates $T(t_n)$.\n\nStarting from the exact value $T(t_n)$ in place of $T_n$, derive the one-step local truncation error $\\,\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}\\,$ by Taylor expanding all terms about $\\,(t_n, T(t_n))\\,$ and retaining all contributions up to and including order $h^3$. Express your result in a closed analytic form in terms of time derivatives $T^{\\prime\\prime}(t_n)$, $T^{(3)}(t_n)$ and the partial derivative $f_T(t_n, T(t_n)) \\equiv \\partial f/\\partial T$ evaluated on the exact solution at $t_n$. Use this defect to justify the second-order global accuracy of Heun’s method for this ocean mixed-layer ordinary differential equation under smoothness and stability assumptions appropriate for consistent one-step methods.\n\nYour final answer must be a single closed-form analytic expression for the leading-order term of $\\,\\tau_{n+1}\\,$ in terms of $\\,h\\,$, $\\,T^{\\prime\\prime}(t_n)\\,$, $\\,T^{(3)}(t_n)\\,$, and $\\,f_T(t_n, T(t_n))\\,$. Do not include units. Do not round.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard task in numerical analysis: the derivation of the local truncation error for a well-known Runge-Kutta method (Heun's method) and the subsequent analysis of its order of accuracy. All definitions and conditions are standard and self-consistent. Therefore, the problem is valid and we may proceed with the solution.\n\nThe objective is to derive the one-step local truncation error, $\\tau_{n+1}$, for Heun's method. The local truncation error is defined as the difference between the exact solution at time $t_{n+1}$ and the numerical approximation obtained by taking a single step from the exact solution at time $t_n$. Let $T(t)$ be the exact solution to the ordinary differential equation $T^{\\prime}(t) = f(t, T(t))$. The local truncation error is thus given by $\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}$, where the numerical step $T_{n+1}^{H}$ is computed starting from the exact value $T_n = T(t_n)$.\n\nFirst, we expand the exact solution $T(t_{n+1})$ around $t_n$ using a Taylor series, where $t_{n+1} = t_n + h$.\n$$T(t_{n+1}) = T(t_n + h) = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) + O(h^4)$$\nThe derivatives of $T(t)$ are evaluated at $t_n$.\n\nNext, we analyze the numerical solution $T_{n+1}^{H}$ obtained from one step of Heun's method starting from the exact solution value $T(t_n)$:\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2}(k_1 + k_2)$$\nThe coefficients $k_1$ and $k_2$ are defined as:\n$$k_1 = f(t_n, T(t_n))$$\n$$k_2 = f(t_n + h, T(t_n) + h k_1)$$\nSince $T(t)$ is the exact solution, we have $T^{\\prime}(t) = f(t, T(t))$. Therefore, $k_1 = T^{\\prime}(t_n)$.\n\nTo find an expression for $T_{n+1}^{H}$ comparable to the Taylor series for $T(t_{n+1})$, we must expand $k_2$ in a Taylor series for a function of two variables around the point $(t_n, T(t_n))$. Let $f_t = \\frac{\\partial f}{\\partial t}$, $f_T = \\frac{\\partial f}{\\partial T}$, $f_{tt} = \\frac{\\partial^2 f}{\\partial t^2}$, $f_{tT} = \\frac{\\partial^2 f}{\\partial t \\partial T}$, and $f_{TT} = \\frac{\\partial^2 f}{\\partial T^2}$, with all partial derivatives evaluated at $(t_n, T(t_n))$. The expansion is:\n$$k_2 = f(t_n+h, T(t_n)+hk_1) = f(t_n, T(t_n)) + h f_t + (hk_1) f_T + \\frac{1}{2}\\left(h^2 f_{tt} + 2h(hk_1)f_{tT} + (hk_1)^2 f_{TT}\\right) + O(h^3)$$\nSubstituting $k_1 = T^{\\prime}(t_n)$ and $f(t_n, T(t_n)) = T^{\\prime}(t_n)$:\n$$k_2 = T^{\\prime}(t_n) + h \\left(f_t + T^{\\prime}(t_n) f_T\\right) + \\frac{h^2}{2}\\left(f_{tt} + 2T^{\\prime}(t_n) f_{tT} + (T^{\\prime}(t_n))^2 f_{TT}\\right) + O(h^3)$$\n\nNow, we relate the partial derivatives of $f$ to the total time derivatives of $T$. Using the chain rule on $T^{\\prime}(t) = f(t, T(t))$:\n$$T^{\\prime\\prime}(t) = \\frac{d}{dt}f(t, T(t)) = \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial T}\\frac{dT}{dt} = f_t + f_T T^{\\prime}(t)$$\nDifferentiating again with respect to $t$:\n$$T^{(3)}(t) = \\frac{d}{dt}\\left(f_t + f_T T^{\\prime}(t)\\right) = \\left(\\frac{\\partial f_t}{\\partial t} + \\frac{\\partial f_t}{\\partial T}\\frac{dT}{dt}\\right) + \\left(\\frac{\\partial f_T}{\\partial t} + \\frac{\\partial f_T}{\\partial T}\\frac{dT}{dt}\\right)T^{\\prime}(t) + f_T T^{\\prime\\prime}(t)$$\n$$T^{(3)}(t) = (f_{tt} + f_{tT}T^{\\prime}) + (f_{Tt} + f_{TT}T^{\\prime})T^{\\prime} + f_T T^{\\prime\\prime}$$\nSince $f$ is assumed to be sufficiently smooth, the mixed partial derivatives are equal, $f_{tT} = f_{Tt}$.\n$$T^{(3)}(t_n) = f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} + f_T T^{\\prime\\prime}(t_n)$$\nFrom this, we can express the term in the $O(h^2)$ part of the $k_2$ expansion:\n$$f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} = T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)$$\n\nSubstituting these total derivative expressions back into the expansion for $k_2$:\n$$k_2 = T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}\\left(T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n)\\right) + O(h^3)$$\n\nNow we substitute the expressions for $k_1$ and $k_2$ into the formula for $T_{n+1}^{H}$:\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ T^{\\prime}(t_n) + \\left( T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ 2T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4}\\left( T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\n\nFinally, we compute the local truncation error $\\tau_{n+1} = T(t_{n+1}) - T_{n+1}^{H}$:\n$$\\tau_{n+1} = \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) \\right) - \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4} T^{(3)}(t_n) - \\frac{h^3}{4} f_T T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\nThe terms of order $h^0$, $h^1$, and $h^2$ cancel out. We collect the terms of order $h^3$:\n$$\\tau_{n+1} = \\left(\\frac{1}{6} - \\frac{1}{4}\\right) h^3 T^{(3)}(t_n) + \\frac{h^3}{4} f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\n$$\\tau_{n+1} = -\\frac{1}{12} h^3 T^{(3)}(t_n) + \\frac{3}{12} h^3 f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\nThe leading-order term of the local truncation error is:\n$$\\tau_{n+1} = \\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right) + O(h^4)$$\n\nTo justify the second-order global accuracy, we analyze this result. A numerical method is said to be of order $p$ if its local truncation error $\\tau_{n+1}$ is of order $h^{p+1}$. In this case, we have found that $\\tau_{n+1} = O(h^3)$, which implies that the method is of order $p=2$.\nThe method is consistent because $\\lim_{h\\to 0} \\frac{\\tau_{n+1}}{h} = \\lim_{h\\to 0} O(h^2) = 0$.\nThe fundamental theorem of numerical analysis for ODEs (attributed to Dahlquist) states that for a consistent one-step method, stability is a sufficient condition for convergence. Moreover, if the method is of order $p$ and stable (which for Runge-Kutta methods is guaranteed if $f$ is Lipschitz continuous, a consequence of the smoothness assumption), then the global error $E_N = T(t_N) - T_N$ at a fixed time $t_N = t_0 + Nh$ is of order $p$.\nSince Heun's method has order $p=2$, its global error is $O(h^2)$. Thus, the method has second-order global accuracy.\nThe leading-order term of the local truncation error is the expression of order $h^3$.",
            "answer": "$$\\boxed{\\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right)}$$"
        },
        {
            "introduction": "The overall accuracy of a numerical scheme is often dictated by its weakest link, which frequently occurs at domain boundaries. This problem explores the critical issue of order reduction at a Dirichlet boundary when an interior stencil is naively applied. You will first use Taylor series to diagnose the loss of accuracy and then engineer a higher-order boundary treatment using a \"ghost cell,\" a common and powerful technique in finite difference and finite volume methods .",
            "id": "4000115",
            "problem": "Consider one-dimensional steady heat conduction in a homogeneous rod occupying the domain $x \\in [0,L]$ with constant thermal conductivity $k$. Let the temperature field be $T(x)$, assumed sufficiently smooth, and let Fourier’s law of heat conduction state that the heat flux is $q(x) = -k \\,\\frac{dT}{dx}(x)$. The left boundary at $x=0$ is held at a fixed temperature $T(0)=T_{b}$ (Dirichlet condition). Discretize the domain using a uniform finite-volume mesh with $N$ control volumes of width $h = L/N$, cell centers at $x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$ for $i=1,2,\\dots,N$, and the left boundary face at $x=\\tfrac{1}{2}(x_{0}+x_{1})=0$, where $x_{0}=-\\tfrac{h}{2}$ is the location of a ghost cell center introduced to enable use of interior stencils at the boundary. The interior second-order central difference approximation for the face-normal temperature gradient between adjacent cell centers is\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=(x_{i}+x_{i+1})/2} \\approx \\frac{T_{i+1}-T_{i}}{h}.\n$$\nAt the left boundary face, suppose one enforces the Dirichlet boundary without any special boundary correction by approximating the face-normal gradient using the naive one-sided face-to-center formula\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=0} \\approx \\frac{T_{1} - T_{b}}{h/2}.\n$$\nUsing Taylor series expansions about $x=0$ and the definitions of truncation error and consistency, determine the local order of accuracy of this naive boundary approximation for the face-normal gradient and compare it with the interior second-order accuracy. Then, propose and derive a boundary correction that restores second-order accuracy at the left boundary while permitting use of the interior central difference stencil $\\left(T_{1}-T_{0}\\right)/h$ by choosing an appropriate ghost-cell value $T_{0}$ expressed as a linear combination of $T_{b}$, $T_{1}$, and $T_{2}$.\n\nYour tasks are:\n- Derive the truncation error of the naive boundary approximation $\\left(T_{1}-T_{b}\\right)/(h/2)$ for $\\left.dT/dx\\right|_{x=0}$ and state its order in $h$.\n- Determine the resulting order loss at the boundary relative to the interior second-order approximation.\n- Derive a second-order accurate boundary correction by choosing $T_{0}$ so that the interior central difference stencil $(T_{1}-T_{0})/h$ approximates $\\left.dT/dx\\right|_{x=0}$ with second-order accuracy, and provide the explicit expression for $T_{0}$ in terms of $T_{b}$, $T_{1}$, and $T_{2}$.\n\nExpress your final answer as a row matrix containing:\n1) the integer order loss at the boundary, and\n2) the corrected ghost-cell value $T_{0}$ expressed symbolically in terms of $T_{b}$, $T_{1}$, and $T_{2}$.\n\nNo numerical evaluation is required; provide exact symbolic expressions. There are no physical units to report in the final answer.",
            "solution": "The problem asks for three items: the order of accuracy of a naive boundary approximation for a temperature gradient, the resulting order loss compared to an interior scheme, and the derivation of a ghost-cell value $T_{0}$ that restores second-order accuracy at the boundary. We will address each task sequentially using Taylor series analysis.\n\nThe domain is discretized with cell centers at $x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$. Thus, the first cell center is at $x_{1} = h/2$ and the second is at $x_{2} = 3h/2$. The Dirichlet boundary is at $x=0$, where $T(0) = T_{b}$. We assume the temperature field $T(x)$ is sufficiently smooth to permit Taylor series expansions.\n\nFirst, we analyze the truncation error of the naive boundary approximation for the gradient, $\\left.\\frac{dT}{dx}\\right|_{x=0}$. The approximation is given by:\n$$\nD_{\\text{naive}} = \\frac{T_{1} - T_{b}}{h/2}\n$$\nwhere $T_{1}$ is the temperature at the first cell center, $T(x_1) = T(h/2)$, and $T_b$ is the boundary temperature, $T(0)$. To find the truncation error, we expand $T(h/2)$ in a Taylor series about $x=0$:\n$$\nT_{1} = T(h/2) = T(0) + \\left.\\frac{dT}{dx}\\right|_{x=0} \\left(\\frac{h}{2}\\right) + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{(h/2)^2}{2!} + \\left.\\frac{d^3T}{dx^3}\\right|_{x=0} \\frac{(h/2)^3}{3!} + \\dots\n$$\nSubstituting $T(0) = T_{b}$ and simplifying:\n$$\nT_{1} = T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3)\n$$\nNow, substitute this expansion into the formula for $D_{\\text{naive}}$:\n$$\nD_{\\text{naive}} = \\frac{1}{h/2} \\left[ \\left( T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right) - T_{b} \\right]\n$$\n$$\nD_{\\text{naive}} = \\frac{2}{h} \\left[ \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right]\n$$\n$$\nD_{\\text{naive}} = \\left.\\frac{dT}{dx}\\right|_{x=0} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h}{4} + O(h^2)\n$$\nThe truncation error, $\\tau_{\\text{naive}}$, is the difference between the approximation and the exact value:\n$$\n\\tau_{\\text{naive}} = D_{\\text{naive}} - \\left.\\frac{dT}{dx}\\right|_{x=0} = \\frac{h}{4} \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} + O(h^2)\n$$\nThe leading term in the error is proportional to $h^1$, so the naive boundary approximation is first-order accurate, i.e., its order of accuracy is $p_{\\text{naive}} = 1$.\n\nThe problem states that the interior approximation is second-order accurate ($p_{\\text{int}} = 2$). The order loss at the boundary is the difference between the interior order and the boundary order:\n$$\n\\text{Order Loss} = p_{\\text{int}} - p_{\\text{naive}} = 2 - 1 = 1\n$$\nThis completes the first two tasks.\n\nFor the third task, we need to find a value for the ghost-cell temperature, $T_0$, such that the central difference stencil $\\frac{T_1 - T_0}{h}$ provides a second-order accurate approximation for the gradient at the boundary, $\\left.\\frac{dT}{dx}\\right|_{x=0}$. The stencil is a central difference because it uses points $x_1 = h/2$ and the ghost-cell center $x_0 = -h/2$, and is centered at their midpoint, $x=0$.\nThe truncation error of this central difference scheme is known to be second-order:\n$$\n\\frac{T(h/2) - T(-h/2)}{h} = \\left.\\frac{dT}{dx}\\right|_{x=0} + O(h^2)\n$$\nTo achieve this accuracy, we must define $T_0$ as a second-order accurate approximation of $T(-h/2)$. We can construct such an approximation by extrapolation from the known values $T_b = T(0)$, $T_1 = T(h/2)$, and $T_2 = T(3h/2)$. We can fit a quadratic polynomial $P(x)$ through these three points and evaluate it at $x=-h/2$.\nLet the interpolating polynomial be $P(x) = ax^2 + bx + c$. The value of $T_0$ is then $P(-h/2)$.\nA direct way to find $P(-h/2)$ is using Lagrange's interpolation formula. The three points are $(0, T_b)$, $(h/2, T_1)$, and $(3h/2, T_2)$. We want to find the value of the interpolating polynomial at $x = -h/2$.\n$$\nP(x) = T_b L_0(x) + T_1 L_1(x) + T_2 L_2(x)\n$$\nwhere $L_i(x)$ are the Lagrange basis polynomials. We need to evaluate them at $x=-h/2$.\nFor $L_0(x) = \\frac{(x-h/2)(x-3h/2)}{(0-h/2)(0-3h/2)}$:\n$$\nL_0(-h/2) = \\frac{(-h/2-h/2)(-h/2-3h/2)}{(0-h/2)(0-3h/2)} = \\frac{(-h)(-2h)}{3h^2/4} = \\frac{2h^2}{3h^2/4} = \\frac{8}{3}\n$$\nFor $L_1(x) = \\frac{(x-0)(x-3h/2)}{(h/2-0)(h/2-3h/2)}$:\n$$\nL_1(-h/2) = \\frac{(-h/2)(-h/2-3h/2)}{(h/2)(-h)} = \\frac{(-h/2)(-2h)}{-h^2/2} = \\frac{h^2}{-h^2/2} = -2\n$$\nFor $L_2(x) = \\frac{(x-0)(x-h/2)}{(3h/2-0)(3h/2-h/2)}$:\n$$\nL_2(-h/2) = \\frac{(-h/2)(-h/2-h/2)}{(3h/2)(h)} = \\frac{(-h/2)(-h)}{3h^2/2} = \\frac{h^2/2}{3h^2/2} = \\frac{1}{3}\n$$\nNow, we combine these to find $T_0 = P(-h/2)$:\n$$\nT_0 = T_b L_0(-h/2) + T_1 L_1(-h/2) + T_2 L_2(-h/2) = T_b \\left(\\frac{8}{3}\\right) + T_1(-2) + T_2\\left(\\frac{1}{3}\\right)\n$$\n$$\nT_0 = \\frac{8}{3}T_b - 2T_1 + \\frac{1}{3}T_2\n$$\nRearranging this expression gives the final form for the ghost-cell value:\n$$\nT_0 = \\frac{8T_b - 6T_1 + T_2}{3}\n$$\nUsing this value for $T_0$ ensures that the stencil $\\frac{T_1 - T_0}{h}$ approximates $\\left.\\frac{dT}{dx}\\right|_{x=0}$ with second-order accuracy.\n\nThe two parts of the final answer are the integer order loss, which is $1$, and the derived expression for $T_0$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & \\frac{8T_b - 6T_1 + T_2}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "How can we be certain that a complex numerical code correctly solves the intended partial differential equation at its theoretical order of accuracy? The Method of Manufactured Solutions (MMS) provides a rigorous answer. This exercise guides you through the process of designing an MMS test for the advection-diffusion equation, a cornerstone of ocean modeling, by deriving the exact source term required to make a chosen analytic function a true solution of the PDE . This practice is fundamental to modern code verification and validation.",
            "id": "3817444",
            "problem": "Consider a passive tracer concentration field $C(x,y,t)$ governed by the two-dimensional advection–diffusion equation with a source/sink term $Q(x,y,t)$ on a doubly periodic domain, $x \\in [0,L_x]$, $y \\in [0,L_y]$, with smooth, divergence-free velocity. The governing equation is\n$$\n\\frac{\\partial C}{\\partial t} + u(x,y)\\,\\frac{\\partial C}{\\partial x} + v(x,y)\\,\\frac{\\partial C}{\\partial y} = \\kappa\\,\\left(\\frac{\\partial^2 C}{\\partial x^2} + \\frac{\\partial^2 C}{\\partial y^2}\\right) + Q(x,y,t),\n$$\nwhere $\\kappa>0$ is a constant molecular diffusivity. In a computational oceanography setting, one often validates a numerical implementation and its claimed spatial–temporal accuracy using the Method of Manufactured Solutions (MMS). The MMS requires selecting a sufficiently smooth $C(x,y,t)$ that respects the domain periodicity and then deriving the exact $Q(x,y,t)$ so that the chosen $C(x,y,t)$ is an exact solution of the continuous problem for the prescribed $\\kappa$, $u(x,y)$, and $v(x,y)$.\n\nYou are tasked with the following:\n\n- Starting from the definitions of truncation error, consistency, and order of accuracy for partial differential equation discretizations, explain why selecting a smooth manufactured solution with nontrivial spatiotemporal variation is necessary to probe a claimed second-order spatial–temporal scheme. Your base must be the governing advection–diffusion equation, the periodicity of the domain, and the divergence-free kinematics implied by a streamfunction representation.\n\n- Let the velocity field be generated by a streamfunction $\\psi(x,y)$ so that $u(x,y) = \\frac{\\partial \\psi}{\\partial y}$ and $v(x,y) = -\\frac{\\partial \\psi}{\\partial x}$. Choose the streamfunction\n$$\n\\psi(x,y) = \\Psi_0\\,\\sin(k_x x)\\,\\sin(k_y y),\n$$\nwith $k_x = \\frac{2\\pi}{L_x}$ and $k_y = \\frac{2\\pi}{L_y}$, where $\\Psi_0>0$ is a constant amplitude. This ensures $u_x+v_y=0$. Now, design a manufactured tracer $C(x,y,t)$ whose structure is compatible with the periodic domain and which simultaneously exercises both advection and diffusion. Use\n$$\nC(x,y,t) = \\exp(\\gamma t)\\,\\sin(k_x x)\\,\\cos(k_y y) + \\cos(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y),\n$$\nwith $\\gamma>0$ and $\\omega>0$ constants. Derive, from first principles and without invoking any shortcut formulas, the exact forcing $Q(x,y,t)$ that makes this $C(x,y,t)$ an exact solution of the advection–diffusion equation with the given $\\psi(x,y)$ and diffusivity $\\kappa$.\n\n- Briefly justify, using Taylor-series arguments applied to smooth functions and operators, what asymptotic refinement behavior is expected for the global error of a formally second-order method in both space and time when applied to this manufactured problem under grid refinement in $h$ and $\\Delta t$, assuming the computed solution is compared to the exact manufactured $C(x,y,t)$.\n\nYour final answer must be the closed-form analytic expression for $Q(x,y,t)$ as a single expression. No numerical evaluation is required. If you introduce any additional constants, you must define them. No units are required in the final answer. If you find it helpful to introduce intermediate expressions during derivation, do so, but present the final $Q(x,y,t)$ in a single, simplified analytic form.",
            "solution": "The appropriate base for analysis is the governing advection–diffusion equation and the streamfunction representation of a divergence-free velocity field. On a periodic domain, any trigonometric manufactured solution with wavenumbers compatible with the domain length respects periodicity. The Method of Manufactured Solutions (MMS) proceeds by selecting a smooth $C(x,y,t)$ that exercises the operators in the equation and then algebraically computing $Q(x,y,t)$ by substituting the manufactured solution into the left-hand side minus the diffusive terms to match the right-hand side. This ensures the continuous partial differential equation is satisfied exactly by construction, allowing discretization errors to be isolated and measured.\n\nWith $\\psi(x,y) = \\Psi_0\\,\\sin(k_x x)\\,\\sin(k_y y)$, the velocity field components are\n$$\nu(x,y) = \\frac{\\partial \\psi}{\\partial y} = \\Psi_0\\,k_y\\,\\sin(k_x x)\\,\\cos(k_y y),\n\\qquad\nv(x,y) = -\\frac{\\partial \\psi}{\\partial x} = -\\Psi_0\\,k_x\\,\\cos(k_x x)\\,\\sin(k_y y),\n$$\nwhich satisfy $u_x + v_y = 0$. The manufactured tracer is\n$$\nC(x,y,t) = \\exp(\\gamma t)\\,\\sin(k_x x)\\,\\cos(k_y y) + \\cos(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y),\n$$\nwith constants $\\gamma>0$, $\\omega>0$, and $k_x = \\frac{2\\pi}{L_x}$, $k_y = \\frac{2\\pi}{L_y}$. We compute the necessary derivatives.\n\nTime derivative:\n$$\n\\frac{\\partial C}{\\partial t} = \\gamma\\,\\exp(\\gamma t)\\,\\sin(k_x x)\\,\\cos(k_y y) - \\omega\\,\\sin(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y).\n$$\n\nSpatial first derivatives:\n$$\n\\frac{\\partial C}{\\partial x} = \\exp(\\gamma t)\\,k_x\\,\\cos(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,k_x\\,\\sin(k_x x)\\,\\sin(k_y y),\n$$\n$$\n\\frac{\\partial C}{\\partial y} = -\\exp(\\gamma t)\\,k_y\\,\\sin(k_x x)\\,\\sin(k_y y) + \\cos(\\omega t)\\,k_y\\,\\cos(k_x x)\\,\\cos(k_y y).\n$$\n\nSpatial second derivatives:\n$$\n\\frac{\\partial^2 C}{\\partial x^2} = -\\exp(\\gamma t)\\,k_x^{2}\\,\\sin(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,k_x^{2}\\,\\cos(k_x x)\\,\\sin(k_y y),\n$$\n$$\n\\frac{\\partial^2 C}{\\partial y^2} = -\\exp(\\gamma t)\\,k_y^{2}\\,\\sin(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,k_y^{2}\\,\\cos(k_x x)\\,\\sin(k_y y).\n$$\nThus, the Laplacian is\n$$\n\\frac{\\partial^2 C}{\\partial x^2} + \\frac{\\partial^2 C}{\\partial y^2} = -\\exp(\\gamma t)\\,(k_x^{2}+k_y^{2})\\,\\sin(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,(k_x^{2}+k_y^{2})\\,\\cos(k_x x)\\,\\sin(k_y y).\n$$\n\nThe advection contribution $u\\,C_x + v\\,C_y$ is\n\\begin{align*}\nu\\,\\frac{\\partial C}{\\partial x} &= \\Psi_0\\,k_y\\,\\cos(k_y y)\\,\\sin(k_x x)\\,\\left(\\exp(\\gamma t)\\,k_x\\,\\cos(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,k_x\\,\\sin(k_x x)\\,\\sin(k_y y)\\right) \\\\\n&= \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\\,\\cos^{2}(k_y y)\n- \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin^{2}(k_x x)\\,\\cos(k_y y)\\,\\sin(k_y y),\n\\end{align*}\nand\n\\begin{align*}\nv\\,\\frac{\\partial C}{\\partial y} &= -\\Psi_0\\,k_x\\,\\cos(k_x x)\\,\\sin(k_y y)\\,\\left(-\\exp(\\gamma t)\\,k_y\\,\\sin(k_x x)\\,\\sin(k_y y) + \\cos(\\omega t)\\,k_y\\,\\cos(k_x x)\\,\\cos(k_y y)\\right) \\\\\n&= \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\\,\\sin^{2}(k_y y)\n- \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\cos^{2}(k_x x)\\,\\sin(k_y y)\\,\\cos(k_y y).\n\\end{align*}\nSumming,\n\\begin{align*}\nu\\,\\frac{\\partial C}{\\partial x} + v\\,\\frac{\\partial C}{\\partial y}\n&= \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\\,\\left(\\cos^{2}(k_y y)+\\sin^{2}(k_y y)\\right) \\\\\n&\\quad - \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y)\\,\\left(\\sin^{2}(k_x x)+\\cos^{2}(k_x x)\\right) \\\\\n&= \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\n- \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y).\n\\end{align*}\n\nWe now assemble $Q(x,y,t)$ from the governing equation:\n$$\nQ(x,y,t) = \\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} + v\\,\\frac{\\partial C}{\\partial y} - \\kappa\\,\\left(\\frac{\\partial^{2} C}{\\partial x^{2}} + \\frac{\\partial^{2} C}{\\partial y^{2}}\\right).\n$$\nSubstituting the derived terms,\n\\begin{align*}\nQ(x,y,t)\n&= \\left[\\gamma\\,\\exp(\\gamma t)\\,\\sin(k_x x)\\,\\cos(k_y y) - \\omega\\,\\sin(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y)\\right] \\\\\n&\\quad + \\left[\\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\n- \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y)\\right] \\\\\n&\\quad - \\kappa\\,\\left[-\\exp(\\gamma t)\\,(k_x^{2}+k_y^{2})\\,\\sin(k_x x)\\,\\cos(k_y y) - \\cos(\\omega t)\\,(k_x^{2}+k_y^{2})\\,\\cos(k_x x)\\,\\sin(k_y y)\\right].\n\\end{align*}\nSimplifying signs,\n\\begin{align*}\nQ(x,y,t)\n&= \\exp(\\gamma t)\\,\\left(\\gamma + \\kappa\\,(k_x^{2}+k_y^{2})\\right)\\,\\sin(k_x x)\\,\\cos(k_y y) \\\\\n&\\quad + \\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x) \\\\\n&\\quad + \\cos(\\omega t)\\,\\kappa\\,(k_x^{2}+k_y^{2})\\,\\cos(k_x x)\\,\\sin(k_y y) \\\\\n&\\quad - \\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y) \\\\\n&\\quad - \\omega\\,\\sin(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y).\n\\end{align*}\nThis is the closed-form forcing that makes the chosen $C(x,y,t)$ an exact solution of the advection–diffusion equation with the given streamfunction velocity and diffusivity.\n\nRegarding truncation error, consistency, and order of accuracy, a method is consistent if the local truncation error tends to zero as $h \\to 0$ and $\\Delta t \\to 0$. Taylor-series analysis of smooth functions and operators shows that central differences in space and a second-order time integrator (such as a trapezoidal or Crank–Nicolson update) yield leading truncation errors that scale like $\\mathcal{O}(h^{2})$ and $\\mathcal{O}(\\Delta t^{2})$, respectively, provided the solution and coefficients are sufficiently smooth. For the MMS with the above $C(x,y,t)$, the exact source enforces smoothness, and one expects a properly implemented second-order spatial–temporal scheme to exhibit a global error norm $E(h,\\Delta t)$ that asymptotically behaves like $\\mathcal{O}(h^{2}) + \\mathcal{O}(\\Delta t^{2})$ under joint refinement, enabling clear verification of second-order convergence in both space and time when comparing the computed solution against the manufactured $C(x,y,t)$.",
            "answer": "$$\\boxed{\\exp(\\gamma t)\\,\\left(\\gamma + \\kappa\\,(k_x^{2}+k_y^{2})\\right)\\,\\sin(k_x x)\\,\\cos(k_y y)\\;+\\;\\exp(\\gamma t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_x x)\\,\\cos(k_x x)\\;+\\;\\cos(\\omega t)\\,\\kappa\\,(k_x^{2}+k_y^{2})\\,\\cos(k_x x)\\,\\sin(k_y y)\\;-\\;\\cos(\\omega t)\\,\\Psi_0\\,k_x\\,k_y\\,\\sin(k_y y)\\,\\cos(k_y y)\\;-\\;\\omega\\,\\sin(\\omega t)\\,\\cos(k_x x)\\,\\sin(k_y y)}$$"
        }
    ]
}