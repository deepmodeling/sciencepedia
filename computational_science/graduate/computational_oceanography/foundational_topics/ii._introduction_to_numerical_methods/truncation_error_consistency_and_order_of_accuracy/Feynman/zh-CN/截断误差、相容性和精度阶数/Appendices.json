{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的偏微分方程数值方法之前，我们必须掌握分析其时间积分部分的基本技能。本练习将通过一个经典的海洋混合层模型，引导你为二阶龙格-库塔法（Heun法）推导局部截断误差。这个过程的核心是泰勒级数展开，它是所有误差分析的基石，能帮助你理解数值格式与它所要逼近的微分方程之间的精确差异 。",
            "id": "3817323",
            "problem": "一个经典的一维海洋混合层模型通过标量常微分方程 $T^{\\prime}(t) = f(t, T(t))$ 来近似一个控制体积内垂直均匀示踪剂（例如温度）的演化，其中 $f$ 对其两个参数都足够光滑，并且源于具有指定源和汇的热量守恒。考虑使用 Heun's method（也称为显式梯形法则或显式二阶 Runge-Kutta 方法）将该模型从时间 $t_n$ 推进到 $t_{n+1} = t_n + h$，该方法定义如下：\n- $k_1 = f(t_n, T_n)$,\n- $k_2 = f(t_n + h, T_n + h k_1)$,\n- $T_{n+1}^{H} = T_n + \\frac{h}{2}\\left(k_1 + k_2\\right)$,\n其中 $T_n$ 是 $T(t_n)$ 的近似值。\n\n从精确值 $T(t_n)$（而非 $T_n$）出发，通过将所有项在点 $(t_n, T(t_n))$ 附近进行泰勒展开，并保留直至 $h^3$ 阶的所有贡献项，来推导单步局部截断误差 $\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}$。用时间导数 $T^{\\prime\\prime}(t_n)$、$T^{(3)}(t_n)$ 以及在 $t_n$ 处精确解上求值的偏导数 $f_T(t_n, T(t_n)) \\equiv \\partial f/\\partial T$ 来表示你的结果，形式为一个解析闭合表达式。利用这个误差，在适用于相容单步方法的平滑性和稳定性假设下，证明 Heun's method 对于此海洋混合层常微分方程具有二阶全局精度。\n\n你的最终答案必须是 $\\tau_{n+1}$ 的主阶项的单一解析闭合表达式，用 $h$, $T^{\\prime\\prime}(t_n)$, $T^{(3)}(t_n)$ 和 $f_T(t_n, T(t_n))$ 表示。不包括单位。不要四舍五入。",
            "solution": "问题陈述具有科学依据、提法恰当且客观。它提出了一个数值分析中的标准任务：为一个著名的 Runge-Kutta 方法（Heun's method）推导局部截断误差，并随后分析其精度阶数。所有定义和条件都是标准的且自洽的。因此，该问题是有效的，我们可以着手求解。\n\n目标是推导 Heun's method 的单步局部截断误差 $\\tau_{n+1}$。局部截断误差定义为在时间 $t_{n+1}$ 的精确解与从时间 $t_n$ 的精确解出发进行单步计算得到的数值近似解之间的差值。设 $T(t)$ 是常微分方程 $T^{\\prime}(t) = f(t, T(t))$ 的精确解。因此，局部截断误差由 $\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}$ 给出，其中数值步 $T_{n+1}^{H}$ 是从精确值 $T_n = T(t_n)$ 开始计算的。\n\n首先，我们使用泰勒级数将精确解 $T(t_{n+1})$ 在 $t_n$ 附近展开，其中 $t_{n+1} = t_n + h$。\n$$T(t_{n+1}) = T(t_n + h) = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) + O(h^4)$$\n$T(t)$ 的导数均在 $t_n$ 处求值。\n\n接下来，我们分析从精确解值 $T(t_n)$ 出发，通过 Heun's method 单步计算得到的数值解 $T_{n+1}^{H}$：\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2}(k_1 + k_2)$$\n系数 $k_1$ 和 $k_2$ 定义为：\n$$k_1 = f(t_n, T(t_n))$$\n$$k_2 = f(t_n + h, T(t_n) + h k_1)$$\n由于 $T(t)$ 是精确解，我们有 $T^{\\prime}(t) = f(t, T(t))$。因此，$k_1 = T^{\\prime}(t_n)$。\n\n为了找到一个可与 $T(t_{n+1})$ 的泰勒级数相比较的 $T_{n+1}^{H}$ 表达式，我们必须将 $k_2$ 作为一个二元函数在点 $(t_n, T(t_n))$ 附近展开为泰勒级数。令 $f_t = \\frac{\\partial f}{\\partial t}$, $f_T = \\frac{\\partial f}{\\partial T}$, $f_{tt} = \\frac{\\partial^2 f}{\\partial t^2}$, $f_{tT} = \\frac{\\partial^2 f}{\\partial t \\partial T}$ 以及 $f_{TT} = \\frac{\\partial^2 f}{\\partial T^2}$，所有偏导数均在 $(t_n, T(t_n))$ 处求值。展开式为：\n$$k_2 = f(t_n+h, T(t_n)+hk_1) = f(t_n, T(t_n)) + h f_t + (hk_1) f_T + \\frac{1}{2}\\left(h^2 f_{tt} + 2h(hk_1)f_{tT} + (hk_1)^2 f_{TT}\\right) + O(h^3)$$\n代入 $k_1 = T^{\\prime}(t_n)$ 和 $f(t_n, T(t_n)) = T^{\\prime}(t_n)$：\n$$k_2 = T^{\\prime}(t_n) + h \\left(f_t + T^{\\prime}(t_n) f_T\\right) + \\frac{h^2}{2}\\left(f_{tt} + 2T^{\\prime}(t_n) f_{tT} + (T^{\\prime}(t_n))^2 f_{TT}\\right) + O(h^3)$$\n\n现在，我们将 $f$ 的偏导数与 $T$ 的全时间导数联系起来。对 $T^{\\prime}(t) = f(t, T(t))$ 使用链式法则：\n$$T^{\\prime\\prime}(t) = \\frac{d}{dt}f(t, T(t)) = \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial T}\\frac{dT}{dt} = f_t + f_T T^{\\prime}(t)$$\n再次对 $t$求导：\n$$T^{(3)}(t) = \\frac{d}{dt}\\left(f_t + f_T T^{\\prime}(t)\\right) = \\left(\\frac{\\partial f_t}{\\partial t} + \\frac{\\partial f_t}{\\partial T}\\frac{dT}{dt}\\right) + \\left(\\frac{\\partial f_T}{\\partial t} + \\frac{\\partial f_T}{\\partial T}\\frac{dT}{dt}\\right)T^{\\prime}(t) + f_T T^{\\prime\\prime}(t)$$\n$$T^{(3)}(t) = (f_{tt} + f_{tT}T^{\\prime}) + (f_{Tt} + f_{TT}T^{\\prime})T^{\\prime} + f_T T^{\\prime\\prime}$$\n由于假设 $f$ 足够光滑，混合偏导数相等，$f_{tT} = f_{Tt}$。\n$$T^{(3)}(t_n) = f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} + f_T T^{\\prime\\prime}(t_n)$$\n由此，我们可以表达出 $k_2$ 展开式中 $O(h^2)$ 部分的项：\n$$f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} = T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)$$\n\n将这些全导数表达式代回到 $k_2$ 的展开式中：\n$$k_2 = T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}\\left(T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n)\\right) + O(h^3)$$\n\n现在我们将 $k_1$ 和 $k_2$ 的表达式代入 $T_{n+1}^{H}$ 的公式中：\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ T^{\\prime}(t_n) + \\left( T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ 2T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4}\\left( T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\n\n最后，我们计算局部截断误差 $\\tau_{n+1} = T(t_{n+1}) - T_{n+1}^{H}$：\n$$\\tau_{n+1} = \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) \\right) - \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4} T^{(3)}(t_n) - \\frac{h^3}{4} f_T T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\n$h^0$, $h^1$ 和 $h^2$ 阶的项相互抵消。我们收集 $h^3$ 阶的项：\n$$\\tau_{n+1} = \\left(\\frac{1}{6} - \\frac{1}{4}\\right) h^3 T^{(3)}(t_n) + \\frac{h^3}{4} f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\n$$\\tau_{n+1} = -\\frac{1}{12} h^3 T^{(3)}(t_n) + \\frac{3}{12} h^3 f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\n局部截断误差的主阶项为：\n$$\\tau_{n+1} = \\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right) + O(h^4)$$\n\n为证明其二阶全局精度，我们分析此结果。如果一个数值方法的局部截断误差 $\\tau_{n+1}$ 是 $h^{p+1}$ 阶的，则称该方法是 $p$ 阶的。在本例中，我们发现 $\\tau_{n+1} = O(h^3)$，这意味着该方法是 $p=2$ 阶的。\n该方法是相容的，因为 $\\lim_{h\\to 0} \\frac{\\tau_{n+1}}{h} = \\lim_{h\\to 0} O(h^2) = 0$。\n常微分方程数值分析基本定理（归功于Dahlquist）指出，对于一个相容的单步方法，稳定性是收敛的充分条件。此外，如果该方法是 $p$ 阶且稳定的（对于 Runge-Kutta 方法，如果 $f$ 是 Lipschitz continuous 的，这是平滑性假设的一个推论，则稳定性得到保证），那么在固定时间 $t_N = t_0 + Nh$ 的全局误差 $E_N = T(t_N) - T_N$ 是 $p$ 阶的。\n由于 Heun's method 是 $p=2$ 阶的，其全局误差为 $O(h^2)$。因此，该方法具有二阶全局精度。\n局部截断误差的主阶项是 $h^3$ 阶的表达式。",
            "answer": "$$\\boxed{\\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right)}$$"
        },
        {
            "introduction": "在求解偏微分方程时，我们通常将空间和时间离散化方法结合起来。本练习探讨了一个关键概念：最终的全局精度受限于格式中精度最低的那个部分。通过分析一个高阶空间格式与一个低阶时间格式的组合 ，你将发现为什么盲目提高某一方面的精度可能并不会带来预期的收益，这对于设计均衡且高效的数值模型至关重要。",
            "id": "3817314",
            "problem": "考虑周期域上的一维线性平流方程，\n$u_{t} + c\\,u_{x} = 0,$\n其中波速 $c \\neq 0$ 为常数，初始条件光滑。采用线方法进行离散化：在间距为 $h$ 的均匀网格上，空间导数 $u_x$ 由一个相容的中心四阶有限差分算子近似，从而得到一个半离散系统。该半离散系统的时间积分采用显式两阶段二阶龙格-库塔（RK2）方法进行。通过选择与网格间距成正比的时间步长 $\\Delta t$，将库朗-弗里德里希斯-列维（CFL）数 $\\lambda$ 保持为常数，具体为\n$\\Delta t = \\lambda\\,\\frac{h}{|c|},$\n其中 $\\lambda$ 满足所述格式的线性稳定性约束。假设精确解足够光滑，使得截断误差分析所需的所有导数在 $t \\in [0,T]$ 上存在且有界，并且数值格式在给定的CFL选择下是稳定的。\n\n仅使用截断误差、相容性、稳定性和精度阶数的基本定义，确定在给定的CFL缩放条件下，当 $h \\to 0$ 时，全离散数值解在固定的最终时间 $T > 0$ 所能达到的最高全局精度阶数（相对于 $h$）。请用一个整数表示您的最终答案。",
            "solution": "该问题要求确定求解一维线性平流方程 $u_t + c u_x = 0$ 的数值方法的全局精度阶数，其中 $c \\neq 0$ 是一个常数波速。\n\n求解策略包括三个主要步骤：\n$1$. 通过结合空间和时间离散化分量的误差，确定全离散格式的局部截断误差（LTE）。\n$2$. 将局部截断误差与固定最终时间 $T > 0$ 的全局误差联系起来。\n$3$. 应用给定的库朗-弗里德里希斯-列维（CFL）缩放关系 $\\Delta t \\propto h$，将全局误差表示为仅关于空间网格间距 $h$ 的函数，并确定当 $h \\to 0$ 时的主要项。\n\n首先，我们分析数值格式的各个组成部分。采用线方法，即先对偏微分方程（PDE）在空间上进行离散化，形成一个常微分方程组（ODEs），然后对该方程组进行时间积分。\n\n空间导数 $u_x$ 使用“相容的中心四阶有限差分算子”进行近似。如果一个格式的局部截断误差为 $O(h^p)$，则称其为 $p$ 阶格式。因此，空间离散化引入了 $h^4$ 阶的误差。对PDE的半离散近似可以写成 $\\frac{d\\mathbf{v}}{dt} = -c D_x\\mathbf{v}$，其中 $\\mathbf{v}$ 是网格上数值解的向量，而 $D_x$ 是表示四阶差分算子的矩阵。这种空间近似带来的局部截断误差贡献 $\\tau_{space}$ 为 $O(h^4)$。\n\n得到的常微分方程组使用“显式两阶段二阶龙格-库塔（RK$2$）方法”进行积分。如果一个时间积分方法的局部截断误差为 $O(\\Delta t^q)$，则称其为 $q$ 阶方法。对于二阶RK$2$方法， $q=2$。因此，时间积分带来的局部截断误差贡献 $\\tau_{time}$ 为 $O(\\Delta t^2)$。\n\n对于线方法，全离散格式的总局部截断误差 $\\tau$ 是空间和时间分量局部截断误差的总和。\n$\\tau = \\tau_{time} + \\tau_{space} = O(\\Delta t^2) + O(h^4)$\n如果一个格式的LTE在 $\\Delta t \\to 0$ 和 $h \\to 0$ 时趋于零，则该格式是相容的，本例即是如此。\n\n接下来，我们将局部误差与全局误差联系起来。问题陈述保证了该格式是稳定的。Lax等价定理指出，对于一个相容的线性格式，稳定性是收敛的充要条件。该定理的一个关键推论是，全局误差的阶数与局部截断误差的阶数相同。因此，在固定的最终时间 $T$ 的全局误差 $E_g(T)$ 为：\n$E_g(T) = O(\\Delta t^2) + O(h^4)$\n\n最后一步是引入时间步长 $\\Delta t$ 和网格间距 $h$ 之间的指定缩放关系。通过以下关系式保持一个恒定的CFL数 $\\lambda$：\n$\\Delta t = \\lambda \\frac{h}{|c|}$\n由于 $\\lambda$ 和 $c$ 是固定的非零常数，$\\Delta t$ 与 $h$ 成正比。我们可以将其表示为 $\\Delta t = K h$，其中常数 $K = \\lambda/|c|$。\n\n将此关系代入全局误差表达式，使我们能够仅就 $h$ 来分析收敛性：\n$E_g(T) = O((K h)^2) + O(h^4)$\n由于 $K$ 是一个常数，这可以简化为：\n$E_g(T) = O(h^2) + O(h^4)$\n\n为了找到总体的精度阶数，我们必须确定当 $h \\to 0$ 时的主导误差项。误差是一个与 $h^2$ 成正比的项和一个与 $h^4$ 成正比的项之和。对于较小的 $h$ 值， $h$ 的幂次较低的项将更大，因此将主导总误差。由于 $2  4$， $O(h^2)$ 项主导 $O(h^4)$ 项。\n$$\n\\lim_{h\\to 0} \\frac{O(h^4)}{O(h^2)} = 0\n$$\n因此，全局误差的渐近行为由 $O(h^2)$ 项决定：\n$E_g(T) = O(h^2) \\quad \\text{as } h \\to 0$\n\n一个数值格式的全局精度阶数是全局误差主导项中 $h$ 的指数。在这种情况下，指数是 $2$。尽管使用了四阶空间格式，但由于 $\\Delta t$ 和 $h$ 之间的线性缩放关系，总体精度受到了二阶时间格式的限制。所指定格式能达到的最高全局精度阶数是 $2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "理论分析的正确性最终需要通过数值实验来验证，这是计算科学中的一个核心实践。本练习提供了一个从理论到代码的完整工作流程：首先，你将为著名的Lax-Wendroff格式推导其局部截断误差；接着，你将通过编写代码计算“观测精度阶”，从而验证理论分析的结果 。这个实践旨在巩固你对截断误差、精度阶和代码验证之间联系的理解。",
            "id": "3817399",
            "problem": "考虑一个周期性海洋通道中被动标量浓度场的一维平流。其控制方程是线性平流方程 $c_t + U c_x = 0$，其中 $c(x,t)$ 是标量浓度，$U$ 是恒定的平流速度，下标表示对时间 $t$ 和空间 $x$ 的偏导数。角度必须以弧度处理。假设一个长度为 $L$ 的无量纲域，具有周期性边界条件，并使用一种所有量均为无量纲的无量纲化公式。\n\n一个精确的行波解是 $c(x,t) = \\sin(k x - \\omega t)$，其中 $\\omega = U k$，$k$ 是空间波数，$\\omega$ 是角频率。这个解在 $x$ 和 $t$ 上都是严格周期的，并且在给定的关系 $\\omega = U k$ 下满足平流方程。\n\n我们考虑在均匀网格上对平流方程进行如下的显式、两步时空离散化，网格间距为 $\\Delta x$，时间步长为 $\\Delta t$，该方法被称为 Lax–Wendroff (LW) 格式（此处为常数 $U$ 和正数 $U$ 定义）：\n$$\nc_i^{n+1} = c_i^n - \\frac{\\lambda}{2} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{\\lambda^2}{2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right),\n$$\n其中 $c_i^n$ 表示在网格点 $x_i$ 和时间 $t^n$ 的数值近似解，$\\lambda = \\frac{U \\Delta t}{\\Delta x}$ 是 Courant–Friedrichs–Lewy (CFL) 数。为了实施周期性边界条件，索引 $i+1$ 和 $i-1$ 对网格点总数取模。\n\n任务1（推导）：从线性平流方程 $c_t + U c_x = 0$ 和上述 LW 离散化出发，推导 LW 格式的局部截断误差 $\\tau(x,t;\\Delta x,\\Delta t)$。推导过程为：将精确解 $c(x,t)$ 代入 LW 更新方程，对 $(x,t)$ 点进行时间和空间上的泰勒展开，并利用控制方程消去时间导数，用空间导数表示。您的推导必须将 $\\tau$ 表示为关于 $\\Delta x$ 和 $\\Delta t$ 的主阶渐近级数，从而证明该格式的相容性并确定其精度阶。\n\n任务2（从离散残差计算观测阶）：当使用精确解时，将网格点 $x_i$ 和时间层 $t^n$ 的离散残差定义为\n$$\nR_i^n = c(x_i,t^{n+1}) - \\left[ c(x_i,t^n) - \\frac{\\lambda}{2}\\left(c(x_{i+1},t^n) - c(x_{i-1},t^n)\\right) + \\frac{\\lambda^2}{2}\\left(c(x_{i+1},t^n) - 2c(x_i,t^n) + c(x_{i-1},t^n)\\right) \\right].\n$$\n那么，在 $(x_i,t^n)$ 处的局部截断误差为 $\\tau_i^n = \\frac{R_i^n}{\\Delta t}$。使用离散 $\\ell^2$ 范数\n$$\n\\|\\tau\\|_2 = \\left( \\Delta x \\sum_{i} (\\tau_i^n)^2 \\right)^{1/2}\n$$\n来衡量在固定时间 $t^n$ 下，整个空间网格上局部截断误差的大小。对于每个测试用例，在一系列加密的网格上计算 $\\|\\tau\\|_2$，并使用两个最细的网格间距 $\\Delta x_{\\text{fine}}$ 和 $\\Delta x_{\\text{finer}}$ 估计观测阶 $p$：\n$$\np \\approx \\frac{\\log\\left(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}}\\right)}{\\log\\left(\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}}\\right)}.\n$$\n\n实现要求：\n- 使用精确解 $c(x,t) = \\sin(k x - \\omega t)$，其中 $\\omega = U k$。\n- 使用均匀网格，$x_i = i \\Delta x$，$i = 0,1,\\dots,N_x-1$，并采用周期性边界条件。在计算 $R_i^n$ 和 $\\tau_i^n$ 时，设置 $t^n = 0$，并定义 $t^{n+1} = t^n + \\Delta t$。\n- 对于每个网格，通过测试用例中提供的固定 CFL 数 $\\lambda = \\frac{U \\Delta t}{\\Delta x}$ 来设置 $\\Delta t$，以平衡截断误差中空间和时间的贡献。\n- 角度以弧度为单位。所有量均为无量纲。\n\n测试套件：\n对于每个测试用例，参数为 $(U,k,L,\\lambda,\\{N_x\\})$，其中 $L$ 是域长度，$\\lambda$ 是 CFL 数，$\\{N_x\\}$ 是用于估计阶数的网格分辨率集合。使用以下三个测试用例：\n1. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 2\\pi, 1, 0.4, \\{50, 100, 200\\})$。\n2. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 10\\pi, 1, 0.4, \\{100, 200, 400\\})$。\n3. $(U,k,L,\\lambda,\\{N_x\\}) = (1, 4\\pi, 1, 0.9, \\{60, 120, 240\\})$。\n\n答案规格：\n- 您的程序必须使用 $\\{N_x\\}$ 中两个最细的网格为每个测试用例计算观测阶 $p$，并将每个 $p$ 四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含三个结果，格式为方括号内以逗号分隔的列表，例如 $[p_1,p_2,p_3]$。",
            "solution": "该问题被评估为有效。这是一个在计算科学领域内适定且具有科学依据的问题，具体涉及偏微分方程的数值分析。所有参数、方程和程序都已明确定义，从而可以得到唯一且可验证的解。我们将着手执行所概述的两个任务。\n\n### 任务1：局部截断误差的推导\n\n第一个任务是推导应用于线性平流方程 $c_t + U c_x = 0$ 的 Lax-Wendroff (LW) 格式的局部截断误差 $\\tau$。局部截断误差通过将精确解 $c(x,t)$ 代入有限差分格式并量化其残差来求得。\n\nLW 格式如下：\n$$\nc_i^{n+1} = c_i^n - \\frac{\\lambda}{2} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{\\lambda^2}{2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\n其中 $\\lambda = \\frac{U \\Delta t}{\\Delta x}$。为了找到截断误差，我们重新排列该格式，以表示其所近似的微分算子 $L = \\partial_t + U \\partial_x$。\n\n首先，我们除以 $\\Delta t$：\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = - \\frac{U \\Delta t}{2 \\Delta x \\Delta t} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{U^2 (\\Delta t)^2}{2 (\\Delta x)^2 \\Delta t} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = - \\frac{U}{2 \\Delta x} \\left(c_{i+1}^n - c_{i-1}^n\\right) + \\frac{U^2 \\Delta t}{2 (\\Delta x)^2} \\left(c_{i+1}^n - 2 c_i^n + c_{i-1}^n\\right)\n$$\n截断误差 $\\tau(x,t)$ 定义为将精确解 $c(x,t)$ 代入数值算子后产生的残差。我们在点 $(x,t)$ 处（对应于 $(x_i, t^n)$）计算所有项。\n$$\n\\tau(x,t) = \\frac{c(x, t+\\Delta t) - c(x, t)}{\\Delta t} + U \\frac{c(x+\\Delta x, t) - c(x-\\Delta x, t)}{2 \\Delta x} - \\frac{U^2 \\Delta t}{2} \\frac{c(x+\\Delta x, t) - 2c(x, t) + c(x-\\Delta x, t)}{(\\Delta x)^2}\n$$\n现在我们对每一项围绕点 $(x,t)$ 进行泰勒级数展开。为清晰起见，我们使用下标表示法表示偏导数（例如，$c_t = \\frac{\\partial c}{\\partial t}$，$c_{xx} = \\frac{\\partial^2 c}{\\partial x^2}$）。\n\n第1项（时间上的向前差分）：\n$$\n\\frac{c(x, t+\\Delta t) - c(x, t)}{\\Delta t} = \\frac{1}{\\Delta t} \\left[ \\left(c + \\Delta t c_t + \\frac{(\\Delta t)^2}{2} c_{tt} + \\frac{(\\Delta t)^3}{6} c_{ttt} + \\dots \\right) - c \\right] = c_t + \\frac{\\Delta t}{2} c_{tt} + \\frac{(\\Delta t)^2}{6} c_{ttt} + O((\\Delta t)^3)\n$$\n第2项（$c_x$ 的空间中心差分）：\n$$\nU \\frac{c(x+\\Delta x, t) - c(x-\\Delta x, t)}{2 \\Delta x} = \\frac{U}{2 \\Delta x} \\left[ \\left(c + \\Delta x c_x + \\frac{(\\Delta x)^2}{2} c_{xx} + \\frac{(\\Delta x)^3}{6} c_{xxx} + \\dots \\right) - \\left(c - \\Delta x c_x + \\frac{(\\Delta x)^2}{2} c_{xx} - \\frac{(\\Delta x)^3}{6} c_{xxx} + \\dots \\right) \\right]\n$$\n$$\n= \\frac{U}{2 \\Delta x} \\left[ 2 \\Delta x c_x + \\frac{(\\Delta x)^3}{3} c_{xxx} + O((\\Delta x)^5) \\right] = U c_x + \\frac{U (\\Delta x)^2}{6} c_{xxx} + O((\\Delta x)^4)\n$$\n第3项（$c_{xx}$ 的空间中心差分）：\n$$\n- \\frac{U^2 \\Delta t}{2} \\frac{c(x+\\Delta x, t) - 2c(x, t) + c(x-\\Delta x, t)}{(\\Delta x)^2} = - \\frac{U^2 \\Delta t}{2} \\left[ c_{xx} + \\frac{(\\Delta x)^2}{12} c_{xxxx} + O((\\Delta x)^4) \\right] = - \\frac{U^2 \\Delta t}{2} c_{xx} - \\frac{U^2 \\Delta t (\\Delta x)^2}{24} c_{xxxx} + O(\\Delta t(\\Delta x)^4)\n$$\n将这些展开式合并到 $\\tau(x,t)$ 的表达式中：\n$$\n\\tau(x,t) = \\left( c_t + \\frac{\\Delta t}{2} c_{tt} + \\frac{(\\Delta t)^2}{6} c_{ttt} \\right) + \\left( U c_x + \\frac{U (\\Delta x)^2}{6} c_{xxx} \\right) - \\left( \\frac{U^2 \\Delta t}{2} c_{xx} \\right) + \\text{H.O.T.}\n$$\n我们按导数对各项进行分组：\n$$\n\\tau(x,t) = (c_t + U c_x) + \\frac{\\Delta t}{2} (c_{tt} - U^2 c_{xx}) + \\frac{(\\Delta t)^2}{6} c_{ttt} + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\n精确解满足控制方程 $c_t + U c_x = 0$。这意味着该格式是*相容的*，因为 $\\tau$ 的主项不是零阶的。此外，我们可以使用控制方程将高阶时间导数用空间导数表示：\n$c_{t} = -U c_{x}$\n$c_{tt} = \\partial_t(-U c_x) = -U c_{xt} = -U \\partial_x(c_t) = -U \\partial_x(-U c_x) = U^2 c_{xx}$\n$c_{ttt} = \\partial_t(U^2 c_{xx}) = U^2 c_{xxt} = U^2 \\partial_{xx}(-U c_x) = -U^3 c_{xxx}$\n\n将这些代回 $\\tau(x,t)$ 的表达式中：\n1. 项 $(c_t + U c_x)$ 为 $0$。\n2. 项 $\\frac{\\Delta t}{2} (c_{tt} - U^2 c_{xx}) = \\frac{\\Delta t}{2} (U^2 c_{xx} - U^2 c_{xx})$ 也为 $0$。这种抵消是 Lax-Wendroff 构造方法的标志，它提升了格式的精度。\n\n剩余的主阶项为：\n$$\n\\tau(x,t) = \\frac{(\\Delta t)^2}{6} c_{ttt} + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\n代入 $c_{ttt} = -U^3 c_{xxx}$：\n$$\n\\tau(x,t) = \\frac{(\\Delta t)^2}{6} (-U^3 c_{xxx}) + \\frac{U (\\Delta x)^2}{6} c_{xxx} + \\text{H.O.T.}\n$$\n$$\n\\tau(x,t) = \\frac{U c_{xxx}}{6} \\left( (\\Delta x)^2 - U^2 (\\Delta t)^2 \\right) + \\text{H.O.T.}\n$$\n使用 CFL 数的定义 $\\lambda = \\frac{U \\Delta t}{\\Delta x}$，我们可以写出 $\\Delta t = \\frac{\\lambda \\Delta x}{U}$。表达式变为：\n$$\n\\tau(x,t) = \\frac{U c_{xxx}}{6} \\left( (\\Delta x)^2 - U^2 \\frac{\\lambda^2 (\\Delta x)^2}{U^2} \\right) + \\text{H.O.T.} = \\frac{U (\\Delta x)^2}{6} (1 - \\lambda^2) c_{xxx} + \\text{H.O.T.}\n$$\n主误差项也包含 $(\\Delta t)^2$，因此我们可以写成 $\\tau(x,t) = O((\\Delta x)^2, (\\Delta t)^2)$。由于数值实验固定了 $\\lambda$，$\\Delta t$ 与 $\\Delta x$ 成正比。因此，总的精度阶是二阶，我们期望观测阶 $p$ 为 $2$。\n\n### 任务2：精度观测阶\n\n第二个任务是数值验证精度阶。这包括在一系列网格上计算截断误差，并使用结果来估计收敛阶 $p$。方法如下：\n1.  对于每个测试用例 $(U, k, L, \\lambda, \\{N_x\\})$，我们遍历所提供的网格分辨率 $N_x$。\n2.  对于给定的 $N_x$，我们定义网格参数：网格间距 $\\Delta x = L / N_x$ 和时间步长 $\\Delta t = \\lambda \\Delta x / U$。\n3.  我们定义空间网格 $x_i = i \\Delta x$，$i = 0, 1, \\dots, N_x-1$。\n4.  我们在时间 $t^n=0$ 和 $t^{n+1}=\\Delta t$ 处计算精确解：\n    $c(x_i, t^n) = \\sin(k x_i)$\n    $c(x_i, t^{n+1}) = \\sin(k x_i - \\omega \\Delta t)$，其中 $\\omega = U k$。\n5.  我们通过将 LW 算子应用于 $t^n$ 时的精确解来计算 $t^{n+1}$ 时的数值解，记为 $c_i^{n+1, \\text{num}}$：\n    $c_i^{n+1, \\text{num}} = c(x_i,t^n) - \\frac{\\lambda}{2}(c(x_{i+1},t^n) - c(x_{i-1},t^n)) + \\frac{\\lambda^2}{2}(c(x_{i+1},t^n) - 2c(x_i,t^n) + c(x_{i-1},t^n))$\n6.  离散残差计算为 $R_i^n = c(x_i,t^{n+1}) - c_i^{n+1, \\text{num}}$。\n7.  每个网格点上的局部截断误差为 $\\tau_i^n = R_i^n / \\Delta t$。\n8.  误差场的大小使用离散 $\\ell^2$ 范数来衡量：$\\|\\tau\\|_2 = \\sqrt{\\Delta x \\sum_{i=0}^{N_x-1} (\\tau_i^n)^2}$。\n9.  在为两个最细的网格（对应的网格间距为 $\\Delta x_{\\text{fine}}$ 和 $\\Delta x_{\\text{finer}}$）计算出 $\\|\\tau\\|_2$ 后，使用以下公式计算观测阶 $p$：\n    $$\n    p \\approx \\frac{\\log\\left(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}}\\right)}{\\log\\left(\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}}\\right)}\n    $$\n由于每个测试用例中的分辨率被选择为使得 $\\Delta x_{\\text{fine}} / \\Delta x_{\\text{finer}} = 2$，因此这可以简化为 $p \\approx \\log_2(\\|\\tau\\|_{2,\\text{fine}} / \\|\\tau\\|_{2,\\text{finer}})$。根据理论推导，期望结果为 $p \\approx 2$。",
            "answer": "[2.000305,2.000311,2.000109]"
        }
    ]
}