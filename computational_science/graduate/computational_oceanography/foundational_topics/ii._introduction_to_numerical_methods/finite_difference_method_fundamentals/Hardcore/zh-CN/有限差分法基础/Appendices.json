{
    "hands_on_practices": [
        {
            "introduction": "有限差分法的基石在于用离散的网格点值来近似导数。本练习将带你实践一项核心技能：使用泰勒级数展开和待定系数法来构建高阶差分格式。通过为海岸线边界这样一个单边场景推导一个高阶精度的差分算子，你将深入理解如何根据模板宽度最大化格式的代数精度，这是在计算模型中处理复杂边界条件的关键技术 。",
            "id": "3792784",
            "problem": "一个海洋模型在靠近笔直海岸线（位置为 $x_{0}$）的均匀一维横截面上解析沿岸动量。模型网格间距为 $\\Delta x > 0$，且仅在 $x \\geq x_{0}$ 处存在海洋点。设 $f(x)$ 是一个充分光滑的标量场，表示限制在海洋点上的沿岸速度分量。为了计算海岸线处的空间梯度，该模型使用一个单边有限差分近似来计算 $x_{0}$ 处的一阶导数，该近似是基于五个海洋网格点 $x_{0}+m\\,\\Delta x$（其中 $m \\in \\{0,1,2,3,4\\}$）构建的：\n$$\nf'(x_{0}) \\approx \\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m}\\,f\\!\\left(x_{0}+m\\,\\Delta x\\right),\n$$\n其中系数 $c_{m}$ 待定。\n\n从 $f(x)$ 在 $x_{0}$ 点的泰勒级数展开和截断误差阶数的定义出发，确定系数 $c_{0},c_{1},c_{2},c_{3},c_{4}$，以在给定的模板宽度约束下最大化代数精度阶数。然后报告得到的整数阶数 $p$，使得截断误差为 $\\mathcal{O}(\\Delta x^{p})$。\n\n将系数和阶数表示为精确的有理数形式。将您的最终答案以单行矩阵的形式给出，按顺序包含 $c_{0},c_{1},c_{2},c_{3},c_{4}$ 和 $p$。无需四舍五入，最终答案中不应包含任何物理单位。",
            "solution": "该问题要求确定五个系数 $c_{0}, c_{1}, c_{2}, c_{3}, c_{4}$，用于一阶导数 $f'(x_{0})$ 的单边有限差分近似，以最大化精度阶数。给定的近似为：\n$$\nf'(x_{0}) \\approx \\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m}\\,f(x_{0}+m\\,\\Delta x)\n$$\n基于泰勒级数展开的待定系数法是完成此项任务的标准程序。我们将每个函数求值 $f(x_{0}+m\\,\\Delta x)$ 在点 $x_{0}$ 附近展开为泰勒级数。由于假定 $f(x)$ 是充分光滑的，因此这些展开是有效的。每个项的展开式为：\n$$\nf(x_{0}+m\\,\\Delta x) = f(x_{0}) + (m\\,\\Delta x)f'(x_{0}) + \\frac{(m\\,\\Delta x)^{2}}{2!}f''(x_{0}) + \\frac{(m\\,\\Delta x)^{3}}{3!}f'''(x_{0}) + \\dots = \\sum_{k=0}^{\\infty} \\frac{(m\\,\\Delta x)^{k}}{k!} f^{(k)}(x_{0})\n$$\n其中 $f^{(k)}(x_{0})$ 表示 $f$ 在 $x_{0}$ 处求得的 $k$ 阶导数。\n\n将这些展开式代入有限差分公式，我们得到：\n$$\n\\frac{1}{\\Delta x}\\sum_{m=0}^{4} c_{m} \\left( \\sum_{k=0}^{\\infty} \\frac{(m\\,\\Delta x)^{k}}{k!} f^{(k)}(x_{0}) \\right)\n$$\n我们可以交换求和顺序，并通过将具有相同 $f$ 导数的项组合在一起来重新排列表达式：\n$$\n\\sum_{k=0}^{\\infty} \\frac{(\\Delta x)^{k-1}}{k!} f^{(k)}(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{k} \\right)\n$$\n让我们写出这个展开式的前几项：\n$$\n\\frac{1}{\\Delta x} f(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{0} \\right) + f'(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{1} \\right) + \\frac{\\Delta x}{2} f''(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{2} \\right) + \\frac{(\\Delta x)^{2}}{6} f'''(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{3} \\right) + \\dots\n$$\n要使该表达式成为 $f'(x_{0})$ 的近似，$f'(x_{0})$ 的系数必须为 1，其他项的系数应为零，直到可能的最高阶。有了五个未知系数（$c_{0}$ 到 $c_{4}$），我们可以满足五个线性约束。为了最大化精度阶数，我们将误差中最低阶项的系数设为零。\n这就得到了以下线性方程组：\n\\begin{enumerate}\n    \\item $f(x_{0})$ 的系数必须为零：$\\frac{1}{\\Delta x} \\left(\\sum_{m=0}^{4} c_{m}m^{0}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m} = 0$。\n    \\item $f'(x_{0})$ 的系数必须为一：$\\sum_{m=0}^{4} c_{m}m^{1} = 1$。\n    \\item $f''(x_{0})$ 的系数必须为零：$\\frac{\\Delta x}{2} \\left(\\sum_{m=0}^{4} c_{m}m^{2}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{2} = 0$。\n    \\item $f'''(x_{0})$ 的系数必须为零：$\\frac{(\\Delta x)^{2}}{6} \\left(\\sum_{m=0}^{4} c_{m}m^{3}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{3} = 0$。\n    \\item $f^{(4)}(x_{0})$ 的系数必须为零：$\\frac{(\\Delta x)^{3}}{24} \\left(\\sum_{m=0}^{4} c_{m}m^{4}\\right) = 0 \\implies \\sum_{m=0}^{4} c_{m}m^{4} = 0$。\n\\end{enumerate}\n对 $m \\in \\{0, 1, 2, 3, 4\\}$ 明确写出这些方程：\n$$\n\\begin{array}{rcrcrcrcrcr}\nc_{0} + c_{1} + c_{2} + c_{3} + c_{4} = 0 \\\\\n0 c_{0} + 1 c_{1} + 2 c_{2} + 3 c_{3} + 4 c_{4} = 1 \\\\\n0 c_{0} + 1 c_{1} + 4 c_{2} + 9 c_{3} + 16 c_{4} = 0 \\\\\n0 c_{0} + 1 c_{1} + 8 c_{2} + 27 c_{3} + 64 c_{4} = 0 \\\\\n0 c_{0} + 1 c_{1} + 16 c_{2} + 81 c_{3} + 256 c_{4} = 0 \\\\\n\\end{array}\n$$\n这是一个关于五个未知系数的五元线性方程组。在后四个方程中，涉及 $c_{0}$ 的项均为零。从第一个方程，我们得到 $c_{0} = -(c_{1} + c_{2} + c_{3} + c_{4})$。剩下的四个方程构成了一个关于 $c_{1}, c_{2}, c_{3}, c_{4}$ 的 $4 \\times 4$ 方程组。解此方程组可得：\n$$\nc_{1} = 4\n$$\n$$\nc_{2} = -3\n$$\n$$\nc_{3} = \\frac{4}{3}\n$$\n$$\nc_{4} = -\\frac{1}{4}\n$$\n现在我们求解 $c_{0}$：\n$$\nc_{0} = -\\left(4 - 3 + \\frac{4}{3} - \\frac{1}{4}\\right) = -\\left(1 + \\frac{16-3}{12}\\right) = -\\left(1 + \\frac{13}{12}\\right) = -\\frac{25}{12}\n$$\n所以这些系数是：\n$c_{0} = -\\frac{25}{12}$，$c_{1} = 4$，$c_{2} = -3$，$c_{3} = \\frac{4}{3}$，$c_{4} = -\\frac{1}{4}$。\n\n下一步是确定代数精度阶数 $p$。截断误差由泰勒级数展开中的第一个非零项给出。这对应于 $k=5$ 的项：\n$$\n\\text{截断误差} = \\frac{(\\Delta x)^{5-1}}{5!} f^{(5)}(x_{0}) \\left( \\sum_{m=0}^{4} c_{m}m^{5} \\right) + \\mathcal{O}((\\Delta x)^5)\n$$\n$$\n\\text{截断误差} = \\frac{(\\Delta x)^{4}}{120} f^{(5)}(x_{0}) \\left( 0^{5}c_{0} + 1^{5}c_{1} + 2^{5}c_{2} + 3^{5}c_{3} + 4^{5}c_{4} \\right) + \\mathcal{O}((\\Delta x)^5)\n$$\n我们必须计算这个和以确保它不为零：\n$$\n\\sum_{m=0}^{4} c_{m}m^{5} = c_{1} + 32c_{2} + 243c_{3} + 1024c_{4} = 4 + 32(-3) + 243\\left(\\frac{4}{3}\\right) + 1024\\left(-\\frac{1}{4}\\right)\n$$\n$$\n= 4 - 96 + 81 \\times 4 - 256 = 4 - 96 + 324 - 256 = 328 - 352 = -24\n$$\n由于这个和不为零，截断误差的主项是：\n$$\n\\text{截断误差} = \\frac{(\\Delta x)^{4}}{120} (-24) f^{(5)}(x_{0}) + \\mathcal{O}((\\Delta x)^5) = -\\frac{1}{5}(\\Delta x)^{4} f^{(5)}(x_{0}) + \\mathcal{O}((\\Delta x)^5)\n$$\n误差与 $(\\Delta x)^{4}$ 成正比。因此，精度阶数为 $p=4$。\n\n最终结果是系数 $c_{0}, c_{1}, c_{2}, c_{3}, c_{4}$ 和阶数 $p$，均为精确的有理数形式。\n$c_{0} = -\\frac{25}{12}$，$c_{1} = 4$，$c_{2} = -3$，$c_{3} = \\frac{4}{3}$，$c_{4} = -\\frac{1}{4}$，$p=4$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{25}{12} & 4 & -3 & \\frac{4}{3} & -\\frac{1}{4} & 4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "了解一个差分格式的精度阶数固然重要，但量化其截断误差的大小在实践中更为关键。此练习旨在对比两种同为二阶精度的二阶导数近似格式：一个用于模型内部点的标准中心差分格式，另一个是用于边界的单边差分格式。通过直接计算它们的领先截断误差项，你将发现即使精度阶数相同，不同格式的误差常数也可能存在巨大差异，这揭示了数值模型中一个常见的问题——边界处理是局部误差的重要来源 。",
            "id": "3792839",
            "problem": "一个用于海洋热扩散的一维垂直柱模型使用了作用于温度 $T(z)$ 的二阶导数算子，其中 $z$ 是向下增加的垂直坐标。离散化在间距为 $h$ 的均匀网格上进行，网格点为 $z_j = z_0 + j h$，其中 $j$ 为整数。在该柱的不同部分使用了对二阶导数 $T''(z)$ 的两种二阶近似：\n(1) 在内部点 $z_i$ 处，使用对称三点格式，其一般形式写作 $D_{\\text{cen}}^{(2)} T(z_i) = \\dfrac{\\alpha\\, T(z_{i-1}) + \\beta\\, T(z_i) + \\gamma\\, T(z_{i+1})}{h^2}$，其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是为确保二阶相容性而选择的常数。\n(2) 在表面边界 $z_0$ 处，使用前向单边四点格式，其一般形式写作 $D_{\\text{one}}^{(2)} T(z_0) = \\dfrac{a\\, T(z_0) + b\\, T(z_1) + c\\, T(z_2) + d\\, T(z_3)}{h^2}$，其中 $a$、$b$、$c$ 和 $d$ 是为确保仅使用点 $z_0, z_1, z_2, z_3$ 的二阶相容性而选择的常数。\n\n从 $T(z)$ 在求值点附近的泰勒级数和截断误差的定义出发，确定系数 $\\alpha$、$\\beta$、$\\gamma$ 和 $a$、$b$、$c$、$d$，以使每种格式都达到二阶相容性。然后，显式计算每种近似的主截断项，即确定展开式\n$$\nD^{(2)} T = T'' + C\\, h^2\\, T^{(4)} + \\mathcal{O}(h^4)\n$$\n中的常数 $C$。最后，计算单边边界格式和对称内部格式的主截断常数的幅值之比，\n$$\n\\rho = \\frac{|C_{\\text{one-sided}}|}{|C_{\\text{central}}|}.\n$$\n将你对 $\\rho$ 的最终答案表示为一个精确的有理数，不带单位。",
            "solution": "该问题要求确定两种近似二阶导数的有限差分格式的系数，计算它们的主截断误差项，以及误差常数幅值之比。分析过程通过使用泰勒级数展开来进行。\n\n设 $T(z)$ 是一个足够光滑的函数。我们使用记号 $T_j = T(z_j)$ 和 $T^{(k)}(z)$ 表示 $T$ 对 $z$ 的 $k$ 阶导数。所有展开都将围绕一个特定的网格点进行，并且没有明确在其他点求值的导数都假定是在展开点求值。\n\n第一部分：对称三点中心格式\n\n在内部点 $z_i$ 处，$T''(z_i)$ 的中心差分近似由下式给出：\n$$\nD_{\\text{cen}}^{(2)} T(z_i) = \\frac{\\alpha T(z_{i-1}) + \\beta T(z_i) + \\gamma T(z_{i+1})}{h^2}\n$$\n我们将 $T(z_{i-1}) = T(z_i - h)$ 和 $T(z_{i+1}) = T(z_i + h)$ 在 $z_i$ 附近展开为泰勒级数。设 $T^{(k)}$ 表示 $T^{(k)}(z_i)$。\n$$\nT(z_{i-1}) = T_i - h T' + \\frac{h^2}{2} T'' - \\frac{h^3}{6} T''' + \\frac{h^4}{24} T^{(4)} + \\mathcal{O}(h^5)\n$$\n$$\nT(z_{i+1}) = T_i + h T' + \\frac{h^2}{2} T'' + \\frac{h^3}{6} T''' + \\frac{h^4}{24} T^{(4)} + \\mathcal{O}(h^5)\n$$\n将这些展开式代入格式表达式的分子，得到：\n$$\n\\alpha T_{i-1} + \\beta T_i + \\gamma T_{i+1} = \\alpha\\left(T_i - hT' + \\frac{h^2}{2}T'' - \\dots\\right) + \\beta T_i + \\gamma\\left(T_i + hT' + \\frac{h^2}{2}T'' + \\dots\\right)\n$$\n按 $T$ 在 $z_i$ 处的导数阶数对各项进行分组：\n$$\n(\\alpha + \\beta + \\gamma)T_i + h(-\\alpha + \\gamma)T' + h^2\\left(\\frac{\\alpha}{2} + \\frac{\\gamma}{2}\\right)T'' + h^3\\left(-\\frac{\\alpha}{6} + \\frac{\\gamma}{6}\\right)T''' + h^4\\left(\\frac{\\alpha}{24} + \\frac{\\gamma}{24}\\right)T^{(4)} + \\mathcal{O}(h^5)\n$$\n为了使该表达式成为 $h^2 T''$ 的一个近似，我们将低阶项的系数设为零，并将 $h^2 T''$ 的系数设为1。\n\\begin{enumerate}\n    \\item $T_i$ 的系数：$\\alpha + \\beta + \\gamma = 0$\n    \\item $hT'$ 的系数：$-\\alpha + \\gamma = 0 \\implies \\alpha = \\gamma$\n    \\item $h^2T''$ 的系数：$\\frac{\\alpha}{2} + \\frac{\\gamma}{2} = 1 \\implies \\alpha + \\gamma = 2$\n\\end{enumerate}\n解此方程组，由 $\\alpha = \\gamma$ 和 $\\alpha + \\gamma = 2$ 可得 $2\\alpha = 2$，即 $\\alpha = 1$ 和 $\\gamma = 1$。代入第一个方程 $1 + \\beta + 1 = 0$，我们得到 $\\beta = -2$。\n系数为 $\\alpha=1$, $\\beta=-2$, $\\gamma=1$。\n\n该格式为 $D_{\\text{cen}}^{(2)} T(z_i) = \\frac{T(z_{i-1}) - 2T(z_i) + T(z_{i+1})}{h^2}$。\n为了找到主截断项，我们检查泰勒展开中接下来的非零项。\n$T'''$ 项的系数是 $h^3(-\\frac{\\alpha}{6} + \\frac{\\gamma}{6}) = h^3(-\\frac{1}{6} + \\frac{1}{6}) = 0$。\n$T^{(4)}$ 项的系数是 $h^4(\\frac{\\alpha}{24} + \\frac{\\gamma}{24}) = h^4(\\frac{1}{24} + \\frac{1}{24}) = \\frac{2h^4}{24} = \\frac{h^4}{12}$。\n所以，分子的展开式为 $h^2 T'' + \\frac{h^4}{12} T^{(4)} + \\mathcal{O}(h^6)$。\n除以 $h^2$，我们得到算子的展开式：\n$$\nD_{\\text{cen}}^{(2)} T(z_i) = T''(z_i) + \\frac{h^2}{12} T^{(4)}(z_i) + \\mathcal{O}(h^4)\n$$\n将此与形式 $D^{(2)}T = T'' + C h^2 T^{(4)} + \\mathcal{O}(h^4)$ 进行比较，我们确定中心差分的截断常数为 $C_{\\text{central}} = \\frac{1}{12}$。\n\n第二部分：单边四点前向格式\n\n在边界 $z_0$ 处，$T''(z_0)$ 的单边格式为：\n$$\nD_{\\text{one}}^{(2)} T(z_0) = \\frac{a T(z_0) + b T(z_1) + c T(z_2) + d T(z_3)}{h^2}\n$$\n其中 $z_j = z_0 + jh$。我们将 $T(z_1)$、$T(z_2)$ 和 $T(z_3)$ 在 $z_0$ 附近展开为泰勒级数。设 $T^{(k)}$ 表示 $T^{(k)}(z_0)$。\n$$\nT(z_j) = T(z_0 + jh) = \\sum_{k=0}^{\\infty} \\frac{(jh)^k}{k!} T^{(k)}\n$$\n将这些代入分子：\n$$\na T_0 + b T_1 + c T_2 + d T_3 = a T_0 + b \\sum_{k=0}^{\\infty} \\frac{h^k}{k!} T^{(k)} + c \\sum_{k=0}^{\\infty} \\frac{(2h)^k}{k!} T^{(k)} + d \\sum_{k=0}^{\\infty} \\frac{(3h)^k}{k!} T^{(k)}\n$$\n按导数阶数 $T^{(k)}$ 分组：\n$$\n\\sum_{k=0}^{\\infty} \\frac{h^k T^{(k)}}{k!} \\left( a \\cdot \\delta_{k0} + b \\cdot 1^k + c \\cdot 2^k + d \\cdot 3^k \\right) \\quad (\\text{使用 } 0^0=1, 0^k=0 \\text{ for } k>0)\n$$\n我们需要这个和来近似 $h^2 T''$。为达到二阶精度，误差必须是 $\\mathcal{O}(h^2)$，这意味着算子 $D_{\\text{one}}^{(2)}$ 的截断误差是 $h^2$ 阶的。这意味着分子 $aT_0 + bT_1 + cT_2 + dT_3$ 的展开式应以 $h^2 T''$ 开始，并且与 $h^3$ 成比例的项必须为零。\n\\begin{enumerate}\n    \\item $T_0$ 的系数 ($k=0$): $a + b + c + d = 0$\n    \\item $hT'$ 的系数 ($k=1$): $b + 2c + 3d = 0$\n    \\item $\\frac{h^2}{2}T''$ 的系数 ($k=2$): $b + 4c + 9d = 2$ (因此该项为 $h^2 T''$)\n    \\item $\\frac{h^3}{6}T'''$ 的系数 ($k=3$): $b + 8c + 27d = 0$\n\\end{enumerate}\n我们解这个四元线性方程组。由(2)得，$b = -2c - 3d$。\n将 $b$ 代入(3)：$(-2c - 3d) + 4c + 9d = 2 \\implies 2c + 6d = 2 \\implies c + 3d = 1$。\n将 $b$ 代入(4)：$(-2c - 3d) + 8c + 27d = 0 \\implies 6c + 24d = 0 \\implies c + 4d = 0$。\n从这两个新方程，我们得到 $c = 1 - 3d$ 和 $c = -4d$。\n令它们相等：$1 - 3d = -4d \\implies d = -1$。\n然后 $c = -4(-1) = 4$。\n然后 $b = -2(4) - 3(-1) = -8 + 3 = -5$。\n最后，$a = -b - c - d = -(-5) - 4 - (-1) = 5 - 4 + 1 = 2$。\n系数为 $a=2, b=-5, c=4, d=-1$。\n\n现在，我们求主截断项。展开式中的下一项是 $k=4$ 的项：\n$$\n\\text{$T^{(4)}$ 的项} = \\frac{h^4 T^{(4)}}{4!} (b \\cdot 1^4 + c \\cdot 2^4 + d \\cdot 3^4) = \\frac{h^4 T^{(4)}}{24} (b + 16c + 81d)\n$$\n代入系数：\n$$\n\\frac{h^4 T^{(4)}}{24} (-5 + 16(4) + 81(-1)) = \\frac{h^4 T^{(4)}}{24} (-5 + 64 - 81) = \\frac{h^4 T^{(4)}}{24} (-22) = -\\frac{11 h^4}{12} T^{(4)}\n$$\n分子的展开式为 $h^2 T'' - \\frac{11 h^4}{12} T^{(4)} + \\mathcal{O}(h^5)$。\n除以 $h^2$：\n$$\nD_{\\text{one}}^{(2)} T(z_0) = T''(z_0) - \\frac{11 h^2}{12} T^{(4)}(z_0) + \\mathcal{O}(h^3)\n$$\n问题指定截断误差形式为 $C h^2 T^{(4)} + \\mathcal{O}(h^4)$。截断误差的主项确实与 $h^2$ 成正比。任何与 $h^3$ 成正比的项都是相对于主导 $h^2$ 项的高阶项。因此，我们确定单边截断常数为 $C_{\\text{one-sided}} = -\\frac{11}{12}$。\n\n第三部分：截断常数之比\n\n问题要求计算比率 $\\rho = \\frac{|C_{\\text{one-sided}}|}{|C_{\\text{central}}|}$。\n我们有 $C_{\\text{central}} = \\frac{1}{12}$ 和 $C_{\\text{one-sided}} = -\\frac{11}{12}$。\n取其幅值：\n$$\n|C_{\\text{central}}| = \\left|\\frac{1}{12}\\right| = \\frac{1}{12}\n$$\n$$\n|C_{\\text{one-sided}}| = \\left|-\\frac{11}{12}\\right| = \\frac{11}{12}\n$$\n该比率为：\n$$\n\\rho = \\frac{\\frac{11}{12}}{\\frac{1}{12}} = 11\n$$\n该比率是一个无量纲有理数，符合要求。这一结果表明，对于给定的网格间距 $h$，二阶单边格式的主截断误差在幅值上比标准二阶中心格式的主截断误差大11倍。",
            "answer": "$$\\boxed{11}$$"
        },
        {
            "introduction": "海洋和大气动力学本质上是高度非线性的，如何离散化非线性项对数值模拟的长期稳定性和物理真实性至关重要。一个看似直观的离散化方法，如对平流项 $u u_x$ 的简单处理，可能在离散层面上破坏能量守恒等基本物理定律。本练习将引导你分析一个“朴素”格式为何不能保证离散能量守恒，并构建一种能够精确维持能量守恒的斜对称格式，这项技能对于开发稳健的海洋模型至关重要 。",
            "id": "3792775",
            "problem": "考虑一个标量速度场 $u(x,t)$ 沿着长度为 $L$ 的理想化周期性海道的一维无粘性平流，其由连续方程 $u_t + u\\,u_x = 0$ 描述。设一个具有 $N$ 个点和间距 $h = L/N$ 的均匀网格来近似该海道，其周期性索引为 $j \\in \\{0,1,\\dots,N-1\\}$，且在 $x_j = j h$ 处有 $u_j(t) \\approx u(x_j,t)$。定义中心有限差分算子 $D_0$ 为 $D_0 u_j = \\frac{u_{j+1} - u_{j-1}}{2 h}$，离散能量定义为\n$$\nE(t) = \\frac{h}{2} \\sum_{j=0}^{N-1} u_j(t)^2.\n$$\n假设采用周期性边界条件，因此索引运算以 $N$ 为模。考虑半离散常微分方程 $u_t + \\mathcal{N}(u) = 0$，其中 $\\mathcal{N}(u)$ 是 $u\\,u_x$ 的一个空间有限差分近似。\n\n从第一性原理出发，包括中心差分算子的性质和离散内积的性质，完成以下任务：\n\n1. 使用朴素乘积形式离散化 $\\mathcal{N}_{\\text{naive}}(u)_j = u_j \\, D_0 u_j$，推导离散能量趋势 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ 关于一个离散和的解析表达式，并明确论证在周期性边界条件下，对于任意 $u_j$，为什么它通常不为零。\n\n2. 提出一个类型为\n$$\n\\mathcal{N}_{\\text{skew}}(u)_j = \\alpha\\, u_j\\, D_0 u_j + \\beta\\, D_0\\!\\big(u_j^2\\big),\n$$\n的 $\\mathcal{N}(u)$ 的斜对称分裂形式离散化，其中常数 $\\alpha$ 和 $\\beta$ 的选择要使近似与 $u\\,u_x$ 相容，并且在周期性边界条件下离散能量趋势为零。从第一性原理推导 $\\alpha$ 和 $\\beta$ 需满足的条件，并构造出 $\\alpha$ 和 $\\beta$ 的具体值。\n\n3. 使用你所选择的斜对称 $\\alpha$ 和 $\\beta$ 值，计算在周期性边界条件下离散能量趋势 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ 的精确闭式解值。\n\n你的最终答案必须是代表斜对称离散化下 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ 值的单个实数。无需四舍五入，也无需物理单位。",
            "solution": "该问题要求分析两种用于一维无粘性平流方程 $u_t + u u_x = 0$ 的有限差分格式的离散能量守恒性质。我们将从第一性原理出发，依次解决问题的三个部分。\n\n离散能量定义为\n$$\nE(t) = \\frac{h}{2} \\sum_{j=0}^{N-1} u_j(t)^2.\n$$\n其时间变化率，即能量趋势，可以通过对时间 $t$ 求导得到。应用链式法则，我们有\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( \\frac{h}{2} \\sum_{j=0}^{N-1} u_j^2 \\right) = \\frac{h}{2} \\sum_{j=0}^{N-1} 2 u_j \\frac{\\mathrm{d}u_j}{\\mathrm{d}t} = h \\sum_{j=0}^{N-1} u_j \\frac{\\mathrm{d}u_j}{\\mathrm{d}t}.\n$$\n半离散常微分方程由 $\\frac{\\mathrm{d}u_j}{\\mathrm{d}t} = - \\mathcal{N}(u)_j$ 给出。将其代入能量趋势的表达式，得到\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j \\mathcal{N}(u)_j.\n$$\n该表达式构成了我们分析的基础。\n\n第一部分：朴素离散化 $\\mathcal{N}_{\\text{naive}}(u)_j = u_j D_0 u_j$ 的分析。\n\n对于此格式，能量趋势为\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j (u_j D_0 u_j) = -h \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\n代入中心差分算子的定义 $D_0 u_j = \\frac{u_{j+1} - u_{j-1}}{2h}$，我们得到\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j^2 \\left( \\frac{u_{j+1} - u_{j-1}}{2h} \\right) = -\\frac{1}{2} \\sum_{j=0}^{N-1} u_j^2 (u_{j+1} - u_{j-1}).\n$$\n这是离散能量趋势的解析表达式。为了证明它通常不为零，我们可以对该求和进行操作。让我们将求和分成两部分：\n$$\n\\sum_{j=0}^{N-1} u_j^2 (u_{j+1} - u_{j-1}) = \\sum_{j=0}^{N-1} u_j^2 u_{j+1} - \\sum_{j=0}^{N-1} u_j^2 u_{j-1}.\n$$\n我们对第二个求和进行变址。令 $k = j-1$，则 $j = k+1$。由于索引是模 $N$ 的周期性索引，对 $j \\in \\{0, \\dots, N-1\\}$ 的求和等价于对 $k \\in \\{0, \\dots, N-1\\}$ 的求和。将哑索引 $k$ 替换为 $j$，第二个和变为 $\\sum_{j=0}^{N-1} u_{j+1}^2 u_j$。\n因此，总和为\n$$\n\\sum_{j=0}^{N-1} u_j^2 u_{j+1} - \\sum_{j=0}^{N-1} u_{j+1}^2 u_j = \\sum_{j=0}^{N-1} (u_j^2 u_{j+1} - u_j u_{j+1}^2) = \\sum_{j=0}^{N-1} u_j u_{j+1} (u_j - u_{j+1}).\n$$\n因此，能量趋势为\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{1}{2} \\sum_{j=0}^{N-1} u_j u_{j+1} (u_j - u_{j+1}).\n$$\n对于任意场 $u_j$，此和并非恒等于零。例如，考虑一个 $N=3$ 且 $u = (u_0, u_1, u_2) = (1, 2, 3)$ 的简单情况。该和变为\n$u_0 u_1 (u_0 - u_1) + u_1 u_2 (u_1 - u_2) + u_2 u_0 (u_2 - u_0) = (1)(2)(1-2) + (2)(3)(2-3) + (3)(1)(3-1) = -2 - 6 + 6 = -2$。\n在这种情况下，$\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{1}{2}(-2) = 1 \\neq 0$。因此，朴素离散化通常不保持离散能量守恒。\n\n第二部分：斜对称离散化的推导。\n\n我们得到形式为 $\\mathcal{N}_{\\text{skew}}(u)_j = \\alpha\\, u_j\\, D_0 u_j + \\beta\\, D_0\\!\\big(u_j^2\\big)$。我们必须找到常数 $\\alpha$ 和 $\\beta$ 来满足两个条件：相容性和能量守恒。\n\n条件1：相容性。离散算子必须是连续项 $u u_x$ 的一个相容近似。我们使用围绕 $x_j$ 的泰勒展开来分析 $\\mathcal{N}_{\\text{skew}}$ 中的每一项。\n第一项得到：$u_j D_0 u_j = u(x_j) \\frac{u(x_j+h)-u(x_j-h)}{2h} = u(x_j) [u_x(x_j) + O(h^2)] = u u_x + O(h^2)$。\n第二项得到：$D_0(u_j^2) = \\frac{u(x_j+h)^2 - u(x_j-h)^2}{2h}$。这是函数 $f(u) = u^2$ 的中心差分，它近似于 $\\frac{d}{dx}(u^2)$。因此，$D_0(u_j^2) = \\frac{d}{dx}(u^2) + O(h^2) = 2 u u_x + O(h^2)$。\n将这些结合起来，该离散化近似于：\n$$\n\\mathcal{N}_{\\text{skew}}(u)_j \\approx \\alpha (u u_x) + \\beta (2 u u_x) = (\\alpha + 2\\beta) u u_x.\n$$\n为了与 $u u_x$ 相容，我们必须有 $\\alpha + 2\\beta = 1$。\n\n条件2：能量守恒。该格式必须保持离散能量守恒，这意味着 $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = 0$。这要求和 $\\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j$ 为零。\n$$\n\\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j = \\sum_{j=0}^{N-1} u_j \\left[ \\alpha u_j D_0 u_j + \\beta D_0(u_j^2) \\right] = \\alpha \\sum_{j=0}^{N-1} u_j^2 D_0 u_j + \\beta \\sum_{j=0}^{N-1} u_j D_0(u_j^2).\n$$\n为了计算这个式子，我们使用周期性边界条件下中心差分算子的分部求和性质。对于任意两个周期性网格函数 $f_j$ 和 $g_j$，我们有：\n$$\n\\sum_{j=0}^{N-1} f_j D_0 g_j = \\sum_{j=0}^{N-1} f_j \\left( \\frac{g_{j+1} - g_{j-1}}{2h} \\right) = \\frac{1}{2h} \\left( \\sum_{j=0}^{N-1} f_j g_{j+1} - \\sum_{j=0}^{N-1} f_j g_{j-1} \\right).\n$$\n对求和重新变址（例如，在第一个和中使用 $k=j+1$，在第二个和中使用 $k=j-1$ 并利用周期性）可得：\n$$\n\\frac{1}{2h} \\left( \\sum_{k=0}^{N-1} f_{k-1} g_k - \\sum_{k=0}^{N-1} f_{k+1} g_k \\right) = \\sum_{k=0}^{N-1} g_k \\left( \\frac{f_{k-1} - f_{k+1}}{2h} \\right) = -\\sum_{k=0}^{N-1} g_k D_0 f_k.\n$$\n这表明 $D_0$ 对于标准离散内积是斜伴随的。\n将此性质应用于我们求和的第二项，其中 $f_j = u_j$ 且 $g_j = u_j^2$：\n$$\n\\sum_{j=0}^{N-1} u_j D_0(u_j^2) = - \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\n将此代回求和的表达式中：\n$$\n\\alpha \\sum_{j=0}^{N-1} u_j^2 D_0 u_j - \\beta \\sum_{j=0}^{N-1} u_j^2 D_0 u_j = (\\alpha - \\beta) \\sum_{j=0}^{N-1} u_j^2 D_0 u_j.\n$$\n如第一部分所示，对于任意 $u_j$，和 $\\sum_j u_j^2 D_0 u_j$ 并非恒等于零。因此，为了使总表达式对任何 $u_j$ 都为零，其系数必须为零。这给出了我们的第二个条件：$\\alpha - \\beta = 0$，或 $\\alpha = \\beta$。\n\n求解 $\\alpha$ 和 $\\beta$：我们得到一个由两个线性方程组成的方程组：\n1) $\\alpha + 2\\beta = 1$\n2) $\\alpha = \\beta$\n将(2)代入(1)得到 $\\beta + 2\\beta = 1$，即 $3\\beta = 1$，所以 $\\beta = \\frac{1}{3}$。从(2)可知，$\\alpha = \\frac{1}{3}$。\n具体值为 $\\alpha = 1/3$ 和 $\\beta = 1/3$。\n\n第三部分：斜对称格式的能量趋势计算。\n\n使用推导出的值 $\\alpha = 1/3$ 和 $\\beta = 1/3$，能量趋势由下式给出：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -h \\sum_{j=0}^{N-1} u_j \\mathcal{N}_{\\text{skew}}(u)_j = -h \\sum_{j=0}^{N-1} u_j \\left[ \\frac{1}{3} u_j D_0 u_j + \\frac{1}{3} D_0(u_j^2) \\right].\n$$\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ \\sum_{j=0}^{N-1} u_j^2 D_0 u_j + \\sum_{j=0}^{N-1} u_j D_0(u_j^2) \\right].\n$$\n如在第二部分中根据 $D_0$ 的斜伴随性质所确立的，我们有 $\\sum_{j} u_j D_0(u_j^2) = - \\sum_{j} u_j^2 D_0(u_j)$。将此代入能量趋势的表达式中：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ \\sum_{j=0}^{N-1} u_j^2 D_0 u_j - \\sum_{j=0}^{N-1} u_j^2 D_0 u_j \\right].\n$$\n方括号内的两个和正好相互抵消：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{h}{3} \\left[ 0 \\right] = 0.\n$$\n根据构造，斜对称离散化的离散能量趋势的精确闭式解值恰好为零。这表明该格式保持离散能量 $E(t)$ 守恒。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}