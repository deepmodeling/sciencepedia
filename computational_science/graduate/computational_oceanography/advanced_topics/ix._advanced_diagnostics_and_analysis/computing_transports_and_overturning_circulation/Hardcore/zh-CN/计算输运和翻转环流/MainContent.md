## 引言
[海洋环流](@entry_id:195237)是地球气候系统的关键调节器，它通过在全球范围内输运热量、淡水和碳，深刻地影响着天气模式、海平面变化和[全球生物地球化学循环](@entry_id:149408)。然而，从对海洋流动的定性理解转向精确的定量分析，需要一个严谨的计算框架。如何准确地计算海洋中的[物质输运](@entry_id:1132066)量，特别是大规模的经向翻转环流（MOC），是现代计算海洋学面临的核心挑战之一，也是理解海洋模型输出和观测数据的关键。

本文旨在系统性地阐述计算海洋输运和翻转环流的理论、方法与应用。我们将解决从基本定义到高级诊断框架中的一系列复杂问题，为读者提供一套完整的知识体系。

为实现这一目标，本文分为三个核心章节。在“原则与机制”中，我们将建立起计算输运的数学和物理基础，探讨不同坐标系下流函数的定义，并分析涡旋和[赤道动力学](@entry_id:1124596)等复杂过程。接下来，在“应用与跨学科联系”中，我们将展示这些计算工具如何应用于解决真实世界的科学问题，从量化主要洋流到评估其在全球[气候动力学](@entry_id:192646)、[古气候重建](@entry_id:1129301)和[地球系统模型](@entry_id:1124096)中的作用。最后，“动手实践”部分将提供具体的计算练习，让您有机会亲自应用所学知识，将理论转化为实践技能。通过这一结构化的学习路径，您将能够掌握计算和解读[海洋环流](@entry_id:195237)的核心能力。

## 原则与机制

本章深入探讨计算海洋输运和[翻转环流](@entry_id:1129255)的核心原则与机制。我们将从输运的基本定义出发，逐步建立起描述大规模[海洋环流](@entry_id:195237)的数学框架，特别是[经向翻转环流](@entry_id:1127799)（Meridional Overturning Circulation, MOC）。随后，我们将探讨在不同坐标系下诊断环流的方法，分析与真实海洋动力学过程（如涡旋和[赤道动力学](@entry_id:1124596)）相关的复杂性，并讨论数值计算中的关键考虑因素。

### 输运的基本定义

在量化海洋中物质和属性的运动时，“输运”（transport）是一个核心概念。它指的是单位时间内流经一个给定[截面](@entry_id:154995)的体积、质量或某种示踪剂的总量。精确计算输运是理解[海洋环流](@entry_id:195237)及其气候影响的第一步。

#### 体积输运与质量输运

最基本的输运量是**体积输运**（volume transport），定义为速度场 $\mathbf{u}$ 穿过一个[截面](@entry_id:154995) $A$ 的通量。其数学表达式为一个[面积分](@entry_id:275394)：

$T_V = \iint_A \mathbf{u} \cdot d\mathbf{A} = \iint_A (\mathbf{u} \cdot \mathbf{n}) \, dA$

其中 $d\mathbf{A} = \mathbf{n} \, dA$，$\mathbf{n}$ 是[截面](@entry_id:154995)的[单位法向量](@entry_id:178851)。体积输运的单位是 $\mathrm{m^3 \, s^{-1}}$，在[海洋学](@entry_id:149256)中常使用斯维尔德鲁普（Sverdrup, Sv）作为单位，其中 $1 \, \mathrm{Sv} = 10^6 \, \mathrm{m^3 \, s^{-1}}$。

然而，由于海水密度 $\rho$ 并非恒定，仅考虑体积输运有时会忽略动力学上的重要效应。**质量输运**（mass transport）则量化了流经[截面](@entry_id:154995)的总质量，其定义为质量通量 $\rho\mathbf{u}$ 的[面积分](@entry_id:275394)：

$T_M = \iint_A \rho (\mathbf{u} \cdot \mathbf{n}) \, dA$

在密度 $\rho$ 随空间变化的真实海洋中，体积输运和[质量输运](@entry_id:151908)之间存在重要差异。我们可以通过一个有效平均密度 $\overline{\rho}$ 将两者联系起来，即 $T_M = \overline{\rho} T_V$。从定义出发，这个有效密度必然是：

$\overline{\rho} = \frac{T_M}{T_V} = \frac{\iint_A \rho (\mathbf{u} \cdot \mathbf{n}) \, dA}{\iint_A (\mathbf{u} \cdot \mathbf{n}) \, dA}$

这个结果表明，正确的[转换因子](@entry_id:142644)不是简单的[截面](@entry_id:154995)面积平均密度，而是**速度加权平均密度**（velocity-weighted average density）。这是因为流速较高的区域对总输运的贡献更大，因此这些区域的密度也应被赋予更高的权重。忽略速度和密度场之间的空间相关性，例如使用简单的面积平均密度进行换算，会导致对质量输运的估计出现系统性偏差 。

#### [截面](@entry_id:154995)法向输运与分量输运

在实际计算中，一个常见的挑战是如何处理非标准方向的[截面](@entry_id:154995)。输运的物理定义是流体穿过一个表面的通量，这本质上取决于速度矢量在**[截面](@entry_id:154995)法向**（section-normal）上的投影。因此，对于一个任意方向的[截面](@entry_id:154995)，正确的输运计算必须使用 $\mathbf{u} \cdot \mathbf{n}$ 作为被积函数。

一个常见的简化是直接积分某个速度分量，例如使用经向速度 $v$ 来计算跨纬度圈的输运。这种做法仅在特定条件下有效。考虑一个速度场在地理坐标系中分解为东向分量 $u$ 和北向分量 $v$。如果要计算通过一个[截面](@entry_id:154995)的北向体积输运，积分 $v$ 分量 (即 $\mathbf{u} \cdot \hat{\mathbf{\phi}}$，其中 $\hat{\mathbf{\phi}}$ 是指向北方的单位矢量) 得到的结果只有当[截面](@entry_id:154995)的法向量 $\mathbf{n}$ 处处指向北方（或南方）时，才等于真实的法向输运。这种情况仅对**纬圈[截面](@entry_id:154995)**（zonal section）成立 。

对于任意弯曲的路径，例如沿着海底等深[线或](@entry_id:170208)跨越海峡的斜向测线，其[法向量](@entry_id:264185) $\mathbf{n}$ 会随位置变化，通常既不指向东也不指向北。在这种情况下，必须计算每个点的法向量，并将速度矢量 $\mathbf{u}$ 投影到该方向上，然后进行积分，才能获得物理上正确的跨[截面](@entry_id:154995)输运。在[曲线坐标](@entry_id:178535)网格的数值模型中，直接使用模型的“经向”速度分量来计算非网格对齐的输运同样会导致错误。

#### 符号约定

为了确保计算结果的可比性和物理意义的清晰性，海洋学界遵循一套广泛采用的**符号约定**（sign conventions）。

*   **速度分量**：通常定义 $u > 0$ 为东向流，$v > 0$ 为北向流，$w > 0$ 为垂向向上流。这是一个[右手坐标系](@entry_id:166669)（东-北-上）。

*   **[正压流函数](@entry_id:1121352)**（Barotropic Streamfunction）：对于水平无辐散的深度积分流 $(U,V) = (\int u \, dz, \int v \, dz)$，可以定义[正压流函数](@entry_id:1121352) $\psi$。标准约定是 $\mathbf{u}_h = \hat{\mathbf{k}} \times \nabla \psi$，其中 $\mathbf{u}_h$ 是水平[速度矢量](@entry_id:269648)，$\hat{\mathbf{k}}$ 是向上的单位矢量。这导出 $u = -\partial\psi/\partial y$ 和 $v = \partial\psi/\partial x$。在此约定下，$\psi$ 的高值区（“小山”）对应于北半球的反[气旋](@entry_id:262310)式环流（顺时针），这与观测到的副热带环流（gyre）的高海面高度相符。

*   **[经向翻转流函数](@entry_id:1127800)**（Meridional Overturning Streamfunction）：[经向翻转流函数](@entry_id:1127800) $\Psi$ 的符号约定通常被选择为使其在大西洋中具有正值。大西洋经向翻转环流（AMOC）的典型特征是上层海水向北流动，深层海水向南返回。在纬度-深度平面上，这构成一个顺时针的环流胞。因此，标准约定将这种**顺时针翻转**定义为正的 $\Psi$ 值 。

统一这些约定至关重要，它保证了不同研究、不同模型和观测数据之间的结果可以直接比较，并使得[流函数](@entry_id:1132499)的正负号直接与特定的[环流模式](@entry_id:1122410)（如反[气旋](@entry_id:262310)式环流或顺时针翻转）相关联。

### 几何坐标系中的[经向翻转环流](@entry_id:1127799)

经向翻转环流（MOC）描述了海洋在经向-垂向平面内的质量交换，是全球热量和碳输运的关键组成部分。为了量化它，我们需要一种方法将三维的速度场投影到二维的经向-垂向平面上。

#### 流场分解：翻转与环流

海洋的经向速度场 $v(x,y,z)$ 可以被分解为一个纬向平均[部分和](@entry_id:162077)一个偏离该平均的部分。**纬向平均**（zonal average）定义为：

$\langle v \rangle_x(y,z) = \frac{1}{L_x(y)} \int_{x_w(y)}^{x_e(y)} v(x,y,z) \, dx$

其中 $x_w$ 和 $x_e$ 分别是海盆的西部和东部边界，$L_x(y)$ 是海盆在纬度 $y$ 的宽度。**纬向偏差**（zonal deviation）则为 $v'(x,y,z) = v(x,y,z) - \langle v \rangle_x(y,z)$。

根据定义，纬向偏差的纬向积分恒等于零：

$\int_{x_w(y)}^{x_e(y)} v'(x,y,z) \, dx = 0$

这个简单的数学分解具有深刻的物理意义。$\langle v \rangle_x$ 是一个只与纬度 $y$ 和深度 $z$ 有关的量，它代表了在整个海盆宽度上平均的净经向流动，这直接对应于**翻转分量**（overturning component）。而 $v'$ 则描述了在同一深度上，一个经度区域的向北流动如何被另一个区域的向南流动所补偿。这与水平的再循环，即**环流分量**（gyre component）相关。因此，这种分解将总的经向输运在数学上唯一地划分开来：翻转分量负责在纬向积分意义上的净物质南北输运，而环流分量在每个深度上纬向积分为零，它通过闭合的水平回路重新分配质量，但不改变该深度的总经向输运 。

#### MOC流函数 $\Psi(\phi, z)$

为了可视化和量化[翻转环流](@entry_id:1129255)，我们引入**[经向翻转流函数](@entry_id:1127800)** $\Psi(\phi, z)$。其推导基于[不可压缩流体](@entry_id:181066)的质量守恒定律（连续性方程） $\nabla \cdot \mathbf{u} = 0$。对该方程进行纬向积分，并利用海盆侧边界（$x_w, x_e$）上没有法向流动的边界条件，可以得到一个在经向-垂向 $(y,z)$ 平面上的二维[连续性方程](@entry_id:195013)：

$\frac{\partial}{\partial y} \left( \int v \, dx \right) + \frac{\partial}{\partial z} \left( \int w \, dx \right) = 0$

这个二维无辐散流场 $(\int v \, dx, \int w \, dx)$ 保证了可以定义一个[流函数](@entry_id:1132499) $\Psi$。标准定义为：

$\Psi(\phi, z) = \int_{z}^{0} \left( \int_{x_w(\phi)}^{x_e(\phi)} v(\phi, x, z') \, dx \right) \, dz'$

这里我们使用了地理学中的纬度 $\phi$ 代替了笛卡尔坐标 $y$，并采用了海洋学中 $z$ 轴向上为正、海面 $z=0$ 的约定。此定义设定了海面处的流函数为零，$\Psi(\phi, 0) = 0$。

从物理上看，$\Psi(\phi, z)$ 的值代表了在纬度 $\phi$ 处、深度 $z$ 以上的所有海水向北的总净体积输运 。

$\Psi$ 的等值线描绘了翻转环流的流动路径。$\Psi$ 在垂向上的[极值](@entry_id:145933)点表示翻转环流胞的强度。这些极值出现在纬向积分经向速度为零的深度，即 $\int v \, dx = 0$ 的地方。根据前述的符号约定，一个正的[局部极大值](@entry_id:137813) $\Psi_{max}$ 对应一个[上层](@entry_id:198114)向北、下层向南的顺时针环流胞，其强度为 $\Psi_{max}$。反之，一个负的[局部极小值](@entry_id:143537)则代表一个逆时针的环流胞。

### 密度坐标系中的 MOC：连接环流与水团

尽管在几何坐标（深度 $z$）中定义的 $\Psi(\phi, z)$ 是一个强大的工具，但它混合了两种截然不同的物理过程：**[绝热过程](@entry_id:138150)**（adiabatic processes，即沿着密度相等的表面流动）和**非[绝热过程](@entry_id:138150)**（diabatic processes，即跨越密度面的流动，如混合和受热/冷却）。为了更清晰地诊断驱动水团转化的过程，[海洋学](@entry_id:149256)家发展了在密度空间中分析翻转环流的方法。

#### 密度空间流函数 $\Psi_b(\phi, b)$

我们的目标是定义一个流函数，它能追踪特定密度范围内的水体输运。这里我们使用**[浮力](@entry_id:154088)**（buoyancy）$b = -g(\rho - \rho_0)/\rho_0$ 作为密度坐标，其中 $g$ 是重力加速度，$\rho_0$ 是参考密度。[浮力](@entry_id:154088)值越高，水体越轻。

**密度空间翻转[流函数](@entry_id:1132499)**（density-space overturning streamfunction）$\Psi_b(\phi, b)$ 被定义为在纬度 $\phi$ 处，所有比给定[浮力](@entry_id:154088)值 $b$ 更轻的水体（即[浮力](@entry_id:154088) $b' > b$）的向北净体积输运。其数学形式可以借助亥维赛德[阶跃函数](@entry_id:159192) $H(\cdot)$ 来简洁地表达 ：

$\Psi_b(\phi, b) = \iint v(\phi, x, z) \cdot H(b'(\phi, x, z) - b) \, dz \, dx$

这个定义通过将输运按密度类别进行[分箱](@entry_id:264748)，直接量化了不同**水团**（water masses）的经向输运。$\Psi_b$ 的一个关键优势在于，在绝热假设下，流体沿着等密度面运动，不会改变其密度，因此不会对跨越等密度面的输运产生贡献。这样，$\Psi_b$ 的变化就直接与非绝热过程（如[海气相互作用](@entry_id:1120897)引起的水团转化、海洋内部的混合）联系起来，使得对驱动[翻转环流](@entry_id:1129255)的物理机制的诊断更为直接。

在稳定层化且密度随深度单调变化的理想情况下，$\Psi(\phi, z)$ 和 $\Psi_b(\phi, b)$ 描述的是同一个环流的不同侧面。两者可以通过[变量替换](@entry_id:141386)相关联：$\Psi(\phi, z) = \Psi_b(\phi, b(z))$。

#### 选择一个密度坐标

在实际应用中，由于[海水状态方程](@entry_id:1124595) $\rho(S, \theta, p)$ 的[非线性](@entry_id:637147)以及其对压力 $p$ 的依赖性，选择一个合适的密度坐标本身就是一个挑战。

最常用的密度变量是**位势密度**（potential density），即把水样绝热地移动到某个参考压力 $p_{\mathrm{ref}}$ 时的密度，记为 $\sigma_{p_{\mathrm{ref}}}$（例如，$\sigma_0$ 的参考压力为海面）。然而，一个关键的复杂性来自于**温盐压缩效应**（thermobaricity），即[热膨胀系数](@entry_id:150685) $\alpha$ 和盐收缩系数 $\beta$ 都随压力变化。

一个理想的密度坐标表面应该是一个**中性面**（neutral surface），即水块沿该表面移动时，其[浮力](@entry_id:154088)与周围环境保持一致。中性面的局部方向由条件 $\alpha(p) d\theta = \beta(p) dS$ 决定。而一个位势密度 $\sigma_{p_{\mathrm{ref}}}$ 表面的方向由 $\alpha(p_{\mathrm{ref}}) d\theta = \beta(p_{\mathrm{ref}}) dS$ 决定。由于温盐压缩效应，只有当原位压力 $p$ 接近参考压力 $p_{\mathrm{ref}}$ 时，这两个方向才一致。

这意味着，在远离其参考压力的深度，位势密度面不再是中性面。例如，在深海（如 $4000 \, \mathrm{m}$），使用海面参考的位势密度 $\sigma_0$ 作为坐标，会导致一个物理上沿着中性面运动的[绝热过程](@entry_id:138150)，在诊断中却表现为跨越多个 $\sigma_0$ [等值面](@entry_id:196027)的“伪非绝热”输运 。

为了克服这个问题，研究人员发展了**[中性密度](@entry_id:1128678)**（neutral density, $\gamma^n$）的概念。$\gamma^n$ 是一个通过在全球范围内尽可能地沿局部中性面积分而构造出的变量。它比任何单一参考压力的位势密度都更接近于一个真正的中性面。然而，由于中性面的[路径积分](@entry_id:165167)依赖性（即中性面的[法向量场](@entry_id:268853)在数学上不可积），一个完美的、全球通用的[中性密度](@entry_id:1128678)变量是不存在的。因此，$\gamma^n$ 仍然是一个近似，并且在存在真实混合和[海气通量](@entry_id:1120895)的情况下，它也不是一个严格的物质[守恒量](@entry_id:161475) 。尽管如此，对于诊断大规模、近绝热的海洋内部环流，$\gamma^n$ 通常被认为是比位势密度更优越的坐标。

### 高级主题与区域考虑

对[海洋环流](@entry_id:195237)的理解还需要考虑更复杂的动力学过程和区域特性，以及计算方法本身带来的影响。

#### 欧拉平均与剩余翻转：涡旋的角色

海洋中充满了各种尺度的**涡旋**（eddies），它们在输运物质和能量方面扮演着至关重要的角色。在分析纬向平均环流时，涡旋的贡献表现为一个**涡动通量**（eddy flux）项。例如，在纬向平均的[浮力](@entry_id:154088)方程中，会出现涡动浮力通量的散度项 $\nabla \cdot (\overline{\mathbf{u}'b'})$。

**变换欧拉平均**（Transformed Eulerian Mean, TEM）理论提供了一个强大的框架来理解涡旋的作用。其核心思想是将涡旋引起的绝[热输运](@entry_id:198424)重新解释为一个附加的平流项。为此，我们定义一个**剩余环流**（residual circulation）$\mathbf{u}_{\mathrm{res}}$，它等于**欧拉平均环流**（Eulerian mean circulation）$\overline{\mathbf{u}}$（即模型直接解析或平均得到的平均流）与一个**[涡致速度](@entry_id:1124135)**（eddy-induced velocity）或称“团块速度”（bolus velocity）$\mathbf{u}^*$ 的和 ：

$\mathbf{u}_{\mathrm{res}} = \overline{\mathbf{u}} + \mathbf{u}^*$

[涡致速度](@entry_id:1124135) $\mathbf{u}^*$ 被精确定义为恰好能抵消绝热涡动[通量散度](@entry_id:1125154)的平流速度。这样，在TEM框架下，[浮力](@entry_id:154088)方程简化为由剩余环流平流平均[浮力](@entry_id:154088)，再加上非绝热的项。

与此对应，总的[翻转环流](@entry_id:1129255)，即**剩余翻转[流函数](@entry_id:1132499)**（residual overturning streamfunction）$\Psi_{\mathrm{res}}$，也由两部分构成：欧拉平均翻转 $\Psi$ 和涡致翻转 $\Psi^*$ 。

$\Psi_{\mathrm{res}} = \Psi + \Psi^*$

在许多区域，特别是南大洋，涡致环流与欧拉平均环流的方向相反且量级相当。例如，风驱动的欧拉平均环流可能使等密度面陡峭化并驱动一个强的翻转，而涡旋则倾向于使等密度面平坦化，产生一个与之相抵消的涡致翻转。因此，示踪剂（如热量和碳）“感受”到的净翻转是由 $\Psi_{\mathrm{res}}$ 描述的，它通常比欧拉平均翻转 $\Psi$ 要弱得多。忽略涡旋的贡献会导致对海洋输运能力的严重高估。

#### 赤道挑战：地转平衡的失效

地转平衡和由其衍生的[热成风关系](@entry_id:192206)是中高纬度[海洋学](@entry_id:149256)中通过密度场推断速度场的基石。然而，这些关系都包含[科里奥利参数](@entry_id:1123077) $f = 2\Omega\sin\phi$ 作为分母。当靠近赤道时，$\phi \to 0$ 导致 $f \to 0$，这带来了两个根本性问题 ：

1.  **动力学失效**：地转平衡假设惯性力远小于科里奥利力（即罗斯贝数 $Ro \ll 1$）。当 $f \to 0$ 时，$Ro$ 趋于无穷大，地转平衡假设被彻底打破。
2.  **计算不稳定性**：$1/f$ 因子使得任何基于地转关系的计算在赤道附近都变得病态，对输入数据中的微小噪声极为敏感。

因此，在赤道区域必须考虑其他[动力学平衡](@entry_id:187220)。

*   **纬向动量平衡**：对于赤道潜流（EUC）这样的强劲纬向射流，驱动它的东向压力[梯度力](@entry_id:166847)主要与**垂向[湍流摩擦](@entry_id:266536)力**[相平衡](@entry_id:136822)。即 $-\frac{1}{\rho_0} \frac{\partial p}{\partial x} \approx \frac{\partial}{\partial z} (A_v \frac{\partial u}{\partial z})$，其中 $A_v$ 是垂向涡动粘性系数。这个摩擦平衡关系可以用来从密度梯度（通过[静力平衡](@entry_id:163498)与压力梯度相关）推断纬向流的垂向切变，而无需依赖 $f$。

*   **经向输运**：对于积分的经向输运，大尺度[风生环流](@entry_id:1134086)理论中的**[斯维尔德鲁普平衡](@entry_id:199174)**（Sverdrup balance），即 $\beta V = \frac{1}{\rho_0} \text{curl}_z(\boldsymbol{\tau}_w)$（其中 $\beta = \partial f/\partial y$），为分析远离赤道的内部流提供了框架。然而，为了获得穿过赤道的总输运，理论计算必须与该区域的**直接速度观测**（例如，通过锚系潜标）相结合，以约束和“弥补”理论失效的区域。

#### 计算考虑：垂向坐标的影响

[数值海洋模型](@entry_id:1128988)在离散化控制方程时采用不同的垂向坐标系，这对输运的诊断有直接影响 。

*   **z-坐标模型**（固定深度层）：这种模型的坐标面是水平的。当等密度面倾斜时，沿水平方向的数值扩散会人为地引起跨越等密度面的通量，产生**伪非绝热混合**（spurious diapycnal mixing），从而污染在密度空间中的翻转诊断。此外，其“阶梯状”的地形表示也可能引入压力梯度计算误差。

*   **$\sigma$-坐标模型**（地形追随坐标）：该模型的坐标面会随着地形起伏。虽然这能更好地解析底部边界层，但在陡峭地形区域，坐标面会变得非常倾斜。这不仅会产生严重的伪非绝热混合，还会导致巨大的**压力[梯度力](@entry_id:166847)计算误差**，这是此类模型的一个主要缺陷。

*   **等密度面坐标模型**：该模型的坐标面本身就是等密度面。因此，它在物理上最适合研究绝热和非绝热过程，能最大限度地减少伪非绝热混合。这使得它成为诊断水团转化和密度空间翻转的理想工具。

在[连续极限](@entry_id:162780)下，物理量如[正压流函数](@entry_id:1121352) $\Psi_b$ 应该与坐标系的选择无关。但在离散的数值模型中，上述不同坐标系所固有的、不同类型的离散化误差，会导致它们计算出的速度场和积分输运量存在差异。理解这些差异对于正确[解释模型](@entry_id:925527)结果至关重要。