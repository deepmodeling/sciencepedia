## 引言
在计算海洋学和[地球物理流体动力学](@entry_id:150356)领域，理解和量化复杂的流体运动是核心挑战之一。海洋与大气的速度场呈现出多尺度、时变的复杂矢量形态，直接分析这些矢量场往往非常困难。[流函数](@entry_id:1132499)与速度势提供了一套强大的数学框架，能够将二维矢量速度场分解为两个更易于分析和理解的标量场，从而揭示流动的内在结构、动力学特性和输运机制。这一分解不仅是理论分析的基石，也是现代[数值模拟](@entry_id:146043)和数据分析中不可或缺的实用工具。

本文旨在系统性地阐述[流函数](@entry_id:1132499)与速度势的计算原理与应用。我们将解决从一个给定的速度场快照中，如何准确地分离其旋转分量和辐散分量这一核心问题，并探讨这一方法在[物理海洋学](@entry_id:1129648)和相关学科中的深远意义。通过本文的学习，读者将能够掌握从理论定义到实际应用的完整知识链条。

文章将分为三个核心章节展开。在“原理与机制”中，我们将从[流函数和速度势](@entry_id:1132500)的基本定义出发，深入探讨其背后的[数学物理](@entry_id:265403)基础——[亥姆霍兹-霍奇分解](@entry_id:140525)，并详细阐述求解相应泊松方程时边界条件的设定与处理，包括在复杂几何（如含岛屿的[多连通域](@entry_id:185277)）中的挑战。接着，在“应用与跨学科联系”部分，我们将展示这些工具在实际研究中的强大威力，涵盖从诊断大尺度海洋输运、分离平衡与非平衡运动，到在先进的数据同化方案和气候模式中扮演的关键角色。最后，“动手实践”部分将提供一系列精心设计的计算练习，帮助读者将理论知识转化为实际操作能力，巩固对核心概念的理解。

## 原理与机制

在本章中，我们将深入探讨流函数与[速度势](@entry_id:262992)的计算原理及其在计算海洋学中的应用机制。这两种工具是[流体运动学](@entry_id:202835)分析的基石，能够将复杂的二维矢量速度场分解为更易于理解和处理的标量场。我们将从基本定义出发，逐步引入其在不同物理情境下的应用、求解这些标量场所涉及的数学物理问题，以及在处理复杂几何域和进行数值离散时所面临的挑战与解决方案。

### 基本定义与运动学诠释

在二维水平流体运动的分析中，速度场 $\mathbf{u}(x, y, t) = (u, v)$ 可以通过两个强大的[标量势](@entry_id:276177)——速度势 $\phi$ 和流函数 $\psi$——来进行分解和描述。这两种势的存在性分别与流场的两个基本运动学性质——无旋性与无辐散性——紧密相关。

一个**无旋 (irrotational)** 的流场，其涡度（curl）为零，即 $\nabla \times \mathbf{u} = 0$。根据矢量分析的基本定理，任何[无旋场](@entry_id:183486)都可以表示为一个[标量势](@entry_id:276177) $\phi$ 的梯度。因此，我们定义**[速度势](@entry_id:262992) (velocity potential)** $\phi$ 如下：
$$
\mathbf{u} = \nabla \phi \quad \Leftrightarrow \quad u = \frac{\partial \phi}{\partial x}, \quad v = \frac{\partial \phi}{\partial y}
$$
[速度势](@entry_id:262992)的等值线被称为**[等势线](@entry_id:276883) (equipotential lines)**。速度矢量 $\mathbf{u}$ 处处垂直于[等势线](@entry_id:276883)，[并指](@entry_id:276731)向 $\phi$ 增加最快的方向。因此，速度势直接描述了流场的“辐散”或“辐合”部分。

一个**无辐散 (non-divergent)** 的流场，其散度（divergence）为零，即 $\nabla \cdot \mathbf{u} = 0$。这在不可压缩流体中等同于[质量守恒](@entry_id:204015)。对于任何无辐散场，我们可以引入一个**流函数 (streamfunction)** $\psi$，使得速度场可以表示为：
$$
u = -\frac{\partial \psi}{\partial y}, \quad v = \frac{\partial \psi}{\partial x}
$$
这个定义巧妙地保证了 $\nabla \cdot \mathbf{u} = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} = -\frac{\partial^2 \psi}{\partial x \partial y} + \frac{\partial^2 \psi}{\partial y \partial x} = 0$（假设 $\psi$ 具有二阶连续偏导数）。[流函数](@entry_id:1132499)的等值线被称为**[流线](@entry_id:266815) (streamlines)**。在任意时刻，速度矢量 $\mathbf{u}$ 处处与流线相切。因此，流线描绘了该时刻流体运动的瞬时几何形态。在流函数定义下，两条流线之间的体积通量（对于[二维流](@entry_id:266853)，即单位厚度的流量）等于它们[流函数](@entry_id:1132499)值的差。

这两个[标量势](@entry_id:276177)的物理单位取决于它们所描述的速度场的单位。在海洋学中，我们通常处理两种速度场：单[位深度](@entry_id:897104)的速度场 $(u, v)$，单位为 $\mathrm{m}\,\mathrm{s}^{-1}$；以及深度积分的输送场 $(U, V)$，单位为 $\mathrm{m}^{2}\,\mathrm{s}^{-1}$。通过[量纲分析](@entry_id:140259)可以确定相应[势函数](@entry_id:176105)的单位 。
- 对于单[位深度](@entry_id:897104)的速度场 $(u, v)$，由于 $u = \partial \phi / \partial x$，我们有 $[\phi] = [u] \cdot [x] = (\mathrm{m}\,\mathrm{s}^{-1}) \cdot \mathrm{m} = \mathrm{m}^{2}\,\mathrm{s}^{-1}$。同理，对于[流函数](@entry_id:1132499)，$[u] = [\psi] / [y]$，因此 $[\psi] = [u] \cdot [y] = \mathrm{m}^{2}\,\mathrm{s}^{-1}$。
- 对于深度积分的输送场 $(U, V)$，由于 $U = \partial \Phi / \partial x$（这里用大写字母表示输送势），我们有 $[\Phi] = [U] \cdot [x] = (\mathrm{m}^{2}\,\mathrm{s}^{-1}) \cdot \mathrm{m} = \mathrm{m}^{3}\,\mathrm{s}^{-1}$。同理，输送流函数 $\Psi$ 的单位也是 $\mathrm{m}^{3}\,\mathrm{s}^{-1}$。输送流函数的单位通常用斯维尔德鲁普（Sverdrup, Sv）表示，其中 $1\,\mathrm{Sv} = 10^6\,\mathrm{m}^{3}\,\mathrm{s}^{-1}$。

一个至关重要的运动学概念是区分**瞬时流线 (instantaneous streamlines)** 和**[粒子轨迹](@entry_id:204827) (particle trajectories)**。流线是给定时刻 $t^*$ 时速度场的几何快照，而[粒子轨迹](@entry_id:204827)是单个流体[质点](@entry_id:186768)随时间流逝所经过的路径。只有在[定常流](@entry_id:191654)（即速度场不随时间变化）中，这两者才会重合。在[非定常流](@entry_id:269993)中，一个粒子在运动时，整个流线场也在不断演变，因此粒子的轨迹通常会穿越一系列不同的瞬时流线。

我们可以通过一个简单的例子来阐明这一点 。考虑一个模拟叠加在均匀[纬向流](@entry_id:756829)上的周期性经向振荡的二维速度场：
$$
u(x,y,t) = U_0, \quad v(x,y,t) = A\cos(\omega t)
$$
其中 $U_0, A, \omega$ 为正常数。该流场是无旋且不可压缩的。其[流函数](@entry_id:1132499)为 $\psi(x,y,t) = A\cos(\omega t)x - U_0 y$。在任意固定时刻 $t^*$，瞬时[流线](@entry_id:266815)是由方程 $A\cos(\omega t^*)x - U_0 y = \text{常数}$ 给出的一族平行直线。然而，一个从原点 $(0,0)$ 在 $t=0$ 时刻释放的粒子的轨迹，通过求解[拉格朗日方程](@entry_id:175419) $dx/dt = U_0$ 和 $dy/dt = A\cos(\omega t)$ 得到，其路径方程为：
$$
y(x) = \frac{A}{\omega}\sin\left(\frac{\omega x}{U_0}\right)
$$
这显然是一条正弦曲线，而不是一条直线。这个例子清晰地表明，在[非定常流](@entry_id:269993)中，即使流场结构非常简单，瞬时流线也不能用来预测粒子的长期输运路径。

### [亥姆霍兹-霍奇分解](@entry_id:140525)

亥姆霍兹-霍奇（Helmholtz-Hodge）分解定理是矢量分析中的一个核心结果，它为我们同时使用速度势和流函数提供了坚实的数学基础。该定理指出，在合适的边界条件下，任何一个在有界域上的二维矢量场 $\mathbf{u}$ 都可以唯一地（在[规范自由度](@entry_id:160491)内）分解为一个无旋[部分和](@entry_id:162077)一个无辐散部分的和：
$$
\mathbf{u} = \nabla \phi + \nabla^{\perp} \psi
$$
其中 $\nabla^{\perp} \psi = (-\partial\psi/\partial y, \partial\psi/\partial x)$ 是[流函数](@entry_id:1132499)的旋转梯度，它正好对应我们之前定义的无辐散速度场。

为了从给定的速度场 $\mathbf{u}$ 中求解出 $\phi$ 和 $\psi$，我们可以分别对上式取[散度和旋度](@entry_id:270881)。
对上式取散度，并利用 $\nabla \cdot (\nabla^{\perp} \psi) = 0$，我们得到一个关于[速度势](@entry_id:262992) $\phi$ 的**泊松方程 (Poisson equation)**：
$$
\nabla^2 \phi = \nabla \cdot \mathbf{u}
$$
这表明，速度势 $\phi$ 的拉普拉斯等于速度场的散度。换言之，流场的辐散（或辐合）是驱动速度势的源。

对上式取旋度（在二维中，我们通常指其垂直分量），并利用 $\nabla \times (\nabla \phi) = 0$，我们得到一个关于[流函数](@entry_id:1132499) $\psi$ 的泊松方程：
$$
\nabla^2 \psi = \nabla \times \mathbf{u} \cdot \hat{\mathbf{z}} = \zeta
$$
其中 $\zeta = \partial v/\partial x - \partial u/\partial y$ 是相对涡度的垂直分量。这表明，流函数 $\psi$ 的拉普拉斯等于流场的涡度。涡度是驱动流函数和[旋转流](@entry_id:276737)动的源。

因此，从一个给定的速度场快照计算[流函数和速度势](@entry_id:1132500)的根本任务，就是求解这两个泊松方程。这需要我们提供合适的边界条件，我们将在后续小节中详细讨论。

### 物理应用与特例

[流函数和速度势](@entry_id:1132500)不仅仅是数学工具，它们在[物理海洋学](@entry_id:1129648)中有深刻的物理意义和广泛的应用。

#### 地转流与地转流函数

在以旋转和层结为特征的大尺度[海洋环流](@entry_id:195237)中，一个主导的平衡是科里奥利力与水平压力[梯度力](@entry_id:166847)之间的**地转平衡 (geostrophic balance)**。在 $f$ 平面（即科里奥利参数 $f$ 为常数）的假设下，地转速度 $\mathbf{u}_g$ 满足：
$$
f\hat{\mathbf{z}} \times \mathbf{u}_g = -\frac{1}{\rho_0} \nabla p
$$
其中 $p$ 是动力压力，$\rho_0$ 是参考密度。展开该方程可得地转速度的分量形式：$u_g = -\frac{1}{f\rho_0}\frac{\partial p}{\partial y}$ 和 $v_g = \frac{1}{f\rho_0}\frac{\partial p}{\partial x}$。
一个关键的发现是，在 $f$ 平面上，[地转流](@entry_id:1125618)是严格无辐散的：$\nabla \cdot \mathbf{u}_g = 0$。这意味着[地转流](@entry_id:1125618)可以完全由一个[流函数](@entry_id:1132499)来描述 。通过将地转速度分量与[流函数](@entry_id:1132499)的定义 $u = -\partial\psi/\partial y$ 和 $v = \partial\psi/\partial x$ 进行比较，我们立即可以得到**地转流函数 (geostrophic streamfunction)** 的表达式：
$$
\psi_g = \frac{p}{f\rho_0}
$$
（忽略一个无关的积分常数）。这个简洁而优美的关系是物理海洋学中最强大的工具之一。它意味着，只要我们知道某个深度上的压[力场](@entry_id:147325)（例如，通过卫星高度计测量海面高度来推断），我们就可以直接计算出该深度的地转环流。压力等值线此时也成为了[地转流](@entry_id:1125618)的[流线](@entry_id:266815)。

然而，当考虑到科里奥利参数随纬度变化的 $\beta$ 效应（即 $f=f(y)$）时，[地转流](@entry_id:1125618)不再是无辐散的。其散度变为 $\nabla \cdot \mathbf{u}_g = -\frac{\beta}{f}v_g$，其中 $\beta = df/dy$。这个由经向流动产生的散度被称为**$\beta$ 效应**，它在驱动大尺度[海洋环流](@entry_id:195237)（如Sverdrup环流）中起着核心作用。在这种情况下，$p/(f\rho_0)$ 不再是严格意义上的流函数，而只是对旋转流动分量的一个近似。

#### [势流](@entry_id:159985)与[伯努利原理](@entry_id:270555)

在[无旋流动](@entry_id:159258)（$\nabla \times \mathbf{u} = \mathbf{0}$）的理想情况下，整个流场可以由一个速度势 $\phi$ 描述，即 $\mathbf{u} = \nabla \phi$。这种流动被称为**[势流](@entry_id:159985) (potential flow)**。在海洋学的某些特定问题中，例如[表面波](@entry_id:755682)的线性理论，[势流理论](@entry_id:267452)提供了有效的分析框架。

对于[势流](@entry_id:159985)，我们可以推导出著名的**[伯努利原理](@entry_id:270555) (Bernoulli's principle)**。考虑一个定常、无粘、正压（密度仅为压力的函数）的流体，在保守[体力](@entry_id:174230)（如重力）作用下运动 。其动量方程（欧拉方程）可以被积分为：
$$
\frac{1}{2} \|\mathbf{u}\|^2 + h + \Phi_b = \text{常数}
$$
其中 $\|\mathbf{u}\|^2$ 是流速的平方，$\Phi_b$ 是[体力](@entry_id:174230)势（例如重力势 $\Phi_b = gz$），而 $h$ 是比焓，满足 $dh = dp/\rho(p)$。这个方程左侧的量被称为**伯努利函数 (Bernoulli function)**，它在整个流场中（沿着[流线](@entry_id:266815)，对于无[旋流](@entry_id:153202)则是在整个连通域内）保持不变。这表达了流体能量的守恒：动能（$\frac{1}{2} \|\mathbf{u}\|^2$）、压力能（通过 $h$ 体现）和势能（$\Phi_b$）可以相互转换，但它们的总和保持不变。值得注意的是，[速度势](@entry_id:262992) $\phi$ 具有**[规范自由度](@entry_id:160491) (gauge freedom)**：给 $\phi$ 加上任意一个空间常数并不会改变速度场 $\mathbf{u}$，因此也不会改变伯努利函数的值。

### [边值问题](@entry_id:1121801)

如前所述，从速度场反演势函数 $\phi$ 和 $\psi$ 的核心是求解两个泊松方程。这是一个经典的[边值问题](@entry_id:1121801)，其解的性质（存在性、唯一性）以及求解方法都强烈地依赖于区域的边界条件。

#### 闭合域中的良态性

考虑一个有界的、单连通的海洋盆地 $\Omega$，其边界 $\partial\Omega$ 为不透水的海岸线，即法向流速为零：$\mathbf{u} \cdot \mathbf{n} = 0$。在这种情况下，[亥姆霍兹-霍奇分解](@entry_id:140525)的两个势函数 $\phi$ 和 $\psi$ 的求解问题具有非常明确的数学结构 。

对于**流函数 $\psi$**，法向流速为零的条件 $\mathbf{u} \cdot \mathbf{n} = 0$ 意味着流函数在边界上是常数。这是因为沿边界的切向速度分量 $u_t = \mathbf{u} \cdot \mathbf{t}$ 与流函数沿法向的导数有关（$\mathbf{u} \cdot \mathbf{t} = \partial\psi/\partial n$），而法向速度分量 $u_n = \mathbf{u} \cdot \mathbf{n}$ 与流函数沿切向的导数有关（$u_n = -\partial\psi/\partial s$）。因此，$\mathbf{u} \cdot \mathbf{n} = 0$ 意味着 $\partial\psi/\partial s = 0$，即 $\psi$ 沿边界 $\partial\Omega$ 是一个常数。我们可以任意设定这个常数（例如，设为零）。这样，求解 $\psi$ 的问题就变成了一个具有**狄利克雷 (Dirichlet)** 边界条件的泊松问题：
$$
\nabla^2 \psi = \zeta \quad \text{在 } \Omega \text{ 内}, \quad \psi = \text{常数} \quad \text{在 } \partial\Omega \text{ 上}
$$
对于给定的涡度场 $\zeta$，这个问题总是存在唯一的解（忽略一个无关紧要的整体常数）。从[变分原理](@entry_id:198028)的角度看，对于任何合理的涡度场 $\zeta$，该问题都存在一个唯一的[弱解](@entry_id:161732)，不需要对 $\zeta$ 施加任何额外的**[相容性条件](@entry_id:637057) (compatibility condition)** 。

对于**[速度势](@entry_id:262992) $\phi$**，边界条件源于分解的正交性要求，通常要求辐散流分量也没有法向流速，即 $(\nabla\phi) \cdot \mathbf{n} = 0$，也就是 $\partial\phi/\partial n = 0$。这样，求解 $\phi$ 的问题就变成了一个具有**诺伊曼 (Neumann)** 边界条件的泊松问题：
$$
\nabla^2 \phi = \nabla \cdot \mathbf{u} \quad \text{在 } \Omega \text{ 内}, \quad \frac{\partial \phi}{\partial n} = 0 \quad \text{在 } \partial\Omega \text{ 上}
$$
与[狄利克雷问题](@entry_id:274408)不同，[诺伊曼问题](@entry_id:176713)并非对任意右端项都可解。它要求一个[相容性条件](@entry_id:637057)。通过对泊松方程在整个区域 $\Omega$ 上积分，并应用[散度定理](@entry_id:143110)，我们得到：
$$
\int_{\Omega} (\nabla \cdot \mathbf{u}) \, dA = \int_{\Omega} \nabla^2 \phi \, dA = \int_{\partial\Omega} \frac{\partial \phi}{\partial n} \, ds
$$
代入边界条件 $\partial\phi/\partial n = 0$，我们发现[相容性条件](@entry_id:637057)为 $\int_{\Omega} (\nabla \cdot \mathbf{u}) \, dA = 0$。幸运的是，这个数学上的要求恰好被物理边界条件所保证：$\int_{\Omega} (\nabla \cdot \mathbf{u}) \, dA = \int_{\partial\Omega} \mathbf{u} \cdot \mathbf{n} \, ds = 0$。因此，在不透水边界的闭合域中，$\phi$ 的求解问题也是良态的，其解在相加一个任意常数的意义下是唯一的。

#### 边界条件的施加

在实际的海洋模型中，边界条件的设定是一个核心问题，它直接决定了模型的物理行为。

对于**开边界 (open boundaries)**，例如一个连接到大洋的区域模型，我们需要规定信息如何流入和流出模型区域。对于速度势 $\phi$ 的求解（通常作为[压力泊松方程](@entry_id:1129887)的一部分），我们有两种常见的选择 ：
1.  **[狄利克雷条件](@entry_id:137096)**：在开边界上指定 $\phi = \phi_0$。因为 $\phi$ 与压力或海面高度成正比，这相当于指定了开边界上的海面高度或压力。这种方法适用于当我们有来自潮汐模型、卫星观测或更大尺度模型的边界海高信息时。此时，边界上的法向流速将作为求解结果被被动地诊断出来。
2.  **[诺伊曼条件](@entry_id:165471)**：在开边界上指定 $\partial\phi/\partial n = g$。这相当于指定了边界上的法向流速或输运。例如，如果我们要指定一个法向流速 $V_n$，那么就需要设置 $g = (\mathbf{u}^* \cdot \mathbf{n}) - V_n$（在压力修正法的框架下）。这种方法适用于当边界输运是已知量时，例如在河流入海口或需要强制一个特定的海峡通量时。

对于**固壁边界 (solid boundaries)**，特别是在考虑粘性的情况下，边界条件的复杂性会增加。除了不透水条件（$\mathbf{u} \cdot \mathbf{n} = 0$），我们可能还需要施加**[无滑移条件](@entry_id:275670) (no-slip condition)**（$\mathbf{u} \cdot \mathbf{t} = 0$）。在[流函数](@entry_id:1132499)-涡度 ($\psi-\zeta$) 公式中，这会带来一个挑战 。
- 不透水条件 $(\mathbf{u} \cdot \mathbf{n} = 0)$ 转化为对 $\psi$ 的狄利克雷条件：$\psi = \text{常数}$。
- [无滑移条件](@entry_id:275670) $(\mathbf{u} \cdot \mathbf{t} = 0)$ 转化为对 $\psi$ 的[诺伊曼条件](@entry_id:165471)：$\partial\psi/\partial n = 0$。
在同一个边界上同时施加狄利克雷和诺伊曼条件会使泊松问题**超定 (over-determined)**，通常无解。正确的处理方法是，只使用狄利克雷条件 ($\psi = \text{常数}$) 来求解泊松方程 $\nabla^2 \psi = \zeta$。而[诺伊曼条件](@entry_id:165471) ($\partial\psi/\partial n = 0$) 则被用来确定边界上必须生成的涡度值 $\zeta_b$。这种边界涡度的产生是[粘性流](@entry_id:136330)体在固壁附近形成边界层的物理结果，它确保了求解得到的流场能够同时满足两种物理边界条件。

### [多连通域](@entry_id:185277)中的拓扑效应

当海洋区域包含岛屿时，其几何拓扑结构从单连通变为**多连通 (multiply connected)**。这种拓扑上的改变对流场分解引入了深刻的、非局域的效应。

在包含 $K$ 个岛屿的[多连通域](@entry_id:185277) $\Omega$ 中，[亥姆霍兹-霍奇分解](@entry_id:140525)需要增加一个额外的项 ：
$$
\mathbf{u} = \nabla\phi + \nabla^{\perp}\psi + \mathbf{h}
$$
新增的 $\mathbf{h}$ 是一个**调和向量场 (harmonic vector field)**，它既是无旋的（$\nabla \times \mathbf{h} = 0$）也是无辐散的（$\nabla \cdot \mathbf{h} = 0$）。在单连通域中，满足不透水边界条件的调和场只能是[零向量](@entry_id:156189)场。但在[多连通域](@entry_id:185277)中，存在一个 $K$ 维的非平凡调和场空间。

这些调和场的物理意义与环绕岛屿的**环流 (circulation)** 直接相关。环流定义为速度沿闭合路径的[线积分](@entry_id:141417)，$\Gamma = \oint \mathbf{u} \cdot d\mathbf{s}$。对于 $\nabla\phi$ 分量，其环流恒为零。因此，环绕第 $j$ 个岛屿 $\Gamma_j$ 的总环流由 $\psi$ 和 $\mathbf{h}$ 贡献。调和场 $\mathbf{h}$ 捕捉了那些不依赖于区域内部涡度分布、纯粹由拓扑结构允许存在的“穿岛”流动。每个调和场基函数都对应于一个环绕特定岛屿组合的流动模式，而总的 $\mathbf{h}$ 场由这 $K$ 个独立的环绕岛屿的环流量所唯一确定。

在实际计算中，直接处理调和场可能很复杂。一个等效且更具操作性的方法是引入**切[割线](@entry_id:178768) (cut lines)** 。通过从每个岛屿向外延伸一条或多条虚拟的线，将[多连通域](@entry_id:185277)切割成一个等效的单连通域。然后，我们允许流函数 $\psi$ 在跨越这些切[割线](@entry_id:178768)时发生一个常数值的**跳跃 (jump)**，记为 $\Delta\psi_j$。这个跳跃值在物理上等于穿过该切[割线](@entry_id:178768)的净输运。

环绕某个岛屿的环流量 $\Gamma_i$ 与其路径所穿越的切[割线](@entry_id:178768)上的流函数跳跃值直接相关。具体关系为，$\Gamma_i$ 等于该路径所穿越的所有切[割线](@entry_id:178768)跳跃值的（带符号）总和。例如，考虑一个由两个岛屿（A和B）组成的链状结构，一条切[割线](@entry_id:178768) $L_1$ 连接岛屿A与外部边界，另一条切[割线](@entry_id:178768) $L_2$ 连接岛屿B与岛屿A。
- 环绕岛屿B的环流 $\Gamma_B$，如果其路径只正向穿越 $L_2$，那么 $\Gamma_B = \Delta\psi_2$。
- 环绕岛屿A的环流 $\Gamma_A$，如果其路径正向穿越 $L_1$ 并反向穿越 $L_2$，那么 $\Gamma_A = \Delta\psi_1 - \Delta\psi_2$。
给定观测到的环流量 $\Gamma_A = 1.5 \times 10^6 \, \mathrm{m}^2/\mathrm{s}$ 和 $\Gamma_B = -0.6 \times 10^6 \, \mathrm{m}^2/\mathrm{s}$，我们可以解出所需的流函数跳跃值：$\Delta\psi_2 = -6 \times 10^5 \, \mathrm{m}^2/\mathrm{s}$ 以及 $\Delta\psi_1 = 9 \times 10^5 \, \mathrm{m}^2/\mathrm{s}$。通过这种方式，复杂的拓扑问题被转化为一个具有内部跳跃条件的、在单连通域上的[边值问题](@entry_id:1121801)。

### 数值离散与[交错网格](@entry_id:1125805)

将连续的泊松方程转化为可计算的离散形式是计算海洋学的核心任务之一。网格的选取，特别是变量的交[错排](@entry_id:264832)布，对数值解的精度和稳定性有至关重要的影响。Arakawa提出了一系列[交错网格](@entry_id:1125805)方案，其中A、B、C三种网格在海洋模型中最为常见 。

- **A网格 (A-grid)**：所有变量（$u, v, \phi, \psi$）都位于网格单元的中心。这种布置最为简单，但在表示[波的色散](@entry_id:275520)关系和[地转适应](@entry_id:191286)过程时表现不佳，容易产生虚假的计算模态和网格尺度的噪声。
- **B网格 (B-grid)**：标量位于单元中心，速度分量 $(u, v)$ 位于单元的角点。这种网格在表示[地转适应](@entry_id:191286)时存在问题，并且其[离散拉普拉斯算子](@entry_id:634690)存在一个“棋盘”状的[零空间](@entry_id:171336)，使得从速度场反演压力或[速度势](@entry_id:262992)时难以获得唯一解。
- **C网格 (C-grid)**：标量位于单元中心，法向速度分量位于单元的边上（$u$ 在东西边，v 在南北边）。这种布置具有许多优良的数值特性。

在求解[流函数和速度势](@entry_id:1132500)的泊松方程时，**C网格**的优势尤为突出：
1.  **算子的自然定义**：离散的散度算子（将边上的速度映射到中心的散度）和离散的[梯度算子](@entry_id:1125719)（将中心的标量映射到边上的梯度）可以非常自然地定义。离散的涡度则自然地定义在角点上，可以通过平均得到中心值。
2.  **算子的伴随关系**：在C网格上，[离散梯度](@entry_id:171970)算子是离散[散度算子](@entry_id:265975)的负[伴随算子](@entry_id:140236)。这一性质保证了由它们复合而成的[离散拉普拉斯算子](@entry_id:634690)（$L = -\nabla \cdot \nabla$）是**[对称正定](@entry_id:145886)**的（在给定边界条件后）。这使得泊松方程的求解非常稳健，并且保证了能量守恒等重要的物理性质。
3.  **模式表示的优越性**：C网格能够准确地表示[惯性重力波](@entry_id:1126476)的色散关系，并能有效避免B网格中的地转[解耦](@entry_id:160890)问题。这使得从速度场快照分解旋转和辐散能量时，数值误差和模式之间的能量混淆（aliasing）更小。

综上所述，虽然从理论上讲，[流函数和速度势](@entry_id:1132500)的计算是求解两个泊松方程，但在实践中，选择像C网格这样具有优良数值属性的离散化方案，对于保证计算结果的准确性、稳定性以及物理真实性是至关重要的。