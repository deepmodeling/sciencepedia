{
    "hands_on_practices": [
        {
            "introduction": "Understanding the formation of sharp oceanic fronts begins with quantifying the process of frontogenesis. This practice delves into the derivation of the frontogenesis function, a key diagnostic that measures the rate at which a flow field intensifies horizontal gradients . By deriving this function from the material conservation of a tracer and applying it to a specified flow, you will gain direct insight into how the strain component of the velocity field drives frontal sharpening, a fundamental mechanism in submesoscale dynamics.",
            "id": "3801116",
            "problem": "Consider a horizontally two-dimensional, inviscid, adiabatic, and incompressible submesoscale flow in the ocean. Let the horizontal velocity field be locally linear in space so that its horizontal gradient tensor at a point is the constant matrix $\\nabla_{h} \\mathbf{u}_{h} = \\mathbf{A} \\in \\mathbb{R}^{2 \\times 2}$. The local horizontal temperature field is also taken to be linear, $T(x,y) = T_{0} + \\alpha x + \\beta y$, with constant horizontal gradient $\\nabla_{h} T = (\\alpha, \\beta)^{\\top}$. The frontogenesis function is defined here as the material derivative of the magnitude of the horizontal temperature gradient, $F = \\frac{D}{Dt} \\left| \\nabla_{h} T \\right|$.\n\nUsing only the scalar advection equation for temperature, $\\frac{D T}{D t} = 0$, the definition of the material derivative, and the decomposition of a matrix into its symmetric (strain-rate) and antisymmetric (rotation-rate) parts, derive an exact expression for $F$ in terms of the symmetric strain-rate tensor $\\mathbf{S} = \\frac{1}{2} \\left( \\mathbf{A} + \\mathbf{A}^{\\top} \\right)$ and the horizontal temperature gradient $\\nabla_{h} T$. Clearly state all assumptions used.\n\nThen evaluate your expression at a point where the velocity gradient tensor is\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\na  b - \\omega \\\\\nb + \\omega  -a\n\\end{pmatrix},\n$$\nwith $a = 3.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$, $b = 2.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$, and $\\omega = 5.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$, and where the horizontal temperature gradient is given by $\\alpha = 2.0 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ and $\\beta = 1.5 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$.\n\nExpress the final numerical value of $F$ in $\\mathrm{K} \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$ and round your answer to three significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in geophysical fluid dynamics concerning the process of frontogenesis. All necessary information is provided, and the given physical parameters are consistent and realistic. We may therefore proceed with the solution.\n\nThe key assumptions stated or implied in the problem text are:\n1.  The flow is horizontally two-dimensional, inviscid, adiabatic, and incompressible. The incompressibility condition for a two-dimensional flow, $\\nabla_{h} \\cdot \\mathbf{u}_{h} = 0$, implies that the trace of the velocity gradient tensor $\\mathbf{A}$ must be zero, which is satisfied by the given matrix structure.\n2.  The adiabatic condition implies that temperature $T$ is conserved following a fluid parcel, which is expressed by the material derivative being zero: $\\frac{DT}{Dt} = 0$.\n3.  The horizontal velocity field $\\mathbf{u}_{h}$ and the temperature field $T$ are locally linear in the horizontal coordinates $(x,y)$. This means their respective gradients, $\\nabla_{h} \\mathbf{u}_{h} = \\mathbf{A}$ and $\\nabla_{h} T = \\mathbf{g}$, are constant in the local region of interest.\n4.  The magnitude of the temperature gradient is non-zero, i.e., $|\\nabla_h T| \\neq 0$.\n\nThe frontogenesis function $F$ is defined as the material derivative of the magnitude of the horizontal temperature gradient vector $\\mathbf{g} = \\nabla_h T$. Let us denote the magnitude by $G = |\\mathbf{g}| = |\\nabla_h T|$.\n$$\nF = \\frac{D G}{D t} = \\frac{D}{D t} |\\nabla_{h} T|\n$$\nWe can express the magnitude squared as $G^2 = \\mathbf{g} \\cdot \\mathbf{g} = g_i g_i$. Taking the material derivative of $G^2$:\n$$\n\\frac{D}{Dt}(G^2) = \\frac{D}{Dt}(\\mathbf{g} \\cdot \\mathbf{g}) = \\frac{D\\mathbf{g}}{Dt} \\cdot \\mathbf{g} + \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt} = 2 \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt}\n$$\nAlso, by the chain rule, $\\frac{D}{Dt}(G^2) = 2G \\frac{DG}{Dt} = 2G F$.\nEquating the two expressions gives:\n$$\n2G F = 2 \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt} \\implies F = \\frac{1}{G} \\left(\\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt}\\right) = \\frac{\\mathbf{g}}{|\\mathbf{g}|^2} \\cdot \\frac{D\\mathbf{g}}{Dt}\n$$\nThe next step is to find an expression for $\\frac{D\\mathbf{g}}{Dt} = \\frac{D(\\nabla_h T)}{Dt}$. We use the standard identity for the commutation of the material derivative and the gradient operator:\n$$\n\\frac{D}{Dt}(\\nabla_h T) = \\nabla_h \\left(\\frac{DT}{Dt}\\right) - (\\nabla_h \\mathbf{u}_h)^{\\top} (\\nabla_h T)\n$$\nGiven the adiabatic assumption, $\\frac{DT}{Dt} = 0$, so $\\nabla_h(\\frac{DT}{Dt}) = 0$. The expression simplifies to:\n$$\n\\frac{D\\mathbf{g}}{Dt} = -(\\nabla_h \\mathbf{u}_h)^{\\top} \\mathbf{g}\n$$\nUsing the problem's notation, $\\nabla_h \\mathbf{u}_h = \\mathbf{A}$, we have:\n$$\n\\frac{D\\mathbf{g}}{Dt} = -\\mathbf{A}^{\\top} \\mathbf{g}\n$$\nSubstituting this back into the expression for $F$:\n$$\nF = \\frac{1}{|\\mathbf{g}|} (\\mathbf{g} \\cdot (-\\mathbf{A}^{\\top} \\mathbf{g}))\n$$\nThis dot product can be written as a quadratic form using transpose notation: $\\mathbf{x} \\cdot (\\mathbf{M} \\mathbf{y}) = \\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{y}$. So,\n$$\nF = -\\frac{\\mathbf{g}^{\\top} \\mathbf{A}^{\\top} \\mathbf{g}}{|\\mathbf{g}|}\n$$\nThe problem requires the expression in terms of the symmetric strain-rate tensor $\\mathbf{S}$. We decompose the velocity gradient tensor $\\mathbf{A}$ into its symmetric part $\\mathbf{S}$ and its antisymmetric part $\\mathbf{\\Omega}$ (the rotation-rate tensor):\n$$\n\\mathbf{A} = \\mathbf{S} + \\mathbf{\\Omega}, \\quad \\text{where} \\quad \\mathbf{S} = \\frac{1}{2}(\\mathbf{A} + \\mathbf{A}^{\\top}) \\quad \\text{and} \\quad \\mathbf{\\Omega} = \\frac{1}{2}(\\mathbf{A} - \\mathbf{A}^{\\top})\n$$\nTaking the transpose of $\\mathbf{A}$ gives $\\mathbf{A}^{\\top} = \\mathbf{S}^{\\top} + \\mathbf{\\Omega}^{\\top}$. By definition, $\\mathbf{S}$ is symmetric ($\\mathbf{S}^{\\top} = \\mathbf{S}$) and $\\mathbf{\\Omega}$ is antisymmetric ($\\mathbf{\\Omega}^{\\top} = -\\mathbf{\\Omega}$). Therefore, $\\mathbf{A}^{\\top} = \\mathbf{S} - \\mathbf{\\Omega}$.\nSubstituting this into the expression for $F$:\n$$\nF = -\\frac{\\mathbf{g}^{\\top} (\\mathbf{S} - \\mathbf{\\Omega}) \\mathbf{g}}{|\\mathbf{g}|} = -\\frac{\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g} - \\mathbf{g}^{\\top} \\mathbf{\\Omega} \\mathbf{g}}{|\\mathbf{g}|}\n$$\nFor any vector $\\mathbf{x}$ and any antisymmetric matrix $\\mathbf{M}$, the quadratic form $\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x}$ is identically zero. This is because $(\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x})^{\\top} = \\mathbf{x}^{\\top} \\mathbf{M}^{\\top} \\mathbf{x} = \\mathbf{x}^{\\top} (-\\mathbf{M}) \\mathbf{x} = -(\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x})$. Since the quantity is a scalar and is equal to its negative, it must be zero. Thus, $\\mathbf{g}^{\\top} \\mathbf{\\Omega} \\mathbf{g} = 0$.\n\nThe final expression for the frontogenesis function in terms of the strain-rate tensor and the temperature gradient is:\n$$\nF = -\\frac{\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g}}{|\\mathbf{g}|} = -\\frac{(\\nabla_{h} T)^{\\top} \\mathbf{S} (\\nabla_{h} T)}{|\\nabla_{h} T|}\n$$\nThis result shows that frontogenesis is driven by the strain field, not the rotational part of the flow.\n\nNow, we evaluate this expression for the given parameters. The velocity gradient tensor is:\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\na  b - \\omega \\\\\nb + \\omega  -a\n\\end{pmatrix}\n$$\nThe symmetric strain-rate tensor $\\mathbf{S}$ is:\n$$\n\\mathbf{S} = \\frac{1}{2}(\\mathbf{A} + \\mathbf{A}^{\\top}) = \\frac{1}{2} \\left( \\begin{pmatrix} a  b - \\omega \\\\ b + \\omega  -a \\end{pmatrix} + \\begin{pmatrix} a  b + \\omega \\\\ b - \\omega  -a \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 2a  2b \\\\ 2b  -2a \\end{pmatrix} = \\begin{pmatrix} a  b \\\\ b  -a \\end{pmatrix}\n$$\nThe horizontal temperature gradient is $\\mathbf{g} = (\\alpha, \\beta)^{\\top}$. The quadratic form in the numerator of $F$ is:\n$$\n\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g} = \\begin{pmatrix} \\alpha  \\beta \\end{pmatrix} \\begin{pmatrix} a  b \\\\ b  -a \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\begin{pmatrix} a\\alpha + b\\beta  b\\alpha - a\\beta \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = a\\alpha^2 + b\\alpha\\beta + b\\alpha\\beta - a\\beta^2 = a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta\n$$\nThe magnitude of the gradient is $|\\mathbf{g}| = \\sqrt{\\alpha^2 + \\beta^2}$.\nSo, the specific expression for $F$ is:\n$$\nF = - \\frac{a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta}{\\sqrt{\\alpha^2 + \\beta^2}}\n$$\nWe are given the values:\n$a = 3.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$\n$b = 2.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$\n$\\alpha = 2.0 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$\n$\\beta = 1.5 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$\n(Note that the value of $\\omega$ is not needed, as rotation does not contribute to frontogenesis.)\n\nLet's compute the terms:\n$\\alpha^2 = (2.0 \\times 10^{-4})^2 = 4.0 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\beta^2 = (1.5 \\times 10^{-4})^2 = 2.25 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\alpha^2 - \\beta^2 = (4.0 - 2.25) \\times 10^{-8} = 1.75 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\alpha\\beta = (2.0 \\times 10^{-4})(1.5 \\times 10^{-4}) = 3.0 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n\nThe numerator term is:\n$a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta = (3.0 \\times 10^{-5})(1.75 \\times 10^{-8}) + 2(2.0 \\times 10^{-5})(3.0 \\times 10^{-8})$\n$= 5.25 \\times 10^{-13} + 12.0 \\times 10^{-13} = 17.25 \\times 10^{-13} \\ \\mathrm{K}^2 \\mathrm{m}^{-2} \\mathrm{s}^{-1}$\n\nThe denominator term is:\n$\\sqrt{\\alpha^2 + \\beta^2} = \\sqrt{4.0 \\times 10^{-8} + 2.25 \\times 10^{-8}} = \\sqrt{6.25 \\times 10^{-8}} = 2.5 \\times 10^{-4} \\ \\mathrm{K} \\mathrm{m}^{-1}$\n\nFinally, we compute $F$:\n$$\nF = - \\frac{17.25 \\times 10^{-13} \\ \\mathrm{K}^2 \\mathrm{m}^{-2} \\mathrm{s}^{-1}}{2.5 \\times 10^{-4} \\ \\mathrm{K} \\mathrm{m}^{-1}} = -6.9 \\times 10^{-9} \\ \\mathrm{K} \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}\n$$\nThe problem asks to round the answer to three significant figures. The exact answer is $-6.9 \\times 10^{-9}$. Expressed with three significant figures, this is $-6.90 \\times 10^{-9}$.",
            "answer": "$$\n\\boxed{-6.90 \\times 10^{-9}}\n$$"
        },
        {
            "introduction": "A critical decision in numerical oceanography is the choice between hydrostatic and nonhydrostatic models, a choice that is particularly relevant for submesoscale processes where vertical accelerations can be significant. This exercise guides you through a quantitative assessment of the errors introduced by the hydrostatic assumption . By comparing the dynamic response of hydrostatic and nonhydrostatic systems across different physical regimes, you will develop a principled understanding of when and why nonhydrostatic dynamics are essential for accurately simulating frontal circulation.",
            "id": "3801142",
            "problem": "Consider a rotating, stratified, incompressible ocean mixed layer where a lateral density front induces a secondary circulation in the across-front and vertical directions. Model the local dynamics of small-amplitude perturbations using the Boussinesq approximation on an $f$-plane with constant buoyancy frequency $N$ and Coriolis parameter $f$. Let the perturbation fields be two-dimensional in the across-front coordinate $y$ and the vertical coordinate $z$, with along-front invariance. Assume that the secondary circulation can be represented as a superposition of small-amplitude plane-wave modes characterized by horizontal wavenumber $k$ (in $\\mathrm{rad}/\\mathrm{m}$) and vertical wavenumber $m$ (in $\\mathrm{rad}/\\mathrm{m}$), and that the background stratification is constant.\n\nStarting from the linearized Boussinesq equations and the incompressibility condition, do the following:\n\n1. Using a plane-wave ansatz of the form $\\exp\\left(i k y + i m z - i \\omega t\\right)$ for the perturbation velocities and buoyancy, derive the exact nonhydrostatic dispersion relation $\\omega = \\omega_{\\mathrm{nh}}(N,f,k,m)$ for inertia–gravity waves in the rotating, stratified, incompressible limit.\n\n2. Impose the hydrostatic assumption by neglecting the vertical acceleration in the vertical momentum equation and derive the corresponding hydrostatic dispersion relation $\\omega = \\omega_{\\mathrm{h}}(N,f,k,m)$, valid in the regime where $m^2 \\gg k^2$.\n\n3. Consider a periodic frontogenesis forcing that drives the secondary circulation at angular frequency $\\omega_f$ (in $\\mathrm{s}^{-1}$). For a single plane-wave mode $(k,m)$ subject to a harmonic forcing of amplitude $F_0$ (in $\\mathrm{m}/\\mathrm{s}^2$), model the vertical velocity amplitude $A$ as the steady-state amplitude of a forced linear oscillator where the natural frequency is given by the corresponding dispersion relation. Specifically, define the nonhydrostatic and hydrostatic amplitudes as\n$$\nA_{\\mathrm{nh}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{nh}}^2 - \\omega_f^2\\right|}, \\quad\nA_{\\mathrm{h}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{h}}^2 - \\omega_f^2\\right|}.\n$$\nThis construction is intended to quantify the sensitivity of the modeled secondary circulation to the hydrostatic assumption at the mode level.\n\n4. Define the relative hydrostatic error $E$ for a given mode and forcing as\n$$\nE = \\frac{\\left|A_{\\mathrm{h}} - A_{\\mathrm{nh}}\\right|}{\\left|A_{\\mathrm{nh}}\\right|},\n$$\nwhich is a dimensionless quantity.\n\nYour task is to implement a program that, for each test case below, computes the relative hydrostatic error $E$ as a float rounded to six decimal places. Use the following scientifically realistic test suite, where $k = 2\\pi/L$ and $m = n\\pi/H$ with $L$ the across-front wavelength (in $\\mathrm{m}$), $H$ the mixed-layer depth (in $\\mathrm{m}$), and $n$ the vertical mode index (integer):\n\n- Test case 1 (hydrostatic-friendly submesoscale): $N = 1.0\\times 10^{-2}\\ \\mathrm{s}^{-1}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$, $L = 5000\\ \\mathrm{m}$, $H = 50\\ \\mathrm{m}$, $n = 1$, $\\omega_f = 1.0\\times 10^{-5}\\ \\mathrm{s}^{-1}$, $F_0 = 1.0\\ \\mathrm{m}/\\mathrm{s}^{2}$.\n- Test case 2 (borderline aspect ratio): $N = 1.0\\times 10^{-2}\\ \\mathrm{s}^{-1}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$, $L = 300\\ \\mathrm{m}$, $H = 150\\ \\mathrm{m}$, $n = 1$, $\\omega_f = 2.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$, $F_0 = 1.0\\ \\mathrm{m}/\\mathrm{s}^{2}$.\n- Test case 3 (nonhydrostatic-dominated): $N = 1.0\\times 10^{-2}\\ \\mathrm{s}^{-1}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$, $L = 50\\ \\mathrm{m}$, $H = 500\\ \\mathrm{m}$, $n = 1$, $\\omega_f = 1.0\\times 10^{-5}\\ \\mathrm{s}^{-1}$, $F_0 = 1.0\\ \\mathrm{m}/\\mathrm{s}^{2}$.\n- Test case 4 (near-inertial regime in a weakly stratified mixed layer): $N = 2.0\\times 10^{-3}\\ \\mathrm{s}^{-1}$, $f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$, $L = 1000\\ \\mathrm{m}$, $H = 30\\ \\mathrm{m}$, $n = 1$, $\\omega_f = 1.2\\times 10^{-4}\\ \\mathrm{s}^{-1}$, $F_0 = 1.0\\ \\mathrm{m}/\\mathrm{s}^{2}$.\n\nAll quantities involving angles or wavenumbers are to be treated in radians; frequencies are in $\\mathrm{s}^{-1}$; distances are in meters. Your program should produce a single line of output containing the errors $E$ for the test cases as a comma-separated list enclosed in square brackets, for example, $\\left[\\text{result1},\\text{result2},\\text{result3},\\text{result4}\\right]$, with each entry rounded to six decimal places.",
            "solution": "We begin from the linearized, rotating, stratified Boussinesq equations for small perturbations about a state of rest with constant stratification. Let $\\boldsymbol{u} = (u,v,w)$ be the velocity, $p'$ the pressure perturbation, and $b$ the buoyancy perturbation. The governing equations on an $f$-plane are\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + f \\hat{\\boldsymbol{z}} \\times \\boldsymbol{u} = -\\frac{1}{\\rho_0} \\nabla p' + b \\hat{\\boldsymbol{z}},\n$$\n$$\n\\frac{\\partial b}{\\partial t} + N^2 w = 0,\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0,\n$$\nwhere $\\rho_0$ is a constant reference density, $f$ is the Coriolis parameter, and $N$ is the buoyancy frequency. We consider two-dimensional perturbations varying in the across-front horizontal coordinate $y$ and vertical coordinate $z$, and invariant in the along-front coordinate. The plane-wave ansatz for each field is\n$$\n\\left\\{v,w,b,p'\\right\\} \\propto \\exp\\left(i k y + i m z - i \\omega t\\right),\n$$\nwhere $k$ is the horizontal wavenumber, $m$ is the vertical wavenumber, and $\\omega$ is the angular frequency. Substituting the plane-wave forms into the linear equations and eliminating the pressure using incompressibility yields the standard inertia–gravity wave dispersion relation in a rotating, stratified, incompressible fluid:\n$$\n\\omega_{\\mathrm{nh}}^2(N,f,k,m) = \\frac{N^2 k^2 + f^2 m^2}{k^2 + m^2}.\n$$\nThis result can be obtained by combining the horizontal and vertical momentum equations with the buoyancy equation, using the divergence-free condition to relate the velocity components.\n\nUnder the hydrostatic assumption, we neglect the vertical acceleration term in the vertical momentum equation. In linear form, the vertical momentum reduces to\n$$\n0 = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial z} + b,\n$$\nwhich enforces hydrostatic balance between the vertical pressure gradient and buoyancy. Proceeding with the same plane-wave elimination and retaining the leading-order terms in the aspect ratio regime $m^2 \\gg k^2$ yields the hydrostatic approximation to the dispersion relation:\n$$\n\\omega_{\\mathrm{h}}^2(N,f,k,m) = f^2 + N^2 \\frac{k^2}{m^2}.\n$$\nThis asymptotic form demonstrates that the hydrostatic approximation recovers the correct dependence when vertical scales are much shorter than horizontal scales, suppressing nonhydrostatic vertical inertia.\n\nTo link these dispersions to a measurable quantity for secondary circulation, we consider a harmonic frontogenesis forcing at angular frequency $\\omega_f$ that drives a forced response in the vertical velocity of a given $(k,m)$ mode. Modeling the vertical-velocity amplitude as a linear oscillator forced at $\\omega_f$, the steady-state amplitudes for the nonhydrostatic and hydrostatic models are\n$$\nA_{\\mathrm{nh}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{nh}}^2 - \\omega_f^2\\right|}, \\quad\nA_{\\mathrm{h}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{h}}^2 - \\omega_f^2\\right|},\n$$\nwhere $F_0$ is the forcing amplitude with units $\\mathrm{m}/\\mathrm{s}^2$. The relative hydrostatic error in predicting the amplitude is\n$$\nE = \\frac{\\left|A_{\\mathrm{h}} - A_{\\mathrm{nh}}\\right|}{\\left|A_{\\mathrm{nh}}\\right|}.\n$$\nSince $F_0$ appears linearly in both amplitudes, it cancels in $E$, making $E$ dimensionless.\n\nAlgorithmic design for computation proceeds as follows:\n- For each test case, compute the wavenumbers $k = 2\\pi/L$ and $m = n\\pi/H$ from the provided $L$, $H$, and mode index $n$.\n- Compute the nonhydrostatic dispersion $\\omega_{\\mathrm{nh}}^2$ using\n$$\n\\omega_{\\mathrm{nh}}^2 = \\frac{N^2 k^2 + f^2 m^2}{k^2 + m^2}.\n$$\n- Compute the hydrostatic dispersion $\\omega_{\\mathrm{h}}^2$ using\n$$\n\\omega_{\\mathrm{h}}^2 = f^2 + N^2 \\frac{k^2}{m^2}.\n$$\n- Given $\\omega_f$, compute $A_{\\mathrm{nh}}$ and $A_{\\mathrm{h}}$ via\n$$\nA_{\\mathrm{nh}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{nh}}^2 - \\omega_f^2\\right|}, \\quad\nA_{\\mathrm{h}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{h}}^2 - \\omega_f^2\\right|}.\n$$\n- Compute $E$ using\n$$\nE = \\frac{\\left|A_{\\mathrm{h}} - A_{\\mathrm{nh}}\\right|}{\\left|A_{\\mathrm{nh}}\\right|}.\n$$\n\nNumerical considerations:\n- Avoid division by zero by ensuring $\\omega_f \\neq \\omega_{\\mathrm{nh}}$ and $\\omega_f \\neq \\omega_{\\mathrm{h}}$; the provided test suite is chosen to avoid exact resonance.\n- All inputs are in SI units, wavenumbers are radians per meter, and frequencies are in radians per second (here, $\\mathrm{s}^{-1}$).\n- The final reported errors $E$ are dimensionless floats rounded to six decimal places.\n\nThe program implements these steps for the four test cases specified, and outputs the list of errors in the required single-line format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef dispersion_nonhydrostatic(N, f, k, m):\n    # Exact nonhydrostatic dispersion relation for rotating, stratified Boussinesq IGWs\n    k2 = k * k\n    m2 = m * m\n    return (N * N * k2 + f * f * m2) / (k2 + m2)\n\ndef dispersion_hydrostatic(N, f, k, m):\n    # Hydrostatic approximation valid when m^2  k^2\n    k2 = k * k\n    m2 = m * m\n    return f * f + N * N * (k2 / m2)\n\ndef vertical_velocity_amplitude(F0, omega2, omegaf):\n    # Amplitude of response of a linear oscillator forced at omega_f\n    denom = abs(omega2 - omegaf * omegaf)\n    # Small epsilon guard not necessary for chosen test cases, but include for safety\n    eps = 1e-20\n    denom = denom if denom  eps else eps\n    return F0 / denom\n\ndef relative_error(N, f, L, H, n, omegaf, F0):\n    # Compute k and m for the mode\n    k = 2.0 * np.pi / L\n    m = n * np.pi / H\n\n    # Dispersions\n    omega2_nh = dispersion_nonhydrostatic(N, f, k, m)\n    omega2_h = dispersion_hydrostatic(N, f, k, m)\n\n    # Amplitudes\n    A_nh = vertical_velocity_amplitude(F0, omega2_nh, omegaf)\n    A_h = vertical_velocity_amplitude(F0, omega2_h, omegaf)\n\n    # Relative error\n    E = abs(A_h - A_nh) / abs(A_nh)\n    return E\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (N [1/s], f [1/s], L [m], H [m], n [int], omega_f [1/s], F0 [m/s^2])\n    test_cases = [\n        (1.0e-2, 1.0e-4, 5000.0, 50.0, 1, 1.0e-5, 1.0),\n        (1.0e-2, 1.0e-4, 300.0, 150.0, 1, 2.0e-4, 1.0),\n        (1.0e-2, 1.0e-4, 50.0, 500.0, 1, 1.0e-5, 1.0),\n        (2.0e-3, 1.0e-4, 1000.0, 30.0, 1, 1.2e-4, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, f, L, H, n, omega_f, F0 = case\n        E = relative_error(N, f, L, H, n, omega_f, F0)\n        results.append(E)\n\n    # Round to six decimal places as specified\n    formatted = [f\"{x:.6f}\" for x in results]\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having established the conditions that necessitate a nonhydrostatic approach, the next step is to design a valid numerical simulation. This practice provides a systematic procedure for determining the appropriate grid resolution and time step for a nonhydrostatic model of a sharp front . By linking physical parameters like the Froude number and frontal width to grid spacing, and applying the Courant–Friedrichs–Lewy (CFL) condition to determine a stable time step, you will learn how to construct a robust model setup grounded in first principles.",
            "id": "3801124",
            "problem": "You are asked to construct a principled nonhydrostatic numerical model setup for a sharp surface-intensified front in a stably stratified oceanic mixed layer. Your task is to determine, from first principles, appropriate horizontal grid resolution, vertical discretization, and a stable explicit time step for an advection–internal-wave resolving, incompressible, Boussinesq, nonhydrostatic solver. The derivation must start from the incompressible Boussinesq momentum and continuity equations, the definition of the Froude number, and well-tested stability constraints based on the Courant–Friedrichs–Lewy (CFL) condition. You must provide a quantitative procedure that uses the Froude number to justify resolution choices and uses CFL constraints to select the maximum stable time step. All results must be expressed using physically consistent scalings and must be defensible by reference to the underlying equations and linear internal-wave theory in uniformly stratified fluid.\n\nThe fundamental base you must use includes:\n- The incompressible Boussinesq momentum equations with nonhydrostatic pressure, where the acceleration, Coriolis force, pressure gradient, and buoyancy enter the dynamics.\n- The continuity equation for incompressible flow, and the tracer equation for buoyancy under advection and diffusion.\n- The definition of the Froude number $Fr$ as the ratio of advective time scale to stratification time scale based on mixed-layer depth and characteristic horizontal speed, namely $Fr$ comparing $U$ against $N H$.\n- The existence of linear internal gravity wave modes in uniformly stratified fluid of depth $H$ and their characteristic modal speeds, used to constrain explicit time stepping for wave-resolving models.\n- The Courant–Friedrichs–Lewy (CFL) condition for explicit schemes constraining the time step by advective and wave propagation speeds.\n\nYour program must implement the following overall tasks for each test case:\n1. Compute the Froude number $Fr$ using the provided characteristic speed $U$, buoyancy frequency $N$, and mixed layer depth $H$.\n2. Choose a horizontal grid spacing that resolves the frontal width and a stratification-controlled advective length scale derived from fundamental balances, without relying on hydrodynamic shortcuts. The resolution must be justified by the requirement to represent sharp horizontal gradients and ageostrophic motions that are significant when $Fr$ is not asymptotically small.\n3. Choose a vertical grid spacing that resolves the first baroclinic mode structure of internal gravity waves in a uniformly stratified layer of depth $H$ sufficiently to minimize numerical dispersion and resolve vertical shear associated with the frontal dynamics.\n4. Compute the maximum stable explicit time step constrained by both horizontal and vertical advection CFL conditions and by internal gravity wave propagation in the horizontal.\n5. Return, for each test case, a compact summary containing the computed $Fr$, the recommended horizontal grid spacing, the recommended vertical grid spacing, the maximum stable time step, and booleans indicating that the selected time step satisfies the advective and gravity-wave CFL constraints.\n\nPhysical units and format requirements:\n- Express all lengths in meters and all times in seconds.\n- Express all angles, if any arise, in radians, but no angles are required in this task.\n- Express dimensionless quantities as plain decimals.\n- Round all floating-point outputs to six decimal places.\n- Booleans must be literal `True` or `False`.\n\nTest suite:\nFor coverage of different dynamical regimes and constraints, apply your derivation and algorithm to the following parameter sets, each describing a surface-intensified front in a uniformly stratified mixed layer:\n\n- Case A (general submesoscale front):\n  - Characteristic horizontal speed $U = 0.50 \\,\\mathrm{m\\,s^{-1}}$\n  - Characteristic vertical speed $W = 0.010 \\,\\mathrm{m\\,s^{-1}}$\n  - Buoyancy frequency $N = 1.0\\times 10^{-2} \\,\\mathrm{s^{-1}}$\n  - Mixed layer depth $H = 100 \\,\\mathrm{m}$\n  - Coriolis parameter $f = 1.0\\times 10^{-4} \\,\\mathrm{s^{-1}}$\n  - Frontal width (density gradient scale) $L_f = 2000 \\,\\mathrm{m}$\n  - Allowed Courant number $C = 0.50$\n\n- Case B (narrow, weaker front):\n  - $U = 0.20 \\,\\mathrm{m\\,s^{-1}}$, $W = 0.005 \\,\\mathrm{m\\,s^{-1}}$, $N = 5.0\\times 10^{-3} \\,\\mathrm{s^{-1}}$, $H = 50 \\,\\mathrm{m}$, $f = 1.0\\times 10^{-4} \\,\\mathrm{s^{-1}}$, $L_f = 500 \\,\\mathrm{m}$, $C = 0.70$\n\n- Case C (very sharp front with strong stratification):\n  - $U = 0.60 \\,\\mathrm{m\\,s^{-1}}$, $W = 0.030 \\,\\mathrm{m\\,s^{-1}}$, $N = 1.5\\times 10^{-2} \\,\\mathrm{s^{-1}}$, $H = 30 \\,\\mathrm{m}$, $f = 8.0\\times 10^{-5} \\,\\mathrm{s^{-1}}$, $L_f = 200 \\,\\mathrm{m}$, $C = 0.40$\n\nFor resolution sufficiency targets, use the following minimum discretization criteria that must be encoded in your algorithm and justified in your solution:\n- At least $n_f = 10$ grid points across the frontal width $L_f$ in the horizontal.\n- At least $n_b = 6$ grid points across the stratification-controlled advective length scale that is set by $U$ and $N$.\n- At least $s_z = 20$ vertical grid points resolving the depth $H$ to represent the first baroclinic mode shape and vertical shear.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list in the form:\n$[Fr,\\;dx,\\;dz,\\;dt,\\;\\text{advective\\_CFL\\_ok},\\;\\text{gravitywave\\_CFL\\_ok}]$\nAll floating-point values must be rounded to six decimal places. For example, the final printed line must look like:\n`[[Fr_A,dx_A,dz_A,dt_A,advective_A,gravity_A],[Fr_B,dx_B,dz_B,dt_B,advective_B,gravity_B],[Fr_C,dx_C,dz_C,dt_C,advective_C,gravity_C]]`",
            "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of geophysical fluid dynamics, well-posed with a complete and consistent set of parameters, and objective in its formulation. The task is to derive and implement a quantitative procedure for establishing a numerical model configuration for simulating an oceanic front. This involves determining grid resolutions and a stable time step from first principles.\n\nThe analysis begins with the incompressible Boussinesq equations, which govern the motion of a stratified fluid where density variations are small except in their contribution to the buoyancy force. In a rotating reference frame, the momentum equation is:\n$$\n\\frac{D\\mathbf{u}}{Dt} + f \\mathbf{k} \\times \\mathbf{u} = -\\frac{1}{\\rho_0} \\nabla p' + b \\mathbf{k}\n$$\nwhere $\\mathbf{u} = (u, v, w)$ is the velocity vector, $f$ is the Coriolis parameter, $\\mathbf{k}$ is the vertical unit vector, $\\rho_0$ is a constant reference density, $p'$ is the nonhydrostatic pressure perturbation, and $b = -g(\\rho - \\rho_0)/\\rho_0$ is the buoyancy. The material derivative is $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$. The system is closed by the continuity equation for incompressible flow, $\\nabla \\cdot \\mathbf{u} = 0$, and a conservation equation for buoyancy, $\\frac{Db}{Dt} = 0$, neglecting explicit diffusion for scaling purposes. The background stratification is quantified by the buoyancy frequency $N$, defined by $N^2 = \\frac{\\partial b}{\\partial z}$ for a background state in hydrostatic balance.\n\nThe procedure to determine the numerical parameters is as follows:\n\n**1. Froude Number Computation**\n\nThe internal Froude number, $Fr$, compares the characteristic horizontal velocity $U$ to the speed of long internal gravity waves, which scales with $NH$. This dimensionless number indicates the importance of stratification in resisting vertical motion induced by the flow. It is defined as:\n$$\nFr = \\frac{U}{NH}\n$$\nwhere $U$ is the characteristic horizontal speed, $N$ is the buoyancy frequency, and $H$ is the mixed-layer depth. A Froude number of order unity or greater suggests that the flow is energetic enough to overcome the restoring force of stratification, leading to significant ageostrophic motions and potential for mixing.\n\n**2. Horizontal Grid Spacing ($\\Delta x$)**\n\nThe horizontal resolution must be fine enough to resolve the key physical processes and gradients. The problem specifies two critical length scales to resolve.\n\nFirst, the frontal zone itself, characterized by a density gradient scale length $L_f$, must be well-represented. To capture the structure of the front, we require at least $n_f = 10$ grid points across this width. This imposes a constraint on the grid spacing $\\Delta x$:\n$$\n\\Delta x \\le \\frac{L_f}{n_f} = \\frac{L_f}{10}\n$$\n\nSecond, for flows with a non-negligible Froude number, ageostrophic dynamics become important. A fundamental length scale arises from balancing horizontal advection with the restoring force of stratification. The time scale for stratification to act is the inverse of the buoyancy frequency, $T_N = 1/N$. In this time, a fluid parcel moving at speed $U$ travels a horizontal distance $L_b = U/N$. This \"stratification-controlled advective length scale\" must also be resolved to accurately capture processes like frontogenesis and vertical circulation. The problem requires at least $n_b = 6$ grid points across this scale, leading to the constraint:\n$$\n\\Delta x \\le \\frac{L_b}{n_b} = \\frac{U}{6N}\n$$\n\nTo satisfy both criteria simultaneously, the horizontal grid spacing $\\Delta x$ must be chosen as the minimum of the two upper bounds:\n$$\n\\Delta x = \\min\\left(\\frac{L_f}{10}, \\frac{U}{6N}\\right)\n$$\n\nThe Coriolis parameter $f$ defines the internal Rossby radius of deformation, $L_R = NH/f$, which sets the scale for geostrophic balance. The provided cases describe submesoscale fronts where $L_f  L_R$ and the Rossby number $Ro = U/(fL_f)$ is of order unity or larger, justifying the focus on ageostrophic scales ($L_b$) rather than geostrophic scales ($L_R$) for determining resolution.\n\n**3. Vertical Grid Spacing ($\\Delta z$)**\n\nThe vertical grid spacing must resolve the vertical structure of the flow and internal waves. In a uniformly stratified layer of depth $H$, the gravest ($m=1$) baroclinic mode of internal waves has a vertical structure proportional to $\\sin(\\pi z / H)$. Adequate resolution of this half-sine wave structure is critical for minimizing numerical dispersion and accurately representing vertical shear. The problem mandates a minimum of $s_z = 20$ grid points over the depth $H$, which leads to a straightforward definition for the vertical grid spacing $\\Delta z$:\n$$\n\\Delta z = \\frac{H}{s_z} = \\frac{H}{20}\n$$\n\n**4. Maximum Stable Time Step ($\\Delta t$)**\n\nFor an explicit time-stepping scheme, the time step $\\Delta t$ is limited by the Courant–Friedrichs–Lewy (CFL) condition, which ensures that information does not propagate across more than one grid cell in a single time step. We must consider all relevant propagation speeds: advection and internal gravity waves. The general condition is $\\Delta t \\le C \\cdot (\\text{characteristic time})$, where $C$ is the Courant number.\n\na. **Advective Constraint:** The flow advects tracers and momentum at speeds $U$ and $W$ in the horizontal and vertical directions, respectively. This gives two constraints:\n   - Horizontal advection: $\\Delta t_{adv,x} \\le C \\frac{\\Delta x}{U}$\n   - Vertical advection: $\\Delta t_{adv,z} \\le C \\frac{\\Delta z}{W}$\n\nb. **Internal Gravity Wave Constraint:** A nonhydrostatic model resolves the full spectrum of internal gravity waves. The fastest propagating signal sets the most stringent stability limit. In a uniformly stratified fluid of depth $H$, the maximum speed of internal gravity waves corresponds to the phase speed of the first baroclinic mode ($m=1$) in the long-wavelength limit ($k_h \\to 0$). This speed is given by:\n$$\nc_{gw,max} = \\frac{NH}{\\pi}\n$$\nThe corresponding CFL constraint on the horizontal grid is:\n$$\n\\Delta t_{gw} \\le C \\frac{\\Delta x}{c_{gw,max}} = C \\frac{\\pi \\Delta x}{NH}\n$$\n\nThe final, globally stable time step $\\Delta t$ must be the minimum of all these constraints to ensure numerical stability with respect to all resolved processes:\n$$\n\\Delta t = \\min\\left( C \\frac{\\Delta x}{U}, C \\frac{\\Delta z}{W}, C \\frac{\\pi \\Delta x}{NH} \\right)\n$$\n\n**5. Verification Booleans**\n\nThe final required outputs are two boolean flags, `advective_CFL_ok` and `gravitywave_CFL_ok`. These flags are to confirm that the computed time step $\\Delta t$ satisfies the respective stability conditions. By defining $\\Delta t$ as the minimum of all constraining time scales, it is guaranteed by construction that both conditions are met. Thus, both booleans will evaluate to `True`. They serve as a logical self-consistency check on the calculation.\n\nThis principled procedure yields a complete set of numerical parameters ($Fr, \\Delta x, \\Delta z, \\Delta t$) for each test case, derived directly from the fundamental physics of stratified flows and standard numerical stability theory.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical model parameters for simulating oceanic fronts based on\n    physical principles and stability constraints.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (general submesoscale front)\n        {'U': 0.50, 'W': 0.010, 'N': 1.0e-2, 'H': 100.0, 'f': 1.0e-4, 'L_f': 2000.0, 'C': 0.50, 'n_f': 10, 'n_b': 6, 's_z': 20},\n        # Case B (narrow, weaker front)\n        {'U': 0.20, 'W': 0.005, 'N': 5.0e-3, 'H': 50.0, 'f': 1.0e-4, 'L_f': 500.0, 'C': 0.70, 'n_f': 10, 'n_b': 6, 's_z': 20},\n        # Case C (very sharp front with strong stratification)\n        {'U': 0.60, 'W': 0.030, 'N': 1.5e-2, 'H': 30.0, 'f': 8.0e-5, 'L_f': 200.0, 'C': 0.40, 'n_f': 10, 'n_b': 6, 's_z': 20},\n    ]\n\n    results = []\n    for case in test_cases:\n        U = case['U']\n        W = case['W']\n        N = case['N']\n        H = case['H']\n        L_f = case['L_f']\n        C = case['C']\n        n_f = case['n_f']\n        n_b = case['n_b']\n        s_z = case['s_z']\n\n        # 1. Compute the Froude number Fr\n        # Fr = U / (N * H)\n        fr = U / (N * H)\n\n        # 2. Choose horizontal grid spacing dx\n        # Constraint from frontal width Lf\n        dx_f = L_f / n_f\n        # Constraint from stratification-controlled advective length scale U/N\n        dx_b = U / (n_b * N)\n        # Choose the more restrictive (smaller) grid spacing\n        dx = min(dx_f, dx_b)\n\n        # 3. Choose vertical grid spacing dz\n        # Constraint from resolving the first baroclinic mode structure\n        dz = H / s_z\n\n        # 4. Compute maximum stable explicit time step dt\n        # Constraint from horizontal advection\n        dt_adv_x = C * dx / U\n        # Constraint from vertical advection\n        dt_adv_z = C * dz / W\n        \n        # Aggregate advective constraint limit\n        dt_adv_limit = min(dt_adv_x, dt_adv_z)\n        \n        # Constraint from internal gravity wave propagation\n        # Max wave speed c_gw_max = N * H / pi\n        c_gw_max = (N * H) / np.pi\n        dt_gw_limit = C * dx / c_gw_max\n        \n        # Final time step is the minimum of all constraints\n        dt = min(dt_adv_limit, dt_gw_limit)\n        \n        # 5. Check if the final dt satisfies the constraints\n        # These will be True by construction, serving as a check.\n        advective_cfl_ok = (dt = dt_adv_limit)\n        gravitywave_cfl_ok = (dt = dt_gw_limit)\n\n        # Round all floating point outputs to six decimal places\n        current_result = [\n            round(fr, 6),\n            round(dx, 6),\n            round(dz, 6),\n            round(dt, 6),\n            advective_cfl_ok,\n            gravitywave_cfl_ok\n        ]\n        results.append(current_result)\n\n    # Format the final output string as a list of lists representation\n    # The default str() for a list includes spaces, which is consistent\n    # with the provided `print` statement template.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}