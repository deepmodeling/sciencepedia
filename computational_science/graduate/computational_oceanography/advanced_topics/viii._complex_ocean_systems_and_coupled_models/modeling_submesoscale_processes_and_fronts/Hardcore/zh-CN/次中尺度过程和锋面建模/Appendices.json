{
    "hands_on_practices": [
        {
            "introduction": "锋生过程是海洋中形成锋利梯度（如温度或密度）的关键机制。本练习从第一性原理出发，推导锋生函数，旨在揭示驱动梯度增强的运动学原理。通过分析，您将定量地理解流场中的应变部分如何拉伸和压缩梯度，而旋转部分则不直接贡献于锋生，从而为更复杂的数值模拟奠定坚实的物理基础。",
            "id": "3801116",
            "problem": "考虑海洋中一个水平二维、无粘、绝热且不可压缩的亚中尺度流。设水平速度场在空间上是局地线性的，因此其在某一点的水平梯度张量为常数矩阵 $\\nabla_{h} \\mathbf{u}_{h} = \\mathbf{A} \\in \\mathbb{R}^{2 \\times 2}$。局地水平温度场也视为线性的，$T(x,y) = T_{0} + \\alpha x + \\beta y$，其水平梯度为常数 $\\nabla_{h} T = (\\alpha, \\beta)^{\\top}$。在此，锋生函数定义为水平温度梯度大小的物质导数，$F = \\frac{D}{Dt} \\left| \\nabla_{h} T \\right|$。\n\n仅使用温度的标量平流方程 $\\frac{D T}{D t} = 0$、物质导数的定义以及将矩阵分解为其对称（应变率）和反对称（旋转率）部分的方法，推导出一个用对称应变率张量 $\\mathbf{S} = \\frac{1}{2} \\left( \\mathbf{A} + \\mathbf{A}^{\\top} \\right)$ 和水平温度梯度 $\\nabla_{h} T$ 表示的 $F$ 的精确表达式。清晰地陈述所有使用的假设。\n\n然后，在一个点上计算你的表达式的值，该点的速度梯度张量为\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\na  b - \\omega \\\\\nb + \\omega  -a\n\\end{pmatrix},\n$$\n其中 $a = 3.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$，$b = 2.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$，以及 $\\omega = 5.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$，且水平温度梯度由 $\\alpha = 2.0 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ 和 $\\beta = 1.5 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ 给出。\n\n将 $F$ 的最终数值以 $\\mathrm{K} \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$ 为单位表示，并将答案四舍五入到三位有效数字。",
            "solution": "该问题经核实具有科学依据，提法得当且客观。这是一个关于锋生过程的地球物理流体动力学标准问题。所有必要信息均已提供，给定的物理参数一致且符合实际。因此，我们可以开始求解。\n\n问题文本中陈述或隐含的关键假设是：\n1.  流动是水平二维、无粘、绝热且不可压缩的。二维流的不可压缩条件 $\\nabla_{h} \\cdot \\mathbf{u}_{h} = 0$ 意味着速度梯度张量 $\\mathbf{A}$ 的迹必须为零，这与给定的矩阵结构相符。\n2.  绝热条件意味着温度 $T$ 跟随流体质点守恒，这表示为物质导数为零：$\\frac{DT}{Dt} = 0$。\n3.  水平速度场 $\\mathbf{u}_{h}$ 和温度场 $T$ 在水平坐标 $(x,y)$ 上是局地线性的。这意味着它们各自的梯度 $\\nabla_{h} \\mathbf{u}_{h} = \\mathbf{A}$ 和 $\\nabla_{h} T = \\mathbf{g}$ 在所关注的局地区域内是常数。\n4.  温度梯度的大小不为零，即 $|\\nabla_h T| \\neq 0$。\n\n锋生函数 $F$ 定义为水平温度梯度向量 $\\mathbf{g} = \\nabla_h T$ 大小的物质导数。我们用 $G = |\\mathbf{g}| = |\\nabla_h T|$ 表示其大小。\n$$\nF = \\frac{D G}{D t} = \\frac{D}{D t} |\\nabla_{h} T|\n$$\n我们可以将大小的平方表示为 $G^2 = \\mathbf{g} \\cdot \\mathbf{g} = g_i g_i$。对 $G^2$ 求物质导数：\n$$\n\\frac{D}{Dt}(G^2) = \\frac{D}{Dt}(\\mathbf{g} \\cdot \\mathbf{g}) = \\frac{D\\mathbf{g}}{Dt} \\cdot \\mathbf{g} + \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt} = 2 \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt}\n$$\n另外，根据链式法则，$\\frac{D}{Dt}(G^2) = 2G \\frac{DG}{Dt} = 2G F$。\n令两个表达式相等，得到：\n$$\n2G F = 2 \\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt} \\implies F = \\frac{1}{G} \\left(\\mathbf{g} \\cdot \\frac{D\\mathbf{g}}{Dt}\\right) = \\frac{\\mathbf{g}}{|\\mathbf{g}|^2} \\cdot \\frac{D\\mathbf{g}}{Dt}\n$$\n下一步是找到 $\\frac{D\\mathbf{g}}{Dt} = \\frac{D(\\nabla_h T)}{Dt}$ 的表达式。我们使用物质导数和梯度算符的标准交换恒等式：\n$$\n\\frac{D}{Dt}(\\nabla_h T) = \\nabla_h \\left(\\frac{DT}{Dt}\\right) - (\\nabla_h \\mathbf{u}_h)^{\\top} (\\nabla_h T)\n$$\n根据绝热假设，$\\frac{DT}{Dt} = 0$，所以 $\\nabla_h(\\frac{DT}{Dt}) = 0$。该表达式简化为：\n$$\n\\frac{D\\mathbf{g}}{Dt} = -(\\nabla_h \\mathbf{u}_h)^{\\top} \\mathbf{g}\n$$\n使用问题中的记法 $\\nabla_h \\mathbf{u}_h = \\mathbf{A}$，我们有：\n$$\n\\frac{D\\mathbf{g}}{Dt} = -\\mathbf{A}^{\\top} \\mathbf{g}\n$$\n将其代回 $F$ 的表达式中：\n$$\nF = \\frac{1}{|\\mathbf{g}|} (\\mathbf{g} \\cdot (-\\mathbf{A}^{\\top} \\mathbf{g}))\n$$\n这个点积可以用转置记法写成二次型：$\\mathbf{x} \\cdot (\\mathbf{M} \\mathbf{y}) = \\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{y}$。所以，\n$$\nF = -\\frac{\\mathbf{g}^{\\top} \\mathbf{A}^{\\top} \\mathbf{g}}{|\\mathbf{g}|}\n$$\n问题要求用对称应变率张量 $\\mathbf{S}$ 来表示表达式。我们将速度梯度张量 $\\mathbf{A}$ 分解为其对称部分 $\\mathbf{S}$ 和反对称部分 $\\mathbf{\\Omega}$（旋转率张量）：\n$$\n\\mathbf{A} = \\mathbf{S} + \\mathbf{\\Omega}, \\quad \\text{where} \\quad \\mathbf{S} = \\frac{1}{2}(\\mathbf{A} + \\mathbf{A}^{\\top}) \\quad \\text{and} \\quad \\mathbf{\\Omega} = \\frac{1}{2}(\\mathbf{A} - \\mathbf{A}^{\\top})\n$$\n对 $\\mathbf{A}$ 取转置得到 $\\mathbf{A}^{\\top} = \\mathbf{S}^{\\top} + \\mathbf{\\Omega}^{\\top}$。根据定义，$\\mathbf{S}$ 是对称的（$\\mathbf{S}^{\\top} = \\mathbf{S}$），$\\mathbf{\\Omega}$ 是反对称的（$\\mathbf{\\Omega}^{\\top} = -\\mathbf{\\Omega}$）。因此，$\\mathbf{A}^{\\top} = \\mathbf{S} - \\mathbf{\\Omega}$。\n将此代入 $F$ 的表达式中：\n$$\nF = -\\frac{\\mathbf{g}^{\\top} (\\mathbf{S} - \\mathbf{\\Omega}) \\mathbf{g}}{|\\mathbf{g}|} = -\\frac{\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g} - \\mathbf{g}^{\\top} \\mathbf{\\Omega} \\mathbf{g}}{|\\mathbf{g}|}\n$$\n对于任意向量 $\\mathbf{x}$ 和任意反对称矩阵 $\\mathbf{M}$，二次型 $\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x}$ 恒为零。这是因为 $(\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x})^{\\top} = \\mathbf{x}^{\\top} \\mathbf{M}^{\\top} \\mathbf{x} = \\mathbf{x}^{\\top} (-\\mathbf{M}) \\mathbf{x} = -(\\mathbf{x}^{\\top} \\mathbf{M} \\mathbf{x})$。因为该量是一个标量，且等于其自身的负数，所以它必须为零。因此，$\\mathbf{g}^{\\top} \\mathbf{\\Omega} \\mathbf{g} = 0$。\n\n用应变率张量和温度梯度表示的锋生函数的最终表达式为：\n$$\nF = -\\frac{\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g}}{|\\mathbf{g}|} = -\\frac{(\\nabla_{h} T)^{\\top} \\mathbf{S} (\\nabla_{h} T)}{|\\nabla_{h} T|}\n$$\n这个结果表明，锋生是由应变场驱动的，而不是由流动的旋转部分驱动的。\n\n现在，我们根据给定的参数计算这个表达式的值。速度梯度张量为：\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\na  b - \\omega \\\\\nb + \\omega  -a\n\\end{pmatrix}\n$$\n对称应变率张量 $\\mathbf{S}$ 为：\n$$\n\\mathbf{S} = \\frac{1}{2}(\\mathbf{A} + \\mathbf{A}^{\\top}) = \\frac{1}{2} \\left( \\begin{pmatrix} a  b - \\omega \\\\ b + \\omega  -a \\end{pmatrix} + \\begin{pmatrix} a  b + \\omega \\\\ b - \\omega  -a \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 2a  2b \\\\ 2b  -2a \\end{pmatrix} = \\begin{pmatrix} a  b \\\\ b  -a \\end{pmatrix}\n$$\n水平温度梯度为 $\\mathbf{g} = (\\alpha, \\beta)^{\\top}$。$F$ 的分子中的二次型为：\n$$\n\\mathbf{g}^{\\top} \\mathbf{S} \\mathbf{g} = \\begin{pmatrix} \\alpha  \\beta \\end{pmatrix} \\begin{pmatrix} a  b \\\\ b  -a \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\begin{pmatrix} a\\alpha + b\\beta  b\\alpha - a\\beta \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = a\\alpha^2 + b\\alpha\\beta + b\\alpha\\beta - a\\beta^2 = a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta\n$$\n梯度的大小为 $|\\mathbf{g}| = \\sqrt{\\alpha^2 + \\beta^2}$。\n所以，$F$ 的具体表达式为：\n$$\nF = - \\frac{a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta}{\\sqrt{\\alpha^2 + \\beta^2}}\n$$\n给定的值为：\n$a = 3.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$\n$b = 2.0 \\times 10^{-5} \\ \\mathrm{s}^{-1}$\n$\\alpha = 2.0 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$\n$\\beta = 1.5 \\times 10^{-4} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$\n（请注意，不需要 $\\omega$ 的值，因为旋转对锋生没有贡献。）\n\n我们来计算各项：\n$\\alpha^2 = (2.0 \\times 10^{-4})^2 = 4.0 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\beta^2 = (1.5 \\times 10^{-4})^2 = 2.25 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\alpha^2 - \\beta^2 = (4.0 - 2.25) \\times 10^{-8} = 1.75 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n$\\alpha\\beta = (2.0 \\times 10^{-4})(1.5 \\times 10^{-4}) = 3.0 \\times 10^{-8} \\ \\mathrm{K}^2 \\mathrm{m}^{-2}$\n\n分子项为：\n$a(\\alpha^2 - \\beta^2) + 2b\\alpha\\beta = (3.0 \\times 10^{-5})(1.75 \\times 10^{-8}) + 2(2.0 \\times 10^{-5})(3.0 \\times 10^{-8})$\n$= 5.25 \\times 10^{-13} + 12.0 \\times 10^{-13} = 17.25 \\times 10^{-13} \\ \\mathrm{K}^2 \\mathrm{m}^{-2} \\mathrm{s}^{-1}$\n\n分母项为：\n$\\sqrt{\\alpha^2 + \\beta^2} = \\sqrt{4.0 \\times 10^{-8} + 2.25 \\times 10^{-8}} = \\sqrt{6.25 \\times 10^{-8}} = 2.5 \\times 10^{-4} \\ \\mathrm{K} \\mathrm{m}^{-1}$\n\n最后，我们计算 $F$：\n$$\nF = - \\frac{17.25 \\times 10^{-13} \\ \\mathrm{K}^2 \\mathrm{m}^{-2} \\mathrm{s}^{-1}}{2.5 \\times 10^{-4} \\ \\mathrm{K} \\mathrm{m}^{-1}} = -6.9 \\times 10^{-9} \\ \\mathrm{K} \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}\n$$\n问题要求将答案四舍五入到三位有效数字。精确答案是 $-6.9 \\times 10^{-9}$。用三位有效数字表示，即为 $-6.90 \\times 10^{-9}$。",
            "answer": "$$\n\\boxed{-6.90 \\times 10^{-9}}\n$$"
        },
        {
            "introduction": "在模拟亚中尺度过程时，一个核心的建模决策是在计算成本较低的静水近似和更精确的非静水方程之间进行选择。本练习通过分析惯性重力波的色散关系，量化静水近似在不同动力学条件下引入的误差。这项实践使您能够根据锋面的物理特征（如长宽比），明智地判断何时必须采用非静水模型以确保模拟结果的准确性。",
            "id": "3801142",
            "problem": "考虑一个旋转、分层、不可压缩的海洋混合层，其中一个侧向密度锋在跨锋和垂直方向上诱导出一个次级环流。使用 Boussinesq 近似，在一个具有恒定浮力频率 $N$ 和科里奥利参数 $f$ 的 $f$ 平面上，对此类小振幅扰动的局部动力学进行建模。假设扰动场在跨锋坐标 $y$ 和垂直坐标 $z$ 上是二维的，并且沿锋向是均匀不变的。假设次级环流可以表示为由水平波数 $k$ (单位: $\\mathrm{rad}/\\mathrm{m}$) 和垂直波数 $m$ (单位: $\\mathrm{rad}/\\mathrm{m}$) 表征的小振幅平面波模态的叠加，并且背景层结是恒定的。\n\n从线性化的 Boussinesq 方程和不可压缩条件出发，完成以下任务：\n\n1. 对扰动速度和浮力使用形式为 $\\exp\\left(i k y + i m z - i \\omega t\\right)$ 的平面波拟设，推导在旋转、分层、不可压缩极限下惯性重力波的精确非静力色散关系 $\\omega = \\omega_{\\mathrm{nh}}(N,f,k,m)$。\n\n2. 通过在垂直动量方程中忽略垂直加速度来施加静力假设，并推导相应的静力色散关系 $\\omega = \\omega_{\\mathrm{h}}(N,f,k,m)$，该关系在 $m^2 \\gg k^2$ 的范围内有效。\n\n3. 考虑一个以角频率 $\\omega_f$ (单位: $\\mathrm{s}^{-1}$) 驱动次级环流的周期性锋生强迫。对于受到振幅为 $F_0$ (单位: $\\mathrm{m}/\\mathrm{s}^2$) 的谐波强迫的单个平面波模态 $(k,m)$，将垂直速度振幅 $A$ 建模为受迫线性振子的稳态振幅，其中自然频率由相应的色散关系给出。具体地，将非静力振幅和静力振幅定义为\n$$\nA_{\\mathrm{nh}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{nh}}^2 - \\omega_f^2\\right|}, \\quad\nA_{\\mathrm{h}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{h}}^2 - \\omega_f^2\\right|}.\n$$\n这种构造旨在在模态层面上量化所模拟的次级环流对静力假设的敏感性。\n\n4. 对于给定的模态和强迫，将相对静力误差 $E$ 定义为\n$$\nE = \\frac{\\left|A_{\\mathrm{h}} - A_{\\mathrm{nh}}\\right|}{\\left|A_{\\mathrm{nh}}\\right|},\n$$\n这是一个无量纲量。\n\n你的任务是实现一个程序，对下面的每个测试用例，计算相对静力误差 $E$，结果为浮点数，四舍五入到六位小数。请使用以下科学上真实的测试套件，其中 $k = 2\\pi/L$，$m = n\\pi/H$，$L$ 是跨锋波长（单位：$\\mathrm{m}$），$H$ 是混合层深度（单位：$\\mathrm{m}$），$n$ 是垂直模态指数（整数）：\n\n- 测试用例 1（适用于静力近似的亚中尺度）：$N = 1.0\\times 10^{-2}\\ \\mathrm{s}^{-1}$，$f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$，$L = 5000\\ \\mathrm{m}$，$H = 50\\ \\mathrm{m}$，$n = 1$，$\\omega_f = 1.0\\times 10^{-5}\\ \\mathrm{s}^{-1}$，$F_0 = 1.0\\ \\mathrm{m}/\\mathrm{s}^{2}$。\n- 测试用例 2（临界高宽比）：$N = 1.0\\times 10^{-2}\\ \\mathrm{s}^{-1}$，$f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$，$L = 300\\ \\mathrm{m}$，$H = 150\\ \\mathrm{m}$，$n = 1$，$\\omega_f = 2.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$，$F_0 = 1.0\\ \\mathrm{m}/\\mathrm{s}^{2}$。\n- 测试用例 3（非静力主导）：$N = 1.0\\times 10^{-2}\\ \\mathrm{s}^{-1}$，$f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$，$L = 50\\ \\mathrm{m}$，$H = 500\\ \\mathrm{m}$，$n = 1$，$\\omega_f = 1.0\\times 10^{-5}\\ \\mathrm{s}^{-1}$，$F_0 = 1.0\\ \\mathrm{m}/\\mathrm{s}^{2}$。\n- 测试用例 4（弱分层混合层中的近惯性区）：$N = 2.0\\times 10^{-3}\\ \\mathrm{s}^{-1}$，$f = 1.0\\times 10^{-4}\\ \\mathrm{s}^{-1}$，$L = 1000\\ \\mathrm{m}$，$H = 30\\ \\mathrm{m}$，$n = 1$，$\\omega_f = 1.2\\times 10^{-4}\\ \\mathrm{s}^{-1}$，$F_0 = 1.0\\ \\mathrm{m}/\\mathrm{s}^{2}$。\n\n所有涉及角度或波数的量都以弧度为单位；频率单位为 $\\mathrm{s}^{-1}$；距离单位为米。你的程序应该生成单行输出，其中包含测试用例的误差 $E$，格式为一个用方括号括起来的逗号分隔列表，例如 $\\left[\\text{result1},\\text{result2},\\text{result3},\\text{result4}\\right]$，每个条目都四舍五入到六位小数。",
            "solution": "我们从描述恒定层结静止状态下小扰动的线性化、旋转、分层 Boussinesq 方程组开始。设 $\\boldsymbol{u} = (u,v,w)$ 为速度， $p'$ 为压力扰动， $b$ 为浮力扰动。在一个 $f$ 平面上的控制方程为\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + f \\hat{\\boldsymbol{z}} \\times \\boldsymbol{u} = -\\frac{1}{\\rho_0} \\nabla p' + b \\hat{\\boldsymbol{z}},\n$$\n$$\n\\frac{\\partial b}{\\partial t} + N^2 w = 0,\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0,\n$$\n其中 $\\rho_0$ 是一个恒定的参考密度，$f$ 是科里奥利参数，$N$ 是浮力频率。我们考虑在跨锋水平坐标 $y$ 和垂直坐标 $z$ 上变化，但在沿锋坐标上不变的二维扰动。每个场的平面波拟设为\n$$\n\\left\\{v,w,b,p'\\right\\} \\propto \\exp\\left(i k y + i m z - i \\omega t\\right),\n$$\n其中 $k$ 是水平波数，$m$ 是垂直波数，$\\omega$ 是角频率。将平面波形式代入线性方程组，并利用不可压缩性条件消去压力，即可得到旋转、分层、不可压缩流体中标准的惯性重力波色散关系：\n$$\n\\omega_{\\mathrm{nh}}^2(N,f,k,m) = \\frac{N^2 k^2 + f^2 m^2}{k^2 + m^2}.\n$$\n这个结果可以通过将水平和垂直动量方程与浮力方程相结合，并使用无散度条件来关联速度分量而获得。\n\n在静力假设下，我们忽略垂直动量方程中的垂直加速度项。在线性形式下，垂直动量方程简化为\n$$\n0 = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial z} + b,\n$$\n这强制了垂直压力梯度和浮力之间的静力平衡。继续采用相同的平面波消元方法，并在高宽比区域 $m^2 \\gg k^2$ 中保留主导阶项，可得出色散关系的静力近似：\n$$\n\\omega_{\\mathrm{h}}^2(N,f,k,m) = f^2 + N^2 \\frac{k^2}{m^2}.\n$$\n这种渐近形式表明，当垂直尺度远小于水平尺度时，静力近似能够恢复正确的依赖关系，从而抑制了非静力的垂直惯性。\n\n为了将这些色散关系与次级环流的一个可测量联系起来，我们考虑一个角频率为 $\\omega_f$ 的谐波锋生强迫，它驱动给定 $(k,m)$ 模态的垂直速度产生受迫响应。将垂直速度振幅建模为在 $\\omega_f$ 下受迫的线性振子，非静力模型和静力模型的稳态振幅分别为\n$$\nA_{\\mathrm{nh}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{nh}}^2 - \\omega_f^2\\right|}, \\quad\nA_{\\mathrm{h}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{h}}^2 - \\omega_f^2\\right|},\n$$\n其中 $F_0$ 是强迫振幅，单位为 $\\mathrm{m}/\\mathrm{s}^2$。预测振幅的相对静力误差为\n$$\nE = \\frac{\\left|A_{\\mathrm{h}} - A_{\\mathrm{nh}}\\right|}{\\left|A_{\\mathrm{nh}}\\right|}.\n$$\n由于 $F_0$ 在两个振幅中都呈线性出现，它在 $E$ 中被消去，使得 $E$ 成为无量纲量。\n\n计算的算法设计如下：\n- 对每个测试用例，根据给定的 $L$、$H$ 和模态指数 $n$ 计算波数 $k = 2\\pi/L$ 和 $m = n\\pi/H$。\n- 使用以下公式计算非静力色散 $\\omega_{\\mathrm{nh}}^2$\n$$\n\\omega_{\\mathrm{nh}}^2 = \\frac{N^2 k^2 + f^2 m^2}{k^2 + m^2}.\n$$\n- 使用以下公式计算静力色散 $\\omega_{\\mathrm{h}}^2$\n$$\n\\omega_{\\mathrm{h}}^2 = f^2 + N^2 \\frac{k^2}{m^2}.\n$$\n- 给定 $\\omega_f$，通过以下公式计算 $A_{\\mathrm{nh}}$ 和 $A_{\\mathrm{h}}$\n$$\nA_{\\mathrm{nh}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{nh}}^2 - \\omega_f^2\\right|}, \\quad\nA_{\\mathrm{h}} = \\frac{F_0}{\\left|\\omega_{\\mathrm{h}}^2 - \\omega_f^2\\right|}.\n$$\n- 使用以下公式计算 $E$\n$$\nE = \\frac{\\left|A_{\\mathrm{h}} - A_{\\mathrm{nh}}\\right|}{\\left|A_{\\mathrm{nh}}\\right|}.\n$$\n\n数值计算注意事项：\n- 通过确保 $\\omega_f \\neq \\omega_{\\mathrm{nh}}$ 和 $\\omega_f \\neq \\omega_{\\mathrm{h}}$ 来避免除以零；所提供的测试套件经过选择以避免精确共振。\n- 所有输入均为国际单位制（SI）单位，波数单位为弧度/米，频率单位为弧度/秒（此处为 $\\mathrm{s}^{-1}$）。\n- 最终报告的误差 $E$ 是无量纲浮点数，四舍五入到六位小数。\n\n该程序为指定的四个测试用例实现了这些步骤，并以要求的单行格式输出误差列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef dispersion_nonhydrostatic(N, f, k, m):\n    # Exact nonhydrostatic dispersion relation for rotating, stratified Boussinesq IGWs\n    k2 = k * k\n    m2 = m * m\n    return (N * N * k2 + f * f * m2) / (k2 + m2)\n\ndef dispersion_hydrostatic(N, f, k, m):\n    # Hydrostatic approximation valid when m^2  k^2\n    k2 = k * k\n    m2 = m * m\n    return f * f + N * N * (k2 / m2)\n\ndef vertical_velocity_amplitude(F0, omega2, omegaf):\n    # Amplitude of response of a linear oscillator forced at omega_f\n    denom = abs(omega2 - omegaf * omegaf)\n    # Small epsilon guard not necessary for chosen test cases, but include for safety\n    eps = 1e-20\n    denom = denom if denom  eps else eps\n    return F0 / denom\n\ndef relative_error(N, f, L, H, n, omegaf, F0):\n    # Compute k and m for the mode\n    k = 2.0 * np.pi / L\n    m = n * np.pi / H\n\n    # Dispersions\n    omega2_nh = dispersion_nonhydrostatic(N, f, k, m)\n    omega2_h = dispersion_hydrostatic(N, f, k, m)\n\n    # Amplitudes\n    A_nh = vertical_velocity_amplitude(F0, omega2_nh, omegaf)\n    A_h = vertical_velocity_amplitude(F0, omega2_h, omegaf)\n\n    # Relative error\n    E = abs(A_h - A_nh) / abs(A_nh)\n    return E\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (N [1/s], f [1/s], L [m], H [m], n [int], omega_f [1/s], F0 [m/s^2])\n    test_cases = [\n        (1.0e-2, 1.0e-4, 5000.0, 50.0, 1, 1.0e-5, 1.0),\n        (1.0e-2, 1.0e-4, 300.0, 150.0, 1, 2.0e-4, 1.0),\n        (1.0e-2, 1.0e-4, 50.0, 500.0, 1, 1.0e-5, 1.0),\n        (2.0e-3, 1.0e-4, 1000.0, 30.0, 1, 1.2e-4, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, f, L, H, n, omega_f, F0 = case\n        E = relative_error(N, f, L, H, n, omega_f, F0)\n        results.append(E)\n\n    # Round to six decimal places as specified\n    formatted = [f\"{x:.6f}\" for x in results]\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "选择了非静水控制方程后，下一步是为数值模型设计一个稳定且高效的计算方案。本练习将指导您基于物理原理，为锋面模拟确定合适的网格分辨率和时间步长。您将学习如何将锋面宽度、弗劳德数 $Fr$ 等物理尺度，通过 Courant–Friedrichs–Lewy (CFL) 等稳定性判据，转化为具体的数值参数，这是连接理论与计算实践的关键技能。",
            "id": "3801124",
            "problem": "你需要为一个稳定分层的海洋混合层中的陡峭表层锋面，构建一个基于第一性原理的非静力数值模型配置。你的任务是，从第一性原理出发，为一个能够解析平流和内波的、不可压缩的、Boussinesq、非静力求解器，确定合适的水平网格分辨率、垂直离散化以及稳定的显式时间步长。推导过程必须从不可压缩 Boussinesq 动量和连续性方程、弗劳德数的定义，以及基于 Courant–Friedrichs–Lewy (CFL) 条件的、经过充分检验的稳定性约束开始。你必须提供一个量化流程，该流程使用弗劳德数来证明分辨率选择的合理性，并使用 CFL 约束来选择最大稳定时间步长。所有结果必须使用物理上一致的标度律来表示，并且必须能够通过引用底层方程和均匀分层流体中的线性内波理论来为其辩护。\n\n你必须使用的基本依据包括：\n- 包含非静力压力的不可压缩 Boussinesq 动量方程，其中加速度、科里奥利力、压力梯度和浮力进入动力学。\n- 不可压缩流的连续性方程，以及在平流和扩散作用下浮力的示踪物方程。\n- 弗劳德数 $Fr$ 的定义，即基于混合层深度和特征水平速度的平流时间尺度与分层时间尺度之比，也即 $Fr$ 比较 $U$ 和 $N H$。\n- 在深度为 $H$ 的均匀分层流体中存在线性内重力波模态及其特征模态速度，用于约束解析波浪模型的显式时间步长。\n- 用于显式格式的 Courant–Friedrichs–Lewy (CFL) 条件，该条件通过平流和波传播速度来约束时间步长。\n\n你的程序必须为每个测试用例实现以下总体任务：\n1. 使用提供的特征速度 $U$、浮力频率 $N$ 和混合层深度 $H$ 计算弗劳德数 $Fr$。\n2. 选择一个能够解析锋面宽度和由基本平衡推导出的、受分层控制的平流长度尺度的水平网格间距，而不依赖于流体动力学的简化方法。分辨率的选择必须由以下需求来证明其合理性：当 $Fr$ 不是渐进小时，需要表示显著的陡峭水平梯度和非地转运动。\n3. 选择一个能够充分解析深度为 $H$ 的均匀分层中第一斜压模内重力波结构，以最小化数值频散并解析与锋面动力学相关的垂直切变的垂直网格间距。\n4. 计算同时受水平和垂直平流 CFL 条件以及水平方向内重力波传播约束的最大稳定显式时间步长。\n5. 为每个测试用例返回一个紧凑的摘要，其中包含计算出的 $Fr$、推荐的水平网格间距、推荐的垂直网格间距、最大稳定时间步长，以及指示所选时间步长是否满足平流和重力波 CFL 约束的布尔值。\n\n物理单位和格式要求：\n- 所有长度以米表示，所有时间以秒表示。\n- 如果出现任何角度，以弧度表示，但此任务中不需要角度。\n- 无量纲量表示为普通小数。\n- 所有浮点数输出四舍五入到六位小数。\n- 布尔值必须是字面量 `True` 或 `False`。\n\n测试套件：\n为覆盖不同的动力学机制和约束，将你的推导和算法应用于以下参数集，每个参数集描述了一个均匀分层混合层中的表层锋面：\n\n- 案例 A（一般次中尺度锋面）：\n  - 特征水平速度 $U = 0.50 \\,\\mathrm{m\\,s^{-1}}$\n  - 特征垂直速度 $W = 0.010 \\,\\mathrm{m\\,s^{-1}}$\n  - 浮力频率 $N = 1.0\\times 10^{-2} \\,\\mathrm{s^{-1}}$\n  - 混合层深度 $H = 100 \\,\\mathrm{m}$\n  - 科里奥利参数 $f = 1.0\\times 10^{-4} \\,\\mathrm{s^{-1}}$\n  - 锋面宽度（密度梯度尺度）$L_f = 2000 \\,\\mathrm{m}$\n  - 允许的库朗数 $C = 0.50$\n\n- 案例 B（狭窄、较弱的锋面）：\n  - $U = 0.20 \\,\\mathrm{m\\,s^{-1}}$，$W = 0.005 \\,\\mathrm{m\\,s^{-1}}$，$N = 5.0\\times 10^{-3} \\,\\mathrm{s^{-1}}$，$H = 50 \\,\\mathrm{m}$，$f = 1.0\\times 10^{-4} \\,\\mathrm{s^{-1}}$，$L_f = 500 \\,\\mathrm{m}$，$C = 0.70$\n\n- 案例 C（强分层下的极陡锋面）：\n  - $U = 0.60 \\,\\mathrm{m\\,s^{-1}}$，$W = 0.030 \\,\\mathrm{m\\,s^{-1}}$，$N = 1.5\\times 10^{-2} \\,\\mathrm{s^{-1}}$，$H = 30 \\,\\mathrm{m}$，$f = 8.0\\times 10^{-5} \\,\\mathrm{s^{-1}}$，$L_f = 200 \\,\\mathrm{m}$，$C = 0.40$\n\n对于分辨率充分性目标，请使用以下必须在你的算法中编码并证实的最小离散化标准：\n- 在水平方向上，跨越锋面宽度 $L_f$ 至少有 $n_f = 10$ 个网格点。\n- 跨越由 $U$ 和 $N$ 设定的、受分层控制的平流长度尺度至少有 $n_b = 6$ 个网格点。\n- 至少有 $s_z = 20$ 个垂直网格点解析深度 $H$，以表示第一斜压模形状和垂直切变。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表用方括号括起来。列表中的每个元素对应一个测试用例，其本身是以下形式的列表：\n$[Fr,\\;dx,\\;dz,\\;dt,\\;\\text{advective\\_CFL\\_ok},\\;\\text{gravitywave\\_CFL\\_ok}]$\n所有浮点值必须四舍五入到六位小数。例如，最终打印的行必须如下所示：\n`[[Fr_A,dx_A,dz_A,dt_A,advective_A,gravity_A],[Fr_B,dx_B,dz_B,dt_B,advective_B,gravity_B],[Fr_C,dx_C,dz_C,dt_C,advective_C,gravity_C]]`",
            "solution": "该问题陈述经过严格评估，被确定为有效。它在科学上基于地球物理流体动力学原理，问题设定适定，参数完整且一致，表述客观。任务是推导并实现一个量化流程，为模拟海洋锋面建立数值模型配置。这涉及到从第一性原理确定网格分辨率和稳定的时间步长。\n\n分析始于不可压缩 Boussinesq 方程，该方程控制着分层流体的运动，其中密度变化很小，除非其对浮力有贡献。在旋转参考系中，动量方程为：\n$$\n\\frac{D\\mathbf{u}}{Dt} + f \\mathbf{k} \\times \\mathbf{u} = -\\frac{1}{\\rho_0} \\nabla p' + b \\mathbf{k}\n$$\n其中 $\\mathbf{u} = (u, v, w)$ 是速度矢量，$f$ 是科里奥利参数，$\\mathbf{k}$ 是垂直单位矢量，$\\rho_0$ 是一个常数参考密度，$p'$ 是非静力压力扰动，$b = -g(\\rho - \\rho_0)/\\rho_0$ 是浮力。物质导数为 $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$。该系统由不可压缩流的连续性方程 $\\nabla \\cdot \\mathbf{u} = 0$ 和浮力的守恒方程 $\\frac{Db}{Dt} = 0$（为进行标度分析而忽略显式扩散）封闭。背景分层由浮力频率 $N$ 量化，其定义为 $N^2 = \\frac{\\partial b}{\\partial z}$，适用于处于静力平衡的背景状态。\n\n确定数值参数的流程如下：\n\n**1. 弗劳德数计算**\n\n内弗劳德数 $Fr$ 比较了特征水平速度 $U$ 与长内重力波的速度，后者与 $NH$ 成比例。这个无量纲数表明了分层在抵抗由流动引起的垂直运动中的重要性。其定义为：\n$$\nFr = \\frac{U}{NH}\n$$\n其中 $U$ 是特征水平速度，$N$ 是浮力频率，$H$ 是混合层深度。量级为1或更大的弗劳德数表明，流动足够活跃以克服分层的恢复力，导致显著的非地转运动和潜在的混合。\n\n**2. 水平网格间距 ($\\Delta x$)**\n\n水平分辨率必须足够精细，以解析关键的物理过程和梯度。问题指定了两个需要解析的关键长度尺度。\n\n首先，锋区本身，以密度梯度尺度长度 $L_f$ 为特征，必须得到良好表示。为了捕捉锋的结构，我们需要在该宽度上至少有 $n_f = 10$ 个网格点。这对网格间距 $\\Delta x$ 施加了约束：\n$$\n\\Delta x \\le \\frac{L_f}{n_f} = \\frac{L_f}{10}\n$$\n\n其次，对于弗劳德数不可忽略的流动，非地转动力学变得重要。一个基本的长度尺度源于水平平流与分层恢复力之间的平衡。分层起作用的时间尺度是浮力频率的倒数，$T_N = 1/N$。在此时间内，以速度 $U$ 移动的流体包裹行进的水平距离为 $L_b = U/N$。这个“由分层控制的平流长度尺度”也必须被解析，以准确捕捉如锋生和垂直环流等过程。问题要求在此尺度上至少有 $n_b = 6$ 个网格点，从而得出约束：\n$$\n\\Delta x \\le \\frac{L_b}{n_b} = \\frac{U}{6N}\n$$\n\n为同时满足这两个标准，水平网格间距 $\\Delta x$ 必须选择为两个上限中的最小值：\n$$\n\\Delta x = \\min\\left(\\frac{L_f}{10}, \\frac{U}{6N}\\right)\n$$\n\n科里奥利参数 $f$ 定义了内罗斯贝变形半径 $L_R = NH/f$，它设定了地转平衡的尺度。所给案例描述的是次中尺度锋面，其中 $L_f \\ll L_R$ 且罗斯贝数 $Ro = U/(fL_f)$ 的量级为1或更大，这证明了在确定分辨率时，应关注非地转尺度 ($L_b$) 而非地转尺度 ($L_R$)。\n\n**3. 垂直网格间距 ($\\Delta z$)**\n\n垂直网格间距必须能够解析流动和内波的垂直结构。在深度为 $H$ 的均匀分层中，最基本的 ($m=1$) 斜压模态内波的垂直结构与 $\\sin(\\pi z / H)$ 成正比。充分解析这个半正弦波结构对于最小化数值频散和准确表示垂直切变至关重要。问题要求在深度 $H$ 上至少有 $s_z = 20$ 个网格点，这直接导出了垂直网格间距 $\\Delta z$ 的定义：\n$$\n\\Delta z = \\frac{H}{s_z} = \\frac{H}{20}\n$$\n\n**4. 最大稳定时间步长 ($\\Delta t$)**\n\n对于显式时间步进格式，时间步长 $\\Delta t$ 受 Courant–Friedrichs–Lewy (CFL) 条件的限制，该条件确保信息在单个时间步内不会传播超过一个网格单元。我们必须考虑所有相关的传播速度：平流和内重力波。一般条件是 $\\Delta t \\le C \\cdot (\\text{特征时间})$，其中 $C$ 是库朗数。\n\na. **平流约束：** 流动以速度 $U$ 和 $W$ 分别在水平和垂直方向上传输示踪剂和动量。这给出了两个约束：\n   - 水平平流：$\\Delta t_{adv,x} \\le C \\frac{\\Delta x}{U}$\n   - 垂直平流：$\\Delta t_{adv,z} \\le C \\frac{\\Delta z}{W}$\n\nb. **内重力波约束：** 非静力模型解析内重力波的完整谱。传播最快的信号设定了最严格的稳定性限制。在深度为 $H$ 的均匀分层流体中，内重力波的最大速度对应于长波极限 ($k_h \\to 0$) 下第一斜压模态 ($m=1$) 的相速度。该速度由下式给出：\n$$\nc_{gw,max} = \\frac{NH}{\\pi}\n$$\n相应的在水平网格上的 CFL 约束为：\n$$\n\\Delta t_{gw} \\le C \\frac{\\Delta x}{c_{gw,max}} = C \\frac{\\pi \\Delta x}{NH}\n$$\n\n最终的全局稳定时间步长 $\\Delta t$ 必须是所有这些约束中的最小值，以确保对于所有被解析过程的数值稳定性：\n$$\n\\Delta t = \\min\\left( C \\frac{\\Delta x}{U}, C \\frac{\\Delta z}{W}, C \\frac{\\pi \\Delta x}{NH} \\right)\n$$\n\n**5. 验证布尔值**\n\n最后要求的输出是两个布尔标志，`advective_CFL_ok` 和 `gravitywave_CFL_ok`。这些标志用于确认计算出的时间步长 $\\Delta t$ 满足各自的稳定性条件。通过将 $\\Delta t$ 定义为所有约束时间尺度中的最小值，从构造上就保证了两个条件都得到满足。因此，两个布尔值都将评估为 `True`。它们作为计算的逻辑自洽性检查。\n\n这个基于第一性原理的流程为每个测试用例产出了一套完整的数值参数 ($Fr, \\Delta x, \\Delta z, \\Delta t$)，这些参数直接从分层流动的基本物理学和标准的数值稳定性理论推导得出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical model parameters for simulating oceanic fronts based on\n    physical principles and stability constraints.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (general submesoscale front)\n        {'U': 0.50, 'W': 0.010, 'N': 1.0e-2, 'H': 100.0, 'f': 1.0e-4, 'L_f': 2000.0, 'C': 0.50, 'n_f': 10, 'n_b': 6, 's_z': 20},\n        # Case B (narrow, weaker front)\n        {'U': 0.20, 'W': 0.005, 'N': 5.0e-3, 'H': 50.0, 'f': 1.0e-4, 'L_f': 500.0, 'C': 0.70, 'n_f': 10, 'n_b': 6, 's_z': 20},\n        # Case C (very sharp front with strong stratification)\n        {'U': 0.60, 'W': 0.030, 'N': 1.5e-2, 'H': 30.0, 'f': 8.0e-5, 'L_f': 200.0, 'C': 0.40, 'n_f': 10, 'n_b': 6, 's_z': 20},\n    ]\n\n    results = []\n    for case in test_cases:\n        U = case['U']\n        W = case['W']\n        N = case['N']\n        H = case['H']\n        L_f = case['L_f']\n        C = case['C']\n        n_f = case['n_f']\n        n_b = case['n_b']\n        s_z = case['s_z']\n\n        # 1. Compute the Froude number Fr\n        # Fr = U / (N * H)\n        fr = U / (N * H)\n\n        # 2. Choose horizontal grid spacing dx\n        # Constraint from frontal width Lf\n        dx_f = L_f / n_f\n        # Constraint from stratification-controlled advective length scale U/N\n        dx_b = U / (n_b * N)\n        # Choose the more restrictive (smaller) grid spacing\n        dx = min(dx_f, dx_b)\n\n        # 3. Choose vertical grid spacing dz\n        # Constraint from resolving the first baroclinic mode structure\n        dz = H / s_z\n\n        # 4. Compute maximum stable explicit time step dt\n        # Constraint from horizontal advection\n        dt_adv_x = C * dx / U\n        # Constraint from vertical advection\n        dt_adv_z = C * dz / W\n        \n        # Aggregate advective constraint limit\n        dt_adv_limit = min(dt_adv_x, dt_adv_z)\n        \n        # Constraint from internal gravity wave propagation\n        # Max wave speed c_gw_max = N * H / pi\n        c_gw_max = (N * H) / np.pi\n        dt_gw_limit = C * dx / c_gw_max\n        \n        # Final time step is the minimum of all constraints\n        dt = min(dt_adv_limit, dt_gw_limit)\n        \n        # 5. Check if the final dt satisfies the constraints\n        # These will be True by construction, serving as a check.\n        advective_cfl_ok = (dt = dt_adv_limit)\n        gravitywave_cfl_ok = (dt = dt_gw_limit)\n\n        # Round all floating point outputs to six decimal places\n        current_result = [\n            round(fr, 6),\n            round(dx, 6),\n            round(dz, 6),\n            round(dt, 6),\n            advective_cfl_ok,\n            gravitywave_cfl_ok\n        ]\n        results.append(current_result)\n\n    # Format the final output string as a list of lists representation\n    # The default str() for a list includes spaces, which is consistent\n    # with the provided `print` statement template.\n    print(str(results).replace(\"'\", \"\"))\n\n```"
        }
    ]
}