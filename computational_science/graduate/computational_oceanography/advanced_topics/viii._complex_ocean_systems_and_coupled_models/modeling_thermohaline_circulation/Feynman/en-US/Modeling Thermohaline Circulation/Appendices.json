{
    "hands_on_practices": [
        {
            "introduction": "The engine of thermohaline circulation is seawater density. This practice solidifies the fundamental connection between a water parcel's properties—temperature ($T$) and salinity ($S$)—and its resulting buoyancy. By applying a linearized equation of state, you will calculate the density anomaly and determine whether a parcel is destined to sink or rise, a critical first step in modeling deep water formation .",
            "id": "3926354",
            "problem": "In environmental and earth system modeling of thermohaline circulation, seawater density depends on temperature and salinity at a given pressure. Consider a near-surface parcel at $p=0\\,\\mathrm{dbar}$ (decibar) with $(T,S)=(2\\,\\mathrm{^{\\circ}C},35.2\\,\\mathrm{psu})$, referenced to $(T_0,S_0)=(4\\,\\mathrm{^{\\circ}C},35.0\\,\\mathrm{psu})$, where $\\mathrm{psu}$ denotes Practical Salinity Unit. Assume the Boussinesq approximation (BA), in which a constant reference density $\\,\\rho_0\\,$ is used to linearize thermodynamic effects while retaining buoyancy, and take the thermal expansion coefficient $\\alpha=2\\times 10^{-4}\\,\\mathrm{K}^{-1}$ and the haline contraction coefficient $\\beta=7.5\\times 10^{-4}\\,\\mathrm{psu}^{-1}$, both evaluated at the reference state and at $p=0\\,\\mathrm{dbar}$. Let the reference density at the reference state be $\\,\\rho_0=1027\\,\\mathrm{kg\\,m^{-3}}$.\n\nStarting from fundamental definitions of how density varies with temperature and salinity at fixed pressure, and invoking a first-order linearization about $(T_0,S_0)$ consistent with the Boussinesq approximation, compute the density anomaly at $p=0\\,\\mathrm{dbar}$, namely the quantity $\\rho'=\\rho(T,S,0)-\\rho(T_0,S_0,0)$, expressed in $\\mathrm{kg\\,m^{-3}}$. Round your final numerical result to four significant figures. Then, based on the sign of $\\rho'$ and the Boussinesq buoyancy concept, briefly assess whether the parcel is statically lighter or heavier than the reference and the qualitative implication for its tendency to rise or sink. Only the numerical value of $\\rho'$ is required for the final answer; the buoyancy assessment should be included in your reasoning.",
            "solution": "The problem is found to be valid as it is scientifically grounded, well-posed, and objective. It presents a standard exercise in physical oceanography concerning the linearized equation of state for seawater under the Boussinesq approximation. All necessary data are provided, and the parameters are physically realistic.\n\nThe density of seawater, $\\rho$, is a function of temperature ($T$), salinity ($S$), and pressure ($p$). At a fixed pressure, such as the near-surface condition of $p=0\\,\\mathrm{dbar}$, the density is a function $\\rho(T,S)$. To analyze small deviations from a reference state $(T_0, S_0)$, we can perform a first-order Taylor series expansion of $\\rho(T,S)$ around this reference state:\n$$\n\\rho(T,S) \\approx \\rho(T_0,S_0) + \\left.\\frac{\\partial\\rho}{\\partial T}\\right|_{(T_0, S_0)} (T - T_0) + \\left.\\frac{\\partial\\rho}{\\partial S}\\right|_{(T_0, S_0)} (S - S_0)\n$$\n\nThe problem provides the reference density at the reference state as $\\rho_0 = \\rho(T_0,S_0,0) = 1027\\,\\mathrm{kg\\,m^{-3}}$. The partial derivatives are related to the thermal expansion coefficient, $\\alpha$, and the haline contraction coefficient, $\\beta$. By standard definition in oceanography, these are given by:\n$$\n\\alpha \\equiv -\\frac{1}{\\rho_0} \\left.\\frac{\\partial\\rho}{\\partial T}\\right|_{(T_0, S_0)}\n$$\n$$\n\\beta \\equiv \\frac{1}{\\rho_0} \\left.\\frac{\\partial\\rho}{\\partial S}\\right|_{(T_0, S_0)}\n$$\nThe negative sign in the definition of $\\alpha$ ensures that $\\alpha$ is typically a positive quantity, as density usually decreases with increasing temperature (away from the freezing point). Increased salinity always increases density, so $\\beta$ is positive.\n\nFrom these definitions, we can express the partial derivatives in terms of the given coefficients:\n$$\n\\left.\\frac{\\partial\\rho}{\\partial T}\\right|_{(T_0, S_0)} = -\\rho_0 \\alpha\n$$\n$$\n\\left.\\frac{\\partial\\rho}{\\partial S}\\right|_{(T_0, S_0)} = \\rho_0 \\beta\n$$\n\nSubstituting these expressions back into the Taylor expansion yields the linearized equation of state for seawater:\n$$\n\\rho(T,S) \\approx \\rho_0 - \\rho_0 \\alpha (T - T_0) + \\rho_0 \\beta (S - S_0)\n$$\nThis equation can be rearranged to a common form:\n$$\n\\rho(T,S) \\approx \\rho_0 \\left[ 1 - \\alpha (T - T_0) + \\beta (S - S_0) \\right]\n$$\n\nThe problem asks for the density anomaly, $\\rho'$, which is defined as the difference between the parcel's density and the reference density:\n$$\n\\rho' = \\rho(T,S) - \\rho(T_0,S_0) = \\rho(T,S) - \\rho_0\n$$\nUsing the linearized equation of state, we can write an expression for the density anomaly:\n$$\n\\rho' \\approx \\rho_0 \\left[ -\\alpha (T - T_0) + \\beta (S - S_0) \\right]\n$$\n\nNow, we substitute the provided values into this expression:\nParcel state: $(T,S) = (2\\,\\mathrm{^{\\circ}C}, 35.2\\,\\mathrm{psu})$\nReference state: $(T_0,S_0) = (4\\,\\mathrm{^{\\circ}C}, 35.0\\,\\mathrm{psu})$\nReference density: $\\rho_0 = 1027\\,\\mathrm{kg\\,m^{-3}}$\nThermal expansion coefficient: $\\alpha = 2 \\times 10^{-4}\\,\\mathrm{K}^{-1}$\nHaline contraction coefficient: $\\beta = 7.5 \\times 10^{-4}\\,\\mathrm{psu}^{-1}$\n\nThe differences in temperature and salinity are:\n$$\nT - T_0 = 2\\,\\mathrm{^{\\circ}C} - 4\\,\\mathrm{^{\\circ}C} = -2\\,\\mathrm{^{\\circ}C} = -2\\,\\mathrm{K}\n$$\n$$\nS - S_0 = 35.2\\,\\mathrm{psu} - 35.0\\,\\mathrm{psu} = 0.2\\,\\mathrm{psu}\n$$\n\nNow we compute the density anomaly $\\rho'$:\n$$\n\\rho' = (1027\\,\\mathrm{kg\\,m^{-3}}) \\left[ -(2 \\times 10^{-4}\\,\\mathrm{K}^{-1})(-2\\,\\mathrm{K}) + (7.5 \\times 10^{-4}\\,\\mathrm{psu}^{-1})(0.2\\,\\mathrm{psu}) \\right]\n$$\n$$\n\\rho' = 1027 \\left[ (4 \\times 10^{-4}) + (1.5 \\times 10^{-4}) \\right] \\,\\mathrm{kg\\,m^{-3}}\n$$\n$$\n\\rho' = 1027 \\left[ 5.5 \\times 10^{-4} \\right] \\,\\mathrm{kg\\,m^{-3}}\n$$\n$$\n\\rho' = 0.56485 \\,\\mathrm{kg\\,m^{-3}}\n$$\n\nThe problem requires the final numerical result to be rounded to four significant figures.\n$$\n\\rho' \\approx 0.5649 \\,\\mathrm{kg\\,m^{-3}}\n$$\n\nFor the second part of the query, we assess the buoyancy. The density anomaly $\\rho'$ is positive ($0.5649 > 0$). This signifies that the density of the parcel, $\\rho(T,S)$, is greater than the reference density, $\\rho_0$. Therefore, the parcel is heavier (denser) than the reference water. According to the Boussinesq buoyancy concept, the net buoyancy force per unit volume on the parcel is given by $-g\\rho'$, where $g$ is the acceleration due to gravity. Since $\\rho' > 0$, the buoyancy force is negative, meaning there is a net downward force relative to the surrounding fluid. This implies that the parcel is statically unstable in a gravitationally stratified fluid and will tend to sink. This sinking of cold, salty water is a fundamental mechanism driving thermohaline circulation and the formation of deep ocean water masses.",
            "answer": "$$\n\\boxed{0.5649}\n$$"
        },
        {
            "introduction": "While density anomalies drive buoyancy, the overall structure of the water column determines if vertical motion can occur. This exercise introduces the crucial concept of static stability, quantified by the squared buoyancy frequency, $N^2$. By deriving $N^2$ from the vertical gradients of temperature and salinity, you will learn to diagnose the conditions that permit or suppress convection, providing insight into the stability of the ocean's stratification .",
            "id": "3801906",
            "problem": "Consider a stably or unstably stratified ocean column modeled under the Boussinesq and hydrostatic approximations with vertical coordinate $z$ taken positive upward and $z=0$ at the sea surface. Let the background vertical gradients be prescribed as $\\partial T/\\partial z = -0.01~\\mathrm{K}\\,\\mathrm{m}^{-1}$ and $\\partial S/\\partial z = 5\\times 10^{-4}~\\mathrm{g}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$. Assume a linearized seawater equation of state about a local reference state with constant thermal expansion coefficient $\\alpha$ and haline contraction coefficient $\\beta$, and use representative values $\\alpha = 2.0\\times 10^{-4}~\\mathrm{K}^{-1}$ and $\\beta = 7.6\\times 10^{-4}~(\\mathrm{g}\\,\\mathrm{kg}^{-1})^{-1}$. Take gravitational acceleration $g = 9.81~\\mathrm{m}\\,\\mathrm{s}^{-2}$.\n\nStarting from the fundamental definition of the buoyancy frequency squared as the restoring frequency associated with small vertical displacements in a stratified Boussinesq fluid and invoking the linearized equation of state (do not use any pre-quoted stability formulae), derive an explicit expression for the squared buoyancy frequency $N^{2}$ in terms of $\\alpha$, $\\beta$, $\\partial T/\\partial z$, and $\\partial S/\\partial z$. Then evaluate $N^{2}$ numerically for the given parameter values.\n\nRound your final numerical result to three significant figures and express it in $\\mathrm{s}^{-2}$.",
            "solution": "The problem statement is critically reviewed and found to be valid. It is scientifically grounded in the principles of geophysical fluid dynamics, specifically the theory of stratification and buoyancy. The problem is well-posed, with all necessary parameters and conditions provided to derive a unique and meaningful solution. The language is objective and precise.\n\nThe objective is to derive an expression for the squared buoyancy frequency, $N^2$, and then compute its value. The derivation must start from the fundamental definition of buoyancy frequency.\n\nLet us consider a fluid parcel at an initial vertical position $z_0$. In equilibrium, its density, $\\rho_p(z_0)$, is equal to the density of the surrounding environment, $\\rho_e(z_0)$. Now, we displace the parcel adiabatically (i.e., without exchange of heat or salt with its surroundings) by a small vertical distance $\\delta z$ to a new position $z_1 = z_0 + \\delta z$.\n\nSince the displacement is adiabatic, the parcel conserves its temperature and salinity, and thus its density. The parcel's density at the new position $z_1$ is $\\rho_p(z_1) = \\rho_p(z_0) = \\rho_e(z_0)$.\n\nThe density of the surrounding environment at position $z_1$ is $\\rho_e(z_1) = \\rho_e(z_0 + \\delta z)$. For a small displacement $\\delta z$, we can approximate this using a first-order Taylor series expansion:\n$$\n\\rho_e(z_1) \\approx \\rho_e(z_0) + \\left.\\frac{d\\rho_e}{dz}\\right|_{z_0} \\delta z\n$$\n\nThe net buoyant force per unit volume on the displaced parcel is the difference between its weight and the weight of the displaced fluid, which is $g(\\rho_e(z_1) - \\rho_p(z_1))$. The vertical acceleration of the parcel, $a_z = d^2(\\delta z)/dt^2$, is this force divided by the parcel's mass per unit volume, $\\rho_p(z_1)$.\n$$\na_z = \\frac{g(\\rho_e(z_1) - \\rho_p(z_1))}{\\rho_p(z_1)}\n$$\n\nApplying the Boussinesq approximation, we assume density variations are small, so the density in the denominator can be replaced by a constant reference density $\\rho_0$.\n$$\na_z \\approx \\frac{g}{\\rho_0}(\\rho_e(z_1) - \\rho_p(z_1))\n$$\n\nSubstituting the expressions for $\\rho_e(z_1)$ and $\\rho_p(z_1)$:\n$$\na_z \\approx \\frac{g}{\\rho_0} \\left( \\left( \\rho_e(z_0) + \\frac{d\\rho_e}{dz} \\delta z \\right) - \\rho_e(z_0) \\right) = \\frac{g}{\\rho_0} \\frac{d\\rho_e}{dz} \\delta z\n$$\n\nThe equation of motion for the parcel's vertical displacement is thus:\n$$\n\\frac{d^2(\\delta z)}{dt^2} = \\frac{g}{\\rho_0} \\frac{d\\rho_e}{dz} \\delta z\n$$\n\nThis equation has the form of a simple harmonic oscillator, $\\frac{d^2x}{dt^2} = -\\omega^2 x$, if the coefficient of the displacement on the right-hand side is negative. The squared angular frequency of this oscillation, $\\omega^2$, is the squared buoyancy frequency, $N^2$.\n$$\n\\frac{d^2(\\delta z)}{dt^2} + \\left( -\\frac{g}{\\rho_0} \\frac{d\\rho_e}{dz} \\right) \\delta z = 0\n$$\nBy definition, we identify $N^2$ as:\n$$\nN^2 = -\\frac{g}{\\rho_0} \\frac{d\\rho_e}{dz}\n$$\nHere, $\\frac{d\\rho_e}{dz}$ is the vertical gradient of the background density field.\n\nNext, we use the provided linearized equation of state for seawater, which relates density $\\rho$ to temperature $T$ and salinity $S$:\n$$\n\\rho(T, S) \\approx \\rho_0(1 - \\alpha(T - T_{ref}) + \\beta(S - S_{ref}))\n$$\nwhere $\\alpha$ is the thermal expansion coefficient and $\\beta$ is the haline contraction coefficient. We can find the background density gradient by applying the chain rule:\n$$\n\\frac{d\\rho_e}{dz} = \\frac{\\partial \\rho}{\\partial T}\\frac{\\partial T}{\\partial z} + \\frac{\\partial \\rho}{\\partial S}\\frac{\\partial S}{\\partial z}\n$$\nFrom the equation of state, the partial derivatives are:\n$$\n\\frac{\\partial \\rho}{\\partial T} = -\\rho_0 \\alpha\n$$\n$$\n\\frac{\\partial \\rho}{\\partial S} = \\rho_0 \\beta\n$$\nSubstituting these into the expression for the density gradient gives:\n$$\n\\frac{d\\rho_e}{dz} = -\\rho_0 \\alpha \\frac{\\partial T}{\\partial z} + \\rho_0 \\beta \\frac{\\partial S}{\\partial z}\n$$\n\nNow, we substitute this expression for the density gradient into our definition of $N^2$:\n$$\nN^2 = -\\frac{g}{\\rho_0} \\left( -\\rho_0 \\alpha \\frac{\\partial T}{\\partial z} + \\rho_0 \\beta \\frac{\\partial S}{\\partial z} \\right)\n$$\nSimplifying this expression yields the desired relationship for $N^2$:\n$$\nN^2 = g\\alpha\\frac{\\partial T}{\\partial z} - g\\beta\\frac{\\partial S}{\\partial z} = g\\left(\\alpha\\frac{\\partial T}{\\partial z} - \\beta\\frac{\\partial S}{\\partial z}\\right)\n$$\n\nNow, we evaluate $N^2$ numerically using the given parameter values:\n$g = 9.81~\\mathrm{m}\\,\\mathrm{s}^{-2}$\n$\\alpha = 2.0 \\times 10^{-4}~\\mathrm{K}^{-1}$\n$\\beta = 7.6 \\times 10^{-4}~(\\mathrm{g}\\,\\mathrm{kg}^{-1})^{-1}$\n$\\partial T/\\partial z = -0.01~\\mathrm{K}\\,\\mathrm{m}^{-1}$\n$\\partial S/\\partial z = 5 \\times 10^{-4}~\\mathrm{g}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$\n\nSubstituting these values into the derived expression:\n$$\nN^2 = (9.81) \\left[ (2.0 \\times 10^{-4})(-0.01) - (7.6 \\times 10^{-4})(5 \\times 10^{-4}) \\right]\n$$\nLet's compute the terms inside the brackets separately.\nThe thermal contribution is:\n$$\n\\alpha\\frac{\\partial T}{\\partial z} = (2.0 \\times 10^{-4})(-0.01) = -2.0 \\times 10^{-6}~\\mathrm{m}^{-1}\n$$\nThe haline contribution is:\n$$\n\\beta\\frac{\\partial S}{\\partial z} = (7.6 \\times 10^{-4})(5 \\times 10^{-4}) = 38 \\times 10^{-8} = 3.8 \\times 10^{-7}~\\mathrm{m}^{-1}\n$$\nNow, combine the terms:\n$$\nN^2 = (9.81) \\left[ -2.0 \\times 10^{-6} - 3.8 \\times 10^{-7} \\right]~\\mathrm{s}^{-2}\n$$\n$$\nN^2 = (9.81) \\left[ -2.0 \\times 10^{-6} - 0.38 \\times 10^{-6} \\right]~\\mathrm{s}^{-2}\n$$\n$$\nN^2 = (9.81) [-2.38 \\times 10^{-6}]~\\mathrm{s}^{-2}\n$$\n$$\nN^2 = -2.33478 \\times 10^{-5}~\\mathrm{s}^{-2}\n$$\nThe problem requires the result to be rounded to three significant figures.\n$$\nN^2 \\approx -2.33 \\times 10^{-5}~\\mathrm{s}^{-2}\n$$\nThe negative value of $N^2$ indicates that the water column is statically unstable. The buoyancy frequency $N$ is imaginary, leading to exponential growth of vertical disturbances rather than stable oscillations. This instability results from both the thermal and haline stratification: temperature decreases with height (colder, denser water above warmer water) and salinity increases with height (saltier, denser water above fresher water). Both effects contribute to destabilizing the water column.",
            "answer": "$$\\boxed{-2.33 \\times 10^{-5}}$$"
        },
        {
            "introduction": "Local vertical motions ultimately organize into coherent, basin-scale overturning cells, which are best visualized using a streamfunction. This computational problem provides direct, hands-on experience in converting a raw meridional velocity field, $v(x,z)$, into the meridional overturning streamfunction, $\\psi(z)$. This diagnostic is essential for quantifying the strength and structure of the circulation in the output from ocean general circulation models .",
            "id": "3801888",
            "problem": "You are given a synthetic, gridded meridional velocity field for a single fixed latitude band in a model Atlantic basin. The objective is to construct a physically consistent meridional overturning streamfunction in depth coordinates and to identify the depth and magnitude of its maximum overturning. Use the following framing.\n\nAssume a Boussinesq, incompressible ocean where the continuity equation applies, namely $\\nabla \\cdot \\mathbf{u} = 0$, with $\\mathbf{u} = (u,v,w)$. For a single latitude band, define a zonally integrated meridional transport per unit depth that is consistent with mass conservation. Construct a depth-coordinate meridional overturning streamfunction $\\psi(z)$ such that its vertical derivative equals the zonally integrated meridional transport at each depth, and choose the integration constant so that $\\psi(z)$ vanishes at the bottom. Use second-order accurate numerical quadrature along the zonal direction and along the vertical.\n\nLet the model domain be rectangular with zonal coordinate $x \\in [0,W]$ and vertical coordinate $z \\in [-H,0]$, where $z=0$ is the surface and $z=-H$ is the bottom. The gridded meridional velocity field is prescribed by\n$$\nv(x,z) = U_0 \\,\\sin\\!\\left(\\frac{\\pi x}{W}\\right)\\,\\sin\\!\\left(2\\pi \\frac{z+H}{H}\\right),\n$$\nwhere $U_0$ is a given characteristic velocity scale. This structure enforces no-normal-flow at the lateral boundaries $x=0$ and $x=W$ and zero meridional velocity at both surface and bottom, while permitting interior shear that is typical of thermohaline circulation.\n\nYour program must:\n- Construct uniform grids with $N_x$ points in $x$ and $N_z$ points in $z$ over the intervals $[0,W]$ and $[-H,0]$, respectively.\n- Compute the zonally integrated meridional transport per unit depth using a second-order accurate composite trapezoidal rule along $x$ at each depth level.\n- Construct $\\psi(z)$ as the cumulative vertical integral (from $z=-H$ upward) of the zonally integrated transport, using a second-order accurate composite trapezoidal rule along $z$, enforcing $\\psi(-H)=0$.\n- Identify the depth $z_\\star$ at which the absolute value $|\\psi(z)|$ attains its maximum over $z\\in[-H,0]$, and report the signed magnitude $\\psi(z_\\star)$.\n- Convert the reported volume transport to Sverdrups, where one Sverdrup (Sv) equals $10^6~\\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n\nUnits and output requirements:\n- Express $z_\\star$ in meters, as a floating-point number.\n- Express $\\psi(z_\\star)$ in Sverdrups, as a floating-point number rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result must be a list of the form $[z_\\star,\\ \\psi(z_\\star)\\ \\text{in Sv}]$.\n\nTest suite:\nRun your program for the following three parameter sets, which together exercise a general case, a near-degenerate case, and a sign-reversed case:\n1. Happy path case: $W=5.0\\times 10^6~\\mathrm{m}$, $H=5.0\\times 10^3~\\mathrm{m}$, $N_x=401$, $N_z=201$, $U_0=3.0\\times 10^{-3}~\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n2. Near-zero velocity scale: $W=5.0\\times 10^6~\\mathrm{m}$, $H=5.0\\times 10^3~\\mathrm{m}$, $N_x=401$, $N_z=201$, $U_0=1.0\\times 10^{-5}~\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n3. Sign-reversed case with different geometry: $W=3.0\\times 10^6~\\mathrm{m}$, $H=4.0\\times 10^3~\\mathrm{m}$, $N_x=301$, $N_z=161$, $U_0=-4.0\\times 10^{-3}~\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\nFinal output format:\nYour program must print exactly one line of the form\n$$\n\\big[ [z_\\star^{(1)},\\ \\psi^{(1)}_{\\mathrm{Sv}}],\\ [z_\\star^{(2)},\\ \\psi^{(2)}_{\\mathrm{Sv}}],\\ [z_\\star^{(3)},\\ \\psi^{(3)}_{\\mathrm{Sv}}] \\big],\n$$\nwhere the superscripts indicate the test case index and each entry is computed from the corresponding parameter set.",
            "solution": "The user has requested the construction and analysis of a meridional overturning streamfunction for a synthetic, gridded velocity field. I will first validate the problem statement according to the specified criteria.\n\n### Step 1: Extract Givens\n- **Governing Physics**: Boussinesq, incompressible ocean continuity equation $\\nabla \\cdot \\mathbf{u} = 0$, where $\\mathbf{u} = (u,v,w)$.\n- **Domain**: Rectangular domain with zonal coordinate $x \\in [0,W]$ and vertical coordinate $z \\in [-H,0]$.\n- **Velocity Field**: The meridional velocity is prescribed as $v(x,z) = U_0 \\,\\sin\\!\\left(\\frac{\\pi x}{W}\\right)\\,\\sin\\!\\left(2\\pi \\frac{z+H}{H}\\right)$.\n- **Streamfunction Definition**: The meridional overturning streamfunction $\\psi(z)$ is defined by $\\frac{d\\psi}{dz} = V(z)$, where $V(z) = \\int_0^W v(x,z) dx$ is the zonally integrated meridional transport.\n- **Boundary Condition**: $\\psi(z)$ must vanish at the bottom, i.e., $\\psi(-H) = 0$.\n- **Numerical Methods**:\n    - Uniform grids with $N_x$ points in $x$ and $N_z$ points in $z$.\n    - Second-order accurate composite trapezoidal rule for both zonal and vertical integration.\n- **Task**:\n    1.  Construct the grids.\n    2.  Compute $V(z)$ at each depth level.\n    3.  Compute $\\psi(z)$ by vertical integration from the bottom up.\n    4.  Identify the depth $z_\\star$ where $|\\psi(z)|$ is maximum.\n    5.  Report the signed magnitude $\\psi(z_\\star)$.\n- **Units and Output**:\n    - Convert transport to Sverdrups ($1~\\mathrm{Sv} = 10^6~\\mathrm{m}^3\\,\\mathrm{s}^{-1}$).\n    - Report $z_\\star$ in meters (float).\n    - Report $\\psi(z_\\star)$ in Sverdrups (float, rounded to three decimal places).\n    - Final output format: `[ [z_star_1, psi_1_sv], [z_star_2, psi_2_sv], [z_star_3, psi_3_sv] ]`.\n- **Test Suite**:\n    1.  $W=5.0\\times 10^6~\\mathrm{m}$, $H=5.0\\times 10^3~\\mathrm{m}$, $N_x=401$, $N_z=201$, $U_0=3.0\\times 10^{-3}~\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n    2.  $W=5.0\\times 10^6~\\mathrm{m}$, $H=5.0\\times 10^3~\\mathrm{m}$, $N_x=401$, $N_z=201$, $U_0=1.0\\times 10^{-5}~\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n    3.  $W=3.0\\times 10^6~\\mathrm{m}$, $H=4.0\\times 10^3~\\mathrm{m}$, $N_x=301$, $N_z=161$, $U_0=-4.0\\times 10^{-3}~\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness**: The problem is scientifically sound. It is based on the fundamental principle of mass conservation (continuity equation) in fluid dynamics, a standard concept in physical oceanography. The definition of the meridional overturning streamfunction is correct. The Boussinesq approximation is a cornerstone of large-scale ocean modeling. The prescribed velocity field, while idealized, is a mathematically valid function that satisfies the stated boundary conditions and represents a simple mode of overturning flow.\n2.  **Non-Formalizable or Irrelevant**: The problem is directly formalizable into a computational algorithm. It pertains to the core topic of modeling thermohaline circulation within computational oceanography.\n3.  **Incomplete or Contradictory Setup**: The problem is fully specified. All necessary parameters ($W$, $H$, $U_0$, $N_x$, $N_z$), equations, boundary conditions, and numerical methods are provided. There are no contradictions.\n4.  **Unrealistic or Infeasible**: The physical parameters are realistic. A basin width of $W=5000~\\mathrm{km}$ and depth of $H=5~\\mathrm{km}$ are representative of the Atlantic Ocean. The velocity scale of $U_0 \\sim 10^{-3}~\\mathrm{m}\\,\\mathrm{s}^{-1}$ is typical for deep ocean currents. The task is computationally feasible.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. The integration of a function with a specified initial condition ($\\psi(-H)=0$) yields a unique solution for $\\psi(z)$. The task of finding the maximum of a continuous function on a closed interval is also well-posed. The instructions are structured clearly.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem is not trivial. It requires a correct implementation of numerical integration and an understanding of the physical concepts. While the analytical solution is tractable for this specific velocity profile, the problem's intent is to test the setup of a general numerical procedure applicable to more complex, non-analytic velocity fields.\n7.  **Outside Scientific Verifiability**: The results are verifiable both through the analytical solution derived from the given functions and by independent numerical implementation.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-posed, scientifically grounded problem in computational oceanography. I will proceed with the solution.\n\n### Principle-Based Design\nThe solution will be developed based on the principles of physical oceanography and numerical analysis.\n\n1.  **Theoretical Framework**: The meridional overturning circulation is a key component of the global climate system. It is often visualized using a streamfunction, $\\psi$. In a zonally-bounded basin, the principle of mass conservation for an incompressible fluid ($\\nabla \\cdot \\mathbf{u} = 0$) can be integrated zonally (from $x=0$ to $x=W$) and vertically (from the bottom $z=-H$ to a depth $z$) to define this streamfunction. The zonal integral of the continuity equation, assuming no flow through the lateral boundaries ($u(0,z) = u(W,z) = 0$), yields:\n    $$ \\frac{\\partial}{\\partial y} \\int_0^W u \\,dx + \\frac{\\partial}{\\partial z} \\int_0^W w \\,dx = 0 $$\n    (Here using $u,v,w$ for $x,y,z$ velocities as in the prompt). The prompt simplifies this by considering a single latitude, which makes the $\\partial/\\partial y$ term a constant source/sink, and implicitly defines the streamfunction from the meridional velocity $v$ as a proxy for the overturning strength. The relation $\\frac{d\\psi}{dz} = V(z) = \\int_0^W v(x,z) dx$ is a standard definition in this context. It states that the vertical gradient of the overturning streamfunction is equal to the total northward transport at that depth.\n\n2.  **Analytical Reference**: To verify the numerical implementation, we can derive the analytical solution. The zonally integrated transport per unit depth is:\n    $$ V(z) = \\int_0^W U_0 \\,\\sin\\!\\left(\\frac{\\pi x}{W}\\right)\\,\\sin\\!\\left(2\\pi \\frac{z+H}{H}\\right) dx = U_0 \\sin\\!\\left(2\\pi \\frac{z+H}{H}\\right) \\left[ -\\frac{W}{\\pi} \\cos\\left(\\frac{\\pi x}{W}\\right) \\right]_0^W = \\frac{2WU_0}{\\pi} \\sin\\!\\left(2\\pi \\frac{z+H}{H}\\right) $$\n    Integrating this from the bottom with the condition $\\psi(-H)=0$ gives the streamfunction:\n    $$ \\psi(z) = \\int_{-H}^z V(z') dz' = \\frac{2WU_0}{\\pi} \\int_{-H}^z \\sin\\!\\left(2\\pi \\frac{z'+H}{H}\\right) dz' = \\frac{2WU_0}{\\pi} \\left[ -\\frac{H}{2\\pi} \\cos\\left(2\\pi \\frac{z'+H}{H}\\right) \\right]_{-H}^z $$\n    $$ \\psi(z) = \\frac{WHU_0}{\\pi^2} \\left[ 1 - \\cos\\left(2\\pi \\frac{z+H}{H}\\right) \\right] $$\n    This function has its maximum absolute value when the cosine term is $-1$, which occurs at $2\\pi(z_\\star+H)/H = \\pi$, leading to $z_\\star = -H/2$. The maximum signed value is $\\psi(z_\\star) = \\frac{2WHU_0}{\\pi^2}$. These analytical results will serve as a benchmark for our numerical code.\n\n3.  **Numerical Algorithm**:\n    - **Discretization**: First, we define the computational domain by creating discrete, uniform grids for the spatial coordinates $x$ and $z$ using `numpy.linspace`. This function is inclusive of the endpoints, matching the problem's closed intervals $[0, W]$ and $[-H, 0]$.\n    - **Velocity Field Evaluation**: The analytical function for the meridional velocity $v(x,z)$ is evaluated on the 2D grid created from the $x$ and $z$ arrays. `numpy.meshgrid` is used to facilitate this vectorized calculation efficiently.\n    - **Zonal Integration**: For each discrete depth level $z_i$, we compute the zonal integral $V(z_i) = \\int_0^W v(x, z_i) dx$. This is performed using the composite trapezoidal rule, as specified. The `numpy.trapz` function is suitable for this, integrating along the zonal axis (`axis=1`) of the 2D velocity array. This yields a 1D array of transport values, $V(z_i)$.\n    - **Vertical Integration**: Next, we compute the streamfunction $\\psi(z_k) = \\int_{-H}^{z_k} V(z) dz$. This is a cumulative integral. The `scipy.integrate.cumulative_trapezoid` function is ideal, as it performs this operation using the trapezoidal rule and allows for setting an initial value. We set `initial=0` to enforce the boundary condition $\\psi(-H)=0$. The result is a 1D array of streamfunction values, $\\psi(z_i)$.\n    - **Maximum Value Identification**: To find the depth $z_\\star$ of the maximum overturning, we find the index where the absolute value of the streamfunction array, $|\\psi(z_i)|$, is maximized. `numpy.argmax(numpy.abs(...))` achieves this. The depth $z_\\star$ is the value from the $z$-grid at this index. The corresponding signed magnitude, $\\psi(z_\\star)$, is the value from the $\\psi$ array at the same index.\n    - **Unit Conversion and Formatting**: The calculated streamfunction value $\\psi(z_\\star)$, which is in units of $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$, is converted to Sverdrups by dividing by $10^6$. The result is then rounded to three decimal places. The final output is assembled into the specified list-of-lists format.\n\nThis structured approach ensures that each step of the physical problem is translated into a correct and efficient numerical counterpart, leading to a robust solution.",
            "answer": "[[-2500.0, 15.198], [-2500.0, 0.051], [-2000.0, -9.727]]"
        }
    ]
}