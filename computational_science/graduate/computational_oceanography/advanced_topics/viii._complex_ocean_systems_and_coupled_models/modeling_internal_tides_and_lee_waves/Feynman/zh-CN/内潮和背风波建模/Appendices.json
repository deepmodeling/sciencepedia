{
    "hands_on_practices": [
        {
            "introduction": "在海洋中，当稳定的层化水流过海底地形时，会产生一种被称为“背风波”的内波。然而，这些波并非在任何条件下都能在垂直方向上传播能量。这个练习将引导你直接从内波的频散关系出发，推导出决定波是垂直传播还是衰减的关键条件，从而加深对背风波生成物理机制的理解。",
            "id": "3800117",
            "problem": "速度为 $U$ 的二维(2D)正压流，在一个浮力频率 $N$ 和科里奥利参数 $f$ 恒定的均匀分层、旋转的 Boussinesq 海洋中，流经一个顺流向波数为 $k$ 的正弦地形。假设为小振幅线性响应和静力-Boussinesq 动力学。\n\n以均匀分层、旋转流体中的线性内重力波频散关系为基本出发点，\n$$\n\\hat{\\omega}^{2} \\;=\\; \\frac{N^{2} k^{2} + f^{2} m^{2}}{k^{2} + m^{2}},\n$$\n其中 $\\hat{\\omega}$ 是内禀 (流体坐标系) 频率，$k$ 是与平均流对齐的水平波数，$m$ 是垂直波数。对于稳态地形强迫波，内禀频率等于平均流引起的多普勒频移，即 $\\hat{\\omega} = k U$。\n\n从上述频散关系和稳态强迫条件出发，推导垂直波数 $m$ 作为 $N$、$f$、$k$ 和 $U$ 的函数。从原理上确定解是垂直传播（$m$ 为实数）还是倏逝（$m$ 为虚数）的机制。然后，对于以下参数值\n- $N = 5.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}$，\n- $f = 1.0 \\times 10^{-4}\\ \\mathrm{s^{-1}}$，\n- $U = 0.20\\ \\mathrm{m\\,s^{-1}}$，\n- $k = \\dfrac{2\\pi}{L}$，其中 $L = 5.0 \\times 10^{3}\\ \\mathrm{m}$，\n\n计算垂直传播分支的共振垂直波数 $m$。以 $\\mathrm{m^{-1}}$ 为单位表示最终值，并将答案四舍五入到四位有效数字。根据你的推导，明确说明所选参数是处于传播区间还是倏逝区间，但最终答案只提供 $m$ 的数值。",
            "solution": "根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 流动类型：二维 (2D) 正压流\n- 流速：$U$\n- 地形：正弦地形，顺流向波数为 $k$\n- 海洋特性：均匀分层、旋转、Boussinesq\n- 浮力频率：常数 $N$\n- 科里奥利参数：常数 $f$\n- 动力学：小振幅线性响应，静力-Boussinesq（但提供并强制使用非静力频散关系）\n- 频散关系：$\\hat{\\omega}^{2} = \\frac{N^{2} k^{2} + f^{2} m^{2}}{k^{2} + m^{2}}$\n- 内禀频率定义：$\\hat{\\omega}$ 是流体坐标系频率\n- 水平波数：$k$（与平均流对齐）\n- 垂直波数：$m$\n- 稳态强迫条件：$\\hat{\\omega} = k U$\n- 数值：\n  - $N = 5.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}$\n  - $f = 1.0 \\times 10^{-4}\\ \\mathrm{s^{-1}}$\n  - $U = 0.20\\ \\mathrm{m\\,s^{-1}}$\n  - $k = \\frac{2\\pi}{L}$，其中 $L = 5.0 \\times 10^{3}\\ \\mathrm{m}$\n\n### 第 2 步：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据**：该问题是地球物理流体动力学中的一个经典练习，特别是关于分层流过地形产生的背风波理论。所提供的频散关系是在 Boussinesq 近似下，旋转分层流体中内重力波的标准频散关系。稳态强迫条件 $\\hat{\\omega} = kU$ 正确地表示了从流体坐标系中的时间相关问题到地形坐标系中稳态问题的转换。其物理原理是公认的。\n- **适定性**：这个问题是适定的。它提供了所有必要的信息和一组明确的任务：推导表达式、确定物理机制和计算数值。这些任务会导出一个唯一且有意义的解。\n- **客观性**：问题使用精确、客观和标准的科学术语进行陈述。\n- **其他缺陷**：问题没有列出的那些缺陷。它是可形式化的、自洽的且科学上可行的。提供的数值对于海洋条件是现实的。提到“静力”动力学同时又提供一个“非静力”频散关系所带来的轻微模糊性，通过明确指示使用所给关系式作为基本出发点而得以解决，这使得指令集内部一致。\n\n### 第 3 步：结论与行动\n问题是**有效的**。将提供完整解答。\n\n出发点是给定的均匀分层旋转流体中线性内重力波的频散关系：\n$$\n\\hat{\\omega}^{2} = \\frac{N^{2} k^{2} + f^{2} m^{2}}{k^{2} + m^{2}}\n$$\n其中 $\\hat{\\omega}$ 是内禀频率，$k$ 是水平波数，$m$ 是垂直波数，$N$ 是浮力频率，$f$ 是科里奥利参数。\n\n对于因流越地形而强迫产生的稳态波，在运动流体参考系中的频率 $\\hat{\\omega}$ 是多普勒频移后的频率。对于与波数 $k$ 对齐的平均流 $U$，这由稳态强迫条件给出：\n$$\n\\hat{\\omega} = k U\n$$\n将此条件代入频散关系，得到：\n$$\n(k U)^{2} = \\frac{N^{2} k^{2} + f^{2} m^{2}}{k^{2} + m^{2}}\n$$\n我们的目标是解出这个方程中的垂直波数 $m$。我们首先重新整理方程，分离出包含 $m^2$ 的项：\n$$\n(k U)^{2} (k^{2} + m^{2}) = N^{2} k^{2} + f^{2} m^{2}\n$$\n$$\nk^{4} U^{2} + k^{2} U^{2} m^{2} = N^{2} k^{2} + f^{2} m^{2}\n$$\n$$\nk^{2} U^{2} m^{2} - f^{2} m^{2} = N^{2} k^{2} - k^{4} U^{2}\n$$\n在左边提出 $m^{2}$，在右边提出 $k^2$，得到：\n$$\nm^{2} (k^{2} U^{2} - f^{2}) = k^{2} (N^{2} - k^{2} U^{2})\n$$\n解出 $m^2$，我们得到：\n$$\nm^{2} = k^{2} \\frac{N^{2} - k^{2} U^{2}}{k^{2} U^{2} - f^{2}}\n$$\n这也可以用稳态内禀频率 $\\hat{\\omega} = kU$ 来表示：\n$$\nm^{2} = k^{2} \\frac{N^{2} - \\hat{\\omega}^{2}}{\\hat{\\omega}^{2} - f^{2}}\n$$\n垂直波数 $m$ 是该表达式的平方根。我们感兴趣的是传播分支的共振垂直波数，因此我们考虑正根：\n$$\nm = |k| \\sqrt{\\frac{N^{2} - \\hat{\\omega}^{2}}{\\hat{\\omega}^{2} - f^{2}}}\n$$\n由于波数 $k$ 通常定义为正值 ($k = 2\\pi/L > 0$)，我们可以写成 $m = k \\sqrt{\\frac{N^{2} - (kU)^{2}}{(kU)^{2} - f^{2}}}$。\n\n接下来，我们确定垂直传播解与倏逝解的机制。\n- **垂直传播波**需要垂直波数为实数，即 $m^{2} > 0$。由于 $k^2$ 总是正的，这个条件在 $\\frac{N^{2} - \\hat{\\omega}^{2}}{\\hat{\\omega}^{2} - f^{2}}$ 项为正时满足。这发生在分子和分母同号时。在典型的海洋条件下，$N > f$。\n  1. 两者皆为正：$N^{2} - \\hat{\\omega}^{2} > 0$ 且 $\\hat{\\omega}^{2} - f^{2} > 0$。这意味着 $\\hat{\\omega}^2  N^2$ 且 $\\hat{\\omega}^2 > f^2$。由于频率是正的，这给出了条件 $f  \\hat{\\omega}  N$。\n  2. 两者皆为负：$N^{2} - \\hat{\\omega}^{2}  0$ 且 $\\hat{\\omega}^{2} - f^{2}  0$。这意味着 $\\hat{\\omega} > N$ 且 $\\hat{\\omega}  f$。由于 $N > f$，这些条件是互斥的。\n  因此，垂直传播机制对应于内禀频率 $\\hat{\\omega} = kU$ 位于科里奥利频率和浮力频率之间：$f  kU  N$。\n\n- **倏逝波**需要垂直波数为虚数，即 $m^{2}  0$。这发生在分子和分母异号时。\n  1. $N^{2} - \\hat{\\omega}^{2} > 0$ 且 $\\hat{\\omega}^{2} - f^{2}  0$。这得出 $\\hat{\\omega}  N$ 且 $\\hat{\\omega}  f$。由于 $f  N$，这简化为 $\\hat{\\omega}  f$。这是亚惯性（或旋转）倏逝机制。\n  2. $N^{2} - \\hat{\\omega}^{2}  0$ 且 $\\hat{\\omega}^{2} - f^{2} > 0$。这得出 $\\hat{\\omega} > N$ 且 $\\hat{\\omega} > f$。由于 $N > f$，这简化为 $\\hat{\\omega} > N$。这是超临界（或浮力）倏逝机制。\n\n现在，我们使用给定的数值来确定机制并计算 $m$。\n给定的参数是：\n- $N = 5.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}$\n- $f = 1.0 \\times 10^{-4}\\ \\mathrm{s^{-1}}$\n- $U = 0.20\\ \\mathrm{m\\,s^{-1}}$\n- $L = 5.0 \\times 10^{3}\\ \\mathrm{m}$\n\n首先，我们计算水平波数 $k$：\n$$\nk = \\frac{2\\pi}{L} = \\frac{2\\pi}{5.0 \\times 10^{3}} = \\frac{\\pi}{2500}\\ \\mathrm{m^{-1}} \\approx 1.2566 \\times 10^{-3}\\ \\mathrm{m^{-1}}\n$$\n接着，我们计算内禀频率 $\\hat{\\omega} = kU$：\n$$\n\\hat{\\omega} = kU = \\left(\\frac{\\pi}{2500}\\ \\mathrm{m^{-1}}\\right) (0.20\\ \\mathrm{m\\,s^{-1}}) = \\frac{0.2\\pi}{2500}\\ \\mathrm{s^{-1}} = \\frac{\\pi}{12500}\\ \\mathrm{s^{-1}} \\approx 2.5133 \\times 10^{-4}\\ \\mathrm{s^{-1}}\n$$\n我们通过检验条件 $f  \\hat{\\omega}  N$ 来检查参数是否处于传播机制中：\n$$\n1.0 \\times 10^{-4}\\ \\mathrm{s^{-1}}  2.5133 \\times 10^{-4}\\ \\mathrm{s^{-1}}  5.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}\n$$\n该条件满足，因为 $1.0  2.5133$ 且 $2.5133 \\times 10^{-4}  50 \\times 10^{-4}$。因此，所选参数确实对应于垂直传播波。\n\n我们继续使用推导出的公式计算 $m$ 的值：\n$$\nm^2 = k^2 \\frac{N^2 - (kU)^2}{(kU)^2 - f^2}\n$$\n我们有以下平方值：\n- $k^2 = \\left(\\frac{\\pi}{2500}\\right)^2 = \\frac{\\pi^2}{6.25 \\times 10^{6}}\\ \\mathrm{m^{-2}}$\n- $N^2 = (5.0 \\times 10^{-3})^2 = 2.5 \\times 10^{-5}\\ \\mathrm{s^{-2}}$\n- $(kU)^2 = \\left(\\frac{\\pi}{12500}\\right)^2 = \\frac{\\pi^2}{1.5625 \\times 10^{8}}\\ \\mathrm{s^{-2}}$\n- $f^2 = (1.0 \\times 10^{-4})^2 = 1.0 \\times 10^{-8}\\ \\mathrm{s^{-2}}$\n\n将这些值代入 $m^2$ 的表达式中：\n$$\nm^2 = \\left(\\frac{\\pi^2}{6.25 \\times 10^{6}}\\right) \\frac{2.5 \\times 10^{-5} - \\frac{\\pi^2}{1.5625 \\times 10^{8}}}{\\frac{\\pi^2}{1.5625 \\times 10^{8}} - 1.0 \\times 10^{-8}}\n$$\n近似 $\\pi^2 \\approx 9.8696044$：\n$$\n(kU)^2 \\approx \\frac{9.8696044}{1.5625 \\times 10^{8}} \\approx 6.3165468 \\times 10^{-8}\\ \\mathrm{s^{-2}}\n$$\n$$\nk^2 \\approx \\frac{9.8696044}{6.25 \\times 10^{6}} \\approx 1.5791367 \\times 10^{-6}\\ \\mathrm{m^{-2}}\n$$\n$$\nm^2 \\approx (1.5791367 \\times 10^{-6}) \\frac{2.5 \\times 10^{-5} - 6.3165468 \\times 10^{-8}}{6.3165468 \\times 10^{-8} - 1.0 \\times 10^{-8}}\n$$\n$$\nm^2 \\approx (1.5791367 \\times 10^{-6}) \\frac{2.4936835 \\times 10^{-5}}{5.3165468 \\times 10^{-8}}\n$$\n$$\nm^2 \\approx (1.5791367 \\times 10^{-6}) (469.0345)\n$$\n$$\nm^2 \\approx 7.40679 \\times 10^{-4}\\ \\mathrm{m^{-2}}\n$$\n取平方根求 $m$：\n$$\nm = \\sqrt{7.40679 \\times 10^{-4}}\\ \\mathrm{m^{-1}} \\approx 0.0272154\\ \\mathrm{m^{-1}}\n$$\n将结果四舍五入到四位有效数字，我们得到 $0.02722$。\n垂直传播分支的共振垂直波数为 $m \\approx 0.02722\\ \\mathrm{m^{-1}}$。",
            "answer": "$$\n\\boxed{0.02722}\n$$"
        },
        {
            "introduction": "在建立了背风波的物理图像后，下一步是选择合适的数值模型来模拟它们。一个核心的决定是在计算成本较低的静力平衡模型和物理上更完整的非静力模型之间做出选择。本练习旨在阐明这一选择背后的物理依据——波的几何特征（例如水平与垂直波数之比 $k_h/m$），并揭示非静力模型为保证流体不可压缩性而必须求解压力泊松方程（Pressure Poisson Equation）的计算原理。",
            "id": "3800095",
            "problem": "在Boussinesq和不可压缩假设下，一个稳定分层的旋转海洋可以使用静力$z$坐标框架或完全非静力框架进行建模。由正压潮流和平均流与地形相互作用激发的内潮和背风波具有特征宽高比，该宽高比决定了垂直加速度是可忽略还是至关重要的。考虑一个均匀的背景浮力频率$N$、科里奥利参数$f$以及足以产生水平波数为$k_h$、垂直波数为$m$的内波的地形。在静力$z$坐标模型中，通过施加静力平衡来简化垂直动量方程，而在非静力模型中，则保留了完整的垂直动量方程。在不可压缩分层流中，强制执行无辐散约束需要对压力场进行仔细处理。\n\n对于解析内潮和背风波，哪个选项最准确地描述了静力$z$坐标模型和非静力模型之间的区别，包括与非静力垂直加速度相关的压力求解器的作用和必要性？\n\nA. 静力$z$坐标模型施加$p_z = -\\rho g$并忽略$w_t$，因此可以可靠地解析$k_h/m \\ll 1$的低模态内潮，但对$k_h \\sim m$的非静力背风波解析不足。非静力模型保留$w_t$，并需要在每个时间步求解一个椭圆型压力泊松方程（PPE）以强制执行$\\nabla \\cdot \\mathbf{u} = 0$，并获得与垂直加速度相关的动力压力。\n\nB. 如果垂直网格间距足够小，静力$z$坐标模型和非静力模型都能同样好地解析背风波；压力求解器仅用于计算静力压力，并且对于非静力实现是可选的。\n\nC. 静力$z$坐标模型对于解析非静力内潮是必需的，因为$z$坐标与重力对齐；非静力模型除非转换为地形追随坐标，否则无法表示斜压潮，并且压力可以被显式诊断而无需求解椭圆方程。\n\nD. 静力$z$坐标模型不能模拟任何内重力波，因为$p$在$z$方向上是常数；非静力模型通过使用状态方程来预报压力来避免椭圆型压力问题，这使得它们在计算上比静力模型更便宜。\n\nE. 静力近似仅通过科里奥利项$f$改变内波的频散关系，因此对于亚惯性区的背风波，非静力效应可以忽略不计；压力求解器主要用于守恒位涡，而不是用于强制执行$\\nabla \\cdot \\mathbf{u} = 0$。",
            "solution": "### 第1步：提取已知条件\n- 系统是一个稳定分层的旋转海洋。\n- 建模框架使用Boussinesq和不可压缩假设。\n- 比较了两种模型类型：静力$z$坐标模型和完全非静力模型。\n- 感兴趣的现象是内潮和背风波，它们由正压潮流和平均流与地形相互作用激发。\n- 背景状态由均匀的浮力频率$N$和均匀的科里奥利参数$f$表征。\n- 地形产生水平波数为$k_h$、垂直波数为$m$的内波。\n- 静力$z$坐标模型通过施加静力平衡来简化垂直动量方程。\n- 非静力模型保留了完整的垂直动量方程。\n- 通过无辐散约束$\\nabla \\cdot \\mathbf{u} = 0$来强制执行不可压缩性。\n\n### 第2步：使用提取的已知条件进行验证\n问题陈述描述了计算地球物理流体动力学中的一个标准比较。\n\n- **科学依据：** 该问题基于流体运动的基本原始方程及其常见近似（Boussinesq、静力）。内波、浮力频率（$N$）、科里奥利参数（$f$）、波数（$k_h$, $m$）以及静力与非静力状态之间的区别等概念是物理海洋学的核心原理。强制执行不可压缩性（$\\nabla \\cdot \\mathbf{u} = 0$）的数值挑战及其与压力泊松方程的联系是计算流体动力学中的一个标准课题。这些前提在科学上是合理的。\n- **提问得当：** 该问题要求准确描述两种明确定义的建模方法在处理一组特定物理现象时的差异。这是一个清晰、可回答的概念性问题。\n- **客观性：** 所用术语技术性强且精确（例如，“静力平衡”、“椭圆型压力泊松方程”、“无辐散约束”）。问题没有主观或含糊不清的语言。\n\n所有验证标准均已满足。该问题有效。\n\n### 第3步：结论与行动\n问题有效。我将继续进行解题推导和选项分析。\n\n### 基于原理的推导\n在Boussinesq近似下，不可压缩、旋转、分层流体的控制方程为：\n1.  **水平动量：**\n    $$ \\frac{D \\mathbf{u}_h}{Dt} + f \\hat{\\mathbf{z}} \\times \\mathbf{u}_h = - \\frac{1}{\\rho_0} \\nabla_h p $$\n    其中$\\mathbf{u}_h = (u,v)$是水平速度矢量，$f$是科里奥利参数，$\\rho_0$是常数参考密度，$p$是压力。\n\n2.  **垂直动量：**\n    $$ \\frac{Dw}{Dt} = - \\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial z} - g \\frac{\\rho'}{\\rho_0} $$\n    其中$w$是垂直速度，$g$是重力加速度，$\\rho'$是相对于背景状态$\\bar{\\rho}(z)$的密度扰动。项$\\frac{Dw}{Dt} = \\frac{\\partial w}{\\partial t} + \\mathbf{u} \\cdot \\nabla w$表示垂直速度的全（物质）导数，即垂直流体加速度。\n\n3.  **不可压缩性（连续性）：**\n    $$ \\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\n\n4.  **浮力/密度守恒：**\n    $$ \\frac{D b}{Dt} + w N^2 = 0 $$\n    其中$b = -g\\rho'/\\rho_0$是浮力，$N^2 = -\\frac{g}{\\rho_0} \\frac{d\\bar{\\rho}}{dz}$是浮力频率的平方，假设为常数。\n\n**静力近似：**\n在此近似中，与压力梯度力和浮力相比，垂直加速度被假定为可忽略不计。因此，垂直动量方程中的$\\frac{Dw}{Dt}$项被设为零：\n$$ 0 \\approx - \\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial z} - g \\frac{\\rho'}{\\rho_0} \\implies \\frac{\\partial p}{\\partial z} = - \\rho g $$\n这就是静力平衡方程。该近似对于水平长度尺度远大于其垂直长度尺度的运动是有效的。对于一个水平波数为$k_h$、垂直波数为$m$的波，这对应于一个小的宽高比，$k_h/m \\ll 1$。具有很长水平波长（小的$k_h$）的低模态内潮通常满足此条件，并能被静力模型很好地表示。然而，由流经陡峭、小尺度地形产生​​的背风波通常具有$k_h \\sim m$，这意味着静力近似是无效的，并会导致对波浪动力学的不准确表示。在静力模型中，压力通过对密度场进行垂直积分获得，而连续性方程则用于从水平速度场的辐散中诊断垂直速度。\n\n**非静力模型：**\n非静力模型保留了完整的垂直动量方程，包括加速度项$\\frac{Dw}{Dt}$。对于精确模拟垂直加速度显著的现象，如背风波（$k_h \\sim m$）或破碎的内波，这是必需的。\n\n**压力求解器的作用：**\n为了数值求解完整的方程组，必须确保速度场$\\mathbf{u}$在每个时间步都保持无辐散，即满足$\\nabla \\cdot \\mathbf{u} = 0$。一种常用的技术是投影法。在这种方法中，可以概念性地对完整的矢量动量方程取散度。这会导出一个关于压力的椭圆型偏微分方程，称为压力泊松方程（PPE）：\n$$ \\nabla^2 p = \\text{速度场和浮力场的函数} $$\n更具体地说，一种常见的数值实现方法是，在时间上推进速度时包含除压力梯度外的所有项，以获得一个中间速度$\\mathbf{u}^*$。然后通过求解PPE来找到新时间步的压力$p^{n+1}$：\n$$ \\nabla^2 p^{n+1} = \\frac{\\rho_0}{\\Delta t} \\nabla \\cdot \\mathbf{u}^* $$\n求解这个关于$p^{n+1}$的椭圆方程，可以得到将速度场投影到无辐散场空间所需的压力场，从而强制执行不可压缩性。以这种方式找到的压力包括与垂直加速度动态相关的非静力分量。这个步骤计算量很大，也是非静力模型比静力模型（其中压力仅通过垂直积分诊断）成本更高的主要原因。\n\n### 逐项分析\n\n**A. 静力$z$坐标模型施加$p_z = -\\rho g$并忽略$w_t$，因此可以可靠地解析$k_h/m \\ll 1$的低模态内潮，但对$k_h \\sim m$的非静力背风波解析不足。非静力模型保留$w_t$，并需要在每个时间步求解一个椭圆型压力泊松方程（PPE）以强制执行$\\nabla \\cdot \\mathbf{u} = 0$，并获得与垂直加速度相关的动力压力。**\n这个陈述是一个全面而准确的总结。\n- 对静力模型的描述，其关键假设（$p_z = -\\rho g$，意味着忽略包含$w_t$的$\\frac{Dw}{Dt}$）及其适用范围（低模态内潮，$k_h/m \\ll 1$）都是正确的。\n- 对其在非静力背风波（$k_h \\sim m$）上失效的描述也是正确的。\n- 对非静力模型保留完整动力学（包括$w_t$）的描述是正确的。\n- 关于非静力模型需要求解椭圆型PPE以强制执行$\\nabla \\cdot \\mathbf{u} = 0$并找到动力压力的陈述，是区别于静力模型数值求解过程的核心点。这是正确的。\n**结论：正确。**\n\n**B. 如果垂直网格间距足够小，静力$z$坐标模型和非静力模型都能同样好地解析背风波；压力求解器仅用于计算静力压力，并且对于非静力实现是可选的。**\n这个陈述在几个方面都是不正确的。\n- “...都能同样好地解析背风波...”：这是错误的。静力模型从根本上缺少垂直加速度的物理机制，这对于许多背风波是至关重要的。增加网格分辨率无法弥补控制方程中缺失的物理过程。\n- “...压力求解器仅用于计算静力压力...”：这是错误的。静力压力是通过直接积分计算的，而不是通过求解椭圆型偏微分方程。椭圆型压力求解器是用于求解非静力动力压力的。\n- “...并且对于非静力实现是可选的”：这是错误的。对于不可压缩模型，强制执行无辐散约束是强制性的，而非可选。PPE是实现这一目标的标准方法。\n**结论：不正确。**\n\n**C. 静力$z$坐标模型对于解析非静力内潮是必需的，因为$z$坐标与重力对齐；非静力模型除非转换为地形追随坐标，否则无法表示斜压潮，并且压力可以被显式诊断而无需求解椭圆方程。**\n这个陈述充满了错误。\n- “静力$z$坐标模型对于解析非静力内潮是必需的...”：这在术语上是自相矛盾的。根据定义，静力模型无法解析非静力现象。\n- “非静力模型除非转换为地形追随坐标，否则无法表示斜压潮”：这是错误的。非静力模型可以并且确实在$z$坐标系中实现，通常使用像部分单元格或剃光单元格这样的技术来表示地形。坐标系的选择与物理近似的选择是两回事。\n- “压力可以被显式诊断而无需求解椭圆方程”：这对于静力模型是正确的，但对于非静力模型是错误的。该陈述将两者混为一谈。\n**结论：不正确。**\n\n**D. 静力$z$坐标模型不能模拟任何内重力波，因为$p$在$z$方向上是常数；非静力模型通过使用状态方程来预报压力来避免椭圆型压力问题，这使得它们在计算上比静力模型更便宜。**\n这个陈述存在根本性缺陷。\n- “静力...模型不能模拟任何内重力波，因为p在z方向上是常数”：这是错误的。压力$p$在$z$方向上不是常数；其梯度为$\\partial p/\\partial z = -\\rho g$。静力模型常被用于模拟大尺度内重力波。\n- “非静力模型通过使用状态方程来预报压力来避免椭圆型压力问题”：这是错误的。不可压缩非静力模型无法避免椭圆型压力问题；它们必须求解它。状态方程是一个诊断关系，在这种情况下不是用于压力动力学的预报关系。\n- “...这使得它们在计算上更便宜...”：这是错误的。非静力模型比静力模型昂贵得多，正是因为它们必须求解计算密集型的椭圆型PPE。\n**结论：不正确。**\n\n**E. 静力近似仅通过科里奥利项$f$改变内波的频散关系，因此对于亚惯性区的背风波，非静力效应可以忽略不计；压力求解器主要用于守恒位涡，而不是用于强制执行$\\nabla \\cdot \\mathbf{u} = 0$。**\n这个陈述表明对物理和数值计算有很深的误解。\n- “...仅通过科里奥利项f改变...频散关系”：这是错误的。完整的频散关系是$\\omega^2 = (N^2 k_h^2 + f^2 m^2) / (k_h^2 + m^2)$。对于$k_h^2 \\ll m^2$有效​​的静力近似，得出$\\omega^2 \\approx N^2 (k_h/m)^2 + f^2$。该近似通过改变分母从根本上改变了对$N^2$和$f^2$的依赖性。主要影响在于分层项。\n- “...对于亚惯性区的背风波，非静力效应可以忽略不计”：这是错误的。背风波是否为非静力取决于其宽高比（$k_h/m$），而不是其相对于$f$的频率范围。在稳定流中，背风波是静止的，因此它们总是亚惯性的（在地形坐标系中$\\omega = 0$），但可以具有强烈的非静力性。\n- “压力求解器主要用于守恒位涡...”：这是错误的。在投影法中，PPE的直接和主要数学功能是强制执行不可压缩性约束$\\nabla \\cdot \\mathbf{u} = 0$。守恒其他量（如PV）是整个精确数值方案所期望的结果，而不是压力求解步骤本身的主要目的。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "即使选择了最恰当的控制方程，将其离散化为计算机代码的过程本身也会引入误差。本练习提供了一个宝贵的编程实践机会，让你量化一种常见的数值误差——数值扩散。通过将你编写的数值模拟结果与一个精确的解析解进行对比，你将亲眼看到离散格式如何导致有效的数值扩散系数 $D_{\\mathrm{eff}}$ 偏离模型中设定的物理值 $D_{\\mathrm{phys}}$，从而深刻体会到数值保真度的重要性。",
            "id": "3800152",
            "problem": "您将量化由隐式拉普拉斯闭合引入的算法扩散对内潮汐波束横向结构的影响，并评估其相对于物理粘性的效应。考虑在 Boussinesq 近似下建模的一个小振幅、线性内波束，该波束在均匀分层、无粘的背景中传播。对于内重力波，频率 $\\omega$、浮力频率 $N$ 和波矢分量 $(k_x,k_z)$ 之间的连续色散关系由下式给出\n$$\n\\omega^2 = N^2 \\frac{k_x^2}{k_x^2 + k_z^2}.\n$$\n在沿波束坐标 $s$ 和横波束坐标 $n$ 的傍轴、缓变包络近似下，并通过拉普拉斯闭合保留线性粘性阻尼，包络 $u(n,s,t)$ 满足标量平流-扩散模型\n$$\n\\frac{\\partial u}{\\partial t} + c_b \\frac{\\partial u}{\\partial s} = D_{\\mathrm{phys}} \\frac{\\partial^2 u}{\\partial n^2},\n$$\n其中 $c_b$ 是沿波束群速度，$D_{\\mathrm{phys}}$ 是一个有效物理扩散系数，它与投影到波束上的运动粘度成正比。您将在固定的 $s$ 处分离出横波束扩散，并关注由下式控制的 $u(n,t)$：\n$$\n\\frac{\\partial u}{\\partial t} = D_{\\mathrm{phys}} \\frac{\\partial^2 u}{\\partial n^2},\n$$\n该方程捕捉了在固定的沿波束站点上，粘性对波束厚度和振幅随时间变化的主导效应，而沿 $s$ 的平流只会移动波束，不会改变其横向结构。\n\n您将使用时间上的后向欧拉法和空间上的二阶中心有限差分，在一个周期性域上通过隐式拉普拉斯闭合来对扩散进行数值处理。将空间网格间距记为 $\\Delta x$，时间步长记为 $\\Delta t$，离散拉普拉斯算子记为 $L_h$。一个时间步的数值更新为\n$$\nu^{n+1} - \\Delta t\\, D_{\\mathrm{closure}} L_h u^{n+1} = u^n,\n$$\n其中 $D_{\\mathrm{closure}}$ 是模型所使用的闭合系数。在周期性网格上的离散傅里叶表示中，离散拉普拉斯算子有如下符号：\n$$\n\\lambda_h(k) = \\frac{4 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x^2},\n$$\n其中 $k$ 是与周期性网格兼容的连续波数。那么，对于模态 $k$，该隐式格式的单步放大因子为\n$$\nG_{\\mathrm{num}}(k) = \\frac{1}{1 + \\Delta t\\, D_{\\mathrm{closure}}\\, \\lambda_h(k)}.\n$$\n\n任务 A（推导）：从以上出发，推导有效数值扩散系数 $D_{\\mathrm{eff}}(k,\\Delta x)$，使得数值放大因子可以写成如下连续形式：\n$$\nG_{\\mathrm{num}}(k) = \\frac{1}{1 + \\Delta t\\, D_{\\mathrm{eff}}(k,\\Delta x)\\, k^2}.\n$$\n请用 $D_{\\mathrm{closure}}$、$k$ 和 $\\Delta x$ 明确表示 $D_{\\mathrm{eff}}(k,\\Delta x)$，并对于固定的 $k$，显示当 $\\Delta x \\to 0$ 时其与 $D_{\\mathrm{closure}}$ 的主阶偏差。\n\n任务 B（波束的解析演化）：设时间 $t=0$ 时的横波束振幅为一个高斯函数，\n$$\nu(n,0) = \\exp\\left(-\\frac{n^2}{w_0^2}\\right),\n$$\n其初始宽度 $w_0$ 以米为单位。请解析地求解扩散方程，以获得宽度 $w(t)$ 和中心振幅 $A(t) = u(0,t)$ 作为时间 $t$ 和 $D_{\\mathrm{phys}}$ 的函数。报告 $w(t)$ 和 $A(t)$ 的明确公式。\n\n任务 C（数值实验与评估）：在长度为 $L = N \\Delta x$、有 $N$ 个网格点的周期性域上实现一个谱方法，使用 $D_{\\mathrm{closure}} = D_{\\mathrm{phys}}$ 的隐式拉普拉斯闭合来演化高斯剖面，总时间为 $T = N_{\\mathrm{steps}} \\Delta t$。使用离散傅里叶变换，对每个模态 $k$ 应用每步的放大因子 $G_{\\mathrm{num}}(k)$，共进行 $N_{\\mathrm{steps}}$ 步，并重构 $u(n,T)$。计算：\n- 数值中心振幅 $A_{\\mathrm{num}}(T)$。\n- 由二阶矩估计器定义的数值宽度 $w_{\\mathrm{num}}(T)$：\n$$\nw_{\\mathrm{num}}^2(T) = \\frac{2 \\int_{-L/2}^{L/2} n^2 u(n,T)\\, \\mathrm{d}n}{\\int_{-L/2}^{L/2} u(n,T)\\, \\mathrm{d}n},\n$$\n在网格上用离散求和实现。\n- 来自任务 B 的解析预测值 $A_{\\mathrm{anal}}(T)$ 和 $w_{\\mathrm{anal}}(T)$。\n- 相对误差度量：\n$$\n\\varepsilon_w = w_{\\mathrm{num}}(T) - w_{\\mathrm{anal}}(T), \\quad \\varepsilon_A = A_{\\mathrm{num}}(T) - A_{\\mathrm{anal}}(T),\n$$\n分别以米和无量纲振幅单位表示。此外，对于由高斯函数的傅里叶方差定义的均方根波数 $k_{\\mathrm{rms}}$（对于上述 $u(n,0)$，其值为 $k_{\\mathrm{rms}} = \\sqrt{2}/w_0$），量化有效数值扩散系数与物理闭合之间的比率。计算\n$$\nR_D = \\frac{D_{\\mathrm{eff}}(k_{\\mathrm{rms}},\\Delta x)}{D_{\\mathrm{phys}}},\n$$\n以测量离散拉普拉斯算子符号在波束的主导波数尺度上引入的数值欠扩散或过扩散。\n\n物理单位和输出要求：\n- 所有长度（包括 $w_0$、$w_{\\mathrm{num}}(T)$、$w_{\\mathrm{anal}}(T)$ 和 $\\varepsilon_w$）均以米表示。\n- 所有时间（包括 $T$）均以秒表示。\n- 所有扩散系数（包括 $D_{\\mathrm{phys}}$）均以 $\\mathrm{m}^2/\\mathrm{s}$ 表示。\n- 中心振幅 $A$ 是无量纲的。\n- 此问题中不需要角度；如果出现任何三角函数参数，则必须以弧度为单位。\n- 对于下方的每个测试用例，您的程序必须输出一个包含三个浮点数的列表：$[\\varepsilon_w,\\varepsilon_A,R_D]$。将所有测试用例的列表汇总到一行中，格式为“[[e11,e12,e13],[e21,e22,e23],[e31,e32,e33]]”，不带任何额外文本。\n\n测试套件：\n使用以下参数集来评估您的实现：\n- 用例 1（正常路径，高分辨率）：$\\Delta x = 1.0\\,\\mathrm{m}$，$N=2048$，$D_{\\mathrm{phys}} = 0.01\\,\\mathrm{m}^2/\\mathrm{s}$，$w_0 = 10.0\\,\\mathrm{m}$，$\\Delta t = 0.5\\,\\mathrm{s}$，$T = 100.0\\,\\mathrm{s}$。\n- 用例 2（粗网格影响）：$\\Delta x = 5.0\\,\\mathrm{m}$，$N=2048$，$D_{\\mathrm{phys}} = 0.01\\,\\mathrm{m}^2/\\mathrm{s}$，$w_0 = 10.0\\,\\mathrm{m}$，$\\Delta t = 1.0\\,\\mathrm{s}$，$T = 200.0\\,\\mathrm{s}$。\n- 用例 3（接近高波数内容）：$\\Delta x = 2.0\\,\\mathrm{m}$，$N=2048$，$D_{\\mathrm{phys}} = 0.01\\,\\mathrm{m}^2/\\mathrm{s}$，$w_0 = 2.0\\,\\mathrm{m}$，$\\Delta t = 0.5\\,\\mathrm{s}$，$T = 200.0\\,\\mathrm{s}$。\n\n您的程序应产生单行输出，其中包含结果，结果为用方括号括起来的逗号分隔列表，嵌套列表的顺序应与以下完全一致：\n$$\n[[\\varepsilon_{w,1},\\varepsilon_{A,1},R_{D,1}],[\\varepsilon_{w,2},\\varepsilon_{A,2},R_{D,2}],[\\varepsilon_{w,3},\\varepsilon_{A,3},R_{D,3}]].\n$$",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于波动力学和数值分析的原理，是适定的，并且完全客观。所有定义、参数和任务都足够清晰，可以得出唯一且可验证的解。\n\n### 任务 A：有效数值扩散系数的推导\n\n目标是找到有效数值扩散系数 $D_{\\mathrm{eff}}(k,\\Delta x)$，它将数值放大因子 $G_{\\mathrm{num}}(k)$ 与一个类似连续体的形式联系起来。\n\n隐式格式的数值放大因子由下式给出：\n$$\nG_{\\mathrm{num}}(k) = \\frac{1}{1 + \\Delta t\\, D_{\\mathrm{closure}}\\, \\lambda_h(k)}\n$$\n其中 $\\lambda_h(k)$ 是离散拉普拉斯算子的符号：\n$$\n\\lambda_h(k) = \\frac{4 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x^2}\n$$\n我们希望将此放大因子表示为以下形式：\n$$\nG_{\\mathrm{num}}(k) = \\frac{1}{1 + \\Delta t\\, D_{\\mathrm{eff}}(k,\\Delta x)\\, k^2}\n$$\n通过令 $G_{\\mathrm{num}}(k)$ 的两个表达式的分母相等，我们得到：\n$$\n1 + \\Delta t\\, D_{\\mathrm{closure}}\\, \\lambda_h(k) = 1 + \\Delta t\\, D_{\\mathrm{eff}}(k,\\Delta x)\\, k^2\n$$\n这可以简化为：\n$$\nD_{\\mathrm{closure}}\\, \\lambda_h(k) = D_{\\mathrm{eff}}(k,\\Delta x)\\, k^2\n$$\n解出 $D_{\\mathrm{eff}}(k,\\Delta x)$ 得到：\n$$\nD_{\\mathrm{eff}}(k,\\Delta x) = D_{\\mathrm{closure}} \\frac{\\lambda_h(k)}{k^2}\n$$\n代入 $\\lambda_h(k)$ 的表达式：\n$$\nD_{\\mathrm{eff}}(k,\\Delta x) = D_{\\mathrm{closure}} \\frac{4 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x^2 k^2}\n$$\n为了分析当网格间距 $\\Delta x \\to 0$ 时与 $D_{\\mathrm{closure}}$ 的主阶偏差，我们对小的 $x$ 进行 $\\sin(x)$ 的泰勒级数展开。令 $x = \\frac{k \\Delta x}{2}$。\n展开式为 $\\sin(x) = x - \\frac{x^3}{6} + \\mathcal{O}(x^5)$。\n那么 $\\sin^2(x) = \\left(x - \\frac{x^3}{6} + \\dots\\right)^2 = x^2 - \\frac{x^4}{3} + \\mathcal{O}(x^6)$。\n代回 $x = \\frac{k \\Delta x}{2}$：\n$$\n\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) = \\left(\\frac{k \\Delta x}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{k \\Delta x}{2}\\right)^4 + \\mathcal{O}((\\Delta x)^6) = \\frac{k^2 \\Delta x^2}{4} - \\frac{k^4 \\Delta x^4}{48} + \\mathcal{O}((\\Delta x)^6)\n$$\n现在我们将此代入 $\\lambda_h(k)$ 的表达式中：\n$$\n\\lambda_h(k) = \\frac{4}{\\Delta x^2} \\left[ \\frac{k^2 \\Delta x^2}{4} - \\frac{k^4 \\Delta x^4}{48} + \\dots \\right] = k^2 - \\frac{k^4 \\Delta x^2}{12} + \\mathcal{O}((\\Delta x)^4)\n$$\n最后，我们将这个展开后的 $\\lambda_h(k)$ 代入 $D_{\\mathrm{eff}}$ 的表达式中：\n$$\nD_{\\mathrm{eff}}(k,\\Delta x) = D_{\\mathrm{closure}} \\frac{k^2 - \\frac{k^4 \\Delta x^2}{12} + \\dots}{k^2} = D_{\\mathrm{closure}} \\left(1 - \\frac{k^2 \\Delta x^2}{12} + \\mathcal{O}((\\Delta x)^4)\\right)\n$$\n与 $D_{\\mathrm{closure}}$ 的主阶偏差为 $-\\frac{D_{\\mathrm{closure}} k^2 \\Delta x^2}{12}$。这表明二阶中心有限差分格式是欠扩散的（对于 $k \\ne 0$ 有 $D_{\\mathrm{eff}}  D_{\\mathrm{closure}}$），意味着它施加的扩散比预期的要小，尤其是在较高波数（或较粗网格）下，并且扩散系数的误差是关于网格间距 $\\Delta x$ 的二阶的。\n\n### 任务 B：波束的解析演化\n\n我们求解具有高斯初始条件 $u(n,0) = \\exp\\left(-\\frac{n^2}{w_0^2}\\right)$ 的一维扩散方程 $\\frac{\\partial u}{\\partial t} = D_{\\mathrm{phys}} \\frac{\\partial^2 u}{\\partial n^2}$。\n这是一个标准问题，最优雅的解法是使用傅里叶变换。设 $\\hat{u}(k,t)$ 是 $u(n,t)$ 的傅里叶变换。该偏微分方程变换为：\n$$\n\\frac{\\partial \\hat{u}}{\\partial t} = -D_{\\mathrm{phys}} k^2 \\hat{u}(k,t)\n$$\n对于每个波数 $k$，这是一个关于时间的一阶常微分方程，其解为：\n$$\n\\hat{u}(k,t) = \\hat{u}(k,0) e^{-D_{\\mathrm{phys}} k^2 t}\n$$\n初始条件（一个高斯函数 $A_0 e^{-n^2/w_0^2}$，其中 $A_0=1$）的傅里叶变换也是一个高斯函数：\n$$\n\\hat{u}(k,0) = \\mathcal{F}\\left[e^{-n^2/w_0^2}\\right](k) = \\sqrt{\\pi} w_0 e^{-k^2 w_0^2 / 4}\n$$\n将此代入傅里叶空间中随时间演化的解：\n$$\n\\hat{u}(k,t) = \\left(\\sqrt{\\pi} w_0 e^{-k^2 w_0^2 / 4}\\right) e^{-D_{\\mathrm{phys}} k^2 t} = \\sqrt{\\pi} w_0 e^{-k^2 \\left(\\frac{w_0^2}{4} + D_{\\mathrm{phys}} t\\right)}\n$$\n为了找到物理空间中的解，我们认识到这是形式为 $u(n,t) = A(t) e^{-n^2/w(t)^2}$ 的高斯函数的傅里叶变换。其变换为 $\\hat{u}(k,t) = A(t) \\sqrt{\\pi} w(t) e^{-k^2 w(t)^2 / 4}$。\n通过比较 $\\hat{u}(k,t)$ 的两个表达式，我们令指数项和前置因子相等。\n从指数项：\n$$\n\\frac{w(t)^2}{4} = \\frac{w_0^2}{4} + D_{\\mathrm{phys}} t \\implies w(t)^2 = w_0^2 + 4 D_{\\mathrm{phys}} t\n$$\n因此，解析宽度为：\n$$\nw_{\\mathrm{anal}}(t) = \\sqrt{w_0^2 + 4 D_{\\mathrm{phys}} t}\n$$\n从前置因子：\n$$\nA(t) \\sqrt{\\pi} w(t) = \\sqrt{\\pi} w_0 \\implies A(t) = \\frac{w_0}{w(t)}\n$$\n因此，解析中心振幅为：\n$$\nA_{\\mathrm{anal}}(t) = \\frac{w_0}{\\sqrt{w_0^2 + 4 D_{\\mathrm{phys}} t}}\n$$\n\n### 任务 C：数值实验与评估\n\n数值模拟将使用谱方法进行。其核心原理是在傅里叶域中演化解，在该域中扩散算子变为简单的乘法。\n\n1.  **离散化**：一个长度为 $L = N \\Delta x$ 的周期性域被离散为 $N$ 个点。我们为 $j=0, \\dots, N-1$ 定义一个中心化的空间网格 $n_j = \\Delta x (j - N/2)$。对应的波数由 $k_m = 2\\pi m / L$ 给出，其中 $m=-N/2, \\dots, N/2-1$，这些波数可以方便地由 `numpy.fft.fftfreq` 生成。\n\n2.  **初始化**：在离散网格 $n$ 上计算初始高斯剖面 $u(n,0)$。为了在我们的中心化空间网格上正确使用 `numpy.fft` 库，在进行变换之前，必须使用 `ifftshift` 将空间数据从 `[-N/2, ..., N/2-1]` 的顺序重排为 `[0, ..., N/2-1, -N/2, ..., -1]` 的顺序，并且输出必须使用 `fftshift` 移回。\n\n3.  **时间演化**：解在 $N_{\\mathrm{steps}} = T/\\Delta t$ 步内从 $t=0$ 演化到 $t=T$。在傅里叶空间中，每一步对应于将傅里叶系数 $\\hat{u}(k)$ 乘以放大因子 $G_{\\mathrm{num}}(k)$。经过 $N_{\\mathrm{steps}}$ 步后，傅里叶空间中的最终状态为 $\\hat{u}(k,T) = \\hat{u}(k,0) \\cdot [G_{\\mathrm{num}}(k)]^{N_{\\mathrm{steps}}}$。\n\n4.  **最终状态分析**：\n    *   数值解 $u(n,T)$ 通过对 $\\hat{u}(k,T)$ 应用快速傅里叶逆变换来恢复。\n    *   数值振幅 $A_{\\mathrm{num}}(T)$ 是计算出的剖面 $u(n,T)$ 的最大值。\n    *   数值宽度 $w_{\\mathrm{num}}(T)$ 使用离散二阶矩估计器计算：\n        $$\n        w_{\\mathrm{num}}^2(T) = \\frac{2 \\sum_{j=0}^{N-1} n_j^2 u(n_j,T)}{\\sum_{j=0}^{N-1} u(n_j,T)}\n        $$\n        其中求和遍及所有网格点。\n    *   误差度量 $\\varepsilon_w = w_{\\mathrm{num}}(T) - w_{\\mathrm{anal}}(T)$ 和 $\\varepsilon_A = A_{\\mathrm{num}}(T) - A_{\\mathrm{anal}}(T)$ 量化了数值结果与解析结果之间的差异。\n    *   比率 $R_D = D_{\\mathrm{eff}}(k_{\\mathrm{rms}},\\Delta x)/D_{\\mathrm{phys}}$ 使用任务 A 中 $D_{\\mathrm{eff}}$ 的公式计算，并在初始高斯函数的均方根波数 $k_{\\mathrm{rms}} = \\sqrt{2}/w_0$ 处求值。该比率直接测量了数值格式在波束主导尺度上的准确性。小于 1 的比率表示欠扩散，这导致数值波束的扩散速度比其解析对应物更慢，衰减更少。\n\n这个过程为量化由拉普拉斯算子的空间离散化引入的数值误差提供了一个完整的框架。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of quantifying numerical diffusion for an internal tide beam\n    modeled by a 1D diffusion equation, comparing numerical and analytical results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path, fine resolution)\n        {'dx': 1.0, 'N': 2048, 'D_phys': 0.01, 'w0': 10.0, 'dt': 0.5, 'T': 100.0},\n        # Case 2 (coarse grid impact)\n        {'dx': 5.0, 'N': 2048, 'D_phys': 0.01, 'w0': 10.0, 'dt': 1.0, 'T': 200.0},\n        # Case 3 (near-high-wavenumber content)\n        {'dx': 2.0, 'N': 2048, 'D_phys': 0.01, 'w0': 2.0, 'dt': 0.5, 'T': 200.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        dx = case['dx']\n        N = case['N']\n        D_phys = case['D_phys']\n        w0 = case['w0']\n        dt = case['dt']\n        T = case['T']\n\n        # D_closure is set to be equal to D_phys as per the problem statement\n        D_closure = D_phys\n        \n        # --- Numerical Simulation ---\n\n        # 1. Grid and Initial Condition Setup\n        L = N * dx\n        # Centered spatial grid from -L/2 to L/2-dx\n        n = dx * (np.arange(N) - N / 2)\n        # Wavenumber grid in standard FFT order\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n        \n        # Initial condition: Gaussian profile, centered on the grid\n        u0 = np.exp(-n**2 / w0**2)\n        \n        # 2. Fourier Space Evolution\n        # Transform initial condition to Fourier space.\n        # We must reorder the centered u0 to standard [0, ..., N-1] order before FFT.\n        u0_hat = np.fft.fft(np.fft.ifftshift(u0))\n\n        # Number of time steps\n        n_steps = int(round(T / dt))\n\n        # Calculate the symbol of the discrete Laplacian\n        # Use a small epsilon to avoid division by zero at k=0, although sin(0)=0 handles it\n        lambda_h = (4 / dx**2) * np.sin(k * dx / 2)**2\n\n        # Calculate the one-step amplification factor for the implicit scheme\n        G_num = 1.0 / (1.0 + dt * D_closure * lambda_h)\n        \n        # Evolve in Fourier space for n_steps\n        uT_hat = u0_hat * (G_num**n_steps)\n\n        # 3. Transform back to physical space and analyze\n        # Inverse transform and reorder back to a centered profile\n        uT_numerical = np.fft.fftshift(np.fft.ifft(uT_hat)).real\n\n        # --- Calculation of Metrics ---\n        \n        # Numerical amplitude: maximum value of the final profile\n        A_num = np.max(uT_numerical)\n        \n        # Numerical width: using the second-moment estimator\n        # The dx terms in the discrete integral form cancel out\n        sum_uT = np.sum(uT_numerical)\n        if sum_uT > 0:\n            sum_n2_uT = np.sum(n**2 * uT_numerical)\n            w_num_sq = (2 * sum_n2_uT) / sum_uT\n            w_num = np.sqrt(w_num_sq)\n        else:\n            w_num = 0.0\n\n        # Analytical predictions at time T\n        w_anal_sq = w0**2 + 4 * D_phys * T\n        w_anal = np.sqrt(w_anal_sq)\n        A_anal = w0 / w_anal\n        \n        # Error metrics\n        eps_w = w_num - w_anal\n        eps_A = A_num - A_anal\n\n        # Ratio of effective numerical diffusivity to physical diffusivity\n        k_rms = np.sqrt(2) / w0\n        \n        # Use sinc(x) = sin(x)/x. R_D = sinc(k_rms * dx / 2)^2\n        arg = k_rms * dx / 2.0\n        if arg == 0:\n            R_D = 1.0\n        else:\n            sinc_val = np.sin(arg) / arg\n            R_D = sinc_val**2\n            \n        results.append([eps_w, eps_A, R_D])\n\n    # Format the final output string as a list of lists of floats\n    final_output_str = f\"[{','.join([f'[{e[0]},{e[1]},{e[2]}]' for e in results])}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}