{
    "hands_on_practices": [
        {
            "introduction": "在对背风波进行建模之前，首要任务是理解其传播的物理条件。本练习旨在从内波的基本色散关系入手，通过动手推导和计算，帮助您掌握如何确定驻相山后波的垂直波数，并根据关键物理参数（如流速、地形尺度和分层强度）判断波是垂直传播还是衰减。这项实践是连接理论物理与实际海洋观测中波场特征分析的基础。",
            "id": "3800117",
            "problem": "一个速度为 $U$ 的二维 (2D) 正压流，在一个浮力频率 $N$ 和科里奥利参数 $f$ 均为常数的均匀层化、旋转的 Boussinesq 海洋中，流经一个顺流向波数为 $k$ 的正弦地形。假设为小振幅线性响应和静力-Boussinesq 动力学。\n\n以均匀层化、旋转流体中的线性内重力波频散关系为基本出发点，\n$$\n\\hat{\\omega}^{2} \\;=\\; \\frac{N^{2} k^{2} + f^{2} m^{2}}{k^{2} + m^{2}},\n$$\n其中 $\\hat{\\omega}$ 是内禀 (流体坐标系) 频率， $k$ 是与平均流对齐的水平波数， $m$ 是垂直波数。对于由地形强迫的定常波，其内禀频率等于平均流引起的多普勒频移，即 $\\hat{\\omega} = k U$。\n\n从上述频散关系和定常强迫条件出发，推导出垂直波数 $m$ 作为 $N$、$f$、$k$ 和 $U$ 的函数。根据第一性原理，识别解为垂直传播 (m 为实数) 和倏逝 (m 为虚数) 的不同区间。然后，对于以下参数值\n- $N = 5.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}$，\n- $f = 1.0 \\times 10^{-4}\\ \\mathrm{s^{-1}}$，\n- $U = 0.20\\ \\mathrm{m\\,s^{-1}}$，\n- $k = \\dfrac{2\\pi}{L}$，其中 $L = 5.0 \\times 10^{3}\\ \\mathrm{m}$，\n\n计算垂直传播分支的共振垂直波数 $m$。将最终值以 $\\mathrm{m^{-1}}$ 为单位表示，并将答案四舍五入到四位有效数字。根据你的推导，明确说明所选参数是处于传播区间还是倏逝区间，但最终答案只提供 $m$ 的数值。",
            "solution": "根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 流动类型：二维 (2D) 正压流\n- 流速：$U$\n- 地形：正弦地形，顺流向波数为 $k$\n- 海洋特性：均匀层化、旋转、Boussinesq\n- 浮力频率：常数 $N$\n- 科里奥利参数：常数 $f$\n- 动力学：小振幅线性响应，静力-Boussinesq (但题目提供并强制要求使用非静力频散关系)\n- 频散关系：$\\hat{\\omega}^{2} = \\frac{N^{2} k^{2} + f^{2} m^{2}}{k^{2} + m^{2}}$\n- 内禀频率定义：$\\hat{\\omega}$ 是流体坐标系频率\n- 水平波数：$k$ (与平均流对齐)\n- 垂直波数：$m$\n- 定常强迫条件：$\\hat{\\omega} = k U$\n- 数值：\n  - $N = 5.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}$\n  - $f = 1.0 \\times 10^{-4}\\ \\mathrm{s^{-1}}$\n  - $U = 0.20\\ \\mathrm{m\\,s^{-1}}$\n  - $k = \\frac{2\\pi}{L}$，其中 $L = 5.0 \\times 10^{3}\\ \\mathrm{m}$\n\n### 第 2 步：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据**：该问题是地球物理流体动力学中的一个经典练习，具体涉及层化流流经地形产生的背风波理论。所提供的频散关系是在 Boussinesq 近似下，旋转、层化流体中内重力波的标准形式。定常强迫条件 $\\hat{\\omega} = kU$ 正确地表示了从流体坐标系中的时变问题到地形坐标系中定常问题的转换。其物理基础是完善的。\n- **良构性**：该问题是良构的。它提供了所有必要的信息和一组明确的任务：推导表达式、识别物理区间和计算数值。这些任务导向一个唯一且有意义的解。\n- **客观性**：该问题使用精确、客观和标准的科学术语进行陈述。\n- **其他缺陷**：该问题没有列出的那些缺陷。它是可形式化的、自洽的并且在科学上是可行的。所提供的数值对于海洋条件是现实的。提到“静力”动力学但却提供“非静力”频散关系所带来的轻微歧义，已通过明确指示使用所给关系式作为基本出发点而得以解决，这使得指令集内部保持一致。\n\n### 第 3 步：结论与操作\n该问题是**有效的**。将提供完整解答。\n\n出发点是给定的均匀层化、旋转流体中线性内重力波的频散关系：\n$$\n\\hat{\\omega}^{2} = \\frac{N^{2} k^{2} + f^{2} m^{2}}{k^{2} + m^{2}}\n$$\n其中 $\\hat{\\omega}$ 是内禀频率， $k$ 是水平波数， $m$ 是垂直波数， $N$ 是浮力频率， $f$ 是科里奥利参数。\n\n对于由地形强迫的定常波，在运动流体参考系中的频率 $\\hat{\\omega}$ 是多普勒频移后的频率。对于与波数 $k$ 对齐的平均流 $U$，这由定常强迫条件给出：\n$$\n\\hat{\\omega} = k U\n$$\n将此条件代入频散关系，得到：\n$$\n(k U)^{2} = \\frac{N^{2} k^{2} + f^{2} m^{2}}{k^{2} + m^{2}}\n$$\n我们的目标是解此方程以求出垂直波数 $m$。我们首先重新整理方程，分离出包含 $m^2$ 的项：\n$$\n(k U)^{2} (k^{2} + m^{2}) = N^{2} k^{2} + f^{2} m^{2}\n$$\n$$\nk^{4} U^{2} + k^{2} U^{2} m^{2} = N^{2} k^{2} + f^{2} m^{2}\n$$\n$$\nk^{2} U^{2} m^{2} - f^{2} m^{2} = N^{2} k^{2} - k^{4} U^{2}\n$$\n在左边提出公因子 $m^{2}$，在右边提出公因子 $k^2$，得到：\n$$\nm^{2} (k^{2} U^{2} - f^{2}) = k^{2} (N^{2} - k^{2} U^{2})\n$$\n解出 $m^{2}$，我们得到：\n$$\nm^{2} = k^{2} \\frac{N^{2} - k^{2} U^{2}}{k^{2} U^{2} - f^{2}}\n$$\n这也可以用定常内禀频率 $\\hat{\\omega} = kU$ 来表示：\n$$\nm^{2} = k^{2} \\frac{N^{2} - \\hat{\\omega}^{2}}{\\hat{\\omega}^{2} - f^{2}}\n$$\n垂直波数 $m$ 是该表达式的平方根。我们关心的是传播分支的共振垂直波数，因此我们取正根：\n$$\nm = |k| \\sqrt{\\frac{N^{2} - \\hat{\\omega}^{2}}{\\hat{\\omega}^{2} - f^{2}}}\n$$\n由于波数 $k$ 通常被定义为正值 ($k = 2\\pi/L > 0$)，我们可以写成 $m = k \\sqrt{\\frac{N^{2} - (kU)^{2}}{(kU)^{2} - f^{2}}}$。\n\n接下来，我们识别垂直传播解与倏逝解的区间。\n- **垂直传播波**需要一个实的垂直波数，即 $m^{2} > 0$。由于 $k^2$ 总是正的，只要项 $\\frac{N^{2} - \\hat{\\omega}^{2}}{\\hat{\\omega}^{2} - f^{2}}$ 为正，该条件即满足。这发生在分子和分母同号时。在典型的海洋条件下，$N > f$。\n  1. 两者均为正：$N^{2} - \\hat{\\omega}^{2} > 0$ 且 $\\hat{\\omega}^{2} - f^{2} > 0$。这意味着 $\\hat{\\omega}^2  N^2$ 且 $\\hat{\\omega}^2 > f^2$。由于频率是正的，这给出了条件 $f  \\hat{\\omega}  N$。\n  2. 两者均为负：$N^{2} - \\hat{\\omega}^{2}  0$ 且 $\\hat{\\omega}^{2} - f^{2}  0$。这意味着 $\\hat{\\omega} > N$ 且 $\\hat{\\omega}  f$。由于 $N > f$，这些条件是互斥的。\n  因此，垂直传播区间对应于内禀频率 $\\hat{\\omega} = kU$ 位于科里奥利频率和浮力频率之间：$f  kU  N$。\n\n- **倏逝波**需要一个虚的垂直波数，即 $m^{2}  0$。这发生在分子和分母异号时。\n  1. $N^{2} - \\hat{\\omega}^{2} > 0$ 且 $\\hat{\\omega}^{2} - f^{2}  0$。这得出 $\\hat{\\omega}  N$ 且 $\\hat{\\omega}  f$。由于 $f  N$，这可以简化为 $\\hat{\\omega}  f$。这是亚惯性 (或旋转) 倏逝区间。\n  2. $N^{2} - \\hat{\\omega}^{2}  0$ 且 $\\hat{\\omega}^{2} - f^{2} > 0$。这得出 $\\hat{\\omega} > N$ 且 $\\hat{\\omega} > f$。由于 $N > f$，这可以简化为 $\\hat{\\omega} > N$。这是超临界 (或浮力) 倏逝区间。\n\n现在，我们使用提供的数值来确定区间并计算 $m$。\n给定的参数是：\n- $N = 5.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}$\n- $f = 1.0 \\times 10^{-4}\\ \\mathrm{s^{-1}}$\n- $U = 0.20\\ \\mathrm{m\\,s^{-1}}$\n- $L = 5.0 \\times 10^{3}\\ \\mathrm{m}$\n\n首先，我们计算水平波数 $k$：\n$$\nk = \\frac{2\\pi}{L} = \\frac{2\\pi}{5.0 \\times 10^{3}} = \\frac{\\pi}{2500}\\ \\mathrm{m^{-1}} \\approx 1.2566 \\times 10^{-3}\\ \\mathrm{m^{-1}}\n$$\n接下来，我们计算内禀频率 $\\hat{\\omega} = kU$：\n$$\n\\hat{\\omega} = kU = \\left(\\frac{\\pi}{2500}\\ \\mathrm{m^{-1}}\\right) (0.20\\ \\mathrm{m\\,s^{-1}}) = \\frac{0.2\\pi}{2500}\\ \\mathrm{s^{-1}} = \\frac{\\pi}{12500}\\ \\mathrm{s^{-1}} \\approx 2.5133 \\times 10^{-4}\\ \\mathrm{s^{-1}}\n$$\n我们通过检验条件 $f  \\hat{\\omega}  N$ 来检查参数是否位于传播区间：\n$$\n1.0 \\times 10^{-4}\\ \\mathrm{s^{-1}}  2.5133 \\times 10^{-4}\\ \\mathrm{s^{-1}}  5.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}\n$$\n该条件得到满足，因为 $1.0  2.5133$ 且 $2.5133 \\times 10^{-4}  50 \\times 10^{-4}$。因此，所选参数确实对应于垂直传播波。\n\n我们继续使用推导出的公式计算 $m$ 的值：\n$$\nm^2 = k^2 \\frac{N^2 - (kU)^2}{(kU)^2 - f^2}\n$$\n我们有以下平方值：\n- $k^2 = \\left(\\frac{\\pi}{2500}\\right)^2 = \\frac{\\pi^2}{6.25 \\times 10^{6}}\\ \\mathrm{m^{-2}}$\n- $N^2 = (5.0 \\times 10^{-3})^2 = 2.5 \\times 10^{-5}\\ \\mathrm{s^{-2}}$\n- $(kU)^2 = \\left(\\frac{\\pi}{12500}\\right)^2 = \\frac{\\pi^2}{1.5625 \\times 10^{8}}\\ \\mathrm{s^{-2}}$\n- $f^2 = (1.0 \\times 10^{-4})^2 = 1.0 \\times 10^{-8}\\ \\mathrm{s^{-2}}$\n\n将这些值代入 $m^2$ 的表达式中：\n$$\nm^2 = \\left(\\frac{\\pi^2}{6.25 \\times 10^{6}}\\right) \\frac{2.5 \\times 10^{-5} - \\frac{\\pi^2}{1.5625 \\times 10^{8}}}{\\frac{\\pi^2}{1.5625 \\times 10^{8}} - 1.0 \\times 10^{-8}}\n$$\n近似取 $\\pi^2 \\approx 9.8696044$：\n$$\n(kU)^2 \\approx \\frac{9.8696044}{1.5625 \\times 10^{8}} \\approx 6.3165468 \\times 10^{-8}\\ \\mathrm{s^{-2}}\n$$\n$$\nk^2 \\approx \\frac{9.8696044}{6.25 \\times 10^{6}} \\approx 1.5791367 \\times 10^{-6}\\ \\mathrm{m^{-2}}\n$$\n$$\nm^2 \\approx (1.5791367 \\times 10^{-6}) \\frac{2.5 \\times 10^{-5} - 6.3165468 \\times 10^{-8}}{6.3165468 \\times 10^{-8} - 1.0 \\times 10^{-8}}\n$$\n$$\nm^2 \\approx (1.5791367 \\times 10^{-6}) \\frac{2.4936835 \\times 10^{-5}}{5.3165468 \\times 10^{-8}}\n$$\n$$\nm^2 \\approx (1.5791367 \\times 10^{-6}) (469.0345)\n$$\n$$\nm^2 \\approx 7.40679 \\times 10^{-4}\\ \\mathrm{m^{-2}}\n$$\n取平方根求 $m$：\n$$\nm = \\sqrt{7.40679 \\times 10^{-4}}\\ \\mathrm{m^{-1}} \\approx 0.0272154\\ \\mathrm{m^{-1}}\n$$\n将结果四舍五入到四位有效数字，我们得到 $0.02722$。\n垂直传播分支的共振垂直波数为 $m \\approx 0.02722\\ \\mathrm{m^{-1}}$。",
            "answer": "$$\n\\boxed{0.02722}\n$$"
        },
        {
            "introduction": "一旦我们确定了波的传播条件，下一步就是形式化地描述其垂直结构。本练习将引导您推导出垂直模态方程，这是分层流体建模的基石之一。通过从第一性原理出发，您将探索两种常见的上边界假设——刚盖近似（rigid-lid）与自由表面（free-surface）——如何改变问题的数学表述及其物理内涵，特别是它们如何影响正压模与斜压模的耦合。",
            "id": "3800115",
            "problem": "考虑一个分层的、无粘性的海洋，其参考密度为常数 $\\rho_0$，深度为 $H$，浮力频率为常数 $N$，由线性化的Boussinesq方程、静水压方程和不可压缩方程控制（为简单起见，不考虑旋转）：\n- 水平动量：$u_t = -\\frac{1}{\\rho_0} p_x$， $v_t = -\\frac{1}{\\rho_0} p_y$。\n- 静水压平衡：$p_z = - \\rho_0 b$。\n- 浮力演变：$b_t + N^2 w = 0$。\n- 连续性：$u_x + v_y + w_z = 0$。\n设自由表面位于 $z=0$，海底位于 $z=-H$。在海底，施加不可穿透条件 $w(-H) = 0$。在表面，条件为以下两者之一：\n- 刚盖（Rigid-lid）：$w(0) = 0$ 且 $\\eta(0) = 0$（无表面位移），或\n- 自由表面（Free-surface）：运动学条件 $w(0) = \\eta_t$ 和动力学条件 $p(0) = \\rho_0 g \\eta$，其中 $\\eta(x,y,t)$ 是表面高度， $g$ 是重力加速度。\n\n假设压力扰动存在垂直模态的变量分离形式：\n$$\np'(x,y,z,t) = \\rho_0\\, \\Phi(x,y,t)\\, F(z),\n$$\n其中 $F(z)$ 是一个无量纲的垂直结构函数，$\\Phi(x,y,t)$ 是一个水平-时间振幅。使用控制方程和分离变量的假设，从第一性原理出发，推导 $F(z)$ 的垂直特征值问题，其形式为\n$$\n\\frac{d}{dz}\\left(\\frac{1}{N^2}\\frac{dF}{dz}\\right) + \\frac{1}{c^2} F = 0,\n$$\n其中 $c$ 是一个具有速度量纲的分离常数。然后，推导在刚盖和自由表面两种情况下 $F(z)$ 对应的顶部边界条件，并陈述底部边界条件。\n\n最后，利用你推导出的算子和边界条件，确定下列哪个陈述正确描述了刚盖与自由表面的选择如何改变垂直模态结构以及正压-斜压耦合的存在性（其中“正压”指与表面重力波相关的垂直均匀模态，“斜压”指内部模态）：\n\nA. 在刚盖条件下，$F(z)$ 的顶部边界为诺伊曼（Neumann）条件，$F'(0)=0$，这消除了正压表面重力波模态；在自由表面条件下，顶部边界为罗宾（Robin）条件，$\\frac{1}{N^2(0)}F'(0) = \\frac{1}{g} F(0)$，这允许存在一个相速为 $c_0=\\sqrt{gH}$ 的垂直均匀正压模态，并通过正压潮在斜压模态上的投影实现正压-斜压能量交换。\n\nB. 在刚盖条件下，顶部边界为狄利克雷（Dirichlet）条件，$F(0)=0$，这保留了表面重力波；在自由表面条件下，顶部边界为诺伊曼条件，$F'(0)=0$，这消除了正压模态，从而阻止了正压-斜压耦合。\n\nC. 使用自由表面时，垂直算子从 $\\frac{d}{dz}\\left(\\frac{1}{N^2} \\frac{d}{dz}\\right)$ 变为 $\\frac{d^2}{dz^2}$，极大地改变了内部特征函数；因此，如果没有海底粗糙度，正压-斜压耦合是不可能的。\n\nD. 两种边界选择产生相同的垂直特征函数和耦合特性；唯一的区别是对快速表面波的数值滤波，这不影响模态结构或能量交换。",
            "solution": "该问题陈述是地球物理流体动力学中的一个标准练习，要求在静水压和Boussinesq近似下，推导分层海洋中内波的垂直模态方程和边界条件。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- **海洋属性：** 分层、无粘性、参考密度为常数 $\\rho_0$、深度 $H$、浮力频率为常数 $N$。\n- **控制方程：**\n  - 水平动量：$u_t = -\\frac{1}{\\rho_0} p_x$, $v_t = -\\frac{1}{\\rho_0} p_y$。\n  - 静水压平衡：$p_z = - \\rho_0 b$。\n  - 浮力演变：$b_t + N^2 w = 0$。\n  - 连续性：$u_x + v_y + w_z = 0$。\n- **几何：** 自由表面位于 $z=0$，平坦海底位于 $z=-H$。\n- **底部边界条件：** 不可穿透性，$w(-H) = 0$。\n- **表面边界条件（两种情况）：**\n  1.  **刚盖：** $w(0) = 0$ 且表面位移 $\\eta(0) = 0$。\n  2.  **自由表面：** 运动学条件 $w(0) = \\eta_t$ 和动力学条件 $p(0) = \\rho_0 g \\eta$。\n- **分离假设：** $p'(x,y,z,t) = \\rho_0\\, \\Phi(x,y,t)\\, F(z)$。我们假设方程中的 $p$ 指的是压力扰动 $p'$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用了静水压近似下的标准线性化Boussinesq方程。这些是研究如内波和潮汐等低频地球物理流动的基础。该设置在科学上是合理的。\n- **适定性：** 该问题要求推导一个具有指定边界条件的Sturm-Liouville特征值问题。这是一个适定的数学问题，它允许存在一组正交的特征函数（垂直模态）和相应的特征值。\n- **客观性：** 该问题使用物理海洋学和数学中的精确、标准术语进行陈述。没有主观或含糊的语言。\n- **缺陷检查：** 问题陈述没有列出的缺陷。它是自洽的、一致的，并且代表了该领域的经典推导。对于预期的情境，其前提在物理和数学上都是合理的。假设 $N$ 为常数是一种简化，但对于一个理想化问题是有效的。\n\n**第三步：结论与行动**\n问题陈述是**有效的**。我们可以继续进行求解。\n\n### 垂直特征值问题的推导\n\n我们从五个控制方程开始。我们的目标是找到一个关于压力扰动 $p$ 的偏微分方程。\n\n1.  对连续性方程求时间导数：\n    $$ (u_x)_t + (v_y)_t + (w_z)_t = 0 $$\n    假设导数可以互换，则有 $(u_t)_x + (v_t)_y + (w_t)_z = 0$。\n\n2.  将水平动量方程代入此表达式：\n    $$ \\left(-\\frac{1}{\\rho_0} p_x\\right)_x + \\left(-\\frac{1}{\\rho_0} p_y\\right)_y + w_{zt} = 0 $$\n    $$ -\\frac{1}{\\rho_0} (p_{xx} + p_{yy}) + w_{zt} = 0 $$\n    这给出了压力的水平拉普拉斯算子 $\\nabla_H^2 p = p_{xx} + p_{yy}$ 与垂直速度之间的关系：\n    $$ \\nabla_H^2 p = \\rho_0 w_{zt} $$\n\n3.  接下来，我们使用静水压和浮力方程将垂直速度 $w$ 与压力 $p$ 联系起来。\n    - 根据静水压平衡，$p_z = -\\rho_0 b$。求时间导数：$p_{zt} = -\\rho_0 b_t$。\n    - 根据浮力演变方程，$b_t = -N^2 w$。\n    - 代入 $b_t$：$p_{zt} = -\\rho_0(-N^2 w) = \\rho_0 N^2 w$。\n    - 这给出了用 $p$ 表示 $w$ 的表达式，在 $N^2 \\neq 0$ 的地方有效：\n      $$ w = \\frac{1}{\\rho_0 N^2} p_{zt} $$\n\n4.  为了得到关于 $p$ 的单一方程，我们将这个 $w$ 的表达式代入第2步得到的方程中。我们需要 $w_{zt}$：\n    $$ w_{zt} = \\frac{\\partial}{\\partial z} \\left( \\frac{\\partial}{\\partial t} \\left( \\frac{1}{\\rho_0 N^2} p_{zt} \\right) \\right) = \\frac{1}{\\rho_0} \\frac{\\partial}{\\partial z} \\left(\\frac{1}{N^2} p_{ztt}\\right) $$\n    将此代入 $\\nabla_H^2 p = \\rho_0 w_{zt}$：\n    $$ \\nabla_H^2 p = \\rho_0 \\left[ \\frac{1}{\\rho_0} \\frac{\\partial}{\\partial z} \\left(\\frac{1}{N^2} p_{ztt}\\right) \\right] = \\frac{\\partial}{\\partial z} \\left(\\frac{1}{N^2} p_{ztt}\\right) $$\n\n5.  现在，我们应用变量分离法。我们假设水平和时间上的依赖关系可以由一个波动方程描述，该方程定义了分离常数 $c$（水平相速度）：\n    $$ \\Phi_{tt} = c^2 \\nabla_H^2 \\Phi \\implies \\nabla_H^2 \\Phi = \\frac{1}{c^2} \\Phi_{tt} $$\n    将此关系应用于 $p = \\rho_0 \\Phi F$，我们得到：\n    $$ \\nabla_H^2 p = \\frac{1}{c^2} p_{tt} $$\n    将此代入第4步的方程：\n    $$ \\frac{1}{c^2} p_{tt} = \\frac{\\partial}{\\partial z} \\left(\\frac{1}{N^2} p_{ztt}\\right) $$\n    对于非平凡的时间依赖性（$p_{tt} \\neq 0$），我们可以形式上消去 $\\frac{\\partial^2}{\\partial t^2}$ 算子：\n    $$ \\frac{1}{c^2} p = \\frac{\\partial}{\\partial z} \\left(\\frac{1}{N^2} p_z\\right) $$\n\n6.  最后，代入假设 $p = \\rho_0 \\Phi(x,y,t) F(z)$。由于 $\\rho_0$ 是常数且 $\\Phi$ 不依赖于 $z$：\n    $$ \\frac{1}{c^2} \\rho_0 \\Phi F(z) = \\frac{d}{dz} \\left(\\frac{1}{N^2} \\frac{d}{dz} (\\rho_0 \\Phi F(z))\\right) $$\n    $$ \\frac{1}{c^2} \\rho_0 \\Phi F(z) = \\rho_0 \\Phi \\frac{d}{dz} \\left(\\frac{1}{N^2} \\frac{dF}{dz}\\right) $$\n    除以 $\\rho_0 \\Phi$（对于非平凡解）并重新整理，得到所需的垂直特征值问题：\n    $$ \\frac{d}{dz}\\left(\\frac{1}{N^2}\\frac{dF}{dz}\\right) + \\frac{1}{c^2} F = 0 $$\n\n### $F(z)$ 的边界条件推导\n\n为了将 $w$ 的物理边界条件转化为 $F(z)$ 的数学边界条件，我们需要 $w$ 和 $F$ 之间的直接关系。根据上面的第3步，$p_{zt} = \\rho_0 N^2 w$。现在使用假设 $p = \\rho_0 \\Phi F$：\n$$ p_{zt} = \\frac{\\partial}{\\partial z}\\left(\\frac{\\partial}{\\partial t}(\\rho_0 \\Phi F(z))\\right) = \\rho_0 \\Phi_t \\frac{dF}{dz} = \\rho_0 \\Phi_t F'(z) $$\n令两个 $p_{zt}$ 的表达式相等：\n$$ \\rho_0 \\Phi_t F'(z) = \\rho_0 N^2 w \\implies w(x,y,z,t) = \\frac{\\Phi_t(x,y,t)}{N^2(z)} F'(z) $$\n这个关系使我们能够定义 $F(z)$ 的边界条件。\n\n**底部边界条件 ($z=-H$)：**\n条件是不可穿透性，$w(-H) = 0$。使用上面的关系：\n$$ w(-H) = \\frac{\\Phi_t}{N^2(-H)} F'(-H) = 0 $$\n对于非平凡运动（$\\Phi_t \\neq 0$），这要求：\n$$ F'(-H) = 0 $$\n\n**顶部边界条件 ($z=0$)：**\n\n**情况1：刚盖**\n条件是 $w(0) = 0$。\n$$ w(0) = \\frac{\\Phi_t}{N^2(0)} F'(0) = 0 $$\n这要求：\n$$ F'(0) = 0 $$\n这是一个齐次诺伊曼边界条件。\n\n**情况2：自由表面**\n条件是 $w(0) = \\eta_t$ 和 $p(0) = \\rho_0 g \\eta$。我们消去表面高度 $\\eta$。对动力学条件求时间导数：$p_t(0) = \\rho_0 g \\eta_t$。代入运动学条件：\n$$ p_t(0) = \\rho_0 g w(0) $$\n现在，我们用分离变量表示 $p_t$ 和 $w$ 的表达式代入：\n- $p_t(0) = \\rho_0 \\Phi_t F(0)$\n- $w(0) = \\frac{\\Phi_t}{N^2(0)} F'(0)$\n将这些代入组合的表面条件中：\n$$ \\rho_0 \\Phi_t F(0) = \\rho_0 g \\left( \\frac{\\Phi_t}{N^2(0)} F'(0) \\right) $$\n消去公因子 $\\rho_0 \\Phi_t$ 得到关于 $F(z)$ 的条件：\n$$ F(0) = \\frac{g}{N^2(0)} F'(0) $$\n这可以重排成选项A中给出的形式：\n$$ \\frac{1}{N^2(0)}F'(0) = \\frac{1}{g} F(0) $$\n这是一个罗宾（或混合）边界条件。\n\n### 选项评估\n\n**A. 在刚盖条件下，$F(z)$ 的顶部边界为诺伊曼（Neumann）条件，$F'(0)=0$，这消除了正压表面重力波模态；在自由表面条件下，顶部边界为罗宾（Robin）条件，$\\frac{1}{N^2(0)}F'(0) = \\frac{1}{g} F(0)$，这允许存在一个相速为 $c_0=\\sqrt{gH}$ 的垂直均匀正压模态，并通过正压潮在斜压模态上的投影实现正压-斜压能量交换。**\n\n- 推导出的刚盖边界条件是 $F'(0)=0$，这是一个诺伊曼条件。这是正确的。其物理结果是滤除了外部表面重力波（在此情境下即“正压模态”），因为表面没有垂直运动来支持它们。这是正确的。\n- 推导出的自由表面边界条件是 $\\frac{1}{N^2(0)}F'(0) = \\frac{1}{g} F(0)$，这是一个罗宾条件。这是正确的。\n- 自由表面条件允许存在表面高度 $\\eta$，这是正压表面重力波模态的标志。该模态由浅水方程控制，相速度为 $c_0=\\sqrt{gH}$。自由表面的物理特性允许其存在。这种大尺度正压模态的存在是正压向斜压能量转换的先决条件，这种转换通常发生在地形之上。该陈述准确地描述了物理过程。\n- **结论：正确。**\n\n**B. 在刚盖条件下，顶部边界为狄利克雷（Dirichlet）条件，$F(0)=0$，这保留了表面重力波；在自由表面条件下，顶部边界为诺伊曼条件，$F'(0)=0$，这消除了正压模态，从而阻止了正压-斜压耦合。**\n\n- 刚盖条件是诺伊曼条件 $F'(0)=0$，而不是狄利克雷条件 $F(0)=0$。这是不正确的。\n- 自由表面条件是罗宾条件，而不是诺伊曼条件。这是不正确的。\n- 物理释义被颠倒了，是不正确的。\n- **结论：不正确。**\n\n**C. 使用自由表面时，垂直算子从 $\\frac{d}{dz}\\left(\\frac{1}{N^2} \\frac{d}{dz}\\right)$ 变为 $\\frac{d^2}{dz^2}$，极大地改变了内部特征函数；因此，如果没有海底粗糙度，正压-斜压耦合是不可能的。**\n\n- 垂直算子 $\\frac{d}{dz}\\left(\\frac{1}{N^2} \\frac{d}{dz}\\right)$ 是从内部控制方程推导出来的，对于刚盖和自由表面两种情况，这些方程是相同的。算子不变，改变的只是顶部边界条件。这是不正确的。\n- 特征函数因边界条件的改变而改变，但算子本身是不变的。\n- **结论：不正确。**\n\n**D. 两种边界选择产生相同的垂直特征函数和耦合特性；唯一的区别是对快速表面波的数值滤波，这不影响模态结构或能量交换。**\n\n- Sturm-Liouville问题的边界条件是不同的（$F'(0)=0$ vs. $F(0) = \\frac{g}{N^2(0)} F'(0)$）。不同的边界条件会导致不同的特征函数和特征值集。因此，模态结构不是相同的。\n- 这种选择通过包含或排除正压表面重力波模态，从根本上影响了系统的物理特性，而这直接影响了正压向斜压能量交换的可能性。\n- **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "即使拥有了正确的物理和数学模型，其数值实现也会引入自身的行为和误差。这项高级实践提供了一个宝贵机会，让您亲手量化一种常见的数值产物——由离散格式引入的隐式数值扩散。通过结合理论推导、解析求解和编程实验，您将精确评估数值解与真实物理过程的偏差，这是计算模型验证与评估中的一项核心技能。",
            "id": "3800152",
            "problem": "您将量化由隐式拉普拉斯闭合引入的算法扩散对内潮汐束的跨束结构的影响，并评估其相对于物理粘性的效应。考虑一个在均匀分层、无粘性背景下，并采用布辛涅斯克近似建模的小振幅线性内波束。对于内重力波，其频率 $\\omega$、浮力频率 $N$ 和波矢分量 $(k_x,k_z)$ 之间的连续色散关系由下式给出\n$$\n\\omega^2 = N^2 \\frac{k_x^2}{k_x^2 + k_z^2}.\n$$\n在沿束坐标 $s$ 和跨束坐标 $n$ 上采用旁轴、缓变包络近似，并通过拉普拉斯闭合保留线性粘性阻尼，包络 $u(n,s,t)$ 满足标量平流-扩散模型\n$$\n\\frac{\\partial u}{\\partial t} + c_b \\frac{\\partial u}{\\partial s} = D_{\\mathrm{phys}} \\frac{\\partial^2 u}{\\partial n^2},\n$$\n其中 $c_b$ 是沿束群速，$D_{\\mathrm{phys}}$ 是一个有效的物理扩散系数，它与投影到波束上的运动粘性成正比。您将隔离固定 $s$ 处的跨束扩散，并专注于由以下方程控制的 $u(n,t)$：\n$$\n\\frac{\\partial u}{\\partial t} = D_{\\mathrm{phys}} \\frac{\\partial^2 u}{\\partial n^2},\n$$\n该方程捕捉了在固定的沿束站点上，粘性随时间对波束厚度和振幅的主阶效应，而沿 $s$ 的平流仅移动波束，不改变其跨束结构。\n\n您将使用时间上为后向欧拉法、空间上为周期性域上的二阶中心有限差分的隐式拉普拉斯闭合来数值处理扩散。记空间网格间距为 $\\Delta x$，时间步长为 $\\Delta t$，离散拉普拉斯算子为 $L_h$。一个时间步长的数值更新公式为：\n$$\nu^{n+1} - \\Delta t\\, D_{\\mathrm{closure}} L_h u^{n+1} = u^n,\n$$\n其中 $D_{\\mathrm{closure}}$ 是模型使用的闭合系数。在周期性网格上的离散傅里叶表示中，离散拉普拉斯算子具有符号：\n$$\n\\lambda_h(k) = \\frac{4 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x^2},\n$$\n其中 $k$ 是与周期性网格兼容的连续波数。那么，对于模式 $k$，该隐式格式的单步放大因子为：\n$$\nG_{\\mathrm{num}}(k) = \\frac{1}{1 + \\Delta t\\, D_{\\mathrm{closure}}\\, \\lambda_h(k)}.\n$$\n\n任务 A (推导)：从以上公式出发，推导有效数值扩散系数 $D_{\\mathrm{eff}}(k,\\Delta x)$，使得数值放大因子可以写成以下连续形式：\n$$\nG_{\\mathrm{num}}(k) = \\frac{1}{1 + \\Delta t\\, D_{\\mathrm{eff}}(k,\\Delta x)\\, k^2}.\n$$\n明确地用 $D_{\\mathrm{closure}}$、$k$ 和 $\\Delta x$ 表示 $D_{\\mathrm{eff}}(k,\\Delta x)$，并展示在 $k$ 固定时，当 $\\Delta x \\to 0$ 时其与 $D_{\\mathrm{closure}}$ 的主阶偏差。\n\n任务 B (波束的解析演化)：设 $t=0$ 时的跨束振幅为高斯函数，\n$$\nu(n,0) = \\exp\\left(-\\frac{n^2}{w_0^2}\\right),\n$$\n初始宽度为 $w_0$，单位为米。解析地求解扩散方程，以获得宽度 $w(t)$ 和中心振幅 $A(t) = u(0,t)$ 作为时间 $t$ 和 $D_{\\mathrm{phys}}$ 的函数。报告 $w(t)$ 和 $A(t)$ 的明确公式。\n\n任务 C (数值实验与评估)：在周期性域 $L = N \\Delta x$ 上实现一个谱方法，该域有 $N$ 个网格点，使用带有 $D_{\\mathrm{closure}} = D_{\\mathrm{phys}}$ 的隐式拉普拉斯闭合，将高斯剖面演化总时间 $T = N_{\\mathrm{steps}} \\Delta t$。使用离散傅里叶变换，将每步放大因子 $G_{\\mathrm{num}}(k)$ 应用于每个模式 $k$，共进行 $N_{\\mathrm{steps}}$ 步，然后重构 $u(n,T)$。计算：\n- 数值中心振幅 $A_{\\mathrm{num}}(T)$。\n- 数值宽度 $w_{\\mathrm{num}}(T)$，由二阶矩估计器定义\n$$\nw_{\\mathrm{num}}^2(T) = \\frac{2 \\int_{-L/2}^{L/2} n^2 u(n,T)\\, \\mathrm{d}n}{\\int_{-L/2}^{L/2} u(n,T)\\, \\mathrm{d}n},\n$$\n在网格上用离散求和实现。\n- 来自任务 B 的解析预测值 $A_{\\mathrm{anal}}(T)$ 和 $w_{\\mathrm{anal}}(T)$。\n- 相对误差度量\n$$\n\\varepsilon_w = w_{\\mathrm{num}}(T) - w_{\\mathrm{anal}}(T), \\quad \\varepsilon_A = A_{\\mathrm{num}}(T) - A_{\\mathrm{anal}}(T),\n$$\n分别以米和无量纲振幅单位表示。此外，量化有效数值扩散系数与物理闭合之间的比率，该比率针对高斯函数的均方根波数 $k_{\\mathrm{rms}}$ 进行计算，对于上述 $u(n,0)$，其定义为 $k_{\\mathrm{rms}} = \\sqrt{2}/w_0$。计算\n$$\nR_D = \\frac{D_{\\mathrm{eff}}(k_{\\mathrm{rms}},\\Delta x)}{D_{\\mathrm{phys}}},\n$$\n以衡量离散拉普拉斯算子符号在波束主导波数尺度上引入的数值欠扩散或过扩散。\n\n物理单位与输出要求：\n- 所有长度（包括 $w_0$、$w_{\\mathrm{num}}(T)$、$w_{\\mathrm{anal}}(T)$ 和 $\\varepsilon_w$）均以米表示。\n- 所有时间（包括 $T$）均以秒表示。\n- 所有扩散系数（包括 $D_{\\mathrm{phys}}$）均以 $\\mathrm{m}^2/\\mathrm{s}$ 表示。\n- 中心振幅 $A$ 是无量纲的。\n- 本问题中不需要角度；如果出现任何三角函数参数，必须以弧度为单位。\n- 对于下面的每个测试用例，您的程序必须输出一个包含三个浮点数的列表：$[\\varepsilon_w,\\varepsilon_A,R_D]$。将所有测试用例的列表聚合成单行，格式为“[[e11,e12,e13],[e21,e22,e23],[e31,e32,e33]]”，不带任何额外文本。\n\n测试套件：\n使用以下参数集来评估您的实现：\n- 用例 $1$ (理想情况，高分辨率)：$\\Delta x = 1.0\\,\\mathrm{m}$，$N=2048$，$D_{\\mathrm{phys}} = 0.01\\,\\mathrm{m}^2/\\mathrm{s}$，$w_0 = 10.0\\,\\mathrm{m}$，$\\Delta t = 0.5\\,\\mathrm{s}$，$T = 100.0\\,\\mathrm{s}$。\n- 用例 $2$ (粗网格影响)：$\\Delta x = 5.0\\,\\mathrm{m}$，$N=2048$，$D_{\\mathrm{phys}} = 0.01\\,\\mathrm{m}^2/\\mathrm{s}$，$w_0 = 10.0\\,\\mathrm{m}$，$\\Delta t = 1.0\\,\\mathrm{s}$，$T = 200.0\\,\\mathrm{s}$。\n- 用例 $3$ (接近高波数内容)：$\\Delta x = 2.0\\,\\mathrm{m}$，$N=2048$，$D_{\\mathrm{phys}} = 0.01\\,\\mathrm{m}^2/\\mathrm{s}$，$w_0 = 2.0\\,\\mathrm{m}$，$\\Delta t = 0.5\\,\\mathrm{s}$，$T = 200.0\\,\\mathrm{s}$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表嵌套在方括号中，并严格按照以下顺序排列：\n$$\n[[\\varepsilon_{w,1},\\varepsilon_{A,1},R_{D,1}],[\\varepsilon_{w,2},\\varepsilon_{A,2},R_{D,2}],[\\varepsilon_{w,3},\\varepsilon_{A,3},R_{D,3}]].\n$$",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于波动力学和数值分析的原理，问题提法恰当，并且完全客观。所有定义、参数和任务都已足够清晰地说明，可以得出一个唯一且可验证的解。\n\n### 任务 A：有效数值扩散系数的推导\n\n目标是找到有效数值扩散系数 $D_{\\mathrm{eff}}(k,\\Delta x)$，它将数值放大因子 $G_{\\mathrm{num}}(k)$ 与一个类似连续形式的表达式联系起来。\n\n隐式格式的数值放大因子由下式给出：\n$$\nG_{\\mathrm{num}}(k) = \\frac{1}{1 + \\Delta t\\, D_{\\mathrm{closure}}\\, \\lambda_h(k)}\n$$\n其中 $\\lambda_h(k)$ 是离散拉普拉斯算子的符号：\n$$\n\\lambda_h(k) = \\frac{4 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x^2}\n$$\n我们希望将此放大因子表示为以下形式：\n$$\nG_{\\mathrm{num}}(k) = \\frac{1}{1 + \\Delta t\\, D_{\\mathrm{eff}}(k,\\Delta x)\\, k^2}\n$$\n通过令两个 $G_{\\mathrm{num}}(k)$ 表达式的分母相等，我们得到：\n$$\n1 + \\Delta t\\, D_{\\mathrm{closure}}\\, \\lambda_h(k) = 1 + \\Delta t\\, D_{\\mathrm{eff}}(k,\\Delta x)\\, k^2\n$$\n这可以简化为：\n$$\nD_{\\mathrm{closure}}\\, \\lambda_h(k) = D_{\\mathrm{eff}}(k,\\Delta x)\\, k^2\n$$\n求解 $D_{\\mathrm{eff}}(k,\\Delta x)$ 得：\n$$\nD_{\\mathrm{eff}}(k,\\Delta x) = D_{\\mathrm{closure}} \\frac{\\lambda_h(k)}{k^2}\n$$\n代入 $\\lambda_h(k)$ 的表达式：\n$$\nD_{\\mathrm{eff}}(k,\\Delta x) = D_{\\mathrm{closure}} \\frac{4 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x^2 k^2}\n$$\n为了分析当网格间距 $\\Delta x \\to 0$ 时与 $D_{\\mathrm{closure}}$ 的主阶偏差，我们对小 $x$ 的 $\\sin(x)$ 进行泰勒级数展开。令 $x = \\frac{k \\Delta x}{2}$。\n展开式为 $\\sin(x) = x - \\frac{x^3}{6} + \\mathcal{O}(x^5)$。\n则 $\\sin^2(x) = \\left(x - \\frac{x^3}{6} + \\dots\\right)^2 = x^2 - \\frac{x^4}{3} + \\mathcal{O}(x^6)$。\n将 $x = \\frac{k \\Delta x}{2}$ 代回：\n$$\n\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) = \\left(\\frac{k \\Delta x}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{k \\Delta x}{2}\\right)^4 + \\mathcal{O}((\\Delta x)^6) = \\frac{k^2 \\Delta x^2}{4} - \\frac{k^4 \\Delta x^4}{48} + \\mathcal{O}((\\Delta x)^6)\n$$\n现在我们将此式代入 $\\lambda_h(k)$ 的表达式中：\n$$\n\\lambda_h(k) = \\frac{4}{\\Delta x^2} \\left[ \\frac{k^2 \\Delta x^2}{4} - \\frac{k^4 \\Delta x^4}{48} + \\dots \\right] = k^2 - \\frac{k^4 \\Delta x^2}{12} + \\mathcal{O}((\\Delta x)^4)\n$$\n最后，我们将这个展开的 $\\lambda_h(k)$ 代入 $D_{\\mathrm{eff}}$ 的表达式中：\n$$\nD_{\\mathrm{eff}}(k,\\Delta x) = D_{\\mathrm{closure}} \\frac{k^2 - \\frac{k^4 \\Delta x^2}{12} + \\dots}{k^2} = D_{\\mathrm{closure}} \\left(1 - \\frac{k^2 \\Delta x^2}{12} + \\mathcal{O}((\\Delta x)^4)\\right)\n$$\n与 $D_{\\mathrm{closure}}$ 的主阶偏差为 $-\\frac{D_{\\mathrm{closure}} k^2 \\Delta x^2}{12}$。这表明二阶中心有限差分格式是欠扩散的（对于 $k \\ne 0$，$D_{\\mathrm{eff}}  D_{\\mathrm{closure}}$），意味着它施加的扩散比预期的要小，尤其是在较高波数（或较粗网格）下，并且扩散系数的误差在网格间距 $\\Delta x$ 上是二阶的。\n\n### 任务 B：波束的解析演化\n\n我们求解一维扩散方程 $\\frac{\\partial u}{\\partial t} = D_{\\mathrm{phys}} \\frac{\\partial^2 u}{\\partial n^2}$，其高斯初始条件为 $u(n,0) = \\exp\\left(-\\frac{n^2}{w_0^2}\\right)$。\n这是一个标准问题，使用傅里叶变换可以最优雅地解决。设 $\\hat{u}(k,t)$ 是 $u(n,t)$ 的傅里叶变换。偏微分方程变换为：\n$$\n\\frac{\\partial \\hat{u}}{\\partial t} = -D_{\\mathrm{phys}} k^2 \\hat{u}(k,t)\n$$\n这是一个关于时间的一阶常微分方程，对于每个波数 $k$ 的解为：\n$$\n\\hat{u}(k,t) = \\hat{u}(k,0) e^{-D_{\\mathrm{phys}} k^2 t}\n$$\n初始条件，即高斯函数 $A_0 e^{-n^2/w_0^2}$（其中 $A_0=1$）的傅里叶变换也是一个高斯函数：\n$$\n\\hat{u}(k,0) = \\mathcal{F}\\left[e^{-n^2/w_0^2}\\right](k) = \\sqrt{\\pi} w_0 e^{-k^2 w_0^2 / 4}\n$$\n将此代入傅里叶空间中随时间演化的解：\n$$\n\\hat{u}(k,t) = \\left(\\sqrt{\\pi} w_0 e^{-k^2 w_0^2 / 4}\\right) e^{-D_{\\mathrm{phys}} k^2 t} = \\sqrt{\\pi} w_0 e^{-k^2 \\left(\\frac{w_0^2}{4} + D_{\\mathrm{phys}} t\\right)}\n$$\n为了找到物理空间中的解，我们认识到这是形如 $u(n,t) = A(t) e^{-n^2/w(t)^2}$ 的高斯函数的傅里叶变换。其变换为 $\\hat{u}(k,t) = A(t) \\sqrt{\\pi} w(t) e^{-k^2 w(t)^2 / 4}$。\n通过比较 $\\hat{u}(k,t)$ 的两个表达式，我们令指数项和前置因子相等。\n从指数项：\n$$\n\\frac{w(t)^2}{4} = \\frac{w_0^2}{4} + D_{\\mathrm{phys}} t \\implies w(t)^2 = w_0^2 + 4 D_{\\mathrm{phys}} t\n$$\n因此，解析宽度为：\n$$\nw_{\\mathrm{anal}}(t) = \\sqrt{w_0^2 + 4 D_{\\mathrm{phys}} t}\n$$\n从前置因子：\n$$\nA(t) \\sqrt{\\pi} w(t) = \\sqrt{\\pi} w_0 \\implies A(t) = \\frac{w_0}{w(t)}\n$$\n因此，解析中心振幅为：\n$$\nA_{\\mathrm{anal}}(t) = \\frac{w_0}{\\sqrt{w_0^2 + 4 D_{\\mathrm{phys}} t}}\n$$\n\n### 任务 C：数值实验与评估\n\n数值模拟将使用谱方法进行。其核心原理是在傅里叶域中演化解，在傅里叶域中，扩散算子变成一个简单的乘法运算。\n\n1.  **离散化**：将长度为 $L = N \\Delta x$ 的周期性域离散化为 $N$ 个点。我们定义一个中心化的空间网格 $n_j = \\Delta x (j - N/2)$，其中 $j=0, \\dots, N-1$。相应的波数由 $k_m = 2\\pi m / L$ 给出，其中 $m=-N/2, \\dots, N/2-1$，这可以方便地通过 `numpy.fft.fftfreq` 生成。\n\n2.  **初始化**：在离散网格 $n$ 上计算初始高斯剖面 $u(n,0)$。为了正确使用 `numpy.fft` 库处理我们的中心化空间网格，空间数据在进行变换前必须使用 `ifftshift` 从 `[-N/2, ..., N/2-1]` 顺序重新排列为 `[0, ..., N/2-1, -N/2, ..., -1]` 顺序，并且输出必须使用 `fftshift` 移回。\n\n3.  **时间演化**：解在 $N_{\\mathrm{steps}} = T/\\Delta t$ 个步骤中从 $t=0$ 演化到 $t=T$。在傅里叶空间中，每一步对应于将傅里叶系数 $\\hat{u}(k)$ 乘以放大因子 $G_{\\mathrm{num}}(k)$。经过 $N_{\\mathrm{steps}}$ 步后，傅里叶空间中的最终状态为 $\\hat{u}(k,T) = \\hat{u}(k,0) \\cdot [G_{\\mathrm{num}}(k)]^{N_{\\mathrm{steps}}}$。\n\n4.  **最终状态分析**：\n    *   通过对 $\\hat{u}(k,T)$ 应用快速傅里叶逆变换，恢复数值解 $u(n,T)$。\n    *   数值振幅 $A_{\\mathrm{num}}(T)$ 是计算出的剖面 $u(n,T)$ 的最大值。\n    *   数值宽度 $w_{\\mathrm{num}}(T)$ 使用离散二阶矩估计器计算：\n        $$\n        w_{\\mathrm{num}}^2(T) = \\frac{2 \\sum_{j=0}^{N-1} n_j^2 u(n_j,T)}{\\sum_{j=0}^{N-1} u(n_j,T)}\n        $$\n        其中求和是对所有网格点进行的。\n    *   误差度量 $\\varepsilon_w = w_{\\mathrm{num}}(T) - w_{\\mathrm{anal}}(T)$ 和 $\\varepsilon_A = A_{\\mathrm{num}}(T) - A_{\\mathrm{anal}}(T)$ 量化了数值结果与解析结果之间的差异。\n    *   比率 $R_D = D_{\\mathrm{eff}}(k_{\\mathrm{rms}},\\Delta x)/D_{\\mathrm{phys}}$ 使用任务 A 中 $D_{\\mathrm{eff}}$ 的公式计算，并在初始高斯函数的均方根波数 $k_{\\mathrm{rms}} = \\sqrt{2}/w_0$ 处求值。该比率直接衡量了数值格式在波束主导尺度上的准确性。小于1的比率表示欠扩散，这导致数值模拟的波束比其解析对应物传播得更慢，衰减得更少。\n\n此过程为量化拉普拉斯算子的空间离散化所引入的数值误差提供了一个完整的框架。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of quantifying numerical diffusion for an internal tide beam\n    modeled by a 1D diffusion equation, comparing numerical and analytical results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path, fine resolution)\n        {'dx': 1.0, 'N': 2048, 'D_phys': 0.01, 'w0': 10.0, 'dt': 0.5, 'T': 100.0},\n        # Case 2 (coarse grid impact)\n        {'dx': 5.0, 'N': 2048, 'D_phys': 0.01, 'w0': 10.0, 'dt': 1.0, 'T': 200.0},\n        # Case 3 (near-high-wavenumber content)\n        {'dx': 2.0, 'N': 2048, 'D_phys': 0.01, 'w0': 2.0, 'dt': 0.5, 'T': 200.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        dx = case['dx']\n        N = case['N']\n        D_phys = case['D_phys']\n        w0 = case['w0']\n        dt = case['dt']\n        T = case['T']\n\n        # D_closure is set to be equal to D_phys as per the problem statement\n        D_closure = D_phys\n        \n        # --- Numerical Simulation ---\n\n        # 1. Grid and Initial Condition Setup\n        L = N * dx\n        # Centered spatial grid from -L/2 to L/2-dx\n        n = dx * (np.arange(N) - N / 2)\n        # Wavenumber grid in standard FFT order\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n        \n        # Initial condition: Gaussian profile, centered on the grid\n        u0 = np.exp(-n**2 / w0**2)\n        \n        # 2. Fourier Space Evolution\n        # Transform initial condition to Fourier space.\n        # We must reorder the centered u0 to standard [0, ..., N-1] order before FFT.\n        u0_hat = np.fft.fft(np.fft.ifftshift(u0))\n\n        # Number of time steps\n        n_steps = int(round(T / dt))\n\n        # Calculate the symbol of the discrete Laplacian\n        # Use a small epsilon to avoid division by zero at k=0, although sin(0)=0 handles it\n        lambda_h = (4 / dx**2) * np.sin(k * dx / 2)**2\n\n        # Calculate the one-step amplification factor for the implicit scheme\n        G_num = 1.0 / (1.0 + dt * D_closure * lambda_h)\n        \n        # Evolve in Fourier space for n_steps\n        uT_hat = u0_hat * (G_num**n_steps)\n\n        # 3. Transform back to physical space and analyze\n        # Inverse transform and reorder back to a centered profile\n        uT_numerical = np.fft.fftshift(np.fft.ifft(uT_hat)).real\n\n        # --- Calculation of Metrics ---\n        \n        # Numerical amplitude: maximum value of the final profile\n        A_num = np.max(uT_numerical)\n        \n        # Numerical width: using the second-moment estimator\n        # The dx terms in the discrete integral form cancel out\n        sum_uT = np.sum(uT_numerical)\n        sum_n2_uT = np.sum(n**2 * uT_numerical)\n        if sum_uT > 0:\n            w_num_sq = (2 * sum_n2_uT) / sum_uT\n            w_num = np.sqrt(w_num_sq)\n        else:\n            w_num = 0.0\n\n        # Analytical predictions at time T\n        w_anal_sq = w0**2 + 4 * D_phys * T\n        w_anal = np.sqrt(w_anal_sq)\n        A_anal = w0 / w_anal\n        \n        # Error metrics\n        eps_w = w_num - w_anal\n        eps_A = A_num - A_anal\n\n        # Ratio of effective numerical diffusivity to physical diffusivity\n        k_rms = np.sqrt(2) / w0\n        \n        # Use sinc(x) = sin(x)/x. R_D = sinc(k_rms * dx / 2)^2\n        arg = k_rms * dx / 2.0\n        if arg == 0:\n            R_D = 1.0\n        else:\n            sinc_val = np.sin(arg) / arg\n            R_D = sinc_val**2\n            \n        results.append([eps_w, eps_A, R_D])\n\n    # Format the final output string as a list of lists of floats\n    final_output_str = f\"[{','.join([f'[{e[0]},{e[1]},{e[2]}]' for e in results])}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}