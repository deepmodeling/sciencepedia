{
    "hands_on_practices": [
        {
            "introduction": "Explicit time-stepping schemes are common in numerical modeling, but their stability is governed by the fastest signal in the system. This practice  explores the Courant-Friedrichs-Lewy (CFL) condition, which links the physical speed of a barotropic Kelvin wave directly to the maximum allowable time step. By deriving this constraint, you will gain a concrete understanding of why fast-moving waves pose a significant computational challenge for climate-scale simulations.",
            "id": "3800496",
            "problem": "Consider an inviscid, linear, rotating shallow-water system on a constant-$f$ plane with uniform depth $H$ and gravitational acceleration $g$. Let the coastline be a straight boundary aligned with the $x$-axis at $y=0$, with a no-normal-flow boundary condition $v(x,0,t)=0$. Assume small perturbations with sea surface height $\\eta(x,y,t)$ and depth-averaged velocities $u(x,y,t)$ and $v(x,y,t)$ that satisfy the linearized rotating shallow-water equations:\n$$\nu_{t} - f v = - g \\,\\eta_{x}, \\quad v_{t} + f u = - g \\,\\eta_{y}, \\quad \\eta_{t} + H\\,(u_{x} + v_{y}) = 0,\n$$\nwhere subscripts denote partial derivatives. A coastal Kelvin wave is a boundary-trapped solution that decays offshore and propagates along the coast. Starting from the equations above, derive the non-dispersive phase speed $c$ of this Kelvin wave as a function of $g$ and $H$.\n\nNow consider the one-way alongshore propagation of the Kelvin wave envelope governed by the linear advection partial differential equation (PDE) $\\eta_{t} + c\\,\\eta_{x} = 0$. Discretize this PDE using a first-order upwind finite difference for space and forward Euler for time on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, assuming $c0$. Perform a von Neumann stability analysis of the resulting explicit scheme to determine the stability constraint on $\\Delta t$ in terms of $\\Delta x$ and $c$. In your derivation, explicitly introduce the Courant–Friedrichs–Lewy (CFL) number $\\lambda$ and the amplification factor, and obtain the condition under which the amplification factor has magnitude less than or equal to one for all Fourier modes.\n\nFinally, for a basin-scale model configured with $H = 4000\\,\\mathrm{m}$, $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$, and horizontal grid spacing $\\Delta x = 25\\,\\mathrm{km}$ along the coast, use your stability result to compute the largest stable explicit time step $\\Delta t_{\\max}$ that resolves the fast barotropic Kelvin wave. Round your numerical answer to four significant figures and express it in seconds. Briefly explain, based on your derivation, the implications of this stability constraint for resolving slow planetary Rossby waves within the same explicit model.",
            "solution": "The user has provided a multi-part problem concerning coastal Kelvin waves and the numerical stability of their simulation. The problem is scientifically sound, well-posed, and objective. It is a standard problem in geophysical fluid dynamics and computational methods. I will solve it in three parts as requested.\n\nPart 1: Derivation of the Kelvin Wave Phase Speed\n\nThe governing equations are the linearized rotating shallow-water equations on a constant-$f$ plane for an inviscid fluid of uniform depth $H$:\n$$u_{t} - f v = - g \\,\\eta_{x} \\quad (1)$$\n$$v_{t} + f u = - g \\,\\eta_{y} \\quad (2)$$\n$$\\eta_{t} + H\\,(u_{x} + v_{y}) = 0 \\quad (3)$$\nThe boundary condition is no-normal-flow at the coast $y=0$, which means $v(x,0,t) = 0$.\n\nA coastal Kelvin wave is a specific solution to this system that is trapped at the boundary and propagates along it. A defining characteristic of the Kelvin wave is that the cross-shore velocity is zero everywhere, i.e., $v(x,y,t) = 0$ for all $x, y, t$. This identically satisfies the boundary condition at $y=0$. With $v=0$, the system of equations simplifies considerably:\nFrom $(1)$: $u_{t} = -g\\eta_{x} \\quad (4)$\nFrom $(2)$: $f u = -g\\eta_{y} \\quad (5)$\nFrom $(3)$: $\\eta_{t} + H u_{x} = 0 \\quad (6)$\n\nEquation $(5)$ represents a geostrophic balance in the cross-shore ($y$) direction. Equations $(4)$ and $(6)$ describe the wave propagation in the along-shore ($x$) direction. To find the phase speed, we can combine $(4)$ and $(6)$. Differentiate $(6)$ with respect to $t$ and $(4)$ with respect to $x$:\n$$\\eta_{tt} + H u_{xt} = 0$$\n$$u_{tx} = -g \\eta_{xx}$$\nAssuming the fields are sufficiently smooth, the order of differentiation does not matter ($u_{xt} = u_{tx}$). Substituting the second into the first yields:\n$$\\eta_{tt} - gH \\eta_{xx} = 0$$\nThis is the one-dimensional wave equation for the sea surface height $\\eta$. The general solution describes waves propagating in the $\\pm x$ direction with a phase speed $c$ given by $c^2 = gH$. Therefore, the phase speed is:\n$$c = \\sqrt{gH}$$\nSince the phase speed $c$ does not depend on the wavenumber or frequency, the wave is non-dispersive.\n\nTo confirm the boundary-trapped nature, we examine equation $(5)$, $fu = -g\\eta_y$. We look for a solution propagating in the $+x$ direction, of the form $\\eta(x,y,t) = F(y)G(x-ct)$. From the wave equation, we know $u$ will also have this form. From $(4)$, $u_t = -c u'$, and $\\eta_x = \\eta'$, where prime denotes differentiation with respect to the argument $x-ct$. So, $-cu' = -g\\eta'$, which integrates to $u = (g/c)\\eta$ (assuming zero integration constant for a pure wave solution). Substituting this into $(5)$:\n$$f \\left(\\frac{g}{c}\\eta\\right) = -g \\frac{\\partial \\eta}{\\partial y}$$\n$$\\frac{\\partial \\eta}{\\partial y} = -\\frac{f}{c}\\eta$$\nThe solution for the offshore structure of $\\eta$ is $\\eta(x,y,t) = \\eta_0(x-ct) \\exp\\left(-\\frac{f}{c}y\\right)$. For the wave to be trapped at the coast (i.e., decay as $y \\rightarrow \\infty$), the exponent must be negative. Since $c=\\sqrt{gH}$ is positive and $y0$, this requires the Coriolis parameter $f$ to be positive. This corresponds to a wave propagating with the coast on its right in the Northern Hemisphere.\n\nPart 2: Von Neumann Stability Analysis\n\nThe problem asks to analyze the stability of the numerical scheme for the one-way advection equation $\\eta_t + c\\,\\eta_x=0$, where $c  0$. The scheme is forward Euler in time and first-order upwind in space.\nLet $\\eta_j^n$ denote the numerical solution at grid point $x_j=j\\Delta x$ and time $t_n=n\\Delta t$.\nThe forward Euler time difference is: $\\eta_t \\approx \\frac{\\eta_j^{n+1} - \\eta_j^n}{\\Delta t}$.\nSince the wave propagates in the $+x$ direction ($c0$), the \"upwind\" direction is the $-x$ direction. Therefore, we use a first-order backward difference for the spatial derivative: $\\eta_x \\approx \\frac{\\eta_j^n - \\eta_{j-1}^n}{\\Delta x}$.\n\nSubstituting these into the PDE gives the finite difference equation:\n$$\\frac{\\eta_j^{n+1} - \\eta_j^n}{\\Delta t} + c \\frac{\\eta_j^n - \\eta_{j-1}^n}{\\Delta x} = 0$$\nWe solve for $\\eta_j^{n+1}$:\n$$\\eta_j^{n+1} = \\eta_j^n - \\frac{c \\Delta t}{\\Delta x} (\\eta_j^n - \\eta_{j-1}^n)$$\nWe introduce the Courant–Friedrichs–Lewy (CFL) number, $\\lambda = \\frac{c \\Delta t}{\\Delta x}$. The equation becomes:\n$$\\eta_j^{n+1} = \\eta_j^n - \\lambda (\\eta_j^n - \\eta_{j-1}^n) = (1-\\lambda)\\eta_j^n + \\lambda \\eta_{j-1}^n$$\nFor the von Neumann stability analysis, we consider a single Fourier mode as a solution:\n$$\\eta_j^n = G^n e^{ik j \\Delta x}$$\nHere, $k$ is the wavenumber and $G$ is the complex amplification factor. A scheme is stable if $|G| \\le 1$ for all possible wavenumbers.\nSubstituting the Fourier mode into the difference equation:\n$$G^{n+1} e^{ik j \\Delta x} = (1-\\lambda) G^n e^{ik j \\Delta x} + \\lambda G^n e^{ik (j-1) \\Delta x}$$\nDividing by $G^n e^{ik j \\Delta x}$:\n$$G = (1-\\lambda) + \\lambda e^{-ik \\Delta x}$$\nLet the dimensionless wavenumber be $\\theta = k \\Delta x$. Then $e^{-ik \\Delta x} = \\cos(\\theta) - i\\sin(\\theta)$.\n$$G = (1-\\lambda) + \\lambda (\\cos(\\theta) - i\\sin(\\theta)) = (1-\\lambda + \\lambda\\cos(\\theta)) - i(\\lambda\\sin(\\theta))$$\nThe magnitude squared of the amplification factor is $|G|^2$:\n$$|G|^2 = (1-\\lambda + \\lambda\\cos(\\theta))^2 + (-\\lambda\\sin(\\theta))^2$$\n$$|G|^2 = (1-\\lambda)^2 + 2\\lambda(1-\\lambda)\\cos(\\theta) + \\lambda^2\\cos^2(\\theta) + \\lambda^2\\sin^2(\\theta)$$\n$$|G|^2 = (1-2\\lambda+\\lambda^2) + 2\\lambda(1-\\lambda)\\cos(\\theta) + \\lambda^2(\\cos^2(\\theta)+\\sin^2(\\theta))$$\n$$|G|^2 = 1-2\\lambda+\\lambda^2 + 2\\lambda\\cos(\\theta) - 2\\lambda^2\\cos(\\theta) + \\lambda^2$$\n$$|G|^2 = 1 - 2\\lambda(1-\\lambda)(1-\\cos\\theta)$$\nFor stability, we require $|G|^2 \\le 1$ for all real $\\theta$. This means:\n$$1 - 2\\lambda(1-\\lambda)(1-\\cos\\theta) \\le 1$$\n$$-2\\lambda(1-\\lambda)(1-\\cos\\theta) \\le 0$$\nSince $\\Delta t0$ and $\\Delta x0$, and we are given $c0$, the CFL number $\\lambda$ is positive. The term $(1-\\cos\\theta)$ is always non-negative for any real $\\theta$. Thus, we can divide the inequality by the non-positive term $-2(1-\\cos\\theta)$ (for $\\theta \\neq 2n\\pi$) and reverse the inequality sign, or we can analyze the factors. For the inequality to hold, the product $\\lambda(1-\\lambda)$ must be non-negative.\nSince $\\lambda  0$, we must have $1-\\lambda \\ge 0$, which implies $\\lambda \\le 1$.\nCombining the positivity of $\\lambda$ with this result, the stability condition is:\n$$0 \\le \\lambda \\le 1$$\nSubstituting back $\\lambda = \\frac{c \\Delta t}{\\Delta x}$:\n$$0 \\le \\frac{c \\Delta t}{\\Delta x} \\le 1$$\nThis yields the stability constraint on the time step $\\Delta t$:\n$$\\Delta t \\le \\frac{\\Delta x}{c}$$\n\nPart 3: Numerical Calculation and Implications\n\nFirst, we calculate the phase speed $c$ of the barotropic Kelvin wave using the given values $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$ and $H = 4000\\,\\mathrm{m}$.\n$$c = \\sqrt{gH} = \\sqrt{(9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2})(4000\\,\\mathrm{m})} = \\sqrt{39240\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}} \\approx 198.0909\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$$\nNext, we determine the largest stable time step, $\\Delta t_{\\max}$, using the stability constraint derived in Part 2. The grid spacing is given as $\\Delta x = 25\\,\\mathrm{km} = 25000\\,\\mathrm{m}$.\n$$\\Delta t_{\\max} = \\frac{\\Delta x}{c} = \\frac{25000\\,\\mathrm{m}}{198.0909\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} \\approx 126.204\\,\\mathrm{s}$$\nRounding to four significant figures, the largest stable time step is $126.2\\,\\mathrm{s}$.\n\nImplications for resolving slow planetary Rossby waves:\nThe stability of the explicit time-stepping scheme is dictated by the Courant–Friedrichs–Lewy (CFL) condition. This condition ensures that the numerical domain of dependence contains the physical domain of dependence. The constraint $\\Delta t \\le \\Delta x/c$ is determined by the fastest propagating wave in the system, which in this case is the barotropic Kelvin wave with a speed of approximately $200\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$. This results in a very small maximum allowable time step, $\\Delta t_{\\max} \\approx 2.1\\,\\mathrm{minutes}$.\n\nPlanetary Rossby waves, however, are much slower phenomena. Their propagation speeds are orders of magnitude smaller than the Kelvin wave speed, and their characteristic time scales are on the order of weeks to years. To simulate the evolution of these slow waves over climatologically relevant periods (e.g., decades), an enormous number of time steps would be required if the model is constrained by $\\Delta t_{\\max}$. For example, simulating one year would require approximately $(365 \\times 24 \\times 3600) / 126.2 \\approx 2.5 \\times 10^5$ steps. This makes the use of a simple explicit model computationally prohibitive for studying slow-moving Rossby waves. This issue, known as stiffness, where the system contains processes with vastly different time scales, is a major challenge in computational modeling of geophysical fluids. To overcome this, ocean models often employ semi-implicit or fully implicit time-stepping methods, or mode-splitting techniques that treat the fast and slow modes of the system differently, allowing for a much larger time step for the slow dynamics.",
            "answer": "$$\n\\boxed{126.2}\n$$"
        },
        {
            "introduction": "Regional ocean models are necessarily confined to finite domains, creating artificial \"open\" boundaries where the model meets the rest of the world ocean. This exercise  challenges you to think critically about how to design these boundaries to be transparent to outgoing waves. You will analyze how the distinct physics of Rossby and Kelvin waves dictate the success or failure of different boundary condition strategies, a crucial consideration for preventing spurious reflections that can contaminate a simulation.",
            "id": "3800501",
            "problem": "Consider a linear barotropic shallow-water model on a mid-latitude beta-plane for a rectangular basin occupying $0 \\le x \\le L$ and $0 \\le y \\le W$, with constant depth $H$ and Coriolis parameter $f = f_0 + \\beta y$. The governing equations for horizontal velocity $(u,v)$ and sea surface height $\\eta$ are the linear shallow-water equations,\n$$\nu_t - f v = - g \\eta_x, \\quad v_t + f u = - g \\eta_y, \\quad \\eta_t + H (u_x + v_y) = 0,\n$$\nwhere $g$ is gravitational acceleration, subscripts denote partial derivatives, and all variables represent barotropic fields. In the quasi-geostrophic long-wave limit appropriate to planetary waves, the leading-order horizontal momentum balance is geostrophic, $f_0 u \\approx - g \\eta_y$, $f_0 v \\approx g \\eta_x$, and the continuity equation couples to the geostrophic flow to control the evolution of barotropic potential vorticity anomalies. Define the barotropic deformation radius $R_d = \\sqrt{g H}/f_0$. In this limit, interior long barotropic planetary Rossby waves propagate predominantly westward with a characteristic group speed much smaller than the external gravity-wave phase speed $\\sqrt{g H}$, and coastal Kelvin waves are boundary-trapped solutions that require no-normal-flow at a straight wall and propagate along the boundary with along-boundary phase speed approximately $\\sqrt{g H}$ and cross-shore decay scale of order $R_d$.\n\nYou are asked to analyze how different open boundary condition choices influence the reflection and transmission of these planetary waves in two configurations:\n\n(i) An open western boundary at $x=0$ with $y=0$ and $y=W$ as solid walls enforcing $u_n = 0$, and $x=L$ as a solid wall.\n\n(ii) An open southern boundary at $y=0$ with $x=0$ and $x=L$ as solid walls enforcing $u_n = 0$, and $y=W$ as a solid wall.\n\nAt an open boundary, three classes of implementations are considered:\n\n(1) A gravity-wave radiation condition for sea level of Sommerfeld type, e.g., a one-way condition on $\\eta$ consistent with outgoing external gravity waves normal to the boundary, such as $\\eta_t + c \\, \\partial_n \\eta = 0$ with $c = \\sqrt{g H}$ and $\\partial_n$ the outward normal derivative.\n\n(2) An advective radiation condition applied to the barotropic potential vorticity-like variable associated with the quasi-geostrophic limit, designed to advect out the boundary-normal characteristic of long planetary waves. In practice, this can be posed schematically as $q_t + c_r \\, \\partial_n q = 0$ on the boundary for a suitable choice of $q$ representing the barotropic quasi-geostrophic potential vorticity anomaly and $c_r$ the estimated local Rossby characteristic normal speed, with no constraint on $\\eta$ other than compatibility.\n\n(3) A sponge layer occupying a strip of width $\\Delta$ adjacent to the open boundary, within which linear damping terms are added to the prognostic equations, e.g., $\\eta_t + H (u_x + v_y) = - \\eta/\\tau$ and similarly for $(u,v)$, where $\\tau$ is a damping timescale; outside the sponge the equations are undamped.\n\nAssume the following wave scenarios:\n\n(A) In configuration (i), a long barotropic planetary Rossby wave packet approaches the open western boundary from the interior, with negligible sea level amplitude compared to its vorticity signature and with group velocity directed toward $x=0$.\n\n(B) In configuration (ii), a coastal Kelvin wave packet in the Northern Hemisphere is initiated along the southern boundary and propagates eastward along $y=0$ with cross-shore decay on scale $R_d$, relying on the no-normal-flow wall condition for trapping.\n\nWhich of the following statements about reflection and transmission are most accurate given the physics above?\n\nA. At the open western boundary, enforcing a gravity-wave radiation condition of the form $\\eta_t + \\sqrt{g H} \\, \\partial_x \\eta = 0$ substantially reflects the incoming long barotropic Rossby wave packet because its dynamics are controlled by barotropic potential vorticity rather than external gravity-wave propagation; if a solid wall is replaced by such an open boundary along a coastline, a coastal Kelvin wave adjacent to that boundary is not trapped and leaks energy across the boundary, resulting in attenuation.\n\nB. Implementing a one-way advective radiation condition on the barotropic quasi-geostrophic potential vorticity anomaly $q$ at the open western boundary, with the radiation speed $c_r$ matched to the local boundary-normal Rossby characteristic, minimizes reflection of the incoming long Rossby wave packet; because coastal Kelvin waves carry relatively weak $q$ anomalies and have energy flux parallel to the boundary, this $q$-radiation boundary has little direct impact on Kelvin waves compared to gravity-wave radiation.\n\nC. A sponge layer with width $\\Delta \\ll$ the long Rossby wavelength and damping timescale $\\tau$ much shorter than the external gravity-wave period will absorb both the long Rossby wave and the coastal Kelvin wave with negligible reflection, providing nearly perfect transmission out of the domain.\n\nD. Prescribing a fixed sea surface height, $\\eta = 0$, as an open boundary condition at $x=0$ or $y=0$ is perfectly absorbing for long barotropic Rossby waves, while it transmits coastal Kelvin waves undamped because their along-boundary propagation does not require a sea level gradient at the boundary.\n\nSelect all correct options.",
            "solution": "The problem statement has been validated and is deemed sound. It presents a standard, well-posed problem in geophysical fluid dynamics concerning the behavior of oceanic planetary waves at open boundaries in a numerical model.\n\nThe core of the problem lies in the fundamental physical differences between Rossby waves and Kelvin waves, and how these differences determine their interaction with various open boundary conditions (OBCs).\n\n1.  **Barotropic Planetary Rossby Waves**: These are low-frequency waves whose dynamics are governed by the conservation of barotropic potential vorticity (PV). In the quasi-geostrophic (QG) limit, their propagation is best described by the advection of PV anomalies. Their characteristic westward group speed is slow, $c_r \\sim \\beta R_d^2 = \\beta g H / f_0^2$, which is much smaller than the external gravity wave speed $c = \\sqrt{gH}$. They are primarily a vorticity phenomenon, with relatively small associated sea surface height ($\\eta$) fluctuations.\n\n2.  **Coastal Kelvin Waves**: These are hybrid gravity-vorticity waves trapped at a boundary. They propagate non-dispersively along a boundary with the phase speed of external gravity waves, $c = \\sqrt{gH}$. In the Northern Hemisphere ($f_00$), they propagate with the boundary on their right. Their existence depends on a physical boundary (a \"wall\") that enforces a no-normal-flow condition ($u_n=0$), which allows for a cross-shore geostrophic balance between the Coriolis force and the pressure gradient force. This balance traps the wave. A key property of ideal linear Kelvin waves is that they have zero QG potential vorticity anomaly. Their energy is primarily in the form of sea surface height displacement and along-shore velocity.\n\nWe will now evaluate each statement based on these principles.\n\n### Option-by-Option Analysis\n\n**A. At the open western boundary, enforcing a gravity-wave radiation condition of the form $\\eta_t + \\sqrt{g H} \\, \\partial_x \\eta = 0$ substantially reflects the incoming long barotropic Rossby wave packet because its dynamics are controlled by barotropic potential vorticity rather than external gravity-wave propagation; if a solid wall is replaced by such an open boundary along a coastline, a coastal Kelvin wave adjacent to that boundary is not trapped and leaks energy across the boundary, resulting in attenuation.**\n\nThis statement consists of two parts.\n\n1.  **Reflection of Rossby waves**: The boundary condition specified is a Sommerfeld radiation condition, $\\eta_t - c_n \\partial_n \\eta = 0$, for waves leaving the domain. At a western boundary ($x=0$), the outward normal direction is $-x$, so the outward normal derivative is $\\partial_n \\equiv -\\partial_x$. The condition for an outgoing wave in the $-x$ direction with speed $c$ would be $\\eta_t - c \\eta_x = 0$. The prompt gives $\\eta_t + \\sqrt{g H} \\, \\partial_x \\eta = 0$, which describes a wave propagating *into* the domain in the $+x$ direction, unless the sign convention is different. However, the fundamental point is the choice of the propagation speed, $c = \\sqrt{g H}$. This is the speed of external gravity waves. As established, long Rossby waves are governed by PV dynamics and propagate at a much slower speed, $c_r \\ll \\sqrt{gH}$. Applying a boundary condition designed for fast gravity waves to slow, vorticity-dominated Rossby waves creates a dynamical mismatch. The incoming wave's PV field is not compatible with the pure $\\eta$-based, high-speed propagation assumed by the boundary condition. To satisfy this incompatible constraint, the model must generate spurious reflected waves. Thus, such a condition is known to be highly reflective for Rossby waves. The reasoning provided is correct.\n\n2.  **Leakage of Kelvin waves**: A coastal Kelvin wave's trapping mechanism fundamentally relies on a solid boundary where the normal velocity is zero. This wall allows the wave to \"lean\" against it, maintaining the cross-shore geostrophic balance $f u = -g \\eta_y$ (for a zonal boundary) that prevents the wave energy from dispersing into the interior. If this solid wall is replaced by an open boundary, even one that radiates gravity waves, the crucial no-normal-flow condition is lost. Without the wall, the trapping mechanism is broken. The wave energy will radiate away from the boundary, likely in the form of Poincaré or gravity waves, as it propagates along the now-open \"coastline.\" This leakage of energy results in the attenuation of the Kelvin wave packet. This part of the statement is also correct.\n\nBoth claims in this option are physically accurate.\n**Verdict: Correct.**\n\n**B. Implementing a one-way advective radiation condition on the barotropic quasi-geostrophic potential vorticity anomaly $q$ at the open western boundary, with the radiation speed $c_r$ matched to the local boundary-normal Rossby characteristic, minimizes reflection of the incoming long Rossby wave packet; because coastal Kelvin waves carry relatively weak $q$ anomalies and have energy flux parallel to the boundary, this $q$-radiation boundary has little direct impact on Kelvin waves compared to gravity-wave radiation.**\n\nAgain, we analyze two parts.\n\n1.  **Absorption of Rossby waves**: Since the dynamics of long Rossby waves are fundamentally about the advection of PV anomalies, an OBC that mimics this process should be highly effective. A one-way advective radiation condition on the PV anomaly $q$, such as $q_t - c_r q_x = 0$ at the western boundary $x=0$, directly formalizes the idea of letting PV anomalies advect out of the domain. If the speed $c_r$ is chosen to match the theoretical or observed group velocity of the incident Rossby waves, the boundary condition becomes \"transparent\" to these waves, leading to minimal reflection. This is a standard and effective technique in numerical modeling of large-scale ocean circulation.\n\n2.  **Impact on Kelvin waves**: For an ideal linear coastal Kelvin wave propagating in the $x$-direction, the velocity field is $(u, 0)$ and the cross-shore geostrophic balance is $f_0 u = -g\\eta_y$. The linearized QG potential vorticity anomaly is $q' = \\zeta' - \\frac{f_0}{H}\\eta$, where $\\zeta' = \\partial_x v - \\partial_y u = -u_y$ is the relative vorticity anomaly. For a Kelvin wave, the structure is of the form $u(x,y,t) = \\hat{u}(x,t) e^{-y/R_d}$ and $\\eta(x,y,t) = \\hat{\\eta}(x,t) e^{-y/R_d}$, where $R_d = \\sqrt{gH}/f_0$ is the deformation radius.\n    From the cross-shore geostrophy, we find $f_0 u = -g (-\\eta/R_d)$, so $u = (g/(f_0 R_d))\\eta$.\n    The vorticity is $\\zeta' = -u_y = -(-\\hat{u}/R_d)e^{-y/R_d} = u/R_d$.\n    Substituting into the PV anomaly expression:\n    $$q' = \\zeta' - \\frac{f_0}{H}\\eta = \\frac{u}{R_d} - \\frac{f_0}{H} \\left( \\frac{f_0 R_d}{g} u \\right) = \\frac{u}{R_d} - \\frac{f_0^2 R_d}{gH} u$$\n    Using the definition $R_d^2 = gH/f_0^2$, we get:\n    $$q' = \\frac{u}{R_d} - \\frac{1}{R_d^2} R_d u = \\frac{u}{R_d} - \\frac{u}{R_d} = 0$$\n    An ideal Kelvin wave has exactly zero QG potential vorticity anomaly. Therefore, a boundary condition that seeks to radiate $q$ will have no effect, as there is no anomaly to radiate. The statement that they carry \"relatively weak\" $q$ anomalies is a conservative but correct way to phrase this, and the conclusion that the OBC has little impact is accurate. Furthermore, the energy flux vector for a Kelvin wave is parallel to the boundary, so there is no energy flux impinging on the boundary that would need to be transmitted.\n\nBoth claims in this option are physically accurate.\n**Verdict: Correct.**\n\n**C. A sponge layer with width $\\Delta \\ll$ the long Rossby wavelength and damping timescale $\\tau$ much shorter than the external gravity-wave period will absorb both the long Rossby wave and the coastal Kelvin wave with negligible reflection, providing nearly perfect transmission out of the domain.**\n\nA sponge layer (or viscous damping layer) absorbs wave energy by adding a damping term to the equations. To be effective (i.e., non-reflective), the damping must be introduced gradually. An abrupt change in the governing equations is perceived by a wave as a change in the medium, which causes reflection.\n1.  **Sponge width**: The condition $\\Delta \\ll \\lambda_R$, where $\\lambda_R$ is the Rossby wavelength, means the sponge layer is very thin compared to the wave it is supposed to absorb. A wave with a long wavelength will encounter this thin layer as a sudden, sharp feature, not a gradual damping. This will lead to significant reflection. For effective absorption of a wave of wavelength $\\lambda$, the sponge width $\\Delta$ must be on the order of or larger than $\\lambda$.\n2.  **Damping timescale**: The condition that $\\tau$ is \"much shorter than the external gravity-wave period\" implies a very strong damping coefficient ($1/\\tau$). Strong, abrupt damping is also a source of reflection. An ideal sponge layer has a damping coefficient that increases slowly from zero at the interface with the model interior to a maximum value at the open boundary over the width $\\Delta$.\n\nThe conditions described in this option—a thin width and strong damping—are characteristic of a *highly reflective* sponge layer, not one with \"negligible reflection.\" Such a setup would perform poorly.\n**Verdict: Incorrect.**\n\n**D. Prescribing a fixed sea surface height, $\\eta = 0$, as an open boundary condition at $x=0$ or $y=0$ is perfectly absorbing for long barotropic Rossby waves, while it transmits coastal Kelvin waves undamped because their along-boundary propagation does not require a sea level gradient at the boundary.**\n\n1.  **Absorption of Rossby waves**: An incoming Rossby wave has an associated sea level structure $\\eta(x,y,t)$. Imposing the condition $\\eta=0$ at the boundary is a \"clamping\" condition. It forces the solution to a fixed value, irrespective of the incoming wave dynamics. The wave's energy must be redistributed to satisfy this artificial constraint, which is accomplished by generating reflected waves. A condition $\\eta=0$ is analogous to a free surface condition in some contexts, but it is not a non-reflecting or absorbing boundary condition. Therefore, it is not \"perfectly absorbing.\"\n\n2.  **Transmission of Kelvin waves**: A Kelvin wave propagating along a boundary has a non-zero sea level signature $\\eta$ at that boundary; in fact, its amplitude is maximum there. Forcing $\\eta=0$ along its path is directly contradictory to the wave's existence and would completely disrupt or destroy it, causing significant reflection and scattering, not undamped transmission. The supplied justification \"...because their along-boundary propagation does not require a sea level gradient at the boundary\" is also false. The along-shore momentum equation for a Kelvin wave is $u_t = -g\\eta_x$. A non-zero along-shore sea level gradient $\\eta_x$ is what drives the acceleration of the fluid parcels and thus is essential for the wave's propagation.\n\nBoth claims in this option, along with the given reasoning, are physically incorrect.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "The final test of any numerical model is its ability to reproduce known physics. This comprehensive numerical experiment  guides you through the process of verifying a model's dynamic fidelity. You will launch a Rossby wave packet and use sophisticated wavenumber–frequency diagnostics to measure its group velocity from the simulation data, providing a powerful method for validating your code against analytical theory.",
            "id": "3800483",
            "problem": "You are to design and implement a numerical experiment that launches a planetary-scale Rossby wave packet on a midlatitude beta-plane and measures the zonal group velocity using wavenumber–frequency diagnostics. The mathematical and computational starting point must be the linear quasi-geostrophic potential vorticity equation on a beta-plane. Assume a baroclinic deformation radius $R_d$ is finite and constant, and use geostrophic streamfunction $\\psi(x,y,t)$ as the prognostic variable for the wave packet. All physical quantities must be expressed in International System of Units (SI), with lengths in meters and times in seconds.\n\nFundamental base and governing equation:\n- Begin from the quasi-geostrophic potential vorticity $q(x,y,t)$ defined by $q = \\nabla^2 \\psi - \\psi / R_d^2$, where $\\nabla^2$ is the two-dimensional Laplacian in a Cartesian coordinate system with $x$ as zonal distance and $y$ as meridional distance.\n- On a beta-plane at latitude $\\varphi_0$, the linear evolution of $q$ is governed by $q_t + \\beta \\psi_x = 0$, where $\\beta = \\left. \\frac{\\partial f}{\\partial y} \\right|_{\\varphi_0}$ is the meridional gradient of the Coriolis parameter $f$; the subscript denotes partial differentiation.\n- The experiment must excite a localized, small-amplitude wave packet centered at $(x_0,y_0)$ with a Gaussian envelope and a monochromatic carrier in both $x$ and $y$ directions, i.e., initialize $\\psi(x,y,0)$ as a real-valued Gaussian envelope multiplied by a cosine carrier with specified zonal and meridional wavenumbers.\n\nWavenumber–frequency diagnostics:\n- Construct a one-dimensional space–time dataset $s(x,t)$ by sampling $\\psi(x,y,t)$ along a fixed meridional transect at $y=y_0$ over a finite time interval $t \\in [0,T]$.\n- Compute the two-dimensional discrete Fourier transform in $(x,t)$ to obtain spectral power as a function of zonal wavenumber $k_x$ and temporal frequency $\\omega$.\n- Identify the dominant frequency for three neighboring discrete zonal wavenumbers around the packet’s carrier wavenumber, and estimate the zonal group velocity $c_{gx}$ in meters per second as a finite-difference slope $c_{gx} \\approx \\Delta \\omega / \\Delta k_x$ based on the ridge of maximal spectral power.\n\nAnalytical prediction:\n- Starting from the governing equation stated above, derive the dispersion relation for plane-wave solutions and then derive an analytical expression for the zonal group velocity $c_{gx}(k_x,k_y)$ as the appropriate partial derivative of frequency with respect to zonal wavenumber. Use this analytical $c_{gx}$ to predict the group velocity at the packet’s carrier $(k_0,l_0)$.\n- The program must compare the measured $c_{gx}$ against the analytical $c_{gx}$ at $(k_0,l_0)$ and return the absolute error in meters per second.\n\nNumerical requirements:\n- Use a doubly periodic rectangular domain with lengths $L_x$ and $L_y$, and uniform grids of $N_x$ and $N_y$ points, respectively. Use a uniform time step $\\Delta t$ and $N_t$ steps covering $T=N_t \\Delta t$.\n- Evolve $\\psi$ spectrally in time by integrating the linear dynamics implied by the stated governing equation. You may use exact spectral phase evolution implied by the linear operator, or a sufficiently accurate time integrator for the linear ordinary differential equation in spectral space. Ensure numerical parameters are chosen to resolve the packet and its spectral ridge in $(k_x,\\omega)$.\n- For spectral diagnostics, apply separable tapering windows in both $x$ and $t$ prior to the discrete Fourier transform to minimize leakage. Use Hann windows or equivalent tapering functions.\n\nUnits and outputs:\n- All inputs and outputs must use SI units. Express the final group velocity in meters per second.\n- Your program must produce a single line of output containing the absolute errors for the test suite as a comma-separated list enclosed in square brackets, where each entry is rounded to six decimal places (e.g., \"[0.123456,0.000001,0.010203]\").\n\nTest suite:\nImplement the following three parameter sets to ensure coverage across typical, boundary, and sign-change scenarios. For each case, use a Gaussian envelope width $\\sigma=1.0\\times 10^6$ meters and packet center $(x_0,y_0)=(L_x/2,L_y/2)$. Use amplitude $A=1.0\\times 10^5$ square meters per second for the initial streamfunction.\n\n- Case 1 (typical midlatitude packet):\n    - $L_x = 1.0\\times 10^7$ meters, $L_y = 8.0\\times 10^6$ meters, $N_x=256$, $N_y=128$.\n    - $\\Delta t = 2.16\\times 10^4$ seconds, $N_t = 240$.\n    - $\\beta = 2.0\\times 10^{-11}$ per meter per second, $R_d = 2.0\\times 10^6$ meters.\n    - Carrier wavenumbers: $k_0 = 2\\pi / (3.0\\times 10^6)$ radians per meter, $l_0 = 0.0$ radians per meter.\n\n- Case 2 (anisotropic packet with westward carrier):\n    - $L_x = 1.0\\times 10^7$ meters, $L_y = 8.0\\times 10^6$ meters, $N_x=256$, $N_y=128$.\n    - $\\Delta t = 2.16\\times 10^4$ seconds, $N_t = 240$.\n    - $\\beta = 2.0\\times 10^{-11}$ per meter per second, $R_d = 1.5\\times 10^6$ meters.\n    - Carrier wavenumbers: $k_0 = -2\\pi / (4.0\\times 10^6)$ radians per meter, $l_0 = 2\\pi / (6.0\\times 10^6)$ radians per meter.\n\n- Case 3 (nearly barotropic long-wave limit):\n    - $L_x = 1.0\\times 10^7$ meters, $L_y = 8.0\\times 10^6$ meters, $N_x=256$, $N_y=128$.\n    - $\\Delta t = 2.16\\times 10^4$ seconds, $N_t = 240$.\n    - $\\beta = 2.0\\times 10^{-11}$ per meter per second, $R_d = 1.0\\times 10^9$ meters.\n    - Carrier wavenumbers: $k_0 = 2\\pi / (8.0\\times 10^6)$ radians per meter, $l_0 = 2\\pi / (8.0\\times 10^6)$ radians per meter.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets, with each entry being the absolute error between measured and analytical zonal group velocity in meters per second, rounded to six decimal places, in the order of the cases listed above (i.e., \"[error_case1,error_case2,error_case3]\").",
            "solution": "The problem requires the design of a numerical experiment to measure the zonal group velocity of a planetary Rossby wave packet and compare it to the analytical prediction. The process involves three main stages: deriving the analytical solution, performing a numerical simulation, and analyzing the simulation output to measure the group velocity.\n\n### **1. Analytical Derivation**\n\nThe governing physics are described by the linear quasi-geostrophic potential vorticity (QGPV) equation on a beta-plane. The potential vorticity $q$ is related to the streamfunction $\\psi(x,y,t)$ by:\n$$q(x,y,t) = \\nabla^2 \\psi - \\frac{1}{R_d^2} \\psi$$\nwhere $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ is the Laplacian operator and $R_d$ is the baroclinic deformation radius. The linear evolution of $q$ is given by:\n$$\\frac{\\partial q}{\\partial t} + \\beta \\frac{\\partial \\psi}{\\partial x} = 0$$\nwhere $\\beta$ is the constant meridional gradient of the Coriolis parameter.\n\nTo find the dispersion relation for plane waves, we substitute the QGPV definition into the evolution equation:\n$$\\frac{\\partial}{\\partial t} \\left(\\nabla^2 \\psi - \\frac{1}{R_d^2} \\psi\\right) + \\beta \\frac{\\partial \\psi}{\\partial x} = 0$$\nWe seek plane-wave solutions of the form $\\psi(x,y,t) = \\hat{\\psi} e^{i(k_x x + k_y y - \\omega t)}$, where $\\hat{\\psi}$ is the constant amplitude, $k_x$ and $k_y$ are the zonal and meridional wavenumbers, and $\\omega$ is the temporal frequency. Substituting this into the equation yields:\n$$-i\\omega \\left( -(k_x^2 + k_y^2) - \\frac{1}{R_d^2} \\right) \\hat{\\psi} e^{i(\\dots)} + \\beta (ik_x) \\hat{\\psi} e^{i(\\dots)} = 0$$\nDividing by $i\\hat{\\psi}e^{i(\\dots)}$ (assuming a non-trivial solution) gives:\n$$\\omega \\left( k_x^2 + k_y^2 + \\frac{1}{R_d^2} \\right) + \\beta k_x = 0$$\nSolving for $\\omega$ gives the dispersion relation for Rossby waves:\n$$\\omega(k_x, k_y) = - \\frac{\\beta k_x}{k_x^2 + k_y^2 + R_d^{-2}}$$\n\nThe zonal group velocity, $c_{gx}$, is the partial derivative of the frequency with respect to the zonal wavenumber:\n$$c_{gx}(k_x, k_y) = \\frac{\\partial \\omega}{\\partial k_x}$$\nUsing the quotient rule for differentiation on the expression for $\\omega(k_x, k_y)$:\n$$c_{gx} = \\frac{(-\\beta)(k_x^2 + k_y^2 + R_d^{-2}) - (-\\beta k_x)(2k_x)}{(k_x^2 + k_y^2 + R_d^{-2})^2}$$\nSimplifying the numerator, we obtain the analytical expression for the zonal group velocity:\n$$c_{gx}(k_x, k_y) = \\frac{\\beta (k_x^2 - k_y^2 - R_d^{-2})}{(k_x^2 + k_y^2 + R_d^{-2})^2}$$\nThis expression will be used to calculate the predicted group velocity for each test case at its carrier wavenumbers $(k_0, l_0)$.\n\n### **2. Numerical Simulation Design**\n\nThe simulation evolves the initial wave packet forward in time. A spectral method is employed for its accuracy and efficiency in solving linear, constant-coefficient partial differential equations on periodic domains.\n\n#### **2.1. Time Evolution in Spectral Space**\nThe governing equation in Fourier (wavenumber) space is an ordinary differential equation (ODE) for the Fourier transform of the streamfunction, $\\hat{\\psi}(k_x, k_y, t)$. Transforming the governing PDE gives:\n$$\\frac{d\\hat{\\psi}}{dt} = -i\\omega(k_x, k_y)\\hat{\\psi}$$\nwhere $\\omega(k_x, k_y)$ is the frequency derived previously. This linear ODE has the exact solution:\n$$\\hat{\\psi}(k_x, k_y, t) = \\hat{\\psi}(k_x, k_y, 0) e^{-i\\omega(k_x, k_y) t}$$\nThe numerical algorithm thus consists of:\n1.  Defining an initial condition $\\psi(x, y, 0)$ in physical space.\n2.  Computing its $2$D Fast Fourier Transform (FFT) to get $\\hat{\\psi}(k_x, k_y, 0)$.\n3.  For each desired time $t$, calculating $\\hat{\\psi}(k_x, k_y, t)$ using the exact phase evolution formula above.\n4.  Applying an inverse $2$D FFT to obtain the physical space solution $\\psi(x, y, t)$.\n\n#### **2.2. Initial Condition**\nThe initial streamfunction $\\psi(x,y,0)$ is a Gaussian-modulated wave packet centered at $(x_0, y_0)=(L_x/2, L_y/2)$:\n$$\\psi(x,y,0) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{2\\sigma^2}\\right) \\cos(k_0 (x-x_0) + l_0(y-y_0))$$\nwhere $A$ is the amplitude, $\\sigma$ is the envelope width, and $(k_0,l_0)$ are the carrier wavenumbers.\n\n### **3. Wavenumber–Frequency Diagnostics**\n\nThe zonal group velocity is measured from the simulation output using spectral analysis.\n\n1.  **Data Collection**: A one-dimensional space-time dataset $s(x,t) = \\psi(x, y_0, t)$ is created by recording the streamfunction along the central zonal transect $y=y_0$ at each time step.\n2.  **Windowing**: To mitigate spectral leakage from the finite duration and length of the dataset, a $2$D Hann window is applied to $s(x,t)$. The window is separable, formed by the outer product of two $1$D Hann windows, one for the time dimension and one for the spatial dimension.\n3.  **Spectral Analysis**: The $2$D FFT of the windowed dataset $s(x,t)$ is computed to get the complex spectrum $S(k_x, \\omega)$. The power spectrum is then $P(k_x, \\omega) = |S(k_x, \\omega)|^2$.\n4.  **Group Velocity Estimation**: The group velocity is the slope of the ridge of maximum power in the $(k_x, \\omega)$ plane. To estimate this slope, we identify the discrete zonal wavenumber $k_{d0}$ closest to the carrier wavenumber $k_0$. We then find the frequencies, $\\omega_{-1}$ and $\\omega_{+1}$, corresponding to the maximum spectral power at the neighboring discrete wavenumbers $k_{d0} - \\Delta k_x$ and $k_{d0} + \\Delta k_x$, where $\\Delta k_x$ is the zonal wavenumber grid spacing. The numerical group velocity is estimated using a centered finite-difference approximation:\n$$c_{gx, \\text{measured}} \\approx \\frac{\\omega_{+1} - \\omega_{-1}}{(k_{d0} + \\Delta k_x) - (k_{d0} - \\Delta k_x)} = \\frac{\\omega_{+1} - \\omega_{-1}}{2\\Delta k_x}$$\n\nFinally, the absolute error is calculated as $|c_{gx, \\text{measured}} - c_{gx, \\text{analytical}}|$. This entire procedure is implemented for each of the three test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        { # Case 1\n            \"Lx\": 1.0e7, \"Ly\": 8.0e6, \"Nx\": 256, \"Ny\": 128,\n            \"dt\": 2.16e4, \"Nt\": 240,\n            \"beta\": 2.0e-11, \"Rd\": 2.0e6,\n            \"k0\": 2 * np.pi / (3.0e6), \"l0\": 0.0,\n            \"A\": 1.0e5, \"sigma\": 1.0e6\n        },\n        { # Case 2\n            \"Lx\": 1.0e7, \"Ly\": 8.0e6, \"Nx\": 256, \"Ny\": 128,\n            \"dt\": 2.16e4, \"Nt\": 240,\n            \"beta\": 2.0e-11, \"Rd\": 1.5e6,\n            \"k0\": -2 * np.pi / (4.0e6), \"l0\": 2 * np.pi / (6.0e6),\n            \"A\": 1.0e5, \"sigma\": 1.0e6\n        },\n        { # Case 3\n            \"Lx\": 1.0e7, \"Ly\": 8.0e6, \"Nx\": 256, \"Ny\": 128,\n            \"dt\": 2.16e4, \"Nt\": 240,\n            \"beta\": 2.0e-11, \"Rd\": 1.0e9,\n            \"k0\": 2 * np.pi / (8.0e6), \"l0\": 2 * np.pi / (8.0e6),\n            \"A\": 1.0e5, \"sigma\": 1.0e6\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        error = run_and_analyze_case(case_params)\n        results.append(f\"{error:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef run_and_analyze_case(params):\n    \"\"\"\n    Runs the simulation and analysis for a single test case.\n    \"\"\"\n    # Unpack parameters\n    Lx, Ly, Nx, Ny = params[\"Lx\"], params[\"Ly\"], params[\"Nx\"], params[\"Ny\"]\n    dt, Nt = params[\"dt\"], params[\"Nt\"]\n    beta, Rd = params[\"beta\"], params[\"Rd\"]\n    k0, l0 = params[\"k0\"], params[\"l0\"]\n    A, sigma = params[\"A\"], params[\"sigma\"]\n\n    x0, y0 = Lx / 2.0, Ly / 2.0\n\n    # 1. Analytical Group Velocity\n    def analytical_cgx(k_x, k_y, b, R_d):\n        k_sq = k_x**2 + k_y**2\n        R_d_inv_sq = 1.0 / R_d**2\n        denom_term = k_sq + R_d_inv_sq\n        \n        num = b * (k_x**2 - k_y**2 - R_d_inv_sq)\n        den = denom_term**2\n        return num / den\n\n    cgx_analytical = analytical_cgx(k0, l0, beta, Rd)\n\n    # 2. Numerical Simulation\n    # Spatial grids and wavenumbers\n    dx, dy = Lx / Nx, Ly / Ny\n    x = np.arange(Nx) * dx\n    y = np.arange(Ny) * dy\n    xx, yy = np.meshgrid(x, y)\n\n    kx_vec = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n    ky_vec = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n    kx, ky = np.meshgrid(kx_vec, ky_vec)\n\n    # Initial condition\n    psi0 = A * np.exp(-((xx - x0)**2 + (yy - y0)**2) / (2 * sigma**2)) * \\\n           np.cos(k0 * (xx - x0) + l0 * (yy - y0))\n           \n    # Time evolution using exact spectral solution\n    psi0_hat = np.fft.fft2(psi0)\n    \n    # Dispersion relation omega(kx, ky)\n    K_sq = kx**2 + ky**2\n    denom_omega = K_sq + 1.0/Rd**2\n    omega = np.zeros_like(denom_omega, dtype=float)\n    mask = (denom_omega != 0)\n    omega[mask] = -beta * kx[mask] / denom_omega[mask]\n\n    # Store transect data s(x,t)\n    y_idx_center = Ny // 2\n    s_xt = np.zeros((Nt, Nx), dtype=float)\n    t_vec = np.arange(Nt) * dt\n\n    for i, t in enumerate(t_vec):\n        psi_hat_t = psi0_hat * np.exp(-1j * omega * t)\n        psi_t = np.fft.ifft2(psi_hat_t)\n        s_xt[i, :] = np.real(psi_t[y_idx_center, :])\n        \n    # 3. Wavenumber-Frequency Diagnostics\n    # Apply Hann window\n    window_t = np.hanning(Nt)\n    window_x = np.hanning(Nx)\n    window_2d = window_t[:, np.newaxis] * window_x[np.newaxis, :]\n    s_xt_windowed = s_xt * window_2d\n    \n    # 2D FFT and power spectrum\n    S_kw = np.fft.fftshift(np.fft.fft2(s_xt_windowed))\n    power_spectrum = np.abs(S_kw)**2\n    \n    # Diagnostic wavenumber and frequency axes\n    k_diag_vec = 2 * np.pi * np.fft.fftshift(np.fft.fftfreq(Nx, d=dx))\n    om_diag_vec = 2 * np.pi * np.fft.fftshift(np.fft.fftfreq(Nt, d=dt))\n    \n    # Find indices and wavenumbers for finite difference\n    idx_k0_carrier = np.argmin(np.abs(k_diag_vec - k0))\n    idx_k_minus = idx_k0_carrier - 1\n    idx_k_plus = idx_k0_carrier + 1\n    \n    # Find peak frequencies at neighboring wavenumbers\n    idx_w_minus = np.argmax(power_spectrum[:, idx_k_minus])\n    idx_w_plus = np.argmax(power_spectrum[:, idx_k_plus])\n    \n    k_minus = k_diag_vec[idx_k_minus]\n    k_plus = k_diag_vec[idx_k_plus]\n    w_minus = om_diag_vec[idx_w_minus]\n    w_plus = om_diag_vec[idx_w_plus]\n    \n    # Measured group velocity using centered difference\n    dk = k_plus - k_minus\n    dw = w_plus - w_minus\n    cgx_measured = dw / dk if dk != 0 else 0.0\n        \n    # 4. Absolute Error\n    error = np.abs(cgx_measured - cgx_analytical)\n    return error\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}