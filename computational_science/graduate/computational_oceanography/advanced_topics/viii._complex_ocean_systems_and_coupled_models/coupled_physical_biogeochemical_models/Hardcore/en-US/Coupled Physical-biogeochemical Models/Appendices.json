{
    "hands_on_practices": [
        {
            "introduction": "Before coupling biogeochemistry with complex physical transport, it is crucial to understand the intrinsic dynamics of the reaction network itself. This exercise focuses on the 'reaction' operator of a Nutrient-Phytoplankton-Zooplankton-Detritus (NPZD) model. By constructing the Jacobian matrix and analyzing its eigenvalues, you will learn to diagnose local stability, identify characteristic timescales, and assess numerical stiffness, all of which are critical for selecting stable and efficient numerical integration schemes .",
            "id": "3789535",
            "problem": "Consider a zero-dimensional reaction-only Nutrient–Phytoplankton–Zooplankton–Detritus (NPZD) model commonly used in computational oceanography to represent coupled physical–biogeochemical dynamics in the absence of transport. Let the state vector be $\\mathbf{C} = (N, P, Z, D)^{\\top}$, where $N$ is dissolved inorganic nitrogen, $P$ is phytoplankton biomass, $Z$ is zooplankton biomass, and $D$ is detrital nitrogen, all measured in $\\mathrm{mmol\\ N\\ m^{-3}}$. The reaction operator $\\mathbf{R}(\\mathbf{C})$ is defined by the following mass-conserving processes:\n- Nutrient uptake by phytoplankton, with nutrient-limited growth rate $\\mu(N) = \\mu_{\\max}\\, \\frac{N}{K_N + N}$,\n- Linear phytoplankton mortality at rate $m_P$,\n- Negligible grazing (early-bloom scenario), represented by $g = 0$,\n- Linear zooplankton mortality at rate $m_Z$,\n- Negligible remineralization on the timescale of interest, represented by $\\gamma = 0$.\n\nUnder these assumptions, the reaction terms are\n$$\nR_N = -\\mu(N)\\, P, \\quad\nR_P = \\alpha\\, \\mu(N)\\, P - m_P\\, P, \\quad\nR_Z = -m_Z\\, Z, \\quad\nR_D = (1-\\alpha)\\, \\mu(N)\\, P + m_P\\, P + m_Z\\, Z,\n$$\nwhere $0  \\alpha  1$ is the phytoplankton growth assimilation efficiency.\n\nYou are given the parameter values\n$$\n\\mu_{\\max} = 1.0\\ \\mathrm{day^{-1}}, \\quad K_N = 1.0\\ \\mathrm{mmol\\ N\\ m^{-3}}, \\quad \\alpha = 0.6, \\quad m_P = 0.5\\ \\mathrm{day^{-1}}, \\quad m_Z = 0.3\\ \\mathrm{day^{-1}}, \\quad g = 0\\ \\mathrm{day^{-1}}, \\quad \\gamma = 0\\ \\mathrm{day^{-1}}.\n$$\nEvaluate the Jacobian matrix $\\partial \\mathbf{R}/\\partial \\mathbf{C}$ at the state\n$$\nN^{\\ast} = 1.0\\ \\mathrm{mmol\\ N\\ m^{-3}}, \\quad P^{\\ast} = 2.0\\ \\mathrm{mmol\\ N\\ m^{-3}}, \\quad Z^{\\ast} = 0.5\\ \\mathrm{mmol\\ N\\ m^{-3}}, \\quad D^{\\ast} = 1.0\\ \\mathrm{mmol\\ N\\ m^{-3}}.\n$$\n\nStarting from mass-balance principles and local linearization of the nonlinear reaction operator, construct the Jacobian $\\partial \\mathbf{R}/\\partial \\mathbf{C}$ at $(N^{\\ast}, P^{\\ast}, Z^{\\ast}, D^{\\ast})$, determine its eigenvalues, and interpret their magnitudes and signs in terms of local stiffness and decay or growth modes. Then, using linear stability analysis of the Forward Euler (FE) time discretization applied to the linearized system $\\dot{\\mathbf{c}} = \\mathbf{J}\\, \\mathbf{c}$, determine the maximum stable time step $\\Delta t_{\\max}$ implied by the eigenvalues of the Jacobian at this state.\n\nExpress $\\Delta t_{\\max}$ in hours, and round your final numerical value to four significant figures. Use day as the base time unit for reaction rates before conversion to hours in your final answer.",
            "solution": "The problem is subjected to validation before proceeding with a solution.\n\n**Step 1: Extract Givens**\n- **State Vector:** $\\mathbf{C} = (N, P, Z, D)^{\\top}$\n- **Reaction Terms:**\n  $R_N = -\\mu(N)\\, P$\n  $R_P = \\alpha\\, \\mu(N)\\, P - m_P\\, P$\n  $R_Z = -m_Z\\, Z$\n  $R_D = (1-\\alpha)\\, \\mu(N)\\, P + m_P\\, P + m_Z\\, Z$\n- **Phytoplankton Growth Rate:** $\\mu(N) = \\mu_{\\max}\\, \\frac{N}{K_N + N}$\n- **Parameter Values:**\n  $\\mu_{\\max} = 1.0\\ \\mathrm{day^{-1}}$\n  $K_N = 1.0\\ \\mathrm{mmol\\ N\\ m^{-3}}$\n  $\\alpha = 0.6$\n  $m_P = 0.5\\ \\mathrm{day^{-1}}$\n  $m_Z = 0.3\\ \\mathrm{day^{-1}}$\n  $g = 0\\ \\mathrm{day^{-1}}$\n  $\\gamma = 0\\ \\mathrm{day^{-1}}$\n- **State for Jacobian Evaluation:** $(N^{\\ast}, P^{\\ast}, Z^{\\ast}, D^{\\ast}) = (1.0, 2.0, 0.5, 1.0)$, with units of $\\mathrm{mmol\\ N\\ m^{-3}}$.\n- **Tasks:**\n  1. Calculate the Jacobian matrix $\\mathbf{J} = \\partial \\mathbf{R}/\\partial \\mathbf{C}$ at the specified state.\n  2. Determine the eigenvalues of $\\mathbf{J}$.\n  3. Interpret the eigenvalues.\n  4. Find the maximum stable time step $\\Delta t_{\\max}$ for the Forward Euler method on the linearized system.\n  5. Express $\\Delta t_{\\max}$ in hours, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-posed, scientifically grounded, and objective. It describes a standard simplified Nutrient–Phytoplankton–Zooplankton–Detritus (NPZD) biogeochemical model, a common tool in computational oceanography. The governing equations are based on established ecological principles (e.g., Michaelis-Menten kinetics for nutrient uptake). A crucial check is for mass conservation: the sum of the reaction rates is $R_N + R_P + R_Z + R_D = (-\\mu P) + (\\alpha\\mu P - m_P P) + (-m_Z Z) + ((1-\\alpha)\\mu P + m_P P + m_Z Z) = 0$. The system conserves total nitrogen, which is a required property for such models. All parameters and state variables are provided with consistent units and plausible values. The tasks are standard exercises in local stability and numerical analysis of dynamical systems. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be constructed.\n\n**Solution Construction**\n\nThe problem requires the evaluation of the Jacobian matrix $\\mathbf{J}$ of the reaction operator $\\mathbf{R}(\\mathbf{C})$ at a specific state $\\mathbf{C}^{\\ast} = (N^{\\ast}, P^{\\ast}, Z^{\\ast}, D^{\\ast})^{\\top}$. The Jacobian is defined as $J_{ij} = \\frac{\\partial R_i}{\\partial C_j}$, where $\\mathbf{C}=(N, P, Z, D)^{\\top}$ and $\\mathbf{R}=(R_N, R_P, R_Z, R_D)^{\\top}$.\n\nFirst, we compute the derivative of the nutrient uptake rate $\\mu(N)$:\n$$\n\\frac{d\\mu}{dN} = \\frac{d}{dN} \\left( \\mu_{\\max} \\frac{N}{K_N+N} \\right) = \\mu_{\\max} \\frac{(K_N+N)(1) - N(1)}{(K_N+N)^2} = \\mu_{\\max} \\frac{K_N}{(K_N+N)^2}\n$$\nThe entries of the Jacobian matrix are the partial derivatives of the reaction terms:\n$$\n\\mathbf{J} =\n\\begin{pmatrix}\n\\frac{\\partial R_N}{\\partial N}  \\frac{\\partial R_N}{\\partial P}  \\frac{\\partial R_N}{\\partial Z}  \\frac{\\partial R_N}{\\partial D} \\\\\n\\frac{\\partial R_P}{\\partial N}  \\frac{\\partial R_P}{\\partial P}  \\frac{\\partial R_P}{\\partial Z}  \\frac{\\partial R_P}{\\partial D} \\\\\n\\frac{\\partial R_Z}{\\partial N}  \\frac{\\partial R_Z}{\\partial P}  \\frac{\\partial R_Z}{\\partial Z}  \\frac{\\partial R_Z}{\\partial D} \\\\\n\\frac{\\partial R_D}{\\partial N}  \\frac{\\partial R_D}{\\partial P}  \\frac{\\partial R_D}{\\partial Z}  \\frac{\\partial R_D}{\\partial D}\n\\end{pmatrix}\n$$\nThe individual partial derivatives are:\n$\\frac{\\partial R_N}{\\partial N} = -P \\frac{d\\mu}{dN}$, $\\frac{\\partial R_N}{\\partial P} = -\\mu(N)$, $\\frac{\\partial R_N}{\\partial Z}=0$, $\\frac{\\partial R_N}{\\partial D}=0$.\n$\\frac{\\partial R_P}{\\partial N} = \\alpha P \\frac{d\\mu}{dN}$, $\\frac{\\partial R_P}{\\partial P} = \\alpha \\mu(N) - m_P$, $\\frac{\\partial R_P}{\\partial Z}=0$, $\\frac{\\partial R_P}{\\partial D}=0$.\n$\\frac{\\partial R_Z}{\\partial N} = 0$, $\\frac{\\partial R_Z}{\\partial P} = 0$, $\\frac{\\partial R_Z}{\\partial Z} = -m_Z$, $\\frac{\\partial R_Z}{\\partial D}=0$.\n$\\frac{\\partial R_D}{\\partial N} = (1-\\alpha) P \\frac{d\\mu}{dN}$, $\\frac{\\partial R_D}{\\partial P} = (1-\\alpha)\\mu(N) + m_P$, $\\frac{\\partial R_D}{\\partial Z} = m_Z$, $\\frac{\\partial R_D}{\\partial D}=0$.\n\nNext, we evaluate these terms at the given state $(N^{\\ast}, P^{\\ast}, Z^{\\ast}, D^{\\ast})=(1.0, 2.0, 0.5, 1.0)$.\nFirst, we evaluate $\\mu(N^{\\ast})$ and its derivative:\n$$\n\\mu(N^{\\ast}) = \\mu(1.0) = (1.0) \\frac{1.0}{1.0 + 1.0} = 0.5\\ \\mathrm{day^{-1}}\n$$\n$$\n\\frac{d\\mu}{dN}\\bigg|_{N^{\\ast}} = (1.0) \\frac{1.0}{(1.0 + 1.0)^2} = \\frac{1.0}{4.0} = 0.25\\ \\mathrm{day^{-1} (mmol\\ N\\ m^{-3})^{-1}}\n$$\nNow we compute the numerical values for the Jacobian entries (all in units of $\\mathrm{day^{-1}}$):\n$J_{11} = -P^{\\ast} \\frac{d\\mu}{dN} = -2.0 \\times 0.25 = -0.5$\n$J_{12} = -\\mu(N^{\\ast}) = -0.5$\n$J_{21} = \\alpha P^{\\ast} \\frac{d\\mu}{dN} = 0.6 \\times 2.0 \\times 0.25 = 0.3$\n$J_{22} = \\alpha \\mu(N^{\\ast}) - m_P = 0.6 \\times 0.5 - 0.5 = 0.3 - 0.5 = -0.2$\n$J_{33} = -m_Z = -0.3$\n$J_{41} = (1-\\alpha) P^{\\ast} \\frac{d\\mu}{dN} = (1-0.6) \\times 2.0 \\times 0.25 = 0.4 \\times 0.5 = 0.2$\n$J_{42} = (1-\\alpha)\\mu(N^{\\ast}) + m_P = (1-0.6) \\times 0.5 + 0.5 = 0.2 + 0.5 = 0.7$\n$J_{43} = m_Z = 0.3$\nAll other entries are zero. The Jacobian matrix is:\n$$\n\\mathbf{J} = \\begin{pmatrix}\n-0.5  -0.5  0  0 \\\\\n0.3  -0.2  0  0 \\\\\n0  0  -0.3  0 \\\\\n0.2  0.7  0.3  0\n\\end{pmatrix}\n$$\n\nTo find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(\\mathbf{J} - \\lambda\\mathbf{I}) = 0$. The matrix has a block lower triangular structure:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\mathbf{A}  \\mathbf{0} \\\\ \\mathbf{C}  \\mathbf{D} \\end{pmatrix} \\quad \\text{where} \\quad \\mathbf{A} = \\begin{pmatrix} -0.5  -0.5 \\\\ 0.3  -0.2 \\end{pmatrix}, \\quad \\mathbf{D} = \\begin{pmatrix} -0.3  0 \\\\ 0.3  0 \\end{pmatrix}\n$$\nThe eigenvalues of $\\mathbf{J}$ are the union of the eigenvalues of $\\mathbf{A}$ and $\\mathbf{D}$.\nThe matrix $\\mathbf{D}$ is triangular, so its eigenvalues are its diagonal entries: $\\lambda_1 = -0.3$ and $\\lambda_2 = 0$.\nFor matrix $\\mathbf{A}$, the characteristic equation is $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$:\n$$\n(-0.5-\\lambda)(-0.2-\\lambda) - (-0.5)(0.3) = 0\n$$\n$$\n\\lambda^2 + 0.7\\lambda + 0.1 + 0.15 = 0\n$$\n$$\n\\lambda^2 + 0.7\\lambda + 0.25 = 0\n$$\nUsing the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\n\\lambda = \\frac{-0.7 \\pm \\sqrt{(0.7)^2 - 4(1)(0.25)}}{2} = \\frac{-0.7 \\pm \\sqrt{0.49 - 1.0}}{2} = \\frac{-0.7 \\pm \\sqrt{-0.51}}{2}\n$$\nThis gives a complex conjugate pair of eigenvalues: $\\lambda_{3,4} = -0.35 \\pm i \\frac{\\sqrt{0.51}}{2}$.\n\nThe four eigenvalues of $\\mathbf{J}$ are:\n$\\lambda_1 = 0$, $\\lambda_2 = -0.3$, $\\lambda_3 = -0.35 + i \\frac{\\sqrt{0.51}}{2}$, $\\lambda_4 = -0.35 - i \\frac{\\sqrt{0.51}}{2}$.\n\nInterpretation of eigenvalues:\n- $\\lambda_1 = 0$: This eigenvalue corresponds to a neutrally stable mode. It arises because the total nitrogen $N+P+Z+D$ is a conserved quantity, a direct consequence of the mass-conserving formulation.\n- $\\lambda_2 = -0.3$: This real, negative eigenvalue represents an exponential decay mode. Its value is precisely $-m_Z$, reflecting the fact that the zooplankton dynamics ($\\dot{Z} = -m_Z Z$) are decoupled from the other state variables in this simplified model. The characteristic timescale for this decay is $1/|\\lambda_2| \\approx 3.33$ days.\n- $\\lambda_{3,4} = -0.35 \\pm i \\frac{\\sqrt{0.51}}{2} \\approx -0.35 \\pm i \\, 0.357$: This complex conjugate pair with a negative real part signifies a damped oscillatory mode. This behavior arises from the interaction between nutrients ($N$) and phytoplankton ($P$). The real part, $\\mathrm{Re}(\\lambda) = -0.35$, sets the decay rate (timescale $1/0.35 \\approx 2.86$ days), while the imaginary part, $\\mathrm{Im}(\\lambda) \\approx 0.357 \\ \\mathrm{rad\\ day^{-1}}$, sets the frequency of oscillation (period $2\\pi/0.357 \\approx 17.6$ days).\n- System Stiffness: The magnitudes of the non-zero real parts of the eigenvalues are $-0.3$ and $-0.35$. Since these are very close, the system is considered non-stiff at this state.\n\nFinally, we determine the maximum stable time step $\\Delta t_{\\max}$ for the Forward Euler (FE) method. The stability region for FE requires that for each eigenvalue $\\lambda_i$ of the Jacobian $\\mathbf{J}$, the value $z_i = \\Delta t \\lambda_i$ must lie within or on the circle in the complex plane centered at $(-1, 0)$ with radius $1$. This condition is expressed as $|1 + \\Delta t \\lambda_i| \\leq 1$.\n- For $\\lambda_1=0$, $|1+0| = 1 \\le 1$, which imposes no restriction on $\\Delta t$.\n- For a real negative eigenvalue $\\lambda  0$, the condition simplifies to $\\Delta t \\le -2/\\lambda = 2/|\\lambda|$. For $\\lambda_2=-0.3$, $\\Delta t \\le 2/0.3 = 20/3 \\approx 6.67$ days.\n- For a complex eigenvalue $\\lambda = x+iy$, the condition becomes $\\Delta t \\leq \\frac{-2x}{x^2+y^2} = \\frac{-2\\mathrm{Re}(\\lambda)}{|\\lambda|^2}$. For $\\lambda_{3,4}$:\n  $\\mathrm{Re}(\\lambda) = -0.35$\n  $|\\lambda|^2 = (-0.35)^2 + \\left(\\frac{\\sqrt{0.51}}{2}\\right)^2 = 0.1225 + \\frac{0.51}{4} = 0.1225 + 0.1275 = 0.25$\n  The stability limit is $\\Delta t \\le \\frac{-2(-0.35)}{0.25} = \\frac{0.7}{0.25} = 2.8$ days.\n\nThe overall maximum stable time step is the most restrictive of these limits. Comparing $\\Delta t \\le 6.67$ days and $\\Delta t \\le 2.8$ days, we find:\n$$\n\\Delta t_{\\max} = 2.8\\ \\mathrm{days}\n$$\nThe problem requires this value in hours, rounded to four significant figures.\n$$\n\\Delta t_{\\max} = 2.8\\ \\mathrm{days} \\times 24\\ \\mathrm{hours/day} = 67.2\\ \\mathrm{hours}\n$$\nRounding to four significant figures gives $67.20$ hours.",
            "answer": "$$\n\\boxed{67.20}\n$$"
        },
        {
            "introduction": "Coupled models rely on algorithms to simulate the physical transport of biogeochemical tracers by ocean currents. However, numerical schemes for advection are imperfect and can introduce errors that mimic physical processes, a phenomenon known as numerical diffusion. This practice employs the modified equation approach to unmask and quantify the effective diffusivity ($K_{\\mathrm{eff}}$) inherent in a widely used first-order advection scheme, highlighting a critical skill in distinguishing model artifacts from resolved physical dynamics .",
            "id": "3789508",
            "problem": "A one-dimensional conservative biogeochemical tracer, such as dissolved inorganic nitrogen, is transported in a coupled physical-biogeochemical ocean model by a uniform, positive, along-stream velocity $u$ without any physical molecular or subgrid turbulent mixing over the short timescale considered. The governing continuum equation is the linear advection equation for concentration $c(x,t)$,\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0,\n$$\nwith periodic boundary conditions. The initial condition is a sinusoidal tracer field,\n$$\nc(x,0) = A_{0} \\sin(k x),\n$$\nwhere $A_{0}$ and $k$ are constants. In the numerical model, advection is computed using a first-order upwind, forward-in-time, finite-volume discretization on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$,\n$$\nc_{i}^{n+1} = c_{i}^{n} - C \\left(c_{i}^{n} - c_{i-1}^{n}\\right),\n$$\nwhere $c_{i}^{n}$ approximates $c(x_{i}, t_{n})$ and $C$ is the Courant number defined by $C = \\dfrac{u \\Delta t}{\\Delta x}$.\n\nUsing the modified equation approach, in which the discrete update is matched to a continuous partial differential equation by Taylor expanding in $\\Delta x$ and $\\Delta t$ and retaining leading-order terms, determine the effective numerical diffusivity $K_{\\mathrm{eff}}$ such that the discrete scheme is equivalent, to leading order, to\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = K_{\\mathrm{eff}} \\frac{\\partial^{2} c}{\\partial x^{2}},\n$$\nfor a sinusoidal tracer field of wavenumber $k$. Assume that $\\Delta x$ and $\\Delta t$ are sufficiently small that higher-order terms can be neglected, and that $0 \\leq C \\leq 1$.\n\nEvaluate $K_{\\mathrm{eff}}$ numerically for $u = 0.20\\,\\mathrm{m\\,s^{-1}}$, $\\Delta x = 1.00 \\times 10^{3}\\,\\mathrm{m}$, and $\\Delta t = 1.50 \\times 10^{3}\\,\\mathrm{s}$. Express the final value of $K_{\\mathrm{eff}}$ in $\\mathrm{m^{2}\\,s^{-1}}$ and round your answer to three significant figures.",
            "solution": "The problem requires the derivation of the effective numerical diffusivity, $K_{\\mathrm{eff}}$, for a first-order upwind, forward-in-time finite-volume discretization of the linear advection equation. The method to be used is the modified equation approach, which involves performing Taylor series expansions of the terms in the discrete scheme to find a continuous partial differential equation (the modified equation) that the numerical scheme represents more accurately than the original target equation. The effective diffusivity is the coefficient of the leading-order error term, which takes the form of a diffusion term.\n\nThe given discrete scheme is:\n$$\nc_{i}^{n+1} = c_{i}^{n} - C \\left(c_{i}^{n} - c_{i-1}^{n}\\right)\n$$\nwhere $c_{i}^{n}$ is the numerical approximation of the concentration $c(x,t)$ at grid point $x_i$ and time $t_n$. The Courant number is defined as $C = \\frac{u \\Delta t}{\\Delta x}$, with $u  0$.\n\nTo derive the modified equation, we expand each term in a Taylor series around the point $(x_i, t_n)$. Let $c$ and its partial derivatives without arguments denote their values at $(x_i, t_n)$.\nThe term $c_{i}^{n+1}$ is an expansion in time:\n$$\nc_{i}^{n+1} = c(x_i, t_n + \\Delta t) = c + \\Delta t \\frac{\\partial c}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\mathcal{O}((\\Delta t)^3)\n$$\nThe term $c_{i}^{n}$ is simply the value at the expansion point:\n$$\nc_{i}^{n} = c(x_i, t_n) = c\n$$\nThe term $c_{i-1}^{n}$ is an expansion in space:\n$$\nc_{i-1}^{n} = c(x_i - \\Delta x, t_n) = c - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\mathcal{O}((\\Delta x)^4)\n$$\nThe problem states that the initial condition is a sinusoidal field, which ensures that the solution $c(x,t)$ remains sufficiently smooth for these Taylor series expansions to be valid.\n\nSubstituting these expansions into the discrete scheme:\n$$\nc + \\Delta t \\frac{\\partial c}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\dots = c - C \\left(c - \\left(c - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\dots\\right)\\right)\n$$\nSimplifying the right-hand side:\n$$\nc + \\Delta t \\frac{\\partial c}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\dots = c - C \\left(\\Delta x \\frac{\\partial c}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\dots\\right)\n$$\nThe term $c$ cancels from both sides. We then divide the entire equation by $\\Delta t$:\n$$\n\\frac{\\partial c}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\dots = -\\frac{C \\Delta x}{\\Delta t} \\frac{\\partial c}{\\partial x} + \\frac{C (\\Delta x)^2}{2\\Delta t} \\frac{\\partial^2 c}{\\partial x^2} - \\dots\n$$\nWe substitute the definitions of the Courant number, $C = \\frac{u \\Delta t}{\\Delta x}$, and the velocity $u$:\nThe coefficient of the first term on the right is $\\frac{C \\Delta x}{\\Delta t} = \\frac{(u \\Delta t / \\Delta x) \\Delta x}{\\Delta t} = u$.\nThe coefficient of the second term on the right is $\\frac{C (\\Delta x)^2}{2\\Delta t} = \\frac{(u \\Delta t / \\Delta x) (\\Delta x)^2}{2\\Delta t} = \\frac{u \\Delta x}{2}$.\nThe equation becomes:\n$$\n\\frac{\\partial c}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\dots = -u \\frac{\\partial c}{\\partial x} + \\frac{u \\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\dots\n$$\nRearranging to match the form of the advection-diffusion equation:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -\\frac{\\Delta t}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\frac{u \\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\text{H.O.T.}\n$$\nwhere H.O.T. stands for Higher-Order Terms. This is the modified equation, but it contains a time derivative on the right-hand side. To express the leading-order error purely in terms of spatial derivatives, we must eliminate the $\\frac{\\partial^2 c}{\\partial t^2}$ term. We can do this by using the lowest-order approximation of the equation itself, which is the original PDE we are trying to solve: $\\frac{\\partial c}{\\partial t} = -u \\frac{\\partial c}{\\partial x}$.\nDifferentiating this expression with respect to $t$ gives:\n$$\n\\frac{\\partial^2 c}{\\partial t^2} = \\frac{\\partial}{\\partial t}\\left(-u \\frac{\\partial c}{\\partial x}\\right) = -u \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial c}{\\partial t}\\right)\n$$\nSince $u$ is a constant. Now, we substitute $\\frac{\\partial c}{\\partial t} = -u \\frac{\\partial c}{\\partial x}$ again:\n$$\n\\frac{\\partial^2 c}{\\partial t^2} = -u \\frac{\\partial}{\\partial x}\\left(-u \\frac{\\partial c}{\\partial x}\\right) = u^2 \\frac{\\partial^2 c}{\\partial x^2}\n$$\nThis relationship holds to the lowest order of accuracy. Substituting this into the modified equation:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -\\frac{\\Delta t}{2} \\left(u^2 \\frac{\\partial^2 c}{\\partial x^2}\\right) + \\frac{u \\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\text{H.O.T.}\n$$\nNow we group the terms with the second spatial derivative:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = \\left(\\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2}\\right) \\frac{\\partial^2 c}{\\partial x^2} + \\text{H.O.T.}\n$$\nFactoring out common terms from the coefficient on the right-hand side:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right) \\frac{\\partial^2 c}{\\partial x^2} + \\text{H.O.T.}\n$$\nRecognizing the Courant number $C = \\frac{u \\Delta t}{\\Delta x}$ inside the parenthesis:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = \\frac{u \\Delta x}{2} (1 - C) \\frac{\\partial^2 c}{\\partial x^2} + \\text{H.O.T.}\n$$\nThis equation has the form requested in the problem statement:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = K_{\\mathrm{eff}} \\frac{\\partial^{2} c}{\\partial x^{2}}\n$$\nBy comparing the two equations, we identify the effective numerical diffusivity, $K_{\\mathrm{eff}}$, as the coefficient of the second derivative term:\n$$\nK_{\\mathrm{eff}} = \\frac{u \\Delta x}{2} (1 - C)\n$$\nThis leading-order truncation error term represents artificial diffusion introduced by the numerical scheme. Since $u  0$ and $0 \\le C \\le 1$, we have $K_{\\mathrm{eff}} \\ge 0$, which is physically consistent with a diffusive process.\n\nNow, we evaluate $K_{\\mathrm{eff}}$ using the given numerical values:\n$u = 0.20\\,\\mathrm{m\\,s^{-1}}$\n$\\Delta x = 1.00 \\times 10^{3}\\,\\mathrm{m}$\n$\\Delta t = 1.50 \\times 10^{3}\\,\\mathrm{s}$\n\nFirst, we calculate the Courant number, $C$:\n$$\nC = \\frac{u \\Delta t}{\\Delta x} = \\frac{(0.20\\,\\mathrm{m\\,s^{-1}}) (1.50 \\times 10^{3}\\,\\mathrm{s})}{1.00 \\times 10^{3}\\,\\mathrm{m}} = \\frac{300}{1000} = 0.300\n$$\nThe value is dimensionless, and $C=0.300$ is within the stability range $0 \\leq C \\leq 1$.\n\nNext, we calculate $K_{\\mathrm{eff}}$:\n$$\nK_{\\mathrm{eff}} = \\frac{u \\Delta x}{2} (1 - C) = \\frac{(0.20\\,\\mathrm{m\\,s^{-1}}) (1.00 \\times 10^{3}\\,\\mathrm{m})}{2} (1 - 0.300)\n$$\n$$\nK_{\\mathrm{eff}} = \\frac{200\\,\\mathrm{m^{2}\\,s^{-1}}}{2} (0.700) = (100\\,\\mathrm{m^{2}\\,s^{-1}}) (0.700) = 70.0\\,\\mathrm{m^{2}\\,s^{-1}}\n$$\nThe result rounded to three significant figures is $70.0$. In standard scientific notation, this is $7.00 \\times 10^1$.\nThe final value for the effective numerical diffusivity is $70.0\\,\\mathrm{m^{2}\\,s^{-1}}$.",
            "answer": "$$\\boxed{7.00 \\times 10^{1}}$$"
        },
        {
            "introduction": "The ultimate test of a coupled model's integrity lies in its adherence to fundamental physical laws, such as the conservation of mass. This final practice guides you through the design of a robust verification test to ensure your model correctly balances the budget of key elemental inventories like carbon, nitrogen, and phosphorus over time. Performing such budget closure analysis  is an essential step in debugging complex code and building confidence in the scientific validity of simulation results.",
            "id": "3789522",
            "problem": "You are given a one-dimensional control volume representing a well-mixed ocean surface layer of depth $D$ (in $\\mathrm{m}$), with four elemental inventories: dissolved inorganic carbon ($\\mathrm{C}$), total nitrogen ($\\mathrm{N}$), total phosphorus ($\\mathrm{P}$), and dissolved oxygen ($\\mathrm{O}$), each expressed in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$. The fundamental base is the conservation law for a scalar inventory $B_E(t)$ of element $E \\in \\{\\mathrm{C}, \\mathrm{N}, \\mathrm{P}, \\mathrm{O}\\}$ in a fixed control volume, given by the continuity equation\n$$\n\\frac{d B_E}{dt} \\;=\\; \\sum_{j} S_{E,j}(t),\n$$\nwhere $S_{E,j}(t)$ are source-minus-sink terms (in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$) arising from coupled physical and biogeochemical processes, including air-sea exchange, lateral transport divergence, and external inputs. Over a finite time interval $[0,T]$, the conservation law implies\n$$\nB_E(T) \\;=\\; B_E(0) \\;+\\; \\int_0^T \\left( \\sum_j S_{E,j}(t) \\right) \\, dt.\n$$\nYour task is to design a test that verifies element conservation by integrating all sources and sinks over time for $\\mathrm{C}$, $\\mathrm{N}$, $\\mathrm{P}$, and $\\mathrm{O}$ and diagnosing the residual drift\n$$\nr_E \\;=\\; B_E^{\\mathrm{recorded}}(T) \\;-\\; \\left( B_E(0) \\;+\\; \\int_0^T \\sum_j S_{E,j}(t) \\, dt \\right),\n$$\nfor each element $E$, where $B_E^{\\mathrm{recorded}}(T)$ is the recorded final inventory from the model. The test passes if $\\max_{E \\in \\{\\mathrm{C},\\mathrm{N},\\mathrm{P},\\mathrm{O}\\}} |r_E| \\le \\varepsilon$ for a prescribed tolerance $\\varepsilon$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$). Angles in trigonometric functions must be interpreted in radians.\n\nUse the following context for sources and sinks:\n- Air-sea flux for carbon dioxide $F_{\\mathrm{CO_2}}(t)$ and oxygen $F_{\\mathrm{O_2}}(t)$ are given in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ and converted to volumetric tendencies by division by $D$:\n$$\nS_{\\mathrm{C},\\mathrm{air}}(t) \\;=\\; \\frac{F_{\\mathrm{CO_2}}(t)}{D}, \\quad S_{\\mathrm{O},\\mathrm{air}}(t) \\;=\\; \\frac{F_{\\mathrm{O_2}}(t)}{D}.\n$$\n- River inputs for nitrogen and phosphorus are constant volumetric source terms $S_{\\mathrm{N},\\mathrm{river}}$ and $S_{\\mathrm{P},\\mathrm{river}}$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n- Transport divergence terms $T_E(t)$ for each element $E$ are given in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\nThe total tendency for each element is\n$$\nS_{\\mathrm{C}}(t) \\;=\\; S_{\\mathrm{C},\\mathrm{air}}(t) + T_{\\mathrm{C}}(t), \\quad\nS_{\\mathrm{O}}(t) \\;=\\; S_{\\mathrm{O},\\mathrm{air}}(t) + T_{\\mathrm{O}}(t), \\quad\nS_{\\mathrm{N}}(t) \\;=\\; S_{\\mathrm{N},\\mathrm{river}} + T_{\\mathrm{N}}(t), \\quad\nS_{\\mathrm{P}}(t) \\;=\\; S_{\\mathrm{P},\\mathrm{river}} + T_{\\mathrm{P}}(t).\n$$\n\nYou must implement a numerical integration over the time interval $[0,T]$ to approximate the integrals $\\int_0^T S_E(t)\\,dt$ for each element $E$. The inputs are provided as time step size $\\Delta t$ (in $\\mathrm{s}$), number of steps $N$ (an integer), and parameter values defining the sources and sinks. The total duration is $T = N \\Delta t$. The integration method should be consistent and numerically stable.\n\nExpress all inventories and residuals in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, and all rates in their specified units. The tolerance is given by $\\varepsilon$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is the list $[r_{\\mathrm{C}}, r_{\\mathrm{N}}, r_{\\mathrm{P}}, r_{\\mathrm{O}}, \\mathrm{pass}]$ with $r_E$ floats and $\\mathrm{pass}$ a boolean.\n\nTest Suite:\nFor all cases below, use $D = 50$ (in $\\mathrm{m}$), $\\Delta t = 3600$ (in $\\mathrm{s}$), $N = 24$ (integer), and $\\varepsilon = 10^{-6}$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$). The time $t$ runs from $0$ to $T$ inclusive with $N+1$ points. Let $T = N \\Delta t = 86400$ (in $\\mathrm{s}$). Define the sine argument in radians. Use the Redfield-inspired coupling coefficient $\\alpha = 138/106$.\n\n- Case $1$ (happy path, perfect closure):\n  - Initial inventories: $B_{\\mathrm{C}}(0) = 2.20$, $B_{\\mathrm{N}}(0) = 0.05$, $B_{\\mathrm{P}}(0) = 0.003$, $B_{\\mathrm{O}}(0) = 0.25$ (all in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$).\n  - Air-sea fluxes: $F_{\\mathrm{CO_2}}(t) = A_{\\mathrm{C}} \\sin\\!\\left(2\\pi t / T\\right) + B_{\\mathrm{C}}$ with $A_{\\mathrm{C}} = 5 \\times 10^{-8}$ and $B_{\\mathrm{C}} = 1 \\times 10^{-8}$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$); $F_{\\mathrm{O_2}}(t) = -\\alpha \\, F_{\\mathrm{CO_2}}(t)$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$).\n  - River sources: $S_{\\mathrm{N},\\mathrm{river}} = 1 \\times 10^{-10}$, $S_{\\mathrm{P},\\mathrm{river}} = 6.25 \\times 10^{-12}$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$).\n  - Transport divergences: $T_{\\mathrm{C}}(t) = 0$, $T_{\\mathrm{N}}(t) = 0$, $T_{\\mathrm{P}}(t) = 0$, $T_{\\mathrm{O}}(t) = 0$.\n  - Recorded finals: $B_E^{\\mathrm{recorded}}(T) = B_E(0) + \\int_0^T S_E(t)\\,dt$ for each $E$.\n\n- Case $2$ (near tolerance, small imbalances):\n  - Same parameters as Case $1$.\n  - Recorded finals: $B_{\\mathrm{C}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{C}}(0) + \\int_0^T S_{\\mathrm{C}}(t)\\,dt + 5 \\times 10^{-7}$; $B_{\\mathrm{N}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{N}}(0) + \\int_0^T S_{\\mathrm{N}}(t)\\,dt - 2 \\times 10^{-7}$; $B_{\\mathrm{P}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{P}}(0) + \\int_0^T S_{\\mathrm{P}}(t)\\,dt + 1 \\times 10^{-7}$; $B_{\\mathrm{O}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{O}}(0) + \\int_0^T S_{\\mathrm{O}}(t)\\,dt - 4 \\times 10^{-7}$.\n\n- Case $3$ (failure due to missing oxygen flux):\n  - Same parameters as Case $1$.\n  - Recorded finals: $B_{\\mathrm{C}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{C}}(0) + \\int_0^T S_{\\mathrm{C}}(t)\\,dt$; $B_{\\mathrm{N}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{N}}(0) + \\int_0^T S_{\\mathrm{N}}(t)\\,dt$; $B_{\\mathrm{P}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{P}}(0) + \\int_0^T S_{\\mathrm{P}}(t)\\,dt$; $B_{\\mathrm{O}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{O}}(0)$.\n\n- Case $4$ (edge case, zero fluxes and sources):\n  - Initial inventories: $B_{\\mathrm{C}}(0) = 2.20$, $B_{\\mathrm{N}}(0) = 0.05$, $B_{\\mathrm{P}}(0) = 0.003$, $B_{\\mathrm{O}}(0) = 0.25$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$).\n  - Air-sea fluxes: $F_{\\mathrm{CO_2}}(t) = 0$, $F_{\\mathrm{O_2}}(t) = 0$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$).\n  - River sources: $S_{\\mathrm{N},\\mathrm{river}} = 0$, $S_{\\mathrm{P},\\mathrm{river}} = 0$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$).\n  - Transport divergences: $T_{\\mathrm{C}}(t) = 0$, $T_{\\mathrm{N}}(t) = 0$, $T_{\\mathrm{P}}(t) = 0$, $T_{\\mathrm{O}}(t) = 0$.\n  - Recorded finals: $B_E^{\\mathrm{recorded}}(T) = B_E(0)$ for each $E$.\n\nYour program should implement the above, compute $r_{\\mathrm{C}}$, $r_{\\mathrm{N}}$, $r_{\\mathrm{P}}$, and $r_{\\mathrm{O}}$ for each case, check the pass/fail condition against $\\varepsilon$, and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example:\n$[ [r_{\\mathrm{C}}, r_{\\mathrm{N}}, r_{\\mathrm{P}}, r_{\\mathrm{O}}, \\mathrm{True}], [\\dots], [\\dots], [\\dots] ]$.",
            "solution": "The user has provided a problem that is scientifically and mathematically sound, well-posed, and contains all necessary information for a unique solution. The problem is therefore deemed **valid**.\n\nThe fundamental principle underlying this problem is the conservation of elements in a control volume, a cornerstone of physical and biogeochemical oceanography. For a given elemental inventory $B_E(t)$ of an element $E \\in \\{\\mathrm{C}, \\mathrm{N}, \\mathrm{P}, \\mathrm{O}\\}$, its rate of change is equal to the sum of all sources and sinks, $\\sum_j S_{E,j}(t)$:\n$$\n\\frac{d B_E}{dt} \\;=\\; \\sum_{j} S_{E,j}(t)\n$$\nIntegrating this ordinary differential equation over a time interval $[0, T]$ gives the predicted final state based on the initial state $B_E(0)$ and the time-integrated fluxes:\n$$\nB_E^{\\mathrm{predicted}}(T) \\;=\\; B_E(0) \\;+\\; \\int_0^T \\left( \\sum_j S_{E,j}(t) \\right) \\, dt\n$$\nThe core task is to implement a diagnostic test that verifies this conservation principle in a numerical model. This is achieved by computing the residual drift, $r_E$, which is the difference between the final inventory recorded by the model, $B_E^{\\mathrm{recorded}}(T)$, and the theoretically predicted final inventory, $B_E^{\\mathrm{predicted}}(T)$:\n$$\nr_E \\;=\\; B_E^{\\mathrm{recorded}}(T) \\;-\\; B_E^{\\mathrm{predicted}}(T)\n$$\nA non-zero residual indicates a mass conservation error, either from the model's numerical scheme or from an incomplete accounting of fluxes in the diagnostic tool. The test passes if the maximum absolute residual across all elements is within a specified tolerance $\\varepsilon$, i.e., $\\max_E |r_E| \\le \\varepsilon$.\n\nTo compute $B_E^{\\mathrm{predicted}}(T)$, we must evaluate the integral of the total source-sink term, $S_E(t) = \\sum_j S_{E,j}(t)$, over the interval $[0, T]$. Since the source-sink terms are provided as functions or discrete time series, we perform this integration numerically. We will use the trapezoidal rule, a robust and standard method for integrating discretely sampled data. The time domain $[0, T]$ is discretized into $N$ intervals of size $\\Delta t$, yielding $N+1$ time points $t_i = i \\Delta t$ for $i = 0, 1, \\dots, N$. The numerical integral is then approximated as:\n$$\nI_E^{\\mathrm{num}} \\;=\\; \\int_0^T S_E(t) \\, dt \\;\\approx\\; \\sum_{i=0}^{N-1} \\frac{S_E(t_i) + S_E(t_{i+1})}{2} \\Delta t\n$$\nThe predicted final inventory is thus $B_E^{\\mathrm{predicted}}(T) = B_E(0) + I_E^{\\mathrm{num}}$.\n\nThe source-sink terms for each element are defined as follows:\n- Carbon ($C$): $S_{\\mathrm{C}}(t) = S_{\\mathrm{C},\\mathrm{air}}(t) + T_{\\mathrm{C}}(t) = \\frac{1}{D}F_{\\mathrm{CO_2}}(t) + T_{\\mathrm{C}}(t) = \\frac{1}{D}\\left(A_{\\mathrm{C}} \\sin(2\\pi t / T) + B_{\\mathrm{C}}\\right) + T_{\\mathrm{C}}(t)$.\n- Nitrogen ($N$): $S_{\\mathrm{N}}(t) = S_{\\mathrm{N},\\mathrm{river}} + T_{\\mathrm{N}}(t)$.\n- Phosphorus ($P$): $S_{\\mathrm{P}}(t) = S_{\\mathrm{P},\\mathrm{river}} + T_{\\mathrm{P}}(t)$.\n- Oxygen ($O$): $S_{\\mathrm{O}}(t) = S_{\\mathrm{O},\\mathrm{air}}(t) + T_{\\mathrm{O}}(t) = \\frac{1}{D}F_{\\mathrm{O_2}}(t) + T_{\\mathrm{O}}(t) = \\frac{-\\alpha}{D}\\left(A_{\\mathrm{C}} \\sin(2\\pi t / T) + B_{\\mathrm{C}}\\right) + T_{\\mathrm{O}}(t)$.\n\nFor the given test cases, the transport terms $T_E(t)$ are zero. The river inputs are constant. A key observation is that the integration of the sinusoidal term $\\int_0^T \\sin(2\\pi t / T) dt$ over one full period $T$ is analytically zero. The trapezoidal rule, when applied to a full period of a sinusoid with evenly spaced points (as is the case here), also yields an exactly zero result. The integration of constant terms is also exact with the trapezoidal rule. Therefore, the numerical integral $I_E^{\\mathrm{num}}$ will be equal to the analytical integral $I_E^{\\mathrm{analyt}}$ up to machine precision.\n$$\nI_{\\mathrm{C}}^{\\mathrm{analyt}} = \\frac{B_{\\mathrm{C}} T}{D}, \\quad\nI_{\\mathrm{N}}^{\\mathrm{analyt}} = S_{\\mathrm{N},\\mathrm{river}} T, \\quad\nI_{\\mathrm{P}}^{\\mathrm{analyt}} = S_{\\mathrm{P},\\mathrm{river}} T, \\quad\nI_{\\mathrm{O}}^{\\mathrm{analyt}} = \\frac{-\\alpha B_{\\mathrm{C}} T}{D}\n$$\nThe test cases define $B_E^{\\mathrm{recorded}}(T)$ in terms of these analytical integrals. We can therefore pre-calculate the expected residuals.\n\n- **Case 1**: $B_E^{\\mathrm{recorded}}(T) = B_E(0) + I_E^{\\mathrm{analyt}}$. The residual is $r_E = (B_E(0) + I_E^{\\mathrm{analyt}}) - (B_E(0) + I_E^{\\mathrm{num}})$. Since $I_E^{\\mathrm{num}} \\approx I_E^{\\mathrm{analyt}}$, we expect $r_E \\approx 0$ for all $E$. The test should pass.\n\n- **Case 2**: $B_E^{\\mathrm{recorded}}(T)$ is defined with explicit imbalances. For carbon, $B_{\\mathrm{C}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{C}}(0) + I_{\\mathrm{C}}^{\\mathrm{analyt}} + 5 \\times 10^{-7}$. The residual will be $r_{\\mathrm{C}} = (B_{\\mathrm{C}}(0) + I_{\\mathrm{C}}^{\\mathrm{analyt}} + 5 \\times 10^{-7}) - (B_{\\mathrm{C}}(0) + I_{\\mathrm{C}}^{\\mathrm{num}}) \\approx 5 \\times 10^{-7}$. Similar calculations apply to N, P, and O. The maximum absolute residual is $|r_{\\mathrm{C}}| = 5 \\times 10^{-7}$, which is less than or equal to $\\varepsilon = 10^{-6}$. The test should pass.\n\n- **Case 3**: For oxygen, the model has a bug: $B_{\\mathrm{O}}^{\\mathrm{recorded}}(T) = B_{\\mathrm{O}}(0)$. The residual is $r_{\\mathrm{O}} = B_{\\mathrm{O}}(0) - (B_{\\mathrm{O}}(0) + I_{\\mathrm{O}}^{\\mathrm{num}}) = -I_{\\mathrm{O}}^{\\mathrm{num}} = -I_{\\mathrm{O}}^{\\mathrm{analyt}}$.\n$I_{\\mathrm{O}}^{\\mathrm{analyt}} = \\frac{-(138/106)(1 \\times 10^{-8})(86400)}{50} \\approx -2.25 \\times 10^{-5} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\nThus, $r_{\\mathrm{O}} \\approx 2.25 \\times 10^{-5}$. Since $|r_{\\mathrm{O}}|  \\varepsilon$, the test will fail. The other elements have zero residual.\n\n- **Case 4**: All source terms are zero, so $I_E^{\\mathrm{num}} = 0$ for all $E$. $B_E^{\\mathrm{recorded}}(T) = B_E(0)$. The residual is $r_E = B_E(0) - (B_E(0) + 0) = 0$ for all $E$. The test should pass.\n\nThe implementation will follow this logic, calculating the numerical integrals and then the residuals for each case.",
            "answer": "[[0.0,0.0,0.0,0.0,True],[5e-07,-2e-07,1e-07,-4e-07,True],[0.0,0.0,0.0,2.253207547169811e-05,False],[0.0,0.0,0.0,0.0,True]]"
        }
    ]
}