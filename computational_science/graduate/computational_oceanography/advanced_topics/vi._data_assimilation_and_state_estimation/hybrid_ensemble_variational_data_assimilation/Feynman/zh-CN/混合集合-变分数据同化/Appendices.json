{
    "hands_on_practices": [
        {
            "introduction": "数据同化的核心在于贝叶斯推断，即如何将先验知识（背景场）与新的证据（观测）结合起来。这个练习  将复杂的混合数据同化问题简化为其最基本的形式：一个标量状态变量和一次观测。通过从第一性原理推导后验均值和方差，您将巩固对背景信息和观测信息如何根据其不确定性进行最优加权的理解，为掌握更高级的数据同化技术奠定坚实的基础。",
            "id": "3795131",
            "problem": "考虑使用混合集合-变分（EnVar）数据同化方法，在单个网格点上进行$1$维海洋表面温度分析，其中混合背景协方差由一个有效的标量方差表示。假设观测模型为线性且误差为高斯分布，这与线性高斯极限一致，在该极限下，混合方法简化为使用有效背景协方差的贝叶斯更新。具体而言，假设真实状态 $x$（温度，单位为摄氏度）具有均值为 $x_b$、方差为 $B$ 的高斯先验分布，观测算子为 $H$，使得观测值 $y$ 满足 $y = H x + \\varepsilon$，其中观测误差 $\\varepsilon$ 服从均值为零、方差为 $R$ 的高斯分布。因此，先验和似然与线性高斯贝叶斯估计的基本假设一致。\n\n对于 $H = 1$ 的单个直接温度计观测，使用以下物理上合理的参数：$x_b = 10$（摄氏度），$B = 4$（摄氏度的平方），$y = 12$（摄氏度），以及 $R = 1$（摄氏度的平方）。从高斯先验和似然的定义以及贝叶斯定理的应用出发，在线性高斯设定下推导给定 $y$ 时 $x$ 的后验分布，然后计算后验均值 $x_a$（分析温度）和后验方差 $P_a$（分析不确定性）。\n\n将后验均值 $x_a$ 以摄氏度为单位表示，后验方差 $P_a$ 以摄氏度的平方为单位表示。你的最终数值应为精确值（不要四舍五入）。将你的最终答案报告为有序对 $\\left(x_a, P_a\\right)$。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它有科学依据、适定且客观。问题提供了一套自洽、一致的参数，并要求进行贝叶斯统计中的一个标准推导，这是数据同化的基石。\n\n问题要求在给定先验分布和观测值 $y$ 的情况下，求状态变量 $x$（温度）的后验概率分布 $p(x|y)$。根据贝叶斯定理，后验分布正比于似然与先验的乘积：\n$$\np(x|y) \\propto p(y|x) p(x)\n$$\n状态 $x$ 的先验分布给定为均值为 $x_b$、方差为 $B$ 的高斯分布：\n$$\np(x) = \\mathcal{N}(x; x_b, B) = \\frac{1}{\\sqrt{2\\pi B}} \\exp\\left(-\\frac{1}{2} \\frac{(x-x_b)^2}{B}\\right)\n$$\n观测模型为 $y = Hx + \\varepsilon$，其中观测误差 $\\varepsilon$ 从均值为 0、方差为 $R$ 的高斯分布中抽取。这意味着似然函数，即在给定状态 $x$ 的情况下观测到 $y$ 的概率，也是一个均值为 $Hx$、方差为 $R$ 的高斯分布：\n$$\np(y|x) = \\mathcal{N}(y; Hx, R) = \\frac{1}{\\sqrt{2\\pi R}} \\exp\\left(-\\frac{1}{2} \\frac{(y-Hx)^2}{R}\\right)\n$$\n将这些代入贝叶斯定理：\n$$\np(x|y) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(y-Hx)^2}{R}\\right) \\exp\\left(-\\frac{1}{2} \\frac{(x-x_b)^2}{B}\\right)\n$$\n$$\np(x|y) \\propto \\exp\\left(-\\frac{1}{2} \\left[ \\frac{(y-Hx)^2}{R} + \\frac{(x-x_b)^2}{B} \\right]\\right)\n$$\n方括号中的项是变分代价函数，通常表示为 $J(x)$。后验分布是一个高斯分布，因为两个高斯函数的乘积是一个未归一化的高斯函数。为了找到其参数（均值 $x_a$ 和方差 $P_a$），我们需要将指数项重新整理成标准二次型 $-\\frac{1}{2} \\frac{(x-x_a)^2}{P_a}$。\n让我们分析指数项 $J(x)$：\n$$\nJ(x) = \\frac{(y-Hx)^2}{R} + \\frac{(x-x_b)^2}{B}\n$$\n我们展开平方项：\n$$\nJ(x) = \\frac{y^2 - 2yHx + H^2x^2}{R} + \\frac{x^2 - 2xx_b + x_b^2}{B}\n$$\n现在，我们根据 $x$ 的幂次合并同类项：\n$$\nJ(x) = x^2 \\left(\\frac{H^2}{R} + \\frac{1}{B}\\right) - 2x \\left(\\frac{Hy}{R} + \\frac{x_b}{B}\\right) + \\left(\\frac{y^2}{R} + \\frac{x_b^2}{B}\\right)\n$$\n为了对 $x$ 进行配方，我们识别出 $\\frac{1}{P_a}(x-x_a)^2 = \\frac{1}{P_a}(x^2 - 2xx_a + x_a^2)$ 的形式。\n比较 $x^2$ 的系数，我们得到后验方差 $P_a$ 的倒数：\n$$\n\\frac{1}{P_a} = \\frac{H^2}{R} + \\frac{1}{B}\n$$\n比较 $-2x$ 项的系数，我们有：\n$$\n\\frac{x_a}{P_a} = \\frac{Hy}{R} + \\frac{x_b}{B}\n$$\n由此，我们可以解出后验均值 $x_a$：\n$$\nx_a = P_a \\left(\\frac{Hy}{R} + \\frac{x_b}{B}\\right)\n$$\n代入 $P_a^{-1}$ 的表达式：\n$$\nx_a = \\left(\\frac{H^2}{R} + \\frac{1}{B}\\right)^{-1} \\left(\\frac{Hy}{R} + \\frac{x_b}{B}\\right)\n$$\n问题指明是直接观测，因此观测算子 $H$ 是单位算子，即 $H=1$。公式简化为：\n$$\n\\frac{1}{P_a} = \\frac{1}{R} + \\frac{1}{B} = \\frac{B+R}{BR} \\implies P_a = \\frac{BR}{B+R}\n$$\n对于后验均值 $x_a$：\n$$\nx_a = P_a \\left(\\frac{y}{R} + \\frac{x_b}{B}\\right) = \\frac{BR}{B+R} \\left(\\frac{yB + x_bR}{BR}\\right) = \\frac{yB + x_bR}{B+R}\n$$\n$x_a$ 的这个表达式可以解释为背景均值 $x_b$ 和观测值 $y$ 的加权平均：\n$$\nx_a = \\left(\\frac{R}{B+R}\\right)x_b + \\left(\\frac{B}{B+R}\\right)y\n$$\n观测值的权重是 $K = \\frac{B}{B+R}$，在这个标量情况下被称为卡尔曼增益。\n\n现在，我们代入给定的数值：\n- 背景均值：$x_b = 10$\n- 背景方差：$B = 4$\n- 观测值：$y = 12$\n- 观测误差方差：$R = 1$\n\n我们首先计算后验方差 $P_a$：\n$$\nP_a = \\frac{BR}{B+R} = \\frac{4 \\times 1}{4+1} = \\frac{4}{5}\n$$\n接下来，我们计算后验均值 $x_a$：\n$$\nx_a = \\frac{yB + x_bR}{B+R} = \\frac{(12)(4) + (10)(1)}{4+1} = \\frac{48 + 10}{5} = \\frac{58}{5}\n$$\n因此，后验分布是均值为 $x_a = \\frac{58}{5}$、方差为 $P_a = \\frac{4}{5}$ 的高斯分布。\n分析温度为 $x_a = 11.6$ 摄氏度，分析不确定性（方差）为 $P_a = 0.8$ 摄氏度的平方。问题要求的是有序对 $(x_a, P_a)$。\n\n最终答案是有序对 $\\left(x_a, P_a\\right) = \\left(\\frac{58}{5}, \\frac{4}{5}\\right)$。",
            "answer": "$$\n\\boxed{\n\\left(\\frac{58}{5}, \\frac{4}{5}\\right)\n}\n$$"
        },
        {
            "introduction": "混合集合-变分数据同化的一个关键优势在于，它能利用集合预报来估计不同物理量之间的动态“流依赖”协方差。这个练习  探讨了一个更真实的多元情景，即如何通过观测一个变量（如温度）来更新另一个未被直接观测的变量（如盐度）。通过计算一个“平衡”的盐度增量，您将亲身体验多元协方差在维持海洋模型物理一致性中的强大作用，并实践如何构建一个结合了集合信息和静态气候信息的混合协方差矩阵。",
            "id": "3795180",
            "problem": "在一个原始方程海洋模型的单个网格单元中，考虑由原位温度和实用盐度组成的双分量状态向量，记为 $x = \\begin{pmatrix} T \\\\ S \\end{pmatrix}$。一个混合集合-变分（EnVar）数据同化系统通过线性组合集合估计的协方差和静态气候协方差来构成背景误差协方差。观测仅提供当地的温度。混合组合权重为 $\\beta$，其中 $0  \\beta  1$。\n\n在此网格单元，提供给您的二阶矩统计量如下：\n- 集合估计的二阶矩：$\\operatorname{var}_{e}(T) = 0.6$，$\\operatorname{var}_{e}(S) = 0.25$，以及 $\\operatorname{cov}_{e}(S,T) = -0.09$。\n- 静态气候的二阶矩：$\\operatorname{var}_{s}(T) = 0.4$，$\\operatorname{var}_{s}(S) = 0.3$，以及 $\\operatorname{cov}_{s}(S,T) = -0.06$。\n\n混合权重为 $\\beta = 0.65$。温度观测算子为 $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$，观测误差方差为 $R = 0.05$。在此单元的观测减背景温度新息为 $d = +0.3$。\n\n假设线性高斯动力学和测量误差，并使用与混合EnVar一致的多元线性回归，计算通过同化温度观测在此网格单元产生的平衡盐度分析增量 $\\delta S$。请用实用盐度单位（psu）表示您的最终答案，并将结果四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它在科学上基于海洋学数据同化的原理，问题陈述良好，参数完整且一致，并且表述客观。因此，我们可以着手求解。\n\n目标是计算同化温度观测所产生的盐度分析增量 $\\delta S$。状态向量为 $x = \\begin{pmatrix} T \\\\ S \\end{pmatrix}$，其中 $T$ 是原位温度，$S$ 是实用盐度。分析增量向量 $\\delta x = \\begin{pmatrix} \\delta T \\\\ \\delta S \\end{pmatrix}$ 由标准的线性高斯更新方程给出：\n$$ \\delta x = K d $$\n其中 $d$ 是新息（观测减背景），$K$ 是卡尔曼增益矩阵。\n\n卡尔曼增益 $K$ 定义为：\n$$ K = B H^T (H B H^T + R)^{-1} $$\n此处，$B$ 是背景误差协方差矩阵，$H$ 是观测算子，$R$ 是观测误差方差。\n\n首先，我们必须构建混合背景误差协方差矩阵 $B$。它是静态气候协方差 $B_s$ 和集合估计协方差 $B_e$ 的线性组合。我们在此采用的标准公式为：\n$$ B = (1-\\beta) B_s + \\beta B_e $$\n其中 $\\beta$ 是分配给集合协方差的权重。\n\n问题提供了构建 $B_s$ 和 $B_e$ 所需的二阶矩统计量。\n状态向量的顺序为 $\\begin{pmatrix} T \\\\ S \\end{pmatrix}$。协方差矩阵的形式为 $\\begin{pmatrix} \\operatorname{var}(T)  \\operatorname{cov}(T,S) \\\\ \\operatorname{cov}(S,T)  \\operatorname{var}(S) \\end{pmatrix}$。\n\n根据给定条件：\n集合估计的协方差矩阵 $B_e$ 是：\n$$ B_e = \\begin{pmatrix} 0.6  -0.09 \\\\ -0.09  0.25 \\end{pmatrix} $$\n静态气候协方差矩阵 $B_s$ 是：\n$$ B_s = \\begin{pmatrix} 0.4  -0.06 \\\\ -0.06  0.3 \\end{pmatrix} $$\n\n给定的混合权重为 $\\beta = 0.65$，因此 $1-\\beta = 1 - 0.65 = 0.35$。\n现在我们计算混合协方差矩阵 $B$：\n$$ B = 0.35 \\begin{pmatrix} 0.4  -0.06 \\\\ -0.06  0.3 \\end{pmatrix} + 0.65 \\begin{pmatrix} 0.6  -0.09 \\\\ -0.09  0.25 \\end{pmatrix} $$\n$$ B = \\begin{pmatrix} 0.35 \\times 0.4  0.35 \\times (-0.06) \\\\ 0.35 \\times (-0.06)  0.35 \\times 0.3 \\end{pmatrix} + \\begin{pmatrix} 0.65 \\times 0.6  0.65 \\times (-0.09) \\\\ 0.65 \\times (-0.09)  0.65 \\times 0.25 \\end{pmatrix} $$\n$$ B = \\begin{pmatrix} 0.14  -0.021 \\\\ -0.021  0.105 \\end{pmatrix} + \\begin{pmatrix} 0.39  -0.0585 \\\\ -0.0585  0.1625 \\end{pmatrix} $$\n$$ B = \\begin{pmatrix} 0.14+0.39  -0.021-0.0585 \\\\ -0.021-0.0585  0.105+0.1625 \\end{pmatrix} = \\begin{pmatrix} 0.53  -0.0795 \\\\ -0.0795  0.2675 \\end{pmatrix} $$\n\n接下来，我们计算卡尔曼增益公式中的各项。观测算子为 $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$，其转置为 $H^T = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。观测误差方差为 $R = 0.05$。\n\n计算 $B H^T$：\n$$ B H^T = \\begin{pmatrix} 0.53  -0.0795 \\\\ -0.0795  0.2675 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.53 \\\\ -0.0795 \\end{pmatrix} $$\n\n计算 $H B H^T$：\n$$ H B H^T = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 0.53 \\\\ -0.0795 \\end{pmatrix} = 0.53 $$\n这一项表示投影到观测空间中的背景误差方差。\n\n现在，计算卡尔曼增益的分母，在本例中它是一个标量：\n$$ H B H^T + R = 0.53 + 0.05 = 0.58 $$\n\n我们现在可以组装卡尔曼增益矩阵 $K$：\n$$ K = B H^T (H B H^T + R)^{-1} = \\begin{pmatrix} 0.53 \\\\ -0.0795 \\end{pmatrix} (0.58)^{-1} = \\begin{pmatrix} \\frac{0.53}{0.58} \\\\ \\frac{-0.0795}{0.58} \\end{pmatrix} $$\n\n最后，我们使用给定的新息 $d = 0.3$ 计算分析增量向量 $\\delta x$：\n$$ \\delta x = \\begin{pmatrix} \\delta T \\\\ \\delta S \\end{pmatrix} = K d = \\begin{pmatrix} \\frac{0.53}{0.58} \\\\ \\frac{-0.0795}{0.58} \\end{pmatrix} (0.3) $$\n\n问题要求的是盐度分析增量 $\\delta S$，即向量 $\\delta x$ 的第二个分量：\n$$ \\delta S = \\frac{-0.0795}{0.58} \\times 0.3 $$\n$$ \\delta S = \\frac{-0.02385}{0.58} \\approx -0.0411206896... $$\n\n将结果四舍五入到四位有效数字，我们得到：\n$$ \\delta S \\approx -0.04112 $$\n这个值以实用盐度单位（psu）表示，与问题背景一致。负号在物理上与负的温盐协方差一致；一个正的温度新息（较暖的观测）导致一个负的盐度增量（较淡的分析）。",
            "answer": "$$\\boxed{-0.04112}$$"
        },
        {
            "introduction": "在掌握了贝叶斯更新和多元平衡的概念之后，下一步是理解这些思想如何在实际的变分同化框架中付诸实践。变分方法通过最小化一个代价函数来寻找最优分析场，而“控制变量变换”是实现这一过程的关键技术。本练习  将引导您完成增量式三维变分 (3D-Var) 系统中的一个核心优化步骤，让您具体了解如何将寻找最优状态的抽象问题，转化为在维度更低的控制空间中求解一个易于处理的数值优化问题。",
            "id": "3795136",
            "problem": "考虑一个用于海面温度 (SST) 的两点水平海岸横断面，其由状态向量 $\\boldsymbol{x} \\in \\mathbb{R}^{2}$ 表示，分量为 $\\boldsymbol{x} = (x_{1}, x_{2})^{\\top}$，单位为开尔文。给定一个卫星SST观测值，该观测值测量了两个网格单元的足迹平均值。观测算子是线性行向量 $\\boldsymbol{H} = \\begin{pmatrix} 0.5  0.5 \\end{pmatrix}$，观测值为 $y = 300.6$ 开尔文。背景场为 $\\boldsymbol{x}_{b} = \\begin{pmatrix} 300.0 \\\\ 301.0 \\end{pmatrix}$ 开尔文。观测误差协方差为 $\\boldsymbol{R} = \\begin{pmatrix} 0.09 \\end{pmatrix}$，单位为 $\\text{K}^{2}$。\n\n背景误差协方差 $\\boldsymbol{B}$ 是混合的，由静态协方差和集合衍生协方差的凸组合构成，这在混合集合-变分 (EnVar) 方法中有所使用。具体而言，\n$$\n\\boldsymbol{B} = \\beta\\,\\boldsymbol{B}_{\\text{stat}} + (1-\\beta)\\,\\boldsymbol{B}_{\\text{ens}}\n$$,\n其中 $\\beta = 0.6$，$\\boldsymbol{B}_{\\text{stat}} = \\begin{pmatrix} 1  0.4 \\\\ 0.4  1 \\end{pmatrix}$ 单位为 $\\text{K}^{2}$，且 $\\boldsymbol{B}_{\\text{ens}} = \\begin{pmatrix} 1  0.8 \\\\ 0.8  1 \\end{pmatrix}$ 单位为 $\\text{K}^{2}$。这得到\n$$\n\\boldsymbol{B} = \\begin{pmatrix} 1  0.56 \\\\ 0.56  1 \\end{pmatrix} \\quad \\text{单位为 } \\text{K}^{2}。\n$$\n\n应用增量三维变分 (3D-Var) 公式将观测同化到背景场中。使用控制变量变换 $\\delta \\boldsymbol{x} = \\boldsymbol{L}\\,\\boldsymbol{v}$，其中 $\\boldsymbol{B} = \\boldsymbol{L}\\,\\boldsymbol{L}^{\\top}$ 是 Cholesky 分解，$\\boldsymbol{L}$ 为下三角矩阵。在控制空间 $\\boldsymbol{v}$ 中执行一次最速下降迭代，从 $\\boldsymbol{v}_{0} = \\boldsymbol{0}$ 开始，并通过沿最速下降方向对二次代价进行精确线搜索来选择步长。令 $\\delta \\boldsymbol{x}_{(1)}$ 表示得到的第一次迭代的状态增量。\n\n仅使用增量变分代价函数和控制变量变换的原理，计算第一个网格点在第一次迭代后的增量，即 $\\delta x_{1,(1)}$ 的值，单位为开尔文。将最终数值答案四舍五入至四位有效数字，并以开尔文表示。最终答案必须是单个实数。",
            "solution": "首先验证问题，以确保其具有科学依据、适定且客观。\n\n### 步骤 1：提取已知条件\n- 状态向量：$\\boldsymbol{x} = (x_{1}, x_{2})^{\\top} \\in \\mathbb{R}^{2}$，单位为开尔文 (K)。\n- 观测算子：$\\boldsymbol{H} = \\begin{pmatrix} 0.5  0.5 \\end{pmatrix}$。\n- 观测值：$y = 300.6$ K。\n- 背景场：$\\boldsymbol{x}_{b} = \\begin{pmatrix} 300.0 \\\\ 301.0 \\end{pmatrix}$ K。\n- 观测误差协方差：$\\boldsymbol{R} = \\begin{pmatrix} 0.09 \\end{pmatrix}$，单位为 K$^2$。\n- 混合背景误差协方差：$\\boldsymbol{B} = \\beta\\,\\boldsymbol{B}_{\\text{stat}} + (1-\\beta)\\,\\boldsymbol{B}_{\\text{ens}}$。\n- 混合系数：$\\beta = 0.6$。\n- 静态背景误差协方差：$\\boldsymbol{B}_{\\text{stat}} = \\begin{pmatrix} 1  0.4 \\\\ 0.4  1 \\end{pmatrix}$ K$^2$。\n- 集合衍生背景误差协方差：$\\boldsymbol{B}_{\\text{ens}} = \\begin{pmatrix} 1  0.8 \\\\ 0.8  1 \\end{pmatrix}$ K$^2$。\n- 问题给出了最终的混合协方差矩阵：$\\boldsymbol{B} = \\begin{pmatrix} 1  0.56 \\\\ 0.56  1 \\end{pmatrix}$ K$^2$。检验确认了这一点：$0.6 \\times 0.4 + (1-0.6) \\times 0.8 = 0.24 + 0.4 \\times 0.8 = 0.24 + 0.32 = 0.56$。对角线元素为 $0.6 \\times 1 + 0.4 \\times 1 = 1$。所提供的矩阵是正确的。\n- 同化方法：增量三维变分 (3D-Var) 公式。\n- 控制变量变换：$\\delta \\boldsymbol{x} = \\boldsymbol{L}\\,\\boldsymbol{v}$，其中 $\\boldsymbol{B} = \\boldsymbol{L}\\,\\boldsymbol{L}^{\\top}$ 是 $\\boldsymbol{B}$ 的 Cholesky 分解，$\\boldsymbol{L}$ 是一个下三角矩阵。\n- 优化过程：在 $\\boldsymbol{v}$ 的控制空间中进行一次最速下降迭代，从 $\\boldsymbol{v}_{0} = \\boldsymbol{0}$ 开始。\n- 步长：通过对代价函数进行精确线搜索来确定。\n- 待计算量：一次迭代后状态增量的第一个分量，记为 $\\delta x_{1,(1)}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于数据同化的既定原则，特别是像 3D-Var 这样的混合集合-变分 (EnVar) 方法。所有术语、矩阵和过程在计算海洋学和大气科学中都是标准的。\n- **适定性：** 所有必要的数据都已提供。背景误差协方差矩阵 $\\boldsymbol{B}$ 是对称正定的，因为其行列式为 $1 - (0.56)^2 = 1 - 0.3136 = 0.6864 > 0$ 且其迹为 $2 > 0$。观测误差协方差 $\\boldsymbol{R}$ 是一个正标量。由此产生的代价函数是二次且凸的，保证了唯一的最小值。该任务是一个优化算法中定义明确的单一步骤。\n- **客观性：** 问题以精确、定量和无偏的数学语言陈述。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**，因为它是自洽的、科学上合理的并且是适定的。将推导求解过程。\n\n### 解题推导\n\n状态增量 $\\delta\\boldsymbol{x}$ 的增量 3D-Var 代价函数由下式给出：\n$$\nJ(\\delta\\boldsymbol{x}) = \\frac{1}{2} \\delta\\boldsymbol{x}^{\\top} \\boldsymbol{B}^{-1} \\delta\\boldsymbol{x} + \\frac{1}{2} (\\boldsymbol{H}\\delta\\boldsymbol{x} - \\boldsymbol{d})^{\\top} \\boldsymbol{R}^{-1} (\\boldsymbol{H}\\delta\\boldsymbol{x} - \\boldsymbol{d})\n$$\n其中 $\\boldsymbol{d} = y - \\boldsymbol{H}\\boldsymbol{x}_b$ 是新息向量（在本例中为标量）。\n\n使用控制变量变换 $\\delta\\boldsymbol{x} = \\boldsymbol{L}\\boldsymbol{v}$ 及其推论 $\\delta\\boldsymbol{x}^{\\top}\\boldsymbol{B}^{-1}\\delta\\boldsymbol{x} = \\boldsymbol{v}^{\\top}\\boldsymbol{L}^{\\top}(\\boldsymbol{L}\\boldsymbol{L}^{\\top})^{-1}\\boldsymbol{L}\\boldsymbol{v} = \\boldsymbol{v}^{\\top}\\boldsymbol{v}$，以控制变量 $\\boldsymbol{v}$ 表示的代价函数变为：\n$$\nJ(\\boldsymbol{v}) = \\frac{1}{2} \\boldsymbol{v}^{\\top}\\boldsymbol{v} + \\frac{1}{2} (\\boldsymbol{H}\\boldsymbol{L}\\boldsymbol{v} - \\boldsymbol{d})^{\\top} \\boldsymbol{R}^{-1} (\\boldsymbol{H}\\boldsymbol{L}\\boldsymbol{v} - \\boldsymbol{d})\n$$\n这是一个关于 $\\boldsymbol{v}$ 的二次函数。代价函数相对于 $\\boldsymbol{v}$ 的梯度是：\n$$\n\\nabla J(\\boldsymbol{v}) = \\boldsymbol{v} + (\\boldsymbol{H}\\boldsymbol{L})^{\\top} \\boldsymbol{R}^{-1} (\\boldsymbol{H}\\boldsymbol{L}\\boldsymbol{v} - \\boldsymbol{d})\n$$\n最速下降法迭代更新控制变量：\n$$\n\\boldsymbol{v}_{k+1} = \\boldsymbol{v}_{k} - \\alpha_k \\nabla J(\\boldsymbol{v}_{k})\n$$\n我们从 $\\boldsymbol{v}_0 = \\boldsymbol{0}$ 开始。该点的梯度 $\\boldsymbol{g}_0 = \\nabla J(\\boldsymbol{v}_0)$ 为：\n$$\n\\boldsymbol{g}_0 = \\boldsymbol{0} + (\\boldsymbol{H}\\boldsymbol{L})^{\\top} \\boldsymbol{R}^{-1} (\\boldsymbol{H}\\boldsymbol{L}\\boldsymbol{0} - \\boldsymbol{d}) = -(\\boldsymbol{H}\\boldsymbol{L})^{\\top} \\boldsymbol{R}^{-1} \\boldsymbol{d}\n$$\n步长 $\\alpha_0$ 通过精确线搜索确定，对于二次代价函数，其具有闭式解：\n$$\n\\alpha_0 = \\frac{\\boldsymbol{g}_{0}^{\\top}\\boldsymbol{g}_{0}}{\\boldsymbol{g}_{0}^{\\top}\\boldsymbol{A}\\boldsymbol{g}_{0}}\n$$\n其中 $\\boldsymbol{A}$ 是 $J(\\boldsymbol{v})$ 的 Hessian 矩阵，它是一个常数矩阵：\n$$\n\\boldsymbol{A} = \\frac{\\partial^2 J}{\\partial \\boldsymbol{v} \\partial \\boldsymbol{v}^{\\top}} = \\boldsymbol{I} + (\\boldsymbol{H}\\boldsymbol{L})^{\\top} \\boldsymbol{R}^{-1} (\\boldsymbol{H}\\boldsymbol{L})\n$$\n因此，第一次迭代的更新为 $\\boldsymbol{v}_1 = \\boldsymbol{v}_0 - \\alpha_0 \\boldsymbol{g}_0 = -\\alpha_0 \\boldsymbol{g}_0$。一旦找到 $\\boldsymbol{v}_1$，状态增量就计算为 $\\delta \\boldsymbol{x}_{(1)} = \\boldsymbol{L}\\boldsymbol{v}_1$。\n\n我们现在进行数值计算。\n\n1.  **新息向量 $\\boldsymbol{d}$**：\n    $$\n    \\boldsymbol{H}\\boldsymbol{x}_b = \\begin{pmatrix} 0.5  0.5 \\end{pmatrix} \\begin{pmatrix} 300.0 \\\\ 301.0 \\end{pmatrix} = 0.5 \\times 300.0 + 0.5 \\times 301.0 = 150.0 + 150.5 = 300.5\n    $$\n    $$\n    \\boldsymbol{d} = y - \\boldsymbol{H}\\boldsymbol{x}_b = 300.6 - 300.5 = 0.1\n    $$\n\n2.  **$\\boldsymbol{B}$ 的 Cholesky 分解**：\n    我们需要找到一个下三角矩阵 $\\boldsymbol{L} = \\begin{pmatrix} l_{11}  0 \\\\ l_{21}  l_{22} \\end{pmatrix}$ 使得 $\\boldsymbol{L}\\boldsymbol{L}^{\\top} = \\boldsymbol{B} = \\begin{pmatrix} 1  0.56 \\\\ 0.56  1 \\end{pmatrix}$。\n    $l_{11}^2 = 1 \\implies l_{11} = 1$。\n    $l_{21}l_{11} = 0.56 \\implies l_{21} = 0.56$。\n    $l_{21}^2 + l_{22}^2 = 1 \\implies (0.56)^2 + l_{22}^2 = 1 \\implies 0.3136 + l_{22}^2 = 1$。\n    $l_{22}^2 = 1 - 0.3136 = 0.6864 \\implies l_{22} = \\sqrt{0.6864}$。\n    所以，$\\boldsymbol{L} = \\begin{pmatrix} 1  0 \\\\ 0.56  \\sqrt{0.6864} \\end{pmatrix}$。\n\n3.  **中间项**：\n    $\\boldsymbol{R}^{-1} = (0.09)^{-1} = \\frac{1}{0.09} = \\frac{100}{9}$。\n    $\\boldsymbol{H}\\boldsymbol{L} = \\begin{pmatrix} 0.5  0.5 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0.56  \\sqrt{0.6864} \\end{pmatrix} = \\begin{pmatrix} 0.5(1) + 0.5(0.56)  0.5(\\sqrt{0.6864}) \\end{pmatrix} = \\begin{pmatrix} 0.78  0.5\\sqrt{0.6864} \\end{pmatrix}$。\n\n4.  **$\\boldsymbol{v}_0$ 处的梯度**：\n    $$\n    \\boldsymbol{g}_0 = -(\\boldsymbol{H}\\boldsymbol{L})^{\\top} \\boldsymbol{R}^{-1} \\boldsymbol{d} = - \\begin{pmatrix} 0.78 \\\\ 0.5\\sqrt{0.6864} \\end{pmatrix} \\left(\\frac{100}{9}\\right) (0.1) = -\\frac{10}{9} \\begin{pmatrix} 0.78 \\\\ 0.5\\sqrt{0.6864} \\end{pmatrix}\n    $$\n\n5.  **步长 $\\alpha_0$**：\n    对于这种只有一个观测的特定问题结构，梯度 $\\boldsymbol{g}_0$ 是 Hessian 矩阵 $\\boldsymbol{A}$ 的一个特征向量。这意味着带有精确线搜索的最速下降法的第一步就会收敛到真实最小值。步长是相应特征值的倒数，$\\alpha_0 = 1/\\lambda$。\n    特征值为 $\\lambda = 1 + \\boldsymbol{R}^{-1}(\\boldsymbol{H}\\boldsymbol{L})(\\boldsymbol{H}\\boldsymbol{L})^{\\top}$。\n    $$\n    (\\boldsymbol{H}\\boldsymbol{L})(\\boldsymbol{H}\\boldsymbol{L})^{\\top} = (0.78)^2 + (0.5\\sqrt{0.6864})^2 = 0.6084 + 0.25(0.6864) = 0.6084 + 0.1716 = 0.78\n    $$\n    注意，这等价于 $\\boldsymbol{H}\\boldsymbol{B}\\boldsymbol{H}^{\\top} = \\begin{pmatrix} 0.5  0.5 \\end{pmatrix} \\begin{pmatrix} 1  0.56 \\\\ 0.56  1 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 0.5 \\end{pmatrix} = 0.78$。\n    特征值为：\n    $$\n    \\lambda = 1 + \\left(\\frac{100}{9}\\right) (0.78) = 1 + \\frac{78}{9} = 1 + \\frac{26}{3} = \\frac{29}{3}\n    $$\n    步长为：\n    $$\n    \\alpha_0 = \\frac{1}{\\lambda} = \\frac{3}{29}\n    $$\n\n6.  **控制变量更新 $\\boldsymbol{v}_1$**：\n    $$\n    \\boldsymbol{v}_1 = -\\alpha_0 \\boldsymbol{g}_0 = -\\left(\\frac{3}{29}\\right) \\left(-\\frac{10}{9} \\begin{pmatrix} 0.78 \\\\ 0.5\\sqrt{0.6864} \\end{pmatrix}\\right) = \\frac{10}{87} \\begin{pmatrix} 0.78 \\\\ 0.5\\sqrt{0.6864} \\end{pmatrix}\n    $$\n\n7.  **状态增量 $\\delta \\boldsymbol{x}_{(1)}$**：\n    $$\n    \\delta \\boldsymbol{x}_{(1)} = \\boldsymbol{L}\\boldsymbol{v}_1 = \\begin{pmatrix} 1  0 \\\\ 0.56  \\sqrt{0.6864} \\end{pmatrix} \\frac{10}{87} \\begin{pmatrix} 0.78 \\\\ 0.5\\sqrt{0.6864} \\end{pmatrix}\n    $$\n    $$\n    \\delta \\boldsymbol{x}_{(1)} = \\frac{10}{87} \\begin{pmatrix} 1 \\times 0.78 + 0 \\\\ 0.56 \\times 0.78 + \\sqrt{0.6864} \\times 0.5\\sqrt{0.6864} \\end{pmatrix}\n    $$\n    $$\n    \\delta \\boldsymbol{x}_{(1)} = \\frac{10}{87} \\begin{pmatrix} 0.78 \\\\ 0.4368 + 0.5 \\times 0.6864 \\end{pmatrix} = \\frac{10}{87} \\begin{pmatrix} 0.78 \\\\ 0.4368 + 0.3432 \\end{pmatrix} = \\frac{10}{87} \\begin{pmatrix} 0.78 \\\\ 0.78 \\end{pmatrix}\n    $$\n\n8.  **目标分量 $\\delta x_{1,(1)}$**：\n    增量的第一个分量是：\n    $$\n    \\delta x_{1,(1)} = \\frac{10}{87} \\times 0.78 = \\frac{7.8}{87} = \\frac{78}{870} = \\frac{13}{145}\n    $$\n    转换为小数值：\n    $$\n    \\delta x_{1,(1)} = \\frac{13}{145} \\approx 0.08965517...\n    $$\n    四舍五入到四位有效数字，我们得到 $0.08966$。单位是开尔文。",
            "answer": "$$\n\\boxed{0.08966}\n$$"
        }
    ]
}