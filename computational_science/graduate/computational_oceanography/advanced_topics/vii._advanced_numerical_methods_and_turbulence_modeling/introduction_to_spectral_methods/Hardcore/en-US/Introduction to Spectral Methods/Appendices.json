{
    "hands_on_practices": [
        {
            "introduction": "At the heart of all spectral methods lies the ability to represent a function as a weighted sum of basis functions, such as sines and cosines. This hands-on practice will guide you through the fundamental calculation of a Fourier coefficient, which quantifies the contribution of a specific basis function to the overall signal. Understanding this process of projection via integration is the essential first step to building intuition for spectral analysis and synthesis .",
            "id": "2114651",
            "problem": "Consider a function $f(x)=1$ defined over the interval $x \\in [0, \\pi]$. We wish to approximate this function using its Fourier sine series, which is given by the general form:\n$$S(x) = \\sum_{n=1}^{\\infty} b_n \\sin(nx)$$\nThe coefficients $b_n$ are constants determined by the specific function $f(x)$ being approximated.\n\nCalculate the exact analytical value of the coefficient $b_3$ for the Fourier sine series of the function $f(x)=1$ on the specified interval.",
            "solution": "We expand $f(x)=1$ on $[0,\\pi]$ in a Fourier sine series $S(x)=\\sum_{n=1}^{\\infty} b_{n} \\sin(nx)$. By orthogonality on $[0,\\pi]$, the coefficients are determined by\n$$\nb_{n}=\\frac{2}{\\pi}\\int_{0}^{\\pi} f(x)\\sin(nx)\\,dx,\n$$\nsince $\\int_{0}^{\\pi}\\sin(nx)\\sin(mx)\\,dx=\\frac{\\pi}{2}\\delta_{nm}$.\n\nFor $f(x)=1$,\n$$\nb_{n}=\\frac{2}{\\pi}\\int_{0}^{\\pi}\\sin(nx)\\,dx.\n$$\nCompute the integral:\n$$\n\\int_{0}^{\\pi}\\sin(nx)\\,dx=\\left[-\\frac{1}{n}\\cos(nx)\\right]_{0}^{\\pi}=-\\frac{1}{n}\\cos(n\\pi)+\\frac{1}{n}\\cos(0)=\\frac{1}{n}\\left(1-(-1)^{n}\\right).\n$$\nTherefore,\n$$\nb_{n}=\\frac{2}{\\pi n}\\left(1-(-1)^{n}\\right).\n$$\nFor $n=3$, we have $(-1)^{3}=-1$, hence\n$$\nb_{3}=\\frac{2}{3\\pi}\\left(1-(-1)\\right)=\\frac{2}{3\\pi}\\cdot 2=\\frac{4}{3\\pi}.\n$$",
            "answer": "$$\\boxed{\\frac{4}{3\\pi}}$$"
        },
        {
            "introduction": "When analyzing real-world data, such as sea level records, we work with discrete samples of a continuous process. This practice problem tackles aliasing, a critical pitfall where high-frequency signals are misrepresented as lower frequencies due to insufficient sampling. By working through a realistic oceanographic scenario involving tidal constituents, you will learn to derive and calculate the aliased frequency, a vital skill for ensuring the integrity of time series analysis .",
            "id": "3796086",
            "problem": "Consider a continuous-time sea level signal modeled locally as a single real sinusoid $s(t) = A \\cos(\\omega_{0} t + \\phi)$, where $A$ is amplitude, $\\phi$ is phase, and $\\omega_{0} > 0$ is the true angular frequency. The signal is sampled uniformly at interval $\\Delta t > 0$, producing a discrete-time sequence $x[n] = s(n \\Delta t)$ for integer $n$. Let the sampling angular frequency be $\\omega_{s} = \\frac{2\\pi}{\\Delta t}$ and the Nyquist angular frequency be $\\omega_{N} = \\frac{\\pi}{\\Delta t}$. Using only first principles about sampling represented as multiplication by a Dirac comb and the periodicity of the discrete-time complex exponential, derive an expression for the aliased angular frequency that would be observed in the principal discrete-time baseband $[0, \\omega_{N}]$ when $\\omega_{0} > \\omega_{N}$. Explicitly justify how the integer indexing of spectral replicas enters the expression and why the absolute value appears for a real cosine.\n\nThen, illustrate the result with a physically realistic computational oceanography scenario: the principal lunar semidiurnal tide ($\\mathrm{M2}$) has period $P = 12.4206012$ hours. Suppose sea level is sampled every $\\Delta t = 13$ hours. Compute the aliased frequency in cycles per day (cpd) that would be estimated from the sampled time series if a spectral method such as the Discrete Fourier Transform (DFT) is applied. For the numerical part, express your final answer for the aliased frequency in cpd and round your answer to five significant figures.",
            "solution": "The problem asks for a derivation of the aliased frequency and a numerical calculation for a specific oceanographic scenario.\n\n**Part 1: Derivation of the Aliased Frequency**\n\nA continuous-time sinusoidal signal is given by $s(t) = A \\cos(\\omega_{0} t + \\phi)$, where $A$ is the amplitude, $\\phi$ is the phase, and $\\omega_{0} > 0$ is the true angular frequency. Using Euler's formula, we can express the real-valued cosine as the sum of two complex exponentials:\n$$s(t) = \\frac{A}{2} \\left( e^{i(\\omega_{0} t + \\phi)} + e^{-i(\\omega_{0} t + \\phi)} \\right) = \\frac{A}{2} e^{i\\phi} e^{i\\omega_{0} t} + \\frac{A}{2} e^{-i\\phi} e^{-i\\omega_{0} t}$$\nThe continuous-time Fourier Transform (CTFT) of $s(t)$, denoted $S(\\omega)$, is found by using the transform pair $\\mathcal{F}\\{e^{i\\omega_{a}t}\\} = 2\\pi\\delta(\\omega - \\omega_{a})$, where $\\delta(\\cdot)$ is the Dirac delta function. The spectrum is:\n$$S(\\omega) = \\frac{A}{2} e^{i\\phi} (2\\pi\\delta(\\omega - \\omega_{0})) + \\frac{A}{2} e^{-i\\phi} (2\\pi\\delta(\\omega + \\omega_{0})) = A\\pi \\left( e^{i\\phi}\\delta(\\omega - \\omega_{0}) + e^{-i\\phi}\\delta(\\omega + \\omega_{0}) \\right)$$\nThis shows that the spectrum of the continuous signal consists of two impulses at angular frequencies $\\omega = \\omega_{0}$ and $\\omega = -\\omega_{0}$.\n\nSampling the signal $s(t)$ at a uniform interval $\\Delta t$ is modeled as multiplying $s(t)$ by an infinite train of Dirac delta functions, known as a Dirac comb:\n$$p(t) = \\sum_{n=-\\infty}^{\\infty} \\delta(t-n\\Delta t)$$\nThe sampled signal in the continuous domain is $s_{p}(t) = s(t)p(t)$. The Fourier transform of the Dirac comb is another Dirac comb, scaled and with a reciprocal period:\n$$P(\\omega) = \\mathcal{F}\\{p(t)\\} = \\frac{2\\pi}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} \\delta\\left(\\omega - k \\frac{2\\pi}{\\Delta t}\\right) = \\omega_{s} \\sum_{k=-\\infty}^{\\infty} \\delta(\\omega - k\\omega_{s})$$\nwhere $\\omega_{s} = \\frac{2\\pi}{\\Delta t}$ is the sampling angular frequency and $k$ is an integer index.\n\nMultiplication in the time domain corresponds to convolution in the frequency domain. The spectrum of the sampled signal, $S_{p}(\\omega)$, is given by:\n$$S_{p}(\\omega) = \\frac{1}{2\\pi} (S(\\omega) * P(\\omega)) = \\frac{1}{2\\pi} \\left( S(\\omega) * \\left( \\omega_{s} \\sum_{k=-\\infty}^{\\infty} \\delta(\\omega - k\\omega_{s}) \\right) \\right)$$\n$$S_{p}(\\omega) = \\frac{\\omega_{s}}{2\\pi} \\sum_{k=-\\infty}^{\\infty} (S(\\omega) * \\delta(\\omega - k\\omega_{s})) = \\frac{1}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} S(\\omega - k\\omega_{s})$$\nThis fundamental result shows that the spectrum of the sampled signal consists of periodically repeated replicas of the original signal's spectrum $S(\\omega)$, shifted by integer multiples of the sampling frequency $\\omega_{s}$.\n\nSubstituting the expression for $S(\\omega)$, we get:\n$$S_{p}(\\omega) = \\frac{A\\pi}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} \\left( e^{i\\phi}\\delta(\\omega - \\omega_{0} - k\\omega_{s}) + e^{-i\\phi}\\delta(\\omega + \\omega_{0} - k\\omega_{s}) \\right)$$\nThe spectral replicas of the original impulses at $\\pm\\omega_{0}$ are now located at all frequencies $\\omega = \\pm \\omega_{0} + k\\omega_{s}$ for all integers $k$. This explicitly shows how the integer indexing $k$ of spectral replicas arises from the sampling process.\n\nA discrete-time system, such as one analyzing the sequence $x[n] = s(n\\Delta t)$, can only unambiguously represent frequencies within the principal baseband, which for a real signal is typically taken as $[0, \\omega_{N}]$, where $\\omega_{N} = \\frac{\\pi}{\\Delta t} = \\frac{\\omega_{s}}{2}$ is the Nyquist frequency. If the true frequency $\\omega_0$ is greater than $\\omega_N$, its spectral energy will be \"aliased\" or \"folded\" into the baseband.\n\nThe aliased frequency, $\\omega_{a}'$, is the frequency of the replica that falls into the interval $[-\\omega_{N}, \\omega_{N}]$. We must find an integer $k_{m}$ such that $\\omega'_{a} = \\omega_{0} - k_{m}\\omega_{s}$ satisfies $|\\omega'_{a}| \\le \\omega_{N}$.\n$$|\\omega_{0} - k_{m}\\omega_{s}| \\le \\frac{\\omega_{s}}{2}$$\nDividing by $\\omega_{s}$ gives:\n$$|\\frac{\\omega_{0}}{\\omega_{s}} - k_{m}| \\le \\frac{1}{2}$$\nThis inequality defines $k_{m}$ as the integer closest to the ratio $\\frac{\\omega_{0}}{\\omega_{s}}$. Therefore, $k_{m} = \\text{round}(\\frac{\\omega_{0}}{\\omega_{s}})$. The aliased frequency in the range $[-\\omega_{N}, \\omega_{N}]$ is $\\omega'_{a} = \\omega_{0} - \\omega_{s} \\cdot \\text{round}(\\frac{\\omega_{0}}{\\omega_{s}})$.\n\nThe reason for the absolute value comes from the fact that a real signal $s(t)$ has a conjugate-symmetric spectrum, with power at both $+\\omega_{0}$ and $-\\omega_{0}$. After sampling, the replicas of $+\\omega_{0}$ alias to $\\omega'_{a}$, and the replicas of $-\\omega_{0}$ alias to $-\\omega'_{a}$ (since they are mapped symmetrically around $\\omega=0$). The discrete-time sequence $x[n]$ therefore contains components corresponding to both $\\pm\\omega'_{a}$. A spectral analysis method like the DFT will reveal power at a single positive frequency. The observed aliased angular frequency, $\\omega_{alias}$, in the principal baseband $[0, \\omega_{N}]$ is the magnitude of this frequency:\n$$\\omega_{alias} = |\\omega'_{a}| = \\left|\\omega_{0} - \\omega_{s} \\cdot \\text{round}\\left(\\frac{\\omega_{0}}{\\omega_{s}}\\right)\\right|$$\n\n**Part 2: Numerical Illustration**\n\nWe are given the period of the $\\mathrm{M2}$ tide, $P = 12.4206012$ hours, and a sampling interval $\\Delta t = 13$ hours. We need to find the aliased frequency in cycles per day (cpd). It is convenient to work with frequency $f = \\frac{\\omega}{2\\pi}$ rather than angular frequency $\\omega$. The aliasing formula is analogous: $f_{alias} = |f_{0} - f_{s} \\cdot \\text{round}(\\frac{f_{0}}{f_{s}})|$.\n\n1.  **Calculate the true frequency $f_0$**:\n    The period is $P = 12.4206012$ hours. The frequency in cycles per hour (cph) is $f_{0} = \\frac{1}{P} = \\frac{1}{12.4206012}$ cph.\n    To convert to cycles per day (cpd), we multiply by $24$ hours/day:\n    $$f_{0} = \\frac{24}{12.4206012} \\text{ cpd} \\approx 1.93227365 \\text{ cpd}$$\n\n2.  **Calculate the sampling frequency $f_s$**:\n    The sampling interval is $\\Delta t = 13$ hours. The sampling frequency is $f_{s} = \\frac{1}{\\Delta t} = \\frac{1}{13}$ cph.\n    Converting to cpd:\n    $$f_{s} = \\frac{24}{13} \\text{ cpd} \\approx 1.84615385 \\text{ cpd}$$\n\n3.  **Check for aliasing**:\n    The Nyquist frequency is $f_{N} = \\frac{f_{s}}{2} = \\frac{12}{13} \\text{ cpd} \\approx 0.92307692 \\text{ cpd}$.\n    Since $f_{0} \\approx 1.932 \\text{ cpd}$ is greater than $f_{N} \\approx 0.923 \\text{ cpd}$, aliasing will occur.\n\n4.  **Calculate the aliased frequency $f_{alias}$**:\n    First, find the integer index $k_{m}$:\n    $$k_{m} = \\text{round}\\left(\\frac{f_{0}}{f_{s}}\\right) = \\text{round}\\left(\\frac{24/12.4206012}{24/13}\\right) = \\text{round}\\left(\\frac{13}{12.4206012}\\right)$$\n    $$k_{m} = \\text{round}(1.046648...) = 1$$\n    Now, apply the aliasing formula:\n    $$f_{alias} = |f_{0} - k_{m}f_{s}| = \\left|\\frac{24}{12.4206012} - 1 \\cdot \\frac{24}{13}\\right|$$\n    $$f_{alias} = 24 \\left| \\frac{1}{12.4206012} - \\frac{1}{13} \\right|$$\n    Since $12.4206012 < 13$, the term inside the absolute value is positive.\n    $$f_{alias} = 24 \\left( \\frac{1}{12.4206012} - \\frac{1}{13} \\right) \\text{ cpd}$$\n    $$f_{alias} \\approx 24 \\times (0.0805118 - 0.0769231) \\text{ cpd} \\approx 24 \\times 0.0035887 \\text{ cpd}$$\n    $$f_{alias} \\approx 0.0861288 \\text{ cpd}$$\n    Using higher precision for the intermediate values:\n    $f_{0} \\approx 1.932273654$ cpd\n    $f_{s} \\approx 1.846153846$ cpd\n    $f_{alias} = |1.932273654 - 1.846153846| \\text{ cpd} = 0.086119808 \\text{ cpd}$\n\n    Rounding to five significant figures, we get $0.086120$.",
            "answer": "$$\\boxed{0.086120}$$"
        },
        {
            "introduction": "One of the most powerful applications of spectral methods is in finding highly accurate numerical solutions to the differential equations that model physical systems. This problem introduces the Chebyshev collocation method, where the equation is solved on a grid of specific points to achieve rapid convergence. By constructing and solving the matrix system for a complex integro-differential equation, you will gain insight into the mechanics of pseudospectral methods used widely in geophysical fluid dynamics and beyond .",
            "id": "2114664",
            "problem": "Consider the one-dimensional integro-differential equation on the domain $x \\in [-1, 1]$:\n$$-u_{xx}(x) + \\alpha u(x) = f(x) + \\beta \\int_{-1}^{1} u(y) \\, dy$$\nThe solution $u(x)$ is subject to the boundary conditions:\n$$u(-1) = 0 \\quad \\text{and} \\quad u'(1) = \\gamma u(1)$$\nHere, $\\alpha$, $\\beta$, and $\\gamma$ are real constants.\n\nWe aim to solve this problem numerically using a Chebyshev collocation (pseudospectral) method. The solution $u(x)$ is approximated by a single global polynomial $u_N(x)$ of degree at most $N$. The collocation points are the $N+1$ Chebyshev-Gauss-Lobatto (CGL) nodes, given by $x_j = \\cos\\left(\\frac{j\\pi}{N}\\right)$ for $j=0, 1, \\dots, N$. The values of the polynomial at these nodes, $u_j = u_N(x_j)$, are the unknowns to be determined. The differential equation and boundary conditions are enforced exactly at these nodes.\n\nFor a discretization with $N=3$, a forcing function $f(x) = 2x^2 - 1$, and constants $\\alpha=1$, $\\beta=1$, $\\gamma=1$, find the value of the solution at the node $x_1$, which is denoted by $u_1$.\n\nExpress your answer for $u_1$ as an exact fraction in simplest form.",
            "solution": "We discretize with $N=3$ Chebyshev-Gauss-Lobatto nodes $x_{j}=\\cos\\left(\\frac{j\\pi}{3}\\right)$ for $j=0,1,2,3$, which are\n$$\nx_{0}=1,\\quad x_{1}=\\frac{1}{2},\\quad x_{2}=-\\frac{1}{2},\\quad x_{3}=-1.\n$$\nLet $u_{j}=u(x_{j})$. The first-derivative Chebyshev differentiation matrix $D$ at these nodes has entries\n$$\nD_{ij}=\\begin{cases}\n\\dfrac{c_{i}}{c_{j}}\\dfrac{(-1)^{i+j}}{x_{i}-x_{j}}, & i\\neq j, \\\\[6pt]\n\\dfrac{2N^{2}+1}{6}, & i=j=0, \\\\[4pt]\n-\\dfrac{2N^{2}+1}{6}, & i=j=N, \\\\[4pt]\n-\\dfrac{x_{j}}{2(1-x_{j}^{2})}, & \\text{otherwise},\n\\end{cases}\n$$\nwith $c_{0}=c_{N}=2$ and $c_{1}=c_{2}=1$, $N=3$. A direct computation gives\n$$\nD=\\begin{pmatrix}\n\\dfrac{19}{6} & -4 & \\dfrac{4}{3} & -\\dfrac{1}{2} \\\\[6pt]\n1 & -\\dfrac{1}{3} & -1 & \\dfrac{1}{3} \\\\[6pt]\n-\\dfrac{1}{3} & 1 & \\dfrac{1}{3} & -1 \\\\[6pt]\n\\dfrac{1}{2} & -\\dfrac{4}{3} & 4 & -\\dfrac{19}{6}\n\\end{pmatrix}.\n$$\nThe second-derivative matrix is $D^{(2)}=D^{2}$. Multiplying, the rows needed at the interior nodes $j=1,2$ are\n$$\nD^{(2)}_{1,\\cdot}=\\left(\\dfrac{10}{3},\\,-\\dfrac{16}{3},\\,\\dfrac{8}{3},\\,-\\dfrac{2}{3}\\right),\\qquad\nD^{(2)}_{2,\\cdot}=\\left(-\\dfrac{2}{3},\\,\\dfrac{8}{3},\\,-\\dfrac{16}{3},\\,\\dfrac{10}{3}\\right).\n$$\n\nWe enforce the PDE at the interior nodes and the boundary conditions at the endpoints. With $\\alpha=\\beta=\\gamma=1$ and $f(x)=2x^{2}-1$, the discrete equations at $j=1,2$ are\n$$\n-\\left(D^{(2)}u\\right)_{j}+u_{j}=f_{j}+I,\\quad j=1,2,\n$$\nwhere $I=\\int_{-1}^{1}u(y)\\,dy$ is approximated by exactly integrating the degree-$3$ interpolant $u_{N}$:\n$$\nI=\\sum_{j=0}^{3}w_{j}u_{j},\\quad w_{j}=\\int_{-1}^{1}\\ell_{j}(x)\\,dx.\n$$\nImposing exactness for monomials up to degree $3$ and using symmetry gives $w_{0}=w_{3}=a$, $w_{1}=w_{2}=b$ with\n$$\na+b=1,\\qquad 2a+\\frac{b}{2}=\\frac{2}{3}\\ \\Longrightarrow\\ a=\\frac{1}{9},\\ b=\\frac{8}{9}.\n$$\nHence\n$$\nI=\\frac{1}{9}u_{0}+\\frac{8}{9}u_{1}+\\frac{8}{9}u_{2}+\\frac{1}{9}u_{3}.\n$$\n\nThe boundary conditions are $u(-1)=0\\Rightarrow u_{3}=0$ and $u'(1)=u(1)\\Rightarrow (Du)_{0}=u_{0}$, i.e.\n$$\n\\left(\\frac{19}{6}\\right)u_{0}-4u_{1}+\\left(\\frac{4}{3}\\right)u_{2}-\\left(\\frac{1}{2}\\right)u_{3}=u_{0}\\ \\Longrightarrow\\ 13u_{0}-24u_{1}+8u_{2}=0.\n$$\n\nEvaluate $f$ at the nodes:\n$$\nf_{0}=1,\\quad f_{1}=-\\frac{1}{2},\\quad f_{2}=-\\frac{1}{2},\\quad f_{3}=1.\n$$\nUsing $u_{3}=0$ and $I=\\frac{1}{9}u_{0}+\\frac{8}{9}u_{1}+\\frac{8}{9}u_{2}$, the interior equations become\n$$\n-\\left(\\frac{10}{3}u_{0}-\\frac{16}{3}u_{1}+\\frac{8}{3}u_{2}\\right)+u_{1}=-\\frac{1}{2}+I,\n$$\n$$\n-\\left(-\\frac{2}{3}u_{0}+\\frac{8}{3}u_{1}-\\frac{16}{3}u_{2}\\right)+u_{2}=-\\frac{1}{2}+I.\n$$\nMultiplying both equations by $3$ and substituting $3I=\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2}$ yields\n$$\n-10u_{0}+19u_{1}-8u_{2}=-\\frac{3}{2}+\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2},\n$$\n$$\n2u_{0}-8u_{1}+19u_{2}=-\\frac{3}{2}+\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2}.\n$$\nBringing all terms to the left and clearing denominators (multiply by $6$) gives\n$$\n-62u_{0}+98u_{1}-64u_{2}=-9,\\qquad 10u_{0}-64u_{1}+98u_{2}=-9,\n$$\ntogether with the boundary-condition equation\n$$\n13u_{0}-24u_{1}+8u_{2}=0.\n$$\nFrom $13u_{0}-24u_{1}+8u_{2}=0$ we get $u_{0}=\\frac{24}{13}u_{1}-\\frac{8}{13}u_{2}$. Substituting this into the two interior equations yields the $2\\times 2$ system\n$$\n214u_{1}+336u_{2}=117,\\qquad 592u_{1}-1194u_{2}=117.\n$$\nSolving, one finds\n$$\nu_{1}=\\frac{765}{1942},\\qquad u_{2}=\\frac{189}{1942}.\n$$\nTherefore, the requested value at node $x_{1}$ is the exact fraction $u_{1}=\\frac{765}{1942}$.",
            "answer": "$$\\boxed{\\frac{765}{1942}}$$"
        }
    ]
}