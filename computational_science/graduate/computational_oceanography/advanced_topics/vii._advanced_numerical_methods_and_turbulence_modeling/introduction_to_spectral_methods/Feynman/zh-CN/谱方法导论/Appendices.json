{
    "hands_on_practices": [
        {
            "introduction": "在计算海洋学中，我们处理的许多信号（如海平面、温度或速度）在本质上是连续的。然而，我们的观测仪器以离散的时间间隔（$ \\Delta t $）进行采样，将连续信号转换为离散时间序列。这个从连续到离散的转变会带来一个基本挑战：混叠（aliasing）。如果采样频率不够高，高频信号可能会“伪装”成我们分析中的低频信号。这项练习将引导您从第一性原理推导混叠效应，并将其应用于一个经典的海洋学场景——M2 潮汐信号的欠采样，从而巩固您对奈奎斯特频率和频谱折叠的理解。",
            "id": "3796086",
            "problem": "考虑一个连续时间的海平面信号，其局部模型为一个实正弦波 $s(t) = A \\cos(\\omega_{0} t + \\phi)$，其中 $A$ 是振幅，$\\phi$ 是相位，$\\omega_{0} > 0$ 是真实角频率。该信号以均匀间隔 $\\Delta t > 0$ 进行采样，产生一个离散时间序列 $x[n] = s(n \\Delta t)$，其中 $n$ 为整数。设采样角频率为 $\\omega_{s} = \\frac{2\\pi}{\\Delta t}$，奈奎斯特角频率为 $\\omega_{N} = \\frac{\\pi}{\\Delta t}$。仅使用采样（表示为与狄拉克梳状函数相乘）的第一性原理以及离散时间复指数的周期性，推导当 $\\omega_{0} > \\omega_{N}$ 时，在主离散时间基带 $[0, \\omega_{N}]$ 中观测到的混叠角频率的表达式。明确论证频谱副本的整数索引是如何进入表达式的，以及为什么对于实余弦信号会出现绝对值。\n\n然后，用一个物理上真实的计算海洋学场景来说明这个结果：主要月球半日潮 ($\\mathrm{M2}$) 的周期为 $P = 12.4206012$ 小时。假设海平面每 $\\Delta t = 13$ 小时采样一次。如果应用诸如离散傅里叶变换 (DFT) 的频谱方法，计算从采样时间序列中估计出的混叠频率（单位为每日周期数，cpd）。对于数值计算部分，请用 cpd 表示混叠频率的最终答案，并将答案四舍五入到五位有效数字。",
            "solution": "该问题经检验在科学上是合理的、适定的和客观的。这是一个应用于真实地球物理背景的标准信号处理问题。所提供的数据是充分且一致的。\n\n该问题要求推导混叠频率，并针对一个特定的海洋学场景进行数值计算。\n\n**第一部分：混叠频率的推导**\n\n一个连续时间的正弦信号由 $s(t) = A \\cos(\\omega_{0} t + \\phi)$ 给出，其中 $A$ 是振幅，$\\phi$ 是相位，$\\omega_{0} > 0$ 是真实角频率。使用欧拉公式，我们可以将实值余弦表示为两个复指数的和：\n$$s(t) = \\frac{A}{2} \\left( e^{i(\\omega_{0} t + \\phi)} + e^{-i(\\omega_{0} t + \\phi)} \\right) = \\frac{A}{2} e^{i\\phi} e^{i\\omega_{0} t} + \\frac{A}{2} e^{-i\\phi} e^{-i\\omega_{0} t}$$\n$s(t)$ 的连续时间傅里叶变换 (CTFT) 记为 $S(\\omega)$，可以通过使用变换对 $\\mathcal{F}\\{e^{i\\omega_{a}t}\\} = 2\\pi\\delta(\\omega - \\omega_{a})$ 求得，其中 $\\delta(\\cdot)$ 是狄拉克δ函数。其频谱为：\n$$S(\\omega) = \\frac{A}{2} e^{i\\phi} (2\\pi\\delta(\\omega - \\omega_{0})) + \\frac{A}{2} e^{-i\\phi} (2\\pi\\delta(\\omega + \\omega_{0})) = A\\pi \\left( e^{i\\phi}\\delta(\\omega - \\omega_{0}) + e^{-i\\phi}\\delta(\\omega + \\omega_{0}) \\right)$$\n这表明连续信号的频谱由位于角频率 $\\omega = \\omega_{0}$ 和 $\\omega = -\\omega_{0}$ 处的两个冲激组成。\n\n以均匀间隔 $\\Delta t$ 对信号 $s(t)$ 进行采样，可以建模为将 $s(t)$ 与一个无穷狄拉克δ函数序列（称为狄拉克梳状函数）相乘：\n$$p(t) = \\sum_{n=-\\infty}^{\\infty} \\delta(t-n\\Delta t)$$\n在连续域中的采样信号是 $s_{p}(t) = s(t)p(t)$。狄拉克梳状函数的傅里叶变换是另一个狄拉克梳状函数，经过缩放且周期互易：\n$$P(\\omega) = \\mathcal{F}\\{p(t)\\} = \\frac{2\\pi}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} \\delta\\left(\\omega - k \\frac{2\\pi}{\\Delta t}\\right) = \\omega_{s} \\sum_{k=-\\infty}^{\\infty} \\delta(\\omega - k\\omega_{s})$$\n其中 $\\omega_{s} = \\frac{2\\pi}{\\Delta t}$ 是采样角频率，$k$ 是一个整数索引。\n\n时域中的乘法对应于频域中的卷积。采样信号的频谱 $S_{p}(\\omega)$ 由下式给出：\n$$S_{p}(\\omega) = \\frac{1}{2\\pi} (S(\\omega) * P(\\omega)) = \\frac{1}{2\\pi} \\left( S(\\omega) * \\left( \\omega_{s} \\sum_{k=-\\infty}^{\\infty} \\delta(\\omega - k\\omega_{s}) \\right) \\right)$$\n$$S_{p}(\\omega) = \\frac{\\omega_{s}}{2\\pi} \\sum_{k=-\\infty}^{\\infty} (S(\\omega) * \\delta(\\omega - k\\omega_{s})) = \\frac{1}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} S(\\omega - k\\omega_{s})$$\n这个基本结果表明，采样信号的频谱由原始信号频谱 $S(\\omega)$ 的周期性重复副本组成，这些副本按采样频率 $\\omega_{s}$ 的整数倍进行移位。\n\n代入 $S(\\omega)$ 的表达式，我们得到：\n$$S_{p}(\\omega) = \\frac{A\\pi}{\\Delta t} \\sum_{k=-\\infty}^{\\infty} \\left( e^{i\\phi}\\delta(\\omega - \\omega_{0} - k\\omega_{s}) + e^{-i\\phi}\\delta(\\omega + \\omega_{0} - k\\omega_{s}) \\right)$$\n原始冲激在 $\\pm\\omega_{0}$ 处的频谱副本现在位于所有频率 $\\omega = \\pm \\omega_{0} + k\\omega_{s}$ 处，其中 $k$ 为所有整数。这明确地显示了频谱副本的整数索引 $k$ 是如何从采样过程中产生的。\n\n一个离散时间系统，例如分析序列 $x[n] = s(n\\Delta t)$ 的系统，只能无歧义地表示主基带内的频率，对于实信号，该基带通常取为 $[0, \\omega_{N}]$，其中 $\\omega_{N} = \\frac{\\pi}{\\Delta t} = \\frac{\\omega_{s}}{2}$ 是奈奎斯特频率。如果真实频率 $\\omega_0$ 大于 $\\omega_N$，其频谱能量将被“混叠”或“折叠”到基带中。\n\n混叠频率 $\\omega_{a}'$ 是落入区间 $[-\\omega_{N}, \\omega_{N}]$ 的副本的频率。我们必须找到一个整数 $k_{m}$，使得 $\\omega'_{a} = \\omega_{0} - k_{m}\\omega_{s}$ 满足 $|\\omega'_{a}| \\le \\omega_{N}$。\n$$|\\omega_{0} - k_{m}\\omega_{s}| \\le \\frac{\\omega_{s}}{2}$$\n两边同除以 $\\omega_{s}$ 得：\n$$|\\frac{\\omega_{0}}{\\omega_{s}} - k_{m}| \\le \\frac{1}{2}$$\n这个不等式将 $k_{m}$ 定义为最接近比率 $\\frac{\\omega_{0}}{\\omega_{s}}$ 的整数。因此，$k_{m} = \\text{round}(\\frac{\\omega_{0}}{\\omega_{s}})$。在 $[-\\omega_{N}, \\omega_{N}]$ 范围内的混叠频率是 $\\omega'_{a} = \\omega_{0} - \\omega_{s} \\cdot \\text{round}(\\frac{\\omega_{0}}{\\omega_{s}})$。\n\n出现绝对值的原因在于，实信号 $s(t)$ 具有共轭对称谱，其功率同时存在于 $+\\omega_{0}$ 和 $-\\omega_{0}$ 处。采样后，$+\\omega_{0}$ 的副本混叠到 $\\omega'_{a}$，而 $-\\omega_{0}$ 的副本混叠到 $-\\omega'_{a}$（因为它们围绕 $\\omega=0$ 对称映射）。因此，离散时间序列 $x[n]$ 包含对应于 $\\pm\\omega'_{a}$ 的分量。像 DFT 这样的频谱分析方法将揭示在单个正频率处的功率。在主基带 $[0, \\omega_{N}]$ 中观测到的混叠角频率 $\\omega_{alias}$ 是该频率的幅值：\n$$\\omega_{alias} = |\\omega'_{a}| = \\left|\\omega_{0} - \\omega_{s} \\cdot \\text{round}\\left(\\frac{\\omega_{0}}{\\omega_{s}}\\right)\\right|$$\n\n**第二部分：数值示例**\n\n给定 $\\mathrm{M2}$ 潮的周期 $P = 12.4206012$ 小时，采样间隔 $\\Delta t = 13$ 小时。我们需要求出以每日周期数 (cpd) 为单位的混叠频率。使用频率 $f = \\frac{\\omega}{2\\pi}$ 而不是角频率 $\\omega$ 会更方便。混叠公式是类似的：$f_{alias} = |f_{0} - f_{s} \\cdot \\text{round}(\\frac{f_{0}}{f_{s}})|$。\n\n1.  **计算真实频率 $f_0$**：\n    周期为 $P = 12.4206012$ 小时。频率以每小时周期数 (cph) 为单位是 $f_{0} = \\frac{1}{P} = \\frac{1}{12.4206012}$ cph。\n    转换为每日周期数 (cpd)，我们乘以 $24$ 小时/天：\n    $$f_{0} = \\frac{24}{12.4206012} \\text{ cpd} \\approx 1.93227365 \\text{ cpd}$$\n\n2.  **计算采样频率 $f_s$**：\n    采样间隔为 $\\Delta t = 13$ 小时。采样频率为 $f_{s} = \\frac{1}{\\Delta t} = \\frac{1}{13}$ cph。\n    转换为 cpd：\n    $$f_{s} = \\frac{24}{13} \\text{ cpd} \\approx 1.84615385 \\text{ cpd}$$\n\n3.  **检查混叠现象**：\n    奈奎斯特频率为 $f_{N} = \\frac{f_{s}}{2} = \\frac{12}{13} \\text{ cpd} \\approx 0.92307692 \\text{ cpd}$。\n    由于 $f_{0} \\approx 1.932 \\text{ cpd}$ 大于 $f_{N} \\approx 0.923 \\text{ cpd}$，将会发生混叠。\n\n4.  **计算混叠频率 $f_{alias}$**：\n    首先，找到整数索引 $k_{m}$：\n    $$k_{m} = \\text{round}\\left(\\frac{f_{0}}{f_{s}}\\right) = \\text{round}\\left(\\frac{24/12.4206012}{24/13}\\right) = \\text{round}\\left(\\frac{13}{12.4206012}\\right)$$\n    $$k_{m} = \\text{round}(1.046648...) = 1$$\n    现在，应用混叠公式：\n    $$f_{alias} = |f_{0} - k_{m}f_{s}| = \\left|\\frac{24}{12.4206012} - 1 \\cdot \\frac{24}{13}\\right|$$\n    $$f_{alias} = 24 \\left| \\frac{1}{12.4206012} - \\frac{1}{13} \\right|$$\n    由于 $12.4206012  13$，绝对值内的项为正。\n    $$f_{alias} = 24 \\left( \\frac{1}{12.4206012} - \\frac{1}{13} \\right) \\text{ cpd}$$\n    $$f_{alias} \\approx 24 \\times (0.0805118 - 0.0769231) \\text{ cpd} \\approx 24 \\times 0.0035887 \\text{ cpd}$$\n    $$f_{alias} \\approx 0.0861288 \\text{ cpd}$$\n    使用更高精度的中间值：\n    $f_{0} \\approx 1.932273654$ cpd\n    $f_{s} \\approx 1.846153846$ cpd\n    $f_{alias} = |1.932273654 - 1.846153846| \\text{ cpd} = 0.086119808 \\text{ cpd}$\n\n    四舍五入到五位有效数字，我们得到 $0.086120$。",
            "answer": "$$\\boxed{0.086120}$$"
        },
        {
            "introduction": "在使用离散傅里叶变换（DFT）分析时间序列时，一个常见的做法是在数据末尾补零（zero-padding）以获得更“平滑”的频谱。这种技术虽然简单，但其真正效果常常被误解。这项编程练习旨在通过直接的数值实验，揭示补零的本质。您将亲手验证补零如何通过更密集地采样离散时间傅里叶变换（DTFT）来提高谱峰定位的精度，同时也将证明它并不能提高区分两个相近频率的根本能力——即频谱分辨率。",
            "id": "3796017",
            "problem": "您将设计并实现一个数值实验，使用离散傅里叶变换（DFT）来演示时域补零如何在不增加真实分辨率的情况下影响内插频谱和峰值定位。该实验必须是自包含的，并且必须生成合成时间序列，计算其补零和不补零的频谱，并量化峰值估计和可分辨性的特定属性。\n\n从以下基础出发：\n- 一个均匀采样、有限长度的标量时间序列 $\\{x[n]\\}_{n=0}^{N-1}$，采样间隔为 $\\Delta t$（单位：天），代表一个连续信号在离散时间 $t_n = n \\Delta t$ 上的约束。\n- $x[n]$ 的离散傅里叶变换（DFT）定义为 $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-i 2 \\pi k n/N}$，其中整数 $k$ 在 $\\{0,\\dots,N-1\\}$ 中，对应的傅里叶频率为 $f_k = \\frac{k}{N \\Delta t}$，单位为周期/天（cpd）。\n- 对于实值信号，其正频率谱完全由非负频率子集表示（例如，返回非负频率的实值快速傅里叶变换实现）。\n\n您的程序必须实现以下逻辑并使用以下物理和数值设置：\n- 通过对少量正弦波求和来构建合成的海洋学时间序列：\n  - 对每个正弦波，使用 $x_i(t) = A_i \\cos\\left(2 \\pi f_i t + \\phi_i\\right)$，其中 $A_i$ 是振幅，$f_i$ 是频率（单位：周期/天，cpd），$\\phi_i$ 是相位（单位：弧度）。\n  - 为避免相位混淆，所有正弦波的相位 $\\phi_i = 0$ 弧度，所有分量的振幅 $A_i = 1$。\n- 除非另有规定，使用采样间隔 $\\Delta t = \\frac{1}{24}$ 天（即每小时采样一次），并确保所有频率输出和误差都以周期/天（cpd）表示。所有角度均以弧度为单位。\n\n补零协议：\n- 给定一个长度为 $N$ 的时间序列，定义一个补零因子 $M \\in \\mathbb{N}$。通过附加零点创建一个长度为 $N_p = M N$ 的补零序列，并对该补零序列计算 DFT。这会将频率网格细化为 $f_k = \\frac{k}{N_p \\Delta t}$，同时保持原始时间信息不变。\n- 必须通过选择与非负频率谱最大幅值对应的频率来执行峰值频率定位。除了这种基于网格的峰值选择外，不要使用任何参数拟合，因为目标是证明补零细化了底层离散时间傅里叶变换的采样，而没有注入新信息。\n\n可分辨性评估：\n- 将未补零的频率仓宽度定义为 $\\Delta f_0 = \\frac{1}{N \\Delta t}$，单位为周期/天（cpd）。\n- 给定一个非负频率上的幅值谱，将局部最大值集合定义为那些在索引 $k$ 处的值严格超过其直接邻居的索引。如果存在两个局部最大值，它们都超过指定的相对高度阈值 $\\eta$ 乘以全局最大值，并且在频率上相隔至少 $\\Delta f_0$，则认为该频谱呈现出两个可分辨的峰值。使用 $\\eta = 0.4$。\n- 将此可分辨性准则应用于未补零和补零两种情况；在后一种情况下，使用细化的频率网格来寻找局部最大值，但保持分离阈值 $\\Delta f_0$ 参考原始未补零的记录。\n\n测试套件：\n实现以下四个案例。除最后一个案例外，所有案例均使用 $\\Delta t = \\frac{1}{24}$ 天，$N = 720$ 个样本（对应30天），以及补零因子 $M = 8$。所有振幅为 $1$，所有相位为 $0$ 弧度。\n1. 用于峰值定位的单个正弦波：\n   - 频率：$\\{f_1\\} = \\{0.2\\}$ cpd。\n   - 计算未补零频谱和补零频谱中峰值频率估计的绝对误差（单位：cpd）。将两个误差都作为浮点数（单位：cpd）输出。\n2. 两个低于标称分辨能力的近距离正弦波：\n   - 频率：$\\{f_1, f_2\\} = \\{0.20, 0.22\\}$ cpd。\n   - 根据上述准则，确定未补零频谱和补零频谱的可分辨性布尔值。输出两个布尔值。\n3. 两个充分分离的正弦波：\n   - 频率：$\\{f_1, f_2\\} = \\{0.20, 0.25\\}$ cpd。\n   - 确定未补零频谱和补零频谱的可分辨性布尔值。输出两个布尔值。\n4. 记录非常短的边界案例：\n   - 设置 $\\Delta t = \\frac{1}{24}$ 天，$N = 64$ 个样本（约对应 $2.666\\ldots$ 天），以及 $M = 16$。\n   - 频率：$\\{f_1, f_2\\} = \\{0.20, 0.47\\}$ cpd。\n   - 确定未补零频谱和补零频谱的可分辨性布尔值。输出两个布尔值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含跨四个案例聚合的结果，形式为逗号分隔的列表，并用方括号括起来。\n- 所需的输出是一个列表，包含：\n  - 对于案例 $1$：一个二元列表 $[\\text{error\\_no\\_pad}, \\text{error\\_pad}]$，两个条目均为浮点数（单位：cpd）。\n  - 对于案例 $2$、$3$ 和 $4$：一个二元列表 $[\\text{resolved\\_no\\_pad}, \\text{resolved\\_pad}]$，条目为布尔值。\n- 具体而言，输出必须具有以下形式\n  - $[[e_1^{\\text{no}}, e_1^{\\text{pad}}],[b_2^{\\text{no}}, b_2^{\\text{pad}}],[b_3^{\\text{no}}, b_3^{\\text{pad}}],[b_4^{\\text{no}}, b_4^{\\text{pad}}]]$\n  其中 $e_1^{\\text{no}}$ 和 $e_1^{\\text{pad}}$ 是浮点数（单位：cpd），$b_j^{\\text{no}}, b_j^{\\text{pad}}$ 是布尔值。\n\n科学真实性要求：\n- 确保所有计算都使用与海洋学时间序列分析一致的物理上合理的频率和采样。所有频率误差必须以周期/天（cpd）报告，所有角度均以弧度为单位。\n\n您的程序必须是一个完整的、可运行的脚本，无需任何用户输入或外部文件即可生成指定的单行输出。",
            "solution": "用户提供了一个科学根据充分、设定良好且客观的问题陈述。它概述了一个信号处理中的标准数值实验，用以演示补零在频谱分析中的特性。所有参数和准则都已明确定义，从而可以得到唯一且可计算的解。因此，该问题被认为是**有效的**。\n\n### 基于原理的解决方案设计\n\n这个问题的核心是理解连续时间信号、其离散时间表示以及通过离散傅里叶变换（DFT）计算出的频谱之间的关系。该实验对比了标准DFT和补零DFT的属性，以说明补零如何影响频谱插值和峰值估计，而不改变基础的频谱分辨率。\n\n**1. 理论基础：连续频谱与离散频谱**\n\n一个连续信号 $x(t)$ 具有连续的傅里叶变换。当我们以 $\\Delta t$ 的间隔对该信号进行采样，得到一个有限序列 $\\{x[n]\\}_{n=0}^{N-1}$，其中 $t_n = n \\Delta t$ 时，我们处理的是一个离散且有限的表示。这个离散序列的傅里叶变换是离散时间傅里叶变换（DTFT），它是一个关于频率的连续周期函数：\n$$\nX(e^{j\\omega}) = \\sum_{n=0}^{N-1} x[n] e^{-j \\omega n}\n$$\n这里，$\\omega = 2 \\pi f \\Delta t$ 是归一化角频率。DTFT 的形状由 $N$ 个数据点决定，并受到频谱泄漏的影响，频谱泄漏是真实信号频谱与持续时间为 $T = N \\Delta t$ 的隐式矩形窗频谱的卷积。\n\n计算机计算的离散傅里叶变换（DFT）是在一组离散频率上对DTFT的*采样*。对于一个 $N$ 点DFT，这些频率是 $f_k = \\frac{k}{N \\Delta t}$，其中 $k=0, \\dots, N-1$。DFT仅在这些特定的网格点上提供DTFT的值。\n\n**2. 补零的作用**\n\n补零是向时间序列 $\\{x[n]\\}$ 附加零，以创建一个更长的序列，长度为 $N_p = M N$，其中 $M$ 是补零因子。计算这个补零序列的DFT并不会增加关于原始连续信号 $x(t)$ 的任何新信息；信息内容仍然受限于原始的 $N$ 个样本。然而，它所做的是在一个更精细的频率网格上计算DFT。新的频率仓位于 $f_k' = \\frac{k}{N_p \\Delta t} = \\frac{k}{M N \\Delta t}$。\n\n这等效于在 $M$ 倍多的频率点上评估*原始*的DTFT，$X(e^{j\\omega})$。实际效果是在原始粗糙DFT点之间对频谱进行平滑插值，这可以揭示DTFT形状的细节，例如落在原始DFT仓之间的频谱峰值的真实位置和高度。\n\n**3. 频谱分辨率与峰值可分辨性**\n\n通常由瑞利判据（Rayleigh criterion）描述的基本频谱分辨率，是区分两个邻近频率分量的能力。这主要由总观测时间 $T = N \\Delta t$ 决定。最小可分辨频率间隔约为 $\\Delta f_0 = \\frac{1}{T} = \\frac{1}{N \\Delta t}$。补零不改变 $T$，因此不能提高这个基本分辨率。频率间隔小于 $\\Delta f_0$ 的两个正弦波，其在DTFT中的主瓣会重叠到合并成一个单峰的程度。补零只会显示这个单一、合并峰值的更详细视图。\n\n问题定义了一个特定的可分辨性数值准则：存在至少两个局部频谱最大值（严格大于其邻居的峰值），它们都超过全局最大值的 $\\eta=0.4$ 倍阈值，并且在频率上至少相隔基本分辨率 $\\Delta f_0$。该准则应用于未补零和补零的频谱，以量化其效果。\n\n### 实现策略\n\n该解决方案通过处理四个不同的测试案例来实现。对于每个案例，我们执行以下步骤：\n\n1.  **生成信号**：通过在由 $N$ 和 $\\Delta t$ 定义的离散时间网格上，对具有指定频率、振幅（$A_i=1$）和相位（$\\phi_i=0$）的余弦波求和，来创建一个合成时间序列。\n2.  **计算频谱**：计算两个频谱：\n    *   **未补零**：对原始时间序列计算一个 $N$ 点的实数快速傅里叶变换（rFFT）。\n    *   **补零**：将时间序列补零至长度 $N_p = M N$，并计算一个 $N_p$ 点的rFFT。\n    对于两者，都获得相应的频率数组和幅值谱。\n3.  **分析与量化**：\n    *   **案例1（峰值定位）**：为两个频谱找到对应于最大谱幅值的频率。计算绝对误差为 $|f_{\\text{peak}} - f_{\\text{true}}|$。\n    *   **案例2、3、4（可分辨性）**：将可分辨性准则应用于两个频谱。这包括识别所有局部最大值，通过相对高度阈值 $\\eta$ 进行筛选，然后检查剩余峰值中是否有任何一对的频率间隔至少为 $\\Delta f_0$。参考间隔 $\\Delta f_0$ 始终根据原始未补零的长度 $N$ 计算。\n\n这个系统化的过程允许直接比较有无补零的结果，从而展示其效用和局限性。\n\n*   **案例1**：由于真实频率 $f_1=0.2$ cpd 是 $N=720$ 时未补零频率仓宽度的整数倍（$\\Delta f_0 = 1/30$ cpd，且 $0.2 = 6/30$），峰值正好落在一个DFT仓上。因此，在未补零和补零情况下，预计都不会有定位误差。\n*   **案例2**：频率间隔 $\\delta f=0.02$ cpd 小于分辨率极限 $\\Delta f_0 \\approx 0.0333$ cpd。预计在两个频谱中，峰值都将无法分辨。\n*   **案例3**：间隔 $\\delta f=0.05$ cpd 大于 $\\Delta f_0$。理论上峰值是可分辨的。然而，未补零DFT的粗糙网格可能无法捕捉到峰值之间的谷底，导致它们无法被分辨。补零DFT的密集网格应该能清晰地揭示出两个独立的峰值，从而展示补零如何帮助可视化可分辨的特征。\n*   **案例4**：真实频率间隔 $\\delta f = 0.27$ cpd 小于规则定义所需的分隔阈值 $\\Delta f_0 = 0.375$ cpd。因此，即使可以看到两个峰值，它们也无法满足准则，结果在两种情况下都应为不可分辨。这个案例测试了对问题自定义规则的严格应用。\n\n最终代码为所有四个案例实现了这些步骤，并按规定格式化输出。",
            "answer": "```python\nimport numpy as np\nfrom scipy.fft import rfft, rfftfreq\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for all test cases and print results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Structure: (case_id, N, dt, M, frequencies, eta)\n    test_cases = [\n        (1, 720, 1/24, 8, [0.2], 0.4),\n        (2, 720, 1/24, 8, [0.20, 0.22], 0.4),\n        (3, 720, 1/24, 8, [0.20, 0.25], 0.4),\n        (4, 64, 1/24, 16, [0.20, 0.47], 0.4),\n    ]\n\n    results = []\n    for case_id, N, dt, M, freqs_true, eta in test_cases:\n        case_result = _process_case(case_id, N, dt, M, freqs_true, eta)\n        results.append(case_result)\n    \n    # Format the final output string exactly as required\n    # str(list) automatically adds spaces, which is fine according to the example structure.\n    # The template f\"[{','.join(map(str, results))}]\" correctly handles lists of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef _generate_time_series(frequencies, N, dt):\n    \"\"\"\n    Generates a synthetic time series by summing sinusoids.\n    Amplitudes are 1 and phases are 0 as per the problem statement.\n    \"\"\"\n    t = np.arange(N) * dt\n    x = np.zeros(N)\n    for f in frequencies:\n        x += 1.0 * np.cos(2 * np.pi * f * t + 0.0)\n    return x\n\ndef _compute_spectrum(x, dt, M_pad):\n    \"\"\"\n    Computes the non-negative frequency spectrum of a time series x,\n    with an optional zero-padding factor M_pad.\n    \"\"\"\n    N = len(x)\n    N_padded = N * M_pad\n    \n    if M_pad > 1:\n        x_padded = np.zeros(N_padded)\n        x_padded[:N] = x\n    else:\n        x_padded = x\n\n    # Use rfft for real-valued signals\n    spec = rfft(x_padded)\n    freqs = rfftfreq(N_padded, d=dt)\n    \n    # Return frequencies and magnitude spectrum\n    return freqs, np.abs(spec)\n\ndef _find_peak_frequency(freqs, spec):\n    \"\"\"\n    Finds the frequency corresponding to the maximum spectral magnitude.\n    \"\"\"\n    peak_idx = np.argmax(spec)\n    return freqs[peak_idx]\n\ndef _check_resolvability(freqs, spec, df0, eta):\n    \"\"\"\n    Applies the custom resolvability criterion from the problem statement.\n    \n    A spectrum has resolved peaks if:\n    1. There are at least two local maxima.\n    2. Each local maximum's magnitude is > eta * global_max_magnitude.\n    3. At least one pair of such peaks is separated by >= df0.\n    \"\"\"\n    if len(spec)  3:\n        return False\n        \n    spec_max = np.max(spec)\n    threshold = eta * spec_max\n\n    local_max_indices = []\n    # A point is a local max if it's strictly greater than its neighbors\n    for k in range(1, len(spec) - 1):\n        if spec[k] > spec[k-1] and spec[k] > spec[k+1]:\n            if spec[k] > threshold:\n                local_max_indices.append(k)\n\n    if len(local_max_indices)  2:\n        return False\n\n    peak_freqs = freqs[local_max_indices]\n\n    # Check all pairs of found peaks for the separation criterion\n    for i in range(len(peak_freqs)):\n        for j in range(i + 1, len(peak_freqs)):\n            if np.abs(peak_freqs[j] - peak_freqs[i]) >= df0:\n                return True\n    \n    return False\n\ndef _process_case(case_id, N, dt, M, freqs_true, eta):\n    \"\"\"\n    Processes a single test case, returning the required result structure.\n    \"\"\"\n    x = _generate_time_series(freqs_true, N, dt)\n    df0 = 1.0 / (N * dt)\n\n    # --- Non-padded analysis ---\n    freqs_no_pad, spec_no_pad = _compute_spectrum(x, dt, M_pad=1)\n    \n    if case_id == 1:\n        peak_freq_no_pad = _find_peak_frequency(freqs_no_pad, spec_no_pad)\n        error_no_pad = np.abs(peak_freq_no_pad - freqs_true[0])\n        result_no_pad = error_no_pad\n    else:\n        resolved_no_pad = _check_resolvability(freqs_no_pad, spec_no_pad, df0, eta)\n        result_no_pad = resolved_no_pad\n\n    # --- Zero-padded analysis ---\n    freqs_pad, spec_pad = _compute_spectrum(x, dt, M_pad=M)\n\n    if case_id == 1:\n        peak_freq_pad = _find_peak_frequency(freqs_pad, spec_pad)\n        error_pad = np.abs(peak_freq_pad - freqs_true[0])\n        result_pad = error_pad\n    else:\n        # The separation threshold df0 remains referenced to the UNPADDED record\n        resolved_pad = _check_resolvability(freqs_pad, spec_pad, df0, eta)\n        result_pad = resolved_pad\n        \n    return [result_no_pad, result_pad]\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "谱方法不仅是信号分析的工具，更是求解微分方程的强大数值技术，这在地球物理流体动力学建模中至关重要。伪谱（或配置）方法是其中的一个核心技术，它通过在一组精心选择的配置点上精确满足控制方程，来实现极高的精度。这项挑战性的练习将引导您将一个带有积分和导数边界条件的微分方程，使用切比雪夫配置法转化为一个线性代数系统。通过构建微分矩阵并整合边界条件，您将亲身体验如何将一个复杂的微积分问题转化为一个可计算的矩阵问题。",
            "id": "2114664",
            "problem": "考虑定义域 $x \\in [-1, 1]$ 上的一维积分微分方程：\n$$-u_{xx}(x) + \\alpha u(x) = f(x) + \\beta \\int_{-1}^{1} u(y) \\, dy$$\n解 $u(x)$ 满足以下边界条件：\n$$u(-1) = 0 \\quad \\text{and} \\quad u'(1) = \\gamma u(1)$$\n此处，$\\alpha$、$\\beta$ 和 $\\gamma$ 是实常数。\n\n我们旨在用切比雪夫配置（伪谱）方法对此问题进行数值求解。解 $u(x)$ 被一个最高次数为 $N$ 的单一全局多项式 $u_N(x)$ 近似。配置点是 $N+1$ 个切比雪夫-高斯-洛巴托（CGL）节点，由 $x_j = \\cos\\left(\\frac{j\\pi}{N}\\right)$ 给出，其中 $j=0, 1, \\dots, N$。多项式在这些节点处的值 $u_j = u_N(x_j)$ 是待求的未知数。微分方程和边界条件在这些节点上被精确地强制满足。\n\n对于 $N=3$ 的离散化，强迫函数 $f(x) = 2x^2 - 1$，以及常数 $\\alpha=1$, $\\beta=1$, $\\gamma=1$ 的情况，求在节点 $x_1$ 处的解的值，记为 $u_1$。\n\n将 $u_1$ 的答案表示为最简精确分数形式。",
            "solution": "我们使用 $N=3$ 的切比雪夫-高斯-洛巴托节点 $x_{j}=\\cos\\left(\\frac{j\\pi}{3}\\right)$ 进行离散化，节点为 $j=0,1,2,3$，即\n$$\nx_{0}=1,\\quad x_{1}=\\frac{1}{2},\\quad x_{2}=-\\frac{1}{2},\\quad x_{3}=-1.\n$$\n令 $u_{j}=u(x_{j})$。在这些节点上，一阶导数切比雪夫微分矩阵 $D$ 的元素为\n$$\nD_{ij}=\\begin{cases}\n\\dfrac{c_{i}}{c_{j}}\\dfrac{(-1)^{i+j}}{x_{i}-x_{j}},  i\\neq j \\\\[6pt]\n\\dfrac{2N^{2}+1}{6},  i=j=0 \\\\[4pt]\n-\\dfrac{2N^{2}+1}{6},  i=j=N \\\\[4pt]\n-\\dfrac{x_{j}}{2(1-x_{j}^{2})},  \\text{otherwise}\n\\end{cases}\n$$\n其中 $c_{0}=c_{N}=2$ 且 $c_{1}=c_{2}=1$，$N=3$。直接计算可得\n$$\nD=\\begin{pmatrix}\n\\dfrac{19}{6}  -4  \\dfrac{4}{3}  -\\dfrac{1}{2} \\\\[6pt]\n1  -\\dfrac{1}{3}  -1  \\dfrac{1}{3} \\\\[6pt]\n-\\dfrac{1}{3}  1  \\dfrac{1}{3}  -1 \\\\[6pt]\n\\dfrac{1}{2}  -\\dfrac{4}{3}  4  -\\dfrac{19}{6}\n\\end{pmatrix}\n$$\n二阶导数矩阵为 $D^{(2)}=D^{2}$。进行乘法运算后，在内部节点 $j=1,2$ 处所需的行为：\n$$\nD^{(2)}_{1,\\cdot}=\\left(\\dfrac{10}{3},\\,-\\dfrac{16}{3},\\,\\dfrac{8}{3},\\,-\\dfrac{2}{3}\\right),\\qquad\nD^{(2)}_{2,\\cdot}=\\left(-\\dfrac{2}{3},\\,\\dfrac{8}{3},\\,-\\dfrac{16}{3},\\,\\dfrac{10}{3}\\right).\n$$\n\n我们在内部节点上强制满足偏微分方程（PDE），在端点上强制满足边界条件。当 $\\alpha=\\beta=\\gamma=1$ 且 $f(x)=2x^{2}-1$ 时，在 $j=1,2$ 处的离散方程为\n$$\n-\\left(D^{(2)}u\\right)_{j}+u_{j}=f_{j}+I,\\quad j=1,2,\n$$\n其中 $I=\\int_{-1}^{1}u(y)\\,dy$ 通过对 3 次插值多项式 $u_{N}$ 进行精确积分来近似：\n$$\nI=\\sum_{j=0}^{3}w_{j}u_{j},\\quad w_{j}=\\int_{-1}^{1}\\ell_{j}(x)\\,dx.\n$$\n要求积分对于最高为 3 次的单项式精确成立，并利用对称性，可得 $w_{0}=w_{3}=a$, $w_{1}=w_{2}=b$，且满足\n$$\na+b=1,\\qquad 2a+\\frac{b}{2}=\\frac{2}{3}\\ \\Longrightarrow\\ a=\\frac{1}{9},\\ b=\\frac{8}{9}.\n$$\n因此\n$$\nI=\\frac{1}{9}u_{0}+\\frac{8}{9}u_{1}+\\frac{8}{9}u_{2}+\\frac{1}{9}u_{3}.\n$$\n\n边界条件为 $u(-1)=0\\Rightarrow u_{3}=0$ 和 $u'(1)=u(1)\\Rightarrow (Du)_{0}=u_{0}$，即\n$$\n\\left(\\frac{19}{6}\\right)u_{0}-4u_{1}+\\left(\\frac{4}{3}\\right)u_{2}-\\left(\\frac{1}{2}\\right)u_{3}=u_{0}\\ \\Longrightarrow\\ 13u_{0}-24u_{1}+8u_{2}=0.\n$$\n\n在节点上计算 $f$ 的值：\n$$\nf_{0}=1,\\quad f_{1}=-\\frac{1}{2},\\quad f_{2}=-\\frac{1}{2},\\quad f_{3}=1.\n$$\n使用 $u_{3}=0$ 和 $I=\\frac{1}{9}u_{0}+\\frac{8}{9}u_{1}+\\frac{8}{9}u_{2}$，内部方程变为\n$$\n-\\left(\\frac{10}{3}u_{0}-\\frac{16}{3}u_{1}+\\frac{8}{3}u_{2}\\right)+u_{1}=-\\frac{1}{2}+I,\n$$\n$$\n-\\left(-\\frac{2}{3}u_{0}+\\frac{8}{3}u_{1}-\\frac{16}{3}u_{2}\\right)+u_{2}=-\\frac{1}{2}+I.\n$$\n将两方程同乘以 $3$ 并代入 $3I=\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2}$ 可得\n$$\n-10u_{0}+19u_{1}-8u_{2}=-\\frac{3}{2}+\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2},\n$$\n$$\n2u_{0}-8u_{1}+19u_{2}=-\\frac{3}{2}+\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2}.\n$$\n将所有项移到左边并去分母（乘以 $6$）可得\n$$\n-62u_{0}+98u_{1}-64u_{2}=-9,\\qquad 10u_{0}-64u_{1}+98u_{2}=-9,\n$$\n以及边界条件方程\n$$\n13u_{0}-24u_{1}+8u_{2}=0.\n$$\n从 $13u_{0}-24u_{1}+8u_{2}=0$ 我们得到 $u_{0}=\\frac{24}{13}u_{1}-\\frac{8}{13}u_{2}$。将此代入两个内部方程，得到 $2\\times 2$ 的方程组\n$$\n214u_{1}+336u_{2}=117,\\qquad 592u_{1}-1194u_{2}=117.\n$$\n求解可得\n$$\nu_{1}=\\frac{765}{1942},\\qquad u_{2}=\\frac{189}{1942}.\n$$\n因此，所求的节点 $x_{1}$ 处的值为精确分数 $u_{1}=\\frac{765}{1942}$。",
            "answer": "$$\\boxed{\\frac{765}{1942}}$$"
        }
    ]
}