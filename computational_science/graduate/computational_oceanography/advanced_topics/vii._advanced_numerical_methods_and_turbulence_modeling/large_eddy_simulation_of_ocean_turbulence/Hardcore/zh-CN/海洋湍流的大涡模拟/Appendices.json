{
    "hands_on_practices": [
        {
            "introduction": "Smagorinsky 模型是大涡模拟中一个奠基性的亚网格尺度（SGS）封闭方案。这项练习让你在一个简化的正压剪切流中，亲手实践如何实现这个经典的涡粘性模型 。通过将控制方程离散化并计算亚网格应力的影响，你将具体理解未解析的湍流运动是如何被参数化的，以及它们如何从已解析的尺度中耗散能量。",
            "id": "3798395",
            "problem": "考虑一个在海洋湍流的大涡模拟（Large Eddy Simulation, LES）中解析的、深度不变的正压平面剪切流。假设解析的速度场在 $x$ 方向上水平均质且垂向不变，因此二维速度可以写为 $\\mathbf{u}(y,t) = (u(y,t), 0)$，其中 $y \\in [0,L_y)$ 且在 $y$ 方向上具有周期性边界条件。滤波后的不可压缩动量方程是出发点。考虑分子黏性 $\\nu$ 和由滤波产生的亚网格尺度（subgrid-scale, SGS）应力 $\\tau_{ij}$，解析后的动量方程为\n$$\n\\frac{\\partial u_i}{\\partial t} + \\frac{\\partial (u_i u_j)}{\\partial x_j} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x_i} + \\nu \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j} - \\frac{\\partial \\tau_{ij}}{\\partial x_j},\n$$\n其中 $\\rho$ 是密度，$p$ 是压力。在 Smagorinsky 闭合中，$\\tau_{ij}$ 的偏量部分使用涡黏性 $\\nu_t$ 进行建模，该涡黏性由解析的应变率张量 $S_{ij}$ 的大小构建，具体为：\n$$\nS_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right), \\quad \\nu_t = (C_s \\Delta)^2 \\, \\lVert S \\rVert, \\quad \\lVert S \\rVert = \\sqrt{2 S_{ij} S_{ij}},\n$$\n其中 $C_s$ 是 Smagorinsky 常数，$\\Delta$ 是滤波宽度，此处取其等于均匀网格间距 $\\Delta y$。对于所描述的一维剪切流 $u(y,t)$，您必须推导 $\\lVert S \\rVert$ 的适当表达式，并仅使用分子黏性和亚网格尺度涡黏性的扩散贡献，来构建 $u$ 在一个显式时间步长 $\\Delta t$ 内的更新公式。在均匀周期性网格上使用保守离散格式：计算单元格面上的扩散通量 $f = (\\nu + \\nu_t) \\, \\partial_y u$，然后在其单元格中心处取其散度以获得 $\\partial_t u$。\n\n实现一个数值求解器，该求解器：\n- 构建初始解析速度剖面 $u(y,0)$。\n- 根据面上的解析剪切大小计算单元格面上的亚网格尺度涡黏性 $\\nu_t$。\n- 形成面扩散通量 $f$ 及其离散散度，以计算单元格中心处的时间倾向 $\\partial_t u$。\n- 仅使用扩散项，通过一个前向欧拉时间步长来推进 $u$。\n- 报告解析的速度剖面调整量 $\\Delta u(y) = u(y,\\Delta t) - u(y,0)$ 和更新后的中心点速度 $u(y=L_y/2,\\Delta t)$。\n\n所有计算和输出必须以米/秒（$\\mathrm{m/s}$）表示。如果存在角度，必须以弧度表示。您的程序必须生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个测试案例贡献一个双元素列表 $[\\max|\\Delta u|, u_{\\mathrm{center}}]$，两个条目均以 $\\mathrm{m/s}$ 为单位。中心点是索引为 $\\lfloor N/2 \\rfloor$ 的网格点。\n\n使用以下参数集测试套件，每个参数集指定为 $(U_0, L_y, N, C_s, \\Delta t, \\nu, n)$，其中 $U_0$ 是初始剖面的振幅，$L_y$ 是域长度，$N$ 是网格点数，$C_s$ 是 Smagorinsky 常数，$\\Delta t$ 是时间步长，$\\nu$ 是分子黏性，$n$ 是周期性初始剖面 $u(y,0) = U_0 \\sin(2\\pi n y / L_y)$ 中的整数波数；对于均匀流的边界情况，使用恒定的初始剖面 $u(y,0) = U_0$：\n1. 案例 A（理想情况，周期性剪切）：$(U_0 = 1.0\\,\\mathrm{m/s}, L_y = 2000\\,\\mathrm{m}, N = 129, C_s = 0.12, \\Delta t = 50\\,\\mathrm{s}, \\nu = 1\\times 10^{-5}\\,\\mathrm{m^2/s}, n = 1)$。\n2. 案例 B（边界情况，均匀流）：$(U_0 = 0.8\\,\\mathrm{m/s}, L_y = 1000\\,\\mathrm{m}, N = 128, C_s = 0.17, \\Delta t = 100\\,\\mathrm{s}, \\nu = 1\\times 10^{-5}\\,\\mathrm{m^2/s})$。\n3. 案例 C（更强剪切，更高波数）：$(U_0 = 0.5\\,\\mathrm{m/s}, L_y = 1000\\,\\mathrm{m}, N = 257, C_s = 0.20, \\Delta t = 10\\,\\mathrm{s}, \\nu = 1\\times 10^{-5}\\,\\mathrm{m^2/s}, n = 2)$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试案例产生一个 $[\\max|\\Delta u|, u_{\\mathrm{center}}]$（单位为 $\\mathrm{m/s}$），例如 $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$。",
            "solution": "此问题经评估有效。它在科学上基于计算流体动力学（computational fluid dynamics）的原理，特别是大涡模拟（Large Eddy Simulation, LES）。该问题是适定的，具有清晰的初始条件、周期性边界条件和已定义的（尽管简化了的）控制方程。所有术语、参数和要求的输出都得到了客观明确的定义。所要求的任务是离散化和求解偏微分方程的标准数值练习。\n\n解决方案分为两个主要部分：首先，对指定流动条件的简化控制方程进行理论推导；其次，详细描述用于求解该方程的数值算法。\n\n### 理论构建\n\n问题从滤波后的不可压缩动量方程开始，要求仅考虑扩散项，为一维剪切流 $\\mathbf{u}(y,t) = (u(y,t), 0, 0)$ 构建更新公式。这个简化系统的控制方程是：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial y} \\left( (\\nu + \\nu_t) \\frac{\\partial u}{\\partial y} \\right)\n$$\n其中 $\\nu$ 是分子黏性，$\\nu_t$ 是亚网格尺度（SGS）涡黏性。涡黏性由 Smagorinsky 模型定义为 $\\nu_t = (C_s \\Delta)^2 \\lVert S \\rVert$，其中 $C_s$ 是 Smagorinsky 常数，$\\Delta$ 是滤波宽度（等于网格间距 $\\Delta y$），$\\lVert S \\rVert$ 是解析的应变率张量 $S_{ij}$ 的大小。\n\n我们的第一步是为给定的速度场 $\\mathbf{u} = (u_1, u_2, u_3) = (u(y,t), 0, 0)$ 在笛卡尔坐标 $(x_1, x_2, x_3) = (x, y, z)$ 中推导 $\\lVert S \\rVert$ 的具体表达式。\n\n应变率张量 $S_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right)$ 的分量计算如下：\n- 对角分量全为零：\n  $S_{11} = \\frac{\\partial u}{\\partial x} = 0$，因为 $u$ 不依赖于 $x$。\n  $S_{22} = \\frac{\\partial 0}{\\partial y} = 0$。\n  $S_{33} = \\frac{\\partial 0}{\\partial z} = 0$。\n- 涉及对 $x$ 或 $z$ 求导的非对角分量为零。唯一非零的分量是：\n  $S_{12} = S_{21} = \\frac{1}{2} \\left( \\frac{\\partial u_1}{\\partial x_2} + \\frac{\\partial u_2}{\\partial x_1} \\right) = \\frac{1}{2} \\left( \\frac{\\partial u}{\\partial y} + \\frac{\\partial 0}{\\partial x} \\right) = \\frac{1}{2} \\frac{\\partial u}{\\partial y}$。\n  $S_{13} = S_{31} = 0$ 且 $S_{23} = S_{32} = 0$。\n\n因此，应变率张量为：\n$$\nS = \\begin{pmatrix} 0  \\frac{1}{2} \\frac{\\partial u}{\\partial y}  0 \\\\ \\frac{1}{2} \\frac{\\partial u}{\\partial y}  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n大小 $\\lVert S \\rVert$ 定义为 $\\lVert S \\rVert = \\sqrt{2 S_{ij} S_{ij}}$，其中 $S_{ij} S_{ij}$ 是张量分量的平方和（弗罗贝尼乌斯范数的平方）：\n$$\nS_{ij} S_{ij} = \\sum_{i,j=1}^3 S_{ij}^2 = S_{12}^2 + S_{21}^2 = \\left(\\frac{1}{2} \\frac{\\partial u}{\\partial y}\\right)^2 + \\left(\\frac{1}{2} \\frac{\\partial u}{\\partial y}\\right)^2 = 2 \\cdot \\frac{1}{4} \\left(\\frac{\\partial u}{\\partial y}\\right)^2 = \\frac{1}{2} \\left(\\frac{\\partial u}{\\partial y}\\right)^2\n$$\n将此代入大小的定义中：\n$$\n\\lVert S \\rVert = \\sqrt{2 \\cdot \\left(\\frac{1}{2} \\left(\\frac{\\partial u}{\\partial y}\\right)^2\\right)} = \\sqrt{\\left(\\frac{\\partial u}{\\partial y}\\right)^2} = \\left| \\frac{\\partial u}{\\partial y} \\right|\n$$\n因此，对于此一维剪切流，应变率大小就是速度梯度的绝对值。涡黏性则变为：\n$$\n\\nu_t = (C_s \\Delta y)^2 \\left| \\frac{\\partial u}{\\partial y} \\right|\n$$\n\n### 数值离散化\n\n我们在均匀的周期性网格上采用保守的有限体积法。域 $y \\in [0, L_y)$ 被离散化为 $N$ 个单元格。\n\n1.  **网格与初始剖面：**\n    - 网格间距为 $\\Delta y = L_y / N$。\n    - 单元格中心位于 $y_j = j \\Delta y$（对于 $j = 0, 1, \\ldots, N-1$）。速度 $u_j(t)$ 定义在这些点上。\n    - 单元格面位于 $y_{j+1/2} = (j+1/2)\\Delta y$。\n    - 初始速度剖面 $u_j^0 = u(y_j, 0)$ 根据测试案例设置：\n      - 对于周期性剪切：$u_j^0 = U_0 \\sin(2\\pi n y_j / L_y) = U_0 \\sin(2\\pi n j / N)$。\n      - 对于均匀流：$u_j^0 = U_0$。\n\n2.  **面上的剪切和涡黏性：**\n    问题指定涡黏性 $\\nu_t$ 是基于面上的剪切在单元格面上计算的。我们使用二阶中心差分来近似面 $j+1/2$（在单元格 $j$ 和 $j+1$ 之间）上的剪切：\n    $$\n    \\left( \\frac{\\partial u}{\\partial y} \\right)_{j+1/2} \\approx \\frac{u_{j+1} - u_j}{\\Delta y}\n    $$\n    由于周期性，$u_N = u_0$。这个离散剪切是为所有 $N$ 个面计算的。每个面上的涡黏性则为：\n    $$\n    \\nu_{t, j+1/2} = (C_s \\Delta y)^2 \\left| \\frac{u_{j+1} - u_j}{\\Delta y} \\right|\n    $$\n\n3.  **面上的扩散通量：**\n    扩散通量是 $f = (\\nu + \\nu_t) \\frac{\\partial u}{\\partial y}$。在面 $j+1/2$ 处，离散通量 $f_{j+1/2}$ 使用已在该面上计算的量来计算：\n    $$\n    f_{j+1/2} = (\\nu + \\nu_{t, j+1/2}) \\left( \\frac{u_{j+1} - u_j}{\\Delta y} \\right)\n    $$\n\n4.  **中心处的通量散度：**\n    单元格中心 $j$ 处速度的时间倾向由通量的散度给出，$\\partial_t u = \\partial f / \\partial y$。这被离散为面通量的中心差分：\n    $$\n    \\left( \\frac{\\partial u}{\\partial t} \\right)_j = \\left( \\frac{\\partial f}{\\partial y} \\right)_j \\approx \\frac{f_{j+1/2} - f_{j-1/2}}{\\Delta y}\n    $$\n    由于周期性，单元格 $0$ 左侧的面（在 $y_{-1/2}$ 处）与单元格 $N-1$ 右侧的面（在 $y_{N-1/2}$ 处）相同。此方法应用于所有 $N$ 个单元格中心，以找到时间导数数组 $(\\partial u/\\partial t)_j$。\n\n5.  **时间积分：**\n    使用单个前向欧拉步将速度剖面从时间 $t=0$ 更新到 $t=\\Delta t$。对于每个单元格 $j$：\n    $$\n    u_j(\\Delta t) = u_j(0) + \\Delta t \\left( \\frac{\\partial u}{\\partial t} \\right)_j\n    $$\n\n6.  **输出计算：**\n    - 速度剖面调整量是 $\\Delta u_j = u_j(\\Delta t) - u_j(0) = \\Delta t (\\partial u/\\partial t)_j$。所需的输出是 $\\max_j |\\Delta u_j|$。\n    - 更新后的中心点速度为 $u_{\\mathrm{center}} = u_k(\\Delta t)$，其中 $k = \\lfloor N/2 \\rfloor$ 是域中心网格点的索引。\n\n此数值程序应用于每个测试案例以生成所需的结果。对于均匀流情况，初始剪切处处为零，导致涡黏性和通量均为零，从而速度剖面没有变化，这与物理预期相符。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A: (U0, Ly, N, Cs, dt, nu, n)\n        (1.0, 2000.0, 129, 0.12, 50.0, 1e-5, 1),\n        # Case B: uniform flow, n is None\n        (0.8, 1000.0, 128, 0.17, 100.0, 1e-5, None),\n        # Case C\n        (0.5, 1000.0, 257, 0.20, 10.0, 1e-5, 2),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation_step(*case)\n        results.append(result)\n\n    # Format the final output string to be exactly [[r1_1,r1_2],[r2_1,r2_2],...]\n    # without any spaces as per the example in the problem description.\n    output_str = str(results).replace(' ', '')\n    print(output_str)\n\ndef run_simulation_step(U0, Ly, N, Cs, dt, nu, n_wave):\n    \"\"\"\n    Performs a single time step of the diffusive LES model for a 1D shear flow.\n\n    Args:\n        U0 (float): Amplitude of the initial velocity profile [m/s].\n        Ly (float): Domain length [m].\n        N (int): Number of grid points.\n        Cs (float): Smagorinsky constant.\n        dt (float): Time step [s].\n        nu (float): Molecular viscosity [m^2/s].\n        n_wave (int or None): Wavenumber for the sinusoidal profile. If None, a uniform profile is used.\n\n    Returns:\n        list: A list containing [max|Δu|, u_center] in m/s.\n    \"\"\"\n    \n    # 1. Grid and Initial Profile\n    # The filter width Delta is equal to the grid spacing dy.\n    dy = Ly / N\n    # Grid points are at cell centers y_j = j * dy.\n    y = np.arange(N) * dy\n    \n    if n_wave is not None:\n        # Periodic shear profile: u(y,0) = U0 * sin(2*pi*n*y / Ly)\n        # which simplifies to u_j = U0 * sin(2*pi*n*j / N)\n        u0 = U0 * np.sin(2 * np.pi * n_wave * y / Ly)\n    else:\n        # Uniform flow profile\n        u0 = U0 * np.ones(N)\n\n    # 2. Compute shear and eddy viscosity at cell faces\n    # The shear at face j+1/2 is (u_{j+1} - u_j) / dy.\n    # np.roll(u0, -1) provides u_{j+1} with periodic boundary conditions.\n    shear_at_faces = (np.roll(u0, -1) - u0) / dy\n    \n    # Eddy viscosity nu_t = (Cs * Delta)^2 * |S|, where |S| = |du/dy|\n    nu_t_faces = (Cs * dy)**2 * np.abs(shear_at_faces)\n    \n    # 3. Compute diffusive flux at faces\n    # The flux is f = (nu + nu_t) * (du/dy). All terms are evaluated at faces.\n    flux_faces = (nu + nu_t_faces) * shear_at_faces\n    \n    # 4. Compute flux divergence at cell centers\n    # The divergence at cell j is (f_{j+1/2} - f_{j-1/2}) / dy.\n    # np.roll(flux_faces, 1) provides f_{j-1/2}.\n    flux_divergence = (flux_faces - np.roll(flux_faces, 1)) / dy\n    dudt = flux_divergence\n    \n    # 5. Advance in time with a single forward-Euler step\n    # u_new = u_old + dt * (du/dt)\n    u1 = u0 + dt * dudt\n    \n    # 6. Calculate and report outputs\n    # Velocity adjustment is Δu = u1 - u0 = dt * dudt\n    delta_u = dt * dudt\n    max_abs_delta_u = np.max(np.abs(delta_u))\n    \n    # Center-point is at index floor(N/2)\n    center_index = N // 2\n    u_center = u1[center_index]\n    \n    return [max_abs_delta_u, u_center]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "一次成功的大涡模拟要求网格能够解析包含能量的湍流运动，但在像海洋层化这样复杂的环境中，我们如何评估这一点呢？本练习通过引入 Ozmidov 尺度 $L_O$ 来深入探讨层化湍流的物理机制，该尺度标志着从各向同性湍流到受浮力影响运动的过渡 。通过从基本原理推导 $L_O$ 并将其与一个提议的网格间距进行比较，你将学到一项在真实海洋场景中设计和验证 LES 设置的关键技能。",
            "id": "3798417",
            "problem": "计划进行一项数值研究，使用大涡模拟（LES）来模拟一个稳定分层的开阔海洋湍流斑块。该斑块可以很好地用Boussinesq近似来描述，并具有均匀的背景浮力频率 $N$ 和单位质量的湍动能耗散率 $\\epsilon$。LES 使用均匀、各向同性的网格间距 $\\Delta$。Ozmidov 长度（在概念上）定义为分层不会抑制各向同性的最大垂直湍流翻转尺度。仅从惯性区湍流和分层动力学的基本标度律出发，按以下步骤进行：\n\n1. 使用尺度为 $\\ell$ 时速度的惯性区 Kolmogorov 标度律，即特征速度满足 $u_{\\ell} \\sim (\\epsilon \\,\\ell)^{1/3}$，以及分层引入了浮力时间尺度 $T_{b} \\sim N^{-1}$（其中 $N$ 是浮力频率）这一事实。施加一个判据：当涡旋翻转时间 $T_{\\ell} \\sim \\ell/u_{\\ell}$ 与浮力时间 $T_{b}$ 相当时（等效于尺度 $\\ell$ 上的 Froude 数为1的量级），尺度为 $\\ell$ 的分层限制湍流开始出现。根据这些要素，推导出 Ozmidov 长度 $L_{O}$ 作为 $\\epsilon$ 和 $N$ 的函数的闭合形式表达式，且不引入任何额外的有量纲参数。\n\n2. 给定温跃层中部区域的微结构测量值，表明 $N = 2.5 \\times 10^{-3}\\ \\text{s}^{-1}$ 和 $\\epsilon = 1.0 \\times 10^{-8}\\ \\text{m}^{2}\\,\\text{s}^{-3}$，以及建议的 LES 网格间距 $\\Delta = 0.40\\ \\text{m}$，计算无量纲比率\n$$\nR \\equiv \\frac{L_{O}}{\\Delta}.\n$$\n只报告 $R$ 的值。将你的答案四舍五入到四位有效数字。比率 $R$ 是无量纲的，报告时不应带单位。\n\n注意：尽管关于分层是否限制了解析出的湍流这一对 $R$ 的解释是有意义的，但请不要在最终答案中包含任何定性陈述；仅按要求提供 $R$ 的数值。",
            "solution": "首先对问题进行验证，发现其在科学上是合理的、适定的，并包含了完整解答所需的所有信息。推导和随后的计算按要求分两部分进行。\n\n第1部分：Ozmidov 长度 $L_{O}$ 的推导\n\n推导从所给出的分层流体中湍流的基本标度关系开始。在惯性子区内，一个尺度为 $\\ell$ 的湍涡的特征速度 $u_{\\ell}$ 由 Kolmogorov 的标度理论给出：\n$$\nu_{\\ell} \\sim (\\epsilon \\ell)^{1/3}\n$$\n其中 $\\epsilon$ 是单位质量的湍动能耗散率。\n\n由此，我们可以定义一个特征涡旋翻转时间 $T_{\\ell}$，即一个尺度为 $\\ell$ 的涡旋翻转一周所需的时间。它被估计为涡旋尺度与其特征速度之比：\n$$\nT_{\\ell} \\sim \\frac{\\ell}{u_{\\ell}}\n$$\n将 $u_{\\ell}$ 的表达式代入 $T_{\\ell}$ 的表达式中，得到：\n$$\nT_{\\ell} \\sim \\frac{\\ell}{(\\epsilon \\ell)^{1/3}} = \\frac{\\ell^{1}}{\\epsilon^{1/3}\\ell^{1/3}} = \\epsilon^{-1/3} \\ell^{2/3}\n$$\n在以均匀浮力频率 $N$ 为特征的稳定分层流体中，存在一个与浮力相关的自然时间尺度，即 Brunt-Väisälä 周期，其标度关系为：\n$$\nT_{b} \\sim \\frac{1}{N}\n$$\nOzmidov 长度 $L_{O}$ 被定义为湍流动力学开始受到分层显著影响的尺度。从物理上讲，这发生在涡旋翻转时间与浮力时间尺度相当的时候。在此尺度下，试图垂直翻转的湍涡在完成翻转之前就会被恢复浮力所抑制。我们通过在特定尺度 $\\ell = L_{O}$ 处设定 $T_{\\ell} \\sim T_{b}$ 来施加此判据：\n$$\nT_{L_{O}} \\sim T_{b}\n$$\n代入时间尺度的表达式，我们得到：\n$$\n\\epsilon^{-1/3} L_{O}^{2/3} \\sim N^{-1}\n$$\n为了找到 $L_{O}$ 的表达式，我们求解此关系式以得到 $L_{O}$。首先，我们分离出包含 $L_{O}$ 的项：\n$$\nL_{O}^{2/3} \\sim \\epsilon^{1/3} N^{-1}\n$$\n接下来，我们将关系式两边都取 $\\frac{3}{2}$ 次方来求解 $L_{O}$：\n$$\n\\left( L_{O}^{2/3} \\right)^{3/2} \\sim \\left( \\epsilon^{1/3} N^{-1} \\right)^{3/2}\n$$\n$$\nL_{O} \\sim \\epsilon^{(1/3) \\cdot (3/2)} N^{(-1) \\cdot (3/2)}\n$$\n$$\nL_{O} \\sim \\epsilon^{1/2} N^{-3/2}\n$$\n这个标度关系给出了 Ozmidov 长度的函数形式。根据物理海洋学领域的惯例，无量纲比例常数取为1。因此，Ozmidov 长度的闭合形式表达式为：\n$$\nL_{O} = \\left( \\frac{\\epsilon}{N^3} \\right)^{1/2}\n$$\n\n第2部分：比率 $R$ 的计算\n\n问题的第二部分要求计算无量纲比率 $R \\equiv \\frac{L_{O}}{\\Delta}$。我们被给予以下数值：\n-   浮力频率：$N = 2.5 \\times 10^{-3}\\ \\text{s}^{-1}$\n-   湍动能耗散率：$\\epsilon = 1.0 \\times 10^{-8}\\ \\text{m}^{2}\\,\\text{s}^{-3}$\n-   LES 网格间距：$\\Delta = 0.40\\ \\text{m}$\n\n首先，我们使用第1部分推导出的表达式和所给数据计算 $L_{O}$ 的值。\n我们首先计算 $N^3$：\n$$\nN^3 = (2.5 \\times 10^{-3}\\ \\text{s}^{-1})^{3} = (2.5)^3 \\times (10^{-3})^3\\ \\text{s}^{-3} = 15.625 \\times 10^{-9}\\ \\text{s}^{-3}\n$$\n现在我们计算比率 $\\frac{\\epsilon}{N^3}$：\n$$\n\\frac{\\epsilon}{N^3} = \\frac{1.0 \\times 10^{-8}\\ \\text{m}^{2}\\,\\text{s}^{-3}}{15.625 \\times 10^{-9}\\ \\text{s}^{-3}} = \\frac{10.0 \\times 10^{-9}}{15.625 \\times 10^{-9}}\\ \\text{m}^{2} = 0.64\\ \\text{m}^{2}\n$$\n最后，我们取平方根来求得 $L_{O}$：\n$$\nL_{O} = \\sqrt{0.64\\ \\text{m}^{2}} = 0.8\\ \\text{m}\n$$\n在计算出 $L_{O}$ 的值后，我们现在可以计算比率 $R$：\n$$\nR = \\frac{L_{O}}{\\Delta} = \\frac{0.8\\ \\text{m}}{0.40\\ \\text{m}}\n$$\n$$\nR = 2.0\n$$\n问题要求答案报告为四位有效数字。因此，我们将结果表示为：\n$$\nR = 2.000\n$$\n这个比率 $R$ 代表了 LES 网格对 Ozmidov 尺度的解析度。由于 $R  1$，网格足够精细，可以在最大的各向同性尺度被分层抑制之前将其解析出来。",
            "answer": "$$\n\\boxed{2.000}\n$$"
        },
        {
            "introduction": "静态亚网格模型，如标准的 Smagorinsky 模型，使用一个可能不适用于所有流动状态的常数系数。动态模型通过利用优美的 Germano 恒等式，从已解析的流场本身计算模型系数，从而克服了这一限制。这项练习将引导你理解该恒等式的力学原理，为一个简单的离散流场将亚网格应力分解为其组成的 Leonard 项、交叉项和雷诺项 。完成此练习将揭开动态过程内部工作的神秘面紗，并为理解更高级的大涡模拟封闭方案奠定坚实的基础。",
            "id": "3798422",
            "problem": "考虑一个穿过海洋混合层的一维横断面，其中水平均匀、不可压缩的速度场具有两个非零的笛卡尔分量 $u_{1}(x)$ 和 $u_{2}(x)$，分别解释为纬向速度和经向速度。在大涡模拟 (LES) 中，定义网格尺度 $\\Delta$ 上的空间滤波算子为 $\\overline{f}(x) = \\int G_{\\Delta}(\\xi) f(x-\\xi) \\, d\\xi$，以及在 $\\tilde{\\Delta} = \\alpha \\Delta$ 上的第二个更粗的测试滤波器为 $\\widehat{f}(x) = \\int G_{\\tilde{\\Delta}}(\\xi) f(x-\\xi) \\, d\\xi$，其中 $G_{\\Delta}$ 和 $G_{\\tilde{\\Delta}}$ 是归一化的偶核函数。网格尺度上的亚网格尺度 (SGS) 应力定义为 $\\tau_{ij}(x) = \\overline{u_{i} u_{j}}(x) - \\overline{u}_{i}(x)\\,\\overline{u}_{j}(x)$，而测试尺度上的 SGS 应力为 $T_{ij}(x) = \\widehat{u_{i} u_{j}}(x) - \\widehat{u}_{i}(x)\\,\\widehat{u}_{j}(x)$。从这些定义出发，通过将 $u_{i}$ 写成 $u_{i} = \\overline{u}_{i} + u_{i}'$（其中 $u_{i}'$ 是网格尺度的亚滤波器脉动），推导出测试尺度上 $T_{ij}$ 的 Germano 分解，即分解为 Leonard 项、交叉项和 Reynolds 项。\n\n然后，使用以下离散、周期性的三点表示法，计算在特定位置 $x_{0}$ 处非对角分量 $i=1, j=2$ 的这三项。给定三个具有周期性边界条件的等间距点上的原始速度：\n$$\nu_{1} = \\begin{pmatrix} 0.40  0.55  0.70 \\end{pmatrix} \\, , \\quad\nu_{2} = \\begin{pmatrix} 0.10  -0.05  0.25 \\end{pmatrix} \\, ,\n$$\n其中各项对应于 $x_{1}$、$x_{2}=x_{0}$、$x_{3}$。尺度 $\\Delta$ 上的网格滤波器是在每个点为中心的离散卷积，其权重为 $\\left( \\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4} \\right)$，应用于最近邻点和该点本身（使用周期性延拓），即：\n$$\n\\overline{f}(x_{k}) = \\frac{1}{4} f(x_{k-1}) + \\frac{1}{2} f(x_{k}) + \\frac{1}{4} f(x_{k+1}) \\, ,\n$$\n其中指数以 3 为模。尺度 $\\tilde{\\Delta}$ 上的测试滤波器是这三个点的等权重平均值，\n$$\n\\widehat{f}(x_{2}) = \\frac{1}{3}\\left[ f(x_{1}) + f(x_{2}) + f(x_{3}) \\right] \\, .\n$$\n按以下步骤进行：\n1. 使用上述定义，推导在 $x_{2}$ 处 $T_{12}$ 分解为三个贡献项之和，这三项通常被称为 Leonard 项、交叉项和 Reynolds 项。\n2. 计算滤波后的场 $\\overline{u}_{i}(x_{k})$、脉动 $u_{i}'(x_{k})$ 以及在 $x_{2}$ 处计算每一项所需的所有测试滤波后的量。\n3. 将 $x_{2}$ 处的非对角分量的三个值以单个行向量 $\\left( L_{12}, C_{12}, R_{12} \\right)$ 的形式给出。\n\n最终分量以 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$ 为单位表示。提供精确值，不要四舍五入。最终答案必须是包含 Leonard、交叉、Reynolds 这三个分量（按此顺序）的单行矩阵。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **速度场**：具有两个速度分量 $u_{1}(x)$ 和 $u_{2}(x)$ 的一维横断面。\n-   **网格滤波器**：在尺度 $\\Delta$ 上，$\\overline{f}(x) = \\int G_{\\Delta}(\\xi) f(x-\\xi) \\, d\\xi$。\n-   **测试滤波器**：在尺度 $\\tilde{\\Delta} = \\alpha \\Delta$ 上，$\\widehat{f}(x) = \\int G_{\\tilde{\\Delta}}(\\xi) f(x-\\xi) \\, d\\xi$。\n-   **网格尺度SGS应力**：$\\tau_{ij}(x) = \\overline{u_{i} u_{j}}(x) - \\overline{u}_{i}(x)\\,\\overline{u}_{j}(x)$。\n-   **测试尺度SGS应力**：$T_{ij}(x) = \\widehat{u_{i} u_{j}}(x) - \\widehat{u}_{i}(x)\\,\\widehat{u}_{j}(x)$。\n-   **速度分解**：$u_{i} = \\overline{u}_{i} + u_{i}'$，其中 $u_{i}'$ 是亚滤波器脉动。\n-   **原始速度数据**：\n    -   $u_{1} = \\begin{pmatrix} 0.40  0.55  0.70 \\end{pmatrix}$ 在点 $(x_{1}, x_{2}, x_{3})$ 处。\n    -   $u_{2} = \\begin{pmatrix} 0.10  -0.05  0.25 \\end{pmatrix}$ 在点 $(x_{1}, x_{2}, x_{3})$ 处。\n-   **求值点**：$x_{0} = x_{2}$。\n-   **离散网格滤波器**：$\\overline{f}(x_{k}) = \\frac{1}{4} f(x_{k-1}) + \\frac{1}{2} f(x_{k}) + \\frac{1}{4} f(x_{k+1)}$，其中指数以 3 为模。\n-   **离散测试滤波器**：$\\widehat{f}(x_{2}) = \\frac{1}{3}\\left[ f(x_{1}) + f(x_{2}) + f(x_{3}) \\right]$。\n-   **任务**：\n    1.  推导在 $x_2$ 处 $T_{12}$ 分解为 Leonard 项、交叉项和 Reynolds 项。\n    2.  计算所有必需的滤波场和脉动。\n    3.  报告在 $x_{2}$ 处 $(L_{12}, C_{12}, R_{12})$ 的值。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题基于 Germano 恒等式，这是大涡模拟 (LES) 中湍流模拟的一个基本概念。滤波器和亚网格尺度应力的定义在计算流体动力学和海洋学领域是标准的。该问题在科学上是合理的。\n-   **适定性**：所有必需的数据、定义和边界条件（周期性）都已明确给出。对于给定的离散数据集，操作（滤波、分解）定义明确，从而可以得到唯一解。\n-   **客观性**：问题以精确、无偏见的技术语言陈述。\n-   **缺陷分析**：\n    1.  **科学/事实不合理**：无。\n    2.  **不可形式化/不相关**：该问题是可形式化的，并且与海洋湍流的 LES 直接相关。\n    3.  **不完整/矛盾的设置**：无。设置是自洽且一致的。\n    4.  **不现实/不可行**：速度值在物理上是合理的。离散模型是一个简化但有效的计算练习。\n    5.  **不适定/结构不良**：无。存在唯一、稳定且有意义的解。\n    6.  **伪深刻/琐碎**：该问题需要多步推导和计算，考验了对基本概念的理解。它并非琐碎问题。\n    7.  **超出科学可验证范围**：计算过程在数学上是可验证的。\n\n**步骤 3：结论与行动**\n\n-   **结论**：问题是**有效的**。\n-   **行动**：继续进行求解。\n\n### 解答\n\n解答按要求分为三部分进行：Germano 分解的推导、中间量的计算和最终分量的计算。我们假设给定的速度分量 $u_1$ 和 $u_2$ 的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，因此得到的应力分量的单位是 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。\n\n**1. Germano 分解**\n\n测试尺度的亚网格尺度 (SGS) 应力定义为 $T_{ij} = \\widehat{u_{i} u_{j}} - \\widehat{u}_{i}\\widehat{u}_{j}$。我们将速度场 $u_i$ 分解为其网格滤波（解析）部分 $\\overline{u}_i$ 和亚滤波器（未解析）部分 $u_i'$，使得 $u_i = \\overline{u}_i + u_i'$。\n\n将此分解代入 $T_{ij}$ 的定义中：\n$$\nT_{ij} = \\widehat{(\\overline{u}_i + u'_i)(\\overline{u}_j + u'_j)} - \\widehat{(\\overline{u}_i + u'_i)} \\widehat{(\\overline{u}_j + u'_j)}\n$$\n展开两项并利用滤波算子的线性性质：\n$$\nT_{ij} = \\left(\\widehat{\\overline{u}_i \\overline{u}_j} + \\widehat{\\overline{u}_i u'_j} + \\widehat{u'_i \\overline{u}_j} + \\widehat{u'_i u'_j}\\right) - \\left((\\widehat{\\overline{u}}_i + \\widehat{u'_i})(\\widehat{\\overline{u}}_j + \\widehat{u'_j})\\right)\n$$\n$$\nT_{ij} = \\left(\\widehat{\\overline{u}_i \\overline{u}_j} + \\widehat{\\overline{u}_i u'_j} + \\widehat{u'_i \\overline{u}_j} + \\widehat{u'_i u'_j}\\right) - \\left(\\widehat{\\overline{u}}_i \\widehat{\\overline{u}}_j + \\widehat{\\overline{u}}_i \\widehat{u'_j} + \\widehat{u'_i} \\widehat{\\overline{u}}_j + \\widehat{u'_i} \\widehat{u'_j}\\right)\n$$\n我们根据各项所代表的尺度对其进行分组：\n-   **Leonard 项**，$L_{ij}$，表示由测试滤波器所见的解析尺度产生的应力。它只包含解析尺度的量 ($\\overline{u}$)。\n    $$\n    L_{ij} = \\widehat{\\overline{u}_i \\overline{u}_j} - \\widehat{\\overline{u}}_i \\widehat{\\overline{u}}_j\n    $$\n-   **交叉项**，$C_{ij}$，表示解析尺度和未解析尺度之间的相互作用。\n    $$\n    C_{ij} = \\left(\\widehat{\\overline{u}_i u'_j} + \\widehat{u'_i \\overline{u}_j}\\right) - \\left(\\widehat{\\overline{u}}_i \\widehat{u'_j} + \\widehat{u'_i} \\widehat{\\overline{u}}_j\\right)\n    $$\n-   **Reynolds 项**，$R_{ij}$，表示由未解析尺度产生的应力。它类似于 SGS 应力，但是针对亚滤波器速度脉动而言。\n    $$\n    R_{ij} = \\widehat{u'_i u'_j} - \\widehat{u'_i} \\widehat{u'_j}\n    $$\n因此，完整的分解为 $T_{ij} = L_{ij} + C_{ij} + R_{ij}$。\n\n**2. 滤波场和脉动的计算**\n\n给定原始速度数据：\n$u_{1} = \\begin{pmatrix} 0.40  0.55  0.70 \\end{pmatrix}$\n$u_{2} = \\begin{pmatrix} 0.10  -0.05  0.25 \\end{pmatrix}$\n\n首先，我们应用网格滤波器 $\\overline{f}(x_{k}) = \\frac{1}{4} f(x_{k-1}) + \\frac{1}{2} f(x_{k}) + \\frac{1}{4} f(x_{k+1)}$，并使用周期性边界条件（指数以 3 为模）。\n\n对于 $\\overline{u}_1$：\n$\\overline{u}_{1}(x_{1}) = \\frac{1}{4}(0.70) + \\frac{1}{2}(0.40) + \\frac{1}{4}(0.55) = 0.175 + 0.200 + 0.1375 = 0.5125$\n$\\overline{u}_{1}(x_{2}) = \\frac{1}{4}(0.40) + \\frac{1}{2}(0.55) + \\frac{1}{4}(0.70) = 0.100 + 0.275 + 0.175 = 0.55$\n$\\overline{u}_{1}(x_{3}) = \\frac{1}{4}(0.55) + \\frac{1}{2}(0.70) + \\frac{1}{4}(0.40) = 0.1375 + 0.350 + 0.100 = 0.5875$\n所以，$\\overline{u}_{1} = \\begin{pmatrix} 0.5125  0.55  0.5875 \\end{pmatrix}$。\n\n对于 $\\overline{u}_2$：\n$\\overline{u}_{2}(x_{1}) = \\frac{1}{4}(0.25) + \\frac{1}{2}(0.10) + \\frac{1}{4}(-0.05) = 0.0625 + 0.050 - 0.0125 = 0.10$\n$\\overline{u}_{2}(x_{2}) = \\frac{1}{4}(0.10) + \\frac{1}{2}(-0.05) + \\frac{1}{4}(0.25) = 0.025 - 0.025 + 0.0625 = 0.0625$\n$\\overline{u}_{2}(x_{3}) = \\frac{1}{4}(-0.05) + \\frac{1}{2}(0.25) + \\frac{1}{4}(0.10) = -0.0125 + 0.125 + 0.025 = 0.1375$\n所以，$\\overline{u}_{2} = \\begin{pmatrix} 0.10  0.0625  0.1375 \\end{pmatrix}$。\n\n接下来，我们计算脉动 $u'_{i} = u_{i} - \\overline{u}_{i}$。\n对于 $u'_1$：\n$u'_{1}(x_{1}) = 0.40 - 0.5125 = -0.1125$\n$u'_{1}(x_{2}) = 0.55 - 0.55 = 0$\n$u'_{1}(x_{3}) = 0.70 - 0.5875 = 0.1125$\n所以，$u'_{1} = \\begin{pmatrix} -0.1125  0  0.1125 \\end{pmatrix}$。\n\n对于 $u'_2$：\n$u'_{2}(x_{1}) = 0.10 - 0.10 = 0$\n$u'_{2}(x_{2}) = -0.05 - 0.0625 = -0.1125$\n$u'_{2}(x_{3}) = 0.25 - 0.1375 = 0.1125$\n所以，$u'_{2} = \\begin{pmatrix} 0  -0.1125  0.1125 \\end{pmatrix}$。\n\n现在我们使用 $\\widehat{f}(x_{2}) = \\frac{1}{3}\\sum_{k=1}^{3} f(x_{k})$ 来计算在 $x_2$ 处的测试滤波量。\n$\\widehat{\\overline{u}}_{1}(x_{2}) = \\frac{1}{3}(0.5125 + 0.55 + 0.5875) = \\frac{1}{3}(1.65) = 0.55$\n$\\widehat{\\overline{u}}_{2}(x_{2}) = \\frac{1}{3}(0.10 + 0.0625 + 0.1375) = \\frac{1}{3}(0.30) = 0.10$\n$\\widehat{u'}_{1}(x_{2}) = \\frac{1}{3}(-0.1125 + 0 + 0.1125) = 0$\n$\\widehat{u'}_{2}(x_{2}) = \\frac{1}{3}(0 - 0.1125 + 0.1125) = 0$\n\n接下来，我们计算乘积场的测试滤波。\n对于 $L_{12}$，我们需要 $\\widehat{\\overline{u}_{1} \\overline{u}_{2}}(x_2)$：\n乘积场 $\\overline{u}_{1} \\overline{u}_{2}$ 为：\n$(\\overline{u}_{1} \\overline{u}_{2})(x_{1}) = (0.5125)(0.10) = 0.05125$\n$(\\overline{u}_{1} \\overline{u}_{2})(x_{2}) = (0.55)(0.0625) = 0.034375$\n$(\\overline{u}_{1} \\overline{u}_{2})(x_{3}) = (0.5875)(0.1375) = 0.08078125$\n$\\widehat{\\overline{u}_{1} \\overline{u}_{2}}(x_{2}) = \\frac{1}{3}(0.05125 + 0.034375 + 0.08078125) = \\frac{1}{3}(0.16640625) = 0.05546875$。\n\n对于 $C_{12}$，我们需要 $\\widehat{\\overline{u}_{1} u'_{2} + u'_{1} \\overline{u}_{2}}(x_2)$：\n乘积场 $(\\overline{u}_{1} u'_{2} + u'_{1} \\overline{u}_{2})$ 为：\n在 $x_1$ 处：$(0.5125)(0) + (-0.1125)(0.10) = -0.01125$\n在 $x_2$ 处：$(0.55)(-0.1125) + (0)(0.0625) = -0.061875$\n在 $x_3$ 处：$(0.5875)(0.1125) + (0.1125)(0.1375) = 0.06609375 + 0.01546875 = 0.0815625$\n$\\widehat{\\overline{u}_{1} u'_{2} + u'_{1} \\overline{u}_{2}}(x_{2}) = \\frac{1}{3}(-0.01125 - 0.061875 + 0.0815625) = \\frac{1}{3}(0.0084375) = 0.0028125$。\n\n对于 $R_{12}$，我们需要 $\\widehat{u'_{1} u'_{2}}(x_2)$：\n乘积场 $u'_{1} u'_{2}$ 为：\n$(u'_{1} u'_{2})(x_{1}) = (-0.1125)(0) = 0$\n$(u'_{1} u'_{2})(x_{2}) = (0)(-0.1125) = 0$\n$(u'_{1} u'_{2})(x_{3}) = (0.1125)(0.1125) = 0.01265625$\n$\\widehat{u'_{1} u'_{2}}(x_{2}) = \\frac{1}{3}(0 + 0 + 0.01265625) = 0.00421875$。\n\n**3. 在 $x_2$ 处计算 $L_{12}$、$C_{12}$ 和 $R_{12}$**\n\n现在我们将计算出的量代入 $x_{2}$ 处三项的定义中。\n\n**Leonard 项 ($L_{12}$):**\n$$L_{12}(x_{2}) = \\widehat{\\overline{u}_{1} \\overline{u}_{2}}(x_{2}) - \\widehat{\\overline{u}}_{1}(x_{2}) \\widehat{\\overline{u}}_{2}(x_{2})$$\n$$L_{12}(x_{2}) = 0.05546875 - (0.55)(0.10) = 0.05546875 - 0.055 = 0.00046875$$\n\n**交叉项 ($C_{12}$):**\n$$C_{12}(x_{2}) = \\left(\\widehat{\\overline{u}_{1} u'_{2} + u'_{1} \\overline{u}_{2}}\\right)(x_{2}) - \\left(\\widehat{\\overline{u}}_{1}(x_{2}) \\widehat{u'}_{2}(x_{2}) + \\widehat{u'}_{1}(x_{2}) \\widehat{\\overline{u}}_{2}(x_{2})\\right)$$\n由于 $\\widehat{u'}_{1}(x_{2})=0$ 且 $\\widehat{u'}_{2}(x_{2})=0$，第二部分为零。\n$$C_{12}(x_{2}) = 0.0028125 - \\left((0.55)(0) + (0)(0.10)\\right) = 0.0028125$$\n\n**Reynolds 项 ($R_{12}$):**\n$$R_{12}(x_{2}) = \\widehat{u'_{1} u'_{2}}(x_{2}) - \\widehat{u'}_{1}(x_{2}) \\widehat{u'}_{2}(x_{2})$$\n由于 $\\widehat{u'}_{1}(x_{2})=0$ 且 $\\widehat{u'}_{2}(x_{2})=0$，第二部分为零。\n$$R_{12}(x_{2}) = 0.00421875 - (0)(0) = 0.00421875$$\n\n在位置 $x_2$ 处，非对角 SGS 应力项 $T_{12}$ 的三个分量为 $(L_{12}, C_{12}, R_{12})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.00046875  0.0028125  0.00421875\n\\end{pmatrix}\n}\n$$"
        }
    ]
}