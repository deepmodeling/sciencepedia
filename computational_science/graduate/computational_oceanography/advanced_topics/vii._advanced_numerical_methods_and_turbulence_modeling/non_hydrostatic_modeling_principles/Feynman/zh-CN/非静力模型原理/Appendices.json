{
    "hands_on_practices": [
        {
            "introduction": "非静力压力是垂直加速度打破静力平衡的直接结果，但我们如何量化它的大小呢？本练习通过量纲分析这一地球物理流体动力学中的基本工具，从第一性原理出发，推导非静力压力的标度。通过这个过程，你将清晰地看到非静力效应何时由动力压力 $\\rho_0 U^2$ 主导，何时相对于静力压力 $\\rho_0 g H$ 变得可以忽略，从而深刻理解非静力模型的适用范围 ()。",
            "id": "3802855",
            "problem": "考虑一个在Boussinesq近似下描述的三维不可压缩海洋流，其具有恒定的参考密度$\\rho_{0}$、重力加速度$g$、特征水平速度尺度$U$、水平长度尺度$L$和垂直深度尺度$H$。设总压力为$p$，并通过$\\partial p_{h}/\\partial z=-\\rho_{0} g$定义静压基态压力$p_{h}$，非静压分量由$p_{nh}=p-p_{h}$给出。假设该流在一个特征平流时间尺度$T\\sim L/U$上演变。请仅使用不可压缩Boussinesq动量方程和连续性方程的第一性原理尺度分析，推导出一个关于$p_{nh}$主导阶尺度的单一、紧凑的解析表达式，该表达式以$\\rho_{0}$、$U$、$g$、$H$和$L$表示。您的推导过程必须从垂直动量方程和连续性方程开始，从不可压缩性估算垂直速度尺度，并通过物质导数量化垂直加速度尺度。请用一种能同时揭示以下两种情况的形式来表达您的最终结果：\n- 当流在空间中快速变化时（水平与垂直尺度相当），$p_{nh}$如何与$\\rho_{0} U^{2}$形成尺度关系。\n- 当流是缓慢变化且主导阶为静压平衡时，$p_{nh}$如何相对于$\\rho_{0} g H$形成尺度关系。\n\n您可以引入纵横比$\\delta=H/L$和弗劳德数$\\mathrm{Fr}=U/\\sqrt{g H}$来紧凑地表达答案，但您的最终表达式必须完全用$\\rho_{0}$、$U$、$g$、$H$和$L$表示，或等价地用$\\rho_{0}$、$g$、$H$、$L$和$\\mathrm{Fr}$表示。请给出$p_{nh}$主导阶量级的最终解析表达式。无需进行数值计算。",
            "solution": "该问题陈述经评估具有科学依据、适定且客观。它基于地球物理流体动力学的标准原理，并提供了一个清晰、可处理的任务。为对不可压缩Boussinesq方程进行尺度分析，所有必要的物理尺度和常数均已提供。因此，该问题是有效的，下面给出完整解答。\n\n推导的出发点是在Boussinesq近似下不可压缩流体动量方程的垂直分量和连续性方程。总压力$p$被分解为静压基态分量$p_h$和非静压分量$p_{nh}$，使得$p = p_h + p_{nh}$。静压由平衡关系$\\frac{\\partial p_h}{\\partial z} = -\\rho_0 g$定义，其中$\\rho_0$是恒定的参考密度，g是重力加速度。\n\n垂直动量方程由下式给出：\n$$ \\rho_0 \\frac{Dw}{Dt} = -\\frac{\\partial p}{\\partial z} - \\rho g $$\n在Boussinesq近似下，密度的变化仅在浮力项中考虑。然而，问题陈述通过定义$\\frac{\\partial p_h}{\\partial z} = -\\rho_0 g$来聚焦于压力分解，这意味着我们正在分析以下形式的动量方程：\n$$ \\frac{Dw}{Dt} = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial z} - g $$\n将$p = p_h + p_{nh}$代入此方程可得：\n$$ \\frac{Dw}{Dt} = -\\frac{1}{\\rho_0} \\frac{\\partial (p_h + p_{nh})}{\\partial z} - g = -\\frac{1}{\\rho_0} \\frac{\\partial p_h}{\\partial z} - \\frac{1}{\\rho_0} \\frac{\\partial p_{nh}}{\\partial z} - g $$\n使用所提供的静压基态定义$\\frac{\\partial p_h}{\\partial z} = -\\rho_0 g$：\n$$ \\frac{Dw}{Dt} = -\\frac{1}{\\rho_0} (-\\rho_0 g) - \\frac{1}{\\rho_0} \\frac{\\partial p_{nh}}{\\partial z} - g = g - \\frac{1}{\\rho_0} \\frac{\\partial p_{nh}}{\\partial z} - g $$\n这简化为垂直加速度与非静压梯度之间的基本关系：\n$$ \\rho_0 \\frac{Dw}{Dt} = - \\frac{\\partial p_{nh}}{\\partial z} $$\n我们现在将对该方程和连续性方程进行尺度分析，以确定非静压的特征尺度，我们将其记为$P_{nh}$。系统的特征尺度已给出：\n-   水平长度尺度：$[x, y] \\sim L$\n-   垂直长度尺度：$[z] \\sim H$\n-   水平速度尺度：$[u, v] \\sim U$\n-   平流时间尺度：$[t] \\sim T \\sim L/U$\n-   垂直速度尺度：$[w] \\sim W$\n-   非静压尺度：$[p_{nh}] \\sim P_{nh}$\n\n首先，我们从不可压缩连续性方程确定垂直速度$W$的尺度：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\n平衡各项的尺度，我们有：\n$$ \\frac{U}{L} + \\frac{U}{L} \\sim \\frac{W}{H} $$\n这得到了垂直速度的尺度：\n$$ W \\sim U \\frac{H}{L} $$\n接下来，我们确定垂直加速度$\\frac{Dw}{Dt}$的尺度。物质导数定义为：\n$$ \\frac{Dw}{Dt} = \\frac{\\partial w}{\\partial t} + u \\frac{\\partial w}{\\partial x} + v \\frac{\\partial w}{\\partial y} + w \\frac{\\partial w}{\\partial z} $$\n我们分析每一项的尺度：\n-   $[\\frac{\\partial w}{\\partial t}] \\sim \\frac{W}{T} = \\frac{U(H/L)}{L/U} = \\frac{U^2 H}{L^2}$\n-   $[u \\frac{\\partial w}{\\partial x}] \\sim U \\frac{W}{L} = U \\frac{U(H/L)}{L} = \\frac{U^2 H}{L^2}$\n-   $[v \\frac{\\partial w}{\\partial y}] \\sim U \\frac{W}{L} = U \\frac{U(H/L)}{L} = \\frac{U^2 H}{L^2}$\n-   $[w \\frac{\\partial w}{\\partial z}] \\sim W \\frac{W}{H} = \\left(U \\frac{H}{L}\\right) \\frac{U(H/L)}{H} = \\frac{U^2 H}{L^2}$\n所有项都具有相同的量级，因此垂直加速度的尺度是：\n$$ \\left[\\frac{Dw}{Dt}\\right] \\sim \\frac{U^2 H}{L^2} $$\n现在我们可以对非静压的垂直动量方程进行尺度分析：\n$$ \\left[\\rho_0 \\frac{Dw}{Dt}\\right] \\sim \\left[- \\frac{\\partial p_{nh}}{\\partial z}\\right] $$\n$$ \\rho_0 \\left(\\frac{U^2 H}{L^2}\\right) \\sim \\frac{P_{nh}}{H} $$\n求解非静压$P_{nh}$的尺度：\n$$ P_{nh} \\sim \\rho_0 U^2 \\left(\\frac{H}{L}\\right)^2 $$\n该表达式给出了非静压的主导阶尺度，用基本参数$\\rho_0$、$U$、$H$和$L$表示。题目进一步要求答案以一种能揭示两种特定尺度行为的形式呈现。为此，我们引入纵横比$\\delta = H/L$和弗劳德数$\\mathrm{Fr} = U/\\sqrt{gH}$，并重写该表达式。将$U = \\mathrm{Fr}\\sqrt{gH}$代入我们关于$P_{nh}$的结果：\n$$ P_{nh} \\sim \\rho_0 (\\mathrm{Fr}\\sqrt{gH})^2 \\left(\\frac{H}{L}\\right)^2 = \\rho_0 (\\mathrm{Fr}^2 g H) \\left(\\frac{H}{L}\\right)^2 $$\n重新整理该式可得：\n$$ P_{nh} \\sim \\rho_0 g H \\cdot \\mathrm{Fr}^2 \\left(\\frac{H}{L}\\right)^2 $$\n这种形式满足题目的要求。它用允许的变量集$\\{\\rho_0, g, H, L, \\mathrm{Fr}\\}$表示，并同时揭示了所需的尺度关系：\n1.  对于快速变化的流，水平和垂直长度尺度相当，即$L \\sim H$。在这种情况下，$(H/L)^2 \\sim 1$，表达式变为$P_{nh} \\sim \\rho_0 g H \\cdot \\mathrm{Fr}^2 = \\rho_0 g H \\frac{U^2}{gH} = \\rho_0 U^2$。这表明$p_{nh}$与动压尺度$\\rho_0 U^2$成比例。\n2.  对于缓慢变化的流，其中静压近似有效，即$H \\ll L$。该表达式已经提取了静压尺度因子$P_h \\sim \\rho_0 g H$。它表明非静压尺度是静压尺度的一部分，该比例由无量纲乘积$\\mathrm{Fr}^2 (H/L)^2$给出。对于缓慢变化的流，$(H/L)^2$很小，表明与主导阶静压平衡相比，$p_{nh}$很小。\n\n因此，该表达式是所要求的单一、紧凑的解析形式。",
            "answer": "$$ \\boxed{\\rho_{0} g H \\mathrm{Fr}^{2} \\left(\\frac{H}{L}\\right)^{2}} $$"
        },
        {
            "introduction": "了解了非静力压力的普适标度后，一个自然的问题是：在真实的海洋现象中，静力近似会引入多大的误差？本练习将理论付诸实践，通过分析对气候和海洋混合至关重要的内波，来精确量化这一误差 ()。你将推导并对比静力与非静力两种假设下的内波频散关系，并计算一个典型内潮场景下的相速度误差，从而直观地感受非静力项在模拟高频、短波过程中的关键作用。",
            "id": "3802883",
            "problem": "在一个满足Boussinesq近似的均匀分层、无粘、不可压缩的海洋中，考虑由线性化的动量、浮力和连续性方程控制的小振幅内波。假设浮力频率 $N$ 为常数，海底位于 $z=-H$ 处且平坦，海面位于 $z=0$ 处为刚盖表面，两个边界均为无垂向流动的边界条件。忽略行星旋转和自由表面效应。考虑在一个深度 $H=4000\\ \\mathrm{m}$、分层 $N=5\\times 10^{-3}\\ \\mathrm{s}^{-1}$ 的海洋中，一个水平传播的模态-1内潮，其水平波长为 $\\lambda=100\\ \\mathrm{km}$。\n\n从线性化方程和平面波拟设出发，其中水平波数为 $k=2\\pi/\\lambda$，垂直结构由边界条件确定，推导：\n- 内重力波的非静力色散关系，并由此得到模态-1对应的相速度 $c_{p,\\mathrm{nh}}$；\n- 色散关系的静力近似及其对应的模态-1相速度 $c_{p,\\mathrm{h}}$。\n\n使用这些结果，定义由静力近似引入的相对相速度误差为\n$$\n\\epsilon \\equiv \\frac{c_{p,\\mathrm{h}}-c_{p,\\mathrm{nh}}}{c_{p,\\mathrm{nh}}}.\n$$\n计算给定参数下的 $\\epsilon$。将最终答案表示为无量纲小数，并四舍五入到四位有效数字。最终答案中不包含任何单位。",
            "solution": "用户希望分析问题陈述，验证其有效性，并在有效的情况下提供一个合理的解答。\n\n### 第1步：提取给定条件\n- **系统**：均匀分层、无粘、不可压缩的海洋。\n- **近似**：Boussinesq近似、小振幅波（线性化方程）、刚盖表面（无自由表面效应）、无行星旋转。\n- **参数**：\n    - 浮力频率：$N = 5 \\times 10^{-3}\\ \\mathrm{s}^{-1}$（常数）。\n    - 海洋深度：$H = 4000\\ \\mathrm{m}$。\n    - 水平波长：$\\lambda = 100\\ \\mathrm{km}$。\n- **边界条件**：\n    - $z = -H$ 处为平坦海底。\n    - $z = 0$ 处为刚盖表面。\n    - 两个边界均无垂向流动（$w(z=0)=0$ 且 $w(z=-H)=0$）。\n- **波类型**：水平传播的模态-1内潮。\n- **定义**：\n    - 水平波数：$k = 2\\pi/\\lambda$。\n    - 相对相速度误差：$\\epsilon \\equiv \\frac{c_{p,\\mathrm{h}}-c_{p,\\mathrm{nh}}}{c_{p,\\mathrm{nh}}}$。\n\n### 第2步：使用提取的给定条件进行验证\n1.  **科学或事实上的不健全性**：该问题描述了分层流体中的内重力波，这是地球物理流体动力学的一个基石。控制方程和近似（线性化的Boussinesq方程）是标准的且科学上是合理的。所提供的$N$、$H$和$\\lambda$的数值对于海洋内潮是物理上现实的。该模型是用于研究此类现象的成熟简化模型。无问题。\n2.  **不可形式化或不相关**：该问题是物理海洋学中一个经典、可形式化的问题。要求直接与非静力模型的原理相关。无问题。\n3.  **不完整或矛盾的设置**：该问题是自洽的。它提供了控制物理框架、所有必要的参数（$N$、$H$、$\\lambda$）、边界条件以及找到唯一解所需的特定模态数（$n=1$）。无问题。\n4.  **不现实或不可行**：条件是理想化的（例如，恒定的$N$、无粘流体），但它们是用于阐释物理原理的标准的、有效的简化假设。它们并非物理上不可能。无问题。\n5.  **不适定或结构不良**：该问题是适定的。所描述的物理系统导出了一个关于垂直结构的Sturm-Liouville特征值问题，该问题有一组唯一的、稳定的解（垂直模态）。无问题。\n6.  **伪深刻、琐碎或同义反复**：该问题需要从基本原理出发进行多步推导，涉及微分方程和边值问题。这是地球物理流体动力学中的一个实质性练习。无问题。\n7.  **超出科学可验证性**：推导出的色散关系和由此产生的相速度可通过既有理论进行验证，并可与实验和观测数据进行比较。无问题。\n\n### 第3步：结论与行动\n该问题是**有效的**。开始解答。\n\n对于一个二维（$x, z$）、无粘、不可压缩、无旋转的Boussinesq流体，其线性化控制方程为：\n动量（水平）：\n$$ \\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x} $$\n动量（垂直）：\n$$ \\frac{\\partial w}{\\partial t} = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial z} - b $$\n浮力：\n$$ \\frac{\\partial b}{\\partial t} + N^2 w = 0 $$\n连续性：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} = 0 $$\n此处，$u$ 和 $w$ 分别是水平和垂直速度分量，$p'$ 是相对于静力平衡的压力扰动，$b = -g\\rho'/\\rho_0$ 是浮力扰动，$\\rho_0$ 是参考密度，$N$ 是恒定的浮力频率。\n\n我们寻求形如 $f(x, z, t) = \\hat{f}(z) \\exp(i(kx - \\omega t))$ 的平面波解，其中 $k$ 是水平波数，$\\omega$ 是角频率。将此拟设代入控制方程，得到一组关于垂直结构函数的常微分方程：\n$$ -i\\omega \\hat{u} = -\\frac{1}{\\rho_0} ik \\hat{p} \\quad \\implies \\quad \\hat{u} = \\frac{k}{\\omega \\rho_0} \\hat{p} $$\n$$ -i\\omega \\hat{w} = -\\frac{1}{\\rho_0} \\frac{d\\hat{p}}{dz} - \\hat{b} $$\n$$ -i\\omega \\hat{b} + N^2 \\hat{w} = 0 \\quad \\implies \\quad \\hat{b} = \\frac{iN^2}{\\omega} \\hat{w} $$\n$$ ik\\hat{u} + \\frac{d\\hat{w}}{dz} = 0 \\quad \\implies \\quad \\hat{u} = \\frac{i}{k} \\frac{d\\hat{w}}{dz} $$\n\n通过合并 $\\hat{u}$ 的两个表达式，我们可以将 $\\hat{p}$ 与 $\\hat{w}$ 联系起来：\n$$ \\frac{k}{\\omega \\rho_0} \\hat{p} = \\frac{i}{k} \\frac{d\\hat{w}}{dz} \\quad \\implies \\quad \\hat{p} = \\frac{i\\omega\\rho_0}{k^2} \\frac{d\\hat{w}}{dz} $$\n现在，将 $\\hat{b}$ 和 $\\hat{p}$ 的表达式代入垂直动量方程：\n$$ -i\\omega \\hat{w} = -\\frac{1}{\\rho_0} \\frac{d}{dz}\\left( \\frac{i\\omega\\rho_0}{k^2} \\frac{d\\hat{w}}{dz} \\right) - \\frac{iN^2}{\\omega} \\hat{w} $$\n$$ -i\\omega \\hat{w} = -\\frac{i\\omega}{k^2} \\frac{d^2\\hat{w}}{dz^2} - \\frac{iN^2}{\\omega} \\hat{w} $$\n所有项除以 $-i\\omega$ 得到：\n$$ \\hat{w} = \\frac{1}{k^2} \\frac{d^2\\hat{w}}{dz^2} + \\frac{N^2}{\\omega^2} \\hat{w} $$\n重新整理得到垂直结构方程，也称为无平均切变流体的Taylor-Goldstein方程：\n$$ \\frac{d^2\\hat{w}}{dz^2} + k^2 \\left( \\frac{N^2}{\\omega^2} - 1 \\right) \\hat{w} = 0 $$\n设垂直波数为 $m$，其中 $m^2 = k^2(N^2/\\omega^2 - 1)$。方程为 $\\frac{d^2\\hat{w}}{dz^2} + m^2 \\hat{w} = 0$。其通解为 $\\hat{w}(z) = A \\sin(mz) + B \\cos(mz)$。\n\n边界条件为表面（$z=0$）和底部（$z=-H$）无垂向流动：\n1.  $\\hat{w}(0) = 0 \\implies A \\sin(0) + B \\cos(0) = 0 \\implies B=0$。\n2.  $\\hat{w}(-H) = 0 \\implies A \\sin(-mH) = 0$。\n为得到非平凡解（$A \\neq 0$），必须有 $\\sin(-mH) = -\\sin(mH) = 0$。这要求 $mH = n\\pi$，其中 $n=1, 2, 3, \\ldots$ 为整数。整数 $n$ 是垂直模态数。\n因此，垂直波数是量子化的：$m_n = \\frac{n\\pi}{H}$。\n\n**非静力色散关系与相速度**\n将 $m_n$ 代入 $m^2$ 的定义中：\n$$ \\left(\\frac{n\\pi}{H}\\right)^2 = k^2 \\left( \\frac{N^2}{\\omega^2} - 1 \\right) $$\n解出 $\\omega^2$ 得到非静力色散关系：\n$$ \\frac{N^2}{\\omega^2} = 1 + \\frac{1}{k^2}\\left(\\frac{n\\pi}{H}\\right)^2 \\implies \\omega^2 = \\frac{N^2 k^2}{k^2 + (n\\pi/H)^2} $$\n水平相速度为 $c_p = \\omega/k$。因此，非静力相速度 $c_{p,\\mathrm{nh}}$ 由下式给出：\n$$ c_{p,\\mathrm{nh}}^2 = \\frac{\\omega^2}{k^2} = \\frac{N^2}{k^2 + (n\\pi/H)^2} \\implies c_{p,\\mathrm{nh}} = \\frac{N}{\\sqrt{k^2 + (n\\pi/H)^2}} $$\n对于指定的模态-1（$n=1$）：\n$$ c_{p,\\mathrm{nh}} = \\frac{N}{\\sqrt{k^2 + (\\pi/H)^2}} $$\n\n**静力近似**\n静力近似假设与压力梯度和浮力相比，垂直加速度可以忽略不计。在垂直动量方程中，这意味着忽略 $\\partial w/\\partial t$ 项，这对于 $\\omega^2 \\ll N^2$ 的低频波是有效的。在数学上，这对应于在垂直结构方程中，相对于 $N^2/\\omega^2$ 项忽略“1”：\n$$ \\frac{d^2\\hat{w}}{dz^2} + k^2 \\frac{N^2}{\\omega^2} \\hat{w} = 0 $$\n在此近似下，垂直波数为 $m_{h,n}^2 = k^2 N^2 / \\omega^2$。边界条件保持不变，因此我们仍然必须满足 $m_{h,n} = n\\pi/H$。\n$$ \\left(\\frac{n\\pi}{H}\\right)^2 = \\frac{k^2 N^2}{\\omega^2} $$\n这给出了静力色散关系：\n$$ \\omega^2 = \\frac{k^2 N^2 H^2}{(n\\pi)^2} \\implies \\omega = \\frac{kNH}{n\\pi} $$\n对应的静力相速度 $c_{p,\\mathrm{h}}$ 是：\n$$ c_{p,\\mathrm{h}} = \\frac{\\omega}{k} = \\frac{NH}{n\\pi} $$\n对于模态-1（$n=1$）：\n$$ c_{p,\\mathrm{h}} = \\frac{NH}{\\pi} $$\n\n**相对相速度误差**\n相对误差 $\\epsilon$ 定义为 $\\epsilon = (c_{p,\\mathrm{h}} - c_{p,\\mathrm{nh}}) / c_{p,\\mathrm{nh}} = c_{p,\\mathrm{h}}/c_{p,\\mathrm{nh}} - 1$。\n让我们计算模态-1的比率：\n$$ \\frac{c_{p,\\mathrm{h}}}{c_{p,\\mathrm{nh}}} = \\frac{NH/\\pi}{N/\\sqrt{k^2 + (\\pi/H)^2}} = \\frac{H}{\\pi} \\sqrt{k^2 + \\left(\\frac{\\pi}{H}\\right)^2} $$\n将 $H/\\pi$ 项移入平方根内：\n$$ \\frac{c_{p,\\mathrm{h}}}{c_{p,\\mathrm{nh}}} = \\sqrt{\\left(\\frac{H}{\\pi}\\right)^2 \\left(k^2 + \\left(\\frac{\\pi}{H}\\right)^2\\right)} = \\sqrt{\\frac{H^2 k^2}{\\pi^2} + 1} = \\sqrt{1 + \\left(\\frac{kH}{\\pi}\\right)^2} $$\n因此，相对误差为：\n$$ \\epsilon = \\sqrt{1 + \\left(\\frac{kH}{\\pi}\\right)^2} - 1 $$\n这个表达式表明，误差取决于无量纲参数 $kH/\\pi$，它代表了海洋深度与水平波长相关的垂直尺度之比。\n\n**数值计算**\n我们给定的数值如下：\n- $H = 4000\\ \\mathrm{m}$\n- $\\lambda = 100\\ \\mathrm{km} = 100 \\times 10^3\\ \\mathrm{m} = 10^5\\ \\mathrm{m}$\n水平波数 $k$ 为：\n$$ k = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi}{10^5}\\ \\mathrm{m}^{-1} $$\n现在，我们计算无量纲参数 $kH/\\pi$：\n$$ \\frac{kH}{\\pi} = \\frac{(2\\pi/10^5) \\times 4000}{\\pi} = \\frac{2 \\times 4000}{10^5} = \\frac{8000}{100000} = 0.08 $$\n最后，我们将这个值代入 $\\epsilon$ 的表达式中：\n$$ \\epsilon = \\sqrt{1 + (0.08)^2} - 1 = \\sqrt{1 + 0.0064} - 1 = \\sqrt{1.0064} - 1 $$\n$$ \\epsilon \\approx 1.003194896 - 1 = 0.003194896 $$\n四舍五入到四位有效数字，我们得到：\n$$ \\epsilon \\approx 0.003195 $$",
            "answer": "$$\\boxed{0.003195}$$"
        },
        {
            "introduction": "既然我们已经认识到非静力效应的物理重要性，那么如何在计算机模型中正确地实现它呢？本练习深入探讨非静力模型的核心算法，即如何在离散的网格上保证流体的不可压缩性 ($\\nabla \\cdot \\boldsymbol{u} = 0$) ()。你将分析在 Arakawa C-grid 上，通过交错存储速度和压力变量，并结合投影法（压力泊松方程）来精确满足这一基本物理约束的精妙机制，这是构建任何现代非静力海洋模型的基石。",
            "id": "3802929",
            "problem": "在Boussinesq近似下的一个非静力海洋模型中，笛卡尔坐标系下的不可压缩Navier–Stokes方程通过运动学约束$\\nabla\\cdot\\boldsymbol{u}=0$来保证体积守恒，其中$\\boldsymbol{u}=(u,v,w)$是速度场。考虑一个间距为$\\Delta x$、$\\Delta y$、$\\Delta z$的均匀直线网格和周期性侧边界。标量（例如，压力、浮力）可以存储在网格中心或其他交错位置；速度分量可以存储在网格中心或面中心。必须构建一种与质量和动量守恒的积分形式相一致的有限体积离散化方案。从控制体积中的质量守恒积分表述和通量形式控制体积中的动量守恒积分表述出发，论证如何组合一种交错网格选择以及相应的离散散度和梯度算子，以便在离散层面上对非静力模型施加不可压缩约束。\n\n哪个选项最准确且自洽地描述了：\n(i) 在Arakawa C-网格（标量位于网格中心，速度分量位于面中心）上对非静力动量方程的有限体积离散化，\n以及\n(ii) 面中心速度和网格中心压力在时间步进中保证$\\nabla\\cdot\\boldsymbol{u}=0$的机制？\n\n选择唯一的最佳选项。\n\nA. 速度分量$u, v, w$分别存储在垂直于$x, y, z$轴的面的中心；压力存储在网格中心。每个动量方程都在围绕相应面的对偶控制体积上进行积分。例如，在$x$-动量方程中，压力梯度在$x$-面$(i+\\tfrac{1}{2},j,k)$处被离散为中心差分$\\left(p_{i+1,j,k}-p_{i,j,k}\\right)/\\Delta x$。网格中心的离散散度由带符号的面法向质量通量的净和除以网格体积形成，例如，在$(i,j,k)$处为$\\left(u_{i+\\tfrac{1}{2},j,k}-u_{i-\\tfrac{1}{2},j,k}\\right)/\\Delta x+\\left(v_{i,j+\\tfrac{1}{2},k}-v_{i,j-\\tfrac{1}{2},k}\\right)/\\Delta y+\\left(w_{i,j,k+\\tfrac{1}{2}}-w_{i,j,k-\\tfrac{1}{2}}\\right)/\\Delta z$。时间步进通过所有非压力项推进一个临时的面速度$\\boldsymbol{u}^{\\ast}$，然后通过离散压力梯度进行校正来施加不可压缩性：$\\boldsymbol{u}^{n+1}=\\boldsymbol{u}^{\\ast}-(\\Delta t/\\rho_{0})\\,\\nabla_{h}p^{n+1}$，其中$\\nabla_{h}p^{n+1}$是通过网格中心$p^{n+1}$的中心差分在面上计算的。压力是通过求解一个标量椭圆问题得到的，该问题由对校正后的速度取离散散度并施加$\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$来隐含定义，边界条件为周期性或齐次Neumann边界条件，这在相差一个任意常数的意义下确定了$p$。\n\nB. 速度分量和压力都存储在网格中心。网格中心的散度由网格中心速度的单边差分构成，每个动量方程中的压力梯度也是网格中心压力的单边差分。为施加不可压缩性，通过将网格中心的中心拉普拉斯算子应用于压力来形成一个压力Poisson方程，然后将得到的压力梯度从网格中心速度中减去。这种同位网格布置在任何网格上都能在没有额外处理的情况下将$\\nabla\\cdot\\boldsymbol{u}=0$保证到机器精度。\n\nC. 速度分量$u, v, w$存储在面中心，但压力也存储在面中心，与相应的法向速度分量位于同一位置。离散散度是在网格中心使用同样的面法向速度计算的。例如，在$x$-动量方程中，面$(i+\\tfrac{1}{2},j,k)$处的压力梯度是通过首先将两个相邻的沿$x$方向的面中心压力平均到该面上，然后对交叉项沿$y$和$z$方向取中心差分来计算的。不可压缩约束是通过调整面中心压力以使每个网格周围的压力梯度之和为零来施加的，从而避免了求解全局椭圆问题的需要。\n\nD. 速度分量存储在面中心，压力存储在网格中心，但散度约束不是通过压力校正来施加的；相反，非线性平流项被写成反对称形式以使动能守恒，如果$\\nabla\\cdot\\boldsymbol{u}=0$初始成立，这就足以维持该条件。压力仅通过垂直方向的静力平衡进入方程，因此垂直动量方程不包含垂直压力梯度项。\n\nE. 速度分量存储在边上（面相交的线段），压力存储在网格角点（顶点）上。每个网格中的散度是使用Stokes定理根据围绕网格边的环流量计算的，压力梯度是通过双线性插值从角点值取到边上的。一个局部代数约束强制每个时间步中每个网格周围的边法向速度之和为零，这消除了求解压力方程的需要，并确保了每个网格的精确体积守恒，而与边界条件无关。",
            "solution": "题目提出了一个关于非静力海洋模型数值实现的问题，特别关注在Arakawa C-网格上使用有限体积法施加不可压缩约束$\\nabla\\cdot\\boldsymbol{u}=0$。任务是找出对这一标准数值方法最准确的描述。\n\n### 序言：交错网格上投影法的理论基础\n\nBoussinesq近似下的不可压缩Navier-Stokes方程控制着流体的运动。动量方程可以写成通量形式：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\nabla \\cdot (\\boldsymbol{u} \\otimes \\boldsymbol{u}) = -\\frac{1}{\\rho_0} \\nabla p' + \\boldsymbol{G}\n$$\n其中$\\boldsymbol{u}$是速度矢量，$\\rho_0$是常数参考密度，$p'$是压力的非静力部分，$\\boldsymbol{G}$代表所有其他单位质量的力（例如，科里奥利力、浮力、分子粘性）。该方程组由不可压缩性的运动学约束封闭：\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0\n$$\n在数值时间步进方案中，压力场$p'$充当拉格朗日乘子，在每个时间步强制执行此约束。一种常见且稳健的方法是投影法，特别是当与像Arakawa C-网格这样的交错网格布置配对使用时。\n\n**Arakawa C-网格交错布置：**\n题目指定了Arakawa C-网格。在一个以$(i,j,k)$为网格中心索引的3D笛卡尔坐标系中，变量的位置如下：\n- 标量变量，如压力$p$和浮力$b$，位于网格中心：$p_{i,j,k}$。\n- $x$-速度分量$u$位于垂直于$x$轴的网格面的中心：$u_{i+1/2, j, k}$。\n- $y$-速度分量$v$位于垂直于$y$轴的网格面的中心：$v_{i, j+1/2, k}$。\n- $z$-速度分量$w$位于垂直于$z$轴的网格面的中心：$w_{i, j, k+1/2}$。\n\n**C-网格上的离散算子：**\n这种交错布置是专门设计的，以便能够对散度和梯度算子进行紧凑且稳定的有限差分近似。\n1.  **离散散度 ($\\nabla_d \\cdot$):** 散度很自然地在标量位置（网格中心）进行计算。对以$(i,j,k)$为中心的控制体积$\\mathcal{V}_{i,j,k} = \\Delta x \\Delta y \\Delta z$应用Gauss散度定理，散度是单位体积的净通量：\n    $$\n    (\\nabla_d \\cdot \\boldsymbol{u})_{i,j,k} = \\frac{u_{i+1/2,j,k} - u_{i-1/2,j,k}}{\\Delta x} + \\frac{v_{i,j+1/2,k} - v_{i,j-1/2,k}}{\\Delta y} + \\frac{w_{i,j,k+1/2} - w_{i,j,k-1/2}}{\\Delta z}\n    $$\n    离散不可压缩约束为对所有网格$(\\nabla_d \\cdot \\boldsymbol{u})_{i,j,k} = 0$。\n\n2.  **离散梯度 ($\\nabla_d$):** 动量方程中需要压力梯度项，而动量方程是在速度分量位置进行计算的。对于在$u$位置$(i+1/2,j,k)$计算的$x$-动量方程，压力梯度的$x$-分量很自然地用相邻网格中心压力的中心差分来近似：\n    $$\n    (\\nabla_d p)_{x, i+1/2,j,k} = \\frac{p_{i+1,j,k} - p_{i,j,k}}{\\Delta x}\n    $$\n    其他分量在其各自位置也有类似的表达式。这种构造确保了离散梯度和散度算子是伴随的（具体来说，$\\nabla_d \\cdot = - (\\nabla_d)^T$），这可以防止困扰同位网格的虚假压力模态（棋盘格模态）的增长。\n\n**投影法时间步进：**\n为将解从时间$t^n$推进到$t^{n+1}$：\n1.  **预测步：** 通过使用除新时间步$p^{n+1}$的压力梯度之外的所有项来推进动量方程，从而计算出一个临时的速度场$\\boldsymbol{u}^*$。令$RHS^n$代表在时间$t^n$时所有非压力项的离散化形式。\n    $$\n    \\frac{\\boldsymbol{u}^* - \\boldsymbol{u}^n}{\\Delta t} = RHS^n\n    $$\n    这个临时速度场$\\boldsymbol{u}^*$通常不满足不可压缩约束，即$\\nabla_d \\cdot \\boldsymbol{u}^* \\neq 0$。\n\n2.  **校正步：** 对速度场进行校正以施加不可压缩性。完整的时间离散动量方程为：\n    $$\n    \\frac{\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^n}{\\Delta t} = RHS^n - \\frac{1}{\\rho_0} \\nabla_d p^{n+1}\n    $$\n    代入$\\boldsymbol{u}^*$的表达式，我们得到校正公式：\n    $$\n    \\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho_0} \\nabla_d p^{n+1}\n    $$\n    为了找到使新速度场无散度的压力$p^{n+1}$，我们对校正方程取离散散度并施加约束$\\nabla_d \\cdot \\boldsymbol{u}^{n+1} = 0$：\n    $$\n    \\nabla_d \\cdot \\boldsymbol{u}^{n+1} = \\nabla_d \\cdot \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho_0} \\nabla_d \\cdot (\\nabla_d p^{n+1}) = 0\n    $$\n    这产生了一个离散的压力Poisson方程：\n    $$\n    \\nabla_d^2 p^{n+1} = \\frac{\\rho_0}{\\Delta t} (\\nabla_d \\cdot \\boldsymbol{u}^*)\n    $$\n    其中$\\nabla_d^2 p \\equiv \\nabla_d \\cdot (\\nabla_d p)$是离散拉普拉斯算子。求解这个椭圆偏微分方程以得到$p^{n+1}$（在适当的边界条件下，通常是周期性或齐次Neumann条件），就提供了将临时速度场$\\boldsymbol{u}^*$投影到无散度矢量场空间上所需的压力场，从而得到$\\boldsymbol{u}^{n+1}$。\n\n### 选项分析\n\n**A. 速度分量 $u$, $v$, $w$ 分别存储在垂直于 $x$, $y$, $z$ 轴的面的中心；压力存储在网格中心。每个动量方程都在围绕相应面的对偶控制体积上进行积分。例如，在$x$-动量方程中，压力梯度在$x$-面 $(i+\\tfrac{1}{2},j,k)$处被离散为中心差分$\\left(p_{i+1,j,k}-p_{i,j,k}\\right)/\\Delta x$。网格中心的离散散度由带符号的面法向质量通量的净和除以网格体积形成，例如，在$(i,j,k)$处为$\\left(u_{i+\\tfrac{1}{2},j,k}-u_{i-\\tfrac{1}{2},j,k}\\right)/\\Delta x+\\left(v_{i,j+\\tfrac{1}{2},k}-v_{i,j-\\tfrac{1}{2},k}\\right)/\\Delta y+\\left(w_{i,j,k+\\tfrac{1}{2}}-w_{i,j,k-\\tfrac{1}{2}}\\right)/\\Delta z$。时间步进通过所有非压力项推进一个临时的面速度$\\boldsymbol{u}^{\\ast}$，然后通过离散压力梯度进行校正来施加不可压缩性：$\\boldsymbol{u}^{n+1}=\\boldsymbol{u}^{\\ast}-(\\Delta t/\\rho_{0})\\,\\nabla_{h}p^{n+1}$，其中$\\nabla_{h}p^{n+1}$是通过网格中心$p^{n+1}$的中心差分在面上计算的。压力是通过求解一个标量椭圆问题得到的，该问题由对校正后的速度取离散散度并施加$\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$来隐含定义，边界条件为周期性或齐次Neumann边界条件，这在相差一个任意常数的意义下确定了$p$。**\n该选项提供了对标准方法的完整而准确的描述。\n- 对Arakawa C-网格的描述是正确的。\n- 对离散压力梯度的描述是正确的。\n- 对离散散度的描述是正确的。\n- 对时间步进的压力校正（投影）方法的描述是正确的，包括$\\boldsymbol{u}^*$的预测和对$\\boldsymbol{u}^{n+1}$的校正。\n- 对由此产生的压力Poisson方程及其性质的描述是正确的。\n$\\nabla_h$的使用是一个微小的记号瑕疵，因为其意指的是完整的三维梯度$\\nabla_d$，但附带的文本完美地阐明了其含义。\n**结论：正确**\n\n**B. 速度分量和压力都存储在网格中心。网格中心的散度由网格中心速度的单边差分构成，每个动量方程中的压力梯度也是网格中心压力的单边差分。这种同位网格布置在任何网格上都能在没有额外处理的情况下将$\\nabla\\cdot\\boldsymbol{u}=0$保证到机器精度。**\n此选项描述的是一种同位网格（Arakawa A-网格），这与问题指定的Arakawa C-网格相矛盾。此外，众所周知，同位网格上的简单离散化会遭受压力-速度解耦（棋盘格模态）的影响，并且需要特殊的插值方法（例如，Rhie-Chow）才能正常工作。声称它“无需额外处理”即可工作是错误的。\n**结论：错误**\n\n**C. 速度分量 $u$, $v$, $w$ 存储在面中心，但压力也存储在面中心，与相应的法向速度分量位于同一位置。离散散度是在网格中心使用同样的面法向速度计算的。例如，在$x$-动量方程中，面$(i+\\tfrac{1}{2},j,k)$处的压力梯度是通过首先将两个相邻的沿$x$方向的面中心压力平均到该面上，然后对交叉项沿$y$和$z$方向取中心差分来计算的。不可压缩约束是通过调整面中心压力以使每个网格周围的压力梯度之和为零来施加的，从而避免了求解全局椭圆问题的需要。**\n此选项描述的是一种非标准的、不是Arakawa C-网格的网格。声称可以在不求解全局椭圆问题的情况下施加不可压缩性，对于这类方法来说是根本错误的；压力本质上是非局域的，其计算需要求解一个耦合整个区域的椭圆型方程。\n**结论：错误**\n\n**D. 速度分量存储在面中心，压力存储在网格中心，但散度约束不是通过压力校正来施加的；相反，非线性平流项被写成反对称形式以使动能守恒，如果$\\nabla\\cdot\\boldsymbol{u}=0$初始成立，这就足以维持该条件。压力仅通过垂直方向的静力平衡进入方程，因此垂直动量方程不包含垂直压力梯度项。**\n此选项正确地识别了C-网格的布局，但随后犯了两个基本错误。首先，它将动能守恒与质量守恒（不可压缩性）相混淆。一个能量守恒的平流方案并不能保证$\\nabla \\cdot \\boldsymbol{u} = 0$。其次，它声称模型是静力的，这直接与问题的前提——一个*非静力*模型——相矛盾。在非静力模型中，压力梯度出现在所有三个动量方程中。\n**结论：错误**\n\n**E. 速度分量存储在边上（面相交的线段），压力存储在网格角点（顶点）上。每个网格中的散度是使用Stokes定理根据围绕网格边的环流量计算的，压力梯度是通过双线性插值从角点值取到边上的。一个局部代数约束强制每个时间步中每个网格周围的边法向速度之和为零，这消除了求解压力方程的需要，并确保了每个网格的精确体积守恒，而与边界条件无关。**\n此选项描述了另一种不同于指定的Arakawa C-网格的网格结构。更严重的是，它将散度与环流量混淆，并错误地应用了Stokes定理，该定理关联的是旋度与环流量，而不是散度与通量。与选项C一样，它错误地声称可以通过局部约束来避免压力方程。\n**结论：错误**\n\n基于严谨的分析，选项A是唯一一个对问题中指定的数值方法提供了科学上合理、准确且自洽描述的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}