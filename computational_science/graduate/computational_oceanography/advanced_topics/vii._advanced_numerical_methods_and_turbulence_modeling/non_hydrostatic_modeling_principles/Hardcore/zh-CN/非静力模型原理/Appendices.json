{
    "hands_on_practices": [
        {
            "introduction": "在决定何时必须使用非静力模型时，首要任务是理解非静力压力（$p_{nh}$）的量级。此练习旨在通过标度分析这一流体动力学中的强大工具，建立对非静力效应的物理直觉。通过从基本方程出发，您将推导出$p_{nh}$与关键流动参数之间的关系，从而揭示静力近似在何种条件下失效。",
            "id": "3802855",
            "problem": "考虑一个在Boussinesq近似下描述的三维不可压缩海洋流，其常数参考密度为 $\\rho_{0}$，重力加速度为 $g$，特征水平速度尺度为 $U$，水平长度尺度为 $L$，垂直深度尺度为 $H$。设总压力为 $p$，并通过 $\\partial p_{h}/\\partial z=-\\rho_{0} g$ 定义静水平衡基态压力 $p_{h}$，非静水压力分量由 $p_{nh}=p-p_{h}$ 给出。假设流体在特征平流时间尺度 $T\\sim L/U$ 上演变。仅使用不可压缩Boussinesq动量和连续性方程的第一性原理尺度分析，推导一个关于 $p_{nh}$ 前导阶尺度的单一紧凑解析表达式，该表达式用 $\\rho_{0}$、$U$、$g$、$H$ 和 $L$ 表示。你的推导必须从垂直动量和连续性方程开始，从不可压缩性估计垂直速度尺度，并通过物质导数来量化垂直加速度尺度。以一种能同时揭示以下两种情况的形式表达你的最终结果：\n- 当流动在空间中快速变化时（水平和垂直尺度相当），$p_{nh}$ 如何与 $\\rho_{0} U^{2}$ 成比例。\n- 当流动缓慢变化且在前导阶上是静水力学的时，$p_{nh}$ 如何相对于 $\\rho_{0} g H$ 缩放。\n\n你可以引入纵横比 $\\delta=H/L$ 和弗劳德数 $\\mathrm{Fr}=U/\\sqrt{g H}$ 来紧凑地表达答案，但你的最终表达式必须完全用 $\\rho_{0}$、$U$、$g$、$H$ 和 $L$ 表示，或者等效地，用 $\\rho_{0}$、$g$、$H$、$L$ 和 $\\mathrm{Fr}$ 表示。提供 $p_{nh}$ 前导阶大小的最终解析表达式。不需要进行数值计算。",
            "solution": "推导的起点是在Boussinesq近似下不可压缩流体的动量方程垂直分量和连续性方程。总压力 $p$ 分解为一个静水平衡基态分量 $p_h$ 和一个非静水压力分量 $p_{nh}$，使得 $p = p_h + p_{nh}$。静水压力由平衡关系 $\\frac{\\partial p_h}{\\partial z} = -\\rho_0 g$ 定义，其中 $\\rho_0$ 是常数参考密度， $g$ 是重力加速度。\n\n垂直动量方程由下式给出：\n$$ \\rho_0 \\frac{Dw}{Dt} = -\\frac{\\partial p}{\\partial z} - \\rho g $$\n在Boussinesq近似下，密度的变化仅在浮力项中考虑。然而，问题陈述通过定义 $\\frac{\\partial p_h}{\\partial z} = -\\rho_0 g$ 来关注压力分解，这意味着我们正在分析以下形式的动量方程：\n$$ \\frac{Dw}{Dt} = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial z} - g $$\n将 $p = p_h + p_{nh}$ 代入此方程得到：\n$$ \\frac{Dw}{Dt} = -\\frac{1}{\\rho_0} \\frac{\\partial (p_h + p_{nh})}{\\partial z} - g = -\\frac{1}{\\rho_0} \\frac{\\partial p_h}{\\partial z} - \\frac{1}{\\rho_0} \\frac{\\partial p_{nh}}{\\partial z} - g $$\n使用所提供的静水平衡基态定义 $\\frac{\\partial p_h}{\\partial z} = -\\rho_0 g$：\n$$ \\frac{Dw}{Dt} = -\\frac{1}{\\rho_0} (-\\rho_0 g) - \\frac{1}{\\rho_0} \\frac{\\partial p_{nh}}{\\partial z} - g = g - \\frac{1}{\\rho_0} \\frac{\\partial p_{nh}}{\\partial z} - g $$\n这简化为垂直加速度和非静水压力梯度之间的基本关系：\n$$ \\rho_0 \\frac{Dw}{Dt} = - \\frac{\\partial p_{nh}}{\\partial z} $$\n我们现在将对这个方程和连续性方程进行尺度分析，以确定非静水压力的特征尺度，我们将其记为 $P_{nh}$。系统的特征尺度已给出：\n-   水平长度尺度：$[x, y] \\sim L$\n-   垂直长度尺度：$[z] \\sim H$\n-   水平速度尺度：$[u, v] \\sim U$\n-   平流时间尺度：$[t] \\sim T \\sim L/U$\n-   垂直速度尺度：$[w] \\sim W$\n-   非静水压力尺度：$[p_{nh}] \\sim P_{nh}$\n\n首先，我们从不可压缩连续性方程确定垂直速度的尺度 $W$：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\n平衡各项的尺度，我们得到：\n$$ \\frac{U}{L} + \\frac{U}{L} \\sim \\frac{W}{H} $$\n这得出了垂直速度的尺度：\n$$ W \\sim U \\frac{H}{L} $$\n接下来，我们确定垂直加速度的尺度，$\\frac{Dw}{Dt}$。物质导数定义为：\n$$ \\frac{Dw}{Dt} = \\frac{\\partial w}{\\partial t} + u \\frac{\\partial w}{\\partial x} + v \\frac{\\partial w}{\\partial y} + w \\frac{\\partial w}{\\partial z} $$\n我们分析每一项的尺度：\n-   $[\\frac{\\partial w}{\\partial t}] \\sim \\frac{W}{T} = \\frac{U(H/L)}{L/U} = \\frac{U^2 H}{L^2}$\n-   $[u \\frac{\\partial w}{\\partial x}] \\sim U \\frac{W}{L} = U \\frac{U(H/L)}{L} = \\frac{U^2 H}{L^2}$\n-   $[v \\frac{\\partial w}{\\partial y}] \\sim U \\frac{W}{L} = U \\frac{U(H/L)}{L} = \\frac{U^2 H}{L^2}$\n-   $[w \\frac{\\partial w}{\\partial z}] \\sim W \\frac{W}{H} = \\left(U \\frac{H}{L}\\right) \\frac{U(H/L)}{H} = \\frac{U^2 H}{L^2}$\n所有项都具有相同的数量级，因此垂直加速度的尺度是：\n$$ \\left[\\frac{Dw}{Dt}\\right] \\sim \\frac{U^2 H}{L^2} $$\n现在我们可以对非静水压力的垂直动量方程进行尺度分析：\n$$ \\left[\\rho_0 \\frac{Dw}{Dt}\\right] \\sim \\left[- \\frac{\\partial p_{nh}}{\\partial z}\\right] $$\n$$ \\rho_0 \\left(\\frac{U^2 H}{L^2}\\right) \\sim \\frac{P_{nh}}{H} $$\n求解非静水压力的尺度 $P_{nh}$：\n$$ P_{nh} \\sim \\rho_0 U^2 \\left(\\frac{H}{L}\\right)^2 $$\n这个表达式给出了非静水压力在前导阶上的尺度，用基本参数 $\\rho_0$、$U$、$H$ 和 $L$ 表示。问题进一步要求答案以一种能够揭示两种特定尺度行为的形式呈现。为实现这一点，我们引入纵横比 $\\delta = H/L$ 和弗劳德数 $\\mathrm{Fr} = U/\\sqrt{gH}$，并重写表达式。将 $U = \\mathrm{Fr}\\sqrt{gH}$ 代入我们关于 $P_{nh}$ 的结果中：\n$$ P_{nh} \\sim \\rho_0 (\\mathrm{Fr}\\sqrt{gH})^2 \\left(\\frac{H}{L}\\right)^2 = \\rho_0 (\\mathrm{Fr}^2 g H) \\left(\\frac{H}{L}\\right)^2 $$\n重新整理后得到：\n$$ P_{nh} \\sim \\rho_0 g H \\cdot \\mathrm{Fr}^2 \\left(\\frac{H}{L}\\right)^2 $$\n这种形式满足了问题的要求。它用允许的变量集 $\\{\\rho_0, g, H, L, \\mathrm{Fr}\\}$ 表示，并同时揭示了所要求的尺度关系：\n1.  对于快速变化的流动，水平和垂直长度尺度相当，$L \\sim H$。在这种情况下，$(H/L)^2 \\sim 1$，表达式变为 $P_{nh} \\sim \\rho_0 g H \\cdot \\mathrm{Fr}^2 = \\rho_0 g H \\frac{U^2}{gH} = \\rho_0 U^2$。这表明 $p_{nh}$ 与动压力尺度 $\\rho_0 U^2$ 成比例。\n2.  对于缓慢变化的流动，此时静水近似有效，$H \\ll L$。该表达式已经被静水压力尺度 $P_h \\sim \\rho_0 g H$ 分解出来。它表明非静水压力尺度是静水压力尺度的一个分数，该分数由无量纲乘积 $\\mathrm{Fr}^2 (H/L)^2$ 给出。对于缓慢变化的流动，$(H/L)^2$ 很小，表明与前导阶的静水平衡相比，$p_{nh}$ 很小。\n\n因此，这个表达式就是所要求的单一紧凑解析形式。",
            "answer": "$$ \\boxed{\\rho_{0} g H \\mathrm{Fr}^{2} \\left(\\frac{H}{L}\\right)^{2}} $$"
        },
        {
            "introduction": "在建立了非静力压力的理论基础之后，下一个关键步骤是将其应用于具体的物理现象，以量化其影响。内波是海洋和大气中普遍存在的波动，也是检验非静力效应重要性的经典案例。本练习将引导您推导并比较静力与非静力内波的色散关系，并针对一个真实的海洋场景计算由静力近似引起的相速度误差，从而将抽象的理论概念转化为具体的数值。",
            "id": "3802883",
            "problem": "在一个满足Boussinesq近似的均匀分层、无粘性、不可压缩的海洋中，考虑由线性化的动量、浮力和连续性方程控制的小振幅内波。假设浮力频率 $N$ 为常数，底部位于 $z=-H$ 处为平坦海底，表面位于 $z=0$ 处为刚盖表面，且在两个边界上均满足无垂向流动的边界条件。忽略行星旋转和自由表面效应。考虑在一个深度 $H=4000\\ \\mathrm{m}$、层结 $N=5\\times 10^{-3}\\ \\mathrm{s}^{-1}$ 的海洋中，一个水平传播的模态1内潮，其水平波长为 $\\lambda=100\\ \\mathrm{km}$。\n\n从线性化方程和平面波拟设（其中水平波数为 $k=2\\pi/\\lambda$，垂直结构由边界条件确定）出发，推导：\n- 内重力波的非静力色散关系，并由此推导出模态1对应的相速度 $c_{p,\\mathrm{nh}}$；\n- 色散关系的静力近似及其对应的模态1相速度 $c_{p,\\mathrm{h}}$。\n\n利用这些结果，定义由静力近似引入的相速度分数误差为\n$$\n\\epsilon \\equiv \\frac{c_{p,\\mathrm{h}}-c_{p,\\mathrm{nh}}}{c_{p,\\mathrm{nh}}}.\n$$\n计算给定参数下的 $\\epsilon$。将最终答案表示为无量纲小数，并四舍五入到四位有效数字。最终答案中不要包含任何单位。",
            "solution": "对于二维（$x, z$）、无粘性、不可压缩、无旋转的Boussinesq流体，其线性化的控制方程组为：\n动量方程（水平）：\n$$ \\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x} $$\n动量方程（垂直）：\n$$ \\frac{\\partial w}{\\partial t} = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial z} - b $$\n浮力方程：\n$$ \\frac{\\partial b}{\\partial t} + N^2 w = 0 $$\n连续性方程：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} = 0 $$\n此处，$u$ 和 $w$ 分别是水平和垂直速度分量，$p'$ 是相对于静力平衡的压力扰动，$b = -g\\rho'/\\rho_0$ 是浮力扰动，$\\rho_0$ 是参考密度，$N$ 是常数浮力频率。\n\n我们寻找形式为 $f(x, z, t) = \\hat{f}(z) \\exp(i(kx - \\omega t))$ 的平面波解，其中 $k$ 是水平波数，$\\omega$ 是角频率。将此拟设代入控制方程，得到一组关于垂直结构函数的常微分方程：\n$$ -i\\omega \\hat{u} = -\\frac{1}{\\rho_0} ik \\hat{p} \\quad \\implies \\quad \\hat{u} = \\frac{k}{\\omega \\rho_0} \\hat{p} $$\n$$ -i\\omega \\hat{w} = -\\frac{1}{\\rho_0} \\frac{d\\hat{p}}{dz} - \\hat{b} $$\n$$ -i\\omega \\hat{b} + N^2 \\hat{w} = 0 \\quad \\implies \\quad \\hat{b} = \\frac{iN^2}{\\omega} \\hat{w} $$\n$$ ik\\hat{u} + \\frac{d\\hat{w}}{dz} = 0 \\quad \\implies \\quad \\hat{u} = \\frac{i}{k} \\frac{d\\hat{w}}{dz} $$\n\n通过组合 $\\hat{u}$ 的两个表达式，我们可以将 $\\hat{p}$ 与 $\\hat{w}$ 联系起来：\n$$ \\frac{k}{\\omega \\rho_0} \\hat{p} = \\frac{i}{k} \\frac{d\\hat{w}}{dz} \\quad \\implies \\quad \\hat{p} = \\frac{i\\omega\\rho_0}{k^2} \\frac{d\\hat{w}}{dz} $$\n现在，将 $\\hat{b}$ 和 $\\hat{p}$ 的表达式代入垂直动量方程：\n$$ -i\\omega \\hat{w} = -\\frac{1}{\\rho_0} \\frac{d}{dz}\\left( \\frac{i\\omega\\rho_0}{k^2} \\frac{d\\hat{w}}{dz} \\right) - \\frac{iN^2}{\\omega} \\hat{w} $$\n$$ -i\\omega \\hat{w} = -\\frac{i\\omega}{k^2} \\frac{d^2\\hat{w}}{dz^2} - \\frac{iN^2}{\\omega} \\hat{w} $$\n所有项同除以 $-i\\omega$ 得到：\n$$ \\hat{w} = \\frac{1}{k^2} \\frac{d^2\\hat{w}}{dz^2} + \\frac{N^2}{\\omega^2} \\hat{w} $$\n整理后得到垂直结构方程，也称为无平均剪切流体中的泰勒-戈德斯坦方程：\n$$ \\frac{d^2\\hat{w}}{dz^2} + k^2 \\left( \\frac{N^2}{\\omega^2} - 1 \\right) \\hat{w} = 0 $$\n令垂直波数为 $m$，其中 $m^2 = k^2(N^2/\\omega^2 - 1)$。该方程为 $\\frac{d^2\\hat{w}}{dz^2} + m^2 \\hat{w} = 0$。通解为 $\\hat{w}(z) = A \\sin(mz) + B \\cos(mz)$。\n\n边界条件为在表面（$z=0$）和底部（$z=-H$）无垂向流动：\n1.  $\\hat{w}(0) = 0 \\implies A \\sin(0) + B \\cos(0) = 0 \\implies B=0$。\n2.  $\\hat{w}(-H) = 0 \\implies A \\sin(-mH) = 0$。\n为了得到非平凡解（$A \\neq 0$），我们必须有 $\\sin(-mH) = -\\sin(mH) = 0$。这要求 $mH = n\\pi$ 对于整数 $n=1, 2, 3, \\ldots$。整数 $n$ 是垂直模态数。\n因此，垂直波数是量子化的：$m_n = \\frac{n\\pi}{H}$。\n\n**非静力色散关系和相速度**\n将 $m_n$ 代入 $m^2$ 的定义式中：\n$$ \\left(\\frac{n\\pi}{H}\\right)^2 = k^2 \\left( \\frac{N^2}{\\omega^2} - 1 \\right) $$\n求解 $\\omega^2$ 得到非静力色散关系：\n$$ \\frac{N^2}{\\omega^2} = 1 + \\frac{1}{k^2}\\left(\\frac{n\\pi}{H}\\right)^2 \\implies \\omega^2 = \\frac{N^2 k^2}{k^2 + (n\\pi/H)^2} $$\n水平相速度为 $c_p = \\omega/k$。因此，非静力相速度 $c_{p,\\mathrm{nh}}$ 由下式给出：\n$$ c_{p,\\mathrm{nh}}^2 = \\frac{\\omega^2}{k^2} = \\frac{N^2}{k^2 + (n\\pi/H)^2} \\implies c_{p,\\mathrm{nh}} = \\frac{N}{\\sqrt{k^2 + (n\\pi/H)^2}} $$\n对于指定的模态1（$n=1$）：\n$$ c_{p,\\mathrm{nh}} = \\frac{N}{\\sqrt{k^2 + (\\pi/H)^2}} $$\n\n**静力近似**\n静力近似假设垂直加速度与压力梯度和浮力相比可以忽略不计。在垂直动量方程中，这意味着忽略 $\\partial w/\\partial t$ 项，这对于 $\\omega^2 \\ll N^2$ 的低频波是有效的。在数学上，这对应于在垂直结构方程中忽略相对于 $N^2/\\omega^2$ 项的‘1’：\n$$ \\frac{d^2\\hat{w}}{dz^2} + k^2 \\frac{N^2}{\\omega^2} \\hat{w} = 0 $$\n在此近似下，垂直波数为 $m_{h,n}^2 = k^2 N^2 / \\omega^2$。边界条件保持不变，因此我们仍然必须满足 $m_{h,n} = n\\pi/H$。\n$$ \\left(\\frac{n\\pi}{H}\\right)^2 = \\frac{k^2 N^2}{\\omega^2} $$\n这给出了静力色散关系：\n$$ \\omega^2 = \\frac{k^2 N^2 H^2}{(n\\pi)^2} \\implies \\omega = \\frac{kNH}{n\\pi} $$\n相应的静力相速度 $c_{p,\\mathrm{h}}$ 为：\n$$ c_{p,\\mathrm{h}} = \\frac{\\omega}{k} = \\frac{NH}{n\\pi} $$\n对于模态1（$n=1$）：\n$$ c_{p,\\mathrm{h}} = \\frac{NH}{\\pi} $$\n\n**相速度分数误差**\n分数误差 $\\epsilon$ 定义为 $\\epsilon = (c_{p,\\mathrm{h}} - c_{p,\\mathrm{nh}}) / c_{p,\\mathrm{nh}} = c_{p,\\mathrm{h}}/c_{p,\\mathrm{nh}} - 1$。\n让我们计算模态1的比率：\n$$ \\frac{c_{p,\\mathrm{h}}}{c_{p,\\mathrm{nh}}} = \\frac{NH/\\pi}{N/\\sqrt{k^2 + (\\pi/H)^2}} = \\frac{H}{\\pi} \\sqrt{k^2 + \\left(\\frac{\\pi}{H}\\right)^2} $$\n将 $H/\\pi$ 项移入平方根内：\n$$ \\frac{c_{p,\\mathrm{h}}}{c_{p,\\mathrm{nh}}} = \\sqrt{\\left(\\frac{H}{\\pi}\\right)^2 \\left(k^2 + \\left(\\frac{\\pi}{H}\\right)^2\\right)} = \\sqrt{\\frac{H^2 k^2}{\\pi^2} + 1} = \\sqrt{1 + \\left(\\frac{kH}{\\pi}\\right)^2} $$\n因此，分数误差为：\n$$ \\epsilon = \\sqrt{1 + \\left(\\frac{kH}{\\pi}\\right)^2} - 1 $$\n这个表达式表明，误差取决于无量纲参数 $kH/\\pi$，它表示海洋深度与水平波长相关的垂直尺度之比。\n\n**数值计算**\n我们有以下给定值：\n- $H = 4000\\ \\mathrm{m}$\n- $\\lambda = 100\\ \\mathrm{km} = 100 \\times 10^3\\ \\mathrm{m} = 10^5\\ \\mathrm{m}$\n水平波数 $k$ 为：\n$$ k = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi}{10^5}\\ \\mathrm{m}^{-1} $$\n现在，我们计算无量纲参数 $kH/\\pi$：\n$$ \\frac{kH}{\\pi} = \\frac{(2\\pi/10^5) \\times 4000}{\\pi} = \\frac{2 \\times 4000}{10^5} = \\frac{8000}{100000} = 0.08 $$\n最后，我们将这个值代入 $\\epsilon$ 的表达式中：\n$$ \\epsilon = \\sqrt{1 + (0.08)^2} - 1 = \\sqrt{1 + 0.0064} - 1 = \\sqrt{1.0064} - 1 $$\n$$ \\epsilon \\approx 1.003194896 - 1 = 0.003194896 $$\n四舍五入到四位有效数字，我们得到：\n$$ \\epsilon \\approx 0.003195 $$",
            "answer": "$$\\boxed{0.003195}$$"
        },
        {
            "introduction": "最后一个练习将理论与实践联系起来，探讨如何将非静力模型的控制方程转化为计算机可以求解的离散形式。在数值模型中，精确地实施不可压缩性约束（$\\nabla\\cdot\\boldsymbol{u}=0$）是核心挑战之一，而网格的交错设计和压力求解方案对此至关重要。本练习旨在帮助您理解现代海洋模型中广泛采用的Arakawa C-网格和投影法，这些技术是正确处理非静力压力和保证质量守恒的关键。",
            "id": "3802929",
            "problem": "在Boussinesq近似下的非静力海洋模型中，笛卡尔坐标系下的不可压缩Navier–Stokes方程通过运动学约束$\\nabla\\cdot\\boldsymbol{u}=0$来保证体积守恒，其中$\\boldsymbol{u}=(u,v,w)$是速度场。考虑一个间距为$\\Delta x$、$\\Delta y$、$\\Delta z$且具有周期性侧边界的均匀直线网格。标量（例如，压力、浮力）可以存储在网格中心或其他交错位置；速度分量可以存储在网格中心或网格面中心。必须构建一种与质量和动量守恒的积分形式相一致的有限体积离散化方案。从控制体中的质量守恒积分表述和通量形式控制体中的动量守恒积分表述出发，论证如何组合一种交错网格选择以及相应的离散散度和梯度算子，以便在离散层面上对非静力模型强制执行不可压缩约束。\n\n哪个选项最准确且自洽地描述了：\n(i) 在Arakawa C-网格（标量位于网格中心，速度分量位于网格面中心）上对非静力动量方程的有限体积离散化，\n以及\n(ii) 面中心速度和网格中心压力在时间步进中保证$\\nabla\\cdot\\boldsymbol{u}=0$的机制？\n\n选择唯一的最佳选项。\n\nA. 速度分量$u$、$v$、$w$分别存储在垂直于$x$、$y$、$z$轴的面的中心；压力存储在网格中心。每个动量方程都在围绕相应面的对偶控制体上积分。例如，在$x$-动量方程中，压力梯度在$x$-面$(i+\\tfrac{1}{2},j,k)$处被离散为中心差分$\\left(p_{i+1,j,k}-p_{i,j,k}\\right)/\\Delta x$。网格中心的离散散度由带符号的面法向质量通量的净和除以网格体积构成，例如，在$(i,j,k)$处为$\\left(u_{i+\\tfrac{1}{2},j,k}-u_{i-\\tfrac{1}{2},j,k}\\right)/\\Delta x+\\left(v_{i,j+\\tfrac{1}{2},k}-v_{i,j-\\tfrac{1}{2},k}\\right)/\\Delta y+\\left(w_{i,j,k+\\tfrac{1}{2}}-w_{i,j,k-\\tfrac{1}{2}}\\right)/\\Delta z$。时间步进通过所有非压力项推进一个临时的面速度$\\boldsymbol{u}^{\\ast}$，然后通过离散压力梯度进行校正来强制不可压缩性：$\\boldsymbol{u}^{n+1}=\\boldsymbol{u}^{\\ast}-(\\Delta t/\\rho_{0})\\,\\nabla_{h}p^{n+1}$，其中$\\nabla_{h}p^{n+1}$通过网格中心$p^{n+1}$的中心差分在面上求值。压力是通过求解一个标量椭圆问题得到的，该问题通过对校正后的速度取离散散度并施加$\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$来隐含。使用周期性或齐次Neumann边界条件，这使得$p$的解在相差一个任意常数的情况下是确定的。\n\nB. 速度分量和压力都存储在网格中心。网格中心的散度由网格中心速度的单边差分构成，并且每个动量方程中的压力梯度也是网格中心压力的单边差分。这种并置排列在任何网格上都能在无需额外处理的情况下将$\\nabla\\cdot\\boldsymbol{u}=0$强制到机器精度。\n\nC. 速度分量$u$、$v$、$w$存储在面中心，但压力也存储在面中心，与相应的法向速度分量并置。离散散度是根据相同的面法向速度在网格中心计算的。例如，在面$(i+\\tfrac{1}{2},j,k)$处的$x$-动量方程中的压力梯度，是通过先将$x$方向上相邻的两个面中心压力平均到该面，然后对交叉项沿$y$和$z$方向取中心差分来计算的。不可压缩约束是通过调整面中心压力使得每个网格周围的压力梯度之和为零来强制执行的，从而避免了求解全局椭圆问题的需要。\n\nD. 速度分量存储在面中心，压力存储在网格中心，但散度约束不是通过压力校正来强制的；而是将非线性平流项写成反对称形式以守恒动能，如果$\\nabla\\cdot\\boldsymbol{u}=0$初始成立，这就足以维持该条件。压力仅通过垂直方向的静力平衡进入方程，因此垂直动量方程不包含垂直压力梯度项。\n\nE. 速度分量存储在边（面相交的线段）上，压力存储在网格角点（顶点）上。每个网格中的散度是利用斯托克斯定理（Stokes’ theorem）根据网格边上的环量计算的，而压力梯度是通过双线性插值从角点值计算到边上的。一个局部代数约束强制每个网格周围的边法向速度之和在每个时间步都为零，这消除了求解压力方程的需要，并确保了每个网格的精确体积守恒，而与边界条件无关。",
            "solution": "问题陈述提出了一个关于非静力海洋模型数值实现的问题，特别关注在Arakawa C-网格上使用有限体积法强制执行不可压缩约束$\\nabla\\cdot\\boldsymbol{u}=0$。任务是找出对这种标准数值方法的最准确描述。\n\n### 前言：交错网格上投影法的理论基础\n\nBoussinesq近似下的不可压缩Navier-Stokes方程控制着流体的运动。动量方程可以写成通量形式：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\nabla \\cdot (\\boldsymbol{u} \\otimes \\boldsymbol{u}) = -\\frac{1}{\\rho_0} \\nabla p' + \\boldsymbol{G}\n$$\n其中$\\boldsymbol{u}$是速度矢量，$\\rho_0$是常参考密度，$p'$是压力的非静力部分，$\\boldsymbol{G}$代表所有其他单位质量的力（例如，科里奥利力、浮力、分子粘性）。该方程组通过不可压缩性的运动学约束来封闭：\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0\n$$\n在数值时间步进格式中，压力场$p'$充当拉格朗日乘子，在每个时间步强制执行此约束。一种常用且稳健的方法是投影法，特别是当与像Arakawa C-网格这样的交错网格布置配对时。\n\n**Arakawa C-网格交错布置：**\n问题指定了Arakawa C-网格。在一个以$(i,j,k)$为网格中心索引的3D笛卡尔坐标系中，变量位置如下：\n- 标量变量，如压力$p$和浮力$b$，位于网格中心：$p_{i,j,k}$。\n- $x$-速度分量$u$位于垂直于$x$轴的网格面的中心：$u_{i+1/2, j, k}$。\n- $y$-速度分量$v$位于垂直于$y$轴的网格面的中心：$v_{i, j+1/2, k}$。\n- $z$-速度分量$w$位于垂直于$z$轴的网格面的中心：$w_{i, j, k+1/2}$。\n\n**C-网格上的离散算子：**\n这种交错布置是专门为实现散度和梯度算子的紧凑且稳定的有限差分近似而设计的。\n1.  **离散散度($\\nabla_d \\cdot$)：** 散度自然地在标量位置（网格中心）进行计算。对一个以$(i,j,k)$为中心的控制体$\\mathcal{V}_{i,j,k} = \\Delta x \\Delta y \\Delta z$应用高斯散度定理，散度是单位体积的净通量：\n    $$\n    (\\nabla_d \\cdot \\boldsymbol{u})_{i,j,k} = \\frac{u_{i+1/2,j,k} - u_{i-1/2,j,k}}{\\Delta x} + \\frac{v_{i,j+1/2,k} - v_{i,j-1/2,k}}{\\Delta y} + \\frac{w_{i,j,k+1/2} - w_{i,j,k-1/2}}{\\Delta z}\n    $$\n    离散不可压缩约束是$(\\nabla_d \\cdot \\boldsymbol{u})_{i,j,k} = 0$对所有网格成立。\n\n2.  **离散梯度($\\nabla_d$)：** 动量方程中需要压力梯度项，这些方程在速度分量位置进行计算。对于在$u$-位置$(i+1/2,j,k)$计算的$x$-动量方程，压力梯度的$x$-分量自然地通过相邻网格中心压力的中心差分来近似：\n    $$\n    (\\nabla_d p)_{x, i+1/2,j,k} = \\frac{p_{i+1,j,k} - p_{i,j,k}}{\\Delta x}\n    $$\n    其他分量在其各自位置也有类似的表达式。这种构造确保了离散梯度和散度算子是伴随的（具体来说，$\\nabla_d \\cdot = - (\\nabla_d)^T$），这可以防止在并置网格中出现的虚假压力模态（棋盘格现象）的增长。\n\n**投影法时间步进：**\n为了将解从时间$t^n$推进到$t^{n+1}$：\n1.  **预测步骤：** 通过使用新时间步$p^{n+1}$处的压力梯度*以外*的所有项来推进动量方程，计算出一个临时的速度场$\\boldsymbol{u}^*$。令$RHS^n$表示在时间$t^n$所有非压力项的离散化。\n    $$\n    \\frac{\\boldsymbol{u}^* - \\boldsymbol{u}^n}{\\Delta t} = RHS^n\n    $$\n    这个临时速度场$\\boldsymbol{u}^*$通常不满足不可压缩约束，即$\\nabla_d \\cdot \\boldsymbol{u}^* \\neq 0$。\n\n2.  **校正步骤：** 对速度场进行校正以强制不可压缩性。完整的时间离散动量方程是：\n    $$\n    \\frac{\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^n}{\\Delta t} = RHS^n - \\frac{1}{\\rho_0} \\nabla_d p^{n+1}\n    $$\n    代入$\\boldsymbol{u}^*$的表达式，我们得到校正公式：\n    $$\n    \\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho_0} \\nabla_d p^{n+1}\n    $$\n    为了找到使新速度场无散的压力$p^{n+1}$，我们对校正方程取离散散度并施加约束$\\nabla_d \\cdot \\boldsymbol{u}^{n+1} = 0$：\n    $$\n    \\nabla_d \\cdot \\boldsymbol{u}^{n+1} = \\nabla_d \\cdot \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho_0} \\nabla_d \\cdot (\\nabla_d p^{n+1}) = 0\n    $$\n    这产生了一个关于压力的离散泊松方程（Poisson equation）：\n    $$\n    \\nabla_d^2 p^{n+1} = \\frac{\\rho_0}{\\Delta t} (\\nabla_d \\cdot \\boldsymbol{u}^*)\n    $$\n    其中$\\nabla_d^2 p \\equiv \\nabla_d \\cdot (\\nabla_d p)$是离散拉普拉斯算子。求解这个关于$p^{n+1}$的椭圆偏微分方程（在适当的边界条件下，通常是周期性或齐次Neumann条件）提供了所需的压力场，以将临时速度场$\\boldsymbol{u}^*$投影到无散向量场的空间上，从而得到$\\boldsymbol{u}^{n+1}$。\n\n### 选项分析\n\n**A. 速度分量$u$、$v$、$w$分别存储在垂直于$x$、$y$、$z$轴的面的中心；压力存储在网格中心。每个动量方程都在围绕相应面的对偶控制体上积分。例如，在$x$-动量方程中，压力梯度在$x$-面$(i+\\tfrac{1}{2},j,k)$处被离散为中心差分$\\left(p_{i+1,j,k}-p_{i,j,k}\\right)/\\Delta x$。网格中心的离散散度由带符号的面法向质量通量的净和除以网格体积构成，例如，在$(i,j,k)$处为$\\left(u_{i+\\tfrac{1}{2},j,k}-u_{i-\\tfrac{1}{2},j,k}\\right)/\\Delta x+\\left(v_{i,j+\\tfrac{1}{2},k}-v_{i,j-\\tfrac{1}{2},k}\\right)/\\Delta y+\\left(w_{i,j,k+\\tfrac{1}{2}}-w_{i,j,k-\\tfrac{1}{2}}\\right)/\\Delta z$。时间步进通过所有非压力项推进一个临时的面速度$\\boldsymbol{u}^{\\ast}$，然后通过离散压力梯度进行校正来强制不可压缩性：$\\boldsymbol{u}^{n+1}=\\boldsymbol{u}^{\\ast}-(\\Delta t/\\rho_{0})\\,\\nabla_{h}p^{n+1}$，其中$\\nabla_{h}p^{n+1}$通过网格中心$p^{n+1}$的中心差分在面上求值。压力是通过求解一个标量椭圆问题得到的，该问题通过对校正后的速度取离散散度并施加$\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$来隐含。使用周期性或齐次Neumann边界条件，这使得$p$的解在相差一个任意常数的情况下是确定的。**\n此选项提供了对标准方法的完整而准确的描述。\n- 对Arakawa C-网格的描述是正确的。\n- 对离散压力梯度的描述是正确的。\n- 对离散散度的描述是正确的。\n- 对用于时间步进的压力校正（投影）方法的描述是正确的，包括$\\boldsymbol{u}^*$的预测和对$\\boldsymbol{u}^{n+1}$的校正。\n- 对由此产生的压力泊松方程及其性质的描述是正确的。\n使用$\\nabla_h$是一个轻微的符号缺陷，因为这里隐含的是完整的3D梯度$\\nabla_d$，但附带的文字完美地阐明了其含义。\n**结论：正确**\n\n**B. 速度分量和压力都存储在网格中心。网格中心的散度由网格中心速度的单边差分构成，并且每个动量方程中的压力梯度也是网格中心压力的单边差分。这种并置排列在任何网格上都能在无需额外处理的情况下将$\\nabla\\cdot\\boldsymbol{u}=0$强制到机器精度。**\n此选项描述了并置网格（Arakawa A-网格），这与问题指定的Arakawa C-网格相矛盾。此外，众所周知，并置网格上的简单离散化方案会遭受压力-速度解耦（棋盘格模态）的影响，并需要特殊的插值（例如，Rhie-Chow）才能正常工作。其声称“无需额外处理”即可工作是错误的。\n**结论：不正确**\n\n**C. 速度分量$u$、$v$、$w$存储在面中心，但压力也存储在面中心，与相应的法向速度分量并置。离散散度是根据相同的面法向速度在网格中心计算的。压力梯度...是通过先对...进行平均...然后取中心差分...来计算的。不可压缩约束是通过调整面中心压力使得每个网格周围的压力梯度之和为零来强制执行的，从而避免了求解全局椭圆问题的需要。**\n此选项描述了一种非标准的网格，不是Arakawa C-网格。声称可以在不求解全局椭圆问题的情况下强制执行不可压缩性，对于这类方法来说是根本错误的；压力本质上是非局部的，其计算需要求解一个耦合整个区域的椭圆型方程。\n**结论：不正确**\n\n**D. 速度分量存储在面中心，压力存储在网格中心，但散度约束不是通过压力校正来强制的；而是将非线性平流项写成反对称形式以守恒动能，如果$\\nabla\\cdot\\boldsymbol{u}=0$初始成立，这就足以维持该条件。压力仅通过垂直方向的静力平衡进入方程，因此垂直动量方程不包含垂直压力梯度项。**\n此选项正确地指出了C-网格的布局，但随后犯了两个根本性错误。首先，它将动能守恒与质量守恒（不可压缩性）混淆。一个能量守恒的平流格式并不能强制$\\nabla \\cdot \\boldsymbol{u} = 0$。其次，它声称模型是静力的，这直接与问题前提中的*非静力*模型相矛盾。在非静力模型中，压力梯度出现在所有三个动量方程中。\n**结论：不正确**\n\n**E. 速度分量存储在边（面相交的线段）上，压力存储在网格角点（顶点）上。每个网格中的散度是利用斯托克斯定理（Stokes’ theorem）根据网格边上的环量计算的...消除了求解压力方程的需要...**\n此选项描述了另一种不同于指定的Arakawa C-网格的网格结构。更关键的是，它将散度与环量混淆，并错误地应用了斯托克斯定理，该定理关联的是旋度与环量，而不是散度与通量。与选项C一样，它错误地声称可以通过局部约束来避免压力方程。\n**结论：不正确**\n\n基于严谨的分析，选项A是唯一一个对问题中指定的数值方法提供了科学上合理、准确且自洽描述的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}