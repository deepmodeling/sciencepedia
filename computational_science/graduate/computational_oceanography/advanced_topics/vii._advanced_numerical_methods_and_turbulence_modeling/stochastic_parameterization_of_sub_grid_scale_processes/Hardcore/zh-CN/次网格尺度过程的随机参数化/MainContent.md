## 引言
在[数值海洋学](@entry_id:1128986)和气候科学中，精确模拟地球流体的复杂动态是核心挑战。然而，任何数值模型都受限于其网格分辨率，大量关键的物理过程（如[湍流](@entry_id:151300)、涡旋）因其尺度过小而无法被直接解析，这些“[次网格尺度过程](@entry_id:1132602)”必须通过[参数化](@entry_id:265163)来表达其对大尺度运动的集体效应。传统的确定性[参数化](@entry_id:265163)方案，尽管在一定程度上有效，但其固有的纯耗散特性往往导致模型系统性地低估能量和变率，尤其无法再现从小尺度到大尺度的能量回传现象。这种缺陷不仅影响了模型的平均态，也使其无法为预报提供可靠的[不确定性估计](@entry_id:191096)，从而构成了一个亟待解决的知识鸿沟。

为应对这一挑战，本文系统地探讨了[次网格尺度过程](@entry_id:1132602)的随机参数化方法。我们将分三部分展开：首先，在“原理与机制”一章中，我们将深入剖析[闭包问题](@entry_id:160656)的本质，阐明引入随机性的物理和能量学依据，并探讨随机强迫项的关键设计原则。接着，在“应用与跨学科联系”一章中，我们将展示这些理论如何在现代[天气与气候模型](@entry_id:1134013)中具体实现，并揭示其与数据同化、统计物理等领域的深刻联系。最后，通过“动手实践”部分，读者将有机会通过具体的编程练习来巩固所学概念。这次旅程将从问题的根源开始，让我们首先深入理解[随机参数化](@entry_id:1132435)背后的基本原理。

## 原理与机制

本章旨在深入探讨[次网格尺度过程](@entry_id:1132602)[随机参数化](@entry_id:1132435)的基本原理与核心机制。继引言中对该主题的背景介绍之后，我们将从控制方程出发，系统地阐述[闭包问题](@entry_id:160656)的本质，分析次网格过程的能量效应，并在此基础上论证引入随机性的必要性和物理依据。最后，我们将详细剖析[随机参数化](@entry_id:1132435)方案设计的关键要素，包括噪声的数学结构与时间关联特性，为后续章节中具体模型的学习奠定坚实的理论基础。

### 再论[闭包问题](@entry_id:160656)：未解析尺度和次网格[应力张量](@entry_id:148973)

[海洋环流](@entry_id:195237)模型通过求解离散化的流体[动力学方程](@entry_id:751029)来预测海洋状态。无论网格分辨率多高，总存在一些动力学过程的尺度小于网格尺度 $\Delta$，这些过程无法被模型直接解析，统称为**[次网格尺度](@entry_id:1132591)（sub-grid scale, SGS）过程**。这些过程包括小尺度涡旋、锋面不稳定性、[内波](@entry_id:261048)破碎以及混合层[湍流](@entry_id:151300)等。为了在描述大尺度（或称“可解析尺度”）运动的方程中正确地反映这些未解析过程的平均效应，我们必须对其进行[参数化](@entry_id:265163)。问题的根源在于控制方程的[非线性](@entry_id:637147)特性。

考虑一个在 $f$ 平面上的旋转分层Boussinesq海洋，其运动由[原始方程](@entry_id:1130162)描述。我们可以引入一个空间滤波算子 $\mathcal{G}_\Delta$，它代表了在尺度 $\Delta$ 上的网格平均。当我们将此算子应用于速度场 $\mathbf{u}$ 等变量时，我们得到其可解析（或滤波后）分量 $\overline{\mathbf{u}} = \mathcal{G}_\Delta(\mathbf{u})$ 和次网格分量 $\mathbf{u}' = \mathbf{u} - \overline{\mathbf{u}}$。

将滤波算子应用于动量方程，对于线性项，如科里奥利力项 $f \hat{\mathbf{z}} \times \mathbf{u}$，不存在困难，因为滤波算子是线性的，我们有 $\mathcal{G}_\Delta(f \hat{\mathbf{z}} \times \mathbf{u}) = f \hat{\mathbf{z}} \times \overline{\mathbf{u}}$。然而，对于[非线性平流](@entry_id:1128854)项，例如 $\mathbf{u} \cdot \nabla \mathbf{u}$，情况则完全不同。利用不可压缩条件 $\nabla \cdot \mathbf{u} = 0$，平流项可以写为[散度形式](@entry_id:748608) $\nabla \cdot (\mathbf{u} \mathbf{u})$。对其进行滤波，我们得到 $\mathcal{G}_\Delta(\nabla \cdot (\mathbf{u} \mathbf{u})) = \nabla \cdot \mathcal{G}_\Delta(\mathbf{u} \mathbf{u})$。问题在于，滤波后的乘积不等于乘积的滤波：$\mathcal{G}_\Delta(\mathbf{u} \mathbf{u}) \neq \overline{\mathbf{u}} \overline{\mathbf{u}}$。 

为了处理这个差异，我们定义了**次网格尺度（SGS）[应力张量](@entry_id:148973)**（在[雷诺平均](@entry_id:754341)框架下，其类似物被称为[雷诺应力张量](@entry_id:270803)）：
$$
\tau_{ij} \equiv \overline{u_i u_j} - \overline{u_i} \overline{u_j}
$$
其中 $u_i$ 是速度矢量的第 $i$ 个分量。这个张量精确地量化了由于滤波操作和[非线性](@entry_id:637147)项不可交换而产生的残余效应。利用这个定义，滤波后的[动量方程](@entry_id:197225)可以写为：
$$
\frac{\partial \overline{u_i}}{\partial t} + \frac{\partial}{\partial x_j}(\overline{u_i} \overline{u_j}) = - \frac{\partial \tau_{ij}}{\partial x_j} + \mathcal{G}_\Delta(\text{其他项})
$$
这里的 $\frac{\partial \tau_{ij}}{\partial x_j}$ 项代表了未解析的[次网格尺度](@entry_id:1132591)运动对可解析尺度动量的净通量（或施加的力）。由于 $\tau_{ij}$ 的定义依赖于未解析的次网格分量（例如，它包含了 $\overline{u_i' u_j'}$ 这样的项），它不能仅由可解析变量 $\overline{\mathbf{u}}$ 来确定。这就是流体动力学中的**[闭包问题](@entry_id:160656)（closure problem）**。为了使滤波后的方程组能够求解，我们必须建立一个模型或**[参数化](@entry_id:265163)方案**，将 $\tau_{ij}$ 近似地表示为 $\overline{\mathbf{u}}$ 及其梯度的函数。

有人可能会问，这个[SGS应力](@entry_id:1131521)项是否足够小以至于可以忽略？答案是否定的。通过尺度分析可以证明其重要性。假设在一个包含截断波数 $k_c \sim 1/\Delta$ 的尺度范围内，水[平动能](@entry_id:170705)谱 $E(k)$ 遵循幂律 $E(k) \sim C k^{-p}$，其中 $p>1$。未解析速度的方差可估计为 $\langle u'^2 \rangle \sim \int_{k_c}^\infty E(k) dk \propto k_c^{-(p-1)} \propto \Delta^{p-1}$。[SGS应力](@entry_id:1131521)的大小 $| \boldsymbol{\tau} | \sim \langle u'^2 \rangle$。其散度的量级为 $|\nabla \cdot \boldsymbol{\tau}| \sim |\boldsymbol{\tau}| / \Delta \propto \Delta^{p-2}$。与可解析尺度平流项的量级 $U^2/L$ 相比，[SGS应力](@entry_id:1131521)项的相对重要性为 $(\Delta/L)^{p-2}$。对于典型的[海洋湍流](@entry_id:1129079)谱，谱斜率 $p$ 通常在 $5/3$ 到 $3$ 之间。如果 $p \le 2$，SGS项的量级甚至会超过可解析的平流项。即使对于 $p=3$（[二维湍流](@entry_id:198015)的反尺度串级区），其相对大小也是 $\Delta/L$，在现代高分辨率模型中这并非一个可以忽略的小量。因此，[SGS应力](@entry_id:1131521)项在能量上和动力学上都至关重要，必须被[参数化](@entry_id:265163)。

### [次网格尺度](@entry_id:1132591)的能量影响

[SGS应力张量](@entry_id:1131522)不仅影响[动量平衡](@entry_id:1128118)，更核心的是，它主导了可解析尺度与次网格尺度之间的能量交换。为了理解这一点，我们可以推导可解析动能 $K_r = \frac{1}{2} \overline{u_i} \overline{u_i}$ 的收支方程。将滤波后的动量方程与 $\overline{u_i}$ 做[内积](@entry_id:750660)，经过一系列推导，我们可以得到可解析动能的演化方程。

在这个能量收支方程中，由[SGS应力](@entry_id:1131521)产生的项是 $-\overline{u_i} \frac{\partial \tau_{ij}}{\partial x_j}$。利用[乘积法则](@entry_id:158393)和不可压缩条件，该项可以分解为一个[通量散度](@entry_id:1125154)项和一个源/汇项：
$$
-\overline{u_i} \frac{\partial \tau_{ij}}{\partial x_j} = - \frac{\partial}{\partial x_j} (\overline{u_i} \tau_{ij}) + \tau_{ij} \frac{\partial \overline{u_i}}{\partial x_j}
$$
第一项 $-\frac{\partial}{\partial x_j} (\overline{u_i} \tau_{ij})$ 是一个能量通量的散度，代表由次网格涨落引起的对可解析动能的输运，在全域积分下为零，仅重新分布能量。第二项 $\tau_{ij} \frac{\partial \overline{u_i}}{\partial x_j}$ 则代表了可解析尺度和[次网格尺度](@entry_id:1132591)之间的净能量交换，是真正的能量源或汇。

我们可以进一步分解[速度梯度张量](@entry_id:270928) $\frac{\partial \overline{u_i}}{\partial x_j}$ 为其对称部分，即**应变率张量** $\overline{S}_{ij} = \frac{1}{2}(\frac{\partial \overline{u_i}}{\partial x_j} + \frac{\partial \overline{u_j}}{\partial x_i})$，和其反对称部分，即旋转率张量。由于[SGS应力张量](@entry_id:1131522) $\tau_{ij}$ 是对称的，它与反对称的旋转率张量的缩并为零。因此，能量交换项可以精确地写为：
$$
\Pi = - \tau_{ij} \overline{S}_{ij}
$$
这里 $\Pi$ 定义为从可解析尺度到[次网格尺度](@entry_id:1132591)的能量传输率（或SGS耗散率）。这个关系式至关重要：它表明能量的跨尺度传输是通过次网格应力与可解析尺度应变率的相互作用来实现的。一个[参数化](@entry_id:265163)方案的成功与否，很大程度上取决于它能否准确地再现这种能量交换。

### 从确定性到[随机性参数](@entry_id:162991)化

传统的[参数化](@entry_id:265163)方案是确定性的，其中最著名的是**[涡粘性模型](@entry_id:1124145)（eddy-viscosity models）**。这类模型假设[SGS应力](@entry_id:1131521)与分子[粘性应力](@entry_id:261328)类似，与可解析尺度的[应变率](@entry_id:154778)成正比：
$$
\tau_{ij} \approx -2 \nu_t \overline{S}_{ij}
$$
其中 $\nu_t$ 是涡粘性系数。一个经典的例子是[Smagorinsky模型](@entry_id:276289)，它将涡粘性系数与网格尺度 $\Delta$ 和[应变率](@entry_id:154778)的大小联系起来，例如 $\nu_t = C_s^2 \Delta^2 |\overline{\mathbf{S}}|$。

这类确定性模型的主要局限性在于其能量特性。将[涡粘性模型](@entry_id:1124145)代入能量传输率公式，我们得到：
$$
\Pi = - \tau_{ij} \overline{S}_{ij} \approx -(-2\nu_t \overline{S}_{ij}) \overline{S}_{ij} = 2\nu_t |\overline{\mathbf{S}}|^2
$$
由于涡粘性系数 $\nu_t$ 被定义为非负，而应变率张量的 Frobenius 范数的平方 $|\overline{\mathbf{S}}|^2 = \overline{S}_{ij}\overline{S}_{ij}$ 也总是非负的，因此能量传输率 $\Pi$ 永远为非负。这意味着能量只能从可解析尺度单向地流向[次网格尺度](@entry_id:1132591)，这个过程被称为**正向串级（forward cascade）**。[涡粘性模型](@entry_id:1124145)本质上是一个纯粹的耗散机制。

然而，在许多真实的海洋流动中，尤其是在旋转和分层影响显著的准[二维湍流](@entry_id:198015)中，能量也可以从小的未解析尺度反向传递给大的可解析尺度。这个过程被称为**反向串级（inverse cascade）**或**能量回传（backscatter）**。确定性的[涡粘性模型](@entry_id:1124145)在物理上无法描述这种现象，这会导致模型系统性地过度耗散，低估大尺度流动的能量和变率。

为了克服这一根本缺陷，现代[参数化](@entry_id:265163)理论引入了随机性。其理论基础可以从Mori-[Zwanzig投影](@entry_id:158200)算子等统计力学方法中找到启发。这些理论表明，任何未解析的贡献（如[SGS应力](@entry_id:1131521) $\boldsymbol{\tau}$）都可以精确地分解为一个给定可解析状态 $\mathbf{U}$ 下的[条件期望](@entry_id:159140)（即平均效应）和一个条件均值为零的残差（即涨落部分）：
$$
\boldsymbol{\tau} = \mathbb{E}[\boldsymbol{\tau}|\mathbf{U}] + \boldsymbol{\tau}' \quad \text{其中} \quad \mathbb{E}[\boldsymbol{\tau}'|\mathbf{U}] = \mathbf{0}
$$
从这个角度看，确定性[涡粘性模型](@entry_id:1124145)仅仅是对[条件期望](@entry_id:159140) $\mathbb{E}[\boldsymbol{\tau}|\mathbf{U}]$ 的一种近似，它完全忽略了残差项 $\boldsymbol{\tau}'$。而**[随机参数化](@entry_id:1132435)**则试图同时为这两项建模。它包含一个描述平均耗散的确定性部分，并额外引入一个具有特定统计特性的随机项来表示残差 $\boldsymbol{\tau}'$ 的影响。

这个随机项 $\boldsymbol{\tau}'$ 的能量贡献率是 $-\boldsymbol{\tau}' : \overline{\mathbf{S}}$。由于 $\boldsymbol{\tau}'$ 是一个[随机过程](@entry_id:268487)，其符号不确定。在某些时空点，它可能为负，从而导致 $\Pi$ 为负，代表了从[次网格尺度](@entry_id:1132591)到可解析尺度的瞬时能量注入，即能量回传。因此，引入随机项是再现能量回传和维持[大尺度流动](@entry_id:263652)能量的关键。此外，当[尺度分离](@entry_id:270204)不强或存在间歇性爆发时，$\boldsymbol{\tau}'$ 的方差会非常显著，忽略它将导致模型无法捕捉到流动的真实变率和极端事件。 

在构建随机应力项时，还需要施加物理约束。例如，为了确保它不在[刚体](@entry_id:1131033)旋转（[应变率](@entry_id:154778)为零）中做功，随机[应力张量](@entry_id:148973)通常被建模为**对称的**。在不可压缩流中，应力的各向同性部分（迹）的作用可以被吸收到压力项中，因此随机应力通常也被建模为**无迹的**。

### 随机强迫的性质：结构与原理

一个随机参数化方案的核心是随机[强迫项](@entry_id:165986)的设计。两个关键问题是：随机噪声的幅度如何依赖于系统的状态？以及，随机噪声在时间上是如何关联的？

#### 加性噪声与[乘性噪声](@entry_id:261463)

随机噪声项的幅度可以独立于系统的可解析状态（**加性噪声**），也可以依赖于它（**乘性噪声**）。选择哪种形式取决于其所代表的物理过程。

考虑一个示踪剂（如海表温度）的[演化方程](@entry_id:268137)。如果未解析的强迫主要来自与海洋状态无关的外部过程，例如高频的大气天气扰动（体现在[海气通量](@entry_id:1120895)中），那么这种效应在投影到可解析尺度后，就表现为加性噪声。其在[随机微分方程](@entry_id:146618)（SDE）中的形式为 $G(\mathbf{x}, t) dW_t$，其中噪声幅度 $G$ 不依赖于可解析状态 $X(t)$。

相反，如果未解析过程影响的是系统内部的[输运性质](@entry_id:203130)，例如，次网格涡旋引起了有效的“扩散系数”的快速涨落，那么这种效应就是乘性的。因为这些涨落的扩散系数作用于可解析的示踪剂梯度上，产生的通量自然与可解析状态成比例。在SDE中，这表现为[乘性噪声](@entry_id:261463)，形式为 $B(\mathbf{x}, t, X) dW_t$，其中噪声幅度 $B$ 是可解析状态 $X(t)$ 的函数。

选择加性还是乘性噪声对模型的行为有深远影响。例如，考虑一个代表次网格动能 $E(t)$ 的简单模型。动能必须为正。如果使用一个简单的[加性噪声模型](@entry_id:197111)（如[Ornstein-Uhlenbeck过程](@entry_id:140047)），其SDE为 $dE = \kappa(\theta - E) dt + \sigma dW_t$。该模型的平稳概率密度函数（PDF）是高斯分布，定义在整个[实轴](@entry_id:148276)上，因此会产生非物理的[负能量](@entry_id:161542)值。此外，高斯分布的峰度为3，无法描述物理观测中常见的能量[间歇性](@entry_id:275330)爆发（其特征是PDF具有比高斯分布更重的“[肥尾](@entry_id:140093)”，[峰度](@entry_id:269963)大于3）。

相比之下，一个[乘性噪声](@entry_id:261463)模型，如平方根[扩散过程](@entry_id:268015) $dE = \kappa(\theta - E) dt + \sigma \sqrt{E} dW_t$，则能更好地反映物理现实。首先，当 $E$ 趋于零时，噪声幅度 $\sigma \sqrt{E}$ 也趋于零，这自然地将能量限制在非负区间。其次，该模型的平稳PDF是Gamma分布，它只在正半轴有定义，并且其峰度为 $3 + 6/k$（$k$为[形状参数](@entry_id:270600)），总是大于3。这表明[乘性噪声](@entry_id:261463)能够内在地产生[间歇性](@entry_id:275330)和[肥尾分布](@entry_id:274134)，与观测到的[湍流](@entry_id:151300)能量特性相符。因此，当需要[参数化](@entry_id:265163)的量有[正定性](@entry_id:149643)约束（如能量、方差、示踪剂浓度）或表现出强[间歇性](@entry_id:275330)时，乘性噪声是更物理的选择。 

#### [白噪声](@entry_id:145248)与有色噪声：记忆的角色

另一个关键设计选择是随机强迫的时间相关性。最简单的模型是**[白噪声](@entry_id:145248)（white noise）**，它在数学上是[维纳过程](@entry_id:137696)（或布朗运动）的时间导数。其核心特征是时间上完全不相关：其自相关函数是一个Dirac-delta函数，$\mathbb{E}[S(t)S(t+\tau)] \propto \delta(\tau)$。这意味着在任何两个不同时刻的随机强迫都是完全独立的。白噪声代表一个“无记忆”的过程。

然而，物理过程很少是真正无记忆的。次网格涡旋和波的演化需要时间，它们的效应在一定时间尺度内是持续和相关的。这种具有[有限记忆](@entry_id:136984)时间的[随机过程](@entry_id:268487)被称为**[有色噪声](@entry_id:265434)（colored noise）**。一个典型的例子是Ornstein-Uhlenbeck (OU) 过程，其自相关函数呈指数衰减，$\mathbb{E}[S(t)S(t+\tau)] \propto \exp(-|\tau|/\tau_c)$，其中 $\tau_c$ 是相关时间或“记忆时间”。

是否可以将有记忆的次网格过程近似为无记忆的白噪声，取决于**时间尺度分离**的程度。如果次网格过程的记忆时间 $\tau_{sg}$ 远小于我们关心的可解析过程的演化时间尺度 $T_{res}$（即 $\tau_{sg} \ll T_{res}$），那么对于缓慢演化的可解析系统来说，快速变化的次网格强迫看起来就像是一系列瞬时、不相关的“脉冲”，此时使用白噪声（即**[马尔可夫近似](@entry_id:1127636)**）是合理的。在数值模型中，这通常要求模型的时间步长 $\Delta t$ 满足 $\tau_{sg} \ll \Delta t \ll T_{res}$。

反之，如果时间尺度没有明确分离（即 $\tau_{sg} \approx T_{res}$），则[马尔可夫近似](@entry_id:1127636)失效。例如，当次网格谱中包含与可解析尺度时间相当的近共振波（如周期接近大尺度流演化时间的近[惯性波](@entry_id:165303)）时，次网格强迫的记忆效应就变得至关重要，必须被保留。此时，必须使用[有色噪声模型](@entry_id:189915)，或者通过引入辅助变量来等效地表示这种非马尔可夫效应。

对于具有记忆的[非马尔可夫过程](@entry_id:182857)，其在[广义Langevin方程](@entry_id:158854)（GLE）中表现为一个卷积形式的记忆核 $m(t)$。如果这个记忆核可以表示为有限个指数衰减函数的和，即 $m(t) = \sum_{i=1}^{p} \alpha_{i} \exp(-\beta_{i} t)$，那么我们可以通过引入 $p$ 个辅助变量，将这个非马尔可夫系统精确地转化为一个更高维度的马尔可夫系统。然而，如果记忆核具有更复杂的形式，例如与长程记忆相关的幂律形式 $m(t) \sim t^{-\alpha}$，则无法进行有限维的马尔可夫嵌入，必须采用分数阶微积分或谱方法等更复杂的工具来处理。

综上所述，[随机参数化](@entry_id:1132435)方案的设计是一个涉及深刻物理洞察和精巧数学建模的过程。它要求我们不仅要理解[闭包问题](@entry_id:160656)的根源和能量学后果，还要根据所要[参数化](@entry_id:265163)的物理过程的特性，审慎地选择随机强迫的结构（加性或乘性）与时间相关性（[白噪声](@entry_id:145248)或有色噪声）。