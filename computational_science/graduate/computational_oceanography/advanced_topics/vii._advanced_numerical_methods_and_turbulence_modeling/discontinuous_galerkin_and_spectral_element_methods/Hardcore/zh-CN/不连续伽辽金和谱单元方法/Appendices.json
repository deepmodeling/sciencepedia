{
    "hands_on_practices": [
        {
            "introduction": "理解一种数值方法的最好方式是从零开始构建它。第一个练习将引导您体验间断Galerkin方法处理简单线性平流方程的核心过程。通过为一个简单的双单元网格显式构建质量矩阵和刚度矩阵，并引入迎风格式数值通量，您将具体地理解抽象的弱形式是如何转化为可计算的半离散系统的。这个动手实践过程对于揭开DG框架的神秘面纱、为更复杂的应用打下坚实基础至关重要。",
            "id": "4031827",
            "problem": "考虑常波速 $a > 0$ 的线性平流方程 $u_{t} + a\\,u_{x} = 0$，其定义在周期性区域 $[0,2h]$ 上。该区域被划分为两个均匀单元 $K_{1} = [0,h]$ 和 $K_{2} = [h,2h]$。在每个单元 $K_{e}$ 上，使用多项式次数为 $p=1$ 的间断 Galerkin (DG) 离散化，其局部节点（Lagrange）基为 $\\{\\psi_{e,1},\\psi_{e,2}\\}$，定义为 $\\psi_{e,1}(x_{e-1/2})=1$，$\\psi_{e,1}(x_{e+1/2})=0$，$\\psi_{e,2}(x_{e-1/2})=0$ 和 $\\psi_{e,2}(x_{e+1/2})=1$，其中 $x_{e-1/2}$ 和 $x_{e+1/2}$ 分别是 $K_{e}$ 的左右端点。使用标准的 DG 弱形式，该形式通过在每个单元上进行一次分部积分得到。对所有积分使用精确求积，并对 $a>0$ 使用迎风数值通量，即在任何界面处 $\\hat{u}$ 等于左迹。在 $x=0$ 和 $x=2h$ 处施加周期性边界条件。\n\n设半离散 DG 近似为 $u_{h}(x,t)\\big|_{K_{e}}=\\sum_{j=1}^{2}u_{e,j}(t)\\,\\psi_{e,j}(x)$，并将自由度收集到向量 $\\mathbf{u}(t) = \\big(u_{1,1}(t),u_{1,2}(t),u_{2,1}(t),u_{2,2}(t)\\big)^{\\top}$ 中。\n\n任务：\n- 从 DG 弱形式出发，推导单元级的质量项和体积项以及数值通量贡献，并在给定的迎风通量和周期性条件下，组装显式的半离散 $4\\times 4$ 线性系统 $\\dot{\\mathbf{u}} = \\mathcal{A}\\,\\mathbf{u}$。\n- 对于此双单元周期系统，计算半离散空间算子 $\\mathcal{A}$ 的谱半径 $\\rho(\\mathcal{A})$，并将其表示为关于 $a$ 和 $h$ 的闭式表达式。\n\n将您的最终答案表示为 $\\rho(\\mathcal{A})$ 关于 $a$ 和 $h$ 的单个闭式表达式。无需四舍五入，最终答案中不应包含单位。",
            "solution": "用户希望我按照以下步骤解决问题：\n\n1.  **验证问题：** 问题陈述在科学上是合理的、适定的、客观的且自洽的。这是偏微分方程数值分析中的一个标准问题，特别关注间断 Galerkin (DG) 方法。所有必需的信息都已提供，没有矛盾或含糊之处。问题是有效的。\n\n2.  **提供解答：**\n    *   我将首先推导半离散系统，包括单元矩阵和通量贡献。\n    *   然后，我将组装全局 $4 \\times 4$ 系统矩阵。\n    *   最后，我将计算该矩阵的特征值以求出其谱半径。\n\n### 半离散系统的推导\n\n问题考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a > 0$。在单元 $K_e$ 上的间断 Galerkin (DG) 弱形式是通过将偏微分方程乘以一个与试探函数 $u_h$ 来自相同多项式空间的测试函数 $v_h$，在 $K_e$ 上积分，并对空间导数项应用分部积分得到的：\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx - a \\int_{K_e} u_h \\frac{\\partial v_h}{\\partial x} \\,dx + [a\\, u_h v_h]_{x_{e-1/2}}^{x_{e+1/2}} = 0\n$$\n边界项被数值通量替换，得到：\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx = a \\int_{K_e} u_h \\frac{\\partial v_h}{\\partial x} \\,dx - a \\hat{u}(x_{e+1/2}) v_h(x_{e+1/2}^{-}) + a \\hat{u}(x_{e-1/2}) v_h(x_{e-1/2}^{+})\n$$\n其中 $x_{e-1/2}$ 和 $x_{e+1/2}$ 是单元 $K_e$ 的左右端点，$\\hat{u}$ 是数值通量。\n\n单元 $K_e$ 上的解近似为 $u_h(x,t) = \\sum_{j=1}^{2} u_{e,j}(t) \\psi_{e,j}(x)$，其中 $\\{\\psi_{e,j}\\}$ 是次数为 $p=1$ 的局部节点基。在长度为 $h$ 的均匀单元上，我们可以定义局部坐标 $x' = x - x_{e-1/2} \\in [0, h]$。基函数是线性多项式：\n$$\n\\psi_{e,1}(x') = 1 - \\frac{x'}{h}, \\quad \\psi_{e,2}(x') = \\frac{x'}{h}\n$$\n它们的导数是：\n$$\n\\frac{d\\psi_{e,1}}{dx} = -\\frac{1}{h}, \\quad \\frac{d\\psi_{e,2}}{dx} = \\frac{1}{h}\n$$\n选择测试函数 $v_h$ 为基函数 $\\psi_{e,i}$，我们得到一个单元上的常微分方程组 (ODEs)：\n$$\n\\mathbf{M}^e \\dot{\\mathbf{u}}_e = a \\mathbf{S}^e \\mathbf{u}_e + \\mathbf{F}^e\n$$\n其中 $\\mathbf{u}_e(t) = (u_{e,1}(t), u_{e,2}(t))^{\\top}$。单元质量矩阵 $\\mathbf{M}^e$ 和刚度矩阵 $\\mathbf{S}^e$ 的分量为：$M^e_{ij} = \\int_{K_e} \\psi_{e,j} \\psi_{e,i} \\,dx$ 和 $S^e_{ij} = \\int_{K_e} \\psi_{e,j} \\frac{d\\psi_{e,i}}{dx} \\,dx$。精确积分得到：\n$$\n\\mathbf{M}^e = \\int_0^h \\begin{pmatrix} (1-\\frac{x'}{h})^2  & \\frac{x'}{h}(1-\\frac{x'}{h}) \\\\ \\frac{x'}{h}(1-\\frac{x'}{h})  & (\\frac{x'}{h})^2 \\end{pmatrix} dx' = \\frac{h}{6} \\begin{pmatrix} 2  & 1 \\\\ 1  & 2 \\end{pmatrix}\n$$\n$$\n\\mathbf{S}^e = \\int_0^h \\begin{pmatrix} (1-\\frac{x'}{h})(-\\frac{1}{h})  & \\frac{x'}{h}(-\\frac{1}{h}) \\\\ (1-\\frac{x'}{h})(\\frac{1}{h})  & \\frac{x'}{h}(\\frac{1}{h}) \\end{pmatrix} dx' = \\frac{1}{2} \\begin{pmatrix} -1  & -1 \\\\ 1  & 1 \\end{pmatrix}\n$$\n对于测试函数 $\\psi_{e,i}$ 的通量向量 $\\mathbf{F}^e$ 是：\n$$\nF^e_i = -a \\hat{u}(x_{e+1/2}) \\psi_{e,i}(x_{e+1/2}) + a \\hat{u}(x_{e-1/2}) \\psi_{e,i}(x_{e-1/2})\n$$\n对于 $i=1$，$\\psi_{e,1}(x_{e-1/2})=1, \\psi_{e,1}(x_{e+1/2})=0$，所以 $F^e_1 = a \\hat{u}(x_{e-1/2})$。\n对于 $i=2$，$\\psi_{e,2}(x_{e-1/2})=0, \\psi_{e,2}(x_{e+1/2})=1$，所以 $F^e_2 = -a \\hat{u}(x_{e+1/2})$。\n因此，$\\mathbf{F}^e = a \\begin{pmatrix} \\hat{u}(x_{e-1/2}) \\\\ -\\hat{u}(x_{e+1/2}) \\end{pmatrix}$。\n\n### 组装全局系统\n\n区域 $[0, 2h]$ 被划分为 $K_1=[0,h]$ 和 $K_2=[h,2h]$。全局自由度向量为 $\\mathbf{u} = (u_{1,1}, u_{1,2}, u_{2,1}, u_{2,2})^{\\top}$。问题指定了 $a>0$ 的迎风通量，因此 $\\hat{u}=u^{-}$，并采用周期性边界条件。\n- 在界面 $x=h$ 处：$\\hat{u}(h) = u^{-}(h) = u_h(h)|_{K_1} = u_{1,2}$。\n- 在界面 $x=0 \\equiv 2h$ 处：周期性意味着 $x=0$ 左侧的状态是 $x=2h$ 处的状态。因此，$\\hat{u}(0) = u^{-}(0) = u_h(2h)|_{K_2} = u_{2,2}$。在 $x=2h$ 处的通量也是 $\\hat{u}(2h) = u_h(2h)|_{K_2} = u_{2,2}$。\n\n**对于单元 $K_1 = [0,h]$：**\n$\\mathbf{M}^e \\begin{pmatrix} \\dot{u}_{1,1} \\\\ \\dot{u}_{1,2} \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{1,1} \\\\ u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} \\hat{u}(0) \\\\ -\\hat{u}(h) \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{1,1} \\\\ u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} u_{2,2} \\\\ -u_{1,2} \\end{pmatrix}$。\n右端项 (RHS) 为：\n$a \\frac{1}{2} \\begin{pmatrix} -u_{1,1}-u_{1,2} \\\\ u_{1,1}+u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} u_{2,2} \\\\ -u_{1,2} \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} -u_{1,1} - u_{1,2} + 2u_{2,2} \\\\ u_{1,1} - u_{1,2} \\end{pmatrix}$。\n\n**对于单元 $K_2 = [h,2h]$：**\n$\\mathbf{M}^e \\begin{pmatrix} \\dot{u}_{2,1} \\\\ \\dot{u}_{2,2} \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{2,1} \\\\ u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} \\hat{u}(h) \\\\ -\\hat{u}(2h) \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{2,1} \\\\ u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} u_{1,2} \\\\ -u_{2,2} \\end{pmatrix}$。\n右端项 (RHS) 为：\n$a \\frac{1}{2} \\begin{pmatrix} -u_{2,1}-u_{2,2} \\\\ u_{2,1}+u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} u_{1,2} \\\\ -u_{2,2} \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 2u_{1,2} - u_{2,1} - u_{2,2} \\\\ u_{2,1} - u_{2,2} \\end{pmatrix}$。\n\n全局半离散系统为 $\\mathbf{M} \\dot{\\mathbf{u}} = \\mathbf{R}_{glob} \\mathbf{u}$。\n全局质量矩阵 $\\mathbf{M}$ 是块对角的：\n$$\n\\mathbf{M} = \\begin{pmatrix} \\mathbf{M}^e  & \\mathbf{0} \\\\ \\mathbf{0}  & \\mathbf{M}^e \\end{pmatrix} = \\frac{h}{6} \\begin{pmatrix} 2  & 1  & 0  & 0 \\\\ 1  & 2  & 0  & 0 \\\\ 0  & 0  & 2  & 1 \\\\ 0  & 0  & 1  & 2 \\end{pmatrix}\n$$\n全局右端项矩阵 $\\mathbf{R}_{glob}$ 是：\n$$\n\\mathbf{R}_{glob} = \\frac{a}{2} \\begin{pmatrix} -1  & -1  & 0  & 2 \\\\ 1  & -1  & 0  & 0 \\\\ 0  & 2  & -1  & -1 \\\\ 0  & 0  & 1  & -1 \\end{pmatrix}\n$$\n系统算子为 $\\mathcal{A} = \\mathbf{M}^{-1} \\mathbf{R}_{glob}$。质量矩阵的逆是：\n$$\n\\mathbf{M}^{-1} = \\frac{1}{h} \\begin{pmatrix} 4  & -2  & 0  & 0 \\\\ -2  & 4  & 0  & 0 \\\\ 0  & 0  & 4  & -2 \\\\ 0  & 0  & -2  & 4 \\end{pmatrix}\n$$\n将矩阵相乘，我们得到 $\\mathcal{A}$：\n$$\n\\mathcal{A} = \\frac{1}{h} \\begin{pmatrix} 4  & -2  & 0  & 0 \\\\ -2  & 4  & 0  & 0 \\\\ 0  & 0  & 4  & -2 \\\\ 0  & 0  & -2  & 4 \\end{pmatrix} \\frac{a}{2} \\begin{pmatrix} -1  & -1  & 0  & 2 \\\\ 1  & -1  & 0  & 0 \\\\ 0  & 2  & -1  & -1 \\\\ 0  & 0  & 1  & -1 \\end{pmatrix} = \\frac{a}{h} \\begin{pmatrix} -3  & -1  & 0  & 4 \\\\ 3  & -1  & 0  & -2 \\\\ 0  & 4  & -3  & -1 \\\\ 0  & -2  & 3  & -1 \\end{pmatrix}\n$$\n\n### 计算谱半径\n\n为了求 $\\mathcal{A}$ 的特征值，我们分析其结构。由于周期性，特征向量必须是离散傅里叶模态。单元 $K_{e+1}$ 上的自由度与 $K_e$ 上的自由度通过一个相位因子 $e^{i\\kappa}$ 相关联，其中 $\\kappa = k \\Delta x$ 是无量纲波数。对于一个双单元区域，离散波数对应于整个周期 $L=2h$ 上的模态 $m=0,1$，给出物理波数 $k=0$ 和 $k=\\pi/h$。设 $\\mathbf{u}_e = (u_{e,1}, u_{e,2})^{\\top}$。特征值问题 $\\mathcal{A}\\mathbf{u} = \\lambda \\mathbf{u}$ 解耦为 $2 \\times 2$ 的问题。设 $\\mathbf{A}' = \\frac{h}{a}\\mathcal{A}$。\n$$\n\\begin{pmatrix} -3  & -1 \\\\ 3  & -1 \\end{pmatrix} \\mathbf{v} + e^{ikh} \\begin{pmatrix} 0  & 4 \\\\ 0  & -2 \\end{pmatrix} \\mathbf{v} = \\frac{h}{a} \\lambda \\mathbf{v}\n$$\n这给出了 $2 \\times 2$ 矩阵 $\\mathbf{A}_k$ 的特征值问题：\n$$\n\\mathbf{A}_k = \\begin{pmatrix} -3  & -1 + 4e^{ikh} \\\\ 3  & -1 - 2e^{ikh} \\end{pmatrix}\n$$\n$\\mathbf{A}'$ 的四个特征值是 $\\mathbf{A}_k$ 在 $k=0$ 和 $k=\\pi/h$ 时的特征值的并集。\n\n**情况1：$k=0$（常数模态）**\n$e^{ikh} = 1$。矩阵为 $\\mathbf{A}_0 = \\begin{pmatrix} -3  & 3 \\\\ 3  & -3 \\end{pmatrix}$。\n特征方程为 $(-3-\\mu)^2 - 9 = 0$，得到 $\\mu+3=\\pm 3$。特征值为 $\\mu_1=0$ 和 $\\mu_2=-6$。\n\n**情况2：$k=\\pi/h$（交替模态）**\n$e^{ikh} = e^{i\\pi} = -1$。矩阵为 $\\mathbf{A}_{\\pi/h} = \\begin{pmatrix} -3  & -5 \\\\ 3  & 1 \\end{pmatrix}$。\n特征方程为 $(-3-\\mu)(1-\\mu) - (3)(-5) = 0$，化简为 $\\mu^2 + 2\\mu + 12 = 0$。\n根为 $\\mu = \\frac{-2 \\pm \\sqrt{4-48}}{2} = -1 \\pm i\\sqrt{11}$。\n\n缩放后的矩阵 $\\mathbf{A}' = \\frac{h}{a}\\mathcal{A}$ 的特征值为 $\\{0, -6, -1+i\\sqrt{11}, -1-i\\sqrt{11}\\}$。\n$\\mathcal{A}$ 的特征值是这些值的 $\\frac{a}{h}$ 倍：\n$$\n\\lambda \\in \\left\\{ 0, -6\\frac{a}{h}, \\frac{a}{h}(-1+i\\sqrt{11}), \\frac{a}{h}(-1-i\\sqrt{11}) \\right\\}\n$$\n谱半径 $\\rho(\\mathcal{A})$ 是这些特征值模的最大值：\n- $|0|=0$\n- $|-6\\frac{a}{h}| = 6\\frac{a}{h}$\n- $|\\frac{a}{h}(-1 \\pm i\\sqrt{11})| = \\frac{a}{h}\\sqrt{(-1)^2 + (\\pm\\sqrt{11})^2} = \\frac{a}{h}\\sqrt{1+11} = \\frac{a}{h}\\sqrt{12}$\n\n我们比较 $6\\frac{a}{h}$ 和 $\\sqrt{12}\\frac{a}{h}$。由于 $6 = \\sqrt{36}$ 且 $\\sqrt{36} > \\sqrt{12}$，最大模为 $6\\frac{a}{h}$。\n\n算子 $\\mathcal{A}$ 的谱半径为 $\\rho(\\mathcal{A}) = 6\\frac{a}{h}$。",
            "answer": "$$\\boxed{6\\frac{a}{h}}$$"
        },
        {
            "introduction": "高阶方法通常隐藏着一些不那么显而易见的强大特性。间断Galerkin方法最著称的特点之一是超收敛现象，即数值解在单元内的特定点上表现出意想不到的高精度。本练习将挑战您首先分析为何在顺风单元边界上会出现超收敛，然后设计一种实用的后处理技术，利用这一现象来为一个物理参数——波速——创建一个高精度的估计器。 这个练习将理论误差分析与实用的算法改进联系了起来。",
            "id": "3790452",
            "problem": "考虑一个直通道中的小振幅正压表面高程的一维、周期性、线性平流模型，其由 $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $ 给出，定义在 $ x \\in [0,L] $ 上，其中波速 $ c > 0 $ 为一未知常数。假设初始条件为单一傅里叶模态 $ \\eta(x,0) = \\exp(i k x) $，其中 $ k = 2 \\pi m / L $，且 $ m \\geq 1 $ 为某个整数。该问题的解为 $ \\eta(x,t) = \\exp(i (k x - \\omega t)) $，其中 $ \\omega = c k $。场 $ \\eta $ 代表一个被动线性信号，其速度由背景静水力平衡 $ c = \\sqrt{g H} $（$H$ 为深度）决定，但在本练习中 $ c $ 是未知的，必须通过数值方法进行估计。\n\n使用多项式阶数为 $ r \\geq 0 $ 的间断 Galerkin (DG) 谱元法，在包含 $ N_{e} $ 个大小为 $ h = L / N_{e} $ 的单元的均匀网格上对此模型进行离散化。每个单元中使用 Legendre–Gauss–Lobatto 节点基，通过仿射映射将参考坐标 $ \\xi \\in [-1,1] $ 映射到物理坐标 $ x $。在所有界面上使用标准迎风数值通量。将 DG 半离散解记为 $ \\eta_{h}(x,t) $，并将其在单元 $ j $ 内部于右侧（顺风）界面 $ x_{j+1/2} $ 处的迹记为 $ \\eta_{h}(x_{j+1/2}^{-},t) $，其中 $ x_{j+1/2} $ 是单元 $ j $ 右侧界面的位置。\n\n在 DG 相关的文献中，根据经验观察到，对于使用迎风通量的线性平流问题，与一般内部点相比，在顺风点处对 $ \\eta_{h} $ 进行求值会表现出更高的精度（即超收敛性）。在本问题中，你将分析超收敛点，并设计一种后处理方法，以提高对给定傅里叶信号的波速估计的精度。\n\n任务：\n1. 从使用迎风数值通量的线性平流问题的 DG 弱形式以及 Legendre 多项式的正交性出发，分析单元内 $ \\eta_{h} $ 的点态误差结构。确定并论证参考单元 $ \\xi \\in [-1,1] $ 中超收敛点的位置，并说明这是迎风通量和多项式基结构的结果。特别地，解释为什么顺风边界点 $ \\xi = +1 $ 是超收敛的，并说明对于采用精确时间积分的半离散格式，其点态误差关于 $ h $ 和 $ r $ 的主阶。\n\n2. 利用已确定的顺风节点的超收敛性，构建一个后处理的全局复诊断量\n$$\nZ(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2}),\n$$\n并解释 $ Z(t) $ 如何分离出傅里叶模态的时间相位。然后，对于给定的 $ \\Delta t > 0 $，使用两个时间样本 $ Z(t) $ 和 $ Z(t+\\Delta t) $，为真实波速 $ c $ 的后处理估计量 $ \\widehat{c} $ 推导一个闭式解析表达式。确保你的推导从控制平流模型和 DG 结构出发，仅引用关于傅里叶模态输运和多项式逼近的已充分验证的事实。你的估计量必须直接使用 $ Z(t) $ 中包含的顺风节点超收敛信息。\n\n以单个闭式解析表达式的形式提供最终答案，该表达式应使用 $ k $、$ \\Delta t $ 和顺风节点的 DG 解样本来表示。将波速以 $ \\mathrm{m} \\, \\mathrm{s}^{-1} $ 为单位表示。无需进行数值计算。不要在最终的方框表达式中包含单位。无需进行四舍五入。",
            "solution": "首先根据指定标准验证问题陈述。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n-   **控制方程：** $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $\n-   **定义域：** $ x \\in [0,L] $，周期性。\n-   **波速：** 常数 $ c > 0 $，未知。\n-   **初始条件：** $ \\eta(x,0) = \\exp(i k x) $\n-   **波数：** $ k = 2 \\pi m / L $，对于某个整数 $ m \\geq 1 $。\n-   **精确解：** $ \\eta(x,t) = \\exp(i (k x - \\omega t)) $，其中 $ \\omega = c k $。\n-   **物理背景：** $ c = \\sqrt{g H} $。\n-   **数值方法：** 间断 Galerkin (DG) 谱元法。\n    -   多项式阶数：$ r \\geq 0 $。\n    -   网格：包含 $ N_{e} $ 个单元的均匀网格。\n    -   单元大小：$ h = L / N_{e} $。\n    -   基：参考单元 $ \\xi \\in [-1,1] $ 上的 Legendre–Gauss–Lobatto (LGL) 节点基。\n    -   数值通量：迎风通量。\n-   **记号：**\n    -   DG 解：$ \\eta_{h}(x,t) $。\n    -   单元 $ j $ 内部在右侧界面处的迹：$ \\eta_{h}(x_{j+1/2}^{-},t) $。\n-   **前提：** 在顺风点处对 $ \\eta_{h} $ 的求值表现出超收敛性。\n-   **任务：**\n    1.  分析并论证超收敛点的位置（特别是 $ \\xi = +1 $），并说明半离散格式下其点态误差的主阶。\n    2.  构建一个后处理诊断量 $ Z(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2}) $，并用它来推导波速 $ c $ 的闭式估计量 $ \\widehat{c} $，使用在 $ t $ 和 $ t+\\Delta t $ 处的样本。\n\n**步骤 2：使用提取的给定信息进行验证**\n-   **科学依据：** 该问题基于线性平流方程（波物理学的基石）和间断 Galerkin 方法（计算科学中一种成熟且强大的数值技术）。超收敛的概念是 DG 方法中一个已知且经过严格研究的现象。该问题在科学和数学上是合理的。\n-   **良态性：** 该问题定义明确。它要求基于数值方法的已知性质进行定性分析，并推导一个特定的公式。任务清晰，能导出一个唯一的解析结果。\n-   **客观性：** 问题以精确、正式、无偏见的语言陈述。所有术语都在偏微分方程数值分析的背景下定义。\n-   **完整性与一致性：** 问题提供了进行分析和推导所需的所有必要信息。问题设定是自洽且内部一致的。\n-   **可行性与现实性：** 物理模型和数值设置在计算海洋学和流体力学中是标准的。所需的分析在数值方法研究中也是标准的。\n-   **结构及其他标准：** 问题结构逻辑清晰，具有一定难度，并且可以在数值分析的原则内进行验证。\n\n**步骤 3：结论与行动**\n问题被判定为**有效**。将提供一个完整、有理有据的解答。\n\n### 解答\n\n按照要求，本问题分两部分解答。第一部分分析线性平流问题中 DG 方法的超收敛性质。第二部分利用此性质构建一个高精度的波速估计量。\n\n**第 1 部分：超收敛分析**\n\n对于线性平流方程 $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $（其中 $ c > 0 $），在单元 $ K_j = [x_{j-1/2}, x_{j+1/2}] $ 上的半离散间断 Galerkin (DG) 格式，是通过乘以一个来自多项式空间 $ P^r(K_j) $ 的检验函数 $ v_h $ 并在单元上积分得到的。对空间项进行分部积分后，我们得到：\n$$ \\int_{K_j} (\\partial_t \\eta_h) v_h \\, dx - \\int_{K_j} c \\eta_h (\\partial_x v_h) \\, dx + c \\left[ \\eta_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0 \\quad \\forall v_h \\in P^r(K_j) $$\n此处，$ \\eta_h $ 是 $ \\eta $ 在 $ K_j $ 中的多项式逼近，$ \\eta_h^* $ 是单元界面上的数值通量。问题指定了迎风通量。由于 $ c > 0 $，信息从左向右传播。因此，迎风通量是每个界面迎风（左）侧解的迹：$ \\eta_h^*(x) = \\lim_{\\epsilon \\to 0^+} \\eta_h(x-\\epsilon) $。边界项变为：\n$$ c \\left[ \\eta_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = c \\, \\eta_h(x_{j+1/2}^{-}) v_h(x_{j+1/2}^{-}) - c \\, \\eta_h(x_{j-1/2}^{-}) v_h(x_{j-1/2}^{+}) $$\nDG 方法的误差 $ e_h = \\eta_h - \\eta $ 受此格式的性质控制。在线性平流 DG 方法的分析中，一个公认的结果是点态误差在单元内并非均匀分布。具体来说，误差结构受到平流方向和多项式基选择的影响。\n\n对于在参考单元 $ \\xi \\in [-1,1] $ 上由 Legendre 多项式构建的基，单元内一点 $ x(\\xi) $ 处的误差 $ e_h $ 的主项依赖于精确解的 $(r+1)$ 阶导数和一个特定的 $r+1$ 阶多项式。理论分析表明，对于稳态问题，该多项式部分与 $ L_{r+1}(\\xi) - L_r(\\xi) $ 成正比，其中 $ L_k $ 是 $ k $ 阶 Legendre 多项式。\n\n超收敛发生在误差主项为零的点。我们考察该多项式在参考单元端点 $ \\xi = \\pm 1 $ 处的值。\n-   在顺风边界 $ \\xi = +1 $ 处，我们使用性质 $ L_k(1) = 1 $（对所有 $ k \\geq 0 $）。误差多项式的值为 $ L_{r+1}(1) - L_r(1) = 1 - 1 = 0 $。主误差项 $ O(h^{r+1}) $ 的这种抵消表明点 $ \\xi = +1 $ 是一个超收敛点。\n-   在迎风边界 $ \\xi = -1 $ 处，我们使用性质 $ L_k(-1) = (-1)^k $。误差多项式为 $ L_{r+1}(-1) - L_r(-1) = (-1)^{r+1} - (-1)^r = -2(-1)^r \\neq 0 $。在迎风边界没有发生这种抵消。\n\n顺风边界处主误差项的消失意味着该处的误差具有更高阶。尽管上述使用 $ L_{r+1} - L_r $ 的启发式方法来自稳态分析，但对采用精确时间积分的瞬态问题（半离散情况）进行的更严格分析证实了这一现象。对于应用于线性平流方程的 $ r $ 阶多项式 DG 方法，一般内部点的点态误差为 $ O(h^{r+1}) $，但在顺风边界节点（对应于 $ \\xi = +1 $），误差要高一阶。\n\n因此，超收敛的位置是每个单元的顺风边界，即 $ \\xi=+1 $。对于半离散格式，该点点态误差的主阶为 $ \\boldsymbol{O(h^{r+2})} $。\n\n**第 2 部分：波速估计量**\n\n我们被要求使用一个后处理诊断量 $ Z(t) $ 来构建波速 $ c $ 的估计量 $ \\widehat{c} $，该诊断量是使用超收敛的顺风节点值定义的：\n$$ Z(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2}) $$\n这个诊断量的目的是分离出传播的傅里叶模态的时间分量。为了理解这一点，让我们考虑如果我们使用精确解 $ \\eta(x,t) = \\exp(i(kx - \\omega t)) $，$ Z(t) $ 会是什么样子：\n$$ Z_{\\text{exact}}(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta(x_{j+1/2},t) \\, \\exp(-i k x_{j+1/2}) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\exp(i(k x_{j+1/2} - \\omega t)) \\, \\exp(-i k x_{j+1/2}) $$\n$$ Z_{\\text{exact}}(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\exp(-i \\omega t) = \\frac{1}{N_{e}} (N_e \\exp(-i \\omega t)) = \\exp(-i \\omega t) $$\n数值诊断量 $ Z(t) $ 是 $ \\exp(-i \\omega t) $ 的一个近似。此近似的精度取决于在采样点处数值解 $ \\eta_h $ 的误差。由于我们在顺风节点 $ x_{j+1/2}^{-} $ 处采样，该处的点态误差是 $ O(h^{r+2}) $ 阶超收敛的，我们有：\n$$ \\eta_h(x_{j+1/2}^{-}, t) = \\eta(x_{j+1/2}, t) + O(h^{r+2}) $$\n将此代入 $ Z(t) $ 的定义中得到：\n$$ Z(t) = Z_{\\text{exact}}(t) + \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} O(h^{r+2}) \\exp(-i k x_{j+1/2}) = \\exp(-i \\omega t) + O(h^{r+2}) $$\n因此，$ Z(t) $ 是解的时间相位因子的一个非常精确的近似。我们可以用它来估计 $ \\omega $。给定两个样本 $ Z(t) $ 和 $ Z(t+\\Delta t) $，我们可以构造它们的比值：\n$$ \\frac{Z(t+\\Delta t)}{Z(t)} \\approx \\frac{\\exp(-i \\omega (t+\\Delta t))}{\\exp(-i \\omega t)} = \\exp(-i \\omega \\Delta t) $$\n右侧的复数模为 $ 1 $，相位（辐角）为 $ -\\omega \\Delta t $。因此，我们可以通过取数值诊断量之比的辐角来提取 $ \\omega $。令 $ \\widehat{\\omega} $ 为我们对 $ \\omega $ 的估计。\n$$ \\arg\\left( \\frac{Z(t+\\Delta t)}{Z(t)} \\right) \\approx -\\widehat{\\omega} \\Delta t $$\n复数 $ z $ 的辐角可以写成其自然对数的虚部，即 $ \\arg(z) = \\mathrm{Im}(\\ln(z)) $，其中 $ \\ln $ 表示复数对数的主值。这给出了 $ \\widehat{\\omega} $ 的一个表达式：\n$$ \\widehat{\\omega} = -\\frac{1}{\\Delta t} \\mathrm{Im}\\left( \\ln\\left( \\frac{Z(t+\\Delta t)}{Z(t)} \\right) \\right) $$\n问题要求的是波速 $ c $ 的估计量。使用精确的色散关系 $ \\omega = c k $，我们对 $ c $ 的估计量是 $ \\widehat{c} = \\widehat{\\omega} / k $。代入 $ \\widehat{\\omega} $ 的表达式和 $ Z(t) $ 的定义，得到 $ \\widehat{c} $ 的最终闭式表达式：\n$$ \\widehat{c} = -\\frac{1}{k \\Delta t} \\mathrm{Im}\\left[ \\ln\\left( \\frac{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t+\\Delta t) \\exp(-i k x_{j+1/2})}{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\exp(-i k x_{j+1/2})} \\right) \\right] $$\n正如所要求，这个 $ c $ 的估计量是直接由超收敛顺风节点处的 DG 解样本构建的。",
            "answer": "$$ \\boxed{- \\frac{1}{k \\Delta t} \\mathrm{Im}\\left( \\ln\\left( \\frac{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t+\\Delta t) \\exp(-i k x_{j+1/2})}{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\exp(-i k x_{j+1/2})} \\right) \\right)} $$"
        },
        {
            "introduction": "将高阶数值格式应用于非线性守恒律方程（如浅水方程）时，会面临一个重大挑战：确保解保持物理意义。高阶多项式逼近中产生的伪振荡可能导致非物理状态，例如负水深。本练习将深入探讨正定性保持这一关键课题，引导您推导出一个保证稳定性的理论时间步长条件，以及一个实用的、保持质量的限制器来强制施加这种物理约束。 掌握这些技术对于为实际的海洋和大气模型开发稳健的DG求解器至关重要。",
            "id": "3790493",
            "problem": "考虑平坦测深上的一维浅水方程，写为水深 $h(x,t)$ 和动量 $m(x,t)=h(x,t)\\,u(x,t)$ 的守恒形式，其中 $u(x,t)$ 是速度，$g$ 是重力加速度：\n$$\n\\partial_{t} h + \\partial_{x} m = 0, \\qquad \\partial_{t} m + \\partial_{x} \\left( \\frac{m^{2}}{h} + \\frac{1}{2} g h^{2} \\right) = 0.\n$$\n间断 Galerkin (DG) 方法在均匀网格的每个单元 $K$ 中使用多项式逼近 $h$ 和 $m$，采用谱元法中典型的 Legendre-Gauss-Lobatto 节点。令 $\\bar{h}^{n}$ 表示时刻 $t^{n}$ 在单元 $K$ 上 $h$ 的单元平均值，令 $h^{n}(x)$ 为其次数 $p \\geq 1$ 的多项式表示。假设使用一个强稳定性保持 Runge-Kutta (SSP-RK) 时间积分器，该积分器由前向欧拉步和局部 Lax-Friedrichs 数值通量构成，在每个面上耗散参数为 $\\alpha \\geq \\max\\{ |u_{L}| + \\sqrt{g h_{L}}, |u_{R}| + \\sqrt{g h_{R}} \\}$，其中下标 $L$ 和 $R$ 分别表示左迹和右迹。DG 格式使用的求积法则对于体积分中的最高 $2p-1$ 次多项式和面积分中的最高 $2p-1$ 次多项式是精确的，并且前向欧拉更新以常规方式应用于模态系数。\n\n从以下基本事实出发：(i) 具有单调通量的一阶有限体积格式在适当的 Courant–Friedrichs–Lewy (CFL) 时间步长限制下保持 $h$ 的非负性，(ii) SSP-RK 时间步进可以写成前向欧拉步的凸组合，以及 (iii) Legendre-Gauss-Lobatto 求积提供包含端点的正权重，回答下列问题：\n\n1. 推导一个关于前向欧拉时间步长 $\\Delta t$ 和波速的充分的 CFL 型条件，确保如果 $h^{n}(x) \\geq 0$ 在 DG 格式在单元 $K$ 及其邻居单元中使用的求积点上成立，那么前向欧拉更新保持单元平均值 $\\bar{h}^{n+1}$ 和 $h^{n+1}(x)$ 在那些求积点上的节点值的非负性。你的条件应以单元测度 $|K|$、面测度、面上的局部 Lax-Friedrichs 参数 $\\alpha$ 以及最小的 Legendre-Gauss-Lobatto 权重 $w_{\\min}$ 的符号形式表示。\n\n2. 使用质量守恒和凸性论证，推导一个用于 $h$ 的高阶保正、保质量限制器，其形式为\n$$\nh^{\\mathrm{lim}}(x) = \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h},\n$$\n其中标量 $\\theta \\in [0,1]$ 被选择以在选定的保正点上强制 $h^{\\mathrm{lim}}(x) \\geq \\varepsilon$，这里 $\\varepsilon > 0$ 是一个代表物理上有意义的干涸阈值的小下限。请提供 $\\theta$ 关于 $\\bar{h}$、$\\varepsilon$ 以及 $h(x)$ 在保正点上的最小值（记为 $h_{\\min}$）的封闭形式表达式。\n\n3. 在一个特定的单元 $K$ 上，假设 DG 多项式 $h(x)$ 在保正点上的最小值为 $h_{\\min} = -0.3$，单元平均值为 $\\bar{h} = 2.0$。取干涸下限为 $\\varepsilon = 10^{-3}$。计算你的表达式所隐含的限制器参数 $\\theta$ 的值，并将你的答案四舍五入到四位有效数字。最终答案是无量纲的，应不带单位报告。",
            "solution": "该问题分为三个部分，都与一维浅水方程的间断 Galerkin (DG) 格式中水深 $h$ 的正性有关。\n\n### 第 1 部分：CFL 型条件的推导\n\n目标是找到一个关于前向欧拉时间步长 $\\Delta t$ 的充分条件，以保持水深 $h$ 在 Legendre-Gauss-Lobatto (LGL) 求积点上的非负性。题目提供了几个指导推导的关键事实：\n1.  具有单调通量的一阶有限体积 (FV) 格式在 Courant–Friedrichs–Lewy (CFL) 条件下保持非负性。\n2.  强稳定性保持 Runge-Kutta (SSP-RK) 方法是前向欧拉步的凸组合。因此，如果一个前向欧拉步保持正性，那么整个 SSP-RK 步（在相同或缩放的时间步长限制下）也将保持正性。\n3.  DG 格式使用 LGL 求积点和权重，这些权重是正的。对于这种基和求积的选择，质量矩阵是对角的。\n\n让我们分析 DG 逼近的前向欧拉更新。在单元 $K$ 中，对于连续性方程 $\\partial_t h + \\partial_x m = 0$ 的半离散 DG 公式为：对多项式空间中所有的测试函数 $v(x)$，\n$$ \\int_K \\frac{\\partial h}{\\partial t} v \\, dx = \\int_K m \\frac{\\partial v}{\\partial x} \\, dx - \\left[ m^* v \\right]_{\\partial K} $$\n这里，$m^*$ 是数值通量，而 $\\left[ \\cdot \\right]_{\\partial K}$ 表示在单元边界处值的差，例如 $f(x_{k+1/2}) - f(x_{k-1/2})$。\n\n使用由以 LGL 求积点 $\\{x_j\\}_{j=0}^p$ 为中心的 Lagrange 多项式 $L_j(x)$ 构成的节点基，近似解为 $h(x,t) = \\sum_{j=0}^{p} h_j(t) L_j(x)$。我们选择测试函数为 $v(x) = L_i(x)$。由于 LGL 求积法则对最高 $2p-1$ 次多项式是精确的（因为 $L_i L_j$ 的次数最多为 $2p$），质量矩阵 $M_{ij} = \\int_K L_i(x) L_j(x) \\, dx$ 变为对角矩阵。对角线元素为 $M_{ii} = \\int_K L_i^2(x) dx = w_i^{\\text{ref}} \\frac{|K|}{2}$，其中 $w_i^{\\text{ref}}$ 是参考单元 $[-1,1]$ 上的 LGL 权重，而 $|K|$ 是单元 $K$ 的测度（长度）。为简单起见，我们记 $w_i = w_i^{\\text{ref}}$。\n\n节点值 $h_i(t)$ 的半离散方程是：\n$$ \\frac{|K|}{2} w_i \\frac{d h_i}{dt} = \\int_K m(x,t) L_i'(x) \\, dx - \\left[ m^* L_i \\right]_{\\partial K} $$\n应用前向欧拉步：\n$$ h_i^{n+1} = h_i^n + \\frac{2 \\Delta t}{|K| w_i} \\left( \\int_K m^n(x) L_i'(x) \\, dx - \\left[ m^{*,n} L_i \\right]_{\\partial K} \\right) $$\n从这一点开始的严格推导技术性很强。然而，由 Zhang 和 Shu 发展的保正 DG 格式理论中的一个关键结果是，在求积点上的 DG 更新可以被解释为在子单元上的有限体积更新。与节点 $x_i$ 相关联的子单元的“体积”是其对应的质量矩阵项，$V_i = \\frac{|K|}{2} w_i$。然后，可以通过与一阶 FV 格式的类比来推导保正性条件。\n\n对于一维 FV 格式 $h_j^{n+1} = h_j^n - \\frac{\\Delta t}{\\Delta x_j} (F^*_{j+1/2} - F^*_{j-1/2})$，使用 Lax-Friedrichs 通量 $F^*(h_L, h_R) = \\frac{f(h_L)+f(h_R)}{2} - \\frac{\\alpha}{2}(h_R - h_L)$，更新中 $h_j^n$ 的系数是 $1 - \\frac{\\Delta t}{2\\Delta x_j} (\\alpha_{j+1/2} + \\alpha_{j-1/2})$。为了保证正性，该系数必须为非负，从而得出 CFL 条件 $\\Delta t \\le \\frac{2 \\Delta x_j}{\\alpha_{j+1/2} + \\alpha_{j-1/2}}$。\n\n通过类比，对于 DG 格式，我们考虑具有最小有效体积的子单元，它对应于最小的 LGL 权重 $w_{\\min}$。我们用 $V_{\\min} = \\frac{|K|}{2} w_{\\min}$ 替换 $\\Delta x_j$。项 $\\alpha_{j+1/2} + \\alpha_{j-1/2}$ 表示单元各面上耗散系数的总和。对于 DG 单元 $K$，相关的耗散参数是其外部面上的参数，即 $\\alpha_L$ 和 $\\alpha_R$。由于高阶多项式表示，这些边界通量的影响会传播到整个单元并影响所有节点值。因此，保持所有节点正性的条件必须考虑进入单元的总耗散。\n\n充分条件是时间步长必须足够小，以至于离开任何子单元的总通量不会耗尽其内容。最严格的情况是体积最小的子单元 $V_{\\min}$。总的出射通量由所有单元面上的耗散效应之和驱动。在一维中，我们有两个面，其测度为 $|\\partial K_L|=1$ 和 $|\\partial K_R|=1$。由面测度加权的 LF 参数之和为 $\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|$。\n\n应用类比，我们将 $\\frac{1}{2}(\\alpha_L + \\alpha_R)$ 替换为 $\\frac{1}{2}(\\alpha_L|\\partial K_L|+\\alpha_R|\\partial K_R|)$，将 $\\Delta x_j$ 替换为 $\\frac{|K|}{2} w_{\\min}$。这得出：\n$$ \\Delta t \\le \\frac{2 \\left( \\frac{|K|}{2} w_{\\min} \\right)}{\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|} = \\frac{|K| w_{\\min}}{\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|} $$\n此条件确保如果 $h^n(x_j) \\geq 0$ 在单元 $K$ 及其邻居单元的所有 LGL 点上成立，那么前向欧拉更新 $h^{n+1}(x_j)$ 也将是非负的。因为 LGL 节点包含端点，节点上的非负性意味着多项式 $h(x)$ 在整个单元上都是非负的，这反过来又确保了单元平均值 $\\bar{h}^{n+1}$ 是非负的。因此，这一个条件对于节点正性和单元平均值正性都是充分的。\n\n### 第 2 部分：保正限制器的推导\n\n我们给定一个形式为 $h^{\\mathrm{lim}}(x) = \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h}$ 的限制器，其中 $\\theta \\in [0,1]$。\n\n首先，我们验证此限制器是保质量的。新的单元平均值为：\n$$ \\overline{h^{\\mathrm{lim}}} = \\frac{1}{|K|} \\int_K h^{\\mathrm{lim}}(x) \\, dx = \\frac{1}{|K|} \\int_K \\left[ \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h} \\right] \\, dx $$\n$$ \\overline{h^{\\mathrm{lim}}} = \\frac{\\theta}{|K|} \\int_K h(x) \\, dx - \\frac{\\theta}{|K|} \\int_K \\bar{h} \\, dx + \\frac{1}{|K|} \\int_K \\bar{h} \\, dx $$\n使用定义 $\\bar{h} = \\frac{1}{|K|} \\int_K h(x) \\, dx$，我们得到：\n$$ \\overline{h^{\\mathrm{lim}}} = \\theta \\bar{h} - \\theta \\bar{h} + \\bar{h} = \\bar{h} $$\n该限制器对任何 $\\theta$ 都保质量。\n\n接下来，我们在一些保正点（例如，求积点）上强制施加正性约束 $h^{\\mathrm{lim}}(x) \\geq \\varepsilon$。令 $h_{\\min} = \\min_x h(x)$ 为未限制的多项式 $h(x)$ 在这些点上的最小值。限制后的多项式 $h^{\\mathrm{lim}}(x)$ 的最小值为：\n$$ h^{\\mathrm{lim}}_{\\min} = \\min_x \\left[ \\theta h(x) + (1-\\theta)\\bar{h} \\right] = \\theta h_{\\min} + (1-\\theta)\\bar{h} $$\n因为 $\\theta \\in [0,1]$。\n我们要求 $h^{\\mathrm{lim}}_{\\min} \\geq \\varepsilon$：\n$$ \\theta h_{\\min} + (1-\\theta)\\bar{h} \\geq \\varepsilon $$\n$$ \\theta h_{\\min} + \\bar{h} - \\theta\\bar{h} \\geq \\varepsilon $$\n$$ \\theta(h_{\\min} - \\bar{h}) \\geq \\varepsilon - \\bar{h} $$\n只有当 $h_{\\min}$ 违反了正性约束时，即 `$h_{\\min}  \\varepsilon$` 时，才应用限制器。根据定义，$h_{\\min} \\le \\bar{h}$。如果 $h_{\\min} = \\bar{h}$，则该多项式为常数，除非该常数低于 $\\varepsilon$，否则不需要限制。我们假设 `$h_{\\min}  \\bar{h}$`，这使得项 $(h_{\\min} - \\bar{h})$ 严格为负。用这个负项除以不等式会反转不等号：\n$$ \\theta \\le \\frac{\\varepsilon - \\bar{h}}{h_{\\min} - \\bar{h}} = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\n为了尽可能减少干预，我们希望选择满足此条件的最大可能 $\\theta$，同时也要遵守 $\\theta \\in [0, 1]$。我们选择 $\\theta$ 为其上界：\n$$ \\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\n这个 $\\theta$ 值仅在需要限制时使用，即当 `$h_{\\min}  \\varepsilon$` 时。如果 `$h_{\\min} \\ge \\varepsilon$`，则不应用限制，这对应于 `$\\theta = 1$`。推导出的 $\\theta$ 表达式与此一致，因为 `$h_{\\min}  \\varepsilon \\implies \\bar{h} - h_{\\min} > \\bar{h} - \\varepsilon \\implies \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}}  1$`。此外，为了使限制后的解能够满足条件，单元平均值 $\\bar{h}$ 必须大于 $\\varepsilon$。如果 `$\\bar{h} \\le \\varepsilon$`，在保持平均值不变的情况下，没有 `$\\theta \\in [0,1]$` 的值可以保证 `$h^{\\mathrm{lim}}(x) \\ge \\varepsilon$`（除非 `$h(x)=\\bar{h}=\\varepsilon$`）。在这种情况下，通常设 `$\\theta=0$`，从而得到 $h^{\\mathrm{lim}}(x) = \\bar{h}$。假设 $\\bar{h} > \\varepsilon$，我们关于 $\\theta$ 的表达式是良定义的，并且位于 $[0,1)$ 区间内。\n\n完整的步骤是：如果 `$h_{\\min}  \\varepsilon$` 且 `$\\bar{h} > \\varepsilon$`，则设置 $\\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}}$。否则，设置 `$\\theta=1$`。问题要求的是强制该条件的 $\\theta$ 的表达式，也就是推导出的公式。\n\n### 第 3 部分：限制器参数 $\\theta$ 的计算\n\n对于一个特定的单元，我们给定了以下值：\n- $h(x)$ 在保正点上的最小值：$h_{\\min} = -0.3$\n- $h(x)$ 的单元平均值：$\\bar{h} = 2.0$\n- 干涸下限：$\\varepsilon = 10^{-3} = 0.001$\n\n我们检查应用限制器的条件。我们有 `$h_{\\min} = -0.3  0.001 = \\varepsilon$`，所以需要进行限制。我们还有 `$\\bar{h} = 2.0 > 0.001 = \\varepsilon$`，所以存在一个有效的、保质量的限制解。\n\n我们使用第 2 部分中推导的公式：\n$$ \\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\n代入给定值：\n$$ \\theta = \\frac{2.0 - 0.001}{2.0 - (-0.3)} = \\frac{1.999}{2.3} $$\n计算数值：\n$$ \\theta \\approx 0.8691304347... $$\n将结果四舍五入到四位有效数字，我们得到 $\\theta = 0.8691$。",
            "answer": "$$\\boxed{0.8691}$$"
        }
    ]
}