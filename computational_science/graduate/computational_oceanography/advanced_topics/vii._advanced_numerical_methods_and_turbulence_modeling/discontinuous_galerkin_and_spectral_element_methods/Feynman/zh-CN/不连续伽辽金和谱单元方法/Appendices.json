{
    "hands_on_practices": [
        {
            "introduction": "掌握任何数值方法的第一步，都是将其应用于一个简单的代表性方程。本练习将引导你完成使用间断Galerkin（DG）方法为线性平流方程构建离散系统的基本过程，这是实现和分析更复杂模型的关键技能。通过这个练习，你将具体实践如何推导质量矩阵和刚度矩阵，并学会如何整合边界条件与数值通量，从而为DG方法的实际应用打下坚实的基础。",
            "id": "4031827",
            "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其波速为常数 $a > 0$，定义在周期性域 $[0,2h]$ 上。该域被划分为 $2$ 个均匀单元 $K_{1} = [0,h]$ 和 $K_{2} = [h,2h]$。在每个单元 $K_{e}$ 上，使用多项式次数 $p=1$ 的间断伽辽金 (DG) 离散化，其局部节点 (拉格朗日) 基为 $\\{\\psi_{e,1},\\psi_{e,2}\\}$，定义为 $\\psi_{e,1}(x_{e-1/2})=1$, $\\psi_{e,1}(x_{e+1/2})=0$, $\\psi_{e,2}(x_{e-1/2})=0$, and $\\psi_{e,2}(x_{e+1/2})=1$，其中 $x_{e-1/2}$ 和 $x_{e+1/2}$ 分别是 $K_{e}$ 的左端点和右端点。在每个单元上通过一次分部积分得到标准 DG 弱形式，所有积分均使用精确求积，并对 $a>0$ 使用迎风数值通量，即任何界面处的 $\\hat{u}$ 等于左迹。在 $x=0$ 和 $x=2h$ 处施加周期性边界条件。\n\n令半离散 DG 近似为 $u_{h}(x,t)\\big|_{K_{e}}=\\sum_{j=1}^{2}u_{e,j}(t)\\,\\psi_{e,j}(x)$，并将自由度收集到向量 $\\mathbf{u}(t) = \\big(u_{1,1}(t),u_{1,2}(t),u_{2,1}(t),u_{2,2}(t)\\big)^{\\top}$ 中。\n\n任务：\n- 从 DG 弱形式出发，推导单元级质量项和体积项以及数值通量贡献，并在所述的迎风通量和周期性条件下，组装显式半离散 $4\\times 4$ 线性系统 $\\dot{\\mathbf{u}} = \\mathcal{A}\\,\\mathbf{u}$。\n- 对于此双单元周期系统，计算半离散空间算子的谱半径 $\\rho(\\mathcal{A})$，并以 $a$ 和 $h$ 的闭式表达式表示。\n\n请以 $a$ 和 $h$ 的单个闭式表达式形式提供 $\\rho(\\mathcal{A})$ 的最终答案。最终答案无需四舍五入，也不应包含单位。",
            "solution": "用户希望我按照以下步骤解决问题：\n\n1.  **验证问题：** 该问题陈述具有科学依据、适定、客观且自洽。它是偏微分方程数值分析中的一个标准问题，特别关注间断伽辽金 (DG) 方法。所有必需信息均已提供，没有矛盾或歧义。该问题有效。\n\n2.  **提供解答：**\n    *   我将首先推导半离散系统，包括单元矩阵和通量贡献。\n    *   然后，我将组装全局 $4 \\times 4$ 系统矩阵。\n    *   最后，我将计算该矩阵的特征值以求其谱半径。\n\n### 半离散系统的推导\n\n问题考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a > 0$。单元 $K_e$ 上的间断伽辽金 (DG) 弱形式通过将偏微分方程乘以一个与试探函数 $u_h$ 来自同一多项式空间的检验函数 $v_h$，在 $K_e$ 上积分，并对空间导数项应用分部积分得到：\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx - a \\int_{K_e} u_h \\frac{\\partial v_h}{\\partial x} \\,dx + [a\\, u_h v_h]_{x_{e-1/2}}^{x_{e+1/2}} = 0\n$$\n边界项被数值通量替换，得到：\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx = a \\int_{K_e} u_h \\frac{\\partial v_h}{\\partial x} \\,dx - a \\hat{u}(x_{e+1/2}) v_h(x_{e+1/2}^{-}) + a \\hat{u}(x_{e-1/2}) v_h(x_{e-1/2}^{+})\n$$\n其中 $x_{e-1/2}$ 和 $x_{e+1/2}$ 是单元 $K_e$ 的左右端点，$\\hat{u}$ 是数值通量。\n\n单元 $K_e$ 上的解近似为 $u_h(x,t) = \\sum_{j=1}^{2} u_{e,j}(t) \\psi_{e,j}(x)$，其中 $\\{\\psi_{e,j}\\}$ 是次数 $p=1$ 的局部节点基。在长度为 $h$ 的均匀单元上，我们可以定义局部坐标 $x' = x - x_{e-1/2} \\in [0, h]$。基函数是线性多项式：\n$$\n\\psi_{e,1}(x') = 1 - \\frac{x'}{h}, \\quad \\psi_{e,2}(x') = \\frac{x'}{h}\n$$\n它们的导数是：\n$$\n\\frac{d\\psi_{e,1}}{dx} = -\\frac{1}{h}, \\quad \\frac{d\\psi_{e,2}}{dx} = \\frac{1}{h}\n$$\n选择检验函数 $v_h$ 为基函数 $\\psi_{e,i}$，我们得到一个单元级常微分方程 (ODE) 系统：\n$$\n\\mathbf{M}^e \\dot{\\mathbf{u}}_e = a \\mathbf{S}^e \\mathbf{u}_e + \\mathbf{F}^e\n$$\n其中 $\\mathbf{u}_e(t) = (u_{e,1}(t), u_{e,2}(t))^{\\top}$。单元质量矩阵 $\\mathbf{M}^e$ 和刚度矩阵 $\\mathbf{S}^e$ 的分量为：\n$M^e_{ij} = \\int_{K_e} \\psi_{e,j} \\psi_{e,i} \\,dx$ 和 $S^e_{ij} = \\int_{K_e} \\psi_{e,j} \\frac{d\\psi_{e,i}}{dx} \\,dx$。精确积分得到：\n$$\n\\mathbf{M}^e = \\int_0^h \\begin{pmatrix} (1-\\frac{x'}{h})^2  \\frac{x'}{h}(1-\\frac{x'}{h}) \\\\ \\frac{x'}{h}(1-\\frac{x'}{h})  (\\frac{x'}{h})^2 \\end{pmatrix} dx' = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\n\\mathbf{S}^e = \\int_0^h \\begin{pmatrix} (1-\\frac{x'}{h})(-\\frac{1}{h})  \\frac{x'}{h}(-\\frac{1}{h}) \\\\ (1-\\frac{x'}{h})(\\frac{1}{h})  \\frac{x'}{h}(\\frac{1}{h}) \\end{pmatrix} dx' = \\frac{1}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}\n$$\n对于检验函数 $\\psi_{e,i}$，通量向量 $\\mathbf{F}^e$ 为：\n$$\nF^e_i = -a \\hat{u}(x_{e+1/2}) \\psi_{e,i}(x_{e+1/2}) + a \\hat{u}(x_{e-1/2}) \\psi_{e,i}(x_{e-1/2})\n$$\n对于 $i=1$，$\\psi_{e,1}(x_{e-1/2})=1, \\psi_{e,1}(x_{e+1/2})=0$，所以 $F^e_1 = a \\hat{u}(x_{e-1/2})$。\n对于 $i=2$，$\\psi_{e,2}(x_{e-1/2})=0, \\psi_{e,2}(x_{e+1/2})=1$，所以 $F^e_2 = -a \\hat{u}(x_{e+1/2})$。\n因此，$\\mathbf{F}^e = a \\begin{pmatrix} \\hat{u}(x_{e-1/2}) \\\\ -\\hat{u}(x_{e+1/2}) \\end{pmatrix}$。\n\n### 组装全局系统\n\n域 $[0, 2h]$ 被划分为 $K_1=[0,h]$ 和 $K_2=[h,2h]$。全局自由度向量是 $\\mathbf{u} = (u_{1,1}, u_{1,2}, u_{2,1}, u_{2,2})^{\\top}$。问题指定了对 $a>0$ 的迎风通量，所以 $\\hat{u}=u^{-}$，并采用周期性边界条件。\n- 在界面 $x=h$ 处：$\\hat{u}(h) = u^{-}(h) = u_h(h)|_{K_1} = u_{1,2}$。\n- 在界面 $x=0 \\equiv 2h$ 处：周期性意味着 $x=0$ 左侧的状态即为 $x=2h$ 处的状态。因此，$\\hat{u}(0) = u^{-}(0) = u_h(2h)|_{K_2} = u_{2,2}$。在 $x=2h$ 处的通量也是 $\\hat{u}(2h) = u_h(2h)|_{K_2} = u_{2,2}$。\n\n**对于单元 $K_1 = [0,h]$:**\n$\\mathbf{M}^e \\begin{pmatrix} \\dot{u}_{1,1} \\\\ \\dot{u}_{1,2} \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{1,1} \\\\ u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} \\hat{u}(0) \\\\ -\\hat{u}(h) \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{1,1} \\\\ u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} u_{2,2} \\\\ -u_{1,2} \\end{pmatrix}$。\n右侧 (RHS) 是：\n$a \\frac{1}{2} \\begin{pmatrix} -u_{1,1}-u_{1,2} \\\\ u_{1,1}+u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} u_{2,2} \\\\ -u_{1,2} \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} -u_{1,1} - u_{1,2} + 2u_{2,2} \\\\ u_{1,1} - u_{1,2} \\end{pmatrix}$。\n\n**对于单元 $K_2 = [h,2h]$:**\n$\\mathbf{M}^e \\begin{pmatrix} \\dot{u}_{2,1} \\\\ \\dot{u}_{2,2} \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{2,1} \\\\ u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} \\hat{u}(h) \\\\ -\\hat{u}(2h) \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{2,1} \\\\ u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} u_{1,2} \\\\ -u_{2,2} \\end{pmatrix}$。\n右侧 (RHS) 是：\n$a \\frac{1}{2} \\begin{pmatrix} -u_{2,1}-u_{2,2} \\\\ u_{2,1}+u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} u_{1,2} \\\\ -u_{2,2} \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 2u_{1,2} - u_{2,1} - u_{2,2} \\\\ u_{2,1} - u_{2,2} \\end{pmatrix}$。\n\n全局半离散系统为 $\\mathbf{M} \\dot{\\mathbf{u}} = \\mathbf{R}_{glob} \\mathbf{u}$。\n全局质量矩阵 $\\mathbf{M}$ 是块对角矩阵：\n$$\n\\mathbf{M} = \\begin{pmatrix} \\mathbf{M}^e  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{M}^e \\end{pmatrix} = \\frac{h}{6} \\begin{pmatrix} 2  1  0  0 \\\\ 1  2  0  0 \\\\ 0  0  2  1 \\\\ 0  0  1  2 \\end{pmatrix}\n$$\n全局右侧矩阵 $\\mathbf{R}_{glob}$ 是：\n$$\n\\mathbf{R}_{glob} = \\frac{a}{2} \\begin{pmatrix} -1  -1  0  2 \\\\ 1  -1  0  0 \\\\ 0  2  -1  -1 \\\\ 0  0  1  -1 \\end{pmatrix}\n$$\n系统算子为 $\\mathcal{A} = \\mathbf{M}^{-1} \\mathbf{R}_{glob}$。质量矩阵的逆为：\n$$\n\\mathbf{M}^{-1} = \\frac{1}{h} \\begin{pmatrix} 4  -2  0  0 \\\\ -2  4  0  0 \\\\ 0  0  4  -2 \\\\ 0  0  -2  4 \\end{pmatrix}\n$$\n将矩阵相乘，我们得到 $\\mathcal{A}$：\n$$\n\\mathcal{A} = \\frac{1}{h} \\begin{pmatrix} 4  -2  0  0 \\\\ -2  4  0  0 \\\\ 0  0  4  -2 \\\\ 0  0  -2  4 \\end{pmatrix} \\frac{a}{2} \\begin{pmatrix} -1  -1  0  2 \\\\ 1  -1  0  0 \\\\ 0  2  -1  -1 \\\\ 0  0  1  -1 \\end{pmatrix} = \\frac{a}{h} \\begin{pmatrix} -3  -1  0  4 \\\\ 3  -1  0  -2 \\\\ 0  4  -3  -1 \\\\ 0  -2  3  -1 \\end{pmatrix}\n$$\n\n### 计算谱半径\n\n为了找到 $\\mathcal{A}$ 的特征值，我们分析其结构。由于周期性，特征向量必须是离散傅里叶模态。单元 $K_{e+1}$ 上的自由度与 $K_e$ 上的自由度通过一个相位因子 $e^{i\\kappa}$ 相关联，其中 $\\kappa = k \\Delta x$ 是无量纲波数。对于一个 $2$ 单元域，离散波数对应于整个周期 $L=2h$ 上的模态 $m=0,1$，给出物理波数 $k=0$ 和 $k=\\pi/h$。令 $\\mathbf{u}_e = (u_{e,1}, u_{e,2})^{\\top}$。周期性结构意味着 $\\mathbf{u}_2 = e^{ikh} \\mathbf{u}_1$。令 $\\mathbf{v} = \\mathbf{u}_1$。特征值问题 $\\mathcal{A}\\mathbf{u} = \\lambda \\mathbf{u}$ 解耦为 $2 \\times 2$ 的问题。令 $\\mathbf{A}' = \\frac{h}{a}\\mathcal{A}$。\n$$\n\\begin{pmatrix} -3  -1 \\\\ 3  -1 \\end{pmatrix} \\mathbf{v} + e^{ikh} \\begin{pmatrix} 0  4 \\\\ 0  -2 \\end{pmatrix} \\mathbf{v} = \\frac{h}{a} \\lambda \\mathbf{v}\n$$\n这给出了 $2 \\times 2$ 矩阵 $\\mathbf{A}_k$ 的特征值问题：\n$$\n\\mathbf{A}_k = \\begin{pmatrix} -3  -1 + 4e^{ikh} \\\\ 3  -1 - 2e^{ikh} \\end{pmatrix}\n$$\n$\\mathbf{A}'$ 的四个特征值是 $\\mathbf{A}_k$ 在 $k=0$ 和 $k=\\pi/h$ 时的特征值的并集。\n\n**情况 1：$k=0$ (常数模态)**\n$e^{ikh} = 1$。矩阵是 $\\mathbf{A}_0 = \\begin{pmatrix} -3  3 \\\\ 3  -3 \\end{pmatrix}$。\n特征方程是 $(-3-\\mu)^2 - 9 = 0$，给出 $\\mu+3=\\pm 3$。特征值为 $\\mu_1=0$ 和 $\\mu_2=-6$。\n\n**情况 2：$k=\\pi/h$ (交替模态)**\n$e^{ikh} = e^{i\\pi} = -1$。矩阵是 $\\mathbf{A}_{\\pi/h} = \\begin{pmatrix} -3  -5 \\\\ 3  1 \\end{pmatrix}$。\n特征方程是 $(-3-\\mu)(1-\\mu) - (3)(-5) = 0$，简化为 $\\mu^2 + 2\\mu + 12 = 0$。\n根是 $\\mu = \\frac{-2 \\pm \\sqrt{4-48}}{2} = -1 \\pm i\\sqrt{11}$。\n\n缩放后的矩阵 $\\mathbf{A}' = \\frac{h}{a}\\mathcal{A}$ 的特征值为 $\\{0, -6, -1+i\\sqrt{11}, -1-i\\sqrt{11}\\}$。\n$\\mathcal{A}$ 的特征值是这些值乘以 $\\frac{a}{h}$：\n$$\n\\lambda \\in \\left\\{ 0, -6\\frac{a}{h}, \\frac{a}{h}(-1+i\\sqrt{11}), \\frac{a}{h}(-1-i\\sqrt{11}) \\right\\}\n$$\n谱半径 $\\rho(\\mathcal{A})$ 是这些特征值模的最大值：\n- $|0|=0$\n- $|-6\\frac{a}{h}| = 6\\frac{a}{h}$\n- $|\\frac{a}{h}(-1 \\pm i\\sqrt{11})| = \\frac{a}{h}\\sqrt{(-1)^2 + (\\pm\\sqrt{11})^2} = \\frac{a}{h}\\sqrt{1+11} = \\frac{a}{h}\\sqrt{12}$\n\n我们比较 $6\\frac{a}{h}$ 和 $\\sqrt{12}\\frac{a}{h}$。由于 $6 = \\sqrt{36}$ 且 $\\sqrt{36} > \\sqrt{12}$，最大模为 $6\\frac{a}{h}$。\n\n算子 $\\mathcal{A}$ 的谱半径为 $\\rho(\\mathcal{A}) = 6\\frac{a}{h}$。",
            "answer": "$$\\boxed{6\\frac{a}{h}}$$"
        },
        {
            "introduction": "在掌握了线性方程的基础之后，下一个挑战是处理在海洋学中无处不在的非线性问题。本练习探讨了混淆（aliasing）这一概念，它是由谱方法中非线性项的不精确积分引起的一种误差。通过为一个三次通量项分析这一现象，你将更深刻地理解谱方法精度的微妙之处以及求积规则的重要性。",
            "id": "3790484",
            "problem": "考虑在参考单元 $[-1,1]$ 上的多项式次数为 $p$ 的一维谱元法 (SEM) 离散化，使用 Gauss–Lobatto–Legendre (GLL) 点上的拉格朗日插值多项式。设 $u(x)$ 是一个光滑标量场的次数为 $p$ 的节点插值，非线性通量为 $F(u)=u^3$。在守恒律的标准弱形式中，一个体积项的贡献由以下形式的积分表示\n$$\nI(\\varphi) \\equiv \\int_{-1}^{1} \\varphi_{x}(x)\\,F\\big(u(x)\\big)\\,\\mathrm{d}x,\n$$\n其中 $\\varphi(x)$ 是一个次数为 $p$ 的检验函数，$\\varphi_{x}(x)$ 表示其导数。假设插值多项式满足精确多项式代数。\n\n1. 仅利用以下事实：多项式的复合产生一个多项式，其次数是原多项式次数的乘积；次数为 $p$ 的多项式的导数次数为 $p-1$；以及一个求积法则精确当且仅当被积函数位于次数不大于该求积法则精确次数的多项式空间中。请确定对于三次通量 $F(u)=u^3$，积分 $I(\\varphi)$ 的被积函数中出现的最高多项式次数。判断一个精确到 $2p-1$ 次的 GLL 求积法则能否精确地计算 $I(\\varphi)$，并说明要精确积分此非线性体积项所需的最小精确次数。\n\n2. 现在，特化到 $p=2$ 的情况，并选择特定的检验函数 $\\varphi(x)=x$，因此 $\\varphi_x(x)=1$。设次数为 2 的插值多项式为 $u(x)=a+bx+cx^2$，其中 $a$、$b$ 和 $c$ 为实系数。在这种配置点设置下，将三次通量的混叠误差 $E$ 定义为精确积分与其 GLL 配置点近似之间的差值，其中三个节点位于 $x=-1,0,1$，对应的权重为 $w_{-1}=w_{1}=\\frac{1}{3}$，$w_{0}=\\frac{4}{3}$：\n$$\nE \\equiv \\int_{-1}^{1} u(x)^{3}\\,\\mathrm{d}x - \\left[\\frac{1}{3}\\,u(-1)^{3}+\\frac{4}{3}\\,u(0)^{3}+\\frac{1}{3}\\,u(1)^{3}\\right].\n$$\n推导 $E$ 关于 $a$、$b$ 和 $c$ 的封闭形式解析表达式。您的最终答案必须是单一的解析表达式。不要四舍五入，也不要包含单位。",
            "solution": "问题陈述已经过验证，被认为是合理的、适定的，并且在偏微分方程数值分析领域具有科学依据。我们可以开始进行正式求解。\n\n问题分为两部分。第一部分关注非线性积分项中多项式的次数以及标准求积法则的充分性。第二部分要求对一个特定情况计算显式的混叠误差。\n\n**第一部分：多项式次数分析**\n\n我们需要分析积分\n$$\nI(\\varphi) \\equiv \\int_{-1}^{1} \\varphi_{x}(x)\\,F\\big(u(x)\\big)\\,\\mathrm{d}x\n$$\n被积函数是两个函数的乘积：检验函数的导数 $\\varphi_x(x)$，以及在解的插值多项式上求值的非线性通量 $F(u(x))$。我们必须确定该被积函数的最高可能多项式次数。\n\n1.  **检验函数导数的次数：** 检验函数 $\\varphi(x)$ 是一个次数至多为 $p$ 的多项式。为了找到被积函数的最高次数，我们考虑 $\\varphi(x)$ 具有最大可能次数的情况，即 $\\deg(\\varphi) = p$。一个次数为 $p$ 的多项式的导数是一个次数为 $p-1$ 的多项式。因此，$\\varphi_x(x)$ 的最高可能次数是\n    $$\n    \\deg(\\varphi_x) = p-1.\n    $$\n\n2.  **通量项的次数：** 解的插值多项式 $u(x)$ 是一个次数为 $p$ 的多项式。非线性通量由 $F(u)=u^3$ 给出。当应用于多项式函数 $u(x)$ 时，得到 $F(u(x)) = (u(x))^3$。一个多项式的整数次幂的次数是原次数乘以该幂。因此，\n    $$\n    \\deg(F(u(x))) = \\deg((u(x))^3) = 3 \\cdot \\deg(u(x)) = 3p.\n    $$\n\n3.  **被积函数的次数：** 被积函数是 $\\varphi_x(x)$ 和 $F(u(x))$ 的乘积。多项式乘积的次数是它们次数的和。\n    $$\n    \\deg(\\varphi_x(x) \\, F(u(x))) = \\deg(\\varphi_x) + \\deg(F(u(x))) = (p-1) + 3p = 4p-1.\n    $$\n    被积函数中出现的最高多项式次数是 $4p-1$。\n\n4.  **GLL 求积法则的充分性：** 一个具有 $p+1$ 个节点的 Gauss–Lobatto–Legendre (GLL) 求积法则对于次数最高为 $2p-1$ 的多项式是精确的。为了使该求积法则能够精确地积分项 $I(\\varphi)$，被积函数的次数必须不大于该法则的精确次数。这要求：\n    $$\n    4p-1 \\le 2p-1\n    $$\n    该不等式简化为 $2p \\le 0$。由于多项式次数 $p$ 必须是一个非负整数，并且对于非平凡基函数有 $p \\ge 1$，这个条件永远不会被满足。因此，一个对 $2p-1$ 次多项式精确的 GLL 求积法则对于任何 $p \\ge 1$ 都**不能**精确地积分非线性体积项 $I(\\varphi)$。这种不精确积分是混叠误差的来源。\n\n5.  **所需的最小精确度：** 为了使一个求积法则能够精确地积分一个多项式被积函数，其精确次数必须至少等于该多项式的次数。因此，精确积分此非线性项所需的最小精确次数等于被积函数的次数，即 $4p-1$。\n\n**第二部分：混叠误差计算**\n\n我们现在特化到多项式次数为 $p=2$ 的情况。解的插值多项式由 $u(x) = a+bx+cx^2$ 给出。检验函数选择为 $\\varphi(x)=x$，因此 $\\varphi_x(x)=1$。所考虑的积分变为 $\\int_{-1}^1 u(x)^3\\,\\mathrm{d}x$。\n\n混叠误差 $E$ 被定义为精确积分与其 GLL 求积近似之间的差值。对于 $p=2$，GLL 法则使用 3 个节点，位于 $x \\in \\{-1, 0, 1\\}$，权重为 $w_{-1}=w_1 = \\frac{1}{3}$ 和 $w_0 = \\frac{4}{3}$。这等同于 Simpson 法则，该法则对次数最高为 $2p-1=2(2)-1=3$ 的多项式是精确的。\n\n误差为\n$$\nE \\equiv \\int_{-1}^{1} u(x)^{3}\\,\\mathrm{d}x - \\left[\\frac{1}{3}\\,u(-1)^{3}+\\frac{4}{3}\\,u(0)^{3}+\\frac{1}{3}\\,u(1)^{3}\\right].\n$$\n设 $I_{exact}$ 表示精确积分，$I_{quad}$ 表示求积近似。\n\n1.  **精确积分的计算 ($I_{exact}$):**\n    我们首先展开被积函数 $u(x)^3 = (a+bx+cx^2)^3$。\n    $$\n    u(x)^3 = c^3 x^6 + 3bc^2 x^5 + (3ac^2+3b^2c) x^4 + (b^3+6abc) x^3 + (3a^2c+3ab^2) x^2 + 3a^2b x + a^3.\n    $$\n    我们将此多项式从 $-1$ 积分到 $1$。在这个对称区间上，$x$ 的任何奇次幂的积分都为零。\n    $$\n    I_{exact} = \\int_{-1}^{1} \\left( c^3 x^6 + (3ac^2+3b^2c) x^4 + (3a^2c+3ab^2) x^2 + a^3 \\right) \\mathrm{d}x.\n    $$\n    使用公式 $\\int_{-1}^1 x^{2n} \\mathrm{d}x = \\frac{2}{2n+1}$：\n    $$\n    I_{exact} = c^3\\left(\\frac{2}{7}\\right) + (3ac^2+3b^2c)\\left(\\frac{2}{5}\\right) + (3a^2c+3ab^2)\\left(\\frac{2}{3}\\right) + a^3(2).\n    $$\n    $$\n    I_{exact} = \\frac{2}{7}c^3 + \\frac{6}{5}(ac^2+b^2c) + 2(a^2c+ab^2) + 2a^3.\n    $$\n    $$\n    I_{exact} = 2a^3 + 2ab^2 + 2a^2c + \\frac{6}{5}ac^2 + \\frac{6}{5}b^2c + \\frac{2}{7}c^3.\n    $$\n\n2.  **求积近似的计算 ($I_{quad}$):**\n    我们在求积节点 $x \\in \\{-1, 0, 1\\}$ 处计算 $u(x)$ 的值：\n    $$\n    u(-1) = a - b + c\n    $$\n    $$\n    u(0) = a\n    $$\n    $$\n    u(1) = a + b + c\n    $$\n    将这些值代入求积公式：\n    $$\n    I_{quad} = \\frac{1}{3}(a-b+c)^3 + \\frac{4}{3}a^3 + \\frac{1}{3}(a+b+c)^3.\n    $$\n    我们使用恒等式 $(X-Y)^3 + (X+Y)^3 = 2X^3 + 6XY^2$。令 $X = a+c$ 且 $Y=b$。\n    $$\n    (a+c-b)^3 + (a+c+b)^3 = 2(a+c)^3 + 6(a+c)b^2.\n    $$\n    所以，\n    $$\n    I_{quad} = \\frac{1}{3}\\left[ 2(a+c)^3 + 6(a+c)b^2 \\right] + \\frac{4}{3}a^3.\n    $$\n    $$\n    I_{quad} = \\frac{2}{3}(a+c)^3 + 2(a+c)b^2 + \\frac{4}{3}a^3.\n    $$\n    展开 $(a+c)^3 = a^3+3a^2c+3ac^2+c^3$：\n    $$\n    I_{quad} = \\frac{2}{3}(a^3+3a^2c+3ac^2+c^3) + 2ab^2 + 2b^2c + \\frac{4}{3}a^3.\n    $$\n    $$\n    I_{quad} = \\frac{2}{3}a^3 + 2a^2c + 2ac^2 + \\frac{2}{3}c^3 + 2ab^2 + 2b^2c + \\frac{4}{3}a^3.\n    $$\n    合并各项：\n    $$\n    I_{quad} = \\left(\\frac{2}{3}+\\frac{4}{3}\\right)a^3 + 2ab^2 + 2a^2c + 2ac^2 + 2b^2c + \\frac{2}{3}c^3.\n    $$\n    $$\n    I_{quad} = 2a^3 + 2ab^2 + 2a^2c + 2ac^2 + 2b^2c + \\frac{2}{3}c^3.\n    $$\n\n3.  **混叠误差的计算 ($E$):**\n    误差为 $E = I_{exact} - I_{quad}$。从 $I_{exact}$ 的表达式中减去 $I_{quad}$ 的表达式：\n    $$\n    E = \\left(2a^3 + 2ab^2 + 2a^2c + \\frac{6}{5}ac^2 + \\frac{6}{5}b^2c + \\frac{2}{7}c^3\\right) - \\left(2a^3 + 2ab^2 + 2a^2c + 2ac^2 + 2b^2c + \\frac{2}{3}c^3\\right).\n    $$\n    项 $2a^3$、$2ab^2$ 和 $2a^2c$ 被消去。\n    $$\n    E = \\left(\\frac{6}{5}ac^2 - 2ac^2\\right) + \\left(\\frac{6}{5}b^2c - 2b^2c\\right) + \\left(\\frac{2}{7}c^3 - \\frac{2}{3}c^3\\right).\n    $$\n    $$\n    E = ac^2\\left(\\frac{6}{5} - \\frac{10}{5}\\right) + b^2c\\left(\\frac{6}{5} - \\frac{10}{5}\\right) + c^3\\left(\\frac{6}{21} - \\frac{14}{21}\\right).\n    $$\n    $$\n    E = -\\frac{4}{5}ac^2 - \\frac{4}{5}b^2c - \\frac{8}{21}c^3.\n    $$\n    这就是混叠误差的封闭形式解析表达式。",
            "answer": "$$\n\\boxed{-\\frac{4}{5}ac^2 - \\frac{4}{5}b^2c - \\frac{8}{21}c^3}\n$$"
        },
        {
            "introduction": "除了基本的实现，对DG方法的深入应用还涉及利用其独特的性质。本练习聚焦于超收敛（superconvergence）现象，即数值解在单元内的特定点上表现出异常高的精度。你不仅将学会如何识别这些点，还将设计一种实用的后处理技术，利用这种高精度来更准确地估计物理参数，例如波速。",
            "id": "3790452",
            "problem": "考虑一个直通道中的小振幅正压表面高程的一维、周期性、线性平流模型，其方程为 $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $，定义在 $ x \\in [0,L] $ 上，其中常数波速 $ c > 0 $ 未知。假设初始条件为单个傅里叶模态 $ \\eta(x,0) = \\exp(i k x) $，其中 $ k = 2 \\pi m / L $，$ m \\geq 1 $ 为某个整数。其解为 $ \\eta(x,t) = \\exp(i (k x - \\omega t)) $，其中 $ \\omega = c k $。场 $ \\eta $ 代表一个被动线性信号，其速度由背景静水力平衡 $ c = \\sqrt{g H} $ 决定（其中 $ H $ 为深度），但在本练习中，$ c $ 是未知的，必须通过数值方法进行估计。\n\n使用多项式阶数为 $ r \\geq 0 $ 的间断伽辽金(DG)谱元法在包含 $ N_{e} $ 个单元的均匀网格上对该模型进行离散化，单元大小为 $ h = L / N_{e} $。每个单元内采用勒让德-高斯-洛巴托节点基，通过仿射映射将参考坐标 $ \\xi \\in [-1,1] $ 映射到物理坐标 $ x $。在所有交界面上使用标准迎风数值通量。将DG半离散解记为 $ \\eta_{h}(x,t) $，并将其在单元 $ j $ 内部于右侧（顺风）交界面上的迹记为 $ \\eta_{h}(x_{j+1/2}^{-},t) $，其中 $ x_{j+1/2} $ 是单元 $ j $ 右侧交界面的位置。\n\n在DG文献中，经验观察表明，对于使用迎风通量的线性平流问题，在顺风点上对 $ \\eta_{h} $ 的求值相比于一般内部点表现出更高的精度（超收敛）。在本问题中，你将分析超收敛点，并设计一种后处理方法，以提高对给定傅里叶信号的波速估计的精度。\n\n任务：\n1. 从带有迎风数值通量的线性平流问题的DG弱形式以及勒让德多项式的正交性出发，分析单元内 $ \\eta_{h} $ 的点态误差结构。识别并证明参考单元 $ \\xi \\in [-1,1] $ 中超收敛点的位置，并说明这是迎风通量和多项式基函数结构所导致的结果。特别地，解释为什么顺风边界点 $ \\xi = +1 $ 是超收敛的，并以 $ h $ 和 $ r $ 的形式，给出在时间精确积分的半离散格式下该点点态误差的主阶。\n\n2. 利用在顺风节点处已识别的超收敛性，构建一个后处理的全局复诊断量\n$$\nZ(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2}),\n$$\n并解释 $ Z(t) $ 如何分离出傅里叶模态的时间相位。然后，对于给定的 $ \\Delta t > 0 $，使用两个时间样本 $ Z(t) $ 和 $ Z(t+\\Delta t) $，为真实波速 $ c $ 的后处理估计量 $ \\widehat{c} $ 推导一个闭式解析表达式。确保你的推导从控制平流模型和DG结构出发，且仅引用关于傅里叶模态输运和多项式逼近的已充分验证的结论。你的估计量必须直接使用 $ Z(t) $ 中包含的顺风节点超收敛信息。\n\n最终答案需以 $ k $、$ \\Delta t $ 和顺风节点的DG解样本表示的单个闭式解析表达式形式给出。波速以 $ \\mathrm{m} \\, \\mathrm{s}^{-1} $ 为单位。不要求进行数值计算。不要在最终的方框表达式内包含单位。不要求进行四舍五入。",
            "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   **控制方程：** $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $\n-   **定义域：** $ x \\in [0,L] $，周期性。\n-   **波速：** 常数 $ c > 0 $，未知。\n-   **初始条件：** $ \\eta(x,0) = \\exp(i k x) $\n-   **波数：** $ k = 2 \\pi m / L $，其中 $ m \\geq 1 $ 为某个整数。\n-   **精确解：** $ \\eta(x,t) = \\exp(i (k x - \\omega t)) $，其中 $ \\omega = c k $。\n-   **物理背景：** $ c = \\sqrt{g H} $。\n-   **数值方法：** 间断伽辽金(DG)谱元法。\n    -   多项式阶数：$ r \\geq 0 $。\n    -   网格：包含 $ N_{e} $ 个单元的均匀网格。\n    -   单元大小：$ h = L / N_{e} $。\n    -   基函数：参考单元 $ \\xi \\in [-1,1] $ 上的勒让德-高斯-洛巴托(LGL)节点基。\n    -   数值通量：迎风通量。\n-   **记号：**\n    -   DG解：$ \\eta_{h}(x,t) $。\n    -   单元 $ j $ 内部在右侧交界面上的迹：$ \\eta_{h}(x_{j+1/2}^{-},t) $。\n-   **前提：** 在顺风点上对 $ \\eta_{h} $ 的求值表现出超收敛性。\n-   **任务：**\n    1.  分析并证明超收敛点的位置，特别是 $ \\xi = +1 $，并陈述其在半离散格式下点态误差的主阶。\n    2.  构造一个后处理诊断量 $ Z(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2}) $，并用它在 $ t $ 和 $ t+\\Delta t $ 时刻的样本推导波速 $ c $ 的闭式估计量 $ \\widehat{c} $。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据充分：** 该问题基于线性平流方程（波物理学的基石）和间断伽辽金法（计算科学中一种成熟而强大的数值技术）。超收敛概念是DG方法中一个已知且经过严格研究的现象。该问题在科学上和数学上都是合理的。\n-   **良态的：** 该问题定义明确。它要求基于数值方法的已知性质进行定性分析，并推导一个特定公式。任务清晰，能导出一个唯一的解析结果。\n-   **客观的：** 该问题以精确、正式且无偏见的语言陈述。所有术语都在偏微分方程数值分析的背景下定义。\n-   **完整性和一致性：** 该问题提供了进行分析和推导所需的所有必要信息。其设置是自洽且内部一致的。\n-   **可行性和现实性：** 物理模型和数值设置在计算海洋学和流体动力学中是标准的。所需的分析在数值方法研究中也是标准的。\n-   **结构及其他标准：** 该问题结构逻辑清晰，具有非平凡性，并且可以在数值分析的原则下进行验证。\n\n**步骤3：结论与行动**\n该问题被判定为 **有效**。将提供一个完整、有理有据的解答。\n\n### 解答\n\n按照要求，本问题分两部分解答。第一部分分析线性平流问题中DG方法的超收敛性质。第二部分利用这一性质构造一个高精度的波速估计量。\n\n**第一部分：超收敛分析**\n\n对于线性平流方程 $ \\partial_{t} \\eta + c \\, \\partial_{x} \\eta = 0 $（其中 $ c > 0 $），其在一个单元 $ K_j = [x_{j-1/2}, x_{j+1/2}] $ 上的半离散间断伽辽金(DG)格式，是通过将方程乘以一个取自多项式空间 $ P^r(K_j) $ 的检验函数 $ v_h $ 并在该单元上积分得到的。对空间项进行分部积分后，我们得到：\n$$ \\int_{K_j} (\\partial_t \\eta_h) v_h \\, dx - \\int_{K_j} c \\eta_h (\\partial_x v_h) \\, dx + c \\left[ \\eta_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0 \\quad \\forall v_h \\in P^r(K_j) $$\n此处，$ \\eta_h $ 是 $ \\eta $ 在 $ K_j $ 中的多项式逼近，而 $ \\eta_h^* $ 是单元交界面上的数值通量。问题指定了迎风通量。由于 $ c > 0 $，信息从左向右传播。因此，迎风通量是解在每个交界面迎风（左）侧的迹：$ \\eta_h^*(x) = \\lim_{\\epsilon \\to 0^+} \\eta_h(x-\\epsilon) $。边界项变为：\n$$ c \\left[ \\eta_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = c \\, \\eta_h(x_{j+1/2}^{-}) v_h(x_{j+1/2}^{-}) - c \\, \\eta_h(x_{j-1/2}^{-}) v_h(x_{j-1/2}^{+}) $$\nDG方法的误差 $ e_h = \\eta_h - \\eta $ 由该格式的性质决定。在DG方法对线性平流问题的分析中，一个公认的结论是点态误差在单元内的行为不是均匀的。具体而言，误差结构受平流方向和多项式基的选择影响。\n\n对于在参考单元 $ \\xi \\in [-1,1] $ 上由勒让德多项式构成的基，单元内一点 $ x(\\xi) $ 处的误差 $ e_h $ 的主项依赖于精确解的 $(r+1)$ 阶导数和一个特定的 $ r+1 $ 阶多项式。理论分析表明，对于稳态问题，该多项式部分正比于 $ L_{r+1}(\\xi) - L_r(\\xi) $，其中 $ L_k $ 是 $ k $ 阶勒让德多项式。\n\n当这个主误差项为零时，就会出现超收敛。我们考察这个多项式在参考单元端点 $ \\xi = \\pm 1 $ 处的值。\n-   在顺风边界 $ \\xi = +1 $ 处，我们使用性质 $ L_k(1) = 1 $（对所有 $ k \\geq 0 $）。误差多项式的值为 $ L_{r+1}(1) - L_r(1) = 1 - 1 = 0 $。主 $ O(h^{r+1}) $ 误差项的这种抵消表明点 $ \\xi = +1 $ 是一个超收敛点。\n-   在迎风边界 $ \\xi = -1 $ 处，我们使用性质 $ L_k(-1) = (-1)^k $。误差多项式为 $ L_{r+1}(-1) - L_r(-1) = (-1)^{r+1} - (-1)^r = -2(-1)^r \\neq 0 $。在迎风边界没有发生类似的抵消。\n\n主误差项在顺风边界处消失，意味着该处的误差阶数更高。虽然上述使用 $ L_{r+1} - L_r $ 的启发式方法来自稳态分析，但对时间精确积分的时变问题（即半离散情况）的更严格分析证实了这一现象。对于应用于线性平流方程的 $ r $ 阶多项式DG方法，一般内部点的点态误差为 $ O(h^{r+1}) $，但在顺风边界节点（对应于 $ \\xi = +1 $）处，误差要高一阶。\n\n因此，超收敛的位置是每个单元的顺风边界，即 $ \\xi=+1 $。对于半离散格式，该点点态误差的主阶为 $\\boldsymbol{O(h^{r+2})}$。\n\n**第二部分：波速估计量**\n\n我们被要求使用一个后处理诊断量 $ Z(t) $ 来构造波速 $ c $ 的估计量 $ \\widehat{c} $，该诊断量使用超收敛的顺风节点值定义：\n$$\nZ(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\, \\exp(-i k x_{j+1/2})\n$$\n这个诊断量的目的是分离出传播的傅里叶模态的时间分量。为了理解这一点，让我们考虑如果我们使用精确解 $ \\eta(x,t) = \\exp(i(kx - \\omega t)) $，$ Z(t) $ 会是什么：\n$$ Z_{\\text{exact}}(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\eta(x_{j+1/2},t) \\, \\exp(-i k x_{j+1/2}) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\exp(i(k x_{j+1/2} - \\omega t)) \\, \\exp(-i k x_{j+1/2}) $$\n$$ Z_{\\text{exact}}(t) = \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} \\exp(-i \\omega t) = \\frac{1}{N_{e}} (N_e \\exp(-i \\omega t)) = \\exp(-i \\omega t) $$\n数值诊断量 $ Z(t) $ 是 $ \\exp(-i \\omega t) $ 的一个近似。这个近似的精度取决于数值解 $ \\eta_h $ 在采样点处的误差。由于我们是在顺风节点 $ x_{j+1/2}^{-} $ 处采样，该处的点态误差是 $ O(h^{r+2}) $ 阶超收敛的，我们有：\n$$ \\eta_h(x_{j+1/2}^{-}, t) = \\eta(x_{j+1/2}, t) + O(h^{r+2}) $$\n将此代入 $ Z(t) $ 的定义中，得到：\n$$ Z(t) = Z_{\\text{exact}}(t) + \\frac{1}{N_{e}} \\sum_{j=1}^{N_{e}} O(h^{r+2}) \\exp(-i k x_{j+1/2}) = \\exp(-i \\omega t) + O(h^{r+2}) $$\n因此，$ Z(t) $ 是解的时间相位因子的一个非常精确的近似。我们可以用它来估计 $ \\omega $。给定两个样本 $ Z(t) $ 和 $ Z(t+\\Delta t) $，我们可以计算它们的比值：\n$$ \\frac{Z(t+\\Delta t)}{Z(t)} \\approx \\frac{\\exp(-i \\omega (t+\\Delta t))}{\\exp(-i \\omega t)} = \\exp(-i \\omega \\Delta t) $$\n右边的复数模为 $ 1 $，相位（辐角）为 $ -\\omega \\Delta t $。因此，我们可以通过取数值诊断量之比的辐角来提取 $ \\omega $。令 $ \\widehat{\\omega} $ 为我们对 $ \\omega $ 的估计。\n$$ \\arg\\left( \\frac{Z(t+\\Delta t)}{Z(t)} \\right) \\approx -\\widehat{\\omega} \\Delta t $$\n复数 $ z $ 的辐角可以写成其自然对数的虚部，即 $ \\arg(z) = \\mathrm{Im}(\\ln(z)) $，其中 $ \\ln $ 表示复对数的主值。这给出了 $ \\widehat{\\omega} $ 的一个表达式：\n$$ \\widehat{\\omega} = -\\frac{1}{\\Delta t} \\mathrm{Im}\\left( \\ln\\left( \\frac{Z(t+\\Delta t)}{Z(t)} \\right) \\right) $$\n问题要求的是波速 $ c $ 的估计量。使用精确色散关系 $ \\omega = c k $，我们对 $ c $ 的估计量为 $ \\widehat{c} = \\widehat{\\omega} / k $。代入 $ \\widehat{\\omega} $ 的表达式和 $ Z(t) $ 的定义，便得到 $ \\widehat{c} $ 的最终闭式表达式：\n$$ \\widehat{c} = -\\frac{1}{k \\Delta t} \\mathrm{Im}\\left[ \\ln\\left( \\frac{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t+\\Delta t) \\exp(-i k x_{j+1/2})}{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\exp(-i k x_{j+1/2})} \\right) \\right] $$\n这个 $ c $ 的估计量是按要求直接由DG解在超收敛的顺风节点处的样本构造的。",
            "answer": "$$ \\boxed{- \\frac{1}{k \\Delta t} \\mathrm{Im}\\left( \\ln\\left( \\frac{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t+\\Delta t) \\exp(-i k x_{j+1/2})}{\\sum_{j=1}^{N_{e}} \\eta_{h}(x_{j+1/2}^{-},t) \\exp(-i k x_{j+1/2})} \\right) \\right)} $$"
        }
    ]
}