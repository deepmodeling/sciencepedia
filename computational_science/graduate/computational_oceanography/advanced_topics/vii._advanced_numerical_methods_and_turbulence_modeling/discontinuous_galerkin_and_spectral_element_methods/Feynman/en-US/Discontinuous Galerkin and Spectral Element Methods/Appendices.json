{
    "hands_on_practices": [
        {
            "introduction": "Building a numerical model starts with understanding its fundamental components. This exercise strips the Discontinuous Galerkin (DG) method down to its essential building blocks for the linear advection equation, $u_t + a u_x = 0$. By manually constructing the semi-discrete system matrix for a polynomial degree of $p=1$, you will gain a concrete understanding of how local element matrices and inter-element numerical fluxes combine to form the global operator . This foundational skill is crucial for debugging, analyzing, and extending DG codes.",
            "id": "4031827",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a  0$ on the periodic domain $[0,2h]$, partitioned into $2$ uniform elements $K_{1} = [0,h]$ and $K_{2} = [h,2h]$. On each element $K_{e}$, use a Discontinuous Galerkin (DG) discretization of polynomial degree $p=1$ with the local nodal (Lagrange) basis $\\{\\psi_{e,1},\\psi_{e,2}\\}$ defined by $\\psi_{e,1}(x_{e-1/2})=1$, $\\psi_{e,1}(x_{e+1/2})=0$, $\\psi_{e,2}(x_{e-1/2})=0$, and $\\psi_{e,2}(x_{e+1/2})=1$, where $x_{e-1/2}$ and $x_{e+1/2}$ are the left and right endpoints of $K_{e}$, respectively. Use the standard weak DG form obtained by integrating by parts once on each element, exact quadrature for all integrals, and the upwind numerical flux for $a0$, namely $\\hat{u}$ at any interface equals the left trace. Impose periodic boundary conditions at $x=0$ and $x=2h$.\n\nLet the semi-discrete DG approximation be $u_{h}(x,t)\\big|_{K_{e}}=\\sum_{j=1}^{2}u_{e,j}(t)\\,\\psi_{e,j}(x)$, and collect the degrees of freedom into the vector $\\mathbf{u}(t) = \\big(u_{1,1}(t),u_{1,2}(t),u_{2,1}(t),u_{2,2}(t)\\big)^{\\top}$. \n\nTasks:\n- Starting from the DG weak form, derive the element-level mass and volume terms and the numerical flux contributions, and assemble the explicit semi-discrete $4\\times 4$ linear system $\\dot{\\mathbf{u}} = \\mathcal{A}\\,\\mathbf{u}$ under the stated upwind flux and periodicity.\n- For this two-element periodic system, compute the spectral radius $\\rho(\\mathcal{A})$ of the semi-discrete spatial operator as a closed-form expression in terms of $a$ and $h$.\n\nProvide your final answer as a single closed-form expression for $\\rho(\\mathcal{A})$ in terms of $a$ and $h$. No rounding is required and no units should be included in the final answer.",
            "solution": "The user wants me to solve the problem by following these steps:\n\n1.  **Validate the problem:** The problem statement is scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in the numerical analysis of partial differential equations, specifically focusing on the Discontinuous Galerkin (DG) method. All required information is provided, and there are no contradictions or ambiguities. The problem is valid.\n\n2.  **Provide a solution:**\n    *   I will start by deriving the semi-discrete system, including elemental matrices and flux contributions.\n    *   Then, I will assemble the global $4 \\times 4$ system matrix.\n    *   Finally, I will compute the eigenvalues of this matrix to find its spectral radius.\n\n### Derivation of the Semi-Discrete System\n\nThe problem considers the linear advection equation $u_{t} + a\\,u_{x} = 0$ with $a  0$. The Discontinuous Galerkin (DG) weak formulation on an element $K_e$ is obtained by multiplying the PDE by a test function $v_h$ from the same polynomial space as the trial function $u_h$, integrating over $K_e$, and applying integration by parts to the spatial derivative term:\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx - a \\int_{K_e} u_h \\frac{\\partial v_h}{\\partial x} \\,dx + [a\\, u_h v_h]_{x_{e-1/2}}^{x_{e+1/2}} = 0\n$$\nThe boundary term is replaced by numerical fluxes, leading to:\n$$\n\\int_{K_e} \\frac{\\partial u_h}{\\partial t} v_h \\,dx = a \\int_{K_e} u_h \\frac{\\partial v_h}{\\partial x} \\,dx - a \\hat{u}(x_{e+1/2}) v_h(x_{e+1/2}^{-}) + a \\hat{u}(x_{e-1/2}) v_h(x_{e-1/2}^{+})\n$$\nwhere $x_{e-1/2}$ and $x_{e+1/2}$ are the left and right endpoints of element $K_e$, and $\\hat{u}$ is the numerical flux.\n\nThe solution on element $K_e$ is approximated as $u_h(x,t) = \\sum_{j=1}^{2} u_{e,j}(t) \\psi_{e,j}(x)$, where $\\{\\psi_{e,j}\\}$ is the local nodal basis of degree $p=1$. On a uniform element of length $h$, we can define local coordinates $x' = x - x_{e-1/2} \\in [0, h]$. The basis functions are linear polynomials:\n$$\n\\psi_{e,1}(x') = 1 - \\frac{x'}{h}, \\quad \\psi_{e,2}(x') = \\frac{x'}{h}\n$$\nTheir derivatives are:\n$$\n\\frac{d\\psi_{e,1}}{dx} = -\\frac{1}{h}, \\quad \\frac{d\\psi_{e,2}}{dx} = \\frac{1}{h}\n$$\nChoosing the test functions $v_h$ to be the basis functions $\\psi_{e,i}$, we obtain an element-wise system of ordinary differential equations (ODEs):\n$$\n\\mathbf{M}^e \\dot{\\mathbf{u}}_e = a \\mathbf{S}^e \\mathbf{u}_e + \\mathbf{F}^e\n$$\nwhere $\\mathbf{u}_e(t) = (u_{e,1}(t), u_{e,2}(t))^{\\top}$. The element mass matrix $\\mathbf{M}^e$ and stiffness matrix $\\mathbf{S}^e$ have components:\n$M^e_{ij} = \\int_{K_e} \\psi_{e,j} \\psi_{e,i} \\,dx$ and $S^e_{ij} = \\int_{K_e} \\psi_{e,j} \\frac{d\\psi_{e,i}}{dx} \\,dx$. Exact integration yields:\n$$\n\\mathbf{M}^e = \\int_0^h \\begin{pmatrix} (1-\\frac{x'}{h})^2  \\frac{x'}{h}(1-\\frac{x'}{h}) \\\\ \\frac{x'}{h}(1-\\frac{x'}{h})  (\\frac{x'}{h})^2 \\end{pmatrix} dx' = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\n\\mathbf{S}^e = \\int_0^h \\begin{pmatrix} (1-\\frac{x'}{h})(-\\frac{1}{h})  \\frac{x'}{h}(-\\frac{1}{h}) \\\\ (1-\\frac{x'}{h})(\\frac{1}{h})  \\frac{x'}{h}(\\frac{1}{h}) \\end{pmatrix} dx' = \\frac{1}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}\n$$\nThe flux vector $\\mathbf{F}^e$ for test functions $\\psi_{e,i}$ is:\n$$\nF^e_i = -a \\hat{u}(x_{e+1/2}) \\psi_{e,i}(x_{e+1/2}) + a \\hat{u}(x_{e-1/2}) \\psi_{e,i}(x_{e-1/2})\n$$\nFor $i=1$, $\\psi_{e,1}(x_{e-1/2})=1, \\psi_{e,1}(x_{e+1/2})=0$, so $F^e_1 = a \\hat{u}(x_{e-1/2})$.\nFor $i=2$, $\\psi_{e,2}(x_{e-1/2})=0, \\psi_{e,2}(x_{e+1/2})=1$, so $F^e_2 = -a \\hat{u}(x_{e+1/2})$.\nThus, $\\mathbf{F}^e = a \\begin{pmatrix} \\hat{u}(x_{e-1/2}) \\\\ -\\hat{u}(x_{e+1/2}) \\end{pmatrix}$.\n\n### Assembling the Global System\n\nThe domain $[0, 2h]$ is split into $K_1=[0,h]$ and $K_2=[h,2h]$. The global vector of degrees of freedom is $\\mathbf{u} = (u_{1,1}, u_{1,2}, u_{2,1}, u_{2,2})^{\\top}$. The problem specifies upwind flux for $a0$, so $\\hat{u}=u^{-}$, and periodic boundary conditions.\n- At the interface $x=h$: $\\hat{u}(h) = u^{-}(h) = u_h(h)|_{K_1} = u_{1,2}$.\n- At the interface $x=0 \\equiv 2h$: Periodicity implies the state \"left\" of $x=0$ is the state at $x=2h$. Thus, $\\hat{u}(0) = u^{-}(0) = u_h(2h)|_{K_2} = u_{2,2}$. The flux at $x=2h$ is also $\\hat{u}(2h) = u_h(2h)|_{K_2} = u_{2,2}$.\n\n**For element $K_1 = [0,h]$:**\n$\\mathbf{M}^e \\begin{pmatrix} \\dot{u}_{1,1} \\\\ \\dot{u}_{1,2} \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{1,1} \\\\ u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} \\hat{u}(0) \\\\ -\\hat{u}(h) \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{1,1} \\\\ u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} u_{2,2} \\\\ -u_{1,2} \\end{pmatrix}$.\nThe right-hand side (RHS) is:\n$a \\frac{1}{2} \\begin{pmatrix} -u_{1,1}-u_{1,2} \\\\ u_{1,1}+u_{1,2} \\end{pmatrix} + a \\begin{pmatrix} u_{2,2} \\\\ -u_{1,2} \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} -u_{1,1} - u_{1,2} + 2u_{2,2} \\\\ u_{1,1} - u_{1,2} \\end{pmatrix}$.\n\n**For element $K_2 = [h,2h]$:**\n$\\mathbf{M}^e \\begin{pmatrix} \\dot{u}_{2,1} \\\\ \\dot{u}_{2,2} \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{2,1} \\\\ u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} \\hat{u}(h) \\\\ -\\hat{u}(2h) \\end{pmatrix} = a \\mathbf{S}^e \\begin{pmatrix} u_{2,1} \\\\ u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} u_{1,2} \\\\ -u_{2,2} \\end{pmatrix}$.\nThe RHS is:\n$a \\frac{1}{2} \\begin{pmatrix} -u_{2,1}-u_{2,2} \\\\ u_{2,1}+u_{2,2} \\end{pmatrix} + a \\begin{pmatrix} u_{1,2} \\\\ -u_{2,2} \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 2u_{1,2} - u_{2,1} - u_{2,2} \\\\ u_{2,1} - u_{2,2} \\end{pmatrix}$.\n\nThe global semi-discrete system is $\\mathbf{M} \\dot{\\mathbf{u}} = \\mathbf{R}_{glob} \\mathbf{u}$.\nThe global mass matrix $\\mathbf{M}$ is block-diagonal:\n$$\n\\mathbf{M} = \\begin{pmatrix} \\mathbf{M}^e  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{M}^e \\end{pmatrix} = \\frac{h}{6} \\begin{pmatrix} 2  1  0  0 \\\\ 1  2  0  0 \\\\ 0  0  2  1 \\\\ 0  0  1  2 \\end{pmatrix}\n$$\nThe global RHS matrix $\\mathbf{R}_{glob}$ is:\n$$\n\\mathbf{R}_{glob} = \\frac{a}{2} \\begin{pmatrix} -1  -1  0  2 \\\\ 1  -1  0  0 \\\\ 0  2  -1  -1 \\\\ 0  0  1  -1 \\end{pmatrix}\n$$\nThe system operator is $\\mathcal{A} = \\mathbf{M}^{-1} \\mathbf{R}_{glob}$. The inverse of the mass matrix is:\n$$\n\\mathbf{M}^{-1} = \\frac{1}{h} \\begin{pmatrix} 4  -2  0  0 \\\\ -2  4  0  0 \\\\ 0  0  4  -2 \\\\ 0  0  -2  4 \\end{pmatrix}\n$$\nMultiplying the matrices, we get $\\mathcal{A}$:\n$$\n\\mathcal{A} = \\frac{1}{h} \\begin{pmatrix} 4  -2  0  0 \\\\ -2  4  0  0 \\\\ 0  0  4  -2 \\\\ 0  0  -2  4 \\end{pmatrix} \\frac{a}{2} \\begin{pmatrix} -1  -1  0  2 \\\\ 1  -1  0  0 \\\\ 0  2  -1  -1 \\\\ 0  0  1  -1 \\end{pmatrix} = \\frac{a}{h} \\begin{pmatrix} -3  -1  0  4 \\\\ 3  -1  0  -2 \\\\ 0  4  -3  -1 \\\\ 0  -2  3  -1 \\end{pmatrix}\n$$\n\n### Computing the Spectral Radius\n\nTo find the eigenvalues of $\\mathcal{A}$, we analyze its structure. Due to periodicity, the eigenvectors must be discrete Fourier modes. The degrees of freedom on element $K_{e+1}$ are related to those on $K_e$ by a phase factor $e^{i\\kappa}$, where $\\kappa = k \\Delta x$ is the dimensionless wavenumber. For a $2$-element domain, the discrete wavenumbers correspond to modes $m=0,1$ over the full period $L=2h$, giving physical wavenumbers $k=0$ and $k=\\pi/h$. Let $\\mathbf{u}_e = (u_{e,1}, u_{e,2})^{\\top}$. The periodic structure implies that $\\mathbf{u}_2 = e^{ikh} \\mathbf{u}_1$. Let $\\mathbf{v} = \\mathbf{u}_1$. The eigenvalue problem $\\mathcal{A}\\mathbf{u} = \\lambda \\mathbf{u}$ decouples into $2 \\times 2$ problems. Let $\\mathbf{A}' = \\frac{h}{a}\\mathcal{A}$.\n$$\n\\begin{pmatrix} -3  -1 \\\\ 3  -1 \\end{pmatrix} \\mathbf{v} + e^{ikh} \\begin{pmatrix} 0  4 \\\\ 0  -2 \\end{pmatrix} \\mathbf{v} = \\frac{h}{a} \\lambda \\mathbf{v}\n$$\nThis gives the eigenvalue problem for the $2 \\times 2$ matrix $\\mathbf{A}_k$:\n$$\n\\mathbf{A}_k = \\begin{pmatrix} -3  -1 + 4e^{ikh} \\\\ 3  -1 - 2e^{ikh} \\end{pmatrix}\n$$\nThe four eigenvalues of $\\mathbf{A}'$ are the union of the eigenvalues of $\\mathbf{A}_k$ for $k=0$ and $k=\\pi/h$.\n\n**Case 1: $k=0$ (constant mode)**\n$e^{ikh} = 1$. The matrix is $\\mathbf{A}_0 = \\begin{pmatrix} -3  3 \\\\ 3  -3 \\end{pmatrix}$.\nThe characteristic equation is $(-3-\\mu)^2 - 9 = 0$, giving $\\mu+3=\\pm 3$. The eigenvalues are $\\mu_1=0$ and $\\mu_2=-6$.\n\n**Case 2: $k=\\pi/h$ (alternating mode)**\n$e^{ikh} = e^{i\\pi} = -1$. The matrix is $\\mathbf{A}_{\\pi/h} = \\begin{pmatrix} -3  -5 \\\\ 3  1 \\end{pmatrix}$.\nThe characteristic equation is $(-3-\\mu)(1-\\mu) - (3)(-5) = 0$, which simplifies to $\\mu^2 + 2\\mu + 12 = 0$.\nThe roots are $\\mu = \\frac{-2 \\pm \\sqrt{4-48}}{2} = -1 \\pm i\\sqrt{11}$.\n\nThe eigenvalues of the scaled matrix $\\mathbf{A}' = \\frac{h}{a}\\mathcal{A}$ are $\\{0, -6, -1+i\\sqrt{11}, -1-i\\sqrt{11}\\}$.\nThe eigenvalues of $\\mathcal{A}$ are $\\frac{a}{h}$ times these values:\n$$\n\\lambda \\in \\left\\{ 0, -6\\frac{a}{h}, \\frac{a}{h}(-1+i\\sqrt{11}), \\frac{a}{h}(-1-i\\sqrt{11}) \\right\\}\n$$\nThe spectral radius $\\rho(\\mathcal{A})$ is the maximum of the moduli of these eigenvalues:\n- $|0|=0$\n- $|-6\\frac{a}{h}| = 6\\frac{a}{h}$\n- $|\\frac{a}{h}(-1 \\pm i\\sqrt{11})| = \\frac{a}{h}\\sqrt{(-1)^2 + (\\pm\\sqrt{11})^2} = \\frac{a}{h}\\sqrt{1+11} = \\frac{a}{h}\\sqrt{12}$\n\nWe compare $6\\frac{a}{h}$ and $\\sqrt{12}\\frac{a}{h}$. Since $6 = \\sqrt{36}$ and $\\sqrt{36}  \\sqrt{12}$, the maximum modulus is $6\\frac{a}{h}$.\n\nThe spectral radius of the operator $\\mathcal{A}$ is $\\rho(\\mathcal{A}) = 6\\frac{a}{h}$.",
            "answer": "$$\\boxed{6\\frac{a}{h}}$$"
        },
        {
            "introduction": "When spectral methods are applied to nonlinear equations, a subtle source of error called aliasing can arise from the inexact quadrature of nonlinear terms, such as a cubic flux $F(u) = u^3$. You will analyze the polynomial degrees involved to see why a standard Gauss-Lobatto-Legendre quadrature, exact for polynomials of degree $2p-1$, is insufficient . Mastering this concept is key to developing robust spectral element models for nonlinear systems common in oceanography.",
            "id": "3790484",
            "problem": "Consider a one-dimensional spectral element method (SEM) discretization on the reference element $[-1,1]$ with polynomial degree $p$, using Lagrange interpolants at the Gauss–Lobatto–Legendre (GLL) points. Let $u(x)$ be the degree-$p$ nodal interpolant of a smooth scalar field and let the nonlinear flux be $F(u)=u^{3}$. In the standard weak form for a conservative law, one volume contribution is represented by integrals of the form\n$$\nI(\\varphi) \\equiv \\int_{-1}^{1} \\varphi_{x}(x)\\,F\\big(u(x)\\big)\\,\\mathrm{d}x,\n$$\nwhere $\\varphi(x)$ is a degree-$p$ test function and $\\varphi_{x}(x)$ denotes its derivative. Assume exact polynomial algebra holds for the interpolants.\n\n1. Using only the facts that the composition of polynomials yields a polynomial whose degree is the product of degrees, that the derivative of a degree-$p$ polynomial has degree $p-1$, and that a quadrature rule is exact if and only if the integrand lies in the polynomial space of degree no greater than the quadrature’s exactness degree, determine the highest polynomial degree that appears in the integrand of $I(\\varphi)$ for the cubic flux $F(u)=u^{3}$. Conclude whether a GLL quadrature exact up to degree $2p-1$ can integrate $I(\\varphi)$ exactly, and state the minimal degree of exactness required for exact integration of this nonlinear volume term.\n\n2. Now specialize to $p=2$ and choose the specific test function $\\varphi(x)=x$, so that $\\varphi_{x}(x)=1$. Let the degree-$2$ interpolant be\n$$\nu(x)=a+b\\,x+c\\,x^{2},\n$$\nwith real coefficients $a$, $b$, and $c$. Define the aliasing error $E$ for the cubic flux in this collocation setting as the difference between the exact integral and its GLL collocation approximation with three nodes at $x=-1,0,1$ and corresponding weights $w_{-1}=w_{1}=\\tfrac{1}{3}$, $w_{0}=\\tfrac{4}{3}$:\n$$\nE \\equiv \\int_{-1}^{1} u(x)^{3}\\,\\mathrm{d}x - \\left[\\tfrac{1}{3}\\,u(-1)^{3}+\\tfrac{4}{3}\\,u(0)^{3}+\\tfrac{1}{3}\\,u(1)^{3}\\right].\n$$\nDerive a closed-form analytic expression for $E$ in terms of $a$, $b$, and $c$. Your final answer must be a single analytic expression. Do not round and do not include units.",
            "solution": "The problem statement has been validated and is deemed to be sound, well-posed, and scientifically grounded in the field of numerical analysis for partial differential equations. We may proceed with a formal solution.\n\nThe problem is divided into two parts. The first part concerns the degree of the polynomial in a nonlinear integral term and the sufficiency of a standard quadrature rule. The second part requires the explicit calculation of an aliasing error for a specific case.\n\n**Part 1: Polynomial Degree Analysis**\n\nWe are asked to analyze the integral\n$$\nI(\\varphi) \\equiv \\int_{-1}^{1} \\varphi_{x}(x)\\,F\\big(u(x)\\big)\\,\\mathrm{d}x\n$$\nThe integrand is the product of two functions: the derivative of the test function, $\\varphi_x(x)$, and the nonlinear flux evaluated at the solution interpolant, $F(u(x))$. We must determine the highest possible polynomial degree of this integrand.\n\n1.  **Degree of the Test Function Derivative:** The test function $\\varphi(x)$ is a polynomial of degree at most $p$. To find the highest degree of the integrand, we consider the case where $\\varphi(x)$ has the maximum possible degree, i.e., $\\deg(\\varphi) = p$. The derivative of a degree-$p$ polynomial is a polynomial of degree $p-1$. Therefore, the highest possible degree for $\\varphi_x(x)$ is\n    $$\n    \\deg(\\varphi_x) = p-1.\n    $$\n\n2.  **Degree of the Flux Term:** The solution interpolant $u(x)$ is a polynomial of degree $p$. The nonlinear flux is given by $F(u)=u^3$. When applied to the polynomial function $u(x)$, this yields $F(u(x)) = (u(x))^3$. The degree of a polynomial raised to an integer power is the original degree multiplied by the power. Thus,\n    $$\n    \\deg(F(u(x))) = \\deg((u(x))^3) = 3 \\cdot \\deg(u(x)) = 3p.\n    $$\n\n3.  **Degree of the Integrand:** The integrand is the product of $\\varphi_x(x)$ and $F(u(x))$. The degree of a product of polynomials is the sum of their degrees.\n    $$\n    \\deg(\\varphi_x(x) \\, F(u(x))) = \\deg(\\varphi_x) + \\deg(F(u(x))) = (p-1) + 3p = 4p-1.\n    $$\n    The highest polynomial degree that appears in the integrand is $4p-1$.\n\n4.  **Sufficiency of GLL Quadrature:** A Gauss–Lobatto–Legendre (GLL) quadrature rule with $p+1$ nodes is exact for polynomials of degree up to $2p-1$. For this quadrature rule to integrate the term $I(\\varphi)$ exactly, the degree of the integrand must be no greater than the degree of exactness of the rule. This requires:\n    $$\n    4p-1 \\le 2p-1\n    $$\n    This inequality simplifies to $2p \\le 0$. Since the polynomial degree $p$ must be a non-negative integer, and for a non-trivial basis $p \\ge 1$, this condition is never met. Therefore, a GLL quadrature rule with exactness for degree $2p-1$ **cannot** integrate the nonlinear volume term $I(\\varphi)$ exactly for any $p \\ge 1$. This inexact integration is the source of aliasing error.\n\n5.  **Minimal Required Exactness:** For a quadrature rule to integrate a polynomial integrand exactly, its degree of exactness must be at least the degree of the polynomial. The minimal degree of exactness required for the exact integration of this nonlinear term is therefore equal to the degree of the integrand, which is $4p-1$.\n\n**Part 2: Aliasing Error Calculation**\n\nWe now specialize to the case where the polynomial degree is $p=2$. The solution interpolant is given by $u(x) = a+b\\,x+c\\,x^2$. The test function is chosen as $\\varphi(x)=x$, so $\\varphi_x(x)=1$. The integral under consideration becomes $\\int_{-1}^1 u(x)^3\\,\\mathrm{d}x$.\n\nThe aliasing error $E$ is defined as the difference between the exact integral and its GLL quadrature approximation. For $p=2$, the GLL rule uses $3$ nodes at $x \\in \\{-1, 0, 1\\}$ with weights $w_{-1}=w_1 = \\frac{1}{3}$ and $w_0 = \\frac{4}{3}$. This is equivalent to Simpson's rule, which is exact for polynomials of degree up to $2p-1=2(2)-1=3$.\n\nThe error is\n$$\nE \\equiv \\int_{-1}^{1} u(x)^{3}\\,\\mathrm{d}x - \\left[\\frac{1}{3}\\,u(-1)^{3}+\\frac{4}{3}\\,u(0)^{3}+\\frac{1}{3}\\,u(1)^{3}\\right].\n$$\nLet $I_{exact}$ denote the exact integral and $I_{quad}$ denote the quadrature approximation.\n\n1.  **Calculation of the Exact Integral ($I_{exact}$):**\n    We first expand the integrand $u(x)^3 = (a+bx+cx^2)^3$.\n    $$\n    u(x)^3 = c^3 x^6 + 3bc^2 x^5 + (3ac^2+3b^2c) x^4 + (b^3+6abc) x^3 + (3a^2c+3ab^2) x^2 + 3a^2b x + a^3.\n    $$\n    We integrate this polynomial from $-1$ to $1$. The integral of any odd power of $x$ over this symmetric interval is zero.\n    $$\n    I_{exact} = \\int_{-1}^{1} \\left( c^3 x^6 + (3ac^2+3b^2c) x^4 + (3a^2c+3ab^2) x^2 + a^3 \\right) \\mathrm{d}x.\n    $$\n    Using the formula $\\int_{-1}^1 x^{2n} \\mathrm{d}x = \\frac{2}{2n+1}$:\n    $$\n    I_{exact} = c^3\\left(\\frac{2}{7}\\right) + (3ac^2+3b^2c)\\left(\\frac{2}{5}\\right) + (3a^2c+3ab^2)\\left(\\frac{2}{3}\\right) + a^3(2).\n    $$\n    $$\n    I_{exact} = \\frac{2}{7}c^3 + \\frac{6}{5}(ac^2+b^2c) + 2(a^2c+ab^2) + 2a^3.\n    $$\n    $$\n    I_{exact} = 2a^3 + 2ab^2 + 2a^2c + \\frac{6}{5}ac^2 + \\frac{6}{5}b^2c + \\frac{2}{7}c^3.\n    $$\n\n2.  **Calculation of the Quadrature Approximation ($I_{quad}$):**\n    We evaluate $u(x)$ at the quadrature nodes $x \\in \\{-1, 0, 1\\}$:\n    $$\n    u(-1) = a - b + c\n    $$\n    $$\n    u(0) = a\n    $$\n    $$\n    u(1) = a + b + c\n    $$\n    Substitute these into the quadrature formula:\n    $$\n    I_{quad} = \\frac{1}{3}(a-b+c)^3 + \\frac{4}{3}a^3 + \\frac{1}{3}(a+b+c)^3.\n    $$\n    We use the identity $(X-Y)^3 + (X+Y)^3 = 2X^3 + 6XY^2$. Let $X = a+c$ and $Y=b$.\n    $$\n    (a+c-b)^3 + (a+c+b)^3 = 2(a+c)^3 + 6(a+c)b^2.\n    $$\n    So,\n    $$\n    I_{quad} = \\frac{1}{3}\\left[ 2(a+c)^3 + 6(a+c)b^2 \\right] + \\frac{4}{3}a^3.\n    $$\n    $$\n    I_{quad} = \\frac{2}{3}(a+c)^3 + 2(a+c)b^2 + \\frac{4}{3}a^3.\n    $$\n    Expanding $(a+c)^3 = a^3+3a^2c+3ac^2+c^3$:\n    $$\n    I_{quad} = \\frac{2}{3}(a^3+3a^2c+3ac^2+c^3) + 2ab^2 + 2b^2c + \\frac{4}{3}a^3.\n    $$\n    $$\n    I_{quad} = \\frac{2}{3}a^3 + 2a^2c + 2ac^2 + \\frac{2}{3}c^3 + 2ab^2 + 2b^2c + \\frac{4}{3}a^3.\n    $$\n    Combining terms:\n    $$\n    I_{quad} = \\left(\\frac{2}{3}+\\frac{4}{3}\\right)a^3 + 2ab^2 + 2a^2c + 2ac^2 + 2b^2c + \\frac{2}{3}c^3.\n    $$\n    $$\n    I_{quad} = 2a^3 + 2ab^2 + 2a^2c + 2ac^2 + 2b^2c + \\frac{2}{3}c^3.\n    $$\n\n3.  **Calculation of the Aliasing Error ($E$):**\n    The error is $E = I_{exact} - I_{quad}$. Subtracting the expression for $I_{quad}$ from that of $I_{exact}$:\n    $$\n    E = \\left(2a^3 + 2ab^2 + 2a^2c + \\frac{6}{5}ac^2 + \\frac{6}{5}b^2c + \\frac{2}{7}c^3\\right) - \\left(2a^3 + 2ab^2 + 2a^2c + 2ac^2 + 2b^2c + \\frac{2}{3}c^3\\right).\n    $$\n    The terms $2a^3$, $2ab^2$, and $2a^2c$ cancel.\n    $$\n    E = \\left(\\frac{6}{5}ac^2 - 2ac^2\\right) + \\left(\\frac{6}{5}b^2c - 2b^2c\\right) + \\left(\\frac{2}{7}c^3 - \\frac{2}{3}c^3\\right).\n    $$\n    $$\n    E = ac^2\\left(\\frac{6}{5} - \\frac{10}{5}\\right) + b^2c\\left(\\frac{6}{5} - \\frac{10}{5}\\right) + c^3\\left(\\frac{6}{21} - \\frac{14}{21}\\right).\n    $$\n    $$\n    E = -\\frac{4}{5}ac^2 - \\frac{4}{5}b^2c - \\frac{8}{21}c^3.\n    $$\n    This is the closed-form analytic expression for the aliasing error.",
            "answer": "$$\n\\boxed{-\\frac{4}{5}ac^{2} - \\frac{4}{5}b^{2}c - \\frac{8}{21}c^{3}}\n$$"
        },
        {
            "introduction": "Numerical models of geophysical flows must respect physical laws, such as the non-negativity of water depth $h$. High-order DG schemes, however, can produce unphysical oscillations, requiring special corrective measures known as limiters. This exercise guides you through the design of a positivity-preserving limiter for the shallow water equations, a critical component for stabilizing simulations . This practice provides direct insight into how to construct robust, high-order, and conservative schemes that produce physically meaningful results.",
            "id": "3790493",
            "problem": "Consider the one-dimensional shallow water equations over a flat bathymetry, written in conservative form for water depth $h(x,t)$ and momentum $m(x,t)=h(x,t)\\,u(x,t)$, where $u(x,t)$ is the velocity and $g$ is gravitational acceleration:\n$$\n\\partial_{t} h + \\partial_{x} m = 0, \\qquad \\partial_{t} m + \\partial_{x} \\left( \\frac{m^{2}}{h} + \\frac{1}{2} g h^{2} \\right) = 0.\n$$\nA Discontinuous Galerkin (DG) method approximates $h$ and $m$ by polynomials in each element $K$ of a uniform mesh, using Legendre-Gauss-Lobatto nodes typical of the spectral element method. Let $\\bar{h}^{n}$ denote the cell-average of $h$ at time $t^{n}$ over an element $K$, and let $h^{n}(x)$ be its polynomial representation with degree $p \\geq 1$. Assume a Strong Stability Preserving Runge-Kutta (SSP-RK) time integrator built from forward Euler steps and a local Lax-Friedrichs numerical flux with dissipation parameter $\\alpha \\geq \\max\\{ |u_{L}| + \\sqrt{g h_{L}}, |u_{R}| + \\sqrt{g h_{R}} \\}$ on each face, where subscripts $L$ and $R$ denote the left and right traces. The DG scheme uses quadrature rules that are exact for polynomials up to degree $2p-1$ in the volume and up to degree $2p-1$ on faces, and the forward Euler update is applied to the modal coefficients in the usual way.\n\nStarting from the fundamental facts that (i) the first-order finite volume scheme with a monotone flux preserves nonnegativity of $h$ under an appropriate Courant–Friedrichs–Lewy (CFL) time-step restriction, (ii) SSP-RK time stepping can be written as convex combinations of forward Euler steps, and (iii) Legendre-Gauss-Lobatto quadrature provides positive weights with endpoints included, answer the following:\n\n1. Derive a sufficient CFL-type condition on the forward Euler time step $\\Delta t$ and wave speeds ensuring that, if $h^{n}(x) \\geq 0$ at the quadrature points used by the DG scheme in element $K$ and its neighbors, then the forward Euler update preserves the nonnegativity of the cell-average $\\bar{h}^{n+1}$ and the nodal values of $h^{n+1}(x)$ at those quadrature points. Your condition should be expressed symbolically in terms of the element measure $|K|$, face measures, the local Lax-Friedrichs parameters $\\alpha$ at faces, and the smallest Legendre-Gauss-Lobatto weight $w_{\\min}$.\n\n2. Using mass conservation and convexity arguments, derive a high-order positivity-preserving, mass-preserving limiter for $h$ of the form\n$$\nh^{\\mathrm{lim}}(x) = \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h},\n$$\nwith a scalar $\\theta \\in [0,1]$ chosen to enforce $h^{\\mathrm{lim}}(x) \\geq \\varepsilon$ at the chosen positivity points, where $\\varepsilon  0$ is a small floor representing a physically meaningful dryness threshold. Provide a closed-form expression for $\\theta$ in terms of $\\bar{h}$, $\\varepsilon$, and the minimum of $h(x)$ over the positivity points, denoted $h_{\\min}$.\n\n3. On a particular element $K$, suppose the DG polynomial $h(x)$ at the positivity points has minimum value $h_{\\min} = -0.3$ and the cell average is $\\bar{h} = 2.0$. Take the dryness floor to be $\\varepsilon = 10^{-3}$. Compute the value of the limiter parameter $\\theta$ implied by your expression, and round your answer to four significant figures. The final answer is dimensionless and should be reported without units.",
            "solution": "The problem is divided into three parts concerning the positivity of the water depth $h$ in a Discontinuous Galerkin (DG) scheme for the one-dimensional shallow water equations.\n\n### Part 1: Derivation of the CFL-type Condition\n\nThe goal is to find a sufficient condition on the forward Euler time step $\\Delta t$ to preserve the non-negativity of the water depth $h$ at the Legendre-Gauss-Lobatto (LGL) quadrature points. The problem provides several key facts that guide the derivation:\n1.  The first-order finite volume (FV) scheme with a monotone flux preserves non-negativity under a Courant–Friedrichs–Lewy (CFL) condition.\n2.  Strong Stability Preserving Runge-Kutta (SSP-RK) methods are convex combinations of forward Euler steps. Thus, if a forward Euler step preserves positivity, so will the full SSP-RK step (under the same or a scaled time-step restriction).\n3.  The DG scheme uses LGL quadrature points and weights, which are positive. The mass matrix for this choice of basis and quadrature is diagonal.\n\nLet us analyze the forward Euler update for the DG approximation. The semi-discrete DG formulation for the continuity equation $\\partial_t h + \\partial_x m = 0$ in an element $K$ is: for all test functions $v(x)$ in the polynomial space,\n$$ \\int_K \\frac{\\partial h}{\\partial t} v \\, dx = \\int_K m \\frac{\\partial v}{\\partial x} \\, dx - \\left[ m^* v \\right]_{\\partial K} $$\nHere, $m^*$ is the numerical flux, and $\\left[ \\cdot \\right]_{\\partial K}$ denotes the difference of values at the element boundaries, e.g., $f(x_{k+1/2}) - f(x_{k-1/2})$.\n\nUsing a nodal basis composed of Lagrange polynomials $L_j(x)$ centered at the LGL quadrature points $\\{x_j\\}_{j=0}^p$, the approximate solution is $h(x,t) = \\sum_{j=0}^{p} h_j(t) L_j(x)$. We choose the test function $v(x) = L_i(x)$. The mass matrix $M_{ij} = \\int_K L_i(x) L_j(x) \\, dx$ becomes diagonal due to the LGL quadrature rule, which is exact for polynomials of degree up to $2p-1$ (since $L_i L_j$ is of degree at most $2p$). The diagonal entries are $M_{ii} = \\int_K L_i^2(x) dx = w_i^{\\text{ref}} \\frac{|K|}{2}$, where $w_i^{\\text{ref}}$ are the LGL weights on the reference element $[-1,1]$ and $|K|$ is the measure (length) of element $K$. Let us denote $w_i = w_i^{\\text{ref}}$ for simplicity.\n\nThe semi-discrete equation for the nodal value $h_i(t)$ is:\n$$ \\frac{|K|}{2} w_i \\frac{d h_i}{dt} = \\int_K m(x,t) L_i'(x) \\, dx - \\left[ m^{*,n} L_i \\right]_{\\partial K} $$\nApplying a forward Euler step:\n$$ h_i^{n+1} = h_i^n + \\frac{2 \\Delta t}{|K| w_i} \\left( \\int_K m^n(x) L_i'(x) \\, dx - \\left[ m^{*,n} L_i \\right]_{\\partial K} \\right) $$\nA rigorous derivation from this point is highly technical. However, a key result in the theory of positivity-preserving DG schemes, developed by Zhang and Shu, is that the DG update at a quadrature point can be interpreted as a finite volume update on a sub-cell. The 'volume' of the sub-cell associated with node $x_i$ is its corresponding mass matrix entry, $V_i = \\frac{|K|}{2} w_i$. The condition for positivity preservation can then be derived by analogy with a first-order FV scheme.\n\nFor a 1D FV scheme $h_j^{n+1} = h_j^n - \\frac{\\Delta t}{\\Delta x_j} (F^*_{j+1/2} - F^*_{j-1/2})$ with a Lax-Friedrichs flux $F^*(h_L, h_R) = \\frac{f(h_L)+f(h_R)}{2} - \\frac{\\alpha}{2}(h_R - h_L)$, the coefficient of $h_j^n$ in the update is $1 - \\frac{\\Delta t}{2\\Delta x_j} (\\alpha_{j+1/2} + \\alpha_{j-1/2})$. For positivity, this coefficient must be non-negative, yielding the CFL condition $\\Delta t \\le \\frac{2 \\Delta x_j}{\\alpha_{j+1/2} + \\alpha_{j-1/2}}$.\n\nBy analogy, for the DG scheme, we consider the sub-cell with the smallest effective volume, which corresponds to the minimum LGL weight $w_{\\min}$. We replace $\\Delta x_j$ with $V_{\\min} = \\frac{|K|}{2} w_{\\min}$. The term $\\alpha_{j+1/2} + \\alpha_{j-1/2}$ represents the sum of dissipation coefficients over the faces of the cell. For the DG element $K$, the relevant dissipation parameters are those at its external faces, $\\alpha_L$ and $\\alpha_R$. The influence of these boundary fluxes propagates into the entire element and affects all nodal values due to the high-order polynomial representation. The condition for preserving positivity at all nodes must therefore account for the total dissipation entering the element.\n\nThe sufficient condition is that the time step must be small enough so that the total flux leaving any sub-cell does not deplete its content. The most restrictive case is for the sub-cell with the smallest volume $V_{\\min}$. The total outgoing flux is driven by the sum of dissipative effects from all element faces. In 1D, we have two faces with measures $|\\partial K_L|=1$ and $|\\partial K_R|=1$. The sum of LF parameters weighted by face measures is $\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|$.\n\nApplying the analogy, we replace $\\frac{1}{2}(\\alpha_L + \\alpha_R)$ with $\\frac{1}{2}(\\alpha_L|\\partial K_L|+\\alpha_R|\\partial K_R|)$ and $\\Delta x_j$ with $\\frac{|K|}{2} w_{\\min}$. This yields:\n$$ \\Delta t \\le \\frac{2 \\left( \\frac{|K|}{2} w_{\\min} \\right)}{\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|} = \\frac{|K| w_{\\min}}{\\alpha_L |\\partial K_L| + \\alpha_R |\\partial K_R|} $$\nThis condition ensures that if $h^n(x_j) \\geq 0$ at all LGL points in element $K$ and its neighbors, then the forward Euler update $h^{n+1}(x_j)$ will also be non-negative. Because the LGL nodes include the endpoints, non-negativity at the nodes implies non-negativity of the polynomial $h(x)$ throughout the element, which in turn ensures that the cell average $\\bar{h}^{n+1}$ is non-negative. Thus, this single condition is sufficient for both nodal and cell-average positivity.\n\n### Part 2: Derivation of the Positivity-Preserving Limiter\n\nWe are given a limiter of the form $h^{\\mathrm{lim}}(x) = \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h}$ with $\\theta \\in [0,1]$.\n\nFirst, we verify that this limiter is mass-preserving. The new cell average is:\n$$ \\overline{h^{\\mathrm{lim}}} = \\frac{1}{|K|} \\int_K h^{\\mathrm{lim}}(x) \\, dx = \\frac{1}{|K|} \\int_K \\left[ \\theta \\big( h(x) - \\bar{h} \\big) + \\bar{h} \\right] \\, dx $$\n$$ \\overline{h^{\\mathrm{lim}}} = \\frac{\\theta}{|K|} \\int_K h(x) \\, dx - \\frac{\\theta}{|K|} \\int_K \\bar{h} \\, dx + \\frac{1}{|K|} \\int_K \\bar{h} \\, dx $$\nUsing the definition $\\bar{h} = \\frac{1}{|K|} \\int_K h(x) \\, dx$, we get:\n$$ \\overline{h^{\\mathrm{lim}}} = \\theta \\bar{h} - \\theta \\bar{h} + \\bar{h} = \\bar{h} $$\nThe limiter is mass-preserving for any $\\theta$.\n\nNext, we enforce the positivity constraint, $h^{\\mathrm{lim}}(x) \\geq \\varepsilon$, at a set of positivity points (e.g., the quadrature points). Let $h_{\\min} = \\min_x h(x)$ be the minimum value of the un-limited polynomial $h(x)$ over these points. The minimum value of the limited polynomial $h^{\\mathrm{lim}}(x)$ is:\n$$ h^{\\mathrm{lim}}_{\\min} = \\min_x \\left[ \\theta h(x) + (1-\\theta)\\bar{h} \\right] = \\theta h_{\\min} + (1-\\theta)\\bar{h} $$\nbecause $\\theta \\in [0,1]$.\nWe require $h^{\\mathrm{lim}}_{\\min} \\geq \\varepsilon$:\n$$ \\theta h_{\\min} + (1-\\theta)\\bar{h} \\geq \\varepsilon $$\n$$ \\theta h_{\\min} + \\bar{h} - \\theta\\bar{h} \\geq \\varepsilon $$\n$$ \\theta(h_{\\min} - \\bar{h}) \\geq \\varepsilon - \\bar{h} $$\nThe limiter is only applied if $h_{\\min}$ violates the positivity constraint, i.e., $h_{\\min}  \\varepsilon$. By definition, $h_{\\min} \\le \\bar{h}$. If $h_{\\min} = \\bar{h}$, the polynomial is a constant, and no limiting is needed unless this constant is below $\\varepsilon$. We assume $h_{\\min}  \\bar{h}$, which makes the term $(h_{\\min} - \\bar{h})$ strictly negative. Dividing the inequality by this negative term reverses the inequality sign:\n$$ \\theta \\le \\frac{\\varepsilon - \\bar{h}}{h_{\\min} - \\bar{h}} = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\nTo be as minimally intrusive as possible, we want to choose the largest possible $\\theta$ that satisfies this condition, while also respecting $\\theta \\in [0, 1]$. We choose $\\theta$ to be the upper bound:\n$$ \\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\nThis value of $\\theta$ is used only when limiting is necessary, i.e., when $h_{\\min}  \\varepsilon$. If $h_{\\min} \\ge \\varepsilon$, no limiting is applied, which corresponds to $\\theta = 1$. The derived expression for $\\theta$ is consistent with this, since $h_{\\min}  \\varepsilon \\implies \\bar{h} - h_{\\min}  \\bar{h} - \\varepsilon \\implies \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}}  1$. Also, for the limited solution to be able to satisfy the condition, the cell average $\\bar{h}$ must be greater than $\\varepsilon$. If $\\bar{h} \\le \\varepsilon$, no value of $\\theta \\in [0,1]$ can guarantee $h^{\\mathrm{lim}}(x) \\ge \\varepsilon$ while preserving the mean (unless $h(x)=\\bar{h}=\\varepsilon$). In such cases, one typically sets $\\theta=0$, resulting in $h^{\\mathrm{lim}}(x) = \\bar{h}$. Assuming $\\bar{h}  \\varepsilon$, our expression for $\\theta$ is well-defined and lies in $[0,1)$.\n\nThe complete procedure is:\nIf $h_{\\min}  \\varepsilon$ and $\\bar{h}  \\varepsilon$, set $\\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}}$. Otherwise, set $\\theta=1$. The problem asks for the expression for $\\theta$ to enforce the condition, which is the formula derived.\n\n### Part 3: Calculation of the Limiter Parameter $\\theta$\n\nWe are given the following values for a particular element:\n- Minimum value of $h(x)$ at positivity points: $h_{\\min} = -0.3$\n- Cell average of $h(x)$: $\\bar{h} = 2.0$\n- Dryness floor: $\\varepsilon = 10^{-3} = 0.001$\n\nWe check the conditions for applying the limiter. We have $h_{\\min} = -0.3  0.001 = \\varepsilon$, so limiting is required. We also have $\\bar{h} = 2.0  0.001 = \\varepsilon$, so a valid, mass-preserving limited solution exists.\n\nWe use the formula derived in Part 2:\n$$ \\theta = \\frac{\\bar{h} - \\varepsilon}{\\bar{h} - h_{\\min}} $$\nSubstituting the given values:\n$$ \\theta = \\frac{2.0 - 0.001}{2.0 - (-0.3)} = \\frac{1.999}{2.3} $$\nComputing the numerical value:\n$$ \\theta \\approx 0.8691304347... $$\nRounding the result to four significant figures, we get $\\theta = 0.8691$.",
            "answer": "$$\\boxed{0.8691}$$"
        }
    ]
}