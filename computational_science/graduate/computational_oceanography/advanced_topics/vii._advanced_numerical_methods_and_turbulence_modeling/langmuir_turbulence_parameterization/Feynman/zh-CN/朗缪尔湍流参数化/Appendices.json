{
    "hands_on_practices": [
        {
            "introduction": "表面斯托克斯漂移 $U_{s0}$ 是驱动朗缪尔湍流的关键参数。本练习将指导你基于基本波浪参数，如有效波高 $H_s$，推导出 $U_{s0}$ 的近似值 。通过采用窄带谱的简化假设，这个实践清晰地揭示了连接波能和拉格朗日运动的核心物理机制，为理解朗缪尔湍流参数化方案奠定了基础。",
            "id": "3797768",
            "problem": "一片风浪由联合北海波浪计划（JONSWAP）谱表示，该谱是单向的，并在其谱峰周围是窄带的。海况为深水，重力加速度 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，有义波高 $H_s = 3.2\\,\\mathrm{m}$，峰值波数 $k_p = 0.09\\,\\mathrm{m^{-1}}$，峰值增强因子 $\\gamma = 3.3$。目标是获得一个适用于窄带假设下朗缪尔湍流参数化的表面斯托克斯漂移 $U_{s0}$ 的近似表达式。\n\n仅从以下基础出发：\n- 深水中的线性波浪运动学，\n- 斯托克斯漂移的定义，即随机海浪中二阶波浪运动产生的拉格朗日平均速度，\n- 深水色散关系 $\\omega^2 = g k$，\n- 以及随机海浪的有义波高与海面高程方差之间的关系 $H_s = 4 \\sqrt{m_0}$，\n\n利用JONSWAP峰值增强因子 $\\gamma>1$ 意味着谱在峰值周围是窄带的这一事实，推导出一个用 $H_s$、$k_p$ 和 $g$ 表示的 $U_{s0}$ 的近似值。然后，使用上面给出的参数对你的表达式进行数值计算。将你的答案四舍五入到三位有效数字。最终值以 $\\mathrm{m\\,s^{-1}}$ 表示。",
            "solution": "本题经评估有效，其科学依据充分、问题设定明确、内容客观，且包含足够信息以得出唯一且有意义的解。所提供的数据在物理上是一致且现实的。\n\n目标是为单向、窄带的随机海浪推导表面斯托克斯漂移 $U_{s0}$ 的近似表达式，然后进行数值计算。推导将从指定的基础原理开始。\n\n斯托克斯漂移是波场中流体质点的净拉格朗日漂移速度。对于深水波的连续谱，斯托克斯漂移剖面 $U_s(z)$ 是通过对每个波分量的贡献进行积分得到的。单个振幅为 $a$、频率为 $\\omega$、波数为 $k$ 的单色波分量对斯托克斯漂移的贡献由 $U_{s,comp}(z) = \\omega k a^2 \\exp(2kz)$ 给出。\n\n对于由波浪方差谱描述的随机海浪，无穷小频带 $d\\omega$ 内分量的振幅平方 $a^2$ 与谱密度 $S(\\omega)$ 的关系为 $a^2 = 2 S(\\omega) d\\omega$。对所有频率的贡献求和，得到总的斯托克斯漂移剖面：\n$$\nU_s(z) = \\int_0^\\infty 2 \\omega k \\exp(2kz) S(\\omega) d\\omega\n$$\n在海面处，垂直坐标 $z=0$，表面斯托克斯漂移 $U_{s0}$ 为：\n$$\nU_{s0} = \\int_0^\\infty 2 \\omega k S(\\omega) d\\omega\n$$\n问题提供了峰值波数 $k_p$，因此使用波数谱 $E(k)$ 比使用频率谱 $S(\\omega)$ 更方便。两者通过能量方差守恒相关联：$S(\\omega)d\\omega = E(k)dk$。将此代入 $U_{s0}$ 的积分中，得到：\n$$\nU_{s0} = \\int_0^\\infty 2 \\omega(k) k E(k) dk\n$$\n问题指明波浪处于深水中。因此，频率 $\\omega$ 和波数 $k$ 通过深水色散关系 $\\omega^2 = gk$ 相关联。这意味着 $\\omega(k) = \\sqrt{gk}$。将此代入 $U_{s0}$ 的表达式中：\n$$\nU_{s0} = \\int_0^\\infty 2 (\\sqrt{gk}) k E(k) dk = 2\\sqrt{g} \\int_0^\\infty k^{3/2} E(k) dk\n$$\n问题陈述海况由峰值增强因子 $\\gamma = 3.3$ 的JONSWAP谱表示。$\\gamma > 1$ 的值意味着谱比充分发展的海浪（其$\\gamma=1$）更尖锐。这证明了使用窄带假设的合理性，即波能集中在峰值波数 $k_p$ 周围的一个窄波数带内。\n\n在窄带假设下，谱 $E(k)$ 在 $k=k_p$ 处急剧达到峰值，而相比之下，$k^{3/2}$ 项是 $k$ 的一个缓变函数。因此，我们可以通过在峰值波数 $k_p$ 处评估缓变部分并将其移到积分符号外来近似该积分：\n$$\nU_{s0} \\approx 2\\sqrt{g} (k_p)^{3/2} \\int_0^\\infty E(k) dk\n$$\n剩下的积分 $\\int_0^\\infty E(k) dk$ 是波数谱的零阶矩，记为 $m_0$。根据定义，该矩是海面高程的方差，$\\langle \\eta^2 \\rangle$。\n$$\nm_0 = \\int_0^\\infty E(k) dk\n$$\n问题提供了随机海浪的有义波高 $H_s$ 和海面高程方差之间的关系：$H_s = 4 \\sqrt{m_0}$。我们可以重新整理这个关系式，用 $H_s$ 来表示 $m_0$：\n$$\nm_0 = \\left(\\frac{H_s}{4}\\right)^2 = \\frac{H_s^2}{16}\n$$\n将这个 $m_0$ 的表达式代回我们的 $U_{s0}$ 近似式中：\n$$\nU_{s0} \\approx 2\\sqrt{g} k_p^{3/2} \\left(\\frac{H_s^2}{16}\\right)\n$$\n简化这个表达式，得到最终所需的用 $H_s$、$k_p$ 和 $g$ 表示的表面斯托克斯漂移的近似式：\n$$\nU_{s0} \\approx \\frac{\\sqrt{g} k_p^{3/2} H_s^2}{8}\n$$\n现在，我们使用给定的值对这个表达式进行数值计算：\n- 重力加速度: $g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n- 有义波高: $H_s = 3.2\\,\\mathrm{m}$\n- 峰值波数: $k_p = 0.09\\,\\mathrm{m^{-1}}$\n\n将这些值代入推导出的公式中：\n$$\nU_{s0} \\approx \\frac{\\sqrt{9.81\\,\\mathrm{m\\,s^{-2}}} (0.09\\,\\mathrm{m^{-1}})^{3/2} (3.2\\,\\mathrm{m})^2}{8}\n$$\n首先，计算各项：\n- $\\sqrt{9.81} \\approx 3.13209\\,\\mathrm{m^{1/2}\\,s^{-1}}$\n- $(0.09)^{3/2} = (0.09)\\sqrt{0.09} = 0.09 \\times 0.3 = 0.027\\,\\mathrm{m^{-3/2}}$\n- $(3.2)^2 = 10.24\\,\\mathrm{m^2}$\n\n将分子中的这些项相乘：\n$$\n\\sqrt{9.81} (0.09)^{3/2} (3.2)^2 \\approx (3.13209) \\times (0.027) \\times (10.24) \\,\\mathrm{m\\,s^{-1}} \\approx 0.865886\\,\\mathrm{m\\,s^{-1}}\n$$\n最后，除以 $8$：\n$$\nU_{s0} \\approx \\frac{0.865886\\,\\mathrm{m\\,s^{-1}}}{8} \\approx 0.10823575\\,\\mathrm{m\\,s^{-1}}\n$$\n问题要求将答案四舍五入到三位有效数字。\n$$\nU_{s0} \\approx 0.108\\,\\mathrm{m\\,s^{-1}}\n$$",
            "answer": "$$\n\\boxed{0.108}\n$$"
        },
        {
            "introduction": "朗缪尔湍流最显著的影响是增强海洋上层混合。本练习利用一个集总混合层模型来量化这种增强效应 。通过直接对比包含与不包含朗缪尔湍流生成项时混合层深度的演变，你将具体地理解该过程对海洋表面边界层结构的深刻影响，并认识到为何精确的参数化方案对海洋及气候模型至关重要。",
            "id": "3797776",
            "problem": "一个初始均匀的混合层，其深度为 $h(t)$，位于一个明显的密度阶跃之上，其底部的浮力跃变为 $\\Delta b$。在 $t = 12\\,\\mathrm{h}$ 的时间内，水体受到由稳定风应力和与固定海况相关的稳定斯托克斯漂移产生的恒定机械强迫。假设表面浮力通量为零，条件为水平均匀，且混合层保持水平均匀并具有一个清晰的基底。设摩擦速度为 $u_*$，表面斯托克斯漂移为 $U_{s0}$。考虑单位水平面积上的湍动能（TKE）输入（在混合层上积分）的两种参数化方案：与 $\\rho_0 u_*^3$ 成正比的风切变产生项，以及与 $\\rho_0 u_*^2 U_{s0}$ 成正比的Langmuir湍流产生项，其中 $\\rho_0$ 是一个恒定的参考密度。\n\n从混合层能量学出发，将总TKE输入（风，以及包含Langmuir湍流时）的一个固定卷夹效率分数 $C_e$ 与将混合层加深到具有浮力跃变 $\\Delta b$ 的水层所需的重力势能增加率相等。使用以下经过充分检验的标度和常数：\n- 单位面积的风切变TKE输入：$\\rho_0 c_w u_*^3$，\n- 单位面积的Langmuir湍流TKE输入：$\\rho_0 c_L u_*^2 U_{s0}$，\n- 卷夹效率：$C_e$ (无量纲)，\n以及混合层加深并卷夹入一个清晰的浮力跃变层时重力势能增加率的标准结果：$\\frac{1}{2}\\rho_0 \\Delta b \\,\\frac{\\mathrm{d}}{\\mathrm{d}t}\\!\\left[h(t)^2\\right]$。\n\n通过应用能量平衡，推导 $h(t)$ 的常微分方程，并在初始条件 $h(0)=h_0$ 下对其进行积分。对于以下两种情景，计算 $t=12\\,\\mathrm{h}$ 时的 $h$ 值：\n- 仅风场标度：只包括风切变产生项，\n- 风场+Langmuir标度：同时包括风切变和Langmuir湍流产生项。\n\n使用以下参数值\n- $h_0 = 20\\,\\mathrm{m}$，\n- $u_* = 0.015\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，\n- $U_{s0} = 0.05\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，\n- $\\Delta b = 3.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，\n- $c_w = 1.0$，\n- $c_L = 0.8$，\n- $C_e = 1.0$。\n\n将所求的两个值以双元素行向量 $\\big[h_{\\mathrm{W}}(12\\,\\mathrm{h}),\\,h_{\\mathrm{W+L}}(12\\,\\mathrm{h})\\big]$ 的形式报告，单位为米。将您的答案四舍五入到四位有效数字。最终深度以 $\\mathrm{m}$ 为单位表示。",
            "solution": "首先对问题进行验证检查。\n\n### 第1步：提取给定条件\n- 初始混合层深度：$h(0) = h_0 = 20\\,\\mathrm{m}$\n- 持续时间：$t = 12\\,\\mathrm{h}$\n- 混合层底部的浮力跃变：$\\Delta b = 3.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- 摩擦速度：$u_* = 0.015\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- 表面斯托克斯漂移：$U_{s0} = 0.05\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- 参考密度：$\\rho_0$（恒定）\n- 单位面积的风切变TKE输入：$\\rho_0 c_w u_*^3$\n- 单位面积的Langmuir湍流TKE输入：$\\rho_0 c_L u_*^2 U_{s0}$\n- 重力势能的增加率：$\\frac{1}{2}\\rho_0 \\Delta b \\frac{\\mathrm{d}}{\\mathrm{d}t}\\![h(t)^2]$\n- 风切变系数：$c_w = 1.0$\n- Langmuir湍流系数：$c_L = 0.8$\n- 卷夹效率：$C_e = 1.0$\n- 条件：恒定的机械强迫，零表面浮力通量，水平均匀，清晰的混合层基底。\n- 任务：推导 $h(t)$ 的常微分方程，求解，并计算仅风场标度和风场+Langmuir标度下 $h(12\\,\\mathrm{h})$ 的值。\n\n### 第2步：使用提取的给定条件进行验证\n1.  **科学依据**：该问题基于物理海洋学中成熟的混合层动力学理论，特别是使用了包含TKE收支的整体混合层模型。风切变和Langmuir湍流产生的参数化方案，以及势能的变化，都是该领域的标准表示方法。参数值对于海洋条件是物理上现实的。问题是科学合理的。\n2.  **适定性**：问题提供了一个清晰的初始条件 $h(0)=h_0$，并要求在一个特定时间求解一个一阶常微分方程（ODE）。该设置可以导出一个唯一且稳定的解。问题是适定的。\n3.  **客观性**：问题使用精确、定量的语言和已建立的物理概念来陈述。它不含主观性或个人意见。\n4.  **完整且一致**：所有必要的参数（$h_0$、$u_*$、$U_{s0}$、$\\Delta b$、$c_w$、$c_L$、$C_e$）和函数形式都已提供。设置中没有矛盾。问题是自洽的。\n\n### 第3步：结论和行动\n问题是有效的。将提供解答。\n\n基本原理是混合层的能量平衡。单位面积上总湍动能（TKE）输入的一个固定比例 $C_e$ 通过卷夹混合层下方更稠密的水体而转化为势能。这可以表示为：\n$$\n\\frac{\\mathrm{d(PE)}}{\\mathrm{d}t} = C_e \\times (\\text{单位面积总TKE输入})\n$$\n对于深度为 $h(t)$ 的混合层加深并卷夹入具有浮力跃变 $\\Delta b$ 的水层，单位面积重力势能的增加率由 $\\frac{1}{2}\\rho_0 \\Delta b \\frac{\\mathrm{d}}{\\mathrm{d}t}[h(t)^2]$ 给出。单位面积总TKE输入是风切变和Langmuir湍流贡献的总和。\n\n设 $P_{TKE}$ 为单位面积的总TKE输入。能量平衡方程为：\n$$\n\\frac{1}{2}\\rho_0 \\Delta b \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left[h(t)^2\\right] = C_e P_{TKE}\n$$\n如果我们定义单位质量的TKE输入率，记为 $P = P_{TKE}/\\rho_0$，则参考密度 $\\rho_0$ 可以被消去。方程变为：\n$$\n\\frac{1}{2} \\Delta b \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left[h(t)^2\\right] = C_e P\n$$\n这是一个关于 $h(t)^2$ 的一阶常微分方程。由于强迫项（$u_*$, $U_{s0}$）是恒定的，$P$ 在时间上是常数。我们可以重新排列方程并从 $t=0$ 积分到一般时间 $t$：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left[h(t)^2\\right] = \\frac{2 C_e P}{\\Delta b}\n$$\n$$\n\\int_{h(0)^2}^{h(t)^2} \\mathrm{d}(h^2) = \\int_0^t \\frac{2 C_e P}{\\Delta b} \\mathrm{d}t'\n$$\n$$\nh(t)^2 - h(0)^2 = \\frac{2 C_e P}{\\Delta b} t\n$$\n使用初始条件 $h(0) = h_0$，我们得到 $h(t)$ 的解：\n$$\nh(t)^2 = h_0^2 + \\frac{2 C_e P}{\\Delta b} t\n$$\n$$\nh(t) = \\sqrt{h_0^2 + \\frac{2 C_e P}{\\Delta b} t}\n$$\n我们现在将这个通解应用于两种指定的情景。持续时间为 $t = 12\\,\\mathrm{h} = 12 \\times 3600\\,\\mathrm{s} = 43200\\,\\mathrm{s}$。\n\n**情景1：仅风场标度 ($h_{\\mathrm{W}}$)**\n在这种情况下，TKE输入仅来自风切变。单位面积的TKE输入为 $P_{TKE, \\mathrm{W}} = \\rho_0 c_w u_*^3$。单位质量的输入为 $P_{\\mathrm{W}} = c_w u_*^3$。\n混合层深度 $h_{\\mathrm{W}}(t)$ 的解为：\n$$\nh_{\\mathrm{W}}(t) = \\sqrt{h_0^2 + \\frac{2 C_e c_w u_*^3}{\\Delta b} t}\n$$\n我们代入给定的参数值：\n- $h_0 = 20\\,\\mathrm{m}$\n- $u_* = 0.015\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- $\\Delta b = 3.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $c_w = 1.0$\n- $C_e = 1.0$\n- $t = 43200\\,\\mathrm{s}$\n\n首先，计算平方根内代表增长的项：\n$$\n\\frac{2 C_e c_w u_*^3}{\\Delta b} t = \\frac{2 \\times 1.0 \\times 1.0 \\times (0.015\\,\\mathrm{m}\\,\\mathrm{s}^{-1})^3}{3.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}} \\times 43200\\,\\mathrm{s}\n$$\n$$\n(0.015)^3 = 3.375 \\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3}\n$$\n$$\n\\frac{2 \\times (3.375 \\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3})}{3.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}} \\times 43200\\,\\mathrm{s} = \\frac{6.75 \\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3}}{3.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}} \\times 43200\\,\\mathrm{s}\n$$\n$$\n= (2.25 \\times 10^{-3}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}) \\times 43200\\,\\mathrm{s} = 97.2\\,\\mathrm{m}^2\n$$\n现在，将此代回 $h_{\\mathrm{W}}(t)$ 的方程：\n$$\nh_{\\mathrm{W}}(12\\,\\mathrm{h})^2 = h_0^2 + 97.2\\,\\mathrm{m}^2 = (20\\,\\mathrm{m})^2 + 97.2\\,\\mathrm{m}^2 = 400\\,\\mathrm{m}^2 + 97.2\\,\\mathrm{m}^2 = 497.2\\,\\mathrm{m}^2\n$$\n$$\nh_{\\mathrm{W}}(12\\,\\mathrm{h}) = \\sqrt{497.2}\\,\\mathrm{m} \\approx 22.2984304\\,\\mathrm{m}\n$$\n四舍五入到四位有效数字，$h_{\\mathrm{W}}(12\\,\\mathrm{h}) = 22.30\\,\\mathrm{m}$。\n\n**情景2：风场+Langmuir标度 ($h_{\\mathrm{W+L}}$)**\n在这种情况下，TKE输入是风切变和Langmuir湍流产生的总和。单位面积的TKE输入为 $P_{TKE, \\mathrm{W+L}} = \\rho_0 c_w u_*^3 + \\rho_0 c_L u_*^2 U_{s0}$。单位质量的输入为 $P_{\\mathrm{W+L}} = c_w u_*^3 + c_L u_*^2 U_{s0}$。\n混合层深度 $h_{\\mathrm{W+L}}(t)$ 的解为：\n$$\nh_{\\mathrm{W+L}}(t) = \\sqrt{h_0^2 + \\frac{2 C_e (c_w u_*^3 + c_L u_*^2 U_{s0})}{\\Delta b} t}\n$$\n我们使用额外的参数值：\n- $U_{s0} = 0.05\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- $c_L = 0.8$\n\n首先，计算单位质量的总TKE输入率，$P_{\\mathrm{W+L}}$：\n$$\nP_{\\mathrm{W,term}} = c_w u_*^3 = 1.0 \\times (0.015\\,\\mathrm{m}\\,\\mathrm{s}^{-1})^3 = 3.375 \\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3}\n$$\n$$\nP_{\\mathrm{L,term}} = c_L u_*^2 U_{s0} = 0.8 \\times (0.015\\,\\mathrm{m}\\,\\mathrm{s}^{-1})^2 \\times (0.05\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) = 0.8 \\times (2.25 \\times 10^{-4}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}) \\times (0.05\\,\\mathrm{m}\\,\\mathrm{s}^{-1})\n$$\n$$\nP_{\\mathrm{L,term}} = 9.0 \\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3}\n$$\n$$\nP_{\\mathrm{W+L}} = P_{\\mathrm{W,term}} + P_{\\mathrm{L,term}} = (3.375 + 9.0) \\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3} = 12.375 \\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3}\n$$\n现在，计算增长项：\n$$\n\\frac{2 C_e P_{\\mathrm{W+L}}}{\\Delta b} t = \\frac{2 \\times 1.0 \\times (12.375 \\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3})}{3.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}} \\times 43200\\,\\mathrm{s}\n$$\n$$\n= \\frac{2.475 \\times 10^{-5}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-3}}{3.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}} \\times 43200\\,\\mathrm{s} = (8.25 \\times 10^{-3}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}) \\times 43200\\,\\mathrm{s} = 356.4\\,\\mathrm{m}^2\n$$\n将此代回 $h_{\\mathrm{W+L}}(t)$ 的方程：\n$$\nh_{\\mathrm{W+L}}(12\\,\\mathrm{h})^2 = h_0^2 + 356.4\\,\\mathrm{m}^2 = (20\\,\\mathrm{m})^2 + 356.4\\,\\mathrm{m}^2 = 400\\,\\mathrm{m}^2 + 356.4\\,\\mathrm{m}^2 = 756.4\\,\\mathrm{m}^2\n$$\n$$\nh_{\\mathrm{W+L}}(12\\,\\mathrm{h}) = \\sqrt{756.4}\\,\\mathrm{m} \\approx 27.502727\\,\\mathrm{m}\n$$\n四舍五入到四位有效数字，$h_{\\mathrm{W+L}}(12\\,\\mathrm{h}) = 27.50\\,\\mathrm{m}$。\n\n所求的两个值分别是仅风场和风场+Langmuir情景下 $t=12\\,\\mathrm{h}$ 时的混合层深度。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n22.30  & 27.50\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在第一个练习的基础上，本实践从一个简化的近似方法转向更真实的计算场景 。你将学习如何直接从给定的JONSWAP波能谱（模拟真实的浮标数据）计算表面斯托克斯漂移。此练习还引入了湍流朗缪尔数 $La_t$ 的计算，它是一个关键的无量纲参数，用于诊断上层海洋的动力学状态。",
            "id": "3797797",
            "problem": "你的任务是，从适用于线性表面重力波的第一性原理出发，推导并实现一种数值方法，用以根据全向波浪浮标谱估算表面斯托克斯漂移速度 $U_{s0}$，并利用船测摩擦速度 $u_*$ 计算湍流朗缪尔数 $La_t$。你的推导必须从线性随机波的拉格朗日平均漂移的定义和深水色散关系开始。然后，你必须设计一种适用于浮标解析的频谱的离散化方法，并将其在一个程序中实现。\n\n仅使用以下基础作为起点：\n- 线性表面重力波的深水色散关系 $\\,\\omega^2 = g k\\,$，其中 $\\omega$ 是角频率，$k$ 是波数大小，$g$ 是重力加速度。\n- 线性随机波场的拉格朗日平均漂移速度（斯托克斯漂移）的定义，其形式为波能谱的泛函，在海洋表面求值；以及湍流朗缪尔数 $La_t$ 关于摩擦速度和表面斯托克斯漂移的标准定义。\n- 将有效波高 $H_s$ 与谱方差 $m_0$ 联系起来的统计关系 $\\,m_0 = H_s^2/16\\,$，以及全向浮标谱 $S(f)$ 是对所有波向的积分。\n\n你的程序必须：\n- 使用联合北海波浪项目（JONSWAP）模型，为下文定义的频率范围和参数构建一个全向波谱 $S(f)$。设 JONSWAP 形状由以下公式给出：\n  $$S(f) \\;=\\; \\alpha \\, \\frac{g^2}{(2\\pi)^4}\\, f^{-5} \\, \\exp\\!\\Big(-\\frac{5}{4}\\,\\Big(\\frac{f_p}{f}\\Big)^{4}\\Big)\\; \\gamma^{\\;\\exp\\!\\left(-\\frac{(f/f_p - 1)^2}{2\\sigma^2}\\right)},$$\n  其中，当 $f \\le f_p$ 时 $\\sigma = 0.07$，当 $f > f_p$ 时 $\\sigma = 0.09$。比例因子 $\\alpha$ 的选择必须使得方差 $m_0 = \\int S(f)\\, df$ 与每种情况下给定的 $H_s$ 所设定的目标值 $\\,m_0 = H_s^2/16\\,$ 相匹配。\n- 在计算 $U_{s0}$ 时，使用深水色散关系来关联 $\\,\\omega = 2\\pi f\\,$ 和 $k$。\n- 对每个测试用例，使用提供的 $u_*$ 根据你推导的表达式计算 $La_t$。\n\n物理单位和数值要求：\n- 使用标准的国际单位制（SI）：$f$ 单位为 Hz，$g$ 单位为 m/s$^2$，$S(f)$ 单位为 m$^2$/Hz，$U_{s0}$ 和 $u_*$ 单位为 m/s。\n- 使用 $g = 9.81$ m/s$^2$。\n- 将 $U_{s0}$ 以 m/s 为单位表示，四舍五入到六位小数；将 $La_t$ 作为无量纲量表示，四舍五入到六位小数。\n\n离散化：\n- 使用一个均匀间隔的频率网格，其中 $f_{\\min} = 0.04$ Hz，$f_{\\max} = 0.50$ Hz，$\\Delta f = 0.005$ Hz。\n\n测试套件：\n- 情况1（风海主导）：$H_s = 2.5$ m, $f_p = 0.12$ Hz, $\\gamma = 3.3$, $u_* = 0.012$ m/s。\n- 情况2（涌浪主导）：$H_s = 3.0$ m, $f_p = 0.07$ Hz, $\\gamma = 1.5$, $u_* = 0.007$ m/s。\n- 情况3（弱海况）：$H_s = 0.5$ m, $f_p = 0.20$ Hz, $\\gamma = 3.3$, $u_* = 0.005$ m/s。\n- 情况4（窄峰）：$H_s = 1.0$ m, $f_p = 0.15$ Hz, $\\gamma = 7.0$, $u_* = 0.010$ m/s。\n\n算法和数值设计要求：\n- 你的推导必须明确地将深水色散关系和拉格朗日平均漂移的定义，与一个对浮标谱 $S(f)$ 的可计算积分联系起来，然后再与一个对频率网格的离散求和联系起来。\n- 你必须明确定义你所做的任何近似，例如假设深水条件以及使用全向谱代替完全有向谱。\n- 使用一致的黎曼和或梯形法则来实现频率上的数值积分。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 该列表必须按顺序包含四个测试用例的 $U_{s0}$ 和 $La_t$，总共八个数字：$[U_{s0}^{(1)}, La_t^{(1)}, U_{s0}^{(2)}, La_t^{(2)}, U_{s0}^{(3)}, La_t^{(3)}, U_{s0}^{(4)}, La_t^{(4)}]$。\n- 在打印前将每个数字四舍五入到六位小数。",
            "solution": "该问题是有效的，因为它在物理海洋学原理上有科学依据，问题定义良好，提供了所有必要信息，并且可以进行数学形式化。每个测试用例都可以获得唯一的数值解。\n\n**1. 理论推导**\n\n主要目标是推导出一个可计算的表达式，用于从全向波谱 $S(f)$ 计算表面斯托克斯漂移速度 $U_{s0}$ 和湍流朗缪尔数 $La_t$。\n\n**1.1. 从波谱计算表面斯托克斯漂移**\n\n对于一个随机、有向的线性波场，在平均海面以下深度 $z$ 处的拉格朗日平均漂移速度（即斯托克斯漂移）$\\vec{U}_s(z)$ 被定义为对有向波方差谱 $S(\\omega, \\theta)$ 的积分：\n$$ \\vec{U}_s(z) = \\iint 2\\omega k e^{2kz} S(\\omega, \\theta) \\vec{d}(\\theta) \\, d\\omega \\, d\\theta $$\n此处，$\\omega$ 是角频率，$k$ 是波数大小，$\\vec{d}(\\theta)$ 是波传播方向 $\\theta$ 上的单位矢量，$S(\\omega, \\theta)$ 是海面高程方差的有向谱，单位为 m$^2$/(rad/s)/rad。我们关心的是在表面 $z=0$ 处的漂移，这可将表达式简化为：\n$$ \\vec{U}_{s0} = \\iint 2\\omega k S(\\omega, \\theta) \\vec{d}(\\theta) \\, d\\omega \\, d\\theta $$\n问题提供的是以 Hz 为单位测量的全向波谱 $S(f)$，它与有向角频率谱的关系为 $S(f) = 2\\pi \\int_0^{2\\pi} S(\\omega, \\theta) d\\theta$，其中 $\\omega=2\\pi f$。仅凭全向数据，无法计算矢量斯托克斯漂移 $\\vec{U}_{s0}$。一个必要且标准的近似是，假设整个波场沿单一主导方向传播。这使我们能够通过对全向谱 $S(\\omega) = \\int S(\\omega, \\theta)d\\theta$ 进行积分来计算表面斯托克斯漂移的*大小* $U_{s0} = |\\vec{U}_{s0}|$:\n$$ U_{s0} = \\int 2\\omega k S(\\omega) d\\omega $$\n问题设定在深水中，因此我们使用线性深水色散关系：\n$$ \\omega^2 = gk $$\n其中 $g$ 是重力加速度。我们可以解出作为频率函数的波数 $k$：\n$$ k = \\frac{\\omega^2}{g} $$\n将此代入 $U_{s0}$ 的积分中：\n$$ U_{s0} = \\int 2\\omega \\left(\\frac{\\omega^2}{g}\\right) S(\\omega) \\, d\\omega = \\frac{2}{g} \\int \\omega^3 S(\\omega) \\, d\\omega $$\n提供的谱是循环频率 $f$（单位为赫兹）的函数。我们必须使用关系式 $\\omega = 2\\pi f$ 和 $S(\\omega)d\\omega = S(f)df$（这意味着 $S(\\omega) = S(f) \\frac{df}{d\\omega} = \\frac{S(f)}{2\\pi}$）来相应地转换积分。将这些代入积分中：\n$$ U_{s0} = \\frac{2}{g} \\int_{f_{min}}^{f_{max}} (2\\pi f)^3 \\left(\\frac{S(f)}{2\\pi}\\right) (2\\pi df) $$\n$$ U_{s0} = \\frac{2(2\\pi)^3}{g} \\int_{f_{min}}^{f_{max}} f^3 S(f) \\, df $$\n这是用全向频谱 $S(f)$ 表示的表面斯托克斯漂移速度的最终积分表达式。\n\n**1.2. 湍流朗缪尔数**\n\n湍流朗缪尔数 $La_t$ 是一个无量纲参数，用于量化剪切驱动的湍流（来自风应力）与波浪驱动的湍流（朗缪尔环流）的相对重要性。其定义为：\n$$ La_t = \\sqrt{\\frac{u_*}{U_{s0}}} $$\n其中 $u_*$ 是水面摩擦速度，是风应力的一种度量；$U_{s0}$ 是上文推导出的表面斯托克斯漂移速度。\n\n**2. 数值实现策略**\n\n推导出的公式必须进行数值实现。对于每个测试用例，整体算法如下。\n\n**2.1. JONSWAP 谱的构建**\n\n全向波谱 $S(f)$ 使用 JONSWAP 公式建模：\n$$ S(f) = \\alpha \\, \\frac{g^2}{(2\\pi)^4}\\, f^{-5} \\, \\exp\\!\\left(-\\frac{5}{4}\\,\\left(\\frac{f_p}{f}\\right)^{4}\\right)\\; \\gamma^{\\;\\exp\\!\\left(-\\frac{(f/f_p - 1)^2}{2\\sigma^2}\\right)} $$\n其中 $f_p$ 是峰值频率，$\\gamma$ 是峰值增强因子，$\\sigma$ 是一个形状参数，定义为当 $f \\le f_p$ 时 $\\sigma = 0.07$，当 $f > f_p$ 时 $\\sigma = 0.09$。参数 $\\alpha$ 是一个归一化常数。\n\n**2.2. 谱的归一化**\n\n必须确定常数 $\\alpha$，以使谱的总方差 $m_0$ 与由给定有效波高 $H_s$ 推导出的方差相匹配。\n目标方差为：\n$$ m_0 = \\frac{H_s^2}{16} $$\n我们首先通过在 JONSWAP 公式中设置 $\\alpha=1$ 来计算未归一化的谱 $S_{un}(f)$。然后，我们通过在指定的频率网格 [$f_{min}, f_{max}$] 上进行数值积分来计算该未归一化谱的方差 $m_{0,un}$：\n$$ m_{0,un} = \\int_{f_{min}}^{f_{max}} S_{un}(f) \\, df $$\n归一化常数 $\\alpha$ 则通过以下方式求得：\n$$ \\alpha = \\frac{m_0}{m_{0,un}} = \\frac{H_s^2/16}{m_{0,un}} $$\n完全归一化的谱是 $S(f) = \\alpha S_{un}(f)$。\n\n**2.3. 数值积分**\n\n$m_{0,un}$ 和 $U_{s0}$ 的积分都在离散频率网格 $f_i$（其中 $i=0, \\dots, N$）上进行数值计算。频率网格是均匀的，给定参数为 $f_{\\min} = 0.04$ Hz, $f_{\\max} = 0.50$ Hz, 以及 $\\Delta f = 0.005$ Hz。梯形法则是完成此任务的合适方法，其精度优于简单的黎曼和。对于函数 $Y(f)$，其积分近似为：\n$$ \\int Y(f) \\, df \\approx \\Delta f \\left( \\frac{Y(f_0) + Y(f_N)}{2} + \\sum_{i=1}^{N-1} Y(f_i) \\right) $$\n\n**2.4. 最终计算**\n\n在网格上定义了归一化谱 $S(f_i)$ 后，通过将其积分形式离散化来计算表面斯托克斯漂移 $U_{s0}$：\n$$ U_{s0} \\approx \\sum_{i} \\frac{2(2\\pi)^3 f_i^3}{g} S(f_i) \\, \\Delta f $$\n（使用梯形法则进行求和）。最后，使用给定的摩擦速度 $u_*$ 计算朗缪尔数：\n$$ La_t = \\sqrt{\\frac{u_*}{U_{s0}}} $$\n每个案例的 $U_{s0}$ 和 $La_t$ 结果都按照要求四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes surface Stokes drift and Langmuir number from JONSWAP spectra.\n    \"\"\"\n    \n    # Constants\n    g = 9.81  # Gravitational acceleration in m/s^2\n\n    # Discretization parameters\n    f_min = 0.04   # Hz\n    f_max = 0.50   # Hz\n    df = 0.005     # Hz\n    \n    # Frequency grid\n    f = np.arange(f_min, f_max + df/2, df)\n\n\n    # Test cases: (Hs, fp, gamma, u_star)\n    test_cases = [\n        (2.5, 0.12, 3.3, 0.012),  # Case 1 (wind-sea dominated)\n        (3.0, 0.07, 1.5, 0.007),  # Case 2 (swell dominated)\n        (0.5, 0.20, 3.3, 0.005),  # Case 3 (weak sea)\n        (1.0, 0.15, 7.0, 0.010),  # Case 4 (narrow-peaked)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        Hs, fp, gamma, u_star = case\n\n        # 1. Construct the un-normalized JONSWAP spectrum S_un(f)\n        \n        # Shape parameter sigma\n        sigma = np.where(f <= fp, 0.07, 0.09)\n        \n        # Pierson-Moskowitz part of the spectrum\n        term1 = (g**2) / ((2 * np.pi)**4) * f**(-5)\n        term2 = np.exp(-5/4 * (fp / f)**4)\n        \n        # Peak enhancement part\n        r = np.exp(-(f / fp - 1)**2 / (2 * sigma**2))\n        term3 = gamma**r\n        \n        S_un = term1 * term2 * term3\n\n        # 2. Normalize the spectrum\n        \n        # Compute variance of the un-normalized spectrum\n        m0_un = np.trapz(S_un, f)\n        \n        # Compute target variance from Hs\n        m0_target = Hs**2 / 16.0\n        \n        # Compute normalization factor alpha\n        alpha = m0_target / m0_un\n        \n        # The final, normalized JONSWAP spectrum\n        S_f = alpha * S_un\n\n        # 3. Compute Surface Stokes Drift U_s0\n        \n        # Integrand for U_s0 calculation\n        integrand = (2 * (2 * np.pi)**3 * f**3 / g) * S_f\n        \n        # Integrate to get U_s0\n        U_s0 = np.trapz(integrand, f)\n        \n        # 4. Compute Turbulent Langmuir Number La_t\n        \n        # Avoid division by zero or sqrt of negative, although unlikely here\n        if U_s0 > 0:\n            La_t = np.sqrt(u_star / U_s0)\n        else:\n            La_t = np.inf # Or some other indicator of an issue\n            \n        # 5. Store results, rounded to six decimal places\n        results.append(round(U_s0, 6))\n        results.append(round(La_t, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}