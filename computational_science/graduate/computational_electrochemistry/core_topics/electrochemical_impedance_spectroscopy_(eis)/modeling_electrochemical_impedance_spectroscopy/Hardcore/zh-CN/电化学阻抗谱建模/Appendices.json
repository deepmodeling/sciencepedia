{
    "hands_on_practices": [
        {
            "introduction": "第一个实践是基础性的。我们将从第一性原理出发，为一个简单但至关重要的等效电路建立阻抗模型，并用它来预测其频谱特征的一个关键特性。这个练习可以锻炼复数代数技巧，并帮助我们建立关于电路元件如何影响阻抗谱的直观理解 。",
            "id": "4252778",
            "problem": "一个简单电极过程的电化学阻抗谱（EIS）测量可以通过一个兰德尔斯电路（Randles circuit）来建模，该电路由一个溶液电阻 $R_{s}$ 与一个电荷转移电阻 $R_{\\text{ct}}$ 和一个双电层电容 $C_{\\text{dl}}$ 的并联组合串联而成。假设元件为理想元件，且没有扩散（Warburg）贡献。仅使用电阻阻抗 $Z_{R} = R$ 和电容阻抗 $Z_{C} = \\frac{1}{j \\omega C}$ 的基本定义，以及串并联组合规则，推导出该电路随角频率变化的复阻抗 $Z(\\omega)$，并确定奈奎斯特半圆达到其顶点的角频率。该顶点对应于奈奎斯特图上虚部 $Z''(\\omega)$ 的最负值。\n\n给定 $R_{s} = 2.50\\,\\Omega$，$R_{\\text{ct}} = 75.0\\,\\Omega$ 以及 $C_{\\text{dl}} = 150.0\\,\\mu\\mathrm{F}$，计算：\n- 顶点频率 $f_{\\text{apex}}$，单位为 $\\mathrm{Hz}$，其中 $f_{\\text{apex}} = \\frac{\\omega_{\\text{apex}}}{2\\pi}$，以及\n- 对应的最小虚部值 $Z''_{\\min}$，单位为 $\\Omega$。\n\n将两个数值答案四舍五入至四位有效数字。频率以 $\\mathrm{Hz}$ 表示，虚部值以 $\\Omega$ 表示。",
            "solution": "该问题是有效的，因为它在科学上基于电路理论和电化学原理，问题陈述清晰且提供了足够的信息以获得唯一解，并且陈述是客观的。我们开始求解。\n\n该电化学系统由一个兰德尔斯电路（Randles circuit）建模。总阻抗 $Z(\\omega)$ 由一个溶液电阻 $R_s$ 与一个电荷转移电阻 $R_{\\text{ct}}$ 和一个双电层电容 $C_{\\text{dl}}$ 的并联组合串联而成。\n\n电阻 $R$ 的阻抗为 $Z_R = R$，电容 $C$ 的阻抗为 $Z_C = \\frac{1}{j \\omega C}$，其中 $j = \\sqrt{-1}$ 是虚数单位，$\\omega$ 是角频率。\n\n首先，我们确定电路并联部分 $Z_p$ 的阻抗，它由 $R_{\\text{ct}}$ 和 $C_{\\text{dl}}$ 组成。对于并联元件，总阻抗的倒数等于各部分阻抗倒数之和：\n$$ \\frac{1}{Z_p(\\omega)} = \\frac{1}{Z_{R_{\\text{ct}}}} + \\frac{1}{Z_{C_{\\text{dl}}}} $$\n代入阻抗的定义，我们得到：\n$$ \\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\text{ct}}} + \\frac{1}{1/(j \\omega C_{\\text{dl}})} = \\frac{1}{R_{\\text{ct}}} + j \\omega C_{\\text{dl}} $$\n为了求解 $Z_p(\\omega)$，我们取其倒数：\n$$ Z_p(\\omega) = \\left( \\frac{1}{R_{\\text{ct}}} + j \\omega C_{\\text{dl}} \\right)^{-1} = \\left( \\frac{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}}{R_{\\text{ct}}} \\right)^{-1} = \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\n\n电路的总阻抗 $Z(\\omega)$ 是串联元件 $R_s$ 和 $Z_p(\\omega)$ 的和。\n$$ Z(\\omega) = R_s + Z_p(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\n为了将总阻抗分离成其实部 $Z'(\\omega)$ 和虚部 $Z''(\\omega)$，我们将第二项的分子和分母同乘以其分母的复共轭 $1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}$：\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} \\times \\frac{1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}}{1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}} (1 - j \\omega R_{\\text{ct}} C_{\\text{dl}})}{1^2 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} - j \\frac{\\omega R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n从这个表达式中，我们确定实部和虚部：\n$$ Z'(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n$$ Z''(\\omega) = - \\frac{\\omega R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n\n奈奎斯特半圆的顶点对应于虚部 $Z''(\\omega)$ 的极值（最小值）。为了找到出现该极值的角频率 $\\omega_{\\text{apex}}$，我们对 $Z''(\\omega)$ 关于 $\\omega$ 求导，并令其为零。我们定义电荷转移过程的特征时间常数为 $\\tau = R_{\\text{ct}} C_{\\text{dl}}$。\n$$ Z''(\\omega) = - \\frac{\\omega R_{\\text{ct}} \\tau}{1 + (\\omega \\tau)^2} $$\n使用微分的商法则 $\\frac{d}{dx}(\\frac{u}{v}) = \\frac{u'v - uv'}{v^2}$，其中 $u = \\omega$ 且 $v = 1 + (\\omega \\tau)^2$：\n$$ \\frac{dZ''}{d\\omega} = -R_{\\text{ct}}\\tau \\frac{d}{d\\omega} \\left( \\frac{\\omega}{1 + (\\omega\\tau)^2} \\right) = -R_{\\text{ct}}\\tau \\left[ \\frac{(1)(1 + (\\omega\\tau)^2) - (\\omega)(2\\omega\\tau^2)}{(1 + (\\omega\\tau)^2)^2} \\right] $$\n$$ \\frac{dZ''}{d\\omega} = -R_{\\text{ct}}\\tau \\left[ \\frac{1 + \\omega^2\\tau^2 - 2\\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} \\right] = -R_{\\text{ct}}\\tau \\frac{1 - \\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} $$\n将导数设为零以求极值：\n$$ \\frac{1 - \\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} = 0 $$\n当分子为零时，此条件成立。由于 $\\omega$ 必须为正，我们有：\n$$ 1 - \\omega^2\\tau^2 = 0 \\implies \\omega^2\\tau^2 = 1 \\implies \\omega_{\\text{apex}} = \\frac{1}{\\tau} $$\n将 $\\tau = R_{\\text{ct}} C_{\\text{dl}}$ 代回，我们得到顶点的角频率：\n$$ \\omega_{\\text{apex}} = \\frac{1}{R_{\\text{ct}} C_{\\text{dl}}} $$\n现在我们可以通过将 $\\omega_{\\text{apex}}$ 代入 $Z''(\\omega)$ 的表达式来计算虚部的最小值 $Z''_{\\min}$：\n$$ Z''_{\\min} = Z''(\\omega_{\\text{apex}}) = - \\frac{\\omega_{\\text{apex}} R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega_{\\text{apex}} R_{\\text{ct}} C_{\\text{dl}})^2} $$\n由于 $\\omega_{\\text{apex}} R_{\\text{ct}} C_{\\text{dl}} = (\\frac{1}{R_{\\text{ct}} C_{\\text{dl}}}) R_{\\text{ct}} C_{\\text{dl}} = 1$：\n$$ Z''_{\\min} = - \\frac{(\\frac{1}{R_{\\text{ct}} C_{\\text{dl}}}) R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + 1^2} = - \\frac{R_{\\text{ct}}}{2} $$\n\n现在，我们使用给定的数据计算数值：$R_{\\text{ct}} = 75.0\\,\\Omega$ 和 $C_{\\text{dl}} = 150.0\\,\\mu\\mathrm{F} = 150.0 \\times 10^{-6}\\,\\mathrm{F}$。\n\n首先，我们计算顶点角频率 $\\omega_{\\text{apex}}$：\n$$ \\omega_{\\text{apex}} = \\frac{1}{(75.0\\,\\Omega) \\times (150.0 \\times 10^{-6}\\,\\mathrm{F})} = \\frac{1}{0.01125\\,\\mathrm{s}} \\approx 88.888... \\,\\mathrm{rad/s} $$\n题目要求以 $\\mathrm{Hz}$ 为单位的频率 $f_{\\text{apex}}$，它与角频率的关系为 $f = \\frac{\\omega}{2\\pi}$：\n$$ f_{\\text{apex}} = \\frac{\\omega_{\\text{apex}}}{2\\pi} = \\frac{1}{2\\pi R_{\\text{ct}} C_{\\text{dl}}} = \\frac{1}{2\\pi \\times 0.01125\\,\\mathrm{s}} \\approx 14.1444\\,\\mathrm{Hz} $$\n四舍五入到四位有效数字，我们得到 $f_{\\text{apex}} = 14.14\\,\\mathrm{Hz}$。\n\n接下来，我们计算最小虚部值 $Z''_{\\min}$：\n$$ Z''_{\\min} = - \\frac{R_{\\text{ct}}}{2} = - \\frac{75.0\\,\\Omega}{2} = -37.5\\,\\Omega $$\n为了表示为四位有效数字，我们写作 $Z''_{\\min} = -37.50\\,\\Omega$。\n\n所要求的值是顶点频率 $f_{\\text{apex}}$ 和最小虚部 $Z''_{\\min}$。\n$f_{\\text{apex}} \\approx 14.14\\,\\mathrm{Hz}$\n$Z''_{\\min} = -37.50\\,\\Omega$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 14.14  -37.50 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实的电化学界面很少表现为理想电容器。本练习通过探索恒相元件 (CPE) 在分数阶微积分中的数学起源，介绍了这一更符合实际的模型。通过推导其阻抗，您将揭示其名称的由来，并学会计算其特性，这是构建更精确EIS模型的关键一步 。",
            "id": "4252722",
            "problem": "考虑一个线性时不变电极界面，在电化学阻抗谱（EIS）中被建模为恒相元件（CPE）。CPE 在时域中由电流 $i(t)$ 和电压 $v(t)$ 之间的本构关系定义，即 $i(t) = Q\\,\\mathcal{D}_t^{\\,n} v(t)$，其中 $Q$ 是一个正常数，$0  n \\leq 1$ 是一个常数，$\\mathcal{D}_t^{\\,n}$ 是阶数为 $n$ 的 Caputo 分数阶导数。\n\n**任务：**\n1.  推导该元件的复阻抗 $Z(\\omega)$。\n2.  证明该元件的阻抗相位 $\\phi(\\omega)$ 确实是恒定的，等于 $-n\\pi/2$ 弧度，从而验证其名称的合理性。\n3.  对于参数 $Q = 1.20\\times 10^{-3} \\, \\mathrm{S\\,s^{n}}$ 和 $n = 0.50$，在频率 $f = 100 \\, \\mathrm{Hz}$ 时，计算其阻抗的幅值 $|Z(\\omega)|$，其中 $\\omega = 2\\pi f$。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导恒相元件（CPE）的阻抗，证明其相位特性，并在特定条件下对其阻抗幅值进行数值计算。\n\n首先，我们验证问题的有效性。\n**步骤 1：提取已知条件**\n- 本构关系：$i(t) = Q\\,\\mathcal{D}_t^{\\,n} v(t)$\n- $Q$：一个单位为 $\\mathrm{S\\,s^{n}}$ 的正常数\n- $n$：一个常数，满足 $0  n \\leq 1$\n- $\\mathcal{D}_t^{\\,n}$：$n$ 阶 Caputo 分数阶导数\n- 激励：$v(t) = \\Re\\{V_{0}\\exp(\\mathrm{j}\\omega t)\\}$\n- 系统：线性时不变（LTI）\n- 计算参数：$Q = 1.20\\times 10^{-3} \\, \\mathrm{S\\,s^{n}}$，$n = 0.50$，$f = 100 \\, \\mathrm{Hz}$\n- 角频率：$\\omega = 2\\pi f$\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当且客观。恒相元件是电化学阻抗谱中的一个标准模型。使用 Caputo 分数阶导数适用于物理系统。给定的参数和物理单位是一致且符合实际的。该问题可以使用分数阶微积分和电路理论的既定原理进行形式化和求解。\n\n**步骤 3：结论与行动**\n问题有效。我们开始求解。\n\n**复阻抗 $Z(\\omega)$ 的推导**\n\nLTI 系统的阻抗 $Z(\\omega)$ 在频域中定义为电压相量 $\\tilde{V}(\\omega)$ 与电流相量 $\\tilde{I}(\\omega)$ 的比值，或者等效地，对于正弦稳态激励，定义为复电压幅值与复电流幅值的比值。\n\n设复电压为 $v_c(t) = V_0 \\exp(\\mathrm{j}\\omega t)$，其中 $V_0$ 是复数幅值。物理电压为 $v(t) = \\Re\\{v_c(t)\\}$。由于系统的 LTI 特性，对此复电压的稳态电流响应也将是同频率的复指数函数，$i_c(t) = I_0 \\exp(\\mathrm{j}\\omega t)$，其中 $I_0$ 是复电流幅值。\n\n本构关系在时域中给出为：\n$$i(t) = Q\\,\\mathcal{D}_t^{\\,n} v(t)$$\n对于复信号，此关系变为：\n$$i_c(t) = Q\\,\\mathcal{D}_t^{\\,n} v_c(t)$$\n我们需要计算复电压 $v_c(t)$ 的 Caputo 分数阶导数。分数阶导数的一个基本性质是它对指数函数的作用。对于函数 $f(t) = \\exp(at)$，其分数阶导数为 $\\mathcal{D}_t^{\\,n} \\exp(at) = a^n \\exp(at)$。在我们的例子中，$v_c(t)=V_0 \\exp(\\mathrm{j}\\omega t)$，所以 $a = \\mathrm{j}\\omega$。\n应用此性质：\n$$\\mathcal{D}_t^{\\,n} v_c(t) = \\mathcal{D}_t^{\\,n} \\left(V_0 \\exp(\\mathrm{j}\\omega t)\\right) = V_0 (\\mathrm{j}\\omega)^n \\exp(\\mathrm{j}\\omega t) = (\\mathrm{j}\\omega)^n v_c(t)$$\n将此结果代回复本构关系中，得到：\n$$i_c(t) = Q \\left( (\\mathrm{j}\\omega)^n v_c(t) \\right)$$\n复阻抗 $Z(\\omega)$ 是复电压与复电流的比值：\n$$Z(\\omega) = \\frac{v_c(t)}{i_c(t)} = \\frac{v_c(t)}{Q (\\mathrm{j}\\omega)^n v_c(t)}$$\n$$Z(\\omega) = \\frac{1}{Q(\\mathrm{j}\\omega)^n}$$\n这是 CPE 阻抗的一般表达式。\n\n**阻抗相位 $\\phi(\\omega)$ 的分析**\n\n为了分析 $Z(\\omega)$ 的相位，我们将 $(\\mathrm{j}\\omega)^n$ 项表示为极坐标形式。复数 $\\mathrm{j}$ 可以写成极坐标形式 $\\mathrm{j} = \\exp(\\mathrm{j}\\pi/2)$。由于角频率 $\\omega$ 是一个正常数，我们有：\n$$\\mathrm{j}\\omega = \\omega \\exp(\\mathrm{j}\\pi/2)$$\n使用复数的幂法则 $(r\\exp(\\mathrm{j}\\theta))^n = r^n\\exp(\\mathrm{j}n\\theta)$，我们得到：\n$$(\\mathrm{j}\\omega)^n = \\left(\\omega \\exp(\\mathrm{j}\\pi/2)\\right)^n = \\omega^n \\exp(\\mathrm{j}n\\pi/2)$$\n将此代入阻抗表达式中：\n$$Z(\\omega) = \\frac{1}{Q\\left(\\omega^n \\exp(\\mathrm{j}n\\pi/2)\\right)} = \\frac{1}{Q\\omega^n} \\frac{1}{\\exp(\\mathrm{j}n\\pi/2)}$$\n使用性质 $1/\\exp(\\mathrm{j}\\theta) = \\exp(-\\mathrm{j}\\theta)$，我们发现：\n$$Z(\\omega) = \\frac{1}{Q\\omega^n} \\exp(-\\mathrm{j}n\\pi/2)$$\n阻抗 $Z(\\omega)$ 是一个以极坐标形式表示的复数，$Z(\\omega) = |Z(\\omega)|\\exp(\\mathrm{j}\\phi(\\omega))$。通过比较这两个表达式，我们可以确定其幅值 $|Z(\\omega)|$ 和相位 $\\phi(\\omega)$：\n$$|Z(\\omega)| = \\frac{1}{Q\\omega^n}$$\n$$\\phi(\\omega) = -\\frac{n\\pi}{2}$$\n相位 $\\phi(\\omega)$ 仅取决于参数 $n$，而与频率 $\\omega$ 无关。这证实了该元件的“恒相”特性。相位确实等于 $-n\\pi/2$ 弧度。\n\n**阻抗幅值的数值计算**\n\n我们已知以下参数：\n- $Q = 1.20 \\times 10^{-3} \\, \\mathrm{S\\,s^{n}}$\n- $n = 0.50$\n- $f = 100 \\, \\mathrm{Hz}$\n\n首先，我们计算角频率 $\\omega$：\n$$\\omega = 2\\pi f = 2 \\times \\pi \\times 100 = 200\\pi \\, \\mathrm{rad/s}$$\n接下来，我们使用前面推导出的阻抗幅值公式：\n$$|Z(\\omega)| = \\frac{1}{Q\\omega^n}$$\n代入给定值：\n$$|Z(200\\pi)| = \\frac{1}{(1.20 \\times 10^{-3}) \\times (200\\pi)^{0.50}}$$\n让我们计算分母的值。\n$$(200\\pi)^{0.50} = \\sqrt{200\\pi} \\approx \\sqrt{628.3185} \\approx 25.06627 \\, \\mathrm{s^{-0.5}}$$\n现在，乘以 $Q$：\n$$(1.20 \\times 10^{-3}) \\times 25.06627 \\approx 0.0300795 \\, \\mathrm{S}$$\n最后，我们计算阻抗的幅值：\n$$|Z(200\\pi)| = \\frac{1}{0.0300795} \\approx 33.2452 \\, \\Omega$$\n问题要求将答案四舍五入到四位有效数字。\n$$|Z(200\\pi)| \\approx 33.25 \\, \\Omega$$\n最终的数值答案是 $33.25$。",
            "answer": "$$\\boxed{33.25}$$"
        },
        {
            "introduction": "最后一个实践在一个真实的建模场景中融合了理论与计算。您将为一个包含扩散效应的Randles电路构建模型，通过编程实现它，然后用它来评估与数据集的拟合优度。这项练习模拟了计算电化学家的日常工作，弥合了分析方程与实际数据分析之间的差距 。",
            "id": "4252755",
            "problem": "您的任务是基于线性电路理论的基本原理，构建并验证一个兰德尔斯电路的电化学阻抗谱（EIS）数据模拟。该兰德尔斯电路包含一个串联的溶液电阻，以及一个由双电层电容和法拉第支路（包含电荷转移电阻和半无限扩散）组成的并联结构。您必须推导电路的阻抗，模拟跨越数个数量级的频率下的复阻抗，通过确定性微扰合成测量数据，并评估模拟模型与测量数据在实部和虚部上的残差。\n\n您的推导和计算必须仅基于以下基本要素：\n- 基于线性响应理论和欧姆定律的频域阻抗定义。\n- 对于电阻器，阻抗是恒定的实数。\n- 对于电容器，阻抗由 $Z_{C}(\\omega) = \\dfrac{1}{j \\, \\omega \\, C}$ 给出，其中 $j = \\sqrt{-1}$，$\\omega$ 是角频率。\n- 对于半无限扩散，瓦伯格阻抗由 $Z_{W}(\\omega) = \\dfrac{\\sigma \\, (1 - j)}{\\sqrt{\\omega}}$ 给出，其中 $\\sigma$ 是瓦伯格系数。\n- 阻抗的串联和并联组合规则：串联时，阻抗相加；并联时，$Z_{\\mathrm{parallel}} = \\left(\\sum_{k} \\dfrac{1}{Z_{k}}\\right)^{-1}$。\n\n待建模的电路拓扑：\n- 一个溶液电阻 $R_{s}$ 与一个并联网络串联，该并联网络由一个双电层电容 $C_{\\mathrm{dl}}$ 和一个法拉第支路（由电荷转移电阻 $R_{\\mathrm{ct}}$ 与瓦伯格元件 $Z_{W}(\\omega)$ 串联组成）构成。\n\n任务：\n1. 从上述定义出发，推导所述兰德尔斯电路的总复阻抗 $Z(\\omega)$ 的数学表达式。不要使用或引用任何关于 $Z(\\omega)$ 的现成目标表达式；需通过正确的串并联化简从基本定义推导。\n2. 实现一个程序，该程序：\n   - 通过 $\\omega = 2\\pi f$ 将以赫兹为单位的频率转换为角频率。\n   - 对于给定的参数集 $\\{R_{s}, R_{\\mathrm{ct}}, C_{\\mathrm{dl}}, \\sigma\\}$，计算在一系列指定频率下模型的预测值 $Z_{\\mathrm{model}}(\\omega)$。\n   - 通过采用一组“基准”参数集，计算其对应的 $Z(\\omega)$，并添加一个下面指定的确定性微扰 $\\delta Z(\\omega)$（其实部和虚部均已指定），来合成一个测量数据集 $Z_{\\mathrm{meas}}(\\omega)$。\n   - 计算所有频率 $k$ 下的残差 $r^{\\prime}_{k} = Z^{\\prime}_{\\mathrm{meas}}(\\omega_{k}) - Z^{\\prime}_{\\mathrm{model}}(\\omega_{k})$ 和 $r^{\\prime\\prime}_{k} = Z^{\\prime\\prime}_{\\mathrm{meas}}(\\omega_{k}) - Z^{\\prime\\prime}_{\\mathrm{model}}(\\omega_{k})$。\n   - 针对每个测试用例报告三个指标：实部残差的均方根误差（RMSE）、虚部残差的RMSE，以及由 $\\sqrt{(r^{\\prime}_{k})^{2} + (r^{\\prime\\prime}_{k})^{2}}$ 定义并在所有 $k$ 上平均的复数模的RMSE。所有指标都必须以欧姆为单位，并应为四舍五入到六位小数的浮点数。\n\n频率和单位：\n- 使用以赫兹为单位的频率列表 $f$：$[\\,0.1,\\,1,\\,10,\\,100,\\,1000,\\,10000\\,]$。\n- 角频率为 $\\omega = 2\\pi f$，单位为弧度/秒。\n- 电阻单位为欧姆 $\\Omega$，电容单位为法拉 $\\mathrm{F}$，瓦伯格系数参数 $\\sigma$ 的单位使得 $Z_{W}(\\omega)$ 的单位为欧姆 $\\Omega$，输出的残差指标必须以欧姆 $\\Omega$ 表示，并四舍五入到六位小数。\n\n测试套件：\n实现您的程序以评估以下三个测试用例。在每个用例中，按如下方式构建测量数据：\n$$\nZ_{\\mathrm{meas}}(\\omega_{k}) \\;=\\; Z\\big(\\omega_{k}; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast}\\big) \\;+\\; \\big(\\delta Z^{\\prime}_{k}\\big) \\;+\\; j\\,\\big(\\delta Z^{\\prime\\prime}_{k}\\big),\n$$\n其中带星号的参数表示用于生成综合测量的基准集，而 $\\delta Z^{\\prime}_{k}$、$\\delta Z^{\\prime\\prime}_{k}$ 是在频率索引 $k$ 下实部和虚部的确定性微扰。\n\n- 用例 1（理想情况，中等扩散）：\n  - 基准参数：$R_{s}^{\\ast} = 5$, $R_{\\mathrm{ct}}^{\\ast} = 100$, $C_{\\mathrm{dl}}^{\\ast} = 2\\times 10^{-5}$, $\\sigma^{\\ast} = 10$。\n  - 候选参数（用于 $Z_{\\mathrm{model}}$）：$R_{s} = 5$, $R_{\\mathrm{ct}} = 100$, $C_{\\mathrm{dl}} = 2\\times 10^{-5}$, $\\sigma = 10$。\n  - 确定性微扰（单位：欧姆）：\n    - 实部：$\\big[\\,0.05,\\,-0.03,\\,0.02,\\,-0.01,\\,0.00,\\,0.01\\,\\big]$，\n    - 虚部：$\\big[\\,-0.04,\\,0.02,\\,-0.01,\\,0.00,\\,0.01,\\,-0.02\\,\\big]$。\n\n- 用例 2（参数不匹配，残差较强）：\n  - 基准参数：$R_{s}^{\\ast} = 3$, $R_{\\mathrm{ct}}^{\\ast} = 150$, $C_{\\mathrm{dl}}^{\\ast} = 1\\times 10^{-5}$, $\\sigma^{\\ast} = 8$。\n  - 候选参数（用于 $Z_{\\mathrm{model}}$）：$R_{s} = 3$, $R_{\\mathrm{ct}} = 130$, $C_{\\mathrm{dl}} = 1.2\\times 10^{-5}$, $\\sigma = 5$。\n  - 确定性微扰（单位：欧姆）：\n    - 实部：$\\big[\\,0.20,\\,-0.10,\\,0.10,\\,-0.10,\\,0.05,\\,-0.05\\,\\big]$，\n    - 虚部：$\\big[\\,-0.15,\\,0.10,\\,-0.05,\\,0.00,\\,0.05,\\,-0.10\\,\\big]$。\n\n- 用例 3（边界条件，无扩散）：\n  - 基准参数：$R_{s}^{\\ast} = 2$, $R_{\\mathrm{ct}}^{\\ast} = 200$, $C_{\\mathrm{dl}}^{\\ast} = 5\\times 10^{-6}$, $\\sigma^{\\ast} = 0$。\n  - 候选参数（用于 $Z_{\\mathrm{model}}$）：$R_{s} = 2$, $R_{\\mathrm{ct}} = 200$, $C_{\\mathrm{dl}} = 5\\times 10^{-6}$, $\\sigma = 0$。\n  - 确定性微扰（单位：欧姆）：\n    - 实部：$\\big[\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,\\big]$，\n    - 虚部：$\\big[\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,\\big]$。\n\n输出规范：\n- 对每个测试用例，计算三个以欧姆为单位的浮点数：$\\mathrm{RMSE}_{\\mathrm{real}}$、$\\mathrm{RMSE}_{\\mathrm{imag}}$ 和 $\\mathrm{RMSE}_{\\mathrm{mag}}$，每个都四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个扁平的、逗号分隔的列表，该列表包含所有九个结果，并用方括号括起来。结果按测试用例排序，在每个用例内按指标顺序 $\\big(\\mathrm{RMSE}_{\\mathrm{real}}, \\mathrm{RMSE}_{\\mathrm{imag}}, \\mathrm{RMSE}_{\\mathrm{mag}}\\big)$ 排列。例如，输出格式必须为：\n$$\n\\big[\\mathrm{RMSE}^{(1)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(1)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(1)}_{\\mathrm{mag}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{mag}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{mag}}\\big],\n$$\n每个条目的单位均为欧姆 $\\Omega$。",
            "solution": "该问题已经过验证，被认为是科学上可靠、提法恰当且自洽的。所有提供的信息都是一致且足以推导出唯一、可验证的解。其基本原理是线性电路理论和电化学中的标准内容。我们现在开始求解。\n\n主要任务是对兰德尔斯电路的阻抗进行建模，并分析模型预测与综合生成数据之间的残差。这涉及两个主要部分：首先，是总电路阻抗的解析推导；其次，是模型和残差分析的计算实现。\n\n**1. 总复阻抗 $Z(\\omega)$ 的推导**\n\n问题指定了一个具有特定拓扑结构的兰德尔斯电路。我们将通过使用提供的串并联规则，系统地组合其组成元件的阻抗，来推导其总阻抗 $Z(\\omega)$ 的表达式。\n\n该电路由一个溶液电阻 $R_s$ 与一个并联子网络串联而成。该子网络包含两个并联支路：\n- 支路1：一个电容为 $C_{\\mathrm{dl}}$ 的双电层电容器。\n- 支路2：一个法拉第支路，其本身由一个电荷转移电阻 $R_{\\mathrm{ct}}$ 与一个瓦伯格元件 $Z_W$ 串联组成。\n\n让我们在频域中定义每个独立元件的阻抗，其中 $\\omega$ 是角频率，$j = \\sqrt{-1}$ 是虚数单位。\n- 溶液电阻的阻抗是纯实数：$Z_{R_s} = R_s$。\n- 电荷转移电阻的阻抗也是纯实数：$Z_{R_{\\mathrm{ct}}} = R_{\\mathrm{ct}}$。\n- 双电层电容器的阻抗由 $Z_{C_{\\mathrm{dl}}}(\\omega) = \\dfrac{1}{j \\omega C_{\\mathrm{dl}}}$ 给出。\n- 瓦伯格元件的阻抗由 $Z_W(\\omega) = \\dfrac{\\sigma (1 - j)}{\\sqrt{\\omega}}$ 给出，可以写成 $Z_W(\\omega) = \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}$。\n\n首先，我们求法拉第支路 $Z_F(\\omega)$ 的阻抗，它是 $R_{\\mathrm{ct}}$ 和 $Z_W(\\omega)$ 的串联组合。使用串联相加规则 $Z_{\\mathrm{series}} = \\sum_k Z_k$：\n$$\nZ_F(\\omega) = Z_{R_{\\mathrm{ct}}} + Z_W(\\omega) = R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}\n$$\n\n接下来，我们求并联子网络 $Z_p(\\omega)$ 的阻抗。该网络由法拉第支路 $Z_F(\\omega)$ 与双电层电容器 $Z_{C_{\\mathrm{dl}}}(\\omega)$ 并联组成。使用并联组合规则 $Z_{\\mathrm{parallel}} = \\left(\\sum_k \\frac{1}{Z_k}\\right)^{-1}$：\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{Z_F(\\omega)} + \\frac{1}{Z_{C_{\\mathrm{dl}}}(\\omega)}\n$$\n代入 $Z_F(\\omega)$ 和 $Z_{C_{\\mathrm{dl}}}(\\omega)$ 的表达式：\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + \\frac{1}{(1 / (j \\omega C_{\\mathrm{dl}}))}\n$$\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}}\n$$\n因此，并联子网络的阻抗为：\n$$\nZ_p(\\omega) = \\left( \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}} \\right)^{-1}\n$$\n\n最后，兰德尔斯电路的总阻抗 $Z(\\omega)$ 是溶液电阻 $R_s$ 和并联子网络 $Z_p(\\omega)$ 的串联组合。再次应用串联相加规则：\n$$\nZ(\\omega) = Z_{R_s} + Z_p(\\omega)\n$$\n代入 $Z_p(\\omega)$ 的表达式，我们得到从基本原理推导出的总复阻抗的最终表达式：\n$$\nZ(\\omega) = R_s + \\left( \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}} \\right)^{-1}\n$$\n\n**2. 计算方法与残差分析**\n\n程序将实现推导出的表达式，以计算阻抗值并对三个测试用例中的每一个进行所需的分析。\n\n对于给定的参数集 $\\{R_s, R_{\\mathrm{ct}}, C_{\\mathrm{dl}}, \\sigma\\}$ 和频率列表 $f_k$，模型阻抗 $Z_{\\mathrm{model}}(\\omega_k)$ 的计算如下：\n- 对于给定列表 $[\\,0.1,\\,1,\\,10,\\,100,\\,1000,\\,10000\\,]\\ \\mathrm{Hz}$ 中的每个频率 $f_k$，计算角频率 $\\omega_k = 2\\pi f_k$。\n- 使用推导出的公式计算复阻抗 $Z_{\\mathrm{model}}(\\omega_k)$。在计算中，这涉及复数算术。例如，在 Python 中，$j$ 表示为 `1j`。表达式变为 `Rs + 1.0 / (1.0 / (Rct + sigma * omega**-0.5 - 1j * sigma * omega**-0.5) + 1j * omega * Cdl)`。\n\n接下来，为每个测试用例生成综合的“测量”数据 $Z_{\\mathrm{meas}}(\\omega_k)$。这是通过首先使用基准参数计算基准阻抗 $Z(\\omega_k; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast})$，然后分别对实部和虚部加上指定的确定性微扰 $\\delta Z^{\\prime}_{k}$ 和 $\\delta Z^{\\prime\\prime}_{k}$ 来完成的：\n$$\nZ_{\\mathrm{meas}}(\\omega_{k}) = Z\\big(\\omega_{k}; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast}\\big) + \\delta Z^{\\prime}_{k} + j\\,\\delta Z^{\\prime\\prime}_{k}\n$$\n\n在计算出所有 $N$ 个频率下的 $Z_{\\mathrm{model}}(\\omega_k)$ 和 $Z_{\\mathrm{meas}}(\\omega_k)$ 后，通过相减得到复数残差 $r_k$：\n$$\nr_k = Z_{\\mathrm{meas}}(\\omega_k) - Z_{\\mathrm{model}}(\\omega_k)\n$$\n提取残差的实部和虚部 $r'_k$ 和 $r''_k$：\n$$\nr'_k = \\mathrm{Re}(r_k) = Z'_{\\mathrm{meas}}(\\omega_k) - Z'_{\\mathrm{model}}(\\omega_k)\n$$\n$$\nr''_k = \\mathrm{Im}(r_k) = Z''_{\\mathrm{meas}}(\\omega_k) - Z''_{\\mathrm{model}}(\\omega_k)\n$$\n\n最后，计算所需的三个均方根误差（RMSE）指标：\n1.  残差实部的RMSE：\n    $$\n    \\mathrm{RMSE}_{\\mathrm{real}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} (r'_k)^2}\n    $$\n2.  残差虚部的RMSE：\n    $$\n    \\mathrm{RMSE}_{\\mathrm{imag}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} (r''_k)^2}\n    $$\n3.  复数残差模的RMSE。单个复数残差的模为 $|r_k| = \\sqrt{(r'_k)^2 + (r''_k)^2}$。此量的RMSE为 $\\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} |r_k|^2}$。这可简化如下：\n    $$\n    \\mathrm{RMSE}_{\\mathrm{mag}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} \\left( (r'_k)^2 + (r''_k)^2 \\right)} = \\sqrt{\\left(\\frac{1}{N} \\sum_{k=1}^{N} (r'_k)^2\\right) + \\left(\\frac{1}{N} \\sum_{k=1}^{N} (r''_k)^2\\right)} = \\sqrt{\\mathrm{RMSE}_{\\mathrm{real}}^2 + \\mathrm{RMSE}_{\\mathrm{imag}}^2}\n    $$\n这个最终关系因其计算稳定性和数学上的简洁性而被使用。所有三个指标均以欧姆（$\\Omega$）报告，对问题陈述中指定的三个测试用例中的每一个，都四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the EIS modeling problem by deriving impedance, synthesizing data,\n    and calculating residuals and RMSE metrics for three test cases.\n    \"\"\"\n\n    # Frequencies in Hz as specified in the problem.\n    frequencies_hz = np.array([0.1, 1, 10, 100, 1000, 10000])\n    \n    # Angular frequencies in rad/s.\n    angular_frequencies = 2 * np.pi * frequencies_hz\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, moderate diffusion)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 5.0, \n                \"Rct\": 100.0, \n                \"Cdl\": 2e-5, \n                \"sigma\": 10.0\n            },\n            \"model_params\": {\n                \"Rs\": 5.0, \n                \"Rct\": 100.0, \n                \"Cdl\": 2e-5, \n                \"sigma\": 10.0\n            },\n            \"perturb_real\": np.array([0.05, -0.03, 0.02, -0.01, 0.00, 0.01]),\n            \"perturb_imag\": np.array([-0.04, 0.02, -0.01, 0.00, 0.01, -0.02])\n        },\n        # Case 2 (parameter mismatch, stronger residuals)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 3.0, \n                \"Rct\": 150.0, \n                \"Cdl\": 1e-5, \n                \"sigma\": 8.0\n            },\n            \"model_params\": {\n                \"Rs\": 3.0, \n                \"Rct\": 130.0, \n                \"Cdl\": 1.2e-5, \n                \"sigma\": 5.0\n            },\n            \"perturb_real\": np.array([0.20, -0.10, 0.10, -0.10, 0.05, -0.05]),\n            \"perturb_imag\": np.array([-0.15, 0.10, -0.05, 0.00, 0.05, -0.10])\n        },\n        # Case 3 (boundary condition, no diffusion)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 2.0, \n                \"Rct\": 200.0, \n                \"Cdl\": 5e-6, \n                \"sigma\": 0.0\n            },\n            \"model_params\": {\n                \"Rs\": 2.0, \n                \"Rct\": 200.0, \n                \"Cdl\": 5e-6, \n                \"sigma\": 0.0\n            },\n            \"perturb_real\": np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"perturb_imag\": np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0])\n        }\n    ]\n\n    def calculate_impedance(params, omega):\n        \"\"\"\n        Calculates the complex impedance of the Randles circuit.\n\n        Args:\n            params (dict): Dictionary with keys 'Rs', 'Rct', 'Cdl', 'sigma'.\n            omega (np.ndarray): Array of angular frequencies.\n\n        Returns:\n            np.ndarray: Array of complex impedance values.\n        \"\"\"\n        Rs = params[\"Rs\"]\n        Rct = params[\"Rct\"]\n        Cdl = params[\"Cdl\"]\n        sigma = params[\"sigma\"]\n        \n        # Ensure omega is an array for vectorized operations\n        omega = np.asarray(omega)\n        \n        # Warburg impedance Z_W = sigma * (1-j) / sqrt(omega)\n        if sigma == 0.0:\n            Z_W = np.zeros_like(omega, dtype=complex)\n        else:\n            omega_safe = np.maximum(omega, 1e-12) \n            Z_W = sigma * (1 - 1j) * omega_safe**(-0.5)\n\n        # Faradaic impedance (R_ct in series with Z_W)\n        Z_F = Rct + Z_W\n        \n        # Admittance of the parallel part\n        # Y_p = 1/Z_F + 1/Z_Cdl = 1/Z_F + j*omega*Cdl\n        Y_p = 1.0 / Z_F + 1j * omega * Cdl\n        \n        # Impedance of the parallel part\n        Z_p = 1.0 / Y_p\n        \n        # Total impedance (R_s in series with Z_p)\n        Z_total = Rs + Z_p\n        \n        return Z_total\n\n    results = []\n    \n    for case in test_cases:\n        # 1. Compute ground-truth impedance\n        Z_truth = calculate_impedance(case[\"ground_truth_params\"], angular_frequencies)\n        \n        # 2. Synthesize measured data by adding perturbations\n        perturbations = case[\"perturb_real\"] + 1j * case[\"perturb_imag\"]\n        Z_meas = Z_truth + perturbations\n        \n        # 3. Compute model impedance\n        Z_model = calculate_impedance(case[\"model_params\"], angular_frequencies)\n        \n        # 4. Calculate residuals\n        residuals = Z_meas - Z_model\n        res_real = residuals.real\n        res_imag = residuals.imag\n        \n        # 5. Compute RMSE metrics\n        N = len(frequencies_hz)\n        \n        rmse_real = np.sqrt(np.sum(res_real**2) / N)\n        rmse_imag = np.sqrt(np.sum(res_imag**2) / N)\n        \n        # RMSE of magnitude can be calculated directly from the other two\n        rmse_mag = np.sqrt(rmse_real**2 + rmse_imag**2)\n        \n        # Append rounded results\n        results.append(round(rmse_real, 6))\n        results.append(round(rmse_imag, 6))\n        results.append(round(rmse_mag, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}