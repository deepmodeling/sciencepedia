{
    "hands_on_practices": [
        {
            "introduction": "The impedance of a simple parallel resistor-capacitor (RC) circuit, also known as a Debye model, is a cornerstone of EIS analysis. This exercise  provides a foundational test of the Kramers-Kronig relations by asking you to explicitly compute the Hilbert transform of the model's real impedance component. Successfully completing this calculation will demonstrate how the resistive and capacitive parts of an ideal, causal system are fundamentally interlinked.",
            "id": "4249748",
            "problem": "A key step in validating Electrochemical Impedance Spectroscopy (EIS) data via Kramers-Kronig (KK) transforms is to verify that the measured spectrum can be interpreted as the boundary values of a causal, linear, time-invariant response function analytic in the upper half of the complex frequency plane. The KK relations are equivalent to a Hilbert transform connecting the real and imaginary parts of such a response. The Hilbert transform operator $\\mathcal{H}[\\cdot]$ acting on a real-valued function $f(\\omega)$ is defined by\n$$\n\\mathcal{H}[f](\\omega) \\equiv \\frac{1}{\\pi}\\,\\mathrm{PV}\\int_{-\\infty}^{\\infty}\\frac{f(\\xi)}{\\omega - \\xi}\\,d\\xi,\n$$\nwhere $\\mathrm{PV}$ denotes the Cauchy principal value, and $\\omega$ is the angular frequency.\n\nConsider the real-valued function $f(\\omega)=\\frac{1}{1+\\omega^{2}}$, which is even in $\\omega$ and decays as $\\omega\\to\\pm\\infty$. This $f(\\omega)$ can arise as the real part of a normalized first-order (single time-constant) Debye-type response that models a simple resistor-capacitor (RC) element under standard causality conventions for frequency-domain response functions. Starting from the above definition of the Hilbert transform and the causality-analyticity framework that underpins KK relations, compute the Hilbert transform $\\mathcal{H}[f](\\omega)$ explicitly as a closed-form expression in $\\omega$. Then, interpret the result in the context of KK consistency for the simplest RC element (single Debye relaxation), explaining the mapping between the Hilbert transform of $f(\\omega)$ and the corresponding dissipative component associated with the RC time constant, and why this satisfies the requirements for EIS data validation.\n\nExpress the final answer as a single closed-form analytic expression. No rounding is required, and no units are involved.",
            "solution": "The problem is to compute the Hilbert transform of the function $f(\\omega) = \\frac{1}{1+\\omega^2}$ and interpret the result within the context of Kramers-Kronig (KK) relations for Electrochemical Impedance Spectroscopy (EIS) data validation.\n\nFirst, we perform the calculation of the Hilbert transform. The Hilbert transform of a function $f(\\omega)$ is defined as:\n$$\n\\mathcal{H}[f](\\omega) = \\frac{1}{\\pi}\\,\\mathrm{PV}\\int_{-\\infty}^{\\infty}\\frac{f(\\xi)}{\\omega - \\xi}\\,d\\xi\n$$\nwhere $\\mathrm{PV}$ denotes the Cauchy principal value. Substituting $f(\\xi) = \\frac{1}{1+\\xi^2}$, we need to evaluate the integral:\n$$\n\\mathcal{H}[f](\\omega) = \\frac{1}{\\pi}\\,\\mathrm{PV}\\int_{-\\infty}^{\\infty}\\frac{1}{(1+\\xi^2)(\\omega - \\xi)}\\,d\\xi\n$$\nThis integral is most efficiently computed using complex analysis and the residue theorem. Let's consider the complex function $F(z)$:\n$$\nF(z) = \\frac{1}{(1+z^2)(\\omega-z)} = \\frac{1}{(z-i)(z+i)(\\omega-z)}\n$$\nThis function has simple poles at $z=i$, $z=-i$, and $z=\\omega$. The pole at $z=\\omega$ lies on the real axis, which is the path of integration, necessitating the use of the principal value.\n\nWe integrate $F(z)$ along a closed contour $C$ in the upper half-plane. The contour consists of a line segment along the real axis from $-R$ to $R$, indented by a small clockwise semi-circle $\\gamma_{\\epsilon}$ of radius $\\epsilon$ to avoid the pole at $z=\\omega$, and closed by a large semi-circle $\\Gamma_R$ of radius $R$ in the upper half-plane. For sufficiently large $R$ and small $\\epsilon$, the only pole enclosed by this contour is at $z=i$.\n\nBy the residue theorem, the integral around the closed contour $C$ is given by:\n$$\n\\oint_C F(z)\\,dz = 2\\pi i \\, \\mathrm{Res}(F, i)\n$$\nThe residue at the simple pole $z=i$ is:\n$$\n\\mathrm{Res}(F, i) = \\lim_{z \\to i} (z-i)F(z) = \\lim_{z \\to i} \\frac{1}{(z+i)(\\omega-z)} = \\frac{1}{(i+i)(\\omega-i)} = \\frac{1}{2i(\\omega-i)}\n$$\n$$\n\\mathrm{Res}(F, i) = \\frac{1}{2i\\omega - 2i^2} = \\frac{1}{2+2i\\omega} = \\frac{1-i\\omega}{2(1-i\\omega)(1+i\\omega)} = \\frac{1-i\\omega}{2(1+\\omega^2)}\n$$\nThus, the value of the contour integral is:\n$$\n\\oint_C F(z)\\,dz = 2\\pi i \\left( \\frac{1-i\\omega}{2(1+\\omega^2)} \\right) = \\frac{\\pi i (1-i\\omega)}{1+\\omega^2} = \\frac{\\pi i - \\pi i^2 \\omega}{1+\\omega^2} = \\frac{\\pi\\omega + i\\pi}{1+\\omega^2}\n$$\nThe integral over the closed contour $C$ can be decomposed into three parts: the principal value integral along the real axis, the integral over the small semicircular indent, and the integral over the large semicircle.\n$$\n\\oint_C F(z)\\,dz = \\mathrm{PV}\\int_{-\\infty}^{\\infty} F(x)\\,dx + \\int_{\\gamma_{\\epsilon}} F(z)\\,dz + \\int_{\\Gamma_R} F(z)\\,dz\n$$\nIn the limit as $R \\to \\infty$ and $\\epsilon \\to 0$:\n1.  The integral over the large semi-circle $\\Gamma_R$ vanishes because $|F(z)| \\sim O(1/|z|^3)$ for large $|z|$.\n2.  The integral over the small clockwise semicircular indent $\\gamma_\\epsilon$ around the pole at $z=\\omega$ is given by $-i\\pi$ times the residue at that pole. The residue of $F(z)$ at $z=\\omega$ is $\\mathrm{Res}(F, \\omega) = \\lim_{z\\to\\omega}(z-\\omega)F(z) = \\lim_{z\\to\\omega}\\frac{-(z-\\omega)}{(1+z^2)(z-\\omega)} = \\frac{-1}{1+\\omega^2}$. Thus, the integral is $(-i\\pi) \\times (\\frac{-1}{1+\\omega^2}) = \\frac{i\\pi}{1+\\omega^2}$.\n\nCombining these results:\n$$\n\\frac{\\pi\\omega + i\\pi}{1+\\omega^2} = \\mathrm{PV}\\int_{-\\infty}^{\\infty} \\frac{1}{(1+\\xi^2)(\\omega - \\xi)}\\,d\\xi + \\frac{i\\pi}{1+\\omega^2} + 0\n$$\nSolving for the principal value integral:\n$$\n\\mathrm{PV}\\int_{-\\infty}^{\\infty} \\frac{1}{(1+\\xi^2)(\\omega - \\xi)}\\,d\\xi = \\frac{\\pi\\omega + i\\pi}{1+\\omega^2} - \\frac{i\\pi}{1+\\omega^2} = \\frac{\\pi\\omega}{1+\\omega^2}\n$$\nNow, we find the Hilbert transform:\n$$\n\\mathcal{H}[f](\\omega) = \\frac{1}{\\pi} \\left( \\frac{\\pi\\omega}{1+\\omega^2} \\right) = \\frac{\\omega}{1+\\omega^2}\n$$\nThis is the closed-form expression for the Hilbert transform of $f(\\omega)$.\n\nNow, we interpret this result in the context of EIS and KK relations. The problem states that the system should be a causal response function analytic in the upper half of the complex frequency plane. This implies a Fourier transform convention of the form $e^{i\\omega t}$. The impedance of a parallel Resistor-Capacitor (RC) element that is analytic in the upper half-plane has the form $Z(\\omega) = \\frac{R_p}{1-i\\omega R_p C}$, which has its pole in the lower half-plane. Let's normalize by choosing $R_p=1$ and the time constant $\\tau=R_p C = 1$. The impedance function is:\n$$\nZ(\\omega) = \\frac{1}{1-i\\omega}\n$$\nWe can separate this into its real and imaginary parts, $Z(\\omega) = Z'(\\omega) + iZ''(\\omega)$:\n$$\nZ(\\omega) = \\frac{1}{1-i\\omega} \\cdot \\frac{1+i\\omega}{1+i\\omega} = \\frac{1+i\\omega}{1+\\omega^2} = \\frac{1}{1+\\omega^2} + i\\frac{\\omega}{1+\\omega^2}\n$$\nThe real part is $Z'(\\omega) = \\frac{1}{1+\\omega^2}$, which is exactly the function $f(\\omega)$ given in the problem. The imaginary part is $Z''(\\omega) = \\frac{\\omega}{1+\\omega^2}$.\n\nAccording to the Kramers-Kronig relations for a causal function analytic in the upper half-plane, the imaginary part is related to the real part via the Hilbert transform. For the convention where $Z=Z'+iZ''$, the specific relation is $Z''(\\omega) = \\mathcal{H}[Z'](\\omega)$. Our direct calculation yielded $\\mathcal{H}[\\frac{1}{1+\\omega^2}] = \\frac{\\omega}{1+\\omega^2}$. This is precisely the imaginary part, $Z''(\\omega)$, of our chosen causal impedance model.\n\nThis result perfectly illustrates the principle of KK consistency. It shows that for an ideal, causal system like a simple RC element, the real (resistive) and imaginary (capacitive/dissipative) components of its impedance are not independent but are related through the Hilbert transform. The validation of experimental EIS data involves numerically performing this transform on the measured real part of the spectrum and comparing the result with the measured imaginary part. A close match confirms that the experimental data are consistent with the fundamental physical principles of causality, linearity, and time-invariance, thus ensuring the data's validity for further analysis and modeling. The function $f(\\omega)$ provides the archetypal example of this consistency.",
            "answer": "$$\n\\boxed{\\frac{\\omega}{1+\\omega^2}}\n$$"
        },
        {
            "introduction": "Real electrochemical interfaces often exhibit non-ideal frequency responses that cannot be described by simple RC elements. The Constant Phase Element (CPE) is a widely used empirical model for this behavior, characterized by an exponent $\\alpha$. This practice  challenges you to prove that the CPE is indeed KK-consistent and to derive the fixed ratio between its imaginary and real parts, revealing the mathematical origin of its name.",
            "id": "4249708",
            "problem": "In Electrochemical Impedance Spectroscopy (EIS), Kramers–Kronig (KK) consistency of an impedance response is guaranteed when the corresponding linear time-invariant system is causal and sufficiently decaying at high frequency. Consider a Constant Phase Element (CPE) with impedance defined in the Laplace domain by\n$$\nZ_{\\mathrm{CPE}}(s) \\;=\\; \\frac{1}{Q\\, s^{\\alpha}},\n$$\nwhere $Q0$ is a constant and $0\\alpha1$. Adopt the principal branch for the complex power with a branch cut along the negative real $s$-axis, and consider the boundary values $s = i\\omega + 0^{+}$ for real $\\omega0$. All angles are to be taken in radians.\n\nStarting from the causal representation of a linear time-invariant operator and the analyticity of its Laplace transform in the right half-plane, explain why $Z_{\\mathrm{CPE}}(s)$ satisfies the hypotheses that imply KK relations for its boundary values on the imaginary axis. Then, for $\\omega0$, derive closed-form expressions for the real and imaginary parts, denoted $Z^{\\prime}(\\omega)$ and $Z^{\\prime\\prime}(\\omega)$, of $Z_{\\mathrm{CPE}}(i\\omega+0^{+})$, and show that they form a Hilbert transform pair in the sense of KK consistency for causal responses. Finally, define the dimensionless ratio\n$$\n\\kappa(\\alpha) \\;=\\; -\\,\\frac{Z^{\\prime\\prime}(\\omega)}{Z^{\\prime}(\\omega)},\n$$\nand determine $\\kappa(\\alpha)$ in closed form, simplified as much as possible. Express your final answer for $\\kappa(\\alpha)$ as a single analytical expression with no units.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique solution. It is a standard exercise in the application of complex analysis to linear time-invariant systems in the context of electrochemical impedance spectroscopy. We may therefore proceed with the solution.\n\nThe Kramers–Kronig (KK) relations for a linear time-invariant (LTI) system are a manifestation of the principle of causality. The impedance $Z(s)$ is the Laplace transform of a causal impulse response function $z(t)$ (where $z(t)=0$ for $t0$). A fundamental theorem of Laplace transforms states that if $z(t)$ is causal, its Laplace transform $Z(s)$ is an analytic function in some right half-plane $\\text{Re}(s)  \\sigma_0$.\n\nThe impedance of the Constant Phase Element (CPE) is given as $Z_{\\mathrm{CPE}}(s) = \\frac{1}{Q s^{\\alpha}}$, with $Q0$ and $0  \\alpha  1$. The function $s^{\\alpha}$ is multi-valued. The specified principal branch with a branch cut along the negative real axis makes $Z_{\\mathrm{CPE}}(s)$ analytic in the entire complex plane except for the closed negative real axis. This region of analyticity includes the entire open right half-plane, $\\text{Re}(s)  0$, which guarantees the causality of the underlying impulse response. Furthermore, as $|s| \\to \\infty$, $|Z_{\\mathrm{CPE}}(s)| = \\frac{1}{Q |s|^{\\alpha}} \\to 0$ since $\\alpha > 0$. The combination of analyticity in the right half-plane and convergence to zero at infinity ensures that the real and imaginary parts of the boundary values of $Z(s)$ on the imaginary axis, $s=i\\omega$, form a Hilbert transform pair and satisfy the KK relations.\n\nNext, we derive the real and imaginary parts of the impedance on the imaginary axis. We set $s=i\\omega$ for $\\omega0$. In polar form, $s=i\\omega = \\omega e^{i\\pi/2}$. Using the principal branch, we have:\n$$\ns^{\\alpha} = (|s| e^{i\\arg(s)})^{\\alpha} = \\omega^{\\alpha} \\left(e^{i\\frac{\\pi}{2}}\\right)^{\\alpha} = \\omega^{\\alpha} e^{i\\frac{\\alpha\\pi}{2}}\n$$\nSubstituting this into the expression for $Z_{\\mathrm{CPE}}(s)$:\n$$\nZ_{\\mathrm{CPE}}(i\\omega) = \\frac{1}{Q s^{\\alpha}} = \\frac{1}{Q \\left(\\omega^{\\alpha} e^{i\\frac{\\alpha\\pi}{2}}\\right)} = \\frac{1}{Q \\omega^{\\alpha}} e^{-i\\frac{\\alpha\\pi}{2}}\n$$\nUsing Euler's formula, $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$, we expand the expression:\n$$\nZ_{\\mathrm{CPE}}(i\\omega) = \\frac{1}{Q \\omega^{\\alpha}} \\left( \\cos\\left(\\frac{\\alpha\\pi}{2}\\right) - i \\sin\\left(\\frac{\\alpha\\pi}{2}\\right) \\right)\n$$\nBy definition $Z(\\omega) = Z'(\\omega) + i Z''(\\omega)$, so we identify the real and imaginary parts:\n$$\nZ'(\\omega) = \\frac{1}{Q \\omega^{\\alpha}} \\cos\\left(\\frac{\\alpha\\pi}{2}\\right)\n$$\n$$\nZ''(\\omega) = -\\frac{1}{Q \\omega^{\\alpha}} \\sin\\left(\\frac{\\alpha\\pi}{2}\\right)\n$$\nTo show these form a Hilbert transform pair, we verify one of the KK relations. For a system analytic in the right half-plane (Laplace convention) with $Z(\\infty)=0$, the relation is:\n$$\nZ''(\\omega) = -\\frac{2\\omega}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{Z'(\\xi)}{\\xi^2 - \\omega^2} d\\xi\n$$\nSubstituting our expression for $Z'(\\xi)$:\n$$\nZ''_{KK}(\\omega) = -\\frac{2\\omega}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\frac{1}{Q \\xi^{\\alpha}} \\cos\\left(\\frac{\\alpha\\pi}{2}\\right)}{\\xi^2 - \\omega^2} d\\xi = -\\frac{2\\omega \\cos\\left(\\frac{\\alpha\\pi}{2}\\right)}{\\pi Q} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\xi^{-\\alpha}}{\\xi^2 - \\omega^2} d\\xi\n$$\nThe integral can be evaluated. With a substitution $u = \\xi^2/\\omega^2$, the integral becomes $\\frac{\\omega^{-\\alpha-1}}{2} \\mathcal{P} \\int_{0}^{\\infty} \\frac{u^{-(\\alpha+1)/2}}{u-1} du$. The known value of this principal value integral is $\\pi \\cot(-\\frac{(\\alpha+1)\\pi}{2}) = \\pi \\tan(\\frac{\\alpha\\pi}{2})$.\nThus, the integral over $\\xi$ is $\\frac{\\pi\\omega^{-\\alpha-1}}{2} \\tan(\\frac{\\alpha\\pi}{2})$.\nSubstituting this back into the expression for $Z''_{KK}(\\omega)$:\n$$\nZ''_{KK}(\\omega) = -\\frac{2\\omega \\cos\\left(\\frac{\\alpha\\pi}{2}\\right)}{\\pi Q} \\left(\\frac{\\pi\\omega^{-\\alpha-1}}{2} \\tan\\left(\\frac{\\alpha\\pi}{2}\\right)\\right)\n$$\n$$\nZ''_{KK}(\\omega) = -\\frac{\\omega^{-\\alpha}}{Q} \\cos\\left(\\frac{\\alpha\\pi}{2}\\right) \\frac{\\sin\\left(\\frac{\\alpha\\pi}{2}\\right)}{\\cos\\left(\\frac{\\alpha\\pi}{2}\\right)} = -\\frac{1}{Q \\omega^{\\alpha}} \\sin\\left(\\frac{\\alpha\\pi}{2}\\right)\n$$\nThis result is identical to the expression for $Z''(\\omega)$ derived directly from $Z_{\\mathrm{CPE}}(i\\omega)$, confirming KK consistency.\n\nFinally, we determine the dimensionless ratio $\\kappa(\\alpha)$:\n$$\n\\kappa(\\alpha) = -\\frac{Z^{\\prime\\prime}(\\omega)}{Z^{\\prime}(\\omega)}\n$$\nSubstituting the derived expressions for $Z'(\\omega)$ and $Z''(\\omega)$:\n$$\n\\kappa(\\alpha) = -\\frac{-\\frac{1}{Q \\omega^{\\alpha}} \\sin\\left(\\frac{\\alpha\\pi}{2}\\right)}{\\frac{1}{Q \\omega^{\\alpha}} \\cos\\left(\\frac{\\alpha\\pi}{2}\\right)}\n$$\nThe factor $\\frac{1}{Q \\omega^{\\alpha}}$ cancels from the numerator and denominator, as do the negative signs:\n$$\n\\kappa(\\alpha) = \\frac{\\sin\\left(\\frac{\\alpha\\pi}{2}\\right)}{\\cos\\left(\\frac{\\alpha\\pi}{2}\\right)}\n$$\nThis simplifies to the tangent function:\n$$\n\\kappa(\\alpha) = \\tan\\left(\\frac{\\alpha\\pi}{2}\\right)\n$$\nThis result is independent of $\\omega$ and $Q$, depending only on the CPE exponent $\\alpha$.",
            "answer": "$$\n\\boxed{\\tan\\left(\\frac{\\alpha\\pi}{2}\\right)}\n$$"
        },
        {
            "introduction": "While analytical examples are crucial for understanding, the true power of KK transforms lies in validating experimental data, which is inherently numerical. This exercise  moves from pure theory to computational practice, guiding you to implement a numerical algorithm for the KK transform. You will learn how to handle the mathematical challenges of the principal value integral and infinite domain to build a tool capable of validating real-world EIS data.",
            "id": "4249776",
            "problem": "You are tasked with implementing a computational Electrochemical Impedance Spectroscopy (EIS) validation routine based on Kramers-Kronig (KK) transforms. In a causal linear time-invariant electrochemical system, the complex impedance $Z(\\omega)$, with angular frequency $\\omega$ in $\\mathrm{rad}/\\mathrm{s}$, has real and imaginary parts related by a Hilbert-transform-type relation derived from analyticity in the upper half-plane. Assume a physically realistic impedance $Z(\\omega)$ with a finite high-frequency limit $Z(\\infty)$ and an imaginary part $\\operatorname{Im}Z(\\omega)$ that is known and sufficiently decays at high $\\omega$.\n\nStarting from the principles of causality and the analyticity of $Z(\\omega)$ for $\\operatorname{Im}\\omega  0$, derive the appropriate Cauchy Principal Value (CPV) integral that connects $\\operatorname{Re}Z(\\omega)$ to $\\operatorname{Im}Z(\\omega)$ restricted to positive frequencies, and implement a numerical algorithm to compute $\\operatorname{Re}Z_{\\text{KK}}(\\omega)$ from $\\operatorname{Im}Z(\\omega)$ using adaptive Gauss-Kronrod quadrature with explicit principal value handling. Your implementation must:\n- Work on the semi-infinite domain $\\omega \\in [0,\\infty)$ by mapping to a finite interval through a smooth bijection.\n- Handle the CPV singularity at the pole frequency where the denominator of the kernel becomes zero.\n- Be robust across a range of $\\omega$ including small and large values.\n- Produce results expressed in $\\Omega$ (ohms) as floating-point numbers.\n\nDefine the transformation and algorithm rigorously in your solution. Then write a program that carries out the computation for the following test suite. For each case, evaluate $\\operatorname{Re}Z_{\\text{KK}}(\\omega)$ on the frequency grid $\\omega \\in \\{0.01, 0.1, 1, 10, 100\\}\\,\\mathrm{rad}/\\mathrm{s}$ and compare against the known closed-form $\\operatorname{Re}Z(\\omega)$ for that model. Report, for each test case, the maximum absolute deviation in $\\Omega$ across the grid as a floating-point number.\n\nTest suite:\n- Case $1$ (Debye element without series resistance): $R = 5\\,\\Omega$, $\\tau = 0.2\\,\\mathrm{s}$, $Z(\\infty) = 0\\,\\Omega$. The imaginary part is $\\operatorname{Im}Z(\\omega) = -\\dfrac{R\\,\\omega\\,\\tau}{1 + (\\omega \\tau)^2}$ and the true real part is $\\operatorname{Re}Z(\\omega) = \\dfrac{R}{1 + (\\omega \\tau)^2}$.\n- Case $2$ (Debye element with series resistance): $R_s = 2\\,\\Omega$, $R_p = 8\\,\\Omega$, $\\tau = 0.05\\,\\mathrm{s}$, $Z(\\infty) = R_s$. The imaginary part is $\\operatorname{Im}Z(\\omega) = -\\dfrac{R_p\\,\\omega\\,\\tau}{1 + (\\omega \\tau)^2}$ and the true real part is $\\operatorname{Re}Z(\\omega) = R_s + \\dfrac{R_p}{1 + (\\omega \\tau)^2}$.\n- Case $3$ (Zero imaginary part): $\\operatorname{Im}Z(\\omega) = 0$, $Z(\\infty) = 3\\,\\Omega$. The true real part is $\\operatorname{Re}Z(\\omega) = 3\\,\\Omega$ for all $\\omega$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\text{result1},\\text{result2},\\text{result3}]$), where each entry is the maximum absolute deviation in $\\Omega$ for the corresponding test case evaluated on the specified frequency grid. All computations must be performed in the International System of Units (SI), with angular frequency in $\\mathrm{rad}/\\mathrm{s}$ and impedance in $\\Omega$.",
            "solution": "The problem requires the derivation and implementation of a Kramers-Kronig (KK) transform to calculate the real part of an electrochemical impedance, $\\operatorname{Re}Z(\\omega)$, from its imaginary part, $\\operatorname{Im}Z(\\omega)$, and its high-frequency limit, $Z(\\infty)$. This serves as a method for validating the consistency of Electrochemical Impedance Spectroscopy (EIS) data.\n\nThe foundation of the Kramers-Kronig relations lies in the principle of causality. For a linear time-invariant (LTI) system, the output cannot precede the input. In the frequency domain, this property implies that the system's transfer function—in this case, the complex impedance $Z(\\omega)$—must be an analytic function in the upper half of the complex frequency plane ($\\operatorname{Im}(\\omega)  0$). Furthermore, for a real physical system, the impulse response function must be real-valued, which implies that $Z(-\\omega) = Z^*(\\omega)$, where $Z^*$ is the complex conjugate. This symmetry means that $\\operatorname{Re}Z(\\omega)$ is an even function of frequency, and $\\operatorname{Im}Z(\\omega)$ is an odd function.\n\nWe consider the function $f(\\zeta) = Z(\\zeta) - Z(\\infty)$, which is analytic in the upper half-plane and vanishes as $|\\zeta| \\to \\infty$. By applying Cauchy's integral theorem, we can relate the value of this function at a point on the real axis, $\\omega$, to an integral over the real axis. The Sokhotski–Plemelj theorem provides the following relation for a function $F(x)$ and a point $\\omega$ on the real axis:\n$$ \\lim_{\\epsilon \\to 0^+} \\int_{-\\infty}^{\\infty} \\frac{F(x)}{x - (\\omega + i\\epsilon)} dx = i\\pi F(\\omega) + P.V. \\int_{-\\infty}^{\\infty} \\frac{F(x)}{x-\\omega} dx $$\nFrom the analyticity of $Z(\\zeta) - Z(\\infty)$, we can write:\n$$ Z(\\omega) - Z(\\infty) = \\frac{1}{2\\pi i} \\left( P.V.\\int_{-\\infty}^{\\infty} \\frac{Z(x) - Z(\\infty)}{x - \\omega} dx + i\\pi (Z(\\omega) - Z(\\infty)) \\right) $$\nThis simplifies to:\n$$ i\\pi (Z(\\omega) - Z(\\infty)) = P.V. \\int_{-\\infty}^{\\infty} \\frac{Z(x) - Z(\\infty)}{x - \\omega} dx $$\nwhere $P.V.$ denotes the Cauchy Principal Value of the integral. Expanding $Z(\\omega) = \\operatorname{Re}Z(\\omega) + i\\operatorname{Im}Z(\\omega)$ and equating the imaginary parts of both sides yields:\n$$ \\pi (\\operatorname{Re}Z(\\omega) - Z(\\infty)) = P.V. \\int_{-\\infty}^{\\infty} \\frac{\\operatorname{Im}Z(x)}{x - \\omega} dx $$\nNote that $\\operatorname{Im}Z(\\infty) = 0$ is assumed for a resistive high-frequency limit. This gives one of the Kramers-Kronig relations:\n$$ \\operatorname{Re}Z(\\omega) - Z(\\infty) = \\frac{1}{\\pi} P.V. \\int_{-\\infty}^{\\infty} \\frac{\\operatorname{Im}Z(x)}{x - \\omega} dx $$\nUsing the odd symmetry of $\\operatorname{Im}Z(x)$, i.e., $\\operatorname{Im}Z(-x) = -\\operatorname{Im}Z(x)$, we can transform the integral over $(-\\infty, \\infty)$ to an integral over $(0, \\infty)$:\n$$ \\int_{-\\infty}^{\\infty} \\frac{\\operatorname{Im}Z(x)}{x - \\omega} dx = \\int_{0}^{\\infty} \\operatorname{Im}Z(x) \\left( \\frac{1}{x - \\omega} + \\frac{1}{x + \\omega} \\right) dx = \\int_{0}^{\\infty} \\frac{2x \\operatorname{Im}Z(x)}{x^2 - \\omega^2} dx $$\nSubstituting this back, we obtain the required KK transform for the real part of the impedance:\n$$ \\operatorname{Re}Z(\\omega) = Z(\\infty) + \\frac{2}{\\pi} P.V. \\int_{0}^{\\infty} \\frac{x \\operatorname{Im}Z(x)}{x^2 - \\omega^2} dx $$\nThis integral is singular at $x=\\omega$ and must be evaluated as a Cauchy Principal Value. For numerical computation, the singularity can be handled by subtracting it out. We rewrite the integrand as:\n$$ \\frac{x \\operatorname{Im}Z(x)}{x^2 - \\omega^2} = \\frac{x \\operatorname{Im}Z(x) - \\omega \\operatorname{Im}Z(\\omega)}{x^2 - \\omega^2} + \\frac{\\omega \\operatorname{Im}Z(\\omega)}{x^2 - \\omega^2} $$\nThe first term is now regular at $x=\\omega$, having a finite limit, and can be integrated numerically. The second term, $\\frac{\\omega \\operatorname{Im}Z(\\omega)}{x^2 - \\omega^2}$, has a known principal value integral: $P.V. \\int_0^\\infty \\frac{dx}{x^2-\\omega^2} = 0$. Therefore, the transform simplifies to an ordinary improper integral:\n$$ \\operatorname{Re}Z(\\omega) = Z(\\infty) + \\frac{2}{\\pi} \\int_{0}^{\\infty} \\frac{x \\operatorname{Im}Z(x) - \\omega \\operatorname{Im}Z(\\omega)}{x^2 - \\omega^2} dx $$\nTo implement this numerically, the problem asks to map the semi-infinite integration domain $[0, \\infty)$ to a finite one. A suitable smooth bijection is the substitution $x = \\frac{u}{1-u}$, for which $dx = \\frac{1}{(1-u)^2} du$. As $x$ goes from $0$ to $\\infty$, $u$ goes from $0$ to $1$. The integral becomes:\n$$ \\int_{0}^{1} \\left( \\frac{\\frac{u}{1-u} \\operatorname{Im}Z(\\frac{u}{1-u}) - \\omega \\operatorname{Im}Z(\\omega)}{(\\frac{u}{1-u})^2 - \\omega^2} \\right) \\frac{1}{(1-u)^2} du $$\nSimplifying the denominator gives:\n$$ (\\frac{u}{1-u})^2 - \\omega^2 = \\frac{u^2 - \\omega^2(1-u)^2}{(1-u)^2} $$\nThe final integrand over the finite domain $u \\in [0,1]$ is:\n$$ I_u(u, \\omega) = \\frac{\\frac{u}{1-u} \\operatorname{Im}Z(\\frac{u}{1-u}) - \\omega \\operatorname{Im}Z(\\omega)}{u^2 - \\omega^2(1-u)^2} $$\nThis expression has a removable singularity at $u_{crit} = \\frac{\\omega}{1+\\omega}$ (which corresponds to $x=\\omega$) and is suitable for robust numerical quadrature, such as adaptive Gauss-Kronrod, as implemented in `scipy.integrate.quad`.\n\nThe algorithm proceeds as follows for each test case:\n1.  Define the function for the known imaginary impedance component, $\\operatorname{Im}Z(x)$.\n2.  Define the integrand $I_u(u, \\omega)$ using the expression above.\n3.  For each frequency $\\omega_k$ in the evaluation grid, compute the integral $\\int_0^1 I_u(u, \\omega_k) du$ using adaptive quadrature.\n4.  Calculate the Kramers-Kronig estimate $\\operatorname{Re}Z_{\\text{KK}}(\\omega_k) = Z(\\infty) + \\frac{2}{\\pi} \\int_0^1 I_u(u, \\omega_k) du$.\n5.  Compare $\\operatorname{Re}Z_{\\text{KK}}(\\omega_k)$ with the known analytical value $\\operatorname{Re}Z(\\omega_k)$.\n6.  The result for the test case is the maximum absolute deviation $|\\operatorname{Re}Z_{\\text{KK}}(\\omega_k) - \\operatorname{Re}Z(\\omega_k)|$ over the entire frequency grid.\nThis procedure will be applied to the three specified test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Kramers-Kronig transform problem for a suite of EIS test cases.\n\n    The core of the solution is the `kramers_kronig_transform` function, which\n    implements the numerical evaluation of the KK transform based on the\n    principles derived in the solution description.\n    \"\"\"\n\n    omega_grid = np.array([0.01, 0.1, 1, 10, 100])\n\n    # Test Case 1: Debye element without series resistance\n    case1_params = {'R': 5.0, 'tau': 0.2, 'Z_inf': 0.0}\n    def im_Z_case1(w, p):\n        return - (p['R'] * w * p['tau']) / (1 + (w * p['tau'])**2)\n    def re_Z_true_case1(w, p):\n        return p['R'] / (1 + (w * p['tau'])**2)\n\n    # Test Case 2: Debye element with series resistance\n    case2_params = {'Rs': 2.0, 'Rp': 8.0, 'tau': 0.05, 'Z_inf': 2.0}\n    def im_Z_case2(w, p):\n        return - (p['Rp'] * w * p['tau']) / (1 + (w * p['tau'])**2)\n    def re_Z_true_case2(w, p):\n        return p['Rs'] + p['Rp'] / (1 + (w * p['tau'])**2)\n\n    # Test Case 3: Purely resistive element (zero imaginary part)\n    case3_params = {'R': 3.0, 'Z_inf': 3.0}\n    def im_Z_case3(w, p):\n        return 0.0\n    def re_Z_true_case3(w, p):\n        return p['R']\n\n    test_cases = [\n        (case1_params, im_Z_case1, re_Z_true_case1),\n        (case2_params, im_Z_case2, re_Z_true_case2),\n        (case3_params, im_Z_case3, re_Z_true_case3),\n    ]\n\n    def kramers_kronig_transform(im_Z_func, params, omega):\n        \"\"\"\n        Calculates the real part of the impedance at a given frequency omega\n        using the Kramers-Kronig transform of the imaginary part.\n        \"\"\"\n        Z_inf = params.get('Z_inf', 0.0)\n\n        # The imaginary part at the target frequency omega.\n        im_Z_at_omega = im_Z_func(omega, params)\n\n        def integrand_u(u, w):\n            \"\"\"\n            Defines the integrand for the KK transform after a change of\n            variables x = u / (1 - u) to map the integration domain to [0, 1].\n            This form handles the Cauchy Principal Value by using a subtraction\n            technique, resulting in a regular integral.\n            \"\"\"\n            # Avoid division by zero at u=1, which corresponds to x=inf.\n            if np.isclose(u, 1.0):\n                return 0.0\n\n            x = u / (1.0 - u)\n            \n            numerator = x * im_Z_func(x, params) - w * im_Z_at_omega\n            \n            # The denominator after the change of variables becomes u^2 - w^2*(1-u)^2\n            den_u = u**2 - w**2 * (1-u)**2\n            \n            # Handle the removable singularity at x=w, which corresponds to u = w/(1+w).\n            if np.isclose(den_u, 0.0):\n                # The denominator is zero, but so is the numerator.\n                # In this special case, the value of the fraction is its limit.\n                # We can return 0.0 because the adaptive quadrature will effectively\n                # ignore this single point and correctly compute the integral of the\n                # otherwise smooth function.\n                return 0.0 \n\n            return numerator / den_u\n\n\n        # Integrate using adaptive Gauss-Kronrod quadrature on the finite interval [0, 1].\n        integral_val, _ = integrate.quad(integrand_u, 0, 1, args=(omega,))\n        \n        # Apply the full Kramers-Kronig formula.\n        re_Z_kk = Z_inf + (2.0 / np.pi) * integral_val\n        return re_Z_kk\n\n    results = []\n    for params, im_func, re_true_func in test_cases:\n        deviations = []\n        for w in omega_grid:\n            re_kk = kramers_kronig_transform(im_func, params, w)\n            re_true = re_true_func(w, params)\n            deviations.append(np.abs(re_kk - re_true))\n        \n        max_deviation = np.max(deviations)\n        results.append(max_deviation)\n\n    print(f\"[{','.join(f'{r:.12g}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}