{
    "hands_on_practices": [
        {
            "introduction": "The fundamental interaction between an external electric field and a molecule is governed by the molecule's charge distribution. For a weak, uniform field, the leading-order change in the system's energy is due to the coupling of the field with the molecule's permanent electric dipole moment. This practice guides you through a first-principles derivation of this relationship, $\\Delta E^{(1)} = - \\boldsymbol{\\mu} \\cdot \\mathbf{E}$, starting from perturbation theory. By applying this concept to a simple, analytically tractable model of electron density, you will build a concrete understanding of how the spatial arrangement of charge dictates a molecule's primary response to an electric field .",
            "id": "4253295",
            "problem": "Consider a finite neutral molecule treated within Density Functional Theory (DFT), with clamped nuclei and no net nuclear dipole moment about the origin. The ground-state electronic density is modeled as a superposition of two normalized three-dimensional Gaussian components,\n$$\nn(\\mathbf{r}) \\;=\\; \\sum_{i=1}^{2} \\, N_i \\, \\frac{1}{\\left(\\pi \\sigma_i^2\\right)^{3/2}} \\, \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{R}_i|^2}{\\sigma_i^2}\\right),\n$$\nwhere $N_i$ is the number of electrons in component $i$, $\\sigma_i$ is its width, and $\\mathbf{R}_i$ is its center. Assume $\\mathbf{R}_1 = (0,0,1.20\\,\\mathrm{\\AA})$, $\\mathbf{R}_2 = (0,0,-0.80\\,\\mathrm{\\AA})$, $N_1 = 6$, $N_2 = 4$, and $\\sigma_1 = \\sigma_2 = 0.30\\,\\mathrm{\\AA}$. The system is subjected to a spatially uniform, weak, static electric field $\\mathbf{E} = E\\,\\hat{\\mathbf{z}}$ with $E = 0.025\\,\\mathrm{V}/\\mathrm{\\AA}$.\n\nStarting from the Hohenberg–Kohn variational principle and time-independent perturbation theory, and invoking the Hellmann–Feynman theorem, derive the first-order change in the ground-state electronic energy in terms of the ground-state density and the elementary charge $e$, for a uniform external electric field. Then, using the provided model for $n(\\mathbf{r})$, compute the numerical value of the first-order change in the ground-state electronic energy. Use the dipole moment definition\n$$\n\\boldsymbol{\\mu} \\;=\\; -\\,e \\int \\mathbf{r}\\, n(\\mathbf{r})\\, d\\mathbf{r},\n$$\nand take the elementary charge $e$ as a symbol. Express the final energy change in electronvolts (eV), and round your answer to four significant figures.",
            "solution": "The problem asks for the first-order change in the ground-state electronic energy of a molecule subjected to a uniform static electric field. We will first derive the general expression for this energy change using the principles of Density Functional Theory (DFT) and perturbation theory, and then compute its numerical value for the given model of electron density.\n\n### Part 1: Derivation of the First-Order Energy Change\n\nThe total electronic Hamiltonian of a system in the presence of an external potential $v_{\\text{ext}}(\\mathbf{r})$ is given by $H = T + V_{ee} + V_{\\text{ext}}$, where $T$ is the kinetic energy operator, $V_{ee}$ is the electron-electron interaction, and $V_{\\text{ext}} = \\int v_{\\text{ext}}(\\mathbf{r}) n(\\mathbf{r}) d\\mathbf{r}$ is the energy due to the external potential, with $n(\\mathbf{r})$ being the electronic density.\n\nIn this problem, the system is subjected to a uniform static electric field $\\mathbf{E}$. The external potential experienced by an electron (charge $-e$) is composed of the potential from the clamped nuclei, $v_{\\text{nuc}}(\\mathbf{r})$, and the potential from the electric field. The potential energy of a charge $q$ in an electric potential $\\phi(\\mathbf{r})$ is $q\\phi(\\mathbf{r})$. For a uniform field $\\mathbf{E}$, the electric potential is $\\phi(\\mathbf{r}) = -\\mathbf{r} \\cdot \\mathbf{E}$ (assuming $\\phi(\\mathbf{0})=0$). For an electron with charge $q=-e$, the potential energy is $(-e)(-\\mathbf{r} \\cdot \\mathbf{E}) = e\\,\\mathbf{r} \\cdot \\mathbf{E}$.\n\nThus, the external potential for a single electron is $v_{\\text{ext}}(\\mathbf{r}, \\mathbf{E}) = v_{\\text{nuc}}(\\mathbf{r}) + e\\,\\mathbf{r} \\cdot \\mathbf{E}$. The total electronic Hamiltonian becomes a function of $\\mathbf{E}$:\n$$\nH(\\mathbf{E}) = \\left(T + V_{ee} + \\int v_{\\text{nuc}}(\\mathbf{r}) n(\\mathbf{r}) d\\mathbf{r}\\right) + \\int (e\\,\\mathbf{r} \\cdot \\mathbf{E}) n(\\mathbf{r}) d\\mathbf{r}\n$$\nWe can identify the Hamiltonian in the absence of the field as $H_0 = H(\\mathbf{E}=\\mathbf{0})$, and the perturbation due to the field as $V_{\\text{pert}}$. The operator form of the perturbation, acting on the many-electron wavefunction, is:\n$$\nV_{\\text{pert}} = \\sum_{j=1}^{N_{\\text{tot}}} e\\,\\mathbf{r}_j \\cdot \\mathbf{E}\n$$\nwhere the sum is over all $N_{\\text{tot}}$ electrons.\n\nAccording to time-independent perturbation theory, the first-order correction to the ground-state energy, $\\Delta E^{(1)}$, is the expectation value of the perturbation operator taken with respect to the unperturbed ground-state wavefunction $\\Psi_0$:\n$$\n\\Delta E^{(1)} = \\langle \\Psi_0 | V_{\\text{pert}} | \\Psi_0 \\rangle = \\left\\langle \\Psi_0 \\left| \\sum_{j=1}^{N_{\\text{tot}}} e\\,\\mathbf{r}_j \\cdot \\mathbf{E} \\right| \\Psi_0 \\right\\rangle\n$$\nThis can be rewritten as:\n$$\n\\Delta E^{(1)} = e \\left( \\left\\langle \\Psi_0 \\left| \\sum_{j=1}^{N_{\\text{tot}}} \\mathbf{r}_j \\right| \\Psi_0 \\right\\rangle \\right) \\cdot \\mathbf{E}\n$$\nThe expectation value of the sum of position operators is related to the ground-state electron density, $n_0(\\mathbf{r})$, by:\n$$\n\\left\\langle \\Psi_0 \\left| \\sum_{j=1}^{N_{\\text{tot}}} \\mathbf{r}_j \\right| \\Psi_0 \\right\\rangle = \\int \\mathbf{r}\\, n_0(\\mathbf{r})\\, d\\mathbf{r}\n$$\nSubstituting this into the expression for $\\Delta E^{(1)}$ gives the desired result in terms of the ground-state density:\n$$\n\\Delta E^{(1)} = e \\left( \\int \\mathbf{r}\\, n_0(\\mathbf{r})\\, d\\mathbf{r} \\right) \\cdot \\mathbf{E}\n$$\nThis result is consistent with the Hellmann-Feynman theorem, as requested. The theorem states that for a Hamiltonian $H(\\lambda)$ dependent on a parameter $\\lambda$, the derivative of the energy eigenvalue $E(\\lambda)$ with respect to $\\lambda$ is $\\frac{dE}{d\\lambda} = \\left\\langle \\Psi(\\lambda) \\left| \\frac{\\partial H}{\\partial \\lambda} \\right| \\Psi(\\lambda) \\right\\rangle$. Let's consider the field magnitude $E$ as the parameter, with $\\mathbf{E} = E\\hat{\\mathbf{z}}$. The Hamiltonian is $H(E) = H_0 + E \\left(e \\sum_j z_j\\right)$. Then $\\frac{\\partial H}{\\partial E} = e\\sum_j z_j$. The derivative of the energy is $\\frac{dE}{dE} = \\langle \\Psi(E) | e \\sum_j z_j | \\Psi(E) \\rangle$. For a weak field, the first-order change is $\\Delta E^{(1)} \\approx E \\left. \\frac{dE}{dE} \\right|_{E=0} = E \\langle \\Psi_0 | e \\sum_j z_j | \\Psi_0 \\rangle$, which leads to the same expression.\n\nThe expression can also be written in terms of the permanent electronic dipole moment $\\boldsymbol{\\mu}_0$. Using the provided definition $\\boldsymbol{\\mu} = -e \\int \\mathbf{r}\\, n(\\mathbf{r})\\, d\\mathbf{r}$, we have:\n$$\n\\Delta E^{(1)} = - \\left( -e \\int \\mathbf{r}\\, n_0(\\mathbf{r})\\, d\\mathbf{r} \\right) \\cdot \\mathbf{E} = - \\boldsymbol{\\mu}_0 \\cdot \\mathbf{E}\n$$\nThis is the classical energy of a dipole in an external field.\n\n### Part 2: Calculation for the Given Model\n\nWe need to compute the integral $\\int \\mathbf{r}\\,n_0(\\mathbf{r})\\, d\\mathbf{r}$ using the provided model for the unperturbed ground-state density $n(\\mathbf{r})$ (which we denote as $n_0(\\mathbf{r})$):\n$$\nn_0(\\mathbf{r}) \\;=\\; \\sum_{i=1}^{2} \\, N_i \\, \\frac{1}{\\left(\\pi \\sigma_i^2\\right)^{3/2}} \\, \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{R}_i|^2}{\\sigma_i^2}\\right)\n$$\nThe integral is:\n$$\n\\int \\mathbf{r}\\, n_0(\\mathbf{r})\\, d\\mathbf{r} = \\int \\mathbf{r} \\left[ \\sum_{i=1}^{2} N_i \\frac{1}{(\\pi \\sigma_i^2)^{3/2}} \\exp\\left(-\\frac{|\\mathbf{r}-\\mathbf{R}_i|^2}{\\sigma_i^2}\\right) \\right] d\\mathbf{r}\n$$\nBy linearity of integration, we can swap the sum and the integral:\n$$\n= \\sum_{i=1}^{2} N_i \\frac{1}{(\\pi \\sigma_i^2)^{3/2}} \\int \\mathbf{r} \\exp\\left(-\\frac{|\\mathbf{r}-\\mathbf{R}_i|^2}{\\sigma_i^2}\\right) d\\mathbf{r}\n$$\nTo evaluate the integral for each component $i$, we use the substitution $\\mathbf{u} = \\mathbf{r} - \\mathbf{R}_i$, which means $\\mathbf{r} = \\mathbf{u} + \\mathbf{R}_i$ and $d\\mathbf{r} = d\\mathbf{u}$.\n$$\n\\int \\mathbf{r} \\exp\\left(-\\frac{|\\mathbf{r}-\\mathbf{R}_i|^2}{\\sigma_i^2}\\right) d\\mathbf{r} = \\int (\\mathbf{u} + \\mathbf{R}_i) \\exp\\left(-\\frac{|\\mathbf{u}|^2}{\\sigma_i^2}\\right) d\\mathbf{u}\n$$\n$$\n= \\int \\mathbf{u} \\exp\\left(-\\frac{|\\mathbf{u}|^2}{\\sigma_i^2}\\right) d\\mathbf{u} + \\mathbf{R}_i \\int \\exp\\left(-\\frac{|\\mathbf{u}|^2}{\\sigma_i^2}\\right) d\\mathbf{u}\n$$\nThe first integral $\\int \\mathbf{u} \\exp(-|\\mathbf{u}|^2/\\sigma_i^2) d\\mathbf{u}$ is zero because the integrand is an odd function integrated over all space. The second integral is a standard three-dimensional Gaussian integral, $\\int \\exp(-|\\mathbf{u}|^2/\\sigma_i^2) d\\mathbf{u} = (\\pi \\sigma_i^2)^{3/2}$.\nTherefore, the integral for component $i$ simplifies to:\n$$\n\\int \\mathbf{r} \\exp\\left(-\\frac{|\\mathbf{r}-\\mathbf{R}_i|^2}{\\sigma_i^2}\\right) d\\mathbf{r} = \\mathbf{R}_i (\\pi \\sigma_i^2)^{3/2}\n$$\nSubstituting this back into the sum:\n$$\n\\int \\mathbf{r}\\, n_0(\\mathbf{r})\\, d\\mathbf{r} = \\sum_{i=1}^{2} N_i \\frac{1}{(\\pi \\sigma_i^2)^{3/2}} \\left[ \\mathbf{R}_i (\\pi \\sigma_i^2)^{3/2} \\right] = \\sum_{i=1}^{2} N_i \\mathbf{R}_i\n$$\nNow we plug in the given numerical values:\n$N_1 = 6$, $\\mathbf{R}_1 = (0, 0, 1.20) \\, \\mathrm{\\AA}$\n$N_2 = 4$, $\\mathbf{R}_2 = (0, 0, -0.80) \\, \\mathrm{\\AA}$\n\n$$\n\\sum_{i=1}^{2} N_i \\mathbf{R}_i = 6 \\cdot (0, 0, 1.20 \\, \\mathrm{\\AA}) + 4 \\cdot (0, 0, -0.80 \\, \\mathrm{\\AA})\n$$\n$$\n= (0, 0, 7.20 \\, \\mathrm{\\AA}) + (0, 0, -3.20 \\, \\mathrm{\\AA}) = (0, 0, 4.00 \\, \\mathrm{\\AA})\n$$\nThe electric field is $\\mathbf{E} = E\\,\\hat{\\mathbf{z}} = (0, 0, 0.025) \\, \\mathrm{V}/\\mathrm{\\AA}$.\n\nNow we can compute the first-order energy change $\\Delta E^{(1)}$:\n$$\n\\Delta E^{(1)} = e \\left( \\sum_{i=1}^{2} N_i \\mathbf{R}_i \\right) \\cdot \\mathbf{E} = e \\left( (0, 0, 4.00 \\, \\mathrm{\\AA}) \\cdot (0, 0, 0.025 \\, \\mathrm{V}/\\mathrm{\\AA}) \\right)\n$$\n$$\n\\Delta E^{(1)} = e \\cdot (4.00 \\times 0.025) \\, (\\mathrm{\\AA} \\cdot \\mathrm{V}/\\mathrm{\\AA}) = e \\cdot 0.100 \\, \\mathrm{V}\n$$\nThe product of the elementary charge $e$ and a potential difference in Volts ($V$) is an energy in electronvolts (eV). Therefore:\n$$\n\\Delta E^{(1)} = 0.100 \\, \\mathrm{eV}\n$$\nThe problem requires the answer to be rounded to four significant figures. Treating the input values as exact for the purpose of this instruction, the result is $0.1$, which we write as $0.1000$.",
            "answer": "$$\\boxed{0.1000}$$"
        },
        {
            "introduction": "Moving from isolated molecules to extended systems, a crucial application in electrochemistry involves modeling the interface between a material and an electrolyte or vacuum. This exercise explores how an external electric field alters the electronic properties of a metal surface, specifically its work function. Using a planar-averaged electrostatic model combined with Thomas-Fermi screening theory, you will calculate the change in work function induced by the field. This practice provides valuable physical intuition into how an electrode's surface potential and electron-donating ability respond to an applied bias, a cornerstone concept in surface science and catalysis .",
            "id": "4253242",
            "problem": "A one-dimensional, planar-averaged representation of a metal slab in a vacuum is considered within Density Functional Theory (DFT). The slab is modeled along the coordinate $z$ with a metallic region occupying $z \\in [-t,0]$ and a vacuum region occupying $z \\in [0,L_{\\mathrm{vac}}]$, so that the total cell length is $L_z = t + L_{\\mathrm{vac}}$. A uniform external electric field $E_{\\mathrm{ext}}$ is applied only in the vacuum region via a dipole-corrected sawtooth potential: this introduces a finite discontinuity in the electrostatic potential at a plane located at $z = z_{\\mathrm{dc}} \\in (0,L_{\\mathrm{vac}})$ such that periodic boundary conditions are satisfied and any spurious field inside the metal is removed. The planar-averaged electrostatic potential $\\phi(z)$ and electric field $E(z)$ satisfy standard electrostatics in the International System of Units (SI):\n\n- The vacuum region is charge-free, so the potential satisfies $d^2 \\phi(z)/dz^2 = 0$ and $E(z) = -\\,d\\phi(z)/dz$ is uniform and equal to $E_{\\mathrm{ext}}$ in $z \\in (0,L_{\\mathrm{vac}})$.\n- The metallic region is described by a linear Thomas–Fermi screening model, where the induced planar-averaged charge density obeys $\\rho(z) = -\\varepsilon_0\\,\\phi(z)/\\lambda^2$ for $z \\in [-t,0]$, with $\\varepsilon_0$ the vacuum permittivity and $\\lambda$ the Thomas–Fermi screening length of the metal. Combining with Poisson’s equation $d^2\\phi(z)/dz^2 = -\\rho(z)/\\varepsilon_0$ yields $d^2\\phi(z)/dz^2 = \\phi(z)/\\lambda^2$ in the metal.\n\nAssume the slab thickness $t$ is large compared to $\\lambda$ (so the interior of the metal is field-free), and assume the potential and its first derivative are continuous at the interface $z=0$ (no singular surface charge is imposed in this planar-averaged model). The uniform external field in the vacuum is implemented together with a dipole-correction potential (a sawtooth profile with a single discontinuity $\\Delta \\phi_{\\mathrm{dc}}$, located at $z=z_{\\mathrm{dc}}$ in the vacuum), chosen so that the periodically repeated cell has zero net field inside the metal while maintaining $E(z)=E_{\\mathrm{ext}}$ throughout the vacuum on the side of interest. The discontinuity ensures $\\phi(z)$ is single-valued under periodic boundary conditions but does not alter the local boundary condition at $z=0$.\n\nDefine the work function change $\\Delta \\Phi$ due to the applied field $E_{\\mathrm{ext}}$ as the change in the potential step between the deep interior of the metal ($z \\to -\\infty$ inside the slab) and the local vacuum reference just outside the surface ($z \\to 0^+$), relative to the zero-field case. Use the planar-averaged electrostatics and the Thomas–Fermi screening model to obtain $\\Delta \\Phi$ by determining the induced electrostatic response of the metal and the resulting potential at $z=0^+$ under the applied field. Express $\\Delta \\Phi$ in electronvolts (eV). Note that for potential differences in this context, $1\\,\\mathrm{eV}$ numerically equals $1\\,\\mathrm{V}$.\n\nYour program must implement this model and compute $\\Delta \\Phi$ for the following test suite of parameter sets. Each parameter set is a tuple $(E_{\\mathrm{ext}}, \\lambda, t, L_{\\mathrm{vac}}, z_{\\mathrm{dc}})$ with SI units for distances and electric field, and $z_{\\mathrm{dc}}$ located in the vacuum:\n\n- Case 1 (general case): $E_{\\mathrm{ext}} = 5.0 \\times 10^{9}\\,\\mathrm{V/m}$, $\\lambda = 5.0 \\times 10^{-11}\\,\\mathrm{m}$, $t = 2.0 \\times 10^{-9}\\,\\mathrm{m}$, $L_{\\mathrm{vac}} = 3.0 \\times 10^{-9}\\,\\mathrm{m}$, $z_{\\mathrm{dc}} = 2.5 \\times 10^{-9}\\,\\mathrm{m}$.\n- Case 2 (zero field): $E_{\\mathrm{ext}} = 0.0\\,\\mathrm{V/m}$, $\\lambda = 5.0 \\times 10^{-11}\\,\\mathrm{m}$, $t = 2.0 \\times 10^{-9}\\,\\mathrm{m}$, $L_{\\mathrm{vac}} = 3.0 \\times 10^{-9}\\,\\mathrm{m}$, $z_{\\mathrm{dc}} = 2.5 \\times 10^{-9}\\,\\mathrm{m}$.\n- Case 3 (strong field, very short screening): $E_{\\mathrm{ext}} = 1.0 \\times 10^{10}\\,\\mathrm{V/m}$, $\\lambda = 1.0 \\times 10^{-12}\\,\\mathrm{m}$, $t = 5.0 \\times 10^{-9}\\,\\mathrm{m}$, $L_{\\mathrm{vac}} = 3.0 \\times 10^{-9}\\,\\mathrm{m}$, $z_{\\mathrm{dc}} = 2.0 \\times 10^{-9}\\,\\mathrm{m}$.\n- Case 4 (reversed field): $E_{\\mathrm{ext}} = -2.0 \\times 10^{9}\\,\\mathrm{V/m}$, $\\lambda = 1.0 \\times 10^{-10}\\,\\mathrm{m}$, $t = 5.0 \\times 10^{-9}\\,\\mathrm{m}$, $L_{\\mathrm{vac}} = 5.0 \\times 10^{-9}\\,\\mathrm{m}$, $z_{\\mathrm{dc}} = 3.0 \\times 10^{-9}\\,\\mathrm{m}$.\n- Case 5 (different vacuum length A): $E_{\\mathrm{ext}} = 3.0 \\times 10^{9}\\,\\mathrm{V/m}$, $\\lambda = 3.0 \\times 10^{-11}\\,\\mathrm{m}$, $t = 4.0 \\times 10^{-9}\\,\\mathrm{m}$, $L_{\\mathrm{vac}} = 2.0 \\times 10^{-9}\\,\\mathrm{m}$, $z_{\\mathrm{dc}} = 1.0 \\times 10^{-9}\\,\\mathrm{m}$.\n- Case 6 (different vacuum length B): $E_{\\mathrm{ext}} = 3.0 \\times 10^{9}\\,\\mathrm{V/m}$, $\\lambda = 3.0 \\times 10^{-11}\\,\\mathrm{m}$, $t = 4.0 \\times 10^{-9}\\,\\mathrm{m}$, $L_{\\mathrm{vac}} = 8.0 \\times 10^{-9}\\,\\mathrm{m}$, $z_{\\mathrm{dc}} = 4.0 \\times 10^{-9}\\,\\mathrm{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\Delta \\Phi_1,\\Delta \\Phi_2,\\dots]$), where each entry is a floating-point number in $\\mathrm{eV}$ corresponding to the computed change in work function for the respective test case.",
            "solution": "The problem requires the calculation of the work function change, $\\Delta \\Phi$, for a metal slab subject to an external electric field. This quantity is defined as the change in the electrostatic potential difference between the deep interior of the metal and the vacuum region just outside the metal surface, relative to the zero-field case. The analysis is based on a one-dimensional planar-averaged electrostatic model.\n\nFirst, we solve for the electrostatic potential $\\phi(z)$ in the two regions defined by the problem: the metal slab for $z \\in [-t, 0]$ and the vacuum for $z \\in [0, L_{\\mathrm{vac}}]$.\n\nIn the metallic region ($z \\in [-t, 0]$), the potential is described by the Thomas-Fermi screening model. The governing differential equation is:\n$$\n\\frac{d^2\\phi(z)}{dz^2} = \\frac{\\phi(z)}{\\lambda^2}\n$$\nwhere $\\lambda$ is the Thomas-Fermi screening length. The general solution to this second-order linear homogeneous differential equation is:\n$$\n\\phi_m(z) = A e^{z/\\lambda} + B e^{-z/\\lambda}\n$$\nwhere $A$ and $B$ are constants. The problem states that the slab thickness $t$ is large compared to $\\lambda$, and the interior of the metal is field-free. This implies that far from the surface (as $z \\to -\\infty$), the potential perturbation and the electric field must decay to zero. To satisfy this physical condition, the term $e^{-z/\\lambda}$, which diverges as $z \\to -\\infty$, must be excluded. Therefore, we set its coefficient $B=0$. The potential inside the metal is thus given by:\n$$\n\\phi_m(z) = A e^{z/\\lambda}\n$$\nThis form ensures that both the potential $\\phi_m(z)$ and the associated electric field $E_m(z) = -d\\phi_m/dz = -(A/\\lambda)e^{z/\\lambda}$ correctly approach zero in the deep interior of the metal. We choose the potential reference such that $\\phi_m(z \\to -\\infty) = 0$.\n\nIn the vacuum region ($z \\in [0, L_{\\mathrm{vac}}]$), the space is charge-free. The problem states that a uniform electric field $E(z) = E_{\\mathrm{ext}}$ is applied. The relationship between the electric field and the electrostatic potential is $E(z) = -d\\phi(z)/dz$. This gives the differential equation:\n$$\n\\frac{d\\phi_v(z)}{dz} = -E_{\\mathrm{ext}}\n$$\nIntegrating with respect to $z$ yields the potential in the vacuum:\n$$\n\\phi_v(z) = -E_{\\mathrm{ext}} z + C\n$$\nwhere $C$ is another integration constant.\n\nNext, we apply the boundary conditions at the metal-vacuum interface, $z=0$. The problem specifies that the potential $\\phi(z)$ and its first derivative $d\\phi(z)/dz$ are continuous at this interface.\n1.  Continuity of potential: $\\phi_m(0) = \\phi_v(0)$.\n    $$\n    A e^{0/\\lambda} = -E_{\\mathrm{ext}}(0) + C \\implies A = C\n    $$\n2.  Continuity of the first derivative: $\\phi_m'(0) = \\phi_v'(0)$.\n    The derivatives are $\\phi_m'(z) = (A/\\lambda)e^{z/\\lambda}$ and $\\phi_v'(z) = -E_{\\mathrm{ext}}$. At $z=0$:\n    $$\n    \\frac{A}{\\lambda} e^{0/\\lambda} = -E_{\\mathrm{ext}} \\implies \\frac{A}{\\lambda} = -E_{\\mathrm{ext}}\n    $$\nFrom the second condition, we solve for the constant $A$:\n$$\nA = -E_{\\mathrm{ext}} \\lambda\n$$\nSince $A=C$, we also have $C = -E_{\\mathrm{ext}} \\lambda$.\n\nNow we have the complete expressions for the potential in both regions:\n-   Metal ($z \\in [-t, 0]$): $\\phi_m(z) = -E_{\\mathrm{ext}} \\lambda e^{z/\\lambda}$\n-   Vacuum ($z \\in [0, L_{\\mathrm{vac}}]$): $\\phi_v(z) = -E_{\\mathrm{ext}} z - E_{\\mathrm{ext}} \\lambda = -E_{\\mathrm{ext}}(z+\\lambda)$\n\nThe work function change $\\Delta \\Phi$ is defined as the change in the potential step between the deep interior of the metal and the local vacuum just outside the surface, relative to the zero-field case. Let this potential step be $\\delta\\phi = \\phi(0^+) - \\phi(-t)$, where we use $z=-t$ as an approximation for the deep interior, valid since $t \\gg \\lambda$.\n-   Potential at the vacuum interface ($z=0^+$): $\\phi(0^+) = \\phi_v(0) = -E_{\\mathrm{ext}}\\lambda$.\n-   Potential in the deep metal ($z=-t$): $\\phi(-t) = \\phi_m(-t) = -E_{\\mathrm{ext}}\\lambda e^{-t/\\lambda}$.\n\nThe potential step for a given field $E_{\\mathrm{ext}}$ is:\n$$\n\\delta\\phi(E_{\\mathrm{ext}}) = \\phi(0^+) - \\phi(-t) = (-E_{\\mathrm{ext}}\\lambda) - (-E_{\\mathrm{ext}}\\lambda e^{-t/\\lambda}) = -E_{\\mathrm{ext}}\\lambda(1 - e^{-t/\\lambda})\n$$\nFor the zero-field case, $E_{\\mathrm{ext}} = 0$, the potential step $\\delta\\phi(0)$ is $0$.\nThe work function change is the difference between these two scenarios:\n$$\n\\Delta \\Phi = \\delta\\phi(E_{\\mathrm{ext}}) - \\delta\\phi(0) = -E_{\\mathrm{ext}}\\lambda(1 - e^{-t/\\lambda})\n$$\nThe problem asks for $\\Delta \\Phi$ in electronvolts (eV). Since the calculated potential difference is in volts (V), and $1\\,\\mathrm{eV}$ corresponds numerically to a potential difference of $1\\,\\mathrm{V}$, the numerical value of $\\Delta \\Phi$ in volts is the answer in eV.\n\nThis derived expression depends only on $E_{\\mathrm{ext}}$, $\\lambda$, and $t$. The parameters describing the vacuum region setup ($L_{\\mathrm{vac}}$ and $z_{\\mathrm{dc}}$) are part of the description of how a numerically stable periodic calculation would be performed in DFT but are not necessary for determining the local electrostatic response at the surface, which is what governs the work function change. Thus, they do not appear in the final formula. For all given test cases, the condition $t \\gg \\lambda$ holds, making the term $e^{-t/\\lambda}$ extremely small. The formula could be accurately approximated by $\\Delta \\Phi \\approx -E_{\\mathrm{ext}}\\lambda$, but we will use the full expression for maximum precision. A positive field $E_{\\mathrm{ext}}$ (pointing away from the surface) results in a negative $\\Delta\\Phi$, indicating a reduction in the work function, which is physically correct.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the change in work function for a metal slab in an electric field,\n    based on a planar-averaged Thomas-Fermi screening model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (E_ext, lambda, t, L_vac, z_dc) in SI units.\n    # E_ext: V/m, lambda: m, t: m, L_vac: m, z_dc: m.\n    test_cases = [\n        # Case 1 (general case)\n        (5.0e9, 5.0e-11, 2.0e-9, 3.0e-9, 2.5e-9),\n        # Case 2 (zero field)\n        (0.0, 5.0e-11, 2.0e-9, 3.0e-9, 2.5e-9),\n        # Case 3 (strong field, very short screening)\n        (1.0e10, 1.0e-12, 5.0e-9, 3.0e-9, 2.0e-9),\n        # Case 4 (reversed field)\n        (-2.0e9, 1.0e-10, 5.0e-9, 5.0e-9, 3.0e-9),\n        # Case 5 (different vacuum length A)\n        (3.0e9, 3.0e-11, 4.0e-9, 2.0e-9, 1.0e-9),\n        # Case 6 (different vacuum length B)\n        (3.0e9, 3.0e-11, 4.0e-9, 8.0e-9, 4.0e-9),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_ext, lam, t, L_vac, z_dc = case\n        \n        # The change in work function (Delta Phi) is given by the formula:\n        # Delta_Phi = -E_ext * lambda * (1 - exp(-t / lambda))\n        # The result in Volts is numerically equal to the result in electron-volts (eV).\n        # The parameters L_vac and z_dc are not needed for this specific calculation.\n        \n        # Handle cases to avoid division by zero, although not present in test data.\n        if lam == 0:\n            # A perfect conductor (lambda=0) would have perfect screening,\n            # meaning the potential change inside is zero instantly.\n            # The field does not penetrate, so the work function change as defined is zero.\n            delta_phi = 0.0\n        else:\n            # For t >> lambda, exp(-t/lambda) -> 0, so Delta_Phi approximates -E_ext * lambda.\n            # We use the full formula for precision.\n            ratio = t / lam\n            delta_phi = -E_ext * lam * (1.0 - np.exp(-ratio))\n        \n        results.append(delta_phi)\n\n    # The final print statement must produce a single-line format: [res1,res2,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A key challenge in modern computational materials science is the treatment of charged or highly polar systems using periodic boundary conditions, which are standard in most Density Functional Theory (DFT) software. These conditions can introduce significant, unphysical electrostatic interactions between a system and its periodic images, leading to finite-size artifacts that contaminate the calculated total energy. This advanced practice confronts this issue directly by introducing the leading correction schemes, such as the Makov-Payne and dipole corrections, used to systematically remove these errors. By working with synthetic DFT data, you will learn to quantify and correct for these artifacts, developing an essential skill for achieving accurate and reliable energy calculations for charged defects, surfaces, and molecules in periodic simulations .",
            "id": "4253299",
            "problem": "Consider the task of quantifying and correcting finite-size artifacts that arise when modeling charged cells and slab geometries under uniform external electric fields in Density Functional Theory (DFT). In periodic boundary conditions, the electrostatic energy of a charge distribution interacts with its periodic images, which leads to a size-dependent error. For cubic supercells of linear size $L$ and volume $V = A L$ (where $A$ is the cross-sectional area), a well-tested asymptotic description of the image interactions for a charged defect with net charge $q$, dipole moment component along the field $p_z$, and quadrupole moment trace $Q$ is obtained from the Ewald-sum-based expansion of the electrostatic energy. This yields leading-order corrections that scale as $1/L$ and $1/L^3$. In slab geometries under a uniform external field $E_z$, there is also an image interaction term for the out-of-plane dipole moment $p_z$ that scales as $1/(A L)$, which can be canceled by introducing a planar dipole layer in the vacuum region. The fundamental base for this problem is Poisson’s equation for electrostatics and the Ewald representation of lattice sums for periodic images.\n\nLet $k_c$ denote the Coulomb constant expressed in electronvolt–angstrom per elementary charge squared, $k_c = 14.399645$. Let $\\alpha_M$ be the Madelung constant for the simple cubic lattice, $\\alpha_M = 2.837297$. Let $\\varepsilon$ be a dimensionless dielectric constant modeling the screening response of the medium. The external uniform field couples to the dipole as an energy $- p_z E_z$. In the asymptotic limit, the total energy of a periodically replicated supercell can be modeled by\n$$\nE_L = E_0 - p_z E_z + \\frac{k_c \\alpha_M}{2 \\varepsilon} \\frac{q^2}{L} + \\frac{2 \\pi k_c}{3 \\varepsilon} \\frac{Q}{L^3} + \\frac{2 \\pi k_c}{\\varepsilon} \\frac{p_z^2}{A L} + \\frac{r}{L^5},\n$$\nwhere $E_0$ is the isolated-system energy in the presence of the external field, and $r/L^5$ represents a small neglected higher-order remainder. The Makov–Payne (MP) correction removes the $\\sim 1/L$ and $\\sim 1/L^3$ charged-defect terms. The dipole-layer (DL) technique removes the $\\sim 1/(A L)$ dipolar image interaction in slab geometries. When both charge and slab dipole are present, the combined correction subtracts all three finite-size artifact terms. Energies must be expressed in electronvolts ($\\mathrm{eV}$), lengths in angstroms ($\\mathrm{\\AA}$), and fields in volt per angstrom ($\\mathrm{V/\\AA}$). Angles do not appear; no angle unit is required.\n\nYour task is to implement a program that, for a provided test suite of physically plausible parameter sets, constructs synthetic periodic-cell energies $E_L$ according to the model above, applies the appropriate correction scheme (Makov–Payne, dipole-layer, or combined), evaluates convergence across different $L$ values, and reports the estimated isolated-system energy $E_0 - p_z E_z$ along with a boolean convergence flag. Convergence is defined as the maximum absolute deviation of the corrected energies across the tested $L$ values being less than a tolerance $\\tau = 0.0005 \\ \\mathrm{eV}$.\n\nUse the following test suite:\n\n- Case $1$ (charged bulk cell; Makov–Payne correction): $q = 1$, $p_z = 0$, $Q = 5$, $\\varepsilon = 10$, $E_z = 0$, $A$ unused, $E_0 = 1.25$, $r = 0.05$, $L \\in \\{10, 12, 16, 20\\}$.\n- Case $2$ (neutral slab under field; dipole-layer correction): $q = 0$, $p_z = 10$, $Q = 0$, $\\varepsilon = 1$, $E_z = 0.2$, $A = 100$, $E_0 = 5.0$, $r = 0.05$, $L \\in \\{30, 40, 60\\}$.\n- Case $3$ (charged slab under field; combined correction): $q = 1$, $p_z = 5$, $Q = 2$, $\\varepsilon = 5$, $E_z = 0.1$, $A = 80$, $E_0 = 2.0$, $r = 0.05$, $L \\in \\{20, 30, 40\\}$.\n\nScientific realism constraints:\n- The parameters $q$, $p_z$, and $Q$ are defined in units $e$, $e \\cdot \\mathrm{\\AA}$, and $e \\cdot \\mathrm{\\AA}^2$, respectively.\n- The chosen $\\varepsilon$, $A$, and $L$ values produce nonpathological energies within typical DFT scales.\n- The external field coupling uses the identity that $1 \\ e \\cdot 1 \\ \\mathrm{V} = 1 \\ \\mathrm{eV}$, so $p_z E_z$ is in $\\mathrm{eV}$ for $p_z$ in $e \\cdot \\mathrm{\\AA}$ and $E_z$ in $\\mathrm{V/\\AA}$.\n\nFor each case, perform the following steps:\n- Construct $E_L$ at each $L$ using the provided parameters and the model above.\n- Apply the appropriate correction:\n  - Makov–Payne: subtract $\\frac{k_c \\alpha_M}{2 \\varepsilon} \\frac{q^2}{L} + \\frac{2 \\pi k_c}{3 \\varepsilon} \\frac{Q}{L^3}$.\n  - Dipole-layer: subtract $\\frac{2 \\pi k_c}{\\varepsilon} \\frac{p_z^2}{A L}$.\n  - Combined: subtract all three artifact terms.\n- Compute the corrected energies across the set of $L$ values, their mean, and the maximum absolute deviation from the mean; if this deviation is less than $\\tau$, set the convergence flag to true; otherwise, set it to false.\n- Report the mean corrected energy as the estimate of $E_0 - p_z E_z$ (in $\\mathrm{eV}$), rounded to six decimal places, along with the boolean convergence flag.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The six entries must be ordered as\n$[\\text{E1}, \\text{B1}, \\text{E2}, \\text{B2}, \\text{E3}, \\text{B3}]$,\nwhere $\\text{E1}$, $\\text{E2}$, and $\\text{E3}$ are the estimated isolated-system energies for Cases $1$, $2$, and $3$, respectively (each a float in $\\mathrm{eV}$, rounded to six decimal places), and $\\text{B1}$, $\\text{B2}$, and $\\text{B3}$ are the corresponding boolean convergence flags.",
            "solution": "The task is to implement and test correction schemes for artifacts that arise in DFT simulations of charged and/or polar systems under periodic boundary conditions. The total energy, $E_L$, of a system in a simulation supercell of linear size $L$ deviates from the energy of an isolated system, $E_\\infty$, due to spurious electrostatic interactions with the system's periodic images. The problem provides a quantitative model for this deviation:\n$$\nE_L = E_0 - p_z E_z + \\frac{k_c \\alpha_M}{2 \\varepsilon} \\frac{q^2}{L} + \\frac{2 \\pi k_c}{3 \\varepsilon} \\frac{Q}{L^3} + \\frac{2 \\pi k_c}{\\varepsilon} \\frac{p_z^2}{A L} + \\frac{r}{L^5}\n$$\nIn this model, $E_0$ represents the energy of the isolated system at zero external field. The term $-p_z E_z$ is the standard electrostatic interaction energy of a dipole moment $p_z$ with a uniform external field $E_z$. The quantity of interest is the total energy of the isolated system under the field, which we denote $E_\\text{iso} = E_0 - p_z E_z$. The subsequent terms, scaling with $L^{-1}$, $L^{-3}$, and $(AL)^{-1}$, are the leading-order finite-size artifacts. Here, $q$ is the net charge, $Q$ is the trace of the quadrupole moment, $\\varepsilon$ is the dielectric constant of the medium, and $A$ is the slab cross-sectional area. The constants $k_c$ and $\\alpha_M$ are the Coulomb constant ($k_c = 14.399645 \\ \\mathrm{eV \\cdot \\AA / e^2}$) and the Madelung constant for a simple cubic lattice ($\\alpha_M = 2.837297$), respectively. The final term, $r/L^5$, models the residual higher-order errors.\n\nThe solution follows a three-step procedure for each test case:\n\n1.  **Synthesize Total Energies**: We first act as the source of simulation data. For a given set of physical parameters ($q, p_z, Q, \\dots$) and a range of supercell sizes $L$, we compute the \"raw\" total energy $E_L$ using the provided model. This mimics the output from a series of DFT calculations performed at different cell sizes.\n\n2.  **Apply Finite-Size Corrections**: We then process this synthetic data by applying a specified correction scheme to each $E_L$. The corrected energy, $E_L^\\text{corr}$, is obtained by subtracting the known analytical artifact terms. The scheme depends on the physical nature of the system:\n    -   **Makov–Payne (MP) Correction**: For charged defects, it subtracts the monopole-monopole and monopole-quadrupole interaction terms.\n        $$ E_L^\\text{corr, MP} = E_L - \\left( \\frac{k_c \\alpha_M}{2 \\varepsilon} \\frac{q^2}{L} + \\frac{2 \\pi k_c}{3 \\varepsilon} \\frac{Q}{L^3} \\right) $$\n    -   **Dipole-Layer (DL) Correction**: For neutral polar slabs, it subtracts the spurious inter-slab dipole-dipole interaction term.\n        $$ E_L^\\text{corr, DL} = E_L - \\left( \\frac{2 \\pi k_c}{\\varepsilon} \\frac{p_z^2}{A L} \\right) $$\n    -   **Combined Correction**: For charged polar slabs, all three leading-order artifacts are removed.\n        $$ E_L^\\text{corr, Combined} = E_L - \\left( \\frac{k_c \\alpha_M}{2 \\varepsilon} \\frac{q^2}{L} + \\frac{2 \\pi k_c}{3 \\varepsilon} \\frac{Q}{L^3} + \\frac{2 \\pi k_c}{\\varepsilon} \\frac{p_z^2}{A L} \\right) $$\n    Given the structure of the synthetic energy model, the corrected energy in all cases simplifies to:\n    $$ E_L^\\text{corr} = E_\\text{iso} + \\frac{r}{L^5} $$\n    This expression demonstrates that as the cell size $L$ increases, the corrected energy $E_L^\\text{corr}$ converges towards the true isolated system energy $E_\\text{iso}$.\n\n3.  **Analyze Convergence and Estimate Energy**: With a set of corrected energies $\\{E_L^\\text{corr}\\}$ corresponding to the various $L$ values, we analyze their convergence to estimate $E_\\text{iso}$. The best estimate for the isolated system energy, denoted $E_\\text{est}$, is the arithmetic mean of these corrected energies:\n    $$ E_\\text{est} = \\frac{1}{N} \\sum_{i=1}^{N} E_{L_i}^\\text{corr} $$\n    Convergence is assessed by calculating the maximum absolute deviation of the corrected energies from this mean value. If this deviation is smaller than the specified tolerance $\\tau = 0.0005 \\ \\mathrm{eV}$, the calculation is deemed converged.\n    $$ \\max_{i} |E_{L_i}^\\text{corr} - E_\\text{est}| < \\tau $$\nThe algorithm is implemented in a Python script. It systematically processes each test case by generating the synthetic energies, applying the designated corrections, and performing the convergence analysis. The final output is a consolidated list containing the estimated energy (rounded to six decimal places) and the boolean convergence flag for each of the three cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates and corrects finite-size artifacts in synthetic DFT energy data\n    for charged and/or dipolar systems under periodic boundary conditions.\n    \"\"\"\n    \n    # Define physical and numerical constants\n    k_c = 14.399645      # Coulomb constant in eV * Angstrom / e^2\n    alpha_M = 2.837297   # Madelung constant for simple cubic lattice\n    tau = 0.0005         # Convergence tolerance in eV\n\n    # Define the test suite from the problem statement\n    test_cases = [\n        {\n            # Case 1: Charged bulk cell (Makov-Payne correction)\n            \"params\": {'q': 1, 'p_z': 0, 'Q': 5, 'epsilon': 10, 'E_z': 0, 'A': None, 'E_0': 1.25, 'r': 0.05},\n            \"L_values\": [10, 12, 16, 20],\n            \"correction_type\": \"mp\"\n        },\n        {\n            # Case 2: Neutral slab under field (Dipole-layer correction)\n            \"params\": {'q': 0, 'p_z': 10, 'Q': 0, 'epsilon': 1, 'E_z': 0.2, 'A': 100, 'E_0': 5.0, 'r': 0.05},\n            \"L_values\": [30, 40, 60],\n            \"correction_type\": \"dl\"\n        },\n        {\n            # Case 3: Charged slab under field (Combined correction)\n            \"params\": {'q': 1, 'p_z': 5, 'Q': 2, 'epsilon': 5, 'E_z': 0.1, 'A': 80, 'E_0': 2.0, 'r': 0.05},\n            \"L_values\": [20, 30, 40],\n            \"correction_type\": \"combined\"\n        }\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        params = case[\"params\"]\n        q = params['q']\n        p_z = params['p_z']\n        Q = params['Q']\n        epsilon = params['epsilon']\n        E_z = params['E_z']\n        A = params['A']\n        E_0 = params['E_0']\n        r = params['r']\n        \n        corrected_energies = []\n        \n        # Determine the true isolated system energy under the external field\n        E_iso = E_0 - p_z * E_z\n        \n        for L in case[\"L_values\"]:\n            # Step 1: Calculate individual artifact terms\n            # Makov-Payne charge term\n            term_charge = (k_c * alpha_M / (2 * epsilon)) * (q**2 / L)\n            # Makov-Payne quadrupole term\n            term_quadrupole = (2 * np.pi * k_c / (3 * epsilon)) * (Q / L**3)\n            \n            # Dipole-layer term (only relevant if p_z is non-zero and A is specified)\n            term_dipole = 0\n            if p_z != 0 and A is not None:\n                term_dipole = (2 * np.pi * k_c / epsilon) * (p_z**2 / (A * L))\n\n            # Higher-order remainder term\n            term_remainder = r / L**5\n            \n            # Step 2: Construct the synthetic total energy E_L\n            E_L = E_iso + term_charge + term_quadrupole + term_dipole + term_remainder\n\n            # Step 3: Apply the appropriate correction to obtain E_L_corr\n            correction_to_apply = 0.0\n            if case[\"correction_type\"] == \"mp\":\n                correction_to_apply = term_charge + term_quadrupole\n            elif case[\"correction_type\"] == \"dl\":\n                correction_to_apply = term_dipole\n            elif case[\"correction_type\"] == \"combined\":\n                correction_to_apply = term_charge + term_quadrupole + term_dipole\n            \n            E_L_corr = E_L - correction_to_apply\n            corrected_energies.append(E_L_corr)\n        \n        # Step 4: Analyze convergence and estimate the isolated energy\n        corrected_energies_np = np.array(corrected_energies)\n        \n        # The estimate is the mean of the corrected energies\n        estimated_energy = np.mean(corrected_energies_np)\n        \n        # The convergence check is based on the maximum absolute deviation from the mean\n        max_deviation = np.max(np.abs(corrected_energies_np - estimated_energy))\n        is_converged = max_deviation < tau\n        \n        # Step 5: Store results rounded as specified\n        final_results.append(round(estimated_energy, 6))\n        final_results.append(is_converged)\n\n    # Print the final output in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        }
    ]
}