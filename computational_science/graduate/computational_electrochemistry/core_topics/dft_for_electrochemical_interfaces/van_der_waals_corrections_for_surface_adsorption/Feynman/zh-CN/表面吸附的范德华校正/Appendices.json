{
    "hands_on_practices": [
        {
            "introduction": "理解范德华校正的第一步是学习如何计算相互作用能本身。第一个练习将指导你完成一项基本任务：通过实现直接的实空间求和，来计算吸附物与周期性表面之间的成对色散能 。这项练习将巩固你对周期性系统中长程相互作用处理方式的理解，并让你体会到使用实空间截断半径并检验计算收敛性的重要性。",
            "id": "4261665",
            "problem": "您正在为一个表示电极表面的二维周期性晶格与单个吸附物之间的长程相互作用进行建模。在计算电化学中，色散相互作用（有时作为密度泛函理论计算的校正项添加）通过符合 London 色散相互作用的幂律衰减的成对能量来建模。假设每个晶格单元的原点位置有一个衬底原子，并且通过周期性边界条件生成一个无限延伸的二维晶格。\n\n基本原理：\n- 两个相距为 $r$ 的物种之间的成对色散能模型为 $-C_6 r^{-6}$，其中 $C_6$ 是一个常数，单位为能量乘以长度的六次方。\n- 一个晶格参数为 $L_x$ 和 $L_y$ 的二维周期性晶格，其镜像位置在 $(i L_x, j L_y, 0)$，其中 $i$ 和 $j$ 为整数。\n- 吸附物位于晶格平面上方一个固定的笛卡尔坐标位置 $(x_0, y_0, z_0)$。\n\n计算所需的定义：\n- 对于由整数 $i$ 和 $j$ 索引的每个镜像，吸附物与该镜像处衬底原子之间的距离为\n$$\nr_{ij} = \\sqrt{(x_0 - i L_x)^2 + (y_0 - j L_y)^2 + z_0^2}.\n$$\n- 在有限实空间截断半径 $r_c$ 下的色散校正能是截断求和\n$$\nE_{\\mathrm{disp}}(r_c) = - \\sum_{\\substack{i,j \\in \\mathbb{Z} \\\\ r_{ij} \\le r_c}} \\frac{C_6}{r_{ij}^6}.\n$$\n- 相对于截断半径的收敛性通过比较连续截断半径下的能量来评估。使用一个容差 $\\varepsilon$（单位为能量），定义\n$$\n\\Delta E = \\left| E_{\\mathrm{disp}}(r_c^{(n)}) - E_{\\mathrm{disp}}(r_c^{(n-1)}) \\right|.\n$$\n如果 $\\Delta E  \\varepsilon$，则认为能量在最大截断半径 $r_c^{(n)}$ 处收敛。\n\n算法约束：\n- 距离单位必须是埃（$\\mathrm{\\AA}$）。\n- 能量单位必须是电子伏特（$\\mathrm{eV}$）。\n- 常数 $C_6$ 的单位必须是 $\\mathrm{eV}\\,\\mathrm{\\AA}^6$。\n- 使用一个实空间截断半径 $r_c$，只包含满足 $r_{ij} \\le r_c$ 的镜像。\n- 为确保覆盖所有镜像，您可以将索引限制在 $i \\in [-N_x, N_x]$ 和 $j \\in [-N_y, N_y]$ 范围内，其中 $N_x = \\lceil r_c / L_x \\rceil + 1$ 且 $N_y = \\lceil r_c / L_y \\rceil + 1$，然后根据 $r_{ij} \\le r_c$ 进行筛选。\n- 如果一个测试用例提供的截断值少于两个，则将收敛标志视为假（false），因为差值 $\\Delta E$ 无法计算。\n\n您的任务是编写一个完整、可运行的程序，该程序：\n1. 对测试用例中提供的每个截断半径计算 $E_{\\mathrm{disp}}(r_c)$。\n2. 对每个测试用例，返回一个包含两个元素的列表，其中包含最大截断半径下的能量和一个布尔值，该布尔值指示能量是否根据上述标准收敛。\n\n测试套件：\n- 用例 $1$（正常路径）：\n  - $L_x = 2.5\\,\\mathrm{\\AA}$，$L_y = 2.5\\,\\mathrm{\\AA}$。\n  - $x_0 = 0.0\\,\\mathrm{\\AA}$，$y_0 = 0.0\\,\\mathrm{\\AA}$，$z_0 = 3.0\\,\\mathrm{\\AA}$。\n  - $C_6 = 12.0\\,\\mathrm{eV}\\,\\mathrm{\\AA}^6$。\n  - 截断半径 $[6.0\\,\\mathrm{\\AA}, 10.0\\,\\mathrm{\\AA}, 14.0\\,\\mathrm{\\AA}, 20.0\\,\\mathrm{\\AA}]$。\n  - 容差 $\\varepsilon = 1.0 \\times 10^{-5}\\,\\mathrm{eV}$。\n\n- 用例 $2$（最小截断半径排除了最近镜像的边界情况）：\n  - $L_x = 3.0\\,\\mathrm{\\AA}$，$L_y = 3.0\\,\\mathrm{\\AA}$。\n  - $x_0 = 0.0\\,\\mathrm{\\AA}$，$y_0 = 0.0\\,\\mathrm{\\AA}$，$z_0 = 5.0\\,\\mathrm{\\AA}$。\n  - $C_6 = 20.0\\,\\mathrm{eV}\\,\\mathrm{\\AA}^6$。\n  - 截断半径 $[3.0\\,\\mathrm{\\AA}, 5.0\\,\\mathrm{\\AA}, 9.0\\,\\mathrm{\\AA}]$。\n  - 容差 $\\varepsilon = 1.0 \\times 10^{-6}\\,\\mathrm{eV}$。\n\n- 用例 $3$（各向异性晶格上的偏移吸附物）：\n  - $L_x = 4.0\\,\\mathrm{\\AA}$，$L_y = 3.0\\,\\mathrm{\\AA}$。\n  - $x_0 = 2.0\\,\\mathrm{\\AA}$，$y_0 = 1.5\\,\\mathrm{\\AA}$，$z_0 = 2.5\\,\\mathrm{\\AA}$。\n  - $C_6 = 8.0\\,\\mathrm{eV}\\,\\mathrm{\\AA}^6$。\n  - 截断半径 $[8.0\\,\\mathrm{\\AA}, 16.0\\,\\mathrm{\\AA}, 24.0\\,\\mathrm{\\AA}]$。\n  - 容差 $\\varepsilon = 1.0 \\times 10^{-5}\\,\\mathrm{eV}$。\n\n- 用例 $4$（更大的晶胞，严格的收敛性检查）：\n  - $L_x = 5.0\\,\\mathrm{\\AA}$，$L_y = 7.0\\,\\mathrm{\\AA}$。\n  - $x_0 = 1.25\\,\\mathrm{\\AA}$，$y_0 = 3.5\\,\\mathrm{\\AA}$，$z_0 = 3.5\\,\\mathrm{\\AA}$。\n  - $C_6 = 15.0\\,\\mathrm{eV}\\,\\mathrm{\\AA}^6$。\n  - 截断半径 $[10.0\\,\\mathrm{\\AA}, 20.0\\,\\mathrm{\\AA}, 30.0\\,\\mathrm{\\AA}, 40.0\\,\\mathrm{\\AA}]$。\n  - 容差 $\\varepsilon = 1.0 \\times 10^{-7}\\,\\mathrm{eV}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 对应于每个测试用例的元素必须是 $[E, \\mathrm{converged}]$ 形式的双元素列表，其中 $E$ 是最大截断半径下的能量（单位为 $\\mathrm{eV}$，浮点数），而 $\\mathrm{converged}$ 是一个布尔值。\n- 例如，输出形式应为 $[[E_1,\\mathrm{True}],[E_2,\\mathrm{False}],\\dots]$。",
            "solution": "提出的问题是计算单个吸附物分子与代表表面的二维周期性晶格之间的范德华色散能。必须对多个截断半径进行分析，并对能量的收敛性做出判断。\n\n### 1. 问题验证\n首先根据指定标准对问题进行验证。\n\n-   **提取的已知条件：**\n    -   成对色散能：$E_{pair} = -C_6 r^{-6}$。\n    -   晶格镜像位置：$(i L_x, j L_y, 0)$，其中 $i, j \\in \\mathbb{Z}$。\n    -   晶格参数：$L_x, L_y$。\n    -   吸附物位置：$(x_0, y_0, z_0)$。\n    -   吸附物-镜像距离：$r_{ij} = \\sqrt{(x_0 - i L_x)^2 + (y_0 - j L_y)^2 + z_0^2}$。\n    -   截断色散能：$E_{\\mathrm{disp}}(r_c) = - \\sum_{\\substack{i,j \\in \\mathbb{Z} \\\\ r_{ij} \\le r_c}} \\frac{C_6}{r_{ij}^6}$。\n    -   收敛标准：$\\Delta E = \\left| E_{\\mathrm{disp}}(r_c^{(n)}) - E_{\\mathrm{disp}}(r_c^{(n-1)}) \\right|  \\varepsilon$。\n    -   索引范围的算法约束：$i \\in [-N_x, N_x], j \\in [-N_y, N_y]$，其中 $N_x = \\lceil r_c / L_x \\rceil + 1, N_y = \\lceil r_c / L_y \\rceil + 1$。\n    -   收敛标志规则：如果提供的截断值少于两个，则为 `False`。\n    -   单位：距离单位为埃（$\\mathrm{\\AA}$），能量单位为电子伏特（$\\mathrm{eV}$），$C_6$ 单位为 $\\mathrm{eV}\\,\\mathrm{\\AA}^6$。\n    -   提供了包含所有必要参数的测试用例。\n\n-   **验证结论：**\n    -   **科学依据：** 该问题使用标准的 $r^{-6}$ 形式来表示 London 色散力，这是分子间相互作用理论的基石。周期性表面模型和实空间截断求和是计算材料科学和表面科学中的标准技术（例如，在 DFT+D 方法中）。该问题是科学合理的。\n    -   **适定性：** 该问题为所有待计算量（$r_{ij}$，$E_{\\mathrm{disp}}(r_c)$）提供了明确的数学定义，并为收敛性（$\\Delta E  \\varepsilon$）提供了清晰、客观的标准。每个测试用例都提供了所有必要的输入参数，确保存在唯一解。\n    -   **客观性：** 问题以精确的定量术语陈述，没有任何主观或模糊的语言。\n\n该问题被认为是**有效的**，因为它科学合理、适定、客观，并提供了一套完整且一致的信息和指令。\n\n### 2. 求解方法\n\n该解决方案涉及在周期性晶格上对成对相互作用能进行直接的实空间求和，并在指定的截断半径 $r_c$ 处截断。\n\n**基于原理的设计：**\n\n基本原理是，吸附物与整个无限表面之间的长程色散能可以通过对吸附物与每个表面原子之间直到一定距离的成对相互作用求和来近似。该和由下式给出：\n$$\nE_{\\mathrm{disp}}(r_c) = \\sum_{\\substack{i,j \\in \\mathbb{Z} \\\\ r_{ij} \\le r_c}} E_{pair}(r_{ij}) = -C_6 \\sum_{\\substack{i,j \\in \\mathbb{Z} \\\\ r_{ij} \\le r_c}} \\frac{1}{r_{ij}^6}\n$$\n其中 $r_{ij}$ 是位于 $(x_0, y_0, z_0)$ 的吸附物与位于 $(i L_x, j L_y, 0)$ 的晶格镜像原子之间的距离。此近似的质量取决于截断半径 $r_c$；较大的 $r_c$ 包含更多的相互作用项，从而产生更准确的结果。\n\n**算法实现：**\n\n为了进行求和，我们必须遍历整数索引 $(i, j)$。无限搜索是不可能的。问题为索引指定了一个安全的、有限的搜索域：$i \\in [-N_x, N_x]$ 和 $j \\in [-N_y, N_y]$。$N_x$ 和 $N_y$ 的边界选择得足够大，以包含以吸附物 $(x,y)$ 投影为中心、半径为 $r_c$ 的球体。指定的公式 $N_x = \\lceil r_c / L_x \\rceil + 1$ 和 $N_y = \\lceil r_c / L_y \\rceil + 1$ 提供了这样一个安全的边界框。额外的 `+1` 项确保即使吸附物位置靠近晶胞边界，截断半径内的所有原子也都被考虑在内。\n\n对于每个测试用例，执行以下步骤：\n1.  计算一个能量列表，其中每个能量对应一个提供的截断值。\n2.  为单个截断半径 $r_c$ 计算能量 $E_{\\mathrm{disp}}(r_c)$：\n    a. 根据 $r_c$、$L_x$ 和 $L_y$ 确定整数索引边界 $N_x$ 和 $N_y$。\n    b. 在 $[-N_x, N_x]$ 和 $[-N_y, N_y]$ 范围内生成一个二维索引网格 $(i, j)$。这可以通过使用 `numpy.meshgrid` 高效实现。\n    c. 对于每个网格点 $(i, j)$，计算距离 $r_{ij}$。为了性能，此操作被向量化，通过一次操作计算所有距离。\n    d. 创建一个布尔掩码来识别哪些距离满足截断条件 $r_{ij} \\le r_c$。由于问题说明 $z_0 > 0$，隐式处理了对 $r_{ij} > 0$ 的检查，确保不会发生除以零的错误。\n    e. 对通过筛选的距离计算能量项 $(-C_6 / r_{ij}^6)$。\n    f. 将这些项求和，得到总的截断色散能 $E_{\\mathrm{disp}}(r_c)$。\n3.  在计算完一个测试用例中所有截断半径的能量后，最终能量取为对应于最大截断半径 $r_c^{(n)}$ 的能量。\n\n这个数值过程使用 Python 的 `NumPy` 库实现，因为它能高效处理数组操作，非常适合这种基于网格的计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the dispersion correction energy and checks for convergence\n    for a series of test cases.\n    \"\"\"\n    # Test suite definition as per the problem statement.\n    test_cases = [\n        {\n            \"Lx\": 2.5, \"Ly\": 2.5,\n            \"x0\": 0.0, \"y0\": 0.0, \"z0\": 3.0,\n            \"C6\": 12.0,\n            \"cutoffs\": [6.0, 10.0, 14.0, 20.0],\n            \"epsilon\": 1.0e-5\n        },\n        {\n            \"Lx\": 3.0, \"Ly\": 3.0,\n            \"x0\": 0.0, \"y0\": 0.0, \"z0\": 5.0,\n            \"C6\": 20.0,\n            \"cutoffs\": [3.0, 5.0, 9.0],\n            \"epsilon\": 1.0e-6\n        },\n        {\n            \"Lx\": 4.0, \"Ly\": 3.0,\n            \"x0\": 2.0, \"y0\": 1.5, \"z0\": 2.5,\n            \"C6\": 8.0,\n            \"cutoffs\": [8.0, 16.0, 24.0],\n            \"epsilon\": 1.0e-5\n        },\n        {\n            \"Lx\": 5.0, \"Ly\": 7.0,\n            \"x0\": 1.25, \"y0\": 3.5, \"z0\": 3.5,\n            \"C6\": 15.0,\n            \"cutoffs\": [10.0, 20.0, 30.0, 40.0],\n            \"epsilon\": 1.0e-7\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        Lx, Ly = case[\"Lx\"], case[\"Ly\"]\n        x0, y0, z0 = case[\"x0\"], case[\"y0\"], case[\"z0\"]\n        C6 = case[\"C6\"]\n        cutoffs = case[\"cutoffs\"]\n        epsilon = case[\"epsilon\"]\n\n        energies = []\n        for rc in cutoffs:\n            # Calculate integer index ranges based on the cutoff radius.\n            Nx = int(np.ceil(rc / Lx)) + 1\n            Ny = int(np.ceil(rc / Ly)) + 1\n\n            # Create grids of integer indices i and j.\n            i_vals = np.arange(-Nx, Nx + 1)\n            j_vals = np.arange(-Ny, Ny + 1)\n            i_grid, j_grid = np.meshgrid(i_vals, j_vals)\n\n            # Calculate the positions of the lattice images.\n            x_img = i_grid * Lx\n            y_img = j_grid * Ly\n\n            # Calculate the square of the distance from the adsorbate to each image.\n            # r_ij^2 = (x0 - i*Lx)^2 + (y0 - j*Ly)^2 + z0^2\n            r_sq = (x0 - x_img)**2 + (y0 - y_img)**2 + z0**2\n\n            # Calculate distances, avoiding division by zero by filtering later.\n            # Since z0 > 0, r will never be zero.\n            r = np.sqrt(r_sq)\n\n            # Apply the spherical cutoff condition r_ij = rc.\n            mask = r = rc\n            \n            # Since z0 > 0 in all test cases, r is never zero, so checking\n            # r > 0 is not strictly necessary but is good practice.\n            # The calculation 1/r**6 would fail if r=0.\n            relevant_r = r[mask]\n            \n            # Sum the pairwise dispersion energies.\n            if relevant_r.size > 0:\n                energy_sum = -C6 * np.sum(1.0 / relevant_r**6)\n            else:\n                energy_sum = 0.0\n            \n            energies.append(energy_sum)\n\n        is_converged = False\n        final_energy = 0.0\n\n        if len(cutoffs) >= 1:\n            final_energy = energies[-1]\n            if len(cutoffs) >= 2:\n                # Check convergence criterion using the last two cutoffs.\n                delta_E = abs(energies[-1] - energies[-2])\n                if delta_E  epsilon:\n                    is_converged = True\n        \n        # Format result as a list [energy, boolean].\n        all_results.append(f\"[{final_energy},{str(is_converged).lower()}]\")\n\n    # Print the final output in the required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了计算单个相互作用能之外，理解范德华力如何塑造吸附物所经历的整个势能面也至关重要。本练习使用一个物理意义明确的模型来绘制苯在铜表面的吸附能，让你能够直接观察并量化范德华校正如何改变表面势能的“起伏”程度 。通过比较包含与不包含色散作用的能量面，你将深入了解这些力如何影响优先吸附位点和表面迁移行为。",
            "id": "4261653",
            "problem": "要求你设计并实现一个完整的程序，构建一个代表 $(111)$ 朝向的铜 (Cu) 的一个表面原胞的二维计算网格，并用它来绘制苯的吸附能作为横向位置（即原胞内的面内位置）的函数。目标是量化在包含和不包含范德华 (vdW) 色散相互作用两种情况下，吸附能势垒的起伏幅度。\n\n从以下标准的、符合上下文的基础开始：\n- 面心立方铜的 $(111)$ 表面具有一个二维三角晶格。铜的体相晶格常数是 $a_0 = 3.615 \\ \\mathrm{\\AA}$，表面晶格常数是 $a_s = a_0 / \\sqrt{2}$。\n- 对于三角晶格，其原初实空间晶格矢量在 $(x,y)$ 平面内可取为 $\\mathbf{a}_1 = a_s (1, 0)$ 和 $\\mathbf{a}_2 = a_s \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$。\n- 第一星族倒易晶格矢量的大小为 $|\\mathbf{G}| = \\frac{4 \\pi}{\\sqrt{3} \\, a_s}$，方向为 $\\mathbf{G}_1 = |\\mathbf{G}| (1, 0)$、$\\mathbf{G}_2 = |\\mathbf{G}| \\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$ 和 $\\mathbf{G}_3 = |\\mathbf{G}| \\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)$。\n\n对于在固定吸附高度 $z$ 处平躺的苯分子，假设采用以下具有物理动机的简化能量模型：\n- 源于周期性表面势的吸附能横向起伏由最低阶傅里叶和表示，\n$$\nS(\\mathbf{r}) = \\frac{1}{3} \\sum_{i=1}^{3} \\cos(\\mathbf{G}_i \\cdot \\mathbf{r}),\n$$\n以及一个基线起伏能\n$$\nV_{\\mathrm{corr}}(\\mathbf{r}) = A_0 \\, S(\\mathbf{r}),\n$$\n其中 $A_0$ 是一个能量幅度参数，单位为电子伏特 (eV)。\n- 短程泡利排斥随吸附高度近似呈指数衰减，并且在电子重叠较大的位置更强。通过以下方式对此建模：\n$$\nB(\\mathbf{r}) = B_0 \\left(1 + \\beta \\, S(\\mathbf{r})\\right),\n$$\n和\n$$\nV_{\\mathrm{rep}}(z,\\mathbf{r}) = B(\\mathbf{r}) \\, \\exp(-\\alpha \\, z),\n$$\n其中 $B_0$ 是一个能量标度（单位 eV），$\\beta$ 是一个无量纲的横向调制因子，$\\alpha$ 是一个逆长度参数（单位 $\\mathrm{\\AA}^{-1}$）。\n- 分子和金属表面之间的范德华 (vdW) 色散相互作用渐近地按 $z^{-3}$ 比例变化，可以建模为\n$$\nE_{\\mathrm{vdW}}(z) = -\\frac{C_3}{z^3},\n$$\n其中 $C_3$ 是一个相互作用系数（单位 $\\mathrm{eV} \\cdot \\mathrm{\\AA}^3$）。\n\n在这些假设下，将在位置 $\\mathbf{r}$ 的总吸附能定义为：\n- 不考虑色散作用时，\n$$\nE_{\\mathrm{no\\_vdW}}(\\mathbf{r}) = E_0 + V_{\\mathrm{corr}}(\\mathbf{r}) + V_{\\mathrm{rep}}(z_{\\mathrm{no}},\\mathbf{r})\n$$\n- 考虑色散作用时，\n$$\nE_{\\mathrm{with\\_vdW}}(\\mathbf{r}) = E_0 + V_{\\mathrm{corr}}(\\mathbf{r}) + V_{\\mathrm{rep}}(z_{\\mathrm{with}},\\mathbf{r}) + E_{\\mathrm{vdW}}(z_{\\mathrm{with}})\n$$\n其中 $E_0$ 是一个恒定参考能量（单位 eV），$z_{\\mathrm{no}}$ 和 $z_{\\mathrm{with}}$ 分别是用于无色散和有色散情况的固定吸附高度（单位 $\\mathrm{\\AA}$）。\n\n你的程序必须：\n1. 在一个原胞上构建一个 $N_x \\times N_y$ 的均匀网格，使用分数坐标 $(u,v)$，其中 $u \\in [0,1)$ 且 $v \\in [0,1)$，并通过 $\\mathbf{r}(u,v) = u \\, \\mathbf{a}_1 + v \\, \\mathbf{a}_2$ 转换为笛卡尔坐标。\n2. 在整个网格上计算 $S(\\mathbf{r})$、$V_{\\mathrm{corr}}(\\mathbf{r})$、$V_{\\mathrm{rep}}(z,\\mathbf{r})$ 以及 $E_{\\mathrm{no\\_vdW}}(\\mathbf{r})$ 和 $E_{\\mathrm{with\\_vdW}}(\\mathbf{r})$。\n3. 量化起伏幅度，即网格上的能量范围：\n$$\n\\Delta E_{\\mathrm{no}} = \\max_{\\mathbf{r}} E_{\\mathrm{no\\_vdW}}(\\mathbf{r}) - \\min_{\\mathbf{r}} E_{\\mathrm{no\\_vdW}}(\\mathbf{r}),\n$$\n$$\n\\Delta E_{\\mathrm{with}} = \\max_{\\mathbf{r}} E_{\\mathrm{with\\_vdW}}(\\mathbf{r}) - \\min_{\\mathbf{r}} E_{\\mathrm{with\\_vdW}}(\\mathbf{r}).\n$$\n同时报告其差值\n$$\n\\Delta E_{\\mathrm{diff}} = \\Delta E_{\\mathrm{with}} - \\Delta E_{\\mathrm{no}}.\n$$\n\n使用以下参数集作为测试套件。对于每种情况，计算并返回三个浮点数 $(\\Delta E_{\\mathrm{no}}, \\Delta E_{\\mathrm{with}}, \\Delta E_{\\mathrm{diff}})$，所有值均以电子伏特 (eV) 为单位，并四舍五入到六位小数：\n- 情况1（中等调制的一般情况）：$N_x = 25$, $N_y = 25$, $A_0 = 0.02 \\ \\mathrm{eV}$, $B_0 = 1.0 \\ \\mathrm{eV}$, $\\beta = 0.5$, $\\alpha = 1.5 \\ \\mathrm{\\AA}^{-1}$, $z_{\\mathrm{no}} = 3.4 \\ \\mathrm{\\AA}$, $z_{\\mathrm{with}} = 3.0 \\ \\mathrm{\\AA}$, $C_3 = 8.0 \\ \\mathrm{eV} \\cdot \\mathrm{\\AA}^3$, $E_0 = 0.0 \\ \\mathrm{eV}$。\n- 情况2（无短程调制的边界情况）：$N_x = 25$, $N_y = 25$, $A_0 = 0.02 \\ \\mathrm{eV}$, $B_0 = 0.0 \\ \\mathrm{eV}$, $\\beta = 0.5$, $\\alpha = 1.5 \\ \\mathrm{\\AA}^{-1}$, $z_{\\mathrm{no}} = 3.4 \\ \\mathrm{\\AA}$, $z_{\\mathrm{with}} = 3.0 \\ \\mathrm{\\AA}$, $C_3 = 8.0 \\ \\mathrm{eV} \\cdot \\mathrm{\\AA}^3$, $E_0 = 0.0 \\ \\mathrm{eV}$。\n- 情况3（粗糙网格和更强参数的边缘情况）：$N_x = 3$, $N_y = 3$, $A_0 = 0.05 \\ \\mathrm{eV}$, $B_0 = 2.0 \\ \\mathrm{eV}$, $\\beta = 0.5$, $\\alpha = 1.8 \\ \\mathrm{\\AA}^{-1}$, $z_{\\mathrm{no}} = 3.6 \\ \\mathrm{\\AA}$, $z_{\\mathrm{with}} = 2.8 \\ \\mathrm{\\AA}$, $C_3 = 12.0 \\ \\mathrm{eV} \\cdot \\mathrm{\\AA}^3$, $E_0 = 0.0 \\ \\mathrm{eV}$。\n- 情况4（高横向调制灵敏度）：$N_x = 64$, $N_y = 64$, $A_0 = 0.01 \\ \\mathrm{eV}$, $B_0 = 1.5 \\ \\mathrm{eV}$, $\\beta = 1.0$, $\\alpha = 1.2 \\ \\mathrm{\\AA}^{-1}$, $z_{\\mathrm{no}} = 3.3 \\ \\mathrm{\\AA}$, $z_{\\mathrm{with}} = 2.7 \\ \\mathrm{\\AA}$, $C_3 = 10.0 \\ \\mathrm{eV} \\cdot \\mathrm{\\AA}^3$, $E_0 = 0.0 \\ \\mathrm{eV}$。\n\n最终输出格式：你的程序应生成单行输出，包含四个测试用例的结果，格式为逗号分隔的列表的列表，每个内部列表是三个浮点数 $(\\Delta E_{\\mathrm{no}}, \\Delta E_{\\mathrm{with}}, \\Delta E_{\\mathrm{diff}})$，并用方括号括起来。例如，一个有效的输出应如下所示\n$$\n\\texttt{[[x\\_1,y\\_1,z\\_1],[x\\_2,y\\_2,z\\_2],[x\\_3,y\\_3,z\\_3],[x\\_4,y\\_4,z\\_4]]}\n$$\n其中每个 $x_i$、$y_i$ 和 $z_i$ 都是以电子伏特 (eV) 为单位的浮点数，四舍五入到六位小数。",
            "solution": "用户提交的问题是**有效的**。它在科学上基于表面科学的原理，问题设定清晰，具有明确的计算目标，并且客观地陈述了所有必要的参数和定义。该问题要求实现一个简化的、但具有物理动机的模型，用于计算苯在 Cu$(111)$ 表面上的吸附能，并使用该模型来量化范德华相互作用对势能面起伏的影响。\n\n解决方案首先定义系统几何结构，然后构建计算网格，接着在整个网格上评估能量分量，最后计算所需的起伏幅度。\n\n**1. 几何与晶格定义**\n\n问题指定了一个面心立方 (fcc) 铜晶体，其体相晶格常数 $a_0 = 3.615 \\ \\mathrm{\\AA}$。$(111)$ 表面形成一个二维三角晶格。该表面上最近邻原子之间的距离定义了表面晶格常数 $a_s$，由 $a_s = a_0 / \\sqrt{2}$ 给出。\n\n数值上，$a_s = 3.615 / \\sqrt{2} \\approx 2.556 \\ \\mathrm{\\AA}$。\n\n定义 $(x,y)$ 平面内原胞的原初实空间晶格矢量如下：\n$$\n\\mathbf{a}_1 = a_s (1, 0)\n$$\n$$\n\\mathbf{a}_2 = a_s \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)\n$$\n表面的周期性势在倒易空间中描述最为自然。问题提供了第一星族倒易晶格矢量，它们是倒易晶格中满足表面三重对称性的最短非零矢量。其大小为：\n$$\n|\\mathbf{G}| = \\frac{4 \\pi}{\\sqrt{3} \\, a_s}\n$$\n这三个矢量是：\n$$\n\\mathbf{G}_1 = |\\mathbf{G}| (1, 0)\n$$\n$$\n\\mathbf{G}_2 = |\\mathbf{G}| \\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)\n$$\n$$\n\\mathbf{G}_3 = |\\mathbf{G}| \\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)\n$$\n这些矢量构成了表面势最低阶傅里叶展开的基础。\n\n**2. 网格构建**\n\n构建一个 $N_x \\times N_y$ 的均匀计算网格，用于在一个原胞内对势能进行采样。网格点使用分数坐标 $(u,v)$ 生成，其中 $u \\in [0, 1)$ 且 $v \\in [0, 1)$。具体来说，我们使用 $u_i = i/N_x$（对于 $i \\in \\{0, 1, ..., N_x-1\\}$）和 $v_j = j/N_y$（对于 $j \\in \\{0, 1, ..., N_y-1\\}$）。\n\n每个分数坐标点 $(u,v)$ 通过实空间晶格矢量的线性组合映射到笛卡尔坐标 $\\mathbf{r}=(x,y)$：\n$$\n\\mathbf{r}(u,v) = u \\, \\mathbf{a}_1 + v \\, \\mathbf{a}_2 = \\left( u a_s + v \\frac{a_s}{2}, v \\frac{a_s\\sqrt{3}}{2} \\right)\n$$\n此过程生成一个覆盖平行四边形形状原胞的 $N_x \\times N_y$ 笛卡尔坐标点网格。\n\n**3. 能量评估**\n\n在每个网格点 $\\mathbf{r}$，基于所提供的模型计算总吸附能。核心部分是横向起伏函数 $S(\\mathbf{r})$，定义为对第一星族倒易晶格矢量的求和：\n$$\nS(\\mathbf{r}) = \\frac{1}{3} \\sum_{k=1}^{3} \\cos(\\mathbf{G}_k \\cdot \\mathbf{r})\n$$\n对于每个网格点，计算每个 $k$ 的点积 $\\mathbf{G}_k \\cdot \\mathbf{r}$。这个函数 $S(\\mathbf{r})$ 捕捉了表面势的周期性和对称性，其范围从 -0.5 到 1.0。\n\n总吸附能由几个部分组成：\n- 基线起伏势，$V_{\\mathrm{corr}}(\\mathbf{r}) = A_0 \\, S(\\mathbf{r})$。\n- 短程泡利排斥势，$V_{\\mathrm{rep}}(z,\\mathbf{r}) = B(\\mathbf{r}) \\, \\exp(-\\alpha \\, z)$，其中前置因子 $B(\\mathbf{r}) = B_0 (1 + \\beta \\, S(\\mathbf{r}))$ 依赖于横向位置，以模拟位点相关的排斥作用。\n- 范德华 (vdW) 色散吸引力，$E_{\\mathrm{vdW}}(z) = -C_3/z^3$。\n- 一个恒定的能量偏移，$E_0$。\n\n考虑两种情景：\n1.  **不含 vdW 色散：** 吸附能在固定高度 $z_{\\mathrm{no}}$ 计算：\n    $$\n    E_{\\mathrm{no\\_vdW}}(\\mathbf{r}) = E_0 + A_0 S(\\mathbf{r}) + B_0(1 + \\beta S(\\mathbf{r})) \\exp(-\\alpha z_{\\mathrm{no}})\n    $$\n2.  **包含 vdW 色散：** 能量在另一个固定高度 $z_{\\mathrm{with}}$ 计算，并包含 vdW 项：\n    $$\n    E_{\\mathrm{with\\_vdW}}(\\mathbf{r}) = E_0 + A_0 S(\\mathbf{r}) + B_0(1 + \\beta S(\\mathbf{r})) \\exp(-\\alpha z_{\\mathrm{with}}) - \\frac{C_3}{z_{\\mathrm{with}}^3}\n    $$\n**4. 起伏幅度的计算**\n\n起伏幅度 $\\Delta E$ 定义为整个原胞网格上能量最大值与最小值之差。\n$$\n\\Delta E = \\max_{\\mathbf{r} \\in \\text{grid}} E(\\mathbf{r}) - \\min_{\\mathbf{r} \\in \\text{grid}} E(\\mathbf{r})\n$$\n我们可以通过收集乘以 $S(\\mathbf{r})$ 的项和常数项来简化能量表达式。对于给定的高度 $z$，能量可以写成：\n$$\nE(\\mathbf{r}, z) = \\text{Constant}(z) + \\left[ A_0 + B_0 \\beta \\exp(-\\alpha z) \\right] S(\\mathbf{r})\n$$\n由于 $\\Delta E$ 是 $E(\\mathbf{r},z)$ 的范围，常数项会抵消。因此，幅度为：\n$$\n\\Delta E(z) = (\\max_{\\mathbf{r}} S(\\mathbf{r}) - \\min_{\\mathbf{r}} S(\\mathbf{r})) \\times \\left| A_0 + B_0 \\beta \\exp(-\\alpha z) \\right|\n$$\n这使我们能够计算所需的量：\n$$\n\\Delta E_{\\mathrm{no}} = (\\max S - \\min S) \\times |A_0 + B_0 \\beta \\exp(-\\alpha z_{\\mathrm{no}})|\n$$\n$$\n\\Delta E_{\\mathrm{with}} = (\\max S - \\min S) \\times |A_0 + B_0 \\beta \\exp(-\\alpha z_{\\mathrm{with}})|\n$$\n$(\\max S - \\min S)$ 的值是通过在每种情况下找到计算出的 $S(\\mathbf{r})$ 数组在网格上的最大值和最小值来确定的。然后直接计算差值 $\\Delta E_{\\mathrm{diff}} = \\Delta E_{\\mathrm{with}} - \\Delta E_{\\mathrm{no}}$。\n\n程序实现将对测试套件中提供的每个参数集遵循此逻辑。算法的核心涉及使用 `numpy` 进行矢量化操作，以便在二维网格上进行高效计算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the adsorption energy corrugation amplitude for benzene on Cu(111)\n    with and without van der Waals interactions.\n    \"\"\"\n    \n    # Each tuple contains parameters for a test case:\n    # (Nx, Ny, A0, B0, beta, alpha, z_no, z_with, C3, E0)\n    test_cases = [\n        # Case 1: General case with moderate modulation\n        (25, 25, 0.02, 1.0, 0.5, 1.5, 3.4, 3.0, 8.0, 0.0),\n        # Case 2: Boundary case with no short-range modulation (B0=0)\n        (25, 25, 0.02, 0.0, 0.5, 1.5, 3.4, 3.0, 8.0, 0.0),\n        # Case 3: Edge case with coarse grid and stronger parameters\n        (3, 3, 0.05, 2.0, 0.5, 1.8, 3.6, 2.8, 12.0, 0.0),\n        # Case 4: High lateral modulation sensitivity\n        (64, 64, 0.01, 1.5, 1.0, 1.2, 3.3, 2.7, 10.0, 0.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        Nx, Ny, A0, B0, beta, alpha, z_no, z_with, C3, E0 = case\n\n        # 1. Define Geometry and Constants\n        a0 = 3.615  # Bulk lattice parameter in Angstrom\n        a_s = a0 / np.sqrt(2.0)  # Surface lattice parameter\n\n        # Real-space primitive lattice vectors\n        a1 = a_s * np.array([1.0, 0.0])\n        a2 = a_s * np.array([0.5, np.sqrt(3.0) / 2.0])\n\n        # First star of reciprocal lattice vectors\n        G_mag = 4.0 * np.pi / (np.sqrt(3.0) * a_s)\n        G1 = G_mag * np.array([1.0, 0.0])\n        G2 = G_mag * np.array([-0.5, np.sqrt(3.0) / 2.0])\n        G3 = G_mag * np.array([-0.5, -np.sqrt(3.0) / 2.0])\n\n        # 2. Construct Computational Grid\n        # Fractional coordinates u, v in [0, 1)\n        u_vals = np.linspace(0, 1, Nx, endpoint=False)\n        v_vals = np.linspace(0, 1, Ny, endpoint=False)\n        u_grid, v_grid = np.meshgrid(u_vals, v_vals)\n\n        # Convert fractional coordinates to Cartesian coordinates r = (x, y)\n        # r(u,v) = u * a1 + v * a2\n        r_x = u_grid * a1[0] + v_grid * a2[0]\n        r_y = u_grid * a1[1] + v_grid * a2[1]\n\n        # 3. Compute Surface Corrugation Function S(r)\n        # Calculate dot products G_i . r for the entire grid\n        G1_dot_r = G1[0] * r_x + G1[1] * r_y\n        G2_dot_r = G2[0] * r_x + G2[1] * r_y\n        G3_dot_r = G3[0] * r_x + G3[1] * r_y\n        \n        S_grid = (np.cos(G1_dot_r) + np.cos(G2_dot_r) + np.cos(G3_dot_r)) / 3.0\n\n        # 4. Calculate Total Energies and Corrugation Amplitudes\n        # The total energy E(r) can be simplified as E(r) = C + F * S(r),\n        # where C is a constant offset and F is a factor.\n        # The corrugation amplitude Delta E = max(E) - min(E) is then\n        # |F| * (max(S) - min(S)).\n\n        S_range = np.max(S_grid) - np.min(S_grid)\n        \n        # Case 'no_vdW'\n        # E_no_vdW(r) = E0 + V_corr(r) + V_rep(z_no, r)\n        # The r-dependent part is (A0 + B0 * beta * exp(-alpha * z_no)) * S(r)\n        factor_no_vdw = A0 + B0 * beta * np.exp(-alpha * z_no)\n        delta_E_no = np.abs(factor_no_vdw) * S_range\n\n        # Case 'with_vdW'\n        # E_with_vdW(r) = E0 + V_corr(r) + V_rep(z_with, r) + E_vdW(z_with)\n        # The r-dependent part is (A0 + B0 * beta * exp(-alpha * z_with)) * S(r)\n        factor_with_vdw = A0 + B0 * beta * np.exp(-alpha * z_with)\n        delta_E_with = np.abs(factor_with_vdw) * S_range\n\n        # Difference in corrugation amplitudes\n        delta_E_diff = delta_E_with - delta_E_no\n\n        results.append([round(delta_E_no, 6), round(delta_E_with, 6), round(delta_E_diff, 6)])\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to string and remove spaces for compact output.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "引入范德华校正不仅仅是为了数值上的精确，它还能从根本上改变我们对化学反应性的预测。最后一个练习将范德华力与催化中的一个核心概念——Brønsted-Evans-Polanyi (BEP) 关系——联系起来 。通过模拟范德华力如何选择性地稳定反应物、产物和过渡态，你将研究这些校正如何改变反应性趋势线的斜率、截距甚至线性度，从而突显其在计算催化中的重要性。",
            "id": "4261662",
            "problem": "给定一个基于物理动机的最小模型，用于评估范德华（vdW）色散校正如何扰动计算电化学中表面反应的Brønsted-Evans-Polanyi（BEP）关系。目标是量化活化能与反应能之间的表观BEP线性关系如何随吸附物尺寸和极化率的变化而改变。\n\n从以下经过充分检验的科学基础出发：\n\n1) Brønsted-Evans-Polanyi (BEP) 关系：对于给定催化表面上的一类反应，活化势垒与反应能之间存在统计上稳健的线性相关性。在基准（无vdW）数据集中，活化能 $E_{\\mathrm{a},0}$ 和反应能 $\\Delta E_0$ 服从线性关系 $E_{\\mathrm{a},0} = a_0 \\,\\Delta E_0 + b_0$，其中斜率 $a_0$ 和截距 $b_0$ 已知。\n\n2) 可极化吸附物与导电表面之间的伦敦色散（vdW）相互作用：在非迟滞区且无阻尼复杂性的情况下，将原子-表面间的 $C_6/R^6$ 形式在连续半空间上积分，得到一个形式为 $U(z) = -C_3 / z^3$ 的吸引势，其中 $z$ 是表面-吸附物间距，$C_3$ 与吸附物静态极化率成正比。将 $C_3 = k_{C_3}\\,\\alpha$ 建模是合理的，其中 $\\alpha$ 是吸附物极化率。\n\n3) 类Hammond结构-反应性趋势：过渡态的几何结构随着驱动力 $\\Delta E_0$ 的变化，在类反应物特征和类产物特征之间平滑移动。一个简单的替代方法是使用一个敏感性参数，在初始态距离和终末态距离之间对过渡态距离进行插值。\n\n使用以下自洽且明确的模型定义和参数值：\n\n- 基准BEP参数：$a_0 = 0.50$（无量纲），$b_0 = 0.80$ eV。\n- 基准反应能集合（无 vdW）：$\\Delta E_0 \\in \\{-1.00,-0.60,-0.20,0.00,0.20,0.60,1.00\\}$ eV。\n- 对于上述每个 $\\Delta E_0$，相应的基准活化能为 $E_{\\mathrm{a},0} = a_0\\,\\Delta E_0 + b_0$ eV。\n- vdW模型常数：$k_{C_3} = 0.10$ eV·Å³ 每 Å³ 极化率，因此 $C_3 = k_{C_3}\\,\\alpha$，单位为 eV·Å³。\n- 作为吸附物尺寸 $\\sigma$（单位 Å）函数的距离模型：\n  - 初始态间距：$z_{\\mathrm{IS}} = z_{\\mathrm{base}} + c_{\\sigma}\\,\\sigma$，其中 $z_{\\mathrm{base}} = 1.80$ Å，$c_{\\sigma} = 0.20$（无量纲）。\n  - 终末态间距：$z_{\\mathrm{FS}} = z_{\\mathrm{IS}} + z_{\\mathrm{shift}}$，其中 $z_{\\mathrm{shift}} = 0.30$ Å。\n- 过渡态间距插值：\n  - 令 $\\Delta E_0^{\\min} = -1.00$ eV 和 $\\Delta E_0^{\\max} = 1.00$ eV。定义归一化驱动力 $\\mu = \\dfrac{\\Delta E_0 - (\\Delta E_0^{\\min} + \\Delta E_0^{\\max})/2}{\\Delta E_0^{\\max} - \\Delta E_0^{\\min}} \\in [-0.5, 0.5]$。\n  - 使用Hammond敏感性 $s_{\\mathrm{H}} = 0.70$（无量纲），设置 $z_{\\mathrm{TS}}(\\Delta E_0) = z_{\\mathrm{IS}} + s_{\\mathrm{H}}\\,\\mu\\,(z_{\\mathrm{FS}} - z_{\\mathrm{IS}})$，单位为 Å。\n- 距离 $z$ 处状态的vdW能量校正：$U(z) = -\\dfrac{C_3}{z^3}$ eV。\n- 每个数据点包含vdW的总能量：\n  - 反应能：$\\Delta E = \\Delta E_0 + \\left[U\\!\\left(z_{\\mathrm{FS}}\\right) - U\\!\\left(z_{\\mathrm{IS}}\\right)\\right]$ eV。\n  - 活化能：$E_{\\mathrm{a}} = E_{\\mathrm{a},0} + \\left[U\\!\\left(z_{\\mathrm{TS}}(\\Delta E_0)\\right) - U\\!\\left(z_{\\mathrm{IS}}\\right)\\right]$ eV。\n\n对于一个由尺寸 $\\sigma$（单位 Å）和极化率 $\\alpha$（单位 Å³）表征的给定吸附物，计算在指定的 $\\Delta E_0$ 值范围内的受扰动数据集 $\\{(\\Delta E, E_{\\mathrm{a}})\\}$，然后对 $E_{\\mathrm{a}}$ 与 $\\Delta E$ 进行普通最小二乘法拟合，得到最佳拟合直线 $E_{\\mathrm{a}} \\approx a\\,\\Delta E + b$。使用以下指标量化vdW对BEP关系的影响：\n\n- 斜率变化：$\\Delta a = a - a_0$（无量纲）。\n- 截距变化：$\\Delta b = b - b_0$ eV。\n- 线性拟合的均方根误差（RMSE），单位 eV：$\\mathrm{RMSE} = \\sqrt{\\dfrac{1}{N}\\sum_{i=1}^{N}\\left(E_{\\mathrm{a},i} - (a\\,\\Delta E_i + b)\\right)^2}$。\n- 决定系数：$R^2 = 1 - \\dfrac{\\sum_{i=1}^{N}\\left(E_{\\mathrm{a},i} - \\hat{E}_{\\mathrm{a},i}\\right)^2}{\\sum_{i=1}^{N}\\left(E_{\\mathrm{a},i} - \\bar{E}_{\\mathrm{a}}\\right)^2}$，其中 $\\hat{E}_{\\mathrm{a},i} = a\\,\\Delta E_i + b$，$\\bar{E}_{\\mathrm{a}}$ 是 $E_{\\mathrm{a},i}$ 的平均值。\n\n测试套件（每个案例是一对 $(\\sigma,\\alpha)$，其中 $\\sigma$ 的单位是 Å，$\\alpha$ 的单位是 Å³）：\n\n1) $(\\sigma,\\alpha) = (2.50, 0.00)$\n2) $(\\sigma,\\alpha) = (1.50, 1.00)$\n3) $(\\sigma,\\alpha) = (2.50, 5.00)$\n4) $(\\sigma,\\alpha) = (3.50, 12.00)$\n5) $(\\sigma,\\alpha) = (4.00, 0.50)$\n6) $(\\sigma,\\alpha) = (4.00, 20.00)$\n\n你的任务：\n\n- 实现一个程序，按规定为每个测试案例构建受扰动的数据集，拟合 $E_{\\mathrm{a}}$ 与 $\\Delta E$ 的线性模型，并计算指标 $\\Delta a$、$\\Delta b$、$\\mathrm{RMSE}$ 和 $R^2$。\n- 所有能量必须以 eV 为单位处理，所有距离必须以 Å 为单位处理。本问题不涉及角度。\n- 为了数值稳定性和评分的确定性，将报告的每个指标四舍五入到6位小数。\n\n最终输出格式：\n\n- 你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 对于每个测试案例，按上面列出的顺序，以 $[\\Delta a, \\Delta b, \\mathrm{RMSE}, R^2]$ 的顺序输出四个四舍五入后的浮点数。\n- 将所有测试案例的输出连接成一个扁平列表。例如，输出应类似于 $[\\Delta a_1, \\Delta b_1, \\mathrm{RMSE}_1, R^2_1, \\Delta a_2, \\Delta b_2, \\mathrm{RMSE}_2, R^2_2, \\dots]$，每个数字都四舍五入到6位小数。",
            "solution": "用户提供了一个详细、独立的计算问题，该问题基于物理化学和计算电化学的原理。任务是实现一个特定模型，以研究范德华（vdW）色散校正对表面反应的Brønsted-Evans-Polanyi（BEP）关系的影响。问题陈述经确认为具有科学依据、良定、客观且计算上可行。未检测到不一致或谬误。我现在将提供一个完整且条理清晰的解决方案。\n\n问题的核心是量化一个基于物理动机的扰动——即吸附物与表面之间的vdW相互作用——如何改变一个已建立的线性自由能关系。解决方案涉及对每个由其尺寸 $\\sigma$ 和极化率 $\\alpha$ 表征的吸附物进行一个两阶段的计算过程。\n\n首先，对于给定的吸附物，我们必须从一个基准（未受扰动）数据集生成一个新的、受vdW扰动的活化能（$E_{\\mathrm{a}}$）和反应能（$\\Delta E$）数据集。基准数据由一组反应能 $\\Delta E_0$ 和相应的活化能 $E_{\\mathrm{a},0}$ 组成，它们服从完美的线性BEP关系 $E_{\\mathrm{a},0} = a_0 \\Delta E_0 + b_0$。\n\nvdW校正被建模为一个吸引势 $U(z) = -C_3/z^3$，其中 $z$ 是吸附物-表面间距。该相互作用的强度由系数 $C_3$ 决定，它通过常数 $k_{C_3}$ 与吸附物的静态极化率 $\\alpha$ 成正比，即 $C_3 = k_{C_3} \\alpha$。\n\n初始态（IS）、终末态（FS）和过渡态（TS）的间距 $z$ 由一个几何模型定义。\n- 初始态间距 $z_{\\mathrm{IS}}$ 随吸附物尺寸 $\\sigma$ 线性增加：$z_{\\mathrm{IS}} = z_{\\mathrm{base}} + c_{\\sigma} \\sigma$。\n- 终末态间距 $z_{\\mathrm{FS}}$ 比初始态离表面远一个固定的距离：$z_{\\mathrm{FS}} = z_{\\mathrm{IS}} + z_{\\mathrm{shift}}$。\n- 过渡态间距 $z_{\\mathrm{TS}}$ 基于类Hammond原进行建模。它在类反应物（$z_{\\mathrm{IS}}$）和类产物（$z_{\\mathrm{FS}}$）的几何结构之间进行插值。过渡态沿反应坐标（由表面法向距离 $z$ 近似）的位置取决于反应的驱动力 $\\Delta E_0$。问题提供了 $z_{\\mathrm{TS}}$ 作为 $\\Delta E_0$ 函数的明确公式：\n$$z_{\\mathrm{TS}}(\\Delta E_0) = z_{\\mathrm{IS}} + s_{\\mathrm{H}}\\,\\mu\\,(z_{\\mathrm{FS}} - z_{\\mathrm{IS}})$$\n其中 $\\mu$ 是归一化的反应能，$\\mu = \\frac{\\Delta E_0 - (\\Delta E_0^{\\min} + \\Delta E_0^{\\max})/2}{\\Delta E_0^{\\max} - \\Delta E_0^{\\min}}$，$s_{\\mathrm{H}}$ 是Hammond敏感性参数。\n\n根据这些定义，任何状态（IS、TS或FS）在间距 $z$ 处的vdW能量校正为 $U(z)$。然后，通过将相关的vdW能量差加到基准能量上，计算出数据集中每个点的、受vdW扰动的总能量：\n- 受扰动的反应能为 $\\Delta E = \\Delta E_0 + [U(z_{\\mathrm{FS}}) - U(z_{\\mathrm{IS}})]$。方括号中的项是从初始态到终末态的vdW稳定化能的变化。\n- 受扰动的活化能为 $E_{\\mathrm{a}} = E_{\\mathrm{a},0} + [U(z_{\\mathrm{TS}}) - U(z_{\\mathrm{IS}})]$。方括号中的项是从初始态到过渡态的vdW稳定化能的变化。\n\n对给定集合 $\\{-1.00, -0.60, -0.20, 0.00, 0.20, 0.60, 1.00\\}$ eV 中的每个基准反应能 $\\Delta E_0$ 重复此过程，从而产生一个包含 $N=7$ 对数据的新数据集 $\\{(\\Delta E_i, E_{\\mathrm{a},i})\\}_{i=1}^N$。\n\n该过程的第二阶段是分析这个新数据集。由于活化能的vdW校正 $U(z_{\\mathrm{TS}})$ 非线性地依赖于 $\\Delta E_0$（并因此依赖于 $\\Delta E$），新数据集通常不会位于一条完美的直线上。我们执行普通最小二乘（OLS）线性回归，以找到最佳拟合直线 $E_{\\mathrm{a}} \\approx a \\Delta E + b$。OLS回归系数 $a$（斜率）和 $b$（截距）使用标准公式计算：\n$$a = \\frac{N \\sum (\\Delta E_i E_{\\mathrm{a},i}) - (\\sum \\Delta E_i)(\\sum E_{\\mathrm{a},i})}{N \\sum (\\Delta E_i^2) - (\\sum \\Delta E_i)^2}$$\n$$b = \\bar{E}_{\\mathrm{a}} - a \\bar{\\Delta E}$$\n其中 $\\bar{E}_{\\mathrm{a}}$ 和 $\\bar{\\Delta E}$ 分别是相应变量的样本均值。\n\n最后，我们计算四个指标来量化vdW校正对给定吸附物的BEP关系的影响：\n1.  斜率变化：$\\Delta a = a - a_0$。\n2.  截距变化：$\\Delta b = b - b_0$。\n3.  拟合的均方根误差（RMSE）：该指标衡量数据点与拟合直线的典型偏差。\n    $$\\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left(E_{\\mathrm{a},i} - (a\\Delta E_i + b)\\right)^2}$$\n4.  决定系数（$R^2$）：该指标衡量因变量（$E_{\\mathrm{a}}$）的方差中可由自变量（$\\Delta E$）预测的比例。\n    $$R^2 = 1 - \\frac{\\sum_{i=1}^{N}(E_{\\mathrm{a},i} - \\hat{E}_{\\mathrm{a},i})^2}{\\sum_{i=1}^{N}(E_{\\mathrm{a},i} - \\bar{E}_{\\mathrm{a}})^2}$$\n    其中 $\\hat{E}_{\\mathrm{a},i} = a\\Delta E_i + b$ 是线性模型的预测值。\n\n对测试套件中指定的每个 $(\\sigma, \\alpha)$ 对执行这整个过程，并收集得到的四个指标，按要求进行格式化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes vdW-perturbed BEP metrics for a series of adsorbates.\n    \"\"\"\n\n    # --- Problem Constants and Definitions ---\n    # Baseline BEP parameters\n    A0 = 0.50  # dimensionless\n    B0 = 0.80  # eV\n\n    # Baseline reaction-energy set (no vdW)\n    DELTA_E0_SET = np.array([-1.00, -0.60, -0.20, 0.00, 0.20, 0.60, 1.00])  # eV\n\n    # vdW model constant\n    K_C3 = 0.10  # eV*A^3 / A^3 of polarizability\n\n    # Distance model constants\n    Z_BASE = 1.80  # Angstrom\n    C_SIGMA = 0.20  # dimensionless\n    Z_SHIFT = 0.30  # Angstrom\n\n    # Transition-state interpolation constants\n    DELTA_E0_MIN = -1.00  # eV\n    DELTA_E0_MAX = 1.00  # eV\n    S_H = 0.70  # Hammond sensitivity, dimensionless\n    \n    # Test suite: list of (sigma in Angstrom, alpha in Angstrom^3)\n    test_cases = [\n        (2.50, 0.00),\n        (1.50, 1.00),\n        (2.50, 5.00),\n        (3.50, 12.00),\n        (4.00, 0.50),\n        (4.00, 20.00),\n    ]\n\n    all_results = []\n\n    for sigma, alpha in test_cases:\n        # --- Stage 1: Generate vdW-perturbed dataset ---\n        \n        # Calculate adsorbate-specific parameters\n        c3 = K_C3 * alpha\n        z_is = Z_BASE + C_SIGMA * sigma\n        z_fs = z_is + Z_SHIFT\n\n        # Calculate vdW energy corrections for IS and FS\n        # Handle c3=0 case to avoid division by zero if z=0 (not possible here, but good practice)\n        u_is = -c3 / z_is**3 if c3 != 0 else 0.0\n        u_fs = -c3 / z_fs**3 if c3 != 0 else 0.0\n        \n        # Calculate vdW correction to reaction energy (constant for all points in a case)\n        delta_u_rxn = u_fs - u_is\n\n        # Perturbed reaction energies\n        delta_e_perturbed = DELTA_E0_SET + delta_u_rxn\n\n        # Calculate perturbed activation energies for each point\n        e_a_perturbed = []\n        for dE0 in DELTA_E0_SET:\n            # Baseline activation energy\n            e_a0 = A0 * dE0 + B0\n\n            # Normalized driving force\n            mu_numerator = dE0 - (DELTA_E0_MIN + DELTA_E0_MAX) / 2\n            mu_denominator = DELTA_E0_MAX - DELTA_E0_MIN\n            mu = mu_numerator / mu_denominator\n            \n            # Transition-state separation\n            z_ts = z_is + S_H * mu * (z_fs - z_is)\n\n            # vdW energy correction for TS\n            u_ts = -c3 / z_ts**3 if c3 != 0 else 0.0\n\n            # vdW correction to activation energy\n            delta_u_act = u_ts - u_is\n\n            # Total perturbed activation energy\n            e_a_perturbed.append(e_a0 + delta_u_act)\n\n        e_a_perturbed = np.array(e_a_perturbed)\n\n        # --- Stage 2: Linear Regression and Metrics ---\n\n        if alpha == 0.0:\n            # For alpha=0, c3=0, all corrections are zero.\n            # The fit is perfect and identical to the baseline.\n            a_fit, b_fit = A0, B0\n            rmse, r2 = 0.0, 1.0\n        else:\n            x_data = delta_e_perturbed\n            y_data = e_a_perturbed\n            n = len(x_data)\n\n            # OLS linear regression: y = a*x + b\n            sum_x, sum_y = np.sum(x_data), np.sum(y_data)\n            sum_xy, sum_x2 = np.sum(x_data * y_data), np.sum(x_data**2)\n\n            a_fit = (n * sum_xy - sum_x * sum_y) / (n * sum_x2 - sum_x**2)\n            b_fit = (sum_y - a_fit * sum_x) / n\n\n            # Calculate metrics\n            y_pred = a_fit * x_data + b_fit\n            residuals = y_data - y_pred\n            \n            rmse = np.sqrt(np.mean(residuals**2))\n            \n            ss_res = np.sum(residuals**2)\n            ss_tot = np.sum((y_data - np.mean(y_data))**2)\n            \n            # Handle case where all y values are the same to avoid division by zero\n            r2 = 1.0 - (ss_res / ss_tot) if ss_tot > 0 else 1.0\n\n        # Calculate change from baseline\n        delta_a = a_fit - A0\n        delta_b = b_fit - B0\n\n        # Append results for this case, rounded to 6 decimal places\n        all_results.extend([delta_a, delta_b, rmse, r2])\n\n    # --- Final Output Formatting ---\n    # Use format specifier to ensure 6 decimal places, e.g., 1.0 -> 1.000000\n    formatted_results = [f\"{x:.6f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}