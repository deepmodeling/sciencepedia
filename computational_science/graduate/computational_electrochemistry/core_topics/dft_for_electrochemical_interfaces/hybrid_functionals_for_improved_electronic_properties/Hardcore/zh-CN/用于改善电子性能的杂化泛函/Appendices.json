{
    "hands_on_practices": [
        {
            "introduction": "标准密度泛函（DFT）泛函的一个关键缺陷是自相互作用误差，在处理非整数电子数的体系时，这一问题尤为突出。精确泛函的总能量在整数电子数之间应为分段线性的，但诸如PBE之类的近似泛函却错误地呈现出凸性曲率。通过本练习 ()，您将利用一个简化的能量模型来量化这种“离域误差”，从而深入理解引入混合泛函的必要性。",
            "id": "4247837",
            "problem": "您必须编写一个完整且可运行的程序，该程序使用两种密度泛函近似：Perdew–Burke–Ernzerhof (PBE) 广义梯度近似和 PBE0 杂化泛函，通过计算总能量相对于分子离子的分数电子占据数的凸性，来量化离域误差。其物理基础是在密度泛函理论 (DFT) 中，精确的基态总能量相对于电子数是分段线性的。对于一个具有整数电子数 $N$ 和一个分数电子 $f \\in [0,1]$ 的系统，其精确总能量由整数电子能量之间的线性插值给出，因此精确的 $E(N+f)$ 在 $E(N)$ 和 $E(N+1)$ 之间呈线性变化。像 Perdew–Burke–Ernzerhof (PBE) 这样的半局域泛函通常表现出向上弯曲（凸性），导致离域误差，而像 PBE0 这样的杂化泛函通过混合一部分非局域的 Hartree–Fock 交换来减少这种凸性。\n\n将分数占据数 $f$ 的近似总能量用以下函数建模：\n$$\nE_{\\text{approx}}(f; E_N, E_{N+1}, \\kappa) \\equiv E_N + f\\left(E_{N+1} - E_N\\right) - \\frac{1}{2}\\,\\kappa\\,f\\left(1-f\\right),\n$$\n其中 $E_N$ 和 $E_{N+1}$ 分别是具有 $N$ 和 $N+1$ 个电子的系统的整数电子总能量，单位为电子伏特 (eV)，而 $\\kappa$ (单位为 eV) 是一个参数，用于参数化由近似泛函引起的曲率。正值的 $\\kappa$ 产生凸的能量曲线（相对于线性参考向下弯曲），这是离域误差的特征；负值的 $\\kappa$ 产生凹性（向上弯曲），与过度局域化相关。\n\n您的程序必须：\n- 使用在 $f=0.5$ 处、步长为 $\\Delta f = 0.25$ 的离散二阶差分来估计曲率（能量凸性），\n$$\nC \\approx \\frac{E(0.5+\\Delta f) - 2E(0.5) + E(0.5-\\Delta f)}{(\\Delta f)^2},\n$$\n其中 $E(f)$ 表示在 $f$ 处求值的 $E_{\\text{approx}}(f; E_N, E_{N+1}, \\kappa)$，并且 $C$ 必须以 eV 为单位报告。\n- 计算在 $f=0.5$ 处相对于精确分段线性能量的中点偏差，\n$$\n\\Delta_{\\text{mid}} \\equiv E(0.5) - \\left[E_N + 0.5\\left(E_{N+1} - E_N\\right)\\right],\n$$\n单位为 eV。\n- 计算在 $f \\in [0,1]$ 上的积分偏差，\n$$\n\\Delta_{\\text{int}} \\equiv \\int_0^1 \\left[E(f) - \\left(E_N + f\\left(E_{N+1} - E_N\\right)\\right)\\right]\\,df,\n$$\n单位为 eV，使用具有 1000 个均匀分段的网格的数值梯形法则。\n\n对于每种情况，还需通过一个布尔标志报告能量曲线在 $C > 0$ 的意义上是否是凸的。\n\n单位：所有能量和曲率值必须以电子伏特 (eV) 表示。布尔标志必须是字面布尔值。不涉及角度。不涉及百分比。\n\n测试套件：\n为以下参数集提供结果，每个参数集描述一种分子离子情景：\n1. 情况 A (理想路径)：$E_N = -100.000$ eV, $E_{N+1} = -101.500$ eV, $\\kappa_{\\text{PBE}} = 0.60$ eV, $\\kappa_{\\text{PBE0}} = 0.20$ eV。\n2. 情况 B (边界，近线性杂化)：$E_N = -250.000$ eV, $E_{N+1} = -251.200$ eV, $\\kappa_{\\text{PBE}} = 0.10$ eV, $\\kappa_{\\text{PBE0}} = 0.00$ eV。\n3. 情况 C (边缘，杂化泛函导致轻微过度局域化)：$E_N = -400.000$ eV, $E_{N+1} = -402.500$ eV, $\\kappa_{\\text{PBE}} = 0.20$ eV, $\\kappa_{\\text{PBE0}} = -0.02$ eV。\n\n要求输出：\n对于每个测试用例，生成一个子列表\n$$\n\\left[C_{\\text{PBE}},\\,C_{\\text{PBE0}},\\,\\text{is\\_convex\\_PBE},\\,\\text{is\\_convex\\_PBE0},\\,\\Delta_{\\text{mid,PBE}},\\,\\Delta_{\\text{mid,PBE0}},\\,\\Delta_{\\text{int,PBE}},\\,\\Delta_{\\text{int,PBE0}}\\right],\n$$\n其中 $C_{\\text{PBE}}$ 和 $C_{\\text{PBE0}}$ 是以 eV 为单位的曲率估计值，$\\text{is\\_convex\\_PBE}$ 和 $\\text{is\\_convex\\_PBE0}$ 是布尔值，而 $\\Delta_{\\text{mid,*}}$, $\\Delta_{\\text{int,*}}$ 是以 eV 为单位的偏差。您的程序应该生成单行输出，包含这些子列表组成的逗号分隔列表，并用方括号括起来，不含空格，例如，\n$$\n\\left[\\left[\\cdots\\right],\\left[\\cdots\\right],\\left[\\cdots\\right]\\right].\n$$",
            "solution": "该问题被评估为**有效**。它在科学上基于密度泛函理论 (DFT) 的原理，特别是关于近似交换相关泛函在处理具有分数电子数的系统时的行为。该问题是适定的，提供了所有必要的参数、定义和方程，可以得出一个唯一的、确定性的解。语言是客观的，任务在计算上是可行的。\n\n支撑该问题的物理化学原理是精确基态总能量 $E$ 作为电子数 $N$ 的函数所具有的分段线性性质。对于一个具有非整数电子数 $N+f$ 的系统，其中 $N$ 是整数，$f \\in [0,1]$ 是分数部分，其精确能量是整数电子系统能量之间的线性插值：\n$$\nE_{\\text{exact}}(N+f) = (1-f)E(N) + fE(N+1) = E(N) + f(E(N+1) - E(N))\n$$\n许多常见的近似密度泛函，特别是像 Perdew–Burke–Ernzerhof (PBE) 泛函这样的半局域泛函，违反了这一条件。它们通常表现出一种虚假的凸曲率（向下弯曲），这会导致离域误差。这种误差导致对分数电荷物种的过度稳定化，从而导致对电荷转移、反应势垒和带隙等性质的错误预测。像 PBE0 这样的杂化泛函，它们包含一部分非局域的 Hartree-Fock 交换，已知可以显著减少这种凸性，得到更接近精确理论线的结果。\n\n该问题为这种近似能量行为提供了一个模型：\n$$\nE_{\\text{approx}}(f; E_N, E_{N+1}, \\kappa) \\equiv E_N + f\\left(E_{N+1} - E_N\\right) - \\frac{1}{2}\\,\\kappa\\,f\\left(1-f\\right)\n$$\n此处，$E_N$ 和 $E_{N+1}$ 是整数电子系统的能量，$f$ 是分数占据数。项 $E_N + f(E_{N+1} - E_N)$ 代表精确的线性行为，我们可以将其表示为 $E_{\\text{linear}}(f)$。对线性的偏离由抛物线项 $\\delta E(f) = -\\frac{1}{2}\\kappa f(1-f)$ 捕获，其中 $\\kappa$ 是量化曲率的参数。正值的 $\\kappa$ 对应于凸的能量曲线（向下偏离，离域误差），而负值的 $\\kappa$ 表示凹的曲线（向上偏离，过度局域化误差）。\n\n我们的任务是计算三个度量指标，以量化由 PBE 和 PBE0 这两种泛函引起的偏差，这两种泛函由它们各自的曲率参数 $\\kappa_{\\text{PBE}}$ 和 $\\kappa_{\\text{PBE0}}$ 表征。\n\n1.  **曲率, $C$**: 曲率将使用在 $f=0.5$ 处、步长为 $\\Delta f = 0.25$ 的中心有限差分近似来估计二阶导数：\n    $$\n    C \\approx \\frac{E(0.5+\\Delta f) - 2E(0.5) + E(0.5-\\Delta f)}{(\\Delta f)^2} = \\frac{E(0.75) - 2E(0.5) + E(0.25)}{(0.25)^2}\n    $$\n    让我们将 $E_{\\text{approx}}(f)$ 的模型表达式代入分子。线性部分 $E_{\\text{linear}}(f)$ 是关于 $f$ 的一阶多项式，其二阶有限差分恒为零。因此，计算仅取决于非线性偏差项 $\\delta E(f) = -\\frac{1}{2}\\kappa f(1-f)$。\n    分子变为：\n    $$\n    \\delta E(0.75) - 2\\delta E(0.5) + \\delta E(0.25)\n    $$\n    $$\n    = \\left(-\\frac{\\kappa}{2}(0.75)(0.25)\\right) - 2\\left(-\\frac{\\kappa}{2}(0.5)(0.5)\\right) + \\left(-\\frac{\\kappa}{2}(0.25)(0.75)\\right)\n    $$\n    $$\n    = -\\frac{\\kappa}{2} \\left[ (0.1875) - 2(0.25) + (0.1875) \\right] = -\\frac{\\kappa}{2} \\left[ 0.375 - 0.5 \\right] = -\\frac{\\kappa}{2} (-0.125) = \\frac{\\kappa}{16}\n    $$\n    分母是 $(\\Delta f)^2 = (0.25)^2 = (1/4)^2 = 1/16$。\n    因此，曲率估计值为：\n    $$\n    C = \\frac{\\kappa/16}{1/16} = \\kappa\n    $$\n    这是一个精确结果，因为二阶导数的中心差分公式对于阶数不超过3的任何多项式都是精确的。我们的偏差项是二次的。因此，计算出的曲率 $C$ 就是输入参数 $\\kappa$。凸性标志 `is_convex` 在 $C > 0$ 时为 `True`，否则为 `False`。\n\n2.  **中点偏差, $\\Delta_{\\text{mid}}$**: 该度量是在中点 $f=0.5$ 处，近似能量与精确线性能量的偏差。\n    $$\n    \\Delta_{\\text{mid}} \\equiv E(0.5) - \\left[E_N + 0.5\\left(E_{N+1} - E_N\\right)\\right] = E_{\\text{approx}}(0.5) - E_{\\text{linear}}(0.5) = \\delta E(0.5)\n    $$\n    将 $f=0.5$ 代入偏差表达式 $\\delta E(f)$：\n    $$\n    \\Delta_{\\text{mid}} = -\\frac{1}{2}\\,\\kappa\\,(0.5)\\left(1-0.5\\right) = -\\frac{1}{2}\\,\\kappa\\,(0.25) = -\\frac{\\kappa}{8}\n    $$\n    这也是一个只依赖于 $\\kappa$ 的精确解析结果。\n\n3.  **积分偏差, $\\Delta_{\\text{int}}$**: 该度量是在整个分数电子范围 $f \\in [0,1]$ 上对总偏差进行积分。\n    $$\n    \\Delta_{\\text{int}} \\equiv \\int_0^1 \\left[E(f) - E_{\\text{linear}}(f)\\right]\\,df = \\int_0^1 \\delta E(f)\\,df\n    $$\n    $$\n    \\Delta_{\\text{int}} = \\int_0^1 \\left(-\\frac{1}{2}\\kappa f(1-f)\\right)\\,df = -\\frac{\\kappa}{2} \\int_0^1 (f-f^2)\\,df\n    $$\n    该积分可以解析求解：\n    $$\n    -\\frac{\\kappa}{2} \\left[ \\frac{f^2}{2} - \\frac{f^3}{3} \\right]_0^1 = -\\frac{\\kappa}{2} \\left( \\frac{1}{2} - \\frac{1}{3} \\right) = -\\frac{\\kappa}{2} \\left( \\frac{1}{6} \\right) = -\\frac{\\kappa}{12}\n    $$\n    尽管存在精确的解析解，但问题要求使用具有 $N_{\\text{seg}} = 1000$ 个均匀分段的数值梯形法则。将会实现这种数值方法。我们将为 $f$ 定义一个从 0 到 1，包含 $N_{\\text{seg}} + 1 = 1001$ 个点的网格，在这些点上计算被积函数 $\\delta E(f)$，然后使用一个数值积分例程 (`numpy.trapz`) 来计算积分。这个结果应该非常接近于解析值 $-\\kappa/12$。\n\n实现将包含一个函数，该函数以 $\\kappa$ 作为输入，并计算三个度量指标（$C$、$\\Delta_{\\text{mid}}$、$\\Delta_{\\text{int}}$）和凸性标志。对于每个测试用例，将为 $\\kappa_{\\text{PBE}}$ 和 $\\kappa_{\\text{PBE0}}$ 调用此函数。结果将被组装成指定的列表的列表格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes DFT delocalization error metrics for PBE and PBE0 functionals.\n    \"\"\"\n\n    # Test cases: (E_N, E_N+1, kappa_PBE, kappa_PBE0)\n    test_cases = [\n        # Case A: happy path\n        (-100.000, -101.500, 0.60, 0.20),\n        # Case B: boundary, near-linear hybrid\n        (-250.000, -251.200, 0.10, 0.00),\n        # Case C: edge, slight over-localization with hybrid\n        (-400.000, -402.500, 0.20, -0.02),\n    ]\n\n    def calculate_metrics(kappa):\n        \"\"\"\n        Calculates delocalization error metrics for a given kappa.\n\n        Args:\n            kappa (float): The curvature parameter in eV.\n\n        Returns:\n            tuple: A tuple containing (C, is_convex, delta_mid, delta_int).\n        \"\"\"\n        \n        # 1. Curvature (C)\n        # The energy model is E = E_linear - 0.5*kappa*f*(1-f).\n        # The second derivative of a quadratic polynomial ax^2 + bx + c is 2a.\n        # Here, the term is 0.5*kappa*f^2 - 0.5*kappa*f.\n        # The second derivative w.r.t. f is d^2/df^2 (0.5*kappa*f^2) = kappa.\n        # The finite difference formula given is exact for polynomials of degree = 3,\n        # so C = kappa.\n        curvature = kappa\n\n        # 2. Convexity flag\n        is_convex = curvature > 0\n\n        # 3. Midpoint Deviation (Delta_mid)\n        # Delta_mid is the deviation from linearity at f = 0.5.\n        # delta_E(f) = -0.5 * kappa * f * (1 - f)\n        # delta_E(0.5) = -0.5 * kappa * 0.5 * 0.5 = -0.125 * kappa = -kappa / 8\n        delta_mid = -kappa / 8.0\n\n        # 4. Integral Deviation (Delta_int)\n        # Per the problem, this must be computed numerically.\n        # The integrand is delta_E(f) = -0.5 * kappa * f * (1 - f).\n        # The analytical integral is -kappa/12.\n        num_segments = 1000\n        # Create a grid of f values from 0.0 to 1.0 with 1001 points (1000 segments)\n        f_grid = np.linspace(0.0, 1.0, num_segments + 1)\n        \n        # Evaluate the integrand on the grid\n        integrand = -0.5 * kappa * f_grid * (1.0 - f_grid)\n        \n        # Compute the integral using the trapezoidal rule\n        delta_int = np.trapz(integrand, f_grid)\n        \n        return curvature, is_convex, delta_mid, delta_int\n\n    results_all_cases = []\n    for case in test_cases:\n        e_n, e_n_plus_1, kappa_pbe, kappa_pbe0 = case\n        \n        # Calculate metrics for PBE\n        c_pbe, is_convex_pbe, delta_mid_pbe, delta_int_pbe = calculate_metrics(kappa_pbe)\n        \n        # Calculate metrics for PBE0\n        c_pbe0, is_convex_pbe0, delta_mid_pbe0, delta_int_pbe0 = calculate_metrics(kappa_pbe0)\n        \n        # Assemble sublist for the current case\n        sublist = [\n            c_pbe, c_pbe0,\n            is_convex_pbe, is_convex_pbe0,\n            delta_mid_pbe, delta_mid_pbe0,\n            delta_int_pbe, delta_int_pbe0\n        ]\n        results_all_cases.append(sublist)\n        \n    # Format the final output string to match the required format:\n    # [[...],[...],[...]] with no spaces.\n    # str() converts the list of lists correctly, including booleans.\n    # .replace(' ', '') removes all spaces.\n    output_string = str(results_all_cases).replace(' ', '')\n    \n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "离域误差会产生深远的影响，其中最典型的表现就是“带隙问题”——标准DFT计算得到的半导体和绝缘体带隙通常远小于实验值。这种差异的根源在于近似泛函未能描述交换相关势的“导数不连续性”($\\Delta_{xc}$)。在此练习 () 中，您将通过计算区分 Kohn-Sham 带隙与物理上更为真实的“基本带隙”，并理解像PBE0和HSE这样的混合泛函是如何通过部分修正 $\\Delta_{xc}$ 来缓解带隙问题的。",
            "id": "4247845",
            "problem": "给定一个中性体半导体及其在密度泛函理论 (DFT) 中使用三种交换相关方法计算出的带电态的数据：使用 Perdew–Burke–Ernzerhof (PBE) 的广义梯度近似 (GGA)、全局杂化 Perdew–Burke–Ernzerhof 泛函 (PBE0) 以及屏蔽杂化 Heyd–Scuseria–Ernzerhof (HSE) 方法。目标是为每种泛函计算 Kohn–Sham (KS) 带隙和基本带隙（电离势与电子亲和能之差），然后估算交换相关 (XC) 导数不连续性。所有能量都是针对代表该体半导体的周期性重复晶胞计算的，并且已通过针对带电态的补偿背景电荷进行收敛，这是计算电化学中的标准做法。\n\n使用以下基本定义作为起点：\n- Kohn–Sham 带隙定义为 $E_{\\text{g}}^{\\text{KS}} = \\varepsilon_{\\text{LUMO}} - \\varepsilon_{\\text{HOMO}}$，其中 $\\varepsilon_{\\text{HOMO}}$ 和 $\\varepsilon_{\\text{LUMO}}$ 分别是最高占据和最低未占据的 Kohn–Sham 本征值。\n- 电离势为 $I = E(N-1) - E(N)$，其中 $E(N)$ 是中性体系的总能量，$E(N-1)$ 是移除一个电子后的总能量。\n- 电子亲和能为 $A = E(N) - E(N+1)$，其中 $E(N+1)$ 是添加一个电子后的总能量。\n- 基本带隙为 $E_{\\text{g}}^{\\text{fund}} = I - A$。等效地，$E_{\\text{g}}^{\\text{fund}} = E(N+1) + E(N-1) - 2E(N)$。\n- 交换相关导数不连续性为 $\\Delta_{\\text{xc}} = E_{\\text{g}}^{\\text{fund}} - E_{\\text{g}}^{\\text{KS}}$。\n\n所有量都必须以电子伏特 (eV) 为单位计算。您的程序必须为每种泛函计算三元组 $\\left[E_{\\text{g}}^{\\text{KS}}, E_{\\text{g}}^{\\text{fund}}, \\Delta_{\\text{xc}}\\right]$，并以四舍五入到三位小数的形式报告。本问题不涉及角度。\n\n测试集参数值（每行对应一种泛函；本征值和总能量均以 eV 为单位）：\n- Perdew–Burke–Ernzerhof (PBE):\n  - $\\varepsilon_{\\text{HOMO}} = -5.20$, $\\varepsilon_{\\text{LUMO}} = -4.40$,\n  - $E(N) = -250.000$, $E(N-1) = -244.500$, $E(N+1) = -254.000$.\n- Perdew–Burke–Ernzerhof hybrid functional (PBE0):\n  - $\\varepsilon_{\\text{HOMO}} = -6.10$, $\\varepsilon_{\\text{LUMO}} = -4.85$,\n  - $E(N) = -260.000$, $E(N-1) = -253.800$, $E(N+1) = -264.550$.\n- Heyd–Scuseria–Ernzerhof (HSE):\n  - $\\varepsilon_{\\text{HOMO}} = -5.80$, $\\varepsilon_{\\text{LUMO}} = -4.70$,\n  - $E(N) = -255.000$, $E(N-1) = -249.100$, $E(N+1) = -259.400$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果；每个元素代表一种泛函的结果，以内部列表的形式按 PBE、PBE0、HSE 的顺序排列，其中每个内部列表为 $\\left[E_{\\text{g}}^{\\text{KS}}, E_{\\text{g}}^{\\text{fund}}, \\Delta_{\\text{xc}}\\right]$，单位为 eV，四舍五入到三位小数。例如，输出格式应类似于 $\\left[\\left[x_1,y_1,z_1\\right],\\left[x_2,y_2,z_2\\right],\\left[x_3,y_3,z_3\\right]\\right]$，其中 $x_i, y_i, z_i$ 为数值。",
            "solution": "问题陈述已经过分析并根据所需标准进行了验证。它具有科学依据、问题明确、客观且内部一致。计算所需的所有数据和定义均已提供。因此，该问题被认为是有效的，下面给出了完整的解决方案。\n\n此问题要求使用来自三种不同密度泛函理论 (DFT) 交换相关 (XC) 泛函的数据，计算半导体的三个关键电子结构量：Perdew–Burke–Ernzerhof (PBE) 的广义梯度近似 (GGA)、全局杂化 PBE0 以及屏蔽杂化 Heyd–Scuseria–Ernzerhof (HSE)。待确定的量是 Kohn–Sham (KS) 带隙 ($E_{\\text{g}}^{\\text{KS}}$)、基本带隙 ($E_{\\text{g}}^{\\text{fund}}$) 和 XC 导数不连续性 ($\\Delta_{\\text{xc}}$)。\n\n首先，我们为每个量定义并解释其基本原理。\n\n**1. Kohn–Sham 带隙 ($E_{\\text{g}}^{\\text{KS}}$)**\n\nKohn–Sham 带隙是虚构的非相互作用 Kohn–Sham 系统中最低未占分子轨道 (LUMO) 和最高占据分子轨道 (HOMO) 之间的能量差。在固态物理学中，它们分别对应于导带底 (CBM) 和价带顶 (VBM)。其定义如下：\n$$E_{\\text{g}}^{\\text{KS}} = \\varepsilon_{\\text{LUMO}} - \\varepsilon_{\\text{HOMO}}$$\n其中 $\\varepsilon_{\\text{LUMO}}$ 和 $\\varepsilon_{\\text{HOMO}}$ 分别是相应状态的 KS 本征值。虽然 $E_{\\text{g}}^{\\text{KS}}$ 在计算上成本低廉，但它在形式上并不等同于实验带隙。对于像 LDA 和 GGA 这样的近似泛函，它系统性地低估了真实带隙。\n\n**2. 基本带隙 ($E_{\\text{g}}^{\\text{fund}}$)**\n\n基本带隙是相互作用的多电子系统的真实物理带隙。它被严格定义为系统电离势 ($I$) 和其电子亲和能 ($A$) 之间的差值：\n$$E_{\\text{g}}^{\\text{fund}} = I - A$$\n电离势是从 N 电子体系中移除一个电子所需的最小能量，电子亲和能是添加一个电子时释放的能量。使用总能量 ($E$)，它们通过有限差分计算得出：\n$$I = E(N-1) - E(N)$$\n$$A = E(N) - E(N+1)$$\n其中 $E(N)$、$E(N-1)$ 和 $E(N+1)$ 分别是具有 $N$、$N-1$ 和 $N+1$ 个电子的系统的基态总能量。将这些代入基本带隙的定义，得到用于计算的表达式：\n$$E_{\\text{g}}^{\\text{fund}} = (E(N-1) - E(N)) - (E(N) - E(N+1)) = E(N+1) + E(N-1) - 2E(N)$$\n这个量代表产生一个分离良好的电子-空穴对的能量成本，是应该与通过光电子能谱法测量的实验带隙进行比较的值。\n\n**3. 交换相关导数不连续性 ($\\Delta_{\\text{xc}}$)**\n\n基本带隙与 Kohn–Sham 带隙之间的差异源于精确 XC 泛函的一个微妙性质。当电子数穿过一个整数时，精确的 XC 势 $v_{\\text{xc}}(r)$ 会经历一个空间上恒定的不连续性（一个向上的跳跃）。这个跳跃就是导数不连续性 $\\Delta_{\\text{xc}}$。其定义如下：\n$$\\Delta_{\\text{xc}} = E_{\\text{g}}^{\\text{fund}} - E_{\\text{g}}^{\\text{KS}}$$\n标准的局域和半局域泛函（LDA、GGA）是电子密度的连续函数，因此其导数不连续性为零或接近于零。这是 DFT 中臭名昭著的“带隙问题”的主要原因之一。杂化泛函，其包含一部分来自 Hartree–Fock 理论的非局域精确交换，部分地捕捉到了这种不连续性，从而改善了 $E_{\\text{g}}^{\\text{KS}}$，使其更接近 $E_{\\text{g}}^{\\text{fund}}$。\n\n现在，我们将这些公式应用于为每个泛函提供的数据。所有能量单位均为电子伏特 (eV)。\n\n**情况 1: Perdew–Burke–Ernzerhof (PBE)**\n\n- 给定数据:\n  - $\\varepsilon_{\\text{HOMO}} = -5.20$ eV\n  - $\\varepsilon_{\\text{LUMO}} = -4.40$ eV\n  - $E(N) = -250.000$ eV\n  - $E(N-1) = -244.500$ eV\n  - $E(N+1) = -254.000$ eV\n\n- 计算:\n  - $E_{\\text{g}}^{\\text{KS}} = \\varepsilon_{\\text{LUMO}} - \\varepsilon_{\\text{HOMO}} = (-4.40) - (-5.20) = 0.800$ eV\n  - $E_{\\text{g}}^{\\text{fund}} = E(N+1) + E(N-1) - 2E(N) = (-254.000) + (-244.500) - 2(-250.000) = -498.500 + 500.000 = 1.500$ eV\n  - $\\Delta_{\\text{xc}} = E_{\\text{g}}^{\\text{fund}} - E_{\\text{g}}^{\\text{KS}} = 1.500 - 0.800 = 0.700$ eV\n\n- PBE 的结果: $[0.800, 1.500, 0.700]$\n\n**情况 2: Perdew–Burke–Ernzerhof hybrid functional (PBE0)**\n\n- 给定数据:\n  - $\\varepsilon_{\\text{HOMO}} = -6.10$ eV\n  - $\\varepsilon_{\\text{LUMO}} = -4.85$ eV\n  - $E(N) = -260.000$ eV\n  - $E(N-1) = -253.800$ eV\n  - $E(N+1) = -264.550$ eV\n\n- 计算:\n  - $E_{\\text{g}}^{\\text{KS}} = \\varepsilon_{\\text{LUMO}} - \\varepsilon_{\\text{HOMO}} = (-4.85) - (-6.10) = 1.250$ eV\n  - $E_{\\text{g}}^{\\text{fund}} = E(N+1) + E(N-1) - 2E(N) = (-264.550) + (-253.800) - 2(-260.000) = -518.350 + 520.000 = 1.650$ eV\n  - $\\Delta_{\\text{xc}} = E_{\\text{g}}^{\\text{fund}} - E_{\\text{g}}^{\\text{KS}} = 1.650 - 1.250 = 0.400$ eV\n\n- PBE0 的结果: $[1.250, 1.650, 0.400]$\n\n**情况 3: Heyd–Scuseria–Ernzerhof (HSE)**\n\n- 给定数据:\n  - $\\varepsilon_{\\text{HOMO}} = -5.80$ eV\n  - $\\varepsilon_{\\text{LUMO}} = -4.70$ eV\n  - $E(N) = -255.000$ eV\n  - $E(N-1) = -249.100$ eV\n  - $E(N+1) = -259.400$ eV\n\n- 计算:\n  - $E_{\\text{g}}^{\\text{KS}} = \\varepsilon_{\\text{LUMO}} - \\varepsilon_{\\text{HOMO}} = (-4.70) - (-5.80) = 1.100$ eV\n  - $E_{\\text{g}}^{\\text{fund}} = E(N+1) + E(N-1) - 2E(N) = (-259.400) + (-249.100) - 2(-255.000) = -508.500 + 510.000 = 1.500$ eV\n  - $\\Delta_{\\text{xc}} = E_{\\text{g}}^{\\text{fund}} - E_{\\text{g}}^{\\text{KS}} = 1.500 - 1.100 = 0.400$ eV\n\n- HSE 的结果: $[1.100, 1.500, 0.400]$\n\n这些结果说明了这些泛函的典型行为。GGA 泛函 (PBE) 的 KS 带隙远小于其基本带隙，导致一个很大的表观 $\\Delta_{\\text{xc}}$。杂化泛函 (PBE0 和 HSE) 增大了 KS 带隙，使其更接近基本带隙，从而减小了泛函未能捕捉到的导数不连续性。请注意，基本带隙本身也随泛函的不同而略有变化，因为它取决于总能量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n# No external libraries are needed for this calculation.\n\ndef solve():\n    \"\"\"\n    Calculates the Kohn-Sham gap, fundamental gap, and XC derivative\n    discontinuity for a semiconductor using data from PBE, PBE0, and HSE\n    functionals.\n    \"\"\"\n    # Define the test cases from the problem statement. Each dictionary\n    # contains the necessary energy values for one functional.\n    test_cases = [\n        {\n            \"name\": \"PBE\",\n            \"e_homo\": -5.20,\n            \"e_lumo\": -4.40,\n            \"e_n\": -250.000,\n            \"e_n_minus_1\": -244.500,\n            \"e_n_plus_1\": -254.000,\n        },\n        {\n            \"name\": \"PBE0\",\n            \"e_homo\": -6.10,\n            \"e_lumo\": -4.85,\n            \"e_n\": -260.000,\n            \"e_n_minus_1\": -253.800,\n            \"e_n_plus_1\": -264.550,\n        },\n        {\n            \"name\": \"HSE\",\n            \"e_homo\": -5.80,\n            \"e_lumo\": -4.70,\n            \"e_n\": -255.000,\n            \"e_n_minus_1\": -249.100,\n            \"e_n_plus_1\": -259.400,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract values for the current functional\n        e_homo = case[\"e_homo\"]\n        e_lumo = case[\"e_lumo\"]\n        e_n = case[\"e_n\"]\n        e_n_minus_1 = case[\"e_n_minus_1\"]\n        e_n_plus_1 = case[\"e_n_plus_1\"]\n\n        # 1. Calculate the Kohn-Sham gap (E_g^KS)\n        # E_g^KS = e_LUMO - e_HOMO\n        e_g_ks = e_lumo - e_homo\n\n        # 2. Calculate the fundamental gap (E_g^fund)\n        # E_g^fund = E(N+1) + E(N-1) - 2*E(N)\n        e_g_fund = e_n_plus_1 + e_n_minus_1 - 2 * e_n\n\n        # 3. Calculate the XC derivative discontinuity (Delta_xc)\n        # Delta_xc = E_g^fund - E_g^KS\n        delta_xc = e_g_fund - e_g_ks\n\n        # Store the triplet of results, rounded to three decimal places\n        # as per the problem specification.\n        result_triplet = [\n            round(e_g_ks, 3),\n            round(e_g_fund, 3),\n            round(delta_xc, 3),\n        ]\n        all_results.append(result_triplet)\n\n    # The required output format is a compact string representation of a list of\n    # lists, with no spaces. Example: [[x1,y1,z1],[x2,y2,z2],...].\n    # Converting the list to a string and removing spaces achieves this format.\n    output_string = str(all_results).replace(\" \", \"\")\n\n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "将基本原理应用于实际问题，正确描述电荷的局域化行为在电化学领域至关重要，尤其是在氧化物电极表面，载流子常以“小极化子”的形式存在。极化子的形成与否，取决于晶格弛豫的能量收益与电子离域趋势之间的微妙平衡，而标准GGA泛函的自相互作用误差会错误地高估离域趋势。本练习 () 将通过一个双中心模型，清晰地展示混合泛函如何通过纠正离域误差，准确捕捉电荷从离域到局域的转变，进而为计算电荷输运的活化能提供可靠基础。",
            "id": "4248014",
            "problem": "考虑一个用于描述二氧化钛（$\\text{TiO}_2$）表面小极化子的简化但有科学依据的模型，该模型建立在密度泛函理论（DFT）所使用的电子结构近似框架内。构建此模型的目的是量化杂化泛函——即那些将一部分 Hartree–Fock (HF) 交换与广义梯度近似 (GGA) 混合的泛函——对电子局域化和电荷输运激活能垒的影响。目标是，仅使用不预设目标结果的原理，推导并以编程方式实现对一个非局域化误差度量及其对双位点表面基元上极化子跳跃影响的评估。\n\n将使用的基本原理：\n- 精确的 DFT 理论表明，总能量是整数之间电子数 $n$ 的分段线性函数，这意味着对于一个附加电子的分数占据 $f \\in [0,1]$，精确能量 $E_{\\text{exact}}(f)$ 是 $f$ 的线性函数。\n- 近似泛函（如 GGA）中的自相互作用误差会在 $E(f)$ 中引入凸曲率，从而人为地稳定了非局域化的分数占据。包含比例为 $\\alpha$ 的 Hartree–Fock 交换的杂化泛函可以减轻这种曲率，使 $E(f)$ 趋向于分段线性。\n- 经典的 Marcus 电子转移理论指出，对于等价位点之间的对称电子转移，当反应自由能 $\\Delta G$ 为零时，激活能垒 $\\Delta G^{\\ddagger}$ 等于重组能 $\\lambda$ 的四分之一，即 $\\Delta G^{\\ddagger} = \\lambda/4$。\n\n需要实现的模型定义：\n1. 设由自相互作用误差引起的分段线性偏差由一个能量曲率项 $C(\\alpha)$ 建模，其参数化形式为\n$$\nC(\\alpha) = -c_0(1 - \\alpha),\n$$\n其中 $c_0 > 0$ 是一个以电子伏特 (eV) 为单位的曲率标度，$\\alpha \\in [0,1]$ 是杂化泛函中 Hartree–Fock 交换的比例，负号表示当 $\\alpha = 0$（纯 GGA）时具有凸性（在分数占据时能量降低）。\n2. 对于单个位点上的分数占据 $f$，近似能量写作\n$$\nE(f) = E_{\\text{lin}} + C(\\alpha) f(1 - f),\n$$\n其中 $E_{\\text{lin}}$ 是与精确 DFT 一致的线性基线。定义一个非局域化误差度量，用于量化 $E(f)$ 与线性基线之间的面积，并用一个整数电荷能量标度 $\\Delta$（单位为 eV）进行归一化：\n$$\nD(\\alpha) = \\frac{\\int_0^1 \\left| E(f) - E_{\\text{lin}} \\right| \\, df}{\\Delta} = \\frac{|C(\\alpha)|}{6 \\Delta}.\n$$\n此 $D(\\alpha)$ 是无量纲的。\n3. 对于一个占据数为 $n_1$ 和 $n_2$ 且满足 $n_1 + n_2 = 1$ 的双位点对称表面基元，将自相互作用误差的曲率贡献与一个有利于整数占据的晶格-极化子稳定化标度 $L > 0$（单位为 eV）结合起来。沿电荷重分布坐标 $n_1 \\in [0,1]$ 的有效双位点能量模型为\n$$\nE_{\\text{2-site}}(n_1;\\alpha) = E_0 + K(\\alpha) \\, n_1(1 - n_1),\n$$\n其系数为\n$$\nK(\\alpha) = 2\\left[ L + C(\\alpha) \\right] = 2\\left[ L - c_0(1 - \\alpha) \\right].\n$$\n4. 电荷输运激活能垒是在 $n_1 = 1/2$ 处的能量最大值与 $n_1 \\in \\{0,1\\}$ 处的能量最小值之间的差值，前提是存在局域极小值。因此，\n$$\n\\Delta G^{\\ddagger}(\\alpha) = \n\\begin{cases}\n\\frac{K(\\alpha)}{4},  \\text{若 } K(\\alpha) > 0, \\\\\n0,  \\text{若 } K(\\alpha) \\le 0,\n\\end{cases}\n$$\n单位为电子伏特 (eV)。这与对称转移的 $\\Delta G^{\\ddagger} = \\lambda/4$ 一致，当存在局域态时，可认为 $\\lambda = K(\\alpha)$。\n5. 作为一种局域化度量，计算逆参与率 (IPR)，对于双位点系统定义为 ${\\rm IPR} = n_1^2 + n_2^2$。在能量最低点，\n$$\n{\\rm IPR}(\\alpha) =\n\\begin{cases}\n1,  \\text{若 } K(\\alpha) > 0 \\text{ 且 } n_1^* \\in \\{0,1\\}, \\\\\n\\frac{1}{2},  \\text{若 } K(\\alpha) \\le 0 \\text{ 且 } n_1^* = \\frac{1}{2}.\n\\end{cases}\n$$\n此值为无量纲。\n\n任务：\n- 实现一个程序，为每个测试用例计算 $D(\\alpha)$（无量纲）、${\\rm IPR}(\\alpha)$（无量纲）和 $\\Delta G^{\\ddagger}(\\alpha)$（单位为电子伏特 eV）。所有能量必须以 eV 表示。不涉及角度。\n- 使用以下参数集 $(\\alpha, L, c_0, \\Delta)$ 的测试套件：\n    - 测试 1：$\\alpha = 0.0$， $L = 0.30$ eV， $c_0 = 0.40$ eV， $\\Delta = 1.0$ eV。\n    - 测试 2：$\\alpha = 0.25$， $L = 0.30$ eV， $c_0 = 0.40$ eV， $\\Delta = 1.0$ eV。\n    - 测试 3：$\\alpha = 0.50$， $L = 0.30$ eV， $c_0 = 0.40$ eV， $\\Delta = 1.0$ eV。\n    - 测试 4：$\\alpha = 0.75$， $L = 0.30$ eV， $c_0 = 0.40$ eV， $\\Delta = 1.0$ eV。\n    - 测试 5：$\\alpha = 1.00$， $L = 0.30$ eV， $c_0 = 0.40$ eV， $\\Delta = 1.0$ eV。\n    - 边界测试 6：$\\alpha = 0.50$， $L = 0.20$ eV， $c_0 = 0.40$ eV， $\\Delta = 0.50$ eV。\n    - 边界测试 7：$\\alpha = 0.60$， $L = 0.25$ eV， $c_0 = 0.40$ eV， $\\Delta = 0.80$ eV。\n- 对于每个测试用例，输出一个包含 $[D(\\alpha), {\\rm IPR}(\\alpha), \\Delta G^{\\ddagger}(\\alpha)]$ 的列表，其中前两个值是无量纲的，最后一个值的单位是 eV。将所有测试用例的结果汇总到单行中。您的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表，每个测试用例表示为其自己的方括号列表，例如 $[[d_1,{\\rm ipr}_1,g_1],[d_2,{\\rm ipr}_2,g_2],\\dots]$。",
            "solution": "该问题陈述经过严格验证，被认为是一个有效的、自洽的、且具有科学依据的问题。它提出了一个简化但连贯的物理模型，用于描述表面上的电子局域化和输运，其根植于密度泛函理论（DFT）和 Marcus 理论的既定原理。所有定义在数学上都是精确的，并且为测试用例提供了所有必要的参数。因此，有必要提供完整的解决方案。\n\n任务是为一系列参数集 $(\\alpha, L, c_0, \\Delta)$ 计算三个量：非局域化误差度量 $D(\\alpha)$、逆参与率 ${\\rm IPR}(\\alpha)$ 和电荷输运激活能垒 $\\Delta G^{\\ddagger}(\\alpha)$。解决方案通过系统地应用所提供的模型定义来逐步进行。\n\n该模型的核心是两种相反效应之间的竞争：\n1.  **晶格-极化子稳定化**，由能量标度 $L > 0$ 量化。该项表示局域电荷周围晶格弛豫所获得的能量增益，这有利于位点上的整数占据（$n_1 \\in \\{0, 1\\}$）。\n2.  **自相互作用误差 (SIE)**，这是 GGA 等近似 DFT 泛函所固有的。这种误差人为地降低了非局域态的能量，从而有利于分数占据（$n_1 = 1/2$）。该效应的强度由曲率项 $C(\\alpha) = -c_0(1 - \\alpha)$ 控制，随着精确 Hartree-Fock 交换比例 $\\alpha$ 的增加，该项的负值减小（即对非局域化的偏好减弱）。\n\n双位点系统的整体行为由有效系数 $K(\\alpha)$ 决定，该系数结合了这两种效应。\n\n每个测试用例的计算过程如下：\n\n**步骤 1：计算有效曲率系数 $K(\\alpha)$**\n\n决定系统基态（局域态 vs. 非局域态）的核心量是 $K(\\alpha)$。其定义为：\n$$\nK(\\alpha) = 2 \\left[ L + C(\\alpha) \\right]\n$$\n代入 $C(\\alpha) = -c_0(1 - \\alpha)$ 的定义：\n$$\nK(\\alpha) = 2 \\left[ L - c_0(1 - \\alpha) \\right]\n$$\n$K(\\alpha)$ 的符号决定了双位点能量势 $E_{\\text{2-site}}(n_1;\\alpha) = E_0 + K(\\alpha) \\, n_1(1 - n_1)$ 的形状。如果 $K(\\alpha) > 0$，势能在 $n_1=1/2$ 处有最大值，导致在 $n_1=0$ 和 $n_1=1$ 处有两个极小值，对应于局域化的电子。如果 $K(\\alpha) \\le 0$，势能在 $n_1=1/2$ 处有单个极小值，对应于非局域化的电子。\n\n**步骤 2：确定逆参与率 ${\\rm IPR}(\\alpha)$**\n\nIPR 是局域化的度量。其值直接由 $K(\\alpha)$ 的符号根据所给定义确定：\n$$\n{\\rm IPR}(\\alpha) =\n\\begin{cases}\n1,  \\text{若 } K(\\alpha) > 0 \\quad (\\text{局域态}) \\\\\n\\frac{1}{2},  \\text{若 } K(\\alpha) \\le 0 \\quad (\\text{非局域态})\n\\end{cases}\n$$\nIPR 为 $1$ 对应于电子完全位于一个位点上（$n_1^2 + n_2^2 = 1^2 + 0^2 = 1$），而 IPR 为 $1/2$ 对应于电子均等共享（$n_1^2 + n_2^2 = (1/2)^2 + (1/2)^2 = 1/2$）。\n\n**步骤 3：计算激活能垒 $\\Delta G^{\\ddagger}(\\alpha)$**\n\n电子在位点间跳跃的激活能垒是潜在的非局域过渡态（$n_1=1/2$）与局域基态（$n_1 \\in \\{0,1\\}$）之间的能量差。这个能垒仅在基态是局域态时才存在。\n$$\n\\Delta G^{\\ddagger}(\\alpha) = \n\\begin{cases}\n\\frac{K(\\alpha)}{4},  \\text{若 } K(\\alpha) > 0 \\\\\n0,  \\text{若 } K(\\alpha) \\le 0\n\\end{cases}\n$$\n如果基态已经是非局域态（$K(\\alpha) \\le 0$），则不存在跳跃能垒，$\\Delta G^{\\ddagger}(\\alpha) = 0$。\n\n**步骤 4：计算非局域化误差度量 $D(\\alpha)$**\n\n该度量量化了单位点能量模型中与分段线性的偏差。它与双位点参数 ($L$) 无关，仅取决于 $\\alpha$、$c_0$ 和归一化因子 $\\Delta$。\n$$\nD(\\alpha) = \\frac{|C(\\alpha)|}{6 \\Delta} = \\frac{|-c_0(1 - \\alpha)|}{6 \\Delta}\n$$\n由于 $c_0 > 0$ 且 $\\alpha \\in [0, 1]$，$c_0(1 - \\alpha)$ 项总是非负的。因此，绝对值是多余的：\n$$\nD(\\alpha) = \\frac{c_0(1 - \\alpha)}{6 \\Delta}\n$$\n\n**应用于测试用例：**\n\n我们将这个四步程序应用于每组参数 $(\\alpha, L, c_0, \\Delta)$。\n\n- **测试 1:** $(\\alpha=0.0, L=0.30, c_0=0.40, \\Delta=1.0)$\n    1.  $K(0.0) = 2 [0.30 - 0.40(1 - 0.0)] = 2 [0.30 - 0.40] = 2(-0.10) = -0.20$ eV。\n    2.  由于 $K(0.0)  0$，${\\rm IPR}(0.0) = 1/2 = 0.5$。\n    3.  由于 $K(0.0) \\le 0$，$\\Delta G^{\\ddagger}(0.0) = 0$ eV。\n    4.  $D(0.0) = \\frac{0.40(1 - 0.0)}{6 \\times 1.0} = \\frac{0.40}{6} \\approx 0.06667$。\n\n- **测试 2:** $(\\alpha=0.25, L=0.30, c_0=0.40, \\Delta=1.0)$\n    1.  $K(0.25) = 2 [0.30 - 0.40(1 - 0.25)] = 2 [0.30 - 0.40(0.75)] = 2[0.30 - 0.30] = 0$ eV。\n    2.  由于 $K(0.25) = 0$，${\\rm IPR}(0.25) = 1/2 = 0.5$。\n    3.  由于 $K(0.25) = 0$，$\\Delta G^{\\ddagger}(0.25) = 0$ eV。\n    4.  $D(0.25) = \\frac{0.40(1 - 0.25)}{6 \\times 1.0} = \\frac{0.30}{6} = 0.05$。\n\n- **测试 3:** $(\\alpha=0.50, L=0.30, c_0=0.40, \\Delta=1.0)$\n    1.  $K(0.50) = 2 [0.30 - 0.40(1 - 0.50)] = 2 [0.30 - 0.40(0.50)] = 2[0.30 - 0.20] = 2(0.10) = 0.20$ eV。\n    2.  由于 $K(0.50)  0$，${\\rm IPR}(0.50) = 1$。\n    3.  由于 $K(0.50)  0$，$\\Delta G^{\\ddagger}(0.50) = K(0.50)/4 = 0.20/4 = 0.05$ eV。\n    4.  $D(0.50) = \\frac{0.40(1 - 0.50)}{6 \\times 1.0} = \\frac{0.20}{6} \\approx 0.03333$。\n\n- **测试 4:** $(\\alpha=0.75, L=0.30, c_0=0.40, \\Delta=1.0)$\n    1.  $K(0.75) = 2 [0.30 - 0.40(1 - 0.75)] = 2 [0.30 - 0.40(0.25)] = 2[0.30 - 0.10] = 2(0.20) = 0.40$ eV。\n    2.  由于 $K(0.75)  0$，${\\rm IPR}(0.75) = 1$。\n    3.  由于 $K(0.75)  0$，$\\Delta G^{\\ddagger}(0.75) = K(0.75)/4 = 0.40/4 = 0.10$ eV。\n    4.  $D(0.75) = \\frac{0.40(1 - 0.75)}{6 \\times 1.0} = \\frac{0.10}{6} \\approx 0.01667$。\n\n- **测试 5:** $(\\alpha=1.00, L=0.30, c_0=0.40, \\Delta=1.0)$\n    1.  $K(1.00) = 2 [0.30 - 0.40(1 - 1.00)] = 2 [0.30 - 0] = 2(0.30) = 0.60$ eV。\n    2.  由于 $K(1.00)  0$，${\\rm IPR}(1.00) = 1$。\n    3.  由于 $K(1.00)  0$，$\\Delta G^{\\ddagger}(1.00) = K(1.00)/4 = 0.60/4 = 0.15$ eV。\n    4.  $D(1.00) = \\frac{0.40(1 - 1.00)}{6 \\times 1.0} = 0$。\n\n- **边界测试 6:** $(\\alpha=0.50, L=0.20, c_0=0.40, \\Delta=0.50)$\n    1.  $K(0.50) = 2 [0.20 - 0.40(1 - 0.50)] = 2 [0.20 - 0.20] = 0$ eV。\n    2.  由于 $K(0.50) = 0$，${\\rm IPR}(0.50) = 1/2 = 0.5$。\n    3.  由于 $K(0.50) = 0$，$\\Delta G^{\\ddagger}(0.50) = 0$ eV。\n    4.  $D(0.50) = \\frac{0.40(1 - 0.50)}{6 \\times 0.50} = \\frac{0.20}{3.0} \\approx 0.06667$。\n\n- **边界测试 7:** $(\\alpha=0.60, L=0.25, c_0=0.40, \\Delta=0.80)$\n    1.  $K(0.60) = 2 [0.25 - 0.40(1 - 0.60)] = 2 [0.25 - 0.40(0.40)] = 2[0.25 - 0.16] = 2(0.09) = 0.18$ eV。\n    2.  由于 $K(0.60)  0$，${\\rm IPR}(0.60) = 1$。\n    3.  由于 $K(0.60)  0$，$\\Delta G^{\\ddagger}(0.60) = K(0.60)/4 = 0.18/4 = 0.045$ eV。\n    4.  $D(0.60) = \\frac{0.40(1 - 0.60)}{6 \\times 0.80} = \\frac{0.16}{4.8} = \\frac{1}{30} \\approx 0.03333$。\n\n这些计算以编程方式实现，以生成最终输出。计算序列演示了增加精确交换的比例 $\\alpha$ 如何抵消自相互作用误差，从而减小非局域化误差 $D(\\alpha)$，并促进从非局域态（${\\rm IPR} = 1/2$, $\\Delta G^{\\ddagger} = 0$）向具有有限跳跃能垒的局域态（${\\rm IPR} = 1$, $\\Delta G^{\\ddagger}  0$）的转变。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n# No external libraries are needed for this calculation.\n\ndef solve():\n    \"\"\"\n    Computes a delocalization error metric, IPR, and activation barrier\n    for a model of small polarons based on a series of test parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (alpha, L, c0, delta)\n    test_cases = [\n        # Test 1: alpha = 0.0, L = 0.30 eV, c0 = 0.40 eV, delta = 1.0 eV.\n        (0.0, 0.30, 0.40, 1.0),\n        # Test 2: alpha = 0.25, L = 0.30 eV, c0 = 0.40 eV, delta = 1.0 eV.\n        (0.25, 0.30, 0.40, 1.0),\n        # Test 3: alpha = 0.50, L = 0.30 eV, c0 = 0.40 eV, delta = 1.0 eV.\n        (0.50, 0.30, 0.40, 1.0),\n        # Test 4: alpha = 0.75, L = 0.30 eV, c0 = 0.40 eV, delta = 1.0 eV.\n        (0.75, 0.30, 0.40, 1.0),\n        # Test 5: alpha = 1.00, L = 0.30 eV, c0 = 0.40 eV, delta = 1.0 eV.\n        (1.00, 0.30, 0.40, 1.0),\n        # Edge 6: alpha = 0.50, L = 0.20 eV, c0 = 0.40 eV, delta = 0.50 eV.\n        (0.50, 0.20, 0.40, 0.50),\n        # Edge 7: alpha = 0.60, L = 0.25 eV, c0 = 0.40 eV, delta = 0.80 eV.\n        (0.60, 0.25, 0.40, 0.80),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, L, c0, delta = case\n\n        # 1. Calculate the energy curvature term C(alpha)\n        # C(alpha) = -c0 * (1 - alpha)\n        # This term is not explicitly needed, but is part of K(alpha)\n\n        # 2. Calculate the delocalization error metric D(alpha)\n        # D(alpha) = |C(alpha)| / (6 * delta) = c0 * (1 - alpha) / (6 * delta)\n        D_alpha = (c0 * (1.0 - alpha)) / (6.0 * delta)\n\n        # 3. Calculate the effective two-site coefficient K(alpha)\n        # K(alpha) = 2 * (L - c0 * (1 - alpha))\n        K_alpha = 2.0 * (L - c0 * (1.0 - alpha))\n\n        # 4. Determine IPR(alpha) and the activation barrier Delta_G(alpha)\n        # The values depend on the sign of K(alpha)\n        if K_alpha  0:\n            # Localized state: minima at n1=0,1\n            # IPR = 1^2 + 0^2 = 1\n            IPR_alpha = 1.0\n            # Activation barrier is the energy difference between n1=1/2 and n1=0\n            # Delta_G = E(1/2) - E(0) = (E0 + K/4) - E0 = K/4\n            G_barrier = K_alpha / 4.0\n        else: # K_alpha = 0\n            # Delocalized state: minimum at n1=1/2\n            # IPR = (1/2)^2 + (1/2)^2 = 1/2\n            IPR_alpha = 0.5\n            # No barrier to hopping from the ground state\n            G_barrier = 0.0\n\n        results.append([D_alpha, IPR_alpha, G_barrier])\n\n    # Format the final output string as specified: [[d1,ipr1,g1],[d2,ipr2,g2],...]\n    # Create a list of strings, where each string is a formatted sub-list.\n    sub_results_str = [f\"[{d},{ipr},{g}]\" for d, ipr, g in results]\n    \n    # Join the sub-list strings with commas and enclose in brackets.\n    final_output_str = f\"[{','.join(sub_results_str)}]\"\n\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}