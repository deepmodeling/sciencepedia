{
    "hands_on_practices": [
        {
            "introduction": "在许多电化学应用中，例如神经探针或传感器阵列，微电极的几何布局至关重要。一个关键的设计挑战是最小化相邻电极之间的电串扰，以确保它们能够独立工作。本练习将指导您通过应用一次电流分布的基本原理，为微电极阵列的设计推导出一个实用的准则。您将学习如何利用叠加原理和解析近似，将复杂的物理问题转化为一个简洁的工程设计公式，而无需构建复杂的数值模拟。",
            "id": "4255402",
            "problem": "考虑一个由相同圆形微电极组成的阵列，其半径为 $a$，平嵌于一个绝缘平面内。该平面界定了一个半无限、均匀的电解质，其电导率为 $\\sigma$。每个电极都保持着相对于远场电解质电势的均匀电势 $V_0$，并且电解质是静止的，没有传质限制。假设电导率均匀且电极动力学可忽略，因此一次电流分布适用。电解质中的电势场满足拉普拉斯方程，并在绝缘平面和电极表面上具有适当的边界条件。\n\n仅使用基本定律和经过充分检验的公式作为出发点。具体而言，将以下内容视为已知条件：(i) 电解质电势的控制方程是拉普拉斯方程；(ii) 问题是线性的，因此叠加原理适用；(iii) 在半无限电解质表面上的一点注入局部法向电流 $I$ 所产生的远场表面电势，沿平面在距离 $r$ 处衰减为 $V(r) = I / \\left(2 \\pi \\sigma r\\right)$；以及 (iv) 半无限导体表面上半径为 $a$ 的圆盘接触的扩展电阻为 $R_{\\mathrm{spread}} = \\left(4 \\sigma a\\right)^{-1}$，因此对于保持在电势 $V_0$ 的孤立圆盘，其总电流为 $I_{\\mathrm{iso}} = 4 \\sigma a V_0$。请勿使用非由这些事实推导出的任何捷径公式。\n\n对于存在相邻电极情况下的一个电极，定义无量纲重叠参数 $\\eta$，其值为所有其他电极在目标电极中心产生的电势贡献总和与该电极施加的电势 $V_0$ 之比。设相邻电极的中心与目标电极中心的距离为 $\\{r_i\\}$，为构建一个保守的独立性准则，假设每个相邻电极承载的电流均为孤立电极电流 $I_{\\mathrm{iso}}$。设中心间距为 $s$，纯几何的无量纲距离为 $d_i$，使得 $r_i = s d_i$。\n\n您的任务是从所述的基本依据出发，推导出一个确保 $\\eta \\le \\varepsilon$ 的最小间距 $s_{\\min}$ 的准则，其中 $\\varepsilon$ 是为可接受重叠指定的微小无量纲容差。该准则必须用 $a$、$\\varepsilon$ 和集合 $\\{d_i\\}$ 来表示，并且必须对任何有限的相邻电极集合有效。然后，在一个程序中实现该准则，为几个指定的测试用例计算 $s_{\\min}$。\n\n所有最终间距值均以米为单位表示，并四舍五入到6位有效数字。角度单位不适用。程序必须生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n\n使用以下测试套件，其中每个测试用例由元组 $(a_{\\mu \\mathrm{m}}, \\varepsilon, \\{d_i\\})$ 指定，$a_{\\mu \\mathrm{m}}$ 的单位是微米，$\\{d_i\\}$ 是无量纲相邻距离的列表：\n\n- 案例1（一对电极）：$(5, 0.05, [1])$。\n- 案例2（三个共线电极，评估中间电极）：$(10, 0.01, [1, 1])$。\n- 案例3（$3 \\times 3$方形簇，评估中心电极，仅考虑最近邻和对角邻居）：$(20, 0.02, [1, 1, 1, 1, \\sqrt{2}, \\sqrt{2}, \\sqrt{2}, \\sqrt{2}])$。\n- 案例4（孤立电极，无邻居）：$(10, 0.01, [])$。\n- 案例5（具有严格准则的一对电极）：$(5, 0.001, [1])$。\n\n您的程序应生成单行输出，其中包含与上述测试用例顺序相同的、用方括号括起来的逗号分隔列表，例如 $[s_1,s_2,s_3,s_4,s_5]$，其中每个 $s_k$ 是计算出的 $s_{\\min}$（以米为单位），并四舍五入到6位有效数字。",
            "solution": "在稳态条件下，当没有电极动力学或浓度梯度时，均匀电解质中的一次电流分布由电解质电势 $V(\\mathbf{x})$ 的拉普拉斯方程控制，\n$$\n\\nabla^2 V = 0,\n$$\n并具有适当的边界条件：绝缘平面强制法向电流为零（诺伊曼边界条件），每个电极表面强制电势固定（狄利克雷边界条件）。在这些假设下，线性和叠加原理适用于电势场及其源。\n\n来自接触理论和地电理论的一个经典且经过充分检验的结果是，在半无限均匀导体表面上，距离局部法向电流注入点 $I$ 为 $r$ 处的表面电势为\n$$\nV(r) = \\frac{I}{2 \\pi \\sigma r}。\n$$\n此外，半无限导体表面上半径为 $a$ 的圆盘接触的扩展电阻为\n$$\nR_{\\mathrm{spread}} = \\frac{1}{4 \\sigma a}，\n$$\n这意味着一个相对于远场保持在电势 $V_0$ 的孤立圆盘所承载的总电流为\n$$\nI_{\\mathrm{iso}} = \\frac{V_0}{R_{\\mathrm{spread}}} = 4 \\sigma a V_0。\n$$\n\n现在，我们通过界定由相邻电极在给定电极中心引起的扰动来构建一个保守的独立性准则。考虑一个有限的相邻电极集合，其与目标电极中心的距离为 $\\{r_i\\}$。为建立独立性准则，假设每个相邻电极承载的电流为 $I_{\\mathrm{iso}}$（当电极相互作用时，这会高估耦合效应，因此是保守的）。相邻电极 $i$ 在目标电极中心贡献的电势近似为\n$$\nV_i = \\frac{I_{\\mathrm{iso}}}{2 \\pi \\sigma r_i}。\n$$\n根据叠加原理，所有相邻电极在中心产生的总扰动电势为\n$$\nV_{\\mathrm{sum}} = \\sum_i V_i = \\sum_i \\frac{I_{\\mathrm{iso}}}{2 \\pi \\sigma r_i} = \\frac{I_{\\mathrm{iso}}}{2 \\pi \\sigma} \\sum_i \\frac{1}{r_i}。\n$$\n\n将无量纲重叠参数 $\\eta$ 定义为相邻电极感应的电势与电极驱动电势 $V_0$ 之比，\n$$\n\\eta \\equiv \\frac{V_{\\mathrm{sum}}}{V_0} = \\frac{I_{\\mathrm{iso}}}{2 \\pi \\sigma V_0} \\sum_i \\frac{1}{r_i}。\n$$\n使用 $I_{\\mathrm{iso}} = 4 \\sigma a V_0$，上式可简化为\n$$\n\\eta = \\frac{4 \\sigma a V_0}{2 \\pi \\sigma V_0} \\sum_i \\frac{1}{r_i} = \\frac{2 a}{\\pi} \\sum_i \\frac{1}{r_i}。\n$$\n\n引入中心间距 $s$ 并记 $r_i = s d_i$，其中 $d_i$ 是仅由几何排列决定的无量纲距离（例如，对于方形晶格上的最近邻，$d_i = 1$；对于对角邻居，$d_i = \\sqrt{2}$，依此类推）。那么\n$$\n\\eta = \\frac{2 a}{\\pi} \\sum_i \\frac{1}{s d_i} = \\frac{2 a}{\\pi s} \\sum_i \\frac{1}{d_i}。\n$$\n为强制执行独立性准则 $\\eta \\le \\varepsilon$，我们要求\n$$\n\\frac{2 a}{\\pi s} \\sum_i \\frac{1}{d_i} \\le \\varepsilon,\n$$\n由此得出最小间距\n$$\ns_{\\min} = \\frac{2 a}{\\pi \\varepsilon} \\sum_i \\frac{1}{d_i}。\n$$\n此公式仅取决于电极半径 $a$、重叠容差 $\\varepsilon$ 以及关于相邻距离的无量纲几何和；电解质电导率 $\\sigma$ 和施加的电势 $V_0$ 因为定义 $\\eta$ 的比值关系而被消去。\n\n算法设计：\n- 对于每个测试用例，将半径 $a$ 从微米转换为米。\n- 对给定的列表 $\\{d_i\\}$ 计算几何和 $S_d = \\sum_i 1/d_i$。\n- 计算 $s_{\\min} = \\left(2 a\\right) \\left(\\pi \\varepsilon\\right)^{-1} S_d$。\n- 四舍五入到6位有效数字，并以米为单位，在单个逗号分隔的列表中输出值，并用方括号括起来。\n\n覆盖范围考虑：\n- 案例1（一对电极）：$\\{d_i\\} = [1]$ 得到 $S_d = 1$，测试基本的双电极场景。\n- 案例2（三个共线电极）：$\\{d_i\\} = [1, 1]$ 得到 $S_d = 2$，相对于案例1，效应加倍。\n- 案例3（$3 \\times 3$方形簇中心，带最近邻和对角邻居）：$\\{d_i\\} = [1, 1, 1, 1, \\sqrt{2}, \\sqrt{2}, \\sqrt{2}, \\sqrt{2}]$ 得到 $S_d = 4 + 4 / \\sqrt{2}$，测试多个邻居的情况。\n- 案例4（孤立电极）：空的邻居列表得到 $S_d = 0$，从而得出 $s_{\\min} = 0$，这是一个边界情况。\n- 案例5（严格容差）：与案例1具有相同的几何结构但 $\\varepsilon$ 更小，测试对 $\\varepsilon$ 的敏感度。\n\n所有输出均以米为单位，并按要求四舍五入到6位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef s_min(a_m, epsilon, d_list):\n    \"\"\"\n    Compute minimum spacing s_min in meters:\n    s_min = (2 * a) / (pi * epsilon) * sum(1/d_i)\n    \"\"\"\n    if epsilon == 0:\n        # For non-positive epsilon, independence cannot be satisfied meaningfully.\n        # Return np.inf to indicate undefined/infinite spacing; but problem does not include such case.\n        return np.inf\n    if len(d_list) == 0:\n        return 0.0\n    Sd = np.sum([1.0 / di for di in d_list])\n    return (2.0 * a_m / (np.pi * epsilon)) * Sd\n\ndef format_sigfigs(x, sig=6):\n    \"\"\"\n    Format a float to a given number of significant figures.\n    Uses general format to avoid unnecessary scientific notation for moderate magnitudes.\n    \"\"\"\n    if not np.isfinite(x):\n        return \"inf\"\n    # Use format with significant figures ('g') and ensure at least one decimal point for clarity\n    s = f\"{x:.{sig}g}\"\n    # If integer-like, ensure decimal representation to avoid ambiguity\n    if \"e\" not in s and \".\" not in s:\n        s = s + \".0\"\n    return s\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (a in micrometers, epsilon, list of dimensionless neighbor distances d_i)\n    sqrt2 = float(np.sqrt(2.0))\n    test_cases = [\n        (5.0, 0.05, [1.0]),                                          # Case 1\n        (10.0, 0.01, [1.0, 1.0]),                                    # Case 2\n        (20.0, 0.02, [1.0, 1.0, 1.0, 1.0, sqrt2, sqrt2, sqrt2, sqrt2]),  # Case 3\n        (10.0, 0.01, []),                                            # Case 4\n        (5.0, 0.001, [1.0]),                                         # Case 5\n    ]\n\n    results = []\n    for a_um, epsilon, d_list in test_cases:\n        a_m = a_um * 1e-6  # convert micrometers to meters\n        s = s_min(a_m, epsilon, d_list)\n        results.append(format_sigfigs(s, sig=6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当电化学池的几何形状变得复杂时，解析解通常不再适用，我们必须依赖数值方法。本练习将带您进入计算电化学的核心，通过实践构建一个二维数值求解器来模拟一次电流分布。您将实现一个等效于电阻器网络的有限差分格式来求解拉普拉斯方程，更重要的是，您将学习如何通过与精确解进行比较来验证您代码的正确性，并量化其收敛阶数，这是确保任何数值模拟可靠性的关键步骤。",
            "id": "4255445",
            "problem": "要求您严格比较在矩形域上建模的电解质中一次电流分布的电阻网络离散化与连续介质解。一次电流分布假设界面动力学和浓度变化可忽略不计，因此电解质电势场由拉普拉斯方程控制。从电荷守恒和欧姆定律的基本原理出发，推导控制偏微分方程（PDE）和电阻网络离散方程，然后量化并验证截断误差随网格间距的标度关系。\n\n数学和物理设置：\n- 控制偏微分方程（一次分布的拉普拉斯方程）：电解质电势 $\\phi(x,y)$ 满足\n$$\n\\nabla^2 \\phi \\equiv \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} = 0\n$$\n在一个矩形区域 $\\Omega = \\{(x,y)\\,|\\, 0 \\le x \\le L_x,\\, 0 \\le y \\le L_y\\}$ 内。\n- 边界条件（狄利克雷）：规定\n$$\n\\phi(x,0) = 0,\\quad \\phi(x,L_y) = \\sin\\!\\big(\\pi\\, x/L_x\\big),\\quad \\phi(0,y)=0,\\quad \\phi(L_x,y)=0,\n$$\n其中角度以弧度为单位，电势以伏特（V）为单位。这些边界条件代表顶部电极保持正弦电势，而其他边界保持零电势。\n- 解析解：通过分离变量法，连续介质解为\n$$\n\\phi_{\\text{exact}}(x,y) = \\sin\\!\\big(\\pi\\, x/L_x\\big)\\,\\frac{\\sinh\\!\\big(\\pi\\, y/L_x\\big)}{\\sinh\\!\\big(\\pi\\, L_y/L_x\\big)}.\n$$\n\n离散电阻网络模型：\n- 使用一个包含边界的 $N_x \\times N_y$ 个节点的矩形网格对域进行离散化，网格间距为 $h_x = L_x/(N_x-1)$ 和 $h_y = L_y/(N_y-1)$。\n- 内部节点满足一个由基尔霍夫电流定律和欧姆定律推导出的节点平衡方程（等效于拉普拉斯算子的五点有限差分近似）：\n$$\n\\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{h_x^2} \\;+\\; \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{h_y^2} \\;=\\; 0,\n$$\n其中狄利克雷边界节点由边界条件固定。该离散方程与一个电阻网络节点方程相同，其电导在 $x$ 和 $y$ 方向上分别与 $1/h_x^2$ 和 $1/h_y^2$ 成正比。\n\n截断误差分析：\n- 使用在 $(x_i,y_j)$ 点的泰勒展开，表明将离散算子应用于精确解会产生局部截断误差\n$$\n\\tau_{i,j} \\;=\\; \\frac{h_x^2}{12}\\,\\frac{\\partial^4 \\phi}{\\partial x^4}(x_i,y_j) \\;+\\; \\frac{h_y^2}{12}\\,\\frac{\\partial^4 \\phi}{\\partial y^4}(x_i,y_j) \\;+\\; \\mathcal{O}\\!\\big(h_x^4 + h_y^4\\big).\n$$\n因此，该格式在空间上是二阶精确的，并且在合适的范数下的全局误差预计将以 $\\mathcal{O}(h^2)$ 的形式缩放，其中 $h$ 表示一个代表性的网格间距，例如 $\\max(h_x,h_y)$。\n\n计算任务：\n- 实现一个程序，该程序：\n  1. 对指定的 $(L_x,L_y,N_x,N_y)$，组装并求解电阻网络线性系统，以获得内部节点电势 $\\phi_{i,j}$。\n  2. 在相同的节点上计算精确解 $\\phi_{\\text{exact}}(x_i,y_j)$。\n  3. 计算内部节点上的无穷范数误差，\n     $$\n     e_{\\infty} \\;=\\; \\max_{1 \\le i \\le N_x-2}\\,\\max_{1 \\le j \\le N_y-2}\\, \\big|\\phi_{i,j} - \\phi_{\\text{exact}}(x_i,y_j)\\big|,\n     $$\n     其单位为伏特（V）。\n  4. 对于一对网格 $(h_{\\text{coarse}},h_{\\text{fine}})$，计算观察到的精度阶数\n     $$\n     p \\;=\\; \\frac{\\ln\\!\\big(e_{\\infty}^{(\\text{coarse})} / e_{\\infty}^{(\\text{fine})}\\big)}{\\ln\\!\\big(h_{\\text{coarse}} / h_{\\text{fine}}\\big)},\n     $$\n     其中 $h = \\max(h_x,h_y)$，该值为无量纲。\n\n测试套件：\n使用以下三对网格比较来探究精度、各向异性和加密行为。所有长度必须以米为单位，电势以伏特为单位。\n\n- 情况 A（方形，中等加密）：\n  - $(L_x,L_y)=(1.0,1.0)$，粗网格为 $(N_x,N_y)=(17,17)$，细网格为 $(N_x,N_y)=(33,33)$。\n- 情况 B（方形，进一步加密）：\n  - $(L_x,L_y)=(1.0,1.0)$，粗网格为 $(N_x,N_y)=(33,33)$，细网格为 $(N_x,N_y)=(65,65)$。\n- 情况 C（矩形，各向异性分辨率）：\n  - $(L_x,L_y)=(2.0,1.0)$，粗网格为 $(N_x,N_y)=(33,17)$，细网格为 $(N_x,N_y)=(65,33)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含情况 A、B 和 C 的观察精度阶数，形式为方括号内以逗号分隔的列表，例如\n$$\n[p_A,p_B,p_C].\n$$\n- 报告的三个值是无量纲的。正弦函数中的角度必须是弧度。确保内部误差计算以伏特（V）为单位进行，但只打印无量纲的阶数。",
            "solution": "该问题要求对控制矩形电解池中一次电流分布的拉普拉斯方程的有限差分（或等效的电阻网络）近似的收敛阶数进行严格的数值验证。我们将首先概述离散化控制方程、构建相应线性系统的方法，然后计算与所提供的解析解之间的误差，以确定观察到的精度阶数。\n\n物理系统是矩形域 $\\Omega = \\{(x,y)\\,|\\, 0 \\le x \\le L_x,\\, 0 \\le y \\le L_y\\}$ 内的电解质。一次电流分布假设电解质电导率均匀、活化过电势可忽略不计且无浓度梯度。在这些假设下，电荷守恒定律 $\\nabla \\cdot \\mathbf{j} = 0$ 与欧姆定律 $\\mathbf{j} = -\\sigma \\nabla\\phi$（其中 $\\sigma$ 为恒定电导率）相结合，得出电势 $\\phi(x,y)$ 的控制偏微分方程（PDE），即拉普拉斯方程：\n$$\n\\nabla^2 \\phi = \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} = 0\n$$\n该电势场服从指定的狄利克雷边界条件：\n$$\n\\phi(x,0) = 0,\\quad \\phi(x,L_y) = \\sin(\\pi x/L_x),\\quad \\phi(0,y)=0,\\quad \\phi(L_x,y)=0\n$$\n\n为了数值求解此偏微分方程，我们使用一个在 $x$ 方向上有 $N_x$ 个点、在 $y$ 方向上有 $N_y$ 个点的网格来离散化域 $\\Omega$。网格间距为 $h_x = L_x/(N_x-1)$ 和 $h_y = L_y/(N_y-1)$。每个网格节点 $(x_i, y_j) = (i h_x, j h_y)$ 都关联一个电势值 $\\phi_{i,j}$，其中 $i \\in \\{0, 1, \\dots, N_x-1\\}$ 且 $j \\in \\{0, 1, \\dots, N_y-1\\}$。\n\n二阶偏导数使用中心有限差分近似：\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2}\\bigg|_{(x_i,y_j)} \\approx \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{h_x^2}\n$$\n$$\n\\frac{\\partial^2 \\phi}{\\partial y^2}\\bigg|_{(x_i,y_j)} \\approx \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{h_y^2}\n$$\n将这些近似值代入每个内部节点（$1 \\le i \\le N_x-2$, $1 \\le j \\le N_y-2$）的拉普拉斯方程，得到一个线性代数方程组：\n$$\n\\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{h_x^2} + \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{h_y^2} = 0\n$$\n这是拉普拉斯算子的五点模板，等效于将基尔霍夫电流定律应用于电阻网络，其中每个节点的电势为 $\\phi_{i,j}$，节点之间的电导与 $1/h_x$ 和 $1/h_y$ 成正比（该方程在乘以单元尺寸后，使用的因子与 $1/h_x^2$ 和 $1/h_y^2$ 成正比）。\n\n为了求解内部节点的未知电势，我们将离散方程重排为标准矩阵形式 $A\\mathbf{\\Phi} = \\mathbf{b}$。向量 $\\mathbf{\\Phi}$ 包含 $M = (N_x-2)(N_y-2)$ 个内部节点的未知电势 $\\phi_{i,j}$。我们使用行主序将二维网格索引 $(i,j)$ 映射到一维向量索引 $k$：$k = (j-1)(N_x-2) + (i-1)$。\n\n重排离散方程，我们得到：\n$$\n\\left(\\frac{2}{h_x^2} + \\frac{2}{h_y^2}\\right)\\phi_{i,j} - \\frac{1}{h_x^2}\\phi_{i+1,j} - \\frac{1}{h_x^2}\\phi_{i-1,j} - \\frac{1}{h_y^2}\\phi_{i,j+1} - \\frac{1}{h_y^2}\\phi_{i,j-1} = 0\n$$\n相邻电势 $\\phi_{i\\pm1, j}$ 和 $\\phi_{i, j\\pm1}$ 的系数构成了矩阵 $A$ 的非对角线元素，而 $\\phi_{i,j}$ 的系数构成了对角线元素 $A_{k,k}$。当一个相邻节点位于边界上时，其电势是已知的。相应的项被移到方程右侧，贡献给向量 $\\mathbf{b}$。\n\n给定边界条件：\n- $\\phi_{i,0} = 0$\n- $\\phi_{0,j} = 0$\n- $\\phi_{N_x-1,j} = 0$\n- $\\phi_{i, N_y-1} = \\sin(\\pi x_i/L_x) = \\sin(\\pi i h_x/L_x)$\n\n只有与顶部边界相邻的节点（即 $j=N_y-2$）才会对 $\\mathbf{b}$ 有非零贡献。对于节点 $(i, N_y-2)$，涉及其顶部邻居 $\\phi_{i, N_y-1}$ 的项是已知的。该节点的方程变为：\n$$\n\\left(\\frac{2}{h_x^2} + \\frac{2}{h_y^2}\\right)\\phi_{i,N_y-2} - \\dots = \\frac{1}{h_y^2}\\phi_{i,N_y-1} = \\frac{1}{h_y^2}\\sin(\\pi i h_x/L_x)\n$$\n因此，对于对应于节点 $(i, N_y-2)$ 的一维索引 $k$，$b_k$ 项将是 $\\frac{1}{h_y^2}\\sin(\\pi i h_x/L_x)$。$\\mathbf{b}$ 的所有其他项均为零。得到的矩阵 $A$ 是稀疏、对称、正定且对角占优的，这保证了 $\\mathbf{\\Phi}$ 有唯一解，该解可以使用标准线性求解器找到。\n\n一旦在所有内部节点上获得数值解 $\\phi_{i,j}$，我们通过将其与在相同节点上计算的精确解析解进行比较来计算误差：\n$$\n\\phi_{\\text{exact}}(x_i,y_j) = \\sin\\left(\\frac{\\pi x_i}{L_x}\\right)\\frac{\\sinh\\left(\\frac{\\pi y_j}{L_x}\\right)}{\\sinh\\left(\\frac{\\pi L_y}{L_x}\\right)}\n$$\n误差使用内部节点集上的无穷范数进行量化：\n$$\ne_{\\infty} = \\max_{1 \\le i \\le N_x-2}\\,\\max_{1 \\le j \\le N_y-2}\\, |\\phi_{i,j} - \\phi_{\\text{exact}}(x_i,y_j)|\n$$\n最后，为了验证该格式的二阶精度，我们使用来自两种不同网格分辨率（一粗一细）的误差来计算观察到的精度阶数 $p$：\n$$\np = \\frac{\\ln(e_{\\infty}^{(\\text{coarse})} / e_{\\infty}^{(\\text{fine})})}{\\ln(h_{\\text{coarse}} / h_{\\text{fine}})}\n$$\n其中 $h = \\max(h_x, h_y)$ 是代表性的网格间距。对于一个二阶格式，当网格间距减半（$h_{\\text{coarse}} / h_{\\text{fine}} = 2$）时，误差预计会减少四倍，从而得到观察阶数 $p \\approx \\log_2(4) = 2$。计算任务是为三个指定的测试用例计算 $p$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef calculate_error(Lx, Ly, Nx, Ny):\n    \"\"\"\n    Assembles and solves the finite difference system for Laplace's equation\n    and returns the infinity-norm error against the exact solution.\n    \"\"\"\n    # Grid spacings\n    hx = Lx / (Nx - 1)\n    hy = Ly / (Ny - 1)\n\n    # Number of interior nodes\n    num_interior_x = Nx - 2\n    num_interior_y = Ny - 2\n    num_unknowns = num_interior_x * num_interior_y\n\n    if num_unknowns == 0:\n        return 0.0\n\n    # Initialize the matrix A and vector b for the system A*phi = b\n    A = np.zeros((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    # Coefficients from the finite difference stencil\n    cx = 1.0 / hx**2\n    cy = 1.0 / hy**2\n    cdiag = 2.0 * (cx + cy)\n\n    # Populate the matrix A and vector b\n    for j in range(1, Ny - 1):       # y-index of interior nodes\n        for i in range(1, Nx - 1):   # x-index of interior nodes\n            # Map 2D grid indices (i,j) to 1D vector index k (row-major)\n            k = (j - 1) * num_interior_x + (i - 1)\n\n            # Diagonal element\n            A[k, k] = cdiag\n\n            # Off-diagonal elements (connections to neighbors)\n            # West neighbor (i-1, j)\n            if i > 1:\n                A[k, k - 1] = -cx\n            else: # Boundary node phi(0,y)=0, no contribution to b\n                pass \n            \n            # East neighbor (i+1, j)\n            if i  Nx - 2:\n                A[k, k + 1] = -cx\n            else: # Boundary node phi(Lx,y)=0, no contribution to b\n                pass\n            \n            # South neighbor (i, j-1)\n            if j > 1:\n                A[k, k - num_interior_x] = -cy\n            else: # Boundary node phi(x,0)=0, no contribution to b\n                pass\n            \n            # North neighbor (i, j+1)\n            if j  Ny - 2:\n                A[k, k + num_interior_x] = -cy\n            else: # Boundary node phi(x,Ly)=sin(pi*x/Lx)\n                x = i * hx\n                phi_boundary = np.sin(np.pi * x / Lx)\n                b[k] += cy * phi_boundary\n\n    # Solve the linear system\n    try:\n        phi_vec = np.linalg.solve(A, b)\n    except np.linalg.LinAlgError:\n        # This should not happen for a well-posed problem\n        return np.inf\n\n    # Reshape solution vector back to a 2D grid\n    phi_numerical = phi_vec.reshape((num_interior_y, num_interior_x))\n    \n    # Calculate the exact solution at interior nodes\n    x_coords = np.linspace(hx, Lx - hx, num_interior_x)\n    y_coords = np.linspace(hy, Ly - hy, num_interior_y)\n    xx, yy = np.meshgrid(x_coords, y_coords)\n    \n    k_pi_Lx = np.pi / Lx\n    sinh_term_denom = np.sinh(k_pi_Lx * Ly)\n\n    # Avoid division by zero if sinh is too small (not relevant for test cases)\n    if sinh_term_denom == 0:\n        phi_exact = np.zeros_like(xx) \n    else:\n        phi_exact = np.sin(k_pi_Lx * xx) * np.sinh(k_pi_Lx * yy) / sinh_term_denom\n\n    # Compute the infinity-norm of the error\n    error = np.max(np.abs(phi_numerical - phi_exact))\n    \n    return error\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Lx, Ly, Nx_coarse, Ny_coarse, Nx_fine, Ny_fine)\n    test_cases = [\n        # Case A\n        (1.0, 1.0, 17, 17, 33, 33),\n        # Case B\n        (1.0, 1.0, 33, 33, 65, 65),\n        # Case C\n        (2.0, 1.0, 33, 17, 65, 33),\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, Nx_c, Ny_c, Nx_f, Ny_f = case\n        \n        # Calculate errors for coarse and fine grids\n        e_coarse = calculate_error(Lx, Ly, Nx_c, Ny_c)\n        e_fine = calculate_error(Lx, Ly, Nx_f, Ny_f)\n        \n        # Calculate representative grid spacings\n        h_coarse = max(Lx / (Nx_c - 1), Ly / (Ny_c - 1))\n        h_fine = max(Lx / (Nx_f - 1), Ly / (Ny_f - 1))\n        \n        # Calculate the observed order of accuracy\n        # Check for non-positive errors or h_ratio = 1 to avoid math domain errors\n        if e_coarse == 0 or e_fine == 0 or h_coarse / h_fine == 1:\n            p = np.nan # Should not happen in these well-defined test cases\n        else:\n            p = np.log(e_coarse / e_fine) / np.log(h_coarse / h_fine)\n\n        results.append(p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "计算模型的力量不仅在于预测，还在于解释实验数据和提取物理参数。本练习将理论模型与实验校准联系起来，向您展示如何从测量的电流-电位数据中确定一个关键的界面参数——接触电阻率 $r_c$ 。您将首先从第一性原理出发，推导出一个包含界面电阻的电化学模型，然后设计并实施一个基于线性最小二乘法的数据拟合方案，从而将理论与实践无缝对接。",
            "id": "4255450",
            "problem": "考虑一个位于 $x=0$ 的平面电极，浸入厚度为 $L$、具有恒定离子电导率 $\\kappa$ 和横截面积 $A$ 的均匀电解质板中。电极金属的电势是均匀的，记为 $\\phi_m$，电解质的电势为 $\\phi(x)$。假设系统处于一次电流分布（Primary Current Distribution）体系下，其中电解质遵循稳态传导，浓度梯度和活化过电势均可忽略不计。电解质电势满足由电荷守恒和欧姆定律导出的拉普拉斯方程，界面处存在一个由罗宾边界条件描述的线性接触电阻。测量提供总电流 $I$ 和金属与参比电极（位于 $x=L$）之间的电势差 $\\Delta \\phi$ 的数据对。任务是通过拟合测量的 $I$–$\\Delta \\phi$ 数据，并系统地分离电解质和界面的贡献，来推导和校准出现在罗宾边界条件中的界面接触电阻率参数。\n\n从以下基本原理出发：\n- 电荷守恒（稳态）：$\\nabla \\cdot \\mathbf{j} = 0$。\n- 离子传导的欧姆定律：$\\mathbf{j} = -\\kappa \\nabla \\phi$，其中 $\\kappa$ 在空间上是常数。\n- 罗宾边界条件（线性界面接触模型）：电极处的法向离子电流密度等于一个界面项，该项将金属电势 $\\phi_m$ 和表面电解质电势 $\\phi_s$ 线性关联起来，由单位为 $\\Omega \\cdot \\mathrm{m}^2$ 的接触电阻率 $r_c$ 参数化。\n\n您必须：\n1. 从第一性原理和上述基本原理出发，推导可测量量 $I$ 和 $\\Delta \\phi$ 之间的关系，明确指出由电解质路径和界面接触电阻率引起的各自贡献。不要假设任何快捷公式；通过求解一维电解质域并应用边界条件，推导出控制方程和最终关系。\n2. 使用您推导出的关系，设计一个计算方案，用于从已知的 $(L,\\kappa,A)$ 和观测到的 $(I,\\Delta \\phi)$ 的多组测量数据中估计界面接触电阻率 $r_c$。您的方案必须明确地将电解质的贡献与界面的贡献分离开来。该方案应能抵抗微小的测量噪声，并应采用线性最小二乘法来拟合适当的变换变量，以确保 $r_c$ 的唯一估计。\n3. 将该方案实现为一个完整、可运行的程序，处理以下包含三个案例的测试套件。在每个案例中，使用提供的测量数据估计 $r_c$（单位为 $\\Omega \\cdot \\mathrm{m}^2$）。将最终输出表示为具有六位有效数字的科学记数法浮点数。角度单位不适用。不涉及百分比；所有比率类型的输出都应为十进制数。\n\n测试套件（所有量均使用国际单位制）：\n- 案例1（理想情况，电解质贡献适中）：\n  - 几何形状和材料：$L = 0.005$，$\\kappa = 10$，$A = 4 \\times 10^{-4}$。\n  - 测量数据对 $(I,\\Delta \\phi)$：$I$ 值为 $\\left[0.5, 1.0, 1.5\\right]$，对应的 $\\Delta \\phi$ 值为 $\\left[0.6854375, 1.3805, 2.058375\\right]$。\n- 案例2（边界情况，电解质贡献相对于接触电阻较小）：\n  - 几何形状和材料：$L = 0.001$，$\\kappa = 1000$，$A = 1 \\times 10^{-4}$。\n  - 测量数据对 $(I,\\Delta \\phi)$：$I$ 值为 $\\left[2.0, 5.0, 10.0\\right]$，对应的 $\\Delta \\phi$ 值为 $\\left[0.2222, 0.5456, 1.1055\\right]$。\n- 案例3（极端情况，电解质电阻占主导）：\n  - 几何形状和材料：$L = 0.001$，$\\kappa = 1$，$A = 1 \\times 10^{-5}$。\n  - 测量数据对 $(I,\\Delta \\phi)$：$I$ 值为 $\\left[0.05, 0.1\\right]$，对应的 $\\Delta \\phi$ 值为 $\\left[5.049, 10.3224\\right]$。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表，列表中的每个条目是校准后的 $r_c$（单位为 $\\Omega \\cdot \\mathrm{m}^2$），并格式化为具有六位有效数字的科学记数法。例如，输出格式为 `[1.23456e-05, 2.00000e-05, 3.14159e-05]`。\n\n无需外部输入。所有常数和测量数据均已在上面指定。最终输出必须严格遵循所述格式：包含按给定顺序排列的三个案例的三个 $r_c$ 估计值的单行 Python 列表字面量。",
            "solution": "该问题被评估为有效，因为它在科学上基于电化学原理，在数学上是适定的，并为推导和计算提供了完整且一致的信息集。\n\n解决方案按要求分为两部分呈现：首先，从第一性原理推导控制物理关系；其次，设计用于估计模型参数的计算方案。\n\n### 第1部分：电流-电势关系的推导\n\n我们考虑一个一维系统，其中电极位于位置 $x=0$，电解质延伸至 $x=L$。电解质中的电势记为 $\\phi(x)$，电流密度矢量 $\\mathbf{j}$ 沿 $x$ 轴方向，即 $\\mathbf{j} = j_x \\mathbf{\\hat{i}}$。\n\n1.  **电荷守恒和欧姆定律**：稳态电荷守恒方程为 $\\nabla \\cdot \\mathbf{j} = 0$。在一维情况下，这简化为 $\\frac{d j_x}{dx} = 0$，意味着电流密度 $j_x$ 在整个电解质中是恒定的。我们将此恒定电流密度记为 $j$。\n\n    离子传导的欧姆定律表明 $\\mathbf{j} = -\\kappa \\nabla \\phi$，其中 $\\kappa$ 是恒定的离子电导率。在一维情况下，即为 $j_x = -\\kappa \\frac{d\\phi}{dx}$。\n\n    结合这两个原理，我们得到一个关于电解质电势 $\\phi(x)$ 的一阶常微分方程：\n    $$\n    -\\kappa \\frac{d\\phi}{dx} = j\n    $$\n    由于 $j$ 和 $\\kappa$ 是常数，我们可以将此方程从 $x=0$ 的电极表面到 $x=L$ 的参比探头位置对 $x$ 进行积分。令 $\\phi_s = \\phi(0)$ 为界面处的电解质电势，$\\phi_r = \\phi(L)$ 为参比位置的电势。\n    $$\n    \\int_{\\phi_s}^{\\phi_r} d\\phi = \\int_{0}^{L} -\\frac{j}{\\kappa} dx\n    $$\n    $$\n    \\phi_r - \\phi_s = -\\frac{jL}{\\kappa}\n    $$\n    该方程描述了体电解质中的欧姆电势降。整理后可得：\n    $$\n    \\phi_s - \\phi_r = \\frac{jL}{\\kappa}\n    $$\n\n2.  **界面边界条件**：问题指定了一个罗宾边界条件，用于模拟电极-电解质界面（$x=0$）处的线性接触电阻。法向离子电流密度 $j$ 与金属相电势 $\\phi_m$ 和表面电解质电势 $\\phi_s$ 之间的电势差成正比。比例常数是界面接触电阻率 $r_c$ 的倒数。\n    $$\n    j = \\frac{\\phi_m - \\phi_s}{r_c}\n    $$\n    这给出了界面上的电势降：\n    $$\n    \\phi_m - \\phi_s = j r_c\n    $$\n    单位是一致的：$j$ 的单位是 $\\text{A}/\\text{m}^2$，$\\phi$ 的单位是 $\\text{V}$，因此 $r_c$ 的单位必须是 $\\text{V}\\cdot\\text{m}^2/\\text{A}$，即 $\\Omega \\cdot \\text{m}^2$。\n\n3.  **总可测电势差**：实验上测量的量是金属电极和参比电极之间的电势差 $\\Delta \\phi = \\phi_m - \\phi_r$。我们可以通过将界面和电解质上的各个电势降相加来表示它：\n    $$\n    \\Delta \\phi = (\\phi_m - \\phi_s) + (\\phi_s - \\phi_r)\n    $$\n    代入上面推导出的表达式：\n    $$\n    \\Delta \\phi = j r_c + \\frac{jL}{\\kappa}\n    $$\n    流经系统的总电流 $I$ 是电流密度 $j$ 乘以横截面积 $A$，因此 $j = I/A$。将此代入 $\\Delta \\phi$ 的方程中：\n    $$\n    \\Delta \\phi = \\frac{I}{A} r_c + \\frac{I L}{A \\kappa}\n    $$\n    提出总电流 $I$ 作为公因子，我们得到可测量量之间的最终关系：\n    $$\n    \\Delta \\phi = I \\left( \\frac{r_c}{A} + \\frac{L}{\\kappa A} \\right)\n    $$\n    该方程表明，总测量电阻 $R_{total} = \\Delta \\phi / I$ 是两个组分之和：界面接触电阻 $R_c = r_c/A$ 和体电解质电阻 $R_{elyt} = L/(\\kappa A)$。\n    $$\n    R_{total} = R_c + R_{elyt}\n    $$\n\n### 第2部分：参数估计的计算方案\n\n目标是在给定已知参数 $L$、$\\kappa$ 和 $A$ 的情况下，从一系列 $N$ 组测量对 $(I_i, \\Delta \\phi_i)$ 中估计界面接触电阻率 $r_c$。\n\n1.  **线性模型构建**：推导出的关系 $\\Delta \\phi = I \\left( \\frac{r_c}{A} + \\frac{L}{\\kappa A} \\right)$ 具有过原点线性方程 $y = m x$ 的形式，其中因变量为 $y_i = \\Delta \\phi_i$，自变量为 $x_i = I_i$，斜率为恒定的总电阻 $m = R_{total} = \\frac{r_c}{A} + \\frac{L}{\\kappa A}$。\n\n2.  **最小二乘估计**：为了从可能含有微小测量噪声的数据中获得 $R_{total}$ 的鲁棒估计，我们采用线性最小二乘法。对于一个无截距的线性模型 $y=mx$，使残差平方和 $\\sum (y_i - m x_i)^2$ 最小化的斜率 $m$ 由下式给出：\n    $$\n    \\hat{m} = \\hat{R}_{total} = \\frac{\\sum_{i=1}^{N} x_i y_i}{\\sum_{i=1}^{N} x_i^2}\n    $$\n    在我们的情境下，这变为：\n    $$\n    \\hat{R}_{total} = \\frac{\\sum_{i=1}^{N} I_i \\Delta \\phi_i}{\\sum_{i=1}^{N} I_i^2}\n    $$\n\n3.  **界面电阻率的分离**：一旦从测量数据中计算出最佳拟合总电阻 $\\hat{R}_{total}$，我们就可以通过系统地分离出已知的电解质贡献来确定 $r_c$。\n\n    a.  首先，使用给定参数计算电解质板的理论电阻：\n        $$\n        R_{elyt} = \\frac{L}{\\kappa A}\n        $$\n\n    b.  接下来，从估计的总电阻中减去该电解质电阻，以求得估计的接触电阻 $\\hat{R}_c$：\n        $$\n        \\hat{R}_c = \\hat{R}_{total} - R_{elyt}\n        $$\n\n    c.  最后，将接触电阻乘以电极面积 $A$，即可得到界面接触电阻率 $\\hat{r}_c$：\n        $$\n        \\hat{r}_c = \\hat{R}_c \\cdot A\n        $$\n\n4.  **最终估计公式**：将这些步骤结合起来，可得到一个用于估计 $r_c$ 的单一综合公式：\n    $$\n    \\hat{r}_c = \\left( \\frac{\\sum_{i=1}^{N} I_i \\Delta \\phi_i}{\\sum_{i=1}^{N} I_i^2} - \\frac{L}{\\kappa A} \\right) \\cdot A\n    $$\n    该方案提供了一种使用所有可用数据来计算 $\\hat{r}_c$ 的直接且鲁棒的方法，满足了问题的要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the interfacial contact resistivity r_c for three test cases\n    based on a derived physical model and linear least-squares fitting.\n    \"\"\"\n    test_cases = [\n        {\n            \"case_id\": 1,\n            \"L\": 0.005,\n            \"kappa\": 10.0,\n            \"A\": 4.0e-4,\n            \"I\": [0.5, 1.0, 1.5],\n            \"d_phi\": [0.6854375, 1.3805, 2.058375],\n        },\n        {\n            \"case_id\": 2,\n            \"L\": 0.001,\n            \"kappa\": 1000.0,\n            \"A\": 1.0e-4,\n            \"I\": [2.0, 5.0, 10.0],\n            \"d_phi\": [0.2222, 0.5456, 1.1055],\n        },\n        {\n            \"case_id\": 3,\n            \"L\": 0.001,\n            \"kappa\": 1.0,\n            \"A\": 1.0e-5,\n            \"I\": [0.05, 0.1],\n            \"d_phi\": [5.049, 10.3224],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        L = case[\"L\"]\n        kappa = case[\"kappa\"]\n        A = case[\"A\"]\n        \n        # Convert measurement data to numpy arrays for vectorized operations\n        I_data = np.array(case[\"I\"])\n        delta_phi_data = np.array(case[\"d_phi\"])\n\n        # The model is Δφ = R_total * I, which is a line through the origin.\n        # The least-squares estimate for the slope (R_total) is (I · Δφ) / (I · I).\n        \n        # Calculate the numerator and denominator for the least-squares formula\n        sum_I_dphi = np.dot(I_data, delta_phi_data)\n        sum_I_sq = np.dot(I_data, I_data)\n\n        # Estimate the total resistance\n        R_total_est = sum_I_dphi / sum_I_sq\n\n        # Calculate the theoretical electrolyte resistance from given parameters\n        R_elyt = L / (kappa * A)\n\n        # The total resistance is the sum of electrolyte and contact resistances:\n        # R_total = R_elyt + R_contact\n        # R_contact = R_total - R_elyt\n        R_contact_est = R_total_est - R_elyt\n\n        # The contact resistivity (r_c) is the contact resistance scaled by area:\n        # r_c = R_contact * A\n        rc_est = R_contact_est * A\n        \n        results.append(rc_est)\n\n    # Format the final output as a comma-separated list in scientific notation\n    # with six significant digits (format specifier .5e).\n    output_str = f\"[{','.join(f'{r:.5e}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}