{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的计算模型之前，理解系统在特定极限情况下的行为至关重要，因为这些情况通常允许我们获得解析解。本练习探讨了电化学反应的塔菲尔（Tafel）区，在该区域，动力学关系呈现指数形式。通过推导在过电位空间变化情况下电流密度的分布，我们可以直观地理解电极表面电位不均匀性如何导致电流分布的不均匀性，这为分析更复杂的情形奠定了基础。",
            "id": "4256749",
            "problem": "考虑一个一维、等温、长度为 $L$ 的平面电极，其空间坐标为 $x \\in [0,L]$，与支持电解质接触。假设系统处于二次电流分布（SCD）条件下，即浓度场是均匀的，电解质中的传输由欧姆定律支配，无传质限制。设单步、活化控制的电荷转移动力学由公认的通用 Butler–Volmer 关系描述，其中交换电流密度 $j_{0}$ 为均匀值，阳极电荷转移系数为单一值 $\\alpha \\in (0,1)$，绝对温度为 $T$。令 $F$ 表示法拉第常数，$R$ 表示通用气体常数。将界面过电势 $\\eta(x)$ 定义为固相电位 $\\phi_{s}(x)$ 与液相电位 $\\phi_{e}(x)$ 相对于局部平衡电位的差值，并假设平衡电位在空间上是均匀的，从而所有的空间依赖性都通过 $\\phi_{s}(x)-\\phi_{e}(x)$ 体现。\n\n假设电极被阳极驱动，对所有 $x \\in [0,L]$ 都有 $\\eta(x) > 0$，并且系统处于塔菲尔区，即 $|\\eta(x)| \\gg RT/F$。再假设，由于固相欧姆压降和SCD下电解质电场的共同作用，差值 $\\phi_{s}(x) - \\phi_{e}(x)$ 在空间上呈线性变化，\n$$\n\\phi_{s}(x) - \\phi_{e}(x) = \\eta_{0} + \\kappa x,\n$$\n其中 $\\eta_{0}$ 和 $\\kappa$ 是空间上均匀的常数，$\\kappa$ 可以为正或为负，但要保证在 $[0,L]$ 上 $\\eta(x)=\\eta_{0}+\\kappa x>0$。\n\n从通用的 Butler-Volmer 动力学和上述定义出发，并且仅使用所陈述的假设，完成以下任务：\n\n1. 严格证明为什么在阳极极化的塔菲尔区，将法向界面电流密度 $j(x)$ 与过电位 $\\eta(x)$ 联系起来的动力学边界条件实际上变为 $\\eta(x)$ 的指数函数，并确定指数灵敏度系数，将其表示为 $\\alpha$、$F$、$R$ 和 $T$ 的函数。\n\n2. 使用线性形式 $\\eta(x)=\\eta_{0}+\\kappa x$，推导沿电极的电流密度空间分布 $j(x)$。\n\n3. 计算单位电极深度（垂直纸面方向）的总电流 $I$，其定义为\n$$\nI \\equiv \\int_{0}^{L} j(x)\\, dx,\n$$\n并将其表示为关于 $j_{0}$、$\\alpha$、$F$、$R$、$T$、$\\eta_{0}$、$\\kappa$ 和 $L$ 的单个封闭形式的解析表达式。\n\n将 $I$ 的最终结果表示为封闭形式的解析表达式。如果要进行数值计算，$I$ 的单位必须是安培每米（A/m）。不要提供任何数值计算；无需四舍五入。",
            "solution": "问题陈述已经过严格验证，并被认为是科学上可靠、适定且自洽的。它提出了一个理论电化学中的标准可解问题。所有提供的信息都是一致的，并且足以推导出所要求的量。\n\n解答过程按问题陈述的要求分为三个部分。\n\n**1. 指数动力学边界条件（塔菲尔方程）的证明**\n\n描述单步、活化控制的电荷转移反应的通用 Butler–Volmer 方程将净电流密度 $j$ 与界面过电位 $\\eta$ 联系起来。其形式为：\n$$\nj(\\eta) = j_{0} \\left( \\exp\\left(\\frac{\\alpha F \\eta}{RT}\\right) - \\exp\\left(-\\frac{(1-\\alpha) F \\eta}{RT}\\right) \\right)\n$$\n其中 $j_{0}$ 是交换电流密度，$\\alpha$ 是阳极电荷转移系数，$F$ 是法拉第常数，$R$ 是通用气体常数，$T$ 是绝对温度。括号中的第一项代表阳极分电流密度，第二项代表阴极分电流密度。\n\n问题指明了两个条件：\n(i) 电极被阳极驱动，意味着对所有 $x$，过电位均为正：$\\eta(x) > 0$。\n(ii) 系统处于塔菲尔区，意味着过电位的量级远大于热电压尺度：$|\\eta(x)| \\gg \\frac{RT}{F}$。\n\n给定 $\\eta(x) > 0$，由于 $\\alpha \\in (0,1)$、$F>0$、$R>0$ 和 $T>0$，第一个指数项的参数 $\\frac{\\alpha F \\eta(x)}{RT}$ 是正的。因此，条件 $|\\eta(x)| \\gg \\frac{RT}{F}$ 意味着 $\\frac{\\alpha F \\eta(x)}{RT}$ 是一个大的正数。因此，阳极项 $\\exp\\left(\\frac{\\alpha F \\eta(x)}{RT}\\right)$ 远大于 $1$。\n\n对于阴极项，指数项的参数是 $-\\frac{(1-\\alpha) F \\eta(x)}{RT}$。由于 $1-\\alpha > 0$ 且 $\\eta(x) > 0$，这个参数是负的。条件 $|\\eta(x)| \\gg \\frac{RT}{F}$ 意味着 $-\\frac{(1-\\alpha) F \\eta(x)}{RT}$ 是一个绝对值很大的负数。因此，阴极项 $\\exp\\left(-\\frac{(1-\\alpha) F \\eta(x)}{RT}\\right)$ 趋近于零，并且与大的阳极项相比可以忽略不计。\n\n因此，在这些条件下，Butler–Volmer 方程可以严格地通过仅保留阳极项来近似：\n$$\nj(\\eta) \\approx j_{0} \\exp\\left(\\frac{\\alpha F \\eta}{RT}\\right)\n$$\n这就是阳极塔菲尔方程。它表明界面电流密度 $j$ 实际上是过电位 $\\eta$ 的指数函数。该关系的形式为 $j \\propto \\exp(\\beta \\eta)$，其中，指数灵敏度系数 $\\beta$ 通过观察可确定为：\n$$\n\\beta = \\frac{\\alpha F}{RT}\n$$\n\n**2. 电流密度 $j(x)$ 的空间分布**\n\n问题给出了过电位 $\\eta(x)$ 的线性空间依赖关系，其定义为差值 $\\phi_{s}(x) - \\phi_{e}(x)$：\n$$\n\\eta(x) = \\eta_{0} + \\kappa x\n$$\n其中 $\\eta_{0}$ 和 $\\kappa$ 是常数。\n\n将此 $\\eta(x)$ 的线性表达式代入上一步推导的阳极塔菲尔方程，得到沿电极的电流密度空间分布 $j(x)$：\n$$\nj(x) = j_{0} \\exp\\left(\\frac{\\alpha F (\\eta_{0} + \\kappa x)}{RT}\\right)\n$$\n该表达式可以重写以分离空间依赖性：\n$$\nj(x) = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\exp\\left(\\frac{\\alpha F \\kappa x}{RT}\\right)\n$$\n\n**3. 总电流 $I$ 的计算**\n\n单位电极深度的总电流 $I$ 通过将电流密度分布 $j(x)$ 在电极长度上（从 $x=0$ 到 $x=L$）积分得到：\n$$\nI = \\int_{0}^{L} j(x) \\, dx = \\int_{0}^{L} j_{0} \\exp\\left(\\frac{\\alpha F (\\eta_{0} + \\kappa x)}{RT}\\right) \\, dx\n$$\n我们可以将常数项从积分中提出：\n$$\nI = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\int_{0}^{L} \\exp\\left(\\frac{\\alpha F \\kappa x}{RT}\\right) \\, dx\n$$\n必须执行积分。我们考虑常数 $\\kappa$ 的两种情况。\n\n情况 1：$\\kappa \\neq 0$\n积分的形式为 $\\int \\exp(ax) \\, dx = \\frac{1}{a} \\exp(ax)$。这里，指数中的常数是 $a = \\frac{\\alpha F \\kappa}{RT}$。\n$$\n\\int_{0}^{L} \\exp\\left(\\frac{\\alpha F \\kappa x}{RT}\\right) \\, dx = \\left[ \\frac{RT}{\\alpha F \\kappa} \\exp\\left(\\frac{\\alpha F \\kappa x}{RT}\\right) \\right]_{0}^{L}\n$$\n在积分上下限处计算反导函数的值：\n$$\n= \\frac{RT}{\\alpha F \\kappa} \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - \\exp(0) \\right) = \\frac{RT}{\\alpha F \\kappa} \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - 1 \\right)\n$$\n将此结果代回 $I$ 的表达式：\n$$\nI = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\frac{RT}{\\alpha F \\kappa} \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - 1 \\right)\n$$\n重新整理各项，得到 $\\kappa \\neq 0$ 时的最终单个封闭形式解析表达式：\n$$\nI = \\frac{j_{0} RT}{\\alpha F \\kappa} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - 1 \\right)\n$$\n\n情况 2：$\\kappa = 0$\n如果 $\\kappa=0$，则过电位是均匀的，$\\eta(x) = \\eta_{0}$，电流密度也是均匀的：$j(x) = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right)$。积分变为：\n$$\nI = \\int_{0}^{L} j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\, dx = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\int_{0}^{L} dx = L j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right)\n$$\n这个结果可以通过对 $\\kappa \\neq 0$ 的通用表达式取 $\\kappa \\to 0$ 的极限得到，使用基本极限 $\\lim_{z \\to 0} \\frac{\\exp(cz)-1}{z} = c$。问题要求一个单一的表达式，这通常是指分母不为零的一般情况。\n\n因此，用给定参数表示的 $I$ 的最终封闭形式表达式是为 $\\kappa \\neq 0$ 推导出的结果。",
            "answer": "$$\n\\boxed{\\frac{j_{0} RT}{\\alpha F \\kappa} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - 1 \\right)}\n$$"
        },
        {
            "introduction": "大多数实际的电化学系统，特别是那些由完整的巴特勒-沃尔默（Butler-Volmer）方程描述的系统，都无法求得简单的解析解，因此数值方法成为不可或缺的工具。本练习将引导您体验计算电化学的核心工作流程：首先对控制方程进行无量纲化以增强数值稳定性，然后构建适用于有限元法（FEM）的弱形式，并最终实现一个数值求解器（如牛顿法）来计算电位和电流的分布。",
            "id": "4256781",
            "problem": "考虑一个占据区间 $[0,L]$ 的一维电解质平板，其空间坐标为 $x\\in[0,L]$，具有恒定的离子电导率 $\\kappa$。在 $x=0$ 处有一个平面金属电极，该电极支持电荷转移表面动力学。电解质电势用 $\\phi(x)$ 表示，金属电极被假定为一个等势体，其金属电势为 $\\phi_{\\mathrm{m}}$。在 $x=L$ 处的远场电解质电势固定为 $\\phi(L)=\\phi_{\\infty}$。电解质中控制电荷守恒和本构关系的方程由 $\\nabla\\cdot\\boldsymbol{i}=0$ 和 $\\boldsymbol{i}=-\\kappa\\nabla\\phi$ 给出，其中 $\\boldsymbol{i}$ 是电流密度矢量，$\\kappa$ 是一个正常数。电极上的表面动力学由 Butler-Volmer 关系式建模：$-\\boldsymbol{n}\\cdot\\boldsymbol{i}=j_{0}\\left(\\exp\\!\\left(\\dfrac{\\alpha_{\\mathrm{a}}F\\eta}{RT}\\right)-\\exp\\!\\left(-\\dfrac{\\alpha_{\\mathrm{c}}F\\eta}{RT}\\right)\\right)$，其中 $\\boldsymbol{n}$ 是从电解质指向外部的单位法向量，$j_{0}$ 是交换电流密度，$\\alpha_{\\mathrm{a}}$ 是阳极传递系数，$\\alpha_{\\mathrm{c}}$ 是阴极传递系数，$F$ 是法拉第常数，$R$ 是通用气体常数，$T$ 是绝对温度，$\\eta$ 是过电势，定义为 $\\eta=\\phi_{\\mathrm{m}}-\\phi(0)-E_{\\mathrm{eq}}$，其中 $E_{\\mathrm{eq}}$ 是电极反应的平衡电势。\n\n您的任务如下：首先，为具有表面动力学的二次电流分布问题推导一个一致的无量纲弱形式，以改善多物理场求解器中残差和雅可比矩阵的条件数和缩放；其次，将该弱形式特化为在 $[0,L]$ 上的单个线性有限元，并在 $x=L$ 处施加本质边界条件 $u(1)=0$；第三，实现一个程序，该程序组装得到的无量纲残差和雅可比矩阵，并使用牛顿法求解得到的标量非线性方程，以计算无量纲边界电流密度。在整个过程中，您必须使用热电压 $V_{T}=\\dfrac{RT}{F}$ 对电势进行无量纲化，使用平板厚度 $L$ 对长度进行无量纲化，使用电导标度 $\\dfrac{\\kappa V_{T}}{L}$ 对电流进行无量纲化，从而定义无量纲变量 $u=\\dfrac{\\phi}{V_{T}}$，$\\xi=\\dfrac{x}{L}$，$U_{\\mathrm{m}}=\\dfrac{\\phi_{\\mathrm{m}}}{V_{T}}$，$U_{\\infty}=\\dfrac{\\phi_{\\infty}}{V_{T}}$ 和 $U_{\\mathrm{eq}}=\\dfrac{E_{\\mathrm{eq}}}{V_{T}}$。引入无量纲动力学参数 $\\Lambda=\\dfrac{j_{0}L}{\\kappa V_{T}}$，并完全用无量纲量重写边界动力学关系。弱形式必须用一个无量纲检验函数 $w(\\xi)$ 来书写，并且分部积分必须产生与所选无量纲化一致缩放的边界项。\n\n在推导出无量纲弱形式并将其简化为区间 $[0,1]$ 上具有 $u(1)=0$ 的单个线性基函数后，证明该离散化产生一个关于无量纲斜率 $A=\\dfrac{du}{d\\xi}$ 的标量非线性方程，并且在 $\\xi=0$ 处的无量纲边界电流密度 $j^{\\ast}$ 为 $j^{\\ast}=-\\dfrac{du}{d\\xi}\\big\\rvert_{\\xi=0}=-A$。为标量残差实现一个牛顿求解器以计算 $A$，并报告每个测试用例的 $j^{\\ast}$。\n\n您的程序必须解决该无量纲问题，并为一组指定的测试用例输出相应的无量纲边界电流密度 $j^{\\ast}$ 作为实数。输出中不应出现任何物理单位，因为所有报告的量都是无量纲的。使用以下测试套件：\n\n- 测试用例 1：$\\Lambda=0.778$，$\\alpha_{\\mathrm{a}}=0.5$，$\\alpha_{\\mathrm{c}}=0.5$，$U_{\\mathrm{m}}=0.3$，$U_{\\mathrm{eq}}=0.0$。\n- 测试用例 2：$\\Lambda=0.01$，$\\alpha_{\\mathrm{a}}=0.5$，$\\alpha_{\\mathrm{c}}=0.5$，$U_{\\mathrm{m}}=0.3$，$U_{\\mathrm{eq}}=0.0$。\n- 测试用例 3：$\\Lambda=5.0$，$\\alpha_{\\mathrm{a}}=0.5$，$\\alpha_{\\mathrm{c}}=0.5$，$U_{\\mathrm{m}}=0.3$，$U_{\\mathrm{eq}}=0.0$。\n- 测试用例 4：$\\Lambda=0.8$，$\\alpha_{\\mathrm{a}}=0.7$，$\\alpha_{\\mathrm{c}}=0.3$，$U_{\\mathrm{m}}=0.2$，$U_{\\mathrm{eq}}=-0.05$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}]$，其中每个 $\\text{result}_{i}$ 是为相应测试用例计算的无量纲边界电流密度 $j^{\\ast}$。",
            "solution": "用户提供了一个计算电化学问题。我将首先验证问题陈述。\n\n### 步骤 1：提取给定信息\n- **域**：$x \\in [0, L]$ 上的一维电解质平板。\n- **变量**：$\\phi(x)$ 是电解质电势，$\\boldsymbol{i}$ 是电流密度矢量。\n- **常数和参数**：$\\kappa$ (离子电导率)，$\\phi_{\\mathrm{m}}$ (金属电势)，$\\phi_{\\infty}$ (远场电势)，$j_{0}$ (交换电流密度)，$\\alpha_{\\mathrm{a}}$ (阳极传递系数)，$\\alpha_{\\mathrm{c}}$ (阴极传递系数)，$F$ (法拉第常数)，$R$ (通用气体常数)，$T$ (绝对温度)，$E_{\\mathrm{eq}}$ (平衡电势)。\n- **控制方程**：\n    - 电荷守恒：$\\nabla \\cdot \\boldsymbol{i} = 0$。\n    - 本构关系 (欧姆定律)：$\\boldsymbol{i} = -\\kappa \\nabla \\phi$。\n- **边界条件**：\n    - 在 $x=L$ 处：$\\phi(L) = \\phi_{\\infty}$。\n    - 在 $x=0$ 处：Butler-Volmer 动力学，$-\\boldsymbol{n} \\cdot \\boldsymbol{i} = j_{0} \\left( \\exp\\left(\\frac{\\alpha_{\\mathrm{a}}F\\eta}{RT}\\right) - \\exp\\left(-\\frac{\\alpha_{\\mathrm{c}}F\\eta}{RT}\\right) \\right)$，其中 $\\boldsymbol{n}$ 是从电解质指向外部的单位法向量。\n- **定义**：\n    - 过电势：$\\eta = \\phi_{\\mathrm{m}} - \\phi(0) - E_{\\mathrm{eq}}$。\n    - 在 $x=0$ 处的向外法向量：对于域 $[0,L]$，$\\boldsymbol{n} = -\\hat{\\mathbf{x}}$。\n- **无量纲化**：\n    - 标度：$V_{T} = \\frac{RT}{F}$ (电势)，$L$ (长度)，$\\frac{\\kappa V_{T}}{L}$ (电流)。\n    - 无量纲变量：$u = \\frac{\\phi}{V_{T}}$，$\\xi = \\frac{x}{L}$，$U_{\\mathrm{m}} = \\frac{\\phi_{\\mathrm{m}}}{V_{T}}$，$U_{\\infty} = \\frac{\\phi_{\\infty}}{V_{T}}$，$U_{\\mathrm{eq}} = \\frac{E_{\\mathrm{eq}}}{V_{T}}$。\n    - 无量纲参数：$\\Lambda = \\frac{j_{0}L}{\\kappa V_{T}}$。\n- **任务**：\n    1. 推导无量纲弱形式。\n    2. 将其特化为在 $[0,1]$ 上具有本质边界条件 $u(1)=0$ 的单个线性有限元。\n    3. 证明离散化产生一个关于斜率 $A = \\frac{du}{d\\xi}$ 的标量非线性方程。\n    4. 证明无量纲边界电流密度为 $j^{\\ast} = -A$。\n    5. 为标量方程实现一个牛顿法求解器。\n    6. 为四个指定的测试用例计算 $j^{\\ast}$。\n\n### 步骤 2：使用提取的给定信息进行验证\n- **科学依据**：该问题描述了电化学中一个标准的二次电流分布模型。控制方程是关于电势的拉普拉斯方程，耦合到一个由 Butler-Volmer 方程描述的罗宾边界条件。这是一个基础且完善的模型。\n- **良态性 (Well-Posed)**：该问题是一个一维边值问题，一端 ($x=L$) 有狄利克雷条件，另一端 ($x=0$) 有罗宾条件。这种配置在数学上是良态的。指令中设置 $u(1)=0$ 是一个有效的参考电势选择，它在不失一般性的前提下简化了电流计算问题。\n- **客观性**：问题以精确的数学和科学语言陈述，没有歧义或主观性。\n- **缺陷清单**：该问题没有违反任何无效性标准。它在科学上是合理的、可形式化的、完整的、可行的、良态的且并非无足轻重。无量纲化方案是标准做法，后续任务为该问题的有限元分析勾勒了一条逻辑路径。\n\n### 步骤 3：结论和行动\n该问题有效。我将继续推导解决方案。\n\n### 推导和求解\n\n该问题需要从物理定律出发，经过无量纲化、弱形式的构建、有限元方法的离散化，最后到数值实现的系统性推导。\n\n**1. 无量纲控制方程**\n\n在一维情况下，由于 $\\kappa$ 是常数，控制方程 $\\nabla \\cdot \\boldsymbol{i} = 0$ 和 $\\boldsymbol{i} = -\\kappa \\nabla \\phi$ 合并为关于电势 $\\phi(x)$ 的拉普拉斯方程：\n$$\n\\frac{d}{dx} \\left( -\\kappa \\frac{d\\phi}{dx} \\right) = 0 \\implies \\frac{d^2\\phi}{dx^2} = 0\n$$\n我们引入无量纲变量 $u = \\phi/V_T$ 和 $\\xi = x/L$。导数变换如下：\n$$\n\\frac{d\\phi}{dx} = \\frac{d(V_T u)}{d(L\\xi)} = \\frac{V_T}{L} \\frac{du}{d\\xi}\n$$\n$$\n\\frac{d^2\\phi}{dx^2} = \\frac{d}{d(L\\xi)} \\left( \\frac{V_T}{L} \\frac{du}{d\\xi} \\right) = \\frac{V_T}{L^2} \\frac{d^2u}{d\\xi^2}\n$$\n因此，无量纲形式的控制方程是：\n$$\n\\frac{V_T}{L^2} \\frac{d^2u}{d\\xi^2} = 0 \\implies \\frac{d^2u}{d\\xi^2} = 0 \\quad \\text{对于 } \\xi \\in (0, 1)\n$$\n接下来，我们对边界条件进行无量纲化。远场条件 $\\phi(L) = \\phi_{\\infty}$ 变为 $u(1) = \\phi(L)/V_T = \\phi_{\\infty}/V_T = U_{\\infty}$。问题指定使用本质边界条件 $u(1)=0$，这设定了参考电势。\n\n在 $x=0$ 处的 Butler-Volmer 边界条件是 $-\\boldsymbol{n} \\cdot \\boldsymbol{i} = j_{\\text{rxn}}$。在 $x=0$ 处，从电解质域 $[0,L]$ 指向外部的法向量是 $\\boldsymbol{n} = -\\hat{\\mathbf{x}}$。电流密度是 $\\boldsymbol{i} = i_x \\hat{\\mathbf{x}}$。因此，$-\\boldsymbol{n} \\cdot \\boldsymbol{i} = -(-\\hat{\\mathbf{x}}) \\cdot (i_x \\hat{\\mathbf{x}}) = i_x$。电极处的电流是 $i_x(0) = -\\kappa \\frac{d\\phi}{dx}\\big|_{x=0}$。动力学表达式为：\n$$\n-\\kappa \\frac{d\\phi}{dx}\\bigg|_{x=0} = j_0 \\left( \\exp\\left(\\frac{\\alpha_{\\mathrm{a}}F\\eta}{RT}\\right) - \\exp\\left(-\\frac{\\alpha_{\\mathrm{c}}F\\eta}{RT}\\right) \\right)\n$$\n无量纲过电势 $\\eta^\\ast$ 是：\n$$\n\\eta^\\ast = \\frac{F\\eta}{RT} = \\frac{\\eta}{V_T} = \\frac{\\phi_{\\mathrm{m}} - \\phi(0) - E_{\\mathrm{eq}}}{V_T} = U_{\\mathrm{m}} - u(0) - U_{\\mathrm{eq}}\n$$\n将无量纲变量代入动力学边界条件：\n$$\n-\\kappa \\left(\\frac{V_T}{L} \\frac{du}{d\\xi}\\bigg|_{\\xi=0}\\right) = j_0 \\left( \\exp(\\alpha_{\\mathrm{a}} \\eta^\\ast) - \\exp(-\\alpha_{\\mathrm{c}} \\eta^\\ast) \\right)\n$$\n两边除以电流标度 $\\kappa V_T/L$，得到在 $\\xi=0$ 处的无量纲边界条件：\n$$\n-\\frac{du}{d\\xi}\\bigg|_{\\xi=0} = \\frac{j_0 L}{\\kappa V_T} \\left( \\exp(\\alpha_{\\mathrm{a}} \\eta^\\ast) - \\exp(-\\alpha_{\\mathrm{c}} \\eta^\\ast) \\right)\n$$\n使用无量纲参数 $\\Lambda = \\frac{j_0 L}{\\kappa V_T}$，我们得到：\n$$\n-\\frac{du}{d\\xi}\\bigg|_{\\xi=0} = \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - u(0) - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrm{m}} - u(0) - U_{\\mathrm{eq}})) \\right)\n$$\n无量纲电流密度为 $j^\\ast = i_x / (\\kappa V_T/L) = (-\\kappa \\frac{d\\phi}{dx}) / (\\kappa V_T/L) = -\\frac{d\\phi/dx}{V_T/L} = -\\frac{du}{d\\xi}$。因此，$\\xi=0$ 处的边界条件将边界电流密度 $j^\\ast(0)$ 与动力学速率表达式等同起来。\n\n**2. 变分 (弱) 形式**\n\n为了推导弱形式，我们将无量纲偏微分方程乘以一个检验函数 $w(\\xi)$，并在域 $\\xi \\in [0,1]$ 上积分：\n$$\n\\int_0^1 w \\frac{d^2u}{d\\xi^2} d\\xi = 0\n$$\n应用分部积分 ($\\int_a^b f g' = [fg]_a^b - \\int_a^b f' g$)：\n$$\n\\left[ w \\frac{du}{d\\xi} \\right]_0^1 - \\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi = 0\n$$\n展开边界项：\n$$\nw(1) \\frac{du}{d\\xi}\\bigg|_{\\xi=1} - w(0) \\frac{du}{d\\xi}\\bigg|_{\\xi=0} - \\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi = 0\n$$\n在有限元方法中，检验函数 $w$ 必须属于一个函数空间，在该空间中，函数在施加本质 (狄利克雷) 边界条件的地方为零。由于 $u(1)=0$ 是一个本质条件，我们要求 $w(1)=0$。方程简化为：\n$$\n-w(0) \\frac{du}{d\\xi}\\bigg|_{\\xi=0} - \\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi = 0\n$$\n我们用自然 (罗宾) 边界条件替换 $\\frac{du}{d\\xi}\\big|_{\\xi=0}$ 项。重新整理动力学表达式得到 $\\frac{du}{d\\xi}\\big|_{\\xi=0} = -\\Lambda(\\dots)$。\n$$\n-w(0) \\left[ - \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} \\eta^\\ast) - \\exp(-\\alpha_{\\mathrm{c}} \\eta^\\ast) \\right) \\right] - \\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi = 0\n$$\n最终的弱形式是：找到 $u(\\xi)$ 使得 $u(1)=0$，并且对于所有满足 $w(1)=0$ 的检验函数 $w(\\xi)$，下式成立：\n$$\n\\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi - w(0) \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - u(0) - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrmm} - u(0) - U_{\\mathrm{eq}})) \\right) = 0\n$$\n\n**3. 有限元离散化**\n\n我们用一个线性单元离散化域 $[0,1]$。节点位于 $\\xi_0=0$ 和 $\\xi_1=1$。线性基函数是 $N_0(\\xi) = 1-\\xi$ 和 $N_1(\\xi) = \\xi$。\n电势 $u(\\xi)$ 的有限元逼近是 $u_h(\\xi) = U_0 N_0(\\xi) + U_1 N_1(\\xi)$，其中 $U_0$ 和 $U_1$ 是 $u$ 在 $\\xi=0$ 和 $\\xi=1$ 处的节点值。\n本质边界条件 $u(1)=0$ 意味着 $U_1=0$。逼近变为：\n$$\nu_h(\\xi) = U_0 (1-\\xi)\n$$\n检验函数 $w$ 从对应于自由节点的基函数中选取。唯一的自由节点在 $\\xi=0$ 处，所以我们选择 $w(\\xi) = N_0(\\xi) = 1-\\xi$。\n我们计算弱形式所需的各项：\n- $u_h(0) = U_0$\n- $w(0) = 1$\n- $\\frac{du_h}{d\\xi} = -U_0$\n- $\\frac{dw}{d\\xi} = -1$\n将这些代入弱形式：\n$$\n\\int_0^1 (-1)(-U_0) d\\xi - (1) \\cdot \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - U_0 - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrmm} - U_0 - U_{\\mathrm{eq}})) \\right) = 0\n$$\n计算积分：$\\int_0^1 U_0 d\\xi = U_0$。\n离散化后的方程成为关于未知节点值 $U_0$ 的标量非线性方程：\n$$\nU_0 - \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - U_0 - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrmc} (U_{\\mathrmm} - U_0 - U_{\\mathrm{eq}})) \\right) = 0\n$$\n\n**4. 斜率 $A$ 和电流密度 $j^\\ast$ 的方程**\n\n问题要求一个用斜率 $A = \\frac{du}{d\\xi}$ 表示的方程。对于我们的线性逼近，斜率是常数：$A = \\frac{du_h}{d\\xi} = -U_0$。这意味着 $U_0 = -A$。\n将 $U_0 = -A$ 代入标量方程：\n$$\n(-A) - \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - (-A) - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrmm} - (-A) - U_{\\mathrm{eq}})) \\right) = 0\n$$\n整理后得到关于 $A$ 的最终非线性方程：\n$$\nA + \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrmm} + A - U_{\\mathrm{eq}})) \\right) = 0\n$$\n在 $\\xi=0$ 处的无量纲边界电流密度定义为 $j^\\ast = -\\frac{du}{d\\xi}\\big|_{\\xi=0}$。在我们的逼近下，$\\frac{du_h}{d\\xi}\\big|_{\\xi=0} = A$。因此，$j^\\ast = -A$。\n\n**5. 标量残差的牛顿法**\n\n我们需要找到残差函数 $f(A)$ 的根：\n$$\nf(A) = A + \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) \\right)\n$$\n牛顿-拉夫逊方法迭代更新解的猜测值 $A_k$：$A_{k+1} = A_k - \\frac{f(A_k)}{f'(A_k)}$。\n$f(A)$ 的导数 (雅可比矩阵) 是：\n$$\nf'(A) = \\frac{d f}{d A} = 1 + \\Lambda \\left( \\alpha_{\\mathrm{a}} \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) + \\alpha_{\\mathrm{c}} \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) \\right)\n$$\n对于具有物理意义的参数 ($\\Lambda, \\alpha_{\\mathrm{a}}, \\alpha_{\\mathrm{c}} > 0$)，这个导数总是正的，这确保了 $f(A)$ 是 $A$ 的一个单调递增函数。这保证了根的唯一性和牛顿法的稳健收敛。我们将实现此算法来为每个测试用例求解 $A$，然后报告 $j^\\ast = -A$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_for_j_star(Lambda, alpha_a, alpha_c, U_m, U_eq):\n    \"\"\"\n    Solves the scalar nonlinear equation for the slope A using Newton's method,\n    and returns the dimensionless boundary current density j_star = -A.\n\n    The equation to solve for A is f(A) = 0, where:\n    f(A) = A + Lambda * (exp(alpha_a * (U_m + A - U_eq)) - exp(-alpha_c * (U_m + A - U_eq)))\n    \"\"\"\n    \n    # Define the residual function f(A) and its derivative f'(A)\n    # Let C = U_m - U_eq for brevity in the expressions\n    C = U_m - U_eq\n    \n    def f(A_val):\n        term1 = np.exp(alpha_a * (C + A_val))\n        term2 = np.exp(-alpha_c * (C + A_val))\n        return A_val + Lambda * (term1 - term2)\n\n    def f_prime(A_val):\n        term1 = alpha_a * np.exp(alpha_a * (C + A_val))\n        term2 = alpha_c * np.exp(-alpha_c * (C + A_val))\n        return 1.0 + Lambda * (term1 + term2)\n\n    # Newton's method settings\n    A = 0.0  # Initial guess for A\n    tol = 1e-12\n    max_iter = 100\n\n    for i in range(max_iter):\n        residual = f(A)\n        if abs(residual)  tol:\n            break\n        \n        jacobian = f_prime(A)\n        # Avoid division by zero, although jacobian is always > 1 here\n        if jacobian == 0:\n            # This case is not expected for this problem\n            raise RuntimeError(\"Jacobian is zero, Newton's method failed.\")\n            \n        A_next = A - residual / jacobian\n        \n        if abs(A_next - A)  tol:\n            A = A_next\n            break\n            \n        A = A_next\n    else:\n        # This part is reached if the loop completes without convergence\n        raise RuntimeError(f\"Newton's method did not converge within {max_iter} iterations.\")\n\n    # The dimensionless current density is j_star = -A\n    j_star = -A\n    return j_star\n\ndef solve():\n    \"\"\"\n    Defines the test cases, solves for the dimensionless boundary current density for each,\n    and prints the results in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Lambda, alpha_a, alpha_c, U_m, U_eq)\n    test_cases = [\n        (0.778, 0.5, 0.5, 0.3, 0.0),\n        (0.01, 0.5, 0.5, 0.3, 0.0),\n        (5.0, 0.5, 0.5, 0.3, 0.0),\n        (0.8, 0.7, 0.3, 0.2, -0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        Lambda, alpha_a, alpha_c, U_m, U_eq = case\n        j_star = solve_for_j_star(Lambda, alpha_a, alpha_c, U_m, U_eq)\n        results.append(j_star)\n\n    # Final print statement in the exact required format.\n    # Using a format specifier to avoid excessive precision/scientific notation.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "计算模型的一个关键应用是解释实验数据并估计物理参数，这构成了所谓的“逆向问题”。本练习将带您探讨这一高级主题。您将学习如何评估模型参数（如交换电流密度和电荷传递系数之和）是否可以从测量数据中唯一确定，并引入费雪信息矩阵（Fisher Information Matrix）这一强大工具来分析参数的可辨识性，这个实践揭示了模型构建与实验设计之间的重要联系。",
            "id": "4256675",
            "problem": "考虑电解质中一个平面电极表面的二次电流分布的一维离散化，其中电解质电势沿表面通过横向传导耦合，并通过纵向传导与远处的对电极耦合。设有 $N$ 个等距表面节点，由 $i \\in \\{1,2,\\dots,N\\}$ 索引，其未知的电解质表面电势为 $ \\phi_i $。横向耦合通过沿表面的离散拉普拉斯算子建模，纵向耦合通过泄漏到零参考电势来建模。电极保持在均匀的表面电势 $E_s$ 下，节点 $i$ 的局部过电势为 $ \\eta_i = E_s - \\phi_i $。在小过电势下，应用线性化的 Butler–Volmer 关系：\n$$\nj_i = i_0 \\left(\\alpha_a + \\alpha_c\\right) \\frac{F}{R T} \\eta_i,\n$$\n其中 $j_i$ 是节点 $i$ 的反应电流密度，$i_0$ 是交换电流密度，$\\alpha_a$ 和 $\\alpha_c$ 是阳极和阴极电荷转移系数，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度。定义动力学增益\n$$\nG = i_0 \\, \\left(\\alpha_a + \\alpha_c\\right) \\, \\gamma, \\quad \\text{其中} \\quad \\gamma = \\frac{F}{R T}.\n$$\n令离散的横向和纵向电解质电导分别由正常数 $R_l$ 和 $R_v$ 表示（在本数值模型中，两者均被视为有效电阻）。每个节点的电荷守恒平衡了反应电流密度与横向和纵向传导之和：\n$$\nG \\left(E_s - \\phi_i\\right) = \\frac{\\phi_i}{R_v} + \\frac{a_i \\phi_i - \\phi_{i-1} - \\phi_{i+1}}{R_l},\n$$\n其中对于内部节点（$2 \\leq i \\leq N-1$），$a_i = 2$；在端点，$a_1 = a_N = 1$；超出范围索引的项被省略。以向量形式，定义 $N \\times N$ 的三对角矩阵 $L$，其对角线元素为 $a_i$，上、次对角线元素为 $-1$，以及单位矩阵 $I$。那么该系统变为\n$$\n\\left(\\frac{1}{R_v} I + \\frac{1}{R_l} L + G I\\right) \\boldsymbol{\\phi} = G E_s \\boldsymbol{1},\n$$\n其中 $ \\boldsymbol{\\phi} = [\\phi_1,\\dots,\\phi_N]^T $ 并且 $ \\boldsymbol{1} $ 是全为1的向量。空间反应电流密度的正向模型为\n$$\n\\boldsymbol{j} = G \\left(E_s \\boldsymbol{1} - \\boldsymbol{\\phi}\\right).\n$$\n您观测到的是被加性独立高斯噪声（每个分量的方差为 $ \\sigma^2 $）污染的空间分辨测量值 $ \\boldsymbol{j} $。对于由 $k$ 索引的多个实验，其 $E_s^{(k)}$ 和 $T^{(k)}$ 可能不同（因此 $\\gamma^{(k)}$ 和 $G^{(k)} = i_0 s \\gamma^{(k)}$ 也不同，其中 $s = \\alpha_a + \\alpha_c$），您将所有跨节点和实验的测量值堆叠成一个单一向量。未知参数向量为 $ \\boldsymbol{p} = [i_0, s]^T $。\n\n从电解质中的欧姆定律和电荷守恒出发，并利用边界处小过电势下的线性化 Butler–Volmer 动力学，推导正向模型关于在给定 $(i_0, s)$ 处求值的 $ \\boldsymbol{p} $ 的雅可比矩阵 $J$，以及高斯噪声下的费雪信息矩阵（Fisher Information Matrix (FIM)）：\n$$\nF = \\frac{1}{\\sigma^2} J^T J.\n$$\n使用逆矩阵求导的恒等式 $ \\frac{d}{dG} M^{-1} = - M^{-1} \\left(\\frac{dM}{dG}\\right) M^{-1} $，其中 $ M = \\frac{1}{R_v} I + \\frac{1}{R_l} L + G I $。展示如何计算 $ \\frac{\\partial \\boldsymbol{j}}{\\partial G} $ 而无需数值微分，然后通过链式法则对每个实验获得 $ \\frac{\\partial \\boldsymbol{j}}{\\partial i_0 } $ 和 $ \\frac{\\partial \\boldsymbol{j}}{\\partial s } $。\n\n设计一个算法，针对下面的每个测试案例，构建 $L$，求解每个实验的正向模型，通过堆叠所有实验和节点的雅可比矩阵来建立 $J$，形成 $F$，并返回一个布尔值，指示 $F$ 是否具有满秩 $2$（意味着在给定的小过电势模型和测量设置下，两个参数都是局部可辨识的）。使用基于 $F$ 特征值的数值秩检验，其相对阈值与最大特征值相关，以判断是否满秩。\n\n测试套件：\n- 案例1（单一小过电势，单一温度）：\n    - $N = 10$, $R_v = 5.0$, $R_l = 1.0$, $E_s^{(1)} = 0.010$ (伏特), $T^{(1)} = 298$ (开尔文),\n    - $i_0 = 1.5$, $s = 1.2$, $\\sigma = 0.001$.\n- 案例2（多个小过电势，单一温度）：\n    - $N = 25$, $R_v = 2.0$, $R_l = 0.5$, $(E_s^{(1)}, E_s^{(2)}, E_s^{(3)}) = (0.005, 0.010, 0.020)$ (伏特), $T^{(1)} = T^{(2)} = T^{(3)} = 298$ (开尔文),\n    - $i_0 = 1.5$, $s = 1.2$, $\\sigma = 0.0005$.\n- 案例3（两种温度下相同的小过电势）：\n    - $N = 15$, $R_v = 10.0$, $R_l = 2.0$, $(E_s^{(1)}, E_s^{(2)}) = (0.010, 0.010)$ (伏特), $(T^{(1)}, T^{(2)}) = (298, 333)$ (开尔文),\n    - $i_0 = 2.0$, $s = 1.0$, $\\sigma = 0.0015$.\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”），其中每个结果是对应案例的布尔值结果，指示费雪信息矩阵是否具有满秩 $2$。由于输出是布尔值，因此不应打印任何物理单位。计算必须是自包含的，并在正向模型中使用常数 $F = 96485$ 和 $R = 8.314$。",
            "solution": "用户提供了一个科学上合理、适定且客观的问题。它描述了一个电化学中二次电流分布的标准模型，并要求使用费雪信息矩阵进行参数可辨识性分析。所有参数、常数和方程都已明确定义，构成一个自包含且可解的问题。该问题是将数值建模、灵敏度分析和统计推断原理应用于物理系统的有效练习。\n\n### 理论推导与分析\n\n目标是确定参数 $\\boldsymbol{p} = [i_0, s]^T$ 是否能从电流密度向量 $\\boldsymbol{j}$ 的测量中局部辨识。这通过分析费雪信息矩阵（FIM）的秩来实现。我们首先推导正向模型的雅可比矩阵，该矩阵将参数 $\\boldsymbol{p}$ 映射到可观测量 $\\boldsymbol{j}$。为清晰起见，我们将首先考虑单个实验，并省略实验索引 $(k)$。\n\n正向模型由两个主要方程组成：\n1.  电解质电势 $\\boldsymbol{\\phi}$ 的线性系统：\n    $$\n    M \\boldsymbol{\\phi} = G E_s \\boldsymbol{1} \\quad \\text{其中} \\quad M = \\left(\\frac{1}{R_v} + G\\right)I + \\frac{1}{R_l} L\n    $$\n    由此，我们可以将 $\\boldsymbol{\\phi}$ 表示为 $\\boldsymbol{\\phi} = M^{-1} G E_s \\boldsymbol{1}$。\n\n2.  反应电流密度 $\\boldsymbol{j}$ 的表达式：\n    $$\n    \\boldsymbol{j} = G (E_s \\boldsymbol{1} - \\boldsymbol{\\phi})\n    $$\n\n我们关注的参数 $i_0$ 和 $s$ 通过动力学增益 $G = i_0 s \\gamma$（其中 $\\gamma = F/(RT)$）影响模型。求关于 $i_0$ 和 $s$ 的导数的最直接途径是首先求关于 $G$ 的导数，然后应用链式法则。\n\n**$\\boldsymbol{j}$ 对 $G$ 的导数：**\n\n我们从对 $\\boldsymbol{\\phi}$ 关于 $G$ 求导开始：\n$$\n\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G} = \\frac{\\partial}{\\partial G} \\left( M^{-1} G E_s \\boldsymbol{1} \\right) = \\left(\\frac{\\partial M^{-1}}{\\partial G}\\right) (G E_s \\boldsymbol{1}) + M^{-1} \\frac{\\partial}{\\partial G}(G E_s \\boldsymbol{1})\n$$\n矩阵 $M$ 对 $G$ 的导数是 $\\frac{\\partial M}{\\partial G} = \\frac{\\partial}{\\partial G} \\left( (\\frac{1}{R_v}I + \\frac{1}{R_l}L) + GI \\right) = I$。使用所提供的逆矩阵求导恒等式 $\\frac{d}{dG} M^{-1} = -M^{-1} (\\frac{dM}{dG}) M^{-1}$：\n$$\n\\frac{\\partial M^{-1}}{\\partial G} = -M^{-1} (I) M^{-1} = -M^{-2}\n$$\n右侧项的导数是 $\\frac{\\partial}{\\partial G}(G E_s \\boldsymbol{1}) = E_s \\boldsymbol{1}$。将这些代入 $\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G}$ 的表达式中：\n$$\n\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G} = -M^{-2} (G E_s \\boldsymbol{1}) + M^{-1} (E_s \\boldsymbol{1})\n$$\n认识到 $\\boldsymbol{\\phi} = M^{-1}(G E_s \\boldsymbol{1})$，我们可以写出 $M^{-1} \\boldsymbol{\\phi} = M^{-2}(G E_s \\boldsymbol{1})$。这简化了表达式为：\n$$\n\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G} = -M^{-1} \\boldsymbol{\\phi} + M^{-1} (E_s \\boldsymbol{1}) = M^{-1} (E_s \\boldsymbol{1} - \\boldsymbol{\\phi})\n$$\n现在，我们使用乘积法则对 $\\boldsymbol{j} = G E_s \\boldsymbol{1} - G\\boldsymbol{\\phi}$ 关于 $G$ 求导：\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial G} = E_s \\boldsymbol{1} - \\left( \\frac{\\partial G}{\\partial G} \\boldsymbol{\\phi} + G \\frac{\\partial \\boldsymbol{\\phi}}{\\partial G} \\right) = E_s \\boldsymbol{1} - \\boldsymbol{\\phi} - G \\frac{\\partial \\boldsymbol{\\phi}}{\\partial G}\n$$\n代入我们关于 $\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G}$ 的结果：\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial G} = (E_s \\boldsymbol{1} - \\boldsymbol{\\phi}) - G \\left( M^{-1} (E_s \\boldsymbol{1} - \\boldsymbol{\\phi}) \\right) = (I - G M^{-1})(E_s \\boldsymbol{1} - \\boldsymbol{\\phi})\n$$\n这提供了一种计算电流密度对动力学增益 $G$ 灵敏度的方法，而无需借助数值微分。\n\n**链式法则与雅可比矩阵构建：**\n\n使用链式法则，我们可以求出 $\\boldsymbol{j}$ 关于模型参数 $i_0$ 和 $s$ 的导数。\n$G = i_0 s \\gamma$ 的偏导数为：\n$$\n\\frac{\\partial G}{\\partial i_0} = s \\gamma \\quad \\text{和} \\quad \\frac{\\partial G}{\\partial s} = i_0 \\gamma\n$$\n因此，单个实验的雅可比矩阵的列为：\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial i_0} = \\frac{\\partial \\boldsymbol{j}}{\\partial G} \\frac{\\partial G}{\\partial i_0} = (s \\gamma) \\frac{\\partial \\boldsymbol{j}}{\\partial G}\n$$\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial s} = \\frac{\\partial \\boldsymbol{j}}{\\partial G} \\frac{\\partial G}{\\partial s} = (i_0 \\gamma) \\frac{\\partial \\boldsymbol{j}}{\\partial G}\n$$\n一个直接且关键的观察是，雅可比矩阵的两列是线性相关的：\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial s} = \\frac{i_0}{s} \\frac{\\partial \\boldsymbol{j}}{\\partial i_0}\n$$\n这种共线性是该特定模型结构的基础。当执行多个实验（由 $k$ 索引）时，完整的雅可比矩阵 $J$ 是通过垂直堆叠各个实验的雅可比矩阵 $J^{(k)}$ 形成的。完整的雅可比矩阵的列向量，代表所有测量值对 $i_0$ 和 $s$ 的灵敏度，将是 $\\boldsymbol{v}_{i_0}$ 和 $\\boldsymbol{v}_s$。这些向量中对应于实验 $k$ 的每个块都保持相同的共线性关系。因此，完整的列向量也保持线性相关：$\\boldsymbol{v}_s = (i_0/s) \\boldsymbol{v}_{i_0}$。\n\n**费雪信息矩阵与参数可辨识性：**\n\n费雪信息矩阵是 $F = \\frac{1}{\\sigma^2} J^T J$。由于 $J$ 的列是线性相关的，所以 $J$ 的秩最多为 $1$（假设灵敏度非零）。矩阵秩的一个性质是 $\\text{rank}(J^T J) = \\text{rank}(J)$。因此，FIM 的秩最多为 $1$。要使两个参数 $[i_0, s]^T$ 可辨识，FIM 必须具有满秩，即 $2$。\n\n结构不可辨识性的出现是因为参数 $i_0$ 和 $s$ 仅以其乘积 $i_0s$ 的形式出现在模型方程中。该模型仅对集总参数 $P = i_0s$ 敏感，而对 $i_0$ 和 $s$ 各自不敏感。改变实验条件如 $E_s$ 或 $T$ 并不会打破这种数学依赖性。因此，我们预测对于所有测试案例，FIM 都将是秩亏的，算法应返回 `False`。\n\n### 算法设计\n\n该算法将遵循推导过程，为每个测试案例构建并分析 FIM。\n\n1.  **初始化**：对于每个案例，定义物理常数（$F$, $R$）和问题特定参数（$N, R_v, R_l, i_0, s, \\sigma$）。\n2.  **构建 L 矩阵**：创建 $N \\times N$ 的离散拉普拉斯矩阵 $L$，其对角线元素为 $a_i$（$a_1=a_N=1$, $a_{2..N-1}=2$），非对角线元素为 $-1$。\n3.  **遍历实验**：对于测试案例中的每个实验 $(E_s^{(k)}, T^{(k)})$：\n    a. 计算 $\\gamma^{(k)} = F / (R T^{(k)})$ 和 $G^{(k)} = i_0 s \\gamma^{(k)}$。\n    b. 构建系统矩阵 $M^{(k)} = (\\frac{1}{R_v} + G^{(k)})I + \\frac{1}{R_l} L$ 和右端向量 $\\boldsymbol{b}^{(k)} = G^{(k)} E_s^{(k)} \\boldsymbol{1}$。\n    c. 求解线性系统 $M^{(k)} \\boldsymbol{\\phi}^{(k)} = \\boldsymbol{b}^{(k)}$ 以找到电势向量 $\\boldsymbol{\\phi}^{(k)}$。\n    d. 为了计算 $\\frac{\\partial \\boldsymbol{j}^{(k)}}{\\partial G^{(k)}}$，首先求解辅助线性系统 $M^{(k)} \\boldsymbol{x}^{(k)} = (E_s^{(k)}\\boldsymbol{1} - \\boldsymbol{\\phi}^{(k)})$ 以求得 $\\boldsymbol{x}^{(k)}$。注意 $\\boldsymbol{x}^{(k)} = (M^{(k)})^{-1} (E_s^{(k)}\\boldsymbol{1} - \\boldsymbol{\\phi}^{(k)})$。\n    e. 计算灵敏度向量 $\\boldsymbol{d_G}^{(k)} = \\frac{\\partial \\boldsymbol{j}^{(k)}}{\\partial G^{(k)}} = (E_s^{(k)}\\boldsymbol{1} - \\boldsymbol{\\phi}^{(k)}) - G^{(k)} \\boldsymbol{x}^{(k)}$。\n    f. 使用链式法则找到该实验的雅可比矩阵的列：$\\frac{\\partial \\boldsymbol{j}^{(k)}}{\\partial i_0} = (s \\gamma^{(k)}) \\boldsymbol{d_G}^{(k)}$ 和 $\\frac{\\partial \\boldsymbol{j}^{(k)}}{\\partial s} = (i_0 \\gamma^{(k)}) \\boldsymbol{d_G}^{(k)}$。\n    g. 存储得到的 $N \\times 2$ 矩阵 $J^{(k)}$。\n4.  **组装全局矩阵**：垂直堆叠所有 $J^{(k)}$ 矩阵以形成全局雅可比矩阵 $J$。\n5.  **计算 FIM**：计算费雪信息矩阵 $F = \\frac{1}{\\sigma^2} J^T J$。\n6.  **秩检验**：计算 $2 \\times 2$ 对称矩阵 F 的两个特征值。令它们为 $\\lambda_{max}$ 和 $\\lambda_{min}$。如果两个特征值都为正且它们的比率 $\\lambda_{min} / \\lambda_{max}$ 大于一个小的数值容差（例如 $10^{-10}$），则矩阵具有满秩。\n7.  **输出**：将秩检验的布尔结果追加到一个列表中。处理完所有案例后，按指定格式打印列表。根据前面的分析，所有案例的预期结果都是 `False`。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the rank of the Fisher Information Matrix (FIM) for three test cases\n    of an electrochemical model.\n    \"\"\"\n    F_CONST = 96485.0  # Faraday constant in C/mol\n    R_CONST = 8.314    # Universal gas constant in J/(mol*K)\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"N\": 10, \"Rv\": 5.0, \"Rl\": 1.0, \"i0\": 1.5, \"s\": 1.2, \"sigma\": 0.001,\n            \"experiments\": [(0.010, 298.0)]\n        },\n        {\n            \"N\": 25, \"Rv\": 2.0, \"Rl\": 0.5, \"i0\": 1.5, \"s\": 1.2, \"sigma\": 0.0005,\n            \"experiments\": [(0.005, 298.0), (0.010, 298.0), (0.020, 298.0)]\n        },\n        {\n            \"N\": 15, \"Rv\": 10.0, \"Rl\": 2.0, \"i0\": 2.0, \"s\": 1.0, \"sigma\": 0.0015,\n            \"experiments\": [(0.010, 298.0), (0.010, 333.0)]\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        Rv = case[\"Rv\"]\n        Rl = case[\"Rl\"]\n        i0 = case[\"i0\"]\n        s_param = case[\"s\"]\n        sigma = case[\"sigma\"]\n        experiments = case[\"experiments\"]\n        \n        # Construct the discrete Laplacian matrix L\n        diag_L = np.full(N, 2.0)\n        diag_L[0] = 1.0\n        diag_L[N-1] = 1.0\n        L = np.diag(diag_L) - np.diag(np.ones(N-1), k=1) - np.diag(np.ones(N-1), k=-1)\n\n        J_list = []\n\n        for Es, T in experiments:\n            # Step 1: Calculate model-dependent constants for the experiment\n            gamma = F_CONST / (R_CONST * T)\n            G = i0 * s_param * gamma\n\n            # Step 2: Assemble and solve the forward model for phi\n            I = np.identity(N)\n            M = (1.0/Rv + G) * I + (1.0/Rl) * L\n            b = G * Es * np.ones(N)\n            \n            # This check is for numerical stability, though M is guaranteed to be\n            # positive definite for positive physical parameters.\n            if np.linalg.cond(M) > 1/np.finfo(M.dtype).eps:\n                # Handle ill-conditioned matrix if it occurs, though unlikely here\n                # For this problem, we can assume it's always solvable\n                pass\n\n            phi = np.linalg.solve(M, b)\n\n            # Step 3: Compute the sensitivity of j w.r.t. G\n            eta_vec = Es * np.ones(N) - phi\n            \n            # To compute (I - G * M_inv) * eta_vec, we first find M_inv * eta_vec\n            # by solving another linear system to avoid explicit inversion.\n            # M * x = eta_vec\n            x = np.linalg.solve(M, eta_vec)\n            \n            djdG = eta_vec - G * x\n            \n            # Step 4: Use chain rule to get sensitivities w.r.t. i0 and s\n            djd_di0 = (s_param * gamma) * djdG\n            djd_ds = (i0 * gamma) * djdG\n            \n            # Form the Jacobian for this experiment\n            J_k = np.vstack((djd_di0, djd_ds)).T\n            J_list.append(J_k)\n\n        # Step 5: Stack Jacobians from all experiments\n        J_total = np.vstack(J_list)\n\n        # Step 6: Compute the Fisher Information Matrix (FIM)\n        FIM = (1.0 / sigma**2) * (J_total.T @ J_total)\n        \n        # Step 7: Perform rank test using eigenvalues\n        # FIM is a 2x2 symmetric positive semi-definite matrix.\n        # Its eigenvalues are real and non-negative.\n        eigenvalues = np.linalg.eigvalsh(FIM)\n        lambda_min, lambda_max = eigenvalues[0], eigenvalues[1]\n        \n        has_full_rank = False\n        # To have full rank 2, both eigenvalues must be significantly greater than zero.\n        # We check if the smaller eigenvalue is non-negligible compared to the larger one.\n        if lambda_max > 1e-12: # Avoid division by zero if FIM is all zeros\n            # A relative tolerance is used for the rank test.\n            # If the ratio is very small, the matrix is numerically rank-deficient.\n            if (lambda_min / lambda_max) > 1e-10:\n                has_full_rank = True\n        \n        results.append(has_full_rank)\n        \n    print(f\"[{','.join(map(str, [r for r in results]))}]\".lower())\n\nsolve()\n```"
        }
    ]
}