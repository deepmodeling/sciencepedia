{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex numerical simulations, it is essential to build intuition with analytical solutions. This first practice focuses on the high-overpotential or \"Tafel\" regime, where the Butler–Volmer kinetics simplify to a pure exponential relationship between current and overpotential. By working through this derivation, you will solidify your understanding of how a non-uniform potential distribution along an electrode can lead to an exponential variation in reaction rate and practice integrating this distribution to find the total current .",
            "id": "4256749",
            "problem": "Consider a one-dimensional, isothermal, planar electrode of length $L$ along the spatial coordinate $x \\in [0,L]$ in contact with a supporting electrolyte under the assumption of Secondary Current Distribution (SCD), meaning that concentration fields are uniform and transport in the electrolyte is governed by Ohm's law without mass-transfer limitations. Let the single-step, activation-controlled charge-transfer kinetics be described by the well-established general Butler–Volmer relation for a uniform exchange current density $j_{0}$ and a single anodic charge-transfer coefficient $\\alpha \\in (0,1)$, at absolute temperature $T$. Let $F$ denote the Faraday constant and $R$ the universal gas constant. Define the interfacial overpotential $\\eta(x)$ as the difference between the solid-phase potential $\\phi_{s}(x)$ and the solution-phase potential $\\phi_{e}(x)$ relative to the local equilibrium potential, and suppose the equilibrium potential is spatially uniform so that the entire spatial dependence enters through $\\phi_{s}(x)-\\phi_{e}(x)$.\n\nAssume the electrode is driven anodically with $\\eta(x) > 0$ for all $x \\in [0,L]$ and that the system is in the Tafel regime, i.e., $|\\eta(x)| \\gg RT/F$. Suppose further that due to the combined effect of the solid-phase ohmic drop and the electrolyte potential field under SCD, the difference $\\phi_{s}(x) - \\phi_{e}(x)$ varies linearly in space,\n$$\n\\phi_{s}(x) - \\phi_{e}(x) = \\eta_{0} + \\kappa x,\n$$\nwhere $\\eta_{0}$ and $\\kappa$ are spatially uniform constants, with $\\kappa$ allowed to be positive or negative but such that $\\eta(x)=\\eta_{0}+\\kappa x>0$ over $[0,L]$.\n\nStarting from the general Butler–Volmer kinetics and the definitions above, and using only the stated assumptions, do the following:\n\n1. Justify rigorously why, in the Tafel regime for anodic polarization, the kinetic boundary condition relating the normal interfacial current density $j(x)$ to the overpotential $\\eta(x)$ becomes effectively exponential in $\\eta(x)$, and identify the exponential sensitivity coefficient as a function of $\\alpha$, $F$, $R$, and $T$.\n\n2. Using the linear form $\\eta(x)=\\eta_{0}+\\kappa x$, derive the spatial distribution $j(x)$ along the electrode.\n\n3. Compute the total current per unit electrode depth (into the page), $I$, defined by\n$$\nI \\equiv \\int_{0}^{L} j(x)\\, dx,\n$$\nand express it as a single, closed-form analytic expression in terms of $j_{0}$, $\\alpha$, $F$, $R$, $T$, $\\eta_{0}$, $\\kappa$, and $L$.\n\nExpress the final result for $I$ as a closed-form analytic expression. If a numerical evaluation were to be performed, the unit for $I$ must be amperes per meter (A/m). Do not provide any numerical evaluation; no rounding is required.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and self-contained. It presents a standard, solvable problem in theoretical electrochemistry. All provided information is consistent and sufficient for deriving the requested quantities.\n\nThe solution proceeds in three parts as requested by the problem statement.\n\n**1. Justification of the Exponential Kinetic Boundary Condition (Tafel Equation)**\n\nThe general Butler–Volmer equation for a single-step, activation-controlled charge-transfer reaction relates the net current density $j$ to the interfacial overpotential $\\eta$. It is given by:\n$$\nj(\\eta) = j_{0} \\left( \\exp\\left(\\frac{\\alpha F \\eta}{RT}\\right) - \\exp\\left(-\\frac{(1-\\alpha) F \\eta}{RT}\\right) \\right)\n$$\nwhere $j_{0}$ is the exchange current density, $\\alpha$ is the anodic charge-transfer coefficient, $F$ is the Faraday constant, $R$ is the universal gas constant, and $T$ is the absolute temperature. The first term in the parentheses represents the anodic partial current density, and the second term represents the cathodic partial current density.\n\nThe problem specifies two conditions:\n(i) The electrode is driven anodically, which means the overpotential is positive for all $x$: $\\eta(x) > 0$.\n(ii) The system is in the Tafel regime, which means the magnitude of the overpotential is much larger than the thermal voltage scale: $|\\eta(x)| \\gg \\frac{RT}{F}$.\n\nGiven $\\eta(x) > 0$, the argument of the first exponential, $\\frac{\\alpha F \\eta(x)}{RT}$, is positive since $\\alpha \\in (0,1)$, $F>0$, $R>0$, and $T>0$. The condition $|\\eta(x)| \\gg \\frac{RT}{F}$ thus implies that $\\frac{\\alpha F \\eta(x)}{RT}$ is a large positive number. Consequently, the anodic term $\\exp\\left(\\frac{\\alpha F \\eta(x)}{RT}\\right)$ is very large compared to $1$.\n\nFor the cathodic term, the argument of the exponential is $-\\frac{(1-\\alpha) F \\eta(x)}{RT}$. Since $1-\\alpha > 0$ and $\\eta(x) > 0$, this argument is negative. The condition $|\\eta(x)| \\gg \\frac{RT}{F}$ implies that $-\\frac{(1-\\alpha) F \\eta(x)}{RT}$ is a large negative number. Consequently, the cathodic term $\\exp\\left(-\\frac{(1-\\alpha) F \\eta(x)}{RT}\\right)$ approaches zero and is negligible compared to the large anodic term.\n\nTherefore, under these conditions, the Butler–Volmer equation can be rigorously approximated by retaining only the anodic term:\n$$\nj(\\eta) \\approx j_{0} \\exp\\left(\\frac{\\alpha F \\eta}{RT}\\right)\n$$\nThis is the anodic Tafel equation. It shows that the interfacial current density $j$ becomes effectively exponential in the overpotential $\\eta$. The relationship is of the form $j \\propto \\exp(\\beta \\eta)$, where the exponential sensitivity coefficient, $\\beta$, is identified by inspection as:\n$$\n\\beta = \\frac{\\alpha F}{RT}\n$$\n\n**2. Spatial Distribution of Current Density, $j(x)$**\n\nThe problem provides a linear spatial dependence for the overpotential $\\eta(x)$, which is defined as the difference $\\phi_{s}(x) - \\phi_{e}(x)$:\n$$\n\\eta(x) = \\eta_{0} + \\kappa x\n$$\nwhere $\\eta_{0}$ and $\\kappa$ are constants.\n\nSubstituting this linear expression for $\\eta(x)$ into the anodic Tafel equation derived in the previous step gives the spatial distribution of the current density, $j(x)$, along the electrode:\n$$\nj(x) = j_{0} \\exp\\left(\\frac{\\alpha F (\\eta_{0} + \\kappa x)}{RT}\\right)\n$$\nThis expression can be rewritten to separate the spatial dependence:\n$$\nj(x) = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\exp\\left(\\frac{\\alpha F \\kappa x}{RT}\\right)\n$$\n\n**3. Calculation of Total Current, $I$**\n\nThe total current per unit electrode depth, $I$, is obtained by integrating the current density distribution $j(x)$ over the length of the electrode, from $x=0$ to $x=L$:\n$$\nI = \\int_{0}^{L} j(x) \\, dx = \\int_{0}^{L} j_{0} \\exp\\left(\\frac{\\alpha F (\\eta_{0} + \\kappa x)}{RT}\\right) \\, dx\n$$\nWe can factor out the constant terms from the integral:\n$$\nI = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\int_{0}^{L} \\exp\\left(\\frac{\\alpha F \\kappa x}{RT}\\right) \\, dx\n$$\nThe integration must be performed. We consider two cases for the constant $\\kappa$.\n\nCase 1: $\\kappa \\neq 0$\nThe integral is of the form $\\int \\exp(ax) \\, dx = \\frac{1}{a} \\exp(ax)$. Here, the constant in the exponent is $a = \\frac{\\alpha F \\kappa}{RT}$.\n$$\n\\int_{0}^{L} \\exp\\left(\\frac{\\alpha F \\kappa x}{RT}\\right) \\, dx = \\left[ \\frac{RT}{\\alpha F \\kappa} \\exp\\left(\\frac{\\alpha F \\kappa x}{RT}\\right) \\right]_{0}^{L}\n$$\nEvaluating the antiderivative at the limits of integration:\n$$\n= \\frac{RT}{\\alpha F \\kappa} \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - \\exp(0) \\right) = \\frac{RT}{\\alpha F \\kappa} \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - 1 \\right)\n$$\nSubstituting this result back into the expression for $I$:\n$$\nI = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\frac{RT}{\\alpha F \\kappa} \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - 1 \\right)\n$$\nRearranging the terms yields the final single, closed-form analytic expression for $\\kappa \\neq 0$:\n$$\nI = \\frac{j_{0} RT}{\\alpha F \\kappa} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - 1 \\right)\n$$\n\nCase 2: $\\kappa = 0$\nIf $\\kappa = 0$, the overpotential is uniform, $\\eta(x) = \\eta_{0}$, and so is the current density: $j(x) = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right)$. The integral becomes:\n$$\nI = \\int_{0}^{L} j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\, dx = j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\int_{0}^{L} dx = L j_{0} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right)\n$$\nThis result can be obtained from the general expression for $\\kappa \\neq 0$ by taking the limit as $\\kappa \\to 0$, using the fundamental limit $\\lim_{z \\to 0} \\frac{\\exp(cz)-1}{z} = c$. The problem asks for a single expression, which is conventionally the general case where the denominator is non-zero.\n\nThe final closed-form expression for $I$ in terms of the given parameters is thus the result derived for $\\kappa \\neq 0$.",
            "answer": "$$\n\\boxed{\\frac{j_{0} RT}{\\alpha F \\kappa} \\exp\\left(\\frac{\\alpha F \\eta_{0}}{RT}\\right) \\left( \\exp\\left(\\frac{\\alpha F \\kappa L}{RT}\\right) - 1 \\right)}\n$$"
        },
        {
            "introduction": "Analytical solutions are powerful but limited to simplified cases. To handle the full non-linear Butler–Volmer kinetics and complex geometries, we turn to numerical methods like the Finite Element Method (FEM). This practice guides you through the crucial steps of building a robust computational model, starting with non-dimensionalization to properly scale the variables, followed by deriving the weak form of the governing equation, and finally implementing a Newton solver to handle the non-linear boundary condition . This exercise is a practical introduction to the engine behind modern multiphysics simulation software.",
            "id": "4256781",
            "problem": "Consider a one-dimensional electrolyte slab occupying the interval $[0,L]$ with spatial coordinate $x\\in[0,L]$, constant ionic conductivity $\\kappa$, and a planar metal electrode located at $x=0$ that supports charge-transfer surface kinetics. The electrolyte potential is denoted by $\\phi(x)$, and the metal electrode is assumed to be an equipotential with metal potential $\\phi_{\\mathrm{m}}$. The far-field electrolyte potential at $x=L$ is fixed to $\\phi(L)=\\phi_{\\infty}$. The governing conservation of charge and constitutive relations in the electrolyte are given by $\\nabla\\cdot\\boldsymbol{i}=0$ and $\\boldsymbol{i}=-\\kappa\\nabla\\phi$, where $\\boldsymbol{i}$ is the current density vector and $\\kappa$ is a positive constant. The surface kinetics at the electrode are modeled by the Butler–Volmer relation $-\\boldsymbol{n}\\cdot\\boldsymbol{i}=j_{0}\\left(\\exp\\!\\left(\\dfrac{\\alpha_{\\mathrm{a}}F\\eta}{RT}\\right)-\\exp\\!\\left(-\\dfrac{\\alpha_{\\mathrm{c}}F\\eta}{RT}\\right)\\right)$, where $\\boldsymbol{n}$ is the outward unit normal from the electrolyte, $j_{0}$ is the exchange current density, $\\alpha_{\\mathrm{a}}$ is the anodic charge-transfer coefficient, $\\alpha_{\\mathrm{c}}$ is the cathodic charge-transfer coefficient, $F$ is the Faraday constant, $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\eta$ is the overpotential defined by $\\eta=\\phi_{\\mathrm{m}}-\\phi(0)-E_{\\mathrm{eq}}$, with $E_{\\mathrm{eq}}$ being the equilibrium potential of the electrode reaction.\n\nYour tasks are as follows: first, derive a consistent non-dimensional weak form for the secondary current distribution problem with surface kinetics to improve conditioning and scaling of residuals and Jacobians in multiphysics solvers; second, specialize the weak form to a single linear finite element on $[0,L]$ with an essential boundary condition $u(1)=0$ at $x=L$; third, implement a program that assembles the resulting non-dimensional residual and Jacobian and solves the resulting scalar nonlinear equation using Newton’s method to compute the dimensionless boundary current density. Throughout, you must non-dimensionalize the problem using the thermal voltage $V_{T}=\\dfrac{RT}{F}$ for potentials, the slab thickness $L$ for lengths, and the conduction scale $\\dfrac{\\kappa V_{T}}{L}$ for currents, thereby defining the dimensionless variables $u=\\dfrac{\\phi}{V_{T}}$, $\\xi=\\dfrac{x}{L}$, $U_{\\mathrm{m}}=\\dfrac{\\phi_{\\mathrm{m}}}{V_{T}}$, $U_{\\infty}=\\dfrac{\\phi_{\\infty}}{V_{T}}$, and $U_{\\mathrm{eq}}=\\dfrac{E_{\\mathrm{eq}}}{V_{T}}$. Introduce the dimensionless kinetic parameter $\\Lambda=\\dfrac{j_{0}L}{\\kappa V_{T}}$ and rewrite the boundary kinetic relation entirely in terms of dimensionless quantities. The weak form must be written with a dimensionless test function $w(\\xi)$, and the integration by parts must result in boundary terms scaled consistently with the chosen non-dimensionalization.\n\nAfter deriving the non-dimensional weak form and reducing it to a single linear basis function on the interval $[0,1]$ with $u(1)=0$, show that the discretization yields a scalar nonlinear equation for the dimensionless slope $A=\\dfrac{du}{d\\xi}$ and that the dimensionless boundary current density $j^{\\ast}$ at $\\xi=0$ is $j^{\\ast}=-\\dfrac{du}{d\\xi}\\big\\rvert_{\\xi=0}=-A$. Implement a Newton solver for the scalar residual to compute $A$ and report $j^{\\ast}$ for each test case.\n\nYour program must solve the dimensionless problem and output, for a set of specified test cases, the corresponding dimensionless boundary current densities $j^{\\ast}$ as real numbers. No physical units should appear in the output because all reported quantities are dimensionless. Use the following test suite:\n\n- Test case $1$: $\\Lambda=0.778$, $\\alpha_{\\mathrm{a}}=0.5$, $\\alpha_{\\mathrm{c}}=0.5$, $U_{\\mathrm{m}}=0.3$, $U_{\\mathrm{eq}}=0.0$.\n- Test case $2$: $\\Lambda=0.01$, $\\alpha_{\\mathrm{a}}=0.5$, $\\alpha_{\\mathrm{c}}=0.5$, $U_{\\mathrm{m}}=0.3$, $U_{\\mathrm{eq}}=0.0$.\n- Test case $3$: $\\Lambda=5.0$, $\\alpha_{\\mathrm{a}}=0.5$, $\\alpha_{\\mathrm{c}}=0.5$, $U_{\\mathrm{m}}=0.3$, $U_{\\mathrm{eq}}=0.0$.\n- Test case $4$: $\\Lambda=0.8$, $\\alpha_{\\mathrm{a}}=0.7$, $\\alpha_{\\mathrm{c}}=0.3$, $U_{\\mathrm{m}}=0.2$, $U_{\\mathrm{eq}}=-0.05$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}]$, where each $\\text{result}_{i}$ is the dimensionless boundary current density $j^{\\ast}$ computed for the corresponding test case.",
            "solution": "The user has provided a problem in computational electrochemistry. I will first validate the problem statement.\n\n### Step 1: Extract Givens\n- **Domain**: One-dimensional electrolyte slab on $x \\in [0, L]$.\n- **Variables**: $\\phi(x)$ is the electrolyte potential, $\\boldsymbol{i}$ is the current density vector.\n- **Constants and Parameters**: $\\kappa$ (ionic conductivity), $\\phi_{\\mathrm{m}}$ (metal potential), $\\phi_{\\infty}$ (far-field potential), $j_{0}$ (exchange current density), $\\alpha_{\\mathrm{a}}$ (anodic charge-transfer coefficient), $\\alpha_{\\mathrm{c}}$ (cathodic charge-transfer coefficient), $F$ (Faraday constant), $R$ (universal gas constant), $T$ (absolute temperature), $E_{\\mathrm{eq}}$ (equilibrium potential).\n- **Governing Equations**:\n    - Charge conservation: $\\nabla \\cdot \\boldsymbol{i} = 0$.\n    - Constitutive relation (Ohm's Law): $\\boldsymbol{i} = -\\kappa \\nabla \\phi$.\n- **Boundary Conditions**:\n    - At $x=L$: $\\phi(L) = \\phi_{\\infty}$.\n    - At $x=0$: Butler–Volmer kinetics, $-\\boldsymbol{n} \\cdot \\boldsymbol{i} = j_{0} \\left( \\exp\\left(\\frac{\\alpha_{\\mathrm{a}}F\\eta}{RT}\\right) - \\exp\\left(-\\frac{\\alpha_{\\mathrm{c}}F\\eta}{RT}\\right) \\right)$, where $\\boldsymbol{n}$ is the outward unit normal from the electrolyte.\n- **Definitions**:\n    - Overpotential: $\\eta = \\phi_{\\mathrm{m}} - \\phi(0) - E_{\\mathrm{eq}}$.\n    - Outward normal at $x=0$: For the domain $[0,L]$, $\\boldsymbol{n} = -\\hat{\\mathbf{x}}$.\n- **Non-dimensionalization**:\n    - Scales: $V_{T} = \\frac{RT}{F}$ (potential), $L$ (length), $\\frac{\\kappa V_{T}}{L}$ (current).\n    - Dimensionless variables: $u = \\frac{\\phi}{V_{T}}$, $\\xi = \\frac{x}{L}$, $U_{\\mathrm{m}} = \\frac{\\phi_{\\mathrm{m}}}{V_{T}}$, $U_{\\infty} = \\frac{\\phi_{\\infty}}{V_{T}}$, $U_{\\mathrm{eq}} = \\frac{E_{\\mathrm{eq}}}{V_{T}}$.\n    - Dimensionless parameter: $\\Lambda = \\frac{j_{0}L}{\\kappa V_{T}}$.\n- **Tasks**:\n    1. Derive the non-dimensional weak form.\n    2. Specialize to a single linear finite element on $[0,1]$ with the essential boundary condition $u(1)=0$.\n    3. Show the discretization yields a scalar nonlinear equation for the slope $A = \\frac{du}{d\\xi}$.\n    4. Show the dimensionless boundary current density is $j^{\\ast} = -A$.\n    5. Implement a Newton's method solver for the scalar equation.\n    6. Compute $j^{\\ast}$ for four specified test cases.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a standard secondary current distribution model in electrochemistry. The governing equation is the Laplace equation for potential, coupled to a Robin boundary condition described by the Butler–Volmer equation. This is a fundamental and well-established model.\n- **Well-Posed**: The problem is a one-dimensional boundary value problem with a Dirichlet condition at one end ($x=L$) and a Robin condition at the other ($x=0$). This configuration is mathematically well-posed. The instruction to set $u(1)=0$ is a valid choice of reference potential, simplifying the problem without loss of generality for the current calculation.\n- **Objective**: The problem is stated in precise mathematical and scientific language, free from ambiguity or subjectivity.\n- **Flaw Checklist**: The problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, feasible, well-posed, and non-trivial. The non-dimensionalization scheme is standard practice and the subsequent tasks outline a logical path for a finite element analysis of the problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed to derive the solution.\n\n### Derivation and Solution\n\nThe problem requires a systematic derivation starting from the governing physical laws, proceeding through non-dimensionalization, formulation of a weak form, discretization via the finite element method, and finally, numerical implementation.\n\n**1. Non-Dimensional Governing Equations**\n\nIn one dimension, the governing equations $\\nabla \\cdot \\boldsymbol{i} = 0$ and $\\boldsymbol{i} = -\\kappa \\nabla \\phi$ combine to form the Laplace equation for the potential $\\phi(x)$, as $\\kappa$ is constant:\n$$\n\\frac{d}{dx} \\left( -\\kappa \\frac{d\\phi}{dx} \\right) = 0 \\implies \\frac{d^2\\phi}{dx^2} = 0\n$$\nWe introduce the dimensionless variables $u = \\phi/V_T$ and $\\xi = x/L$. The derivatives transform as:\n$$\n\\frac{d\\phi}{dx} = \\frac{d(V_T u)}{d(L\\xi)} = \\frac{V_T}{L} \\frac{du}{d\\xi}\n$$\n$$\n\\frac{d^2\\phi}{dx^2} = \\frac{d}{d(L\\xi)} \\left( \\frac{V_T}{L} \\frac{du}{d\\xi} \\right) = \\frac{V_T}{L^2} \\frac{d^2u}{d\\xi^2}\n$$\nThe governing equation in dimensionless form is thus:\n$$\n\\frac{V_T}{L^2} \\frac{d^2u}{d\\xi^2} = 0 \\implies \\frac{d^2u}{d\\xi^2} = 0 \\quad \\text{for } \\xi \\in (0, 1)\n$$\nNext, we non-dimensionalize the boundary conditions. The far-field condition $\\phi(L) = \\phi_{\\infty}$ becomes $u(1) = \\phi(L)/V_T = \\phi_{\\infty}/V_T = U_{\\infty}$. The problem specifies using the essential boundary condition $u(1)=0$, which sets the reference potential.\n\nThe Butler-Volmer boundary condition at $x=0$ is $-\\boldsymbol{n} \\cdot \\boldsymbol{i} = j_{\\text{rxn}}$. The outward normal from the electrolyte domain $[0,L]$ at $x=0$ is $\\boldsymbol{n} = -\\hat{\\mathbf{x}}$. The current density is $\\boldsymbol{i} = i_x \\hat{\\mathbf{x}}$. Thus, $-\\boldsymbol{n} \\cdot \\boldsymbol{i} = -(-\\hat{\\mathbf{x}}) \\cdot (i_x \\hat{\\mathbf{x}}) = i_x$. The current at the electrode is $i_x(0) = -\\kappa \\frac{d\\phi}{dx}\\big|_{x=0}$. The kinetic expression is:\n$$\n-\\kappa \\frac{d\\phi}{dx}\\bigg|_{x=0} = j_0 \\left( \\exp\\left(\\frac{\\alpha_{\\mathrm{a}}F\\eta}{RT}\\right) - \\exp\\left(-\\frac{\\alpha_{\\mathrm{c}}F\\eta}{RT}\\right) \\right)\n$$\nThe dimensionless overpotential $\\eta^\\ast$ is:\n$$\n\\eta^\\ast = \\frac{F\\eta}{RT} = \\frac{\\eta}{V_T} = \\frac{\\phi_{\\mathrm{m}} - \\phi(0) - E_{\\mathrm{eq}}}{V_T} = U_{\\mathrm{m}} - u(0) - U_{\\mathrm{eq}}\n$$\nSubstituting the dimensionless variables into the kinetic boundary condition:\n$$\n-\\kappa \\left(\\frac{V_T}{L} \\frac{du}{d\\xi}\\bigg|_{\\xi=0}\\right) = j_0 \\left( \\exp(\\alpha_{\\mathrm{a}} \\eta^\\ast) - \\exp(-\\alpha_{\\mathrm{c}} \\eta^\\ast) \\right)\n$$\nDividing by the current scale $\\kappa V_T/L$ yields the dimensionless boundary condition at $\\xi=0$:\n$$\n-\\frac{du}{d\\xi}\\bigg|_{\\xi=0} = \\frac{j_0 L}{\\kappa V_T} \\left( \\exp(\\alpha_{\\mathrm{a}} \\eta^\\ast) - \\exp(-\\alpha_{\\mathrm{c}} \\eta^\\ast) \\right)\n$$\nUsing the dimensionless parameter $\\Lambda = \\frac{j_0 L}{\\kappa V_T}$, we get:\n$$\n-\\frac{du}{d\\xi}\\bigg|_{\\xi=0} = \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - u(0) - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrm{m}} - u(0) - U_{\\mathrm{eq}})) \\right)\n$$\nThe dimensionless current density is $j^\\ast = i_x / (\\kappa V_T/L) = (-\\kappa \\frac{d\\phi}{dx}) / (\\kappa V_T/L) = -\\frac{d\\phi/dx}{V_T/L} = -\\frac{du}{d\\xi}$. Thus, the boundary condition at $\\xi=0$ equates the boundary current density $j^\\ast(0)$ to the kinetic rate expression.\n\n**2. Variational (Weak) Formulation**\n\nTo derive the weak form, we multiply the dimensionless PDE by a test function $w(\\xi)$ and integrate over the domain $\\xi \\in [0,1]$:\n$$\n\\int_0^1 w \\frac{d^2u}{d\\xi^2} d\\xi = 0\n$$\nApplying integration by parts ($\\int_a^b f g' = [fg]_a^b - \\int_a^b f' g$):\n$$\n\\left[ w \\frac{du}{d\\xi} \\right]_0^1 - \\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi = 0\n$$\nExpanding the boundary term:\n$$\nw(1) \\frac{du}{d\\xi}\\bigg|_{\\xi=1} - w(0) \\frac{du}{d\\xi}\\bigg|_{\\xi=0} - \\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi = 0\n$$\nIn the finite element method, the test function $w$ must belong to a space of functions that vanish where essential (Dirichlet) boundary conditions are applied. Since $u(1)=0$ is an essential condition, we require $w(1)=0$. The equation simplifies to:\n$$\n-w(0) \\frac{du}{d\\xi}\\bigg|_{\\xi=0} - \\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi = 0\n$$\nWe substitute the natural (Robin) boundary condition for the term $\\frac{du}{d\\xi}\\big|_{\\xi=0}$. Rearranging the kinetic expression gives $\\frac{du}{d\\xi}\\big|_{\\xi=0} = -\\Lambda(\\dots)$.\n$$\n-w(0) \\left[ - \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} \\eta^\\ast) - \\exp(-\\alpha_{\\mathrm{c}} \\eta^\\ast) \\right) \\right] - \\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi = 0\n$$\nThe final weak form is: Find $u(\\xi)$ such that $u(1)=0$ and for all test functions $w(\\xi)$ with $w(1)=0$,\n$$\n\\int_0^1 \\frac{dw}{d\\xi} \\frac{du}{d\\xi} d\\xi - w(0) \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - u(0) - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrmm} - u(0) - U_{\\mathrm{eq}})) \\right) = 0\n$$\n\n**3. Finite Element Discretization**\n\nWe discretize the domain $[0,1]$ with a single linear element. The nodes are at $\\xi_0=0$ and $\\xi_1=1$. The linear basis functions are $N_0(\\xi) = 1-\\xi$ and $N_1(\\xi) = \\xi$.\nThe finite element approximation for the potential $u(\\xi)$ is $u_h(\\xi) = U_0 N_0(\\xi) + U_1 N_1(\\xi)$, where $U_0$ and $U_1$ are the nodal values of $u$ at $\\xi=0$ and $\\xi=1$.\nThe essential boundary condition $u(1)=0$ implies $U_1=0$. The approximation becomes:\n$$\nu_h(\\xi) = U_0 (1-\\xi)\n$$\nThe test function $w$ is chosen from the basis functions corresponding to free nodes. The only free node is at $\\xi=0$, so we choose $w(\\xi) = N_0(\\xi) = 1-\\xi$.\nWe compute the necessary terms for the weak form:\n- $u_h(0) = U_0$\n- $w(0) = 1$\n- $\\frac{du_h}{d\\xi} = -U_0$\n- $\\frac{dw}{d\\xi} = -1$\nSubstituting these into the weak form:\n$$\n\\int_0^1 (-1)(-U_0) d\\xi - (1) \\cdot \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - U_0 - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrmm} - U_0 - U_{\\mathrm{eq}})) \\right) = 0\n$$\nEvaluating the integral: $\\int_0^1 U_0 d\\xi = U_0$.\nThe discretized equation becomes a scalar nonlinear equation for the unknown nodal value $U_0$:\n$$\nU_0 - \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - U_0 - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrmc} (U_{\\mathrmm} - U_0 - U_{\\mathrm{eq}})) \\right) = 0\n$$\n\n**4. Equation for Slope $A$ and Current Density $j^\\ast$**\n\nThe problem asks for an equation in terms of the slope $A = \\frac{du}{d\\xi}$. For our linear approximation, the slope is constant: $A = \\frac{du_h}{d\\xi} = -U_0$. This implies $U_0 = -A$.\nSubstituting $U_0 = -A$ into the scalar equation:\n$$\n(-A) - \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} - (-A) - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrmm} - (-A) - U_{\\mathrm{eq}})) \\right) = 0\n$$\nRearranging gives the final nonlinear equation for $A$:\n$$\nA + \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrmm} + A - U_{\\mathrm{eq}})) \\right) = 0\n$$\nThe dimensionless boundary current density at $\\xi=0$ is defined as $j^\\ast = -\\frac{du}{d\\xi}\\big|_{\\xi=0}$. With our approximation, $\\frac{du_h}{d\\xi}\\big|_{\\xi=0} = A$. Therefore, $j^\\ast = -A$.\n\n**5. Newton's Method for the Scalar Residual**\n\nWe need to find the root of the residual function $f(A)$:\n$$\nf(A) = A + \\Lambda \\left( \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) - \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) \\right)\n$$\nThe Newton-Raphson method updates the solution guess $A_k$ iteratively: $A_{k+1} = A_k - \\frac{f(A_k)}{f'(A_k)}$.\nThe derivative of $f(A)$ (the Jacobian) is:\n$$\nf'(A) = \\frac{d f}{d A} = 1 + \\Lambda \\left( \\alpha_{\\mathrm{a}} \\exp(\\alpha_{\\mathrm{a}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) + \\alpha_{\\mathrm{c}} \\exp(-\\alpha_{\\mathrm{c}} (U_{\\mathrm{m}} + A - U_{\\mathrm{eq}})) \\right)\n$$\nThis derivative is always positive for physically meaningful parameters ($\\Lambda, \\alpha_{\\mathrm{a}}, \\alpha_{\\mathrm{c}} > 0$), which ensures that $f(A)$ is a monotonically increasing function of $A$. This guarantees a unique root and robust convergence of the Newton's method. We will implement this algorithm to solve for $A$ for each test case and then report $j^\\ast = -A$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_for_j_star(Lambda, alpha_a, alpha_c, U_m, U_eq):\n    \"\"\"\n    Solves the scalar nonlinear equation for the slope A using Newton's method,\n    and returns the dimensionless boundary current density j_star = -A.\n\n    The equation to solve for A is f(A) = 0, where:\n    f(A) = A + Lambda * (exp(alpha_a * (U_m + A - U_eq)) - exp(-alpha_c * (U_m + A - U_eq)))\n    \"\"\"\n    \n    # Define the residual function f(A) and its derivative f'(A)\n    # Let C = U_m - U_eq for brevity in the expressions\n    C = U_m - U_eq\n    \n    def f(A_val):\n        term1 = np.exp(alpha_a * (C + A_val))\n        term2 = np.exp(-alpha_c * (C + A_val))\n        return A_val + Lambda * (term1 - term2)\n\n    def f_prime(A_val):\n        term1 = alpha_a * np.exp(alpha_a * (C + A_val))\n        term2 = alpha_c * np.exp(-alpha_c * (C + A_val))\n        return 1.0 + Lambda * (term1 + term2)\n\n    # Newton's method settings\n    A = 0.0  # Initial guess for A\n    tol = 1e-12\n    max_iter = 100\n\n    for i in range(max_iter):\n        residual = f(A)\n        if abs(residual) < tol:\n            break\n        \n        jacobian = f_prime(A)\n        # Avoid division by zero, although jacobian is always > 1 here\n        if jacobian == 0:\n            # This case is not expected for this problem\n            raise RuntimeError(\"Jacobian is zero, Newton's method failed.\")\n            \n        A_next = A - residual / jacobian\n        \n        if abs(A_next - A) < tol:\n            A = A_next\n            break\n            \n        A = A_next\n    else:\n        # This part is reached if the loop completes without convergence\n        raise RuntimeError(f\"Newton's method did not converge within {max_iter} iterations.\")\n\n    # The dimensionless current density is j_star = -A\n    j_star = -A\n    return j_star\n\ndef solve():\n    \"\"\"\n    Defines the test cases, solves for the dimensionless boundary current density for each,\n    and prints the results in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Lambda, alpha_a, alpha_c, U_m, U_eq)\n    test_cases = [\n        (0.778, 0.5, 0.5, 0.3, 0.0),\n        (0.01, 0.5, 0.5, 0.3, 0.0),\n        (5.0, 0.5, 0.5, 0.3, 0.0),\n        (0.8, 0.7, 0.3, 0.2, -0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        Lambda, alpha_a, alpha_c, U_m, U_eq = case\n        j_star = solve_for_j_star(Lambda, alpha_a, alpha_c, U_m, U_eq)\n        results.append(j_star)\n\n    # Final print statement in the exact required format.\n    # Using a format specifier to avoid excessive precision/scientific notation.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A predictive model is only as good as its parameters. This final practice advances from forward modeling to the critical domain of inverse problems: estimating model parameters from experimental data. You will explore the concept of parameter identifiability, which asks whether a unique set of parameters can be determined from a given set of measurements. By constructing and analyzing the Fisher Information Matrix (FIM), you will learn to diagnose structural non-identifiability, a common pitfall where the model's mathematical structure prevents the separate estimation of certain parameters, regardless of data quality .",
            "id": "4256675",
            "problem": "Consider a one-dimensional discretization of the secondary current distribution at the surface of a planar electrode in an electrolyte, where the electrolyte potential is coupled along the surface by lateral conduction and to a distant counter electrode by vertical conduction. Let there be $N$ equally spaced surface nodes indexed by $i \\in \\{1,2,\\dots,N\\}$, with unknown electrolyte surface potentials $ \\phi_i $. The lateral coupling is modeled by a discrete Laplacian along the surface, and the vertical coupling by a leak to a reference potential of zero. The electrode is held at a uniform surface potential $E_s$, and the local overpotential at node $i$ is $ \\eta_i = E_s - \\phi_i $. Under small overpotential, invoke the linearized Butler–Volmer relation:\n$$\nj_i = j_0 \\left(\\alpha_a + \\alpha_c\\right) \\frac{F}{R T} \\eta_i,\n$$\nwhere $j_i$ is the reaction current density at node $i$, $j_0$ is the exchange current density, $\\alpha_a$ and $\\alpha_c$ are the anodic and cathodic charge transfer coefficients, $F$ is the Faraday constant, $R$ is the universal gas constant, and $T$ is the absolute temperature. Define the kinetic gain\n$$\nG = j_0 \\, \\left(\\alpha_a + \\alpha_c\\right) \\, \\gamma, \\quad \\text{where} \\quad \\gamma = \\frac{F}{R T}.\n$$\nLet the discrete lateral and vertical electrolyte conductances be represented by positive constants $R_l$ and $R_v$ respectively (both treated as effective resistances for the purpose of this numerical model). Conservation of charge at each node balances the reaction current density with the sum of lateral and vertical conduction:\n$$\nG \\left(E_s - \\phi_i\\right) = \\frac{\\phi_i}{R_v} + \\frac{a_i \\phi_i - \\phi_{i-1} - \\phi_{i+1}}{R_l},\n$$\nwith $a_i = 2$ for interior nodes ($2 \\leq i \\leq N-1$), $a_1 = a_N = 1$ at the ends, and terms with out-of-range indices omitted. In vector form, define the $N \\times N$ tridiagonal matrix $L$ with diagonal entries $a_i$, super- and sub-diagonal entries $-1$, and the identity matrix $I$. Then the system becomes\n$$\n\\left(\\frac{1}{R_v} I + \\frac{1}{R_l} L + G I\\right) \\boldsymbol{\\phi} = G E_s \\boldsymbol{1},\n$$\nwhere $ \\boldsymbol{\\phi} = [\\phi_1,\\dots,\\phi_N]^T $ and $ \\boldsymbol{1} $ is the vector of ones. The forward model for the spatial reaction current density is\n$$\n\\boldsymbol{j} = G \\left(E_s \\boldsymbol{1} - \\boldsymbol{\\phi}\\right).\n$$\nYou observe spatially resolved measurements of $ \\boldsymbol{j} $ corrupted by additive independent Gaussian noise with variance $ \\sigma^2 $ per component. For multiple experiments indexed by $k$, with possibly differing $E_s^{(k)}$ and $T^{(k)}$ (thus differing $ \\gamma^{(k)} $ and $G^{(k)} = j_0 s \\gamma^{(k)}$ where $s = \\alpha_a + \\alpha_c$), you stack all measurements across nodes and experiments into a single vector. The unknown parameter vector is $ \\boldsymbol{p} = [j_0, s]^T $.\n\nStarting from Ohm’s law and charge conservation in the electrolyte, and using the linearized Butler–Volmer kinetics at the boundary under small overpotential, derive the Jacobian matrix $J$ of the forward model with respect to $ \\boldsymbol{p} $ evaluated at a given $(j_0, s)$, and the Fisher Information Matrix (Fisher Information Matrix (FIM)) for Gaussian noise:\n$$\nF = \\frac{1}{\\sigma^2} J^T J.\n$$\nUse the identity for the derivative of the inverse matrix $ \\frac{d}{dG} M^{-1} = - M^{-1} \\left(\\frac{dM}{dG}\\right) M^{-1} $, where $ M = \\frac{1}{R_v} I + \\frac{1}{R_l} L + G I $. Show how to compute $ \\frac{\\partial \\boldsymbol{j}}{\\partial G} $ without numerical differentiation and then obtain $ \\frac{\\partial \\boldsymbol{j}}{\\partial j_0 } $ and $ \\frac{\\partial \\boldsymbol{j}}{\\partial s } $ by the chain rule for each experiment.\n\nDesign an algorithm that, for each test case below, constructs $L$, solves the forward model for each experiment, builds $J$ by stacking the Jacobians across all experiments and nodes, forms $F$, and returns a boolean indicating whether $F$ has full rank $2$ (meaning both parameters are locally identifiable under the given small-overpotential model and measurement setup). Use a numerical rank test based on the eigenvalues of $F$ with a relative threshold tied to the largest eigenvalue to decide full rank.\n\nTest Suite:\n- Case $1$ (single small overpotential, single temperature):\n    - $N = 10$, $R_v = 5.0$, $R_l = 1.0$, $E_s^{(1)} = 0.010$ (volts), $T^{(1)} = 298$ (kelvin),\n    - $j_0 = 1.5$, $s = 1.2$, $\\sigma = 0.001$.\n- Case $2$ (multiple small overpotentials, single temperature):\n    - $N = 25$, $R_v = 2.0$, $R_l = 0.5$, $(E_s^{(1)}, E_s^{(2)}, E_s^{(3)}) = (0.005, 0.010, 0.020)$ (volts), $T^{(1)} = T^{(2)} = T^{(3)} = 298$ (kelvin),\n    - $j_0 = 1.5$, $s = 1.2$, $\\sigma = 0.0005$.\n- Case $3$ (identical small overpotential at two temperatures):\n    - $N = 15$, $R_v = 10.0$, $R_l = 2.0$, $(E_s^{(1)}, E_s^{(2)}) = (0.010, 0.010)$ (volts), $(T^{(1)}, T^{(2)}) = (298, 333)$ (kelvin),\n    - $j_0 = 2.0$, $s = 1.0$, $\\sigma = 0.0015$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), where each result is the boolean outcome for a case indicating whether the Fisher Information Matrix has full rank $2$. No physical units should be printed since the outputs are booleans. The computation must be self-contained and use the constants $F = 96485$ and $R = 8.314$ in the forward model.",
            "solution": "The user has provided a problem that is scientifically sound, well-posed, and objective. It describes a standard model for secondary current distribution in electrochemistry and asks for a parameter identifiability analysis using the Fisher Information Matrix. All parameters, constants, and equations are clearly defined, forming a self-contained and solvable problem. The problem is a valid exercise in applying principles of numerical modeling, sensitivity analysis, and statistical inference to a physical system.\n\n### Theoretical Derivation and Analysis\n\nThe objective is to determine if the parameters $\\boldsymbol{p} = [j_0, s]^T$ are locally identifiable from measurements of the current density vector $\\boldsymbol{j}$. This is achieved by analyzing the rank of the Fisher Information Matrix (FIM). We begin by deriving the Jacobian matrix of the forward model, which maps the parameters $\\boldsymbol{p}$ to the observable $\\boldsymbol{j}$. For clarity, we will first consider a single experiment and omit the experiment index $(k)$.\n\nThe forward model consists of two main equations:\n1.  The linear system for the electrolyte potential $\\boldsymbol{\\phi}$:\n    $$\n    M \\boldsymbol{\\phi} = G E_s \\boldsymbol{1} \\quad \\text{where} \\quad M = \\left(\\frac{1}{R_v} + G\\right)I + \\frac{1}{R_l} L\n    $$\n    From this, we can express $\\boldsymbol{\\phi}$ as $\\boldsymbol{\\phi} = M^{-1} G E_s \\boldsymbol{1}$.\n\n2.  The expression for the reaction current density $\\boldsymbol{j}$:\n    $$\n    \\boldsymbol{j} = G (E_s \\boldsymbol{1} - \\boldsymbol{\\phi})\n    $$\n\nThe parameters of interest, $j_0$ and $s$, influence the model through the kinetic gain $G = j_0 s \\gamma$, where $\\gamma = F/(RT)$. The most direct path to find the derivatives with respect to $j_0$ and $s$ is to first find the derivative with respect to $G$ and then apply the chain rule.\n\n**Derivative of $\\boldsymbol{j}$ with respect to $G$:**\n\nWe start by differentiating $\\boldsymbol{\\phi}$ with respect to $G$:\n$$\n\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G} = \\frac{\\partial}{\\partial G} \\left( M^{-1} G E_s \\boldsymbol{1} \\right) = \\left(\\frac{\\partial M^{-1}}{\\partial G}\\right) (G E_s \\boldsymbol{1}) + M^{-1} \\frac{\\partial}{\\partial G}(G E_s \\boldsymbol{1})\n$$\nThe derivative of the matrix $M$ with respect to $G$ is $\\frac{\\partial M}{\\partial G} = \\frac{\\partial}{\\partial G} \\left( (\\frac{1}{R_v}I + \\frac{1}{R_l}L) + GI \\right) = I$. Using the provided identity for the derivative of a matrix inverse, $\\frac{d}{dG} M^{-1} = -M^{-1} (\\frac{dM}{dG}) M^{-1}$:\n$$\n\\frac{\\partial M^{-1}}{\\partial G} = -M^{-1} (I) M^{-1} = -M^{-2}\n$$\nThe derivative of the right-hand side term is $\\frac{\\partial}{\\partial G}(G E_s \\boldsymbol{1}) = E_s \\boldsymbol{1}$. Substituting these back into the expression for $\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G}$:\n$$\n\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G} = -M^{-2} (G E_s \\boldsymbol{1}) + M^{-1} (E_s \\boldsymbol{1})\n$$\nRecognizing that $\\boldsymbol{\\phi} = M^{-1}(G E_s \\boldsymbol{1})$, we can write $M^{-1} \\boldsymbol{\\phi} = M^{-2}(G E_s \\boldsymbol{1})$. This simplifies the expression to:\n$$\n\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G} = -M^{-1} \\boldsymbol{\\phi} + M^{-1} (E_s \\boldsymbol{1}) = M^{-1} (E_s \\boldsymbol{1} - \\boldsymbol{\\phi})\n$$\nNow, we differentiate the expression for $\\boldsymbol{j} = G E_s \\boldsymbol{1} - G\\boldsymbol{\\phi}$ with respect to $G$ using the product rule:\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial G} = E_s \\boldsymbol{1} - \\left( \\frac{\\partial G}{\\partial G} \\boldsymbol{\\phi} + G \\frac{\\partial \\boldsymbol{\\phi}}{\\partial G} \\right) = E_s \\boldsymbol{1} - \\boldsymbol{\\phi} - G \\frac{\\partial \\boldsymbol{\\phi}}{\\partial G}\n$$\nSubstituting our result for $\\frac{\\partial \\boldsymbol{\\phi}}{\\partial G}$:\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial G} = (E_s \\boldsymbol{1} - \\boldsymbol{\\phi}) - G \\left( M^{-1} (E_s \\boldsymbol{1} - \\boldsymbol{\\phi}) \\right) = (I - G M^{-1})(E_s \\boldsymbol{1} - \\boldsymbol{\\phi})\n$$\nThis provides a method to compute the sensitivity of the current density to the kinetic gain $G$ without resorting to numerical differentiation.\n\n**Chain Rule and Jacobian Construction:**\n\nUsing the chain rule, we can find the derivatives of $\\boldsymbol{j}$ with respect to the model parameters $j_0$ and $s$.\nThe partial derivatives of $G = j_0 s \\gamma$ are:\n$$\n\\frac{\\partial G}{\\partial j_0} = s \\gamma \\quad \\text{and} \\quad \\frac{\\partial G}{\\partial s} = j_0 \\gamma\n$$\nThe columns of the Jacobian matrix for a single experiment are therefore:\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial j_0} = \\frac{\\partial \\boldsymbol{j}}{\\partial G} \\frac{\\partial G}{\\partial j_0} = (s \\gamma) \\frac{\\partial \\boldsymbol{j}}{\\partial G}\n$$\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial s} = \\frac{\\partial \\boldsymbol{j}}{\\partial G} \\frac{\\partial G}{\\partial s} = (j_0 \\gamma) \\frac{\\partial \\boldsymbol{j}}{\\partial G}\n$$\nAn immediate and critical observation is that the two columns of the Jacobian are linearly dependent:\n$$\n\\frac{\\partial \\boldsymbol{j}}{\\partial s} = \\frac{j_0}{s} \\frac{\\partial \\boldsymbol{j}}{\\partial j_0}\n$$\nThis collinearity is fundamental to the structure of the specified model. When multiple experiments (indexed by $k$) are performed, the full Jacobian $J$ is formed by vertically stacking the individual experiment Jacobians, $J^{(k)}$. The column vectors of the full Jacobian, representing the sensitivities to $j_0$ and $s$ across all measurements, will be $\\boldsymbol{v}_{j_0}$ and $\\boldsymbol{v}_s$. Each block of these vectors corresponding to experiment $k$ maintains the same collinearity relationship. Consequently, the full column vectors also remain linearly dependent: $\\boldsymbol{v}_s = (j_0/s) \\boldsymbol{v}_{j_0}$.\n\n**Fisher Information Matrix and Parameter Identifiability:**\n\nThe Fisher Information Matrix is $F = \\frac{1}{\\sigma^2} J^T J$. Since the columns of $J$ are linearly dependent, $J$ has a rank of at most $1$ (assuming non-zero sensitivity). A property of matrix rank is that $\\text{rank}(J^T J) = \\text{rank}(J)$. Therefore, the FIM will have a rank of at most $1$. For the two parameters $[j_0, s]^T$ to be identifiable, the FIM must have full rank, which is $2$.\n\nThe structural non-identifiability arises because the parameters $j_0$ and $s$ only appear in the model equations through their product, $j_0s$. The model is sensitive only to the lumped parameter $P = j_0s$, not to $j_0$ and $s$ individually. Varying experimental conditions such as $E_s$ or $T$ does not break this mathematical dependency. Therefore, we predict that for all test cases, the FIM will be rank-deficient, and the algorithm should return `False`.\n\n### Algorithmic Design\n\nThe algorithm will follow the derivation to construct and analyze the FIM for each test case.\n\n1.  **Initialization**: For each case, define the physical constants ($F$, $R$) and problem-specific parameters ($N, R_v, R_l, j_0, s, \\sigma$).\n2.  **Construct L Matrix**: Create the $N \\times N$ discrete Laplacian matrix $L$ with diagonal entries $a_i$ ($a_1=a_N=1$, $a_{2..N-1}=2$) and off-diagonal entries of $-1$.\n3.  **Iterate Through Experiments**: For each experiment $(E_s^{(k)}, T^{(k)})$ within a test case:\n    a. Calculate $\\gamma^{(k)} = F / (R T^{(k)})$ and $G^{(k)} = j_0 s \\gamma^{(k)}$.\n    b. Form the system matrix $M^{(k)} = (\\frac{1}{R_v} + G^{(k)})I + \\frac{1}{R_l} L$ and the right-hand side vector $\\boldsymbol{b}^{(k)} = G^{(k)} E_s^{(k)} \\boldsymbol{1}$.\n    c. Solve the linear system $M^{(k)} \\boldsymbol{\\phi}^{(k)} = \\boldsymbol{b}^{(k)}$ to find the potential vector $\\boldsymbol{\\phi}^{(k)}$.\n    d. To compute $\\frac{\\partial \\boldsymbol{j}^{(k)}}{\\partial G^{(k)}}$, first solve the auxiliary linear system $M^{(k)} \\boldsymbol{x}^{(k)} = (E_s^{(k)}\\boldsymbol{1} - \\boldsymbol{\\phi}^{(k)})$ for $\\boldsymbol{x}^{(k)}$. Note that $\\boldsymbol{x}^{(k)} = (M^{(k)})^{-1} (E_s^{(k)}\\boldsymbol{1} - \\boldsymbol{\\phi}^{(k)})$.\n    e. Compute the sensitivity vector $\\boldsymbol{d_G}^{(k)} = \\frac{\\partial \\boldsymbol{j}^{(k)}}{\\partial G^{(k)}} = (E_s^{(k)}\\boldsymbol{1} - \\boldsymbol{\\phi}^{(k)}) - G^{(k)} \\boldsymbol{x}^{(k)}$.\n    f. Use the chain rule to find the columns of the Jacobian for this experiment: $\\frac{\\partial \\boldsymbol{j}^{(k)}}{\\partial j_0} = (s \\gamma^{(k)}) \\boldsymbol{d_G}^{(k)}$ and $\\frac{\\partial \\boldsymbol{j}^{(k)}}{\\partial s} = (j_0 \\gamma^{(k)}) \\boldsymbol{d_G}^{(k)}$.\n    g. Store the resulting $N \\times 2$ matrix $J^{(k)}$.\n4.  **Assemble Global Matrices**: Vertically stack all $J^{(k)}$ matrices to form the global Jacobian $J$.\n5.  **Compute FIM**: Calculate the Fisher Information Matrix $F = \\frac{1}{\\sigma^2} J^T J$.\n6.  **Rank Test**: Compute the two eigenvalues of the $2 \\times 2$ symmetric matrix F. Let them be $\\lambda_{max}$ and $\\lambda_{min}$. The matrix has full rank if both eigenvalues are positive and their ratio $\\lambda_{min} / \\lambda_{max}$ is greater than a small numerical tolerance (e.g., $10^{-10}$).\n7.  **Output**: Append the boolean result of the rank test to a list. After processing all cases, print the list in the specified format. Based on the preceding analysis, the expected result for all cases is `False`.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the rank of the Fisher Information Matrix (FIM) for three test cases\n    of an electrochemical model.\n    \"\"\"\n    F_CONST = 96485.0  # Faraday constant in C/mol\n    R_CONST = 8.314    # Universal gas constant in J/(mol*K)\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"N\": 10, \"Rv\": 5.0, \"Rl\": 1.0, \"i0\": 1.5, \"s\": 1.2, \"sigma\": 0.001,\n            \"experiments\": [(0.010, 298.0)]\n        },\n        {\n            \"N\": 25, \"Rv\": 2.0, \"Rl\": 0.5, \"i0\": 1.5, \"s\": 1.2, \"sigma\": 0.0005,\n            \"experiments\": [(0.005, 298.0), (0.010, 298.0), (0.020, 298.0)]\n        },\n        {\n            \"N\": 15, \"Rv\": 10.0, \"Rl\": 2.0, \"i0\": 2.0, \"s\": 1.0, \"sigma\": 0.0015,\n            \"experiments\": [(0.010, 298.0), (0.010, 333.0)]\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        Rv = case[\"Rv\"]\n        Rl = case[\"Rl\"]\n        i0 = case[\"i0\"]\n        s_param = case[\"s\"]\n        sigma = case[\"sigma\"]\n        experiments = case[\"experiments\"]\n        \n        # Construct the discrete Laplacian matrix L\n        diag_L = np.full(N, 2.0)\n        diag_L[0] = 1.0\n        diag_L[N-1] = 1.0\n        L = np.diag(diag_L) - np.diag(np.ones(N-1), k=1) - np.diag(np.ones(N-1), k=-1)\n\n        J_list = []\n\n        for Es, T in experiments:\n            # Step 1: Calculate model-dependent constants for the experiment\n            gamma = F_CONST / (R_CONST * T)\n            G = i0 * s_param * gamma\n\n            # Step 2: Assemble and solve the forward model for phi\n            I = np.identity(N)\n            M = (1.0/Rv + G) * I + (1.0/Rl) * L\n            b = G * Es * np.ones(N)\n            \n            # This check is for numerical stability, though M is guaranteed to be\n            # positive definite for positive physical parameters.\n            if np.linalg.cond(M) > 1/np.finfo(M.dtype).eps:\n                # Handle ill-conditioned matrix if it occurs, though unlikely here\n                # For this problem, we can assume it's always solvable\n                pass\n\n            phi = np.linalg.solve(M, b)\n\n            # Step 3: Compute the sensitivity of j w.r.t. G\n            eta_vec = Es * np.ones(N) - phi\n            \n            # To compute (I - G * M_inv) * eta_vec, we first find M_inv * eta_vec\n            # by solving another linear system to avoid explicit inversion.\n            # M * x = eta_vec\n            x = np.linalg.solve(M, eta_vec)\n            \n            djdG = eta_vec - G * x\n            \n            # Step 4: Use chain rule to get sensitivities w.r.t. i0 and s\n            djd_di0 = (s_param * gamma) * djdG\n            djd_ds = (i0 * gamma) * djdG\n            \n            # Form the Jacobian for this experiment\n            J_k = np.vstack((djd_di0, djd_ds)).T\n            J_list.append(J_k)\n\n        # Step 5: Stack Jacobians from all experiments\n        J_total = np.vstack(J_list)\n\n        # Step 6: Compute the Fisher Information Matrix (FIM)\n        FIM = (1.0 / sigma**2) * (J_total.T @ J_total)\n        \n        # Step 7: Perform rank test using eigenvalues\n        # FIM is a 2x2 symmetric positive semi-definite matrix.\n        # Its eigenvalues are real and non-negative.\n        eigenvalues = np.linalg.eigvalsh(FIM)\n        lambda_min, lambda_max = eigenvalues[0], eigenvalues[1]\n        \n        has_full_rank = False\n        # To have full rank 2, both eigenvalues must be significantly greater than zero.\n        # We check if the smaller eigenvalue is non-negligible compared to the larger one.\n        if lambda_max > 1e-12: # Avoid division by zero if FIM is all zeros\n            # A relative tolerance is used for the rank test.\n            # If the ratio is very small, the matrix is numerically rank-deficient.\n            if (lambda_min / lambda_max) > 1e-10:\n                has_full_rank = True\n        \n        results.append(has_full_rank)\n        \n    print(f\"[{','.join(map(str, [r.lower() for r in results]))}]\")\n\nsolve()\n```"
        }
    ]
}