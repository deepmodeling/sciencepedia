{
    "hands_on_practices": [
        {
            "introduction": "力场参数化的基础在于精确描述非键相互作用。此练习聚焦于伦纳德-琼斯（Lennard-Jones）势，这是模拟范德华相互作用的基石。你将首先应用标准的洛伦兹-贝特洛（Lorentz-Berthelot）混合规则来估算离子-水相互作用参数，然后通过NBFIX修正来调整这些参数，以精确匹配一个关键的实验目标——离子-氧的接触距离。这项实践让你掌握调整力场参数以复现结构性质的核心技能。",
            "id": "4246428",
            "problem": "您正在一个经典的Lennard-Jones (LJ) 12–6描述框架内，对一个单价阳离子 $i$ 和一个简单的三点水模型的氧位点 $j$ 之间的非键相互作用进行参数化。LJ势定义为 $V_{ij}(r) = 4 \\varepsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r} \\right)^{6} \\right]$，其中 $r$ 是分离距离，$\\sigma_{ij}$ 是混合直径，$\\varepsilon_{ij}$ 是混合势阱深度。该离子的参数为 $\\sigma_i = 0.220 \\ \\mathrm{nm}$ 和 $\\varepsilon_i = 0.500 \\ \\mathrm{kJ \\ mol^{-1}}$，水分子的氧原子参数为 $\\sigma_j = 0.315 \\ \\mathrm{nm}$ 和 $\\varepsilon_j = 0.650 \\ \\mathrm{kJ \\ mol^{-1}}$。使用 Lorentz–Berthelot 组合规则来获得混合参数 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$。然后，为了在 LJ 势的最小值处强制一个目标离子-氧接触距离 $r^{\\ast} = 0.240 \\ \\mathrm{nm}$，提出一个非键参数覆盖 (NBFIX) 校正，该校正只修改混合直径，同时保持混合势阱深度不变；也就是说，选择 $\\sigma_{ij}^{\\mathrm{NBFIX}}$ 使得 LJ 势的最小值位置等于 $r^{\\ast}$，并设置 $\\varepsilon_{ij}^{\\mathrm{NBFIX}} = \\varepsilon_{ij}$。计算并按顺序 $\\sigma_{ij}$、$\\varepsilon_{ij}$、$\\sigma_{ij}^{\\mathrm{NBFIX}}$、$\\varepsilon_{ij}^{\\mathrm{NBFIX}}$ 报告这四个量。将每个量四舍五入到四位有效数字。$\\sigma$ 的值以 $\\mathrm{nm}$ 表示，$\\varepsilon$ 的值以 $\\mathrm{kJ \\ mol^{-1}}$ 表示。",
            "solution": "该问题要求确定描述单价阳离子 $i$ 和水氧位点 $j$ 之间非键相互作用的 Lennard-Jones (LJ) 势的相互作用参数。分析分两个阶段进行：首先，应用标准组合规则；其次，应用特定的校正 (NBFIX) 来匹配一个实验目标。\n\nLennard-Jones 势给出如下：\n$$V_{ij}(r) = 4 \\varepsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r} \\right)^{6} \\right]$$\n各个位点的参数如下：\n离子 $i$：$\\sigma_i = 0.220 \\ \\mathrm{nm}$，$\\varepsilon_i = 0.500 \\ \\mathrm{kJ \\ mol^{-1}}$\n水的氧原子 $j$：$\\sigma_j = 0.315 \\ \\mathrm{nm}$，$\\varepsilon_j = 0.650 \\ \\mathrm{kJ \\ mol^{-1}}$\n\n首先，我们使用 Lorentz–Berthelot 组合规则计算混合相互作用参数 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$。Lorentz 规则（直径的算术平均值）是：\n$$\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}$$\n代入给定值：\n$$\\sigma_{ij} = \\frac{0.220 \\ \\mathrm{nm} + 0.315 \\ \\mathrm{nm}}{2} = \\frac{0.535 \\ \\mathrm{nm}}{2} = 0.2675 \\ \\mathrm{nm}$$\nBerthelot 规则（势阱深度的几何平均值）是：\n$$\\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}$$\n代入给定值：\n$$\\varepsilon_{ij} = \\sqrt{(0.500 \\ \\mathrm{kJ \\ mol^{-1}}) \\times (0.650 \\ \\mathrm{kJ \\ mol^{-1}})} = \\sqrt{0.325} \\ \\mathrm{kJ \\ mol^{-1}}$$\n计算数值：\n$$\\varepsilon_{ij} \\approx 0.5700877... \\ \\mathrm{kJ \\ mol^{-1}}$$\n\n接下来，我们处理非键参数覆盖 (NBFIX) 校正。该校正旨在调整参数，以在 LJ 势的最小值处强制一个目标离子-氧接触距离 $r^{\\ast} = 0.240 \\ \\mathrm{nm}$。我们必须找到实现这一目标的新参数 $\\sigma_{ij}^{\\mathrm{NBFIX}}$，同时保持势阱深度不变，即 $\\varepsilon_{ij}^{\\mathrm{NBFIX}} = \\varepsilon_{ij}$。\n\n为此，我们必须首先找到 LJ 势达到其最小值时的距离 $r_{min}$ 的通用表达式。这可以通过求 $V_{ij}(r)$ 对 $r$ 的一阶导数并将其设为零来找到。\n$$\\frac{dV_{ij}}{dr} = \\frac{d}{dr} \\left[ 4 \\varepsilon_{ij} \\left( \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6} \\right) \\right] = 4 \\varepsilon_{ij} \\left[ \\sigma_{ij}^{12}(-12r^{-13}) - \\sigma_{ij}^{6}(-6r^{-7}) \\right]$$\n对 $r \\neq 0$ 令导数为零：\n$$4 \\varepsilon_{ij} \\left[ -12 \\frac{\\sigma_{ij}^{12}}{r^{13}} + 6 \\frac{\\sigma_{ij}^{6}}{r^{7}} \\right] = 0$$\n由于 $4\\varepsilon_{ij} \\neq 0$，括号中的项必须为零：\n$$6 \\frac{\\sigma_{ij}^{6}}{r^{7}} = 12 \\frac{\\sigma_{ij}^{12}}{r^{13}}$$\n$$r^6 = 2 \\sigma_{ij}^{6}$$\n解出 $r$，我们得到势能最小值的位置：\n$$r_{min} = 2^{1/6} \\sigma_{ij}$$\nNBFIX 校正要求对于由 $\\sigma_{ij}^{\\mathrm{NBFIX}}$ 定义的势，其最小值位于 $r^{\\ast} = 0.240 \\ \\mathrm{nm}$。因此：\n$$r^{\\ast} = 2^{1/6} \\sigma_{ij}^{\\mathrm{NBFIX}}$$\n我们解出 $\\sigma_{ij}^{\\mathrm{NBFIX}}$：\n$$\\sigma_{ij}^{\\mathrm{NBFIX}} = \\frac{r^{\\ast}}{2^{1/6}} = \\frac{0.240 \\ \\mathrm{nm}}{2^{1/6}}$$\n计算数值：\n$$\\sigma_{ij}^{\\mathrm{NBFIX}} \\approx \\frac{0.240 \\ \\mathrm{nm}}{1.122462...} \\approx 0.213810... \\ \\mathrm{nm}$$\n如所规定，势阱深度不被此覆盖修改：\n$$\\varepsilon_{ij}^{\\mathrm{NBFIX}} = \\varepsilon_{ij} = \\sqrt{0.325} \\ \\mathrm{kJ \\ mol^{-1}} \\approx 0.5700877... \\ \\mathrm{kJ \\ mol^{-1}}$$\n\n最后，我们报告所需的四个量，四舍五入到四位有效数字：\n$1$. $\\sigma_{ij} = 0.2675 \\ \\mathrm{nm}$\n$2$. $\\varepsilon_{ij} \\approx 0.5701 \\ \\mathrm{kJ \\ mol^{-1}}$\n$3$. $\\sigma_{ij}^{\\mathrm{NBFIX}} \\approx 0.2138 \\ \\mathrm{nm}$\n$4$. $\\varepsilon_{ij}^{\\mathrm{NBFIX}} = \\varepsilon_{ij} \\approx 0.5701 \\ \\mathrm{kJ \\ mol^{-1}}$\n\n这四个量，按照要求的顺序（$\\sigma_{ij}$、$\\varepsilon_{ij}$、$\\sigma_{ij}^{\\mathrm{NBFIX}}$、$\\varepsilon_{ij}^{\\mathrm{NBFIX}}$），分别是 $0.2675$、$0.5701$、$0.2138$ 和 $0.5701$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.2675 & 0.5701 & 0.2138 & 0.5701 \\end{pmatrix}}$$"
        },
        {
            "introduction": "力场参数并非孤立存在，它们与所选的溶剂模型紧密相关。不同的水模型（如TIP3P、SPC/E）具有不同的几何形状和Lennard-Jones参数，这直接影响了溶质的最佳参数。本练习将阐明这一关键概念，要求你计算在不同水模型下为了保持相同的离子-氧径向分布函数峰位，需要对离子参数做出何种调整。通过这项实践，你将理解参数的可移植性及其对模型选择的依赖性。",
            "id": "4246433",
            "problem": "一个单价阳离子需要针对三种刚性非极化水模型进行参数化：三点可转移分子间势 (TIP3P)、扩展单点电荷 (SPC/E) 和四点可转移分子间势2005年修订版 (TIP4P/2005)。离子-氧之间的非键相互作用通过 Lennard–Jones 势和 Lorentz–Berthelot 混合规则进行建模。具体而言，离子 ($I$) 和水氧位点 ($O$) 之间的交叉相互作用为\n$$\nU_{IO}(r)=4\\,\\varepsilon_{IO}\\left[\\left(\\frac{\\sigma_{IO}}{r}\\right)^{12}-\\left(\\frac{\\sigma_{IO}}{r}\\right)^{6}\\right],\n$$\n其中\n$$\n\\sigma_{IO}=\\frac{\\sigma_{I}+\\sigma_{O}}{2},\\qquad \\varepsilon_{IO}=\\sqrt{\\varepsilon_{I}\\,\\varepsilon_{O}}.\n$$\n假设对于所有三种模型，体相水的数密度相同，并且，对于液态水中的这种单价离子，静电作用不会使离子-氧径向分布函数的第一个峰值位置相对于离子-氧对的 Lennard–Jones 势最小值发生偏移。进一步假设，在所采用的参数化方案中，匹配第一个峰值位置 $r^{\\star}$ 可以唯一地确定水合数 $n^{\\star}$，因为控制 $n$ 的第一水化层半径与 $r^{\\star}$ 成正比，且比例系数与模型无关。\n\n给定每种模型的水氧 Lennard–Jones 尺寸参数：对于 TIP3P，$\\sigma_{O}^{\\mathrm{TIP3P}}=3.1506$ Å；对于 SPC/E，$\\sigma_{O}^{\\mathrm{SPC/E}}=3.1660$ Å；对于 TIP4P/2005，$\\sigma_{O}^{\\mathrm{TIP4P/2005}}=3.1589$ Å。你的目标是在所有三种模型中都得到相同的离子-氧径向分布函数第一个峰值位置 $r^{\\star}=2.800$ Å 和水合数 $n^{\\star}$。\n\n仅使用上述信息和既定假设，确定为了匹配相同的 $r^{\\star}$（并因此匹配相同的 $n^{\\star}$），SPC/E 和 TIP4P/2005 模型相对于 TIP3P 模型所需的离子 Lennard-Jones 尺寸参数 $\\Delta\\sigma_{I}$ 的变化量。以双分量行向量 $\\left[\\Delta\\sigma_{I}^{\\mathrm{SPC/E}},\\,\\Delta\\sigma_{I}^{\\mathrm{TIP4P/2005}}\\right]$ 的形式报告你的答案，单位为 Å，并四舍五入到四位有效数字。",
            "solution": "该问题要求确定在针对两种不同的水模型（SPC/E 和 TIP4P/2005）相对于参考模型（TIP3P）对单价阳离子进行参数化时，Lennard-Jones (LJ) 尺寸参数 $\\sigma_{I}$ 的变化量。核心约束是离子-氧径向分布函数的第一个峰值位置 $r^{\\star}$ 在所有三种模型中必须相同。\n\n问题陈述了一个关键假设：离子-氧径向分布函数的第一个峰值位置 $r^{\\star}$ 与离子-氧对的 Lennard-Jones 势 $U_{IO}(r)$ 的最小值重合。势能由下式给出：\n$$\nU_{IO}(r)=4\\,\\varepsilon_{IO}\\left[\\left(\\frac{\\sigma_{IO}}{r}\\right)^{12}-\\left(\\frac{\\sigma_{IO}}{r}\\right)^{6}\\right]\n$$\n为了找到最小值的位置 $r_{min}$，我们必须找到势能对 $r$ 的一阶导数为零时的 $r$ 值。\n$$\n\\frac{dU_{IO}(r)}{dr} = 4\\varepsilon_{IO} \\frac{d}{dr} \\left[ \\sigma_{IO}^{12}r^{-12} - \\sigma_{IO}^{6}r^{-6} \\right]\n$$\n$$\n\\frac{dU_{IO}(r)}{dr} = 4\\varepsilon_{IO} \\left[ -12\\sigma_{IO}^{12}r^{-13} + 6\\sigma_{IO}^{6}r^{-7} \\right]\n$$\n将导数设为零以求最小值：\n$$\n4\\varepsilon_{IO} \\left[ -12\\sigma_{IO}^{12}r^{-13} + 6\\sigma_{IO}^{6}r^{-7} \\right] = 0\n$$\n假设 $\\varepsilon_{IO} \\neq 0$ 且 $r \\neq 0$，我们可以简化为：\n$$\n6\\sigma_{IO}^{6}r^{-7} = 12\\sigma_{IO}^{12}r^{-13}\n$$\n$$\nr^{6} = \\frac{12\\sigma_{IO}^{12}}{6\\sigma_{IO}^{6}} = 2\\sigma_{IO}^{6}\n$$\n对两边取六次方根，得到势能最小值的位置：\n$$\nr_{min} = 2^{1/6}\\sigma_{IO}\n$$\n根据问题的核心假设，$r^{\\star} = r_{min}$。因此，我们有以下关系：\n$$\nr^{\\star} = 2^{1/6}\\sigma_{IO}\n$$\n问题使用了 Lorentz-Berthelot 混合规则，其中 $\\sigma_{IO} = \\frac{\\sigma_{I}+\\sigma_{O}}{2}$。将此代入 $r^{\\star}$ 的方程中：\n$$\nr^{\\star} = 2^{1/6} \\left(\\frac{\\sigma_{I} + \\sigma_{O}}{2}\\right)\n$$\n我们需要找到在每种水模型中实现目标峰值位置 $r^{\\star}$ 所需的离子尺寸参数 $\\sigma_{I}$。让我们求解 $\\sigma_{I}$：\n$$\n\\frac{2r^{\\star}}{2^{1/6}} = \\sigma_{I} + \\sigma_{O}\n$$\n$$\n\\sigma_{I} = \\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}\n$$\n该方程对每种水模型 $M \\in \\{\\text{TIP3P, SPC/E, TIP4P/2005}\\}$ 都成立。设 $\\sigma_I^M$ 和 $\\sigma_O^M$ 为特定模型 $M$ 的参数。目标 $r^{\\star}$ 对所有模型都是常数。\n$$\n\\sigma_{I}^{M} = \\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{M}\n$$\n我们被要求计算 SPC/E 和 TIP4P/2005 相对于 TIP3P 的离子尺寸参数的变化量。该变化量记为 $\\Delta\\sigma_{I}^{M} = \\sigma_{I}^{M} - \\sigma_{I}^{\\mathrm{TIP3P}}$。\n\n对于 SPC/E 模型，变化量为：\n$$\n\\Delta\\sigma_{I}^{\\mathrm{SPC/E}} = \\sigma_{I}^{\\mathrm{SPC/E}} - \\sigma_{I}^{\\mathrm{TIP3P}}\n$$\n$$\n\\Delta\\sigma_{I}^{\\mathrm{SPC/E}} = \\left(\\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{\\mathrm{SPC/E}}\\right) - \\left(\\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{\\mathrm{TIP3P}}\\right)\n$$\n包含 $r^{\\star}$ 的项相互抵消：\n$$\n\\Delta\\sigma_{I}^{\\mathrm{SPC/E}} = \\sigma_{O}^{\\mathrm{TIP3P}} - \\sigma_{O}^{\\mathrm{SPC/E}}\n$$\n使用给定值：$\\sigma_{O}^{\\mathrm{TIP3P}}=3.1506$ Å 和 $\\sigma_{O}^{\\mathrm{SPC/E}}=3.1660$ Å。\n$$\n\\Delta\\sigma_{I}^{\\mathrm{SPC/E}} = 3.1506 - 3.1660 = -0.0154 \\text{ Å}\n$$\n同理，对于 TIP4P/2005 模型，变化量为：\n$$\n\\Delta\\sigma_{I}^{\\mathrm{TIP4P/2005}} = \\sigma_{I}^{\\mathrm{TIP4P/2005}} - \\sigma_{I}^{\\mathrm{TIP3P}}\n$$\n$$\n\\Delta\\sigma_{I}^{\\mathrm{TIP4P/2005}} = \\left(\\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{\\mathrm{TIP4P/2005}}\\right) - \\left(\\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{\\mathrm{TIP3P}}\\right)\n$$\n$$\n\\Delta\\sigma_{I}^{\\mathrm{TIP4P/2005}} = \\sigma_{O}^{\\mathrm{TIP3P}} - \\sigma_{O}^{\\mathrm{TIP4P/2005}}\n$$\n使用给定值：$\\sigma_{O}^{\\mathrm{TIP3P}}=3.1506$ Å 和 $\\sigma_{O}^{\\mathrm{TIP4P/2005}}=3.1589$ Å。\n$$\n\\Delta\\sigma_{I}^{\\mathrm{TIP4P/2005}} = 3.1506 - 3.1589 = -0.0083 \\text{ Å}\n$$\n问题要求结果四舍五入到四位有效数字。\n- 对于 SPC/E，$\\Delta\\sigma_{I}^{\\mathrm{SPC/E}} = -0.0154$ Å。为了用四位有效数字表示，我们写作 $-0.01540$ Å。\n- 对于 TIP4P/2005，$\\Delta\\sigma_{I}^{\\mathrm{TIP4P/2005}} = -0.0083$ Å。为了用四位有效数字表示，我们写作 $-0.008300$ Å。\n\n最终答案以双分量行向量 $\\left[\\Delta\\sigma_{I}^{\\mathrm{SPC/E}},\\,\\Delta\\sigma_{I}^{\\mathrm{TIP4P/2005}}\\right]$ 的形式呈现。\n该向量为 $\\begin{pmatrix} -0.01540 & -0.008300 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.01540 & -0.008300 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个优秀的力场不仅要能复现微观结构，还必须能准确预测宏观物理性质。本练习旨在连接微观模拟与宏观可观测量，重点关注介电常数（$\\varepsilon_r$），这是电解质体系的一个关键性质。你将学习如何基于涨落-耗散定理，通过分析分子动力学模拟产生的总偶极矩轨迹来计算介电常数，并使用分块平均法来估计其统计不确定性。这项编程实践将使你具备从原始模拟数据中提取重要热力学性质的能力。",
            "id": "4246382",
            "problem": "给定一个在分子动力学（MD）中，在周期性边界条件下生成的模拟电解质或溶剂体系的总偶极矩矢量的时间离散轨迹。时间索引为 $t$ 时的总偶极矩表示为 $\\mathbf{M}(t)$，其分量单位为库仑-米。相对介电常数（也称为介电常数）$\\varepsilon_r$ 可以通过线性响应理论和涨落-耗散定理与总偶极矩的平衡涨落联系起来。假设体系是各向同性的，并且表面效应可以忽略，这适用于周期性边界条件下的体相系统。\n\n从基本静电学和统计力学出发，宏观极化强度 $\\mathbf{P}$ 满足 $\\mathbf{P} = \\varepsilon_0 \\chi_e \\mathbf{E}$，其中 $\\varepsilon_0$ 是真空介电常数，$\\chi_e$ 是电极化率，$\\mathbf{E}$ 是外加电场。在没有外场的平衡状态下，电极化率可以用偶极矩涨落来表示。对于一个体积为 $V$、温度为 $T$ 的立方模拟晶胞，其相对介电常数为\n$$\n\\varepsilon_r = 1 + \\chi_e = 1 + \\frac{\\langle \\mathbf{M}^2 \\rangle - \\langle \\mathbf{M} \\rangle^2}{3 \\, \\varepsilon_0 \\, V \\, k_B \\, T},\n$$\n其中 $\\langle \\cdot \\rangle$ 表示平衡系综平均，$\\mathbf{M}^2 = \\mathbf{M} \\cdot \\mathbf{M}$ 是总偶极矩矢量的模的平方，$k_B$ 是 Boltzmann 常数。因子 $3$ 是因为对各向同性的方向进行了平均。\n\n你的任务是实现一个程序，通过对给定的合成轨迹进行分块平均来计算 $\\varepsilon_r$，并估计其统计不确定性。具体来说：\n\n- 将轨迹划分为长度相等、连续且不重叠的块。如果总帧数不能被块长度整除，则丢弃末尾剩余的帧。\n- 对每个块 $b$，计算块平均值 $\\langle \\mathbf{M} \\rangle_b$ 和模平方的块平均值 $\\langle \\mathbf{M}^2 \\rangle_b$。\n- 计算块估计值\n$$\n\\varepsilon_{r,b} = 1 + \\frac{\\langle \\mathbf{M}^2 \\rangle_b - \\left\\| \\langle \\mathbf{M} \\rangle_b \\right\\|^2}{3 \\, \\varepsilon_0 \\, V \\, k_B \\, T}.\n$$\n- 计算所有块的平均值 $\\overline{\\varepsilon_r}$ 作为 $\\varepsilon_r$ 的估计值，并计算所有块的平均值标准误差（SEM）作为不确定度。如果块的数量小于 $2$，则不确定度应报告为浮点数“非数值”（Not-a-Number）。\n- 将 $\\varepsilon_r$ 和不确定度均表示为无量纲数。在最终输出中，两者都应四舍五入到五位小数。\n\n使用以下合成测试套件，其中规定了如何为每种情况构建 $\\mathbf{M}(t)$。在所有情况下，将 $\\mathbf{M}(t)$ 生成为具有独立分量的 Gaussian 随机矢量过程，并且除非另有说明，否则均值为零。对于目标介电常数 $\\varepsilon_r^{\\mathrm{target}}$，选择每个分量的标准差 $\\sigma$，使得\n$$\n\\mathbb{E}\\left[ \\mathbf{M}^2 \\right] \\approx 3 \\sigma^2 = 3 \\, \\varepsilon_0 \\, V \\, k_B \\, T \\, \\left( \\varepsilon_r^{\\mathrm{target}} - 1 \\right).\n$$\n这使得当 $\\langle \\mathbf{M} \\rangle \\approx \\mathbf{0}$ 时，合成轨迹与 $\\varepsilon_r$ 的涨落公式一致。\n\n常数：\n- 使用 $k_B = 1.380649 \\times 10^{-23}$，单位为焦耳/开尔文。\n- 使用指定的 $\\varepsilon_0$ 值，单位为法拉/米。\n\n测试套件参数（所有体积均为立方体盒子，所有单位必须严格按照说明使用）：\n- 情况 1 (理想情况，类水体系)：\n  - $N = 1000$ 帧，块长度 $100$ 帧。\n  - $V = (3.0 \\times 10^{-9} \\, \\mathrm{m})^3$。\n  - $T = 298 \\, \\mathrm{K}$。\n  - $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\, \\mathrm{F/m}$。\n  - 随机种子 $1$。\n  - $\\varepsilon_r^{\\mathrm{target}} = 78$。\n  - 平均偏移矢量 $\\mathbf{m}_0 = \\mathbf{0}$。\n- 情况 2 (较低介电常数，类甲醇体系)：\n  - $N = 800$ 帧，块长度 $200$ 帧。\n  - $V = (2.5 \\times 10^{-9} \\, \\mathrm{m})^3$。\n  - $T = 310 \\, \\mathrm{K}$。\n  - $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\, \\mathrm{F/m}$。\n  - 随机种子 $2$。\n  - $\\varepsilon_r^{\\mathrm{target}} = 33$。\n  - 平均偏移矢量 $\\mathbf{m}_0 = \\mathbf{0}$。\n- 情况 3 (类离子液体，小介电常数)：\n  - $N = 500$ 帧，块长度 $100$ 帧。\n  - $V = (4.0 \\times 10^{-9} \\, \\mathrm{m})^3$。\n  - $T = 298 \\, \\mathrm{K}$。\n  - $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\, \\mathrm{F/m}$。\n  - 随机种子 $3$。\n  - $\\varepsilon_r^{\\mathrm{target}} = 12$。\n  - 平均偏移矢量 $\\mathbf{m}_0 = \\mathbf{0}$。\n- 情况 4 (非零均值和余数块丢棄的边缘情况)：\n  - $N = 201$ 帧，块长度 $100$ 帧。\n  - $V = (3.2 \\times 10^{-9} \\, \\mathrm{m})^3$。\n  - $T = 350 \\, \\mathrm{K}$。\n  - $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\, \\mathrm{F/m}$。\n  - 随机种子 $4$。\n  - $\\varepsilon_r^{\\mathrm{target}} = 60$。\n  - 平均偏移矢量 $\\mathbf{m}_0 = (1.0 \\times 10^{-28}, 0, 0)$，单位为库仑-米，加到每一帧上。\n\n算法要求：\n- 对于每种情况，使用指定的随机种子和参数生成 $\\mathbf{M}(t)$。\n- 丢弃任何不适合指定块长度的完整块的剩余帧。\n- 计算每个块的 $\\varepsilon_{r,b}$，然后计算所有块的平均值和平均值的标准误差。\n- 将报告的 $\\varepsilon_r$ 和不确定度四舍五入到五位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，其中每个条目本身都是对应测试用例的一个双元素列表 $[\\varepsilon_r, \\text{uncertainty}]$，例如 $[[\\varepsilon_1, u_1],[\\varepsilon_2, u_2],\\dots]$。",
            "solution": "该问题已经过验证，被认定是合理的。它具有科学依据，问题陈述清晰，并包含唯一、可验证解所需的所有必要信息。\n\n任务是从系统的总电偶极矩 $\\mathbf{M}(t)$ 的时间离散轨迹计算其静态相对介电常数 $\\varepsilon_r$。该计算基于统计力学的原理，特别是涨落-耗散定理，该定理将系统的平衡涨落与其对外部扰动的线性响应联系起来。在此背景下，相对介电常数与模拟体积的总偶极矩涨落有关。\n\n所提供的主导方程是在计算化学和物理学中用于描述体积为 $V$、绝对温度为 $T$、处于周期性边界条件下的立方模拟晶胞系统的标准公式：\n$$\n\\varepsilon_r = 1 + \\chi_e = 1 + \\frac{\\langle \\mathbf{M}^2 \\rangle - \\left\\| \\langle \\mathbf{M} \\rangle \\right\\|^2}{3 \\, \\varepsilon_0 \\, V \\, k_B \\, T}\n$$\n这里，$\\varepsilon_0$ 是真空介电常数，$k_B$ 是 Boltzmann 常数，$\\chi_e$ 是电极化率。项 $\\langle \\mathbf{M}^2 \\rangle - \\left\\| \\langle \\mathbf{M} \\rangle \\right\\|^2$ 表示在平衡系综上计算的总偶极矩矢量方差 $\\text{Var}(\\mathbf{M})$。尖括号 $\\langle \\cdot \\rangle$ 表示系综平均，根据遍历性假设，它被替换为在足够长的 NVT（粒子数、体积和温度恒定）分子动力学轨迹上的时间平均。分母中的因子 $3$ 源于各向同性系统的假设，其中涨落是在三个空间维度上平均的。\n\n为了估计计算出的 $\\varepsilon_r$ 的统计不确定性，采用了分块平均法。这是一种评估收敛性和估计相关时间序列数据误差的标准技术，而分子动力学轨迹正是典型的时间序列数据。\n\n算法流程如下：\n\n1.  **合成轨迹生成**：\n    对于每个测试用例，生成一个总偶极矩矢量 $\\mathbf{M}(t)$ 的合成轨迹，共 $N$ 个时间步。每个 $\\mathbf{M}(t)$ 是一个三维矢量，其分量独立地从 Gaussian（正态）分布中抽取。该分布由一个平均矢量 $\\mathbf{m}_0$ 和每个分量的标准差 $\\sigma$ 来表征。$\\sigma$ 的值是通过反转漲落公式专门选择的，以与目标相对介电常数 $\\varepsilon_r^{\\text{target}}$ 保持一致。假设 $\\langle \\mathbf{M} \\rangle = \\mathbf{0}$，公式简化为 $\\varepsilon_r - 1 \\approx \\langle \\mathbf{M}^2 \\rangle / (3 \\varepsilon_0 V k_B T)$。对于一个均值为零、每分量方差为 $\\sigma^2$ 的三维 Gaussian 过程，其模平方的期望值为 $\\mathbb{E}[\\mathbf{M}^2] = \\mathbb{E}[M_x^2 + M_y^2 + M_z^2] = \\sigma^2 + \\sigma^2 + \\sigma^2 = 3\\sigma^2$。将期望值与系综平均值等同，我们得到 $3\\sigma^2 = 3 \\varepsilon_0 V k_B T (\\varepsilon_r^{\\text{target}} - 1)$，由此得出随机数生成器所需的方差：\n    $$\n    \\sigma^2 = \\varepsilon_0 \\, V \\, k_B \\, T \\, (\\varepsilon_r^{\\text{target}} - 1)\n    $$\n    每个案例都使用指定的随机种子以确保轨迹的可复现性。最终的轨迹为 $\\mathbf{M}(t) = \\mathbf{M}_{\\text{random}}(t) + \\mathbf{m}_0$。\n\n2.  **分块**：\n    将生成的长度为 $N$ 的轨迹划分为若干连续、不重叠的块，块数为 $n_b = \\lfloor N / L \\rfloor$，其中 $L$ 是指定的块长度。轨迹末尾任何不能构成完整块的帧（$N \\pmod L$ 帧）都将被丢弃。这确保了所有块的大小相等，从而简化了统计分析。\n\n3.  **分块计算**：\n    对于每个块 $b$，我们计算相对介电常数 $\\varepsilon_{r,b}$ 的一个独立估计值。这涉及到计算该块内各帧的必要平均值：\n    - 该块的平均偶极矩矢量：$\\langle \\mathbf{M} \\rangle_b = \\frac{1}{L} \\sum_{i \\in b} \\mathbf{M}(i)$。\n    - 偶极矩模平方的平均值：$\\langle \\mathbf{M}^2 \\rangle_b = \\frac{1}{L} \\sum_{i \\in b} \\mathbf{M}(i) \\cdot \\mathbf{M}(i)$。\n    - 然后使用以下公式计算特定于块的介电常数：\n    $$\n    \\varepsilon_{r,b} = 1 + \\frac{\\langle \\mathbf{M}^2 \\rangle_b - \\left\\| \\langle \\mathbf{M} \\rangle_b \\right\\|^2}{3 \\, \\varepsilon_0 \\, V \\, k_B \\, T}\n    $$\n\n4.  **最终统计**：\n    这组分块估计值 $\\{\\varepsilon_{r,1}, \\varepsilon_{r,2}, \\dots, \\varepsilon_{r,n_b}\\}$被视为 $\\varepsilon_r$ 的一组独立测量样本。\n    - 相对介电常数的最终最佳估计值 $\\overline{\\varepsilon_r}$ 是这些块值的平均值：$\\overline{\\varepsilon_r} = \\frac{1}{n_b} \\sum_{b=1}^{n_b} \\varepsilon_{r,b}$。\n    - 不确定度通过平均值的标准误差（SEM）来估计，它量化了平均值估计的精度：\n    $$\n    \\text{SEM} = \\frac{s_{\\varepsilon_{r}}}{\\sqrt{n_b}}\n    $$\n    其中 $s_{\\varepsilon_{r}}$ 是集合 $\\{\\varepsilon_{r,b}\\}$ 的样本标准差，使用 Bessel's correction（即使用前置因子 $1/(n_b-1)$）计算。\n    - 如果块数 $n_b$ 小于 $2$，则标准差未定义，不确定度报告为非数值（Not-a-Number, NaN）。\n\n最后，根据要求将计算出的平均值 $\\overline{\\varepsilon_r}$ 及其不确定度（SEM）四舍五入到五位小数。将此完整过程系统地应用于提供的每个测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the static relative permittivity and its uncertainty from synthetic\n    Molecular Dynamics trajectories using a block averaging method.\n    \"\"\"\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    test_cases = [\n        {\n            \"N\": 1000, \"block_length\": 100, \"L_box\": 3.0e-9, \"T\": 298.0,\n            \"eps0\": 8.854187817e-12, \"seed\": 1, \"eps_r_target\": 78.0,\n            \"m0\": np.array([0.0, 0.0, 0.0])\n        },\n        {\n            \"N\": 800, \"block_length\": 200, \"L_box\": 2.5e-9, \"T\": 310.0,\n            \"eps0\": 8.854187817e-12, \"seed\": 2, \"eps_r_target\": 33.0,\n            \"m0\": np.array([0.0, 0.0, 0.0])\n        },\n        {\n            \"N\": 500, \"block_length\": 100, \"L_box\": 4.0e-9, \"T\": 298.0,\n            \"eps0\": 8.854187817e-12, \"seed\": 3, \"eps_r_target\": 12.0,\n            \"m0\": np.array([0.0, 0.0, 0.0])\n        },\n        {\n            \"N\": 201, \"block_length\": 100, \"L_box\": 3.2e-9, \"T\": 350.0,\n            \"eps0\": 8.854187817e-12, \"seed\": 4, \"eps_r_target\": 60.0,\n            \"m0\": np.array([1.0e-28, 0.0, 0.0])\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        block_length = case[\"block_length\"]\n        V = case[\"L_box\"] ** 3\n        T = case[\"T\"]\n        eps0 = case[\"eps0\"]\n        seed = case[\"seed\"]\n        eps_r_target = case[\"eps_r_target\"]\n        m0 = case[\"m0\"]\n\n        denom = 3 * eps0 * V * K_B * T\n        sigma_sq = denom / 3 * (eps_r_target - 1)\n        sigma = np.sqrt(sigma_sq)\n\n        rng = np.random.default_rng(seed)\n        M_trajectory = rng.normal(loc=0.0, scale=sigma, size=(N, 3)) + m0\n\n        n_blocks = N // block_length\n        if n_blocks == 0:\n            results.append([float('nan'), float('nan')])\n            continue\n            \n        n_frames_to_use = n_blocks * block_length\n        M_used_trajectory = M_trajectory[:n_frames_to_use]\n        \n        M_blocks = M_used_trajectory.reshape(n_blocks, block_length, 3)\n\n        M_sq_mag_frames = np.sum(M_blocks**2, axis=2)\n        block_avg_M_sq_mag = np.mean(M_sq_mag_frames, axis=1)\n\n        block_avg_M_vec = np.mean(M_blocks, axis=1)\n        block_avg_M_vec_sq_mag = np.sum(block_avg_M_vec**2, axis=1)\n\n        numerator = block_avg_M_sq_mag - block_avg_M_vec_sq_mag\n        eps_r_blocks = 1 + numerator / denom\n\n        mean_eps_r = np.mean(eps_r_blocks)\n        \n        if n_blocks  2:\n            sem_eps_r = float('nan')\n        else:\n            sem_eps_r = np.std(eps_r_blocks, ddof=1) / np.sqrt(n_blocks)\n            \n        results.append([round(mean_eps_r, 5), round(sem_eps_r, 5)])\n\n    # Format and print the final output string as requested\n    # The output format is a list of lists, e.g., [[val1, unc1], [val2, unc2], ...]\n    final_output_str = \"[\" + \", \".join([f\"[{res[0]}, {res[1]}]\" for res in results]) + \"]\"\n    print(final_output_str)\n\n# The problem asks for a program that produces the output.\n# Defining the function and calling it is a complete program.\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}