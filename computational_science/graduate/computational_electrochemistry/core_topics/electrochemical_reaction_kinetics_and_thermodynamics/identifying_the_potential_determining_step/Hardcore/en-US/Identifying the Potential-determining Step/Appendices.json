{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides practice with a foundational analysis in computational electrocatalysis: determining the theoretical overpotential. Using a set of calculated free energies for the elementary steps of the oxygen evolution reaction, you will identify the single thermodynamic bottleneck—the potential-determining step (PDS)—and compute the minimum excess potential required to make the entire reaction sequence spontaneous. This calculation  is a cornerstone of the Computational Hydrogen Electrode (CHE) framework.",
            "id": "4248384",
            "problem": "An oxide electrocatalyst for the oxygen evolution reaction is studied within the Computational Hydrogen Electrode (CHE) framework. Consider the canonical four-step mechanism on a single active site, where asterisks denote surface-bound intermediates:\n$(1) \\ast + \\mathrm{H_{2}O(l)} \\rightarrow \\ast\\mathrm{OH} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$,\n$(2) \\ast\\mathrm{OH} \\rightarrow \\ast\\mathrm{O} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$,\n$(3) \\ast\\mathrm{O} + \\mathrm{H_{2}O(l)} \\rightarrow \\ast\\mathrm{OOH} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$,\n$(4) \\ast\\mathrm{OOH} \\rightarrow \\ast + \\mathrm{O_{2}(g)} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$.\n\nAt an electrode potential of $U=0$ relative to the Reversible Hydrogen Electrode (RHE), first-principles calculations provide the following standard-state step free energies (including zero-point energy and entropic corrections), each expressed as $\\Delta G_{i}(0)$ in electronvolts: $\\Delta G_{1}(0)=1.62$, $\\Delta G_{2}(0)=1.79$, $\\Delta G_{3}(0)=2.05$, $\\Delta G_{4}(0)=1.26$. Assume that each elementary step transfers $n_{i}=1$ electron and that the CHE description applies, so that the free energy of any step depends linearly on the electrode potential $U$ relative to RHE. The overall equilibrium potential for the oxygen evolution reaction under these conditions is $U_{\\mathrm{eq}}=1.23$ volts relative to RHE.\n\nUsing only fundamental thermodynamic reasoning appropriate to electrochemical systems, determine the smallest applied potential $U_{\\mathrm{L}}$ (in volts relative to RHE) that renders all four elementary steps exergonic (downhill in free energy). Then, define the thermodynamic overpotential as $\\eta=U_{\\mathrm{L}}-U_{\\mathrm{eq}}$ and compute its value. Identify which specific elementary step is the potential-determining step that sets $\\eta$. Report the overpotential in volts and round your numerical answer to four significant figures.",
            "solution": "The problem is first subjected to validation.\n\nStep 1: Extracted Givens\n-   **Catalytic System**: An oxide electrocatalyst for the oxygen evolution reaction (OER).\n-   **Framework**: Computational Hydrogen Electrode (CHE).\n-   **Mechanism**: A canonical four-step mechanism on a single active site ($\\ast$).\n    1.  $\\ast + \\mathrm{H_{2}O(l)} \\rightarrow \\ast\\mathrm{OH} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$\n    2.  $\\ast\\mathrm{OH} \\rightarrow \\ast\\mathrm{O} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$\n    3.  $\\ast\\mathrm{O} + \\mathrm{H_{2}O(l)} \\rightarrow \\ast\\mathrm{OOH} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$\n    4.  $\\ast\\mathrm{OOH} \\rightarrow \\ast + \\mathrm{O_{2}(g)} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$\n-   **Step Free Energies at $U=0$ V vs RHE**:\n    -   $\\Delta G_{1}(0) = 1.62$ eV\n    -   $\\Delta G_{2}(0) = 1.79$ eV\n    -   $\\Delta G_{3}(0) = 2.05$ eV\n    -   $\\Delta G_{4}(0) = 1.26$ eV\n-   **Electron Transfer**: $n_{i}=1$ electron for each step $i$.\n-   **Potential Dependence**: The free energy of each step depends linearly on the electrode potential $U$ relative to RHE.\n-   **Equilibrium Potential**: The overall equilibrium potential for OER is $U_{\\mathrm{eq}} = 1.23$ V vs RHE.\n-   **Tasks**:\n    1.  Determine the smallest applied potential $U_{\\mathrm{L}}$ that renders all four steps exergonic.\n    2.  Compute the thermodynamic overpotential $\\eta=U_{\\mathrm{L}}-U_{\\mathrm{eq}}$.\n    3.  Identify the potential-determining step.\n    4.  Report $\\eta$ rounded to four significant figures.\n\nStep 2: Validation Using Extracted Givens\nThe problem is scientifically grounded, employing the standard CHE model for analyzing electrocatalytic reaction mechanisms. The four-step OER pathway is a canonical model, and the use of first-principles free energies is a cornerstone of computational electrochemistry. The problem is well-posed and objective.\n\nA self-consistency check on the provided thermodynamic data is necessary. The overall OER, $2\\mathrm{H_{2}O(l)} \\rightarrow \\mathrm{O_{2}(g)} + 4\\mathrm{H^{+}} + 4\\mathrm{e^{-}}$, is the summation of the four elementary steps. Therefore, the overall free energy change at zero potential, $\\Delta G_{\\mathrm{overall}}(0)$, must equal the sum of the step free energies, $\\sum_{i=1}^{4} \\Delta G_{i}(0)$. From the data, this sum is $1.62 + 1.79 + 2.05 + 1.26 = 6.72$ eV. The overall free energy change is also related to the equilibrium potential $U_{\\mathrm{eq}}$ by the fundamental thermodynamic relation $\\Delta G_{\\mathrm{overall}}(0) = 4eU_{\\mathrm{eq}}$. Using the provided value $U_{\\mathrm{eq}} = 1.23$ V, we find $\\Delta G_{\\mathrm{overall}}(0) = 4 \\times e \\times 1.23\\text{ V} = 4.92$ eV.\n\nThe value derived from the sum of step energies ($6.72$ eV) is inconsistent with the value derived from the provided equilibrium potential ($4.92$ eV). This is not, however, a flaw that invalidates the problem. It reflects a common and realistic scenario in computational materials science, where the employed theoretical method (e.g., a specific DFT functional) generates step energies that, when summed, do not perfectly reproduce the experimentally known overall reaction thermodynamics. The problem is thus a valid exercise in evaluating the performance of a given computational model, specifically calculating the limiting potential and overpotential predicted by that model with reference to the correct thermodynamic benchmark. The inputs are self-consistent *within the context of this evaluation procedure*.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\nThe free energy change of each elementary step $i$, which involves the transfer of one proton and one electron ($n_{i}=1$), depends on the electrode potential $U$ relative to the RHE according to the Computational Hydrogen Electrode (CHE) model:\n$$ \\Delta G_{i}(U) = \\Delta G_{i}(0) - eU $$\nwhere $\\Delta G_{i}(0)$ is the standard free energy change at $U=0$ V vs. RHE, and $e$ is the elementary charge.\n\nFor a reaction to proceed spontaneously, all of its elementary steps must be exergonic, meaning their free energy change must be non-positive:\n$$ \\Delta G_{i}(U) \\le 0 $$\nSubstituting the expression for $\\Delta G_{i}(U)$ into this inequality yields a condition on the minimum required potential for each step:\n$$ \\Delta G_{i}(0) - eU \\le 0 \\implies U \\ge \\frac{\\Delta G_{i}(0)}{e} $$\nSince the free energies $\\Delta G_{i}(0)$ are provided in units of electronvolts (eV), the required potential in volts (V) is numerically equivalent to the free energy value in eV. We apply this condition to each of the four steps:\nFor step 1: $U \\ge \\frac{1.62 \\text{ eV}}{e} = 1.62 \\text{ V}$\nFor step 2: $U \\ge \\frac{1.79 \\text{ eV}}{e} = 1.79 \\text{ V}$\nFor step 3: $U \\ge \\frac{2.05 \\text{ eV}}{e} = 2.05 \\text{ V}$\nFor step 4: $U \\ge \\frac{1.26 \\text{ eV}}{e} = 1.26 \\text{ V}$\n\nTo ensure that all four steps are simultaneously exergonic, the applied potential $U$ must be at least as large as the maximum of these individual potential requirements. This potential is defined as the thermodynamic limiting potential, $U_{\\mathrm{L}}$:\n$$ U_{\\mathrm{L}} = \\max\\left(\\frac{\\Delta G_{1}(0)}{e}, \\frac{\\Delta G_{2}(0)}{e}, \\frac{\\Delta G_{3}(0)}{e}, \\frac{\\Delta G_{4}(0)}{e}\\right) $$\n$$ U_{\\mathrm{L}} = \\max(1.62, 1.79, 2.05, 1.26) \\text{ V} = 2.05 \\text{ V} $$\n\nThe elementary step that necessitates this highest potential is the one that limits the overall process from a thermodynamic standpoint. Here, that is step (3), which has the largest reaction free energy at zero potential, $\\Delta G_{3}(0)=2.05$ eV. Therefore, the reaction $\\ast\\mathrm{O} + \\mathrm{H_{2}O(l)} \\rightarrow \\ast\\mathrm{OOH} + \\mathrm{H^{+}} + \\mathrm{e^{-}}$ is the potential-determining step (PDS).\n\nThe thermodynamic overpotential, $\\eta$, is the excess potential required above the thermodynamic equilibrium potential, $U_{\\mathrm{eq}}$, to drive all elementary steps of the reaction downhill in free energy. It is calculated as the difference between the limiting potential, $U_{\\mathrm{L}}$, and the equilibrium potential, $U_{\\mathrm{eq}}$:\n$$ \\eta = U_{\\mathrm{L}} - U_{\\mathrm{eq}} $$\nUsing the calculated value $U_{\\mathrm{L}} = 2.05$ V and the given value $U_{\\mathrm{eq}} = 1.23$ V:\n$$ \\eta = 2.05 \\text{ V} - 1.23 \\text{ V} = 0.82 \\text{ V} $$\nThe problem requests the final answer to be rounded to four significant figures. The calculated value $0.82$ is exact based on the input data. To express this with four significant figures, we write:\n$$ \\eta = 0.8200 \\text{ V} $$\nThe potential-determining step is step (3).",
            "answer": "$$\\boxed{0.8200}$$"
        },
        {
            "introduction": "The identity of the potential-determining step is not static; it can change as a function of operating conditions like electrode potential ($U$) and acidity ($\\mathrm{pH}$). This computational practice challenges you to move beyond a single-point analysis by systematically mapping the PDS across a two-dimensional grid of $U$ and $\\mathrm{pH}$. By creating a \"PDS map,\" you will gain a comprehensive understanding of how a catalyst's thermodynamic landscape responds to changes in the electrochemical environment .",
            "id": "4248330",
            "problem": "You are given a three-step sequence of Proton-Coupled Electron Transfer (PCET) elementary reactions on a single, non-interacting active site at temperature $T = 298.15\\,\\mathrm{K}$. Each step $i \\in \\{1,2,3\\}$ has a standard reaction free energy $\\Delta G_i^0$ (in $\\mathrm{eV}$) defined at reference potential $U_{\\mathrm{ref}} = 0\\,\\mathrm{V}$ versus the Standard Hydrogen Electrode (SHE) and reference acidity $\\mathrm{pH}_{\\mathrm{ref}} = 0$. The step $i$ involves the transfer of $n_{e,i}$ electrons and $n_{H,i}$ protons, where $n_{e,i}$ and $n_{H,i}$ are nonnegative integers. Assume ideal solution behavior and the Computational Hydrogen Electrode (CHE) convention: the electrochemical potential of the proton–electron pair is given by the equilibrium with molecular hydrogen and depends linearly on the electrode potential and acidity. Under CHE, the reaction free energy shift for a step with stoichiometries $n_{e,i}$ and $n_{H,i}$ at electrode potential $U$ (in $\\mathrm{V}$ vs SHE) and acidity $\\mathrm{pH}$ is given by\n$$\n\\Delta G_i(U,\\mathrm{pH}) \\;=\\; \\Delta G_i^0 \\;-\\; n_{e,i}\\, U \\;-\\; n_{H,i}\\, \\lambda\\, \\mathrm{pH},\n$$\nwhere $\\lambda = k_{\\mathrm{B}} T \\ln 10$ expressed in $\\mathrm{eV}$, $k_{\\mathrm{B}}$ is the Boltzmann constant, and the electron charge is already absorbed by using $\\mathrm{eV}$ as the energy unit.\n\nDefine the Potential-Determining Step (PDS) at given $(U,\\mathrm{pH})$ as follows:\n- Compute $\\Delta G_i(U,\\mathrm{pH})$ for $i=1,2,3$.\n- Identify the set of uphill steps $\\mathcal{U} = \\{\\, i \\mid \\Delta G_i(U,\\mathrm{pH}) > 0 \\,\\}$.\n- If $\\mathcal{U}$ is empty, there is no PDS because all steps are downhill; denote this case as the category \"all-downhill.\"\n- Otherwise, find $M = \\max_{i \\in \\mathcal{U}} \\Delta G_i(U,\\mathrm{pH})$. If a unique index $i^\\star \\in \\mathcal{U}$ achieves $M$, then $i^\\star$ is the PDS. If multiple indices in $\\mathcal{U}$ achieve $M$ within an energy tolerance $\\epsilon$ (in $\\mathrm{eV}$), denote this case as the category \"tie\" for the PDS.\n\nYour task is to implement a program that sweeps a grid of $(U,\\mathrm{pH})$ values, identifies the PDS category at each grid point, and summarizes the fraction of grid points belonging to each category: step $1$ as PDS, step $2$ as PDS, step $3$ as PDS, tie, and all-downhill. Fractions must be reported as decimals. Use $\\epsilon = 10^{-12}\\,\\mathrm{eV}$ for tie detection.\n\nFundamental basis to be used:\n- The Computational Hydrogen Electrode (CHE) relation for the proton–electron pair: $G(\\mathrm{H}^+ + e^-) = \\tfrac{1}{2}G(\\mathrm{H}_2) - e U - k_{\\mathrm{B}} T \\ln 10 \\cdot \\mathrm{pH}$, with energies expressed in $\\mathrm{eV}$ so that $e$ is absorbed.\n- The microkinetic viewpoint that the potential-dependence of thermodynamic driving forces $\\,\\Delta G_i(U,\\mathrm{pH})\\,$ determines the potential-determining step through the largest uphill free energy among elementary steps.\n\nUnits and numerical requirements:\n- Energies $\\Delta G$ and $\\Delta G^0$ must be in $\\mathrm{eV}$.\n- Electrode potential $U$ must be in $\\mathrm{V}$ versus SHE.\n- Acidity $\\mathrm{pH}$ is dimensionless.\n- Temperature $T$ is in $\\mathrm{K}$ and fixed at $T = 298.15\\,\\mathrm{K}$.\n- Report the final fractions as decimals rounded to three decimal places.\n\nSweep definition:\n- Use a rectangular grid with $U \\in [0.0, 1.0]\\,\\mathrm{V}$ in increments of $0.1\\,\\mathrm{V}$ and $\\mathrm{pH} \\in [0, 14]$ in increments of $1$.\n\nTest suite:\nProvide results for the following three parameter sets. In all cases, let $\\lambda = k_{\\mathrm{B}} T \\ln 10$ be computed internally (in $\\mathrm{eV}$) from $k_{\\mathrm{B}}$ and $T$.\n\n1. Baseline PCET with identical stoichiometries:\n   - $\\Delta G^0 = [1.00,\\,0.90,\\,1.20]\\,\\mathrm{eV}$,\n   - $n_e = [1,\\,1,\\,1]$,\n   - $n_H = [1,\\,1,\\,1]$.\n\n2. Mixed proton stoichiometries to induce $\\mathrm{pH}$-dependent PDS changes:\n   - $\\Delta G^0 = [0.80,\\,0.90,\\,0.85]\\,\\mathrm{eV}$,\n   - $n_e = [1,\\,1,\\,1]$,\n   - $n_H = [1,\\,0,\\,2]$.\n\n3. Constructed degeneracy to produce explicit tie regions at $\\mathrm{pH} = 5$:\n   - $\\Delta G^0 = [0.50 + 5\\lambda,\\,0.50,\\,0.60]\\,\\mathrm{eV}$,\n   - $n_e = [1,\\,1,\\,1]$,\n   - $n_H = [1,\\,0,\\,1]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a list of five decimals $[f_1,f_2,f_3,f_{\\mathrm{tie}},f_{\\mathrm{all}}]$, where $f_1$ is the fraction of grid points where step $1$ is the PDS, $f_2$ for step $2$, $f_3$ for step $3$, $f_{\\mathrm{tie}}$ where ties occur, and $f_{\\mathrm{all}}$ where all steps are downhill. The overall output, aggregating all test cases, must be a list of these lists, for example: $[[f_1,f_2,f_3,f_{\\mathrm{tie}},f_{\\mathrm{all}}],\\,[\\cdots],\\,[\\cdots]]$.",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It presents a standard exercise in the field of computational electrochemistry, specifically the analysis of reaction mechanisms using the Computational Hydrogen Electrode (CHE) model. All necessary parameters, definitions, and constraints are provided, and no contradictions or ambiguities are present. Therefore, I will proceed with a full solution.\n\nThe objective is to categorize each point on a grid of electrode potential ($U$) and acidity ($\\mathrm{pH}$) according to the potential-determining step (PDS) of a three-step Proton-Coupled Electron Transfer (PCET) reaction. The fractions of grid points belonging to each category are then computed for three distinct parameter sets.\n\nThe core of the problem lies in the CHE model, which provides a framework for calculating the free energy change, $\\Delta G_i$, of an elementary reaction step $i$ as a function of $U$ and $\\mathrm{pH}$. A reaction step given by\n$$ \\text{Reactants}_i \\rightarrow \\text{Products}_i + n_{e,i} e^- + n_{H,i} \\mathrm{H}^+ $$\nhas a reaction free energy defined as:\n$$ \\Delta G_i(U,\\mathrm{pH}) = \\Delta G_i^0 - n_{e,i} U - n_{H,i} \\lambda \\mathrm{pH} $$\nwhere $\\Delta G_i^0$ is the standard free energy change at the reference state ($U=0\\,\\mathrm{V}$, $\\mathrm{pH}=0$), $n_{e,i}$ is the number of electrons released, $n_{H,i}$ is the number of protons released, and $\\lambda$ is a thermodynamic factor. The provided formula is the standard convention for the forward reaction step. The factor $\\lambda$ is given by:\n$$ \\lambda = k_{\\mathrm{B}} T \\ln(10) $$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant (in $\\mathrm{eV/K}$) and $T$ is the temperature in Kelvin. At $T = 298.15\\,\\mathrm{K}$ and using $k_{\\mathrm{B}} \\approx 8.617333 \\times 10^{-5}\\,\\mathrm{eV/K}$, we can compute $\\lambda \\approx 0.05916\\,\\mathrm{eV}$. This value quantifies the change in free energy per unit of $\\mathrm{pH}$.\n\nThe PDS is defined based on the thermodynamic landscape. An elementary step is energetically unfavorable, or \"uphill,\" if its reaction free energy is positive, i.e., $\\Delta G_i > 0$. The PDS is the most unfavorable step, corresponding to the one with the largest positive free energy. This represents the largest thermodynamic barrier in the reaction sequence under the simplifying assumption that activation barriers scale with reaction thermodynamics.\n\nThe algorithmic procedure to solve this problem is as follows:\n\n1.  **Define Constants and Grid**:\n    -   The Boltzmann constant, $k_{\\mathrm{B}}$, is set to its value in $\\mathrm{eV/K}$.\n    -   The temperature, $T$, is fixed at $298.15\\,\\mathrm{K}$.\n    -   The factor $\\lambda$ is computed.\n    -   A two-dimensional grid is constructed for the electrode potential, $U$, spanning $[0.0, 1.0]\\,\\mathrm{V}$ with increments of $0.1\\,\\mathrm{V}$ ($11$ points), and for the acidity, $\\mathrm{pH}$, spanning $[0, 14]$ with increments of $1$ ($15$ points). This results in a total of $11 \\times 15 = 165$ grid points.\n\n2.  **Iterate Through Test Cases**: The main logic is executed for each of the three provided parameter sets ($\\Delta G^0$, $n_e$, $n_H$).\n\n3.  **Calculate Free Energies**: For each test case, we compute the free energy $\\Delta G_i(U, \\mathrm{pH})$ for each step $i \\in \\{1, 2, 3\\}$ at every point $(U, \\mathrm{pH})$ on the grid. This is efficiently done using vectorized operations on the grid matrices. For each step $i$, a matrix of $\\Delta G_i$ values is generated, where the matrix dimensions correspond to the $\\mathrm{pH}$ and $U$ axes.\n\n4.  **Identify PDS Category at Each Grid Point**: At each $(U, \\mathrm{pH})$ point, we apply the rules for PDS determination:\n    a.  Identify the set of uphill steps, $\\mathcal{U} = \\{ i \\mid \\Delta G_i(U, \\mathrm{pH}) > 0 \\}$.\n    b.  **All-Downhill Case**: If $\\mathcal{U}$ is empty (all $\\Delta G_i \\le 0$), the point is classified as \"all-downhill\".\n    c.  **Uphill Case**: If $\\mathcal{U}$ is not empty, we find the maximum free energy among the uphill steps, $M = \\max_{i \\in \\mathcal{U}} \\Delta G_i$.\n    d.  We then identify all steps in $\\mathcal{U}$ whose free energy is within a small tolerance $\\epsilon = 10^{-12}\\,\\mathrm{eV}$ of this maximum, $M$.\n    e.  **Unique PDS**: If exactly one step $i^\\star$ satisfies this condition, it is designated as the PDS. The point is classified as \"PDS $i^\\star$\".\n    f.  **Tie Case**: If two or more steps satisfy the condition, the point is classified as a \"tie\".\n\n5.  **Compute and Report Fractions**: After classifying all $165$ grid points for a given test case, we count the number of points in each of the five categories (PDS 1, PDS 2, PDS 3, tie, all-downhill). These counts are then divided by the total number of grid points ($165$) to obtain the fraction for each category. The fractions are rounded to three decimal places.\n\nThis procedure is deterministic and computationally straightforward. The use of vectorized numerical libraries like NumPy is critical for an efficient and concise implementation, avoiding explicit loops over the grid points. The final output is an aggregation of the computed fraction lists for each test case.\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Potential-Determining Step (PDS) distribution for a 3-step\n    PCET reaction sequence over a grid of electrode potential (U) and acidity (pH).\n    \"\"\"\n\n    # Physical constants and problem parameters\n    K_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    T = 298.15  # Temperature in K\n    LAMBDA = K_B * T * np.log(10)  # pH energy factor in eV\n    TOLERANCE = 1e-12  # Energy tolerance for tie detection in eV\n\n    # Grid definition\n    u_grid = np.arange(0.0, 1.01, 0.1)\n    ph_grid = np.arange(0, 15, 1)\n    total_grid_points = len(u_grid) * len(ph_grid)\n    \n    # Create a meshgrid for vectorized calculations\n    U_mesh, pH_mesh = np.meshgrid(u_grid, ph_grid)\n\n    # Test suite from the problem statement\n    test_cases = [\n        {\n            \"dg0\": np.array([1.00, 0.90, 1.20]),\n            \"ne\": np.array([1, 1, 1]),\n            \"nh\": np.array([1, 1, 1]),\n        },\n        {\n            \"dg0\": np.array([0.80, 0.90, 0.85]),\n            \"ne\": np.array([1, 1, 1]),\n            \"nh\": np.array([1, 0, 2]),\n        },\n        {\n            \"dg0\": np.array([0.50 + 5 * LAMBDA, 0.50, 0.60]),\n            \"ne\": np.array([1, 1, 1]),\n            \"nh\": np.array([1, 0, 1]),\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        dg0_vals = case[\"dg0\"]\n        ne_vals = case[\"ne\"]\n        nh_vals = case[\"nh\"]\n\n        # Calculate Delta G for each step across the entire (U, pH) grid\n        # Shape of each delta_g matrix will be (len(ph_grid), len(u_grid))\n        delta_g1 = dg0_vals[0] - ne_vals[0] * U_mesh - nh_vals[0] * LAMBDA * pH_mesh\n        delta_g2 = dg0_vals[1] - ne_vals[1] * U_mesh - nh_vals[1] * LAMBDA * pH_mesh\n        delta_g3 = dg0_vals[2] - ne_vals[2] * U_mesh - nh_vals[2] * LAMBDA * pH_mesh\n\n        # Stack the three Delta G matrices for unified processing\n        # Shape of delta_g_stack will be (3, len(ph_grid), len(u_grid))\n        delta_g_stack = np.array([delta_g1, delta_g2, delta_g3])\n\n        # Identify uphill steps (Delta G > 0)\n        uphill_mask = delta_g_stack > 0\n\n        # Mask non-uphill steps with -inf to exclude them from max finding\n        masked_delta_g = np.where(uphill_mask, delta_g_stack, -np.inf)\n\n        # Find the maximum uphill Delta G at each grid point\n        max_g_per_point = np.max(masked_delta_g, axis=0)\n\n        # Check for all-downhill case (where max_g will be -inf)\n        is_all_downhill = np.isneginf(max_g_per_point)\n\n        # Check for ties: count how many steps are within TOLERANCE of the maximum\n        # is_max will be a boolean array of the same shape as delta_g_stack\n        is_max = (max_g_per_point - masked_delta_g) <= TOLERANCE\n        # tie_count_per_point will be a 2D array\n        tie_count_per_point = np.sum(is_max, axis=0)\n\n        # Identify the index of the PDS (0, 1, or 2)\n        pds_index_map = np.argmax(masked_delta_g, axis=0)\n        \n        # Define category indices: 0:PDS1, 1:PDS2, 2:PDS3, 3:tie, 4:all-downhill\n        category_map = np.full(U_mesh.shape, -1, dtype=int)\n\n        # Apply classification rules\n        # 1. All-downhill case\n        category_map[is_all_downhill] = 4\n        # 2. Tie case\n        category_map[~is_all_downhill & (tie_count_per_point > 1)] = 3\n        # 3. Unique PDS case\n        category_map[~is_all_downhill & (tie_count_per_point == 1)] = pds_index_map[~is_all_downhill & (tie_count_per_point == 1)]\n\n        # Count occurrences of each category\n        # minlength=5 ensures bins for all 5 categories, even if some don't occur\n        counts = np.bincount(category_map.flatten(), minlength=5)\n\n        # Calculate fractions and round to 3 decimal places\n        fractions = np.round(counts / total_grid_points, 3)\n\n        all_results.append(fractions.tolist())\n\n    # Format output string to match the required format precisely\n    # e.g., [[d.ddd,d.ddd,...],[...],...] with no spaces\n    result_strs = [f\"[{','.join(f'{f:.3f}' for f in res)}]\" for res in all_results]\n    final_output = f\"[{','.join(result_strs)}]\"\n    \n    return final_output\n```",
            "answer": "[[0.000,0.000,0.745,0.000,0.255],[0.182,0.448,0.103,0.000,0.267],[0.333,0.273,0.133,0.061,0.200]]"
        },
        {
            "introduction": "Computational models are powerful but have inherent uncertainties, a reality this practice directly addresses. When two reaction steps have nearly identical free energies, definitively identifying the PDS becomes challenging. This exercise  asks you to quantify the potential window of this ambiguity and, crucially, to bridge the gap between theory and experiment by proposing kinetic measurements that could resolve which step truly limits the reaction rate.",
            "id": "4248281",
            "problem": "Consider an electrocatalytic pathway analyzed within the Computational Hydrogen Electrode (CHE) framework at $T=298\\,\\text{K}$ and fixed $\\text{pH}$, referenced to the Reversible Hydrogen Electrode (RHE). Two consecutive candidate proton-coupled electron transfer (PCET) steps, labeled $A$ and $B$, compete to be the potential-determining step (PDS). In the CHE formalism, the potential-dependent grand free energy for step $i \\in \\{A,B\\}$ is modeled as linear in the applied potential $U$,\n$$\n\\Delta G_{i}(U)=\\Delta G_{i}(0)-n_{i}\\,e\\,U+\\mu_{\\text{dl},i}(U),\n$$\nwhere $n_{i}$ is the number of electrons transferred in the step, $e$ is the elementary charge, and $\\mu_{\\text{dl},i}(U)$ represents double-layer stabilization. Over a moderate potential range, assume a linear response $\\mu_{\\text{dl},i}(U)\\approx \\gamma_{i}\\,U$ with $\\gamma_{i}$ a constant in $\\text{eV}/\\text{V}$, so that $\\Delta G_{i}(U)=a_{i}+\\alpha_{i}\\,U$ with $a_{i}=\\Delta G_{i}(0)$ and $\\alpha_{i}=\\gamma_{i}-n_{i}\\,e$. Energies are reported in $\\text{eV}$ and potentials in $\\text{V}$.\n\nSuppose the following parameters have been computed for the two steps:\n- $a_{A}=0.50\\,\\text{eV}$, $n_{A}=1$, $\\gamma_{A}=0.15\\,\\text{eV}/\\text{V}$,\n- $a_{B}=0.53\\,\\text{eV}$, $n_{B}=1$, $\\gamma_{B}=-0.05\\,\\text{eV}/\\text{V}$.\n\nAssume a conservative methodological uncertainty, represented as a tolerance $\\sigma=0.03\\,\\text{eV}$ on step free energies. Define the PDS ambiguity window as the set of potentials $U$ for which the absolute free-energy difference between steps $A$ and $B$ is smaller than or equal to $\\sigma$, i.e., where the identity of the PDS cannot be resolved within the uncertainty window. Derive from first principles the inequality that bounds $U$ using the linear model above and compute the width of this potential window.\n\nIn addition, briefly propose targeted experiments that would most directly distinguish which of the two steps is the true PDS within the ambiguity window, and explain how their observables connect to the PDS concept.\n\nExpress the final numerical answer as the width of the potential window in volts (V). Round your answer to three significant figures.",
            "solution": "The user wants me to solve a computational electrochemistry problem after validating its premises.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **Framework**: Computational Hydrogen Electrode (CHE) at $T=298\\,\\text{K}$, fixed pH, referenced to the Reversible Hydrogen Electrode (RHE).\n- **Process**: Two consecutive proton-coupled electron transfer (PCET) steps, $A$ and $B$.\n- **Free Energy Model**: For step $i \\in \\{A,B\\}$, the potential-dependent grand free energy is $\\Delta G_{i}(U)=\\Delta G_{i}(0)-n_{i}\\,e\\,U+\\mu_{\\text{dl},i}(U)$.\n- **Double-Layer Model**: $\\mu_{\\text{dl},i}(U)\\approx \\gamma_{i}\\,U$.\n- **Simplified Linear Model**: $\\Delta G_{i}(U)=a_{i}+\\alpha_{i}\\,U$, where $a_{i}=\\Delta G_{i}(0)$ and $\\alpha_{i}=\\gamma_{i}-n_{i}\\,e$.\n- **Units**: Energies are in electron-volts ($\\text{eV}$) and potentials are in volts ($\\text{V}$).\n- **Parameters for Step A**: $a_{A}=0.50\\,\\text{eV}$, $n_{A}=1$, $\\gamma_{A}=0.15\\,\\text{eV}/\\text{V}$.\n- **Parameters for Step B**: $a_{B}=0.53\\,\\text{eV}$, $n_{B}=1$, $\\gamma_{B}=-0.05\\,\\text{eV}/\\text{V}$.\n- **Uncertainty**: A tolerance $\\sigma=0.03\\,\\text{eV}$ on step free energies.\n- **Definition**: The potential-determining step (PDS) ambiguity window is the set of potentials $U$ where the absolute free-energy difference is less than or equal to the uncertainty: $|\\Delta G_{A}(U) - \\Delta G_{B}(U)| \\le \\sigma$.\n- **Tasks**:\n    1. Derive the inequality that bounds $U$ for the ambiguity window.\n    2. Compute the width of this potential window.\n    3. Propose targeted experiments to distinguish the true PDS.\n    4. Provide the width as a final numerical answer, rounded to three significant figures.\n\n**1.2. Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in computational electrochemistry. The CHE model is a standard and widely accepted framework for analyzing electrocatalytic reaction mechanisms. The linear approximation of free energy with potential, including a term for double-layer effects, is a common and physically motivated simplification. The parameters provided are of a realistic magnitude.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary definitions, constants, and a clear objective. The definition of the ambiguity window is precise and leads to a solvable mathematical inequality with a unique solution for its width.\n- **Objectivity**: The problem is stated in objective, technical language, free from bias or subjective claims.\n- **Consistency and Completeness**: The problem is self-contained. A point of attention is the term $\\alpha_{i}=\\gamma_{i}-n_{i}\\,e$. In a unit system where energy is in $\\text{eV}$ and potential is in $\\text{V}$, the elementary charge $e$ is numerically equal to $1$ when used as a conversion factor (i.e., the energy change for one electron traversing $1\\,\\text{V}$ is $1\\,\\text{eV}$). Thus, the expression simplifies to $\\alpha_{i}=\\gamma_{i}-n_{i}$, which has units of $\\text{eV}/\\text{V}$ as required. This interpretation makes the setup consistent.\n- **Other Flaws**: The problem does not exhibit any other flaws from the checklist such as being trivial, unrealistic, or unverifiable.\n\n**1.3. Verdict and Action**\nThe problem is **valid**. A full solution will be provided.\n\n### Step 2: Solution Derivation\n\nThe problem asks for the derivation of the potential window wherein the identity of the potential-determining step (PDS) is ambiguous. The PDS is the elementary step with the highest free energy, $\\Delta G$. The ambiguity arises when the free energies of the two competing steps, $A$ and $B$, are within a specified tolerance $\\sigma$ of each other.\n\nThe free energies for steps $A$ and $B$ are given by the linear model $\\Delta G_{i}(U) = a_{i} + \\alpha_{i}U$. First, we compute the coefficients $\\alpha_{A}$ and $\\alpha_{B}$. The model defines $\\alpha_{i} = \\gamma_{i} - n_{i}e$. As established in the validation, in the system of units where energy is in $\\text{eV}$ and potential $U$ is in $\\text{V}$, the term $n_{i}eU$ corresponds to an energy of $n_{i}U$ in $\\text{eV}$. Thus, the coefficient of $U$ is numerically $-n_i$. The model can be written as $\\Delta G_i(U) = a_i + (\\gamma_i - n_i)U$. The factor $e$ is implicitly absorbed by the units, making its numerical value $1$.\n\nFor step $A$:\n$n_{A} = 1$\n$\\gamma_{A} = 0.15\\,\\text{eV}/\\text{V}$\n$\\alpha_{A} = \\gamma_{A} - n_{A} = 0.15 - 1 = -0.85\\,\\text{eV}/\\text{V}$\nThe free energy is $\\Delta G_{A}(U) = 0.50 - 0.85\\,U$.\n\nFor step $B$:\n$n_{B} = 1$\n$\\gamma_{B} = -0.05\\,\\text{eV}/\\text{V}$\n$\\alpha_{B} = \\gamma_{B} - n_{B} = -0.05 - 1 = -1.05\\,\\text{eV}/\\text{V}$\nThe free energy is $\\Delta G_{B}(U) = 0.53 - 1.05\\,U$.\n\nThe PDS ambiguity window is defined by the inequality $|\\Delta G_{A}(U) - \\Delta G_{B}(U)| \\le \\sigma$. We substitute the expressions for $\\Delta G_{A}(U)$ and $\\Delta G_{B}(U)$:\n$$\n|(a_{A} + \\alpha_{A}U) - (a_{B} + \\alpha_{B}U)| \\le \\sigma\n$$\nRearranging the terms inside the absolute value gives:\n$$\n|(a_{A} - a_{B}) + (\\alpha_{A} - \\alpha_{B})U| \\le \\sigma\n$$\nThis inequality is of the form $|X| \\le c$, which is equivalent to $-c \\le X \\le c$. Applying this, we obtain the inequality that bounds the potential $U$:\n$$\n-\\sigma \\le (a_{A} - a_{B}) + (\\alpha_{A} - \\alpha_{B})U \\le \\sigma\n$$\nTo solve for $U$, we first subtract $(a_{A} - a_{B})$ from all parts of the inequality:\n$$\n-\\sigma - (a_{A} - a_{B}) \\le (\\alpha_{A} - \\alpha_{B})U \\le \\sigma - (a_{A} - a_{B})\n$$\nThis can be rewritten as:\n$$\n(a_{B} - a_{A}) - \\sigma \\le (\\alpha_{A} - \\alpha_{B})U \\le (a_{B} - a_{A}) + \\sigma\n$$\nNext, we calculate the coefficient of $U$:\n$$\n\\alpha_{A} - \\alpha_{B} = (-0.85) - (-1.05) = -0.85 + 1.05 = 0.20\\,\\text{eV}/\\text{V}\n$$\nSince $\\alpha_{A} - \\alpha_{B} > 0$, dividing by this term does not change the direction of the inequalities:\n$$\n\\frac{(a_{B} - a_{A}) - \\sigma}{\\alpha_{A} - \\alpha_{B}} \\le U \\le \\frac{(a_{B} - a_{A}) + \\sigma}{\\alpha_{A} - \\alpha_{B}}\n$$\nThis is the derived inequality that bounds the potential $U$ defining the ambiguity window. Let's define the lower bound as $U_{\\text{lower}}$ and the upper bound as $U_{\\text{upper}}$.\n\nThe width of this potential window, $\\Delta U$, is the difference between the upper and lower bounds:\n$$\n\\Delta U = U_{\\text{upper}} - U_{\\text{lower}} = \\frac{(a_{B} - a_{A}) + \\sigma}{\\alpha_{A} - \\alpha_{B}} - \\frac{(a_{B} - a_{A}) - \\sigma}{\\alpha_{A} - \\alpha_{B}}\n$$\n$$\n\\Delta U = \\frac{((a_{B} - a_{A}) + \\sigma) - ((a_{B} - a_{A}) - \\sigma)}{\\alpha_{A} - \\alpha_{B}}\n$$\n$$\n\\Delta U = \\frac{2\\sigma}{\\alpha_{A} - \\alpha_{B}}\n$$\nNow, substitute the numerical values into this expression:\n$\\sigma = 0.03\\,\\text{eV}$\n$\\alpha_{A} - \\alpha_{B} = 0.20\\,\\text{eV}/\\text{V}$\n$$\n\\Delta U = \\frac{2 \\times 0.03\\,\\text{eV}}{0.20\\,\\text{eV}/\\text{V}} = \\frac{0.06}{0.20}\\,\\text{V} = 0.3\\,\\text{V}\n$$\nThe problem requires the answer to be rounded to three significant figures. Thus, the width is $0.300\\,\\text{V}$.\n\nThe problem also asks for proposals of targeted experiments to distinguish the PDS. The key is that the PDS governs the overall reaction kinetics. A change in the PDS should manifest as a change in an experimentally observable kinetic parameter.\nWithin the ambiguity window, the PDS is predicted to switch. The crossover potential $U_{\\text{cross}}$ where $\\Delta G_{A}(U) = \\Delta G_{B}(U)$ is:\n$a_{A} + \\alpha_{A}U_{\\text{cross}} = a_{B} + \\alpha_{B}U_{\\text{cross}}$\n$U_{\\text{cross}} = \\frac{a_{B} - a_{A}}{\\alpha_{A} - \\alpha_{B}} = \\frac{0.53 - 0.50}{0.20} = \\frac{0.03}{0.20} = 0.15\\,\\text{V}$.\nFor $U < 0.15\\,\\text{V}$, step $B$ has a higher free energy and is the PDS. For $U > 0.15\\,\\text{V}$, step $A$ becomes the PDS. Two experiments could probe this change:\n\n1.  **Tafel Analysis**: The current density $j$ is determined by the kinetics of the PDS. According to transition state theory, the rate is exponentially dependent on the activation barrier, which is related to $\\Delta G$ of the PDS. The Tafel slope $b = dU/d(\\log|j|)$ is a key kinetic parameter that reflects the potential dependence of the rate. Since steps $A$ and $B$ have different potential dependencies ($\\alpha_A \\neq \\alpha_B$), the effective transfer coefficient of the overall reaction will change when the PDS switches from $B$ to $A$. This would be observed as a distinct change or \"kink\" in the slope of the Tafel plot ($U$ vs. $\\log|j|$) around the crossover potential $U_{\\text{cross}}=0.15\\,\\text{V}$. Measuring the current density as a function of potential across the ambiguity window and plotting the corresponding Tafel plot would provide direct evidence for a change in the rate-limiting mechanism.\n\n2.  **Kinetic Isotope Effect (KIE) Measurement**: Both steps are PCETs, involving the transfer of a proton. The rate of such a step is sensitive to the mass of the hydrogen isotope. By comparing the reaction current in a standard electrolyte (e.g., pH-controlled $H_2O$) with that in a deuterated electrolyte (pD-controlled $D_2O$), one can measure the KIE, defined as $j_H/j_D$. The magnitude of the KIE depends on the nature of the proton transfer in the transition state of the PDS. It is plausible that steps $A$ and $B$, having different atomic-level details, would exhibit different intrinsic KIE values. If the PDS switches from $B$ to $A$ as potential increases, the measured KIE as a function of potential should also change across the ambiguity window. Observing a potential-dependent KIE would therefore signal a change in the PDS.",
            "answer": "$$\n\\boxed{0.300}\n$$"
        }
    ]
}