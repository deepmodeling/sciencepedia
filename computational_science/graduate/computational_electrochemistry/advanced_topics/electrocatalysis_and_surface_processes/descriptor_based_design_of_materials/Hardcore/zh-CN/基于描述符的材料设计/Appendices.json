{
    "hands_on_practices": [
        {
            "introduction": "为了设计出更优的催化剂，我们必须首先理解其表面的基本电子性质。功函数是描述材料表面电子行为的一个关键描述符。本练习将引导您从第一性原理出发，推导外加电极电势与功函数之间的关系。通过解决这个问题 ()，您将更深刻地理解计算电化学的理论基础，以及在真实操作条件下如何对表面性质进行建模。",
            "id": "4241629",
            "problem": "要求您在计算电化学领域中，推导、实现并评估一个基于描述符的关系，该关系描述了不同表面终端上随电势变化的功函数与电子化学势对齐之间的关系。请从第一性原理和经过充分检验的事实出发，不要假设或引用任何最终目标公式。请仅使用以下基本依据和定义：电子化学势定义为 $ \\mu_e = \\partial G / \\partial n_e $，其中 $ G $ 为吉布斯自由能，$ n_e $ 为电子数；施加的电极电势 $ U $ 对每个电子做静电功 $ -e U $；一个表面的功函数 $ \\phi $ 是将一个电子从费米能级移至真空能级所需的能量，即真空能级与费米能级之间的能量差；零电荷电势 (PZC) 是净表面电荷密度为零时的电势；在亥姆霍兹近似中，界面电势降随表面电荷线性变化，其比例常数为微分亥姆霍兹电容 $ C_{\\mathrm{H}} $；标准氢电极 (SHE) 的绝对电势是一个普遍接受的常数 $ U_{\\mathrm{SHE}}^{\\mathrm{abs}} $。\n\n任务要求：\n1. 基于所述依据，推导出一个金属电极表面终端在给定电极电势 $ U $（相对于标准氢电极，单位为伏特）下随电势变化的功函数 $ \\phi(U) $ 的表达式（单位为电子伏特）。确保该表达式与零电荷电势 $ U_{\\mathrm{PZC}} $ 和中性表面功函数 $ \\phi_{\\mathrm{PZC}} $（单位为电子伏特）的定义相符。\n2. 推导一个用于描述不同表面终端上电子化学势对齐的描述符，其定义为差值 $ \\Delta \\mu^{\\mathrm{align}}(U) = \\mu_e^{\\mathrm{electrode}}(U) - \\mu_e^{\\mathrm{solution}}(U) $（单位为电子伏特），其中 $ \\mu_e^{\\mathrm{electrode}}(U) $ 是电势为 $ U $ 时电极内部的电子化学势，$ \\mu_e^{\\mathrm{solution}}(U) $ 是相同电势 $ U $ 下理想溶液氧化还原能级的电子化学势。使用绝对 SHE 电势 $ U_{\\mathrm{SHE}}^{\\mathrm{abs}} $（单位为电子伏特）和施加的电势 $ U $（单位为伏特）来表示溶液侧的电子化学势，并确定在所述近似条件下，所得描述符是否依赖于 $ U $。\n\n在推导出表达式后，请将它们在一个完整的、可运行的程序中实现，该程序为每个测试用例计算：\n- 在三个电极电势 $ U \\in \\{-0.5, 0.0, +0.5\\} $ 伏特（相对于标准氢电极）下的功函数 $ \\phi(U) $（单位为电子伏特）。\n- 该表面终端的对齐描述符 $ \\Delta \\mu^{\\mathrm{align}} $（单位为电子伏特）。\n\n物理单位与报告：\n- 所有计算出的能量以电子伏特表示，所有电极电势以伏特表示。报告最终数值时，以电子伏特为单位，四舍五入至四位小数。\n- 不涉及角度；请勿引入角度。\n- 不要使用百分比；如果需要小数，请使用十进制数。\n\n测试套件：\n使用 $ U_{\\mathrm{SHE}}^{\\mathrm{abs}} = 4.44 $ 电子伏特。对于每个表面终端，给定 $ \\phi_{\\mathrm{PZC}} $（单位为电子伏特）和 $ U_{\\mathrm{PZC}} $（单位为伏特）。测试套件包含四个不同的终端：\n- 案例 $ 1 $：$ \\phi_{\\mathrm{PZC}} = 5.20 $，$ U_{\\mathrm{PZC}} = 0.15 $。\n- 案例 $ 2 $：$ \\phi_{\\mathrm{PZC}} = 4.00 $，$ U_{\\mathrm{PZC}} = -0.20 $。\n- 案例 $ 3 $：$ \\phi_{\\mathrm{PZC}} = 5.80 $，$ U_{\\mathrm{PZC}} = 0.60 $。\n- 案例 $ 4 $（边界一致性检查）：$ \\phi_{\\mathrm{PZC}} = 4.44 $，$ U_{\\mathrm{PZC}} = 0.00 $。\n\n程序输出规范：\n- 对于每个案例，生成一个包含四个浮点数的列表，单位为电子伏特：$ [\\phi(-0.5), \\phi(0.0), \\phi(0.5), \\Delta \\mu^{\\mathrm{align}}] $，每个数值四舍五入到四位小数。\n- 将所有四个案例的结果汇总成一个单行的列表之列表。\n- 您的程序应生成单行输出，包含以方括号括起来的逗号分隔列表形式的结果，例如：$ [[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4],[d_1,d_2,d_3,d_4]] $，其中每个 $ a_i $、$ b_i $、$ c_i $ 和 $ d_i $ 都是以电子伏特为单位的浮点数。\n\n科学真实性约束：\n- 假设为金属电极，具有快速的电子屏蔽效应，使得金属内的费米能级根据所述基础对外加电势 $ U $ 做出响应。\n- 假设亥姆霍兹近似成立，即 $ C_{\\mathrm{H}} $ 为常数，并忽略扩散层贡献；确保推导与作为表面特定输入的 $ U_{\\mathrm{PZC}} $ 和 $ \\phi_{\\mathrm{PZC}} $ 保持自洽。",
            "solution": "经评估，此问题有效。它在科学上基于电化学和表面科学的原理，问题陈述清晰，目标明确，数据充分，并且表述客观。\n\n### 问题验证\n\n#### 步骤 1：提取给定条件\n- **定义**：\n    - 电子化学势：$ \\mu_e = \\partial G / \\partial n_e $，其中 $ G $ 为吉布斯自由能，$ n_e $ 为电子数。\n    - 施加电势所做的静电功：施加的电极电势 $ U $ 对每个电子做功 $ -e U $。\n    - 功函数 $ \\phi $：将一个电子从费米能级移至真空能级所需的能量。\n    - 零电荷电势 ($ U_{\\mathrm{PZC}} $): 净表面电荷密度为零时的电势。\n    - 亥姆霍兹近似：界面电势降随表面电荷线性变化，其比例常数为微分亥姆霍兹电容 $ C_{\\mathrm{H}} $。\n    - 对齐描述符：$ \\Delta \\mu^{\\mathrm{align}}(U) = \\mu_e^{\\mathrm{electrode}}(U) - \\mu_e^{\\mathrm{solution}}(U) $。\n- **常数**：\n    - 标准氢电极 (SHE) 的绝对电势：$ U_{\\mathrm{SHE}}^{\\mathrm{abs}} = 4.44 $ 电子伏特。\n- **变量和数据**：\n    - 电极电势 $ U $，单位为伏特（相对于 SHE）。\n    - 中性表面功函数 $ \\phi_{\\mathrm{PZC}} $，单位为电子伏特。\n    - 零电荷电势 $ U_{\\mathrm{PZC}} $，单位为伏特。\n- **测试用例**：\n    - 案例 $ 1 $：$ \\phi_{\\mathrm{PZC}} = 5.20 $ eV, $ U_{\\mathrm{PZC}} = 0.15 $ V。\n    - 案例 $ 2 $：$ \\phi_{\\mathrm{PZC}} = 4.00 $ eV, $ U_{\\mathrm{PZC}} = -0.20 $ V。\n    - 案例 $ 3 $：$ \\phi_{\\mathrm{PZC}} = 5.80 $ eV, $ U_{\\mathrm{PZC}} = 0.60 $ V。\n    - 案例 $ 4 $：$ \\phi_{\\mathrm{PZC}} = 4.44 $ eV, $ U_{\\mathrm{PZC}} = 0.00 $ V。\n\n#### 步骤 2：使用提取的给定条件进行验证\n该问题具有科学依据，提问方式合理且客观。它依赖于计算电化学中的标准定义和模型（例如，计算氢电极模型框架）。给定的常数和测试数据在物理上是合理的。任务要求从这些基本原理推导关系，这是一个有效的科学推理问题。\n\n#### 步骤 3：结论与行动\n该问题有效。将推导并实现一个完整的解决方案。\n\n### 表达式推导\n\n#### 1. 随电势变化的功函数 $ \\phi(U) $\n电子化学势 $ \\mu_e $ 在金属中等同于费米能级 $ E_F $。问题陈述，施加的电势 $ U $ 对每个电子做静电功 $ -eU $。这意味着电极电势从一个参考值变为 $ U $ 会使费米能级发生相应的移动。\n\n我们选择零电荷电势 $ U_{\\mathrm{PZC}} $ 作为我们的参考态。在此电势下，电极表面呈电中性，其功函数为给定的 $ \\phi_{\\mathrm{PZC}} $。\n\n当电极电势从 $ U_{\\mathrm{PZC}} $ 变为任意电势 $ U $ 时，电势的变化量为 $ \\Delta U = U - U_{\\mathrm{PZC}} $。电势的这种变化会移动金属内部电子的能量。电势为 $ U $ 时的费米能级（表示为 $ E_F(U) $）与 PZC 时的费米能级 $ E_F(U_{\\mathrm{PZC}}) $ 之间的关系如下：\n$$ E_F(U) = E_F(U_{\\mathrm{PZC}}) - e(U - U_{\\mathrm{PZC}}) $$\n其中 $ e $ 是元电荷。\n\n功函数 $ \\phi(U) $ 定义为真空能级 $ E_{\\mathrm{vac}} $ 与费米能级 $ E_F(U) $ 之间的能量差。以能量单位表示，即为 $ e\\phi(U) = E_{\\mathrm{vac}}(U) - E_F(U) $。在此模型中，我们假设表面外的局部真空能级不受电势变化的影响，即 $ E_{\\mathrm{vac}}(U) \\approx E_{\\mathrm{vac}}(U_{\\mathrm{PZC}}) $。这一简化与使用所提供的第一性原理以及忽略对表面偶极子的显式电容充电效应是一致的。\n\n在此假设下，功函数的变化完全由费米能级的移动引起：\n$$ e\\phi(U) - e\\phi(U_{\\mathrm{PZC}}) = (E_{\\mathrm{vac}} - E_F(U)) - (E_{\\mathrm{vac}} - E_F(U_{\\mathrm{PZC}})) $$\n$$ e\\phi(U) - e\\phi(U_{\\mathrm{PZC}}) = E_F(U_{\\mathrm{PZC}}) - E_F(U) $$\n代入费米能级移动的表达式：\n$$ e\\phi(U) - e\\phi(U_{\\mathrm{PZC}}) = E_F(U_{\\mathrm{PZC}}) - (E_F(U_{\\mathrm{PZC}}) - e(U - U_{\\mathrm{PZC}})) = e(U - U_{\\mathrm{PZC}}) $$\n两边同除以元电荷 $ e $，我们得到电势单位为伏特（$V$）、功函数单位为电子伏特（$eV$）的关系式：\n$$ \\phi(U) = \\phi_{\\mathrm{PZC}} + U - U_{\\mathrm{PZC}} $$\n该表达式给出了随电势变化的功函数。当 $ U = U_{\\mathrm{PZC}} $ 时，它正确地返回 $ \\phi_{\\mathrm{PZC}} $。\n\n#### 2. 电子化学势对齐描述符 $ \\Delta \\mu^{\\mathrm{align}}(U) $\n该描述符定义为在相同电势 $ U $ 下，电极中的电子化学势与溶液中的电子化学势之差：\n$$ \\Delta \\mu^{\\mathrm{align}}(U) = \\mu_e^{\\mathrm{electrode}}(U) - \\mu_e^{\\mathrm{solution}}(U) $$\n所有能量都以电子伏特（$eV$）表示。\n\n首先，我们表示 $ \\mu_e^{\\mathrm{electrode}}(U) $。一个表面的电子化学势（或费米能级），在相对于真空能级的绝对能量标度上，是其功函数的负值。\n$$ \\mu_e^{\\mathrm{electrode}}(U) = -\\phi(U) $$\n使用第 1 部分的结果：\n$$ \\mu_e^{\\mathrm{electrode}}(U) = -(\\phi_{\\mathrm{PZC}} + U - U_{\\mathrm{PZC}}) $$\n\n接下来，我们表示 $ \\mu_e^{\\mathrm{solution}}(U) $。这是电解质中一个理想电子库的化学势，其相对于 SHE 的平衡电势为 $ U $。根据定义，SHE 的电势为 $ U=0 $ V。其绝对电子化学势为 $ \\mu_e(\\text{SHE}) = -U_{\\mathrm{SHE}}^{\\mathrm{abs}} $（单位为 $eV$）。对于相对于 SHE 的任何其他电势 $ U $，电子化学势会移动 $ -U $（单位为 $eV$）：\n$$ \\mu_e^{\\mathrm{solution}}(U) = \\mu_e(\\text{SHE}) - U = -U_{\\mathrm{SHE}}^{\\mathrm{abs}} - U $$\n\n现在我们可以计算对齐描述符 $ \\Delta \\mu^{\\mathrm{align}}(U) $：\n$$ \\Delta \\mu^{\\mathrm{align}}(U) = \\mu_e^{\\mathrm{electrode}}(U) - \\mu_e^{\\mathrm{solution}}(U) $$\n$$ \\Delta \\mu^{\\mathrm{align}}(U) = -(\\phi_{\\mathrm{PZC}} + U - U_{\\mathrm{PZC}}) - (-U_{\\mathrm{SHE}}^{\\mathrm{abs}} - U) $$\n$$ \\Delta \\mu^{\\mathrm{align}}(U) = -\\phi_{\\mathrm{PZC}} - U + U_{\\mathrm{PZC}} + U_{\\mathrm{SHE}}^{\\mathrm{abs}} + U $$\n包含外加电势 $ U $ 的项相互抵消：\n$$ \\Delta \\mu^{\\mathrm{align}} = U_{\\mathrm{PZC}} - \\phi_{\\mathrm{PZC}} + U_{\\mathrm{SHE}}^{\\mathrm{abs}} $$\n如推导所示，在所述近似下，对齐描述符 $ \\Delta \\mu^{\\mathrm{align}} $ 与外加电势 $ U $ 无关。对于每个表面终端，它是一个常数，由其固有属性（$ \\phi_{\\mathrm{PZC}} $，$ U_{\\mathrm{PZC}} $）和 SHE 的绝对电势决定。\n\n### 公式总结\n1.  电势为 $ U $ 时的功函数：\n    $ \\phi(U) \\,[\\text{eV}] = \\phi_{\\mathrm{PZC}} \\,[\\text{eV}] + U \\,[\\text{V}] - U_{\\mathrm{PZC}} \\,[\\text{V}] $\n2.  对齐描述符：\n    $ \\Delta \\mu^{\\mathrm{align}} \\,[\\text{eV}] = U_{\\mathrm{PZC}} \\,[\\text{V}] - \\phi_{\\mathrm{PZC}} \\,[\\text{eV}] + U_{\\mathrm{SHE}}^{\\mathrm{abs}} \\,[\\text{eV}] $",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes potential-dependent work functions and an alignment descriptor\n    for different electrode surface terminations based on electrochemical principles.\n    \"\"\"\n\n    # --- Givens from the problem statement ---\n    U_SHE_abs = 4.44  # in electronvolts\n    U_values = [-0.5, 0.0, 0.5]  # in volts vs. SHE\n\n    # Test suite: (phi_PZC in eV, U_PZC in V)\n    test_cases = [\n        (5.20, 0.15),  # Case 1\n        (4.00, -0.20), # Case 2\n        (5.80, 0.60),  # Case 3\n        (4.44, 0.00),  # Case 4 (boundary consistency check)\n    ]\n\n    # --- Calculations ---\n    all_results = []\n    for phi_pzc, u_pzc in test_cases:\n        # 1. Calculate the potential-dependent work function phi(U)\n        # Formula: phi(U) = phi_PZC + U - U_PZC\n        # Units: eV = eV + V - V, which is dimensionally consistent.\n        phi_at_U = [phi_pzc + u - u_pzc for u in U_values]\n\n        # 2. Calculate the alignment descriptor delta_mu_align\n        # Formula: delta_mu_align = U_PZC - phi_PZC + U_SHE_abs\n        # Units: eV = V - eV + eV, which is dimensionally consistent.\n        delta_mu_align = u_pzc - phi_pzc + U_SHE_abs\n\n        # 3. Assemble results for the current case\n        # Result format: [phi(-0.5), phi(0.0), phi(0.5), delta_mu_align]\n        case_results = phi_at_U + [delta_mu_align]\n        all_results.append(case_results)\n\n    # --- Format output ---\n    # The output must be a single string representing a list of lists of floats,\n    # with each float rounded to four decimal places.\n    # Ex: [[a1,a2,a3,a4],[b1,b2,b3,b4],...]\n    \n    formatted_lists = []\n    for res_list in all_results:\n        # Format each number to 4 decimal places\n        formatted_numbers = [f\"{x:.4f}\" for x in res_list]\n        # Join numbers into a string like \"[num1,num2,num3,num4]\"\n        formatted_lists.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    # Join the list strings into the final output format \"[[...],[...]]\"\n    final_output_string = f\"[{','.join(formatted_lists)}]\"\n\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "理解了单个描述符之后，下一步是探究它们彼此之间的关联。许多物种的吸附能并非相互独立，而是通过所谓的“标度关系”联系在一起。然而，并非所有标度关系都具有同等的预测能力。这项动手实践 () 要求您建立一个量化指标来评估这些标度关系的“紧密”程度，它将线性回归和相关性分析的概念结合起来，构建一个强大的评估工具。",
            "id": "4241585",
            "problem": "您的任务是形式化计算电化学中氧还原反应中间体吸附能之间标度关系的概念，并构建一个定量的、无量纲的标量来衡量这种关系的紧密程度。请在基于描述符的设计范式内工作，其中吸附能作为描述符来预测催化行为。从统计学和线性回归中基本且被广泛接受的定义出发，基于相关性和残差分析，制定一个数学上严谨的紧密度度量。然后将该度量实现为一个程序，并将其应用于所提供的数据集。\n\n构建一个用于两种吸附能之间二元标度关系的标量紧密度分数，其中一种被视为描述符，另一种被视为目标。该分数必须从以下基本依据推导得出：\n\n- Pearson 积矩相关的定义，对于具有实现值 $x_i$ 和 $y_i$ 以及有限非零标准差 $\\sigma_x$ 和 $\\sigma_y$ 的两个随机变量，其定义为中心化变量之间的相关性除以其标准差的乘积。\n- Spearman 等级相关的定义，即等级转换后变量的 Pearson 相关性。\n- 将 $y$ 对 $x$ 进行带截距的普通最小二乘线性回归，得到一条直线 $y = a x + b$，该直线最小化残差平方和 $\\sum_i \\varepsilon_i^2$，其中 $\\varepsilon_i = y_i - (a x_i + b)$。\n- 根据残差计算的均方根误差，并使用 $y$ 的标准差进行适当的归一化，以使残差贡献变为无单位且在 $y$ 的重新缩放下是仿射不变的。\n\n您的分数必须满足以下所有属性，您必须在推导中从第一性原理出发证明这些属性：\n\n- 它聚合了三个贡献：一个随 Pearson 相关性的大小单调增加，一个随 Spearman 相关性的大小单调增加，以及一个随着残差离散度的减小而增加（使用 $y$ 的离散度进行归一化，使其对 $y$ 的仿射重缩放不变）。\n- 它界于闭区间 $[0,1]$ 内。\n- 对于残差为零的完美线性、严格单调关系，它达到值 $1$。\n- 当引入一个增加残差离散度但保留整体单调趋势的单个离群值时，它不会增加。\n- 它在交换 $x$ 和 $y$ 时仅在两个相关性贡献中是对称的，但在残差贡献中则不一定，因为回归是 $y$ 对 $x$ 的回归。\n\n您必须构建一个满足这些属性的具体分数，并以算法方式实现它。对相关性单调性和残差紧凑性给予同等重视，采用非负的凸聚合方式来汇集这三个贡献。如果需要保持 $[0,1]$ 的界限，请对基于残差的项应用校正以避免负贡献。\n\n数据是氧中间体在不同催化剂表面上采样的吸附能，单位为电子伏特 (eV)。每个数据集包含多个催化剂的三元组 $(E_{\\mathrm{OH}}, E_{\\mathrm{O}}, E_{\\mathrm{OOH}})$。对于每个数据集，评估三个标度关系，将第一个参数视为 $x$，第二个参数视为 $y$：\n\n- $E_{\\mathrm{OOH}}$ 对 $E_{\\mathrm{OH}}$，\n- $E_{\\mathrm{O}}$ 对 $E_{\\mathrm{OH}}$，\n- $E_{\\mathrm{OOH}}$ 对 $E_{\\mathrm{O}}$。\n\n所有吸附能的单位均为 $\\mathrm{eV}$。您的标量紧密度分数是无量纲的，必须报告为四舍五入到 $6$ 位小数的实数。\n\n使用以下三个数据集（每个列表对应于相同顺序的不同催化剂表面）：\n\n- 数据集 $A$（近乎完美的线性标度）：\n  - $E_{\\mathrm{OH}}$ (eV): $[0.8, 1.0, 1.2, 1.4, 1.6]$，\n  - $E_{\\mathrm{OOH}}$ (eV): $E_{\\mathrm{OH}} + 3.2$，\n  - $E_{\\mathrm{O}}$ (eV): $2 \\, E_{\\mathrm{OH}} + 0.5$。\n- 数据集 $B$（单调但轻度非线性的标度）：\n  - $E_{\\mathrm{OH}}$ (eV): $[0.7, 0.9, 1.1, 1.3, 1.5]$，\n  - $E_{\\mathrm{OOH}}$ (eV): $3.1 + E_{\\mathrm{OH}} + 0.1 \\, E_{\\mathrm{OH}}^2$，\n  - $E_{\\mathrm{O}}$ (eV): $0.5 + 2 \\, E_{\\mathrm{OH}} + 0.2 \\, E_{\\mathrm{OH}}^2$。\n- 数据集 $C$（带有一个离群值的线性关系）：\n  - $E_{\\mathrm{OH}}$ (eV): $[0.8, 1.0, 1.2, 1.4, 1.6]$，\n  - $E_{\\mathrm{OOH}}$ (eV): $E_{\\mathrm{OH}} + 3.2$，但第三个条目增加了 $0.6 \\, \\mathrm{eV}$，\n  - $E_{\\mathrm{O}}$ (eV): $2 \\, E_{\\mathrm{OH}} + 0.5$，但第二个条目减少了 $0.8 \\, \\mathrm{eV}$。\n\n测试套件和要求的输出：\n\n- 对于三个数据集 $A$、$B$ 和 $C$ 中的每一个，计算三个有序关系的紧密度分数：$E_{\\mathrm{OOH}}$ 对 $E_{\\mathrm{OH}}$，$E_{\\mathrm{O}}$ 对 $E_{\\mathrm{OH}}$，以及 $E_{\\mathrm{OOH}}$ 对 $E_{\\mathrm{O}}$。\n- 这总共产生 $9$ 个分数。您的程序应生成单行输出，其中包含这 $9$ 个结果，形式为方括号括起来的逗号分隔列表，顺序固定如下：$\\left[ S_{A, \\mathrm{OOH|OH}}, S_{A, \\mathrm{O|OH}}, S_{A, \\mathrm{OOH|O}}, S_{B, \\mathrm{OOH|OH}}, S_{B, \\mathrm{O|OH}}, S_{B, \\mathrm{OOH|O}}, S_{C, \\mathrm{OOH|OH}}, S_{C, \\mathrm{O|OH}}, S_{C, \\mathrm{OOH|O}} \\right]$，每个条目精确四舍五入到 $6$ 位小数。该分数是无量纲的。\n\n此问题不涉及角度单位。不要使用百分号表示任何结果；所有值必须是实数。\n\n您的最终程序必须是自包含的，并能产生此处描述的确切输出格式，无需用户输入或外部资源。",
            "solution": "所述问题是有效的。它在计算材料科学和基于描述符的设计这一已建立的科学框架内，特别是在电催化背景下，提出了一个定义明确的任务。该问题具有科学依据，依赖于线性代数和统计学（Pearson 和 Spearman 相关性、普通最小二乘回归）的基本、普遍接受的原理。它是客观、完整且不包含任何矛盾或歧义的。它要求基于一组明确的公理化属性构建一个数学对象（一个标量分数），并将其应用于定义明确的合成数据集。这构成了定量科学建模中的一个标准且有意义的练习。因此，我们可以进行推导和求解。\n\n任务是形式化一个定量的、无量纲的标量（我们将其表示为 $S$），用以衡量两组吸附能之间二元标度关系的“紧密度”，这两组吸附能分别被视为描述符变量 $x$ 和目标变量 $y$。分数 $S$ 必须从第一性原理构建，并满足一系列指定属性。\n\n设两组观测值由向量 $\\mathbf{x} = \\{x_1, x_2, \\ldots, x_n\\}$ 和 $\\mathbf{y} = \\{y_1, y_2, \\ldots, y_n\\}$ 给出。紧密度分数 $S$ 被构造成三个不同的、归一化的贡献项的凸组合，每个贡献项都在区间 $[0, 1]$ 内：一个 Pearson 相关项 $C_P$，一个 Spearman 等级相关项 $C_S$，以及一个归一化的残差误差项 $C_R$。问题规定对每个贡献项给予同等重视，从而得到分数 $S$ 的以下形式：\n$$S = \\frac{1}{3} (C_P + C_S + C_R)$$\n我们现在将根据所给要求推导每个分量。\n\n**1. Pearson 相关性贡献，$C_P$**\n\nPearson 积矩相关系数 $\\rho_{xy}$ 衡量两个变量之间线性关联的程度。对于样本 $\\mathbf{x}$ 和 $\\mathbf{y}$，其均值分别为 $\\bar{x}$ 和 $\\bar{y}$，标准差分别为 $\\sigma_x$ 和 $\\sigma_y$，其定义为：\n$$\\rho_{xy} = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\sum_{i=1}^{n} (y_i - \\bar{y})^2}}$$\n$\\rho_{xy}$ 的值在区间 $[-1, 1]$ 内。问题要求一个随相关性大小单调增加的贡献。最直接且界于 $[0, 1]$ 的选择是 Pearson 系数的绝对值。\n$$C_P = |\\rho_{xy}|$$\n对于完美的线性关系（正向或负向），此分量为 $1$；对于无线性相关，此分量为 $0$。它在交换 $x$ 和 $y$ 时是对称的。\n\n**2. Spearman 等级相关性贡献，$C_S$**\n\nSpearman 等级相关系数 $\\rho_S$ 衡量两个变量之间单调关系的强度和方向。它被定义为等级转换后变量的 Pearson 相关系数。设 $R_x(i)$ 和 $R_y(i)$ 分别是 $x_i$ 和 $y_i$ 在其各自数据集中的等级。则：\n$$\\rho_S = \\rho_{R_x R_y} = \\frac{\\text{cov}(R_x, R_y)}{\\sigma_{R_x} \\sigma_{R_y}}$$\n与 Pearson 系数一样，$\\rho_S$ 也在 $[-1, 1]$ 内。它对离群值的敏感性低于 $\\rho_{xy}$，并能捕捉非线性的单调趋势。为了满足分数贡献随单调相关性的大小而增加的要求，我们再次使用绝对值：\n$$C_S = |\\rho_S|$$\n对于任何完美的单调关系（线性或非线性），此分量为 $1$；对于无单调趋势，此分量为 $0$。它在交换 $x$ 和 $y$ 时也是对称的。\n\n**3. 归一化残差误差贡献，$C_R$**\n\n该分量量化了数据点围绕最佳拟合线的紧凑程度，且独立于任何固有的单调趋势。它基于将 $y$ 对 $x$ 进行普通最小二乘法（OLS）线性回归的残差。OLS 过程找到直线 $y_{pred} = ax + b$ 的参数 $a$（斜率）和 $b$（截距），使得残差平方和 $\\sum_{i=1}^{n} \\varepsilon_i^2$ 最小化，其中每个点的残差为 $\\varepsilon_i = y_i - y_{pred,i} = y_i - (ax_i + b)$。\n\n这些残差的离散度由均方根误差（RMSE）衡量：\n$$\\text{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} \\varepsilon_i^2}$$\n为了使这个度量无量纲并且对 $y$ 的仿射变换（即 $y' = cy+d$ for $c \\neq 0$）保持不变，问题要求通过 $y$ 的离散度度量进行归一化。$y$ 的标准差 $\\sigma_y = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\bar{y})^2}$ 是合适的选择。对 $y$ 的仿射变换将 $\\text{RMSE}$ 变为 $|c|\\text{RMSE}$，将 $\\sigma_y$ 变为 $|c|\\sigma_y$，使其比率，即归一化均方根误差（NRMSE），保持不变。\n$$\\text{NRMSE} = \\frac{\\text{RMSE}}{\\sigma_y}$$\n贡献 $C_R$ 必须随着残差离散度的减小而增加。一个简单的形式是 $1 - \\text{NRMSE}$。对于一个包含截距项的 OLS 回归模型，残差平方和总是小于或等于总平方和，即 $\\sum \\varepsilon_i^2 \\le \\sum (y_i - \\bar{y})^2$。两边除以 $n$ 并开方，得到 $\\text{RMSE} \\le \\sigma_y$。这确保了 $\\text{NRMSE} \\in [0, 1]$（假设 $\\sigma_y > 0$），因此，贡献项也界于 $[0, 1]$ 内。我们将其定义为：\n$$C_R = 1 - \\frac{\\text{RMSE}}{\\sigma_y}$$\n为确保稳健性，如果任何数值不稳定性或边缘情况导致 $\\text{RMSE} > \\sigma_y$，我们可以应用指定的校正：$C_R = \\max(0, 1 - \\text{NRMSE})$。当所有残差均为零（完美拟合，$\\text{RMSE}=0$）时，此分量达到其最大值 $1$。与 $C_P$ 和 $C_S$ 不同，$C_R$ 对于 $x$ 和 $y$ 的交换是不对称的，因为 $y$ 对 $x$ 的回归与 $x$ 对 $y$ 的回归是不同的。\n\n**4. 最终聚合分数，$S$**\n\n将三个分量以同等权重组合，得到紧密度分数的最终表达式：\n$$S(\\mathbf{x}, \\mathbf{y}) = \\frac{1}{3} \\left( |\\rho_{xy}| + |\\rho_S| + \\left(1 - \\frac{\\text{RMSE}_y}{\\sigma_y}\\right) \\right)$$\n此分数满足所有要求的属性：\n- 它通过凸组合以同等重视度聚合了三个指定的贡献。\n- 它界于 $[0, 1]$ 内，因为它是三个均在 $[0, 1]$ 内的项的平均值。\n- 它仅在 $|\\rho_{xy}|=1$、 $|\\rho_S|=1$ 和 $\\text{RMSE}=0$ 时等于 $1$，这对应于一个完美的、严格单调的、误差为零的线性关系。\n- 引入离群值通常会增加 $\\text{RMSE}$ 并减小 $|\\rho_{xy}|$，从而降低 $C_R$ 和 $C_P$，导致分数 $S$ 降低。包含稳健的 Spearman 项 $C_S$ 可防止在离群值不破坏整体等级排序的情况下分数崩溃。\n- 该分数是不对称的，因为 $C_R$ 项依赖于选择 $y$ 作为因变量。\n\n以下算法将用于计算每个数据集和关系的分数。\n1.  对于给定的向量对 $(\\mathbf{x}, \\mathbf{y})$：\n2.  计算 Pearson 相关系数 $\\rho_{xy}$ 并设置 $C_P = |\\rho_{xy}|$。\n3.  计算 Spearman 等级相关系数 $\\rho_S$ 并设置 $C_S = |\\rho_S|$。\n4.  对 $\\mathbf{y}$ 和 $\\mathbf{x}$ 进行 OLS 线性回归，以获得预测值 $\\mathbf{y}_{pred}$。\n5.  计算残差 $\\boldsymbol{\\varepsilon} = \\mathbf{y} - \\mathbf{y}_{pred}$。\n6.  根据残差计算 RMSE。\n7.  计算目标变量 $\\mathbf{y}$ 的标准差 $\\sigma_y$。\n8.  如果 $\\sigma_y > 0$，计算 $C_R = 1 - \\text{RMSE}/\\sigma_y$。如果 $\\sigma_y=0$，则关系是完全平坦的；$\\mathrm{RMSE}$ 和 $\\sigma_y$ 均为 $0$。在这种退化情况下，由于预测误差为零， $C_R$ 取为 $1$。\n9.  计算最终分数 $S = (C_P + C_S + C_R) / 3$。\n此过程将应用于三个数据集上的九个指定关系。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Main function to define datasets, compute tightness scores, and print results.\n    \"\"\"\n\n    def calculate_tightness_score(x_data, y_data):\n        \"\"\"\n        Calculates the tightness score S for a bivariate scaling relation.\n\n        The score S is a convex combination of three terms:\n        1. C_P: Absolute Pearson correlation coefficient.\n        2. C_S: Absolute Spearman rank correlation coefficient.\n        3. C_R: Normalized residual error from an OLS regression.\n\n        S = (C_P + C_S + C_R) / 3\n\n        Args:\n            x_data (list or np.ndarray): The independent variable (descriptor).\n            y_data (list or np.ndarray): The dependent variable (target).\n\n        Returns:\n            float: The calculated tightness score, a value between 0 and 1.\n        \"\"\"\n        x = np.array(x_data, dtype=float)\n        y = np.array(y_data, dtype=float)\n\n        if len(x) != len(y) or len(x)  2:\n            raise ValueError(\"Input arrays must have the same length of at least 2.\")\n\n        # Component 1: Pearson Correlation\n        # scipy.stats.pearsonr returns (correlation, p-value)\n        # We handle the case of constant input, which would give nan.\n        if np.std(x) == 0 or np.std(y) == 0:\n            rho_xy = 0.0\n        else:\n            rho_xy, _ = stats.pearsonr(x, y)\n        \n        c_p = np.abs(rho_xy)\n\n        # Component 2: Spearman Rank Correlation\n        # scipy.stats.spearmanr returns (correlation, p-value)\n        rho_s, _ = stats.spearmanr(x, y)\n        c_s = np.abs(rho_s)\n\n        # Component 3: Normalized Residual Error\n        # Perform OLS regression of y on x\n        slope, intercept, _, _, _ = stats.linregress(x, y)\n        \n        y_pred = slope * x + intercept\n        residuals = y - y_pred\n        \n        rmse = np.sqrt(np.mean(residuals**2))\n        \n        sigma_y = np.std(y)\n        \n        # If sigma_y is 0, y is constant. The best prediction is the mean,\n        # so residuals are 0, RMSE = 0. C_R should be 1.\n        if sigma_y  1e-12: # Use a small tolerance for floating point\n            c_r = 1.0\n        else:\n            nrmse = rmse / sigma_y\n            # The value is guaranteed to be in [0, 1] for OLS with intercept.\n            # max(0, ..) is for robustness.\n            c_r = max(0.0, 1.0 - nrmse)\n\n        # Final Score: Convex combination with equal weights\n        score = (c_p + c_s + c_r) / 3.0\n        \n        return score\n\n    # --- Data Generation ---\n\n    # Dataset A (perfect linear scaling)\n    E_OH_A = np.array([0.8, 1.0, 1.2, 1.4, 1.6])\n    E_OOH_A = E_OH_A + 3.2\n    E_O_A = 2 * E_OH_A + 0.5\n    \n    # Dataset B (monotonic but mildly nonlinear scaling)\n    E_OH_B = np.array([0.7, 0.9, 1.1, 1.3, 1.5])\n    E_OOH_B = 3.1 + E_OH_B + 0.1 * E_OH_B**2\n    E_O_B = 0.5 + 2 * E_OH_B + 0.2 * E_OH_B**2\n\n    # Dataset C (linear relation with an outlier)\n    E_OH_C = np.array([0.8, 1.0, 1.2, 1.4, 1.6])\n    E_OOH_C = E_OH_C + 3.2\n    E_OOH_C[2] += 0.6  # Outlier for OOH at E_OH=1.2\n    E_O_C = 2 * E_OH_C + 0.5\n    E_O_C[1] -= 0.8    # Outlier for O at E_OH=1.0\n\n    # Define the 9 relations to test in the required order\n    # Format: (x_data, y_data)\n    # Order: E_OOH vs E_OH, E_O vs E_OH, E_OOH vs E_O\n    test_cases = [\n        # Dataset A\n        (E_OH_A, E_OOH_A),\n        (E_OH_A, E_O_A),\n        (E_O_A, E_OOH_A),\n        # Dataset B\n        (E_OH_B, E_OOH_B),\n        (E_OH_B, E_O_B),\n        (E_O_B, E_OOH_B),\n        # Dataset C\n        (E_OH_C, E_OOH_C),\n        (E_OH_C, E_O_C),\n        (E_O_C, E_OOH_C),\n    ]\n\n    results = []\n    for x_data, y_data in test_cases:\n        score = calculate_tightness_score(x_data, y_data)\n        results.append(score)\n\n    # Format the final output string as per requirements\n    # Each value rounded to 6 decimal places.\n    output_str = f\"[{','.join([f'{s:.6f}' for s in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "标度关系带来的限制往往成为催化剂性能优化的瓶颈。因此，理性催化剂设计的终极目标之一就是“打破”这些线性趋势，以独立地调控关键中间体的吸附强度。本问题 () 将引导您完成一个思想实验，展示如何利用界面电场这一额外描述符来选择性地稳定一种吸附物（$\\mathrm{OH}$）而非另一种（$\\mathrm{O}$），从而揭示一种克服标度关系限制的有效策略。",
            "id": "4241578",
            "problem": "您的任务是在计算电化学中，构建并评估一个数学上明确、基于描述符的反事实分析，该分析旨在分离出单个界面描述符如何在基本不改变氧吸附能的情况下，改变羟基的吸附能。您的推导和程序必须基于第一性原理，并能产生可进行数值检验的结果。\n\n考虑一个基于描述符的吸附能分解模型，该模型描述了在过渡金属表面位点上的吸附物种 $X \\in \\{\\mathrm{OH}, \\mathrm{O}\\}$。其吸附能被分解为一个化学吸附分量和一个界面静电分量。化学吸附分量依赖于金属电子结构描述符（例如，$d$带中心 $\\varepsilon_d$），而界面静电分量依赖于界面电场 $F$ 和特定于吸附物的表面法向偶极矩 $\\mu_X$。我们假设化学吸附能仅依赖于 $\\varepsilon_d$（在反事实分析中您将保持其恒定），而场依赖的能量仅依赖于 $F$ 和 $\\mu_X$。其物理前提是，氧吸附原子具有可忽略的表面法向偶极矩，而羟基由于其极性的 $\\mathrm{O}-\\mathrm{H}$ 键和界面取向而具有有限的表面法向偶极矩。这一前提得到了吸附研究的广泛支持，并且与外场中的静电相互作用一致。\n\n您的任务是：\n\n- 从第一性原理出发，仅使用偶极子与外电场的静电相互作用以及基于描述符的吸附能分解，推导在两个电场值 $F_0$ 和 $F_1$ 之间，保持 $\\varepsilon_d$ 不变时，吸附能的变化 $\\Delta E_{\\mathrm{ads}}(X)$。除了这些基本依据外，不要使用或假设任何捷径或目标公式。所有能量以电子伏特（$\\mathrm{eV}$）表示，所有电场以伏特每埃（$\\mathrm{V/\\AA}$）表示，所有偶极矩以德拜（Debye）或转换为基本电荷乘以埃（$\\mathrm{e\\AA}$）的单位表示；如果以德拜为单位给出，您必须在内部使用 $1\\,\\mathrm{Debye} = 0.20819434\\,\\mathrm{e\\AA}$ 进行转换。\n- 设计反事实修改，其中仅将界面电场描述符 $F$ 从 $F_0$ 更改为 $F_1$，同时保持化学吸附描述符 $\\varepsilon_d$ 不变（因此化学吸附贡献在差值中被抵消）。利用电场与 $\\mathrm{OH}$ 的表面法向偶极矩耦合，但不与 $\\mathrm{O}$ 耦合的物理机制来实现解耦。\n- 实现一个完整、可运行的程序，对于下面测试套件中的每个测试用例，计算将 $F$ 从 $F_0$ 更改为 $F_1$ 所导致的能量变化 $\\Delta E_{\\mathrm{ads}}(\\mathrm{OH})$ 和 $\\Delta E_{\\mathrm{ads}}(\\mathrm{O})$（单位为 $\\mathrm{eV}$），并评估是否满足解耦判据。一个用例的解耦判据是逻辑条件 $\\left|\\Delta E_{\\mathrm{ads}}(\\mathrm{O})\\right| \\le \\tau$ 且 $\\left|\\Delta E_{\\mathrm{ads}}(\\mathrm{OH})\\right| \\ge \\sigma$，其中 $\\tau$ 是一个以 $\\mathrm{eV}$ 为单位的容差阈值，代表 $\\mathrm{O}$ “无变化”，而 $\\sigma$ 是一个以 $\\mathrm{eV}$ 为单位的显著性阈值，代表 $\\mathrm{OH}$ 有“有意义的变化”。按照下述确切的最终输出格式输出结果。\n\n您必须使用的基本依据：\n\n- 偶极子在沿表面法线的均匀外电场中的静电相互作用能，以及将吸附能分为化学吸附部分（此处保持不变）和场耦合部分的基于描述符的划分。\n- 广泛接受的物理观察：羟基吸附物具有有限的表面法向偶极矩，而氧吸附原子在典型的高对称性吸附构型中具有可忽略的表面法向偶极矩。\n\n测试套件（每个用例提供 $(\\mu_{\\mathrm{OH}}, \\mu_{\\mathrm{O}}, F_0, F_1, \\tau, \\sigma)$；偶极矩单位为德拜，电场单位为 $\\mathrm{V/\\AA}$，阈值单位为 $\\mathrm{eV}$）：\n\n- 用例 $1$：$\\mu_{\\mathrm{OH}} = 1.60$, $\\mu_{\\mathrm{O}} = 0.00$, $F_0 = 0.00$, $F_1 = 0.50$, $\\tau = 1\\times 10^{-6}$, $\\sigma = 0.05$。\n- 用例 $2$（边缘情况，无偶极子）：$\\mu_{\\mathrm{OH}} = 0.00$, $\\mu_{\\mathrm{O}} = 0.00$, $F_0 = 0.00$, $F_1 = 1.00$, $\\tau = 1\\times 10^{-6}$, $\\sigma = 0.05$。\n- 用例 $3$（小的非零 $\\mu_{\\mathrm{O}}$，在容差范围内）：$\\mu_{\\mathrm{OH}} = 1.60$, $\\mu_{\\mathrm{O}} = 0.05$, $F_0 = 0.00$, $F_1 = 1.00$, $\\tau = 0.02$, $\\sigma = 0.05$。\n- 用例 $4$（负电场变化）：$\\mu_{\\mathrm{OH}} = 1.60$, $\\mu_{\\mathrm{O}} = 0.00$, $F_0 = 1.00$, $F_1 = 0.00$, $\\tau = 1\\times 10^{-6}$, $\\sigma = 0.05$。\n- 用例 $5$（由于大的 $\\mu_{\\mathrm{O}}$ 导致解耦失败）：$\\mu_{\\mathrm{OH}} = 1.60$, $\\mu_{\\mathrm{O}} = 0.50$, $F_0 = 0.00$, $F_1 = 0.50$, $\\tau = 0.05$, $\\sigma = 0.05$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且其本身是一个包含三个元素的列表 $[\\Delta E_{\\mathrm{ads}}(\\mathrm{OH}), \\Delta E_{\\mathrm{ads}}(\\mathrm{O}), \\text{decoupled}]$。其中 $\\Delta E_{\\mathrm{ads}}(\\mathrm{OH})$ 和 $\\Delta E_{\\mathrm{ads}}(\\mathrm{O})$ 是以 $\\mathrm{eV}$ 为单位的浮点数，而 $\\text{decoupled}$ 是一个布尔值。例如：$[[x_1,y_1,\\mathrm{True}],[x_2,y_2,\\mathrm{False}],\\ldots]$。",
            "solution": "该问题已经过验证，被认为是科学上合理、定义明确且客观的。它提出了一个可形式化的任务，与计算电化学和基于描述符的材料设计领域直接相关。所有必要的数据、物理前提和约束条件均已提供，没有矛盾或模糊之处。\n\n解决方案首先从基本原理推导吸附能的变化，然后应用此推导来实现指定的反事实分析。\n\n吸附物种 $X$ 在金属表面的吸附能 $E_{\\mathrm{ads}}$ 被建模为化学吸附分量 $E_{\\mathrm{chem}}$ 和静电分量 $E_{\\mathrm{elec}}$ 的总和。化学吸附分量是电子结构描述符（如 $d$ 带中心 $\\varepsilon_d$）的函数，而静电分量则取决于界面电场 $F$ 和吸附物的表面法向偶极矩 $\\mu_X$。总吸附能为：\n$$E_{\\mathrm{ads}}(X, \\varepsilon_d, F) = E_{\\mathrm{chem}}(X, \\varepsilon_d) + E_{\\mathrm{elec}}(X, F, \\mu_X)$$\n该问题定义了一个反事实情景，其中只有界面电场描述符 $F$ 从初始值 $F_0$ 变化到最终值 $F_1$，而化学吸附描述符 $\\varepsilon_d$ 保持不变。我们的任务是推导由此产生的吸附能变化 $\\Delta E_{\\mathrm{ads}}(X)$。\n\n根据静电学的基本原理，静态电偶极矩 $\\vec{\\mu}$ 与均匀外电场 $\\vec{F}$ 的相互作用能由 $U = -\\vec{\\mu} \\cdot \\vec{F}$ 给出。在本模型中，我们只考虑垂直于表面的分量。因此，对吸附能的静电贡献为：\n$$E_{\\mathrm{elec}}(X, F, \\mu_X) = -\\mu_X F$$\n为使该方程在量纲上保持一致并以电子伏特（$\\mathrm{eV}$）为单位得出能量，必须正确管理单位。如果电场 $F$ 的单位是伏特每埃（$\\mathrm{V/\\AA}$），偶极矩 $\\mu_X$ 的单位是基本电荷乘以埃（$\\mathrm{e\\AA}$），它们的乘积直接给出以 $\\mathrm{eV}$ 为单位的能量：\n$$[\\mathrm{e\\AA}] \\times [\\mathrm{V/\\AA}] = [\\mathrm{e}] \\times [\\mathrm{V}] = [\\mathrm{eV}]$$\n问题中给出的偶极矩单位是德拜（$\\mathrm{D}$）。我们必须使用指定的转换因子 $k_{\\mathrm{conv}} = 0.20819434\\,\\mathrm{e\\AA}/\\mathrm{D}$，将偶极矩 $\\mu_X[\\mathrm{D}]$ 转换为所需单位：\n$$\\mu_X[\\mathrm{e\\AA}] = \\mu_X[\\mathrm{D}] \\times k_{\\mathrm{conv}}$$\n\n吸附能的变化 $\\Delta E_{\\mathrm{ads}}(X)$ 是最终状态与初始状态之间的差值：\n$$\\Delta E_{\\mathrm{ads}}(X) = E_{\\mathrm{ads}}(X, \\varepsilon_d, F_1) - E_{\\mathrm{ads}}(X, \\varepsilon_d, F_0)$$\n代入 $E_{\\mathrm{ads}}$ 的分解表达式：\n$$\\Delta E_{\\mathrm{ads}}(X) = [E_{\\mathrm{chem}}(X, \\varepsilon_d) + E_{\\mathrm{elec}}(X, F_1, \\mu_X)] - [E_{\\mathrm{chem}}(X, \\varepsilon_d) + E_{\\mathrm{elec}}(X, F_0, \\mu_X)]$$\n由于 $\\varepsilon_d$ 保持不变，化学吸附项 $E_{\\mathrm{chem}}(X, \\varepsilon_d)$ 被抵消：\n$$\\Delta E_{\\mathrm{ads}}(X) = E_{\\mathrm{elec}}(X, F_1, \\mu_X) - E_{\\mathrm{elec}}(X, F_0, \\mu_X)$$\n现在，代入静电能量表达式 $E_{\\mathrm{elec}} = -\\mu_X F$：\n$$\\Delta E_{\\mathrm{ads}}(X) = (-\\mu_X F_1) - (-\\mu_X F_0)$$\n$$\\Delta E_{\\mathrm{ads}}(X) = -\\mu_X (F_1 - F_0) = -\\mu_X \\Delta F$$\n这是最终推导出的方程。为了在计算中使用给定单位，我们将其写为：\n$$\\Delta E_{\\mathrm{ads}}(X)[\\mathrm{eV}] = - (\\mu_X[\\mathrm{D}] \\times k_{\\mathrm{conv}}) \\times (F_1[\\mathrm{V/\\AA}] - F_0[\\mathrm{V/\\AA}])$$\n这个公式体现了反事实分析：它分离了改变场描述符 $F$ 对吸附能的影响。该影响与吸附物的固有偶极矩 $\\mu_X$ 成线性比例关系。\n\n问题的物理前提是，对于氧，$\\mu_{\\mathrm{O}} \\approx 0$，而对于羟基，$\\mu_{\\mathrm{OH}}$ 是有限的。应用我们推导的公式：\n- 对于氧（$\\mathrm{O}$）：$\\Delta E_{\\mathrm{ads}}(\\mathrm{O}) = -\\mu_{\\mathrm{O}} \\Delta F$。如果 $\\mu_{\\mathrm{O}} \\approx 0$，那么 $\\Delta E_{\\mathrm{ads}}(\\mathrm{O}) \\approx 0$。\n- 对于羟基（$\\mathrm{OH}$）：$\\Delta E_{\\mathrm{ads}}(\\mathrm{OH}) = -\\mu_{\\mathrm{OH}} \\Delta F$。由于 $\\mu_{\\mathrm{OH}}$ 是有限的，任何电场变化（$\\Delta F \\neq 0$）都会引起其吸附能的变化。\n\n这展示了选择性解耦：改变电场 $F$ 主要影响 $\\mathrm{OH}$ 的吸附能，而基本不改变 $\\mathrm{O}$ 的吸附能。程序将为每个测试用例的物种 $\\mathrm{OH}$ 和 $\\mathrm{O}$ 实现此公式。然后，它将评估解耦判据，即逻辑条件：\n$$(\\left|\\Delta E_{\\mathrm{ads}}(\\mathrm{O})\\right| \\le \\tau) \\land (\\left|\\Delta E_{\\mathrm{ads}}(\\mathrm{OH})\\right| \\ge \\sigma)$$\n其中 $\\tau$ 和 $\\sigma$ 分别是给定的容差和显著性阈值。程序将为每个测试用例计算这两个能量变化和此判据的布尔结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and evaluates a descriptor-based counterfactual in computational\n    electrochemistry to isolate the effect of the interfacial electric field\n    on OH and O adsorption energies.\n    \"\"\"\n    # Conversion factor from Debye to elementary charge * angstrom.\n    # 1 Debye = 0.20819434 eÅ\n    DEBYE_TO_EAA = 0.20819434\n\n    # Test suite: (mu_OH[D], mu_O[D], F0[V/Å], F1[V/Å], tau[eV], sigma[eV])\n    test_cases = [\n        # Case 1: Standard decoupling\n        (1.60, 0.00, 0.00, 0.50, 1e-6, 0.05),\n        # Case 2: Edge case with no dipoles, decoupling should fail significance test\n        (0.00, 0.00, 0.00, 1.00, 1e-6, 0.05),\n        # Case 3: Small nonzero mu_O, but within tolerance\n        (1.60, 0.05, 0.00, 1.00, 0.02, 0.05),\n        # Case 4: Negative field change\n        (1.60, 0.00, 1.00, 0.00, 1e-6, 0.05),\n        # Case 5: Decoupling fails due to large mu_O violating tolerance\n        (1.60, 0.50, 0.00, 0.50, 0.05, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        mu_OH_D, mu_O_D, F0, F1, tau, sigma = case\n\n        # Convert dipole moments from Debye to eÅ\n        mu_OH_eA = mu_OH_D * DEBYE_TO_EAA\n        mu_O_eA = mu_O_D * DEBYE_TO_EAA\n\n        # Calculate the change in electric field\n        delta_F = F1 - F0\n\n        # Calculate the change in adsorption energy for OH and O in eV.\n        # The formula is ΔE_ads = -μ * ΔF, where μ is in eÅ and F is in V/Å.\n        # The product (eÅ) * (V/Å) results in eV.\n        delta_E_ads_OH = -mu_OH_eA * delta_F\n        delta_E_ads_O = -mu_O_eA * delta_F\n\n        # Evaluate the decoupling criterion:\n        # |ΔE_ads(O)| = tau AND |ΔE_ads(OH)| >= sigma\n        is_decoupled = (abs(delta_E_ads_O) = tau) and (abs(delta_E_ads_OH) >= sigma)\n\n        results.append([delta_E_ads_OH, delta_E_ads_O, is_decoupled])\n\n    # Final print statement in the exact required format.\n    # The repr() of a list of lists will produce the desired format.\n    # To get the exact string format \"[[...],[...],...]\" without extra spaces,\n    # we build the string manually.\n    \n    formatted_results = []\n    for res in results:\n        # For a boolean, str(True) is 'True', which needs to be 'True'\n        # The default str() output is what's required.\n        formatted_results.append(f\"[{res[0]},{res[1]},{str(res[2])}]\")\n    \n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}