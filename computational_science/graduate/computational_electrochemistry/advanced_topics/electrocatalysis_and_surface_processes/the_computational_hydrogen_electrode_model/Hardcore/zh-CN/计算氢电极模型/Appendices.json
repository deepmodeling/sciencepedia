{
    "hands_on_practices": [
        {
            "introduction": "计算氢电极（CHE）模型的核心在于它能够将电化学反应步骤的吉布斯自由能与可计算的量联系起来。这个练习将指导你完成一个基础但至关重要的任务：在CHE框架下计算氢吸附反应 $H^+ + e^- + * \\rightarrow H^*$ 的自由能变化 $\\Delta G$。通过亲手实现这个计算，你将掌握如何整合密度泛函理论（DFT）计算的电子能量与振动零点能及熵修正，从而为更复杂的电催化分析奠定坚实的计算基础。",
            "id": "4260050",
            "problem": "要求您实现一个完整、可运行的程序，在计算氢电极（CHE）模型下，计算氢（表示为 $H^*$）在金属表面上吸附的吉布斯自由能变。吸附反应为 $H^+ + e^- + * \\rightarrow H^*$，其中 $*$ 代表一个空的表面位点。目标是通过将密度泛函理论（DFT）的电子能量与振动零点能和熵修正相结合，并通过 CHE 框架参考电化学质子-电子库，来评估在 $T=298$ K 时此吸附过程的自由能变 $\\Delta G$。\n\n基本原理：\n- 对于给定状态，吉布斯自由能 $G$ 由 $G = U + pV - T S$ 给出，其中 $U$ 是内能，$p$ 是压力，$V$ 是体积，$T$ 是温度，$S$ 是熵。在标准的基于 DFT 的固态计算中，对于固相，$pV$ 项可以忽略不计，$U$ 则近似为计算出的电子能量 $E_{\\mathrm{DFT}}$ 加上振动零点能。因此，对于状态 $X$，我们写作 $G_X \\approx E_X + \\mathrm{ZPE}_X - T S_X$，其中所有量均以每个粒子的单位一致地表示。\n- 吸附反应的自由能变由反应化学计量定义：$\\Delta G = G_{H^*} - G_{*} - \\mu_{H^+} - \\mu_{e^-}$，其中 $\\mu_{H^+}$ 和 $\\mu_{e^-}$ 分别是质子和电子的化学势。\n- 计算氢电极（CHE）模型将质子-电子对的组合化学势等同于受电极电势和溶液酸度影响的氢分子的化学势。利用质子活度 $a_{H^+}$ 的 Nernst 关系式以及相对于标准氢电极（SHE）的电极电势 $U$ 的定义，CHE 关系式为 $\\mu_{H^+} + \\mu_{e^-} = \\tfrac{1}{2} \\mu_{H_2}(T,p_{H_2}) - e U - k_B T \\ln(10)\\,\\mathrm{pH}$，其中 $e$ 是元电荷，$k_B$ 是玻尔兹曼常数，在标准条件下 $p_{H_2}=1$ bar。氢分子的化学势为 $\\mu_{H_2} \\equiv G_{H_2} \\approx E_{H_2} + \\mathrm{ZPE}_{H_2} - T S_{H_2}$。\n\n程序要求：\n- 对于每个测试用例，您将获得以下参数：\n    - $E_{\\mathrm{surf}}$ (单位 eV)：洁净表面的 DFT 电子能量。\n    - $E_{\\mathrm{surf}+H}$ (单位 eV)：带有吸附氢的表面的 DFT 电子能量。\n    - $E_{H_2}$ (单位 eV)：气相氢分子的 DFT 电子能量。\n    - $\\mathrm{ZPE}_{H^*}$ (单位 eV)：吸附氢的振动零点能。\n    - $\\mathrm{ZPE}_{H_2}$ (单位 eV)：氢分子的振动零点能。\n    - $S_{H^*}$ (单位 eV/K)：在温度 $T$ 下，吸附氢的振动熵贡献。\n    - $S_{H_2}$ (单位 eV/K)：在温度 $T$ 和 $p_{H_2}=1$ bar 条件下，氢分子的熵。\n    - $T$ (单位 K)：温度。\n    - $U$ (单位 V)：相对于标准氢电极（SHE）的电极电势。\n    - $\\mathrm{pH}$ (无量纲)：溶液在 $\\mathrm{pH}$ 标度上的酸度。\n- 所有能量必须按每个基本反应事件（每个吸附氢原子）处理，并以电子伏特（eV）表示。熵以 eV/K 为单位，按每个分子或吸附物计算。最终的自由能变 $\\Delta G$ 必须以 eV 计算。\n\n您的程序必须为每个测试用例执行的算法任务：\n1. 结合给定的 $E_{\\mathrm{surf}+H}$、$E_{\\mathrm{surf}}$、$\\mathrm{ZPE}_{H^*}$ 和 $S_{H^*}$，在给定温度 $T$ 下，计算吸附态表面和洁净表面之间的自由能差 $G_{H^*} - G_{*}$。\n2. 使用给定的 $E_{H_2}$、$\\mathrm{ZPE}_{H_2}$、$S_{H_2}$、$T$、$U$ 和 $\\mathrm{pH}$，通过 CHE 关系式计算质子-电子对的组合化学势。\n3. 组合结果以获得上述定义的吸附反应的 $\\Delta G$。\n\n单位和常数：\n- 所有能量以 eV 表示，熵以 eV/K 表示，温度以 K 表示，电势以 V 表示。\n- 使用 $k_B = 8.617333262145 \\times 10^{-5}$ eV/K 和 $\\ln(10)$ 来计算酸度项。当 $U$ 以伏特为单位时，$e U$ 在数值上等于以 eV 为单位的 $U$，因此电子电荷 $e$ 已被考虑在内。\n\n测试套件：\n为以下四个测试用例提供结果。每个用例指定为元组\n$(E_{\\mathrm{surf}}, E_{\\mathrm{surf}+H}, E_{H_2}, \\mathrm{ZPE}_{H^*}, \\mathrm{ZPE}_{H_2}, S_{H^*}, S_{H_2}, T, U, \\mathrm{pH})$，其值为：\n\n- 用例 1（基准，中性）：$(-100.000,\\,-103.600,\\,-6.800,\\,0.160,\\,0.270,\\,0.00000,\\,0.001345,\\,298.0,\\,0.0,\\,0.0)$\n- 用例 2（正电势）：$(-100.000,\\,-103.600,\\,-6.800,\\,0.160,\\,0.270,\\,0.00000,\\,0.001345,\\,298.0,\\,0.20,\\,0.0)$\n- 用例 3（负电势，非零吸附物熵）：$(-250.000,\\,-253.450,\\,-6.800,\\,0.140,\\,0.270,\\,0.00010,\\,0.001345,\\,298.0,\\,-0.10,\\,0.0)$\n- 用例 4（强碱性溶液）：$(-100.000,\\,-103.600,\\,-6.800,\\,0.160,\\,0.270,\\,0.00000,\\,0.001345,\\,298.0,\\,0.0,\\,14.0)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来（例如，\"[result1,result2,result3,result4]\"）。每个条目必须是一个浮点数，单位为 eV，对应于相应测试用例的 $\\Delta G$，顺序与上面列出的一致。",
            "solution": "该问题已经过验证，被确定为计算电化学领域中一个适定且有科学依据的问题。任务是使用计算氢电极（CHE）模型，计算在金属表面上氢吸附反应 $H^+ + e^- + * \\rightarrow H^*$ 的吉布斯自由能变 $\\Delta G$。\n\n该反应的吉布斯自由能变的基本关系由产物和反应物的自由能之差给出：\n$$\n\\Delta G = G_{H^*} - G_{*} - (\\mu_{H^+} + \\mu_{e^-})\n$$\n其中 $G_{H^*}$ 是带有吸附氢原子的表面的吉布斯自由能，$G_{*}$ 是洁净表面位点的自由能，而 $\\mu_{H^+}$ 和 $\\mu_{e^-}$ 分别是溶液中质子和电子的化学势。\n\n通过遵守指定的三个算法任务，系统地执行计算。\n\n**1. 表面自由能差 ($G_{H^*} - G_{*}$) 的计算**\n\n对于凝聚相，状态 $X$ 的吉布斯自由能 $G$ 通过将其 DFT 计算的电子能量 $E_X$ 与振动零点能 $\\mathrm{ZPE}_X$ 和振动熵项 $T S_X$ 相结合来近似，同时忽略压力-体积（$pV$）的贡献。\n$$\nG_X \\approx E_X + \\mathrm{ZPE}_X - T S_X\n$$\n氢原子吸附到表面位点 $*$ 上的自由能变化是带有吸附物（$H^*$）的表面的自由能与洁净表面（$*$）的自由能之差。\n状态 $H^*$ 对应于整个 `surf+H` 系统，因此其能量为 $E_{\\mathrm{surf}+H}$，并包括吸附物的振动贡献，即 $\\mathrm{ZPE}_{H^*}$ 和 $S_{H^*}$。状态 $*$ 对应于洁净的 `surf` 系统，能量为 $E_{\\mathrm{surf}}$。对于此微分计算，来自洁净位点本身的振动贡献被认为是恒定背景的一部分，因此取为零。\n因此，自由能差为：\n$$\nG_{H^*} - G_{*} \\approx (E_{\\mathrm{surf}+H} - E_{\\mathrm{surf}}) + \\mathrm{ZPE}_{H^*} - T S_{H^*}\n$$\n此项代表由于吸附事件引起的表面自由能变化。\n\n**2. 质子-电子对化学势 ($\\mu_{H^+} + \\mu_{e^-}$) 的计算**\n\nCHE 模型提供了一种表达溶剂化质子-电子对化学势 $\\mu_{H^+} + \\mu_{e^-}$ 的方法，通过将其与气相氢分子化学势 $\\mu_{H_2}$ 相关联。这与析氢反应 $2H^+ + 2e^- \\leftrightarrow H_2$ 建立了平衡。该关系取决于电极电势 $U$ 和溶液的 $\\mathrm{pH}$。\n\nCHE 关系式为：\n$$\n\\mu_{H^+} + \\mu_{e^-} = \\frac{1}{2} \\mu_{H_2}(T, p_{H_2}) - eU - k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\n在这里，$e$ 是元电荷，$k_B$ 是玻尔兹曼常数，氢分子的化学势是在标准压力 $p_{H_2} = 1~\\text{bar}$ 下取值的。$eU$ 项代表电子通过电势 $U$ 时的能量变化；当 $U$ 的单位是伏特（V）时，该能量在数值上等于以电子伏特（eV）为单位的 $U$。涉及 $\\mathrm{pH}$ 的项说明了溶液中 $H^+$ 离子浓度相对于标准条件（$\\mathrm{pH}=0$）的情况。\n\n氢分子的化学势 $\\mu_{H_2}$ 的计算方式与固态自由能类似：\n$$\n\\mu_{H_2} \\equiv G_{H_2} \\approx E_{H_2} + \\mathrm{ZPE}_{H_2} - T S_{H_2}\n$$\n将此代入 CHE 关系式，得到反应物化学势的完整表达式：\n$$\n\\mu_{H^+} + \\mu_{e^-} \\approx \\frac{1}{2} (E_{H_2} + \\mathrm{ZPE}_{H_2} - T S_{H_2}) - eU - k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\n\n**3. $\\Delta G$ 的最终组合**\n\n通过将步骤1和2中的表达式代入 $\\Delta G$ 的主方程，我们获得了氢吸附吉布斯自由能变的完整公式：\n$$\n\\Delta G \\approx \\left[ (E_{\\mathrm{surf}+H} - E_{\\mathrm{surf}}) + \\mathrm{ZPE}_{H^*} - T S_{H^*} \\right] - \\left[ \\frac{1}{2} (E_{H_2} + \\mathrm{ZPE}_{H_2} - T S_{H_2}) - eU - k_B T \\ln(10) \\cdot \\mathrm{pH} \\right]\n$$\n这个方程可以重新排列，按其物理来源对各项进行分组：\n$$\n\\Delta G \\approx \\underbrace{(E_{\\mathrm{surf}+H} - E_{\\mathrm{surf}} - \\frac{1}{2} E_{H_2})}_{\\Delta E} + \\underbrace{(\\mathrm{ZPE}_{H^*} - \\frac{1}{2} \\mathrm{ZPE}_{H_2})}_{\\Delta \\mathrm{ZPE}} - \\underbrace{T(S_{H^*} - \\frac{1}{2} S_{H_2})}_{-T\\Delta S} + eU + k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\n第一项 $\\Delta E$ 是微分电子吸附能。前面提到的公式在所提供的程序中实现，用于使用给定的参数和常数（$k_B = 8.617333262145 \\times 10^{-5}~\\text{eV/K}$ 和 10 的自然对数 $\\ln(10)$）计算每个测试用例的 $\\Delta G$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Gibbs free energy change for hydrogen adsorption using the CHE model.\n    \"\"\"\n    \n    # Define constants as specified in the problem statement.\n    # Boltzmann constant in eV/K.\n    k_B = 8.617333262145e-5\n    # Natural logarithm of 10 for the pH term.\n    ln_10 = np.log(10)\n\n    # Test cases as tuples:\n    # (E_surf, E_surf_H, E_H2, ZPE_H_star, ZPE_H2, S_H_star, S_H2, T, U, pH)\n    test_cases = [\n        # Case 1 (baseline, neutral)\n        (-100.000, -103.600, -6.800, 0.160, 0.270, 0.00000, 0.001345, 298.0, 0.0, 0.0),\n        # Case 2 (positive potential)\n        (-100.000, -103.600, -6.800, 0.160, 0.270, 0.00000, 0.001345, 298.0, 0.20, 0.0),\n        # Case 3 (negative potential, nonzero adsorbate entropy)\n        (-250.000, -253.450, -6.800, 0.140, 0.270, 0.00010, 0.001345, 298.0, -0.10, 0.0),\n        # Case 4 (strongly basic solution)\n        (-100.000, -103.600, -6.800, 0.160, 0.270, 0.00000, 0.001345, 298.0, 0.0, 14.0)\n    ]\n\n    results = []\n\n    def calculate_delta_g(params):\n        \"\"\"\n        Calculates delta G for a single test case.\n        \n        The formula for Delta G is:\n        Delta_G = (G_H* - G_*) - (mu_H+ + mu_e-)\n        \n        Where:\n        G_H* - G_* = (E_surf+H - E_surf) + ZPE_H* - T * S_H*\n        mu_H+ + mu_e- = 0.5 * G_H2 - eU - k_B*T*ln(10)*pH\n        G_H2 = E_H2 + ZPE_H2 - T * S_H2\n        \"\"\"\n        E_surf, E_surf_H, E_H2, ZPE_H_star, ZPE_H2, S_H_star, S_H2, T, U, pH = params\n        \n        # Algorithmic Task 1: Compute the free energy difference on the surface.\n        # G_H* - G_*\n        delta_g_surf = (E_surf_H - E_surf) + ZPE_H_star - T * S_H_star\n        \n        # Algorithmic Task 2: Compute the combined chemical potential of the proton-electron pair.\n        # First, compute the free energy of molecular hydrogen, G_H2.\n        g_h2 = E_H2 + ZPE_H2 - T * S_H2\n        \n        # Then, compute the chemical potential of the proton-electron pair.\n        # The term eU (energy) is numerically equal to U (potential in V) in units of eV.\n        mu_h_plus_e = 0.5 * g_h2 - U - k_B * T * ln_10 * pH\n        \n        # Algorithmic Task 3: Combine the results to get the final Delta G.\n        delta_g_adsorption = delta_g_surf - mu_h_plus_e\n        \n        return delta_g_adsorption\n\n    # Process each test case\n    for case in test_cases:\n        result = calculate_delta_g(case)\n        results.append(result)\n\n    # Format the final output string as required.\n    # The map(str, ...) converts each float result to its string representation.\n    output_string = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型的预测精度很大程度上取决于输入数据的准确性。在使用周期性边界条件的DFT计算中，有限尺寸效应（如吸附物与其周期性镜像之间的伪相互作用）是不可避免的误差来源。本练习旨在解决这一关键问题，你将学习并实施两种主流的修正方案——晶胞尺寸外推法和解析修正式，来消除这些人为误差，从而获得更可靠的吸附能，这是进行精确CHE模型分析的前提。",
            "id": "4260019",
            "problem": "给定从第一性原理计算得到的周期性超胞总能量，这些数据分别对应有无吸附氢原子的金属板模型，并在几个方形面内晶胞长度下进行了采样。有限尺寸的周期性镜像相互作用，特别是来自板偶极子的相互作用，使这些总能量偏离其无限大面积下的值。您的任务是设计一个程序，消除这些偏差，然后使用计算氢电极（CHE）模型评估氢吸附步骤的吉布斯自由能变化。\n\n请从化学势和吉布斯自由能的基本热力学定义，以及可逆氢电极（RHE）的理想、可逆定义开始。不要从任何专门的简化公式入手。使用以下物理上合理的约束和事实：\n- 对于板模型体系，周期性镜像相互作用表现为一个与面积倒数成比例的领头阶项，因此在固定几何结构下，一个状态的能量可以模型化为 $1/A$ 的仿射函数，其中 $A$ 是面内面积。\n- 一个状态在温度 $T$ 下的吉布斯自由能 $G$ 是其内能与适当热学校正（包括零点能和 $T$ 乘以熵）以及任何相关溶剂化校正的总和。\n- CHE模型将质子-电子对的电化学势等同于相同温度下氢气分子化学势的一半，并根据施加的电极电势和依赖于pH的质子化学活性进行移位。\n\n您必须实现两种针对周期性镜像相互作用的校正策略：\n- 晶胞尺寸外推法：拟合总能量与 $1/A$ 的关系，并取截距作为无限大面积能量。\n- 解析校正方案：从每个原始能量中减去一个已知的、特定物种的正系数除以面积，然后对所提供的不同晶胞尺寸下校正后的能量进行平均，以估计无限大面积能量。\n\n然后，将校正后的无限大面积能量与热学和溶剂化校正相结合，并在CHE框架下评估氢吸附自由能变化。同时，计算在没有任何周期性镜像校正情况下的相同吸附自由能（使用每组中最大的晶胞作为“未校正”的代表）。所有能量必须以电子伏特表示。温度 $T$ 的单位是开尔文，电极电势 $U$ 的单位是相对于可逆氢电极的伏特，pH是无量纲的。问题不涉及角度，因此不需要角度单位。\n\n您的程序必须处理以下四个测试用例。在每个用例中，板模型都是方形的，其面内长度列表为 $[L_1,L_2,L_3]$ （单位为埃），面积 $A_i = L_i^2$ （单位为平方埃），以及裸板（$\\ast$）和氢吸附板（$\\ast\\mathrm{H}$）的原始能量。解析校正系数以 $\\alpha_{\\ast}$ 和 $\\alpha_{\\ast\\mathrm{H}}$ 给出，单位为 $\\mathrm{eV}\\cdot\\text{\\AA}^2$。热学和溶剂化校正以零点能 $\\mathrm{ZPE}$、在给定温度 $T$ 下的熵项 $T S$ 和溶剂化自由能校正 $\\Delta G_{\\mathrm{solv}}$ 的形式提供。对于氢气分子，假设其在大型晶胞中计算，周期性镜像相互作用可忽略不计。\n\n使用以下参数集：\n- 情况 $1$（理想情况，中等尺寸晶胞）：\n  - $[L_1,L_2,L_3] = [8,10,12]$\n  - $E_{\\ast}^{\\mathrm{raw}} = [-9.9873,-9.9921,-9.99439]$\n  - $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}} = [-10.304225,-10.31008,-10.3129556]$\n  - $\\alpha_{\\ast} = 0.8$, $\\alpha_{\\ast\\mathrm{H}} = 1.0$\n  - $E_{\\mathrm{H}_2} = -6.800$\n  - $\\mathrm{ZPE}_{\\ast} = 0.050$, $T S_{\\ast} = 0.010$, $\\Delta G_{\\mathrm{solv},\\ast} = 0.000$\n  - $\\mathrm{ZPE}_{\\ast\\mathrm{H}} = 0.200$, $T S_{\\ast\\mathrm{H}} = 0.020$, $\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} = -0.250$\n  - $\\mathrm{ZPE}_{\\mathrm{H}_2} = 0.270$, $T S_{\\mathrm{H}_2} = 0.410$\n  - $T = 298$, $U = 0.0$, $\\mathrm{pH} = 0$\n- 情况 $2$（小尺寸晶胞，强相互作用）：\n  - $[L_1,L_2,L_3] = [6,7,8]$\n  - $E_{\\ast}^{\\mathrm{raw}} = [-9.9663667,-9.9757102,-9.98115]$\n  - $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}} = [-10.2696,-10.2833653,-10.291675]$\n  - $\\alpha_{\\ast} = 1.2$, $\\alpha_{\\ast\\mathrm{H}} = 1.8$\n  - $E_{\\mathrm{H}_2} = -6.800$\n  - $\\mathrm{ZPE}_{\\ast} = 0.050$, $T S_{\\ast} = 0.010$, $\\Delta G_{\\mathrm{solv},\\ast} = 0.000$\n  - $\\mathrm{ZPE}_{\\ast\\mathrm{H}} = 0.200$, $T S_{\\ast\\mathrm{H}} = 0.020$, $\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} = -0.250$\n  - $\\mathrm{ZPE}_{\\mathrm{H}_2} = 0.270$, $T S_{\\mathrm{H}_2} = 0.410$\n  - $T = 298$, $U = 0.1$, $\\mathrm{pH} = 1$\n- 情况 $3$（大尺寸晶胞，弱相互作用，碱性条件）：\n  - $[L_1,L_2,L_3] = [20,24,28]$\n  - $E_{\\ast}^{\\mathrm{raw}} = [-9.99845,-9.9989883,-9.9992147]$\n  - $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}} = [-10.31779,-10.3184075,-10.318862]$\n  - $\\alpha_{\\ast} = 0.6$, $\\alpha_{\\ast\\mathrm{H}} = 0.9$\n  - $E_{\\mathrm{H}_2} = -6.800$\n  - $\\mathrm{ZPE}_{\\ast} = 0.050$, $T S_{\\ast} = 0.010$, $\\Delta G_{\\mathrm{solv},\\ast} = 0.000$\n  - $\\mathrm{ZPE}_{\\ast\\mathrm{H}} = 0.200$, $T S_{\\ast\\mathrm{H}} = 0.020$, $\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} = -0.250$\n  - $\\mathrm{ZPE}_{\\mathrm{H}_2} = 0.270$, $T S_{\\mathrm{H}_2} = 0.410$\n  - $T = 298$, $U = -0.05$, $\\mathrm{pH} = 13$\n- 情况 $4$（无周期性相互作用，检查中性情况）：\n  - $[L_1,L_2,L_3] = [8,10,12]$\n  - $E_{\\ast}^{\\mathrm{raw}} = [-10.0002,-9.9999,-10.00005]$\n  - $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}} = [-10.3201,-10.3199,-10.32005]$\n  - $\\alpha_{\\ast} = 0.0$, $\\alpha_{\\ast\\mathrm{H}} = 0.0$\n  - $E_{\\mathrm{H}_2} = -6.800$\n  - $\\mathrm{ZPE}_{\\ast} = 0.050$, $T S_{\\ast} = 0.010$, $\\Delta G_{\\mathrm{solv},\\ast} = 0.000$\n  - $\\mathrm{ZPE}_{\\ast\\mathrm{H}} = 0.200$, $T S_{\\ast\\mathrm{H}} = 0.020$, $\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} = -0.250$\n  - $\\mathrm{ZPE}_{\\mathrm{H}_2} = 0.270$, $T S_{\\mathrm{H}_2} = 0.410$\n  - $T = 298$, $U = 0.5$, $\\mathrm{pH} = 0$\n\n对于每个用例，您的程序必须计算三个量：\n- 使用最大晶胞的原始能量且不进行任何周期性镜像校正的CHE吸附自由能变化 $\\Delta G$。\n- 对 $\\ast$ 和 $\\ast\\mathrm{H}$ 均使用 $1/A$ 外推法获得的无限大面积能量计算的CHE吸附自由能变化 $\\Delta G$。\n- 对 $\\ast$ 和 $\\ast\\mathrm{H}$ 均使用解析校正方案估计的无限大面积能量计算的CHE吸附自由能变化 $\\Delta G$。\n\n将每个用例的三个输出均以电子伏特表示，并四舍五入到六位小数。您的程序应生成单行输出，包含一个由列表组成的逗号分隔列表，每个内部列表对应一个用例，并按 $[\\Delta G_{\\mathrm{uncorr}}, \\Delta G_{\\mathrm{extrap}}, \\Delta G_{\\mathrm{analytic}}]$ 的顺序排列。例如，您的打印输出必须类似于 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$，其中每个 $x_i,y_i,z_i$ 都是一个浮点数。",
            "solution": "目标是确定氢原子在金属表面电化学吸附的吉布斯自由能变化 $\\Delta G$。该反应由 $\\ast + (\\mathrm{H}^+ + \\mathrm{e}^-) \\rightarrow \\ast\\mathrm{H}$ 给出，其中 $\\ast$ 表示裸金属板上的一个位点，$\\ast\\mathrm{H}$ 表示吸附了一个氢原子的状态。\n\n此过程的吉布斯自由能变化由产物和反应物的吉布斯自由能之差定义：\n$$\n\\Delta G = G_{\\ast\\mathrm{H}} - (G_{\\ast} + \\mu_{\\mathrm{H}^+ + \\mathrm{e}^-})\n$$\n此处，$G_{\\ast\\mathrm{H}}$ 和 $G_{\\ast}$ 分别是氢吸附板和裸板的吉布斯自由能。项 $\\mu_{\\mathrm{H}^+ + \\mathrm{e}^-}$ 代表质子-电子对在电化学环境中的电化学势。\n\n对于任何物种 $X$（例如，$X = \\ast, \\ast\\mathrm{H}, \\mathrm{H}_2$），其吉布斯自由能 $G_X$ 由其计算得到的总电子能量 $E_X$ 构建，并包括零点振动能（$\\mathrm{ZPE}_X$）、热熵（$-T S_X$）和溶剂化效应（$\\Delta G_{\\mathrm{solv},X}$）的校正：\n$$\nG_X = E_X + \\mathrm{ZPE}_X - T S_X + \\Delta G_{\\mathrm{solv},X}\n$$\n问题给出了 $\\mathrm{ZPE}_X$、$T S_X$ 和 $\\Delta G_{\\mathrm{solv},X}$ 的值。核心任务是从提供的周期性DFT计算中找到最准确的电子能量 $E_X$ 值。\n\n计算氢电极（CHE）模型为评估 $\\mu_{\\mathrm{H}^+ + \\mathrm{e}^-}$ 提供了一个框架。问题陈述指明，施加的电势 $U$ 是相对于可逆氢电极（RHE）的，并且质子-电子对的电势会因施加的电势和pH值而发生移位。RHE反应为 $\\mathrm{H}^+ + \\mathrm{e}^- \\rightleftharpoons \\frac{1}{2} \\mathrm{H}_2(g)$，根据定义，在平衡状态下（$U = 0$ V vs RHE），$\\mu_{\\mathrm{H}^+ + \\mathrm{e}^-} = \\frac{1}{2} \\mu_{\\mathrm{H}_2}$。问题指示我们以加和方式考虑施加的电势 $U$ 和一个依赖于pH的项。在施加电势 $U$ 下，电子的能量移位 $-eU$。溶剂化质子的化学势包括一个与活度相关的项，$\\mu_{\\mathrm{H}^+} = \\mu_{\\mathrm{H}^+}^{\\circ} + k_B T \\ln a_{\\mathrm{H}^+}$。pH定义为 $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$，这意味着 $a_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}}$，因此 $\\ln a_{\\mathrm{H}^+} = -\\mathrm{pH}\\ln(10)$。这引入了一个依赖于pH的能量移位 $-k_B T \\ln(10) \\cdot \\mathrm{pH}$。尽管参照RHE通常会吸收pH的依赖性，我们遵循明确的指示，同时包括这两个移位。因此，质子-电子对的电化学势模型化为：\n$$\n\\mu_{\\mathrm{H}^+ + \\mathrm{e}^-} = \\frac{1}{2} G_{\\mathrm{H}_2} - eU - k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\n在此表达式中，我们使用氢气分子的吉布斯自由能 $G_{\\mathrm{H}_2} = E_{\\mathrm{H}_2} + \\mathrm{ZPE}_{\\mathrm{H}_2} - T S_{\\mathrm{H}_2}$ 作为参考。当能量单位为电子伏特（eV）且电势 $U$ 单位为伏特（V）时，我们取元电荷 $e$ 为 $1$。\n\n结合这些定义，氢吸附自由能的总体表达式变为：\n$$\n\\Delta G = (G_{\\ast\\mathrm{H}} - G_{\\ast}) - \\left( \\frac{1}{2} G_{\\mathrm{H}_2} - U - k_B T \\ln(10) \\cdot \\mathrm{pH} \\right)\n$$\n代入 $G_X$ 的表达式：\n$$\n\\Delta G = (E_{\\ast\\mathrm{H}} - E_{\\ast}) + (\\mathrm{ZPE}_{\\ast\\mathrm{H}} - \\mathrm{ZPE}_{\\ast}) - (T S_{\\ast\\mathrm{H}} - T S_{\\ast}) + (\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} - \\Delta G_{\\mathrm{solv},\\ast}) - \\frac{1}{2}(E_{\\mathrm{H}_2} + \\mathrm{ZPE}_{\\mathrm{H}_2} - T S_{\\mathrm{H}_2}) + U + k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\n主要挑战在于，原始电子能量 $E_{\\ast}^{\\mathrm{raw}}$ 和 $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}}$ 是在有限面积 $A$ 的周期性超胞中计算的，因此受到与周期性镜像 spurious 相互作用的污染。对于具有垂直于板的净偶极矩的体系（如 $\\ast\\mathrm{H}$），这些相互作用随晶胞尺寸的增大而缓慢衰减，引入一个与 $1/A$ 成比例的偏差。“真实”的电子能量对应于无限大面积的极限，即 $E^{\\infty} = \\lim_{A \\to \\infty} E(A)$。问题规定了此有限尺寸效应的模型：\n$$\nE^{\\mathrm{raw}}(A) = E^{\\infty} + \\frac{\\alpha}{A}\n$$\n其中 $E^{\\infty}$ 是期望的无限大面积能量，$\\alpha$ 是特定物种的相互作用系数。我们的任务是使用三种不同的方法来估计 $E_{\\ast}^{\\infty}$ 和 $E_{\\ast\\mathrm{H}}^{\\infty}$。\n\n1.  **未校正方法：** 此方法作为基线。它忽略了有限尺寸误差，并将最大超胞面积（$A_{\\mathrm{max}}$）计算得到的能量作为 $E^{\\infty}$ 的近似值。\n    $$E_X^{\\infty, \\mathrm{uncorr}} = E_X^{\\mathrm{raw}}(A_{\\mathrm{max}})$$\n\n2.  **外推法：** 此方法直接利用仿射模型 $E^{\\mathrm{raw}} = E^{\\infty} + \\alpha (1/A)$。将能量 $E^{\\mathrm{raw}}$ 对面积倒数 $1/A$ 作图。对数据点 $(1/A_i, E_i^{\\mathrm{raw}})$ 进行线性最小二乘回归。拟合线的截距对应于 $A \\to \\infty$（即 $1/A \\to 0$）的极限，从而提供对 $E^{\\infty}$ 的估计。\n    $$E_X^{\\infty, \\mathrm{extrap}} = E_X^{\\mathrm{raw}} \\text{ vs. } 1/A \\text{ 拟合的截距}$$\n\n3.  **解析校正法：** 此方法假设相互作用系数 $\\alpha$ 是先验已知的。对于每个物种 $X$，通过明确减去模型化的相互作用项，为每个晶胞尺寸 $A_i$ 计算一个校正后的能量：\n    $$E_{X, i}^{\\mathrm{corr}} = E_{X, i}^{\\mathrm{raw}} - \\frac{\\alpha_X}{A_i}$$\n    这些校正后的能量 $E_{X, i}^{\\mathrm{corr}}$ 中的每一个都是 $E_X^{\\infty}$ 的一个估计值。为了获得一个单一、稳健的估计，我们对所有可用晶胞尺寸的校正能量取平均值。\n    $$E_X^{\\infty, \\mathrm{analytic}} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( E_{X, i}^{\\mathrm{raw}} - \\frac{\\alpha_X}{A_i} \\right)$$\n\n对于每个测试用例，我们将使用这三种方法分别计算无限大面积能量对 $(E_{\\ast}^{\\infty}, E_{\\ast\\mathrm{H}}^{\\infty})$。随后，对于每一对能量，我们将使用上面推导的主方程计算最终的吸附自由能 $\\Delta G$。这将产生所需的三个值：$\\Delta G_{\\mathrm{uncorr}}$、$\\Delta G_{\\mathrm{extrap}}$ 和 $\\Delta G_{\\mathrm{analytic}}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.constants import k, e\n\ndef solve():\n    \"\"\"\n    Computes the Gibbs free-energy change for hydrogen adsorption on a metal slab\n    using the Computational Hydrogen Electrode (CHE) model, with three different\n    schemes for correcting finite-size errors in the total energies.\n    \"\"\"\n    # Boltzmann constant in eV/K\n    k_B = k / e\n\n    # Natural logarithm of 10\n    ln10 = np.log(10)\n\n    test_cases = [\n        # Case 1 (happy path, moderate cells)\n        {\n            \"L\": np.array([8, 10, 12]),\n            \"E_star_raw\": np.array([-9.9873, -9.9921, -9.99439]),\n            \"E_starH_raw\": np.array([-10.304225, -10.31008, -10.3129556]),\n            \"alpha_star\": 0.8, \"alpha_starH\": 1.0,\n            \"E_H2\": -6.800,\n            \"ZPE_star\": 0.050, \"TS_star\": 0.010, \"dG_solv_star\": 0.000,\n            \"ZPE_starH\": 0.200, \"TS_starH\": 0.020, \"dG_solv_starH\": -0.250,\n            \"ZPE_H2\": 0.270, \"TS_H2\": 0.410,\n            \"T\": 298, \"U\": 0.0, \"pH\": 0\n        },\n        # Case 2 (small cells, strong interactions)\n        {\n            \"L\": np.array([6, 7, 8]),\n            \"E_star_raw\": np.array([-9.9663667, -9.9757102, -9.98115]),\n            \"E_starH_raw\": np.array([-10.2696, -10.2833653, -10.291675]),\n            \"alpha_star\": 1.2, \"alpha_starH\": 1.8,\n            \"E_H2\": -6.800,\n            \"ZPE_star\": 0.050, \"TS_star\": 0.010, \"dG_solv_star\": 0.000,\n            \"ZPE_starH\": 0.200, \"TS_starH\": 0.020, \"dG_solv_starH\": -0.250,\n            \"ZPE_H2\": 0.270, \"TS_H2\": 0.410,\n            \"T\": 298, \"U\": 0.1, \"pH\": 1\n        },\n        # Case 3 (large cells, weak interactions, alkaline conditions)\n        {\n            \"L\": np.array([20, 24, 28]),\n            \"E_star_raw\": np.array([-9.99845, -9.9989883, -9.9992147]),\n            \"E_starH_raw\": np.array([-10.31779, -10.3184075, -10.318862]),\n            \"alpha_star\": 0.6, \"alpha_starH\": 0.9,\n            \"E_H2\": -6.800,\n            \"ZPE_star\": 0.050, \"TS_star\": 0.010, \"dG_solv_star\": 0.000,\n            \"ZPE_starH\": 0.200, \"TS_starH\": 0.020, \"dG_solv_starH\": -0.250,\n            \"ZPE_H2\": 0.270, \"TS_H2\": 0.410,\n            \"T\": 298, \"U\": -0.05, \"pH\": 13\n        },\n        # Case 4 (no periodic interaction, check neutrality)\n        {\n            \"L\": np.array([8, 10, 12]),\n            \"E_star_raw\": np.array([-10.0002, -9.9999, -10.00005]),\n            \"E_starH_raw\": np.array([-10.3201, -10.3199, -10.32005]),\n            \"alpha_star\": 0.0, \"alpha_starH\": 0.0,\n            \"E_H2\": -6.800,\n            \"ZPE_star\": 0.050, \"TS_star\": 0.010, \"dG_solv_star\": 0.000,\n            \"ZPE_starH\": 0.200, \"TS_starH\": 0.020, \"dG_solv_starH\": -0.250,\n            \"ZPE_H2\": 0.270, \"TS_H2\": 0.410,\n            \"T\": 298, \"U\": 0.5, \"pH\": 0\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        L = case[\"L\"]\n        A = L**2\n        inv_A = 1.0 / A\n\n        # Environmental and thermal contributions\n        G_H2 = case[\"E_H2\"] + case[\"ZPE_H2\"] - case[\"TS_H2\"]\n        \n        dG_corr = (case[\"ZPE_starH\"] - case[\"ZPE_star\"]) - \\\n                  (case[\"TS_starH\"] - case[\"TS_star\"]) + \\\n                  (case[\"dG_solv_starH\"] - case[\"dG_solv_star\"])\n        \n        dG_U_pH = case[\"U\"] + k_B * case[\"T\"] * ln10 * case[\"pH\"]\n\n        def calculate_delta_G(E_star_inf, E_starH_inf):\n            dE_inf = E_starH_inf - E_star_inf\n            delta_G = dE_inf + dG_corr - 0.5 * G_H2 + dG_U_pH\n            return delta_G\n\n        # Method 1: Uncorrected (largest cell)\n        E_star_inf_uncorr = case[\"E_star_raw\"][-1]\n        E_starH_inf_uncorr = case[\"E_starH_raw\"][-1]\n        dG_uncorr = calculate_delta_G(E_star_inf_uncorr, E_starH_inf_uncorr)\n\n        # Method 2: 1/A Extrapolation\n        _, E_star_inf_extrap = np.polyfit(inv_A, case[\"E_star_raw\"], 1)\n        _, E_starH_inf_extrap = np.polyfit(inv_A, case[\"E_starH_raw\"], 1)\n        dG_extrap = calculate_delta_G(E_star_inf_extrap, E_starH_inf_extrap)\n\n        # Method 3: Analytic Correction\n        E_star_corr = case[\"E_star_raw\"] - case[\"alpha_star\"] * inv_A\n        E_star_inf_analytic = np.mean(E_star_corr)\n        \n        E_starH_corr = case[\"E_starH_raw\"] - case[\"alpha_starH\"] * inv_A\n        E_starH_inf_analytic = np.mean(E_starH_corr)\n        \n        dG_analytic = calculate_delta_G(E_star_inf_analytic, E_starH_inf_analytic)\n\n        case_results = [\n            round(dG_uncorr, 6),\n            round(dG_extrap, 6),\n            round(dG_analytic, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "计算吸附自由能本身并非终点，我们的最终目标是利用它来预测和解释催化活性。这个高级练习将带你从计算 $\\Delta G$ 迈向催化剂性能的评估，即构建描述催化活性的“火山图”。你将探索火山图的顶点位置（代表最优催化剂）如何对热化学修正模型和溶液pH值等条件敏感，从而深刻理解理论模型在实际催化剂筛选和设计中的指导作用与局限性。",
            "id": "4260006",
            "problem": "您正在标准氢电极（SHE）标度下，在计算氢电极（CHE）框架内，研究基于描述符的析氢反应活性火山图对熵修正和氢离子活性的敏感性。从基础热力学和电化学势出发，推导并实现一个程序，以重新计算吸附氢形成的吉布斯自由能变化，并量化在不同热化学模型和$pH$条件下，预测的活性和火山图顶点位置如何移动。\n\n您必须使用的假设和基本依据：\n\n- 相关的基元步骤是吸附氢的形成，写作 $H^+ + e^- + * \\rightarrow H^*$，其中$*$表示空的表面位点，$H^*$表示吸附的氢中间体。此步骤的吉布斯自由能变化由产物和反应物的化学势之差给出。使用热力学恒等式，对于任何物种$i$，其化学势为$\\mu_i = \\mu_i^\\circ + k_B T \\ln a_i + z_i e \\phi$，其中$k_B$是玻尔兹曼常数，$T$是温度，$a_i$是活度，$z_i$是电荷数，$e$是元电荷，$\\phi$是静电势。\n- 标准氢电极（SHE）标度上的计算氢电极（CHE）模型将质子和电子的组合化学势与分子氢相关联。对$pH$的依赖性源于质子活度项。在SHE标度上进行计算，电极电势$U$以伏特表示。使用恒等式$a_{H^+} = 10^{-pH}$。\n- 密度泛函理论吸附描述符$ \\Delta E_{\\text{H}^*}$是从$\\tfrac{1}{2}H_2(g)$形成$H^*$的电子能量变化，忽略了零点能和熵项。相应的吉布斯自由能变化包括您将通过热化学建模的零点能和熵修正。\n- 对于预测的相对活性，假设一个对称的、基于描述符的火山图，其中决速步能垒近似为自由能驱动力与热中性状态的绝对偏差。根据过渡态理论，设预测的相对活性与$\\exp\\!\\left(-\\left|\\Delta G_{\\text{eff}}\\right|/(k_B T)\\right)$成比例，其中$\\Delta G_{\\text{eff}}$是在指定条件下形成$H^*$的有效自由能变化。\n\n需要比较的热化学模型：\n\n- 模型$\\mathrm{M1}$（“标准”）：对$ \\Delta E_{\\text{H}^*}$包括一个$0.04$ eV的零点能修正$\\Delta \\mathrm{ZPE}$。包括一个在$T = 298.15$ K时为$0.20$ eV的熵罚$-T \\Delta S$，该值与$T$成正比（即随$T$线性变化）。\n- 模型$\\mathrm{M2}$（“包含振动熵”）：$\\Delta \\mathrm{ZPE} = 0.04$ eV，在$T = 298.15$ K时$-T \\Delta S = 0.16$ eV，与$T$成正比。\n- 模型$\\mathrm{M3}$（$p_{H_2} = 0.1$ bar的“低氢压”）：$\\Delta \\mathrm{ZPE} = 0.04$ eV，在$T = 298.15$ K时$-T \\Delta S = 0.23$ eV，与$T$成正比。\n\n所有能量单位必须是电子伏特。通过注意$1$ eV对应于$1$ V乘以元电荷，将$eU$处理为电子伏特单位。使用$k_B = 8.617333262145 \\times 10^{-5}$ eV/K。使用$\\ln(10) = 2.302585093$。\n\n您的程序必须为每个测试用例执行的任务：\n\n- 在给定的$ \\Delta E_{\\text{H}^*}$、热化学模型、$T$、$pH$和SHE标度上的$U$下，仅使用上述基本关系式，计算形成$H^*$的有效自由能变化$\\Delta G_{\\text{eff}}$。\n- 计算预测的相对活性$A = \\exp\\!\\left(-\\left|\\Delta G_{\\text{eff}}\\right|/(k_B T)\\right)$。\n- 为相同的$ \\Delta E_{\\text{H}^*}$、$T$和$U$，但在$pH = 0$并使用模型$\\mathrm{M1}$的条件下，定义一个基准活性$A_0$。计算活性比$r = A / A_0$（无量纲，以小数形式报告）。\n- 确定火山图在描述符轴上的顶点位置，即在指定的热化学模型、$T$、$pH$和$U$下，使$\\Delta G_{\\text{eff}} = 0$的$ \\Delta E_{\\text{apex}}$值。以eV报告此顶点位置。\n\n物理单位和格式：\n\n- 以eV报告火山图顶点位置，四舍五入到$6$位小数。\n- 以小数形式报告活性比$r$（无百分号），四舍五入到$6$位小数。\n\n要实现和评估的测试套件：\n\n每个测试用例是一个元组$(\\mathrm{model}, \\Delta E_{\\text{H}^*}\\text{ (eV)}, T\\text{ (K)}, pH, U\\text{ (V vs SHE)})$。\n\n- 测试用例 $1$: $(\\mathrm{M1}, -0.10, 298.15, 0, 0.0)$\n- 测试用例 $2$: $(\\mathrm{M1}, -0.10, 298.15, 14, 0.0)$\n- 测试用例 $3$: $(\\mathrm{M2}, -0.10, 298.15, 0, 0.0)$\n- 测试用例 $4$: $(\\mathrm{M3}, -0.10, 298.15, 0, 0.0)$\n- 测试用例 $5$: $(\\mathrm{M3}, 0.00, 298.15, 14, 0.0)$\n- 测试用例 $6$: $(\\mathrm{M2}, 0.20, 350.00, 7, 0.0)$\n\n最终输出格式：\n\n您的程序应生成单行输出，包含一个每个测试用例结果的列表，其中每个结果是一个双元素列表$[\\Delta E_{\\text{apex}}\\text{ (eV)}, r]$，两个条目均按规定四舍五入。整个输出必须是这些双元素列表的单个方括号列表，例如：$[[x_1,y_1],[x_2,y_2],\\dots]$，其中条目为数值。\n\n不读取任何输入；所有常数和测试套件值均按上文规定硬编码。程序必须是自包含的，并且能按提供的方式运行。",
            "solution": "问题陈述已经过严格审查，并被确定为**有效**。它在科学上基于计算电化学和热力学的原理，问题设定良好，目标明确，数据充分，并且没有内部矛盾或含糊之处。\n\n在此，我们提出详细的推导和算法步骤来解决该问题。\n\n所考虑的基本反应是在催化剂表面上形成一个吸附的氢原子，这是析氢反应（HER）的一个基元步骤：\n$$ H^+ + e^- + * \\rightarrow H^* $$\n其中$H^+$表示溶液中的质子，$e^-$是来自电极的电子，$*$是未被占据的表面活性位点，$H^*$是吸附在位点上的氢原子。\n\n此反应的吉布斯自由能变化，我们记为$\\Delta G_{\\text{eff}}$，由产物和反应物的化学势之差给出：\n$$ \\Delta G_{\\text{eff}} = \\mu_{H^*} - (\\mu_{*} + \\mu_{H^+} + \\mu_{e^-}) $$\n此表达式可以重排，将与表面相关的项和与溶液/电极相关的项分组：\n$$ \\Delta G_{\\text{eff}} = (\\mu_{H^*} - \\mu_{*}) - (\\mu_{H^+} + \\mu_{e^-}) $$\n\n问题的核心在于将这两个括号内的项表示为给定参数的函数：电子能量描述符$\\Delta E_{\\text{H}^*}$、温度$T$、$pH$和电极电势$U$。\n\n**1. 质子-电子对的化学势 $(\\mu_{H^+} + \\mu_{e^-})$**\n\n计算氢电极（CHE）模型提供了一个框架，用于将电化学环境中质子-电子对的化学势与气态氢$H_2(g)$的化学势关联起来。参考平衡为：\n$$ H^+ + e^- \\rightleftharpoons \\frac{1}{2} H_2(g) $$\n在标准氢电极（SHE）条件下（$U = 0$ V，$pH=0$即$a_{H^+} = 1$，以及在给定温度$T$下$p_{H_2} = 1$ bar），该平衡决定了该对的化学势等于氢分子化学势的一半：\n$$ \\mu_{H^+} + \\mu_{e^-} = \\frac{1}{2} \\mu_{H_2(g)} \\quad (\\text{在SHE条件下}) $$\n现在，我们引入非标准$pH$和电势$U$的影响。物种$i$的化学势由$\\mu_i = \\mu_i^\\circ + k_B T \\ln a_i + z_i e \\phi$给出。\n对于质子（$z_i = +1$），其电势取决于其活度$a_{H^+} = 10^{-pH}$：\n$$ \\mu_{H^+} = \\mu_{H^+}^\\circ + k_B T \\ln(10^{-pH}) = \\mu_{H^+}^\\circ - k_B T \\ln(10) \\cdot pH $$\n对于电极中相对于SHE电势为$U$的电子（$z_i = -1$），其化学势移动了$-eU$：\n$$ \\mu_{e^-} = \\mu_{e^-, \\text{SHE}} - eU $$\n结合这些，任意$(pH, U)$下该对的化学势为：\n$$ \\mu_{H^+} + \\mu_{e^-} = (\\mu_{H^+}^\\circ + \\mu_{e^-, \\text{SHE}}) - k_B T \\ln(10) \\cdot pH - eU $$\n认识到$(\\mu_{H^+}^\\circ + \\mu_{e^-, \\text{SHE}})$是标准条件下该对的电势，我们代入CHE平衡条件：\n$$ \\mu_{H^+} + \\mu_{e^-} = \\frac{1}{2}\\mu_{H_2(g)}^\\circ - k_B T \\ln(10) \\cdot pH - eU $$\n其中$\\mu_{H_2(g)}^\\circ$是$H_2(g)$在$p_{H_2} = 1$ bar时的化学势。问题指明，当$U$以伏特为单位时，$eU$项可以简单地写成$U$，单位为电子伏特（eV）。\n\n**2. 吸附氢的化学势 $(\\mu_{H^*} - \\mu_{*})$**\n\n此项表示吸附氢原子相对于裸露表面的自由能。我们将其与给定的DFT描述符$\\Delta E_{\\text{H}^*}$关联。该描述符是为反应$* + \\frac{1}{2}H_2(g) \\rightarrow H^*$定义的，代表电子能量的变化。此过程相应的吉布斯自由能变化$\\Delta G_{\\text{H}^*}$包括了零点能（$\\Delta \\mathrm{ZPE}$）和熵（$\\Delta S$）的热化学修正：\n$$ \\Delta G_{\\text{H}^*} = \\Delta E_{\\text{H}^*} + \\Delta G_{corr} = \\Delta E_{\\text{H}^*} + \\Delta \\mathrm{ZPE} - T \\Delta S $$\n根据定义，$\\Delta G_{\\text{H}^*}$也是化学势之差：\n$$ \\Delta G_{\\text{H}^*} = (\\mu_{H^*} - \\mu_{*}) - \\frac{1}{2}\\mu_{H_2(g)}^\\circ $$\n由此，我们可以将表面项表示为：\n$$ \\mu_{H^*} - \\mu_{*} = \\Delta G_{\\text{H}^*} + \\frac{1}{2}\\mu_{H_2(g)}^\\circ = (\\Delta E_{\\text{H}^*} + \\Delta G_{corr}) + \\frac{1}{2}\\mu_{H_2(g)}^\\circ $$\n\n问题指明，熵的贡献$-T \\Delta S$与温度$T$成正比。给定一个参考温度$T_{ref} = 298.15$ K下的参考值$(-T \\Delta S)_{ref}$，在任意温度$T$下的值为：\n$$ -T \\Delta S = (-T_{ref} \\Delta S) \\frac{T}{T_{ref}} $$\n令$C_{ref} = (-T \\Delta S)_{ref}$。总的热化学修正为：\n$$ \\Delta G_{corr}(T) = \\Delta \\mathrm{ZPE} + C_{ref} \\frac{T}{T_{ref}} $$\n\n**3. $\\Delta G_{\\text{eff}}$ 的最终表达式**\n\n将两个括号项的表达式代入$\\Delta G_{\\text{eff}}$的方程中：\n$$ \\Delta G_{\\text{eff}} = \\left( (\\Delta E_{\\text{H}^*} + \\Delta G_{corr}) + \\frac{1}{2}\\mu_{H_2(g)}^\\circ \\right) - \\left( \\frac{1}{2}\\mu_{H_2(g)}^\\circ - k_B T \\ln(10) \\cdot pH - eU \\right) $$\n$\\frac{1}{2}\\mu_{H_2(g)}^\\circ$ 项相互抵消，得到最终的工作方程。使用惯例，以eV为单位的$eU$在数值上等于以伏特为单位的$U$：\n$$ \\Delta G_{\\text{eff}} = \\Delta E_{\\text{H}^*} + \\Delta G_{corr} + k_B T \\ln(10) \\cdot pH + U $$\n$$ \\Delta G_{\\text{eff}} = \\Delta E_{\\text{H}^*} + \\left(\\Delta \\mathrm{ZPE} + C_{ref} \\frac{T}{298.15~\\text{K}}\\right) + k_B T \\ln(10) \\cdot pH + U $$\n\n**4. 所需量的计算**\n\n- **火山图顶点位置 ($\\Delta E_{\\text{apex}}$)**：活性火山图顶点对应于最有利的条件，即驱动力为热中性，即$\\Delta G_{\\text{eff}} = 0$。我们求解满足此条件的描述符值$\\Delta E_{\\text{H}^*} = \\Delta E_{\\text{apex}}$：\n  $$ 0 = \\Delta E_{\\text{apex}} + \\Delta G_{corr} + k_B T \\ln(10) \\cdot pH + U $$\n  $$ \\Delta E_{\\text{apex}} = -(\\Delta G_{corr} + k_B T \\ln(10) \\cdot pH + U) $$\n\n- **活性比 ($r$)**：预测的相对活性$A$由$A = \\exp(-\\left|\\Delta G_{\\text{eff}}\\right|/(k_B T))$给出。比率$r$定义为$r = A/A_0$，其中$A_0$是基准条件下的活性（相同的$\\Delta E_{\\text{H}^*}, T, U$，但使用模型$\\mathrm{M1}$和$pH=0$）。\n  首先，我们计算指定测试用例条件下的$\\Delta G_{\\text{eff}}$。\n  其次，我们计算基准条件下的$\\Delta G_{\\text{eff}, 0}$。$pH$项变为零，$\\Delta G_{corr, 0}$使用模型$\\mathrm{M1}$的参数计算：\n  $$ \\Delta G_{\\text{eff}, 0} = \\Delta E_{\\text{H}^*} + \\left(\\Delta \\mathrm{ZPE}_{\\mathrm{M1}} + C_{ref, \\mathrm{M1}} \\frac{T}{298.15~\\text{K}}\\right) + U $$\n  活性比$r$则为：\n  $$ r = \\frac{A}{A_0} = \\frac{\\exp(-\\left|\\Delta G_{\\text{eff}}\\right|/(k_B T))}{\\exp(-\\left|\\Delta G_{\\text{eff}, 0}\\right|/(k_B T))} = \\exp\\left( \\frac{\\left|\\Delta G_{\\text{eff}, 0}\\right| - \\left|\\Delta G_{\\text{eff}}\\right|}{k_B T} \\right) $$\n\n这些推导出的公式在以下Python代码中实现，用于处理指定的测试套件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the volcano apex and activity ratio based on the Computational\n    Hydrogen Electrode (CHE) model.\n    \"\"\"\n\n    # --- Define Constants and Models ---\n    # Physical Constants\n    KB_EV_K = 8.617333262145e-5  # Boltzmann constant in eV/K\n    LN_10 = 2.302585093          # Natural logarithm of 10\n    T_REF = 298.15               # Reference temperature in K\n\n    # Thermochemical Models\n    # Structure: {model_name: {'dZPE': value_in_eV, 'TdS_ref': value_in_eV}}\n    # The 'TdS_ref' key corresponds to the value of -T*DeltaS at T_REF\n    models = {\n        'M1': {'dZPE': 0.04, 'TdS_ref': 0.20}, # \"standard\"\n        'M2': {'dZPE': 0.04, 'TdS_ref': 0.16}, # \"vibrational entropy included\"\n        'M3': {'dZPE': 0.04, 'TdS_ref': 0.23}, # \"low hydrogen pressure\"\n    }\n\n    # --- Test Suite ---\n    # Each case is a tuple: (model_name, dE_H_star_eV, T_K, pH, U_V)\n    test_cases = [\n        ('M1', -0.10, 298.15, 0, 0.0),\n        ('M1', -0.10, 298.15, 14, 0.0),\n        ('M2', -0.10, 298.15, 0, 0.0),\n        ('M3', -0.10, 298.15, 0, 0.0),\n        ('M3', 0.00, 298.15, 14, 0.0),\n        ('M2', 0.20, 350.00, 7, 0.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        model_name, dE_H, T, pH, U = case\n\n        # --- Calculate quantities for the current test case ---\n\n        # 1. Thermochemical correction term (dG_corr)\n        model_params = models[model_name]\n        dZPE = model_params['dZPE']\n        C_ref = model_params['TdS_ref'] # This is (-T*dS)_ref\n        dG_corr = dZPE + C_ref * (T / T_REF)\n\n        # 2. pH-dependent energy term\n        pH_term = KB_EV_K * T * LN_10 * pH\n\n        # 3. Calculate volcano apex position (dE_apex)\n        # dE_apex is the value of dE_H where dG_eff = 0\n        dE_apex = -(dG_corr + pH_term + U)\n\n        # 4. Calculate effective Gibbs free energy (dG_eff) for the given dE_H\n        dG_eff = dE_H + dG_corr + pH_term + U\n\n        # --- Calculate quantities for the baseline case (A0) ---\n\n        # Baseline conditions: same dE_H, T, U but with Model M1 and pH = 0\n        baseline_model_params = models['M1']\n        dZPE_0 = baseline_model_params['dZPE']\n        C_ref_0 = baseline_model_params['TdS_ref']\n        dG_corr_0 = dZPE_0 + C_ref_0 * (T / T_REF)\n        \n        # pH term for baseline is zero\n        pH_term_0 = 0.0\n        \n        # dG_eff for the baseline case\n        dG_eff_0 = dE_H + dG_corr_0 + pH_term_0 + U\n\n        # --- Calculate activity ratio (r) ---\n        kBT = KB_EV_K * T\n        \n        # The exponent in r = exp((|dG_eff_0| - |dG_eff|) / kBT)\n        # Use np.abs for absolute value\n        exponent = (np.abs(dG_eff_0) - np.abs(dG_eff)) / kBT\n        \n        # The ratio r = A/A0\n        r = np.exp(exponent)\n\n        # --- Store and format results ---\n        # Round to 6 decimal places as required\n        rounded_dE_apex = round(dE_apex, 6)\n        rounded_r = round(r, 6)\n        \n        results.append(f\"[{rounded_dE_apex:.6f},{rounded_r:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}