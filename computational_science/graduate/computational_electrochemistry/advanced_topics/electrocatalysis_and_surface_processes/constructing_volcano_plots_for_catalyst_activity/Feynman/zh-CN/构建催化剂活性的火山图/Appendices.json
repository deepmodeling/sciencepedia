{
    "hands_on_practices": [
        {
            "introduction": "火山图的构建始于一个关键的步骤：为催化剂体系计算一个或多个描述符。本实践将指导您完成这一基础任务，即利用密度泛函理论（DFT）计算的原始能量数据，结合零点能（ZPE）和熵的修正，来计算吸附吉布斯自由能（$\\Delta G_{\\mathrm{ads}}$）。通过这个练习，您将掌握将第一性原理计算结果与严格的热力学框架相结合的核心技能，为后续的活性预测奠定坚实的计算基础 。",
            "id": "4240485",
            "problem": "您的任务是计算一个吸附吉布斯自由能描述符，该描述符通过参考气相分子的密度泛函理论 (DFT) 总能量并包含零点能和熵校正，适用于构建催化剂活性的火山图。该描述符是吸附吉布斯自由能变，记为 $\\Delta G_{\\mathrm{ads}}$，用于在计算氢电极 (CHE) 约定或类似的分子参考标准下，在催化剂表面上形成吸附物种。所有量都必须以与热力学定义内部一致的方式进行处理。您的程序必须根据提供的输入计算 $\\Delta G_{\\mathrm{ads}}$，并返回所提供测试套件的结果。\n\n基本原理和定义：\n- 使用平衡热力学中吉布斯自由能 $G$ 的定义，$G = U + pV - TS$，其中 $U$ 是内能，$p$ 是压力，$V$ 是体积，$T$ 是绝对温度，$S$ 是熵。\n- 对于固体表面和吸附质，由于固体的不可压缩性，假定 $pV$ 项可以忽略不计，并用 DFT 电子能量加上谐振动零点能来近似 $U$。\n- 对于用作参考的气相分子，用 DFT 电子能量加上零点能再减去 $T$ 乘以熵来近似温度 $T$ 下的化学势，同样忽略 $pV$ 项，以与标准条件下典型的凝聚相计算实践保持一致。\n- 强制执行化学计量一致性：当将吸附态与洁净表面加上具有有理化学计量系数的气相分子库进行比较时，吸附过程必须保持原子守恒。\n\n计算要求：\n- 对于每个测试用例，计算 $\\Delta G_{\\mathrm{ads}}$，即吸附态与洁净板坯加上由指定气相分子（具有给定化学计量系数）组成的库之间的吉布斯自由能差。计算中需包含吸附态和气相参考物的 DFT 总能量、零点能和熵的贡献。\n- 所有能量必须以 $\\text{eV}$ 为单位处理，所有熵以 $\\text{eV}/\\text{K}$ 为单位，温度以 $\\text{K}$ 为单位。将每个最终结果以 $\\text{eV}$ 为单位表示，并四舍五入到六位小数的浮点数。\n\n测试套件：\n您的程序必须评估以下五个测试用例，每个用例由一个元组定义，其中包含洁净板坯的 DFT 能量 $E_{\\mathrm{slab}}$、带有吸附质的板坯的 DFT 能量 $E_{\\mathrm{slab+X}}$、吸附质的零点能 $E_{\\mathrm{ZPE}}^{\\mathrm{ads}}$、吸附质的熵 $S^{\\mathrm{ads}}$、温度 $T$ 以及一个参考气相分子列表，每个分子都有化学计量系数 $\\nu_i$、DFT 能量 $E_i^{\\mathrm{gas}}$、零点能 $E_{\\mathrm{ZPE},i}^{\\mathrm{gas}}$ 和熵 $S_i^{\\mathrm{gas}}$。所有量均为数值，必须完全按照给定的值使用。\n\n- 用例 A（氢吸附，参考半个氢分子）：\n    - $E_{\\mathrm{slab}} = -100.000\\,\\text{eV}$\n    - $E_{\\mathrm{slab+X}} = -103.435\\,\\text{eV}$\n    - $E_{\\mathrm{ZPE}}^{\\mathrm{ads}} = 0.160\\,\\text{eV}$\n    - $S^{\\mathrm{ads}} = 0.00030\\,\\text{eV}/\\text{K}$\n    - $T = 298\\,\\text{K}$\n    - 参考物：一个分子，其 $\\nu_{\\mathrm{H_2}} = 0.5$，$E_{\\mathrm{H_2}} = -6.770\\,\\text{eV}$，$E_{\\mathrm{ZPE}}^{\\mathrm{H_2}} = 0.270\\,\\text{eV}$，$S^{\\mathrm{H_2}} = 0.00135\\,\\text{eV}/\\text{K}$。\n\n- 用例 B（氧吸附，参考半个氧分子）：\n    - $E_{\\mathrm{slab}} = -50.000\\,\\text{eV}$\n    - $E_{\\mathrm{slab+X}} = -55.930\\,\\text{eV}$\n    - $E_{\\mathrm{ZPE}}^{\\mathrm{ads}} = 0.070\\,\\text{eV}$\n    - $S^{\\mathrm{ads}} = 0.00020\\,\\text{eV}/\\text{K}$\n    - $T = 298\\,\\text{K}$\n    - 参考物：一个分子，其 $\\nu_{\\mathrm{O_2}} = 0.5$，$E_{\\mathrm{O_2}} = -9.860\\,\\text{eV}$，$E_{\\mathrm{ZPE}}^{\\mathrm{O_2}} = 0.100\\,\\text{eV}$，$S^{\\mathrm{O_2}} = 0.002124\\,\\text{eV}/\\text{K}$。\n\n- 用例 C（羟基吸附，参考半个氢分子加半个氧分子）：\n    - $E_{\\mathrm{slab}} = -75.000\\,\\text{eV}$\n    - $E_{\\mathrm{slab+X}} = -83.515\\,\\text{eV}$\n    - $E_{\\mathrm{ZPE}}^{\\mathrm{ads}} = 0.350\\,\\text{eV}$\n    - $S^{\\mathrm{ads}} = 0.00040\\,\\text{eV}/\\text{K}$\n    - $T = 298\\,\\text{K}$\n    - 参考物：两个分子：\n        - $\\nu_{\\mathrm{H_2}} = 0.5$，$E_{\\mathrm{H_2}} = -6.770\\,\\text{eV}$，$E_{\\mathrm{ZPE}}^{\\mathrm{H_2}} = 0.270\\,\\text{eV}$，$S^{\\mathrm{H_2}} = 0.00135\\,\\text{eV}/\\text{K}$，\n        - $\\nu_{\\mathrm{O_2}} = 0.5$，$E_{\\mathrm{O_2}} = -9.860\\,\\text{eV}$，$E_{\\mathrm{ZPE}}^{\\mathrm{O_2}} = 0.100\\,\\text{eV}$，$S^{\\mathrm{O_2}} = 0.002124\\,\\text{eV}/\\text{K}$。\n\n- 用例 D（零温度下的氢吸附，边界情况）：\n    - $E_{\\mathrm{slab}} = -100.000\\,\\text{eV}$\n    - $E_{\\mathrm{slab+X}} = -103.435\\,\\text{eV}$\n    - $E_{\\mathrm{ZPE}}^{\\mathrm{ads}} = 0.160\\,\\text{eV}$\n    - $S^{\\mathrm{ads}} = 0.00030\\,\\text{eV}/\\text{K}$\n    - $T = 0\\,\\text{K}$\n    - 参考物：一个分子，其 $\\nu_{\\mathrm{H_2}} = 0.5$，$E_{\\mathrm{H_2}} = -6.770\\,\\text{eV}$，$E_{\\mathrm{ZPE}}^{\\mathrm{H_2}} = 0.270\\,\\text{eV}$，$S^{\\mathrm{H_2}} = 0.00135\\,\\text{eV}/\\text{K}$。\n\n- 用例 E（氮吸附，参考半个氮分子，吸附质振动贡献可忽略的边缘情况）：\n    - $E_{\\mathrm{slab}} = -120.000\\,\\text{eV}$\n    - $E_{\\mathrm{slab+X}} = -128.400\\,\\text{eV}$\n    - $E_{\\mathrm{ZPE}}^{\\mathrm{ads}} = 0.000\\,\\text{eV}$\n    - $S^{\\mathrm{ads}} = 0.00000\\,\\text{eV}/\\text{K}$\n    - $T = 298\\,\\text{K}$\n    - 参考物：一个分子，其 $\\nu_{\\mathrm{N_2}} = 0.5$，$E_{\\mathrm{N_2}} = -16.000\\,\\text{eV}$，$E_{\\mathrm{ZPE}}^{\\mathrm{N_2}} = 0.140\\,\\text{eV}$，$S^{\\mathrm{N_2}} = 0.00199\\,\\text{eV}/\\text{K}$。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[r_1,r_2,r_3,r_4,r_5]$）。每个 $r_i$ 必须是对应情况下计算出的 $\\Delta G_{\\mathrm{ads}}$，单位为 $\\text{eV}$，四舍五入到六位小数并以浮点数形式打印。不允许有其他输出。",
            "solution": "所述问题在科学上是合理的、提法得当且内部一致的。它为待计算的物理量 $\\Delta G_{\\mathrm{ads}}$ 提供了清晰的定义，并为其计算提供了所有必要的数据和关系。该方法论符合计算催化领域的既定实践，特别是使用经零点振动能 (ZPE) 和熵效应校正的密度泛函理论 (DFT) 总能量来近似吉布斯自由能。因此，该问题被认为是有效的，并将提供一个解决方案。\n\n目标是计算物种 $\\mathrm{X}$ 在催化剂表面上的吸附吉布斯自由能 $\\Delta G_{\\mathrm{ads}}$。这个量是预测催化活性的一个关键描述符，构成了火山图的基础。该计算遵循反应吉布斯自由能变的基本定义，即产物的吉布斯自由能减去反应物的吉布斯自由能。\n\n吸附反应表示为：\n$$ \\text{Slab} + \\sum_i \\nu_i \\text{Ref}_i \\rightleftharpoons \\mathrm{Slab + X} $$\n这里，`Slab` 代表洁净的催化剂表面，$\\mathrm{Slab+X}$ 是带有吸附物种 $\\mathrm{X}$ 的表面，而 $\\text{Ref}_i$ 是形成 $\\mathrm{X}$ 所需的、具有相应化学计量系数 $\\nu_i$ 的气相参考分子。\n\n此过程的吉布斯自由能变为：\n$$ \\Delta G_{\\mathrm{ads}} = G_{\\mathrm{Slab+X}} - \\left( G_{\\mathrm{Slab}} + \\sum_i \\nu_i G_i^{\\mathrm{gas}} \\right) $$\n这可以重新排列为：\n$$ \\Delta G_{\\mathrm{ads}} = (G_{\\mathrm{Slab+X}} - G_{\\mathrm{Slab}}) - \\sum_i \\nu_i G_i^{\\mathrm{gas}} $$\n\n问题指明了如何近似计算每个组分的吉布斯自由能 $G$。根据平衡热力学，$G = U + pV - TS$，其中 $U$ 是内能，$p$ 是压力，$V$ 是体积，$T$ 是温度，$S$ 是熵。对于标准条件下的凝聚相体系（固体和吸附质），$pV$ 项可以忽略不计。内能 $U$ 近似为 DFT 的电子能量 $E_{\\mathrm{DFT}}$ 和零点振动能 $E_{\\mathrm{ZPE}}$ 之和。\n因此，对于表面，吸附时的吉布斯自由能变为：\n$$ \\Delta G_{\\mathrm{surface}} = G_{\\mathrm{Slab+X}} - G_{\\mathrm{Slab}} \\approx [ (E_{\\mathrm{Slab+X}}^{\\mathrm{DFT}} + E_{\\mathrm{ZPE}}^{\\mathrm{Slab+X}}) - TS^{\\mathrm{Slab+X}} ] - [ (E_{\\mathrm{Slab}}^{\\mathrm{DFT}} + E_{\\mathrm{ZPE}}^{\\mathrm{Slab}}) - TS^{\\mathrm{Slab}} ] $$\n通过假设板坯本身的振动模式在很大程度上不受吸附影响，ZPE 和熵的变化仅归因于吸附质：$E_{\\mathrm{ZPE}}^{\\mathrm{Slab+X}} - E_{\\mathrm{ZPE}}^{\\mathrm{Slab}} \\approx E_{\\mathrm{ZPE}}^{\\mathrm{ads}}$ 和 $S^{\\mathrm{Slab+X}} - S^{\\mathrm{Slab}} \\approx S^{\\mathrm{ads}}$。这导致了简化的表达式：\n$$ \\Delta G_{\\mathrm{surface}} = (E_{\\mathrm{Slab+X}}^{\\mathrm{DFT}} - E_{\\mathrm{Slab}}^{\\mathrm{DFT}}) + E_{\\mathrm{ZPE}}^{\\mathrm{ads}} - T S^{\\mathrm{ads}} $$\n\n对于气相参考分子，化学势（每个分子的吉布斯自由能）也作类似近似，忽略 $pV$ 项以与固体的处理方式保持一致。\n$$ G_i^{\\mathrm{gas}} \\approx E_{i}^{\\mathrm{gas, DFT}} + E_{\\mathrm{ZPE}, i}^{\\mathrm{gas}} - T S_{i}^{\\mathrm{gas}} $$\n\n结合这些表达式，得到吸附吉布斯自由能描述符的最终计算方程：\n$$ \\Delta G_{\\mathrm{ads}} = (E_{\\mathrm{Slab+X}}^{\\mathrm{DFT}} - E_{\\mathrm{Slab}}^{\\mathrm{DFT}} + E_{\\mathrm{ZPE}}^{\\mathrm{ads}} - T S^{\\mathrm{ads}}) - \\sum_i \\nu_i (E_{i}^{\\mathrm{gas, DFT}} + E_{\\mathrm{ZPE}, i}^{\\mathrm{gas}} - T S_{i}^{\\mathrm{gas}}) $$\n一个特殊情况发生在温度 $T=0\\,\\text{K}$ 时，此时所有熵的贡献（$TS$）都消失了，吉布斯自由能等同于 $0\\,\\text{K}$ 时的焓，$H(0) = E_{\\mathrm{DFT}} + E_{\\mathrm{ZPE}}$。\n\n提供的 Python 代码实现了这个公式。定义了一个主函数来遍历每个测试用例。对于每个用例，它首先计算 $\\Delta G_{\\mathrm{surface}}$ 项。然后，它通过对每个指定参考分子的贡献求和，计算气相分子库的总吉布斯自由能 $\\sum_i \\nu_i G_i^{\\mathrm{gas}}$。最后，它从表面的自由能变中减去库的自由能，得到 $\\Delta G_{\\mathrm{ads}}$。结果按要求四舍五入到六位小数。每个测试用例的数据结构化后可直接传递给计算函数，从而确保系统性且无误的评估。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the adsorption Gibbs free energy for a series of test cases\n    based on DFT energies and thermodynamic corrections.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Structure for each case:\n    # (E_slab, E_slab+X, E_ZPE_ads, S_ads, T, list_of_references)\n    # Structure for each reference:\n    # (nu, E_gas, E_ZPE_gas, S_gas)\n    test_cases = [\n        # Case A (Hydrogen adsorption)\n        (-100.000, -103.435, 0.160, 0.00030, 298, [\n            (0.5, -6.770, 0.270, 0.00135)\n        ]),\n        # Case B (Oxygen adsorption)\n        (-50.000, -55.930, 0.070, 0.00020, 298, [\n            (0.5, -9.860, 0.100, 0.002124)\n        ]),\n        # Case C (Hydroxyl adsorption)\n        (-75.000, -83.515, 0.350, 0.00040, 298, [\n            (0.5, -6.770, 0.270, 0.00135),\n            (0.5, -9.860, 0.100, 0.002124)\n        ]),\n        # Case D (Hydrogen adsorption at T=0)\n        (-100.000, -103.435, 0.160, 0.00030, 0, [\n            (0.5, -6.770, 0.270, 0.00135)\n        ]),\n        # Case E (Nitrogen adsorption)\n        (-120.000, -128.400, 0.000, 0.00000, 298, [\n            (0.5, -16.000, 0.140, 0.00199)\n        ])\n    ]\n\n    def calculate_delta_g_ads(case_data):\n        \"\"\"\n        Calculates the adsorption Gibbs free energy for a single case.\n        \n        The formula used is:\n        ΔG_ads = (G_slab+X - G_slab) - Σ(ν_i * G_i^gas)\n        where:\n        G_slab+X - G_slab ≈ (E_slab+X - E_slab) + E_ZPE_ads - T*S_ads\n        G_i^gas ≈ E_i^gas + E_ZPE_i^gas - T*S_i^gas\n        \"\"\"\n        E_slab, E_slab_plus_X, E_zpe_ads, S_ads, T, refs = case_data\n\n        # Calculate the Gibbs free energy change of the surface upon adsorption.\n        delta_G_surface = (E_slab_plus_X - E_slab) + E_zpe_ads - T * S_ads\n\n        # Calculate the total Gibbs free energy of the gas-phase reference reservoir.\n        G_reservoir = 0.0\n        for ref in refs:\n            nu, E_gas, E_zpe_gas, S_gas = ref\n            G_gas = E_gas + E_zpe_gas - T * S_gas\n            G_reservoir += nu * G_gas\n        \n        # The final adsorption Gibbs free energy is the difference.\n        delta_G_ads = delta_G_surface - G_reservoir\n        \n        return delta_G_ads\n\n    results = []\n    for case in test_cases:\n        result = calculate_delta_g_ads(case)\n        results.append(result)\n\n    # Format the results to exactly six decimal places as floats for the final output string.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "获得了描述符之后，我们如何将其与催化活性联系起来并揭示火山型的构效关系？这个练习将引导您使用一个基于Brønsted–Evans–Polanyi（BEP）关系的微观动力学模型，来推导催化转换频率（TOF）与吸附能描述符之间的解析表达式。您不仅将从数学上理解火山曲线的成因，还将通过求解其峰值来确定最佳催化剂的理论描述符值，并探究温度等操作条件如何影响火山图的形状和顶点位置 。",
            "id": "4240519",
            "problem": "考虑构建一个基于第一性原理的最小微观动力学模型的电化学表面反应的活性-描述符火山图。设描述符为单个关键吸附中间体 $R^*$ 在催化位点 $*$ 上的标准态吸附自由能 $x$（单位为电子伏特）。假设：\n\n- 吸附平衡 $R + * \\rightleftharpoons R^*$ 遵循朗缪尔等温线 (Langmuir isotherm)，其平衡常数为 $K_{\\mathrm{ads}}(T,x) = \\exp\\!\\big(-x/(k_B T)\\big)$，其中 $T$ 是温度，$k_B$ 是玻尔兹曼常数。\n- 表面反应 $R^* \\rightarrow P + *$ 以阿伦尼乌斯速率常数 (Arrhenius rate constant) $k_{\\mathrm{rxn}}(T,x) = \\nu \\exp\\!\\big(-E_a(x)/(k_B T)\\big)$ 进行，其中 Brønsted–Evans–Polanyi (BEP) 关系给出 $E_a(x) = E_0 + \\alpha\\,\\Delta G_{\\mathrm{rxn}}(x)$，反应自由能为 $\\Delta G_{\\mathrm{rxn}}(x) = c - x$，常数 $c$ 与 $x$ 无关。\n- 每个位点的转换频率 (Turnover frequency, TOF) 为 $r(T,x) = k_{\\mathrm{rxn}}(T,x)\\,\\theta_R(T,x)$，其中 $\\theta_R(T,x) = \\dfrac{a_R K_{\\mathrm{ads}}(T,x)}{1 + a_R K_{\\mathrm{ads}}(T,x)}$，$a_R$ 是界面处反应物的无量纲活性。\n\n这里，$\\nu$ 是与温度无关的指前因子，$E_0$ 是 BEP 截距，$\\alpha \\in (0,1)$ 是 BEP 斜率参数。Brønsted–Evans–Polanyi (BEP) 关系是连接相关反应的活化能垒与反应自由能的经验线性关系。\n\n仅使用这些基础和核心定义，推导 $r(T,x)$ 的解析表达式，然后确定在固定温度 $T$ 下使 $r(T,x)$ 最大化的描述符 $x^{*}(T)$ 和相应的峰值活性 $r_{\\max}(T)$。在两个温度 $T_1 = 298\\,\\mathrm{K}$ 和 $T_2 = 350\\,\\mathrm{K}$ 下计算这些量。使用常数 $\\nu = 1.0 \\times 10^{13}\\,\\mathrm{s}^{-1}$，$E_0 = 0.50\\,\\mathrm{eV}$，$\\alpha = 0.40$，$c = 0.20\\,\\mathrm{eV}$，$a_R = 1.0 \\times 10^{-3}$，以及 $k_B = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV}\\,\\mathrm{K}^{-1}$。\n\n报告最优描述符的变化量 $\\Delta x^{*} = x^{*}(T_2) - x^{*}(T_1)$（单位为 $\\mathrm{eV}$）和峰值活性的变化（以比率 $\\rho = r_{\\max}(T_2)/r_{\\max}(T_1)$ 的小数形式表示）。将两个结果都四舍五入到四位有效数字。将最终答案表示为行矩阵 $\\big[\\Delta x^{*},\\,\\rho\\big]$。",
            "solution": "首先对问题陈述进行验证。\n\n### 第一步：提取已知条件\n- **描述符**：中间体 $R^*$ 的标准态吸附自由能 $x$。\n- **吸附平衡**：$R + * \\rightleftharpoons R^*$。\n- **表面覆盖度**：朗缪尔等温线 (Langmuir isotherm)，$\\theta_R(T,x) = \\dfrac{a_R K_{\\mathrm{ads}}(T,x)}{1 + a_R K_{\\mathrm{ads}}(T,x)}$。\n- **平衡常数**：$K_{\\mathrm{ads}}(T,x) = \\exp(-x/(k_B T))$。\n- **表面反应**：$R^* \\rightarrow P + *$。\n- **速率常数**：$k_{\\mathrm{rxn}}(T,x) = \\nu \\exp(-E_a(x)/(k_B T))$。\n- **BEP 关系**：$E_a(x) = E_0 + \\alpha\\,\\Delta G_{\\mathrm{rxn}}(x)$，其中 $\\alpha \\in (0,1)$。\n- **反应自由能**：$\\Delta G_{\\mathrm{rxn}}(x) = c - x$。\n- **转换频率 (TOF)**：$r(T,x) = k_{\\mathrm{rxn}}(T,x)\\,\\theta_R(T,x)$。\n- **常数**:\n  - 指前因子：$\\nu = 1.0 \\times 10^{13}\\,\\mathrm{s}^{-1}$。\n  - BEP 截距：$E_0 = 0.50\\,\\mathrm{eV}$。\n  - BEP 斜率：$\\alpha = 0.40$。\n  - 自由能常数：$c = 0.20\\,\\mathrm{eV}$。\n  - 反应物活性：$a_R = 1.0 \\times 10^{-3}$。\n  - 玻尔兹曼常数：$k_B = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV}\\,\\mathrm{K}^{-1}$。\n- **温度**：$T_1 = 298\\,\\mathrm{K}$ 和 $T_2 = 350\\,\\mathrm{K}$。\n- **目标**:\n  1. 推导 $r(T,x)$ 的解析表达式。\n  2. 确定最优描述符 $x^{*}(T)$ 和峰值活性 $r_{\\max}(T)$。\n  3. 在 $T_1$ 和 $T_2$ 下计算 $x^*(T)$ 和 $r_{\\max}(T)$。\n  4. 计算变化量 $\\Delta x^{*} = x^{*}(T_2) - x^{*}(T_1)$ 和比率 $\\rho = r_{\\max}(T_2)/r_{\\max}(T_1)$。\n  5. 以四位有效数字报告 $\\big[\\Delta x^{*},\\,\\rho\\big]$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题在科学上基于化学动力学、热力学和表面科学的原理，特别是计算催化领域。所提供的框架（朗缪尔等温线、阿伦尼乌斯动力学、BEP 关系）构成了构建活性火山图的标准最小模型，这是非均相催化中一个被称为 Sabatier 原理的基石概念。该问题是适定的，提供了所有必要的参数和明确的目标：找到一个明确定义的函数的最大值。所提供的常数对于一个模型体系是物理上合理的。语言客观且无歧义。该问题不违反任何无效性标准。\n\n### 第三步：结论与行动\n问题有效。将推导解答。\n\n首先，我们推导转换频率 $r(T,x)$ 的解析表达式。我们从组合给定关系开始。活化能 $E_a(x)$ 由 BEP 关系给出：\n$E_a(x) = E_0 + \\alpha\\,\\Delta G_{\\mathrm{rxn}}(x) = E_0 + \\alpha(c - x)$。\n\n于是速率常数 $k_{\\mathrm{rxn}}(T,x)$ 为：\n$k_{\\mathrm{rxn}}(T,x) = \\nu \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T}\\right) \\exp\\left(\\frac{\\alpha x}{k_B T}\\right)$。\n\n代入 $K_{\\mathrm{ads}}(T,x)$，表面覆盖度 $\\theta_R(T,x)$ 为：\n$\\theta_R(T,x) = \\frac{a_R \\exp(-x/(k_B T))}{1 + a_R \\exp(-x/(k_B T))}$。\n\n因此，转换频率 $r(T,x) = k_{\\mathrm{rxn}}(T,x)\\,\\theta_R(T,x)$ 为：\n$r(T,x) = \\left[ \\nu \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T}\\right) \\exp\\left(\\frac{\\alpha x}{k_B T}\\right) \\right] \\left[ \\frac{a_R \\exp(-x/(k_B T))}{1 + a_R \\exp(-x/(k_B T))} \\right]$。\n合并包含 $x$ 的指数项：\n$r(T,x) = \\nu a_R \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T}\\right) \\frac{\\exp\\left(\\frac{(\\alpha - 1) x}{k_B T}\\right)}{1 + a_R \\exp\\left(-\\frac{x}{k_B T}\\right)}$。\n这是 TOF 作为描述符 $x$ 和温度 $T$ 的函数的完整解析表达式。\n\n为了找到使 $r(T,x)$ 最大化的最优描述符 $x^*(T)$，我们通过将 $r(T,x)$ 对 $x$ 的导数设为零来求极值。在数学上，最大化 $\\ln(r(T,x))$ 更为方便，其最大值点与原函数相同。\n$\\ln(r(T,x)) = \\ln\\left(\\nu a_R\\right) - \\frac{E_0 + \\alpha c}{k_B T} + \\frac{(\\alpha - 1)x}{k_B T} - \\ln\\left(1 + a_R \\exp\\left(-\\frac{x}{k_B T}\\right)\\right)$。\n\n对 $x$ 求导并令其为 $0$：\n$\\frac{d}{dx}\\ln(r(T,x)) = \\frac{\\alpha - 1}{k_B T} - \\frac{a_R \\exp(-x/(k_B T)) \\cdot (-1/(k_B T))}{1 + a_R \\exp(-x/(k_B T))} = 0$。\n乘以 $k_B T$：\n$\\alpha - 1 + \\frac{a_R \\exp(-x/(k_B T))}{1 + a_R \\exp(-x/(k_B T))} = 0$。\n$1 - \\alpha = \\frac{a_R \\exp(-x/(k_B T))}{1 + a_R \\exp(-x/(k_B T))}$。\n令 $Y = a_R \\exp(-x/(k_B T))$。方程为 $1 - \\alpha = \\frac{Y}{1+Y}$。\n$(1-\\alpha)(1+Y) = Y \\implies 1-\\alpha + (1-\\alpha)Y = Y \\implies 1-\\alpha = Y - (1-\\alpha)Y = Y(1-(1-\\alpha)) = Y\\alpha$。\n所以，$Y = \\frac{1-\\alpha}{\\alpha}$。将最优描述符值 $x^*(T)$ 代回 $Y$ 的表达式：\n$a_R \\exp\\left(-\\frac{x^*(T)}{k_B T}\\right) = \\frac{1-\\alpha}{\\alpha}$。\n解出 $x^*(T)$：\n$\\exp\\left(-\\frac{x^*(T)}{k_B T}\\right) = \\frac{1-\\alpha}{a_R \\alpha}$。\n$-\\frac{x^*(T)}{k_B T} = \\ln\\left(\\frac{1-\\alpha}{a_R \\alpha}\\right)$。\n$x^*(T) = -k_B T \\ln\\left(\\frac{1-\\alpha}{a_R \\alpha}\\right)$。\n\n接下来，我们推导峰值活性 $r_{\\max}(T) = r(T, x^*(T))$ 的表达式。我们使用最优条件 $a_R \\exp(-x^*(T)/(k_B T)) = \\frac{1-\\alpha}{\\alpha}$。\n在 $x=x^*$ 时，$r(T,x)$ 的分母变为 $1 + \\frac{1-\\alpha}{\\alpha} = \\frac{\\alpha + 1 - \\alpha}{\\alpha} = \\frac{1}{\\alpha}$。\n从最优条件，我们还有 $\\exp\\left(\\frac{x^*(T)}{k_B T}\\right) = \\left(\\frac{1-\\alpha}{a_R\\alpha}\\right)^{-1} = \\frac{a_R\\alpha}{1-\\alpha}$。\n$r(T,x)$ 分子中的 $\\exp\\left(\\frac{(\\alpha - 1) x^*(T)}{k_B T}\\right)$ 项是 $\\left(\\exp\\left(\\frac{x^*(T)}{k_B T}\\right)\\right)^{\\alpha-1} = \\left(\\frac{a_R\\alpha}{1-\\alpha}\\right)^{\\alpha-1} = \\left(\\frac{1-\\alpha}{a_R\\alpha}\\right)^{1-\\alpha}$。\n将这些代入 $r(T,x)$ 的表达式中：\n$r_{\\max}(T) = \\nu a_R \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T}\\right) \\frac{\\left(\\frac{1-\\alpha}{a_R\\alpha}\\right)^{1-\\alpha}}{1/\\alpha}$。\n$r_{\\max}(T) = \\nu a_R \\alpha \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T}\\right) (1-\\alpha)^{1-\\alpha} (a_R\\alpha)^{-(1-\\alpha)}$。\n$r_{\\max}(T) = \\nu \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T}\\right) a_R \\cdot a_R^{\\alpha-1} \\cdot \\alpha \\cdot \\alpha^{\\alpha-1} \\cdot (1-\\alpha)^{1-\\alpha}$。\n$r_{\\max}(T) = \\nu \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T}\\right) a_R^{\\alpha} \\alpha^{\\alpha} (1-\\alpha)^{1-\\alpha}$。\n\n现在，我们进行数值计算。\n给定常数：$\\alpha = 0.40$，$a_R = 1.0 \\times 10^{-3}$，$c = 0.20\\,\\mathrm{eV}$，$E_0 = 0.50\\,\\mathrm{eV}$，$k_B=8.617333262 \\times 10^{-5}\\,\\mathrm{eV}\\,\\mathrm{K}^{-1}$。\n首先，计算 $x^*(T)$ 对数中的项：\n$\\frac{1-\\alpha}{a_R \\alpha} = \\frac{1 - 0.40}{(1.0 \\times 10^{-3})(0.40)} = \\frac{0.60}{0.0004} = 1500$。\n所以，$x^*(T) = -k_B T \\ln(1500)$。\n$\\ln(1500) \\approx 7.313220387$。\n\n对于 $T_1 = 298\\,\\mathrm{K}$：\n$k_B T_1 = (8.617333262 \\times 10^{-5})(298)\\,\\mathrm{eV} \\approx 0.025679653\\,\\mathrm{eV}$。\n$x^*(T_1) = - (0.025679653\\,\\mathrm{eV}) \\ln(1500) \\approx -0.1878076\\,\\mathrm{eV}$。\n\n对于 $T_2 = 350\\,\\mathrm{K}$：\n$k_B T_2 = (8.617333262 \\times 10^{-5})(350)\\,\\mathrm{eV} \\approx 0.030160666\\,\\mathrm{eV}$。\n$x^*(T_2) = - (0.030160666\\,\\mathrm{eV}) \\ln(1500) \\approx -0.2205779\\,\\mathrm{eV}$。\n\n最优描述符的变化量为：\n$\\Delta x^{*} = x^{*}(T_2) - x^{*}(T_1) \\approx -0.2205779 - (-0.1878076) = -0.0327703\\,\\mathrm{eV}$。\n保留四位有效数字，$\\Delta x^{*} = -0.03277\\,\\mathrm{eV}$。\n\n为了求得比率 $\\rho = r_{\\max}(T_2)/r_{\\max}(T_1)$，我们可以使用推导出的 $r_{\\max}(T)$ 表达式。与 $T$ 无关的项会消掉：\n$\\rho = \\frac{\\nu \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T_2}\\right) a_R^{\\alpha} \\alpha^{\\alpha} (1-\\alpha)^{1-\\alpha}}{\\nu \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T_1}\\right) a_R^{\\alpha} \\alpha^{\\alpha} (1-\\alpha)^{1-\\alpha}} = \\frac{\\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T_2}\\right)}{\\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T_1}\\right)}$。\n$\\rho = \\exp\\left(-\\frac{E_0 + \\alpha c}{k_B T_2} + \\frac{E_0 + \\alpha c}{k_B T_1}\\right) = \\exp\\left(\\frac{E_0 + \\alpha c}{k_B} \\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right)\\right)$。\n能量项为 $E_0 + \\alpha c = 0.50\\,\\mathrm{eV} + (0.40)(0.20\\,\\mathrm{eV}) = 0.58\\,\\mathrm{eV}$。\n指数为：\n$\\frac{0.58\\,\\mathrm{eV}}{8.617333262 \\times 10^{-5}\\,\\mathrm{eV}\\,\\mathrm{K}^{-1}} \\left(\\frac{1}{298\\,\\mathrm{K}} - \\frac{1}{350\\,\\mathrm{K}}\\right) \\approx 6731.1812 \\left(\\frac{350-298}{298 \\times 350}\\right) = 6731.1812 \\left(\\frac{52}{104300}\\right) \\approx 3.355931$。\n$\\rho = \\exp(3.355931) \\approx 28.67133$。\n保留四位有效数字，$\\rho = 28.67$。\n\n最终答案由最优描述符的变化量和峰值活性的比率组成。\n$\\Delta x^{*} \\approx -0.03277$\n$\\rho \\approx 28.67$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.03277  28.67\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在计算催化中，我们得到的描述符值本质上是对真实物理量的近似，其精度受到计算参数（如板层厚度、真空层大小和$k$点网格）的限制。本练习将引导您直面这一计算科学的核心问题，通过建立一个模型来量化这些有限尺寸和采样效应引入的数值误差。您将学习如何将描述符的数值不确定性传播到最终的催化活性预测中，从而评估活性火山图预测的稳健性，这对于严谨的计算研究至关重要 。",
            "id": "4240510",
            "problem": "考虑在计算电化学中构建活性火山图，其中单个热力学描述符通过 Brønsted–Evans–Polanyi (BEP) 型关系控制表观活化能垒。该描述符，例如通过密度泛函理论 (DFT) 计算的吸附能，会受到由有限平板厚度、有限真空层分离和有限倒易空间采样 (Monkhorst–Pack 网格) 引起的系统数值误差的影响。这些数值误差使描述符偏离其无限尺寸、无限真空和无限采样极限，从而给火山图预测的活性带来不确定性。您的任务是以数学上精确的方式将这些效应形式化，并将由此产生的计算实现为一个完整、可运行的程序。\n\n您必须从以下基本原理出发：\n- 用于速率过程的阿伦尼乌斯定律，表示为 $j = j_{0}\\,\\exp\\!\\left(-\\Delta G^{\\ddagger}/(k_{\\mathrm{B}}T)\\right)$，其中 $j$ 是电流密度，单位为 $\\text{A}\\,\\text{m}^{-2}$；$j_{0}$ 是指前因子，单位为 $\\text{A}\\,\\text{m}^{-2}$；$\\Delta G^{\\ddagger}$ 是表观活化能垒，单位为 $\\text{eV}$；$k_{\\mathrm{B}}$ 是玻尔兹曼常数，单位为 $\\text{eV}\\,\\text{K}^{-1}$；$T$ 是绝对温度，单位为 $\\text{K}$。\n- 能垒对描述符的分段线性 Brønsted–Evans–Polanyi (BEP) 依赖关系，相对于一个最佳值。这样，在火山图的强吸附侧和弱吸附侧，能垒随偏离最佳值的程度线性增加，且分支的斜率不同。\n- 有限尺寸和采样误差在无限平板厚度、无限真空层分离和无限 $k$ 点采样的极限下会单调消失，这与平板诱导和真空诱导相互作用的指数屏蔽以及金属体系中 $k$ 点数量的反比收敛相一致。\n\n将无限极限描述符值定义为 $E_{\\infty}$（单位 $\\text{eV}$），并将计算出的描述符 $E$ 建模为 $E_{\\infty}$ 与三个独立误差贡献之和：\n- 随层数 $N_{\\mathrm{layers}}$ 指数衰减的平板厚度误差。\n- 随真空尺寸 $V_{\\mathrm{vac}}$（以 $\\text{\\AA}$ 为单位）指数衰减的真空层分离误差。\n- 随总 $k$ 点数 $N_{k}$ 反比衰减的倒易空间采样误差。\n\n您必须在程序中实现以下物理上一致的参数化：\n- 无限极限描述符 $E_{\\infty} = -0.50\\,\\text{eV}$。\n- 平板厚度误差振幅 $A_{\\mathrm{layers}} = 0.10\\,\\text{eV}$ 和衰减常数 $\\tau_{\\mathrm{layers}} = 3.00$ 层。\n- 真空层分离误差振幅 $A_{\\mathrm{vac}} = 0.05\\,\\text{eV}$ 和衰减常数 $\\lambda_{\\mathrm{vac}} = 8.00\\,\\text{\\AA}$。\n- $k$ 点误差振幅 $A_{k} = 0.08\\,\\text{eV}$ 和指数 $p_{k} = 1.00$。\n- 火山图最佳描述符 $E_{\\mathrm{opt}} = -0.55\\,\\text{eV}$。\n- 基线能垒 $G_{0} = 0.40\\,\\text{eV}$。\n- BEP 斜率 $m_{\\mathrm{L}} = 0.70$（强吸附分支）和 $m_{\\mathrm{R}} = 0.35$（弱吸附分支）。\n- 指前因子 $j_{0} = 1.00\\times 10^{2}\\,\\text{A}\\,\\text{m}^{-2}$。\n- 温度 $T = 298.00\\,\\text{K}$，玻尔兹曼常数 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\text{eV}\\,\\text{K}^{-1}$。\n\n令总 $k$ 点数为 $N_{k} = N_{x}N_{y}N_{z}$，其中 $(N_{x},N_{y},N_{z})$ 是定义 Monkhorst–Pack 网格的整数。\n\n对于每个测试用例，计算：\n- 描述符估计值 $E$，单位为 $\\text{eV}$。\n- 绝对描述符误差 $\\delta E = |E - E_{\\infty}|$，单位为 $\\text{eV}$。\n- 根据阿伦尼乌斯定律和 BEP 控制的能垒预测的电流密度 $j$，单位为 $\\text{A}\\,\\text{m}^{-2}$。\n- 仅由数值描述符不确定性 $\\delta E$（通过 BEP 关系在适当的火山图分支上传播）引起的下界 $j_{\\min}$ 和上界 $j_{\\max}$，单位为 $\\text{A}\\,\\text{m}^{-2}$。\n\n所有能量均以 $\\text{eV}$ 表示，所有电流密度均以 $\\text{A}\\,\\text{m}^{-2}$ 表示。不使用角度。最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按 $[E,\\delta E,j,j_{\\min},j_{\\max}]$ 的顺序附加五个浮点数。将所有测试用例的结果连接成一个扁平列表。不得打印任何额外文本。\n\n使用以下测试套件，该套件探测了欠收敛、中等收敛和良好收敛的场景，包括边界情况：\n- 案例 1：$N_{\\mathrm{layers}} = 3$，$V_{\\mathrm{vac}} = 10.0\\,\\text{\\AA}$，$(N_{x},N_{y},N_{z}) = (3,3,1)$。\n- 案例 2：$N_{\\mathrm{layers}} = 6$，$V_{\\mathrm{vac}} = 15.0\\,\\text{\\AA}$，$(N_{x},N_{y},N_{z}) = (6,6,1)$。\n- 案例 3：$N_{\\mathrm{layers}} = 10$，$V_{\\mathrm{vac}} = 20.0\\,\\text{\\AA}$，$(N_{x},N_{y},N_{z}) = (8,8,1)$。\n- 案例 4：$N_{\\mathrm{layers}} = 2$，$V_{\\mathrm{vac}} = 6.0\\,\\text{\\AA}$，$(N_{x},N_{y},N_{z}) = (2,2,1)$。\n- 案例 5：$N_{\\mathrm{layers}} = 12$，$V_{\\mathrm{vac}} = 25.0\\,\\text{\\AA}$，$(N_{x},N_{y},N_{z}) = (12,6,1)$。\n\n您的程序应生成单行输出，其中包含按上述规定跨越五个测试用例排序的结果，格式为方括号括起来的逗号分隔列表。",
            "solution": "该问题要求计算电化学活性及其相关的不确定性，这些不确定性源于热力学描述符计算中的数值误差。该解决方案的制定首先为描述符误差构建一个精确的数学模型，然后通过 Brønsted–Evans–Polanyi (BEP) 关系定义描述符与催化活性之间的关系，最后通过该模型传播描述符的不确定性，以确定预测活性的界限。\n\n分析过程分为四个主要步骤：\n$1$. 通过对密度泛函理论 (DFT) 计算中有限尺寸和有限采样效应引起的系统误差进行建模，形式化计算出的描述符 $E$。\n$2$. 形式化一个 BEP 型火山图，该图将描述符 $E$ 与电化学过程的活化能垒 $\\Delta G^{\\ddagger}$ 联系起来。\n$3$. 使用阿伦尼乌斯定律计算电流密度 $j$。\n$4$. 传播描述符不确定性 $\\delta E$，以确定电流密度的下界和上界 $j_{\\min}$ 和 $j_{\\max}$。\n\n计算出的描述符 $E$ 被建模为其在无限极限下的值 $E_{\\infty}$ 与三个独立的、正值的误差贡献之和：平板厚度误差、真空层分离误差和倒易空间采样误差。$E$ 的数学形式为：\n$$E(N_{\\mathrm{layers}}, V_{\\mathrm{vac}}, N_k) = E_{\\infty} + \\Delta E_{\\mathrm{layers}} + \\Delta E_{\\mathrm{vac}} + \\Delta E_{k}$$\n其中误差项由以下公式给出：\n- 平板厚度误差：$\\Delta E_{\\mathrm{layers}} = A_{\\mathrm{layers}} \\exp(-N_{\\mathrm{layers}} / \\tau_{\\mathrm{layers}})$\n- 真空层分离误差：$\\Delta E_{\\mathrm{vac}} = A_{\\mathrm{vac}} \\exp(-V_{\\mathrm{vac}} / \\lambda_{\\mathrm{vac}})$\n- 倒易空间采样误差：$\\Delta E_{k} = A_{k} / N_{k}^{p_k}$\n\n总 $k$ 点数 $N_k$ 是 Monkhorst–Pack 网格维度的乘积，$N_k = N_x N_y N_z$。鉴于所有误差振幅 ($A$) 和模拟参数 ($N_{\\mathrm{layers}}$, $V_{\\mathrm{vac}}$, $N_k$) 均为正值，计算出的描述符 $E$ 将始终大于无限极限描述符 $E_{\\infty}$。因此，绝对描述符误差为：\n$$\\delta E = |E - E_{\\infty}| = E - E_{\\infty} = \\Delta E_{\\mathrm{layers}} + \\Delta E_{\\mathrm{vac}} + \\Delta E_{k}$$\n\n活化能垒 $\\Delta G^{\\ddagger}$ 由一个分段线性的 BEP 关系描述，当活性与描述符作图时，形成一个“火山”形状。当描述符为最佳值 $E = E_{\\mathrm{opt}}$ 时，能垒处于最小值 $G_0$。当 $E$ 偏离 $E_{\\mathrm{opt}}$ 时，能垒线性增加。火山的两个分支，分别对应强吸附 ($E \\le E_{\\mathrm{opt}}$) 和弱吸附 ($E > E_{\\mathrm{opt}}$)，其斜率分别为 $m_{\\mathrm{L}}$ 和 $m_{\\mathrm{R}}$。能垒的函数为：\n$$\n\\Delta G^{\\ddagger}(E) =\n\\begin{cases}\nG_{0} - m_{\\mathrm{L}}(E - E_{\\mathrm{opt}})  & \\text{若 } E \\le E_{\\mathrm{opt}} \\\\\nG_{0} + m_{\\mathrm{R}}(E - E_{\\mathrm{opt}})  & \\text{若 } E > E_{\\mathrm{opt}}\n\\end{cases}\n$$\n电化学活性，由电流密度 $j$ 表示，由阿伦尼乌斯定律给出：\n$$j(E) = j_{0}\\,\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}(E)}{k_{\\mathrm{B}}T}\\right)$$\n其中 $j_0$ 是指前因子，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n为了找到电流密度的下界和上界 $j_{\\min}$ 和 $j_{\\max}$，我们必须传播描述符的不确定性 $\\delta E$。这是通过评估描述符不确定性区间内所有可能的电流密度范围来实现的。这样一个区间的标准定义是，以计算值 $E$ 为中心，宽度由误差 $\\delta E$ 决定，即 $[E - \\delta E, E + \\delta E]$。由于我们在此模型中已确定 $E - \\delta E = E_{\\infty}$，该区间为 $[E_{\\infty}, E + \\delta E]$。我们将此区间表示为 $[E_1, E_2]$。\n\n电流密度 $j$ 是活化能垒 $\\Delta G^{\\ddagger}$ 的单调递减函数。因此，$j_{\\min}$ 对应于不确定性区间内的最大可能能垒 $\\Delta G^{\\ddagger}_{\\max}$，而 $j_{\\max}$ 对应于最小可能能垒 $\\Delta G^{\\ddagger}_{\\min}$。\n$$j_{\\min} = j_{0}\\,\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\max}}{k_{\\mathrm{B}}T}\\right) \\quad \\text{和} \\quad j_{\\max} = j_{0}\\,\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\min}}{k_{\\mathrm{B}}T}\\right)$$\n函数 $\\Delta G^{\\ddagger}(E)$ 呈 V 形，其全局最小值 $G_0$ 位于 $E = E_{\\mathrm{opt}}$ 处。在区间 $[E_1, E_2]$ 上 $\\Delta G^{\\ddagger}$ 的最大值必定出现在某个端点上。因此：\n$$\\Delta G^{\\ddagger}_{\\max} = \\max(\\Delta G^{\\ddagger}(E_1), \\Delta G^{\\ddagger}(E_2))$$\n区间上 $\\Delta G^{\\ddagger}$ 的最小值取决于最佳描述符 $E_{\\mathrm{opt}}$ 是否位于该区间内。\n- 如果 $E_1 \\le E_{\\mathrm{opt}} \\le E_2$，则该区间包含火山的峰顶，所以最小能垒为 $\\Delta G^{\\ddagger}_{\\min} = G_0$。\n- 如果 $E_{\\mathrm{opt}}$ 在区间之外，则最小能垒必定出现在离 $E_{\\mathrm{opt}}$ 最近的端点上，这对应于两个端点能垒值中较小的一个：$\\Delta G^{\\ddagger}_{\\min} = \\min(\\Delta G^{\\ddagger}(E_1), \\Delta G^{\\ddagger}(E_2))$。\n\n每个测试用例的计算过程如下：\n$1$. 对于给定的参数集 $\\{N_{\\mathrm{layers}}, V_{\\mathrm{vac}}, N_x, N_y, N_z\\}$，计算总 k 点数 $N_k = N_x N_y N_z$。\n$2$. 通过将 $E_{\\infty}$ 与三个误差项相加来计算描述符 $E$。\n$3$. 计算描述符误差 $\\delta E = E - E_{\\infty}$。\n$4$. 计算中心活化能垒 $\\Delta G^{\\ddagger}(E)$ 和相应的电流密度 $j(E)$。\n$5$. 定义不确定性区间 $[E_1, E_2] = [E - \\delta E, E + \\delta E]$。\n$6$. 计算区间端点处的能垒 $\\Delta G^{\\ddagger}(E_1)$ 和 $\\Delta G^{\\ddagger}(E_2)$。\n$7$. 确定该区间上的极值能垒 $\\Delta G^{\\ddagger}_{\\min}$ 和 $\\Delta G^{\\ddagger}_{\\max}$。\n$8$. 计算电流密度的最终界限 $j_{\\min}$ 和 $j_{\\max}$。\n$9$. 整理五个结果 ($E, \\delta E, j, j_{\\min}, j_{\\max}$) 以用于最终输出。\n这一严谨的程序确保了对预测的催化活性及其因数值伪影引起的不确定性进行物理上和数学上一致的评估。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating electrochemical activity and its uncertainty\n    based on a model of DFT calculation errors.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    # Infinite-limit descriptor\n    E_inf = -0.50  # eV\n    # Slab-thickness error parameters\n    A_layers = 0.10  # eV\n    tau_layers = 3.00  # layers\n    # Vacuum-separation error parameters\n    A_vac = 0.05  # eV\n    lambda_vac = 8.00  # Angstrom\n    # k-point error parameters\n    A_k = 0.08  # eV\n    p_k = 1.00\n    # Volcano plot parameters\n    E_opt = -0.55  # eV\n    G0 = 0.40  # eV\n    m_L = 0.70  # strong-binding slope\n    m_R = 0.35  # weak-binding slope\n    # Arrhenius law parameters\n    j0 = 1.00e2  # A m^-2\n    T = 298.00  # K\n    kB = 8.617333262145e-5  # eV K^-1\n    \n    kBT = kB * T\n\n    test_cases = [\n        # (N_layers, V_vac, (Nx, Ny, Nz))\n        (3, 10.0, (3, 3, 1)),   # Case 1\n        (6, 15.0, (6, 6, 1)),   # Case 2\n        (10, 20.0, (8, 8, 1)),  # Case 3\n        (2, 6.0, (2, 2, 1)),    # Case 4\n        (12, 25.0, (12, 6, 1)), # Case 5\n    ]\n\n    def get_bep_barrier(E: float) -> float:\n        \"\"\"Calculates the activation barrier based on the piecewise BEP relation.\"\"\"\n        if E <= E_opt:\n            # Strong-binding branch (left side)\n            return G0 - m_L * (E - E_opt)\n        else:\n            # Weak-binding branch (right side)\n            return G0 + m_R * (E - E_opt)\n\n    all_results = []\n    for N_layers, V_vac, k_dims in test_cases:\n        Nx, Ny, Nz = k_dims\n        N_k = Nx * Ny * Nz\n\n        # Step 1: Calculate error contributions\n        delta_E_layers = A_layers * np.exp(-N_layers / tau_layers)\n        delta_E_vac = A_vac * np.exp(-V_vac / lambda_vac)\n        delta_E_k = A_k / (N_k**p_k)\n\n        # Step 2: Calculate computed descriptor E and its error delta_E\n        E = E_inf + delta_E_layers + delta_E_vac + delta_E_k\n        delta_E = E - E_inf\n        \n        # Step 3: Calculate current density j for the computed descriptor E\n        G_barrier = get_bep_barrier(E)\n        j = j0 * np.exp(-G_barrier / kBT)\n\n        # Step 4: Propagate uncertainty to find j_min and j_max\n        E1 = E - delta_E\n        E2 = E + delta_E\n\n        # Calculate barriers at the endpoints of the uncertainty interval\n        G_barrier_1 = get_bep_barrier(E1)\n        G_barrier_2 = get_bep_barrier(E2)\n\n        # Determine max and min barrier over the interval [E1, E2]\n        G_barrier_max = max(G_barrier_1, G_barrier_2)\n        \n        if E1 <= E_opt <= E2:\n            G_barrier_min = G0\n        else:\n            G_barrier_min = min(G_barrier_1, G_barrier_2)\n            \n        # Calculate j_min and j_max from extremal barriers\n        j_min = j0 * np.exp(-G_barrier_max / kBT)\n        j_max = j0 * np.exp(-G_barrier_min / kBT)\n\n        # Append results for the current case\n        all_results.extend([E, delta_E, j, j_min, j_max])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{x:.8f}' for x in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}