{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in any Lattice Boltzmann Method (LBM) simulation is to correctly map the physical properties of the system, such as kinematic viscosity $\\nu$ and ionic diffusivity $D$, onto the parameters of the discrete lattice model. This practice guides you through the process of determining the appropriate relaxation times, $\\tau$ for the fluid and $\\tau_s$ for an ionic species, which govern the rates of momentum and mass transport in the simulation. Mastering this parameterization is essential for ensuring your simulation is not only stable but also accurately reflects the real-world physics while optimizing for computational efficiency .",
            "id": "4250003",
            "problem": "A two-dimensional electroosmotic microchannel flow is to be simulated using the Lattice Boltzmann Method (LBM) with a Single Relaxation Time (SRT) Bhatnagar-Gross-Krook (BGK) collision operator for the fluid on a D2Q9 lattice, coupled to an advection-diffusion LBM for a single ionic species on a D2Q5 lattice. The microchannel height is specified as $H = 128 \\,\\mu\\text{m}$, resolved uniformly with $N_y = 128$ lattice nodes in the wall-normal direction, so that the lattice spacing is $\\Delta x = H/N_y$. The characteristic fluid speed is $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$, the kinematic viscosity is $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$ (water at room temperature), and the ionic diffusivity is $D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$ (a typical small monovalent ion).\n\nStarting from the Boltzmann equation with Bhatnagar-Gross-Krook (BGK) relaxation and its second-order Chapman–Enskog hydrodynamic limit, derive the relations that connect the hydrodynamic kinematic viscosity and the scalar diffusivity to the corresponding LBM relaxation times on the D2Q9 and D2Q5 lattices, respectively. Use these relations to determine the relaxation times $\\tau$ (fluid) and $\\tau_s$ (species) in lattice units that simultaneously reproduce the target $\\nu_{\\text{phys}}$ and $D_{\\text{phys}}$ under the following constraints:\n- Low-Mach constraint: the lattice Mach number satisfies $\\text{Ma} \\leq 0.05$ at the characteristic speed $U^{\\ast}$.\n- Positivity and stability: $\\tau > \\tfrac{1}{2}$ and $\\tau_s > \\tfrac{1}{2}$.\n- Efficiency and accuracy constraint: choose the largest permissible time step $\\Delta t$ such that $\\tau \\leq 1.0$.\n\nAssume standard moment isotropy for D2Q9 and D2Q5 such that the lattice speed of sound satisfies $c_s^2 = \\tfrac{1}{3}$ in lattice units. Express the final answer as the pair $(\\tau, \\tau_s)$ in lattice units (dimensionless). Round each relaxation time to six significant figures.",
            "solution": "The problem is first validated by extracting the given information and assessing its scientific soundness, consistency, and completeness.\n\n### Step 1: Extracted Givens\n- **System**: Two-dimensional electroosmotic microchannel flow.\n- **Simulation Method**: Lattice Boltzmann Method (LBM) with Single Relaxation Time (SRT) BGK collision operator.\n- **Fluid Lattice**: D2Q9.\n- **Ionic Species Lattice**: D2Q5, for a single advecting-diffusing species.\n- **Physical Dimensions**: Channel height $H = 128 \\,\\mu\\text{m}$.\n- **Discretization**: $N_y = 128$ lattice nodes in the wall-normal direction, with lattice spacing $\\Delta x = H/N_y$.\n- **Physical Properties**:\n    - Characteristic fluid speed $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$.\n    - Kinematic viscosity $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$.\n    - Ionic diffusivity $D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$.\n- **Theoretical Basis**: Derivation from the second-order Chapman–Enskog hydrodynamic limit of the BGK-Boltzmann equation.\n- **Constraints**:\n    1. Low-Mach constraint: $\\text{Ma} \\leq 0.05$ at speed $U^{\\ast}$.\n    2. Positivity and stability: $\\tau > \\frac{1}{2}$ and $\\tau_s > \\frac{1}{2}$.\n    3. Efficiency and accuracy constraint: Choose the largest permissible time step $\\Delta t$ such that $\\tau \\leq 1.0$.\n- **Lattice Property**: Standard moment isotropy for D2Q9 and D2Q5, such that the lattice speed of sound squared is $c_s^2 = \\frac{1}{3}$ in lattice units.\n- **Required Output**: The relaxation times $(\\tau, \\tau_s)$ in dimensionless lattice units, rounded to six significant figures.\n\n### Step 2: Validation\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard problem in computational fluid dynamics, specifically the parameterization of a Lattice Boltzmann simulation to match physical transport coefficients. The physical values are realistic for water and small ions. The constraints are standard for ensuring stability, accuracy, and computational efficiency in LBM simulations. All necessary information is provided, and there are no internal contradictions.\n\n### Verdict\nThe problem is valid. A solution will be constructed.\n\n### Solution Derivation\nThe connection between macroscopic transport properties and the LBM relaxation time is established through the Chapman-Enskog expansion of the Lattice Boltzmann Equation with the BGK collision operator. For a fluid simulated on a D2Q9 lattice and a scalar species on a D2Q5 lattice, assuming standard low-Mach number equilibrium distributions, the resulting macroscopic equations yield expressions for the kinematic viscosity, $\\nu$, and the species diffusivity, $D$.\n\nIn lattice units (denoted by subscript 'lb'), these relations are:\n$$\n\\nu_{\\text{lb}} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\n$$\n$$\nD_{\\text{lb}} = c_s^2 \\left(\\tau_s - \\frac{1}{2}\\right)\n$$\nwhere $\\tau$ is the relaxation time for the fluid momentum, $\\tau_s$ is the relaxation time for the scalar species, and $c_s$ is the lattice speed of sound. The problem specifies that $c_s^2 = \\frac{1}{3}$ for both simulation components.\n\nTo determine the numerical values for $\\tau$ and $\\tau_s$, we must relate the physical properties ($\\nu_{\\text{phys}}$, $D_{\\text{phys}}$) to their lattice counterparts ($\\nu_{\\text{lb}}$, $D_{\\text{lb}}$). This requires defining the conversion factors for length and time. Let the physical lattice spacing be $\\Delta x$ and the physical time step be $\\Delta t$.\n\nThe unit conversions are as follows:\n- Length: $x_{\\text{phys}} = \\Delta x \\cdot x_{\\text{lb}}$\n- Time: $t_{\\text{phys}} = \\Delta t \\cdot t_{\\text{lb}}$\nFrom these, we derive the conversion for kinematic viscosity and diffusivity, which both have units of length squared per time:\n$$\n\\nu_{\\text{phys}} = \\frac{(\\Delta x)^2}{\\Delta t} \\nu_{\\text{lb}} \\implies \\nu_{\\text{lb}} = \\frac{\\Delta t}{(\\Delta x)^2} \\nu_{\\text{phys}}\n$$\n$$\nD_{\\text{phys}} = \\frac{(\\Delta x)^2}{\\Delta t} D_{\\text{lb}} \\implies D_{\\text{lb}} = \\frac{\\Delta t}{(\\Delta x)^2} D_{\\text{phys}}\n$$\n\nFirst, we calculate the physical lattice spacing $\\Delta x$:\n$$\n\\Delta x = \\frac{H}{N_y} = \\frac{128 \\times 10^{-6} \\,\\text{m}}{128} = 1.0 \\times 10^{-6} \\,\\text{m}\n$$\n\nNext, we must determine the physical time step $\\Delta t$. The problem poses a set of constraints to fix this free parameter. The \"efficiency and accuracy constraint\" instructs us to choose the largest permissible $\\Delta t$ such that the fluid relaxation time $\\tau \\leq 1.0$. Maximizing $\\Delta t$ enhances computational efficiency, and this maximum corresponds to the upper bound of the constraint, i.e., setting $\\tau = 1.0$.\n\nSetting $\\tau = 1.0$, we combine the equations for viscosity:\n$$\n\\frac{\\Delta t}{(\\Delta x)^2} \\nu_{\\text{phys}} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\n$$\nWe solve for $\\Delta t$ with $\\tau = 1.0$:\n$$\n\\Delta t = \\frac{c_s^2 \\left(1.0 - \\frac{1}{2}\\right) (\\Delta x)^2}{\\nu_{\\text{phys}}}\n$$\nSubstituting the known values: $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$, $\\Delta x = 1.0 \\times 10^{-6} \\,\\text{m}$, and $c_s^2 = \\frac{1}{3}$:\n$$\n\\Delta t = \\frac{\\frac{1}{3} \\left(\\frac{1}{2}\\right) (1.0 \\times 10^{-6} \\,\\text{m})^2}{1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{\\frac{1}{6} \\times 1.0 \\times 10^{-12} \\,\\text{m}^2}{1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{1}{6} \\times 10^{-6} \\,\\text{s}\n$$\nSo, $\\tau = 1.0$. This value satisfies the stability constraint $\\tau > \\frac{1}{2}$.\n\nWe must now check if this choice of $\\Delta t$ satisfies the low-Mach number constraint, $\\text{Ma} \\leq 0.05$. The lattice Mach number is $\\text{Ma} = U_{\\text{lb}} / c_s$, where $U_{\\text{lb}}$ is the characteristic velocity in lattice units. The conversion for velocity is:\n$$\nU_{\\text{phys}} = \\frac{\\Delta x}{\\Delta t} U_{\\text{lb}} \\implies U_{\\text{lb}} = \\frac{\\Delta t}{\\Delta x} U_{\\text{phys}}\n$$\nUsing the characteristic physical speed $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$:\n$$\nU_{\\text{lb}} = \\frac{\\frac{1}{6} \\times 10^{-6} \\,\\text{s}}{1.0 \\times 10^{-6} \\,\\text{m}} \\times (1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}) = \\frac{1}{6} \\times 10^{-3}\n$$\nThe Mach number is:\n$$\n\\text{Ma} = \\frac{U_{\\text{lb}}}{c_s} = \\frac{\\frac{1}{6} \\times 10^{-3}}{1/\\sqrt{3}} = \\frac{\\sqrt{3}}{6} \\times 10^{-3} \\approx 0.0002887\n$$\nSince $0.0002887 \\leq 0.05$, the Mach number constraint is satisfied.\n\nFinally, we calculate the species relaxation time $\\tau_s$. We have:\n$$\n\\tau_s = \\frac{D_{\\text{lb}}}{c_s^2} + \\frac{1}{2}\n$$\nSubstitute the expression for $D_{\\text{lb}}$:\n$$\n\\tau_s = \\frac{1}{c_s^2} \\left(\\frac{\\Delta t}{(\\Delta x)^2} D_{\\text{phys}}\\right) + \\frac{1}{2}\n$$\nNow, substitute the numerical values: $D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$ and the previously determined parameters:\n$$\n\\tau_s = \\frac{1}{1/3} \\left(\\frac{\\frac{1}{6} \\times 10^{-6} \\,\\text{s}}{(1.0 \\times 10^{-6} \\,\\text{m})^2} \\times 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = 3 \\left(\\frac{\\frac{1}{6} \\times 10^{-6}}{1.0 \\times 10^{-12}} \\times 1.0 \\times 10^{-9}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = 3 \\left(\\frac{1}{6} \\times 10^{6} \\times 10^{-9}\\right) + \\frac{1}{2} = 3 \\left(\\frac{1}{6} \\times 10^{-3}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = \\frac{1}{2} \\times 10^{-3} + \\frac{1}{2} = 0.0005 + 0.5 = 0.5005\n$$\nThis value satisfies the stability constraint $\\tau_s > \\frac{1}{2}$.\n\nThe resulting pair of relaxation times is $(\\tau, \\tau_s) = (1.0, 0.5005)$. Rounding to six significant figures as required gives $(\\tau, \\tau_s) = (1.00000, 0.500500)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.00000 & 0.500500\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Before deploying a complex numerical solver for scientific discovery, it is imperative to validate its correctness against known solutions. This exercise focuses on a cornerstone of validation in computational electrokinetics: verifying that a Lattice Boltzmann–Poisson–Nernst–Planck (LB–PNP) solver can reproduce the classic analytical limits for the electrophoretic mobility of a charged particle. By comparing the solver's output to the Hückel limit for thick double layers ($ \\kappa a \\ll 1 $) and the Smoluchowski limit for thin double layers ($ \\kappa a \\gg 1 $), you will practice a fundamental skill in code verification and build confidence in the model's physical fidelity .",
            "id": "4250048",
            "problem": "Consider the validation of a Lattice Boltzmann–Poisson–Nernst–Planck (LB–PNP) solver for electrokinetic flows by comparing its predicted electrophoretic mobility of a spherical particle in a liquid to well-established asymptotic limits. The LB–PNP solver advances a discrete-velocity kinetic model for hydrodynamics while coupling to electrostatics and ionic transport through the Poisson equation and the Nernst–Planck equations. The electrophoretic mobility is defined as $ \\mu = U/E $, where $ U $ is the steady particle velocity and $ E $ is the applied electric field magnitude.\n\nFundamental base:\n- The electrostatic potential $ \\phi $ obeys the Poisson equation $ -\\nabla \\cdot \\left( \\varepsilon \\nabla \\phi \\right) = \\rho_e $, where $ \\varepsilon $ is the permittivity and $ \\rho_e $ is the free charge density.\n- Ionic species of valence $ z $ and bulk concentration $ c_0 $ are transported by diffusion and migration according to the Nernst–Planck equation $ \\partial_t c + \\nabla \\cdot \\left( -D \\nabla c - \\mu_i z e c \\nabla \\phi + c \\mathbf{u} \\right) = 0 $, where $ D $ is the diffusion coefficient, $ \\mu_i $ is the ionic mobility, $ e $ is the elementary charge, and $ \\mathbf{u} $ is the fluid velocity.\n- In the creeping-flow regime, incompressible hydrodynamics are governed by the Stokes equations $ -\\nabla p + \\eta \\nabla^2 \\mathbf{u} + \\rho_e \\nabla \\phi = \\mathbf{0} $, $ \\nabla \\cdot \\mathbf{u} = 0 $, where $ p $ is pressure and $ \\eta $ is viscosity. The electrohydrodynamic body force is $ \\rho_e \\nabla \\phi $.\n\nUnder dilute-solution conditions with symmetric monovalent electrolyte and small $ |\\zeta| $ (zeta potential), linearization leads to the Debye–Hückel screening with inverse Debye length $ \\kappa $ defined by\n$$\n\\kappa^2 = \\frac{2 z^2 e^2 N_A I}{\\varepsilon k_B T},\n$$\nwhere $ z $ is the ionic valence, $ e $ is the elementary charge, $ N_A $ is Avogadro's number, $ I $ is the ionic strength in $ \\mathrm{mol/m^3} $, $ k_B $ is the Boltzmann constant, and $ T $ is temperature. The asymptotic limits for electrophoretic mobility of a sphere of radius $ a $ are:\n- Hückel limit ($ \\kappa a \\ll 1 $): $$ \\mu_{\\mathrm{H}} = \\frac{2 \\varepsilon \\zeta}{3 \\eta}. $$\n- Smoluchowski limit ($ \\kappa a \\gg 1 $): $$ \\mu_{\\mathrm{S}} = \\frac{\\varepsilon \\zeta}{\\eta}. $$\n\nFor validation across regimes, a practical interpolation consistent with both limits is to define a Henry-type function $ H(\\kappa a) $ satisfying $ H(0)=1 $ and $ H(\\infty)=\\frac{3}{2} $, and set\n$$\n\\mu_{\\mathrm{interp}}(\\kappa a) = \\frac{2 \\varepsilon \\zeta}{3 \\eta} \\, H(\\kappa a).\n$$\nA simple rational choice that preserves the correct limits is\n$$\nH(\\kappa a) = 1 + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}.\n$$\n\nYour task is to design and compute a validation metric for three test cases. For each case, compute the ionic strength $ I $ required to achieve the specified $ \\kappa a $ using the Debye relation above (with $ z=1 $), then compute:\n1. The Hückel-limit mobility $ \\mu_{\\mathrm{H}} $ and the Smoluchowski-limit mobility $ \\mu_{\\mathrm{S}} $,\n2. The interpolated mobility $ \\mu_{\\mathrm{interp}} $ using the $ H(\\kappa a) $ given,\n3. The relative errors in the near-limit cases:\n   - For the small-$ \\kappa a $ case, $ \\mathrm{err}_{\\mathrm{H}} = \\left| \\mu_{\\mathrm{interp}} - \\mu_{\\mathrm{H}} \\right| / \\left| \\mu_{\\mathrm{H}} \\right| $,\n   - For the large-$ \\kappa a $ case, $ \\mathrm{err}_{\\mathrm{S}} = \\left| \\mu_{\\mathrm{interp}} - \\mu_{\\mathrm{S}} \\right| / \\left| \\mu_{\\mathrm{S}} \\right| $.\n\nReport the following outputs:\n- For the small-$ \\kappa a $ case: the decimal $ \\mathrm{err}_{\\mathrm{H}} $ (dimensionless).\n- For the intermediate case: the signed $ \\mu_{\\mathrm{interp}} $ in $ \\mathrm{m^2/(V\\cdot s)} $.\n- For the large-$ \\kappa a $ case: the decimal $ \\mathrm{err}_{\\mathrm{S}} $ (dimensionless).\n\nAll computations must use the International System of Units (SI). Express mobility values in $ \\mathrm{m^2/(V\\cdot s)} $ and errors as decimals. Use $ \\varepsilon = \\varepsilon_r \\varepsilon_0 $ with $ \\varepsilon_0 $ as the vacuum permittivity and $ \\varepsilon_r $ the relative permittivity.\n\nTest suite parameter values:\n- Case A (near Hückel): $ a = 1.0 \\times 10^{-7} \\,\\mathrm{m} $, $ \\zeta = -25.0 \\times 10^{-3} \\,\\mathrm{V} $, $ \\varepsilon_r = 78.5 $, $ \\eta = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s} $, $ T = 298 \\,\\mathrm{K} $, $ z = 1 $, target $ \\kappa a = 10^{-2} $.\n- Case B (intermediate): $ a = 1.0 \\times 10^{-7} \\,\\mathrm{m} $, $ \\zeta = -25.0 \\times 10^{-3} \\,\\mathrm{V} $, $ \\varepsilon_r = 78.5 $, $ \\eta = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s} $, $ T = 298 \\,\\mathrm{K} $, $ z = 1 $, target $ \\kappa a = 1 $.\n- Case C (near Smoluchowski): $ a = 1.0 \\times 10^{-7} \\,\\mathrm{m} $, $ \\zeta = -25.0 \\times 10^{-3} \\,\\mathrm{V} $, $ \\varepsilon_r = 78.5 $, $ \\eta = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s} $, $ T = 298 \\,\\mathrm{K} $, $ z = 1 $, target $ \\kappa a = 100 $.\n\nYour program should compute $ I $ for each case from the specified target $ \\kappa a $ and given $ a $, then compute $ \\mu_{\\mathrm{H}} $, $ \\mu_{\\mathrm{S}} $, $ \\mu_{\\mathrm{interp}} $, and the errors as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order $ [\\mathrm{err}_{\\mathrm{H}}, \\mu_{\\mathrm{interp}}^{\\text{(Case B)}}, \\mathrm{err}_{\\mathrm{S}}] $. The units are $ \\mathrm{m^2/(V\\cdot s)} $ for the mobility value and decimals (unitless) for the errors.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of electrokinetics and computational physics, well-posed with a complete and consistent set of parameters and definitions, and requires the application of established physical formulas to compute specific, verifiable quantities. The problem is a standard validation procedure in the field of computational electrochemistry.\n\nThe solution proceeds by first defining the physical constants and calculating the parameters common to all test cases. Then, each case is analyzed individually to compute the required output. All calculations are performed in SI units.\n\nThe fundamental physical constants used are:\n- Elementary charge, $e \\approx 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$\n- Avogadro's number, $N_A \\approx 6.02214076 \\times 10^{23} \\, \\mathrm{mol}^{-1}$\n- Boltzmann constant, $k_B \\approx 1.380649 \\times 10^{-23} \\, \\mathrm{J/K}$\n- Vacuum permittivity, $\\varepsilon_0 \\approx 8.854187817 \\times 10^{-12} \\, \\mathrm{F/m}$\n\nThe parameters common to all three test cases are:\n- Sphere radius, $a = 1.0 \\times 10^{-7} \\, \\mathrm{m}$\n- Zeta potential, $\\zeta = -25.0 \\times 10^{-3} \\, \\mathrm{V}$\n- Relative permittivity of the medium, $\\varepsilon_r = 78.5$\n- Dynamic viscosity of the medium, $\\eta = 1.0 \\times 10^{-3} \\, \\mathrm{Pa \\cdot s}$\n- Absolute temperature, $T = 298 \\, \\mathrm{K}$\n- Ionic valence, $z = 1$\n\nFirst, the permittivity of the medium $\\varepsilon$ is calculated:\n$$\n\\varepsilon = \\varepsilon_r \\varepsilon_0 = 78.5 \\times 8.854187817 \\times 10^{-12} \\, \\mathrm{F/m} \\approx 6.9505374 \\times 10^{-10} \\, \\mathrm{F/m}\n$$\n\nThe problem requires the calculation of ionic strength $I$ for each target value of $\\kappa a$. The formula for the inverse Debye length $\\kappa$ is given as $\\kappa^2 = \\frac{2 z^2 e^2 N_A I}{\\varepsilon k_B T}$. We can rearrange this to solve for $I$:\n$$\nI = \\frac{\\kappa^2 \\varepsilon k_B T}{2 z^2 e^2 N_A}\n$$\nSince $\\kappa = (\\kappa a) / a$, we can express $I$ in terms of the target parameter $\\kappa a$:\n$$\nI = \\frac{(\\kappa a)^2 \\varepsilon k_B T}{2 a^2 z^2 e^2 N_A}\n$$\nWhile this value is computed for each case as part of the overall procedure, it is not directly required for the final output quantities, which depend only on $\\kappa a$.\n\nThe asymptotic mobility limits are calculated next, as they form the basis for the subsequent calculations.\nThe Hückel mobility limit ($\\kappa a \\ll 1$) is:\n$$\n\\mu_{\\mathrm{H}} = \\frac{2 \\varepsilon \\zeta}{3 \\eta} = \\frac{2 \\cdot (6.9505... \\times 10^{-10}) \\cdot (-25.0 \\times 10^{-3})}{3 \\cdot (1.0 \\times 10^{-3})} \\approx -1.15842 \\times 10^{-8} \\, \\mathrm{m^2/(V \\cdot s)}\n$$\nThe Smoluchowski mobility limit ($\\kappa a \\gg 1$) is:\n$$\n\\mu_{\\mathrm{S}} = \\frac{\\varepsilon \\zeta}{\\eta} = \\frac{(6.9505... \\times 10^{-10}) \\cdot (-25.0 \\times 10^{-3})}{1.0 \\times 10^{-3}} \\approx -1.73763 \\times 10^{-8} \\, \\mathrm{m^2/(V \\cdot s)}\n$$\nNote that $\\mu_{\\mathrm{S}} = \\frac{3}{2}\\mu_{\\mathrm{H}}$.\n\nThe interpolated mobility is given by $\\mu_{\\mathrm{interp}}(\\kappa a) = \\mu_{\\mathrm{H}} \\cdot H(\\kappa a)$, where the Henry-type function is $H(\\kappa a) = 1 + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}$.\n\nNow, we evaluate each test case.\n\n**Case A: Near-Hückel limit ($ \\kappa a = 10^{-2} $) **\nThe required output is the relative error with respect to the Hückel limit, $\\mathrm{err}_{\\mathrm{H}} = \\left| \\mu_{\\mathrm{interp}} - \\mu_{\\mathrm{H}} \\right| / \\left| \\mu_{\\mathrm{H}} \\right|$.\nSubstituting the definitions, we can simplify the expression for the error:\n$$\n\\mathrm{err}_{\\mathrm{H}} = \\frac{\\left| \\mu_{\\mathrm{H}} H(\\kappa a) - \\mu_{\\mathrm{H}} \\right|}{\\left| \\mu_{\\mathrm{H}} \\right|} = \\left| H(\\kappa a) - 1 \\right|\n$$\nUsing the given form of $H(\\kappa a)$:\n$$\n\\mathrm{err}_{\\mathrm{H}} = \\left| \\left(1 + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}\\right) - 1 \\right| = \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}\n$$\nFor $\\kappa a = 0.01$:\n$$\n\\mathrm{err}_{\\mathrm{H}} = \\frac{1}{2} \\frac{0.01}{1 + 0.01} = \\frac{0.005}{1.01} \\approx 0.004950495\n$$\n\n**Case B: Intermediate regime ($ \\kappa a = 1 $) **\nThe required output is the interpolated mobility, $\\mu_{\\mathrm{interp}}$.\nFirst, we calculate the Henry function $H(\\kappa a)$ for $\\kappa a = 1$:\n$$\nH(1) = 1 + \\frac{1}{2} \\frac{1}{1 + 1} = 1 + \\frac{1}{4} = 1.25\n$$\nThen, we compute the mobility:\n$$\n\\mu_{\\mathrm{interp}} = \\mu_{\\mathrm{H}} \\cdot H(1) \\approx (-1.15842 \\times 10^{-8}) \\cdot 1.25 \\approx -1.448028 \\times 10^{-8} \\, \\mathrm{m^2/(V \\cdot s)}\n$$\n\n**Case C: Near-Smoluchowski limit ($ \\kappa a = 100 $) **\nThe required output is the relative error with respect to the Smoluchowski limit, $\\mathrm{err}_{\\mathrm{S}} = \\left| \\mu_{\\mathrm{interp}} - \\mu_{\\mathrm{S}} \\right| / \\left| \\mu_{\\mathrm{S}} \\right|$.\nSubstituting the relations $\\mu_{\\mathrm{interp}} = \\mu_{\\mathrm{H}} H(\\kappa a)$ and $\\mu_{\\mathrm{S}} = \\frac{3}{2}\\mu_{\\mathrm{H}}$:\n$$\n\\mathrm{err}_{\\mathrm{S}} = \\frac{\\left| \\mu_{\\mathrm{H}} H(\\kappa a) - \\frac{3}{2}\\mu_{\\mathrm{H}} \\right|}{\\left| \\frac{3}{2}\\mu_{\\mathrm{H}} \\right|} = \\frac{\\left| H(\\kappa a) - \\frac{3}{2} \\right|}{\\frac{3}{2}}\n$$\nLet's analyze the term in the numerator:\n$$\nH(\\kappa a) - \\frac{3}{2} = \\left(1 + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}\\right) - \\frac{3}{2} = -\\frac{1}{2} + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a} = \\frac{1}{2} \\left( \\frac{\\kappa a - (1 + \\kappa a)}{1 + \\kappa a} \\right) = - \\frac{1}{2(1 + \\kappa a)}\n$$\nThe error is therefore:\n$$\n\\mathrm{err}_{\\mathrm{S}} = \\frac{\\left| - \\frac{1}{2(1 + \\kappa a)} \\right|}{\\frac{3}{2}} = \\frac{1}{2(1 + \\kappa a)} \\cdot \\frac{2}{3} = \\frac{1}{3(1 + \\kappa a)}\n$$\nFor $\\kappa a = 100$:\n$$\n\\mathrm{err}_{\\mathrm{S}} = \\frac{1}{3(1 + 100)} = \\frac{1}{3 \\cdot 101} = \\frac{1}{303} \\approx 0.00330033\n$$\nThe final results are compiled into the required list format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes validation metrics for an electrokinetic solver based on\n    asymptotic limits of electrophoretic mobility.\n    \"\"\"\n    # Define physical constants in SI units\n    e = 1.602176634e-19  # Elementary charge (C)\n    N_A = 6.02214076e23   # Avogadro's number (mol^-1)\n    k_B = 1.380649e-23     # Boltzmann constant (J/K)\n    eps_0 = 8.854187817e-12 # Vacuum permittivity (F/m)\n\n    # Define test suite parameters from the problem statement\n    params = {\n        'a': 1.0e-7,       # Particle radius (m)\n        'zeta': -25.0e-3,  # Zeta potential (V)\n        'eps_r': 78.5,     # Relative permittivity (dimensionless)\n        'eta': 1.0e-3,     # Dynamic viscosity (Pa*s)\n        'T': 298.0,        # Temperature (K)\n        'z': 1.0,          # Ionic valence (dimensionless)\n    }\n\n    # Define test cases by their target kappa*a values\n    test_cases = {\n        'A': {'kappa_a': 1e-2},\n        'B': {'kappa_a': 1.0},\n        'C': {'kappa_a': 100.0}\n    }\n\n    # --- Calculations ---\n\n    # Calculate derived parameters common to all cases\n    eps = params['eps_r'] * eps_0\n    \n    # Calculate Hückel and Smoluchowski mobility limits\n    mu_H = (2 * eps * params['zeta']) / (3 * params['eta'])\n    mu_S = (eps * params['zeta']) / params['eta'] # == 1.5 * mu_H\n\n    # Define the Henry-type function H(kappa*a) and its related error functions\n    def H_func(kappa_a):\n        return 1.0 + 0.5 * kappa_a / (1.0 + kappa_a)\n    \n    def err_H_func(kappa_a):\n        # Simplified from |H_func(kappa_a) - 1|\n        return 0.5 * kappa_a / (1.0 + kappa_a)\n\n    def err_S_func(kappa_a):\n        # Simplified from |H_func(kappa_a) - 1.5| / 1.5\n        return 1.0 / (3.0 * (1.0 + kappa_a))\n    \n    # Although not needed for the final output vector, the problem asks to compute\n    # the ionic strength I for each case. This function performs that calculation.\n    def get_ionic_strength(kappa_a, p):\n        # I = (kappa^2 * eps * k_B * T) / (2 * z^2 * e^2 * N_A)\n        # kappa = kappa_a / a\n        numerator = (kappa_a**2) * eps * k_B * p['T']\n        denominator = 2 * (p['a']**2) * (p['z']**2) * (e**2) * N_A\n        return numerator / denominator # in mol/m^3\n\n    # Case A: Compute relative error for near-Hückel case\n    kappa_a_A = test_cases['A']['kappa_a']\n    I_A = get_ionic_strength(kappa_a_A, params) # For completeness\n    err_H_A = err_H_func(kappa_a_A)\n\n    # Case B: Compute interpolated mobility for intermediate case\n    kappa_a_B = test_cases['B']['kappa_a']\n    I_B = get_ionic_strength(kappa_a_B, params) # For completeness\n    H_B = H_func(kappa_a_B)\n    mu_interp_B = mu_H * H_B\n\n    # Case C: Compute relative error for near-Smoluchowski case\n    kappa_a_C = test_cases['C']['kappa_a']\n    I_C = get_ionic_strength(kappa_a_C, params) # For completeness\n    err_S_C = err_S_func(kappa_a_C)\n\n    # Compile results into a list\n    results = [err_H_A, mu_interp_B, err_S_C]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Sophisticated models often rely on simplifying assumptions to remain computationally tractable, and a skilled researcher must understand the boundaries of their validity. A common simplification in electrokinetic simulations is the isothermal assumption, which neglects temperature changes due to effects like Joule heating. This practice challenges you to quantify the magnitude of Joule heating ($p = \\sigma E^2$) and derive the resulting temperature profile, allowing you to establish a clear, physics-based criterion for when an isothermal LBM simulation is appropriate and when a more complex thermal model is required .",
            "id": "4249986",
            "problem": "Consider an isothermal Lattice Boltzmann (LB) simulation setup for electrokinetic flow of an aqueous electrolyte in a parallel-plate microchannel of height $H$ with isothermal walls held at temperature $T_w$. An externally applied uniform electric field of magnitude $E$ is directed along the axial direction of the channel, and the electrolyte is characterized by an electrical conductivity $\\sigma$ and a thermal conductivity $k$. Ignore electrothermal body forces and assume that the electrical double layer is thin relative to the channel height so that bulk Ohmic conduction dominates the current. The LB solver neglects the energy equation and assumes constant material properties.\n\nYour task is to start from first principles appropriate to computational electrochemistry and electrokinetic transport and to derive a conservative, steady-state criterion for the validity of the isothermal LB assumption by quantifying the Joule heating and the maximum temperature rise in the fluid due to one-dimensional conduction to isothermal walls. Specifically, proceed from the foundations that the electrical current density obeys a linear constitutive relation in an electrolyte and that the steady one-dimensional energy balance with uniform internal volumetric heat generation and isothermal boundaries governs the temperature field across the channel. Using these bases, obtain general expressions that quantify the volumetric power density and the maximum temperature rise at the channel mid-plane. From these, construct a binary validity check for the isothermal LB assumption by comparing the maximum temperature rise to a specified tolerance $\\Delta T_{\\mathrm{tol}}$.\n\nYour program must implement the derived expressions and evaluate them for the following test suite, expressed in International System of Units (SI). For each case, use the given parameters to compute the volumetric power density and the maximum centerline temperature rise, then return whether the isothermal LB assumption is valid when the maximum temperature rise does not exceed the tolerance. All inputs are to be interpreted as constants with units indicated; all outputs must be expressed in the specified units.\n\nTest suite:\n\n- Case $1$: $\\sigma = 0.14 \\,\\mathrm{S/m}$, $E = 5000 \\,\\mathrm{V/m}$, $H = 100 \\times 10^{-6} \\,\\mathrm{m}$, $k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$, $\\Delta T_{\\mathrm{tol}} = 0.1 \\,\\mathrm{K}$.\n- Case $2$: $\\sigma = 0.5 \\,\\mathrm{S/m}$, $E = 19600 \\,\\mathrm{V/m}$, $H = 50 \\times 10^{-6} \\,\\mathrm{m}$, $k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$, $\\Delta T_{\\mathrm{tol}} = 0.1 \\,\\mathrm{K}$.\n- Case $3$: $\\sigma = 1.5 \\,\\mathrm{S/m}$, $E = 150000 \\,\\mathrm{V/m}$, $H = 200 \\times 10^{-6} \\,\\mathrm{m}$, $k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$, $\\Delta T_{\\mathrm{tol}} = 0.5 \\,\\mathrm{K}$.\n- Case $4$: $\\sigma = 5 \\times 10^{-6} \\,\\mathrm{S/m}$, $E = 100000 \\,\\mathrm{V/m}$, $H = 50 \\times 10^{-6} \\,\\mathrm{m}$, $k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$, $\\Delta T_{\\mathrm{tol}} = 0.01 \\,\\mathrm{K}$.\n- Case $5$: $\\sigma = 0.2 \\,\\mathrm{S/m}$, $E = 10000 \\,\\mathrm{V/m}$, $H = 100 \\times 10^{-6} \\,\\mathrm{m}$, $k = 0.1 \\,\\mathrm{W/(m\\cdot K)}$, $\\Delta T_{\\mathrm{tol}} = 0.25 \\,\\mathrm{K}$.\n\nFor each test case, compute:\n\n- The volumetric power density due to Joule heating, in $\\mathrm{W/m^3}$, returned as a floating-point number.\n- The maximum centerline temperature rise relative to the wall, in $\\mathrm{K}$, returned as a floating-point number.\n- A boolean indicating whether the isothermal LB assumption is valid under the derived criterion, where validity is defined as the maximum temperature rise being less than or equal to the tolerance $\\Delta T_{\\mathrm{tol}}$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of three values in the order $\\left[p,\\Delta T_{\\max},\\text{valid}\\right]$. For example, the structure must be $\\left[\\left[p_1,\\Delta T_{\\max,1},\\text{valid}_1\\right],\\left[p_2,\\Delta T_{\\max,2},\\text{valid}_2\\right],\\dots\\right]$. Ensure that $p$ is in $\\mathrm{W/m^3}$, $\\Delta T_{\\max}$ is in $\\mathrm{K}$, and the validity flag is a boolean.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of electrochemistry and heat transfer, is well-posed with sufficient information, and is expressed in objective, formal language. We proceed with the derivation of the validity criterion.\n\nOur objective is to establish a criterion for the validity of an isothermal assumption in a Lattice Boltzmann (LB) simulation of electrokinetic flow. This requires quantifying the temperature rise caused by Joule heating and comparing it to a tolerance. The derivation proceeds in three steps: first, we determine the volumetric heat generation rate from Joule heating; second, we solve the steady-state heat conduction equation to find the maximum temperature rise; and third, we formulate the validity criterion based on this temperature rise.\n\nFirst, we derive the expression for the volumetric power density, $p$, due to Joule heating. The problem states that the electrical current density, $\\vec{J}$, in the electrolyte follows a linear constitutive relation with the applied electric field, $\\vec{E}$. This is the differential form of Ohm's law:\n$$\n\\vec{J} = \\sigma \\vec{E}\n$$\nwhere $\\sigma$ is the electrical conductivity of the electrolyte. The volumetric power dissipation, which manifests as a heat source, is given by the dot product of the electric field and the current density:\n$$\np = \\vec{E} \\cdot \\vec{J}\n$$\nSubstituting the expression for $\\vec{J}$, and noting that the problem specifies a uniform electric field of magnitude $E$, we have:\n$$\np = \\vec{E} \\cdot (\\sigma \\vec{E}) = \\sigma (\\vec{E} \\cdot \\vec{E}) = \\sigma |\\vec{E}|^2 = \\sigma E^2\n$$\nSince $\\sigma$ and $E$ are assumed constant, the volumetric heat generation $p$ is uniform throughout the fluid. The units are $(\\text{S/m}) \\cdot (\\text{V/m})^2 = (\\text{A}/\\text{V}\\cdot\\text{m}) \\cdot (\\text{V}^2/\\text{m}^2) = (\\text{A}\\cdot\\text{V})/\\text{m}^3 = \\text{W}/\\text{m}^3$, which is consistent with a power density.\n\nSecond, we determine the maximum temperature rise, $\\Delta T_{\\max}$, in the channel. The problem specifies a parallel-plate microchannel of height $H$ with isothermal walls at temperature $T_w$. We consider a $1$-dimensional, steady-state energy balance across the channel height. Let us define a coordinate system with the $y$-axis normal to the plates, where $y=0$ is the channel centerline and the walls are located at $y = \\pm H/2$. The governing differential equation for heat conduction with a uniform internal heat source $p$ is:\n$$\n\\frac{d}{dy}\\left(k \\frac{dT}{dy}\\right) + p = 0\n$$\nwhere $k$ is the thermal conductivity of the electrolyte and $T(y)$ is the temperature profile. As $k$ is assumed constant, the equation simplifies to:\n$$\n\\frac{d^2T}{dy^2} = -\\frac{p}{k}\n$$\nWe solve this equation subject to the isothermal boundary conditions at the walls: $T(y=H/2) = T_w$ and $T(y=-H/2) = T_w$. Integrating the equation once with respect to $y$ yields:\n$$\n\\frac{dT}{dy} = -\\frac{p}{k} y + C_1\n$$\nDue to the symmetry of the geometry and boundary conditions, the temperature profile must be symmetric about the centerline ($y=0$), which implies the temperature gradient is zero at this point. Applying this symmetry condition, $dT/dy|_{y=0} = 0$, we find the first integration constant $C_1 = 0$. The temperature gradient is thus $\\frac{dT}{dy} = - (p/k)y$. Integrating a second time gives the temperature profile:\n$$\nT(y) = \\int -\\frac{p}{k} y \\, dy = -\\frac{p}{2k} y^2 + C_2\n$$\nTo find the second integration constant $C_2$, we apply the boundary condition at the wall, for instance at $y = H/2$:\n$$\nT(H/2) = T_w = -\\frac{p}{2k} \\left(\\frac{H}{2}\\right)^2 + C_2 \\implies C_2 = T_w + \\frac{pH^2}{8k}\n$$\nThe complete temperature profile is a parabola:\n$$\nT(y) = T_w + \\frac{pH^2}{8k} - \\frac{p}{2k} y^2 = T_w + \\frac{p}{2k}\\left(\\frac{H^2}{4} - y^2\\right)\n$$\nThe maximum temperature, $T_{\\max}$, occurs at the centerline ($y=0$):\n$$\nT_{\\max} = T(0) = T_w + \\frac{pH^2}{8k}\n$$\nThe maximum temperature rise relative to the wall temperature, $\\Delta T_{\\max}$, is therefore:\n$$\n\\Delta T_{\\max} = T_{\\max} - T_w = \\frac{pH^2}{8k}\n$$\nSubstituting our previously derived expression for $p = \\sigma E^2$, we obtain the final formula for the maximum temperature rise:\n$$\n\\Delta T_{\\max} = \\frac{\\sigma E^2 H^2}{8k}\n$$\n\nThird, we construct the validity check. The problem states that the isothermal LB assumption is considered valid if the maximum temperature rise does not exceed a specified tolerance, $\\Delta T_{\\mathrm{tol}}$. This gives the binary criterion:\n$$\n\\text{Validity} \\iff \\Delta T_{\\max} \\le \\Delta T_{\\mathrm{tol}}\n$$\n\nThese derived expressions allow for the direct calculation of the volumetric power density, the maximum temperature rise, and the validity of the isothermal assumption for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a criterion for the validity of the isothermal assumption\n    in a Lattice Boltzmann simulation of electrokinetic flow by quantifying\n    Joule heating and the resulting temperature rise.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (sigma, E, H, k, dt_tol) in SI units.\n    # sigma (S/m), E (V/m), H (m), k (W/(m.K)), dt_tol (K)\n    test_cases = [\n        (0.14, 5000, 100e-6, 0.6, 0.1),\n        (0.5, 19600, 50e-6, 0.6, 0.1),\n        (1.5, 150000, 200e-6, 0.6, 0.5),\n        (5e-6, 100000, 50e-6, 0.6, 0.01),\n        (0.2, 10000, 100e-6, 0.1, 0.25),\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma, E, H, k, dt_tol = case\n\n        # 1. Calculate the volumetric power density (p) due to Joule heating.\n        # Formula: p = sigma * E^2\n        p = sigma * E**2\n\n        # 2. Calculate the maximum centerline temperature rise (dt_max).\n        # Formula: dt_max = (p * H^2) / (8 * k)\n        dt_max = (p * H**2) / (8 * k)\n\n        # 3. Determine if the isothermal assumption is valid.\n        # Criterion: dt_max <= dt_tol\n        is_valid = dt_max <= dt_tol\n\n        # Store the results [p, dt_max, is_valid] for the current case.\n        results.append([p, dt_max, is_valid])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # The template `f\"[{','.join(map(str, results))}]\"` correctly produces this,\n    # including spaces inside the inner list representations, which is standard.\n    # Example: '[[3500000.0, 0.00729..., True],[...]]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}