{
    "hands_on_practices": [
        {
            "introduction": "多孔电极理论的核心在于将微观尺度上发生在复杂几何结构中的物理过程，转化为可在宏观尺度上求解的连续介质方程。本练习将指导您亲手完成这一转化过程中的关键一步：通过体积平均法，从电解质相内部的微观电荷守恒定律出发，推导出宏观的电荷守恒方程。这个实践不仅能加深您对模型中源项 $a_s j$ 物理意义的理解，也是掌握多孔电极理论建模思想的基石。",
            "id": "4255123",
            "problem": "考虑一个被电解质浸润的一维多孔电极，使用 John Newman 的多孔电极理论框架对其进行建模。设电解质相的电流密度场为 $\\mathbf{i}_e(\\mathbf{x},t)$，电荷密度为 $\\rho_e(\\mathbf{x},t)$。单位体积的界面面积（比界面积）为 $a_s$，界面电流密度为 $j$（定义为从固相到电解质相的电荷转移为正）。假设条件为等温、孔隙率恒定、忽略双电层充电和位移电流，并且电解质相呈电中性。\n\n从电解质相的局部电荷守恒定律出发，通过对代表性体积单元（REV）进行体积平均，推导联系电解质电流密度散度 $\\nabla \\cdot \\mathbf{i}_e$、界面电流密度 $j$ 和比界面积 $a_s$ 的稳态连续性方程。\n\n然后，对于多孔电极中比界面积为 $a_s = 2 \\times 10^5\\,\\mathrm{m}^2\\mathrm{m}^{-3}$、局部界面电流密度为 $j = 1\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$ 的位置，计算体积界面电流 $a_s j$。请以 $\\mathrm{A}\\,\\mathrm{m}^{-3}$ 为单位表示最终数值答案，并保留三位有效数字。",
            "solution": "本题要求基于 John Newman 的多孔电极理论，推导多孔电极中电解质相的稳态连续性方程，并进行后续的数值计算。\n\n### 第一部分：连续性方程的推导\n\n推导始于电解质相的局部电荷守恒基本定律。在电解质所占据的体积内，电荷连续性方程由下式给出：\n$$\n\\frac{\\partial \\rho_e'}{\\partial t} + \\nabla \\cdot \\mathbf{i}_e' = 0\n$$\n其中 $\\rho_e'(\\mathbf{x},t)$ 是电解质相内一点 $\\mathbf{x}$ 处的局部微观电荷密度（单位为 $\\mathrm{C}\\,\\mathrm{m}^{-3}$），$\\mathbf{i}_e'(\\mathbf{x},t)$ 是该点的局部微观电流密度（单位为 $\\mathrm{A}\\,\\mathrm{m}^{-2}$）。该方程表明，任何局部的电荷积累都必须由流入该点的净电荷流量来平衡。它仅在电解质相的边界内成立。\n\n为了获得一个适用于整个多孔电极体积（包括固相和电解质相）的宏观方程，我们对一个用 $V$ 表示的代表性体积单元（REV）进行体积平均。由此得到的宏观量是在多孔电极整个域上定义的连续场。\n\n在电解质相中定义的量 $\\psi$ 的表观平均值由 $\\langle \\psi \\rangle = \\frac{1}{V} \\int_{V_e} \\psi \\, dV$ 给出，其中 $V_e$ 是 REV 内电解质的体积。宏观电解质电流密度 $\\mathbf{i}_e$ 定义为微观电流密度的表观平均值：\n$$\n\\mathbf{i}_e = \\langle \\mathbf{i}_e' \\rangle = \\frac{1}{V} \\int_{V_e} \\mathbf{i}_e' \\, dV\n$$\n对 REV 上的局部守恒方程进行平均需要使用空间平均定理（也称为多孔介质散度定理），该定理将散度的平均值与平均值的散度联系起来：\n$$\n\\langle \\nabla \\cdot \\mathbf{i}_e' \\rangle = \\nabla \\cdot \\langle \\mathbf{i}_e' \\rangle + \\frac{1}{V} \\int_{S_{int}} \\mathbf{i}_e' \\cdot \\mathbf{n}_{es} \\, dS\n$$\n此处，$S_{int}$ 是 REV 内固-电解质界面的总面积，$\\mathbf{n}_{es}$ 是从电解质相指向固相的单位法向量。积分项表示单位多孔电极体积内，穿过界面从电解质到固体的总电荷通量。\n\n题目将界面电流密度 $j$ 定义为电荷*从*固相*进入*电解质相的转移。如果我们定义 $\\mathbf{n}_{se}$ 为从固相指向电解质的单位法向量（$\\mathbf{n}_{se} = -\\mathbf{n}_{es}$），那么 $j$ 对应于沿此方向的电流密度分量：$j = \\mathbf{i}_e' \\cdot \\mathbf{n}_{se}$。\n因此，被积函数可以改写为 $j$ 的形式：\n$$\n\\mathbf{i}_e' \\cdot \\mathbf{n}_{es} = \\mathbf{i}_e' \\cdot (-\\mathbf{n}_{se}) = -j\n$$\n积分项因此变为：\n$$\n\\frac{1}{V} \\int_{S_{int}} (-j) \\, dS = -\\frac{S_{int}}{V} \\frac{1}{S_{int}} \\int_{S_{int}} j \\, dS = - a_s \\bar{j}\n$$\n其中 $a_s = S_{int}/V$ 是比界面积（单位电极体积的界面面积），$\\bar{j}$ 是在 $S_{int}$ 上的平均界面电流密度。假设在 REV 内的界面上 $j$ 是均匀的，则有 $\\bar{j} = j$。空间平均定理于是得出：\n$$\n\\langle \\nabla \\cdot \\mathbf{i}_e' \\rangle = \\nabla \\cdot \\mathbf{i}_e - a_s j\n$$\n现在，我们对局部守恒方程中的时间导数项进行平均：\n$$\n\\left\\langle \\frac{\\partial \\rho_e'}{\\partial t} \\right\\rangle = \\frac{\\partial \\langle \\rho_e' \\rangle}{\\partial t}\n$$\n其中 $\\langle \\rho_e' \\rangle = \\frac{1}{V} \\int_{V_e} \\rho_e' \\, dV$ 是体积平均电荷密度。\n\n结合这些平均项，宏观电荷守恒方程为：\n$$\n\\frac{\\partial \\langle \\rho_e' \\rangle}{\\partial t} + \\nabla \\cdot \\mathbf{i}_e - a_s j = 0\n$$\n这可以重排为：\n$$\n\\nabla \\cdot \\mathbf{i}_e = a_s j - \\frac{\\partial \\langle \\rho_e' \\rangle}{\\partial t}\n$$\n题目指定了几个条件，用以将此方程简化为其稳态形式：\n1.  **电解质相中的电中性**：这个假设假定体电解质中的净电荷密度为零，即 $\\rho_e' = 0$。因此，平均电荷密度 $\\langle \\rho_e' \\rangle$ 也为零。这是电化学建模中一个常见且简化的假设。\n2.  **忽略双电层充电**：$\\frac{\\partial \\langle \\rho_e' \\rangle}{\\partial t}$ 项在物理上代表与固-电解质界面双电层中存储的电荷变化相关的电容电流。假设此效应可忽略不计，意味着我们将此项设为零。\n3.  **稳态形式**：根据定义，在稳态下，所有状态变量的时间导数均为零。因此，$\\frac{\\partial \\langle \\rho_e' \\rangle}{\\partial t} = 0$。\n\n所有这三个被明确说明或隐含的条件都导致时间导数项被消除。因此，最终的稳态连续性方程为：\n$$\n\\nabla \\cdot \\mathbf{i}_e = a_s j\n$$\n这个多孔电极理论的基本方程指出，通过一个微分体积元的电解质电流变化量，完全等于该体积内界面上电化学反应产生的电流量。\n\n### 第二部分：数值计算\n\n题目要求计算体积界面电流，它由乘积 $a_s j$ 给出。\n给定值为：\n- 比界面积，$a_s = 2 \\times 10^5\\,\\mathrm{m}^2\\mathrm{m}^{-3}$。这可以写成 $a_s = 2 \\times 10^5\\,\\mathrm{m}^{-1}$。\n- 局部界面电流密度，$j = 1\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$。\n\n体积界面电流计算如下：\n$$\na_s j = (2 \\times 10^5\\,\\mathrm{m}^{-1}) \\times (1\\,\\mathrm{A}\\,\\mathrm{m}^{-2})\n$$\n$$\na_s j = 2 \\times 10^5\\,\\mathrm{A}\\,\\mathrm{m}^{-3}\n$$\n题目要求答案以三位有效数字表示。因此，数值为 $2.00 \\times 10^5$。",
            "answer": "$$\n\\boxed{2.00 \\times 10^5}\n$$"
        },
        {
            "introduction": "掌握了控制方程的来源之后，下一步是应用它们来分析电极内的物理场分布。本练习提供了一个经典场景：在一个给定的电化学反应电流分布下，求解一维多孔电极固相中的电势分布 $\\phi_{s}(x)$。通过求解这个问题，您将学会如何综合运用电荷守恒定律和欧姆定律，并结合边界条件来确定电极内部的电势降，这是理解和量化电极欧姆极化的关键一步。",
            "id": "4255132",
            "problem": "考虑一个厚度为 $L$ 的一维多孔电极，其空间坐标为 $x \\in [0,L]$，其中 $x=0$ 表示集流体，$x=L$ 表示隔膜界面。该电极以均匀施加的电流密度 $I_{\\text{app}}$（单位：安培/平方米）进行恒流放电，电流从 $x=0$ 处的集流体进入多孔电极。固相基体的有效电子电导率是恒定的，等于 $\\sigma_{\\text{eff}}$（单位：西门子/米）。假设条件为等温、无副反应，且微观结构是均匀的，因此有效性质在空间上是均匀的。\n\n采用标准的一维多孔电极理论框架。固相电流密度 $i_{s}(x)$（单位：安培/平方米）遵循一维连续性方程形式的电荷守恒，固相电势 $\\phi_{s}(x)$（单位：伏特）遵循固相基体中的欧姆定律。单位电极体积的界面转移电流密度是预先设定的，由下式给出\n$$\nj(x) = j_{0}\\left(1 - \\frac{x}{L}\\right)^{2},\n$$\n其中 $j_{0}$ 是一个待由恒流约束确定的未知常数。采用的符号约定为：$j(x) > 0$ 对应于法拉第反应导致的电子从固相中的净脱出，并且随着反应消耗电流，固相电流沿 $x$ 增加的方向减小。电极仅在 $x=0$ 处接触，因此 $i_{s}(L) = 0$，且恒流约束要求 $i_{s}(0) = I_{\\text{app}}$。设集流体电势为 $\\phi_{s}(0) = \\phi_{\\text{cc}}$，其中 $\\phi_{\\text{cc}}$ 是一个恒定的参考值。\n\n仅使用固相中的电荷守恒和欧姆定律这两个基本原理，确定固相电势 $\\phi_{s}(x)$ 作为 $x$、$I_{\\text{app}}$、$L$ 和 $\\sigma_{\\text{eff}}$ 的函数的闭式表达式。最终答案以伏特为单位，表示为解析表达式。题目未提供数值；请勿进行任何数值舍入。",
            "solution": "用户要求推导在一维多孔电极恒流放电条件下的固相电势分布 $\\phi_s(x)$。该问题被认为是有效的，因为它以已建立的多孔电极理论为科学基础，具有完整且一致的给定条件和边界条件，问题适定，且陈述客观。\n\n解决方案从电极固相中的电荷守恒和欧姆定律这两个基本原理推导得出。\n\n首先，我们建立固相电流密度 $i_s(x)$ 与单位体积界面转移电流密度 $j(x)$ 之间的关系。固相中的电荷守恒由一维连续性方程表示：\n$$\n\\frac{di_s(x)}{dx} = -j(x)\n$$\n负号表示正的转移电流（脱嵌，即电子离开固相）导致流经固相基体的电子电流随离集流体距离 $x$ 的增加而减小。\n\n问题陈述了恒流条件，即在集流体边界 $x=0$ 处施加了总电流密度 $I_{\\text{app}}$。这表示为 $i_s(0) = I_{\\text{app}}$。在隔膜界面 $x=L$ 处，电极是电子绝缘的，因此没有电子电流流出，这给出了边界条件 $i_s(L) = 0$。\n\n通过将电荷守恒方程在整个电极厚度上从 $x=0$ 到 $x=L$ 进行积分，我们可以将施加的电流与总反应速率联系起来：\n$$\n\\int_{0}^{L} \\frac{di_s(x)}{dx} dx = -\\int_{0}^{L} j(x) dx\n$$\n$$\ni_s(L) - i_s(0) = -\\int_{0}^{L} j(x) dx\n$$\n代入边界条件 $i_s(L)=0$ 和 $i_s(0)=I_{\\text{app}}$：\n$$\n0 - I_{\\text{app}} = -\\int_{0}^{L} j(x) dx\n$$\n$$\nI_{\\text{app}} = \\int_{0}^{L} j(x) dx\n$$\n这个方程提供了确定转移电流的给定表达式 $j(x) = j_{0}\\left(1 - \\frac{x}{L}\\right)^{2}$ 中未知常数 $j_0$ 所需的约束。将此形式代入积分约束中：\n$$\nI_{\\text{app}} = \\int_{0}^{L} j_{0}\\left(1 - \\frac{x}{L}\\right)^{2} dx = j_0 \\int_{0}^{L} \\left(1 - \\frac{2x}{L} + \\frac{x^2}{L^2}\\right) dx\n$$\n进行积分：\n$$\nI_{\\text{app}} = j_0 \\left[ x - \\frac{x^2}{L} + \\frac{x^3}{3L^2} \\right]_{0}^{L} = j_0 \\left( (L - \\frac{L^2}{L} + \\frac{L^3}{3L^2}) - 0 \\right) = j_0 \\left(L - L + \\frac{L}{3}\\right) = \\frac{j_0 L}{3}\n$$\n由此，我们解出 $j_0$：\n$$\nj_0 = \\frac{3 I_{\\text{app}}}{L}\n$$\n现在我们得到了转移电流密度的完整表达式：\n$$\nj(x) = \\frac{3 I_{\\text{app}}}{L} \\left(1 - \\frac{x}{L}\\right)^{2}\n$$\n接下来，我们通过对电荷守恒方程 $\\frac{di_s}{dx} = -j(x)$ 从一个一般位置 $x$ 积分到边界 $L$ 来确定固相电流密度分布 $i_s(x)$：\n$$\n\\int_{x}^{L} \\frac{di_s(\\xi)}{d\\xi} d\\xi = -\\int_{x}^{L} j(\\xi) d\\xi\n$$\n$$\ni_s(L) - i_s(x) = -\\int_{x}^{L} \\frac{3 I_{\\text{app}}}{L} \\left(1 - \\frac{\\xi}{L}\\right)^{2} d\\xi\n$$\n使用边界条件 $i_s(L) = 0$：\n$$\n-i_s(x) = -\\frac{3 I_{\\text{app}}}{L} \\left[ -\\frac{L}{3} \\left(1 - \\frac{\\xi}{L}\\right)^{3} \\right]_{x}^{L}\n$$\n$$\n-i_s(x) = -I_{\\text{app}} \\left[ -\\left(1 - \\frac{\\xi}{L}\\right)^{3} \\right]_{x}^{L} = -I_{\\text{app}} \\left( -\\left(1 - \\frac{L}{L}\\right)^{3} - \\left(-\\left(1 - \\frac{x}{L}\\right)^{3}\\right) \\right)\n$$\n$$\n-i_s(x) = -I_{\\text{app}} \\left( 0 + \\left(1 - \\frac{x}{L}\\right)^{3} \\right)\n$$\n因此，固相电流密度分布为：\n$$\ni_s(x) = I_{\\text{app}} \\left(1 - \\frac{x}{L}\\right)^{3}\n$$\n最后一步是求固相电势 $\\phi_s(x)$。固相电势和电流密度之间的关系由欧姆定律给出：\n$$\ni_s(x) = -\\sigma_{\\text{eff}} \\frac{d\\phi_s(x)}{dx}\n$$\n其中 $\\sigma_{\\text{eff}}$ 是固相基体的有效电子电导率。重新整理得到电势梯度：\n$$\n\\frac{d\\phi_s(x)}{dx} = -\\frac{i_s(x)}{\\sigma_{\\text{eff}}} = -\\frac{I_{\\text{app}}}{\\sigma_{\\text{eff}}} \\left(1 - \\frac{x}{L}\\right)^{3}\n$$\n为了求得 $\\phi_s(x)$，我们将此方程从集流体处 $x=0$ 积分到一个一般位置 $x$。我们使用边界条件，即集流体处的电势是一个固定的参考值 $\\phi_s(0) = \\phi_{\\text{cc}}$。\n$$\n\\int_{0}^{x} \\frac{d\\phi_s(\\xi)}{d\\xi} d\\xi = \\int_{0}^{x} -\\frac{I_{\\text{app}}}{\\sigma_{\\text{eff}}} \\left(1 - \\frac{\\xi}{L}\\right)^{3} d\\xi\n$$\n$$\n\\phi_s(x) - \\phi_s(0) = -\\frac{I_{\\text{app}}}{\\sigma_{\\text{eff}}} \\int_{0}^{x} \\left(1 - \\frac{\\xi}{L}\\right)^{3} d\\xi\n$$\n进行积分：\n$$\n\\phi_s(x) - \\phi_s(0) = -\\frac{I_{\\text{app}}}{\\sigma_{\\text{eff}}} \\left[ -\\frac{L}{4} \\left(1 - \\frac{\\xi}{L}\\right)^{4} \\right]_{0}^{x}\n$$\n$$\n\\phi_s(x) - \\phi_s(0) = \\frac{I_{\\text{app}}L}{4\\sigma_{\\text{eff}}} \\left[ \\left(1 - \\frac{\\xi}{L}\\right)^{4} \\right]_{0}^{x} = \\frac{I_{\\text{app}}L}{4\\sigma_{\\text{eff}}} \\left( \\left(1 - \\frac{x}{L}\\right)^{4} - \\left(1 - \\frac{0}{L}\\right)^{4} \\right)\n$$\n$$\n\\phi_s(x) - \\phi_s(0) = \\frac{I_{\\text{app}}L}{4\\sigma_{\\text{eff}}} \\left( \\left(1 - \\frac{x}{L}\\right)^{4} - 1 \\right)\n$$\n代入 $\\phi_s(0) = \\phi_{\\text{cc}}$，我们得到固相电势分布的最终闭式表达式：\n$$\n\\phi_s(x) = \\phi_{\\text{cc}} + \\frac{I_{\\text{app}}L}{4\\sigma_{\\text{eff}}} \\left( \\left(1 - \\frac{x}{L}\\right)^{4} - 1 \\right)\n$$\n此表达式描述了多孔电极固相基体中的电势作为位置 $x$ 和给定物理参数的函数。",
            "answer": "$$ \\boxed{\\phi_{\\text{cc}} + \\frac{I_{\\text{app}}L}{4\\sigma_{\\text{eff}}} \\left( \\left(1 - \\frac{x}{L}\\right)^{4} - 1 \\right)} $$"
        },
        {
            "introduction": "理论模型的实用价值最终体现在其预测真实世界现象的能力上，而这依赖于准确的模型参数。本计算练习将引导您完成一个从理论到实践的完整工作流程：如何根据微观结构信息对一个关键的输运参数——有效扩散系数 $D_{\\text{eff}}$——进行参数化，并量化其不确定性。您将学习使用非线性最小二乘法从合成数据中拟合模型参数，并应用不确定性传播方法来评估模型预测的置信度，这些都是计算电化学建模人员必备的高级技能。",
            "id": "4255108",
            "problem": "您的任务是实现一个基于多孔电极理论的计算流程，以评估和传播有效电解质扩散系数的不确定性。考虑一个宏观均匀的多孔隔膜，其依赖于微观结构的曲折度通过参数形式 $ \\tau = 1 + a(1-\\varepsilon)^p$ 与孔隙度相关联，其中 $a$ 和 $p$ 是未知的正参数，$\\varepsilon$ 是孔隙度。在多孔电极理论 (Newman) 中，有效电解质扩散系数被建模为 $ D_{\\text{eff}} = \\dfrac{\\varepsilon}{\\tau} D_{\\text{bulk}}$，其中 $D_{\\text{bulk}}$ 是自由溶液中的体电解质扩散系数。目标是 (i) 从合成的微观结构信息曲折度数据中拟合 $a$ 和 $p$，(ii) 从回归中计算参数协方差，以及 (iii) 将 $\\varepsilon$ 测量中的不确定性传播到 $D_{\\text{eff}}$ 的最终不确定性上。\n\n从基本定义开始：多孔介质中扩散通量 $J$ 的 Fick 第一定律为 $J = -D_{\\text{eff}} \\nabla c$，其中 $c$ 是浓度，$D_{\\text{eff}}$ 是有效扩散系数。在多孔介质中，$D_{\\text{eff}}$ 通过 $D_{\\text{eff}} = (\\varepsilon/\\tau) D_{\\text{bulk}}$ 来解释由孔隙度和曲折度引起的降低，其中 $\\varepsilon \\in (0,1)$ 且 $\\tau \\ge 1$。相关式 $ \\tau = 1 + a(1-\\varepsilon)^p$ 将微观结构与传输联系起来，并需要将 $a$ 和 $p$ 与观测到的数据对 $(\\varepsilon_i, \\tau_i)$ 进行拟合。\n\n实现以下步骤：\n\n1. 使用提供的孔隙度和真实参数值为隔膜生成合成的曲折度数据。为保证可复现性，设置固定的伪随机生成器种子，并向曲折度测量值添加高斯噪声。\n   - 使用 $a_{\\text{true}} = 2.8$，$p_{\\text{true}} = 1.7$。\n   - 使用列表中的孔隙度值 $\\varepsilon_i$：$[0.35, 0.40, 0.45, 0.50, 0.55, 0.60, 0.65, 0.70, 0.75, 0.80, 0.82, 0.84, 0.86, 0.88]$。\n   - 对于每个 $\\varepsilon_i$，计算无噪声的曲折度 $ \\tau_i^{\\text{true}} = 1 + a_{\\text{true}} (1 - \\varepsilon_i)^{p_{\\text{true}}}$，然后添加均值为零、标准差为 $\\sigma_{\\tau} = 0.03$ 的独立同分布高斯噪声，以获得观测值 $ \\tau_i^{\\text{obs}}$。\n   - 伪随机生成器使用固定的种子，其值为 $123$。\n\n2. 使用模型 $ \\tau(\\varepsilon; a,p) = 1 + a(1-\\varepsilon)^p$ 进行非线性最小二乘回归，将 $\\tau_i^{\\text{obs}}$ 视为因变量，$\\varepsilon_i$ 视为自变量，从而拟合参数 $a$ 和 $p$。使用已知的 $\\sigma_{\\tau}$ 对残差进行加权，并计算参数协方差矩阵。在回归中约束 $a > 0$ 和 $p > 0$。\n\n3. 对于不确定性传播，考虑一个新的孔隙度测量值 $\\varepsilon$，其测量标准差 $\\sigma_{\\varepsilon}$ 已知。将 $a$ 和 $p$ 视为联合正态分布，其协方差来自拟合结果，并且与孔隙度测量误差无关。在一阶（线性）不确定性传播下，计算每个测试用例的 $D_{\\text{eff}}$ 的均值和标准差。\n\n请遵循以下测试套件。每个测试用例由一个三元组 $(\\varepsilon, \\sigma_{\\varepsilon}, D_{\\text{bulk}})$ 定义，其中 $D_{\\text{bulk}}$ 的单位必须是 $\\text{m}^2/\\text{s}$，输出 $D_{\\text{eff}}$ 及其标准差的单位也必须是 $\\text{m}^2/\\text{s}$：\n- 用例 1 (一般场景): $(0.60, 0.02, 2.0 \\times 10^{-10})$。\n- 用例 2 (高孔隙度边界): $(0.95, 0.01, 1.8 \\times 10^{-10})$。\n- 用例 3 (低孔隙度边缘): $(0.35, 0.03, 2.3 \\times 10^{-10})$。\n- 用例 4 (零孔隙度测量误差): $(0.70, 0.00, 2.0 \\times 10^{-10})$。\n\n您的程序必须：\n- 完全按照规定生成合成数据。\n- 使用适当的加权和正值约束来拟合 $a$ 和 $p$，并计算它们的协方差。\n- 使用一阶线性化为每个测试用例传播不确定性，以计算 $D_{\\text{eff}}$ 的点估计值和标准差。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n  $[ \\hat{a}, \\hat{p}, D_{\\text{eff,1}}, \\sigma_{D,1}, D_{\\text{eff,2}}, \\sigma_{D,2}, D_{\\text{eff,3}}, \\sigma_{D,3}, D_{\\text{eff,4}}, \\sigma_{D,4} ]$\n其中 $\\hat{a}$ 和 $\\hat{p}$ 是拟合参数，$D_{\\text{eff,k}}$ 是测试用例 $k$ 计算出的有效扩散系数（单位 $\\text{m}^2/\\text{s}$），$\\sigma_{D,k}$ 是其传播的标准差（单位 $\\text{m}^2/\\text{s}$）。所有输出必须是实数（浮点数）。\n\n不应打印任何其他输出或文本。",
            "solution": "我们从多孔电极理论和统计估计中完善建立的基础出发。多孔介质中的 Fick 第一扩散定律指出 $J = -D_{\\text{eff}} \\nabla c$，其中 $D_{\\text{eff}}$ 必须能体现微观结构对传输的阻碍。一个广泛使用的将有效性质与孔隙度和曲折度联系起来的表达式是 $D_{\\text{eff}} = (\\varepsilon/\\tau) D_{\\text{bulk}}$，其中 $D_{\\text{bulk}}$ 是自由溶液扩散系数，$\\tau$ 是一个无量纲的曲折度因子，且 $\\tau \\ge 1$ 和 $\\varepsilon \\in (0,1)$。\n\n一个包含微观结构信息的相关式假定 $ \\tau = 1 + a(1-\\varepsilon)^p$，其中未知参数 $a>0$ 和 $p>0$ 反映了其形貌特征。$a$ 和 $p$ 的估计需要对观测数据 $(\\varepsilon_i, \\tau_i^{\\text{obs}})$ 进行拟合，这些数据是通过已知的 $a_{\\text{true}}$ 和 $p_{\\text{true}}$ 以及在 $\\tau$ 上附加高斯噪声来人工合成的。使用已知的观测标准差 $\\sigma_{\\tau}$ 进行加权非线性最小二乘法，可以得到估计值 $\\hat{a}$ 和 $\\hat{p}$ 以及一个 $2 \\times 2$ 的参数协方差矩阵 $\\Sigma_{\\theta}$，其中参数向量为 $\\theta = (a,p)^{\\top}$。\n\n为了生成合成数据，我们定义孔隙度值 $\\varepsilon_i$ 并计算无噪声的曲折度 $\\tau_i^{\\text{true}} = 1 + a_{\\text{true}} (1 - \\varepsilon_i)^{p_{\\text{true}}}$。然后，我们添加独立的、服从 $\\mathcal{N}(0,\\sigma_{\\tau}^2)$ 分布的正态噪声 $\\eta_i$，形成 $\\tau_i^{\\text{obs}} = \\tau_i^{\\text{true}} + \\eta_i$。固定的伪随机生成器种子确保了可复现性。\n\n我们通过最小化加权平方和 $S(a,p) = \\sum_i \\left[ \\dfrac{\\tau_i^{\\text{obs}} - \\left(1 + a(1-\\varepsilon_i)^p\\right)}{\\sigma_{\\tau}} \\right]^2$ 来拟合 $a$ 和 $p$，约束条件为 $a>0$ 和 $p>0$，这通过约束非线性最小二乘法实现。在正则性条件下，参数协方差可近似为经过适当缩放的 $\\Sigma_{\\theta} \\approx (J^{\\top} W J)^{-1}$，其中 $J$ 是模型关于参数在解处求值的雅可比矩阵，$W$ 是由观测方差的倒数构成的对角权重矩阵。当提供具有绝对缩放的 $\\sigma_{\\tau}$ 时，像非线性最小二乘法这样的实用求解器会直接返回此协方差。\n\n为了将不确定性传播到具有已知测量标准差 $\\sigma_{\\varepsilon}$ 的新孔隙度测量值 $\\varepsilon$ 的 $D_{\\text{eff}}$ 上，我们计算函数\n$$\ng(a,p,\\varepsilon) = \\frac{\\varepsilon}{1 + a(1-\\varepsilon)^p},\n$$\n使得 $ D_{\\text{eff}} = D_{\\text{bulk}} \\, g(a,p,\\varepsilon)$。我们假设 $(a,p)$ 服从联合正态分布，其协方差为 $\\Sigma_{\\theta}$，并且与 $\\varepsilon$ 的测量误差无关，该误差被建模为 $\\varepsilon \\sim \\mathcal{N}(\\varepsilon_{\\text{meas}}, \\sigma_{\\varepsilon}^2)$。使用一阶（delta 方法）传播，$D_{\\text{eff}}$ 的方差为\n$$\n\\operatorname{Var}(D_{\\text{eff}}) \\approx \\nabla D_{\\text{eff}}^{\\top} \\, \\Sigma \\, \\nabla D_{\\text{eff}},\n$$\n其中 $\\Sigma$ 是结合了 $\\Sigma_{\\theta}$ 和 $\\sigma_{\\varepsilon}^2$ 的块对角协方差矩阵，$\\nabla D_{\\text{eff}}$ 是关于 $(a,p,\\varepsilon)$ 的梯度。记 $\\tau = 1 + a(1-\\varepsilon)^p$ 和 $g = \\varepsilon / \\tau$，计算梯度所需的偏导数如下。\n\n首先，计算 $\\tau$ 的导数：\n$$\n\\frac{\\partial \\tau}{\\partial a} = (1-\\varepsilon)^p, \\qquad\n\\frac{\\partial \\tau}{\\partial p} = a (1-\\varepsilon)^p \\ln(1-\\varepsilon), \\qquad\n\\frac{\\partial \\tau}{\\partial \\varepsilon} = -a p (1-\\varepsilon)^{p-1}.\n$$\n\n接着，对 $g = \\varepsilon \\tau^{-1}$ 求导：\n$$\n\\frac{\\partial g}{\\partial a} = -\\varepsilon \\frac{(1-\\varepsilon)^p}{\\tau^2}, \\qquad\n\\frac{\\partial g}{\\partial p} = -\\varepsilon \\frac{a (1-\\varepsilon)^p \\ln(1-\\varepsilon)}{\\tau^2}, \\qquad\n\\frac{\\partial g}{\\partial \\varepsilon} = \\frac{1}{\\tau} + \\varepsilon \\frac{a p (1-\\varepsilon)^{p-1}}{\\tau^2}.\n$$\n\n因为 $D_{\\text{eff}} = D_{\\text{bulk}} \\, g$，所以 $D_{\\text{eff}}$ 的梯度是\n$$\n\\frac{\\partial D_{\\text{eff}}}{\\partial a} = D_{\\text{bulk}} \\frac{\\partial g}{\\partial a}, \\quad\n\\frac{\\partial D_{\\text{eff}}}{\\partial p} = D_{\\text{bulk}} \\frac{\\partial g}{\\partial p}, \\quad\n\\frac{\\partial D_{\\text{eff}}}{\\partial \\varepsilon} = D_{\\text{bulk}} \\frac{\\partial g}{\\partial \\varepsilon}.\n$$\n\n设 $\\Sigma_{\\theta}$ 是 $(a,p)$ 的 $2 \\times 2$ 协方差矩阵，孔隙度测量方差为 $\\sigma_{\\varepsilon}^2$。如果假设独立性，总方差为\n$$\n\\operatorname{Var}(D_{\\text{eff}}) \\approx \n\\begin{bmatrix}\n\\frac{\\partial D_{\\text{eff}}}{\\partial a}  \\frac{\\partial D_{\\text{eff}}}{\\partial p}\n\\end{bmatrix}\n\\Sigma_{\\theta}\n\\begin{bmatrix}\n\\frac{\\partial D_{\\text{eff}}}{\\partial a} \\\\ \\frac{\\partial D_{\\text{eff}}}{\\partial p}\n\\end{bmatrix}\n+ \\left( \\frac{\\partial D_{\\text{eff}}}{\\partial \\varepsilon} \\right)^2 \\sigma_{\\varepsilon}^2.\n$$\n\n点估计值为 $ \\hat{D}_{\\text{eff}} = D_{\\text{bulk}} \\, g(\\hat{a},\\hat{p},\\varepsilon_{\\text{meas}})$，标准差为 $ \\sigma_{D} = \\sqrt{\\operatorname{Var}(D_{\\text{eff}})}$。\n\n算法计划：\n- 使用指定的真实参数 $a_{\\text{true}}$ 和 $p_{\\text{true}}$、孔隙度列表以及具有固定种子和标准差 $\\sigma_{\\tau}$ 的附加高斯噪声，生成合成的曲折度数据。\n- 使用带有约束 $a>0, p>0$ 的加权非线性最小二乘法将模型 $ \\tau(\\varepsilon; a,p)$ 拟合到含噪数据。使用已知的 $\\sigma_{\\tau}$ 作为权重（绝对缩放）以获得 $\\hat{a}$、$\\hat{p}$ 和 $\\Sigma_{\\theta}$。\n- 对于每个测试用例 $(\\varepsilon_{\\text{meas}}, \\sigma_{\\varepsilon}, D_{\\text{bulk}})$：\n  - 计算 $ \\tau = 1 + \\hat{a}(1-\\varepsilon_{\\text{meas}})^{\\hat{p}}$、$ g = \\varepsilon_{\\text{meas}}/\\tau$ 和 $ \\hat{D}_{\\text{eff}} = D_{\\text{bulk}} g$。\n  - 使用上述公式在 $(\\hat{a},\\hat{p},\\varepsilon_{\\text{meas}})$ 处求值，计算梯度分量。\n  - 假设独立性，使用块对角协方差计算方差，然后取平方根得到 $ \\sigma_{D}$。\n- 将最终结果汇总为指定的单行输出格式：$[ \\hat{a}, \\hat{p}, D_{\\text{eff,1}}, \\sigma_{D,1}, D_{\\text{eff,2}}, \\sigma_{D,2}, D_{\\text{eff,3}}, \\sigma_{D,3}, D_{\\text{eff,4}}, \\sigma_{D,4} ]$，其中所有扩散系数的单位均为 $\\text{m}^2/\\text{s}$。\n\n此过程将用于有效传输的基于物理的模型与符合统计学原理的参数估计和不确定性量化相结合，确保了与多孔电极理论 (Newman) 一致的可复现性和科学真实性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef tau_model(eps, a, p):\n    # Tortuosity model: tau = 1 + a (1 - eps)^p\n    return 1.0 + a * (1.0 - eps) ** p\n\ndef fit_parameters(eps_data, tau_obs, sigma_tau):\n    # Weighted nonlinear least squares with constraints a>0, p>0\n    p0 = [1.0, 2.0]  # Initial guess\n    bounds = (0.0, np.inf)\n    popt, pcov = curve_fit(\n        tau_model,\n        eps_data,\n        tau_obs,\n        p0=p0,\n        bounds=bounds,\n        sigma=np.full_like(eps_data, sigma_tau, dtype=float),\n        absolute_sigma=True,\n        maxfev=10000,\n    )\n    return popt, pcov\n\ndef deff_and_uncertainty(eps_meas, sigma_eps, D_bulk, a_hat, p_hat, Sigma_theta):\n    # Compute Deff and its propagated uncertainty via first-order (delta method)\n    tau = 1.0 + a_hat * (1.0 - eps_meas) ** p_hat\n    g = eps_meas / tau\n    Deff = D_bulk * g\n\n    # Gradients of g with respect to a, p, eps\n    one_minus_eps = 1.0 - eps_meas\n    # Handle log safely: ln(1 - eps), eps in (0,1) so 1-eps positive\n    ln_one_minus_eps = np.log(one_minus_eps)\n\n    # Partial derivatives of g\n    dg_da = -eps_meas * (one_minus_eps ** p_hat) / (tau ** 2)\n    dg_dp = -eps_meas * a_hat * (one_minus_eps ** p_hat) * ln_one_minus_eps / (tau ** 2)\n    # d tau / d eps = -a p (1 - eps)^(p - 1)\n    dg_deps = (1.0 / tau) + eps_meas * (a_hat * p_hat * (one_minus_eps ** (p_hat - 1.0))) / (tau ** 2)\n\n    # Gradient of Deff\n    dD_da = D_bulk * dg_da\n    dD_dp = D_bulk * dg_dp\n    dD_deps = D_bulk * dg_deps\n\n    # Variance from parameter covariance and independent epsilon measurement variance\n    grad_params = np.array([dD_da, dD_dp])\n    var_params = grad_params @ Sigma_theta @ grad_params\n    var_eps = (dD_deps ** 2) * (sigma_eps ** 2)\n    var_D = var_params + var_eps\n    sigma_D = np.sqrt(max(var_D, 0.0))  # guard against tiny negative due to numerics\n\n    return Deff, sigma_D\n\ndef solve():\n    # 1. Synthetic data generation parameters\n    a_true = 2.8\n    p_true = 1.7\n    eps_data = np.array([0.35, 0.40, 0.45, 0.50, 0.55, 0.60, 0.65, 0.70,\n                         0.75, 0.80, 0.82, 0.84, 0.86, 0.88], dtype=float)\n    sigma_tau = 0.03\n\n    # Generate noiseless tau and add Gaussian noise with fixed seed\n    rng = np.random.default_rng(123)\n    tau_true = tau_model(eps_data, a_true, p_true)\n    tau_obs = tau_true + rng.normal(loc=0.0, scale=sigma_tau, size=eps_data.shape)\n\n    # 2. Fit parameters and get covariance\n    popt, pcov = fit_parameters(eps_data, tau_obs, sigma_tau)\n    a_hat, p_hat = float(popt[0]), float(popt[1])\n    Sigma_theta = pcov  # 2x2 covariance for (a, p)\n\n    # 3. Test suite: (eps_meas, sigma_eps, D_bulk [m^2/s])\n    test_cases = [\n        (0.60, 0.02, 2.0e-10),  # Case 1: general scenario\n        (0.95, 0.01, 1.8e-10),  # Case 2: high porosity boundary\n        (0.35, 0.03, 2.3e-10),  # Case 3: low porosity edge\n        (0.70, 0.00, 2.0e-10),  # Case 4: zero porosity measurement error\n    ]\n\n    results = [a_hat, p_hat]\n    for eps_meas, sigma_eps, D_bulk in test_cases:\n        Deff, sigma_D = deff_and_uncertainty(eps_meas, sigma_eps, D_bulk, a_hat, p_hat, Sigma_theta)\n        results.append(Deff)\n        results.append(sigma_D)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}