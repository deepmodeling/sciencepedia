{
    "hands_on_practices": [
        {
            "introduction": "A central question in simulating proton-coupled electron transfer is how to treat the proton, given its light mass. This exercise provides a foundational check on the validity of a purely classical treatment by comparing the proton's quantum mechanical zero-point kinetic energy with its classical thermal energy. By performing this calculation for a typical O–H vibrational mode, you will quantify the magnitude of nuclear quantum effects and understand why they are a critical consideration in AIMD simulations of hydrogen-containing systems .",
            "id": "4236281",
            "problem": "In Ab Initio Molecular Dynamics (AIMD) simulations of Proton-Coupled Electron Transfer (PCET), a central modeling decision is whether to treat the proton as a classical particle or to include nuclear quantum effects. Consider the one-dimensional O–H stretching mode along the hydrogen bond as a harmonic oscillator governing the dominant component of proton motion near the reactant minimum. Starting from the time-independent Schrödinger equation for a one-dimensional harmonic potential, with Hamiltonian $H = \\frac{p^{2}}{2\\mu} + \\frac{1}{2}\\mu \\omega^{2} x^{2}$, derive the expectation value of the kinetic energy in the ground vibrational state and express it in terms of $\\hbar$ and $\\omega$. Then, for a solvated O–H stretch characterized by a wavenumber $\\tilde{\\nu} = 3400\\,\\mathrm{cm}^{-1}$ at temperature $T = 300\\,\\mathrm{K}$, compute the dimensionless ratio\n$$R = \\frac{\\text{quantum ground-state kinetic energy of the O–H mode}}{\\text{classical equipartition kinetic energy for one quadratic degree of freedom}}.$$\nUse the relations between wavenumber and angular frequency appropriate for harmonic motion, and fundamental constants $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$, $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$. Report $R$ as a pure number (dimensionless) and round your answer to three significant figures.",
            "solution": "The problem is first validated and found to be scientifically grounded, well-posed, and objective. It presents a standard comparison between quantum and classical mechanics for a high-frequency molecular vibration, a relevant topic in computational chemistry. All necessary data are provided, and there are no contradictions or ambiguities.\n\nThe problem asks for two tasks: first, to derive the expectation value of the kinetic energy for the ground state of a one-dimensional quantum harmonic oscillator (QHO), and second, to compute the ratio of this quantum kinetic energy to the classical thermal kinetic energy for a specific O–H stretching mode.\n\nFirst, we derive the quantum kinetic energy. The Hamiltonian for the one-dimensional harmonic oscillator is given as:\n$$\nH = \\frac{p^{2}}{2\\mu} + \\frac{1}{2}\\mu \\omega^{2} x^{2}\n$$\nThis can be written as the sum of a kinetic energy operator, $T = \\frac{p^{2}}{2\\mu}$, and a potential energy operator, $V = \\frac{1}{2}\\mu \\omega^{2} x^{2}$.\n\nThe energy eigenvalues for the QHO are given by $E_n = \\left(n + \\frac{1}{2}\\right)\\hbar\\omega$, where $n$ is the vibrational quantum number ($n = 0, 1, 2, \\dots$). For the ground vibrational state, $n=0$, and the total energy is:\n$$\nE_0 = \\frac{1}{2}\\hbar\\omega\n$$\nTo find the expectation value of the kinetic energy, $\\langle T \\rangle$, we can invoke the virial theorem. For a potential of the form $V(x) \\propto x^k$, the virial theorem states that $2\\langle T \\rangle = k \\langle V \\rangle$. The harmonic oscillator potential has $k=2$, so the theorem simplifies to $2\\langle T \\rangle = 2\\langle V \\rangle$, which means $\\langle T \\rangle = \\langle V \\rangle$.\n\nThe total energy of the system in any eigenstate $|n\\rangle$ is the sum of the expectation values of the kinetic and potential energies:\n$$\nE_n = \\langle H \\rangle_n = \\langle T \\rangle_n + \\langle V \\rangle_n\n$$\nUsing the result from the virial theorem, $\\langle V \\rangle_n = \\langle T \\rangle_n$, we can write:\n$$\nE_n = \\langle T \\rangle_n + \\langle T \\rangle_n = 2\\langle T \\rangle_n\n$$\nTherefore, the expectation value of the kinetic energy is half the total energy:\n$$\n\\langle T \\rangle_n = \\frac{1}{2} E_n\n$$\nFor the ground state ($n=0$), the quantum kinetic energy, which we denote $\\langle T \\rangle_{\\text{quantum}}$, is:\n$$\n\\langle T \\rangle_{\\text{quantum}} = \\langle T \\rangle_0 = \\frac{1}{2} E_0 = \\frac{1}{2} \\left(\\frac{1}{2}\\hbar\\omega\\right) = \\frac{1}{4}\\hbar\\omega\n$$\nThis expression is in terms of $\\hbar$ and $\\omega$, as required.\n\nNext, we determine the classical kinetic energy for one quadratic degree of freedom. According to the classical equipartition theorem, for a system in thermal equilibrium at temperature $T$, every quadratic degree of freedom in the Hamiltonian contributes an average energy of $\\frac{1}{2}k_B T$. The kinetic energy for one-dimensional motion, $\\frac{p^2}{2\\mu}$, is a single quadratic term in the momentum $p$. Therefore, the classical average kinetic energy, denoted $\\langle T \\rangle_{\\text{classical}}$, is:\n$$\n\\langle T \\rangle_{\\text{classical}} = \\frac{1}{2}k_B T\n$$\nNow, we can compute the dimensionless ratio $R$:\n$$\nR = \\frac{\\text{quantum ground-state kinetic energy}}{\\text{classical equipartition kinetic energy}} = \\frac{\\langle T \\rangle_{\\text{quantum}}}{\\langle T \\rangle_{\\text{classical}}} = \\frac{\\frac{1}{4}\\hbar\\omega}{\\frac{1}{2}k_B T} = \\frac{\\hbar\\omega}{2k_B T}\n$$\nTo perform the numerical calculation, we must express $\\hbar\\omega$ in terms of the given wavenumber $\\tilde{\\nu}$. The angular frequency $\\omega$ is related to the frequency $f$ by $\\omega = 2\\pi f$. The frequency is related to the wavenumber $\\tilde{\\nu}$ and the speed of light $c$ by $f = c\\tilde{\\nu}$. Thus, $\\omega = 2\\pi c \\tilde{\\nu}$. The reduced Planck constant is $\\hbar = \\frac{h}{2\\pi}$. Substituting these into the expression for $R$:\n$$\nR = \\frac{\\left(\\frac{h}{2\\pi}\\right)(2\\pi c \\tilde{\\nu})}{2k_B T} = \\frac{h c \\tilde{\\nu}}{2k_B T}\n$$\nWe can now substitute the given numerical values:\n$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n$c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$\n$\\tilde{\\nu} = 3400\\,\\mathrm{cm}^{-1}$\n$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n$T = 300\\,\\mathrm{K}$\n\nPlugging these values into the expression for $R$:\n$$\nR = \\frac{(6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}) (2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}) (3400\\,\\mathrm{cm}^{-1})}{2 (1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) (300\\,\\mathrm{K})}\n$$\nThe units of $\\mathrm{cm^{-1}}$ and $\\mathrm{cm}$ in the numerator cancel, leaving units of $\\mathrm{J\\cdot s \\cdot s^{-1} = J}$. The units in the denominator are $\\mathrm{J\\cdot K^{-1} \\cdot K = J}$. The ratio is dimensionless, as expected.\n\nCalculating the numerator:\n$h c \\tilde{\\nu} = (6.62607015 \\times 10^{-34}) \\times (2.99792458 \\times 10^{10}) \\times 3400 \\approx 6.754059 \\times 10^{-20}\\,\\mathrm{J}$\n\nCalculating the denominator:\n$2 k_B T = 2 \\times (1.380649 \\times 10^{-23}) \\times 300 \\approx 8.283894 \\times 10^{-21}\\,\\mathrm{J}$\n\nComputing the ratio:\n$$\nR = \\frac{6.754059 \\times 10^{-20}}{8.283894 \\times 10^{-21}} \\approx 8.153406\n$$\nRounding the result to three significant figures gives $8.15$. The substantial deviation of this ratio from $1$ underscores the importance of including nuclear quantum effects for high-frequency modes like the O–H stretch, even at room temperature.",
            "answer": "$$\n\\boxed{8.15}\n$$"
        },
        {
            "introduction": "While AIMD simulations aim for physical realism, practical considerations often necessitate approximations. One common technique to enable larger integration time steps is to artificially increase the mass of hydrogen atoms. This practice explores the dynamical consequences of such mass scaling by using classical rate theories to derive how reaction rates are systematically altered. By applying Transition State Theory and Kramers' theory to a model proton transfer reaction, you will gain a quantitative understanding of the trade-off between computational cost and dynamical accuracy .",
            "id": "4236308",
            "problem": "Consider a one-dimensional reaction coordinate $x$ representing the transferring proton in an Ab Initio Molecular Dynamics (AIMD) model of Proton-Coupled Electron Transfer (PCET) in the adiabatic limit, where electronic reorganization is fast compared to the nuclear motion and the electron effectively follows the proton coordinate. The proton moves in a symmetric double-well quartic potential $U(x)$ that approximates a hydrogen-bonded donor-acceptor axis:\n$$U(x) = a\\,(x^2 - b^2)^2,$$\nwhere $a$ is a stiffness parameter with units $\\mathrm{J}/\\mathrm{m}^4$ and $b$ sets the well positions with units $\\mathrm{m}$. The system is maintained at a fixed temperature $T$ by a thermostat implementing Langevin dynamics with a constant friction coefficient $\\gamma$ having units $\\mathrm{s}^{-1}$. The baseline proton mass is $m$ in $\\mathrm{kg}$. Artificial mass scaling used in AIMD can be represented by $m' = s \\cdot m$ with a dimensionless scaling factor $s > 0$.\n\nFrom first principles, start from Newton’s second law and a classical canonical ensemble for the reactant well. Use classical Transition State Theory (TST) and Kramers’ barrier crossing theory to derive expressions for the rate of barrier crossing. You must base your derivation on the following fundamental elements only:\n- Newton’s second law $m\\,\\ddot{x} = -\\partial U/\\partial x - m\\,\\gamma\\,\\dot{x} + \\xi(t)$, where $\\xi(t)$ is a Gaussian stochastic force satisfying fluctuation-dissipation at temperature $T$.\n- The classical canonical distribution $\\rho(x,v) \\propto \\exp\\left(-\\beta\\left(\\tfrac{1}{2}m v^2 + U(x)\\right)\\right)$ with $\\beta = 1/(k_{\\mathrm{B}} T)$, where $k_{\\mathrm{B}}$ is the Boltzmann constant.\n- The definition of the TST flux through a dividing surface at the barrier top $x = 0$.\n- The Kramers rate expression for a one-dimensional barrier crossing under Langevin dynamics in the moderate-to-high friction regimes.\n\nDerive the following intermediate physical quantities for the quartic potential $U(x)$:\n- The barrier height $\\Delta E = U(0) - U(b)$ expressed in terms of $a$ and $b$.\n- The curvature $U''(x)$ at the reactant minimum $x = b$ and at the barrier top $x = 0$, and the associated angular frequencies $\\omega_{\\mathrm{min}}$ and $\\omega_{\\mathrm{b}}$ defined by $\\omega_{\\mathrm{min}} = \\sqrt{U''(b)/m}$ and $\\omega_{\\mathrm{b}} = \\sqrt{|U''(0)|/m}$.\n\nUsing only these principles, construct expressions for the classical TST rate $k_{\\mathrm{TST}}(m)$ and the Kramers rate $k_{\\mathrm{K}}(m,\\gamma)$ for barrier crossing in this quartic potential. Then, for a given mass scaling factor $s$, compute the ratios\n$$R_{\\mathrm{TST}}(s) = \\frac{k_{\\mathrm{TST}}(m')}{k_{\\mathrm{TST}}(m)}, \\quad R_{\\mathrm{K}}(s) = \\frac{k_{\\mathrm{K}}(m',\\gamma)}{k_{\\mathrm{K}}(m,\\gamma)},$$\nto quantify how artificial mass scaling biases dynamical rates relative to the baseline physical mass.\n\nYou must implement a program that, for each test case specified below, computes and outputs the pair $[R_{\\mathrm{TST}}(s), R_{\\mathrm{K}}(s)]$ as floating-point numbers. All parameters are provided in International System of Units (SI). Energies in the derivations should be treated in joules. The final outputs are dimensionless ratios and therefore unitless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the form $[R_{\\mathrm{TST}}(s),R_{\\mathrm{K}}(s)]$.\n\nUse the Boltzmann constant $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J}/\\mathrm{K}$. In all cases, the proton baseline mass should be taken as $m = 1.00784\\,\\mathrm{amu}$ converted to $\\mathrm{kg}$ using $1\\,\\mathrm{amu} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$.\n\nTest suite:\n- Case $1$ (happy path, moderate friction): $a = 7.68\\times 10^{21}\\,\\mathrm{J}/\\mathrm{m}^4$, $b = 5.0\\times 10^{-11}\\,\\mathrm{m}$, $T = 300\\,\\mathrm{K}$, $\\gamma = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $s = 4.0$.\n- Case $2$ (boundary, frictionless): same $a$, $b$, $T$ as case $1$, $\\gamma = 0.0\\,\\mathrm{s}^{-1}$, $s = 9.0$.\n- Case $3$ (edge, high friction): same $a$, $b$, $T$ as case $1$, $\\gamma = 5.0\\times 10^{15}\\,\\mathrm{s}^{-1}$, $s = 4.0$.\n- Case $4$ (different barrier height): $a = 2.5632\\times 10^{21}\\,\\mathrm{J}/\\mathrm{m}^4$, $b = 5.0\\times 10^{-11}\\,\\mathrm{m}$, $T = 300\\,\\mathrm{K}$, $\\gamma = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $s = 16.0$.\n\nYour program must compute $R_{\\mathrm{TST}}(s)$ and $R_{\\mathrm{K}}(s)$ for each case and output them as:\n\"[[r_{1,\\mathrm{TST}},r_{1,\\mathrm{K}}],[r_{2,\\mathrm{TST}},r_{2,\\mathrm{K}}],[r_{3,\\mathrm{TST}},r_{3,\\mathrm{K}}],[r_{4,\\mathrm{TST}},r_{4,\\mathrm{K}}]]\".",
            "solution": "The problem requires the derivation of classical rate expressions for barrier crossing in a symmetric quartic double-well potential and the subsequent calculation of the effect of artificial mass scaling on these rates. The derivation must start from fundamental principles of statistical mechanics and reaction rate theory.\n\n**Step 1: Problem Validation**\n\nThe problem provides a self-contained, scientifically grounded description of proton transfer in a model potential landscape. The potential $U(x) = a\\,(x^2 - b^2)^2$ is a standard representation of a double-well system. The use of Langevin dynamics, Transition State Theory (TST), and Kramers' theory are pillars of chemical physics. All parameters ($a, b, T, \\gamma, s, m$) are defined, and necessary physical constants ($k_{\\mathrm{B}}$, amu-to-kg conversion) are provided. The test cases cover different physical regimes (moderate friction, frictionless, high friction) and potential parameters, allowing for a comprehensive test of the derived expressions. The problem is well-posed, objective, and free from scientific or logical flaws. The case with $\\gamma = 0\\,\\mathrm{s}^{-1}$ represents the frictionless limit, where the Kramers rate is expected to converge to the TST rate. This is a valid physical limit, not a flaw. Therefore, the problem is deemed valid and a full solution will be provided.\n\n**Step 2: Derivation of Intermediate Physical Quantities**\n\nThe potential energy is given by $U(x) = a(x^2 - b^2)^2 = a(x^4 - 2b^2x^2 + b^4)$.\nThe force is $F(x) = -\\frac{\\partial U}{\\partial x} = -a(4x^3 - 4b^2x) = -4ax(x^2 - b^2)$. The extrema of the potential are where $F(x) = 0$, which occurs at $x=0$ and $x=\\pm b$.\n\nThe second derivative of the potential, $U''(x)$, determines the curvature:\n$$U''(x) = \\frac{\\partial^2 U}{\\partial x^2} = a(12x^2 - 4b^2)$$\n\n- **Reactant Minima and Barrier Top:**\nThe minima are at $x = \\pm b$, where $U(\\pm b) = a(b^2 - b^2)^2 = 0$. The barrier is at $x=0$, where $U(0) = a(0 - b^2)^2 = ab^4$.\n\n- **Barrier Height ($\\Delta E$):**\nThe barrier height is the potential energy difference between the transition state (barrier top) and the reactant state (well minimum).\n$$\\Delta E = U(0) - U(b) = ab^4 - 0 = ab^4$$\n\n- **Curvatures and Frequencies:**\nThe curvature at the reactant minimum (e.g., $x=b$) is:\n$$U''(b) = a(12b^2 - 4b^2) = 8ab^2$$\nSince $U''(b) > 0$, this is indeed a minimum. The associated angular frequency is $\\omega_{\\mathrm{min}}$:\n$$\\omega_{\\mathrm{min}} = \\sqrt{\\frac{U''(b)}{m}} = \\sqrt{\\frac{8ab^2}{m}}$$\n\nThe curvature at the barrier top ($x=0$) is:\n$$U''(0) = a(12(0)^2 - 4b^2) = -4ab^2$$\nSince $U''(0) < 0$, this is a maximum. The associated imaginary frequency at the barrier is related to $\\omega_{\\mathrm{b}}$:\n$$\\omega_{\\mathrm{b}} = \\sqrt{\\frac{|U''(0)|}{m}} = \\sqrt{\\frac{4ab^2}{m}}$$\n\n**Step 3: Derivation of Rate Expressions and Scaling Ratios**\n\n**Transition State Theory (TST) Rate, $k_{\\mathrm{TST}}$**\n\nThe classical TST rate is given by the expression $k_{\\mathrm{TST}} = \\frac{\\omega_{\\mathrm{min}}}{2\\pi}e^{-\\beta\\Delta E}$. This is derived by calculating the one-way flux of particles crossing the barrier at $x=0$, assuming a canonical distribution for the reactants in the well. The reactants' partition function is approximated harmonically around the minimum, leading to the prefactor involving $\\omega_{\\mathrm{min}}$.\nSubstituting the derived quantities:\n$$k_{\\mathrm{TST}}(m) = \\frac{1}{2\\pi} \\sqrt{\\frac{8ab^2}{m}} e^{-\\beta ab^4}$$\nThe rate depends on the mass $m$ through the frequency term: $k_{\\mathrm{TST}} \\propto 1/\\sqrt{m}$.\n\nFor a scaled mass $m' = s \\cdot m$, the new rate $k_{\\mathrm{TST}}(m')$ is:\n$$k_{\\mathrm{TST}}(m') = \\frac{1}{2\\pi} \\sqrt{\\frac{8ab^2}{sm}} e^{-\\beta ab^4} = \\frac{1}{\\sqrt{s}} \\left( \\frac{1}{2\\pi} \\sqrt{\\frac{8ab^2}{m}} e^{-\\beta ab^4} \\right) = \\frac{k_{\\mathrm{TST}}(m)}{\\sqrt{s}}$$\nThe ratio $R_{\\mathrm{TST}}(s)$ is therefore:\n$$R_{\\mathrm{TST}}(s) = \\frac{k_{\\mathrm{TST}}(m')}{k_{\\mathrm{TST}}(m)} = \\frac{1}{\\sqrt{s}}$$\n\n**Kramers' Rate, $k_{\\mathrm{K}}$**\n\nKramers' theory accounts for recrossing events at the barrier due to solvent friction, which are neglected in TST. The rate is given by $k_{\\mathrm{K}} = \\kappa \\cdot k_{\\mathrm{TST}}$, where $\\kappa$ is the transmission coefficient. For Langevin dynamics, $\\kappa$ is derived from the unstable mode of motion at the barrier top. The linearized Langevin equation at $x=0$ is $m\\ddot{x} = -U''(0)x - m\\gamma\\dot{x} = m\\omega_{\\mathrm{b}}^2 x - m\\gamma\\dot{x}$. The positive characteristic root of this equation, $\\lambda_+$, gives the rate of escape from the barrier.\nSolving the characteristic equation $\\lambda^2 + \\gamma\\lambda - \\omega_{\\mathrm{b}}^2 = 0$ yields $\\lambda_+ = \\frac{1}{2}(-\\gamma + \\sqrt{\\gamma^2 + 4\\omega_{\\mathrm{b}}^2})$.\nThus, the transmission coefficient is:\n$$\\kappa(m, \\gamma) = \\frac{\\lambda_+}{\\omega_{\\mathrm{b}}} = \\frac{-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2}}{\\omega_{\\mathrm{b}}}$$\nThe full Kramers rate is:\n$$k_{\\mathrm{K}}(m, \\gamma) = k_{\\mathrm{TST}}(m) \\cdot \\kappa(m, \\gamma) = \\left(\\frac{\\omega_{\\mathrm{min}}}{2\\pi}e^{-\\beta\\Delta E}\\right) \\left(\\frac{-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2}}{\\omega_{\\mathrm{b}}}\\right)$$\n\nTo find the scaling ratio $R_{\\mathrm{K}}(s)$, we analyze the mass dependence. The frequencies $\\omega_{\\mathrm{min}}$ and $\\omega_{\\mathrm{b}}$ both scale as $1/\\sqrt{m}$. Let $\\omega_{\\mathrm{b}}' \\equiv \\omega_{\\mathrm{b}}(m')$ and $\\omega_{\\mathrm{b}} \\equiv \\omega_{\\mathrm{b}}(m)$. We have $\\omega_{\\mathrm{b}}' = \\omega_{\\mathrm{b}}/\\sqrt{s}$.\n$$R_{\\mathrm{K}}(s) = \\frac{k_{\\mathrm{K}}(m', \\gamma)}{k_{\\mathrm{K}}(m, \\gamma)} = \\frac{k_{\\mathrm{TST}}(m') \\kappa(m', \\gamma)}{k_{\\mathrm{TST}}(m) \\kappa(m, \\gamma)} = R_{\\mathrm{TST}}(s) \\frac{\\kappa(m', \\gamma)}{\\kappa(m, \\gamma)} = \\frac{1}{\\sqrt{s}} \\frac{\\kappa(m', \\gamma)}{\\kappa(m, \\gamma)}$$\nThe ratio of transmission coefficients is:\n$$\\frac{\\kappa(m', \\gamma)}{\\kappa(m, \\gamma)} = \\frac{(-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + (\\omega_{\\mathrm{b}}')^2}) / \\omega_{\\mathrm{b}}'}{(-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2}) / \\omega_{\\mathrm{b}}} = \\frac{\\omega_{\\mathrm{b}}}{\\omega_{\\mathrm{b}}'} \\frac{-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2/s}}{-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2}} = \\sqrt{s} \\frac{-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2/s}}{-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2}}$$\nSubstituting this back into the expression for $R_{\\mathrm{K}}(s)$:\n$$R_{\\mathrm{K}}(s) = \\frac{1}{\\sqrt{s}} \\cdot \\left(\\sqrt{s} \\frac{-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2/s}}{-\\gamma/2 + \\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2}}\\right) = \\frac{\\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}(m)^2/s} - \\gamma/2}{\\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}(m)^2} - \\gamma/2}$$\nThis expression is valid for all $\\gamma \\ge 0$. In the limit $\\gamma \\to 0$, the numerator becomes $\\sqrt{\\omega_{\\mathrm{b}}^2/s} = \\omega_{\\mathrm{b}}/\\sqrt{s}$ and the denominator becomes $\\sqrt{\\omega_{\\mathrm{b}}^2} = \\omega_{\\mathrm{b}}$. The ratio becomes $1/\\sqrt{s}$, which is equal to $R_{\\mathrm{TST}}(s)$, as expected since $k_{\\mathrm{K}} \\to k_{\\mathrm{TST}}$ when $\\gamma \\to 0$.\n\n**Summary of Final Expressions for Computation:**\n\n1.  Proton mass: $m = 1.00784 \\times 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$.\n2.  Barrier frequency squared for baseline mass: $\\omega_{\\mathrm{b}}^2 = \\frac{4ab^2}{m}$.\n3.  TST ratio: $R_{\\mathrm{TST}}(s) = 1/\\sqrt{s}$.\n4.  Kramers ratio: $R_{\\mathrm{K}}(s) = \\frac{\\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2/s} - \\gamma/2}{\\sqrt{(\\gamma/2)^2 + \\omega_{\\mathrm{b}}^2} - \\gamma/2}$. If $\\gamma=0$, this simplifies to $1/\\sqrt{s}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mass-scaling ratios for TST and Kramers rates for a proton\n    crossing a quartic double-well potential.\n    \"\"\"\n    # Define physical constants\n    M_P_AMU = 1.00784  # amu\n    AMU_TO_KG = 1.66053906660e-27  # kg/amu\n    K_B = 1.380649e-23  # J/K\n\n    # Baseline proton mass in kg\n    m_p = M_P_AMU * AMU_TO_KG\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, moderate friction)\n        {'a': 7.68e21, 'b': 5.0e-11, 'T': 300.0, 'gamma': 1.0e13, 's': 4.0},\n        # Case 2 (boundary, frictionless)\n        {'a': 7.68e21, 'b': 5.0e-11, 'T': 300.0, 'gamma': 0.0, 's': 9.0},\n        # Case 3 (edge, high friction)\n        {'a': 7.68e21, 'b': 5.0e-11, 'T': 300.0, 'gamma': 5.0e15, 's': 4.0},\n        # Case 4 (different barrier height)\n        {'a': 2.5632e21, 'b': 5.0e-11, 'T': 300.0, 'gamma': 1.0e13, 's': 16.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        a = case['a']\n        b = case['b']\n        gamma = case['gamma']\n        s = case['s']\n\n        # Calculate R_TST(s)\n        # R_TST(s) = 1 / sqrt(s)\n        r_tst = 1.0 / np.sqrt(s)\n\n        # Calculate R_K(s, gamma)\n        if gamma == 0.0:\n            # In the frictionless limit, Kramers rate equals TST rate,\n            # so their scaling ratios are also equal.\n            r_k = r_tst\n        else:\n            # Calculate the square of the barrier frequency for the baseline mass\n            # omega_b^2 = 4*a*b^2 / m\n            omega_b_sq = (4.0 * a * b**2) / m_p\n            \n            # The derived expression for the Kramers ratio is:\n            # R_K(s) = (sqrt((gamma/2)^2 + omega_b^2/s) - gamma/2) / \n            #          (sqrt((gamma/2)^2 + omega_b^2)   - gamma/2)\n            \n            gamma_over_2 = gamma / 2.0\n            gamma_over_2_sq = gamma_over_2**2\n\n            numerator = np.sqrt(gamma_over_2_sq + omega_b_sq / s) - gamma_over_2\n            denominator = np.sqrt(gamma_over_2_sq + omega_b_sq) - gamma_over_2\n            \n            # Denominator should not be zero for non-zero a, b\n            if denominator == 0:\n                # This case should not be reached given the physics\n                # but is included for robustness.\n                # If it occurs, it implies very low omega_b relative to machine epsilon\n                # in which case the high-friction limit 1/s applies.\n                r_k = 1.0 / s\n            else:\n                r_k = numerator / denominator\n\n        results.append(f\"[{r_tst},{r_k}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The free energy barrier is a key outcome of AIMD simulations, but its temperature dependence holds deeper thermodynamic information. This practice guides you through the process of decomposing the free energy of activation ($F^\\ddagger$) into its enthalpic ($\\Delta H^\\ddagger$) and entropic ($\\Delta S^\\ddagger$) components by analyzing simulation data gathered at multiple temperatures. By performing a weighted linear regression on a set of hypothetical free energy barriers, you will learn how to determine whether a reaction's bottleneck is dominated by energetic costs or by changes in molecular ordering and solvent configuration .",
            "id": "4236263",
            "problem": "You are studying Proton-Coupled Electron Transfer (PCET) barriers using Ab Initio Molecular Dynamics (AIMD) simulations. In this setting, the barrier free energy is defined via classical statistical mechanics by the canonical partition function $Z$ and the Gibbs free energy $G$, where $G = H - TS$ and $F^\\ddagger(T)$ is the free energy barrier computed as the Gibbs free energy difference between the transition state ensemble and the reactant basin. Under a scientifically reasonable and widely used approximation for a narrow temperature window (namely, that the change in heat capacity across the barrier is negligible, so that the barrier’s enthalpy and entropy are temperature-independent over that window), the temperature dependence of the barrier free energy can be treated as linear in $T$, with an intercept equal to the enthalpic contribution and a slope related to the entropic contribution.\n\nFrom first principles, assume:\n- Canonical ensemble thermodynamics with the partition function $Z$ and $G = -k_\\mathrm{B} T \\ln Z$ for each constrained ensemble along the reaction coordinate, where $k_\\mathrm{B}$ is the Boltzmann constant.\n- The barrier free energy $F^\\ddagger(T)$ is a temperature-dependent observable computed independently at each temperature from the Potential of Mean Force (PMF).\n- Over the specified temperature ranges, the barrier’s enthalpy and entropy contributions are effectively constant, leading to a linear relation in $T$ whose intercept equals the enthalpic contribution $\\Delta H^\\ddagger$ (in $\\mathrm{kJ/mol}$) and whose slope (in $\\mathrm{kJ/mol/K}$) is the negative of the entropic contribution per kelvin, which should be reported in $\\mathrm{J/mol/K}$ by appropriate unit conversion.\n\nYour task is to:\n- For each provided dataset, perform a weighted least-squares linear fit of barrier free energy versus temperature, using weights $w_i = 1/\\sigma_i^2$, where $\\sigma_i$ is the standard deviation of the barrier estimate at temperature $T_i$ (both $F^\\ddagger$ and $\\sigma$ in $\\mathrm{kJ/mol}$, $T$ in $\\mathrm{K}$).\n- Extract the enthalpic contribution $\\Delta H^\\ddagger$ (the intercept, in $\\mathrm{kJ/mol}$) and the entropic contribution $\\Delta S^\\ddagger$ (equal to the negative of the slope, converted to $\\mathrm{J/mol/K}$).\n- Compute the barrier free energy at the reference temperature $T_\\mathrm{ref} = 298\\ \\mathrm{K}$ as $F^\\ddagger(298\\ \\mathrm{K})$ in $\\mathrm{kJ/mol}$ by evaluating the fitted linear relation at $T = 298\\ \\mathrm{K}$.\n\nExpress $\\Delta H^\\ddagger$ in $\\mathrm{kJ/mol}$, $\\Delta S^\\ddagger$ in $\\mathrm{J/mol/K}$, and $F^\\ddagger(298\\ \\mathrm{K})$ in $\\mathrm{kJ/mol}$. Round $\\Delta H^\\ddagger$ and $F^\\ddagger(298\\ \\mathrm{K})$ to $3$ decimal places, and round $\\Delta S^\\ddagger$ to $1$ decimal place.\n\nUse the following test suite of datasets, each consisting of temperatures $T_i$ (in $\\mathrm{K}$), barrier free energies $F^\\ddagger(T_i)$ (in $\\mathrm{kJ/mol}$), and uncertainties $\\sigma_i$ (in $\\mathrm{kJ/mol}$):\n\n- Dataset $1$ (balanced PCET, moderate positive entropy):\n  - $T$: $[280, 300, 320, 340]$\n  - $F^\\ddagger$: $[39.4, 39.0, 38.6, 38.2]$\n  - $\\sigma$: $[0.2, 0.15, 0.2, 0.25]$\n\n- Dataset $2$ (entropically unfavorable, negative entropy):\n  - $T$: $[250, 300, 350]$\n  - $F^\\ddagger$: $[40.0, 42.0, 44.0]$\n  - $\\sigma$: $[0.1, 0.1, 0.1]$\n\n- Dataset $3$ (small temperature window, weak positive entropy):\n  - $T$: $[295, 300, 305]$\n  - $F^\\ddagger$: $[53.525, 53.5, 53.475]$\n  - $\\sigma$: $[0.05, 0.2, 0.05]$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order for each dataset: $\\Delta H^\\ddagger$ (in $\\mathrm{kJ/mol}$, $3$ decimals), $\\Delta S^\\ddagger$ (in $\\mathrm{J/mol/K}$, $1$ decimal), and $F^\\ddagger(298\\ \\mathrm{K})$ (in $\\mathrm{kJ/mol}$, $3$ decimals). Thus, for three datasets, the output must be of the form:\n$[\\Delta H^\\ddagger_1,\\Delta S^\\ddagger_1,F^\\ddagger_1(298\\ \\mathrm{K}),\\Delta H^\\ddagger_2,\\Delta S^\\ddagger_2,F^\\ddagger_2(298\\ \\mathrm{K}),\\Delta H^\\ddagger_3,\\Delta S^\\ddagger_3,F^\\ddagger_3(298\\ \\mathrm{K})]$.",
            "solution": "The problem requires the determination of the enthalpic ($\\Delta H^\\ddagger$), entropic ($\\Delta S^\\ddagger$), and free energy barrier at a reference temperature ($F^\\ddagger(298\\ \\mathrm{K})$) for a proton-coupled electron transfer (PCET) process, based on simulated data. The data consists of barrier free energies, $F^\\ddagger(T_i)$, and their standard deviations, $\\sigma_i$, at several temperatures, $T_i$.\n\nThe core physical assumption is that over the narrow temperature range of the simulations, the change in heat capacity upon reaching the transition state is negligible. This implies that the enthalpic contribution, $\\Delta H^\\ddagger$, and entropic contribution, $\\Delta S^\\ddagger$, to the free energy barrier are effectively constant. The Gibbs free energy barrier, $F^\\ddagger(T)$, is thus a linear function of temperature, $T$:\n$$ F^\\ddagger(T) = \\Delta H^\\ddagger - T \\Delta S^\\ddagger $$\nThis equation is in the form of a linear model, $y = c + mx$, where:\n- The dependent variable is the free energy barrier, $y = F^\\ddagger(T)$.\n- The independent variable is the temperature, $x = T$.\n- The intercept is the enthalpic contribution, $c = \\Delta H^\\ddagger$.\n- The slope is the negative of the entropic contribution, $m = -\\Delta S^\\ddagger$.\n\nTo determine the best-fit values for the parameters $\\Delta H^\\ddagger$ and $\\Delta S^\\ddagger$ from the provided data points $(T_i, F^\\ddagger(T_i))$ with associated uncertainties $\\sigma_i$, we employ the method of weighted least-squares (WLS) linear regression. This method minimizes the weighted sum of the squares of the residuals, $\\chi^2$, where each point's contribution to the sum is inversely proportional to the variance of its measurement, $\\sigma_i^2$. The weights, $w_i$, are therefore defined as $w_i = 1/\\sigma_i^2$.\n\nThe quantity to be minimized is:\n$$ \\chi^2(c, m) = \\sum_{i=1}^{N} w_i (y_i - (c + m x_i))^2 $$\nTo find the values of $c$ and $m$ that minimize $\\chi^2$, we take the partial derivatives of $\\chi^2$ with respect to $c$ and $m$ and set them to zero. This yields the following system of linear equations, known as the normal equations:\n$$ \\frac{\\partial \\chi^2}{\\partial c} = -2 \\sum_{i=1}^{N} w_i (y_i - c - m x_i) = 0 \\implies c \\left(\\sum w_i\\right) + m \\left(\\sum w_i x_i\\right) = \\sum w_i y_i $$\n$$ \\frac{\\partial \\chi^2}{\\partial m} = -2 \\sum_{i=1}^{N} w_i x_i (y_i - c - m x_i) = 0 \\implies c \\left(\\sum w_i x_i\\right) + m \\left(\\sum w_i x_i^2\\right) = \\sum w_i x_i y_i $$\n\nFor notational convenience, let's define the following sums:\n$S_w = \\sum w_i$, $S_{wx} = \\sum w_i x_i$, $S_{wy} = \\sum w_i y_i$, $S_{wxx} = \\sum w_i x_i^2$, and $S_{wxy} = \\sum w_i x_i y_i$.\n\nThe solution to this $2 \\times 2$ linear system gives the explicit formulas for the slope $m$ and intercept $c$:\n$$ m = \\frac{S_w S_{wxy} - S_{wx} S_{wy}}{S_w S_{wxx} - (S_{wx})^2} $$\n$$ c = \\frac{S_{wxx} S_{wy} - S_{wx} S_{wxy}}{S_w S_{wxx} - (S_{wx})^2} $$\n\nOnce $c$ and $m$ are determined from the fit, the physical quantities are extracted as follows:\n- Enthalpic contribution: $\\Delta H^\\ddagger = c$ (in units of $\\mathrm{kJ/mol}$).\n- Entropic contribution: $\\Delta S^\\ddagger = -m$. The slope $m$ has units of $\\mathrm{kJ/mol/K}$, so we must convert to the required units of $\\mathrm{J/mol/K}$ by multiplying by $1000$: $\\Delta S^\\ddagger (\\mathrm{J/mol/K}) = -m \\times 1000$.\n- Barrier at reference temperature: $F^\\ddagger(298\\ \\mathrm{K}) = c + m \\times 298$ (in units of $\\mathrm{kJ/mol}$).\n\nA specific feature of the provided test datasets is that the data points $(T_i, F^\\ddagger(T_i))$ for each set are perfectly collinear. In such an ideal case, the WLS fit will precisely recover the parameters of the line on which the points lie, regardless of the weights, and the minimized $\\chi^2$ value will be zero. While numerical calculations with standard floating-point arithmetic may introduce negligible precision errors, the analytical solution is exact. We will thus proceed by implementing the general WLS procedure, which correctly handles this special case.\n\n**Dataset 1:**\n- $T$: $[280, 300, 320, 340]\\ \\mathrm{K}$\n- $F^\\ddagger$: $[39.4, 39.0, 38.6, 38.2]\\ \\mathrm{kJ/mol}$\n- $\\sigma$: $[0.2, 0.15, 0.2, 0.25]\\ \\mathrm{kJ/mol}$\nThe data points lie on a line. The slope is $m = (39.0 - 39.4) / (300 - 280) = -0.4 / 20 = -0.02\\ \\mathrm{kJ/mol/K}$.\nThe intercept is $c = F^\\ddagger(T) - m T = 39.4 - (-0.02 \\times 280) = 39.4 + 5.6 = 45.0\\ \\mathrm{kJ/mol}$.\nPerforming the WLS fit yields $m = -0.02\\ \\mathrm{kJ/mol/K}$ and $c = 45.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta H^\\ddagger = c = 45.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta S^\\ddagger = -m \\times 1000 = -(-0.02) \\times 1000 = 20.0\\ \\mathrm{J/mol/K}$.\n- $F^\\ddagger(298\\ \\mathrm{K}) = 45.0 + (-0.02) \\times 298 = 45.0 - 5.96 = 39.04\\ \\mathrm{kJ/mol}$.\n\n**Dataset 2:**\n- $T$: $[250, 300, 350]\\ \\mathrm{K}$\n- $F^\\ddagger$: $[40.0, 42.0, 44.0]\\ \\mathrm{kJ/mol}$\n- $\\sigma$: $[0.1, 0.1, 0.1]\\ \\mathrm{kJ/mol}$\nThe data points are collinear, and the weights are uniform. The slope is $m = (42.0 - 40.0) / (300 - 250) = 2.0 / 50 = 0.04\\ \\mathrm{kJ/mol/K}$.\nThe intercept is $c = F^\\ddagger(T) - m T = 40.0 - (0.04 \\times 250) = 40.0 - 10.0 = 30.0\\ \\mathrm{kJ/mol}$.\nThe WLS fit yields $m = 0.04\\ \\mathrm{kJ/mol/K}$ and $c = 30.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta H^\\ddagger = c = 30.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta S^\\ddagger = -m \\times 1000 = -0.04 \\times 1000 = -40.0\\ \\mathrm{J/mol/K}$.\n- $F^\\ddagger(298\\ \\mathrm{K}) = 30.0 + 0.04 \\times 298 = 30.0 + 11.92 = 41.92\\ \\mathrm{kJ/mol}$.\n\n**Dataset 3:**\n- $T$: $[295, 300, 305]\\ \\mathrm{K}$\n- $F^\\ddagger$: $[53.525, 53.5, 53.475]\\ \\mathrm{kJ/mol}$\n- $\\sigma$: $[0.05, 0.2, 0.05]\\ \\mathrm{kJ/mol}$\nThe data points are again perfectly collinear. The slope is $m = (53.5 - 53.525) / (300 - 295) = -0.025 / 5 = -0.005\\ \\mathrm{kJ/mol/K}$.\nThe intercept is $c = F^\\ddagger(T) - m T = 53.525 - (-0.005 \\times 295) = 53.525 + 1.475 = 55.0\\ \\mathrm{kJ/mol}$.\nThe WLS fit yields $m = -0.005\\ \\mathrm{kJ/mol/K}$ and $c = 55.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta H^\\ddagger = c = 55.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta S^\\ddagger = -m \\times 1000 = -(-0.005) \\times 1000 = 5.0\\ \\mathrm{J/mol/K}$.\n- $F^\\ddagger(298\\ \\mathrm{K}) = 55.0 + (-0.005) \\times 298 = 55.0 - 1.49 = 53.51\\ \\mathrm{kJ/mol}$.\n\nThe final values, rounded as specified ($3$ decimal places for energies, $1$ for entropy), are:\n- Dataset 1: $\\Delta H^\\ddagger = 45.000\\ \\mathrm{kJ/mol}$, $\\Delta S^\\ddagger = 20.0\\ \\mathrm{J/mol/K}$, $F^\\ddagger(298\\ \\mathrm{K}) = 39.040\\ \\mathrm{kJ/mol}$.\n- Dataset 2: $\\Delta H^\\ddagger = 30.000\\ \\mathrm{kJ/mol}$, $\\Delta S^\\ddagger = -40.0\\ \\mathrm{J/mol/K}$, $F^\\ddagger(298\\ \\mathrm{K}) = 41.920\\ \\mathrm{kJ/mol}$.\n- Dataset 3: $\\Delta H^\\ddagger = 55.000\\ \\mathrm{kJ/mol}$, $\\Delta S^\\ddagger = 5.0\\ \\mathrm{J/mol/K}$, $F^\\ddagger(298\\ \\mathrm{K}) = 53.510\\ \\mathrm{kJ/mol}$.\nThe program below will implement this procedure to generate the required output string.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs weighted least-squares analysis on PCET simulation data\n    to extract thermodynamic parameters.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"T\": [280, 300, 320, 340],\n            \"F_barrier\": [39.4, 39.0, 38.6, 38.2],\n            \"sigma\": [0.2, 0.15, 0.2, 0.25]\n        },\n        {\n            \"T\": [250, 300, 350],\n            \"F_barrier\": [40.0, 42.0, 44.0],\n            \"sigma\": [0.1, 0.1, 0.1]\n        },\n        {\n            \"T\": [295, 300, 305],\n            \"F_barrier\": [53.525, 53.5, 53.475],\n            \"sigma\": [0.05, 0.2, 0.05]\n        }\n    ]\n\n    T_ref = 298.0  # Reference temperature in K\n    results = []\n\n    for case in test_cases:\n        T = np.array(case[\"T\"])\n        F_barrier = np.array(case[\"F_barrier\"])\n        sigma = np.array(case[\"sigma\"])\n\n        # The model is F_barrier = delta_H - T * delta_S\n        # This is a linear model y = c + m*x, where:\n        # y = F_barrier\n        # x = T\n        # c = delta_H (intercept)\n        # m = -delta_S (slope)\n\n        # Weights for the WLS fit are w = 1/sigma^2\n        weights = 1.0 / sigma**2\n\n        # Perform weighted least-squares linear regression to find slope (m) and intercept (c).\n        # numpy.polyfit returns coefficients of a polynomial, highest power first.\n        # For a degree 1 polynomial (line), this is [slope, intercept].\n        m, c = np.polyfit(T, F_barrier, 1, w=weights)\n\n        # Extract thermodynamic quantities\n        # delta_H is the intercept, in kJ/mol\n        delta_H = c\n        # delta_S is the negative of the slope, converted from kJ/mol/K to J/mol/K\n        delta_S = -m * 1000.0\n\n        # Calculate the free energy barrier at the reference temperature\n        F_barrier_ref = c + m * T_ref\n\n        # Format results according to the problem specification\n        # delta_H and F_barrier_ref to 3 decimal places\n        # delta_S to 1 decimal place\n        formatted_delta_H = f\"{delta_H:.3f}\"\n        formatted_delta_S = f\"{delta_S:.1f}\"\n        formatted_F_ref = f\"{F_barrier_ref:.3f}\"\n\n        results.extend([formatted_delta_H, formatted_delta_S, formatted_F_ref])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}