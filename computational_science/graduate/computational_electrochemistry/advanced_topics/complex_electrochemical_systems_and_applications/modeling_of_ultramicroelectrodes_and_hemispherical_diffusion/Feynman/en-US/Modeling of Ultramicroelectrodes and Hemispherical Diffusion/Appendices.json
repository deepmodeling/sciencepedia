{
    "hands_on_practices": [
        {
            "introduction": "Before building complex simulations, it is crucial to master the fundamental analytical models that describe ultramicroelectrode behavior. This exercise explores the significant impact of electrode geometry by comparing the theoretical steady-state current, $i_{ss}$, of a perfect hemisphere to that of an inlaid microdisk . By quantifying the systematic error introduced by this common approximation, you will develop a deeper appreciation for the importance of selecting the correct geometric model to accurately interpret electrochemical data.",
            "id": "4253059",
            "problem": "A hemispherical platinum ultramicroelectrode tip of radius $a$ is used as the probe in Scanning Electrochemical Microscopy (SECM). The probe is immersed in a quiescent bulk electrolyte containing a single electroactive species at bulk concentration $C^{*}$ and diffusion coefficient $D$. The reaction at the electrode is fast enough to be diffusion limited, so the surface concentration is effectively zero. The insulating sheath is long and flush with an infinite plane, and the tip is positioned sufficiently far from any other boundaries that external confinement does not perturb the diffusion field (distance to any boundary $\\geq 10a$). In practice, some analyses approximate the hemispherical probe tip as a microdisk of radius $a$ inlaid flush with the same plane.\n\nStarting from Fick’s laws of diffusion and conservation of mass, and reducing to steady-state transport, treat the two geometries as follows:\n- For the hemispherical tip on an insulating plane, reduce the governing steady-state concentration field to a boundary value problem in spherical coordinates with appropriate boundary conditions at the insulating plane, and obtain the steady-state diffusion-limited current $i_{\\mathrm{hemi}}$.\n- For the microdisk of radius $a$ flush with the insulating plane, consider the axisymmetric steady-state diffusion problem in cylindrical coordinates and use the classical, well-tested solution for the steady-state diffusion-limited current $i_{\\mathrm{disk}}$.\n\nThen, for the experimental scenario described, quantify the fractional error incurred in steady-state current when the hemispherical tip is modeled as a microdisk, defined as\n$$\\varepsilon \\equiv \\frac{|i_{\\mathrm{disk}} - i_{\\mathrm{hemi}}|}{i_{\\mathrm{hemi}}}.$$\n\nRound your final numerical value of $\\varepsilon$ to four significant figures. Express the answer as a dimensionless decimal.",
            "solution": "The transport of the electroactive species to the electrode is governed by Fick's laws. At steady-state, Fick's second law, $\\frac{\\partial C}{\\partial t} = D \\nabla^2 C$, simplifies to the Laplace equation for the concentration field $C$:\n$$ \\nabla^2 C = 0 $$\nThe current $i$ is obtained by integrating the flux, $\\vec{J} = -D \\nabla C$, over the electrode surface $S$. For a reduction process involving $n$ electrons, the current is given by:\n$$ i = n F \\iint_S (-\\vec{J}) \\cdot d\\vec{A} = n F \\iint_S (D \\nabla C) \\cdot d\\vec{A} $$\nwhere $F$ is the Faraday constant and $d\\vec{A}$ is the differential area vector pointing into the solution (normal to the electrode surface).\n\n**1. Current at a Hemispherical Electrode ($i_{\\mathrm{hemi}}$)**\n\nFor a hemispherical electrode of radius $a$ on an insulating plane, the geometry is best described using spherical coordinates $(r, \\theta, \\phi)$. Due to the symmetry of the problem, the concentration $C$ will only depend on the radial distance $r$, i.e., $C=C(r)$. The Laplace equation becomes:\n$$ \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dC}{dr} \\right) = 0 $$\nThe boundary conditions are:\n-   At the electrode surface ($r=a$): $C(a) = 0$.\n-   Far from the electrode ($r \\to \\infty$): $C(r) \\to C^{*}$.\n-   At the insulating plane ($\\theta = \\pi/2$ for $r>a$): The flux normal to the plane is zero. Since our trial solution $C(r)$ is independent of $\\theta$, the gradient in the $\\theta$ direction, $\\frac{1}{r}\\frac{\\partial C}{\\partial \\theta}$, is identically zero. Thus, this boundary condition is automatically satisfied by a spherically symmetric solution.\n\nIntegrating the simplified Laplace equation twice gives the general solution:\n$$ r^2 \\frac{dC}{dr} = k_1 $$\n$$ C(r) = -\\frac{k_1}{r} + k_2 $$\nwhere $k_1$ and $k_2$ are integration constants. Applying the boundary conditions:\n-   From $C(r \\to \\infty) = C^{*}$, we find $C^{*} = 0 + k_2$, so $k_2 = C^{*}$.\n-   From $C(a) = 0$, we find $0 = -\\frac{k_1}{a} + C^{*}$, so $k_1 = aC^{*}$.\n\nThe concentration profile is therefore:\n$$ C(r) = C^{*} \\left( 1 - \\frac{a}{r} \\right) $$\nThe flux density at the electrode surface is purely radial and is given by:\n$$ J_r(a) = -D \\left( \\frac{dC}{dr} \\right)_{r=a} = -D \\left( \\frac{aC^{*}}{r^2} \\right)_{r=a} = -D \\frac{C^{*}}{a} $$\nThe total current is the flux density multiplied by the number of electrons per molecule ($n$), the Faraday constant ($F$), and the surface area of the hemisphere, $A_{\\mathrm{hemi}} = 2\\pi a^2$. The magnitude of the current is:\n$$ i_{\\mathrm{hemi}} = n F |J_r(a)| A_{\\mathrm{hemi}} = n F \\left( D \\frac{C^{*}}{a} \\right) (2\\pi a^2) $$\n$$ i_{\\mathrm{hemi}} = 2 \\pi n F D C^{*} a $$\n\n**2. Current at a Microdisk Electrode ($i_{\\mathrm{disk}}$)**\n\nFor a microdisk electrode of radius $a$ embedded in an infinite insulating plane, the problem is more complex (a mixed boundary value problem in cylindrical coordinates). As per the problem statement, we use the classical, well-established solution for the steady-state diffusion-limited current:\n$$ i_{\\mathrm{disk}} = 4 n F D C^{*} a $$\n\n**3. Fractional Error ($\\varepsilon$)**\n\nThe fractional error incurred when modeling the hemisphere as a microdisk is defined as:\n$$ \\varepsilon \\equiv \\frac{|i_{\\mathrm{disk}} - i_{\\mathrm{hemi}}|}{i_{\\mathrm{hemi}}} $$\nSubstituting the expressions for $i_{\\mathrm{disk}}$ and $i_{\\mathrm{hemi}}$:\n$$ \\varepsilon = \\frac{|4 n F D C^{*} a - 2 \\pi n F D C^{*} a|}{2 \\pi n F D C^{*} a} $$\nThe common terms $n F D C^{*} a$ cancel out:\n$$ \\varepsilon = \\frac{|4 - 2\\pi|}{2\\pi} $$\nSince $\\pi \\approx 3.14159$, we have $2\\pi \\approx 6.28318$, which is greater than $4$. Therefore, $|4 - 2\\pi| = 2\\pi - 4$.\n$$ \\varepsilon = \\frac{2\\pi - 4}{2\\pi} = 1 - \\frac{4}{2\\pi} = 1 - \\frac{2}{\\pi} $$\nNow, we calculate the numerical value and round it to four significant figures.\n$$ \\pi \\approx 3.14159265... $$\n$$ \\varepsilon = 1 - \\frac{2}{3.14159265...} \\approx 1 - 0.63661977... $$\n$$ \\varepsilon \\approx 0.36338023... $$\nRounding to four significant figures, we get:\n$$ \\varepsilon \\approx 0.3634 $$\nThis result indicates that approximating a hemispherical electrode with a microdisk of the same radius results in an underestimation of the steady-state current by approximately $36.34\\%$.",
            "answer": "$$ \\boxed{0.3634} $$"
        },
        {
            "introduction": "While analytical solutions provide essential benchmarks, they are often limited to idealized systems. This practice moves from theory to computation, guiding you through the process of building a numerical model for a hemispherical ultramicroelectrode (UME) using a finite difference scheme . You will implement the solver and then perform the crucial step of validating your numerical results against the known analytical solution, a cornerstone practice for developing reliable computational tools in electrochemistry.",
            "id": "4252976",
            "problem": "You are tasked with assessing the fidelity of a numerical steady-state diffusion model for an ultramicroelectrode (UME) exhibiting hemispherical diffusion. Your program must numerically solve the radial steady-state diffusion equation in spherical coordinates for a half-spherical electrode of radius $a$, compute the simulated limiting current $i_{ss}$ for diffusion-limited conditions, and validate it against the analytical steady-state hemispherical expression derived from first principles. The validation shall be quantified using the relative error and declared acceptable if the relative error does not exceed a specified threshold.\n\nFundamental base: Begin from Fick's first law of diffusion and the steady-state continuity equation. In spherical coordinates under radial symmetry, the steady-state continuity equation for the concentration $c(r)$ of the redox species reduces to the ordinary differential equation for the radial flux. Boundary conditions are: $c(a)=0$ at the electrode surface (diffusion-limited consumption) and $c(R)=c^*$ at a sufficiently distant outer boundary $R$ representing bulk concentration. The reaction involves $n$ electrons per molecule, the Faraday constant $F$ is the proportionality to convert molar flux to current, and diffusion coefficient $D$ describes transport.\n\nYour program must implement the following:\n\n1. Solve the steady-state boundary value problem in the radial coordinate $r \\in [a,R]$:\n   - The governing equation is the steady-state diffusion equation under radial symmetry, with no convection or migration:\n     $$\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) = 0.$$\n   - Boundary conditions:\n     $$c(a) = 0, \\quad c(R) = c^*.$$\n\n2. Discretize the domain $[a,R]$ using a uniform grid of $N$ nodes, enforce the boundary conditions, and solve the resulting linear system using a second-order finite-volume or finite-difference scheme in $r$ to obtain an approximation of $c(r)$ at the grid nodes. Use a second-order one-sided approximation for $\\frac{dc}{dr}\\big|_{r=a}$:\n   $$\\left.\\frac{dc}{dr}\\right|_{r=a} \\approx \\frac{-3 c_0 + 4 c_1 - c_2}{2 h},$$\n   where $h$ is the uniform grid spacing, $c_0=c(a)$, $c_1=c(a+h)$, and $c_2=c(a+2h)$. If $N<3$, revert to a first-order one-sided approximation:\n   $$\\left.\\frac{dc}{dr}\\right|_{r=a} \\approx \\frac{c_1 - c_0}{h}.$$\n\n3. Compute the simulated hemispherical steady-state limiting current $i_{ss}^{\\text{sim}}$ using Fick's first law at the electrode surface and the hemispherical surface area:\n   - Normal molar flux magnitude at $r=a$: $$J = D \\left.\\frac{dc}{dr}\\right|_{r=a}.$$\n   - Hemispherical limiting current: $$i_{ss}^{\\text{sim}} = 2 \\pi a^2 \\, n F \\, J.$$\n   Answer in amperes (A).\n\n4. Compute the analytical hemispherical steady-state limiting current $i_{ss}^{\\text{ana}}$ by solving the radial steady-state equation analytically under the same boundary conditions and using the corresponding flux at $r=a$ and hemispherical area, then express the result purely in terms of $n$, $F$, $D$, $c^*$, and $a$. Answer in amperes (A).\n\n5. Compute the relative error:\n   $$\\varepsilon = \\frac{\\left| i_{ss}^{\\text{sim}} - i_{ss}^{\\text{ana}} \\right|}{i_{ss}^{\\text{ana}}}.$$\n\n6. Decide acceptance according to a prescribed threshold $\\tau$ for each test case:\n   $$\\text{accept} = \\varepsilon \\le \\tau.$$\n\nPhysical units:\n- $D$ in $\\mathrm{m^2/s}$,\n- $c^*$ in $\\mathrm{mol/m^3}$,\n- $a$ and $R$ in $\\mathrm{m}$,\n- $F$ in $\\mathrm{C/mol}$,\n- current in $\\mathrm{A}$.\n\nAngle units do not apply.\n\nTest suite:\nYour program must evaluate the following parameter sets, with each case specified as $(n, F, D, c^*, a, R, N, \\tau)$:\n\n- Case 1 (happy path, fine grid):\n  - $n=1$, $F=96485$, $D=1.0 \\times 10^{-9}$, $c^*=1.0$, $a=5.0 \\times 10^{-6}$, $R=2.0 \\times 10^{-3}$, $N=1000$, $\\tau=5.0 \\times 10^{-3}$.\n\n- Case 2 (boundary condition with very small $a$ and large $R$):\n  - $n=1$, $F=96485$, $D=2.2 \\times 10^{-9}$, $c^*=0.35$, $a=1.0 \\times 10^{-7}$, $R=1.0 \\times 10^{-2}$, $N=2000$, $\\tau=1.0 \\times 10^{-2}$.\n\n- Case 3 (edge case with coarse grid expected to be less accurate):\n  - $n=1$, $F=96485$, $D=1.5 \\times 10^{-9}$, $c^*=0.8$, $a=1.0 \\times 10^{-5}$, $R=5.0 \\times 10^{-4}$, $N=12$, $\\tau=2.0 \\times 10^{-2}$.\n\n- Case 4 (multi-electron transfer, moderate grid):\n  - $n=2$, $F=96485$, $D=0.9 \\times 10^{-9}$, $c^*=0.5$, $a=2.0 \\times 10^{-6}$, $R=1.0 \\times 10^{-3}$, $N=50$, $\\tau=3.0 \\times 10^{-2}$.\n\nFinal output format:\nYour program should produce a single line of output containing the acceptance decisions for the four test cases as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,True]\"). Each element must be a boolean indicating whether the simulated current meets the acceptance criterion for that test case.",
            "solution": "The problem requires the validation of a numerical model for steady-state diffusion to a hemispherical ultramicroelectrode against its analytical counterpart. This is a standard procedure in computational science to assess model fidelity. The process involves deriving the analytical solution, formulating and solving the numerical equivalent, and comparing the results.\n\n### 1. Analytical Solution\n\nThe foundation of the model is the steady-state continuity equation in the absence of generation or consumption in the bulk solution. For a system with spherical symmetry, this is expressed using Fick's first law, leading to the governing ordinary differential equation for concentration $c$ as a function of radial distance $r$:\n$$\n\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) = 0\n$$\nThis equation is to be solved on the domain $r \\in [a, R]$ with the specified boundary conditions:\n$$\nc(a) = 0 \\quad \\text{(diffusion-limited consumption at the electrode surface)}\n$$\n$$\nc(R) = c^* \\quad \\text{(bulk concentration at the outer boundary)}\n$$\nIntegrating the governing equation once with respect to $r$ yields:\n$$\nr^2 \\frac{dc}{dr} = K_1\n$$\nwhere $K_1$ is a constant of integration. This equation signifies that the total molar flow rate across any spherical surface ($4 \\pi r^2 J(r)$) is constant at steady state. Rearranging and integrating a second time gives the general solution for the concentration profile:\n$$\n\\frac{dc}{dr} = \\frac{K_1}{r^2} \\implies \\int dc = \\int \\frac{K_1}{r^2} dr \\implies c(r) = -\\frac{K_1}{r} + K_2\n$$\nwhere $K_2$ is the second integration constant. These constants are determined by applying the boundary conditions.\nApplying $c(a) = 0$:\n$$\n0 = -\\frac{K_1}{a} + K_2 \\implies K_2 = \\frac{K_1}{a}\n$$\nSubstituting this into the general solution and applying $c(R) = c^*$:\n$$\nc^* = -\\frac{K_1}{R} + \\frac{K_1}{a} = K_1 \\left(\\frac{1}{a} - \\frac{1}{R}\\right) = K_1 \\left(\\frac{R-a}{aR}\\right)\n$$\nSolving for $K_1$:\n$$\nK_1 = c^* \\frac{aR}{R-a}\n$$\nThe molar flux $J$ at the electrode surface ($r=a$) is given by Fick's first law, $J = -D \\frac{dc}{dr}\\big|_{r=a}$. The problem defines $J$ as the magnitude, so we use $J = D \\left|\\frac{dc}{dr}\\right|_{r=a}$. The gradient at $r=a$ is:\n$$\n\\left.\\frac{dc}{dr}\\right|_{r=a} = \\frac{K_1}{a^2} = \\frac{1}{a^2} \\left(c^* \\frac{aR}{R-a}\\right) = \\frac{c^*R}{a(R-a)}\n$$\nAs $R>a$, the gradient is positive, as expected. The flux magnitude is:\n$$\nJ = D \\frac{c^*R}{a(R-a)}\n$$\nThe total current is the flux multiplied by the electrode surface area and the charge per mole of reactant. For a hemisphere of radius $a$, the area is $2 \\pi a^2$. Thus, the analytical steady-state limiting current $i_{ss}^{\\text{ana}}$ is:\n$$\ni_{ss}^{\\text{ana}} = (2 \\pi a^2) (nF) J = 2 \\pi a^2 n F D \\frac{c^*R}{a(R-a)} = 2 \\pi n F D c^* a \\frac{R}{R-a}\n$$\nThis expression will serve as the exact solution against which the numerical approximation is compared.\n\n### 2. Numerical Solution\n\nThe numerical solution is obtained by discretizing the governing equation using a finite volume method, which ensures conservation of the diffusing species.\n\n**Discretization:** The radial domain $[a, R]$ is divided into $N-1$ control volumes by $N$ nodes, $r_0, r_1, \\dots, r_{N-1}$. The nodes are uniformly spaced with grid spacing $h = (R-a)/(N-1)$, such that $r_i = a + i h$. The concentration at node $r_i$ is denoted $c_i$.\n\n**Finite Volume Formulation:** We integrate the governing equation over a control volume centered at an internal node $r_i$, from $r_{i-1/2} = r_i - h/2$ to $r_{i+1/2} = r_i + h/2$:\n$$\n\\int_{r_{i-1/2}}^{r_{i+1/2}} \\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) dr = \\left[r^2 \\frac{dc}{dr}\\right]_{r_{i-1/2}}^{r_{i+1/2}} = 0\n$$\nThis simplifies to:\n$$\nr_{i+1/2}^2 \\left.\\frac{dc}{dr}\\right|_{r_{i+1/2}} - r_{i-1/2}^2 \\left.\\frac{dc}{dr}\\right|_{r_{i-1/2}} = 0\n$$\nThe gradients at the control volume faces are approximated using a second-order central difference scheme:\n$$\n\\left.\\frac{dc}{dr}\\right|_{r_{i+1/2}} \\approx \\frac{c_{i+1}-c_i}{h}, \\quad \\left.\\frac{dc}{dr}\\right|_{r_{i-1/2}} \\approx \\frac{c_i-c_{i-1}}{h}\n$$\nSubstituting these approximations yields the discretized equation for each internal node $i \\in \\{1, 2, \\dots, N-2\\}$:\n$$\nr_{i+1/2}^2 \\left(\\frac{c_{i+1}-c_i}{h}\\right) - r_{i-1/2}^2 \\left(\\frac{c_i-c_{i-1}}{h}\\right) = 0\n$$\nMultiplying by $h$ and rearranging terms to group by concentration gives a linear equation for $c_{i-1}, c_i, c_{i+1}$:\n$$\nr_{i-1/2}^2 c_{i-1} - (r_{i-1/2}^2 + r_{i+1/2}^2) c_i + r_{i+1/2}^2 c_{i+1} = 0\n$$\nThis provides a set of $N-2$ linear equations for the $N-2$ unknown internal concentrations $\\{c_1, \\dots, c_{N-2}\\}$. The boundary concentrations are known: $c_0 = c(a) = 0$ and $c_{N-1} = c(R) = c^*$. These boundary values are incorporated into the equations for the first ($i=1$) and last ($i=N-2$) internal nodes:\nFor $i=1$:\n$$\nr_{1/2}^2 c_{0} - (r_{1/2}^2 + r_{3/2}^2) c_1 + r_{3/2}^2 c_{2} = 0 \\implies -(r_{1/2}^2 + r_{3/2}^2) c_1 + r_{3/2}^2 c_{2} = 0\n$$\nFor $i=N-2$:\n$$\nr_{N-5/2}^2 c_{N-3} - (r_{N-2.5}^2 + r_{N-1.5}^2) c_{N-2} + r_{N-1.5}^2 c_{N-1} = 0 \\implies r_{N-2.5}^2 c_{N-3} - (r_{N-2.5}^2 + r_{N-1.5}^2) c_{N-2} = -r_{N-1.5}^2 c^*\n$$\nThis forms a tridiagonal system of linear equations, $A\\mathbf{c'} = \\mathbf{b}$, which can be solved for the vector of internal concentrations $\\mathbf{c'} = [c_1, \\dots, c_{N-2}]^T$.\n\n### 3. Current Calculation and Validation\n\nWith the numerical concentration profile $\\{c_i\\}_{i=0}^{N-1}$ obtained, the simulated current $i_{ss}^{\\text{sim}}$ is computed. This requires calculating the concentration gradient at the electrode surface, $r_0=a$.\nThe problem specifies the use of a second-order one-sided finite difference formula for $N \\ge 3$:\n$$\n\\left.\\frac{dc}{dr}\\right|_{r=a} \\approx \\frac{-3 c_0 + 4 c_1 - c_2}{2 h}\n$$\nFor $N < 3$, a first-order formula is to be used:\n$$\n\\left.\\frac{dc}{dr}\\right|_{r=a} \\approx \\frac{c_1 - c_0}{h}\n$$\nThe simulated flux magnitude is $J^{\\text{sim}} = D \\left.\\frac{dc}{dr}\\right|_{r=a}$. The simulated current is then:\n$$\ni_{ss}^{\\text{sim}} = 2 \\pi a^2 n F J^{\\text{sim}}\n$$\nFinally, the numerical result is validated by computing the relative error $\\varepsilon$ against the analytical solution:\n$$\n\\varepsilon = \\frac{\\left| i_{ss}^{\\text{sim}} - i_{ss}^{\\text{ana}} \\right|}{i_{ss}^{\\text{ana}}}\n$$\nThis error is compared to a specified tolerance $\\tau$. The simulation is deemed acceptable if $\\varepsilon \\le \\tau$. This procedure is repeated for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import linalg is not strictly needed as numpy.linalg.solve works fine.\n\ndef solve():\n    \"\"\"\n    Solves the steady-state diffusion problem for a hemispherical UME\n    and validates the numerical solution against the analytical one for several test cases.\n    \"\"\"\n    \n    # Define test cases as tuples: (n, F, D, c_star, a, R, N, tau)\n    test_cases = [\n        # Case 1 (happy path, fine grid)\n        (1, 96485, 1.0e-9, 1.0, 5.0e-6, 2.0e-3, 1000, 5.0e-3),\n        # Case 2 (boundary condition with very small 'a' and large 'R')\n        (1, 96485, 2.2e-9, 0.35, 1.0e-7, 1.0e-2, 2000, 1.0e-2),\n        # Case 3 (edge case with coarse grid)\n        (1, 96485, 1.5e-9, 0.8, 1.0e-5, 5.0e-4, 12, 2.0e-2),\n        # Case 4 (multi-electron transfer, moderate grid)\n        (2, 96485, 0.9e-9, 0.5, 2.0e-6, 1.0e-3, 50, 3.0e-2),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n, F, D, c_star, a, R, N, tau = case\n\n        # Ensure N is an integer\n        N = int(N)\n        \n        # --- 1. Analytical Solution ---\n        # i_ss_ana = 2 * pi * n * F * D * c_star * a * (R / (R - a))\n        i_ss_ana = 2.0 * np.pi * n * F * D * c_star * a * (R / (R - a))\n\n        # --- 2. Numerical Solution ---\n        if N  2:\n            # The problem is not well-defined for N  2.\n            # This path is not taken by the test cases but is included for robustness.\n            results.append(False) # Mark as unacceptable\n            continue\n\n        h = (R - a) / (N - 1)\n        r_nodes = np.linspace(a, R, N)\n        \n        c = np.zeros(N) # Concentration profile array\n        c[0] = 0.0      # Boundary condition at r=a\n        c[-1] = c_star  # Boundary condition at r=R\n        \n        # Solve for internal node concentrations c_1, ..., c_{N-2}\n        if N > 2:\n            # Number of internal nodes\n            num_internal_nodes = N - 2\n            \n            # Setup the tridiagonal linear system Ax = b for internal nodes\n            A = np.zeros((num_internal_nodes, num_internal_nodes))\n            b = np.zeros(num_internal_nodes)\n            \n            for i in range(1, N - 1):\n                # Matrix row index (0 to N-3)\n                k = i - 1\n                \n                # Radii of control volume faces\n                r_imhalf = r_nodes[i] - h / 2.0\n                r_iphalf = r_nodes[i] + h / 2.0\n                \n                # Coefficients from finite volume discretization.\n                # -(r_imhalf^2)c_{i-1} + (r_imhalf^2 + r_iphalf^2)c_i - (r_iphalf^2)c_{i+1} = 0\n                # The signs are flipped from explanation for a positive definite matrix\n                \n                # Diagonal element\n                A[k, k] = r_imhalf**2 + r_iphalf**2\n                \n                # Lower diagonal element\n                if i > 1:\n                    A[k, k - 1] = -r_imhalf**2\n                \n                # Upper diagonal element\n                if i  N - 2:\n                    A[k, k + 1] = -r_iphalf**2\n                \n                # Modify RHS vector for boundary conditions\n                if i == 1: # First internal node, adjacent to c_0=0\n                    b[k] = r_imhalf**2 * c[0] # This is 0 but shown for clarity\n                if i == N - 2: # Last internal node, adjacent to c_{N-1}=c_star\n                    b[k] = r_iphalf**2 * c[-1]\n\n            # Solve the linear system\n            c_internal = np.linalg.solve(A, b)\n            c[1:-1] = c_internal\n\n        # --- 3. Compute Simulated Current ---\n        # Calculate concentration gradient at r=a\n        if N >= 3:\n            # Second-order one-sided difference\n            dcdr_a = (-3.0 * c[0] + 4.0 * c[1] - c[2]) / (2.0 * h)\n        else: # N = 2\n            # First-order one-sided difference\n            dcdr_a = (c[1] - c[0]) / h\n\n        # Calculate simulated current\n        i_ss_sim = 2.0 * np.pi * a**2 * n * F * D * dcdr_a\n\n        # --- 4. Validate and Decide ---\n        # Compute relative error\n        if i_ss_ana == 0:\n             relative_error = np.inf if i_ss_sim != 0 else 0.0\n        else:\n             relative_error = np.abs(i_ss_sim - i_ss_ana) / np.abs(i_ss_ana)\n        \n        # Check if error is within the tolerance\n        is_accepted = relative_error = tau\n        results.append(is_accepted)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The ultimate application of electrochemical models is to understand and quantify real-world systems from experimental data. This final exercise challenges you to synthesize your theoretical and computational knowledge to design a robust experimental protocol for determining an electrode's radius, $a$, from a current measurement . Success requires not only applying the correct formula but also anticipating and addressing the various non-idealities and potential sources of error that can bias the results in a practical setting.",
            "id": "4253053",
            "problem": "An axisymmetric, inlaid ultramicrodisk electrode of unknown radius $a$ is embedded flush in an insulating, planar substrate and immersed in a quiescent, well-supported electrolyte containing a single redox-active species of bulk concentration $c^*$ and diffusion coefficient $D$. The electrochemical reaction is a fast, irreversible, $n$-electron transfer so that, under sufficiently cathodic or anodic polarization, the surface concentration of the electroactive species on the disk can be taken as approximately zero and the response is mass-transport limited. Migration is suppressed by a large excess of supporting electrolyte, and convection is negligible. Under these conditions, the steady-state diffusion field is governed by Fick’s laws and the steady-state concentration $c(\\mathbf{r})$ satisfies Laplace’s equation $\\nabla^2 c = 0$ in the electrolyte domain above the plane, with boundary conditions $c = 0$ on the disk, $\\partial c / \\partial n = 0$ on the insulating plane, and $c \\to c^*$ far from the electrode. The steady-state current $i_{ss}$ is related to the diffusive molar flux density $\\mathbf{J} = -D \\nabla c$ by $i_{ss} = n F \\int_{\\text{disk}} \\mathbf{J} \\cdot \\mathbf{n} \\, \\mathrm{d}S$, where $F$ is Faraday’s constant and $\\mathbf{n}$ is the outward unit normal.\n\nWhich option(s) below specify a scientifically sound protocol to estimate $a$ from $i_{ss}$ with known $D$ and $c^*$, and correctly discuss the principal sources of bias in such an estimate, including errors due to geometry misidentification and non-ideal substrate planarity?\n\nA. Acquire $i_{ss}$ in a potential region where the reaction is demonstrably mass-transport limited, with large supporting electrolyte to suppress migration and negligible ohmic drop, and use the axisymmetric disk boundary-value problem for $\\nabla^2 c = 0$ (inlaid disk in an insulating plane) to invert $i_{ss}$ to an estimate of $a$. Validate the model by checking proportionality of $i_{ss}$ to $c^*$ and $D$, and by the independence of $i_{ss}$ on potential within the limiting region. Discuss biases: if the disk is actually recessed below the plane or partially blocked by the substrate, the measured $i_{ss}$ is reduced, producing an underestimation of $a$; if the disk protrudes above the plane, edge exposure increases $i_{ss}$ and overestimates $a$. Misidentifying the geometry as a free sphere or a hemisphere on a plane leads to a systematic scale error in $a$ due to using an incorrect flux constant. Insufficient supporting electrolyte, finite kinetics, unintended convection, or errors in $D$ and $c^*$ measurement also bias $a$.\n\nB. Use a potential step to generate a transient current and fit the long-time tail to the planar Cottrell relation for a macroscopic electrode to infer the geometric area, then set $a$ by $A = \\pi a^2$. Because long-time transients are universal, this approach yields an unbiased $a$, and deviations from planarity do not affect the estimate of $a$ at long times.\n\nC. Treat the electrode as a perfect isolated sphere in an infinite medium and invert $i_{ss}$ using the spherical steady-state diffusion solution. This approach avoids the need to control the substrate condition. Plane imperfections that recess the disk slightly will increase the apparent $a$, but protrusions will decrease the apparent $a$; the net effect averages out.\n\nD. Construct and validate an axisymmetric transport model using the Finite Element Method (FEM) that solves $\\nabla \\cdot (-D \\nabla c) = 0$ with $c = 0$ on the disk, $\\partial c / \\partial n = 0$ on the insulating plane, and $c = c^*$ at a distant boundary. Use parameter inversion: vary $a$ in the model until the computed $i_{ss}$ matches the measured $i_{ss}$; confirm linearity in $c^*$ and $D$. Include sensitivity analyses for substrate non-planarity (e.g., a recess or protrusion characterized by a small height $h$ relative to $a$) and demonstrate that recesses reduce $i_{ss}$ (biasing $a$ low) and protrusions increase $i_{ss}$ (biasing $a$ high). Show that misidentifying the geometry as spherical or hemispherical yields a systematic scale error in $a$ and justify the axisymmetric inlaid-disk choice by independent imaging or profilometry.\n\nSelect all correct options.",
            "solution": "The problem describes a canonical problem in physical electrochemistry—steady-state mass transport to an inlaid ultramicrodisk electrode—which is scientifically grounded, well-posed, and objective. The governing equations, $\\nabla^2 c = 0$, and boundary conditions, $c=0$ on the disk, $\\partial c / \\partial z = 0$ on the insulator, and $c \\to c^*$ far away, are the standard mathematical formulation for this system under the stated assumptions (mass-transport control, quiescent solution, excess supporting electrolyte).\n\nThe core of the problem is to devise a protocol for determining the electrode radius, $a$, from the measured steady-state limiting current, $i_{ss}$. The relationship between these quantities is found by solving the stated boundary-value problem for the concentration field, $c(\\mathbf{r})$, and then integrating the diffusive flux, $\\mathbf{J} = -D \\nabla c$, over the electrode surface. The current is given by $i_{ss} = n F \\int_{\\text{disk}} \\mathbf{J} \\cdot \\mathbf{n} \\, \\mathrm{d}S = -nFD \\int_{\\text{disk}} (\\nabla c) \\cdot \\mathbf{n} \\, \\mathrm{d}S$. For an inlaid disk electrode of radius $a$ on an insulating plane, the solution to this problem yields the well-known Saito-Aoki-Osteryoung equation:\n$$ i_{ss} = 4 n F D c^* a $$\nwhere $n$ is the number of electrons transferred, $F$ is the Faraday constant, $D$ is the diffusion coefficient, and $c^*$ is the bulk concentration of the electroactive species. To determine the unknown radius $a$, this equation can be inverted:\n$$ a = \\frac{i_{ss}}{4 n F D c^*} $$\nA scientifically sound protocol must be based on this relationship and must account for the experimental conditions required to satisfy the model's assumptions, as well as the biases introduced when these conditions or assumptions are not perfectly met. We will now evaluate each option against this framework.\n\n### Option-by-Option Analysis\n\n**Option A:** This option proposes a protocol based on the analytical solution.\n1.  **Protocol**: \"Acquire $i_{ss}$ in a potential region where the reaction is demonstrably mass-transport limited...use the axisymmetric disk boundary-value problem for $\\nabla^2 c = 0$...to invert $i_{ss}$ to an estimate of $a$.\" This correctly identifies the experimental condition (limiting current plateau) and the theoretical basis (the $i_{ss} = 4 n F D c^* a$ formula) for determining $a$.\n2.  **Validation**: It suggests critical validation steps: checking the proportionality of $i_{ss}$ to $c^*$ and $D$, and the independence of $i_{ss}$ from potential in the limiting region. These are standard and necessary procedures to confirm that the measured current is indeed the diffusion-limited steady-state current described by the model.\n3.  **Bias Analysis**:\n    *   It correctly states that a recessed or partially blocked disk will have a reduced flux, leading to a smaller measured $i_{ss}$ and thus an underestimation of $a$.\n    *   It correctly states that a protruding disk will have enhanced flux due to exposed edges, leading to a larger $i_{ss}$ and an overestimation of $a$.\n    *   It correctly identifies that misidentifying the geometry (e.g., as a hemisphere, for which $i_{ss} = 2\\pi n F D c^* a$, or a sphere, for which $i_{ss} = 4\\pi n F D c^* a$) results in using an incorrect geometric factor ($4$ for a disk, $2\\pi$ for a hemisphere, $4\\pi$ for a sphere), leading to a large systematic error in the calculated $a$.\n    *   It correctly lists other major sources of error, including migration (insufficient supporting electrolyte), slow kinetics, convection, and uncertainties in $D$ and $c^*$.\nThis option presents a complete, correct, and experimentally practical protocol.\n\n**Verdict on Option A: Correct**\n\n**Option B:** This option proposes a protocol based on transient chronoamperometry.\n1.  **Protocol**: \"fit the long-time tail to the planar Cottrell relation...to infer the geometric area, then set $a$ by $A = \\pi a^2$\". The Cottrell equation, $i(t) = n F A D^{1/2} c^* (\\pi t)^{-1/2}$, describes diffusion to a \"macro\" electrode, where the diffusion layer thickness is always much smaller than the electrode dimensions, effectively making it a one-dimensional problem. For an ultramicroelectrode, diffusion is initially planar ($1$D) at short times but transitions to convergent, radial diffusion ($3$D) at longer times. The \"long-time tail\" of a UME chronoamperogram does not decay as $t^{-1/2}$; it approaches the constant, non-zero steady-state current $i_{ss}$. Therefore, fitting the long-time response to the Cottrell equation is a fundamental misapplication of theory.\n2.  **Claims**: The statements that \"long-time transients are universal\" and that this method is immune to \"deviations from planarity\" are both false. The long-time behavior is highly geometry-dependent (it is precisely what distinguishes a microelectrode from a macroelectrode), and, as discussed for option A, deviations from planarity (recess/protrusion) directly impact the long-time (steady-state) current.\n\n**Verdict on Option B: Incorrect**\n\n**Option C:** This option proposes using an alternative geometric model.\n1.  **Protocol**: \"Treat the electrode as a perfect isolated sphere...and invert $i_{ss}$ using the spherical steady-state diffusion solution.\" The steady-state current to a sphere of radius $a$ is $i_{ss, \\text{sphere}} = 4\\pi n F D c^* a$. Using this to analyze a current from a disk ($i_{ss, \\text{disk}} = 4 n F D c^* a$) would yield an estimated radius $a_{\\text{est}} = i_{ss, \\text{disk}} / (4\\pi n F D c^*) = a_{\\text{true}}/\\pi$. This is a systematic error of approximately $318\\%$. Ignoring the insulating substrate is a major modeling failure, not a simplification.\n2.  **Bias Analysis**: The claim that \"recess the disk slightly will increase the apparent $a$, but protrusions will decrease the apparent $a$\" is factually incorrect. As established in the analysis of option A, a recess hinders diffusion and *decreases* apparent $a$, while a protrusion enhances diffusion and *increases* apparent $a$. The claim that these effects \"average out\" is unsubstantiated and illogical.\n\n**Verdict on Option C: Incorrect**\n\n**Option D:** This option proposes a computational protocol.\n1.  **Protocol**: \"Construct and validate an axisymmetric transport model using the Finite Element Method (FEM) that solves $\\nabla \\cdot (-D \\nabla c) = 0$ with [correct] boundary conditions.\" This is a numerically exact way to solve the boundary-value problem. \"Use parameter inversion: vary $a$ in the model until the computed $i_{ss}$ matches the measured $i_{ss}$\" is a standard and robust method for parameter estimation. This is a modern, powerful, and scientifically sound protocol.\n2.  **Validation**: It correctly includes experimental validation by checking linearity in $c^*$ and $D$, and crucially, recommends independent geometric validation via imaging or profilometry. This represents best practice.\n3.  **Bias Analysis**: It correctly describes performing sensitivity analyses by explicitly modeling non-ideal geometries (recesses, protrusions). It correctly states that recesses reduce $i_{ss}$ (biasing $a$ low) and protrusions increase $i_{ss}$ (biasing $a$ high). This quantitative approach is a major strength of FEM. It also correctly notes that misidentifying the geometry leads to systematic errors. This analysis is thorough and accurate.\nThis option describes a sophisticated, state-of-the-art, and scientifically rigorous protocol that is fully correct in its physics, methods, and analysis of biases.\n\n**Verdict on Option D: Correct**\n\nBoth options A and D describe scientifically sound and mutually consistent protocols. Option A represents the classical analytical-experimental approach, while Option D represents the modern computational-experimental approach. Both are valid and correctly identify the key physical principles and sources of error.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}