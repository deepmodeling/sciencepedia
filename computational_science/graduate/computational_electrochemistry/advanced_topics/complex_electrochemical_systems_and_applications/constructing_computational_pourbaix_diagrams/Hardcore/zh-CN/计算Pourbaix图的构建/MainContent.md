## 引言
计算[普拜图](@entry_id:1124207)（Computational Pourbaix Diagram）是连接微观[原子模拟](@entry_id:187783)与宏观电化学现象的关键工具，它为预测和理解材料在[水溶液](@entry_id:145101)环境中的稳定性提供了强有力的理论框架。然而，从第一性原理（如密度泛函理论）出发精确构建这些图谱，需要掌握一套复杂的[热力学](@entry_id:172368)与计算方法，这构成了理论研究与实际应用之间的知识鸿沟。本文旨在系统地填补这一鸿沟，为读者提供一个从理论到实践的完整指南。

在接下来的内容中，我们将分三个章节展开：首先，在**“原理与机制”**一章中，我们将深入剖析构建计算[普拜图](@entry_id:1124207)所需的[热力学](@entry_id:172368)基础、[巨势](@entry_id:136286)形式论以及核心的计算氢电极模型，为整个方法论奠定坚实的理论基石。接着，在**“应用与交叉学科联系”**一章，我们将展示该方法如何在材料腐蚀、地球化学及前沿的电催化等多个领域中发挥作用，揭示其广泛的科学与工程价值。最后，在**“动手实践”**部分，读者将通过具体的计算练习，将所学理论付诸实践，真正掌握构建和解读计算[普拜图](@entry_id:1124207)的核心技能。

## 原理与机制

本章将深入探讨计算[普拜图](@entry_id:1124207)构建背后的基本热力学原理与计算机制。我们将从[电化学平衡](@entry_id:268744)的基本概念出发，系统地建立一个从[第一性原理计算](@entry_id:198754)到最终相图呈现的理论框架。此框架不仅涵盖了理想条件下的基础模型，还将扩展到影响计算准确性和适用性的多个实际因素，例如[非理想溶液](@entry_id:142298)效应、计算方法的内在误差以及动力学限制等。通过本章的学习，读者将能够理解[普拜图](@entry_id:1124207)如何作为连接微观原子模拟与宏观电化学行为的桥梁。

### [普拜图](@entry_id:1124207)的[热力学](@entry_id:172368)基础

[普拜图](@entry_id:1124207)（Pourbaix Diagram），又称电位-pH图，是描述电化学体系在不同[电极电位](@entry_id:158928)（$E$）和[酸度](@entry_id:137608)（pH）下[热力学](@entry_id:172368)稳定相的“地图”。图中的每个区域代表一个特定物种（如金属单质、氧化物、[氢氧化](@entry_id:182803)物或溶解离子）在给定条件下的[热力学](@entry_id:172368)最稳定形式。区域之间的界线则表示两个物种处于平衡状态的条件。

#### 化学势与电化学势

理解[普拜图](@entry_id:1124207)的基石是**化学势**（chemical potential）与**[电化学势](@entry_id:141179)**（electrochemical potential）的概念。在恒温恒压下，多组分体系中物种 $i$ 的化学势 $\mu_i$ 定义为其偏摩尔吉布斯自由能：
$$ \mu_i = \left( \frac{\partial G}{\partial n_i} \right)_{T,P,\{n_{j \neq i}\}} $$
化学势是驱动物质从高化学势区域向低化学势区域转移的内在驱动力。对于带电物种，如[溶液中的离子](@entry_id:143907)或电极中的电子，其能量不仅取决于化学环境，还受到电场的影响。因此，我们需要使用[电化学势](@entry_id:141179) $\tilde{\mu}_i$ 来完整描述其热力学状态：
$$ \tilde{\mu}_i = \mu_i + z_i F \phi $$
其中，$z_i$ 是物种的电荷数，$F$ 是[法拉第常数](@entry_id:262496)，$\phi$ 是该物种所处的相的内电势。在恒温恒压下，一个带电物种跨相转移的自发方向，是从高电化学势的相转移到低[电化学势](@entry_id:141179)的相。当两个相达到平衡时，该物种在这两个相中的电化学势必然相等 。这正是构建[普拜图](@entry_id:1124207)[相界](@entry_id:172947)线的根本原则。

#### [能斯特方程](@entry_id:1128500)与[相界](@entry_id:172947)线

[普拜图](@entry_id:1124207)中的[相界](@entry_id:172947)线是基于化学反应的平衡条件推导出来的。考虑一个涉及 $m$ 个质子（$\mathrm{H}^+$）和 $n$ 个电子（$\mathrm{e}^-$）的广义电化学反应：
$$ aA + m\mathrm{H}^{+} + n\mathrm{e}^{-} \rightleftharpoons bB + c\mathrm{H}_2\mathrm{O} $$
在平衡时，反应的吉布斯自由能变为零，这可以通过[能斯特方程](@entry_id:1128500)（Nernst Equation）与[电极电位](@entry_id:158928) $E$ 联系起来：
$$ E = E^{\circ} - \frac{RT}{nF} \ln \left( \frac{a_B^b a_{\mathrm{H}_2\mathrm{O}}^c}{a_A^a a_{\mathrm{H}^{+}}^m} \right) $$
其中，$E^{\circ}$ 是[标准电极电位](@entry_id:184074)，$R$ 是理想气体常数，$T$ 是绝对温度，$a_i$ 是物种 $i$ 的活度。根据惯例，纯固体和纯液体（作为溶剂的水）的活度设为1 。这一惯例源于[标准态](@entry_id:145000)的定义：纯的凝聚相在标准压力（通常为1 bar）下，其自身就处于[标准态](@entry_id:145000)，因此其化学势等于[标准化](@entry_id:637219)学势，这使得其活度根据定义 $a_i = \exp\left(\frac{\mu_i - \mu_i^{\circ}}{RT}\right)$ 精确地等于1。

利用 pH 的定义 $\mathrm{pH} = -\log_{10}(a_{\mathrm{H}^{+}})$，即 $\ln(a_{\mathrm{H}^{+}}) = -(\ln 10) \cdot \mathrm{pH}$，我们可以将能斯特方程改写为 $E$ 与 pH 的函数关系：
$$ E = \left( E^{\circ} - \frac{RT}{nF} \ln \frac{a_B^b}{a_A^a} \right) - \frac{mRT \ln 10}{nF} \mathrm{pH} $$
在 $a_A$ 和 $a_B$ 固定的情况下（例如，对于溶解离子，通常设定一个低活度阈值，如 $10^{-6}$），该方程在 $E$-pH 图上表现为一条直线。这条线的斜率由参与反应的质子和电子的[化学计量数](@entry_id:144772)之比决定：
$$ \frac{dE}{d(\mathrm{pH})} = -\frac{m}{n} \left( \frac{RT \ln 10}{F} \right) $$
在 $T=298.15$ K 时，因子 $\frac{RT \ln 10}{F}$ 约等于 $0.0592$ V。

根据这个斜率公式，我们可以识别出三种基本类型的[相界](@entry_id:172947)线 ：
1.  **水平线**：当反应不涉及[质子转移](@entry_id:143444)（$m=0$）时，平衡电位与 pH 无关，界线是水平的。例如，金属与其离子的平衡：$\mathrm{M} \rightleftharpoons \mathrm{M}^{n+} + n\mathrm{e}^{-}$。
2.  **[垂直线](@entry_id:174147)**：当反应是纯化学反应，不涉及电子转移（$n=0$）时，平衡与电位无关，只取决于 pH，界线是垂直的。例如，[氢氧化](@entry_id:182803)物的沉淀/[溶解平衡](@entry_id:149362)：$\mathrm{M(OH)_2} + 2\mathrm{H}^{+} \rightleftharpoons \mathrm{M}^{2+} + 2\mathrm{H}_2\mathrm{O}$。
3.  **斜线**：当反应同时涉及质子和电子转移时（$m \neq 0, n \neq 0$），界线是倾斜的。例如，金属的钝化反应：$\mathrm{M} + \mathrm{H_2O} \rightleftharpoons \mathrm{MO} + 2\mathrm{H}^{+} + 2\mathrm{e}^{-}$。

在[腐蚀科学](@entry_id:158948)中，[普拜图](@entry_id:1124207)的区域通常被赋予特定的含义 ：
*   **免疫区（Immunity）**：金属单质是[热力学](@entry_id:172368)稳定相，意味着金属在该条件下具有天然的[抗腐蚀性](@entry_id:183133)。
*   **腐蚀区（Corrosion）**：金属的溶解离子是稳定相，意味着金属会发生电化学溶解。
*   **[钝化](@entry_id:148423)区（Passivation）**：稳定的固态氧化物或[氢氧化](@entry_id:182803)物是稳定相。这些产物可能形成致密的钝化膜，从而保护内部金属免受进一步腐蚀。

值得强调的是，这些区域的划分完全基于[热力学平衡](@entry_id:141660)，即吉布斯自由能的最小化，而没有包含任何关于[反应速率](@entry_id:185114)的信息。一个在[热力学](@entry_id:172368)上不稳定的物种，可能由于极高的动力学能垒而表现出“亚稳态”存在 。

### 计算构建：[第一性原理热力学](@entry_id:163905)框架

传统的[普拜图](@entry_id:1124207)是基于实验测定的[热力学](@entry_id:172368)数据构建的。而计算[普拜图](@entry_id:1124207)则利用第一性原理计算（如密度泛函理论，DFT）获得的原子尺度能量，结合统计力学，来预测材料的电化学稳定性。这种方法的核心是**[巨势](@entry_id:136286)（Grand Potential）**形式论。

#### [巨势](@entry_id:136286)形式论

在一个与质子和电子“库”接触的开放电化学系统中，温度 $T$、压力 $P$、pH（固定 $\mu_{\mathrm{H}^{+}}$）和[电极电位](@entry_id:158928) $E$（固定 $\mu_{\mathrm{e}^{-}}$）是固定的。在这种系综下，判断一个相是否稳定的[热力学势](@entry_id:140516)不再是吉布斯自由能 $G$，而是通过[勒让德变换](@entry_id:142214)得到的[巨势](@entry_id:136286) $\Psi$（或 $\Omega$）：
$$ \Psi = G - n_{\mathrm{H}^{+}}\mu_{\mathrm{H}^{+}} - n_{\mathrm{e}^{-}}\mu_{\mathrm{e}^{-}} $$
其中 $n_{\mathrm{H}^{+}}$ 和 $n_{\mathrm{e}^{-}}$ 是相对于某个参考态，形成该相所需要从“库”中交换的质子和电子的数量。在给定的 $(E, \mathrm{pH})$条件下，具有最低[巨势](@entry_id:136286) $\Psi$ 的相就是[热力学](@entry_id:172368)最稳定的相  。[普拜图](@entry_id:1124207)的构建过程，本质上就是为 $(E, \mathrm{pH})$ 平面上的每一点，计算所有候选相的[巨势](@entry_id:136286)，并找出最小值对应的相。

#### 从DFT能量到吉布斯自由能

DFT 计算直接得到的是在 $T=0$ K 下的电子总能量 $E_{\mathrm{DFT}}$。为了在有限温度（如 $298.15$ K）下计算[巨势](@entry_id:136286)，我们必须将 $E_{\mathrm{DFT}}$ 转化为吉布斯自由能 $G$。对于固相，其吉布斯自由能可以近似表示为 ：
$$ G(T,p) \approx E_{\mathrm{DFT}} + E_{\mathrm{ZPE}} + F_{\mathrm{vib}}^{\mathrm{th}}(T) + pV - TS_{\mathrm{conf}} $$
其中各项的物理意义和典型量级如下：
*   **零点能 ($E_{\mathrm{ZPE}}$)**：即使在绝对零度，原子也会因量子效应而振动，这部分能量即为零点能。它通常通过计算[声子频率](@entry_id:1129612)得到。对于含轻元素（如H、O）的体系，此项尤为重要，量级约为 $0.01 - 0.10 \ \mathrm{eV/atom}$。
*   **热[振动自由能](@entry_id:1133800) ($F_{\mathrm{vib}}^{\mathrm{th}}(T)$)**：这是从 $0$ K 到有限温度 $T$ 时，由声子布居引起的自由能变化，包括振动内能和[振动熵](@entry_id:756496)的贡献 ($F_{\mathrm{vib}}^{\mathrm{th}} = U_{\mathrm{vib}}^{\mathrm{th}} - TS_{\mathrm{vib}}$)。该项总是负值，在室温下其量级通常为 $0.01 - 0.10 \ \mathrm{eV/atom}$。
*   **压力-体积项 ($pV$)**：对于凝聚相，在常压（1 bar）下，此项的贡献极小，约为 $10^{-5} \ \mathrm{eV/atom}$，通常可以忽略不计。
*   **构型熵 ($S_{\mathrm{conf}}$)**：对于理想有序的晶体，构型熵为零。但对于[固溶体](@entry_id:137535)、缺陷结构或无序相，[构型熵](@entry_id:147820)的贡献不可忽略。例如，一个[理想混合](@entry_id:150763)的[二元合金](@entry_id:160005)中，每个原子位点的构型熵贡献可达 $k_B \ln 2$。

#### 计算氢电极（CHE）模型

[巨势](@entry_id:136286)公式中的 $\mu_{\mathrm{H}^{+}}$ 和 $\mu_{\mathrm{e}^{-}}$ 项将计算与实验联系起来，但直接计算这些溶剂化离子的绝对化学势非常困难。**[计算氢电极](@entry_id:747621)（Computational Hydrogen Electrode, CHE）模型**巧妙地解决了这个问题 。其核心思想是，将质子-电子对的化学势 $(\mu_{\mathrm{H}^{+}} + \mu_{\mathrm{e}^{-}})$ 与一个易于计算的参考物种——氢气分子（$\mathrm{H}_2$）的化学势 $\mu_{\mathrm{H}_2}$ 关联起来。

该模型基于[标准氢电极](@entry_id:145560)（SHE）的定义，即反应 $\mathrm{H}^{+} + \mathrm{e}^{-} \rightleftharpoons \frac{1}{2}\mathrm{H}_2$ 在标准条件下（$U_{\mathrm{SHE}}=0$ V, pH=0, $p_{\mathrm{H}_2}=1$ bar）处于平衡。通过这个平衡条件，可以推导出在任意电位 $U_{\mathrm{SHE}}$ 和 pH 下，质子-电子对的组合化学势为：
$$ \mu_{\mathrm{H}^{+}} + \mu_{\mathrm{e}^{-}} = \frac{1}{2}\mu_{\mathrm{H}_2} - eU_{\mathrm{SHE}} - k_B T \ln(10) \cdot \mathrm{pH} $$
其中，$e$ 是元电荷，$k_B$ 是玻尔兹曼常数。$\mu_{\mathrm{H}_2}$ 可以通过对气相氢气分子的DFT计算精确得到。这样，一个涉及 $n_{\mathrm{H}^{+}}$ 个质子和 $n_{\mathrm{e}^{-}}$ 个电子的反应，其[巨势](@entry_id:136286)中的化学势项就可以用实验可控的 $U_{\mathrm{SHE}}$ 和 pH 以及 DFT 可算的 $\mu_{\mathrm{H}_2}$ 来表示，从而将理论计算与实验测量联系起来。

### 实践考量与高级主题

构建精确可靠的计算[普拜图](@entry_id:1124207)，还需要考虑一系列实际问题和更高级的理论方法。

#### 参考电位与[DFT计算](@entry_id:1123635)的对齐

虽然CHE模型提供了一个简洁的框架，但在某些情况下，需要将DFT计算的能量直接对齐到绝对电位标尺上。这涉及到**功函数（work function）**和**[标准氢电极](@entry_id:145560)的绝对电位**。一个固体的功函数 $\Phi$ 定义为将其[费米能](@entry_id:143977)级 $E_F$ 的电子移至紧邻表面的真空中静止所需的能量。在电化学环境中，电极表面与溶液形成的界面偶极层会显著改变功函数，因此必须使用考虑了[溶剂化效应](@entry_id:202902)的**[溶剂化](@entry_id:146105)功函数 ($\Phi_{\mathrm{sol}}$)**，而非真空功函数 ($\Phi_{\mathrm{vac}}$) 。

通过实验和理论估算，[标准氢电极](@entry_id:145560)（SHE）的绝对电位 $U_{\mathrm{abs, SHE}}$ 约为 $4.44$ V（相对于[真空能级](@entry_id:756402)为零）。因此，一个计算得到的溶剂化功函数为 $\Phi_{\mathrm{sol}}$ 的电极，其相对于SHE的电位可以通过下式转换：
$$ U_{\mathrm{vs. SHE}} = \frac{\Phi_{\mathrm{sol}}}{e} - U_{\mathrm{abs, SHE}} \approx \frac{\Phi_{\mathrm{sol}}}{e} - 4.44 \, \mathrm{V} $$
这种方法为校准电位轴提供了另一种途径，尤其适用于需要精确描述界面电荷和电势分布的研究。

#### [DFT泛函](@entry_id:182582)的准确性与基准校正

[DFT计算](@entry_id:1123635)的准确性高度依赖于所选择的**交换关联泛函**。例如，[广义梯度近似](@entry_id:274118)（GGA）泛函（如PBE）和元-[广义梯度近似](@entry_id:274118)（[meta-GGA](@entry_id:191648)）泛函（如SCAN）对氧化物生成能的预测存在系统性偏差。这种偏差主要源于对氧气分子（$\mathrm{O}_2$）化学势的描述不准确 。

为了提高[普拜图](@entry_id:1124207)的预测精度，必须对[DFT计算](@entry_id:1123635)的能量进行基准校正。一种物理意义明确且行之有效的方法是**水生成能校正法**。该方法假设氧化物生成能的主要系统误差来自于氧参考态。通过计算水的[生成反应](@entry_id:147837) $\mathrm{H_2} + \frac{1}{2}\mathrm{O_2} \rightarrow \mathrm{H_2O}$，将[DFT计算](@entry_id:1123635)得到的水生成自由能与精确的实验值进行比较，可以拟合出每个氧原子的化学势校正量 $\delta\mu_{\mathrm{O}}$。然后，将此校正量按[化学计量数](@entry_id:144772)应用于所有待研究的氧化物和[氢氧化](@entry_id:182803)物。
$$ \Delta G_{f, \text{corr}}(\mathrm{M_xO_y}) = \Delta G_{f, \mathrm{DFT}}(\mathrm{M_xO_y}) + y \cdot \delta\mu_{\mathrm{O}} $$
这种策略的优点在于，它确保了[普拜图](@entry_id:1124207)中的水稳定窗口（由水分解反应界定）与实验一致，从而保证了整个[相图](@entry_id:144015)的[热力学](@entry_id:172368)自洽性。例如，对于NiO, CoO和Fe₂O₃等氧化物，使用此方法校正后的[SCAN泛函](@entry_id:176017)计算结果，其[均方根偏差](@entry_id:1131102)（RMSD）可降至极低水平（约2.5 kJ/mol），远优于未校正的结果或简单的平均值校正方案 。

#### 非理想效应：[离子强度](@entry_id:152038)的影响

在真实的[电解质溶液](@entry_id:143425)中，离子间的[静电相互作用](@entry_id:166363)不可忽略。**[离子强度](@entry_id:152038)**（$I = \frac{1}{2}\sum_i c_i z_i^2$）是衡量这种相互作用强弱的物理量。根据德拜-休克尔（Debye-Hückel）理论，离子的**[活度系数](@entry_id:148405)** $\gamma_i$ 随[离子强度](@entry_id:152038)的增加而减小（$a_i = \gamma_i c_i$）。

当[普拜图](@entry_id:1124207)的构建考虑离子强度效应时：
1.  如果体系中存在高浓度的背景[电解质](@entry_id:261072)（如0.1 M NaCl），则[离子强度](@entry_id:152038)主要由背景[电解质](@entry_id:261072)决定，可近似为常数。
2.  这导致溶解离子的[活度系数](@entry_id:148405) $\gamma_i$ 在很宽的pH范围内也近似为常数，但其值小于1。
3.  在能斯特方程中，[活度系数](@entry_id:148405)项 $\ln \gamma_i$ 表现为一个常数项，它会使涉及该溶解离子的[相界](@entry_id:172947)线发生**垂直平移**（截距变化）。
4.  由于pH是根据质子活度 $a_{\mathrm{H}^{+}}$ 定义的，并且活度系数近似恒定，因此[相界](@entry_id:172947)线的斜率（$dE/d(\mathrm{pH})$）通常不受离子强度的影响。

例如，对于 $\mathrm{Fe(OH)_3(s)} \rightleftharpoons \mathrm{Fe^{2+}(aq)}$ 相关的平衡，在 $0.1$ M的离子强度下，$\mathrm{Fe^{2+}}$ 的[活度系数](@entry_id:148405)约为 $0.23$。这会导致[相界](@entry_id:172947)线相对于[理想溶液](@entry_id:148303)情况向上平移约 $38$ mV 。

#### 多组分体系与[凸包构造](@entry_id:747862)

对于包含多种金属元素的复杂体系（如合金、多元氧化物），确定稳定相不能再简单地通过比较两个相的[巨势](@entry_id:136286)。此时，需要引入**成分凸包（Compositional Convex Hull）**的概念 。

在一个给定的 $(E, \mathrm{pH})$ 条件下，我们首先计算所有候选固相的[巨势](@entry_id:136286) $\Psi$。然后，在以非“库”元素（如体系中的金属元素）的相对组成为坐标轴的成分空间中，将每个相表示为一个点，其“高度”为归一化的[巨势](@entry_id:136286)。所有这些点的**下凸包**定义了[热力学稳定性](@entry_id:142877)的边界。
*   位于[凸包](@entry_id:262864)顶点或面上的相是稳定相。
*   连接两个或多个稳定相的线段（[连接线](@entry_id:196944)）或多边形（连接区域）代表了[多相平衡](@entry_id:196106)共存区。
*   任何位于凸包上方的相都是不稳定的，会自发分解为[凸包](@entry_id:262864)上的稳定相（或相的组合）。

通过在 $(E, \mathrm{pH})$ 平面上系统地改变条件并重复构造凸包，就可以生成多组分体系的[普拜图](@entry_id:1124207)。

### 扩展框架：表面[普拜图](@entry_id:1124207)

经典[普拜图](@entry_id:1124207)描述的是**体相（bulk phase）**的稳定性，而许多电化学过程（如催化、腐蚀初始阶段）都发生在材料表面。**表面[普拜图](@entry_id:1124207)（Surface Pourbaix Diagram）**将[普拜图](@entry_id:1124207)的概念从体相扩展到了界面 。

表面[普拜图](@entry_id:1124207)的目标是预测在不同电位和pH下，特定晶体表面上最稳定的**吸附物种构型**。其构建方法与体相[普拜图](@entry_id:1124207)在原理上完全相同：
1.  **候选相**：不再是不同的体相材料，而是同一表面上的不同吸附状态，例如清洁表面（*）、吸附的氢原子（*H）、羟基（*OH）或氧原子（*O）等，以及它们在不同覆盖度下的有序结构。
2.  **能量计算**：通过DFT对带有不同吸附物的表面平板模型（slab model）进行计算，获得其总能量。
3.  **[巨势](@entry_id:136286)最小化**：同样应用[巨势](@entry_id:136286)形式论，计算每个[表面吸附](@entry_id:268937)构型的[巨势](@entry_id:136286) $\Psi_{\text{surf}}$，并找出在每个 $(E, \mathrm{pH})$ 点上具有最低[巨势](@entry_id:136286)的构型。

表面[普拜图](@entry_id:1124207)为理解电催化[反应机理](@entry_id:149504)、表面氧化和钝化膜的初始形成过程提供了强大的原子尺度洞见，是对传统体相[普拜图](@entry_id:1124207)的重要补充和深化。