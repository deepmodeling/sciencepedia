{
    "hands_on_practices": [
        {
            "introduction": "Pourbaix diagrams are plotted on an electrode potential ($E$) versus pH grid, but potentials are always relative quantities. This first practice establishes the crucial skill of converting potentials between different reference scales, which is essential for comparing computational results with experimental data or plotting all thermodynamic information on a consistent framework. By working from first principles, you will solidify your understanding of the Standard Hydrogen Electrode (SHE) and the pH-dependent Reversible Hydrogen Electrode (RHE), the two most important references in computational electrochemistry. ",
            "id": "4239763",
            "problem": "In constructing a computational Pourbaix diagram for a metal–water system, a computed redox potential for a surface proton-coupled electron transfer step was obtained from an implicit-solvent density functional theory workflow and referenced to a silver/silver chloride (Ag/AgCl) electrode with saturated potassium chloride. The reported value is an electrode potential of $-0.413\\,\\mathrm{V}$ versus Ag/AgCl at $25^\\circ\\mathrm{C}$. The standard potential of Ag/AgCl (saturated potassium chloride) relative to the Standard Hydrogen Electrode (SHE) is $0.197\\,\\mathrm{V}$ at $25^\\circ\\mathrm{C}$. To overlay this point on both a SHE-referenced and a Reversible Hydrogen Electrode (RHE)–referenced Pourbaix diagram at a solution acidity of $\\mathrm{pH}=10.50$, convert the given potential to both the SHE and RHE scales starting from first principles.\n\nBegin from the definition of electrode potentials as differences in electrochemical potentials and from the Nernst equation for the hydrogen half-reaction that defines the RHE. Do not assume any pre-tabulated conversion formulas beyond the given standard potential of Ag/AgCl versus SHE. Clearly state any thermodynamic assumptions you use, including activity conventions at $25^\\circ\\mathrm{C}$.\n\nCompute:\n- the potential versus SHE, and\n- the potential versus RHE at $\\mathrm{pH}=10.50$.\n\nExpress both answers in $\\mathrm{V}$, in the order (SHE, RHE), and round your final numerical results to four significant figures.",
            "solution": "The problem requires the conversion of an electrode potential, initially referenced to a silver/silver chloride (Ag/AgCl, saturated KCl) electrode, to the Standard Hydrogen Electrode (SHE) and Reversible Hydrogen Electrode (RHE) scales. This is a fundamental procedure in constructing Pourbaix diagrams, which plot equilibrium potentials against solution pH. The analysis will proceed from first principles as requested.\n\nAn electrode potential is a measure of a potential difference. The potential of a process `proc` versus a reference electrode `ref`, denoted $E_{\\text{proc vs. ref}}$, is defined as the difference between the absolute (but unmeasurable) potentials of the process, $U_{\\text{proc}}$, and the reference, $U_{\\text{ref}}$.\n$$E_{\\text{proc vs. ref}} = U_{\\text{proc}} - U_{\\text{ref}}$$\nThis relationship allows for straightforward conversion between different reference scales.\n\nThe given data are:\n- Potential versus Ag/AgCl: $E_{\\text{vs. Ag/AgCl}} = -0.413\\,\\mathrm{V}$\n- Potential of Ag/AgCl vs. SHE: $E_{\\text{Ag/AgCl vs. SHE}} = 0.197\\,\\mathrm{V}$\n- Temperature: $T = 25^\\circ\\mathrm{C} = 298.15\\,\\mathrm{K}$\n- Solution pH: $\\mathrm{pH} = 10.50$\n\nThe thermodynamic assumptions are:\n$1$. The temperature is constant at $T=298.15\\,\\mathrm{K}$.\n$2$. Activities of pure condensed phases (solids and liquids) are taken as unity.\n$3$. For the hydrogen electrode, the activity of gaseous hydrogen, $a_{\\mathrm{H}_2}$, is taken as unity, corresponding to a fugacity of $1\\,\\mathrm{bar}$.\n$4$. The relationship between proton activity, $a_{\\mathrm{H}^+}$, and pH is given by the definition $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^+})$.\n\n**Part 1: Conversion to the Standard Hydrogen Electrode (SHE) Scale**\n\nThe potential of the process versus SHE, $E_{\\text{vs. SHE}}$, is related to the potential versus Ag/AgCl, $E_{\\text{vs. Ag/AgCl}}$, by accounting for the potential of the Ag/AgCl electrode relative to SHE, $E_{\\text{Ag/AgCl vs. SHE}}$. The fundamental relationship is:\n$$E_{\\text{vs. SHE}} = U_{\\text{proc}} - U_{\\text{SHE}}$$\nWe are given $E_{\\text{vs. Ag/AgCl}} = U_{\\text proc} - U_{\\text{Ag/AgCl}}$, which implies $U_{\\text{proc}} = E_{\\text{vs. Ag/AgCl}} + U_{\\text{Ag/AgCl}}$.\nSubstituting this into the equation for $E_{\\text{vs. SHE}}$:\n$$E_{\\text{vs. SHE}} = (E_{\\text{vs. Ag/AgCl}} + U_{\\text{Ag/AgCl}}) - U_{\\text{SHE}}$$\n$$E_{\\text{vs. SHE}} = E_{\\text{vs. Ag/AgCl}} + (U_{\\text{Ag/AgCl}} - U_{\\text{SHE}})$$\nThe term $(U_{\\text{Ag/AgCl}} - U_{\\text{SHE}})$ is precisely the potential of the Ag/AgCl electrode measured against the SHE, which is given as $E_{\\text{Ag/AgCl vs. SHE}} = 0.197\\,\\mathrm{V}$.\nTherefore, the conversion formula is:\n$$E_{\\text{vs. SHE}} = E_{\\text{vs. Ag/AgCl}} + E_{\\text{Ag/AgCl vs. SHE}}$$\nSubstituting the given numerical values:\n$$E_{\\text{vs. SHE}} = -0.413\\,\\mathrm{V} + 0.197\\,\\mathrm{V} = -0.216\\,\\mathrm{V}$$\n\n**Part 2: Conversion to the Reversible Hydrogen Electrode (RHE) Scale at $\\mathrm{pH} = 10.50$**\n\nThe RHE is a hydrogen electrode operating in the electrolyte of interest, meaning its potential is dependent on the pH of the solution. To find the potential of the process versus RHE, $E_{\\text{vs. RHE}}$, we must first determine the potential of the RHE relative to the SHE, $E_{\\text{RHE vs. SHE}}$, at the specified pH.\n\nThe RHE is defined by the hydrogen electrode half-reaction:\n$$2\\mathrm{H}^+(aq) + 2e^- \\rightleftharpoons \\mathrm{H}_2(g)$$\nThe Nernst equation for this reaction gives the potential $U_{\\text{H}^+/\\mathrm{H}_2}$:\n$$U_{\\text{H}^+/\\mathrm{H}_2} = U_{\\text{H}^+/\\mathrm{H}_2}^\\circ - \\frac{RT}{nF} \\ln\\left(\\frac{a_{\\mathrm{H}_2}}{(a_{\\mathrm{H}^+})^2}\\right)$$\nHere, $U_{\\text{H}^+/\\mathrm{H}_2}^\\circ$ is the standard potential, which is $0\\,\\mathrm{V}$ by definition for the SHE. The number of electrons transferred is $n=2$. $R$ is the ideal gas constant, $T$ is the absolute temperature, and $F$ is the Faraday constant. Using the specified assumptions, $a_{\\mathrm{H}_2}=1$ and $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^+})$. The potential of the RHE versus the SHE is thus:\n$$E_{\\text{RHE vs. SHE}} = U_{\\text{H}^+/\\mathrm{H}_2} - U_{\\text{SHE}} = (0\\,\\mathrm{V} - U_{\\text{SHE}}) - \\frac{RT}{2F} \\ln\\left(\\frac{1}{(a_{\\mathrm{H}^+})^2}\\right) = \\frac{RT}{2F} \\ln((a_{\\mathrm{H}^+})^2) = \\frac{RT}{F} \\ln(a_{\\mathrm{H}^+})$$\nTo relate this to pH, we convert the natural logarithm to base $10$: $\\ln(x) = \\ln(10) \\log_{10}(x)$.\n$$E_{\\text{RHE vs. SHE}} = \\frac{RT \\ln(10)}{F} \\log_{10}(a_{\\mathrm{H}^+})$$\nSubstituting $\\log_{10}(a_{\\mathrm{H}^+}) = -\\mathrm{pH}$:\n$$E_{\\text{RHE vs. SHE}} = -\\frac{RT \\ln(10)}{F} \\times \\mathrm{pH}$$\nAt $T = 298.15\\,\\mathrm{K}$, the Nernstian slope term is:\n$$\\frac{RT \\ln(10)}{F} = \\frac{(8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(298.15\\,\\mathrm{K})(\\ln(10))}{96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}} \\approx 0.05916\\,\\mathrm{V}$$\nAt $\\mathrm{pH} = 10.50$, the potential of the RHE versus SHE is:\n$$E_{\\text{RHE vs. SHE}} = - (0.05916\\,\\mathrm{V}) \\times 10.50 = -0.62118\\,\\mathrm{V}$$\nNow, we convert the potential from the SHE scale to the RHE scale. The relationship is analogous to the previous conversion:\n$$E_{\\text{vs. RHE}} = E_{\\text{vs. SHE}} - E_{\\text{RHE vs. SHE}}$$\nSubstituting the calculated values:\n$$E_{\\text{vs. RHE}} = (-0.216\\,\\mathrm{V}) - (-0.62118\\,\\mathrm{V}) = -0.216\\,\\mathrm{V} + 0.62118\\,\\mathrm{V} = 0.40518\\,\\mathrm{V}$$\nThe problem requires rounding the final answers to four significant figures.\nThe potential versus SHE is $-0.216\\,\\mathrm{V}$, which becomes $-0.2160\\,\\mathrm{V}$.\nThe potential versus RHE is $0.40518\\,\\mathrm{V}$, which becomes $0.4052\\,\\mathrm{V}$.\n\nThe final computed potentials are:\n- Potential vs. SHE: $-0.2160\\,\\mathrm{V}$\n- Potential vs. RHE at $\\mathrm{pH}=10.50$: $0.4052\\,\\mathrm{V}$",
            "answer": "$$\\boxed{\\begin{pmatrix} -0.2160  0.4052 \\end{pmatrix}}$$"
        },
        {
            "introduction": "The lines on a Pourbaix diagram represent equilibrium boundaries between the most stable phases. This exercise focuses on calculating a non-redox, pH-dependent boundary corresponding to the precipitation of a solid hydroxide from an aqueous solution. By applying the principles of chemical equilibrium and the solubility product constant ($K_{sp}$), you will determine the exact pH at which a dissolved species becomes unstable with respect to its solid phase, forming a vertical line on the diagram. ",
            "id": "4239756",
            "problem": "You are constructing a computational Pourbaix diagram for a trivalent metal $\\mathrm{M}$ in aqueous solution at temperature $T = 298.15\\,\\mathrm{K}$. In such diagrams, the precipitation boundary for $\\mathrm{M(OH)_3(s)}$ is determined by the solution $\\mathrm{pH}$ at which the aqueous metal becomes saturated with respect to the solid hydroxide under specified conditions.\n\nAssume the following idealized but scientifically realistic setting:\n- The only aqueous metal species present is the free ion $\\mathrm{M^{3+}}$ prior to the onset of precipitation, and you neglect hydrolysis and complexation reactions of $\\mathrm{M^{3+}}$.\n- Activities are approximated by concentrations (ideal dilute solution), so activity coefficients are set to unity.\n- A large excess of inert electrolyte is present to maintain constant ionic strength and to ensure overall electroneutrality, but the electrolyte does not participate in acid–base or metal complexation chemistry.\n- The autoionization of water obeys $K_{w} = 1.0 \\times 10^{-14}$, where $K_{w}$ is the thermodynamic equilibrium constant for water autoprotolysis.\n- The solubility product constant $K_{sp}$ for $\\mathrm{M(OH)_3(s)}$ at $T = 298.15\\,\\mathrm{K}$ is $K_{sp} = 8.0 \\times 10^{-36}$.\n- The total analytical concentration of dissolved metal, $C_{M}$, is fixed at $C_{M} = 2.0 \\times 10^{-6}\\,\\mathrm{M}$.\n\nStarting from first principles—namely, the definition of $\\mathrm{pH}$ as $\\mathrm{pH} = -\\log_{10}(a_{H^{+}})$ (with activities equal to concentrations in this idealized setting), the charge neutrality condition for the solution, mass balance on the metal, and the equilibrium definition of a solubility product—derive the $\\mathrm{pH}$ at which precipitation of $\\mathrm{M(OH)_3(s)}$ first occurs. Round your final numerical $\\mathrm{pH}$ value to four significant figures. The answer must be a single real number.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard equilibrium chemistry calculation relevant to the construction of a computational Pourbaix diagram. The provided data are self-contained and consistent, and the assumptions—such as approximating activities with concentrations and neglecting hydrolysis of the metal ion—are explicitly stated and common for idealized textbook problems. Therefore, the problem is deemed valid and a rigorous solution can be derived.\n\nThe precipitation of the solid metal hydroxide, $\\mathrm{M(OH)_3(s)}$, from an aqueous solution containing the trivalent metal ion, $\\mathrm{M^{3+}}$, is governed by the following solubility equilibrium:\n$$\n\\mathrm{M(OH)_3(s)} \\rightleftharpoons \\mathrm{M^{3+}(aq)} + 3\\mathrm{OH^{-}(aq)}\n$$\nThe thermodynamic equilibrium for this reaction is described by the solubility product constant, $K_{sp}$. The expression for $K_{sp}$ is given in terms of the activities of the products:\n$$\nK_{sp} = a_{\\mathrm{M^{3+}}} \\cdot (a_{\\mathrm{OH^{-}}})^3\n$$\nwhere $a_i$ represents the activity of species $i$. The activity of the pure solid, $\\mathrm{M(OH)_3(s)}$, is unity by convention. The problem specifies that in this idealized setting, activities are to be approximated by molar concentrations, denoted by square brackets $[...]$. Thus, the equilibrium expression becomes:\n$$\nK_{sp} = [\\mathrm{M^{3+}}][\\mathrm{OH^{-}}]^{3}\n$$\nPrecipitation begins at the exact point where the solution becomes saturated with respect to the solid. At this threshold, the ion product of the species in solution equals the solubility product constant. The problem states that the total analytical concentration of dissolved metal, $C_M$, is fixed. Prior to the onset of precipitation, all dissolved metal exists as the free ion $\\mathrm{M^{3+}}$. Therefore, at the precise moment precipitation begins, the concentration of the metal ion is equal to the total analytical concentration:\n$$\n[\\mathrm{M^{3+}}] = C_M = 2.0 \\times 10^{-6}\\,\\mathrm{M}\n$$\nWe can substitute this concentration into the $K_{sp}$ expression to find the hydroxide ion concentration, $[\\mathrm{OH^{-}}]$, required to initiate precipitation:\n$$\nK_{sp} = C_M [\\mathrm{OH^{-}}]^{3}\n$$\nSolving for $[\\mathrm{OH^{-}}]$ yields:\n$$\n[\\mathrm{OH^{-}}] = \\left( \\frac{K_{sp}}{C_M} \\right)^{1/3}\n$$\nThe hydroxide ion concentration is related to the hydrogen ion concentration, $[\\mathrm{H^{+}}]$, through the autoionization constant of water, $K_w$, at the given temperature of $T=298.15\\,\\mathrm{K}$:\n$$\nK_w = [\\mathrm{H^{+}}][\\mathrm{OH^{-}}] = 1.0 \\times 10^{-14}\n$$\nFrom this relationship, we can express $[\\mathrm{H^{+}}]$ as:\n$$\n[\\mathrm{H^{+}}] = \\frac{K_w}{[\\mathrm{OH^{-}}]}\n$$\nSubstituting the expression for $[\\mathrm{OH^{-}}]$ from the solubility equilibrium gives us the hydrogen ion concentration at the precipitation boundary:\n$$\n[\\mathrm{H^{+}}] = \\frac{K_w}{\\left( \\frac{K_{sp}}{C_M} \\right)^{1/3}} = K_w \\left( \\frac{C_M}{K_{sp}} \\right)^{1/3}\n$$\nThe problem asks for the $\\mathrm{pH}$, which is defined as the negative base-10 logarithm of the hydrogen ion activity, here approximated by concentration:\n$$\n\\mathrm{pH} = -\\log_{10}([\\mathrm{H^{+}}])\n$$\nSubstituting our expression for $[\\mathrm{H^{+}}]$:\n$$\n\\mathrm{pH} = -\\log_{10} \\left( K_w \\left( \\frac{C_M}{K_{sp}} \\right)^{1/3} \\right)\n$$\nUsing the properties of logarithms, this can be expanded:\n$$\n\\mathrm{pH} = -\\log_{10}(K_w) - \\log_{10} \\left( \\left( \\frac{C_M}{K_{sp}} \\right)^{1/3} \\right)\n$$\n$$\n\\mathrm{pH} = -\\log_{10}(K_w) - \\frac{1}{3} \\log_{10} \\left( \\frac{C_M}{K_{sp}} \\right)\n$$\nRecognizing that $\\mathrm{p}K_w = -\\log_{10}(K_w)$, and that $\\log_{10}(A/B) = -\\log_{10}(B/A)$, we can rewrite the expression as:\n$$\n\\mathrm{pH} = \\mathrm{p}K_w + \\frac{1}{3} \\log_{10} \\left( \\frac{K_{sp}}{C_M} \\right)\n$$\nNow, we substitute the numerical values provided in the problem statement:\n$K_w = 1.0 \\times 10^{-14}$, so $\\mathrm{p}K_w = 14.00$\n$K_{sp} = 8.0 \\times 10^{-36}$\n$C_M = 2.0 \\times 10^{-6}\\,\\mathrm{M}$\n\nFirst, calculate the ratio $\\frac{K_{sp}}{C_M}$:\n$$\n\\frac{K_{sp}}{C_M} = \\frac{8.0 \\times 10^{-36}}{2.0 \\times 10^{-6}} = 4.0 \\times 10^{-30}\n$$\nNow, substitute this into the equation for $\\mathrm{pH}$:\n$$\n\\mathrm{pH} = 14.00 + \\frac{1}{3} \\log_{10} \\left( 4.0 \\times 10^{-30} \\right)\n$$\n$$\n\\mathrm{pH} = 14.00 + \\frac{1}{3} \\left( \\log_{10}(4.0) + \\log_{10}(10^{-30}) \\right)\n$$\n$$\n\\mathrm{pH} = 14.00 + \\frac{1}{3} \\left( \\log_{10}(4.0) - 30 \\right)\n$$\n$$\n\\mathrm{pH} = 14.00 + \\frac{\\log_{10}(4.0)}{3} - \\frac{30}{3}\n$$\n$$\n\\mathrm{pH} = 14.00 - 10.00 + \\frac{\\log_{10}(4.0)}{3}\n$$\n$$\n\\mathrm{pH} = 4.00 + \\frac{\\log_{10}(4.0)}{3}\n$$\nUsing a calculator for $\\log_{10}(4.0)$:\n$\\log_{10}(4.0) \\approx 0.60205999$\n$$\n\\mathrm{pH} \\approx 4.00 + \\frac{0.60205999}{3}\n$$\n$$\n\\mathrm{pH} \\approx 4.00 + 0.20068666\n$$\n$$\n\\mathrm{pH} \\approx 4.20068666\n$$\nRounding the final answer to four significant figures, as requested, gives:\n$$\n\\mathrm{pH} = 4.201\n$$\nThis is the $\\mathrm{pH}$ at which the concentration of $\\mathrm{OH^{-}}$ ions becomes just high enough to cause saturation of the solution with respect to $\\mathrm{M(OH)_3(s)}$ for the given metal concentration, leading to the onset of precipitation. The problem's mention of \"charge neutrality\" is satisfied by the \"large excess of inert electrolyte,\" which allows us to determine the pH based on the solubility equilibrium without solving a complex system of charge-balance equations.",
            "answer": "$$\\boxed{4.201}$$"
        },
        {
            "introduction": "The ultimate goal is to determine the most stable phase at any given ($E$, pH) condition, which corresponds to the phase with the minimum grand potential, $\\Psi$. This capstone exercise guides you through the implementation of the powerful 'grid method,' a fundamental algorithm for constructing Pourbaix diagrams from first-principles thermodynamic data. You will derive the expression for $\\Psi$ as a function of $E$ and pH, and then write a program to systematically map out the stability regions, revealing the complete thermodynamic landscape of the system. ",
            "id": "4239726",
            "problem": "You are asked to design and implement a complete, runnable program that constructs stability-region assignments for a simplified computational Pourbaix diagram by discretizing the electrode potential–acidity plane and selecting the phase with minimum grand potential at each grid point. The program must be based on first principles and must produce results that are directly testable. The setting is a hypothetical metal $\\mathrm{X}$ with three solid phases: $\\mathrm{X}(\\mathrm{s})$, $\\mathrm{XO}(\\mathrm{s})$, and $\\mathrm{X(OH)}_2(\\mathrm{s})$.\n\nFundamental base and core definitions to use in the construction:\n- The Gibbs free energy $G$ per formula unit is measured in $\\mathrm{eV}$.\n- The grand potential $\\Psi$ of a phase at fixed chemical potentials is defined as the Legendre transform of the Gibbs free energy that accounts for open reservoirs. For a phase $\\mathrm{X}_a \\mathrm{H}_b \\mathrm{O}_c$, the per-metal grand potential is $$\\Psi = \\frac{G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - b \\mu_{\\mathrm{H}} - c \\mu_{\\mathrm{O}}}{a}$$ where $\\mu_{\\mathrm{X}}^{\\mathrm{ref}}$ is the reference chemical potential of $\\mathrm{X}$ (the bulk metal), $\\mu_{\\mathrm{H}}$ is the chemical potential of hydrogen, and $\\mu_{\\mathrm{O}}$ is the chemical potential of oxygen.\n- The electrochemical potential of the electron satisfies $$\\mu_e(E) = - E$$ in $\\mathrm{eV}$, because $1\\,\\mathrm{eV} = 1\\,e \\cdot \\mathrm{V}$.\n- For hydrogen ions at temperature $T = 298.15\\,\\mathrm{K}$, the chemical potential obeys $$\\mu_{\\mathrm{H}^+}(pH) = \\mu_{\\mathrm{H}^+}^{0} + k_B T \\ln a_{\\mathrm{H}^+}$$ where $a_{\\mathrm{H}^+} = 10^{-pH}$, $k_B$ is the Boltzmann constant, and $k_B T \\ln 10 = 0.059161\\,\\mathrm{eV}$. The hydrogen atomic chemical potential is related by $$\\mu_{\\mathrm{H}} = \\mu_{\\mathrm{H}^+} + \\mu_e.$$\n- The water equilibrium constraint eliminates oxygen via $$\\mu_{\\mathrm{H_2O}}^{0} = \\mu_{\\mathrm{O}} + 2 \\mu_{\\mathrm{H}}$$ with $\\mu_{\\mathrm{H_2O}}^{0}$ a constant at standard state. This relation must be used to express $\\mu_{\\mathrm{O}}$ in terms of $\\mu_{\\mathrm{H_2O}}^{0}$ and $\\mu_{\\mathrm{H}}$.\n\nYour program must:\n1. Discretize the electrode potential–acidity plane $(E,\\mathrm{pH})$ into a rectangular grid of specified ranges and counts. Treat $E$ in volts relative to the Standard Hydrogen Electrode (SHE) and $\\mathrm{pH}$ as dimensionless. Each grid point is a pair $(E_i, \\mathrm{pH}_j)$.\n2. At each grid point, use the relationships above to eliminate $\\mu_{\\mathrm{O}}$ and express $\\Psi$ for each phase in terms of $E$ and $\\mathrm{pH}$, together with the provided constants $G$, $\\mu_{\\mathrm{X}}^{\\mathrm{ref}}$, $\\mu_{\\mathrm{H}^+}^{0}$, and $\\mu_{\\mathrm{H_2O}}^{0}$.\n3. For the three phases with compositions $\\mathrm{X}$, $\\mathrm{XO}$, and $\\mathrm{X(OH)}_2$, use $(a,b,c) = (1,0,0)$, $(1,0,1)$, and $(1,2,2)$, respectively.\n4. Assign the stable phase at each grid point by selecting the one with the minimum $\\Psi$. Use a numerical tolerance $\\epsilon = 10^{-12}$: if two or more phases have $\\Psi$ values within $\\epsilon$ of the minimum, break ties deterministically by lexicographic order of phase labels, $\\mathrm{X}  \\mathrm{XO}  \\mathrm{X(OH)}_2$.\n5. Compute the fraction of grid points assigned to each phase (i.e., counts divided by the total number of grid points) for each test scenario.\n\nRequired output:\n- The program must output a single line containing the results for all test scenarios, aggregated as a Python-style list of lists, with each inner list containing three decimal fractions corresponding to $[\\mathrm{X}, \\mathrm{XO}, \\mathrm{X(OH)}_2]$ in that order. Each fraction must be rounded to six decimal places. For example, the output must look like $$\\texttt{[[f1\\_X,f1\\_XO,f1\\_XOH2],[f2\\_X,f2\\_XO,f2\\_XOH2],...]}.$$\n\nTest suite and parameter specification:\n- Use $k_B T \\ln 10 = 0.059161\\,\\mathrm{eV}$ at $T=298.15\\,\\mathrm{K}$.\n- Test Case 1 (general case):\n    - $E \\in [-1.0, 1.0]$ with $51$ equally spaced points.\n    - $\\mathrm{pH} \\in [0.0, 14.0]$ with $51$ equally spaced points.\n    - Energies: $G_{\\mathrm{X}} = 0.0\\,\\mathrm{eV}$, $G_{\\mathrm{XO}} = -2.50\\,\\mathrm{eV}$, $G_{\\mathrm{X(OH)}_2} = -5.20\\,\\mathrm{eV}$.\n    - References: $\\mu_{\\mathrm{X}}^{\\mathrm{ref}} = 0.0\\,\\mathrm{eV}$, $\\mu_{\\mathrm{H}^+}^{0} = 0.0\\,\\mathrm{eV}$, $\\mu_{\\mathrm{H_2O}}^{0} = -2.46\\,\\mathrm{eV}$.\n- Test Case 2 (coarse boundary grid):\n    - $E \\in [-1.0, -0.1]$ with $2$ points.\n    - $\\mathrm{pH} \\in [0.0, 14.0]$ with $2$ points.\n    - Use the same energies and references as Test Case 1.\n- Test Case 3 (edge potentials at acidic condition):\n    - $E \\in [-2.0, 2.0]$ with $401$ points.\n    - $\\mathrm{pH} = 0.0$ with $1$ point.\n    - Use the same energies and references as Test Case 1.\n- Test Case 4 (tie-dominated scenario between oxide and hydroxide):\n    - $E \\in [-0.5, 0.5]$ with $21$ points.\n    - $\\mathrm{pH} = 7.0$ with $1$ point.\n    - Energies: $G_{\\mathrm{X}} = 0.0\\,\\mathrm{eV}$, $G_{\\mathrm{XO}} = -3.00\\,\\mathrm{eV}$, $G_{\\mathrm{X(OH)}_2} = -6.00\\,\\mathrm{eV}$.\n    - References: $\\mu_{\\mathrm{X}}^{\\mathrm{ref}} = 0.0\\,\\mathrm{eV}$, $\\mu_{\\mathrm{H}^+}^{0} = 0.0\\,\\mathrm{eV}$, $\\mu_{\\mathrm{H_2O}}^{0} = -3.00\\,\\mathrm{eV}$.\n    - This choice enforces equal constants and identical $(E,\\mathrm{pH})$ dependence for $\\mathrm{XO}$ and $\\mathrm{X(OH)}_2$, so ties occur wherever these phases are favored over $\\mathrm{X}$; deterministic lexicographic tie-breaking must be applied.\n\nAngle units are not applicable. Express all energy values in $\\mathrm{eV}$, potentials in $\\mathrm{V}$, and $\\mathrm{pH}$ as dimensionless. The final output is the single line with the exact format described above, with each fraction rounded to six decimal places.",
            "solution": "The problem is well-posed, scientifically grounded, objective, and contains all necessary information to derive a unique solution. The definitions and principles provided are standard in computational electrochemistry for the construction of Pourbaix diagrams. The task is to implement a program that identifies the most stable phase of a hypothetical metal $\\mathrm{X}$ across a discretized grid of electrode potential ($E$) and acidity ($\\mathrm{pH}$) by minimizing the grand potential, $\\Psi$.\n\n### Step 1: Derivation of the Grand Potential Expressions\n\nThe grand potential $\\Psi$ for a phase with stoichiometry $\\mathrm{X}_a \\mathrm{H}_b \\mathrm{O}_c$ is given by:\n$$\n\\Psi = \\frac{1}{a} (G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - b \\mu_{\\mathrm{H}} - c \\mu_{\\mathrm{O}})\n$$\nwhere $G$ is the Gibbs free energy of the phase, and $\\mu_{\\mathrm{X}}^{\\mathrm{ref}}$, $\\mu_{\\mathrm{H}}$, and $\\mu_{\\mathrm{O}}$ are the chemical potentials of the constituent species in their respective reservoirs. Our first task is to express $\\Psi$ as a function of the independent variables $E$ (electrode potential) and $\\mathrm{pH}$.\n\nThe problem provides the following relationships at a temperature of $T=298.15\\,\\mathrm{K}$:\n1.  The chemical potential of a hydrogen atom, $\\mu_{\\mathrm{H}}$, is the sum of the chemical potentials of a proton, $\\mu_{\\mathrm{H}^+}$, and an electron, $\\mu_e$:\n    $$\n    \\mu_{\\mathrm{H}} = \\mu_{\\mathrm{H}^+} + \\mu_e\n    $$\n2.  The electrochemical potential of the electron is $\\mu_e(E) = -E$, where $E$ is the potential in Volts on the Standard Hydrogen Electrode (SHE) scale, and $\\mu_e$ is in electron-volts ($\\mathrm{eV}$).\n3.  The chemical potential of the proton is a function of $\\mathrm{pH}$:\n    $$\n    \\mu_{\\mathrm{H}^+}(\\mathrm{pH}) = \\mu_{\\mathrm{H}^+}^{0} + k_B T \\ln a_{\\mathrm{H}^+} = \\mu_{\\mathrm{H}^+}^{0} + k_B T \\ln(10^{-\\mathrm{pH}}) = \\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} (k_B T \\ln 10)\n    $$\n    where $\\mu_{\\mathrm{H}^+}^{0}$ is the standard chemical potential of the proton. Let $k_{pH} = k_B T \\ln 10 = 0.059161\\,\\mathrm{eV}$.\n    Combining these, the hydrogen chemical potential becomes:\n    $$\n    \\mu_{\\mathrm{H}}(E, \\mathrm{pH}) = (\\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} \\cdot k_{pH}) - E\n    $$\n4.  The oxygen chemical potential, $\\mu_{\\mathrm{O}}$, is constrained by the water equilibrium reaction, $2\\mathrm{H} + \\mathrm{O} \\rightleftharpoons \\mathrm{H_2O}$:\n    $$\n    \\mu_{\\mathrm{H_2O}}^{0} = 2\\mu_{\\mathrm{H}} + \\mu_{\\mathrm{O}}\n    $$\n    where $\\mu_{\\mathrm{H_2O}}^{0}$ is the standard chemical potential of water. This allows us to eliminate $\\mu_{\\mathrm{O}}$:\n    $$\n    \\mu_{\\mathrm{O}} = \\mu_{\\mathrm{H_2O}}^{0} - 2\\mu_{\\mathrm{H}}\n    $$\n\nSubstituting the expressions for $\\mu_{\\mathrm{O}}$ and subsequently $\\mu_{\\mathrm{H}}$ into the grand potential formula:\n$$\n\\Psi = \\frac{1}{a} (G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - b \\mu_{\\mathrm{H}} - c (\\mu_{\\mathrm{H_2O}}^{0} - 2\\mu_{\\mathrm{H}}))\n$$\n$$\n\\Psi = \\frac{1}{a} (G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - c \\mu_{\\mathrm{H_2O}}^{0} + (2c - b) \\mu_{\\mathrm{H}})\n$$\n$$\n\\Psi(E, \\mathrm{pH}) = \\frac{1}{a} [G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - c \\mu_{\\mathrm{H_2O}}^{0} + (2c - b) (\\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} \\cdot k_{pH} - E)]\n$$\nThis equation expresses the grand potential of any phase $\\mathrm{X}_a \\mathrm{H}_b \\mathrm{O}_c$ as a linear function of $E$ and $\\mathrm{pH}$.\n\n### Step 2: Application to Specific Phases\n\nWe apply this general formula to the three specified solid phases. In all cases, the stoichiometry is per formula unit, so $a=1$.\n\n1.  **Phase $\\mathrm{X}(\\mathrm{s})$**: $(a,b,c) = (1,0,0)$\n    $$\n    \\Psi_{\\mathrm{X}} = \\frac{1}{1} [G_{\\mathrm{X}} - 1 \\cdot \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - 0 \\cdot \\mu_{\\mathrm{H_2O}}^{0} + (2\\cdot 0 - 0) (\\dots)] = G_{\\mathrm{X}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}}\n    $$\n    The grand potential of the pure metal is constant, independent of $E$ and $\\mathrm{pH}$.\n\n2.  **Phase $\\mathrm{XO}(\\mathrm{s})$**: $(a,b,c) = (1,0,1)$\n    $$\n    \\Psi_{\\mathrm{XO}}(E, \\mathrm{pH}) = [G_{\\mathrm{XO}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - 1 \\cdot \\mu_{\\mathrm{H_2O}}^{0}] + (2\\cdot 1 - 0)[\\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} \\cdot k_{pH} - E]\n    $$\n    $$\n    \\Psi_{\\mathrm{XO}}(E, \\mathrm{pH}) = (G_{\\mathrm{XO}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - \\mu_{\\mathrm{H_2O}}^{0} + 2\\mu_{\\mathrm{H}^+}^{0}) - 2E - 2 k_{pH} \\cdot \\mathrm{pH}\n    $$\n\n3.  **Phase $\\mathrm{X(OH)}_2(\\mathrm{s})$**: $(a,b,c) = (1,2,2)$\n    $$\n    \\Psi_{\\mathrm{X(OH)_2}}(E, \\mathrm{pH}) = [G_{\\mathrm{X(OH)_2}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - 2 \\cdot \\mu_{\\mathrm{H_2O}}^{0}] + (2\\cdot 2 - 2)[\\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} \\cdot k_{pH} - E]\n    $$\n    $$\n    \\Psi_{\\mathrm{X(OH)_2}}(E, \\mathrm{pH}) = (G_{\\mathrm{X(OH)_2}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - 2\\mu_{\\mathrm{H_2O}}^{0} + 2\\mu_{\\mathrm{H}^+}^{0}) - 2E - 2 k_{pH} \\cdot \\mathrm{pH}\n    $$\n\n### Step 3: Computational Strategy\n\nFor each test case, the program will perform the following steps:\n1.  Define the constants provided in the problem ($G$ values, $\\mu$ references, $k_{pH}$).\n2.  Construct the $(E, \\mathrm{pH})$ grid. We use `numpy.linspace` to generate the arrays of $E$ and $\\mathrm{pH}$ values, and `numpy.meshgrid` to create two-dimensional grid arrays, `E_grid` and `pH_grid`.\n3.  Calculate the grand potential for each phase at every point on the grid. This is done using vectorized operations on the NumPy grid arrays, based on the equations derived above.\n    -   $\\Psi_{\\mathrm{X}}$ is calculated as a scalar and broadcast to the grid shape.\n    -   $\\Psi_{\\mathrm{XO}}$ and $\\Psi_{\\mathrm{X(OH)_2}}$ are calculated as two-dimensional arrays.\n4.  Determine the stable phase at each grid point.\n    -   The three $\\Psi$ arrays are stacked along a new axis to form a $3 \\times N_{pH} \\times N_{E}$ array.\n    -   The minimum $\\Psi$ value is found for each grid point along this new axis.\n    -   To handle ties, we identify all phases whose $\\Psi$ is within a tolerance $\\epsilon = 10^{-12}$ of the minimum value at that point.\n    -   The stable phase is chosen based on the lexicographic tie-breaking rule: $\\mathrm{X}  \\mathrm{XO}  \\mathrm{X(OH)_2}$. This is efficiently implemented by finding the first index (from $0, 1, 2$) that corresponds to a minimal-energy phase. The `numpy.argmax` function on a boolean array achieves this, as it returns the index of the first `True` value.\n5.  Count the occurrences of each stable phase. The `numpy.bincount` function is used on the flattened array of stable phase indices to obtain the total count for each phase.\n6.  Calculate the fraction of the grid assigned to each phase by dividing the counts by the total number of grid points.\n7.  The final results for each test case are rounded to six decimal places and formatted into the required output string.\n\nThis vectorized approach ensures high numerical efficiency and correctness by operating on the entire grid simultaneously, avoiding slow Python loops.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stable phase fractions in a simplified Pourbaix diagram\n    for multiple test cases, according to the problem specification.\n    \"\"\"\n    \n    # Fundamental constants\n    K_PH = 0.059161  # eV, value of k_B * T * ln(10)\n    EPSILON = 1e-12  # Tolerance for tie-breaking\n\n    # Test suite and parameter specifications\n    test_cases = [\n        {\n            # Test Case 1 (general case)\n            \"E_range\": (-1.0, 1.0), \"E_count\": 51,\n            \"pH_range\": (0.0, 14.0), \"pH_count\": 51,\n            \"G_values\": {\"X\": 0.0, \"XO\": -2.50, \"X(OH)2\": -5.20}, # eV\n            \"mu_refs\": {\"X_ref\": 0.0, \"H_plus_0\": 0.0, \"H2O_0\": -2.46} # eV\n        },\n        {\n            # Test Case 2 (coarse boundary grid)\n            \"E_range\": (-1.0, -0.1), \"E_count\": 2,\n            \"pH_range\": (0.0, 14.0), \"pH_count\": 2,\n            \"G_values\": {\"X\": 0.0, \"XO\": -2.50, \"X(OH)2\": -5.20}, # eV\n            \"mu_refs\": {\"X_ref\": 0.0, \"H_plus_0\": 0.0, \"H2O_0\": -2.46} # eV\n        },\n        {\n            # Test Case 3 (edge potentials at acidic condition)\n            \"E_range\": (-2.0, 2.0), \"E_count\": 401,\n            \"pH_range\": (0.0, 0.0), \"pH_count\": 1,\n            \"G_values\": {\"X\": 0.0, \"XO\": -2.50, \"X(OH)2\": -5.20}, # eV\n            \"mu_refs\": {\"X_ref\": 0.0, \"H_plus_0\": 0.0, \"H2O_0\": -2.46} # eV\n        },\n        {\n            # Test Case 4 (tie-dominated scenario)\n            \"E_range\": (-0.5, 0.5), \"E_count\": 21,\n            \"pH_range\": (7.0, 7.0), \"pH_count\": 1,\n            \"G_values\": {\"X\": 0.0, \"XO\": -3.00, \"X(OH)2\": -6.00}, # eV\n            \"mu_refs\": {\"X_ref\": 0.0, \"H_plus_0\": 0.0, \"H2O_0\": -3.00} # eV\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        E_min, E_max = case[\"E_range\"]\n        E_count = case[\"E_count\"]\n        pH_min, pH_max = case[\"pH_range\"]\n        pH_count = case[\"pH_count\"]\n        \n        G_X = case[\"G_values\"][\"X\"]\n        G_XO = case[\"G_values\"][\"XO\"]\n        G_XOH2 = case[\"G_values\"][\"X(OH)2\"]\n        \n        mu_X_ref = case[\"mu_refs\"][\"X_ref\"]\n        mu_H_plus_0 = case[\"mu_refs\"][\"H_plus_0\"]\n        mu_H2O_0 = case[\"mu_refs\"][\"H2O_0\"]\n\n        # Create the E-pH grid\n        E_vals = np.linspace(E_min, E_max, E_count)\n        pH_vals = np.linspace(pH_min, pH_max, pH_count)\n        E_grid, pH_grid = np.meshgrid(E_vals, pH_vals, indexing='ij')\n\n        # Calculate grand potential Psi for each phase on the grid\n        \n        # Phase X: Psi = G_X - mu_X_ref\n        psi_X = np.full(E_grid.shape, G_X - mu_X_ref)\n\n        # Phase XO: Psi = (G_XO - mu_X_ref - mu_H2O_0 + 2*mu_H_plus_0) - 2*E - 2*k_pH*pH\n        const_XO = G_XO - mu_X_ref - mu_H2O_0 + 2 * mu_H_plus_0\n        psi_XO = const_XO - 2 * E_grid - 2 * K_PH * pH_grid\n\n        # Phase X(OH)2: Psi = (G_XOH2 - mu_X_ref - 2*mu_H2O_0 + 2*mu_H_plus_0) - 2*E - 2*k_pH*pH\n        const_XOH2 = G_XOH2 - mu_X_ref - 2 * mu_H2O_0 + 2 * mu_H_plus_0\n        psi_XOH2 = const_XOH2 - 2 * E_grid - 2 * K_PH * pH_grid\n\n        # Stack Psi arrays for comparison: axis 0 corresponds to [X, XO, X(OH)2]\n        psi_stack = np.stack([psi_X, psi_XO, psi_XOH2], axis=0)\n\n        # Find the minimum Psi value at each grid point\n        min_psi = np.min(psi_stack, axis=0, keepdims=True)\n\n        # Identify all phases within epsilon of the minimum\n        # The shape of is_min is (3, E_count, pH_count)\n        is_min = (psi_stack = min_psi + EPSILON)\n\n        # Apply lexicographic tie-breaking: X  XO  X(OH)2\n        # np.argmax returns the index of the first True value along axis 0.\n        # This corresponds to the phase index (0, 1, or 2) and correctly\n        # implements the tie-breaking rule.\n        stable_indices = np.argmax(is_min, axis=0)\n\n        # Count the number of grid points for each stable phase\n        # minlength=3 ensures counts for all three phases even if some are zero.\n        counts = np.bincount(stable_indices.flatten(), minlength=3)\n        \n        # Calculate fractions\n        total_points = E_count * pH_count\n        fractions = counts / total_points\n        \n        all_results.append(fractions)\n\n    # Format the final output string\n    formatted_results = []\n    for res in all_results:\n        # Format each fraction to 6 decimal places\n        formatted_list = [f\"{x:.6f}\" for x in res]\n        formatted_results.append(f\"[{','.join(formatted_list)}]\")\n    \n    print(f\"[[{','.join(formatted_results)}]]\")\n\nsolve()\n```"
        }
    ]
}