{
    "hands_on_practices": [
        {
            "introduction": "掌握 Pourbaix 图的一个基本功是理解图中各种边界线的物理化学意义。本练习将引导你计算一个核心特征：溶解离子与固体沉淀物之间的边界。通过应用溶度积常数（$K_{sp}$）等化学平衡基本原理，你将学会如何确定在给定离子浓度下，促使沉淀发生的临界 $\\mathrm{pH}$ 值。这个实践有助于你深入理解 Pourbaix 图中的垂直线是如何由溶液化学决定的。",
            "id": "4239756",
            "problem": "您正在构建一种三价金属 $\\mathrm{M}$ 在温度 $T = 298.15\\,\\mathrm{K}$ 的水溶液中的计算Pourbaix图。在此类图中，$\\mathrm{M(OH)_3(s)}$ 的沉淀边界由在指定条件下，含水金属相对于固体氢氧化物达到饱和时的溶液 $\\mathrm{pH}$ 值决定。\n\n假设存在以下理想化但科学上现实的设定：\n- 在沉淀开始之前，唯一存在的水合金属物种是自由离子 $\\mathrm{M^{3+}}$，并且您忽略了 $\\mathrm{M^{3+}}$ 的水解和络合反应。\n- 活度由浓度近似（理想稀溶液），因此活度系数设为1。\n- 存在大量过量的惰性电解质以维持恒定的离子强度并确保整体电中性，但该电解质不参与酸碱或金属络合化学反应。\n- 水的自偶电离遵循 $K_{w} = 1.0 \\times 10^{-14}$，其中 $K_{w}$ 是水自偶电离的热力学平衡常数。\n- 在温度 $T = 298.15\\,\\mathrm{K}$ 时，$\\mathrm{M(OH)_3(s)}$ 的溶度积常数 $K_{sp}$ 为 $K_{sp} = 8.0 \\times 10^{-36}$。\n- 溶解金属的总分析浓度 $C_{M}$ 固定为 $C_{M} = 2.0 \\times 10^{-6}\\,\\mathrm{M}$。\n\n从第一性原理出发——即 $\\mathrm{pH}$ 的定义为 $\\mathrm{pH} = -\\log_{10}(a_{H^{+}})$（在此理想化设定中活度等于浓度）、溶液的电荷中性条件、金属的质量平衡以及溶度积的平衡定义——推导 $\\mathrm{M(OH)_3(s)}$ 开始沉淀时的 $\\mathrm{pH}$ 值。将最终的数值 $\\mathrm{pH}$ 值四舍五入到四位有效数字。答案必须是一个实数。",
            "solution": "所述问题具有科学依据、提法恰当且客观。它提出了一个与构建计算Pourbaix图相关的标准平衡化学计算。所提供的数据是自洽且一致的，并且其假设——例如用浓度近似活度以及忽略金属离子的水解——都已明确说明，并且是理想化教科书问题中的常见做法。因此，该问题被认为是有效的，可以推导出一个严谨的解。\n\n固体金属氢氧化物 $\\mathrm{M(OH)_3(s)}$ 从含有三价金属离子 $\\mathrm{M^{3+}}$ 的水溶液中沉淀出来，受以下溶解平衡控制：\n$$\n\\mathrm{M(OH)_3(s)} \\rightleftharpoons \\mathrm{M^{3+}(aq)} + 3\\mathrm{OH^{-}(aq)}\n$$\n该反应的热力学平衡由溶度积常数 $K_{sp}$ 描述。$K_{sp}$ 的表达式以产物的活度表示：\n$$\nK_{sp} = a_{\\mathrm{M^{3+}}} \\cdot (a_{\\mathrm{OH^{-}}})^3\n$$\n其中 $a_i$ 代表物种 $i$ 的活度。根据惯例，纯固体 $\\mathrm{M(OH)_3(s)}$ 的活度为1。问题指明，在这种理想化设定中，活度将用摩尔浓度（用方括号 $[...]$ 表示）来近似。因此，平衡表达式变为：\n$$\nK_{sp} = [\\mathrm{M^{3+}}][\\mathrm{OH^{-}}]^{3}\n$$\n沉淀始于溶液相对于固体达到饱和的那一刻。在此阈值下，溶液中物种的离子积等于溶度积常数。问题指出，溶解金属的总分析浓度 $C_M$ 是固定的。在沉淀开始之前，所有溶解的金属都以自由离子 $\\mathrm{M^{3+}}$ 的形式存在。因此，在沉淀开始的精确时刻，金属离子的浓度等于总分析浓度：\n$$\n[\\mathrm{M^{3+}}] = C_M = 2.0 \\times 10^{-6}\\,\\mathrm{M}\n$$\n我们可以将此浓度代入 $K_{sp}$ 表达式，以求出引发沉淀所需的氢氧根离子浓度 $[\\mathrm{OH^{-}}]$：\n$$\nK_{sp} = C_M [\\mathrm{OH^{-}}]^{3}\n$$\n求解 $[\\mathrm{OH^{-}}]$ 得：\n$$\n[\\mathrm{OH^{-}}] = \\left( \\frac{K_{sp}}{C_M} \\right)^{1/3}\n$$\n氢氧根离子浓度通过在给定温度 $T=298.15\\,\\mathrm{K}$ 下水的自偶电离常数 $K_w$ 与氢离子浓度 $[\\mathrm{H^{+}}]$ 相关联：\n$$\nK_w = [\\mathrm{H^{+}}][\\mathrm{OH^{-}}] = 1.0 \\times 10^{-14}\n$$\n根据此关系，我们可以将 $[\\mathrm{H^{+}}]$ 表示为：\n$$\n[\\mathrm{H^{+}}] = \\frac{K_w}{[\\mathrm{OH^{-}}]}\n$$\n将溶解平衡中 $[\\mathrm{OH^{-}}]$ 的表达式代入，我们得到沉淀边界处的氢离子浓度：\n$$\n[\\mathrm{H^{+}}] = \\frac{K_w}{\\left( \\frac{K_{sp}}{C_M} \\right)^{1/3}} = K_w \\left( \\frac{C_M}{K_{sp}} \\right)^{1/3}\n$$\n问题要求计算 $\\mathrm{pH}$，其定义为氢离子活度的负常用对数，此处用浓度来近似：\n$$\n\\mathrm{pH} = -\\log_{10}([\\mathrm{H^{+}}])\n$$\n代入我们关于 $[\\mathrm{H^{+}}]$ 的表达式：\n$$\n\\mathrm{pH} = -\\log_{10} \\left( K_w \\left( \\frac{C_M}{K_{sp}} \\right)^{1/3} \\right)\n$$\n利用对数的性质，可以将其展开为：\n$$\n\\mathrm{pH} = -\\log_{10}(K_w) - \\log_{10} \\left( \\left( \\frac{C_M}{K_{sp}} \\right)^{1/3} \\right)\n$$\n$$\n\\mathrm{pH} = -\\log_{10}(K_w) - \\frac{1}{3} \\log_{10} \\left( \\frac{C_M}{K_{sp}} \\right)\n$$\n注意到 $\\mathrm{p}K_w = -\\log_{10}(K_w)$，以及 $\\log_{10}(A/B) = -\\log_{10}(B/A)$，我们可以将表达式重写为：\n$$\n\\mathrm{pH} = \\mathrm{p}K_w + \\frac{1}{3} \\log_{10} \\left( \\frac{K_{sp}}{C_M} \\right)\n$$\n现在，我们代入问题陈述中提供的数值：\n$K_w = 1.0 \\times 10^{-14}$，所以 $\\mathrm{p}K_w = 14.00$\n$K_{sp} = 8.0 \\times 10^{-36}$\n$C_M = 2.0 \\times 10^{-6}\\,\\mathrm{M}$\n\n首先，计算比值 $\\frac{K_{sp}}{C_M}$：\n$$\n\\frac{K_{sp}}{C_M} = \\frac{8.0 \\times 10^{-36}}{2.0 \\times 10^{-6}} = 4.0 \\times 10^{-30}\n$$\n现在，将此值代入 $\\mathrm{pH}$ 的方程中：\n$$\n\\mathrm{pH} = 14.00 + \\frac{1}{3} \\log_{10} \\left( 4.0 \\times 10^{-30} \\right)\n$$\n$$\n\\mathrm{pH} = 14.00 + \\frac{1}{3} \\left( \\log_{10}(4.0) + \\log_{10}(10^{-30}) \\right)\n$$\n$$\n\\mathrm{pH} = 14.00 + \\frac{1}{3} \\left( \\log_{10}(4.0) - 30 \\right)\n$$\n$$\n\\mathrm{pH} = 14.00 + \\frac{\\log_{10}(4.0)}{3} - \\frac{30}{3}\n$$\n$$\n\\mathrm{pH} = 14.00 - 10.00 + \\frac{\\log_{10}(4.0)}{3}\n$$\n$$\n\\mathrm{pH} = 4.00 + \\frac{\\log_{10}(4.0)}{3}\n$$\n使用计算器计算 $\\log_{10}(4.0)$：\n$\\log_{10}(4.0) \\approx 0.60205999$\n$$\n\\mathrm{pH} \\approx 4.00 + \\frac{0.60205999}{3}\n$$\n$$\n\\mathrm{pH} \\approx 4.00 + 0.20068666\n$$\n$$\n\\mathrm{pH} \\approx 4.20068666\n$$\n根据要求，将最终答案四舍五入到四位有效数字，得到：\n$$\n\\mathrm{pH} = 4.201\n$$\n这就是在给定金属浓度下，$\\mathrm{OH^{-}}$ 离子浓度变得足够高，导致溶液相对于 $\\mathrm{M(OH)_3(s)}$ 达到饱和并开始沉淀时的 $\\mathrm{pH}$ 值。问题中提到的“电荷中性”条件由“大量过量的惰性电解质”来满足，这使得我们能够基于溶解平衡来确定pH值，而无需解复杂的电荷平衡方程组。",
            "answer": "$$\\boxed{4.201}$$"
        },
        {
            "introduction": "在电化学计算和实验中，电势的测量值通常是相对于各种参比电极（如 Ag/AgCl 电极）而言的。为了构建标准化的 Pourbaix 图，必须将这些电势统一转换到标准氢电极（SHE）或可逆氢电极（RHE）标度下。本练习将通过第一性原理，指导你完成这些关键的电势转换，确保来自不同来源的数据能够被准确地比较和绘制。",
            "id": "4239763",
            "problem": "在为金属-水体系构建计算 Pourbaix 图时，通过一个隐式溶剂密度泛函理论工作流程，获得了一个表面质子耦合电子转移步骤的计算氧化还原电势，并以饱和氯化钾的银/氯化银 (Ag/AgCl) 电极为参比。报告的数值是在 $25^\\circ\\mathrm{C}$ 时相对于 Ag/AgCl 的电极电势为 $-0.413\\,\\mathrm{V}$。在 $25^\\circ\\mathrm{C}$ 时，Ag/AgCl（饱和氯化钾）相对于标准氢电极 (SHE) 的标准电势为 $0.197\\,\\mathrm{V}$。为了在溶液酸度为 $\\mathrm{pH}=10.50$ 时，将此点同时叠加在以 SHE 为参比和以可逆氢电极 (RHE) 为参比的 Pourbaix 图上，请从第一性原理出发，将给定的电势转换到 SHE 和 RHE 标度。\n\n从电极电势定义为电化学势的差值，以及定义 RHE 的氢半反应的 Nernst 方程开始。除了给定的 Ag/AgCl 相对于 SHE 的标准电势外，不要假设任何预先制表的转换公式。清楚地说明您使用的任何热力学假设，包括在 $25^\\circ\\mathrm{C}$ 时的活度约定。\n\n计算：\n- 相对于 SHE 的电势，以及\n- 在 $\\mathrm{pH}=10.50$ 时相对于 RHE 的电势。\n\n以 $\\mathrm{V}$ 为单位，按 (SHE, RHE) 的顺序表示两个答案，并将最终数值结果四舍五入至四位有效数字。",
            "solution": "该问题要求将一个最初以饱和氯化钾的银/氯化银 (Ag/AgCl, 饱和 KCl) 电极为参比的电极电势，转换到标准氢电极 (SHE) 和可逆氢电极 (RHE) 标度。这是构建 Pourbaix 图的一个基本步骤，Pourbaix 图绘制了平衡电势与溶液 pH 值的关系。本分析将按要求从第一性原理出发。\n\n电极电势是电势差的量度。一个过程 `proc` 相对于参比电极 `ref` 的电势，记作 $E_{\\text{proc vs. ref}}$，定义为该过程的绝对电势（但无法测量）$U_{\\text{proc}}$ 与参比电极的绝对电势 $U_{\\text{ref}}$ 之差。\n$$E_{\\text{proc vs. ref}} = U_{\\text{proc}} - U_{\\text{ref}}$$\n该关系允许在不同参比标度之间进行直接转换。\n\n给定数据如下：\n- 相对于 Ag/AgCl 的电势：$E_{\\text{vs. Ag/AgCl}} = -0.413\\,\\mathrm{V}$\n- Ag/AgCl 相对于 SHE 的电势：$E_{\\text{Ag/AgCl vs. SHE}} = 0.197\\,\\mathrm{V}$\n- 温度：$T = 25^\\circ\\mathrm{C} = 298.15\\,\\mathrm{K}$\n- 溶液 pH 值：$\\mathrm{pH} = 10.50$\n\n热力学假设如下：\n1. 温度恒定为 $T=298.15\\,\\mathrm{K}$。\n2. 纯凝聚相（固体和液体）的活度取为 1。\n3. 对于氢电极，气态氢的活度 $a_{\\mathrm{H}_2}$ 取为 1，对应于 $1\\,\\mathrm{bar}$ 的逸度。\n4. 质子活度 $a_{\\mathrm{H}^+}$ 与 pH 值的关系由定义 $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^+})$ 给出。\n\n**第一部分：转换为标准氢电极 (SHE) 标度**\n\n过程相对于 SHE 的电势 $E_{\\text{vs. SHE}}$ 与相对于 Ag/AgCl 的电势 $E_{\\text{vs. Ag/AgCl}}$ 相关，通过考虑 Ag/AgCl 电极相对于 SHE 的电势 $E_{\\text{Ag/AgCl vs. SHE}}$。基本关系是：\n$$E_{\\text{vs. SHE}} = U_{\\text{proc}} - U_{\\text{SHE}}$$\n我们已知 $E_{\\text{vs. Ag/AgCl}} = U_{\\text proc} - U_{\\text{Ag/AgCl}}$，这意味着 $U_{\\text{proc}} = E_{\\text{vs. Ag/AgCl}} + U_{\\text{Ag/AgCl}}$。\n将此代入 $E_{\\text{vs. SHE}}$ 的方程中：\n$$E_{\\text{vs. SHE}} = (E_{\\text{vs. Ag/AgCl}} + U_{\\text{Ag/AgCl}}) - U_{\\text{SHE}}$$\n$$E_{\\text{vs. SHE}} = E_{\\text{vs. Ag/AgCl}} + (U_{\\text{Ag/AgCl}} - U_{\\text{SHE}})$$\n项 $(U_{\\text{Ag/AgCl}} - U_{\\text{SHE}})$ 正是相对于 SHE 测量的 Ag/AgCl 电极的电势，其值为 $E_{\\text{Ag/AgCl vs. SHE}} = 0.197\\,\\mathrm{V}$。\n因此，转换公式为：\n$$E_{\\text{vs. SHE}} = E_{\\text{vs. Ag/AgCl}} + E_{\\text{Ag/AgCl vs. SHE}}$$\n代入给定的数值：\n$$E_{\\text{vs. SHE}} = -0.413\\,\\mathrm{V} + 0.197\\,\\mathrm{V} = -0.216\\,\\mathrm{V}$$\n\n**第二部分：在 $\\mathrm{pH} = 10.50$ 时转换为可逆氢电极 (RHE) 标度**\n\nRHE 是在目标电解质中工作的氢电极，这意味着其电势取决于溶液的 pH 值。为了找到过程相对于 RHE 的电势 $E_{\\text{vs. RHE}}$，我们必须首先确定在指定 pH 值下 RHE 相对于 SHE 的电势 $E_{\\text{RHE vs. SHE}}$。\n\nRHE 由氢电极半反应定义：\n$$2\\mathrm{H}^+(aq) + 2e^- \\rightleftharpoons \\mathrm{H}_2(g)$$\n该反应的能斯特方程给出了电势 $U_{\\text{H}^+/\\mathrm{H}_2}$：\n$$U_{\\text{H}^+/\\mathrm{H}_2} = U_{\\text{H}^+/\\mathrm{H}_2}^\\circ - \\frac{RT}{nF} \\ln\\left(\\frac{a_{\\mathrm{H}_2}}{(a_{\\mathrm{H}^+})^2}\\right)$$\n此处，$U_{\\text{H}^+/\\mathrm{H}_2}^\\circ$ 是标准电势，根据 SHE 的定义为 $0\\,\\mathrm{V}$。转移的电子数为 $n=2$。$R$ 是理想气体常数，$T$ 是绝对温度，$F$ 是法拉第常数。使用指定的假设，$a_{\\mathrm{H}_2}=1$ 且 $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^+})$。因此，RHE 相对于 SHE 的电势为：\n$$E_{\\text{RHE vs. SHE}} = U_{\\text{H}^+/\\mathrm{H}_2} - U_{\\text{SHE}} = (0\\,\\mathrm{V} - U_{\\text{SHE}}) - \\frac{RT}{2F} \\ln\\left(\\frac{1}{(a_{\\mathrm{H}^+})^2}\\right) = \\frac{RT}{2F} \\ln((a_{\\mathrm{H}^+})^2) = \\frac{RT}{F} \\ln(a_{\\mathrm{H}^+})$$\n为了将其与 pH 相关联，我们将自然对数转换为以 10 为底的对数：$\\ln(x) = \\ln(10) \\log_{10}(x)$。\n$$E_{\\text{RHE vs. SHE}} = \\frac{RT \\ln(10)}{F} \\log_{10}(a_{\\mathrm{H}^+})$$\n代入 $\\log_{10}(a_{\\mathrm{H}^+}) = -\\mathrm{pH}$：\n$$E_{\\text{RHE vs. SHE}} = -\\frac{RT \\ln(10)}{F} \\times \\mathrm{pH}$$\n在 $T = 298.15\\,\\mathrm{K}$ 时，能斯特斜率项为：\n$$\\frac{RT \\ln(10)}{F} = \\frac{(8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(298.15\\,\\mathrm{K})(\\ln(10))}{96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}} \\approx 0.05916\\,\\mathrm{V}$$\n在 $\\mathrm{pH} = 10.50$ 时，RHE 相对于 SHE 的电势为：\n$$E_{\\text{RHE vs. SHE}} = - (0.05916\\,\\mathrm{V}) \\times 10.50 = -0.62118\\,\\mathrm{V}$$\n现在，我们将电势从 SHE 标度转换为 RHE 标度。该关系与之前的转换类似：\n$$E_{\\text{vs. RHE}} = E_{\\text{vs. SHE}} - E_{\\text{RHE vs. SHE}}$$\n代入计算出的值：\n$$E_{\\text{vs. RHE}} = (-0.216\\,\\mathrm{V}) - (-0.62118\\,\\mathrm{V}) = -0.216\\,\\mathrm{V} + 0.62118\\,\\mathrm{V} = 0.40518\\,\\mathrm{V}$$\n问题要求将最终答案四舍五入至四位有效数字。\n相对于 SHE 的电势为 $-0.216\\,\\mathrm{V}$，变为 $-0.2160\\,\\mathrm{V}$。\n相对于 RHE 的电势为 $0.40518\\,\\mathrm{V}$，变为 $0.4052\\,\\mathrm{V}$。\n\n最终计算出的电势为：\n- 相对于 SHE 的电势：$-0.2160\\,\\mathrm{V}$\n- 在 $\\mathrm{pH}=10.50$ 时相对于 RHE 的电势：$0.4052\\,\\mathrm{V}$",
            "answer": "$$\\boxed{\\begin{pmatrix} -0.2160 & 0.4052 \\end{pmatrix}}$$"
        },
        {
            "introduction": "前面的练习关注于图中的单个特征，而本次实践将综合所学，从基本的热力学数据出发，完整地构建一个 Pourbaix 图。你将通过编写一个算法，在电势和 $\\mathrm{pH}$ 值构成的网格上计算不同相的吉布斯巨势（$\\Psi$），并找出每个点上最稳定的相。这个练习揭示了现代计算材料科学中生成 Pourbaix 图的核心方法，并为你提供了一个亲手实践的范本。",
            "id": "4239726",
            "problem": "您的任务是设计并实现一个完整的、可运行的程序，该程序通过将电极电位-酸度平面离散化，并在每个网格点上选择具有最小巨势的相，来为一个简化的计算Pourbaix图构建稳定性区域分配。该程序必须基于第一性原理，并且必须产生可直接测试的结果。设定背景为一种假设的金属 $\\mathrm{X}$，它有三种固相：$\\mathrm{X}(\\mathrm{s})$、$\\mathrm{XO}(\\mathrm{s})$ 和 $\\mathrm{X(OH)}_2(\\mathrm{s})$。\n\n构建过程中使用的基本核心定义：\n- 每个化学式单位的吉布斯自由能 $G$ 以 $\\mathrm{eV}$ 为单位。\n- 在固定化学势下，一个相的巨势 $\\Psi$ 被定义为吉布斯自由能的勒让德变换，该变换考虑了开放源。对于一个相 $\\mathrm{X}_a \\mathrm{H}_b \\mathrm{O}_c$，单位金属的巨势为 $$\\Psi = \\frac{G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - b \\mu_{\\mathrm{H}} - c \\mu_{\\mathrm{O}}}{a},$$ 其中 $\\mu_{\\mathrm{X}}^{\\mathrm{ref}}$ 是 $\\mathrm{X}$（块状金属）的参考化学势，$\\mu_{\\mathrm{H}}$ 是氢的化学势，$\\mu_{\\mathrm{O}}$ 是氧的化学势。\n- 电子的电化学势满足 $$\\mu_e(E) = - E,$$ 单位为 $\\mathrm{eV}$，因为 $1\\,\\mathrm{eV} = 1\\,e \\cdot \\mathrm{V}$。\n- 在温度 $T = 298.15\\,\\mathrm{K}$ 下，氢离子的化学势遵循 $$\\mu_{\\mathrm{H}^+}(pH) = \\mu_{\\mathrm{H}^+}^{0} + k_B T \\ln a_{\\mathrm{H}^+},$$ 其中 $a_{\\mathrm{H}^+} = 10^{-pH}$，$k_B$ 是玻尔兹曼常数，且 $k_B T \\ln 10 = 0.059161\\,\\mathrm{eV}$。氢原子的化学势通过以下关系式关联 $$\\mu_{\\mathrm{H}} = \\mu_{\\mathrm{H}^+} + \\mu_e.$$\n- 水的平衡约束通过以下方式消去氧 $$\\mu_{\\mathrm{H_2O}}^{0} = \\mu_{\\mathrm{O}} + 2 \\mu_{\\mathrm{H}},$$ 其中 $\\mu_{\\mathrm{H_2O}}^{0}$ 是标准态下的一个常数。必须使用此关系将 $\\mu_{\\mathrm{O}}$ 表示为 $\\mu_{\\mathrm{H_2O}}^{0}$ 和 $\\mu_{\\mathrm{H}}$ 的函数。\n\n您的程序必须：\n1. 将电极电位-酸度平面 $(E,\\mathrm{pH})$ 离散化为一个指定范围和点数的矩形网格。将 $E$ 视为相对于标准氢电极（SHE）的电压（单位：伏特），$\\mathrm{pH}$ 视为无量纲。每个网格点是一个数对 $(E_i, \\mathrm{pH}_j)$。\n2. 在每个网格点，使用上述关系式消去 $\\mu_{\\mathrm{O}}$，并将各相的 $\\Psi$ 表示为 $E$ 和 $\\mathrm{pH}$ 以及给定的常数 $G$、$\\mu_{\\mathrm{X}}^{\\mathrm{ref}}$、$\\mu_{\\mathrm{H}^+}^{0}$ 和 $\\mu_{\\mathrm{H_2O}}^{0}$ 的函数。\n3. 对于组成为 $\\mathrm{X}$、$\\mathrm{XO}$ 和 $\\mathrm{X(OH)}_2$ 的三个相，分别使用 $(a,b,c) = (1,0,0)$、$(1,0,1)$ 和 $(1,2,2)$。\n4. 通过选择具有最小 $\\Psi$ 值的相来为每个网格点分配稳定相。使用数值公差 $\\epsilon = 10^{-12}$：如果两个或多个相的 $\\Psi$ 值与最小值之差在 $\\epsilon$ 范围内，则按照相标签的字典序 $\\mathrm{X} \\rightarrow \\mathrm{XO} \\rightarrow \\mathrm{X(OH)}_2$ 进行确定性决胜。\n5. 计算每个测试场景中分配给每个相的网格点分数（即，计数除以网格点总数）。\n\n要求输出：\n- 程序必须输出单行，包含所有测试场景的结果，聚合为一个Python风格的列表的列表，每个内部列表包含对应于 $[\\mathrm{X}, \\mathrm{XO}, \\mathrm{X(OH)}_2]$ 顺序的三个小数。每个小数必须四舍五入到六位小数。例如，输出必须如下所示：$$\\texttt{[[f1\\_X,f1\\_XO,f1\\_XOH2],[f2\\_X,f2\\_XO,f2\\_XOH2],...]}.$$\n\n测试套件和参数规范：\n- 在 $T=298.15\\,\\mathrm{K}$ 时，使用 $k_B T \\ln 10 = 0.059161\\,\\mathrm{eV}$。\n- 测试用例 1（一般情况）：\n    - $E \\in [-1.0, 1.0]$，包含 $51$ 个等距点。\n    - $\\mathrm{pH} \\in [0.0, 14.0]$，包含 $51$ 个等距点。\n    - 能量：$G_{\\mathrm{X}} = 0.0\\,\\mathrm{eV}$、$G_{\\mathrm{XO}} = -2.50\\,\\mathrm{eV}$、$G_{\\mathrm{X(OH)}_2} = -5.20\\,\\mathrm{eV}$。\n    - 参考值：$\\mu_{\\mathrm{X}}^{\\mathrm{ref}} = 0.0\\,\\mathrm{eV}$、$\\mu_{\\mathrm{H}^+}^{0} = 0.0\\,\\mathrm{eV}$、$\\mu_{\\mathrm{H_2O}}^{0} = -2.46\\,\\mathrm{eV}$。\n- 测试用例 2（粗糙边界网格）：\n    - $E \\in [-1.0, -0.1]$，包含 $2$ 个点。\n    - $\\mathrm{pH} \\in [0.0, 14.0]$，包含 $2$ 个点。\n    - 使用与测试用例 1 相同的能量和参考值。\n- 测试用例 3（酸性条件下的边缘电位）：\n    - $E \\in [-2.0, 2.0]$，包含 $401$ 个点。\n    - $\\mathrm{pH} = 0.0$，包含 $1$ 个点。\n    - 使用与测试用例 1 相同的能量和参考值。\n- 测试用例 4（氧化物和氢氧化物之间的平局主导场景）：\n    - $E \\in [-0.5, 0.5]$，包含 $21$ 个点。\n    - $\\mathrm{pH} = 7.0$，包含 $1$ 个点。\n    - 能量：$G_{\\mathrm{X}} = 0.0\\,\\mathrm{eV}$、$G_{\\mathrm{XO}} = -3.00\\,\\mathrm{eV}$、$G_{\\mathrm{X(OH)}_2} = -6.00\\,\\mathrm{eV}$。\n    - 参考值：$\\mu_{\\mathrm{X}}^{\\mathrm{ref}} = 0.0\\,\\mathrm{eV}$、$\\mu_{\\mathrm{H}^+}^{0} = 0.0\\,\\mathrm{eV}$、$\\mu_{\\mathrm{H_2O}}^{0} = -3.00\\,\\mathrm{eV}$。\n    - 这一选择使得 $\\mathrm{XO}$ 和 $\\mathrm{X(OH)}_2$ 的常数项相等，且对 $(E,\\mathrm{pH})$ 的依赖性相同，因此只要这两个相优于 $\\mathrm{X}$，就会出现平局；必须应用确定性的字典序决胜规则。\n\n角度单位不适用。所有能量值以 $\\mathrm{eV}$ 表示，电位以 $\\mathrm{V}$ 表示，$\\mathrm{pH}$ 为无量纲。最终输出是具有上述确切格式的单行，每个分数四舍五入到六位小数。",
            "solution": "该问题陈述清晰，有科学依据，客观，并包含推导唯一解所需的所有信息。所提供的定义和原理是计算电化学中构建Pourbaix图的标准方法。任务是实现一个程序，通过最小化巨势 $\\Psi$，在电极电位（$E$）和酸度（$\\mathrm{pH}$）的离散网格上确定假设金属 $\\mathrm{X}$ 的最稳定相。\n\n### 步骤 1：巨势表达式的推导\n\n对于化学计量为 $\\mathrm{X}_a \\mathrm{H}_b \\mathrm{O}_c$ 的相，其巨势 $\\Psi$ 由下式给出：\n$$\n\\Psi = \\frac{1}{a} (G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - b \\mu_{\\mathrm{H}} - c \\mu_{\\mathrm{O}})\n$$\n其中 $G$ 是该相的吉布斯自由能，$\\mu_{\\mathrm{X}}^{\\mathrm{ref}}$、$\\mu_{\\mathrm{H}}$ 和 $\\mu_{\\mathrm{O}}$ 分别是其组分在各自源中的化学势。我们的首要任务是将 $\\Psi$ 表示为自变量 $E$（电极电位）和 $\\mathrm{pH}$ 的函数。\n\n问题提供了在温度 $T=298.15\\,\\mathrm{K}$ 下的以下关系：\n1.  氢原子的化学势 $\\mu_{\\mathrm{H}}$ 是质子化学势 $\\mu_{\\mathrm{H}^+}$ 和电子化学势 $\\mu_e$ 的和：\n    $$\n    \\mu_{\\mathrm{H}} = \\mu_{\\mathrm{H}^+} + \\mu_e\n    $$\n2.  电子的电化学势为 $\\mu_e(E) = -E$，其中 $E$ 是标准氢电极（SHE）标度下的电位（单位：伏特），$\\mu_e$ 的单位是电子伏特（$\\mathrm{eV}$）。\n3.  质子的化学势是 $\\mathrm{pH}$ 的函数：\n    $$\n    \\mu_{\\mathrm{H}^+}(\\mathrm{pH}) = \\mu_{\\mathrm{H}^+}^{0} + k_B T \\ln a_{\\mathrm{H}^+} = \\mu_{\\mathrm{H}^+}^{0} + k_B T \\ln(10^{-\\mathrm{pH}}) = \\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} (k_B T \\ln 10)\n    $$\n    其中 $\\mu_{\\mathrm{H}^+}^{0}$ 是质子的标准化学势。设 $k_{pH} = k_B T \\ln 10 = 0.059161\\,\\mathrm{eV}$。\n    综合这些，氢的化学势变为：\n    $$\n    \\mu_{\\mathrm{H}}(E, \\mathrm{pH}) = (\\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} \\cdot k_{pH}) - E\n    $$\n4.  氧的化学势 $\\mu_{\\mathrm{O}}$ 受水的平衡反应 $2\\mathrm{H} + \\mathrm{O} \\rightleftharpoons \\mathrm{H_2O}$ 约束：\n    $$\n    \\mu_{\\mathrm{H_2O}}^{0} = 2\\mu_{\\mathrm{H}} + \\mu_{\\mathrm{O}}\n    $$\n    其中 $\\mu_{\\mathrm{H_2O}}^{0}$ 是水的标准化学势。这使我们能够消去 $\\mu_{\\mathrm{O}}$：\n    $$\n    \\mu_{\\mathrm{O}} = \\mu_{\\mathrm{H_2O}}^{0} - 2\\mu_{\\mathrm{H}}\n    $$\n\n将 $\\mu_{\\mathrm{O}}$ 以及随后的 $\\mu_{\\mathrm{H}}$ 的表达式代入巨势公式中：\n$$\n\\Psi = \\frac{1}{a} (G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - b \\mu_{\\mathrm{H}} - c (\\mu_{\\mathrm{H_2O}}^{0} - 2\\mu_{\\mathrm{H}}))\n$$\n$$\n\\Psi = \\frac{1}{a} (G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - c \\mu_{\\mathrm{H_2O}}^{0} + (2c - b) \\mu_{\\mathrm{H}})\n$$\n$$\n\\Psi(E, \\mathrm{pH}) = \\frac{1}{a} [G - a \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - c \\mu_{\\mathrm{H_2O}}^{0} + (2c - b) (\\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} \\cdot k_{pH} - E)]\n$$\n这个方程将任何相 $\\mathrm{X}_a \\mathrm{H}_b \\mathrm{O}_c$ 的巨势表示为 $E$ 和 $\\mathrm{pH}$ 的线性函数。\n\n### 步骤 2：应用于特定相\n\n我们将这个通用公式应用于三个指定的固相。在所有情况下，化学计量都是按化学式单位计算的，因此 $a=1$。\n\n1.  **$\\mathrm{X}(\\mathrm{s})$ 相**：$(a,b,c) = (1,0,0)$\n    $$\n    \\Psi_{\\mathrm{X}} = \\frac{1}{1} [G_{\\mathrm{X}} - 1 \\cdot \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - 0 \\cdot \\mu_{\\mathrm{H_2O}}^{0} + (2\\cdot 0 - 0) (\\dots)] = G_{\\mathrm{X}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}}\n    $$\n    纯金属的巨势是常数，与 $E$ 和 $\\mathrm{pH}$ 无关。\n\n2.  **$\\mathrm{XO}(\\mathrm{s})$ 相**：$(a,b,c) = (1,0,1)$\n    $$\n    \\Psi_{\\mathrm{XO}}(E, \\mathrm{pH}) = [G_{\\mathrm{XO}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - 1 \\cdot \\mu_{\\mathrm{H_2O}}^{0}] + (2\\cdot 1 - 0)[\\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} \\cdot k_{pH} - E]\n    $$\n    $$\n    \\Psi_{\\mathrm{XO}}(E, \\mathrm{pH}) = (G_{\\mathrm{XO}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - \\mu_{\\mathrm{H_2O}}^{0} + 2\\mu_{\\mathrm{H}^+}^{0}) - 2E - 2 k_{pH} \\cdot \\mathrm{pH}\n    $$\n\n3.  **$\\mathrm{X(OH)}_2(\\mathrm{s})$ 相**：$(a,b,c) = (1,2,2)$\n    $$\n    \\Psi_{\\mathrm{X(OH)_2}}(E, \\mathrm{pH}) = [G_{\\mathrm{X(OH)_2}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - 2 \\cdot \\mu_{\\mathrm{H_2O}}^{0}] + (2\\cdot 2 - 2)[\\mu_{\\mathrm{H}^+}^{0} - \\mathrm{pH} \\cdot k_{pH} - E]\n    $$\n    $$\n    \\Psi_{\\mathrm{X(OH)_2}}(E, \\mathrm{pH}) = (G_{\\mathrm{X(OH)_2}} - \\mu_{\\mathrm{X}}^{\\mathrm{ref}} - 2\\mu_{\\mathrm{H_2O}}^{0} + 2\\mu_{\\mathrm{H}^+}^{0}) - 2E - 2 k_{pH} \\cdot \\mathrm{pH}\n    $$\n\n### 步骤 3：计算策略\n\n对于每个测试用例，程序将执行以下步骤：\n1.  定义问题中提供的常数（$G$ 值、$\\mu$ 参考值、$k_{pH}$）。\n2.  构建 $(E, \\mathrm{pH})$ 网格。我们使用 `numpy.linspace` 生成 $E$ 和 $\\mathrm{pH}$ 值的数组，并使用 `numpy.meshgrid` 创建二维网格数组 `E_grid` 和 `pH_grid`。\n3.  根据上面推导的方程，在网格的每个点上计算每个相的巨势。这是通过对 NumPy 网格数组进行向量化操作来完成的。\n    -   $\\Psi_{\\mathrm{X}}$ 被计算为一个标量，并广播到网格的形状。\n    -   $\\Psi_{\\mathrm{XO}}$ 和 $\\Psi_{\\mathrm{X(OH)_2}}$ 被计算为二维数组。\n4.  确定每个网格点的稳定相。\n    -   将三个 $\\Psi$ 数组沿一个新轴堆叠，形成一个 $3 \\times N_{E} \\times N_{pH}$ 的数组。\n    -   对于每个网格点，沿这个新轴找到最小的 $\\Psi$ 值。\n    -   为处理平局情况，我们识别所有其 $\\Psi$ 值与该点的最小值之差在公差 $\\epsilon = 10^{-12}$ 内的相（即 `psi_stack = min_psi + EPSILON`）。\n    -   根据字典序决胜规则选择稳定相：$\\mathrm{X} \\rightarrow \\mathrm{XO} \\rightarrow \\mathrm{X(OH)_2}$。这可以通过在布尔数组上使用 `numpy.argmax` 函数高效实现，因为它返回第一个 `True` 值的索引。\n5.  统计每个稳定相出现的次数。在展平的稳定相索引数组上使用 `numpy.bincount` 函数，以获得每个相的总计数。\n6.  通过将计数除以网格点总数，计算分配给每个相的网格分数。\n7.  每个测试用例的最终结果将被四舍五入到六位小数，并格式化为所需的输出字符串。\n\n这种向量化方法通过同时对整个网格进行操作，确保了高数值效率和正确性，避免了缓慢的Python循环。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stable phase fractions in a simplified Pourbaix diagram\n    for multiple test cases, according to the problem specification.\n    \"\"\"\n    \n    # Fundamental constants\n    K_PH = 0.059161  # eV, value of k_B * T * ln(10)\n    EPSILON = 1e-12  # Tolerance for tie-breaking\n\n    # Test suite and parameter specifications\n    test_cases = [\n        {\n            # Test Case 1 (general case)\n            \"E_range\": (-1.0, 1.0), \"E_count\": 51,\n            \"pH_range\": (0.0, 14.0), \"pH_count\": 51,\n            \"G_values\": {\"X\": 0.0, \"XO\": -2.50, \"X(OH)2\": -5.20}, # eV\n            \"mu_refs\": {\"X_ref\": 0.0, \"H_plus_0\": 0.0, \"H2O_0\": -2.46} # eV\n        },\n        {\n            # Test Case 2 (coarse boundary grid)\n            \"E_range\": (-1.0, -0.1), \"E_count\": 2,\n            \"pH_range\": (0.0, 14.0), \"pH_count\": 2,\n            \"G_values\": {\"X\": 0.0, \"XO\": -2.50, \"X(OH)2\": -5.20}, # eV\n            \"mu_refs\": {\"X_ref\": 0.0, \"H_plus_0\": 0.0, \"H2O_0\": -2.46} # eV\n        },\n        {\n            # Test Case 3 (edge potentials at acidic condition)\n            \"E_range\": (-2.0, 2.0), \"E_count\": 401,\n            \"pH_range\": (0.0, 0.0), \"pH_count\": 1,\n            \"G_values\": {\"X\": 0.0, \"XO\": -2.50, \"X(OH)2\": -5.20}, # eV\n            \"mu_refs\": {\"X_ref\": 0.0, \"H_plus_0\": 0.0, \"H2O_0\": -2.46} # eV\n        },\n        {\n            # Test Case 4 (tie-dominated scenario)\n            \"E_range\": (-0.5, 0.5), \"E_count\": 21,\n            \"pH_range\": (7.0, 7.0), \"pH_count\": 1,\n            \"G_values\": {\"X\": 0.0, \"XO\": -3.00, \"X(OH)2\": -6.00}, # eV\n            \"mu_refs\": {\"X_ref\": 0.0, \"H_plus_0\": 0.0, \"H2O_0\": -3.00} # eV\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        E_min, E_max = case[\"E_range\"]\n        E_count = case[\"E_count\"]\n        pH_min, pH_max = case[\"pH_range\"]\n        pH_count = case[\"pH_count\"]\n        \n        G_X = case[\"G_values\"][\"X\"]\n        G_XO = case[\"G_values\"][\"XO\"]\n        G_XOH2 = case[\"G_values\"][\"X(OH)2\"]\n        \n        mu_X_ref = case[\"mu_refs\"][\"X_ref\"]\n        mu_H_plus_0 = case[\"mu_refs\"][\"H_plus_0\"]\n        mu_H2O_0 = case[\"mu_refs\"][\"H2O_0\"]\n\n        # Create the E-pH grid\n        E_vals = np.linspace(E_min, E_max, E_count)\n        pH_vals = np.linspace(pH_min, pH_max, pH_count)\n        E_grid, pH_grid = np.meshgrid(E_vals, pH_vals, indexing='ij')\n\n        # Calculate grand potential Psi for each phase on the grid\n        \n        # Phase X: Psi = G_X - mu_X_ref\n        psi_X = np.full(E_grid.shape, G_X - mu_X_ref)\n\n        # Phase XO: Psi = (G_XO - mu_X_ref - mu_H2O_0 + 2*mu_H_plus_0) - 2*E - 2*k_pH*pH\n        const_XO = G_XO - mu_X_ref - mu_H2O_0 + 2 * mu_H_plus_0\n        psi_XO = const_XO - 2 * E_grid - 2 * K_PH * pH_grid\n\n        # Phase X(OH)2: Psi = (G_XOH2 - mu_X_ref - 2*mu_H2O_0 + 2*mu_H_plus_0) - 2*E - 2*k_pH*pH\n        const_XOH2 = G_XOH2 - mu_X_ref - 2 * mu_H2O_0 + 2 * mu_H_plus_0\n        psi_XOH2 = const_XOH2 - 2 * E_grid - 2 * K_PH * pH_grid\n\n        # Stack Psi arrays for comparison: axis 0 corresponds to [X, XO, X(OH)2]\n        psi_stack = np.stack([psi_X, psi_XO, psi_XOH2], axis=0)\n\n        # Find the minimum Psi value at each grid point\n        min_psi = np.min(psi_stack, axis=0, keepdims=True)\n\n        # Identify all phases within epsilon of the minimum\n        # The shape of is_min is (3, E_count, pH_count)\n        is_min = (psi_stack = min_psi + EPSILON)\n\n        # Apply lexicographic tie-breaking: X -> XO -> X(OH)2\n        # np.argmax returns the index of the first True value along axis 0.\n        # This corresponds to the phase index (0, 1, or 2) and correctly\n        # implements the tie-breaking rule.\n        stable_indices = np.argmax(is_min, axis=0)\n\n        # Count the number of grid points for each stable phase\n        # minlength=3 ensures counts for all three phases even if some are zero.\n        counts = np.bincount(stable_indices.flatten(), minlength=3)\n        \n        # Calculate fractions\n        total_points = E_count * pH_count\n        fractions = counts / total_points\n        \n        all_results.append(fractions)\n\n    # Format the final output string\n    formatted_results = []\n    for res in all_results:\n        # Format each fraction to 6 decimal places\n        formatted_list = [f\"{x:.6f}\" for x in res]\n        formatted_results.append(f\"[{','.join(formatted_list)}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}