{
    "hands_on_practices": [
        {
            "introduction": "要模拟腐蚀过程，我们必须首先将量子力学计算得到的能量与现实世界中的电化学条件（如电极电位 $U$ 和pH值）联系起来。本练习将介绍计算氢电极（Computational Hydrogen Electrode, CHE）模型，这是建立这种联系的基础工具；通过计算镍表面上吸附的氢氧根离子（$\\mathrm{OH}^{*}$）的覆盖度，你将亲手实践如何应用CHE模型，并理解溶剂化效应对模型预测结果的修正，从而深入认识电化学界面的热力学。",
            "id": "4236890",
            "problem": "在腐蚀过程的原子尺度模拟背景下，您需要对羟基 ($\\mathrm{OH}^{*}$) 在镍 ($\\mathrm{Ni}$) 表面位点上的电化学吸附进行建模。您的程序必须从适用于计算电化学和原子尺度模拟的第一性原理出发，推导出羟基覆盖度作为电极电位和氢离子浓度指数 (pH) 的函数，然后量化显式溶剂化校正如何改变预测的覆盖度。程序必须实现此推导过程，并为指定的测试组生成数值输出。\n\n从以下基本基础开始：\n\n- 羟基吸附过程由表面反应 $\\mathrm{*} + \\mathrm{H_{2}O} \\rightleftharpoons \\mathrm{OH}^{*} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$ 表示，其中 $\\mathrm{*}$ 表示一个空的 $\\mathrm{Ni}$ 位点，$\\mathrm{OH}^{*}$ 表示一个吸附的羟基。相应的平衡热力学可以通过化学势和计算氢电极 (Computational Hydrogen Electrode, CHE) 形式体系来处理。\n- 在 CHE 中，$\\mathrm{H}^{+}$ 和 $\\mathrm{e}^{-}$ 的化学势与氢气分子的化学势之间的关系为 $\\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}} = \\tfrac{1}{2}\\mu_{\\mathrm{H_{2}}} - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}}$，其中 $U$ 是相对于标准氢电极 (Standard Hydrogen Electrode, SHE) 的电极电位，$e$ 是基本电荷，$T$ 是温度，$k_{\\mathrm{B}}$ 是 Boltzmann 常数，$a_{\\mathrm{H}^{+}}$ 是质子活度。活度通过 $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$ 与氢离子浓度指数 (pH) 相关。\n- 在平衡状态下，对于单一类型的非相互作用位点，吸附物覆盖度 $\\theta$ 通过 Langmuir 型等温线满足质量作用定律，该等温线由巨势相对于位点占据的最小化推导得出，其中平衡常数由反应自由能 $\\Delta G(U,\\mathrm{pH})$ 决定。\n\n使用以下符合科学实际的常数和参数：\n\n- 温度 $T = 298.15\\,\\mathrm{K}$。\n- 能量单位为 $\\mathrm{eV}$，电位 $U$ 的单位为 $\\mathrm{V}$ (相对于 $\\mathrm{SHE}$)。使用等式 $e \\cdot \\mathrm{V} = \\mathrm{eV}$ 将 $e U$ 表示为 $\\mathrm{eV}$。\n- Boltzmann 常数，单位为 $\\mathrm{eV}/\\mathrm{K}$：$k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}$。\n- 自然对数底与十进对数的关系：$\\ln(10)$。\n- 在 $U = 0\\,\\mathrm{V}$ 和 $\\mathrm{pH} = 0$ 时，$\\mathrm{Ni}$ 上 $\\mathrm{OH}^{*}$ 生成的标准态反应自由能为 $\\Delta G^{\\circ} = 0.62\\,\\mathrm{eV}$，该值由原子尺度计算（包括零点能和振动熵校正）得出。\n- 用于模拟液态水稳定作用的 $\\mathrm{OH}^{*}$ 生成自由能的显式溶剂化校正为 $\\delta G_{\\mathrm{solv}} = -0.25\\,\\mathrm{eV}$。\n\n您的任务：\n\n1. 基于上述基础，在 CHE 形式体系下，参考 $\\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}}$ 和 $\\mu_{\\mathrm{H_{2}}}$ 之间的关系，推导反应自由能 $\\Delta G(U,\\mathrm{pH})$ 作为电极电位 $U$ (单位为 $\\mathrm{V}$) 和 $\\mathrm{pH}$ (无量纲) 的函数表达式。仔细消去化学势，得到一个用 $\\Delta G^{\\circ}$、$U$、$T$ 和 $\\mathrm{pH}$ 表示的表达式。\n2. 基于推导出的 $\\Delta G(U,\\mathrm{pH})$，使用基于 Langmuir 等温线和 Boltzmann 因子的严格平衡论证，得到单一非相互作用位点上对应的 $\\mathrm{OH}^{*}$ 覆盖度 $\\theta(U,\\mathrm{pH})$，并用 $k_{\\mathrm{B}} T$ 和 $\\Delta G(U,\\mathrm{pH})$ 表示。\n3. 将显式溶剂化校正作为对反应自由能的加性修正项引入，并计算校正后的覆盖度 $\\theta_{\\mathrm{corr}}(U,\\mathrm{pH})$。\n4. 对于每个测试用例，计算绝对差 $\\Delta \\theta = \\left|\\theta_{\\mathrm{CHE}} - \\theta_{\\mathrm{corr}}\\right|$，以量化由溶剂化引起的预测覆盖度变化，从而在定性意义上评估 CHE 近似相对于校正模型的准确性。\n\n单位和数值输出要求：\n\n- 能量必须在内部以 $\\mathrm{eV}$ 处理，电位以 $\\mathrm{V}$ (相对于 $\\mathrm{SHE}$) 处理，温度以 $\\mathrm{K}$ 处理，覆盖度是 $[0,1]$ 范围内的无量纲值。\n- 按规定使用 $T = 298.15\\,\\mathrm{K}$，$k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}$ 和 $\\ln(10)$。\n- 最终的数值输出必须是每个测试用例的 $\\Delta \\theta$ 值，并四舍五入到六位小数。\n\n测试组：\n\n- 用例 1：$U = 0.60\\,\\mathrm{V}$，$\\mathrm{pH} = 13$。\n- 用例 2：$U = 0.00\\,\\mathrm{V}$，$\\mathrm{pH} = 0$。\n- 用例 3：$U = 0.25\\,\\mathrm{V}$，$\\mathrm{pH} = 7$。\n- 用例 4：$U = 1.00\\,\\mathrm{V}$，$\\mathrm{pH} = 14$。\n- 用例 5：$U = -0.10\\,\\mathrm{V}$，$\\mathrm{pH} = 1$。\n- 用例 6：$U = 0.50\\,\\mathrm{V}$，$\\mathrm{pH} = 2$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，结果按上述用例的顺序排列，其后是第七个条目，即六个 $\\Delta \\theta$ 值的算术平均值，所有值均四舍五入到六位小数（例如，$\\left[\\text{case1},\\text{case2},\\ldots,\\text{case6},\\text{mean}\\right]$）。",
            "solution": "该问题要求推导镍 ($\\mathrm{Ni}$) 表面上羟基 ($\\mathrm{OH}^{*}$) 的吸附物覆盖度作为电极电位和 $\\mathrm{pH}$ 的函数，并量化溶剂化校正的影响。该问题在科学上基于计算电化学的原理，特别是计算氢电极 (CHE) 模型和 Langmuir 吸附理论。所有必要的参数都已提供，且问题是良定的。\n\n解答按照问题陈述中规定的四个连续步骤进行。\n\n第 1 步：反应自由能 $\\Delta G(U, \\mathrm{pH})$ 的推导\n\n羟基的电化学吸附由以下反应给出：\n$$ \\mathrm{*} + \\mathrm{H_{2}O} \\rightleftharpoons \\mathrm{OH}^{*} + \\mathrm{H}^{+} + \\mathrm{e}^{-} $$\n其中 $\\mathrm{*}$ 表示一个空的表面位点。此反应的 Gibbs 自由能 $\\Delta G$ 是产物和反应物化学势 ($\\mu$) 之差：\n$$ \\Delta G = (\\mu_{\\mathrm{OH}^{*}} + \\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}}) - (\\mu_{*} + \\mu_{\\mathrm{H_{2}O}}) $$\n计算氢电极 (CHE) 模型假定，在相对于标准氢电极 (SHE) 的给定电极电位 $U$ 下，溶液中的质子-电子对的化学势与气态氢处于平衡状态。明确的关系式如下：\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}} = \\frac{1}{2}\\mu_{\\mathrm{H_{2}}} - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}} $$\n此处，$\\mu_{\\mathrm{H_{2}}}$ 是氢气的化学势，$e$ 是基本电荷，$U$ 是电极电位，$k_{\\mathrm{B}}$ 是 Boltzmann 常数，$T$ 是温度，$a_{\\mathrm{H}^{+}}$ 是质子活度。\n\n将 $\\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}}$ 的这个表达式代入 $\\Delta G$ 的方程中，得到：\n$$ \\Delta G = \\mu_{\\mathrm{OH}^{*}} - \\mu_{*} - \\mu_{\\mathrm{H_{2}O}} + \\left(\\frac{1}{2}\\mu_{\\mathrm{H_{2}}} - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}}\\right) $$\n重新整理各项以将化学势归类，得到：\n$$ \\Delta G = \\left( \\mu_{\\mathrm{OH}^{*}} + \\frac{1}{2}\\mu_{\\mathrm{H_{2}}} - \\mu_{*} - \\mu_{\\mathrm{H_{2}O}} \\right) - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}} $$\n括号中的项表示参考反应 $\\mathrm{*} + \\mathrm{H_{2}O} \\rightleftharpoons \\mathrm{OH}^{*} + \\frac{1}{2}\\mathrm{H_{2}}$ 在标准条件（$U = 0\\,\\mathrm{V}$ 相对于 SHE，$\\mathrm{pH} = 0$，且所有物种均处于其标准态）下的自由能变化。这就是标准态反应自由能 $\\Delta G^{\\circ}$，给定值为 $\\Delta G^{\\circ} = 0.62\\,\\mathrm{eV}$。\n\n因此 $\\Delta G$ 的表达式变为：\n$$ \\Delta G = \\Delta G^{\\circ} - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}} $$\n质子活度 $a_{\\mathrm{H}^{+}}$ 通过定义 $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$ 与 $\\mathrm{pH}$ 相关。代入此式可得：\n$$ \\Delta G = \\Delta G^{\\circ} - e U + k_{\\mathrm{B}} T \\ln(10^{-\\mathrm{pH}}) $$\n使用对数恒等式 $\\ln(x^y) = y \\ln(x)$，我们得到反应自由能作为电位 $U$ 和 $\\mathrm{pH}$ 的函数的最终表达式：\n$$ \\Delta G(U, \\mathrm{pH}) = \\Delta G^{\\circ} - e U - k_{\\mathrm{B}} T \\ln(10) \\cdot \\mathrm{pH} $$\n由于能量单位为 $\\mathrm{eV}$，电位 $U$ 单位为 $\\mathrm{V}$，因此 $e U$ 项的单位为 $\\mathrm{eV}$，保持了量纲上的一致性。\n\n第 2 步：羟基覆盖度 $\\theta(U, \\mathrm{pH})$ 的推导\n\n问题指定了单一类型的非相互作用位点，对此 Langmuir 等温线是适用的平衡模型。该等温线将吸附物种的分数覆盖度 $\\theta$ 与空位点的分数 $1-\\theta$ 联系起来。在平衡时，这些分数的比率由吸附自由能 $\\Delta G(U, \\mathrm{pH})$ 的 Boltzmann 因子决定。\n$$ \\frac{\\theta}{1-\\theta} = \\exp\\left(-\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right) $$\n对此方程求解 $\\theta$ 可得到覆盖度的表达式：\n$$ \\theta = \\frac{\\exp\\left(-\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)}{1 + \\exp\\left(-\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)} $$\n通过将分子和分母同乘以 $\\exp\\left(\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)$，可以将其代数重排为 Fermi-Dirac 分布的形式：\n$$ \\theta(U, \\mathrm{pH}) = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)} $$\n这就是覆盖度的表达式，记为 $\\theta_{\\mathrm{CHE}}$。\n\n第 3 步：引入显式溶剂化校正\n\n一个显式溶剂化校正 $\\delta G_{\\mathrm{solv}} = -0.25\\,\\mathrm{eV}$ 作为加性项被引入到吸附的 $\\mathrm{OH}^{*}$ 的自由能中。这会修正标准反应自由能：\n$$ \\Delta G^{\\circ}_{\\mathrm{corr}} = \\Delta G^{\\circ} + \\delta G_{\\mathrm{solv}} $$\n代入给定值：\n$$ \\Delta G^{\\circ}_{\\mathrm{corr}} = 0.62\\,\\mathrm{eV} - 0.25\\,\\mathrm{eV} = 0.37\\,\\mathrm{eV} $$\n校正后的、依赖于电位和 pH 的自由能 $\\Delta G_{\\mathrm{corr}}(U, \\mathrm{pH})$，是通过在第 1 步推导的表达式中使用 $\\Delta G^{\\circ}_{\\mathrm{corr}}$ 得到的：\n$$ \\Delta G_{\\mathrm{corr}}(U, \\mathrm{pH}) = \\Delta G^{\\circ}_{\\mathrm{corr}} - e U - k_{\\mathrm{B}} T \\ln(10) \\cdot \\mathrm{pH} $$\n相应的校正后覆盖度 $\\theta_{\\mathrm{corr}}(U, \\mathrm{pH})$，是使用第 2 步中的 Langmuir 等温线形式和这个校正后的自由能计算得出的：\n$$ \\theta_{\\mathrm{corr}}(U, \\mathrm{pH}) = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G_{\\mathrm{corr}}(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)} $$\n\n第 4 步：覆盖度绝对差 $\\Delta \\theta$ 的计算\n\n溶剂化校正的定量影响通过计算标准 CHE 模型预测的覆盖度 ($\\theta_{\\mathrm{CHE}}$) 与校正模型预测的覆盖度 ($\\theta_{\\mathrm{corr}}$) 之间的绝对差来评估：\n$$ \\Delta \\theta = \\left|\\theta_{\\mathrm{CHE}}(U, \\mathrm{pH}) - \\theta_{\\mathrm{corr}}(U, \\mathrm{pH})\\right| $$\n对于每个测试用例，将使用推导出的公式和提供的物理常数进行此计算：$T = 298.15\\,\\mathrm{K}$，$k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}$，$\\Delta G^{\\circ} = 0.62\\,\\mathrm{eV}$，和 $\\delta G_{\\mathrm{solv}} = -0.25\\,\\mathrm{eV}$。数值实现将计算 $\\ln(10)$ 的值和乘积 $k_{\\mathrm{B}}T$ 以用于计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the absolute difference in OH* coverage on a Ni surface\n    between a standard CHE model and a model with an explicit solvation correction.\n    \"\"\"\n\n    # Define scientifically realistic constants and parameters.\n    # Temperature in Kelvin.\n    T = 298.15  # K\n    # Boltzmann constant in eV/K.\n    KB = 8.617333262e-5  # eV/K\n    # Standard-state reaction free energy for OH* formation in eV.\n    DELTA_G_ZERO = 0.62  # eV\n    # Explicit solvation correction to the OH* formation free energy in eV.\n    DELTA_G_SOLV = -0.25  # eV\n\n    # Pre-calculate common terms for efficiency and clarity.\n    # Thermal energy in eV.\n    KBT = KB * T\n    # Conversion factor from pH to energy in eV.\n    PH_TO_EV = KBT * np.log(10)\n\n    def calculate_coverage(U, pH, delta_g_correction):\n        \"\"\"\n        Calculates OH* coverage using the Langmuir isotherm.\n\n        Args:\n            U (float): Electrode potential in V vs. SHE.\n            pH (float): Potential of hydrogen (dimensionless).\n            delta_g_correction (float): Additive correction to the standard\n                                        free energy in eV.\n\n        Returns:\n            float: Adsorbate coverage theta, a dimensionless value in [0, 1].\n        \"\"\"\n        # Calculate the standard free energy including any corrections.\n        delta_g_zero_effective = DELTA_G_ZERO + delta_g_correction\n\n        # Calculate the potential- and pH-dependent reaction free energy.\n        # The term eU in eV is numerically equal to U in V.\n        delta_g = delta_g_zero_effective - U - PH_TO_EV * pH\n\n        # Calculate the argument for the exponential function.\n        # Handle potential numerical overflow by clipping the argument.\n        # A large positive delta_g/(kBT) makes exp() very large, so theta - 0.\n        # A large negative delta_g/(kBT) makes exp() - 0, so theta - 1.\n        exponent_arg = delta_g / KBT\n        # Clip the argument to avoid overflow in np.exp\n        exponent_arg = np.clip(exponent_arg, -700, 700)\n        \n        # Calculate coverage using the Langmuir isotherm expression.\n        theta = 1.0 / (1.0 + np.exp(exponent_arg))\n        \n        return theta\n\n    # Define the test suite from the problem statement.\n    # Each case is a tuple of (U in V, pH).\n    test_cases = [\n        (0.60, 13),\n        (0.00, 0),\n        (0.25, 7),\n        (1.00, 14),\n        (-0.10, 1),\n        (0.50, 2),\n    ]\n\n    results = []\n    for U_val, pH_val in test_cases:\n        # Calculate coverage for the standard CHE model (no correction).\n        theta_che = calculate_coverage(U_val, pH_val, 0.0)\n        \n        # Calculate coverage for the model with explicit solvation correction.\n        theta_corr = calculate_coverage(U_val, pH_val, DELTA_G_SOLV)\n        \n        # Calculate the absolute difference in coverage.\n        delta_theta = abs(theta_che - theta_corr)\n        \n        results.append(delta_theta)\n\n    # Calculate the arithmetic mean of the six delta_theta values.\n    mean_delta_theta = sum(results) / len(results)\n    \n    # Append the mean to the list of results.\n    results.append(mean_delta_theta)\n\n    # Format the final output as specified: a comma-separated list\n    # in brackets, with each value rounded to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在建立了热力学框架后，我们可以计算电极-电解质界面的关键物理性质，例如其微分电容。本练习将指导你构建一个电荷均衡模型来计算电容，更重要的是，它将让你直面并处理任何原子尺度模拟中都存在的有限尺寸效应。通过学习如何将模拟结果外推到宏观极限，你将掌握确保计算结果物理真实性的关键技能。",
            "id": "4236813",
            "problem": "考虑一个与电解质接触的平面金属电极。在腐蚀过程的原子模型中，金属电极被离散化为 $N$ 个原子位点，这些位点排列在一个方形晶格上，其横向尺寸为 $L_x = L_y = L$，晶格常数为 $a$。每个位点 $i$ 在外加电极电势 $V$ 的作用下会感应出电荷 $q_i$，电解质会以德拜屏蔽长度 $\\lambda_D$ 屏蔽静电相互作用。假设相互作用是成对相加的，并由屏蔽库仑（Yukawa）核函数决定。在恒定外加电势下，电荷构型 $\\{q_i\\}$ 的静电能模型为\n$$\nU(\\{q_i\\};V) = \\frac{1}{2}\\sum_{i=1}^{N} \\eta\\, q_i^2 + \\frac{1}{2}\\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N} \\frac{1}{4\\pi\\varepsilon_0 \\varepsilon_r} \\frac{q_i q_j}{r_{ij}} e^{-r_{ij}/\\lambda_D} - V \\sum_{i=1}^{N} q_i,\n$$\n其中 $r_{ij}$ 是位点 $i$ 和 $j$ 之间的面内距离，$\\varepsilon_0$ 是真空介电常数，$\\varepsilon_r$ 是电解质的相对介电常数，$\\eta$ 是一个局域的二次“电子硬度”系数，用于正则化每个位点的响应。电极是一个面积为 $A = L^2$ 的正方形，由 $N = n^2$ 个位点构成，这些位点位于间距为 $a$ 的 $n\\times n$ 晶格上的 $\\mathbf{r}_i$ 位置，因此 $L = n a$。总感应电荷为 $Q(V) = \\sum_{i=1}^{N} q_i(V)$，在小外加电势下，微分电容 $C$ 由线性响应关系 $Q(V) \\approx C V$ 定义（当 $|V| \\to 0$ 时）。我们感兴趣的强度量是单位面积电容 $C/A$，单位为 $\\mathrm{F}/\\mathrm{m}^2$。\n\n您的任务是编写一个程序，对于给定的一组物理上合理的参数 $(a, \\varepsilon_r, \\lambda_D, \\eta)$ 和一系列横向尺寸 $L$（通过在保持 $a$ 不变的情况下改变 $n$ 获得），完成以下所有操作：\n- 构建 $N = n^2$ 个位点的方形晶格，并计算所有位点对 $(i,j)$ 之间的成对距离 $r_{ij}$（单位为米）。在单个周期单元内严格使用二维距离，不进行镜像求和；也就是说，将电极视为具有开放横向边界的有限片区。\n- 使用确定性数值方法，在两个小电势 $V = +\\Delta V$ 和 $V = -\\Delta V$ 下，对能量 $U(\\{q_i\\};V)$ 关于 $\\{q_i\\}$ 进行最小化。根据这两个解，通过中心有限差分近似 $dQ/dV$ 来估计该横向尺寸下的微分电容 $C(L)$，即 $C(L) \\approx \\left(Q(+\\Delta V) - Q(-\\Delta V)\\right) / \\left(2 \\Delta V\\right)$，其中 $Q(V) = \\sum_i q_i(V)$。\n- 对于每个 $L$，将 $C(L)$ 转换为单位为 $\\mathrm{F}/\\mathrm{m}^2$ 的 $C(L)/A$。\n- 通过将 $C(L)/A$ 对 $L$ 的依赖关系拟合为关于 $1/L$ 的二次多项式 $C(L)/A \\approx c_0 + c_1/L + c_2/L^2$，来量化有限尺寸效应，并报告外推的无限面积极限值 $c_0$（单位为 $\\mathrm{F}/\\mathrm{m}^2$）。\n\n在您的程序中使用以下固定常数和单位：\n- 真空介电常数 $\\varepsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F}/\\mathrm{m}$。\n- 基本电荷 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$（仅在需要时用于健全性检查；计算中非必需）。\n- 电势步长 $\\Delta V = 10^{-3}\\,\\mathrm{V}$。\n\n所有物理距离以米表示，电势以伏特表示，电荷以库仑表示，能量以焦耳表示，并以 $\\mathrm{F}/\\mathrm{m}^2$ 报告单位面积电容。此问题不涉及角度。\n\n测试套件：\n对于每组参数，对通过 $n \\in \\{6,8,10,12\\}$ 获得的四个横向尺寸进行计算，因此 $L = n a$ 且 $A = L^2$。使用以下四组科学上合理的参数集，每组都用一致的单位指定：\n1. 情况 A（理想情况）：\n   - $a = 0.25\\,\\mathrm{nm}$，\n   - $\\varepsilon_r = 78.4$，\n   - $\\lambda_D = 0.5\\,\\mathrm{nm}$，\n   - $\\eta = 1.0\\times 10^{19}\\,\\mathrm{J}/\\mathrm{C}^2$。\n2. 情况 B（更长的屏蔽长度）：\n   - $a = 0.25\\,\\mathrm{nm}$，\n   - $\\varepsilon_r = 78.4$，\n   - $\\lambda_D = 2.0\\,\\mathrm{nm}$，\n   - $\\eta = 1.0\\times 10^{19}\\,\\mathrm{J}/\\mathrm{C}^2$。\n3. 情况 C（更低的介电常数）：\n   - $a = 0.25\\,\\mathrm{nm}$，\n   - $\\varepsilon_r = 10.0$，\n   - $\\lambda_D = 0.5\\,\\mathrm{nm}$，\n   - $\\eta = 1.0\\times 10^{19}\\,\\mathrm{J}/\\mathrm{C}^2$。\n4. 情况 D（更软的电子硬度）：\n   - $a = 0.25\\,\\mathrm{nm}$，\n   - $\\varepsilon_r = 78.4$，\n   - $\\lambda_D = 0.5\\,\\mathrm{nm}$，\n   - $\\eta = 5.0\\times 10^{18}\\,\\mathrm{J}/\\mathrm{C}^2$。\n\n对于每种情况，使用四个 $L$ 值拟合 $C(L)/A$ 与 $1/L$ 的关系，并提取对应于无限面积极限的系数 $c_0$。您的程序应生成单行输出，其中包含情况 A–D 的四个 $c_0$ 值，按顺序排列，格式为方括号括起来的逗号分隔的 Python 列表（例如，“[$c_0^\\mathrm{A},c_0^\\mathrm{B},c_0^\\mathrm{C},c_0^\\mathrm{D}$]”）。每个值都必须是单位为 $\\mathrm{F}/\\mathrm{m}^2$ 的浮点数。",
            "solution": "问题陈述具有科学依据、定义明确，并为得出唯一且有意义的解提供了所有必要信息。它描述了一种用于离散化电极-电解质界面的标准恒定电势电荷均衡模型，这是计算电化学中的一项常见任务。物理参数是合理的，计算任务定义明确且可行。因此，该问题被认为是有效的，下面将给出完整解法。\n\n问题的核心是在恒定外加电势 $V$ 下，找到一组 $N$ 个离散原子位点上的平衡电荷分布 $\\{q_i\\}$，以最小化指定的静电能泛函 $U(\\{q_i\\}; V)$。能量泛函由下式给出：\n$$\nU(\\{q_i\\};V) = \\frac{1}{2}\\sum_{i=1}^{N} \\eta\\, q_i^2 + \\frac{1}{2}\\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N} J_{ij} q_i q_j - V \\sum_{i=1}^{N} q_i\n$$\n其中 $J_{ij}$ 表示位点 $i$ 和 $j$ 之间的屏蔽库仑相互作用：\n$$\nJ_{ij} = \\frac{1}{4\\pi\\varepsilon_0 \\varepsilon_r} \\frac{e^{-r_{ij}/\\lambda_D}}{r_{ij}}\n$$\n该能量泛函 $U$ 是关于电荷 $\\{q_i\\}$ 的二次函数。这种函数的唯一最小值可以通过将能量对每个电荷 $q_k$ 的梯度设为零来找到。对于所有 $k \\in \\{1, \\dots, N\\}$，条件 $\\partial U / \\partial q_k = 0$ 产生一个包含 $N$ 个线性方程的方程组：\n$$\n\\frac{\\partial U}{\\partial q_k} = \\eta q_k + \\sum_{\\substack{j=1 \\\\ j\\neq k}}^{N} J_{kj} q_j - V = 0\n$$\n该方程组可以写成矩阵形式：\n$$\n\\mathbf{H} \\mathbf{q} = V \\mathbf{1}\n$$\n这里，$\\mathbf{q}$ 是电荷列向量 $[q_1, q_2, \\dots, q_N]^T$，$\\mathbf{1}$ 是一个长度为 $N$ 的全一列向量，$\\mathbf{H}$ 是能量二次部分的 $N \\times N$ 对称 Hessian 矩阵。其元素为：\n$$\nH_{ij} = \\frac{\\partial^2 U}{\\partial q_i \\partial q_j} =\n\\begin{cases}\n\\eta  \\text{if } i=j \\\\\nJ_{ij}  \\text{if } i\\neq j\n\\end{cases}\n$$\n电子硬度参数 $\\eta$ 的值为正，且与非对角相互作用项 $J_{ij}$ 相比足够大，这确保了 Hessian 矩阵 $\\mathbf{H}$ 是正定的。这保证了线性系统有唯一解，对应于能量泛函的唯一最小值。\n\n对于四种参数情况中的每一种，求解过程都遵循以下步骤：\n\n1.  **晶格生成**：对于每个给定的网格尺寸参数 $n \\in \\{6, 8, 10, 12\\}$，我们构建一个包含 $N = n^2$ 个位点的二维方形晶格。位点被放置在坐标 $(i \\cdot a, j \\cdot a)$ 处，其中 $i, j \\in \\{0, 1, \\dots, n-1\\}$。系统的横向尺寸为 $L = n a$。然后，我们计算所有位点之间成对欧几里得距离的完整 $N \\times N$ 矩阵 $r_{ij}$。\n\n2.  **Hessian 矩阵构建**：使用计算出的距离 $r_{ij}$ 和给定的参数 $(\\varepsilon_r, \\lambda_D, \\eta)$ 来组装 Hessian 矩阵 $\\mathbf{H}$。对角元素设置为 $\\eta$，非对角元素使用屏蔽库仑相互作用核函数 $J_{ij}$ 计算。所有参数都转换为国际单位制（米、法拉、焦耳、库仑）。\n\n3.  **电容计算**：问题要求通过中心有限差分法估算微分电容 $C$。电荷向量 $\\mathbf{q}(V)$ 通过求解线性系统 $\\mathbf{H} \\mathbf{q}(V) = V \\mathbf{1}$ 得到。由于该系统是线性的，$\\mathbf{q}(V) = V \\cdot (\\mathbf{H}^{-1}\\mathbf{1})$，这意味着总电荷 $Q(V) = \\sum_i q_i(V)$ 与 $V$ 呈线性关系。具体来说，$Q(-V) = -Q(+V)$。因此，电容的有限差分公式大大简化：\n    $$\n    C(L) = \\frac{Q(+\\Delta V) - Q(-\\Delta V)}{2\\Delta V} = \\frac{Q(+\\Delta V) - (-Q(+\\Delta V))}{2\\Delta V} = \\frac{2 Q(+\\Delta V)}{2\\Delta V} = \\frac{Q(+\\Delta V)}{\\Delta V}\n    $$\n    因此，对于每个晶格尺寸 $L$，我们为 $V = +\\Delta V = 10^{-3}\\,\\mathrm{V}$ 求解一次线性系统以找到电荷向量 $\\mathbf{q}(+\\Delta V)$，计算总电荷 $Q(+\\Delta V) = \\sum_i q_i$，并获得电容 $C(L)$。然后，通过电极面积 $A = L^2$ 对其进行归一化，得到单位面积电容 $C(L)/A$。\n\n4.  **有限尺寸外推**：对 $n \\in \\{6, 8, 10, 12\\}$ 对应的四个晶格尺寸重复上述过程。这将产生四个 $(1/L, C/A)$ 数据点。然后将这些点拟合为关于 $1/L$ 的二次多项式：\n    $$\n    \\frac{C(L)}{A} \\approx c_0 + c_1 \\frac{1}{L} + c_2 \\frac{1}{L^2}\n    $$\n    此拟合使用标准的线性最小二乘法（`numpy.polyfit`）进行。得到的系数 $c_0$ 代表无限大电极（$L \\to \\infty$）的外推单位面积电容，即所需结果。\n\n提供的 Python 代码实现了这整个工作流程。它遍历四个指定的测试用例，在每个用例中对四种晶格尺寸进行计算，执行多项式拟合，并提取 $c_0$ 参数。最终输出是包含四个 $c_0$ 值的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the infinite-area capacitance per unit area for an atomistic \n    electrode model under different physical parameters.\n    \"\"\"\n\n    # --- Fixed Constants in SI units ---\n    # Vacuum permittivity in F/m\n    EPS0 = 8.854187817e-12\n    # Potential step for finite difference in V\n    DELTA_V = 1.0e-3\n    \n    # --- Test Cases ---\n    test_cases = [\n        # Case A (happy path)\n        {'a': 0.25e-9, 'eps_r': 78.4, 'lambda_d': 0.5e-9, 'eta': 1.0e19},\n        # Case B (longer screening length)\n        {'a': 0.25e-9, 'eps_r': 78.4, 'lambda_d': 2.0e-9, 'eta': 1.0e19},\n        # Case C (lower permittivity)\n        {'a': 0.25e-9, 'eps_r': 10.0, 'lambda_d': 0.5e-9, 'eta': 1.0e19},\n        # Case D (softer electronic hardness)\n        {'a': 0.25e-9, 'eps_r': 78.4, 'lambda_d': 0.5e-9, 'eta': 5.0e18},\n    ]\n\n    # --- Lattice Sizes ---\n    n_values = [6, 8, 10, 12]\n    \n    results = []\n\n    for case_params in test_cases:\n        a = case_params['a']\n        eps_r = case_params['eps_r']\n        lambda_d = case_params['lambda_d']\n        eta = case_params['eta']\n        \n        # Lists to store results for finite-size analysis\n        inverse_L_vals = []\n        cap_per_area_vals = []\n        \n        k_const = 1.0 / (4.0 * np.pi * EPS0 * eps_r)\n\n        for n in n_values:\n            N = n * n\n            L = n * a\n            \n            # 1. Construct lattice and compute pairwise distances\n            coords = np.array([[i * a, j * a] for i in range(n) for j in range(n)])\n            \n            # Using broadcasting for efficient distance calculation\n            diffs = coords[:, np.newaxis, :] - coords[np.newaxis, :, :]\n            dist_matrix = np.sqrt(np.sum(diffs**2, axis=-1))\n\n            # 2. Construct the Hessian matrix H\n            H = np.zeros((N, N))\n            \n            # Off-diagonal elements (i != j)\n            # Create a mask to avoid division by zero for diagonal elements\n            off_diagonal_mask = (dist_matrix > 0)\n            r_ij = dist_matrix[off_diagonal_mask]\n            \n            interaction_values = k_const * np.exp(-r_ij / lambda_d) / r_ij\n            H[off_diagonal_mask] = interaction_values\n            \n            # Diagonal elements (i == j)\n            np.fill_diagonal(H, eta)\n\n            # 3. Solve the linear system for charges\n            # We solve H*q = V*1 for V = DELTA_V\n            V_vector = np.full(N, DELTA_V)\n            q_vector = np.linalg.solve(H, V_vector)\n\n            # 4. Calculate capacitance per area\n            # Total charge Q = sum(q_i)\n            Q_total = np.sum(q_vector)\n            \n            # Capacitance C = Q(DELTA_V) / DELTA_V\n            capacitance = Q_total / DELTA_V\n            \n            # Area A = L^2\n            area = L * L\n            \n            # Capacitance per unit area in F/m^2\n            cap_per_area = capacitance / area\n            \n            # Store values for fitting\n            inverse_L_vals.append(1.0 / L)\n            cap_per_area_vals.append(cap_per_area)\n\n        # 5. Fit to polynomial and extract c0\n        # Fit C/A = c0 + c1*(1/L) + c2*(1/L)^2\n        # numpy.polyfit returns coefficients [c2, c1, c0] for descending powers\n        coeffs = np.polyfit(inverse_L_vals, cap_per_area_vals, 2)\n        c0 = coeffs[2]\n        \n        results.append(c0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "原子尺度模拟的最终目标之一是预测真实世界的材料行为，这通常需要跨越不同时空尺度的建模。这项综合性练习将演示如何搭建从原子尺度到介观尺度的桥梁。你将学习如何使用从原子模拟数据中提取的有效参数（如反应速率 $k$、扩散系数 $D$ 和界面能 $\\gamma$）来构建一个相场模型，从而预测腐蚀坑的生长形态，亲身体验多尺度模拟在腐蚀科学中的强大预测能力。",
            "id": "4236803",
            "problem": "您的任务是设计一个完整的、可运行的程序，该程序 (i) 从原子尺度模拟输出中计算有效参数，以及 (ii) 在二维相场模拟中使用这些参数来验证局部腐蚀的蚀坑生长形态。物理情景是一个金属-电解质界面，其中序参量 $\\phi$ 代表金属相 ($\\phi \\approx 1$) 和电解质相 ($\\phi \\approx 0$)。程序必须对每个提供的测试用例执行以下步骤，并生成一个布尔值，以指示模拟的蚀坑形态是否在指定容差范围内与目标形态匹配。\n\n使用的基础原理：\n- 热激活反应速率的阿伦尼乌斯定律：$k = \\nu \\exp\\left(-\\frac{E_a}{k_B T}\\right)$，其中 $k$ 是反应速率，单位为 $\\mathrm{s^{-1}}$，$\\nu$ 是尝试频率，单位为 $\\mathrm{s^{-1}}$，$E_a$ 是活化能，单位为 $\\mathrm{eV}$，$k_B$ 是玻尔兹曼常数，单位为 $\\mathrm{eV/K}$，$T$ 是绝对温度，单位为 $\\mathrm{K}$。\n- $d$ 维空间中扩散的爱因斯坦关系：对于长时间，$\\mathrm{MSD}(\\tau) \\approx 2 d D \\tau$，其中 $D$ 是扩散系数，单位为 $\\mathrm{m^2/s}$，$\\tau$ 是延迟时间，单位为 $\\mathrm{s}$，$\\mathrm{MSD}$ 是均方位移，单位为 $\\mathrm{m^2}$。通过对 $\\mathrm{MSD}$ 与时间进行线性拟合， $D$ 可以估计为 $D = \\frac{\\text{slope}}{2 d}$。\n- 通过原子尺度平板计算得出的界面能：$\\gamma = \\frac{E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}}}{2 A}$，其中 $\\gamma$ 的单位为 $\\mathrm{J/m^2}$，$E_{\\mathrm{slab}}$ 和 $E_{\\mathrm{bulk}}$ 是能量，单位为 $\\mathrm{J}$，$N$ 是原子数，$A$ 是表面积，单位为 $\\mathrm{m^2}$。当能量以 $\\mathrm{eV}$ 提供，面积以 $\\mathrm{nm^2}$ 提供时，使用 $1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$ 和 $1~\\mathrm{nm^2} = 10^{-18}~\\mathrm{m^2}$。\n- 具有双阱势和梯度惩罚的相场自由能：$F[\\phi] = \\int \\left( W f(\\phi) + \\frac{\\kappa}{2} |\\nabla \\phi|^2 \\right) \\,\\mathrm{d}\\mathbf{x}$，其中 $f(\\phi) = \\phi^2 (1 - \\phi)^2$，$W$ 是一个能量密度尺度，$\\kappa$ 是梯度惩罚系数。与此泛函相关的平面界面能满足 $\\gamma = \\int_0^1 \\sqrt{2 \\kappa W f(\\phi)}\\, \\mathrm{d}\\phi$。对于 $f(\\phi) = \\phi^2(1-\\phi)^2$，注意到 $\\sqrt{f(\\phi)} = \\phi(1-\\phi)$ 且 $\\int_0^1 \\phi(1-\\phi)\\,\\mathrm{d}\\phi = \\frac{1}{6}$，得到 $\\gamma = \\frac{1}{6}\\sqrt{2\\kappa W}$。这意味着当指定 $W$ 时，$\\kappa = \\frac{18 \\gamma^2}{W}$。\n\n相场动力学：\n- 使用带有局域于界面附近反应源的非守恒 Allen–Cahn 动力学：$\\frac{\\partial \\phi}{\\partial t} = -M \\left( W \\frac{\\partial f}{\\partial \\phi} - \\kappa \\nabla^2 \\phi \\right) - k\\, g(\\phi)\\, S(\\mathbf{x})$，其中 $M$ 是一个动力学系数，$g(\\phi) = \\phi (1-\\phi)$ 将反应局域在界面上，$S(\\mathbf{x})$ 是一个空间局域化函数（使用以初始界面为中心的高斯函数）。\n- 双阱势的导数是 $\\frac{\\partial f}{\\partial \\phi} = 2 \\phi (1-\\phi) (1 - 2\\phi)$。\n\n为确保计算可行性而进行的离散化和归一化：\n- 使用尺寸为 $N_x \\times N_y$ 的二维笛卡尔网格，其中 $N_x = 64$，$N_y = 64$。\n- 将 $\\phi(x,y)$ 初始化为：当 $y \\geq y_{\\mathrm{int}}$ 时 $\\phi=1$（金属），当 $y  y_{\\mathrm{int}}$ 时 $\\phi=0$（电解质），其中 $y_{\\mathrm{int}} = \\frac{N_y}{2} - 1$。\n- 对 $\\nabla^2 \\phi$ 使用五点模板，并通过边缘填充（edge-padding）实现零通量（Neumann）边界条件。\n- 对 $S(\\mathbf{x})$ 使用以 $(x_0,y_0)$ 为中心的高斯函数，其中 $x_0 = \\frac{N_x}{2}$，$y_0 = y_{\\mathrm{int}}$，标准差为 $\\sigma = 4$ 个网格单位。\n- 为以数值稳定的方式将原子尺度参数与相场系数联系起来：\n  - 设置 $W = 1$（归一化）。\n  - 设置 $\\kappa = 18 \\gamma^2$（因为 $W = 1$）。\n  - 通过 $M = \\alpha \\frac{D}{D_{\\mathrm{ref}}}$ 将 $M$ 设置为与扩散率成正比，其中 $\\alpha = 0.2$（无量纲缩放），并且 $D_{\\mathrm{ref}} = 10^{-20}~\\mathrm{m^2/s}$。\n  - 使用时间步长 $\\Delta t = 0.05$，总共 $250$ 个时间步。\n- 为计算扩散系数，将 $\\mathrm{MSD}(t)$（单位 $\\mathrm{nm^2}$）对 $t$（单位 $\\mathrm{s}$）进行直线拟合，然后将斜率转换为 $\\mathrm{m^2/s}$，使用 $d=2$，因此 $D = \\frac{\\text{slope} \\times 10^{-18}}{4}$。\n\n形态验证指标：\n- 模拟结束后，计算定义为 $R = \\frac{h}{w}$ 的蚀坑纵横比，其中 $h$ 是沿 $x=x_0$ 列的蚀坑深度，单位为网格单位（从 $y=y_{\\mathrm{int}}$ 开始向下计数 $\\phi  0.5$ 的连续单元格），$w$ 是在 $y=y_{\\mathrm{int}}$ 行的蚀坑宽度，单位为网格单位（以 $x=x_0$ 为中心计数 $\\phi  0.5$ 的连续单元格）。如果没有形成蚀坑，则 $R=0$。\n- 通过将 $R$ 与目标 $R_{\\mathrm{target}}$ 在容差 $\\epsilon$ 下进行比较来验证：如果 $|R - R_{\\mathrm{target}}| \\leq \\epsilon$，则接受，返回一个布尔结果。\n\n单位：\n- 反应速率 $k$ 必须以 $\\mathrm{s^{-1}}$ 为单位计算。\n- 扩散系数 $D$ 必须以 $\\mathrm{m^2/s}$ 为单位计算。\n- 界面能 $\\gamma$ 必须以 $\\mathrm{J/m^2}$ 为单位计算。\n- 最终输出是一个布尔值列表；布尔值不需要物理单位。\n\n测试套件：\n提供以下三个测试用例。每个用例都提供了原子尺度输出和目标形态。能量（单位 $\\mathrm{eV}$）和面积（单位 $\\mathrm{nm^2}$）必须如上所述在内部转换为国际单位制（SI）单位。\n\n- 用例 1（中等反应，中等扩散，中等界面能）：\n  - $T = 300$，\n  - $\\nu = 1.0 \\times 10^{13}$，\n  - $E_a = 0.8$，\n  - 时间（用于均方根位移）：$[0, 1, 2, 3, 4]$，\n  - $\\mathrm{MSD}(t)$，单位 $\\mathrm{nm^2}$：$[0, 0.04, 0.08, 0.12, 0.16]$，\n  - $E_{\\mathrm{slab}} = 1900$，\n  - $N = 400$，\n  - $E_{\\mathrm{bulk}} = 3.0$，\n  - $A = 100$，\n  - 目标纵横比 $R_{\\mathrm{target}} = 0.7$，\n  - 容差 $\\epsilon = 0.5$。\n\n- 用例 2（由于高能垒导致反应非常缓慢；蚀坑不应有明显生长）：\n  - $T = 300$，\n  - $\\nu = 1.0 \\times 10^{13}$，\n  - $E_a = 1.2$，\n  - 时间：$[0, 1, 2, 3, 4]$，\n  - $\\mathrm{MSD}(t)$，单位 $\\mathrm{nm^2}$：$[0, 0.04, 0.08, 0.12, 0.16]$，\n  - $E_{\\mathrm{slab}} = 1900$，\n  - $N = 400$，\n  - $E_{\\mathrm{bulk}} = 3.0$，\n  - $A = 100$，\n  - 目标纵横比 $R_{\\mathrm{target}} = 0.05$，\n  - 容差 $\\epsilon = 0.1$。\n\n- 用例 3（快速扩散，较低界面能；预计蚀坑相对于深度更宽）：\n  - $T = 300$，\n  - $\\nu = 1.0 \\times 10^{13}$，\n  - $E_a = 0.6$，\n  - 时间：$[0, 1, 2, 3, 4]$，\n  - $\\mathrm{MSD}(t)$，单位 $\\mathrm{nm^2}$：$[0, 4.0, 8.0, 12.0, 16.0]$，\n  - $E_{\\mathrm{slab}} = 1400$，\n  - $N = 400$，\n  - $E_{\\mathrm{bulk}} = 3.0$，\n  - $A = 100$，\n  - 目标纵横比 $R_{\\mathrm{target}} = 0.3$，\n  - 容差 $\\epsilon = 0.5$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\text{result1},\\text{result2},\\text{result3}]$），其中每个元素都是一个布尔值，表示相应测试用例的模拟是否在指定容差内与目标形态匹配。",
            "solution": "用户提供了一个明确的计算问题，该问题属于计算电化学和材料科学领域。此问题要求将原子尺度计算的概念与介观尺度的相场模型相结合，以模拟局部腐蚀。在继续解决方案之前，我将首先执行强制性验证。\n\n### 步骤 1：提取给定信息\n\n**物理模型和方程：**\n- **阿伦尼乌斯定律：** $k = \\nu \\exp\\left(-\\frac{E_a}{k_B T}\\right)$\n- **爱因斯坦关系（二维）：** $\\mathrm{MSD}(\\tau) \\approx 4 D \\tau$，对于 $\\mathrm{MSD}$ 对 $\\tau$ 的线性拟合，得出 $D = \\frac{\\text{slope}}{4}$。\n- **界面能：** $\\gamma = \\frac{E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}}}{2 A}$\n- **相场自由能：** $F[\\phi] = \\int \\left( W f(\\phi) + \\frac{\\kappa}{2} |\\nabla \\phi|^2 \\right) \\,\\mathrm{d}\\mathbf{x}$，其中 $f(\\phi) = \\phi^2 (1 - \\phi)^2$。\n- **由相场模型得出的界面能：** $\\gamma = \\frac{1}{6}\\sqrt{2\\kappa W}$，这意味着 $\\kappa = \\frac{18 \\gamma^2}{W}$。\n- **带反应的 Allen-Cahn 方程：** $\\frac{\\partial \\phi}{\\partial t} = -M \\left( W \\frac{\\partial f}{\\partial \\phi} - \\kappa \\nabla^2 \\phi \\right) - k\\, g(\\phi)\\, S(\\mathbf{x})$\n- **势函数导数：** $\\frac{\\partial f}{\\partial \\phi} = 2 \\phi (1-\\phi) (1 - 2\\phi)$\n- **反应局域化：** $g(\\phi) = \\phi (1-\\phi)$\n\n**数值和模拟参数：**\n- **网格：** $N_x = 64$, $N_y = 64$\n- **初始条件：** 当 $y \\geq y_{\\mathrm{int}}$ 时 $\\phi=1$，当 $y  y_{\\mathrm{int}}$ 时 $\\phi=0$，其中 $y_{\\mathrm{int}} = \\frac{N_y}{2} - 1 = 31$。\n- **边界条件：** 零通量（Neumann），通过边缘填充实现。\n- **拉普拉斯算子离散化：** 五点模板。\n- **反应空间局域化：** $S(\\mathbf{x})$ 是一个以 $(x_0, y_0) = (N_x/2, y_{\\mathrm{int}}) = (32, 31)$ 为中心的高斯函数，标准差为 $\\sigma = 4$ 个网格单位。\n- **参数化：**\n  - $W = 1$\n  - $\\kappa = 18 \\gamma^2$\n  - $M = \\alpha \\frac{D}{D_{\\mathrm{ref}}}$，其中 $\\alpha = 0.2$，并且 $D_{\\mathrm{ref}} = 10^{-20}~\\mathrm{m^2/s}$。\n- **时间积分：** $\\Delta t = 0.05$，共 $250$ 步。\n\n**单位转换和常数：**\n- 玻尔兹曼常数 $k_B$，单位为 $\\mathrm{eV/K}$。\n- $1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$\n- $1~\\mathrm{nm^2} = 10^{-18}~\\mathrm{m^2}$\n- $D$ 来自 $\\mathrm{MSD}(\\mathrm{nm}^2)$ 对 $t(\\mathrm{s})$ 的斜率：$D = \\frac{\\text{slope} \\times 10^{-18}}{4}$。\n\n**验证指标：**\n- 蚀坑纵横比 $R = h/w$。\n- 蚀坑深度 $h$：在 $x=x_0$ 处，从 $y=y_{\\mathrm{int}}$ 开始向下（y 坐标增加）的 $\\phi  0.5$ 的连续单元格计数。\n- 蚀坑宽度 $w$：在 $y=y_{\\mathrm{int}}$ 处，以 $x=x_0$ 为中心的 $\\phi  0.5$ 的连续单元格计数。\n- 验证标准：$|R - R_{\\mathrm{target}}| \\leq \\epsilon$。\n\n**测试用例：**\n- **用例 1：** $T=300, \\nu=10^{13}, E_a=0.8$, MSD 斜率=$0.04$, $E_{\\mathrm{slab}}=1900, N=400, E_{\\mathrm{bulk}}=3, A=100, R_{\\mathrm{target}}=0.7, \\epsilon=0.5$。\n- **用例 2：** $T=300, \\nu=10^{13}, E_a=1.2$, MSD 斜率=$0.04$, $E_{\\mathrm{slab}}=1900, N=400, E_{\\mathrm{bulk}}=3, A=100, R_{\\mathrm{target}}=0.05, \\epsilon=0.1$。\n- **用例 3：** $T=300, \\nu=10^{13}, E_a=0.6$, MSD 斜率=$4.0$, $E_{\\mathrm{slab}}=1400, N=400, E_{\\mathrm{bulk}}=3, A=100, R_{\\mathrm{target}}=0.3, \\epsilon=0.5$。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n根据预定义的标准对问题进行评估：\n\n1.  **科学基础：** 该问题坚实地植根于统计力学（阿伦尼乌斯定律、爱因斯坦关系）、固态物理（表面能计算）和连续介质力学（通过 Allen-Cahn 方程进行相场建模）的原理。通过将原子尺度参数与连续介质模拟相联系来模拟腐蚀点蚀的情景，是一种标准且科学上有效的多尺度建模方法。所有提供的方程和参数化方案在文献中都是标准的。\n2.  **适定性：** 该问题是完全指定的。它提供了所有必要的控制方程、初始条件、边界条件、数值离散化细节（网格尺寸、时间步长、模板），以及每个测试用例的完整参数集。目标（验证蚀坑形态）和验证指标都得到了明确的定义。\n3.  **客观性：** 该问题以精确、定量和无偏见的科学语言陈述。没有主观因素。\n4.  **缺陷分析：**\n    - **科学性不健全：** 无。物理和数学是正确的。玻尔兹曼常数 $k_B$ 的值没有给出，但它是一个普适常数，其使用是隐含的。这是一个微小的疏漏，而非使问题无效的缺陷。\n    - **不完整性：** 该问题是自洽的。关于“通过边缘填充”实现 Neumann 边界条件的指令是明确的，足以用于实现。\n    - **矛盾：** 没有矛盾的约束条件。\n    - **不切实际的条件：** 对于所描述的腐蚀情景，原子尺度输出和目标形态的数值是物理上合理的。\n    - **结构不良：** 该问题结构良好，引导求解者从参数提取到模拟和最终验证，每个用例都有一个预期的唯一计算结果。\n\n### 步骤 3：结论和行动\n\n该问题是 **有效的**。这是一个在计算材料科学领域完整、一致且科学上健全的问题。我现在将继续提供一个完整的解决方案。\n\n### 解决方案设计\n\n该解决方案以单个、自包含的 Python 脚本实现。其逻辑封装在一个 `solve` 函数中，该函数按顺序处理每个测试用例。总体工作流程如下：\n\n1.  **参数计算：** 对于每个测试用例，物理参数——反应速率 $k$、扩散系数 $D$ 和界面能 $\\gamma$——使用指定的公式从提供的原子尺度数据中计算得出。\n    - $k$ 通过阿伦尼乌斯定律计算。\n    - $D$ 从提供的均方根位移（MSD）数据的斜率计算得出。\n    - $\\gamma$ 从平板和体相能量计算得出。所有单位都按要求转换为国际单位制（SI）。\n\n2.  **相场模拟：** 然后使用这些物理参数来设置相场模型的系数：迁移率 $M$ 和梯度能量惩罚 $\\kappa$。\n    - 初始化一个 $64 \\times 64$ 的网格来表示金属-电解质界面。金属相（$\\phi=1$）占据网格的下半部分（$y \\ge 31$），电解质相（$\\phi=0$）占据上半部分。\n    - 模拟使用指定的 Allen-Cahn 方程的显式前向欧拉格式，在 $250$ 个时间步上演化相场 $\\phi$。\n    - 拉普拉斯算子使用五点模板进行离散化。零通量 Neumann 边界条件通过在计算模板前用边缘值填充网格来实现，正如明确指示的那样。\n    - 反应项通过一个预先计算的、以界面为中心的二维高斯函数进行局域化，该函数驱动金属相的溶解和腐蚀坑的形成。\n\n3.  **形态分析与验证：** 模拟完成后，分析腐蚀坑的最终形态。\n    - 蚀坑深度 $h$ 通过计算中心垂直轴（$x=32$）上金属已溶解（$\\phi  0.5$）的连续单元格数量来测量，从原始界面开始并进入金属区域。\n    - 蚀坑宽度 $w$ 通过计算原始界面线（$y=31$）上以蚀坑轴为中心的连续溶解单元格数量来测量。\n    - 计算纵横比 $R = h/w$。如果没有形成蚀坑（$w=0$），则 $R$ 定义为 $0$。\n    - 将此模拟纵横比 $R$ 与测试用例的目标纵横比 $R_{\\mathrm{target}}$ 进行比较。如果绝对差在给定的容差 $\\epsilon$ 之内，则结果为 `True`，否则为 `False`。\n\n4.  **输出：** 收集所有测试用例的布尔验证结果，并以指定的列表格式打印到标准输出。\n\n这种结构化方法确保了多尺度建模问题的每个步骤都得到正确实施，从而得出可验证的最终结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes effective parameters from atomistic data, runs a 2D phase-field simulation \n    of pit corrosion, and validates the resulting pit morphology.\n    \"\"\"\n    # === CONSTANTS ===\n    # Physical constants\n    KB_EV_K = 8.617333262145e-5  # Boltzmann constant in eV/K\n    EV_TO_J = 1.602176634e-19    # eV to Joules conversion factor\n    NM2_TO_M2 = 1e-18            # nm^2 to m^2 conversion factor\n\n    # Simulation parameters\n    NX, NY = 64, 64\n    Y_INT = NY // 2 - 1\n    X0, Y0 = NX // 2, Y_INT\n    SIGMA = 4.0\n    DT = 0.05\n    N_STEPS = 250\n    W_PF = 1.0  # Normalized energy density scale\n    \n    # Parameterization coefficients\n    ALPHA = 0.2\n    D_REF = 1e-20  # Reference diffusion coefficient in m^2/s\n\n    # === TEST CASES ===\n    test_cases = [\n        # Case 1: Moderate reaction, moderate diffusion\n        {\n            \"T\": 300.0, \"nu\": 1.0e13, \"Ea\": 0.8,\n            \"msd_times\": [0.0, 1.0, 2.0, 3.0, 4.0], \"msd_values\": [0.0, 0.04, 0.08, 0.12, 0.16],\n            \"E_slab\": 1900.0, \"N_atoms\": 400, \"E_bulk\": 3.0, \"A_nm2\": 100.0,\n            \"R_target\": 0.7, \"epsilon\": 0.5\n        },\n        # Case 2: Very slow reaction\n        {\n            \"T\": 300.0, \"nu\": 1.0e13, \"Ea\": 1.2,\n            \"msd_times\": [0.0, 1.0, 2.0, 3.0, 4.0], \"msd_values\": [0.0, 0.04, 0.08, 0.12, 0.16],\n            \"E_slab\": 1900.0, \"N_atoms\": 400, \"E_bulk\": 3.0, \"A_nm2\": 100.0,\n            \"R_target\": 0.05, \"epsilon\": 0.1\n        },\n        # Case 3: Fast diffusion, low interfacial energy\n        {\n            \"T\": 300.0, \"nu\": 1.0e13, \"Ea\": 0.6,\n            \"msd_times\": [0.0, 1.0, 2.0, 3.0, 4.0], \"msd_values\": [0.0, 4.0, 8.0, 12.0, 16.0],\n            \"E_slab\": 1400.0, \"N_atoms\": 400, \"E_bulk\": 3.0, \"A_nm2\": 100.0,\n            \"R_target\": 0.3, \"epsilon\": 0.5\n        }\n    ]\n\n    results = []\n\n    # Pre-compute spatial localization mask S(x,y)\n    x_coords = np.arange(NX)\n    y_coords = np.arange(NY)\n    xx, yy = np.meshgrid(x_coords, y_coords)\n    S = np.exp(-((xx - X0)**2 + (yy - Y0)**2) / (2 * SIGMA**2))\n\n    for case in test_cases:\n        # === STEP 1: CALCULATE PHYSICAL PARAMETERS ===\n        \n        # Reaction rate k (s^-1) from Arrhenius law\n        k = case[\"nu\"] * np.exp(-case[\"Ea\"] / (KB_EV_K * case[\"T\"]))\n\n        # Diffusion coefficient D (m^2/s) from Einstein relation\n        # Data is perfectly linear, so slope can be calculated from first non-zero point\n        msd_slope_nm2_s = (case[\"msd_values\"][1] - case[\"msd_values\"][0]) / \\\n                          (case[\"msd_times\"][1] - case[\"msd_times\"][0]) if case[\"msd_times\"][1] > 0 else 0\n        # For 2D, D = slope_SI / (2*d) = slope_SI / 4\n        D = (msd_slope_nm2_s * NM2_TO_M2) / 4.0\n\n        # Interfacial energy gamma (J/m^2)\n        E_surface_eV = case[\"E_slab\"] - case[\"N_atoms\"] * case[\"E_bulk\"]\n        gamma_num_J = E_surface_eV * EV_TO_J\n        gamma_den_m2 = 2 * case[\"A_nm2\"] * NM2_TO_M2\n        gamma = gamma_num_J / gamma_den_m2\n\n        # === STEP 2: CALCULATE PHASE-FIELD PARAMETERS ===\n        \n        kappa = 18.0 * gamma**2 / W_PF\n        M = ALPHA * D / D_REF\n\n        # === STEP 3: RUN PHASE-FIELD SIMULATION ===\n        \n        # Initialize phase field phi\n        phi = np.zeros((NY, NX))\n        phi[Y_INT:, :] = 1.0  # Metal (phi=1) for y >= Y_INT\n\n        # Evolve over time\n        for _ in range(N_STEPS):\n            # Compute Laplacian with Neumann BC via edge padding\n            phi_padded = np.pad(phi, pad_width=1, mode='edge')\n            lap_phi = (phi_padded[2:, 1:-1] + phi_padded[:-2, 1:-1] +\n                       phi_padded[1:-1, 2:] + phi_padded[1:-1, :-2] - 4 * phi)\n            \n            # Compute chemical potential term\n            df_dphi = 2.0 * phi * (1.0 - phi) * (1.0 - 2.0 * phi)\n            chem_potential = W_PF * df_dphi - kappa * lap_phi\n            \n            # Compute reaction term\n            g_phi = phi * (1.0 - phi)\n            reaction_term = k * g_phi * S\n            \n            # Update phi using explicit Euler time step\n            d_phi_dt = -M * chem_potential - reaction_term\n            phi += d_phi_dt * DT\n            \n            # Clamp phi to [0, 1] for numerical stability\n            np.clip(phi, 0, 1, out=phi)\n\n        # === STEP 4: CALCULATE PIT ASPECT RATIO ===\n        \n        # Calculate pit depth h\n        h = 0\n        # Pit grows into metal region (y >= Y_INT)\n        for y_idx in range(Y_INT, NY):\n            if phi[y_idx, X0]  0.5:\n                h += 1\n            else:\n                break\n        \n        # Calculate pit width w\n        w = 0\n        # Width is measured at the original interface line (y = Y_INT)\n        if phi[Y_INT, X0]  0.5:\n            w = 1\n            # Expand right from center\n            for x_idx in range(X0 + 1, NX):\n                if phi[Y_INT, x_idx]  0.5:\n                    w += 1\n                else:\n                    break\n            # Expand left from center\n            for x_idx in range(X0 - 1, -1, -1):\n                if phi[Y_INT, x_idx]  0.5:\n                    w += 1\n                else:\n                    break\n        \n        R_sim = 0.0\n        if w > 0:\n            R_sim = h / w\n\n        # === STEP 5: VALIDATE MORPHOLOGY ===\n        is_valid = abs(R_sim - case[\"R_target\"]) = case[\"epsilon\"]\n        results.append(is_valid)\n\n    # Final print statement\n    print(f\"[{','.join(str(res).lower() for res in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}