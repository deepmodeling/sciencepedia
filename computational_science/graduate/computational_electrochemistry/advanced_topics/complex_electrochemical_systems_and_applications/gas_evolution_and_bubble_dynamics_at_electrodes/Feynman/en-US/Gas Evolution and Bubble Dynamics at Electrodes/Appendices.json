{
    "hands_on_practices": [
        {
            "introduction": "A key question in gas evolution is why bubbles appear on the electrode surface and not suspended within the bulk electrolyte. This exercise explores this question through the lens of Classical Nucleation Theory (CNT), which describes the energy cost of forming a new phase. By deriving and comparing the energy barriers for homogeneous (in-bulk) and heterogeneous (on-surface) nucleation , you will gain a quantitative understanding of the profound role surfaces play in catalyzing phase transitions, a cornerstone concept in materials science and electrochemistry.",
            "id": "4246852",
            "problem": "An electrode evolving gas into an aqueous electrolyte develops a supersaturation of dissolved gas near the surface, characterized by the supersaturation ratio $S \\equiv c/c_{eq}$, where $c$ is the local dissolved gas concentration and $c_{eq}$ is the equilibrium concentration at the ambient gas partial pressure. Using the framework of Classical Nucleation Theory (CNT), consider bubble nucleation in the liquid phase under the following physically grounded assumptions: the liquid-gas interfacial tension is $\\gamma$, the temperature is $T$, the electrode is planar, and the nucleus is either a full sphere in the bulk liquid (homogeneous nucleation) or a spherical cap on the electrode surface (heterogeneous nucleation) with macroscopic contact angle $\\theta$ (measured through the liquid). Assume negligible line tension and that short-range interactions do not alter the spherical-cap geometry.\n\nStarting from fundamental thermodynamics and mechanics, model the reversible work of formation of a spherical bubble nucleus of radius $r$ by the sum of surface energy and mechanical volume work against the driving pressure difference $\\Delta p(S)$, and then determine the homogeneous critical radius $r^{\\ast}$ and barrier $\\Delta G^{\\ast}_{\\mathrm{hom}}(S)$. Use ideal solution theory and Henry’s law to relate the pressure driving force to supersaturation for a dissolved gas: $\\Delta p(S) = R T c_{eq} (S-1)$, where $R$ is the universal gas constant. For heterogeneous nucleation on a flat surface, model the nucleus as a spherical cap and relate the barrier to the homogeneous barrier via a geometry-dependent shape factor $f(\\theta)$ that arises from the ratio of the cap’s surface area and volume to those of the full sphere.\n\nLet the kinetic prefactors for homogeneous and heterogeneous nucleation be comparable so that nucleation rate ratios are controlled by the barrier difference through an Arrhenius form $J \\propto \\exp(-\\Delta G^{\\ast}/k_{B} T)$, where $k_{B}$ is the Boltzmann constant. For the same $S$ and $T$, compare the heterogeneous and homogeneous nucleation rates and determine the supersaturation ratio $S$ at which the heterogeneous rate dominates by six orders of magnitude (i.e., $J_{\\mathrm{het}}/J_{\\mathrm{hom}} = 10^{6}$) for a typical hydrophobic electrode with $\\theta = 100^{\\circ}$. Express your final $S$ as a single closed-form analytic expression in terms of $\\gamma$, $T$, $R$, $c_{eq}$, $k_{B}$, and trigonometric functions of $100^{\\circ}$. $S$ is dimensionless; no units are required in the final answer.",
            "solution": "We begin from the classical reversible work of forming a spherical bubble of radius $r$ in a supersaturated liquid. The total free energy change combines the surface energy and the mechanical work against the pressure driving force. For a spherical bubble in the bulk,\n$$\n\\Delta G(r) = 4 \\pi r^{2} \\gamma - \\frac{4}{3} \\pi r^{3} \\Delta p,\n$$\nwhere $\\gamma$ is the liquid-gas interfacial tension and $\\Delta p$ is the excess gas pressure in the bubble relative to the far-field liquid, which provides the volumetric driving force. The critical nucleus satisfies the extremum condition $\\frac{d \\Delta G}{d r} = 0$, which yields\n$$\n\\frac{d \\Delta G}{d r} = 8 \\pi r \\gamma - 4 \\pi r^{2} \\Delta p = 0 \\quad \\Rightarrow \\quad r^{\\ast} = \\frac{2 \\gamma}{\\Delta p}.\n$$\nSubstituting $r^{\\ast}$ back into $\\Delta G(r)$ gives the homogeneous nucleation barrier\n$$\n\\Delta G^{\\ast}_{\\mathrm{hom}} = \\Delta G(r^{\\ast}) = \\frac{16 \\pi \\gamma^{3}}{3 \\, \\Delta p^{2}}.\n$$\n\nNext, we relate the pressure driving force to the supersaturation $S$ using ideal solution theory and Henry’s law. For a dilute dissolved gas, the gas partial pressure in a bubble in diffusive equilibrium with the solution of concentration $c$ is $p_{g} = R T c$ (this follows from equating chemical potentials for the dissolved gas and the ideal gas inside the bubble and using Henry’s law with ideality in the dilute limit). At far-field equilibrium, $p_{eq} = R T c_{eq}$. Supersaturation $S = c/c_{eq}$ implies $p_{g} = R T S c_{eq}$, so the mechanical driving force is the excess pressure relative to the equilibrium state,\n$$\n\\Delta p(S) = p_{g} - p_{eq} = R T c_{eq} (S - 1).\n$$\nTherefore,\n$$\n\\Delta G^{\\ast}_{\\mathrm{hom}}(S) = \\frac{16 \\pi \\gamma^{3}}{3 \\left[ R T c_{eq} (S-1) \\right]^{2}}.\n$$\n\nFor heterogeneous nucleation of a spherical-cap bubble on a flat substrate with contact angle $\\theta$, neglecting line tension and assuming that the cap shares the same curvature radius as the homogeneous critical sphere, the barrier is reduced by a geometry-dependent shape factor $f(\\theta)$:\n$$\n\\Delta G^{\\ast}_{\\mathrm{het}}(S,\\theta) = f(\\theta) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S).\n$$\nThe shape factor $f(\\theta)$ follows from the ratio of the cap’s surface and volume terms to those of a full sphere, and for a spherical cap on a flat substrate is the well-tested expression\n$$\nf(\\theta) = \\frac{(2 + \\cos\\theta)\\left(1 - \\cos\\theta\\right)^{2}}{4}.\n$$\nNote that $0  f(\\theta)  1$ for $0^{\\circ}  \\theta  180^{\\circ}$.\n\nThe nucleation rate in CNT is typically written as $J = J_{0} \\exp\\!\\left( - \\frac{\\Delta G^{\\ast}}{k_{B} T} \\right)$, where $J_{0}$ is a kinetic prefactor that depends weakly on the barrier compared to the exponential sensitivity. For comparing homogeneous and heterogeneous nucleation at the same $S$ and $T$, it is common and justified to approximate the prefactors as comparable, so the rate ratio is dominated by the barrier difference:\n$$\n\\frac{J_{\\mathrm{het}}}{J_{\\mathrm{hom}}} \\approx \\exp\\!\\left( \\frac{\\Delta G^{\\ast}_{\\mathrm{hom}} - \\Delta G^{\\ast}_{\\mathrm{het}}}{k_{B} T} \\right) = \\exp\\!\\left( \\frac{(1 - f(\\theta)) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S)}{k_{B} T} \\right).\n$$\n\nWe impose the condition that the heterogeneous rate dominates by six orders of magnitude:\n$$\n\\frac{J_{\\mathrm{het}}}{J_{\\mathrm{hom}}} = 10^{6}.\n$$\nTaking the natural logarithm,\n$$\n\\ln\\!\\left(10^{6}\\right) = \\frac{(1 - f(\\theta)) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S)}{k_{B} T}.\n$$\nSubstitute the homogeneous barrier:\n$$\n\\ln\\!\\left(10^{6}\\right) = \\frac{(1 - f(\\theta))}{k_{B} T} \\cdot \\frac{16 \\pi \\gamma^{3}}{3 \\left[ R T c_{eq} (S - 1) \\right]^{2}}.\n$$\nSolve for $S$:\n$$\n\\left[ R T c_{eq} (S - 1) \\right]^{2} = \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)},\n$$\n$$\nS - 1 = \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} },\n$$\nand therefore\n$$\nS = 1 + \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} }.\n$$\n\nFinally, for the specified typical hydrophobic contact angle $\\theta = 100^{\\circ}$ (measured in degrees), the shape factor is\n$$\nf(100^{\\circ}) = \\frac{\\left(2 + \\cos 100^{\\circ}\\right) \\left(1 - \\cos 100^{\\circ}\\right)^{2}}{4}.\n$$\nThus, the supersaturation ratio at which the heterogeneous nucleation rate exceeds the homogeneous rate by six orders of magnitude is\n$$\nS = 1 + \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{\\left(1 - \\frac{\\left(2 + \\cos 100^{\\circ}\\right) \\left(1 - \\cos 100^{\\circ}\\right)^{2}}{4}\\right) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} }.\n$$\nThis is a closed-form analytic expression in terms of $\\gamma$, $T$, $R$, $c_{eq}$, $k_{B}$, and trigonometric functions of $100^{\\circ}$, as required. It is dimensionless because $(R T c_{eq})$ carries units of pressure and the square-root numerator carries units of pressure squared times energy, which are balanced by the $k_{B} T$ energy and the prefactor, yielding a dimensionless $S$.",
            "answer": "$$\\boxed{1+\\frac{1}{R\\,T\\,c_{eq}}\\sqrt{\\frac{\\left(1-\\frac{\\left(2+\\cos(100^{\\circ})\\right)\\left(1-\\cos(100^{\\circ})\\right)^{2}}{4}\\right)\\,16\\pi\\,\\gamma^{3}}{3\\,k_{B}\\,T\\,\\ln\\!\\left(10^{6}\\right)}}}$$"
        },
        {
            "introduction": "Bubble nucleation requires a critical local concentration of dissolved gas, a condition known as supersaturation. This practice connects the rate of an electrochemical reaction (gas production flux) to the resulting supersaturation at the electrode surface using a fundamental mass transport model. By analyzing a scenario with two concurrently evolving gases , you will learn how factors like production flux, diffusivity ($D_i$), and solubility ($H_i$) collectively determine which species reaches its nucleation threshold first, a crucial insight for understanding selectivity and efficiency in multi-product electrochemical systems.",
            "id": "4246888",
            "problem": "An isothermal, planar electrode of area $A$ immersed in water at $T=298\\ \\mathrm{K}$ evolves two gases concurrently: hydrogen ($\\text{H}_2$) as the primary product and oxygen ($\\text{O}_2$) as a parasitic trace product, due to heterogeneous catalysis on mixed sites. The electrolyte is quiescent, and near-electrode transport is well-characterized by a quasi-steady, one-dimensional (1D) stagnant diffusion layer of thickness $\\delta$ adjacent to the electrode. The bulk liquid is initially equilibrated with air. Assume ideal gas behavior and dilute solution with Henry’s law valid for gas solubility.\n\nYou are given:\n- Diffusion coefficients in water: $D_{\\text{H}_2} = 4.5 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $D_{\\text{O}_2} = 2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$.\n- Molar production fluxes at the electrode surface: $j_{\\text{H}_2} = 4.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$, $j_{\\text{O}_2} = 1.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$.\n- Stagnant diffusion layer thickness: $\\delta = 1.00 \\times 10^{-4}\\ \\mathrm{m}$.\n- Henry solubility constants: $H_{\\text{H}_2} = 7.80 \\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$, $H_{\\text{O}_2} = 1.30 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$.\n- Ambient pressure for pure gas reference: $p_{\\mathrm{ref}} = 1.00 \\times 10^{5}\\ \\mathrm{Pa}$.\n- Air partial pressures: $p_{\\text{H}_2,\\mathrm{air}} = 5.0 \\times 10^{-7} \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$, $p_{\\text{O}_2,\\mathrm{air}} = 0.21 \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$.\n\nStarting from fundamental transport and thermodynamic laws, derive the local supersaturation $S_i$ for each gas $i \\in \\{\\text{H}_2,\\text{O}_2\\}$ at the electrode surface under quasi-steady 1D diffusion, where $S_i$ is defined as the ratio of the surface concentration to the saturation concentration at $p_{\\mathrm{ref}}$:\n$$\nS_i \\equiv \\frac{c_{i,s}}{H_i\\,p_{\\mathrm{ref}}}.\n$$\nUse physically justified boundary conditions to connect the imposed molar flux $j_i$ to the near-surface concentration $c_{i,s}$ through diffusion across the stagnant layer.\n\nCompute $S_{\\text{H}_2}$ and $S_{\\text{O}_2}$ numerically. Then, based on the criterion that nucleation of a pure-gas bubble is possible only when $S_i > 1$, predict which gas nucleates first at the electrode.\n\nAnswer specification:\n- Report your final supersaturation values as a row matrix $\\begin{pmatrix}S_{\\text{H}_2}  S_{\\text{O}_2}\\end{pmatrix}$ in the order $(\\text{H}_2, \\text{O}_2)$.\n- Round your numerical entries to three significant figures.\n- Supersaturations are dimensionless; express the final answer without units inside the row matrix.",
            "solution": "The problem is assessed for validity before a solution is attempted.\n\n### Step 1: Extract Givens\nThe following data and definitions are provided in the problem statement:\n- Diffusion coefficients in water: $D_{\\mathrm{H}_2} = 4.5 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $D_{\\mathrm{O}_2} = 2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$.\n- Molar production fluxes at the electrode surface: $j_{\\mathrm{H}_2} = 4.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$, $j_{\\mathrm{O}_2} = 1.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$.\n- Stagnant diffusion layer thickness: $\\delta = 1.00 \\times 10^{-4}\\ \\mathrm{m}$.\n- Henry solubility constants: $H_{\\mathrm{H}_2} = 7.80 \\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$, $H_{\\mathrm{O}_2} = 1.30 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$.\n- Ambient pressure for pure gas reference: $p_{\\mathrm{ref}} = 1.00 \\times 10^{5}\\ \\mathrm{Pa}$.\n- Air partial pressures: $p_{\\mathrm{H}_2,\\mathrm{air}} = 5.0 \\times 10^{-7} \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$, $p_{\\mathrm{O}_2,\\mathrm{air}} = 0.21 \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$.\n- Definition of supersaturation: $S_i \\equiv \\frac{c_{i,s}}{H_i\\,p_{\\mathrm{ref}}}$, where $i \\in \\{\\mathrm{H}_2, \\mathrm{O}_2\\}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the specified criteria:\n- **Scientifically Grounded**: The problem is based on fundamental principles of mass transport (Fick's law of diffusion) and physical chemistry (Henry's law for gas solubility). The concept of a stagnant diffusion layer (Nernst layer) is a standard and valid model in electrochemistry for describing mass transport near an electrode in a quiescent solution.\n- **Well-Posed**: The problem is well-posed. It provides all necessary physical constants, boundary conditions, and geometric parameters required to solve for the surface concentration and supersaturation. The objective is clearly defined, and the governing equations admit a unique solution.\n- **Objective**: The problem is stated using precise, objective scientific language. The provided data are physically realistic for the described system. For example, the diffusion coefficients are of the correct order of magnitude ($ \\approx 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$) for small molecules in water.\n- **Consistency and Completeness**: The problem is self-contained and free from internal contradictions. The units are consistent within the SI system.\n\nThe problem does not exhibit any of the flaws listed in the invalidity criteria. It is a standard transport problem in chemical engineering and electrochemistry.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\nThe transport of each dissolved gas species $i$ through the stagnant diffusion layer is governed by Fick's first law. For a quasi-steady, $1$-dimensional system with the coordinate $x$ normal to the electrode surface (where $x=0$ is the surface), the law is:\n$$j_i = -D_i \\frac{dc_i}{dx}$$\nwhere $j_i$ is the molar flux, $D_i$ is the diffusion coefficient, and $c_i(x)$ is the molar concentration profile of species $i$. Under quasi-steady conditions, the production flux at the electrode surface must equal the diffusive flux away from it, so $j_i$ is constant throughout the layer, $0 \\le x \\le \\delta$.\n\nWe establish two boundary conditions to solve for the concentration profile:\n$1$. At the outer edge of the diffusion layer ($x=\\delta$), the concentration is equal to the bulk concentration, $c_{i, \\text{bulk}}$. The bulk liquid is in equilibrium with air, so its concentration is given by Henry's law:\n$$c_i(\\delta) = c_{i, \\text{bulk}} = H_i p_{i, \\text{air}}$$\n$2$. The concentration at the electrode surface ($x=0$) is denoted as $c_{i,s}$.\n\nBy integrating Fick's law across the stagnant layer from $x=0$ to $x=\\delta$:\n$$\\int_{0}^{\\delta} j_i \\, dx = \\int_{c_{i,s}}^{c_{i, \\text{bulk}}} -D_i \\, dc_i$$\n$$j_i [\\delta - 0] = -D_i [c_{i, \\text{bulk}} - c_{i,s}]$$\n$$j_i \\delta = D_i (c_{i,s} - c_{i, \\text{bulk}})$$\nSolving for the surface concentration, $c_{i,s}$:\n$$c_{i,s} = c_{i, \\text{bulk}} + \\frac{j_i \\delta}{D_i}$$\nSubstituting the expression for the bulk concentration:\n$$c_{i,s} = H_i p_{i, \\text{air}} + \\frac{j_i \\delta}{D_i}$$\nThe problem defines supersaturation $S_i$ as the ratio of the surface concentration $c_{i,s}$ to the saturation concentration at a reference pressure $p_{\\mathrm{ref}}$:\n$$S_i = \\frac{c_{i,s}}{H_i p_{\\mathrm{ref}}}$$\nSubstituting the derived expression for $c_{i,s}$:\n$$S_i = \\frac{H_i p_{i, \\text{air}} + \\frac{j_i \\delta}{D_i}}{H_i p_{\\mathrm{ref}}}$$\nThis can be separated into two terms:\n$$S_i = \\frac{p_{i, \\text{air}}}{p_{\\mathrm{ref}}} + \\frac{j_i \\delta}{D_i H_i p_{\\mathrm{ref}}}$$\nThis final expression allows for the numerical calculation of the supersaturation for both hydrogen ($\\mathrm{H}_2$) and oxygen ($\\mathrm{O}_2$).\n\nFirst, we calculate the partial pressures in air:\n$p_{\\mathrm{H}_2,\\mathrm{air}} = 5.0 \\times 10^{-7} \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa} = 0.05065\\ \\mathrm{Pa}$\n$p_{\\mathrm{O}_2,\\mathrm{air}} = 0.21 \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa} = 21273\\ \\mathrm{Pa}$\n\nNow, we compute $S_{\\mathrm{H}_2}$:\n$$S_{\\mathrm{H}_2} = \\frac{0.05065\\ \\mathrm{Pa}}{1.00 \\times 10^{5}\\ \\mathrm{Pa}} + \\frac{(4.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}) (1.00 \\times 10^{-4}\\ \\mathrm{m})}{(4.5 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}) (7.80 \\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}) (1.00 \\times 10^{5}\\ \\mathrm{Pa})}$$\n$$S_{\\mathrm{H}_2} = 5.065 \\times 10^{-7} + \\frac{4.0 \\times 10^{-9}}{3.51 \\times 10^{-9}}$$\n$$S_{\\mathrm{H}_2} \\approx 5.065 \\times 10^{-7} + 1.1396 = 1.1396005...$$\nRounding to three significant figures, $S_{\\mathrm{H}_2} = 1.14$.\n\nNext, we compute $S_{\\mathrm{O}_2}$:\n$$S_{\\mathrm{O}_2} = \\frac{21273\\ \\mathrm{Pa}}{1.00 \\times 10^{5}\\ \\mathrm{Pa}} + \\frac{(1.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}) (1.00 \\times 10^{-4}\\ \\mathrm{m})}{(2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}) (1.30 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}) (1.00 \\times 10^{5}\\ \\mathrm{Pa})}$$\n$$S_{\\mathrm{O}_2} = 0.21273 + \\frac{1.0 \\times 10^{-9}}{2.6 \\times 10^{-9}}$$\n$$S_{\\mathrm{O}_2} \\approx 0.21273 + 0.384615 = 0.597345...$$\nRounding to three significant figures, $S_{\\mathrm{O}_2} = 0.597$.\n\nThe criterion for gas bubble nucleation is that the supersaturation must exceed unity, $S_i > 1$.\n- For hydrogen: $S_{\\mathrm{H}_2} = 1.14$, which is greater than $1$. Therefore, nucleation of hydrogen bubbles is possible.\n- For oxygen: $S_{\\mathrm{O}_2} = 0.597$, which is less than $1$. Therefore, nucleation of oxygen bubbles is not possible under these conditions; the dissolved oxygen concentration at the surface is below the saturation level required for bubble formation.\n\nBased on this analysis, only hydrogen gas ($\\mathrm{H}_2$) will nucleate at the electrode surface.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.14  0.597 \\end{pmatrix}}$$"
        },
        {
            "introduction": "After nucleating, gas bubbles grow by accumulating more gas from the supersaturated liquid, a process that dynamically alters the local environment. This advanced computational practice guides you through the development of a simulation to model the growth of a gas layer using a moving boundary formulation, where the diffusion equation is solved on a domain that expands over time. Implementing this method  provides hands-on experience with the numerical techniques used to solve coupled transport and interface evolution problems, a powerful skill for predicting and analyzing the dynamic behavior of multiphase systems.",
            "id": "4246901",
            "problem": "Consider a one-dimensional, planar, gas-evolving electrode covered by a growing gas layer (a planar bubble film) of thickness $s(t)$ and area $A$. A dissolved gas species of concentration $c(x,t)$ in the liquid ($0 \\leq x \\leq s(t)$) obeys diffusion with a prescribed molar flux at the electrode. The gas layer grows due to interfacial transfer of dissolved gas from the liquid into the gas phase. Starting from first principles appropriate to computational electrochemistry for gas evolution and bubble dynamics at electrodes, derive and implement a moving-boundary method in which the bubble interface evolves with the local interfacial flux, and verify mass conservation by comparing the integrated production at the electrode to total gas accumulation and the change in dissolved gas in the liquid.\n\nUse the following fundamental base:\n- Fick's law of diffusion: the molar flux in the liquid is $J_{\\ell}(x,t) = -D \\,\\partial c/\\partial x$, where $D$ is the diffusivity.\n- The diffusion equation (partial differential equation (PDE)): $\\partial c/\\partial t = D\\, \\partial^2 c/\\partial x^2$ on $0 \\leq x \\leq s(t)$.\n- The boundary condition at the electrode ($x=0$): $-D \\,\\partial c/\\partial x \\vert_{x=0} = J_e(t)$, where $J_e(t)$ is the externally imposed molar flux due to electrochemical gas production.\n- The boundary condition at the gas-liquid interface ($x=s(t)$): Henry's law, $c(s(t),t) = H \\, P_g$, where $H$ is Henry's law constant (defined such that $c = H P$ in consistent units) and $P_g$ is the gas pressure inside the bubble layer.\n- The Ideal Gas Law (International System of Units (SI)): $P_g \\, V(t) = N_g(t) \\, R \\, T$, where $V(t) = A \\, s(t)$ is the gas volume, $N_g(t)$ is the number of moles of gas in the bubble, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n- Interfacial mass balance relating interface speed to interfacial flux obtained from conservation of moles: $\\mathrm{d}N_g/\\mathrm{d}t = J_{\\mathrm{int}}(t)\\, A$ with $J_{\\mathrm{int}}(t) = -D \\,\\partial c/\\partial x \\vert_{x=s(t)^-}$, and, combining with the Ideal Gas Law and $V(t)=A s(t)$, $\\mathrm{d}s/\\mathrm{d}t = (R T/P_g) J_{\\mathrm{int}}(t)$.\n- Global mass conservation (to be verified numerically): $\\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t = \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right]$, where $N_{\\ell}(t) = A \\int_0^{s(t)} c(x,t)\\,\\mathrm{d}x$ is the total dissolved moles in the liquid domain.\n\nAlgorithmic requirements:\n- Introduce the moving coordinate $y = x/s(t)$, define $u(y,t) = c(x(y,t),t)$ on $y \\in [0,1]$, and derive the transformed PDE that accounts for the moving boundary. Implement a finite-difference method-of-lines discretization in $y$ with explicit time stepping for both $u(y,t)$ and $s(t)$.\n- Enforce the electrode boundary condition via a Neumann condition at $y=0$, and the interfacial boundary condition via a Dirichlet condition at $y=1$. Use the interfacial gradient $\\partial u/\\partial y \\vert_{y=1}$ to compute the interfacial flux and the interface speed $\\mathrm{d}s/\\mathrm{d}t$.\n- Numerically verify global mass conservation by computing the absolute residual $\\left| \\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t - \\left( \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right] \\right) \\right|$, expressed in moles. Use trapezoidal quadrature in $y$ to evaluate $N_{\\ell}(t) = A s(t) \\int_0^1 u(y,t)\\,\\mathrm{d}y$.\n\nPhysical and numerical units:\n- Diffusivity $D$ in $\\mathrm{m}^2/\\mathrm{s}$.\n- Henry's law constant $H$ in $\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$ such that $c = H P$.\n- Gas pressure $P_g$ in $\\mathrm{Pa}$.\n- Temperature $T$ in $\\mathrm{K}$.\n- Area $A$ in $\\mathrm{m}^2$.\n- Electrode molar flux $J_e(t)$ in $\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$.\n- Time $t$ in $\\mathrm{s}$.\n- Concentration $c$ in $\\mathrm{mol}/\\mathrm{m}^3$.\n- The absolute mass conservation residual must be reported in $\\mathrm{mol}$, as a decimal number.\n\nTest suite:\nImplement the program for a constant electrode flux $J_e(t) = J_e$ with the following parameter sets. In all cases, initialize $u(y,0) = c_{\\mathrm{init}}$ uniformly and $s(0) = s_0$. Use a uniform grid in $y$ with $N$ nodes, and explicit time step $\\Delta t$ until final time $t_{\\mathrm{end}}$.\n\n- Case $1$ (general, happy path): $D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$, $J_e = 1\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$, $H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$, $P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$, $T = 298\\,\\mathrm{K}$, $A = 1\\times 10^{-6}\\,\\mathrm{m}^2$, $s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$, $c_{\\mathrm{init}} = H\\,P_g$, $N = 41$, $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$.\n- Case $2$ (boundary condition: zero production): $D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$, $J_e = 0\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$, $H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$, $P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$, $T = 298\\,\\mathrm{K}$, $A = 1\\times 10^{-6}\\,\\mathrm{m}^2$, $s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$, $c_{\\mathrm{init}} = H\\,P_g$, $N = 41$, $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$.\n- Case $3$ (stronger production, higher solubility): $D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$, $J_e = 5\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$, $H = 2\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$, $P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$, $T = 298\\,\\mathrm{K}$, $A = 1\\times 10^{-6}\\,\\mathrm{m}^2$, $s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$, $c_{\\mathrm{init}} = H\\,P_g$, $N = 41$, $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$.\n- Case $4$ (transport-limited, higher pressure): $D = 5\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s}$, $J_e = 2\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$, $H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$, $P_g = 2\\times 10^{5}\\,\\mathrm{Pa}$, $T = 298\\,\\mathrm{K}$, $A = 1\\times 10^{-6}\\,\\mathrm{m}^2$, $s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$, $c_{\\mathrm{init}} = H\\,P_g$, $N = 41$, $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 3\\times 10^{-2}\\,\\mathrm{s}$.\n\nOutput specification:\n- For each case, compute the absolute mass conservation residual in $\\mathrm{mol}$ at $t=t_{\\mathrm{end}}$: $\\left| \\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t - \\left( \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right] \\right) \\right|$.\n- Your program should produce a single line of output containing the residuals for Cases $1$ through $4$ as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is a decimal number in $\\mathrm{mol}$.\n\nImplement the complete solution as a single, runnable program that satisfies the specified execution environment.",
            "solution": "The user wants to solve a one-dimensional moving-boundary problem for gas evolution at an electrode, implement a numerical solution, and verify mass conservation.\n\n### **Step 1: Extract Givens**\n\n*   **Governing Equation:** Diffusion equation $\\partial c/\\partial t = D\\, \\partial^2 c/\\partial x^2$ on the domain $0 \\le x \\le s(t)$.\n*   **Flux Definition:** Fick's law $J_{\\ell}(x,t) = -D \\,\\partial c/\\partial x$.\n*   **Boundary Condition at Electrode ($x=0$):** Neumann condition, $-D \\,\\partial c/\\partial x \\vert_{x=0} = J_e(t)$.\n*   **Boundary Condition at Interface ($x=s(t)$):** Dirichlet condition, $c(s(t),t) = H \\, P_g$ (Henry's Law).\n*   **Interface Evolution:** The interface position $s(t)$ evolves according to $\\mathrm{d}s/\\mathrm{d}t = (R\\,T/P_g)\\, J_{\\mathrm{int}}(t)$, where the interfacial flux is $J_{\\mathrm{int}}(t) = -D \\,\\partial c/\\partial x \\vert_{x=s(t)^-}$.\n*   **Global Mass Conservation:** The verification equation is $\\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t = \\Delta N_g + \\Delta N_{\\ell}$, where $\\Delta N_g = N_g(t_{\\mathrm{end}}) - N_g(0)$ and $\\Delta N_{\\ell} = N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)$.\n*   **State Equations:** $N_g(t) = P_g A s(t) / (R T)$ (Ideal Gas Law for the gas layer) and $N_{\\ell}(t) = A \\int_0^{s(t)} c(x,t)\\,\\mathrm{d}x$ (total dissolved moles).\n*   **Coordinate Transformation:** Use the Landau transformation $y = x/s(t)$ and define $u(y,t) = c(x(y,t),t)$ on the fixed domain $y \\in [0, 1]$.\n*   **Numerical Method:** Finite-difference method-of-lines discretization in $y$ with explicit time stepping. Trapezoidal quadrature for integrals.\n*   **Physical Parameters:** $D$, $J_e(t)$, $H$, $P_g$, $T$, $A$.\n*   **Numerical Parameters:** $N$ (number of nodes), $\\Delta t$ (time step), $t_{\\mathrm{end}}$ (final time).\n*   **Initial Conditions:** $s(0) = s_0$ and $u(y,0) = c_{\\mathrm{init}}$.\n*   **Test Cases:** Four specific sets of parameters are provided.\n\n### **Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** The model is based on fundamental principles of transport phenomena (Fick's law), thermodynamics (Henry's law, Ideal Gas Law), and mass conservation. These are standard in electrochemistry and chemical engineering. The problem is scientifically sound.\n*   **Well-Posed:** The problem provides a PDE with well-defined initial and boundary conditions (a Stefan-like problem), which generally admits a unique solution for a given set of parameters. The numerical approach is specified, leading to a determinable outcome.\n*   **Objective:** The problem is stated using precise mathematical and physical terminology, free of subjectivity.\n*   **Completeness and Consistency:** All required physical constants, initial conditions, boundary conditions, and numerical parameters are provided for each case. There are no contradictions.\n*   **Realism and Feasibility:** The parameter values are within physically plausible ranges for aqueous electrochemical systems. The computational task is intensive but feasible within a reasonable time.\n*   **Structure:** The problem is well-structured, guiding the user from theoretical derivation to numerical implementation and verification.\n\n### **Step 3: Verdict and Action**\n\nThe problem is valid. It is a well-posed, scientifically grounded problem in computational electrochemistry. A complete solution will be provided.\n\n### **Principle-Based Solution Derivation**\n\nThe core of the problem is to solve a diffusion equation on a domain whose boundary is moving. This is a classic moving-boundary problem. The specified Landau transformation is a standard technique to map the changing physical domain $x \\in [0, s(t)]$ onto a fixed computational domain $y \\in [0, 1]$.\n\n**1. Transformation of the Governing PDE**\n\nWe start with the coordinate transformation $y = x/s(t)$ and the concentration definition $u(y,t) = c(x,t)$. We use the chain rule to express the derivatives of $c(x,t)$ in terms of derivatives of $u(y,t)$.\n\nThe partial derivative with respect to time $t$ is:\n$$ \\frac{\\partial u}{\\partial t} = \\frac{\\partial c}{\\partial t} \\frac{\\partial t}{\\partial t} + \\frac{\\partial c}{\\partial x} \\frac{\\partial x}{\\partial t} $$\nSince $x = y s(t)$, we have $\\frac{\\partial x}{\\partial t} = y \\frac{\\mathrm{d}s}{\\mathrm{d}t}$. This gives:\n$$ \\frac{\\partial u}{\\partial t} = \\frac{\\partial c}{\\partial t} + \\frac{\\partial c}{\\partial x} y \\frac{\\mathrm{d}s}{\\mathrm{d}t} $$\nRearranging for $\\partial c/\\partial t$, we get:\n$$ \\frac{\\partial c}{\\partial t} = \\frac{\\partial u}{\\partial t} - y \\frac{\\mathrm{d}s}{\\mathrm{d}t} \\frac{\\partial c}{\\partial x} $$\n\nNext, the spatial derivatives:\n$$ \\frac{\\partial u}{\\partial y} = \\frac{\\partial c}{\\partial x} \\frac{\\partial x}{\\partial y} = \\frac{\\partial c}{\\partial x} s(t) \\implies \\frac{\\partial c}{\\partial x} = \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} $$\n$$ \\frac{\\partial^2 c}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\right) = \\frac{1}{s(t)} \\frac{\\partial}{\\partial y} \\left( \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\right) \\frac{\\partial y}{\\partial x} = \\frac{1}{s(t)^2} \\frac{\\partial^2 u}{\\partial y^2} $$\n\nNow, substitute these expressions back into the original diffusion equation, $\\partial c/\\partial t = D\\, \\partial^2 c/\\partial x^2$:\n$$ \\frac{\\partial u}{\\partial t} - y \\frac{\\mathrm{d}s}{\\mathrm{d}t} \\left( \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\right) = D \\left( \\frac{1}{s(t)^2} \\frac{\\partial^2 u}{\\partial y^2} \\right) $$\nRearranging gives the transformed PDE on the fixed domain $y \\in [0, 1]$:\n$$ \\frac{\\partial u}{\\partial t} = \\frac{D}{s(t)^2} \\frac{\\partial^2 u}{\\partial y^2} + \\frac{y}{s(t)} \\frac{\\mathrm{d}s}{\\mathrm{d}t} \\frac{\\partial u}{\\partial y} $$\nThis is a convection-diffusion equation, where the convective velocity is related to the movement of the boundary.\n\n**2. Transformation of Boundary Conditions**\n\n*   **Electrode at $x=0$ (corresponds to $y=0$):**\n    The condition is $-D \\frac{\\partial c}{\\partial x} \\vert_{x=0} = J_e(t)$. Substituting $\\frac{\\partial c}{\\partial x} = \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y}$:\n    $$ -D \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=0} = J_e(t) \\implies \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=0} = -\\frac{s(t) J_e(t)}{D} $$\n    This is a Neumann boundary condition for $u$ at $y=0$.\n\n*   **Gas-liquid interface at $x=s(t)$ (corresponds to $y=1$):**\n    The condition is $c(s(t),t) = H P_g$. In the transformed system, this becomes:\n    $$ u(1,t) = H P_g $$\n    This is a Dirichlet boundary condition for $u$ at $y=1$.\n\n**3. Interface Velocity Equation**\nThe interface velocity depends on the flux into the interface, $J_{\\mathrm{int}}(t) = -D \\frac{\\partial c}{\\partial x} \\vert_{x=s(t)}$. In transformed coordinates:\n$$ J_{\\mathrm{int}}(t) = -D \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=1} $$\nThe ODE for the interface position $s(t)$ is then:\n$$ \\frac{\\mathrm{d}s}{\\mathrm{d}t} = \\frac{R T}{P_g} J_{\\mathrm{int}}(t) = -\\frac{R T D}{P_g s(t)} \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=1} $$\nThis couples the evolution of the boundary $s(t)$ to the gradient of the concentration field $u(y,t)$ at the boundary.\n\n**4. Numerical Discretization (Method of Lines)**\nWe discretize the spatial domain $y \\in [0,1]$ into $N$ equally spaced nodes, $y_i = i \\Delta y$ for $i=0, 1, \\dots, N-1$, where $\\Delta y = 1/(N-1)$. The functions $u(y,t)$ and $s(t)$ are advanced in time using an explicit Euler scheme.\n\n*   **Spatial Derivatives:** We use second-order finite differences.\n    *   Interior nodes ($1 \\le i \\le N-2$):\n        $$ \\frac{\\partial^2 u}{\\partial y^2} \\bigg\\vert_{y_i} \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta y)^2} $$\n        $$ \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y_i} \\approx \\frac{u_{i+1} - u_{i-1}}{2\\Delta y} $$\n    *   Neumann BC at $y=0$ ($i=0$): We introduce a ghost node $u_{-1}$. The centered difference $\\frac{u_1 - u_{-1}}{2\\Delta y} = -\\frac{s J_e}{D}$ gives $u_{-1} = u_1 + \\frac{2 \\Delta y s J_e}{D}$. Substituting this into the PDE expression for $i=0$ (noting the convection term is zero since $y_0=0$):\n        $$ \\frac{\\mathrm{d}u_0}{\\mathrm{d}t} = \\frac{D}{s^2} \\frac{u_1 - 2u_0 + u_{-1}}{(\\Delta y)^2} = \\frac{D}{s^2} \\frac{u_1 - 2u_0 + u_1 + \\frac{2 \\Delta y s J_e}{D}}{(\\Delta y)^2} = \\frac{2D}{s^2 (\\Delta y)^2}(u_1 - u_0) + \\frac{2J_e}{s \\Delta y} $$\n    *   Gradient at $y=1$ ($i=N-1$): A second-order backward difference is used to calculate the interfacial flux.\n        $$ \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y_{N-1}} \\approx \\frac{3u_{N-1} - 4u_{N-2} + u_{N-3}}{2\\Delta y} $$\n\n*   **System of ODEs for Time Integration:** We obtain a system of coupled ODEs for $s(t)$ and $u_i(t)$ for $i=0, \\dots, N-2$. The value $u_{N-1}$ is fixed by the Dirichlet BC.\n    $$ \\frac{\\mathrm{d}s}{\\mathrm{d}t} = -\\frac{R T D}{P_g s} \\left( \\frac{3u_{N-1} - 4u_{N-2} + u_{N-3}}{2\\Delta y} \\right) $$\n    $$ \\frac{\\mathrm{d}u_0}{\\mathrm{d}t} = \\frac{2D}{s^2 (\\Delta y)^2}(u_1 - u_0) + \\frac{2J_e}{s \\Delta y} $$\n    $$ \\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\frac{D}{s^2}\\left(\\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta y)^2}\\right) + \\frac{y_i}{s}\\frac{\\mathrm{d}s}{\\mathrm{d}t}\\left(\\frac{u_{i+1} - u_{i-1}}{2\\Delta y}\\right) \\quad \\text{for } 1 \\leq i \\leq N-2 $$\n    This system is integrated forward in time using the explicit Euler method with a step size $\\Delta t$.\n\n**5. Mass Conservation Verification**\nAt the end of the simulation ($t=t_{\\mathrm{end}}$), we verify global mass conservation.\n*   **Total Moles Produced at Electrode:** For a constant flux $J_e$, this is $M_{\\text{prod}} = \\int_0^{t_{\\mathrm{end}}} J_e A \\,\\mathrm{d}t = J_e A t_{\\mathrm{end}}$.\n*   **Change in Moles in Gas Phase:** $\\Delta N_g = N_g(t_{\\mathrm{end}}) - N_g(0) = \\frac{P_g A}{R T}(s(t_{\\mathrm{end}}) - s(0))$.\n*   **Change in Moles in Liquid Phase:** $\\Delta N_{\\ell} = N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)$. The total amount at time $t$ is $N_{\\ell}(t) = A \\int_0^{s(t)} c(x,t)\\,\\mathrm{d}x = A s(t) \\int_0^1 u(y,t)\\,\\mathrm{d}y$. The integral is computed numerically using the trapezoidal rule on the discrete values $u_i$:\n    $$ \\int_0^1 u(y,t) \\,\\mathrm{d}y \\approx \\sum_{i=0}^{N-2} \\frac{u_i + u_{i+1}}{2} \\Delta y = \\Delta y \\left( \\frac{u_0+u_{N-1}}{2} + \\sum_{i=1}^{N-2} u_i \\right) $$\n*   **Residual:** The absolute error is calculated as $R_{\\text{abs}} = \\left| M_{\\text{prod}} - (\\Delta N_g + \\Delta N_{\\ell}) \\right|$. This residual quantifies the numerical error in conserving mass over the simulation. For a valid numerical scheme, this value should be small.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    # Universal gas constant in SI units: J / (mol * K) which is equivalent to (Pa * m^3) / (mol * K)\n    R = 8.31446261815324\n\n    test_cases = [\n        # Case 1 (general, happy path)\n        {'D': 2e-9, 'J_e': 1e-6, 'H': 1e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 'c_init_factor': 1.0, 'N': 41, 'dt': 1e-4, 't_end': 2e-2},\n        # Case 2 (boundary condition: zero production)\n        {'D': 2e-9, 'J_e': 0.0, 'H': 1e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 'c_init_factor': 1.0, 'N': 41, 'dt': 1e-4, 't_end': 2e-2},\n        # Case 3 (stronger production, higher solubility)\n        {'D': 2e-9, 'J_e': 5e-6, 'H': 2e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 'c_init_factor': 1.0, 'N': 41, 'dt': 1e-4, 't_end': 2e-2},\n        # Case 4 (transport-limited, higher pressure)\n        {'D': 5e-10, 'J_e': 2e-6, 'H': 1e-5, 'P_g': 2e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 'c_init_factor': 1.0, 'N': 41, 'dt': 1e-4, 't_end': 3e-2},\n    ]\n\n    results = []\n    for params in test_cases:\n        # The problem states c_init = H*P_g for all cases.\n        # This is handled here rather than hardcoding in the test_cases dict.\n        c_init = params['H'] * params['P_g']\n        \n        residual = run_simulation(\n            D=params['D'], J_e=params['J_e'], H=params['H'],\n            P_g=params['P_g'], T=params['T'], A=params['A'],\n            s0=params['s0'], c_init=c_init, N=params['N'],\n            dt=params['dt'], t_end=params['t_end'], R=R\n        )\n        results.append(f\"{residual:.15e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(D, J_e, H, P_g, T, A, s0, c_init, N, dt, t_end, R):\n    \"\"\"\n    Solves the moving boundary problem for a single set of parameters.\n    \"\"\"\n    # --- 1. Initialization ---\n    dy = 1.0 / (N - 1)\n    y = np.linspace(0, 1, N)\n    \n    # State variables\n    s = s0\n    u = np.full(N, c_init)\n    \n    # Dirichlet boundary condition at y=1\n    c_sat = H * P_g\n    u[N - 1] = c_sat\n\n    # Store initial state for mass balance calculation\n    s_initial = s0\n    # Use np.trapz for accurate trapezoidal integration\n    N_l_initial = A * s_initial * np.trapz(u, dx=dy)\n    N_g_initial = P_g * A * s_initial / (R * T)\n\n    # --- 2. Time-stepping loop (Method of Lines with Explicit Euler) ---\n    t = 0.0\n    while t  t_end:\n        # Use a smaller time step if the remaining time is less than dt\n        current_dt = min(dt, t_end - t)\n\n        # --- Calculate derivatives at current time step ---\n        du_dt = np.zeros(N)\n\n        # a) Interface velocity ds/dt\n        # Use 2nd-order backward difference for du/dy at the interface (y=1)\n        du_dy_interface = (3 * u[N - 1] - 4 * u[N - 2] + u[N - 3]) / (2 * dy)\n        J_int = -D / s * du_dy_interface\n        ds_dt = (R * T / P_g) * J_int\n\n        # b) Concentration derivative du/dt at electrode (y=0)\n        # Neumann BC implemented via ghost point method\n        du_dt[0] = (2 * D / (s**2 * dy**2)) * (u[1] - u[0]) + (2 * J_e / (s * dy))\n\n        # c) Concentration derivative du/dt for interior points (1 = i = N-2)\n        # Vectorized calculation for efficiency\n        u_yy_internal = (u[2:] - 2*u[1:-1] + u[:-2]) / (dy**2)\n        u_y_internal = (u[2:] - u[:-2]) / (2 * dy)\n        convective_term = (y[1:-1] / s) * ds_dt * u_y_internal\n        \n        du_dt[1:-1] = (D / s**2) * u_yy_internal + convective_term\n        \n        # d) Concentration at interface (y=1) is fixed (Dirichlet), so du/dt = 0\n        du_dt[N-1] = 0.0\n\n        # --- Update state variables using Explicit Euler ---\n        s = s + current_dt * ds_dt\n        u = u + current_dt * du_dt\n        \n        # Re-enforce Dirichlet BC to prevent numerical drift\n        u[N - 1] = c_sat\n        \n        t += current_dt\n        \n    # --- 3. Final Mass Balance Calculation ---\n    s_final = s\n    u_final = u\n\n    # Total moles produced by the electrode\n    total_produced = J_e * A * t_end\n\n    # Change in moles in the liquid layer\n    N_l_final = A * s_final * np.trapz(u_final, dx=dy)\n    delta_N_l = N_l_final - N_l_initial\n    \n    # Change in moles in the gas phase\n    N_g_final = P_g * A * s_final / (R * T)\n    delta_N_g = N_g_final - N_g_initial\n\n    # Absolute mass conservation residual\n    residual = abs(total_produced - (delta_N_g + delta_N_l))\n    \n    return residual\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}