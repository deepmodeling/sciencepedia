{
    "hands_on_practices": [
        {
            "introduction": "气泡的形成是气体析出过程的第一步。这个练习将引导我们运用经典成核理论 (Classical Nucleation Theory, CNT)，量化比较在液体本体中（均相成核）和在电极表面上（异相成核）形成气泡的难度。通过推导和计算，你将深刻理解为何气体总是在表面优先析出，这是掌握电极-电解质界面现象的关键。",
            "id": "4246852",
            "problem": "一个在水系电解质中析出气体的电极，其表面附近会形成溶解气体的过饱和，其特征由过饱和比 $S \\equiv c/c_{eq}$ 描述，其中 $c$ 是局部溶解气体浓度，$c_{eq}$ 是在环境气体分压下的平衡浓度。使用经典成核理论 (CNT) 的框架，在以下基于物理的假设下，考虑液相中的气泡成核：液-气界面张力为 $\\gamma$，温度为 $T$，电极为平面，核要么是液体内部的完整球体（均相成核），要么是电极表面上的球冠（异相成核），其宏观接触角为 $\\theta$（通过液体测量）。假设线张力可忽略不计，且短程相互作用不改变球冠的几何形状。\n\n从基础热力学和力学出发，将形成半径为 $r$ 的球形气泡核的可逆形成功建模为表面能与克服驱动压差 $\\Delta p(S)$ 所做的机械体积功之和，然后确定均相临界半径 $r^{\\ast}$ 和能垒 $\\Delta G^{\\ast}_{\\mathrm{hom}}(S)$。使用理想溶液理论和亨利定律，将溶解气体的压力驱动力与过饱和度联系起来：$\\Delta p(S) = R T c_{eq} (S-1)$，其中 $R$ 是普适气体常数。对于平坦表面上的异相成核，将核建模为球冠，并通过一个依赖于几何形状的形状因子 $f(\\theta)$ 将其能垒与均相能垒联系起来，该因子源于球冠的表面积和体积与完整球体的表面积和体积之比。\n\n假设均相和异相成核的动力学指前因子相当，因此成核速率之比由能垒差异通过阿伦尼乌斯形式 $J \\propto \\exp(-\\Delta G^{\\ast}/k_{B} T)$ 控制，其中 $k_{B}$ 是玻尔兹曼常数。在相同的 $S$ 和 $T$ 条件下，比较异相和均相成核速率，并确定对于一个典型的疏水电极（$\\theta = 100^{\\circ}$），异相成核速率比均相成核速率高出六个数量级（即 $J_{\\mathrm{het}}/J_{\\mathrm{hom}} = 10^{6}$）时的过饱和比 $S$。将最终的 $S$ 表示为包含 $\\gamma$、$T$、$R$、$c_{eq}$、$k_{B}$ 以及 $100^{\\circ}$ 的三角函数的单个闭合形式解析表达式。$S$ 是无量纲的；最终答案中无需单位。",
            "solution": "我们从在过饱和液体中形成一个半径为 $r$ 的球形气泡的经典可逆功开始。总自由能变化结合了表面能和克服压力驱动力所做的机械功。对于液体内部的球形气泡，\n$$\n\\Delta G(r) = 4 \\pi r^{2} \\gamma - \\frac{4}{3} \\pi r^{3} \\Delta p,\n$$\n其中 $\\gamma$ 是液-气界面张力，$\\Delta p$ 是气泡内相对于远处液体的超额气体压力，它提供了体积驱动力。临界核满足极值条件 $\\frac{d \\Delta G}{d r} = 0$，由此得出\n$$\n\\frac{d \\Delta G}{d r} = 8 \\pi r \\gamma - 4 \\pi r^{2} \\Delta p = 0 \\quad \\Rightarrow \\quad r^{\\ast} = \\frac{2 \\gamma}{\\Delta p}.\n$$\n将 $r^{\\ast}$ 代回 $\\Delta G(r)$ 得到均相成核能垒\n$$\n\\Delta G^{\\ast}_{\\mathrm{hom}} = \\Delta G(r^{\\ast}) = \\frac{16 \\pi \\gamma^{3}}{3 \\, \\Delta p^{2}}.\n$$\n\n接下来，我们使用理想溶液理论和亨利定律将压力驱动力与过饱和度 $S$ 联系起来。对于稀溶解气体，与浓度为 $c$ 的溶液处于扩散平衡的气泡中的气体分压为 $p_{g} = R T c$（这是通过将溶解气体的化学势与气泡内理想气体的化学势相等，并在稀溶液极限下使用亨利定律和理想性假设得出的）。在远场平衡时，$p_{eq} = R T c_{eq}$。过饱和度 $S = c/c_{eq}$ 意味着 $p_{g} = R T S c_{eq}$，因此机械驱动力是相对于平衡态的超额压力，\n$$\n\\Delta p(S) = p_{g} - p_{eq} = R T c_{eq} (S - 1).\n$$\n因此，\n$$\n\\Delta G^{\\ast}_{\\mathrm{hom}}(S) = \\frac{16 \\pi \\gamma^{3}}{3 \\left[ R T c_{eq} (S-1) \\right]^{2}}.\n$$\n\n对于在接触角为 $\\theta$ 的平坦基底上异相成核的球冠形气泡，忽略线张力并假设球冠与均相临界球体具有相同的曲率半径，其能垒会因一个依赖于几何形状的形状因子 $f(\\theta)$ 而降低：\n$$\n\\Delta G^{\\ast}_{\\mathrm{het}}(S,\\theta) = f(\\theta) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S).\n$$\n形状因子 $f(\\theta)$ 来自于球冠的表面项和体积项与完整球体的相应项之比，对于平坦基底上的球冠，其表达式为经过充分验证的\n$$\nf(\\theta) = \\frac{(2 + \\cos\\theta)\\left(1 - \\cos\\theta\\right)^{2}}{4}.\n$$\n注意，对于 $0^{\\circ}  \\theta  180^{\\circ}$，$0  f(\\theta)  1$。\n\n在CNT中，成核速率通常写作 $J = J_{0} \\exp\\!\\left( - \\frac{\\Delta G^{\\ast}}{k_{B} T} \\right)$，其中 $J_{0}$ 是一个动力学指前因子，与指数的敏感性相比，它对能垒的依赖性较弱。为了在相同的 $S$ 和 $T$ 下比较均相和异相成核，通常将指前因子近似为可比的是一种合理且常用的做法，因此速率比主要由能垒差异决定：\n$$\n\\frac{J_{\\mathrm{het}}}{J_{\\mathrm{hom}}} \\approx \\exp\\!\\left( \\frac{\\Delta G^{\\ast}_{\\mathrm{hom}} - \\Delta G^{\\ast}_{\\mathrm{het}}}{k_{B} T} \\right) = \\exp\\!\\left( \\frac{(1 - f(\\theta)) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S)}{k_{B} T} \\right).\n$$\n\n我们施加条件，让异相速率高出六个数量级：\n$$\n\\frac{J_{\\mathrm{het}}}{J_{\\mathrm{hom}}} = 10^{6}.\n$$\n取自然对数，\n$$\n\\ln\\!\\left(10^{6}\\right) = \\frac{(1 - f(\\theta)) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S)}{k_{B} T}.\n$$\n代入均相能垒：\n$$\n\\ln\\!\\left(10^{6}\\right) = \\frac{(1 - f(\\theta))}{k_{B} T} \\cdot \\frac{16 \\pi \\gamma^{3}}{3 \\left[ R T c_{eq} (S - 1) \\right]^{2}}.\n$$\n解出 $S$：\n$$\n\\left[ R T c_{eq} (S - 1) \\right]^{2} = \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)},\n$$\n$$\nS - 1 = \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} },\n$$\n因此\n$$\nS = 1 + \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} }.\n$$\n\n最后，对于指定的典型疏水接触角 $\\theta = 100^{\\circ}$（以度为单位），形状因子为\n$$\nf(100^{\\circ}) = \\frac{\\left(2 + \\cos 100^{\\circ}\\right) \\left(1 - \\cos 100^{\\circ}\\right)^{2}}{4}.\n$$\n因此，异相成核速率超过均相成核速率六个数量级时的过饱和比为\n$$\nS = 1 + \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{\\left(1 - \\frac{\\left(2 + \\cos 100^{\\circ}\\right) \\left(1 - \\cos 100^{\\circ}\\right)^{2}}{4}\\right) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} }.\n$$\n这就是题目所要求的，一个用 $\\gamma$、$T$、$R$、$c_{eq}$、$k_{B}$ 以及 $100^{\\circ}$ 的三角函数表示的闭合形式解析表达式。它是无量纲的，因为 $(R T c_{eq})$ 带有压力的单位，而平方根内的分子带有压力的平方乘以能量的单位，这与 $k_{B} T$ 能量项和前置因子的单位相平衡，最终得到无量纲的 $S$。",
            "answer": "$$\\boxed{1+\\frac{1}{R\\,T\\,c_{eq}}\\sqrt{\\frac{\\left(1-\\frac{\\left(2+\\cos(100^{\\circ})\\right)\\left(1-\\cos(100^{\\circ})\\right)^{2}}{4}\\right)\\,16\\pi\\,\\gamma^{3}}{3\\,k_{B}\\,T\\,\\ln\\!\\left(10^{6}\\right)}}}$$"
        },
        {
            "introduction": "在真实的电化学体系中，往往不止一种气体生成。这个实践将我们从理想的单一气体模型带入更复杂的现实场景，探讨当多种气体（如氢气和氧气）同时在电极表面产生时的竞争行为。通过建立一个基于菲克定律的扩散层模型，你将学会如何计算不同气体的局部过饱和度 $S_i$，并预测哪种气体将首先达到成核条件，这揭示了传质过程在决定成核动力学中的核心作用。",
            "id": "4246888",
            "problem": "一个面积为 $A$ 的等温平面电极浸没在 $T=298\\ \\mathrm{K}$ 的水中，由于混合位点上的多相催化作用，同时放出两种气体：作为主要产物的氢气 ($H_2$) 和作为寄生痕量产物的氧气 ($O_2$)。电解质是静止的，电极附近的输运可以通过紧邻电极的厚度为 $\\delta$ 的准稳态一维 (1D) 静态扩散层很好地表征。主体液体最初与空气平衡。假设理想气体行为和稀溶液，亨利定律对气体溶解度有效。\n\n给定：\n- 在水中的扩散系数：$D_{H_2} = 4.5 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $D_{O_2} = 2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$。\n- 电极表面的摩尔产生通量：$j_{H_2} = 4.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$, $j_{O_2} = 1.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$。\n- 静态扩散层厚度：$\\delta = 1.00 \\times 10^{-4}\\ \\mathrm{m}$。\n- 亨利溶解度常数：$H_{H_2} = 7.80 \\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$, $H_{O_2} = 1.30 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$。\n- 纯气体参考的环境压力：$p_{\\mathrm{ref}} = 1.00 \\times 10^{5}\\ \\mathrm{Pa}$。\n- 空气分压：$p_{H_2,\\mathrm{air}} = 5.0 \\times 10^{-7} \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$, $p_{O_2,\\mathrm{air}} = 0.21 \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$。\n\n从基本的输运和热力学定律出发，推导在准稳态一维扩散条件下，电极表面每种气体 $i \\in \\{H_2,O_2\\}$ 的局部过饱和度 $S_i$，$S_i$ 定义为表面浓度与在 $p_{\\mathrm{ref}}$ 下的饱和浓度之比：\n$$\nS_i \\equiv \\frac{c_{i,s}}{H_i\\,p_{\\mathrm{ref}}}.\n$$\n使用物理上合理的边界条件，通过跨静态层的扩散，将施加的摩尔通量 $j_i$ 与近表面浓度 $c_{i,s}$ 联系起来。\n\n数值计算 $S_{H_2}$ 和 $S_{O_2}$。然后，根据纯气泡成核的判据（只有当 $S_i > 1$ 时才可能），预测哪种气体首先在电极上成核。\n\n答案规格：\n- 以行矩阵 $\\begin{pmatrix}S_{H_2}  S_{O_2}\\end{pmatrix}$ 的形式报告最终的过饱和度值，顺序为 $(H_2,\\ O_2)$。\n- 将您的数值条目四舍五入到三位有效数字。\n- 过饱和度是无量纲的；在行矩阵内表示最终答案时不要带单位。",
            "solution": "在尝试求解之前，评估问题的有效性。\n\n### 步骤 1：提取已知条件\n问题陈述中提供了以下数据和定义：\n- 在水中的扩散系数：$D_{\\mathrm{H}_2} = 4.5 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $D_{\\mathrm{O}_2} = 2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$。\n- 电极表面的摩尔产生通量：$j_{\\mathrm{H}_2} = 4.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$, $j_{\\mathrm{O}_2} = 1.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$。\n- 静态扩散层厚度：$\\delta = 1.00 \\times 10^{-4}\\ \\mathrm{m}$。\n- 亨利溶解度常数：$H_{\\mathrm{H}_2} = 7.80 \\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$, $H_{\\mathrm{O}_2} = 1.30 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$。\n- 纯气体参考的环境压力：$p_{\\mathrm{ref}} = 1.00 \\times 10^{5}\\ \\mathrm{Pa}$。\n- 空气分压：$p_{\\mathrm{H}_2,\\mathrm{air}} = 5.0 \\times 10^{-7} \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$, $p_{\\mathrm{O}_2,\\mathrm{air}} = 0.21 \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$。\n- 过饱和度的定义：$S_i \\equiv \\frac{c_{i,s}}{H_i\\,p_{\\mathrm{ref}}}$, 其中 $i \\in \\{\\mathrm{H}_2, \\mathrm{O}_2\\}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准评估问题：\n- **科学依据**：该问题基于质量输运（菲克扩散定律）和物理化学（亨利气体溶解度定律）的基本原理。静态扩散层（能斯特层）的概念是电化学中描述静止溶液中电极附近质量输运的标准且有效的模型。\n- **适定性**：该问题是适定的。它提供了求解表面浓度和过饱和度所需的所有物理常数、边界条件和几何参数。目标明确，控制方程有唯一解。\n- **客观性**：该问题使用精确、客观的科学语言陈述。所提供的数据对于所描述的系统是物理上真实的。例如，扩散系数对于水中的小分子来说，其数量级是正确的（$ \\approx 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$）。\n- **一致性和完整性**：该问题是自洽的，没有内部矛盾。单位在国际单位制（SI）内是一致的。\n\n该问题没有表现出无效性标准中列出的任何缺陷。它是化学工程和电化学中的一个标准输运问题。\n\n### 步骤 3：结论和行动\n问题有效。将推导解答。\n\n每种溶解气体物质 $i$ 通过静态扩散层的输运由菲克第一定律控制。对于一个准稳态的一维系统，坐标 $x$ 垂直于电极表面（其中 $x=0$ 是表面），该定律为：\n$$j_i = -D_i \\frac{dc_i}{dx}$$\n其中 $j_i$ 是摩尔通量，$D_i$ 是扩散系数，$c_i(x)$ 是物质 $i$ 的摩尔浓度分布。在准稳态条件下，电极表面的产生通量必须等于离开它的扩散通量，因此 $j_i$ 在整个层（$0 \\le x \\le \\delta$）中是恒定的。\n\n我们建立两个边界条件来求解浓度分布：\n$1$. 在扩散层的外边缘 ($x=\\delta$)，浓度等于主体浓度 $c_{i, \\text{bulk}}$。主体液体与空气处于平衡状态，因此其浓度由亨利定律给出：\n$$c_i(\\delta) = c_{i, \\text{bulk}} = H_i p_{i, \\text{air}}$$\n$2$. 电极表面 ($x=0$) 的浓度表示为 $c_{i,s}$。\n\n通过在静态层上从 $x=0$ 到 $x=\\delta$ 积分菲克定律：\n$$\\int_{0}^{\\delta} j_i \\, dx = \\int_{c_{i,s}}^{c_{i, \\text{bulk}}} -D_i \\, dc_i$$\n$$j_i [\\delta - 0] = -D_i [c_{i, \\text{bulk}} - c_{i,s}]$$\n$$j_i \\delta = D_i (c_{i,s} - c_{i, \\text{bulk}})$$\n求解表面浓度 $c_{i,s}$：\n$$c_{i,s} = c_{i, \\text{bulk}} + \\frac{j_i \\delta}{D_i}$$\n代入主体浓度的表达式：\n$$c_{i,s} = H_i p_{i, \\text{air}} + \\frac{j_i \\delta}{D_i}$$\n问题将过饱和度 $S_i$ 定义为表面浓度 $c_{i,s}$ 与参考压力 $p_{\\mathrm{ref}}$ 下的饱和浓度之比：\n$$S_i = \\frac{c_{i,s}}{H_i p_{\\mathrm{ref}}}$$\n代入推导出的 $c_{i,s}$ 表达式：\n$$S_i = \\frac{H_i p_{i, \\text{air}} + \\frac{j_i \\delta}{D_i}}{H_i p_{\\mathrm{ref}}}$$\n这可以分为两项：\n$$S_i = \\frac{p_{i, \\text{air}}}{p_{\\mathrm{ref}}} + \\frac{j_i \\delta}{D_i H_i p_{\\mathrm{ref}}}$$\n这个最终表达式允许对氢气 ($\\mathrm{H}_2$) 和氧气 ($\\mathrm{O}_2$) 的过饱和度进行数值计算。\n\n首先，我们计算空气中的分压：\n$p_{\\mathrm{H}_2,\\mathrm{air}} = 5.0 \\times 10^{-7} \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa} = 0.05065\\ \\mathrm{Pa}$\n$p_{\\mathrm{O}_2,\\mathrm{air}} = 0.21 \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa} = 21273\\ \\mathrm{Pa}$\n\n现在，我们计算 $S_{\\mathrm{H}_2}$：\n$$S_{\\mathrm{H}_2} = \\frac{0.05065\\ \\mathrm{Pa}}{1.00 \\times 10^{5}\\ \\mathrm{Pa}} + \\frac{(4.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}) (1.00 \\times 10^{-4}\\ \\mathrm{m})}{(4.5 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}) (7.80 \\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}) (1.00 \\times 10^{5}\\ \\mathrm{Pa})}$$\n$$S_{\\mathrm{H}_2} = 5.065 \\times 10^{-7} + \\frac{4.0 \\times 10^{-9}}{3.51 \\times 10^{-9}}$$\n$$S_{\\mathrm{H}_2} \\approx 5.065 \\times 10^{-7} + 1.1396 = 1.1396005...$$\n四舍五入到三位有效数字，$S_{\\mathrm{H}_2} = 1.14$。\n\n接下来，我们计算 $S_{\\mathrm{O}_2}$：\n$$S_{\\mathrm{O}_2} = \\frac{21273\\ \\mathrm{Pa}}{1.00 \\times 10^{5}\\ \\mathrm{Pa}} + \\frac{(1.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}) (1.00 \\times 10^{-4}\\ \\mathrm{m})}{(2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}) (1.30 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}) (1.00 \\times 10^{5}\\ \\mathrm{Pa})}$$\n$$S_{\\mathrm{O}_2} = 0.21273 + \\frac{1.0 \\times 10^{-9}}{2.6 \\times 10^{-9}}$$\n$$S_{\\mathrm{O}_2} \\approx 0.21273 + 0.384615 = 0.597345...$$\n四舍五入到三位有效数字，$S_{\\mathrm{O}_2} = 0.597$。\n\n气泡成核的判据是过饱和度必须超过 1，即 $S_i  1$。\n- 对于氢气：$S_{\\mathrm{H}_2} = 1.14$，大于 $1$。因此，氢气泡的成核是可能的。\n- 对于氧气：$S_{\\mathrm{O}_2} = 0.597$，小于 $1$。因此，在这些条件下，氧气泡的成核是不可能的；表面溶解氧的浓度低于气泡形成所需的饱和水平。\n\n基于此分析，只有氢气 ($\\mathrm{H}_2$) 会在电极表面成核。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.14  0.597 \\end{pmatrix}}$$"
        },
        {
            "introduction": "当气泡成核后，它会持续生长，这个动态过程的精确描述需要借助计算模拟。本练习旨在介绍一种处理气泡-液体界面移动问题的强大数值方法，即移动边界法。你将通过坐标变换将一个变化的物理域转换到固定的计算域上，并实施一个有限差分方案来求解耦合的浓度场和界面运动方程，最终通过验证质量守恒来检验模型的准确性，这是计算电化学模拟中的一项核心技能。",
            "id": "4246901",
            "problem": "考虑一个一维平面析气电极，其上覆盖着一个厚度为 $s(t)$、面积为 $A$ 且不断增长的气层（平面气泡膜）。在液体（$0 \\le x \\le s(t)$）中，浓度为 $c(x,t)$ 的溶解气体组分遵循扩散定律，并在电极处具有规定的摩尔通量。气层的增长是由于溶解气体从液相到气相的界面传质。从适用于电极析气和气泡动力学的计算电化学第一性原理出发，推导并实现一种移动边界方法，其中气泡界面随局部界面通量而演化，并通过比较电极上的总产物量与气体的总累积量及液体中溶解气体的变化量来验证质量守恒。\n\n使用以下基本原理：\n- Fick 扩散定律：液体中的摩尔通量为 $J_{\\ell}(x,t) = -D \\,\\partial c/\\partial x$，其中 $D$ 是扩散系数。\n- 扩散方程（偏微分方程，PDE）：在 $0 \\le x \\le s(t)$ 上，$\\partial c/\\partial t = D\\, \\partial^2 c/\\partial x^2$。\n- 电极处的边界条件（$x=0$）：$-D \\,\\partial c/\\partial x \\vert_{x=0} = J_e(t)$，其中 $J_e(t)$ 是由电化学析气产生的外部施加的摩尔通量。\n- 气液界面处的边界条件（$x=s(t)$）：Henry 定律，$c(s(t),t) = H \\, P_g$，其中 $H$ 是 Henry 定律常数（在一致单位下定义为 $c = H P$），$P_g$ 是气泡层内的气体压力。\n- 理想气体定律（国际单位制，SI）：$P_g \\, V(t) = N_g(t) \\, R \\, T$，其中 $V(t) = A \\, s(t)$ 是气体体积，$N_g(t)$ 是气泡中的气体摩尔数，$R$ 是通用气体常数，$T$ 是绝对温度。\n- 界面质量平衡，将界面速度与由摩尔守恒得到的界面通量相关联：$\\mathrm{d}N_g/\\mathrm{d}t = J_{\\mathrm{int}}(t)\\, A$，其中 $J_{\\mathrm{int}}(t) = -D \\,\\partial c/\\partial x \\vert_{x=s(t)^-}$，并与理想气体定律和 $V(t)=A\\,s(t)$ 结合，得到 $\\mathrm{d}s/\\mathrm{d}t = (R\\,T/P_g)\\, J_{\\mathrm{int}}(t)$。\n- 全局质量守恒（需进行数值验证）：$\\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t = \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right]$，其中 $N_{\\ell}(t) = A \\int_0^{s(t)} c(x,t)\\,\\mathrm{d}x$ 是液体区域中溶解的总摩尔数。\n\n算法要求：\n- 引入移动坐标 $y = x/s(t)$，在 $y \\in [0,1]$ 上定义 $u(y,t) = c(x(y,t),t)$，并推导考虑移动边界的变换后偏微分方程。在 $y$ 方向上实现有限差分法（线方法）离散化，并对 $u(y,t)$ 和 $s(t)$ 使用显式时间步进。\n- 通过在 $y=0$ 处的 Neumann 条件施加电极边界条件，并通过在 $y=1$ 处的 Dirichlet 条件施加界面边界条件。使用界面梯度 $\\,\\partial u/\\partial y \\vert_{y=1}$ 计算界面通量和界面速度 $\\mathrm{d}s/\\mathrm{d}t$。\n- 通过计算绝对残差 $\\left| \\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t - \\left( \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right] \\right) \\right|$（以摩尔为单位）来数值验证全局质量守恒。在 $y$ 方向上使用梯形积分法来计算 $N_{\\ell}(t) = A\\, s(t)\\, \\int_0^1 u(y,t)\\,\\mathrm{d}y$。\n\n物理和数值单位：\n- 扩散系数 $D$，单位为 $\\mathrm{m}^2/\\mathrm{s}$。\n- Henry 定律常数 $H$，单位为 $\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$，使得 $c = H\\,P$。\n- 气体压力 $P_g$，单位为 $\\mathrm{Pa}$。\n- 温度 $T$，单位为 $\\mathrm{K}$。\n- 面积 $A$，单位为 $\\mathrm{m}^2$。\n- 电极摩尔通量 $J_e(t)$，单位为 $\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$。\n- 时间 $t$，单位为 $\\mathrm{s}$。\n- 浓度 $c$，单位为 $\\mathrm{mol}/\\mathrm{m}^3$。\n- 绝对质量守恒残差必须以 $\\mathrm{mol}$ 为单位报告，形式为十进制数。\n\n测试套件：\n为恒定电极通量 $J_e(t) = J_e$ 实现程序，并使用以下参数集。在所有情况下，均将 $u(y,0) = c_{\\mathrm{init}}$ 均匀初始化，并设 $s(0) = s_0$。在 $y$ 方向上使用包含 $N$ 个节点的均匀网格，并采用显式时间步长 $\\Delta t$ 直到最终时间 $t_{\\mathrm{end}}$。\n\n- 案例 1（通用，理想路径）：$D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$，$J_e = 1\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$，$H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$，$P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$，$T = 298\\,\\mathrm{K}$，$A = 1\\times 10^{-6}\\,\\mathrm{m}^2$，$s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$，$c_{\\mathrm{init}} = H\\,P_g$，$N = 41$，$\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$，$t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$。\n- 案例 2（边界条件：零产物）：$D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$，$J_e = 0\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$，$H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$，$P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$，$T = 298\\,\\mathrm{K}$，$A = 1\\times 10^{-6}\\,\\mathrm{m}^2$，$s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$，$c_{\\mathrm{init}} = H\\,P_g$，$N = 41$，$\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$，$t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$。\n- 案例 3（更强产物，更高溶解度）：$D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$，$J_e = 5\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$，$H = 2\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$，$P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$，$T = 298\\,\\mathrm{K}$，$A = 1\\times 10^{-6}\\,\\mathrm{m}^2$，$s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$，$c_{\\mathrm{init}} = H\\,P_g$，$N = 41$，$\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$，$t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$。\n- 案例 4（传输受限，更高压力）：$D = 5\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s}$，$J_e = 2\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$，$H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$，$P_g = 2\\times 10^{5}\\,\\mathrm{Pa}$，$T = 298\\,\\mathrm{K}$，$A = 1\\times 10^{-6}\\,\\mathrm{m}^2$，$s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$，$c_{\\mathrm{init}} = H\\,P_g$，$N = 41$，$\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$，$t_{\\mathrm{end}} = 3\\times 10^{-2}\\,\\mathrm{s}$。\n\n输出规格：\n- 对于每个案例，计算在 $t=t_{\\mathrm{end}}$ 时的绝对质量守恒残差（单位：$\\mathrm{mol}$）：$\\left| \\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t - \\left( \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right] \\right) \\right|$。\n- 您的程序应生成单行输出，其中包含案例 1 到 4 的残差，形式为方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是一个以 $\\mathrm{mol}$ 为单位的十进制数。\n\n将完整的解决方案实现为满足指定执行环境的单个可运行程序。",
            "solution": "用户希望解决一个电极析气的一维移动边界问题，实现数值解，并验证质量守恒。\n\n### **步骤 1：提取已知条件**\n\n*   **控制方程：** 扩散方程 $\\partial c/\\partial t = D\\, \\partial^2 c/\\partial x^2$ 在域 $0 \\le x \\le s(t)$ 上。\n*   **通量定义：** Fick 定律 $J_{\\ell}(x,t) = -D \\,\\partial c/\\partial x$。\n*   **电极处的边界条件（$x=0$）：** Neumann 条件，$-D \\,\\partial c/\\partial x \\vert_{x=0} = J_e(t)$。\n*   **界面处的边界条件（$x=s(t)$）：** Dirichlet 条件，$c(s(t),t) = H \\, P_g$ (Henry 定律)。\n*   **界面演化：** 界面位置 $s(t)$ 根据 $\\mathrm{d}s/\\mathrm{d}t = (R\\,T/P_g)\\, J_{\\mathrm{int}}(t)$ 演化，其中界面通量为 $J_{\\mathrm{int}}(t) = -D \\,\\partial c/\\partial x \\vert_{x=s(t)^-}$。\n*   **全局质量守恒：** 验证方程为 $\\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t = \\Delta N_g + \\Delta N_{\\ell}$，其中 $\\Delta N_g = N_g(t_{\\mathrm{end}}) - N_g(0)$ 且 $\\Delta N_{\\ell} = N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)$。\n*   **状态方程：** $N_g(t) = P_g A s(t) / (R T)$（气层的理想气体定律）和 $N_{\\ell}(t) = A \\int_0^{s(t)} c(x,t)\\,\\mathrm{d}x$（溶解的总摩尔数）。\n*   **坐标变换：** 使用 Landau 变换 $y = x/s(t)$ 并在固定域 $y \\in [0,1]$ 上定义 $u(y,t) = c(x(y,t),t)$。\n*   **数值方法：** 在 $y$ 方向上使用有限差分法（线方法）离散化，并采用显式时间步进。使用梯形积分法计算积分。\n*   **物理参数：** $D$, $J_e(t)$, $H$, $P_g$, $T$, $A$。\n*   **数值参数：** $N$（节点数），$\\Delta t$（时间步长），$t_{\\mathrm{end}}$（最终时间）。\n*   **初始条件：** $s(0) = s_0$ 和 $u(y,0) = c_{\\mathrm{init}}$。\n*   **测试案例：** 提供了四组特定的参数集。\n\n### **步骤 2：使用提取的已知条件进行验证**\n\n*   **科学基础：** 该模型基于输运现象（Fick 定律）、热力学（Henry 定律、理想气体定律）和质量守恒的基本原理。这些是电化学和化学工程中的标准理论。该问题在科学上是合理的。\n*   **适定性：** 该问题提供了一个具有明确初始和边界条件的偏微分方程（一个类 Stefan 问题），对于给定的参数集通常有唯一解。数值方法已指定，可以得到确定的结果。\n*   **客观性：** 该问题使用精确的数学和物理术语陈述，不含主观性。\n*   **完整性与一致性：** 为每个案例提供了所有必需的物理常数、初始条件、边界条件和数值参数。没有矛盾之处。\n*   **现实性与可行性：** 参数值在含水电化学体系的物理合理范围内。计算任务量大，但在合理时间内是可行的。\n*   **结构：** 问题结构良好，引导用户从理论推导到数值实现和验证。\n\n### **步骤 3：结论与行动**\n\n该问题是有效的。这是一个计算电化学领域中适定的、有科学依据的问题。将提供一个完整的解决方案。\n\n### **基于原理的求解推导**\n\n问题的核心是在一个边界移动的域上求解扩散方程。这是一个经典的移动边界问题。指定的 Landau 变换是一种标准技术，用于将变化的物理域 $x \\in [0, s(t)]$ 映射到固定的计算域 $y \\in [0, 1]$。\n\n**1. 控制偏微分方程的变换**\n\n我们从坐标变换 $y = x/s(t)$ 和浓度定义 $u(y,t) = c(x,t)$ 开始。我们使用链式法则将 $c(x,t)$ 的导数用 $u(y,t)$ 的导数来表示。\n\n关于时间 $t$ 的偏导数为：\n$$ \\frac{\\partial u}{\\partial t} = \\frac{\\partial c}{\\partial t} \\frac{\\partial t}{\\partial t} + \\frac{\\partial c}{\\partial x} \\frac{\\partial x}{\\partial t} $$\n由于 $x = y s(t)$，我们有 $\\frac{\\partial x}{\\partial t} = y \\frac{\\mathrm{d}s}{\\mathrm{d}t}$。这得到：\n$$ \\frac{\\partial u}{\\partial t} = \\frac{\\partial c}{\\partial t} + \\frac{\\partial c}{\\partial x} y \\frac{\\mathrm{d}s}{\\mathrm{d}t} $$\n对 $\\partial c/\\partial t$ 进行整理，我们得到：\n$$ \\frac{\\partial c}{\\partial t} = \\frac{\\partial u}{\\partial t} - y \\frac{\\mathrm{d}s}{\\mathrm{d}t} \\frac{\\partial c}{\\partial x} $$\n\n接下来，是空间导数：\n$$ \\frac{\\partial u}{\\partial y} = \\frac{\\partial c}{\\partial x} \\frac{\\partial x}{\\partial y} = \\frac{\\partial c}{\\partial x} s(t) \\implies \\frac{\\partial c}{\\partial x} = \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} $$\n$$ \\frac{\\partial^2 c}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\right) = \\frac{1}{s(t)} \\frac{\\partial}{\\partial y} \\left( \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\right) \\frac{\\partial y}{\\partial x} = \\frac{1}{s(t)^2} \\frac{\\partial^2 u}{\\partial y^2} $$\n\n现在，将这些表达式代入原始扩散方程 $\\partial c/\\partial t = D\\, \\partial^2 c/\\partial x^2$：\n$$ \\frac{\\partial u}{\\partial t} - y \\frac{\\mathrm{d}s}{\\mathrm{d}t} \\left( \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\right) = D \\left( \\frac{1}{s(t)^2} \\frac{\\partial^2 u}{\\partial y^2} \\right) $$\n整理后得到在固定域 $y \\in [0, 1]$ 上的变换后偏微分方程：\n$$ \\frac{\\partial u}{\\partial t} = \\frac{D}{s(t)^2} \\frac{\\partial^2 u}{\\partial y^2} + \\frac{y}{s(t)} \\frac{\\mathrm{d}s}{\\mathrm{d}t} \\frac{\\partial u}{\\partial y} $$\n这是一个对流-扩散方程，其中对流速度与边界的移动有关。\n\n**2. 边界条件的变换**\n\n*   **电极处，$x=0$（对应于 $y=0$）：**\n    条件为 $-D \\frac{\\partial c}{\\partial x} \\vert_{x=0} = J_e(t)$。代入 $\\frac{\\partial c}{\\partial x} = \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y}$：\n    $$ -D \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=0} = J_e(t) \\implies \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=0} = -\\frac{s(t) J_e(t)}{D} $$\n    这是 $u$ 在 $y=0$ 处的 Neumann 边界条件。\n\n*   **气液界面处，$x=s(t)$（对应于 $y=1$）：**\n    条件为 $c(s(t),t) = H P_g$。在变换后的系统中，这变为：\n    $$ u(1,t) = H P_g $$\n    这是 $u$ 在 $y=1$ 处的 Dirichlet 边界条件。\n\n**3. 界面速度方程**\n界面速度取决于进入界面的通量，$J_{\\mathrm{int}}(t) = -D \\frac{\\partial c}{\\partial x} \\vert_{x=s(t)}$。在变换后的坐标中：\n$$ J_{\\mathrm{int}}(t) = -D \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=1} $$\n界面位置 $s(t)$ 的常微分方程（ODE）则为：\n$$ \\frac{\\mathrm{d}s}{\\mathrm{d}t} = \\frac{R T}{P_g} J_{\\mathrm{int}}(t) = -\\frac{R T D}{P_g s(t)} \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=1} $$\n这将边界 $s(t)$ 的演化与边界上浓度场 $u(y,t)$ 的梯度耦合起来。\n\n**4. 数值离散化（线方法）**\n我们将空间域 $y \\in [0,1]$ 离散为 $N$ 个等距节点，$y_i = i \\Delta y$，$i=0, 1, \\dots, N-1$，其中 $\\Delta y = 1/(N-1)$。函数 $u(y,t)$ 和 $s(t)$ 使用显式欧拉方案进行时间推进。\n\n*   **空间导数：** 我们使用二阶有限差分。\n    *   内部节点（$1 \\le i \\le N-2$）：\n        $$ \\frac{\\partial^2 u}{\\partial y^2} \\bigg\\vert_{y_i} \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta y)^2} $$\n        $$ \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y_i} \\approx \\frac{u_{i+1} - u_{i-1}}{2\\Delta y} $$\n    *   在 $y=0$ 处的 Neumann 边界条件（$i=0$）：我们引入一个虚拟节点 $u_{-1}$。中心差分 $\\frac{u_1 - u_{-1}}{2\\Delta y} = -\\frac{s J_e}{D}$ 给出 $u_{-1} = u_1 + \\frac{2 \\Delta y s J_e}{D}$。将此代入 $i=0$ 的偏微分方程表达式中（注意由于 $y_0=0$，对流项为零）：\n        $$ \\frac{\\mathrm{d}u_0}{\\mathrm{d}t} = \\frac{D}{s^2} \\frac{u_1 - 2u_0 + u_{-1}}{(\\Delta y)^2} = \\frac{D}{s^2} \\frac{u_1 - 2u_0 + u_1 + \\frac{2 \\Delta y s J_e}{D}}{(\\Delta y)^2} = \\frac{2D}{s^2 (\\Delta y)^2}(u_1 - u_0) + \\frac{2J_e}{s \\Delta y} $$\n    *   在 $y=1$ 处的梯度（$i=N-1$）：使用二阶后向差分来计算界面通量。\n        $$ \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y_{N-1}} \\approx \\frac{3u_{N-1} - 4u_{N-2} + u_{N-3}}{2\\Delta y} $$\n\n*   **用于时间积分的常微分方程组：** 我们得到了一个关于 $s(t)$ 和 $u_i(t)$（$i=0, \\dots, N-2$）的耦合常微分方程组。值 $u_{N-1}$ 由 Dirichlet 边界条件固定。\n    $$ \\frac{\\mathrm{d}s}{\\mathrm{d}t} = -\\frac{R T D}{P_g s} \\left( \\frac{3u_{N-1} - 4u_{N-2} + u_{N-3}}{2\\Delta y} \\right) $$\n    $$ \\frac{\\mathrm{d}u_0}{\\mathrm{d}t} = \\frac{2D}{s^2 (\\Delta y)^2}(u_1 - u_0) + \\frac{2J_e}{s \\Delta y} $$\n    $$ \\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\frac{D}{s^2}\\left(\\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta y)^2}\\right) + \\frac{y_i}{s}\\frac{\\mathrm{d}s}{\\mathrm{d}t}\\left(\\frac{u_{i+1} - u_{i-1}}{2\\Delta y}\\right) \\quad \\text{对于 } 1 \\leq i \\leq N-2 $$\n    该系统使用步长为 $\\Delta t$ 的显式欧拉方法进行时间前向积分。\n\n**5. 质量守恒验证**\n在模拟结束时（$t=t_{\\mathrm{end}}$），我们验证全局质量守恒。\n*   **电极上产生的总摩尔数：** 对于恒定通量 $J_e$，此值为 $M_{\\text{prod}} = \\int_0^{t_{\\mathrm{end}}} J_e A \\,\\mathrm{d}t = J_e A t_{\\mathrm{end}}$。\n*   **气相中的摩尔数变化：** $\\Delta N_g = N_g(t_{\\mathrm{end}}) - N_g(0) = \\frac{P_g A}{R T}(s(t_{\\mathrm{end}}) - s(0))$。\n*   **液相中的摩尔数变化：** $\\Delta N_{\\ell} = N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)$。在时间 $t$ 的总量为 $N_{\\ell}(t) = A \\int_0^{s(t)} c(x,t)\\,\\mathrm{d}x = A s(t) \\int_0^1 u(y,t)\\,\\mathrm{d}y$。该积分使用梯形法则在离散值 $u_i$ 上进行数值计算：\n    $$ \\int_0^1 u(y,t) \\,\\mathrm{d}y \\approx \\sum_{i=0}^{N-2} \\frac{u_i + u_{i+1}}{2} \\Delta y = \\Delta y \\left( \\frac{u_0+u_{N-1}}{2} + \\sum_{i=1}^{N-2} u_i \\right) $$\n*   **残差：** 绝对误差计算为 $R_{\\text{abs}} = \\left| M_{\\text{prod}} - (\\Delta N_g + \\Delta N_{\\ell}) \\right|$。这个残差量化了整个模拟过程中质量守恒的数值误差。对于一个有效的数值方案，这个值应该很小。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    # Universal gas constant in SI units: J / (mol * K) which is equivalent to (Pa * m^3) / (mol * K)\n    R = 8.31446261815324\n\n    test_cases = [\n        # Case 1 (general, happy path)\n        {'D': 2e-9, 'J_e': 1e-6, 'H': 1e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 'c_init_factor': 1.0, 'N': 41, 'dt': 1e-4, 't_end': 2e-2},\n        # Case 2 (boundary condition: zero production)\n        {'D': 2e-9, 'J_e': 0.0, 'H': 1e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 'c_init_factor': 1.0, 'N': 41, 'dt': 1e-4, 't_end': 2e-2},\n        # Case 3 (stronger production, higher solubility)\n        {'D': 2e-9, 'J_e': 5e-6, 'H': 2e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 'c_init_factor': 1.0, 'N': 41, 'dt': 1e-4, 't_end': 2e-2},\n        # Case 4 (transport-limited, higher pressure)\n        {'D': 5e-10, 'J_e': 2e-6, 'H': 1e-5, 'P_g': 2e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 'c_init_factor': 1.0, 'N': 41, 'dt': 1e-4, 't_end': 3e-2},\n    ]\n\n    results = []\n    for params in test_cases:\n        # The problem states c_init = H*P_g for all cases.\n        # This is handled here rather than hardcoding in the test_cases dict.\n        c_init = params['H'] * params['P_g']\n        \n        residual = run_simulation(\n            D=params['D'], J_e=params['J_e'], H=params['H'],\n            P_g=params['P_g'], T=params['T'], A=params['A'],\n            s0=params['s0'], c_init=c_init, N=params['N'],\n            dt=params['dt'], t_end=params['t_end'], R=R\n        )\n        results.append(f\"{residual:.15e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(D, J_e, H, P_g, T, A, s0, c_init, N, dt, t_end, R):\n    \"\"\"\n    Solves the moving boundary problem for a single set of parameters.\n    \"\"\"\n    # --- 1. Initialization ---\n    dy = 1.0 / (N - 1)\n    y = np.linspace(0, 1, N)\n    \n    # State variables\n    s = s0\n    u = np.full(N, c_init)\n    \n    # Dirichlet boundary condition at y=1\n    c_sat = H * P_g\n    u[N - 1] = c_sat\n\n    # Store initial state for mass balance calculation\n    s_initial = s0\n    # Use np.trapz for accurate trapezoidal integration\n    N_l_initial = A * s_initial * np.trapz(u, dx=dy)\n    N_g_initial = P_g * A * s_initial / (R * T)\n\n    # --- 2. Time-stepping loop (Method of Lines with Explicit Euler) ---\n    t = 0.0\n    while t  t_end:\n        # Use a smaller time step if the remaining time is less than dt\n        current_dt = min(dt, t_end - t)\n\n        # --- Calculate derivatives at current time step ---\n        du_dt = np.zeros(N)\n\n        # a) Interface velocity ds/dt\n        # Use 2nd-order backward difference for du/dy at the interface (y=1)\n        du_dy_interface = (3 * u[N - 1] - 4 * u[N - 2] + u[N - 3]) / (2 * dy)\n        J_int = -D / s * du_dy_interface\n        ds_dt = (R * T / P_g) * J_int\n\n        # b) Concentration derivative du/dt at electrode (y=0)\n        # Neumann BC implemented via ghost point method\n        du_dt[0] = (2 * D / (s**2 * dy**2)) * (u[1] - u[0]) + (2 * J_e / (s * dy))\n\n        # c) Concentration derivative du/dt for interior points (1 = i = N-2)\n        # Vectorized calculation for efficiency\n        u_yy_internal = (u[2:] - 2*u[1:-1] + u[:-2]) / (dy**2)\n        u_y_internal = (u[2:] - u[:-2]) / (2 * dy)\n        convective_term = (y[1:-1] / s) * ds_dt * u_y_internal\n        \n        du_dt[1:-1] = (D / s**2) * u_yy_internal + convective_term\n        \n        # d) Concentration at interface (y=1) is fixed (Dirichlet), so du/dt = 0\n        du_dt[N-1] = 0.0\n\n        # --- Update state variables using Explicit Euler ---\n        s = s + current_dt * ds_dt\n        u = u + current_dt * du_dt\n        \n        # Re-enforce Dirichlet BC to prevent numerical drift\n        u[N - 1] = c_sat\n        \n        t += current_dt\n        \n    # --- 3. Final Mass Balance Calculation ---\n    s_final = s\n    u_final = u\n\n    # Total moles produced by the electrode\n    total_produced = J_e * A * t_end\n\n    # Change in moles in the liquid layer\n    N_l_final = A * s_final * np.trapz(u_final, dx=dy)\n    delta_N_l = N_l_final - N_l_initial\n    \n    # Change in moles in the gas phase\n    N_g_final = P_g * A * s_final / (R * T)\n    delta_N_g = N_g_final - N_g_initial\n\n    # Absolute mass conservation residual\n    residual = abs(total_produced - (delta_N_g + delta_N_l))\n    \n    return residual\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}