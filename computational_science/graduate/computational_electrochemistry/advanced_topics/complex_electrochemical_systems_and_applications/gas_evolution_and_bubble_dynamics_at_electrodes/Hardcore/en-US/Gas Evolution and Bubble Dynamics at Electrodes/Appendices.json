{
    "hands_on_practices": [
        {
            "introduction": "Understanding the inception of a gas bubble is the first step in modeling gas evolution. This exercise delves into Classical Nucleation Theory (CNT) to provide a quantitative answer to a fundamental question: why do bubbles form on the electrode surface rather than in the bulk electrolyte? By deriving and comparing the energy barriers for homogeneous and heterogeneous nucleation, you will develop a concrete understanding of the overwhelming energetic preference for surface-based bubble formation, a principle that governs virtually all gas-evolving electrochemical systems .",
            "id": "4246852",
            "problem": "An electrode evolving gas into an aqueous electrolyte develops a supersaturation of dissolved gas near the surface, characterized by the supersaturation ratio $S \\equiv c/c_{eq}$, where $c$ is the local dissolved gas concentration and $c_{eq}$ is the equilibrium concentration at the ambient gas partial pressure. Using the framework of Classical Nucleation Theory (CNT), consider bubble nucleation in the liquid phase under the following physically grounded assumptions: the liquid-gas interfacial tension is $\\gamma$, the temperature is $T$, the electrode is planar, and the nucleus is either a full sphere in the bulk liquid (homogeneous nucleation) or a spherical cap on the electrode surface (heterogeneous nucleation) with macroscopic contact angle $\\theta$ (measured through the liquid). Assume negligible line tension and that short-range interactions do not alter the spherical-cap geometry.\n\nStarting from fundamental thermodynamics and mechanics, model the reversible work of formation of a spherical bubble nucleus of radius $r$ by the sum of surface energy and mechanical volume work against the driving pressure difference $\\Delta p(S)$, and then determine the homogeneous critical radius $r^{\\ast}$ and barrier $\\Delta G^{\\ast}_{\\mathrm{hom}}(S)$. Use ideal solution theory and Henry’s law to relate the pressure driving force to supersaturation for a dissolved gas: $\\Delta p(S) = R T c_{eq} (S-1)$, where $R$ is the universal gas constant. For heterogeneous nucleation on a flat surface, model the nucleus as a spherical cap and relate the barrier to the homogeneous barrier via a geometry-dependent shape factor $f(\\theta)$ that arises from the ratio of the cap’s surface area and volume to those of the full sphere.\n\nLet the kinetic prefactors for homogeneous and heterogeneous nucleation be comparable so that nucleation rate ratios are controlled by the barrier difference through an Arrhenius form $J \\propto \\exp(-\\Delta G^{\\ast}/k_{B} T)$, where $k_{B}$ is the Boltzmann constant. For the same $S$ and $T$, compare the heterogeneous and homogeneous nucleation rates and determine the supersaturation ratio $S$ at which the heterogeneous rate dominates by six orders of magnitude (i.e., $J_{\\mathrm{het}}/J_{\\mathrm{hom}} = 10^{6}$) for a typical hydrophobic electrode with $\\theta = 100^{\\circ}$. Express your final $S$ as a single closed-form analytic expression in terms of $\\gamma$, $T$, $R$, $c_{eq}$, $k_{B}$, and trigonometric functions of $100^{\\circ}$. $S$ is dimensionless; no units are required in the final answer.",
            "solution": "We begin from the classical reversible work of forming a spherical bubble of radius $r$ in a supersaturated liquid. The total free energy change combines the surface energy and the mechanical work against the pressure driving force. For a spherical bubble in the bulk,\n$$\n\\Delta G(r) = 4 \\pi r^{2} \\gamma - \\frac{4}{3} \\pi r^{3} \\Delta p,\n$$\nwhere $\\gamma$ is the liquid-gas interfacial tension and $\\Delta p$ is the excess gas pressure in the bubble relative to the far-field liquid, which provides the volumetric driving force. The critical nucleus satisfies the extremum condition $\\frac{d \\Delta G}{d r} = 0$, which yields\n$$\n\\frac{d \\Delta G}{d r} = 8 \\pi r \\gamma - 4 \\pi r^{2} \\Delta p = 0 \\quad \\Rightarrow \\quad r^{\\ast} = \\frac{2 \\gamma}{\\Delta p}.\n$$\nSubstituting $r^{\\ast}$ back into $\\Delta G(r)$ gives the homogeneous nucleation barrier\n$$\n\\Delta G^{\\ast}_{\\mathrm{hom}} = \\Delta G(r^{\\ast}) = \\frac{16 \\pi \\gamma^{3}}{3 \\, \\Delta p^{2}}.\n$$\n\nNext, we relate the pressure driving force to the supersaturation $S$ using ideal solution theory and Henry’s law. For a dilute dissolved gas, the gas partial pressure in a bubble in diffusive equilibrium with the solution of concentration $c$ is $p_{g} = R T c$ (this follows from equating chemical potentials for the dissolved gas and the ideal gas inside the bubble and using Henry’s law with ideality in the dilute limit). At far-field equilibrium, $p_{eq} = R T c_{eq}$. Supersaturation $S = c/c_{eq}$ implies $p_{g} = R T S c_{eq}$, so the mechanical driving force is the excess pressure relative to the equilibrium state,\n$$\n\\Delta p(S) = p_{g} - p_{eq} = R T c_{eq} (S - 1).\n$$\nTherefore,\n$$\n\\Delta G^{\\ast}_{\\mathrm{hom}}(S) = \\frac{16 \\pi \\gamma^{3}}{3 \\left[ R T c_{eq} (S-1) \\right]^{2}}.\n$$\n\nFor heterogeneous nucleation of a spherical-cap bubble on a flat substrate with contact angle $\\theta$, neglecting line tension and assuming that the cap shares the same curvature radius as the homogeneous critical sphere, the barrier is reduced by a geometry-dependent shape factor $f(\\theta)$:\n$$\n\\Delta G^{\\ast}_{\\mathrm{het}}(S,\\theta) = f(\\theta) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S).\n$$\nThe shape factor $f(\\theta)$ follows from the ratio of the cap’s surface and volume terms to those of a full sphere, and for a spherical cap on a flat substrate is the well-tested expression\n$$\nf(\\theta) = \\frac{(2 + \\cos\\theta)\\left(1 - \\cos\\theta\\right)^{2}}{4}.\n$$\nNote that $0 < f(\\theta) < 1$ for $0^{\\circ} < \\theta < 180^{\\circ}$.\n\nThe nucleation rate in CNT is typically written as $J = J_{0} \\exp\\!\\left( - \\frac{\\Delta G^{\\ast}}{k_{B} T} \\right)$, where $J_{0}$ is a kinetic prefactor that depends weakly on the barrier compared to the exponential sensitivity. For comparing homogeneous and heterogeneous nucleation at the same $S$ and $T$, it is common and justified to approximate the prefactors as comparable, so the rate ratio is dominated by the barrier difference:\n$$\n\\frac{J_{\\mathrm{het}}}{J_{\\mathrm{hom}}} \\approx \\exp\\!\\left( \\frac{\\Delta G^{\\ast}_{\\mathrm{hom}} - \\Delta G^{\\ast}_{\\mathrm{het}}}{k_{B} T} \\right) = \\exp\\!\\left( \\frac{(1 - f(\\theta)) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S)}{k_{B} T} \\right).\n$$\n\nWe impose the condition that the heterogeneous rate dominates by six orders of magnitude:\n$$\n\\frac{J_{\\mathrm{het}}}{J_{\\mathrm{hom}}} = 10^{6}.\n$$\nTaking the natural logarithm,\n$$\n\\ln\\!\\left(10^{6}\\right) = \\frac{(1 - f(\\theta)) \\, \\Delta G^{\\ast}_{\\mathrm{hom}}(S)}{k_{B} T}.\n$$\nSubstitute the homogeneous barrier:\n$$\n\\ln\\!\\left(10^{6}\\right) = \\frac{(1 - f(\\theta))}{k_{B} T} \\cdot \\frac{16 \\pi \\gamma^{3}}{3 \\left[ R T c_{eq} (S - 1) \\right]^{2}}.\n$$\nSolve for $S$:\n$$\n\\left[ R T c_{eq} (S - 1) \\right]^{2} = \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)},\n$$\n$$\nS - 1 = \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} },\n$$\nand therefore\n$$\nS = 1 + \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{(1 - f(\\theta)) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} }.\n$$\n\nFinally, for the specified typical hydrophobic contact angle $\\theta = 100^{\\circ}$ (measured in degrees), the shape factor is\n$$\nf(100^{\\circ}) = \\frac{\\left(2 + \\cos 100^{\\circ}\\right) \\left(1 - \\cos 100^{\\circ}\\right)^{2}}{4}.\n$$\nThus, the supersaturation ratio at which the heterogeneous nucleation rate exceeds the homogeneous rate by six orders of magnitude is\n$$\nS = 1 + \\frac{1}{R T c_{eq}} \\sqrt{ \\frac{\\left(1 - \\frac{\\left(2 + \\cos 100^{\\circ}\\right) \\left(1 - \\cos 100^{\\circ}\\right)^{2}}{4}\\right) \\, 16 \\pi \\gamma^{3}}{3 \\, k_{B} T \\, \\ln\\!\\left(10^{6}\\right)} }.\n$$\nThis is a closed-form analytic expression in terms of $\\gamma$, $T$, $R$, $c_{eq}$, $k_{B}$, and trigonometric functions of $100^{\\circ}$, as required. It is dimensionless because $(R T c_{eq})$ carries units of pressure and the square-root numerator carries units of pressure squared times energy, which are balanced by the $k_{B} T$ energy and the prefactor, yielding a dimensionless $S$.",
            "answer": "$$\\boxed{1+\\frac{1}{R\\,T\\,c_{eq}}\\sqrt{\\frac{\\left(1-\\frac{\\left(2+\\cos(100^{\\circ})\\right)\\left(1-\\cos(100^{\\circ})\\right)^{2}}{4}\\right)\\,16\\pi\\,\\gamma^{3}}{3\\,k_{B}\\,T\\,\\ln\\!\\left(10^{6}\\right)}}}$$"
        },
        {
            "introduction": "Before a bubble can nucleate, a sufficient local supersaturation of dissolved gas must be established near the electrode. This practice bridges the electrochemical reaction at the surface with the physical transport in the electrolyte. Using a foundational stagnant-layer model, you will analyze how the interplay between electrochemical production flux, species-specific diffusivity, and solubility dictates the surface concentration . This problem highlights the critical role of mass transport in creating the necessary thermodynamic driving force for nucleation and explains why, in systems producing multiple gases, one species may nucleate long before another.",
            "id": "4246888",
            "problem": "An isothermal, planar electrode of area $A$ immersed in water at $T=298\\ \\mathrm{K}$ evolves two gases concurrently: hydrogen ($\\text{H}_2$) as the primary product and oxygen ($\\text{O}_2$) as a parasitic trace product, due to heterogeneous catalysis on mixed sites. The electrolyte is quiescent, and near-electrode transport is well-characterized by a quasi-steady, one-dimensional (1D) stagnant diffusion layer of thickness $\\delta$ adjacent to the electrode. The bulk liquid is initially equilibrated with air. Assume ideal gas behavior and dilute solution with Henry’s law valid for gas solubility.\n\nYou are given:\n- Diffusion coefficients in water: $D_{\\text{H}_2} = 4.5 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $D_{\\text{O}_2} = 2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$.\n- Molar production fluxes at the electrode surface: $j_{\\text{H}_2} = 4.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$, $j_{\\text{O}_2} = 1.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$.\n- Stagnant diffusion layer thickness: $\\delta = 1.00 \\times 10^{-4}\\ \\mathrm{m}$.\n- Henry solubility constants: $H_{\\text{H}_2} = 7.80 \\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$, $H_{\\text{O}_2} = 1.30 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$.\n- Ambient pressure for pure gas reference: $p_{\\mathrm{ref}} = 1.00 \\times 10^{5}\\ \\mathrm{Pa}$.\n- Air partial pressures: $p_{\\text{H}_2,\\mathrm{air}} = 5.0 \\times 10^{-7} \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$, $p_{\\text{O}_2,\\mathrm{air}} = 0.21 \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa}$.\n\nStarting from fundamental transport and thermodynamic laws, derive the local supersaturation $S_i$ for each gas $i \\in \\{\\text{H}_2, \\text{O}_2\\}$ at the electrode surface under quasi-steady 1D diffusion, where $S_i$ is defined as the ratio of the surface concentration to the saturation concentration at $p_{\\mathrm{ref}}$:\n$$\nS_i \\equiv \\frac{c_{i,s}}{H_i\\,p_{\\mathrm{ref}}}.\n$$\nUse physically justified boundary conditions to connect the imposed molar flux $j_i$ to the near-surface concentration $c_{i,s}$ through diffusion across the stagnant layer.\n\nCompute $S_{\\text{H}_2}$ and $S_{\\text{O}_2}$ numerically. Then, based on the criterion that nucleation of a pure-gas bubble is possible only when $S_i > 1$, predict which gas nucleates first at the electrode.\n\nAnswer specification:\n- Report your final supersaturation values as a row matrix $\\begin{pmatrix}S_{\\text{H}_2}  S_{\\text{O}_2}\\end{pmatrix}$ in the order ($\\text{H}_2, \\text{O}_2$).\n- Round your numerical entries to three significant figures.\n- Supersaturations are dimensionless; express the final answer without units inside the row matrix.",
            "solution": "The transport of each dissolved gas species $i$ through the stagnant diffusion layer is governed by Fick's first law. For a quasi-steady, $1$-dimensional system with the coordinate $x$ normal to the electrode surface (where $x=0$ is the surface), the law is:\n$$j_i = -D_i \\frac{dc_i}{dx}$$\nwhere $j_i$ is the molar flux, $D_i$ is the diffusion coefficient, and $c_i(x)$ is the molar concentration profile of species $i$. Under quasi-steady conditions, the production flux at the electrode surface must equal the diffusive flux away from it, so $j_i$ is constant throughout the layer, $0 \\le x \\le \\delta$.\n\nWe establish two boundary conditions to solve for the concentration profile:\n$1$. At the outer edge of the diffusion layer ($x=\\delta$), the concentration is equal to the bulk concentration, $c_{i, \\text{bulk}}$. The bulk liquid is in equilibrium with air, so its concentration is given by Henry's law:\n$$c_i(\\delta) = c_{i, \\text{bulk}} = H_i p_{i, \\text{air}}$$\n$2$. The concentration at the electrode surface ($x=0$) is denoted as $c_{i,s}$.\n\nBy integrating Fick's law across the stagnant layer from $x=0$ to $x=\\delta$:\n$$\\int_{0}^{\\delta} j_i \\, dx = \\int_{c_{i,s}}^{c_{i, \\text{bulk}}} -D_i \\, dc_i$$\n$$j_i [\\delta - 0] = -D_i [c_{i, \\text{bulk}} - c_{i,s}]$$\n$$j_i \\delta = D_i (c_{i,s} - c_{i, \\text{bulk}})$$\nSolving for the surface concentration, $c_{i,s}$:\n$$c_{i,s} = c_{i, \\text{bulk}} + \\frac{j_i \\delta}{D_i}$$\nSubstituting the expression for the bulk concentration:\n$$c_{i,s} = H_i p_{i, \\text{air}} + \\frac{j_i \\delta}{D_i}$$\nThe problem defines supersaturation $S_i$ as the ratio of the surface concentration $c_{i,s}$ to the saturation concentration at a reference pressure $p_{\\mathrm{ref}}$:\n$$S_i = \\frac{c_{i,s}}{H_i p_{\\mathrm{ref}}}$$\nSubstituting the derived expression for $c_{i,s}$:\n$$S_i = \\frac{H_i p_{i, \\text{air}} + \\frac{j_i \\delta}{D_i}}{H_i p_{\\mathrm{ref}}}$$\nThis can be separated into two terms:\n$$S_i = \\frac{p_{i, \\text{air}}}{p_{\\mathrm{ref}}} + \\frac{j_i \\delta}{D_i H_i p_{\\mathrm{ref}}}$$\nThis final expression allows for the numerical calculation of the supersaturation for both hydrogen ($\\text{H}_2$) and oxygen ($\\text{O}_2$).\n\nFirst, we calculate the partial pressures in air:\n$p_{\\text{H}_2,\\mathrm{air}} = 5.0 \\times 10^{-7} \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa} = 0.05065\\ \\mathrm{Pa}$\n$p_{\\text{O}_2,\\mathrm{air}} = 0.21 \\times 1.013 \\times 10^{5}\\ \\mathrm{Pa} = 21273\\ \\mathrm{Pa}$\n\nNow, we compute $S_{\\text{H}_2}$:\n$$S_{\\text{H}_2} = \\frac{0.05065\\ \\mathrm{Pa}}{1.00 \\times 10^{5}\\ \\mathrm{Pa}} + \\frac{(4.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}) (1.00 \\times 10^{-4}\\ \\mathrm{m})}{(4.5 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}) (7.80 \\times 10^{-6}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}) (1.00 \\times 10^{5}\\ \\mathrm{Pa})}$$\n$$S_{\\text{H}_2} = 5.065 \\times 10^{-7} + \\frac{4.0 \\times 10^{-9}}{3.51 \\times 10^{-9}}$$\n$$S_{\\text{H}_2} \\approx 5.065 \\times 10^{-7} + 1.1396 = 1.1396005...$$\nRounding to three significant figures, $S_{\\text{H}_2} = 1.14$.\n\nNext, we compute $S_{\\text{O}_2}$:\n$$S_{\\text{O}_2} = \\frac{21273\\ \\mathrm{Pa}}{1.00 \\times 10^{5}\\ \\mathrm{Pa}} + \\frac{(1.0 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}) (1.00 \\times 10^{-4}\\ \\mathrm{m})}{(2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}) (1.30 \\times 10^{-5}\\ \\mathrm{mol\\,m^{-3}\\,Pa^{-1}}) (1.00 \\times 10^{5}\\ \\mathrm{Pa})}$$\n$$S_{\\text{O}_2} = 0.21273 + \\frac{1.0 \\times 10^{-9}}{2.6 \\times 10^{-9}}$$\n$$S_{\\text{O}_2} \\approx 0.21273 + 0.384615 = 0.597345...$$\nRounding to three significant figures, $S_{\\text{O}_2} = 0.597$.\n\nThe criterion for gas bubble nucleation is that the supersaturation must exceed unity, $S_i  1$.\n- For hydrogen: $S_{\\text{H}_2} = 1.14$, which is greater than $1$. Therefore, nucleation of hydrogen bubbles is possible.\n- For oxygen: $S_{\\text{O}_2} = 0.597$, which is less than $1$. Therefore, nucleation of oxygen bubbles is not possible under these conditions; the dissolved oxygen concentration at the surface is below the saturation level required for bubble formation.\n\nBased on this analysis, only hydrogen gas ($\\text{H}_2$) will nucleate at the electrode surface.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.14  0.597 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Moving from the analysis of steady-state conditions to dynamic simulation represents a significant step in computational electrochemistry. This practice tackles the complex challenge of simulating a growing gas layer, which constitutes a moving-boundary problem. You will implement a powerful numerical technique using a coordinate transformation to handle the evolving gas-liquid interface and, most importantly, verify the physical fidelity of your simulation by confirming that it strictly conserves mass . This exercise provides direct experience with the methods required to build robust computational models of bubble growth from first principles.",
            "id": "4246901",
            "problem": "Consider a one-dimensional, planar, gas-evolving electrode covered by a growing gas layer (a planar bubble film) of thickness $s(t)$ and area $A$. A dissolved gas species of concentration $c(x,t)$ in the liquid ($0 \\le x \\le s(t)$) obeys diffusion with a prescribed molar flux at the electrode. The gas layer grows due to interfacial transfer of dissolved gas from the liquid into the gas phase. Starting from first principles appropriate to computational electrochemistry for gas evolution and bubble dynamics at electrodes, derive and implement a moving-boundary method in which the bubble interface evolves with the local interfacial flux, and verify mass conservation by comparing the integrated production at the electrode to total gas accumulation and the change in dissolved gas in the liquid.\n\nUse the following fundamental base:\n- Fick's law of diffusion: the molar flux in the liquid is $J_{\\ell}(x,t) = -D \\,\\partial c/\\partial x$, where $D$ is the diffusivity.\n- The diffusion equation (partial differential equation (PDE)): $\\partial c/\\partial t = D\\, \\partial^2 c/\\partial x^2$ on $0 \\le x \\le s(t)$.\n- The boundary condition at the electrode ($x=0$): $-D \\,\\partial c/\\partial x \\vert_{x=0} = J_e(t)$, where $J_e(t)$ is the externally imposed molar flux due to electrochemical gas production.\n- The boundary condition at the gas-liquid interface ($x=s(t)$): Henry's law, $c(s(t),t) = H \\, P_g$, where $H$ is Henry's law constant (defined such that $c = H P$ in consistent units) and $P_g$ is the gas pressure inside the bubble layer.\n- The Ideal Gas Law (International System of Units (SI)): $P_g \\, V(t) = N_g(t) \\, R \\, T$, where $V(t) = A \\, s(t)$ is the gas volume, $N_g(t)$ is the number of moles of gas in the bubble, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n- Interfacial mass balance relating interface speed to interfacial flux obtained from conservation of moles: $\\mathrm{d}N_g/\\mathrm{d}t = J_{\\mathrm{int}}(t)\\, A$ with $J_{\\mathrm{int}}(t) = -D \\,\\partial c/\\partial x \\vert_{x=s(t)^-}$, and, combining with the Ideal Gas Law and $V(t)=A\\,s(t)$, $\\mathrm{d}s/\\mathrm{d}t = (R\\,T/P_g)\\, J_{\\mathrm{int}}(t)$.\n- Global mass conservation (to be verified numerically): $\\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t = \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right]$, where $N_{\\ell}(t) = A \\int_0^{s(t)} c(x,t)\\,\\mathrm{d}x$ is the total dissolved moles in the liquid domain.\n\nAlgorithmic requirements:\n- Introduce the moving coordinate $y = x/s(t)$, define $u(y,t) = c(x(y,t),t)$ on $y \\in [0,1]$, and derive the transformed PDE that accounts for the moving boundary. Implement a finite-difference method-of-lines discretization in $y$ with explicit time stepping for both $u(y,t)$ and $s(t)$.\n- Enforce the electrode boundary condition via a Neumann condition at $y=0$, and the interfacial boundary condition via a Dirichlet condition at $y=1$. Use the interfacial gradient $\\,\\partial u/\\partial y \\vert_{y=1}$ to compute the interfacial flux and the interface speed $\\mathrm{d}s/\\mathrm{d}t$.\n- Numerically verify global mass conservation by computing the absolute residual $\\left| \\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t - \\left( \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right] \\right) \\right|$, expressed in moles. Use trapezoidal quadrature in $y$ to evaluate $N_{\\ell}(t) = A\\, s(t)\\, \\int_0^1 u(y,t)\\,\\mathrm{d}y$.\n\nPhysical and numerical units:\n- Diffusivity $D$ in $\\mathrm{m}^2/\\mathrm{s}$.\n- Henry's law constant $H$ in $\\mathrm{mol}/(\\mathrm{m}^3\\cdot\\mathrm{Pa})$ such that $c = H\\,P$.\n- Gas pressure $P_g$ in $\\mathrm{Pa}$.\n- Temperature $T$ in $\\mathrm{K}$.\n- Area $A$ in $\\mathrm{m}^2$.\n- Electrode molar flux $J_e(t)$ in $\\mathrm{mol}/(\\mathrm{m}^2\\cdot\\mathrm{s})$.\n- Time $t$ in $\\mathrm{s}$.\n- Concentration $c$ in $\\mathrm{mol}/\\mathrm{m}^3$.\n- The absolute mass conservation residual must be reported in $\\mathrm{mol}$, as a decimal number.\n\nTest suite:\nImplement the program for a constant electrode flux $J_e(t) = J_e$ with the following parameter sets. In all cases, initialize $u(y,0) = c_{\\mathrm{init}}$ uniformly and $s(0) = s_0$. Use a uniform grid in $y$ with $N$ nodes, and explicit time step $\\Delta t$ until final time $t_{\\mathrm{end}}$.\n\n- Case $1$ (general, happy path): $D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$, $J_e = 1\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$, $H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$, $P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$, $T = 298\\,\\mathrm{K}$, $A = 1\\times 10^{-6}\\,\\mathrm{m}^2$, $s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$, $c_{\\mathrm{init}} = H\\,P_g$, $N = 41$, $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$.\n- Case $2$ (boundary condition: zero production): $D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$, $J_e = 0\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$, $H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$, $P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$, $T = 298\\,\\mathrm{K}$, $A = 1\\times 10^{-6}\\,\\mathrm{m}^2$, $s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$, $c_{\\mathrm{init}} = H\\,P_g$, $N = 41$, $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$.\n- Case $3$ (stronger production, higher solubility): $D = 2\\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{s}$, $J_e = 5\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$, $H = 2\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$, $P_g = 1.5\\times 10^{5}\\,\\mathrm{Pa}$, $T = 298\\,\\mathrm{K}$, $A = 1\\times 10^{-6}\\,\\mathrm{m}^2$, $s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$, $c_{\\mathrm{init}} = H\\,P_g$, $N = 41$, $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 2\\times 10^{-2}\\,\\mathrm{s}$.\n- Case $4$ (transport-limited, higher pressure): $D = 5\\times 10^{-10}\\,\\mathrm{m}^2/\\mathrm{s}$, $J_e = 2\\times 10^{-6}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot \\mathrm{s})$, $H = 1\\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^3\\cdot \\mathrm{Pa})$, $P_g = 2\\times 10^{5}\\,\\mathrm{Pa}$, $T = 298\\,\\mathrm{K}$, $A = 1\\times 10^{-6}\\,\\mathrm{m}^2$, $s_0 = 1\\times 10^{-4}\\,\\mathrm{m}$, $c_{\\mathrm{init}} = H\\,P_g$, $N = 41$, $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 3\\times 10^{-2}\\,\\mathrm{s}$.\n\nOutput specification:\n- For each case, compute the absolute mass conservation residual in $\\mathrm{mol}$ at $t=t_{\\mathrm{end}}$: $\\left| \\int_0^{t_{\\mathrm{end}}} J_e(t)\\,A\\,\\mathrm{d}t - \\left( \\left[N_g(t_{\\mathrm{end}}) - N_g(0)\\right] + \\left[N_{\\ell}(t_{\\mathrm{end}}) - N_{\\ell}(0)\\right] \\right) \\right|$.\n- Your program should produce a single line of output containing the residuals for Cases $1$ through $4$ as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is a decimal number in $\\mathrm{mol}$.\n\nImplement the complete solution as a single, runnable program that satisfies the specified execution environment.",
            "solution": "### Derivation of Transformed Equations\n\nTo solve the diffusion equation on a moving domain $x \\in [0, s(t)]$, we use the Landau coordinate transformation. This maps the physical domain to a fixed computational domain $y \\in [0, 1]$ via the relation $y = x/s(t)$. We define the concentration on this new domain as $u(y,t) = c(x(y,t), t)$. The derivatives of $c$ are transformed using the chain rule.\n\nThe time derivative is:\n$$ \\frac{\\partial c}{\\partial t} = \\frac{\\partial u}{\\partial t} - \\frac{\\partial u}{\\partial y} \\frac{\\partial y}{\\partial t} = \\frac{\\partial u}{\\partial t} - \\frac{\\partial u}{\\partial y} \\frac{x}{s(t)^2} \\frac{ds}{dt} = \\frac{\\partial u}{\\partial t} - \\frac{y}{s(t)} \\frac{ds}{dt} \\frac{\\partial u}{\\partial y} $$\n\nThe spatial derivatives are:\n$$ \\frac{\\partial c}{\\partial x} = \\frac{\\partial u}{\\partial y} \\frac{\\partial y}{\\partial x} = \\frac{1}{s(t)} \\frac{\\partial u}{\\partial y} $$\n$$ \\frac{\\partial^2 c}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{s(t)} \\frac{\\partial u}{\\partial y}\\right) = \\frac{1}{s(t)^2} \\frac{\\partial^2 u}{\\partial y^2} $$\n\nSubstituting these into the original diffusion equation, $\\partial c/\\partial t = D\\, \\partial^2 c/\\partial x^2$, yields the transformed partial differential equation (PDE):\n$$ \\frac{\\partial u}{\\partial t} = \\frac{D}{s(t)^2} \\frac{\\partial^2 u}{\\partial y^2} + \\frac{y}{s(t)} \\frac{\\mathrm{d}s}{\\mathrm{d}t} \\frac{\\partial u}{\\partial y} $$\nThis is an advection-diffusion equation on the fixed domain $y \\in [0, 1]$, where the advection term arises from the motion of the boundary.\n\nThe boundary conditions are also transformed:\n1.  **Electrode ($x=0 \\implies y=0$):** The constant flux condition $-D \\frac{\\partial c}{\\partial x}\\vert_{x=0} = J_e(t)$ becomes a Neumann condition for $u$:\n    $$ \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=0} = -\\frac{s(t) J_e(t)}{D} $$\n2.  **Interface ($x=s(t) \\implies y=1$):** The Henry's law condition $c(s(t),t) = H P_g$ becomes a Dirichlet condition for $u$:\n    $$ u(1,t) = H P_g $$\n\nThe velocity of the interface, $\\mathrm{d}s/\\mathrm{d}t$, is determined by the mass flux into it, $J_{\\mathrm{int}}(t) = -D \\frac{\\partial c}{\\partial x}\\vert_{x=s(t)}$. In transformed coordinates, this is:\n$$ \\frac{\\mathrm{d}s}{\\mathrm{d}t} = \\frac{R T}{P_g} J_{\\mathrm{int}}(t) = -\\frac{R T D}{P_g s(t)} \\frac{\\partial u}{\\partial y} \\bigg\\vert_{y=1} $$\n\nThis coupled system, comprising the PDE for $u(y,t)$ and the ODE for $s(t)$, is solved numerically. The following Python code implements a finite-difference method to solve this system using an explicit time-stepping scheme and verifies mass conservation as required. Second-order finite differences are used for spatial derivatives.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    # Universal gas constant in SI units: J / (mol * K) which is equivalent to (Pa * m^3) / (mol * K)\n    R = 8.31446261815324\n\n    test_cases = [\n        # Case 1 (general, happy path)\n        {'D': 2e-9, 'J_e': 1e-6, 'H': 1e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 't_end': 2e-2},\n        # Case 2 (boundary condition: zero production)\n        {'D': 2e-9, 'J_e': 0.0, 'H': 1e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 't_end': 2e-2},\n        # Case 3 (stronger production, higher solubility)\n        {'D': 2e-9, 'J_e': 5e-6, 'H': 2e-5, 'P_g': 1.5e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 't_end': 2e-2},\n        # Case 4 (transport-limited, higher pressure)\n        {'D': 5e-10, 'J_e': 2e-6, 'H': 1e-5, 'P_g': 2e5, 'T': 298.0, 'A': 1e-6,\n         's0': 1e-4, 't_end': 3e-2},\n    ]\n    \n    # Common numerical parameters for all cases\n    N = 41\n    dt = 1e-4\n\n    results = []\n    for params in test_cases:\n        # The problem states c_init = H*P_g for all cases.\n        c_init = params['H'] * params['P_g']\n        \n        residual = run_simulation(\n            D=params['D'], J_e=params['J_e'], H=params['H'],\n            P_g=params['P_g'], T=params['T'], A=params['A'],\n            s0=params['s0'], c_init=c_init, N=N,\n            dt=dt, t_end=params['t_end'], R=R\n        )\n        results.append(f\"{residual:.15e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(D, J_e, H, P_g, T, A, s0, c_init, N, dt, t_end, R):\n    \"\"\"\n    Solves the moving boundary problem for a single set of parameters.\n    \"\"\"\n    # --- 1. Initialization ---\n    dy = 1.0 / (N - 1)\n    y = np.linspace(0, 1, N)\n    \n    # State variables\n    s = s0\n    u = np.full(N, c_init)\n    \n    # Dirichlet boundary condition at y=1\n    c_sat = H * P_g\n    u[N - 1] = c_sat\n\n    # Store initial state for mass balance calculation\n    s_initial = s0\n    # Use np.trapz for accurate trapezoidal integration\n    N_l_initial = A * s_initial * np.trapz(u, dx=dy)\n    N_g_initial = P_g * A * s_initial / (R * T)\n\n    # --- 2. Time-stepping loop (Method of Lines with Explicit Euler) ---\n    t = 0.0\n    while t  t_end:\n        # Use a smaller time step if the remaining time is less than dt\n        current_dt = min(dt, t_end - t)\n\n        # --- Calculate derivatives at current time step ---\n        du_dt = np.zeros(N)\n\n        # a) Interface velocity ds/dt\n        # Use 2nd-order backward difference for du/dy at the interface (y=1)\n        du_dy_interface = (3 * u[N - 1] - 4 * u[N - 2] + u[N - 3]) / (2 * dy)\n        J_int = -D / s * du_dy_interface\n        ds_dt = (R * T / P_g) * J_int\n\n        # b) Concentration derivative du/dt at electrode (y=0)\n        # Neumann BC implemented via ghost point method, resulting in this form\n        du_dt[0] = (2 * D / (s**2 * dy**2)) * (u[1] - u[0]) + (2 * J_e / (s * dy))\n\n        # c) Concentration derivative du/dt for interior points (1 = i = N-2)\n        # Vectorized calculation for efficiency\n        u_yy_internal = (u[2:] - 2*u[1:-1] + u[:-2]) / (dy**2)\n        u_y_internal = (u[2:] - u[:-2]) / (2 * dy)\n        convective_term = (y[1:-1] / s) * ds_dt * u_y_internal\n        \n        du_dt[1:-1] = (D / s**2) * u_yy_internal + convective_term\n        \n        # d) Concentration at interface (y=1) is fixed (Dirichlet), so du/dt = 0\n        du_dt[N-1] = 0.0\n\n        # --- Update state variables using Explicit Euler ---\n        s = s + current_dt * ds_dt\n        u = u + current_dt * du_dt\n        \n        # Re-enforce Dirichlet BC to prevent numerical drift\n        u[N - 1] = c_sat\n        \n        t += current_dt\n        \n    # --- 3. Final Mass Balance Calculation ---\n    s_final = s\n    u_final = u\n\n    # Total moles produced by the electrode\n    total_produced = J_e * A * t_end\n\n    # Change in moles in the liquid layer\n    N_l_final = A * s_final * np.trapz(u_final, dx=dy)\n    delta_N_l = N_l_final - N_l_initial\n    \n    # Change in moles in the gas phase\n    N_g_final = P_g * A * s_final / (R * T)\n    delta_N_g = N_g_final - N_g_initial\n\n    # Absolute mass conservation residual\n    residual = abs(total_produced - (delta_N_g + delta_N_l))\n    \n    return residual\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}