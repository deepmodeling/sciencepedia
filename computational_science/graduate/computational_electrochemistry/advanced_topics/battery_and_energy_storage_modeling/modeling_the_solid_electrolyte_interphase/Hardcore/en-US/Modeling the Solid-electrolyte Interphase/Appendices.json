{
    "hands_on_practices": [
        {
            "introduction": "The electrostatic potential profile across the Solid-Electrolyte Interphase (SEI) is fundamental to understanding ion transport and interfacial charge transfer. This potential landscape is governed by the Poisson equation, which relates the potential $\\phi$ to the spatial distribution of charge density $\\rho(x)$ and the material's dielectric permittivity $\\epsilon(x)$. This exercise  provides hands-on practice in numerically solving the Poisson equation for several realistic SEI models, a foundational skill for simulating electrochemical interfaces.",
            "id": "4253476",
            "problem": "Consider a planar Solid-Electrolyte Interphase (SEI) layer occupying the domain $x\\in[0,L]$. Starting from Maxwell's equations in matter, the relevant relations are $\\nabla\\cdot\\mathbf{D}=\\rho$, $\\mathbf{D}=\\epsilon\\mathbf{E}$, and $\\mathbf{E}=-\\nabla\\phi$, where $\\mathbf{D}$ is the electric displacement field, $\\rho$ is the volumetric charge density, $\\epsilon$ is the spatially varying permittivity, $\\mathbf{E}$ is the electric field, and $\\phi$ is the electrostatic potential. In one dimension (planar geometry), these imply the governing equation $\\frac{d}{dx}\\left(\\epsilon(x)\\frac{d\\phi}{dx}\\right)=-\\rho(x)$ with boundary displacement conditions consistent with Gauss's law at interfaces: $\\mathbf{D}(0)=\\sigma_0$ and $\\mathbf{D}(L)=\\sigma_L$, where $\\sigma_0$ and $\\sigma_L$ are surface charge densities at $x=0$ and $x=L$, respectively. Assume the compatibility condition holds, namely $\\sigma_L-\\sigma_0=\\int_{0}^{L}\\rho(x)\\,dx$.\n\nYour task is to write a complete, runnable program that:\n- Implements a numerical solver of the one-dimensional Poisson equation with spatially varying permittivity $\\epsilon(x)$ and given volumetric charge density $\\rho(x)$ for the SEI film, starting strictly from the fundamental statements above. The solver must compute the potential drop across the film $\\Delta\\phi=\\phi(L)-\\phi(0)$ in volts by constructing the electric displacement $\\mathbf{D}(x)$ from the boundary condition at $x=0$ and enforcing the relation $\\frac{d\\mathbf{D}}{dx}=\\rho(x)$, followed by consistent evaluation of the line integral of the electric field.\n- Uses the vacuum permittivity $\\epsilon_0=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$.\n- Produces answers expressed in volts, each rounded to six decimal places.\n\nImplement your solver using a uniform grid over $[0,L]$ and composite trapezoidal quadrature for all needed integrals. Your program must not read any input; it must internally define and solve the following test suite of four cases. All parameters are physically plausible and self-consistent. In every case, verify internally that the compatibility condition holds to within reasonable numerical tolerance.\n\nTest suite (each case specifies $L$, $\\epsilon(x)$, $\\rho(x)$, $\\sigma_0$, and $\\sigma_L$):\n1. Happy-path case with constant permittivity and constant volumetric charge:\n   - $L=1.0\\times 10^{-8}\\,\\mathrm{m}$,\n   - $\\epsilon(x)=10\\,\\epsilon_0$,\n   - $\\rho(x)=1.0\\times 10^{5}\\,\\mathrm{C/m^3}$,\n   - $\\sigma_0=1.0\\times 10^{-3}\\,\\mathrm{C/m^2}$,\n   - $\\sigma_L=2.0\\times 10^{-3}\\,\\mathrm{C/m^2}$.\n2. Linearly varying permittivity and constant volumetric charge:\n   - $L=2.0\\times 10^{-8}\\,\\mathrm{m}$,\n   - $\\epsilon(x)=\\epsilon_0\\left(5+5\\,\\frac{x}{L}\\right)$,\n   - $\\rho(x)=5.0\\times 10^{4}\\,\\mathrm{C/m^3}$,\n   - $\\sigma_0=0$,\n   - $\\sigma_L=1.0\\times 10^{-3}\\,\\mathrm{C/m^2}$.\n3. Two-layer SEI with piecewise constant permittivity and zero volumetric charge:\n   - $L=1.5\\times 10^{-8}\\,\\mathrm{m}$,\n   - $\\epsilon(x)=\\begin{cases}3\\,\\epsilon_0  \\text{for } 0\\le x\\frac{L}{2},\\\\ 9\\,\\epsilon_0  \\text{for } \\frac{L}{2}\\le x\\le L,\\end{cases}$\n   - $\\rho(x)=0$,\n   - $\\sigma_0=2.0\\times 10^{-4}\\,\\mathrm{C/m^2}$,\n   - $\\sigma_L=2.0\\times 10^{-4}\\,\\mathrm{C/m^2}$.\n4. Constant permittivity and sinusoidal volumetric charge with zero net charge:\n   - $L=1.0\\times 10^{-8}\\,\\mathrm{m}$,\n   - $\\epsilon(x)=7\\,\\epsilon_0$,\n   - $\\rho(x)=1.0\\times 10^{5}\\,\\sin\\!\\left(2\\pi\\,\\frac{x}{L}\\right)\\,\\mathrm{C/m^3}$,\n   - $\\sigma_0=1.0\\times 10^{-4}\\,\\mathrm{C/m^2}$,\n   - $\\sigma_L=1.0\\times 10^{-4}\\,\\mathrm{C/m^2}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being the potential drop $\\Delta\\phi$ in volts for the corresponding case, rounded to six decimal places (for example, $[\\Delta\\phi_1,\\Delta\\phi_2,\\Delta\\phi_3,\\Delta\\phi_4]$).",
            "solution": "The problem requires the numerical solution of the one-dimensional Poisson equation with spatially varying permittivity, $\\frac{d}{dx}\\left(\\epsilon(x)\\frac{d\\phi}{dx}\\right)=-\\rho(x)$, to determine the potential drop $\\Delta\\phi = \\phi(L) - \\phi(0)$ across a domain $x \\in [0,L]$. The solution methodology is derived from first principles of electrostatics as specified.\n\nThe fundamental relations provided are Gauss's law for the electric displacement field $\\mathbf{D}$, $\\nabla\\cdot\\mathbf{D}=\\rho$, the constitutive relation $\\mathbf{D}=\\epsilon\\mathbf{E}$, and the relation between the electric field $\\mathbf{E}$ and the electrostatic potential $\\phi$, $\\mathbf{E}=-\\nabla\\phi$. In the one-dimensional planar geometry under consideration, these vector equations simplify to scalar differential equations.\n\nThe divergence of the displacement field becomes $\\frac{dD}{dx} = \\rho(x)$, where $D(x)$ is the single component of the displacement field vector. The problem provides a boundary condition for the displacement field at one boundary, $D(0) = \\sigma_0$, where $\\sigma_0$ is the surface charge density at $x=0$. We can determine the displacement field $D(x)$ at any point $x$ within the domain by integrating the volumetric charge density $\\rho(x')$ from the boundary at $x'=0$ to the point $x$:\n$$D(x) - D(0) = \\int_{0}^{x} \\frac{dD}{dx'} dx' = \\int_{0}^{x} \\rho(x') dx'$$\nSubstituting the boundary condition $D(0) = \\sigma_0$ yields the explicit expression for the displacement field:\n$$D(x) = \\sigma_0 + \\int_{0}^{x} \\rho(x') dx'$$\nA necessary compatibility condition for the existence of a solution is that the total charge within the volume, $\\int_0^L \\rho(x) dx$, must equal the net charge entering through the boundaries, which is consistent with the given condition $\\sigma_L - \\sigma_0 = \\int_0^L \\rho(x) dx$, where $D(L) = \\sigma_L$.\n\nNext, we relate the displacement field $D(x)$ to the electric field $E(x)$ using the spatially varying permittivity $\\epsilon(x)$:\n$$E(x) = \\frac{D(x)}{\\epsilon(x)}$$\nSubstituting the expression for $D(x)$, we obtain the electric field as a function of position:\n$$E(x) = \\frac{1}{\\epsilon(x)} \\left( \\sigma_0 + \\int_{0}^{x} \\rho(x') dx' \\right)$$\nThe potential drop across the film, $\\Delta\\phi = \\phi(L) - \\phi(0)$, is the quantity to be computed. By the fundamental theorem of calculus, this is related to the electric field $E(x) = -\\frac{d\\phi}{dx}$ by the line integral:\n$$\\Delta\\phi = \\phi(L) - \\phi(0) = \\int_{0}^{L} \\frac{d\\phi}{dx} dx = -\\int_{0}^{L} E(x) dx$$\nCombining the expressions for $E(x)$ and $\\Delta\\phi$, we arrive at the final integral equation for the potential drop:\n$$\\Delta\\phi = -\\int_{0}^{L} \\frac{1}{\\epsilon(x)} \\left( \\sigma_0 + \\int_{0}^{x} \\rho(x') dx' \\right) dx$$\nThis equation forms the basis of our numerical algorithm. The solution involves a nested integration, which will be handled numerically.\n\nThe numerical implementation proceeds as follows:\n1.  The continuous domain $[0,L]$ is discretized into a uniform grid of $N+1$ points, denoted by $x_i = i \\cdot h$ for $i=0, 1, \\dots, N$, where $h = L/N$ is the step size. A sufficiently large value for $N$ is chosen to ensure numerical accuracy.\n2.  The functions $\\rho(x)$ and $\\epsilon(x)$ are evaluated at each grid point $x_i$ to obtain arrays of values $\\rho(x_i)$ and $\\epsilon(x_i)$.\n3.  The inner integral, $I(x_i) = \\int_0^{x_i} \\rho(x') dx'$, is computed for each grid point $x_i$. This is performed using a cumulative composite trapezoidal rule, which efficiently yields the value of the integral from the start of the domain up to each point.\n4.  The displacement field at each grid point is then calculated as $D(x_i) = \\sigma_0 + I(x_i)$.\n5.  The electric field is computed at each grid point using the constitutive relation: $E(x_i) = D(x_i) / \\epsilon(x_i)$.\n6.  Finally, the outer integral, $\\Delta\\phi = -\\int_0^L E(x) dx$, is computed using the composite trapezoidal rule over the array of electric field values $E(x_i)$.\n7.  As a mandatory preliminary step for each case, the compatibility condition $\\int_{0}^{L}\\rho(x)\\,dx = \\sigma_L-\\sigma_0$ is numerically verified to ensure the physical self-consistency of the provided parameters. The value of the vacuum permittivity is taken as $\\epsilon_0=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$.\nThe final result for each test case is rounded to six decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the 1D Poisson equation for four test cases of an SEI layer\n    and prints the potential drop for each case.\n    \"\"\"\n    # Define physical constants\n    EPSILON_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n\n    def solve_case(L, eps_func, rho_func, sigma_0, sigma_L, N=20000):\n        \"\"\"\n        Solves the 1D Poisson equation for a single case.\n\n        This function implements a numerical solver based on the direct integration\n        of Gauss's law in one dimension.\n\n        Args:\n            L (float): Thickness of the SEI layer in meters.\n            eps_func (callable): Function for permittivity epsilon(x, L, e0).\n            rho_func (callable): Function for charge density rho(x, L).\n            sigma_0 (float): Surface charge density at x=0 in C/m^2.\n            sigma_L (float): Surface charge density at x=L in C/m^2.\n            N (int): Number of grid intervals for the numerical integration.\n\n        Returns:\n            float: The potential drop delta_phi = phi(L) - phi(0) in volts.\n        \"\"\"\n        # 1. Set up the uniform spatial grid\n        x_grid = np.linspace(0, L, N + 1)\n\n        # 2. Evaluate rho(x) and epsilon(x) on the grid\n        rho_x = rho_func(x_grid, L)\n        eps_x = eps_func(x_grid, L, EPSILON_0)\n\n        # 3. Verify the compatibility condition numerically\n        # integral from 0 to L of rho(x) dx should equal sigma_L - sigma_0\n        total_charge_density = np.trapz(rho_x, x_grid)\n        surface_charge_diff = sigma_L - sigma_0\n        if not np.isclose(total_charge_density, surface_charge_diff, rtol=1e-6, atol=1e-9):\n            # This check is for robustness; the problem guarantees validity.\n            # In a real scenario, one might raise an error here.\n            # print(f\"Warning: Compatibility condition not met for L={L}. \"\n            #       f\"Integral={total_charge_density}, Diff={surface_charge_diff}\")\n            pass\n\n        # 4. Construct the displacement field D(x)\n        # D(x) = sigma_0 + integral from 0 to x of rho(x') dx'\n        # The cumulative trapezoidal rule is used for the integral.\n        integral_rho_cumulative = cumulative_trapezoid(rho_x, x_grid, initial=0)\n        D_x = sigma_0 + integral_rho_cumulative\n\n        # 5. Construct the electric field E(x)\n        # E(x) = D(x) / epsilon(x)\n        E_x = D_x / eps_x\n\n        # 6. Compute the potential drop delta_phi\n        # delta_phi = - integral from 0 to L of E(x) dx\n        # The trapezoidal rule is used for the final integration.\n        delta_phi = -np.trapz(E_x, x_grid)\n\n        return delta_phi\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Constant permittivity and constant volumetric charge\n        {\n            \"L\": 1.0e-8,\n            \"eps_func\": lambda x, L, e0: np.full_like(x, 10 * e0),\n            \"rho_func\": lambda x, L: np.full_like(x, 1.0e5),\n            \"sigma_0\": 1.0e-3,\n            \"sigma_L\": 2.0e-3,\n        },\n        # Case 2: Linearly varying permittivity and constant volumetric charge\n        {\n            \"L\": 2.0e-8,\n            \"eps_func\": lambda x, L, e0: e0 * (5 + 5 * x / L) if L > 0 else e0 * 5,\n            \"rho_func\": lambda x, L: np.full_like(x, 5.0e4),\n            \"sigma_0\": 0.0,\n            \"sigma_L\": 1.0e-3,\n        },\n        # Case 3: Piecewise constant permittivity and zero volumetric charge\n        {\n            \"L\": 1.5e-8,\n            \"eps_func\": lambda x, L, e0: np.where(x  L / 2, 3 * e0, 9 * e0),\n            \"rho_func\": lambda x, L: np.zeros_like(x),\n            \"sigma_0\": 2.0e-4,\n            \"sigma_L\": 2.0e-4,\n        },\n        # Case 4: Constant permittivity and sinusoidal volumetric charge\n        {\n            \"L\": 1.0e-8,\n            \"eps_func\": lambda x, L, e0: np.full_like(x, 7 * e0),\n            \"rho_func\": lambda x, L: 1.0e5 * np.sin(2 * np.pi * x / L) if L > 0 else np.zeros_like(x),\n            \"sigma_0\": 1.0e-4,\n            \"sigma_L\": 1.0e-4,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_phi = solve_case(\n            L=case[\"L\"],\n            eps_func=case[\"eps_func\"],\n            rho_func=case[\"rho_func\"],\n            sigma_0=case[\"sigma_0\"],\n            sigma_L=case[\"sigma_L\"],\n        )\n        # Round the final answer to six decimal places as required.\n        results.append(round(delta_phi, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After establishing the electrostatic potential profile, the next critical step is to model how mobile ions traverse this layer. Ion transport through the SEI is driven by the combined effects of diffusion from concentration gradients and migration in an electric field, a process described by the Nernst-Planck equation. This practice  focuses on the analytical derivation of the steady-state ionic flux, a cornerstone of transport phenomena that provides a deep, quantitative understanding of the factors controlling SEI resistance.",
            "id": "4253529",
            "problem": "Consider a one-dimensional segment of the Solid-Electrolyte Interphase (SEI) of thickness $L$ separating $x=0$ (near the negative electrode) and $x=L$ (facing the electrolyte). A single ionic species $i$ of charge number $z_i$ and concentration $c_i(x)$ is transported within the SEI under isothermal conditions. Assume the following: (i) no convection, (ii) constant diffusion coefficient $D_i$ and constant electrophoretic mobility $u_i$, (iii) no homogeneous generation or consumption of species within the SEI, and (iv) a uniform electric field resulting from a constant potential drop $\\Delta \\phi = \\phi(L)-\\phi(0)$ across the SEI.\n\nStarting from conservation of mass and the constitutive laws for diffusive transport and linear electrophoretic drift under an electric field, derive the steady-state flux $J_i$ of species $i$ through the SEI. Treat the problem in one spatial dimension and impose the boundary conditions $c_i(0)=c_{i,0}$ and $c_i(L)=c_{i,L}$. Express your final answer for the constant steady-state flux $J_i$ as a closed-form analytic expression in terms of $D_i$, $u_i$, $z_i$, $c_{i,0}$, $c_{i,L}$, $L$, and $\\Delta \\phi$. Your answer must be a single expression; do not include units in the final boxed answer. If you introduce any intermediate variables, eliminate them in the final expression so that only the specified parameters appear. No rounding is required.",
            "solution": "The conservation of mass for species $i$ in a one-dimensional system at steady-state with no homogeneous reactions is given by:\n$$\n\\frac{dJ_i}{dx} = 0\n$$\nThis implies that the total flux $J_i$ is constant for all $x$ in the domain $[0, L]$.\n\nThe total flux $J_i$ is the sum of the diffusive flux ($J_{diff}$) and the drift flux ($J_{drift}$).\nThe diffusive flux is described by Fick's first law:\n$$\nJ_{diff} = -D_i \\frac{dc_i}{dx}\n$$\nThe drift flux is due to the motion of the charged species in the electric field $E$. To ensure the final expression contains $z_i$ as an independent parameter as requested, we define the drift velocity as $v_{drift} = z_i u_i E$. The corresponding drift flux is:\n$$\nJ_{drift} = c_i(x) v_{drift} = c_i(x) z_i u_i E\n$$\nThe problem states a uniform electric field resulting from a constant potential drop $\\Delta \\phi = \\phi(L) - \\phi(0)$ across the thickness $L$. In one dimension, the electric field $E$ is related to the potential $\\phi$ by $E = -\\frac{d\\phi}{dx}$. For a uniform field, this simplifies to:\n$$\nE = -\\frac{\\phi(L) - \\phi(0)}{L - 0} = -\\frac{\\Delta \\phi}{L}\n$$\nSubstituting this into the expression for drift flux gives:\n$$\nJ_{drift} = -c_i(x) \\frac{z_i u_i \\Delta \\phi}{L}\n$$\nCombining the diffusive and drift components yields the Nernst-Planck equation for the total flux $J_i$:\n$$\nJ_i = J_{diff} + J_{drift} = -D_i \\frac{dc_i}{dx} - c_i(x) \\frac{z_i u_i \\Delta \\phi}{L}\n$$\nSince $J_i$ is a constant, this is a first-order linear ordinary differential equation for the concentration profile $c_i(x)$. We rearrange it into standard form $\\frac{dy}{dx} + P(x) y = Q(x)$:\n$$\n\\frac{dc_i}{dx} + \\left(\\frac{z_i u_i \\Delta \\phi}{L D_i}\\right) c_i(x) = -\\frac{J_i}{D_i}\n$$\nThis equation has constant coefficients. Let's define a constant for clarity, $\\alpha$:\n$$\n\\alpha = \\frac{z_i u_i \\Delta \\phi}{L D_i}\n$$\nThe differential equation becomes:\n$$\n\\frac{dc_i}{dx} + \\alpha c_i = -\\frac{J_i}{D_i}\n$$\nThe solution can be found using an integrating factor, $I(x) = \\exp\\left(\\int \\alpha dx\\right) = \\exp(\\alpha x)$. Multiplying the ODE by $I(x)$:\n$$\n\\exp(\\alpha x) \\frac{dc_i}{dx} + \\alpha \\exp(\\alpha x) c_i = -\\frac{J_i}{D_i} \\exp(\\alpha x)\n$$\nThe left side is the derivative of a product:\n$$\n\\frac{d}{dx}\\left(c_i(x) \\exp(\\alpha x)\\right) = -\\frac{J_i}{D_i} \\exp(\\alpha x)\n$$\nIntegrating both sides with respect to $x$:\n$$\nc_i(x) \\exp(\\alpha x) = \\int -\\frac{J_i}{D_i} \\exp(\\alpha x) dx = -\\frac{J_i}{D_i \\alpha} \\exp(\\alpha x) + C\n$$\nwhere $C$ is the constant of integration. Solving for $c_i(x)$:\n$$\nc_i(x) = -\\frac{J_i}{D_i \\alpha} + C \\exp(-\\alpha x)\n$$\nSubstituting the expression for $\\alpha$ back in:\n$$\nc_i(x) = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + C \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{L D_i} x\\right)\n$$\nThis is the general solution for the concentration profile. We now apply the boundary conditions to determine the constants $C$ and $J_i$.\n\nAt $x=0$, $c_i(0) = c_{i,0}$:\n$$\nc_{i,0} = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + C \\exp(0) = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + C\n$$\nSolving for $C$:\n$$\nC = c_{i,0} + \\frac{J_i L}{z_i u_i \\Delta \\phi}\n$$\nAt $x=L$, $c_i(L) = c_{i,L}$. We substitute the expression for $C$ into the general solution and evaluate at $x=L$:\n$$\nc_{i,L} = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + \\left(c_{i,0} + \\frac{J_i L}{z_i u_i \\Delta \\phi}\\right) \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right)\n$$\nNow, we solve this equation for the unknown flux $J_i$. First, we group terms with and without $J_i$:\n$$\nc_{i,L} = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) + \\frac{J_i L}{z_i u_i \\Delta \\phi} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right)\n$$\n$$\nc_{i,L} - c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) = J_i \\left( \\frac{L}{z_i u_i \\Delta \\phi} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - \\frac{L}{z_i u_i \\Delta \\phi} \\right)\n$$\nFactor out the common term on the right side:\n$$\nc_{i,L} - c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) = J_i \\frac{L}{z_i u_i \\Delta \\phi} \\left( \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - 1 \\right)\n$$\nFinally, isolate $J_i$:\n$$\nJ_i = \\frac{z_i u_i \\Delta \\phi}{L} \\frac{ c_{i,L} - c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }{ \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - 1 }\n$$\nTo present the expression in a cleaner form, we can multiply the numerator and denominator of the fraction by $-1$:\n$$\nJ_i = \\frac{z_i u_i \\Delta \\phi}{L} \\frac{ -(c_{i,L} - c_{i,0} \\exp(-\\frac{z_i u_i \\Delta \\phi}{D_i})) }{ -( \\exp(-\\frac{z_i u_i \\Delta \\phi}{D_i}) - 1) } = \\frac{z_i u_i \\Delta \\phi}{L} \\frac{ c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - c_{i,L} }{ 1 - \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }\n$$\nThis final expression provides the steady-state flux $J_i$ in terms of all the specified parameters.",
            "answer": "$$\n\\boxed{\\frac{z_i u_i \\Delta \\phi}{L} \\frac{ c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - c_{i,L} }{ 1 - \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }}\n$$"
        },
        {
            "introduction": "A comprehensive SEI model must ultimately describe its growth, which arises from a complex network of elementary chemical and electrochemical reactions. Microkinetic modeling provides a powerful, bottom-up framework for this, translating a reaction mechanism into a system of ordinary differential equations (ODEs) that track the evolution of surface species. This advanced practice  challenges you to construct and solve a full microkinetic model for SEI formation, integrating concepts of mass-action kinetics, Butler-Volmer electrochemistry, and coverage-dependent reaction barriers to predict the SEI's composition over time.",
            "id": "4253505",
            "problem": "You are tasked with constructing and numerically solving a microkinetic model for the Solid Electrolyte Interphase (SEI) formation in lithium-ion batteries focusing on ethylene carbonate reduction. Starting from fundamental laws and well-tested formulas, derive the system of ordinary differential equations for elementary steps leading to lithium ethylene dicarbonate and lithium carbonate formation, with rate constants dependent on temperature and coverage-induced barrier shifts. Implement the model as a complete, runnable program that computes the time evolution of surface coverages and returns the final steady-state coverages for a specified test suite.\n\nBegin from the following foundations:\n- Mass conservation and site balance: the sum of all surface coverages plus the fraction of free sites equals unity.\n- Mass-action kinetics for adsorption, desorption, and chemical reactions.\n- Arrhenius law for temperature dependence of chemical reaction rates.\n- Butler窶天olmer-type potential dependence for the electron-transfer step.\n\nDefine the following elementary steps on a uniform surface with a single type of site, where a star denotes a surface site:\n1. Ethylene carbonate adsorption and desorption:\n   $$\\mathrm{EC(sol)} + * \\rightleftharpoons \\mathrm{EC*}.$$\n2. One-electron reduction of adsorbed ethylene carbonate:\n   $$\\mathrm{EC*} + e^- \\rightarrow \\mathrm{R*}.$$\n3. Lithium association to the reduced intermediate:\n   $$\\mathrm{R*} + \\mathrm{Li^+} \\rightarrow \\mathrm{I*}.$$\n4. Pathway to lithium ethylene dicarbonate (surface product):\n   $$\\mathrm{I*} + \\mathrm{EC(sol)} \\rightarrow \\mathrm{LEDC*}.$$\n5. Pathway to lithium carbonate (surface product):\n   $$\\mathrm{I*} + \\mathrm{Li^+} \\rightarrow \\mathrm{Li_2CO_3*}.$$\n\nLet the surface coverages be denoted by:\n- $$\\theta_{\\mathrm{EC}}$$ for $$\\mathrm{EC*},$$\n- $$\\theta_{\\mathrm{R}}$$ for $$\\mathrm{R*},$$\n- $$\\theta_{\\mathrm{I}}$$ for $$\\mathrm{I*},$$\n- $$\\theta_{\\mathrm{LEDC}}$$ for $$\\mathrm{LEDC*},$$\n- $$\\theta_{\\mathrm{Li_2CO_3}}$$ for $$\\mathrm{Li_2CO_3*}.$$\n\nDefine the SEI coverage as:\n$$\\theta_{\\mathrm{SEI}} = \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}.$$\nDefine the fraction of free sites by the site balance:\n$$\\theta_* = 1 - \\left(\\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}\\right),$$\nand constrain $$\\theta_* \\ge 0.$$\n\nLet the concentrations in the electrolyte (assumed constant) be:\n- $$C_{\\mathrm{EC}}$$ in $$\\mathrm{mol\\,m^{-3}}$$,\n- $$C_{\\mathrm{Li}}$$ in $$\\mathrm{mol\\,m^{-3}}.$$\n\nDefine temperature in Kelvin as $$T$$ and electrode potential (versus lithium/lithium-ion) as $$E$$ in volts. The elementary step rates are:\n- Adsorption forward rate:\n  $$r_{1,\\mathrm{f}} = k_{1,\\mathrm{f}}(T)\\, C_{\\mathrm{EC}}\\, \\theta_*.$$\n- Adsorption reverse (desorption) rate:\n  $$r_{1,\\mathrm{r}} = k_{1,\\mathrm{r}}(T)\\, \\theta_{\\mathrm{EC}}.$$\n- Electron-transfer reduction rate:\n  $$r_{2} = k_{2}(T,E,\\theta_{\\mathrm{SEI}})\\, \\theta_{\\mathrm{EC}}.$$\n- Lithium association rate:\n  $$r_{3} = k_{3}(T,\\theta_{\\mathrm{SEI}})\\, C_{\\mathrm{Li}}\\, \\theta_{\\mathrm{R}}.$$\n- Lithium ethylene dicarbonate formation rate:\n  $$r_{4} = k_{4}(T,\\theta_{\\mathrm{SEI}})\\, C_{\\mathrm{EC}}\\, \\theta_{\\mathrm{I}}.$$\n- Lithium carbonate formation rate:\n  $$r_{5} = k_{5}(T,\\theta_{\\mathrm{SEI}})\\, C_{\\mathrm{Li}}\\, \\theta_{\\mathrm{I}}.$$\n\nUse Arrhenius law for chemical steps and incorporate coverage-dependent barrier shifts:\n- Adsorption forward:\n  $$k_{1,\\mathrm{f}}(T) = A_{1,\\mathrm{f}}\\, \\exp\\!\\left(-\\frac{E_{a,1,\\mathrm{f}}}{R T}\\right).$$\n- Desorption:\n  $$k_{1,\\mathrm{r}}(T) = A_{1,\\mathrm{r}}\\, \\exp\\!\\left(-\\frac{E_{a,1,\\mathrm{r}}}{R T}\\right).$$\n- Electron transfer with Butler窶天olmer-type dependence and coverage-dependent barrier:\n  $$E_{a,2}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,2,0} + \\gamma_{2}\\, \\theta_{\\mathrm{SEI}},$$\n  $$k_{2}(T,E,\\theta_{\\mathrm{SEI}}) = A_{2}\\, \\exp\\!\\left(-\\frac{E_{a,2}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right)\\, \\exp\\!\\left(-\\frac{\\alpha_{2} F \\left(E - E_{0,2}\\right)}{R T}\\right).$$\n- Lithium association:\n  $$E_{a,3}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,3,0} + \\gamma_{3}\\, \\theta_{\\mathrm{SEI}},$$\n  $$k_{3}(T,\\theta_{\\mathrm{SEI}}) = A_{3}\\, \\exp\\!\\left(-\\frac{E_{a,3}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right).$$\n- Lithium ethylene dicarbonate formation:\n  $$E_{a,4}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,4,0} + \\gamma_{4}\\, \\theta_{\\mathrm{SEI}},$$\n  $$k_{4}(T,\\theta_{\\mathrm{SEI}}) = A_{4}\\, \\exp\\!\\left(-\\frac{E_{a,4}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right).$$\n- Lithium carbonate formation:\n  $$E_{a,5}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,5,0} + \\gamma_{5}\\, \\theta_{\\mathrm{SEI}},$$\n  $$k_{5}(T,\\theta_{\\mathrm{SEI}}) = A_{5}\\, \\exp\\!\\left(-\\frac{E_{a,5}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right).$$\n\nConstants:\n- Universal gas constant $$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}.$$\n- Faraday constant $$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}.$$\n\nParameters (all scientifically plausible and fixed across test cases):\n- Pre-exponential factors and activation energies:\n  $$A_{1,\\mathrm{f}} = 10^{-3}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad E_{a,1,\\mathrm{f}} = 5000\\,\\mathrm{J\\,mol^{-1}}.$$\n  $$A_{1,\\mathrm{r}} = 10^{2}\\,\\mathrm{s^{-1}},\\quad E_{a,1,\\mathrm{r}} = 30000\\,\\mathrm{J\\,mol^{-1}}.$$\n  $$A_{2} = 10^{2}\\,\\mathrm{s^{-1}},\\quad E_{a,2,0} = 50000\\,\\mathrm{J\\,mol^{-1}},\\quad \\alpha_{2} = 0.5,\\quad E_{0,2} = 0.2\\,\\mathrm{V},\\quad \\gamma_{2} = 20000\\,\\mathrm{J\\,mol^{-1}}.$$\n  $$A_{3} = 10^{-3}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad E_{a,3,0} = 20000\\,\\mathrm{J\\,mol^{-1}},\\quad \\gamma_{3} = 5000\\,\\mathrm{J\\,mol^{-1}}.$$\n  $$A_{4} = 10^{0}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad E_{a,4,0} = 25000\\,\\mathrm{J\\,mol^{-1}},\\quad \\gamma_{4} = 10000\\,\\mathrm{J\\,mol^{-1}}.$$\n  $$A_{5} = 10^{0}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad E_{a,5,0} = 28000\\,\\mathrm{J\\,mol^{-1}},\\quad \\gamma_{5} = 15000\\,\\mathrm{J\\,mol^{-1}}.$$\n\nDerive the ordinary differential equations for the coverages by applying the stoichiometry and mass-action rates:\n- $$\\frac{d\\theta_{\\mathrm{EC}}}{dt} = r_{1,\\mathrm{f}} - r_{1,\\mathrm{r}} - r_{2}.$$\n- $$\\frac{d\\theta_{\\mathrm{R}}}{dt} = r_{2} - r_{3}.$$\n- $$\\frac{d\\theta_{\\mathrm{I}}}{dt} = r_{3} - r_{4} - r_{5}.$$\n- $$\\frac{d\\theta_{\\mathrm{LEDC}}}{dt} = r_{4}.$$\n- $$\\frac{d\\theta_{\\mathrm{Li_2CO_3}}}{dt} = r_{5}.$$\n\nNumerically integrate the system from $$t=0\\,\\mathrm{s}$$ to $$t=t_{\\mathrm{end}}=1000\\,\\mathrm{s}$$. Enforce $$\\theta_* \\ge 0$$ in the simulation by taking $$\\theta_* = \\max\\!\\left(0, 1 - \\left(\\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}\\right)\\right).$$ Ensure all coverages remain within $$[0,1]$$ by clipping the final values after integration. The output quantities are the final surface coverages $$\\theta_{\\mathrm{LEDC}}(t_{\\mathrm{end}})$$ and $$\\theta_{\\mathrm{Li_2CO_3}}(t_{\\mathrm{end}})$$ (dimensionless, unitless quantities). Round each to three decimal places.\n\nTest suite (provide all values in the indicated units):\n- Case $$1$$ (general case): $$T=298\\,\\mathrm{K},\\ E=-0.5\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$$ with initial coverages $$\\theta_{\\mathrm{EC}}(0)=0,\\ \\theta_{\\mathrm{R}}(0)=0,\\ \\theta_{\\mathrm{I}}(0)=0,\\ \\theta_{\\mathrm{LEDC}}(0)=0,\\ \\theta_{\\mathrm{Li_2CO_3}}(0)=0.$$\n- Case $$2$$ (low temperature): $$T=250\\,\\mathrm{K},\\ E=-0.5\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$$ with the same initial coverages as Case $$1.$$\n- Case $$3$$ (less reducing potential): $$T=298\\,\\mathrm{K},\\ E=-0.1\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$$ with the same initial coverages as Case $$1.$$\n- Case $$4$$ (pre-passivated surface): $$T=298\\,\\mathrm{K},\\ E=-0.5\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$$ with initial coverages $$\\theta_{\\mathrm{EC}}(0)=0,\\ \\theta_{\\mathrm{R}}(0)=0,\\ \\theta_{\\mathrm{I}}(0)=0,\\ \\theta_{\\mathrm{LEDC}}(0)=0.2,\\ \\theta_{\\mathrm{Li_2CO_3}}(0)=0.2.$$\n- Case $$5$$ (strongly reducing potential): $$T=298\\,\\mathrm{K},\\ E=-1.0\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$$ with the same initial coverages as Case $$1.$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of two floats $$[\\theta_{\\mathrm{LEDC}}(t_{\\mathrm{end}}), \\theta_{\\mathrm{Li_2CO_3}}(t_{\\mathrm{end}})]$$ rounded to three decimal places. For example:\n$$\\left[ [x_{1}, y_{1}], [x_{2}, y_{2}], [x_{3}, y_{3}], [x_{4}, y_{4}], [x_{5}, y_{5}] \\right]$$\nwith each $$x_{i}$$ and $$y_{i}$$ expressed as dimensionless floats rounded to three decimal places.",
            "solution": "We begin from mass conservation and fundamental kinetic laws. The Solid Electrolyte Interphase (SEI) occupies surface sites that decrease the availability of free sites for adsorption. We model a single-site surface with site conservation. The total coverage must satisfy:\n$$\\theta_* + \\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}} = 1.$$\nTherefore,\n$$\\theta_* = 1 - \\left(\\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}\\right),$$\nand we enforce $$\\theta_* \\ge 0$$ throughout the evolution by taking $$\\theta_* = \\max\\!\\left(0, \\cdots \\right).$$\n\nFor the rates, we apply mass-action kinetics with Arrhenius temperature dependence and coverage-modulated barriers. Adsorption from solution (forward) is first-order in solution concentration and first-order in free sites:\n$$r_{1,\\mathrm{f}} = k_{1,\\mathrm{f}}(T)\\, C_{\\mathrm{EC}}\\, \\theta_*,$$\nwith\n$$k_{1,\\mathrm{f}}(T) = A_{1,\\mathrm{f}}\\, \\exp\\!\\left(-\\frac{E_{a,1,\\mathrm{f}}}{R T}\\right).$$\nDesorption is first-order in the adsorbed coverage:\n$$r_{1,\\mathrm{r}} = k_{1,\\mathrm{r}}(T)\\, \\theta_{\\mathrm{EC}},$$\nwith\n$$k_{1,\\mathrm{r}}(T) = A_{1,\\mathrm{r}}\\, \\exp\\!\\left(-\\frac{E_{a,1,\\mathrm{r}}}{R T}\\right).$$\n\nElectron transfer is governed by an Arrhenius-like prefactor and a Butler窶天olmer-type exponential in the overpotential, modified by the SEI coverage via barrier shift:\n$$E_{a,2}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,2,0} + \\gamma_{2}\\, \\theta_{\\mathrm{SEI}},$$\n$$k_{2}(T,E,\\theta_{\\mathrm{SEI}}) = A_{2}\\, \\exp\\!\\left(-\\frac{E_{a,2}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right)\\, \\exp\\!\\left(-\\frac{\\alpha_{2} F \\left(E - E_{0,2}\\right)}{R T}\\right),$$\nand the reduction rate is\n$$r_{2} = k_{2}(T,E,\\theta_{\\mathrm{SEI}})\\, \\theta_{\\mathrm{EC}}.$$\nWhen $$E  E_{0,2},$$ the term $$\\exp\\!\\left(-\\frac{\\alpha_{2} F \\left(E - E_{0,2}\\right)}{R T}\\right)$$ increases (because the exponent becomes positive), resulting in higher reduction rates, consistent with physical intuition.\n\nLithium association and product-forming steps are chemical reactions with barrier shifts proportional to the SEI coverage:\n$$E_{a,3}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,3,0} + \\gamma_{3}\\, \\theta_{\\mathrm{SEI}},\\quad k_{3} = A_{3}\\, \\exp\\!\\left(-\\frac{E_{a,3}^{\\mathrm{eff}}}{R T}\\right),\\quad r_{3} = k_{3}\\, C_{\\mathrm{Li}}\\, \\theta_{\\mathrm{R}}.$$\n$$E_{a,4}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,4,0} + \\gamma_{4}\\, \\theta_{\\mathrm{SEI}},\\quad k_{4} = A_{4}\\, \\exp\\!\\left(-\\frac{E_{a,4}^{\\mathrm{eff}}}{R T}\\right),\\quad r_{4} = k_{4}\\, C_{\\mathrm{EC}}\\, \\theta_{\\mathrm{I}}.$$\n$$E_{a,5}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,5,0} + \\gamma_{5}\\, \\theta_{\\mathrm{SEI}},\\quad k_{5} = A_{5}\\, \\exp\\!\\left(-\\frac{E_{a,5}^{\\mathrm{eff}}}{R T}\\right),\\quad r_{5} = k_{5}\\, C_{\\mathrm{Li}}\\, \\theta_{\\mathrm{I}}.$$\n\nApplying stoichiometry to convert rates into coverage evolution:\n- The adsorption step increases $$\\theta_{\\mathrm{EC}}$$ and desorption decreases it; electron transfer consumes $$\\theta_{\\mathrm{EC}}.$$ Thus,\n  $$\\frac{d\\theta_{\\mathrm{EC}}}{dt} = r_{1,\\mathrm{f}} - r_{1,\\mathrm{r}} - r_{2}.$$\n- The electron-transfer step forms $$\\theta_{\\mathrm{R}}$$ and lithium association consumes it:\n  $$\\frac{d\\theta_{\\mathrm{R}}}{dt} = r_{2} - r_{3}.$$\n- Intermediate $$\\theta_{\\mathrm{I}}$$ is formed by $$r_{3}$$ and consumed by product-forming steps $$r_{4}$$ and $$r_{5}:$$\n  $$\\frac{d\\theta_{\\mathrm{I}}}{dt} = r_{3} - r_{4} - r_{5}.$$\n- Product coverages accumulate irreversibly:\n  $$\\frac{d\\theta_{\\mathrm{LEDC}}}{dt} = r_{4},\\quad \\frac{d\\theta_{\\mathrm{Li_2CO_3}}}{dt} = r_{5}.$$\n\nAlgorithmic design:\n1. For each test case, define $$T,$$ $$E,$$ $$C_{\\mathrm{EC}},$$ $$C_{\\mathrm{Li}},$$ and initial coverages.\n2. At each time step (within a robust numerical integrator), compute $$\\theta_{\\mathrm{SEI}} = \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}$$ and $$\\theta_*$$ via the site balance clipped at zero:\n   $$\\theta_* = \\max\\!\\left(0, 1 - \\left(\\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}\\right)\\right).$$\n3. Compute effective activation energies and rate constants using the provided Arrhenius and Butler窶天olmer-type expressions.\n4. Evaluate the rates $$r_{1,\\mathrm{f}}, r_{1,\\mathrm{r}}, r_{2}, r_{3}, r_{4}, r_{5}.$$ \n5. Assemble the right-hand side vector $$\\left[\\frac{d\\theta_{\\mathrm{EC}}}{dt}, \\frac{d\\theta_{\\mathrm{R}}}{dt}, \\frac{d\\theta_{\\mathrm{I}}}{dt}, \\frac{d\\theta_{\\mathrm{LEDC}}}{dt}, \\frac{d\\theta_{\\mathrm{Li_2CO_3}}}{dt}\\right].$$\n6. Integrate from $$t=0\\,\\mathrm{s}$$ to $$t=1000\\,\\mathrm{s}$$ using a stable solver appropriate for potentially stiff dynamics; after integration, clip the final coverages to $$[0,1].$$\n7. Record $$\\theta_{\\mathrm{LEDC}}(t_{\\mathrm{end}})$$ and $$\\theta_{\\mathrm{Li_2CO_3}}(t_{\\mathrm{end}}),$$ round them to three decimal places, and aggregate the results.\n\nPhysical consistency considerations:\n- The potential dependence in $$k_{2}$$ ensures higher reduction rates at more negative $$E,$$ consistent with electron-transfer kinetics, with $$\\alpha_{2}$$ as the transfer coefficient and $$E_{0,2}$$ as the reference potential.\n- Coverage-dependent barrier shifts $$\\gamma_{i}\\, \\theta_{\\mathrm{SEI}}$$ model the passivating effect of the SEI, slowing further reactions as the SEI grows.\n- Adsorption depends on the availability of free sites, ensuring the site conservation is respected.\n\nThe final program implements this microkinetic model, integrates the system for each test case, and outputs a single line containing the list of results $$\\left[ [x_{1}, y_{1}], \\ldots, [x_{5}, y_{5}] \\right]$$ with $$x_{i} = \\theta_{\\mathrm{LEDC}}(t_{\\mathrm{end}})$$ and $$y_{i} = \\theta_{\\mathrm{Li_2CO_3}}(t_{\\mathrm{end}})$$ rounded to three decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Constants\nR = 8.314462618  # J/mol/K\nF = 96485.33212  # C/mol\n\n# Fixed kinetic parameters (globally used)\nA1f = 1e-3        # m^3/(mol*s)\nEa1f = 5000.0     # J/mol\nA1r = 1e2         # 1/s\nEa1r = 30000.0    # J/mol\n\nA2 = 1e2          # 1/s\nEa20 = 50000.0    # J/mol\nalpha2 = 0.5\nE02 = 0.2         # V\ngamma2 = 20000.0  # J/mol\n\nA3 = 1e-3         # m^3/(mol*s)\nEa30 = 20000.0    # J/mol\ngamma3 = 5000.0   # J/mol\n\nA4 = 1.0          # m^3/(mol*s)\nEa40 = 25000.0    # J/mol\ngamma4 = 10000.0  # J/mol\n\nA5 = 1.0          # m^3/(mol*s)\nEa50 = 28000.0    # J/mol\ngamma5 = 15000.0  # J/mol\n\nt_end = 1000.0    # s\n\ndef microkinetic_rhs(t, y, T, E, C_EC, C_Li):\n    # Unpack coverages: theta_EC, theta_R, theta_I, theta_LEDC, theta_Li2CO3\n    theta_EC, theta_R, theta_I, theta_LEDC, theta_Li2CO3 = y\n    # SEI coverage\n    theta_SEI = theta_LEDC + theta_Li2CO3\n    # Free sites (ensure non-negative)\n    theta_total = theta_EC + theta_R + theta_I + theta_LEDC + theta_Li2CO3\n    theta_free = max(0.0, 1.0 - theta_total)\n\n    # Effective activation energies with coverage dependence\n    Ea2_eff = Ea20 + gamma2 * theta_SEI\n    Ea3_eff = Ea30 + gamma3 * theta_SEI\n    Ea4_eff = Ea40 + gamma4 * theta_SEI\n    Ea5_eff = Ea50 + gamma5 * theta_SEI\n\n    # Rate constants\n    k1f = A1f * np.exp(-Ea1f / (R * T))               # m^3/(mol*s)\n    k1r = A1r * np.exp(-Ea1r / (R * T))               # 1/s\n\n    k2 = A2 * np.exp(-Ea2_eff / (R * T)) * np.exp(-alpha2 * F * (E - E02) / (R * T))  # 1/s\n\n    k3 = A3 * np.exp(-Ea3_eff / (R * T))              # m^3/(mol*s)\n    k4 = A4 * np.exp(-Ea4_eff / (R * T))              # m^3/(mol*s)\n    k5 = A5 * np.exp(-Ea5_eff / (R * T))              # m^3/(mol*s)\n\n    # Elementary step rates\n    r1f = k1f * C_EC * theta_free\n    r1r = k1r * theta_EC\n    r2 = k2 * theta_EC\n    r3 = k3 * C_Li * theta_R\n    r4 = k4 * C_EC * theta_I\n    r5 = k5 * C_Li * theta_I\n\n    # ODEs\n    dtheta_EC = r1f - r1r - r2\n    dtheta_R = r2 - r3\n    dtheta_I = r3 - r4 - r5\n    dtheta_LEDC = r4\n    dtheta_Li2CO3 = r5\n\n    return [dtheta_EC, dtheta_R, dtheta_I, dtheta_LEDC, dtheta_Li2CO3]\n\ndef integrate_case(T, E, C_EC, C_Li, y0):\n    # Solve the ODE system; use a stiff solver for robustness\n    sol = solve_ivp(\n        fun=lambda t, y: microkinetic_rhs(t, y, T, E, C_EC, C_Li),\n        t_span=(0.0, t_end),\n        y0=y0,\n        method='BDF',\n        rtol=1e-9,\n        atol=1e-12,\n        dense_output=False\n    )\n    y_final = sol.y[:, -1]\n    # Clip final coverages to [0,1]\n    y_final = np.clip(y_final, 0.0, 1.0)\n    # Return LEDC and Li2CO3 final coverages\n    theta_LEDC_f = float(y_final[3])\n    theta_Li2CO3_f = float(y_final[4])\n    return theta_LEDC_f, theta_Li2CO3_f\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: General case\n        (298.0, -0.5, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case 2: Low temperature\n        (250.0, -0.5, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case 3: Less reducing potential\n        (298.0, -0.1, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case 4: Pre-passivated surface\n        (298.0, -0.5, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.2, 0.2]),\n        # Case 5: Strongly reducing potential\n        (298.0, -1.0, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.0, 0.0]),\n    ]\n\n    results = []\n    for T, E, C_EC, C_Li, y0 in test_cases:\n        theta_LEDC_f, theta_Li2CO3_f = integrate_case(T, E, C_EC, C_Li, y0)\n        results.append([theta_LEDC_f, theta_Li2CO3_f])\n\n    # Format the output: each inner list values rounded to three decimals\n    formatted_cases = []\n    for pair in results:\n        formatted_cases.append(\"[\" + \",\".join(f\"{x:.3f}\" for x in pair) + \"]\")\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```"
        }
    ]
}