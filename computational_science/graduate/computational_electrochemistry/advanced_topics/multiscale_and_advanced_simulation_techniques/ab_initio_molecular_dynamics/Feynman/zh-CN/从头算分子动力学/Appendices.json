{
    "hands_on_practices": [
        {
            "introduction": "在任何分子动力学模拟中，一个最基本的健全性检查是验证系统的温度是否正确地反映了其原子的动能。这个练习将理论与实践相结合，要求您从统计力学的第一性原理出发，推导经典正则系综中每个原子的平均动能与温度之间的关系。通过将理论上的期望值与模拟中可测量的量联系起来，这项实践巩固了您对等分定理的理解，并为您提供了一个在运行更复杂的从头算分子动力学 (AIMD) 模拟时验证恒温器性能的基本工具 。",
            "id": "4236153",
            "problem": "给定一个涉及从头算分子动力学 (AIMD) 的计算电化学领域的科学真实场景。在 Born-Oppenheimer 从头算分子动力学 (AIMD) 中，假定电子在当前原子核位置下保持瞬时基态，而原子核根据经典牛顿动力学演化，其受力由电子基态能量面确定。考虑一个靠近铂 $(111)$ 板的氯化钠水溶液小体系。任务是利用第一性原理，确定在指定温度下正则系综轨迹中每个原子的平均动能，并推理如何设置该轨迹。\n\n仅从基本定律和定义出发，推导在温度为 $T$、无完整约束的情况下，原子核在 Born-Oppenheimer 近似下演化时，经典正则系综中每个原子的平均动能。推导必须从动能和正则系综的定义开始，并应关联到平衡态下经典原子核的速度分布。然后，实现一个程序，根据一组给定的温度计算每个原子的平均动能，假设系统为三维，每个原子有三个平动自由度且无约束。\n\n作为背景信息，一个典型的在 $T=300\\ \\mathrm{K}$ 下的 $10\\ \\mathrm{ps}$ Born-Oppenheimer 轨迹，会使用 $0.5$ 到 $1.0\\ \\mathrm{fs}$ 量级的时间步长，产生 $10000$ 到 $20000$ 个步骤，其中每一步的力都通过在固定原子核位置上进行电子结构计算获得，并使用恒温器来维持正则系综。然而，在本问题中，你的程序只需计算与经典原子核的正则系综一致的、作为温度函数的每个原子的平均动能。\n\n物理单位要求：以电子伏特表示每个原子的平均动能。程序必须以 $\\mathrm{eV}$ 为单位输出值，并四舍五入到六位小数。\n\n角度单位要求：不适用，因为不涉及角度。\n\n百分比要求：不适用。\n\n测试套件：\n- 案例1（正常路径）：$T=300\\ \\mathrm{K}$\n- 案例2（绝对零度边界条件）：$T=0\\ \\mathrm{K}$\n- 案例3（高温边界情况）：$T=1000\\ \\mathrm{K}$\n- 案例4（接近环境温度且精度更高）：$T=298.15\\ \\mathrm{K}$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result1,result2,result3,result4]$），其中每个 $result$ 是每个原子的平均动能（单位为 $\\mathrm{eV}$），四舍五入到六位小数，分别对应上述四个测试温度。",
            "solution": "该问题要求首先对温度为 $T$ 的正则系综中经典原子核系统的每个原子平均动能进行第一性原理推导，然后通过编程计算特定温度下的值。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n- **理论框架**：Born-Oppenheimer 从头算分子动力学 (AIMD)。\n- **物理模型**：原子核根据经典牛顿动力学演化。电子在固定的原子核位置上处于基态。\n- **系综**：正则系综 (NVT)。\n- **系统性质**：每个原子具有三个平动自由度。没有完整约束。\n- **任务1（推导）**：从动能和正则系综的定义出发，推导每个原子的平均动能。\n- **任务2（计算）**：实现一个程序，为一组给定的温度计算每个原子的平均动能。\n- **单位**：最终结果必须以电子伏特（$\\mathrm{eV}$）为单位。\n- **取整**：数值输出必须四舍五入到六位小数。\n- **测试案例**：\n    - 案例1：$T = 300\\ \\mathrm{K}$\n    - 案例2：$T = 0\\ \\mathrm{K}$\n    - 案例3：$T = 1000\\ \\mathrm{K}$\n    - 案例4：$T = 298.15\\ \\mathrm{K}$\n\n**步骤2：使用提取的已知信息进行验证**\n这个问题具有科学依据、定义明确且客观。\n1.  **科学合理性**：该问题建立在经典统计力学（正则系综、能量均分定理）的基本原理及其在计算化学（Born-Oppenheimer 近似）中的应用之上。对于此类问题，这些都是标准且正确的假设。\n2.  **适定性**：目标明确：推导一个已知的物理量，然后在指定条件下计算其值。假设（经典原子核、3个自由度、无约束）足以得出一个唯一、稳定且有意义的解。\n3.  **客观性**：问题以精确、定量的术语陈述，没有歧义或主观内容。AIMD 的背景被用来构建一个关于基本统计力学的问题，这是一种有效的教学方法。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供解答。\n\n### 推导与解答\n\n推导从经典统计力学的基本定义开始，针对温度为 $T$ 的正则系综中的 $N$ 个原子系统。\n\n1.  **哈密顿量和动能**：在 Born-Oppenheimer 近似中，原子核的势能 $U(\\mathbf{r}_1, ..., \\mathbf{r}_N)$ 仅取决于其位置 $\\mathbf{r}_i$。原子核子系统的总经典哈密顿量 $H$ 是动能 $K$ 和势能 $U$ 的和：\n    $$H(\\mathbf{r}^N, \\mathbf{p}^N) = K(\\mathbf{p}^N) + U(\\mathbf{r}^N)$$\n    其中 $\\mathbf{r}^N = (\\mathbf{r}_1, ..., \\mathbf{r}_N)$ 和 $\\mathbf{p}^N = (\\mathbf{p}_1, ..., \\mathbf{p}_N)$ 代表所有位置和动量矢量的集合。总动能 $K$ 是 $N$ 个原子各自的动能之和：\n    $$K = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m_i} = \\sum_{i=1}^{N} \\left( \\frac{p_{ix}^2}{2m_i} + \\frac{p_{iy}^2}{2m_i} + \\frac{p_{iz}^2}{2m_i} \\right)$$\n    这里，$m_i$ 是第 $i$ 个原子的质量，$\\mathbf{p}_i = (p_{ix}, p_{iy}, p_{iz})$ 是其动量矢量。\n\n2.  **正则系综和期望值**：在正则系综中，找到系统处于坐标为 $(\\mathbf{r}^N, \\mathbf{p}^N)$ 的微观状态的概率密度由下式给出：\n    $$\\rho(\\mathbf{r}^N, \\mathbf{p}^N) = \\frac{e^{-\\beta H(\\mathbf{r}^N, \\mathbf{p}^N)}}{Z}$$\n    其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$Z$ 是配分函数，用于归一化概率分布：\n    $$Z = \\int d\\mathbf{r}^N d\\mathbf{p}^N \\, e^{-\\beta H(\\mathbf{r}^N, \\mathbf{p}^N)}$$\n    任何可观测量 $A$ 的平均值或期望值由下式给出：\n    $$\\langle A \\rangle = \\int d\\mathbf{r}^N d\\mathbf{p}^N \\, A(\\mathbf{r}^N, \\mathbf{p}^N) \\rho(\\mathbf{r}^N, \\mathbf{p}^N)$$\n\n3.  **平均动能**：我们要求的是平均总动能 $\\langle K \\rangle$。\n    $$\\langle K \\rangle = \\frac{1}{Z} \\int d\\mathbf{r}^N d\\mathbf{p}^N \\, K(\\mathbf{p}^N) e^{-\\beta (K(\\mathbf{p}^N) + U(\\mathbf{r}^N))}$$\n    由于哈密顿量可分离为依赖动量的部分 $K(\\mathbf{p}^N)$ 和依赖位置的部分 $U(\\mathbf{r}^N)$，配分函数 $Z$ 可以被因式分解：\n    $$Z = \\left( \\int d\\mathbf{p}^N \\, e^{-\\beta K(\\mathbf{p}^N)} \\right) \\left( \\int d\\mathbf{r}^N \\, e^{-\\beta U(\\mathbf{r}^N)} \\right) = Z_p Z_r$$\n    同样地，$\\langle K \\rangle$ 的积分也分离：\n    $$\\langle K \\rangle = \\frac{1}{Z_p Z_r} \\left( \\int d\\mathbf{p}^N \\, K(\\mathbf{p}^N) e^{-\\beta K(\\mathbf{p}^N)} \\right) \\left( \\int d\\mathbf{r}^N \\, e^{-\\beta U(\\mathbf{r}^N)} \\right)$$\n    位置积分 $\\int d\\mathbf{r}^N \\, e^{-\\beta U(\\mathbf{r}^N)}$ 等于 $Z_r$，可以消去，剩下：\n    $$\\langle K \\rangle = \\frac{\\int d\\mathbf{p}^N \\, K(\\mathbf{p}^N) e^{-\\beta K(\\mathbf{p}^N)}}{\\int d\\mathbf{p}^N \\, e^{-\\beta K(\\mathbf{p}^N)}}$$\n    这表明平均动能与势能函数 $U(\\mathbf{r}^N)$ 无关。\n\n4.  **能量均分定理**：总动能是 $3N$ 个独立的二次项之和（$N$ 个原子中的每一个原子都有一个动量分量 $p_{ix}, p_{iy}, p_{iz}$）。我们可以评估单个此类项的平均能量贡献，例如 $\\frac{p_{ix}^2}{2m_i}$。\n    $$\\left\\langle \\frac{p_{ix}^2}{2m_i} \\right\\rangle = \\frac{\\int_{-\\infty}^{\\infty} dp_{ix} \\, \\frac{p_{ix}^2}{2m_i} e^{-\\beta \\frac{p_{ix}^2}{2m_i}}}{\\int_{-\\infty}^{\\infty} dp_{ix} \\, e^{-\\beta \\frac{p_{ix}^2}{2m_i}}}$$\n    所有其他关于动量分量的积分在分子和分母之间被消去。我们使用标准高斯积分：\n    $$\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\frac{\\pi}{a}}$$\n    $$\\int_{-\\infty}^{\\infty} x^2 e^{-ax^2} dx = -\\frac{d}{da} \\int_{-\\infty}^{\\infty} e^{-ax^2} dx = -\\frac{d}{da} \\sqrt{\\frac{\\pi}{a}} = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}$$\n    令 $x = p_{ix}$ 和 $a = \\frac{\\beta}{2m_i}$：\n    - 分母：$\\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta}{2m_i} p_{ix}^2} dp_{ix} = \\sqrt{\\frac{2 \\pi m_i}{\\beta}}$\n    - 分子：$\\int_{-\\infty}^{\\infty} \\frac{p_{ix}^2}{2m_i} e^{-\\frac{\\beta}{2m_i} p_{ix}^2} dp_{ix} = \\frac{1}{2m_i} \\left( \\frac{1}{2 \\frac{\\beta}{2m_i}}\\sqrt{\\frac{2 \\pi m_i}{\\beta}} \\right) = \\frac{1}{2\\beta} \\sqrt{\\frac{2 \\pi m_i}{\\beta}}$\n    两者相除得到：\n    $$\\left\\langle \\frac{p_{ix}^2}{2m_i} \\right\\rangle = \\frac{\\frac{1}{2\\beta} \\sqrt{\\frac{2 \\pi m_i}{\\beta}}}{\\sqrt{\\frac{2 \\pi m_i}{\\beta}}} = \\frac{1}{2\\beta} = \\frac{1}{2} k_B T$$\n    这就是能量均分定理：哈密顿量中的每个二次自由度对系统贡献的平均能量为 $\\frac{1}{2}k_B T$。\n\n5.  **每个原子的平均动能**：问题指明每个原子有三个平动自由度，且没有约束。哈密顿量的动能部分包含 $3N$ 个这样的二次项。因此，$N$ 个原子系统的总平均动能是：\n    $$\\langle K_{total} \\rangle = \\sum_{i=1}^{N} \\left( \\left\\langle \\frac{p_{ix}^2}{2m_i} \\right\\rangle + \\left\\langle \\frac{p_{iy}^2}{2m_i} \\right\\rangle + \\left\\langle \\frac{p_{iz}^2}{2m_i} \\right\\rangle \\right) = 3N \\times \\left(\\frac{1}{2} k_B T\\right) = \\frac{3}{2} N k_B T$$\n    为了求出每个原子的平均动能 $\\langle E_{kin, atom} \\rangle$，我们将总平均动能除以原子数 $N$：\n    $$\\langle E_{kin, atom} \\rangle = \\frac{\\langle K_{total} \\rangle}{N} = \\frac{\\frac{3}{2} N k_B T}{N} = \\frac{3}{2} k_B T$$\n    这就是最终推导出的表达式。对于任何处于热平衡状态的经典系统，只要其动能是动量的二次函数，并且每个粒子有三个无约束的自由度，这个结果都是普适的。\n\n6.  **数值计算**：为了实现计算，我们使用玻尔兹曼常数的值，其单位需为电子伏特每开尔文（$\\mathrm{eV}/\\mathrm{K}$）。\n    - $k_B \\approx 8.617333262 \\times 10^{-5}\\ \\mathrm{eV}/\\mathrm{K}$\n    - 公式为：$\\langle E_{kin, atom} \\rangle [\\mathrm{eV}] = \\frac{3}{2} \\times (8.617333262 \\times 10^{-5}\\ \\mathrm{eV}/\\mathrm{K}) \\times T[\\mathrm{K}]$\n\n现在为给定的测试案例实现此公式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mean kinetic energy per atom for a classical system\n    in a canonical ensemble at various temperatures.\n    \"\"\"\n    \n    # The Boltzmann constant in electronvolts per Kelvin (eV/K).\n    # Source: CODATA 2018 value.\n    K_B_EV_PER_K = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    # Temperatures are in Kelvin (K).\n    test_cases = [\n        300.0,      # Case 1 (happy path)\n        0.0,        # Case 2 (boundary condition at absolute zero)\n        1000.0,     # Case 3 (high temperature edge case)\n        298.15      # Case 4 (near-ambient temperature with higher precision)\n    ]\n\n    results = []\n    for T in test_cases:\n        # According to the equipartition theorem for a classical system with\n        # 3 translational degrees of freedom per atom and no constraints,\n        # the mean kinetic energy per atom is (3/2) * k_B * T.\n        #\n        # Degrees of freedom (dof) = 3 (for x, y, z translation)\n        # Mean energy per dof = (1/2) * k_B * T\n        # Mean kinetic energy per atom = dof * (1/2) * k_B * T = (3/2) * k_B * T\n        \n        mean_kinetic_energy_per_atom = 1.5 * K_B_EV_PER_K * T\n        \n        # Round the result to six decimal places as required.\n        # We use a format string for robust formatting to ensure trailing zeros.\n        rounded_result = \"{:.6f}\".format(mean_kinetic_energy_per_atom)\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format: [result1,result2,result3,result4]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理论上，在微正则系综 (NVE) 中进行的分子动力学模拟应该严格保持总能量守恒。然而在实践中，由于数值积分（时间步长 $\\Delta t$）和电子自洽场 (SCF) 计算不完全收敛（收敛阈值 $\\tau$），能量会发生系统性漂移。这项实践引导您解决一个在从头算分子动力学中至关重要的问题：如何选择这些数值参数以确保模拟的长期稳定性和物理真实性。您将通过对模拟“校准”数据进行建模，量化能量漂移与这些参数的关系，并学习如何制定策略，将不可避免的数值误差控制在可接受的范围内 。",
            "id": "3728716",
            "problem": "考虑一个由$128$个原子组成的高熵合金，在微正则系综（粒子数、体积和能量恒定；NVE）中进行的玻恩-奥本海默分子动力学（BOMD）模拟。在理想的连续时间演化中，当自洽场（SCF）精确收敛且力精确计算时，系统的总能量应守恒。实践中，两个系统性数值误差源会导致能量漂移：积分器的有限时间步长 $\\Delta t$ 和电子结构求解器的有限自洽场（SCF）收敛容差 $\\tau$。对于足够小的 $\\Delta t$ 和严格的 SCF 容差，每个原子的能量漂移率可以由一个对主要小误差项呈线性的模型来近似。假设使用速度-Verlet积分器（对于行为良好的力，其局部截断误差为 $\\mathcal{O}((\\Delta t)^3)$ 阶，全局能量误差按 $\\mathcal{O}((\\Delta t)^2)$ 缩放）并且残余力误差与 SCF 能量容差近似线性相关，采用以下线性化漂移率模型：\n$$\nr(\\Delta t,\\tau) = \\alpha\\,(\\Delta t)^2 + \\beta\\,\\tau + \\gamma,\n$$\n其中 $r$ 是以 meV/原子/ns 为单位的能量漂移率，$\\Delta t$ 是以 fs（飞秒）为单位的时间步长，$\\tau$ 是以 eV（电子伏特）为单位的 SCF 能量容差，而 $\\alpha$、$\\beta$、$\\gamma$ 是待定参数。\n\n现为您提供一组从对该 $128$ 原子高熵合金进行的短期 NVE BOMD 运行中获得的 $(\\Delta t,\\tau)$ 对的能量漂移率 $r$ 的校准测量值。所有列出的 $r$ 值均以 meV/原子/ns 为单位。请使用这些校准数据，通过最小二乘法拟合线性模型参数 $\\alpha$、$\\beta$ 和 $\\gamma$：\n- $(\\Delta t=0.5\\,\\text{fs}, \\tau=1\\times 10^{-5}\\,\\text{eV}) \\rightarrow r=0.1625$\n- $(\\Delta t=0.5\\,\\text{fs}, \\tau=5\\times 10^{-5}\\,\\text{eV}) \\rightarrow r=0.3625$\n- $(\\Delta t=0.5\\,\\text{fs}, \\tau=1\\times 10^{-4}\\,\\text{eV}) \\rightarrow r=0.6125$\n- $(\\Delta t=0.5\\,\\text{fs}, \\tau=5\\times 10^{-4}\\,\\text{eV}) \\rightarrow r=2.6125$\n- $(\\Delta t=1.0\\,\\text{fs}, \\tau=1\\times 10^{-5}\\,\\text{eV}) \\rightarrow r=0.3500$\n- $(\\Delta t=1.0\\,\\text{fs}, \\tau=5\\times 10^{-5}\\,\\text{eV}) \\rightarrow r=0.5500$\n- $(\\Delta t=1.0\\,\\text{fs}, \\tau=1\\times 10^{-4}\\,\\text{eV}) \\rightarrow r=0.8000$\n- $(\\Delta t=1.0\\,\\text{fs}, \\tau=5\\times 10^{-4}\\,\\text{eV}) \\rightarrow r=2.8000$\n- $(\\Delta t=2.0\\,\\text{fs}, \\tau=1\\times 10^{-5}\\,\\text{eV}) \\rightarrow r=1.1000$\n- $(\\Delta t=2.0\\,\\text{fs}, \\tau=5\\times 10^{-5}\\,\\text{eV}) \\rightarrow r=1.3000$\n- $(\\Delta t=2.0\\,\\text{fs}, \\tau=1\\times 10^{-4}\\,\\text{eV}) \\rightarrow r=1.5500$\n- $(\\Delta t=2.0\\,\\text{fs}, \\tau=5\\times 10^{-4}\\,\\text{eV}) \\rightarrow r=3.5500$\n\n在拟合 $\\alpha$、$\\beta$ 和 $\\gamma$ 之后，通过计算 $r(\\Delta t,\\tau)$ 来量化指定测试 $(\\Delta t,\\tau)$ 对的能量漂移。此外，推导出一个关于 SCF 容差 $\\tau$ 的函数，给出最大允许时间步长 $\\Delta t_{\\max}$ 的建议，以使漂移率保持在目标阈值 $r_{\\text{thr}}=1\\,\\text{meV/atom/ns}$ 以下。使用拟合后的模型，该建议必须满足：\n$$\n\\Delta t_{\\max}(\\tau) = \n\\begin{cases}\n\\sqrt{\\dfrac{r_{\\text{thr}} - \\beta\\,\\tau - \\gamma}{\\alpha}},  \\text{if } r_{\\text{thr}} - \\beta\\,\\tau - \\gamma > 0, \\\\\n0,  \\text{otherwise,}\n\\end{cases}\n$$\n其中 $\\Delta t_{\\max}$ 以 fs 表示。\n\n您的程序必须执行以下步骤：\n1. 使用上述校准数据集拟合参数 $\\alpha$、$\\beta$ 和 $\\gamma$。\n2. 计算以下测试对的预测漂移率 $r(\\Delta t,\\tau)$：\n   - $\\Delta t=1.0\\,\\text{fs}$，$\\tau=1\\times 10^{-5}\\,\\text{eV}$，\n   - $\\Delta t=2.0\\,\\text{fs}$，$\\tau=1\\times 10^{-5}\\,\\text{eV}$，\n   - $\\Delta t=1.5\\,\\text{fs}$，$\\tau=1\\times 10^{-4}\\,\\text{eV}$。\n   以 meV/原子/ns 为单位报告每个 $r$。\n3. 计算在以下 SCF 容差下，为使漂移低于 $r_{\\text{thr}}=1\\,\\text{meV/atom/ns}$ 而建议的 $\\Delta t_{\\max}$：\n   - $\\tau=1\\times 10^{-5}\\,\\text{eV}$，\n   - $\\tau=5\\times 10^{-5}\\,\\text{eV}$，\n   - $\\tau=1\\times 10^{-4}\\,\\text{eV}$，\n   - $\\tau=5\\times 10^{-4}\\,\\text{eV}$。\n   以 fs 为单位报告每个 $\\Delta t_{\\max}$。\n\n所有数值答案必须是浮点数，并四舍五入到六位小数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容按以下顺序排列：三个预测的漂移率，后跟四个建议的最大时间步长，即 $[r_{1},r_{2},r_{3},\\Delta t_{\\max,1},\\Delta t_{\\max,2},\\Delta t_{\\max,3},\\Delta t_{\\max,4}]$。",
            "solution": "该问题要求我们确定玻恩-奥本海默分子动力学（BOMD）模拟中能量漂移线性模型的参数，然后使用此模型进行预测并建立操作约束。分析过程分为两个主要阶段：首先，使用线性最小二乘法拟合模型参数；其次，应用拟合后的模型回答提出的具体问题。\n\n提出的单位原子能量漂移率模型 $r$ 由下式给出：\n$$\nr(\\Delta t, \\tau) = \\alpha (\\Delta t)^2 + \\beta \\tau + \\gamma\n$$\n其中 $\\Delta t$ 是以飞秒（fs）为单位的积分时间步长，$\\tau$ 是以电子伏特（eV）为单位的自洽场（SCF）能量收敛容差，$r$ 是以 meV/原子/ns 为单位的漂移率。待定参数为 $\\alpha$、$\\beta$ 和 $\\gamma$。该模型相对于这些参数是线性的。$(\\Delta t)^2$ 项的物理动机源于速度-Verlet积分器的全局能量误差缩放特性，而对 $\\tau$ 的线性依赖性是对于不完全 SCF 收敛对原子力的影响的一个合理的一阶近似。\n\n给定 $12$ 个形式为 $((\\Delta t)_i, \\tau_i, r_i)$ 的校准数据点，其中 $i=1, \\dots, 12$。为了找到最佳拟合参数 $\\alpha$、$\\beta$ 和 $\\gamma$，我们采用线性最小二乘法。该方法旨在最小化观测漂移率 $r_i$ 与模型预测漂移率之间的平方差之和。\n\n让我们为每个数据点定义一个参数向量 $\\mathbf{p}$ 和一个特征向量 $\\mathbf{x}_i$：\n$$\n\\mathbf{p} = \\begin{pmatrix} \\alpha \\\\ \\beta \\\\ \\gamma \\end{pmatrix}, \\quad \\mathbf{x}_i = \\begin{pmatrix} (\\Delta t_i)^2 \\\\ \\tau_i \\\\ 1 \\end{pmatrix}\n$$\n该模型可以表示为 $r_i \\approx \\mathbf{x}_i^T \\mathbf{p}$。我们可以将所有 12 个方程组合成一个矩阵方程：\n$$\n\\mathbf{A} \\mathbf{p} = \\mathbf{b}\n$$\n其中 $\\mathbf{A}$ 是一个 $12 \\times 3$ 的设计矩阵，其行是特征向量 $\\mathbf{x}_i^T$，$\\mathbf{b}$ 是一个 $12 \\times 1$ 的观测漂移率 $r_i$ 向量。\n\n$$\n\\mathbf{A} = \\begin{pmatrix}\n(\\Delta t_1)^2  \\tau_1  1 \\\\\n(\\Delta t_2)^2  \\tau_2  1 \\\\\n\\vdots  \\vdots  \\vdots \\\\\n(\\Delta t_{12})^2  \\tau_{12}  1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n(0.5)^2  1 \\times 10^{-5}  1 \\\\\n(0.5)^2  5 \\times 10^{-5}  1 \\\\\n(0.5)^2  1 \\times 10^{-4}  1 \\\\\n(0.5)^2  5 \\times 10^{-4}  1 \\\\\n(1.0)^2  1 \\times 10^{-5}  1 \\\\\n(1.0)^2  5 \\times 10^{-5}  1 \\\\\n(1.0)^2  1 \\times 10^{-4}  1 \\\\\n(1.0)^2  5 \\times 10^{-4}  1 \\\\\n(2.0)^2  1 \\times 10^{-5}  1 \\\\\n(2.0)^2  5 \\times 10^{-5}  1 \\\\\n(2.0)^2  1 \\times 10^{-4}  1 \\\\\n(2.0)^2  5 \\times 10^{-4}  1\n\\end{pmatrix},\n\\quad\n\\mathbf{b} = \\begin{pmatrix}\n0.1625 \\\\ 0.3625 \\\\ 0.6125 \\\\ 2.6125 \\\\\n0.3500 \\\\ 0.5500 \\\\ 0.8000 \\\\ 2.8000 \\\\\n1.1000 \\\\ 1.3000 \\\\ 1.5500 \\\\ 3.5500\n\\end{pmatrix}\n$$\n\n最小二乘解 $\\mathbf{p}$ 最小化了残差向量的欧几里得范数 $||\\mathbf{A} \\mathbf{p} - \\mathbf{b}||_2$。该解通过求解正规方程组得到：\n$$\n(\\mathbf{A}^T \\mathbf{A}) \\mathbf{p} = \\mathbf{A}^T \\mathbf{b}\n$$\n求解这个关于 $\\mathbf{p}$ 的线性方程组，即可得到 $\\alpha$、$\\beta$ 和 $\\gamma$ 的值。使用给定数据进行此计算，结果如下：\n$$\n\\alpha = 0.25 \\, \\frac{\\text{meV/atom/ns}}{\\text{fs}^2}\n$$\n$$\n\\beta = 5000 \\, \\frac{\\text{meV/atom/ns}}{\\text{eV}}\n$$\n$$\n\\gamma = 0.05 \\, \\text{meV/atom/ns}\n$$\n所提供的数据可以被这些参数完美描述，表明校准集中没有随机噪声。因此，拟合后的模型为：\n$$\nr(\\Delta t, \\tau) = 0.25 (\\Delta t)^2 + 5000 \\tau + 0.05\n$$\n\n模型参数化后，我们可以进行所需的计算。\n\n**1. 预测漂移率**\n\n我们为三个测试对 $(\\Delta t, \\tau)$ 计算漂移率 $r$：\n- 对于 $(\\Delta t=1.0\\,\\text{fs}, \\tau=1 \\times 10^{-5}\\,\\text{eV})$：\n$$\nr_1 = 0.25 (1.0)^2 + 5000 (1 \\times 10^{-5}) + 0.05 = 0.25 + 0.05 + 0.05 = 0.35 \\, \\text{meV/atom/ns}\n$$\n- 对于 $(\\Delta t=2.0\\,\\text{fs}, \\tau=1 \\times 10^{-5}\\,\\text{eV})$：\n$$\nr_2 = 0.25 (2.0)^2 + 5000 (1 \\times 10^{-5}) + 0.05 = 0.25(4) + 0.05 + 0.05 = 1.0 + 0.05 + 0.05 = 1.10 \\, \\text{meV/atom/ns}\n$$\n- 对于 $(\\Delta t=1.5\\,\\text{fs}, \\tau=1 \\times 10^{-4}\\,\\text{eV})$：\n$$\nr_3 = 0.25 (1.5)^2 + 5000 (1 \\times 10^{-4}) + 0.05 = 0.25(2.25) + 0.5 + 0.05 = 0.5625 + 0.5 + 0.05 = 1.1125 \\, \\text{meV/atom/ns}\n$$\n\n**2. 建议的最大时间步长**\n\n我们需要为给定的容差 $\\tau$ 找到最大时间步长 $\\Delta t_{\\max}$，使得漂移率不超过阈值 $r_{\\text{thr}} = 1.0\\,\\text{meV/atom/ns}$。我们从模型出发求解 $\\Delta t$：\n$$\nr_{\\text{thr}} \\ge 0.25 (\\Delta t)^2 + 5000 \\tau + 0.05\n$$\n$$\n(\\Delta t)^2 \\le \\frac{r_{\\text{thr}} - 5000 \\tau - 0.05}{0.25}\n$$\n为使 $\\Delta t$ 为实数，分子必须为非负数。这给出了 $\\Delta t_{\\max}$ 的表达式：\n$$\n\\Delta t_{\\max}(\\tau) = \\begin{cases}\n\\sqrt{\\dfrac{1.0 - 5000 \\tau - 0.05}{0.25}} = \\sqrt{4 (0.95 - 5000 \\tau)} = 2\\sqrt{0.95 - 5000 \\tau},  \\text{if } 0.95 - 5000 \\tau  0 \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\n条件 $0.95 - 5000 \\tau  0$ 意味着 $\\tau  \\frac{0.95}{5000} = 1.9 \\times 10^{-4}$ eV。\n\n现在我们为四个给定的 $\\tau$ 值计算 $\\Delta t_{\\max}$：\n\n- 对于 $\\tau = 1 \\times 10^{-5}\\,\\text{eV}$：满足条件。\n$$\n\\Delta t_{\\max,1} = 2\\sqrt{0.95 - 5000(1 \\times 10^{-5})} = 2\\sqrt{0.95 - 0.05} = 2\\sqrt{0.90} \\approx 1.897367 \\, \\text{fs}\n$$\n- 对于 $\\tau = 5 \\times 10^{-5}\\,\\text{eV}$：满足条件。\n$$\n\\Delta t_{\\max,2} = 2\\sqrt{0.95 - 5000(5 \\times 10^{-5})} = 2\\sqrt{0.95 - 0.25} = 2\\sqrt{0.70} \\approx 1.673320 \\, \\text{fs}\n$$\n- 对于 $\\tau = 1 \\times 10^{-4}\\,\\text{eV}$：满足条件。\n$$\n\\Delta t_{\\max,3} = 2\\sqrt{0.95 - 5000(1 \\times 10^{-4})} = 2\\sqrt{0.95 - 0.50} = 2\\sqrt{0.45} \\approx 1.341641 \\, \\text{fs}\n$$\n- 对于 $\\tau = 5 \\times 10^{-4}\\,\\text{eV}$：$5000 \\tau = 2.5$，大于 $0.95$。分子为负。\n$$\n\\Delta t_{\\max,4} = 0 \\, \\text{fs}\n$$\n\n最终的结果集合，四舍五入到六位小数，是：$r_1=0.350000$，$r_2=1.100000$，$r_3=1.112500$，$\\Delta t_{\\max,1}=1.897367$，$\\Delta t_{\\max,2}=1.673320$，$\\Delta t_{\\max,3}=1.341641$ 和 $\\Delta t_{\\max,4}=0.000000$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting an energy drift model for BOMD simulations\n    and using it for prediction and constraint derivation.\n    \"\"\"\n    \n    # --- Step 1: Fit the model parameters using least squares ---\n    \n    # Calibration data: (delta_t, tau, r)\n    # delta_t is in fs, tau in eV, r in meV/atom/ns.\n    calibration_data = [\n        (0.5, 1e-5, 0.1625),\n        (0.5, 5e-5, 0.3625),\n        (0.5, 1e-4, 0.6125),\n        (0.5, 5e-4, 2.6125),\n        (1.0, 1e-5, 0.3500),\n        (1.0, 5e-5, 0.5500),\n        (1.0, 1e-4, 0.8000),\n        (1.0, 5e-4, 2.8000),\n        (2.0, 1e-5, 1.1000),\n        (2.0, 5e-5, 1.3000),\n        (2.0, 1e-4, 1.5500),\n        (2.0, 5e-4, 3.5500),\n    ]\n\n    # The model is r = alpha * (delta_t)^2 + beta * tau + gamma\n    # This is a linear model in the parameters (alpha, beta, gamma).\n    # We set up the linear system A * p = b, where p = [alpha, beta, gamma].\n    \n    num_points = len(calibration_data)\n    A = np.zeros((num_points, 3))\n    b = np.zeros(num_points)\n    \n    for i, (dt, tau, r) in enumerate(calibration_data):\n        A[i, 0] = dt**2\n        A[i, 1] = tau\n        A[i, 2] = 1\n        b[i] = r\n        \n    # Solve the least squares problem A*p = b for p\n    params, _, _, _ = np.linalg.lstsq(A, b, rcond=None)\n    alpha, beta, gamma = params\n\n    # --- Step 2: Compute predicted drift rates for test cases ---\n    \n    test_rates_inputs = [\n        (1.0, 1e-5),  # (delta_t, tau)\n        (2.0, 1e-5),\n        (1.5, 1e-4),\n    ]\n    \n    predicted_rates = []\n    for dt, tau in test_rates_inputs:\n        rate = alpha * dt**2 + beta * tau + gamma\n        predicted_rates.append(rate)\n\n    # --- Step 3: Compute recommended max time step ---\n\n    r_thr = 1.0  # meV/atom/ns\n    \n    test_dtmax_inputs = [\n        1e-5,  # tau in eV\n        5e-5,\n        1e-4,\n        5e-4,\n    ]\n    \n    recommended_dtmax = []\n    for tau in test_dtmax_inputs:\n        # dt_max = sqrt((r_thr - beta*tau - gamma) / alpha)\n        numerator = r_thr - beta * tau - gamma\n        if numerator > 0:\n            dt_max = np.sqrt(numerator / alpha)\n        else:\n            dt_max = 0.0\n        recommended_dtmax.append(dt_max)\n        \n    # Combine all results\n    all_results = predicted_rates + recommended_dtmax\n    \n    # Format the output as specified\n    formatted_results = [f\"{res:.6f}\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从头算分子动力学模拟的一个主要目标是从微观原子运动中计算宏观物理性质。扩散系数是一个典型的输运性质，它量化了粒子在流体中的迁移率。本练习将指导您完成从模拟轨迹数据（此处以均方位移 (MSD) 的形式给出）中提取扩散系数的全过程。您将应用爱因斯坦关系式，并通过应用 Yeh–Hummer 校正来处理和修正由模拟体系尺寸有限引起的系统误差，从而获得对无限大体系中扩散系数的准确估计 。",
            "id": "2448227",
            "problem": "给定一组人工合成但具有物理基础的轨迹摘要数据，这些数据表示单个锂离子 $\\mathrm{Li}^+$ 在液态水中的运动，与从第一性原理分子动力学 (AIMD) 中获得的数据类似。运动是在边长为 $L$ 的立方模拟晶胞中，在周期性边界条件下的三维空间中进行的。目标是利用均方根位移的长时间行为，从第一性原理估算热力学（无限系统）极限下的扩散系数，并量化周期性边界条件下由流体动力学相互作用引起的有限尺寸效应。\n\n定义和常数：\n- 三维空间中的扩散系数 $D$ 通过爱因斯坦关系式定义：$D = \\lim_{t \\to \\infty} \\frac{1}{6}\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\Delta r(t)^2 \\rangle$，其中 $\\langle \\Delta r(t)^2 \\rangle$ 是均方根位移 (MSD)。\n- 对于边长为 $L$ 的有限周期性立方晶胞，Yeh–Hummer 流体动力学有限尺寸校正将有限系统扩散系数 $D_L$ 与无限系统扩散系数 $D_{\\infty}$ 关联起来，公式为 $D_{\\infty} = D_L + \\frac{k_{\\mathrm{B}} T \\,\\xi}{6\\pi \\eta L}$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\eta$ 是剪切粘度，对于立方晶格 $\\xi \\approx 2.837297$。\n- 使用 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$ 和 $\\xi = 2.837297$。\n- 单位：时间数组 $t$ 以皮秒 (ps) 为单位提供，均方根位移值 $\\langle \\Delta r^2 \\rangle$ 以平方纳米 ($\\mathrm{nm}^2$) 为单位提供，盒子长度 $L$ 以纳米 (nm) 为单位提供，粘度 $\\eta$ 以帕斯卡秒 ($\\mathrm{Pa\\,s}$) 为单位提供，温度 $T$ 以开尔文 (K) 为单位提供。您的程序必须以平方米每秒 ($\\mathrm{m}^2\\,\\mathrm{s}^{-1}$) 为单位输出 $D_{\\infty}$。不涉及角度。不涉及百分比。\n- 对于每种情况，必须根据爱因斯坦关系式，在指定的拟合区间 $[t_{\\min}, t_{\\max}]$ 内，通过 $\\langle \\Delta r^2 \\rangle$ 对 $t$ 的线性函数的最佳拟合斜率来获得 $D_L$。单位之间的转换必须精确执行：$1\\ \\mathrm{nm}^2 / \\mathrm{ps} = 10^{-6}\\ \\mathrm{m}^2 / \\mathrm{s}$。\n\n编写一个程序，对于下面的每个测试案例，通过线性拟合计算 $D_L$，然后使用 Yeh–Hummer 校正计算 $D_{\\infty}$。报告最终的 $D_{\\infty}$ 值，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，并四舍五入到六位有效数字。\n\n测试套件（每个案例都是独立的）：\n\n案例 1：\n- $T = 300\\ \\mathrm{K}$，$\\eta = 0.00089\\ \\mathrm{Pa\\,s}$，$L = 1.5\\ \\mathrm{nm}$。\n- $t\\ \\mathrm{(ps)} = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]$。\n- $\\langle \\Delta r^2 \\rangle\\ \\mathrm{(nm^2)} = [0.0, 0.0072, 0.0144, 0.0216, 0.0288, 0.0360, 0.0432, 0.0504, 0.0576, 0.0648, 0.0720]$。\n- 拟合区间：$t_{\\min} = 0\\ \\mathrm{ps}$，$t_{\\max} = 10\\ \\mathrm{ps}$。\n\n案例 2：\n- $T = 300\\ \\mathrm{K}$，$\\eta = 0.00089\\ \\mathrm{Pa\\,s}$，$L = 1.0\\ \\mathrm{nm}$。\n- $t\\ \\mathrm{(ps)} = [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0]$。\n- $\\langle \\Delta r^2 \\rangle\\ \\mathrm{(nm^2)} = [0.0, 0.0036, 0.0072, 0.0108, 0.0144, 0.0180, 0.0216]$。\n- 拟合区间：$t_{\\min} = 0.0\\ \\mathrm{ps}$，$t_{\\max} = 3.0\\ \\mathrm{ps}$。\n\n案例 3：\n- $T = 300\\ \\mathrm{K}$，$\\eta = 0.00089\\ \\mathrm{Pa\\,s}$，$L = 6.0\\ \\mathrm{nm}$。\n- $t\\ \\mathrm{(ps)} = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]$。\n- $\\langle \\Delta r^2 \\rangle\\ \\mathrm{(nm^2)} = [0.0, 0.0072, 0.0144, 0.0216, 0.0288, 0.0360, 0.0432, 0.0504, 0.0576, 0.0648, 0.0720]$。\n- 拟合区间：$t_{\\min} = 0\\ \\mathrm{ps}$，$t_{\\max} = 10\\ \\mathrm{ps}$。\n\n案例 4：\n- $T = 320\\ \\mathrm{K}$，$\\eta = 0.00065\\ \\mathrm{Pa\\,s}$，$L = 2.0\\ \\mathrm{nm}$。\n- $t\\ \\mathrm{(ps)} = [0.0, 2.0, 4.0, 6.0, 8.0]$。\n- $\\langle \\Delta r^2 \\rangle\\ \\mathrm{(nm^2)} = [0.0, 0.0096, 0.0192, 0.0288, 0.0384]$。\n- 拟合区间：$t_{\\min} = 0.0\\ \\mathrm{ps}$，$t_{\\max} = 8.0\\ \\mathrm{ps}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含案例 1 到 4 的 $D_{\\infty}$ 值的逗号分隔列表，按顺序排列，用方括号括起来，每个数字四舍五入到六位有效数字，例如 $[a,b,c,d]$，其中 $a$、$b$、$c$ 和 $d$ 是单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 的浮点数。",
            "solution": "我们从第一性原理出发。对于三维空间中的布朗运动，扩散系数 $D$ 由爱因斯坦关系式定义，\n$$\nD \\equiv \\lim_{t \\to \\infty} \\frac{1}{6}\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\Delta r(t)^2 \\rangle,\n$$\n其中 $\\langle \\Delta r(t)^2 \\rangle$ 是粒子的均方根位移 (MSD)。在实践中，在一个时间区间内，如果 MSD 与 $t$ 呈线性关系（扩散区域），则 MSD 可以建模为线性函数，\n$$\n\\langle \\Delta r(t)^2 \\rangle \\approx s\\, t + b,\n$$\n其斜率为 $s$，截距为 $b$。那么，有限系统扩散系数 $D_L$ 为\n$$\nD_L = \\frac{s}{6}.\n$$\n因为给定的时间 $t$ 单位是皮秒，MSD 值的单位是平方纳米，所以计算出的 $s/6$ 的 $D_L$ 单位将是 $\\mathrm{nm}^2/\\mathrm{ps}$。要将 $D_L$ 转换为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，精确的单位转换是\n$$\n1\\ \\frac{\\mathrm{nm}^2}{\\mathrm{ps}} = 10^{-6}\\ \\frac{\\mathrm{m}^2}{\\mathrm{s}},\n$$\n所以\n$$\nD_L\\ \\big[\\mathrm{m}^2\\,\\mathrm{s}^{-1}\\big] = \\frac{s}{6} \\times 10^{-6}.\n$$\n\n在边长为 $L$ 的立方晶胞的周期性边界条件下，流体动力学相互作用会导致有限尺寸偏差。Yeh–Hummer 校正给出了有限系统扩散系数 $D_L$ 与无限系统系数 $D_{\\infty}$ 之间的领头阶关系，\n$$\nD_{\\infty} = D_L + \\frac{k_{\\mathrm{B}} T \\,\\xi}{6\\pi \\eta L},\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，$\\eta$ 是剪切粘度，对于立方周期性边界条件，$\\xi \\approx 2.837297$。在此公式中，$L$ 必须以米为单位，$\\eta$ 以 $\\mathrm{Pa\\,s}$ 为单位，$T$ 以 $\\mathrm{K}$ 为单位，$k_{\\mathrm{B}}$ 以 $\\mathrm{J\\,K^{-1}}$ 为单位，这样计算出的校正项单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n\n根据这些原理为每个案例推导出的算法步骤：\n1. 选择指定拟合区间 $[t_{\\min}, t_{\\max}]$ 内的时间 $t$ 对应的数据点。\n2. 对 $\\langle \\Delta r^2 \\rangle$ 与 $t$ 进行最小二乘线性拟合，以获得单位为 $\\mathrm{nm}^2/\\mathrm{ps}$ 的斜率 $s$。\n3. 使用 $D_L = (s/6)\\times 10^{-6}$ 计算单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 的 $D_L$。\n4. 使用 $L_{\\mathrm{m}} = L \\times 10^{-9}$ 将盒子长度 $L$ 从 $\\mathrm{nm}$ 转换为 $\\mathrm{m}$。\n5. 计算 Yeh–Hummer 校正项，\n$$\n\\Delta D = \\frac{k_{\\mathrm{B}} T \\,\\xi}{6\\pi \\eta L_{\\mathrm{m}}}.\n$$\n6. 计算 $D_{\\infty} = D_L + \\Delta D$。\n7. 将 $D_{\\infty}$ 四舍五入到六位有效数字，并以 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 为单位报告。\n\n将此方法应用于测试套件：\n- 在案例 1、2 和 3 中，MSD 序列是完全线性的，斜率 $s = 0.0072\\ \\mathrm{nm}^2/\\mathrm{ps}$，对应 $D_L = (0.0072/6)\\times 10^{-6} = 1.2\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。由于 $L$ 值不同，有限尺寸校正也不同：较小的 $L$ 会增加校正值，较大的 $L$ 会减小校正值。具体来说，在固定的 $T$ 和 $\\eta$ 下，校正值与 $1/L$ 成正比。\n- 在案例 4 中，MSD 是线性的，斜率 $s = 0.0048\\ \\mathrm{nm}^2/\\mathrm{ps}$，校正前得到 $D_L = 0.8\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。根据公式，校正值随 $T$ 的增加而增加，随 $\\eta$ 和 $L$ 的增加而减少。\n\n程序将使用最小二乘法实现线性回归，应用精确的单位转换和常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$ 及 $\\xi = 2.837297$，并按要求的格式将四个校正后的扩散系数 $D_{\\infty}$ 作为单行列表打印出来。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_d_infinity(t_ps, msd_nm2, tmin_ps, tmax_ps, T_K, eta_Pa_s, L_nm):\n    # Select data within the fit interval [tmin_ps, tmax_ps]\n    t = np.array(t_ps, dtype=float)\n    msd = np.array(msd_nm2, dtype=float)\n    mask = (t >= tmin_ps)  (t = tmax_ps)\n    t_fit = t[mask]\n    msd_fit = msd[mask]\n\n    # Linear least squares fit: msd = slope * t + intercept\n    # slope has units of nm^2/ps\n    slope, intercept = np.polyfit(t_fit, msd_fit, 1)\n\n    # Convert slope to D_L: D_L = (slope / 6) * 1e-6  [m^2/s]\n    D_L = (slope / 6.0) * 1e-6  # m^2/s\n\n    # Yeh–Hummer correction: D_inf = D_L + kB * T * xi / (6 * pi * eta * L)\n    kB = 1.380649e-23  # J/K\n    xi = 2.837297\n    pi = np.pi\n    L_m = L_nm * 1e-9  # convert nm to m\n\n    correction = kB * T_K * xi / (6.0 * pi * eta_Pa_s * L_m)  # m^2/s\n\n    D_inf = D_L + correction\n    return D_inf\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"T_K\": 300.0,\n            \"eta_Pa_s\": 0.00089,\n            \"L_nm\": 1.5,\n            \"t_ps\": [0,1,2,3,4,5,6,7,8,9,10],\n            \"msd_nm2\": [0.0,0.0072,0.0144,0.0216,0.0288,0.0360,0.0432,0.0504,0.0576,0.0648,0.0720],\n            \"tmin_ps\": 0.0,\n            \"tmax_ps\": 10.0\n        },\n        # Case 2\n        {\n            \"T_K\": 300.0,\n            \"eta_Pa_s\": 0.00089,\n            \"L_nm\": 1.0,\n            \"t_ps\": [0.0,0.5,1.0,1.5,2.0,2.5,3.0],\n            \"msd_nm2\": [0.0,0.0036,0.0072,0.0108,0.0144,0.0180,0.0216],\n            \"tmin_ps\": 0.0,\n            \"tmax_ps\": 3.0\n        },\n        # Case 3\n        {\n            \"T_K\": 300.0,\n            \"eta_Pa_s\": 0.00089,\n            \"L_nm\": 6.0,\n            \"t_ps\": [0,1,2,3,4,5,6,7,8,9,10],\n            \"msd_nm2\": [0.0,0.0072,0.0144,0.0216,0.0288,0.0360,0.0432,0.0504,0.0576,0.0648,0.0720],\n            \"tmin_ps\": 0.0,\n            \"tmax_ps\": 10.0\n        },\n        # Case 4\n        {\n            \"T_K\": 320.0,\n            \"eta_Pa_s\": 0.00065,\n            \"L_nm\": 2.0,\n            \"t_ps\": [0.0,2.0,4.0,6.0,8.0],\n            \"msd_nm2\": [0.0,0.0096,0.0192,0.0288,0.0384],\n            \"tmin_ps\": 0.0,\n            \"tmax_ps\": 8.0\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        D_inf = compute_d_infinity(\n            t_ps=case[\"t_ps\"],\n            msd_nm2=case[\"msd_nm2\"],\n            tmin_ps=case[\"tmin_ps\"],\n            tmax_ps=case[\"tmax_ps\"],\n            T_K=case[\"T_K\"],\n            eta_Pa_s=case[\"eta_Pa_s\"],\n            L_nm=case[\"L_nm\"]\n        )\n        results.append(D_inf)\n\n    # Round to six significant figures for output formatting\n    formatted = [f\"{val:.6g}\" for val in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted)}]\")\n\nsolve()\n```"
        }
    ]
}