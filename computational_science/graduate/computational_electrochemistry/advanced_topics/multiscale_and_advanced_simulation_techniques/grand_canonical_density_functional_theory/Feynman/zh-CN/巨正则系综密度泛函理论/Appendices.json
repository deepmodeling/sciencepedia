{
    "hands_on_practices": [
        {
            "introduction": "在大正则密度泛函理论 (GC-DFT) 中，恒定电势下的建模能力源于大正则系综的统计力学原理。第一个练习  将我们带回这些统计力学的基础。通过分析一个简单的非相互作用电子系统，我们将从第一性原理推导出平均电子数是如何由化学势和温度决定的，从而揭示著名的费米-狄拉克分布的起源。",
            "id": "4247272",
            "problem": "在巨正则密度泛函理论 (GC-DFT) 中，固定化学势 $\\mu$ 和温度 $T$ 下的平衡电子态是通过最小化巨势泛函得到的，这在微观上对应于对巨正则系综的采样，其中电子可以与一个粒子库进行交换。考虑一个由两组单电子能级组成的无相互作用的 Kohn–Sham 系统，其能量分别为 $\\epsilon_{1}$ 和 $\\epsilon_{2}$，轨道简并度分别为 $g_{1}$ 和 $g_{2}$。电子遵循费米-狄拉克统计，每个单电子能级要么未被占据，要么被单占据。\n\n从巨正则系综的定义出发，即巨配分函数是 $\\exp\\!\\big(-\\beta(\\hat{H}-\\mu \\hat{N})\\big)$ 在多电子态上的迹，其中 $\\beta = 1/(k_{B} T)$，并且期望粒子数通过 $\\langle N \\rangle = -\\partial \\Omega / \\partial \\mu$ 与巨势 $\\Omega = -\\frac{1}{\\beta} \\ln \\Xi$ 相关联，推导这个双能级无相互作用系统的平均电子数 $\\langle N \\rangle(\\mu, T)$ 的闭合形式表达式，用 $\\mu$、$T$、$\\epsilon_{1}$、$\\epsilon_{2}$、$g_{1}$、$g_{2}$ 和玻尔兹曼常数 $k_{B}$ 表示。将你的最终答案表示为 $\\langle N \\rangle(\\mu, T)$ 的单个解析表达式。无需四舍五入。",
            "solution": "问题要求在巨正则系综的框架内，为一个具有两组简并单电子能级的无相互作用系统推导平均电子数 $\\langle N \\rangle$。推导从巨配分函数 $\\Xi$、巨势 $\\Omega$ 和平均粒子数 $\\langle N \\rangle$ 的基本定义开始。\n\n设系统处于固定的化学势 $\\mu$ 和温度 $T$ 下。逆温度由 $\\beta = 1/(k_B T)$ 给出，其中 $k_B$ 是玻尔兹曼常数。\n\n该系统由无相互作用的电子组成，它们遵循费米-狄拉克统计。问题指出，每个单电子能级要么未被占据，要么被单占据。这是费米子泡利不相容原理的直接结果。\n\n首先，我们确定能量为 $\\epsilon$ 的单个非简并单电子能级的巨配分函数。一个能级可以处于两种状态之一：\n1.  未占据：粒子数为 $N=0$，能量为 $E=0$。对配分函数的贡献是 $\\exp\\big(-\\beta(E - \\mu N)\\big) = \\exp\\big(-\\beta(0 - \\mu \\cdot 0)\\big) = 1$。\n2.  已占据：粒子数为 $N=1$，能量为 $E=\\epsilon$。对配分函数的贡献是 $\\exp\\big(-\\beta(E - \\mu N)\\big) = \\exp\\big(-\\beta(\\epsilon - \\mu \\cdot 1)\\big) = \\exp\\big(-\\beta(\\epsilon - \\mu)\\big)$。\n\n这个单能级的巨配分函数（我们记为 $\\xi$）是这些贡献的总和：\n$$\n\\xi = 1 + \\exp\\big(-\\beta(\\epsilon - \\mu)\\big)\n$$\n\n问题中描述的系统有两组能级。第一组能量为 $\\epsilon_1$，简并度为 $g_1$。这意味着有 $g_1$ 个不同且独立的单电子轨道都处于相同的能量 $\\epsilon_1$。由于轨道是独立的（无相互作用粒子近似的结果），这组能级的巨配分函数 $\\Xi_1$ 是 $g_1$ 个轨道各自配分函数的乘积。\n$$\n\\Xi_1 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1}\n$$\n类似地，对于能量为 $\\epsilon_2$、简并度为 $g_2$ 的第二组能级，其巨配分函数为：\n$$\n\\Xi_2 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2}\n$$\n\n整个系统的总巨配分函数 $\\Xi$ 是这两组独立能级配分函数的乘积：\n$$\n\\Xi = \\Xi_1 \\Xi_2 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1} \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2}\n$$\n\n接下来，我们计算巨势 $\\Omega$，它与巨配分函数的关系为 $\\Omega = -\\frac{1}{\\beta} \\ln \\Xi$：\n$$\n\\Omega = -\\frac{1}{\\beta} \\ln \\left[ \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1} \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2} \\right]\n$$\n使用对数的性质 $\\ln(ab) = \\ln(a) + \\ln(b)$ 和 $\\ln(x^y) = y\\ln(x)$，我们可以简化 $\\Omega$ 的表达式：\n$$\n\\Omega = -\\frac{1}{\\beta} \\left[ g_1 \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big) + g_2 \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big) \\right]\n$$\n\n平均电子数 $\\langle N \\rangle$ 是通过在恒定温度 $T$ 和体积（这意味着能级 $\\epsilon_j$ 恒定）下，取巨势对化学势 $\\mu$ 的负偏导数得到的。\n$$\n\\langle N \\rangle = -\\frac{\\partial \\Omega}{\\partial \\mu}\n$$\n我们可以逐项求导：\n$$\n\\langle N \\rangle = -\\frac{\\partial}{\\partial \\mu} \\left( -\\frac{g_1}{\\beta} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big) \\right) - \\frac{\\partial}{\\partial \\mu} \\left( -\\frac{g_2}{\\beta} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big) \\right)\n$$\n让我们计算一个具有能量 $\\epsilon_j$ 和简并度 $g_j$ 的通用项的导数：\n$$\n\\langle N_j \\rangle = \\frac{g_j}{\\beta} \\frac{\\partial}{\\partial \\mu} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\\big)\n$$\n使用链式法则，其中 $u = 1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)$：\n$$\n\\frac{\\partial}{\\partial \\mu} \\ln(u) = \\frac{1}{u} \\frac{\\partial u}{\\partial \\mu}\n$$\n对数参数关于 $\\mu$ 的导数是：\n$$\n\\frac{\\partial}{\\partial \\mu} \\left( 1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\right) = \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\cdot \\frac{\\partial}{\\partial \\mu}\\big(-\\beta\\epsilon_j + \\beta\\mu\\big) = \\beta \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\n$$\n将此代回 $\\langle N_j \\rangle$ 的表达式中：\n$$\n\\langle N_j \\rangle = \\frac{g_j}{\\beta} \\left( \\frac{1}{1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)} \\right) \\left( \\beta \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\right)\n$$\n因子 $\\beta$ 消掉了：\n$$\n\\langle N_j \\rangle = g_j \\frac{\\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)}{1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)}\n$$\n为了得到费米-狄拉克分布的标准形式，我们将分子和分母同乘以 $\\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)$：\n$$\n\\langle N_j \\rangle = g_j \\frac{\\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\cdot \\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)}{\\big(1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\\big) \\cdot \\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)} = g_j \\frac{1}{\\exp\\big(\\beta(\\epsilon_j - \\mu)\\big) + 1}\n$$\n这就是著名的费米-狄拉克分布函数，表示能量为 $\\epsilon_j$ 的态的平均占据数，再乘以简并度 $g_j$。\n\n总平均电子数 $\\langle N \\rangle$ 是两组能级平均占据数的总和：\n$$\n\\langle N \\rangle = \\langle N_1 \\rangle + \\langle N_2 \\rangle = g_1 \\frac{1}{1 + \\exp\\big(\\beta(\\epsilon_1 - \\mu)\\big)} + g_2 \\frac{1}{1 + \\exp\\big(\\beta(\\epsilon_2 - \\mu)\\big)}\n$$\n最后，代入 $\\beta = 1/(k_B T)$，我们得到 $\\langle N \\rangle(\\mu, T)$ 的最终闭合形式表达式：\n$$\n\\langle N \\rangle(\\mu, T) = \\frac{g_1}{1 + \\exp\\left(\\frac{\\epsilon_1 - \\mu}{k_B T}\\right)} + \\frac{g_2}{1 + \\exp\\left(\\frac{\\epsilon_2 - \\mu}{k_B T}\\right)}\n$$\n这个表达式代表了系统中总的平均电子数，是两组简并能级平均占据数的总和，与无相互作用费米子的统计力学原理一致。",
            "answer": "$$\n\\boxed{\\frac{g_1}{1 + \\exp\\left(\\frac{\\epsilon_1 - \\mu}{k_B T}\\right)} + \\frac{g_2}{1 + \\exp\\left(\\frac{\\epsilon_2 - \\mu}{k_B T}\\right)}}\n$$"
        },
        {
            "introduction": "在建立了统计基础之后，我们现在将重点转向电化学的宏观热力学语言。虽然实验控制的是电极电势 $\\Phi$，但标准的DFT计算通常是在固定的电子数（固定电荷 $Q$）下进行的。这个练习  使用勒让德变换这一基本工具来连接这两种描述，演示了如何构建巨势——固定电势下体系的关键热力学量。",
            "id": "4247253",
            "problem": "在巨正则密度泛函理论 (GC-DFT) 中，电化学环境中的电极与一个固定电极电势 $\\Phi$ 的电子库交换电子，而电极上的总电荷 $Q$ 会自洽地调整。考虑一个模型电化学界面，其微分响应由一个不依赖于 $Q$ 和 $\\Phi$ 的恒定电容 $C$ 表征。系统在温度 $T$ 下是等温的，并且机械功和非静电贡献可以忽略不计。从为界面充电所需的可逆功出发，推导从 $Q=0$ 充电到有限电荷 $Q$ 时的亥姆霍兹自由能变化 $A(Q)$。然后，仅使用支配共轭变量的基本热力学原理和适当的勒让德变换，构建适用于固定 $\\Phi$ 的热力学势，并通过对 $Q$ 进行最小化来获得其平衡值。最后，计算在固定 $\\Phi$ 下相对于不带电状态的自由能变化。请将最终答案表示为关于 $C$ 和 $\\Phi$ 的单个闭式解析表达式。",
            "solution": "首先根据所需标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **系统**：电化学环境中的一个电极。\n- **系综描述**：电极与一个电子库交换电子，将电极电势固定在 $\\Phi$。电极上的总电荷 $Q$ 是一个自洽调整的涨落变量。这对应于电荷的巨正则系综。\n- **系统性质**：微分响应由一个恒定电容 $C$ 表征，该电容不依赖于电荷 $Q$ 和电势 $\\Phi$。\n- **热力学条件**：系统在温度 $T$ 下是等温的。机械功和对能量的非静电贡献可以忽略。\n- **目标**：\n    1. 推导界面从 $Q=0$ 充电到最终电荷 $Q$ 时的亥姆霍兹自由能变化 $A(Q)$。\n    2. 通过勒让德变换，构建适用于固定电势 $\\Phi$ 系统的热力学势。\n    3. 通过对 $Q$ 进行最小化，求出该势的平衡值。\n    4. 计算在固定 $\\Phi$ 下相对于不带电状态 ($\\Phi=0$) 的最终自由能变化。\n- **最终答案格式**：一个关于 $C$ 和 $\\Phi$ 的单个闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它提出了电化学界面热力学中的一个标准、基本问题，这是计算电化学和 GC-DFT 的核心概念。恒定电容模型是一种有效且常见的物理近似（例如，简单的平行板电容器）。使用勒让德变换和最小化原理的指令是统计力学和热力学中的标准程序。该问题内容完整，没有矛盾或信息缺失。\n\n### 步骤 3：结论与行动\n该问题有效。将提供一个完整的、附有推理的解答。\n\n### 解答推导\n\n解答过程如问题陈述中所概述，分为四个逻辑步骤。\n\n**1. 亥姆霍兹自由能 $A(Q)$ 的推导**\n\n将无穷小量的电荷 $dq$ 添加到电势为 $\\phi(q)$ 的电极上所需的可逆电功 $dW_{elec}$ 由下式给出：\n$$dW_{elec} = \\phi(q) dq$$\n在恒定温度 $T$ 和恒定体积（或如题所设，可忽略的机械功）的条件下，此可逆功等于亥姆霍兹自由能的变化量 $dA$。\n$$dA = dW_{elec} = \\phi(q) dq$$\n问题指出，该界面由一个恒定电容 $C$ 表征。电容器上的电荷 $q$、其电势 $\\phi(q)$ 和电容 $C$ 之间的关系是：\n$$\\phi(q) = \\frac{q}{C}$$\n为了求出将电极从零电荷的初始状态 ($Q=0$) 充电到带电荷 $Q$ 的最终状态时亥姆霍兹自由能的总变化量 $\\Delta A$，我们必须将 $dA$ 从 $q=0$ 积分到 $q=Q$：\n$$\\Delta A = A(Q) - A(0) = \\int_0^Q \\phi(q) dq$$\n代入 $\\phi(q)$ 的表达式：\n$$\\Delta A = \\int_0^Q \\frac{q}{C} dq$$\n由于 $C$ 是一个常数，可以将其从积分中提出：\n$$\\Delta A = \\frac{1}{C} \\int_0^Q q dq = \\frac{1}{C} \\left[ \\frac{q^2}{2} \\right]_0^Q = \\frac{1}{C} \\left( \\frac{Q^2}{2} - 0 \\right) = \\frac{Q^2}{2C}$$\n通过将不带电状态的亥姆霍兹自由能设为参考零点，$A(0)=0$，亥姆霍兹自由能作为电荷的函数为：\n$$A(Q) = \\frac{Q^2}{2C}$$\n\n**2. 适用于固定电势 $\\Phi$ 的热力学势的构建**\n\n亥姆霍兹自由能 $A(Q)$ 是电荷 $Q$ 为固定状态变量的系统的自然势。本问题要求我们考虑一个系统，其中电势 $\\Phi$ 由一个电子库固定，而电荷 $Q$ 是达到平衡值的涨落变量。这种从自变量 $Q$ 到其共轭变量 $\\Phi$ 的转换是通过勒让德变换完成的。\n\n亥姆霍兹自由能的微分是 $dA = -SdT + \\dots + \\Phi dQ$，其中电势 $\\Phi$ 是电荷 $Q$ 的共轭变量。对于我们的等温且机械功可忽略的系统，这简化为 $dA = \\Phi dQ$。\n\n适用于固定 $\\Phi$ 的热力学势，在电化学背景下称为巨势，定义为：\n$$\\Omega = A - \\Phi Q$$\n这个新的势 $\\Omega$ 在平衡时将是 $\\Phi$ 的函数。\n\n**3. 巨势的最小化与平衡值**\n\n为了找到系统在固定外电势 $\\Phi$ 下的平衡态，我们必须找到使巨势 $\\Omega$ 最小化的电荷值 $Q_{eq}$。我们将 $\\Omega$ 视为在给定电子库电势 $\\Phi$ 下，涨落变量 $Q$ 的函数：\n$$\\Omega(Q; \\Phi) = A(Q) - \\Phi Q = \\frac{Q^2}{2C} - \\Phi Q$$\n平衡条件通过将 $\\Omega$ 对 $Q$ 的导数设为零来找到：\n$$\\frac{\\partial \\Omega}{\\partial Q} = \\frac{\\partial}{\\partial Q} \\left( \\frac{Q^2}{2C} - \\Phi Q \\right) = \\frac{2Q}{2C} - \\Phi = \\frac{Q}{C} - \\Phi$$\n将此导数设为零，得到平衡电荷 $Q_{eq}$：\n$$\\frac{Q_{eq}}{C} - \\Phi = 0 \\implies Q_{eq} = C\\Phi$$\n为确认这是一个最小值，我们检查二阶导数：\n$$\\frac{\\partial^2 \\Omega}{\\partial Q^2} = \\frac{1}{C}$$\n由于对于稳定系统，电容 $C$ 必须为正值，所以二阶导数为正，这证实了 $Q_{eq} = C\\Phi$ 对应于巨势的最小值。\n\n现在，我们将平衡电荷 $Q_{eq}$ 代入 $\\Omega$ 的表达式中，以求其平衡值 $\\Omega_{eq}(\\Phi)$：\n$$\\Omega_{eq}(\\Phi) = \\frac{(Q_{eq})^2}{2C} - \\Phi Q_{eq} = \\frac{(C\\Phi)^2}{2C} - \\Phi(C\\Phi)$$\n$$\\Omega_{eq}(\\Phi) = \\frac{C^2\\Phi^2}{2C} - C\\Phi^2 = \\frac{1}{2}C\\Phi^2 - C\\Phi^2 = -\\frac{1}{2}C\\Phi^2$$\n\n**4. 相对于不带电状态的自由能变化**\n\n最后一步是计算在固定电势 $\\Phi$ 下相对于不带电状态的自由能变化。巨势 $\\Omega_{eq}(\\Phi)$ 代表系统与电势为 $\\Phi$ 的电子库达到平衡时的自由能。“不带电状态”对应于电子库电势 $\\Phi=0$。\n\n自由能变化 $\\Delta\\Omega$ 是电势为 $\\Phi$ 时的巨势与电势为 $\\Phi=0$ 时的巨势之差：\n$$\\Delta\\Omega = \\Omega_{eq}(\\Phi) - \\Omega_{eq}(0)$$\n我们有平衡巨势的表达式：\n$$\\Omega_{eq}(\\Phi) = -\\frac{1}{2}C\\Phi^2$$\n对于不带电状态，我们设 $\\Phi=0$：\n$$\\Omega_{eq}(0) = -\\frac{1}{2}C(0)^2 = 0$$\n因此，自由能变化为：\n$$\\Delta\\Omega = -\\frac{1}{2}C\\Phi^2 - 0 = -\\frac{1}{2}C\\Phi^2$$\n这就是最终所需的表达式。它代表了从巨正则系综的角度看，在电势 $\\Phi$ 下储存在电化学双电层中的能量。",
            "answer": "$$\\boxed{-\\frac{C\\Phi^2}{2}}$$"
        },
        {
            "introduction": "理论和热力学框架就位后，我们现在可以解决一个模拟真实计算电化学工作流程的实践问题。这个练习  要求你确定电极-电解质界面最重要的性质之一：零电荷电势 (PZC)。你将把 PZC 与功函数等基本材料性质联系起来，然后实现一个数值算法，从模拟的GC-DFT数据中提取它。",
            "id": "4247281",
            "problem": "考虑一个使用大正则密度泛函理论 (GC-DFT) 研究的电极-电解质界面，其中电子库固定了电极电势 $\\,\\Phi\\,$ 和电子化学势 $\\,\\mu_e\\,$。在温度 $\\,T\\,$ 下，大正则密度泛函理论 (GC-DFT) 的巨势 $\\,\\Omega\\,$ 可以用电子数 $\\,N_e\\,$、离子物种数 $\\,\\{N_\\alpha\\}\\,$ 以及相应的化学势 $\\,\\mu_e\\,$ 和 $\\,\\{\\mu_\\alpha\\}\\,$ 来表示。在此框架中，电极表面电荷密度 $\\,\\sigma(\\Phi)\\,$ 是通过电子密度的自洽解得到的，并且是外加电极电势 $\\,\\Phi\\,$ 的函数。零电荷电势 (PZC) 定义为使 $\\,\\sigma(\\Phi_{\\mathrm{PZC}})=0\\,$ 成立的电极电势 $\\,\\Phi_{\\mathrm{PZC}}\\,$。\n\n仅从巨正则系综和静电学的基本原理出发，并且不使用任何快捷公式：\n- 利用电极电势 $\\,\\Phi\\,$ 和电子数 $\\,N_e\\,$ 之间的共轭变量关系，解释为什么在 GC-DFT 中 $\\,\\mu_e\\,$ 线性依赖于 $\\,\\Phi\\,$。阐明条件 $\\,\\sigma(\\Phi)=0\\,$ 对界面的物理意义。\n- 然后，从第一性原理出发，在绝对真空参考电势标度上推导一个表达式，将 $\\,\\Phi_{\\mathrm{PZC}}\\,$ 与金属功函数 $\\,W\\,$（单位为电子伏特）和溶剂界面偶极电势 $\\,\\Delta \\phi_{\\mathrm{dip}}\\,$（单位为伏特）联系起来。清晰地说明将 $\\,W\\,$ 的单位电子伏特与伏特关联所需的单位换算。不要引入任何经验性的电极标度偏移；保持在参考真空的绝对标度上。\n\n算法任务：\n- 给定离散化的大正则密度泛函理论 (GC-DFT) 输出：电势数组 $\\,\\{\\Phi_i\\}\\,$（单位为伏特）和相应的计算出的表面电荷密度 $\\,\\{\\sigma(\\Phi_i)\\}\\,$（单位为一致的电荷/面积单位）。实现一个鲁棒的数值程序，通过寻找 $\\,\\sigma(\\Phi)\\,$ 的根来找到 $\\,\\Phi_{\\mathrm{PZC}}\\,$。你的方法必须：\n  1. 检测是否存在某个 $\\,\\sigma(\\Phi_i)\\,$ 精确为零，并返回对应的 $\\,\\Phi_i\\,$。\n  2. 如果相邻点 $\\,(\\Phi_i,\\sigma_i)\\,$ 和 $\\,(\\Phi_{i+1},\\sigma_{i+1})\\,$ 之间存在符号变化，则执行线性插值来近似该区间内的根。\n  3. 如果没有精确零点或符号变化，则返回 $\\,|\\sigma|\\,$ 最小时的电势，并在可能的情况下，通过与其最近邻点进行局部线性插值来优化结果。\n- 同时，根据你推导的表达式计算理论上的 $\\,\\Phi_{\\mathrm{PZC}}\\,$，该表达式将其与 $\\,W\\,$ 和 $\\,\\Delta \\phi_{\\mathrm{dip}}\\,$ 相关联。最后，计算数值确定的 $\\,\\Phi_{\\mathrm{PZC}}\\,$ 与理论上的 $\\,\\Phi_{\\mathrm{PZC}}\\,$ 之间的差值。\n\n单位与输出规范：\n- 所有电势均以伏特 (V) 表示。\n- 所有报告的电势和差值均四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\Phi_{\\mathrm{PZC}}^{(1)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(1)},\\Delta^{(1)},\\Phi_{\\mathrm{PZC}}^{(2)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(2)},\\Delta^{(2)},\\dots]$，其中 $\\,\\Delta^{(k)}\\,$ 是测试用例 $\\,k\\,$ 的数值PZC与理论PZC之间的差值。\n\n测试套件：\n使用以下四个科学上合理的测试用例，每个用例都在绝对真空参考电势标度上定义。对于每个用例，电势 $\\,\\{\\Phi_i\\}\\,$ 的单位是伏特，功函数 $\\,W\\,$ 的单位是电子伏特，而 $\\,\\Delta \\phi_{\\mathrm{dip}}\\,$ 的单位是伏特。\n\n- 用例 1 (单调线性 $\\,\\sigma(\\Phi)\\,$ 穿越零点):\n  - $\\,\\{\\Phi_i\\} = [-0.2, 0.0, 0.2, 0.4, 0.6]\\,$\n  - 定义 $\\,\\sigma(\\Phi) = C\\,(\\Phi - \\Phi_0)\\,$，其中 $\\,C = 0.4\\,$（单位为一致的电荷/面积/伏特）且 $\\,\\Phi_0 = 0.2\\,\\mathrm{V}\\,$.\n  - $\\,W = 5.1\\,\\mathrm{eV}\\,$, $\\,\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}\\,$.\n\n- 用例 2 (格点上存在精确零点):\n  - $\\,\\{\\Phi_i\\} = [-0.5, 0.0, 0.5]\\,$\n  - 定义 $\\,\\sigma(\\Phi) = C\\,(\\Phi - \\Phi_0)\\,$，其中 $\\,C = 0.3\\,$ 且 $\\,\\Phi_0 = 0.0\\,\\mathrm{V}\\,$.\n  - $\\,W = 4.9\\,\\mathrm{eV}\\,$, $\\,\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}\\,$.\n\n- 用例 3 (零电荷附近的非线性三次响应):\n  - $\\,\\{\\Phi_i\\} = [-0.3, -0.1, 0.1, 0.3, 0.5]\\,$\n  - 定义 $\\,\\sigma(\\Phi) = a\\,(\\Phi - \\Phi_0) + b\\,(\\Phi - \\Phi_0)^3\\,$，其中 $\\,a = 0.5\\,$， $\\,b = 0.2\\,$ 且 $\\,\\Phi_0 = 0.1\\,\\mathrm{V}\\,$.\n  - $\\,W = 5.0\\,\\mathrm{eV}\\,$, $\\,\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}\\,$.\n\n- 用例 4 (边界处为零点):\n  - $\\,\\{\\Phi_i\\} = [0.0, 0.2, 0.4]\\,$\n  - 定义 $\\,\\sigma(\\Phi) = C\\,(\\Phi - \\Phi_0)\\,$，其中 $\\,C = 0.1\\,$ 且 $\\,\\Phi_0 = 0.0\\,\\mathrm{V}\\,$.\n  - $\\,W = 5.0\\,\\mathrm{eV}\\,$, $\\,\\Delta \\phi_{\\mathrm{dip}} = 5.0\\,\\mathrm{V}\\,$.\n\n你的任务是按规定实现 $\\,\\sigma(\\Phi)\\,$ 的数值求根，从第一性原理推导出的 $\\,W\\,$ 和 $\\,\\Delta \\phi_{\\mathrm{dip}}\\,$ 计算理论上的绝对标度 $\\,\\Phi_{\\mathrm{PZC}}\\,$，并以单行形式输出有序列表 $[\\Phi_{\\mathrm{PZC}}^{(1)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(1)},\\Delta^{(1)},\\dots]$，单位为伏特，每个值都四舍五入到六位小数。",
            "solution": "该问题被验证为具有科学依据、提法恰当且客观。它基于大正则密度泛函理论 (GC-DFT) 框架内计算电化学的标准原理。所提供的数据和函数形式在一种特定的、可推导的符号约定下是内部一致且物理上合理的。算法任务定义明确。\n\n在此，我们首先提供零电荷电势 ($\\Phi_{\\mathrm{PZC}}$)、金属功函数 ($W$) 和界面偶极电势 ($\\Delta\\phi_{\\mathrm{dip}}$) 之间关系的理论推导。然后，我们概述将要实现的数值程序。\n\n### 理论推导\n\n#### 1. $\\mu_e$ 与 $\\Phi$ 的关系及零电荷的意义\n\n在巨正则系综中，系统（一个电极）与一个粒子库处于平衡状态，在此情况下，该粒子库是电子库。该电子库由电子化学势 $\\mu_e$ 来表征。在绝对真空参考标度上，电极电势 $\\Phi$ 是电极的静电势。将一个电荷为 $-e$（其中 $e$ 是元正电荷）的电子从静止的真空中（电势定义为 $0$）带入电势为 $\\Phi$ 的电极中所需的功为 $(-e)\\Phi$。\n\n电子化学势 $\\mu_e$ 表示向系统中添加一个电子时的总能量变化（吉布斯自由能变化）。它由化学（内在）部分和静电部分组成。在电势保持为 $\\Phi$ 的电极背景下，处于费米能级 ($E_F$) 的电子的能量正是电子化学势 $\\mu_e$。该能量会因静电势 $\\Phi$ 而发生移动。恒电势计算方法中的标准约定将此关系定义为：\n$$\n\\mu_e = -e\\Phi\n$$\n此方程表明，电子化学势 $\\mu_e$ 线性依赖于电极电势 $\\Phi$。改变电极电势 $\\Phi$ 完全等同于改变与电极达到平衡的电子库的化学势 $\\mu_e$。\n\n表面电荷密度 $\\sigma(\\Phi)$ 是电极表面的单位面积净电荷。它源于表面区域内电子总电荷与原子核总电荷之间的不平衡。条件 $\\sigma(\\Phi) = 0$ 意味着电极表面是电中性的。在这个特定的电势，即零电荷电势 ($\\Phi_{\\mathrm{PZC}}$)下，电子电荷与界面处金属原子的离子实的正电荷完全平衡。\n\n#### 2. $\\Phi_{\\mathrm{PZC}}$ 表达式的推导\n\n我们旨在从第一性原理出发，在绝对真空标度上推导 $\\Phi_{\\mathrm{PZC}}$ 的表达式。\n\n1.  **功函数 ($W$)**：金属的功函数 $W$ 定义为从不带电的中性金属体相中取出一个电子到远离表面的真空中某一点所需的最小能量。根据此定义，在真空中不带电金属内的电子化学势由下式给出：\n    $$\n    \\mu_{e, \\text{vac}, \\sigma=0} = -W\n    $$\n    精确区分单位至关重要。如果 $W$ 以能量单位（如焦耳或电子伏特）给出，则此方程是一个能量平衡式。\n\n2.  **界面偶极电势 ($\\Delta V_{\\text{dipole}}$)**：当不带电的金属与电解质（例如，像水一样的溶剂）接触时，界面处的溶剂分子倾向于采取一种净优先取向。这种偶极子的取向在界面处形成一个电偶极层。该层在界面上产生一个静电势的变化。我们将此电势偏移记为 $\\Delta V_{\\text{dipole}}$。金属内部的电子会经历这个电势，其能量因此移动了 $-e\\Delta V_{\\text{dipole}}$。现在与电解质接触的不带电金属中的电子化学势为：\n    $$\n    \\mu_{e, \\text{sol}, \\sigma=0} = \\mu_{e, \\text{vac}, \\sigma=0} - e\\Delta V_{\\text{dipole}} = -W - e\\Delta V_{\\text{dipole}}\n    $$\n\n3.  **零电荷电势 ($\\Phi_{\\mathrm{PZC}}$)**：在零电荷电势下，根据定义，电极是不带电的 ($\\sigma=0$)。因此，电极中电子的化学势为 $\\mu_e(\\Phi_{\\mathrm{PZC}}) = \\mu_{e, \\text{sol}, \\sigma=0}$。根据我们的基本关系 $\\mu_e = -e\\Phi$，我们有：\n    $$\n    \\mu_e(\\Phi_{\\mathrm{PZC}}) = -e\\Phi_{\\mathrm{PZC}}\n    $$\n    \n4.  **连接各个量**：将零电荷下电子化学势的两个表达式相等，得到：\n    $$\n    -e\\Phi_{\\mathrm{PZC}} = -W - e\\Delta V_{\\text{dipole}}\n    $$\n\n5.  **单位换算**：功函数 $W$ 以电子伏特 (eV) 提供，而电势 ($\\Phi_{\\mathrm{PZC}}$, $\\Delta\\phi_{\\mathrm{dip}}$) 以伏特 (V) 提供。以 eV 为单位的能量 $E$ 与以焦耳为单位的能量通过 $E_{\\text{Joules}} = \\{E\\}_{\\text{eV}} \\cdot e$ 相关联，其中 $\\{E\\}_{\\text{eV}}$ 是数值。因此，$W_{\\text{Joules}} = \\{W\\}_{\\text{eV}} \\cdot e$。将此代入我们的方程：\n    $$\n    -e\\Phi_{\\mathrm{PZC}} = -(\\{W\\}_{\\text{eV}} \\cdot e) - e\\Delta V_{\\text{dipole}}\n    $$\n    将整个方程除以 $-e$，得到以伏特为单位的各量之间的关系：\n    $$\n    \\Phi_{\\mathrm{PZC}} [\\text{V}] = \\{W\\}_{\\text{eV}} + \\Delta V_{\\text{dipole}} [\\text{V}]\n    $$\n    此方程表明，以 eV 为单位的功函数的数值直接加到以伏特为单位的偶极电势上，即可得到以伏特为单位的 PZC。\n\n6.  **与问题数据协调**：该问题提供了 $W$、$\\Delta \\phi_{\\mathrm{dip}}$ 的值以及一个函数 $\\sigma(\\Phi)$，可以从中确定数值 $\\Phi_{\\mathrm{PZC}}$。对于所有测试用例，提供的数据与以下关系一致：\n    $$\n    \\Phi_{\\mathrm{PZC}}^{\\text{numerical}} = \\{W\\}_{\\text{eV}} - \\Delta \\phi_{\\mathrm{dip}}^{\\text{given}}\n    $$\n    例如，在用例 1 中，$\\{W\\}_{\\text{eV}} = 5.1\\,\\mathrm{V}$ 且 $\\Delta \\phi_{\\mathrm{dip}}^{\\text{given}} = 4.9\\,\\mathrm{V}$。数值 PZC 位于 $0.2\\,\\mathrm{V}$。我们观察到 $5.1 - 4.9 = 0.2$。这种一致性对所有四个用例都成立。\n    \n    将这个经验关系与我们推导的公式进行比较，我们必须得出结论：$\\Delta V_{\\text{dipole}} = - \\Delta \\phi_{\\mathrm{dip}}^{\\text{given}}$。这意味着问题中提供的参数 $\\Delta \\phi_{\\mathrm{dip}}$ 对应一个特定的、非通用的符号约定。我们从第一性原理的推导是普适的。为了解决所述问题，我们必须使用与其数据一致的形式。\n\n因此，要使用的理论表达式是：\n$$\n\\Phi_{\\mathrm{PZC, theory}} [\\text{V}] = \\{W\\}_{\\text{eV}} - \\Delta \\phi_{\\mathrm{dip}} [\\text{V}]\n$$\n\n### 算法设计\n\n从离散数据点 $(\\Phi_i, \\sigma_i)$ 数值确定 $\\Phi_{\\mathrm{PZC}}$ 遵循一个三层方法：\n\n1.  **精确零点**：遍历计算出的电荷密度 $\\{\\sigma_i\\}$。如果任何 $\\sigma_i = 0$，则相应的电势 $\\Phi_i$ 就是精确的 PZC。\n2.  **符号变化**：如果没有找到精确零点，则遍历相邻的点对。如果 $\\sigma_i \\cdot \\sigma_{i+1}   0$，则在区间 $[\\Phi_i, \\Phi_{i+1}]$ 内存在一个根。PZC 通过这两点之间的线性插值（割线法公式）来近似：\n    $$\n    \\Phi_{\\mathrm{PZC}} = \\Phi_i - \\sigma_i \\frac{\\Phi_{i+1} - \\Phi_i}{\\sigma_{i+1} - \\sigma_i}\n    $$\n3.  **最小绝对值**：如果以上两个条件都不满足（即所有 $\\sigma_i$ 符号相同），则 PZC 位于采样的电势范围之外。在这种情况下，我们找到对应最小绝对电荷 $|\\sigma_k|$ 的电势 $\\Phi_k$。然后，我们通过使用点 $(\\Phi_k, \\sigma_k)$ 及其在电势数组中的最近邻点 $(\\Phi_j, \\sigma_j)$ 进行线性插值来优化此估计，其中 $j$ 被选为 $k-1$ 或 $k+1$。如果分母 $\\sigma_j - \\sigma_k$ 为零，则无法进行插值，并返回 $\\Phi_k$ 作为最佳估计。\n\n程序将为每个测试用例实现此逻辑，使用上面推导的公式计算理论 PZC，并计算差值 $\\Delta = \\Phi_{\\mathrm{PZC}}^{\\text{numerical}} - \\Phi_{\\mathrm{PZC, theory}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef find_numerical_pzc(potentials, charges):\n    \"\"\"\n    Finds the Potential of Zero Charge (PZC) from discrete potential and charge data.\n\n    Args:\n        potentials (np.ndarray): Array of electrode potentials in Volts.\n        charges (np.ndarray): Array of corresponding surface charge densities.\n\n    Returns:\n        float: The numerically determined PZC in Volts.\n    \"\"\"\n    # 1. Detect if any charge is exactly zero\n    for i, charge in enumerate(charges):\n        if np.isclose(charge, 0.0):\n            return potentials[i]\n\n    # 2. Find a sign change and perform linear interpolation\n    for i in range(len(charges) - 1):\n        if charges[i] * charges[i+1]  0:\n            phi_i, sigma_i = potentials[i], charges[i]\n            phi_i1, sigma_i1 = potentials[i+1], charges[i+1]\n            # Linear interpolation formula (secant method)\n            pzc = phi_i - sigma_i * (phi_i1 - phi_i) / (sigma_i1 - sigma_i)\n            return pzc\n\n    # 3. No sign change: find minimum absolute charge and refine by interpolation\n    abs_charges = np.abs(charges)\n    k = np.argmin(abs_charges)\n    \n    phi_k, sigma_k = potentials[k], charges[k]\n\n    # Determine nearest neighbor for interpolation\n    if k == 0:\n        # Minimum is at the first point, neighbor is the second point\n        j = 1\n    elif k == len(potentials) - 1:\n        # Minimum is at the last point, neighbor is the second to last point\n        j = k - 1\n    else:\n        # Minimum is an interior point, choose neighbor with smaller potential difference\n        if (phi_k - potentials[k-1])  (potentials[k+1] - phi_k):\n            j = k - 1\n        else:\n            j = k + 1\n            \n    phi_j, sigma_j = potentials[j], charges[j]\n\n    # Perform local linear interpolation if possible\n    if not np.isclose(sigma_j, sigma_k):\n        pzc = phi_k - sigma_k * (phi_j - phi_k) / (sigma_j - sigma_k)\n        return pzc\n    else:\n        # Denominator is zero, cannot interpolate, return potential of minimum charge\n        return phi_k\n\ndef find_theoretical_pzc(W, delta_phi_dip):\n    \"\"\"\n    Computes the theoretical PZC from work function and interfacial dipole potential.\n\n    Args:\n        W (float): Work function in eV.\n        delta_phi_dip (float): Interfacial dipole potential in Volts.\n\n    Returns:\n        float: The theoretical PZC in Volts.\n    \"\"\"\n    # From derivation: PZC [V] = {W}[eV] - delta_phi_dip [V]\n    # The numerical value of W in eV equals the potential value in V.\n    return W - delta_phi_dip\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        {\n            # Case 1: Monotonic linear σ(Φ) crossing\n            \"potentials\": np.array([-0.2, 0.0, 0.2, 0.4, 0.6]),\n            \"sigma_func\": lambda phi: 0.4 * (phi - 0.2),\n            \"W\": 5.1,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 2: Exact zero on grid\n            \"potentials\": np.array([-0.5, 0.0, 0.5]),\n            \"sigma_func\": lambda phi: 0.3 * (phi - 0.0),\n            \"W\": 4.9,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 3: Nonlinear cubic response\n            \"potentials\": np.array([-0.3, -0.1, 0.1, 0.3, 0.5]),\n            \"sigma_func\": lambda phi: 0.5 * (phi - 0.1) + 0.2 * (phi - 0.1)**3,\n            \"W\": 5.0,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 4: Zero at the boundary\n            \"potentials\": np.array([0.0, 0.2, 0.4]),\n            \"sigma_func\": lambda phi: 0.1 * (phi - 0.0),\n            \"W\": 5.0,\n            \"delta_phi_dip\": 5.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        potentials = case[\"potentials\"]\n        sigma_func = case[\"sigma_func\"]\n        W = case[\"W\"]\n        delta_phi_dip = case[\"delta_phi_dip\"]\n\n        # Generate charge data from the potential array and function\n        charges = sigma_func(potentials)\n\n        # 1. Find numerical PZC\n        pzc_numerical = find_numerical_pzc(potentials, charges)\n\n        # 2. Compute theoretical PZC\n        pzc_theoretical = find_theoretical_pzc(W, delta_phi_dip)\n\n        # 3. Compute difference\n        difference = pzc_numerical - pzc_theoretical\n\n        results.extend([pzc_numerical, pzc_theoretical, difference])\n\n    # Format output to six decimal places as specified\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}