{
    "hands_on_practices": [
        {
            "introduction": "At the heart of Joint Density Functional Theory (JDFT) lies the variational principle, where the equilibrium state of a system is found by minimizing a free-energy functional. This foundational exercise guides you through the first crucial step in any JDFT calculation: deriving the local chemical potential from a given free-energy functional. By performing the functional derivative, you will uncover the physical meaning of each term contributing to the solvent's equilibrium distribution, connecting the abstract mathematical formalism to concrete physical driving forces like entropy and electrostatics .",
            "id": "4249076",
            "problem": "Consider a solvent treated within Joint Density Functional Theory (JDFT), where the molecular liquid is represented by site-resolved number densities $N_{\\alpha}(\\mathbf{r})$ for sites $\\alpha$ (e.g., atom-centered sites of a solvent molecule). The solute and electrodes generate an electrostatic potential $\\phi(\\mathbf{r})$ through their charge distributions, but in this problem $\\phi(\\mathbf{r})$ should be regarded as a fixed mean-field potential. Let the solvent-site free-energy functional be defined on a spatial domain $\\Omega \\subset \\mathbb{R}^{3}$ by\n$$\n\\mathcal{F}\\left[\\{N_{\\alpha}\\},\\phi\\right] = \\sum_{\\alpha} \\int_{\\Omega} \\mathrm{d}^{3}\\mathbf{r}\\,\\Bigg\\{ k_{B}T\\,N_{\\alpha}(\\mathbf{r})\\left[\\ln\\!\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)-1\\right] \\;+\\; U_{\\alpha}(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\;+\\; q_{\\alpha}\\,\\phi(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\Bigg\\},\n$$\nwhere $k_{B}$ is the Boltzmann constant, $T$ is the absolute temperature, $N_{\\alpha}^{\\mathrm{bulk}}$ is the bulk site density for site type $\\alpha$, $U_{\\alpha}(\\mathbf{r})$ is a non-electrostatic external field that encodes solute–solvent interactions (e.g., dispersion or steric exclusion) in a mean-field approximation, and $q_{\\alpha}$ is the effective partial charge assigned to site $\\alpha$. The electrostatic potential $\\phi(\\mathbf{r})$ is determined by the solute and electrode charges together with the solvent response, but you should treat $\\phi(\\mathbf{r})$ as fixed when varying with respect to $N_{\\alpha}(\\mathbf{r})$.\n\nStarting from the principles of equilibrium statistical mechanics for ideal-gas entropy ($k_{B}T$ times density times the logarithm of density relative to a reference) and mean-field electrostatics (site charge $q_{\\alpha}$ times local potential $\\phi$), and using the calculus of variations, compute the functional derivative $\\delta \\mathcal{F}/\\delta N_{\\alpha}(\\mathbf{r})$ at fixed $\\phi(\\mathbf{r})$. Provide a detailed derivation that begins from the given functional and fundamental definitions, and interpret each term of the resulting expression in physical terms relevant to computational electrochemistry.\n\nExpress your final answer as a single closed-form analytical expression for $\\delta \\mathcal{F}/\\delta N_{\\alpha}(\\mathbf{r})$ with no units. No numerical evaluation is required.",
            "solution": "The problem asks for the functional derivative of the given free-energy functional $\\mathcal{F}\\left[\\{N_{\\alpha}\\},\\phi\\right]$ with respect to the site density $N_{\\alpha}(\\mathbf{r})$ of a specific site type $\\alpha$.\n\nThe solvent-site free-energy functional is given by:\n$$\n\\mathcal{F}\\left[\\{N_{\\alpha}\\},\\phi\\right] = \\sum_{\\alpha} \\int_{\\Omega} \\mathrm{d}^{3}\\mathbf{r}\\,\\Bigg\\{ k_{B}T\\,N_{\\alpha}(\\mathbf{r})\\left[\\ln\\!\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)-1\\right] \\;+\\; U_{\\alpha}(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\;+\\; q_{\\alpha}\\,\\phi(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\Bigg\\}\n$$\nWe can write the functional as an integral over a free-energy density, $f$:\n$$\n\\mathcal{F}\\left[\\{N_{\\alpha}\\},\\phi\\right] = \\int_{\\Omega} \\mathrm{d}^{3}\\mathbf{r}\\,f\\left(\\{N_{\\alpha}(\\mathbf{r})\\}, \\mathbf{r}\\right)\n$$\nwhere the integrand $f$ is a sum over contributions from each site type $\\alpha$:\n$$\nf\\left(\\{N_{\\alpha}(\\mathbf{r})\\}, \\mathbf{r}\\right) = \\sum_{\\alpha} \\left( k_{B}T\\,N_{\\alpha}(\\mathbf{r})\\left[\\ln\\!\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)-1\\right] \\;+\\; U_{\\alpha}(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\;+\\; q_{\\alpha}\\,\\phi(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\right)\n$$\nThe functional derivative $\\frac{\\delta \\mathcal{F}}{\\delta N_{\\beta}(\\mathbf{r}')}$ is defined by the relation:\n$$\n\\delta\\mathcal{F} = \\int_{\\Omega} \\mathrm{d}^{3}\\mathbf{r}' \\sum_{\\beta} \\frac{\\delta \\mathcal{F}}{\\delta N_{\\beta}(\\mathbf{r}')} \\delta N_{\\beta}(\\mathbf{r}')\n$$\nFor a functional that is an integral of a local function of the fields $N_{\\alpha}(\\mathbf{r})$, like the one given, the functional derivative simplifies to the partial derivative of the integrand with respect to the field at that point. Specifically:\n$$\n\\frac{\\delta \\mathcal{F}}{\\delta N_{\\beta}(\\mathbf{r}')} = \\frac{\\partial f\\left(\\{N_{\\alpha}(\\mathbf{r})\\}, \\mathbf{r}\\right)}{\\partial N_{\\beta}(\\mathbf{r}')} \\Bigg|_{\\mathbf{r}=\\mathbf{r}'}\n$$\nSince the terms for different site types $\\alpha$ in the sum are independent, the partial derivative with respect to $N_{\\beta}$ will only be non-zero for the term where $\\alpha=\\beta$. Let's compute the derivative with respect to a specific site density, which we denote $N_{\\alpha}(\\mathbf{r})$ as per the problem's final expression format, while holding all other densities $N_{\\beta}(\\mathbf{r})$ (for $\\beta \\neq \\alpha$) and the potential $\\phi(\\mathbf{r})$ constant.\n\nThe task reduces to calculating the partial derivative of the integrand with respect to $N_{\\alpha}(\\mathbf{r})$. We differentiate term by term.\n\n1.  **Ideal-gas entropy term:**\n    The first term is the contribution from the ideal-gas entropy. Let's denote it $f_{1,\\alpha}$.\n    $$\n    f_{1,\\alpha} = k_{B}T\\,N_{\\alpha}(\\mathbf{r})\\left[\\ln\\!\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)-1\\right] = k_{B}T \\left( N_{\\alpha}(\\mathbf{r}) \\ln(N_{\\alpha}(\\mathbf{r})) - N_{\\alpha}(\\mathbf{r}) \\ln(N_{\\alpha}^{\\mathrm{bulk}}) - N_{\\alpha}(\\mathbf{r}) \\right)\n    $$\n    We take the partial derivative with respect to $N_{\\alpha}(\\mathbf{r})$, treating $N_{\\alpha}^{\\mathrm{bulk}}$ as a constant parameter. Using the product rule for the first term $N_{\\alpha}(\\mathbf{r}) \\ln(N_{\\alpha}(\\mathbf{r}))$:\n    $$\n    \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = k_{B}T \\left( \\frac{\\partial}{\\partial N_{\\alpha}(\\mathbf{r})} \\left[ N_{\\alpha}(\\mathbf{r}) \\ln(N_{\\alpha}(\\mathbf{r})) \\right] - \\ln(N_{\\alpha}^{\\mathrm{bulk}}) - 1 \\right)\n    $$\n    $$\n    \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = k_{B}T \\left( \\left[ 1 \\cdot \\ln(N_{\\alpha}(\\mathbf{r})) + N_{\\alpha}(\\mathbf{r}) \\cdot \\frac{1}{N_{\\alpha}(\\mathbf{r})} \\right] - \\ln(N_{\\alpha}^{\\mathrm{bulk}}) - 1 \\right)\n    $$\n    $$\n    \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = k_{B}T \\left( \\ln(N_{\\alpha}(\\mathbf{r})) + 1 - \\ln(N_{\\alpha}^{\\mathrm{bulk}}) - 1 \\right)\n    $$\n    $$\n    \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = k_{B}T \\left( \\ln(N_{\\alpha}(\\mathbf{r})) - \\ln(N_{\\alpha}^{\\mathrm{bulk}}) \\right) = k_{B}T \\ln\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)\n    $$\n\n2.  **Non-electrostatic interaction term:**\n    The second term, $f_{2,\\alpha}$, represents the energy from a non-electrostatic external field $U_{\\alpha}(\\mathbf{r})$.\n    $$\n    f_{2,\\alpha} = U_{\\alpha}(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r})\n    $$\n    Since $U_{\\alpha}(\\mathbf{r})$ is an external field, it does not depend on $N_{\\alpha}(\\mathbf{r})$. The derivative is:\n    $$\n    \\frac{\\partial f_{2,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = U_{\\alpha}(\\mathbf{r})\n    $$\n\n3.  **Electrostatic interaction term:**\n    The third term, $f_{3,\\alpha}$, represents the energy from the mean-field electrostatic potential $\\phi(\\mathbf{r})$.\n    $$\n    f_{3,\\alpha} = q_{\\alpha}\\,\\phi(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r})\n    $$\n    The problem specifies that $\\phi(\\mathbf{r})$ is to be treated as fixed. The partial charge $q_{\\alpha}$ is a constant. The derivative is:\n    $$\n    \\frac{\\partial f_{3,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = q_{\\alpha}\\,\\phi(\\mathbf{r})\n    $$\n\nCombining these three results, the functional derivative of the total free energy $\\mathcal{F}$ with respect to the site density $N_{\\alpha}(\\mathbf{r})$ is the sum of the partial derivatives of the integrand's components for site type $\\alpha$:\n$$\n\\frac{\\delta\\mathcal{F}}{\\delta N_{\\alpha}(\\mathbf{r})} = \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} + \\frac{\\partial f_{2,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} + \\frac{\\partial f_{3,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})}\n$$\n$$\n\\frac{\\delta\\mathcal{F}}{\\delta N_{\\alpha}(\\mathbf{r})} = k_{B}T \\ln\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right) + U_{\\alpha}(\\mathbf{r}) + q_{\\alpha}\\,\\phi(\\mathbf{r})\n$$\n\n**Physical Interpretation:**\nIn statistical mechanics, the functional derivative of the intrinsic free energy with respect to the particle density defines the local chemical potential. Therefore, the expression we have derived is the local chemical potential for solvent site type $\\alpha$ at position $\\mathbf{r}$, denoted $\\mu_{\\alpha}(\\mathbf{r})$.\n$$\n\\mu_{\\alpha}(\\mathbf{r}) = \\frac{\\delta\\mathcal{F}}{\\delta N_{\\alpha}(\\mathbf{r})}\n$$\nAt thermodynamic equilibrium, the chemical potential for each species must be constant throughout the system. The expression for $\\mu_{\\alpha}(\\mathbf{r})$ can be understood by its components:\n-   $k_{B}T \\ln\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)$: This is the **ideal chemical potential**, originating from the translational entropy of the solvent sites (within the ideal-gas approximation). It represents the entropic driving force that favors a uniform density distribution. An increase in local density $N_{\\alpha}(\\mathbf{r})$ relative to the bulk density $N_{\\alpha}^{\\mathrm{bulk}}$ increases this term, corresponding to an entropic penalty.\n-   $U_{\\alpha}(\\mathbf{r})$: This is the **external non-electrostatic potential energy** per site. It accounts for short-range interactions such as steric repulsion (excluding solvent from the solute's core) and van der Waals attractions between the solute and the solvent site $\\alpha$. In computational electrochemistry, this term effectively defines the shape and nonpolar character of the solvated molecule or surface.\n-   $q_{\\alpha}\\phi(\\mathbf{r})$: This is the **external electrostatic potential energy** per site. It is the energy of a site with partial charge $q_{\\alpha}$ immersed in the mean-field electrostatic potential $\\phi(\\mathbf{r})$. This potential is generated by the solute, any electrodes, and (in a self-consistent calculation) the charge distribution of the solvent itself. This term couples the solvent structure to the electrostatic environment.\n\nThe equilibrium condition $\\mu_{\\alpha}(\\mathbf{r}) = \\text{constant}$ leads to the Boltzmann distribution for the site densities, $N_{\\alpha}(\\mathbf{r}) = N_{\\alpha}^{\\mathrm{bulk}} \\exp\\left(-\\frac{U_{\\alpha}(\\mathbf{r}) + q_{\\alpha}\\phi(\\mathbf{r})}{k_{B}T}\\right)$, which confirms the physical consistency of the derived expression.",
            "answer": "$$\n\\boxed{k_{B}T \\ln\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right) + U_{\\alpha}(\\mathbf{r}) + q_{\\alpha}\\,\\phi(\\mathbf{r})}\n$$"
        },
        {
            "introduction": "A key challenge in any solvation model is defining the boundary between the solute and the solvent continuum. This practical exercise explores this challenge by contrasting a simple, fixed atomic-radius model with a more physically grounded approach inspired by JDFT, where the solvation cavity is determined by a threshold of the solute's own electron density. By implementing the Born model for both scenarios, you will quantify the impact of this fundamental modeling choice on the predicted electrostatic hydration free energy, a critical property in computational electrochemistry .",
            "id": "4249093",
            "problem": "You are to implement a simplified, spherically symmetric Joint Density Functional Theory (JDFT)-inspired continuum solvation model to compare two cavity definitions for small ions in water and quantify their impact on predicted hydration free energies. The two cavity definitions are: (i) an electron-density threshold model and (ii) a fixed atomic-radius model. The target quantity in each case is the electrostatic component of the hydration free energy obtained from linear dielectric response theory, assuming water with relative permittivity $\\varepsilon = 78.3$ at room temperature.\n\nStarting point and assumptions:\n- In Joint Density Functional Theory (JDFT), the solvation free energy is formulated as a functional of the solute electronic density $n(\\mathbf{r})$ and the solvent site densities. In the linear-response, continuum limit, this reduces to classical electrostatics with a spatially varying dielectric function that is $1$ inside the cavity and $\\varepsilon$ outside.\n- You may assume spherical symmetry for the solute and cavity, a point ionic charge of magnitude $q$ located at the origin, and a cavity boundary at radius $R$ that is either derived from an electron-density threshold or specified by an atomic radius.\n- The electrostatic solvation free energy is defined from first principles as the difference in the field energy between the vacuum and solvated states, which can be expressed in terms of the solution to the Poisson equation with appropriate boundary conditions at $r=R$.\n\nCavity models to compare:\n1. Electron-density cavity: The solute electron density is modeled as $n(r) = n_{0}\\exp(-\\alpha r)$, where $\\alpha$ has units of inverse angstrom ($\\mathrm{\\AA}^{-1}$) and $r$ is in angstrom ($\\mathrm{\\AA}$). The cavity boundary radius $R_{\\mathrm{dens}}$ is implicitly defined by the threshold $n(r)=n_{c}$, equivalently by the ratio $\\eta = n_{0}/n_{c} > 1$, which yields $R_{\\mathrm{dens}}$ in angstrom.\n2. Atomic-radius cavity: The cavity boundary radius $R_{\\mathrm{atom}}$ is specified directly in angstrom.\n\nConstants and units:\n- Vacuum permittivity: $\\varepsilon_{0} = 8.8541878128\\times 10^{-12}\\ \\mathrm{F/m}$.\n- Elementary charge: $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$.\n- Avogadro constant: $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n- Relative permittivity of water at room temperature: $\\varepsilon = 78.3$ (dimensionless).\n- $1\\ \\mathrm{\\AA} = 1\\times 10^{-10}\\ \\mathrm{m}$.\n- All final energies must be reported in kilojoules per mole ($\\mathrm{kJ/mol}$), rounded to three decimal places.\n\nYour program must, for each test case:\n- Compute $R_{\\mathrm{dens}}$ in angstrom from $\\alpha$ and $\\eta$ and convert it to meters.\n- Convert $R_{\\mathrm{atom}}$ from angstrom to meters.\n- Using linear dielectric response for a spherical cavity in a uniform dielectric medium, compute the electrostatic hydration free energy for each cavity definition, expressed in $\\mathrm{kJ/mol}$ and rounded to three decimal places.\n- Compute the impact of the cavity choice as the difference $\\Delta = \\Delta G_{\\mathrm{dens}} - \\Delta G_{\\mathrm{atom}}$ in $\\mathrm{kJ/mol}$, rounded to three decimal places.\n\nTest suite:\nProvide results for the following four test cases, each tuple specifying $(q/e,\\ \\alpha\\ \\mathrm{[\\AA^{-1}]},\\ \\eta,\\ R_{\\mathrm{atom}}\\ \\mathrm{[\\AA]})$:\n- Case 1 (happy path and equality boundary): $(+1,\\ 2.5,\\ 33.115451,\\ 1.40)$, which yields $R_{\\mathrm{dens}}$ equal to $1.40\\ \\mathrm{\\AA}$.\n- Case 2 (monovalent anion with larger size): $(-1,\\ 1.2,\\ 8.665,\\ 1.80)$.\n- Case 3 (divalent cation and small radius): $(+2,\\ 3.0,\\ 14.8797,\\ 1.00)$.\n- Case 4 (diffuse electron density leading to larger density-defined cavity): $(+1,\\ 0.8,\\ 11.02318,\\ 1.50)$, corresponding to $R_{\\mathrm{dens}} \\approx 3.00\\ \\mathrm{\\AA}$.\n\nAngle units do not apply. Percentages are not used.\n\nFinal output specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, append the three values in order: $[\\Delta G_{\\mathrm{dens}},\\ \\Delta G_{\\mathrm{atom}},\\ \\Delta]$ in $\\mathrm{kJ/mol}$, rounded to three decimals. For all four cases concatenated, the output must be a flat list with twelve entries, for example, $[\\mathrm{case1\\_Gdens},\\mathrm{case1\\_Gatom},\\mathrm{case1\\_Delta},\\mathrm{case2\\_Gdens},\\dots,\\mathrm{case4\\_Delta}]$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in classical electrostatics (the Born model of solvation), is well-posed with a complete and consistent set of parameters, and uses objective, formalizable language. A unique solution can be determined through the application of fundamental principles. We proceed with the solution.\n\nThe core of this problem is to calculate the electrostatic component of the hydration free energy, $\\Delta G$, for a spherical ion within two different cavity definitions using the framework of linear dielectric response theory. The result is effectively the Born energy of solvation.\n\n**1. Cavity Radius Definitions**\n\nThe problem provides two models for the cavity radius, $R$, which defines the boundary between the solute region (relative permittivity $\\varepsilon_r = 1$) and the solvent continuum (relative permittivity $\\varepsilon = 78.3$).\n\na) **Electron-Density Cavity ($R_{\\mathrm{dens}}$)**:\nThe solute's electron density is given by the spherically symmetric function $n(r) = n_{0}\\exp(-\\alpha r)$, where $r$ is the radial distance from the origin. The cavity boundary, $R_{\\mathrm{dens}}$, is defined as the radius where the electron density drops to a certain threshold value, $n_c$. The ratio $\\eta = n_0 / n_c$ is provided.\n\nThe defining condition is:\n$$ n(R_{\\mathrm{dens}}) = n_c $$\nSubstituting the expression for $n(r)$:\n$$ n_0 \\exp(-\\alpha R_{\\mathrm{dens}}) = n_c $$\nRearranging the terms gives:\n$$ \\exp(-\\alpha R_{\\mathrm{dens}}) = \\frac{n_c}{n_0} = \\frac{1}{\\eta} $$\nTaking the natural logarithm of both sides:\n$$ -\\alpha R_{\\mathrm{dens}} = \\ln\\left(\\frac{1}{\\eta}\\right) = -\\ln(\\eta) $$\nSolving for $R_{\\mathrm{dens}}$ yields:\n$$ R_{\\mathrm{dens}} = \\frac{\\ln(\\eta)}{\\alpha} $$\nGiven that $\\alpha$ is in units of $\\mathrm{\\AA}^{-1}$, $R_{\\mathrm{dens}}$ will be calculated in Angstroms ($\\mathrm{\\AA}$).\n\nb) **Atomic-Radius Cavity ($R_{\\mathrm{atom}}$)**:\nThis model defines the cavity radius simply as a fixed value, $R_{\\mathrm{atom}}$, provided in Angstroms.\n\n**2. Derivation of the Electrostatic Solvation Free Energy**\n\nThe electrostatic solvation free energy, $\\Delta G$, is the work done to transfer an ion from a vacuum into the dielectric medium. In linear response theory, this is equal to half the interaction energy between the charge and the potential generated by the polarized dielectric medium (the reaction field).\n\nWe solve the Poisson equation for the electrostatic potential $\\phi$ created by a point charge $q$ at the origin, located inside a spherical cavity of radius $R$ surrounded by a dielectric medium with relative permittivity $\\varepsilon$. The region inside the cavity ($r < R$) has a relative permittivity of $1$.\n\nThe potential $\\phi(r)$ must satisfy the following forms, which are general solutions to the spherically symmetric Laplace equation ($\\nabla^2 \\phi = 0$ for $r > 0$):\n$$\n\\phi(r) =\n\\begin{cases}\n    \\phi_{\\mathrm{in}}(r) = \\frac{q}{4\\pi\\varepsilon_0 r} + C & \\text{for } r < R \\\\\n    \\phi_{\\mathrm{out}}(r) = \\frac{B}{r} & \\text{for } r > R\n\\end{cases}\n$$\nHere, $\\frac{q}{4\\pi\\varepsilon_0 r}$ is the potential of the point charge itself. The constant $C$ is the potential inside the cavity due to the induced surface charge at the dielectric boundary $r=R$. The potential $\\phi_{\\mathrm{out}}$ must vanish as $r \\to \\infty$.\n\nThe constants $B$ and $C$ are determined by applying boundary conditions at $r=R$:\ni) Continuity of the potential: $\\phi_{\\mathrm{in}}(R) = \\phi_{\\mathrm{out}}(R)$\n$$ \\frac{q}{4\\pi\\varepsilon_0 R} + C = \\frac{B}{R} $$\n\nii) Continuity of the normal component of the electric displacement field, $D_r = -\\varepsilon_r \\varepsilon_0 \\frac{d\\phi}{dr}$:\n$$ (1) \\varepsilon_0 \\left(-\\frac{d\\phi_{\\mathrm{in}}}{dr}\\right)\\bigg|_{R} = (\\varepsilon) \\varepsilon_0 \\left(-\\frac{d\\phi_{\\mathrm{out}}}{dr}\\right)\\bigg|_{R} $$\n$$ \\left( \\frac{q}{4\\pi\\varepsilon_0 R^2} \\right) = \\varepsilon \\left( \\frac{B}{R^2} \\right) \\implies B = \\frac{q}{4\\pi\\varepsilon_0 \\varepsilon} $$\n\nSubstituting $B$ back into the first boundary condition equation to solve for $C$:\n$$ C = \\frac{B}{R} - \\frac{q}{4\\pi\\varepsilon_0 R} = \\frac{1}{R} \\left( \\frac{q}{4\\pi\\varepsilon_0 \\varepsilon} - \\frac{q}{4\\pi\\varepsilon_0} \\right) = \\frac{q}{4\\pi\\varepsilon_0 R} \\left( \\frac{1}{\\varepsilon} - 1 \\right) $$\n\nThe constant $C$ is the potential of the reaction field, $\\phi_{\\mathrm{rxn}}$, evaluated inside the sphere. The solvation free energy is the work done in charging the ion in the presence of this reaction field, which is given by $\\Delta G = \\frac{1}{2}q\\phi_{\\mathrm{rxn}}$.\n$$ \\Delta G_{\\mathrm{ion}} = \\frac{1}{2} q C = \\frac{1}{2} q \\left[ \\frac{q}{4\\pi\\varepsilon_0 R} \\left( \\frac{1}{\\varepsilon} - 1 \\right) \\right] = \\frac{q^2}{8\\pi\\varepsilon_0 R} \\left( \\frac{1}{\\varepsilon} - 1 \\right) $$\nThis is the celebrated Born energy formula. Note that since $\\varepsilon > 1$, $\\Delta G_{\\mathrm{ion}}$ is negative, indicating that solvation is a spontaneous process.\n\n**3. Final Calculation Formula**\n\nThe problem requires the energy in units of kilojoules per mole ($\\mathrm{kJ/mol}$). The derived formula gives the energy in Joules per ion. The conversion is performed by multiplying by the Avogadro constant $N_{\\mathrm{A}}$ and a factor of $1/1000$ for the kilo- prefix. The charge $q$ is given as a multiple of the elementary charge $e$, so $q = (q/e) \\times e$. The radius $R$ is given in Ångstroms ($\\mathrm{\\AA}$), and must be converted to meters ($\\mathrm{m}$) for consistency with the SI units of the physical constants ($1\\ \\mathrm{\\AA} = 10^{-10}\\ \\mathrm{m}$).\n\nLet $q_{\\mathrm{norm}} = q/e$ and $R_{\\mathrm{\\AA}}$ be the radius in Angstroms.\n$$ \\Delta G\\ [\\mathrm{kJ/mol}] = \\frac{N_{\\mathrm{A}} (q_{\\mathrm{norm}} \\cdot e)^2}{8\\pi\\varepsilon_0 (R_{\\mathrm{\\AA}} \\cdot 10^{-10})} \\left( \\frac{1}{\\varepsilon} - 1 \\right) \\cdot \\frac{1}{1000} $$\nWe can group the constants into a single pre-factor $K$ to simplify the computation:\n$$ K = \\frac{N_{\\mathrm{A}} e^2}{8000 \\pi \\varepsilon_0} \\left( \\frac{1}{\\varepsilon} - 1 \\right) \\cdot 10^{10} $$\nThe final formula using the radius in Angstroms directly is:\n$$ \\Delta G\\ [\\mathrm{kJ/mol}] = K \\frac{q_{\\mathrm{norm}}^2}{R_{\\mathrm{\\AA}}} $$\nUsing the provided values:\n- $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$\n- $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n- $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$\n- $\\varepsilon = 78.3$\nThe pre-factor $K$ evaluates to approximately $-6861.30085\\ \\mathrm{kJ\\cdot\\AA/mol}$.\n\n**4. Computational Algorithm**\n\nFor each test case defined by the tuple $(q_{\\mathrm{norm}},\\ \\alpha,\\ \\eta,\\ R_{\\mathrm{atom}})$:\n1.  Calculate the density-defined cavity radius $R_{\\mathrm{dens}} = \\ln(\\eta) / \\alpha$.\n2.  Calculate the hydration free energy for the density-defined cavity:\n    $\\Delta G_{\\mathrm{dens}} = K \\cdot q_{\\mathrm{norm}}^2 / R_{\\mathrm{dens}}$.\n3.  Calculate the hydration free energy for the atomic-radius cavity:\n    $\\Delta G_{\\mathrm{atom}} = K \\cdot q_{\\mathrm{norm}}^2 / R_{\\mathrm{atom}}$.\n4.  Calculate the difference: $\\Delta = \\Delta G_{\\mathrm{dens}} - \\Delta G_{\\mathrm{atom}}$.\n5.  All three resulting energy values are rounded to three decimal places before being stored.\n\nThis procedure will be implemented for all provided test cases to generate the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares electrostatic hydration free energies for two\n    cavity models based on a simplified JDFT approach.\n    \"\"\"\n    # Define physical constants\n    EPS_0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\n    E_CHARGE = 1.602176634e-19   # Elementary charge (C)\n    N_A = 6.02214076e23        # Avogadro constant (mol^-1)\n    EPS_R = 78.3                 # Relative permittivity of water\n    \n    # Pre-calculate the constant factor for the Born energy calculation in kJ/mol\n    # using radius in Angstroms.\n    # The formula is: (N_A * q^2) / (8 * pi * eps_0 * R) * (1/eps_r - 1)\n    # The components are:\n    # - q = q_norm * E_CHARGE\n    # - R = R_angstrom * 1e-10\n    # - Conversion to kJ: factor of 1/1000\n    # Prefactor K such that delta_G (kJ/mol) = K * q_norm^2 / R_angstrom\n    K = (N_A * E_CHARGE**2) / (8000 * np.pi * EPS_0) * (1/EPS_R - 1) * 1e10\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (q/e, alpha [1/A], eta, R_atom [A])\n    test_cases = [\n        (1.0, 2.5, 33.115451, 1.40),\n        (-1.0, 1.2, 8.665, 1.80),\n        (2.0, 3.0, 14.8797, 1.00),\n        (1.0, 0.8, 11.02318, 1.50),\n    ]\n\n    results = []\n    \n    def custom_round(value):\n        \"\"\"\n        Rounds a number to 3 decimal places (symmetric rounding).\n        This avoids inconsistencies with Python's default round-half-to-even.\n        \"\"\"\n        return np.sign(value) * np.floor(np.abs(value) * 1000 + 0.5) / 1000\n\n    for case in test_cases:\n        q_norm, alpha, eta, r_atom = case\n        \n        # 1. Compute R_dens from alpha and eta\n        # R_dens = ln(eta) / alpha\n        r_dens = np.log(eta) / alpha\n        \n        # 2. Compute hydration free energy for both cavity models\n        # delta_G = K * q_norm^2 / R\n        \n        # Using full precision for intermediate calculations\n        delta_g_dens_full = K * (q_norm**2) / r_dens\n        delta_g_atom_full = K * (q_norm**2) / r_atom\n        \n        # 3. Compute the difference\n        delta_full = delta_g_dens_full - delta_g_atom_full\n        \n        # 4. Round final results to three decimal places\n        delta_g_dens = custom_round(delta_g_dens_full)\n        delta_g_atom = custom_round(delta_g_atom_full)\n        delta = custom_round(delta_full)\n\n        results.extend([delta_g_dens, delta_g_atom, delta])\n\n    # Final print statement in the exact required format.\n    # Using f-string formatting to ensure three decimal places for all numbers,\n    # including those rounding to .000\n    formatted_results = [f\"{x:.3f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While simple models often treat solvent molecules or ions as point particles, their finite volume introduces crucial physical effects, especially at high concentrations or near interfaces. This exercise advances beyond the ideal-gas approximation by incorporating finite-size effects using a lattice-gas entropy model for an electrolyte. Your task is to derive and implement a model that captures ionic crowding, leading to the physically realistic phenomenon of density saturation at extreme electrostatic potentials, a key feature that standard Poisson-Boltzmann theory fails to predict .",
            "id": "4249192",
            "problem": "Consider a symmetric monovalent electrolyte in a continuum solvent modeled within Joint Density Functional Theory (JDFT), where JDFT couples an electronic Density Functional Theory (DFT) for the solute with a classical density functional for the liquid and ionic distributions. In the classical subsystem, assume the ions occupy a finite volume and obey a lattice-gas entropy. Let the local electrostatic potential be $\\,\\phi\\,$ and temperature be $\\,T\\,$. The elementary charge is $\\,e\\,$, Boltzmann constant is $\\,k_{\\mathrm{B}}\\,$, and Avogadro’s number is $\\,N_{\\mathrm{A}}\\,$. Let the bulk molar concentration be $\\,c_0\\,$ in $\\mathrm{mol/L}$, and suppose each ion occupies a cubic cell of edge length $\\,a\\,$ in $\\mathrm{nm}$, so the maximum number density is $\\,n_{\\max} = a^{-3}\\,$ when $\\,a\\,$ is converted to meters. The bulk number density is $\\,n_b = 1000\\,c_0\\,N_{\\mathrm{A}}\\,$ in $\\mathrm{m^{-3}}$. Define the filling fraction $\\,\\nu = n_b/n_{\\max}\\,$.\n\nStarting from first principles of classical density functional theory for the ionic subsystem, use the following foundational base:\n- Electrostatics is governed by Poisson’s equation, and mean-field equilibrium of ion densities is obtained by minimizing the grand free energy functional with respect to the ionic density fields subject to the electrostatic potential $\\,\\phi\\,$.\n- The ideal-gas entropy of mixing for species with finite-size exclusion on a lattice leads to an entropic term that penalizes crowding as the local occupancy approaches $\\,n_{\\max}\\,$.\n- At equilibrium, the local chemical potential includes the electrostatic contribution $\\,z_i e \\phi\\,$ for ion valence $\\,z_i\\,$ and the entropic term that enforces the exclusion volume constraint.\n\nYour task is to derive, implement, and evaluate the nonlinear ion crowding with finite-size corrections, and to predict the saturation of the counter-ion density at extreme potentials. Assume a symmetric $\\,1:1\\,$ electrolyte with ion valences $\\,z_+ = +1\\,$ and $\\,z_- = -1\\,$ and equal molecular sizes. For a given local potential $\\,\\phi\\,$, define the counter-ion as the ion with valence opposite in sign to $\\,\\phi\\,$. From the variational equilibrium conditions, obtain an expression for the local counter-ion number density $\\,n_{\\mathrm{counter}}(\\phi)\\,$ that accounts for finite-size exclusion and crowding, expressed in terms of $\\,n_b\\,$, $\\,n_{\\max}\\,$, $\\,e\\,$, $\\,k_{\\mathrm{B}}\\,$, and $\\,T\\,$. Use this to compute the saturation fraction\n$$\ns(\\phi) = \\frac{n_{\\mathrm{counter}}(\\phi)}{n_{\\max}} \\, ,\n$$\nwhich must approach $\\,1\\,$ as $\\,|\\phi|\\to\\infty\\,$ due to crowding-limited close packing.\n\nImplement a complete program that:\n- Converts $\\,c_0\\,$ from $\\mathrm{mol/L}$ to $\\mathrm{mol/m^3}$ and $\\,a\\,$ from $\\mathrm{nm}$ to $\\mathrm{m}$, then computes $\\,n_b\\,$, $\\,n_{\\max}\\,$, and $\\,\\nu\\,$.\n- Uses the derived finite-size corrected equilibrium distribution to compute $\\,s(\\phi)\\,$ for each test case.\n- Treats the counter-ion sign consistently: for $\\,\\phi > 0\\,$ the counter-ion is the anion ($\\,z_- = -1\\,$), and for $\\,\\phi < 0\\,$ the counter-ion is the cation ($\\,z_+ = +1\\,$). For $\\,\\phi = 0\\,$, both species are equal and the counter-ion density equals the bulk, so $\\,s(0) = \\nu\\,$.\n- Handles extreme potentials numerically stably so that the program correctly predicts $\\,s(\\phi)\\to 1\\,$ as $\\,|\\phi|\\,$ becomes large.\n\nPhysical and numerical units:\n- $\\,T\\,$ must be provided in $\\,\\mathrm{K}\\,$.\n- $\\,c_0\\,$ must be provided in $\\,\\mathrm{mol/L}\\,$.\n- $\\,a\\,$ must be provided in $\\,\\mathrm{nm}\\,$.\n- $\\,\\phi\\,$ must be provided in $\\,\\mathrm{V}\\,$.\n- The output saturation fractions $\\,s(\\phi)\\,$ are dimensionless.\n\nTest suite:\n- Case $1$: $\\,T=298\\,$, $\\,c_0=1.0\\,$, $\\,a=0.3\\,$, $\\,\\phi=0.0\\,$.\n- Case $2$: $\\,T=298\\,$, $\\,c_0=1.0\\,$, $\\,a=0.3\\,$, $\\,\\phi=0.1\\,$.\n- Case $3$: $\\,T=298\\,$, $\\,c_0=1.0\\,$, $\\,a=0.3\\,$, $\\,\\phi=5.0\\,$.\n- Case $4$: $\\,T=298\\,$, $\\,c_0=4.0\\,$, $\\,a=0.4\\,$, $\\,\\phi=5.0\\,$.\n- Case $5$: $\\,T=298\\,$, $\\,c_0=0.01\\,$, $\\,a=0.7\\,$, $\\,\\phi=10.0\\,$.\n- Case $6$: $\\,T=298\\,$, $\\,c_0=1.0\\,$, $\\,a=0.3\\,$, $\\,\\phi=-1.0\\,$.\n\nAnswer specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases, where each entry is $\\,s(\\phi)\\,$ rounded to six decimal places (for example, $\\,\\,[0.123456,0.654321]\\,\\,$).\n\nScientific realism:\n- All constants and conversions must be physically consistent.\n- The program must not rely on any input; it must run self-contained with the test suite above and use only the specified libraries.\n\nProduce only the program output line in the exact format specified.",
            "solution": "The objective is to derive and implement a formula for the saturation fraction, $s(\\phi) = n_{\\mathrm{counter}}(\\phi) / n_{\\max}$, of counter-ions in a symmetric monovalent electrolyte, accounting for finite ion sizes within the framework of classical Density Functional Theory (DFT). The derivation proceeds from the principle of minimizing the grand free energy functional, which at equilibrium corresponds to a uniform chemical potential for each ionic species throughout the system.\n\nLet the number densities of the cations and anions at a point with local electrostatic potential $\\phi$ be $n_+(\\phi)$ and $n_-(\\phi)$, respectively. The electrolyte is symmetric and monovalent, so the ion valences are $z_+=+1$ and $z_-=-1$. The ions are modeled as hard particles of identical size, each occupying a volume $v = a^3$. This imposes a maximum total number density of ions, $n_{\\max} = 1/v = a^{-3}$.\n\nThe grand free energy functional for the ionic subsystem includes entropic, electrostatic, and chemical potential contributions. At equilibrium, the chemical potential $\\mu_i$ for each species $i \\in \\{+,-\\}$ must be constant everywhere. The local chemical potential is given by the functional derivative of the free energy with respect to the density, and for a lattice-gas model it takes the form:\n$$\n\\mu_i = \\frac{\\delta F_{\\text{ideal}}}{\\delta n_i} + z_i e \\phi + \\mu_i^0\n$$\nwhere $e$ is the elementary charge, $\\mu_i^0$ is a standard-state chemical potential, and $F_{\\text{ideal}}$ is the ideal free energy including finite-size exclusion. For a lattice-gas where particles of different species compete for the same sites, the ideal free energy density (ignoring non-essential thermal wavelength terms) is derived from the entropy of mixing:\n$$\nf_{\\text{ideal}}(n_+, n_-) = k_{\\mathrm{B}}T \\left[ n_+ \\ln\\left(\\frac{n_+}{n_{\\max}}\\right) + n_- \\ln\\left(\\frac{n_-}{n_{\\max}}\\right) + (n_{\\max} - n_+ - n_-) \\ln\\left(1 - \\frac{n_+ + n_-}{n_{\\max}}\\right) \\right]\n$$\nHere, $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the temperature. The term $(n_{\\max} - n_+ - n_-)$ represents the density of vacant sites. The local chemical potential for species $i$ is thus:\n$$\n\\mu_i(n_+, n_-) = \\frac{\\partial f_{\\text{ideal}}}{\\partial n_i} + z_i e \\phi + \\mu_i^0 = k_{\\mathrm{B}}T \\ln \\left( \\frac{n_i}{n_{\\max} - n_+ - n_-} \\right) + z_i e \\phi + \\mu_i^0\n$$\nIn the bulk solution, far from any surfaces, the electrostatic potential is zero ($\\phi=0$), and the system is electrically neutral. For a symmetric $1:1$ electrolyte with bulk molar concentration $c_0$, the number density of each ionic species is given by $n_b = 1000 N_{\\mathrm{A}} c_0$, where $N_{\\mathrm{A}}$ is Avogadro's number and the factor of $1000$ converts from $\\mathrm{L}^{-1}$ to $\\mathrm{m^3}$. At $\\phi=0$, we have $n_+ = n_- = n_b$. The bulk chemical potential is:\n$$\n\\mu_{i, \\text{bulk}} = k_{\\mathrm{B}}T \\ln \\left( \\frac{n_b}{n_{\\max} - 2n_b} \\right) + \\mu_i^0\n$$\nBy equating the local chemical potential $\\mu_i(n_+, n_-)$ with the bulk chemical potential $\\mu_{i, \\text{bulk}}$, we establish the equilibrium condition:\n$$\nk_{\\mathrm{B}}T \\ln \\left( \\frac{n_i}{n_{\\max} - n_+ - n_-} \\right) + z_i e \\phi = k_{\\mathrm{B}}T \\ln \\left( \\frac{n_b}{n_{\\max} - 2n_b} \\right)\n$$\nRearranging for each species ($z_+=1, z_-=-1$):\n$$\n\\frac{n_+}{n_{\\max} - n_+ - n_-} = \\frac{n_b}{n_{\\max} - 2n_b} \\exp\\left(-\\frac{e\\phi}{k_{\\mathrm{B}}T}\\right)\n$$\n$$\n\\frac{n_-}{n_{\\max} - n_+ - n_-} = \\frac{n_b}{n_{\\max} - 2n_b} \\exp\\left(\\frac{e\\phi}{k_{\\mathrm{B}}T}\\right)\n$$\nThis is a system of two equations for the two unknown densities, $n_+$ and $n_-$. Let $\\beta = (k_{\\mathrm{B}}T)^{-1}$. We can solve for $n_+$ and $n_-$ to get the explicit dependence on $\\phi$:\n$$\nn_i(\\phi) = \\frac{n_{\\max} n_b \\exp(-z_i e \\beta \\phi)}{(n_{\\max} - 2n_b) + n_b \\left[ \\exp(-e \\beta \\phi) + \\exp(e \\beta \\phi) \\right]}\n$$\nThe counter-ion is the species with valence $z_{\\text{counter}}$ opposite in sign to $\\phi$, meaning $z_{\\text{counter}}\\phi < 0$. The exponential term for the counter-ion is thus $\\exp(-z_{\\text{counter}} e \\beta \\phi) = \\exp(e \\beta |z_{\\text{counter}}\\phi|) = \\exp(e \\beta |\\phi|)$ since $|z_{\\text{counter}}|=1$.\nThe counter-ion density, $n_{\\mathrm{counter}}(\\phi)$, is given by:\n$$\nn_{\\mathrm{counter}}(\\phi) = \\frac{n_{\\max} n_b \\exp(e \\beta |\\phi|)}{(n_{\\max} - 2n_b) + n_b \\left[ \\exp(-e \\beta |\\phi|) + \\exp(e \\beta |\\phi|) \\right]}\n$$\nThe saturation fraction $s(\\phi)$ is defined as $n_{\\mathrm{counter}}(\\phi) / n_{\\max}$:\n$$\ns(\\phi) = \\frac{n_b \\exp(e \\beta |\\phi|)}{(n_{\\max} - 2n_b) + n_b \\left[ \\exp(-e \\beta |\\phi|) + \\exp(e \\beta |\\phi|) \\right]}\n$$\nTo improve numerical stability for large values of $|\\phi|$, we divide the numerator and denominator by $\\exp(e \\beta |\\phi|)$:\n$$\ns(\\phi) = \\frac{n_b}{(n_{\\max} - 2n_b)\\exp(-e \\beta |\\phi|) + n_b \\left[ 1 + \\exp(-2e \\beta |\\phi|) \\right]}\n$$\nIntroducing the bulk filling fraction of one species, $\\nu = n_b/n_{\\max}$, we obtain a dimensionless expression:\n$$\ns(\\phi) = \\frac{\\nu}{(1 - 2\\nu)\\exp(-e \\beta |\\phi|) + \\nu \\left[ 1 + \\exp(-2e \\beta |\\phi|) \\right]}\n$$\nThis final expression is numerically robust. For $\\phi=0$, the exponential terms are $1$, yielding $s(0) = \\nu / ((1-2\\nu) + \\nu(1+1)) = \\nu/1 = \\nu$, which is consistent with the problem statement. As $|\\phi| \\to \\infty$, the exponential terms go to $0$, and $s(\\phi) \\to \\nu / (0 + \\nu(1+0)) = 1$, correctly capturing the saturation due to finite ionic volume. This expression will be used for the implementation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates the counter-ion saturation fraction s(phi) for an electrolyte\n    with finite ion size corrections based on a lattice-gas model.\n    \"\"\"\n\n    # Physical Constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    KB_J_K = 1.380649e-23       # Boltzmann constant in J/K\n    N_A = 6.02214076e23         # Avogadro's number in mol^-1\n\n    # Test cases from the problem statement\n    # Each case is a tuple: (T in K, c0 in mol/L, a in nm, phi in V)\n    test_cases = [\n        (298.0, 1.0, 0.3, 0.0),\n        (298.0, 1.0, 0.3, 0.1),\n        (298.0, 1.0, 0.3, 5.0),\n        (298.0, 4.0, 0.4, 5.0),\n        (298.0, 0.01, 0.7, 10.0),\n        (298.0, 1.0, 0.3, -1.0),\n    ]\n\n    results = []\n\n    for T, c0, a, phi in test_cases:\n        # Step 1: Convert units to SI and calculate model parameters\n        \n        # Convert molar concentration from mol/L to mol/m^3\n        c0_si = c0 * 1000.0  # mol/m^3\n        \n        # Convert ion size from nm to m\n        a_si = a * 1e-9  # m\n        \n        # Calculate bulk number density of a single ionic species (m^-3)\n        n_b = c0_si * N_A\n        \n        # Calculate maximum total number density of ions (m^-3)\n        n_max = 1.0 / (a_si**3)\n        \n        # Calculate the filling fraction of a single species in the bulk\n        # This parameter 'nu' is dimensionless\n        nu = n_b / n_max\n        \n        # The derivation is valid for 2*nu < 1, which means n_max > 2*n_b.\n        # This condition means the bulk concentration is physically possible.\n        # This holds for all test cases.\n\n        # Step 2: Calculate the saturation fraction s(phi)\n        \n        # The derived formula is s(phi) = nu / ((1-2*nu)*exp(-e*|phi|/kT) + nu*(1 + exp(-2*e*|phi|/kT)))\n        # This form is numerically stable for all values of phi, including large |phi| and phi=0.\n\n        # Calculate thermal energy\n        k_B_T = KB_J_K * T\n        \n        # Calculate the argument of the exponential, which is dimensionless\n        # This is the ratio of electrostatic energy to thermal energy\n        exp_arg = E_CHARGE * abs(phi) / k_B_T\n\n        # Numerically stable calculation of exp(-arg)\n        neg_exp_val = np.exp(-exp_arg)\n        \n        # Apply the derived formula for the saturation fraction\n        denominator = (1.0 - 2.0 * nu) * neg_exp_val + nu * (1.0 + neg_exp_val**2)\n        \n        # Handle the edge case where denominator might be zero, although not expected\n        # for nu < 0.5.\n        if denominator == 0:\n            # For large |phi|, this should limit to 1.0. Denominator -> nu. s -> 1.\n            s_phi = 1.0\n        else:\n            s_phi = nu / denominator\n\n        results.append(s_phi)\n    \n    # Format the results to 6 decimal places and print in the specified format\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}