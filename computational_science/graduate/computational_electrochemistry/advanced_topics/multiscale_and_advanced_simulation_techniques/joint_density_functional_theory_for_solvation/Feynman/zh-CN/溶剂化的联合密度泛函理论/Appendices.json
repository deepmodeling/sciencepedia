{
    "hands_on_practices": [
        {
            "introduction": "联合密度泛函理论 (JDFT) 的核心是建立一个自由能泛函，通过最小化该泛函来确定系统的平衡态。本练习将带你实践其中最基本的数学步骤：运用变分法从一个给定的自由能泛函中推导出局部化学势。理解化学势中每一个组成项的物理意义，是构建和诠释JDFT模型以及更广泛的经典密度泛函理论模型的关键 。",
            "id": "4249076",
            "problem": "考虑在联合密度泛函理论 (JDFT) 框架下处理的溶剂，其中分子液体由位点 $\\alpha$ 的位点分辨数密度 $N_{\\alpha}(\\mathbf{r})$ 表示（例如，溶剂分子的原子中心位点）。溶质和电极通过其电荷分布产生静电势 $\\phi(\\mathbf{r})$，但在本问题中，$\\phi(\\mathbf{r})$ 应被视为一个固定的平均场势。设溶剂位点自由能泛函定义在空间域 $\\Omega \\subset \\mathbb{R}^{3}$ 上，其表达式为\n$$\n\\mathcal{F}\\left[\\{N_{\\alpha}\\},\\phi\\right] = \\sum_{\\alpha} \\int_{\\Omega} \\mathrm{d}^{3}\\mathbf{r}\\,\\Bigg\\{ k_{B}T\\,N_{\\alpha}(\\mathbf{r})\\left[\\ln\\!\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)-1\\right] \\;+\\; U_{\\alpha}(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\;+\\; q_{\\alpha}\\,\\phi(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\Bigg\\},\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度，$N_{\\alpha}^{\\mathrm{bulk}}$ 是位点类型 $\\alpha$ 的体相数密度，$U_{\\alpha}(\\mathbf{r})$ 是一个非静电外场，它在平均场近似下描述了溶质-溶剂相互作用（例如，色散力或空间排斥），$q_{\\alpha}$ 是分配给位点 $\\alpha$ 的有效部分电荷。静电势 $\\phi(\\mathbf{r})$ 由溶质和电极电荷以及溶剂的响应共同决定，但在对 $N_{\\alpha}(\\mathbf{r})$ 进行变分时，应将 $\\phi(\\mathbf{r})$ 视为固定不变。\n\n从平衡统计力学中关于理想气体熵（$k_{B}T$ 乘以密度再乘以密度相对于参考值的对数）和平均场静电学（位点电荷 $q_{\\alpha}$ 乘以局域势 $\\phi$）的原理出发，并使用变分法，计算在 $\\phi(\\mathbf{r})$ 固定时，泛函导数 $\\delta \\mathcal{F}/\\delta N_{\\alpha}(\\mathbf{r})$。请提供从给定泛函和基本定义开始的详细推导过程，并用计算电化学相关的物理术语解释所得表达式的每一项。\n\n请将最终答案表示为 $\\delta \\mathcal{F}/\\delta N_{\\alpha}(\\mathbf{r})$ 的单个闭合形式解析表达式，不带单位。无需进行数值计算。",
            "solution": "该问题要求计算给定的自由能泛函 $\\mathcal{F}\\left[\\{N_{\\alpha}\\},\\phi\\right]$ 相对于特定位点类型 $\\alpha$ 的位点密度 $N_{\\alpha}(\\mathbf{r})$ 的泛函导数。\n\n溶剂位点自由能泛函由下式给出：\n$$\n\\mathcal{F}\\left[\\{N_{\\alpha}\\},\\phi\\right] = \\sum_{\\alpha} \\int_{\\Omega} \\mathrm{d}^{3}\\mathbf{r}\\,\\Bigg\\{ k_{B}T\\,N_{\\alpha}(\\mathbf{r})\\left[\\ln\\!\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)-1\\right] \\;+\\; U_{\\alpha}(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\;+\\; q_{\\alpha}\\,\\phi(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\Bigg\\}\n$$\n我们可以将该泛函写成自由能密度 $f$ 的积分形式：\n$$\n\\mathcal{F}\\left[\\{N_{\\alpha}\\},\\phi\\right] = \\int_{\\Omega} \\mathrm{d}^{3}\\mathbf{r}\\,f\\left(\\{N_{\\alpha}(\\mathbf{r})\\}, \\mathbf{r}\\right)\n$$\n其中被积函数 $f$ 是对每种位点类型 $\\alpha$ 贡献的总和：\n$$\nf\\left(\\{N_{\\alpha}(\\mathbf{r})\\}, \\mathbf{r}\\right) = \\sum_{\\alpha} \\left( k_{B}T\\,N_{\\alpha}(\\mathbf{r})\\left[\\ln\\!\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)-1\\right] \\;+\\; U_{\\alpha}(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\;+\\; q_{\\alpha}\\,\\phi(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r}) \\right)\n$$\n泛函导数 $\\frac{\\delta \\mathcal{F}}{\\delta N_{\\beta}(\\mathbf{r}')}$ 由以下关系定义：\n$$\n\\delta\\mathcal{F} = \\int_{\\Omega} \\mathrm{d}^{3}\\mathbf{r}' \\sum_{\\beta} \\frac{\\delta \\mathcal{F}}{\\delta N_{\\beta}(\\mathbf{r}')} \\delta N_{\\beta}(\\mathbf{r}')\n$$\n对于像本题中给出的这种场 $N_{\\alpha}(\\mathbf{r})$ 的局域函数的积分形式的泛函，其泛函导数简化为被积函数对该点场强的偏导数。具体而言：\n$$\n\\frac{\\delta \\mathcal{F}}{\\delta N_{\\beta}(\\mathbf{r}')} = \\frac{\\partial f\\left(\\{N_{\\alpha}(\\mathbf{r})\\}, \\mathbf{r}\\right)}{\\partial N_{\\beta}(\\mathbf{r}')} \\Bigg|_{\\mathbf{r}=\\mathbf{r}'}\n$$\n由于求和中不同位点类型 $\\alpha$ 的项是相互独立的，因此对 $N_{\\beta}$ 的偏导数仅在 $\\alpha=\\beta$ 的项上不为零。让我们按照问题最终表达式的格式，计算相对于特定位点密度 $N_{\\alpha}(\\mathbf{r})$ 的导数，同时保持所有其他密度 $N_{\\beta}(\\mathbf{r})$ （其中 $\\beta \\neq \\alpha$）和势 $\\phi(\\mathbf{r})$ 不变。\n\n任务简化为计算被积函数相对于 $N_{\\alpha}(\\mathbf{r})$ 的偏导数。我们逐项进行微分。\n\n1.  **理想气体熵项：**\n    第一项是来自理想气体熵的贡献。我们将其表示为 $f_{1,\\alpha}$。\n    $$\n    f_{1,\\alpha} = k_{B}T\\,N_{\\alpha}(\\mathbf{r})\\left[\\ln\\!\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)-1\\right] = k_{B}T \\left( N_{\\alpha}(\\mathbf{r}) \\ln(N_{\\alpha}(\\mathbf{r})) - N_{\\alpha}(\\mathbf{r}) \\ln(N_{\\alpha}^{\\mathrm{bulk}}) - N_{\\alpha}(\\mathbf{r}) \\right)\n    $$\n    我们对 $N_{\\alpha}(\\mathbf{r})$ 求偏导数，并将 $N_{\\alpha}^{\\mathrm{bulk}}$ 视为常数参数。对第一项 $N_{\\alpha}(\\mathbf{r}) \\ln(N_{\\alpha}(\\mathbf{r}))$ 使用乘积法则：\n    $$\n    \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = k_{B}T \\left( \\frac{\\partial}{\\partial N_{\\alpha}(\\mathbf{r})} \\left[ N_{\\alpha}(\\mathbf{r}) \\ln(N_{\\alpha}(\\mathbf{r})) \\right] - \\ln(N_{\\alpha}^{\\mathrm{bulk}}) - 1 \\right)\n    $$\n    $$\n    \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = k_{B}T \\left( \\left[ 1 \\cdot \\ln(N_{\\alpha}(\\mathbf{r})) + N_{\\alpha}(\\mathbf{r}) \\cdot \\frac{1}{N_{\\alpha}(\\mathbf{r})} \\right] - \\ln(N_{\\alpha}^{\\mathrm{bulk}}) - 1 \\right)\n    $$\n    $$\n    \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = k_{B}T \\left( \\ln(N_{\\alpha}(\\mathbf{r})) + 1 - \\ln(N_{\\alpha}^{\\mathrm{bulk}}) - 1 \\right)\n    $$\n    $$\n    \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = k_{B}T \\left( \\ln(N_{\\alpha}(\\mathbf{r})) - \\ln(N_{\\alpha}^{\\mathrm{bulk}}) \\right) = k_{B}T \\ln\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)\n    $$\n\n2.  **非静电相互作用项：**\n    第二项 $f_{2,\\alpha}$ 代表来自非静电外场 $U_{\\alpha}(\\mathbf{r})$ 的能量。\n    $$\n    f_{2,\\alpha} = U_{\\alpha}(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r})\n    $$\n    由于 $U_{\\alpha}(\\mathbf{r})$ 是一个外场，它不依赖于 $N_{\\alpha}(\\mathbf{r})$。其导数为：\n    $$\n    \\frac{\\partial f_{2,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = U_{\\alpha}(\\mathbf{r})\n    $$\n\n3.  **静电相互作用项：**\n    第三项 $f_{3,\\alpha}$ 代表来自平均场静电势 $\\phi(\\mathbf{r})$ 的能量。\n    $$\n    f_{3,\\alpha} = q_{\\alpha}\\,\\phi(\\mathbf{r})\\,N_{\\alpha}(\\mathbf{r})\n    $$\n    问题指明 $\\phi(\\mathbf{r})$ 应被视为固定。部分电荷 $q_{\\alpha}$ 是一个常数。其导数为：\n    $$\n    \\frac{\\partial f_{3,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} = q_{\\alpha}\\,\\phi(\\mathbf{r})\n    $$\n\n综合这三个结果，总自由能 $\\mathcal{F}$ 对位点密度 $N_{\\alpha}(\\mathbf{r})$ 的泛函导数是位点类型 $\\alpha$ 的被积函数各分量偏导数的总和：\n$$\n\\frac{\\delta\\mathcal{F}}{\\delta N_{\\alpha}(\\mathbf{r})} = \\frac{\\partial f_{1,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} + \\frac{\\partial f_{2,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})} + \\frac{\\partial f_{3,\\alpha}}{\\partial N_{\\alpha}(\\mathbf{r})}\n$$\n$$\n\\frac{\\delta\\mathcal{F}}{\\delta N_{\\alpha}(\\mathbf{r})} = k_{B}T \\ln\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right) + U_{\\alpha}(\\mathbf{r}) + q_{\\alpha}\\,\\phi(\\mathbf{r})\n$$\n\n**物理解释：**\n在统计力学中，内禀自由能对粒子密度的泛函导数定义了局域化学势。因此，我们推导出的表达式是溶剂位点类型 $\\alpha$ 在位置 $\\mathbf{r}$ 的局域化学势，记为 $\\mu_{\\alpha}(\\mathbf{r})$。\n$$\n\\mu_{\\alpha}(\\mathbf{r}) = \\frac{\\delta\\mathcal{F}}{\\delta N_{\\alpha}(\\mathbf{r})}\n$$\n在热力学平衡状态下，每种物质的化学势在整个系统中必须是恒定的。$\\mu_{\\alpha}(\\mathbf{r})$ 的表达式可以通过其组成部分来理解：\n-   $k_{B}T \\ln\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right)$: 这是**理想化学势**，源于溶剂位点的平动熵（在理想气体近似下）。它代表了倾向于均匀密度分布的熵驱动力。当局部密度 $N_{\\alpha}(\\mathbf{r})$ 相对于体相密度 $N_{\\alpha}^{\\mathrm{bulk}}$ 增加时，该项会增大，对应于一个熵惩罚。\n-   $U_{\\alpha}(\\mathbf{r})$: 这是每个位点的**外部非静电势能**。它包含了短程相互作用，例如空间排斥（将溶剂从溶质核心区域排开）以及溶质和溶剂位点 $\\alpha$ 之间的范德华吸引力。在计算电化学中，该项有效地定义了溶剂化分子或表面的形状和非极性特征。\n-   $q_{\\alpha}\\phi(\\mathbf{r})$: 这是每个位点的**外部静电势能**。它是一个带部分电荷 $q_{\\alpha}$ 的位点浸入在平均场静电势 $\\phi(\\mathbf{r})$ 中所具有的能量。该势由溶质、任何电极以及（在自洽计算中）溶剂本身的电荷分布产生。该项将溶剂结构与静电环境耦合起来。\n\n平衡条件 $\\mu_{\\alpha}(\\mathbf{r}) = \\text{常数}$ 导致位点密度的玻尔兹曼分布，$N_{\\alpha}(\\mathbf{r}) = N_{\\alpha}^{\\mathrm{bulk}} \\exp\\left(-\\frac{U_{\\alpha}(\\mathbf{r}) + q_{\\alpha}\\phi(\\mathbf{r})}{k_{B}T}\\right)$，这证实了所推导表达式的物理一致性。",
            "answer": "$$\n\\boxed{k_{B}T \\ln\\left(\\frac{N_{\\alpha}(\\mathbf{r})}{N_{\\alpha}^{\\mathrm{bulk}}}\\right) + U_{\\alpha}(\\mathbf{r}) + q_{\\alpha}\\,\\phi(\\mathbf{r})}\n$$"
        },
        {
            "introduction": "在包括JDFT在内的所有连续介质溶剂化模型中，一个核心的挑战是如何精确定义溶质与溶剂之间的边界，即“溶剂空腔”。本编码练习让你通过亲手实践来比较两种常见的空腔定义方法：一种是基于固定的原子半径，另一种则是基于溶质的电子密度阈值，后者是JDFT理论中更为物理上合理的模型。通过这个练习，你将具体地看到空腔定义这一理论核心要素，如何定量地影响如水合自由能（$\\Delta G_{\\mathrm{solv}}$）这样的关键热力学性质的计算结果 。",
            "id": "4249093",
            "problem": "您需要实现一个简化的、球对称的、受联合密度泛函理论 (JDFT) 启发的连续介质溶剂化模型，以比较两种针对水中小编子的空腔定义，并量化它们对预测的水合自由能的影响。这两种空腔定义是：(i) 电子密度阈值模型和 (ii) 固定原子半径模型。每种情况下的目标量都是从线性介电响应理论获得的水合自由能的静电分量，假设室温下水的相对介电常数为 $\\varepsilon = 78.3$。\n\n起始点与假设：\n- 在联合密度泛函理论 (JDFT) 中，溶剂化自由能被表述为溶质电子密度 $n(\\mathbf{r})$ 和溶剂位点密度的泛函。在线性响应、连续介质极限下，该问题简化为经典静电学问题，其介电函数在空间上变化：空腔内部为 $1$，外部为 $\\varepsilon$。\n- 您可以假设溶质和空腔具有球对称性，一个大小为 $q$ 的点离子电荷位于原点，空腔边界半径为 $R$，该半径要么从电子密度阈值得出，要么由原子半径指定。\n- 静电溶剂化自由能从第一性原理定义为真空状态和溶剂化状态下场能量的差值，该差值可以用满足 $r=R$ 处相应边界条件的泊松方程的解来表示。\n\n待比较的空腔模型：\n1. 电子密度空腔：溶质电子密度建模为 $n(r) = n_{0}\\exp(-\\alpha r)$，其中 $\\alpha$ 的单位是埃的倒数 ($\\mathrm{\\AA}^{-1}$)，$r$ 的单位是埃 ($\\mathrm{\\AA}$)。空腔边界半径 $R_{\\mathrm{dens}}$ 由阈值 $n(r)=n_{c}$ 隐式定义，等价地，由比率 $\\eta = n_{0}/n_{c} > 1$ 定义，由此可得出以埃为单位的 $R_{\\mathrm{dens}}$。\n2. 原子半径空腔：空腔边界半径 $R_{\\mathrm{atom}}$ 直接以埃为单位指定。\n\n常量和单位：\n- 真空介电常数：$\\varepsilon_{0} = 8.8541878128\\times 10^{-12}\\ \\mathrm{F/m}$。\n- 基本电荷：$e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$。\n- 阿伏伽德罗常数：$N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- 室温下水的相对介电常数：$\\varepsilon = 78.3$ (无量纲)。\n- $1\\ \\mathrm{\\AA} = 1\\times 10^{-10}\\ \\mathrm{m}$。\n- 所有最终能量必须以千焦每摩尔 ($\\mathrm{kJ/mol}$) 为单位报告，并四舍五入到三位小数。\n\n对于每个测试用例，您的程序必须：\n- 根据 $\\alpha$ 和 $\\eta$ 计算以埃为单位的 $R_{\\mathrm{dens}}$，并将其转换为米。\n- 将以埃为单位的 $R_{\\mathrm{atom}}$ 转换为米。\n- 使用针对均匀介电介质中球形空腔的线性介电响应，计算每种空腔定义下的静电水合自由能，结果以 $\\mathrm{kJ/mol}$ 为单位表示，并四舍五入到三位小数。\n- 计算空腔选择的影响，即差值 $\\Delta = \\Delta G_{\\mathrm{dens}} - \\Delta G_{\\mathrm{atom}}$，单位为 $\\mathrm{kJ/mol}$，并四舍五入到三位小数。\n\n测试套件：\n提供以下四个测试用例的结果，每个元组指定 $(q/e,\\ \\alpha\\ \\mathrm{[\\AA^{-1}]},\\ \\eta,\\ R_{\\mathrm{atom}}\\ \\mathrm{[\\AA]})$：\n- 案例 1 (理想路径和相等边界)：$(+1,\\ 2.5,\\ 33.115451,\\ 1.40)$，此案例得出 $R_{\\mathrm{dens}}$ 等于 $1.40\\ \\mathrm{\\AA}$。\n- 案例 2 (尺寸较大的单价阴离子)：$(-1,\\ 1.2,\\ 8.665,\\ 1.80)$。\n- 案例 3 (半径较小的二价阳离子)：$(+2,\\ 3.0,\\ 14.8797,\\ 1.00)$。\n- 案例 4 (弥散的电子密度导致更大的由密度定义的空腔)：$(+1,\\ 0.8,\\ 11.02318,\\ 1.50)$，对应于 $R_{\\mathrm{dens}} \\approx 3.00\\ \\mathrm{\\AA}$。\n\n角度单位不适用。百分比不使用。\n\n最终输出规格：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按顺序附加三个值：$[\\Delta G_{\\mathrm{dens}},\\ \\Delta G_{\\mathrm{atom}},\\ \\Delta]$，单位为 $\\mathrm{kJ/mol}$，并四舍五入到三位小数。对于所有四个连接起来的案例，输出必须是一个包含十二个条目的扁平列表，例如：$[\\mathrm{case1\\_Gdens},\\mathrm{case1\\_Gatom},\\mathrm{case1\\_Delta},\\mathrm{case2\\_Gdens},\\dots,\\mathrm{case4\\_Delta}]$。",
            "solution": "该问题被认为是有效的，因为它在经典静电学（Born 溶剂化模型）中有科学依据，是一个具有完整且一致参数集的适定问题，并使用了客观、可形式化的语言。通过应用基本原理可以确定唯一解。我们开始进行求解。\n\n这个问题的核心是使用线性介电响应理论的框架，为两种不同空腔定义下的球形离子计算水合自由能的静电分量 $\\Delta G$。其结果实际上就是 Born 溶剂化能。\n\n**1. 空腔半径定义**\n\n问题提供了两种空腔半径 $R$ 的模型，该半径定义了溶质区域（相对介电常数 $\\varepsilon_r = 1$）和溶剂连续介质（相对介电常数 $\\varepsilon = 78.3$）之间的边界。\n\na) **电子密度空腔 ($R_{\\mathrm{dens}}$)**：\n溶质的电子密度由球对称函数 $n(r) = n_{0}\\exp(-\\alpha r)$ 给出，其中 $r$ 是距原点的径向距离。空腔边界 $R_{\\mathrm{dens}}$ 定义为电子密度下降到某个阈值 $n_c$ 时的半径。问题给出了比率 $\\eta = n_0 / n_c$。\n\n定义条件为：\n$$ n(R_{\\mathrm{dens}}) = n_c $$\n代入 $n(r)$ 的表达式：\n$$ n_0 \\exp(-\\alpha R_{\\mathrm{dens}}) = n_c $$\n整理各项得：\n$$ \\exp(-\\alpha R_{\\mathrm{dens}}) = \\frac{n_c}{n_0} = \\frac{1}{\\eta} $$\n对两边取自然对数：\n$$ -\\alpha R_{\\mathrm{dens}} = \\ln\\left(\\frac{1}{\\eta}\\right) = -\\ln(\\eta) $$\n解出 $R_{\\mathrm{dens}}$ 可得：\n$$ R_{\\mathrm{dens}} = \\frac{\\ln(\\eta)}{\\alpha} $$\n鉴于 $\\alpha$ 的单位是 $\\mathrm{\\AA}^{-1}$，$R_{\\mathrm{dens}}$ 将以埃 ($\\mathrm{\\AA}$) 为单位计算得出。\n\nb) **原子半径空腔 ($R_{\\mathrm{atom}}$)**：\n该模型简单地将空腔半径定义为一个固定值 $R_{\\mathrm{atom}}$，以埃为单位提供。\n\n**2. 静电溶剂化自由能的推导**\n\n静电溶剂化自由能 $\\Delta G$ 是将一个离子从真空转移到介电介质中所做的功。在线性响应理论中，这等于电荷与极化介电介质产生的电势（即反应场）之间相互作用能的一半。\n\n我们求解位于半径为 $R$ 的球形空腔（被相对介电常数为 $\\varepsilon$ 的介电介质包围）中心、由原点处的点电荷 $q$ 产生的静电势 $\\phi$ 的泊松方程。空腔内部区域 ($r  R$) 的相对介电常数为 $1$。\n\n电势 $\\phi(r)$ 必须满足以下形式，这是球对称拉普拉斯方程（对于 $r > 0$ 有 $\\nabla^2 \\phi = 0$）的通解：\n$$\n\\phi(r) =\n\\begin{cases}\n    \\phi_{\\mathrm{in}}(r) = \\frac{q}{4\\pi\\varepsilon_0 r} + C   \\text{for } r  R \\\\\n    \\phi_{\\mathrm{out}}(r) = \\frac{B}{r}   \\text{for } r > R\n\\end{cases}\n$$\n此处，$\\frac{q}{4\\pi\\varepsilon_0 r}$ 是点电荷自身的电势。常数 $C$ 是由介电边界 $r=R$ 上的感应表面电荷在空腔内部产生的电势。电势 $\\phi_{\\mathrm{out}}$ 在 $r \\to \\infty$ 时必须趋于零。\n\n常数 $B$ 和 $C$ 通过在 $r=R$ 处施加边界条件来确定：\ni) 电势的连续性：$\\phi_{\\mathrm{in}}(R) = \\phi_{\\mathrm{out}}(R)$\n$$ \\frac{q}{4\\pi\\varepsilon_0 R} + C = \\frac{B}{R} $$\n\nii) 电位移场法向分量 $D_r = -\\varepsilon_r \\varepsilon_0 \\frac{d\\phi}{dr}$ 的连续性：\n$$ (1) \\varepsilon_0 \\left(-\\frac{d\\phi_{\\mathrm{in}}}{dr}\\right)\\bigg|_{R} = (\\varepsilon) \\varepsilon_0 \\left(-\\frac{d\\phi_{\\mathrm{out}}}{dr}\\right)\\bigg|_{R} $$\n$$ \\left( \\frac{q}{4\\pi\\varepsilon_0 R^2} \\right) = \\varepsilon \\left( \\frac{B}{R^2} \\right) \\implies B = \\frac{q}{4\\pi\\varepsilon_0 \\varepsilon} $$\n\n将 $B$ 代入第一个边界条件方程以求解 $C$：\n$$ C = \\frac{B}{R} - \\frac{q}{4\\pi\\varepsilon_0 R} = \\frac{1}{R} \\left( \\frac{q}{4\\pi\\varepsilon_0 \\varepsilon} - \\frac{q}{4\\pi\\varepsilon_0} \\right) = \\frac{q}{4\\pi\\varepsilon_0 R} \\left( \\frac{1}{\\varepsilon} - 1 \\right) $$\n\n常数 $C$ 是在球体内求值的反应场电势 $\\phi_{\\mathrm{rxn}}$。溶剂化自由能是在此反应场存在的情况下为离子充电所做的功，由 $\\Delta G = \\frac{1}{2}q\\phi_{\\mathrm{rxn}}$ 给出。\n$$ \\Delta G_{\\mathrm{ion}} = \\frac{1}{2} q C = \\frac{1}{2} q \\left[ \\frac{q}{4\\pi\\varepsilon_0 R} \\left( \\frac{1}{\\varepsilon} - 1 \\right) \\right] = \\frac{q^2}{8\\pi\\varepsilon_0 R} \\left( \\frac{1}{\\varepsilon} - 1 \\right) $$\n这就是著名的 Born 能量公式。请注意，由于 $\\varepsilon > 1$，$\\Delta G_{\\mathrm{ion}}$ 为负，表明溶剂化是一个自发过程。\n\n**3. 最终计算公式**\n\n问题要求能量以千焦每摩尔 ($\\mathrm{kJ/mol}$) 为单位。推导出的公式给出的能量单位是焦耳每离子。通过乘以阿伏伽德罗常数 $N_{\\mathrm{A}}$ 和用于“千”前缀的因子 $1/1000$ 来进行转换。电荷 $q$ 以基本电荷 $e$ 的倍数给出，因此 $q = (q/e) \\times e$。半径 $R$ 以埃 ($\\mathrm{\\AA}$) 为单位给出，必须转换为米 ($\\mathrm{m}$) 以与物理常量的国际单位制 (SI) 单位保持一致 ($1\\ \\mathrm{\\AA} = 10^{-10}\\ \\mathrm{m}$)。\n\n设 $q_{\\mathrm{norm}} = q/e$，$R_{\\mathrm{\\AA}}$ 是以埃为单位的半径。\n$$ \\Delta G\\ [\\mathrm{kJ/mol}] = \\frac{N_{\\mathrm{A}} (q_{\\mathrm{norm}} \\cdot e)^2}{8\\pi\\varepsilon_0 (R_{\\mathrm{\\AA}} \\cdot 10^{-10})} \\left( \\frac{1}{\\varepsilon} - 1 \\right) \\cdot \\frac{1}{1000} $$\n我们可以将常数组合成一个单一的预因子 $K$ 以简化计算：\n$$ K = \\frac{N_{\\mathrm{A}} e^2}{8000 \\pi \\varepsilon_0} \\left( \\frac{1}{\\varepsilon} - 1 \\right) \\cdot 10^{10} $$\n直接使用以埃为单位的半径的最终公式是：\n$$ \\Delta G\\ [\\mathrm{kJ/mol}] = K \\frac{q_{\\mathrm{norm}}^2}{R_{\\mathrm{\\AA}}} $$\n使用所提供的值：\n- $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$\n- $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n- $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$\n- $\\varepsilon = 78.3$\n预因子 $K$ 的计算结果约为 $-6861.30085\\ \\mathrm{kJ\\cdot\\AA/mol}$。\n\n**4. 计算算法**\n\n对于每个由元组 $(q_{\\mathrm{norm}},\\ \\alpha,\\ \\eta,\\ R_{\\mathrm{atom}})$ 定义的测试用例：\n1.  计算由密度定义的空腔半径 $R_{\\mathrm{dens}} = \\ln(\\eta) / \\alpha$。\n2.  计算由密度定义的空腔的水合自由能：\n    $\\Delta G_{\\mathrm{dens}} = K \\cdot q_{\\mathrm{norm}}^2 / R_{\\mathrm{dens}}$。\n3.  计算由原子半径定义的空腔的水合自由能：\n    $\\Delta G_{\\mathrm{atom}} = K \\cdot q_{\\mathrm{norm}}^2 / R_{\\mathrm{atom}}$。\n4.  计算差值：$\\Delta = \\Delta G_{\\mathrm{dens}} - \\Delta G_{\\mathrm{atom}}$。\n5.  所有三个得出的能量值在存储前都四舍五入到三位小数。\n\n此过程将对所有提供的测试用例实施，以生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares electrostatic hydration free energies for two\n    cavity models based on a simplified JDFT approach.\n    \"\"\"\n    # Define physical constants\n    EPS_0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\n    E_CHARGE = 1.602176634e-19   # Elementary charge (C)\n    N_A = 6.02214076e23        # Avogadro constant (mol^-1)\n    EPS_R = 78.3                 # Relative permittivity of water\n    \n    # Pre-calculate the constant factor for the Born energy calculation in kJ/mol\n    # using radius in Angstroms.\n    # The formula is: (N_A * q^2) / (8 * pi * eps_0 * R) * (1/eps_r - 1)\n    # The components are:\n    # - q = q_norm * E_CHARGE\n    # - R = R_angstrom * 1e-10\n    # - Conversion to kJ: factor of 1/1000\n    # Prefactor K such that delta_G (kJ/mol) = K * q_norm^2 / R_angstrom\n    K = (N_A * E_CHARGE**2) / (8000 * np.pi * EPS_0) * (1/EPS_R - 1) * 1e10\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (q/e, alpha [1/A], eta, R_atom [A])\n    test_cases = [\n        (1.0, 2.5, 33.115451, 1.40),\n        (-1.0, 1.2, 8.665, 1.80),\n        (2.0, 3.0, 14.8797, 1.00),\n        (1.0, 0.8, 11.02318, 1.50),\n    ]\n\n    results = []\n    \n    def custom_round(value):\n        \"\"\"\n        Rounds a number to 3 decimal places (symmetric rounding).\n        This avoids inconsistencies with Python's default round-half-to-even.\n        \"\"\"\n        return np.sign(value) * np.floor(np.abs(value) * 1000 + 0.5) / 1000\n\n    for case in test_cases:\n        q_norm, alpha, eta, r_atom = case\n        \n        # 1. Compute R_dens from alpha and eta\n        # R_dens = ln(eta) / alpha\n        r_dens = np.log(eta) / alpha\n        \n        # 2. Compute hydration free energy for both cavity models\n        # delta_G = K * q_norm^2 / R\n        \n        # Using full precision for intermediate calculations\n        delta_g_dens_full = K * (q_norm**2) / r_dens\n        delta_g_atom_full = K * (q_norm**2) / r_atom\n        \n        # 3. Compute the difference\n        delta_full = delta_g_dens_full - delta_g_atom_full\n        \n        # 4. Round final results to three decimal places\n        delta_g_dens = custom_round(delta_g_dens_full)\n        delta_g_atom = custom_round(delta_g_atom_full)\n        delta = custom_round(delta_full)\n\n        results.extend([delta_g_dens, delta_g_atom, delta])\n\n    # Final print statement in the exact required format.\n    # Using f-string formatting to ensure three decimal places for all numbers,\n    # including those rounding to .000\n    formatted_results = [f\"{x:.3f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "许多简化模型将溶剂分子或离子视为理想的点粒子，这种近似在高浓度或带电表面附近会失效。本项高级练习将指导你如何在模型中引入粒子的有限尺寸效应，即“拥挤效应”，这对于真实模拟电化学界面至关重要。通过推导并实现一个晶格气模型，你将能够观察到密度饱和这一重要的非理想现象，并掌握模拟拥挤离子体系的实用技能 。",
            "id": "4249192",
            "problem": "考虑在联合密度泛函理论 (Joint Density Functional Theory, JDFT) 框架内建模的连续介质溶剂中的对称单价电解质，其中 JDFT 将溶质的电子密度泛函理论 (Density Functional Theory, DFT) 与液体和离子分布的经典密度泛函耦合起来。在经典子系统中，假设离子占据有限体积并遵循格气熵。设局域静电势为 $\\,\\phi\\,$，温度为 $\\,T\\,$。元电荷为 $\\,e\\,$，Boltzmann 常数为 $\\,k_{\\mathrm{B}}\\,$，Avogadro 数为 $\\,N_{\\mathrm{A}}\\,$。设体相摩尔浓度为 $\\,c_0\\,$（单位 $\\mathrm{mol/L}$），并假设每个离子占据一个边长为 $\\,a\\,$（单位 $\\mathrm{nm}$）的立方晶胞，因此当 $\\,a\\,$ 转换为米时，最大数密度为 $\\,n_{\\max} = a^{-3}\\,$。体相数密度为 $\\,n_b = 1000\\,c_0\\,N_{\\mathrm{A}}\\,$（单位 $\\mathrm{m^{-3}}$）。定义填充分数 $\\,\\nu = n_b/n_{\\max}\\,$.\n\n从离子子系统的经典密度泛函理论的第一性原理出发，使用以下基本依据：\n- 静电学由 Poisson 方程控制，离子密度的平均场平衡是通过在静电势 $\\,\\phi\\,$ 的约束下，最小化关于离子密度场的巨自由能泛函得到的。\n- 对于晶格上具有有限尺寸排斥效应的物质，其理想气体混合熵导致一个熵项，该项在局域占据率接近 $\\,n_{\\max}\\,$ 时对拥挤效应产生惩罚。\n- 在平衡状态下，局域化学势包括对离子价态 $\\,z_i\\,$ 的静电贡献 $\\,z_i e \\phi\\,$ 和强制执行排斥体积约束的熵项。\n\n你的任务是推导、实现并评估考虑了有限尺寸修正的非线性离子拥挤效应，并预测在极端电势下反离子密度的饱和情况。假设一个对称的 $\\,1:1\\,$ 电解质，其离子价态为 $\\,z_+ = +1\\,$ 和 $\\,z_- = -1\\,$，且分子大小相同。对于给定的局域电势 $\\,\\phi\\,$，将反离子定义为价态符号与 $\\,\\phi\\,$ 相反的离子。从变分平衡条件出发，得到一个局域反离子数密度 $\\,n_{\\mathrm{counter}}(\\phi)\\,$ 的表达式，该表达式考虑了有限尺寸排斥和拥挤效应，并用 $\\,n_b\\,$, $\\,n_{\\max}\\,$, $\\,e\\,$, $\\,k_{\\mathrm{B}}\\,$ 和 $\\,T\\,$ 表示。使用此表达式计算饱和分数\n$$\ns(\\phi) = \\frac{n_{\\mathrm{counter}}(\\phi)}{n_{\\max}} \\, ,\n$$\n由于拥挤限制下的密堆积，当 $\\,|\\phi|\\to\\infty\\,$ 时，该值必须趋近于 $\\,1\\,$。\n\n实现一个完整的程序，该程序：\n- 将 $\\,c_0\\,$ 从 $\\mathrm{mol/L}$ 转换为 $\\mathrm{mol/m^3}$，将 $\\,a\\,$ 从 $\\mathrm{nm}$ 转换为 $\\mathrm{m}$，然后计算 $\\,n_b\\,$, $\\,n_{\\max}\\,$ 和 $\\,\\nu\\,$。\n- 对每个测试案例，使用推导出的有限尺寸修正的平衡分布来计算 $\\,s(\\phi)\\,$。\n- 一致地处理反离子的符号：对于 $\\,\\phi > 0\\,$，反离子是阴离子 ($\\,z_- = -1\\,$)；对于 $\\,\\phi  0\\,$，反离子是阳离子 ($\\,z_+ = +1\\,$)。对于 $\\,\\phi = 0\\,$，两种离子的密度相等且等于体相密度，所以 $\\,s(0) = \\nu\\,$。\n- 在数值上稳定地处理极端电势，以便程序能正确预测当 $\\,|\\phi|\\,$ 变大时 $\\,s(\\phi)\\to 1\\,$。\n\n物理和数值单位：\n- $\\,T\\,$ 必须以 $\\,\\mathrm{K}\\,$ 为单位提供。\n- $\\,c_0\\,$ 必须以 $\\,\\mathrm{mol/L}\\,$ 为单位提供。\n- $\\,a\\,$ 必须以 $\\,\\mathrm{nm}\\,$ 为单位提供。\n- $\\,\\phi\\,$ 必须以 $\\,\\mathrm{V}\\,$ 为单位提供。\n- 输出的饱和分数 $\\,s(\\phi)\\,$ 是无量纲的。\n\n测试套件：\n- 案例 $1$：$\\,T=298\\,$, $\\,c_0=1.0\\,$, $\\,a=0.3\\,$, $\\,\\phi=0.0\\,$。\n- 案例 $2$：$\\,T=298\\,$, $\\,c_0=1.0\\,$, $\\,a=0.3\\,$, $\\,\\phi=0.1\\,$。\n- 案例 $3$：$\\,T=298\\,$, $\\,c_0=1.0\\,$, $\\,a=0.3\\,$, $\\,\\phi=5.0\\,$。\n- 案例 $4$：$\\,T=298\\,$, $\\,c_0=4.0\\,$, $\\,a=0.4\\,$, $\\,\\phi=5.0\\,$。\n- 案例 $5$：$\\,T=298\\,$, $\\,c_0=0.01\\,$, $\\,a=0.7\\,$, $\\,\\phi=10.0\\,$。\n- 案例 $6$：$\\,T=298\\,$, $\\,c_0=1.0\\,$, $\\,a=0.3\\,$, $\\,\\phi=-1.0\\,$。\n\n答案规格：\n- 你的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表，按测试案例的顺序列出结果，每个条目是四舍五入到六位小数的 $\\,s(\\phi)\\,$（例如，$\\,\\,[0.123456,0.654321]\\,\\,$）。\n\n科学真实性：\n- 所有常数和转换必须在物理上是一致的。\n- 程序不能依赖任何输入；它必须使用上述测试套件自包含地运行，并且只使用指定的库。\n\n仅按指定格式生成程序输出行。",
            "solution": "目标是在经典密度泛函理论 (Density Functional Theory, DFT) 的框架内，推导并实现一个用于计算对称单价电解质中反离子饱和分数 $s(\\phi) = n_{\\mathrm{counter}}(\\phi) / n_{\\max}$ 的公式，该公式考虑了离子的有限尺寸。推导过程基于最小化巨自由能泛函的原理，在平衡状态下，这对应于系统中每种离子物质的化学势处处相等。\n\n设在局域静电势为 $\\phi$ 的点，阳离子和阴离子的数密度分别为 $n_+(\\phi)$ 和 $n_-(\\phi)$。电解质是对称单价的，因此离子价态为 $z_+=+1$ 和 $z_-=-1$。离子被建模为大小相同的硬质粒子，每个占据一个体积 $v = a^3$。这设定了离子的最大总数密度 $n_{\\max} = 1/v = a^{-3}$。\n\n离子子系统的巨自由能泛函包括熵、静电和化学势贡献。在平衡时，每种物质 $i \\in \\{+,-\\}$ 的化学势 $\\mu_i$ 必须处处恒定。局域化学势由自由能相对于密度的泛函导数给出，对于格气模型，其形式为：\n$$\n\\mu_i = \\frac{\\delta F_{\\text{ideal}}}{\\delta n_i} + z_i e \\phi + \\mu_i^0\n$$\n其中 $e$ 是元电荷，$\\mu_i^0$ 是标准态化学势，$F_{\\text{ideal}}$ 是包含有限尺寸排斥效应的理想自由能。对于不同种类的粒子竞争相同格点的格气模型，理想自由能密度（忽略非必要的德布罗意热波长项）可从混合熵推导得出：\n$$\nf_{\\text{ideal}}(n_+, n_-) = k_{\\mathrm{B}}T \\left[ n_+ \\ln\\left(\\frac{n_+}{n_{\\max}}\\right) + n_- \\ln\\left(\\frac{n_-}{n_{\\max}}\\right) + (n_{\\max} - n_+ - n_-) \\ln\\left(1 - \\frac{n_+ + n_-}{n_{\\max}}\\right) \\right]\n$$\n这里，$k_{\\mathrm{B}}$ 是 Boltzmann 常数，$T$ 是温度。项 $(n_{\\max} - n_+ - n_-)$ 代表空位的密度。因此，物质 $i$ 的局域化学势为：\n$$\n\\mu_i(n_+, n_-) = \\frac{\\partial f_{\\text{ideal}}}{\\partial n_i} + z_i e \\phi + \\mu_i^0 = k_{\\mathrm{B}}T \\ln \\left( \\frac{n_i}{n_{\\max} - n_+ - n_-} \\right) + z_i e \\phi + \\mu_i^0\n$$\n在远离任何表面的体相溶液中，静电势为零 ($\\phi=0$)，且系统是电中性的。对于体相摩尔浓度为 $c_0$ 的对称 $1:1$ 电解质，每种离子物质的数密度由 $n_b = 1000 N_{\\mathrm{A}} c_0$ 给出，其中 $N_{\\mathrm{A}}$ 是 Avogadro 数，因子 $1000$ 用于将单位从 $\\mathrm{L}^{-1}$ 转换为 $\\mathrm{m^3}$。在 $\\phi=0$ 时，我们有 $n_+ = n_- = n_b$。体相化学势为：\n$$\n\\mu_{i, \\text{bulk}} = k_{\\mathrm{B}}T \\ln \\left( \\frac{n_b}{n_{\\max} - 2n_b} \\right) + \\mu_i^0\n$$\n通过令局域化学势 $\\mu_i(n_+, n_-)$ 等于体相化学势 $\\mu_{i, \\text{bulk}}$，我们建立了平衡条件：\n$$\nk_{\\mathrm{B}}T \\ln \\left( \\frac{n_i}{n_{\\max} - n_+ - n_-} \\right) + z_i e \\phi = k_{\\mathrm{B}}T \\ln \\left( \\frac{n_b}{n_{\\max} - 2n_b} \\right)\n$$\n对每种物质（$z_+=1, z_-=-1$）进行整理：\n$$\n\\frac{n_+}{n_{\\max} - n_+ - n_-} = \\frac{n_b}{n_{\\max} - 2n_b} \\exp\\left(-\\frac{e\\phi}{k_{\\mathrm{B}}T}\\right)\n$$\n$$\n\\frac{n_-}{n_{\\max} - n_+ - n_-} = \\frac{n_b}{n_{\\max} - 2n_b} \\exp\\left(\\frac{e\\phi}{k_{\\mathrm{B}}T}\\right)\n$$\n这是一个关于两个未知密度 $n_+$ 和 $n_-$ 的二元方程组。令 $\\beta = (k_{\\mathrm{B}}T)^{-1}$。我们可以求解 $n_+$ 和 $n_-$ 以获得其对 $\\phi$ 的显式依赖关系：\n$$\nn_i(\\phi) = \\frac{n_{\\max} n_b \\exp(-z_i e \\beta \\phi)}{(n_{\\max} - 2n_b) + n_b \\left[ \\exp(-e \\beta \\phi) + \\exp(e \\beta \\phi) \\right]}\n$$\n反离子是价态 $z_{\\text{counter}}$ 符号与 $\\phi$ 相反的物质，即 $z_{\\text{counter}}\\phi  0$。因此反离子的指数项为 $\\exp(-z_{\\text{counter}} e \\beta \\phi) = \\exp(e \\beta |z_{\\text{counter}}\\phi|) = \\exp(e \\beta |\\phi|)$，因为 $|z_{\\text{counter}}|=1$。\n反离子密度 $n_{\\mathrm{counter}}(\\phi)$ 由下式给出：\n$$\nn_{\\mathrm{counter}}(\\phi) = \\frac{n_{\\max} n_b \\exp(e \\beta |\\phi|)}{(n_{\\max} - 2n_b) + n_b \\left[ \\exp(-e \\beta |\\phi|) + \\exp(e \\beta |\\phi|) \\right]}\n$$\n饱和分数 $s(\\phi)$ 定义为 $n_{\\mathrm{counter}}(\\phi) / n_{\\max}$：\n$$\ns(\\phi) = \\frac{n_b \\exp(e \\beta |\\phi|)}{(n_{\\max} - 2n_b) + n_b \\left[ \\exp(-e \\beta |\\phi|) + \\exp(e \\beta |\\phi|) \\right]}\n$$\n为了提高 $|\\phi|$ 较大值时的数值稳定性，我们将分子和分母同除以 $\\exp(e \\beta |\\phi|)$：\n$$\ns(\\phi) = \\frac{n_b}{(n_{\\max} - 2n_b)\\exp(-e \\beta |\\phi|) + n_b \\left[ 1 + \\exp(-2e \\beta |\\phi|) \\right]}\n$$\n引入单一物质的体相填充分数 $\\nu = n_b/n_{\\max}$，我们得到一个无量纲表达式：\n$$\ns(\\phi) = \\frac{\\nu}{(1 - 2\\nu)\\exp(-e \\beta |\\phi|) + \\nu \\left[ 1 + \\exp(-2e \\beta |\\phi|) \\right]}\n$$\n这个最终表达式在数值上是稳健的。对于 $\\phi=0$，指数项为 $1$，得出 $s(0) = \\nu / ((1-2\\nu) + \\nu(1+1)) = \\nu/1 = \\nu$，这与问题陈述一致。当 $|\\phi| \\to \\infty$ 时，指数项趋向于 $0$，而 $s(\\phi) \\to \\nu / (0 + \\nu(1+0)) = 1$，正确地捕捉了由有限离子体积引起的饱和现象。该表达式将用于实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates the counter-ion saturation fraction s(phi) for an electrolyte\n    with finite ion size corrections based on a lattice-gas model.\n    \"\"\"\n\n    # Physical Constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    KB_J_K = 1.380649e-23       # Boltzmann constant in J/K\n    N_A = 6.02214076e23         # Avogadro's number in mol^-1\n\n    # Test cases from the problem statement\n    # Each case is a tuple: (T in K, c0 in mol/L, a in nm, phi in V)\n    test_cases = [\n        (298.0, 1.0, 0.3, 0.0),\n        (298.0, 1.0, 0.3, 0.1),\n        (298.0, 1.0, 0.3, 5.0),\n        (298.0, 4.0, 0.4, 5.0),\n        (298.0, 0.01, 0.7, 10.0),\n        (298.0, 1.0, 0.3, -1.0),\n    ]\n\n    results = []\n\n    for T, c0, a, phi in test_cases:\n        # Step 1: Convert units to SI and calculate model parameters\n        \n        # Convert molar concentration from mol/L to mol/m^3\n        c0_si = c0 * 1000.0  # mol/m^3\n        \n        # Convert ion size from nm to m\n        a_si = a * 1e-9  # m\n        \n        # Calculate bulk number density of a single ionic species (m^-3)\n        n_b = c0_si * N_A\n        \n        # Calculate maximum total number density of ions (m^-3)\n        n_max = 1.0 / (a_si**3)\n        \n        # Calculate the filling fraction of a single species in the bulk\n        # This parameter 'nu' is dimensionless\n        nu = n_b / n_max\n        \n        # The derivation is valid for 2*nu  1, which means n_max > 2*n_b.\n        # This condition means the bulk concentration is physically possible.\n        # This holds for all test cases.\n\n        # Step 2: Calculate the saturation fraction s(phi)\n        \n        # The derived formula is s(phi) = nu / ((1-2*nu)*exp(-e*|phi|/kT) + nu*(1 + exp(-2*e*|phi|/kT)))\n        # This form is numerically stable for all values of phi, including large |phi| and phi=0.\n\n        # Calculate thermal energy\n        k_B_T = KB_J_K * T\n        \n        # Calculate the argument of the exponential, which is dimensionless\n        # This is the ratio of electrostatic energy to thermal energy\n        exp_arg = E_CHARGE * abs(phi) / k_B_T\n\n        # Numerically stable calculation of exp(-arg)\n        neg_exp_val = np.exp(-exp_arg)\n        \n        # Apply the derived formula for the saturation fraction\n        denominator = (1.0 - 2.0 * nu) * neg_exp_val + nu * (1.0 + neg_exp_val**2)\n        \n        # Handle the edge case where denominator might be zero, although not expected\n        # for nu  0.5.\n        if denominator == 0:\n            # For large |phi|, this should limit to 1.0. Denominator -> nu. s -> 1.\n            s_phi = 1.0\n        else:\n            s_phi = nu / denominator\n\n        results.append(s_phi)\n    \n    # Format the results to 6 decimal places and print in the specified format\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}