{
    "hands_on_practices": [
        {
            "introduction": "The Distribution of Relaxation Times (DRT) is not merely a mathematical construct; for many electrochemical systems, it is a direct reflection of underlying physical processes. This is especially true for diffusion-limited phenomena in porous media, where the spectrum of relaxation times, $\\tau$, corresponds to a distribution of characteristic diffusion lengths, $l$. This exercise  provides a foundational practice in connecting the abstract DRT to tangible microstructural properties by deriving how the span of relaxation times is governed by the geometry and transport properties of an electrode.",
            "id": "4242756",
            "problem": "A porous composite electrode exhibits diffusion-controlled impedance features whose Distribution of Relaxation Times (DRT) reflects a spread of microstructural length scales. Consider one-dimensional small-signal mass transport of a neutral species with effective diffusivity across a characteristic diffusion path of length $l$. The spatiotemporal dynamics are described by Fick’s second law for an effectively homogeneous medium,\n$\\displaystyle \\frac{\\partial c}{\\partial t} = D_{\\mathrm{eff}}(l)\\,\\frac{\\partial^{2} c}{\\partial x^{2}}$\non the interval $0 \\le x \\le l$, with physically reasonable linear boundary conditions appropriate for a galvanostatic perturbation at $x=0$ and no flux into a blocking matrix at $x=l$. The porous geometry is characterized by a tortuosity factor $\\mathcal{T}(l)$ that modifies the effective diffusivity according to $D_{\\mathrm{eff}}(l) = D/\\mathcal{T}(l)$, where $D$ is the intrinsic molecular diffusivity. Assume a scale-dependent tortuosity of the form $\\mathcal{T}(l) = \\left(\\frac{l}{l_{0}}\\right)^{\\alpha}$ with known exponent $\\alpha$ and reference length $l_{0}$. \n\nUsing only fundamental transport principles and dimensional analysis applied to the diffusion equation, first justify the scaling of the dominant relaxation time with $l$ and $D_{\\mathrm{eff}}(l)$. Then, deduce the dependence of the ratio of the largest to the smallest relaxation time on $l_{\\max}/l_{\\min}$ and $\\alpha$ for a microstructure whose diffusion path lengths are distributed over the interval $\\left[l_{\\min},\\,l_{\\max}\\right]$. Finally, evaluate the logarithmic span in decades of the diffusion-controlled DRT features,\n$\\displaystyle N \\equiv \\log_{10}\\!\\left(\\frac{\\tau_{\\max}}{\\tau_{\\min}}\\right),$\nfor the following parameters:\n$\\displaystyle D = 3.0 \\times 10^{-11}\\ \\text{m}^{2}\\,\\text{s}^{-1},\\quad l_{0} = 1.0\\ \\mu\\text{m},\\quad \\alpha = 0.40,\\quad l_{\\min} = 50\\ \\text{nm},\\quad l_{\\max} = 20\\ \\mu\\text{m}.$\n\nExpress the final value of $N$ as a pure number (no units) and round your answer to three significant figures.",
            "solution": "The problem is scientifically grounded, well-posed, and objective. It is based on the fundamental principles of mass transport (Fick's second law) and standard concepts in the analysis of porous media (tortuosity, effective diffusivity, relaxation times). The provided information is self-contained and sufficient to derive the requested quantities. We may therefore proceed with the solution.\n\nThe problem requires a three-part analysis: first, to justify the scaling of the dominant relaxation time $\\tau$ from fundamental principles; second, to derive the dependence of the ratio of maximum to minimum relaxation times on the system parameters; and third, to compute the logarithmic span of these times.\n\nFirst, we determine the characteristic relaxation time $\\tau$ for a diffusion process over a length scale $l$. The governing equation is Fick's second law for a homogeneous medium:\n$$\n\\frac{\\partial c}{\\partial t} = D_{\\mathrm{eff}}(l)\\,\\frac{\\partial^{2} c}{\\partial x^{2}}\n$$\nWe perform a dimensional analysis of this partial differential equation. Let $[T]$, $[L]$, and $[C]$ represent the characteristic scales for time, length, and concentration, respectively. The characteristic time scale is the relaxation time, $\\tau$, so $[T] = \\tau$. The characteristic length scale is the diffusion path length, $l$, so $[L] = l$. The magnitude of the concentration fluctuation can be taken as some reference value, $c_0$, so $[C] = c_0$.\n\nThe partial derivatives can be approximated by ratios of these characteristic scales:\n$$\n\\frac{\\partial c}{\\partial t} \\sim \\frac{[C]}{[T]} = \\frac{c_0}{\\tau}\n$$\n$$\n\\frac{\\partial^{2} c}{\\partial x^{2}} \\sim \\frac{[C]}{[L]^2} = \\frac{c_0}{l^2}\n$$\nThe effective diffusivity, $D_{\\mathrm{eff}}(l)$, has dimensions of $[L]^2/[T]$. Substituting these scaling relations into the governing equation yields a balance of the terms' orders of magnitude:\n$$\n\\frac{c_0}{\\tau} \\propto D_{\\mathrm{eff}}(l) \\frac{c_0}{l^2}\n$$\nBy rearranging this proportionality, we can isolate the relaxation time $\\tau$:\n$$\n\\tau \\propto \\frac{l^2}{D_{\\mathrm{eff}}(l)}\n$$\nThis relationship demonstrates that the dominant relaxation time for diffusion scales quadratically with the diffusion length and inversely with the effective diffusivity. This is the well-known characteristic diffusion time.\n\nSecond, we deduce the dependence of the ratio $\\tau_{\\max}/\\tau_{\\min}$ on the given parameters. The problem provides expressions for the effective diffusivity $D_{\\mathrm{eff}}(l)$ and the tortuosity $\\mathcal{T}(l)$:\n$$\nD_{\\mathrm{eff}}(l) = \\frac{D}{\\mathcal{T}(l)}\n$$\n$$\n\\mathcal{T}(l) = \\left(\\frac{l}{l_{0}}\\right)^{\\alpha}\n$$\nHere, $D$ is the intrinsic molecular diffusivity, $l_{0}$ is a reference length, and $\\alpha$ is a constant exponent. Substituting these into the scaling law for $\\tau$:\n$$\n\\tau(l) \\propto \\frac{l^2}{D/\\mathcal{T}(l)} = \\frac{l^2 \\mathcal{T}(l)}{D} = \\frac{l^2}{D} \\left(\\frac{l}{l_{0}}\\right)^{\\alpha}\n$$\nSince $D$ and $l_{0}$ are constants, we can express the dependence of $\\tau$ on $l$ as:\n$$\n\\tau(l) \\propto \\frac{l^2 \\cdot l^{\\alpha}}{D \\cdot l_{0}^{\\alpha}} \\propto l^{2+\\alpha}\n$$\nThe problem states that the diffusion path lengths are distributed over the interval $[l_{\\min}, l_{\\max}]$. Since $\\tau(l)$ is a monotonically increasing function of $l$ (as $2+\\alpha > 0$), the minimum relaxation time $\\tau_{\\min}$ corresponds to $l_{\\min}$, and the maximum relaxation time $\\tau_{\\max}$ corresponds to $l_{\\max}$.\n$$\n\\tau_{\\min} \\propto (l_{\\min})^{2+\\alpha}\n$$\n$$\n\\tau_{\\max} \\propto (l_{\\max})^{2+\\alpha}\n$$\nThe ratio of the largest to the smallest relaxation time is therefore:\n$$\n\\frac{\\tau_{\\max}}{\\tau_{\\min}} = \\frac{k \\cdot (l_{\\max})^{2+\\alpha}}{k \\cdot (l_{\\min})^{2+\\alpha}} = \\left(\\frac{l_{\\max}}{l_{\\min}}\\right)^{2+\\alpha}\n$$\nwhere $k$ is the constant of proportionality. This expression gives the required dependence on the ratio $l_{\\max}/l_{\\min}$ and the exponent $\\alpha$. Note that this ratio is independent of $D$ and $l_0$.\n\nThird, we evaluate the logarithmic span $N$, defined as:\n$$\nN \\equiv \\log_{10}\\!\\left(\\frac{\\tau_{\\max}}{\\tau_{\\min}}\\right)\n$$\nSubstituting the derived ratio:\n$$\nN = \\log_{10}\\!\\left( \\left(\\frac{l_{\\max}}{l_{\\min}}\\right)^{2+\\alpha} \\right)\n$$\nUsing the property of logarithms $\\log(x^y) = y\\log(x)$, we get:\n$$\nN = (2+\\alpha) \\log_{10}\\!\\left(\\frac{l_{\\max}}{l_{\\min}}\\right)\n$$\nWe are given the following parameter values: $\\alpha = 0.40$, $l_{\\min} = 50\\ \\text{nm}$, and $l_{\\max} = 20\\ \\mu\\text{m}$.\nFirst, we compute the ratio of the lengths, ensuring consistent units:\n$$\nl_{\\min} = 50\\ \\text{nm} = 50 \\times 10^{-9}\\ \\text{m} = 5.0 \\times 10^{-8}\\ \\text{m}\n$$\n$$\nl_{\\max} = 20\\ \\mu\\text{m} = 20 \\times 10^{-6}\\ \\text{m} = 2.0 \\times 10^{-5}\\ \\text{m}\n$$\n$$\n\\frac{l_{\\max}}{l_{\\min}} = \\frac{2.0 \\times 10^{-5}\\ \\text{m}}{5.0 \\times 10^{-8}\\ \\text{m}} = \\frac{2.0}{5.0} \\times 10^{3} = 0.4 \\times 10^{3} = 400\n$$\nThe exponent term is:\n$$\n2+\\alpha = 2+0.40 = 2.40\n$$\nNow, we can calculate $N$:\n$$\nN = 2.40 \\times \\log_{10}(400)\n$$\nWe evaluate the logarithm:\n$$\n\\log_{10}(400) = \\log_{10}(4 \\times 100) = \\log_{10}(4) + \\log_{10}(100) = \\log_{10}(2^2) + 2 = 2\\log_{10}(2) + 2\n$$\nUsing the value $\\log_{10}(2) \\approx 0.30103$:\n$$\n\\log_{10}(400) \\approx 2 \\times 0.30103 + 2 = 0.60206 + 2 = 2.60206\n$$\nFinally, we compute $N$:\n$$\nN = 2.40 \\times 2.60206 \\approx 6.244944\n$$\nRounding the result to three significant figures, as requested implicitly by the precision of $\\alpha=0.40$:\n$$\nN \\approx 6.24\n$$\nThe parameters $D = 3.0 \\times 10^{-11}\\ \\text{m}^{2}\\,\\text{s}^{-1}$ and $l_{0} = 1.0\\ \\mu\\text{m}$ are not required for the calculation of the dimensionless ratio $N$, as shown in the derivation.",
            "answer": "$$\\boxed{6.24}$$"
        },
        {
            "introduction": "Moving from physical principles to computational practice, the inversion of impedance data to obtain the DRT is a notoriously ill-posed problem, where small amounts of noise in the measurements can lead to large, unphysical oscillations in the solution. This hands-on coding exercise  is designed to provide a concrete understanding of this challenge. By building the discretized kernel matrix and calculating key metrics like its condition number and mutual coherence, you will directly observe how choices in the numerical setup—such as the range of the relaxation time grid—profoundly impact the stability and identifiability of the inversion.",
            "id": "4242724",
            "problem": "Consider the Distribution of Relaxation Times (DRT) model for Electrochemical Impedance Spectroscopy (EIS), where the measured complex impedance as a function of angular frequency is modeled as a superposition of first-order relaxation modes. The DRT representation is given by\n$$\nZ(\\omega) = R_{\\infty} + \\int_{\\tau_{\\min}}^{\\tau_{\\max}} \\frac{\\gamma(\\tau)}{1 + i \\,\\omega \\tau} \\, d\\ln \\tau,\n$$\nwhere $Z(\\omega)$ is the complex impedance at angular frequency $\\omega$ in radians per second, $R_{\\infty}$ is the high-frequency (ohmic) resistance, $\\gamma(\\tau)$ is the distribution of relaxation times, and $\\tau$ is the relaxation time in seconds. For inversion, the integral operator is discretized on a logarithmic grid of $\\tau$ values, yielding a linear mapping between $\\gamma(\\tau)$ values and the complex impedance data across a grid of frequencies. Define the real and imaginary parts of the kernel as\n$$\nK_{\\Re}(\\omega,\\tau) = \\frac{1}{1 + (\\omega \\tau)^2}, \\quad K_{\\Im}(\\omega,\\tau) = -\\frac{\\omega \\tau}{1 + (\\omega \\tau)^2},\n$$\nand stack them to form a real-valued matrix\n$$\nK \\in \\mathbb{R}^{2 N_{\\omega} \\times N_{\\tau}},\n$$\nwhere the top $N_{\\omega}$ rows correspond to $K_{\\Re}$ evaluated on the frequency grid and the bottom $N_{\\omega}$ rows correspond to $K_{\\Im}$ evaluated on the same frequency grid. The discretized forward model (after stacking real and imaginary parts) is then\n$$\n\\begin{bmatrix}\n\\Re\\,Z(\\omega_1) \\\\\n\\vdots \\\\\n\\Re\\,Z(\\omega_{N_{\\omega}}) \\\\\n\\Im\\,Z(\\omega_1) \\\\\n\\vdots \\\\\n\\Im\\,Z(\\omega_{N_{\\omega}})\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nK_{\\Re}(\\omega_1,\\tau_1) & \\cdots & K_{\\Re}(\\omega_1,\\tau_{N_{\\tau}}) \\\\\n\\vdots & \\ddots & \\vdots \\\\\nK_{\\Re}(\\omega_{N_{\\omega}},\\tau_1) & \\cdots & K_{\\Re}(\\omega_{N_{\\omega}},\\tau_{N_{\\tau}}) \\\\\nK_{\\Im}(\\omega_1,\\tau_1) & \\cdots & K_{\\Im}(\\omega_1,\\tau_{N_{\\tau}}) \\\\\n\\vdots & \\ddots & \\vdots \\\\\nK_{\\Im}(\\omega_{N_{\\omega}},\\tau_1) & \\cdots & K_{\\Im}(\\omega_{N_{\\omega}},\\tau_{N_{\\tau}})\n\\end{bmatrix}\n\\begin{bmatrix}\n\\gamma(\\tau_1) \\\\\n\\vdots \\\\\n\\gamma(\\tau_{N_{\\tau}})\n\\end{bmatrix}.\n$$\nAssume uniform spacing in $\\ln \\tau$ for the discretization but do not include quadrature weights in the matrix $K$ for the purposes of conditioning analysis.\n\nStarting from this base, demonstrate the effect of the choice of the relaxation time grid on identifiability by computing two metrics for the matrix $K$: the spectral condition number based on the two-norm,\n$$\n\\kappa_2(K) = \\frac{\\sigma_{\\max}(K)}{\\sigma_{\\min}(K)},\n$$\nwhere $\\sigma_{\\max}(K)$ and $\\sigma_{\\min}(K)$ are the largest and smallest singular values, respectively, and the mutual coherence\n$$\n\\mu(K) = \\max_{1 \\le i < j \\le N_{\\tau}} \\left| \\frac{k_i^\\top k_j}{\\|k_i\\|_2 \\, \\|k_j\\|_2} \\right|,\n$$\nwhere $k_i$ and $k_j$ are columns of $K$. High values of $\\kappa_2(K)$ and $\\mu(K)$ indicate poor identifiability due to near-collinearity of columns.\n\nImplement a program that:\n- Constructs logarithmically spaced grids for $\\omega$ (in radians per second) and $\\tau$ (in seconds).\n- Builds the matrix $K$ by stacking $K_{\\Re}$ and $K_{\\Im}$ as defined above.\n- Computes $\\kappa_2(K)$ using Singular Value Decomposition (SVD). To avoid non-finite results due to numerical underflow, if $\\sigma_{\\min}(K) < 10^{-12}$, return $\\kappa_2(K) = 10^{16}$ as a representative large value.\n- Computes $\\mu(K)$ by normalizing the columns of $K$ to unit $\\ell_2$ norm and taking the maximum absolute inner product between distinct columns.\n\nUse the following test suite of three cases, designed to cover a general case, an over-wide relaxation time range, and an edge case with limited frequency coverage:\n1. Case A (matched ranges): $N_{\\omega} = 60$, $\\omega \\in [10, 10^{4}]$ radians per second, $N_{\\tau} = 60$, $\\tau \\in \\left[\\frac{1}{5 \\cdot 10^{4}}, \\frac{5}{10}\\right]$ seconds.\n2. Case B (over-wide $\\tau$ range): $N_{\\omega} = 60$, $\\omega \\in [10, 10^{4}]$ radians per second, $N_{\\tau} = 120$, $\\tau \\in [10^{-7}, 10^{2}]$ seconds.\n3. Case C (extreme over-wide $\\tau$ with limited $\\omega$): $N_{\\omega} = 20$, $\\omega \\in [10^{2}, 10^{3}]$ radians per second, $N_{\\tau} = 150$, $\\tau \\in [10^{-10}, 10^{4}]$ seconds.\n\nAll frequencies must be generated on a logarithmic grid spanning the specified bounds; likewise for relaxation times. All physical quantities must be expressed in the specified units: angular frequency in radians per second and relaxation time in seconds. The metrics are dimensionless.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets of the form\n$$\n[\\kappa_A, \\mu_A, \\kappa_B, \\mu_B, \\kappa_C, \\mu_C],\n$$\nwhere $\\kappa_{\\cdot}$ and $\\mu_{\\cdot}$ are the values of $\\kappa_2(K)$ and $\\mu(K)$ for Cases A, B, and C, respectively. Each value must be a floating-point number. No other text should be printed.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of electrochemical impedance spectroscopy and numerical linear algebra, well-posed with all necessary data and definitions, and stated objectively. The task is to analyze the conditioning of the linear system arising from the discretization of the Distribution of Relaxation Times (DRT) integral equation, which is a standard and important consideration in this field.\n\nThe solution proceeds by implementing the specified computational steps for each of the three test cases. The core of the problem is to construct a matrix $K$ for a given set of discretization parameters and then compute its spectral condition number, $\\kappa_2(K)$, and mutual coherence, $\\mu(K)$. These metrics quantify the numerical stability and parameter identifiability of the inverse problem of finding the DRT, $\\gamma(\\tau)$, from impedance measurements, $Z(\\omega)$.\n\n**Step 1: Grid Generation**\nFor each case, we must generate logarithmically spaced grids for the angular frequency, $\\omega$, and the relaxation time, $\\tau$. A logarithmically spaced grid of $N$ points from a minimum value $x_{\\min}$ to a maximum value $x_{\\max}$ can be generated element-wise as:\n$$\nx_i = x_{\\min} \\left( \\frac{x_{\\max}}{x_{\\min}} \\right)^{\\frac{i}{N-1}} \\quad \\text{for } i = 0, 1, \\ldots, N-1.\n$$\nWe generate an angular frequency grid, $\\vec{\\omega}$, of size $N_{\\omega}$ spanning $[\\omega_{\\min}, \\omega_{\\max}]$, and a relaxation time grid, $\\vec{\\tau}$, of size $N_{\\tau}$ spanning $[\\tau_{\\min}, \\tau_{\\max}]$, according to the parameters of each test case.\n\n**Step 2: Construction of the Matrix $K$**\nThe matrix $K \\in \\mathbb{R}^{2 N_{\\omega} \\times N_{\\tau}}$ represents the discretized DRT operator. It is constructed by evaluating the real and imaginary parts of the kernel function at each combination of frequency $\\omega_i$ and relaxation time $\\tau_j$. First, we form two matrices, $K_{\\Re} \\in \\mathbb{R}^{N_{\\omega} \\times N_{\\tau}}$ and $K_{\\Im} \\in \\mathbb{R}^{N_{\\omega} \\times N_{\\tau}}$, whose elements are given by:\n$$\n(K_{\\Re})_{ij} = K_{\\Re}(\\omega_i, \\tau_j) = \\frac{1}{1 + (\\omega_i \\tau_j)^2}\n$$\n$$\n(K_{\\Im})_{ij} = K_{\\Im}(\\omega_i, \\tau_j) = -\\frac{\\omega_i \\tau_j}{1 + (\\omega_i \\tau_j)^2}\n$$\nwhere $i \\in \\{1, \\ldots, N_{\\omega}\\}$ and $j \\in \\{1, \\ldots, N_{\\tau}\\}$. The final matrix $K$ is formed by vertically stacking $K_{\\Re}$ on top of $K_{\\Im}$:\n$$\nK = \\begin{bmatrix} K_{\\Re} \\\\ K_{\\Im} \\end{bmatrix}.\n$$\n\n**Step 3: Computation of the Condition Number $\\kappa_2(K)$**\nThe spectral condition number, $\\kappa_2(K)$, measures the sensitivity of the solution of a linear system to perturbations in the data. It is defined as the ratio of the largest to the smallest singular values of the matrix $K$:\n$$\n\\kappa_2(K) = \\frac{\\sigma_{\\max}(K)}{\\sigma_{\\min}(K)}.\n$$\nThe singular values, $\\sigma_k$, are obtained by performing a Singular Value Decomposition (SVD) of $K$, which factorizes it as $K = U \\Sigma V^\\top$. The singular values are the diagonal elements of the matrix $\\Sigma$, sorted in descending order: $\\sigma_1 \\ge \\sigma_2 \\ge \\ldots \\ge \\sigma_p \\ge 0$, where $p = \\min(2N_{\\omega}, N_{\\tau})$. Thus, $\\sigma_{\\max}(K) = \\sigma_1$ and $\\sigma_{\\min}(K) = \\sigma_p$.\n\nIf the system is underdetermined ($2N_{\\omega} < N_{\\tau}$) or if columns of $K$ are linearly dependent, $\\sigma_{\\min}(K)$ will be zero (or numerically indistinguishable from zero). This leads to an infinite condition number, indicating a severely ill-posed problem. As per the problem specification, if $\\sigma_{\\min}(K)$ is found to be less than $10^{-12}$, we assign $\\kappa_2(K)$ a large representative value of $10^{16}$.\n\n**Step 4: Computation of the Mutual Coherence $\\mu(K)$**\nThe mutual coherence, $\\mu(K)$, quantifies the maximum linear dependence between any two distinct columns of the matrix $K$. It is defined as the maximum absolute value of the cosine of the angle between any pair of distinct column vectors $k_i$ and $k_j$:\n$$\n\\mu(K) = \\max_{1 \\le i < j \\le N_{\\tau}} \\left| \\frac{k_i^\\top k_j}{\\|k_i\\|_2 \\, \\|k_j\\|_2} \\right|.\n$$\nA value of $\\mu(K)$ close to $1$ implies that at least two columns are nearly parallel, making it difficult to distinguish their individual contributions to the measured impedance. This indicates poor identifiability. To compute $\\mu(K)$, we first normalize each column $k_j$ of $K$ to have a unit $\\ell_2$ norm, creating a new matrix $\\hat{K}$. Then, we compute the Gram matrix $G = \\hat{K}^\\top \\hat{K}$. The element $G_{ij}$ is the cosine similarity between columns $i$ and $j$. The mutual coherence is the maximum absolute value of the off-diagonal elements of $G$.\n\nBy applying these four steps to each of the Cases A, B, and C, we can systematically evaluate how the choice of frequency and relaxation time grids impacts the conditioning of the DRT inversion problem. The results are expected to show deteriorating conditioning (higher $\\kappa_2$ and $\\mu$) as the $\\tau$ grid becomes excessively wide relative to the information content in the $\\omega$ grid (Case B) and as the problem becomes more underdetermined (Case C).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the condition number and mutual coherence for the DRT matrix K\n    for three different test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (matched ranges)\n        {\n            \"N_omega\": 60, \"omega_range\": (10.0, 1e4),\n            \"N_tau\": 60, \"tau_range\": (1.0 / (5.0 * 1e4), 5.0 / 10.0)\n        },\n        # Case B (over-wide tau range)\n        {\n            \"N_omega\": 60, \"omega_range\": (10.0, 1e4),\n            \"N_tau\": 120, \"tau_range\": (1e-7, 1e2)\n        },\n        # Case C (extreme over-wide tau with limited omega)\n        {\n            \"N_omega\": 20, \"omega_range\": (1e2, 1e3),\n            \"N_tau\": 150, \"tau_range\": (1e-10, 1e4)\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Step 1: Grid Generation\n        omega_grid = np.logspace(\n            np.log10(case[\"omega_range\"][0]),\n            np.log10(case[\"omega_range\"][1]),\n            case[\"N_omega\"]\n        )\n        tau_grid = np.logspace(\n            np.log10(case[\"tau_range\"][0]),\n            np.log10(case[\"tau_range\"][1]),\n            case[\"N_tau\"]\n        )\n\n        # Step 2: Construction of the Matrix K\n        # Use broadcasting to create the (N_omega, N_tau) matrix of products\n        omega_tau = omega_grid[:, np.newaxis] * tau_grid[np.newaxis, :]\n        \n        # Kernel functions\n        K_real = 1.0 / (1.0 + omega_tau**2)\n        K_imag = -omega_tau / (1.0 + omega_tau**2)\n        \n        # Stack the real and imaginary parts\n        K = np.vstack((K_real, K_imag))\n\n        # Step 3: Computation of the Condition Number kappa_2(K)\n        # Compute singular values using SVD\n        singular_values = np.linalg.svd(K, compute_uv=False)\n        \n        sigma_max = singular_values[0]\n        sigma_min = singular_values[-1]\n        \n        # Apply the rule for small sigma_min\n        if sigma_min < 1e-12:\n            kappa_2 = 1e16\n        else:\n            kappa_2 = sigma_max / sigma_min\n        \n        results.append(kappa_2)\n\n        # Step 4: Computation of the Mutual Coherence mu(K)\n        # Normalize columns of K to unit l2 norm\n        col_norms = np.linalg.norm(K, axis=0)\n\n        # Handle potential zero-norm columns to avoid division by zero\n        # Although unlikely with these kernels unless tau or omega is inf/nan\n        # A small epsilon is added for numerical stability\n        K_normalized = K / (col_norms[np.newaxis, :] + 1e-16)\n        \n        # Compute the Gram matrix of absolute inner products\n        gram_matrix = np.abs(K_normalized.T @ K_normalized)\n        \n        # Set diagonal elements to 0 to exclude self-correlations\n        np.fill_diagonal(gram_matrix, 0)\n        \n        # The mutual coherence is the maximum off-diagonal element\n        if gram_matrix.size > 0:\n            mu = np.max(gram_matrix)\n        else:\n            # Handle edge case of a matrix with 0 or 1 columns\n            mu = 0.0\n\n        results.append(mu)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A successful DRT analysis requires more than just running an algorithm; it demands the ability to critically interpret the results and diagnose potential issues. In practice, inversions can yield unphysical features, such as negative values for the distribution $g(\\tau)$, which a purely resistive-capacitive system should not produce. This problem  simulates a common real-world scenario where such artifacts appear due to a mismatch between the assumed model and the actual system physics, such as unmodeled high-frequency inductance. It develops essential diagnostic skills for distinguishing between data invalidity and model inadequacy, a critical step in producing a reliable analysis.",
            "id": "4242751",
            "problem": "An electrochemical interface operated in the small-signal regime is assumed linear and time-invariant, so its impedance $Z(\\omega)$ is causal and passive. A set of broadband impedance spectroscopy measurements yields $Z(\\omega)$ over angular frequencies $\\omega$. The data exhibit the following features: at intermediate $\\omega$ there is a classical dissipative arc with $\\operatorname{Im}\\{Z(\\omega)\\} < 0$, while at sufficiently large $\\omega$ the imaginary part becomes positive and increases approximately linearly with $\\omega$, and the real part tends to a finite intercept $R_{\\infty}$. A Distribution of Relaxation Times (DRT) inversion is performed using a forward kernel that assumes only resistive-capacitive relaxations and a non-negativity constraint on the unknown distribution $g(\\tau)$. The recovered $g(\\tau)$ displays localized negative values near very small relaxation times $\\tau \\ll 1/\\omega_{\\max}$, and the residuals concentrate at the highest frequencies.\n\nBased only on the principles of linear causality, passivity, and the structure of the standard resistive-capacitive DRT kernel, which of the following statements are correct about when negative $g(\\tau)$ may arise and how to treat or flag such cases?\n\nA. Negative $g(\\tau)$ proves that the data violate the Kramers-Kronig relations, so the dataset is invalid and must be discarded.\n\nB. A positive high-frequency slope of $\\operatorname{Im}\\{Z(\\omega)\\}$ together with finite $R_{\\infty}$ is consistent with an unmodeled series inductance; inverting with an $R$-$C$-only kernel can then produce negative $g(\\tau)$ at very small $\\tau$. A remedy is to augment the forward model with an explicit inductive term $i\\omega L$ or an inductive basis and rerun the inversion, and to flag such cases by detecting $\\lim_{\\omega \\to \\infty} \\operatorname{Im}\\{Z(\\omega)\\}/\\omega > 0$.\n\nC. Increasing the smoothness penalty in Tikhonov regularization necessarily enforces $g(\\tau) \\ge 0$ without compromising resolution, so it is the preferred fix for negative $g(\\tau)$.\n\nD. Negative $g(\\tau)$ can arise from discretization and basis mismatch or overfitting noise near frequency-band edges; appropriate actions include inspecting residuals, refining the grid or basis, using positivity-preserving priors or constraints, and quantifying uncertainty. If the physics is incomplete, some negativity may persist.\n\nE. Incorporating Kramers-Kronig consistency checks can distinguish model mismatch from data invalidity: if the data pass Kramers-Kronig within tolerance, a negative $g(\\tau)$ indicates an inadequate kernel (for example, missing inductive terms) rather than bad data. The inversion should be rerun with a model that respects passivity and includes the necessary elements, and $g(\\tau)$ should be constrained to be non-negative for purely dissipative relaxations.\n\nSelect all that apply.",
            "solution": "The user wants me to validate the problem statement and, if it is valid, provide a detailed solution.\n\n### Step 1: Extract Givens\n- The electrochemical interface is modeled as a linear, time-invariant (LTI) system.\n- The system's impedance, $Z(\\omega)$, is causal and passive.\n- Impedance spectroscopy data for $Z(\\omega)$ is available over a range of angular frequencies $\\omega$.\n- At intermediate $\\omega$, the data show a dissipative arc: $\\operatorname{Im}\\{Z(\\omega)\\} < 0$.\n- At sufficiently large $\\omega$, the imaginary part is positive and increases approximately linearly with $\\omega$: $\\operatorname{Im}\\{Z(\\omega)\\} \\sim \\omega$.\n- At large $\\omega$, the real part approaches a finite constant: $\\lim_{\\omega \\to \\infty} \\operatorname{Re}\\{Z(\\omega)\\} = R_{\\infty}$.\n- A Distribution of Relaxation Times (DRT) inversion is performed.\n- The forward model for the DRT assumes only resistive-capacitive (R-C) relaxations.\n- A non-negativity constraint is applied to the distribution $g(\\tau)$.\n- The resulting $g(\\tau)$ shows localized negative values for very small relaxation times, $\\tau \\ll 1/\\omega_{\\max}$.\n- The inversion residuals are largest at the highest frequencies.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in the established theory of Electrochemical Impedance Spectroscopy (EIS) and the associated computational method of DRT inversion. The concepts of LTI systems, causality, passivity (implying Kramers-Kronig consistency), R-C relaxations, and inductive effects are fundamental to electrochemistry and physics. The described experimental signature (a capacitive process followed by a high-frequency inductive tail) is a common and realistic observation in many electrochemical systems, often arising from cell geometry, wiring, or specific high-frequency processes. The appearance of artifacts in the recovered DRT distribution due to model mismatch is a well-documented and critical topic in the field. The problem is scientifically sound.\n- **Well-Posed:** The problem is well-posed. It presents a clear set of observations and asks for an interpretation based on specified principles. The question seeks to identify correct statements regarding the cause and treatment of a specific computational artifact, which has a well-defined set of possible answers within the framework of EIS analysis.\n- **Objective:** The problem statement is objective, using precise, technical language common in physics and engineering. It describes phenomena ($\\operatorname{Im}\\{Z(\\omega)\\} > 0$, negative $g(\\tau)$) without subjective interpretation.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically valid, well-posed, and objective. It describes a realistic and important scenario in the analysis of impedance data. I will proceed with deriving the solution.\n\n### Solution Derivation\nThe standard Distribution of Relaxation Times (DRT) model for a system composed of purely resistive and capacitive elements is given by the integral equation:\n$$Z(\\omega) = R_{\\infty} + \\int_0^\\infty \\frac{g(\\tau)}{1+i\\omega\\tau} d\\tau$$\nwhere $R_{\\infty}$ is the high-frequency series resistance, $i$ is the imaginary unit, $\\omega$ is the angular frequency, and $\\tau$ is the relaxation time. The function $g(\\tau)$ is the distribution of relaxation times. For a system to be physically realizable with only resistors and capacitors, the distribution function $g(\\tau)$ must be non-negative, $g(\\tau) \\ge 0$ for all $\\tau \\ge 0$.\n\nLet's examine the imaginary part of this model. The imaginary part of the kernel is $\\operatorname{Im}\\{1/(1+i\\omega\\tau)\\} = -\\omega\\tau / (1 + (\\omega\\tau)^2)$. Since $\\omega > 0$ and $\\tau > 0$, this term is always negative. Therefore, the imaginary part of the impedance predicted by this model is:\n$$\\operatorname{Im}\\{Z(\\omega)\\} = \\int_0^\\infty g(\\tau) \\left( \\frac{-\\omega\\tau}{1+(\\omega\\tau)^2} \\right) d\\tau$$\nGiven the constraint $g(\\tau) \\ge 0$, the integrand is always less than or equal to zero. Consequently, the integral must be less than or equal to zero. This means the standard R-C DRT model is fundamentally incapable of describing a system where $\\operatorname{Im}\\{Z(\\omega)\\} > 0$.\n\nThe problem statement explicitly mentions that the measured data exhibit $\\operatorname{Im}\\{Z(\\omega)\\} > 0$ at high frequencies, with a behavior approximately linear in $\\omega$. This is the characteristic signature of an inductor, whose impedance is $Z_L(\\omega) = i\\omega L$, where $L$ is the inductance. Therefore, the measured impedance likely has the form:\n$$Z_{\\text{true}}(\\omega) \\approx R_s + Z_{\\text{process}}(\\omega) + i\\omega L$$\nwhere $Z_{\\text{process}}(\\omega)$ is the impedance of the actual electrochemical processes (which may well be described by an R-C DRT) and $R_s$ is a series resistance (which would be encapsulated partly in $R_\\infty$ and partly in the DRT itself).\n\nWhen the inversion algorithm attempts to fit this $Z_{\\text{true}}(\\omega)$ using the R-C-only model, it faces a fundamental mismatch. The algorithm tries to minimize the squared error $\\| Z_{\\text{true}} - Z_{\\text{model}} \\|^2$. To account for the positive imaginary part $i\\omega L$ using a basis of functions that can only produce negative imaginary parts (with positive coefficients), the algorithm is forced into an \"unphysical\" solution. If the non-negativity constraint on $g(\\tau)$ is relaxed or implemented imperfectly, the optimization can produce negative values for $g(\\tau)$, typically at very small time constants $\\tau$. These artifacts are the mathematical manifestation of the algorithm's attempt to synthesize an inductive response from a purely capacitive basis. The residuals (the difference between data and fit) will naturally be largest at the high frequencies where the unmodeled inductive term is most significant.\n\n### Option-by-Option Analysis\n\n**A. Negative $g(\\tau)$ proves that the data violate the Kramers-Kronig relations, so the dataset is invalid and must be discarded.**\nAn impedance function is consistent with the Kramers-Kronig (K-K) relations if it represents a causal, stable, linear system. An ideal inductor's impedance, $Z_L(\\omega) = i\\omega L$, is K-K consistent (its real part is $0$ and its imaginary part is $\\omega L$; this pair of functions satisfies the K-K transforms). The sum of K-K consistent impedance functions is also K-K consistent. Therefore, an impedance containing both capacitive and inductive elements, like the one described, is perfectly valid and K-K consistent, provided its components are. The negative $g(\\tau)$ does not prove the data is invalid; rather, it indicates that the *model* used for the inversion is incomplete.\n**Verdict: Incorrect.**\n\n**B. A positive high-frequency slope of $\\operatorname{Im}\\{Z(\\omega)\\}$ together with finite $R_{\\infty}$ is consistent with an unmodeled series inductance; inverting with an $R$-$C$-only kernel can then produce negative $g(\\tau)$ at very small $\\tau$. A remedy is to augment the forward model with an explicit inductive term $i\\omega L$ or an inductive basis and rerun the inversion, and to flag such cases by detecting $\\lim_{\\omega \\to \\infty} \\operatorname{Im}\\{Z(\\omega)\\}/\\omega > 0$.**\nThis statement correctly identifies that the observed high-frequency behavior ($\\operatorname{Im}\\{Z(\\omega)\\} \\propto \\omega > 0$) is characteristic of a series inductance, $L$. It correctly deduces that using an R-C-only model to fit such data is a model mismatch that leads to negative artifacts in $g(\\tau)$. The proposed remedy—augmenting the DRT model to $Z(\\omega) = R_{\\infty} + i\\omega L + \\int_0^\\infty \\frac{g(\\tau)}{1+i\\omega\\tau} d\\tau$—is the standard and correct approach to handle this situation. The condition for flagging this, $\\lim_{\\omega \\to \\infty} \\operatorname{Im}\\{Z(\\omega)\\}/\\omega = L > 0$, is the precise mathematical definition of the high-frequency series inductance. This statement is entirely correct.\n**Verdict: Correct.**\n\n**C. Increasing the smoothness penalty in Tikhonov regularization necessarily enforces $g(\\tau) \\ge 0$ without compromising resolution, so it is the preferred fix for negative $g(\\tau)$.**\nTikhonov regularization adds a penalty term, typically of the form $\\lambda \\| \\mathcal{L} g \\|^2$ (where $\\mathcal{L}$ is a differential operator), to the least-squares objective function. Increasing the regularization parameter $\\lambda$ promotes a smoother solution $g(\\tau)$. While this can suppress sharp, oscillatory artifacts (including negative peaks), it does *not* strictly enforce the constraint $g(\\tau) \\ge 0$. Non-negativity must be imposed by a separate constraint (e.g., through a non-negative least squares algorithm). Furthermore, a fundamental trade-off exists in all regularization methods: increasing smoothness (reducing variance) comes at the cost of decreased resolution (increased bias), meaning sharp features in the true distribution will be broadened. The statement that this fix does not compromise resolution is false.\n**Verdict: Incorrect.**\n\n**D. Negative $g(\\tau)$ can arise from discretization and basis mismatch or overfitting noise near frequency-band edges; appropriate actions include inspecting residuals, refining the grid or basis, using positivity-preserving priors or constraints, and quantifying uncertainty. If the physics is incomplete, some negativity may persist.**\nThis statement correctly points out that even without a major physical model mismatch like a missing inductor, numerical issues are a potential source of artifacts in DRT. These include using a $\\tau$ grid that is too coarse or does not span the appropriate range, using poorly chosen basis functions, or overfitting high-frequency noise. All the suggested actions—residual analysis, grid refinement, using robust constraints (like non-negative least squares), and uncertainty quantification—are essential components of good practice for DRT analysis. The final sentence correctly notes that if the underlying model is physically incomplete (as described in the problem), these numerical fixes alone may not suffice to eliminate the negativity. This is a valid and general statement about the challenges of DRT inversion.\n**Verdict: Correct.**\n\n**E. Incorporating Kramers-Kronig consistency checks can distinguish model mismatch from data invalidity: if the data pass Kramers-Kronig within tolerance, a negative $g(\\tau)$ indicates an inadequate kernel (for example, missing inductive terms) rather than bad data. The inversion should be rerun with a model that respects passivity and includes the necessary elements, and $g(\\tau)$ should be constrained to be non-negative for purely dissipative relaxations.**\nThis statement outlines a rigorous and crucial workflow for EIS analysis. The K-K test is the primary tool for verifying data quality by checking for LTI causality and stability. If the data are found to be K-K consistent, they represent a physically valid linear response. If a subsequent DRT inversion with a simple model (e.g., R-C only) produces unphysical results (negative $g(\\tau)$), this logically isolates the problem to the model itself. The conclusion that the model is inadequate is therefore sound. The proposed course of action—using an expanded, physically complete model (e.g., adding an inductor) and properly constraining the physically-dissipative parts of that model (the R-C DRT part)—is the most robust and scientifically correct approach.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{BDE}$$"
        }
    ]
}