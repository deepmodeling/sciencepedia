{
    "hands_on_practices": [
        {
            "introduction": "在探索复杂的动力学之前，我们必须首先确保我们构建的模型能够准确地描述基本的物理过程。本练习将指导您实现一个有限差分求解器，用于模拟电极-溶液界面的扩散过程，并通过与经典的科特雷尔（Cottrell）方程这一精确解析解进行对比，来验证您模型的正确性。通过量化数值误差，您将深入理解离散化参数（如空间步长 $\\Delta x$ 和时间步长 $\\Delta t$）如何影响模拟结果的准确性，这是所有计算电化学研究的基石。",
            "id": "4257928",
            "problem": "考虑一种溶解的电活性物质在平面电极上经历瞬时、不可逆电子转移后的一维扩散过程。该过程的控制方程是反应物浓度 $c(x,t)$ 的菲克第二扩散定律，定义在半无限域 $x \\in [0,\\infty)$ 上：\n$$\n\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2},\n$$\n其中扩散系数 $D0$。在时间 $t=0^+$ 时，电极电位阶跃至一个使表面反应达到扩散限制的值（即反应物瞬时消耗，因而不可逆），因此在电极表面 $x=0$ 处的边界条件为\n$$\nc(0,t) = 0, \\quad t0,\n$$\n初始条件为均匀的本体浓度\n$$\nc(x,0) = c_{\\mathrm{bulk}}, \\quad x0,\n$$\n同时，远场边界条件维持本体浓度，\n$$\n\\lim_{x\\to\\infty} c(x,t) = c_{\\mathrm{bulk}}, \\quad t \\ge 0.\n$$\n在这些条件下，该扩散问题存在一个完善的解析解，以及在不可逆极限下电极上扩散限制电流瞬态 $i(t)$ 的一个闭式表达式。您的任务是根据该解析解来验证一个数值模拟，并量化在时间和空间上的离散化误差。\n\n从上述控制偏微分方程 (PDE) 和边界/初始条件出发，在一个截断域 $x \\in [0,L]$ 上实现一个瞬态扩散问题的求解器，其中 $L$ 足够大以近似半无限介质。使用一个有限差分法，该方法需满足：\n- 间距为 $\\,\\Delta x\\,$ 的均匀空间网格，\n- 均匀的时间步长 $\\,\\Delta t\\,$，\n- 狄利克雷边界条件 $c(0,t)=0$ 和 $c(L,t)=c_{\\mathrm{bulk}}$，\n- 对表面通量 $J(0,t) = -D \\,\\partial c/\\partial x \\vert_{x=0}$ 的数值近似，在电极处的空间精度至少为二阶。\n\n根据数值通量 $J(0,t)$，通过下式计算电流 $i_{\\mathrm{num}}(t)$（单位：安培）：\n$$\ni_{\\mathrm{num}}(t) = n F A \\, \\left(-J(0,t)\\right),\n$$\n其中 $n$ 是转移的电子数，$F$ 是法拉第常数，$A$ 是平面电极的几何面积。将 $i_{\\mathrm{num}}(t)$ 与不可逆极限下的解析电流 $i_{\\mathrm{ana}}(t)$ 进行比较，并通过在模拟时间窗口内的均方根误差来量化差异：\n$$\n\\mathrm{RMSE} = \\left( \\frac{1}{N_t} \\sum_{k=1}^{N_t} \\left[i_{\\mathrm{num}}(t_k) - i_{\\mathrm{ana}}(t_k)\\right]^2 \\right)^{1/2},\n$$\n其中 $t_k$ 是严格大于 $0$ 的离散时间点，$N_t$ 是其总数。RMSE 以安培为单位表示。\n\n使用以下物理上合理的参数，所有量均以国际单位制 (SI) 表示：\n- $D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}$，\n- $c_{\\mathrm{bulk}} = 1.0\\ \\mathrm{mol/m^3}$，\n- $n = 1$，\n- $F = 96485\\ \\mathrm{C/mol}$，\n- $A = 1.0\\times 10^{-4}\\ \\mathrm{m^2}$，\n- 最终模拟时间 $T_{\\mathrm{end}} = 1.0\\ \\mathrm{s}$。\n\n设计您的求解器，使其能够为不同的 $(\\Delta x, \\Delta t, L)$ 三元组评估 RMSE。数值方法必须在科学上是合理的，并且域截断长度 $L$ 必须足够大以近似半无限行为，除非有意引入边界情况以测试灵敏度。\n\n提供一个包含以下七个测试用例的测试套件，每个用例是一个元组 $(\\Delta x, \\Delta t, L)$：\n1. $(2.5\\times 10^{-6}\\ \\mathrm{m},\\ 5.0\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$，\n2. $(2.5\\times 10^{-6}\\ \\mathrm{m},\\ 2.5\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$，\n3. $(2.5\\times 10^{-6}\\ \\mathrm{m},\\ 1.25\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$，\n4. $(5.0\\times 10^{-6}\\ \\mathrm{m},\\ 1.0\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$，\n5. $(2.5\\times 10^{-6}\\ \\mathrm{m},\\ 1.0\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$，\n6. $(1.25\\times 10^{-6}\\ \\mathrm{m},\\ 1.0\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$，\n7. $(1.0\\times 10^{-5}\\ \\mathrm{m},\\ 2.0\\times 10^{-2}\\ \\mathrm{s},\\ 5.0\\times 10^{-4}\\ \\mathrm{m})$。\n\n解读指南：\n- 用例 1–3 在固定的空间分辨率下探究时间步长的细化。\n- 用例 4–6 在固定的时间步长下探究空间分辨率的细化。\n- 用例 7 是一个边界情况，具有相对较粗的离散化和较小的域，用于检验对截断和粗网格效应的灵敏度。\n\n您的程序应生成单行输出，其中包含七个 RMSE 值，每个值都以安培为单位，作为一个用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,r4,r5,r6,r7]”）。不应打印任何其他文本。所有数值答案必须以安培为单位。",
            "solution": "该问题要求为给定的扩散问题实现一个数值模拟，并将其输出与已知的解析解进行比较，以量化其准确性。验证和求解过程如下。\n\n### 第一步：提取已知条件\n\n**控制方程：**\n菲克第二定律：$\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}$，对于 $x \\in [0, \\infty)$, $t0$。\n\n**初始和边界条件：**\n- 初始条件：$c(x,0) = c_{\\mathrm{bulk}}$，对于 $x0$。\n- 电极表面边界条件 ($x=0$)：$c(0,t) = 0$，对于 $t0$。\n- 远场边界条件：$\\lim_{x\\to\\infty} c(x,t) = c_{\\mathrm{bulk}}$，对于 $t \\ge 0$。\n\n**物理和模拟参数：**\n- 扩散系数：$D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}$。\n- 本体浓度：$c_{\\mathrm{bulk}} = 1.0\\ \\mathrm{mol/m^3}$。\n- 转移电子数：$n = 1$。\n- 法拉第常数：$F = 96485\\ \\mathrm{C/mol}$。\n- 电极面积：$A = 1.0\\times 10^{-4}\\ \\mathrm{m^2}$。\n- 最终模拟时间：$T_{\\mathrm{end}} = 1.0\\ \\mathrm{s}$。\n\n**数值方法要求：**\n- 在截断域 $x \\in [0,L]$ 上使用有限差分法。\n- 均匀空间网格间距 $\\Delta x$。\n- 均匀时间步长 $\\Delta t$。\n- 狄利克雷边界条件：$c(0,t)=0$ 和 $c(L,t)=c_{\\mathrm{bulk}}$。\n- 对表面通量 $J(0,t) = -D \\,\\partial c/\\partial x \\vert_{x=0}$ 的数值近似，其空间精度至少为二阶。\n\n**输出计算：**\n- 数值电流：$i_{\\mathrm{num}}(t) = n F A \\, \\left(-J(0,t)\\right)$。\n- 误差度量：$\\mathrm{RMSE} = \\left( \\frac{1}{N_t} \\sum_{k=1}^{N_t} \\left[i_{\\mathrm{num}}(t_k) - i_{\\mathrm{ana}}(t_k)\\right]^2 \\right)^{1/2}$。\n\n**测试用例 $(\\Delta x, \\Delta t, L)$：**\n1. $(2.5\\times 10^{-6}\\ \\mathrm{m},\\ 5.0\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$\n2. $(2.5\\times 10^{-6}\\ \\mathrm{m},\\ 2.5\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$\n3. $(2.5\\times 10^{-6}\\ \\mathrm{m},\\ 1.25\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$\n4. $(5.0\\times 10^{-6}\\ \\mathrm{m},\\ 1.0\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$\n5. $(2.5\\times 10^{-6}\\ \\mathrm{m},\\ 1.0\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$\n6. $(1.25\\times 10^{-6}\\ \\mathrm{m},\\ 1.0\\times 10^{-3}\\ \\mathrm{s},\\ 1.0\\times 10^{-3}\\ \\mathrm{m})$\n7. $(1.0\\times 10^{-5}\\ \\mathrm{m},\\ 2.0\\times 10^{-2}\\ \\mathrm{s},\\ 5.0\\times 10^{-4}\\ \\mathrm{m})$\n\n### 第二步：使用提取的已知条件进行验证\n\n- **科学基础：** 该问题基于菲克第二扩散定律，这是物理化学和输运现象中的一个基本原理。边界条件描述了一个标准的计时电流法实验（Cottrell 实验），而通量与电流之间的关系是电化学的基石。所有参数都具有物理真实性。该问题在科学上是合理的。\n- **适定性：** 偏微分方程以及指定的初始和边界条件构成了一个适定的初边值问题。实现数值求解器并计算明确定义的误差度量 (RMSE) 的任务是明确的。测试用例的域截断长度 $L$（$L \\ge 5.0 \\times 10^{-4}\\ \\mathrm{m}$）与在 $T_{\\mathrm{end}}=1.0\\ \\mathrm{s}$ 时的最大扩散层厚度（约为 $6\\sqrt{DT_{\\mathrm{end}}} \\approx 6\\sqrt{10^{-9} \\cdot 1.0} \\approx 1.9 \\times 10^{-4}\\ \\mathrm{m}$）相比足够大，从而验证了半无限域的近似。离散化参数的选择使得模拟在数值上是稳定且无振荡的。\n- **客观性：** 该问题以精确的数学术语表述，使用了公认的科学形式和客观量。它没有歧义或主观性陈述。\n\n### 第三步：结论与行动\n该问题有效。一个合理的解法如下。\n\n### 解法\n\n该解法需要为给定的扩散问题构建一个数值模型，并将其输出与已建立的解析解进行比较。\n\n**1. 解析解 (Cottrell 方程)**\n指定扩散问题的浓度分布 $c(x,t)$ 的解析解由误差函数 $\\mathrm{erf}$ 给出：\n$$\nc_{\\mathrm{ana}}(x,t) = c_{\\mathrm{bulk}} \\cdot \\mathrm{erf}\\left( \\frac{x}{2\\sqrt{Dt}} \\right)\n$$\n通过将此表达式对 $x$ 求导并在 $x=0$ 处求值，可以得到电极表面 ($x=0$) 的摩尔通量 $J(0,t)$：\n$$\nJ(0,t) = -D \\left. \\frac{\\partial c_{\\mathrm{ana}}}{\\partial x} \\right|_{x=0} = -D \\left. \\left( c_{\\mathrm{bulk}} \\frac{e^{-x^2/(4Dt)}}{\\sqrt{\\pi Dt}} \\right) \\right|_{x=0} = -c_{\\mathrm{bulk}}\\sqrt{\\frac{D}{\\pi t}}\n$$\n电流 $i(t)$ 与通量的关系为 $i(t) = -nFAJ(0,t)$。代入通量的表达式，得到解析电流，即著名的 Cottrell 方程：\n$$\ni_{\\mathrm{ana}}(t) = n F A c_{\\mathrm{bulk}} \\sqrt{\\frac{D}{\\pi t}}\n$$\n该方程作为验证数值模拟的基准。请注意，当 $t \\to 0^+$ 时，$i_{\\mathrm{ana}}(t) \\to \\infty$，因此误差分析必须在 $t  0$ 时进行。\n\n**2. 数值格式：Crank-Nicolson 方法**\n为数值求解该控制偏微分方程，我们采用有限差分法。选择 Crank-Nicolson 方法是因为其无条件稳定性和在时间与空间上的二阶精度 ($O(\\Delta t^2, \\Delta x^2)$)。\n\n将域离散化为一个空间网格 $x_j = j\\Delta x$（$j=0, 1, \\dots, N_x$，其中 $L=N_x\\Delta x$）和一个时间网格 $t_k = k\\Delta t$（$k=0, 1, \\dots, N_t$，其中 $T_{\\mathrm{end}}=N_t\\Delta t$）。令 $c_j^k \\approx c(x_j, t_k)$。\n\n该偏微分方程的 Crank-Nicolson 离散形式为：\n$$\n\\frac{c_j^{k+1} - c_j^k}{\\Delta t} = \\frac{D}{2} \\left( \\frac{c_{j+1}^{k+1} - 2c_j^{k+1} + c_{j-1}^{k+1}}{(\\Delta x)^2} + \\frac{c_{j+1}^k - 2c_j^k + c_{j-1}^k}{(\\Delta x)^2} \\right)\n$$\n令 $\\lambda = D\\Delta t / (\\Delta x)^2$。对于每个内部节点 $j=1, 2, \\ldots, N_x-1$，重新整理方程，将时间步 $k+1$ 的未知浓度（左侧）与时间步 $k$ 的已知浓度（右侧）分开：\n$$\n-\\frac{\\lambda}{2} c_{j-1}^{k+1} + (1+\\lambda) c_j^{k+1} - \\frac{\\lambda}{2} c_{j+1}^{k+1} = \\frac{\\lambda}{2} c_{j-1}^k + (1-\\lambda) c_j^k + \\frac{\\lambda}{2} c_{j+1}^k\n$$\n这代表了一个关于内部节点未知浓度 $c_j^{k+1}$ 的 $N_x-1$ 个线性方程组。该系统可以写成矩阵形式 $\\mathbf{A}\\mathbf{c}^{k+1} = \\mathbf{b}^k$，其中 $\\mathbf{A}$ 是一个三对角矩阵。\n\n**3. 系统实现**\n用于内部节点的三对角矩阵 $\\mathbf{A}$ 在整个模拟过程中是恒定的：\n$$\n\\mathbf{A} = \n\\begin{pmatrix}\n1+\\lambda  -\\frac{\\lambda}{2}  0  \\cdots  0 \\\\\n-\\frac{\\lambda}{2}  1+\\lambda  -\\frac{\\lambda}{2}  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n\\vdots   -\\frac{\\lambda}{2}  1+\\lambda  -\\frac{\\lambda}{2} \\\\\n0  \\cdots  0  -\\frac{\\lambda}{2}  1+\\lambda\n\\end{pmatrix}\n$$\n右侧向量 $\\mathbf{b}^k$ 由时间 $k$ 的已知浓度构建。边界条件 $c_0^k = 0$ 和 $c_{N_x}^k = c_{\\mathrm{bulk}}$（对于所有 $k0$）按以下方式并入：\n- 对于第一个内部节点 ($j=1$)：涉及 $c_0^{k+1}$ 的项移到右侧，但由于 $c_0^{k+1}=0$，该项为零。右侧元素为 $b_1^k = (1-\\lambda)c_1^k + \\frac{\\lambda}{2}c_2^k$，因为 $c_0^k=0$。\n- 对于最后一个内部节点 ($j=N_x-1$)：项 $-\\frac{\\lambda}{2}c_{N_x}^{k+1}$ 移到右侧。由于 $c_{N_x}^{k+1} = c_{\\mathrm{bulk}}$，这会在右侧增加一项 $\\frac{\\lambda}{2}c_{\\mathrm{bulk}}$。右侧元素变为 $b_{N_x-1}^k = \\frac{\\lambda}{2}c_{N_x-2}^k + (1-\\lambda)c_{N_x-1}^k + \\frac{\\lambda}{2}c_{N_x}^k + \\frac{\\lambda}{2}c_{\\mathrm{bulk}} = \\frac{\\lambda}{2}c_{N_x-2}^k + (1-\\lambda)c_{N_x-1}^k + \\lambda c_{\\mathrm{bulk}}$。\n\n在每个时间步，使用专门的算法（例如 `scipy.linalg.solve_banded` 提供的算法）高效地求解这个三对角系统以得到 $\\mathbf{c}^{k+1}$。\n\n**4. 数值电流和误差计算**\n问题要求电极处的通量计算具有至少二阶精度。使用三点前向有限差分公式计算一阶导数：\n$$\n\\left. \\frac{\\partial c}{\\partial x} \\right|_{x=0, t=t_k} \\approx \\frac{-3c_0^k + 4c_1^k - c_2^k}{2\\Delta x}\n$$\n由于边界条件规定 $c_0^k = 0$，上式简化为：\n$$\n\\left. \\frac{\\partial c}{\\partial x} \\right|_{x=0, t=t_k} \\approx \\frac{4c_1^k - c_2^k}{2\\Delta x}\n$$\n数值通量为 $J_{\\mathrm{num}}(0,t_k) = -D \\left(\\frac{4c_1^k - c_2^k}{2\\Delta x}\\right)$，数值电流为：\n$$\ni_{\\mathrm{num}}(t_k) = nFA \\cdot D \\left(\\frac{4c_1^k - c_2^k}{2\\Delta x}\\right)\n$$\n然后根据指定公式，在所有时间步 $t_k$（$k=1, \\dots, N_t$）上计算均方根误差 (RMSE)：\n$$\n\\mathrm{RMSE} = \\left( \\frac{1}{N_t} \\sum_{k=1}^{N_t} \\left[i_{\\mathrm{num}}(t_k) - i_{\\mathrm{ana}}(t_k)\\right]^2 \\right)^{1/2}\n$$\n以下程序为七个测试用例中的每一个实现了这整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D diffusion problem for a series of test cases\n    and reports the Root-Mean-Square Error (RMSE) against the\n    analytical Cottrell equation.\n    \"\"\"\n\n    test_cases = [\n        # (delta_x, delta_t, L) in SI units (m, s, m)\n        (2.5e-6, 5.0e-3, 1.0e-3),\n        (2.5e-6, 2.5e-3, 1.0e-3),\n        (2.5e-6, 1.25e-3, 1.0e-3),\n        (5.0e-6, 1.0e-3, 1.0e-3),\n        (2.5e-6, 1.0e-3, 1.0e-3),\n        (1.25e-6, 1.0e-3, 1.0e-3),\n        (1.0e-5, 2.0e-2, 5.0e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        dx, dt, L = case\n        rmse = run_simulation(dx, dt, L)\n        results.append(f\"{rmse:.10e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(dx, dt, L):\n    \"\"\"\n    Performs a single finite-difference simulation for a given\n    set of discretization parameters.\n\n    Args:\n        dx (float): Spatial step size (m).\n        dt (float): Time step size (s).\n        L (float): Domain length (m).\n\n    Returns:\n        float: The RMSE of the numerical current vs. analytical current in Amperes.\n    \"\"\"\n    # Physical and simulation parameters\n    D = 1.0e-9        # Diffusion coefficient (m^2/s)\n    C_BULK = 1.0      # Bulk concentration (mol/m^3)\n    N_E = 1           # Number of electrons\n    F = 96485.0       # Faraday constant (C/mol)\n    A = 1.0e-4        # Electrode area (m^2)\n    T_END = 1.0       # Final simulation time (s)\n\n    # Grid setup\n    # The problem is designed such that L/dx and T_END/dt are integers.\n    Nx = int(round(L / dx))\n    Nt = int(round(T_END / dt))\n\n    # --- Initial and Boundary Conditions ---\n    # c(x,0) = c_bulk for x  0; c(0, t) = 0\n    c = np.full(Nx + 1, C_BULK, dtype=np.float64)\n    c[0] = 0.0\n\n    # --- Crank-Nicolson Method Setup ---\n    lambda_val = D * dt / (dx**2)\n    \n    # Setup tridiagonal matrix A for the system A*c_new = B\n    # Banded format for scipy.linalg.solve_banded:\n    # ab[0,:] = super-diagonal (u=1)\n    # ab[1,:] = main-diagonal\n    # ab[2,:] = sub-diagonal (l=1)\n    ab = np.zeros((3, Nx - 1), dtype=np.float64)\n    ab[0, 1:] = -lambda_val / 2.0\n    ab[1, :] = 1.0 + lambda_val\n    ab[2, :-1] = -lambda_val / 2.0\n    \n    sum_sq_err = 0.0\n\n    # --- Time-stepping loop ---\n    for k in range(Nt):\n        # Construct the right-hand side vector B\n        # B = M*c_old, where c_old are concentrations at the current step\n        b_vec = (lambda_val / 2.0) * c[:-2] + \\\n                (1.0 - lambda_val) * c[1:-1] + \\\n                (lambda_val / 2.0) * c[2:]\n\n        # Apply boundary condition at x=L (Dirichlet c(L,t) = c_bulk).\n        # This adds a term from the LHS matrix to the RHS vector.\n        b_vec[-1] += (lambda_val / 2.0) * C_BULK\n        \n        # Solve the tridiagonal system for internal nodes at the next time step\n        c_internal_new = solve_banded((1, 1), ab, b_vec)\n        \n        # Update concentration profile\n        c[1:-1] = c_internal_new\n        \n        # --- Calculate error for this time step ---\n        current_t = (k + 1) * dt\n        \n        # Numerical current (using a second-order accurate 3-point forward difference for the flux)\n        # dcdx @ x=0 approx. (4*c_1 - c_2) / (2*dx) since c_0 = 0\n        dcdx_num = (4.0 * c[1] - c[2]) / (2.0 * dx) # Order O(dx^2)\n        i_num = N_E * F * A * D * dcdx_num\n\n        # Analytical current (Cottrell equation)\n        i_ana = N_E * F * A * C_BULK * np.sqrt(D / (np.pi * current_t))\n        \n        sum_sq_err += (i_num - i_ana)**2\n\n    rmse = np.sqrt(sum_sq_err / Nt)\n    return rmse\n\nsolve()\n```"
        },
        {
            "introduction": "在验证了纯扩散模型之后，我们现在将注意力转向有限电子转移速率所带来的影响。本练习探讨一个不可逆电化学反应，其动力学由巴特勒-沃尔默（Butler-Volmer）方程描述，这与表面反应物被瞬间消耗（即表面浓度 $C_O(0,t)=0$）的理想可逆模型形成对比。通过推导并计算反应物表面浓度的解析解，您将能定量地理解标准速率常数 $k^0$ 和电极电势如何共同决定表面浓度，从而深刻揭示动力学对电化学系统行为的控制作用。",
            "id": "4257997",
            "problem": "我们考虑一个计算电化学中的平面、半无限扩散体系，其中氧化态物质 $O$ 发生单电子转移反应生成还原态物质 $R$，即 $O + e^- \\rightarrow R$。氧化态物质 $O$ 的本体浓度为 $C_O^\\*$，扩散系数为 $D_O$。在时间 $t=0$ 时，电极电位从形式电位 $E^0$ 阶跃至一个阴极电位值 $E_2$（相对于 $E^0$ 为负过电位）。电极位于 $x=0$ 处，溶液延伸至 $x \\ge 0$ 的区域。本问题旨在通过评估随时间变化的表面浓度 $C_O(0,t)$，并解释由有限的标准非均相速率常数 $k^0$ 引起的偏差，从而以物理上和计算上严谨的方式，比较不可逆瞬态与可逆步骤。\n\n其基本依据是在一维、半无限域和平面几何条件下，物质 $O$ 的菲克第二扩散定律：\n$$\\frac{\\partial C_O(x,t)}{\\partial t} = D_O \\frac{\\partial^2 C_O(x,t)}{\\partial x^2}, \\quad x \\ge 0, \\ t  0,$$\n初始条件和远场条件为\n$$C_O(x,0) = C_O^\\*, \\quad \\lim_{x \\to \\infty} C_O(x,t) = C_O^\\*.$$\n\n在电极表面 $x=0$ 处，边界条件由界面电荷转移动力学决定。对于一个反向反应可忽略的不可逆阴极电位阶跃，物质 $O$ 的消耗速率由其表面浓度和一级反应速率常数决定。此消耗必须由扩散通量来平衡。物理上正确的边界条件是：\n$$D_O \\left.\\frac{\\partial C_O(x,t)}{\\partial x}\\right|_{x=0} = k_{\\text{red}} C_O(0,t),$$\n其中，有效还原速率常数 $k_{\\text{red}}$ 取决于标准非均相速率常数 $k^0$、电荷转移系数 $\\alpha$、过电位 $\\eta = E_2 - E^0$（单位为伏特）以及热因子 $f = F/(RT)$，其中 $F$ 为法拉第常数，$R$ 为气体常数，$T$ 为绝对温度。关系式为\n$$k_{\\text{red}} = k^0 \\exp\\left(-\\alpha f \\eta\\right).$$\n使用 $F = 96485.33212 \\ \\mathrm{C \\ mol^{-1}}$、$R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} K^{-1}}$ 和 $T = 298.15 \\ \\mathrm{K}$，因此 $f$ 的数值是确定的。假设在 $t=0$ 时，氧化态物质 $O$ 是唯一初始存在的电活性物质，且初始时不存在物质 $R$。\n\n对于具有有效无限大非均相动力学并阶跃至足够负电位的可逆步骤极限，边界表现为吸收界面，对于 $t  0$，物质 $O$ 的表面浓度变为零，即\n$$C_O^{\\text{rev}}(0,t) = 0.$$\n这个可逆吸收边界作为与有限速率动力学进行比较的参考。\n\n您的任务是：\n- 从上述基本依据和边界条件出发，推导具有有限动力学的不可逆阴极阶跃下随时间变化的表面浓度 $C_O(0,t)$，并以对所有相关参数值都数值稳定的形式表示结果。\n- 实现一个程序，该程序针对下面定义的测试套件中的每个测试用例，计算不可逆情况下的无量纲比值 $C_O(0,t)/C_O^\\*$，并解释其与可逆吸收边界参考的偏差。这种解释通过计算出的无量纲比值本身来量化，因为可逆参考比值 $C_O^{\\text{rev}}(0,t)/C_O^\\* = 0$。\n\n所有计算输入都明确指定了物理单位。输出必须是无量纲数。不涉及角度。程序必须按照下面描述的精确最终输出格式生成结果。\n\n使用以下参数集测试套件，每个元组按 $(D_O \\ [\\mathrm{m^2/s}],\\ k^0 \\ [\\mathrm{m/s}],\\ \\alpha \\ [-],\\ \\eta \\ [\\mathrm{V}],\\ t \\ [\\mathrm{s}],\\ C_O^\\* \\ [\\mathrm{mol/m^3}])$ 顺序排列：\n1. $(1.0 \\times 10^{-9},\\ 1.0 \\times 10^{-7},\\ 0.50,\\ -0.30,\\ 1.0 \\times 10^{-3},\\ 1.0)$\n2. $(1.0 \\times 10^{-9},\\ 1.0 \\times 10^{-7},\\ 0.50,\\ -0.30,\\ 1.0 \\times 10^{-1},\\ 1.0)$\n3. $(1.0 \\times 10^{-9},\\ 1.0 \\times 10^{-3},\\ 0.50,\\ -0.30,\\ 1.0,\\ 1.0)$\n4. $(1.0 \\times 10^{-9},\\ 1.0 \\times 10^{-9},\\ 0.50,\\ -0.05,\\ 1.0 \\times 10^{-3},\\ 1.0)$\n5. $(5.0 \\times 10^{-10},\\ 1.0 \\times 10^{-5},\\ 0.30,\\ -0.20,\\ 1.0 \\times 10^{-2},\\ 1.0)$\n6. $(1.5 \\times 10^{-9},\\ 1.0 \\times 10^{-4},\\ 0.60,\\ -0.15,\\ 5.0 \\times 10^{-1},\\ 1.0)$\n\n对于每个测试用例，计算无量綱结果\n$$\\frac{C_O(0,t)}{C_O^\\*}$$\n对于上述不可逆动力学模型。将这些结果表示为浮点数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,...]”）。这些值为无量纲，不需要单位标签。请设计计算过程，使其在测试套件的所有案例中都保持数值稳定。",
            "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于电化学动力学和质量传输原理，在数学上是一个具有适当边界条件的良态线性偏微分方程，并且是客观和自洽的。所有提供的物理常数都是正确的，量纲分析证实了方程的一致性。\n\n该问题要求推导和计算在引发不可逆电化学反应的电位阶跃影响下，电活性物质在电极表面（$x=0$）随时间变化的浓度 $C_O(x,t)$。该体系由半无限一维域中的菲克第二扩散定律控制：\n$$\n\\frac{\\partial C_O(x,t)}{\\partial t} = D_O \\frac{\\partial^2 C_O(x,t)}{\\partial x^2}, \\quad \\text{for } x \\ge 0, t  0\n$$\n该问题受以下初始条件和边界条件的约束：\n1.  初始条件：对于所有 $x \\ge 0$，$C_O(x,0) = C_O^\\*$。在电位阶跃之前，浓度是均匀的，等于本体浓度 $C_O^\\*$。\n2.  远场边界条件：对于所有 $t  0$，$\\lim_{x \\to \\infty} C_O(x,t) = C_O^\\*$。远离电极处，浓度保持其本体值。\n3.  $x=0$ 处的表面边界条件：$D_O \\left.\\frac{\\partial C_O(x,t)}{\\partial x}\\right|_{x=0} = k_{\\text{red}} C_O(0,t)$。此条件将物质 $O$ 的消耗速率与扩散通量（从溶液本体到电极表面）等同起来。\n\n有效速率常数 $k_{\\text{red}}$ 由大阴极过电位下的 Butler-Volmer 动力学表达式给出：\n$$\nk_{\\text{red}} = k^0 \\exp(-\\alpha f \\eta)\n$$\n其中 $k^0$ 是标准非均相速率常数，$\\alpha$ 是电荷转移系数，$\\eta$ 是过电位，$f = F/(RT)$ 是热电压因子。\n\n求解此偏微分方程及给定条件的标准方法是拉普拉斯变换。令 $\\bar{c}(x,s) = \\mathcal{L}\\{C_O(x,t)\\}$ 为 $C_O(x,t)$ 关于时间 $t$ 的拉普拉斯变换。对扩散方程应用该变换，得到一个关于空间变量 $x$ 的常微分方程：\n$$\ns \\bar{c}(x,s) - C_O(x,0) = D_O \\frac{d^2 \\bar{c}(x,s)}{dx^2}\n$$\n代入初始条件 $C_O(x,0) = C_O^\\*$ 得：\n$$\n\\frac{d^2 \\bar{c}}{dx^2} - \\frac{s}{D_O} \\bar{c}(x,s) = -\\frac{C_O^\\*}{D_O}\n$$\n这个非齐次常微分方程的通解是一个特解 $\\bar{c}_p = C_O^\\*/s$ 与齐次方程解之和。解的形式为：\n$$\n\\bar{c}(x,s) = A(s) \\exp\\left(-\\sqrt{\\frac{s}{D_O}}x\\right) + B(s) \\exp\\left(+\\sqrt{\\frac{s}{D_O}}x\\right) + \\frac{C_O^\\*}{s}\n$$\n远场边界条件 $\\lim_{x \\to \\infty} C_O(x,t) = C_O^\\*$ 变换为 $\\lim_{x \\to \\infty} \\bar{c}(x,s) = C_O^\\*/s$。为使此式成立，指数增长项的系数必须为零，即 $B(s)=0$。解简化为：\n$$\n\\bar{c}(x,s) = A(s) \\exp\\left(-\\sqrt{\\frac{s}{D_O}}x\\right) + \\frac{C_O^\\*}{s}\n$$\n表面边界条件也被变换：\n$$\nD_O \\frac{d\\bar{c}}{dx}(0,s) = k_{\\text{red}} \\bar{c}(0,s)\n$$\n从解的形式，我们求得导数 $\\frac{d\\bar{c}}{dx}(x,s) = -A(s)\\sqrt{s/D_O}\\exp(-\\sqrt{s/D_O}x)$。在表面 $x=0$ 处，我们有 $\\bar{c}(0,s) = A(s) + C_O^\\*/s$ 和 $\\frac{d\\bar{c}}{dx}(0,s) = -A(s)\\sqrt{s/D_O}$。将这些代入变换后的边界条件得：\n$$\nD_O \\left(-A(s)\\sqrt{\\frac{s}{D_O}}\\right) = k_{\\text{red}} \\left(A(s) + \\frac{C_O^\\*}{s}\\right)\n$$\n$$\n-A(s) \\sqrt{sD_O} = k_{\\text{red}} A(s) + \\frac{k_{\\text{red}} C_O^\\*}{s}\n$$\n求解系数 $A(s)$：\n$$\nA(s) \\left(\\sqrt{sD_O} + k_{\\text{red}}\\right) = -\\frac{k_{\\text{red}} C_O^\\*}{s} \\implies A(s) = -\\frac{k_{\\text{red}} C_O^\\*}{s(\\sqrt{sD_O} + k_{\\text{red}})}\n$$\n拉普拉斯域中的表面浓度为 $\\bar{c}(0,s) = A(s) + C_O^\\*/s$：\n$$\n\\bar{c}(0,s) = -\\frac{k_{\\text{red}} C_O^\\*}{s(\\sqrt{sD_O} + k_{\\text{red}})} + \\frac{C_O^\\*}{s} = \\frac{C_O^\\*}{s}\\left(1 - \\frac{k_{\\text{red}}}{\\sqrt{sD_O} + k_{\\text{red}}}\\right) = \\frac{C_O^\\*\\sqrt{sD_O}}{s(\\sqrt{sD_O} + k_{\\text{red}})}\n$$\n待计算的量是无量纲比值 $C_O(0,t)/C_O^\\*$。其拉普拉斯变换为：\n$$\n\\mathcal{L}\\left\\{\\frac{C_O(0,t)}{C_O^\\*}\\right\\} = \\frac{\\bar{c}(0,s)}{C_O^\\*} = \\frac{\\sqrt{D_O}}{\\sqrt{s}(\\sqrt{sD_O} + k_{\\text{red}})} = \\frac{1}{\\sqrt{s}\\left(\\sqrt{s} + \\frac{k_{\\text{red}}}{\\sqrt{D_O}}\\right)}\n$$\n这是一个标准的拉普拉斯变换对。其逆变换由下式给出：\n$$\n\\frac{C_O(0,t)}{C_O^\\*} = \\exp\\left(\\left(\\frac{k_{\\text{red}}}{\\sqrt{D_O}}\\right)^2 t\\right) \\text{erfc}\\left(\\frac{k_{\\text{red}}}{\\sqrt{D_O}}\\sqrt{t}\\right) = \\exp\\left(\\frac{k_{\\text{red}}^2 t}{D_O}\\right) \\text{erfc}\\left(k_{\\text{red}}\\sqrt{\\frac{t}{D_O}}\\right)\n$$\n该表达式的形式为 $\\exp(z^2)\\text{erfc}(z)$，其中 $z = k_{\\text{red}}\\sqrt{t/D_O}$。当参数 $z$ 值很大时，直接计算 $\\exp(z^2)$ 和 $\\text{erfc}(z)$ 可能导致数值不稳定（分别为上溢和下溢）。一种数值稳健的方法是使用缩放互补误差函数 $\\text{erfcx}(z) = \\exp(z^2)\\text{erfc}(z)$，该函数专为在所有非负 $z$ 值上进行稳定计算而设计。此函数可在标准科学库中找到，例如 Python 中的 `scipy.special.erfcx`。\n\n计算步骤如下：\n1.  使用提供的物理常数计算热因子 $f = F/(RT)$。\n2.  对每个测试用例，计算有效速率常数 $k_{\\text{red}} = k^0 \\exp(-\\alpha f \\eta)$。\n3.  计算无量纲参数 $z = k_{\\text{red}}\\sqrt{t/D_O}$。\n4.  将所需比值 $C_O(0,t)/C_O^\\*$ 计算为 $\\text{erfcx}(z)$ 的倒数，即 $1/\\text{erfcx}(z)$。修正：最终公式为 $\\exp(z^2)\\text{erfc}(z)$，这直接就是 $\\text{erfcx}(z)$ 的值。结果是一个介于 $0$ 和 $1$ 之间的无量纲数。接近 $0$ 的值表示行为接近可逆极限（动力学非常快，表面完全耗尽），而接近 $1$ 的值表示动力学非常慢，表面浓度与本体值相比几乎没有变化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfcx\n\ndef solve():\n    \"\"\"\n    Solves the electrochemical diffusion problem for the given test cases.\n    \"\"\"\n    \n    # Define physical constants\n    F = 96485.33212  # Faraday constant in C/mol\n    R = 8.314462618  # Gas constant in J/(mol*K)\n    T = 298.15       # Temperature in K\n    \n    # Pre-calculate the thermal factor f = F/(RT)\n    f_val = F / (R * T)\n    \n    # Test suite of parameter sets (D_O [m^2/s], k^0 [m/s], alpha [-], eta [V], t [s], C_O* [mol/m^3])\n    test_cases = [\n        (1.0e-9, 1.0e-7, 0.50, -0.30, 1.0e-3, 1.0),\n        (1.0e-9, 1.0e-7, 0.50, -0.30, 1.0e-1, 1.0),\n        (1.0e-9, 1.0e-3, 0.50, -0.30, 1.0, 1.0),\n        (1.0e-9, 1.0e-9, 0.50, -0.05, 1.0e-3, 1.0),\n        (5.0e-10, 1.0e-5, 0.30, -0.20, 1.0e-2, 1.0),\n        (1.5e-9, 1.0e-4, 0.60, -0.15, 5.0e-1, 1.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current test case\n        D_O, k0, alpha, eta, t, _ = case\n        \n        # Step 1: Calculate the effective reduction rate constant k_red\n        # k_red = k^0 * exp(-alpha * f * eta)\n        k_red = k0 * np.exp(-alpha * f_val * eta)\n        \n        # Step 2: Calculate the dimensionless argument z\n        # z = k_red * sqrt(t / D_O)\n        z = k_red * np.sqrt(t / D_O)\n        \n        # Step 3: Compute the dimensionless surface concentration ratio\n        # C_O(0,t)/C_O* = exp(z^2) * erfc(z)\n        # This is equivalent to the scaled complementary error function, erfcx(z).\n        # The scipy.special.erfcx function is used for numerical stability.\n        concentration_ratio = erfcx(z)\n        \n        results.append(concentration_ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实的电化学系统常常受到非理想因素的干扰，其中未补偿电阻（$R_u$）尤为普遍。它所引起的欧姆压降（$iR_u$）使得驱动反应的有效界面电势依赖于体系自身产生的电流，从而形成一个必须自洽求解的非线性隐式问题。本练习将指导您如何将巴特勒-沃尔默动力学、稳态传质与欧姆压降相结合，构建一个非线性方程，并使用稳健的数值求根方法来确定系统的稳态电流。成功完成此练习意味着您已具备处理更接近真实实验条件的复杂电化学模型的能力。",
            "id": "4258012",
            "problem": "考虑一个单电子（$n=1$）外层氧化还原反应，该反应在厚度为 $\\delta$ 的扩散层下，于一个平面电极上，在稳态条件下，于氧化态物种 $\\mathrm{O}$ 和还原态物种 $\\mathrm{R}$ 之间进行。电极受到一个未补偿电阻（R_u）的影响，该电阻定义为工作电极和参比电极之间无法被恒电位仪补偿的电阻。未补偿电阻（R_u）会引起欧姆压降，从而改变有效界面电位。假设温度为 $T$（单位 $\\mathrm{K}$），普适气体常数为 $R$（单位 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$），法拉第常数为 $F$（单位 $\\mathrm{C}\\,\\mathrm{mol}^{-1}$）。设外加电位为 $E_{\\mathrm{app}}$（单位 $\\mathrm{V}$），形式电位为 $E_0$（单位 $\\mathrm{V}$）。有效界面电位 $E_{\\mathrm{eff}}$ 通过由 $R_u$ 引起的欧姆压降与 $E_{\\mathrm{app}}$ 相关联，而欧姆压降取决于电流 $i$（单位 $\\mathrm{A}$），这使得 $E_{\\mathrm{eff}}$ 隐式地依赖于 $i$。\n\n从单电子转移的 Butler–Volmer 动力学描述出发，使用标准非均相速率常数 $k_0$（单位 $\\mathrm{m}\\,\\mathrm{s}^{-1}$）和电荷转移系数 $\\alpha$（无量纲），并对 $\\mathrm{O}$ 和 $\\mathrm{R}$ 采用基于膜理论的线性稳态传质模型，推导包含对 $E_{\\mathrm{eff}}$ 依赖关系的修正阳极和阴极速率常数 $k_a(E_{\\mathrm{eff}})$ 和 $k_c(E_{\\mathrm{eff}})$ 的表达式。然后，推导出一个关于界面摩尔通量 $j$（单位 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）的自洽代数表达式，该表达式应使用 $k_a(E_{\\mathrm{eff}})$、$k_c(E_{\\mathrm{eff}})$、体相浓度 $C_{\\mathrm{O},b}$ 和 $C_{\\mathrm{R},b}$（单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$）以及传质系数 $k_{m,\\mathrm{O}}$ 和 $k_{m,\\mathrm{R}}$（单位 $\\mathrm{m}\\,\\mathrm{s}^{-1}$）来表示，其中 $k_{m,\\mathrm{O}} = D_{\\mathrm{O}}/\\delta$ 和 $k_{m,\\mathrm{R}} = D_{\\mathrm{R}}/\\delta$，$D_{\\mathrm{O}}$ 和 $D_{\\mathrm{R}}$ 为扩散系数（单位 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）。接下来，构建一个数值方案来解决 $i$ 对 $E_{\\mathrm{eff}}$ 的隐式依赖关系，已知 $i = n F A j$（单位 $\\mathrm{A}$），其中 $A$ 是电极面积（单位 $\\mathrm{m}^2$）且 $n=1$，以及 $E_{\\mathrm{eff}} = E_{\\mathrm{app}} - i R_u$（单位 $\\mathrm{V}$）。\n\n您的数值方案必须：\n- 定义一个非线性标量函数，其根对应于物理上一致的电流 $i$，并证明在所提供的参数范围内该函数是适定的。\n- 采用一种鲁棒的求根方法，并使用适当的初始猜测值或区间限定，以确保在准可逆和不可逆区间内都能收敛。\n- 明确说明所使用的收敛判据和最大迭代次数。\n\n将完整的算法实现为一个程序，用于计算下述每个测试用例的稳态电流 $i$（单位 $\\mathrm{A}$）。将每个结果以 $\\mathrm{A}$ 为单位表示为一个四舍五入到六位小数的浮点数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[i_1,i_2,i_3,i_4,i_5]$）。不涉及角度；无需角度单位。如果必须在小数和分数输出之间进行选择，请使用小数。\n\n在所有情况下，使用以下常数和全局参数：\n- $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$，$R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$T = 298.15\\,\\mathrm{K}$，$n = 1$，$A = 1.0\\times 10^{-6}\\,\\mathrm{m}^2$，$E_0 = 0.0\\,\\mathrm{V}$。\n\n对于每个测试用例，使用提供的 $D_{\\mathrm{O}}$、$D_{\\mathrm{R}}$ 和 $\\delta$ 计算 $k_{m,\\mathrm{O}} = D_{\\mathrm{O}}/\\delta$ 和 $k_{m,\\mathrm{R}} = D_{\\mathrm{R}}/\\delta$。\n\n测试套件：\n- 案例 $1$（准可逆还原，中等 $R_u$）：$E_{\\mathrm{app}} = -0.05\\,\\mathrm{V}$，$R_u = 10\\,\\Omega$，$k_0 = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$\\alpha = 0.5$，$C_{\\mathrm{O},b} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$C_{\\mathrm{R},b} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$D_{\\mathrm{O}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{R}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\delta = 1.0\\times 10^{-5}\\,\\mathrm{m}$。\n- 案例 $2$（不可逆还原，较大 $R_u$）：$E_{\\mathrm{app}} = -0.05\\,\\mathrm{V}$，$R_u = 50\\,\\Omega$，$k_0 = 1.0\\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$\\alpha = 0.5$，$C_{\\mathrm{O},b} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$C_{\\mathrm{R},b} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$D_{\\mathrm{O}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{R}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\delta = 1.0\\times 10^{-5}\\,\\mathrm{m}$。\n- 案例 $3$（准可逆氧化，两种物种均存在）：$E_{\\mathrm{app}} = +0.05\\,\\mathrm{V}$，$R_u = 5\\,\\Omega$，$k_0 = 2.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$\\alpha = 0.4$，$C_{\\mathrm{O},b} = 0.2\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$C_{\\mathrm{R},b} = 0.8\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$D_{\\mathrm{O}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{R}} = 1.5\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\delta = 1.0\\times 10^{-5}\\,\\mathrm{m}$。\n- 案例 $4$（强未补偿电阻，对称体相浓度）：$E_{\\mathrm{app}} = +0.01\\,\\mathrm{V}$，$R_u = 1000\\,\\Omega$，$k_0 = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$\\alpha = 0.5$，$C_{\\mathrm{O},b} = 0.5\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$C_{\\mathrm{R},b} = 0.5\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$D_{\\mathrm{O}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{R}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\delta = 5.0\\times 10^{-6}\\,\\mathrm{m}$。\n- 案例 $5$（无未补偿电阻边界检查）：$E_{\\mathrm{app}} = -0.01\\,\\mathrm{V}$，$R_u = 0\\,\\Omega$，$k_0 = 5.0\\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$\\alpha = 0.5$，$C_{\\mathrm{O},b} = 0.7\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$C_{\\mathrm{R},b} = 0.3\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$D_{\\mathrm{O}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{R}} = 1.0\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\delta = 1.0\\times 10^{-5}\\,\\mathrm{m}$。\n\n您的实现必须计算并以指定的最终输出格式在单行中输出所有五个案例的电流。所有物理量必须按其指定单位处理，最终输出必须以 $\\mathrm{A}$ 为单位给出，并四舍五入到六位小数。",
            "solution": "该问题是有效的，因为它在科学上基于电化学动力学和传质原理，在数学上是适定的，并提供了一套完整且一致的参数。因此，我们可以进行完整的解答。\n\n我们的目标是求解在平面电极上发生的单电子氧化还原反应 $\\mathrm{O} + e^- \\rightleftharpoons \\mathrm{R}$ 的稳态电流 $i$。该系统通过 Butler-Volmer 动力学、用于传质的膜理论模型以及未补偿电阻 $R_u$ 的影响来描述。核心困难在于电流 $i$ 和有效界面电位 $E_{\\mathrm{eff}}$ 之间的隐式关系。\n\n步骤 1：控制方程的推导\n\n首先，我们将依赖于电位的阴极和阳极速率常数 $k_c$ 和 $k_a$ 表示为有效界面电位 $E_{\\mathrm{eff}}$ 的函数。根据单电子转移（$n=1$）的 Butler-Volmer 模型，它们是：\n$$k_c(E_{\\mathrm{eff}}) = k_0 \\exp\\left(-\\frac{\\alpha F}{RT}(E_{\\mathrm{eff}} - E_0)\\right)$$\n$$k_a(E_{\\mathrm{eff}}) = k_0 \\exp\\left(\\frac{(1-\\alpha) F}{RT}(E_{\\mathrm{eff}} - E_0)\\right)$$\n此处，$k_0$ 是标准非均相速率常数，$\\alpha$ 是电荷转移系数，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是温度，$E_0$ 是形式电位。\n\n接下来，我们使用膜模型描述物种 $\\mathrm{O}$ 和 $\\mathrm{R}$ 往返于电极表面的稳态传质过程。摩尔通量 $j$（单位 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）通过它们各自的传质系数 $k_{m,\\mathrm{O}}$ 和 $k_{m,\\mathrm{R}}$ 与体相浓度（$C_{\\mathrm{O},b}$，$C_{\\mathrm{R},b}$）和表面浓度（$C_{\\mathrm{O}}(0)$，$C_{\\mathrm{R}}(0)$）之间的差异相关联：\n$$j = k_{m,\\mathrm{O}} (C_{\\mathrm{O},b} - C_{\\mathrm{O}}(0))$$\n$$j = k_{m,\\mathrm{R}} (C_{\\mathrm{R}}(0) - C_{\\mathrm{R},b})$$\n正通量 $j0$ 对应于净还原（$\\mathrm{O} \\rightarrow \\mathrm{R}$）。我们可以重新整理这些方程，用通量来表示表面浓度：\n$$C_{\\mathrm{O}}(0) = C_{\\mathrm{O},b} - \\frac{j}{k_{m,\\mathrm{O}}}$$\n$$C_{\\mathrm{R}}(0) = C_{\\mathrm{R},b} + \\frac{j}{k_{m,\\mathrm{R}}}$$\n\n电极表面的净通量也由动力学速率给出：\n$$j = k_c(E_{\\mathrm{eff}}) C_{\\mathrm{O}}(0) - k_a(E_{\\mathrm{eff}}) C_{\\mathrm{R}}(0)$$\n将表面浓度的表达式代入此动力学方程，得到：\n$$j = k_c(E_{\\mathrm{eff}}) \\left( C_{\\mathrm{O},b} - \\frac{j}{k_{m,\\mathrm{O}}} \\right) - k_a(E_{\\mathrm{eff}}) \\left( C_{\\mathrm{R},b} + \\frac{j}{k_{m,\\mathrm{R}}} \\right)$$\n现在我们可以求解这个方程得到通量 $j$：\n$$j \\left( 1 + \\frac{k_c(E_{\\mathrm{eff}})}{k_{m,\\mathrm{O}}} + \\frac{k_a(E_{\\mathrm{eff}})}{k_{m,\\mathrm{R}}} \\right) = k_c(E_{\\mathrm{eff}}) C_{\\mathrm{O},b} - k_a(E_{\\mathrm{eff}}) C_{\\mathrm{R},b}$$\n这就得到了所要求的关于界面摩尔通量 $j$ 的自洽表达式：\n$$j = \\frac{k_c(E_{\\mathrm{eff}}) C_{\\mathrm{O},b} - k_a(E_{\\mathrm{eff}}) C_{\\mathrm{R},b}}{1 + \\frac{k_c(E_{\\mathrm{eff}})}{k_{m,\\mathrm{O}}} + \\frac{k_a(E_{\\mathrm{eff}})}{k_{m,\\mathrm{R}}}}$$\n\n步骤 2：数值方案的构建\n\n通量 $j$ 通过 $i = n F A j$ 与总电流 $i$ 相关，其中 $A$ 是电极面积且 $n=1$。有效电位 $E_{\\mathrm{eff}}$ 被未补偿电阻 $R_u$ 上的欧姆压降所修正，即 $E_{\\mathrm{eff}} = E_{\\mathrm{app}} - i R_u$。该方程组是隐式的：$i$ 依赖于 $j$，$j$ 依赖于 $E_{\\mathrm{eff}}$，而 $E_{\\mathrm{eff}}$ 又依赖于 $i$。\n\n为了求解这个系统，我们构建一个非线性标量方程，其根是所期望的电流 $i$。我们可以定义一个函数 $f(i)$，使得当电流 $i$ 是自洽的时，$f(i)=0$。设 $i_{calc}(i)$ 是根据动力学和传质方程计算出的电流，假设真实电流为 $i$（这决定了 $E_{\\mathrm{eff}}$ 的值）。\n$$i_{calc}(i) = n F A j = n F A \\frac{k_c(E_{\\mathrm{app}} - i R_u) C_{\\mathrm{O},b} - k_a(E_{\\mathrm{app}} - i R_u) C_{\\mathrm{R},b}}{1 + \\frac{k_c(E_{\\mathrm{app}} - i R_u)}{k_{m,\\mathrm{O}}} + \\frac{k_a(E_{\\mathrm{app}} - i R_u)}{k_{m,\\mathrm{R}}}}$$\n当假设的电流 $i$ 等于计算出的电流 $i_{calc}$ 时，就找到了自洽解。因此，我们寻求以下函数的根：\n$$f(i) = i - i_{calc}(i) = 0$$\n\n这个函数是适定的。电流 $i$ 在物理上受到传质极限阴极电流 $i_{lim,c}$ 和传质极限阳极电流 $i_{lim,a}$ 的限制：\n$$i_{lim,c} = n F A k_{m,\\mathrm{O}} C_{\\mathrm{O},b}$$\n$$i_{lim,a} = -n F A k_{m,\\mathrm{R}} C_{\\mathrm{R},b}$$\n实际电流 $i$ 必须位于区间 $[i_{lim,a}, i_{lim,c}]$ 内。在下界 $i_{lim,a}$ 处，由于动力学速率是有限的，计算出的电流 $i_{calc}$ 将大于 $i_{lim,a}$（负得更少）。因此，$f(i_{lim,a})  0$。相反，在上界 $i_{lim,c}$ 处，出于同样的原因，$i_{calc}$ 将小于 $i_{lim,c}$，所以 $f(i_{lim,c})  0$。由于函数 $f(i)$ 在区间 $[i_{lim,a}, i_{lim,c}]$ 上是连续的且变号，根据介值定理，可以保证在该区间内至少存在一个根。在这些条件下，底层物理模型不会表现出双稳态，因此根是唯一的。\n\n对于这个问题，一种鲁棒的数值方法是区间求根算法，例如 Brent 方法。我们将使用 `scipy.optimize.brentq`，并以物理传质极限作为限定区间。收敛判据将是电流 $i$ 的值容差为 $1 \\times 10^{-12}$，最大迭代次数将设置为 100，这已绰绰有余。\n\n步骤 3：算法实现\n\n对每个测试用例，算法按以下步骤进行：\n1.  定义全局常数：$F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$，$R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$T = 298.15\\,\\mathrm{K}$，$n=1$，$A = 1.0\\times 10^{-6}\\,\\mathrm{m}^2$，$E_0 = 0.0\\,\\mathrm{V}$。\n2.  对于给定的参数集 $\\{E_{\\mathrm{app}}, R_u, k_0, \\alpha, C_{\\mathrm{O},b}, C_{\\mathrm{R},b}, D_{\\mathrm{O}}, D_{\\mathrm{R}}, \\delta\\}$，计算传质系数 $k_{m,\\mathrm{O}} = D_{\\mathrm{O}}/\\delta$ 和 $k_{m,\\mathrm{R}} = D_{\\mathrm{R}}/\\delta$。\n3.  定义在步骤 2 中描述的函数 $f(i)$。\n4.  计算限定区间 $[i_{lim,a}, i_{lim,c}]$。\n5.  使用 Brent 方法（`brentq`）在区间内找到 $f(i)=0$ 的根。\n6.  所得的根即为稳态电流 $i$。\n7.  对所有测试用例重复此过程，并按规定格式化输出。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the results.\n    \"\"\"\n\n    # Global constants as specified in the problem statement.\n    F = 96485.0  # Faraday constant in C/mol\n    R = 8.314    # Universal gas constant in J/(mol*K)\n    T = 298.15   # Temperature in K\n    N_e = 1.0    # Number of electrons\n    A = 1.0e-6   # Electrode area in m^2\n    E0 = 0.0     # Formal potential in V\n\n    # Test suite defined as a list of dictionaries.\n    test_cases = [\n        {'E_app': -0.05, 'R_u': 10.0, 'k0': 1.0e-3, 'alpha': 0.5, 'C_O_b': 1.0, 'C_R_b': 0.0, 'D_O': 1.0e-9, 'D_R': 1.0e-9, 'delta': 1.0e-5},\n        {'E_app': -0.05, 'R_u': 50.0, 'k0': 1.0e-6, 'alpha': 0.5, 'C_O_b': 1.0, 'C_R_b': 0.0, 'D_O': 1.0e-9, 'D_R': 1.0e-9, 'delta': 1.0e-5},\n        {'E_app': 0.05, 'R_u': 5.0, 'k0': 2.0e-3, 'alpha': 0.4, 'C_O_b': 0.2, 'C_R_b': 0.8, 'D_O': 1.0e-9, 'D_R': 1.5e-9, 'delta': 1.0e-5},\n        {'E_app': 0.01, 'R_u': 1000.0, 'k0': 1.0e-3, 'alpha': 0.5, 'C_O_b': 0.5, 'C_R_b': 0.5, 'D_O': 1.0e-9, 'D_R': 1.0e-9, 'delta': 5.0e-6},\n        {'E_app': -0.01, 'R_u': 0.0, 'k0': 5.0e-4, 'alpha': 0.5, 'C_O_b': 0.7, 'C_R_b': 0.3, 'D_O': 1.0e-9, 'D_R': 1.0e-9, 'delta': 1.0e-5},\n    ]\n\n    def calculate_current(params):\n        \"\"\"\n        Computes the steady-state current for a single set of electrochemical parameters.\n        \"\"\"\n        # Unpack case parameters\n        E_app = params['E_app']\n        R_u = params['R_u']\n        k0 = params['k0']\n        alpha = params['alpha']\n        C_O_b = params['C_O_b']\n        C_R_b = params['C_R_b']\n        D_O = params['D_O']\n        D_R = params['D_R']\n        delta = params['delta']\n\n        # Calculate derived parameters\n        k_m_O = D_O / delta\n        k_m_R = D_R / delta\n        f_norm = N_e * F / (R * T)\n\n        def f_to_solve(i):\n            \"\"\"\n            Defines the nonlinear scalar function f(i) = i - i_calc(i) = 0\n            whose root is the self-consistent current.\n            \"\"\"\n            E_eff = E_app - i * R_u\n            E_shift = E_eff - E0\n\n            # Butler-Volmer rate constants\n            k_c = k0 * np.exp(-alpha * f_norm * E_shift)\n            k_a = k0 * np.exp((1 - alpha) * f_norm * E_shift)\n\n            # Expression for current including kinetics and mass transport\n            numerator = k_c * C_O_b - k_a * C_R_b\n            denominator = 1.0 + k_c / k_m_O + k_a / k_m_R\n            \n            # Avoid division by zero, though not expected in this problem\n            if denominator == 0:\n                j_pred = 0.0\n            else:\n                j_pred = numerator / denominator\n            \n            i_pred = N_e * F * A * j_pred\n            \n            return i - i_pred\n\n        # Define the bracketing interval based on physical mass-transport limits\n        i_lim_c = N_e * F * A * k_m_O * C_O_b\n        i_lim_a = -N_e * F * A * k_m_R * C_R_b\n\n        # Handle the trivial case where no reactant is present, current must be 0\n        if i_lim_a == 0.0 and i_lim_c == 0.0:\n            return 0.0\n\n        # Ensure the bracket endpoints are distinct for the solver\n        # and provide a small buffer to avoid issues at the exact limits.\n        a = min(i_lim_a, i_lim_c) - 1e-12\n        b = max(i_lim_a, i_lim_c) + 1e-12\n\n\n        # Use Brent's method to find the root of the function f(i)\n        # It's robust and efficient for well-behaved 1D functions.\n        root = brentq(f_to_solve, a, b, xtol=1e-12, maxiter=100)\n        \n        return root\n\n    results = []\n    for case_params in test_cases:\n        current = calculate_current(case_params)\n        results.append(f\"{current:.6f}\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}