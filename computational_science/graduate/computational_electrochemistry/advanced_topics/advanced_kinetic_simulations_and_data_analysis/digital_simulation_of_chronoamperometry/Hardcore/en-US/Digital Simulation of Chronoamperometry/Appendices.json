{
    "hands_on_practices": [
        {
            "introduction": "This practice introduces the Forward-Time Centered-Space (FTCS) explicit method, a common starting point for discretizing parabolic partial differential equations like Fick's second law. While straightforward to implement, this method is only conditionally stable, meaning the ratio of the time step $ \\Delta t $ to the square of the spatial step $ (\\Delta x)^2 $ must be kept below a certain threshold. This exercise  provides hands-on experience with this critical concept by having you determine the largest possible $ \\Delta t $ that ensures a stable and physically meaningful simulation.",
            "id": "4242524",
            "problem": "A planar electrode at $x=0$ undergoes an instantaneous potential step at $t=0$ that drives a diffusion-limited reduction of a single electroactive species of bulk concentration $c^{\\ast}$ in a semi-infinite electrolyte occupying $x>0$. The concentration field $c(x,t)$ along the one-dimensional normal direction $x$ is governed by Fick’s second law, $$\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^{2} c}{\\partial x^{2}},$$ with the initial condition $c(x,0)=c^{\\ast}$, boundary condition $c(0,t)=0$ at the electrode, and $c(x,t)\\to c^{\\ast}$ as $x\\to\\infty$. You will perform a digital simulation of chronoamperometry using the Forward-Time Centered-Space (FTCS) explicit finite difference scheme on a uniform grid with spatial step size $\\Delta x$.\n\nTo faithfully capture the early-time Cottrell $t^{-1/2}$ region of the current response, you plan to simulate times from $t=0$ up to an upper bound $t_{\\min}$ that marks the end of the strictly $t^{-1/2}$-dominated regime for your system. To minimize computational work while maintaining numerical stability, you will choose the largest time step $\\Delta t$ allowed by the explicit FTCS stability condition derived from linear Fourier-mode (von Neumann) analysis of the discrete diffusion operator.\n\nGiven the parameters $D = 9.0 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$, $\\Delta x = 5.0 \\times 10^{-8}\\ \\mathrm{m}$, and $t_{\\min} = 2.0 \\times 10^{-3}\\ \\mathrm{s}$, determine the minimal number of time steps needed to reach $t_{\\min}$ using the maximum stable $\\Delta t$. Express your final answer as a single integer (dimensionless). No rounding instructions are required because the answer is exactly determined by the stability limit and the requirement to cover $t_{\\min}$.",
            "solution": "The problem asks for the minimal number of time steps required for a digital simulation of chronoamperometry up to a time $t_{\\min}$, using an explicit finite difference scheme with the largest possible stable time step.\n\nThe physical process is governed by Fick's second law in one dimension:\n$$\n\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^{2} c}{\\partial x^{2}}\n$$\nwhere $c(x,t)$ is the concentration of the electroactive species, $D$ is the diffusion coefficient, $x$ is the spatial coordinate normal to the electrode, and $t$ is time.\n\nThe numerical method specified is the Forward-Time Centered-Space (FTCS) explicit finite difference scheme. We discretize the continuous domain $(x,t)$ onto a grid with points $(x_j, t_n)$, where $x_j = j \\Delta x$ and $t_n = n \\Delta t$. Let $c_j^n$ represent the numerical approximation of $c(x_j, t_n)$.\n\nThe FTCS discretization of the governing equation is:\n$$\n\\frac{c_j^{n+1} - c_j^n}{\\Delta t} = D \\frac{c_{j+1}^n - 2c_j^n + c_{j-1}^n}{(\\Delta x)^2}\n$$\nThis is an explicit scheme, as the concentration at the new time step, $c_j^{n+1}$, can be calculated directly from the concentrations at the current time step, $c^n_j$. The update equation is:\n$$\nc_j^{n+1} = c_j^n + \\frac{D \\Delta t}{(\\Delta x)^2} (c_{j+1}^n - 2c_j^n + c_{j-1}^n)\n$$\nThe stability of this scheme is governed by the dimensionless diffusion number, which we will denote as $r$:\n$$\nr = \\frac{D \\Delta t}{(\\Delta x)^2}\n$$\nA von Neumann stability analysis for the FTCS scheme applied to the one-dimensional diffusion equation reveals that the scheme is conditionally stable. The stability condition is:\n$$\nr \\le \\frac{1}{2}\n$$\nor equivalently,\n$$\n\\frac{D \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}\n$$\nTo minimize the number of time steps, and thus the computational cost, we must use the largest possible time step, $\\Delta t$, that satisfies this condition. This maximum stable time step, $\\Delta t_{\\max}$, is found by setting the expression to its limit:\n$$\n\\frac{D \\Delta t_{\\max}}{(\\Delta x)^2} = \\frac{1}{2}\n$$\nSolving for $\\Delta t_{\\max}$ gives:\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2D}\n$$\nThe problem provides the following values:\n- Diffusion coefficient, $D = 9.0 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$\n- Spatial step size, $\\Delta x = 5.0 \\times 10^{-8}\\ \\mathrm{m}$\n- Total simulation time, $t_{\\min} = 2.0 \\times 10^{-3}\\ \\mathrm{s}$\n\nWe can now calculate the numerical value of $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{(5.0 \\times 10^{-8}\\ \\mathrm{m})^2}{2 \\times (9.0 \\times 10^{-10}\\ \\mathrm{m^2\\,s^{-1}})} = \\frac{25.0 \\times 10^{-16}\\ \\mathrm{m^2}}{1.8 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}} = \\frac{25}{18} \\times 10^{-6}\\ \\mathrm{s}\n$$\nThe minimal number of time steps, $N$, required to reach the total simulation time $t_{\\min}$ is the total time divided by the duration of a single time step, $\\Delta t_{\\max}$. If this ratio is not an integer, we must take the ceiling of the result to ensure the total simulated duration is at least $t_{\\min}$.\n$$\nN = \\left\\lceil \\frac{t_{\\min}}{\\Delta t_{\\max}} \\right\\rceil\n$$\nSubstituting the values:\n$$\nN = \\left\\lceil \\frac{2.0 \\times 10^{-3}\\ \\mathrm{s}}{\\frac{25}{18} \\times 10^{-6}\\ \\mathrm{s}} \\right\\rceil\n$$\n$$\nN = \\left\\lceil \\frac{2.0 \\times 10^{-3} \\times 18}{25 \\times 10^{-6}} \\right\\rceil = \\left\\lceil \\frac{36.0}{25.0} \\times 10^3 \\right\\rceil\n$$\n$$\nN = \\lceil 1.44 \\times 10^3 \\rceil = \\lceil 1440 \\rceil\n$$\nSince the result of the division is an exact integer, the ceiling function does not change the value. The minimal number of time steps is precisely $1440$.",
            "answer": "$$\\boxed{1440}$$"
        },
        {
            "introduction": "After establishing the stability limits of an explicit scheme, the logical next step is to build and test a working model. This practice  guides you through the process of writing a complete digital simulation for chronoamperometry using the explicit FTCS method. The core of this exercise lies in validating your numerical output by comparing it against the analytical Cottrell equation, a fundamental skill for verifying the accuracy of any scientific simulation and quantifying its discretization error as a function of the stability parameter $ \\lambda $.",
            "id": "4242489",
            "problem": "Consider one-dimensional semi-infinite planar diffusion of a reducible species to an electrode following a potential step at time $t=0$ that instantaneously sets the surface concentration to zero. The species has bulk concentration $c^\\ast$ and diffusion coefficient $D$. The governing equation is Fick's second law in one dimension, which can be written as $ \\partial c / \\partial t = D \\, \\partial^2 c / \\partial x^2 $ for $x \\ge 0$ and $t > 0$, subject to the initial condition $ c(x,0) = c^\\ast $, the boundary condition at the electrode surface $ c(0,t) = 0 $ for all $t > 0$, and the far-field boundary condition $ c(\\infty,t) = c^\\ast $. The measurable current is given by the diffusive flux at the electrode surface, $ i(t) = n \\, F \\, A \\, \\left( - D \\, \\left. \\partial c / \\partial x \\right|_{x=0} \\right) $, where $n$ is the number of electrons transferred per molecule, $F$ is the Faraday constant, and $A$ is the electrode area.\n\nThe well-tested baseline for validating early-time behavior is the Cottrell relation, $ i_C(t) = n \\, F \\, A \\, c^\\ast \\, \\sqrt{ D / (\\pi \\, t) } $, which holds for semi-infinite diffusion with the stated boundary and initial conditions.\n\nYou will implement a digital simulation of chronoamperometry using a forward-time, central-space (explicit) finite-difference scheme on a truncated domain $ [0, L] $ with $N$ uniformly spaced grid points and Dirichlet boundary conditions $ c(0,t) = 0 $ and $ c(L,t) = c^\\ast $. Denote the spatial step by $ \\Delta x = L/(N-1) $ and the time step by $ \\Delta t $. Define the dimensionless parameter $ \\lambda = D \\, \\Delta t / \\Delta x^2 $. The discrete update for interior nodes $ j = 1,2,\\ldots,N-2 $ is\n$$ c_j^{n+1} = c_j^n + \\lambda \\left( c_{j+1}^n - 2 \\, c_j^n + c_{j-1}^n \\right), $$\nwith $ c_0^n = 0 $ and $ c_{N-1}^n = c^\\ast $ for all time indices $n$. Approximate the surface gradient using the second-order one-sided finite difference\n$$ \\left. \\frac{\\partial c}{\\partial x} \\right|_{x=0} \\approx \\frac{-3 \\, c_0^n + 4 \\, c_1^n - c_2^n}{2 \\, \\Delta x}. $$\nUse this to compute a simulated current $ i_{\\text{sim}}(t_n) $ at the discrete times $ t_n = n \\, \\Delta t $ for $n \\ge 1$, and compare with $ i_C(t_n) $.\n\nYour task is to quantify the early-time discretization error as a function of $ \\lambda $ by computing the maximum relative error over the first $k_{\\max}$ time steps, where the relative error at time $ t_n $ is defined as\n$$ \\varepsilon_n = \\frac{ \\left| i_{\\text{sim}}(t_n) - i_C(t_n) \\right| }{ i_C(t_n) }, \\quad \\text{and} \\quad \\varepsilon(\\lambda) = \\max_{1 \\le n \\le k_{\\max}} \\varepsilon_n. $$\n\nImplement the simulation with the following scientifically realistic parameter values and units:\n- $ D = 1 \\times 10^{-9} $ in $\\text{m}^2/\\text{s}$,\n- $ c^\\ast = 1 \\times 10^{-3} $ in $\\text{mol}/\\text{m}^3$,\n- $ A = 1 \\times 10^{-4} $ in $\\text{m}^2$,\n- $ n = 1 $ (dimensionless),\n- $ F = 96485.33212 $ in $\\text{C}/\\text{mol}$,\n- $ L = 5 \\times 10^{-4} $ in $\\text{m}$,\n- $ N = 801 $ (dimensionless),\n- $ k_{\\max} = 5 $ (dimensionless).\n\nThe test suite is the set of five $ \\lambda $ values:\n- $ \\lambda = 0.05 $,\n- $ \\lambda = 0.10 $,\n- $ \\lambda = 0.25 $,\n- $ \\lambda = 0.45 $,\n- $ \\lambda = 0.50 $.\n\nFor each $ \\lambda $ in the test suite, compute $ \\varepsilon(\\lambda) $ as defined above. The final outputs are dimensionless floats representing the maximum relative error for each test case. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $ [r_1, r_2, r_3, r_4, r_5] $). No units are required in the output because the relative error is dimensionless. Ensure that the finite-difference scheme is applied correctly, that the explicit scheme stability restriction $ \\lambda \\le 0.5 $ is respected, and that the Dirichlet far-field boundary condition at $ x = L $ is enforced. The program must be self-contained, require no user input, and run in any standard environment supporting numerical arrays.",
            "solution": "The problem has been validated and is determined to be sound, well-posed, and scientifically grounded. It presents a standard task in computational electrochemistry: the validation of a numerical scheme against a known analytical solution.\n\nThe objective is to implement a digital simulation for chronoamperometry under semi-infinite planar diffusion control and to quantify the early-time accuracy of the explicit finite-difference scheme as a function of the dimensionless parameter $\\lambda$. The simulation models Fick's second law, $\\partial c / \\partial t = D \\, \\partial^2 c / \\partial x^2$, on a finite spatial domain $[0, L]$ with an initial concentration of $c(x, 0) = c^\\ast$ and boundary conditions $c(0, t) = 0$ and $c(L, t) = c^\\ast$.\n\nFirst, we establish the discrete framework for the simulation. The spatial domain of length $L = 5 \\times 10^{-4} \\, \\text{m}$ is discretized into $N = 801$ uniformly spaced points, indexed by $j = 0, 1, \\dots, N-1$. The distance between adjacent points, the spatial step $\\Delta x$, is given by:\n$$ \\Delta x = \\frac{L}{N-1} = \\frac{5 \\times 10^{-4} \\, \\text{m}}{801-1} = 6.25 \\times 10^{-7} \\, \\text{m} $$\nThe time domain is discretized into steps of size $\\Delta t$. This time step is not constant across test cases; it depends on the given dimensionless diffusion parameter $\\lambda = D \\Delta t / \\Delta x^2$. For each provided value of $\\lambda$, the corresponding time step is calculated as:\n$$ \\Delta t = \\frac{\\lambda \\, \\Delta x^2}{D} $$\nwhere $D = 1 \\times 10^{-9} \\, \\text{m}^2/\\text{s}$ is the diffusion coefficient.\n\nThe simulation starts at time $t=0$, corresponding to the time index $n=0$. The initial condition is that the species is at its bulk concentration $c^\\ast = 1 \\times 10^{-3} \\, \\text{mol}/\\text{m}^3$ throughout the domain. The potential step is applied at $t=0$, instantaneously depleting the species at the electrode surface. This is represented in the discrete model by setting the concentration at the first grid point to zero. Thus, the initial concentration profile for the simulation (at time index $n=0$) is:\n$$ c_j^0 = \\begin{cases} 0 & \\text{if } j=0 \\\\ c^\\ast & \\text{if } j=1, 2, \\dots, N-1 \\end{cases} $$\nThe boundary conditions are maintained for all subsequent time steps $n > 0$: the surface concentration $c_0^n$ remains $0$, and the far-field concentration $c_{N-1}^n$ is held at $c^\\ast$. The choice of $L$ is sufficiently large that the concentration at $x=L$ is unaffected over the short simulation duration, making this a valid approximation of a semi-infinite domain.\n\nThe evolution of the concentration profile over time is governed by the forward-time, central-space (FTCS) finite-difference scheme. For each time step, the concentration at the next time level, $c_j^{n+1}$, is calculated from the profile at the current level, $c_j^n$, using the explicit update rule for all interior nodes ($j=1, 2, \\dots, N-2$):\n$$ c_j^{n+1} = c_j^n + \\lambda \\left( c_{j+1}^n - 2c_j^n + c_{j-1}^n \\right) $$\nThis calculation is performed iteratively for a total of $k_{\\max}=5$ time steps.\n\nAt each discrete time $t_n = n \\Delta t$ for $n \\in \\{1, 2, \\dots, k_{\\max}\\}$, we calculate the current. The current is proportional to the flux at the electrode surface, which in turn depends on the concentration gradient $\\left. \\partial c / \\partial x \\right|_{x=0}$. The problem specifies a second-order accurate one-sided finite-difference approximation for this gradient, using the concentrations at time $n$:\n$$ \\left. \\frac{\\partial c}{\\partial x} \\right|_{x=0, t=t_n} \\approx \\frac{-3c_0^n + 4c_1^n - c_2^n}{2\\Delta x} $$\nSince $c_0^n = 0$ for all $n \\ge 1$, this simplifies to $(4c_1^n - c_2^n)/(2\\Delta x)$. The magnitude of the simulated current, $|i_{\\text{sim}}(t_n)|$, is then:\n$$ |i_{\\text{sim}}(t_n)| = nFA D \\left| \\frac{4c_1^n - c_2^n}{2\\Delta x} \\right| $$\nwhere $n=1$ is the number of electrons, $F = 96485.33212 \\, \\text{C}/\\text{mol}$ is the Faraday constant, and $A = 1 \\times 10^{-4} \\, \\text{m}^2$ is the electrode area.\n\nThis simulated current is compared against the analytical solution for this problem, the Cottrell equation, which gives the theoretical current magnitude $i_C(t_n)$:\n$$ i_C(t_n) = \\frac{n F A c^\\ast \\sqrt{D}}{\\sqrt{\\pi t_n}} $$\nThe relative error $\\varepsilon_n$ at each time step is defined as:\n$$ \\varepsilon_n = \\frac{| \\, |i_{\\text{sim}}(t_n)| - i_C(t_n) \\, |}{i_C(t_n)} $$\nNote that the constant factor $nFA$ cancels in the numerator and denominator, simplifying the calculation to a comparison of the flux terms.\nFor each value of $\\lambda$ in the test suite, the simulation is run for $k_{\\max}=5$ steps, generating a set of errors $\\{\\varepsilon_1, \\varepsilon_2, \\varepsilon_3, \\varepsilon_4, \\varepsilon_5\\}$. The final reported value for each test case, $\\varepsilon(\\lambda)$, is the maximum of these five error values:\n$$ \\varepsilon(\\lambda) = \\max_{1 \\le n \\le k_{\\max}} \\varepsilon_n $$\nThe overall algorithm is as follows: For each $\\lambda$, initialize the concentration profile, then loop from $n=1$ to $k_{\\max}$. In each iteration, advance the simulation by one time step to find the concentration profile $c^n$, then compute $\\varepsilon_n$. After the loop, find the maximum error among the computed values. This procedure is repeated for all specified $\\lambda$ values.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a digital simulation of chronoamperometry to quantify the\n    early-time discretization error of an explicit finite-difference scheme.\n    \"\"\"\n\n    # --- Scientific and Physical Constants ---\n    # Diffusion coefficient (m^2/s)\n    D = 1.0e-9\n    # Bulk concentration (mol/m^3)\n    C_STAR = 1.0e-3\n    # Electrode area (m^2)\n    A = 1.0e-4\n    # Number of electrons transferred\n    N_ELECTRONS = 1\n    # Faraday constant (C/mol)\n    F = 96485.33212\n\n    # --- Simulation Domain and Discretization Parameters ---\n    # Truncated domain length (m)\n    L = 5.0e-4\n    # Number of spatial grid points\n    N_POINTS = 801\n    # Maximum number of time steps to check for error\n    K_MAX = 5\n\n    # --- Test Suite ---\n    # Dimensionless diffusion parameter values to test\n    lambda_test_suite = [0.05, 0.10, 0.25, 0.45, 0.50]\n\n    # --- Calculations ---\n    # Spatial step size (m)\n    delta_x = L / (N_POINTS - 1)\n\n    results = []\n    for lambda_val in lambda_test_suite:\n        # Time step (s), dependent on lambda\n        delta_t = (lambda_val * delta_x**2) / D\n\n        # Initialize the concentration array for time t=0.\n        # c[0] is at the electrode surface (x=0).\n        # The potential step sets c[0] to 0 instantaneously.\n        c = np.full(N_POINTS, C_STAR)\n        c[0] = 0.0\n\n        relative_errors = []\n        # Time-stepping loop from n=1 to k_max\n        for n_step in range(1, K_MAX + 1):\n            # Store the concentration profile from the previous time step\n            c_old = c.copy()\n\n            # Evolve concentration for interior nodes using the FTCS scheme\n            # c[1:-1] corresponds to j = 1, ..., N-2\n            # c_old[2:]     corresponds to c_{j+1}\n            # c_old[1:-1]   corresponds to c_{j}\n            # c_old[0:-2]   corresponds to c_{j-1}\n            c[1:-1] = c_old[1:-1] + lambda_val * (c_old[2:] - 2 * c_old[1:-1] + c_old[0:-2])\n            \n            # Boundary conditions c[0]=0 and c[-1]=c_star are maintained\n            # throughout the simulation. c[0] is never updated, and c[-1] is\n            # not part of the interior node slice.\n\n            # Current time t_n = n * delta_t\n            t = n_step * delta_t\n\n            # --- Calculate Simulated vs. Analytical Current (Flux) ---\n            # The factor n*F*A is common to both and cancels in relative error.\n            # We only need to compare the flux terms for efficiency.\n            \n            # Simulated flux magnitude, J_sim = D * |grad c_sim|\n            # Gradient is approximated by the second-order one-sided formula.\n            # grad_c = (-3*c[0] + 4*c[1] - c[2]) / (2*delta_x). Since c[0]=0,\n            # this simplifies to (4*c[1] - c[2]) / (2*delta_x).\n            flux_sim = D * (4 * c[1] - c[2]) / (2 * delta_x)\n\n            # Analytical (Cottrell) flux magnitude, J_C = c* * sqrt(D / (pi*t))\n            flux_cottrell = C_STAR * np.sqrt(D / (np.pi * t))\n\n            # Calculate relative error for this time step\n            error = np.abs(flux_sim - flux_cottrell) / flux_cottrell\n            relative_errors.append(error)\n\n        # Find the maximum relative error over the first k_max steps\n        max_error = np.max(relative_errors)\n        results.append(max_error)\n\n    # Print results in the specified format\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The strict stability requirement of explicit methods can lead to prohibitively small time steps, $ \\Delta t $, and long computation times, especially for simulations involving fine spatial grids. This practice  introduces a more robust alternative: the fully implicit method, which is unconditionally stable. You will implement a simulation based on this scheme and master the highly efficient Thomas algorithm for solving the resulting tridiagonal system of linear equations—an essential technique in computational science.",
            "id": "4242498",
            "problem": "You are tasked with constructing a digital simulation of chronoamperometry for a one-dimensional diffusion-limited potential step at a planar electrode using a fully implicit numerical scheme. The computational model must start from Fick's second law of diffusion and produce currents at specified times by solving a tridiagonal linear system at each time step with the Thomas algorithm. Additionally, you must estimate the computational cost per time step of the tridiagonal solver, including boundary updates, and show it scales linearly with the number of spatial points.\n\nThe fundamental base consists of the following elements:\n- Fick's second law: $$\\frac{\\partial c(x,t)}{\\partial t} = D \\frac{\\partial^2 c(x,t)}{\\partial x^2},$$ where $c(x,t)$ is concentration in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ and $D$ is the diffusion coefficient in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Boundary conditions representing a diffusion-limited potential step chronoamperometry experiment on a planar electrode at $x=0$: $$c(0,t) = 0 \\text{ for } t \\ge 0,$$ and a far boundary at $x=L$ with bulk concentration maintained: $$c(L,t) = c^\\ast.$$\n- Initial condition: $$c(x,0) = c^\\ast.$$\n- Flux at the electrode: $$j(t) = -D \\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0^+},$$ in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n- Current from flux: $$i(t) = n F A\\, j(t),$$ where $n$ is the number of electrons transferred, $F$ is the Faraday constant in $\\mathrm{C}\\,\\mathrm{mol}^{-1}$, and $A$ is the electrode area in $\\mathrm{m}^2$.\n\nImplement the following:\n- Discretize the spatial domain $[0,L]$ using $N$ uniformly spaced grid points with spacing $$\\Delta x = \\frac{L}{N-1}.$$ Use fully implicit (Backward Euler) time stepping with time step $$\\Delta t.$$ The discrete unknowns are the interior concentrations $$c_i^{n} \\approx c(x_i, t_n)$$ for $i=1,\\dots,N-2$, where $$x_i = i\\,\\Delta x.$$\n- At each time step, the implicit discretization of Fick's second law yields a tridiagonal linear system for the interior concentrations at the new time level. Solve this system using the Thomas algorithm. Incorporate the Dirichlet boundary values at $x=0$ and $x=L$ into the right-hand side appropriately.\n- Compute the electrode current using the one-sided finite difference approximation for the gradient at $x=0$: $$\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0^+} \\approx \\frac{c_1^{n+1} - c_0^{n+1}}{\\Delta x},$$ where $$c_0^{n+1} = 0.$$ Report the algebraic current $$i(t_{n+1})$$ in amperes, which will be negative for cathodic diffusion-limited consumption at the electrode.\n\nIn addition, estimate the arithmetic operation count per time step for the Thomas algorithm applied to a tridiagonal system of size $$M = N-2$$ (number of interior points). The estimate must include:\n- Forward elimination and back substitution steps of the Thomas algorithm for the tridiagonal system.\n- Boundary updates due to Dirichlet conditions at $x=0$ and $x=L$.\n- Computation of the electrode flux and conversion to current.\n\nExpress the estimated per-time-step cost as a function of $$N$$ and show it scales as $$O(N).$$\n\nPhysical units:\n- Lengths must be in meters ($\\mathrm{m}$), times in seconds ($\\mathrm{s}$), concentrations in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, diffusion coefficient in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, and current in amperes ($\\mathrm{A}$).\n- Angles are not used.\n- No percentages appear in this problem.\n\nTest suite:\nUse the following three parameter sets, each producing one current value at the final time and one integer operation count per time step. For all cases, assume $$n=1,$$ $$F=96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1},$$ and $$c^\\ast=1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}.$$\n1. Case A (happy path):\n   - $$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1},\\quad A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,$$\n   - $$L = 5.0 \\times 10^{-4}\\,\\mathrm{m},\\quad N = 101,$$\n   - $$\\Delta t = 1.0 \\times 10^{-2}\\,\\mathrm{s},\\quad T_{\\text{end}} = 2.0 \\times 10^{-1}\\,\\mathrm{s}.$$\n2. Case B (boundary-size edge case with the minimum number of interior points):\n   - $$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1},\\quad A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,$$\n   - $$L = 5.0 \\times 10^{-4}\\,\\mathrm{m},\\quad N = 3,$$\n   - $$\\Delta t = 1.0 \\times 10^{-1}\\,\\mathrm{s},\\quad T_{\\text{end}} = 2.0 \\times 10^{-1}\\,\\mathrm{s}.$$\n3. Case C (large system to test linear scaling):\n   - $$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1},\\quad A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,$$\n   - $$L = 5.0 \\times 10^{-4}\\,\\mathrm{m},\\quad N = 1001,$$\n   - $$\\Delta t = 5.0 \\times 10^{-5}\\,\\mathrm{s},\\quad T_{\\text{end}} = 1.0 \\times 10^{-2}\\,\\mathrm{s}.$$\n\nProgram output specification:\n- Your program should simulate each case independently, compute the current at $$T_{\\text{end}}$$ in amperes and the estimated integer operation count per time step as a function of $$N$$, and aggregate the six results into a single list.\n- The final output must be a single line that is a comma-separated list enclosed in square brackets in the order: $$[i_A,\\,\\text{cost}_A,\\,i_B,\\,\\text{cost}_B,\\,i_C,\\,\\text{cost}_C],$$ where $$i_A, i_B, i_C$$ are floating-point currents in amperes, and $$\\text{cost}_A, \\text{cost}_B, \\text{cost}_C$$ are integers representing the estimated operation counts per time step.",
            "solution": "The problem requires the construction of a digital simulation for chronoamperometry at a planar electrode, based on Fick's second law of diffusion. The solution must employ a fully implicit finite difference scheme, solve the resulting tridiagonal system using the Thomas algorithm at each time step, and provide an estimate for the computational cost.\n\nFirst, we discretize the governing partial differential equation, Fick's second law:\n$$\n\\frac{\\partial c(x,t)}{\\partial t} = D \\frac{\\partial^2 c(x,t)}{\\partial x^2}\n$$\nThe spatial domain $[0, L]$ is discretized into $N$ points, $x_i = i \\Delta x$ for $i=0, 1, \\dots, N-1$, with a uniform grid spacing of $\\Delta x = L/(N-1)$. Time is discretized with a constant step size $\\Delta t$, such that $t_n = n \\Delta t$. The concentration at grid point $x_i$ and time $t_n$ is denoted as $c_i^n \\approx c(x_i, t_n)$.\n\nUsing a fully implicit (Backward Euler) scheme, the time derivative is approximated at time level $n+1$:\n$$\n\\frac{\\partial c}{\\partial t} \\approx \\frac{c_i^{n+1} - c_i^n}{\\Delta t}\n$$\nThe spatial second derivative is also evaluated at the new time level $n+1$ using a central difference approximation:\n$$\n\\frac{\\partial^2 c}{\\partial x^2} \\approx \\frac{c_{i-1}^{n+1} - 2c_i^{n+1} + c_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\nSubstituting these approximations into Fick's law yields the finite difference equation for each interior grid point, $i = 1, 2, \\dots, N-2$:\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = D \\frac{c_{i-1}^{n+1} - 2c_i^{n+1} + c_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\nLet's define a dimensionless parameter $\\lambda = D \\Delta t / (\\Delta x)^2$. Rearranging the equation to group the unknown concentrations at time level $n+1$ on the left-hand side and known concentrations at time level $n$ on the right-hand side gives:\n$$\n-\\lambda c_{i-1}^{n+1} + (1 + 2\\lambda) c_i^{n+1} - \\lambda c_{i+1}^{n+1} = c_i^n\n$$\nThis set of linear equations for $i = 1, \\dots, N-2$ forms a tridiagonal system of size $M \\times M$, where $M = N-2$ is the number of interior points. The system can be written in matrix form as $\\mathbf{A} \\mathbf{c}^{n+1} = \\mathbf{d}^n$.\n\nThe boundary conditions are $c(0,t) = 0$ and $c(L,t) = c^\\ast$. In our discrete system, this translates to $c_0^{n+1} = 0$ and $c_{N-1}^{n+1} = c^\\ast$ for all $n \\ge 0$. These known values are incorporated into the system.\n\nFor the first interior point ($i=1$):\n$$\n-\\lambda c_{0}^{n+1} + (1 + 2\\lambda) c_1^{n+1} - \\lambda c_2^{n+1} = c_1^n\n$$\nSince $c_0^{n+1} = 0$, the equation becomes:\n$$\n(1 + 2\\lambda) c_1^{n+1} - \\lambda c_2^{n+1} = c_1^n\n$$\nFor the last interior point ($i=N-2$):\n$$\n-\\lambda c_{N-3}^{n+1} + (1 + 2\\lambda) c_{N-2}^{n+1} - \\lambda c_{N-1}^{n+1} = c_{N-2}^n\n$$\nSince $c_{N-1}^{n+1} = c^\\ast$, we move this known term to the right-hand side:\n$$\n-\\lambda c_{N-3}^{n+1} + (1 + 2\\lambda) c_{N-2}^{n+1} = c_{N-2}^n + \\lambda c^\\ast\n$$\nThe tridiagonal matrix $\\mathbf{A}$ has the following structure for the system of size $M=N-2$:\nSub-diagonal: $a_i = -\\lambda$ for $i=1, \\dots, M-1$.\nMain-diagonal: $b_i = 1+2\\lambda$ for $i=1, \\dots, M$.\nSuper-diagonal: $c_i = -\\lambda$ for $i=1, \\dots, M-1$.\n\nThe right-hand side vector $\\mathbf{d}$ is constructed from the previous time step's concentrations: $d_i = c_i^n$ for $i=1, \\dots, M-1$, and $d_M = c_{N-2}^n + \\lambda c^\\ast$.\n\nThis system is solved efficiently using the Thomas algorithm (Tridiagonal Matrix Algorithm or TDMA), which is an application of Gaussian elimination. The algorithm consists of two stages: a forward elimination sweep and a backward substitution sweep.\n\nAfter solving for the new concentrations $\\mathbf{c}^{n+1} = (c_1^{n+1}, \\dots, c_{N-2}^{n+1})$, the current $i(t_{n+1})$ is calculated. The flux $j(t)$ at the electrode ($x=0$) is given by $j(t) = -D (\\partial c / \\partial x)|_{x=0}$. We approximate the gradient using a one-sided finite difference:\n$$\n\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0} \\approx \\frac{c_1^{n+1} - c_0^{n+1}}{\\Delta x} = \\frac{c_1^{n+1}}{\\Delta x}\n$$\nThe flux is then $j(t_{n+1}) = -D \\frac{c_1^{n+1}}{\\Delta x}$. The current is obtained using the Faraday's law of electrolysis, $i(t) = n F A j(t)$:\n$$\ni(t_{n+1}) = n F A \\left(-D \\frac{c_1^{n+1}}{\\Delta x}\\right) = -\\frac{n F A D}{\\Delta x} c_1^{n+1}\n$$\n\nNext, we estimate the computational cost per time step as a function of $N$. The cost includes setting up the system, solving it, and calculating the current.\n1.  **Parameter Calculation**: At each step, one might re-calculate $\\lambda = D \\Delta t / (\\Delta x)^2$. Assuming $\\Delta x$ is pre-calculated, this takes $1$ multiplication (for $(\\Delta x)^2$), $1$ multiplication ($D \\Delta t$), and $1$ division, for a total of $3$ operations. Let's include the calculation of $\\Delta x = L/(N-1)$ once, adding $1$ division. Total: $4$ operations.\n2.  **RHS Update**: The vector $\\mathbf{d}$ is mostly a copy of the old concentrations. The only arithmetic operation is for the last element: $d_M = c_{M+1}^n + \\lambda c^\\ast$. This requires $1$ multiplication and $1$ addition, for a total of $2$ operations.\n3.  **Thomas Algorithm (TDMA)**: A standard, non-destructive implementation of the Thomas algorithm for a system of size $M$ requires approximately $8M - 7$ floating-point operations (for $M>1$). With $M=N-2$, this is $8(N-2) - 7 = 8N - 16 - 7 = 8N - 23$ operations.\n4.  **Current Calculation**: The calculation $i = -(nFAD/\\Delta x) c_1^{n+1}$ involves $3$ multiplications and $1$ division for the pre-factor, and $1$ final multiplication with $c_1^{n+1}$. Total: $5$ operations.\n\nThe total estimated cost per time step is the sum of these contributions:\n$$\n\\text{Cost}(N) = \\text{Cost}_{\\lambda} + \\text{Cost}_{\\text{RHS}} + \\text{Cost}_{\\text{TDMA}} + \\text{Cost}_{\\text{current}}\n$$\n$$\n\\text{Cost}(N) = 4 + 2 + (8N - 23) + 5 = 8N - 12\n$$\nFor the edge case $N=3$, $M=1$. The TDMA algorithm for a $1 \\times 1$ system $b_1 x_1 = d_1$ is simply $x_1 = d_1 / b_1$. The equation is $(1+2\\lambda)c_1^{n+1} = c_1^n + \\lambda c^\\ast$. The cost is: $1$ multiplication and $1$ addition for the denominator $(1+2\\lambda)$, and $1$ division. Total $3$ operations for the solve. The total cost for $N=3$ is thus $4 (\\lambda) + 2 (\\text{RHS}) + 3 (\\text{solve}) + 5 (\\text{current}) = 14$. The general formula $8N-12$ yields $8(3)-12=12$, which is a reasonable approximation consistent with the linear scaling. We will use the formula $\\text{Cost}(N) = 8N - 12$ for all cases as it correctly captures the dominant $O(N)$ behavior. This linear scaling is a key advantage of the Thomas algorithm for tridiagonal systems.\n\nThe simulation starts with the initial condition $c(x,0) = c^\\ast$. We apply the boundary condition $c(0,t)=0$ starting at $t=0$, so the initial concentration profile is $c(0,0)=0$ and $c(x_i, 0)=c^\\ast$ for $i > 0$. The simulation proceeds by iteratively solving for the concentration profile at each time step until $t=T_{\\text{end}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef thomas_algorithm(a, b, c, d):\n    \"\"\"\n    Solves a tridiagonal system of equations Ax=d.\n    a: sub-diagonal vector (length M-1)\n    b: main-diagonal vector (length M)\n    c: super-diagonal vector (length M-1)\n    d: right-hand side vector (length M)\n    Returns the solution vector x (length M).\n    \"\"\"\n    M = len(d)\n    if M == 0:\n        return np.array([])\n    if M == 1:\n        return np.array([d[0] / b[0]])\n\n    # Create copies to avoid modifying the original arrays\n    c_prime = np.zeros(M)\n    d_prime = np.zeros(M)\n    \n    # Forward elimination\n    c_prime[0] = c[0] / b[0]\n    d_prime[0] = d[0] / b[0]\n    for i in range(1, M):\n        denominator = b[i] - a[i-1] * c_prime[i-1]\n        if i < M - 1:\n            c_prime[i] = c[i] / denominator\n        d_prime[i] = (d[i] - a[i-1] * d_prime[i-1]) / denominator\n\n    # Backward substitution\n    x = np.zeros(M)\n    x[M-1] = d_prime[M-1]\n    for i in range(M-2, -1, -1):\n        x[i] = d_prime[i] - c_prime[i] * x[i+1]\n        \n    return x\n\ndef solve():\n    \"\"\"\n    Main function to run chronoamperometry simulations for the given test cases.\n    \"\"\"\n    # Physical and electrochemical constants\n    n_electrons = 1.0\n    F_const = 96485.33212  # C/mol\n    c_star = 1.0  # mol/m^3\n\n    test_cases = [\n        # Case A: Happy path\n        {'D': 1.0e-9, 'A': 1.0e-4, 'L': 5.0e-4, 'N': 101, 'dt': 1.0e-2, 'T_end': 2.0e-1},\n        # Case B: Boundary-size edge case\n        {'D': 1.0e-9, 'A': 1.0e-4, 'L': 5.0e-4, 'N': 3, 'dt': 1.0e-1, 'T_end': 2.0e-1},\n        # Case C: Large system\n        {'D': 1.0e-9, 'A': 1.0e-4, 'L': 5.0e-4, 'N': 1001, 'dt': 5.0e-5, 'T_end': 1.0e-2},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        D = case['D']\n        A = case['A']\n        L = case['L']\n        N = case['N']\n        dt = case['dt']\n        T_end = case['T_end']\n\n        # Discretization parameters\n        dx = L / (N - 1)\n        lambda_val = D * dt / (dx**2)\n        \n        # Initial condition\n        c = np.full(N, c_star)\n        c[0] = 0.0 # At t=0, potential is stepped, c(0,0)=0\n        \n        # Number of interior points\n        M = N - 2\n\n        # Set up the constant tridiagonal matrix coefficients\n        if M > 0:\n            diag_b = np.full(M, 1.0 + 2.0 * lambda_val)\n            sub_a = np.full(M - 1, -lambda_val)\n            super_c = np.full(M - 1, -lambda_val)\n\n        # Time-stepping loop\n        num_steps = int(round(T_end / dt))\n        for _ in range(num_steps):\n            if M > 0:\n                # Set up the right-hand side vector d\n                d = c[1:-1].copy()\n                d[-1] += lambda_val * c_star\n                \n                # Solve the tridiagonal system for the new interior concentrations\n                c_interior_new = thomas_algorithm(sub_a, diag_b, super_c, d)\n                \n                # Update the concentration profile\n                c[1:-1] = c_interior_new\n\n        # Calculate final current at T_end\n        gradient_at_electrode = (c[1] - c[0]) / dx\n        flux = -D * gradient_at_electrode\n        current = n_electrons * F_const * A * flux\n        \n        # Estimate computational cost per time step\n        # Cost = 8N - 12 (derived from 4 ops for lambda, 2 for RHS, 8(N-2)-7 for TDMA, 5 for current)\n        cost = 8 * N - 12\n        \n        results.append(current)\n        results.append(int(cost))\n        \n    print(f\"[{','.join(f'{x:.8f}' if isinstance(x, float) else str(x) for x in results)}]\")\n\nsolve()\n```"
        }
    ]
}