{
    "hands_on_practices": [
        {
            "introduction": "This practice bridges the gap between theoretical equilibrium potentials and real-world potentiometric measurements. You will diagnose and correct for a common experimental artifact—the ohmic potential drop or $IR$ drop—that arises from uncompensated solution resistance. By applying the current-interruption technique, this exercise demonstrates how to recover the true thermodynamic potential from a perturbed measurement, a crucial skill for any experimental or computational electrochemist comparing theory with experiment .",
            "id": "4244806",
            "problem": "A planar working electrode interrogates the redox couple $\\mathrm{Fe(CN)}_6^{3-}/\\mathrm{Fe(CN)}_6^{4-}$ in aqueous solution at temperature $T=298.15\\,\\mathrm{K}$. The activities of the oxidized and reduced species are $a_{\\mathrm{ox}}=2.0\\times 10^{-3}$ and $a_{\\mathrm{red}}=1.0\\times 10^{-2}$, respectively. The standard potential of this one-electron couple is $E^\\circ=0.361\\,\\mathrm{V}$ versus the Standard Hydrogen Electrode (SHE). The reference electrode is Silver/Silver Chloride (Ag/AgCl) in saturated $\\mathrm{KCl}$ with reference potential $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}=+0.197\\,\\mathrm{V}$ versus SHE at $T=298.15\\,\\mathrm{K}$. The measured potentiometric signal under steady conditions is $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}=0.124\\,\\mathrm{V}$ versus Ag/AgCl. The measurement electronics draw a small bias current $I_b=8\\,\\mu\\mathrm{A}$ through the electrolyte path between working and reference electrodes. Electrochemical Impedance Spectroscopy (EIS) indicates an uncompensated solution resistance $R_u$ between the working and reference electrodes. A current-interruption experiment is performed: immediately before interruption, a constant current $I=50\\,\\mu\\mathrm{A}$ is passed; at $t=0$ the current is interrupted and the working electrode potential drops instantaneously by $\\Delta E_0=6.0\\,\\mathrm{mV}$, then decays exponentially with time constant governed by the double-layer capacitance $C_{\\mathrm{dl}}=100\\,\\mu\\mathrm{F}$.\n\nUsing only fundamental thermodynamic definitions of chemical and electrochemical potential and charge conservation, determine the equilibrium potential predicted from activities, and evaluate how uncompensated resistance biases the potentiometric measurement. Then select the statement that both (i) correctly describes how to use current interruption to estimate and remove the current times resistance ($IR$) drop to recover the equilibrium potential, and (ii) reports the corrected equilibrium potential versus SHE for the given data. Choose one option.\n\nA. The uncompensated resistance adds an ohmic term $+I R_u$ to the measured potential when nonzero current flows. In current interruption, extrapolation of the instantaneous jump at $t\\to 0^+$ gives $\\Delta E_0=I R_u$, which should be scaled to the actual bias current and subtracted from $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$; conversion to SHE adds $+E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$. With $R_u=\\Delta E_0/I=6.0\\,\\mathrm{mV}/50\\,\\mu\\mathrm{A}=120\\,\\Omega$ and $I_b R_u=0.96\\,\\mathrm{mV}$, the corrected equilibrium potential is $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}-0.00096\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.32004\\,\\mathrm{V}$, consistent with the thermodynamic prediction $E^\\circ+(RT/F)\\ln(a_{\\mathrm{ox}}/a_{\\mathrm{red}})\\approx 0.3197\\,\\mathrm{V}$.\n\nB. The uncompensated resistance is best estimated from the full interrupted drop including the capacitive tail at $t\\to\\infty$, and that total drop should be subtracted directly from the measured potential. Using the interrupted current $I=50\\,\\mu\\mathrm{A}$, subtract $6.0\\,\\mathrm{mV}$ from $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ and then add $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$, yielding $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}-0.0060\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.3150\\,\\mathrm{V}$.\n\nC. The uncompensated resistance causes an underestimation of the true potential, so the $IR$ term should be added to $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ before conversion to SHE. With $I_b R_u=0.96\\,\\mathrm{mV}$, $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}+0.00096\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.3220\\,\\mathrm{V}$.\n\nD. The reference conversion requires subtracting the Ag/AgCl offset from the measured value to obtain the SHE-referenced potential; the ohmic term is negligible. Thus $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx 0.124\\,\\mathrm{V}-0.197\\,\\mathrm{V}=-0.073\\,\\mathrm{V}$.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe explicit data and conditions provided in the problem statement are:\n- Redox couple: $\\mathrm{Fe(CN)}_6^{3-}/\\mathrm{Fe(CN)}_6^{4-}$\n- Number of electrons transferred: $n=1$\n- Temperature: $T=298.15\\,\\mathrm{K}$\n- Activity of oxidized species: $a_{\\mathrm{ox}}=2.0\\times 10^{-3}$\n- Activity of reduced species: $a_{\\mathrm{red}}=1.0\\times 10^{-2}$\n- Standard potential vs. SHE: $E^\\circ=0.361\\,\\mathrm{V}$\n- Reference electrode: Silver/Silver Chloride (Ag/AgCl) in saturated $\\mathrm{KCl}$\n- Reference potential vs. SHE: $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}=+0.197\\,\\mathrm{V}$ at $T=298.15\\,\\mathrm{K}$\n- Measured potential vs. Ag/AgCl: $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}=0.124\\,\\mathrm{V}$\n- Measurement bias current: $I_b=8\\,\\mu\\mathrm{A} = 8 \\times 10^{-6}\\,\\mathrm{A}$\n- Current for interruption experiment: $I=50\\,\\mu\\mathrm{A} = 50 \\times 10^{-6}\\,\\mathrm{A}$\n- Instantaneous potential drop upon current interruption: $\\Delta E_0=6.0\\,\\mathrm{mV} = 6.0 \\times 10^{-3}\\,\\mathrm{V}$\n- Double-layer capacitance: $C_{\\mathrm{dl}}=100\\,\\mu\\mathrm{F}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria:\n- **Scientifically Grounded**: The problem is built upon fundamental principles of electrochemistry, including the Nernst equation for equilibrium potential, the concept of a reference electrode, ohmic potential drop ($IR$ drop), and the current-interruption technique for measuring uncompensated resistance. The chemical system ($\\mathrm{Fe(CN)}_6^{3-}/\\mathrm{Fe(CN)}_6^{4-}$) is a standard, well-behaved redox couple used in electrochemical studies. All values are physically realistic.\n- **Well-Posed**: The problem is well-posed. It provides sufficient information to calculate a theoretical equilibrium potential, determine the uncompensated resistance from experimental data, correct the measured potential for ohmic artifacts, and compare the result to the theoretical value. The question is specific and leads to a unique answer.\n- **Objective**: The problem is stated in precise, quantitative, and objective language, free from ambiguity or subjective interpretation.\n- **Completeness and Consistency**: The provided data are self-consistent and sufficient for a complete analysis. For instance, the data for the current-interruption experiment ($I$ and $\\Delta E_0$) allow for the calculation of $R_u$, which is then used with the bias current $I_b$ to correct the measured potential $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$. The inclusion of $C_{\\mathrm{dl}}$ correctly contextualizes the post-interruption potential decay, even though its value is not required for the core calculation, thereby enhancing the physical realism of the setup. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is scientifically sound, well-posed, and internally consistent. The solution process may proceed.\n\n### Derivation of the Correct Answer\n\nThe solution involves three main steps:\n1.  Calculate the theoretical equilibrium potential ($E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}}$) from the given activities using the Nernst equation.\n2.  Determine the uncompensated resistance ($R_u$) from the current-interruption experiment and use it to calculate the ohmic potential drop ($I_b R_u$) that perturbs the potentiometric measurement.\n3.  Correct the measured potential ($E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$) by removing the ohmic drop and then convert the result to the SHE scale to obtain the experimentally-derived equilibrium potential ($E_{\\mathrm{eq, exp}}^{\\mathrm{SHE}}$).\n\n**Step 1: Theoretical Equilibrium Potential (Nernst Equation)**\nThe Nernst equation for this one-electron ($n=1$) reaction is:\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} = E^\\circ + \\frac{RT}{nF} \\ln\\left(\\frac{a_{\\mathrm{ox}}}{a_{\\mathrm{red}}}\\right) $$\nUsing the provided values:\n- $E^\\circ = 0.361\\,\\mathrm{V}$\n- $R = 8.31446\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $T = 298.15\\,\\mathrm{K}$\n- $n = 1$\n- $F = 96485.33\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- $a_{\\mathrm{ox}} = 2.0 \\times 10^{-3}$\n- $a_{\\mathrm{red}} = 1.0 \\times 10^{-2}$\n\nThe thermal voltage term is $\\frac{RT}{F} \\approx \\frac{(8.31446)(298.15)}{96485.33} \\approx 0.025693\\,\\mathrm{V}$.\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} = 0.361\\,\\mathrm{V} + \\frac{0.025693\\,\\mathrm{V}}{1} \\ln\\left(\\frac{2.0 \\times 10^{-3}}{1.0 \\times 10^{-2}}\\right) $$\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} = 0.361\\,\\mathrm{V} + 0.025693\\,\\mathrm{V} \\times \\ln(0.2) $$\nSince $\\ln(0.2) \\approx -1.609438$:\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} \\approx 0.361\\,\\mathrm{V} + 0.025693\\,\\mathrm{V} \\times (-1.609438) \\approx 0.361\\,\\mathrm{V} - 0.041355\\,\\mathrm{V} $$\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} \\approx 0.319645\\,\\mathrm{V} $$\n\n**Step 2: Uncompensated Resistance and Ohmic Drop**\nThe current-interruption technique measures the instantaneous potential drop, $\\Delta E_0$, which is purely due to the ohmic drop across the uncompensated resistance, $R_u$.\n$$ \\Delta E_0 = I R_u $$\nwhere $I$ is the current applied just before interruption.\n$$ R_u = \\frac{\\Delta E_0}{I} = \\frac{6.0 \\times 10^{-3}\\,\\mathrm{V}}{50 \\times 10^{-6}\\,\\mathrm{A}} = 120\\,\\Omega $$\nThe potentiometric measurement is perturbed by an ohmic drop caused by the bias current, $I_b$, not the larger current $I$. The magnitude of this ohmic drop is:\n$$ V_{\\mathrm{ohmic}} = I_b R_u = (8 \\times 10^{-6}\\,\\mathrm{A}) \\times (120\\,\\Omega) = 960 \\times 10^{-6}\\,\\mathrm{V} = 0.96\\,\\mathrm{mV} $$\n\n**Step 3: Correction of Measured Potential**\nThe measured potential, $E_{\\mathrm{meas}}$, includes the true interfacial potential, $E_{\\mathrm{eq}}$, and the ohmic drop. Assuming a positive (anodic) bias current, the measured potential is higher than the true potential:\n$$ E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}} = E_{\\mathrm{eq}}^{\\mathrm{Ag/AgCl}} + I_b R_u $$\nTo find the true equilibrium potential relative to the reference electrode, we must subtract this ohmic artifact:\n$$ E_{\\mathrm{eq}}^{\\mathrm{Ag/AgCl}} = E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}} - I_b R_u = 0.124\\,\\mathrm{V} - 0.00096\\,\\mathrm{V} = 0.12304\\,\\mathrm{V} $$\nFinally, to convert this potential to the SHE scale, we add the potential of the reference electrode relative to SHE:\n$$ E_{\\mathrm{eq, exp}}^{\\mathrm{SHE}} = E_{\\mathrm{eq}}^{\\mathrm{Ag/AgCl}} + E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}} = 0.12304\\,\\mathrm{V} + 0.197\\,\\mathrm{V} = 0.32004\\,\\mathrm{V} $$\nThis experimentally derived value ($0.32004\\,\\mathrm{V}$) shows excellent agreement with the theoretical Nernst potential ($0.319645\\,\\mathrm{V}$).\n\n### Evaluation of Options\n\n**A. The uncompensated resistance adds an ohmic term $+I R_u$ to the measured potential when nonzero current flows. In current interruption, extrapolation of the instantaneous jump at $t\\to 0^+$ gives $\\Delta E_0=I R_u$, which should be scaled to the actual bias current and subtracted from $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$; conversion to SHE adds $+E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$. With $R_u=\\Delta E_0/I=6.0\\,\\mathrm{mV}/50\\,\\mu\\mathrm{A}=120\\,\\Omega$ and $I_b R_u=0.96\\,\\mathrm{mV}$, the corrected equilibrium potential is $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}-0.00096\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.32004\\,\\mathrm{V}$, consistent with the thermodynamic prediction $E^\\circ+(RT/F)\\ln(a_{\\mathrm{ox}}/a_{\\mathrm{red}})\\approx 0.3197\\,\\mathrm{V}$.**\nThis statement correctly identifies that the instantaneous jump in a current-interruption experiment yields $R_u$. It correctly states that the ohmic correction must use the bias current $I_b$, not the interruption current $I$. It correctly applies the correction by subtracting the $I_b R_u$ term from the measured potential. It correctly performs the reference electrode conversion by adding $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$. All calculations, including $R_u$, $I_b R_u$, the corrected potential $E_{\\mathrm{eq, exp}}^{\\mathrm{SHE}}$, and the theoretical Nernst potential $E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}}$, are accurate and match our derivation.\nVerdict: **Correct**.\n\n**B. The uncompensated resistance is best estimated from the full interrupted drop including the capacitive tail at $t\\to\\infty$, and that total drop should be subtracted directly from the measured potential. Using the interrupted current $I=50\\,\\mu\\mathrm{A}$, subtract $6.0\\,\\mathrm{mV}$ from $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ and then add $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$, yielding $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}-0.0060\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.3150\\,\\mathrm{V}$.**\nThis statement is incorrect for two primary reasons. First, it misinterprets the current-interruption experiment; only the instantaneous drop at $t=0$ corresponds to $I R_u$. Including the capacitive tail is physically incorrect. Second, it incorrectly applies a correction based on the interruption current ($I=50\\,\\mu\\mathrm{A}$), resulting in an ohmic drop of $6.0\\,\\mathrm{mV}$, instead of using the bias current ($I_b=8\\,\\mu\\mathrm{A}$) that was present during the actual measurement.\nVerdict: **Incorrect**.\n\n**C. The uncompensated resistance causes an underestimation of the true potential, so the $IR$ term should be added to $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ before conversion to SHE. With $I_b R_u=0.96\\,\\mathrm{mV}$, $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}+0.00096\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.3220\\,\\mathrm{V}$.**\nThis statement applies the incorrect sign for the ohmic correction. For an anodic bias current, the measured potential is artificially high, so the $I_b R_u$ term must be subtracted, not added. Adding the term results in a potential ($0.3220\\,\\mathrm{V}$) that is further from the theoretical Nernst potential than the result from subtraction.\nVerdict: **Incorrect**.\n\n**D. The reference conversion requires subtracting the Ag/AgCl offset from the measured value to obtain the SHE-referenced potential; the ohmic term is negligible. Thus $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx 0.124\\,\\mathrm{V}-0.197\\,\\mathrm{V}=-0.073\\,\\mathrm{V}$.**\nThis statement contains two errors. First, to convert a potential measured vs. Ag/AgCl to the SHE scale, the potential of the Ag/AgCl reference electrode vs. SHE must be added, not subtracted ($E^{\\mathrm{SHE}} = E^{\\mathrm{Ag/AgCl}} + E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$). Second, it incorrectly dismisses the ohmic term as negligible. While small ($0.96\\,\\mathrm{mV}$), accounting for it is crucial for a precise comparison with the thermodynamic value, as demonstrated by the excellent agreement achieved in the correct analysis.\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving from experimental correction to computational prediction, this exercise tackles a fundamental challenge in molecular simulation: finite-size effects. You will implement a standard extrapolation procedure to determine thermodynamic-limit excess chemical potentials from a series of simulations performed in finite periodic boxes. This practice is essential for calculating accurate redox potentials from first-principles or classical simulations, forming a critical link between microscopic models and macroscopic electrochemical observables .",
            "id": "4244818",
            "problem": "You are tasked with designing a program that models finite-size effects in molecular simulations of redox species under periodic boundary conditions and extrapolates an equilibrium electrode potential to the thermodynamic limit using a principled methodology rooted in fundamental definitions. The scenario concerns the computation of excess chemical potentials for an oxidized species and a reduced species from molecular simulations at several cubic box lengths. Finite-size effects arise from long-range electrostatics and suppressed concentration fluctuations in finite boxes, which bias computed chemical potentials away from their thermodynamic-limit values.\n\nUse the following foundational bases:\n- The chemical potential of species $i$, denoted $\\mu_i$, is defined as the partial derivative of the Gibbs free energy with respect to the number of particles of species $i$ at constant temperature $T$, pressure $P$, and the numbers of all other species, i.e. $\\mu_i = \\left(\\partial G / \\partial N_i\\right)_{T,P,\\{N_{j \\neq i}\\}}$.\n- For an electrode half-reaction of the form $\\text{Ox} + n\\,e^- \\rightarrow \\text{Red}$, the equilibrium potential $E$ of the working electrode relative to a reference is governed by the Nernst relation, which connects the reaction free energy and activities: the potential of the working electrode is\n$$\nE_{\\text{work}} = -\\frac{\\Delta \\mu_{\\text{excess}}}{n F} + \\frac{R T}{n F} \\ln\\!\\left(\\frac{a_{\\text{Ox}}}{a_{\\text{Red}}}\\right),\n$$\nwhere $n$ is the number of electrons transferred, $F$ is the Faraday constant, $R$ is the ideal gas constant, $T$ is the absolute temperature, $a_{\\text{Ox}}$ and $a_{\\text{Red}}$ are activities of the oxidized and reduced species, respectively, and $\\Delta \\mu_{\\text{excess}} = \\mu_{\\text{Red}}^{\\infty} - \\mu_{\\text{Ox}}^{\\infty}$ is the difference of excess chemical potentials in the thermodynamic limit (excluding ideal mixing contributions).\n- Finite-size corrections to excess chemical potentials in cubic periodic boundary conditions (PBC) commonly exhibit leading-order terms that scale with inverse box length and higher-order inverse powers due to long-range interactions and suppressed fluctuations. A parsimonious and physically motivated regression model is\n$$\n\\mu_i(L) = \\mu_i^{\\infty} + \\frac{\\alpha_i}{L} + \\frac{\\beta_i}{L^3},\n$$\nwhere $L$ is the cubic box length, $\\mu_i^{\\infty}$ is the thermodynamic-limit excess chemical potential for species $i$, and $\\alpha_i$ and $\\beta_i$ are system-dependent coefficients capturing leading and sub-leading finite-size corrections.\n\nYour program must:\n1. For each test case, receive (embedded in the program) a set of box lengths $L$ and corresponding simulated excess chemical potentials $\\mu_{\\text{Ox}}(L)$ and $\\mu_{\\text{Red}}(L)$ in joules per mole. Fit the model above using linear least squares to estimate $\\mu_{\\text{Ox}}^{\\infty}$ and $\\mu_{\\text{Red}}^{\\infty}$ for the given data.\n2. Using the fitted $\\mu_{\\text{Ox}}^{\\infty}$ and $\\mu_{\\text{Red}}^{\\infty}$, compute the working electrode equilibrium potential via the Nernst relation:\n$$\nE_{\\text{work}} = -\\frac{\\mu_{\\text{Red}}^{\\infty} - \\mu_{\\text{Ox}}^{\\infty}}{n F} + \\frac{R T}{n F} \\ln\\!\\left(\\frac{a_{\\text{Ox}}}{a_{\\text{Red}}}\\right).\n$$\n3. Report the cell potential relative to a specified reference electrode as\n$$\nE_{\\text{cell}} = E_{\\text{work}} - E_{\\text{ref}},\n$$\nwhere $E_{\\text{ref}}$ is the reference electrode potential. Express each final result in volts ($\\mathrm{V}$), rounded to six decimals.\n\nConstants to use:\n- Ideal gas constant $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$,\n- Faraday constant $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$.\n\nTest suite:\nProvide three test cases that exercise different aspects of the methodology.\n\n- Test case $1$ (general case with several box sizes and nontrivial activity ratio):\n  - $L$ values in nanometers: $[2.0, 2.5, 3.0, 4.0]$.\n  - $\\mu_{\\text{Ox}}(L)$ in $\\mathrm{J\\,mol^{-1}}$: generated by $\\mu_{\\text{Ox}}^{\\infty} = 5000$, $\\alpha_{\\text{Ox}} = 2000$, $\\beta_{\\text{Ox}} = -100000$ as $\\mu_{\\text{Ox}}(L) = 5000 + 2000/L - 100000/L^3$.\n  - $\\mu_{\\text{Red}}(L)$ in $\\mathrm{J\\,mol^{-1}}$: generated by $\\mu_{\\text{Red}}^{\\infty} = -5000$, $\\alpha_{\\text{Red}} = -2500$, $\\beta_{\\text{Red}} = 50000$ as $\\mu_{\\text{Red}}(L) = -5000 - 2500/L + 50000/L^3$.\n  - $n = 1$, $T = 298.15\\ \\mathrm{K}$, $a_{\\text{Ox}} = 0.01$, $a_{\\text{Red}} = 1.0$, $E_{\\text{ref}} = 0.20\\ \\mathrm{V}$.\n\n- Test case $2$ (boundary case with zero activity term and $n = 2$):\n  - $L$ values in nanometers: $[3.0, 4.0, 5.0, 6.0]$.\n  - $\\mu_{\\text{Ox}}(L)$ in $\\mathrm{J\\,mol^{-1}}$: generated by $\\mu_{\\text{Ox}}^{\\infty} = 8000$, $\\alpha_{\\text{Ox}} = 1500$, $\\beta_{\\text{Ox}} = 0$ as $\\mu_{\\text{Ox}}(L) = 8000 + 1500/L$.\n  - $\\mu_{\\text{Red}}(L)$ in $\\mathrm{J\\,mol^{-1}}$: generated by $\\mu_{\\text{Red}}^{\\infty} = 0$, $\\alpha_{\\text{Red}} = -500$, $\\beta_{\\text{Red}} = 0$ as $\\mu_{\\text{Red}}(L) = 0 - 500/L$.\n  - $n = 2$, $T = 298.15\\ \\mathrm{K}$, $a_{\\text{Ox}} = 1.0$, $a_{\\text{Red}} = 1.0$, $E_{\\text{ref}} = 0.0\\ \\mathrm{V}$.\n\n- Test case $3$ (edge case with minimal points and mixed correction orders at elevated temperature):\n  - $L$ values in nanometers: $[2.5, 3.5, 5.0]$.\n  - $\\mu_{\\text{Ox}}(L)$ in $\\mathrm{J\\,mol^{-1}}$: generated by $\\mu_{\\text{Ox}}^{\\infty} = -2000$, $\\alpha_{\\text{Ox}} = 0$, $\\beta_{\\text{Ox}} = 40000$ as $\\mu_{\\text{Ox}}(L) = -2000 + 0/L + 40000/L^3$.\n  - $\\mu_{\\text{Red}}(L)$ in $\\mathrm{J\\,mol^{-1}}$: generated by $\\mu_{\\text{Red}}^{\\infty} = -1000$, $\\alpha_{\\text{Red}} = 1000$, $\\beta_{\\text{Red}} = -30000$ as $\\mu_{\\text{Red}}(L) = -1000 + 1000/L - 30000/L^3$.\n  - $n = 1$, $T = 350.0\\ \\mathrm{K}$, $a_{\\text{Ox}} = 0.1$, $a_{\\text{Red}} = 0.9$, $E_{\\text{ref}} = 0.10\\ \\mathrm{V}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and rounded to six decimals, for example: $[r_1,r_2,r_3]$, where each $r_i$ is the computed $E_{\\text{cell}}$ in volts corresponding to the $i$-th test case.",
            "solution": "The problem is valid. It presents a well-defined computational task based on established principles of physical chemistry and computational science. The problem is scientifically grounded in the Nernst equation and models of finite-size effects in molecular simulations. It is well-posed, providing all necessary data, constants, and equations to arrive at a unique, verifiable solution. The language is objective and unambiguous.\n\nThe methodology to solve this problem consists of two primary steps for each test case: first, extrapolating the simulated excess chemical potentials to the thermodynamic limit ($L \\to \\infty$) using linear regression, and second, using these extrapolated values to calculate the final cell potential.\n\n**Step 1: Finite-Size Extrapolation via Linear Least Squares**\n\nThe problem provides a physically motivated model for the dependence of the excess chemical potential $\\mu_i$ of a species $i$ on the cubic box length $L$:\n$$\n\\mu_i(L) = \\mu_i^{\\infty} + \\frac{\\alpha_i}{L} + \\frac{\\beta_i}{L^3}\n$$\nHere, $\\mu_i^{\\infty}$, $\\alpha_i$, and $\\beta_i$ are unknown coefficients. The goal is to determine $\\mu_i^{\\infty}$, the excess chemical potential in the thermodynamic limit. This equation represents a linear model with respect to the coefficients.\n\nGiven a set of $m$ data points $(L_j, \\mu_i(L_j))$ from simulations, we can set up a system of linear equations. Let the vector of unknown coefficients for species $i$ be $\\mathbf{c}_i = [\\mu_i^{\\infty}, \\alpha_i, \\beta_i]^T$. The system for all $m$ data points can be written in matrix form as $\\mathbf{y}_i = \\mathbf{X}\\mathbf{c}_i$, where:\n- $\\mathbf{y}_i = [\\mu_i(L_1), \\mu_i(L_2), \\dots, \\mu_i(L_m)]^T$ is the vector of observed chemical potentials.\n- $\\mathbf{X}$ is the design matrix, whose rows are constructed from the basis functions of the model, $[1, 1/L, 1/L^3]$, evaluated at each $L_j$:\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1 & 1/L_1 & 1/L_1^3 \\\\\n1 & 1/L_2 & 1/L_2^3 \\\\\n\\vdots & \\vdots & \\vdots \\\\\n1 & 1/L_m & 1/L_m^3\n\\end{pmatrix}\n$$\nFor each species (oxidized, $\\text{Ox}$, and reduced, $\\text{Red}$), we solve this system for the coefficient vector $\\mathbf{c}_i$ using the method of linear least squares. The least-squares solution minimizes the sum of squared residuals and is given by $\\mathbf{c}_i = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}_i$. This is a standard procedure readily available in numerical libraries. The first element of the resulting vector $\\mathbf{c}_i$ is the desired thermodynamic-limit potential, $\\mu_i^{\\infty}$. This fitting procedure is performed independently for $\\mu_{\\text{Ox}}(L)$ and $\\mu_{\\text{Red}}(L)$.\n\n**Step 2: Calculation of the Equilibrium Cell Potential**\n\nWith the extrapolated values $\\mu_{\\text{Ox}}^{\\infty}$ and $\\mu_{\\text{Red}}^{\\infty}$ determined, the difference in excess chemical potential at the thermodynamic limit is calculated as $\\Delta \\mu_{\\text{excess}} = \\mu_{\\text{Red}}^{\\infty} - \\mu_{\\text{Ox}}^{\\infty}$.\n\nThis value is then used in the Nernst relation to find the equilibrium potential of the working electrode, $E_{\\text{work}}$:\n$$\nE_{\\text{work}} = -\\frac{\\Delta \\mu_{\\text{excess}}}{n F} + \\frac{R T}{n F} \\ln\\!\\left(\\frac{a_{\\text{Ox}}}{a_{\\text{Red}}}\\right)\n$$\nThe parameters $n$ (number of electrons), $T$ (temperature), $a_{\\text{Ox}}$ (activity of oxidized species), and $a_{\\text{Red}}$ (activity of reduced species) are provided for each case. The constants $R$ (ideal gas constant, $8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$) and $F$ (Faraday constant, $96485.33212\\ \\mathrm{C\\,mol^{-1}}$) are also given. The units are consistent: $\\Delta\\mu_{\\text{excess}}$ is in $\\mathrm{J\\,mol^{-1}}$, $n$ is dimensionless, and $F$ is in $\\mathrm{C\\,mol^{-1}}$. The ratio $\\mathrm{J}/\\mathrm{C}$ gives volts ($\\mathrm{V}$), as required.\n\nFinally, the cell potential, $E_{\\text{cell}}$, is computed relative to the specified reference electrode potential, $E_{\\text{ref}}$:\n$$\nE_{\\text{cell}} = E_{\\text{work}} - E_{\\text{ref}}\n$$\nThe resulting $E_{\\text{cell}}$ for each test case is then rounded to six decimal places as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the equilibrium cell potential for a series of test cases\n    by extrapolating simulated chemical potentials to the thermodynamic limit.\n    \"\"\"\n    # Define constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212  # C mol^-1\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L_nm\": np.array([2.0, 2.5, 3.0, 4.0]),\n            \"mu_ox_func\": lambda L: 5000 + 2000/L - 100000/L**3,\n            \"mu_red_func\": lambda L: -5000 - 2500/L + 50000/L**3,\n            \"n\": 1,\n            \"T_K\": 298.15,\n            \"a_ox\": 0.01,\n            \"a_red\": 1.0,\n            \"E_ref_V\": 0.20\n        },\n        {\n            \"L_nm\": np.array([3.0, 4.0, 5.0, 6.0]),\n            \"mu_ox_func\": lambda L: 8000 + 1500/L,\n            \"mu_red_func\": lambda L: -500/L,\n            \"n\": 2,\n            \"T_K\": 298.15,\n            \"a_ox\": 1.0,\n            \"a_red\": 1.0,\n            \"E_ref_V\": 0.0\n        },\n        {\n            \"L_nm\": np.array([2.5, 3.5, 5.0]),\n            \"mu_ox_func\": lambda L: -2000 + 40000/L**3,\n            \"mu_red_func\": lambda L: -1000 + 1000/L - 30000/L**3,\n            \"n\": 1,\n            \"T_K\": 350.0,\n            \"a_ox\": 0.1,\n            \"a_red\": 0.9,\n            \"E_ref_V\": 0.10\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Step 1: Extrapolate to the thermodynamic limit\n        L = case[\"L_nm\"]\n        \n        # Generate mu data from the provided functions\n        mu_ox_data = case[\"mu_ox_func\"](L)\n        mu_red_data = case[\"mu_red_func\"](L)\n\n        # Construct the design matrix X\n        # Columns correspond to basis functions: 1, 1/L, 1/L^3\n        X = np.vstack([np.ones(L.shape[0]), 1/L, 1/L**3]).T\n\n        # Perform linear least squares fit for Ox species\n        # The first element of the result vector is mu_infinity\n        coeffs_ox = np.linalg.lstsq(X, mu_ox_data, rcond=None)[0]\n        mu_ox_inf = coeffs_ox[0]\n\n        # Perform linear least squares fit for Red species\n        coeffs_red = np.linalg.lstsq(X, mu_red_data, rcond=None)[0]\n        mu_red_inf = coeffs_red[0]\n\n        # Step 2: Calculate the cell potential\n        delta_mu_excess = mu_red_inf - mu_ox_inf\n        n = case[\"n\"]\n        T = case[\"T_K\"]\n        \n        # Calculate the working electrode potential using the Nernst relation\n        # E_work = - (delta_mu_excess / (n*F)) + (R*T / (n*F)) * ln(a_ox/a_red)\n        potential_from_mu = -delta_mu_excess / (n * F)\n        \n        # Handle activity ratio to avoid log(0) if needed, though not in test cases\n        activity_ratio = case[\"a_ox\"] / case[\"a_red\"]\n        potential_from_activity = (R * T / (n * F)) * np.log(activity_ratio)\n        \n        E_work = potential_from_mu + potential_from_activity\n\n        # Calculate the cell potential relative to the reference electrode\n        E_cell = E_work - case[\"E_ref_V\"]\n        \n        # Append the rounded result to the list\n        results.append(round(E_cell, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice delves into the structure of the electrode-electrolyte interface using a classic continuum model. You will numerically solve the Poisson-Boltzmann equation to compute the potential distribution within the electrical double layer and determine the potential of zero charge (PZC). This exercise illustrates how the local potential at the reaction plane modifies surface concentrations and shifts the equilibrium potential, a phenomenon known as the Frumkin effect, providing a deeper, physically-grounded understanding of the Nernst relation at charged interfaces .",
            "id": "4244853",
            "problem": "You are to construct a numerical solver and analysis routine for a planar electrified interface between a metallic electrode and an aqueous electrolyte solution within the framework of computational electrochemistry. The electrolyte is a symmetric monovalent $1:1$ salt of bulk concentration $c_0$. The governing physical basis is the combination of electrostatics and statistical mechanics applied to ions in solution. Start from the following foundational statements:\n\n- Poisson's equation for electrostatics in a one-dimensional planar geometry is $$\\frac{d^2 \\psi(x)}{dx^2} = -\\frac{\\rho(x)}{\\varepsilon},$$ where $\\psi(x)$ is the electrostatic potential, $\\rho(x)$ is the local charge density, and $\\varepsilon$ is the permittivity of the medium. The permittivity is $\\varepsilon = \\varepsilon_0 \\varepsilon_r$, where $\\varepsilon_0$ is the vacuum permittivity and $\\varepsilon_r$ is the relative permittivity of water.\n- The ionic number densities $c_+(x)$ and $c_-(x)$ obey Boltzmann distributions in the mean-field approximation, namely $$c_+(x) = c_0 \\exp\\left(-\\frac{F \\psi(x)}{R T}\\right), \\quad c_-(x) = c_0 \\exp\\left(+\\frac{F \\psi(x)}{R T}\\right),$$ where $F$ is the Faraday constant, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n- The local charge density is $$\\rho(x) = F \\left(c_+(x) - c_-(x)\\right).$$ Combining the above relations yields the one-dimensional Poisson–Boltzmann equation for a symmetric monovalent electrolyte: $$\\frac{d^2 \\psi(x)}{dx^2} = \\frac{2 F c_0}{\\varepsilon} \\sinh\\left(\\frac{F \\psi(x)}{R T}\\right).$$\n- The planar surface charge density $\\sigma$ at the electrode located at $x=0$ is related to the interfacial electric field by Gauss's law, $$\\sigma = -\\varepsilon \\left.\\frac{d \\psi(x)}{dx}\\right|_{x=0}.$$\n- The potential of zero charge (PZC) is defined as the electrode surface potential at which the net surface charge density is zero, namely the value $\\psi_0$ such that $$\\sigma(\\psi_0)=0.$$\n- Consider a redox reaction of the general form $$\\mathrm{O}^{z_O} + n\\,e^- \\rightleftharpoons \\mathrm{R}^{z_R}.$$ At equilibrium, the Nernst relation holds with surface activities evaluated at the plane of electron transfer. The Boltzmann distribution modifies the surface activities via $$a_i(0) = a_i^{\\mathrm{bulk}} \\exp\\left(-\\frac{z_i F \\psi(0)}{R T}\\right),$$ where $i \\in \\{\\mathrm{O},\\mathrm{R}\\}$. Consequently, the equilibrium potential measured against a reference electrode is shifted relative to bulk activities by an interfacial potential term. If $E^0_{\\mathrm{SHE}}$ is the standard potential versus the Standard Hydrogen Electrode (SHE), and $E_{\\mathrm{ref}}$ is the potential of the Silver/Silver Chloride (Ag/AgCl) reference electrode versus SHE, then the equilibrium potential measured versus Ag/AgCl is $$E_{\\mathrm{meas}} = \\left(E^0_{\\mathrm{SHE}} - E_{\\mathrm{ref}}\\right) + \\frac{R T}{n F} \\ln\\left(\\frac{a_{\\mathrm{O}}^{\\mathrm{bulk}}}{a_{\\mathrm{R}}^{\\mathrm{bulk}}}\\right) - \\frac{(z_O - z_R)}{n} \\,\\psi(0).$$\n\nYour tasks are:\n\n- Implement a numerical boundary value problem solver for the Poisson–Boltzmann equation on a finite interval $x \\in [0, L]$, with boundary conditions $\\psi(0) = \\psi_0$ (a prescribed surface potential) and $\\psi(L) = 0$ (bulk electroneutrality), where $L$ is a multiple of the Debye length. Compute the resulting surface charge density $\\sigma$ using the numerical derivative at $x=0$.\n- Identify the potential of zero charge by scanning $\\psi_0$ over a specified interval and finding the value that minimizes $\\lvert \\sigma \\rvert$.\n- Using the Nernst relation as stated, compute the equilibrium potential $E_{\\mathrm{meas}}$ versus Ag/AgCl both at the specified $\\psi_0$ and at the PZC.\n\nPhysical constants and units to be used:\n\n- $\\varepsilon_0$ in $\\mathrm{F/m}$.\n- $\\varepsilon_r$ dimensionless.\n- $F$ in $\\mathrm{C/mol}$.\n- $R$ in $\\mathrm{J/(mol\\cdot K)}$.\n- $T$ in $\\mathrm{K}$.\n- $c_0$ in $\\mathrm{mol/m^3}$ (note that $1\\,\\mathrm{M} = 1000\\,\\mathrm{mol/m^3}$).\n- $\\psi$ in $\\mathrm{V}$.\n- $\\sigma$ in $\\mathrm{C/m^2}$.\n- $E$ in $\\mathrm{V}$.\n\nExpress all potentials in $\\mathrm{V}$ and all surface charge densities in $\\mathrm{C/m^2}$. Report numerical outputs as floating-point numbers.\n\nConstruct a test suite composed of the following parameter sets:\n\n- Test case $1$ (\"happy path\"): $T = 298.15$, $c_0 = 0.1$ (molar, convert to $\\mathrm{mol/m^3}$), $\\varepsilon_r = 78.37$, $\\psi_0 = 0.05$, $n = 1$, $z_O = +1$, $z_R = 0$, $a_{\\mathrm{O}}^{\\mathrm{bulk}} = 1.0$, $a_{\\mathrm{R}}^{\\mathrm{bulk}} = 1.0$, $E^0_{\\mathrm{SHE}} = 0.40$, $E_{\\mathrm{ref}} = 0.1976$.\n- Test case $2$ (boundary condition at zero potential): $T = 298.15$, $c_0 = 0.1$, $\\varepsilon_r = 78.37$, $\\psi_0 = 0.0$, $n = 1$, $z_O = +1$, $z_R = 0$, $a_{\\mathrm{O}}^{\\mathrm{bulk}} = 1.0$, $a_{\\mathrm{R}}^{\\mathrm{bulk}} = 1.0$, $E^0_{\\mathrm{SHE}} = 0.40$, $E_{\\mathrm{ref}} = 0.1976$.\n- Test case $3$ (edge case: low ionic strength): $T = 298.15$, $c_0 = 0.001$, $\\varepsilon_r = 78.37$, $\\psi_0 = 0.05$, $n = 1$, $z_O = +1$, $z_R = 0$, $a_{\\mathrm{O}}^{\\mathrm{bulk}} = 1.0$, $a_{\\mathrm{R}}^{\\mathrm{bulk}} = 1.0$, $E^0_{\\mathrm{SHE}} = 0.40$, $E_{\\mathrm{ref}} = 0.1976$.\n\nAlgorithmic specifications:\n\n- Choose $L$ equal to $10$ times the Debye length $$\\lambda_D = \\sqrt{\\frac{\\varepsilon R T}{2 F^2 c_0}}.$$\n- Use a sufficiently fine spatial discretization to resolve the double layer (e.g., at least $100$ points in $[0,L]$).\n- For the PZC search, scan $\\psi_0$ uniformly over the interval $[-0.15, +0.15]$ in steps of $0.002$ and select the value that minimizes $\\lvert \\sigma(\\psi_0)\\rvert$.\n- Use the numerical derivative at $x=0$ from the boundary value problem solution to compute $\\sigma$ via $\\sigma = -\\varepsilon \\left.\\frac{d \\psi}{dx}\\right|_{x=0}$.\n\nFinal output specification:\n\n- For each test case, produce a list containing four floating-point numbers in the following order: $[\\text{PZC}, \\sigma(\\psi_0), E_{\\mathrm{meas}}(\\psi_0), E_{\\mathrm{meas}}(\\text{PZC})]$, with the first entry in $\\mathrm{V}$, the second in $\\mathrm{C/m^2}$, and the last two in $\\mathrm{V}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case output is itself a list. For example, the overall output should look like $$[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],[x_3,y_3,z_3,w_3]].$$\n\nNo user input is required; the program must run as-is and print only the requested single-line output.",
            "solution": "The user has provided a valid problem statement. The task is to develop a numerical model for a simple electrochemical interface and use it to compute several key quantities. The problem is scientifically grounded in the well-established Poisson-Boltzmann and Nernst theories, is mathematically well-posed as a boundary value problem, and provides a complete and consistent set of parameters and instructions for its solution.\n\n### 1. Theoretical Framework\n\nThe problem requires the numerical solution of the one-dimensional Poisson-Boltzmann (PB) equation for a symmetric monovalent ($1:1$) electrolyte adjacent to a planar electrode:\n$$\n\\frac{d^2 \\psi(x)}{dx^2} = \\frac{2 F c_0}{\\varepsilon} \\sinh\\left(\\frac{F \\psi(x)}{R T}\\right)\n$$\nHere, $\\psi(x)$ is the electrostatic potential at a distance $x$ from the electrode surface, $c_0$ is the bulk electrolyte concentration, $\\varepsilon$ is the permittivity of the solvent, $F$ is the Faraday constant, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nThis second-order ordinary differential equation (ODE) is subject to two boundary conditions:\n1.  $\\psi(0) = \\psi_0$: The potential at the electrode surface ($x=0$) is a fixed value, $\\psi_0$.\n2.  $\\psi(L) = 0$: The potential decays to zero far from the electrode, representing the electroneutral bulk solution. The problem specifies using a finite domain length $L = 10 \\lambda_D$, where $\\lambda_D$ is the Debye length:\n    $$\n    \\lambda_D = \\sqrt{\\frac{\\varepsilon R T}{2 F^2 c_0}}\n    $$\n    Choosing $L$ as $10$ times the characteristic screening length $\\lambda_D$ ensures that the approximation $\\psi(L) \\approx \\psi(\\infty) = 0$ is highly accurate.\n\nFrom the solution $\\psi(x)$, the surface charge density $\\sigma$ on the electrode is determined by Gauss's law:\n$$\n\\sigma = -\\varepsilon \\left.\\frac{d \\psi(x)}{dx}\\right|_{x=0}\n$$\n\nThe Potential of Zero Charge (PZC) is the specific surface potential $\\psi_0$ for which the surface charge density $\\sigma$ is zero. For the symmetric electrolyte model presented, theory dictates that PZC occurs exactly at $\\psi_0 = 0 \\, \\mathrm{V}$. The problem requires a numerical search for this value by scanning a range of $\\psi_0$ and identifying the value that minimizes the magnitude of the computed surface charge, $|\\sigma|$.\n\nFinally, the measured equilibrium potential $E_{\\mathrm{meas}}$ of a redox couple at the interface is calculated using the provided Nernst relation, which includes a correction for the interfacial potential $\\psi(0)$:\n$$\nE_{\\mathrm{meas}} = \\left(E^0_{\\mathrm{SHE}} - E_{\\mathrm{ref}}\\right) + \\frac{R T}{n F} \\ln\\left(\\frac{a_{\\mathrm{O}}^{\\mathrm{bulk}}}{a_{\\mathrm{R}}^{\\mathrm{bulk}}}\\right) - \\frac{(z_O - z_R)}{n} \\,\\psi(0)\n$$\nThis potential is calculated both for the specified $\\psi_0$ of the test case and for the numerically determined PZC.\n\n### 2. Numerical Implementation Strategy\n\nThe core of the task is to solve a two-point boundary value problem (BVP). We use the `scipy.integrate.solve_bvp` function, which is designed for such problems.\n\n**a. BVP Formulation:**\nThe second-order PB equation is converted into a system of two first-order ODEs by defining a vector state $y(x) = [y_1(x), y_2(x)]^T$, where:\n-  $y_1(x) = \\psi(x)$\n-  $y_2(x) = \\frac{d\\psi(x)}{dx}$\n\nThe system of ODEs becomes:\n-  $\\frac{dy_1}{dx} = y_2$\n-  $\\frac{dy_2}{dx} = k_1 \\sinh(k_2 y_1)$, where $k_1 = \\frac{2 F c_0}{\\varepsilon}$ and $k_2 = \\frac{F}{RT}$.\n\nThe boundary conditions in terms of $y$ are:\n-  $y_1(0) = \\psi_0$\n-  $y_1(L) = 0$\n\n**b. Solving the BVP:**\nThe `solve_bvp` function requires the ODE system, the boundary condition residuals, a spatial mesh, and an initial guess for the solution.\n-   **Spatial Mesh:** A uniform grid of $201$ points is created over the interval $[0, L]$.\n-   **Initial Guess:** A linear potential profile is a robust initial guess: $\\psi(x) = \\psi_0 (1 - x/L)$. Consequently, the initial guess for the state vector $y$ is $y_1(x) = \\psi_0 (1-x/L)$ and $y_2(x) = - \\psi_0/L$.\n\n**c. Computational Workflow:**\nFor each test case provided:\n1.  **Parameter Calculation:** Define physical constants ($\\varepsilon_0, F, R$) and test-case specific parameters ($T, c_0, \\varepsilon_r$, etc.). Convert $c_0$ from Molar to SI units ($\\mathrm{mol/m^3}$). Calculate derived quantities like $\\varepsilon$, $\\lambda_D$, and $L$.\n2.  **PZC Determination:**\n    -   Iterate through a grid of candidate surface potentials, $\\psi_{0, \\text{scan}}$, from $-0.15\\,\\mathrm{V}$ to $+0.15\\,\\mathrm{V}$.\n    -   For each $\\psi_{0, \\text{scan}}$, solve the BVP to obtain the potential profile $\\psi(x)$ and its derivative $\\frac{d\\psi}{dx}$.\n    -   The solver provides the value of the derivative at the boundary, $y_2(0) = \\frac{d\\psi}{dx}|_{x=0}$.\n    -   Calculate the surface charge $\\sigma = -\\varepsilon y_2(0)$.\n    -   The PZC is identified as the $\\psi_{0, \\text{scan}}$ that results in the minimum value of $|\\sigma|$.\n3.  **Calculation of Output Quantities:**\n    -   **PZC:** The value found in the previous step.\n    -   **$\\sigma(\\psi_0)$:** Solve the BVP one more time using the specific $\\psi_0$ from the test case parameters. Calculate the corresponding $\\sigma$.\n    -   **$E_{\\mathrm{meas}}(\\psi_0)$:** Calculate the measured potential using the Nernst relation with $\\psi(0)$ set to the test case's $\\psi_0$.\n    -   **$E_{\\mathrm{meas}}(\\text{PZC})$:** Calculate the measured potential using the Nernst relation with $\\psi(0)$ set to the determined PZC.\n4.  **Output Formatting:** The four computed values are collected into a list. The lists from all test cases are then formatted into the specified single-line string representation.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_bvp\n\ndef solve():\n    \"\"\"\n    Solves the Poisson-Boltzmann equation for an electrified interface\n    and computes related electrochemical quantities for a set of test cases.\n    \"\"\"\n    # Physical constants in SI units\n    EPSILON_0 = 8.8541878128e-12  # F/m (vacuum permittivity)\n    F = 96485.33212             # C/mol (Faraday constant)\n    R = 8.314462618             # J/(mol*K) (universal gas constant)\n\n    # Test cases as specified in the problem\n    test_cases = [\n        # T (K), c0 (M), eps_r, psi0 (V), n, z_O, z_R, a_O, a_R, E0_SHE (V), E_ref (V)\n        (298.15, 0.1, 78.37, 0.05, 1, 1, 0, 1.0, 1.0, 0.40, 0.1976),\n        (298.15, 0.1, 78.37, 0.0, 1, 1, 0, 1.0, 1.0, 0.40, 0.1976),\n        (298.15, 0.001, 78.37, 0.05, 1, 1, 0, 1.0, 1.0, 0.40, 0.1976),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T, c0_molar, eps_r, psi0_case, n, z_O, z_R, a_O, a_R, E0_SHE, E_ref = case\n        \n        # --- 1. Parameter Calculation ---\n        c0 = c0_molar * 1000.0  # Convert Molar to mol/m^3\n        eps = eps_r * EPSILON_0  # Permittivity of the medium\n\n        # Pre-calculate constants for the ODE and other equations\n        k1 = (2 * F * c0) / eps\n        k2 = F / (R * T)\n\n        debye_length = np.sqrt((eps * R * T) / (2 * F**2 * c0))\n        L = 10 * debye_length  # Domain length\n        \n        num_points = 201\n        x_mesh = np.linspace(0, L, num_points)\n\n        # --- 2. BVP Solver Function ---\n        def solve_pb_for_psi0(psi0_val):\n            \"\"\"Solves the PB BVP for a given surface potential psi0_val.\"\"\"\n            # ODE system: y' = f(x, y) where y = [psi, d_psi/dx]\n            def ode_system(x, y):\n                d_psi_dx = y[1]\n                d2_psi_dx2 = k1 * np.sinh(k2 * y[0])\n                return np.vstack((d_psi_dx, d2_psi_dx2))\n\n            # Boundary conditions: psi(0) = psi0_val, psi(L) = 0\n            def bc(ya, yb):\n                return np.array([ya[0] - psi0_val, yb[0] - 0])\n\n            # Initial guess for the solution\n            y_guess = np.zeros((2, x_mesh.size))\n            y_guess[0, :] = psi0_val * (1 - x_mesh / L)\n            if L > 0:\n                y_guess[1, :] = -psi0_val / L\n            \n            # Solve the BVP\n            sol = solve_bvp(ode_system, bc, x_mesh, y_guess, max_nodes=5000)\n            \n            # Extract derivative at x=0 for sigma calculation\n            d_psi_dx_at_0 = sol.y[1, 0]\n            sigma = -eps * d_psi_dx_at_0\n            return sigma\n\n        # --- 3. PZC Determination ---\n        pzc_scan_psi0 = np.arange(-0.15, 0.1501, 0.002)\n        sigmas = [solve_pb_for_psi0(psi) for psi in pzc_scan_psi0]\n        \n        # Find psi0 that minimizes |sigma|\n        min_abs_sigma_idx = np.argmin(np.abs(sigmas))\n        pzc = pzc_scan_psi0[min_abs_sigma_idx]\n\n        # --- 4. Calculation of Output Quantities ---\n        # sigma for the given psi0 in the test case\n        sigma_at_psi0 = solve_pb_for_psi0(psi0_case)\n\n        # Nernst potential calculation function\n        def calculate_e_meas(psi0_val):\n            # The ln term is zero since a_O/a_R = 1.0\n            e_bulk_term = (E0_SHE - E_ref) \n            e_potential_term = -((z_O - z_R) / n) * psi0_val\n            return e_bulk_term + e_potential_term\n        \n        # E_meas at the specified psi0\n        e_meas_at_psi0 = calculate_e_meas(psi0_case)\n        \n        # E_meas at the PZC\n        e_meas_at_pzc = calculate_e_meas(pzc)\n\n        # --- 5. Store Results ---\n        case_results = [pzc, sigma_at_psi0, e_meas_at_psi0, e_meas_at_pzc]\n        all_results.append(case_results)\n\n    # --- 6. Final Output Formatting ---\n    # Construct the final string representation without extra spaces\n    result_strings = []\n    for res in all_results:\n        # Format each number to a string and join with commas\n        formatted_res = f\"[{','.join(map(str, res))}]\"\n        result_strings.append(formatted_res)\n    \n    # Join the formatted lists for each test case\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\n\nsolve()\n```"
        }
    ]
}