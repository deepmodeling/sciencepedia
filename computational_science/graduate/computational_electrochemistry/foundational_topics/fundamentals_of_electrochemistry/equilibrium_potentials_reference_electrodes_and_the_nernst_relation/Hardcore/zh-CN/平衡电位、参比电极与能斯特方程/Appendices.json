{
    "hands_on_practices": [
        {
            "introduction": "能斯特方程描述了理想的平衡电势，但在实际的电化学测量中，由于测量仪器并非理想电压表，总会汲取微小的偏置电流。当该电流流经电解质溶液时，会因溶液电阻（即未补偿电阻 $R_u$）而产生一个额外的欧姆电势降（$IR$ 降），从而使测量电势偏离真实的平衡值。本练习将通过一个模拟的电流中断实验，指导您如何测定 $R_u$ 并校正测量电势，从而掌握连接理想理论与真实实验数据的关键分析技能。",
            "id": "4244806",
            "problem": "一个平面工作电极在温度 $T=298.15\\,\\mathrm{K}$ 的水溶液中探究氧化还原电对 $\\mathrm{Fe(CN)}_6^{3-}/\\mathrm{Fe(CN)}_6^{4-}$。氧化态物种和还原态物种的活度分别为 $a_{\\mathrm{ox}}=2.0\\times 10^{-3}$ 和 $a_{\\mathrm{red}}=1.0\\times 10^{-2}$。这个单电子电对的标准电势为 $E^\\circ=0.361\\,\\mathrm{V}$（相对于标准氢电极 SHE）。参比电极为饱和 $\\mathrm{KCl}$ 溶液中的银/氯化银 (Ag/AgCl) 电极，在 $T=298.15\\,\\mathrm{K}$ 时，其相对于 SHE 的参比电势为 $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}=+0.197\\,\\mathrm{V}$。在稳态条件下，测得的相对于 Ag/AgCl 的电位信号为 $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}=0.124\\,\\mathrm{V}$。测量电子设备在工作电极和参比电极之间的电解质路径上引入了一个大小为 $I_b=8\\,\\mu\\mathrm{A}$ 的偏置电流。电化学阻抗谱 (EIS) 表明，在工作电极和参比电极之间存在一个未补偿溶液电阻 $R_u$。进行了一次电流中断实验：在中断前瞬间，通过一个恒定电流 $I=50\\,\\mu\\mathrm{A}$；在 $t=0$ 时刻，电流被中断，工作电极电势瞬时下降了 $\\Delta E_0=6.0\\,\\mathrm{mV}$，然后以一个由双电层电容 $C_{\\mathrm{dl}}=100\\,\\mu\\mathrm{F}$ 决定的时间常数呈指数衰减。\n\n仅使用化学势、电化学势和电荷守恒的基本热力学定义，确定由活度预测的平衡电势，并评估未补偿电阻如何使电位测量产生偏差。然后选择一个陈述，该陈述 (i) 正确描述了如何使用电流中断法来估计和消除电流乘以电阻 ($IR$) 压降以恢复平衡电势，并且 (ii) 报告了根据给定数据校正后相对于 SHE 的平衡电势。选择一个选项。\n\nA. 当有非零电流流过时，未补偿电阻会在测量电势上增加一个欧姆项 $+I R_u$。在电流中断法中，将瞬时跳变外推至 $t\\to 0^+$ 可得到 $\\Delta E_0=I R_u$，该值应根据实际偏置电流进行调整，并从 $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ 中减去；转换为 SHE 电势时需加上 $+E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$。根据 $R_u=\\Delta E_0/I=6.0\\,\\mathrm{mV}/50\\,\\mu\\mathrm{A}=120\\,\\Omega$ 和 $I_b R_u=0.96\\,\\mathrm{mV}$，校正后的平衡电势为 $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}-0.00096\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.32004\\,\\mathrm{V}$，这与热力学预测值 $E^\\circ+(RT/F)\\ln(a_{\\mathrm{ox}}/a_{\\mathrm{red}})\\approx 0.3197\\,\\mathrm{V}$ 一致。\n\nB. 未补偿电阻最好通过包括 $t\\to\\infty$ 时的电容拖尾在内的完整电势中断降来估计，并且该总压降应直接从测量电势中减去。使用中断电流 $I=50\\,\\mu\\mathrm{A}$，从 $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ 中减去 $6.0\\,\\mathrm{mV}$，然后加上 $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$，得到 $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}-0.0060\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.3150\\,\\mathrm{V}$。\n\nC. 未补偿电阻导致对真实电势的低估，因此在转换为 SHE 电势之前，应将 $IR$ 项加到 $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ 上。根据 $I_b R_u=0.96\\,\\mathrm{mV}$，得到 $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}+0.00096\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.3220\\,\\mathrm{V}$。\n\nD. 参比电极转换需要从测量值中减去 Ag/AgCl 的偏置值以获得相对于 SHE 的电势；欧姆项可以忽略不计。因此 $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx 0.124\\,\\mathrm{V}-0.197\\,\\mathrm{V}=-0.073\\,\\mathrm{V}$。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n问题陈述中提供的明确数据和条件如下：\n- 氧化还原电对：$\\mathrm{Fe(CN)}_6^{3-}/\\mathrm{Fe(CN)}_6^{4-}$\n- 转移电子数：$n=1$\n- 温度：$T=298.15\\,\\mathrm{K}$\n- 氧化态物种活度：$a_{\\mathrm{ox}}=2.0\\times 10^{-3}$\n- 还原态物种活度：$a_{\\mathrm{red}}=1.0\\times 10^{-2}$\n- 相对于 SHE 的标准电势：$E^\\circ=0.361\\,\\mathrm{V}$\n- 参比电极：饱和 $\\mathrm{KCl}$ 溶液中的银/氯化银 (Ag/AgCl)\n- 相对于 SHE 的参比电势：$E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}=+0.197\\,\\mathrm{V}$，在 $T=298.15\\,\\mathrm{K}$\n- 相对于 Ag/AgCl 的测量电势：$E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}=0.124\\,\\mathrm{V}$\n- 测量偏置电流：$I_b=8\\,\\mu\\mathrm{A} = 8 \\times 10^{-6}\\,\\mathrm{A}$\n- 电流中断实验所用电流：$I=50\\,\\mu\\mathrm{A} = 50 \\times 10^{-6}\\,\\mathrm{A}$\n- 电流中断时的瞬时电势降：$\\Delta E_0=6.0\\,\\mathrm{mV} = 6.0 \\times 10^{-3}\\,\\mathrm{V}$\n- 双电层电容：$C_{\\mathrm{dl}}=100\\,\\mu\\mathrm{F}$\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n- **科学依据**：该问题建立在电化学的基本原理之上，包括用于计算平衡电势的能斯特方程、参比电极的概念、欧姆电势降（$IR$ 压降）以及用于测量未补偿电阻的电流中断技术。化学体系（$\\mathrm{Fe(CN)}_6^{3-}/\\mathrm{Fe(CN)}_6^{4-}$）是在电化学研究中使用的标准、行为良好的氧化还原电对。所有数值在物理上都是现实的。\n- **适定性**：该问题是适定的。它提供了足够的信息来计算理论平衡电势，从实验数据中确定未补偿电阻，校正测量电势中的欧姆干扰，并将结果与理论值进行比较。问题具体，且导向唯一答案。\n- **客观性**：该问题以精确、定量和客观的语言陈述，没有歧义或主观解释。\n- **完整性和一致性**：所提供的数据是自洽的，足以进行完整分析。例如，电流中断实验的数据（$I$ 和 $\\Delta E_0$）允许计算 $R_u$，然后用该值和偏置电流 $I_b$ 来校正测量电势 $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$。包含 $C_{\\mathrm{dl}}$ 正确地为中断后电势衰减提供了背景，尽管其值对于核心计算不是必需的，但这增强了实验设置的物理真实性。数据之间没有矛盾。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。它在科学上是合理的、适定的且内部一致。可以继续求解过程。\n\n### 正确答案的推导\n\n求解过程包括三个主要步骤：\n1.  使用能斯特方程根据给定的活度计算理论平衡电势 ($E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}}$)。\n2.  从电流中断实验中确定未补偿电阻 ($R_u$)，并用它来计算干扰电位测量的欧姆电势降 ($I_b R_u$)。\n3.  通过消除欧姆压降来校正测量电势 ($E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$)，然后将结果转换为 SHE 标度，以获得实验推导的平衡电势 ($E_{\\mathrm{eq, exp}}^{\\mathrm{SHE}}$)。\n\n**步骤 1：理论平衡电势（能斯特方程）**\n这个单电子（$n=1$）反应的能斯特方程为：\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} = E^\\circ + \\frac{RT}{nF} \\ln\\left(\\frac{a_{\\mathrm{ox}}}{a_{\\mathrm{red}}}\\right) $$\n使用所提供的值：\n- $E^\\circ = 0.361\\,\\mathrm{V}$\n- $R = 8.31446\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $T = 298.15\\,\\mathrm{K}$\n- $n = 1$\n- $F = 96485.33\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- $a_{\\mathrm{ox}} = 2.0 \\times 10^{-3}$\n- $a_{\\mathrm{red}} = 1.0 \\times 10^{-2}$\n\n热电压项为 $\\frac{RT}{F} \\approx \\frac{(8.31446)(298.15)}{96485.33} \\approx 0.025693\\,\\mathrm{V}$。\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} = 0.361\\,\\mathrm{V} + \\frac{0.025693\\,\\mathrm{V}}{1} \\ln\\left(\\frac{2.0 \\times 10^{-3}}{1.0 \\times 10^{-2}}\\right) $$\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} = 0.361\\,\\mathrm{V} + 0.025693\\,\\mathrm{V} \\times \\ln(0.2) $$\n由于 $\\ln(0.2) \\approx -1.609438$：\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} \\approx 0.361\\,\\mathrm{V} + 0.025693\\,\\mathrm{V} \\times (-1.609438) \\approx 0.361\\,\\mathrm{V} - 0.041355\\,\\mathrm{V} $$\n$$ E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}} \\approx 0.319645\\,\\mathrm{V} $$\n\n**步骤 2：未补偿电阻和欧姆压降**\n电流中断技术测量的是瞬时电势降 $\\Delta E_0$，这完全是由未补偿电阻 $R_u$ 上的欧姆压降引起的。\n$$ \\Delta E_0 = I R_u $$\n其中 $I$ 是中断前瞬间施加的电流。\n$$ R_u = \\frac{\\Delta E_0}{I} = \\frac{6.0 \\times 10^{-3}\\,\\mathrm{V}}{50 \\times 10^{-6}\\,\\mathrm{A}} = 120\\,\\Omega $$\n电位测量受到由偏置电流 $I_b$（而不是较大的电流 $I$）引起的欧姆压降的干扰。该欧姆压降的大小为：\n$$ V_{\\mathrm{ohmic}} = I_b R_u = (8 \\times 10^{-6}\\,\\mathrm{A}) \\times (120\\,\\Omega) = 960 \\times 10^{-6}\\,\\mathrm{V} = 0.96\\,\\mathrm{mV} $$\n\n**步骤 3：校正测量电势**\n测量电势 $E_{\\mathrm{meas}}$ 包括真实界面电势 $E_{\\mathrm{eq}}$ 和欧姆压降。假设偏置电流为正（阳极电流），则测量电势高于真实电势：\n$$ E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}} = E_{\\mathrm{eq}}^{\\mathrm{Ag/AgCl}} + I_b R_u $$\n为了找到相对于参比电极的真实平衡电势，我们必须减去这个欧姆干扰：\n$$ E_{\\mathrm{eq}}^{\\mathrm{Ag/AgCl}} = E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}} - I_b R_u = 0.124\\,\\mathrm{V} - 0.00096\\,\\mathrm{V} = 0.12304\\,\\mathrm{V} $$\n最后，为了将此电势转换为 SHE 标度，我们加上参比电极相对于 SHE 的电势：\n$$ E_{\\mathrm{eq, exp}}^{\\mathrm{SHE}} = E_{\\mathrm{eq}}^{\\mathrm{Ag/AgCl}} + E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}} = 0.12304\\,\\mathrm{V} + 0.197\\,\\mathrm{V} = 0.32004\\,\\mathrm{V} $$\n这个实验推导值 ($0.32004\\,\\mathrm{V}$) 与理论能斯特电势 ($0.319645\\,\\mathrm{V}$) 高度一致。\n\n### 选项评估\n\n**A. 当有非零电流流过时，未补偿电阻会在测量电势上增加一个欧姆项 $+I R_u$。在电流中断法中，将瞬时跳变外推至 $t\\to 0^+$ 可得到 $\\Delta E_0=I R_u$，该值应根据实际偏置电流进行调整，并从 $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ 中减去；转换为 SHE 电势时需加上 $+E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$。根据 $R_u=\\Delta E_0/I=6.0\\,\\mathrm{mV}/50\\,\\mu\\mathrm{A}=120\\,\\Omega$ 和 $I_b R_u=0.96\\,\\mathrm{mV}$，校正后的平衡电势为 $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}-0.00096\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.32004\\,\\mathrm{V}$，这与热力学预测值 $E^\\circ+(RT/F)\\ln(a_{\\mathrm{ox}}/a_{\\mathrm{red}})\\approx 0.3197\\,\\mathrm{V}$ 一致。**\n该陈述正确地指出，电流中断实验中的瞬时跳变可以得到 $R_u$。它正确地说明了欧姆校正必须使用偏置电流 $I_b$，而不是中断电流 $I$。它通过从测量电势中减去 $I_b R_u$ 项来正确地应用校正。它通过加上 $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$ 来正确地进行参比电极转换。所有计算，包括 $R_u$、$I_b R_u$、校正后的电势 $E_{\\mathrm{eq, exp}}^{\\mathrm{SHE}}$ 和理论能斯特电势 $E_{\\mathrm{eq, Nernst}}^{\\mathrm{SHE}}$，都是准确的，并与我们的推导相符。\n结论：**正确**。\n\n**B. 未补偿电阻最好通过包括 $t\\to\\infty$ 时的电容拖尾在内的完整电势中断降来估计，并且该总压降应直接从测量电势中减去。使用中断电流 $I=50\\,\\mu\\mathrm{A}$，从 $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ 中减去 $6.0\\,\\mathrm{mV}$，然后加上 $E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$，得到 $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}-0.0060\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.3150\\,\\mathrm{V}$。**\n该陈述因两个主要原因而不正确。首先，它误解了电流中断实验；只有 $t=0$ 时的瞬时压降才对应于 $I R_u$。包含电容拖尾在物理上是不正确的。其次，它错误地基于中断电流（$I=50\\,\\mu\\mathrm{A}$）应用校正，导致 $6.0\\,\\mathrm{mV}$ 的欧姆压降，而不是使用实际测量期间存在的偏置电流（$I_b=8\\,\\mu\\mathrm{A}$）。\n结论：**不正确**。\n\n**C. 未补偿电阻导致对真实电势的低估，因此在转换为 SHE 电势之前，应将 $IR$ 项加到 $E_{\\mathrm{meas}}^{\\mathrm{Ag/AgCl}}$ 上。根据 $I_b R_u=0.96\\,\\mathrm{mV}$，得到 $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx (0.124\\,\\mathrm{V}+0.00096\\,\\mathrm{V})+0.197\\,\\mathrm{V}=0.3220\\,\\mathrm{V}$。**\n该陈述对欧姆校正应用了错误的符号。对于阳极偏置电流，测量电势被人为地抬高了，因此 $I_b R_u$ 项必须被减去，而不是加上。加上该项导致电势 ($0.3220\\,\\mathrm{V}$) 比减去该项的结果离理论能斯特电势更远。\n结论：**不正确**。\n\n**D. 参比电极转换需要从测量值中减去 Ag/AgCl 的偏置值以获得相对于 SHE 的电势；欧姆项可以忽略不计。因此 $E_{\\mathrm{eq}}^{\\mathrm{SHE}}\\approx 0.124\\,\\mathrm{V}-0.197\\,\\mathrm{V}=-0.073\\,\\mathrm{V}$。**\n该陈述包含两个错误。首先，要将相对于 Ag/AgCl 测量的电势转换为 SHE 标度，必须加上而不是减去 Ag/AgCl 参比电极相对于 SHE 的电势（$E^{\\mathrm{SHE}} = E^{\\mathrm{Ag/AgCl}} + E_{\\mathrm{ref}}^{\\mathrm{Ag/AgCl}}$）。其次，它错误地将欧姆项视为可忽略不计。尽管该项很小（$0.96\\,\\mathrm{mV}$），但为了与热力学值进行精确比较，考虑该项是至关重要的，正如在正确分析中所达到的高度一致性所证明的那样。\n结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在对系统误差（如欧姆电势降）进行校正之后，评估结果的精度至关重要。本练习将探讨实验参数（如温度、浓度和活度系数）中的不确定性如何通过能斯特方程进行传播，并最终影响电势计算的整体不确定性。掌握误差传播分析不仅能让我们报告电势的数值，还能为其提供一个置信区间，这是严谨科学研究中不可或缺的一环。",
            "id": "4244808",
            "problem": "水合铁(III)/铁(II) $\\mathrm{Fe}^{3+}/\\mathrm{Fe}^{2+}$ 构成一个 $n=1$ 的单电子氧化还原电对。考虑一个指示电极，它与含有 $\\mathrm{Fe}^{3+}$ 和 $\\mathrm{Fe}^{2+}$ 的溶液处于平衡状态，其中物种 $i$ 的活度 $a_{i}$ 由 $a_{i} = \\gamma_{i} c_{i}$ 建模，$\\gamma_{i}$ 是活度系数，$c_{i}$ 是摩尔浓度。假设指示电极相对于标准氢电极 (SHE) 的平衡电势 $E$ 由氧化态和还原态物种的电化学势相等来确定，并且遵循该平衡所隐含的对温度和活度的依赖关系。将 $\\mathrm{Fe}^{3+}/\\mathrm{Fe}^{2+}$ 相对于 SHE 的标准电势 $E^{\\circ}$ 视为一个精确常数。\n\n给定所有输入量的名义值和标准不确定度：\n- 温度 $T = 298.15\\,\\mathrm{K}$，标准不确定度 $\\sigma_{T} = 0.20\\,\\mathrm{K}$。\n- 浓度 $c_{\\mathrm{Fe}^{3+}} = 1.00 \\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$ 和 $c_{\\mathrm{Fe}^{2+}} = 1.00 \\times 10^{-2}\\,\\mathrm{mol\\,L^{-1}}$，各自的相对标准不确定度为 $0.05$。\n- 活度系数 $\\gamma_{\\mathrm{Fe}^{3+}} = 0.30$ 和 $\\gamma_{\\mathrm{Fe}^{2+}} = 0.60$，各自的相对标准不确定度为 $0.05$。\n\n假设所有不确定度都是独立的，并且足够小以至于一阶泰勒线性化（线性误差分析）有效，并忽略 $E^{\\circ}$ 的任何不确定度。使用理想气体常数 $R = 8.314\\,462\\,618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和法拉第常数 $F = 96\\,485\\,\\mathrm{C\\,mol^{-1}}$。\n\n从电化学势平衡和活度定义出发，通过 $E$ 的表达式传播 $\\gamma_{\\mathrm{Fe}^{3+}}$、$\\gamma_{\\mathrm{Fe}^{2+}}$、$c_{\\mathrm{Fe}^{3+}}$、$c_{\\mathrm{Fe}^{2+}}$ 和 $T$ 的不确定度，以获得 $E$ 的预期标准不确定度。以伏特为单位表示您的最终数值结果，并将答案四舍五入到三位有效数字。",
            "solution": "该问题要求计算 $\\mathrm{Fe}^{3+}/\\mathrm{Fe}^{2+}$ 氧化还原电对指示电极的平衡电势 $E$ 的标准不确定度，给定温度、浓度和活度系数的不确定度。该问题被验证为科学上合理、提法明确且客观。这是电化学平衡原理和标准误差传播分析的直接应用。\n\n氧化还原反应为 $\\mathrm{Fe}^{3+} + e^{-} \\rightleftharpoons \\mathrm{Fe}^{2+}$。转移的电子数为 $n=1$。电极相对于标准氢电极 (SHE) 的平衡电势 $E$ 由能斯特方程决定。该方程源于所涉及物种的电化学势 ($\\tilde{\\mu}$) 之间的平衡条件：$\\tilde{\\mu}_{\\mathrm{Fe}^{3+}} + \\tilde{\\mu}_{e^{-}} = \\tilde{\\mu}_{\\mathrm{Fe}^{2+}}$。电化学势定义为 $\\tilde{\\mu}_i = \\mu_i + z_i F \\phi$，其中 $\\mu_i$ 是化学势，$z_i$ 是电荷数，$F$ 是法拉第常数，$\\phi$ 是静电势。化学势由 $\\mu_i = \\mu_i^{\\circ} + RT \\ln a_i$ 给出，其中 $\\mu_i^{\\circ}$ 是标准化学势，$R$ 是理想气体常数，$T$ 是绝对温度，$a_i$ 是物种 $i$ 的活度。\n\n遵循此原理，该半反应的能斯特方程为：\n$$E = E^{\\circ} + \\frac{RT}{nF} \\ln\\left(\\frac{a_{\\mathrm{ox}}}{a_{\\mathrm{red}}}\\right)$$\n对于给定体系，$n=1$，氧化态物种 (ox) 是 $\\mathrm{Fe}^{3+}$，还原态物种 (red) 是 $\\mathrm{Fe}^{2+}$。因此，电势 $E$ 为：\n$$E = E^{\\circ} + \\frac{RT}{F} \\ln\\left(\\frac{a_{\\mathrm{Fe}^{3+}}}{a_{\\mathrm{Fe}^{2+}}}\\right)$$\n活度 $a_i$ 通过 $a_i = \\gamma_i c_i$ 与摩尔浓度 $c_i$ 和活度系数 $\\gamma_i$ 相关。将此代入 $E$ 的方程中得到：\n$$E = E^{\\circ} + \\frac{RT}{F} \\ln\\left(\\frac{\\gamma_{\\mathrm{Fe}^{3+}} c_{\\mathrm{Fe}^{3+}}}{\\gamma_{\\mathrm{Fe}^{2+}} c_{\\mathrm{Fe}^{2+}}}\\right)$$\n为了便于求导，可将此表达式展开：\n$$E(T, \\gamma_{\\mathrm{Fe}^{3+}}, c_{\\mathrm{Fe}^{3+}}, \\gamma_{\\mathrm{Fe}^{2+}}, c_{\\mathrm{Fe}^{2+}}) = E^{\\circ} + \\frac{RT}{F} \\left( \\ln(\\gamma_{\\mathrm{Fe}^{3+}}) + \\ln(c_{\\mathrm{Fe}^{3+}}) - \\ln(\\gamma_{\\mathrm{Fe}^{2+}}) - \\ln(c_{\\mathrm{Fe}^{2+}}) \\right)$$\n该问题要求传播自变量 $T$、$\\gamma_{\\mathrm{Fe}^{3+}}$、$c_{\\mathrm{Fe}^{3+}}$、$\\gamma_{\\mathrm{Fe}^{2+}}$ 和 $c_{\\mathrm{Fe}^{2+}}$ 的不确定度，以求出 $E$ 的不确定度。$E^{\\circ}$ 的不确定度被声明为零。使用一阶泰勒展开，$E$ 的方差（记为 $\\sigma_E^2$）由对每个变量的偏导数平方与该变量的方差之积的总和给出：\n$$\\sigma_E^2 = \\left(\\frac{\\partial E}{\\partial T}\\right)^2 \\sigma_T^2 + \\left(\\frac{\\partial E}{\\partial \\gamma_{\\mathrm{Fe}^{3+}}}\\right)^2 \\sigma_{\\gamma_{\\mathrm{Fe}^{3+}}}^2 + \\left(\\frac{\\partial E}{\\partial c_{\\mathrm{Fe}^{3+}}}\\right)^2 \\sigma_{c_{\\mathrm{Fe}^{3+}}}^2 + \\left(\\frac{\\partial E}{\\partial \\gamma_{\\mathrm{Fe}^{2+}}}\\right)^2 \\sigma_{\\gamma_{\\mathrm{Fe}^{2+}}}^2 + \\left(\\frac{\\partial E}{\\partial c_{\\mathrm{Fe}^{2+}}}\\right)^2 \\sigma_{c_{\\mathrm{Fe}^{2+}}}^2$$\n我们计算必要的偏导数：\n1.  关于温度 $T$：\n    $$\\frac{\\partial E}{\\partial T} = \\frac{R}{F} \\ln\\left(\\frac{\\gamma_{\\mathrm{Fe}^{3+}} c_{\\mathrm{Fe}^{3+}}}{\\gamma_{\\mathrm{Fe}^{2+}} c_{\\mathrm{Fe}^{2+}}}\\right)$$\n2.  关于 $\\mathrm{Fe}^{3+}$ 的活度系数：\n    $$\\frac{\\partial E}{\\partial \\gamma_{\\mathrm{Fe}^{3+}}} = \\frac{RT}{F} \\frac{1}{\\gamma_{\\mathrm{Fe}^{3+}}}$$\n3.  关于 $\\mathrm{Fe}^{3+}$ 的浓度：\n    $$\\frac{\\partial E}{\\partial c_{\\mathrm{Fe}^{3+}}} = \\frac{RT}{F} \\frac{1}{c_{\\mathrm{Fe}^{3+}}}$$\n4.  关于 $\\mathrm{Fe}^{2+}$ 的活度系数：\n    $$\\frac{\\partial E}{\\partial \\gamma_{\\mathrm{Fe}^{2+}}} = -\\frac{RT}{F} \\frac{1}{\\gamma_{\\mathrm{Fe}^{2+}}}$$\n5.  关于 $\\mathrm{Fe}^{2+}$ 的浓度：\n    $$\\frac{\\partial E}{\\partial c_{\\mathrm{Fe}^{2+}}} = -\\frac{RT}{F} \\frac{1}{c_{\\mathrm{Fe}^{2+}}}$$\n\n将这些导数代入方差公式：\n$$\\sigma_E^2 = \\left[ \\frac{R}{F} \\ln\\left(\\frac{\\gamma_{\\mathrm{Fe}^{3+}} c_{\\mathrm{Fe}^{3+}}}{\\gamma_{\\mathrm{Fe}^{2+}} c_{\\mathrm{Fe}^{2+}}}\\right) \\right]^2 \\sigma_T^2 + \\left(\\frac{RT}{F \\gamma_{\\mathrm{Fe}^{3+}}}\\right)^2 \\sigma_{\\gamma_{\\mathrm{Fe}^{3+}}}^2 + \\left(\\frac{RT}{F c_{\\mathrm{Fe}^{3+}}}\\right)^2 \\sigma_{c_{\\mathrm{Fe}^{3+}}}^2 + \\left(\\frac{-RT}{F \\gamma_{\\mathrm{Fe}^{2+}}}\\right)^2 \\sigma_{\\gamma_{\\mathrm{Fe}^{2+}}}^2 + \\left(\\frac{-RT}{F c_{\\mathrm{Fe}^{2+}}}\\right)^2 \\sigma_{c_{\\mathrm{Fe}^{2+}}}^2$$\n这可以通过因式分解和使用相对标准不确定度的定义 $u_x = \\sigma_x/|x|$（因此 $\\sigma_x^2 = u_x^2 x^2$）来简化：\n$$\\sigma_E^2 = \\left[ \\frac{R}{F} \\ln\\left(\\frac{\\gamma_{\\mathrm{Fe}^{3+}} c_{\\mathrm{Fe}^{3+}}}{\\gamma_{\\mathrm{Fe}^{2+}} c_{\\mathrm{Fe}^{2+}}}\\right) \\right]^2 \\sigma_T^2 + \\left(\\frac{RT}{F}\\right)^2 \\left[ \\left(\\frac{\\sigma_{\\gamma_{\\mathrm{Fe}^{3+}}}}{\\gamma_{\\mathrm{Fe}^{3+}}}\\right)^2 + \\left(\\frac{\\sigma_{c_{\\mathrm{Fe}^{3+}}}}{c_{\\mathrm{Fe}^{3+}}}\\right)^2 + \\left(\\frac{\\sigma_{\\gamma_{\\mathrm{Fe}^{2+}}}}{\\gamma_{\\mathrm{Fe}^{2+}}}\\right)^2 + \\left(\\frac{\\sigma_{c_{\\mathrm{Fe}^{2+}}}}{c_{\\mathrm{Fe}^{2+}}}\\right)^2 \\right]$$\n$$\\sigma_E^2 = \\left[ \\frac{R}{F} \\ln\\left(\\frac{\\gamma_{\\mathrm{Fe}^{3+}} c_{\\mathrm{Fe}^{3+}}}{\\gamma_{\\mathrm{Fe}^{2+}} c_{\\mathrm{Fe}^{2+}}}\\right) \\right]^2 \\sigma_T^2 + \\left(\\frac{RT}{F}\\right)^2 \\left( u_{\\gamma_{\\mathrm{Fe}^{3+}}}^2 + u_{c_{\\mathrm{Fe}^{3+}}}^2 + u_{\\gamma_{\\mathrm{Fe}^{2+}}}^2 + u_{c_{\\mathrm{Fe}^{2+}}}^2 \\right)$$\n现在，我们代入给定的数值：\n$R = 8.314\\,462\\,618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $F = 96\\,485\\,\\mathrm{C\\,mol^{-1}}$, $T = 298.15\\,\\mathrm{K}$, $\\sigma_T = 0.20\\,\\mathrm{K}$。\n$\\gamma_{\\mathrm{Fe}^{3+}} = 0.30$, $c_{\\mathrm{Fe}^{3+}} = 1.00 \\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$。\n$\\gamma_{\\mathrm{Fe}^{2+}} = 0.60$, $c_{\\mathrm{Fe}^{2+}} = 1.00 \\times 10^{-2}\\,\\mathrm{mol\\,L^{-1}}$。\n相对标准不确定度为 $u_{\\gamma_{\\mathrm{Fe}^{3+}}} = u_{c_{\\mathrm{Fe}^{3+}}} = u_{\\gamma_{\\mathrm{Fe}^{2+}}} = u_{c_{\\mathrm{Fe}^{2+}}} = 0.05$。\n\n首先，计算自然对数的参数：\n$$\\frac{\\gamma_{\\mathrm{Fe}^{3+}} c_{\\mathrm{Fe}^{3+}}}{\\gamma_{\\mathrm{Fe}^{2+}} c_{\\mathrm{Fe}^{2+}}} = \\frac{0.30 \\times 1.00 \\times 10^{-3}}{0.60 \\times 1.00 \\times 10^{-2}} = \\frac{0.30 \\times 10^{-3}}{0.60 \\times 10^{-2}} = 0.5 \\times 10^{-1} = 0.05$$\n现在，我们计算总方差的两个主要组成部分：\n分量 1（来自温度不确定度）：\n$$\\left[ \\frac{R}{F} \\ln(0.05) \\right]^2 \\sigma_T^2 = \\left[ \\frac{8.31446}{96485} \\ln(0.05) \\right]^2 (0.20)^2$$\n$$\\ln(0.05) \\approx -2.99573$$\n$$ \\approx \\left[ (8.6173 \\times 10^{-5}) \\times (-2.99573) \\right]^2 (0.04) \\approx (-2.5813 \\times 10^{-4})^2 \\times 0.04$$\n$$ \\approx (6.6633 \\times 10^{-8}) \\times 0.04 \\approx 2.665 \\times 10^{-9}\\,\\mathrm{V}^2$$\n\n分量 2（来自浓度和活度系数不确定度）：\n相对不确定度的平方和为：\n$$u_{\\gamma_{\\mathrm{Fe}^{3+}}}^2 + u_{c_{\\mathrm{Fe}^{3+}}}^2 + u_{\\gamma_{\\mathrm{Fe}^{2+}}}^2 + u_{c_{\\mathrm{Fe}^{2+}}}^2 = 4 \\times (0.05)^2 = 4 \\times 0.0025 = 0.01$$\n预因子为：\n$$\\left(\\frac{RT}{F}\\right)^2 = \\left(\\frac{8.31446 \\times 298.15}{96485}\\right)^2 \\approx \\left(0.025693\\right)^2 \\approx 6.6011 \\times 10^{-4}\\,\\mathrm{V}^2$$\n方差的第二个分量是：\n$$(6.6011 \\times 10^{-4}) \\times 0.01 \\approx 6.6011 \\times 10^{-6}\\,\\mathrm{V}^2$$\n\n总方差 $\\sigma_E^2$ 是这两个分量之和：\n$$\\sigma_E^2 \\approx (2.665 \\times 10^{-9}) + (6.6011 \\times 10^{-6}) = 6.603765 \\times 10^{-6}\\,\\mathrm{V}^2$$\n标准不确定度 $\\sigma_E$ 是方差的平方根：\n$$\\sigma_E = \\sqrt{6.603765 \\times 10^{-6}\\,\\mathrm{V}^2} \\approx 2.56978 \\times 10^{-3}\\,\\mathrm{V}$$\n将结果四舍五入到三位有效数字，我们得到：\n$$\\sigma_E \\approx 2.57 \\times 10^{-3}\\,\\mathrm{V}$$",
            "answer": "$$\\boxed{2.57 \\times 10^{-3}}$$"
        },
        {
            "introduction": "本章的最终练习将从分析实验数据转向利用分子模拟从第一性原理计算电化学电势。此类模拟面临的一个主要挑战是，它们在有限尺寸的周期性边界盒子中进行，这会引入在宏观（热力学极限）体系中不存在的计算伪影。本练习将指导您完成一个核心的计算化学工作流程：如何通过对不同尺寸模拟盒子中计算出的化学势进行外推，来消除有限尺寸效应，从而获得准确的热力学极限值。",
            "id": "4244818",
            "problem": "您的任务是设计一个程序，该程序在周期性边界条件下模拟氧化还原物种分子模拟中的有限尺寸效应，并使用植根于基本定义的原则性方法，将平衡电极电势外推至热力学极限。该场景涉及从几个立方盒子长度的分子模拟中计算氧化态物种和还原态物种的过剩化学势。有限尺寸效应源于长程静电作用和有限盒子中被抑制的浓度涨落，这会使计算出的化学势偏离其热力学极限值。\n\n使用以下基本原理：\n- 物种 $i$ 的化学势，记为 $\\mu_i$，定义为在恒定温度 $T$、压力 $P$ 和所有其他物种的粒子数不变的情况下，吉布斯自由能对物种 $i$ 的粒子数求偏导数，即 $\\mu_i = \\left(\\partial G / \\partial N_i\\right)_{T,P,\\{N_{j \\neq i}\\}}$。\n- 对于形式为 $\\text{Ox} + n\\,e^- \\rightarrow \\text{Red}$ 的电极半反应，工作电极相对于参比电极的平衡电势 $E$ 由 Nernst 关系决定，该关系将反应自由能与活度联系起来：工作电极的电势为\n$$\nE_{\\text{work}} = -\\frac{\\Delta \\mu_{\\text{excess}}}{n F} + \\frac{R T}{n F} \\ln\\!\\left(\\frac{a_{\\text{Ox}}}{a_{\\text{Red}}}\\right),\n$$\n其中 $n$ 是转移的电子数，$F$ 是法拉第常数，$R$ 是理想气体常数，$T$ 是绝对温度，$a_{\\text{Ox}}$ 和 $a_{\\text{Red}}$ 分别是氧化态和还原态物种的活度，$\\Delta \\mu_{\\text{excess}} = \\mu_{\\text{Red}}^{\\infty} - \\mu_{\\text{Ox}}^{\\infty}$ 是热力学极限下过剩化学势的差值（不包括理想混合贡献）。\n- 在立方周期性边界条件（PBC）中，对过剩化学势的有限尺寸校正通常表现出与盒子长度的倒数成比例的主导项，以及由长程相互作用和被抑制的涨落引起的更高阶逆幂项。一个简约且具有物理动机的回归模型是\n$$\n\\mu_i(L) = \\mu_i^{\\infty} + \\frac{\\alpha_i}{L} + \\frac{\\beta_i}{L^3},\n$$\n其中 $L$ 是立方盒子的长度，$\\mu_i^{\\infty}$ 是物种 $i$ 的热力学极限过剩化学势，$\\alpha_i$ 和 $\\beta_i$ 是捕捉主导和次主导有限尺寸校正的系统相关系数。\n\n您的程序必须：\n1. 对于每个测试用例，接收（嵌入在程序中）一组盒子长度 $L$ 和相应的模拟过剩化学势 $\\mu_{\\text{Ox}}(L)$ 和 $\\mu_{\\text{Red}}(L)$（单位为焦耳/摩尔）。使用线性最小二乘法对上述模型进行拟合，以估计给定数据的 $\\mu_{\\text{Ox}}^{\\infty}$ 和 $\\mu_{\\text{Red}}^{\\infty}$。\n2. 使用拟合得到的 $\\mu_{\\text{Ox}}^{\\infty}$ 和 $\\mu_{\\text{Red}}^{\\infty}$，通过 Nernst 关系计算工作电极的平衡电势：\n$$\nE_{\\text{work}} = -\\frac{\\mu_{\\text{Red}}^{\\infty} - \\mu_{\\text{Ox}}^{\\infty}}{n F} + \\frac{R T}{n F} \\ln\\!\\left(\\frac{a_{\\text{Ox}}}{a_{\\text{Red}}}\\right).\n$$\n3. 报告相对于指定参比电极的电池电势为\n$$\nE_{\\text{cell}} = E_{\\text{work}} - E_{\\text{ref}},\n$$\n其中 $E_{\\text{ref}}$ 是参比电极电势。将每个最终结果以伏特（$\\mathrm{V}$）表示，并四舍五入到六位小数。\n\n使用的常数：\n- 理想气体常数 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$，\n- 法拉第常数 $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$。\n\n测试套件：\n提供三个测试用例，以检验该方法的不同方面。\n\n- 测试用例1（具有多个盒子尺寸和非平凡活度比的通用情况）：\n  - $L$ 值（单位为纳米）：$[2.0, 2.5, 3.0, 4.0]$。\n  - $\\mu_{\\text{Ox}}(L)$（单位为 $\\mathrm{J\\,mol^{-1}}$）：由 $\\mu_{\\text{Ox}}^{\\infty} = 5000$, $\\alpha_{\\text{Ox}} = 2000$, $\\beta_{\\text{Ox}} = -100000$ 生成，即 $\\mu_{\\text{Ox}}(L) = 5000 + 2000/L - 100000/L^3$。\n  - $\\mu_{\\text{Red}}(L)$（单位为 $\\mathrm{J\\,mol^{-1}}$）：由 $\\mu_{\\text{Red}}^{\\infty} = -5000$, $\\alpha_{\\text{Red}} = -2500$, $\\beta_{\\text{Red}} = 50000$ 生成，即 $\\mu_{\\text{Red}}(L) = -5000 - 2500/L + 50000/L^3$。\n  - $n = 1$, $T = 298.15\\ \\mathrm{K}$, $a_{\\text{Ox}} = 0.01$, $a_{\\text{Red}} = 1.0$, $E_{\\text{ref}} = 0.20\\ \\mathrm{V}$。\n\n- 测试用例2（活度项为零且 $n = 2$ 的边界情况）：\n  - $L$ 值（单位为纳米）：$[3.0, 4.0, 5.0, 6.0]$。\n  - $\\mu_{\\text{Ox}}(L)$（单位为 $\\mathrm{J\\,mol^{-1}}$）：由 $\\mu_{\\text{Ox}}^{\\infty} = 8000$, $\\alpha_{\\text{Ox}} = 1500$, $\\beta_{\\text{Ox}} = 0$ 生成，即 $\\mu_{\\text{Ox}}(L) = 8000 + 1500/L$。\n  - $\\mu_{\\text{Red}}(L)$（单位为 $\\mathrm{J\\,mol^{-1}}$）：由 $\\mu_{\\text{Red}}^{\\infty} = 0$, $\\alpha_{\\text{Red}} = -500$, $\\beta_{\\text{Red}} = 0$ 生成，即 $\\mu_{\\text{Red}}(L) = 0 - 500/L$。\n  - $n = 2$, $T = 298.15\\ \\mathrm{K}$, $a_{\\text{Ox}} = 1.0$, $a_{\\text{Red}} = 1.0$, $E_{\\text{ref}} = 0.0\\ \\mathrm{V}$。\n\n- 测试用例3（在高温下点数最少且混合校正阶数的边缘情况）：\n  - $L$ 值（单位为纳米）：$[2.5, 3.5, 5.0]$。\n  - $\\mu_{\\text{Ox}}(L)$（单位为 $\\mathrm{J\\,mol^{-1}}$）：由 $\\mu_{\\text{Ox}}^{\\infty} = -2000$, $\\alpha_{\\text{Ox}} = 0$, $\\beta_{\\text{Ox}} = 40000$ 生成，即 $\\mu_{\\text{Ox}}(L) = -2000 + 0/L + 40000/L^3$。\n  - $\\mu_{\\text{Red}}(L)$（单位为 $\\mathrm{J\\,mol^{-1}}$）：由 $\\mu_{\\text{Red}}^{\\infty} = -1000$, $\\alpha_{\\text{Red}} = 1000$, $\\beta_{\\text{Red}} = -30000$ 生成，即 $\\mu_{\\text{Red}}(L) = -1000 + 1000/L - 30000/L^3$。\n  - $n = 1$, $T = 350.0\\ \\mathrm{K}$, $a_{\\text{Ox}} = 0.1$, $a_{\\text{Red}} = 0.9$, $E_{\\text{ref}} = 0.10\\ \\mathrm{V}$。\n\n您的程序应生成单行输出，其中包含以逗号分隔、方括号括起来的结果列表，并四舍五入到六位小数，例如：$[r_1,r_2,r_3]$，其中每个 $r_i$ 是对应于第 $i$ 个测试用例计算出的 $E_{\\text{cell}}$（单位为伏特）。",
            "solution": "该问题是有效的。它提出了一个基于物理化学和计算科学既定原则的、定义明确的计算任务。该问题在科学上以 Nernst 方程和分子模拟中的有限尺寸效应模型为基础。它是一个适定问题，提供了所有必要的数据、常数和方程，以得出一个唯一的、可验证的解。其语言客观且无歧义。\n\n解决该问题的方法包括每个测试用例的两个主要步骤：首先，使用线性回归将模拟的过剩化学势外推至热力学极限（$L \\to \\infty$）；其次，使用这些外推值计算最终的电池电势。\n\n**步骤1：通过线性最小二乘法进行有限尺寸外推**\n\n问题提供了一个具有物理动机的模型，用于描述物种 $i$ 的过剩化学势 $\\mu_i$ 对立方盒子长度 $L$ 的依赖关系：\n$$\n\\mu_i(L) = \\mu_i^{\\infty} + \\frac{\\alpha_i}{L} + \\frac{\\beta_i}{L^3}\n$$\n此处，$\\mu_i^{\\infty}$、$\\alpha_i$ 和 $\\beta_i$ 是未知系数。目标是确定 $\\mu_i^{\\infty}$，即热力学极限下的过剩化学势。该方程代表了一个关于系数的线性模型。\n\n给定一组来自模拟的 $m$ 个数据点 $(L_j, \\mu_i(L_j))$，我们可以建立一个线性方程组。设物种 $i$ 的未知系数向量为 $\\mathbf{c}_i = [\\mu_i^{\\infty}, \\alpha_i, \\beta_i]^T$。所有 $m$ 个数据点的方程组可以写成矩阵形式 $\\mathbf{y}_i = \\mathbf{X}\\mathbf{c}_i$，其中：\n- $\\mathbf{y}_i = [\\mu_i(L_1), \\mu_i(L_2), \\dots, \\mu_i(L_m)]^T$ 是观测到的化学势向量。\n- $\\mathbf{X}$ 是设计矩阵，其行由模型的基函数 $[1, 1/L, 1/L^3]$ 在每个 $L_j$ 处的值构成：\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1  1/L_1  1/L_1^3 \\\\\n1  1/L_2  1/L_2^3 \\\\\n\\vdots  \\vdots  \\vdots \\\\\n1  1/L_m  1/L_m^3\n\\end{pmatrix}\n$$\n对于每个物种（氧化态 $\\text{Ox}$ 和还原态 $\\text{Red}$），我们使用线性最小二乘法求解该方程组以得到系数向量 $\\mathbf{c}_i$。最小二乘解使残差平方和最小化，并由 $\\mathbf{c}_i = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}_i$ 给出。这是一个在数值库中易于实现的标准程序。所得向量 $\\mathbf{c}_i$ 的第一个元素就是所需的热力学极限电势 $\\mu_i^{\\infty}$。此拟合过程分别对 $\\mu_{\\text{Ox}}(L)$ 和 $\\mu_{\\text{Red}}(L)$ 独立执行。\n\n**步骤2：平衡电池电势的计算**\n\n确定外推值 $\\mu_{\\text{Ox}}^{\\infty}$ 和 $\\mu_{\\text{Red}}^{\\infty}$ 后，热力学极限下过剩化学势的差值计算为 $\\Delta \\mu_{\\text{excess}} = \\mu_{\\text{Red}}^{\\infty} - \\mu_{\\text{Ox}}^{\\infty}$。\n\n然后将该值用于 Nernst 关系式中，以求得工作电极的平衡电势 $E_{\\text{work}}$：\n$$\nE_{\\text{work}} = -\\frac{\\Delta \\mu_{\\text{excess}}}{n F} + \\frac{R T}{n F} \\ln\\!\\left(\\frac{a_{\\text{Ox}}}{a_{\\text{Red}}}\\right)\n$$\n每个案例都提供了参数 $n$（电子数）、$T$（温度）、$a_{\\text{Ox}}$（氧化态物种的活度）和 $a_{\\text{Red}}$（还原态物种的活度）。常数 $R$（理想气体常数，$8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$）和 $F$（法拉第常数，$96485.33212\\ \\mathrm{C\\,mol^{-1}}$）也已给出。单位是一致的：$\\Delta\\mu_{\\text{excess}}$ 的单位是 $\\mathrm{J\\,mol^{-1}}$，$n$ 是无量纲的，$F$ 的单位是 $\\mathrm{C\\,mol^{-1}}$。比值 $\\mathrm{J}/\\mathrm{C}$ 得到伏特（$\\mathrm{V}$），符合要求。\n\n最后，相对于指定的参比电极电势 $E_{\\text{ref}}$ 计算电池电势 $E_{\\text{cell}}$：\n$$\nE_{\\text{cell}} = E_{\\text{work}} - E_{\\text{ref}}\n$$\n然后将每个测试用例得到的 $E_{\\text{cell}}$ 按要求四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the equilibrium cell potential for a series of test cases\n    by extrapolating simulated chemical potentials to the thermodynamic limit.\n    \"\"\"\n    # Define constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212  # C mol^-1\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L_nm\": np.array([2.0, 2.5, 3.0, 4.0]),\n            \"mu_ox_func\": lambda L: 5000 + 2000/L - 100000/L**3,\n            \"mu_red_func\": lambda L: -5000 - 2500/L + 50000/L**3,\n            \"n\": 1,\n            \"T_K\": 298.15,\n            \"a_ox\": 0.01,\n            \"a_red\": 1.0,\n            \"E_ref_V\": 0.20\n        },\n        {\n            \"L_nm\": np.array([3.0, 4.0, 5.0, 6.0]),\n            \"mu_ox_func\": lambda L: 8000 + 1500/L,\n            \"mu_red_func\": lambda L: -500/L,\n            \"n\": 2,\n            \"T_K\": 298.15,\n            \"a_ox\": 1.0,\n            \"a_red\": 1.0,\n            \"E_ref_V\": 0.0\n        },\n        {\n            \"L_nm\": np.array([2.5, 3.5, 5.0]),\n            \"mu_ox_func\": lambda L: -2000 + 40000/L**3,\n            \"mu_red_func\": lambda L: -1000 + 1000/L - 30000/L**3,\n            \"n\": 1,\n            \"T_K\": 350.0,\n            \"a_ox\": 0.1,\n            \"a_red\": 0.9,\n            \"E_ref_V\": 0.10\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Step 1: Extrapolate to the thermodynamic limit\n        L = case[\"L_nm\"]\n        \n        # Generate mu data from the provided functions\n        mu_ox_data = case[\"mu_ox_func\"](L)\n        mu_red_data = case[\"mu_red_func\"](L)\n\n        # Construct the design matrix X\n        # Columns correspond to basis functions: 1, 1/L, 1/L^3\n        X = np.vstack([np.ones(L.shape[0]), 1/L, 1/L**3]).T\n\n        # Perform linear least squares fit for Ox species\n        # The first element of the result vector is mu_infinity\n        coeffs_ox = np.linalg.lstsq(X, mu_ox_data, rcond=None)[0]\n        mu_ox_inf = coeffs_ox[0]\n\n        # Perform linear least squares fit for Red species\n        coeffs_red = np.linalg.lstsq(X, mu_red_data, rcond=None)[0]\n        mu_red_inf = coeffs_red[0]\n\n        # Step 2: Calculate the cell potential\n        delta_mu_excess = mu_red_inf - mu_ox_inf\n        n = case[\"n\"]\n        T = case[\"T_K\"]\n        \n        # Calculate the working electrode potential using the Nernst relation\n        # E_work = - (delta_mu_excess / (n*F)) + (R*T / (n*F)) * ln(a_ox/a_red)\n        potential_from_mu = -delta_mu_excess / (n * F)\n        \n        # Handle activity ratio to avoid log(0) if needed, though not in test cases\n        activity_ratio = case[\"a_ox\"] / case[\"a_red\"]\n        potential_from_activity = (R * T / (n * F)) * np.log(activity_ratio)\n        \n        E_work = potential_from_mu + potential_from_activity\n\n        # Calculate the cell potential relative to the reference electrode\n        E_cell = E_work - case[\"E_ref_V\"]\n        \n        # Append the rounded result to the list\n        results.append(round(E_cell, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}