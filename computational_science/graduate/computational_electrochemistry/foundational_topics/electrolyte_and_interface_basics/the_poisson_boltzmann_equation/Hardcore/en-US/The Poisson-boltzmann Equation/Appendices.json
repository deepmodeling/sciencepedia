{
    "hands_on_practices": [
        {
            "introduction": "A central challenge in computational electrochemistry is selecting a model with the right balance of accuracy and simplicity. This practice explores the fundamental differences between the full nonlinear Poisson-Boltzmann (NLPBE) equation and its common linearization, the Debye-Hückel theory. By deriving the analytical solutions for a charged plane and implementing them computationally, you will quantify the error of the linear approximation and develop an intuition for when it is valid—and when the full nonlinear treatment is essential .",
            "id": "3866522",
            "problem": "Consider a symmetric monovalent electrolyte adjacent to a uniformly charged, infinite planar surface. The solvent is treated as a continuum dielectric with relative permittivity $\\,\\epsilon\\,$, absolute permittivity $\\,\\epsilon\\epsilon_0\\,$, and temperature $\\,T\\,$. Let the surface at position $\\,x=0\\,$ carry a uniform free surface charge density $\\,\\sigma\\,$, and the electrolyte occupy the half-space $\\,x0\\,$ with bulk number concentration $\\,n_0\\,$ of cations and $\\,n_0\\,$ of anions (so that the bulk salt concentration is $\\,c_0=n_0/N_A\\,$ in $\\mathrm{mol\\,m^{-3}}$). Assume equilibrium and no fluid flow.\n\nStarting from first principles valid in computational chemical biology and electrostatics, specifically:\n- Gauss’s law in differential form (Poisson’s equation) $\\,\\nabla\\cdot\\left(\\epsilon\\epsilon_0\\nabla\\psi\\right)=-\\rho\\,$,\n- Boltzmann distributions $\\,c_\\pm(x)=n_0\\exp\\!\\left(\\mp \\dfrac{e\\psi(x)}{k_B T}\\right)\\,$ for monovalent ions in an electrostatic potential $\\,\\psi(x)\\,$,\n- The definition of the Debye screening parameter under small-potential linearization, and\n- Appropriate boundary conditions $\\,\\psi(\\infty)=0\\,$, $-\\epsilon\\epsilon_0\\,\\psi'(0)=\\sigma\\,$,\n\nderive, from these bases and without invoking any shortcut formulas, the relationship between surface charge density $\\,\\sigma\\,$ and surface potential $\\,\\psi_0=\\psi(0)\\,$ for both:\n1. The full nonlinear Poisson–Boltzmann (PB) description, and\n2. The linearized PB (Debye–Hückel) description in the small-potential regime.\n\nThen, implement a program that:\n- Uses the derived relationships to compute the surface potential predicted by the nonlinear PB, $\\,\\psi_0^{\\mathrm{NL}}\\,$, and by the linearized PB, $\\,\\psi_0^{\\mathrm{LIN}}\\,$, for each provided test case.\n- Quantifies the absolute relative error in the linear prediction with respect to the nonlinear prediction as the decimal fraction\n$$\\mathrm{err}=\\dfrac{\\left|\\psi_0^{\\mathrm{LIN}}-\\psi_0^{\\mathrm{NL}}\\right|}{\\left|\\psi_0^{\\mathrm{NL}}\\right|}.$$\n- Expresses all potentials in $\\mathrm{V}$ and the error as a unitless decimal fraction.\n\nUse the following physical constants precisely:\n- Elementary charge $\\,e=1.602176634\\times 10^{-19}\\,\\mathrm{C}\\,$,\n- Boltzmann constant $\\,k_B=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}\\,$,\n- Vacuum permittivity $\\,\\epsilon_0=8.8541878128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}\\,$,\n- Avogadro constant $\\,N_A=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}\\,$,\n- Temperature $\\,T=298\\,\\mathrm{K}\\,$.\n\nYour program must treat the given bulk salt concentrations $\\,c_0\\,$ in $\\mathrm{mol\\,m^{-3}}$ by converting them to number density $\\,n_0=N_A c_0\\,$ in $\\mathrm{m^{-3}}$. For the linearized PB, use the planar solution consistent with the boundary condition to relate $\\,\\sigma\\,$ and $\\,\\psi_0\\,$ via the Debye screening parameter $\\,\\kappa\\,$, where $\\,\\kappa^2=\\dfrac{2 e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\\,$ for a symmetric monovalent electrolyte.\n\nTest suite. For coverage across regimes, use the following parameter sets $(\\sigma, c_0, \\epsilon)$, with $\\,\\sigma\\,$ in $\\mathrm{C\\,m^{-2}}$, $\\,c_0\\,$ in $\\mathrm{mol\\,m^{-3}}$, and $\\,\\epsilon\\,$ dimensionless:\n- Case A (typical aqueous, moderate charge, moderate salt): $\\,\\sigma=-2.0\\times 10^{-2}\\,,\\;c_0=100\\,,\\;\\epsilon=78.5\\,$.\n- Case B (small charge, low salt): $\\,\\sigma=-1.0\\times 10^{-4}\\,,\\;c_0=1\\,,\\;\\epsilon=78.5\\,$.\n- Case C (large charge, reduced permittivity, moderate salt): $\\,\\sigma=-2.0\\times 10^{-1}\\,,\\;c_0=10\\,,\\;\\epsilon=40\\,$.\n- Case D (moderate charge, high salt): $\\,\\sigma=-1.0\\times 10^{-2}\\,,\\;c_0=1000\\,,\\;\\epsilon=78.5\\,$.\n- Case E (zero charge boundary case): $\\,\\sigma=0.0\\,,\\;c_0=100\\,,\\;\\epsilon=78.5\\,$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list ordered as $[\\psi_0^{\\mathrm{NL}},\\ \\psi_0^{\\mathrm{LIN}},\\ \\mathrm{err}]$ for the corresponding test case, for example $[[a_1,b_1,e_1],[a_2,b_2,e_2],\\dots]$. All $\\psi_0$ values must be in $\\mathrm{V}$ and all errors must be decimal fractions.",
            "solution": "The user-provided problem is evaluated as valid according to the specified criteria. It is scientifically grounded in the principles of electrostatics and statistical mechanics, well-posed with sufficient information for a unique solution, and stated in objective, formal language. The problem requires the derivation and application of the Poisson-Boltzmann (PB) model, which is a standard and central topic in computational chemical biology.\n\nThe derivation and solution proceed as follows.\n\nThe system consists of an infinite planar surface with uniform surface charge density $\\sigma$ at $x=0$, and a symmetric monovalent electrolyte in the half-space $x0$. The solvent is a continuum dielectric with relative permittivity $\\epsilon$ at temperature $T$. The electrolyte has a bulk ion number concentration of $n_0$.\n\nThe fundamental relationship between the electrostatic potential $\\psi$ and the charge density $\\rho$ is given by Poisson's equation. For a one-dimensional system where the potential $\\psi$ varies only with the distance $x$ from the surface, this is:\n$$\n\\frac{d}{dx}\\left(\\epsilon\\epsilon_0 \\frac{d\\psi}{dx}\\right) = -\\rho(x)\n$$\nAssuming a uniform dielectric, $\\epsilon$ is constant, and the equation simplifies to:\n$$\n\\frac{d^2\\psi}{dx^2} = -\\frac{\\rho(x)}{\\epsilon\\epsilon_0}\n$$\nThe charge density $\\rho(x)$ arises from the mobile ions in the electrolyte. For a symmetric $1:1$ electrolyte, the number concentrations of cations, $n_+(x)$, and anions, $n_-(x)$, are given by the Boltzmann distribution:\n$$\nn_+(x) = n_0 \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n$$\nn_-(x) = n_0 \\exp\\left(+\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nwhere $e$ is the elementary charge, $k_B$ is the Boltzmann constant, and $n_0$ is the bulk number concentration of each ionic species. The net charge density is the sum of the charge contributions from cations (charge $+e$) and anions (charge $-e$):\n$$\n\\rho(x) = e n_+(x) - e n_-(x) = e n_0 \\left[ \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right) - \\exp\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\right]\n$$\nUsing the identity $2\\sinh(y) = e^y - e^{-y}$, the charge density can be expressed as:\n$$\n\\rho(x) = -2en_0 \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nSubstituting this into Poisson's equation gives the full one-dimensional nonlinear Poisson-Boltzmann (PB) equation:\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\epsilon\\epsilon_0} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nTo solve this equation for the relationship between surface charge $\\sigma$ and surface potential $\\psi_0 = \\psi(0)$, we use an integration technique. Multiplying both sides by $2\\frac{d\\psi}{dx}$:\n$$\n2\\frac{d\\psi}{dx}\\frac{d^2\\psi}{dx^2} = \\frac{4en_0}{\\epsilon\\epsilon_0} \\frac{d\\psi}{dx} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nThe left side is the derivative of $(\\frac{d\\psi}{dx})^2$ with respect to $x$. The right side can also be expressed as a derivative. We can write:\n$$\n\\frac{d}{dx}\\left(\\left(\\frac{d\\psi}{dx}\\right)^2\\right) = \\frac{4en_0}{\\epsilon\\epsilon_0} \\left(\\frac{k_B T}{e}\\right) \\frac{d}{dx}\\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\nIntegrating from a position $x$ to infinity, and applying the boundary conditions that the potential and its gradient vanish far from the surface, i.e., $\\psi(\\infty)=0$ and $(\\frac{d\\psi}{dx})_{x\\to\\infty}=0$:\n$$\n\\int_x^\\infty \\frac{d}{dx'}\\left(\\left(\\frac{d\\psi}{dx'}\\right)^2\\right) dx' = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\int_x^\\infty \\frac{d}{dx'}\\left(\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right) dx'\n$$\n$$\n\\left[\\left(\\frac{d\\psi}{dx'}\\right)^2\\right]_x^\\infty = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left[\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right]_x^\\infty\n$$\n$$\n0 - \\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\cosh(0) - \\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right) - 1\\right)\n$$\nUsing the identity $\\cosh(y) - 1 = 2\\sinh^2(y/2)$, we obtain:\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{8n_0 k_B T}{\\epsilon\\epsilon_0} \\sinh^2\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\nTaking the square root gives the electric field:\n$$\n\\frac{d\\psi}{dx} = -\\text{sgn}(\\psi_0) \\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\left|\\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\\right|\n$$\nA simpler way to handle the sign is to recognize that for $\\psi_00$, $\\psi(x)$ decreases, so $\\psi'  0$. For $\\psi_00$, $\\psi(x)$ increases, so $\\psi'  0$. And $\\sinh(y)$ has the same sign as $y$. This means the product $\\psi' \\cdot \\sinh(e\\psi/2k_BT)$ is always non-positive. We thus take the negative root:\n$$\n\\frac{d\\psi}{dx} = -\\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\nThe boundary condition at the charged surface is derived from Gauss's law for a planar surface: $-\\epsilon\\epsilon_0 \\left(\\frac{d\\psi}{dx}\\right)_{x=0} = \\sigma$. Substituting our expression for the derivative at $x=0$:\n$$\n-\\epsilon\\epsilon_0 \\left( -\\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right) \\right) = \\sigma\n$$\nThis simplifies to the Grahame equation, which relates the surface charge density $\\sigma$ to the surface potential $\\psi_0$:\n$$\n\\sigma = \\sqrt{8n_0 k_B T \\epsilon\\epsilon_0} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right)\n$$\nTo find the surface potential $\\psi_0^{\\mathrm{NL}}$ for the full nonlinear PB model, we solve for $\\psi_0$:\n$$\n\\sinh\\left(\\frac{e\\psi_0^{\\mathrm{NL}}}{2k_B T}\\right) = \\frac{\\sigma}{\\sqrt{8n_0 k_B T \\epsilon\\epsilon_0}}\n$$\n$$\n\\psi_0^{\\mathrm{NL}} = \\frac{2k_B T}{e} \\text{arsinh}\\left(\\frac{\\sigma}{\\sqrt{8n_0 k_B T \\epsilon\\epsilon_0}}\\right)\n$$\n\nFor the linearized PB (Debye-Hückel) description, we assume the potential is small, i.e., $|e\\psi(x)| \\ll k_B T$. This allows the linearization $\\sinh(y) \\approx y$. The PB equation becomes:\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\epsilon\\epsilon_0} \\left(\\frac{e\\psi(x)}{k_B T}\\right) = \\left(\\frac{2e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\\right) \\psi(x)\n$$\nThis is the linearized Poisson-Boltzmann equation. The term in parenthesis is the square of the Debye screening parameter, $\\kappa$:\n$$\n\\kappa^2 = \\frac{2e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\n$$\nThe equation is now $\\frac{d^2\\psi}{dx^2} = \\kappa^2 \\psi$. The general solution is $\\psi(x) = A e^{-\\kappa x} + B e^{\\kappa x}$. Applying the boundary condition $\\psi(\\infty)=0$ requires $B=0$. The solution is $\\psi(x) = A e^{-\\kappa x}$. At the surface, $\\psi(0) = \\psi_0 = A$, so $\\psi(x) = \\psi_0 e^{-\\kappa x}$.\n\nTo find the relationship between $\\sigma$ and $\\psi_0$, we use the second boundary condition, $-\\epsilon\\epsilon_0 \\psi'(0) = \\sigma$. The derivative is $\\psi'(x) = -\\kappa\\psi_0 e^{-\\kappa x}$, so $\\psi'(0) = -\\kappa\\psi_0$.\n$$\n-\\epsilon\\epsilon_0(-\\kappa \\psi_0) = \\sigma\n$$\n$$\n\\epsilon\\epsilon_0 \\kappa \\psi_0 = \\sigma\n$$\nSolving for the surface potential $\\psi_0^{\\mathrm{LIN}}$ in the linearized approximation yields:\n$$\n\\psi_0^{\\mathrm{LIN}} = \\frac{\\sigma}{\\epsilon\\epsilon_0 \\kappa}\n$$\nThe program will compute $\\psi_0^{\\mathrm{NL}}$ and $\\psi_0^{\\mathrm{LIN}}$ using these derived expressions and then calculate the relative error $\\mathrm{err} = |\\psi_0^{\\mathrm{LIN}} - \\psi_0^{\\mathrm{NL}}| / |\\psi_0^{\\mathrm{NL}}|$. For the special case $\\sigma=0$, both $\\psi_0^{\\mathrm{NL}}$ and $\\psi_0^{\\mathrm{LIN}}$ are $0$, and the error is defined as $0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates surface potentials for a charged planar surface\n    in an electrolyte using both nonlinear and linearized Poisson-Boltzmann theory.\n    \"\"\"\n\n    # Define physical constants\n    E = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23     # Boltzmann constant in J/K\n    EPS_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n    NA = 6.02214076e23   # Avogadro constant in mol^-1\n    T = 298.0              # Temperature in K\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (sigma, c0, epsilon)\n    # sigma: surface charge density in C/m^2\n    # c0: bulk salt concentration in mol/m^3\n    # epsilon: relative permittivity (dimensionless)\n    test_cases = [\n        (-2.0e-2, 100.0, 78.5),   # Case A\n        (-1.0e-4, 1.0, 78.5),     # Case B\n        (-2.0e-1, 10.0, 40.0),    # Case C\n        (-1.0e-2, 1000.0, 78.5),  # Case D\n        (0.0, 100.0, 78.5),       # Case E\n    ]\n\n    results = []\n    for sigma, c0, epsilon in test_cases:\n        # Convert bulk concentration c0 (mol/m^3) to number density n0 (m^-3)\n        n0 = c0 * NA\n        \n        # Handle the special case where surface charge is zero\n        if sigma == 0.0:\n            psi0_nl = 0.0\n            psi0_lin = 0.0\n            err = 0.0\n            results.append([psi0_nl, psi0_lin, err])\n            continue\n            \n        # --- Nonlinear Poisson-Boltzmann (NL) calculation ---\n        # Formula: psi0_nl = (2 * kB * T / e) * arsinh(sigma / sqrt(8 * n0 * kB * T * epsilon * epsilon0))\n        denom_nl = np.sqrt(8 * n0 * KB * T * epsilon * EPS_0)\n        arg_arsinh = sigma / denom_nl\n        psi0_nl = (2 * KB * T / E) * np.arcsinh(arg_arsinh)\n\n        # --- Linearized Poisson-Boltzmann (LIN) calculation ---\n        # Formula: psi0_lin = sigma / (epsilon * epsilon0 * kappa)\n        # where kappa = sqrt(2 * e^2 * n0 / (epsilon * epsilon0 * kB * T))\n        kappa_sq = (2 * E**2 * n0) / (epsilon * EPS_0 * KB * T)\n        kappa = np.sqrt(kappa_sq)\n        psi0_lin = sigma / (epsilon * EPS_0 * kappa)\n\n        # --- Error Calculation ---\n        # Formula: err = |psi0_lin - psi0_nl| / |psi0_nl|\n        # The case psi0_nl = 0 (i.e., sigma = 0) is handled above.\n        err = np.abs(psi0_lin - psi0_nl) / np.abs(psi0_nl)\n\n        results.append([psi0_nl, psi0_lin, err])\n\n    # Final print statement in the exact required format.\n    # Format each inner list to a string '[v1,v2,v3]' and join them.\n    formatted_results = [\n        f\"[{','.join(f'{val:.8e}' for val in res)}]\" for res in results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Numerical solutions to the Poisson-Boltzmann equation are necessarily computed within a finite domain, which introduces artifacts from artificial boundary conditions. This exercise provides a rigorous method to quantify the error introduced by truncating the simulation space and imposing a common Dirichlet boundary condition. By analyzing the linearized PBE for a point charge, you will derive an analytical expression for the required buffer thickness, a crucial parameter for ensuring the accuracy of electrostatic simulations in biomolecular and materials science .",
            "id": "3866532",
            "problem": "Consider the linearized Poisson–Boltzmann equation (LPB) in three dimensions for the dimensionless reduced electrostatic potential $\\,\\psi(\\mathbf{r})\\,$ created by a single point-like solute of valence $\\,z\\,$ centered at the origin in a homogeneous ionic solution of relative permittivity and temperature such that the Bjerrum length is $\\,\\ell_B\\,$ (expressed in nanometers). The linearized Poisson–Boltzmann equation is a screened Poisson equation, and the screening strength is characterized by the Debye screening parameter $\\,\\kappa\\,$ (expressed in inverse nanometers). In spherical coordinates under the assumption of spherical symmetry, you consider a finite computational ball of radius $\\,R\\,$ with Dirichlet boundary condition $\\,\\psi(R)=0\\,$. The infinite-domain reference solution corresponds to the same governing equation but without truncation at $\\,R\\,$.\n\nYour task is to quantify how truncating the domain and imposing the Dirichlet boundary condition biases the interior potentials, and to propose a buffer thickness that guarantees the absolute bias does not exceed a prescribed threshold. Specifically:\n\n1. Start from fundamental physical and mathematical bases appropriate for computational chemical biology:\n   - Use the electrostatic Poisson equation coupled with Boltzmann statistics for mobile ions, and invoke the small-potential limit to obtain the linearized Poisson–Boltzmann equation for the reduced potential $\\,\\psi\\,$.\n   - Use spherical symmetry for a single point-like solute at the origin so that the governing equation reduces to a one-dimensional radial ordinary differential equation for $\\,\\psi(r)\\,$.\n\n2. Define the bias $\\,\\Delta(r;R)\\,$ as the difference between the finite-domain Dirichlet solution evaluated at radius $\\,r\\,$ and the infinite-domain reference solution at the same $\\,r\\,$.\n\n3. For a given domain-of-interest radius $\\,r_d\\,$ (expressed in nanometers), find the minimal computational radius $\\,R\\,$ (with $\\,R \\ge r_d\\,$) such that the maximum absolute bias over all points $\\,r \\in [0,r_d]\\,$ is less than or equal to a specified threshold $\\,\\tau\\,$ (dimensionless, in units of the reduced potential). Report the buffer thickness $\\,B = R - r_d\\,$ in nanometers. Your derivation must rely only on the bases stated above and not introduce unjustified shortcut formulas.\n\n4. Your program must implement the derived expression for the minimal buffer thickness $\\,B\\,$ and evaluate it for the test suite below. Distances must be in nanometers, $\\,\\kappa\\,$ must be in inverse nanometers, $\\,\\ell_B\\,$ must be in nanometers, and the threshold $\\,\\tau\\,$ is dimensionless. Output the buffer thicknesses $\\,B\\,$ rounded to six decimal places.\n\nTest suite (each case is $\\,(\\,z\\,,\\,\\kappa\\,,\\,r_d\\,,\\,\\tau\\,,\\,\\ell_B\\,)\\,$):\n- Case 1 (general case with moderate screening): $(1,\\;0.1,\\;1.0,\\;0.01,\\;0.714)$.\n- Case 2 (stronger screening, higher valence): $(2,\\;0.5,\\;2.0,\\;0.005,\\;0.714)$.\n- Case 3 (weak screening relative to domain, very tight error threshold): $(4,\\;0.2,\\;3.0,\\;0.0001,\\;0.714)$.\n- Case 4 (short-range screening, small domain-of-interest): $(1,\\;1.0,\\;0.5,\\;0.02,\\;0.714)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the buffer thickness results for the four test cases as a comma-separated list enclosed in square brackets. Each entry must be the buffer thickness $\\,B\\,$ rounded to six decimal places in nanometers, for example: \"[12.345678,3.210000, ...]\".",
            "solution": "The user-provided problem statement is valid. It is scientifically grounded in the principles of physical chemistry, specifically the Poisson-Boltzmann theory, and poses a well-defined mathematical problem regarding the numerical solution of partial differential equations. The parameters and context are standard in computational chemical biology. We will now proceed with a complete solution.\n\nThe problem requires a derivation of the necessary buffer thickness for a spherical computational domain used to solve the linearized Poisson-Boltzmann (LPB) equation. The goal is to ensure that the error, or bias, introduced by the domain truncation and an artificial Dirichlet boundary condition remains below a specified threshold $\\tau$ within a domain of interest of radius $r_d$.\n\n**1. The Linearized Poisson-Boltzmann Equation**\n\nThe electrostatic potential $\\Phi(\\mathbf{r})$ in an ionic solution is described by the Poisson equation:\n$$ \\nabla^2 \\Phi(\\mathbf{r}) = -\\frac{1}{\\epsilon} \\rho(\\mathbf{r}) $$\nwhere $\\epsilon = \\epsilon_0 \\epsilon_r$ is the dielectric permittivity of the medium and $\\rho(\\mathbf{r})$ is the total charge density. The charge density is composed of the fixed charge density of the solute, $\\rho_{\\text{fix}}(\\mathbf{r})$, and the charge density from mobile ions in the solvent, $\\rho_{\\text{mob}}(\\mathbf{r})$.\nFor a single point-like solute of valence $z$ at the origin, the fixed charge is $q = ze_c$ (with $e_c$ being the elementary charge), and its charge density is represented by a Dirac delta function: $\\rho_{\\text{fix}}(\\mathbf{r}) = ze_c \\delta(\\mathbf{r})$.\n\nThe mobile ion density is described by a Boltzmann distribution. For a symmetric $1:1$ electrolyte of bulk concentration $c_0$, the density is:\n$$ \\rho_{\\text{mob}}(\\mathbf{r}) = c_0 e_c \\left( e^{-e_c \\Phi(\\mathbf{r}) / (k_B T)} - e^{+e_c \\Phi(\\mathbf{r}) / (k_B T)} \\right) = -2c_0 e_c \\sinh\\left(\\frac{e_c \\Phi(\\mathbf{r})}{k_B T}\\right) $$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nIntroducing the dimensionless reduced potential $\\psi(\\mathbf{r}) = \\frac{e_c \\Phi(\\mathbf{r})}{k_B T}$, the full Poisson-Boltzmann equation becomes:\n$$ \\nabla^2 \\psi(\\mathbf{r}) = -\\frac{z e_c^2 \\delta(\\mathbf{r})}{\\epsilon k_B T} + \\frac{2c_0 e_c^2}{\\epsilon k_B T} \\sinh(\\psi(\\mathbf{r})) $$\nThis equation can be simplified using two standard parameters. The Bjerrum length, $\\ell_B$, is the distance at which the electrostatic interaction energy between two elementary charges equals the thermal energy scale:\n$$ \\ell_B = \\frac{e_c^2}{4\\pi \\epsilon k_B T} $$\nThe Debye screening parameter, $\\kappa$, characterizes the electrostatic screening by the mobile ions:\n$$ \\kappa^2 = \\frac{2 c_0 e_c^2}{\\epsilon k_B T} $$\nUsing these definitions, the equation becomes: $\\nabla^2 \\psi(\\mathbf{r}) = -4\\pi z \\ell_B \\delta(\\mathbf{r}) + \\kappa^2 \\sinh(\\psi(\\mathbf{r}))$.\n\nThe problem specifies the linearized Poisson-Boltzmann (LPB) equation, which is valid in the small-potential limit ($\\psi \\ll 1$), where $\\sinh(\\psi) \\approx \\psi$. This yields a linear, second-order partial differential equation:\n$$ \\nabla^2 \\psi(\\mathbf{r}) - \\kappa^2 \\psi(\\mathbf{r}) = -4\\pi z \\ell_B \\delta(\\mathbf{r}) $$\n\n**2. Solution in Spherical Coordinates**\n\nFor a point charge at the origin, the system is spherically symmetric, so the potential $\\psi$ depends only on the radial distance $r = |\\mathbf{r}|$. The Laplacian operator in spherical coordinates simplifies to $\\nabla^2 \\psi(r) = \\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{d\\psi}{dr}\\right)$. For $r  0$, the source term $\\delta(\\mathbf{r})$ is zero, and the LPB equation becomes:\n$$ \\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{d\\psi}{dr}\\right) - \\kappa^2 \\psi(r) = 0 $$\nBy substituting $u(r) = r\\psi(r)$, this equation simplifies to a standard second-order ODE with constant coefficients:\n$$ u''(r) - \\kappa^2 u(r) = 0 $$\nThe general solution for $u(r)$ is $u(r) = C_1 e^{\\kappa r} + C_2 e^{-\\kappa r}$. This gives the general solution for the potential $\\psi(r)$:\n$$ \\psi(r) = \\frac{C_1 e^{\\kappa r} + C_2 e^{-\\kappa r}}{r} $$\n\n**3. Infinite-Domain and Finite-Domain Solutions**\n\nWe now solve for the potential under two different boundary conditions.\n\n*   **Infinite-Domain Reference Solution, $\\psi_{\\infty}(r)$**:\n    The physical boundary condition for an infinite domain is that the potential must vanish at infinity: $\\lim_{r\\to\\infty} \\psi(r) = 0$. This requires the coefficient of the exponentially growing term, $C_1$, to be zero. Thus, $\\psi_{\\infty}(r) = \\frac{C_2 e^{-\\kappa r}}{r}$. The constant $C_2$ is determined by the behavior near the source at $r=0$. As $r \\to 0$, the screening effect becomes negligible, and the potential must approach the unscreened Coulomb potential of the point charge: $\\psi(r) \\approx z\\ell_B/r$. Comparing this to $\\lim_{r\\to 0} \\psi_{\\infty}(r) = C_2/r$, we find $C_2 = z\\ell_B$. The infinite-domain solution, known as the screened Coulomb or Yukawa potential, is therefore:\n    $$ \\psi_{\\infty}(r) = z\\ell_B \\frac{e^{-\\kappa r}}{r} $$\n\n*   **Finite-Domain Dirichlet Solution, $\\psi_{R}(r)$**:\n    For a finite computational ball of radius $R$, the artificial boundary condition is $\\psi_R(R)=0$. We use the general solution $\\psi(r) = \\frac{1}{r} (C_1 e^{\\kappa r} + C_2 e^{-\\kappa r})$. The behavior at the origin still requires $\\lim_{r\\to 0} r\\psi_R(r) = z\\ell_B$, which implies $C_1 + C_2 = z\\ell_B$. The boundary condition at $r=R$ implies $C_1 e^{\\kappa R} + C_2 e^{-\\kappa R} = 0$. Solving this system for $C_1$ and $C_2$ yields:\n    $C_1 = -z\\ell_B \\frac{e^{-2\\kappa R}}{1 - e^{-2\\kappa R}}$ and $C_2 = \\frac{z\\ell_B}{1 - e^{-2\\kappa R}}$.\n    A more elegant approach uses hyperbolic functions. The general solution for $u(r) = r\\psi(r)$ can be written as $u(r) = A\\cosh(\\kappa r) + B\\sinh(\\kappa r)$. The condition at the origin gives $\\lim_{r \\to 0} u(r) = A = z\\ell_B$. The boundary condition $\\psi_R(R)=0$ implies $u(R)=0$, so $z\\ell_B\\cosh(\\kappa R) + B\\sinh(\\kappa R) = 0$, which gives $B = -z\\ell_B \\frac{\\cosh(\\kappa R)}{\\sinh(\\kappa R)}$. Substituting back gives:\n    $u(r) = z\\ell_B \\left( \\cosh(\\kappa r) - \\frac{\\cosh(\\kappa R)}{\\sinh(\\kappa R)}\\sinh(\\kappa r) \\right) = \\frac{z\\ell_B}{\\sinh(\\kappa R)} (\\cosh(\\kappa r)\\sinh(\\kappa R) - \\sinh(\\kappa r)\\cosh(\\kappa R))$.\n    Using the identity for $\\sinh(x-y)$, we get $u(r) = z\\ell_B \\frac{\\sinh(\\kappa(R-r))}{\\sinh(\\kappa R)}$. The finite-domain solution is thus:\n    $$ \\psi_R(r) = \\frac{z\\ell_B}{r} \\frac{\\sinh(\\kappa(R-r))}{\\sinh(\\kappa R)} $$\n\n**4. Bias Analysis and Buffer Thickness Derivation**\n\nThe bias is defined as the difference between the finite-domain and infinite-domain solutions:\n$$ \\Delta(r; R) = \\psi_R(r) - \\psi_{\\infty}(r) = \\frac{z\\ell_B}{r} \\left( \\frac{\\sinh(\\kappa(R-r))}{\\sinh(\\kappa R)} - e^{-\\kappa r} \\right) $$\nWe can simplify the term in the parenthesis:\n$$ \\frac{\\sinh(\\kappa(R-r))}{\\sinh(\\kappa R)} - e^{-\\kappa r} = \\frac{e^{\\kappa R}e^{-\\kappa r} - e^{-\\kappa R}e^{\\kappa r}}{e^{\\kappa R} - e^{-\\kappa R}} - e^{-\\kappa r} = \\frac{(e^{\\kappa R}e^{-\\kappa r} - e^{-\\kappa R}e^{\\kappa r}) - e^{-\\kappa r}(e^{\\kappa R} - e^{-\\kappa R})}{e^{\\kappa R}-e^{-\\kappa R}} = \\frac{-e^{-\\kappa R}e^{\\kappa r} + e^{-\\kappa R}e^{-\\kappa r}}{e^{\\kappa R}-e^{-\\kappa R}} = \\frac{-e^{-\\kappa R}(e^{\\kappa r}-e^{-\\kappa r})}{e^{\\kappa R}-e^{-\\kappa R}} = -e^{-\\kappa R}\\frac{\\sinh(\\kappa r)}{\\sinh(\\kappa R)} $$\nThis gives a compact expression for the bias:\n$$ \\Delta(r; R) = - \\frac{z\\ell_B}{r} \\frac{e^{-\\kappa R}\\sinh(\\kappa r)}{\\sinh(\\kappa R)} $$\nThe task is to find the minimum $R \\ge r_d$ such that $\\max_{r \\in [0, r_d]} |\\Delta(r; R)| \\le \\tau$. The absolute bias is:\n$$ |\\Delta(r; R)| = |z|\\ell_B \\frac{e^{-\\kappa R}}{|\\sinh(\\kappa R)|} \\frac{|\\sinh(\\kappa r)|}{r} $$\nFor physically relevant parameters, $\\kappa  0$ and $R  0$, so $\\sinh(\\kappa R)0$. With $r \\ge 0$, $\\sinh(\\kappa r) \\ge 0$. The expression simplifies to:\n$$ |\\Delta(r; R)| = |z|\\ell_B \\frac{e^{-\\kappa R}}{\\sinh(\\kappa R)} \\left( \\frac{\\sinh(\\kappa r)}{r} \\right) $$\nTo find the maximum of this function with respect to $r$ on the interval $[0, r_d]$, we analyze the term $f(r) = \\frac{\\sinh(\\kappa r)}{r}$. Its derivative is $f'(r) = \\frac{\\kappa r \\cosh(\\kappa r) - \\sinh(\\kappa r)}{r^2}$. For $\\kappa r  0$, it is a known property that $\\tanh(x)  x$, which implies $\\sinh(x)  x \\cosh(x)$. Therefore, the numerator is always positive for $r0$, meaning $f(r)$ is a strictly increasing function of $r$. The maximum value of $|\\Delta(r; R)|$ on the interval $[0, r_d]$ must therefore occur at the boundary $r=r_d$.\n\nThe condition on the buffer becomes:\n$$ |\\Delta(r_d; R)| = |z|\\ell_B \\frac{e^{-\\kappa R}}{\\sinh(\\kappa R)} \\frac{\\sinh(\\kappa r_d)}{r_d} \\le \\tau $$\nWe can rewrite the $R$-dependent term as $\\frac{e^{-\\kappa R}}{\\sinh(\\kappa R)} = \\frac{2}{e^{2\\kappa R} - 1}$. The inequality becomes:\n$$ \\frac{2}{e^{2\\kappa R} - 1} \\le \\frac{\\tau r_d}{|z|\\ell_B \\sinh(\\kappa r_d)} $$\nSince the left hand side is a decreasing function of $R$, the minimal $R$ that satisfies this condition is found by solving the equality:\n$$ e^{2\\kappa R} - 1 = \\frac{2|z|\\ell_B \\sinh(\\kappa r_d)}{\\tau r_d} \\implies R = \\frac{1}{2\\kappa} \\ln\\left(1 + \\frac{2|z|\\ell_B \\sinh(\\kappa r_d)}{\\tau r_d}\\right) $$\nThis expression gives the required computational radius $R$. The requested buffer thickness is $B = R - r_d$. If this calculation yields an $R  r_d$, it means that a computational radius of $r_d$ (i.e., a zero buffer) is already sufficient to meet the error tolerance. Thus, the minimal required buffer thickness is given by:\n$$ B = \\max\\left(0, \\frac{1}{2\\kappa} \\ln\\left(1 + \\frac{2|z|\\ell_B \\sinh(\\kappa r_d)}{\\tau r_d}\\right) - r_d\\right) $$\nThis is the final expression to be implemented.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the minimal buffer thickness for solving the linearized Poisson-Boltzmann\n    equation in a finite spherical domain.\n    \"\"\"\n    \n    # Test cases: (z, kappa, r_d, tau, l_B)\n    # z: solute valence (dimensionless)\n    # kappa: Debye screening parameter (nm^-1)\n    # r_d: domain-of-interest radius (nm)\n    # tau: absolute bias threshold (dimensionless)\n    # l_B: Bjerrum length (nm)\n    test_cases = [\n        (1, 0.1, 1.0, 0.01, 0.714),\n        (2, 0.5, 2.0, 0.005, 0.714),\n        (4, 0.2, 3.0, 0.0001, 0.714),\n        (1, 1.0, 0.5, 0.02, 0.714)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        z, kappa, r_d, tau, l_B = case\n\n        # Derived formula for the minimal computational radius R.\n        # R = (1/(2*kappa)) * ln(1 + (2*|z|*l_B*sinh(kappa*r_d)) / (tau*r_d))\n        \n        # Absolute value of z should be used as per the derivation of the absolute bias.\n        abs_z = np.abs(z)\n\n        # To avoid potential division by zero if r_d is zero, although problem constraints\n        # imply r_d > 0.\n        if r_d == 0:\n            # At r_d = 0, the problem is ill-defined. In the limit r_d -> 0, sinh(kappa*r_d)/r_d -> kappa.\n            # However, the physical scenario and bias definition become ambiguous at the point charge.\n            # Assuming r_d > 0 based on the problem context.\n            pass\n\n        # Argument inside the logarithm\n        log_argument = 1.0 + (2.0 * abs_z * l_B * np.sinh(kappa * r_d)) / (tau * r_d)\n\n        R = (1.0 / (2.0 * kappa)) * np.log(log_argument)\n\n        # The buffer thickness is B = R - r_d.\n        # If the calculated R is less than r_d, it means the error tolerance\n        # is met even with a zero buffer (R = r_d).\n        # Hence, the buffer thickness cannot be negative.\n        B = np.maximum(0.0, R - r_d)\n        \n        results.append(f\"{B:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Efficiently solving the Poisson-Boltzmann equation requires placing computational effort where it is most needed, particularly within the sharp potential gradients of the electric double layer. This practice moves beyond simple uniform grids to the derivation of a conservative finite-difference scheme on a nonuniform mesh, a technique essential for accurate and efficient PBE solvers. Developing this scheme from first principles will deepen your understanding of numerical discretization and its role in resolving multiscale physical phenomena .",
            "id": "4260769",
            "problem": "Consider a symmetric $z:z$ electrolyte adjacent to a perfectly planar, nonreactive wall located at $x=0$ and a bulk reservoir at $x=L$. The electrostatic potential is denoted by $\\psi(x)$, the elementary charge by $e$, the absolute temperature by $T$, the Boltzmann constant by $k_B$, the relative permittivity of the medium by $\\epsilon$, and the bulk ion number density by $c_{\\infty}$. Define the dimensionless potential $y(x)=\\dfrac{z e \\psi(x)}{k_B T}$ and the inverse Debye screening length $\\kappa$ via $\\kappa^2=\\dfrac{2 z^2 e^2 c_{\\infty}}{\\epsilon k_B T}$. The one-dimensional planar Poisson–Boltzmann equation reads $y''(x)=\\kappa^2 \\sinh(y(x))$ over the interval $x\\in[0,L]$ subject to Dirichlet boundary conditions $y(0)=y_w$ and $y(L)=0$, where $y_w$ is the prescribed wall potential and $L$ is several screening lengths so that $y(L)=0$ is appropriate.\n\nYou are tasked with constructing a finite-difference discretization that clusters points near the wall. Let a nonuniform mesh be given by the node positions $x_0=0x_1\\cdotsx_{N-1}x_N=L$ with local spacings $h_i=x_i-x_{i-1}$ for $i=1,2,\\ldots,N$. The unknowns are the interior nodal values $y_i\\approx y(x_i)$ for $i=1,2,\\ldots,N-1$, while $y_0=y_w$ and $y_N=0$ are fixed by the boundary conditions. Starting from first principles, derive the conservative finite-difference formula for the second derivative on a nonuniform grid and use it to obtain the nonlinear algebraic system that enforces the Poisson–Boltzmann equation at each interior node $x_i$ for $i=1,2,\\ldots,N-1$.\n\nReport, as your final answer, a single closed-form analytic expression for the residual at a generic interior node $i$ in terms of $y_{i-1}$, $y_i$, $y_{i+1}$, $h_i$, $h_{i+1}$, and $\\kappa$. No numerical evaluation is required. If you introduce any intermediate variables in your derivation, eliminate them before presenting your final expression. No rounding is required, and no units should be included in the final expression.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the established Poisson-Boltzmann theory, is well-posed, objective, and provides a complete and consistent set of definitions and constraints to derive the requested finite-difference scheme. There are no contradictions, ambiguities, or factual inaccuracies.\n\nThe objective is to derive the conservative finite-difference discretization for the one-dimensional Poisson-Boltzmann equation, $y''(x) = \\kappa^2 \\sinh(y(x))$, on a nonuniform grid. The method is based on a control-volume approach, which ensures the conservation of the relevant physical quantity (in this case, the electric field flux).\n\nLet us consider a generic interior node $x_i$ for $i \\in \\{1, 2, \\ldots, N-1\\}$. We define a control volume $V_i$ centered around this node. The boundaries of this control volume are placed at the midpoints between adjacent nodes. Thus, $V_i = [x_{i-1/2}, x_{i+1/2}]$, where $x_{i-1/2} = \\frac{x_{i-1} + x_i}{2}$ and $x_{i+1/2} = \\frac{x_i + x_{i+1}}{2}$.\n\nThe local grid spacings are given by $h_i = x_i - x_{i-1}$ and $h_{i+1} = x_{i+1} - x_i$. The length of the control volume $V_i$ is:\n$$\n|V_i| = x_{i+1/2} - x_{i-1/2} = \\frac{x_i + x_{i+1}}{2} - \\frac{x_{i-1} + x_i}{2} = \\frac{x_{i+1} - x_{i-1}}{2} = \\frac{(x_{i+1} - x_i) + (x_i - x_{i-1})}{2} = \\frac{h_{i+1} + h_i}{2}\n$$\n\nThe problem requires first deriving the conservative finite-difference formula for the second derivative, $y''(x)$. The second derivative can be written as $y''(x) = \\frac{d}{dx}(y'(x))$. We approximate the value of $y''$ at node $x_i$, denoted $y_i''$, by its average value over the control volume $V_i$:\n$$\ny_i'' \\approx \\frac{1}{|V_i|} \\int_{x_{i-1/2}}^{x_{i+1/2}} y''(x) dx\n$$\nApplying the Fundamental Theorem of Calculus to the integral yields:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} y''(x) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}(y'(x)) dx = y'(x_{i+1/2}) - y'(x_{i-1/2})\n$$\nThe next step is to approximate the first derivatives, $y'(x)$, at the faces of the control volume. We use a second-order accurate central difference approximation for the derivative at a midpoint:\nAt the right face, $x_{i+1/2}$:\n$$\ny'(x_{i+1/2}) \\approx \\frac{y(x_{i+1}) - y(x_i)}{x_{i+1} - x_i} = \\frac{y_{i+1} - y_i}{h_{i+1}}\n$$\nAt the left face, $x_{i-1/2}$:\n$$\ny'(x_{i-1/2}) \\approx \\frac{y(x_i) - y(x_{i-1})}{x_i - x_{i-1}} = \\frac{y_i - y_{i-1}}{h_i}\n$$\nSubstituting these approximations back into the integral expression:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} y''(x) dx \\approx \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i}\n$$\nNow, we can write the formula for the second derivative by dividing by the volume $|V_i| = \\frac{h_i + h_{i+1}}{2}$:\n$$\ny_i'' \\approx \\frac{1}{\\frac{h_i + h_{i+1}}{2}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right) = \\frac{2}{h_i + h_{i+1}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right)\n$$\nThis is the conservative finite-difference formula for the second derivative on a nonuniform grid.\n\nThe final step is to use this formula to discretize the Poisson-Boltzmann equation, $y''(x) = \\kappa^2 \\sinh(y(x))$, at the interior node $x_i$. We substitute the finite-difference approximation for $y_i''$ and evaluate the right-hand side at $y_i$:\n$$\n\\frac{2}{h_i + h_{i+1}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right) = \\kappa^2 \\sinh(y_i)\n$$\nThe problem asks for the residual of the nonlinear algebraic system. The residual at node $i$, denoted $R_i$, is the expression that must be equal to zero for the equation to be satisfied. We obtain it by moving all terms to one side of the equation:\n$$\nR_i = \\frac{2}{h_i + h_{i+1}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right) - \\kappa^2 \\sinh(y_i)\n$$\nThis expression represents the equation to be solved for each interior unknown $y_i$ (for $i=1, \\ldots, N-1$), forming a system of $N-1$ nonlinear algebraic equations. The expression is given in terms of the required variables $y_{i-1}$, $y_i$, $y_{i+1}$, $h_i$, $h_{i+1}$, and $\\kappa$, with no intermediate variables.",
            "answer": "$$\n\\boxed{\\frac{2}{h_i + h_{i+1}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right) - \\kappa^2 \\sinh(y_i)}\n$$"
        }
    ]
}