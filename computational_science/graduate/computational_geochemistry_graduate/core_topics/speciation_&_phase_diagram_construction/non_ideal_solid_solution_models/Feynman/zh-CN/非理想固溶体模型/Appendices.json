{
    "hands_on_practices": [
        {
            "introduction": "在应用任何热力学模型之前，理解其参数的物理意义至关重要。本练习通过一个基础的推导，将抽象的马古列斯参数 ($W_{ij}$) 与稀释极限下的偏摩尔过剩吉布斯能和偏摩尔过剩焓等可测量的热力学量直接联系起来。通过这个实践，您将掌握从一个给定的过剩能模型出发，推导关键热力学性质的方法 ()。",
            "id": "4093023",
            "problem": "考虑一个在恒定压力下的由组分 $1$ 和 $2$ 构成的二元非理想结晶固溶体，这与晶格中阳离子取代的计算地球化学相关。其非理想行为由摩尔超额吉布斯能的不对称双参数 Margules 模型描述，定义为\n$$\ng^{ex}(x_{1},T) \\equiv x_{1} x_{2} \\left[ W_{12}(T)\\, x_{2} + W_{21}(T)\\, x_{1} \\right],\n$$\n其中 $x_{1}$ 和 $x_{2}=1-x_{1}$ 是摩尔分数，$T$ 是绝对温度，$W_{12}(T)$ 和 $W_{21}(T)$ 是依赖于温度的 Margules 相互作用参数，其物理量纲为能量/摩尔。假设每个参数都是温度的仿射（线性）函数，\n$$\nW_{12}(T) = \\alpha_{12} + \\beta_{12}\\, T, \\qquad W_{21}(T) = \\alpha_{21} + \\beta_{21}\\, T,\n$$\n其中 $\\alpha_{12}$、$\\beta_{12}$、$\\alpha_{21}$ 和 $\\beta_{21}$ 在所关心的范围内相对于 $T$ 是常数，并且与组成和压力无关。\n\n从化学势作为偏摩尔吉布斯能的定义和超额性质的定义出发，推导在 $x_{1}\\to 0$ 时的极限偏摩尔超额吉布斯能 $\\overline{G}_{1}^{ex}$ 和在 $x_{2}\\to 0$ 时的极限偏摩尔超额吉布斯能 $\\overline{G}_{2}^{ex}$ 的表达式，然后使用基本热力学恒等式来获得在 $x_{1}\\to 0$ 时的相应极限偏摩尔超额焓 $\\overline{H}_{1}^{ex}$ 和在 $x_{2}\\to 0$ 时的相应极限偏摩尔超额焓 $\\overline{H}_{2}^{ex}$。\n\n以焦耳/摩尔为单位表示最终的能量。以 $\\alpha_{12}$、$\\beta_{12}$、$\\alpha_{21}$、$\\beta_{21}$ 和 $T$ 的形式，提供一个单一的闭式解析表达式作为最终答案。无需进行数值四舍五入。您的最终表达式必须按 $\\overline{G}_{1}^{ex}\\!(x_{1}\\!\\to\\!0)$、$\\overline{H}_{1}^{ex}\\!(x_{1}\\!\\to\\!0)$、$\\overline{G}_{2}^{ex}\\!(x_{2}\\!\\to\\!0)$、$\\overline{H}_{2}^{ex}\\!(x_{2}\\!\\to\\!0)$ 的顺序排列。",
            "solution": "该问题提法明确，具有科学依据，并为获得唯一解提供了所有必要信息。这是化学热力学中的一个标准推导，与地球化学中非理想固溶体的建模相关。因此，该问题是有效的，我将着手求解。\n\n第一步是从给定的溶液摩尔超额吉布斯能 $g^{ex}$ 推导出偏摩尔超额吉布斯能 $\\overline{G}_{1}^{ex}$ 和 $\\overline{G}_{2}^{ex}$ 的一般表达式。在二元溶液中，组分 $i$ 的偏摩尔性质 $\\overline{Y}_{i}$ 与摩尔性质 $Y$ 通过以下关系式相关联：\n$$\n\\overline{Y}_{1} = Y + x_{2} \\frac{\\partial Y}{\\partial x_{1}} \\quad \\text{and} \\quad \\overline{Y}_{2} = Y - x_{1} \\frac{\\partial Y}{\\partial x_{1}}\n$$\n在本问题中，$Y=g^{ex}$，$\\overline{Y}_{1}=\\overline{G}_{1}^{ex}$，以及 $\\overline{Y}_{2}=\\overline{G}_{2}^{ex}$。摩尔超额吉布斯能由下式给出：\n$$\ng^{ex}(x_{1}, T) = x_{1} x_{2} \\left[ W_{12}(T)\\, x_{2} + W_{21}(T)\\, x_{1} \\right]\n$$\n为便于求导，我们代入 $x_{2} = 1 - x_{1}$：\n$$\ng^{ex}(x_{1}, T) = x_{1} (1-x_{1}) \\left[ W_{12}(T)\\, (1-x_{1}) + W_{21}(T)\\, x_{1} \\right]\n$$\n该表达式可写作：\n$$\ng^{ex} = x_{1}(1-x_{1})^{2} W_{12} + x_{1}^{2}(1-x_{1}) W_{21}\n$$\n此处为记法清晰，暂时省略了 $W_{ij}$ 对温度的依赖性。现在我们计算 $g^{ex}$ 对 $x_1$ 的偏导数：\n$$\n\\frac{\\partial g^{ex}}{\\partial x_{1}} = \\frac{\\partial}{\\partial x_{1}} \\left[ x_{1}(1-x_{1})^{2} W_{12} + x_{1}^{2}(1-x_{1}) W_{21} \\right]\n$$\n使用乘法法则：\n$$\n\\frac{\\partial g^{ex}}{\\partial x_{1}} = \\left( (1-x_{1})^{2} - 2x_{1}(1-x_{1}) \\right) W_{12} + \\left( 2x_{1}(1-x_{1}) - x_{1}^{2} \\right) W_{21}\n$$\n$$\n\\frac{\\partial g^{ex}}{\\partial x_{1}} = (1-x_{1})(1-x_{1}-2x_{1}) W_{12} + x_{1}(2-2x_{1}-x_{1}) W_{21}\n$$\n$$\n\\frac{\\partial g^{ex}}{\\partial x_{1}} = (1-x_{1})(1-3x_{1}) W_{12} + x_{1}(2-3x_{1}) W_{21}\n$$\n现在我们可以求出 $\\overline{G}_{1}^{ex}$ 的表达式：\n$$\n\\overline{G}_{1}^{ex} = g^{ex} + (1-x_{1})\\frac{\\partial g^{ex}}{\\partial x_{1}}\n$$\n$$\n\\overline{G}_{1}^{ex} = \\left[ x_{1}(1-x_{1})^{2} W_{12} + x_{1}^{2}(1-x_{1}) W_{21} \\right] + (1-x_{1}) \\left[ (1-x_{1})(1-3x_{1}) W_{12} + x_{1}(2-3x_{1}) W_{21} \\right]\n$$\n将含有 $W_{12}$ 和 $W_{21}$ 的项分组：\n$$\n\\overline{G}_{1}^{ex} = \\left[ x_{1}(1-x_{1})^{2} + (1-x_{1})^{2}(1-3x_{1}) \\right] W_{12} + \\left[ x_{1}^{2}(1-x_{1}) + x_{1}(1-x_{1})(2-3x_{1}) \\right] W_{21}\n$$\n提出公因式：\n$$\n\\overline{G}_{1}^{ex} = (1-x_{1})^{2} \\left[ x_{1} + (1-3x_{1}) \\right] W_{12} + x_{1}(1-x_{1}) \\left[ x_{1} + (2-3x_{1}) \\right] W_{21}\n$$\n$$\n\\overline{G}_{1}^{ex} = (1-x_{1})^{2} (1-2x_{1}) W_{12} + x_{1}(1-x_{1}) (2-2x_{1}) W_{21}\n$$\n$$\n\\overline{G}_{1}^{ex} = (1-x_{1})^{2} (1-2x_{1}) W_{12} + 2x_{1}(1-x_{1})^{2} W_{21}\n$$\n提出 $(1-x_{1})^{2}$ 得到双参数 Margules 模型的最终标准形式：\n$$\n\\overline{G}_{1}^{ex} = (1-x_{1})^{2} \\left[ (1-2x_{1}) W_{12} + 2x_{1} W_{21} \\right]\n$$\n这可以改写为：\n$$\n\\overline{G}_{1}^{ex} = x_{2}^{2} \\left[ W_{12} + 2x_{1} (W_{21} - W_{12}) \\right]\n$$\n通过对称性，交换下标 $1$ 和 $2$，我们得到 $\\overline{G}_{2}^{ex}$ 的表达式：\n$$\n\\overline{G}_{2}^{ex} = x_{1}^{2} \\left[ W_{21} + 2x_{2} (W_{12} - W_{21}) \\right]\n$$\n现在，我们计算所需的极限。对于组分 $1$ 的极限偏摩尔超额吉布斯能，我们取 $x_{1} \\to 0$ 的极限，这意味着 $x_{2} \\to 1$：\n$$\n\\lim_{x_{1} \\to 0} \\overline{G}_{1}^{ex} = \\lim_{x_{1} \\to 0, x_{2} \\to 1} \\left( x_{2}^{2} \\left[ W_{12} + 2x_{1} (W_{21} - W_{12}) \\right] \\right)\n$$\n$$\n\\overline{G}_{1}^{ex}(x_{1} \\to 0) = (1)^{2} \\left[ W_{12} + 2(0) (W_{21} - W_{12}) \\right] = W_{12}(T)\n$$\n对于组分 $2$ 的极限偏摩尔超额吉布斯能，我们取 $x_{2} \\to 0$ 的极限，这意味着 $x_{1} \\to 1$：\n$$\n\\lim_{x_{2} \\to 0} \\overline{G}_{2}^{ex} = \\lim_{x_{2} \\to 0, x_{1} \\to 1} \\left( x_{1}^{2} \\left[ W_{21} + 2x_{2} (W_{12} - W_{21}) \\right] \\right)\n$$\n$$\n\\overline{G}_{2}^{ex}(x_{2} \\to 0) = (1)^{2} \\left[ W_{21} + 2(0) (W_{12} - W_{21}) \\right] = W_{21}(T)\n$$\n代入给定的 Margules 参数对温度的线性依赖关系：\n$$\n\\overline{G}_{1}^{ex}(x_{1} \\to 0) = W_{12}(T) = \\alpha_{12} + \\beta_{12} T\n$$\n$$\n\\overline{G}_{2}^{ex}(x_{2} \\to 0) = W_{21}(T) = \\alpha_{21} + \\beta_{21} T\n$$\n接下来，我们推导极限偏摩尔超额焓 $\\overline{H}_{1}^{ex}(x_{1}\\to 0)$ 和 $\\overline{H}_{2}^{ex}(x_{2}\\to 0)$ 的表达式。我们使用吉布斯-亥姆霍兹方程，它将焓与吉布斯能联系起来：\n$$\n\\overline{H}_{i}^{ex} = -T^{2} \\left[ \\frac{\\partial (\\overline{G}_{i}^{ex}/T)}{\\partial T} \\right]_{P,x}\n$$\n我们可以将此关系直接应用于上面推导出的极限吉布斯能表达式。\n对于无限稀释下的组分 $1$（$x_{1} \\to 0$）：\n$$\n\\overline{H}_{1}^{ex}(x_{1} \\to 0) = -T^{2} \\left[ \\frac{\\partial}{\\partial T} \\left( \\frac{\\overline{G}_{1}^{ex}(x_{1} \\to 0)}{T} \\right) \\right]_{P}\n$$\n代入 $\\overline{G}_{1}^{ex}(x_{1} \\to 0)$ 的表达式：\n$$\n\\frac{\\overline{G}_{1}^{ex}(x_{1} \\to 0)}{T} = \\frac{\\alpha_{12} + \\beta_{12} T}{T} = \\frac{\\alpha_{12}}{T} + \\beta_{12}\n$$\n在恒定压力下对 $T$ 求导：\n$$\n\\left[ \\frac{\\partial}{\\partial T} \\left( \\frac{\\alpha_{12}}{T} + \\beta_{12} \\right) \\right]_{P} = -\\frac{\\alpha_{12}}{T^{2}}\n$$\n将此结果代回吉布斯-亥姆霍兹方程：\n$$\n\\overline{H}_{1}^{ex}(x_{1} \\to 0) = -T^{2} \\left( -\\frac{\\alpha_{12}}{T^{2}} \\right) = \\alpha_{12}\n$$\n类似地，对于无限稀释下的组分 $2$（$x_{2} \\to 0$）：\n$$\n\\overline{H}_{2}^{ex}(x_{2} \\to 0) = -T^{2} \\left[ \\frac{\\partial}{\\partial T} \\left( \\frac{\\overline{G}_{2}^{ex}(x_{2} \\to 0)}{T} \\right) \\right]_{P}\n$$\n代入 $\\overline{G}_{2}^{ex}(x_{2} \\to 0)$ 的表达式：\n$$\n\\frac{\\overline{G}_{2}^{ex}(x_{2} \\to 0)}{T} = \\frac{\\alpha_{21} + \\beta_{21} T}{T} = \\frac{\\alpha_{21}}{T} + \\beta_{21}\n$$\n在恒定压力下对 $T$ 求导：\n$$\n\\left[ \\frac{\\partial}{\\partial T} \\left( \\frac{\\alpha_{21}}{T} + \\beta_{21} \\right) \\right]_{P} = -\\frac{\\alpha_{21}}{T^{2}}\n$$\n将此结果代回吉布斯-亥姆霍兹方程：\n$$\n\\overline{H}_{2}^{ex}(x_{2} \\to 0) = -T^{2} \\left( -\\frac{\\alpha_{21}}{T^{2}} \\right) = \\alpha_{21}\n$$\n因此，所需的四个量是：\n1. $\\overline{G}_{1}^{ex}(x_{1} \\to 0) = \\alpha_{12} + \\beta_{12} T$\n2. $\\overline{H}_{1}^{ex}(x_{1} \\to 0) = \\alpha_{12}$\n3. $\\overline{G}_{2}^{ex}(x_{2} \\to 0) = \\alpha_{21} + \\beta_{21} T$\n4. $\\overline{H}_{2}^{ex}(x_{2} \\to 0) = \\alpha_{21}$\n\n这些量在最终答案中以行矩阵的形式给出。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha_{12} + \\beta_{12} T & \\alpha_{12} & \\alpha_{21} + \\beta_{21} T & \\alpha_{21}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "热力学模型的实用性取决于其参数是否能准确地反映真实体系的行为，而这些参数通常是通过拟合实验数据来确定的。本练习将指导您完成一项计算地球化学中的核心任务：利用相图中的溶体线数据，通过最小二乘法反演非对称马古列斯模型的相互作用参数 $W_{12}$ 和 $W_{21}$ ()。这项技能对于建立能够预测相平衡的定制化热力学数据库至关重要。",
            "id": "4093013",
            "problem": "考虑一个由组分 $1$ 和 $2$ 构成的二元非理想固溶体，该溶体由正则溶液理论和一个非对称双参数 Margules 偏额吉布斯自由能模型描述。令 $x$ 表示组分 $1$ 的摩尔分数（因此组分 $2$ 的摩尔分数为 $1-x$）。摩尔混合吉布斯自由能定义为\n$$\ng_{\\mathrm{mix}}(x,T) \\equiv R T \\big[x \\ln x + (1-x)\\ln(1-x)\\big] + g^{E}(x),\n$$\n其中 $R$ 是普适气体常数（此处首次定义为 $R$），$T$ 是以开尔文为单位的绝对温度， $g^{E}(x)$ 是由非对称双参数 Margules 形式给出的偏额吉布斯自由能\n$$\ng^{E}(x) \\equiv x(1-x)\\big[W_{12}(1-x) + W_{21}x\\big],\n$$\n其中 $W_{12}$ 和 $W_{21}$ 是相互作用参数（单位均为焦耳/摩尔）。在温度 $T$ 下，固溶线上的两个平衡组分 $x_{\\alpha}$ 和 $x_{\\beta}$ 处，公切线法要求 $g_{\\mathrm{mix}}(x,T)$ 在 $x_{\\alpha}$ 和 $x_{\\beta}$ 处的切线是同一条直线。这等价于以下一对条件\n$$\n\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T),\n\\quad\\text{and}\\quad\ng_{\\mathrm{mix}}(x_{\\alpha},T) - x_{\\alpha}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = g_{\\mathrm{mix}}(x_{\\beta},T) - x_{\\beta}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T).\n$$\n从这些热力学定义出发，构建一个最小二乘反演方法，以根据在温度 $\\{T_i\\}$ 下测得的一组固溶线组分对 $\\{(x_{\\alpha,i},x_{\\beta,i})\\}$ 来估计参数 $W_{12}$ 和 $W_{21}$。为每个测量对构建由公切线等式所蕴含的两个残差，并组合成一个关于未知数 $W_{12}$ 和 $W_{21}$ 的线性系统。通过最小化数据集中所有对的残差平方和来求解 $W_{12}$ 和 $W_{21}$。\n\n您的程序必须为以下测试套件中的每个数据集实现此反演。使用 $R = 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。所有温度必须以开尔文为单位处理，所有输出必须以焦耳/摩尔为单位表示。\n\n测试套件（每个数据集是一个 $(T,\\ x_{\\alpha},\\ x_{\\beta})$ 的列表）：\n\n- 数据集 A（一般多温度情况）：$[(950,\\ 0.12,\\ 0.88),\\ (1050,\\ 0.18,\\ 0.82),\\ (1150,\\ 0.25,\\ 0.75)]$。\n- 数据集 B（信息最少的边界情况）：$[(1000,\\ 0.20,\\ 0.80)]$。\n- 数据集 C（近临界对称情况）：$[(1400,\\ 0.35,\\ 0.65),\\ (1500,\\ 0.40,\\ 0.60)]$。\n\n您的程序应生成单行输出，其中包含每个数据集的 $W_{12}$ 和 $W_{21}$ 的估计值，顺序为 A、B、C，四舍五入到最接近的整数，并以 $\\mathrm{J\\,mol^{-1}}$ 为单位表示。确切格式必须是方括号内用逗号分隔的列表，不含空格，例如 $[w_{12,A},w_{21,A},w_{12,B},w_{21,B},w_{12,C},w_{21,C}]$，其中每个 $w_{\\cdot,\\cdot}$ 都是整数。",
            "solution": "该问题要求根据实验固溶线数据，估计非对称双参数 Margules 相互作用参数 $W_{12}$ 和 $W_{21}$。数据由在相应温度 $T_i$ 下的平衡组分对 $(x_{\\alpha,i}, x_{\\beta,i})$ 组成。其理论框架是将公切线法应用于混合吉布斯自由能，这会导出一组关于未知数 $W_{12}$ 和 $W_{21}$ 的线性方程。采用线性最小二乘法来求解这个超定系统。\n\n摩尔混合吉布斯自由能 $g_{\\mathrm{mix}}$ 由下式给出\n$$\ng_{\\mathrm{mix}}(x,T) = RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] + x(1-x)\\big[W_{12}(1-x) + W_{21}x\\big]\n$$\n其中 $x$ 是组分 $1$ 的摩尔分数，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n在组分 $x_{\\alpha}$ 和 $x_{\\beta}$ 处达到相平衡的两个条件是：\n1. $g_{\\mathrm{mix}}(x,T)$ 切线斜率相等：$\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$\n2. 切线截距相等：$g_{\\mathrm{mix}}(x_{\\alpha},T) - x_{\\alpha}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = g_{\\mathrm{mix}}(x_{\\beta},T) - x_{\\beta}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$\n\n我们将针对 $W_{12}$ 和 $W_{21}$ 对这两个条件进行线性化。\n\n首先，我们推导 $g_{\\mathrm{mix}}(x,T)$ 对 $x$ 的一阶导数：\n$$\n\\frac{d g_{\\mathrm{mix}}}{dx} = \\frac{d}{dx} \\left( RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] \\right) + \\frac{d}{dx} \\left( g^E(x) \\right)\n$$\n理想混合项的导数是：\n$$\n\\frac{d}{dx} \\left( RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] \\right) = RT\\left(\\ln x + 1 - \\ln(1-x) - 1\\right) = RT \\ln\\left(\\frac{x}{1-x}\\right)\n$$\n偏额能量项 $g^E(x)$ 可以写为 $g^E(x) = W_{12}x(1-x)^2 + W_{21}x^2(1-x)$。对其求导可得：\n$$\n\\frac{d g^E}{dx} = W_{12}\\left((1-x)^2 - 2x(1-x)\\right) + W_{21}\\left(2x(1-x) - x^2\\right) = W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\n$$\n因此，完整的导数是：\n$$\n\\frac{d g_{\\mathrm{mix}}}{dx} = RT \\ln\\left(\\frac{x}{1-x}\\right) + W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\n$$\n\n现在，我们为每个数据点 $(T, x_{\\alpha}, x_{\\beta})$ 构建两个线性方程。\n\n**方程 1：源于导数相等**\n应用第一个平衡条件 $\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$：\n$$\nRT \\ln\\left(\\frac{x_\\alpha}{1-x_\\alpha}\\right) + W_{12}(1-x_\\alpha)(1-3x_\\alpha) + W_{21}x_\\alpha(2-3x_\\alpha) = RT \\ln\\left(\\frac{x_\\beta}{1-x_\\beta}\\right) + W_{12}(1-x_\\beta)(1-3x_\\beta) + W_{21}x_\\beta(2-3x_\\beta)\n$$\n重新整理，将含有 $W_{12}$ 和 $W_{21}$ 的项分组：\n$$\nW_{12} \\underbrace{\\left[ (1-x_\\alpha)(1-3x_\\alpha) - (1-x_\\beta)(1-3x_\\beta) \\right]}_{A_1} + W_{21} \\underbrace{\\left[ x_\\alpha(2-3x_\\alpha) - x_\\beta(2-3x_\\beta) \\right]}_{B_1} = \\underbrace{RT\\left[\\ln\\left(\\frac{x_\\beta}{1-x_\\beta}\\right) - \\ln\\left(\\frac{x_\\alpha}{1-x_\\alpha}\\right)\\right]}_{C_1}\n$$\n这就得到了每个数据点的第一个线性方程：$A_1 W_{12} + B_1 W_{21} = C_1$。\n\n**方程 2：源于切线截距相等**\n截距项 $g_{\\mathrm{mix}}(x) - x\\frac{d g_{\\mathrm{mix}}}{dx}$ 是组分 $2$ 的化学势，$\\mu_2(x)$。\n$$\n\\mu_2(x) = RT\\ln(1-x) + \\mu_2^E(x)\n$$\n其中 $\\mu_2^E(x) = g^E(x) - x\\frac{d g^E}{dx}$。使用我们得到的 $g^E(x)$ 及其导数的表达式：\n$$\n\\mu_2^E(x) = \\left[W_{12}x(1-x)^2 + W_{21}x^2(1-x)\\right] - x\\left[W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\\right]\n$$\n简化后，可得：\n$$\n\\mu_2^E(x) = W_{12}\\left(2x^2(1-x)\\right) + W_{21}\\left(x^2(2x-1)\\right)\n$$\n第二个平衡条件是 $\\mu_2(x_\\alpha, T) = \\mu_2(x_\\beta, T)$：\n$$\nRT\\ln(1-x_\\alpha) + W_{12}(2x_\\alpha^2(1-x_\\alpha)) + W_{21}(x_\\alpha^2(2x_\\alpha-1)) = RT\\ln(1-x_\\beta) + W_{12}(2x_\\beta^2(1-x_\\beta)) + W_{21}(x_\\beta^2(2x_\\beta-1))\n$$\n重新整理以分离 $W_{12}$ 和 $W_{21}$：\n$$\nW_{12} \\underbrace{\\left[ 2x_\\alpha^2(1-x_\\alpha) - 2x_\\beta^2(1-x_\\beta) \\right]}_{A_2} + W_{21} \\underbrace{\\left[ x_\\alpha^2(2x_\\alpha-1) - x_\\beta^2(2x_\\beta-1) \\right]}_{B_2} = \\underbrace{RT\\left[\\ln(1-x_\\beta) - \\ln(1-x_\\alpha)\\right]}_{C_2}\n$$\n这就得到了每个数据点的第二个线性方程：$A_2 W_{12} + B_2 W_{21} = C_2$。\n\n**最小二乘法公式**\n对于一个包含 $N$ 个测量点 $\\{(T_i, x_{\\alpha,i}, x_{\\beta,i})\\}_{i=1}^N$ 的数据集，我们得到 $2N$ 个关于两个未知数 $W_{12}$ 和 $W_{21}$ 的线性方程。这个超定系统可以写成矩阵形式 $\\mathbf{M}\\mathbf{w} = \\mathbf{d}$，其中 $\\mathbf{w} = [W_{12}, W_{21}]^T$。矩阵 $\\mathbf{M}$ 和向量 $\\mathbf{d}$ 组合如下：\n$$\n\\mathbf{M} = \\begin{pmatrix} A_{1,1} & B_{1,1} \\\\ A_{2,1} & B_{2,1} \\\\ A_{1,2} & B_{1,2} \\\\ A_{2,2} & B_{2,2} \\\\ \\vdots & \\vdots \\\\ A_{1,N} & B_{1,N} \\\\ A_{2,N} & B_{2,N} \\end{pmatrix}, \\quad\n\\mathbf{d} = \\begin{pmatrix} C_{1,1} \\\\ C_{2,1} \\\\ C_{1,2} \\\\ C_{2,2} \\\\ \\vdots \\\\ C_{1,N} \\\\ C_{2,N} \\end{pmatrix}\n$$\n目标是找到一个向量 $\\mathbf{w}$，以最小化残差平方和 $||\\mathbf{M}\\mathbf{w} - \\mathbf{d}||_2^2$。这是一个标准的线性最小二乘问题，可以通过数值方法求解。该解提供了 $W_{12}$ 和 $W_{21}$ 的最佳拟合估计值。\n\n计算实现将根据提供的数据集构建矩阵 $\\mathbf{M}$ 和向量 $\\mathbf{d}$，并使用 `numpy.linalg.lstsq` 函数来找到最优参数值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for Margules parameters for all test datasets.\n    \"\"\"\n    # Universal Gas Constant in J/(mol*K)\n    R = 8.314\n\n    # Test suite datasets\n    test_cases = {\n        \"A\": [(950, 0.12, 0.88), (1050, 0.18, 0.82), (1150, 0.25, 0.75)],\n        \"B\": [(1000, 0.20, 0.80)],\n        \"C\": [(1400, 0.35, 0.65), (1500, 0.40, 0.60)],\n    }\n\n    def calculate_w_params(dataset, R_const):\n        \"\"\"\n        Calculates W12 and W21 for a given dataset using least-squares inversion.\n\n        Args:\n            dataset (list): A list of tuples, where each tuple is (T, x_alpha, x_beta).\n            R_const (float): The Universal Gas Constant.\n\n        Returns:\n            tuple: A tuple containing the estimated (W12, W21).\n        \"\"\"\n        M_rows = []\n        d_vals = []\n\n        for T, xa, xb in dataset:\n            # First equilibrium condition: equality of derivatives\n            # A1*W12 + B1*W21 = C1\n            A1 = (1 - xa) * (1 - 3 * xa) - (1 - xb) * (1 - 3 * xb)\n            B1 = xa * (2 - 3 * xa) - xb * (2 - 3 * xb)\n            # Use a small epsilon to avoid log(0) if xa or xb are 0 or 1, although not needed for this problem's data\n            eps = 1e-12\n            C1 = R_const * T * (np.log(xb / (1 - xb + eps)) - np.log(xa / (1 - xa + eps)))\n\n            M_rows.append([A1, B1])\n            d_vals.append(C1)\n\n            # Second equilibrium condition: equality of tangent intercepts (chemical potential of comp 2)\n            # A2*W12 + B2*W21 = C2\n            A2 = 2 * xa**2 * (1 - xa) - 2 * xb**2 * (1 - xb)\n            B2 = xa**2 * (2 * xa - 1) - xb**2 * (2 * xb - 1)\n            C2 = R_const * T * (np.log(1 - xb + eps) - np.log(1 - xa + eps))\n            \n            M_rows.append([A2, B2])\n            d_vals.append(C2)\n\n        M = np.array(M_rows)\n        d = np.array(d_vals)\n\n        # Solve the system M*w = d using linear least-squares\n        # lstsq returns solution, residuals, rank, singular values\n        solution, _, _, _ = np.linalg.lstsq(M, d, rcond=None)\n        \n        W12, W21 = solution\n        return W12, W21\n\n    # Process all datasets and collect results\n    final_results = []\n    dataset_order = [\"A\", \"B\", \"C\"]\n\n    for key in dataset_order:\n        dataset = test_cases[key]\n        w12, w21 = calculate_w_params(dataset, R)\n        \n        # Round to the nearest integer as per problem specification\n        final_results.append(int(np.round(w12)))\n        final_results.append(int(np.round(w21)))\n\n    # Print the final result in the exact specified format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "构建并参数化模型后的最终目标是利用它来预测复杂体系的平衡状态。本练习将应用热力学第一性原理——在质量守恒约束下最小化体系的总吉布斯能——来计算一个包含非理想固溶体的两相体系的平衡相组成和各相的量 ()。这个被称为吉布斯能最小化 (GEM) 的方法是计算热力学和地球化学建模的基石。",
            "id": "4093005",
            "problem": "考虑一个封闭的、等温、等压系统，其中包含两个组分（标记为组分$1$和组分$2$）和两个相：相$s$是组分$1$和$2$的二元非理想固溶体，相$p$是组分$2$的纯相。普适气体常数$R$是将热能单位换算为每摩尔每开尔文的常数。计算在固定绝对温度$T$、组分$1$和$2$的总摩尔量分别为$N_{1}$和$N_{2}$的条件下进行。设相$s$中纯端元$1$的摩尔吉布斯自由能为$G_{1}^{0}$，相$s$中纯端元$2$的摩尔吉布斯自由能为$G_{2}^{0}$，相$p$的摩尔吉布斯自由能为$G_{p}^{0}$，单位均为焦耳/摩尔。相$s$的非理想性由一个非对称双后缀Margules规则溶液模型描述，其参数为$W_{12}$和$W_{21}$，单位均为焦耳/摩尔。假设所有量在热力学上是一致的，并且相$p$只包含组分$2$。\n\n令$n_{s}$和$n_{p}$分别表示相$s$和相$p$中的总摩尔数，令$x$表示组分$1$在相$s$中的摩尔分数，因此组分$2$在相$s$中的摩尔分数为$1-x$。系统的总吉布斯自由能是各相总吉布斯自由能之和。质量平衡要求各组分在相间的分布必须保持$N_{1}$和$N_{2}$守恒。\n\n仅从以下基本原理出发：\n- 混合物的摩尔吉布斯自由能定义为理想混合贡献与由规则溶液模型控制的超额贡献之和，\n- 化学势定义为总吉布斯自由能对组分摩尔量的偏导数，\n- 使用拉格朗日乘数法在变分问题中强制执行等式约束，\n推导在质量平衡约束下最小化集合体总吉布斯自由能的平稳条件。具体而言，构建包含乘数的拉格朗日函数以强制执行组分$1$和组分$2$的质量守恒，并推导出确定相$s$的平衡成分$x$以及平衡相量$n_{s}$和$n_{p}$的必要条件。\n\n然后，实现一个数值算法，在给定$(T, R, G_{1}^{0}, G_{2}^{0}, G_{p}^{0}, W_{12}, W_{21}, N_{1}, N_{2})$的条件下，求解相$s$中组分$1$的平衡摩尔分数$x$，并计算集合体的最小化总吉布斯自由能$G_{\\mathrm{tot}}$。该算法应：\n- 使用通过拉格朗日乘数法获得的平稳条件，\n- 通过组合理想部分和超额部分，计算相$s$的摩尔吉布斯自由能作为$x$的函数，\n- 使用一个稳健的一维有界数值方法在开区间$(0,1)$内求解$x$。\n\n对于本问题，所有能量必须以焦耳表示，温度以开尔文表示，物量以摩尔表示。不涉及角度。以小数形式报告平衡成分。每个测试用例的最终输出必须是一个包含两个浮点数的列表$[x, G_{\\mathrm{tot}}]$，其中$x$是相$s$中组分$1$的平衡摩尔分数（无量纲），$G_{\\mathrm{tot}}$是最小化的总吉布斯自由能（单位为焦耳）。您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的结果，每个测试用例一个列表，例如$[[x_{1},G_{\\mathrm{tot},1}],[x_{2},G_{\\mathrm{tot},2}],\\dots]$。\n\n使用以下测试套件，其设计旨在探究典型行为、理想极限行为、强不对称性和低温敏感性。每个元组为$(T, R, G_{1}^{0}, G_{2}^{0}, G_{p}^{0}, W_{12}, W_{21}, N_{1}, N_{2})$：\n- 测试$1$（一般非理想情况，顺利路径）：$(T=$ $1000$, $R=$ $8.314462618$, $G_{1}^{0}=$ $-5400$, $G_{2}^{0}=$ $-5000$, $G_{p}^{0}=$ $-5200$, $W_{12}=$ $2000$, $W_{21}=$ $1000$, $N_{1}=$ $0.3$, $N_{2}=$ $0.7)$\n- 测试$2$（理想溶液极限）：$(T=$ $1000$, $R=$ $8.314462618$, $G_{1}^{0}=$ $-5400$, $G_{2}^{0}=$ $-5000$, $G_{p}^{0}=$ $-5200$, $W_{12}=$ $0$, $W_{21}=$ $0$, $N_{1}=$ $0.25$, $N_{2}=$ $0.75)$\n- 测试$3$（强不对称性，较大的正非理想性）：$(T=$ $800$, $R=$ $8.314462618$, $G_{1}^{0}=$ $-4800$, $G_{2}^{0}=$ $-4700$, $G_{p}^{0}=$ $-4900$, $W_{12}=$ $6000$, $W_{21}=$ $3000$, $N_{1}=$ $0.45$, $N_{2}=$ $0.55)$\n- 测试$4$（低温，对少量$N_{1}$的敏感性）：$(T=$ $298$, $R=$ $8.314462618$, $G_{1}^{0}=$ $-5500$, $G_{2}^{0}=$ $-5400$, $G_{p}^{0}=$ $-5500$, $W_{12}=$ $500$, $W_{21}=$ $500$, $N_{1}=$ $0.0001$, $N_{2}=$ $1.0)$\n\n您的程序必须实现上述要求，并为测试用例$i$生成形如$[[x_{1},G_{\\mathrm{tot},1}],[x_{2},G_{\\mathrm{tot},2}],[x_{3},G_{\\mathrm{tot},3}],[x_{4},G_{\\mathrm{tot},4}]]$的单行输出，其中每个$x_{i}$和$G_{\\mathrm{tot},i}$均按指定单位计算。不应打印任何无关文本。",
            "solution": "该问题要求推导一个二元、两相系统的热力学平衡条件，并实现一个数值算法来找到平衡状态。该系统是封闭的，并保持在恒定的温度$T$和压力$P$下。因此，平衡由受质量平衡约束的总吉布斯自由能$G_{\\mathrm{tot}}$的最小值决定。\n\n### 1. 集合体的总吉布斯自由能\n\n该系统由一个二元固溶体（相$s$）和一个组分$2$的纯相（相$p$）组成。令$n_s$和$n_p$分别为相$s$和相$p$的总摩尔数。系统的总吉布斯自由能是各相吉布斯自由能之和：\n$$G_{\\mathrm{tot}} = G_s + G_p$$\n相$p$是纯组分$2$，其吉布斯自由能由下式给出：\n$$G_p = n_p G_p^0$$\n其中$G_p^0$是相$p$的摩尔吉布斯自由能。\n\n固溶体相$s$的吉布斯自由能为$G_s = n_s G_s^{\\text{molar}}$，其中$G_s^{\\text{molar}}$是该溶液的摩尔吉布斯自由能。令$x$为组分$1$在相$s$中的摩尔分数；则组分$2$的摩尔分数为$1-x$。该溶液的摩尔吉布斯自由能是纯端元能量（机械混合物）、理想混合能和超额混合能的总和：\n$$G_s^{\\text{molar}}(x) = \\underbrace{x G_1^0 + (1-x) G_2^0}_{\\text{机械混合物}} + \\underbrace{RT [x \\ln(x) + (1-x) \\ln(1-x)]}_{\\Delta G_{\\text{mix}}^{\\text{ideal}}} + \\underbrace{G^{\\text{excess}}(x)}_{\\text{超额能}}$$\n这里，$G_1^0$和$G_2^0$是相$s$结构中纯端元$1$和$2$的摩尔吉布斯自由能，$R$是普适气体常数。非理想性由一个非对称双后缀Margules模型描述超额吉布斯自由能：\n$$G^{\\text{excess}}(x) = x(1-x)[(1-x)W_{12} + xW_{21}]$$\n其中$W_{12}$和$W_{21}$是Margules相互作用参数。\n\n因此，系统的总吉布斯自由能是自变量$n_s$、$n_p$和$x$的函数：\n$$G_{\\mathrm{tot}}(n_s, n_p, x) = n_s G_s^{\\text{molar}}(x) + n_p G_p^0$$\n\n### 2. 质量平衡约束和拉格朗日公式\n\n系统中组分$1$的总摩尔数$N_1$和组分$2$的总摩尔数$N_2$是固定的。这施加了两个质量平衡约束。令$n_{1,s}$和$n_{2,s}$为相$s$中组分$1$和$2$的摩尔数，令$n_{1,p}$和$n_{2,p}$为相$p$中的摩尔数。\n根据定义，$n_{1,s} = n_s x$且$n_{2,s} = n_s(1-x)$。由于相$p$是纯组分$2$，我们有$n_{1,p} = 0$和$n_{2,p} = n_p$。约束条件为：\n$$c_1: n_{1,s} - N_1 = n_s x - N_1 = 0$$\n$$c_2: n_{2,s} + n_{2,p} - N_2 = n_s(1-x) + n_p - N_2 = 0$$\n\n为了找到在这些约束条件下$G_{\\mathrm{tot}}$的最小值，我们使用拉格朗日乘数法。我们使用更基本的变量$n_{1,s}$、$n_{2,s}$和$n_p=n_{2,p}$来定义拉格朗日函数$\\mathcal{L}$：\n$$\\mathcal{L}(n_{1,s}, n_{2,s}, n_p, \\lambda_1, \\lambda_2) = G_{\\mathrm{tot}}(n_{1,s}, n_{2,s}, n_p) - \\lambda_1(n_{1,s} - N_1) - \\lambda_2(n_{2,s} + n_p - N_2)$$\n用这些变量表示的总吉布斯自由能是：\n$$G_{\\mathrm{tot}} = (n_{1,s} + n_{2,s})G_s^{\\text{molar}}\\left(\\frac{n_{1,s}}{n_{1,s} + n_{2,s}}\\right) + n_p G_p^0$$\n在平衡时，$\\mathcal{L}$对每个变量的偏导数必须为零。$G_{\\mathrm{tot}}$的偏导数即化学势：\n- $\\mu_{1,s} = \\left(\\frac{\\partial G_{\\mathrm{tot}}}{\\partial n_{1,s}}\\right)_{n_{2,s}, n_p}$\n- $\\mu_{2,s} = \\left(\\frac{\\partial G_{\\mathrm{tot}}}{\\partial n_{2,s}}\\right)_{n_{1,s}, n_p}$\n- $\\mu_{2,p} = \\left(\\frac{\\partial G_{\\mathrm{tot}}}{\\partial n_p}\\right)_{n_{1,s}, n_{2,s}} = G_p^0$\n\n平稳条件是：\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_{1,s}} = \\mu_{1,s} - \\lambda_1 = 0 \\implies \\mu_{1,s} = \\lambda_1$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_{2,s}} = \\mu_{2,s} - \\lambda_2 = 0 \\implies \\mu_{2,s} = \\lambda_2$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_p} = \\mu_{2,p} - \\lambda_2 = 0 \\implies \\mu_{2,p} = \\lambda_2$$\n结合这些结果，得到非均相平衡的条件：每个组分在它存在的所有相中的化学势必须相等。对于同时存在于两相中的组分$2$，这意味着：\n$$\\mu_{2,s} = \\mu_{2,p}$$\n\n### 3. 平衡条件的推导\n\n纯相$p$中组分$2$的化学势就是其摩尔吉布斯自由能，$\\mu_{2,p} = G_p^0$。\n对于固溶体相$s$，组分$2$的化学势由$\\mu_{2,s} = G_2^0 + RT\\ln(a_2)$给出，其中$a_2$是组分$2$的活度。活度是摩尔分数和活度系数的乘积，$a_2 = (1-x)\\gamma_2$。活度系数与偏摩尔超额吉布斯自由能相关，$G_2^{\\text{excess}} = RT\\ln\\gamma_2$。对于指定的非对称Margules模型，此值为：\n$$RT\\ln\\gamma_2 = G_2^{\\text{excess}} = x^2 [W_{21} + 2(1-x)(W_{12} - W_{21})]$$\n因此，相$s$中组分$2$的化学势是：\n$$\\mu_{2,s}(x) = G_2^0 + RT \\ln(1-x) + x^2 [W_{21} + 2(1-x)(W_{12} - W_{21})]$$\n平衡条件$\\mu_{2,s} = \\mu_{2,p}$成为一个关于未知平衡成分$x$的单一非线性方程：\n$$G_2^0 + RT \\ln(1-x) + x^2 [W_{21} + 2(1-x)(W_{12} - W_{21})] = G_p^0$$\n这是确定$x$的必要平稳条件。\n\n### 4. 数值求解算法\n\n问题简化为求解以下函数在$x \\in (0,1)$区间内的根：\n$$f(x) = G_2^0 - G_p^0 + RT \\ln(1-x) + x^2 [W_{21} + 2(1-x)(W_{12} - W_{21})]$$\n一个稳健的有界求根方法，如Brent法，适合求解$f(x)=0$。\n\n一旦确定了平衡成分$x_{eq}$，就可以根据质量平衡约束求出相量$n_s$和$n_p$：\n$$n_s = \\frac{N_1}{x_{eq}}$$\n$$n_p = N_2 - n_s(1-x_{eq}) = N_2 - \\frac{N_1(1-x_{eq})}{x_{eq}}$$\n一个物理上有效的解要求$n_p \\ge 0$，这意味着$x_{eq} \\ge N_1 / (N_1+N_2)$。问题设定假定存在两相平衡，因此我们预计此条件会得到满足。\n\n最后，将$x_{eq}$、$n_s$和$n_p$代入总能量表达式，计算最小化的总吉布斯自由能$G_{\\mathrm{tot}}$：\n$$G_{\\mathrm{tot}} = n_s G_s^{\\text{molar}}(x_{eq}) + n_p G_p^0$$\n其中$G_s^{\\text{molar}}(x_{eq})$是在平衡成分下计算的。所实现的算法将对提供的每个测试用例执行这些步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Derives and solves for the thermodynamic equilibrium of a binary, two-phase system.\n    The system consists of a non-ideal solid solution (phase s) and a pure phase (phase p).\n    Equilibrium composition and total Gibbs energy are calculated for several test cases.\n    \"\"\"\n    \n    # Test cases: (T, R, G1_0, G2_0, Gp_0, W12, W21, N1, N2)\n    test_cases = [\n        # Test 1 (general non-ideal, happy path)\n        (1000, 8.314462618, -5400, -5000, -5200, 2000, 1000, 0.3, 0.7),\n        # Test 2 (ideal-solution limit)\n        (1000, 8.314462618, -5400, -5000, -5200, 0, 0, 0.25, 0.75),\n        # Test 3 (strong asymmetry, larger positive non-ideality)\n        (800, 8.314462618, -4800, -4700, -4900, 6000, 3000, 0.45, 0.55),\n        # Test 4 (low temperature, small N1 sensitivity)\n        (298, 8.314462618, -5500, -5400, -5500, 500, 500, 0.0001, 1.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T, R, G1_0, G2_0, Gp_0, W12, W21, N1, N2 = case\n\n        def equilibrium_condition_func(x):\n            \"\"\"\n            This function is f(x) = mu_2_s(x) - Gp_0, the root of which gives the\n            equilibrium composition x.\n            f(x) = G2_0 - Gp_0 + RT*ln(1-x) + x^2*[W21 + 2*(1-x)*(W12-W21)]\n            \"\"\"\n            if x == 0 or x >= 1:\n                return np.nan\n            \n            # RT*ln(a2) term for component 2 in solid solution s\n            # a2 = (1-x)*gamma2\n            # RT*ln(gamma2) = x^2*[W21 + 2*(1-x)*(W12-W21)]\n            \n            rt_log_term = R * T * np.log(1 - x)\n            \n            excess_term = x**2 * (W21 + 2 * (1 - x) * (W12 - W21))\n            \n            return G2_0 - Gp_0 + rt_log_term + excess_term\n\n        # Solve for the equilibrium mole fraction x in phase s using a robust\n        # bounded root-finding method (Brent's method).\n        # The search interval is set slightly inside (0, 1) to avoid log domain errors.\n        try:\n            # All test cases have G2_0 - Gp_0 > 0, so f(0) > 0.\n            # As x -> 1, f(x) -> -inf. A root is guaranteed in (0,1).\n            x_eq = optimize.brentq(equilibrium_condition_func, 1e-9, 1 - 1e-9, xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            # This would happen if f(a) and f(b) have the same sign, which\n            # indicates no or an even number of roots.\n            # This case suggests the two-phase assemblage is not stable.\n            # The problem presumes such an equilibrium exists.\n            results.append([np.nan, np.nan])\n            continue\n        \n        # Once x_eq is found, calculate phase proportions and total Gibbs energy.\n        \n        # 1. Calculate molar Gibbs energy of phase s at equilibrium composition\n        def get_G_s_molar(x):\n            \"\"\"\n            Calculates molar Gibbs energy of the solid solution phase s.\n            G_s_molar = G_mech + G_ideal_mix + G_excess\n            \"\"\"\n            if x == 0 or x >= 1:\n                return np.nan\n\n            g_mechanical = x * G1_0 + (1 - x) * G2_0\n            g_ideal_mixing = R * T * (x * np.log(x) + (1 - x) * np.log(1 - x))\n            g_excess = x * (1 - x) * ((1 - x) * W12 + x * W21)\n            \n            return g_mechanical + g_ideal_mixing + g_excess\n\n        Gs_molar_eq = get_G_s_molar(x_eq)\n        \n        # 2. Calculate mole amounts of each phase from mass balance\n        # n_s*x_eq = N1\n        n_s = N1 / x_eq\n        # n_s*(1-x_eq) + n_p = N2\n        n_p = N2 - n_s * (1 - x_eq)\n        \n        # 3. Calculate total minimized Gibbs energy\n        # G_tot = n_s * G_s_molar + n_p * G_p_0\n        G_tot = n_s * Gs_molar_eq + n_p * Gp_0\n        \n        results.append([x_eq, G_tot])\n\n    # Format output as specified: [[x1,G_tot1],[x2,G_tot2],...]\n    # Using a list comprehension and string formatting to achieve the exact output string.\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}