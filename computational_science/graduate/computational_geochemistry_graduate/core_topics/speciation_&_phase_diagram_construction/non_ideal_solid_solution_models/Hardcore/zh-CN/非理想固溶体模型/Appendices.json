{
    "hands_on_practices": [
        {
            "introduction": "在应用任何数学模型之前，科学家必须首先证明其适用性。非理想固溶体模型具有不同的复杂度，从简单的对称模型到更复杂的非对称模型。本练习将促使您像实验学家和建模者一样思考，学习如何解读实验数据的关键特征——例如溶体线的形状、量热测量值和活度数据——从而对所需热力学模型的复杂度做出明智的决策。",
            "id": "4093037",
            "problem": "在恒定压力下，研究了一种由端元组分 $A$ 和 $B$ 构成的二元结晶固溶体，其过剩体积可忽略不计。实验数据集包括相平衡（不互溶间隙）、溶解量热法数据以及来自电动势电池的活度测量值。你的任务是仅根据从这些数据集中推断出的第一性原理标准，判断何时适合使用对称单参数 Margules 正规溶体模型，以及何时需要使用非对称双参数 Margules 模型（或等效地，需要奇数项的 Redlich–Kister 展开式）。\n\n在存在不互溶间隙的温度 $T$ 范围内的观测结果显示：\n- $T$–$X_A$ 平面中的固溶线存在可测量的偏斜：其顶点出现在 $X_A \\approx 0.38$ 处，而不是 $X_A = 0.50$；并且在 $X_A \\approx 0.20$ 和 $X_A \\approx 0.80$ 附近，两个分支显示出不相等的曲率。\n- 差示扫描量热法（DSC）和溶解量热法表明，积分混合焓 $\\Delta H^{\\mathrm{mix}}(X_A)$ 为正值，最大吸热效应出现在 $X_A \\approx 0.35$ 附近的成分处；$\\Delta H^{\\mathrm{mix}}(X_A)$ 曲线明显偏斜，而不是关于 $X_A = 0.50$ 对称。\n- 稀释极限下的活度测量得出，在 $T \\approx 1000\\,\\mathrm{K}$ 时，$X_A \\to 0$ 时的 $\\ln \\gamma_A$ 比 $X_B \\to 0$ 时的 $\\ln \\gamma_B$ 大约 $\\gtrsim 2$ 倍，其代表性估计值为 $\\ln \\gamma_A(X_A \\approx 0.05) \\approx 1.1$ 和 $\\ln \\gamma_B(X_B \\approx 0.05) \\approx 0.5$。\n- 在整个成分范围内，测得的摩尔过剩体积很小，即 $|\\Delta V^{\\mathrm{ex}}| \\ll 0.1\\,\\mathrm{cm^3\\,mol^{-1}}$。\n\n仅使用化学势、活度系数、过剩吉布斯自由能之间的基本热力学关系，以及二元混合物成分对称性的推论，以下哪些标准能正确地区分何时对称单参数 Margules 模型是足够的，而何时需要非对称双参数 Margules 模型？选择所有适用项。\n\nA. 如果固溶线和 $\\Delta H^{\\mathrm{mix}}(X_A)$ 在不确定度范围内都关于 $X_A = 0.50$ 对称，并且稀释极限活度系数满足 $\\lim_{X_A \\to 0}\\ln \\gamma_A = \\lim_{X_B \\to 0}\\ln \\gamma_B$，则对称 Margules 参数化是合理的；对这些对称条件中任何一个的显著偏离都意味着需要一个非对称模型。\n\nB. 低温下的固溶线不对称性不具有诊断意义；只有高温量热法才能区分对称性。因此，只要 $\\Delta H^{\\mathrm{mix}}(X_A)$ 有一个单一最大值，无论该最大值是否出现在 $X_A \\neq 0.50$ 处，对称模型都仍然适用。\n\nC. 如果固溶线顶点和 $\\Delta H^{\\mathrm{mix}}(X_A)$ 的最大值都出现在 $X_A \\neq 0.50$ 处，并且稀释极限活度系数不相等，那么就支持使用一个具有不同的 $A$ 在 $B$ 中和 $B$ 在 $A$ 中相互作用参数的非对称 Margules 模型；此外，对称模型意味着过剩自由能展开式中的奇数成分项消失，这与观察到的偏斜不一致。\n\nD. 仅端元摩尔体积相等就意味着混合能是对称的；因此，如果 $\\Delta V^{\\mathrm{ex}} \\approx 0$，则必须使用对称 Margules 模型，即使 $\\lim_{X_A \\to 0}\\ln \\gamma_A \\neq \\lim_{X_B \\to 0}\\ln \\gamma_B$。\n\nE. 如果 $\\ln \\gamma_A(X_A)$ 和 $\\ln \\gamma_B(X_B)$ 的拐点出现在不同的成分处，这种表观的不对称性可以通过使单个 Margules 参数依赖于温度来完全吸收；不需要非对称的成分依赖性。",
            "solution": "我们从恒定温度 $T$ 和压力 $P$ 下二元混合物的核心热力学原理开始：\n- 混合的摩尔吉布斯自由能为 $G^{\\mathrm{mix}} = G^{\\mathrm{id}} + G^{\\mathrm{ex}}$，其中 $G^{\\mathrm{id}} = RT\\left(X_A \\ln X_A + X_B \\ln X_B\\right)$，$G^{\\mathrm{ex}}$ 则包含了所有的非理想性。\n- 活度系数通过 $\\ln \\gamma_i = \\left(1/RT\\right)\\left(\\partial (nG^{\\mathrm{ex}})/\\partial n_i\\right)_{T,P,n_{j\\neq i}}$ 与过剩自由能相关，其中 $n$ 是总物质的量。\n- Gibbs–Duhem 关系式 $\\sum_i X_i\\, d\\ln \\gamma_i = 0$ 约束了 $\\ln \\gamma_A$ 和 $\\ln \\gamma_B$。\n- 当对 $G^{\\mathrm{mix}}(X_A)$ 应用公切线法则得到两个共存的成分时，二元体系中会发生相分离（不互溶）；$X_A$ 中的固溶线对称性要求 $G^{\\mathrm{mix}}(X_A)$ 关于 $X_A = 0.50$ 对称。\n- 过剩自由能的成分对称性是条件 $G^{\\mathrm{ex}}(X_A) = G^{\\mathrm{ex}}(1 - X_A)$，这意味着 $G^{\\mathrm{ex}}$ 在 $(2X_A - 1)$ 的正交多项式展开中只包含偶数阶项。在 Redlich–Kister 表示法中，这对应于奇数系数的消失；在 Margules 表示法中，这对应于交叉相互作用参数的相等（对称单参数模型）。\n- 混合焓满足 $H^{\\mathrm{mix}} = G^{\\mathrm{mix}} - T\\left(\\partial G^{\\mathrm{mix}}/\\partial T\\right)_{P,\\{n_i\\}}$，因此除了相互作用参数的平滑温度依赖性外，$H^{\\mathrm{ex}}$ 继承了 $G^{\\mathrm{ex}}$ 的成分对称性质；因此，$H^{\\mathrm{ex}}(X_A)$ 的不对称性是相同温度下 $G^{\\mathrm{ex}}(X_A)$ 不对称性的直接指标。\n\n对称性对稀释极限和固溶线的推论：\n1. 在对称单参数 Margules 模型（或任何对称的 $G^{\\mathrm{ex}}$）中，等式 $G^{\\mathrm{ex}}(X_A) = G^{\\mathrm{ex}}(1 - X_A)$ 强制稀释极限活度系数相等：$\\lim_{X_A \\to 0}\\ln \\gamma_A = \\lim_{X_B \\to 0}\\ln \\gamma_B$。这可以从偏摩尔过剩吉布斯自由能的定义以及 $A$ 和 $B$ 的交换对称性推导出来。\n2. 同样的对称性意味着公切线法则产生的共存成分关于 $X_A = 0.50$ 对称，固溶线顶点位于 $X_A = 0.50$ 处，且分支呈镜像对称。\n3. 如果 $G^{\\mathrm{ex}}$ 中需要奇数成分项（例如，非零的一阶或三阶 Redlich–Kister 系数），那么 $G^{\\mathrm{ex}}(X_A) \\neq G^{\\mathrm{ex}}(1 - X_A)$，因此固溶线和 $H^{\\mathrm{ex}}(X_A)$ 都会偏斜，并且稀释极限活度系数通常会不相等。\n\n将这些原理应用于观测结果：\n- 测得的固溶线是偏斜的，其顶点在 $X_A \\approx 0.38 \\neq 0.50$ 处，且分支曲率不相等。这与对称 $G^{\\mathrm{ex}}$ 所预期的对称性相矛盾，并支持了需要非对称模型的结论。\n- 量热法测得的 $\\Delta H^{\\mathrm{mix}}(X_A)$ 在 $X_A \\approx 0.35 \\neq 0.50$ 处有最大值并且是偏斜的。因为 $H^{\\mathrm{ex}}(X_A)$ 继承了 $G^{\\mathrm{ex}}(X_A)$ 的成分对称性质（除了参数的平滑温度依赖性），这也表明了不对称性。\n- 稀释极限活度系数不相等：在 $T \\approx 1000\\,\\mathrm{K}$ 时的代表值 $\\ln \\gamma_A(X_A \\approx 0.05) \\approx 1.1$ 和 $\\ln \\gamma_B(X_B \\approx 0.05) \\approx 0.5$ 表明 $\\lim_{X_A \\to 0}\\ln \\gamma_A  \\lim_{X_B \\to 0}\\ln \\gamma_B$。对称 Margules 模型会预测在严格的稀释极限下两者相等，因此这一观测结果与对称性不一致。\n- 摩尔过剩体积很小并不约束 $G^{\\mathrm{ex}}$ 的对称性；它只表明 $\\Delta V^{\\mathrm{ex}}$ 对非理想性的贡献可以忽略不计。\n\n逐项分析：\n\nA. 此选项陈述，固溶线和 $\\Delta H^{\\mathrm{mix}}(X_A)$ 的同时对称性，以及稀释极限活度系数的相等性，支持对称 Margules 模型；反之，对这些对称条件中任何一个的显著偏离都需要非对称性。这与推导是一致的：$G^{\\mathrm{ex}}$ 的对称性意味着所有三种可观测的对称性，而违反其中任何一个都表明 $G^{\\mathrm{ex}}(X_A) \\neq G^{\\mathrm{ex}}(1 - X_A)$，需要一个非对称的表示（例如，不同的 Margules 参数或奇数 Redlich–Kister 项）。结论：正确。\n\nB. 这断言固溶线不对称性不具诊断性，并且只要 $\\Delta H^{\\mathrm{mix}}$ 有一个单一最大值，无论其位置如何，对称模型都适用。这是不正确的。最大值的位置具有诊断性：一个位于 $X_A \\neq 0.50$ 的最大值直接表明 $H^{\\mathrm{ex}}(X_A)$ 的不对称性，并因此表明 $G^{\\mathrm{ex}}(X_A)$ 的不对称性。此外，固溶线不对称性也具有诊断性，因为对称的 $G^{\\mathrm{ex}}$ 必须产生一个关于 $X_A = 0.50$ 对称的固溶线。结论：不正确。\n\nC. 此选项汇集了三个独立的不对称性指标：偏斜的固溶线顶点、偏斜的 $\\Delta H^{\\mathrm{mix}}(X_A)$ 最大值，以及不相等的稀释极限活度系数；然后它指出，对称模型将要求 $G^{\\mathrm{ex}}$ 的成分展开式中的奇数项消失，这与观察到的偏斜相冲突。这与第一性原理和观测结果一致。结论：正确。\n\nD. 这声称小的 $\\Delta V^{\\mathrm{ex}}$ 意味着对称的混合能。这将体积的非理想性与过剩吉布斯自由能的对称性混为一谈。对称性涉及 $G^{\\mathrm{ex}}$ 中 $A$ 和 $B$ 的成分交换；一个小的或零的过剩体积并不会强制 $G^{\\mathrm{ex}}(X_A)$ 等于 $G^{\\mathrm{ex}}(1 - X_A)$，也不会强加稀释极限活度系数的相等性。结论：不正确。\n\nE. 这表明 $\\ln \\gamma_i$ 中的成分不对称性可以纯粹地通过单个对称参数的温度依赖性来吸收。温度依赖性不能在固定温度 $T$ 下将一个成分上的偶函数 $G^{\\mathrm{ex}}$（对称模型）转换成一个成分上奇函数偏斜的函数；观察到的 $\\ln \\gamma_A(X_A)$ 和 $\\ln \\gamma_B(X_B)$ 形状和拐点位置的差异反映了成分不对称性，需要不同的成分依赖性（例如，双参数 Margules 模型或奇数 Redlich–Kister 项）。结论：不正确。\n\n因此，正确的选项是 A 和 C。所提供的实验观测结果共同满足了 A 和 C 中的不对称性标准，并与 B、D 和 E 的前提相矛盾。只有当所有三个对称性诊断指标（对称的固溶线、关于 $X_A = 0.50$ 对称的 $\\Delta H^{\\mathrm{mix}}(X_A)$，以及稀释极限活度系数相等）在不确定度范围内都成立时，对称单参数 Margules 模型才可被证明是合理的。否则，就需要一个非对称双参数 Margules 模型（或具有奇数项的等效表示）。",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "一旦选定了合适的模型形式（例如，非对称Margules模型），下一个关键步骤就是根据实验数据确定其参数。这个过程，即模型校准或参数化，是建立预测性热力学数据库的基础。本练习将提供计算热力学核心任务的实践经验，您将把相平衡的热力学条件——公切线法则——转化为一个线性方程组，并使用最小二乘法反演从溶体线数据中找出最佳拟合的相互作用参数（$W_{12}$ 和 $W_{21}$）。",
            "id": "4093013",
            "problem": "考虑一个由组分$1$和$2$组成的二元非理想固溶体，该固溶体可用正则溶液理论和一个非对称双参数马古利斯（Margules）过剩吉布斯自由能模型来描述。令$x$表示组分$1$的摩尔分数（因此组分$2$的摩尔分数为$1-x$）。摩尔混合吉布斯自由能定义为\n$$\ng_{\\mathrm{mix}}(x,T) \\equiv R T \\big[x \\ln x + (1-x)\\ln(1-x)\\big] + g^{E}(x),\n$$\n其中$R$是普适气体常数（此处首先定义为$R$），$T$是绝对温度（单位为开尔文），$g^{E}(x)$是由非对称双参数马古利斯形式给出的过剩吉布斯自由能\n$$\ng^{E}(x) \\equiv x(1-x)\\big[W_{12}(1-x) + W_{21}x\\big],\n$$\n其中$W_{12}$和$W_{21}$是相互作用参数（单位均为焦耳/摩尔）。在温度$T$下，固溶线上的两个平衡组分$x_{\\alpha}$和$x_{\\beta}$处，根据公切线法则要求，$g_{\\mathrm{mix}}(x,T)$在$x_{\\alpha}$和$x_{\\beta}$处的切线是同一条直线。这等价于以下一对条件\n$$\n\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T),\n\\quad\\text{and}\\quad\ng_{\\mathrm{mix}}(x_{\\alpha},T) - x_{\\alpha}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = g_{\\mathrm{mix}}(x_{\\beta},T) - x_{\\beta}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T).\n$$\n从这些热力学定义出发，构建一个最小二乘反演方法，以根据在一系列温度$\\{T_i\\}$下测量的一组固溶线组分对$\\{(x_{\\alpha,i},x_{\\beta,i})\\}$来估计参数$W_{12}$和$W_{21}$。为每个测量对构建由公切线等式所蕴含的两个残差，并组合成一个关于未知数$W_{12}$和$W_{21}$的线性系统。通过最小化数据集中所有对的残差平方和来求解$W_{12}$和$W_{21}$。\n\n您的程序必须为以下测试套件中的每个数据集实现此反演。使用$R = 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。所有温度都必须以开尔文为单位处理，所有输出都必须以焦耳/摩尔为单位表示。\n\n测试套件（每个数据集是一个$(T,\\ x_{\\alpha},\\ x_{\\beta})$的列表）：\n\n- 数据集A（一般多温度情况）：$[(950,\\ 0.12,\\ 0.88),\\ (1050,\\ 0.18,\\ 0.82),\\ (1150,\\ 0.25,\\ 0.75)]$。\n- 数据集B（信息最少的边界情况）：$[(1000,\\ 0.20,\\ 0.80)]$。\n- 数据集C（近临界对称情况）：$[(1400,\\ 0.35,\\ 0.65),\\ (1500,\\ 0.40,\\ 0.60)]$。\n\n您的程序应生成单行输出，其中包含每个数据集的$W_{12}$和$W_{21}$的估计值，按A、B、C的顺序排列，四舍五入到最接近的整数，并以$\\mathrm{J\\,mol^{-1}}$为单位表示。确切格式必须是方括号内用逗号分隔的列表，不含空格，例如$[w_{12,A},w_{21,A},w_{12,B},w_{21,B},w_{12,C},w_{21,C}]$，其中每个$w_{\\cdot,\\cdot}$都是一个整数。",
            "solution": "该问题要求从实验固溶线数据中估计非对称双参数马古利斯（Margules）相互作用参数$W_{12}$和$W_{21}$。数据由一系列在相应温度$T_i$下的平衡组分对$(x_{\\alpha,i}, x_{\\beta,i})$组成。其理论框架是应用于混合吉布斯自由能的公切线法则，该法则导出了关于未知数$W_{12}$和$W_{21}$的一组线性方程。采用线性最小二乘法求解此超定系统。\n\n摩尔混合吉布斯自由能$g_{\\mathrm{mix}}$由下式给出\n$$\ng_{\\mathrm{mix}}(x,T) = RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] + x(1-x)\\big[W_{12}(1-x) + W_{21}x\\big]\n$$\n其中$x$是组分1的摩尔分数，$R$是普适气体常数，$T$是绝对温度。\n\n在组分$x_{\\alpha}$和$x_{\\beta}$处达到相平衡的两个条件是：\n1. $g_{\\mathrm{mix}}(x,T)$切线斜率相等：$\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$\n2. 切线截距相等：$g_{\\mathrm{mix}}(x_{\\alpha},T) - x_{\\alpha}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = g_{\\mathrm{mix}}(x_{\\beta},T) - x_{\\beta}\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$\n\n我们将对这两个条件进行关于$W_{12}$和$W_{21}$的线性化。\n\n首先，我们推导$g_{\\mathrm{mix}}(x,T)$关于$x$的一阶导数：\n$$\n\\frac{d g_{\\mathrm{mix}}}{dx} = \\frac{d}{dx} \\left( RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] \\right) + \\frac{d}{dx} \\left( g^E(x) \\right)\n$$\n理想混合项的导数是：\n$$\n\\frac{d}{dx} \\left( RT \\big[x \\ln x + (1-x)\\ln(1-x)\\big] \\right) = RT\\left(\\ln x + 1 - \\ln(1-x) - 1\\right) = RT \\ln\\left(\\frac{x}{1-x}\\right)\n$$\n过剩能项$g^E(x)$可以写作$g^E(x) = W_{12}x(1-x)^2 + W_{21}x^2(1-x)$。对其求导可得：\n$$\n\\frac{d g^E}{dx} = W_{12}\\left((1-x)^2 - 2x(1-x)\\right) + W_{21}\\left(2x(1-x) - x^2\\right) = W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\n$$\n因此，完整的导数是：\n$$\n\\frac{d g_{\\mathrm{mix}}}{dx} = RT \\ln\\left(\\frac{x}{1-x}\\right) + W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\n$$\n\n现在，我们为每个数据点$(T, x_{\\alpha}, x_{\\beta})$建立两个线性方程。\n\n**方程1：源于导数相等**\n应用第一个平衡条件$\\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\alpha},T) = \\frac{d g_{\\mathrm{mix}}}{d x}(x_{\\beta},T)$：\n$$\nRT \\ln\\left(\\frac{x_\\alpha}{1-x_\\alpha}\\right) + W_{12}(1-x_\\alpha)(1-3x_\\alpha) + W_{21}x_\\alpha(2-3x_\\alpha) = RT \\ln\\left(\\frac{x_\\beta}{1-x_\\beta}\\right) + W_{12}(1-x_\\beta)(1-3x_\\beta) + W_{21}x_\\beta(2-3x_\\beta)\n$$\n重新整理，将含有$W_{12}$和$W_{21}$的项分组：\n$$\nW_{12} \\underbrace{\\left[ (1-x_\\alpha)(1-3x_\\alpha) - (1-x_\\beta)(1-3x_\\beta) \\right]}_{A_1} + W_{21} \\underbrace{\\left[ x_\\alpha(2-3x_\\alpha) - x_\\beta(2-3x_\\beta) \\right]}_{B_1} = \\underbrace{RT\\left[\\ln\\left(\\frac{x_\\beta}{1-x_\\beta}\\right) - \\ln\\left(\\frac{x_\\alpha}{1-x_\\alpha}\\right)\\right]}_{C_1}\n$$\n这就得到了每个数据点的第一个线性方程：$A_1 W_{12} + B_1 W_{21} = C_1$。\n\n**方程2：源于切线截距相等**\n截距项$g_{\\mathrm{mix}}(x) - x\\frac{d g_{\\mathrm{mix}}}{dx}$是组分2的化学势，$\\mu_2(x)$。\n$$\n\\mu_2(x) = RT\\ln(1-x) + \\mu_2^E(x)\n$$\n其中$\\mu_2^E(x) = g^E(x) - x\\frac{d g^E}{dx}$。使用我们得到的$g^E(x)$及其导数的表达式：\n$$\n\\mu_2^E(x) = \\left[W_{12}x(1-x)^2 + W_{21}x^2(1-x)\\right] - x\\left[W_{12}(1-x)(1-3x) + W_{21}x(2-3x)\\right]\n$$\n化简后，变为：\n$$\n\\mu_2^E(x) = W_{12}\\left(2x^2(1-x)\\right) + W_{21}\\left(x^2(2x-1)\\right)\n$$\n第二个平衡条件是$\\mu_2(x_\\alpha, T) = \\mu_2(x_\\beta, T)$：\n$$\nRT\\ln(1-x_\\alpha) + W_{12}(2x_\\alpha^2(1-x_\\alpha)) + W_{21}(x_\\alpha^2(2x_\\alpha-1)) = RT\\ln(1-x_\\beta) + W_{12}(2x_\\beta^2(1-x_\\beta)) + W_{21}(x_\\beta^2(2x_\\beta-1))\n$$\n重新整理以分离$W_{12}$和$W_{21}$：\n$$\nW_{12} \\underbrace{\\left[ 2x_\\alpha^2(1-x_\\alpha) - 2x_\\beta^2(1-x_\\beta) \\right]}_{A_2} + W_{21} \\underbrace{\\left[ x_\\alpha^2(2x_\\alpha-1) - x_\\beta^2(2x_\\beta-1) \\right]}_{B_2} = \\underbrace{RT\\left[\\ln(1-x_\\beta) - \\ln(1-x_\\alpha)\\right]}_{C_2}\n$$\n这就得到了每个数据点的第二个线性方程：$A_2 W_{12} + B_2 W_{21} = C_2$。\n\n**最小二乘法公式**\n对于一个包含$N$个测量点$\\{(T_i, x_{\\alpha,i}, x_{\\beta,i})\\}_{i=1}^N$的数据集，我们得到$2N$个关于两个未知数$W_{12}$和$W_{21}$的线性方程。这个超定系统可以写成矩阵形式$\\mathbf{M}\\mathbf{w} = \\mathbf{d}$，其中$\\mathbf{w} = [W_{12}, W_{21}]^T$。矩阵$\\mathbf{M}$和向量$\\mathbf{d}$组合如下：\n$$\n\\mathbf{M} = \\begin{pmatrix} A_{1,1}  B_{1,1} \\\\ A_{2,1}  B_{2,1} \\\\ A_{1,2}  B_{1,2} \\\\ A_{2,2}  B_{2,2} \\\\ \\vdots  \\vdots \\\\ A_{1,N}  B_{1,N} \\\\ A_{2,N}  B_{2,N} \\end{pmatrix}, \\quad\n\\mathbf{d} = \\begin{pmatrix} C_{1,1} \\\\ C_{2,1} \\\\ C_{1,2} \\\\ C_{2,2} \\\\ \\vdots \\\\ C_{1,N} \\\\ C_{2,N} \\end{pmatrix}\n$$\n目标是找到向量$\\mathbf{w}$，使得残差平方和$||\\mathbf{M}\\mathbf{w} - \\mathbf{d}||_2^2$最小。这是一个标准的线性最小二乘问题，可以通过数值方法求解。其解提供了$W_{12}$和$W_{21}$的最佳拟合估计值。\n\n计算实现将根据所提供的数据集构建矩阵$\\mathbf{M}$和向量$\\mathbf{d}$，并使用`numpy.linalg.lstsq`函数来寻找最优参数值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for Margules parameters for all test datasets.\n    \"\"\"\n    # Universal Gas Constant in J/(mol*K)\n    R = 8.314\n\n    # Test suite datasets\n    test_cases = {\n        \"A\": [(950, 0.12, 0.88), (1050, 0.18, 0.82), (1150, 0.25, 0.75)],\n        \"B\": [(1000, 0.20, 0.80)],\n        \"C\": [(1400, 0.35, 0.65), (1500, 0.40, 0.60)],\n    }\n\n    def calculate_w_params(dataset, R_const):\n        \"\"\"\n        Calculates W12 and W21 for a given dataset using least-squares inversion.\n\n        Args:\n            dataset (list): A list of tuples, where each tuple is (T, x_alpha, x_beta).\n            R_const (float): The Universal Gas Constant.\n\n        Returns:\n            tuple: A tuple containing the estimated (W12, W21).\n        \"\"\"\n        M_rows = []\n        d_vals = []\n\n        for T, xa, xb in dataset:\n            # First equilibrium condition: equality of derivatives\n            # A1*W12 + B1*W21 = C1\n            A1 = (1 - xa) * (1 - 3 * xa) - (1 - xb) * (1 - 3 * xb)\n            B1 = xa * (2 - 3 * xa) - xb * (2 - 3 * xb)\n            # Use a small epsilon to avoid log(0) if xa or xb are 0 or 1, although not needed for this problem's data\n            eps = 1e-12\n            C1 = R_const * T * (np.log(xb / (1 - xb + eps)) - np.log(xa / (1 - xa + eps)))\n\n            M_rows.append([A1, B1])\n            d_vals.append(C1)\n\n            # Second equilibrium condition: equality of tangent intercepts (chemical potential of comp 2)\n            # A2*W12 + B2*W21 = C2\n            A2 = 2 * xa**2 * (1 - xa) - 2 * xb**2 * (1 - xb)\n            B2 = xa**2 * (2 * xa - 1) - xb**2 * (2 * xb - 1)\n            C2 = R_const * T * (np.log(1 - xb + eps) - np.log(1 - xa + eps))\n            \n            M_rows.append([A2, B2])\n            d_vals.append(C2)\n\n        M = np.array(M_rows)\n        d = np.array(d_vals)\n\n        # Solve the system M*w = d using linear least-squares\n        # lstsq returns solution, residuals, rank, singular values\n        solution, _, _, _ = np.linalg.lstsq(M, d, rcond=None)\n        \n        W12, W21 = solution\n        return W12, W21\n\n    # Process all datasets and collect results\n    final_results = []\n    dataset_order = [\"A\", \"B\", \"C\"]\n\n    for key in dataset_order:\n        dataset = test_cases[key]\n        w12, w21 = calculate_w_params(dataset, R)\n        \n        # Round to the nearest integer as per problem specification\n        final_results.append(int(np.round(w12)))\n        final_results.append(int(np.round(w21)))\n\n    # Print the final result in the exact specified format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个经过校准的热力学模型是模拟地球化学过程的强大工具，但其数值实现并非总是直截了当。在临界点或旋节线区域附近，相的稳定性处于边缘状态，标准的数值算法可能会变得不稳定甚至失效。这个高级练习将深入探讨热力学与数值分析交叉的关键领域，您将探索为何数值方法在临界点附近会变得敏感，并实践正则化技术以构建一个稳健的求解器，从而确保您的计算模型即使在具有挑战性的物理条件下也同样可靠。",
            "id": "4093050",
            "problem": "考虑一个由带有 Margules 参数的对称正则溶体模型描述的二元非理想固溶体。混合摩尔吉布斯能由下式给出：\n$$\nG_{\\mathrm{mix}}(x;T,W) = R\\,T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] + W\\,x(1-x),\n$$\n其中 $x$ 是组分 $\\mathrm{A}$ 的摩尔分数，$T$ 是绝对温度（单位为 $\\mathrm{K}$），$R$ 是通用气体常数（单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$），$W$ 是（对称的）Margules 参数（单位为 $\\mathrm{J\\,mol^{-1}}$）。与某个源达到平衡时相关的化学势差（驱动力）是吉布斯能对成分的导数，即 $\\mu(x) = \\dfrac{dG_{\\mathrm{mix}}}{dx}$，局部曲率为 $\\dfrac{d^2G_{\\mathrm{mix}}}{dx^2}$。在临界或亚稳相分解（spinodal）条件下，对于给定的 $\\mu_0$，非线性方程 $\\mu(x) = \\mu_0$ 的数值解会变得敏感，因为 $\\dfrac{d^2G_{\\mathrm{mix}}}{dx^2}\\approx 0$ 会使牛顿类型（Newton-type）的更新步呈病态（ill-conditioned）。\n\n您的任务是：\n- 从给定的 $G_{\\mathrm{mix}}(x;T,W)$ 出发，推导 $\\mu(x)$ 和 $\\dfrac{d^2G_{\\mathrm{mix}}}{dx^2}$ 作为 $x$、$T$、$R$ 和 $W$ 的函数的显式符号表达式。\n- 从曲率表达式中，推导等摩尔成分下的临界条件，并解释曲率幅度变小的参数区域。将其与求解 $\\mu(x)=\\mu_0$ 时牛顿法（Newton’s method）的预期数值敏感性联系起来。\n- 设计并实现一个稳健的求根算法，仅使用一阶和二阶导数来求解 $x\\in(0,1)$ 范围内的方程 $\\mu(x)=\\mu_0$。您的算法必须包含以下稳定化正则策略中的至少两种：\n  1. Levenberg–Marquardt 风格的Hessian脊（ridge），将牛顿法的分母替换为 $\\mathrm{sign}\\!\\left(\\mu'(x)\\right)\\max\\!\\left(|\\mu'(x)|,\\lambda\\right)$，其中 $\\lambda$ 是一个选定的小正数，单位为 $\\mathrm{J\\,mol^{-1}}$。\n  2. 对平方残差目标函数 $\\phi(x)=\\dfrac{1}{2}\\left(\\mu(x)-\\mu_0\\right)^2$ 进行回溯线搜索，并采用 Armijo 型的充分下降条件。\n  3. 投影（裁剪），在每个试探步强制 $x\\in[\\varepsilon,1-\\varepsilon]$，其中 $\\varepsilon$ 是一个选定的无量纲成分小量。\n- 通过在一组包含临界区域附近和远离临界区域的参数集的测试套件上运行您的算法，来量化临界点附近的敏感性。使用通用气体常数 $R=8.314$（单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$）。除非另有说明，否则使用温度 $T=1000$（单位为 $\\mathrm{K}$）。目标成分是介于 $0$ 和 $1$ 之间的无量纲数。\n\n实现一个程序，为每个测试用例计算方程 $\\mu(x^\\star)=\\mu_0$ 的解 $x^\\star$，并汇总这些解。所有物理输入量 $W$ 和 $\\mu_0$ 都必须以 $\\mathrm{J\\,mol^{-1}}$ 为单位进行解释。角度不会出现。将输出的成分报告为无量纲的浮点数。\n\n测试套件：\n- A例（良态区域）：$T=1000$， $W=1.5\\,R\\,T$， $\\mu_0=500$，初始猜测值 $x_0=0.3$。\n- B例（近临界曲率，小驱动力）：$T=1000$， $W=2.0\\,R\\,T\\,(1-10^{-6})$， $\\mu_0=10$，初始猜测值 $x_0=0.45$。\n- C例（超临界，多根区域；通过初始猜测值选择高$x$分支）：$T=1000$， $W=2.5\\,R\\,T$， $\\mu_0=100$，初始猜测值 $x_0=0.6$。\n- D例（理想溶液边界情况）：$T=1000$， $W=0$， $\\mu_0=5\\,R\\,T$，初始猜测值 $x_0=0.9$。\n\n数值要求和约定：\n- 使用上面给出的 $R=8.314$（单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$）和 $T$（单位为 $\\mathrm{K}$）。所有 $W$ 和 $\\mu_0$ 的值都以 $\\mathrm{J\\,mol^{-1}}$ 为单位。成分 $x$ 是无量纲的。\n- 对于每个案例，您的算法必须终止于一个成分 $x^\\star\\in(0,1)$，且其残差 $|\\mu(x^\\star)-\\mu_0|$ 相对于 $R\\,T$ 的 $\\mathrm{J\\,mol^{-1}}$ 标度在数值上很小。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，顺序与上面显示的测试用例一致。该列表必须包含与四个 $x^\\star$ 解相对应的四个浮点数。输出行中不允许有任何额外的文本或空白字符。",
            "solution": "该问题在科学上和数学上是适定的。它涉及计算材料科学和地球化学中的一个标准课题，即非理想二元溶液中平衡成分的数值求解。所有必需的参数都已提供，单位一致，任务明确。我将开始进行解答。\n\n解答分三部分呈现。首先，从给定的混合吉布斯能推导出化学势和曲率的必要符号表达式。其次，推导临界条件并分析其对数值稳定性的影响。第三，设计一个包含指定稳定化技术的稳健求根算法。\n\n对称二元正则溶体的混合摩尔吉布斯能由下式给出：\n$$\nG_{\\mathrm{mix}}(x;T,W) = R\\,T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] + W\\,x(1-x)\n$$\n其中 $x$ 是一个组分的摩尔分数，$T$ 是绝对温度，$R$ 是通用气体常数，$W$ 是 Margules 相互作用参数。所有能量项（$G_{\\mathrm{mix}}$、$RT$、$W$）都以 $\\mathrm{J\\,mol^{-1}}$ 为单位表示。\n\n驱动成分变化的化学势差是 $G_{\\mathrm{mix}}$ 对摩尔分数 $x$ 的一阶导数。我们将其表示为 $\\mu(x) = \\dfrac{dG_{\\mathrm{mix}}}{dx}$。为推导其表达式，我们对 $G_{\\mathrm{mix}}$ 逐项求导：\n$$\n\\frac{d}{dx} \\left( R\\,T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] \\right) = R\\,T\\left[ (\\ln x + x\\cdot\\frac{1}{x}) + (-\\ln(1-x) + (1-x)\\cdot\\frac{-1}{1-x}) \\right]\n$$\n$$\n= R\\,T\\left[ \\ln x + 1 - \\ln(1-x) - 1 \\right] = R\\,T\\left[\\ln x - \\ln(1-x) \\right] = R\\,T\\ln\\left(\\frac{x}{1-x}\\right)\n$$\n非理想（超额）项的导数是：\n$$\n\\frac{d}{dx} \\left( W\\,x(1-x) \\right) = \\frac{d}{dx} \\left( W(x-x^2) \\right) = W(1-2x)\n$$\n综合这些结果，化学势差的显式符号表达式为：\n$$\n\\mu(x) = R\\,T\\ln\\left(\\frac{x}{1-x}\\right) + W(1-2x)\n$$\n\n吉布斯能曲面的局部曲率是二阶导数 $\\dfrac{d^2G_{\\mathrm{mix}}}{dx^2}$，它也是化学势的导数 $\\mu'(x)$。我们对 $\\mu(x)$ 求导：\n$$\n\\frac{d}{dx}\\left(R\\,T\\ln\\left(\\frac{x}{1-x}\\right)\\right) = R\\,T\\frac{d}{dx}(\\ln x - \\ln(1-x)) = R\\,T\\left(\\frac{1}{x} - \\frac{-1}{1-x}\\right) = R\\,T\\left(\\frac{1}{x} + \\frac{1}{1-x}\\right) = \\frac{R\\,T}{x(1-x)}\n$$\n$$\n\\frac{d}{dx}\\left(W(1-2x)\\right) = -2W\n$$\n综合这些，曲率的表达式为：\n$$\n\\frac{d^2G_{\\mathrm{mix}}}{dx^2} = \\mu'(x) = \\frac{R\\,T}{x(1-x)} - 2W\n$$\n\n接下来，我们分析临界条件。在此背景下，临界性指的是相分离的开始。单相溶液的稳定性极限（spinodal，亚稳相分解线）是曲率变为零的地方，即 $\\dfrac{d^2G_{\\mathrm{mix}}}{dx^2}=0$。临界点是亚稳相分解曲线的顶点，对于对称溶液，它出现在等摩尔成分 $x=0.5$ 处。\n将 $x=0.5$ 代入曲率表达式并令其为零：\n$$\n\\mu'(0.5) = \\frac{R\\,T}{0.5(1-0.5)} - 2W = \\frac{R\\,T}{0.25} - 2W = 4R\\,T - 2W = 0\n$$\n这就给出了对称正则溶体模型的著名临界条件：\n$$\nW = 2R\\,T\n$$\n在给定温度 $T$ 下，如果 $W  2R\\,T$，则对于所有 $x \\in (0, 1)$，曲率 $\\mu'(x)$ 均为正，溶液是稳定或亚稳的。如果 $W > 2R\\,T$，则在 $x=0.5$ 附近存在一个成分范围，其中 $\\mu'(x)  0$，导致亚稳相分解（spinodal decomposition）。当参数 $(T, W)$ 使得 $W$ 非常接近 $2R\\,T$ 时，对于接近 $x=0.5$ 的成分，曲率 $\\mu'(x)$ 的幅度会变得非常小。\n\n这种近临界条件对平衡方程 $\\mu(x) = \\mu_0$ 的数值解有直接影响。该问题是函数 $f(x) = \\mu(x) - \\mu_0 = 0$ 的求根问题。解决这个问题的标准算法是牛顿法（Newton's method），它使用迭代更新：\n$$\nx_{k+1} = x_k - \\frac{f(x_k)}{f'(x_k)} = x_k - \\frac{\\mu(x_k) - \\mu_0}{\\mu'(x_k)}\n$$\n当系统接近临界点时，分母 $\\mu'(x_k)$ 接近于零。这使得更新步长变得极大，导致迭代发散或剧烈振荡。这是一个经典的病态数值问题。为了克服这个问题，需要一个稳健的算法。\n\n按照要求，通过修改牛顿法并结合几种稳定化策略，设计了一个稳健的求解器。该算法将求解关于 $x$ 的方程 $f(x) = \\mu(x) - \\mu_0 = 0$。\n算法的核心是一个正则化的牛顿步，后跟一个回溯线搜索。\n1. **Levenberg–Marquardt 风格的Hessian脊**：为了处理小的分母 $\\mu'(x)$，牛顿更新步被正则化。分母 $\\mu'(x)$ 被替换为 $\\mathrm{sign}(\\mu'(x))\\max(|\\mu'(x)|, \\lambda)$，其中 $\\lambda$ 是一个单位为 $\\mathrm{J\\,mol^{-1}}$ 的小正参数。这可以防止除以接近零的数，并在曲率很小时限制步长。更新方向为 $p_k = - \\frac{\\mu(x_k) - \\mu_0}{\\mathrm{sign}(\\mu'(x_k))\\max(|\\mu'(x_k)|, \\lambda)}$。即使在 $\\mu'(x)  0$ 的亚稳相分解区域，符号项也能确保步长方向正确。\n2. **投影（裁剪）**：摩尔分数 $x$ 在物理上必须保持在区间 $(0, 1)$ 内。$\\mu(x)$ 中的对数项在边界处发散。为了保持数值稳定性和物理有效性，每个试探迭代值 $x_{k+1}^{\\text{trial}}$ 都被投影到区间 $[\\varepsilon, 1-\\varepsilon]$ 内，其中 $\\varepsilon$ 是一个小的正无量纲数（例如 $10^{-9}$）。\n3. **回溯线搜索**：一个完整的牛顿步（$\\alpha=1$）可能不会导致误差减小。采用回溯线搜索来寻找一个可接受的步长 $\\alpha \\in (0, 1]$。该搜索确保目标函数有足够的下降，对于求根问题，目标函数很自然地是平方残差 $\\phi(x) = \\frac{1}{2} f(x)^2 = \\frac{1}{2}(\\mu(x) - \\mu_0)^2$。使用 Armijo 条件：\n$$\n\\phi(x_k + \\alpha p_k) \\le \\phi(x_k) + c\\,\\alpha\\,\\nabla\\phi(x_k)^T p_k\n$$\n其中 $c$ 是一个小常数（例如 $10^{-4}$），方向导数为 $\\nabla\\phi(x_k)^T p_k = f(x_k)f'(x_k)p_k$。线搜索从 $\\alpha=1$ 开始，每次将其乘以一个因子 $\\beta$（例如 $0.5$）进行缩减，直到满足此条件。\n\n这种复合算法（带线搜索和投影的正则化牛顿步）对于临界点附近的病态条件是稳健的，并保证迭代值保持在有效的物理域内。\n\n该算法使用常数 $R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 实现并应用于四个测试用例。每个案例的初始猜测值 $x_0$ 引导求解器找到所需的根，这在存在多个根的C例中尤为重要。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the solver for each,\n    and print the results in the specified format.\n    \"\"\"\n    R = 8.314  # J mol^-1 K^-1\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case A: Well-conditioned regime\n        {'T': 1000, 'W': 1.5 * R * 1000, 'mu0': 500, 'x0': 0.3},\n        # Case B: Near-critical curvature, small driving force\n        {'T': 1000, 'W': 2.0 * R * 1000 * (1 - 1e-6), 'mu0': 10, 'x0': 0.45},\n        # Case C: Above critical, multi-root regime\n        {'T': 1000, 'W': 2.5 * R * 1000, 'mu0': 100, 'x0': 0.6},\n        # Case D: Ideal-solution boundary case\n        {'T': 1000, 'W': 0, 'mu0': 5 * R * 1000, 'x0': 0.9}\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case['T']\n        W = case['W']\n        mu0 = case['mu0']\n        x0 = case['x0']\n\n        # Define the function f(x) = mu(x) - mu0 to find its root\n        def f(x):\n            # mu(x) = R*T*ln(x/(1-x)) + W*(1-2x)\n            # Avoid log(0) or division by zero, although projection handles this.\n            if x = 0 or x >= 1:\n                return np.inf\n            return R * T * np.log(x / (1 - x)) + W * (1 - 2 * x) - mu0\n\n        # Define the derivative f'(x) = mu'(x)\n        def df(x):\n            # mu'(x) = R*T/(x*(1-x)) - 2*W\n            if x = 0 or x >= 1:\n                return np.inf\n            return R * T / (x * (1 - x)) - 2 * W\n\n        # Solve for the root x*\n        x_star = robust_newton_solver(f, df, x0)\n        results.append(x_star)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\ndef robust_newton_solver(func, dfunc, x0, tol=1e-12, max_iter=100,\n                         epsilon=1e-10, lambda_lm=1.0, \n                         c_armijo=1e-4, beta_bt=0.5):\n    \"\"\"\n    Implements a robust Newton-Raphson solver with three stabilization strategies:\n    1. Levenberg-Marquardt style ridge on the denominator.\n    2. Projection (clipping) to keep iterates within a valid domain.\n    3. Backtracking line search with Armijo condition.\n    \n    Args:\n        func (callable): The function f(x) for which to find a root, f(x)=0.\n        dfunc (callable): The derivative of the function, f'(x).\n        x0 (float): Initial guess for the root.\n        tol (float): Tolerance for convergence, checks |f(x)|  tol.\n        max_iter (int): Maximum number of iterations.\n        epsilon (float): Boundary for projection, x is kept in [epsilon, 1-epsilon].\n        lambda_lm (float): Regularization parameter for the LM-style ridge.\n        c_armijo (float): Parameter for the Armijo condition.\n        beta_bt (float): Reduction factor for alpha in backtracking.\n\n    Returns:\n        float: The found root x*.\n    \"\"\"\n    x = x0\n\n    for _ in range(max_iter):\n        f_val = func(x)\n\n        if abs(f_val)  tol:\n            return x\n\n        df_val = dfunc(x)\n\n        # 1. Levenberg-Marquardt style Hessian ridge\n        denominator = np.sign(df_val) * max(abs(df_val), lambda_lm)\n        \n        # Guard against zero denominator in edge cases (although max should prevent this)\n        if denominator == 0:\n            p = -f_val # Fallback to a simple gradient descent like step\n        else:\n            p = -f_val / denominator\n\n        # 3. Backtracking line search\n        alpha = 1.0\n        \n        # Pre-calculate part of the Armijo condition that doesn't depend on alpha\n        armijo_check_term = c_armijo * f_val * df_val * p\n\n        while True:\n            # 2. Projection (clipping) applied to the trial step\n            x_new = max(epsilon, min(1.0 - epsilon, x + alpha * p))\n\n            f_new = func(x_new)\n            \n            # Armijo condition for the squared residual objective phi(x) = 0.5 * f(x)^2\n            # sufficient decrease: phi(x_new) = phi(x) + c*alpha*grad(phi)^T*p\n            if 0.5 * f_new**2 = 0.5 * f_val**2 + alpha * armijo_check_term:\n                break\n            \n            alpha *= beta_bt\n            if alpha  1e-9: # If step becomes too small, break to avoid stalling\n                break\n        \n        x = x_new\n        \n        # An alternative check on step size for convergence\n        if abs(alpha * p)  tol * 1e-2:\n            return x\n\n    # If max_iter reached without convergence, return the last computed value.\n    # The problem setup ensures convergence is expected.\n    return x\n\n# Execute the main function\nsolve()\n\n```"
        }
    ]
}