{
    "hands_on_practices": [
        {
            "introduction": "本次练习旨在构建水化学物种形态计算的坚实基础。我们将分析一个经典的金属-配体络合反应，通过联立质量作用定律与质量平衡方程，精确求解体系中各物种的平衡浓度。这项基础实践是后续掌握更复杂地球化学模型必不可少的第一步。",
            "id": "4069852",
            "problem": "一个温度为 $25^{\\circ}\\mathrm{C}$ 的水溶液中含有一种二价金属离子 $M^{2+}$ 和一种单价配体 $L^{-}$，它们根据缔合反应 $M^{2+} + L^{-} \\rightleftharpoons ML^{+}$ 形成 $1:1$ 的配合物 $ML^{+}$。在 $25^{\\circ}\\mathrm{C}$ 时，以重量摩尔浓度标度的标准态生成常数给出为 $\\log K^{\\circ} = 5.0$。假设为理想行为，所有单个离子的活度系数均为1，即 $\\gamma_{i} = 1$，并且溶液中仅存在 $M^{2+}$、$L^{-}$ 和 $ML^{+}$ 这三种物质。总重量摩尔浓度为 $m_{M}^{\\mathrm{tot}} = 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$ 和 $m_{L}^{\\mathrm{tot}} = 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$。\n\n从重量摩尔浓度标度下的活度定义、标准态平衡常数的质量作用定律以及元素质量平衡出发，推导确定平衡组成所需的代数关系式。计算在这些条件下配合物的平衡重量摩尔浓度 $m_{ML}$。将你的最终结果四舍五入至 $4$ 位有效数字。最终答案以 $\\mathrm{mol\\,kg^{-1}}$ 为单位表示。",
            "solution": "该问题要求计算含有金属离子 $M^{2+}$、配体 $L^{-}$ 及其配合物 $ML^{+}$ 的水溶液的平衡组成。求解过程基于质量作用定律和质量平衡原理的同时应用。\n\n首先，我们为溶液中存在的物种的平衡重量摩尔浓度定义变量：\n- $m_{M^{2+}}$：自由金属离子的平衡重量摩尔浓度。\n- $m_{L^{-}}$：自由配体的平衡重量摩尔浓度。\n- $m_{ML^{+}}$：金属-配体配合物的平衡重量摩尔浓度。\n\n配合物的形成由以下反应描述：\n$$M^{2+} + L^{-} \\rightleftharpoons ML^{+}$$\n\n质量作用定律通过标准态平衡常数 $K^{\\circ}$ 将平衡时各物种的活度联系起来。其表达式为：\n$$K^{\\circ} = \\frac{a_{ML^{+}}}{a_{M^{2+}} a_{L^{-}}}$$\n问题指出标准态生成常数为 $\\log K^{\\circ} = 5.0$，这意味着 $K^{\\circ} = 10^{5.0}$。在重量摩尔浓度标度下，物种 $i$ 的活度 $a_i$ 定义为 $a_i = \\gamma_i \\frac{m_i}{m^{\\circ}}$，其中 $\\gamma_i$ 是活度系数，$m_i$ 是其重量摩尔浓度，$m^{\\circ} = 1\\,\\mathrm{mol\\,kg^{-1}}$ 是标准重量摩尔浓度。\n问题指定了理想行为，意味着所有活度系数均为1 ($\\gamma_i = 1$)。因此，活度在数值上等于相对于标准态的重量摩尔浓度：$a_i = m_i/m^{\\circ}$。将此代入平衡表达式中得到：\n$$K^{\\circ} = \\frac{ (m_{ML^{+}} / m^{\\circ}) }{ (m_{M^{2+}} / m^{\\circ}) (m_{L^{-}} / m^{\\circ}) } = \\frac{m_{ML^{+}} m^{\\circ}}{m_{M^{2+}} m_{L^{-}}}$$\n\n接下来，我们为总金属（$M$）和总配体（$L$）建立质量平衡方程。每种元素的总重量摩尔浓度是包含该元素的所有物种的重量摩尔浓度之和。\n金属的总重量摩尔浓度 $m_{M}^{\\mathrm{tot}} = 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$ 由下式给出：\n$$m_{M}^{\\mathrm{tot}} = m_{M^{2+}} + m_{ML^{+}}$$\n配体的总重量摩尔浓度 $m_{L}^{\\mathrm{tot}} = 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$ 由下式给出：\n$$m_{L}^{\\mathrm{tot}} = m_{L^{-}} + m_{ML^{+}}$$\n\n设 $x$ 为配合物的未知平衡重量摩尔浓度，即 $x = m_{ML^{+}}$。我们可以使用质量平衡方程，用 $x$ 和总重量摩尔浓度来表示自由物种的平衡重量摩尔浓度：\n$$m_{M^{2+}} = m_{M}^{\\mathrm{tot}} - x$$\n$$m_{L^{-}} = m_{L}^{\\mathrm{tot}} - x$$\n为使这些浓度具有物理意义，$x$ 必须为正，且不能超过任一总重量摩尔浓度：$0 \\le x \\le m_{M}^{\\mathrm{tot}}$ 且 $0 \\le x \\le m_{L}^{\\mathrm{tot}}$。\n\n现在我们将 $m_{M^{2+}}$ 和 $m_{L^{-}}$ 的这些表达式代入平衡常数方程。这就得出了求解平衡组成所需的代数关系式：\n$$K^{\\circ} = \\frac{x m^{\\circ}}{(m_{M}^{\\mathrm{tot}} - x)(m_{L}^{\\mathrm{tot}} - x)}$$\n该方程将配合物的未知平衡重量摩尔浓度 $x$ 与已知的总重量摩尔浓度和平衡常数联系起来。为了求解 $x$，我们将此方程重排为标准二次方程形式 $Ax^2 + Bx + C = 0$。\n$$K^{\\circ} (m_{M}^{\\mathrm{tot}} - x)(m_{L}^{\\mathrm{tot}} - x) = x m^{\\circ}$$\n$$K^{\\circ} (m_{M}^{\\mathrm{tot}}m_{L}^{\\mathrm{tot}} - (m_{M}^{\\mathrm{tot}} + m_{L}^{\\mathrm{tot}})x + x^2) = x m^{\\circ}$$\n$$K^{\\circ}x^2 - K^{\\circ}(m_{M}^{\\mathrm{tot}} + m_{L}^{\\mathrm{tot}})x + K^{\\circ}m_{M}^{\\mathrm{tot}}m_{L}^{\\mathrm{tot}} = x m^{\\circ}$$\n$$K^{\\circ}x^2 - [K^{\\circ}(m_{M}^{\\mathrm{tot}} + m_{L}^{\\mathrm{tot}}) + m^{\\circ}]x + K^{\\circ}m_{M}^{\\mathrm{tot}}m_{L}^{\\mathrm{tot}} = 0$$\n\n我们现在代入给定的数值：\n$K^{\\circ} = 10^{5.0}$\n$m_{M}^{\\mathrm{tot}} = 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$\n$m_{L}^{\\mathrm{tot}} = 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$\n$m^{\\circ} = 1\\,\\mathrm{mol\\,kg^{-1}}$\n\n为简化计算，我们可以将重量摩尔浓度视为数值，单位默认为 $\\mathrm{mol\\,kg^{-1}}$。$x$ 的二次方程变为：\n$$10^5 x^2 - [10^5(10^{-4} + 10^{-3}) + 1]x + 10^5(10^{-4})(10^{-3}) = 0$$\n我们来计算系数：\n$x^2$ 的系数是 $A = 10^5$。\n$x$ 的系数是 $B = -[10^5(1.1 \\times 10^{-3}) + 1] = -[110 + 1] = -111$。\n常数项是 $C = 10^5(10^{-7}) = 10^{-2} = 0.01$。\n\n得到的二次方程是：\n$$100000 x^2 - 111 x + 0.01 = 0$$\n我们使用二次公式 $x = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 来求解 $x$：\n$$x = \\frac{111 \\pm \\sqrt{(-111)^2 - 4(100000)(0.01)}}{2(100000)}$$\n$$x = \\frac{111 \\pm \\sqrt{12321 - 4000}}{200000}$$\n$$x = \\frac{111 \\pm \\sqrt{8321}}{200000}$$\n计算平方根的值：$\\sqrt{8321} \\approx 91.219515$。\n$$x = \\frac{111 \\pm 91.219515}{200000}$$\n这得出了 $x$ 的两个可能的数学解：\n$$x_1 = \\frac{111 + 91.219515}{200000} = \\frac{202.219515}{200000} \\approx 1.011 \\times 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$$\n$$x_2 = \\frac{111 - 91.219515}{200000} = \\frac{19.780485}{200000} \\approx 9.89024 \\times 10^{-5}\\,\\mathrm{mol\\,kg^{-1}}$$\n\n为了确定物理上正确的解，我们回想一下，配合物的重量摩尔浓度 $x$ 不能超过其任何组分的总重量摩尔浓度。限制反应物是金属，其 $m_{M}^{\\mathrm{tot}} = 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$。因此，任何有效的 $x$ 解都必须满足 $x \\le 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$。\n- 第一个根 $x_1 \\approx 1.011 \\times 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$ 大于 $m_{M}^{\\mathrm{tot}}$。这个解在物理上是不可能的，因为它需要比体系中可用的金属更多的金属来形成配合物。\n- 第二个根 $x_2 \\approx 9.89024 \\times 10^{-5}\\,\\mathrm{mol\\,kg^{-1}}$ 小于 $m_{M}^{\\mathrm{tot}} = 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$。这个解在物理上是有效的。\n\n因此，配合物 $ML^{+}$ 的平衡重量摩尔浓度是 $m_{ML^{+}} = x_2$。\n问题要求将结果四舍五入到4位有效数字。\n$m_{ML^{+}} \\approx 9.890 \\times 10^{-5}\\,\\mathrm{mol\\,kg^{-1}}$。",
            "answer": "$$\\boxed{9.890 \\times 10^{-5}}$$"
        },
        {
            "introduction": "在掌握了简单体系的计算后，我们进阶到更为普遍的多质子酸体系。本次练习以磷酸盐系统为例，我们将推导描述各物种相对丰度如何随$pH$变化的物种分布函数（即“α分数”）。通过这项练习，您将深刻理解$pH$作为主控变量，在决定天然水体化学形态分布中的核心作用。",
            "id": "4069826",
            "problem": "一个温度为 $25^{\\circ}\\mathrm{C}$ 且离子强度可忽略不计的水溶液中，包含处于平衡状态的正磷酸物种：$\\mathrm{H_3PO_4}$、$\\mathrm{H_2PO_4^{-}}$、$\\mathrm{HPO_4^{2-}}$ 和 $\\mathrm{PO_4^{3-}}$。氢离子电位（pH）固定为 $7.20$，且体系表现为理想状态，因此所有活度系数均为 $1$。在 $25^{\\circ}\\mathrm{C}$ 时的逐级热力学解离常数为 $K_1 = 7.10 \\times 10^{-3}$、$K_2 = 6.30 \\times 10^{-8}$ 和 $K_3 = 4.20 \\times 10^{-13}$。总溶解无机磷为 $P_{\\mathrm{tot}} = 1.00 \\times 10^{-4}\\ \\mathrm{mol\\,L^{-1}}$。\n\n从 $\\mathrm{H_3PO_4}$ 的三个逐级解离反应的质量作用定律出发，并应用总磷的质量守恒定律，推导出以 $K_1$、$K_2$、$K_3$ 和氢离子浓度 $[\\mathrm{H^+}]$ 为函数的物种分布。利用这些结果和固定的 pH 值，计算 $\\mathrm{HPO_4^{2-}}$ 的摩尔浓度（单位为 $\\mathrm{mol\\,L^{-1}}$）。将您的答案四舍五入到四位有效数字，并以 $\\mathrm{mol\\,L^{-1}}$ 为单位表示。假设除了正磷酸盐体系外没有其他络合作用，并且忽略除了固定 pH 约束之外与水自电离的任何耦合。",
            "solution": "该问题要求计算在固定氢离子电位（pH）下，含有正磷酸及其共轭碱的水溶液中磷酸一氢根离子 $\\mathrm{HPO_4^{2-}}$ 的摩尔浓度。该问题是有效的，因为它具有科学依据、问题明确且客观。所有得出唯一解所需的数据和条件均已提供。\n\n我们首先陈述控制该体系的基本原理：正磷酸（$\\mathrm{H_3PO_4}$）逐级解离的质量作用定律以及总溶解磷（$P_{\\mathrm{tot}}$）的质量守恒定律。\n\n三个逐级解离反应如下：\n$$\n\\mathrm{H_3PO_4} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{H_2PO_4^{-}}\n$$\n$$\n\\mathrm{H_2PO_4^{-}} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HPO_4^{2-}}\n$$\n$$\n\\mathrm{HPO_4^{2-}} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{PO_4^{3-}}\n$$\n\n问题陈述该体系表现为理想状态，意味着所有活度系数都等于 $1$。因此，活度等于摩尔浓度。每一步的质量作用定律使用给定的热力学解离常数（$K_1$、$K_2$、$K_3$）表示如下：\n$$\nK_1 = \\frac{[\\mathrm{H^+}][\\mathrm{H_2PO_4^{-}}]}{[\\mathrm{H_3PO_4}]}\n$$\n$$\nK_2 = \\frac{[\\mathrm{H^+}][\\mathrm{HPO_4^{2-}}]}{[\\mathrm{H_2PO_4^{-}}]}\n$$\n$$\nK_3 = \\frac{[\\mathrm{H^+}][\\mathrm{PO_4^{3-}}]}{[\\mathrm{HPO_4^{2-}}]}\n$$\n\n总溶解磷 $P_{\\mathrm{tot}}$ 的质量守恒由所有含磷物种的浓度之和给出：\n$$\nP_{\\mathrm{tot}} = [\\mathrm{H_3PO_4}] + [\\mathrm{H_2PO_4^{-}}] + [\\mathrm{HPO_4^{2-}}] + [\\mathrm{PO_4^{3-}}]\n$$\n\n为了求解特定物种的浓度，我们必须首先推导出物种分布函数（也称为 alpha 分数，$\\alpha_i$）。这些函数将每种物种相对于总浓度的分数表示为氢离子浓度 $[\\mathrm{H^+}]$ 和解离常数的函数。我们将每种去质子化物种的浓度表示为完全质子化物种 $[\\mathrm{H_3PO_4}]$ 和 $[\\mathrm{H^+}]$ 的函数。\n\n根据质量作用表达式：\n$$\n[\\mathrm{H_2PO_4^{-}}] = \\frac{K_1}{[\\mathrm{H^+}]} [\\mathrm{H_3PO_4}]\n$$\n$$\n[\\mathrm{HPO_4^{2-}}] = \\frac{K_2}{[\\mathrm{H^+}]} [\\mathrm{H_2PO_4^{-}}] = \\frac{K_1 K_2}{[\\mathrm{H^+}]^2} [\\mathrm{H_3PO_4}]\n$$\n$$\n[\\mathrm{PO_4^{3-}}] = \\frac{K_3}{[\\mathrm{H^+}]} [\\mathrm{HPO_4^{2-}}] = \\frac{K_1 K_2 K_3}{[\\mathrm{H^+}]^3} [\\mathrm{H_3PO_4}]\n$$\n\n现在，将这些表达式代入 $P_{\\mathrm{tot}}$ 的质量平衡方程：\n$$\nP_{\\mathrm{tot}} = [\\mathrm{H_3PO_4}] + \\frac{K_1}{[\\mathrm{H^+}]} [\\mathrm{H_3PO_4}] + \\frac{K_1 K_2}{[\\mathrm{H^+}]^2} [\\mathrm{H_3PO_4}] + \\frac{K_1 K_2 K_3}{[\\mathrm{H^+}]^3} [\\mathrm{H_3PO_4}]\n$$\n提取公因式 $[\\mathrm{H_3PO_4}]$：\n$$\nP_{\\mathrm{tot}} = [\\mathrm{H_3PO_4}] \\left( 1 + \\frac{K_1}{[\\mathrm{H^+}]} + \\frac{K_1 K_2}{[\\mathrm{H^+}]^2} + \\frac{K_1 K_2 K_3}{[\\mathrm{H^+}]^3} \\right)\n$$\n为简化括号内的表达式，我们乘以 $\\frac{[\\mathrm{H^+}]^3}{[\\mathrm{H^+}]^3}$：\n$$\nP_{\\mathrm{tot}} = [\\mathrm{H_3PO_4}] \\left( \\frac{[\\mathrm{H^+}]^3 + K_1[\\mathrm{H^+}]^2 + K_1 K_2[\\mathrm{H^+}] + K_1 K_2 K_3}{[\\mathrm{H^+}]^3} \\right)\n$$\n令分母多项式为 $D([\\mathrm{H^+}]) = [\\mathrm{H^+}]^3 + K_1[\\mathrm{H^+}]^2 + K_1 K_2[\\mathrm{H^+}] + K_1 K_2 K_3$。\n\n物种 $i$ 的 alpha 分数 $\\alpha_i$ 定义为 $\\alpha_i = \\frac{[i]}{P_{\\mathrm{tot}}}$。我们关心的是 $\\alpha_{\\mathrm{HPO_4^{2-}}}$。\n$$\n\\alpha_{\\mathrm{HPO_4^{2-}}} = \\frac{[\\mathrm{HPO_4^{2-}}]}{P_{\\mathrm{tot}}} = \\frac{\\frac{K_1 K_2}{[\\mathrm{H^+}]^2} [\\mathrm{H_3PO_4}]}{[\\mathrm{H_3PO_4}] \\left( \\frac{D([\\mathrm{H^+}])}{[\\mathrm{H^+}]^3} \\right)}\n$$\n我们也可以将 $[\\mathrm{H_3PO_4}]$ 表示为 $P_{\\mathrm{tot}}$ 的函数，即 $[\\mathrm{H_3PO_4}] = P_{\\mathrm{tot}} \\frac{[\\mathrm{H^+}]^3}{D([\\mathrm{H^+}])}$。\n将此代入 $[\\mathrm{HPO_4^{2-}}]$ 的表达式中：\n$$\n[\\mathrm{HPO_4^{2-}}] = \\frac{K_1 K_2}{[\\mathrm{H^+}]^2} \\left( P_{\\mathrm{tot}} \\frac{[\\mathrm{H^+}]^3}{D([\\mathrm{H^+}])} \\right) = P_{\\mathrm{tot}} \\frac{K_1 K_2 [\\mathrm{H^+}]}{D([\\mathrm{H^+}}])}\n$$\n因此，我们记作 $\\alpha_2$ 的 $\\mathrm{HPO_4^{2-}}$ 的 alpha 分数为：\n$$\n\\alpha_2 = \\frac{[\\mathrm{HPO_4^{2-}}]}{P_{\\mathrm{tot}}} = \\frac{K_1 K_2 [\\mathrm{H^+}]}{[\\mathrm{H^+}]^3 + K_1[\\mathrm{H^+}]^2 + K_1 K_2[\\mathrm{H^+}] + K_1 K_2 K_3}\n$$\n这个关于物种分布的通用表达式是所要求推导的第一部分。\n\n接下来，我们使用提供的数据计算 $[\\mathrm{HPO_4^{2-}}]$ 的数值。\n已知数据：\n$\\mathrm{pH} = 7.20$\n$K_1 = 7.10 \\times 10^{-3}$\n$K_2 = 6.30 \\times 10^{-8}$\n$K_3 = 4.20 \\times 10^{-13}$\n$P_{\\mathrm{tot}} = 1.00 \\times 10^{-4}\\ \\mathrm{mol\\,L^{-1}}$\n\n首先，计算氢离子浓度 $[\\mathrm{H^+}]$：\n$$\n[\\mathrm{H^+}] = 10^{-\\mathrm{pH}} = 10^{-7.20}\\ \\mathrm{mol\\,L^{-1}}\n$$\n让我们记 $H = [\\mathrm{H^+}]$。我们计算分母多项式 $D(H)$ 的值：\n$D(H) = H^3 + K_1 H^2 + K_1 K_2 H + K_1 K_2 K_3$\n\n我们计算多项式中的每一项：\n第 1 项：$H^3 = (10^{-7.20})^3 = 10^{-21.60} \\approx 2.5119 \\times 10^{-22}$\n第 2 项：$K_1 H^2 = (7.10 \\times 10^{-3}) (10^{-7.20})^2 = (7.10 \\times 10^{-3}) (10^{-14.40}) \\approx 2.8266 \\times 10^{-17}$\n第 3 项：$K_1 K_2 H = (7.10 \\times 10^{-3}) (6.30 \\times 10^{-8}) (10^{-7.20}) = (4.473 \\times 10^{-10}) (10^{-7.20}) \\approx 2.8223 \\times 10^{-17}$\n第 4 项：$K_1 K_2 K_3 = (7.10 \\times 10^{-3}) (6.30 \\times 10^{-8}) (4.20 \\times 10^{-13}) \\approx 1.8787 \\times 10^{-22}$\n\n分母是这些项的总和：\n$D(H) \\approx (2.5119 \\times 10^{-22}) + (2.8266 \\times 10^{-17}) + (2.8223 \\times 10^{-17}) + (1.8787 \\times 10^{-22})$\n$D(H) \\approx 5.6489 \\times 10^{-17}$\n\nalpha 分数 $\\alpha_2$ 的分子是 $K_1 K_2 H$，即我们计算中的第 3 项：\n分子 = $2.8223 \\times 10^{-17}$\n\n现在，我们可以计算 $\\alpha_2$：\n$$\n\\alpha_2 = \\frac{2.8223 \\times 10^{-17}}{5.6489 \\times 10^{-17}} \\approx 0.49962\n$$\n\n最后，我们计算 $\\mathrm{HPO_4^{2-}}$ 的摩尔浓度：\n$$\n[\\mathrm{HPO_4^{2-}}] = \\alpha_2 \\times P_{\\mathrm{tot}}\n$$\n$$\n[\\mathrm{HPO_4^{2-}}] \\approx 0.49962 \\times (1.00 \\times 10^{-4}\\ \\mathrm{mol\\,L^{-1}})\n$$\n$$\n[\\mathrm{HPO_4^{2-}}] \\approx 4.9962 \\times 10^{-5}\\ \\mathrm{mol\\,L^{-1}}\n$$\n\n问题要求答案四舍五入到四位有效数字。\n$$\n[\\mathrm{HPO_4^{2-}}] = 4.996 \\times 10^{-5}\\ \\mathrm{mol\\,L^{-1}}\n$$",
            "answer": "$$\\boxed{4.996 \\times 10^{-5}}$$"
        },
        {
            "introduction": "本项压轴实践将带领您从手动代数求解过渡到计算地球化学的编程实践，目标是解决自然界最重要的缓冲体系——碳酸盐体系。给定总溶解无机碳（$DIC$）与总碱度（$Alk$）这两个关键参数，您需要设计并实现一个数值算法来求解体系的$pH$及所有碳酸盐物种的分布。这项任务完美诠释了计算地球化学的精髓：为复杂真实的地球化学系统建立模型并求解。",
            "id": "4069845",
            "problem": "考虑一个温度为 $25^\\circ\\mathrm{C}$ 的水溶液，其中包含一个二氧化碳体系，并假设其行为理想（活度系数等于$1$），且除了水的自电离外，离子间的相互作用可以忽略不计。该体系包含物种 $\\mathrm{CO_2(aq)}$、$\\mathrm{HCO_3^-}$、$\\mathrm{CO_3^{2-}}$、$\\mathrm{H^+}$ 和 $\\mathrm{OH^-}$。溶解无机碳（DIC）定义为含碳物种的浓度之和，而总碱度（Alk）在操作上定义为纯水中碳酸盐体系的质子受体与质子给体之差。在理想条件下，相关的基本关系是酸解离和水自电离的质量作用定律、碳的质量平衡，以及通过碳酸盐体系（不考虑硼酸盐、磷酸盐或其他碱的贡献）的碱度操作定义所表示的电中性。\n\n必须使用的基本定义如下：\n- 第一次解离的质量作用定律：$K_1 = \\dfrac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{[\\mathrm{CO_2(aq)}]}$。\n- 第二次解离的质量作用定律：$K_2 = \\dfrac{[\\mathrm{H^+}][\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$。\n- 水的自电离：$K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$。\n- 溶解无机碳质量平衡：$\\mathrm{DIC} = [\\mathrm{CO_2(aq)}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$。\n- 碳酸盐-水体系的碱度：$\\mathrm{Alk} = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]$。\n\n您必须计算溶液的pH值，定义为 $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$，以及碳物种 $\\mathrm{CO_2(aq)}$、$\\mathrm{HCO_3^-}$ 和 $\\mathrm{CO_3^{2-}}$ 相对于溶解无机碳的分数分布，定义为\n$f_{\\mathrm{CO_2}} = \\dfrac{[\\mathrm{CO_2(aq)}]}{\\mathrm{DIC}}$，$f_{\\mathrm{HCO_3}} = \\dfrac{[\\mathrm{HCO_3^-}]}{\\mathrm{DIC}}$，和 $f_{\\mathrm{CO_3}} = \\dfrac{[\\mathrm{CO_3^{2-}}]}{\\mathrm{DIC}}$，\n并遵循上述约束条件。\n\n使用在 $25^\\circ\\mathrm{C}$ 和零离子强度下经过充分检验的平衡常数：\n- $K_1 = 10^{-6.35}$，\n- $K_2 = 10^{-10.33}$，\n- $K_w = 10^{-14}$。\n\n所有浓度均以每千克水的质量摩尔浓度为基准，所有输入均以 $\\mathrm{mmol\\,kg^{-1}}$ 为单位；请在内部将其转换为 $\\mathrm{mol\\,kg^{-1}}$。报告 $\\mathrm{pH}$ 为无单位数值，报告 $f_{\\mathrm{CO_2}}$、$f_{\\mathrm{HCO_3}}$ 和 $f_{\\mathrm{CO_3}}$ 为小数。不允许使用百分比。\n\n编写一个完整的、可运行的程序，仅从上述基本定义出发，对以下每个以有序对 $(\\mathrm{DIC}, \\mathrm{Alk})$ 表示的测试用例，求解 $\\mathrm{pH}$ 以及分数分布 $f_{\\mathrm{CO_2}}$、$f_{\\mathrm{HCO_3}}$ 和 $f_{\\mathrm{CO_3}}$：\n- 测试用例 1：$(2.0, 2.2)\\ \\mathrm{mmol\\,kg^{-1}}$。\n- 测试用例 2：$(2.0, 1.0)\\ \\mathrm{mmol\\,kg^{-1}}$。\n- 测试用例 3：$(0.001, 0.001)\\ \\mathrm{mmol\\,kg^{-1}}$。\n- 测试用例 4：$(4.0, 4.5)\\ \\mathrm{mmol\\,kg^{-1}}$。\n- 测试用例 5：$(0.5, 0.1)\\ \\mathrm{mmol\\,kg^{-1}}$。\n\n设计考虑：\n- 算法必须求解由上述定义产生的非线性系统，不得使用任何未从这些基本原理推导出的简化公式。\n- 必须确保在所有测试用例中（包括低DIC条件和碱度远小于溶解无机碳的情况）的数值稳定性。\n- 此问题不涉及角度。\n- 物理单位仅出现在输入中，必须按规定处理。\n\n输出规范：\n- 对于每个测试用例，输出一个包含四个浮点数的列表 $[\\mathrm{pH}, f_{\\mathrm{CO_2}}, f_{\\mathrm{HCO_3}}, f_{\\mathrm{CO_3}}]$。\n- 将所有测试用例的结果汇总到一个列表中。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，每个测试用例的结果本身也用方括号括起来，例如：$[\\,[x_1,x_2,x_3,x_4],\\,[y_1,y_2,y_3,y_4]\\,]$。\n- 在最终输出中将每个浮点数四舍五入到六位小数。",
            "solution": "所述问题在科学上和数学上是有效的。这是一个计算水地球化学领域中定义明确的问题，它提供了一套完整的化学基本关系和必要的常数，以便在给定两个主变量：溶解无机碳（$\\mathrm{DIC}$）和总碱度（$\\mathrm{Alk}$）的情况下，确定碳酸盐体系的物种形成。所有约束条件都是一致的，且提供的数据在物理上是现实的。\n\n解决方案需要求解一个包含五个未知浓度：$[\\mathrm{CO_2(aq)}]$、$[\\mathrm{HCO_3^-}]$、$[\\mathrm{CO_3^{2-}}]$、$[\\mathrm{H^+}]$ 和 $[\\mathrm{OH^-}]$ 的五元非线性方程组。控制方程如下：\n$1$. $K_1 = \\dfrac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{[\\mathrm{CO_2(aq)}]}$\n$2$. $K_2 = \\dfrac{[\\mathrm{H^+}][\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$\n$3$. $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$\n$4$. $\\mathrm{DIC} = [\\mathrm{CO_2(aq)}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$\n$5$. $\\mathrm{Alk} = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]$\n\n解决该系统的策略是选择一个单一的主变量，在此案例中为质子浓度 $[\\mathrm{H^+}]$，并用它以及给定的量 $\\mathrm{DIC}$ 和 $\\mathrm{Alk}$ 来表示所有其他未知浓度。我们记 $h = [\\mathrm{H^+}]$。\n\n首先，将含碳物种的浓度表示为 $h$ 和 $\\mathrm{DIC}$ 的函数。根据碳酸盐解离的质量作用定律（方程 $1$ 和 $2$），我们可以写出：\n$$[\\mathrm{HCO_3^-}] = \\frac{K_1}{h} [\\mathrm{CO_2(aq)}]$$\n$$[\\mathrm{CO_3^{2-}}] = \\frac{K_2}{h} [\\mathrm{HCO_3^-}] = \\frac{K_1 K_2}{h^2} [\\mathrm{CO_2(aq)}]$$\n将这些代入 $\\mathrm{DIC}$ 的质量平衡方程（方程 $4$）：\n$$\\mathrm{DIC} = [\\mathrm{CO_2(aq)}] + \\frac{K_1}{h} [\\mathrm{CO_2(aq)}] + \\frac{K_1 K_2}{h^2} [\\mathrm{CO_2(aq)}]$$\n将 $[\\mathrm{CO_2(aq)}]$ 因子提出：\n$$\\mathrm{DIC} = [\\mathrm{CO_2(aq)}] \\left( 1 + \\frac{K_1}{h} + \\frac{K_1 K_2}{h^2} \\right)$$\n令分母项为 $\\alpha_D = h^2 + K_1 h + K_1 K_2$。我们现在可以将每种碳物种的浓度表示为 $\\mathrm{DIC}$ 和 $h$ 的函数：\n$$[\\mathrm{CO_2(aq)}] = \\mathrm{DIC} \\left( \\frac{h^2}{h^2 + K_1 h + K_1 K_2} \\right) = \\mathrm{DIC} \\left( \\frac{h^2}{\\alpha_D} \\right)$$\n$$[\\mathrm{HCO_3^-}] = \\mathrm{DIC} \\left( \\frac{K_1 h}{h^2 + K_1 h + K_1 K_2} \\right) = \\mathrm{DIC} \\left( \\frac{K_1 h}{\\alpha_D} \\right)$$\n$$[\\mathrm{CO_3^{2-}}] = \\mathrm{DIC} \\left( \\frac{K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) = \\mathrm{DIC} \\left( \\frac{K_1 K_2}{\\alpha_D} \\right)$$\n分数分布 $f_{\\mathrm{CO_2}}$、$f_{\\mathrm{HCO_3}}$ 和 $f_{\\mathrm{CO_3}}$ 是括号中的项，它们仅依赖于 $h$：\n$$f_{\\mathrm{CO_2}} = \\frac{h^2}{\\alpha_D}, \\quad f_{\\mathrm{HCO_3}} = \\frac{K_1 h}{\\alpha_D}, \\quad f_{\\mathrm{CO_3}} = \\frac{K_1 K_2}{\\alpha_D}$$\n\n在定义了碳物种之后，我们使用最终的碱度控制方程（方程 $5$）。氢氧根的浓度 $[\\mathrm{OH^-}]$ 由水的自电离常数（方程 $3$）得出：$[\\mathrm{OH^-}] = K_w / h$。将所有表达式代入碱度方程：\n$$\\mathrm{Alk} = \\left( \\mathrm{DIC} \\frac{K_1 h}{\\alpha_D} \\right) + 2 \\left( \\mathrm{DIC} \\frac{K_1 K_2}{\\alpha_D} \\right) + \\frac{K_w}{h} - h$$\n该方程只包含一个未知数 $h$。为了求解 $h$，我们定义一个残差函数 $F(h)$，它在解处必须等于零：\n$$F(h) = \\mathrm{DIC} \\left( \\frac{K_1 h + 2 K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) + \\frac{K_w}{h} - h - \\mathrm{Alk} = 0$$\n\n这是一个非线性方程，无法解析求解。需要一个数值求根算法。函数 $F(h)$ 具有一些适于求根的良好性质：当 $h \\to 0^+$ 时，项 $K_w/h \\to +\\infty$，因此 $F(h) \\to +\\infty$。当 $h \\to +\\infty$ 时，项 $-h \\to -\\infty$ 并占主导地位，因此 $F(h) \\to -\\infty$。由于 $F(h)$ 在 $h  0$ 时是连续的，这些异号极限保证了在 $h  0$ 的范围内至少存在一个根。这使得我们可以使用像 Brent 算法这样鲁棒的区间法。\n\n计算过程如下：\n$1$. 对于每个以 $\\mathrm{mmol\\,kg^{-1}}$ 为单位给出的输入对 $(\\mathrm{DIC}, \\mathrm{Alk})$，通过除以 $1000$ 将其值转换为基本单位 $\\mathrm{mol\\,kg^{-1}}$。\n$2$. 使用转换后的 $\\mathrm{DIC}$ 和 $\\mathrm{Alk}$ 以及提供的常数 $K_1 = 10^{-6.35}$、$K_2 = 10^{-10.33}$ 和 $K_w = 10^{-14}$ 定义残差函数 $F(h)$。\n$3$. 使用一个数值求解器，具体来说是 `scipy.optimize.brentq`，在一个宽阔且安全的区间如 $[10^{-14}, 1.0]$（对应 $\\mathrm{pH}$ 范围 $14$ 到 $0$）内找到 $F(h)$ 的根 $h$。\n$4$. 一旦找到唯一的正根 $h$，系统即告解出。计算所需的输出：\n   - $\\mathrm{pH} = -\\log_{10}(h)$\n   - $f_{\\mathrm{CO_2}} = h^2 / (h^2 + K_1 h + K_1 K_2)$\n   - $f_{\\mathrm{HCO_3}} = K_1 h / (h^2 + K_1 h + K_1 K_2)$\n   - $f_{\\mathrm{CO_3}} = K_1 K_2 / (h^2 + K_1 h + K_1 K_2)$\n$5$. 收集每个测试用例的结果—$[\\mathrm{pH}, f_{\\mathrm{CO_2}}, f_{\\mathrm{HCO_3}}, f_{\\mathrm{CO_3}}]$—每个值四舍五入到六位小数，并格式化为指定的输出结构。\n该过程遵循了从基本原理求解的要求，并提供了一个数值稳定且准确的解。",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for pH and carbonate species fractions in an aqueous solution.\n    \n    The function takes pairs of (DIC, Alk), solves the carbonate system\n    using fundamental equations, and computes pH and the fractional distribution\n    of CO2(aq), HCO3-, and CO3^2-.\n    \"\"\"\n    \n    # Define equilibrium constants for 25°C and zero ionic strength\n    K1 = 10**(-6.35)\n    K2 = 10**(-10.33)\n    Kw = 10**(-14.00)\n\n    # Define test cases as (DIC, Alk) in mmol/kg\n    test_cases_mmol = [\n        (2.0, 2.2),\n        (2.0, 1.0),\n        (0.001, 0.001),\n        (4.0, 4.5),\n        (0.5, 0.1)\n    ]\n\n    # Convert inputs from mmol/kg to mol/kg\n    test_cases_mol = [(dic / 1000.0, alk / 1000.0) for dic, alk in test_cases_mmol]\n\n    all_results = []\n\n    for dic, alk in test_cases_mol:\n        \n        def residual_function(h):\n            \"\"\"\n            The master equation F(h) = 0 to be solved for h = [H+].\n            \n            This function represents the alkalinity balance where all species\n            concentrations are expressed in terms of h and DIC.\n            \"\"\"\n            # h must be positive\n            if h == 0:\n                return np.inf\n            \n            # Common denominator for carbonate speciation fractions\n            denominator = h**2 + K1 * h + K1 * K2\n            \n            # Carbonate alkalinity: [HCO3-] + 2*[CO3^2-]\n            carbonate_alk_term = dic * (K1 * h + 2 * K1 * K2) / denominator\n            \n            # Water contribution to alkalinity: [OH-] - [H+]\n            water_alk_term = Kw / h - h\n            \n            # The full residual function, which should be zero at the correct h\n            return carbonate_alk_term + water_alk_term - alk\n\n        # Use Brent's method to find the root h = [H+].\n        # The bracket [1e-14, 1.0] corresponds to pH range [14, 0]\n        # and is guaranteed to contain the root because the function\n        # goes from +inf to -inf over this interval.\n        try:\n            h_conc = optimize.brentq(residual_function, 1e-14, 1.0, xtol=1e-16)\n        except ValueError:\n            # This should not occur given the function's properties,\n            # but is included for robustness.\n            all_results.append([float('nan')] * 4)\n            continue\n            \n        # Once h is found, calculate pH\n        ph = -np.log10(h_conc)\n\n        # Calculate the fractional distribution of carbon species\n        denominator = h_conc**2 + K1 * h_conc + K1 * K2\n        f_co2 = (h_conc**2) / denominator\n        f_hco3 = (K1 * h_conc) / denominator\n        f_co3 = (K1 * K2) / denominator\n\n        # Store the calculated values for this test case\n        case_result = [ph, f_co2, f_hco3, f_co3]\n        all_results.append(case_result)\n        \n    # Format the final output according to the problem specification.\n    # Each float is rounded to 6 decimal places.\n    # The result is a list of lists, formatted as a string.\n    formatted_cases = []\n    for case_res in all_results:\n        # Format each number in the sublist to 6 decimal places\n        formatted_numbers = [f\"{num:.6f}\" for num in case_res]\n        # Join numbers with commas and enclose in brackets \"[]\"\n        case_str = f\"[{','.join(formatted_numbers)}]\"\n        formatted_cases.append(case_str)\n    \n    # Join all case strings with a comma and enclose in outer brackets \"[]\"\n    final_output_str = f\"[{','.join(formatted_cases)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}