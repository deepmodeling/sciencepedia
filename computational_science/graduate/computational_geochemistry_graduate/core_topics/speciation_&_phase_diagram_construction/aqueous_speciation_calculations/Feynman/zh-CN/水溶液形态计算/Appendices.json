{
    "hands_on_practices": [
        {
            "introduction": "理解相关化学物质的浓度如何随环境条件变化，是水地球化学的基石。第一个实践提供了一个基础练习，用于计算在固定$pH$值下多质子酸体系的物质分布。通过研究磷酸的解离过程，你将应用质量作用定律和质量平衡原理来推导著名的“$\\alpha$分数”，这对于预测溶液中物质的主要存在形式至关重要。",
            "id": "4069826",
            "problem": "在温度为 $25^{\\circ}\\mathrm{C}$、离子强度可忽略不计的水溶液中，含有处于平衡状态的正磷酸物种：$\\mathrm{H_3PO_4}$、$\\mathrm{H_2PO_4^{-}}$、$\\mathrm{HPO_4^{2-}}$ 和 $\\mathrm{PO_4^{3-}}$。氢离子浓度指数 (pH) 固定在 $7.20$，且该体系为理想体系，因此所有活度系数均为 $1$。在 $25^{\\circ}\\mathrm{C}$ 时的逐级热力学解离常数为 $K_1 = 7.10 \\times 10^{-3}$、$K_2 = 6.30 \\times 10^{-8}$ 和 $K_3 = 4.20 \\times 10^{-13}$。总溶解无机磷为 $P_{\\mathrm{tot}} = 1.00 \\times 10^{-4}\\ \\mathrm{mol\\,L^{-1}}$。\n\n从 $\\mathrm{H_3PO_4}$ 的三步逐级解离反应的质量作用定律出发，并应用总磷的质量守恒，推导各物种的分布，表示为 $K_1$、$K_2$、$K_3$ 和氢离子浓度 $[\\mathrm{H^+}]$ 的函数。利用这些结果和固定的 pH 值，计算 $\\mathrm{HPO_4^{2-}}$ 的摩尔浓度，单位为 $\\mathrm{mol\\,L^{-1}}$。将你的答案四舍五入到四位有效数字，并以 $\\mathrm{mol\\,L^{-1}}$ 为单位表示。假设除了正磷酸盐体系外没有其他络合作用，并且除了固定的 pH 约束外，忽略与水的自电离的任何耦合作用。",
            "solution": "该问题要求在一个含有正磷酸及其共轭碱、且氢离子浓度指数 (pH) 固定的水溶液中，计算磷酸一氢根离子 $\\mathrm{HPO_4^{2-}}$ 的摩尔浓度。该问题具有科学依据、提法明确且客观，是有效的。唯一解所需的所有必要数据和条件均已提供。\n\n我们首先陈述控制该体系的基本原理：正磷酸 ($\\mathrm{H_3PO_4}$) 逐级解离的质量作用定律和总溶解磷 ($P_{\\mathrm{tot}}$) 的质量守恒定律。\n\n三个逐级解离反应如下：\n$$\n\\mathrm{H_3PO_4} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{H_2PO_4^{-}}\n$$\n$$\n\\mathrm{H_2PO_4^{-}} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HPO_4^{2-}}\n$$\n$$\n\\mathrm{HPO_4^{2-}} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{PO_4^{3-}}\n$$\n\n问题陈述该体系为理想体系，意味着所有活度系数都等于 $1$。因此，活度等于摩尔浓度。每一步的质量作用定律用给定的热力学解离常数 ($K_1$、$K_2$、$K_3$) 表示如下：\n$$\nK_1 = \\frac{[\\mathrm{H^+}][\\mathrm{H_2PO_4^{-}}]}{[\\mathrm{H_3PO_4}]}\n$$\n$$\nK_2 = \\frac{[\\mathrm{H^+}][\\mathrm{HPO_4^{2-}}]}{[\\mathrm{H_2PO_4^{-}}]}\n$$\n$$\nK_3 = \\frac{[\\mathrm{H^+}][\\mathrm{PO_4^{3-}}]}{[\\mathrm{HPO_4^{2-}}]}\n$$\n\n总溶解磷 $P_{\\mathrm{tot}}$ 的质量守恒由所有含磷物种的浓度之和给出：\n$$\nP_{\\mathrm{tot}} = [\\mathrm{H_3PO_4}] + [\\mathrm{H_2PO_4^{-}}] + [\\mathrm{HPO_4^{2-}}] + [\\mathrm{PO_4^{3-}}]\n$$\n\n为了求解特定物种的浓度，我们必须首先推导物种分布函数（也称为 alpha 分数，$\\alpha_i$）。这些函数将各物种占总浓度的分数表示为氢离子浓度 $[\\mathrm{H^+}]$ 和解离常数的函数。我们将每种去质子化物种的浓度用完全质子化物种 $[\\mathrm{H_3PO_4}]$ 和 $[\\mathrm{H^+}]$ 来表示。\n\n根据质量作用表达式：\n$$\n[\\mathrm{H_2PO_4^{-}}] = \\frac{K_1}{[\\mathrm{H^+}]} [\\mathrm{H_3PO_4}]\n$$\n$$\n[\\mathrm{HPO_4^{2-}}] = \\frac{K_2}{[\\mathrm{H^+}]} [\\mathrm{H_2PO_4^{-}}] = \\frac{K_1 K_2}{[\\mathrm{H^+}]^2} [\\mathrm{H_3PO_4}]\n$$\n$$\n[\\mathrm{PO_4^{3-}}] = \\frac{K_3}{[\\mathrm{H^+}]} [\\mathrm{HPO_4^{2-}}] = \\frac{K_1 K_2 K_3}{[\\mathrm{H^+}]^3} [\\mathrm{H_3PO_4}]\n$$\n\n现在，将这些表达式代入 $P_{\\mathrm{tot}}$ 的质量平衡方程：\n$$\nP_{\\mathrm{tot}} = [\\mathrm{H_3PO_4}] + \\frac{K_1}{[\\mathrm{H^+}]} [\\mathrm{H_3PO_4}] + \\frac{K_1 K_2}{[\\mathrm{H^+}]^2} [\\mathrm{H_3PO_4}] + \\frac{K_1 K_2 K_3}{[\\mathrm{H^+}]^3} [\\mathrm{H_3PO_4}]\n$$\n提出 $[\\mathrm{H_3PO_4}]$：\n$$\nP_{\\mathrm{tot}} = [\\mathrm{H_3PO_4}] \\left( 1 + \\frac{K_1}{[\\mathrm{H^+}]} + \\frac{K_1 K_2}{[\\mathrm{H^+}]^2} + \\frac{K_1 K_2 K_3}{[\\mathrm{H^+}]^3} \\right)\n$$\n为了简化括号中的表达式，我们乘以 $\\frac{[\\mathrm{H^+}]^3}{[\\mathrm{H^+}]^3}$：\n$$\nP_{\\mathrm{tot}} = [\\mathrm{H_3PO_4}] \\left( \\frac{[\\mathrm{H^+}]^3 + K_1[\\mathrm{H^+}]^2 + K_1 K_2[\\mathrm{H^+}] + K_1 K_2 K_3}{[\\mathrm{H^+}]^3} \\right)\n$$\n设分母多项式为 $D([\\mathrm{H^+}]) = [\\mathrm{H^+}]^3 + K_1[\\mathrm{H^+}]^2 + K_1 K_2[\\mathrm{H^+}] + K_1 K_2 K_3$。\n\n物种 $i$ 的 alpha 分数 $\\alpha_i$ 定义为 $\\alpha_i = \\frac{[i]}{P_{\\mathrm{tot}}}$。我们关心的是 $\\alpha_{\\mathrm{HPO_4^{2-}}}$。\n$$\n\\alpha_{\\mathrm{HPO_4^{2-}}} = \\frac{[\\mathrm{HPO_4^{2-}}]}{P_{\\mathrm{tot}}} = \\frac{\\frac{K_1 K_2}{[\\mathrm{H^+}]^2} [\\mathrm{H_3PO_4}]}{[\\mathrm{H_3PO_4}] \\left( \\frac{D([\\mathrm{H^+}])}{[\\mathrm{H^+}]^3} \\right)}\n$$\n我们也可以将 $[\\mathrm{H_3PO_4}]$ 用 $P_{\\mathrm{tot}}$ 表示为 $[\\mathrm{H_3PO_4}] = P_{\\mathrm{tot}} \\frac{[\\mathrm{H^+}]^3}{D([\\mathrm{H^+}])}$。\n将此代入 $[\\mathrm{HPO_4^{2-}}]$ 的表达式中：\n$$\n[\\mathrm{HPO_4^{2-}}] = \\frac{K_1 K_2}{[\\mathrm{H^+}]^2} \\left( P_{\\mathrm{tot}} \\frac{[\\mathrm{H^+}]^3}{D([\\mathrm{H^+}])} \\right) = P_{\\mathrm{tot}} \\frac{K_1 K_2 [\\mathrm{H^+}]}{D([\\mathrm{H^+}}])}\n$$\n因此，$\\mathrm{HPO_4^{2-}}$ 的 alpha 分数，我们记为 $\\alpha_2$，是：\n$$\n\\alpha_2 = \\frac{[\\mathrm{HPO_4^{2-}}]}{P_{\\mathrm{tot}}} = \\frac{K_1 K_2 [\\mathrm{H^+}]}{[\\mathrm{H^+}]^3 + K_1[\\mathrm{H^+}]^2 + K_1 K_2[\\mathrm{H^+}] + K_1 K_2 K_3}\n$$\n这个物种分布的通用表达式是所需推导的第一部分。\n\n接下来，我们使用所提供的数据计算 $[\\mathrm{HPO_4^{2-}}]$ 的数值。\n给定数据：\n$\\mathrm{pH} = 7.20$\n$K_1 = 7.10 \\times 10^{-3}$\n$K_2 = 6.30 \\times 10^{-8}$\n$K_3 = 4.20 \\times 10^{-13}$\n$P_{\\mathrm{tot}} = 1.00 \\times 10^{-4}\\ \\mathrm{mol\\,L^{-1}}$\n\n首先，计算氢离子浓度 $[\\mathrm{H^+}]$：\n$$\n[\\mathrm{H^+}] = 10^{-\\mathrm{pH}} = 10^{-7.20}\\ \\mathrm{mol\\,L^{-1}}\n$$\n让我们记 $H = [\\mathrm{H^+}]$。我们计算分母多项式 $D(H)$ 的值：\n$D(H) = H^3 + K_1 H^2 + K_1 K_2 H + K_1 K_2 K_3$\n\n我们计算多项式中的每一项：\n第1项：$H^3 = (10^{-7.20})^3 = 10^{-21.60} \\approx 2.5119 \\times 10^{-22}$\n第2项：$K_1 H^2 = (7.10 \\times 10^{-3}) (10^{-7.20})^2 = (7.10 \\times 10^{-3}) (10^{-14.40}) \\approx 2.8266 \\times 10^{-17}$\n第3项：$K_1 K_2 H = (7.10 \\times 10^{-3}) (6.30 \\times 10^{-8}) (10^{-7.20}) = (4.473 \\times 10^{-10}) (10^{-7.20}) \\approx 2.8223 \\times 10^{-17}$\n第4项：$K_1 K_2 K_3 = (7.10 \\times 10^{-3}) (6.30 \\times 10^{-8}) (4.20 \\times 10^{-13}) \\approx 1.8787 \\times 10^{-22}$\n\n分母是这些项的和：\n$D(H) \\approx (2.5119 \\times 10^{-22}) + (2.8266 \\times 10^{-17}) + (2.8223 \\times 10^{-17}) + (1.8787 \\times 10^{-22})$\n$D(H) \\approx 5.6489 \\times 10^{-17}$\n\nalpha 分数 $\\alpha_2$ 的分子是 $K_1 K_2 H$，即我们计算中的第3项：\n分子 = $2.8223 \\times 10^{-17}$\n\n现在，我们可以计算 $\\alpha_2$：\n$$\n\\alpha_2 = \\frac{2.8223 \\times 10^{-17}}{5.6489 \\times 10^{-17}} \\approx 0.49962\n$$\n\n最后，我们计算 $\\mathrm{HPO_4^{2-}}$ 的摩尔浓度：\n$$\n[\\mathrm{HPO_4^{2-}}] = \\alpha_2 \\times P_{\\mathrm{tot}}\n$$\n$$\n[\\mathrm{HPO_4^{2-}}] \\approx 0.49962 \\times (1.00 \\times 10^{-4}\\ \\mathrm{mol\\,L^{-1}})\n$$\n$$\n[\\mathrm{HPO_4^{2-}}] \\approx 4.9962 \\times 10^{-5}\\ \\mathrm{mol\\,L^{-1}}\n$$\n\n问题要求答案四舍五入到四位有效数字。\n$$\n[\\mathrm{HPO_4^{2-}}] = 4.996 \\times 10^{-5}\\ \\mathrm{mol\\,L^{-1}}\n$$",
            "answer": "$$\\boxed{4.996 \\times 10^{-5}}$$"
        },
        {
            "introduction": "我们最初的模型常常假设理想行为，但由于离子间的静电相互作用，真实世界的溶液很少如此简单。这个实践通过引入离子强度的概念及其对化学平衡的影响，将我们从理想理论推向实际应用。你将使用扩展的德拜-休克尔方程计算单离子活度系数，从而从热力学平衡常数（$K^{\\circ}$）计算出条件平衡常数（$K'$），并量化在非理想溶液中溶解度如何变化。",
            "id": "4069855",
            "problem": "水地球化学平衡以活度表示，活度通过电解质理论推导出的活度系数，将可测量的浓度与热力学量联系起来。考虑固态碳酸钙 $\\mathrm{CaCO_3(s)} \\rightleftharpoons \\mathrm{Ca^{2+}(aq)} + \\mathrm{CO_3^{2-}(aq)}$ 在 $25^{\\circ}\\mathrm{C}$ 的水中溶解的反应。从化学势和活度定义的平衡常数出发，推导无限稀释条件下的热力学平衡常数 $K^{\\circ}$ 与在离子强度为 $I$ 的溶液中（活度系数不等于1）以质量摩尔浓度标度定义的条件平衡常数 $K'$ 之间的关系。然后，使用扩展德拜-休克尔活度系数模型计算离子强度 $I = 0.1$ 时 $K'$ 的数值，并将其与 $K^{\\circ}$ 进行定性比较。\n\n假设：\n- 无限稀释下的热力学平衡常数为 $K^{\\circ} = 3.31 \\times 10^{-9}$（无量纲，质量摩尔浓度标准态，其中 $m^{\\circ} = 1\\,\\mathrm{mol\\,kg^{-1}}$）。\n- 单离子活度系数的扩展德拜-休克尔方程为 $-\\log_{10}\\gamma_i = \\dfrac{A z_i^{2} \\sqrt{I}}{1 + B a_i \\sqrt{I}}$，其中 $A$ 和 $B$ 是与温度相关的常数，$a_i$ 是离子尺寸参数。\n- 在 $25^{\\circ}\\mathrm{C}$ 的水中，取 $A = 0.5085$ 和 $B = 0.3281\\,\\text{\\AA}^{-1}$。\n- 使用 $z_{\\mathrm{Ca}^{2+}} = +2$，$z_{\\mathrm{CO_3}^{2-}} = -2$，$a_{\\mathrm{Ca}^{2+}} = 6.0\\,\\text{\\AA}$，以及 $a_{\\mathrm{CO_3}^{2-}} = 4.5\\,\\text{\\AA}$。\n- 固相活度为1，$a_{\\mathrm{CaCO_3(s)}} = 1$。\n\n从基本原理出发计算 $I = 0.1$ 时的 $K'$，并将最终的条件平衡常数表示为一个无量纲数。答案保留三位有效数字。",
            "solution": "## 问题验证\n\n### 步骤1：提取已知条件\n-   **反应：** $\\mathrm{CaCO_3(s)} \\rightleftharpoons \\mathrm{Ca^{2+}(aq)} + \\mathrm{CO_3^{2-}(aq)}$\n-   **温度：** $25^{\\circ}\\mathrm{C}$\n-   **热力学平衡常数：** $K^{\\circ} = 3.31 \\times 10^{-9}$ (无量纲，质量摩尔浓度标准态)\n-   **标准质量摩尔浓度：** $m^{\\circ} = 1\\,\\mathrm{mol\\,kg^{-1}}$\n-   **条件平衡常数定义：** $K'$ 在质量摩尔浓度标度上定义。\n-   **离子强度：** $I = 0.1$\n-   **扩展德拜-休克尔方程：** $-\\log_{10}\\gamma_i = \\dfrac{A z_i^{2} \\sqrt{I}}{1 + B a_i \\sqrt{I}}$\n-   **常数 A：** $A = 0.5085$\n-   **常数 B：** $B = 0.3281\\,\\text{\\AA}^{-1}$\n-   **$\\mathrm{Ca}^{2+}$ 的离子参数：** $z_{\\mathrm{Ca}^{2+}} = +2$，$a_{\\mathrm{Ca}^{2+}} = 6.0\\,\\text{\\AA}$\n-   **$\\mathrm{CO_3}^{2-}$ 的离子参数：** $z_{\\mathrm{CO_3}^{2-}} = -2$，$a_{\\mathrm{CO_3}^{2-}} = 4.5\\,\\text{\\AA}$\n-   **固相活度：** $a_{\\mathrm{CaCO_3(s)}} = 1$\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题牢固地植根于化学热力学和水地球化学原理。它使用了平衡常数、活度和活度系数的标准定义。德拜-休克尔理论及其扩展形式是电解质溶液的核心模型。所提供的反应和常数对于所研究的体系是标准且符合实际的。该问题在科学上是合理的。\n2.  **问题明确：** 该问题提供了推导所需关系式和计算数值所需的所有数据和方程。目标陈述清晰，可以得到一个唯一且有意义的解。该问题是明确的。\n3.  **客观性：** 该问题使用精确、无偏见的科学语言陈述。没有主观因素或观点。该问题是客观的。\n\n### 步骤3：结论与行动\n问题有效。将进行求解过程。\n\n---\n\n## 解答\n\n该问题要求推导热力学平衡常数 $K^{\\circ}$ 与条件平衡常数 $K'$ 之间的关系，然后计算在指定离子强度下 $K'$ 的数值。\n\n**第一部分：推导 $K^{\\circ}$ 和 $K'$ 之间的关系**\n\n碳酸钙的溶解反应由下式给出：\n$$\n\\mathrm{CaCO_3(s)} \\rightleftharpoons \\mathrm{Ca^{2+}(aq)} + \\mathrm{CO_3^{2-}(aq)}\n$$\n热力学平衡常数 $K^{\\circ}$ 是根据平衡时产物和反应物的活度 $a_i$ 定义的。\n$$\nK^{\\circ} = \\frac{a_{\\mathrm{Ca}^{2+}} a_{\\mathrm{CO_3}^{2-}}}{a_{\\mathrm{CaCO_3(s)}}}\n$$\n根据惯例，纯固相的活度等于1。问题明确指出：$a_{\\mathrm{CaCO_3(s)}} = 1$。因此，$K^{\\circ}$ 的表达式简化为：\n$$\nK^{\\circ} = a_{\\mathrm{Ca}^{2+}} a_{\\mathrm{CO_3}^{2-}}\n$$\n水合离子的活度 $a_i$ 与其质量摩尔浓度 $m_i$（单位为 $\\mathrm{mol\\,kg^{-1}}$）及其无量纲的质量摩尔活度系数 $\\gamma_i$ 通过以下定义相关联：\n$$\na_i = \\gamma_i \\frac{m_i}{m^{\\circ}}\n$$\n其中 $m^{\\circ}$ 是标准态质量摩尔浓度（$1\\,\\mathrm{mol\\,kg^{-1}}$）。为了简化平衡计算的符号表示，质量摩尔浓度通常被视为无量纲量，实际上是设 $m^{\\circ}=1$。使用此惯例，关系式为 $a_i = \\gamma_i m_i$。\n\n将此定义代入 $K^{\\circ}$ 的表达式中：\n$$\nK^{\\circ} = (\\gamma_{\\mathrm{Ca}^{2+}} m_{\\mathrm{Ca}^{2+}}) (\\gamma_{\\mathrm{CO_3}^{2-}} m_{\\mathrm{CO_3}^{2-}})\n$$\n这可以重新整理，将活度系数与质量摩尔浓度分开：\n$$\nK^{\\circ} = (\\gamma_{\\mathrm{Ca}^{2+}} \\gamma_{\\mathrm{CO_3}^{2-}}) (m_{\\mathrm{Ca}^{2+}} m_{\\mathrm{CO_3}^{2-}})\n$$\n条件平衡常数 $K'$ 是根据物种的平衡质量摩尔浓度定义的：\n$$\nK' = m_{\\mathrm{Ca}^{2+}} m_{\\mathrm{CO_3}^{2-}}\n$$\n将 $K'$ 的表达式代入 $K^{\\circ}$ 的方程中，得到：\n$$\nK^{\\circ} = (\\gamma_{\\mathrm{Ca}^{2+}} \\gamma_{\\mathrm{CO_3}^{2-}}) K'\n$$\n解出 $K'$ 得到所需的关系式：\n$$\nK' = \\frac{K^{\\circ}}{\\gamma_{\\mathrm{Ca}^{2+}} \\gamma_{\\mathrm{CO_3}^{2-}}}\n$$\n\n**第二部分：$K'$ 的数值计算**\n\n要计算 $K'$，我们必须首先使用扩展德拜-休克尔方程，在离子强度 $I = 0.1$ 时确定单离子活度系数 $\\gamma_{\\mathrm{Ca}^{2+}}$ 和 $\\gamma_{\\mathrm{CO_3}^{2-}}$：\n$$\n-\\log_{10}\\gamma_i = \\frac{A z_i^{2} \\sqrt{I}}{1 + B a_i \\sqrt{I}}\n$$\n给定的参数是 $A = 0.5085$，$B = 0.3281\\,\\text{\\AA}^{-1}$，以及 $I = 0.1$。离子强度的平方根是 $\\sqrt{I} = \\sqrt{0.1}$。\n\n首先，我们计算钙离子的活度系数 $\\gamma_{\\mathrm{Ca}^{2+}}$。离子特有参数为 $z_{\\mathrm{Ca}^{2+}} = +2$ 和 $a_{\\mathrm{Ca}^{2+}} = 6.0\\,\\text{\\AA}$。\n$$\n-\\log_{10}\\gamma_{\\mathrm{Ca}^{2+}} = \\frac{(0.5085) (+2)^{2} \\sqrt{0.1}}{1 + (0.3281) (6.0) \\sqrt{0.1}}\n$$\n$$\n-\\log_{10}\\gamma_{\\mathrm{Ca}^{2+}} = \\frac{(0.5085) (4) \\sqrt{0.1}}{1 + 1.9686 \\sqrt{0.1}} \\approx \\frac{2.034(0.316228)}{1 + 1.9686(0.316228)} \\approx \\frac{0.64309}{1 + 0.62244} \\approx \\frac{0.64309}{1.62244} \\approx 0.39638\n$$\n因此，$\\log_{10}\\gamma_{\\mathrm{Ca}^{2+}} \\approx -0.39638$，这给出：\n$$\n\\gamma_{\\mathrm{Ca}^{2+}} = 10^{-0.39638} \\approx 0.40144\n$$\n\n接下来，我们计算碳酸根离子的活度系数 $\\gamma_{\\mathrm{CO_3}^{2-}}$。离子特有参数为 $z_{\\mathrm{CO_3}^{2-}} = -2$ 和 $a_{\\mathrm{CO_3}^{2-}} = 4.5\\,\\text{\\AA}$。\n$$\n-\\log_{10}\\gamma_{\\mathrm{CO_3}^{2-}} = \\frac{(0.5085) (-2)^{2} \\sqrt{0.1}}{1 + (0.3281) (4.5) \\sqrt{0.1}}\n$$\n$$\n-\\log_{10}\\gamma_{\\mathrm{CO_3}^{2-}} = \\frac{(0.5085) (4) \\sqrt{0.1}}{1 + 1.47645 \\sqrt{0.1}} \\approx \\frac{2.034(0.316228)}{1 + 1.47645(0.316228)} \\approx \\frac{0.64309}{1 + 0.46683} \\approx \\frac{0.64309}{1.46683} \\approx 0.43843\n$$\n因此，$\\log_{10}\\gamma_{\\mathrm{CO_3}^{2-}} \\approx -0.43843$，这给出：\n$$\n\\gamma_{\\mathrm{CO_3}^{2-}} = 10^{-0.43843} \\approx 0.36439\n$$\n\n现在我们可以使用推导出的关系式和给定的值 $K^{\\circ} = 3.31 \\times 10^{-9}$ 来计算条件平衡常数 $K'$。\n$$\nK' = \\frac{K^{\\circ}}{\\gamma_{\\mathrm{Ca}^{2+}} \\gamma_{\\mathrm{CO_3}^{2-}}} = \\frac{3.31 \\times 10^{-9}}{(0.40144)(0.36439)}\n$$\n$$\nK' \\approx \\frac{3.31 \\times 10^{-9}}{0.14628} \\approx 2.2628 \\times 10^{-8}\n$$\n将结果四舍五入到三位有效数字，得到：\n$$\nK' \\approx 2.26 \\times 10^{-8}\n$$\n\n**第三部分：定性比较**\n\n热力学平衡常数为 $K^{\\circ} = 3.31 \\times 10^{-9}$。\n在 $I=0.1$ 时的条件平衡常数为 $K' \\approx 2.26 \\times 10^{-8}$。\n\n比较这两个值，我们发现 $K'  K^{\\circ}$。具体来说，$K'$ 约比 $K^{\\circ}$ 大 $6.8$ 倍。这是活度系数小于1（$\\gamma_{\\mathrm{Ca}^{2+}} \\approx 0.40$ 和 $\\gamma_{\\mathrm{CO_3}^{2-}} \\approx 0.36$）的直接结果。在具有显著离子强度的非理想溶液中，带电离子（$\\mathrm{Ca}^{2+}$ 和 $\\mathrm{CO_3}^{2-}$）被周围的离子氛静电屏蔽并稳定化。这种稳定作用降低了它们的化学势，与理想的无限稀释溶液相比，使它们更“倾向于”以溶解状态存在。由于 $K'$ 由质量摩尔浓度的乘积（$m_{\\mathrm{Ca}^{2+}} m_{\\mathrm{CO_3}^{2-}}$）定义，因此较大的 $K'$ 值意味着在此离子强度下 $\\mathrm{CaCO_3(s)}$ 的总溶解度更高。",
            "answer": "$$\n\\boxed{2.26 \\times 10^{-8}}\n$$"
        },
        {
            "introduction": "在物质形态和活度原理的基础上，这最后一个实践将综合构建一个针对地球上最关键化学缓冲体系——碳酸盐体系的完整计算模型。在这个练习中，$pH$值不再是给定的，你将把它作为一个主变量，由溶解无机碳（DIC）和总碱度（Alk）这两个守恒量共同决定并求解。这个练习展示了如何建立并数值求解控制性的非线性方程组，这是模拟海洋、湖泊和河流化学过程的一项核心技能。",
            "id": "4069845",
            "problem": "考虑一个温度为 $25^\\circ\\mathrm{C}$ 的水溶液，其中包含一个二氧化碳体系。此体系在理想行为（活度系数等于$1$）和除水自身电离外离子相互作用可忽略不计的假设下。该体系包含 $\\mathrm{CO_2(aq)}$、$\\mathrm{HCO_3^-}$、$\\mathrm{CO_3^{2-}}$、$\\mathrm{H^+}$ 和 $\\mathrm{OH^-}$ 物种。溶解无机碳（DIC）定义为含碳物种的浓度之和，总碱度（Alk）在操作上定义为纯水中碳酸盐体系的质子受体之和减去质子给体之和。在理想条件下，相关的基本关系是酸解离和水自身电离的质量作用定律、碳的质量平衡，以及通过碳酸盐体系（不考虑硼酸盐、磷酸盐或其他碱的贡献）的碱度操作性定义所表示的电中性。\n\n使用的基本定义如下：\n- 首次解离的质量作用定律：$K_1 = \\dfrac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{[\\mathrm{CO_2(aq)}]}$。\n- 二次解离的质量作用定律：$K_2 = \\dfrac{[\\mathrm{H^+}][\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$。\n- 水的自身电离：$K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$。\n- 溶解无机碳质量平衡：$\\mathrm{DIC} = [\\mathrm{CO_2(aq)}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$。\n- 碳酸盐-水体系的碱度：$\\mathrm{Alk} = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]$。\n\n您必须计算溶液的 pH 值，定义为 $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$，以及碳物种 $\\mathrm{CO_2(aq)}$、$\\mathrm{HCO_3^-}$ 和 $\\mathrm{CO_3^{2-}}$ 相对于溶解无机碳的分数分布，定义为\n$f_{\\mathrm{CO_2}} = \\dfrac{[\\mathrm{CO_2(aq)}]}{\\mathrm{DIC}}$，$f_{\\mathrm{HCO_3}} = \\dfrac{[\\mathrm{HCO_3^-}]}{\\mathrm{DIC}}$，和 $f_{\\mathrm{CO_3}} = \\dfrac{[\\mathrm{CO_3^{2-}}]}{\\mathrm{DIC}}$，\n并遵循上述约束条件。\n\n使用在 $25^\\circ\\mathrm{C}$ 和零离子强度下经过充分验证的平衡常数：\n- $K_1 = 10^{-6.35}$，\n- $K_2 = 10^{-10.33}$，\n- $K_w = 10^{-14}$。\n\n所有浓度均以每千克水的质量摩尔浓度为基础处理，所有输入均以 $\\mathrm{mmol\\,kg^{-1}}$ 为单位给出；请在内部将其转换为 $\\mathrm{mol\\,kg^{-1}}$。将 $\\mathrm{pH}$ 报告为无单位数，并将 $f_{\\mathrm{CO_2}}$、$f_{\\mathrm{HCO_3}}$ 和 $f_{\\mathrm{CO_3}}$ 报告为小数。不允许使用百分比。\n\n编写一个完整、可运行的程序，仅从上述基本定义出发，为下列每个以有序对 $(\\mathrm{DIC}, \\mathrm{Alk})$ 表示的测试用例，求解 $\\mathrm{pH}$ 以及分数分布 $f_{\\mathrm{CO_2}}$、$f_{\\mathrm{HCO_3}}$ 和 $f_{\\mathrm{CO_3}}$：\n- 测试用例 1：$(2.0, 2.2)\\ \\mathrm{mmol\\,kg^{-1}}$。\n- 测试用例 2：$(2.0, 1.0)\\ \\mathrm{mmol\\,kg^{-1}}$。\n- 测试用例 3：$(0.001, 0.001)\\ \\mathrm{mmol\\,kg^{-1}}$。\n- 测试用例 4：$(4.0, 4.5)\\ \\mathrm{mmol\\,kg^{-1}}$。\n- 测试用例 5：$(0.5, 0.1)\\ \\mathrm{mmol\\,kg^{-1}}$。\n\n设计考虑：\n- 算法必须求解由上述定义产生的非线性系统，且不得使用任何未从这些基本原理推导出的简化公式。\n- 必须确保所有测试用例的数值稳定性，包括低 DIC 条件和碱度远小于溶解无机碳的情况。\n- 物理单位仅出现在输入中，必须按规定处理。\n\n输出规范：\n- 对于每个测试用例，输出一个包含四个浮点数的列表 $[\\mathrm{pH}, f_{\\mathrm{CO_2}}, f_{\\mathrm{HCO_3}}, f_{\\mathrm{CO_3}}]$。\n- 将所有测试用例的结果汇总到一个列表中。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身也用方括号括起来，例如：$[\\,[x_1,x_2,x_3,x_4],\\,[y_1,y_2,y_3,y_4]\\,]$。\n- 在最终输出中，将每个浮点数四舍五入到六位小数。",
            "solution": "所述问题在科学上和数学上都是有效的。这是一个计算水文地球化学中的适定问题，提供了一套完整的化学基本关系和必要的常数，以便在给定两个主变量——溶解无机碳（$\\mathrm{DIC}$）和总碱度（$\\mathrm{Alk}$）——的情况下，确定碳酸盐体系的形态分布。所有约束条件都是一致的，且所提供的数据在物理上是现实的。\n\n求解过程需要解一个包含五个非线性方程的方程组，以求得五个未知浓度：$[\\mathrm{CO_2(aq)}]$、$[\\mathrm{HCO_3^-}]$、$[\\mathrm{CO_3^{2-}}]$、$[\\mathrm{H^+}]$ 和 $[\\mathrm{OH^-}]$。控制方程如下：\n$1$. $K_1 = \\dfrac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{[\\mathrm{CO_2(aq)}]}$\n$2$. $K_2 = \\dfrac{[\\mathrm{H^+}][\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$\n$3$. $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$\n$4$. $\\mathrm{DIC} = [\\mathrm{CO_2(aq)}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$\n$5$. $\\mathrm{Alk} = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]$\n\n解决该方程组的策略是选择一个单一的主变量，此处为质子浓度 $[\\mathrm{H^+}]$，然后用它和给定的量 $\\mathrm{DIC}$ 与 $\\mathrm{Alk}$ 来表示所有其他未知浓度。我们记 $h = [\\mathrm{H^+}]$。\n\n首先，将含碳物种的浓度表示为 $h$ 和 $\\mathrm{DIC}$ 的函数。根据碳酸盐解离的质量作用定律（方程1和2），我们可以写出：\n$$[\\mathrm{HCO_3^-}] = \\frac{K_1}{h} [\\mathrm{CO_2(aq)}]$$\n$$[\\mathrm{CO_3^{2-}}] = \\frac{K_2}{h} [\\mathrm{HCO_3^-}] = \\frac{K_1 K_2}{h^2} [\\mathrm{CO_2(aq)}]$$\n将这些代入 $\\mathrm{DIC}$ 的质量平衡方程（方程4）：\n$$\\mathrm{DIC} = [\\mathrm{CO_2(aq)}] + \\frac{K_1}{h} [\\mathrm{CO_2(aq)}] + \\frac{K_1 K_2}{h^2} [\\mathrm{CO_2(aq)}]$$\n将 $[\\mathrm{CO_2(aq)}]$ 因子提出，得到：\n$$\\mathrm{DIC} = [\\mathrm{CO_2(aq)}] \\left( 1 + \\frac{K_1}{h} + \\frac{K_1 K_2}{h^2} \\right)$$\n令分母项为 $\\alpha_D = h^2 + K_1 h + K_1 K_2$。我们现在可以将每种碳物种的浓度表示为 $\\mathrm{DIC}$ 和 $h$ 的函数：\n$$[\\mathrm{CO_2(aq)}] = \\mathrm{DIC} \\left( \\frac{h^2}{h^2 + K_1 h + K_1 K_2} \\right) = \\mathrm{DIC} \\left( \\frac{h^2}{\\alpha_D} \\right)$$\n$$[\\mathrm{HCO_3^-}] = \\mathrm{DIC} \\left( \\frac{K_1 h}{h^2 + K_1 h + K_1 K_2} \\right) = \\mathrm{DIC} \\left( \\frac{K_1 h}{\\alpha_D} \\right)$$\n$$[\\mathrm{CO_3^{2-}}] = \\mathrm{DIC} \\left( \\frac{K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) = \\mathrm{DIC} \\left( \\frac{K_1 K_2}{\\alpha_D} \\right)$$\n分数分布 $f_{\\mathrm{CO_2}}$、$f_{\\mathrm{HCO_3}}$ 和 $f_{\\mathrm{CO_3}}$ 是括号中的项，它们仅依赖于 $h$：\n$$f_{\\mathrm{CO_2}} = \\frac{h^2}{\\alpha_D}, \\quad f_{\\mathrm{HCO_3}} = \\frac{K_1 h}{\\alpha_D}, \\quad f_{\\mathrm{CO_3}} = \\frac{K_1 K_2}{\\alpha_D}$$\n\n在定义了碳物种之后，我们使用最后的碱度控制方程（方程5）。氢氧根离子浓度 $[\\mathrm{OH^-}]$ 可由水的自身电离常数（方程3）求得：$[\\mathrm{OH^-}] = K_w / h$。将所有表达式代入碱度方程，得到：\n$$\\mathrm{Alk} = \\left( \\mathrm{DIC} \\frac{K_1 h}{\\alpha_D} \\right) + 2 \\left( \\mathrm{DIC} \\frac{K_1 K_2}{\\alpha_D} \\right) + \\frac{K_w}{h} - h$$\n该方程只包含一个未知数 $h$。为了求解 $h$，我们定义一个残差函数 $F(h)$，它在解处必须等于零：\n$$F(h) = \\mathrm{DIC} \\left( \\frac{K_1 h + 2 K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) + \\frac{K_w}{h} - h - \\mathrm{Alk} = 0$$\n\n这是一个非线性方程，无法解析求解，需要使用数值求根算法。函数 $F(h)$ 具有对求根有利的性质：当 $h \\to 0^+$ 时，项 $K_w/h \\to +\\infty$，所以 $F(h) \\to +\\infty$。当 $h \\to +\\infty$ 时，项 $-h \\to -\\infty$ 并占主导地位，所以 $F(h) \\to -\\infty$。因为 $F(h)$ 对于 $h  0$ 是连续的，这些符号相反的极限保证了对于 $h  0$ 至少存在一个根。这允许使用稳健的区间法，如 Brent 算法。\n\n计算步骤如下：\n$1$. 对于每个以 $\\mathrm{mmol\\,kg^{-1}}$ 为单位给出的输入对 $(\\mathrm{DIC}, \\mathrm{Alk})$，通过除以 $1000$ 将其值转换为基本单位 $\\mathrm{mol\\,kg^{-1}}$。\n$2$. 使用转换后的 $\\mathrm{DIC}$ 和 $\\mathrm{Alk}$ 以及给定的常数 $K_1 = 10^{-6.35}$，$K_2 = 10^{-10.33}$ 和 $K_w = 10^{-14}$ 来定义残差函数 $F(h)$。\n$3$. 使用数值求解器，特别是 `scipy.optimize.brentq`，在一个宽而安全的区间如 $[10^{-14}, 1.0]$（对应于 pH 范围 14 到 0）内找到 $F(h)$ 的根 $h$。\n$4$. 一旦找到唯一的正根 $h$，该方程组即被求解。计算所需的输出：\n   - $\\mathrm{pH} = -\\log_{10}(h)$\n   - $f_{\\mathrm{CO_2}} = h^2 / (h^2 + K_1 h + K_1 K_2)$\n   - $f_{\\mathrm{HCO_3}} = K_1 h / (h^2 + K_1 h + K_1 K_2)$\n   - $f_{\\mathrm{CO_3}} = K_1 K_2 / (h^2 + K_1 h + K_1 K_2)$\n$5$. 收集每个测试用例的结果—$[\\mathrm{pH}, f_{\\mathrm{CO_2}}, f_{\\mathrm{HCO_3}}, f_{\\mathrm{CO_3}}]$—每个值四舍五入到六位小数，并格式化为指定的输出结构。\n此过程遵循了从基本原理出发求解的要求，并提供了一个数值稳定且准确的解。",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for pH and carbonate species fractions in an aqueous solution.\n    \n    The function takes pairs of (DIC, Alk), solves the carbonate system\n    using fundamental equations, and computes pH and the fractional distribution\n    of CO2(aq), HCO3-, and CO3^2-.\n    \"\"\"\n    \n    # Define equilibrium constants for 25°C and zero ionic strength\n    K1 = 10**(-6.35)\n    K2 = 10**(-10.33)\n    Kw = 10**(-14.00)\n\n    # Define test cases as (DIC, Alk) in mmol/kg\n    test_cases_mmol = [\n        (2.0, 2.2),\n        (2.0, 1.0),\n        (0.001, 0.001),\n        (4.0, 4.5),\n        (0.5, 0.1)\n    ]\n\n    # Convert inputs from mmol/kg to mol/kg\n    test_cases_mol = [(dic / 1000.0, alk / 1000.0) for dic, alk in test_cases_mmol]\n\n    all_results = []\n\n    for dic, alk in test_cases_mol:\n        \n        def residual_function(h):\n            \"\"\"\n            The master equation F(h) = 0 to be solved for h = [H+].\n            \n            This function represents the alkalinity balance where all species\n            concentrations are expressed in terms of h and DIC.\n            \"\"\"\n            # h must be positive\n            if h == 0:\n                return np.inf\n            \n            # Common denominator for carbonate speciation fractions\n            denominator = h**2 + K1 * h + K1 * K2\n            \n            # Carbonate alkalinity: [HCO3-] + 2*[CO3^2-]\n            carbonate_alk_term = dic * (K1 * h + 2 * K1 * K2) / denominator\n            \n            # Water contribution to alkalinity: [OH-] - [H+]\n            water_alk_term = Kw / h - h\n            \n            # The full residual function, which should be zero at the correct h\n            return carbonate_alk_term + water_alk_term - alk\n\n        # Use Brent's method to find the root h = [H+].\n        # The bracket [1e-14, 1.0] corresponds to pH range [14, 0]\n        # and is guaranteed to contain the root because the function\n        # goes from +inf to -inf over this interval.\n        try:\n            h_conc = optimize.brentq(residual_function, 1e-14, 1.0, xtol=1e-16)\n        except ValueError:\n            # This should not occur given the function's properties,\n            # but is included for robustness.\n            all_results.append([float('nan')] * 4)\n            continue\n            \n        # Once h is found, calculate pH\n        ph = -np.log10(h_conc)\n\n        # Calculate the fractional distribution of carbon species\n        denominator = h_conc**2 + K1 * h_conc + K1 * K2\n        f_co2 = (h_conc**2) / denominator\n        f_hco3 = (K1 * h_conc) / denominator\n        f_co3 = (K1 * K2) / denominator\n\n        # Store the calculated values for this test case\n        case_result = [ph, f_co2, f_hco3, f_co3]\n        all_results.append(case_result)\n        \n    # Format the final output according to the problem specification.\n    # Each float is rounded to 6 decimal places.\n    # The result is a list of lists, formatted as a string.\n    formatted_cases = []\n    for case_res in all_results:\n        # Format each number in the sublist to 6 decimal places\n        formatted_numbers = [f\"{num:.6f}\" for num in case_res]\n        # Join numbers with commas and enclose in brackets \"[]\"\n        case_str = f\"[{','.join(formatted_numbers)}]\"\n        formatted_cases.append(case_str)\n    \n    # Join all case strings with a comma and enclose in outer brackets \"[]\"\n    final_output_str = f\"[{','.join(formatted_cases)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}