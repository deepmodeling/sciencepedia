{
    "hands_on_practices": [
        {
            "introduction": "Before constructing complex diagrams, it is essential to understand the physical meaning of their geometric features. This exercise challenges you to connect the visual properties of mineral stability boundaries—specifically their slopes and intercepts—to the underlying thermodynamic principles of reaction stoichiometry and standard Gibbs free energy. Mastering this connection is the first step toward interpreting these diagrams with confidence .",
            "id": "4073937",
            "problem": "An activity-activity diagram is to be constructed at $25\\,^{\\circ}\\mathrm{C}$ for aqueous calcium carbonate systems with axes $\\log_{10} a_{\\mathrm{CO_3^{2-}}}$ (vertical) versus $\\log_{10} a_{\\mathrm{Ca^{2+}}}$ (horizontal). Consider the dissolution reactions of the two calcium carbonate polymorphs:\n$\\mathrm{CaCO_3(s,\\,calcite)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_3^{2-}}$ and $\\mathrm{CaCO_3(s,\\,aragonite)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_3^{2-}}$, where the activities of pure solids are taken as $1$.\nThe base-$10$ logarithms of the equilibrium constants (K) at $25\\,^{\\circ}\\mathrm{C}$ are $\\log_{10} K_{\\mathrm{calcite}} = -8.48$ and $\\log_{10} K_{\\mathrm{aragonite}} = -8.34$. When these equilibria are plotted on the described activity-activity diagram, the two boundaries appear as straight lines that are parallel but have different vertical intercepts.\n\nStarting from the definition of chemical potential $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$, the equilibrium condition $\\sum_i \\nu_i \\mu_i = 0$ for a reaction at constant temperature, and the resulting law of mass action expressed in terms of activities, reason from first principles to interpret the thermodynamic meaning of the observed parallelism and intercept difference. Assume that any activities of species not plotted on the axes are held fixed, and that activities (not concentrations) are being used so non-ideality is already included in $a_i$.\n\nWhich one of the following statements best captures the thermodynamic interpretation of two parallel boundaries with different intercepts on such an activity-activity diagram?\n\nA. Parallelism indicates identical ratios of stoichiometric coefficients for the plotted aqueous species on the axes; the different intercepts arise from different $\\log_{10} K$ values (equivalently different standard Gibbs free energy changes, $\\Delta G^\\circ$) for the reactions, with other activities held fixed.\n\nB. Parallelism indicates the reactions have identical $\\log_{10} K$ values; the different intercepts arise solely from differences in activity coefficients, since activities are non-ideal.\n\nC. Parallelism indicates that both reactions exchange the same total ionic charge between the plotted species; the different intercepts reflect differences in ionic strength, not equilibrium thermodynamics.\n\nD. Parallel boundaries cannot arise for distinct minerals at fixed temperature, because this would violate thermodynamic uniqueness and imply the same reaction free energy.",
            "solution": "### Derivation from First Principles\nThe problem requires a derivation starting from the definitions of chemical potential and the condition for chemical equilibrium.\n\nFor a general chemical reaction $\\sum_i \\nu_i S_i = 0$, where $S_i$ are the chemical species and $\\nu_i$ are their stoichiometric coefficients (negative for reactants, positive for products), the condition for equilibrium at constant temperature and pressure is that the Gibbs free energy change of reaction is zero: $\\Delta G_r = 0$. This can be expressed in terms of chemical potentials $\\mu_i$ as:\n$$ \\sum_i \\nu_i \\mu_i = 0 $$\nThe chemical potential of species $i$ is given by $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$, where $\\mu_i^\\circ$ is the standard state chemical potential, $R$ is the ideal gas constant, $T$ is the absolute temperature, and $a_i$ is the activity of species $i$.\n\nSubstituting this into the equilibrium condition:\n$$ \\sum_i \\nu_i (\\mu_i^\\circ + RT \\ln a_i) = 0 $$\n$$ \\sum_i \\nu_i \\mu_i^\\circ + RT \\sum_i \\nu_i \\ln a_i = 0 $$\nThe first term, $\\sum_i \\nu_i \\mu_i^\\circ$, is the standard Gibbs free energy change of the reaction, denoted $\\Delta G_r^\\circ$. The second term can be rewritten using properties of logarithms:\n$$ \\Delta G_r^\\circ + RT \\ln \\left( \\prod_i a_i^{\\nu_i} \\right) = 0 $$\nAt equilibrium, the product term $\\prod_i a_i^{\\nu_i}$ is defined as the equilibrium constant, $K$.\n$$ K = \\prod_i a_i^{\\nu_i} $$\nThis is the law of mass action expressed in terms of activities. The relationship between $\\Delta G_r^\\circ$ and $K$ is thus $\\Delta G_r^\\circ = -RT \\ln K$.\n\nNow, we apply this general result to the two specific dissolution reactions.\n\n**1. Calcite Dissolution:** $\\mathrm{CaCO_3(s,\\,calcite)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_3^{2-}}$\nThe stoichiometric coefficients are $\\nu_{\\mathrm{CaCO_3(s)}} = -1$, $\\nu_{\\mathrm{Ca^{2+}}} = +1$, and $\\nu_{\\mathrm{CO_3^{2-}}} = +1$.\nThe law of mass action gives the equilibrium constant $K_{\\mathrm{calcite}}$:\n$$ K_{\\mathrm{calcite}} = \\frac{a_{\\mathrm{Ca^{2+}}}^{\\,+1} \\cdot a_{\\mathrm{CO_3^{2-}}}^{\\,+1}}{a_{\\mathrm{CaCO_3(s,\\,calcite)}}^{\\,+1}} $$\nGiven that the activity of a pure solid is $1$, this simplifies to:\n$$ K_{\\mathrm{calcite}} = a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}} $$\n\n**2. Aragonite Dissolution:** $\\mathrm{CaCO_3(s,\\,aragonite)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_3^{2-}}$\nBy identical reasoning, the equilibrium constant $K_{\\mathrm{aragonite}}$ is:\n$$ K_{\\mathrm{aragonite}} = a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}} $$\n\nTo construct the activity-activity diagram, we take the base-$10$ logarithm of these equations.\nFor calcite:\n$$ \\log_{10} K_{\\mathrm{calcite}} = \\log_{10} (a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}}) = \\log_{10} a_{\\mathrm{Ca^{2+}}} + \\log_{10} a_{\\mathrm{CO_3^{2-}}} $$\nFor aragonite:\n$$ \\log_{10} K_{\\mathrm{aragonite}} = \\log_{10} (a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}}) = \\log_{10} a_{\\mathrm{Ca^{2+}}} + \\log_{10} a_{\\mathrm{CO_3^{2-}}} $$\n\nThe diagram axes are defined as $y = \\log_{10} a_{\\mathrm{CO_3^{2-}}}$ and $x = \\log_{10} a_{\\mathrm{Ca^{2+}}}$. We rearrange the equations into the standard linear form $y = mx + c$.\n\nFor the calcite boundary:\n$$ \\log_{10} a_{\\mathrm{CO_3^{2-}}} = -1 \\cdot \\log_{10} a_{\\mathrm{Ca^{2+}}} + \\log_{10} K_{\\mathrm{calcite}} $$\nThis equation has a slope $m_{\\mathrm{calcite}} = -1$ and a vertical intercept $c_{\\mathrm{calcite}} = \\log_{10} K_{\\mathrm{calcite}} = -8.48$.\n\nFor the aragonite boundary:\n$$ \\log_{10} a_{\\mathrm{CO_3^{2-}}} = -1 \\cdot \\log_{10} a_{\\mathrm{Ca^{2+}}} + \\log_{10} K_{\\mathrm{aragonite}} $$\nThis equation has a slope $m_{\\mathrm{aragonite}} = -1$ and a vertical intercept $c_{\\mathrm{aragonite}} = \\log_{10} K_{\\mathrm{aragonite}} = -8.34$.\n\n**Interpreting the Results:**\n- **Parallelism (Slope):** The slopes of both lines are $m = -1$. In general, for a reaction boundary plotted on axes $\\log a_Y$ vs. $\\log a_X$, the slope is given by $m = -\\nu_X / \\nu_Y$, where $\\nu_X$ and $\\nu_Y$ are the stoichiometric coefficients of the species on the horizontal and vertical axes, respectively. For both calcite and aragonite dissolution, $\\nu_{\\mathrm{Ca^{2+}}} = 1$ and $\\nu_{\\mathrm{CO_3^{2-}}} = 1$. The slope is therefore $m = -1/1 = -1$ for both. The lines are parallel because the ratio of the stoichiometric coefficients of the plotted aqueous species is identical for both reactions.\n\n- **Intercept Difference:** The vertical intercepts are $c_{\\mathrm{calcite}} = \\log_{10} K_{\\mathrm{calcite}}$ and $c_{\\mathrm{aragonite}} = \\log_{10} K_{\\mathrm{aragonite}}$. The problem gives $\\log_{10} K_{\\mathrm{calcite}} = -8.48$ and $\\log_{10} K_{\\mathrm{aragonite}} = -8.34$. These values are different. The intercepts are different because the equilibrium constants $K$ are different for the two dissolution reactions. The equilibrium constant is related to the standard Gibbs free energy of reaction by $\\Delta G_r^\\circ = -RT \\ln K = -2.303 RT \\log_{10} K$. Since calcite and aragonite are different mineral polymorphs, they have different standard Gibbs free energies of formation ($\\mu_{\\mathrm{calcite}}^\\circ \\neq \\mu_{\\mathrm{aragonite}}^\\circ$). This leads to different $\\Delta G_r^\\circ$ values for their dissolution and consequently different $K$ values. The different intercepts directly reflect the different standard Gibbs free energies of the reactions.\n\n### Evaluation of Options\n\n**A. Parallelism indicates identical ratios of stoichiometric coefficients for the plotted aqueous species on the axes; the different intercepts arise from different $\\log_{10} K$ values (equivalently different standard Gibbs free energy changes, $\\Delta G^\\circ$) for the reactions, with other activities held fixed.**\nThis statement is a precise summary of the derived results. The parallelism is due to the identical stoichiometry of the aqueous products ($1:1$ ratio), which sets the slope to $-1$ for both. The different intercepts are due to the different values of $\\log_{10} K$, which are a direct consequence of the different standard Gibbs free energies of the two mineral polymorphs.\n**Verdict: Correct.**\n\n**B. Parallelism indicates the reactions have identical $\\log_{10} K$ values; the different intercepts arise solely from differences in activity coefficients, since activities are non-ideal.**\nThis is incorrect. Parallelism is related to stoichiometry (the slope), not the value of $K$ (the intercept). Furthermore, the problem explicitly states that different intercepts are observed, which implies different $\\log_{10} K$ values. The intercepts are thermodynamic constants related to $\\Delta G_r^\\circ$, not variables dependent on activity coefficients in the solution, especially since the diagram is plotted in terms of activities directly.\n**Verdict: Incorrect.**\n\n**C. Parallelism indicates that both reactions exchange the same total ionic charge between the plotted species; the different intercepts reflect differences in ionic strength, not equilibrium thermodynamics.**\nThe first part about ionic charge is a related consequence of the stoichiometry but is not the direct mathematical reason for the slope, which is the ratio of coefficients. The second part is incorrect. Intercepts are determined by $\\log_{10} K$, a fundamental thermodynamic parameter. While ionic strength affects activity coefficients, it does not change the thermodynamic equilibrium constant $K$. The difference in intercepts reflects a fundamental difference in the stability of calcite versus aragonite ($\\Delta G_r^\\circ$), not a property of the solution like ionic strength.\n**Verdict: Incorrect.**\n\n**D. Parallel boundaries cannot arise for distinct minerals at fixed temperature, because this would violate thermodynamic uniqueness and imply the same reaction free energy.**\nThis statement is false. As derived, parallel boundaries arise whenever the reactions involving two distinct minerals produce the plotted aqueous species in the same stoichiometric ratio. Parallelism (same slope) is independent of the intercepts. Different intercepts imply different $\\log_{10} K$ values and thus different standard reaction free energies ($\\Delta G_r^\\circ$), which is exactly what is expected for two distinct minerals. There is no violation of thermodynamic uniqueness.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Building on the principles of single stability lines, this practice explores their intersections, which represent points of mineral co-stability. You will derive boundary equations from the law of mass action and solve for the unique activities at which three distinct carbonate minerals can coexist in equilibrium. This exercise simulates the calculation of a geochemical \"triple point,\" a fundamental skill for identifying the conditions that govern mineral assemblages .",
            "id": "4073982",
            "problem": "Consider an aqueous system at temperature $T = 25\\,^{\\circ}\\mathrm{C}$ and pressure $P = 1\\,\\mathrm{bar}$, with ideal behavior for solutes and standard-state activities ($a$) for pure solids equal to $1$. The aqueous activity of carbonate is fixed at $a_{\\mathrm{CO_3^{2-}}} = 10^{-3}$. You will construct and interpret an activity-activity diagram with axes $X = \\log_{10} a_{\\mathrm{Ca^{2+}}}$ and $Y = \\log_{10} a_{\\mathrm{Mg^{2+}}}$.\n\nThree carbonate minerals are considered: calcite $\\mathrm{CaCO_3(s)}$, magnesite $\\mathrm{MgCO_3(s)}$, and dolomite $\\mathrm{CaMg(CO_3)_2(s)}$. Adopt thermodynamically consistent base-$10$ equilibrium constants for the dissolution reactions at the stated conditions:\n- $\\mathrm{CaCO_3(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_3^{2-}}$ with $\\log_{10} K_{\\mathrm{cal}} = -8.48$,\n- $\\mathrm{MgCO_3(s)} \\rightleftharpoons \\mathrm{Mg^{2+}} + \\mathrm{CO_3^{2-}}$ with $\\log_{10} K_{\\mathrm{mag}} = -8.60$,\n- $\\mathrm{CaMg(CO_3)_2(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{Mg^{2+}} + 2\\,\\mathrm{CO_3^{2-}}$ with $\\log_{10} K_{\\mathrm{dol}} = -17.08$.\n\nThe fundamental base you must use is the equilibrium-constant definition $K = \\prod_{i} a_{i}^{\\nu_{i}}$ for the reaction written with activities $a_{i}$ of products raised to stoichiometric coefficients $\\nu_{i}$, and with pure-solid activities equal to $1$. Additionally, for interpreting boundaries, use the definition of saturation index (SI) as $\\mathrm{SI} = \\log_{10}(\\mathrm{IAP}/K)$, where $\\mathrm{IAP}$ is the ion activity product.\n\nTasks:\n1. Starting from the equilibrium-constant definition and the fixed $a_{\\mathrm{CO_3^{2-}}}$, derive the linear boundary in the $\\log_{10} a_{\\mathrm{Ca^{2+}}}$–$\\log_{10} a_{\\mathrm{Mg^{2+}}}$ plane corresponding to dolomite equilibrium with the solution. Then, using the saturation-index definition, derive the linear boundary where calcite and magnesite have equal saturation, i.e., $\\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}}$.\n2. Solve for the unique intersection point $(\\log_{10} a_{\\mathrm{Ca^{2+}}}, \\log_{10} a_{\\mathrm{Mg^{2+}}})$ that satisfies both derived linear boundaries.\n3. Based on the intersection you obtained, identify the mineral assemblage that can coexist at equilibrium with the aqueous solution at that point and briefly justify this in terms of saturation indices.\n\nExpress the numerical values of $\\log_{10} a_{\\mathrm{Ca^{2+}}}$ and $\\log_{10} a_{\\mathrm{Mg^{2+}}}$ in the final answer, rounded to four significant figures. Activities are dimensionless, so no physical units are required for the final numerical values.",
            "solution": "The activity-activity diagram is constructed in a plane with axes $X = \\log_{10} a_{\\mathrm{Ca^{2+}}}$ and $Y = \\log_{10} a_{\\mathrm{Mg^{2+}}}$. The analysis is performed at a fixed temperature $T = 25\\,^{\\circ}\\mathrm{C}$, pressure $P = 1\\,\\mathrm{bar}$, and aqueous carbonate activity $a_{\\mathrm{CO_3^{2-}}} = 10^{-3}$.\n\n### Task 1: Derivation of Linear Boundaries\n\nFirst, we derive the linear boundary corresponding to equilibrium between the aqueous solution and solid dolomite, $\\mathrm{CaMg(CO_3)_2(s)}$. The dissolution reaction is:\n$$ \\mathrm{CaMg(CO_3)_2(s)} \\rightleftharpoons \\mathrm{Ca^{2+}(aq)} + \\mathrm{Mg^{2+}(aq)} + 2\\,\\mathrm{CO_3^{2-}(aq)} $$\nThe equilibrium constant, $K_{\\mathrm{dol}}$, is defined by the law of mass action. Given that the activity of a pure solid is $1$, the expression is:\n$$ K_{\\mathrm{dol}} = a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{Mg^{2+}}} a_{\\mathrm{CO_3^{2-}}}^{2} $$\nTaking the base-$10$ logarithm of both sides yields:\n$$ \\log_{10} K_{\\mathrm{dol}} = \\log_{10} (a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{Mg^{2+}}} a_{\\mathrm{CO_3^{2-}}}^{2}) $$\nUsing the properties of logarithms, we expand the right-hand side:\n$$ \\log_{10} K_{\\mathrm{dol}} = \\log_{10} a_{\\mathrm{Ca^{2+}}} + \\log_{10} a_{\\mathrm{Mg^{2+}}} + 2 \\log_{10} a_{\\mathrm{CO_3^{2-}}} $$\nSubstituting the defined axes $X = \\log_{10} a_{\\mathrm{Ca^{2+}}}$ and $Y = \\log_{10} a_{\\mathrm{Mg^{2+}}}$, we get:\n$$ \\log_{10} K_{\\mathrm{dol}} = X + Y + 2 \\log_{10} a_{\\mathrm{CO_3^{2-}}} $$\nWe are given $\\log_{10} K_{\\mathrm{dol}} = -17.08$ and $a_{\\mathrm{CO_3^{2-}}} = 10^{-3}$, which implies $\\log_{10} a_{\\mathrm{CO_3^{2-}}} = -3$. Substituting these values:\n$$ -17.08 = X + Y + 2(-3) $$\n$$ -17.08 = X + Y - 6 $$\nThis simplifies to the first linear equation for the dolomite stability boundary:\n$$ X + Y = -11.08 \\quad (\\text{Equation 1}) $$\n\nSecond, we derive the linear boundary where calcite, $\\mathrm{CaCO_3(s)}$, and magnesite, $\\mathrm{MgCO_3(s)}$, have equal saturation indices. The problem defines the saturation index as $\\mathrm{SI} = \\log_{10}(\\mathrm{IAP}/K)$. The condition is $\\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}}$.\n$$ \\log_{10}(\\mathrm{IAP}_{\\mathrm{cal}}/K_{\\mathrm{cal}}) = \\log_{10}(\\mathrm{IAP}_{\\mathrm{mag}}/K_{\\mathrm{mag}}) $$\nThis implies:\n$$ \\frac{\\mathrm{IAP}_{\\mathrm{cal}}}{K_{\\mathrm{cal}}} = \\frac{\\mathrm{IAP}_{\\mathrm{mag}}}{K_{\\mathrm{mag}}} $$\nFor calcite, the dissolution is $\\mathrm{CaCO_3(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_3^{2-}}$, so the ion activity product is $\\mathrm{IAP}_{\\mathrm{cal}} = a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}}$.\nFor magnesite, the dissolution is $\\mathrm{MgCO_3(s)} \\rightleftharpoons \\mathrm{Mg^{2+}} + \\mathrm{CO_3^{2-}}$, so the ion activity product is $\\mathrm{IAP}_{\\mathrm{mag}} = a_{\\mathrm{Mg^{2+}}} a_{\\mathrm{CO_3^{2-}}}$.\nThe condition of equal saturation becomes:\n$$ \\frac{a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}}}{K_{\\mathrm{cal}}} = \\frac{a_{\\mathrm{Mg^{2+}}} a_{\\mathrm{CO_3^{2-}}}}{K_{\\mathrm{mag}}} $$\nSince the carbonate activity $a_{\\mathrm{CO_3^{2-}}}$ is fixed and non-zero, it can be cancelled from both sides:\n$$ \\frac{a_{\\mathrm{Ca^{2+}}}}{K_{\\mathrm{cal}}} = \\frac{a_{\\mathrm{Mg^{2+}}}}{K_{\\mathrm{mag}}} $$\nTaking the base-$10$ logarithm of the entire equation:\n$$ \\log_{10}\\left(\\frac{a_{\\mathrm{Ca^{2+}}}}{K_{\\mathrm{cal}}}\\right) = \\log_{10}\\left(\\frac{a_{\\mathrm{Mg^{2+}}}}{K_{\\mathrm{mag}}}\\right) $$\n$$ \\log_{10} a_{\\mathrm{Ca^{2+}}} - \\log_{10} K_{\\mathrm{cal}} = \\log_{10} a_{\\mathrm{Mg^{2+}}} - \\log_{10} K_{\\mathrm{mag}} $$\nSubstituting $X = \\log_{10} a_{\\mathrm{Ca^{2+}}}$ and $Y = \\log_{10} a_{\\mathrm{Mg^{2+}}}$:\n$$ X - \\log_{10} K_{\\mathrm{cal}} = Y - \\log_{10} K_{\\mathrm{mag}} $$\nRearranging to group the variables $X$ and $Y$:\n$$ X - Y = \\log_{10} K_{\\mathrm{cal}} - \\log_{10} K_{\\mathrm{mag}} $$\nWe are given $\\log_{10} K_{\\mathrm{cal}} = -8.48$ and $\\log_{10} K_{\\mathrm{mag}} = -8.60$. Substituting these values:\n$$ X - Y = -8.48 - (-8.60) = -8.48 + 8.60 $$\nThis gives the second linear equation:\n$$ X - Y = 0.12 \\quad (\\text{Equation 2}) $$\n\n### Task 2: Calculation of the Intersection Point\n\nThe intersection point $(\\log_{10} a_{\\mathrm{Ca^{2+}}}, \\log_{10} a_{\\mathrm{Mg^{2+}}}) = (X, Y)$ is found by solving the system of two linear equations derived above:\n1. $X + Y = -11.08$\n2. $X - Y = 0.12$\n\nWe can solve this system by adding the two equations to eliminate $Y$:\n$$ (X + Y) + (X - Y) = -11.08 + 0.12 $$\n$$ 2X = -10.96 $$\n$$ X = -\\frac{10.96}{2} = -5.48 $$\nNow, substitute the value of $X$ back into Equation 1 to find $Y$:\n$$ -5.48 + Y = -11.08 $$\n$$ Y = -11.08 + 5.48 = -5.60 $$\nThus, the intersection point is $(X, Y) = (-5.48, -5.60)$. This corresponds to activities $\\log_{10} a_{\\mathrm{Ca^{2+}}} = -5.48$ and $\\log_{10} a_{\\mathrm{Mg^{2+}}} = -5.60$.\n\n### Task 3: Identification and Justification of Mineral Assemblage\n\nThe calculated intersection point is, by construction, a point in the activity diagram where two conditions are simultaneously met:\n1. The solution is in equilibrium with dolomite. This means the ion activity product for dolomite equals its equilibrium constant, so $\\mathrm{SI}_{\\mathrm{dol}} = \\log_{10}(\\mathrm{IAP}_{\\mathrm{dol}}/K_{\\mathrm{dol}}) = 0$.\n2. The saturation indices of calcite and magnesite are equal: $\\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}}$.\n\nWe must evaluate the saturation index for calcite (and thus magnesite) at this point to determine if they are also at equilibrium.\n$$ \\mathrm{SI}_{\\mathrm{cal}} = \\log_{10}(\\mathrm{IAP}_{\\mathrm{cal}}) - \\log_{10}(K_{\\mathrm{cal}}) $$\n$$ \\mathrm{SI}_{\\mathrm{cal}} = \\log_{10}(a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}}) - \\log_{10}(K_{\\mathrm{cal}}) $$\n$$ \\mathrm{SI}_{\\mathrm{cal}} = \\log_{10} a_{\\mathrm{Ca^{2+}}} + \\log_{10} a_{\\mathrm{CO_3^{2-}}} - \\log_{10} K_{\\mathrm{cal}} $$\nSubstituting the values at the intersection point: $\\log_{10} a_{\\mathrm{Ca^{2+}}} = -5.48$, $\\log_{10} a_{\\mathrm{CO_3^{2-}}} = -3$, and $\\log_{10} K_{\\mathrm{cal}} = -8.48$:\n$$ \\mathrm{SI}_{\\mathrm{cal}} = -5.48 + (-3) - (-8.48) = -8.48 + 8.48 = 0 $$\nAn $\\mathrm{SI}_{\\mathrm{cal}}$ of $0$ signifies that the solution is also in equilibrium with calcite.\nSince $\\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}}$, it follows directly that $\\mathrm{SI}_{\\mathrm{mag}} = 0$. This can be verified independently:\n$$ \\mathrm{SI}_{\\mathrm{mag}} = \\log_{10} a_{\\mathrm{Mg^{2+}}} + \\log_{10} a_{\\mathrm{CO_3^{2-}}} - \\log_{10} K_{\\mathrm{mag}} $$\n$$ \\mathrm{SI}_{\\mathrm{mag}} = -5.60 + (-3) - (-8.60) = -8.60 + 8.60 = 0 $$\nSo, $\\mathrm{SI}_{\\mathrm{mag}} = 0$ as well.\n\nAt this unique point, the saturation indices for all three minerals are equal to $0$:\n$$ \\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}} = \\mathrm{SI}_{\\mathrm{dol}} = 0 $$\nThis means the aqueous solution is simultaneously in equilibrium with all three solid phases. Therefore, the mineral assemblage that can coexist at equilibrium with the aqueous solution at this point is calcite, magnesite, and dolomite. This point is a triple point in the activity diagram for this system.\n\nThe final numerical answers for the coordinates of the intersection point, rounded to four significant figures, are $\\log_{10} a_{\\mathrm{Ca^{2+}}} = -5.480$ and $\\log_{10} a_{\\mathrm{Mg^{2+}}} = -5.600$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-5.480 & -5.600\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Modern geochemical analysis relies on robust computational methods to handle the complexities of real-world systems. This practice guides you through designing the core algorithm for generating an activity-activity diagram, explicitly accounting for the non-ideal behavior of aqueous solutions through an iterative solver. By implementing a self-consistent calculation for ionic strength and activity coefficients, you will bridge the gap between thermodynamic theory and practical, computational geochemistry .",
            "id": "4073962",
            "problem": "You are tasked with constructing a computational framework for rendering an activity-activity diagram in a geochemical system with two aqueous anions and one aqueous cation that potentially precipitate two distinct minerals. The program must implement a grid-based evaluation of the ratio of the reaction quotient to the equilibrium constant, and it must incorporate iterative updates of activity coefficients until convergence to ensure robustness across different ionic strengths. The focus is on clear derivation from first principles and an algorithm that is numerically stable.\n\nBegin from the following fundamental base:\n\n- The law of mass action for equilibrium, which states that for a generic reaction with stoichiometric coefficients $\\nu_i$, the reaction quotient is $Q = \\prod_i a_i^{\\nu_i}$, and at equilibrium $Q = K$, where $K$ is the equilibrium constant. The ratio $Q/K$ serves as a dimensionless indicator of saturation.\n- The definition of activity $a_i$ as $a_i = \\gamma_i m_i$, where $\\gamma_i$ is the activity coefficient and $m_i$ is the molality (in $\\mathrm{mol/kg}$; in the dilute limit one may treat molarity in $\\mathrm{mol/L}$ analogously).\n- The ionic strength $I$ of an aqueous solution is given by $I = \\frac{1}{2}\\sum_i m_i z_i^2$, where $z_i$ is the charge of species $i$.\n- The Davies equation (a widely accepted empirical extension of the Debye-Hückel law at $25\\,^\\circ\\mathrm{C}$ for moderate ionic strengths) gives the activity coefficient of ion $i$ as\n$$\n\\log_{10}\\gamma_i = -A z_i^2\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right),\n$$\nwith $A = 0.509$ at $25\\,^\\circ\\mathrm{C}$.\n\nConsider an aqueous system with the ions $A^-$, $B^{2-}$, and $C^{2+}$ (think of $A^-$ as fluoride, $B^{2-}$ as carbonate, and $C^{2+}$ as calcium for concreteness), together with background electrolyte $\\mathrm{Na}^+$ and $\\mathrm{Cl}^-$. The following mineral reactions are considered:\n\n- Mineral $M_1$: $C^{2+} + B^{2-} \\rightleftharpoons CB(s)$, with $Q_1 = a_{C^{2+}} a_{B^{2-}}$ and an equilibrium constant $K_1$.\n- Mineral $M_2$: $C^{2+} + 2A^- \\rightleftharpoons CA_2(s)$, with $Q_2 = a_{C^{2+}} a_{A^-}^2$ and an equilibrium constant $K_2$.\n\nUse $K_1 = 10^{-8.48}$ and $K_2 = 10^{-10.45}$, both dimensionless in terms of activities at $25\\,^\\circ\\mathrm{C}$. The charges are $z_{A^-} = -1$, $z_{B^{2-}} = -2$, $z_{C^{2+}} = +2$, $z_{\\mathrm{Na}^+} = +1$, and $z_{\\mathrm{Cl}^-} = -1$. The Debye-Hückel constant in the Davies equation is $A = 0.509$.\n\nDefine the axes of the diagram as $\\log_{10} a_{A^-}$ and $\\log_{10} a_{B^{2-}}$. At each grid point, you are given target activities $a_{A^-}$ and $a_{B^{2-}}$, and fixed molalities $m_{\\mathrm{Na}^+}$, $m_{\\mathrm{Cl}^-}$, and $m_{C^{2+}}$. The ionic strength depends on the molalities $m_{A^-}$ and $m_{B^{2-}}$, which are not directly given because $a_{A^-} = \\gamma_{A^-} m_{A^-}$ and $a_{B^{2-}} = \\gamma_{B^{2-}} m_{B^{2-}}$, with $\\gamma_{A^-}$ and $\\gamma_{B^{2-}}$ themselves functions of $I$. Therefore, at each grid point, solve the following fixed-point system iteratively:\n\n1. Initialize $I^{(0)}$ using the known background ions and $m_{C^{2+}}$:\n$$\nI^{(0)} = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} z_{\\mathrm{Na}^+}^2 + m_{\\mathrm{Cl}^-} z_{\\mathrm{Cl}^-}^2 + m_{C^{2+}} z_{C^{2+}}^2\\right) = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}}\\right).\n$$\n2. Given $I^{(k)}$, compute $\\gamma_{A^-}^{(k)}$, $\\gamma_{B^{2-}}^{(k)}$, and $\\gamma_{C^{2+}}^{(k)}$ via the Davies equation with $A = 0.509$.\n3. Update\n$$\nm_{A^-}^{(k)} = \\frac{a_{A^-}}{\\gamma_{A^-}^{(k)}}, \\quad m_{B^{2-}}^{(k)} = \\frac{a_{B^{2-}}}{\\gamma_{B^{2-}}^{(k)}},\n$$\nand\n$$\nI^{(k+1)} = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}} + m_{A^-}^{(k)} + 4 m_{B^{2-}}^{(k)}\\right).\n$$\n4. Iterate until\n$$\n\\left| I^{(k+1)} - I^{(k)} \\right| < \\varepsilon\n$$\nwith a prescribed tolerance $\\varepsilon$, or until a maximum number of iterations $k_{\\max}$ is reached. At the converged $I$, set $a_{C^{2+}} = \\gamma_{C^{2+}} m_{C^{2+}}$.\n\nAt the converged state for each grid point, evaluate the saturation indices\n$$\n\\mathrm{SI}_1 = \\log_{10}\\left(\\frac{Q_1}{K_1}\\right) = \\log_{10}\\left(\\frac{a_{C^{2+}} a_{B^{2-}}}{K_1}\\right), \\quad\n\\mathrm{SI}_2 = \\log_{10}\\left(\\frac{Q_2}{K_2}\\right) = \\log_{10}\\left(\\frac{a_{C^{2+}} a_{A^-}^2}{K_2}\\right).\n$$\nClassify mineral stability at each grid point as follows:\n- If $\\mathrm{SI}_1 > 0$ and $\\mathrm{SI}_2 \\le 0$, classify as $M_1$ stable.\n- If $\\mathrm{SI}_2 > 0$ and $\\mathrm{SI}_1 \\le 0$, classify as $M_2$ stable.\n- If both $\\mathrm{SI}_1 > 0$ and $\\mathrm{SI}_2 > 0$, classify as the mineral with the larger saturation index; if $\\mathrm{SI}_1 = \\mathrm{SI}_2$, choose $M_1$.\n- If both $\\mathrm{SI}_1 \\le 0$ and $\\mathrm{SI}_2 \\le 0$, classify as neither mineral stable.\n\nYour algorithm must handle the full grid, aggregate classification counts, and report convergence diagnostics.\n\nImplementation requirements:\n- Use $\\varepsilon = 10^{-12}$ and $k_{\\max} = 100$.\n- Use $A = 0.509$, $K_1 = 10^{-8.48}$, $K_2 = 10^{-10.45}$.\n\nTest suite:\nProvide three test cases, each defined by the tuple\n$$\n\\left(\\log_{10} a_{A^-}^{\\min}, \\log_{10} a_{A^-}^{\\max}, \\Delta_A, \\log_{10} a_{B^{2-}}^{\\min}, \\log_{10} a_{B^{2-}}^{\\max}, \\Delta_B, m_{C^{2+}}, m_{\\mathrm{Na}^+}, m_{\\mathrm{Cl}^-}\\right),\n$$\nwhere $\\Delta_A$ and $\\Delta_B$ are the uniform step sizes on the respective axes. For each test case, these parameters are:\n\n- Test case $1$ (baseline dilute system):\n  - $\\log_{10} a_{A^-}^{\\min} = -6$, $\\log_{10} a_{A^-}^{\\max} = -3$, $\\Delta_A = 1$,\n  - $\\log_{10} a_{B^{2-}}^{\\min} = -10$, $\\log_{10} a_{B^{2-}}^{\\max} = -6$, $\\Delta_B = 1$,\n  - $m_{C^{2+}} = 10^{-3}$, $m_{\\mathrm{Na}^+} = 0$, $m_{\\mathrm{Cl}^-} = 0$.\n- Test case $2$ (moderate background electrolyte, near-boundary activities):\n  - $\\log_{10} a_{A^-}^{\\min} = -7$, $\\log_{10} a_{A^-}^{\\max} = -5$, $\\Delta_A = 1$,\n  - $\\log_{10} a_{B^{2-}}^{\\min} = -9$, $\\log_{10} a_{B^{2-}}^{\\max} = -7$, $\\Delta_B = 1$,\n  - $m_{C^{2+}} = 3\\times 10^{-4}$, $m_{\\mathrm{Na}^+} = 5\\times 10^{-3}$, $m_{\\mathrm{Cl}^-} = 5\\times 10^{-3}$.\n- Test case $3$ (high background electrolyte, sparse grid):\n  - $\\log_{10} a_{A^-}^{\\min} = -8$, $\\log_{10} a_{A^-}^{\\max} = -4$, $\\Delta_A = 2$,\n  - $\\log_{10} a_{B^{2-}}^{\\min} = -9$, $\\log_{10} a_{B^{2-}}^{\\max} = -5$, $\\Delta_B = 2$,\n  - $m_{C^{2+}} = 10^{-4}$, $m_{\\mathrm{Na}^+} = 10^{-1}$, $m_{\\mathrm{Cl}^-} = 10^{-1}$.\n\nFor each test case, your program must compute over the full grid:\n- The integer count of points classified as $M_1$ stable.\n- The integer count of points classified as $M_2$ stable.\n- The integer count of points classified as neither stable.\n- A boolean indicating whether all grid points met the convergence criterion $|I^{(k+1)} - I^{(k)}| < \\varepsilon$ before $k_{\\max}$.\n- The maximum number of iterations used to converge across grid points.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list containing the five items in the order specified above. For example:\n$[ [n_{M_1}, n_{M_2}, n_{\\mathrm{none}}, \\mathrm{all\\_converged}, k_{\\max,\\mathrm{used}}], [\\dots], [\\dots] ]$.\nNo physical units should be included in the output; all numerical values must be expressed as floats or integers without units. Angles are not involved, and no percentages are required.",
            "solution": "The solution is developed by first establishing the fundamental thermodynamic and electrochemical principles, then designing a robust iterative algorithm to solve the non-linear system of equations at each grid point, and finally specifying the complete computational procedure to process the test cases.\n\n**1. Foundational Principles**\n\nThe stability of a mineral in an aqueous solution is determined by its saturation state. For a generic mineral precipitation reaction, the law of mass action defines the reaction quotient, $Q$, as the product of the activities, $a_i$, of the aqueous species, each raised to the power of its stoichiometric coefficient, $\\nu_i$:\n$$\nQ = \\prod_i a_i^{\\nu_i}\n$$\nAt equilibrium, the reaction quotient equals the equilibrium constant, $K$. The saturation index, $\\mathrm{SI}$, is a logarithmic measure of the departure from equilibrium, defined as $\\mathrm{SI} = \\log_{10}(Q/K)$.\n- If $\\mathrm{SI} > 0$, the solution is supersaturated, and the mineral is thermodynamically favored to precipitate.\n- If $\\mathrm{SI} < 0$, the solution is undersaturated, and the mineral is favored to dissolve.\n- If $\\mathrm{SI} = 0$, the system is at equilibrium.\n\nThe two mineral reactions under consideration are:\n1.  Mineral $M_1$: $C^{2+} + B^{2-} \\rightleftharpoons CB(s)$. The saturation index is:\n    $$\n    \\mathrm{SI}_1 = \\log_{10}\\left(\\frac{Q_1}{K_1}\\right) = \\log_{10}\\left(\\frac{a_{C^{2+}} a_{B^{2-}}}{K_1}\\right)\n    $$\n    with the problem specifying $\\log_{10} K_1 = -8.48$.\n\n2.  Mineral $M_2$: $C^{2+} + 2A^- \\rightleftharpoons CA_2(s)$. The saturation index is:\n    $$\n    \\mathrm{SI}_2 = \\log_{10}\\left(\\frac{Q_2}{K_2}\\right) = \\log_{10}\\left(\\frac{a_{C^{2+}} a_{A^-}^2}{K_2}\\right)\n    $$\n    with the problem specifying $\\log_{10} K_2 = -10.45$.\n\nThe activity $a_i$ of an ion $i$ is related to its molality $m_i$ (concentration in $\\mathrm{mol/kg}$) through the activity coefficient, $\\gamma_i$, as $a_i = \\gamma_i m_i$. Activity coefficients account for non-ideal behavior in electrolyte solutions and are themselves functions of the total ionic strength of the solution.\n\nThe ionic strength, $I$, is defined as:\n$$\nI = \\frac{1}{2}\\sum_i m_i z_i^2\n$$\nwhere $z_i$ is the integer charge of ion $i$.\n\nThe activity coefficient $\\gamma_i$ for each ion is calculated using the Davies equation, an empirical extension of the Debye-Hückel theory, valid at $25\\,^\\circ\\mathrm{C}$ for moderate ionic strengths:\n$$\n\\log_{10}\\gamma_i = -A z_i^2\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right)\n$$\nwhere $A$ is the Debye-Hückel constant, given as $0.509$.\n\n**2. The Iterative Solution for Self-Consistency**\n\nA computational challenge arises because $a_i$ and $m_i$ are interdependent. To find $m_{A^-}$ and $m_{B^{2-}}$ from their target activities $a_{A^-}$ and $a_{B^{2-}}$, we need $\\gamma_{A^-}$ and $\\gamma_{B^{2-}}$. However, these activity coefficients depend on the ionic strength $I$, which in turn depends on the molalities of all ions in solution, including the unknown $m_{A^-}$ and $m_{B^{2-}}$. This circular dependency necessitates a fixed-point iterative approach to find a self-consistent solution for the ionic strength $I$.\n\nThe algorithm for a single grid point, defined by target activities $a_{A^-}$ and $a_{B^{2-}}$ and fixed molalities $m_{C^{2+}}$, $m_{\\mathrm{Na}^+}$, and $m_{\\mathrm{Cl}^-}$, proceeds as follows:\n\n1.  **Initialization ($k=0$):** An initial estimate of the ionic strength, $I^{(0)}$, is calculated considering only the ions with known molalities:\n    $$\n    I^{(0)} = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} z_{\\mathrm{Na}^+}^2 + m_{\\mathrm{Cl}^-} z_{\\mathrm{Cl}^-}^2 + m_{C^{2+}} z_{C^{2+}}^2\\right) = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} (1)^2 + m_{\\mathrm{Cl}^-} (-1)^2 + m_{C^{2+}} (2)^2\\right) = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}}\\right)\n    $$\n\n2.  **Iteration ($k \\to k+1$):** The loop proceeds until convergence or a maximum number of iterations, $k_{\\max} = 100$, is reached.\n    a.  Given the current estimate $I^{(k)}$, calculate the activity coefficients $\\gamma_{A^-}^{(k)}$ and $\\gamma_{B^{2-}}^{(k)}$ using the Davies equation.\n    b.  Update the molalities of ions $A^-$ and $B^{2-}$ using the target activities:\n        $$\n        m_{A^-}^{(k)} = \\frac{a_{A^-}}{\\gamma_{A^-}^{(k)}} \\quad \\text{and} \\quad m_{B^{2-}}^{(k)} = \\frac{a_{B^{2-}}}{\\gamma_{B^{2-}}^{(k)}}\n        $$\n    c.  Calculate the next estimate of the ionic strength, $I^{(k+1)}$, including the contributions from the newly calculated molalities:\n        $$\n        I^{(k+1)} = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}} + m_{A^-}^{(k)} z_{A^-}^2 + m_{B^{2-}}^{(k)} z_{B^{2-}}^2 \\right) = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}} + m_{A^-}^{(k)} + 4 m_{B^{2-}}^{(k)}\\right)\n        $$\n\n3.  **Convergence Check:** The iteration continues until the absolute difference between successive ionic strength values is less than a tolerance $\\varepsilon = 10^{-12}$:\n    $$\n    \\left| I^{(k+1)} - I^{(k)} \\right| < \\varepsilon\n    $$\n\n**3. Grid Processing and Classification**\n\nOnce the iterative process converges to a final ionic strength $I$, the remaining calculations are performed:\n1.  The final activity coefficient for the cation, $\\gamma_{C^{2+}}$, is computed using the converged $I$.\n2.  The activity of the cation is found: $a_{C^{2+}} = \\gamma_{C^{2+}} m_{C^{2+}}$.\n3.  The saturation indices $\\mathrm{SI}_1$ and $\\mathrm{SI}_2$ are calculated using the known activities $a_{A^-}$, $a_{B^{2-}}$, the calculated $a_{C^{2+}}$, and the given equilibrium constants $K_1=10^{-8.48}$ and $K_2=10^{-10.45}$. This is most efficiently done in logarithmic space:\n    $$\n    \\mathrm{SI}_1 = \\log_{10}(a_{C^{2+}}) + \\log_{10}(a_{B^{2-}}) - \\log_{10}(K_1)\n    $$\n    $$\n    \\mathrm{SI}_2 = \\log_{10}(a_{C^{2+}}) + 2\\log_{10}(a_{A^-}) - \\log_{10}(K_2)\n    $$\n4.  Each grid point is classified based on the values of $\\mathrm{SI}_1$ and $\\mathrm{SI}_2$ according to the specified rules:\n    - $M_1$ stable: $\\mathrm{SI}_1 > 0$ and $\\mathrm{SI}_2 \\le 0$.\n    - $M_2$ stable: $\\mathrm{SI}_2 > 0$ and $\\mathrm{SI}_1 \\le 0$.\n    - Both supersaturated ($ \\mathrm{SI}_1 > 0, \\mathrm{SI}_2 > 0 $): The mineral with the larger $\\mathrm{SI}$ is dominant. If $\\mathrm{SI}_1 = \\mathrm{SI}_2$, $M_1$ is chosen.\n    - Neither stable ($\\mathrm{SI}_1 \\le 0, \\mathrm{SI}_2 \\le 0$): Solution is undersaturated with respect to both minerals.\n\nThis entire procedure is applied to each point on a grid defined by the ranges and step sizes for $\\log_{10} a_{A^-}$ and $\\log_{10} a_{B^{2-}}$. The final output aggregates the counts of each stability class, reports on the convergence success across the entire grid, and provides the maximum number of iterations required for any point. This systematic approach ensures a correct and robust construction of the activity-activity diagram.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the geochemical simulations for all test cases.\n    \"\"\"\n    \n    # Define constants from the problem statement.\n    A_DAVIES = 0.509\n    LOG10_K1 = -8.48\n    LOG10_K2 = -10.45\n    EPSILON = 1.0e-12\n    K_MAX = 100\n\n    # Charges of the ions\n    Z_A = -1\n    Z_B = -2\n    Z_C = 2\n    Z_NA = 1\n    Z_CL = -1\n\n    def davies_log10_gamma(z, I, A):\n        \"\"\"\n        Calculates the log10 of the activity coefficient using the Davies equation.\n        Returns log10(gamma).\n        \"\"\"\n        if I < 0:\n            # Ionic strength cannot be negative, may happen due to numerical noise with very small molalities.\n            # Treat as zero in this edge case.\n            I = 0.0\n        \n        sqrt_I = np.sqrt(I)\n        log10_g = -A * (z**2) * ( (sqrt_I / (1.0 + sqrt_I)) - 0.3 * I )\n        return log10_g\n\n    def process_grid_point(log10_a_A, log10_a_B, m_C, m_Na, m_Cl):\n        \"\"\"\n        Performs the iterative calculation for a single grid point.\n        \"\"\"\n        a_A = 10**log10_a_A\n        a_B = 10**log10_a_B\n\n        # 1. Initialize ionic strength I^(0)\n        I = 0.5 * (m_Na * Z_NA**2 + m_Cl * Z_CL**2 + m_C * Z_C**2)\n        \n        converged = False\n        k = 0\n        for k in range(K_MAX):\n            # 2. Compute activity coefficients from I^(k)\n            log10_gamma_A = davies_log10_gamma(Z_A, I, A_DAVIES)\n            gamma_A = 10**log10_gamma_A\n            \n            log10_gamma_B = davies_log10_gamma(Z_B, I, A_DAVIES)\n            gamma_B = 10**log10_gamma_B\n\n            # 3. Update molalities and ionic strength I^(k+1)\n            m_A = a_A / gamma_A\n            m_B = a_B / gamma_B\n            \n            I_next = 0.5 * (m_Na*Z_NA**2 + m_Cl*Z_CL**2 + m_C*Z_C**2 + m_A*Z_A**2 + m_B*Z_B**2)\n\n            # 4. Check for convergence\n            if abs(I_next - I) < EPSILON:\n                converged = True\n                I = I_next\n                break\n            \n            I = I_next\n        \n        num_iterations = k + 1\n\n        # At converged I, calculate final activities and SIs\n        log10_gamma_C = davies_log10_gamma(Z_C, I, A_DAVIES)\n        gamma_C = 10**log10_gamma_C\n        a_C = gamma_C * m_C\n        log10_a_C = np.log10(a_C)\n\n        # Calculate Saturation Indices\n        SI1 = log10_a_C + log10_a_B - LOG10_K1\n        SI2 = log10_a_C + 2 * log10_a_A - LOG10_K2\n\n        # Classify stability\n        classification = \"none\"\n        if SI1 > 0 and SI2 > 0:\n            if SI1 >= SI2:\n                classification = \"M1\"\n            else:\n                classification = \"M2\"\n        elif SI1 > 0:\n            classification = \"M1\"\n        elif SI2 > 0:\n            classification = \"M2\"\n\n        return classification, converged, num_iterations\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (log10_a_A_min, log10_a_A_max, delta_A, log10_a_B_min, log10_a_B_max, delta_B, m_C, m_Na, m_Cl)\n        (-6.0, -3.0, 1.0, -10.0, -6.0, 1.0, 1e-3, 0.0, 0.0),\n        (-7.0, -5.0, 1.0, -9.0, -7.0, 1.0, 3e-4, 5e-3, 5e-3),\n        (-8.0, -4.0, 2.0, -9.0, -5.0, 2.0, 1e-4, 1e-1, 1e-1),\n    ]\n\n    final_results = []\n    for case in test_cases:\n        log10_a_A_min, log10_a_A_max, delta_A, log10_a_B_min, log10_a_B_max, delta_B, m_C, m_Na, m_Cl = case\n\n        # Generate grid points\n        # Add a small epsilon to max to ensure endpoint inclusion with np.arange\n        log_a_A_range = np.arange(log10_a_A_min, log10_a_A_max + delta_A / 2, delta_A)\n        log_a_B_range = np.arange(log10_a_B_min, log10_a_B_max + delta_B / 2, delta_B)\n\n        # Initialize counters and diagnostics\n        n_M1, n_M2, n_none = 0, 0, 0\n        all_converged = True\n        max_iter_used = 0\n\n        for log10_a_A in log_a_A_range:\n            for log10_a_B in log_a_B_range:\n                classification, converged, num_iters = process_grid_point(log10_a_A, log10_a_B, m_C, m_Na, m_Cl)\n                \n                if classification == \"M1\":\n                    n_M1 += 1\n                elif classification == \"M2\":\n                    n_M2 += 1\n                else:\n                    n_none += 1\n\n                if not converged:\n                    all_converged = False\n                \n                if num_iters > max_iter_used:\n                    max_iter_used = num_iters\n\n        result_list = [n_M1, n_M2, n_none, all_converged, max_iter_used]\n        final_results.append(result_list)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}