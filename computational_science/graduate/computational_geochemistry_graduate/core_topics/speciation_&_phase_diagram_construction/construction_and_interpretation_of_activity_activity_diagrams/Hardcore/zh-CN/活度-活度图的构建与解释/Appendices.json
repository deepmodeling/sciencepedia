{
    "hands_on_practices": [
        {
            "introduction": "活度-活度图是地球化学中可视化矿物稳定性的强大工具。理解这些图的第一步是掌握饱和度指数（$SI$）的计算，它是衡量矿物相对于水溶液是倾向于溶解还是沉淀的关键指标。本练习旨在通过沿活度空间中的一条特定路径计算 $SI$，来巩固您的基础计算技能 。这项实践将帮助您把抽象的活度值转化为对矿物行为（欠饱和、平衡、过饱和）的具体预测。",
            "id": "4073953",
            "problem": "微溶碳酸盐的水地球化学平衡可以用活度-活度图表示，其坐标轴是离子活度的以10为底的对数。考虑在恒定温度下与水溶液接触的两种碳酸盐矿物：方解石和白云石。以自由离子表示的溶解反应为\n$$\\text{方解石:}\\quad \\text{CaCO}_{3}(\\text{s}) \\rightleftharpoons \\text{Ca}^{2+} + \\text{CO}_{3}^{2-},$$\n$$\\text{白云石:}\\quad \\text{CaMg}(\\text{CO}_{3})_{2}(\\text{s}) \\rightleftharpoons \\text{Ca}^{2+} + \\text{Mg}^{2+} + 2\\,\\text{CO}_{3}^{2-}.$$\n假设在所述温度下，方解石反应的平衡常数满足 $\\log_{10} K_{\\text{calcite}} = -8.48$，白云石反应的平衡常数满足 $\\log_{10} K_{\\text{dolomite}} = -17.09$。$\\text{Ca}^{2+}$ 和 $\\text{CO}_{3}^{2-}$ 的活度在由 $t \\in [0,4]$ 参数化的 $\\log a_{\\text{Ca}^{2+}}$–$\\log a_{\\text{CO}_{3}^{2-}}$ 空间中沿一条直线段变化：\n$$\\log_{10} a_{\\text{Ca}^{2+}}(t) = -4 + 0.5\\,t,\\qquad \\log_{10} a_{\\text{CO}_{3}^{2-}}(t) = -9 + t.$$\n假设 $\\text{Mg}^{2+}$ 的活度沿线段保持恒定，其值为 $\\log_{10} a_{\\text{Mg}^{2+}} = -3$。使用这些溶解反应的质量作用定律和饱和指数 (SI) 的定义 $\\text{SI} = \\log_{10}(\\text{IAP}/K)$，其中离子活度积 (IAP) 是活度乘以其化学计量系数的幂的乘积，来：\n1. 推导沿线段的 $\\text{SI}_{\\text{calcite}}(t)$ 和 $\\text{SI}_{\\text{dolomite}}(t)$ 的显式表达式。\n2. 确定在 $t \\in [0,4]$ 区间内，每种矿物从不饱和状态过渡到过饱和状态的参数 $t$ 值。\n3. 确定两种矿物同时处于过饱和状态的线段子集，并计算该子集长度占总线段长度的比例。\n\n将最终比例报告为无量纲小数。将您的答案四舍五入到四位有效数字。",
            "solution": "用户希望我解决这个问题，所以我的第一步是验证它。\n\n### 第1步：提取已知条件\n问题陈述中给出的条件如下：\n- 方解石溶解反应：$\\text{CaCO}_{3}(\\text{s}) \\rightleftharpoons \\text{Ca}^{2+} + \\text{CO}_{3}^{2-}$\n- 白云石溶解反应：$\\text{CaMg}(\\text{CO}_{3})_{2}(\\text{s}) \\rightleftharpoons \\text{Ca}^{2+} + \\text{Mg}^{2+} + 2\\,\\text{CO}_{3}^{2-}$\n- 方解石的平衡常数：$\\log_{10} K_{\\text{calcite}} = -8.48$\n- 白云石的平衡常数：$\\log_{10} K_{\\text{dolomite}} = -17.09$\n- 沿由 $t \\in [0,4]$ 参数化的线段的 $\\text{Ca}^{2+}$ 活度：$\\log_{10} a_{\\text{Ca}^{2+}}(t) = -4 + 0.5\\,t$\n- 沿同一线段的 $\\text{CO}_{3}^{2-}$ 活度：$\\log_{10} a_{\\text{CO}_{3}^{2-}}(t) = -9 + t$\n- $\\text{Mg}^{2+}$ 的活度是恒定的：$\\log_{10} a_{\\text{Mg}^{2+}} = -3$\n- 离子活度积 (IAP) 的定义：活度的乘积，每个活度都提升到其化学计量系数的幂。\n- 饱和指数 (SI) 的定义：$\\text{SI} = \\log_{10}(\\text{IAP}/K)$\n\n### 第2步：使用提取的已知条件进行验证\n根据提取的信息评估问题的有效性。\n- **科学依据：** 该问题基于水地球化学的基本原理，特别是质量作用定律、矿物溶解的化学平衡以及离子活度积 (IAP) 和饱和指数 (SI) 的定义。这些是地球化学模型中使用的标准概念。所提供的方解石和白云石反应是正确的，平衡常数的对数值在标准条件下是现实的。\n- **良态性：** 该问题是良态的。它提供了计算所需量的所有必要数据和定义。活度的参数化为找到解决方案提供了清晰的数学路径。问题明确无歧义，并能导向唯一的数值答案。\n- **客观性：** 该问题以精确、客观和科学的语言陈述。它没有主观性、模糊性或个人观点。\n\n### 第3步：结论与行动\n该问题科学合理、良态且客观。它不包含任何使其无效的缺陷。因此，该问题是**有效的**。我将继续提供完整的解决方案。\n\n### 解\n\n根据问题陈述的要求，解决方案分三部分进行。\n\n**1. 推导SI表达式**\n\n饱和指数 (SI) 定义为 $\\text{SI} = \\log_{10}(\\text{IAP}/K)$，可以写成 $\\text{SI} = \\log_{10}(\\text{IAP}) - \\log_{10}(K)$。离子活度积 (IAP) 是水溶液中各物种活度的乘积，每个活度都提升到其在溶解反应中化学计量系数的幂。\n\n对于方解石，溶解反应为 $\\text{CaCO}_{3}(\\text{s}) \\rightleftharpoons \\text{Ca}^{2+} + \\text{CO}_{3}^{2-}$。\n方解石的IAP为 $\\text{IAP}_{\\text{calcite}} = a_{\\text{Ca}^{2+}} a_{\\text{CO}_{3}^{2-}}$。\n取以10为底的对数：\n$$ \\log_{10}(\\text{IAP}_{\\text{calcite}}) = \\log_{10}(a_{\\text{Ca}^{2+}}) + \\log_{10}(a_{\\text{CO}_{3}^{2-}}) $$\n代入给定的关于 $t$ 的参数化活度表达式：\n$$ \\log_{10}(\\text{IAP}_{\\text{calcite}}(t)) = (-4 + 0.5t) + (-9 + t) = 1.5t - 13 $$\n现在，我们可以找到 $\\text{SI}_{\\text{calcite}}(t)$ 的表达式：\n$$ \\text{SI}_{\\text{calcite}}(t) = \\log_{10}(\\text{IAP}_{\\text{calcite}}(t)) - \\log_{10}(K_{\\text{calcite}}) $$\n$$ \\text{SI}_{\\text{calcite}}(t) = (1.5t - 13) - (-8.48) = 1.5t - 4.52 $$\n\n对于白云石，溶解反应为 $\\text{CaMg}(\\text{CO}_{3})_{2}(\\text{s}) \\rightleftharpoons \\text{Ca}^{2+} + \\text{Mg}^{2+} + 2\\,\\text{CO}_{3}^{2-}$。\n白云石的IAP为 $\\text{IAP}_{\\text{dolomite}} = a_{\\text{Ca}^{2+}} a_{\\text{Mg}^{2+}} (a_{\\text{CO}_{3}^{2-}})^{2}$。\n取以10为底的对数：\n$$ \\log_{10}(\\text{IAP}_{\\text{dolomite}}) = \\log_{10}(a_{\\text{Ca}^{2+}}) + \\log_{10}(a_{\\text{Mg}^{2+}}) + 2\\log_{10}(a_{\\text{CO}_{3}^{2-}}) $$\n代入给定的参数化和恒定活度表达式：\n$$ \\log_{10}(\\text{IAP}_{\\text{dolomite}}(t)) = (-4 + 0.5t) + (-3) + 2(-9 + t) $$\n$$ \\log_{10}(\\text{IAP}_{\\text{dolomite}}(t)) = -4 + 0.5t - 3 - 18 + 2t = 2.5t - 25 $$\n现在，我们可以找到 $\\text{SI}_{\\text{dolomite}}(t)$ 的表达式：\n$$ \\text{SI}_{\\text{dolomite}}(t) = \\log_{10}(\\text{IAP}_{\\text{dolomite}}(t)) - \\log_{10}(K_{\\text{dolomite}}) $$\n$$ \\text{SI}_{\\text{dolomite}}(t) = (2.5t - 25) - (-17.09) = 2.5t - 7.91 $$\n\n显式表达式为 $\\text{SI}_{\\text{calcite}}(t) = 1.5t - 4.52$ 和 $\\text{SI}_{\\text{dolomite}}(t) = 2.5t - 7.91$。\n\n**2. 确定过渡点**\n\n矿物从不饱和 ($\\text{SI}  0$) 过渡到过饱和 ($\\text{SI} > 0$) 的点是平衡点，此时 $\\text{SI} = 0$。我们需要找到每种矿物发生此过渡时的参数 $t$ 值。\n\n对于方解石，我们设置 $\\text{SI}_{\\text{calcite}}(t) = 0$：\n$$ 1.5t - 4.52 = 0 $$\n$$ 1.5t = 4.52 $$\n$$ t_{\\text{calcite}} = \\frac{4.52}{1.5} = \\frac{9.04}{3} \\approx 3.0133 $$\n由于 $0 \\le t_{\\text{calcite}} \\le 4$，此过渡发生在指定的线段内。\n\n对于白云石，我们设置 $\\text{SI}_{\\text{dolomite}}(t) = 0$：\n$$ 2.5t - 7.91 = 0 $$\n$$ 2.5t = 7.91 $$\n$$ t_{\\text{dolomite}} = \\frac{7.91}{2.5} = \\frac{15.82}{5} = 3.164 $$\n由于 $0 \\le t_{\\text{dolomite}} \\le 4$，此过渡也发生在线段内。\n\n**3. 确定同时过饱和区域及长度比例**\n\n当矿物的饱和指数大于零 ($\\text{SI} > 0$) 时，该矿物处于过饱和状态。\n\n方解石过饱和的条件：\n$$ \\text{SI}_{\\text{calcite}}(t) > 0 \\implies 1.5t - 4.52 > 0 \\implies t > \\frac{4.52}{1.5} \\approx 3.0133 $$\n方解石过饱和的区间是 $(t_{\\text{calcite}}, 4]$。\n\n白云石过饱和的条件：\n$$ \\text{SI}_{\\text{dolomite}}(t) > 0 \\implies 2.5t - 7.91 > 0 \\implies t > \\frac{7.91}{2.5} = 3.164 $$\n白云石过饱和的区间是 $(t_{\\text{dolomite}}, 4]$。\n\n当 $t$ 位于这两个区间的交集时，两种矿物同时过饱和。由于 $t_{\\text{dolomite}} = 3.164$ 大于 $t_{\\text{calcite}} \\approx 3.0133$，交集由较大的下界决定。\n同时过饱和的区间是 $(3.164, 4]$。\n\n该区间的长度为 $L_{\\text{super}} = 4 - 3.164 = 0.836$。\n线段的总长度对于 $t \\in [0, 4]$，所以其长度为 $L_{\\text{total}} = 4 - 0 = 4$。\n\n两种矿物同时过饱和的线段长度占总线段长度的比例为：\n$$ f = \\frac{L_{\\text{super}}}{L_{\\text{total}}} = \\frac{0.836}{4} = 0.209 $$\n四舍五入到四位有效数字，该比例为 $0.2090$。",
            "answer": "$$\\boxed{0.2090}$$"
        },
        {
            "introduction": "在掌握了点态的饱和度计算后，下一步是理解如何定义整个矿物稳定场的边界。活度-活度图由一系列线条构成，每一条线都代表特定矿物相与水溶液达到平衡的条件。本练习将引导您从质量作用定律出发，推导这些平衡边界的方程，并求解它们的交点 。这些交点在地球化学上具有重要意义，通常代表多个矿物可以共存的“三相点”。",
            "id": "4073982",
            "problem": "考虑一个水体系，温度 $T = 25\\,^{\\circ}\\mathrm{C}$，压力 $P = 1\\,\\mathrm{bar}$，溶质呈理想行为，纯固体的标准态活度 ($a$) 等于 $1$。碳酸根的水溶液活度固定为 $a_{\\mathrm{CO_3^{2-}}} = 10^{-3}$。您将构建并解释一个以 $X = \\log_{10} a_{\\mathrm{Ca^{2+}}}$ 和 $Y = \\log_{10} a_{\\mathrm{Mg^{2+}}}$ 为坐标轴的活度-活度图。\n\n考虑三种碳酸盐矿物：方解石 $\\mathrm{CaCO_3(s)}$、菱镁矿 $\\mathrm{MgCO_3(s)}$ 和白云石 $\\mathrm{CaMg(CO_3)_2(s)}$。在所述条件下，采用热力学一致的溶解反应的以10为底的平衡常数：\n- $\\mathrm{CaCO_3(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_3^{2-}}$，其中 $\\log_{10} K_{\\mathrm{cal}} = -8.48$，\n- $\\mathrm{MgCO_3(s)} \\rightleftharpoons \\mathrm{Mg^{2+}} + \\mathrm{CO_3^{2-}}$，其中 $\\log_{10} K_{\\mathrm{mag}} = -8.60$，\n- $\\mathrm{CaMg(CO_3)_2(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{Mg^{2+}} + 2\\,\\mathrm{CO_3^{2-}}$，其中 $\\log_{10} K_{\\mathrm{dol}} = -17.08$。\n\n您必须使用的基本依据是平衡常数定义 $K = \\prod_{i} a_{i}^{\\nu_{i}}$，该反应以产物活度 $a_{i}$ 的化学计量系数 $\\nu_{i}$ 次方表示，且纯固体活度等于 $1$。此外，为解释边界，请使用饱和指数 (SI) 的定义 $\\mathrm{SI} = \\log_{10}(\\mathrm{IAP}/K)$，其中 $\\mathrm{IAP}$ 是离子活度积。\n\n任务：\n1. 从平衡常数定义和固定的 $a_{\\mathrm{CO_3^{2-}}}$ 出发，推导出在 $\\log_{10} a_{\\mathrm{Ca^{2+}}}$–$\\log_{10} a_{\\mathrm{Mg^{2+}}}$ 平面中，对应于白云石与溶液平衡的线性边界。然后，使用饱和指数定义，推导出方解石和菱镁矿具有相等饱和度（即 $\\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}}$）的线性边界。\n2. 求解同时满足上述两个推导出的线性边界的唯一交点 $(\\log_{10} a_{\\mathrm{Ca^{2+}}}, \\log_{10} a_{\\mathrm{Mg^{2+}}})$。\n3. 基于您获得的交点，确定在该点能与水溶液平衡共存的矿物组合，并根据饱和指数简要说明理由。\n\n最终答案中的 $\\log_{10} a_{\\mathrm{Ca^{2+}}}$ 和 $\\log_{10} a_{\\mathrm{Mg^{2+}}}$ 数值表示为四舍五入到四位有效数字。活度是无量纲的，因此最终数值不需要物理单位。",
            "solution": "该问题定义明确，具有科学依据，并提供了所有必要的信息和定义以便进行解答。这是一个涉及活度-活度图构建与解释的计算地球化学标准问题。该问题是有效的。\n\n活度-活度图构建于一个以 $X = \\log_{10} a_{\\mathrm{Ca^{2+}}}$ 和 $Y = \\log_{10} a_{\\mathrm{Mg^{2+}}}$ 为坐标轴的平面上。分析在固定温度 $T = 25\\,^{\\circ}\\mathrm{C}$、压力 $P = 1\\,\\mathrm{bar}$ 和碳酸根水溶液活度 $a_{\\mathrm{CO_3^{2-}}} = 10^{-3}$ 的条件下进行。\n\n### 任务1：线性边界的推导\n\n首先，我们推导对应于水溶液与固态白云石 $\\mathrm{CaMg(CO_3)_2(s)}$ 之间平衡的线性边界。溶解反应为：\n$$ \\mathrm{CaMg(CO_3)_2(s)} \\rightleftharpoons \\mathrm{Ca^{2+}(aq)} + \\mathrm{Mg^{2+}(aq)} + 2\\,\\mathrm{CO_3^{2-}(aq)} $$\n平衡常数 $K_{\\mathrm{dol}}$ 由质量作用定律定义。鉴于纯固体的活度为 $1$，表达式为：\n$$ K_{\\mathrm{dol}} = a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{Mg^{2+}}} a_{\\mathrm{CO_3^{2-}}}^{2} $$\n对两边取以10为底的对数，得到：\n$$ \\log_{10} K_{\\mathrm{dol}} = \\log_{10} (a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{Mg^{2+}}} a_{\\mathrm{CO_3^{2-}}}^{2}) $$\n利用对数的性质，我们展开右侧：\n$$ \\log_{10} K_{\\mathrm{dol}} = \\log_{10} a_{\\mathrm{Ca^{2+}}} + \\log_{10} a_{\\mathrm{Mg^{2+}}} + 2 \\log_{10} a_{\\mathrm{CO_3^{2-}}} $$\n代入定义的坐标轴 $X = \\log_{10} a_{\\mathrm{Ca^{2+}}}$ 和 $Y = \\log_{10} a_{\\mathrm{Mg^{2+}}}$，我们得到：\n$$ \\log_{10} K_{\\mathrm{dol}} = X + Y + 2 \\log_{10} a_{\\mathrm{CO_3^{2-}}} $$\n给定 $\\log_{10} K_{\\mathrm{dol}} = -17.08$ 和 $a_{\\mathrm{CO_3^{2-}}} = 10^{-3}$，这意味着 $\\log_{10} a_{\\mathrm{CO_3^{2-}}} = -3$。代入这些值：\n$$ -17.08 = X + Y + 2(-3) $$\n$$ -17.08 = X + Y - 6 $$\n这简化为白云石稳定边界的第一个线性方程：\n$$ X + Y = -11.08 \\quad (\\text{方程 1}) $$\n\n其次，我们推导方解石 $\\mathrm{CaCO_3(s)}$ 和菱镁矿 $\\mathrm{MgCO_3(s)}$ 具有相等饱和指数的线性边界。条件是 $\\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}}$。根据饱和指数的定义 $\\mathrm{SI} = \\log_{10}(\\mathrm{IAP}/K)$，该条件意味着：\n$$ \\log_{10}(\\mathrm{IAP}_{\\mathrm{cal}}/K_{\\mathrm{cal}}) = \\log_{10}(\\mathrm{IAP}_{\\mathrm{mag}}/K_{\\mathrm{mag}}) $$\n$$ \\frac{\\mathrm{IAP}_{\\mathrm{cal}}}{K_{\\mathrm{cal}}} = \\frac{\\mathrm{IAP}_{\\mathrm{mag}}}{K_{\\mathrm{mag}}} $$\n其中 $\\mathrm{IAP}_{\\mathrm{cal}} = a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}}$ 且 $\\mathrm{IAP}_{\\mathrm{mag}} = a_{\\mathrm{Mg^{2+}}} a_{\\mathrm{CO_3^{2-}}}$。代入这些表达式：\n$$ \\frac{a_{\\mathrm{Ca^{2+}}} a_{\\mathrm{CO_3^{2-}}}}{K_{\\mathrm{cal}}} = \\frac{a_{\\mathrm{Mg^{2+}}} a_{\\mathrm{CO_3^{2-}}}}{K_{\\mathrm{mag}}} $$\n由于碳酸根活度 $a_{\\mathrm{CO_3^{2-}}}$ 是固定的且非零，可以从两边消去：\n$$ \\frac{a_{\\mathrm{Ca^{2+}}}}{K_{\\mathrm{cal}}} = \\frac{a_{\\mathrm{Mg^{2+}}}}{K_{\\mathrm{mag}}} $$\n对整个方程取以10为底的对数：\n$$ \\log_{10} a_{\\mathrm{Ca^{2+}}} - \\log_{10} K_{\\mathrm{cal}} = \\log_{10} a_{\\mathrm{Mg^{2+}}} - \\log_{10} K_{\\mathrm{mag}} $$\n代入 $X = \\log_{10} a_{\\mathrm{Ca^{2+}}}$ 和 $Y = \\log_{10} a_{\\mathrm{Mg^{2+}}}$：\n$$ X - \\log_{10} K_{\\mathrm{cal}} = Y - \\log_{10} K_{\\mathrm{mag}} $$\n整理变量 $X$ 和 $Y$：\n$$ X - Y = \\log_{10} K_{\\mathrm{cal}} - \\log_{10} K_{\\mathrm{mag}} $$\n给定 $\\log_{10} K_{\\mathrm{cal}} = -8.48$ 和 $\\log_{10} K_{\\mathrm{mag}} = -8.60$。代入这些值：\n$$ X - Y = -8.48 - (-8.60) = -8.48 + 8.60 $$\n这给出第二个线性方程：\n$$ X - Y = 0.12 \\quad (\\text{方程 2}) $$\n\n### 任务2：交点的计算\n\n交点 $(\\log_{10} a_{\\mathrm{Ca^{2+}}}, \\log_{10} a_{\\mathrm{Mg^{2+}}}) = (X, Y)$ 可通过求解上面推导出的两个线性方程组来找到：\n1. $X + Y = -11.08$\n2. $X - Y = 0.12$\n\n我们可以通过将两个方程相加来消去 $Y$ 来求解这个方程组：\n$$ (X + Y) + (X - Y) = -11.08 + 0.12 $$\n$$ 2X = -10.96 $$\n$$ X = -\\frac{10.96}{2} = -5.48 $$\n现在，将 $X$ 的值代回方程1以求出 $Y$：\n$$ -5.48 + Y = -11.08 $$\n$$ Y = -11.08 + 5.48 = -5.60 $$\n因此，交点是 $(X, Y) = (-5.48, -5.60)$。这对应于活度 $\\log_{10} a_{\\mathrm{Ca^{2+}}} = -5.48$ 和 $\\log_{10} a_{\\mathrm{Mg^{2+}}} = -5.60$。\n\n### 任务3：矿物组合的确定与论证\n\n根据构造，计算出的交点是活度图中的一个点，在该点上同时满足两个条件：\n1.  溶液与白云石处于平衡状态。这意味着白云石的饱和指数为零，即 $\\mathrm{SI}_{\\mathrm{dol}} = \\log_{10}(\\mathrm{IAP}_{\\mathrm{dol}}/K_{\\mathrm{dol}}) = 0$。\n2.  方解石和菱镁矿的饱和指数相等：$\\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}}$。\n\n我们必须在该点评估方解石（以及菱镁矿）的饱和指数，以确定它们是否也处于平衡状态。方解石的饱和指数为：\n$$ \\mathrm{SI}_{\\mathrm{cal}} = \\log_{10} a_{\\mathrm{Ca^{2+}}} + \\log_{10} a_{\\mathrm{CO_3^{2-}}} - \\log_{10} K_{\\mathrm{cal}} $$\n代入交点处的值：$\\log_{10} a_{\\mathrm{Ca^{2+}}} = -5.48$，$\\log_{10} a_{\\mathrm{CO_3^{2-}}} = -3$，以及 $\\log_{10} K_{\\mathrm{cal}} = -8.48$：\n$$ \\mathrm{SI}_{\\mathrm{cal}} = -5.48 + (-3) - (-8.48) = -8.48 + 8.48 = 0 $$\n$\\mathrm{SI}_{\\mathrm{cal}} = 0$ 表示溶液也与方解石处于平衡状态。\n由于在交点处满足 $\\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}}$ 且我们已计算出 $\\mathrm{SI}_{\\mathrm{cal}} = 0$，因此必然有 $\\mathrm{SI}_{\\mathrm{mag}} = 0$。这可以独立验证：\n$$ \\mathrm{SI}_{\\mathrm{mag}} = \\log_{10} a_{\\mathrm{Mg^{2+}}} + \\log_{10} a_{\\mathrm{CO_3^{2-}}} - \\log_{10} K_{\\mathrm{mag}} $$\n$$ \\mathrm{SI}_{\\mathrm{mag}} = -5.60 + (-3) - (-8.60) = -8.60 + 8.60 = 0 $$\n所以，$\\mathrm{SI}_{\\mathrm{mag}} = 0$ 也成立。\n\n在这个独特的点上，所有三种矿物的饱和指数都等于 $0$：\n$$ \\mathrm{SI}_{\\mathrm{cal}} = \\mathrm{SI}_{\\mathrm{mag}} = \\mathrm{SI}_{\\mathrm{dol}} = 0 $$\n这意味着水溶液同时与所有三种固相处于平衡状态。因此，在该点能与水溶液平衡共存的矿物组合是方解石、菱镁矿和白云石。该点是此系统活度图中的一个三相点。\n\n交点坐标的最终数值答案，四舍五入到四位有效数字，是 $\\log_{10} a_{\\mathrm{Ca^{2+}}} = -5.480$ 和 $\\log_{10} a_{\\mathrm{Mg^{2+}}} = -5.600$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-5.480  -5.600\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论计算与实际的地球化学模拟之间存在一道鸿沟，而本练习旨在帮助您跨越它。精确构建活度-活度图需要考虑离子在溶液中的非理想行为，其中活度系数是离子强度的函数，而离子强度又反过来依赖于各离子的浓度。本项高级实践将指导您设计一个迭代算法，以自洽的方式求解活度与浓度之间的复杂关系，最终生成一个完整的、考虑了非理想效应的矿物稳定性图，这是计算地球化学中的一项核心技能 。",
            "id": "4073962",
            "problem": "您的任务是构建一个计算框架，用于绘制一个地球化学体系中的活度-活度图。该体系包含两种水溶液阴离子和一种水溶液阳离子，它们可能沉淀出两种不同的矿物。该程序必须实现一种基于网格的方法，评估反应商与平衡常数的比值，并且必须包含活度系数的迭代更新，直至收敛，以确保在不同离子强度下的稳健性。重点在于从第一性原理进行清晰的推导，并设计一个数值稳定的算法。\n\n从以下基本原理开始：\n\n- 平衡的质量作用定律指出，对于一个化学计量系数为 $\\nu_i$ 的通用反应，反应商为 $Q = \\prod_i a_i^{\\nu_i}$，在平衡时 $Q = K$，其中 $K$ 是平衡常数。比值 $Q/K$ 可作为无量纲的饱和度指标。\n- 活度 $a_i$ 的定义为 $a_i = \\gamma_i m_i$，其中 $\\gamma_i$ 是活度系数，$m_i$ 是质量摩尔浓度（单位为 $\\mathrm{mol/kg}$；在稀溶液极限下，可以类似地处理体积摩尔浓度，单位为 $\\mathrm{mol/L}$）。\n- 水溶液的离子强度 $I$ 由 $I = \\frac{1}{2}\\sum_i m_i z_i^2$ 给出，其中 $z_i$ 是物种 $i$ 的电荷。\n- Davies 方程（在 $25\\,^\\circ\\mathrm{C}$ 下，对于中等离子强度，是 Debye-Hückel 定律的一个广为接受的经验扩展）给出了离子 $i$ 的活度系数：\n$$\n\\log_{10}\\gamma_i = -A z_i^2\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right),\n$$\n在 $25\\,^\\circ\\mathrm{C}$ 时，$A = 0.509$。\n\n考虑一个包含离子 $A^-$、$B^{2-}$ 和 $C^{2+}$ 的水溶液体系（为具体起见，可将 $A^-$ 视为氟离子、$B^{2-}$ 视为碳酸根离子、$C^{2+}$ 视为钙离子），同时还有背景电解质 $\\mathrm{Na}^+$ 和 $\\mathrm{Cl}^-$。考虑以下矿物反应：\n\n- 矿物 $M_1$：$C^{2+} + B^{2-} \\rightleftharpoons CB(s)$，其 $Q_1 = a_{C^{2+}} a_{B^{2-}}$，平衡常数为 $K_1$。\n- 矿物 $M_2$：$C^{2+} + 2A^- \\rightleftharpoons CA_2(s)$，其 $Q_2 = a_{C^{2+}} a_{A^-}^2$，平衡常数为 $K_2$。\n\n使用 $K_1 = 10^{-8.48}$ 和 $K_2 = 10^{-10.45}$，两者在 $25\\,^\\circ\\mathrm{C}$ 下均是基于活度的无量纲常数。电荷分别为 $z_{A^-} = -1$，$z_{B^{2-}} = -2$，$z_{C^{2+}} = +2$，$z_{\\mathrm{Na}^+} = +1$ 和 $z_{\\mathrm{Cl}^-} = -1$。Davies 方程中的 Debye-Hückel 常数 $A = 0.509$。\n\n将图的坐标轴定义为 $\\log_{10} a_{A^-}$ 和 $\\log_{10} a_{B^{2-}}$。在每个网格点，给定目标活度 $a_{A^-}$ 和 $a_{B^{2-}}$，以及固定的质量摩尔浓度 $m_{\\mathrm{Na}^+}$、$m_{\\mathrm{Cl}^-}$ 和 $m_{C^{2+}}$。离子强度取决于质量摩尔浓度 $m_{A^-}$ 和 $m_{B^{2-}}$，而这两者并未直接给出，因为 $a_{A^-} = \\gamma_{A^-} m_{A^-}$ 和 $a_{B^{2-}} = \\gamma_{B^{2-}} m_{B^{2-}}$，其中 $\\gamma_{A^-}$ 和 $\\gamma_{B^{2-}}$ 本身是 $I$ 的函数。因此，在每个网格点，迭代求解以下不动点系统：\n\n1. 使用已知的背景离子和 $m_{C^{2+}}$ 来初始化 $I^{(0)}$：\n$$\nI^{(0)} = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} z_{\\mathrm{Na}^+}^2 + m_{\\mathrm{Cl}^-} z_{\\mathrm{Cl}^-}^2 + m_{C^{2+}} z_{C^{2+}}^2\\right) = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}}\\right).\n$$\n2. 给定 $I^{(k)}$，通过 Davies 方程（$A = 0.509$）计算 $\\gamma_{A^-}^{(k)}$、$\\gamma_{B^{2-}}^{(k)}$ 和 $\\gamma_{C^{2+}}^{(k)}$。\n3. 更新\n$$\nm_{A^-}^{(k)} = \\frac{a_{A^-}}{\\gamma_{A^-}^{(k)}}, \\quad m_{B^{2-}}^{(k)} = \\frac{a_{B^{2-}}}{\\gamma_{B^{2-}}^{(k)}},\n$$\n和\n$$\nI^{(k+1)} = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}} + m_{A^-}^{(k)} + 4 m_{B^{2-}}^{(k)}\\right).\n$$\n4. 迭代直至\n$$\n\\left| I^{(k+1)} - I^{(k)} \\right|  \\varepsilon\n$$\n（其中 $\\varepsilon$ 是预设的容差），或达到最大迭代次数 $k_{\\max}$。在收敛的 $I$ 值下，设定 $a_{C^{2+}} = \\gamma_{C^{2+}} m_{C^{2+}}$。\n\n对于每个网格点，在收敛状态下，评估饱和指数\n$$\n\\mathrm{SI}_1 = \\log_{10}\\left(\\frac{Q_1}{K_1}\\right) = \\log_{10}\\left(\\frac{a_{C^{2+}} a_{B^{2-}}}{K_1}\\right), \\quad\n\\mathrm{SI}_2 = \\log_{10}\\left(\\frac{Q_2}{K_2}\\right) = \\log_{10}\\left(\\frac{a_{C^{2+}} a_{A^-}^2}{K_2}\\right).\n$$\n按如下方式对每个网格点的矿物稳定性进行分类：\n- 如果 $\\mathrm{SI}_1  0$ 且 $\\mathrm{SI}_2 \\le 0$，则分类为 $M_1$ 稳定。\n- 如果 $\\mathrm{SI}_2  0$ 且 $\\mathrm{SI}_1 \\le 0$，则分类为 $M_2$ 稳定。\n- 如果 $\\mathrm{SI}_1  0$ 且 $\\mathrm{SI}_2  0$，则分类为具有较大饱和指数的矿物；如果 $\\mathrm{SI}_1 = \\mathrm{SI}_2$，则选择 $M_1$。\n- 如果 $\\mathrm{SI}_1 \\le 0$ 且 $\\mathrm{SI}_2 \\le 0$，则分类为两种矿物均不稳定。\n\n您的算法必须处理整个网格，汇总分类计数，并报告收敛诊断信息。\n\n实现要求：\n- 使用 $\\varepsilon = 10^{-12}$ 和 $k_{\\max} = 100$。\n- 使用 $A = 0.509$，$K_1 = 10^{-8.48}$，$K_2 = 10^{-10.45}$。\n\n测试套件：\n提供三个测试用例，每个用例由元组定义\n$$\n\\left(\\log_{10} a_{A^-}^{\\min}, \\log_{10} a_{A^-}^{\\max}, \\Delta_A, \\log_{10} a_{B^{2-}}^{\\min}, \\log_{10} a_{B^{2-}}^{\\max}, \\Delta_B, m_{C^{2+}}, m_{\\mathrm{Na}^+}, m_{\\mathrm{Cl}^-}\\right),\n$$\n其中 $\\Delta_A$ 和 $\\Delta_B$ 是相应坐标轴上的均匀步长。对于每个测试用例，这些参数如下：\n\n- 测试用例 1（基准稀释体系）：\n  - $\\log_{10} a_{A^-}^{\\min} = -6$，$\\log_{10} a_{A^-}^{\\max} = -3$，$\\Delta_A = 1$，\n  - $\\log_{10} a_{B^{2-}}^{\\min} = -10$，$\\log_{10} a_{B^{2-}}^{\\max} = -6$，$\\Delta_B = 1$，\n  - $m_{C^{2+}} = 10^{-3}$，$m_{\\mathrm{Na}^+} = 0$，$m_{\\mathrm{Cl}^-} = 0$。\n- 测试用例 2（中等背景电解质，接近边界的活度）：\n  - $\\log_{10} a_{A^-}^{\\min} = -7$，$\\log_{10} a_{A^-}^{\\max} = -5$，$\\Delta_A = 1$，\n  - $\\log_{10} a_{B^{2-}}^{\\min} = -9$，$\\log_{10} a_{B^{2-}}^{\\max} = -7$，$\\Delta_B = 1$，\n  - $m_{C^{2+}} = 3\\times 10^{-4}$，$m_{\\mathrm{Na}^+} = 5\\times 10^{-3}$，$m_{\\mathrm{Cl}^-} = 5\\times 10^{-3}$。\n- 测试用例 3（高背景电解质，稀疏网格）：\n  - $\\log_{10} a_{A^-}^{\\min} = -8$，$\\log_{10} a_{A^-}^{\\max} = -4$，$\\Delta_A = 2$，\n  - $\\log_{10} a_{B^{2-}}^{\\min} = -9$，$\\log_{10} a_{B^{2-}}^{\\max} = -5$，$\\Delta_B = 2$，\n  - $m_{C^{2+}} = 10^{-4}$，$m_{\\mathrm{Na}^+} = 10^{-1}$，$m_{\\mathrm{Cl}^-} = 10^{-1}$。\n\n对于每个测试用例，您的程序必须在整个网格上计算：\n- 分类为 $M_1$ 稳定的点的整数计数。\n- 分类为 $M_2$ 稳定的点的整数计数。\n- 分类为两者皆不稳定的点的整数计数。\n- 一个布尔值，指示是否所有网格点都在达到 $k_{\\max}$ 之前满足收敛判据 $|I^{(k+1)} - I^{(k)}|  \\varepsilon$。\n- 在所有网格点中，收敛所用的最大迭代次数。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中每个元素对应一个测试用例，本身也是一个列表，包含按上述顺序排列的五个项目。例如：\n`[ [n_{M_1}, n_{M_2}, n_{none}, all_converged, k_{max,used}], [...], [...] ]`。\n输出中不应包含任何物理单位；所有数值必须表示为浮点数或整数，不带单位。不涉及角度，也不需要百分比。",
            "solution": "所提出的问题是计算地球化学领域一个明确定义的练习，要求构建一个活度-活度图。问题的核心在于确定在一系列化学活度网格上矿物的稳定性。这需要对离子强度和活度系数进行自洽计算，这是地球化学建模中的标准程序。该问题在科学上是合理的，内部一致，并提供了构建唯一、可验证解决方案所需的所有信息。\n\n解决方案的开发首先建立基本的热力学和电化学原理，然后设计一个稳健的迭代算法来求解每个网格点上的非线性方程组，最后指定完整的计算流程以处理测试用例。\n\n**1. 基本原理**\n\n矿物在水溶液中的稳定性由其饱和状态决定。对于一个通用的矿物沉淀反应，质量作用定律将反应商 $Q$ 定义为水溶液中各物种活度 $a_i$ 的乘积，每个活度都取其化学计量系数 $\\nu_i$ 次幂：\n$$\nQ = \\prod_i a_i^{\\nu_i}\n$$\n在平衡状态下，反应商等于平衡常数 $K$。饱和指数 $\\mathrm{SI}$ 是偏离平衡状态的对数度量，定义为 $\\mathrm{SI} = \\log_{10}(Q/K)$。\n- 如果 $\\mathrm{SI}  0$，溶液是过饱和的，矿物在热力学上倾向于沉淀。\n- 如果 $\\mathrm{SI}  0$，溶液是未饱和的，矿物倾向于溶解。\n- 如果 $\\mathrm{SI} = 0$，系统处于平衡状态。\n\n所考虑的两个矿物反应是：\n1.  矿物 $M_1$：$C^{2+} + B^{2-} \\rightleftharpoons CB(s)$。饱和指数为：\n    $$\n    \\mathrm{SI}_1 = \\log_{10}\\left(\\frac{Q_1}{K_1}\\right) = \\log_{10}\\left(\\frac{a_{C^{2+}} a_{B^{2-}}}{K_1}\\right)\n    $$\n    问题指定 $\\log_{10} K_1 = -8.48$。\n\n2.  矿物 $M_2$：$C^{2+} + 2A^- \\rightleftharpoons CA_2(s)$。饱和指数为：\n    $$\n    \\mathrm{SI}_2 = \\log_{10}\\left(\\frac{Q_2}{K_2}\\right) = \\log_{10}\\left(\\frac{a_{C^{2+}} a_{A^-}^2}{K_2}\\right)\n    $$\n    问题指定 $\\log_{10} K_2 = -10.45$。\n\n离子 $i$ 的活度 $a_i$ 通过活度系数 $\\gamma_i$ 与其质量摩尔浓度 $m_i$（浓度单位为 mol/kg）相关联，即 $a_i = \\gamma_i m_i$。活度系数解释了电解质溶液中的非理想行为，并且它们本身是溶液总离子强度的函数。\n\n离子强度 $I$ 定义为：\n$$\nI = \\frac{1}{2}\\sum_i m_i z_i^2\n$$\n其中 $z_i$ 是离子 $i$ 的整数电荷。\n\n每个离子的活度系数 $\\gamma_i$ 使用 Davies 方程计算，这是 Debye-Hückel 理论的一个经验扩展，在 $25\\,^\\circ\\mathrm{C}$ 对中等离子强度有效：\n$$\n\\log_{10}\\gamma_i = -A z_i^2\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right)\n$$\n其中 $A$ 是 Debye-Hückel 常数，给定为 $0.509$。\n\n**2. 自洽性的迭代解法**\n\n计算上的挑战源于 $a_i$ 和 $m_i$ 的相互依赖性。要从目标活度 $a_{A^-}$ 和 $a_{B^{2-}}$ 求出 $m_{A^-}$ 和 $m_{B^{2-}}$，我们需要 $\\gamma_{A^-}$ 和 $\\gamma_{B^{2-}}$。然而，这些活度系数取决于离子强度 $I$，而离子强度又取决于溶液中所有离子的质量摩尔浓度，包括未知的 $m_{A^-}$ 和 $m_{B^{2-}}$。这种循环依赖性需要一种不动点迭代方法来找到离子强度 $I$ 的自洽解。\n\n对于单个网格点（由目标活度 $a_{A^-}$ 和 $a_{B^{2-}}$ 以及固定的质量摩尔浓度 $m_{C^{2+}}$、$m_{\\mathrm{Na}^+}$ 和 $m_{\\mathrm{Cl}^-}$ 定义），算法如下：\n\n1.  **初始化 ($k=0$):** 仅考虑已知质量摩尔浓度的离子，计算离子强度的初始估计值 $I^{(0)}$：\n    $$\n    I^{(0)} = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} z_{\\mathrm{Na}^+}^2 + m_{\\mathrm{Cl}^-} z_{\\mathrm{Cl}^-}^2 + m_{C^{2+}} z_{C^{2+}}^2\\right) = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} (1)^2 + m_{\\mathrm{Cl}^-} (-1)^2 + m_{C^{2+}} (2)^2\\right) = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}}\\right)\n    $$\n\n2.  **迭代 ($k \\to k+1$):** 循环进行直到收敛或达到最大迭代次数 $k_{\\max} = 100$。\n    a.  给定当前估计值 $I^{(k)}$，使用 Davies 方程计算活度系数 $\\gamma_{A^-}^{(k)}$ 和 $\\gamma_{B^{2-}}^{(k)}$。\n    b.  使用目标活度更新离子 $A^-$ 和 $B^{2-}$ 的质量摩尔浓度：\n        $$\n        m_{A^-}^{(k)} = \\frac{a_{A^-}}{\\gamma_{A^-}^{(k)}} \\quad \\text{和} \\quad m_{B^{2-}}^{(k)} = \\frac{a_{B^{2-}}}{\\gamma_{B^{2-}}^{(k)}}\n        $$\n    c.  计算离子强度的下一个估计值 $I^{(k+1)}$，包括新计算的质量摩尔浓度的贡献：\n        $$\n        I^{(k+1)} = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}} + m_{A^-}^{(k)} z_{A^-}^2 + m_{B^{2-}}^{(k)} z_{B^{2-}}^2 \\right) = \\frac{1}{2}\\left(m_{\\mathrm{Na}^+} + m_{\\mathrm{Cl}^-} + 4 m_{C^{2+}} + m_{A^-}^{(k)} + 4 m_{B^{2-}}^{(k)}\\right)\n        $$\n\n3.  **收敛检查:** 迭代继续，直到连续离子强度值之间的绝对差小于容差 $\\varepsilon = 10^{-12}$：\n    $$\n    \\left| I^{(k+1)} - I^{(k)} \\right|  \\varepsilon\n    $$\n\n**3. 网格处理与分类**\n\n一旦迭代过程收敛到最终的离子强度 $I$，就执行余下的计算：\n1.  使用收敛的 $I$ 计算阳离子的最终活度系数 $\\gamma_{C^{2+}}$。\n2.  求出阳离子的活度：$a_{C^{2+}} = \\gamma_{C^{2+}} m_{C^{2+}}$。\n3.  使用已知的活度 $a_{A^-}$、$a_{B^{2-}}$、计算出的 $a_{C^{2+}}$ 以及给定的平衡常数 $K_1=10^{-8.48}$ 和 $K_2=10^{-10.45}$ 来计算饱和指数 $\\mathrm{SI}_1$ 和 $\\mathrm{SI}_2$。在对数空间中进行此计算效率最高：\n    $$\n    \\mathrm{SI}_1 = \\log_{10}(a_{C^{2+}}) + \\log_{10}(a_{B^{2-}}) - \\log_{10}(K_1)\n    $$\n    $$\n    \\mathrm{SI}_2 = \\log_{10}(a_{C^{2+}}) + 2\\log_{10}(a_{A^-}) - \\log_{10}(K_2)\n    $$\n4.  根据 $\\mathrm{SI}_1$ 和 $\\mathrm{SI}_2$ 的值，按照指定的规则对每个网格点进行分类：\n    - $M_1$ 稳定：$\\mathrm{SI}_1  0$ 且 $\\mathrm{SI}_2 \\le 0$。\n    - $M_2$ 稳定：$\\mathrm{SI}_2  0$ 且 $\\mathrm{SI}_1 \\le 0$。\n    - 两者均过饱和（$\\mathrm{SI}_1  0, \\mathrm{SI}_2  0$）：$\\mathrm{SI}$ 较大的矿物占主导。如果 $\\mathrm{SI}_1 = \\mathrm{SI}_2$，则选择 $M_1$。\n    - 两者均不稳定（$\\mathrm{SI}_1 \\le 0, \\mathrm{SI}_2 \\le 0$）：溶液相对于两种矿物均未饱和。\n\n将这整个过程应用于由 $\\log_{10} a_{A^-}$ 和 $\\log_{10} a_{B^{2-}}$ 的范围和步长定义的网格上的每个点。最终输出汇总每个稳定性类别的计数，报告整个网格的收敛成功情况，并提供任何点所需的最大迭代次数。这种系统化的方法确保了活度-活度图的正确和稳健构建。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the geochemical simulations for all test cases.\n    \"\"\"\n    \n    # Define constants from the problem statement.\n    A_DAVIES = 0.509\n    LOG10_K1 = -8.48\n    LOG10_K2 = -10.45\n    EPSILON = 1.0e-12\n    K_MAX = 100\n\n    # Charges of the ions\n    Z_A = -1\n    Z_B = -2\n    Z_C = 2\n    Z_NA = 1\n    Z_CL = -1\n\n    def davies_log10_gamma(z, I, A):\n        \"\"\"\n        Calculates the log10 of the activity coefficient using the Davies equation.\n        Returns log10(gamma).\n        \"\"\"\n        if I  0:\n            # Ionic strength cannot be negative, may happen due to numerical noise with very small molalities.\n            # Treat as zero in this edge case.\n            I = 0.0\n        \n        sqrt_I = np.sqrt(I)\n        log10_g = -A * (z**2) * ( (sqrt_I / (1.0 + sqrt_I)) - 0.3 * I )\n        return log10_g\n\n    def process_grid_point(log10_a_A, log10_a_B, m_C, m_Na, m_Cl):\n        \"\"\"\n        Performs the iterative calculation for a single grid point.\n        \"\"\"\n        a_A = 10**log10_a_A\n        a_B = 10**log10_a_B\n\n        # 1. Initialize ionic strength I^(0)\n        I = 0.5 * (m_Na * Z_NA**2 + m_Cl * Z_CL**2 + m_C * Z_C**2)\n        \n        converged = False\n        k = 0\n        for k in range(K_MAX):\n            # 2. Compute activity coefficients from I^(k)\n            log10_gamma_A = davies_log10_gamma(Z_A, I, A_DAVIES)\n            gamma_A = 10**log10_gamma_A\n            \n            log10_gamma_B = davies_log10_gamma(Z_B, I, A_DAVIES)\n            gamma_B = 10**log10_gamma_B\n\n            # 3. Update molalities and ionic strength I^(k+1)\n            m_A = a_A / gamma_A\n            m_B = a_B / gamma_B\n            \n            I_next = 0.5 * (m_Na*Z_NA**2 + m_Cl*Z_CL**2 + m_C*Z_C**2 + m_A*Z_A**2 + m_B*Z_B**2)\n\n            # 4. Check for convergence\n            if abs(I_next - I)  EPSILON:\n                converged = True\n                I = I_next\n                break\n            \n            I = I_next\n        \n        num_iterations = k + 1\n\n        # At converged I, calculate final activities and SIs\n        log10_gamma_C = davies_log10_gamma(Z_C, I, A_DAVIES)\n        gamma_C = 10**log10_gamma_C\n        a_C = gamma_C * m_C\n        log10_a_C = np.log10(a_C)\n\n        # Calculate Saturation Indices\n        SI1 = log10_a_C + log10_a_B - LOG10_K1\n        SI2 = log10_a_C + 2 * log10_a_A - LOG10_K2\n\n        # Classify stability\n        classification = \"none\"\n        if SI1 > 0 and SI2 > 0:\n            if SI1 >= SI2:\n                classification = \"M1\"\n            else:\n                classification = \"M2\"\n        elif SI1 > 0:\n            classification = \"M1\"\n        elif SI2 > 0:\n            classification = \"M2\"\n\n        return classification, converged, num_iterations\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (log10_a_A_min, log10_a_A_max, delta_A, log10_a_B_min, log10_a_B_max, delta_B, m_C, m_Na, m_Cl)\n        (-6.0, -3.0, 1.0, -10.0, -6.0, 1.0, 1e-3, 0.0, 0.0),\n        (-7.0, -5.0, 1.0, -9.0, -7.0, 1.0, 3e-4, 5e-3, 5e-3),\n        (-8.0, -4.0, 2.0, -9.0, -5.0, 2.0, 1e-4, 1e-1, 1e-1),\n    ]\n\n    final_results = []\n    for case in test_cases:\n        log10_a_A_min, log10_a_A_max, delta_A, log10_a_B_min, log10_a_B_max, delta_B, m_C, m_Na, m_Cl = case\n\n        # Generate grid points\n        # Add a small epsilon to max to ensure endpoint inclusion with np.arange\n        log_a_A_range = np.arange(log10_a_A_min, log10_a_A_max + delta_A / 2, delta_A)\n        log_a_B_range = np.arange(log10_a_B_min, log10_a_B_max + delta_B / 2, delta_B)\n\n        # Initialize counters and diagnostics\n        n_M1, n_M2, n_none = 0, 0, 0\n        all_converged = True\n        max_iter_used = 0\n\n        for log10_a_A in log_a_A_range:\n            for log10_a_B in log_a_B_range:\n                classification, converged, num_iters = process_grid_point(log10_a_A, log10_a_B, m_C, m_Na, m_Cl)\n                \n                if classification == \"M1\":\n                    n_M1 += 1\n                elif classification == \"M2\":\n                    n_M2 += 1\n                else:\n                    n_none += 1\n\n                if not converged:\n                    all_converged = False\n                \n                if num_iters > max_iter_used:\n                    max_iter_used = num_iters\n\n        result_list = [n_M1, n_M2, n_none, all_converged, max_iter_used]\n        final_results.append(result_list)\n        \n    # Final print statement in the exact required format.\n    # Convert boolean to lowercase 'true'/'false' if needed by a specific interpreter, but Python's default is True/False\n    # The example shows no quotes, so direct list-to-string conversion is fine.\n    # The output format has spaces after commas, so use default str()\n    print(f\"[{', '.join(map(str, final_results))}]\".replace(\"'\", \"\").replace(\" \", \"\"))\n\nsolve()\n\n```",
            "answer": "[[12,3,5,True,3],[2,5,2,True,4],[3,4,2,True,6]]"
        }
    ]
}