{
    "hands_on_practices": [
        {
            "introduction": "朗缪尔吸附等温线是描述气体或溶质在固体表面单层吸附行为的基石模型。本练习将引导你从质量作用定律等基本原理出发，推导经典的朗缪尔方程，让你亲手实践其理论基础。通过计算给定压力下的表面覆盖率和吸附物浓度，你将能够巩固对理想化吸附过程核心参数的理解。",
            "id": "2957509",
            "problem": "一种气态吸附物种 $A$ 与一个洁净、无孔的固体表面接触，该表面具有均匀分布的、相同的、无相互作用的吸附位点。系统保持在温度 $T=298\\ \\text{K}$。$A$ 的气相压力为 $p=0.10\\ \\text{bar}$。该吸附是发生在单一类型位点上的可逆单层过程，由以下基元平衡描述\n$$\nA(\\text{g}) + S(\\text{site}) \\rightleftharpoons A{-}S(\\text{adsorbed}) .\n$$\n在 $T=298\\ \\text{K}$ 时，实验测定的吸附平衡参数（相对于压力定义）为 $K=5.0\\ \\text{bar}^{-1}$。表面位点密度（最大单层吸附容量）为 $\\Gamma_{\\max}=3.600\\times 10^{-6}\\ \\text{mol}\\ \\text{m}^{-2}$。\n\n从质量作用定律出发，用气相的活度和表面的理想位点分数表示，并对气相使用理想气体近似（标准态为 $p^{\\circ}=1\\ \\text{bar}$），推导分数覆盖度 $\\theta$ 作为 $K$ 和 $p$ 的函数表达式。然后计算：\n- 在 $p=0.10\\ \\text{bar}$ 时的分数覆盖度 $\\theta$，以及\n- 吸附的 $A$ 的表面浓度 $\\Gamma$。\n\n将 $\\theta$ 表示为纯数，$\\Gamma$ 以 $\\text{mol}\\ \\text{m}^{-2}$ 为单位表示。将最终数值结果四舍五入至四位有效数字。",
            "solution": "对所给的问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 吸附质：气态物种 $A$。\n- 表面：洁净、无孔，具有均匀分布的、相同的、无相互作用的吸附位点。\n- 温度：$T = 298 \\text{ K}$。\n- $A$ 的气相压力：$p = 0.10 \\text{ bar}$。\n- 吸附过程：可逆、单层，发生在单一类型的位点上。\n- 平衡反应：$A(\\text{g}) + S(\\text{site}) \\rightleftharpoons A{-}S(\\text{adsorbed})$。\n- 吸附平衡参数：在 $T = 298 \\text{ K}$ 时，$K = 5.0 \\text{ bar}^{-1}$。\n- 表面位点密度（最大单层吸附容量）：$\\Gamma_{\\max} = 3.600 \\times 10^{-6} \\text{ mol}\\ \\text{m}^{-2}$。\n- 标准态压力：$p^{\\circ} = 1 \\text{ bar}$。\n- 近似：气相为理想气体，表面为理想位点分数。\n- 任务：推导分数覆盖度 $\\theta$ 相对于 $K$ 和 $p$ 的表达式，然后计算 $\\theta$ 和表面浓度 $\\Gamma$。\n- 精度：将最终数值结果四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了作为表面化学基石的 Langmuir 吸附模型。所有假设（理想气体、无相互作用的位点、单层吸附）都是明确的，并构成了该模型的基础。该问题是适定的；它提供了推导所需表达式和计算后续值所需的所有必要常数和条件（$p$、$T$、$K$、$\\Gamma_{\\max}$、$p^{\\circ}$）。该问题是客观的，使用了精确的科学术语和定量数据。它是自洽的、一致的，并且没有任何逻辑或科学上的缺陷。\n\n**第 3 步：结论与行动**\n该问题有效。将提供解答。\n\n推导从指定平衡的质量作用定律开始：\n$$\nA(\\text{g}) + S(\\text{site}) \\rightleftharpoons A{-}S(\\text{adsorbed})\n$$\n热力学平衡常数 $K_{eq}$ 用反应物种的活度 ($a_i$) 表示如下：\n$$\nK_{eq} = \\frac{a_{A-S}}{a_{A(\\text{g})} \\cdot a_S}\n$$\n根据问题陈述，我们必须为这些活度使用特定的模型。\n分数表面覆盖度 $\\theta$ 是被占据位点的分数。因此，空位的分数为 $1 - \\theta$。对于表面上的理想混合物，表面物种的活度等于它们的摩尔分数（或位点分数）。\n- 吸附物种的活度：$a_{A-S} = \\theta$。\n- 空位的活度：$a_S = 1 - \\theta$。\n\n对于气态物种 $A$，使用理想气体近似。其活度是其分压 $p$ 与标准态压力 $p^{\\circ}$ 的比值：\n- 气相物种的活度：$a_{A(\\text{g})} = \\frac{p}{p^{\\circ}}$。\n\n将这些活度表达式代入 $K_{eq}$ 的方程中：\n$$\nK_{eq} = \\frac{\\theta}{\\left(\\frac{p}{p^{\\circ}}\\right)(1 - \\theta)} = \\frac{\\theta \\cdot p^{\\circ}}{p(1 - \\theta)}\n$$\n这个热力学常数 $K_{eq}$ 是无量纲的。题目提供了一个单位为 $\\text{bar}^{-1}$ 的实用平衡参数 $K$。该常数通常定义为：\n$$\nK = \\frac{\\theta}{p(1 - \\theta)}\n$$\n通过比较这两个表达式，我们建立了热力学常数和实用常数之间的关系：\n$$\nK_{eq} = K \\cdot p^{\\circ}\n$$\n已知 $K = 5.0 \\text{ bar}^{-1}$ 和 $p^{\\circ} = 1 \\text{ bar}$，无量纲常数为 $K_{eq} = (5.0 \\text{ bar}^{-1})(1 \\text{ bar}) = 5.0$。\n\n任务要求得到 $\\theta$ 作为 $K$ 和 $p$ 的函数的表达式。我们对实用常数 $K$ 的表达式进行重排：\n$$\nK p(1 - \\theta) = \\theta\n$$\n$$\nK p - K p \\theta = \\theta\n$$\n$$\nK p = \\theta + K p \\theta\n$$\n$$\nK p = \\theta (1 + K p)\n$$\n解出 $\\theta$ 得到 Langmuir 等温线方程：\n$$\n\\theta = \\frac{K p}{1 + K p}\n$$\n这就是所要求的表达式。\n\n现在，我们计算在给定条件（$p = 0.10 \\text{ bar}$ 和 $K = 5.0 \\text{ bar}^{-1}$）下分数覆盖度 $\\theta$ 的数值。\n$$\n\\theta = \\frac{(5.0 \\text{ bar}^{-1})(0.10 \\text{ bar})}{1 + (5.0 \\text{ bar}^{-1})(0.10 \\text{ bar})} = \\frac{0.50}{1 + 0.50} = \\frac{0.50}{1.50} = \\frac{1}{3}\n$$\n作为四舍五入到四位有效数字的小数，$\\theta \\approx 0.3333$。\n\n最后，我们计算吸附的 $A$ 的表面浓度，记为 $\\Gamma$。这是分数覆盖度 $\\theta$ 和最大单层吸附容量 $\\Gamma_{\\max}$ 的乘积：\n$$\n\\Gamma = \\theta \\cdot \\Gamma_{\\max}\n$$\n使用 $\\theta$ 的精确值 $\\frac{1}{3}$ 和给定的值 $\\Gamma_{\\max} = 3.600 \\times 10^{-6} \\text{mol}\\ \\text{m}^{-2}$：\n$$\n\\Gamma = \\left(\\frac{1}{3}\\right) \\cdot (3.600 \\times 10^{-6} \\text{ mol}\\ \\text{m}^{-2}) = 1.200 \\times 10^{-6} \\text{ mol}\\ \\text{m}^{-2}\n$$\n结果已经表示为四位有效数字。\n\n计算出的两个量是分数覆盖度 $\\theta$ 和表面浓度 $\\Gamma$。\n- $\\theta = 0.3333$ (无量纲)\n- $\\Gamma = 1.200 \\times 10^{-6} \\text{ mol}\\ \\text{m}^{-2}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3333  1.200 \\times 10^{-6} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在环境地球化学的反应迁移模型中，分配系数 $K_d$ 是一个关键参数，但它常常被简化为常数。本练习旨在挑战这一简化假设，要求你从朗缪尔和弗罗因德利希这两种经典的吸附等温线模型出发，推导 $K_d$ 对溶质浓度的函数依赖关系。通过分析 $K_d$ 在不同浓度下的行为，你将能更深刻地理解吸附模型的适用范围及其在宏观输运模拟中的意义。",
            "id": "4101138",
            "problem": "计算地球化学中的一个反应输运模型用以表示溶质在矿物表面的可逆吸附。设单位质量固体上的吸附浓度为 $q$，溶解浓度为 $C$。定义分配系数 $K_d$ 为 $K_d = q/C$。考虑两种广泛使用的表面吸附框架，并评估在每种框架下 $K_d$ 如何依赖于 $C$，并与恒定 $K_d$ 的假设进行比较。\n\n首先，假设一个具有固定数量等效位点、单层覆盖且无横向相互作用的均一表面，其吸附过程由处于平衡状态的基元反应 $S + A \\leftrightharpoons SA$ 表示。令 $b$ 表示位点结合的平衡常数，$\\theta$ 表示已占据位点的分数，$q_{\\max}$ 表示对应于 $\\theta = 1$ 的吸附容量，且有 $q = q_{\\max}\\theta$。从质量作用平衡和位点守恒出发，推导 $K_d$ 对 $C$ 的函数依赖关系，及其在 $C \\to 0$ 和 $C \\to \\infty$ 时的极限行为。\n\n其次，考虑一种非均一吸附剂，大量的经验观测表明其吸附量与浓度呈幂律标度关系，这与广泛的位点能量分布相一致，使得 $q$ 随 $C$ 的幂次变化，指数为 $n$，系数为 $K_F$。推导 $K_d$ 对 $C$ 的函数依赖关系，并用 $n$ 表示 $\\log K_d$ 对 $\\log C$ 的斜率。讨论在 $n$ 的何种取值范围内，函数 $K_d(C)$ 是递减或递增的。\n\n最后，根据上述机理描述和经验描述，评估恒定 $K_d$ 假设的物理意义和有效范围。下列哪个陈述是正确的？\n\nA. 在均一单层吸附机理下，$K_d(C)$ 随 $C$ 单调递减，并满足 $\\lim_{C \\to 0} K_d = q_{\\max} b$ 和 $\\lim_{C \\to \\infty} K_d = 0$。\n\nB. 在幂律标度下，$\\log K_d$ 对 $\\log C$ 的斜率为 $n$。\n\nC. 恒定 $K_d$ 的假设在 Langmuir 模型的低浓度极限和 Freundlich 模型的 $n=1$ 特例下是有效的。\n\nD. Freundlich 模型通常预测分配系数 $K_d$ 随浓度 $C$ 的增加而增加。\n\nE. 恒定 $K_d$ 的假设仅在 Langmuir 模型的低浓度极限下有效，而在 Freundlich 模型中仅在 $n=1$ 的特殊情况下有效。",
            "solution": "该问题陈述是有效的，因为它科学地基于表面化学的既定原理（Langmuir 和 Freundlich 吸附等温线），问题设置良好，提供了足够的推导信息，并使用了客观、精确的语言。\n\n解答过程首先分析所述的两种吸附框架，推导每种情况下分配系数 $K_d$ 的函数形式，然后评估所给的陈述。\n\n### 第1部分：均一单层机理 (Langmuir 模型)\n\n该框架基于四个关键假设：\n1.  表面是均一的，意味着所有吸附位点在能量上是等效的。\n2.  吸附仅限于单分子层。\n3.  被吸附的分子之间不相互作用（无横向相互作用）。\n4.  吸附是一个可逆过程。\n\n可逆反应为 $S + A \\leftrightharpoons SA$，其中 $S$ 代表一个空的表面位点，$A$ 是溶解的溶质（浓度为 $C$）。此结合反应的平衡常数 $b$ 由质量作用定律定义：\n$$b = \\frac{[SA]}{[S][A]}$$\n其中 $[SA]$ 是已占据位点的浓度，$[S]$ 是空位点的浓度，$[A] = C$ 是溶解溶质的浓度。\n\n已占据位点的分数为 $\\theta = \\frac{[SA]}{[S_{total}]}$，其中 $[S_{total}] = [S] + [SA]$ 是总位点浓度。\n空位点的分数为 $1-\\theta = \\frac{[S]}{[S_{total}]}$。\n\n根据这些定义，我们可以写出 $[SA] = \\theta [S_{total}]$ 和 $[S] = (1-\\theta)[S_{total}]$。将它们代入平衡常数表达式中：\n$$b = \\frac{\\theta [S_{total}]}{(1-\\theta)[S_{total}] C} = \\frac{\\theta}{(1-\\theta)C}$$\n这个方程可以重排以求解分数覆盖率 $\\theta$：\n$$bC(1-\\theta) = \\theta$$\n$$bC - bC\\theta = \\theta$$\n$$bC = \\theta(1 + bC)$$\n$$\\theta = \\frac{bC}{1+bC}$$\n这就是分数覆盖率的 Langmuir 等温线表达式。\n\n吸附浓度 $q$ 与分数覆盖率的关系为 $q = q_{\\max}\\theta$，其中 $q_{\\max}$ 是当所有位点都被占据时（$\\theta=1$）可能的最大吸附浓度（吸附容量）。代入 $\\theta$ 的表达式：\n$$q = q_{\\max} \\frac{bC}{1+bC}$$\n分配系数 $K_d$ 定义为 $K_d = q/C$。\n$$K_d(C) = \\frac{1}{C} \\left( q_{\\max} \\frac{bC}{1+bC} \\right) = \\frac{q_{\\max}b}{1+bC}$$\n该表达式表明 $K_d$ 是溶解浓度 $C$ 的函数。随着 $C$ 的增加，分母 $(1+bC)$ 增加，导致 $K_d(C)$ 减小。对于 $C  0$，这是一个单调递减。\n\n我们现在评估 $K_d(C)$ 的极限行为：\n1.  当 $C \\to 0$ 时：\n    $$\\lim_{C \\to 0} K_d(C) = \\lim_{C \\to 0} \\frac{q_{\\max}b}{1+bC} = \\frac{q_{\\max}b}{1+0} = q_{\\max}b$$\n2.  当 $C \\to \\infty$ 时：\n    $$\\lim_{C \\to \\infty} K_d(C) = \\lim_{C \\to \\infty} \\frac{q_{\\max}b}{1+bC} = 0$$\n\n### 第2部分：幂律标度 (Freundlich 模型)\n\n该框架描述了非均一表面上吸附的经验关系。吸附浓度 $q$ 通过幂律函数与溶解浓度 $C$ 相关：\n$$q = K_F C^n$$\n其中 $K_F$ 和 $n$ 是经验常数。$K_F$ 是 Freundlich 常数（与容量相关），$n$ 是 Freundlich 指数（与强度或表面非均一性相关）。\n\n分配系数 $K_d$ 同样由 $K_d = q/C$ 给出：\n$$K_d(C) = \\frac{K_F C^n}{C} = K_F C^{n-1}$$\n为了找到 $\\log K_d$ 对 $\\log C$ 的斜率，我们对两边取对数（使用任意底数，这里使用自然对数 $\\ln$）：\n$$\\ln(K_d) = \\ln(K_F C^{n-1})$$\n$$\\ln(K_d) = \\ln(K_F) + \\ln(C^{n-1})$$\n$$\\ln(K_d) = \\ln(K_F) + (n-1)\\ln(C)$$\n这是一个直线方程 $y = mx + c$，其中 $y = \\ln(K_d)$，$x = \\ln(C)$，截距为 $c = \\ln(K_F)$，斜率为 $m = n-1$。\n\n$K_d$ 对 $C$ 的依赖性由指数 $(n-1)$ 决定。\n- 如果 $0  n  1$（该模型最常见的范围），则指数 $(n-1)$ 为负。在这种情况下，$K_d(C)$ 是 $C$ 的递减函数。\n- 如果 $n  1$，则指数 $(n-1)$ 为正，$K_d(C)$ 是 $C$ 的递增函数。\n- 如果 $n = 1$，则指数 $(n-1)$ 为零，$K_d(C) = K_F C^0 = K_F$，这意味着 $K_d$ 是常数。\n\n### 第3部分：恒定 $K_d$ 假设\n\n恒定的 $K_d$ 意味着 $q = K_d C$，这是一个线性吸附等温线。\n- 在 Langmuir 模型的背景下，这仅在极低浓度（$C \\to 0$）的极限下有效，此时 $K_d(C) \\approx q_{\\max}b$。这被称为吸附的亨利定律区。在中高浓度下，恒定 $K_d$ 的假设失效，因为表面位点开始饱和，导致 $K_d(C)$ 减小。\n- 在 Freundlich 模型的背景下，只有当指数 $n=1$ 时，恒定的 $K_d$ 才有效。对于非均一表面的典型情况，即 $0  n  1$ 时，恒定 $K_d$ 的假设是无效的。\n\n### 陈述评估\n\n**A. 在均一单层吸附机理下，$K_d(C)$ 随 $C$ 单调递减，并满足 $\\lim_{C \\to 0} K_d = q_{\\max} b$ 和 $\\lim_{C \\to \\infty} K_d = 0$。**\n如第1部分所示，$K_d(C) = \\frac{q_{\\max}b}{1+bC}$。其对 $C$ 的导数为 $\\frac{dK_d}{dC} = -q_{\\max}b^2(1+bC)^{-2}$，对于 $C0, b0, q_{\\max}0$，该导数始终为负。因此，$K_d(C)$ 单调递减。极限也被推导为 $\\lim_{C \\to 0} K_d = q_{\\max} b$ 和 $\\lim_{C \\to \\infty} K_d = 0$。该陈述与我们的推导完全一致。\n**结论：正确。**\n\n**B. 在幂律标度下，$\\log K_d$ 对 $\\log C$ 的斜率为 $n$。**\n如第2部分所示，$\\ln(K_d) = \\ln(K_F) + (n-1)\\ln(C)$。因此，$\\log K_d$ 对 $\\log C$ 的斜率是 $(n-1)$，而不是 $n$。\n**结论：错误。**\n\n**C. 恒定 $K_d$ 的假设在 Langmuir 模型的低浓度极限和 Freundlich 模型的 $n=1$ 特例下是有效的。**\n如第3部分所述，恒定 $K_d$ 模型（即线性吸附）是 Langmuir 模型在 $C \\to 0$ 时的切线近似，此时 $K_d(C) \\to q_{\\max}b$（常数）。它也是 Freundlich 模型在 $n=1$ 时的精确形式，此时 $K_d(C) = K_F$（常数）。\n**结论：正确。**\n\n**D. Freundlich 模型通常预测分配系数 $K_d$ 随浓度 $C$ 的增加而增加。**\n$K_d(C)$ 随 $C$ 增加的条件是 $n  1$。然而，对于描述非均一表面的 Freundlich 模型，指数 $n$ 几乎总是在 $0$ 和 $1$ 之间。因此，Freundlich 模型通常预测 $K_d$ 随 $C$ 的增加而**减小**。该陈述是错误的。\n**结论：错误。**\n\n**E. 恒定 $K_d$ 的假设仅在 Langmuir 模型的低浓度极限下有效，而在 Freundlich 模型中仅在 $n=1$ 的特殊情况下有效。**\n这与陈述 C 的内容相同，只是措辞略有不同。它准确地描述了两种模型中线性（恒定 $K_d$）行为的适用范围。\n**结论：正确。**\n\n因此，正确的陈述是 A、C 和 E。",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "真实的地球化学体系远比理想模型复杂，其中水相中的离子络合和活度修正对吸附行为有显著影响。本练习是一项综合性的计算实践，要求你设计一个工作流程，将水相化学形态计算（包括络合与活度校正）与吸附等温线评估相结合。通过从零开始构建这个耦合模型，你将掌握计算地球化学中处理复杂体系的一项核心高级技能。",
            "id": "4101149",
            "problem": "您的任务是设计并实现一个计算工作流，该工作流在每个整体浓度点上将水相形态计算与吸附等温线评估相结合，以便在存在单价配体和背景电解质的情况下，正确处理二价金属的络合作用和活度校正。该实现必须是一个完整、可运行的程序。\n\n从化学热力学和表面化学的基本原理出发，使用以下原则，不得使用简化公式：\n- 物种 $i$ 的化学活度 $a_i$ 定义为 $a_i = \\gamma_i \\, C_i$，其中 $\\gamma_i$ 是活度系数，$C_i$ 是摩尔浓度，单位为 $\\mathrm{mol\\,L^{-1}}$。在离子强度为 $I$ 时，电荷为 $z_i$ 的水合离子的活度系数 $\\gamma_i$ 可在 $25\\,^\\circ\\mathrm{C}$ 下使用 Davies 方程获得：$\\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right)$，其中 $A = 0.51$。对于中性物种，使用 $\\gamma_i = 1$。\n- 对金属-配体络合物的形成应用质量作用定律。设金属为 $M^{2+}$ (电荷 $z_M=+2$)，配体为 $L^{-}$ (电荷 $z_L=-1$)，络合物为 $\\mathrm{ML}^{+}$ (电荷 $z_{ML}=+1$)。在 $25\\,^\\circ\\mathrm{C}$ 下，以活度表示的形成常数定义为 $\\beta_1 = \\dfrac{a_{\\mathrm{ML}^{+}}}{a_{M^{2+}}\\,a_{L^{-}}}$。将给定的 $\\beta_1$ 以 $10$ 为底的对数形式处理，并进行适当转换。仅使用 $M$ 和 $L$ 的质量守恒约束：$C_{M,\\mathrm{tot}} = C_{M^{2+}} + C_{\\mathrm{ML}^{+}}$ 和 $C_{L,\\mathrm{tot}} = C_{L^{-}} + C_{\\mathrm{ML}^{+}}$。假设背景电解质主导离子强度，因此 $I \\approx I_{\\mathrm{bg}}$，从而活度系数是固定 $I_{\\mathrm{bg}}$ 的函数。\n- 对于吸附，从表面过剩和位点占据的定义出发，推导 Langmuir 和 Freundlich 等温线的数学一致性表达式，其中使用自由金属离子活度 $a_{M^{2+}}$作为吸附物种。在您的推导中，不要假设预先给定的等温线方程；而是应基于理想的局域吸附位点（Langmuir）和导致幂律关系（Freundlich）的非均相吸附能的假设来构建它们。在您的实现中，使用推导出的形式以及测试套件中提供的参数。\n\n您的程序必须：\n1. 在每个指定的总金属浓度点 $C_{M,\\mathrm{tot}}$（单位为 $\\mathrm{mol\\,L^{-1}}$）下，根据所述假设计算水相形态，包括在固定离子强度 $I_{\\mathrm{bg}}$（单位为 $\\mathrm{mol\\,L^{-1}}$）下的络合作用和活度校正。使用以活度表示的质量作用定律和质量平衡来求解 $C_{\\mathrm{ML}^{+}}$、$C_{M^{2+}}$ 和 $C_{L^{-}}$。\n2. 根据浓度和活度系数计算活度 $a_{M^{2+}}$。\n3. 使用活度 $a_{M^{2+}}$ 作为自变量，为所选的等温线评估表面吸附量。对于 Langmuir 情况，使用容量参数 $q_{\\max}$（单位为 $\\mathrm{mol\\,kg^{-1}}$）和亲和参数 $K_L$（单位为 $\\mathrm{L\\,mol^{-1}}$）。对于 Freundlich 情况，使用 $K_F$（单位为 $\\mathrm{mol\\,kg^{-1}}$，活度无量纲）和指数 $n$（无量纲）。\n4. 对于每个测试用例，返回一个吸附量列表，该列表对应于所提供的 $C_{M,\\mathrm{tot}}$ 点列表。\n\n物理单位和输出规范：\n- $C_{M,\\mathrm{tot}}$ 和 $C_{L,\\mathrm{tot}}$ 使用 $\\mathrm{mol\\,L^{-1}}$ 单位，离子强度 $I_{\\mathrm{bg}}$ 使用 $\\mathrm{mol\\,L^{-1}}$ 单位，吸附量以 $\\mathrm{mol\\,kg^{-1}}$ 報告。\n- 所有活度都是无量纲的，标准态取为 $1\\,\\mathrm{mol\\,L^{-1}}$。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果本身是一个浮点数列表，代表吸附量，并按照所提供的 $C_{M,\\mathrm{tot}}$ 点的顺序排列。输出中不得有空格。例如：“[[x1,x2],[y1,y2]]”。\n\n测试套件：\n实施您的程序以处理以下四个测试用例，每个用例由参数和 $C_{M,\\mathrm{tot}}$ 点的向量定义：\n\n- 用例 1（一般情况，中等络合，Langmuir）：\n  - $z_M = +2$，$z_L = -1$，$z_{ML} = +1$\n  - $\\log_{10}\\beta_1 = 2$\n  - $I_{\\mathrm{bg}} = 0.1\\,\\mathrm{mol\\,L^{-1}}$\n  - $C_{L,\\mathrm{tot}} = 5\\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$\n  - 等温线：Langmuir，$q_{\\max} = 1.0\\times 10^{-2}\\,\\mathrm{mol\\,kg^{-1}}$，$K_L = 1.0\\,\\mathrm{L\\,mol^{-1}}$\n  - $C_{M,\\mathrm{tot}}$ 点：$\\left[1.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,1.0\\times 10^{-4},\\,5.0\\times 10^{-4}\\right]\\,\\mathrm{mol\\,L^{-1}}$\n\n- 用例 2（接近饱和行为，较弱络合，Langmuir）：\n  - $z_M = +2$，$z_L = -1$，$z_{ML} = +1$\n  - $\\log_{10}\\beta_1 = 0$\n  - $I_{\\mathrm{bg}} = 0.05\\,\\mathrm{mol\\,L^{-1}}$\n  - $C_{L,\\mathrm{tot}} = 1.0\\times 10^{-5}\\,\\mathrm{mol\\,L^{-1}}$\n  - 等温线：Langmuir，$q_{\\max} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$，$K_L = 1.0\\times 10^{2}\\,\\mathrm{L\\,mol^{-1}}$\n  - $C_{M,\\mathrm{tot}}$ 点：$\\left[1.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,1.0\\times 10^{-4},\\,1.0\\times 10^{-3}\\right]\\,\\mathrm{mol\\,L^{-1}}$\n\n- 用例 3（强络合，Freundlich）：\n  - $z_M = +2$，$z_L = -1$，$z_{ML} = +1$\n  - $\\log_{10}\\beta_1 = 5$\n  - $I_{\\mathrm{bg}} = 0.2\\,\\mathrm{mol\\,L^{-1}}$\n  - $C_{L,\\mathrm{tot}} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$\n  - 等温线：Freundlich，$K_F = 5.0\\times 10^{-5}\\,\\mathrm{mol\\,kg^{-1}}$，$n = 0.7$\n  - $C_{M,\\mathrm{tot}}$ 点：$\\left[1.0\\times 10^{-7},\\,1.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,1.0\\times 10^{-4}\\right]\\,\\mathrm{mol\\,L^{-1}}$\n\n- 用例 4（无配体存在，Langmuir，低离子强度）：\n  - $z_M = +2$，$z_L = -1$，$z_{ML} = +1$\n  - $\\log_{10}\\beta_1 = 2$（当 $C_{L,\\mathrm{tot}}=0$ 时无关紧要）\n  - $I_{\\mathrm{bg}} = 0.01\\,\\mathrm{mol\\,L^{-1}}$\n  - $C_{L,\\mathrm{tot}} = 0$\n  - 等温线：Langmuir，$q_{\\max} = 5.0\\times 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$，$K_L = 1.0\\times 10^{1}\\,\\mathrm{L\\,mol^{-1}}$\n  - $C_{M,\\mathrm{tot}}$ 点：$\\left[1.0\\times 10^{-6},\\,5.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,1.0\\times 10^{-4}\\right]\\,\\mathrm{mol\\,L^{-1}}$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，不含空格，并将四个测试用例的列表按上述顺序聚合。",
            "solution": "该问题要求设计并实现一个计算工作流，以确定二价金属 $M^{2+}$ 在表面上的吸附量。此过程必须严格考虑水相形态——特别是 $M^{2+}$ 与单价配体 $L^{-}$ 的络合作用——以及基于固定背景离子强度 $I_{\\mathrm{bg}}$ 的活度校正。该解决方案是从化学热力学和表面化学的第一性原理发展而来的。\n\n### 1. 理论框架\n\n#### 1.1. 水相形态与活度校正\n\n问题的核心是确定自由金属离子 $a_{M^{2+}}$ 的平衡活度，该物种直接参与吸附过程。这需要求解包含 $M^{2+}$、$L^{-}$ 和络合物 $\\mathrm{ML}^{+}$ 的体系的水相形态。\n\n**活度系数：** 物种 $i$ 的化学活度 $a_i$ 与其摩尔浓度 $C_i$ 通过 $a_i = \\gamma_i C_i$ 相关联，其中 $\\gamma_i$ 是活度系数。对于离子物种，$\\gamma_i$ 是溶液离子强度 $I$ 的函数。问题指定在 $25\\,^\\circ\\mathrm{C}$ 下使用 Davies 方程：\n$$ \\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right) $$\n其中 $z_i$ 是离子电荷，$A = 0.51$。给定背景电解质主导离子强度，因此我们可以设置 $I \\approx I_{\\mathrm{bg}}$。这简化了计算，因为对于给定的测试用例，所有物种的活度系数都变为常数。设依赖于离子强度的项为 $f(I_{\\mathrm{bg}}) = \\frac{\\sqrt{I_{\\mathrm{bg}}}}{1+\\sqrt{I_{\\mathrm{bg}}}} - 0.3 I_{\\mathrm{bg}}$。所涉及物种的活度系数则为：\n-   金属离子 $M^{2+}$ ($z_M=+2$): $\\gamma_M = 10^{-A (4) f(I_{\\mathrm{bg}})}$\n-   配体离子 $L^{-}$ ($z_L=-1$): $\\gamma_L = 10^{-A (1) f(I_{\\mathrm{bg}})}$\n-   络合离子 $\\mathrm{ML}^{+}$ ($z_{ML}=+1$): $\\gamma_{ML} = 10^{-A (1) f(I_{\\mathrm{bg}})}$\n\n注意 $\\gamma_L = \\gamma_{ML}$。对于任何中性物种，$\\gamma_i = 1$。\n\n**平衡与质量守恒：** 络合物的形成由反应 $M^{2+} + L^{-} \\rightleftharpoons \\mathrm{ML}^{+}$ 控制。以活度表示的质量作用定律定义了热力学形成常数 $\\beta_1$：\n$$ \\beta_1 = \\frac{a_{\\mathrm{ML}^{+}}}{a_{M^{2+}} a_{L^{-}}} = \\frac{\\gamma_{ML} C_{\\mathrm{ML}^{+}}}{(\\gamma_M C_{M^{2+}}) (\\gamma_L C_{L^{-}})} $$\n系统还受到总金属 $C_{M,\\mathrm{tot}}$ 和总配体 $C_{L,\\mathrm{tot}}$ 的质量守恒约束：\n$$ C_{M,\\mathrm{tot}} = C_{M^{2+}} + C_{\\mathrm{ML}^{+}} \\quad (1) $$\n$$ C_{L,\\mathrm{tot}} = C_{L^{-}} + C_{\\mathrm{ML}^{+}} \\quad (2) $$\n我们可以用总浓度和络合物浓度 $C_{\\mathrm{ML}^{+}}$ 来表示自由浓度 $C_{M^{2+}}$ 和 $C_{L^{-}}$：\n$$ C_{M^{2+}} = C_{M,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}} $$\n$$ C_{L^{-}} = C_{L,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}} $$\n将这些代入质量作用表达式，得到一个只含一个未知数 $C_{\\mathrm{ML}^{+}}$ 的方程。首先定义一个基于浓度的条件常数 $K_c$ 会很方便：\n$$ K_c = \\frac{C_{\\mathrm{ML}^{+}}}{C_{M^{2+}} C_{L^{-}}} = \\beta_1 \\frac{\\gamma_M \\gamma_L}{\\gamma_{ML}} $$\n将质量平衡关系代入此定义，得到：\n$$ K_c = \\frac{C_{\\mathrm{ML}^{+}}}{(C_{M,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}})(C_{L,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}})} $$\n重新整理此表达式，得到关于 $C_{\\mathrm{ML}^{+}}$ 的二次方程：\n$$ K_c C_{\\mathrm{ML}^{+}}^2 - [K_c(C_{M,\\mathrm{tot}} + C_{L,\\mathrm{tot}}) + 1]C_{\\mathrm{ML}^{+}} + K_c C_{M,\\mathrm{tot}}C_{L,\\mathrm{tot}} = 0 $$\n这是一个标准形式为 $ax^2 + bx + c = 0$ 的二次方程，其中 $x = C_{\\mathrm{ML}^{+}}$。系数为：\n-   $a = K_c$\n-   $b = -(K_c(C_{M,\\mathrm{tot}} + C_{L,\\mathrm{tot}}) + 1)$\n-   $c = K_c C_{M,\\mathrm{tot}}C_{L,\\mathrm{tot}}$\n对于 $C_{\\mathrm{ML}^{+}}$，物理上有意义的解（必须小于 $C_{M,\\mathrm{tot}}$ 和 $C_{L,\\mathrm{tot}}$）是两个根中较小的一个。为了避免在标准二次公式中因减去几乎相等的数而造成的数值精度损失，我们使用数值稳定的形式来求解较小的根：\n$$ C_{\\mathrm{ML}^{+}} = \\frac{2c}{-b + \\sqrt{b^2 - 4ac}} $$\n一旦求出 $C_{\\mathrm{ML}^{+}}$，自由金属离子的浓度就计算为 $C_{M^{2+}} = C_{M,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}}$。然后活度为 $a_{M^{2+}} = \\gamma_M C_{M^{2+}}$。\n\n当 $C_{L,\\mathrm{tot}} = 0$ 时，会出现一种特殊情况。在这种情况下，不发生络合作用，因此 $C_{\\mathrm{ML}^{+}} = 0$ 且 $C_{M^{2+}} = C_{M,\\mathrm{tot}}$。\n\n#### 1.2. 吸附等温线\n\n吸附量 $q$（单位为 $\\mathrm{mol\\,kg^{-1}}$）是使用自由金属离子的活度 $a_{M^{2+}}$ 作为自变量计算的。\n\n**Langmuir 等温线：** 此模型假设吸附发生在表面特定的、局域化的位点上，具有最大容量 $q_{\\max}$。它还假设所有位点都是等效的，并且吸附的分子之间没有相互作用。从吸附和解吸速率之间的平衡推导得出：\n$$ q = q_{\\max} \\frac{K_L a_{M^{2+}}}{1 + K_L a_{M^{2+}}} $$\n在这里，$K_L$ 是 Langmuir 亲和常数。问题为 $K_L$ 指定了 $\\mathrm{L\\,mol^{-1}}$ 的单位，这是一个常见的约定，即在最初为浓度推导的公式中使用活度的无量纲数值。\n\n**Freundlich 等温线：** 这是一个经验模型，描述了在具有非均匀吸附能分布的非均相表面上的吸附。它采用幂律形式：\n$$ q = K_F (a_{M^{2+}})^n $$\n其中 $K_F$ 是 Freundlich 容量参数，$n$ 是非均相因子。问题为 $K_F$ 指定的单位是 $\\mathrm{mol\\,kg^{-1}}$ “且活度无量纲”，这证实了此公式。\n\n### 2. 计算工作流\n\n总体算法通过遍历每个测试用例，并对每个用例遍历指定的总金属浓度来进行。\n\n1.  **初始化：** 对于每个测试用例，提取参数：$\\log_{10}\\beta_1$、 $I_{\\mathrm{bg}}$、 $C_{L,\\mathrm{tot}}$、等温线类型以及等温线参数（$q_{\\max}$、$K_L$ 或 $K_F$、$n$）。\n\n2.  **预计算：**\n    -   计算离子强度项 $f(I_{\\mathrm{bg}})$。\n    -   基于 $I_{\\mathrm{bg}}$ 计算活度系数 $\\gamma_M$、$\\gamma_L$ 和 $\\gamma_{ML}$。\n    -   如果 $C_{L,\\mathrm{tot}} > 0$，计算热力学常数 $\\beta_1 = 10^{\\log_{10}\\beta_1}$ 和条件常数 $K_c = \\beta_1 (\\gamma_M \\gamma_L / \\gamma_{ML})$。\n\n3.  **主循环：** 对于所提供列表中的每个点 $C_{M,\\mathrm{tot}}$：\n    a. **形态计算：**\n        -   如果 $C_{L,\\mathrm{tot}}0$，使用数值稳定公式求解关于 $C_{\\mathrm{ML}^{+}}$ 的二次方程。然后，计算 $C_{M^{2+}} = C_{M,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}}$。\n        -   如果 $C_{L,\\mathrm{tot}}=0$，设置 $C_{M^{2+}} = C_{M,\\mathrm{tot}}$。\n    b. **活度计算：** 计算自由金属离子活度：$a_{M^{2+}} = \\gamma_M C_{M^{2+}}$。\n    c. **吸附计算：** 根据该用例指定的等温线类型：\n        -   **Langmuir:** $q = q_{\\max} \\cdot (K_L a_{M^{2+}}) / (1 + K_L a_{M^{2+}})$。\n        -   **Freundlich:** $q = K_F \\cdot (a_{M^{2+}})^n$。\n    d. **存储结果：** 将计算出的吸附量 $q$ 追加到当前测试用例的列表中。\n\n4.  **最终输出：** 在处理完所有测试用例的所有 $C_{M,\\mathrm{tot}}$ 点后，将收集到的结果格式化为单个字符串：一个列表的列表，不含空格，如指定格式（例如，`[[val1,val2],[val3,val4]]`）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geochemistry problem by coupling aqueous speciation\n    with adsorption isotherm evaluation for a series of test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1\n        {\n            \"log10_beta1\": 2.0, \"I_bg\": 0.1, \"C_L_tot\": 5e-4,\n            \"isotherm\": \"langmuir\", \"params\": {\"q_max\": 1.0e-2, \"K_L\": 1.0},\n            \"C_M_tot_points\": [1.0e-6, 1.0e-5, 1.0e-4, 5.0e-4]\n        },\n        # Case 2\n        {\n            \"log10_beta1\": 0.0, \"I_bg\": 0.05, \"C_L_tot\": 1.0e-5,\n            \"isotherm\": \"langmuir\", \"params\": {\"q_max\": 1.0e-3, \"K_L\": 1.0e2},\n            \"C_M_tot_points\": [1.0e-6, 1.0e-5, 1.0e-4, 1.0e-3]\n        },\n        # Case 3\n        {\n            \"log10_beta1\": 5.0, \"I_bg\": 0.2, \"C_L_tot\": 1.0e-3,\n            \"isotherm\": \"freundlich\", \"params\": {\"K_F\": 5.0e-5, \"n\": 0.7},\n            \"C_M_tot_points\": [1.0e-7, 1.0e-6, 1.0e-5, 1.0e-4]\n        },\n        # Case 4\n        {\n            \"log10_beta1\": 2.0, \"I_bg\": 0.01, \"C_L_tot\": 0.0,\n            \"isotherm\": \"langmuir\", \"params\": {\"q_max\": 5.0e-3, \"K_L\": 1.0e1},\n            \"C_M_tot_points\": [1.0e-6, 5.0e-6, 1.0e-5, 1.0e-4]\n        }\n    ]\n\n    all_results = []\n\n    A = 0.51\n    z_M_sq, z_L_sq, z_ML_sq = 4.0, 1.0, 1.0\n\n    for case in test_cases:\n        case_results = []\n        I_bg = case[\"I_bg\"]\n        C_L_tot = case[\"C_L_tot\"]\n        \n        # Pre-compute activity coefficients and Kc\n        I_bg_sqrt = np.sqrt(I_bg)\n        f_I = (I_bg_sqrt / (1.0 + I_bg_sqrt)) - 0.3 * I_bg\n        \n        gamma_M = 10**(-A * z_M_sq * f_I)\n        \n        Kc = 0.0\n        if C_L_tot > 0:\n            gamma_L = 10**(-A * z_L_sq * f_I)\n            gamma_ML = 10**(-A * z_ML_sq * f_I) # Note: gamma_L == gamma_ML\n            beta1 = 10**case[\"log10_beta1\"]\n            Kc = beta1 * (gamma_M * gamma_L) / gamma_ML\n\n        for C_M_tot in case[\"C_M_tot_points\"]:\n            # Step 1: Aqueous Speciation\n            C_M_free = 0.0\n            if C_L_tot > 0:\n                # Solve quadratic equation for C_ML\n                # a*x^2 + b*x + c = 0 where x = C_ML\n                a = Kc\n                b = -(Kc * (C_M_tot + C_L_tot) + 1.0)\n                c = Kc * C_M_tot * C_L_tot\n                \n                # Use numerically stable formula for the smaller root\n                discriminant = b**2 - 4.0 * a * c\n                # The discriminant must be non-negative.\n                discriminant_sqrt = np.sqrt(max(0, discriminant))\n                \n                # C_ML = (-b - discriminant_sqrt) / (2.0 * a)\n                # Stable form: C_ML = (2c) / (-b + discriminant_sqrt)\n                numerator = 2.0 * c\n                denominator = -b + discriminant_sqrt\n                \n                C_ML = numerator / denominator if denominator != 0 else 0\n                \n                C_M_free = C_M_tot - C_ML\n            else: # C_L_tot == 0, no complexation\n                C_M_free = C_M_tot\n\n            # Step 2: Compute activity of the free metal ion\n            a_M_free = gamma_M * C_M_free\n            \n            # Step 3: Evaluate adsorption loading\n            q = 0.0\n            if case[\"isotherm\"] == \"langmuir\":\n                q_max = case[\"params\"][\"q_max\"]\n                K_L = case[\"params\"][\"K_L\"]\n                q = q_max * (K_L * a_M_free) / (1.0 + K_L * a_M_free)\n            elif case[\"isotherm\"] == \"freundlich\":\n                K_F = case[\"params\"][\"K_F\"]\n                n = case[\"params\"][\"n\"]\n                q = K_F * (a_M_free**n)\n            \n            case_results.append(q)\n            \n        all_results.append(case_results)\n\n    # Format the final output string exactly as required\n    sub_results_str = []\n    for res_list in all_results:\n        sub_results_str.append(f\"[{','.join(map(str, res_list))}]\")\n    \n    print(f\"[{','.join(sub_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}