{
    "hands_on_practices": [
        {
            "introduction": "郎格缪尔（Langmuir）等温线是描述单层吸附的基石模型，它将流体相中物质的浓度或压力与固体表面上被吸附物质的覆盖度联系起来。本练习旨在通过一个理想化的气-固体系，训练从基本原理推导并应用郎格缪尔等温线方程。通过计算给定实验条件下的表面覆盖度和吸附浓度，您可以巩固对该模型核心机制的理解。",
            "id": "2957509",
            "problem": "一种气态吸附物种 $A$ 与一个洁净、无孔的固体表面接触，该表面具有均匀分布的、相同的、无相互作用的吸附位点。系统温度保持在 $T=298\\ \\text{K}$。$A$ 的气相压力为 $p=0.10\\ \\text{bar}$。该吸附是在单一类型位点上发生的可逆单层过程，由以下基本平衡描述：\n$$\nA(\\text{g}) + S(\\text{site}) \\rightleftharpoons A{-}S(\\text{adsorbed}) .\n$$\n在 $T=298\\ \\text{K}$ 时，实验测定的吸附平衡参数（相对于压力定义）为 $K=5.0\\ \\text{bar}^{-1}$。表面位点密度（最大单层吸附容量）为 $\\Gamma_{\\max}=3.600\\times 10^{-6}\\ \\text{mol}\\ \\text{m}^{-2}$。\n\n从以气相活度和表面理想位点分数表示的质量作用定律出发，并对气相使用理想气体近似（标准态为 $p^{\\circ}=1\\ \\text{bar}$），推导分数覆盖度 $\\theta$ 作为 $K$ 和 $p$ 的函数表达式。然后计算：\n- 在 $p=0.10\\ \\text{bar}$ 时的分数覆盖度 $\\theta$，以及\n- 吸附的 $A$ 的表面浓度 $\\Gamma$。\n\n将 $\\theta$ 表示为纯数，$\\Gamma$ 的单位为 $\\text{mol}\\ \\text{m}^{-2}$。将最终数值结果保留四位有效数字。",
            "solution": "**第一步：分析问题与理论推导**\n\n该问题要求基于Langmuir吸附模型的基本原理，推导表面覆盖度的表达式并进行计算。Langmuir模型描述了气体分子在均质固体表面的可逆单层吸附。\n\n平衡反应为：\n$$\nA(\\text{g}) + S(\\text{site}) \\rightleftharpoons A{-}S(\\text{adsorbed})\n$$\n根据质量作用定律，热力学平衡常数 $K_{eq}$ 用物种的活度 ($a_i$) 表示：\n$$\nK_{eq} = \\frac{a_{A-S}}{a_{A(\\text{g})} \\cdot a_S}\n$$\n根据题目假设：\n- 表面物种的活度等于其位点分数。设表面覆盖度为 $\\theta$，则被占据位点的活度 $a_{A-S} = \\theta$，空位点的活度 $a_S = 1 - \\theta$。\n- 气相物种的活度是其分压 $p$ 与标准态压力 $p^{\\circ}$ 的比值：$a_{A(\\text{g})} = p/p^{\\circ}$。\n\n代入可得：\n$$\nK_{eq} = \\frac{\\theta}{\\left(\\frac{p}{p^{\\circ}}\\right)(1 - \\theta)} = \\frac{\\theta \\cdot p^{\\circ}}{p(1 - \\theta)}\n$$\n题目中给出的实用平衡参数 $K$ 定义为 $K = \\theta / [p(1-\\theta)]$，其单位为压力的倒数。它与无量纲的热力学平衡常数 $K_{eq}$ 的关系是 $K_{eq} = K \\cdot p^{\\circ}$。\n\n我们的任务是推导 $\\theta$ 作为 $K$ 和 $p$ 的函数。从 $K$ 的定义出发：\n$$\nK = \\frac{\\theta}{p(1 - \\theta)}\n$$\n整理上式以求解 $\\theta$：\n$$\nK p(1 - \\theta) = \\theta\n$$\n$$\nK p - K p \\theta = \\theta\n$$\n$$\nK p = \\theta(1 + K p)\n$$\n由此得到Langmuir等温线方程：\n$$\n\\theta = \\frac{K p}{1 + K p}\n$$\n这就是所要求的表达式。\n\n**第二步：数值计算**\n\n根据给定的实验条件进行计算：\n- 压力 $p = 0.10 \\text{ bar}$\n- 平衡参数 $K = 5.0 \\text{ bar}^{-1}$\n- 最大吸附容量 $\\Gamma_{\\max} = 3.600 \\times 10^{-6} \\text{ mol}\\ \\text{m}^{-2}$\n\n计算分数覆盖度 $\\theta$：\n$$\n\\theta = \\frac{(5.0 \\text{ bar}^{-1})(0.10 \\text{ bar})}{1 + (5.0 \\text{ bar}^{-1})(0.10 \\text{ bar})} = \\frac{0.50}{1 + 0.50} = \\frac{0.50}{1.50} = \\frac{1}{3}\n$$\n保留四位有效数字，$\\theta \\approx 0.3333$。\n\n计算吸附物种的表面浓度 $\\Gamma$。它等于分数覆盖度 $\\theta$ 与最大单层吸附容量 $\\Gamma_{\\max}$ 的乘积：\n$$\n\\Gamma = \\theta \\cdot \\Gamma_{\\max}\n$$\n$$\n\\Gamma = \\left(\\frac{1}{3}\\right) \\cdot (3.600 \\times 10^{-6} \\text{ mol}\\ \\text{m}^{-2}) = 1.200 \\times 10^{-6} \\text{ mol}\\ \\text{m}^{-2}\n$$\n结果已表示为四位有效数字。\n\n**最终结果：**\n- 分数覆盖度 $\\theta = 0.3333$ (无量纲)\n- 表面浓度 $\\Gamma = 1.200 \\times 10^{-6} \\text{ mol}\\ \\text{m}^{-2}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3333  1.200 \\times 10^{-6} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了基本模型后，本练习将带您进入一个更符合地球化学实际的场景：比较不同矿物对溶质的吸附能力。实验数据通常以每单位质量吸附剂的吸附量来报告，但要进行有意义的物性比较，必须将数据归一化到单位表面积。本练习将指导您完成这一关键的单位转换，从而揭示矿物表面真实的反应活性差异，这对于评估污染物在不同地质介质中的迁移至关重要。",
            "id": "4101175",
            "problem": "在低离子强度和温度 $T = 298\\,\\mathrm{K}$ 的条件下，一种稀释的、一价的吸附质在两种羟基氧化铁矿物上的水相吸附，可以用平衡状态下的单位点 Langmuir 机理很好地描述。这两种粉末具有不同的 Brunauer–Emmett–Teller (BET) 比表面积 (SSA) 和不同的质量归一化饱和吸附容量。针对每种矿物，给出以下按质量报告的实验数据：\n\n- 矿物 A：BET 比表面积 $S_{A} = 22\\,\\mathrm{m^{2}\\,g^{-1}}$，质量归一化饱和吸附容量 $q_{\\max}^{m}(A) = 1.2 \\times 10^{-3}\\,\\mathrm{mol\\,g^{-1}}$，以及质量作用平衡常数 $K_{A} = 4.0 \\times 10^{2}\\,\\mathrm{L\\,mol^{-1}}$。\n- 矿物 B：BET 比表面积 $S_{B} = 3.0 \\times 10^{2}\\,\\mathrm{m^{2}\\,g^{-1}}$，质量归一化饱和吸附容量 $q_{\\max}^{m}(B) = 3.0 \\times 10^{-3}\\,\\mathrm{mol\\,g^{-1}}$，以及质量作用平衡常数 $K_{B} = 3.0 \\times 10^{2}\\,\\mathrm{L\\,mol^{-1}}$。\n\n假设水相中吸附质浓度为 $C = 1.0 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$ 且混合均匀，阿伏伽德罗常数 $N_{A} = 6.022 \\times 10^{23}\\,\\mathrm{mol^{-1}}$，几何转换关系为 $1\\,\\mathrm{m^{2}} = 10^{18}\\,\\mathrm{nm^{2}}$。\n\n从化学吸附平衡的第一性原理和基本的几何转换出发，通过对基于质量的量进行一致的转换，确定矿物 A 和矿物 B 的面积归一化吸附载量（以“分子/平方纳米”为单位）。然后，在给定的浓度 $C$ 下，计算矿物 A 的面积归一化载量与矿物 B 的面积归一化载量之比，即无量纲比率 $R$。将最终比率四舍五入至四位有效数字。最终答案只提供 $R$ 的值（无单位）。",
            "solution": "该问题要求计算在给定浓度下，两种不同矿物上吸附质的面积归一化载量之比。这需要首先使用Langmuir吸附等温线计算每种矿物的质量归一化吸附量，然后利用比表面积进行单位转换。\n\n**第一步：计算质量归一化吸附量 ($q^m$)**\n\nLangmuir吸附等温线描述了吸附量 $q^m$ (单位 $\\mathrm{mol\\,g^{-1}}$) 与溶液浓度 $C$ (单位 $\\mathrm{mol\\,L^{-1}}$) 的关系：\n$$q^m = q_{\\max}^{m} \\frac{K C}{1 + K C}$$\n其中 $q_{\\max}^{m}$ 是质量归一化饱和吸附容量 ($\\mathrm{mol\\,g^{-1}}$)，$K$ 是平衡常数 ($\\mathrm{L\\,mol^{-1}}$)。\n给定浓度 $C = 1.0 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$。\n\n对于矿物 A：\n- $K_A C = (4.0 \\times 10^{2}\\,\\mathrm{L\\,mol^{-1}}) \\times (1.0 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}) = 0.04$\n- $q_m(A) = (1.2 \\times 10^{-3}\\,\\mathrm{mol\\,g^{-1}}) \\frac{0.04}{1 + 0.04} = (1.2 \\times 10^{-3}) \\frac{0.04}{1.04}\\,\\mathrm{mol\\,g^{-1}}$\n\n对于矿物 B：\n- $K_B C = (3.0 \\times 10^{2}\\,\\mathrm{L\\,mol^{-1}}) \\times (1.0 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}) = 0.03$\n- $q_m(B) = (3.0 \\times 10^{-3}\\,\\mathrm{mol\\,g^{-1}}) \\frac{0.03}{1 + 0.03} = (3.0 \\times 10^{-3}) \\frac{0.03}{1.03}\\,\\mathrm{mol\\,g^{-1}}$\n\n**第二步：计算面积归一化吸附载量之比 ($R$)**\n\n面积归一化吸附载量 $\\Gamma$ 的单位是“分子/平方纳米”。其与质量归一化吸附量 $q^m$ 的关系为：\n$$\\Gamma \\left[\\frac{\\mathrm{molecules}}{\\mathrm{nm}^2}\\right] = \\frac{q^m \\left[\\frac{\\mathrm{mol}}{\\mathrm{g}}\\right] \\times N_A \\left[\\frac{\\mathrm{molecules}}{\\mathrm{mol}}\\right]}{S \\left[\\frac{\\mathrm{m}^2}{\\mathrm{g}}\\right] \\times 10^{18} \\left[\\frac{\\mathrm{nm}^2}{\\mathrm{m}^2}\\right]}$$\n我们要求解的比率 $R$ 是 $\\Gamma_A / \\Gamma_B$：\n$$R = \\frac{\\Gamma_A}{\\Gamma_B} = \\frac{\\frac{q_m(A) \\cdot N_A}{S_A \\cdot 10^{18}}}{\\frac{q_m(B) \\cdot N_A}{S_B \\cdot 10^{18}}}$$\n常数 $N_A$ 和 $10^{18}$ 在比值中相消，得到：\n$$R = \\frac{q_m(A)}{q_m(B)} \\times \\frac{S_B}{S_A}$$\n将第一步中 $q_m(A)$ 和 $q_m(B)$ 的表达式代入：\n$$R = \\frac{q_{\\max}^{m}(A) \\frac{K_A C}{1 + K_A C}}{q_{\\max}^{m}(B) \\frac{K_B C}{1 + K_B C}} \\times \\frac{S_B}{S_A}$$\n整理后得到：\n$$R = \\frac{q_{\\max}^{m}(A)}{q_{\\max}^{m}(B)} \\times \\frac{K_A}{K_B} \\times \\frac{1 + K_B C}{1 + K_A C} \\times \\frac{S_B}{S_A}$$\n现在代入所有已知数值：\n- $q_{\\max}^{m}(A) = 1.2 \\times 10^{-3}\\,\\mathrm{mol\\,g^{-1}}$\n- $q_{\\max}^{m}(B) = 3.0 \\times 10^{-3}\\,\\mathrm{mol\\,g^{-1}}$\n- $K_A = 4.0 \\times 10^{2}\\,\\mathrm{L\\,mol^{-1}}$\n- $K_B = 3.0 \\times 10^{2}\\,\\mathrm{L\\,mol^{-1}}$\n- $S_A = 22\\,\\mathrm{m^{2}\\,g^{-1}}$\n- $S_B = 3.0 \\times 10^{2}\\,\\mathrm{m^{2}\\,g^{-1}}$\n- $1 + K_A C = 1 + 0.04 = 1.04$\n- $1 + K_B C = 1 + 0.03 = 1.03$\n\n代入表达式中：\n$$R = \\left(\\frac{1.2 \\times 10^{-3}}{3.0 \\times 10^{-3}}\\right) \\times \\left(\\frac{4.0 \\times 10^{2}}{3.0 \\times 10^{2}}\\right) \\times \\left(\\frac{1.03}{1.04}\\right) \\times \\left(\\frac{3.0 \\times 10^{2}}{22}\\right)$$\n$$R = (0.4) \\times \\left(\\frac{4}{3}\\right) \\times \\left(\\frac{1.03}{1.04}\\right) \\times \\left(\\frac{300}{22}\\right)$$\n$$R = \\frac{0.4 \\times 4 \\times 1.03 \\times 300}{3 \\times 1.04 \\times 22} = \\frac{494.4}{68.64}$$\n$$R \\approx 7.2027972$$\n按要求四舍五入至四位有效数字，得到 $R \\approx 7.203$。",
            "answer": "$$\\boxed{7.203}$$"
        },
        {
            "introduction": "最后的实践从孤立的计算转向综合的计算工作流，这是现代计算地球化学的一项核心技能。在真实水溶液体系中，吸附物质的化学活性会受到络合反应和离子强度的显著影响，因此不能简单地使用总浓度。本练习要求您编写一个程序，将水相化学形态计算（包括活度校正和络合平衡）与吸附等温线模型耦合起来，从而实现对表面负载量更准确、更真实的预测。",
            "id": "4101149",
            "problem": "您的任务是设计并实现一个计算工作流，在每个本体浓度点将水相形态与吸附等温线评估相结合，以便在存在单价配体和背景电解质的情况下，正确处理二价金属的络合和活度校正。实现必须是一个完整、可运行的程序。\n\n从化学热力学和表面化学的基本原理出发，不使用简化公式，并遵循以下原则：\n- 物种 $i$ 的化学活度 $a_i$ 定义为 $a_i = \\gamma_i \\, C_i$，其中 $\\gamma_i$ 是活度系数，$C_i$ 是摩尔浓度，单位为 $\\mathrm{mol\\,L^{-1}}$。对于电荷为 $z_i$、离子强度为 $I$ 的水合离子，其活度系数 $\\gamma_i$ 可在 $25\\,^\\circ\\mathrm{C}$ 下使用 Davies 方程获得：$\\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right)$，其中 $A = 0.51$。对于中性物种，使用 $\\gamma_i = 1$。\n- 应用质量作用定律计算金属-配体络合物的形成。设金属为 $M^{2+}$（电荷 $z_M=+2$），配体为 $L^{-}$（电荷 $z_L=-1$），络合物为 $\\mathrm{ML}^{+}$（电荷 $z_{ML}=+1$）。以活度表示的形成常数在 $25\\,^\\circ\\mathrm{C}$ 下定义为 $\\beta_1 = \\dfrac{a_{\\mathrm{ML}^{+}}}{a_{M^{2+}}\\,a_{L^{-}}}$。将 $\\beta_1$ 视为以 10 为底的对数形式给出，并进行适当转换。仅对 $M$ 和 $L$ 使用质量守恒约束：$C_{M,\\mathrm{tot}} = C_{M^{2+}} + C_{\\mathrm{ML}^{+}}$ 和 $C_{L,\\mathrm{tot}} = C_{L^{-}} + C_{\\mathrm{ML}^{+}}$。假设背景电解质主导离子强度，因此 $I \\approx I_{\\mathrm{bg}}$，从而活度系数是固定 $I_{\\mathrm{bg}}$ 的函数。\n- 对于吸附，从表面过剩量和位点占据率的定义出发，使用自由金属离子的活度 $a_{M^{2+}}$ 作为吸附物种，推导 Langmuir 和 Freundlich 等温线的数学一致性表达式。在您的推导中，不要假定预先给定的等温线方程；而是应基于理想的局域吸附位点（Langmuir）和导致幂律关系（Freundlich）的非均相吸附能的假设来构建它们。在您的实现中，使用推导出的形式以及测试套件中提供的参数。\n\n您的程序必须：\n1. 在每个指定的总金属浓度点 $C_{M,\\mathrm{tot}}$（单位为 $\\mathrm{mol\\,L^{-1}}$）下，根据所述假设计算水相形态，包括在固定离子强度 $I_{\\mathrm{bg}}$（单位为 $\\mathrm{mol\\,L^{-1}}$）下的络合和活度校正。使用以活度表示的质量作用定律和质量平衡来求解 $C_{\\mathrm{ML}^{+}}$、$C_{M^{2+}}$ 和 $C_{L^{-}}$。\n2. 根据浓度和活度系数计算活度 $a_{M^{2+}}$。\n3. 使用活度 $a_{M^{2+}}$ 作为自变量，为所选等温线评估表面上的吸附载荷。对于 Langmuir 情况，使用容量参数 $q_{\\max}$（单位为 $\\mathrm{mol\\,kg^{-1}}$）和亲和参数 $K_L$（单位为 $\\mathrm{L\\,mol^{-1}}$）。对于 Freundlich 情况，使用 $K_F$（单位为 $\\mathrm{mol\\,kg^{-1}}$，活度无量纲）和指数 $n$（无量纲）。\n4. 对于每个测试用例，返回与提供的 $C_{M,\\mathrm{tot}}$ 点列表相对应的吸附载荷列表。\n\n物理单位和输出规范：\n- 使用 $C_{M,\\mathrm{tot}}$ 和 $C_{L,\\mathrm{tot}}$ 的单位为 $\\mathrm{mol\\,L^{-1}}$，离子强度 $I_{\\mathrm{bg}}$ 的单位为 $\\mathrm{mol\\,L^{-1}}$，并以 $\\mathrm{mol\\,kg^{-1}}$ 为单位报告吸附载荷。\n- 所有活度均为无量纲，标准态取为 $1\\,\\mathrm{mol\\,L^{-1}}$。\n- 您的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果本身是一个浮点数列表，表示吸附载荷，并根据提供的 $C_{M,\\mathrm{tot}}$ 点排序。输出中不得有空格。例如：“[[x1,x2],[y1,y2]]”。\n\n测试套件：\n实现您的程序以处理以下四个测试用例，每个用例都由参数和 $C_{M,\\mathrm{tot}}$ 点的向量定义：\n\n- 情况 1（通用，中等络合，Langmuir）：\n  - $z_M = +2$, $z_L = -1$, $z_{ML} = +1$\n  - $\\log_{10}\\beta_1 = 2$\n  - $I_{\\mathrm{bg}} = 0.1\\,\\mathrm{mol\\,L^{-1}}$\n  - $C_{L,\\mathrm{tot}} = 5\\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$\n  - 等温线：Langmuir，其中 $q_{\\max} = 1.0\\times 10^{-2}\\,\\mathrm{mol\\,kg^{-1}}$，$K_L = 1.0\\,\\mathrm{L\\,mol^{-1}}$\n  - $C_{M,\\mathrm{tot}}$ 点：$\\left[1.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,1.0\\times 10^{-4},\\,5.0\\times 10^{-4}\\right]\\,\\mathrm{mol\\,L^{-1}}$\n\n- 情况 2（接近饱和行为，较弱络合，Langmuir）：\n  - $z_M = +2$, $z_L = -1$, $z_{ML} = +1$\n  - $\\log_{10}\\beta_1 = 0$\n  - $I_{\\mathrm{bg}} = 0.05\\,\\mathrm{mol\\,L^{-1}}$\n  - $C_{L,\\mathrm{tot}} = 1.0\\times 10^{-5}\\,\\mathrm{mol\\,L^{-1}}$\n  - 等温线：Langmuir，其中 $q_{\\max} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$，$K_L = 1.0\\times 10^{2}\\,\\mathrm{L\\,mol^{-1}}$\n  - $C_{M,\\mathrm{tot}}$ 点：$\\left[1.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,1.0\\times 10^{-4},\\,1.0\\times 10^{-3}\\right]\\,\\mathrm{mol\\,L^{-1}}$\n\n- 情况 3（强络合，Freundlich）：\n  - $z_M = +2$, $z_L = -1$, $z_{ML} = +1$\n  - $\\log_{10}\\beta_1 = 5$\n  - $I_{\\mathrm{bg}} = 0.2\\,\\mathrm{mol\\,L^{-1}}$\n  - $C_{L,\\mathrm{tot}} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$\n  - 等温线：Freundlich，其中 $K_F = 5.0\\times 10^{-5}\\,\\mathrm{mol\\,kg^{-1}}$，$n = 0.7$\n  - $C_{M,\\mathrm{tot}}$ 点：$\\left[1.0\\times 10^{-7},\\,1.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,1.0\\times 10^{-4}\\right]\\,\\mathrm{mol\\,L^{-1}}$\n\n- 情况 4（无配体存在，Langmuir，低离子强度）：\n  - $z_M = +2$, $z_L = -1$, $z_{ML} = +1$\n  - $\\log_{10}\\beta_1 = 2$（当 $C_{L,\\mathrm{tot}}=0$ 时不相关）\n  - $I_{\\mathrm{bg}} = 0.01\\,\\mathrm{mol\\,L^{-1}}$\n  - $C_{L,\\mathrm{tot}} = 0$\n  - 等温线：Langmuir，其中 $q_{\\max} = 5.0\\times 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$，$K_L = 1.0\\times 10^{1}\\,\\mathrm{L\\,mol^{-1}}$\n  - $C_{M,\\mathrm{tot}}$ 点：$\\left[1.0\\times 10^{-6},\\,5.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,1.0\\times 10^{-4}\\right]\\,\\mathrm{mol\\,L^{-1}}$\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，且不含空格，将四个测试用例的列表按上述顺序聚合。",
            "solution": "该问题要求设计并实现一个计算工作流，以确定二价金属 $M^{2+}$ 在表面上的吸附载荷。此过程必须严格考虑水相形态——特别是 $M^{2+}$ 与单价配体 $L^{-}$ 的络合——以及基于固定背景离子强度 $I_{\\mathrm{bg}}$ 的活度校正。该解决方案是从化学热力学和表面化学的第一性原理发展而来的。\n\n### 1. 理论框架\n\n#### 1.1. 水相形态与活度校正\n\n问题的核心是确定自由金属离子 $a_{M^{2+}}$ 的平衡活度，该物种直接参与吸附过程。这需要求解包含 $M^{2+}$、$L^{-}$ 和络合物 $\\mathrm{ML}^{+}$ 的系统的水相形态。\n\n**活度系数：** 物种 $i$ 的化学活度 $a_i$ 与其摩尔浓度 $C_i$ 的关系为 $a_i = \\gamma_i C_i$，其中 $\\gamma_i$ 是活度系数。对于离子物种，$\\gamma_i$ 是溶液离子强度 $I$ 的函数。问题指定在 $25\\,^\\circ\\mathrm{C}$ 下使用 Davies 方程：\n$$ \\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right) $$\n其中 $z_i$ 是离子电荷，$A = 0.51$。题目给定背景电解质主导离子强度，因此我们可以设置 $I \\approx I_{\\mathrm{bg}}$。这简化了计算，因为对于给定的测试用例，所有物种的活度系数都变为常数。设依赖于离子强度的项为 $f(I_{\\mathrm{bg}}) = \\frac{\\sqrt{I_{\\mathrm{bg}}}}{1+\\sqrt{I_{\\mathrm{bg}}}} - 0.3 I_{\\mathrm{bg}}$。所涉及物种的活度系数则为：\n-   金属离子 $M^{2+}$ ($z_M=+2$): $\\gamma_M = 10^{-A (4) f(I_{\\mathrm{bg}})}$\n-   配体离子 $L^{-}$ ($z_L=-1$): $\\gamma_L = 10^{-A (1) f(I_{\\mathrm{bg}})}$\n-   络合物离子 $\\mathrm{ML}^{+}$ ($z_{ML}=+1$): $\\gamma_{ML} = 10^{-A (1) f(I_{\\mathrm{bg}})}$\n\n注意 $\\gamma_L = \\gamma_{ML}$。对于任何中性物种，$\\gamma_i = 1$。\n\n**平衡与质量平衡：** 络合物的形成由反应 $M^{2+} + L^{-} \\rightleftharpoons \\mathrm{ML}^{+}$ 控制。以活度表示的质量作用定律定义了热力学形成常数 $\\beta_1$：\n$$ \\beta_1 = \\frac{a_{\\mathrm{ML}^{+}}}{a_{M^{2+}} a_{L^{-}}} = \\frac{\\gamma_{ML} C_{\\mathrm{ML}^{+}}}{(\\gamma_M C_{M^{2+}}) (\\gamma_L C_{L^{-}})} $$\n该系统还受总金属浓度 $C_{M,\\mathrm{tot}}$ 和总配体浓度 $C_{L,\\mathrm{tot}}$ 的质量守恒约束：\n$$ C_{M,\\mathrm{tot}} = C_{M^{2+}} + C_{\\mathrm{ML}^{+}} \\quad (1) $$\n$$ C_{L,\\mathrm{tot}} = C_{L^{-}} + C_{\\mathrm{ML}^{+}} \\quad (2) $$\n我们可以用总浓度和络合物浓度 $C_{\\mathrm{ML}^{+}}$ 来表示自由浓度 $C_{M^{2+}}$ 和 $C_{L^{-}}$：\n$$ C_{M^{2+}} = C_{M,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}} $$\n$$ C_{L^{-}} = C_{L,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}} $$\n将这些代入质量作用表达式，得到一个只含一个未知数 $C_{\\mathrm{ML}^{+}}$ 的方程。首先定义一个基于浓度的条件常数 $K_c$ 会很方便：\n$$ K_c = \\frac{C_{\\mathrm{ML}^{+}}}{C_{M^{2+}} C_{L^{-}}} = \\beta_1 \\frac{\\gamma_M \\gamma_L}{\\gamma_{ML}} $$\n将质量平衡关系代入此定义中，得到：\n$$ K_c = \\frac{C_{\\mathrm{ML}^{+}}}{(C_{M,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}})(C_{L,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}})} $$\n重新整理此表达式可得到关于 $C_{\\mathrm{ML}^{+}}$ 的二次方程：\n$$ K_c C_{\\mathrm{ML}^{+}}^2 - [K_c(C_{M,\\mathrm{tot}} + C_{L,\\mathrm{tot}}) + 1]C_{\\mathrm{ML}^{+}} + K_c C_{M,\\mathrm{tot}}C_{L,\\mathrm{tot}} = 0 $$\n这是一个标准形式为 $ax^2 + bx + c = 0$ 的二次方程，其中 $x = C_{\\mathrm{ML}^{+}}$。系数为：\n-   $a = K_c$\n-   $b = -(K_c(C_{M,\\mathrm{tot}} + C_{L,\\mathrm{tot}}) + 1)$\n-   $c = K_c C_{M,\\mathrm{tot}}C_{L,\\mathrm{tot}}$\n对于 $C_{\\mathrm{ML}^{+}}$（其值必须小于 $C_{M,\\mathrm{tot}}$ 和 $C_{L,\\mathrm{tot}}$），物理上有意义的解是两个根中较小的一个。为了避免在标准二次公式中因减去几乎相等的数而导致数值精度损失，我们使用数值上稳定的小根公式：\n$$ C_{\\mathrm{ML}^{+}} = \\frac{2c}{-b + \\sqrt{b^2 - 4ac}} $$\n一旦求出 $C_{\\mathrm{ML}^{+}}$，自由金属离子的浓度就计算为 $C_{M^{2+}} = C_{M,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}}$。然后活度为 $a_{M^{2+}} = \\gamma_M C_{M^{2+}}$。\n\n当 $C_{L,\\mathrm{tot}} = 0$ 时会出现一个特殊情况。在这种情况下，不发生络合，因此 $C_{\\mathrm{ML}^{+}} = 0$ 且 $C_{M^{2+}} = C_{M,\\mathrm{tot}}$。\n\n#### 1.2. 吸附等温线\n\n吸附载荷 $q$（单位为 $\\mathrm{mol\\,kg^{-1}}$）使用自由金属离子的活度 $a_{M^{2+}}$ 作为自变量计算。\n\n**Langmuir 等温线：** 该模型假设吸附发生在表面特定的、局域的位点上，具有最大容量 $q_{\\max}$。它还假设所有位点都是等效的，并且吸附的分子之间没有相互作用。从吸附和解吸速率之间的平衡推导得出：\n$$ q = q_{\\max} \\frac{K_L a_{M^{2+}}}{1 + K_L a_{M^{2+}}} $$\n这里，$K_L$ 是 Langmuir 亲和常数。问题中规定 $K_L$ 的单位为 $\\mathrm{L\\,mol^{-1}}$，这是一个常见的约定，即在最初为浓度推导的公式中使用活度的无量纲数值。\n\n**Freundlich 等温线：** 这是一个描述在具有非均匀吸附能分布的非均相表面上吸附的经验模型。它采用幂律形式：\n$$ q = K_F (a_{M^{2+}})^n $$\n其中 $K_F$ 是 Freundlich 容量参数，$n$ 是非均相因子。问题中规定 $K_F$ 的单位为 $\\mathrm{mol\\,kg^{-1}}$，“活度无量纲”，这证实了此公式。\n\n### 2. 计算工作流\n\n总体算法通过遍历每个测试用例进行，对于每个用例，再遍历指定的总金属浓度。\n\n1.  **初始化：** 对于每个测试用例，提取参数：$\\log_{10}\\beta_1$、$I_{\\mathrm{bg}}$、$C_{L,\\mathrm{tot}}$、等温线类型和等温线参数（$q_{\\max}$、$K_L$ 或 $K_F$、$n$）。\n\n2.  **预计算：**\n    -   计算离子强度项 $f(I_{\\mathrm{bg}})$。\n    -   基于 $I_{\\mathrm{bg}}$ 计算活度系数 $\\gamma_M$、$\\gamma_L$ 和 $\\gamma_{ML}$。\n    -   如果 $C_{L,\\mathrm{tot}}  0$，计算热力学常数 $\\beta_1 = 10^{\\log_{10}\\beta_1}$ 和条件常数 $K_c = \\beta_1 (\\gamma_M \\gamma_L / \\gamma_{ML})$。\n\n3.  **主循环：** 对于所提供列表中的每个点 $C_{M,\\mathrm{tot}}$：\n    a. **形态计算：**\n        -   如果 $C_{L,\\mathrm{tot}}0$，使用数值稳定公式求解关于 $C_{\\mathrm{ML}^{+}}$ 的二次方程。然后，计算 $C_{M^{2+}} = C_{M,\\mathrm{tot}} - C_{\\mathrm{ML}^{+}}$。\n        -   如果 $C_{L,\\mathrm{tot}}=0$，则设置 $C_{M^{2+}} = C_{M,\\mathrm{tot}}$。\n    b. **活度计算：** 计算自由金属离子活度：$a_{M^{2+}} = \\gamma_M C_{M^{2+}}$。\n    c. **吸附计算：** 根据该案例指定的等温线类型：\n        -   **Langmuir：** $q = q_{\\max} \\cdot (K_L a_{M^{2+}}) / (1 + K_L a_{M^{2+}})$。\n        -   **Freundlich：** $q = K_F \\cdot (a_{M^{2+}})^n$。\n    d. **存储结果：** 将计算出的载荷 $q$ 追加到当前测试用例的列表中。\n\n4.  **最终输出：** 在处理完所有测试用例的所有 $C_{M,\\mathrm{tot}}$ 点后，将收集到的结果格式化为单个字符串：一个列表的列表，不含空格，如指定格式（例如，`[[val1,val2],[val3,val4]]`）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geochemistry problem by coupling aqueous speciation\n    with adsorption isotherm evaluation for a series of test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1\n        {\n            \"log10_beta1\": 2.0, \"I_bg\": 0.1, \"C_L_tot\": 5e-4,\n            \"isotherm\": \"langmuir\", \"params\": {\"q_max\": 1.0e-2, \"K_L\": 1.0},\n            \"C_M_tot_points\": [1.0e-6, 1.0e-5, 1.0e-4, 5.0e-4]\n        },\n        # Case 2\n        {\n            \"log10_beta1\": 0.0, \"I_bg\": 0.05, \"C_L_tot\": 1.0e-5,\n            \"isotherm\": \"langmuir\", \"params\": {\"q_max\": 1.0e-3, \"K_L\": 1.0e2},\n            \"C_M_tot_points\": [1.0e-6, 1.0e-5, 1.0e-4, 1.0e-3]\n        },\n        # Case 3\n        {\n            \"log10_beta1\": 5.0, \"I_bg\": 0.2, \"C_L_tot\": 1.0e-3,\n            \"isotherm\": \"freundlich\", \"params\": {\"K_F\": 5.0e-5, \"n\": 0.7},\n            \"C_M_tot_points\": [1.0e-7, 1.0e-6, 1.0e-5, 1.0e-4]\n        },\n        # Case 4\n        {\n            \"log10_beta1\": 2.0, \"I_bg\": 0.01, \"C_L_tot\": 0.0,\n            \"isotherm\": \"langmuir\", \"params\": {\"q_max\": 5.0e-3, \"K_L\": 1.0e1},\n            \"C_M_tot_points\": [1.0e-6, 5.0e-6, 1.0e-5, 1.0e-4]\n        }\n    ]\n\n    all_results = []\n\n    A = 0.51\n    z_M_sq, z_L_sq, z_ML_sq = 4.0, 1.0, 1.0\n\n    for case in test_cases:\n        case_results = []\n        I_bg = case[\"I_bg\"]\n        C_L_tot = case[\"C_L_tot\"]\n        \n        # Pre-compute activity coefficients and Kc\n        I_bg_sqrt = np.sqrt(I_bg)\n        f_I = (I_bg_sqrt / (1.0 + I_bg_sqrt)) - 0.3 * I_bg\n        \n        gamma_M = 10**(-A * z_M_sq * f_I)\n        \n        Kc = 0.0\n        if C_L_tot > 0:\n            gamma_L = 10**(-A * z_L_sq * f_I)\n            gamma_ML = 10**(-A * z_ML_sq * f_I) # Note: gamma_L == gamma_ML\n            beta1 = 10**case[\"log10_beta1\"]\n            Kc = beta1 * (gamma_M * gamma_L) / gamma_ML\n\n        for C_M_tot in case[\"C_M_tot_points\"]:\n            # Step 1: Aqueous Speciation\n            C_M_free = 0.0\n            if C_L_tot > 0:\n                # Solve quadratic equation for C_ML\n                # a*x^2 + b*x + c = 0 where x = C_ML\n                a = Kc\n                b = -(Kc * (C_M_tot + C_L_tot) + 1.0)\n                c = Kc * C_M_tot * C_L_tot\n                \n                # Use numerically stable formula for the smaller root\n                discriminant = b**2 - 4.0 * a * c\n                # The discriminant must be non-negative.\n                discriminant_sqrt = np.sqrt(max(0, discriminant))\n                \n                # C_ML = (-b - discriminant_sqrt) / (2.0 * a)\n                # Stable form: C_ML = (2c) / (-b + discriminant_sqrt)\n                numerator = 2.0 * c\n                denominator = -b + discriminant_sqrt\n                \n                C_ML = numerator / denominator if denominator != 0 else 0\n                \n                C_M_free = C_M_tot - C_ML\n            else: # C_L_tot == 0, no complexation\n                C_M_free = C_M_tot\n\n            # Step 2: Compute activity of the free metal ion\n            a_M_free = gamma_M * C_M_free\n            \n            # Step 3: Evaluate adsorption loading\n            q = 0.0\n            if case[\"isotherm\"] == \"langmuir\":\n                q_max = case[\"params\"][\"q_max\"]\n                K_L = case[\"params\"][\"K_L\"]\n                q = q_max * (K_L * a_M_free) / (1.0 + K_L * a_M_free)\n            elif case[\"isotherm\"] == \"freundlich\":\n                K_F = case[\"params\"][\"K_F\"]\n                n = case[\"params\"][\"n\"]\n                q = K_F * (a_M_free**n)\n            \n            case_results.append(q)\n            \n        all_results.append(case_results)\n\n    # Format the final output string exactly as required\n    sub_results_str = []\n    for res_list in all_results:\n        sub_results_str.append(f\"[{','.join(map(str, res_list))}]\")\n    \n    print(f\"[{','.join(sub_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}