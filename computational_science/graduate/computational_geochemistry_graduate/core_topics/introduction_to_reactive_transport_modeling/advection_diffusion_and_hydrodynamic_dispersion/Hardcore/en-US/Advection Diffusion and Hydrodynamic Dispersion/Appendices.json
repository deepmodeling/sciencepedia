{
    "hands_on_practices": [
        {
            "introduction": "Understanding solute transport begins with the Advection-Dispersion Equation (ADE). This exercise guides you through the fundamental process of nondimensionalization to reveal the Péclet number, $Pe$, a critical dimensionless group that governs transport behavior . By calculating $Pe$ for a hypothetical aquifer, you will learn to quantitatively classify whether a system is dominated by advection (bulk flow) or dispersion (spreading), a core skill in hydrogeology and environmental assessment.",
            "id": "4096509",
            "problem": "A saturated, homogeneous, one-dimensional aquifer of length scale $L$ transports a conservative, nonreactive solute under steady flow. The governing statement of mass conservation combined with Fickian hydrodynamic dispersion gives the Advection–Dispersion Equation (ADE): a balance between advective flux driven by the average linear pore-water velocity and dispersive flux parameterized by a longitudinal dispersion coefficient. Starting from this fundamental base, first perform a rigorous nondimensionalization of the ADE to identify the dimensionless ratio that measures the relative importance of advection to dispersion. Then, for the aquifer described below, evaluate that ratio and use its magnitude to classify the transport regime as advection-dominated or dispersion-dominated.\n\nAquifer and solute transport properties:\n- Hydraulic conductivity $K = 1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- Hydraulic gradient $i = 1.0 \\times 10^{-2}$.\n- Effective porosity $\\phi = 0.25$.\n- Representative longitudinal length scale $L = 5.00 \\times 10^{2}\\,\\mathrm{m}$.\n- Longitudinal dispersivity $\\alpha_{L} = 8.0\\,\\mathrm{m}$.\n- Molecular diffusion coefficient in water $D_{m} = 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n\nAssume constant properties and one-dimensional transport aligned with the hydraulic gradient. Use Darcy’s law to relate the Darcy flux to hydraulic conductivity and gradient, and the standard relation between Darcy flux and average linear pore-water velocity. Model the longitudinal hydrodynamic dispersion coefficient as the sum of mechanical dispersion and molecular diffusion, with $D = D_{m} + \\alpha_{L}\\,u$, where $u$ is the average linear velocity.\n\nReport the dimensionless ratio you obtain from nondimensionalization as a single number for this aquifer. This ratio is dimensionless; express the final answer without units and round to four significant figures. Use your computed value to classify the transport regime, but note that only the dimensionless number is required as the final answer.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. It is a standard problem in transport hydrogeology and is free of any invalidating flaws. We may therefore proceed with a full solution.\n\nThe problem asks for the derivation of a dimensionless number from the one-dimensional Advection-Dispersion Equation (ADE) and its subsequent calculation for a specified aquifer system.\n\nFirst, we establish the governing equation. The conservation of mass for a conservative solute with concentration $C$ in a one-dimensional domain is expressed by the continuity equation:\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0\n$$\nwhere $t$ is time, $x$ is the spatial coordinate, and $J$ is the total solute flux. The total flux is composed of an advective component, $J_{\\text{adv}}$, and a dispersive component, $J_{\\text{disp}}$.\n\nThe advective flux is due to transport with the mean flow of the fluid:\n$$\nJ_{\\text{adv}} = u C\n$$\nwhere $u$ is the average linear pore-water velocity.\n\nThe dispersive flux, which includes both mechanical dispersion and molecular diffusion, is modeled by Fick's first law:\n$$\nJ_{\\text{disp}} = -D \\frac{\\partial C}{\\partial x}\n$$\nwhere $D$ is the coefficient of hydrodynamic dispersion.\n\nCombining these components, the total flux is $J = u C - D \\frac{\\partial C}{\\partial x}$. Substituting this into the continuity equation gives:\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( u C - D \\frac{\\partial C}{\\partial x} \\right) = 0\n$$\nFor steady flow ($u$ is constant) and a homogeneous aquifer ($D$ is constant), the equation simplifies to the Advection-Dispersion Equation (ADE):\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x} + D \\frac{\\partial^2 C}{\\partial x^2}\n$$\nTo identify the dimensionless ratio governing the transport regime, we nondimensionalize this equation. We introduce the following dimensionless variables, where primed quantities are dimensionless:\n-   Dimensionless position: $x' = \\frac{x}{L}$\n-   Dimensionless concentration: $C' = \\frac{C}{C_0}$\n-   Dimensionless time: $t' = \\frac{t}{t_c}$\n\nHere, $L$ is a characteristic length scale, $C_0$ is a characteristic concentration, and $t_c$ is a characteristic time scale. Using the chain rule, we transform the partial derivatives:\n$$\n\\frac{\\partial}{\\partial x} = \\frac{1}{L} \\frac{\\partial}{\\partial x'}, \\quad \\frac{\\partial^2}{\\partial x^2} = \\frac{1}{L^2} \\frac{\\partial^2}{\\partial {x'}^2}, \\quad \\frac{\\partial}{\\partial t} = \\frac{1}{t_c} \\frac{\\partial}{\\partial t'}\n$$\nSubstituting these into the ADE:\n$$\n\\frac{C_0}{t_c} \\frac{\\partial C'}{\\partial t'} = -u \\frac{C_0}{L} \\frac{\\partial C'}{\\partial x'} + D \\frac{C_0}{L^2} \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\nTo simplify, we divide the entire equation by $\\frac{C_0 u}{L}$:\n$$\n\\left(\\frac{L}{u t_c}\\right) \\frac{\\partial C'}{\\partial t'} = -\\frac{\\partial C'}{\\partial x'} + \\left(\\frac{D}{u L}\\right) \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\nA natural choice for the characteristic time scale $t_c$ is the time it takes for a parcel of water to travel the characteristic length $L$, i.e., the advective time scale $t_c = \\frac{L}{u}$. This choice makes the coefficient of the time-derivative term equal to $1$. The dimensionless ADE then becomes:\n$$\n\\frac{\\partial C'}{\\partial t'} = -\\frac{\\partial C'}{\\partial x'} + \\frac{1}{Pe} \\frac{\\partial^2 C'}{\\partial {x'}^2}\n$$\nwhere $Pe$ is the Péclet number, defined as:\n$$\nPe = \\frac{u L}{D}\n$$\nThe Péclet number is the dimensionless ratio that measures the relative importance of advection to dispersion. A large $Pe$ ($Pe \\gg 1$) indicates advection-dominated transport, while a small $Pe$ ($Pe \\ll 1$) indicates dispersion-dominated transport.\n\nNext, we evaluate this ratio for the given aquifer properties.\nThe given values are:\n-   Hydraulic conductivity: $K = 1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   Hydraulic gradient: $i = 1.0 \\times 10^{-2}$\n-   Effective porosity: $\\phi = 0.25$\n-   Representative length scale: $L = 5.00 \\times 10^{2}\\,\\mathrm{m}$\n-   Longitudinal dispersivity: $\\alpha_{L} = 8.0\\,\\mathrm{m}$\n-   Molecular diffusion coefficient: $D_{m} = 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n\nStep 1: Calculate the average linear pore-water velocity, $u$.\nFirst, we find the Darcy flux, $q$, using Darcy's law:\n$$\nq = K i = (1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{-2}) = 1.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nThe average linear pore-water velocity, $u$, is the Darcy flux divided by the effective porosity, $\\phi$:\n$$\nu = \\frac{q}{\\phi} = \\frac{1.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.25} = 4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n\nStep 2: Calculate the longitudinal hydrodynamic dispersion coefficient, $D$.\nThe problem specifies the model for the dispersion coefficient as the sum of mechanical dispersion and molecular diffusion:\n$$\nD = \\alpha_{L} u + D_{m}\n$$\nSubstituting the values:\n$$\nD = (8.0\\,\\mathrm{m})(4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) + (1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1})\n$$\n$$\nD = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} + 1.5 \\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}\n$$\n$$\nD = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} + 0.00015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1} = 3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}\n$$\nNote that the mechanical dispersion term is several orders of magnitude larger than the molecular diffusion term, which is common in advective groundwater systems.\n\nStep 3: Calculate the Péclet number, $Pe$.\nUsing the derived formula for the Péclet number:\n$$\nPe = \\frac{u L}{D}\n$$\nSubstitute the values for $u$, $L$, and $D$:\n$$\nPe = \\frac{(4.0 \\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(5.00 \\times 10^{2}\\,\\mathrm{m})}{3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}\n$$\n$$\nPe = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}{3.20015 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}\n$$\n$$\nPe \\approx 62.49707\n$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\nPe \\approx 62.50\n$$\nSince $Pe \\approx 62.50 \\gg 1$, the solute transport regime in this aquifer is strongly advection-dominated.",
            "answer": "$$\\boxed{62.50}$$"
        },
        {
            "introduction": "While a single dispersion coefficient is useful in one dimension, real-world transport is multidimensional and anisotropic. This practice moves beyond the scalar concept to the more powerful hydrodynamic dispersion tensor, which correctly captures that spreading is greater along the flow path than perpendicular to it . By deriving and computing the principal components of this tensor, you will gain a more physically realistic understanding of how contaminant plumes evolve in groundwater systems.",
            "id": "4075065",
            "problem": "Aqueous reactive transport in saturated porous media is commonly modeled within Coupled Thermal–Hydraulic–Chemical (THC) frameworks, where advection, hydrodynamic dispersion, and molecular diffusion jointly control solute migration. Consider a homogeneous, isotropic, saturated sandstone at uniform bulk temperature (isothermal conditions) and negligible thermal gradients, so that thermal diffusion (Soret effect) can be ignored and the molecular diffusion coefficient is taken as constant. A single dissolved species $i$ is transported by a steady, uniform interstitial (seepage) velocity vector $\\mathbf{u}$, with $|\\mathbf{u}|$ denoting its magnitude. Hydrodynamic dispersion arises from pore-scale velocity variations and is characterized by a longitudinal dispersivity $\\alpha_{L}$ and a transverse dispersivity $\\alpha_{T}$. The effective molecular diffusion coefficient for species $i$ in the porous medium, $D_{m,i}$, already accounts for tortuosity and fluid properties at the given temperature.\n\nUsing the fundamental Fickian description of solute flux in porous media and a standard constitutive closure for hydrodynamic dispersion in the presence of uniform flow, derive from first principles how the effective dispersion tensor $\\mathbf{D}_{i}$ decomposes into principal components aligned with and orthogonal to $\\mathbf{u}$. Then, compute the two principal components (the longitudinal component along flow and the transverse component across flow) for the following data:\n- $\\alpha_{L} = 1\\times 10^{-2}\\,\\mathrm{m}$,\n- $\\alpha_{T} = 1\\times 10^{-3}\\,\\mathrm{m}$,\n- $|\\mathbf{u}| = 1\\times 10^{-5}\\,\\mathrm{m\\,s^{-1}}$,\n- $D_{m,i} = 1\\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}}$.\n\nExpress your final answer as a row matrix containing the two principal components in the order $\\left(D_{L,i}, D_{T,i}\\right)$ and report the values in $\\mathrm{m^{2}\\,s^{-1}}$. No rounding is necessary; provide exact values in scientific notation.",
            "solution": "The problem statement is valid. It is scientifically grounded in the established principles of transport phenomena in porous media, specifically the theory of hydrodynamic dispersion. The problem is well-posed, with all necessary data and definitions provided to derive and compute a unique, meaningful answer. The language is objective and the parameters are physically consistent and realistic.\n\nWe begin from the fundamental description of solute flux for a species $i$ in a porous medium. Under the conditions specified (isothermal, saturated, single-phase flow), the total diffusive-dispersive flux, $\\mathbf{J}_i$, relative to the moving fluid, is described by a generalized Fick's law:\n$$\n\\mathbf{J}_i = - \\mathbf{D}_{i} \\nabla C_i\n$$\nwhere $C_i$ is the concentration of species $i$ and $\\mathbf{D}_{i}$ is the effective hydrodynamic dispersion tensor. The total flux in a stationary frame of reference would also include the advective term $C_i \\mathbf{u}$, but the problem focuses on the properties of the dispersion tensor $\\mathbf{D}_{i}$ itself.\n\nThe effective dispersion tensor $\\mathbf{D}_{i}$ accounts for two distinct processes: mechanical dispersion and molecular diffusion. It is expressed as the sum of the mechanical dispersion tensor, $\\mathbf{D}_{\\text{mech}}$, and the effective molecular diffusion tensor, $\\mathbf{D}_{\\text{diff}}$:\n$$\n\\mathbf{D}_{i} = \\mathbf{D}_{\\text{mech}} + \\mathbf{D}_{\\text{diff}}\n$$\nFor diffusion in an isotropic porous medium, the effective molecular diffusion tensor is scalar in nature, represented by $\\mathbf{D}_{\\text{diff}} = D_{m,i} \\mathbf{I}$, where $D_{m,i}$ is the effective molecular diffusion coefficient (which already incorporates the tortuosity of the medium) and $\\mathbf{I}$ is the second-rank identity tensor.\n\nMechanical dispersion arises from velocity variations at the pore scale. For a homogeneous and isotropic porous medium under a uniform interstitial velocity field $\\mathbf{u}$, the mechanical dispersion tensor is given by the widely accepted constitutive relationship (Bear-Scheidegger model):\n$$\n\\mathbf{D}_{\\text{mech}} = \\alpha_{T} |\\mathbf{u}| \\mathbf{I} + (\\alpha_{L} - \\alpha_{T}) \\frac{\\mathbf{u} \\otimes \\mathbf{u}}{|\\mathbf{u}|}\n$$\nHere, $\\alpha_{L}$ is the longitudinal dispersivity, $\\alpha_{T}$ is the transverse dispersivity, $|\\mathbf{u}|$ is the magnitude of the interstitial velocity vector, and $\\mathbf{u} \\otimes \\mathbf{u}$ is the outer product of the velocity vector with itself.\n\nCombining these components, the full hydrodynamic dispersion tensor $\\mathbf{D}_{i}$ is:\n$$\n\\mathbf{D}_{i} = \\left( \\alpha_{T} |\\mathbf{u}| \\mathbf{I} + (\\alpha_{L} - \\alpha_{T}) \\frac{\\mathbf{u} \\otimes \\mathbf{u}}{|\\mathbf{u}|} \\right) + D_{m,i} \\mathbf{I}\n$$\n$$\n\\mathbf{D}_{i} = (\\alpha_{T} |\\mathbf{u}| + D_{m,i}) \\mathbf{I} + (\\alpha_{L} - \\alpha_{T}) \\frac{\\mathbf{u} \\otimes \\mathbf{u}}{|\\mathbf{u}|}\n$$\nThe principal components of the tensor $\\mathbf{D}_{i}$ are its eigenvalues. The corresponding principal directions are given by the eigenvectors. We can find these by analyzing the action of $\\mathbf{D}_{i}$ on vectors parallel and perpendicular to the flow velocity $\\mathbf{u}$.\n\nLet $\\mathbf{e}_{\\parallel}$ be a unit vector parallel to $\\mathbf{u}$, such that $\\mathbf{e}_{\\parallel} = \\frac{\\mathbf{u}}{|\\mathbf{u}|}$.\nLet $\\mathbf{e}_{\\perp}$ be any unit vector orthogonal to $\\mathbf{u}$, such that $\\mathbf{e}_{\\parallel} \\cdot \\mathbf{e}_{\\perp} = 0$.\n\nFirst, we find the eigenvalue corresponding to the direction of flow. We apply the tensor $\\mathbf{D}_{i}$ to the vector $\\mathbf{e}_{\\parallel}$:\n$$\n\\mathbf{D}_{i} \\mathbf{e}_{\\parallel} = \\left( (\\alpha_{T} |\\mathbf{u}| + D_{m,i}) \\mathbf{I} + (\\alpha_{L} - \\alpha_{T}) \\frac{\\mathbf{u} \\otimes \\mathbf{u}}{|\\mathbf{u}|} \\right) \\mathbf{e}_{\\parallel}\n$$\nUsing the property of the outer product $( \\mathbf{a} \\otimes \\mathbf{b} ) \\mathbf{c} = \\mathbf{a} (\\mathbf{b} \\cdot \\mathbf{c})$, we evaluate the second term:\n$$\n\\frac{\\mathbf{u} \\otimes \\mathbf{u}}{|\\mathbf{u}|} \\mathbf{e}_{\\parallel} = \\frac{\\mathbf{u}}{|\\mathbf{u}|} (\\mathbf{u} \\cdot \\mathbf{e}_{\\parallel}) = \\mathbf{e}_{\\parallel} (|\\mathbf{u}| \\mathbf{e}_{\\parallel} \\cdot \\mathbf{e}_{\\parallel}) = \\mathbf{e}_{\\parallel} |\\mathbf{u}| (1) = |\\mathbf{u}| \\mathbf{e}_{\\parallel}\n$$\nSubstituting this back into the equation for $\\mathbf{D}_{i} \\mathbf{e}_{\\parallel}$:\n$$\n\\mathbf{D}_{i} \\mathbf{e}_{\\parallel} = (\\alpha_{T} |\\mathbf{u}| + D_{m,i}) \\mathbf{e}_{\\parallel} + (\\alpha_{L} - \\alpha_{T}) |\\mathbf{u}| \\mathbf{e}_{\\parallel}\n$$\n$$\n\\mathbf{D}_{i} \\mathbf{e}_{\\parallel} = (\\alpha_{T} |\\mathbf{u}| + D_{m,i} + \\alpha_{L} |\\mathbf{u}| - \\alpha_{T} |\\mathbf{u}|) \\mathbf{e}_{\\parallel}\n$$\n$$\n\\mathbf{D}_{i} \\mathbf{e}_{\\parallel} = (\\alpha_{L} |\\mathbf{u}| + D_{m,i}) \\mathbf{e}_{\\parallel}\n$$\nThis is an eigenvalue equation of the form $\\mathbf{D}_{i} \\mathbf{v} = \\lambda \\mathbf{v}$. Thus, the principal component of dispersion in the longitudinal direction (parallel to flow), denoted $D_{L,i}$, is:\n$$\nD_{L,i} = \\alpha_{L} |\\mathbf{u}| + D_{m,i}\n$$\n\nNext, we find the eigenvalue corresponding to the direction transverse to the flow. We apply the tensor $\\mathbf{D}_{i}$ to the vector $\\mathbf{e}_{\\perp}$:\n$$\n\\mathbf{D}_{i} \\mathbf{e}_{\\perp} = \\left( (\\alpha_{T} |\\mathbf{u}| + D_{m,i}) \\mathbf{I} + (\\alpha_{L} - \\alpha_{T}) \\frac{\\mathbf{u} \\otimes \\mathbf{u}}{|\\mathbf{u}|} \\right) \\mathbf{e}_{\\perp}\n$$\nEvaluating the second term again:\n$$\n\\frac{\\mathbf{u} \\otimes \\mathbf{u}}{|\\mathbf{u}|} \\mathbf{e}_{\\perp} = \\frac{\\mathbf{u}}{|\\mathbf{u}|} (\\mathbf{u} \\cdot \\mathbf{e}_{\\perp}) = \\frac{\\mathbf{u}}{|\\mathbf{u}|} (|\\mathbf{u}| \\mathbf{e}_{\\parallel} \\cdot \\mathbf{e}_{\\perp}) = \\frac{\\mathbf{u}}{|\\mathbf{u}|} (0) = \\mathbf{0}\n$$\nThe second term vanishes. Substituting this back:\n$$\n\\mathbf{D}_{i} \\mathbf{e}_{\\perp} = (\\alpha_{T} |\\mathbf{u}| + D_{m,i}) \\mathbf{e}_{\\perp} + \\mathbf{0}\n$$\n$$\n\\mathbf{D}_{i} \\mathbf{e}_{\\perp} = (\\alpha_{T} |\\mathbf{u}| + D_{m,i}) \\mathbf{e}_{\\perp}\n$$\nThis is also an eigenvalue equation. The principal component of dispersion in the transverse direction (perpendicular to flow), denoted $D_{T,i}$, is:\n$$\nD_{T,i} = \\alpha_{T} |\\mathbf{u}| + D_{m,i}\n$$\nSince the medium is isotropic, any direction perpendicular to $\\mathbf{u}$ is an eigenvector with this same eigenvalue.\n\nNow, we compute the numerical values for these principal components using the provided data:\n- $\\alpha_{L} = 1 \\times 10^{-2}\\,\\mathrm{m}$\n- $\\alpha_{T} = 1 \\times 10^{-3}\\,\\mathrm{m}$\n- $|\\mathbf{u}| = 1 \\times 10^{-5}\\,\\mathrm{m\\,s^{-1}}$\n- $D_{m,i} = 1 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}}$\n\nCalculation for the longitudinal component, $D_{L,i}$:\n$$\nD_{L,i} = (1 \\times 10^{-2}\\,\\mathrm{m}) \\times (1 \\times 10^{-5}\\,\\mathrm{m\\,s^{-1}}) + (1 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}})\n$$\n$$\nD_{L,i} = 1 \\times 10^{-7}\\,\\mathrm{m^{2}\\,s^{-1}} + 1 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}}\n$$\n$$\nD_{L,i} = 100 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}} + 1 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}}\n$$\n$$\nD_{L,i} = 101 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}} = 1.01 \\times 10^{-7}\\,\\mathrm{m^{2}\\,s^{-1}}\n$$\n\nCalculation for the transverse component, $D_{T,i}$:\n$$\nD_{T,i} = (1 \\times 10^{-3}\\,\\mathrm{m}) \\times (1 \\times 10^{-5}\\,\\mathrm{m\\,s^{-1}}) + (1 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}})\n$$\n$$\nD_{T,i} = 1 \\times 10^{-8}\\,\\mathrm{m^{2}\\,s^{-1}} + 1 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}}\n$$\n$$\nD_{T,i} = 10 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}} + 1 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}}\n$$\n$$\nD_{T,i} = 11 \\times 10^{-9}\\,\\mathrm{m^{2}\\,s^{-1}} = 1.1 \\times 10^{-8}\\,\\mathrm{m^{2}\\,s^{-1}}\n$$\nThe two principal components are $D_{L,i} = 1.01 \\times 10^{-7}\\,\\mathrm{m^{2}\\,s^{-1}}$ and $D_{T,i} = 1.1 \\times 10^{-8}\\,\\mathrm{m^{2}\\,s^{-1}}$. The final answer is to be expressed as a row matrix $(D_{L,i}, D_{T,i})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.01 \\times 10^{-7} & 1.1 \\times 10^{-8} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Reliable computational modeling requires not only understanding the physics but also rigorously verifying the code that implements it. This advanced practice introduces the Method of Manufactured Solutions (MMS), a powerful technique for assessing the accuracy of a numerical solver . You will derive the necessary components for an exact solution to the Advection-Dispersion-Reaction equation, implement a finite difference model, and use the MMS framework to verify that your code converges at the theoretically expected rate—an essential skill in computational science.",
            "id": "4079440",
            "problem": "Consider one-dimensional solute transport in a saturated geochemical column modeled by the Advection–Diffusion–Reaction (ADR) Partial Differential Equation (PDE). Let $u(x,t)$ denote aqueous concentration in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, with spatial coordinate $x \\in [0,L]$ in $\\mathrm{m}$ and time $t \\in [0,T]$ in $\\mathrm{s}$. The ADR PDE is\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; k\\,u \\;+\\; s(x,t),\n$$\nwhere $a$ is the advective velocity in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $D$ is the diffusion (hydrodynamic dispersion) coefficient in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $k$ is a first-order reaction rate constant in $\\mathrm{s}^{-1}$, and $s(x,t)$ is a source term in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ representing external inputs.\n\nUsing the method of manufactured solutions, define the exact concentration field\n$$\nu_{\\mathrm{m}}(x,t) \\;=\\; \\sin\\!\\big(2\\pi x/L\\big)\\,\\mathrm{e}^{-t} \\;+\\; \\tfrac{1}{2}\\,x\\,(L-x),\n$$\nwith domain length $L = 1$ $\\mathrm{m}$ and final time $T = 0.1$ $\\mathrm{s}$. Impose Dirichlet boundary conditions that match the manufactured solution, so that $u(0,t) = u_{\\mathrm{m}}(0,t)$ and $u(L,t) = u_{\\mathrm{m}}(L,t)$ for all $t \\in [0,T]$, and an initial condition $u(x,0) = u_{\\mathrm{m}}(x,0)$ for all $x \\in [0,L]$. Starting from the ADR definition above, derive the source term $s(x,t)$ that makes $u_{\\mathrm{m}}(x,t)$ an exact solution of the continuous ADR PDE for arbitrary constants $a$, $D$, and $k$.\n\nDiscretize the spatial domain by a uniform grid with $N$ interior points (so there are $N+2$ nodes including the boundaries), spacing $h = L/(N+1)$. Use an upwind finite difference for the first derivative $\\partial u/\\partial x$, a second-order central difference for the second derivative $\\partial^2 u/\\partial x^2$, and a forward Euler time integrator for $\\partial u/\\partial t$. Specifically, for a given sign of $a$, use the appropriate upwind one-sided difference. Let the time step $\\Delta t$ satisfy explicit stability conditions, taking\n$$\n\\Delta t \\;=\\; 0.4 \\times \\min\\!\\left(\\frac{h}{|a|}, \\; \\frac{h^2}{2D}, \\; \\frac{1}{k}\\right),\n$$\nwith the convention that terms with zero denominator are treated as $+\\infty$ in the minimum. Integrate from $t=0$ to $t=T$ by forward Euler using the manufactured source term $s(x,t)$ evaluated at the current time level, and enforce Dirichlet boundary values from $u_{\\mathrm{m}}(x,t)$ at every time step. After reaching $t=T$, compute the relative discrete $L^2$ error\n$$\nE_h \\;=\\; \\frac{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_i(T) - u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}},\n$$\nwhich is dimensionless. Using mesh refinements $N \\in \\{40, 80, 160\\}$, estimate the observed convergence rate\n$$\np \\;=\\; \\frac{\\ln\\!\\big(E_{h_2}/E_{h_3}\\big)}{\\ln\\!\\big(h_2/h_3\\big)},\n$$\nwhere $h_j = L/(N_j+1)$ and $N_2=80$, $N_3=160$.\n\nTest Suite:\n- Set $\\mathrm{A}$ (diffusion-dominated): $a = 0.05$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $D = 1.0\\times 10^{-3}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $k = 0.1$ $\\mathrm{s}^{-1}$.\n- Set $\\mathrm{B}$ (advection-dominated, positive velocity): $a = 1.0$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $k = 0.1$ $\\mathrm{s}^{-1}$.\n- Set $\\mathrm{C}$ (advection-dominated, negative velocity): $a = -1.0$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $k = 0.1$ $\\mathrm{s}^{-1}$.\n- Set $\\mathrm{D}$ (reaction-dominated): $a = 0.01$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $k = 5.0$ $\\mathrm{s}^{-1}$.\n\nYour program must:\n- Derive and implement the manufactured source $s(x,t)$ from the ADR PDE and $u_{\\mathrm{m}}(x,t)$.\n- For each parameter set $\\mathrm{A}$, $\\mathrm{B}$, $\\mathrm{C}$, and $\\mathrm{D}$, compute the relative discrete $L^2$ errors $E_{h}$ for $N \\in \\{40,80,160\\}$ and then compute $p$ using the formula above.\n- Produce a single line of output containing the observed convergence rates for the four sets as a comma-separated list enclosed in square brackets, in the order $\\mathrm{A}$, $\\mathrm{B}$, $\\mathrm{C}$, $\\mathrm{D}$, with each float rounded to three decimal places, for example $[p_A,p_B,p_C,p_D]$.\n\nAll outputs are dimensionless and must be reported as floats. Angles are not involved. No percentages are involved.",
            "solution": "The user-provided problem is a well-posed exercise in computational science, specifically the numerical solution of a partial differential equation (PDE) using the method of manufactured solutions for code verification. The problem is scientifically grounded, self-contained, and all parameters and methods are clearly defined. It will be solved by first deriving the necessary source term, then developing a numerical model based on the specified finite difference scheme, and finally using this model to compute the empirical convergence rate for several physical scenarios.\n\n### 1. Derivation of the Manufactured Source Term\n\nThe problem is governed by the Advection–Diffusion–Reaction (ADR) equation:\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; k\\,u \\;+\\; s(x,t)\n$$\nThe source term $s(x,t)$ must be chosen such that the manufactured solution, $u_{\\mathrm{m}}(x,t)$, is an exact solution to this PDE. We can find $s(x,t)$ by rearranging the ADR equation and substituting $u_{\\mathrm{m}}(x,t)$:\n$$\ns(x,t) = \\frac{\\partial u_{\\mathrm{m}}}{\\partial t} + a\\,\\frac{\\partial u_{\\mathrm{m}}}{\\partial x} - D\\,\\frac{\\partial^2 u_{\\mathrm{m}}}{\\partial x^2} + k\\,u_{\\mathrm{m}}\n$$\nThe manufactured solution is given as:\n$$\nu_{\\mathrm{m}}(x,t) \\;=\\; \\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} \\;+\\; \\frac{1}{2}\\,x\\,(L-x)\n$$\nTo find $s(x,t)$, we first compute the necessary partial derivatives of $u_{\\mathrm{m}}(x,t)$:\n\\begin{itemize}\n    \\item Time derivative:\n    $$\n    \\frac{\\partial u_{\\mathrm{m}}}{\\partial t} = -\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t}\n    $$\n    \\item First spatial derivative:\n    $$\n    \\frac{\\partial u_{\\mathrm{m}}}{\\partial x} = \\frac{2\\pi}{L}\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{L}{2} - x\n    $$\n    \\item Second spatial derivative:\n    $$\n    \\frac{\\partial^2 u_{\\mathrm{m}}}{\\partial x^2} = -\\left(\\frac{2\\pi}{L}\\right)^2\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} - 1\n    $$\n\\end{itemize}\nSubstituting these expressions into the equation for $s(x,t)$:\n$$\ns(x,t) = \\left[-\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t}\\right] + a\\left[\\frac{2\\pi}{L}\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{L}{2} - x\\right] - D\\left[-\\left(\\frac{2\\pi}{L}\\right)^2\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} - 1\\right] + k\\left[\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{1}{2}\\,x\\,(L-x)\\right]\n$$\nGrouping terms by their functional dependence on $x$ and $t$:\n$$\ns(x,t) = \\left(k - 1 + D\\left(\\frac{2\\pi}{L}\\right)^2\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\mathrm{e}^{-t} + \\left(\\frac{2\\pi a}{L}\\right)\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\mathrm{e}^{-t} + a\\left(\\frac{L}{2} - x\\right) + D + \\frac{k}{2}x(L-x)\n$$\nThis is the analytical expression for the source term that will be implemented in the numerical model.\n\n### 2. Numerical Discretization\n\nThe PDE is discretized on a uniform spatial grid $x_i = i h$ for $i \\in \\{0, 1, \\dots, N+1\\}$, where $h = L/(N+1)$ is the grid spacing. Time is discretized as $t_n = n \\Delta t$. We denote the numerical approximation of $u(x_i, t_n)$ as $u_i^n$.\n\nThe specified numerical scheme is:\n\\begin{itemize}\n    \\item **Time Derivative**: Forward Euler, $\\frac{\\partial u}{\\partial t} \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}$.\n    \\item **Diffusion Term**: Second-order central difference, $\\frac{\\partial^2 u}{\\partial x^2} \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}$.\n    \\item **Advection Term**: First-order upwind difference. The form depends on the sign of the velocity $a$:\n    \\begin{itemize}\n        \\item If $a \\ge 0$ (flow to the right), a backward difference is used: $\\frac{\\partial u}{\\partial x} \\approx \\frac{u_i^n - u_{i-1}^n}{h}$.\n        \\item If $a < 0$ (flow to the left), a forward difference is used: $\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{i+1}^n - u_i^n}{h}$.\n    \\end{itemize}\n\\end{itemize}\n\nRearranging the PDE as $\\frac{\\partial u}{\\partial t} = \\dots$ and substituting the discrete approximations gives the update rule $u_i^{n+1} = u_i^n + \\Delta t (\\dots)$.\n\nFor $a \\ge 0$:\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left[ D\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} - a\\frac{u_i^n - u_{i-1}^n}{h} - k u_i^n + s(x_i, t_n) \\right]\n$$\nFor $a < 0$:\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left[ D\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} - a\\frac{u_{i+1}^n - u_i^n}{h} - k u_i^n + s(x_i, t_n) \\right]\n$$\nThese equations are applied to all interior grid points $i \\in \\{1, 2, \\dots, N\\}$. The boundary values are fixed by the Dirichlet conditions: $u_0^{n+1} = u_{\\mathrm{m}}(0, t_{n+1}) = 0$ and $u_{N+1}^{n+1} = u_{\\mathrm{m}}(L, t_{n+1}) = 0$.\n\n### 3. Time Step and Convergence Analysis\n\nThe time step $\\Delta t$ is chosen to satisfy the explicit stability conditions for the forward Euler scheme:\n$$\n\\Delta t \\;=\\; 0.4 \\times \\min\\!\\left(\\frac{h}{|a|}, \\; \\frac{h^2}{2D}, \\; \\frac{1}{k}\\right)\n$$\nThe factor $0.4$ is a safety factor ensuring that the Courant–Friedrichs–Lewy (CFL) conditions for advection and diffusion, as well as a stability condition for the reaction term, are all met.\n\nThe simulation starts from the initial condition $u_i^0 = u_{\\mathrm{m}}(x_i, 0)$ and proceeds until the final time $T$. The accuracy of the numerical solution $u_i(T)$ is quantified by the relative discrete $L^2$ error:\n$$\nE_h \\;=\\; \\frac{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_i(T) - u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}{\\left(\\,h \\sum_{i=0}^{N+1} \\big(u_{\\mathrm{m}}(x_i,T)\\big)^2\\,\\right)^{1/2}}\n$$\nThe observed order of convergence, $p$, is estimated by computing the error for two different grid resolutions, $h_2$ (with $N_2=80$) and $h_3$ (with $N_3=160$):\n$$\np \\;=\\; \\frac{\\ln\\!\\big(E_{h_2}/E_{h_3}\\big)}{\\ln\\!\\big(h_2/h_3\\big)}\n$$\nThe numerical scheme employs first-order methods for time integration (Forward Euler) and advection (upwinding), and a second-order method for diffusion. The overall accuracy is limited by the lowest order term, so the theoretical convergence rate is expected to be $p \\approx 1$.\n\n### 4. Implementation\n\nThe algorithm is implemented in Python using the `numpy` library for efficient vectorized operations. A function is defined to run the simulation for a given set of parameters $(a, D, k)$ and grid size $N$. This function initializes the grid and the solution vector, calculates the stable time step, and iteratively updates the solution in a time loop. Within the loop, the source term is evaluated at the current time, and the appropriate upwind scheme is chosen based on the sign of $a$. After reaching the final time $T$, the function computes and returns the relative $L^2$ error. The main part of the script loops through the four test suites, calls the simulation function for $N=80$ and $N=160$, calculates the convergence rate $p$ for each suite, and prints the results in the specified format.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the observed convergence rates for the ADR equation\n    solution for four different parameter sets.\n    \"\"\"\n\n    def u_manufactured(x: np.ndarray, t: float, L: float) -> np.ndarray:\n        \"\"\"\n        Calculates the manufactured solution u_m(x, t).\n        \"\"\"\n        term1 = np.sin(2 * np.pi * x / L) * np.exp(-t)\n        term2 = 0.5 * x * (L - x)\n        return term1 + term2\n\n    def source_manufactured(x: np.ndarray, t: float, a: float, D: float, k: float, L: float) -> np.ndarray:\n        \"\"\"\n        Calculates the manufactured source term s(x, t).\n        \"\"\"\n        pi_term = 2 * np.pi / L\n        exp_t = np.exp(-t)\n        \n        sin_term = np.sin(pi_term * x)\n        cos_term = np.cos(pi_term * x)\n        \n        # Grouping terms as derived in the solution\n        term1 = (k - 1 + D * pi_term**2) * sin_term * exp_t\n        term2 = a * pi_term * cos_term * exp_t\n        term3 = a * (L/2 - x)\n        term4 = D\n        term5 = k * 0.5 * x * (L - x)\n\n        return term1 + term2 + term3 + term4 + term5\n\n    def run_simulation(N: int, a: float, D: float, k: float, L: float, T: float) -> float:\n        \"\"\"\n        Runs one simulation for a given grid size and parameter set.\n        \n        Returns:\n            The relative discrete L2 error.\n        \"\"\"\n        # Grid setup\n        h = L / (N + 1)\n        x = np.linspace(0, L, N + 2)\n\n        # Time step calculation based on stability criteria\n        # Handle cases where denominators might be zero\n        dt_adv = h / abs(a) if a != 0 else np.inf\n        dt_diff = h**2 / (2 * D) if D != 0 else np.inf\n        dt_react = 1 / k if k != 0 else np.inf\n        \n        dt = 0.4 * min(dt_adv, dt_diff, dt_react)\n        \n        num_steps = int(np.ceil(T / dt))\n        dt = T / num_steps  # Adjust dt to hit T exactly\n\n        # Initial condition\n        u = u_manufactured(x, 0, L)\n        \n        # Time-stepping loop\n        t = 0\n        for n in range(num_steps):\n            t = n * dt\n            u_n = u.copy()\n            \n            # Evaluate source term for interior points at current time t\n            s = source_manufactured(x[1:-1], t, a, D, k, L)\n\n            # Slicing for vectorized update\n            u_interior = u_n[1:-1]\n            u_left = u_n[0:-2]\n            u_right = u_n[2:]\n\n            # Diffusion and reaction terms\n            diffusion_term = D * (u_left - 2 * u_interior + u_right) / h**2\n            reaction_term = -k * u_interior\n\n            # Advection term (upwinding)\n            if a >= 0:\n                advection_term = -a * (u_interior - u_left) / h\n            else: # a < 0\n                advection_term = -a * (u_right - u_interior) / h\n\n            # Update interior points\n            u[1:-1] = u_interior + dt * (diffusion_term + advection_term + reaction_term + s)\n\n            # Boundary conditions for the next step (t + dt) are u_m(0, t+dt) and u_m(L, t+dt)\n            # which are both 0 for all t > 0.\n            u[0] = u_manufactured(x[0], t + dt, L)\n            u[-1] = u_manufactured(x[-1], t + dt, L)\n\n        # Final time reached\n        t_final = T\n        u_exact_T = u_manufactured(x, t_final, L)\n\n        # Compute relative discrete L2 error\n        # The sqrt(h) factor in numerator and denominator can be cancelled if numpy's\n        # default L2 norm is used, but we'll implement the formula exactly for clarity.\n        err_numerator_sq = h * np.sum((u - u_exact_T)**2)\n        err_denominator_sq = h * np.sum(u_exact_T**2)\n        \n        if err_denominator_sq == 0:\n            return 0.0 if err_numerator_sq == 0 else np.inf\n            \n        error = np.sqrt(err_numerator_sq) / np.sqrt(err_denominator_sq)\n        \n        return error\n\n    def calculate_convergence_rate(params: tuple) -> float:\n        \"\"\"\n        Calculates the convergence rate for a given parameter set.\n        \"\"\"\n        a, D, k = params\n        L, T = 1.0, 0.1\n        N_vals = {'N2': 80, 'N3': 160}\n\n        h2 = L / (N_vals['N2'] + 1)\n        h3 = L / (N_vals['N3'] + 1)\n        \n        E_h2 = run_simulation(N_vals['N2'], a, D, k, L, T)\n        E_h3 = run_simulation(N_vals['N3'], a, D, k, L, T)\n        \n        # Handle cases where error might be zero\n        if E_h2 == 0 or E_h3 == 0:\n            return np.nan # Or some other indicator of non-standard convergence\n            \n        p = np.log(E_h2 / E_h3) / np.log(h2 / h3)\n        return p\n\n    # Test suite from the problem statement\n    test_cases = [\n        (0.05, 1.0e-3, 0.1),    # Set A: diffusion-dominated\n        (1.0, 1.0e-4, 0.1),     # Set B: advection-dominated, positive a\n        (-1.0, 1.0e-4, 0.1),    # Set C: advection-dominated, negative a\n        (0.01, 1.0e-4, 5.0),    # Set D: reaction-dominated\n    ]\n\n    results = []\n    for case in test_cases:\n        p = calculate_convergence_rate(case)\n        results.append(p)\n\n    # Format output as specified: [p_A,p_B,p_C,p_D] rounded to 3 decimal places.\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}