{
    "hands_on_practices": [
        {
            "introduction": "为了开始我们的实践探索，我们必须首先巩固对“团簇同位素”异常的理解。这项基础练习 () 将引导您从第一性原理出发，推导团簇同位素超额 $\\Delta_{47}$ 的表达式。通过计算二氧化碳（CO$_2$）中同位素的随机分布组合，您将具体理解如何将测量的同位素比率与随机分布基线进行比较，从而量化对团簇的热力学偏好。",
            "id": "4088417",
            "problem": "考虑一个封闭储库中的二氧化碳 (CO$_2$)，其中同位素取代足够稀少，因此分子可以被视为不同的同位素体。设碳库中 $^{13}\\mathrm{C}$ 的原子分数为 $p_{13}$，因此 $^{12}\\mathrm{C}$ 的原子分数为 $p_{12} = 1 - p_{13}$。对于氧，设 $^{16}\\mathrm{O}$、$^{17}\\mathrm{O}$ 和 $^{18}\\mathrm{O}$ 的原子分数分别为 $p_{16}$、 $p_{17}$ 和 $p_{18}$，其中 $p_{16} = 1 - p_{17} - p_{18}$。在随机参考系中，不同原子位点上的同位素取代是独立的，一个同位素体的概率由相应原子分数的乘积乘以因 CO$_2$ 中不可区分的氧位置而产生的任何组合多重性给出。我们忽略 $^{14}\\mathrm{C}$ 以及任何比 $^{18}\\mathrm{O}$ 更重的同位素。\n\n将 CO$_2$ 的质量数为 47 的同位素体定义为总质量数为 47 的那些，即 $^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}$、$^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}$ 和 $^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}$。将质量数为 44 的同位素体定义为 $^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O}$。\n\n质量数 47 的团簇同位素超额，记为 $\\Delta_{47}$，其操作性定义为将测量的 47/44 比值与其随机对应值进行比较：如果 $R_{47}^{\\mathrm{meas}}$ 和 $R_{47}^{*}$ 分别表示测量和随机的 47/44 比值，那么\n$$\n\\Delta_{47} = 1000 \\times \\left( \\frac{R_{47}^{\\mathrm{meas}}}{R_{47}^{*}} - 1 \\right),\n$$\n其中因子 $1000$ 将无量纲偏差转换为千分率（‰）。假设团簇效应仅扰动同一分子中 $^{13}\\mathrm{C}$ 和 $^{18}\\mathrm{O}$ 的同时出现，使得 $^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}$ 同位素体的测量概率相对于其随机值乘以一个因子 $\\left(1 + \\epsilon\\right)$，而 $^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}$ 和 $^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}$ 的测量概率等于其随机值。进一步假设这种扰动在一阶近似下保持整体原子分数不变，因此 $^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O}$ 的测量概率等于其随机值。\n\n从随机参考系的独立性假设和上述 $\\Delta_{47}$ 的操作性定义出发，推导用 $\\epsilon$、$p_{12}$、$p_{13}$、$p_{16}$、$p_{17}$ 和 $p_{18}$ 表示的 $\\Delta_{47}$ 的通用表达式，然后对下列数值进行计算\n$$\np_{13} = 0.011070,\\quad p_{17} = 0.000380,\\quad p_{18} = 0.002050,\\quad \\epsilon = 0.004.\n$$\n以千分率（‰）表示 $\\Delta_{47}$ 的最终数值结果，并将您的答案四舍五入到四位有效数字。只给出最终数值答案。",
            "solution": "该问题具有科学依据，提法明确、客观，并包含了获得唯一解所需的所有信息。这是同位素地球化学中的一个标准问题，需要应用概率论和组合原理。因此，该问题被认为是有效的。\n\n推导分两个阶段进行：首先，推导 $\\Delta_{47}$ 的通用表达式；其次，对其进行数值计算。\n\n**1. $\\Delta_{47}$ 的通用表达式**\n\n设 $P(\\cdot)$ 表示一个同位素体的概率或丰度分数。随机参考系假设，形成给定同位素体的概率是其组成同位素的原子分数的乘积，再乘以一个考虑等效原子位置的组合因子。在 $\\mathrm{CO}_2$ 中，两个氧的位置在结构上是等效的。\n\n相关同位素体的随机概率 ($P^{*}$) 如下：\n- 质量数为 44 的参考同位素体是 $^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O}$。它包含两个相同的氧同位素。组合多重性为 $1$。\n$$ P^{*}(^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O}) = p_{12} (p_{16})^2 $$\n- 质量数为 47 的同位素体是：\n  - $^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}$: 它包含两个不同的氧同位素（$^{16}\\mathrm{O}$ 和 $^{18}\\mathrm{O}$）。组合多重性为 $2$，因为这些同位素可以占据两个氧位点中的任意一个。\n  $$ P^{*}(^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}) = 2 p_{13} p_{16} p_{18} $$\n  - $^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}$: 它也包含两个不同的氧同位素（$^{17}\\mathrm{O}$ 和 $^{18}\\mathrm{O}$）。多重性为 $2$。\n  $$ P^{*}(^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}) = 2 p_{12} p_{17} p_{18} $$\n  - $^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}$: 它包含两个相同的氧同位素（$^{17}\\mathrm{O}$）。多重性为 $1$。\n  $$ P^{*}(^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}) = p_{13} (p_{17})^2 $$\n\n质量数 47 的同位素体的总随机概率 $P^{*}_{47}$ 是各个概率之和：\n$$ P^{*}_{47} = P^{*}(^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}) + P^{*}(^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}) + P^{*}(^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}) $$\n$$ P^{*}_{47} = 2 p_{13} p_{16} p_{18} + 2 p_{12} p_{17} p_{18} + p_{13} (p_{17})^2 $$\n\n质量数 47 与质量数 44 物种的随机比值 $R_{47}^{*}$ 为：\n$$ R_{47}^{*} = \\frac{P^{*}_{47}}{P^{*}(^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O})} = \\frac{2 p_{13} p_{16} p_{18} + 2 p_{12} p_{17} p_{18} + p_{13} (p_{17})^2}{p_{12} (p_{16})^2} $$\n\n接下来，我们引入由团簇效应引起的扰动来求得测量概率 ($P^{\\mathrm{meas}}$)。根据题目陈述：\n- $P^{\\mathrm{meas}}(^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}) = (1+\\epsilon) P^{*}(^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}) = 2(1+\\epsilon) p_{13} p_{16} p_{18}$\n- $P^{\\mathrm{meas}}(^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}) = P^{*}(^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}) = 2 p_{12} p_{17} p_{18}$\n- $P^{\\mathrm{meas}}(^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}) = P^{*}(^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}) = p_{13} (p_{17})^2$\n- $P^{\\mathrm{meas}}(^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O}) = P^{*}(^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O}) = p_{12} (p_{16})^2$\n\n质量数 47 的同位素体的总测量概率 $P^{\\mathrm{meas}}_{47}$ 为：\n$$ P^{\\mathrm{meas}}_{47} = P^{\\mathrm{meas}}(^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}) + P^{\\mathrm{meas}}(^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}) + P^{\\mathrm{meas}}(^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}) $$\n$$ P^{\\mathrm{meas}}_{47} = 2(1+\\epsilon) p_{13} p_{16} p_{18} + 2 p_{12} p_{17} p_{18} + p_{13} (p_{17})^2 $$\n展开此表达式：\n$$ P^{\\mathrm{meas}}_{47} = (2 p_{13} p_{16} p_{18} + 2 p_{12} p_{17} p_{18} + p_{13} (p_{17})^2) + 2\\epsilon p_{13} p_{16} p_{18} $$\n将括号中的项识别为 $P^{*}_{47}$，我们得到：\n$$ P^{\\mathrm{meas}}_{47} = P^{*}_{47} + 2\\epsilon p_{13} p_{16} p_{18} $$\n测量比值 $R_{47}^{\\mathrm{meas}}$ 为：\n$$ R_{47}^{\\mathrm{meas}} = \\frac{P^{\\mathrm{meas}}_{47}}{P^{\\mathrm{meas}}(^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O})} = \\frac{P^{*}_{47} + 2\\epsilon p_{13} p_{16} p_{18}}{p_{12} (p_{16})^2} $$\n\n现在，我们将 $R_{47}^{\\mathrm{meas}}$ 和 $R_{47}^{*}$ 的表达式代入 $\\Delta_{47}$ 的定义中：\n$$ \\Delta_{47} = 1000 \\times \\left( \\frac{R_{47}^{\\mathrm{meas}}}{R_{47}^{*}} - 1 \\right) $$\n比值的比值为：\n$$ \\frac{R_{47}^{\\mathrm{meas}}}{R_{47}^{*}} = \\frac{\\frac{P^{*}_{47} + 2\\epsilon p_{13} p_{16} p_{18}}{p_{12} (p_{16})^2}}{\\frac{P^{*}_{47}}{p_{12} (p_{16})^2}} = \\frac{P^{*}_{47} + 2\\epsilon p_{13} p_{16} p_{18}}{P^{*}_{47}} = 1 + \\frac{2\\epsilon p_{13} p_{16} p_{18}}{P^{*}_{47}} $$\n将此代回 $\\Delta_{47}$ 方程：\n$$ \\Delta_{47} = 1000 \\times \\left( \\left(1 + \\frac{2\\epsilon p_{13} p_{16} p_{18}}{P^{*}_{47}}\\right) - 1 \\right) = 1000 \\times \\frac{2\\epsilon p_{13} p_{16} p_{18}}{P^{*}_{47}} $$\n用其完整表达式替换 $P^{*}_{47}$，得到通用公式：\n$$ \\Delta_{47} = 1000 \\times \\left( \\frac{2 \\epsilon p_{13} p_{16} p_{18}}{2 p_{13} p_{16} p_{18} + 2 p_{12} p_{17} p_{18} + p_{13} (p_{17})^2} \\right) $$\n\n**2. 数值计算**\n\n给定的原子分数为：\n$ p_{13} = 0.011070 $\n$ p_{17} = 0.000380 $\n$ p_{18} = 0.002050 $\n扰动因子为 $\\epsilon = 0.004$。\n\n由此，我们推导出最丰富的同位素的分数：\n$ p_{12} = 1 - p_{13} = 1 - 0.011070 = 0.988930 $\n$ p_{16} = 1 - p_{17} - p_{18} = 1 - 0.000380 - 0.002050 = 0.997570 $\n\n现在我们计算质量数 47 的总随机丰度的组成部分：\n- $^{13}\\mathrm{C}^{16}\\mathrm{O}^{18}\\mathrm{O}$ 的随机丰度：\n$ 2 p_{13} p_{16} p_{18} = 2 \\times 0.011070 \\times 0.997570 \\times 0.002050 \\approx 4.529845 \\times 10^{-5} $\n- $^{12}\\mathrm{C}^{17}\\mathrm{O}^{18}\\mathrm{O}$ 的随机丰度：\n$ 2 p_{12} p_{17} p_{18} = 2 \\times 0.988930 \\times 0.000380 \\times 0.002050 \\approx 1.540753 \\times 10^{-6} $\n- $^{13}\\mathrm{C}^{17}\\mathrm{O}^{17}\\mathrm{O}$ 的随机丰度：\n$ p_{13} (p_{17})^2 = 0.011070 \\times (0.000380)^2 \\approx 1.598428 \\times 10^{-9} $\n\n质量数 47 的总随机丰度 $P^{*}_{47}$ 是其总和：\n$ P^{*}_{47} \\approx 4.529845 \\times 10^{-5} + 1.540753 \\times 10^{-6} + 1.598428 \\times 10^{-9} \\approx 4.684080 \\times 10^{-5} $\n\n$\\Delta_{47}$ 表达式中分数的分子是：\n$ 2 \\epsilon p_{13} p_{16} p_{18} = 0.004 \\times (2 p_{13} p_{16} p_{18}) \\approx 0.004 \\times 4.529845 \\times 10^{-5} \\approx 1.811938 \\times 10^{-7} $\n\n最后，我们计算 $\\Delta_{47}$：\n$$ \\Delta_{47} = 1000 \\times \\frac{1.811938 \\times 10^{-7}}{4.684080 \\times 10^{-5}} \\approx 1000 \\times 0.00386829 \\approx 3.86829 $$\n按要求四舍五入到四位有效数字，得到 $3.868$。",
            "answer": "$$\\boxed{3.868}$$"
        },
        {
            "introduction": "在定义了团簇同位素超额之后，我们现在转向对其物理起源进行建模，并评估我们模型的稳健性。这个练习 () 要求您从零开始，使用分子振动的量子谐振子近似来构建团簇效应的模型。您将实现一个蒙特卡洛模拟来传播基本参数（如温度和振动频率）中的不确定性，从而为模型预测的置信度提供一个批判性的视角，并揭示哪些参数对结果影响最大。",
            "id": "4088412",
            "problem": "您的任务是为二氧化碳中的团簇同位素平衡建立一个计算模型，该模型需量化将两个重同位素（$^{13}\\mathrm{C}$ 和 $^{18}\\mathrm{O}$）置于同一分子中（相对于将它们分布在不同分子中）的热力学偏好。建模必须从基于正则系综和分子振动的谐振子描述的第一性原理出发，除了此处指定的基本定律外，不得引用任何捷径公式。\n\n假设每个二氧化碳分子可以表示为两个独立的碳-氧键，每个键的行为都像一个量子谐振子。正则系综规定，反应的平衡常数由产物与反应物的配分函数之比决定，谐振子的能级由 $E_n = h \\nu (n + 1/2)$ 给出，其中 $h$ 是普朗克常数，$\\nu$ 是振动频率， $n$ 是量子数。在仅零点能差异相对于更高振动激发态显著的温度下，平衡常数可以纯粹根据零点能差异来近似计算。\n\n考虑在两个分子之间重新分配重同位素的交换反应：\n$^{13}\\mathrm{C}^{18}\\mathrm{O}^{16}\\mathrm{O} + {}^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O} \\leftrightarrow {}^{13}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O} + {}^{12}\\mathrm{C}^{18}\\mathrm{O}^{16}\\mathrm{O}$。\n左侧代表“团簇”构型（两个重同位素在一个分子中），而右侧代表“随机”分布（重同位素分散分布）。此处的团簇指数定义为从左到右进行的反应的平衡常数的自然对数，记为 $X = \\ln K$，该值为无量纲。\n\n使用谐振子的振动频率对折合质量的依赖关系。对于单个碳-氧键，振动频率的标度关系为 $\\nu \\propto \\sqrt{k / \\mu}$，其中 $k$ 是有效力常数，$\\mu$ 是由 $\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}$ 定义的原子对的折合质量。假设 ${}^{12}\\mathrm{C}$–${}^{16}\\mathrm{O}$ 键的基本（轻-轻）频率为 $\\nu_0$（单位为 $\\mathrm{cm}^{-1}$）。对于任何同位素取代，键频为 $\\nu = \\nu_0 \\sqrt{\\mu_0 / \\mu}$，其中 $\\mu_0$ 是 ${}^{12}\\mathrm{C}$–${}^{16}\\mathrm{O}$ 的折合质量。\n\n使用以下物理常数和原子质量：\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34} \\ \\mathrm{J \\cdot s}$，\n- 光速 $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m/s}$，\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$，\n- 一个原子质量单位 $u = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$。\n要使用的原子质量：\n- ${}^{12}\\mathrm{C}$：$12.000000 \\ u$，\n- ${}^{13}\\mathrm{C}$：$13.003355 \\ u$，\n- ${}^{16}\\mathrm{O}$：$15.994915 \\ u$，\n- ${}^{18}\\mathrm{O}$：$17.999160 \\ u$。\n\n建模要求：\n1. 从正则系综和谐振子基础出发，推导出用反应物和产物之间的零点能差异表示的 $X = \\ln K$ 的表达式。使用相对于 $\\nu_0$ 和 $\\mu_0$ 的折合质量标度关系来表示同位素体的键频。\n2. 使用蒙特卡洛方法实现不确定度传播。将 $\\nu_0$ 和 $T$ 视为具有指定均值和标准差的独立正态分布变量。对于每次蒙特卡洛抽样，使用该模型计算 $X$，并用其均值和标准差总结 $X$ 的分布。\n3. 实现灵敏度分析。计算在每个测试案例中 $\\nu_0$ 和 $T$ 的均值处评估的偏导数 $\\frac{\\partial X}{\\partial \\nu_0}$ 和 $\\frac{\\partial X}{\\partial T}$。在适用时以弧度表示角度。将所有最终报告值表示为无量纲浮点数。\n\n单位和换算：\n- 输入和计算标度频率时使用 $\\nu$（单位为 $\\mathrm{cm}^{-1}$），但通过 $E = h c \\tilde{\\nu}$ 转换为能量，其中 $\\tilde{\\nu}$ 的单位为 $\\mathrm{m}^{-1}$。因此，在与 $h$ 和 $c$ 结合使用时，需要乘以 $100$ 将 $\\mathrm{cm}^{-1}$ 转换为 $\\mathrm{m}^{-1}$。\n- 温度 $T$ 的单位为 $\\mathrm{K}$。\n- 原子质量可以使用原子质量单位用于折合质量比，因为单位会抵消，但为了完整性，这里提供了到 $\\mathrm{kg}$ 的转换因子。\n\n测试套件：\n对于每个测试案例，给定 $(T_{\\mathrm{mean}}, \\sigma_T, \\nu_{0,\\mathrm{mean}}, \\sigma_{\\nu_0}, N)$，其中 $N$ 是蒙特卡洛样本数。按顺序计算并报告每个案例的结果：$X$ 的蒙特卡洛均值、$X$ 的蒙特卡洛标准差、在 $(T_{\\mathrm{mean}}, \\nu_{0,\\mathrm{mean}})$ 处的灵敏度 $\\frac{\\partial X}{\\partial \\nu_0}$，以及在 $(T_{\\mathrm{mean}}, \\nu_{0,\\mathrm{mean}})$ 处的灵敏度 $\\frac{\\partial X}{\\partial T}$。所有输出均为无量纲浮点数。\n\n使用以下四个测试案例：\n- 案例 $1$：$(T_{\\mathrm{mean}} = 298, \\ \\sigma_T = 1, \\ \\nu_{0,\\mathrm{mean}} = 1400, \\ \\sigma_{\\nu_0} = 3, \\ N = 50000)$，\n- 案例 $2$：$(T_{\\mathrm{mean}} = 200, \\ \\sigma_T = 0.5, \\ \\nu_{0,\\mathrm{mean}} = 1400, \\ \\sigma_{\\nu_0} = 3, \\ N = 50000)$，\n- 案例 $3$：$(T_{\\mathrm{mean}} = 1000, \\ \\sigma_T = 5, \\ \\nu_{0,\\mathrm{mean}} = 1400, \\ \\sigma_{\\nu_0} = 5, \\ N = 50000)$，\n- 案例 $4$：$(T_{\\mathrm{mean}} = 298, \\ \\sigma_T = 0, \\ \\nu_{0,\\mathrm{mean}} = 1400, \\ \\sigma_{\\nu_0} = 0, \\ N = 1)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按顺序汇总的四个测试案例的所有结果，格式为方括号内以逗号分隔的列表。具体来说，最终输出必须是\n$[x_1, s_1, a_1, b_1, x_2, s_2, a_2, b_2, x_3, s_3, a_3, b_3, x_4, s_4, a_4, b_4]$,\n其中 $x_i$ 是案例 $i$ 的 $X$ 的蒙特卡洛均值，$s_i$ 是案例 $i$ 的 $X$ 的蒙特卡洛标准差，$a_i$ 是案例 $i$ 的 $\\frac{\\partial X}{\\partial \\nu_0}$，$b_i$ 是案例 $i$ 的 $\\frac{\\partial X}{\\partial T}$。所有条目都是无量纲浮点数，不附带单位。",
            "solution": "该问题要求基于统计力学和量子力学的第一性原理，为二氧化碳中的团簇同位素平衡构建一个计算模型。我们必须为指定的同位素交换反应推导出团簇指数 $X = \\ln{K}$ 的表达式，实现不确定度和灵敏度分析，并将该模型应用于一系列测试案例。\n\n### 步骤 1：理论推导\n\n指定的同位素交换反应是：\n$$\n^{13}\\mathrm{C}^{18}\\mathrm{O}^{16}\\mathrm{O} + {}^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O} \\leftrightarrow {}^{13}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O} + {}^{12}\\mathrm{C}^{18}\\mathrm{O}^{16}\\mathrm{O}\n$$\n我们将分子种类表示为：\n- $A = {}^{13}\\mathrm{C}^{18}\\mathrm{O}^{16}\\mathrm{O}$ (团簇反应物)\n- $B = {}^{12}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O}$ (轻同位素反应物)\n- $C = {}^{13}\\mathrm{C}^{16}\\mathrm{O}^{16}\\mathrm{O}$ (单取代产物)\n- $D = {}^{12}\\mathrm{C}^{18}\\mathrm{O}^{16}\\mathrm{O}$ (单取代产物)\n\n反应为 $A + B \\leftrightarrow C + D$。根据正则系综的原理，平衡常数 $K$ 由产物与反应物的配分函数之比给出：\n$$\nK = \\frac{Q_C Q_D}{Q_A Q_B}\n$$\n问题指出，我们可以仅使用零点能（ZPEs）的差异来近似平衡常数。这是同位素地球化学中一种常见的简化方法，称为 Bigeleisen-Mayer 近似，它在 $k_B T$ 远小于第一振动激发态能量的温度下有效。在此近似中，平动和转动态对配分函数的贡献被假定相互抵消，而振动配分函数 $q_{vib} = \\frac{e^{-E_{ZPE}/(k_B T)}}{1 - e^{-h\\nu/(k_B T)}}$ 由其首项 $e^{-E_{ZPE}/(k_B T)}$ 近似。平衡常数于是变为：\n$$\nK \\approx \\frac{e^{-E_{ZPE,C}/(k_B T)} e^{-E_{ZPE,D}/(k_B T)}}{e^{-E_{ZPE,A}/(k_B T)} e^{-E_{ZPE,B}/(k_B T)}} = e^{-\\frac{(E_{ZPE,C} + E_{ZPE,D}) - (E_{ZPE,A} + E_{ZPE,B})}{k_B T}}\n$$\n取自然对数，我们得到团簇指数 $X$：\n$$\nX = \\ln{K} = -\\frac{\\Delta E_{ZPE}}{k_B T}\n$$\n其中 $\\Delta E_{ZPE} = (E_{ZPE,C} + E_{ZPE,D}) - (E_{ZPE,A} + E_{ZPE,B})$。\n\n该模型将每个 $\\mathrm{CO}_2$ 分子视为对应于两个 C-O 键的两个独立谐振子。单个谐振子的零点能为 $\\frac{1}{2}h\\nu$。每个分子的零点能是其两个键的零点能之和：\n- $E_{ZPE,A} = \\frac{1}{2}h(\\nu_{13C-18O} + \\nu_{13C-16O})$\n- $E_{ZPE,B} = \\frac{1}{2}h(\\nu_{12C-16O} + \\nu_{12C-16O}) = h\\nu_{12C-16O}$\n- $E_{ZPE,C} = \\frac{1}{2}h(\\nu_{13C-16O} + \\nu_{13C-16O}) = h\\nu_{13C-16O}$\n- $E_{ZPE,D} = \\frac{1}{2}h(\\nu_{12C-18O} + \\nu_{12C-16O})$\n\n将这些代入 $\\Delta E_{ZPE}$ 的表达式中：\n$$\n\\Delta E_{ZPE} = (h\\nu_{13C-16O} + \\frac{1}{2}h(\\nu_{12C-18O} + \\nu_{12C-16O})) - (\\frac{1}{2}h(\\nu_{13C-18O} + \\nu_{13C-16O}) + h\\nu_{12C-16O})\n$$\n$$\n\\Delta E_{ZPE} = \\frac{1}{2}h (\\nu_{13C-16O} + \\nu_{12C-18O} - \\nu_{13C-18O} - \\nu_{12C-16O})\n$$\n该能量差为正，表明随机分布（产物）的零点能高于团簇分布（反应物）的零点能。\n\n振动频率 $\\nu$ 与双原子键的折合质量 $\\mu$ 成 $\\nu \\propto 1/\\sqrt{\\mu}$ 的标度关系。给定 ${}^{12}\\mathrm{C}-{}^{16}\\mathrm{O}$ 键的基本频率 $\\nu_0$ 和折合质量 $\\mu_0$，任何其他同位素对的频率 $\\nu$ 为 $\\nu = \\nu_0\\sqrt{\\mu_0/\\mu}$。\n问题说明频率以波数（$\\mathrm{cm}^{-1}$）为单位提供，记为 $\\tilde{\\nu}$。能量为 $E = hc\\tilde{\\nu}$。为使用国际单位制（SI），$\\tilde{\\nu}$ 必须以 $\\mathrm{m}^{-1}$ 为单位，因此我们必须通过乘以 $100$ 将其从 $\\mathrm{cm}^{-1}$ 转换。\n设 $\\tilde{\\nu}_0$ 为 ${}^{12}\\mathrm{C}-{}^{16}\\mathrm{O}$ 以 $\\mathrm{cm}^{-1}$ 为单位的基本频率，我们将 $X$ 表示为：\n$$\nX = -\\frac{hc \\times 100}{2k_B T} (\\tilde{\\nu}_{13C-16O} + \\tilde{\\nu}_{12C-18O} - \\tilde{\\nu}_{13C-18O} - \\tilde{\\nu}_{12C-16O})\n$$\n代入标度律 $\\tilde{\\nu} = \\tilde{\\nu}_0\\sqrt{\\mu_0/\\mu}$：\n$$\nX = -\\frac{hc \\times 100 \\times \\tilde{\\nu}_0}{2k_B T} \\left( \\sqrt{\\frac{\\mu_0}{\\mu_{13-16}}} + \\sqrt{\\frac{\\mu_0}{\\mu_{12-18}}} - \\sqrt{\\frac{\\mu_0}{\\mu_{13-18}}} - 1 \\right)\n$$\n其中 $\\mu_{i\\text{-}j}$ 表示 ${}^i\\mathrm{C}-{}^j\\mathrm{O}$ 键的折合质量。我们可以基于折合质量比定义一个无量纲标度因子 $S_{\\mu}$：\n$$\nS_{\\mu} = 1 + \\sqrt{\\frac{\\mu_{12-16}}{\\mu_{13-18}}} - \\sqrt{\\frac{\\mu_{12-16}}{\\mu_{12-18}}} - \\sqrt{\\frac{\\mu_{12-16}}{\\mu_{13-16}}}\n$$\n根据这个定义，$X$ 的表达式简化为：\n$$\nX(\\tilde{\\nu}_0, T) = \\frac{hc \\times 100 \\times \\tilde{\\nu}_0}{2k_B T} S_{\\mu}\n$$\n这个方程构成了我们的模型。项 $\\frac{hc \\times 100 \\times S_{\\mu}}{2k_B}$ 是一个常数。根据零点能的排序，我们已确定 $\\Delta E_{ZPE} > 0$。因此，$X$ 将为负值，表明平衡有利于反应物（团簇物种），这与预期相符。\n\n### 步骤 2：灵敏度分析\n\n灵敏度分析需要计算 $X$ 相对于 $\\tilde{\\nu}_0$ 和 $T$ 的偏导数。设 $C = \\frac{hc \\times 100 \\times S_{\\mu}}{2k_B}$。我们的模型是 $X = C \\frac{\\tilde{\\nu}_0}{T}$。\n$X$ 相对于 $\\tilde{\\nu}_0$ 的偏导数是：\n$$\n\\frac{\\partial X}{\\partial \\tilde{\\nu}_0} = \\frac{C}{T} = \\frac{X}{\\tilde{\\nu}_0}\n$$\n$X$ 相对于 $T$ 的偏导数是：\n$$\n\\frac{\\partial X}{\\partial T} = -C \\frac{\\tilde{\\nu}_0}{T^2} = -\\frac{X}{T}\n$$\n这些导数将在每个测试案例的均值 $(\\tilde{\\nu}_{0,\\mathrm{mean}}, T_{\\mathrm{mean}})$ 处进行评估。\n\n### 步骤 3：数值实现\n\n对于每个测试案例 $(T_{\\mathrm{mean}}, \\sigma_T, \\tilde{\\nu}_{0,\\mathrm{mean}}, \\sigma_{\\tilde{\\nu}_0}, N)$，算法如下：\n1.  使用提供的原子质量，计算四种键类型（${}^{12}\\mathrm{C}-{}^{16}\\mathrm{O}$、${}^{13}\\mathrm{C}-{}^{18}\\mathrm{O}$、${}^{12}\\mathrm{C}-{}^{18}\\mathrm{O}$、${}^{13}\\mathrm{C}-{}^{16}\\mathrm{O}$）的折合质量。\n2.  计算无量纲常数标度因子 $S_{\\mu}$。\n3.  **蒙特卡洛模拟**：\n    - 从正态分布 $\\mathcal{N}(T_{\\mathrm{mean}}, \\sigma_T^2)$ 中为温度 $T$ 生成 $N$ 个随机样本。\n    - 从正态分布 $\\mathcal{N}(\\tilde{\\nu}_{0,\\mathrm{mean}}, \\sigma_{\\tilde{\\nu}_0}^2)$ 中为频率 $\\tilde{\\nu}_0$ 生成 $N$ 个随机样本。\n    - 对于每对样本 $(T_i, \\tilde{\\nu}_{0,i})$，计算 $X_i = \\frac{hc \\times 100 \\times S_{\\mu}}{2k_B} \\frac{\\tilde{\\nu}_{0,i}}{T_i}$。\n    - 计算得到的 $N$ 个 $X_i$ 值的均值和标准差。\n4.  **灵敏度计算**：\n    - 在平均输入值 $T_{\\mathrm{mean}}$ 和 $\\tilde{\\nu}_{0,\\mathrm{mean}}$ 处评估 $\\frac{\\partial X}{\\partial \\tilde{\\nu}_0}$ 和 $\\frac{\\partial X}{\\partial T}$ 的解析表达式。\n5.  收集每个测试案例的四个结果值（$X$ 的蒙特卡洛均值、$X$ 的蒙特卡洛标准差、$\\frac{\\partial X}{\\partial \\tilde{\\nu}_0}$、$\\frac{\\partial X}{\\partial T}$），并按指定格式进行格式化。\n对于案例 4，其中 $\\sigma_T = 0$、$\\sigma_{\\tilde{\\nu}_0} = 0$ 且 $N=1$，蒙特卡洛模拟简化为单次确定性计算，标准差正确地报告为 $0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the clumped isotope modeling problem by deriving the clumping index X,\n    performing Monte Carlo uncertainty propagation, and conducting a sensitivity analysis.\n    \"\"\"\n\n    # Physical constants\n    h = 6.62607015e-34  # Planck's constant (J*s)\n    c = 2.99792458e8    # Speed of light (m/s)\n    k_B = 1.380649e-23   # Boltzmann constant (J/K)\n    # u = 1.66053906660e-27 # Atomic mass unit (kg) - not needed for ratios\n\n    # Atomic masses (in atomic mass units, u)\n    masses = {\n        '12C': 12.000000,\n        '13C': 13.003355,\n        '16O': 15.994915,\n        '18O': 17.999160,\n    }\n\n    # Function to calculate reduced mass\n    def get_reduced_mass(m1, m2):\n        return (m1 * m2) / (m1 + m2)\n\n    # Calculate reduced masses for all relevant C-O bonds\n    mu_12_16 = get_reduced_mass(masses['12C'], masses['16O'])  # This is mu_0\n    mu_13_18 = get_reduced_mass(masses['13C'], masses['18O'])\n    mu_12_18 = get_reduced_mass(masses['12C'], masses['18O'])\n    mu_13_16 = get_reduced_mass(masses['13C'], masses['16O'])\n\n    # Calculate the dimensionless frequency scaling factor S_mu\n    # S_mu = 1 + sqrt(mu_0/mu_13-18) - sqrt(mu_0/mu_12-18) - sqrt(mu_0/mu_13-16)\n    S_mu = (1.0 + np.sqrt(mu_12_16 / mu_13_18) - \n            np.sqrt(mu_12_16 / mu_12_18) - \n            np.sqrt(mu_12_16 / mu_13_16))\n\n    # Pre-compute the main constant factor for X\n    # X = const_factor * nu_0 / T\n    # The factor of 100 converts nu_0 from cm^-1 to m^-1\n    const_factor = (h * c * 100.0 * S_mu) / (2.0 * k_B)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (298.0, 1.0, 1400.0, 3.0, 50000),   # Case 1\n        (200.0, 0.5, 1400.0, 3.0, 50000),   # Case 2\n        (1000.0, 5.0, 1400.0, 5.0, 50000),  # Case 3\n        (298.0, 0.0, 1400.0, 0.0, 1),       # Case 4\n    ]\n\n    results = []\n    # Use a fixed seed for reproducibility of the Monte Carlo simulation\n    rng = np.random.default_rng(seed=42)\n\n    for case in test_cases:\n        T_mean, sigma_T, nu0_mean, sigma_nu0, N = case\n\n        # Monte Carlo simulation for X\n        if N > 1:\n            T_samples = rng.normal(T_mean, sigma_T, N)\n            # Ensure no non-positive temperatures if sigma is large, though unlikely here\n            T_samples[T_samples <= 0] = T_mean \n            nu0_samples = rng.normal(nu0_mean, sigma_nu0, N)\n        else: # Deterministic case (N=1)\n            T_samples = np.array([T_mean])\n            nu0_samples = np.array([nu0_mean])\n            \n        # Calculate X for all samples\n        X_samples = const_factor * nu0_samples / T_samples\n\n        # Calculate mean and standard deviation of X\n        X_mean = np.mean(X_samples)\n        X_std = np.std(X_samples)\n\n        # Sensitivity analysis (partial derivatives)\n        # dX/d(nu_0) = C / T\n        # dX/dT = -C * nu_0 / T^2\n        # where C = const_factor\n        \n        # Evaluated at mean values\n        sensitivity_nu0 = const_factor / T_mean\n        sensitivity_T = -const_factor * nu0_mean / (T_mean**2)\n        \n        results.extend([X_mean, X_std, sensitivity_nu0, sensitivity_T])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{val:.8g}' for val in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型的优劣取决于用于检验它们的数据，而高精度同位素测量面临一个主要障碍：仪器质量分馏。这最后一个实践 () 介绍了双稀释剂技术，这是一种克服这一挑战的强大分析方法。通过编写代码来模拟并数值反演一个双稀释剂实验，您将获得处理数据以获得准确同位素组成的实践经验，这对任何实验地球化学家来说都是一项关键技能。",
            "id": "4088404",
            "problem": "考虑一个铁元素的同位素体系，该体系有四种稳定同位素，其质量数分别为 $m_1 = 54$、$m_2 = 56$、$m_3 = 57$ 和 $m_4 = 58$。设参考同位素丰度为 $x_1^{\\mathrm{ref}} = 0.05845$、$x_2^{\\mathrm{ref}} = 0.91754$、$x_3^{\\mathrm{ref}} = 0.02119$ 和 $x_4^{\\mathrm{ref}} = 0.00282$，其总和为 $1$。制备一种双稀释剂溶液，其同位素丰度 $s_i$ 已知，其中 $i \\in \\{1,2,3,4\\}$。通过混合比例为 $f$ 的样品和比例为 $1-f$ 的稀释剂来制备混合物。\n\n假设真实的样品同位素组成是由参考组分通过质量分馏定律生成的，因此未归一化的样品丰度由 $x_i^{\\prime} = x_i^{\\mathrm{ref}} \\exp\\left(\\alpha_s (m_i - m_1)\\right)$ 给出，其中 $\\alpha_s$ 是一个未知标量参数，表示相对于基准同位素 $m_1 = 54$ 的样品内部质量分馏。归一化后的真实样品丰度为 $x_i = x_i^{\\prime} \\big/ \\sum_{k=1}^{4} x_k^{\\prime}$。仪器效应发生前的混合物丰度为 $M_i = f x_i + (1-f) s_i$。\n\n测量过程中的仪器质量歧视由指数定律表示，即同位素 $i$ 与同位素 $j$ 的任意测量比值 $r_{i/j}$ 与真实混合物通过 $r_{i/j} = (M_i/M_j) \\exp\\left(\\beta (m_i - m_j)\\right)$ 相关，其中 $\\beta$ 是一个未知的仪器分馏参数。假设从同一样混合物中获得了两个测量比值：$r_{56/54}$ 和 $r_{58/57}$。在所述的指数定律下，这两个比值以及稀释剂组分和混合比例足以确定两个未知数 $\\alpha_s$ 和 $\\beta$。\n\n你的任务是仅使用上述基本质量平衡和指数分馏定律，推导、实现并数值求解关于 $\\alpha_s$ 和 $\\beta$ 的方程组。然后，根据恢复的 $\\alpha_s$ 计算真实样品比值 $R_{56/54}^{\\mathrm{true}} = x_2/x_1$。\n\n你必须编写一个完整、可运行的程序，对于下面的每个测试用例，该程序使用上述定律和已知的真实参数生成合成的测量比值，然后仅从测量比值、$f$、$s_i$、$x_i^{\\mathrm{ref}}$ 和 $m_i$ 反演系统以恢复 $\\alpha_s$ 和 $\\beta$。最后，报告恢复的 $R_{56/54}^{\\mathrm{true}}$。\n\n测试套件如下。对于每个用例，质量数数组为 $[54, 56, 57, 58]$，参考丰度为 $[0.05845, 0.91754, 0.02119, 0.00282]$。\n\n- 用例 1 (一般情况)：稀释剂丰度 $s = [0.01, 0.04, 0.45, 0.50]$，混合比例 $f = 0.5$，真实样品分馏参数 $\\alpha_s^{\\mathrm{true}} = 0.0020$，真实仪器分馏参数 $\\beta^{\\mathrm{true}} = 0.0015$。\n- 用例 2 (样品比例较低的边界情况)：稀释剂丰度 $s = [0.01, 0.04, 0.45, 0.50]$，混合比例 $f = 0.1$，真实样品分馏参数 $\\alpha_s^{\\mathrm{true}} = -0.0010$，真实仪器分馏参数 $\\beta^{\\mathrm{true}} = 0.0020$。\n- 用例 3 (稀释剂富集程度较低的边缘情况)：稀释剂丰度 $s = [0.10, 0.10, 0.40, 0.40]$，混合比例 $f = 0.8$，真实样品分馏参数 $\\alpha_s^{\\mathrm{true}} = 0.0030$，真实仪器分馏参数 $\\beta^{\\mathrm{true}} = -0.0010$。\n\n你的程序应该：\n- 对于每个用例，使用所述定律和真实参数计算合成的测量比值 $r_{56/54}$ 和 $r_{58/57}$。\n- 根据测量比值、$f$、$s$、$x^{\\mathrm{ref}}$ 和 $m$ 反演系统以确定 $\\alpha_s$ 和 $\\beta$。\n- 为恢复的 $\\alpha_s$ 计算并返回 $R_{56/54}^{\\mathrm{true}} = x_2/x_1$。\n\n将每个最终比值 $R_{56/54}^{\\mathrm{true}}$ 表示为浮点数，四舍五入到六位小数，无物理单位。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[r_1,r_2,r_3]$，其中每个 $r_k$ 是第 $k$ 个用例恢复的 $R_{56/54}^{\\mathrm{true}}$，四舍五入到六位小数。",
            "solution": "用户想要解决一个双稀释剂同位素地球化学问题。我必须首先验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **同位素**：铁元素，有四种稳定同位素。\n- **质量数**：$m_1 = 54$、$m_2 = 56$、$m_3 = 57$、$m_4 = 58$。\n- **参考同位素丰度 ($x_i^{\\mathrm{ref}}$)**：$x_1^{\\mathrm{ref}} = 0.05845$、$x_2^{\\mathrm{ref}} = 0.91754$、$x_3^{\\mathrm{ref}} = 0.02119$、$x_4^{\\mathrm{ref}} = 0.00282$。\n- **稀释剂同位素丰度 ($s_i$)**：一种双稀释剂溶液的已知组成。\n- **混合比例 ($f$)**：比例为 $f$ 的样品与比例为 $1-f$ 的稀释剂混合。\n- **样品分馏定律**：真实样品组成通过指数质量分馏定律从参考组成推导而来。\n  - 未归一化的样品丰度：$x_i^{\\prime} = x_i^{\\mathrm{ref}} \\exp\\left(\\alpha_s (m_i - m_1)\\right)$，其中 $\\alpha_s$ 是一个未知参数。\n  - 归一化后的真实样品丰度：$x_i = x_i^{\\prime} \\big/ \\sum_{k=1}^{4} x_k^{\\prime}$。\n- **混合物组成**：混合物的同位素丰度由质量平衡方程 $M_i = f x_i + (1-f) s_i$ 给出。\n- **仪器分馏定律**：测量比值 $r_{i/j}$ 通过 $r_{i/j} = (M_i/M_j) \\exp\\left(\\beta (m_i - m_j)\\right)$ 与真实混合物丰度 $M_i$ 相关，其中 $\\beta$ 是一个未知参数。\n- **测量值**：测量两个比值：$r_{56/54}$ 和 $r_{58/57}$。\n- **任务**：\n  1. 对于每个测试用例，使用给定的真实参数（$\\alpha_s^{\\mathrm{true}}$、$\\beta^{\\mathrm{true}}$）生成合成的测量比值（$r_{56/54}$、$r_{58/57}$）。\n  2. 实现一种数值方法，仅使用合成的测量比值和已知的实验参数（$f, s_i, x_i^{\\mathrm{ref}}, m_i$）来求解 $\\alpha_s$ 和 $\\beta$。\n  3. 从求解出的 $\\alpha_s$ 计算真实样品比值 $R_{56/54}^{\\mathrm{true}} = x_2/x_1$。\n- **测试用例**：\n  - 用例 1：$s = [0.01, 0.04, 0.45, 0.50]$，$f = 0.5$，$\\alpha_s^{\\mathrm{true}} = 0.0020$，$\\beta^{\\mathrm{true}} = 0.0015$。\n  - 用例 2：$s = [0.01, 0.04, 0.45, 0.50]$，$f = 0.1$，$\\alpha_s^{\\mathrm{true}} = -0.0010$，$\\beta^{\\mathrm{true}} = 0.0020$。\n  - 用例 3：$s = [0.10, 0.10, 0.40, 0.40]$，$f = 0.8$，$\\alpha_s^{\\mathrm{true}} = 0.0030$，$\\beta^{\\mathrm{true}} = -0.0010$。\n- **输出**：一个包含每个用例恢复的 $R_{56/54}^{\\mathrm{true}}$ 值的列表，四舍五入到六位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据充分**：该问题基于同位素质量平衡和质量分馏原理，这些是同位素地球化学的基石。使用指数定律来描述分馏是一个标准且有物理依据的模型。双稀释剂技术是校正仪器质量歧视的成熟分析方法。该问题在科学上是合理的。\n2.  **问题适定**：问题建立了一个包含两个方程（从两个测量比值 $r_{56/54}$ 和 $r_{58/57}$ 导出）和两个未知数（$\\alpha_s$ 和 $\\beta$）的方程组。这表明，只要稀释剂的组成选择得当（测试用例中就是如此），很可能存在唯一解。任务是数值求解这个问题，这是处理这类非线性系统的标准方法。问题是适定的。\n3.  **客观性**：所有参数和定律都用数学精确定义。没有主观、模糊或基于观点的语言。\n4.  **完整且一致**：提供了所有必要的数据（质量数、参考丰度、稀释剂组成、混合比例）和函数关系。定义在内部是一致的（例如，参考丰度总和为1）。问题是自洽的。\n5.  **现实性**：分馏因子（$\\alpha_s, \\beta$）的数值对于自然和仪器过程来说是现实的量级（千分之几水平的分馏）。混合比例和稀释剂组成在实验室环境中也是合理的。\n6.  **无其他缺陷**：问题不属于琐碎、隐喻性或超出科学验证范围的类别。\n\n### 步骤 3：结论与行动\n问题有效。我现在将着手解决。\n\n这个问题的核心是求解一个包含两个未知数（样品分馏参数 $\\alpha_s$ 和仪器分馏参数 $\\beta$）的非线性方程组。\n\n让我们用索引 1 到 4 定义我们的四种同位素，分别对应质量数 54、56、57、58。\n测量的比值为：\n$$\nr_{2/1} = \\frac{M_2}{M_1} \\exp(\\beta (m_2 - m_1))\n$$\n$$\nr_{4/3} = \\frac{M_4}{M_3} \\exp(\\beta (m_4 - m_3))\n$$\n混合物丰度 $M_i$ 依赖于未知的 $\\alpha_s$：\n$$\nM_i = f x_i + (1-f) s_i = f \\frac{x_i^{\\mathrm{ref}} \\exp(\\alpha_s (m_i - m_1))}{\\sum_{k=1}^{4} x_k^{\\mathrm{ref}} \\exp(\\alpha_s (m_k - m_1))} + (1-f) s_i\n$$\n让我们定义归一化因子 $N(\\alpha_s) = \\sum_{k=1}^{4} x_k^{\\mathrm{ref}} \\exp(\\alpha_s (m_k - m_1))$。\n那么，$M_i = f \\frac{x_i^{\\mathrm{ref}} \\exp(\\alpha_s (m_i - m_1))}{N(\\alpha_s)} + (1-f) s_i$。\n\n我们可以从这两个比值方程中分别求解 $\\beta$。将这两个 $\\beta$ 的表达式相等，将得到一个只含 $\\alpha_s$ 的方程。\n从第一个比值（$r_{2/1} = r_{56/54}$）得到：\n$$\n\\beta = \\frac{1}{m_2 - m_1} \\ln\\left(r_{2/1} \\frac{M_1}{M_2}\\right)\n$$\n从第二个比值（$r_{4/3} = r_{58/57}$）得到：\n$$\n\\beta = \\frac{1}{m_4 - m_3} \\ln\\left(r_{4/3} \\frac{M_3}{M_4}\\right)\n$$\n比值 $M_j/M_i$ 可以表示为 $\\alpha_s$ 的函数：\n$$\n\\frac{M_j}{M_i} = \\frac{f x_j + (1-f) s_j}{f x_i + (1-f) s_i} = \\frac{f \\frac{x_j^{\\mathrm{ref}} \\exp(\\alpha_s (m_j - m_1))}{N(\\alpha_s)} + (1-f) s_j}{f \\frac{x_i^{\\mathrm{ref}} \\exp(\\alpha_s (m_i - m_1))}{N(\\alpha_s)} + (1-f) s_i}\n$$\n分子和分母同乘以 $N(\\alpha_s)$ 得到：\n$$\n\\frac{M_j}{M_i} = \\frac{f x_j^{\\mathrm{ref}} \\exp(\\alpha_s (m_j - m_1)) + (1-f) s_j N(\\alpha_s)}{f x_i^{\\mathrm{ref}} \\exp(\\alpha_s (m_i - m_1)) + (1-f) s_i N(\\alpha_s)}\n$$\n注意，当 $j=1$ 时，指数项 $\\exp(\\alpha_s (m_1 - m_1))$ 为 $1$。\n\n通过令两个 $\\beta$ 的表达式相等，我们得到了一个关于 $\\alpha_s$ 的高度非线性方程：\n$$\n\\frac{1}{m_2 - m_1} \\ln\\left(r_{2/1} \\frac{M_1(\\alpha_s)}{M_2(\\alpha_s)}\\right) = \\frac{1}{m_4 - m_3} \\ln\\left(r_{4/3} \\frac{M_3(\\alpha_s)}{M_4(\\alpha_s)}\\right)\n$$\n这个形式为 $g(\\alpha_s) = h(\\alpha_s)$ 的方程无法解析求解。我们定义一个目标函数 $F(\\alpha_s) = g(\\alpha_s) - h(\\alpha_s) = 0$，并使用数值求根算法来找到 $\\alpha_s$。\n\n每个测试用例的算法如下：\n1.  **正向模型**：给定“真实”参数 $\\alpha_s^{\\mathrm{true}}$ 和 $\\beta^{\\mathrm{true}}$，计算真实样品组成 $x_i$、真实混合物组成 $M_i$，最后计算合成的“测量”比值 $r_{56/54}$ 和 $r_{58/57}$。这为反演步骤提供了输入数据。\n2.  **反演模型**：\n    a. 定义一个目标函数 `objective_function(alpha_s_guess)`，该函数计算从两个合成比值计算出的两个 $\\beta$ 值之差，作为猜测的 `alpha_s_guess` 的函数。\n    b. 使用一个数值求解器，特别是 `scipy.optimize.root_scalar`，来找到该目标函数的根。这个根就是求解出的样品分馏参数 $\\alpha_s^{\\mathrm{solved}}$。\n3.  **最终计算**：一旦找到 $\\alpha_s^{\\mathrm{solved}}$，计算真实样品的同位素比值 $R_{56/54}^{\\mathrm{true}}$。这个比值只依赖于参考组成和 $\\alpha_s$，因为归一化项会消去：\n$$\nR_{56/54}^{\\mathrm{true}} = \\frac{x_2}{x_1} = \\frac{x_2^{\\mathrm{ref}} \\exp(\\alpha_s^{\\mathrm{solved}} (m_2-m_1)) / N(\\alpha_s^{\\mathrm{solved}})}{x_1^{\\mathrm{ref}} / N(\\alpha_s^{\\mathrm{solved}})} = \\frac{x_2^{\\mathrm{ref}}}{x_1^{\\mathrm{ref}}} \\exp(\\alpha_s^{\\mathrm{solved}} (m_2-m_1))\n$$\n最终值按要求四舍五入到六位小数。实现将使用 `numpy` 进行高效的基于数组的计算，并使用 `scipy` 进行求根步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Main function to run the double-spike inversion for all test cases.\n    \"\"\"\n    # Define global constants from the problem statement\n    m = np.array([54.0, 56.0, 57.0, 58.0])\n    x_ref = np.array([0.05845, 0.91754, 0.02119, 0.00282])\n\n    test_cases = [\n        # Case 1 (general case)\n        {\n            \"s\": np.array([0.01, 0.04, 0.45, 0.50]),\n            \"f\": 0.5,\n            \"alpha_s_true\": 0.0020,\n            \"beta_true\": 0.0015,\n        },\n        # Case 2 (boundary case with low sample fraction)\n        {\n            \"s\": np.array([0.01, 0.04, 0.45, 0.50]),\n            \"f\": 0.1,\n            \"alpha_s_true\": -0.0010,\n            \"beta_true\": 0.0020,\n        },\n        # Case 3 (edge case with less-enriched spike)\n        {\n            \"s\": np.array([0.10, 0.10, 0.40, 0.40]),\n            \"f\": 0.8,\n            \"alpha_s_true\": 0.0030,\n            \"beta_true\": -0.0010,\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        s = case[\"s\"]\n        f = case[\"f\"]\n        alpha_s_true = case[\"alpha_s_true\"]\n        beta_true = case[\"beta_true\"]\n\n        # --- Step 1: Forward model to generate synthetic measured ratios ---\n\n        # Mass differences from the reference isotope m1=54\n        # Indices: 54->0, 56->1, 57->2, 58->3\n        m_diffs_from_m1 = m - m[0]\n        m_diff_56_54 = m[1] - m[0]\n        m_diff_58_57 = m[3] - m[2]\n\n        # Calculate true sample fractions (x_i) from alpha_s_true\n        x_prime = x_ref * np.exp(alpha_s_true * m_diffs_from_m1)\n        x_true = x_prime / np.sum(x_prime)\n\n        # Calculate true mixture fractions (M_i)\n        M_true = f * x_true + (1.0 - f) * s\n\n        # Calculate synthetic measured ratios (r_i/j)\n        r_56_54_measured = (M_true[1] / M_true[0]) * np.exp(beta_true * m_diff_56_54)\n        r_58_57_measured = (M_true[3] / M_true[2]) * np.exp(beta_true * m_diff_58_57)\n        \n        # --- Step 2: Inverse model to solve for alpha_s and beta ---\n\n        def objective_function(alpha_s_guess):\n            \"\"\"\n            Objective function for the root-finder. It computes the difference\n            between the two estimates of beta. The root is the solved alpha_s.\n            It uses variables from the outer scope: m, x_ref, s, f, and the measured ratios.\n            \"\"\"\n            N_alpha_s = np.sum(x_ref * np.exp(alpha_s_guess * m_diffs_from_m1))\n            \n            # --- Beta from r_56/54 ---\n            M1_over_M2_term_num = f * x_ref[0] + (1.0 - f) * s[0] * N_alpha_s\n            M1_over_M2_term_den = f * x_ref[1] * np.exp(alpha_s_guess * (m[1] - m[0])) + (1.0 - f) * s[1] * N_alpha_s\n            \n            arg1 = r_56_54_measured * (M1_over_M2_term_num / M1_over_M2_term_den)\n            # Prevent domain errors for np.log\n            if arg1 <= 0: return np.inf\n            beta1 = (1.0 / m_diff_56_54) * np.log(arg1)\n            \n            # --- Beta from r_58/57 ---\n            M3_over_M4_term_num = f * x_ref[2] * np.exp(alpha_s_guess * (m[2] - m[0])) + (1.0 - f) * s[2] * N_alpha_s\n            M3_over_M4_term_den = f * x_ref[3] * np.exp(alpha_s_guess * (m[3] - m[0])) + (1.0 - f) * s[3] * N_alpha_s\n            \n            arg2 = r_58_57_measured * (M3_over_M4_term_num / M3_over_M4_term_den)\n            if arg2 <= 0: return np.inf\n            beta2 = (1.0 / m_diff_58_57) * np.log(arg2)\n            \n            return beta1 - beta2\n\n        # Solve for alpha_s using a root-finding algorithm\n        # A search bracket of [-0.1, 0.1] for alpha_s is safely large for geochemical problems.\n        sol = root_scalar(objective_function, bracket=[-0.1, 0.1], method='brentq')\n        alpha_s_solved = sol.root\n\n        # --- Step 3: Compute the final result ---\n        \n        R_56_54_true_solved = (x_ref[1] / x_ref[0]) * np.exp(alpha_s_solved * m_diff_56_54)\n        \n        results.append(round(R_56_54_true_solved, 6))\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}