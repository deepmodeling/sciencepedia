{
    "hands_on_practices": [
        {
            "introduction": "任何生物地球化学模型的第一步都是准确地确定系统的热力学状态。本练习侧重于浓度和热力学活性之间的关键区别，后者才是衡量一个物种化学势的真实指标。通过在有和没有活性校正的情况下计算矿物的饱和指数（$SI$），您将亲身体会到为什么在预测矿物溶解或沉淀时，水溶液中的非理想行为是不可忽略的。",
            "id": "4096464",
            "problem": "一个温度为 $25\\,^{\\circ}\\mathrm{C}$、压力为 $1\\,\\mathrm{bar}$ 的封闭水溶液体系，含有质量摩尔浓度为 $0.5\\,\\mathrm{mol\\ kg^{-1}}$ 的氯化钠背景电解质，以及溶解的钙和碳酸根，测得其自由离子质量摩尔浓度分别为 $m_{\\mathrm{Ca^{2+}}}=1.0\\times 10^{-3}\\,\\mathrm{mol\\ kg^{-1}}$ 和 $m_{\\mathrm{CO_{3}^{2-}}}=1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}}$。假设氯化钠完全解离，并且与背景电解质相比，钙和碳酸根对离子强度的贡献可以忽略不计。考虑方解石的溶解反应 $\\mathrm{CaCO_{3}(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_{3}^{2-}}$，其平衡常数 $K$ 在质量摩尔浓度标度上由 $K = a_{\\mathrm{Ca^{2+}}}\\,a_{\\mathrm{CO_{3}^{2-}}}$ 定义，其中 $a_{i}$ 表示活度。在 $25\\,^{\\circ}\\mathrm{C}$ 时，取 $\\log_{10}K=-8.48$。饱和指数 (SI) 定义为 $\\mathrm{SI}=\\log_{10}(\\mathrm{IAP}/K)$，其中该反应的离子活度积 (IAP) 为 $\\mathrm{IAP}=a_{\\mathrm{Ca^{2+}}}\\,a_{\\mathrm{CO_{3}^{2-}}}$。在理想假设下，活度等于质量摩尔浓度 ($\\gamma_{i}=1$)。对于非理想行为，使用 $25\\,^{\\circ}\\mathrm{C}$ 时的 Davies 方程（参数 $A=0.509$）来估算离子强度 $I=0.5\\,\\mathrm{mol\\ kg^{-1}}$ 时的活度系数 $\\gamma_{i}$；取 $z_{\\mathrm{Ca^{2+}}}=+2$ 和 $z_{\\mathrm{CO_{3}^{2-}}}=-2$。计算中全程使用以10为底的对数。\n\n计算理想情况下的 $\\mathrm{SI}$ 和非理想情况下的 $\\mathrm{SI}$，然后报告其变化量 $\\Delta \\mathrm{SI}=\\mathrm{SI}_{\\text{nonideal}}-\\mathrm{SI}_{\\text{ideal}}$。将你最终报告的 $\\Delta \\mathrm{SI}$ 四舍五入到三位有效数字。将最终答案表示为一个无量纲数（无单位）。",
            "solution": "该问题要求计算当从理想溶液模型过渡到非理想溶液模型时，方解石溶解反应的饱和指数变化量 $\\Delta \\mathrm{SI}$。该变化量定义为 $\\Delta \\mathrm{SI}=\\mathrm{SI}_{\\text{nonideal}}-\\mathrm{SI}_{\\text{ideal}}$。\n\n方解石溶解的反应式为：\n$$ \\mathrm{CaCO_{3}(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{CO_{3}^{2-}} $$\n饱和指数 $\\mathrm{SI}$ 由离子活度积 $\\mathrm{IAP}$ 和平衡常数 $K$ 定义：\n$$ \\mathrm{SI} = \\log_{10}\\left(\\frac{\\mathrm{IAP}}{K}\\right) = \\log_{10}(\\mathrm{IAP}) - \\log_{10}(K) $$\n该反应的 IAP 为 $\\mathrm{IAP}=a_{\\mathrm{Ca^{2+}}}a_{\\mathrm{CO_{3}^{2-}}}$，其中 $a_i$ 表示物种 $i$ 的活度。活度通过关系式 $a_i = \\gamma_i m_i$ 与质量摩尔浓度 $m_i$ 和活度系数 $\\gamma_i$ 相关。因此，IAP 可以表示为：\n$$ \\mathrm{IAP} = (\\gamma_{\\mathrm{Ca^{2+}}} m_{\\mathrm{Ca^{2+}}}) (\\gamma_{\\mathrm{CO_{3}^{2-}}} m_{\\mathrm{CO_{3}^{2-}}}) $$\n\n在理想情况下，活度系数假设为1，即 $\\gamma_i=1$。因此，IAP 是质量摩尔浓度的乘积：\n$$ \\mathrm{IAP}_{\\text{ideal}} = m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}} $$\n理想情况下的饱和指数为：\n$$ \\mathrm{SI}_{\\text{ideal}} = \\log_{10}(m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) $$\n\n在非理想情况下，活度系数根据溶液的离子强度计算。IAP 为：\n$$ \\mathrm{IAP}_{\\text{nonideal}} = \\gamma_{\\mathrm{Ca^{2+}}} \\gamma_{\\mathrm{CO_{3}^{2-}}} m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}} $$\n非理想情况下的饱和指数为：\n$$ \\mathrm{SI}_{\\text{nonideal}} = \\log_{10}(\\gamma_{\\mathrm{Ca^{2+}}} \\gamma_{\\mathrm{CO_{3}^{2-}}} m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) $$\n利用对数的性质，该表达式可以展开为：\n$$ \\mathrm{SI}_{\\text{nonideal}} = \\log_{10}(\\gamma_{\\mathrm{Ca^{2+}}}) + \\log_{10}(\\gamma_{\\mathrm{CO_{3}^{2-}}}) + \\log_{10}(m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) $$\n\n我们现在可以构建变化量 $\\Delta \\mathrm{SI}$ 的表达式：\n$$ \\Delta \\mathrm{SI} = \\mathrm{SI}_{\\text{nonideal}} - \\mathrm{SI}_{\\text{ideal}} $$\n$$ \\Delta \\mathrm{SI} = \\left( \\log_{10}(\\gamma_{\\mathrm{Ca^{2+}}}) + \\log_{10}(\\gamma_{\\mathrm{CO_{3}^{2-}}}) + \\log_{10}(m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) \\right) - \\left( \\log_{10}(m_{\\mathrm{Ca^{2+}}} m_{\\mathrm{CO_{3}^{2-}}}) - \\log_{10}(K) \\right) $$\n涉及质量摩尔浓度和平衡常数的项相互抵消，得到一个简化的 $\\Delta \\mathrm{SI}$ 表达式：\n$$ \\Delta \\mathrm{SI} = \\log_{10}(\\gamma_{\\mathrm{Ca^{2+}}}) + \\log_{10}(\\gamma_{\\mathrm{CO_{3}^{2-}}}) $$\n\n活度系数需使用 Davies 方程进行估算。对于单个离子 $i$，Davies 方程的标准形式为：\n$$ \\log_{10}(\\gamma_i) = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right) $$\n题目给出了必要的参数：\n- 常数 $A = 0.509$。\n- 离子强度 $I = 0.5\\,\\mathrm{mol\\ kg^{-1}}$。\n- 钙离子电荷 $z_{\\mathrm{Ca^{2+}}} = +2$。\n- 碳酸根离子电荷 $z_{\\mathrm{CO_{3}^{2-}}} = -2$。\n\n首先，我们计算括号内的项，该项对于两种离子是相同的：\n$$ \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I = \\frac{\\sqrt{0.5}}{1+\\sqrt{0.5}} - 0.3(0.5) $$\n注意到 $\\sqrt{0.5} = \\frac{1}{\\sqrt{2}}$，可以简化分数项：\n$$ \\frac{\\frac{1}{\\sqrt{2}}}{1+\\frac{1}{\\sqrt{2}}} = \\frac{1}{\\sqrt{2}+1} = \\frac{\\sqrt{2}-1}{(\\sqrt{2}+1)(\\sqrt{2}-1)} = \\sqrt{2}-1 $$\n所以，括号内的表达式变为：\n$$ (\\sqrt{2}-1) - 0.15 $$\n\n现在，将此代入 $\\Delta \\mathrm{SI}$ 的表达式中：\n$$ \\Delta \\mathrm{SI} = \\left[ -A z_{\\mathrm{Ca^{2+}}}^2 \\left( (\\sqrt{2}-1) - 0.15 \\right) \\right] + \\left[ -A z_{\\mathrm{CO_{3}^{2-}}}^2 \\left( (\\sqrt{2}-1) - 0.15 \\right) \\right] $$\n$$ \\Delta \\mathrm{SI} = -A (z_{\\mathrm{Ca^{2+}}}^2 + z_{\\mathrm{CO_{3}^{2-}}}^2) \\left( (\\sqrt{2}-1) - 0.15 \\right) $$\n我们代入电荷和常数 $A$ 的数值：\n$z_{\\mathrm{Ca^{2+}}}^2 = (+2)^2 = 4$。\n$z_{\\mathrm{CO_{3}^{2-}}}^2 = (-2)^2 = 4$。\n$$ \\Delta \\mathrm{SI} = -0.509 (4 + 4) \\left( (\\sqrt{2}-1) - 0.15 \\right) $$\n$$ \\Delta \\mathrm{SI} = -0.509 \\times 8 \\times \\left( (\\sqrt{2}-1) - 0.15 \\right) $$\n$$ \\Delta \\mathrm{SI} = -4.072 \\times \\left( \\sqrt{2}-1.15 \\right) $$\n使用 $\\sqrt{2} \\approx 1.41421356$：\n$$ \\Delta \\mathrm{SI} = -4.072 \\times (1.41421356 - 1.15) $$\n$$ \\Delta \\mathrm{SI} = -4.072 \\times 0.26421356 $$\n$$ \\Delta \\mathrm{SI} \\approx -1.075876 $$\n\n题目要求将结果四舍五入到三位有效数字。\n$$ \\Delta \\mathrm{SI} \\approx -1.08 $$",
            "answer": "$$\\boxed{-1.08}$$"
        },
        {
            "introduction": "虽然热力学预测了最稳定的状态，但它并不能完全说明哪种矿物会实际形成。本练习通过研究碳酸钙的两种同质多形体——方解石和文石的沉淀，深入探讨了热力学和动力学之间至关重要的相互作用。您将计算热力学驱动力和动力学成核能垒，从而揭示为何一个较不稳定的“亚稳态”相在动力学上可能更倾向于首先形成，这在自然界中是一个普遍现象。",
            "id": "4096483",
            "problem": "在一个代表微咸水的、温度为 $T = 298.15\\,\\mathrm{K}$ 的水体系中，考虑溶解离子沉淀形成方解石或文石形态的碳酸钙。这些多晶型物被视为活度为1的纯固体，水溶液活度则使用 Debye–Hückel 理论的 Davies 扩展式进行建模。在指定温度下，为您提供有关溶液和矿物的以下数据：\n\n- 离子强度 $I = 0.05\\,\\mathrm{mol\\,kg^{-1}}$。\n- $25\\,^{\\circ}\\mathrm{C}$ 时的 Davies 参数 $A = 0.509\\,\\mathrm{kg^{1/2}\\,mol^{-1/2}}$。\n- 反应离子的摩尔浓度（对于此稀溶液，假定等于质量摩尔浓度）：$m_{\\mathrm{Ca}^{2+}} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$，$m_{\\mathrm{CO}_{3}^{2-}} = 2.0\\times 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$。\n- $298.15\\,\\mathrm{K}$ 时，基于质量摩尔浓度的标准状态下的溶度积（活度无量纲）：\n  - 方解石：$K_{\\mathrm{sp,calcite}} = 3.3\\times 10^{-9}$，\n  - 文石：$K_{\\mathrm{sp,aragonite}} = 6.0\\times 10^{-9}$。\n- 矿物-溶液界面处的界面自由能：\n  - 方解石：$\\gamma_{\\mathrm{calcite}} = 0.17\\,\\mathrm{J\\,m^{-2}}$，\n  - 文石：$\\gamma_{\\mathrm{aragonite}} = 0.12\\,\\mathrm{J\\,m^{-2}}$。\n- 密度和摩尔体积：\n  - 方解石密度 $\\rho_{\\mathrm{calcite}} = 2.71\\,\\mathrm{g\\,cm^{-3}}$，文石密度 $\\rho_{\\mathrm{aragonite}} = 2.94\\,\\mathrm{g\\,cm^{-3}}$，\n  - 碳酸钙摩尔质量 $M_{\\mathrm{CaCO_{3}}} = 100.09\\,\\mathrm{g\\,mol^{-1}}$，\n  - 因此 $V_{m,\\mathrm{calcite}} = M_{\\mathrm{CaCO_{3}}}/\\rho_{\\mathrm{calcite}}$ 且 $V_{m,\\mathrm{aragonite}} = M_{\\mathrm{CaCO_{3}}}/\\rho_{\\mathrm{aragonite}}$。\n- 普适气体常数 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n任务：\n1. 使用化学势和平衡的基本定义，计算在给定条件下每种多晶型物沉淀的吉布斯自由能变化 $\\Delta G_{\\mathrm{precip}}$。将沉淀反应视为 $\\mathrm{Ca}^{2+} + \\mathrm{CO}_{3}^{2-} \\rightarrow \\mathrm{CaCO}_{3}(s)$，并基于活度 $a_{i} = \\gamma_{i} m_{i}$ 进行计算，其中 $\\gamma_{i}$ 是由 Davies 方程得到的活度系数。\n2. 使用经典成核理论（CNT）中关于球形成核的均相成核模型，根据界面自由能、摩尔体积和由过饱和度推导出的热力学驱动力，估算每种多晶型物的成核能垒 $\\Delta G^{*}$。假设每摩尔化学式的体驱动力为 $R T \\ln S$，其中 $S$ 是与您基于活度的热力学计算一致定义的过饱和比。\n3. 根据您的结果，确定哪个相在热力学上更有利，以及哪个相可能由于动力学因素而作为亚稳相持续存在。选择以下最佳陈述。\n\n选项：\nA. 方解石具有更负的 $\\Delta G_{\\mathrm{precip}}$，因此在热力学上更有利；然而，文石可以亚稳态存在，因为在这些条件下其较低的界面自由能导致了更小的 $\\Delta G^{*}$。\nB. 文石具有更负的 $\\Delta G_{\\mathrm{precip}}$，因为其溶度积更低，所以在热力学上更有利；方解石以亚稳态存在，因为它经历了更高的过饱和度。\nC. 两种多晶型物具有相等的 $\\Delta G_{\\mathrm{precip}}$，因为它们具有相同的化学式；无论哪个相先成核，都将持续存在，这与界面性质无关。\nD. 在给定条件下，方解石在热力学和动力学上都更有利，这意味着文石不能以任何可观的速率成核，也不会持续存在。",
            "solution": "用户提供了一个关于碳酸钙多晶型物沉淀的计算地球化学问题。第一步是验证问题陈述。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n-   温度：$T = 298.15\\,\\mathrm{K}$\n-   离子强度：$I = 0.05\\,\\mathrm{mol\\,kg^{-1}}$\n-   Davies 参数：$A = 0.509\\,\\mathrm{kg^{1/2}\\,mol^{-1/2}}$\n-   离子质量摩尔浓度：$m_{\\mathrm{Ca}^{2+}} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,kg^{-1}}$，$m_{\\mathrm{CO}_{3}^{2-}} = 2.0\\times 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$\n-   $298.15\\,\\mathrm{K}$ 时的溶度积：$K_{\\mathrm{sp,calcite}} = 3.3\\times 10^{-9}$，$K_{\\mathrm{sp,aragonite}} = 6.0\\times 10^{-9}$\n-   界面自由能：$\\gamma_{\\mathrm{calcite}} = 0.17\\,\\mathrm{J\\,m^{-2}}$，$\\gamma_{\\mathrm{aragonite}} = 0.12\\,\\mathrm{J\\,m^{-2}}$\n-   密度：$\\rho_{\\mathrm{calcite}} = 2.71\\,\\mathrm{g\\,cm^{-3}}$，$\\rho_{\\mathrm{aragonite}} = 2.94\\,\\mathrm{g\\,cm^{-3}}$\n-   $\\mathrm{CaCO}_{3}$ 的摩尔质量：$M_{\\mathrm{CaCO}_{3}} = 100.09\\,\\mathrm{g\\,mol^{-1}}$\n-   摩尔体积：$V_{m,\\mathrm{polymorph}} = M_{\\mathrm{CaCO_{3}}}/\\rho_{\\mathrm{polymorph}}$\n-   普适气体常数：$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n-   水溶液活度使用 Davies 方程建模。\n-   纯固体的活度为1。\n-   假定摩尔浓度等于质量摩尔浓度。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题具有科学依据，植根于化学热力学和动力学（溶解度、活度、吉布斯自由能、经典成核理论）的基本原理。所有提供的数据对于微咸水体系和指定的矿物都是物理上现实的。问题提法得当，为所要求的计算提供了所有必要信息。对于给定的离子强度，使用 Davies 方程是合适的。热力学稳定性（与 $K_{\\mathrm{sp}}$ 相关）和动力学有利性（与成核能垒 $\\Delta G^{*}$ 相关）之间的区别是地球化学中的一个核心概念，尤其是在涉及方解石和文石等多晶型物时。问题陈述中不包含科学或事实上的不健全、矛盾或含糊之处。\n\n**步骤3：结论与行动**\n问题陈述内部一致、科学上合理且提法得当。因此，它被判定为**有效**。现在将推导解答。\n\n### 解答推导\n\n该问题需要一个两部分的分析：首先，确定方解石和文石沉淀的热力学有利性；其次，通过成核能垒评估动力学有利性。\n\n**1. 热力学分析：沉淀的吉布斯自由能（$\\Delta G_{\\mathrm{precip}}$）**\n\n沉淀反应为 $\\mathrm{Ca}^{2+}(aq) + \\mathrm{CO}_{3}^{2-}(aq) \\rightarrow \\mathrm{CaCO}_{3}(s)$。\n在非标准条件下，此过程的吉布斯自由能变化由下式给出：\n$$ \\Delta G_{\\mathrm{precip}} = \\Delta G_{\\mathrm{precip}}^{\\circ} + RT \\ln Q $$\n其中 $\\Delta G_{\\mathrm{precip}}^{\\circ}$ 是标准吉布斯自由能变化，$Q$ 是反应商。对于该反应，$Q = \\frac{a_{\\mathrm{CaCO}_3(s)}}{a_{\\mathrm{Ca}^{2+}} a_{\\mathrm{CO}_3^{2-}}}$。鉴于纯固体活度 $a_{\\mathrm{CaCO}_3(s)} = 1$，反应商简化为 $Q = \\frac{1}{IAP}$，其中 $IAP = a_{\\mathrm{Ca}^{2+}} a_{\\mathrm{CO}_{3}^{2-}}$ 是离子活度积。\n标准自由能变化与溶度积 $K_{\\mathrm{sp}}$ 的关系为 $\\Delta G_{\\mathrm{precip}}^{\\circ} = RT \\ln K_{\\mathrm{sp}}$。\n代入这些关系，我们得到：\n$$ \\Delta G_{\\mathrm{precip}} = RT \\ln K_{\\mathrm{sp}} + RT \\ln\\left(\\frac{1}{IAP}\\right) = RT \\ln\\left(\\frac{K_{\\mathrm{sp}}}{IAP}\\right) = -RT \\ln\\left(\\frac{IAP}{K_{\\mathrm{sp}}}\\right) $$\n过饱和比定义为 $S = \\frac{IAP}{K_{\\mathrm{sp}}}$。因此，沉淀的热力学驱动力为：\n$$ \\Delta G_{\\mathrm{precip}} = -RT \\ln S $$\n更负的 $\\Delta G_{\\mathrm{precip}}$ 值表示更大的沉淀热力学驱动力。\n\n首先，我们使用 Davies 方程计算 $\\mathrm{Ca}^{2+}$ 和 $\\mathrm{CO}_{3}^{2-}$ 的活度系数（$\\gamma_{i}$）：\n$$ \\log_{10} \\gamma_{i} = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right) $$\n使用 $A = 0.509\\,\\mathrm{kg^{1/2}\\,mol^{-1/2}}$，$I = 0.05\\,\\mathrm{mol\\,kg^{-1}}$，以及两种离子的电荷量 $|z_i| = 2$ ($z_i^2=4$)：\n$$ \\sqrt{I} = \\sqrt{0.05} \\approx 0.2236 $$\n$$ \\log_{10} \\gamma_{\\pm 2} = - (0.509) (4) \\left( \\frac{0.2236}{1+0.2236} - 0.3 \\times 0.05 \\right) $$\n$$ \\log_{10} \\gamma_{\\pm 2} = -2.036 \\left( 0.1827 - 0.015 \\right) = -2.036 \\times 0.1677 \\approx -0.3415 $$\n$$ \\gamma_{\\pm 2} = 10^{-0.3415} \\approx 0.4555 $$\n$\\mathrm{Ca}^{2+}$ 和 $\\mathrm{CO}_{3}^{2-}$ 的活度系数相同。\n\n接下来，我们计算活度和离子活度积（$IAP$）：\n$$ a_{\\mathrm{Ca}^{2+}} = \\gamma_{\\mathrm{Ca}^{2+}} m_{\\mathrm{Ca}^{2+}} = (0.4555) \\times (1.0\\times 10^{-3}) = 4.555 \\times 10^{-4} $$\n$$ a_{\\mathrm{CO}_{3}^{2-}} = \\gamma_{\\mathrm{CO}_{3}^{2-}} m_{\\mathrm{CO}_{3}^{2-}} = (0.4555) \\times (2.0\\times 10^{-4}) = 9.110 \\times 10^{-5} $$\n$$ IAP = a_{\\mathrm{Ca}^{2+}} a_{\\mathrm{CO}_{3}^{2-}} = (4.555 \\times 10^{-4}) \\times (9.110 \\times 10^{-5}) \\approx 4.150 \\times 10^{-8} $$\n\n现在，我们使用 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和 $T = 298.15\\,\\mathrm{K}$ 计算每种多晶型物的 $\\Delta G_{\\mathrm{precip}}$，因此 $RT \\approx 2479\\,\\mathrm{J\\,mol^{-1}}$。\n\n**方解石：**\n$K_{\\mathrm{sp,calcite}} = 3.3\\times 10^{-9}$\n$S_{\\mathrm{calcite}} = \\frac{IAP}{K_{\\mathrm{sp,calcite}}} = \\frac{4.150 \\times 10^{-8}}{3.3 \\times 10^{-9}} \\approx 12.58$\n$\\Delta G_{\\mathrm{precip,calcite}} = - (2479\\,\\mathrm{J\\,mol^{-1}}) \\times \\ln(12.58) \\approx - (2479) \\times (2.532) \\approx -6277\\,\\mathrm{J\\,mol^{-1}}$ 或 $-6.28\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n**文石：**\n$K_{\\mathrm{sp,aragonite}} = 6.0\\times 10^{-9}$\n$S_{\\mathrm{aragonite}} = \\frac{IAP}{K_{\\mathrm{sp,aragonite}}} = \\frac{4.150 \\times 10^{-8}}{6.0 \\times 10^{-9}} \\approx 6.92$\n$\\Delta G_{\\mathrm{precip,aragonite}} = - (2479\\,\\mathrm{J\\,mol^{-1}}) \\times \\ln(6.92) \\approx - (2479) \\times (1.934) \\approx -4794\\,\\mathrm{J\\,mol^{-1}}$ 或 $-4.79\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n由于 $\\Delta G_{\\mathrm{precip,calcite}}  \\Delta G_{\\mathrm{precip,aragonite}}$（即，其值更负），方解石的沉淀在热力学上更有利。这与方解石具有更低的溶度积（$K_{\\mathrm{sp}}$）相一致，这标志着固相具有更高的稳定性。\n\n**2. 动力学分析：成核能垒（$\\Delta G^{*}$）**\n\n根据经典成核理论（CNT）中关于球形晶体均相成核的模型，成核的自由能能垒为：\n$$ \\Delta G^{*} = \\frac{16 \\pi \\gamma^3 V_m^2}{3 (RT \\ln S)^2} $$\n其中 $\\gamma$ 是界面自由能，$V_m$ 是固体的摩尔体积，$RT \\ln S$ 是摩尔热力学驱动力的大小（$-\\Delta G_{\\mathrm{precip}}$）。更低的 $\\Delta G^{*}$ 对应更快的成核速率，使得该相在动力学上更有利。\n\n首先，我们计算摩尔体积（$V_m$）。\n$M_{\\mathrm{CaCO}_{3}} = 100.09\\,\\mathrm{g\\,mol^{-1}}$。\n$$ V_{m,\\mathrm{calcite}} = \\frac{M_{\\mathrm{CaCO}_{3}}}{\\rho_{\\mathrm{calcite}}} = \\frac{100.09\\,\\mathrm{g\\,mol^{-1}}}{2.71\\,\\mathrm{g\\,cm^{-3}}} \\approx 36.93\\,\\mathrm{cm^3\\,mol^{-1}} = 3.693 \\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}} $$\n$$ V_{m,\\mathrm{aragonite}} = \\frac{M_{\\mathrm{CaCO}_{3}}}{\\rho_{\\mathrm{aragonite}}} = \\frac{100.09\\,\\mathrm{g\\,mol^{-1}}}{2.94\\,\\mathrm{g\\,cm^{-3}}} \\approx 34.04\\,\\mathrm{cm^3\\,mol^{-1}} = 3.404 \\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}} $$\n\n现在，我们计算每种多晶型物的 $\\Delta G^{*}$。\n\n**方解石：**\n$\\gamma_{\\mathrm{calcite}} = 0.17\\,\\mathrm{J\\,m^{-2}}$\n$V_{m,\\mathrm{calcite}} = 3.693 \\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$\n$RT \\ln S_{\\mathrm{calcite}} = 6277\\,\\mathrm{J\\,mol^{-1}}$\n$$ \\Delta G^{*}_{\\mathrm{calcite}} = \\frac{16 \\pi (0.17)^3 (3.693 \\times 10^{-5})^2}{3 (6277)^2} \\approx \\frac{3.37 \\times 10^{-10}}{1.18 \\times 10^{8}} \\approx 2.85 \\times 10^{-18}\\,\\mathrm{J} $$\n\n**文石：**\n$\\gamma_{\\mathrm{aragonite}} = 0.12\\,\\mathrm{J\\,m^{-2}}$\n$V_{m,\\mathrm{aragonite}} = 3.404 \\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$\n$RT \\ln S_{\\mathrm{aragonite}} = 4794\\,\\mathrm{J\\,mol^{-1}}$\n$$ \\Delta G^{*}_{\\mathrm{aragonite}} = \\frac{16 \\pi (0.12)^3 (3.404 \\times 10^{-5})^2}{3 (4794)^2} \\approx \\frac{1.01 \\times 10^{-10}}{6.90 \\times 10^{7}} \\approx 1.46 \\times 10^{-18}\\,\\mathrm{J} $$\n\n比较成核能垒：$\\Delta G^{*}_{\\mathrm{aragonite}}  \\Delta G^{*}_{\\mathrm{calcite}}$。文石的成核能垒显著更低。这主要是因为 $\\Delta G^{*}$ 与 $\\gamma^3$ 成正比，而文石具有低得多的界面自由能。这种动力学优势超过了方解石更大的热力学驱动力。因此，文石在动力学上更倾向于首先成核，并可能作为亚稳相持续存在。\n\n### 逐项分析\n\n-   **A. 方解石具有更负的 $\\Delta G_{\\mathrm{precip}}$，因此在热力学上更有利；然而，文石可以亚稳态存在，因为在这些条件下其较低的界面自由能导致了更小的 $\\Delta G^{*}$。**\n    -   我们的计算表明 $\\Delta G_{\\mathrm{precip,calcite}} \\approx -6.28\\,\\mathrm{kJ\\,mol^{-1}}$ 且 $\\Delta G_{\\mathrm{precip,aragonite}} \\approx -4.79\\,\\mathrm{kJ\\,mol^{-1}}$。方解石确实具有更负的 $\\Delta G_{\\mathrm{precip}}$，在热力学上更有利。\n    -   我们的计算也表明 $\\Delta G^{*}_{\\mathrm{aragonite}} \\approx 1.46 \\times 10^{-18}\\,\\mathrm{J}$ 且 $\\Delta G^{*}_{\\mathrm{calcite}} \\approx 2.85 \\times 10^{-18}\\,\\mathrm{J}$。文石具有更小的成核能垒，这主要是由于其较低的界面自由能（$\\gamma$），使其在动力学上更倾向于成核并作为亚稳相持续存在。\n    -   该陈述与我们的推导完全一致。\n    -   结论：**正确**。\n\n-   **B. 文石具有更负的 $\\Delta G_{\\mathrm{precip}}$，因为其溶度积更低，所以在热力学上更有利；方解石以亚稳态存在，因为它经历了更高的过饱和度。**\n    -   “文石具有更负的 $\\Delta G_{\\mathrm{precip}}$...所以在热力学上更有利”：这是不正确的。方解石的 $\\Delta G_{\\mathrm{precip}}$ 更负。\n    -   “...因为其溶度积更低”：根据给定数据（$K_{\\mathrm{sp,aragonite}} > K_{\\mathrm{sp,calcite}}$），这在事实上是不正确的。\n    -   该陈述的其余部分也是有缺陷的。\n    -   结论：**不正确**。\n\n-   **C. 两种多晶型物具有相等的 $\\Delta G_{\\mathrm{precip}}$，因为它们具有相同的化学式；无论哪个相先成核，都将持续存在，这与界面性质无关。**\n    -   “两种多晶型物具有相等的 $\\Delta G_{\\mathrm{precip}}$”：这是不正确的。作为多晶型物，它们具有不同的晶体结构，因此具有不同的热力学性质，包括 $K_{\\mathrm{sp}}$ 和 $\\Delta G_{\\mathrm{precip}}$。我们的计算证实了它们是不同的。\n    -   “...与界面性质无关”：这是不正确的。成核能垒 $\\Delta G^{*}$ 以及成核速率都强烈依赖于界面自由能 $\\gamma$。\n    -   结论：**不正确**。\n\n-   **D. 在给定条件下，方解石在热力学和动力学上都更有利，这意味着文石不能以任何可观的速率成核，也不会持续存在。**\n    -   “方解石在热力学和动力学上都更有利”：这是不正确的。虽然方解石在热力学上更有利，但我们的计算表明，与文石相比，它在动力学上是不利的（具有更高的 $\\Delta G^{*}$）。\n    -   因此，关于文石不会成核的推论也是不正确的。\n    -   结论：**不正确**。\n\n分析明确支持选项 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "生物地球化学模型不仅必须模拟化学反应，还必须模拟物质在环境中的物理输运。本练习将焦点转移到输运过程的数值实现上，特别是平流过程。您将探索一种常用数值方法的稳定性，以及基本的 Courant-Friedrichs-Lewy (CFL) 条件，亲身体验为何时间步长（$\\Delta t$）和网格间距（$\\Delta x$）的选择不是相互独立的，以及当这一关键的数值约束被违反时会发生什么。",
            "id": "4096494",
            "problem": "您正在模拟恒定平流条件下溶解示踪剂浓度场的一维保守输运，这是计算地球化学中使用的反应输运求解器的一个常见基本构件。考虑从局部质量守恒和平流通量定义推导出的线性平流方程：$\\partial C/\\partial t + u \\, \\partial C/\\partial x = 0$，其中 $C$ 是浓度场，$u$ 是一个恒定速度。您将通过检查 Courant–Friedrichs–Lewy (CFL) 条件，并通过直接模拟该格式以观察其在条件被违反时的后果，来评估一个显式一阶迎风有限差分时间推进格式的稳定性。\n\n从守恒律及其通量形式出发，对空间域进行均匀离散，并应用前向欧拉时间步进法，结合与 $u$ 符号一致的一阶迎风空间离散和周期性边界条件。这在均匀网格上定义了一个从 $C^{n}$ 到 $C^{n+1}$ 的显式单步映射。定义 Courant 数 $c = |u| \\Delta t / \\Delta x$，并回想一下，对于显式迎风平流格式，CFL 稳定性条件要求 $c \\le 1$。\n\n您的任务是：\n- 在具有周期性边界条件的均匀网格上实现上述显式迎风格式。使用正弦初始条件 $C(x,0) = \\sin(2\\pi x / L)$，以使傅里叶模态分析在离散模拟中可以直接观察到。这里 $L$ 是区域长度。\n- 从您实现的离散更新算子出发，使用 von Neumann 分析方法，推导离散傅里叶符号，并计算网格上所有可分辨离散波数的最大谱放大因子 $\\rho_{\\max}$。这个 $\\rho_{\\max}$ 必须通过在与模拟中使用的相同网格上的离散波数 $\\theta_k = 2\\pi k / N$（其中 $k = 0, 1, \\ldots, N-1$）上评估放大因子来计算。\n- 对每个测试用例，计算：\n  1) 一个布尔值，指示 CFL 条件是否得到满足，即 $c \\le 1$ 是否成立。\n  2) 最大谱放大因子 $\\rho_{\\max}$，以浮点数表示。\n  3) 经过 $n_{\\text{steps}}$ 个时间步长后，离散 $\\ell^2$ 范数与初始范数的比率 $R = \\|C^{n_{\\text{steps}}}\\|_2 / \\|C^0\\|_2$，以浮点数表示。\n\n使用的基本依据：质量守恒导出 $\\partial C/\\partial t + u \\, \\partial C/\\partial x = 0$，显式前向欧拉时间积分，以及与流动方向一致的一阶迎风差分。不要假设任何预先推导的稳定性公式；相反，应对您的离散格式进行 von Neumann 分析以获得放大因子，然后在可分辨的模态上数值计算 $\\rho_{\\max}$。模拟必须使用周期性边界条件，并且不得在迎风离散化固有扩散之外添加任何人为扩散。\n\n测试套件中使用的物理单位：\n- 速度 $u$，单位为 $\\text{m}\\,\\text{s}^{-1}$。\n- 空间网格间距 $\\Delta x$，单位为 $\\text{m}$。\n- 时间步长 $\\Delta t$，单位为 $\\text{s}$。\n\n模拟和分析使用：\n- 网格点数 $N = 256$（无单位）。\n- 区域长度 $L = N \\, \\Delta x$（单位为 $\\text{m}$）。\n- 时间步数 $n_{\\text{steps}} = 40$（无单位）。\n- 正弦初始条件 $C(x,0) = \\sin(2\\pi x/L)$（无量纲振幅）。\n\n参数集 $(u, \\Delta x, \\Delta t)$ 的测试套件：\n- 情况 A（理想情况，CFL 条件被轻松满足）：$(u, \\Delta x, \\Delta t) = (0.20, 0.010, 0.030)$，单位为 $(\\text{m}\\,\\text{s}^{-1}, \\text{m}, \\text{s})$。\n- 情况 B（边界情况，CFL 条件恰好为 1）：$(u, \\Delta x, \\Delta t) = (1.00, 0.010, 0.010)$，单位为 $(\\text{m}\\,\\text{s}^{-1}, \\text{m}, \\text{s})$。\n- 情况 C（违反情况，CFL 条件大于 1）：$(u, \\Delta x, \\Delta t) = (0.75, 1.00, 2.00)$，单位为 $(\\text{m}\\,\\text{s}^{-1}, \\text{m}, \\text{s})$。\n- 情况 D（负速度，CFL 条件满足）：$(u, \\Delta x, \\Delta t) = (-0.16, 0.010, 0.050)$，单位为 $(\\text{m}\\,\\text{s}^{-1}, \\text{m}, \\text{s})$。\n\n对于每种情况，计算 CFL布尔值、在 $N$ 点网格的离散波数上评估的最大谱放大因子 $\\rho_{\\max}$，以及经过 $n_{\\text{steps}}$ 个时间步长后的范数比率 $R$。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含一个含四个项目的列表，每个项目对应一个测试用例，而每个项目本身又是一个包含三个值的列表：$[\\text{CFL\\_ok}, \\rho_{\\max}, R]$。\n- 布尔值应为原生布尔值。浮点数 $\\rho_{\\max}$ 和 $R$ 应四舍五入到六位小数。\n- 因此，最后一行必须如下所示：\n  $[[\\text{bool}, \\text{float}, \\text{float}], [\\text{bool}, \\text{float}, \\text{float}], [\\text{bool}, \\text{float}, \\text{float}], [\\text{bool}, \\text{float}, \\text{float}]]$\n- 不应打印任何其他文本。",
            "solution": "该问题要求对一维线性平流方程的一阶显式迎风有限差分格式进行分析。该分析既包括使用 von Neumann 方法的理论稳定性评估，也包括直接进行数值模拟以观察该格式的行为。我们将通过以下步骤解决该问题：首先推导离散更新方程，然后分析其稳定性以找到最大谱放大因子，最后实现数值模拟以计算每个测试用例所需的度量指标。\n\n保守平流的控制偏微分方程 (PDE) 如下：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = 0\n$$\n其中 $C(x,t)$ 是位置 $x$ 和时间 $t$ 处的示踪剂浓度，$u$ 是恒定的平流速度。\n\n为了数值求解此方程，我们将空间域离散化为一个包含 $N$ 个点 $x_j = j \\Delta x$（$j = 0, 1, \\dots, N-1$）的均匀网格，并将时间域离散化为离散步长 $t^n = n \\Delta t$。此网格上的浓度表示为 $C_j^n \\approx C(x_j, t^n)$。\n\n我们对时间导数应用前向欧拉法：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} \\approx -\\left.u \\frac{\\partial C}{\\partial x}\\right|_j^n\n$$\n空间导数 $\\partial C / \\partial x$ 使用一阶迎风格式进行近似。有限差分模板的选择取决于速度 $u$ 的符号，以确保信息从流动的“迎风”方向获取。\n\n情况 1：$u  0$\n流动方向是从左到右。迎风方向是朝向较小的 $j$。我们使用一阶后向差分：\n$$\n\\left.\\frac{\\partial C}{\\partial x}\\right|_j^n \\approx \\frac{C_j^n - C_{j-1}^n}{\\Delta x}\n$$\n将其代入时间离散化方程，得到更新规则：\n$$\nC_j^{n+1} = C_j^n - u \\frac{\\Delta t}{\\Delta x} (C_j^n - C_{j-1}^n)\n$$\n定义 Courant 数 $c = |u| \\Delta t / \\Delta x$，由于 $u0$，该值为正，我们得到：\n$$\nC_j^{n+1} = C_j^n - c(C_j^n - C_{j-1}^n) = (1-c)C_j^n + c C_{j-1}^n\n$$\n\n情况 2：$u \\le 0$\n流动方向是从右到左。迎风方向是朝向较大的 $j$。我们使用一阶前向差分：\n$$\n\\left.\\frac{\\partial C}{\\partial x}\\right|_j^n \\approx \\frac{C_{j+1}^n - C_j^n}{\\Delta x}\n$$\n更新规则变为：\n$$\nC_j^{n+1} = C_j^n - u \\frac{\\Delta t}{\\Delta x} (C_{j+1}^n - C_j^n)\n$$\n在这种情况下，$u$ 是负的或零。Courant 数 $c = |u| \\Delta t / \\Delta x = -u \\Delta t / \\Delta x$ 是正的或零。更新规则是：\n$$\nC_j^{n+1} = C_j^n + c(C_{j+1}^n - C_j^n) = (1-c)C_j^n + c C_{j+1}^n\n$$\n\n为了进行 von Neumann 稳定性分析，我们考虑形式为 $C_j^n = \\hat{C}^n(k) e^{i k x_j} = \\hat{C}^n e^{i j \\theta}$ 的单一傅里叶模态解，其中 $\\theta = k \\Delta x$ 是无量纲波数。放大因子定义为 $g(\\theta) = \\hat{C}^{n+1} / \\hat{C}^n$。\n\n对于 $u  0$：\n$$\n\\hat{C}^{n+1} e^{i j \\theta} = (1-c)\\hat{C}^n e^{i j \\theta} + c \\hat{C}^n e^{i (j-1) \\theta}\n$$\n两边除以 $\\hat{C}^n e^{i j \\theta}$ 得到：\n$$\ng(\\theta) = (1-c) + c e^{-i \\theta} = 1 - c(1 - e^{-i\\theta})\n$$\n\n对于 $u \\le 0$：\n$$\n\\hat{C}^{n+1} e^{i j \\theta} = C_j^n - u \\frac{\\Delta t}{\\Delta x} (C_{j+1}^n - C_j^n) \\implies \\hat{C}^{n+1}e^{ij\\theta} = \\hat{C}^n e^{ij\\theta} - u \\frac{\\Delta t}{\\Delta x}(\\hat{C}^n e^{i(j+1)\\theta} - \\hat{C}^n e^{ij\\theta})\n$$\n两边除以 $\\hat{C}^n e^{i j \\theta}$：\n$$\ng(\\theta) = 1 - u \\frac{\\Delta t}{\\Delta x}(e^{i\\theta} - 1) = 1 + c(e^{i\\theta} - 1) = 1 - c(1 - e^{i\\theta})\n$$\n其中 $c = |u|\\Delta t / \\Delta x$。\n\n该格式的稳定性要求放大因子的模 $\\rho(\\theta) = |g(\\theta)|$ 对所有 $\\theta$ 都小于或等于 1。我们来计算 $|g(\\theta)|^2$：\n对于 $u  0$：$|g(\\theta)|^2 = |(1-c+c\\cos\\theta) - i(c\\sin\\theta)|^2 = (1-c+c\\cos\\theta)^2 + c^2\\sin^2\\theta = 1 - 2c(1-c)(1-\\cos\\theta)$。\n对于 $u \\le 0$：$|g(\\theta)|^2 = |(1-c+c\\cos\\theta) + i(c\\sin\\theta)|^2 = (1-c+c\\cos\\theta)^2 + c^2\\sin^2\\theta = 1 - 2c(1-c)(1-\\cos\\theta)$。\n在两种情况下，$|g(\\theta)|^2 = 1 - 2c(1-c)(1-\\cos\\theta)$，其中 $c = |u|\\Delta t/\\Delta x$。为保证稳定性，我们需要 $|g(\\theta)|^2 \\le 1$，这意味着 $2c(1-c)(1-\\cos\\theta) \\ge 0$。由于 $1-\\cos\\theta \\ge 0$，这简化为著名的 Courant–Friedrichs–Lewy (CFL) 条件：$c(1-c) \\ge 0$。根据定义 $c \\ge 0$，因此条件是 $1-c \\ge 0$，即 $c \\le 1$。\n\n问题要求计算网格上所有可分辨的离散波数对应的最大谱放大因子 $\\rho_{\\max}$。离散波数为 $\\theta_k = 2\\pi k / N$，其中 $k = 0, 1, \\dots, N-1$。我们对每个 $k$ 计算 $\\rho(\\theta_k) = |g(\\theta_k)|$ 并找出最大值。$|g(\\theta)|^2$ 的最大值出现在 $1-\\cos\\theta$ 最大化时，即在 $\\theta=\\pi$ 处，此时 $\\cos\\theta = -1$。\n$$\n\\rho_{\\max}^2 = |g(\\pi)|^2 = 1 - 2c(1-c)(1 - (-1)) = 1 - 4c(1-c) = 1 - 4c + 4c^2 = (1-2c)^2\n$$\n因此，$\\rho_{\\max} = |1-2c|$。我们将通过对所有离散的 $\\theta_k$ 计算 $|g(\\theta_k)|$ 并找到其最大值来数值地计算这个值。\n\n模拟将按以下步骤执行：\n1.  对每个测试用例 $(u, \\Delta x, \\Delta t)$，计算 Courant 数 $c = |u|\\Delta t / \\Delta x$ 并检查 CFL 条件 $c \\le 1$。\n2.  建立空间网格 $x_j = j \\Delta x$，其中 $j=0, \\ldots, N-1$ 且 $N=256$。区域长度为 $L = N \\Delta x$。\n3.  使用给定的正弦剖面初始化浓度场 $C^0$：$C_j^0 = \\sin(2\\pi x_j / L) = \\sin(2\\pi j / N)$。\n4.  计算初始离散 $\\ell^2$ 范数，$\\|C^0\\|_2 = \\left(\\sum_{j=0}^{N-1} (C_j^0)^2\\right)^{1/2}$。\n5.  迭代 $n_{\\text{steps}} = 40$ 个时间步。在每一步中，使用相应的迎风格式从 $C^n$ 计算 $C^{n+1}$，通过对浓度数组进行循环移位来处理周期性边界条件。\n    - 如果 $u0$：$C^{n+1}_j = C^n_j - c(C^n_j - C^n_{j-1})$。\n    - 如果 $u \\le 0$：$C^{n+1}_j = C^n_j + c(C^n_{j+1} - C^n_j)$。\n6.  在 $n_{\\text{steps}}$ 步之后，计算最终范数 $\\|C^{n_{\\text{steps}}}\\|_2$。\n7.  计算比率 $R = \\|C^{n_{\\text{steps}}}\\|_2 / \\|C^0\\|_2$。\n8.  每个用例的最终结果将是一个三元组：CFL 条件的布尔值、最大谱放大因子 $\\rho_{\\max}$ 和范数比率 $R$。\n实现将使用 `numpy` 进行高效的数组操作，特别是用于计算范数和周期性边界条件所需的循环移位（`np.roll`）。\n为了计算 $\\rho_{max}$，我们将计算 $k=0, \\dots, N-1$ 时的复放大因子 $g(\\theta_k)$，并找到其绝对值的最大值。这比使用推导出的 $|g(\\theta)|^2$ 公式更直接。\n这种结构化的方法确保了所有问题需求都基于第一性原理得到满足。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D advection problem, performing stability analysis and simulation\n    for a set of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: (u, delta_x, delta_t)\n        (0.20, 0.010, 0.030),\n        # Case B:\n        (1.00, 0.010, 0.010),\n        # Case C:\n        (0.75, 1.00, 2.00),\n        # Case D:\n        (-0.16, 0.010, 0.050)\n    ]\n\n    # Simulation parameters\n    N = 256  # Number of grid points\n    n_steps = 40  # Number of time steps\n\n    results = []\n    for u, dx, dt in test_cases:\n        # 1. Compute CFL condition\n        cfl_number = np.abs(u) * dt / dx\n        cfl_ok = cfl_number = 1.0\n\n        # 2. Compute maximum spectral amplification factor (rho_max)\n        theta_k = 2 * np.pi * np.arange(N) / N\n        \n        if u > 0:\n            # g(theta) = 1 - c(1 - exp(-i*theta))\n            g_k = 1 - cfl_number * (1 - np.exp(-1j * theta_k))\n        else: # u = 0\n            # g(theta) = 1 + c(exp(i*theta) - 1)\n            g_k = 1 + cfl_number * (np.exp(1j * theta_k) - 1)\n        \n        rho_max = np.max(np.abs(g_k))\n\n        # 3. Simulate to find the norm ratio R\n        # Initial condition C(x,0) = sin(2*pi*x/L)\n        # As x_j = j*dx and L = N*dx, x_j/L = j/N\n        C = np.sin(2 * np.pi * np.arange(N) / N)\n        norm_C0 = np.linalg.norm(C)\n\n        # Time-marching loop\n        for _ in range(n_steps):\n            if u > 0:\n                # Update rule: C_j^{n+1} = C_j^n - cfl * (C_j^n - C_{j-1}^n)\n                # C_j-1 is a circular shift to the right by 1\n                C_prev = np.roll(C, 1)\n                C = C - cfl_number * (C - C_prev)\n            else: # u = 0\n                # Update rule: C_j^{n+1} = C_j^n + cfl * (C_{j+1}^n - C_j^n)\n                # C_j+1 is a circular shift to the left by 1\n                C_next = np.roll(C, -1)\n                C = C + cfl_number * (C_next - C)\n\n        norm_C_final = np.linalg.norm(C)\n        \n        # Handle case where initial norm is zero to avoid division by zero\n        if norm_C0 == 0:\n            norm_ratio = 1.0 if norm_C_final == 0 else np.inf\n        else:\n            norm_ratio = norm_C_final / norm_C0\n\n        # Collect results, rounding floats to 6 decimal places\n        results.append([cfl_ok, round(rho_max, 6), round(norm_ratio, 6)])\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is the desired format.\n    print(f\"[{','.join([str(item) for item in results])}]\")\n\nsolve()\n\n```"
        }
    ]
}