{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will derive an effective transport parameter from first principles. This exercise focuses on a foundational scenario in the study of heterogeneous media: determining the effective diffusion coefficient for transport parallel to the layers of a stratified medium. By working through this derivation , you will apply the concept of volume averaging to see how microscopic variations in properties combine to produce a simple, elegant macroscopic law, illustrating one of the most fundamental upscaling results.",
            "id": "4105929",
            "problem": "Consider a two-dimensional stratified porous medium representative of a sedimentary formation in computational geochemistry. The medium occupies a domain with longitudinal coordinate $x$ and transverse coordinate $y$. The cross-section in the $y$-direction is composed of a periodic repetition of alternating layers of equal thickness $\\ell_m$ with local molecular diffusivity $D_1$ in one lamella and $D_2$ in the adjacent lamella, giving a period of $2\\ell_m$. A dissolved, non-advected geochemical species of concentration $c(x,y,t)$ undergoes diffusion and a uniform first-order reaction with rate constant $k$ throughout the medium.\n\nAt the microscale, transport obeys the species conservation equation and Fick's law:\n$$\n\\frac{\\partial c}{\\partial t} = \\nabla \\cdot \\left( D(y) \\nabla c \\right) - k\\,c, \\quad \\mathbf{j}(x,y,t) = -D(y)\\,\\nabla c,\n$$\nwhere $D(y)$ is piecewise constant in $y$ and alternates between $D_1$ and $D_2$ with each layer of thickness $\\ell_m$.\n\nAssume the following transverse mixing condition: transverse diffusion across a single lamella thickness $\\ell_m$ is sufficiently rapid compared to the characteristic time of macroscopic longitudinal evolution that $c(x,y,t)$ becomes uniform in $y$ at each $x$ on the timescale of interest, i.e., $\\partial c/\\partial y \\approx 0$ in the upscaled description. Consequently, at any fixed $x$, the longitudinal gradient $\\partial c/\\partial x$ is independent of $y$.\n\nDefine the Representative Elementary Volume (REV) as one full periodic unit of the stratification of width $2\\ell_m$ in the $y$-direction and of unit thickness in the $z$-direction, and let $\\langle \\cdot \\rangle$ denote the $y$-average over this REV. The upscaled one-dimensional model along $x$ is written in terms of the cross-sectionally averaged concentration $\\langle c \\rangle(x,t)$ and an effective diffusion coefficient $D^{\\ast}$ via the constitutive relation\n$$\nJ(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x},\n$$\nwhere $J(x,t)$ is the $y$-average of the longitudinal component of the microscopic flux $j_x(x,y,t)$.\n\nStarting from the above fundamental laws and the transverse mixing assumption, derive the effective diffusion coefficient $D^{\\ast}$ for longitudinal transport along $x$ in terms of $D_1$, $D_2$, and $\\ell_m$, and compute $D^{\\ast}$. Express your final answer as a closed-form analytic expression. No rounding is required. Units are not needed in the final boxed answer, but $D_1$ and $D_2$ are molecular diffusion coefficients with units of length squared per time.",
            "solution": "The user wants to derive the effective longitudinal diffusion coefficient $D^{\\ast}$ for a stratified porous medium under a transverse mixing assumption.\n\n### Step 1: Problem Validation\n\n**1.1. Extraction of Givens**\n\n*   **Geometry:** A two-dimensional domain with longitudinal coordinate $x$ and transverse coordinate $y$. The medium is composed of a periodic repetition of alternating layers of equal thickness $\\ell_m$. The period in the $y$-direction is $2\\ell_m$.\n*   **Physical Properties:** The local molecular diffusivity $D(y)$ is piecewise constant, alternating between $D_1$ and $D_2$ in adjacent layers.\n*   **Transport Process:** A dissolved, non-advected species with concentration $c(x,y,t)$ undergoes diffusion and a uniform first-order reaction with rate constant $k$.\n*   **Microscale Equations:**\n    *   Conservation Equation: $\\frac{\\partial c}{\\partial t} = \\nabla \\cdot \\left( D(y) \\nabla c \\right) - k\\,c$\n    *   Microscopic Flux (Fick's Law): $\\mathbf{j}(x,y,t) = -D(y)\\,\\nabla c$\n*   **Upscaling Assumption (Transverse Mixing):**\n    *   Transverse diffusion is sufficiently rapid that $c(x,y,t)$ is uniform in $y$ for each $x$ on the timescale of interest, implying $\\partial c/\\partial y \\approx 0$ in the upscaled description.\n    *   A direct consequence is that at any fixed $x$, the longitudinal gradient $\\partial c/\\partial x$ is independent of $y$.\n*   **Upscaled Model Definitions:**\n    *   **Averaging Operator:** $\\langle \\cdot \\rangle$ denotes the $y$-average over one periodic unit of width $2\\ell_m$.\n    *   **Average Concentration:** $\\langle c \\rangle(x,t)$\n    *   **Average Flux:** $J(x,t) = \\langle j_x(x,y,t) \\rangle$, where $j_x$ is the longitudinal component of the microscopic flux $\\mathbf{j}$.\n    *   **Effective Constitutive Relation:** $J(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}$, defining the effective diffusion coefficient $D^{\\ast}$.\n*   **Objective:** Derive the expression for $D^{\\ast}$ in terms of $D_1$ and $D_2$.\n\n**1.2. Validation Analysis**\n\n*   **Scientific Grounding:** The problem is based on the well-established principles of Fickian diffusion and reaction kinetics. The method of volume averaging to derive effective parameters for heterogeneous media is a standard and rigorous technique in transport phenomena, hydrogeology, and computational geochemistry. The problem is scientifically sound.\n*   **Well-Posedness:** The problem provides a clear microscale model, a specific upscaling assumption, and a well-defined objective. The \"transverse mixing\" assumption simplifies the problem to a tractable, well-posed state, representing a valid and important limiting case in transport theory (analogous to the limit where transverse equilibration is much faster than longitudinal transport).\n*   **Objectivity:** The problem is stated in precise, objective, and quantitative terms, free from ambiguity or subjective content.\n*   **Consistency and Completeness:** The problem is self-contained. The key assumption provided—that $\\partial c/\\partial x$ is independent of $y$—is sufficient to proceed with the derivation. The presence of the reaction term with rate constant $k$ does not create a contradiction or an incompleteness, as the effective diffusivity $D^{\\ast}$ is a constitutive property of the medium relating flux to the concentration gradient, which is independent of reaction source/sink terms. The derivation will show that $k$ does not affect $D^{\\ast}$. The parameter $\\ell_m$ is part of the problem description and will be used in the derivation, though it may cancel out of the final result.\n\n**1.3. Verdict**\n\nThe problem is **valid**. It is a well-posed, scientifically sound problem in the upscaling of transport parameters, suitable for a rigorous derivation.\n\n### Step 2: Derivation of the Effective Diffusion Coefficient\n\nThe objective is to find the effective diffusion coefficient $D^{\\ast}$, which is defined by the upscaled constitutive relation for the average longitudinal flux $J(x,t)$:\n$$\nJ(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}\n$$\nThe average flux $J(x,t)$ is the spatial average of the microscopic longitudinal flux, $j_x(x,y,t)$, over the Representative Elementary Volume (REV). The REV is one periodic unit of width $2\\ell_m$.\n$$\nJ(x,t) = \\langle j_x(x,y,t) \\rangle = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} j_x(x,y,t) \\, dy\n$$\nThe microscopic longitudinal flux $j_x$ is given by Fick's law:\n$$\nj_x(x,y,t) = -D(y) \\frac{\\partial c}{\\partial x}\n$$\nSubstituting this into the expression for the average flux gives:\n$$\nJ(x,t) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} \\left( -D(y) \\frac{\\partial c}{\\partial x} \\right) \\, dy = \\left\\langle -D(y) \\frac{\\partial c}{\\partial x} \\right\\rangle\n$$\nThe problem states a critical consequence of the transverse mixing assumption: \"at any fixed $x$, the longitudinal gradient $\\partial c/\\partial x$ is independent of $y$.\" This allows us to treat the term $\\frac{\\partial c}{\\partial x}$ as a constant with respect to the integration variable $y$. Therefore, it can be factored out of the integral:\n$$\nJ(x,t) = -\\frac{\\partial c}{\\partial x} \\left( \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} D(y) \\, dy \\right) = -\\frac{\\partial c}{\\partial x} \\langle D(y) \\rangle\n$$\nNext, we must relate the microscopic gradient $\\frac{\\partial c}{\\partial x}$ to the gradient of the average concentration, $\\frac{\\partial \\langle c \\rangle}{\\partial x}$. The average concentration is defined as:\n$$\n\\langle c \\rangle(x,t) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} c(x,y,t) \\, dy\n$$\nDifferentiating with respect to $x$ and applying the Leibniz integral rule (since the limits of integration are constant with respect to $x$):\n$$\n\\frac{\\partial \\langle c \\rangle}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} c(x,y,t) \\, dy \\right) = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} \\frac{\\partial c}{\\partial x}(x,y,t) \\, dy = \\left\\langle \\frac{\\partial c}{\\partial x} \\right\\rangle\n$$\nAgain using the fact that $\\frac{\\partial c}{\\partial x}$ is independent of $y$, its average over $y$ is simply itself:\n$$\n\\left\\langle \\frac{\\partial c}{\\partial x} \\right\\rangle = \\frac{\\partial c}{\\partial x}\n$$\nTherefore, we have established the equality:\n$$\n\\frac{\\partial \\langle c \\rangle}{\\partial x} = \\frac{\\partial c}{\\partial x}\n$$\nSubstituting this result into our expression for the average flux $J(x,t)$:\n$$\nJ(x,t) = -\\frac{\\partial \\langle c \\rangle}{\\partial x} \\langle D(y) \\rangle\n$$\nBy comparing this derived expression for $J(x,t)$ with the definition of the effective diffusion coefficient, $J(x,t) = -D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x}$, we can directly identify $D^{\\ast}$:\n$$\n-D^{\\ast}\\,\\frac{\\partial \\langle c \\rangle}{\\partial x} = -\\langle D(y) \\rangle \\frac{\\partial \\langle c \\rangle}{\\partial x}\n$$\nThis leads to the conclusion that the effective diffusion coefficient is the arithmetic average of the microscopic diffusivity over the REV.\n$$\nD^{\\ast} = \\langle D(y) \\rangle\n$$\nThe final step is to calculate this average. The medium consists of alternating layers of equal thickness $\\ell_m$. Within one period of width $2\\ell_m$, there is a layer of thickness $\\ell_m$ with diffusivity $D_1$ and an adjacent layer of thickness $\\ell_m$ with diffusivity $D_2$.\n$$\nD(y) =\n\\begin{cases}\nD_1 & \\text{for } 0 \\le y < \\ell_m \\\\\nD_2 & \\text{for } \\ell_m \\le y < 2\\ell_m\n\\end{cases}\n$$\nThe average is calculated as:\n$$\nD^{\\ast} = \\langle D(y) \\rangle = \\frac{1}{2\\ell_m} \\int_{0}^{2\\ell_m} D(y) \\, dy = \\frac{1}{2\\ell_m} \\left( \\int_{0}^{\\ell_m} D_1 \\, dy + \\int_{\\ell_m}^{2\\ell_m} D_2 \\, dy \\right)\n$$\nEvaluating the integrals:\n$$\nD^{\\ast} = \\frac{1}{2\\ell_m} \\left( D_1 [y]_{0}^{\\ell_m} + D_2 [y]_{\\ell_m}^{2\\ell_m} \\right) = \\frac{1}{2\\ell_m} \\left( D_1 \\ell_m + D_2 (2\\ell_m - \\ell_m) \\right)\n$$\n$$\nD^{\\ast} = \\frac{1}{2\\ell_m} \\left( D_1 \\ell_m + D_2 \\ell_m \\right) = \\frac{\\ell_m (D_1 + D_2)}{2\\ell_m}\n$$\nSimplifying the expression, we arrive at the final result:\n$$\nD^{\\ast} = \\frac{D_1 + D_2}{2}\n$$\nThis result, the arithmetic mean of the diffusivities, is the classic result for effective transport parallel to the layering of a stratified medium. The reaction rate $k$ does not appear in the result, as expected. The layer thickness $\\ell_m$ cancels out because the layers are of equal thickness.",
            "answer": "$$\n\\boxed{\\frac{D_1 + D_2}{2}}\n$$"
        },
        {
            "introduction": "Building on the concept of averaging, we now address a more dynamic and common scenario in geochemistry: transport-limited reactions. In many natural systems, such as fractured rock, fast-flowing channels can bypass large portions of the reactive mineral matrix. This exercise  guides you through the design of a computational model to quantify this effect by linking advective residence time to diffusive penetration depth, allowing you to calculate an \"effective reactive surface area\" and diagnose the extent to which reactions are limited by accessibility.",
            "id": "4105884",
            "problem": "Consider a porous medium containing advective preferential-flow channels embedded within a stagnant or slowly moving matrix. An aqueous solute is transported along a straight channel segment of length $L$ at a constant velocity $v$, with molecular diffusivity $D$ in the aqueous phase. Reactive mineral surfaces are distributed in the matrix at distances $d \\ge 0$ from the nearest active streamline in the channel. Assume the distribution of distances $d$ is exponential with rate $\\lambda$ (in $\\mathrm{m}^{-1}$), so that the probability density of distances is $p(d) = \\lambda e^{-\\lambda d}$ for $d \\ge 0$. The geometric surface area of reactive minerals in the matrix (that would be accessible under quasi-equilibrium mixing) is $A_{\\mathrm{geo}}$ (in $\\mathrm{m}^2$). The intrinsic surface reaction rate constant is $k_s$ (in $\\mathrm{m}\\,\\mathrm{s}^{-1}$). The channel has cross-sectional area $S$ (in $\\mathrm{m}^2$), giving an advective volumetric flow rate $Q = v S$ (in $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$). \n\nStarting from fundamental laws and definitions, design a diagnostic upscaling calculation to quantify how preferential flow bypassing reduces the effective reactive surface area $A_{\\mathrm{eff}}$, and how this reduction suppresses reaction under high Péclet number conditions. Your calculation must be based on the following principles:\n- The Péclet number ($Pe$) is defined as $Pe = \\frac{v L}{D}$.\n- The residence time of a fluid element in the channel segment is $t_{\\mathrm{res}}$ (in $\\mathrm{s}$) obtained from advection kinematics.\n- The one-dimensional diffusive root-mean-square penetration distance into the matrix during the residence time is a function of $D$ and $t_{\\mathrm{res}}$ derived from Fickian diffusion.\n- The fraction of reactive surface that is accessed during the pass is the probability that the distance $d$ is less than or equal to the diffusive penetration distance.\n- The effective reactive surface area $A_{\\mathrm{eff}}$ is the fraction of accessible surface area times $A_{\\mathrm{geo}}$.\n- A dimensionless diagnostic for accessibility-limited reaction capacity is constructed as the ratio of maximum surface reaction removal rate to advective solute supply rate, using $k_s$, $A_{\\mathrm{eff}}$, and $Q$.\n\nImplement a program that, for each test case defined below, computes:\n1. The accessible fraction of reactive surface, $f_{\\mathrm{acc}}$ (dimensionless), and\n2. The accessibility-limited Damköhler metric, $\\mathrm{Da}_{\\mathrm{acc}}$ (dimensionless), defined as the ratio of the total surface reaction capacity to the advective supply capacity over the channel segment.\n\nAll parameters use the following units: $L$ in $\\mathrm{m}$, $v$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $D$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $\\lambda$ in $\\mathrm{m}^{-1}$, $k_s$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $A_{\\mathrm{geo}}$ in $\\mathrm{m}^2$, $S$ in $\\mathrm{m}^2$. Express the outputs as decimals (floats). No angle units are involved. \n\nTest suite (each case is a tuple ($L$, $v$, $D$, $\\lambda$, $k_s$, $A_{\\mathrm{geo}}$, $S$)):\n- Case 1 (general high-$Pe$ with moderate accessibility): $(0.1, 0.5, 1.0\\times 10^{-9}, 5000.0, 1.0\\times 10^{-5}, 12.0, 2.0\\times 10^{-4})$\n- Case 2 (long residence time, higher accessibility fraction): $(0.1, 1.0\\times 10^{-3}, 1.0\\times 10^{-9}, 3000.0, 5.0\\times 10^{-6}, 8.0, 1.0\\times 10^{-4})$\n- Case 3 (extreme high-$Pe$, very small penetration distance): $(0.05, 2.0, 1.0\\times 10^{-9}, 10000.0, 1.0\\times 10^{-5}, 15.0, 3.0\\times 10^{-4})$\n- Case 4 (low velocity, near full accessibility): $(0.1, 1.0\\times 10^{-4}, 1.0\\times 10^{-9}, 2000.0, 1.0\\times 10^{-5}, 5.0, 1.0\\times 10^{-4})$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a two-element list $[f_{\\mathrm{acc}}, \\mathrm{Da}_{\\mathrm{acc}}]$. For example, the structure must be like $[[f_1, \\mathrm{Da}_1],[f_2, \\mathrm{Da}_2],[f_3, \\mathrm{Da}_3],[f_4, \\mathrm{Da}_4]]$.",
            "solution": "The objective is to build a principled diagnostic that captures accessibility-limited reaction under preferential flow. The starting point is the distinction between advection along channels and diffusion into the adjacent matrix. Preferential flow causes streamlines to bypass parts of the reactive surface that lie at distances $d$ into the matrix. Under high Péclet number, advection dominates over diffusion, reducing the time available for solute to diffuse into the matrix and thereby lowering the fraction of reactive surface that is accessed during a pass.\n\nWe begin with fundamental definitions and laws:\n\n1. The Péclet number (dimensionless) is defined as\n$$ Pe = \\frac{v L}{D}, $$\nwhere $v$ is the advective velocity, $L$ is the characteristic length along the channel, and $D$ is the molecular diffusivity. A large $Pe$ indicates advection-dominated transport.\n\n2. The residence time $t_{\\mathrm{res}}$ of fluid traversing the channel segment is obtained directly from advection kinematics:\n$$ t_{\\mathrm{res}} = \\frac{L}{v}. $$\n\n3. Fickian diffusion in one dimension yields a Gaussian displacement distribution with mean zero and variance $2 D t$. A standard measure of how far solute can penetrate into the matrix during a finite time is the root-mean-square displacement\n$$ \\ell = \\sqrt{2 D t_{\\mathrm{res}}} = \\sqrt{2 D \\frac{L}{v}} = L \\sqrt{\\frac{2}{Pe}}. $$\nThis $\\ell$ serves as a conservative diagnostic penetration distance for accessibility over a single pass: reactive surfaces at distances $d \\le \\ell$ can be accessed during $t_{\\mathrm{res}}$, while those at $d > \\ell$ are effectively bypassed.\n\n4. The distribution of distances $d$ is specified as exponential with rate $\\lambda$, i.e.,\n$$ p(d) = \\lambda e^{-\\lambda d}, \\quad d \\ge 0. $$\nThe accessible fraction is the probability that $d \\le \\ell$, computed via\n$$ f_{\\mathrm{acc}} = \\int_0^{\\ell} p(d)\\, \\mathrm{d}d = \\int_0^{\\ell} \\lambda e^{-\\lambda d} \\, \\mathrm{d}d = 1 - e^{-\\lambda \\ell}. $$\nThis fraction strictly lies in the interval $[0,1]$, and decreases as $\\ell$ decreases. In particular, as $Pe \\to \\infty$, $\\ell \\to 0$ and $f_{\\mathrm{acc}} \\to 0$ (with the small-$\\ell$ asymptotic $f_{\\mathrm{acc}} \\sim \\lambda \\ell$), reflecting strong bypassing. As $Pe$ decreases (or $v$ decreases), $\\ell$ increases, and $f_{\\mathrm{acc}}$ approaches $1$, indicating near-complete accessibility.\n\n5. The effective reactive surface area is then\n$$ A_{\\mathrm{eff}} = f_{\\mathrm{acc}} \\, A_{\\mathrm{geo}}. $$\n\n6. To diagnose accessibility-limited reaction capacity relative to advective supply, consider a capacity ratio akin to a Damköhler number constructed from the maximum surface reaction removal rate and the advective solute supply rate through the channel. The volumetric flow is $Q = v S$. The maximum rate at which surface reaction could remove solute (assuming concentration sufficiently available at accessible surfaces) scales with $k_s A_{\\mathrm{eff}}$. A dimensionless diagnostic is\n$$ \\mathrm{Da}_{\\mathrm{acc}} = \\frac{k_s A_{\\mathrm{eff}}}{Q} = \\frac{k_s \\, f_{\\mathrm{acc}} \\, A_{\\mathrm{geo}}}{v S}. $$\nWhen $\\mathrm{Da}_{\\mathrm{acc}} \\ll 1$, reaction capacity is small compared to advective supply, indicating strongly accessibility-limited reaction in a pass. When $\\mathrm{Da}_{\\mathrm{acc}} \\gg 1$, accessible surface reaction capacity can substantially affect the solute advected through the channel.\n\nAlgorithmic steps to compute outputs for each test case:\n- Compute $t_{\\mathrm{res}} = L/v$.\n- Compute $\\ell = \\sqrt{2 D t_{\\mathrm{res}}}$.\n- Compute $f_{\\mathrm{acc}} = 1 - e^{-\\lambda \\ell}$.\n- Compute $A_{\\mathrm{eff}} = f_{\\mathrm{acc}} A_{\\mathrm{geo}}$.\n- Compute $Q = v S$.\n- Compute $\\mathrm{Da}_{\\mathrm{acc}} = (k_s A_{\\mathrm{eff}})/Q$.\n\nThis sequence adheres to first principles: residence time from kinematics, diffusion length from Fickian diffusion, accessible fraction from the given microstructural distance distribution, and a capacity ratio from reaction kinetics and flow. It directly quantifies how preferential flow bypassing (large $Pe$) reduces $A_{\\mathrm{eff}}$ via the shrinking $\\ell$, and correspondingly lowers $\\mathrm{Da}_{\\mathrm{acc}}$.\n\nApplying this to the four test cases specified in the problem statement yields a list of two-element results $[f_{\\mathrm{acc}}, \\mathrm{Da}_{\\mathrm{acc}}]$ for each case, which the program outputs in the required single-line format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_accessibility_and_da(L, v, D, lam, k_s, A_geo, S):\n    \"\"\"\n    Compute the accessible fraction of reactive surface and the accessibility-limited Damköhler metric.\n\n    Parameters:\n        L (float): Channel length [m]\n        v (float): Advective velocity [m/s]\n        D (float): Molecular diffusivity [m^2/s]\n        lam (float): Exponential rate for distance distribution [1/m]\n        k_s (float): Intrinsic surface reaction rate constant [m/s]\n        A_geo (float): Geometric reactive surface area [m^2]\n        S (float): Channel cross-sectional area [m^2]\n\n    Returns:\n        (f_acc, Da_acc): Tuple of floats, accessible fraction and Damköhler metric (dimensionless).\n    \"\"\"\n    # Residence time from kinematics: t_res = L / v\n    t_res = L / v\n\n    # Diffusive root-mean-square penetration distance: ell = sqrt(2 D t_res)\n    ell = np.sqrt(2.0 * D * t_res)\n\n    # Accessible fraction for exponential distance distribution: f_acc = 1 - exp(-lam * ell)\n    f_acc = 1.0 - np.exp(-lam * ell)\n\n    # Effective surface area\n    A_eff = f_acc * A_geo\n\n    # Volumetric flow rate\n    Q = v * S\n\n    # Accessibility-limited Damköhler metric\n    Da_acc = (k_s * A_eff) / Q\n\n    return float(f_acc), float(Da_acc)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (L, v, D, lambda, k_s, A_geo, S)\n    test_cases = [\n        (0.1, 0.5, 1.0e-9, 5000.0, 1.0e-5, 12.0, 2.0e-4),\n        (0.1, 1.0e-3, 1.0e-9, 3000.0, 5.0e-6, 8.0, 1.0e-4),\n        (0.05, 2.0, 1.0e-9, 10000.0, 1.0e-5, 15.0, 3.0e-4),\n        (0.1, 1.0e-4, 1.0e-9, 2000.0, 1.0e-5, 5.0, 1.0e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, v, D, lam, k_s, A_geo, S = case\n        f_acc, Da_acc = compute_accessibility_and_da(L, v, D, lam, k_s, A_geo, S)\n        results.append([f_acc, Da_acc])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Our final practice integrates the principles of reactive transport with geomechanics, reflecting the complex interplay of processes in subsurface environments. Here, you will develop an upscaled reaction rate model that accounts for how mechanical stress and strain alter the rock's porosity, which in turn influences both effective transport properties and the available reactive surface area. This advanced exercise  demonstrates a powerful multi-physics approach, where a distribution of pore-scale environments is averaged to yield a macroscopic rate that is dynamically coupled to the geomechanical state of the medium.",
            "id": "4075546",
            "problem": "You are given a Representative Elementary Volume (REV) of a reactive porous rock undergoing small volumetric strain, $\\epsilon_{\\mathrm{v}}$, in which a dissolved solute diffuses from the pore fluid to reactive mineral surfaces and reacts according to linear surface kinetics. The goal is to compute an upscaled volumetric reaction rate that incorporates transport limitations by averaging pore-scale fluxes and surface reaction terms over the REV with appropriate weighting, while accounting for geomechanical coupling through porosity changes that affect effective transport and surface area.\n\nFundamental physical base to use:\n- Fick's first law of diffusion: for one-dimensional diffusion of a dilute solute at steady state, the diffusive molar flux density is given by $j = -D_{\\mathrm{e}} \\, \\frac{dc}{dx}$, where $D_{\\mathrm{e}}$ is the effective diffusivity and $c$ is the solute concentration.\n- Linear surface reaction kinetics: the surface reaction rate per unit reactive surface area is $r = k_{\\mathrm{s}} \\, c_{\\mathrm{s}}$, where $k_{\\mathrm{s}}$ is a first-order rate constant and $c_{\\mathrm{s}}$ is the concentration at the reactive surface.\n- Steady-state mass balance at the pore scale: the diffusive flux to a reactive surface equals the surface reaction rate at that surface.\n- Small-strain poroelastic coupling for porosity: assume the solid matrix is effectively incompressible and the Biot coefficient is unity; then for small volumetric strain $\\epsilon_{\\mathrm{v}}$ the porosity is updated as $\\phi = \\phi_{0} + (1 - \\phi_{0}) \\, \\epsilon_{\\mathrm{v}}$. For physical realism, ensure $\\phi$ remains strictly between $0$ and $1$ by clipping to a small interval $(\\varepsilon, 1-\\varepsilon)$ with $\\varepsilon = 10^{-6}$ whenever necessary.\n- Effective diffusivity scaling with porosity via a Bruggeman-type relation: $D_{\\mathrm{e}} = D_{\\mathrm{m}} \\, \\phi^{\\beta}$, where $D_{\\mathrm{m}}$ is the molecular diffusion coefficient and $\\beta$ is a constant exponent.\n- Specific reactive surface area scaling with porosity: the bulk specific reactive surface area per bulk volume is $a_{\\mathrm{s}}(\\phi) = a_{\\mathrm{s0}} \\, (\\phi/\\phi_{0})^{\\eta}$, where $a_{\\mathrm{s0}}$ is the specific reactive surface area at the reference porosity $\\phi_{0}$ and $\\eta$ is a given constant. The total reactive surface area inside the REV is then $S_{\\mathrm{tot}} = a_{\\mathrm{s}}(\\phi) \\, V_{\\mathrm{REV}}$.\n\nPore-scale model and upscaling:\n- Consider a set of $N$ pore classes indexed by $i = 1,\\dots,N$. For each class $i$, a quasi-one-dimensional film of thickness $l_{i}$ separates the bulk concentration $c_{\\mathrm{b}}$ (assumed uniform at the pore mouth) from the reactive surface at which the local concentration is $c_{\\mathrm{s},i}$. At steady state, the flux to the surface equals the reaction rate at the surface. Each class $i$ is assigned an area weighting factor $w_{i}$ such that $\\sum_{i=1}^{N} w_{i} = 1$, and the reactive surface area of class $i$ is $S_{i} = w_{i} \\, S_{\\mathrm{tot}}$.\n- The upscaled volumetric reaction rate is defined as\n$$\nR_{\\mathrm{up}} \\equiv \\frac{1}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} j_{i} \\, S_{i},\n$$\nwith $j_{i}$ the steady diffusive flux density to class $i$.\n\nRequired derivation and algorithm design (do not provide shortcut formulas in the problem statement): Starting from the stated fundamental laws, derive the steady-state flux $j_{i}$ for each pore class by enforcing Fick's law over the film of thickness $l_{i}$ and the equality of diffusive flux to the surface reaction rate at $x = l_{i}$. Use the poroelastic porosity update to compute $\\phi$, then compute $D_{\\mathrm{e}}$ from the Bruggeman-type relation, and $a_{\\mathrm{s}}(\\phi)$ from the given scaling law. Use area weighting to aggregate pore-scale fluxes and obtain $R_{\\mathrm{up}}$.\n\nScientific realism requirements:\n- All variables are defined as follows, with required units in parentheses:\n  - $D_{\\mathrm{m}}$ (m$^{2}$/s), $\\phi_{0}$ (dimensionless), $\\epsilon_{\\mathrm{v}}$ (dimensionless), $\\beta$ (dimensionless), $a_{\\mathrm{s0}}$ (m$^{2}$/m$^{3}$), $\\eta$ (dimensionless), $V_{\\mathrm{REV}}$ (m$^{3}$), $c_{\\mathrm{b}}$ (mol/m$^{3}$).\n  - For each $i$: $l_{i}$ (m), $k_{\\mathrm{s},i}$ (m/s), $w_{i}$ (dimensionless with $\\sum w_{i} = 1$).\n- The final upscaled rate $R_{\\mathrm{up}}$ must be reported in mol/(m$^{3}$ s).\n\nTest suite:\nImplement a single program that computes $R_{\\mathrm{up}}$ for each of the following three parameter sets, and outputs the three results in the required format. For the constants common to all three cases, use:\n- $D_{\\mathrm{m}} = 1 \\times 10^{-9}$ m$^{2}$/s,\n- $\\phi_{0} = 0.2$,\n- $\\beta = 1.5$,\n- $a_{\\mathrm{s0}} = 1 \\times 10^{5}$ m$^{2}$/m$^{3}$,\n- $\\eta = 0.2$,\n- $V_{\\mathrm{REV}} = 1 \\times 10^{-6}$ m$^{3}$,\n- $c_{\\mathrm{b}} = 1.0$ mol/m$^{3}$.\n\nNow compute $R_{\\mathrm{up}}$ for these three cases:\n1) Happy-path, mixed control:\n- $\\epsilon_{\\mathrm{v}} = +0.05$,\n- $N = 3$,\n- $l = [1 \\times 10^{-4}, \\; 5 \\times 10^{-5}, \\; 2 \\times 10^{-4}]$ m,\n- $k_{\\mathrm{s}} = [1 \\times 10^{-5}, \\; 5 \\times 10^{-6}, \\; 2 \\times 10^{-5}]$ m/s,\n- $w = [0.5, \\; 0.3, \\; 0.2]$.\n\n2) Transport-limited tendency (compression reduces diffusivity):\n- $\\epsilon_{\\mathrm{v}} = -0.03$,\n- $N = 2$,\n- $l = [5 \\times 10^{-4}, \\; 2 \\times 10^{-4}]$ m,\n- $k_{\\mathrm{s}} = [1 \\times 10^{-3}, \\; 2 \\times 10^{-3}]$ m/s,\n- $w = [0.6, \\; 0.4]$.\n\n3) Reaction-limited tendency (very slow kinetics):\n- $\\epsilon_{\\mathrm{v}} = +0.02$,\n- $N = 4$,\n- $l = [1 \\times 10^{-3}, \\; 8 \\times 10^{-4}, \\; 6 \\times 10^{-4}, \\; 1 \\times 10^{-4}]$ m,\n- $k_{\\mathrm{s}} = [1 \\times 10^{-7}, \\; 5 \\times 10^{-8}, \\; 2 \\times 10^{-7}, \\; 1 \\times 10^{-7}]$ m/s,\n- $w = [0.25, \\; 0.25, \\; 0.25, \\; 0.25]$.\n\nAngle units are not applicable. Percentages must be expressed as decimals. Report each $R_{\\mathrm{up}}$ in mol/(m$^{3}$ s).\n\nFinal output format:\nYour program should produce a single line of output containing the three results as a comma-separated list of floats in scientific notation with eight significant digits, enclosed in square brackets, for example: \"[1.23456789e-03,2.34567891e+00,3.45678912e-05]\". The results must be in mol/(m$^{3}$ s).",
            "solution": "The problem is deemed valid as it is scientifically grounded in established principles of reactive transport and poroelasticity, is well-posed with a complete and consistent set of data and definitions, and is expressed in objective, formal language. The provided parameters and conditions are physically realistic.\n\nThe objective is to compute an upscaled volumetric reaction rate, $R_{\\mathrm{up}}$, for a reactive porous medium. This requires integrating pore-scale transport and reaction phenomena over a Representative Elementary Volume (REV), while accounting for the geomechanical influence of volumetric strain $\\epsilon_{\\mathrm{v}}$ on porosity $\\phi$ and, consequently, on transport properties and reactive surface area.\n\nThe solution is derived in the following steps:\n1.  Derivation of the steady-state solute flux for a single pore class.\n2.  Formulation of the upscaled reaction rate by aggregating the contributions from all pore classes.\n3.  Specification of the complete computational algorithm, including the geomechanical coupling.\n\n**Step 1: Pore-Scale Steady-State Flux**\n\nWe consider a single pore class, indexed by $i$, characterized by a stagnant film of thickness $l_i$. A solute diffuses from the bulk pore fluid, where the concentration is $c_{\\mathrm{b}}$, across this film to a reactive mineral surface, where the concentration is $c_{\\mathrm{s},i}$.\n\nAccording to Fick's first law, the one-dimensional steady-state diffusive flux density, $j_i$, is constant across the film and is given by:\n$$\nj_i = -D_{\\mathrm{e}} \\frac{dc}{dx}\n$$\nwhere $D_{\\mathrm{e}}$ is the effective diffusivity in the porous medium. The concentration profile is linear across the film, so the gradient can be approximated as $\\frac{\\Delta c}{\\Delta x} = \\frac{c_{\\mathrm{s},i} - c_{\\mathrm{b}}}{l_i}$. The flux towards the surface is therefore:\n$$\nj_i = -D_{\\mathrm{e}} \\frac{c_{\\mathrm{s},i} - c_{\\mathrm{b}}}{l_i} = \\frac{D_{\\mathrm{e}}}{l_i} (c_{\\mathrm{b}} - c_{\\mathrm{s},i})\n$$\n\nAt the mineral surface ($x=l_i$), the rate of consumption by the surface reaction, per unit of reactive surface area, is given by a linear kinetic law:\n$$\nr_i = k_{\\mathrm{s},i} c_{\\mathrm{s},i}\n$$\nwhere $k_{\\mathrm{s},i}$ is the first-order surface reaction rate constant for class $i$.\n\nAt steady state, the flux of solute arriving at the surface must equal the rate at which it is consumed. This establishes the mass balance condition at the surface:\n$$\nj_i = r_i\n$$\nCombining the expressions for flux and reaction rate, we have a system of two equations for the two unknowns, $j_i$ and $c_{\\mathrm{s},i}$:\n$$\n\\begin{cases}\nj_i = \\frac{D_{\\mathrm{e}}}{l_i} (c_{\\mathrm{b}} - c_{\\mathrm{s},i}) \\\\\nj_i = k_{\\mathrm{s},i} c_{\\mathrm{s},i}\n\\end{cases}\n$$\nFrom the second equation, we express the surface concentration in terms of the flux: $c_{\\mathrm{s},i} = j_i / k_{\\mathrm{s},i}$. Substituting this into the first equation eliminates $c_{\\mathrm{s},i}$:\n$$\nj_i = \\frac{D_{\\mathrm{e}}}{l_i} \\left(c_{\\mathrm{b}} - \\frac{j_i}{k_{\\mathrm{s},i}}\\right)\n$$\nSolving for $j_i$:\n$$\nj_i = \\frac{D_{\\mathrm{e}} c_{\\mathrm{b}}}{l_i} - \\frac{D_{\\mathrm{e}} j_i}{l_i k_{\\mathrm{s},i}}\n$$\n$$\nj_i \\left(1 + \\frac{D_{\\mathrm{e}}}{l_i k_{\\mathrm{s},i}}\\right) = \\frac{D_{\\mathrm{e}} c_{\\mathrm{b}}}{l_i}\n$$\n$$\nj_i \\left(\\frac{l_i k_{\\mathrm{s},i} + D_{\\mathrm{e}}}{l_i k_{\\mathrm{s},i}}\\right) = \\frac{D_{\\mathrm{e}} c_{\\mathrm{b}}}{l_i}\n$$\n$$\nj_i = \\frac{D_{\\mathrm{e}} k_{\\mathrm{s},i} c_{\\mathrm{b}}}{l_i k_{\\mathrm{s},i} + D_{\\mathrm{e}}}\n$$\nThis expression can be elegantly rewritten by dividing the numerator and denominator by $D_{\\mathrm{e}} k_{\\mathrm{s},i}$:\n$$\nj_i = \\frac{c_{\\mathrm{b}}}{\\frac{l_i}{D_{\\mathrm{e}}} + \\frac{1}{k_{\\mathrm{s},i}}}\n$$\nThis form shows that the overall process is governed by two resistances in series: a transport resistance, $R_{\\mathrm{transport}, i} = l_i/D_{\\mathrm{e}}$, and a reaction resistance, $R_{\\mathrm{reaction}, i} = 1/k_{\\mathrm{s},i}$.\n\n**Step 2: Upscaling to the REV Scale**\n\nThe upscaled volumetric reaction rate, $R_{\\mathrm{up}}$, is defined as the total molar reaction rate within the REV, normalized by the volume of the REV, $V_{\\mathrm{REV}}$:\n$$\nR_{\\mathrm{up}} \\equiv \\frac{1}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} (\\text{total rate in class } i)\n$$\nThe total rate in class $i$ is the product of the flux density $j_i$ and the total surface area of that class, $S_i$. Thus,\n$$\nR_{\\mathrm{up}} = \\frac{1}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} j_i S_i\n$$\nThe area $S_i$ is given as a fraction $w_i$ of the total reactive surface area $S_{\\mathrm{tot}}$ in the REV: $S_i = w_i S_{\\mathrm{tot}}$. The total area $S_{\\mathrm{tot}}$ is related to the bulk specific reactive surface area $a_{\\mathrm{s}}(\\phi)$ by $S_{\\mathrm{tot}} = a_{\\mathrm{s}}(\\phi) V_{\\mathrm{REV}}$. Substituting these relations:\n$$\nR_{\\mathrm{up}} = \\frac{1}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} j_i (w_i S_{\\mathrm{tot}}) = \\frac{S_{\\mathrm{tot}}}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} w_i j_i = \\frac{a_{\\mathrm{s}}(\\phi) V_{\\mathrm{REV}}}{V_{\\mathrm{REV}}} \\sum_{i=1}^{N} w_i j_i\n$$\nThis simplifies to:\n$$\nR_{\\mathrm{up}} = a_{\\mathrm{s}}(\\phi) \\sum_{i=1}^{N} w_i j_i\n$$\nSubstituting the derived expression for $j_i$, the final formula for the upscaled rate is:\n$$\nR_{\\mathrm{up}} = a_{\\mathrm{s}}(\\phi) \\sum_{i=1}^{N} w_i \\left( \\frac{c_{\\mathrm{b}}}{\\frac{l_i}{D_{\\mathrm{e}}} + \\frac{1}{k_{\\mathrm{s},i}}} \\right)\n$$\nThis demonstrates that $R_{\\mathrm{up}}$ is an average of the pore-scale fluxes, weighted by their respective surface area fractions and scaled by the bulk specific reactive surface area.\n\n**Step 3: Geomechanical Coupling and Computational Algorithm**\n\nThe model's parameters $D_{\\mathrm{e}}$ and $a_{\\mathrm{s}}(\\phi)$ depend on the porosity $\\phi$, which in turn is affected by the volumetric strain $\\epsilon_{\\mathrm{v}}$.\n\n1.  **Porosity Update**: The porosity $\\phi$ is updated from its reference value $\\phi_0$ based on the volumetric strain $\\epsilon_{\\mathrm{v}}$ using the small-strain poroelastic relation:\n    $$\n    \\phi = \\phi_{0} + (1 - \\phi_{0}) \\epsilon_{\\mathrm{v}}\n    $$\n    For physical realism, the computed $\\phi$ is clipped to the interval $(\\varepsilon, 1-\\varepsilon)$, where $\\varepsilon = 10^{-6}$.\n\n2.  **Effective Diffusivity**: The effective diffusivity $D_{\\mathrm{e}}$ is calculated from the updated porosity $\\phi$ using the Bruggeman-type relation:\n    $$\n    D_{\\mathrm{e}} = D_{\\mathrm{m}} \\phi^{\\beta}\n    $$\n    where $D_{\\mathrm{m}}$ is the molecular diffusion coefficient and $\\beta$ is a cementation exponent.\n\n3.  **Specific Surface Area**: The bulk specific reactive surface area $a_{\\mathrm{s}}(\\phi)$ is also updated based on the new porosity:\n    $$\n    a_{\\mathrm{s}}(\\phi) = a_{\\mathrm{s0}} \\left(\\frac{\\phi}{\\phi_{0}}\\right)^{\\eta}\n    $$\n    where $a_{\\mathrm{s0}}$ is the reference specific surface area at $\\phi_0$ and $\\eta$ is a scaling exponent.\n\n**Complete Algorithm:**\nFor each given parameter set, the calculation proceeds as follows:\n1.  Calculate the updated porosity $\\phi = \\phi_{0} + (1 - \\phi_{0}) \\epsilon_{\\mathrm{v}}$, and clip it to $(\\varepsilon, 1-\\varepsilon)$.\n2.  Using the updated $\\phi$, calculate $D_{\\mathrm{e}} = D_{\\mathrm{m}} \\phi^{\\beta}$.\n3.  Using the updated $\\phi$, calculate $a_{\\mathrm{s}}(\\phi) = a_{\\mathrm{s0}} (\\phi/\\phi_{0})^{\\eta}$.\n4.  For each pore class $i=1, \\dots, N$:\n    a. Calculate the flux $j_i = c_{\\mathrm{b}} / (\\frac{l_i}{D_{\\mathrm{e}}} + \\frac{1}{k_{\\mathrm{s},i}})$.\n5.  Calculate the final upscaled volumetric rate $R_{\\mathrm{up}} = a_{\\mathrm{s}}(\\phi) \\sum_{i=1}^{N} w_i j_i$.\n6.  Report the result in mol/(m$^3$ s) with the specified precision.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the upscaled volumetric reaction rate for three test cases\n    based on a coupled reactive transport and geomechanics model.\n    \"\"\"\n\n    # Common physical constants and parameters\n    D_m = 1.0e-9      # Molecular diffusion coefficient (m^2/s)\n    phi_0 = 0.2       # Reference porosity (dimensionless)\n    beta = 1.5        # Bruggeman exponent (dimensionless)\n    a_s0 = 1.0e5      # Reference specific reactive surface area (m^2/m^3)\n    eta = 0.2         # Surface area scaling exponent (dimensionless)\n    c_b = 1.0         # Bulk solute concentration (mol/m^3)\n    porosity_clip = 1.0e-6 # Clipping epsilon for porosity\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"eps_v\": 0.05,\n            \"l\": np.array([1.0e-4, 5.0e-5, 2.0e-4]),\n            \"ks\": np.array([1.0e-5, 5.0e-6, 2.0e-5]),\n            \"w\": np.array([0.5, 0.3, 0.2])\n        },\n        {\n            \"eps_v\": -0.03,\n            \"l\": np.array([5.0e-4, 2.0e-4]),\n            \"ks\": np.array([1.0e-3, 2.0e-3]),\n            \"w\": np.array([0.6, 0.4])\n        },\n        {\n            \"eps_v\": 0.02,\n            \"l\": np.array([1.0e-3, 8.0e-4, 6.0e-4, 1.0e-4]),\n            \"ks\": np.array([1.0e-7, 5.0e-8, 2.0e-7, 1.0e-7]),\n            \"w\": np.array([0.25, 0.25, 0.25, 0.25])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        eps_v = case[\"eps_v\"]\n        l_i_vec = case[\"l\"]\n        ks_i_vec = case[\"ks\"]\n        w_i_vec = case[\"w\"]\n\n        # Step 1: Update porosity based on volumetric strain\n        phi = phi_0 + (1.0 - phi_0) * eps_v\n        \n        # Clip porosity to ensure it remains within physical bounds\n        phi = np.clip(phi, porosity_clip, 1.0 - porosity_clip)\n\n        # Step 2: Calculate porosity-dependent effective diffusivity\n        D_e = D_m * (phi ** beta)\n\n        # Step 3: Calculate porosity-dependent specific reactive surface area\n        a_s = a_s0 * ((phi / phi_0) ** eta)\n\n        # Step 4: Calculate pore-scale flux for each class\n        # j_i = c_b / (l_i / D_e + 1 / k_s_i)\n        transport_resistance = l_i_vec / D_e\n        reaction_resistance = 1.0 / ks_i_vec\n        j_i_vec = c_b / (transport_resistance + reaction_resistance)\n\n        # Step 5: Compute the upscaled volumetric reaction rate\n        # R_up = a_s * sum(w_i * j_i)\n        # Using dot product for summation: w_1*j_1 + w_2*j_2 + ...\n        R_up = a_s * np.dot(w_i_vec, j_i_vec)\n        \n        results.append(R_up)\n\n    # Format the output as a comma-separated list of floats in scientific\n    # notation with eight significant digits, enclosed in square brackets.\n    # The format specifier \"{:.7e}\" produces 8 significant digits.\n    formatted_results = [f\"{res:.7e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}