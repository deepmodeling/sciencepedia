{
    "hands_on_practices": [
        {
            "introduction": "Before modeling the transport of heat and chemicals, we must first establish a robust model for fluid flow. This foundational exercise guides you from the microscopic physics governing fluid movement at the pore scale to the macroscopic Darcy's Law used in continuum-scale simulations. By using volume averaging on the Stokes equations, you will derive the essential relationship between pressure gradients and fluid discharge, a cornerstone of the hydraulic ($H$) component in any THC model .",
            "id": "4075032",
            "problem": "A single-phase, incompressible aqueous fluid flows horizontally through a homogeneous, isotropic porous rock under conditions relevant to coupled Thermal–Hydraulic–Chemical (THC) modeling. Temperature and chemistry are spatially uniform, so fluid dynamic viscosity and density are constant, and permeability is constant and isotropic. The flow is steady, laminar, and gravity is neglected for this horizontal configuration.\n\nStarting from first principles appropriate for porous-media flow at low Reynolds number—namely, conservation of mass for an incompressible fluid and the linear momentum balance for creeping flow at the pore scale—use volume averaging to obtain a constitutive linear relation between the volumetric specific discharge vector and the driving forces. Then specialize to the given case with a uniform pressure gradient.\n\nLet the pressure gradient be uniform with magnitude $100\\,\\mathrm{Pa\\,m^{-1}}$ directed along the $+x$ axis. The porous medium has intrinsic permeability $k = 1.0\\times 10^{-13}\\,\\mathrm{m^{2}}$, the fluid has dynamic viscosity $\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa\\,s}$, and the gravitational body force term is zero because the flow is horizontal, $\\mathbf{g}=\\mathbf{0}$. Consider a cross section of area $A=0.10\\,\\mathrm{m^{2}}$ oriented normal to the $x$ axis.\n\nCompute the $x$-component of the volumetric specific discharge, $u_{x}$, and the volumetric discharge through the cross section, $Q$, using the constitutive relation you derived. Express $u_{x}$ in $\\mathrm{m\\,s^{-1}}$ and $Q$ in $\\mathrm{m^{3}\\,s^{-1}}$. Provide your final answer as a two-entry row vector $\\big[u_{x},\\,Q\\big]$, with no units, rounded to three significant figures.",
            "solution": "The problem describes a classic fluid flow scenario in a porous medium, the derivation and application of Darcy's Law. It is scientifically grounded, well-posed with all necessary information, and stated objectively. We can proceed with the solution.\n\n**Part 1: Derivation of the Constitutive Relation (Darcy's Law)**\n\nThe problem asks to start from first principles at the pore scale for low Reynolds number flow. These principles are:\n1.  **Mass Conservation** for an incompressible fluid: At the microscopic (pore) scale, the fluid velocity, $\\mathbf{v}$, satisfies $\\nabla \\cdot \\mathbf{v} = 0$.\n2.  **Momentum Conservation** for creeping (laminar) flow, where viscous forces dominate inertial forces. This is described by the Stokes equation. The problem specifies neglecting gravity, so the equation is:\n    $$ \\nabla p = \\mu \\nabla^2 \\mathbf{v} $$\n    Here, $p$ and $\\mathbf{v}$ are the pressure and velocity within the pore spaces, and $\\mu$ is the fluid viscosity.\n\nTo move from the microscopic pore scale to a macroscopic continuum scale, we use the technique of **volume averaging**. We define a Representative Elementary Volume (REV) that is large compared to the pore size but small compared to the overall domain. We then average the governing equations over this volume.\n\nThe **volumetric specific discharge** (or Darcy velocity), $\\mathbf{u}$, is defined as the pore-scale velocity $\\mathbf{v}$ averaged over the total area of the medium (solid + fluid).\n$$ \\mathbf{u} = \\frac{1}{A_{total}} \\int_{A_{fluid}} \\mathbf{v} \\cdot d\\mathbf{A} $$\nFormally applying volume averaging to the Stokes equation and incorporating the no-slip boundary condition at the fluid-solid interfaces results in a macroscopic equation that relates the averaged quantities. This rigorous derivation shows that the specific discharge $\\mathbf{u}$ is linearly proportional to the gradient of the macroscopic (averaged) pressure, $\\nabla P$. For an isotropic porous medium, this relationship is:\n$$ \\mathbf{u} = -\\frac{k}{\\mu} \\nabla P $$\nThis is **Darcy's Law**, the required linear constitutive relation. It states that the specific discharge vector $\\mathbf{u}$ is driven by the negative pressure gradient, $-\\nabla P$, and is modulated by the fluid viscosity $\\mu$ and the medium's intrinsic permeability $k$.\n\n**Part 2: Calculation of Specific Discharge ($u_x$) and Volumetric Discharge ($Q$)**\n\nWe are given the following values:\n*   Pressure gradient, $\\nabla P = (100, 0, 0)\\,\\mathrm{Pa\\,m^{-1}}$ (magnitude 100 Pa/m in the $+x$ direction).\n*   Intrinsic permeability, $k = 1.0 \\times 10^{-13}\\,\\mathrm{m^{2}}$.\n*   Fluid dynamic viscosity, $\\mu = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$.\n*   Cross-sectional area, $A = 0.10\\,\\mathrm{m^{2}}$.\n\nFirst, we calculate the specific discharge vector $\\mathbf{u}$ using Darcy's Law:\n$$ \\mathbf{u} = -\\frac{1.0 \\times 10^{-13}\\,\\mathrm{m^{2}}}{1.0 \\times 10^{-3}\\,\\mathrm{Pa\\,s}} \\begin{pmatrix} 100 \\\\ 0 \\\\ 0 \\end{pmatrix} \\mathrm{Pa\\,m^{-1}} $$\n$$ \\mathbf{u} = -(1.0 \\times 10^{-10}\\,\\mathrm{m^2\\,Pa^{-1}\\,s^{-1}}) \\begin{pmatrix} 100 \\\\ 0 \\\\ 0 \\end{pmatrix} \\mathrm{Pa\\,m^{-1}} = \\begin{pmatrix} -1.0 \\times 10^{-8} \\\\ 0 \\\\ 0 \\end{pmatrix} \\mathrm{m\\,s^{-1}} $$\nThe $x$-component of the specific discharge, $u_x$, is therefore:\n$$ u_x = -1.0 \\times 10^{-8}\\,\\mathrm{m\\,s^{-1}} $$\nThe negative sign correctly indicates that flow occurs in the direction opposite to the positive pressure gradient (i.e., from high pressure to low pressure).\n\nNext, we calculate the volumetric discharge, $Q$, which is the total volume of fluid passing through the cross section per unit time. Since the flow is uniform, $Q$ is simply the product of the specific discharge component normal to the area and the area itself.\n$$ Q = u_x \\cdot A $$\n$$ Q = (-1.0 \\times 10^{-8}\\,\\mathrm{m\\,s^{-1}}) \\times (0.10\\,\\mathrm{m^{2}}) = -1.0 \\times 10^{-9}\\,\\mathrm{m^{3}\\,s^{-1}} $$\nThe negative sign indicates that the volumetric flux is in the $-x$ direction.\n\nFinally, we round the results to three significant figures as requested:\n*   $u_x = -1.00 \\times 10^{-8}$\n*   $Q = -1.00 \\times 10^{-9}$\n\nThe final answer as a two-entry row vector $[u_x, Q]$ is $[-1.00 \\times 10^{-8}, -1.00 \\times 10^{-9}]$.",
            "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n-1.00 \\times 10^{-8} & -1.00 \\times 10^{-9}\n\\end{bmatrix}\n}\n$$"
        },
        {
            "introduction": "The coupling between thermal and chemical processes is a defining feature of many geochemical systems, as reaction kinetics are often highly sensitive to temperature. This practice provides a concrete, multi-step calculation that embodies this thermal-chemical ($T-C$) coupling. You will first determine the steady-state temperature profile from coupled advection and conduction, then use this result to evaluate a chemical reaction source term, linking the thermal field directly to chemical transformation rates .",
            "id": "4075027",
            "problem": "Consider a one-dimensional control volume in a saturated porous medium that is part of a coupled Thermal-Hydraulic-Chemical (THC) system. The control volume has length $L = 0.1\\,\\mathrm{m}$ along the $x$-axis and a unit cross-sectional area, with porosity $\\phi = 0.25$ and liquid saturation $S_{w} = 1$. A steady Darcy flux of water $q = 1.0 \\times 10^{-6}\\,\\mathrm{m\\,s^{-1}}$ advects heat from $x=0$ to $x=L$. Assume local thermal equilibrium between fluid and solid and steady state for the energy equation. The effective thermal conductivity is $\\lambda_{\\mathrm{eff}} = 2.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, and the volumetric heat capacity of the fluid is $\\rho_{w} c_{w} = 4.2 \\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$. The boundary temperatures are $T(0) = 298\\,\\mathrm{K}$ and $T(L) = 308\\,\\mathrm{K}$.\n\nAn aqueous irreversible reaction $A \\to B$ occurs homogeneously in the porewater with intrinsic rate law $r = k(T)\\,C_{A}$, where $r$ is defined per unit porewater volume, $C_{A}$ is the aqueous concentration of species $A$, and $k(T)$ follows the Arrhenius law $k(T) = A \\exp\\!\\left(-\\dfrac{E_{a}}{R_{g} T}\\right)$ with pre-exponential factor $A = 1.0 \\times 10^{6}\\,\\mathrm{s^{-1}}$, activation energy $E_{a} = 6.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}$, and universal gas constant $R_{g} = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. At the time of interest, the aqueous concentration is uniform within the control volume at $C_{A} = 2.0\\,\\mathrm{mol\\,m^{-3}}$. The stoichiometric coefficients are $\\nu_{A} = -1$ and $\\nu_{B} = +1$.\n\nStarting from the steady one-dimensional energy balance for advection-conduction in a porous medium and the definition of reaction source terms in the species mass balance,\n- compute the temperature $T$ at the centroid of the control volume, $x = L/2$,\n- evaluate $k(T)$ at that temperature,\n- and compute the volumetric reaction source terms $R_{A}$ and $R_{B}$ (per unit bulk volume) entering the species conservation equations, using the convention $R_{i} = \\phi S_{w} \\nu_{i} r$ when $r$ is defined per unit porewater volume.\n\nExpress the final numerical values of $R_{A}$ and $R_{B}$ in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$, and round your answers to four significant figures. Provide your final answer as a two-entry row vector $\\left(R_{A}, R_{B}\\right)$.",
            "solution": "The problem is scientifically sound, well-posed, and objective. The solution proceeds in three main stages: first, determining the temperature profile within the control volume; second, calculating the temperature-dependent reaction rate constant; and third, computing the volumetric reaction source terms.\n\n**Step 1: Determine the temperature at the centroid of the control volume**\n\nThe problem describes a one-dimensional, steady-state system with heat transport by both advection (due to fluid flow) and conduction. The governing energy balance equation, neglecting internal heat sources or sinks, is given by:\n$$\n\\frac{d}{dx} \\left( (\\rho_{w} c_{w}) q T \\right) - \\frac{d}{dx} \\left( \\lambda_{\\mathrm{eff}} \\frac{dT}{dx} \\right) = 0\n$$\nwhere $T$ is the temperature, $q$ is the Darcy flux, $\\rho_{w} c_{w}$ is the volumetric heat capacity of the fluid, and $\\lambda_{\\mathrm{eff}}$ is the effective thermal conductivity. Since $q$, $\\rho_{w} c_{w}$, and $\\lambda_{\\mathrm{eff}}$ are constants, this simplifies to a second-order linear homogeneous ordinary differential equation:\n$$\n(\\rho_{w} c_{w} q) \\frac{dT}{dx} - \\lambda_{\\mathrm{eff}} \\frac{d^2T}{dx^2} = 0 \\quad \\implies \\quad \\frac{d^2T}{dx^2} - \\frac{\\rho_{w} c_{w} q}{\\lambda_{\\mathrm{eff}}} \\frac{dT}{dx} = 0\n$$\nWe define the Péclet number, $Pe$, as the dimensionless ratio of advective to conductive heat transport over the length $L$:\n$$\nPe = \\frac{\\rho_{w} c_{w} q L}{\\lambda_{\\mathrm{eff}}} = \\frac{(4.2 \\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}) (1.0 \\times 10^{-6}\\,\\mathrm{m\\,s^{-1}}) (0.1\\,\\mathrm{m})}{2.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}} = \\frac{0.42}{2.5} = 0.168\n$$\nThe differential equation becomes $\\frac{d^2T}{dx^2} - \\frac{Pe}{L} \\frac{dT}{dx} = 0$, which has the general solution $T(x) = C_1 \\exp\\left(\\frac{Pe}{L} x\\right) + C_2$. Applying the boundary conditions $T(0) = T_0 = 298\\,\\mathrm{K}$ and $T(L) = T_L = 308\\,\\mathrm{K}$, we solve for the constants $C_1$ and $C_2$ to find the specific solution for the temperature profile:\n$$\nT(x) = T_0 + (T_L - T_0) \\frac{\\exp\\left(\\frac{Pe}{L} x\\right) - 1}{\\exp(Pe) - 1}\n$$\nWe need to evaluate the temperature at the centroid, $x = L/2$:\n$$\nT(L/2) = T_0 + (T_L - T_0) \\frac{\\exp(Pe/2) - 1}{\\exp(Pe) - 1}\n$$\nSubstituting the numerical values:\n$$\nT(L/2) = 298 + (308 - 298) \\frac{\\exp(0.168 / 2) - 1}{\\exp(0.168) - 1} = 298 + 10 \\frac{\\exp(0.084) - 1}{\\exp(0.168) - 1}\n$$\n$$\nT(L/2) \\approx 298 + 10 \\frac{1.0876402 - 1}{1.1829284 - 1} = 298 + 10 \\frac{0.0876402}{0.1829284} \\approx 298 + 4.791338\n$$\n$$\nT(L/2) \\approx 302.7913\\,\\mathrm{K}\n$$\n\n**Step 2: Evaluate the reaction rate constant $k(T)$**\n\nThe reaction rate constant $k$ is given by the Arrhenius law: $k(T) = A \\exp\\left(-\\frac{E_{a}}{R_{g} T}\\right)$.\nUsing the given parameters ($A = 1.0 \\times 10^{6}\\,\\mathrm{s^{-1}}$, $E_{a} = 6.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}$, $R_{g} = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$) and the calculated temperature $T \\approx 302.7913\\,\\mathrm{K}$:\nFirst, calculate the dimensionless exponent term:\n$$\n\\frac{E_{a}}{R_{g} T} = \\frac{6.0 \\times 10^{4}}{8.314 \\times 302.7913} \\approx 23.83584\n$$\nNow, compute $k(T)$:\n$$\nk(302.7913\\,\\mathrm{K}) = (1.0 \\times 10^{6}) \\exp(-23.83584) \\approx (1.0 \\times 10^{6}) (4.43789 \\times 10^{-11})\n$$\n$$\nk(T) \\approx 4.43789 \\times 10^{-5}\\,\\mathrm{s^{-1}}\n$$\n\n**Step 3: Compute the volumetric reaction source terms $R_A$ and $R_B$**\n\nThe intrinsic reaction rate $r$ (per unit porewater volume) is $r = k(T)\\,C_{A}$. With $C_{A} = 2.0\\,\\mathrm{mol\\,m^{-3}}$:\n$$\nr = (4.43789 \\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times (2.0\\,\\mathrm{mol\\,m^{-3}}) \\approx 8.87578 \\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,s^{-1}}\n$$\nThe volumetric reaction source term $R_i$ (per unit bulk volume) is $R_{i} = \\phi S_{w} \\nu_{i} r$, where $\\phi = 0.25$, $S_w = 1.0$, and $\\nu_i$ are the stoichiometric coefficients.\n\nFor species A ($A \\to B$), $\\nu_{A} = -1$:\n$$\nR_{A} = (0.25) (1.0) (-1) (8.87578 \\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,s^{-1}}) \\approx -2.218945 \\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,s^{-1}}\n$$\nFor species B ($A \\to B$), $\\nu_{B} = +1$:\n$$\nR_{B} = (0.25) (1.0) (+1) (8.87578 \\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,s^{-1}}) \\approx +2.218945 \\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,s^{-1}}\n$$\nRounding these final values to four significant figures as requested:\n$$\nR_{A} \\approx -2.219 \\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,s^{-1}}\n$$\n$$\nR_{B} \\approx +2.219 \\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,s^{-1}}\n$$\nThe final answer is presented as a two-entry row vector $(R_{A}, R_{B})$.",
            "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n-2.219 \\times 10^{-5} & 2.219 \\times 10^{-5}\n\\end{bmatrix}\n}\n$$"
        },
        {
            "introduction": "Solving the fully coupled system of THC equations simultaneously is often computationally infeasible, leading to the widespread use of operator splitting methods. This hands-on coding exercise delves into this critical numerical technique, where transport and reaction processes are solved sequentially. By implementing a Lie-Godunov splitting scheme and comparing it to the exact solution for a linear system, you will quantify the resulting error and gain insight into its origin in operator non-commutativity .",
            "id": "4075011",
            "problem": "Consider a single primary aqueous species concentration field in a coupled Thermal–Hydraulic–Chemical (THC) system evolving under mass conservation and linearized reactions over a small time interval. Starting from the fundamental mass balance and transport laws, let the porosity be constant and the fluid properties be time-lagged so that the concentration dynamics are governed, after spatial discretization, by a linear system of ordinary differential equations for the cell-averaged concentrations $C \\in \\mathbb{R}^N$,\n$$\n\\frac{\\partial}{\\partial t} C(t) = \\mathcal{T}(C(t)) + \\mathcal{R}(C(t)),\n$$\nwhere $\\mathcal{T}$ denotes the discretized transport operator (advection–diffusion driven by hydraulic and thermal fields) and $\\mathcal{R}$ denotes the linearized reaction operator (temperature-dependent aqueous reactions, linearized about the previous time level). Under linearization, these become matrix operators $T \\in \\mathbb{R}^{N \\times N}$ and $R \\in \\mathbb{R}^{N \\times N}$, yielding\n$$\n\\frac{\\partial}{\\partial t} C(t) = \\left(T + R\\right) C(t),\n$$\nwith initial condition $C(0) = C_0 \\in \\mathbb{R}^N$. For linear systems, the exact evolution over one time step $\\Delta t$ is given by the matrix exponential solution obtained from the superposition principle for linear systems.\n\nImplement the simplest two-step operator-splitting (Lie/Godunov) scheme that advances the solution by sequentially evolving the transport subproblem for time $\\Delta t$ and then the reaction subproblem for time $\\Delta t$ using the exact flows of the subproblems. Then compute the Euclidean norm of the splitting error after one time step $\\Delta t$, defined as the Euclidean norm of the difference between the split solution and the exact solution at time $\\Delta t$. All quantities are nondimensional due to standard nondimensionalization in computational geochemistry; therefore, report all numerical answers as unitless floats.\n\nYour program must:\n- For each test case, compute the exact solution at time $\\Delta t$ for the full linear system and the two-step split approximation obtained by sequential application of the exact subproblem flows, and then return the Euclidean norm of their difference.\n- Use the Euclidean norm (the $\\ell^2$ norm) for the error, that is, for a vector $v \\in \\mathbb{R}^N$, $\\|v\\|_2 = \\left(\\sum_{i=1}^N v_i^2\\right)^{1/2}$.\n- Produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3]$ with no spaces. Express each result as a float (no rounding requirement; default floating-point string representation is acceptable).\n\nTest suite parameters:\n- Case A (general noncommuting transport and reaction):\n  - $N = 3$,\n  - $T = \\begin{bmatrix} -2.0 & 2.0 & 0.0 \\\\ 1.0 & -3.0 & 2.0 \\\\ 0.0 & 1.0 & -1.0 \\end{bmatrix}$,\n  - $R = \\begin{bmatrix} -0.3 & 0.05 & 0.0 \\\\ 0.0 & -0.2 & 0.0 \\\\ 0.04 & 0.0 & -0.1 \\end{bmatrix}$,\n  - $C_0 = \\begin{bmatrix} 1.0 \\\\ 0.5 \\\\ 0.2 \\end{bmatrix}$,\n  - $\\Delta t = 0.1$.\n- Case B (commuting operators; diagonal transport and reaction):\n  - $N = 3$,\n  - $T = \\operatorname{diag}(-1.0,-2.0,-3.0)$,\n  - $R = \\operatorname{diag}(-0.1,-0.1,-0.1)$,\n  - $C_0 = \\begin{bmatrix} 1.0 \\\\ 1.0 \\\\ 1.0 \\end{bmatrix}$,\n  - $\\Delta t = 0.3$.\n- Case C (stiff reaction relative to transport):\n  - $N = 3$,\n  - $T = \\begin{bmatrix} -2.0 & 2.0 & 0.0 \\\\ 1.0 & -3.0 & 2.0 \\\\ 0.0 & 1.0 & -1.0 \\end{bmatrix}$,\n  - $R = \\begin{bmatrix} -10.0 & 0.0 & 0.0 \\\\ 0.0 & -5.0 & 0.0 \\\\ 0.0 & 0.5 & -1.0 \\end{bmatrix}$,\n  - $C_0 = \\begin{bmatrix} 2.0 \\\\ 0.1 \\\\ 1.0 \\end{bmatrix}$,\n  - $\\Delta t = 0.05$.\n- Case D (small time step to probe error order):\n  - $N = 3$,\n  - $T = \\begin{bmatrix} -2.0 & 2.0 & 0.0 \\\\ 1.0 & -3.0 & 2.0 \\\\ 0.0 & 1.0 & -1.0 \\end{bmatrix}$,\n  - $R = \\begin{bmatrix} -0.3 & 0.05 & 0.0 \\\\ 0.0 & -0.2 & 0.0 \\\\ 0.04 & 0.0 & -0.1 \\end{bmatrix}$,\n  - $C_0 = \\begin{bmatrix} 0.3 \\\\ 0.7 \\\\ 0.9 \\end{bmatrix}$,\n  - $\\Delta t = 1.0 \\times 10^{-4}$.\n\nFor each case, the exact solution at time $\\Delta t$ is the result of evolving the full linear system for time $\\Delta t$. The two-step split approximation applies the exact transport subflow over time $\\Delta t$ followed by the exact reaction subflow over time $\\Delta t$. Compute the error as the Euclidean norm of their difference. Your program should produce a single line of output containing the four error values as a comma-separated list enclosed in square brackets with no spaces, in the order $[\\text{Case A},\\text{Case B},\\text{Case C},\\text{Case D}]$.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of numerical analysis for reaction-transport systems, is well-posed with a complete and consistent set of givens for each test case, and is expressed in objective, formal language. The task is a standard exercise in computational science, specifically concerning operator-splitting methods for systems of linear ordinary differential equations. We may therefore proceed with the solution.\n\nThe problem asks for the computation of the error of a first-order Lie-Godunov operator-splitting scheme for a system of linear ordinary differential equations (ODEs) that models a coupled Thermal-Hydraulic-Chemical (THC) process. The governing equation for the concentration vector $C(t) \\in \\mathbb{R}^N$ is given by\n$$\n\\frac{dC}{dt} = (T + R) C(t)\n$$\nwith an initial condition $C(0) = C_0$. The matrices $T \\in \\mathbb{R}^{N \\times N}$ and $R \\in \\mathbb{R}^{N \\times N}$ represent the discretized transport and linearized reaction operators, respectively.\n\nFirst, we define the exact solution to this linear, constant-coefficient ODE system. The solution over a time interval of length $\\Delta t$ is given by the action of the matrix exponential of the system matrix $A = T+R$ on the initial state.\n$$\nC_{exact}(\\Delta t) = e^{(T+R)\\Delta t} C_0\n$$\nThis provides the benchmark against which the approximate numerical solution will be compared.\n\nNext, we formulate the approximate solution using the specified operator-splitting scheme. The Lie-Godunov splitting method approximates the evolution under the combined operator $T+R$ by sequentially applying the flows of the individual subproblems. The problem specifies a two-step sequence: first, evolve the transport subproblem, and second, evolve the reaction subproblem, each for the full time step $\\Delta t$.\n\nThe transport subproblem is $\\frac{dC}{dt} = T C$. Its exact solution over $\\Delta t$ starting from $C_0$ is $C_{intermediate} = e^{T \\Delta t} C_0$.\nThe reaction subproblem is $\\frac{dC}{dt} = R C$. Its exact solution over $\\Delta t$ starting from $C_{intermediate}$ is $C_{final} = e^{R \\Delta t} C_{intermediate}$.\n\nCombining these steps gives the operator-split solution at time $\\Delta t$:\n$$\nC_{split}(\\Delta t) = e^{R \\Delta t} (e^{T \\Delta t} C_0) = (e^{R \\Delta t} e^{T \\Delta t}) C_0\n$$\nThe error of the splitting scheme after one time step is the Euclidean norm of the difference between the split solution and the exact solution. The error vector is\n$$\nv_{err} = C_{split}(\\Delta t) - C_{exact}(\\Delta t) = \\left( e^{R \\Delta t} e^{T \\Delta t} - e^{(T+R)\\Delta t} \\right) C_0\n$$\nThe quantity to be computed is the Euclidean norm (or $\\ell^2$-norm) of this vector:\n$$\n\\text{Error} = \\| v_{err} \\|_2 = \\sqrt{\\sum_{i=1}^{N} (v_{err,i})^2}\n$$\nThe fundamental source of this splitting error is the non-commutativity of matrix exponentiation. In general, for matrices $X$ and $Y$, $e^X e^Y \\neq e^{X+Y}$. The equality holds if and only if the matrices commute, i.e., $XY = YX$. In our context, with $X = R\\Delta t$ and $Y = T\\Delta t$, the Lie splitting scheme is exact if and only if the operators $T$ and $R$ commute ($TR = RT$). For non-commuting operators, the Baker-Campbell-Hausdorff (BCH) formula indicates that the local error is proportional to the commutator of the operators, $[T, R] = TR - RT$. Specifically, $e^{R \\Delta t} e^{T \\Delta t} = e^{(T+R)\\Delta t + \\frac{(\\Delta t)^2}{2}[R,T] + \\mathcal{O}((\\Delta t)^3)}$. This shows that the local error of the scheme is of order $\\mathcal{O}((\\Delta t)^2)$, which makes the Lie splitting method a first-order accurate method.\n\nThe algorithm for each test case is as follows:\n1. Define the matrices $T$ and $R$, the initial vector $C_0$, and the time step $\\Delta t$.\n2. Compute the combined operator matrix $A = T + R$.\n3. Compute the matrix exponential for the exact solution: $M_{exact} = e^{A \\Delta t}$.\n4. Compute the exact solution vector: $C_{exact} = M_{exact} C_0$.\n5. Compute the matrix exponentials for the split subproblems: $M_T = e^{T \\Delta t}$ and $M_R = e^{R \\Delta t}$.\n6. Compute the split solution vector: $C_{split} = M_R (M_T C_0)$.\n7. Calculate the difference vector $v_{err} = C_{split} - C_{exact}$.\n8. Compute the Euclidean norm of the difference vector, $\\| v_{err} \\|_2$.\n\nThis procedure is applied to each of the four test cases. Case B, where both $T$ and $R$ are diagonal matrices, is a special case. Since all diagonal matrices commute, we expect $[T, R]=0$, and therefore the splitting error should be zero, up to machine precision. Case D, which uses a very small $\\Delta t$, allows for verification of the expected $\\mathcal{O}((\\Delta t)^2)$ behavior of the one-step error.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Computes the operator-splitting error for four test cases of a linearized\n    reaction-transport system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: general noncommuting transport and reaction\n        {\n            \"T\": np.array([\n                [-2.0, 2.0, 0.0],\n                [1.0, -3.0, 2.0],\n                [0.0, 1.0, -1.0]\n            ]),\n            \"R\": np.array([\n                [-0.3, 0.05, 0.0],\n                [0.0, -0.2, 0.0],\n                [0.04, 0.0, -0.1]\n            ]),\n            \"C0\": np.array([1.0, 0.5, 0.2]),\n            \"dt\": 0.1\n        },\n        # Case B: commuting operators; diagonal transport and reaction\n        {\n            \"T\": np.diag([-1.0, -2.0, -3.0]),\n            \"R\": np.diag([-0.1, -0.1, -0.1]),\n            \"C0\": np.array([1.0, 1.0, 1.0]),\n            \"dt\": 0.3\n        },\n        # Case C: stiff reaction relative to transport\n        {\n            \"T\": np.array([\n                [-2.0, 2.0, 0.0],\n                [1.0, -3.0, 2.0],\n                [0.0, 1.0, -1.0]\n            ]),\n            \"R\": np.array([\n                [-10.0, 0.0, 0.0],\n                [0.0, -5.0, 0.0],\n                [0.0, 0.5, -1.0]\n            ]),\n            \"C0\": np.array([2.0, 0.1, 1.0]),\n            \"dt\": 0.05\n        },\n        # Case D: small time step to probe error order\n        {\n            \"T\": np.array([\n                [-2.0, 2.0, 0.0],\n                [1.0, -3.0, 2.0],\n                [0.0, 1.0, -1.0]\n            ]),\n            \"R\": np.array([\n                [-0.3, 0.05, 0.0],\n                [0.0, -0.2, 0.0],\n                [0.04, 0.0, -0.1]\n            ]),\n            \"C0\": np.array([0.3, 0.7, 0.9]),\n            \"dt\": 1.0e-4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        R = case[\"R\"]\n        C0 = case[\"C0\"]\n        dt = case[\"dt\"]\n\n        # Full operator matrix\n        A = T + R\n\n        # --- Exact Solution ---\n        # C_exact(dt) = exp((T+R)*dt) * C0\n        exp_A_dt = expm(A * dt)\n        C_exact = exp_A_dt @ C0\n\n        # --- Operator-Split Solution (Lie-Godunov) ---\n        # First, transport step: C_intermediate = exp(T*dt) * C0\n        # Second, reaction step: C_split = exp(R*dt) * C_intermediate\n        exp_T_dt = expm(T * dt)\n        exp_R_dt = expm(R * dt)\n        \n        # C_split(dt) = exp(R*dt) * exp(T*dt) * C0\n        C_split = exp_R_dt @ (exp_T_dt @ C0)\n\n        # --- Error Calculation ---\n        # Error is the Euclidean norm of the difference vector\n        error_vector = C_split - C_exact\n        error_norm = np.linalg.norm(error_vector, ord=2)\n        results.append(error_norm)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}