{
    "hands_on_practices": [
        {
            "introduction": "The movement of dissolved chemicals in the subsurface is governed by the interplay of advection, which is transport with the flowing water, and hydrodynamic dispersion, which is spreading due to mechanical mixing and molecular diffusion. A cornerstone of modeling this process is correctly quantifying the total solute flux, which requires constructing the hydrodynamic dispersion tensor $\\mathbf{D}$. This practice  will guide you through the fundamental calculation of the components of $\\mathbf{D}$ based on the local flow velocity and then using it to determine the complete advective-dispersive flux vector.",
            "id": "4088666",
            "problem": "Consider a saturated, homogeneous, two-dimensional porous medium with steady flow and pore-water velocity field $\\mathbf{v}=(U,0)$, where $U$ is a positive constant. Assume Fickian hydrodynamic dispersion with constant longitudinal dispersivity $\\alpha_{L}$, transverse dispersivity $\\alpha_{T}$, and molecular diffusion coefficient $D_{m}$. The total mass flux of a dilute solute per unit fluid area is modeled as $\\mathbf{J}=\\mathbf{v}\\,C-\\mathbf{D}\\,\\nabla C$, where $C$ is the aqueous concentration and $\\mathbf{D}$ is the two-dimensional hydrodynamic dispersion–diffusion tensor. At a point $\\mathcal{P}$ in the domain, the local concentration and its gradient are known and given by $C(\\mathcal{P})=C_{\\mathcal{P}}$ and $\\nabla C(\\mathcal{P})=(\\partial C/\\partial x,\\,\\partial C/\\partial y)_{\\mathcal{P}}$, respectively.\n\nUsing first principles of mass conservation and constitutive modeling of Fickian hydrodynamic dispersion in a saturated porous medium in which the direction of enhanced spreading aligns with the local flow direction, determine the tensor components of $\\mathbf{D}$ and the flux $\\mathbf{J}$ at $\\mathcal{P}$ for the following data:\n- $U=2.5\\times 10^{-5}$ m/s,\n- $\\alpha_{L}=1$ m,\n- $\\alpha_{T}=0.1$ m,\n- $D_{m}=1.0\\times 10^{-9}$ m$^{2}$/s,\n- $C_{\\mathcal{P}}=0.50$ mol/m$^{3}$,\n- $(\\partial C/\\partial x,\\,\\partial C/\\partial y)_{\\mathcal{P}}=\\left(4.0\\times 10^{-3},\\,-1.5\\times 10^{-3}\\right)$ mol/m$^{4}$.\n\nExpress the components of $\\mathbf{D}$ in m$^{2}$/s and the components of $\\mathbf{J}$ in mol m$^{-2}$ s$^{-1}$. Report the final result as a single row matrix containing, in order, ($D_{xx}$, $D_{xy}$, $D_{yx}$, $D_{yy}$, $J_{x}$, $J_{y}$), rounded to four significant figures. Do not include units in your final boxed answer.",
            "solution": "The problem is validated as self-contained, consistent, and scientifically sound. It represents a standard application of the principles of solute transport in porous media.\n\nThe total mass flux $\\mathbf{J}$ of a solute per unit fluid area is the sum of the advective flux, $\\mathbf{J}_a = \\mathbf{v} C$, and the hydrodynamic dispersive-diffusive flux, $\\mathbf{J}_d = -\\mathbf{D} \\nabla C$. The total flux vector is thus given by the equation:\n$$\n\\mathbf{J} = \\mathbf{v} C - \\mathbf{D} \\nabla C\n$$\nwhere $\\mathbf{v}$ is the pore-water velocity vector, $C$ is the solute concentration, and $\\mathbf{D}$ is the hydrodynamic dispersion tensor.\n\nThe hydrodynamic dispersion tensor $\\mathbf{D}$ accounts for mechanical dispersion and molecular diffusion. For a two-dimensional system and an isotropic porous medium, its components $D_{ij}$ are given by the constitutive relation established by Bear:\n$$\nD_{ij} = (\\alpha_L - \\alpha_T) \\frac{v_i v_j}{|\\mathbf{v}|} + \\alpha_T |\\mathbf{v}| \\delta_{ij} + D_m \\delta_{ij}\n$$\nwhere $\\alpha_L$ is the longitudinal dispersivity, $\\alpha_T$ is the transverse dispersivity, $v_i$ and $v_j$ are the components of the velocity vector $\\mathbf{v}$, $|\\mathbf{v}|$ is the magnitude of the velocity, $D_m$ is the molecular diffusion coefficient, and $\\delta_{ij}$ is the Kronecker delta ($\\delta_{ij}=1$ if $i=j$ and $\\delta_{ij}=0$ if $i \\neq j$).\n\nThe problem provides a steady, unidirectional velocity field $\\mathbf{v} = (U, 0)$, where $U = 2.5 \\times 10^{-5}$ m/s. The velocity components are $v_x = U$ and $v_y = 0$. The magnitude of the velocity is $|\\mathbf{v}| = \\sqrt{U^2 + 0^2} = U$, since $U$ is a positive constant.\n\nWe can now determine the components of the tensor $\\mathbf{D}$:\n\nFor $D_{xx}$ ($i=x, j=x$):\n$$\nD_{xx} = (\\alpha_L - \\alpha_T) \\frac{v_x v_x}{U} + \\alpha_T U \\delta_{xx} + D_m \\delta_{xx} = (\\alpha_L - \\alpha_T) \\frac{U^2}{U} + \\alpha_T U(1) + D_m(1) = (\\alpha_L - \\alpha_T)U + \\alpha_T U + D_m = \\alpha_L U + D_m\n$$\n\nFor $D_{yy}$ ($i=y, j=y$):\n$$\nD_{yy} = (\\alpha_L - \\alpha_T) \\frac{v_y v_y}{U} + \\alpha_T U \\delta_{yy} + D_m \\delta_{yy} = (\\alpha_L - \\alpha_T) \\frac{0^2}{U} + \\alpha_T U(1) + D_m(1) = \\alpha_T U + D_m\n$$\n\nFor the off-diagonal terms $D_{xy}$ ($i=x, j=y$) and $D_{yx}$ ($i=y, j=x$):\n$$\nD_{xy} = D_{yx} = (\\alpha_L - \\alpha_T) \\frac{v_x v_y}{U} + \\alpha_T U \\delta_{xy} + D_m \\delta_{xy} = (\\alpha_L - \\alpha_T) \\frac{U \\cdot 0}{U} + \\alpha_T U(0) + D_m(0) = 0\n$$\nAs expected for flow aligned with a coordinate axis, the dispersion tensor is diagonal.\n\nNow we substitute the given numerical values:\n- $U=2.5 \\times 10^{-5}$ m/s\n- $\\alpha_{L}=1$ m\n- $\\alpha_{T}=0.1$ m\n- $D_{m}=1.0 \\times 10^{-9}$ m$^{2}$/s\n\nThe components of $\\mathbf{D}$ are:\n$$\nD_{xx} = (1 \\, \\text{m}) (2.5 \\times 10^{-5} \\, \\text{m/s}) + 1.0 \\times 10^{-9} \\, \\text{m}^2/\\text{s} = 2.5 \\times 10^{-5} \\, \\text{m}^2/\\text{s} + 1.0 \\times 10^{-9} \\, \\text{m}^2/\\text{s} = 2.5001 \\times 10^{-5} \\, \\text{m}^2/\\text{s}\n$$\n$$\nD_{yy} = (0.1 \\, \\text{m}) (2.5 \\times 10^{-5} \\, \\text{m/s}) + 1.0 \\times 10^{-9} \\, \\text{m}^2/\\text{s} = 2.5 \\times 10^{-6} \\, \\text{m}^2/\\text{s} + 1.0 \\times 10^{-9} \\, \\text{m}^2/\\text{s} = 2.501 \\times 10^{-6} \\, \\text{m}^2/\\text{s}\n$$\n$$\nD_{xy} = D_{yx} = 0 \\, \\text{m}^2/\\text{s}\n$$\n\nNext, we calculate the components of the flux vector $\\mathbf{J} = (J_x, J_y)$ at point $\\mathcal{P}$. The component form of the flux equation is:\n$$\nJ_x = v_x C - \\left(D_{xx} \\frac{\\partial C}{\\partial x} + D_{xy} \\frac{\\partial C}{\\partial y}\\right)\n$$\n$$\nJ_y = v_y C - \\left(D_{yx} \\frac{\\partial C}{\\partial x} + D_{yy} \\frac{\\partial C}{\\partial y}\\right)\n$$\nUsing the data at point $\\mathcal{P}$:\n- $C_{\\mathcal{P}} = 0.50$ mol/m$^{3}$\n- $(\\partial C/\\partial x)_{\\mathcal{P}} = 4.0 \\times 10^{-3}$ mol/m$^{4}$\n- $(\\partial C/\\partial y)_{\\mathcal{P}} = -1.5 \\times 10^{-3}$ mol/m$^{4}$\n\nAnd the values $v_x = U = 2.5 \\times 10^{-5}$ m/s and $v_y = 0$, we calculate the flux components:\n$$\nJ_x = (2.5 \\times 10^{-5})(0.50) - \\left( (2.5001 \\times 10^{-5})(4.0 \\times 10^{-3}) + (0)(-1.5 \\times 10^{-3}) \\right)\n$$\n$$\nJ_x = 1.25 \\times 10^{-5} - (1.00004 \\times 10^{-7}) = 1.25 \\times 10^{-5} - 0.100004 \\times 10^{-5} = 1.149996 \\times 10^{-5} \\, \\text{mol m}^{-2} \\text{s}^{-1}\n$$\n$$\nJ_y = (0)(0.50) - \\left( (0)(4.0 \\times 10^{-3}) + (2.501 \\times 10^{-6})(-1.5 \\times 10^{-3}) \\right)\n$$\n$$\nJ_y = 0 - (-3.7515 \\times 10^{-9}) = 3.7515 \\times 10^{-9} \\, \\text{mol m}^{-2} \\text{s}^{-1}\n$$\n\nFinally, we round the required values to four significant figures:\n- $D_{xx} = 2.5001 \\times 10^{-5} \\approx 2.500 \\times 10^{-5}$\n- $D_{xy} = 0$ (exact)\n- $D_{yx} = 0$ (exact)\n- $D_{yy} = 2.501 \\times 10^{-6}$ (already four significant figures)\n- $J_x = 1.149996 \\times 10^{-5} \\approx 1.150 \\times 10^{-5}$\n- $J_y = 3.7515 \\times 10^{-9} \\approx 3.752 \\times 10^{-9}$\n\nThe final result is the ordered set ($D_{xx}$, $D_{xy}$, $D_{yx}$, $D_{yy}$, $J_x$, $J_y$).",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.500 \\times 10^{-5}  0  0  2.501 \\times 10^{-6}  1.150 \\times 10^{-5}  3.752 \\times 10^{-9} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Reactive transport models operate at a macroscopic, continuum scale, yet the chemical reactions they represent, such as mineral dissolution, occur at the microscopic scale of mineral-water interfaces. A critical task is to upscale these microscale processes into a volumetric source term, $R$, that is compatible with the governing partial differential equation. This exercise  provides hands-on practice in this essential conversion, demonstrating how to synthesize properties like porosity, mineral abundance, and specific surface area to bridge the gap between laboratory rate measurements and field-scale simulations.",
            "id": "4088664",
            "problem": "A three-dimensional representative elementary volume of a carbonate-bearing aquifer is modeled for reactive transport. Within this volume, the mineral calcite is present as a dispersed phase. The aqueous mass balance is written per unit fluid volume, and the reactive source term must therefore be expressed per unit fluid volume.\n\nYou are given the following independently measured properties:\n- Porosity $\\theta = 0.32$ (dimensionless).\n- Calcite volume fraction in the bulk volume $\\varepsilon_{m} = 0.30$ (dimensionless).\n- Calcite density $\\rho_{m} = 2710 \\ \\mathrm{kg \\ m^{-3}}$.\n- Mineral specific surface area per unit mineral mass (smooth geometric surface) $\\mathrm{SSA} = 1.2 \\ \\mathrm{m^{2} \\ kg^{-1}}$.\n- Microroughness factor $\\chi = 2.5$ (dimensionless), which multiplies the geometric area to give the true area.\n- Reactive coverage fraction $\\alpha = 0.60$ (dimensionless), meaning only a fraction $\\alpha$ of the true surface area participates in reaction due to surface coatings.\n- Aqueous-phase, far-from-equilibrium calcite dissolution rate measured per unit reactive surface area $r_{\\mathrm{surf}} = 1.6 \\times 10^{-9} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}$, based on the net reaction $\\mathrm{CaCO_{3}(s)} \\to \\mathrm{Ca^{2+}} + \\mathrm{CO_{3}^{2-}}$.\n\nAssume that the dissolution produces $\\mathrm{Ca^{2+}}$ with stoichiometric coefficient $\\nu_{\\mathrm{Ca^{2+}}} = +1$ per mole of calcite dissolved, and that the surface area relevant to reaction resides entirely within the pore network. Neglect transport and any secondary precipitation.\n\nUsing only conservation of mass principles, convert the given surface-normalized dissolution rate to a volumetric source term for aqueous $\\mathrm{Ca^{2+}}$ per unit fluid volume. Express your final numerical answer in $\\mathrm{mol \\ m^{-3} \\ of \\ fluid \\ s^{-1}}$, and round your answer to four significant figures.",
            "solution": "The problem requires the conversion of a surface-area-normalized mineral dissolution rate into a volumetric source term for an aqueous species, normalized per unit fluid volume. This is a standard upscaling procedure in reactive transport modeling for porous media. The solution will be derived by systematically applying the definitions of the provided parameters to perform a dimensional analysis.\n\nLet $R_{\\mathrm{Ca^{2+}}}$ be the volumetric source term for aqueous $\\mathrm{Ca^{2+}}$ per unit fluid volume, with units of $\\mathrm{mol \\ m^{-3}_{fluid} \\ s^{-1}}$. The starting point is the given surface-normalized dissolution rate of calcite, $r_{\\mathrm{surf}}$, which has units of $\\mathrm{mol \\ m^{-2} \\ s^{-1}}$. Specifically, this rate is normalized by the *reactive surface area*.\n\nThe overall conversion can be formally expressed as:\n$$\nR_{\\mathrm{Ca^{2+}}} = r_{\\mathrm{surf}} \\times \\left( \\frac{\\text{reactive surface area}}{\\text{fluid volume}} \\right) \\times \\nu_{\\mathrm{Ca^{2+}}}\n$$\nwhere $\\nu_{\\mathrm{Ca^{2+}}}$ is the stoichiometric coefficient relating moles of $\\mathrm{Ca^{2+}}$ produced to moles of calcite dissolved.\n\nThe core of the problem is to determine the ratio of reactive surface area to fluid volume. It is more convenient to work with quantities normalized by the total bulk volume of the representative elementary volume (REV). Let $V_T$ be the total bulk volume, $V_f$ be the fluid (pore) volume, and $A_r$ be the total reactive surface area within the REV.\n\nThe porosity, $\\theta$, is defined as the fluid volume per unit bulk volume:\n$$\n\\theta = \\frac{V_f}{V_T}\n$$\nThe quantity we need, the reactive surface area per unit fluid volume, can be expressed as:\n$$\n\\frac{A_r}{V_f} = \\frac{A_r/V_T}{V_f/V_T} = \\frac{\\mathcal{A}_r}{\\theta}\n$$\nwhere $\\mathcal{A}_r = A_r/V_T$ is the reactive surface area per unit bulk volume (in units of $\\mathrm{m^2 \\ m^{-3}}$).\n\nThe volumetric source term for $\\mathrm{Ca^{2+}}$ per unit fluid volume is therefore:\n$$\nR_{\\mathrm{Ca^{2+}}} = \\frac{r_{\\mathrm{surf}} \\cdot \\mathcal{A}_r \\cdot \\nu_{\\mathrm{Ca^{2+}}}}{\\theta}\n$$\n\nOur task now reduces to calculating $\\mathcal{A}_r$ from the given parameters. This is achieved through a sequence of steps:\n\n1.  **Mass of calcite per unit bulk volume ($M_m$):**\n    This is the product of the calcite volume fraction in the bulk volume, $\\varepsilon_m$, and the density of calcite, $\\rho_m$.\n    $$\n    M_m = \\varepsilon_m \\cdot \\rho_m\n    $$\n    Units: $(\\mathrm{m^3_{calcite}}/\\mathrm{m^3_{bulk}}) \\times (\\mathrm{kg_{calcite}}/\\mathrm{m^3_{calcite}}) = \\mathrm{kg_{calcite}}/\\mathrm{m^3_{bulk}}$.\n\n2.  **Geometric surface area per unit bulk volume ($\\mathcal{A}_g$):**\n    This is obtained by multiplying the mass of calcite per bulk volume ($M_m$) by the mineral specific surface area ($\\mathrm{SSA}$), which is defined per unit mass of the mineral.\n    $$\n    \\mathcal{A}_g = M_m \\cdot \\mathrm{SSA} = \\varepsilon_m \\cdot \\rho_m \\cdot \\mathrm{SSA}\n    $$\n    Units: $(\\mathrm{kg_{calcite}}/\\mathrm{m^3_{bulk}}) \\times (\\mathrm{m^2_{geometric}}/\\mathrm{kg_{calcite}}) = \\mathrm{m^2_{geometric}}/\\mathrm{m^3_{bulk}}$.\n\n3.  **True surface area per unit bulk volume ($\\mathcal{A}_t$):**\n    The true surface area accounts for surface roughness at the microscale. It is calculated by multiplying the geometric (smooth) surface area by the dimensionless microroughness factor, $\\chi$.\n    $$\n    \\mathcal{A}_t = \\mathcal{A}_g \\cdot \\chi = \\varepsilon_m \\cdot \\rho_m \\cdot \\mathrm{SSA} \\cdot \\chi\n    $$\n    Units: $(\\mathrm{m^2_{geometric}}/\\mathrm{m^3_{bulk}}) \\times (\\mathrm{m^2_{true}}/\\mathrm{m^2_{geometric}}) = \\mathrm{m^2_{true}}/\\mathrm{m^3_{bulk}}$.\n\n4.  **Reactive surface area per unit bulk volume ($\\mathcal{A}_r$):**\n    Not all of the true surface may be reactive due to coatings or passivation. The reactive surface area is found by multiplying the true surface area by the dimensionless reactive coverage fraction, $\\alpha$.\n    $$\n    \\mathcal{A}_r = \\mathcal{A}_t \\cdot \\alpha = \\varepsilon_m \\cdot \\rho_m \\cdot \\mathrm{SSA} \\cdot \\chi \\cdot \\alpha\n    $$\n    Units: $(\\mathrm{m^2_{true}}/\\mathrm{m^3_{bulk}}) \\times (\\mathrm{m^2_{reactive}}/\\mathrm{m^2_{true}}) = \\mathrm{m^2_{reactive}}/\\mathrm{m^3_{bulk}}$.\n\nNow, we can assemble the complete expression for $R_{\\mathrm{Ca^{2+}}}$:\n$$\nR_{\\mathrm{Ca^{2+}}} = \\frac{r_{\\mathrm{surf}} \\cdot (\\varepsilon_m \\cdot \\rho_m \\cdot \\mathrm{SSA} \\cdot \\chi \\cdot \\alpha) \\cdot \\nu_{\\mathrm{Ca^{2+}}}}{\\theta}\n$$\n\nWe are given the following values:\n- Porosity $\\theta = 0.32$\n- Calcite volume fraction $\\varepsilon_{m} = 0.30$\n- Calcite density $\\rho_{m} = 2710 \\ \\mathrm{kg \\ m^{-3}}$\n- Specific surface area $\\mathrm{SSA} = 1.2 \\ \\mathrm{m^{2} \\ kg^{-1}}$\n- Microroughness factor $\\chi = 2.5$\n- Reactive coverage fraction $\\alpha = 0.60$\n- Surface-normalized rate $r_{\\mathrm{surf}} = 1.6 \\times 10^{-9} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}$\n- Stoichiometric coefficient $\\nu_{\\mathrm{Ca^{2+}}} = 1$\n\nSubstituting these values into the derived expression:\n$$\nR_{\\mathrm{Ca^{2+}}} = \\frac{(1.6 \\times 10^{-9} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}) \\cdot (0.30) \\cdot (2710 \\ \\mathrm{kg \\ m^{-3}}) \\cdot (1.2 \\ \\mathrm{m^{2} \\ kg^{-1}}) \\cdot (2.5) \\cdot (0.60) \\cdot (1)}{0.32}\n$$\nFirst, calculate the numerator:\n$$\n\\text{Numerator} = (1.6 \\times 10^{-9}) \\cdot (0.30) \\cdot (2710) \\cdot (1.2) \\cdot (2.5) \\cdot (0.60)\n$$\n$$\n\\text{Numerator} = 2.34144 \\times 10^{-6} \\ \\mathrm{mol \\ m^{-3}_{bulk} \\ s^{-1}}\n$$\nThis is the production rate of $\\mathrm{Ca^{2+}}$ per unit bulk volume.\n\nFinally, normalize by the porosity $\\theta$ to obtain the rate per unit fluid volume:\n$$\nR_{\\mathrm{Ca^{2+}}} = \\frac{2.34144 \\times 10^{-6} \\ \\mathrm{mol \\ m^{-3}_{bulk} \\ s^{-1}}}{0.32 \\ \\mathrm{m^{3}_{fluid} \\ m^{-3}_{bulk}}}\n$$\n$$\nR_{\\mathrm{Ca^{2+}}} = 7.317 \\times 10^{-6} \\ \\mathrm{mol \\ m^{-3}_{fluid} \\ s^{-1}}\n$$\nThe problem requests the final answer to be rounded to four significant figures. The calculated value $7.317 \\times 10^{-6}$ already has four significant figures.",
            "answer": "$$\\boxed{7.317 \\times 10^{-6}}$$"
        },
        {
            "introduction": "Formulating the governing reactive transport equation is only the first step; solving it numerically presents a distinct set of challenges, particularly concerning stability and efficiency. Operator-splitting schemes, which solve for transport and reaction sequentially, are common, but their stability when using explicit methods is constrained by the physics of the problem. This exercise  delves into the linear stability analysis of such a scheme, asking you to derive and compare the time-step limitations imposed by advection (the CFL condition), diffusion, and stiff reaction kinetics, thereby illustrating a core issue in computational geochemistry.",
            "id": "4088644",
            "problem": "Consider the two-dimensional advection–diffusion–reaction equation for an aqueous geochemical system,\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot (\\mathbf{v}\\,c) \\;=\\; \\nabla \\cdot \\left(\\mathbf{D}\\,\\nabla c\\right) \\;+\\; \\mathbf{R}(c),\n$$\nwhere $c$ is the vector of species concentrations, $\\mathbf{v} = (v_x,v_y)$ is the porewater velocity field, $\\mathbf{D} = \\mathrm{diag}(D_x,D_y)$ is the (diagonal) dispersion–diffusion tensor, and $\\mathbf{R}(c)$ is the reaction source term. Assume an operator-splitting scheme of first-order Godunov type, in which transport is advanced explicitly over a full time step $\\Delta t$ using a finite-volume discretization, followed by an explicit forward Euler reaction update over the same $\\Delta t$.\n\nThe transport step consists of:\n- advection discretized by a first-order upwind explicit scheme in $x$ and $y$ on a uniform Cartesian grid with spacings $\\Delta x$ and $\\Delta y$,\n- diffusion/dispersion discretized by a forward-time, central-space explicit scheme in $x$ and $y$.\n\nThe reaction kinetics are stiff but linearizable near the current state. Consider two reacting aqueous species $A$ and $B$ with mass-action steps $A \\rightleftharpoons B$ (forward rate constant $k_1$ and backward rate constant $k_2$) and $B \\rightarrow$ product (first-order rate constant $k_3$). Linearizing about the current state yields a reaction Jacobian $\\mathbf{J}$ such that $\\mathbf{R}(c) \\approx \\mathbf{J}\\,c$ with\n$$\n\\mathbf{J} \\;=\\; \\begin{pmatrix}\n-\\,k_1  k_2 \\\\\nk_1  -\\,(k_2 + k_3)\n\\end{pmatrix}.\n$$\n\nStarting from first principles of linear stability analysis:\n- for the explicit forward Euler method applied to a linear system $\\dot{\\mathbf{y}} = \\mathbf{J}\\,\\mathbf{y}$, determine the stability constraint on $\\Delta t$ in terms of the eigenvalues of $\\mathbf{J}$,\n- for the explicit first-order upwind advection scheme on a uniform grid in two dimensions, determine the Courant–Friedrichs–Lewy (CFL) type constraint on $\\Delta t$ in terms of $v_x$, $v_y$, $\\Delta x$, and $\\Delta y$,\n- for the explicit forward-time, central-space diffusion scheme in two dimensions, determine the corresponding stability constraint on $\\Delta t$ in terms of $D_x$, $D_y$, $\\Delta x$, and $\\Delta y$,\n\nand then combine these to obtain the maximum allowable explicit time step $\\Delta t_{\\max}$ that satisfies all three constraints simultaneously for the following parameters:\n- grid spacing $\\Delta x = 0.5\\,\\mathrm{m}$ and $\\Delta y = 0.25\\,\\mathrm{m}$,\n- velocities $v_x = 1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ and $v_y = 5.0 \\times 10^{-5}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- dispersion–diffusion coefficients $D_x = 1.0 \\times 10^{-5}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ and $D_y = 2.0 \\times 10^{-5}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n- reaction rate constants $k_1 = 30\\,\\mathrm{s}^{-1}$, $k_2 = 200\\,\\mathrm{s}^{-1}$, and $k_3 = 1000\\,\\mathrm{s}^{-1}$.\n\nRound your final numerical answer for $\\Delta t_{\\max}$ to four significant figures and express it in seconds.",
            "solution": "The problem requires finding the maximum stable time step, $\\Delta t_{\\max}$, for a first-order explicit operator-splitting scheme applied to a two-dimensional advection-diffusion-reaction equation. The total time step $\\Delta t$ is limited by the stability constraints of the individual numerical methods used for reaction, advection, and diffusion. We will derive each constraint separately and then find the most restrictive one.\n\nThe maximum allowable time step $\\Delta t$ must satisfy all three constraints simultaneously:\n$$\n\\Delta t \\le \\min(\\Delta t_{\\text{react}}, \\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}})\n$$\nwhere $\\Delta t_{\\text{react}}$, $\\Delta t_{\\text{adv}}$, and $\\Delta t_{\\text{diff}}$ are the maximum time steps permitted by the reaction, advection, and diffusion schemes, respectively.\n\n1.  **Stability of the Reaction Step**\n\nThe reaction part of the split scheme solves the system of ordinary differential equations $\\dot{\\mathbf{c}} = \\mathbf{R}(\\mathbf{c})$. After linearization, this becomes $\\dot{\\mathbf{c}} \\approx \\mathbf{J}\\,\\mathbf{c}$, where $\\mathbf{J}$ is the Jacobian matrix. The problem specifies an explicit forward Euler method for this step:\n$$\n\\mathbf{c}^{n+1} = \\mathbf{c}^n + \\Delta t \\, \\mathbf{J} \\, \\mathbf{c}^n = (\\mathbf{I} + \\Delta t \\, \\mathbf{J}) \\, \\mathbf{c}^n\n$$\nwhere $\\mathbf{I}$ is the identity matrix. The matrix $\\mathbf{G} = \\mathbf{I} + \\Delta t \\, \\mathbf{J}$ is the amplification matrix. For the scheme to be stable, the spectral radius of $\\mathbf{G}$ must be less than or equal to $1$, i.e., $\\rho(\\mathbf{G}) \\le 1$. The eigenvalues of $\\mathbf{G}$, denoted $\\mu_i$, are related to the eigenvalues of $\\mathbf{J}$, denoted $\\lambda_i$, by $\\mu_i = 1 + \\Delta t \\lambda_i$. The stability condition is therefore $|1 + \\Delta t \\lambda_i| \\le 1$ for all eigenvalues $\\lambda_i$ of $\\mathbf{J}$.\n\nThe given Jacobian matrix is:\n$$\n\\mathbf{J} \\;=\\; \\begin{pmatrix}\n-\\,k_1  k_2 \\\\\nk_1  -\\,(k_2 + k_3)\n\\end{pmatrix}\n$$\nSubstituting the given rate constants $k_1 = 30\\,\\mathrm{s}^{-1}$, $k_2 = 200\\,\\mathrm{s}^{-1}$, and $k_3 = 1000\\,\\mathrm{s}^{-1}$:\n$$\n\\mathbf{J} \\;=\\; \\begin{pmatrix}\n-30  200 \\\\\n30  -(200 + 1000)\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n-30  200 \\\\\n30  -1200\n\\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(\\mathbf{J} - \\lambda\\mathbf{I}) = 0$:\n$$\n(-30 - \\lambda)(-1200 - \\lambda) - (200)(30) = 0 \\\\\n\\lambda^2 + 1230\\lambda + 36000 - 6000 = 0 \\\\\n\\lambda^2 + 1230\\lambda + 30000 = 0\n$$\nUsing the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\lambda = \\frac{-1230 \\pm \\sqrt{1230^2 - 4(1)(30000)}}{2} = \\frac{-1230 \\pm \\sqrt{1512900 - 120000}}{2} = \\frac{-1230 \\pm \\sqrt{1392900}}{2}\n$$\nThe eigenvalues are:\n$$\n\\lambda_1 = \\frac{-1230 - \\sqrt{1392900}}{2} \\approx -1205.11\\,\\mathrm{s}^{-1} \\\\\n\\lambda_2 = \\frac{-1230 + \\sqrt{1392900}}{2} \\approx -24.89\\,\\mathrm{s}^{-1}\n$$\nBoth eigenvalues are real and negative, which is expected for stable reaction kinetics. The stability condition $|1 + \\Delta t \\lambda| \\le 1$ for a real, negative $\\lambda$ simplifies to $-1 \\le 1 + \\Delta t \\lambda \\le 1$. The right inequality is always satisfied. The left inequality gives $-2 \\le \\Delta t \\lambda$, or $\\Delta t \\le -2/\\lambda$. To satisfy this for both eigenvalues, we must take the most restrictive case, which corresponds to the eigenvalue with the largest magnitude (the most negative eigenvalue), $\\lambda_{\\min}$.\n$$\n\\Delta t_{\\text{react}} \\le \\frac{-2}{\\lambda_{\\min}} = \\frac{-2}{\\frac{-1230 - \\sqrt{1392900}}{2}} = \\frac{4}{1230 + \\sqrt{1392900}} \\approx 0.0016596\\,\\mathrm{s}\n$$\nThis constraint is due to the stiffness of the reaction system.\n\n2.  **Stability of the Advection Step**\n\nThe advection step is modeled by $\\frac{\\partial c}{\\partial t} + v_x \\frac{\\partial c}{\\partial x} + v_y \\frac{\\partial c}{\\partial y} = 0$. Using a first-order upwind explicit scheme on a uniform grid, assuming $v_x > 0$ and $v_y > 0$, the discretization is:\n$$\n\\frac{c_{i,j}^{n+1} - c_{i,j}^n}{\\Delta t} + v_x \\frac{c_{i,j}^n - c_{i-1,j}^n}{\\Delta x} + v_y \\frac{c_{i,j}^n - c_{i,j-1}^n}{\\Delta y} = 0\n$$\nRearranging the terms gives the update formula:\n$$\nc_{i,j}^{n+1} = \\left(1 - \\frac{v_x \\Delta t}{\\Delta x} - \\frac{v_y \\Delta t}{\\Delta y}\\right) c_{i,j}^n + \\frac{v_x \\Delta t}{\\Delta x} c_{i-1,j}^n + \\frac{v_y \\Delta t}{\\Delta y} c_{i,j-1}^n\n$$\nFor stability (and to prevent non-physical oscillations), all coefficients on the right-hand side must be non-negative. This leads to the Courant–Friedrichs–Lewy (CFL) condition:\n$$\n\\frac{|v_x| \\Delta t}{\\Delta x} + \\frac{|v_y| \\Delta t}{\\Delta y} \\le 1\n$$\nThe stability constraint on $\\Delta t$ is:\n$$\n\\Delta t_{\\text{adv}} \\le \\left(\\frac{|v_x|}{\\Delta x} + \\frac{|v_y|}{\\Delta y}\\right)^{-1}\n$$\nUsing the given parameters: $v_x = 1.0 \\times 10^{-4}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $v_y = 5.0 \\times 10^{-5}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $\\Delta x = 0.5\\,\\mathrm{m}$, and $\\Delta y = 0.25\\,\\mathrm{m}$:\n$$\n\\Delta t_{\\text{adv}} \\le \\left(\\frac{1.0 \\times 10^{-4}}{0.5} + \\frac{5.0 \\times 10^{-5}}{0.25}\\right)^{-1} = (2.0 \\times 10^{-4} + 2.0 \\times 10^{-4})^{-1} = (4.0 \\times 10^{-4})^{-1} = 2500\\,\\mathrm{s}\n$$\n\n3.  **Stability of the Diffusion Step**\n\nThe diffusion/dispersion step is governed by $\\frac{\\partial c}{\\partial t} = \\nabla \\cdot (\\mathbf{D}\\,\\nabla c)$, which for a diagonal tensor $\\mathbf{D}$ is $\\frac{\\partial c}{\\partial t} = D_x \\frac{\\partial^2 c}{\\partial x^2} + D_y \\frac{\\partial^2 c}{\\partial y^2}$. The forward-time, central-space (FTCS) explicit scheme is:\n$$\n\\frac{c_{i,j}^{n+1} - c_{i,j}^n}{\\Delta t} = D_x \\frac{c_{i+1,j}^n - 2c_{i,j}^n + c_{i-1,j}^n}{(\\Delta x)^2} + D_y \\frac{c_{i,j+1}^n - 2c_{i,j}^n + c_{i,j-1}^n}{(\\Delta y)^2}\n$$\nVon Neumann stability analysis yields the constraint:\n$$\n\\frac{D_x \\Delta t}{(\\Delta x)^2} + \\frac{D_y \\Delta t}{(\\Delta y)^2} \\le \\frac{1}{2}\n$$\nThis implies the following limit on $\\Delta t$:\n$$\n\\Delta t_{\\text{diff}} \\le \\frac{1}{2} \\left(\\frac{D_x}{(\\Delta x)^2} + \\frac{D_y}{(\\Delta y)^2}\\right)^{-1}\n$$\nUsing the given parameters: $D_x = 1.0 \\times 10^{-5}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $D_y = 2.0 \\times 10^{-5}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $\\Delta x = 0.5\\,\\mathrm{m}$, and $\\Delta y = 0.25\\,\\mathrm{m}$:\n$$\n(\\Delta x)^2 = 0.25\\,\\mathrm{m}^2, \\quad (\\Delta y)^2 = 0.0625\\,\\mathrm{m}^2\n$$\n$$\n\\frac{D_x}{(\\Delta x)^2} = \\frac{1.0 \\times 10^{-5}}{0.25} = 4.0 \\times 10^{-5}\\,\\mathrm{s}^{-1}\n$$\n$$\n\\frac{D_y}{(\\Delta y)^2} = \\frac{2.0 \\times 10^{-5}}{0.0625} = 32.0 \\times 10^{-5} = 3.2 \\times 10^{-4}\\,\\mathrm{s}^{-1}\n$$\n$$\n\\Delta t_{\\text{diff}} \\le \\frac{1}{2} (4.0 \\times 10^{-5} + 3.2 \\times 10^{-4})^{-1} = \\frac{1}{2} (3.6 \\times 10^{-4})^{-1} = \\frac{1}{7.2 \\times 10^{-4}} \\approx 1388.9\\,\\mathrm{s}\n$$\n\n4.  **Overall Stability Constraint**\n\nThe maximum allowable time step, $\\Delta t_{\\max}$, is the minimum of the three individual limits:\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\text{react}}, \\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}})\n$$\nComparing the calculated values:\n$$\n\\Delta t_{\\max} = \\min(0.0016596\\,\\mathrm{s}, 2500\\,\\mathrm{s}, 1388.9\\,\\mathrm{s}) = 0.0016596\\,\\mathrm{s}\n$$\nThe explicit time step is severely limited by the fast reaction kinetics (stiffness), a common feature in reactive transport modeling. Rounding the result to four significant figures gives:\n$$\n\\Delta t_{\\max} \\approx 0.001660\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{0.001660}\n$$"
        }
    ]
}