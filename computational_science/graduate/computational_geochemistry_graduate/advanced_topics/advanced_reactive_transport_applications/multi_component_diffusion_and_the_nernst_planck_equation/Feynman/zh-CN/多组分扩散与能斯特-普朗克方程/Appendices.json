{
    "hands_on_practices": [
        {
            "introduction": "在许多地球化学模型中，我们假设局部电中性以简化控制方程。本练习通过引入德拜长度来探讨这一关键假设的有效性，德拜长度是表征电解质中电荷分离的一个基本尺度。通过推导和计算给定系统的德拜长度，学生将学会如何定量地判断电中性假设是否合理。",
            "id": "4091554",
            "problem": "一个厚度为 $L$ 的一维 (1D) 地球化学扩散池，其中包含一个温度 $T$ 和介电常数 $\\epsilon$ 均匀的水性盐水。该盐水是氯化钠 ($\\mathrm{NaCl}$) 和氯化钙 ($\\mathrm{CaCl}_2$) 的理想、完全解离的混合物，其整体浓度分别为 $0.70$ $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ 和 $0.10$ $\\mathrm{mol}\\,\\mathrm{L}^{-1}$。介质的介电常数 $\\epsilon=5.93\\times 10^{-10}$ $\\mathrm{F}\\,\\mathrm{m}^{-1}$，温度 $T=333$ $\\mathrm{K}$。扩散池的厚度为 $L=100$ $\\mu\\mathrm{m}$。假设系统是等温、均质的，并处于没有净通量的平衡状态，并且静电势的变化足够小，可以进行线性化处理。使用下面给出的基本关系式：\n\n- 对于电解质中电荷数为 $z_i$、扩散系数为 $D_i$ 的物种 $i$，在静电势 $\\phi$ 下的 Nernst–Planck (NP) 方程为 $\\mathbf{J}_i=-D_i\\nabla c_i-\\dfrac{z_i D_i F}{R T}c_i\\nabla\\phi$。\n- 在介电常数为 $\\epsilon$ 的介质中，静电势的 Poisson 方程为 $\\nabla\\cdot\\left(\\epsilon\\nabla\\phi\\right)=-\\rho$，其中 $\\rho=F\\sum_i z_i c_i$ 是体积电荷密度。\n- 离子强度为 $I=\\dfrac{1}{2}\\sum_i z_i^2 c_i$，使用单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 的摩尔浓度 $c_i$。\n\n任务：\n\n1. 从 NP 方程和 Poisson 方程出发，施加所有物种 $i$ 的平衡条件 $\\mathbf{J}_i=\\mathbf{0}$，并对所得的浓度-电势关系围绕整体状态进行线性化。推导线性化的 Poisson–Boltzmann 关系式，并获得仅用 $\\epsilon$、$R$、$T$、$F$ 和离子强度 $I$ 表示的 Debye 筛选长度 $\\lambda_D$。\n2. 根据给定盐水的成分计算其离子强度 $I$。使用单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 的浓度 $c_i$。\n3. 使用您推导的表达式，计算给定条件下的 Debye 筛选长度 $\\lambda_D$。将 $\\lambda_D$ 以纳米为单位表示，并将答案四舍五入到四位有效数字。\n4. 通过比较 $\\lambda_D$ 和 $L$ 来定量评估电中性近似对于该一维扩散池是否有效。定义指示符 $\\chi$，如果 $\\lambda_D/L\\leq 10^{-2}$，则 $\\chi=1$，否则 $\\chi=0$。报告数值对 $\\left(\\lambda_D\\ \\text{（单位为纳米）},\\ \\chi\\right)$。\n\n使用 $R=8.314$ $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和 $F=96485$ $\\mathrm{C}\\,\\mathrm{mol}^{-1}$。对于数值报告，将 $\\lambda_D$ 以 $\\mathrm{nm}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题经验证是自洽的、有科学依据且定义明确的。所有必要的数据、方程和常数均已提供。各项任务逻辑结构清晰，可根据物理化学和静电学的既定原理解答。我们将开始解题。\n\n问题要求一个包含四部分的解答，涉及推导 Debye 长度、计算特定盐水的该长度值，以及评估电中性假设的有效性。\n\n**第 1 部分：线性化 Poisson–Boltzmann 方程和 Debye 长度的推导**\n\n我们从离子物种 $i$ 的通量 $\\mathbf{J}_i$ 的 Nernst–Planck 方程开始：\n$$\n\\mathbf{J}_i = -D_i \\nabla c_i - \\frac{z_i D_i F}{R T} c_i \\nabla \\phi\n$$\n在此， $D_i$ 是扩散系数，$c_i$ 是摩尔浓度，$z_i$ 是电荷数，$F$ 是法拉第常数，$R$ 是通用气体常数，$T$ 是绝对温度，$\\phi$ 是静电势。\n\n在平衡状态下，没有净通量，因此对于所有物种 $i$，$\\mathbf{J}_i = \\mathbf{0}$。Nernst–Planck 方程简化为：\n$$\n-D_i \\nabla c_i - \\frac{z_i D_i F}{R T} c_i \\nabla \\phi = \\mathbf{0}\n$$\n假设扩散系数 $D_i$ 非零，我们可以除以 $-D_i$：\n$$\n\\nabla c_i + \\frac{z_i F}{R T} c_i \\nabla \\phi = \\mathbf{0}\n$$\n重新整理此方程得到：\n$$\n\\frac{\\nabla c_i}{c_i} = -\\frac{z_i F}{R T} \\nabla \\phi\n$$\n认识到左侧是 $c_i$ 的自然对数的梯度，即 $\\nabla(\\ln c_i)$。将此表达式从整体溶液中的参考状态（其中电势 $\\phi$ 定义为 $0$，浓度为 $c_{i,\\infty}$）积分到电势为 $\\phi$、浓度为 $c_i$ 的某一点，即可得到离子浓度的 Boltzmann 分布：\n$$\n\\int_{c_{i,\\infty}}^{c_i} d(\\ln c'_i) = -\\int_0^\\phi \\frac{z_i F}{R T} d\\phi' \\implies \\ln\\left(\\frac{c_i}{c_{i,\\infty}}\\right) = -\\frac{z_i F \\phi}{R T}\n$$\n$$\nc_i(\\mathbf{r}) = c_{i,\\infty} \\exp\\left(-\\frac{z_i F \\phi(\\mathbf{r})}{R T}\\right)\n$$\n问题指出，电势变化足够小，可以进行线性化处理。这意味着指数函数的自变量很小，即 $|\\frac{z_i F \\phi}{R T}| \\ll 1$。因此，我们可以使用一阶泰勒级数展开 $\\exp(x) \\approx 1 + x$：\n$$\nc_i \\approx c_{i,\\infty} \\left(1 - \\frac{z_i F \\phi}{R T}\\right)\n$$\n现在我们将这个线性化的浓度代入体积电荷密度的表达式 $\\rho = F \\sum_i z_i c_i$：\n$$\n\\rho \\approx F \\sum_i z_i \\left[ c_{i,\\infty} \\left(1 - \\frac{z_i F \\phi}{R T}\\right) \\right] = F \\sum_i z_i c_{i,\\infty} - F \\sum_i \\frac{z_i^2 F c_{i,\\infty} \\phi}{R T}\n$$\n第一项 $F \\sum_i z_i c_{i,\\infty}$ 表示整体溶液中的净电荷密度，根据电中性原理，该值必须为零。因此，$\\sum_i z_i c_{i,\\infty} = 0$。$\\rho$ 的表达式简化为：\n$$\n\\rho \\approx - \\left(\\frac{F^2}{R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi\n$$\n接下来，我们使用均质介质（介电常数均匀为 $\\epsilon$）的 Poisson 方程，即 $\\nabla^2\\phi = -\\rho/\\epsilon$：\n$$\n\\nabla^2\\phi = -\\frac{1}{\\epsilon} \\left[ - \\left(\\frac{F^2}{R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi \\right] = \\left(\\frac{F^2}{\\epsilon R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi\n$$\n这就是线性化的 Poisson–Boltzmann 方程。它可以写成 $\\nabla^2\\phi = \\kappa^2\\phi$ 的形式，其中 $\\kappa$ 是 Debye 长度的倒数，即 $\\kappa = \\lambda_D^{-1}$。通过比较，我们发现：\n$$\n\\frac{1}{\\lambda_D^2} = \\frac{F^2}{\\epsilon R T} \\sum_i z_i^2 c_{i,\\infty}\n$$\n离子强度 $I$ 定义为 $I = \\frac{1}{2}\\sum_i z_i^2 c_i$。在整体溶液中，即为 $I = \\frac{1}{2}\\sum_i z_i^2 c_{i,\\infty}$，这意味着 $\\sum_i z_i^2 c_{i,\\infty} = 2I$。将此代入我们关于 $\\lambda_D^{-2}$ 的表达式中：\n$$\n\\frac{1}{\\lambda_D^2} = \\frac{F^2}{\\epsilon R T} (2I) = \\frac{2 F^2 I}{\\epsilon R T}\n$$\n求解 Debye 筛选长度 $\\lambda_D$，我们得到所需的表达式：\n$$\n\\lambda_D = \\sqrt{\\frac{\\epsilon R T}{2 F^2 I}}\n$$\n\n**第 2 部分：离子强度的计算**\n\n盐水包含氯化钠 ($\\mathrm{NaCl}$) 和氯化钙 ($\\mathrm{CaCl}_2$)。存在的离子有 $\\mathrm{Na}^+$、$\\mathrm{Ca}^{2+}$ 和 $\\mathrm{Cl}^-$。\n电荷数分别为 $z_{\\mathrm{Na}^+} = +1$、$z_{\\mathrm{Ca}^{2+}} = +2$ 和 $z_{\\mathrm{Cl}^-} = -1$。\n整体浓度以 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ 为单位给出：\n- $c_{\\mathrm{NaCl}, \\infty} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} \\implies c_{\\mathrm{Na}^+, \\infty} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$\n- $c_{\\mathrm{CaCl}_2, \\infty} = 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} \\implies c_{\\mathrm{Ca}^{2+}, \\infty} = 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$\n总氯离子浓度是两种盐的总和：\n$c_{\\mathrm{Cl}^-, \\infty} = c_{\\mathrm{Cl}^- \\text{ from NaCl}} + c_{\\mathrm{Cl}^- \\text{ from CaCl}_2} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} + 2 \\times 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} = 0.90 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$。\n\n离子强度 $I$ 的公式要求浓度单位为国际单位制 (SI) 中的 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。换算关系为 $1 \\, \\mathrm{L} = 10^{-3} \\, \\mathrm{m}^3$，因此 $1 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- $c_{\\mathrm{Na}^+, \\infty} = 0.70 \\times 1000 = 700 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $c_{\\mathrm{Ca}^{2+}, \\infty} = 0.10 \\times 1000 = 100 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $c_{\\mathrm{Cl}^-, \\infty} = 0.90 \\times 1000 = 900 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n\n现在我们可以计算离子强度 $I$：\n$$\nI = \\frac{1}{2} \\sum_i z_i^2 c_{i,\\infty} = \\frac{1}{2} \\left(z_{\\mathrm{Na}^+}^2 c_{\\mathrm{Na}^+, \\infty} + z_{\\mathrm{Ca}^{2+}}^2 c_{\\mathrm{Ca}^{2+}, \\infty} + z_{\\mathrm{Cl}^-}^2 c_{\\mathrm{Cl}^-, \\infty}\\right)\n$$\n$$\nI = \\frac{1}{2} \\left[ (1)^2(700) + (2)^2(100) + (-1)^2(900) \\right] \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n$$\nI = \\frac{1}{2} (700 + 400 + 900) \\, \\mathrm{mol}\\,\\mathrm{m}^{-3} = \\frac{1}{2} (2000) \\, \\mathrm{mol}\\,\\mathrm{m}^{-3} = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n\n**第 3 部分：Debye 筛选长度的计算**\n\n我们使用推导出的 $\\lambda_D$ 公式以及给定的国际单位制数值：\n- $\\epsilon = 5.93 \\times 10^{-10} \\, \\mathrm{F}\\,\\mathrm{m}^{-1}$\n- $R = 8.314 \\, \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $T = 333 \\, \\mathrm{K}$\n- $F = 96485 \\, \\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- $I = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n\n$$\n\\lambda_D = \\sqrt{\\frac{\\epsilon R T}{2 F^2 I}} = \\sqrt{\\frac{(5.93 \\times 10^{-10} \\, \\mathrm{F}\\,\\mathrm{m}^{-1}) (8.314 \\, \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) (333 \\, \\mathrm{K})}{2 (96485 \\, \\mathrm{C}\\,\\mathrm{mol}^{-1})^2 (1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3})}}\n$$\n$$\n\\lambda_D = \\sqrt{\\frac{1.64257146 \\times 10^{-6}}{1.861864505 \\times 10^{13}}} \\, \\mathrm{m} = \\sqrt{8.82218 \\times 10^{-20}} \\, \\mathrm{m} \\approx 2.970215 \\times 10^{-10} \\, \\mathrm{m}\n$$\n结果需要以纳米 ($\\mathrm{nm}$) 表示，其中 $1 \\, \\mathrm{nm} = 10^{-9} \\, \\mathrm{m}$：\n$$\n\\lambda_D = (2.970215 \\times 10^{-10} \\, \\mathrm{m}) \\times \\left(\\frac{1 \\, \\mathrm{nm}}{10^{-9} \\, \\mathrm{m}}\\right) = 0.2970215 \\, \\mathrm{nm}\n$$\n四舍五入到四位有效数字，我们得到 $\\lambda_D = 0.2970 \\, \\mathrm{nm}$。\n\n**第 4 部分：电中性近似的评估**\n\n电中性近似的有效性通过将 Debye 长度 $\\lambda_D$ 与系统的特征长度 $L$ 进行比较来评估。如果显著的电荷分离仅发生在远小于系统尺寸的边界层中，即 $\\lambda_D \\ll L$，则该近似有效。\n问题通过指示符 $\\chi$ 提供了一个定量标准：如果 $\\lambda_D/L \\le 10^{-2}$，则 $\\chi=1$，否则 $\\chi=0$。\n\n我们有：\n- $\\lambda_D = 2.970 \\times 10^{-10} \\, \\mathrm{m}$\n- $L = 100 \\, \\mu\\mathrm{m} = 100 \\times 10^{-6} \\, \\mathrm{m} = 1 \\times 10^{-4} \\, \\mathrm{m}$\n\n该比值为：\n$$\n\\frac{\\lambda_D}{L} = \\frac{2.970 \\times 10^{-10} \\, \\mathrm{m}}{1 \\times 10^{-4} \\, \\mathrm{m}} = 2.970 \\times 10^{-6}\n$$\n我们将此比值与阈值 $10^{-2}$ 进行比较：\n$$\n2.970 \\times 10^{-6} \\le 10^{-2}\n$$\n这个不等式显然成立。因此，满足 $\\chi=1$ 的条件。\n对于此系统，电中性近似是高度有效的，因为电荷不平衡的长度尺度 ($\\approx 0.3 \\, \\mathrm{nm}$) 比系统厚度 ($100,000 \\, \\mathrm{nm}$) 小几个数量级。\n\n最终结果是数值对 $(\\lambda_D \\text{ (单位为nm)}, \\chi)$。\n- $\\lambda_D = 0.2970$\n- $\\chi = 1$\n报告的数值对是 $(0.2970, 1)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2970  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在电中性概念的基础上，本练习深入探讨了其在简单二元盐体系中的影响。由于阳离子和阴离子的扩散速率不同，体系内部会产生一个电场以维持电荷中性，从而耦合了它们的通量。本练习将引导学生推导双极扩散系数，这是一个描述盐作为一个整体进行扩散的有效系数。",
            "id": "4091521",
            "problem": "一个地球化学孔隙水柱含有一种稀二元电解质，其阳离子价态为 $z_{+} = +2$，阴离子价态为 $z_{-} = -1$，代表一种 2:1 型电解质（例如，氯化钙）。考虑在没有流体平流和外部电场驱动情况下的理想一维等温扩散。假设理想溶液行为（活度系数等于1）、局部电中性，并且扩散电迁移由 Nernst–Planck 通量定律和离子迁移率与扩散系数之间的 Einstein 关系式描述。在水中，阳离子的分子扩散系数（国际单位制 (SI)）为 $D_{+} = 7.9 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$，阴离子的分子扩散系数为 $D_{-} = 2.03 \\times 10^{-9}\\ \\mathrm{m^{2}\\,s^{-1}}$。盐的化学计量系数为 $\\nu_{+} = 1$ 和 $\\nu_{-} = 2$，盐的电中性条件意味着 $z_{+}\\nu_{+} + z_{-}\\nu_{-} = 0$。\n\n严格地从适用于此情景的基本输运平衡（每个离子的 Nernst–Planck 通量定律、迁移率和扩散率之间的 Einstein 关系式、局部电中性以及零电流条件）出发，推导 2:1 型电解质的有效双极（盐）扩散系数 $D_{\\mathrm{amb}}$，用 $D_{+}$, $D_{-}$, $z_{+}$, $z_{-}$, $\\nu_{+}$, 和 $\\nu_{-}$ 表示。然后，使用相同的推导框架，求出具有相同 $D_{+}$ 和 $D_{-}$ 的 1:1 型电解质（即 $z_{+} = +1$, $z_{-} = -1$, $\\nu_{+} = \\nu_{-} = 1$）的双极扩散系数。\n\n报告无量纲比值\n$$R = \\frac{D_{\\mathrm{amb}}^{(2{:}1)}}{D_{\\mathrm{amb}}^{(1{:}1)}}$$\n作为最终结果。\n将您报告的 $R$ 值四舍五入至四位有效数字。将最终答案表示为一个无量纲数。",
            "solution": "该问题是有效的。这是一个基于已确立科学原理的、在计算地球化学和物理化学领域中的适定问题。所有必要信息都已提供，且条件内部一致。我们将开始推导。\n\n在无平流情况下，控制二元电解质一维等温扩散的基本原理是：每个离子的 Nernst-Planck 通量定律、净电流为零的条件以及局部电中性约束。\n\n离子种类 $i$ 的通量 $J_i$ 的 Nernst-Planck 方程为：\n$$J_i = -D_i \\frac{dC_i}{dx} - \\frac{z_i F}{RT} D_i C_i \\frac{d\\phi}{dx}$$\n其中 $D_i$ 是分子扩散系数，$C_i$ 是摩尔浓度，$z_i$ 是价态，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度，$\\phi$ 是电势。$\\frac{d\\phi}{dx}$ 项表示由阳离子和阴离子的扩散速率差异产生的内电场。\n\n对于二元电解质，我们有两个通量方程，一个用于阳离子 ($+$)，一个用于阴离子 ($-$)：\n$$J_{+} = -D_{+} \\frac{dC_{+}}{dx} - \\frac{z_{+} F}{RT} D_{+} C_{+} \\frac{d\\phi}{dx}$$\n$$J_{-} = -D_{-} \\frac{dC_{-}}{dx} - \\frac{z_{-} F}{RT} D_{-} C_{-} \\frac{d\\phi}{dx}$$\n\n在没有外部电路的情况下，净电流必须为零：\n$$I = F \\sum_{i} z_i J_i = F(z_{+}J_{+} + z_{-}J_{-}) = 0$$\n这可以简化为 $z_{+}J_{+} + z_{-}J_{-} = 0$。\n\n每个离子浓度 $C_+$ 和 $C_-$ 通过化学计量系数 $\\nu_+$ 和 $\\nu_-$ 与盐的摩尔浓度 $C$ 相关：\n$$C_{+} = \\nu_{+} C \\quad \\text{和} \\quad C_{-} = \\nu_{-} C$$\n因此，空间梯度之间的关系为：\n$$\\frac{dC_{+}}{dx} = \\nu_{+} \\frac{dC}{dx} \\quad \\text{和} \\quad \\frac{dC_{-}}{dx} = \\nu_{-} \\frac{dC}{dx}$$\n体溶液的局部电中性表示为 $\\sum_i z_i C_i = 0$，即 $z_{+}C_{+} + z_{-}C_{-} = 0$。使用盐浓度，这变为 $C(z_{+}\\nu_{+} + z_{-}\\nu_{-}) = 0$。由于 $C \\neq 0$，我们得到盐本身的电中性条件：$z_{+}\\nu_{+} + z_{-}\\nu_{-} = 0$。\n\n现在我们可以将 Nernst-Planck 通量方程代入零电流条件：\n$$z_{+}\\left(-D_{+} \\frac{dC_{+}}{dx} - \\frac{z_{+} F}{RT} D_{+} C_{+} \\frac{d\\phi}{dx}\\right) + z_{-}\\left(-D_{-} \\frac{dC_{-}}{dx} - \\frac{z_{-} F}{RT} D_{-} C_{-} \\frac{d\\phi}{dx}\\right) = 0$$\n使用浓度梯度和离子浓度与盐浓度 $C$ 的关系：\n$$-z_{+}D_{+}\\nu_{+}\\frac{dC}{dx} - \\frac{z_{+}^2 F}{RT} D_{+}\\nu_{+}C\\frac{d\\phi}{dx} - z_{-}D_{-}\\nu_{-}\\frac{dC}{dx} - \\frac{z_{-}^2 F}{RT} D_{-}\\nu_{-}C\\frac{d\\phi}{dx} = 0$$\n我们可以重排这个方程来求解感生电场梯度 $\\frac{d\\phi}{dx}$：\n$$-\\left(z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}\\right)\\frac{dC}{dx} = \\frac{F C}{RT}\\left(z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}\\right)\\frac{d\\phi}{dx}$$\n$$\\frac{d\\phi}{dx} = -\\frac{RT}{F C} \\frac{z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}} \\frac{dC}{dx}$$\n\n盐通量 $J_{\\text{salt}}$ 与单个离子通量通过 $J_{+} = \\nu_{+} J_{\\text{salt}}$ 和 $J_{-} = \\nu_{-} J_{\\text{salt}}$ 相关。盐的整体输运遵循 Fick 第一定律，其有效双极扩散系数为 $D_{\\mathrm{amb}}$：\n$$J_{\\text{salt}} = -D_{\\mathrm{amb}} \\frac{dC}{dx}$$\n我们可以通过将 $\\frac{d\\phi}{dx}$ 的表达式代回其中一种离子（例如阳离子）的通量方程来确定 $D_{\\mathrm{amb}}$：\n$$J_{+} = \\nu_{+} J_{\\text{salt}} = -\\nu_{+}D_{\\mathrm{amb}}\\frac{dC}{dx}$$\n$J_+$ 的 Nernst-Planck 方程为：\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} - \\frac{z_{+} F}{RT} D_{+}\\nu_{+}C \\left(-\\frac{RT}{F C} \\frac{z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}} \\frac{dC}{dx}\\right)$$\n化简得：\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} + z_{+} D_{+}\\nu_{+} \\left(\\frac{z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}}\\right) \\frac{dC}{dx}$$\n$$J_{+} = -\\frac{dC}{dx} \\left[D_{+}\\nu_{+} - \\frac{z_{+} D_{+}\\nu_{+}(z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-})}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}}\\right]$$\n$$J_{+} = -\\frac{dC}{dx} \\left[\\frac{D_{+}\\nu_{+}(z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}) - z_{+} D_{+}\\nu_{+}(z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-})}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}}\\right]$$\n展开分子中的第二项：\n$$J_{+} = -\\frac{dC}{dx} \\left(D_{+}\\nu_{+} \\frac{(z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}) - (z_{+}^2 D_{+}\\nu_{+} + z_{+}z_{-}D_{-}\\nu_{-})}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}}\\right)$$\n$$J_{+} = -\\frac{dC}{dx} \\left(D_{+}\\nu_{+} \\frac{z_{-}^2 D_{-}\\nu_{-} - z_{+}z_{-}D_{-}\\nu_{-}}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}}\\right) = -\\frac{dC}{dx} \\left(\\frac{D_{+}\\nu_{+}D_{-}\\nu_{-}z_{-}(z_{-} - z_{+})}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}}\\right)$$\n从 $J_{\\text{salt}} = J_{+}/\\nu_{+} = -D_{\\mathrm{amb}} \\frac{dC}{dx}$，我们得到：\n$$D_{\\mathrm{amb}} = \\frac{D_{+}D_{-} \\nu_{-}z_{-}(z_{+} - z_{-})}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}}$$\n使用电中性关系 $z_{+}\\nu_{+} = -z_{-}\\nu_{-}$，我们有 $\\nu_{-}/\\nu_{+} = -z_{+}/z_{-}$。\n分子：$D_{+}D_{-} \\nu_{-}z_{-}(z_{+} - z_{-}) = D_{+}D_{-} \\nu_{+}(-\\frac{z_{+}}{z_{-}})z_{-}(z_{+} - z_{-}) = -z_{+}\\nu_{+}D_{+}D_{-}(z_{+} - z_{-})$。\n分母：$z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-} = z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-} \\nu_{+}(-\\frac{z_{+}}{z_{-}}) = z_{+}\\nu_{+}(z_{+}D_{+} - z_{-}D_{-})$。\n$$D_{\\mathrm{amb}} = \\frac{-z_{+}\\nu_{+}D_{+}D_{-}(z_{+} - z_{-})}{z_{+}\\nu_{+}(z_{+}D_{+} - z_{-}D_{-})} = \\frac{-D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}} = \\frac{D_{+}D_{-}(z_{+} - z_{-})}{z_{-}D_{-} - z_{+}D_{+}}$$\n这个表达式正确地表明 $D_{\\mathrm{amb}}$ 取决于 $D_{+}$, $D_{-}$, $z_{+}$, 和 $z_{-}$。化学计量系数 $\\nu_{+}$ 和 $\\nu_{-}$ 没有在最终形式中显式出现，因为它们的影响已通过电中性条件被包含在内。\n(Note: An equivalent and more common form is $\\frac{D_{+}D_{-}(|z_{+}| + |z_{-}|)}{|z_{-}|D_{+} + |z_{+}|D_{-}}$ for $z_+ > 0, z_-  0$. Let's re-derive my version from a simpler starting point in the scratchpad. $J_{+} = -\\frac{dC}{dx} \\left(\\frac{\\nu_{+}D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right)$. Using $J_{salt} = J_+/\\nu_+$, we get $J_{salt} = -\\frac{dC}{dx} \\left(\\frac{D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right)$. So $D_{amb} = \\frac{D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}$. My initial derivation was correct, the second was a typo. Let me use this one.)\n\n现在，我们将这个通用公式应用于两种情况。\n\n情况1：2:1 型电解质\n给定：$z_{+} = +2$, $z_{-} = -1$。\n$$D_{\\mathrm{amb}}^{(2{:}1)} = \\frac{D_{+}D_{-}((2) - (-1))}{(2)D_{+} - (-1)D_{-}} = \\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}}$$\n\n情况2：1:1 型电解质\n给定：$z_{+} = +1$, $z_{-} = -1$。\n$$D_{\\mathrm{amb}}^{(1{:}1)} = \\frac{D_{+}D_{-}((1) - (-1))}{(1)D_{+} - (-1)D_{-}} = \\frac{2 D_{+}D_{-}}{D_{+} + D_{-}}$$\n\n问题要求的是无量纲比值 $R$：\n$$R = \\frac{D_{\\mathrm{amb}}^{(2{:}1)}}{D_{\\mathrm{amb}}^{(1{:}1)}} = \\frac{\\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}}}{\\frac{2 D_{+}D_{-}}{D_{+} + D_{-}}}$$\n$$R = \\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}} \\cdot \\frac{D_{+} + D_{-}}{2 D_{+}D_{-}} = \\frac{3(D_{+} + D_{-})}{2(2 D_{+} + D_{-})}$$\n\n现在，我们代入给定的扩散系数值：\n$D_{+} = 7.9 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$\n$D_{-} = 2.03 \\times 10^{-9}\\ \\mathrm{m^{2}\\,s^{-1}}$\n单位是一致的，将在比值计算中抵消。\n$$R = \\frac{3(7.9 \\times 10^{-10} + 2.03 \\times 10^{-9})}{2(2(7.9 \\times 10^{-10}) + 2.03 \\times 10^{-9})}$$\n为了简化计算，我们将 $D_{-}$ 写成 $20.3 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$。\n$$R = \\frac{3(7.9 \\times 10^{-10} + 20.3 \\times 10^{-10})}{2(2(7.9 \\times 10^{-10}) + 20.3 \\times 10^{-10})}$$\n因子 $10^{-10}$ 会被消掉：\n$$R = \\frac{3(7.9 + 20.3)}{2(2 \\times 7.9 + 20.3)} = \\frac{3(28.2)}{2(15.8 + 20.3)} = \\frac{84.6}{2(36.1)} = \\frac{84.6}{72.2}$$\n$$R \\approx 1.17174515235...$$\n按要求四舍五入到四位有效数字：\n$$R \\approx 1.172$$",
            "answer": "$$\\boxed{1.172}$$"
        },
        {
            "introduction": "最后的这项练习连接了理论与应用，要求学生为一个复杂的地球化学系统实现一个计算模型。通过计算总碱度通量——一个水文地球化学中的关键参数——学生将把能斯特-普朗克方程应用于多个相互作用的物种。此练习强调了在输运框架内实现化学平衡和电荷平衡的实际挑战。",
            "id": "4091565",
            "problem": "你的任务是实现一个完整的程序，用于在计算地球化学领域中，为一组预定义的测试用例计算一维孔隙水柱中总碱度的扩散-迁移通量。你的实现必须从基本原理出发，明确地强制执行电荷平衡和水平衡，并使用离子迁移的标准公式。下面指定的物理和数值必须完全按照所提供的值使用。\n\n物理情景考虑一个长度为 $L$ 的一维域，在左右边界之间存在外部施加的均匀电场 $E$ (单位为国际单位制 (SI) 的伏特/米) 和多种离子物种的浓度梯度。你必须将迁移视为纯粹的扩散和电迁移 (无平流)。目标量是总碱度通量，其在操作上定义为各物种通量的线性泛函。\n\n基本和核心定义：\n- 物种 $i$ 的质量守恒定律确立了一维通量 $J_i$ 取决于梯度和驱动力。\n- Fick 第一定律给出了扩散贡献 $-D_i \\,\\partial C_i/\\partial x$，其中 $D_i$ 是有效扩散系数，$C_i$ 是浓度。\n- 电迁移贡献源于电场中电荷的运动。对于电荷数为 $z_i$ 的离子 $i$，Nernst-Einstein 关系式将迁移率与扩散联系起来，使得迁移通量可以用法拉第常数 $F$、气体常数 $R$ 和温度 $T$ 来表示。\n- 综合以上各项，物种 $i$ 的一维通量的 Nernst-Planck 方程 (NPE) 表示为：\n$$\nJ_i \\;=\\; -\\,D_i \\,\\frac{\\partial C_i}{\\partial x} \\;+\\; z_i \\, D_i \\,\\frac{F}{R\\,T}\\, C_i \\, E,\n$$\n其中 $E$ 是电场（在 $+x$ 方向为正）。对于长度为 $L$ 的有限区间上的数值计算，使用有限差分近似 $\\partial C_i/\\partial x$，并使用左右边界值的算术平均值近似 $C_i$。\n\n电荷与水平衡的强制执行：\n- 在每个边界处，强制执行水的自电离平衡：$[\\text{H}^+][\\text{OH}^-] = K_w$，其中 $K_w$ 以 SI 单位指定。\n- 在每个边界处强制执行电中性：$\\sum_i z_i \\, C_i = 0$，其中总和包括所有存在的离子物种。为在保持非水物种浓度固定的同时强制执行水平衡和电中性，需将 $[\\text{OH}^-] = K_w/[\\text{H}^+]$ 代入电中性方程，然后求解所得二次方程中 $[\\text{H}^+]$ 的正根：\n$$\n[\\text{H}^+]^2 + S [\\text{H}^+] - K_w = 0,\n$$\n其中 $S$ 为不包括 $[\\text{H}^+]$ 和 $[\\text{OH}^-]$ 的固定电荷总和，由 $S = \\sum_{i \\neq \\text{H}^+,\\text{OH}^-} z_i C_i$ 给出。然后设置 $[\\text{OH}^-] = K_w/[\\text{H}^+]$。\n\n总碱度和目标通量的定义：\n- 考虑物种集合 $\\{\\text{H}^+, \\text{OH}^-, \\text{Na}^+, \\text{Cl}^-, \\text{HCO}_3^-, \\text{CO}_3^{2-}\\}$，其电荷数 $z_i$ 如下文指定。\n- 此处，总碱度 $A_T$ 定义为以下线性组合：\n$$\nA_T = [\\text{HCO}_3^-] + 2[\\text{CO}_3^{2-}] + [\\text{OH}^-] - [\\text{H}^+],\n$$\n总碱度通量为\n$$\nJ_{A_T} = J_{\\text{HCO}_3^-} + 2J_{\\text{CO}_3^{2-}} + J_{\\text{OH}^-} - J_{\\text{H}^+}.\n$$\n所有通量必须以 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ 为单位表示。\n\n常量和参数 (请精确使用以下数值)：\n- 气体常数 $R = 8.314462618\\;\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。\n- 法拉第常数 $F = 96485.33212\\;\\text{C}\\,\\text{mol}^{-1}$。\n- 温度 $T = 298.15\\;\\text{K}$。\n- 水柱长度 $L = 0.01\\;\\text{m}$。\n- 水的自电离常数 (SI 单位) $K_w = 1.0\\times 10^{-8}\\;\\text{mol}^2\\,\\text{m}^{-6}$。\n\n物种属性 (请精确使用以下数值)：\n- $H^+$: $z_{H^+} = +1$, $D_{H^+} = 9.31\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $OH^-$: $z_{OH^-} = -1$, $D_{OH^-} = 5.27\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $Na^+$: $z_{Na^+} = +1$, $D_{Na^+} = 1.33\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $Cl^-$: $z_{Cl^-} = -1$, $D_{Cl^-} = 2.03\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $HCO_3^-$: $z_{HCO_3^-} = -1$, $D_{HCO_3^-} = 1.18\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n- $CO_3^{2-}$: $z_{CO_3^{2-}} = -2$, $D_{CO_3^{2-}} = 9.2\\times 10^{-10}\\;\\text{m}^2\\,\\text{s}^{-1}$。\n\n浓度和场的单位：\n- 所有边界浓度必须以 $\\text{mol}\\,\\text{m}^{-3}$ 为单位处理。\n- 电场值 $E$ 的单位为 $\\text{V}\\,\\text{m}^{-1}$。\n\n数值近似规则：\n- 对迁移项使用算术平均浓度 $C_i^{\\text{avg}} = \\left(C_i^{\\text{left}} + C_i^{\\text{right}}\\right)/2$。\n- 对扩散项使用有限差分 $\\partial C_i/\\partial x \\approx \\left(C_i^{\\text{right}} - C_i^{\\text{left}}\\right)/L$。\n\n测试套件和输入：\n对于下方的每个测试用例，都指定了左右边界的浓度。初始的 $[\\text{H}^+]$ 和 $[\\text{OH}^-]$ 值可能不满足电中性；你的程序必须在计算通量之前，在两个边界上强制执行电中性和水平衡。所有浓度单位均为 $\\text{mol}\\,\\text{m}^{-3}$。\n\n- 测试用例 1 (中等碱度梯度，非零电场)：\n    - 电场 $E = 50$。\n    - 左边界: $[Na^+] = 2.90099$, $[Cl^-] = 0.5$, $[HCO_3^-] = 2.0$, $[CO_3^{2-}] = 0.2$, 初始 $[H^+] = 1.0\\times 10^{-5}$, 初始 $[OH^-] = 1.0\\times 10^{-3}$。\n    - 右边界: $[Na^+] = 2.6$, $[Cl^-] = 0.5$, $[HCO_3^-] = 1.8$, $[CO_3^{2-}] = 0.15$, 初始 $[H^+] = 1.2589\\times 10^{-5}$, 初始 $[OH^-] = 7.9433\\times 10^{-4}$。\n\n- 测试用例 2 (纯扩散，反向梯度)：\n    - 电场 $E = 0$。\n    - 左边界: $[Na^+] = 2.6$, $[Cl^-] = 0.5$, $[HCO_3^-] = 1.8$, $[CO_3^{2-}] = 0.15$, 初始 $[H^+] = 1.2589\\times 10^{-5}$, 初始 $[OH^-] = 7.9433\\times 10^{-4}$。\n    - 右边界: $[Na^+] = 2.90099$, $[Cl^-] = 0.5$, $[HCO_3^-] = 2.0$, $[CO_3^{2-}] = 0.2$, 初始 $[H^+] = 1.0\\times 10^{-5}$, 初始 $[OH^-] = 1.0\\times 10^{-3}$。\n\n- 测试用例 3 (均匀组分，仅迁移输运)：\n    - 电场 $E = -100$。\n    - 左边界: $[Na^+] = 0.6$, $[Cl^-] = 0.6$, $[HCO_3^-] = 0.1$, $[CO_3^{2-}] = 0.01$, 初始 $[H^+] = 1.0\\times 10^{-5}$, 初始 $[OH^-] = 1.0\\times 10^{-3}$。\n    - 右边界: $[Na^+] = 0.6$, $[Cl^-] = 0.6$, $[HCO_3^-] = 0.1$, $[CO_3^{2-}] = 0.01$, 初始 $[H^+] = 1.0\\times 10^{-5}$, 初始 $[OH^-] = 1.0\\times 10^{-3}$。\n\n- 测试用例 4 (低碳酸盐，强电场，相反的 NaCl 梯度)：\n    - 电场 $E = 200$。\n    - 左边界: $[Na^+] = 0.2$, $[Cl^-] = 0.25$, $[HCO_3^-] = 0.02$, $[CO_3^{2-}] = 0.002$, 初始 $[H^+] = 1.0\\times 10^{-4}$, 初始 $[OH^-] = 1.0\\times 10^{-4}$。\n    - 右边界: $[Na^+] = 0.25$, $[Cl^-] = 0.2$, $[HCO_3^-] = 0.02$, $[CO_3^{2-}] = 0.0015$, 初始 $[H^+] = 1.0\\times 10^{-4}$, 初始 $[OH^-] = 1.0\\times 10^{-4}$。\n\n程序要求：\n- 按照描述实现每个边界上的电中性和水平衡的强制执行，保持非水物种浓度固定。\n- 使用 Nernst-Planck 方程以及有限差分和算术平均近似法计算每个物种的通量 $J_i$。\n- 按照指定的物种通量线性组合，为每个测试用例计算总碱度通量 $J_{A_T}$。\n- 将每个 $J_{A_T}$ 以 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ 为单位表示为浮点数。\n\n最终输出格式：\n你的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_k$ 是测试用例 $k$ 计算出的 $J_{A_T}$，单位为 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。",
            "solution": "该问题要求计算在浓度梯度和外部施加电场的影响下，穿过一维孔隙水柱的总碱度通量。该解决方案需要一个基于离子迁移、化学平衡和电荷平衡原理的多步骤程序。这个问题是适定的、科学上合理的，并为获得唯一解提供了所有必要信息。\n\n控制每个离子物种 $i$ 迁移的基本方程是 Nernst-Planck 方程 (NPE)，该方程将总通量 $J_i$ 描述为由浓度梯度驱动的扩散分量和由电场驱动的迁移分量之和：\n$$\nJ_i \\;=\\; -\\,D_i \\,\\frac{\\partial C_i}{\\partial x} \\;+\\; z_i \\, D_i \\,\\frac{F}{R\\,T}\\, C_i \\, E\n$$\n此处，$D_i$ 是有效扩散系数，$C_i$ 是浓度，$z_i$ 是电荷数，$x$ 是空间坐标，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度，$E$ 是均匀电场的强度。\n\n计算过程分为三个主要阶段：\n$1$. 强制执行边界条件，\n$2$. 计算单个物种通量，\n$3$. 计算总碱度通量。\n\n**$1$. 边界条件的强制执行**\n物种 $Na^+$、$Cl^-$、$HCO_3^-$ 和 $CO_3^{2-}$ 的边界浓度是已知的。然而，必须在每个边界（左边界，$x=0$，和右边界，$x=L$）重新计算 $H^+$ 和 $OH^-$ 的浓度，以同时满足两个基本约束：水的自电离平衡和电中性。\n\n水的自电离平衡由下式给出：\n$$\n[\\text{H}^+][\\text{OH}^-] \\;=\\; K_w\n$$\n其中 $K_w = 1.0\\times 10^{-8}\\;\\text{mol}^2\\,\\text{m}^{-6}$。\n\n电中性条件要求净电荷密度为零：\n$$\n\\sum_i z_i \\, C_i \\;=\\; 0\n$$\n总和涵盖所有六个物种：$\\{\\text{H}^+, \\text{OH}^-, \\text{Na}^+, \\text{Cl}^-, \\text{HCO}_3^-, \\text{CO}_3^{2-}\\}$。我们可以将 $\\text{H}^+$ 和 $\\text{OH}^-$ 的贡献分离出来：\n$$\n(z_{\\text{H}^+}\\,[\\text{H}^+] \\;+\\; z_{\\text{OH}^-}\\,[\\text{OH}^-]) \\;+\\; \\sum_{i \\neq \\text{H}^+,\\text{OH}^-} z_i \\, C_i \\;=\\; 0\n$$\n设 $S = \\sum_{i \\neq \\text{H}^+,\\text{OH}^-} z_i \\, C_i$ 为固定浓度物种的电荷总和。将 $z_{\\text{H}^+} = +1$，$z_{\\text{OH}^-} = -1$ 和 $[\\text{OH}^-] = K_w/[\\text{H}^+]$ 代入电中性方程，得到：\n$$\n[\\text{H}^+] \\;-\\; \\frac{K_w}{[\\text{H}^+]} \\;+\\; S \\;=\\; 0\n$$\n两边乘以 $[\\text{H}^+]$，得到关于 $[\\text{H}^+]$ 所需的二次方程：\n$$\n[\\text{H}^+]^2 \\;+\\; S \\,[\\text{H}^+] \\;-\\; K_w \\;=\\; 0\n$$\n使用二次公式求解该方程以得到 $[\\text{H}^+]$。由于浓度必须是正实数，我们取其正根：\n$$\n[\\text{H}^+] \\;=\\; \\frac{-S + \\sqrt{S^2 + 4K_w}}{2}\n$$\n一旦为给定边界找到校正后的 $[\\text{H}^+]$，就可以通过水平衡 $[\\text{OH}^-] = K_w/[\\text{H}^+]$ 确定相应的 $[\\text{OH}^-]$。对每个测试用例的左右边界浓度集独立应用此过程，从而为所有六个物种生成一套自洽的边界条件。\n\n**$2$. 单个物种通量的计算**\n对于每个物种 $i$，利用其已平衡的边界浓度 $C_i^{\\text{left}}$ 和 $C_i^{\\text{right}}$，使用 Nernst-Planck 方程的离散形式计算穿过长度为 $L$ 的域的通量 $J_i$。问题指定对浓度梯度使用一阶有限差分，对迁移项中的浓度使用算术平均值：\n$$\n\\frac{\\partial C_i}{\\partial x} \\approx \\frac{C_i^{\\text{right}} - C_i^{\\text{left}}}{L} \n\\quad \\text{和} \\quad\nC_i \\approx \\frac{C_i^{\\text{left}} + C_i^{\\text{right}}}{2}\n$$\n将这些近似值代入 NPE，得到计算每个物种通量的公式：\n$$\nJ_i \\;=\\; -D_i \\,\\left(\\frac{C_i^{\\text{right}} - C_i^{\\text{left}}}{L}\\right) \\;+\\; z_i \\, D_i \\,\\frac{F}{R\\,T}\\, \\left(\\frac{C_i^{\\text{left}} + C_i^{\\text{right}}}{2}\\right) \\, E\n$$\n使用所有六个物种的特定属性 ($D_i, z_i$) 和系统参数 ($L, T, E, F, R$) 进行此计算。\n\n**$3$. 总碱度通量的计算**\n总碱度 $A_T$ 是一个操作性量，由物种浓度的线性组合定义。问题将其定义为：\n$$\nA_T \\;=\\; [\\text{HCO}_3^-] \\;+\\; 2[\\text{CO}_3^{2-}] \\;+\\; [\\text{OH}^-] \\;-\\; [\\text{H}^+]\n$$\n相应地，总碱度通量 $J_{A_T}$ 定义为各个物种通量的相同线性组合：\n$$\nJ_{A_T} \\;=\\; J_{\\text{HCO}_3^-} \\;+\\; 2J_{\\text{CO}_3^{2-}} \\;+\\; J_{\\text{OH}^-} \\;-\\; J_{\\text{H}^+}\n$$\n在按上一步所述计算了相关物种的单个通量 $J_i$ 后，根据此公式将它们组合起来，以得出每个测试用例的最终目标量。所有计算均保持 SI 单位，最终得到的通量 $J_{A_T}$ 的单位为 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the diffusive-migrative flux of total alkalinity in a one-dimensional\n    porewater column for a set of predefined test cases.\n    \"\"\"\n\n    # --- Constants and Parameters ---\n    R = 8.314462618  # Gas constant (J/mol/K)\n    F = 96485.33212  # Faraday constant (C/mol)\n    T = 298.15        # Temperature (K)\n    L = 0.01          # Column length (m)\n    KW = 1.0e-8       # Water autoionization constant (mol^2/m^6)\n\n    # Pre-calculate the F/(RT) term for efficiency\n    F_RT = F / (R * T)\n\n    # --- Species Properties ---\n    # Structure: {name: {'z': charge_number, 'D': diffusion_coeff_m2_s-1}}\n    SPECIES_PROPS = {\n        'H+':       {'z':  1, 'D': 9.31e-9},\n        'OH-':      {'z': -1, 'D': 5.27e-9},\n        'Na+':      {'z':  1, 'D': 1.33e-9},\n        'Cl-':      {'z': -1, 'D': 2.03e-9},\n        'HCO3-':    {'z': -1, 'D': 1.18e-9},\n        'CO3--':    {'z': -2, 'D': 9.20e-10}\n    }\n    \n    # List of species excluding H+ and OH- for S calculation\n    FIXED_SPECIES = ['Na+', 'Cl-', 'HCO3-', 'CO3--']\n\n    def enforce_neutrality(concentrations):\n        \"\"\"\n        Adjusts H+ and OH- concentrations to enforce electroneutrality and\n        water equilibrium.\n\n        Args:\n            concentrations (dict): A dictionary of species concentrations {species_name: value}.\n\n        Returns:\n            dict: An updated dictionary with equilibrated H+ and OH- concentrations.\n        \"\"\"\n        # Calculate S, the fixed charge sum\n        S = sum(\n            SPECIES_PROPS[sp]['z'] * concentrations[sp] for sp in FIXED_SPECIES\n        )\n\n        # Solve the quadratic equation for [H+]: [H+]^2 + S*[H+] - Kw = 0\n        # Using the positive root of the quadratic formula: (-b + sqrt(b^2 - 4ac)) / 2a\n        c_h_plus = (-S + np.sqrt(S**2 + 4 * KW)) / 2.0\n\n        # Calculate [OH-] from water equilibrium\n        c_oh_minus = KW / c_h_plus\n\n        equilibrated_concs = concentrations.copy()\n        equilibrated_concs['H+'] = c_h_plus\n        equilibrated_concs['OH-'] = c_oh_minus\n        \n        return equilibrated_concs\n\n    def calculate_flux(species_name, c_left, c_right, E):\n        \"\"\"\n        Calculates the flux of a single species using the Nernst-Planck equation.\n\n        Args:\n            species_name (str): The name of the species.\n            c_left (float): Concentration at the left boundary (mol/m^3).\n            c_right (float): Concentration at the right boundary (mol/m^3).\n            E (float): Electric field (V/m).\n\n        Returns:\n            float: The calculated flux in mol/m^2/s.\n        \"\"\"\n        props = SPECIES_PROPS[species_name]\n        z = props['z']\n        D = props['D']\n\n        # Diffusive flux component\n        flux_diff = -D * (c_right - c_left) / L\n\n        # Migrative flux component\n        c_avg = (c_left + c_right) / 2.0\n        flux_mig = z * D * F_RT * c_avg * E\n\n        return flux_diff + flux_mig\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"E\": 50.0,\n            \"left\":  {'Na+': 2.90099, 'Cl-': 0.5, 'HCO3-': 2.0,   'CO3--': 0.2,   'H+': 1.0e-5, 'OH-': 1.0e-3},\n            \"right\": {'Na+': 2.6,     'Cl-': 0.5, 'HCO3-': 1.8,   'CO3--': 0.15,  'H+': 1.2589e-5, 'OH-': 7.9433e-4}\n        },\n        {\n            \"E\": 0.0,\n            \"left\":  {'Na+': 2.6,     'Cl-': 0.5, 'HCO3-': 1.8,   'CO3--': 0.15,  'H+': 1.2589e-5, 'OH-': 7.9433e-4},\n            \"right\": {'Na+': 2.90099, 'Cl-': 0.5, 'HCO3-': 2.0,   'CO3--': 0.2,   'H+': 1.0e-5, 'OH-': 1.0e-3}\n        },\n        {\n            \"E\": -100.0,\n            \"left\":  {'Na+': 0.6, 'Cl-': 0.6, 'HCO3-': 0.1, 'CO3--': 0.01, 'H+': 1.0e-5, 'OH-': 1.0e-3},\n            \"right\": {'Na+': 0.6, 'Cl-': 0.6, 'HCO3-': 0.1, 'CO3--': 0.01, 'H+': 1.0e-5, 'OH-': 1.0e-3}\n        },\n        {\n            \"E\": 200.0,\n            \"left\":  {'Na+': 0.2,  'Cl-': 0.25, 'HCO3-': 0.02, 'CO3--': 0.002,  'H+': 1.0e-4, 'OH-': 1.0e-4},\n            \"right\": {'Na+': 0.25, 'Cl-': 0.2,  'HCO3-': 0.02, 'CO3--': 0.0015, 'H+': 1.0e-4, 'OH-': 1.0e-4}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        E_field = case[\"E\"]\n\n        # Enforce electroneutrality at both boundaries\n        c_left_equilibrated = enforce_neutrality(case[\"left\"])\n        c_right_equilibrated = enforce_neutrality(case[\"right\"])\n\n        # Calculate individual species fluxes\n        fluxes = {}\n        for species in SPECIES_PROPS:\n            fluxes[species] = calculate_flux(\n                species,\n                c_left_equilibrated[species],\n                c_right_equilibrated[species],\n                E_field\n            )\n\n        # Calculate total alkalinity flux: J_AT = J(HCO3-) + 2*J(CO3--) + J(OH-) - J(H+)\n        j_at = (\n            fluxes['HCO3-'] + \n            2 * fluxes['CO3--'] + \n            fluxes['OH-'] - \n            fluxes['H+']\n        )\n        results.append(j_at)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}