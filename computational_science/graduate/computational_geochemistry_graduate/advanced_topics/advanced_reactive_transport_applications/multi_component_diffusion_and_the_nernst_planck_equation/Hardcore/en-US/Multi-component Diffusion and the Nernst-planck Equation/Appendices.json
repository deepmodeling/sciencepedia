{
    "hands_on_practices": [
        {
            "introduction": "The assumption of local electroneutrality is a cornerstone of many geochemical transport models, simplifying the governing equations significantly. This practice delves into the physical justification for this assumption by tasking you with deriving the Debye length, the characteristic scale of charge separation in an electrolyte. By starting from the fundamental Nernst-Planck and Poisson equations under equilibrium conditions, you will determine when the electroneutral approximation is valid for a given system .",
            "id": "4091554",
            "problem": "A one-dimensional (1D) geochemical diffusion cell of thickness $L$ contains an aqueous brine at uniform temperature $T$ and uniform permittivity $\\epsilon$. The brine is an ideal, fully dissociated mixture of sodium chloride $\\mathrm{NaCl}$ at bulk concentration $0.70$ $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ and calcium chloride $\\mathrm{CaCl}_2$ at bulk concentration $0.10$ $\\mathrm{mol}\\,\\mathrm{L}^{-1}$. The medium has $\\epsilon=5.93\\times 10^{-10}$ $\\mathrm{F}\\,\\mathrm{m}^{-1}$ and the temperature is $T=333$ $\\mathrm{K}$. The cell thickness is $L=100$ $\\mu\\mathrm{m}$. Assume the system is isothermal, homogeneous, and at equilibrium with no net fluxes, and that electrostatic potential variations are sufficiently small to justify linearization. Use the fundamental relations given below:\n\n- The Nernst–Planck (NP) equation for species $i$ with charge number $z_i$ and diffusion coefficient $D_i$ in an electrolyte under an electrostatic potential $\\phi$ is $\\mathbf{J}_i=-D_i\\nabla c_i-\\dfrac{z_i D_i F}{R T}c_i\\nabla\\phi$.\n- The Poisson equation for the electrostatic potential in a medium with permittivity $\\epsilon$ is $\\nabla\\cdot\\left(\\epsilon\\nabla\\phi\\right)=-\\rho$, where $\\rho=F\\sum_i z_i c_i$ is the volumetric charge density.\n- The ionic strength is $I=\\dfrac{1}{2}\\sum_i z_i^2 c_i$, using molar concentrations $c_i$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\nTasks:\n\n1. Starting from the NP equation and the Poisson equation, impose the equilibrium condition $\\mathbf{J}_i=\\mathbf{0}$ for all $i$ and linearize the resulting concentration–potential relationship about the bulk state. Derive the linearized Poisson–Boltzmann relation and obtain the Debye screening length $\\lambda_D$ expressed only in terms of $\\epsilon$, $R$, $T$, $F$, and the ionic strength $I$.\n2. Compute the ionic strength $I$ of the given brine from its composition. Use $c_i$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n3. Using your derived expression, compute the Debye screening length $\\lambda_D$ for the given conditions. Express $\\lambda_D$ in nanometers and round your answer to four significant figures.\n4. Quantitatively assess whether the electroneutral approximation is valid for the 1D cell by comparing $\\lambda_D$ and $L$. Define the indicator $\\chi$ by $\\chi=1$ if $\\lambda_D/L\\leq 10^{-2}$ and $\\chi=0$ otherwise. Report the pair $\\left(\\lambda_D\\ \\text{in nanometers},\\ \\chi\\right)$.\n\nUse $R=8.314$ $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ and $F=96485$ $\\mathrm{C}\\,\\mathrm{mol}^{-1}$. For numerical reporting, express $\\lambda_D$ in $\\mathrm{nm}$, rounded to four significant figures.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. All necessary data, equations, and constants are provided. The tasks are logically structured and solvable based on established principles of physical chemistry and electrostatics. We will proceed with the solution.\n\nThe problem asks for a four-part solution involving the derivation of the Debye length, its calculation for a specific brine, and an assessment of the electroneutrality assumption.\n\n**Part 1: Derivation of the Linearized Poisson–Boltzmann Equation and Debye Length**\n\nWe begin with the Nernst–Planck equation for the flux $\\mathbf{J}_i$ of ionic species $i$:\n$$\n\\mathbf{J}_i = -D_i \\nabla c_i - \\frac{z_i D_i F}{R T} c_i \\nabla \\phi\n$$\nHere, $D_i$ is the diffusion coefficient, $c_i$ is the molar concentration, $z_i$ is the charge number, $F$ is the Faraday constant, $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\phi$ is the electrostatic potential.\n\nAt equilibrium, there are no net fluxes, so $\\mathbf{J}_i = \\mathbf{0}$ for all species $i$. The Nernst–Planck equation simplifies to:\n$$\n-D_i \\nabla c_i - \\frac{z_i D_i F}{R T} c_i \\nabla \\phi = \\mathbf{0}\n$$\nAssuming the diffusion coefficient $D_i$ is non-zero, we can divide by $-D_i$:\n$$\n\\nabla c_i + \\frac{z_i F}{R T} c_i \\nabla \\phi = \\mathbf{0}\n$$\nRearranging this equation gives:\n$$\n\\frac{\\nabla c_i}{c_i} = -\\frac{z_i F}{R T} \\nabla \\phi\n$$\nRecognizing that the left-hand side is the gradient of the natural logarithm of $c_i$, we have $\\nabla(\\ln c_i)$. Integrating this expression from a reference state in the bulk solution (where the potential $\\phi$ is defined as $0$ and the concentration is $c_{i,\\infty}$) to a point with potential $\\phi$ and concentration $c_i$ yields the Boltzmann distribution for ion concentrations:\n$$\n\\int_{c_{i,\\infty}}^{c_i} d(\\ln c'_i) = -\\int_0^\\phi \\frac{z_i F}{R T} d\\phi' \\implies \\ln\\left(\\frac{c_i}{c_{i,\\infty}}\\right) = -\\frac{z_i F \\phi}{R T}\n$$\n$$\nc_i(\\mathbf{r}) = c_{i,\\infty} \\exp\\left(-\\frac{z_i F \\phi(\\mathbf{r})}{R T}\\right)\n$$\nThe problem states that potential variations are sufficiently small to justify linearization. This implies that the argument of the exponential function is small, i.e., $|\\frac{z_i F \\phi}{R T}| \\ll 1$. We can therefore use the first-order Taylor series expansion $\\exp(x) \\approx 1 + x$:\n$$\nc_i \\approx c_{i,\\infty} \\left(1 - \\frac{z_i F \\phi}{R T}\\right)\n$$\nNow we substitute this linearized concentration into the expression for the volumetric charge density, $\\rho = F \\sum_i z_i c_i$:\n$$\n\\rho \\approx F \\sum_i z_i \\left[ c_{i,\\infty} \\left(1 - \\frac{z_i F \\phi}{R T}\\right) \\right] = F \\sum_i z_i c_{i,\\infty} - F \\sum_i \\frac{z_i^2 F c_{i,\\infty} \\phi}{R T}\n$$\nThe first term, $F \\sum_i z_i c_{i,\\infty}$, represents the net charge density in the bulk solution, which must be zero due to the principle of electroneutrality. Thus, $\\sum_i z_i c_{i,\\infty} = 0$. The expression for $\\rho$ simplifies to:\n$$\n\\rho \\approx - \\left(\\frac{F^2}{R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi\n$$\nNext, we use the Poisson equation for a homogeneous medium with uniform permittivity $\\epsilon$, which is $\\nabla^2\\phi = -\\rho/\\epsilon$:\n$$\n\\nabla^2\\phi = -\\frac{1}{\\epsilon} \\left[ - \\left(\\frac{F^2}{R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi \\right] = \\left(\\frac{F^2}{\\epsilon R T} \\sum_i z_i^2 c_{i,\\infty}\\right) \\phi\n$$\nThis is the linearized Poisson–Boltzmann equation. It can be written in the form $\\nabla^2\\phi = \\kappa^2\\phi$, where $\\kappa$ is the inverse Debye length, $\\kappa = \\lambda_D^{-1}$. By comparison, we find:\n$$\n\\frac{1}{\\lambda_D^2} = \\frac{F^2}{\\epsilon R T} \\sum_i z_i^2 c_{i,\\infty}\n$$\nThe ionic strength $I$ is defined as $I = \\frac{1}{2}\\sum_i z_i^2 c_i$. In the bulk, this is $I = \\frac{1}{2}\\sum_i z_i^2 c_{i,\\infty}$, which implies $\\sum_i z_i^2 c_{i,\\infty} = 2I$. Substituting this into our expression for $\\lambda_D^{-2}$:\n$$\n\\frac{1}{\\lambda_D^2} = \\frac{F^2}{\\epsilon R T} (2I) = \\frac{2 F^2 I}{\\epsilon R T}\n$$\nSolving for the Debye screening length $\\lambda_D$, we obtain the required expression:\n$$\n\\lambda_D = \\sqrt{\\frac{\\epsilon R T}{2 F^2 I}}\n$$\n\n**Part 2: Calculation of Ionic Strength**\n\nThe brine contains sodium chloride ($\\mathrm{NaCl}$) and calcium chloride ($\\mathrm{CaCl}_2$). The ions present are $\\mathrm{Na}^+$, $\\mathrm{Ca}^{2+}$, and $\\mathrm{Cl}^-$.\nThe charge numbers are $z_{\\mathrm{Na}^+} = +1$, $z_{\\mathrm{Ca}^{2+}} = +2$, and $z_{\\mathrm{Cl}^-} = -1$.\nThe bulk concentrations are given in $\\mathrm{mol}\\,\\mathrm{L}^{-1}$:\n- $c_{\\mathrm{NaCl}, \\infty} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} \\implies c_{\\mathrm{Na}^+, \\infty} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$\n- $c_{\\mathrm{CaCl}_2, \\infty} = 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} \\implies c_{\\mathrm{Ca}^{2+}, \\infty} = 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$\nThe total chloride concentration is the sum from both salts:\n$c_{\\mathrm{Cl}^-, \\infty} = c_{\\mathrm{Cl}^- \\text{ from NaCl}} + c_{\\mathrm{Cl}^- \\text{ from CaCl}_2} = 0.70 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} + 2 \\times 0.10 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} = 0.90 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$.\n\nThe formula for ionic strength $I$ requires concentrations in SI units of $\\mathrm{mol}\\,\\mathrm{m}^{-3}$. The conversion is $1 \\, \\mathrm{L} = 10^{-3} \\, \\mathrm{m}^3$, so $1 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1} = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- $c_{\\mathrm{Na}^+, \\infty} = 0.70 \\times 1000 = 700 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $c_{\\mathrm{Ca}^{2+}, \\infty} = 0.10 \\times 1000 = 100 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $c_{\\mathrm{Cl}^-, \\infty} = 0.90 \\times 1000 = 900 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n\nWe can now compute the ionic strength $I$:\n$$\nI = \\frac{1}{2} \\sum_i z_i^2 c_{i,\\infty} = \\frac{1}{2} \\left(z_{\\mathrm{Na}^+}^2 c_{\\mathrm{Na}^+, \\infty} + z_{\\mathrm{Ca}^{2+}}^2 c_{\\mathrm{Ca}^{2+}, \\infty} + z_{\\mathrm{Cl}^-}^2 c_{\\mathrm{Cl}^-, \\infty}\\right)\n$$\n$$\nI = \\frac{1}{2} \\left[ (1)^2(700) + (2)^2(100) + (-1)^2(900) \\right] \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n$$\nI = \\frac{1}{2} (700 + 400 + 900) \\, \\mathrm{mol}\\,\\mathrm{m}^{-3} = \\frac{1}{2} (2000) \\, \\mathrm{mol}\\,\\mathrm{m}^{-3} = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n\n**Part 3: Calculation of the Debye Screening Length**\n\nWe use the derived formula for $\\lambda_D$ with the given values in SI units:\n- $\\epsilon = 5.93 \\times 10^{-10} \\, \\mathrm{F}\\,\\mathrm{m}^{-1}$\n- $R = 8.314 \\, \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $T = 333 \\, \\mathrm{K}$\n- $F = 96485 \\, \\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- $I = 1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n\n$$\n\\lambda_D = \\sqrt{\\frac{\\epsilon R T}{2 F^2 I}} = \\sqrt{\\frac{(5.93 \\times 10^{-10} \\, \\mathrm{F}\\,\\mathrm{m}^{-1}) (8.314 \\, \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) (333 \\, \\mathrm{K})}{2 (96485 \\, \\mathrm{C}\\,\\mathrm{mol}^{-1})^2 (1000 \\, \\mathrm{mol}\\,\\mathrm{m}^{-3})}}\n$$\n$$\n\\lambda_D = \\sqrt{\\frac{1.64257146 \\times 10^{-6}}{1.861864505 \\times 10^{13}}} \\, \\mathrm{m} = \\sqrt{8.82218 \\times 10^{-20}} \\, \\mathrm{m} \\approx 2.970215 \\times 10^{-10} \\, \\mathrm{m}\n$$\nThe result needs to be expressed in nanometers ($\\mathrm{nm}$), where $1 \\, \\mathrm{nm} = 10^{-9} \\, \\mathrm{m}$:\n$$\n\\lambda_D = (2.970215 \\times 10^{-10} \\, \\mathrm{m}) \\times \\left(\\frac{1 \\, \\mathrm{nm}}{10^{-9} \\, \\mathrm{m}}\\right) = 0.2970215 \\, \\mathrm{nm}\n$$\nRounding to four significant figures, we get $\\lambda_D = 0.2970 \\, \\mathrm{nm}$.\n\n**Part 4: Assessment of the Electroneutral Approximation**\n\nThe validity of the electroneutral approximation is assessed by comparing the Debye length $\\lambda_D$ to the characteristic length of the system, $L$. The approximation is valid if significant charge separation occurs only in a boundary layer that is much smaller than the system size, i.e., if $\\lambda_D \\ll L$.\nThe problem provides a quantitative criterion via the indicator $\\chi$: $\\chi=1$ if $\\lambda_D/L \\le 10^{-2}$, and $\\chi=0$ otherwise.\n\nWe have:\n- $\\lambda_D = 2.970 \\times 10^{-10} \\, \\mathrm{m}$\n- $L = 100 \\, \\mu\\mathrm{m} = 100 \\times 10^{-6} \\, \\mathrm{m} = 1 \\times 10^{-4} \\, \\mathrm{m}$\n\nThe ratio is:\n$$\n\\frac{\\lambda_D}{L} = \\frac{2.970 \\times 10^{-10} \\, \\mathrm{m}}{1 \\times 10^{-4} \\, \\mathrm{m}} = 2.970 \\times 10^{-6}\n$$\nWe compare this ratio to the threshold value $10^{-2}$:\n$$\n2.970 \\times 10^{-6} \\le 10^{-2}\n$$\nThis inequality is clearly true. Therefore, the condition for $\\chi=1$ is met.\nThe electroneutral approximation is highly valid for this system, as the length scale of charge imbalance ($\\approx 0.3 \\, \\mathrm{nm}$) is orders of magnitude smaller than the system thickness ($100,000 \\, \\mathrm{nm}$).\n\nThe final result is the pair $(\\lambda_D \\text{ in nm}, \\chi)$.\n- $\\lambda_D = 0.2970$\n- $\\chi = 1$\nThe reported pair is $(0.2970, 1)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2970  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "When a salt diffuses in water, the different mobilities of its constituent ions create a subtle internal electric field that couples their fluxes. This practice explores this phenomenon, guiding you to derive the effective ambipolar diffusion coefficient for a binary electrolyte using the Nernst-Planck framework and the zero-current condition . By analyzing how the system self-organizes to maintain charge neutrality during diffusion, you will gain insight into the emergent behavior of coupled transport.",
            "id": "4091521",
            "problem": "A geochemical porewater column contains a dilute binary electrolyte with cation valence $z_{+} = +2$ and anion valence $z_{-} = -1$, representative of a $2{:}1$ electrolyte (for example, calcium chloride). Consider one-dimensional, isothermal diffusion in the absence of fluid advection and external electrical forcing. Assume ideal solution behavior (activity coefficients equal to unity), local electroneutrality, and that diffusive electromigration is captured by the Nernst–Planck flux law and the Einstein relation between ionic mobilities and diffusion coefficients. The molecular diffusion coefficients in water (International System of Units (SI)) are $D_{+} = 7.9 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$ for the cation and $D_{-} = 2.03 \\times 10^{-9}\\ \\mathrm{m^{2}\\,s^{-1}}$ for the anion. The salt stoichiometry is $\\nu_{+} = 1$ and $\\nu_{-} = 2$, and electroneutrality of the salt implies $z_{+}\\nu_{+} + z_{-}\\nu_{-} = 0$.\n\nStarting strictly from fundamental transport balances appropriate to this setting (the Nernst–Planck flux law for each ion, the Einstein relation between mobility and diffusivity, local electroneutrality, and the zero electrical current condition), derive the effective ambipolar (salt) diffusion coefficient $D_{\\mathrm{amb}}$ for the $2{:}1$ electrolyte in terms of $D_{+}$, $D_{-}$, $z_{+}$, $z_{-}$, $\\nu_{+}$, and $\\nu_{-}$. Then, using the same derivation framework, obtain the ambipolar diffusion coefficient for a $1{:}1$ electrolyte (i.e., $z_{+} = +1$, $z_{-} = -1$, $\\nu_{+} = \\nu_{-} = 1$) with the same $D_{+}$ and $D_{-}$.\n\nReport as your final quantity the dimensionless ratio\n$$R = \\frac{D_{\\mathrm{amb}}^{(2{:}1)}}{D_{\\mathrm{amb}}^{(1{:}1)}}.$$\nRound your reported $R$ to four significant figures. Express the final answer as a dimensionless number.",
            "solution": "The problem is valid. It is a well-posed problem in computational geochemistry and physical chemistry, based on established scientific principles. All necessary information is provided, and the conditions are internally consistent. We will proceed with the derivation.\n\nThe fundamental principles governing one-dimensional, isothermal diffusion of a binary electrolyte in the absence of advection are the Nernst-Planck flux law for each ion, the condition of zero net electrical current, and the local electroneutrality constraint.\n\nThe Nernst-Planck equation for the flux $J_i$ of an ionic species $i$ is given by:\n$$J_i = -D_i \\frac{dC_i}{dx} - \\frac{z_i F}{RT} D_i C_i \\frac{d\\phi}{dx}$$\nwhere $D_i$ is the molecular diffusion coefficient, $C_i$ is the molar concentration, $z_i$ is the valence, $F$ is the Faraday constant, $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\phi$ is the electric potential. The term $\\frac{d\\phi}{dx}$ represents the internal electric field generated by differential diffusion rates of cations and anions.\n\nFor the binary electrolyte, we have two flux equations, one for the cation ($+$) and one for the anion ($-$):\n$$J_{+} = -D_{+} \\frac{dC_{+}}{dx} - \\frac{z_{+} F}{RT} D_{+} C_{+} \\frac{d\\phi}{dx}$$\n$$J_{-} = -D_{-} \\frac{dC_{-}}{dx} - \\frac{z_{-} F}{RT} D_{-} C_{-} \\frac{d\\phi}{dx}$$\n\nIn the absence of an external electrical circuit, the net electrical current must be zero:\n$$I = F \\sum_{i} z_i J_i = F(z_{+}J_{+} + z_{-}J_{-}) = 0$$\nThis simplifies to $z_{+}J_{+} + z_{-}J_{-} = 0$.\n\nThe concentration of each ion, $C_+$ and $C_-$, is related to the molar concentration of the salt, $C$, through the stoichiometric coefficients $\\nu_+$ and $\\nu_-$:\n$$C_{+} = \\nu_{+} C \\quad \\text{and} \\quad C_{-} = \\nu_{-} C$$\nThe spatial gradients are therefore related by:\n$$\\frac{dC_{+}}{dx} = \\nu_{+} \\frac{dC}{dx} \\quad \\text{and} \\quad \\frac{dC_{-}}{dx} = \\nu_{-} \\frac{dC}{dx}$$\nThe local electroneutrality of the bulk solution is expressed as $\\sum_i z_i C_i = 0$, which means $z_{+}C_{+} + z_{-}C_{-} = 0$. Using the salt concentration, this becomes $C(z_{+}\\nu_{+} + z_{-}\\nu_{-}) = 0$. Since $C \\neq 0$, we have the electroneutrality condition for the salt itself: $z_{+}\\nu_{+} + z_{-}\\nu_{-} = 0$.\n\nWe can now substitute the Nernst-Planck flux equations into the zero-current condition:\n$$z_{+}\\left(-D_{+} \\frac{dC_{+}}{dx} - \\frac{z_{+} F}{RT} D_{+} C_{+} \\frac{d\\phi}{dx}\\right) + z_{-}\\left(-D_{-} \\frac{dC_{-}}{dx} - \\frac{z_{-} F}{RT} D_{-} C_{-} \\frac{d\\phi}{dx}\\right) = 0$$\nUsing the relations for concentration gradients and ion concentrations in terms of the salt concentration $C$:\n$$-z_{+}D_{+}\\nu_{+}\\frac{dC}{dx} - \\frac{z_{+}^2 F}{RT} D_{+}\\nu_{+}C\\frac{d\\phi}{dx} - z_{-}D_{-}\\nu_{-}\\frac{dC}{dx} - \\frac{z_{-}^2 F}{RT} D_{-}\\nu_{-}C\\frac{d\\phi}{dx} = 0$$\nWe can rearrange this equation to solve for the induced electric field gradient $\\frac{d\\phi}{dx}$:\n$$-\\left(z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}\\right)\\frac{dC}{dx} = \\frac{F C}{RT}\\left(z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}\\right)\\frac{d\\phi}{dx}$$\n$$\\frac{d\\phi}{dx} = -\\frac{RT}{F C} \\frac{z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}} \\frac{dC}{dx}$$\n\nThe salt flux, $J_{\\text{salt}}$, is related to the individual ion fluxes by $J_{+} = \\nu_{+} J_{\\text{salt}}$ and $J_{-} = \\nu_{-} J_{\\text{salt}}$. The overall transport of the salt follows Fick's first law, with an effective ambipolar diffusion coefficient $D_{\\mathrm{amb}}$:\n$$J_{\\text{salt}} = -D_{\\mathrm{amb}} \\frac{dC}{dx}$$\nWe can determine $D_{\\mathrm{amb}}$ by substituting the expression for $\\frac{d\\phi}{dx}$ back into the flux equation for one of the ions, say the cation:\n$$J_{+} = \\nu_{+} J_{\\text{salt}} = -\\nu_{+}D_{\\mathrm{amb}}\\frac{dC}{dx}$$\nThe Nernst-Planck equation for $J_+$ is:\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} - \\frac{z_{+} F}{RT} D_{+}\\nu_{+}C \\left(-\\frac{RT}{F C} \\frac{z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}} \\frac{dC}{dx}\\right)$$\nSimplifying:\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} + z_{+} D_{+}\\nu_{+} \\left(\\frac{z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-}}{z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-}}\\right) \\frac{dC}{dx}$$\nUsing $z_+\\nu_+ = -z_-\\nu_-$:\n$z_{+}D_{+}\\nu_{+} + z_{-}D_{-}\\nu_{-} = z_{+}D_{+}\\nu_{+} + z_{-}D_{-}(-\\frac{z_+\\nu_+}{z_-}) = z_{+}\\nu_{+}(D_{+}-D_{-})$\n$z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}\\nu_{-} = z_{+}^2 D_{+}\\nu_{+} + z_{-}^2 D_{-}(-\\frac{z_+\\nu_+}{z_-}) = z_{+}\\nu_{+}(z_{+}D_{+} - z_{-}D_{-})$\nSubstituting these into the expression for $J_+$:\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} + z_{+} D_{+}\\nu_{+} \\left(\\frac{z_{+}\\nu_{+}(D_{+}-D_{-})}{z_{+}\\nu_{+}(z_{+}D_{+} - z_{-}D_{-})}\\right) \\frac{dC}{dx}$$\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} \\left[1 - \\frac{z_{+}(D_{+}-D_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right]$$\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} \\left[\\frac{(z_{+}D_{+} - z_{-}D_{-}) - z_{+}(D_{+}-D_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right]$$\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} \\left[\\frac{z_{+}D_{+} - z_{-}D_{-} - z_{+}D_{+} + z_{+}D_{-}}{z_{+}D_{+} - z_{-}D_{-}}\\right]$$\n$$J_{+} = -D_{+}\\nu_{+}\\frac{dC}{dx} \\left[\\frac{-z_{-}D_{-} + z_{+}D_{-}}{z_{+}D_{+} - z_{-}D_{-}}\\right] = -\\frac{dC}{dx} \\left(\\frac{\\nu_{+}D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right)$$\nFrom $J_{\\text{salt}} = J_{+}/\\nu_{+}$, we have:\n$$J_{\\text{salt}} = -\\frac{dC}{dx} \\left(\\frac{D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}\\right)$$\nBy comparison with $J_{\\text{salt}} = -D_{\\mathrm{amb}} \\frac{dC}{dx}$, we derive the ambipolar diffusion coefficient, known as the Nernst-Hartley equation:\n$$D_{\\mathrm{amb}} = \\frac{D_{+}D_{-}(z_{+} - z_{-})}{z_{+}D_{+} - z_{-}D_{-}}$$\nThis expression correctly shows that $D_{\\mathrm{amb}}$ depends on $D_{+}$, $D_{-}$, $z_{+}$, and $z_{-}$. The stoichiometric coefficients $\\nu_{+}$ and $\\nu_{-}$ do not explicitly appear in the final form because their influence is captured through the electroneutrality condition.\n\nNow, we apply this general formula to the two cases.\n\nCase 1: $2{:}1$ electrolyte\nGiven: $z_{+} = +2$, $z_{-} = -1$.\n$$D_{\\mathrm{amb}}^{(2{:}1)} = \\frac{D_{+}D_{-}((2) - (-1))}{(2)D_{+} - (-1)D_{-}} = \\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}}$$\n\nCase 2: $1{:}1$ electrolyte\nGiven: $z_{+} = +1$, $z_{-} = -1$.\n$$D_{\\mathrm{amb}}^{(1{:}1)} = \\frac{D_{+}D_{-}((1) - (-1))}{(1)D_{+} - (-1)D_{-}} = \\frac{2 D_{+}D_{-}}{D_{+} + D_{-}}$$\n\nThe problem asks for the dimensionless ratio $R$:\n$$R = \\frac{D_{\\mathrm{amb}}^{(2{:}1)}}{D_{\\mathrm{amb}}^{(1{:}1)}} = \\frac{\\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}}}{\\frac{2 D_{+}D_{-}}{D_{+} + D_{-}}}$$\n$$R = \\frac{3 D_{+}D_{-}}{2 D_{+} + D_{-}} \\cdot \\frac{D_{+} + D_{-}}{2 D_{+}D_{-}} = \\frac{3(D_{+} + D_{-})}{2(2 D_{+} + D_{-})}$$\n\nNow, we substitute the given numerical values for the diffusion coefficients:\n$D_{+} = 7.9 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$\n$D_{-} = 2.03 \\times 10^{-9}\\ \\mathrm{m^{2}\\,s^{-1}}$\nThe units are consistent, and they will cancel in the ratio.\n$$R = \\frac{3(7.9 \\times 10^{-10} + 2.03 \\times 10^{-9})}{2(2(7.9 \\times 10^{-10}) + 2.03 \\times 10^{-9})}$$\nTo simplify the calculation, let's write $D_{-}$ as $20.3 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$.\n$$R = \\frac{3(7.9 \\times 10^{-10} + 20.3 \\times 10^{-10})}{2(2(7.9 \\times 10^{-10}) + 20.3 \\times 10^{-10})}$$\nThe factor of $10^{-10}$ cancels out:\n$$R = \\frac{3(7.9 + 20.3)}{2(2 \\times 7.9 + 20.3)} = \\frac{3(28.2)}{2(15.8 + 20.3)} = \\frac{84.6}{2(36.1)} = \\frac{84.6}{72.2}$$\n$$R \\approx 1.17174515235...$$\nRounding to four significant figures, as requested:\n$$R \\approx 1.172$$",
            "answer": "$$\\boxed{1.172}$$"
        },
        {
            "introduction": "Bridging theory with practice, this final exercise challenges you to implement a computational model for ion transport in a realistic geochemical system. You will apply the Nernst-Planck equation to calculate the flux of total alkalinity, a key parameter in carbonate geochemistry, accounting for both diffusion and electromigration . This task requires not only coding the flux equations but also handling the crucial constraints of charge balance and chemical equilibrium, providing a holistic view of building a computational transport model.",
            "id": "4091565",
            "problem": "You are tasked with implementing a single, complete program that computes the diffusive–migrative flux of total alkalinity in a one-dimensional porewater column for a set of predefined test cases in computational geochemistry. Your implementation must start from fundamental principles, explicitly enforce charge balance and water mass balance, and use the standard formulation of ion transport. The physical and numerical values specified below must be used exactly as provided.\n\nThe physical scenario considers a one-dimensional domain of length $L$ with an externally imposed uniform electric field $E$ (in the International System of Units (SI), volts per meter) and concentration gradients of multiple ionic species between the left and right boundaries. You must treat transport as purely diffusive and migrative (no advection). The target quantity is the flux of total alkalinity, defined operationally as a linear functional of species fluxes.\n\nFundamental base and core definitions:\n- Conservation of mass for species $i$ establishes that the one-dimensional flux $J_i$ depends on gradients and driving forces.\n- Fick’s first law gives the diffusive contribution $-D_i \\,\\partial C_i/\\partial x$, where $D_i$ is the effective diffusion coefficient and $C_i$ is concentration.\n- The electromigrative contribution arises from motion of charge in an electric field. For ion $i$ with charge number $z_i$, the Nernst-Einstein relation connects mobility and diffusion such that the migrative flux can be written in terms of the Faraday constant $F$, the gas constant $R$, and temperature $T$.\n- Combining these, the Nernst–Planck equation (NPE) for the one-dimensional flux of species $i$ is expressed as:\n$$\nJ_i \\;=\\; -\\,D_i \\,\\frac{\\partial C_i}{\\partial x} \\;+\\; z_i \\, D_i \\,\\frac{F}{R\\,T}\\, C_i \\, E,\n$$\nwhere $E$ is the electric field (positive in the $+x$ direction). For numerical evaluation over a finite interval of length $L$, approximate $\\partial C_i/\\partial x$ by a finite difference and $C_i$ by the arithmetic mean between the left and right boundary values.\n\nCharge and water mass balance enforcement:\n- At each boundary, the water autoionization equilibrium is enforced: $[H^+]\\,[OH^-] = K_w$, with $K_w$ specified in SI units. \n- Electroneutrality is enforced at each boundary: $\\sum_i z_i \\, C_i = 0$, where the sum includes all ionic species present. To enforce both water equilibrium and electroneutrality while keeping non-water species fixed, solve for $[H^+]$ as the positive root of the quadratic equation arising from substituting $[OH^-] = K_w/[H^+]$ into electroneutrality:\n$$\n[H^+]^2 \\;+\\; S \\,[H^+] \\;-\\; K_w \\;=\\; 0,\n$$\nwhere $S$ is the fixed charge sum excluding $[H^+]$ and $[OH^-]$, given by $S = \\sum_{i \\neq H^+,OH^-} z_i \\, C_i$. Then set $[OH^-] = K_w/[H^+]$.\n\nDefinition of total alkalinity and target flux:\n- Consider the species set $\\{H^+, OH^-, Na^+, Cl^-, HCO_3^-, CO_3^{2-}\\}$ with charge numbers $z_i$ as specified below.\n- The total alkalinity $A_T$ is defined here as the linear combination\n$$\nA_T \\;=\\; [HCO_3^-] \\;+\\; 2[CO_3^{2-}] \\;+\\; [OH^-] \\;-\\; [H^+],\n$$\nand the flux of total alkalinity is\n$$\nJ_{A_T} \\;=\\; J_{HCO_3^-} \\;+\\; 2\\,J_{CO_3^{2-}} \\;+\\; J_{OH^-} \\;-\\; J_{H^+}.\n$$\nAll fluxes must be expressed in $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$.\n\nConstants and parameters (use exactly these values):\n- Gas constant $R = 8.314462618\\;\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n- Faraday constant $F = 96485.33212\\;\\text{C}\\,\\text{mol}^{-1}$.\n- Temperature $T = 298.15\\;\\text{K}$.\n- Column length $L = 0.01\\;\\text{m}$.\n- Water autoionization constant in SI units $K_w = 1.0\\times 10^{-8}\\;\\text{mol}^2\\,\\text{m}^{-6}$.\n\nSpecies properties (use exactly these values):\n- $H^+$: $z_{H^+} = +1$, $D_{H^+} = 9.31\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$.\n- $OH^-$: $z_{OH^-} = -1$, $D_{OH^-} = 5.27\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$.\n- $Na^+$: $z_{Na^+} = +1$, $D_{Na^+} = 1.33\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$.\n- $Cl^-$: $z_{Cl^-} = -1$, $D_{Cl^-} = 2.03\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$.\n- $HCO_3^-$: $z_{HCO_3^-} = -1$, $D_{HCO_3^-} = 1.18\\times 10^{-9}\\;\\text{m}^2\\,\\text{s}^{-1}$.\n- $CO_3^{2-}$: $z_{CO_3^{2-}} = -2$, $D_{CO_3^{2-}} = 9.2\\times 10^{-10}\\;\\text{m}^2\\,\\text{s}^{-1}$.\n\nUnits for concentrations and fields:\n- All boundary concentrations must be treated in $\\text{mol}\\,\\text{m}^{-3}$.\n- Electric field values $E$ are in $\\text{V}\\,\\text{m}^{-1}$.\n\nNumerical approximation rule:\n- Use the arithmetic mean concentration $C_i^{\\text{avg}} = \\left(C_i^{\\text{left}} + C_i^{\\text{right}}\\right)/2$ for the migrative term.\n- Use the finite difference $\\partial C_i/\\partial x \\approx \\left(C_i^{\\text{right}} - C_i^{\\text{left}}\\right)/L$ for the diffusive term.\n\nTest suite and inputs:\nFor each test case below, the left and right boundary concentrations are specified. The initial $[H^+]$ and $[OH^-]$ values may not satisfy electroneutrality; your program must enforce electroneutrality and water equilibrium at both boundaries prior to computing fluxes. All concentrations are in $\\text{mol}\\,\\text{m}^{-3}$.\n\n- Test case 1 (moderate alkalinity gradient, nonzero field):\n    - Electric field $E = 50$.\n    - Left boundary: $[Na^+] = 2.90099$, $[Cl^-] = 0.5$, $[HCO_3^-] = 2.0$, $[CO_3^{2-}] = 0.2$, initial $[H^+] = 1.0\\times 10^{-5}$, initial $[OH^-] = 1.0\\times 10^{-3}$.\n    - Right boundary: $[Na^+] = 2.6$, $[Cl^-] = 0.5$, $[HCO_3^-] = 1.8$, $[CO_3^{2-}] = 0.15$, initial $[H^+] = 1.2589\\times 10^{-5}$, initial $[OH^-] = 7.9433\\times 10^{-4}$.\n\n- Test case 2 (pure diffusion, reversed gradient):\n    - Electric field $E = 0$.\n    - Left boundary: $[Na^+] = 2.6$, $[Cl^-] = 0.5$, $[HCO_3^-] = 1.8$, $[CO_3^{2-}] = 0.15$, initial $[H^+] = 1.2589\\times 10^{-5}$, initial $[OH^-] = 7.9433\\times 10^{-4}$.\n    - Right boundary: $[Na^+] = 2.90099$, $[Cl^-] = 0.5$, $[HCO_3^-] = 2.0$, $[CO_3^{2-}] = 0.2$, initial $[H^+] = 1.0\\times 10^{-5}$, initial $[OH^-] = 1.0\\times 10^{-3}$.\n\n- Test case 3 (uniform composition, migrative-only transport):\n    - Electric field $E = -100$.\n    - Left boundary: $[Na^+] = 0.6$, $[Cl^-] = 0.6$, $[HCO_3^-] = 0.1$, $[CO_3^{2-}] = 0.01$, initial $[H^+] = 1.0\\times 10^{-5}$, initial $[OH^-] = 1.0\\times 10^{-3}$.\n    - Right boundary: $[Na^+] = 0.6$, $[Cl^-] = 0.6$, $[HCO_3^-] = 0.1$, $[CO_3^{2-}] = 0.01$, initial $[H^+] = 1.0\\times 10^{-5}$, initial $[OH^-] = 1.0\\times 10^{-3}$.\n\n- Test case 4 (low carbonate, strong field, opposing NaCl gradients):\n    - Electric field $E = 200$.\n    - Left boundary: $[Na^+] = 0.2$, $[Cl^-] = 0.25$, $[HCO_3^-] = 0.02$, $[CO_3^{2-}] = 0.002$, initial $[H^+] = 1.0\\times 10^{-4}$, initial $[OH^-] = 1.0\\times 10^{-4}$.\n    - Right boundary: $[Na^+] = 0.25$, $[Cl^-] = 0.2$, $[HCO_3^-] = 0.02$, $[CO_3^{2-}] = 0.0015$, initial $[H^+] = 1.0\\times 10^{-4}$, initial $[OH^-] = 1.0\\times 10^{-4}$.\n\nProgram requirements:\n- Implement the enforcement of electroneutrality and water equilibrium at each boundary as described, keeping non-water species fixed.\n- Compute the flux $J_i$ for each species using the Nernst–Planck equation with the finite-difference and arithmetic-mean approximations.\n- Compute the total alkalinity flux $J_{A_T}$ for each test case as the specified linear combination of species fluxes.\n- Express each $J_{A_T}$ in $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ as a floating-point number.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_k$ is the computed $J_{A_T}$ for test case $k$, in $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$.",
            "solution": "The problem requires the computation of the total alkalinity flux across a one-dimensional porewater column under the influence of concentration gradients and an externally imposed electric field. The solution necessitates a multi-step procedure founded on the principles of ion transport, chemical equilibrium, and charge balance. The problem is well-posed, scientifically sound, and provides all necessary information for a unique solution.\n\nThe fundamental equation governing the transport of each ionic species $i$ is the Nernst-Planck equation (NPE), which describes the total flux $J_i$ as a sum of a diffusive component driven by the concentration gradient and a migrative component driven by the electric field:\n$$\nJ_i \\;=\\; -\\,D_i \\,\\frac{\\partial C_i}{\\partial x} \\;+\\; z_i \\, D_i \\,\\frac{F}{R\\,T}\\, C_i \\, E\n$$\nHere, $D_i$ is the effective diffusion coefficient, $C_i$ is the concentration, $z_i$ is the charge number, $x$ is the spatial coordinate, $F$ is the Faraday constant, $R$ is the universal gas constant, $T$ is the absolute temperature, and $E$ is the magnitude of the uniform electric field.\n\nThe computational procedure is structured into three primary stages:\n$1$. Enforcement of boundary conditions,\n$2$. Calculation of individual species fluxes,\n$3$. Calculation of the total alkalinity flux.\n\n**$1$. Enforcement of Boundary Conditions**\nThe boundary concentrations for the species $Na^+$, $Cl^-$, $HCO_3^-$, and $CO_3^{2-}$ are provided. However, the concentrations of $H^+$ and $OH^-$ must be re-calculated at each boundary (left, $x=0$, and right, $x=L$) to satisfy two fundamental constraints simultaneously: water autoionization equilibrium and electroneutrality.\n\nThe water autoionization equilibrium is given by:\n$$\n[H^+]\\,[OH^-] \\;=\\; K_w\n$$\nwhere $K_w = 1.0\\times 10^{-8}\\;\\text{mol}^2\\,\\text{m}^{-6}$.\n\nThe electroneutrality condition requires the net charge density to be zero:\n$$\n\\sum_i z_i \\, C_i \\;=\\; 0\n$$\nThe sum is over all six species: $\\{H^+, OH^-, Na^+, Cl^-, HCO_3^-, CO_3^{2-}\\}$.\nWe can separate the contributions from $H^+$ and $OH^-$:\n$$\n(z_{H^+}\\,[H^+] \\;+\\; z_{OH^-}\\,[OH^-]) \\;+\\; \\sum_{i \\neq H^+,OH^-} z_i \\, C_i \\;=\\; 0\n$$\nLet $S = \\sum_{i \\neq H^+,OH^-} z_i \\, C_i$ be the sum of charge from the fixed-concentration species. Substituting $z_{H^+} = +1$, $z_{OH^-} = -1$, and $[OH^-] = K_w/[H^+]$ into the electroneutrality equation yields:\n$$\n[H^+] \\;-\\; \\frac{K_w}{[H^+]} \\;+\\; S \\;=\\; 0\n$$\nMultiplying by $[H^+]$ gives the required quadratic equation for $[H^+]$:\n$$\n[H^+]^2 \\;+\\; S \\,[H^+] \\;-\\; K_w \\;=\\; 0\n$$\nThis equation is solved for $[H^+]$ using the quadratic formula. Since concentration must be a positive real number, we take the positive root:\n$$\n[H^+] \\;=\\; \\frac{-S + \\sqrt{S^2 + 4K_w}}{2}\n$$\nOnce the corrected $[H^+]$ is found for a given boundary, the corresponding $[OH^-]$ is determined from the water equilibrium: $[OH^-] = K_w/[H^+]$. This procedure is applied independently to the left and right boundary concentration sets for each test case, resulting in a self-consistent set of boundary conditions for all six species.\n\n**$2$. Calculation of Individual Species Fluxes**\nWith the equilibrated boundary concentrations, $C_i^{\\text{left}}$ and $C_i^{\\text{right}}$, for each species $i$, the flux $J_i$ across the domain of length $L$ is calculated using the discretized form of the Nernst-Planck equation. The problem specifies the use of a first-order finite difference for the concentration gradient and the arithmetic mean for the concentration in the migrative term:\n$$\n\\frac{\\partial C_i}{\\partial x} \\approx \\frac{C_i^{\\text{right}} - C_i^{\\text{left}}}{L} \n\\quad \\text{and} \\quad\nC_i \\approx \\frac{C_i^{\\text{left}} + C_i^{\\text{right}}}{2}\n$$\nSubstituting these approximations into the NPE gives the computational formula for the flux of each species:\n$$\nJ_i \\;=\\; -D_i \\,\\left(\\frac{C_i^{\\text{right}} - C_i^{\\text{left}}}{L}\\right) \\;+\\; z_i \\, D_i \\,\\frac{F}{R\\,T}\\, \\left(\\frac{C_i^{\\text{left}} + C_i^{\\text{right}}}{2}\\right) \\, E\n$$\nThis calculation is performed for all six species using their specific properties ($D_i, z_i$) and the system parameters ($L, T, E, F, R$).\n\n**$3$. Calculation of Total Alkalinity Flux**\nThe total alkalinity, $A_T$, is an operational quantity defined by a linear combination of species concentrations. The problem defines it as:\n$$\nA_T \\;=\\; [HCO_3^-] \\;+\\; 2[CO_3^{2-}] \\;+\\; [OH^-] \\;-\\; [H^+]\n$$\nThe flux of total alkalinity, $J_{A_T}$, is correspondingly defined as the same linear combination of the individual species fluxes:\n$$\nJ_{A_T} \\;=\\; J_{HCO_3^-} \\;+\\; 2\\,J_{CO_3^{2-}} \\;+\\; J_{OH^-} \\;-\\; J_{H^+}.\n$$\nAfter calculating the individual fluxes $J_i$ for the relevant species as described in the previous step, they are combined according to this formula to yield the final target quantity for each test case. All calculations maintain SI units, resulting in a final flux $J_{A_T}$ in units of $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the diffusive-migrative flux of total alkalinity in a one-dimensional\n    porewater column for a set of predefined test cases.\n    \"\"\"\n\n    # --- Constants and Parameters ---\n    R = 8.314462618  # Gas constant (J/mol/K)\n    F = 96485.33212  # Faraday constant (C/mol)\n    T = 298.15        # Temperature (K)\n    L = 0.01          # Column length (m)\n    KW = 1.0e-8       # Water autoionization constant (mol^2/m^6)\n\n    # Pre-calculate the F/(RT) term for efficiency\n    F_RT = F / (R * T)\n\n    # --- Species Properties ---\n    # Structure: {name: {'z': charge_number, 'D': diffusion_coeff_m2_s-1}}\n    SPECIES_PROPS = {\n        'H+':       {'z':  1, 'D': 9.31e-9},\n        'OH-':      {'z': -1, 'D': 5.27e-9},\n        'Na+':      {'z':  1, 'D': 1.33e-9},\n        'Cl-':      {'z': -1, 'D': 2.03e-9},\n        'HCO3-':    {'z': -1, 'D': 1.18e-9},\n        'CO3^{2-}': {'z': -2, 'D': 9.20e-10}\n    }\n    \n    # List of species excluding H+ and OH- for S calculation\n    FIXED_SPECIES = ['Na+', 'Cl-', 'HCO3-', 'CO3^{2-}']\n\n    def enforce_neutrality(concentrations):\n        \"\"\"\n        Adjusts H+ and OH- concentrations to enforce electroneutrality and\n        water equilibrium.\n\n        Args:\n            concentrations (dict): A dictionary of species concentrations {species_name: value}.\n\n        Returns:\n            dict: An updated dictionary with equilibrated H+ and OH- concentrations.\n        \"\"\"\n        # Calculate S, the fixed charge sum\n        S = sum(\n            SPECIES_PROPS[sp]['z'] * concentrations[sp] for sp in FIXED_SPECIES\n        )\n\n        # Solve the quadratic equation for [H+]: [H+]^2 + S*[H+] - Kw = 0\n        # Using the positive root of the quadratic formula: (-b + sqrt(b^2 - 4ac)) / 2a\n        c_h_plus = (-S + np.sqrt(S**2 + 4 * KW)) / 2.0\n\n        # Calculate [OH-] from water equilibrium\n        c_oh_minus = KW / c_h_plus\n\n        equilibrated_concs = concentrations.copy()\n        equilibrated_concs['H+'] = c_h_plus\n        equilibrated_concs['OH-'] = c_oh_minus\n        \n        return equilibrated_concs\n\n    def calculate_flux(species_name, c_left, c_right, E):\n        \"\"\"\n        Calculates the flux of a single species using the Nernst-Planck equation.\n\n        Args:\n            species_name (str): The name of the species.\n            c_left (float): Concentration at the left boundary (mol/m^3).\n            c_right (float): Concentration at the right boundary (mol/m^3).\n            E (float): Electric field (V/m).\n\n        Returns:\n            float: The calculated flux in mol/m^2/s.\n        \"\"\"\n        props = SPECIES_PROPS[species_name]\n        z = props['z']\n        D = props['D']\n\n        # Diffusive flux component\n        flux_diff = -D * (c_right - c_left) / L\n\n        # Migrative flux component\n        c_avg = (c_left + c_right) / 2.0\n        flux_mig = z * D * F_RT * c_avg * E\n\n        return flux_diff + flux_mig\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"E\": 50.0,\n            \"left\":  {'Na+': 2.90099, 'Cl-': 0.5, 'HCO3-': 2.0,   'CO3^{2-}': 0.2,   'H+': 1.0e-5, 'OH-': 1.0e-3},\n            \"right\": {'Na+': 2.6,     'Cl-': 0.5, 'HCO3-': 1.8,   'CO3^{2-}': 0.15,  'H+': 1.2589e-5, 'OH-': 7.9433e-4}\n        },\n        {\n            \"E\": 0.0,\n            \"left\":  {'Na+': 2.6,     'Cl-': 0.5, 'HCO3-': 1.8,   'CO3^{2-}': 0.15,  'H+': 1.2589e-5, 'OH-': 7.9433e-4},\n            \"right\": {'Na+': 2.90099, 'Cl-': 0.5, 'HCO3-': 2.0,   'CO3^{2-}': 0.2,   'H+': 1.0e-5, 'OH-': 1.0e-3}\n        },\n        {\n            \"E\": -100.0,\n            \"left\":  {'Na+': 0.6, 'Cl-': 0.6, 'HCO3-': 0.1, 'CO3^{2-}': 0.01, 'H+': 1.0e-5, 'OH-': 1.0e-3},\n            \"right\": {'Na+': 0.6, 'Cl-': 0.6, 'HCO3-': 0.1, 'CO3^{2-}': 0.01, 'H+': 1.0e-5, 'OH-': 1.0e-3}\n        },\n        {\n            \"E\": 200.0,\n            \"left\":  {'Na+': 0.2,  'Cl-': 0.25, 'HCO3-': 0.02, 'CO3^{2-}': 0.002,  'H+': 1.0e-4, 'OH-': 1.0e-4},\n            \"right\": {'Na+': 0.25, 'Cl-': 0.2,  'HCO3-': 0.02, 'CO3^{2-}': 0.0015, 'H+': 1.0e-4, 'OH-': 1.0e-4}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        E_field = case[\"E\"]\n\n        # Enforce electroneutrality at both boundaries\n        c_left_equilibrated = enforce_neutrality(case[\"left\"])\n        c_right_equilibrated = enforce_neutrality(case[\"right\"])\n\n        # Calculate individual species fluxes\n        fluxes = {}\n        for species in SPECIES_PROPS:\n            fluxes[species] = calculate_flux(\n                species,\n                c_left_equilibrated[species],\n                c_right_equilibrated[species],\n                E_field\n            )\n\n        # Calculate total alkalinity flux: J_AT = J(HCO3-) + 2*J(CO3^{2-}) + J(OH-) - J(H+)\n        j_at = (\n            fluxes['HCO3-'] + \n            2 * fluxes['CO3^{2-}'] + \n            fluxes['OH-'] - \n            fluxes['H+']\n        )\n        results.append(j_at)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}