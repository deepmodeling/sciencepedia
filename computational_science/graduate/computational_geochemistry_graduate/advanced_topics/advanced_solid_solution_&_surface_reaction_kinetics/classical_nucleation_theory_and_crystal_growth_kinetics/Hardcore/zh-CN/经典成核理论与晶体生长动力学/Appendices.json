{
    "hands_on_practices": [
        {
            "introduction": "经典成核理论为临界核尺寸和成核能垒提供了简洁的表达式。然而，这些预测的准确性取决于物理参数的取值，例如界面自由能 $\\gamma$ ，而该参数的精确测定极为困难。本练习将指导您进行灵敏度分析，以量化 $\\gamma$ 的不确定性如何传递到关键成核参数中，这是评估任何计算模型稳健性的核心技能。",
            "id": "4072944",
            "problem": "在经典成核理论（CNT）框架下，考虑一个新矿物相从过饱和水溶液中成核的过程。对于一个球形核，其可逆形成功是半径的函数，由表面贡献和体积贡献之和给出，\n$$\n\\Delta G(r) = 4\\pi r^{2}\\gamma - \\frac{4}{3}\\pi r^{3}\\Delta g_{v},\n$$\n其中 $\\gamma > 0$ 是单位面积的各向同性固–溶界面自由能，$\\Delta g_{v} > 0$ 是与向稳定相转变相关的单位体积吉布斯自由能变化（一个正值，代表驱动力的大小）。假设除 $\\gamma$ 外的所有参数均为已知且固定。\n\n从上述基本表达式出发，通过适当的极值条件推导出临界半径 $r^{*}$ 和成核能垒 $\\Delta G^{*}$。然后，使用对数导数来量化 $r^{*}$ 和 $\\Delta G^{*}$ 对 $\\gamma$ 不确定性的敏感性。对于一个量 $y$ 相对于 $x$，对数导数定义为 $\\partial \\ln y / \\partial \\ln x$，并保持其他变量不变。使用这些敏感性系数，将 $\\gamma$ 的一个小的分数不确定度 $\\delta\\gamma/\\gamma = 0.10$ 传递到 $r^{*}$ 和 $\\Delta G^{*}$，假设线性化是有效的。\n\n将数对 $\\left(\\delta r^{*}/r^{*},\\, \\delta \\Delta G^{*}/\\Delta G^{*}\\right)$ 以无量纲小数形式报告，四舍五入到四位有效数字，并以行矩阵的形式呈现你的最终答案。",
            "solution": "该问题要求我们在经典成核理论（CNT）框架下，分析临界成核半径 $r^{*}$ 和成核能垒 $\\Delta G^{*}$ 对界面自由能 $\\gamma$ 的敏感性。\n\n首先，我们必须推导出 $r^{*}$ 和 $\\Delta G^{*}$ 的表达式。球形核的可逆形成功 $\\Delta G(r)$ 如下所示：\n$$\n\\Delta G(r) = 4\\pi r^{2}\\gamma - \\frac{4}{3}\\pi r^{3}\\Delta g_{v}\n$$\n参数包括半径 $r$、界面自由能 $\\gamma > 0$ 以及单位体积的体吉布斯自由能变化（驱动力）$\\Delta g_{v} > 0$。临界半径 $r^{*}$ 对应于此函数的最大值，该最大值代表了成核的能垒峰值。为求此极值，我们将 $\\Delta G(r)$ 对 $r$ 求导，并令其导数为零：\n$$\n\\frac{d(\\Delta G(r))}{dr} = \\frac{d}{dr} \\left( 4\\pi r^{2}\\gamma - \\frac{4}{3}\\pi r^{3}\\Delta g_{v} \\right) = 0\n$$\n$$\n8\\pi r\\gamma - 4\\pi r^{2}\\Delta g_{v} = 0\n$$\n对于一个非零核（$r \\neq 0$），我们可以两边同除以 $4\\pi r$：\n$$\n2\\gamma - r\\Delta g_{v} = 0\n$$\n解出 $r$ 即可得到临界半径 $r^{*}$：\n$$\nr^{*} = \\frac{2\\gamma}{\\Delta g_{v}}\n$$\n由于 $\\gamma > 0$ 且 $\\Delta g_{v} > 0$，所以 $r^{*}$ 为正，这符合物理半径的要求。为了确认这是一个最大值，我们可以检验其二阶导数：\n$$\n\\frac{d^{2}(\\Delta G(r))}{dr^{2}} = \\frac{d}{dr}(8\\pi r\\gamma - 4\\pi r^{2}\\Delta g_{v}) = 8\\pi\\gamma - 8\\pi r\\Delta g_{v}\n$$\n在 $r=r^{*}$ 处求值：\n$$\n\\left. \\frac{d^{2}(\\Delta G(r))}{dr^{2}} \\right|_{r=r^{*}} = 8\\pi\\gamma - 8\\pi \\left(\\frac{2\\gamma}{\\Delta g_{v}}\\right) \\Delta g_{v} = 8\\pi\\gamma - 16\\pi\\gamma = -8\\pi\\gamma\n$$\n由于 $\\gamma > 0$，二阶导数为负，这证实了 $r^{*}$ 对应一个局部最大值，即成核能垒。\n\n该能垒的高度 $\\Delta G^{*}$ 可通过将 $r=r^{*}$ 代回 $\\Delta G(r)$ 的表达式求得：\n$$\n\\Delta G^{*} = \\Delta G(r^{*}) = 4\\pi (r^{*})^{2}\\gamma - \\frac{4}{3}\\pi (r^{*})^{3}\\Delta g_{v}\n$$\n$$\n\\Delta G^{*} = 4\\pi \\left(\\frac{2\\gamma}{\\Delta g_{v}}\\right)^{2}\\gamma - \\frac{4}{3}\\pi \\left(\\frac{2\\gamma}{\\Delta g_{v}}\\right)^{3} \\Delta g_{v}\n$$\n$$\n\\Delta G^{*} = 4\\pi \\left(\\frac{4\\gamma^{2}}{(\\Delta g_{v})^{2}}\\right)\\gamma - \\frac{4}{3}\\pi \\left(\\frac{8\\gamma^{3}}{(\\Delta g_{v})^{3}}\\right) \\Delta g_{v}\n$$\n$$\n\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{(\\Delta g_{v})^{2}} - \\frac{32\\pi\\gamma^{3}}{3(\\Delta g_{v})^{2}}\n$$\n$$\n\\Delta G^{*} = \\left(1 - \\frac{2}{3}\\right) \\frac{16\\pi\\gamma^{3}}{(\\Delta g_{v})^{2}} = \\frac{1}{3} \\frac{16\\pi\\gamma^{3}}{(\\Delta g_{v})^{2}}\n$$\n$$\n\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{3(\\Delta g_{v})^{2}}\n$$\n\n接下来，我们使用对数导数量化 $r^{*}$ 和 $\\Delta G^{*}$ 对 $\\gamma$ 的敏感性。一个量 $y$ 相对于 $x$ 的对数导数定义为 $\\frac{\\partial \\ln y}{\\partial \\ln x}$。该系数直接将 $y$ 的分数变化与 $x$ 的分数变化联系起来。\n\n对于临界半径 $r^{*}$：\n敏感性系数为 $S_{\\gamma}^{r^{*}} = \\frac{\\partial \\ln r^{*}}{\\partial \\ln \\gamma}$。我们有 $r^{*} = \\frac{2\\gamma}{\\Delta g_{v}}$。两边取自然对数：\n$$\n\\ln(r^{*}) = \\ln\\left(\\frac{2}{\\Delta g_{v}}\\right) + \\ln(\\gamma)\n$$\n对 $\\ln(\\gamma)$ 求导，并保持所有其他参数不变：\n$$\n\\frac{\\partial \\ln(r^{*})}{\\partial \\ln(\\gamma)} = 0 + 1 = 1\n$$\n因此，$r^{*}$ 对 $\\gamma$ 的敏感性为 $1$。\n\n对于成核能垒 $\\Delta G^{*}$：\n敏感性系数为 $S_{\\gamma}^{\\Delta G^{*}} = \\frac{\\partial \\ln \\Delta G^{*}}{\\partial \\ln \\gamma}$。我们有 $\\Delta G^{*} = \\frac{16\\pi\\gamma^{3}}{3(\\Delta g_{v})^{2}}$。取自然对数：\n$$\n\\ln(\\Delta G^{*}) = \\ln\\left(\\frac{16\\pi}{3(\\Delta g_{v})^{2}}\\right) + \\ln(\\gamma^{3})\n$$\n$$\n\\ln(\\Delta G^{*}) = \\ln\\left(\\frac{16\\pi}{3(\\Delta g_{v})^{2}}\\right) + 3\\ln(\\gamma)\n$$\n对 $\\ln(\\gamma)$ 求导：\n$$\n\\frac{\\partial \\ln(\\Delta G^{*})}{\\partial \\ln(\\gamma)} = 0 + 3 = 3\n$$\n因此，$\\Delta G^{*}$ 对 $\\gamma$ 的敏感性为 $3$。\n\n最后，我们传递给定的 $\\gamma$ 的分数不确定度，以求出 $r^{*}$ 和 $\\Delta G^{*}$ 的相应分数不确定度。对于一个小的分数变化，线性化是有效的，我们可以使用以下近似：\n$$\n\\frac{\\delta y}{y} \\approx \\left(\\frac{\\partial \\ln y}{\\partial \\ln x}\\right) \\frac{\\delta x}{x}\n$$\n已知 $\\frac{\\delta\\gamma}{\\gamma} = 0.10$。\n\n$r^{*}$ 的分数不确定度为：\n$$\n\\frac{\\delta r^{*}}{r^{*}} \\approx \\left(\\frac{\\partial \\ln r^{*}}{\\partial \\ln \\gamma}\\right) \\frac{\\delta\\gamma}{\\gamma} = (1)(0.10) = 0.10\n$$\n这意味着 $\\gamma$ 中 $10\\%$ 的不确定度会导致 $r^{*}$ 中 $10\\%$ 的不确定度。\n\n$\\Delta G^{*}$ 的分数不确定度为：\n$$\n\\frac{\\delta \\Delta G^{*}}{\\Delta G^{*}} \\approx \\left(\\frac{\\partial \\ln \\Delta G^{*}}{\\partial \\ln \\gamma}\\right) \\frac{\\delta\\gamma}{\\gamma} = (3)(0.10) = 0.30\n$$\n这意味着 $\\gamma$ 中 $10\\%$ 的不确定度会导致 $\\Delta G^{*}$ 中 $30\\%$ 的不确定度，这凸显了成核能垒对界面能的高度敏感性。\n\n题目要求以四位有效数字的小数形式给出数对 $\\left(\\delta r^{*}/r^{*},\\, \\delta \\Delta G^{*}/\\Delta G^{*}\\right)$。\n$$\n\\frac{\\delta r^{*}}{r^{*}} = 0.1000\n$$\n$$\n\\frac{\\delta \\Delta G^{*}}{\\Delta G^{*}} = 0.3000\n$$\n该数对以行矩阵形式表示。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1000  0.3000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "尽管球形核的假设简化了成核能垒的推导，但真实的矿物晶体常常呈现出特定的晶体学形态。本练习将超越这一理想化假设，探讨几何形状如何从根本上影响成核的热力学过程。您将推导出一个包含“形状因子” $\\phi$ 的通用成核能垒表达式，从而将抽象的理论与晶体形态的具体现实联系起来。",
            "id": "4072966",
            "problem": "在饱和地球化学环境中，含水矿物的沉淀通常使用经典成核理论（CNT）进行建模，该理论将晶核的可逆形成视作界面自由能成本和体自由能增益之间的竞争。考虑一个形状受限于旋转对称扁球体的核，其赤道半轴为 $a$，极半轴为 $c$，且轴比固定为 $a/c=2$。单位面积的界面自由能是各向同性的，等于 $\\gamma$，而单位体积的体自由能收益（驱动力）为 $\\Delta g_v > 0$。形成一个尺寸由单一尺度参数 $s$（在形状固定的情况下均匀缩放所有线性尺寸）表征的核的总吉布斯自由能变化由界面项和体积项之和给出，即 $\\Delta G=\\gamma S - \\Delta g_v V$，其中 $S$ 是表面积，$V$ 是体积。从 $\\Delta G$ 的这个定义出发，使用第一性原理标度论证，推导与形状相关的临界能垒 $\\Delta G^*$，并证明其对材料参数的依赖关系可以写成一个形状因子 $\\phi$ 和一个通用材料前因子的乘积形式，即 $\\Delta G^*=\\phi\\,\\gamma^3/\\Delta g_v^2$。然后，对于 $a/c=2$ 的扁球体核，计算形状因子 $\\phi$ 的精确解析表达式。您可以使用扁球体的标准几何公式：体积 $V=(4/3)\\pi a^2 c$ 和表面积 $S=2\\pi a^2\\left[1+\\frac{1-e^2}{e}\\,\\operatorname{arctanh}(e)\\right]$，其中偏心率为 $e=\\sqrt{1-c^2/a^2}$，$\\operatorname{arctanh}$ 表示反双曲正切函数。请将 $\\phi$ 的最终答案表示为一个没有数值近似的闭式解析表达式。$\\phi$ 无需单位，因为它是无量纲的。",
            "solution": "该问题是基于经典成核理论（CNT）的一个练习。\n\n### 第 1 步：分析问题\n-   **系统**：含水矿物沉淀。\n-   **理论**：经典成核理论（CNT）。\n-   **核形状**：旋转对称扁球体。\n-   **几何约束**：赤道半轴 $a$，极半轴 $c$，固定轴比 $a/c = 2$。\n-   **材料参数**：\n    -   各向同性的单位面积界面自由能：$\\gamma$。\n    -   单位体积的体自由能收益（驱动力）：$\\Delta g_v > 0$。\n-   **总自由能变化**：$\\Delta G = \\gamma S - \\Delta g_v V$，其中 $S$ 是表面积，$V$ 是体积。\n-   **标度**：所有线性尺寸都随单一参数 $s$ 均匀缩放。\n-   **扁球体几何公式**：\n    -   体积：$V = \\frac{4}{3}\\pi a^2 c$。\n    -   表面积：$S = 2\\pi a^2\\left[1+\\frac{1-e^2}{e}\\,\\operatorname{arctanh}(e)\\right]$。\n    -   偏心率：$e = \\sqrt{1-c^2/a^2}$。\n-   **任务 1**：使用第一性原理标度论证推导临界能垒 $\\Delta G^*$，并证明其可以写成 $\\Delta G^*=\\phi\\,\\gamma^3/\\Delta g_v^2$ 的形式。\n-   **任务 2**：计算指定扁球体的形状因子 $\\phi$ 的精确解析表达式。\n\n### 第 2 步：推导解答\n\n形成一个核的总吉布斯自由能变化 $\\Delta G$ 由表面能项（成本）和体能量项（收益）之和给出：\n$$\n\\Delta G = \\gamma S - \\Delta g_v V\n$$\n其中 $S$ 是核的表面积，$V$ 是核的体积。参数 $\\gamma > 0$ 是单位面积的界面能，而 $\\Delta g_v > 0$ 是相变过程中单位体积的自由能收益。\n\n对于一个固定形状的核，其表面积 $S$ 和体积 $V$ 可以用一个单一的特征长度尺度来表示，我们称之为 $s$。体积具有长度的立方量纲，因此与 $s^3$ 成比例；而表面积具有长度的平方量纲，因此与 $s^2$ 成比例。我们可以写出：\n$$\nV = k_V s^3\n$$\n$$\nS = k_S s^2\n$$\n其中 $k_V$ 和 $k_S$ 是仅取决于核形状的无量纲常数。\n\n将这些标度关系代入 $\\Delta G$ 的表达式中，得到：\n$$\n\\Delta G(s) = \\gamma k_S s^2 - \\Delta g_v k_V s^3\n$$\n临界核尺寸 $s^*$ 对应于自由能垒的最高点。通过对 $\\Delta G(s)$ 关于 $s$ 求导并令其为零来找到该值：\n$$\n\\frac{d(\\Delta G)}{ds} = 2\\gamma k_S s - 3\\Delta g_v k_V s^2 = 0\n$$\n对于非平凡的核（$s \\neq 0$），我们可以两边同除以 $s$ 来求解临界尺寸 $s^*$：\n$$\n2\\gamma k_S - 3\\Delta g_v k_V s^* = 0\n$$\n$$\ns^* = \\frac{2\\gamma k_S}{3\\Delta g_v k_V}\n$$\n由于 $\\gamma > 0$ 且 $\\Delta g_v > 0$，临界尺寸 $s^*$ 为正，符合要求。\n\n能垒的高度 $\\Delta G^*$ 是 $\\Delta G(s)$ 在 $s=s^*$ 处的值：\n$$\n\\Delta G^* = \\Delta G(s^*) = \\gamma k_S (s^*)^2 - \\Delta g_v k_V (s^*)^3\n$$\n代入 $s^*$ 的表达式：\n$$\n\\Delta G^* = \\gamma k_S \\left(\\frac{2\\gamma k_S}{3\\Delta g_v k_V}\\right)^2 - \\Delta g_v k_V \\left(\\frac{2\\gamma k_S}{3\\Delta g_v k_V}\\right)^3\n$$\n$$\n\\Delta G^* = \\gamma k_S \\left(\\frac{4\\gamma^2 k_S^2}{9\\Delta g_v^2 k_V^2}\\right) - \\Delta g_v k_V \\left(\\frac{8\\gamma^3 k_S^3}{27\\Delta g_v^3 k_V^3}\\right)\n$$\n$$\n\\Delta G^* = \\frac{4\\gamma^3 k_S^3}{9\\Delta g_v^2 k_V^2} - \\frac{8\\gamma^3 k_S^3}{27\\Delta g_v^2 k_V^2}\n$$\n$$\n\\Delta G^* = \\left(\\frac{12}{27} - \\frac{8}{27}\\right) \\frac{\\gamma^3 k_S^3}{\\Delta g_v^2 k_V^2} = \\frac{4}{27} \\frac{k_S^3}{k_V^2} \\frac{\\gamma^3}{\\Delta g_v^2}\n$$\n这证明了临界能垒可以写成 $\\Delta G^* = \\phi \\frac{\\gamma^3}{\\Delta g_v^2}$ 的形式，其中无量纲的形状因子 $\\phi$ 由下式给出：\n$$\n\\phi = \\frac{4}{27} \\frac{k_S^3}{k_V^2}\n$$\n接下来，我们必须为指定的扁球体计算 $\\phi$。轴比固定为 $a/c = 2$，即 $a=2c$。我们选择极半轴 $c$ 作为我们的特征标度参数，因此 $s = c$。\n\n扁球体的体积是：\n$$\nV = \\frac{4}{3}\\pi a^2 c = \\frac{4}{3}\\pi (2c)^2 c = \\frac{16\\pi}{3} c^3\n$$\n将此与 $V = k_V c^3$ 进行比较，我们确定体积形状常数为：\n$$\nk_V = \\frac{16\\pi}{3}\n$$\n现在，我们来确定表面积 $S$。首先，我们计算偏心率 $e$：\n$$\ne = \\sqrt{1 - \\frac{c^2}{a^2}} = \\sqrt{1 - \\frac{c^2}{(2c)^2}} = \\sqrt{1 - \\frac{1}{4}} = \\sqrt{\\frac{3}{4}} = \\frac{\\sqrt{3}}{2}\n$$\n表面积公式为 $S = 2\\pi a^2\\left[1+\\frac{1-e^2}{e}\\,\\operatorname{arctanh}(e)\\right]$。我们代入 $a=2c$ 和 $e$ 的值：\n$$\nS = 2\\pi (2c)^2 \\left[1+\\frac{1 - (3/4)}{\\sqrt{3}/2}\\,\\operatorname{arctanh}\\left(\\frac{\\sqrt{3}}{2}\\right)\\right]\n$$\n$$\nS = 8\\pi c^2 \\left[1+\\frac{1/4}{\\sqrt{3}/2}\\,\\operatorname{arctanh}\\left(\\frac{\\sqrt{3}}{2}\\right)\\right] = 8\\pi c^2 \\left[1+\\frac{1}{2\\sqrt{3}}\\,\\operatorname{arctanh}\\left(\\frac{\\sqrt{3}}{2}\\right)\\right]\n$$\n为简化 $\\operatorname{arctanh}$ 项，我们使用其对数定义 $\\operatorname{arctanh}(x) = \\frac{1}{2}\\ln\\left(\\frac{1+x}{1-x}\\right)$：\n$$\n\\operatorname{arctanh}\\left(\\frac{\\sqrt{3}}{2}\\right) = \\frac{1}{2}\\ln\\left(\\frac{1+\\frac{\\sqrt{3}}{2}}{1-\\frac{\\sqrt{3}}{2}}\\right) = \\frac{1}{2}\\ln\\left(\\frac{2+\\sqrt{3}}{2-\\sqrt{3}}\\right)\n$$\n将对数参数的分子和分母同乘以其共轭项 $(2+\\sqrt{3})$：\n$$\n\\frac{2+\\sqrt{3}}{2-\\sqrt{3}} = \\frac{(2+\\sqrt{3})(2+\\sqrt{3})}{(2-\\sqrt{3})(2+\\sqrt{3})} = \\frac{(2+\\sqrt{3})^2}{4-3} = (2+\\sqrt{3})^2\n$$\n因此，$\\operatorname{arctanh}$ 的表达式变为：\n$$\n\\operatorname{arctanh}\\left(\\frac{\\sqrt{3}}{2}\\right) = \\frac{1}{2}\\ln\\left((2+\\sqrt{3})^2\\right) = \\frac{1}{2} \\cdot 2\\ln(2+\\sqrt{3}) = \\ln(2+\\sqrt{3})\n$$\n将此结果代回表面积方程：\n$$\nS = 8\\pi c^2 \\left[1+\\frac{1}{2\\sqrt{3}}\\ln(2+\\sqrt{3})\\right] = 8\\pi c^2 \\left[1+\\frac{\\sqrt{3}}{6}\\ln(2+\\sqrt{3})\\right]\n$$\n将此与 $S=k_S c^2$ 进行比较，我们确定表面积形状常数为：\n$$\nk_S = 8\\pi \\left[1+\\frac{\\sqrt{3}}{6}\\ln(2+\\sqrt{3})\\right]\n$$\n最后，我们使用 $k_V$ 和 $k_S$ 的表达式来计算形状因子 $\\phi$：\n$$\n\\phi = \\frac{4}{27} \\frac{k_S^3}{k_V^2} = \\frac{4}{27} \\frac{\\left(8\\pi \\left[1+\\frac{\\sqrt{3}}{6}\\ln(2+\\sqrt{3})\\right]\\right)^3}{\\left(\\frac{16\\pi}{3}\\right)^2}\n$$\n$$\n\\phi = \\frac{4}{27} \\frac{8^3 \\pi^3 \\left[1+\\frac{\\sqrt{3}}{6}\\ln(2+\\sqrt{3})\\right]^3}{\\frac{16^2 \\pi^2}{3^2}} = \\frac{4 \\cdot 512 \\cdot 9}{27 \\cdot 256} \\frac{\\pi^3}{\\pi^2} \\left[1+\\frac{\\sqrt{3}}{6}\\ln(2+\\sqrt{3})\\right]^3\n$$\n数值前因子简化为：\n$$\n\\frac{4 \\cdot (2 \\cdot 256) \\cdot 9}{27 \\cdot 256} = \\frac{8 \\cdot 9}{27} = \\frac{72}{27} = \\frac{8}{3}\n$$\n因此，形状因子 $\\phi$ 为：\n$$\n\\phi = \\frac{8\\pi}{3} \\left[1+\\frac{\\sqrt{3}}{6}\\ln(2+\\sqrt{3})\\right]^3\n$$\n这就是形状因子的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{8\\pi}{3} \\left[1+\\frac{\\sqrt{3}}{6}\\ln(2+\\sqrt{3})\\right]^{3}}\n$$"
        },
        {
            "introduction": "前面的练习侧重于成核能垒的静态特性，而本综合性练习则将这些热力学概念与动力学因素相结合，以构建一个完整的、动态的成核速率模型 $J(t)$ 。您将编写一个计算程序，模拟在变化的过饱和度下，晶核总数随时间的演化，这项任务代表了预测性计算地球化学的核心。",
            "id": "4072988",
            "problem": "一种在水性环境中进行均匀结晶的溶液，由一个随时间变化的过饱和度 $S(t)$ 驱动。该过饱和度在时间 $\\tau$ 内从初始值 $S_i$ 线性增加（斜坡式）到最终值 $S_f$，此后保持恒定。具体而言，对于以秒为单位的时间 $t$，过饱和度定义为\n$$\nS(t) =\n\\begin{cases}\nS_i + (S_f - S_i)\\,\\dfrac{t}{\\tau},  0 \\le t \\le \\tau, \\\\\nS_f,  t > \\tau.\n\\end{cases}\n$$\n假设溶液中球形核的均匀成核和生长遵循经典成核理论 (CNT) 的框架，该理论通过表面能和体积自由能之间的竞争来模拟形成一个由 $n$ 个生长单元组成的团簇所需的可逆功。从计算地球化学的角度出发，从以下基本基础开始：\n- 形成一个由 $n$ 个生长单元组成的团簇所需的可逆自由能是表面能项和由过饱和度驱动的体自由能项之和。设分子（或生长单元）体积为 $v_m$（单位 $\\mathrm{m}^3$），界面能为 $\\gamma$（单位 $\\mathrm{J}\\cdot\\mathrm{m}^{-2}$），热能为 $k_B T$，其中 Boltzmann 常数 $k_B$ 单位为 $\\mathrm{J}\\cdot\\mathrm{K}^{-1}$，绝对温度为 $T$（单位 $\\mathrm{K}$）。过饱和度通过化学势差 $\\Delta \\mu(t)$ 引入，对于 $S(t) > 1$，有 $\\Delta \\mu(t) = k_B T \\ln S(t)$。\n- 对于球形团簇，表面能前因子随几何形状按 $n$ 的幂次缩放，而体自由能与 $n$ 呈线性关系。利用这些几何和热力学事实，从第一性原理推导出临界团簇尺寸 $n^\\*(t)$、临界半径 $r^\\*(t)$、成核势垒 $\\Delta G^\\*(t)$ 和 Zeldovich 因子 $Z(t)$。\n- 对于扩散系数为 $D$（单位 $\\mathrm{m}^2\\cdot\\mathrm{s}^{-1}$）、单体数密度为 $c_m$（单位 $\\mathrm{m}^{-3}$）的扩散限制的单体附着过程，到达临界团簇的单体速率可以与到半径为 $r^\\*(t)$ 的汇的球形扩散通量相关联。利用这一物理图像，构建在越过势垒坐标处的适当附着频率。\n- 稳态 CNT 成核速率 $J(t)$（单位 $\\mathrm{m}^{-3}\\cdot\\mathrm{s}^{-1}$）结合了越过势垒的概率和一个动力学前因子。实现 $J(t)$ 时，需使其在 $S(t) \\le 1$（欠饱和或饱和条件）时为零，并在 $S(t) > 1$ 时遵循适当的热激活形式。\n- 单位体积内随时间 $t$ 累积的预期核数 $N(t)$（单位 $\\mathrm{m}^{-3}$）是 $J(t')$ 从 $t'=0$ 到 $t'=t$ 的积分。\n\n您的任务是：\n1. 基于此基础推导 $J(t)$ 和 $N(t)$，确保所有步骤在物理上合理且量纲一致。\n2. 实现一个程序，为下面的每个测试用例计算：\n   - 瞬时成核速率 $J(t_{\\text{end}})$，单位为 $\\mathrm{m}^{-3}\\cdot\\mathrm{s}^{-1}$。\n   - 通过对 $J(t)$ 从 $t=0$ 到 $t=t_{\\text{end}}$ 积分得到的累积核数 $N(t_{\\text{end}})$，单位为 $\\mathrm{m}^{-3}$。\n3. 使用以下以国际单位制 (SI) 表示的参数集测试套件。在所有情况下，将潜在胚胎位置的数密度 $n_s$ 设为等于单体数密度 $c_m$：\n   - A例（通用斜坡，斜坡后评估）：$\\gamma = 0.2\\,\\mathrm{J}\\cdot\\mathrm{m}^{-2}$，$v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$，$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\cdot\\mathrm{s}^{-1}$，$c_m = 1.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$，$T = 298\\,\\mathrm{K}$，$S_i = 1.01$，$S_f = 1.5$，$\\tau = 100\\,\\mathrm{s}$，$t_{\\text{end}} = 200\\,\\mathrm{s}$。\n   - B例（近饱和边界，在斜坡结束时评估）：$\\gamma = 0.2\\,\\mathrm{J}\\cdot\\mathrm{m}^{-2}$，$v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$，$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\cdot\\mathrm{s}^{-1}$，$c_m = 1.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$，$T = 298\\,\\mathrm{K}$，$S_i = 0.99$，$S_f = 1.02$，$\\tau = 50\\,\\mathrm{s}$，$t_{\\text{end}} = 50\\,\\mathrm{s}$。\n   - C例（高过饱和度，快速斜坡）：$\\gamma = 0.05\\,\\mathrm{J}\\cdot\\mathrm{m}^{-2}$，$v_m = 1.0 \\times 10^{-28}\\,\\mathrm{m}^3$，$D = 2.0 \\times 10^{-9}\\,\\mathrm{m}^2\\cdot\\mathrm{s}^{-1}$，$c_m = 5.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$，$T = 298\\,\\mathrm{K}$，$S_i = 1.1$，$S_f = 3.0$，$\\tau = 10\\,\\mathrm{s}$，$t_{\\text{end}} = 10\\,\\mathrm{s}$。\n   - D例（中等过饱和度，高温，长时斜坡后积分）：$\\gamma = 0.1\\,\\mathrm{J}\\cdot\\mathrm{m}^{-2}$，$v_m = 8.0 \\times 10^{-29}\\,\\mathrm{m}^3$，$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\cdot\\mathrm{s}^{-1}$，$c_m = 2.0 \\times 10^{26}\\,\\mathrm{m}^{-3}$，$T = 323\\,\\mathrm{K}$，$S_i = 1.02$，$S_f = 2.0$，$\\tau = 200\\,\\mathrm{s}$，$t_{\\text{end}} = 500\\,\\mathrm{s}$。\n\n此问题不涉及角度单位。不使用百分比；过饱和度直接定义为无量纲比率。所有输出必须按规定以国际单位制 (SI) 表示。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的浮点数列表，顺序如下：\n$$\n[\\; J_A(t_{\\text{end}}),\\; N_A(t_{\\text{end}}),\\; J_B(t_{\\text{end}}),\\; N_B(t_{\\text{end}}),\\; J_C(t_{\\text{end}}),\\; N_C(t_{\\text{end}}),\\; J_D(t_{\\text{end}}),\\; N_D(t_{\\text{end}}) \\;].\n$$",
            "solution": "该问题具有科学依据，提法明确，并包含了获得唯一解所需的所有必要信息。这是将经典成核理论 (CNT)直接应用于随时间变化的过饱和度场景，是计算材料科学和地球化学中的一个标准问题。所提供的参数在物理上是现实的。因此，该问题是有效的。\n\n解决方案要求根据问题陈述中概述的第一性原理，推导随时间变化的成核速率 $J(t)$ 和累积核数 $N(t)$ 的表达式。这涉及到结合球形团簇均匀成核的热力学和动力学方面。\n\n首先，我们将过饱和度 $S(t)$ 定义为时间 $t$ 的函数。对于 $t \\in [0, \\tau]$，过饱和度从初始值 $S_i$ 线性增加到最终值 $S_f$。对于 $t > \\tau$，它保持在 $S_f$ 恒定。\n$$\nS(t) =\n\\begin{cases}\nS_i + (S_f - S_i)\\,\\dfrac{t}{\\tau},  0 \\le t \\le \\tau \\\\\nS_f,  t > \\tau\n\\end{cases}\n$$\n成核的热力学驱动力是过饱和溶液和固相之间的化学势变化 $\\Delta \\mu(t)$，由 $\\Delta \\mu(t) = k_B T \\ln S(t)$ 给出，其中 $k_B$ 是 Boltzmann 常数，$T$ 是绝对温度。只有在过饱和溶液中，即 $S(t) > 1$ 从而 $\\Delta \\mu(t) > 0$ 时，成核才可能发生。\n\n**1. 成核的 Gibbs 自由能与临界性质**\n\n根据 CNT，形成一个由 $n$ 个体积为 $v_m$ 的单体组成的球形团簇的自由能变化 $\\Delta G(n,t)$，是创建新表面的能量成本和形成体相的能量增益之和：\n$$\n\\Delta G(n,t) = \\Delta G_{\\text{surface}} + \\Delta G_{\\text{volume}}\n$$\n表面项为 $A \\gamma$，其中 $\\gamma$ 是界面能，$A$ 是球形团簇的表面积。团簇的体积是 $V=nv_m$。半径 $r$ 由 $V = \\frac{4}{3}\\pi r^3$ 给出，因此 $r = (\\frac{3nv_m}{4\\pi})^{1/3}$。面积为 $A = 4\\pi r^2 = 4\\pi (\\frac{3nv_m}{4\\pi})^{2/3} = (36\\pi v_m^2)^{1/3} n^{2/3}$。\n体积项为 $-n \\Delta \\mu(t)$。因此，形成自由能为：\n$$\n\\Delta G(n,t) = \\gamma (36\\pi v_m^2)^{1/3} n^{2/3} - n \\Delta \\mu(t)\n$$\n函数 $\\Delta G(n,t)$ 在临界团簇尺寸 $n^*(t)$ 处有最大值，该值代表成核势垒。我们通过将关于 $n$ 的导数设为零来找到这个最大值：\n$$\n\\frac{\\partial \\Delta G}{\\partial n} = \\frac{2}{3} \\gamma (36\\pi v_m^2)^{1/3} n^{-1/3} - \\Delta \\mu(t) = 0\n$$\n解出 $n$ 得到临界尺寸 $n^*(t)$：\n$$\nn^*(t) = \\left( \\frac{2 \\gamma (36\\pi v_m^2)^{1/3}}{3 \\Delta \\mu(t)} \\right)^3 = \\frac{32 \\pi \\gamma^3 v_m^2}{3 (\\Delta \\mu(t))^3}\n$$\n另外，使用临界半径 $r^*(t)$ 进行计算通常更直接。自由能变化作为半径的函数是 $\\Delta G(r,t) = 4\\pi r^2 \\gamma - \\frac{4\\pi r^3}{3 v_m} \\Delta \\mu(t)$。令 $\\frac{\\partial \\Delta G}{\\partial r} = 0$ 可得到临界半径：\n$$\n8\\pi r \\gamma - \\frac{4\\pi r^2}{v_m} \\Delta \\mu(t) = 0 \\implies r^*(t) = \\frac{2 \\gamma v_m}{\\Delta \\mu(t)}\n$$\n临界核尺寸 $n^*(t)$ 可以通过 $r^*(t)$ 由 $n^*(t) = \\frac{4/3 \\pi (r^*(t))^3}{v_m}$ 得到，这与前面的表达式一致。\n\n成核势垒的高度 $\\Delta G^*(t)$ 是 $\\Delta G(n^*,t)$ 或 $\\Delta G(r^*,t)$：\n$$\n\\Delta G^*(t) = \\frac{1}{2} n^*(t) \\Delta \\mu(t) = \\frac{16 \\pi \\gamma^3 v_m^2}{3 (\\Delta \\mu(t))^2} = \\frac{16 \\pi \\gamma^3 v_m^2}{3 (k_B T \\ln S(t))^2}\n$$\n\n**2. 动力学因子与成核速率**\n\n稳态成核速率 $J(t)$ 由通用的 CNT 表达式给出：\n$$\nJ(t) = n_s Z(t) f^+(n^*,t) \\exp\\left(-\\frac{\\Delta G^*(t)}{k_B T}\\right)\n$$\n这里，$n_s$ 是潜在成核位点的数密度，问题指定其等于单体数密度 $c_m$。$Z(t)$ 是 Zeldovich 因子，$f^+(n^*,t)$ 是单体附着到临界核的频率。\n\nZeldovich 因子 $Z(t)$ 解释了位于势垒顶部的团簇中继续生长的部分。它与 $\\Delta G(n)$ 曲线在 $n=n^*$ 处的曲率有关：\n$$\nZ(t) = \\sqrt{-\\frac{1}{2\\pi k_B T} \\left. \\frac{\\partial^2 \\Delta G}{\\partial n^2} \\right|_{n=n^*}} = \\sqrt{\\frac{\\Delta G^*(t)}{3\\pi k_B T (n^*(t))^2}}\n$$\n对于扩散限制的过程，附着频率 $f^+(n^*,t)$ 是单体到达临界核表面的速率。对于半径为 $r^*(t)$ 的球形汇，这由 Smoluchowski 速率给出：\n$$\nf^+(n^*,t) = 4\\pi D c_m r^*(t)\n$$\n其中 $D$ 是单体扩散系数，$c_m$ 是单体数密度。\n\n结合这些表达式，对于 $S(t)>1$ 时随时间变化的成核速率 $J(t)$ 的最终公式是：\n$$\nJ(t) = c_m \\left(\\sqrt{\\frac{\\Delta G^*(t)}{3\\pi k_B T (n^*(t))^2}}\\right) \\left(4\\pi D c_m r^*(t)\\right) \\exp\\left(-\\frac{\\Delta G^*(t)}{k_B T}\\right)\n$$\n对于 $S(t) \\le 1$，驱动力 $\\Delta \\mu(t) \\le 0$，成核势垒为无穷大或不明确。物理上，不会发生自发成核，因此 $J(t)=0$。\n\n**3. 累积核数**\n\n到达时间 $t_{\\text{end}}$ 时单位体积内形成的总核数，记为 $N(t_{\\text{end}})$，是成核速率的时间积分：\n$$\nN(t_{\\text{end}}) = \\int_0^{t_{\\text{end}}} J(t') dt'\n$$\n这个积分必须数值计算，因为 $J(t')$ 通过其对 $S(t')$ 的依赖性，是时间的复杂非线性函数。我们可以使用数值积分方法，例如 `scipy.integrate.quad` 提供的方法。\n\n**4. 数值实现**\n\n每个测试用例的计算过程如下：\n1. 定义一个函数 `J_rate(t, params)`，它根据给定的时间 $t$ 和该案例的一组物理参数来计算成核速率 $J$。该函数首先计算 $S(t)$，然后检查是否 $S(t)>1$。如果是，则使用推导出的公式计算 $\\Delta \\mu(t), r^*(t), n^*(t), \\Delta G^*(t), Z(t), f^+(n^*,t)$，最后计算 $J(t)$。如果 $S(t)\\le 1$，则返回 0。\n2. 通过调用 `J_rate(t_end, params)` 来计算最终时刻的瞬时成核速率 $J(t_{\\text{end}})$。\n3. 通过对 `J_rate(t', params)` 从 $t'=0$ 到 $t'=t_{\\text{end}}$ 进行数值积分，计算累积核数 $N(t_{\\text{end}})$。为了优化，如果 $t_{\\text{end}} > \\tau$，积分可以在 $t=\\tau$ 处分开。从 $\\tau$ 到 $t_{\\text{end}}$ 的积分很简单，因为在此区间内 $J(t')$ 是常数。\n$$\nN(t_{\\text{end}}) = \\int_0^{\\min(t_{\\text{end}}, \\tau)} J(t') dt' + \\begin{cases} J(t_{\\text{end}}) \\cdot (t_{\\text{end}} - \\tau)  \\text{if } t_{\\text{end}} > \\tau \\\\ 0  \\text{if } t_{\\text{end}} \\le \\tau \\end{cases}\n$$\n第一项使用数值积分计算。第二项是针对恒定速率阶段的解析加法。\n将此过程应用于每个测试用例，以生成所需的输出值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Classical Nucleation Theory problem for several test cases.\n    \"\"\"\n    # SI units are used throughout.\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    test_cases = [\n        # Case A\n        {'gamma': 0.2, 'vm': 1.0e-28, 'D': 1.0e-9, 'cm': 1.0e+26, 'T': 298.0,\n         'Si': 1.01, 'Sf': 1.5, 'tau': 100.0, 't_end': 200.0},\n        # Case B\n        {'gamma': 0.2, 'vm': 1.0e-28, 'D': 1.0e-9, 'cm': 1.0e+26, 'T': 298.0,\n         'Si': 0.99, 'Sf': 1.02, 'tau': 50.0, 't_end': 50.0},\n        # Case C\n        {'gamma': 0.05, 'vm': 1.0e-28, 'D': 2.0e-9, 'cm': 5.0e+26, 'T': 298.0,\n         'Si': 1.1, 'Sf': 3.0, 'tau': 10.0, 't_end': 10.0},\n        # Case D\n        {'gamma': 0.1, 'vm': 8.0e-29, 'D': 1.0e-9, 'cm': 2.0e+26, 'T': 323.0,\n         'Si': 1.02, 'Sf': 2.0, 'tau': 200.0, 't_end': 500.0},\n    ]\n\n    all_results = []\n\n    def j_rate_integrand(t, gamma, vm, D, cm, T, Si, Sf, tau):\n        \"\"\"\n        Calculates the instantaneous nucleation rate J(t) based on CNT.\n        All parameters are passed as arguments for use with scipy.integrate.quad.\n        \"\"\"\n        # 1. Calculate supersaturation S(t)\n        if t  tau:\n            # Avoid division by zero if tau is 0, though problem constraints make it positive.\n            if tau > 0:\n                S = Si + (Sf - Si) * (t / tau)\n            else:\n                S = Sf\n        else:\n            S = Sf\n\n        # 2. Nucleation only occurs for S > 1\n        if S = 1.0:\n            return 0.0\n\n        # 3. Calculate thermodynamic and kinetic quantities\n        thermal_energy = k_B * T\n        delta_mu = thermal_energy * np.log(S)\n\n        # Nucleation barrier\n        delta_G_star = (16.0 * np.pi * gamma**3 * vm**2) / (3.0 * delta_mu**2)\n\n        # exponent can be large and negative, leading to underflow to 0, which is correct.\n        if (-delta_G_star / thermal_energy)  -700: # np.exp limit\n            return 0.0\n\n        # Critical radius\n        r_star = (2.0 * gamma * vm) / delta_mu\n\n        # Critical cluster size\n        n_star = (4.0/3.0) * np.pi * r_star**3 / vm\n        if n_star = 0: # Should not happen if S>1\n            return 0.0\n        \n        # Zeldovich factor\n        Z = np.sqrt(delta_G_star / (3.0 * np.pi * thermal_energy * n_star**2))\n\n        # Monomer attachment frequency\n        f_plus = 4.0 * np.pi * D * r_star * cm\n        \n        # Number density of nucleation sites is given as c_m\n        ns = cm\n\n        # Steady-state nucleation rate J(t)\n        Jt = ns * Z * f_plus * np.exp(-delta_G_star / thermal_energy)\n\n        return Jt\n\n    for case in test_cases:\n        params = (case['gamma'], case['vm'], case['D'], case['cm'], case['T'],\n                  case['Si'], case['Sf'], case['tau'])\n        \n        t_end = case['t_end']\n        tau = case['tau']\n\n        # Calculate instantaneous nucleation rate at t_end\n        J_tend = j_rate_integrand(t_end, *params)\n        all_results.append(J_tend)\n\n        # Calculate cumulative nuclei number N(t_end)\n        # Part 1: Integral over the ramp phase [0, min(t_end, tau)]\n        integral_end = min(t_end, tau)\n        N_integral_part = 0.0\n        if integral_end > 0:\n            # Use quad for numerical integration\n            N_integral_part, _ = integrate.quad(\n                j_rate_integrand, 0, integral_end, args=params\n            )\n\n        # Part 2: Contribution from the constant supersaturation phase, if applicable\n        N_const_part = 0.0\n        if t_end > tau:\n            # J_tend is the rate J(S_f) since t_end > tau\n            N_const_part = J_tend * (t_end - tau)\n            \n        N_tend = N_integral_part + N_const_part\n        all_results.append(N_tend)\n\n    # Format the final output string as required\n    print(f\"[{','.join(f'{r:.6e}' for r in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}