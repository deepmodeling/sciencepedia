{
    "hands_on_practices": [
        {
            "introduction": "Reaction path modeling often begins by identifying the most energetically favorable reactions. In systems with multiple redox-active species, these reactions follow a predictable sequence based on their reduction potentials, a concept visualized as a \"redox ladder\". This foundational exercise  challenges you to apply the Nernst equation to construct such a ladder for a hypothetical aqueous system, thereby determining the order of electron acceptor consumption and quantifying the extent of reaction.",
            "id": "4097802",
            "problem": "A closed, isothermal aqueous system of volume $1.000\\ \\mathrm{L}$ at $25^{\\circ}\\ \\mathrm{C}$ and fixed $\\mathrm{pH}=7.00$ is initially well-mixed and buffered such that $a_{\\mathrm{H}^{+}}=10^{-7}$ and activity coefficients are approximately unity for all dissolved species. Consider the irreversible oxidation of generic organic carbon represented by $\\mathrm{CH_{2}O}$ proceeding along a thermodynamically controlled reaction path in which, at any point, the electron acceptor with the highest effective reduction potential (at the prevailing activities) is utilized until it is exhausted. The system initially contains the following total amounts (all as dissolved aqueous species unless otherwise noted): dissolved molecular oxygen $\\mathrm{O_{2}(aq)}$ with $n_{\\mathrm{O_{2}}}=2.80\\times 10^{-4}\\ \\mathrm{mol}$, nitrate $\\mathrm{NO_{3}^{-}}$ with $n_{\\mathrm{NO_{3}^{-}}}=1.56\\times 10^{-3}\\ \\mathrm{mol}$, and sulfate $\\mathrm{SO_{4}^{2-}}$ with $n_{\\mathrm{SO_{4}^{2-}}}=1.00\\times 10^{-2}\\ \\mathrm{mol}$. Assume nitrogen gas $\\mathrm{N_{2}}$ has fugacity $f_{\\mathrm{N_{2}}}=1.00$ and the reduced sulfur product is bisulfide $\\mathrm{HS^{-}}$ with an initially negligible activity. Water activity is $a_{\\mathrm{H_{2}O}}=1$.\n\nStarting from fundamental redox half-reaction definitions and the Nernst equation, construct the thermodynamic redox ladder at $\\mathrm{pH}=7.00$ for the three electron-accepting couples $\\mathrm{O_{2}/H_{2}O}$, $\\mathrm{NO_{3}^{-}/N_{2}}$, and $\\mathrm{SO_{4}^{2-}/HS^{-}}$ at the stated conditions, and identify the sequence in which they will be utilized during oxidation of $\\mathrm{CH_{2}O}$ under thermodynamic control. Then, using electron-equivalent stoichiometry derived from balanced half-reactions, determine the cumulative amount of $\\mathrm{CH_{2}O}$ (in millimoles) that will be oxidized when sulfate reduction first becomes the dominant electron-accepting step along the reaction path (i.e., immediately after all prior, higher-potential acceptors are exhausted but before any measurable consumption of sulfate). Express your final answer in millimoles and round to three significant figures.",
            "solution": "The problem requires a two-part solution. First, we must construct the thermodynamic redox ladder for the given electron acceptors at the specified conditions to determine the sequence of their utilization. Second, we must calculate the total amount of organic matter, represented as $\\mathrm{CH_{2}O}$, that is oxidized up to the point where sulfate reduction begins. This corresponds to the complete consumption of all electron acceptors with a higher reduction potential than the sulfate/bisulfide couple.\n\nThe analysis is performed for a closed, isothermal aqueous system at a temperature $T = 25^{\\circ}\\ \\mathrm{C}$ ($298.15\\ \\mathrm{K}$) and a fixed $\\mathrm{pH} = 7.00$, which implies the activity of hydrogen ions is $a_{\\mathrm{H}^{+}} = 10^{-7}$. The volume of the system is $V = 1.000\\ \\mathrm{L}$. Activity coefficients are assumed to be unity, so the activity $a_i$ of a dissolved species $i$ is equal to its molar concentration $M_i$. Given the volume is $1.000\\ \\mathrm{L}$, the activity is numerically equal to the number of moles.\n\nInitial activities of the electron acceptors are:\n$a_{\\mathrm{O_{2}}} = M_{\\mathrm{O_{2}}} = \\frac{2.80\\times 10^{-4}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 2.80\\times 10^{-4}$\n$a_{\\mathrm{NO_{3}^{-}}} = M_{\\mathrm{NO_{3}^{-}}} = \\frac{1.56\\times 10^{-3}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 1.56\\times 10^{-3}$\n$a_{\\mathrm{SO_{4}^{2-}}} = M_{\\mathrm{SO_{4}^{2-}}} = \\frac{1.00\\times 10^{-2}\\ \\mathrm{mol}}{1.000\\ \\mathrm{L}} = 1.00\\times 10^{-2}$\nOther specified activities are $a_{\\mathrm{H_{2}O}} = 1$ and the fugacity of nitrogen gas $f_{\\mathrm{N_{2}}} = 1.00$.\n\nPart 1: Thermodynamic Redox Ladder\n\nThe sequence of electron acceptor utilization is determined by the effective reduction potential, $E_h$, of each redox couple under the prevailing conditions. The couple with the highest $E_h$ provides the most energy when coupled with the oxidation of organic matter and will be utilized first. We calculate $E_h$ using the Nernst equation:\n$$E_{h} = E^{0} - \\frac{RT}{nF} \\ln Q = E^{0} - \\frac{2.303RT}{nF} \\log_{10} Q$$\nwhere $E^0$ is the standard reduction potential, $R$ is the ideal gas constant ($8.314\\ \\mathrm{J}\\cdot\\mathrm{mol}^{-1}\\cdot\\mathrm{K}^{-1}$), $T$ is the absolute temperature ($298.15\\ \\mathrm{K}$), $n$ is the number of electrons transferred in the half-reaction, $F$ is the Faraday constant ($96485\\ \\mathrm{C}\\cdot\\mathrm{mol}^{-1}$), and $Q$ is the reaction quotient. The term $\\frac{2.303RT}{F}$ at $25^{\\circ}\\ \\mathrm{C}$ is approximately $0.05916\\ \\mathrm{V}$.\n\nWe will now calculate $E_h$ for each of the three electron-accepting couples.\n\n1.  Oxygen/Water couple ($\\mathrm{O_{2}/H_{2}O}$):\n    The reduction half-reaction and its standard potential are:\n    $$\\mathrm{O_{2}}(aq) + 4\\mathrm{H}^{+} + 4e^{-} \\rightarrow 2\\mathrm{H_{2}O}$$\n    with $E^0 = +1.229\\ \\mathrm{V}$. The number of electrons transferred is $n=4$.\n    The reaction quotient is $Q = \\frac{(a_{\\mathrm{H_2O}})^2}{(a_{\\mathrm{O_2}})(a_{\\mathrm{H^+}})^4}$.\n    Using the given activities:\n    $Q = \\frac{1^2}{(2.80 \\times 10^{-4})(10^{-7})^4} = \\frac{1}{2.80 \\times 10^{-32}} \\approx 3.571 \\times 10^{31}$.\n    The reduction potential is:\n    $E_{h, \\mathrm{O_2}} = 1.229\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{4} \\log_{10}(3.571 \\times 10^{31})$\n    $E_{h, \\mathrm{O_2}} = 1.229 - 0.01479 \\times (31.553) = 1.229 - 0.467 = +0.762\\ \\mathrm{V}$.\n\n2.  Nitrate/Nitrogen couple ($\\mathrm{NO_{3}^{-}/N_{2}}$):\n    The reduction half-reaction and its standard potential are:\n    $$2\\mathrm{NO_{3}^{-}} + 12\\mathrm{H}^{+} + 10e^{-} \\rightarrow \\mathrm{N_{2}}(g) + 6\\mathrm{H_{2}O}$$\n    with $E^0 = +1.246\\ \\mathrm{V}$. The number of electrons transferred is $n=10$.\n    The reaction quotient is $Q = \\frac{f_{\\mathrm{N_2}}(a_{\\mathrm{H_2O}})^6}{(a_{\\mathrm{NO_3^-}})^2(a_{\\mathrm{H^+}})^{12}}$.\n    Using the given activities/fugacity:\n    $Q = \\frac{1.00 \\times 1^6}{(1.56 \\times 10^{-3})^2 (10^{-7})^{12}} = \\frac{1}{(2.4336 \\times 10^{-6})(10^{-84})} = \\frac{1}{2.4336 \\times 10^{-90}} \\approx 4.109 \\times 10^{89}$.\n    The reduction potential is:\n    $E_{h, \\mathrm{NO_3^-}} = 1.246\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{10} \\log_{10}(4.109 \\times 10^{89})$\n    $E_{h, \\mathrm{NO_3^-}} = 1.246 - 0.005916 \\times (89.614) = 1.246 - 0.530 = +0.716\\ \\mathrm{V}$.\n\n3.  Sulfate/Bisulfide couple ($\\mathrm{SO_{4}^{2-}/HS^{-}}$):\n    The reduction half-reaction and its standard potential are:\n    $$\\mathrm{SO_{4}^{2-}} + 9\\mathrm{H}^{+} + 8e^{-} \\rightarrow \\mathrm{HS^{-}} + 4\\mathrm{H_{2}O}$$\n    with $E^0 = +0.303\\ \\mathrm{V}$. The number of electrons transferred is $n=8$.\n    The problem states that the initial activity of the reduced product, $\\mathrm{HS^{-}}$, is negligible. To calculate a finite potential, a non-zero activity must be assumed. We will adopt a common convention in geochemical modeling and assume a threshold activity of $a_{\\mathrm{HS^{-}}} = 10^{-6}$ for the process to be considered active.\n    The reaction quotient is $Q = \\frac{a_{\\mathrm{HS^-}}(a_{\\mathrm{H_2O}})^4}{a_{\\mathrm{SO_4^{2-}}}(a_{\\mathrm{H^+}})^9}$.\n    Using the given activities and our assumption:\n    $Q = \\frac{10^{-6} \\times 1^4}{(1.00 \\times 10^{-2})(10^{-7})^9} = \\frac{10^{-6}}{10^{-2} \\times 10^{-63}} = \\frac{10^{-6}}{10^{-65}} = 10^{59}$.\n    The reduction potential is:\n    $E_{h, \\mathrm{SO_4^{2-}}} = 0.303\\ \\mathrm{V} - \\frac{0.05916\\ \\mathrm{V}}{8} \\log_{10}(10^{59})$\n    $E_{h, \\mathrm{SO_4^{2-}}} = 0.303 - 0.007395 \\times 59 = 0.303 - 0.436 = -0.133\\ \\mathrm{V}$.\n\nComparing the calculated potentials:\n$E_{h, \\mathrm{O_2}} = +0.762\\ \\mathrm{V}$\n$E_{h, \\mathrm{NO_3^-}} = +0.716\\ \\mathrm{V}$\n$E_{h, \\mathrm{SO_4^{2-}}} = -0.133\\ \\mathrm{V}$\n\nSince $E_{h, \\mathrm{O_2}} > E_{h, \\mathrm{NO_3^-}} > E_{h, \\mathrm{SO_4^{2-}}}$, the thermodynamic sequence for electron acceptor utilization during the oxidation of $\\mathrm{CH_2O}$ is:\n1. Aerobic respiration ($\\mathrm{O_2}$ consumption)\n2. Denitrification ($\\mathrm{NO_3^-}$ consumption)\n3. Sulfate reduction ($\\mathrm{SO_4^{2-}}$ consumption)\n\nPart 2: Calculation of Oxidized $\\mathrm{CH_2O}$\n\nWe need to find the total amount of $\\mathrm{CH_{2}O}$ oxidized when sulfate reduction first becomes the dominant process. This occurs when all the higher-potential acceptors, $\\mathrm{O_2}$ and $\\mathrm{NO_3^-}$, have been fully consumed. We can solve this by balancing the total electrons released by $\\mathrm{CH_{2}O}$ oxidation with the total electrons accepted by $\\mathrm{O_2}$ and $\\mathrm{NO_3^-}$.\n\nFirst, the oxidation half-reaction for $\\mathrm{CH_{2}O}$ (where carbon has an oxidation state of $0$) to a product where carbon has an oxidation state of $+4$ (e.g., $\\mathrm{CO_{2}}$ or $\\mathrm{HCO_3^-}$) releases $4$ electrons:\n$$\\mathrm{CH_{2}O} + \\mathrm{H_{2}O} \\rightarrow \\mathrm{CO_{2}} + 4\\mathrm{H}^{+} + 4e^{-}$$\nThus, the oxidation of $1$ mole of $\\mathrm{CH_{2}O}$ releases $4$ moles of electrons.\n\nNext, we calculate the total electron-accepting capacity of the available $\\mathrm{O_2}$ and $\\mathrm{NO_3^-}$.\n\n-   Electrons accepted by $\\mathrm{O_2}$:\n    The half-reaction $\\mathrm{O_{2}} + 4\\mathrm{H}^{+} + 4e^{-} \\rightarrow 2\\mathrm{H_{2}O}$ shows that $1$ mole of $\\mathrm{O_2}$ accepts $4$ moles of electrons.\n    Total electrons from $\\mathrm{O_2}$:\n    $n_{e^-, \\mathrm{O_2}} = n_{\\mathrm{O_{2}}} \\times 4 = (2.80 \\times 10^{-4}\\ \\mathrm{mol}) \\times 4 = 1.12 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$.\n\n-   Electrons accepted by $\\mathrm{NO_3^-}$:\n    The half-reaction for denitrification to $\\mathrm{N_2}$ is $2\\mathrm{NO_{3}^{-}} + 12\\mathrm{H}^{+} + 10e^{-} \\rightarrow \\mathrm{N_{2}} + 6\\mathrm{H_{2}O}$. This shows that $2$ moles of $\\mathrm{NO_3^-}$ accept $10$ moles of electrons, or $1$ mole of $\\mathrm{NO_3^-}$ accepts $5$ moles of electrons.\n    Total electrons from $\\mathrm{NO_3^-}$:\n    $n_{e^-, \\mathrm{NO_3^-}} = n_{\\mathrm{NO_{3}^{-}}} \\times 5 = (1.56 \\times 10^{-3}\\ \\mathrm{mol}) \\times 5 = 7.80 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$.\n\nThe total moles of electrons accepted before sulfate reduction begins is the sum of the above:\n$n_{e^-, \\text{total}} = n_{e^-, \\mathrm{O_2}} + n_{e^-, \\mathrm{NO_3^-}} = 1.12 \\times 10^{-3} + 7.80 \\times 10^{-3} = 8.92 \\times 10^{-3}\\ \\mathrm{mol}\\ e^{-}$.\n\nThis total must be equal to the moles of electrons released from the oxidation of $\\mathrm{CH_{2}O}$.\n$n_{e^-, \\text{total}} = n_{\\mathrm{CH_2O}} \\times 4$.\nTherefore, the total moles of $\\mathrm{CH_{2}O}$ oxidized is:\n$n_{\\mathrm{CH_2O}} = \\frac{n_{e^-, \\text{total}}}{4} = \\frac{8.92 \\times 10^{-3}\\ \\mathrm{mol}}{4} = 2.23 \\times 10^{-3}\\ \\mathrm{mol}$.\n\nThe problem asks for the answer in millimoles, rounded to three significant figures.\n$1\\ \\mathrm{mmol} = 10^{-3}\\ \\mathrm{mol}$.\n$n_{\\mathrm{CH_2O}} = 2.23\\ \\mathrm{mmol}$.\nThis value is already expressed to three significant figures.",
            "answer": "$$\\boxed{2.23}$$"
        },
        {
            "introduction": "While thermodynamics predicts the direction of a reaction, kinetics dictates its rate. A crucial parameter in kinetic rate laws for mineral-fluid interactions is the reactive surface area, $A_{\\text{react}}$, which dynamically changes as a mineral dissolves or precipitates. This practice  delves into this complexity by asking you to derive and compare the outcomes of different models for $A_{\\text{react}}$ evolution, revealing how model assumptions can dramatically alter predicted reaction timescales.",
            "id": "4097825",
            "problem": "Consider a closed, isothermal batch reactor containing a single dissolving mineral phase with no precipitation. Let $m(t)$ denote the mineral mass (in $\\mathrm{kg}$) at time $t$ (in $\\mathrm{s}$), and let $A_{\\text{react}}(t)$ denote the reactive surface area (in $\\mathrm{m^2}$) available for dissolution. Assume a first-order dependence of the mass loss rate on the reactive surface area via the rate law $\\,\\dfrac{dm}{dt} = -k\\,A_{\\text{react}}(t)\\,$ where $k$ is a constant with units $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$. Let the initial conditions be $m(0) = m_0$ (in $\\mathrm{kg}$), $A_{\\text{react}}(0) = A_0$ (in $\\mathrm{m^2}$), and the mineral density be $\\rho$ (in $\\mathrm{kg\\,m^{-3}}$). The reactor volume contains sufficient solvent such that there is no transport limitation and the rate constant $k$ remains time-invariant.\n\nDefine and compare three models for $A_{\\text{react}}(t)$ along the reaction path:\n- Volume-scaling model: $A_{\\text{react}}(t) = A_0 \\left(\\dfrac{V(t)}{V_0}\\right)$, where $V(t) = \\dfrac{m(t)}{\\rho}$ and $V_0 = \\dfrac{m_0}{\\rho}$.\n- Mass-scaling model: $A_{\\text{react}}(t) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)$.\n- Fractal-exponent model: $A_{\\text{react}}(t;p) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)^{p}$ with a constant exponent $p$ satisfying $0 \\le p \\le 1$.\n\nStarting only from the given rate law, mass conservation, and the above definitions, derive the time evolution of $m(t)$ for each model and obtain the integrated rate $R_{\\text{int}}(T) = \\int_{0}^{T} k\\,A_{\\text{react}}(t)\\,dt$ over a finite duration $T$ (in $\\mathrm{s}$). Express $R_{\\text{int}}(T)$ in $\\mathrm{kg}$. Enforce physical realism by requiring $m(t) \\ge 0$ for all $t$, and if complete dissolution occurs before $T$, then $R_{\\text{int}}(T)$ must equal $m_0$.\n\nYour task is to implement a program that computes $R_{\\text{int}}(T)$ for the following five test cases. Use the specified parameters as given, with all quantities in the indicated units. The final numerical outputs must be rounded to six decimal places and expressed in $\\mathrm{kg}$.\n\nTest Suite:\n1. Volume-scaling model with $m_0 = 0.5$, $\\rho = 2650$, $A_0 = 0.02$, $k = 0.000001$, $T = 10000000$.\n2. Mass-scaling model with $m_0 = 0.5$, $\\rho = 2650$, $A_0 = 0.02$, $k = 0.000001$, $T = 10000000$.\n3. Fractal-exponent model with $p = 0.8$ and $m_0 = 0.5$, $\\rho = 2650$, $A_0 = 0.02$, $k = 0.000001$, $T = 10000000$.\n4. Fractal-exponent model with $p = 0.8$ and $m_0 = 0.5$, $\\rho = 2650$, $A_0 = 0.02$, $k = 0.000001$, $T = 130000000$.\n5. Fractal-exponent model with $p = 0.0$ and $m_0 = 0.1$, $\\rho = 2650$, $A_0 = 0.01$, $k = 0.000002$, $T = 10000000$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each \"result\" must be the integrated rate $R_{\\text{int}}(T)$ in $\\mathrm{kg}$ for the corresponding test case, rounded to six decimal places.",
            "solution": "The user-provided problem statement has been validated and is determined to be self-contained, scientifically grounded, and well-posed. The derivation of the solution proceeds as follows.\n\n### 1. Analysis of Reactive Surface Area Models\n\nThe problem defines three models for the reactive surface area, $A_{\\text{react}}(t)$. These models relate the surface area to the remaining mineral mass, $m(t)$.\n\nFirst, we analyze the **Volume-scaling model**. It is defined as:\n$$A_{\\text{react}}(t) = A_0 \\left(\\dfrac{V(t)}{V_0}\\right)$$\nwhere $V(t) = m(t)/\\rho$ is the mineral volume at time $t$, and $V_0 = m_0/\\rho$ is the initial volume. Substituting these definitions yields:\n$$A_{\\text{react}}(t) = A_0 \\left(\\dfrac{m(t)/\\rho}{m_0/\\rho}\\right) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)$$\nThis expression is identical to the definition provided for the **Mass-scaling model**:\n$$A_{\\text{react}}(t) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)$$\nTherefore, the Volume-scaling and Mass-scaling models are equivalent representations of the same physical assumption.\n\nThe third model, the **Fractal-exponent model**, generalizes this relationship:\n$$A_{\\text{react}}(t;p) = A_0 \\left(\\dfrac{m(t)}{m_0}\\right)^{p}$$\nwhere $p$ is a constant exponent in the range $0 \\le p \\le 1$.\nIt is evident that the Volume-scaling and Mass-scaling models are special cases of the Fractal-exponent model where $p=1$. The case $p=0$ corresponds to a constant reactive surface area, $A_{\\text{react}}(t) = A_0$. The case $p=2/3$ would correspond to the dissolution of a mineral with a simple, non-fractal geometry (e.g., a sphere or cube) that maintains its shape as it shrinks.\n\n### 2. Derivation of the Time Evolution of Mineral Mass $m(t)$\n\nThe starting point is the fundamental rate law for mass loss:\n$$\\dfrac{dm}{dt} = -k\\,A_{\\text{react}}(t)$$\nSubstituting the general Fractal-exponent model for $A_{\\text{react}}(t)$:\n$$\\dfrac{dm}{dt} = -k A_0 \\left(\\dfrac{m}{m_0}\\right)^{p} = -\\left(\\dfrac{kA_0}{m_0^p}\\right) m^p$$\nThis is a separable ordinary differential equation. We can solve for $m(t)$ by integrating, subject to the initial condition $m(0) = m_0$. The solution depends on the value of $p$.\n\n**Case I: $p=1$ (Volume-scaling and Mass-scaling models)**\nFor $p=1$, the differential equation becomes:\n$$\\dfrac{dm}{dt} = -\\left(\\dfrac{kA_0}{m_0}\\right) m$$\nIntegrating this first-order linear ODE:\n$$\\int_{m_0}^{m(t)} \\dfrac{1}{m'} dm' = \\int_{0}^{t} -\\left(\\dfrac{kA_0}{m_0}\\right) dt'$$\n$$[\\ln(m')]_{m_0}^{m(t)} = -\\left(\\dfrac{kA_0}{m_0}\\right) t$$\n$$\\ln\\left(\\dfrac{m(t)}{m_0}\\right) = -\\left(\\dfrac{kA_0 t}{m_0}\\right)$$\nExponentiating both sides gives the solution for $m(t)$:\n$$m(t) = m_0 \\exp\\left(-\\dfrac{kA_0 t}{m_0}\\right)$$\nIn this model, the mass decays exponentially and approaches $0$ only as $t \\to \\infty$. Complete dissolution does not occur in finite time.\n\n**Case II: $p \\ne 1$ (Fractal-exponent model with $0 \\le p  1$)**\nFor $p \\ne 1$, we separate variables:\n$$m^{-p} dm = -\\left(\\dfrac{kA_0}{m_0^p}\\right) dt$$\nIntegrating from $t=0$ to $t$:\n$$\\int_{m_0}^{m(t)} m'^{-p} dm' = \\int_{0}^{t} -\\left(\\dfrac{kA_0}{m_0^p}\\right) dt'$$\n$$\\left[ \\dfrac{m'^{1-p}}{1-p} \\right]_{m_0}^{m(t)} = -\\left(\\dfrac{kA_0}{m_0^p}\\right) t$$\n$$\\dfrac{m(t)^{1-p} - m_0^{1-p}}{1-p} = -\\dfrac{kA_0 t}{m_0^p}$$\n$$m(t)^{1-p} = m_0^{1-p} - (1-p)\\dfrac{kA_0 t}{m_0^p}$$\nSince $0 \\le p  1$, the exponent $(1-p)$ is positive. Thus, we can solve for $m(t)$:\n$$m(t) = \\left[ m_0^{1-p} - (1-p)k A_0 m_0^{-p} t \\right]^{\\frac{1}{1-p}}$$\nThis solution is physically valid as long as the term in brackets is non-negative. Complete dissolution occurs at a finite time, $t_{\\text{diss}}$, when $m(t_{\\text{diss}}) = 0$.\n$$0 = m_0^{1-p} - (1-p)k A_0 m_0^{-p} t_{\\text{diss}}$$\n$$t_{\\text{diss}} = \\dfrac{m_0^{1-p} m_0^p}{(1-p)k A_0} = \\dfrac{m_0}{(1-p)k A_0}$$\nA more elegant form for $m(t)$ can be obtained by substituting $t_{\\text{diss}}$:\n$$m(t)^{1-p} = m_0^{1-p} \\left(1 - \\dfrac{(1-p)k A_0 m_0^{-p} t}{m_0^{1-p}}\\right) = m_0^{1-p} \\left(1 - \\dfrac{t}{t_{\\text{diss}}}\\right)$$\n$$m(t) = m_0 \\left( 1 - \\dfrac{t}{t_{\\text{diss}}} \\right)^{\\frac{1}{1-p}}$$\nThis form is valid for $t \\le t_{\\text{diss}}$. For $t  t_{\\text{diss}}$, the mass remains zero, so $m(t)=0$.\n\n### 3. Calculation of the Integrated Rate $R_{\\text{int}}(T)$\n\nThe problem defines the integrated rate as $R_{\\text{int}}(T) = \\int_{0}^{T} k\\,A_{\\text{react}}(t)\\,dt$. We can use the original rate law, $k\\,A_{\\text{react}}(t) = -dm/dt$, to simplify this integral:\n$$R_{\\text{int}}(T) = \\int_{0}^{T} \\left(-\\dfrac{dm}{dt}\\right) dt = -\\int_{m(0)}^{m(T)} dm = -[m(T) - m(0)] = m_0 - m(T)$$\nThis shows that $R_{\\text{int}}(T)$ is simply the total mass of mineral dissolved over the time interval $[0, T]$.\n\nWe must account for the physical constraint $m(t) \\ge 0$.\nIf dissolution completes at $t_{\\text{diss}}  T$, then the mass at time $T$ is $m(T)=0$.\nThus, $R_{\\text{int}}(T) = m_0 - 0 = m_0$, consistent with the problem statement.\nIn general, the final mass is $m(T) = \\max(0, m_{\\text{calc}}(T))$, where $m_{\\text{calc}}(T)$ is the value obtained from the derived analytical solutions. Therefore, the integrated rate is:\n$$R_{\\text{int}}(T) = m_0 - \\max(0, m_{\\text{calc}}(T))$$\n\n### 4. Application to Test Cases\n\nWe apply these formulas to compute $R_{\\text{int}}(T)$ for each test case.\n\n**Test Cases 1 and 2 ($p=1$):**\n- Parameters: $m_0 = 0.5$, $A_0 = 0.02$, $k = 10^{-6}$, $T = 10^7$.\n- The model is first-order decay, no finite dissolution time.\n- We calculate $m(T)$ using $m(t) = m_0 \\exp\\left(-\\dfrac{kA_0 t}{m_0}\\right)$.\n- The argument of the exponential is $\\dfrac{k A_0 T}{m_0} = \\dfrac{(10^{-6})(0.02)(10^7)}{0.5} = \\dfrac{0.2}{0.5} = 0.4$.\n- $m(T) = 0.5 \\exp(-0.4)$.\n- $R_{\\text{int}}(T) = m_0 - m(T) = 0.5 - 0.5 \\exp(-0.4) = 0.5(1 - \\exp(-0.4)) \\approx 0.164840\\ \\mathrm{kg}$.\n- Since the Volume-scaling and Mass-scaling models were shown to be equivalent, the result for test cases $1$ and $2$ will be identical.\n\n**Test Case 3 ($p=0.8$):**\n- Parameters: $m_0 = 0.5$, $A_0 = 0.02$, $k = 10^{-6}$, $T = 10^7$, $p=0.8$.\n- First, calculate the time to complete dissolution:\n  $t_{\\text{diss}} = \\dfrac{m_0}{(1-p)k A_0} = \\dfrac{0.5}{(1-0.8)(10^{-6})(0.02)} = \\dfrac{0.5}{0.2 \\times 2 \\times 10^{-8}} = 1.25 \\times 10^8\\ \\mathrm{s}$.\n- Since $T = 10^7  t_{\\text{diss}}$, the mineral has not fully dissolved.\n- We calculate $m(T)$ using $m(t) = m_0 \\left( 1 - \\dfrac{t}{t_{\\text{diss}}} \\right)^{\\frac{1}{1-p}}$.\n- The exponent is $\\frac{1}{1-p} = \\frac{1}{1-0.8} = \\frac{1}{0.2} = 5$.\n- $m(T) = 0.5 \\left( 1 - \\dfrac{10^7}{1.25 \\times 10^8} \\right)^5 = 0.5 \\left( 1 - 0.08 \\right)^5 = 0.5(0.92)^5$.\n- $R_{\\text{int}}(T) = m_0 - m(T) = 0.5 - 0.5(0.92)^5 = 0.5(1 - (0.92)^5) \\approx 0.170460\\ \\mathrm{kg}$.\n\n**Test Case 4 ($p=0.8$):**\n- Parameters: $m_0 = 0.5$, $A_0 = 0.02$, $k = 10^{-6}$, $T = 1.3 \\times 10^8$, $p=0.8$.\n- The dissolution time is the same as in Case 3: $t_{\\text{diss}} = 1.25 \\times 10^8\\ \\mathrm{s}$.\n- Here, $T = 1.3 \\times 10^8  t_{\\text{diss}}$. The mineral has completely dissolved before time $T$.\n- Therefore, $m(T)=0$.\n- $R_{\\text{int}}(T) = m_0 - 0 = m_0 = 0.5\\ \\mathrm{kg}$.\n\n**Test Case 5 ($p=0.0$):**\n- Parameters: $m_0 = 0.1$, $A_0 = 0.01$, $k = 2 \\times 10^{-6}$, $T = 10^7$, $p=0.0$.\n- This corresponds to a constant reactive area and thus a constant dissolution rate (zero-order kinetics).\n- The time to complete dissolution is:\n  $t_{\\text{diss}} = \\dfrac{m_0}{(1-p)k A_0} = \\dfrac{0.1}{(1-0.0)(2 \\times 10^{-6})(0.01)} = \\dfrac{0.1}{2 \\times 10^{-8}} = 5 \\times 10^6\\ \\mathrm{s}$.\n- Since $T = 10^7  t_{\\text{diss}}$, the mineral has completely dissolved.\n- Therefore, $m(T)=0$.\n- $R_{\\text{int}}(T) = m_0 - 0 = m_0 = 0.1\\ \\mathrm{kg}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the integrated reaction rate R_int(T) for a series of\n    mineral dissolution scenarios in a batch reactor.\n    \"\"\"\n\n    # Test suite:\n    # Each tuple contains:\n    # (model_name, m0, A0, k, T, p)\n    # where p is the fractal exponent. The unused rho parameter is omitted.\n    test_cases = [\n        (\"volume-scaling\", 0.5, 0.02, 0.000001, 10000000, None),\n        (\"mass-scaling\", 0.5, 0.02, 0.000001, 10000000, None),\n        (\"fractal-exponent\", 0.5, 0.02, 0.000001, 10000000, 0.8),\n        (\"fractal-exponent\", 0.5, 0.02, 0.000001, 130000000, 0.8),\n        (\"fractal-exponent\", 0.1, 0.01, 0.000002, 10000000, 0.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        model_name, m0, A0, k, T, p_val = case\n        \n        # Determine the exponent p based on the model type\n        if model_name in [\"volume-scaling\", \"mass-scaling\"]:\n            p = 1.0\n        else: # fractal-exponent\n            p = p_val\n            \n        r_int = calculate_integrated_rate(m0, A0, k, T, p)\n        results.append(f\"{r_int:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_integrated_rate(m0, A0, k, T, p):\n    \"\"\"\n    Calculates the integrated rate R_int(T) based on the model exponent p.\n    \n    R_int(T) = m0 - m(T)\n\n    Args:\n        m0 (float): Initial mass in kg.\n        A0 (float): Initial reactive surface area in m^2.\n        k (float): Rate constant in kg m^-2 s^-1.\n        T (float): Total time duration in s.\n        p (float): Fractal exponent.\n\n    Returns:\n        float: Integrated rate R_int(T) in kg.\n    \"\"\"\n    if p == 1.0:\n        # For p=1, dissolution is first-order and never completes in finite time.\n        # m(t) = m0 * exp(-k*A0*t/m0)\n        # R_int(T) = m0 - m(T) = m0 * (1 - exp(-k*A0*T/m0))\n        exponent = -k * A0 * T / m0\n        m_T = m0 * np.exp(exponent)\n        r_int = m0 - m_T\n        return r_int\n    elif 0 = p  1:\n        # For 0 = p  1, dissolution can complete in finite time.\n        # Calculate time to complete dissolution, t_diss.\n        # Handle potential division by zero if k or A0 are zero.\n        if (1 - p) * k * A0 = 0:\n            # No dissolution or ill-defined case, mass doesn't change.\n            return 0.0\n            \n        t_diss = m0 / ((1 - p) * k * A0)\n        \n        if T = t_diss:\n            # Mineral has completely dissolved by time T.\n            # m(T) = 0, so R_int(T) = m0.\n            return m0\n        else:\n            # Mineral has not completely dissolved.\n            # m(t) = m0 * (1 - t/t_diss)^(1/(1-p))\n            # R_int(T) = m0 - m(T)\n            m_T = m0 * (1 - T / t_diss)**(1 / (1 - p))\n            r_int = m0 - m_T\n            return r_int\n    else:\n        # Invalid value of p\n        raise ValueError(\"The exponent p must be in the range [0, 1].\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building realistic kinetic models requires integrating theoretical frameworks with experimental data. Many geochemical processes, like feldspar weathering, operate through multiple parallel mechanisms, each with its own rate parameters. This advanced practice  simulates the complete workflow of a kineticist: you will formulate a multi-mechanism rate law, generate synthetic \"experimental\" data, and use non-linear regression to calibrate your model, providing hands-on experience in the essential skill of inverse modeling.",
            "id": "4097811",
            "problem": "You are asked to design and implement a complete, runnable program that formulates and calibrates a multi-mechanism rate law for feldspar dissolution within the framework of reaction path modeling in computational geochemistry. Your program must carry out the following tasks in a scientifically principled manner, starting from valid foundational definitions and laws, and produce a single-line output in a specified format.\n\nThe fundamental base you must employ is as follows:\n- The dissolution proceeds by parallel elementary pathways whose individual rates are additive. Under parallel mechanisms, the macroscopic rate is the sum of the mechanism-specific rates, since each pathway contributes independently to the total flux.\n- The activity of the hydrogen ion is defined by the negative base-$10$ logarithm of activity: $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$, where $a_{\\mathrm{H}^+}$ is dimensionless.\n- The water autoprotolysis equilibrium at temperature $25\\,^\\circ\\mathrm{C}$ is described by the equilibrium constant $K_w$, with $K_w = 10^{-14}$ in terms of activities, satisfying $a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-} = K_w$.\n- The overall dissolution rate per unit geometric area is to be computed in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, while activity-based exponents are dimensionless. The activity is unitless by definition.\n\nUsing these bases, formulate a rate law for feldspar dissolution with two parallel mechanisms that depend on acid and base catalysis through the activities of hydronium and hydroxide. Your derivation should lead to a model that depends on $a_{\\mathrm{H}^+}$ and $a_{\\mathrm{OH}^-}$, each raised to a mechanism-specific exponent, and with mechanism-specific rate constants. You must then fit the exponents and rate constants from synthetic data.\n\nData generation protocol:\n- You will generate synthetic dissolution rate data by prescribing “true” parameter values for the exponents and rate constants, computing activities from $\\mathrm{pH}$ and $K_w$, and evaluating the rate law. Then, you will perturb the rates by multiplicative Gaussian noise to mimic experimental uncertainty. Specifically, for each data point with true rate $r_{\\text{true}}$, produce an observed rate $r_{\\text{obs}}$ according to $r_{\\text{obs}} = r_{\\text{true}} \\left( 1 + \\epsilon \\right)$, where $\\epsilon \\sim \\mathcal{N}(0, \\sigma)$ and the standard deviation $\\sigma$ is prescribed per test case. If $r_{\\text{obs}} \\le 0$, replace it by a small positive floor such as $10^{-30}$ to maintain physical realism.\n\nParameter estimation protocol:\n- Fit the mechanism-specific exponents and rate constants by minimizing the sum of squared residuals between observed and model-predicted rates across the dataset, using Non-Linear Least Squares (NLLS). Use non-negativity constraints for the rate constants and reasonable bounds for the exponents (for example, between $0$ and $3$ to reflect typical catalytic orders). Provide initial guesses that are positive and physically meaningful.\n- Report the Root Mean Square (RMS) of the residuals across the dataset in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nActivity computation:\n- For each data point with a specified $\\mathrm{pH}$, compute $a_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}}$ and $a_{\\mathrm{OH}^-} = \\dfrac{K_w}{a_{\\mathrm{H}^+}}$, with $K_w = 10^{-14}$, all quantities dimensionless.\n\nTest suite:\nYou must implement three distinct test cases that vary the true parameters and noise level to ensure coverage of acid-dominated, base-dominated, and mixed regimes. Use a fixed random seed to ensure reproducibility across runs.\n\n- Test Case $1$ (mixed contributions):\n  - True parameters: $k_{\\mathrm{H}^+} = 1.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $n_{\\mathrm{H}^+} = 0.50$, $k_{\\mathrm{OH}^-} = 5.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $n_{\\mathrm{OH}^-} = 0.70$.\n  - Noise standard deviation: $\\sigma = 0.05$ (relative, dimensionless).\n  - $\\mathrm{pH}$ grid: $\\{2, 3, 4, 5, 6, 7, 8, 9, 10, 12\\}$.\n\n- Test Case $2$ (acid-dominated):\n  - True parameters: $k_{\\mathrm{H}^+} = 3.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $n_{\\mathrm{H}^+} = 0.90$, $k_{\\mathrm{OH}^-} = 1.0 \\times 10^{-12}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $n_{\\mathrm{OH}^-} = 1.20$.\n  - Noise standard deviation: $\\sigma = 0.02$ (relative, dimensionless).\n  - $\\mathrm{pH}$ grid: $\\{1, 2, 3, 4, 6, 7, 8, 9\\}$.\n\n- Test Case $3$ (base-dominated):\n  - True parameters: $k_{\\mathrm{H}^+} = 1.0 \\times 10^{-12}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $n_{\\mathrm{H}^+} = 0.60$, $k_{\\mathrm{OH}^-} = 2.0 \\times 10^{-10}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $n_{\\mathrm{OH}^-} = 0.80$.\n  - Noise standard deviation: $\\sigma = 0.05$ (relative, dimensionless).\n  - $\\mathrm{pH}$ grid: $\\{7, 8, 9, 10, 11, 12, 13\\}$.\n\nImplementation requirements:\n- Use $K_w = 10^{-14}$ and temperature fixed at $25\\,^\\circ\\mathrm{C}$.\n- Seed the random number generator once at the start with $42$.\n- For NLLS, choose initial guesses $k_{\\mathrm{H}^+} = 1.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $n_{\\mathrm{H}^+} = 0.50$, $k_{\\mathrm{OH}^-} = 1.0 \\times 10^{-11}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $n_{\\mathrm{OH}^-} = 0.50$, with bounds $k_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-} \\in [10^{-20}, 10^{-6}]$ and $n_{\\mathrm{H}^+}, n_{\\mathrm{OH}^-} \\in [0, 3]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the fitted exponents and rate constants together with the RMS residual, in the following order:\n  - $n_{\\mathrm{H}^+}$, $n_{\\mathrm{OH}^-}$, $k_{\\mathrm{H}^+}$, $k_{\\mathrm{OH}^-}$, $\\mathrm{RMS}$.\n- Concatenate the outputs for the three test cases in sequence into one flat list. Print all values as floating-point numbers in scientific notation with six digits after the decimal point. For example: $\\left[\\text{case1\\_}n_{\\mathrm{H}^+},\\text{case1\\_}n_{\\mathrm{OH}^-},\\text{case1\\_}k_{\\mathrm{H}^+},\\text{case1\\_}k_{\\mathrm{OH}^-},\\text{case1\\_}\\mathrm{RMS},\\text{case2\\_}\\ldots,\\text{case3\\_}\\ldots\\right]$.\n\nUnits and reporting:\n- Express all rates and rate constants in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n- Exponents are dimensionless.\n- Activities are dimensionless.\n\nYour program must be fully self-contained, accept no user input, and adhere to the specified output format exactly. The environment is Python $3.12$ with the specified libraries. The final line printed by the program must contain only the bracketed list with no additional text.",
            "solution": "The problem statement is valid. It is scientifically grounded in the principles of chemical kinetics and computational geochemistry, is well-posed with a clear objective and sufficient data, and is expressed in precise, objective language. We will therefore proceed with a full solution.\n\nThe core task is to formulate and calibrate a multi-mechanism rate law for feldspar dissolution. This involves three principal stages: (1) defining the mathematical model based on geochemical principles, (2) generating synthetic experimental data according to a specified statistical model, and (3) performing a non-linear least squares (NLLS) regression to estimate the model parameters from the synthetic data.\n\n**1. Model Formulation**\n\nThe total dissolution rate, $R$, is modeled as the sum of rates from independent, parallel reaction pathways. The problem specifies two such pathways: one catalyzed by acid (hydronium ions, $\\mathrm{H}^+$) and one by base (hydroxide ions, $\\mathrm{OH}^-$). The overall rate $R$, in units of $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, is thus given by:\n$$\nR = R_{\\text{acid}} + R_{\\text{base}}\n$$\nEach pathway's rate is described by a power law dependency on the activity of the catalytic species. This is a common formulation derived from transition state theory. The rate for the acid-catalyzed mechanism, $R_{\\text{acid}}$, and the base-catalyzed mechanism, $R_{\\text{base}}$, are given by:\n$$\nR_{\\text{acid}} = k_{\\mathrm{H}^+} a_{\\mathrm{H}^+}^{n_{\\mathrm{H}^+}}\n$$\n$$\nR_{\\text{base}} = k_{\\mathrm{OH}^-} a_{\\mathrm{OH}^-}^{n_{\\mathrm{OH}^-}}\n$$\nHere, $k_{\\mathrm{H}^+}$ and $k_{\\mathrm{OH}^-}$ are the mechanism-specific rate constants in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $a_{\\mathrm{H}^+}$ and $a_{\\mathrm{OH}^-}$ are the dimensionless activities of the hydronium and hydroxide ions, and $n_{\\mathrm{H}^+}$ and $n_{\\mathrm{OH}^-}$ are the dimensionless reaction orders (exponents) for each pathway.\n\nThe complete rate law is the sum of these two contributions:\n$$\nR = k_{\\mathrm{H}^+} a_{\\mathrm{H}^+}^{n_{\\mathrm{H}^+}} + k_{\\mathrm{OH}^-} a_{\\mathrm{OH}^-}^{n_{\\mathrm{OH}^-}}\n$$\nThe activities of the ionic species are related to the $\\mathrm{pH}$ of the solution. By definition, $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$, which gives:\n$$\na_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}}\n$$\nThe activity of hydroxide is related to the activity of hydronium through the water autoprotolysis equilibrium constant, $K_w = a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-}$. At the specified temperature of $25\\,^\\circ\\mathrm{C}$, $K_w = 10^{-14}$. Therefore:\n$$\na_{\\mathrm{OH}^-} = \\frac{K_w}{a_{\\mathrm{H}^+}} = \\frac{10^{-14}}{10^{-\\mathrm{pH}}} = 10^{\\mathrm{pH}-14}\n$$\nSubstituting these expressions for activity into the rate law gives the final model as a function of $\\mathrm{pH}$ and the four parameters to be fitted ($\\vec{p} = [k_{\\mathrm{H}^+}, n_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-}, n_{\\mathrm{OH}^-}]$):\n$$\nR(\\mathrm{pH}; \\vec{p}) = k_{\\mathrm{H}^+} (10^{-\\mathrm{pH}})^{n_{\\mathrm{H}^+}} + k_{\\mathrm{OH}^-} (10^{\\mathrm{pH}-14})^{n_{\\mathrm{OH}^-}}\n$$\nThis function forms the basis for both data generation and parameter estimation.\n\n**2. Data Synthesis**\n\nTo simulate experimental data, we first compute a set of \"true\" dissolution rates ($r_{\\text{true},i}$) at various $\\mathrm{pH}_i$ values using the model above with a given set of true parameters ($k_{\\mathrm{H}^+\\text{,true}}$, $n_{\\mathrm{H}^+\\text{,true}}$, etc.). Experimental uncertainty is then simulated by perturbing these true rates with multiplicative Gaussian noise. An observed rate, $r_{\\text{obs},i}$, is generated from each true rate according to:\n$$\nr_{\\text{obs},i} = r_{\\text{true},i} (1 + \\epsilon_i)\n$$\nwhere $\\epsilon_i$ is a random variable drawn from a normal distribution with mean $0$ and standard deviation $\\sigma$, i.e., $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma)$. The standard deviation $\\sigma$ represents the relative noise level. To maintain physical realism, any resulting non-positive rate ($r_{\\text{obs},i} \\le 0$) is replaced by a small positive floor value of $10^{-30}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$. A fixed random seed of $42$ ensures the reproducibility of the generated dataset.\n\n**3. Parameter Estimation and Performance evaluation**\n\nThe inverse problem is to estimate the four model parameters, $\\vec{p} = [k_{\\mathrm{H}^+}, n_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-}, n_{\\mathrm{OH}^-}]$, from the synthetically generated `observed' data $( \\mathrm{pH}_i, r_{\\text{obs},i} )$. We use the method of Non-Linear Least Squares (NLLS). This involves finding the parameter vector $\\vec{p}_{\\text{fit}}$ that minimizes the sum of squared residuals (SSR) between the observed rates and the rates predicted by the model:\n$$\n\\mathrm{SSR}(\\vec{p}) = \\sum_{i=1}^{N} \\left( r_{\\text{obs},i} - R(\\mathrm{pH}_i; \\vec{p}) \\right)^2\n$$\nwhere $N$ is the number of data points. This minimization is performed numerically using the `scipy.optimize.least_squares` function, which is well-suited for this task. The optimization is constrained by physically meaningful bounds on the parameters: rate constants must be positive ($k_{\\mathrm{H}^+}, k_{\\mathrm{OH}^-} \\in [10^{-20}, 10^{-6}]$) and reaction orders are typically small positive numbers ($n_{\\mathrm{H}^+}, n_{\\mathrm{OH}^-} \\in [0, 3]$). An initial guess for the parameters is provided to guide the algorithm.\n\nThe goodness-of-fit is quantified by the Root Mean Square (RMS) of the residuals, which has the same units as the rate and provides a measure of the average error of the model prediction:\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{\\mathrm{SSR}(\\vec{p}_{\\text{fit}})}{N}} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left( r_{\\text{obs},i} - R(\\mathrm{pH}_i; \\vec{p}_{\\text{fit}}) \\right)^2}\n$$\nThis procedure is repeated for each of the three test cases defined in the problem statement, and the resulting fitted parameters and RMS value are reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Formulates and calibrates a multi-mechanism rate law for feldspar dissolution.\n    Generates synthetic data, fits parameters using NLLS, and reports the results.\n    \"\"\"\n    np.random.seed(42)  # Seed for reproducibility\n    K_w = 1e-14\n    \n    # Define the three test cases as specified in the problem statement\n    test_cases = [\n        {\n            \"name\": \"Test Case 1 (mixed contributions)\",\n            \"true_params\": {\"k_H\": 1.0e-10, \"n_H\": 0.50, \"k_OH\": 5.0e-11, \"n_OH\": 0.70},\n            \"sigma\": 0.05,\n            \"ph_grid\": np.array([2, 3, 4, 5, 6, 7, 8, 9, 10, 12]),\n        },\n        {\n            \"name\": \"Test Case 2 (acid-dominated)\",\n            \"true_params\": {\"k_H\": 3.0e-10, \"n_H\": 0.90, \"k_OH\": 1.0e-12, \"n_OH\": 1.20},\n            \"sigma\": 0.02,\n            \"ph_grid\": np.array([1, 2, 3, 4, 6, 7, 8, 9]),\n        },\n        {\n            \"name\": \"Test Case 3 (base-dominated)\",\n            \"true_params\": {\"k_H\": 1.0e-12, \"n_H\": 0.60, \"k_OH\": 2.0e-10, \"n_OH\": 0.80},\n            \"sigma\": 0.05,\n            \"ph_grid\": np.array([7, 8, 9, 10, 11, 12, 13]),\n        },\n    ]\n\n    # Parameter order for optimization: [k_H, n_H, k_OH, n_OH]\n    initial_guesses = np.array([1.0e-11, 0.50, 1.0e-11, 0.50])\n    bounds = (\n        [1e-20, 0, 1e-20, 0],       # Lower bounds\n        [1e-6, 3, 1e-6, 3]          # Upper bounds\n    )\n    \n    # Store all results in a flat list\n    all_results = []\n\n    def rate_model(params, ph_values):\n        \"\"\"\n        Calculates dissolution rate based on the two-mechanism model.\n        params: [k_H, n_H, k_OH, n_OH]\n        \"\"\"\n        k_H, n_H, k_OH, n_OH = params\n        a_H = 10.0**(-ph_values)\n        a_OH = K_w / a_H\n        rate = k_H * (a_H**n_H) + k_OH * (a_OH**n_OH)\n        return rate\n\n    for case in test_cases:\n        true_params_vec = np.array([\n            case[\"true_params\"][\"k_H\"],\n            case[\"true_params\"][\"n_H\"],\n            case[\"true_params\"][\"k_OH\"],\n            case[\"true_params\"][\"n_OH\"],\n        ])\n        \n        # 1. Generate synthetic data\n        true_rates = rate_model(true_params_vec, case[\"ph_grid\"])\n        noise = np.random.normal(0, case[\"sigma\"], size=len(case[\"ph_grid\"]))\n        observed_rates = true_rates * (1 + noise)\n        \n        # Apply floor value for non-positive rates\n        observed_rates[observed_rates = 0] = 1e-30\n        \n        # 2. Define the residual function for least_squares\n        def residuals(params, ph_values, obs_rates):\n            return rate_model(params, ph_values) - obs_rates\n\n        # 3. Perform Non-Linear Least Squares fitting\n        result = least_squares(\n            residuals,\n            initial_guesses,\n            bounds=bounds,\n            args=(case[\"ph_grid\"], observed_rates)\n        )\n        \n        fitted_params = result.x\n        \n        # 4. Calculate RMS of the residuals\n        final_residuals = residuals(fitted_params, case[\"ph_grid\"], observed_rates)\n        rms = np.sqrt(np.mean(final_residuals**2))\n        \n        # 5. Extract fitted parameters\n        k_H_fit, n_H_fit, k_OH_fit, n_OH_fit = fitted_params\n        \n        # Append results in the specified order: nH+, nOH-, kH+, kOH-, RMS\n        case_results = [n_H_fit, n_OH_fit, k_H_fit, k_OH_fit, rms]\n        all_results.extend(case_results)\n\n    # 6. Format and print the final output\n    formatted_results = [f\"{val:.6e}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}