{
    "hands_on_practices": [
        {
            "introduction": "The tendency for elements to mix within a crystal lattice, forming a solid solution, is fundamentally driven by an increase in configurational entropy. In complex minerals like garnet, however, mixing is not uniform; different elements are ordered onto distinct crystallographic sublattices. This exercise  provides foundational practice in applying the Compound Energy Formalism (CEF) to quantify the ideal entropy of mixing in such a multi-sublattice system, a cornerstone for building any advanced solid solution model.",
            "id": "4067672",
            "problem": "Consider an ideal multisite sublattice solid solution of garnet described by the general formula $\\mathrm{X}_3\\mathrm{Y}_2\\mathrm{Z}_3\\mathrm{O}_{12}$ within the Compound Energy Formalism (CEF). The $\\mathrm{X}$ sublattice hosts divalent cations, the $\\mathrm{Y}$ sublattice hosts trivalent cations, and the $\\mathrm{Z}$ sublattice hosts tetravalent cations. Assume ideal configurational mixing on the $\\mathrm{X}$ and $\\mathrm{Y}$ sublattices, and a pure endmember occupancy on the $\\mathrm{Z}$ sublattice. The sublattice multiplicities per formula unit are $a^{\\mathrm{X}} = 3$, $a^{\\mathrm{Y}} = 2$, and $a^{\\mathrm{Z}} = 3$.\n\nA particular garnet solution state is specified by the site fractions\n- on the $\\mathrm{X}$ sublattice: $y_{\\mathrm{Mg}}^{\\mathrm{X}} = 0.55$, $y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}} = 0.30$, $y_{\\mathrm{Ca}}^{\\mathrm{X}} = 0.15$;\n- on the $\\mathrm{Y}$ sublattice: $y_{\\mathrm{Al}}^{\\mathrm{Y}} = 0.80$, $y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}} = 0.20$;\n- on the $\\mathrm{Z}$ sublattice: $y_{\\mathrm{Si}}^{\\mathrm{Z}} = 1.00$.\n\nStarting from the statistical mechanical definition of configurational entropy as the Boltzmann relation and well-tested combinatorial counting for multisite occupancy, derive the ideal configurational entropy of mixing $S_{\\mathrm{mix}}$ per mole of formula units for this multisite solution. Then compute the partial derivatives $\\partial S_{\\mathrm{mix}} / \\partial y_{i}^{\\alpha}$ for each independent species on the $\\mathrm{X}$ and $\\mathrm{Y}$ sublattices evaluated at the given site-fraction state. Treat the $\\mathrm{Z}$ sublattice as stoichiometric and exclude it from the set of derivatives.\n\nUse the molar gas constant $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$. Express $S_{\\mathrm{mix}}$ and all $\\partial S_{\\mathrm{mix}} / \\partial y_{i}^{\\alpha}$ values in $\\mathrm{J\\,K^{-1}\\,mol^{-1}}$. Round each reported value to four significant figures.\n\nReport your final results in the order\n$$\\left(S_{\\mathrm{mix}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Mg}}^{\\mathrm{X}}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Ca}}^{\\mathrm{X}}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Al}}^{\\mathrm{Y}}},\\ \\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}}}\\right).$$",
            "solution": "The problem is scientifically grounded, well-posed, and contains sufficient information for a unique solution. It is a standard exercise in the thermodynamics of multicomponent solid solutions, specifically applying the Compound Energy Formalism (CEF) to an ideal mixing model. All given parameters and conditions are consistent and physically realistic for a garnet mineral.\n\nThe ideal configurational entropy of mixing, $S_{\\mathrm{mix}}$, for a multisite solid solution is derived from the Boltzmann relation, $S = k_B \\ln W$, where $k_B$ is the Boltzmann constant and $W$ is the total number of microscopic configurations. For one mole of formula units, the molar entropy is $S = R \\ln W_{\\text{molar}}$, where $R$ is the molar gas constant.\n\nIn a multisite crystal, the total number of configurations $W$ is the product of the configurations on each independent sublattice $\\alpha$, $W = \\prod_{\\alpha} W_{\\alpha}$. The configurational entropy is thus additive over the sublattices: $S_{\\mathrm{mix}} = \\sum_{\\alpha} S_{\\mathrm{mix}}^{\\alpha}$.\n\nFor a given sublattice $\\alpha$ with a multiplicity of $a^{\\alpha}$ sites per formula unit, and with various species $i$ occupying the sites with site fractions $y_i^{\\alpha}$, the number of Ways to arrange $N_A a^{\\alpha} y_i^{\\alpha}$ atoms of species $i$ on $N_A a^{\\alpha}$ total sites (for one mole) is given by the multinomial coefficient. Using Stirling's approximation for $\\ln(N!)$ for large $N$, the molar configurational entropy for sublattice $\\alpha$ is given by:\n$$S_{\\mathrm{mix}}^{\\alpha} = -R a^{\\alpha} \\sum_{i} y_i^{\\alpha} \\ln y_i^{\\alpha}$$\nThe total ideal configurational entropy of mixing for the entire crystal is the sum over all sublattices where mixing occurs:\n$$S_{\\mathrm{mix}} = -R \\sum_{\\alpha} a^{\\alpha} \\sum_{i} y_i^{\\alpha} \\ln y_i^{\\alpha}$$\n\nThe problem describes a garnet, $\\mathrm{X}_3\\mathrm{Y}_2\\mathrm{Z}_3\\mathrm{O}_{12}$, with three cation sublattices, $\\mathrm{X}$, $\\mathrm{Y}$, and $\\mathrm{Z}$, with multiplicities per formula unit of $a^{\\mathrm{X}}=3$, $a^{\\mathrm{Y}}=2$, and $a^{\\mathrm{Z}}=3$, respectively.\n\nThe problem states that mixing occurs on the $\\mathrm{X}$ and $\\mathrm{Y}$ sublattices, while the $\\mathrm{Z}$ sublattice has a pure occupancy ($y_{\\mathrm{Si}}^{\\mathrm{Z}} = 1.00$). The contribution to the mixing entropy from the $\\mathrm{Z}$ sublattice is therefore zero, as $S_{\\mathrm{mix}}^{\\mathrm{Z}} = -R a^{\\mathrm{Z}} (1 \\ln 1) = 0$.\n\nThus, the total entropy of mixing is:\n$$S_{\\mathrm{mix}} = S_{\\mathrm{mix}}^{\\mathrm{X}} + S_{\\mathrm{mix}}^{\\mathrm{Y}} = -R \\left( a^{\\mathrm{X}} \\sum_{i \\in \\mathrm{X}} y_i^{\\mathrm{X}} \\ln y_i^{\\mathrm{X}} + a^{\\mathrm{Y}} \\sum_{j \\in \\mathrm{Y}} y_j^{\\mathrm{Y}} \\ln y_j^{\\mathrm{Y}} \\right)$$\n\nSubstituting the given site fractions and multiplicities:\n- $\\mathrm{X}$ sublattice: $y_{\\mathrm{Mg}}^{\\mathrm{X}} = 0.55$, $y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}} = 0.30$, $y_{\\mathrm{Ca}}^{\\mathrm{X}} = 0.15$.\n- $\\mathrm{Y}$ sublattice: $y_{\\mathrm{Al}}^{\\mathrm{Y}} = 0.80$, $y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}} = 0.20$.\n$$S_{\\mathrm{mix}} = -R \\left[ 3 \\left( y_{\\mathrm{Mg}}^{\\mathrm{X}} \\ln y_{\\mathrm{Mg}}^{\\mathrm{X}} + y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}} \\ln y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}} + y_{\\mathrm{Ca}}^{\\mathrm{X}} \\ln y_{\\mathrm{Ca}}^{\\mathrm{X}} \\right) + 2 \\left( y_{\\mathrm{Al}}^{\\mathrm{Y}} \\ln y_{\\mathrm{Al}}^{\\mathrm{Y}} + y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}} \\ln y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}} \\right) \\right]$$\n$$S_{\\mathrm{mix}} = -R \\left[ 3 \\left( 0.55 \\ln(0.55) + 0.30 \\ln(0.30) + 0.15 \\ln(0.15) \\right) + 2 \\left( 0.80 \\ln(0.80) + 0.20 \\ln(0.20) \\right) \\right]$$\nNumerically evaluating the terms:\n$$S_{\\mathrm{mix}}^{\\mathrm{X}} \\text{ term} = 3 \\left( 0.55 \\times (-0.597837) + 0.30 \\times (-1.203973) + 0.15 \\times (-1.897120) \\right)$$\n$$= 3 \\left( -0.328810 - 0.361192 - 0.284568 \\right) = 3(-0.974570) = -2.92371$$\n$$S_{\\mathrm{mix}}^{\\mathrm{Y}} \\text{ term} = 2 \\left( 0.80 \\times (-0.223144) + 0.20 \\times (-1.609438) \\right)$$\n$$= 2 \\left( -0.178515 - 0.321888 \\right) = 2(-0.500403) = -1.000806$$\n$$S_{\\mathrm{mix}} = -R \\left( -2.92371 - 1.000806 \\right) = -R \\left( -3.924516 \\right)$$\nUsing $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$:\n$$S_{\\mathrm{mix}} = 8.314462618 \\times 3.924516 = 32.6288... \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$$\nRounding to four significant figures, $S_{\\mathrm{mix}} = 32.63 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$.\n\nNext, we must compute the partial derivatives $\\partial S_{\\mathrm{mix}} / \\partial y_{i}^{\\alpha}$. The site fractions on each sublattice are subject to the constraint $\\sum_i y_i^\\alpha = 1$. A rigorous partial derivative would require choosing one site fraction as a dependent variable, leading to a result that depends on this arbitrary choice. However, the problem asks for a derivative for each species listed in the output format, which is more than the number of independent variables. This implies a request for the formal partial derivative, treating all $y_i^\\alpha$ as mathematically independent. This is a standard quantity in CEF-based calculations, related to the construction of chemical potentials.\n\nWe compute the formal derivative of $S_{\\mathrm{mix}}$ with respect to a site fraction $y_k^\\beta$:\n$$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_k^{\\beta}} = \\frac{\\partial}{\\partial y_k^{\\beta}} \\left( -R a^{\\beta} \\sum_{i \\in \\beta} y_i^{\\beta} \\ln y_i^{\\beta} \\right)$$\nAs the derivative is taken holding all other site fractions constant (including those on the same sublattice), only the term for $i=k$ is non-zero:\n$$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_k^{\\beta}} = -R a^{\\beta} \\frac{\\partial}{\\partial y_k^{\\beta}} \\left( y_k^{\\beta} \\ln y_k^{\\beta} \\right) = -R a^{\\beta} \\left( 1 \\cdot \\ln y_k^{\\beta} + y_k^{\\beta} \\cdot \\frac{1}{y_k^{\\beta}} \\right)$$\n$$\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_k^{\\beta}} = -R a^{\\beta} (1 + \\ln y_k^{\\beta})$$\nWe apply this formula to each species on the $\\mathrm{X}$ and $\\mathrm{Y}$ sublattices.\n\nFor the $\\mathrm{X}$ sublattice ($a^{\\mathrm{X}} = 3$):\n- For $\\mathrm{Mg}$: $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Mg}}^{\\mathrm{X}}} = -3R(1+\\ln(0.55)) = -3(8.31446...) (1 - 0.597837) = -10.0315... \\approx -10.03 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- For $\\mathrm{Fe^{2+}}$: $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}}} = -3R(1+\\ln(0.30)) = -3(8.31446...) (1 - 1.203973) = 5.0877... \\approx 5.088 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- For $\\mathrm{Ca}$: $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Ca}}^{\\mathrm{X}}} = -3R(1+\\ln(0.15)) = -3(8.31446...) (1 - 1.897120) = 22.3770... \\approx 22.38 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n\nFor the $\\mathrm{Y}$ sublattice ($a^{\\mathrm{Y}} = 2$):\n- For $\\mathrm{Al}$: $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Al}}^{\\mathrm{Y}}} = -2R(1+\\ln(0.80)) = -2(8.31446...) (1 - 0.223144) = -12.9182... \\approx -12.92 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- For $\\mathrm{Fe^{3+}}$: $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}}} = -2R(1+\\ln(0.20)) = -2(8.31446...) (1 - 1.609438) = 10.1342... \\approx 10.13 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n\nThe final results, rounded to four significant figures and presented in the required order, are:\n- $S_{\\mathrm{mix}} = 32.63 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Mg}}^{\\mathrm{X}}} = -10.03 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{2+}}}^{\\mathrm{X}}} = 5.088 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Ca}}^{\\mathrm{X}}} = 22.38 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Al}}^{\\mathrm{Y}}} = -12.92 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$\n- $\\frac{\\partial S_{\\mathrm{mix}}}{\\partial y_{\\mathrm{Fe^{3+}}}^{\\mathrm{Y}}} = 10.13 \\ \\mathrm{J\\,K^{-1}\\,mol^{-1}}$",
            "answer": "$$\\boxed{\\begin{pmatrix} 32.63 & -10.03 & 5.088 & 22.38 & -12.92 & 10.13 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While ideal mixing provides a baseline, the behavior of most real solid solutions is governed by non-ideal energetic interactions between constituent atoms. This practice  moves beyond the ideal model by introducing the excess Gibbs energy, $G^{\\mathrm{ex}}$, which quantifies this deviation from ideality. You will work with a common temperature-dependent interaction model and derive the physical meaning of its parameters, learning how thermodynamic databases encode complex enthalpic, entropic, and ordering effects.",
            "id": "4067695",
            "problem": "Consider a multicomponent solution described by the Compound Energy Formalism (CEF) with two crystallographic sublattices. Sublattice indices are denoted by superscripts, and site multiplicities (the number of sites of each sublattice per formula unit) are $r^{(1)}$ and $r^{(2)}$. Assume random mixing and Bragg–Williams mean-field treatment of interactions on each sublattice. In such a model, the molar Gibbs energy is decomposed into an ideal configurational term and an excess term arising from energetic interactions among unlike occupants on each sublattice. The excess term for binary mixing on a given sublattice is taken to be proportional to the probability of unlike occupancy and to a temperature-dependent interaction parameter.\n\nYou are given a two-sublattice solution with site multiplicities $r^{(1)}=2$ and $r^{(2)}=1$. Sublattice $1$ hosts species $\\mathrm{M}_1$ and $\\mathrm{M}_2$ with site fractions $y_{\\mathrm{M}_1}^{(1)}=0.65$ and $y_{\\mathrm{M}_2}^{(1)}=0.35$. Sublattice $2$ hosts species $\\mathrm{X}_1$ and $\\mathrm{X}_2$ with site fractions $y_{\\mathrm{X}_1}^{(2)}=0.25$ and $y_{\\mathrm{X}_2}^{(2)}=0.75$. Assume that the only non-ideal interactions are first-order binary interactions on each sublattice, with no cross-sublattice interaction parameters and no higher-order Redlich–Kister terms. The temperature dependence of the binary interaction on each sublattice is of the form\n$$\nL^{(s)}(T)\\;=\\;a_s\\;+\\;b_s\\,T\\;+\\; \\frac{c_s}{T},\n$$\nwith the following coefficients:\n- For sublattice $1$: $a_1=1500\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $b_1=-2\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, $c_1=30000\\,\\mathrm{J}\\,\\mathrm{K}\\,\\mathrm{mol}^{-1}$.\n- For sublattice $2$: $a_2=-500\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $b_2=1.5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, $c_2=10000\\,\\mathrm{J}\\,\\mathrm{K}\\,\\mathrm{mol}^{-1}$.\n\nStarting from the CEF definition of the excess Gibbs energy as the sum over sublattices of interaction energies weighted by site multiplicities and the probability of unlike occupancy under random mixing, derive the closed-form expression for the excess molar Gibbs energy $G^{\\mathrm{ex}}(T)$ for the specified site-fraction state. Treat $T$ as the absolute temperature in Kelvin. Express your final expression for $G^{\\mathrm{ex}}(T)$ in Joules per mole of formula unit. No numerical rounding is required.\n\nThen, based on fundamental thermodynamic definitions $H=G-T(\\partial G/\\partial T)_P$ and $S=-(\\partial G/\\partial T)_P$, explain the physical meaning of the coefficients $a_s$, $b_s$, and $c_s$ in the interaction $L^{(s)}(T)$ in terms of excess enthalpy, excess entropy, and temperature-dependent ordering contributions. Your final reported answer must be the single closed-form expression for $G^{\\mathrm{ex}}(T)$.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and internally consistent, providing all necessary information to derive the requested expression. It is based on the Compound Energy Formalism (CEF), a standard and well-established model in computational thermodynamics and materials science. We may therefore proceed with the solution.\n\nThe problem asks for the derivation of the excess molar Gibbs energy, $G^{\\mathrm{ex}}(T)$, for a two-sublattice solid solution, and for a physical interpretation of the coefficients in the interaction parameter expression.\n\nThe molar Gibbs energy of a solution in the CEF is decomposed into several parts, including an ideal configurational term and an excess term. The excess molar Gibbs energy, $G^{\\mathrm{ex}}$, quantifies the deviation from ideal mixing behavior and arises from energetic interactions among the species. For a model with only binary interactions within each sublattice, the excess Gibbs energy is given by the sum of contributions from each sublattice, weighted by their site multiplicities.\n\nThe general expression for $G^{\\mathrm{ex}}$ in a system with multiple sublattices (indexed by $s$) is:\n$$\nG^{\\mathrm{ex}} = \\sum_{s} r^{(s)} \\left( \\sum_{i} \\sum_{j>i} y_i^{(s)} y_j^{(s)} L_{i,j}^{(s)} \\right)\n$$\nwhere $r^{(s)}$ is the site multiplicity of sublattice $s$, $y_i^{(s)}$ and $y_j^{(s)}$ are the site fractions of species $i$ and $j$ on sublattice $s$, and $L_{i,j}^{(s)}$ is the binary interaction parameter between species $i$ and $j$ on that sublattice. The product $y_i^{(s)} y_j^{(s)}$ represents the probability of forming an $i-j$ pair within the sublattice under the assumption of random mixing (Bragg-Williams approximation). The problem states that only first-order binary interactions are present.\n\nIn this specific case, we have two sublattices, $s=1$ and $s=2$.\n\nFor sublattice $1$, the constituents are $\\mathrm{M}_1$ and $\\mathrm{M}_2$. Its contribution to the excess Gibbs energy, $G^{\\mathrm{ex}(1)}$, is:\n$$\nG^{\\mathrm{ex}(1)} = r^{(1)} y_{\\mathrm{M}_1}^{(1)} y_{\\mathrm{M}_2}^{(1)} L^{(1)}(T)\n$$\nGiven values are $r^{(1)}=2$, $y_{\\mathrm{M}_1}^{(1)}=0.65$, and $y_{\\mathrm{M}_2}^{(1)}=0.35$.\nThe interaction parameter is $L^{(1)}(T) = a_1 + b_1 T + \\frac{c_1}{T}$.\n\nFor sublattice $2$, the constituents are $\\mathrm{X}_1$ and $\\mathrm{X}_2$. Its contribution, $G^{\\mathrm{ex}(2)}$, is:\n$$\nG^{\\mathrm{ex}(2)} = r^{(2)} y_{\\mathrm{X}_1}^{(2)} y_{\\mathrm{X}_2}^{(2)} L^{(2)}(T)\n$$\nGiven values are $r^{(2)}=1$, $y_{\\mathrm{X}_1}^{(2)}=0.25$, and $y_{\\mathrm{X}_2}^{(2)}=0.75$.\nThe interaction parameter is $L^{(2)}(T) = a_2 + b_2 T + \\frac{c_2}{T}$.\n\nThe total excess molar Gibbs energy is the sum of these two contributions:\n$$\nG^{\\mathrm{ex}}(T) = G^{\\mathrm{ex}(1)} + G^{\\mathrm{ex}(2)} = r^{(1)} y_{\\mathrm{M}_1}^{(1)} y_{\\mathrm{M}_2}^{(1)} L^{(1)}(T) + r^{(2)} y_{\\mathrm{X}_1}^{(2)} y_{\\mathrm{X}_2}^{(2)} L^{(2)}(T)\n$$\nFirst, we calculate the compositional prefactors for each term.\nFor sublattice $1$:\n$$\nr^{(1)} y_{\\mathrm{M}_1}^{(1)} y_{\\mathrm{M}_2}^{(1)} = (2)(0.65)(0.35) = 2 \\times 0.2275 = 0.455\n$$\nFor sublattice $2$:\n$$\nr^{(2)} y_{\\mathrm{X}_1}^{(2)} y_{\\mathrm{X}_2}^{(2)} = (1)(0.25)(0.75) = 0.1875\n$$\nNow, substitute these prefactors and the expressions for $L^{(s)}(T)$ into the equation for $G^{\\mathrm{ex}}(T)$:\n$$\nG^{\\mathrm{ex}}(T) = 0.455 \\left( a_1 + b_1 T + \\frac{c_1}{T} \\right) + 0.1875 \\left( a_2 + b_2 T + \\frac{c_2}{T} \\right)\n$$\nSubstitute the given numerical coefficients for $a_s$, $b_s$, and $c_s$:\n$a_1=1500\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $b_1=-2\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, $c_1=30000\\,\\mathrm{J}\\,\\mathrm{K}\\,\\mathrm{mol}^{-1}$.\n$a_2=-500\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $b_2=1.5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, $c_2=10000\\,\\mathrm{J}\\,\\mathrm{K}\\,\\mathrm{mol}^{-1}$.\n$$\nG^{\\mathrm{ex}}(T) = 0.455 \\left( 1500 - 2T + \\frac{30000}{T} \\right) + 0.1875 \\left( -500 + 1.5T + \\frac{10000}{T} \\right)\n$$\nWe distribute the prefactors:\n$$\nG^{\\mathrm{ex}}(T) = (0.455 \\times 1500) - (0.455 \\times 2)T + \\frac{0.455 \\times 30000}{T} + (0.1875 \\times -500) + (0.1875 \\times 1.5)T + \\frac{0.1875 \\times 10000}{T}\n$$\n$$\nG^{\\mathrm{ex}}(T) = 682.5 - 0.91T + \\frac{13650}{T} - 93.75 + 0.28125T + \\frac{1875}{T}\n$$\nFinally, we collect terms with the same dependence on temperature $T$:\nThe constant term: $682.5 - 93.75 = 588.75$\nThe term linear in $T$: $(-0.91 + 0.28125)T = -0.62875T$\nThe term proportional to $T^{-1}$: $\\frac{13650 + 1875}{T} = \\frac{15525}{T}$\nCombining these results gives the final closed-form expression for the excess molar Gibbs energy:\n$$\nG^{\\mathrm{ex}}(T) = 588.75 - 0.62875T + \\frac{15525}{T}\n$$\nThe unit of this expression is Joules per mole of formula unit ($\\mathrm{J}\\,\\mathrm{mol}^{-1}$).\n\nNext, we address the physical meaning of the coefficients $a_s$, $b_s$, and $c_s$. We use the fundamental thermodynamic relations for enthalpy $H$ and entropy $S$:\n$$\nS = -\\left(\\frac{\\partial G}{\\partial T}\\right)_P \\quad \\text{and} \\quad H = G + TS = G - T\\left(\\frac{\\partial G}{\\partial T}\\right)_P\n$$\nThese relations also hold for the excess properties $G^{\\mathrm{ex}}$, $H^{\\mathrm{ex}}$, and $S^{\\mathrm{ex}}$. Let us analyze the contribution to $G^{\\mathrm{ex}}$ from a single binary interaction, denoted as $G^{\\mathrm{ex}}_{\\text{term}} = K \\cdot L(T)$, where $K$ is a temperature-independent compositional factor and $L(T) = a + bT + c/T$.\n\nThe contribution to excess entropy is:\n$$\nS^{\\mathrm{ex}}_{\\text{term}} = -\\left(\\frac{\\partial G^{\\mathrm{ex}}_{\\text{term}}}{\\partial T}\\right)_P = -K \\frac{d}{dT}\\left(a + bT + \\frac{c}{T}\\right) = -K\\left(b - \\frac{c}{T^2}\\right) = -Kb + \\frac{Kc}{T^2}\n$$\nThe contribution to excess enthalpy is:\n$$\nH^{\\mathrm{ex}}_{\\text{term}} = G^{\\mathrm{ex}}_{\\text{term}} + T S^{\\mathrm{ex}}_{\\text{term}} = K\\left(a + bT + \\frac{c}{T}\\right) + T\\left(-Kb + \\frac{Kc}{T^2}\\right) = Ka + KbT + \\frac{Kc}{T} - KbT + \\frac{Kc}{T} = Ka + \\frac{2Kc}{T}\n$$\nBased on these derivations, we can interpret the physical meaning of each coefficient in $L^{(s)}(T) = a_s + b_s T + c_s/T$:\n1.  **Coefficient $a_s$**: This coefficient contributes a term $K_s a_s$ to the excess enthalpy $H^{\\mathrm{ex}}$ and has no contribution to the excess entropy $S^{\\mathrm{ex}}$. Thus, $a_s$ represents the temperature-independent part of the interaction enthalpy. It is the regular solution interaction parameter, reflecting the pairwise interaction energy difference between unlike ($i-j$) and like ($i-i$, $j-j$) pairs. A positive $a_s$ indicates an energetic penalty for mixing (tendency to phase separation), while a negative $a_s$ indicates an energetic favorability for mixing.\n\n2.  **Coefficient $b_s$**: This coefficient contributes a term $-K_s b_s$ to the excess entropy $S^{\\mathrm{ex}}$ and has no contribution to the excess enthalpy $H^{\\mathrm{ex}}$. Therefore, $-b_s$ represents a non-configurational, temperature-independent contribution to the excess entropy of mixing. This can arise from changes in vibrational entropy (phonon spectra), electronic entropy, or magnetic entropy upon mixing. A positive $b_s$ leads to a negative contribution to $S^{\\mathrm{ex}}$, which could signify a stiffening of the lattice upon formation of the solution.\n\n3.  **Coefficient $c_s$**: This coefficient contributes to both excess enthalpy ($H^{\\mathrm{ex}} \\propto 2c_s/T$) and excess entropy ($S^{\\mathrm{ex}} \\propto c_s/T^2$). This specific temperature dependence is characteristic of the initial stages of ordering phenomena. While the Bragg-Williams model assumes random mixing and thus does not explicitly account for short-range order (SRO), the $c_s/T$ term in the Gibbs energy expression is an empirical way to approximate the energetic consequences of such ordering. A positive $c_s$ lowers the Gibbs energy at low temperatures, indicating a thermodynamic driving force for ordering. This ordering leads to a more negative enthalpy (as more energetically favorable bonds are formed) and a more negative entropy (as the atomic arrangement becomes less random), both of which become more significant as temperature decreases. Thus, $c_s$ is interpreted as a parameter reflecting the tendency for short-range ordering.",
            "answer": "$$\n\\boxed{588.75 - 0.62875 T + \\frac{15525}{T}}\n$$"
        },
        {
            "introduction": "The ultimate goal of thermodynamic modeling is to predict the stable state of a system, including whether a single homogeneous phase will persist or separate into multiple phases. This advanced computational practice  integrates the concepts of ideal and non-ideal mixing to determine phase stability. You will implement an algorithm to find the equilibrium Gibbs energy by minimizing over internal degrees of freedom and then use a convex hull construction to identify miscibility gaps, bridging the gap between an abstract energy function and a concrete prediction of phase equilibria.",
            "id": "4067734",
            "problem": "Implement a program that, for a binary multisublattice solution with two sublattices, computes the lower convex envelope of the constrained minimum Gibbs energy as a function of the bulk composition and detects phase separation by identifying composition intervals where the energy function is nonconvex. The computation must be grounded in the fundamental definitions of Gibbs energy and ideal configurational entropy of mixing, without using any shortcut formulas.\n\nConsider a solution with two sublattices labeled $A$ and $B$, with site multiplicities $n_A$ and $n_B$, respectively. Let $x_A \\in [0,1]$ and $x_B \\in [0,1]$ denote the site fractions of component $1$ on sublattices $A$ and $B$. The bulk composition $x \\in [0,1]$ is constrained by the site-fraction averaging rule\n$$\nx = \\frac{n_A x_A + n_B x_B}{n_A + n_B}.\n$$\nThe Gibbs energy per formula unit $G$ is modeled as a sum of ideal mixing contributions, linear endmember reference energies, sublattice regular-solution type interaction energies, and a cross-sublattice coupling:\n$$\nG(x_A,x_B;T) = n_A \\left[E_{1,A} x_A + E_{2,A} (1-x_A) + R T \\left(x_A \\ln x_A + (1-x_A)\\ln(1-x_A)\\right) + W_A x_A (1-x_A)\\right]\n\\\\\n+ n_B \\left[E_{1,B} x_B + E_{2,B} (1-x_B) + R T \\left(x_B \\ln x_B + (1-x_B)\\ln(1-x_B)\\right) + W_B x_B (1-x_B)\\right]\n\\\\\n+ W_{AB} (x_A - x_B)^2,\n$$\nwhere $T$ is temperature in $\\mathrm{K}$, $R$ is the molar gas constant in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $E_{1,A}$, $E_{2,A}$, $E_{1,B}$, $E_{2,B}$ are linear reference energies in $\\mathrm{J\\,mol^{-1}}$, $W_A$ and $W_B$ are sublattice interaction parameters in $\\mathrm{J\\,mol^{-1}}$, and $W_{AB}$ is a cross-sublattice coupling in $\\mathrm{J\\,mol^{-1}}$. The ideal mixing entropy terms use the conventional definition of configurational entropy per site, scaled by the sublattice multiplicities.\n\nFor each bulk composition $x \\in [0,1]$, the physically relevant energy is the constrained minimum\n$$\nG_{\\min}(x;T) = \\min_{x_A,x_B \\in [0,1]}\\left\\{G(x_A,x_B;T)\\ \\big|\\ n_A x_A + n_B x_B = (n_A+n_B) x\\right\\}.\n$$\nFrom the principle of minimum Gibbs energy at fixed $T$, $P$, and composition, equilibrium configurations minimize the Gibbs energy subject to constraints. Phase separation is indicated by nonconvexity of $G_{\\min}(x;T)$ with respect to $x$: if the lower convex envelope (the convex hull) of the graph $\\{(x,G_{\\min}(x;T))\\}$ lies strictly below $G_{\\min}(x;T)$ on an interval, the system lowers its energy by decomposing into a two-phase mixture at the endpoints of a tie-line. The task is to compute the lower convex envelope numerically on a grid of $x$ values and report the tie-line endpoints corresponding to nonconvex intervals.\n\nStarting from the fundamental base:\n- Gibbs energy definition for mixtures and the ideal configurational entropy per site $R T \\left(x \\ln x + (1-x)\\ln(1-x)\\right)$,\n- Variational minimization of energy subject to a linear composition constraint,\n- Geometric interpretation of stability via convexity of $G(x)$ with respect to composition,\n\nderive an algorithm that:\n- Computes $G_{\\min}(x;T)$ for a set of $x$ values using numerical constrained minimization,\n- Constructs the lower convex hull of the discrete set of points $(x_i, G_{\\min}(x_i;T))$,\n- Detects phase separation intervals where the convex hull strictly improves upon $G_{\\min}$, and returns the corresponding tie-line endpoints as lists of floats in $[0,1]$.\n\nPhysical units: temperature $T$ must be treated in $\\mathrm{K}$, energies in $\\mathrm{J\\,mol^{-1}}$, and compositions $x$, $x_A$, $x_B$ are dimensionless site fractions. The output lists must contain dimensionless composition values in $[0,1]$.\n\nTest suite and parameter specification:\nYour program must evaluate the following four parameter sets (each defining one test case). In all cases, use $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and a uniform composition grid of $N_x$ points with $N_x = 401$ on $[0,1]$.\n\n- Test case $1$ (symmetric, strong interactions; expect a miscibility gap):\n  $T = 800\\,\\mathrm{K}$, $n_A = 1$, $n_B = 1$, $W_A = 40000\\,\\mathrm{J\\,mol^{-1}}$, $W_B = 40000\\,\\mathrm{J\\,mol^{-1}}$, $W_{AB} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,B} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,B} = 0\\,\\mathrm{J\\,mol^{-1}}$.\n\n- Test case $2$ (symmetric, weak interactions; expect no miscibility gap):\n  $T = 800\\,\\mathrm{K}$, $n_A = 1$, $n_B = 1$, $W_A = 2000\\,\\mathrm{J\\,mol^{-1}}$, $W_B = 2000\\,\\mathrm{J\\,mol^{-1}}$, $W_{AB} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,B} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,B} = 0\\,\\mathrm{J\\,mol^{-1}}$.\n\n- Test case $3$ (asymmetric reference energies with strong interactions; expect an asymmetric miscibility gap):\n  $T = 800\\,\\mathrm{K}$, $n_A = 1$, $n_B = 1$, $W_A = 30000\\,\\mathrm{J\\,mol^{-1}}$, $W_B = 30000\\,\\mathrm{J\\,mol^{-1}}$, $W_{AB} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,A} = 5000\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,B} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,B} = 0\\,\\mathrm{J\\,mol^{-1}}$.\n\n- Test case $4$ (cross-sublattice coupling and unequal multiplicities; expect a miscibility gap influenced by coupling):\n  $T = 800\\,\\mathrm{K}$, $n_A = 2$, $n_B = 1$, $W_A = 20000\\,\\mathrm{J\\,mol^{-1}}$, $W_B = 20000\\,\\mathrm{J\\,mol^{-1}}$, $W_{AB} = -20000\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,A} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{1,B} = 0\\,\\mathrm{J\\,mol^{-1}}$, $E_{2,B} = 0\\,\\mathrm{J\\,mol^{-1}}$.\n\nFor each test case, the program must return a list of tie-line endpoints as floats in ascending order for each distinct miscibility gap interval. If there is one miscibility gap spanning compositions $x_{\\ell}$ to $x_{r}$, return the list $[x_{\\ell}, x_{r}]$. If there are multiple disjoint miscibility gaps, concatenate the endpoints in ascending order, for example $[x_{\\ell,1}, x_{r,1}, x_{\\ell,2}, x_{r,2}]$. If there is no miscibility gap, return an empty list $[]$.\n\nFinal output format: Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, where each element is the list corresponding to one test case. For example, a valid output could be $[[x_{\\ell,1}, x_{r,1}],[],[x_{\\ell,3}, x_{r,3}],[x_{\\ell,4}, x_{r,4}]]$ with all numerical values printed as standard decimal floats. No additional text should be printed.",
            "solution": "The problem requires the implementation of an algorithm to determine phase stability in a binary multisublattice solid solution. This is achieved by computing the constrained minimum Gibbs energy as a function of bulk composition, constructing its lower convex envelope, and identifying composition intervals corresponding to miscibility gaps. The solution is derived from fundamental thermodynamic principles.\n\nThe state of the system is described by the site fractions of component $1$ on two sublattices, $x_A \\in [0,1]$ and $x_B \\in [0,1]$. These internal degrees of freedom are linked to the macroscopic bulk composition $x \\in [0,1]$ via the site multiplicity-weighted average:\n$$\nx = \\frac{n_A x_A + n_B x_B}{n_A + n_B}\n$$\nThe Gibbs energy per formula unit, $G(x_A, x_B; T)$, is given by the sum of contributions from each sublattice and their interaction:\n$$\nG(x_A,x_B;T) = n_A \\left[G_{ref,A}(x_A) + G_{mix,A}^{id}(x_A, T) + G_{ex,A}(x_A)\\right]\n\\\\\n+ n_B \\left[G_{ref,B}(x_B) + G_{mix,B}^{id}(x_B, T) + G_{ex,B}(x_B)\\right]\n\\\\\n+ G_{ex,AB}(x_A, x_B)\n$$\nwhere the terms are:\n- Reference energies: $G_{ref,A}(x_A) = E_{1,A} x_A + E_{2,A} (1-x_A)$ and a similar term for sublattice $B$.\n- Ideal configurational entropy of mixing: $G_{mix,A}^{id}(x_A, T) = R T \\left(x_A \\ln x_A + (1-x_A)\\ln(1-x_A)\\right)$, and similarly for $B$. This term must handle the limits $x \\to 0$ and $x \\to 1$, where $x \\ln x \\to 0$.\n- Sublattice excess energies (regular solution model): $G_{ex,A}(x_A) = W_A x_A (1-x_A)$, and similarly for $B$.\n- Cross-sublattice excess energy: $G_{ex,AB}(x_A, x_B) = W_{AB} (x_A - x_B)^2$.\n\nAccording to the second law of thermodynamics, at constant temperature $T$, pressure $P$, and bulk composition $x$, the system will adopt the internal configuration $(x_A, x_B)$ that minimizes the Gibbs energy. This defines the equilibrium Gibbs energy function $G_{\\min}(x;T)$:\n$$\nG_{\\min}(x;T) = \\min_{x_A,x_B \\in [0,1]}\\left\\{G(x_A,x_B;T)\\ \\big|\\ n_A x_A + n_B x_B = (n_A+n_B) x\\right\\}\n$$\nThe algorithm proceeds in three main steps:\n\n**Step 1: Computation of the Constrained Minimum Energy $G_{\\min}(x;T)$**\n\nTo compute $G_{\\min}(x;T)$ for a grid of $N_x$ points $x_i \\in [0,1]$, we solve the specified constrained optimization problem for each $x_i$. The linear constraint allows us to reduce the problem's dimensionality. Assuming $n_B > 0$, we can express $x_B$ as a function of $x_A$ and the fixed bulk composition $x$:\n$$\nx_B(x_A; x) = \\frac{(n_A+n_B)x - n_A x_A}{n_B}\n$$\nThe optimization problem is now transformed into a one-dimensional minimization with respect to $x_A$. The physical requirement that site fractions must be in the interval $[0,1]$ imposes bounds on $x_A$. In addition to $0 \\le x_A \\le 1$, we must satisfy $0 \\le x_B \\le 1$. This leads to the following bounds for $x_A$:\n$$\n0 \\le \\frac{(n_A+n_B)x - n_A x_A}{n_B} \\le 1\n$$\n$$\n0 \\le (n_A+n_B)x - n_A x_A \\implies n_A x_A \\le (n_A+n_B)x \\implies x_A \\le \\frac{(n_A+n_B)x}{n_A}\n$$\n$$\n(n_A+n_B)x - n_A x_A \\le n_B \\implies (n_A+n_B)x - n_B \\le n_A x_A \\implies x_A \\ge \\frac{(n_A+n_B)x - n_B}{n_A}\n$$\nCombining these with the original bound $x_A \\in [0,1]$, the search space for $x_A$ is the interval $[x_{A, \\text{min}}, x_{A, \\text{max}}]$ where:\n$$\nx_{A, \\text{min}} = \\max\\left(0, \\frac{(n_A+n_B)x - n_B}{n_A}\\right)\n$$\n$$\nx_{A, \\text{max}} = \\min\\left(1, \\frac{(n_A+n_B)x}{n_A}\\right)\n$$\nFor each $x_i$ in the grid, we solve the bounded one-dimensional minimization problem:\n$$\nG_{\\min}(x_i;T) = \\min_{x_A \\in [x_{A, \\text{min}}, x_{A, \\text{max}}]} G(x_A, x_B(x_A; x_i); T)\n$$\nThis minimization is performed numerically using a standard algorithm for bounded scalar optimization, such as the one available in `scipy.optimize.minimize_scalar`.\n\n**Step 2: Construction of the Lower Convex Envelope**\n\nThe stability of the single-phase solution is determined by the convexity of $G_{\\min}(x;T)$. If this function is non-convex over some composition range, the system can achieve a lower energy state by unmixing into two phases whose compositions are given by the common tangent construction. This is equivalent to finding the lower convex envelope (or convex hull) of the graph of $G_{\\min}(x;T)$.\n\nWe have a discrete set of points $(x_i, G_{\\min}(x_i;T))$ from Step 1. Since these points are naturally sorted by the $x_i$ coordinate, an efficient algorithm for finding the lower convex hull is Andrew's monotone chain algorithm. The algorithm proceeds as follows:\n1. Initialize an empty list, `lower_hull`, to store the vertices of the hull.\n2. Iterate through the sorted points $P_i = (x_i, G_{\\min}(x_i;T))$.\n3. For each point $P_i$, consider the last two points added to `lower_hull`, say $P_{k-1}$ and $P_k$. A convexity test is performed using the cross-product of the vectors $\\vec{P_{k-1}P_k}$ and $\\vec{P_{k-1}P_i}$. For a lower hull, the new point $P_i$ must form a \"left turn\" or be collinear with the previous two. If it forms a \"right turn\" (i.e., cross-product $\\le 0$), the last point $P_k$ is removed from `lower_hull`. This is repeated until the convexity condition is met.\n4. Add the current point $P_i$ to `lower_hull`.\n\nThe result is a list of vertices that define the piecewise linear lower convex envelope of the computed energy points.\n\n**Step 3: Identification of Miscibility Gaps**\n\nA miscibility gap occurs where the convex envelope lies strictly below the original energy curve $G_{\\min}(x;T)$. The endpoints of this gap are the points where the energy curve is tangent to the hull. In our discrete representation, these tangency points are vertices of the convex hull.\n\nA miscibility gap is identified by a segment of the lower convex hull that connects two vertices, say $P_j=(x_j, G_j)$ and $P_k=(x_k, G_k)$, which are not adjacent in the original grid of points (i.e., the original index of $P_k$ is greater than the original index of $P_j$ by more than $1$). Such a segment represents a tie-line connecting two coexisting phases. The compositions of these phases are the endpoints of the tie-line, $x_j$ and $x_k$.\n\nThe algorithm systematically detects these gaps by iterating through the consecutive vertices of the computed `lower_hull`. If the original indices of two consecutive hull vertices are non-consecutive, their $x$-coordinates are recorded as the endpoints of a miscibility gap. The final output is a list of these endpoint compositions for each test case. If no such non-adjacent vertices are found on the hull, no miscibility gap exists, and an empty list is returned.\n\n```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\nfrom scipy.special import xlogy\n\ndef solve():\n    \"\"\"\n    Computes the lower convex envelope of the constrained minimum Gibbs energy \n    for a binary multisublattice solid solution and identifies miscibility gaps.\n    \"\"\"\n    R = 8.314462618  # Molar gas constant in J mol^-1 K^-1\n    N_x = 401        # Number of points in the composition grid\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {'T': 800.0, 'nA': 1.0, 'nB': 1.0, 'WA': 40000.0, 'WB': 40000.0, 'WAB': 0.0,\n         'E1A': 0.0, 'E2A': 0.0, 'E1B': 0.0, 'E2B': 0.0},\n        {'T': 800.0, 'nA': 1.0, 'nB': 1.0, 'WA': 2000.0, 'WB': 2000.0, 'WAB': 0.0,\n         'E1A': 0.0, 'E2A': 0.0, 'E1B': 0.0, 'E2B': 0.0},\n        {'T': 800.0, 'nA': 1.0, 'nB': 1.0, 'WA': 30000.0, 'WB': 30000.0, 'WAB': 0.0,\n         'E1A': 5000.0, 'E2A': 0.0, 'E1B': 0.0, 'E2B': 0.0},\n        {'T': 800.0, 'nA': 2.0, 'nB': 1.0, 'WA': 20000.0, 'WB': 20000.0, 'WAB': -20000.0,\n         'E1A': 0.0, 'E2A': 0.0, 'E1B': 0.0, 'E2B': 0.0}\n    ]\n\n    all_results = []\n\n    def entropy_term(y, T):\n        \"\"\"Calculates the ideal configurational entropy contribution RT(y*ln(y) + (1-y)*ln(1-y)).\"\"\"\n        if not (0.0 = y = 1.0): return np.inf\n        return R * T * (xlogy(y, y) + xlogy(1.0 - y, 1.0 - y))\n\n    def gibbs_energy(xA, xB, p):\n        \"\"\"Calculates the total Gibbs energy for given site fractions.\"\"\"\n        g_A = p['nA'] * (p['E1A'] * xA + p['E2A'] * (1 - xA) + \\\n                         entropy_term(xA, p['T']) + p['WA'] * xA * (1 - xA))\n        g_B = p['nB'] * (p['E1B'] * xB + p['E2B'] * (1 - xB) + \\\n                         entropy_term(xB, p['T']) + p['WB'] * xB * (1 - xB))\n        g_AB = p['WAB'] * (xA - xB)**2\n        return g_A + g_B + g_AB\n\n    for params in test_cases:\n        x_grid = np.linspace(0.0, 1.0, N_x)\n        G_min_values = np.zeros(N_x)\n\n        # Step 1: Compute G_min(x) for each x in the grid\n        for i, x in enumerate(x_grid):\n            def objective(xA, current_x, p):\n                \"\"\"1D objective function for minimization w.r.t. xA.\"\"\"\n                xB = ((p['nA'] + p['nB']) * current_x - p['nA'] * xA) / p['nB']\n                if not (0.0 = xB = 1.0): return np.inf\n                return gibbs_energy(xA, xB, p)\n            \n            # Determine bounds for the optimization variable xA\n            xA_min_bound = max(0.0, ((params['nA'] + params['nB']) * x - params['nB']) / params['nA'])\n            xA_max_bound = min(1.0, ((params['nA'] + params['nB']) * x) / params['nA'])\n\n            # Ensure bounds are valid to avoid optimizer errors\n            if xA_min_bound > xA_max_bound:\n                xA_min_bound = xA_max_bound\n\n            res = minimize_scalar(\n                objective,\n                args=(x, params),\n                bounds=(xA_min_bound, xA_max_bound),\n                method='bounded'\n            )\n            G_min_values[i] = res.fun\n\n        # Step 2: Compute lower convex hull using Andrew's monotone chain algorithm\n        points = list(zip(x_grid, G_min_values, range(N_x)))\n\n        def cross_product(p1, p2, p3):\n            \"\"\"Calculates the cross product (z-component) of vectors p1->p2 and p1->p3.\"\"\"\n            return (p2[0] - p1[0]) * (p3[1] - p1[1]) - (p2[1] - p1[1]) * (p3[0] - p1[0])\n\n        lower_hull = []\n        for p in points:\n            while len(lower_hull) >= 2 and cross_product(lower_hull[-2], lower_hull[-1], p) = 0:\n                lower_hull.pop()\n            lower_hull.append(p)\n\n        # Step 3: Identify miscibility gaps from the convex hull\n        tie_lines = []\n        for i in range(len(lower_hull) - 1):\n            p_start, p_end = lower_hull[i], lower_hull[i+1]\n            idx_start, idx_end = p_start[2], p_end[2]\n            \n            if idx_end > idx_start + 1:\n                tie_lines.extend([p_start[0], p_end[0]])\n        \n        all_results.append(tie_lines)\n\n    # Format and print the final output as a single line\n    # The problem asks for the output of the program, which is this list of lists.\n    # We are placing it in the answer tag.\n    return f\"[{','.join(str(res) for res in all_results)}]\"\n```",
            "answer": "[[0.0575, 0.9425], [], [0.035, 0.8125], [0.1775, 0.825]]"
        }
    ]
}