{
    "hands_on_practices": [
        {
            "introduction": "An accurate model of fluid-rock interaction begins with a correct description of the fluid's physical properties. For supercritical fluids, where molecular interactions are significant, the ideal gas law is inadequate. This exercise provides hands-on experience implementing the Newton-Raphson method to solve the Peng-Robinson equation of state, a foundational tool in computational thermodynamics for relating pressure, temperature, and volume . Mastering this numerical technique is a crucial first step toward building more complex reactive transport and geochemical models.",
            "id": "4089472",
            "problem": "You are modeling a pure-component supercritical carbon dioxide fluid interacting with rock using a cubic equation of state and must compute the molar volume from prescribed pressure and temperature. Starting from fundamental thermodynamic modeling principles, use a cubic equation of state to relate pressure, temperature, and molar volume, and construct a root-finding algorithm based on the Newton–Raphson method to solve for the molar volume. Derive all required mathematical expressions for the residual function and its derivative with respect to molar volume, and implement them in a complete, runnable program.\n\nBase definitions and laws:\n- A cubic equation of state provides a functional relationship between pressure, temperature, and molar volume for a real fluid, derived from statistical mechanics and calibrated against experimental data. Use the Peng–Robinson equation of state with its well-tested constants.\n- For a pure fluid, the Peng–Robinson equation of state reads\n$$\nP = \\frac{R T}{v - b} - \\frac{a \\alpha(T)}{v^2 + 2 b v - b^2},\n$$\nwhere $P$ is pressure, $T$ is temperature, $v$ is molar volume, $R$ is the universal gas constant, $a$ and $b$ are substance parameters, and $\\alpha(T)$ is a temperature-dependent correction factor ensuring agreement with the vapor-pressure curve.\n- The substance parameters are\n$$\na = 0.45724 \\frac{R^2 T_c^2}{P_c}, \\quad b = 0.07780 \\frac{R T_c}{P_c},\n$$\nwhere $T_c$ and $P_c$ are the critical temperature and critical pressure of the fluid. The temperature correction is\n$$\n\\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2, \\quad \\alpha(T) = \\left[1 + \\kappa \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right)\\right]^2,\n$$\nwhere $\\omega$ is the acentric factor.\n\nYour task is to:\n1. Define the residual function\n$$\nf(v) = P_{\\mathrm{PR}}(v; T, a, b, \\alpha) - P_{\\mathrm{target}},\n$$\nand derive an explicit analytic expression for its derivative $f'(v) = \\frac{d f}{d v}$.\n2. Outline and implement a Newton–Raphson procedure\n$$\nv_{k+1} = v_k - \\frac{f(v_k)}{f'(v_k)},\n$$\nwith safeguards against non-physical iterates (e.g., $v \\le b$), and reasonable convergence criteria based on both the residual and the step size. Use a physically motivated initial guess based on the ideal gas law, adjusted to remain strictly greater than $b$.\n3. Implement the procedure to compute the molar volume $v$ in $\\mathrm{m^3/mol}$ for the following test suite of $(T, P)$ conditions for carbon dioxide. Use $R = 8.314462618 \\ \\mathrm{J/(mol \\cdot K)}$, $T_c = 304.1282 \\ \\mathrm{K}$, $P_c = 7.3773 \\times 10^6 \\ \\mathrm{Pa}$, and $\\omega = 0.22394$.\n   - Case A (happy path, supercritical): $T = 323 \\ \\mathrm{K}$, $P = 1.0 \\times 10^7 \\ \\mathrm{Pa}$.\n   - Case B (boundary, near-critical): $T = 304.1282 \\ \\mathrm{K}$, $P = 7.3773 \\times 10^6 \\ \\mathrm{Pa}$.\n   - Case C (edge, high pressure): $T = 400 \\ \\mathrm{K}$, $P = 3.0 \\times 10^7 \\ \\mathrm{Pa}$.\n   - Case D (gas-like, moderate pressure above ideal gas regime): $T = 350 \\ \\mathrm{K}$, $P = 1.0 \\times 10^6 \\ \\mathrm{Pa}$.\n   - Case E (edge, very high pressure and high temperature): $T = 650 \\ \\mathrm{K}$, $P = 1.0 \\times 10^8 \\ \\mathrm{Pa}$.\n4. Express the final molar volume for each case in $\\mathrm{m^3/mol}$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC,resultD,resultE]\"). Each result must be a float representing the molar volume in $\\mathrm{m^3/mol}$.\n\nScientific realism requirements:\n- Guarantee all quantities are treated with consistent International System of Units (SI units): pressure in $\\mathrm{Pa}$, temperature in $\\mathrm{K}$, molar volume in $\\mathrm{m^3/mol}$, and the gas constant in $\\mathrm{J/(mol \\cdot K)}$.\n- Ensure the Newton–Raphson iterates do not cross the physical singularity at $v = b$ and do not produce negative volumes.\n- Reasonable convergence tolerances should be chosen to provide at least ten significant digits of accuracy in the molar volume for the given cases, assuming smooth single-root behavior typical of supercritical conditions.\n\nAlgorithmic constraints:\n- Do not use prepackaged root-finders. Implement Newton–Raphson with your own derivative expression.\n- The implementation must be self-contained and require no input.",
            "solution": "The problem of determining the molar volume of a supercritical fluid from its pressure and temperature is a fundamental task in computational geochemistry and chemical engineering. It is a well-posed problem grounded in established principles of thermodynamics. The use of the Peng–Robinson cubic equation of state and the Newton–Raphson numerical method for its solution is a standard and robust approach. The problem provides all necessary data and definitions for a unique and meaningful solution. It is scientifically sound, objective, and complete. Therefore, the problem is deemed valid.\n\nThe core of the problem is to find the molar volume $v$ that satisfies the Peng–Robinson equation of state for a given target pressure $P_{\\mathrm{target}}$ and temperature $T$. The equation is:\n$$\nP_{\\mathrm{PR}}(v; T) = \\frac{R T}{v - b} - \\frac{a \\alpha(T)}{v^2 + 2 b v - b^2}\n$$\nWe must solve the equation $P_{\\mathrm{PR}}(v; T) = P_{\\mathrm{target}}$ for $v$. This is a root-finding problem for the residual function $f(v)$:\n$$\nf(v) = P_{\\mathrm{PR}}(v; T) - P_{\\mathrm{target}} = \\frac{R T}{v - b} - \\frac{a \\alpha(T)}{v^2 + 2 b v - b^2} - P_{\\mathrm{target}} = 0\n$$\n\nThe Newton–Raphson method is an iterative procedure for finding the roots of a differentiable function. The iteration is defined as:\n$$\nv_{k+1} = v_k - \\frac{f(v_k)}{f'(v_k)}\n$$\nwhere $v_k$ is the estimate of the root at iteration $k$, and $f'(v_k)$ is the derivative of the residual function with respect to volume, evaluated at $v_k$. A crucial first step is to derive an analytical expression for this derivative.\n\nThe residual function is:\n$$\nf(v) = R T (v - b)^{-1} - a \\alpha(T) (v^2 + 2 b v - b^2)^{-1} - P_{\\mathrm{target}}\n$$\nWe differentiate $f(v)$ with respect to $v$, treating $T$, $R$, $a$, $b$, $\\alpha(T)$, and $P_{\\mathrm{target}}$ as constants. Using the power rule and the chain rule for differentiation:\n$$\nf'(v) = \\frac{d f}{d v} = \\frac{d}{d v} \\left( R T (v - b)^{-1} \\right) - \\frac{d}{d v} \\left( a \\alpha(T) (v^2 + 2 b v - b^2)^{-1} \\right) - \\frac{d}{d v} \\left( P_{\\mathrm{target}} \\right)\n$$\nThe derivative of the first term is:\n$$\n\\frac{d}{d v} \\left( R T (v - b)^{-1} \\right) = R T \\cdot (-1) \\cdot (v - b)^{-2} \\cdot \\frac{d}{d v}(v-b) = - \\frac{R T}{(v - b)^2}\n$$\nThe derivative of the second term is:\n$$\n- \\frac{d}{d v} \\left( a \\alpha(T) (v^2 + 2 b v - b^2)^{-1} \\right) = - a \\alpha(T) \\cdot (-1) \\cdot (v^2 + 2 b v - b^2)^{-2} \\cdot \\frac{d}{d v}(v^2 + 2 b v - b^2)\n$$\nThe derivative of the polynomial in the denominator is $\\frac{d}{d v}(v^2 + 2 b v - b^2) = 2v + 2b = 2(v+b)$. Substituting this back gives:\n$$\n+ \\frac{a \\alpha(T) \\cdot 2(v+b)}{(v^2 + 2 b v - b^2)^2}\n$$\nThe derivative of the constant $P_{\\mathrm{target}}$ is $0$. Combining the terms, the complete analytical expression for the derivative $f'(v)$ is:\n$$\nf'(v) = - \\frac{R T}{(v - b)^2} + \\frac{2 a \\alpha(T) (v + b)}{(v^2 + 2 b v - b^2)^2}\n$$\n\nThe algorithmic procedure is as follows:\n1.  **Calculate substance parameters for CO₂**: Using the provided critical temperature $T_c = 304.1282 \\ \\mathrm{K}$, critical pressure $P_c = 7.3773 \\times 10^6 \\ \\mathrm{Pa}$, acentric factor $\\omega = 0.22394$, and the universal gas constant $R = 8.314462618 \\ \\mathrm{J/(mol \\cdot K)}$, we compute the substance-specific Peng–Robinson parameters $a$ and $b$, and the parameter $\\kappa$ for the temperature correction factor $\\alpha(T)$.\n    $$\n    a = 0.45724 \\frac{R^2 T_c^2}{P_c}\n    $$\n    $$\n    b = 0.07780 \\frac{R T_c}{P_c}\n    $$\n    $$\n    \\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2\n    $$\n2.  **For each $(T, P)$ case**:\n    a.  Calculate the temperature-dependent term $\\alpha(T) = \\left[1 + \\kappa \\left(1 - \\sqrt{T/T_c}\\right)\\right]^2$.\n    b.  **Initial Guess**: A physically sound initial guess $v_0$ is the molar volume predicted by the ideal gas law, $v_0 = RT/P_{\\mathrm{target}}$. This guess is excellent for low pressures and remains reasonable at higher pressures.\n    c.  **Newton–Raphson Iteration**:\n        i.  Initialize the iteration with $v_k = v_0$.\n        ii. Loop until convergence:\n            1.  Calculate the residual $f(v_k)$ and its derivative $f'(v_k)$ using the derived expressions.\n            2.  Compute the update step $\\Delta v = -f(v_k) / f'(v_k)$.\n            3.  Calculate the new estimate $v_{k+1} = v_k + \\Delta v$.\n            4.  **Safeguard**: The molar volume $v$ must be greater than the excluded volume parameter $b$. If an iteration produces $v_{k+1} \\le b$, the step is too aggressive. In this case, the step size is reduced by a damping factor (e.g., repeatedly halving $\\Delta v$) until the new estimate $v_{k+1} = v_k + \\Delta v$ becomes physically valid (i.e., $v_{k+1} > b$).\n            5.  **Convergence Check**: The iteration is considered converged when the relative change in volume is smaller than a specified tolerance $\\epsilon$. We require convergence to at least $10$ significant digits, so a tolerance of $|\\Delta v / v_{k+1}|  10^{-12}$ is appropriate.\n            6.  Update $v_k \\leftarrow v_{k+1}$ and continue the loop.\n        iii. A maximum number of iterations (e.g., $50$) is imposed to prevent infinite loops in case of non-convergence.\n3.  **Output**: The converged molar volume $v$ for each $(T, P)$ case is collected and formatted as specified. All calculations are performed using SI units.\n\nThis procedure systematically combines the physical model (Peng–Robinson EOS) with a robust numerical method (damped Newton–Raphson) to solve for the molar volume under various conditions, adhering to all scientific and algorithmic constraints of the problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the molar volume of CO2 at given T, P conditions\n    using the Peng-Robinson equation of state and the Newton-Raphson method.\n    \"\"\"\n\n    # Define physical constants and fluid properties for Carbon Dioxide (CO2)\n    R = 8.314462618  # Universal gas constant in J/(mol·K)\n    TC = 304.1282      # Critical temperature in K\n    PC = 7.3773e6      # Critical pressure in Pa\n    OMEGA = 0.22394    # Acentric factor (dimensionless)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (323.0, 1.0e7),      # Case A: Supercritical\n        (304.1282, 7.3773e6),# Case B: Near-critical\n        (400.0, 3.0e7),      # Case C: High pressure\n        (350.0, 1.0e6),      # Case D: Gas-like\n        (650.0, 1.0e8),      # Case E: Very high P, T\n    ]\n\n    def solve_molar_volume(T, P_target, R_const, Tc_const, Pc_const, omega_const):\n        \"\"\"\n        Solves for molar volume v for a single (T, P) pair.\n        \n        Args:\n            T (float): Temperature in K.\n            P_target (float): Target pressure in Pa.\n            R_const (float): Universal gas constant.\n            Tc_const (float): Critical temperature.\n            Pc_const (float): Critical pressure.\n            omega_const (float): Acentric factor.\n\n        Returns:\n            float: Molar volume in m^3/mol, or np.nan if not converged.\n        \"\"\"\n        # 1. Calculate Peng-Robinson EOS parameters\n        a = 0.45724 * (R_const**2 * Tc_const**2) / Pc_const\n        b = 0.07780 * (R_const * Tc_const) / Pc_const\n        kappa = 0.37464 + 1.54226 * omega_const - 0.26992 * omega_const**2\n        alpha = (1 + kappa * (1 - np.sqrt(T / Tc_const)))**2\n        \n        a_alpha = a * alpha\n\n        # 2. Define residual function f(v) and its derivative f'(v)\n        def f(v):\n            \"\"\"Residual function f(v) = P_PR(v) - P_target.\"\"\"\n            # Denominator of the attractive term\n            den_attractive = v**2 + 2 * b * v - b**2\n            if den_attractive == 0: return np.inf\n            \n            P_pr = (R_const * T / (v - b)) - (a_alpha / den_attractive)\n            return P_pr - P_target\n\n        def f_prime(v):\n            \"\"\"Derivative of the residual function, df/dv.\"\"\"\n            v_minus_b_sq = (v - b)**2\n            if v_minus_b_sq == 0: return -np.inf\n\n            term1_prime = -R_const * T / v_minus_b_sq\n            \n            den_attractive = v**2 + 2 * b * v - b**2\n            if den_attractive == 0: return -np.inf\n            \n            num_attractive_prime = 2 * a_alpha * (v + b)\n            den_attractive_sq = den_attractive**2\n            if den_attractive_sq == 0: return -np.inf\n            \n            term2_prime = num_attractive_prime / den_attractive_sq\n            return term1_prime + term2_prime\n\n        # 3. Newton-Raphson iteration\n        # Initial guess from the ideal gas law\n        v_k = R_const * T / P_target\n\n        # Iteration parameters\n        max_iter = 50\n        tolerance = 1e-12\n\n        for _ in range(max_iter):\n            f_val = f(v_k)\n            fp_val = f_prime(v_k)\n\n            # Avoid division by zero if derivative is flat\n            if abs(fp_val)  1e-20:\n                break\n\n            delta_v = -f_val / fp_val\n            v_k_plus_1 = v_k + delta_v\n            \n            # Safeguard: ensure volume is physical (v > b).\n            # Apply damping (step halving) if the step overshoots.\n            damping_iter = 0\n            while v_k_plus_1 = b:\n                delta_v /= 2.0\n                v_k_plus_1 = v_k + delta_v\n                damping_iter += 1\n                if damping_iter > 50: # Failsafe\n                    return np.nan \n\n            # Check for convergence based on relative step size\n            if abs(v_k_plus_1 - v_k) / abs(v_k_plus_1)  tolerance:\n                return v_k_plus_1\n\n            v_k = v_k_plus_1\n        \n        return np.nan # Return NaN if convergence is not reached\n\n    results = []\n    for T, P in test_cases:\n        molar_volume = solve_molar_volume(T, P, R, TC, PC, OMEGA)\n        results.append(molar_volume)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In most geological settings, chemical reactions occur within a flowing fluid, not a static batch system. This practice explores the critical interplay between fluid advection and reaction kinetics by guiding you through the derivation of the Damköhler number ($Da$) from a fundamental mass balance equation . Understanding how to formulate and interpret this dimensionless group is essential for diagnosing whether a geochemical process is primarily limited by the rate of chemical reaction or the rate of mass transport.",
            "id": "4089480",
            "problem": "A single fracture of uniform aperture in a silicate caprock is flushed by aqueous fluid in equilibrium with supercritical carbon dioxide (scCO$_2$) at elevated temperature and pressure. Within the fracture, dissolution of a reactive mineral is well represented locally by a pseudo-first-order rate law in the reactive driving force, with effective rate constant $k$ that is uniform in space and time over the time window of interest. The fluid flows at constant interstitial velocity $U$ along the fracture of length $L$, and molecular diffusion and dispersion are negligible compared to advection. Density and porosity may be taken as constant. The concentration field of a representative reactive scalar $C(x,t)$ obeys one-dimensional advection-reaction dynamics along the flow direction.\n\nStarting from conservation of mass for the dissolved reactive scalar and the given kinetic assumption, construct the steady, one-dimensional advection-reaction balance, non-dimensionalize the equation using the characteristic length $L$ and characteristic velocity $U$, and identify the single dimensionless group that compares the characteristic time of chemical reaction with the characteristic time of advection across the fracture length. Evaluate this dimensionless group for the following conditions representative of scCO$_2$-bearing brine at elevated conditions: temperature $T = 333$ K, pressure $P = 12$ MPa (these thermodynamic conditions are provided for context; they do not directly enter the calculation), $k = 2.5 \\times 10^{-4}$ $\\mathrm{s^{-1}}$, $U = 3.0 \\times 10^{-4}$ $\\mathrm{m\\,s^{-1}}$, and $L = 0.75$ m.\n\nBased on the magnitude of this dimensionless group, assess whether dissolution is predominantly reaction-controlled or transport-controlled under these conditions, and justify your assessment from the non-dimensional balance.\n\nReport your final numerical value for the dimensionless group, rounded to three significant figures. No units are required for the reported number.",
            "solution": "The problem requires the derivation and analysis of a one-dimensional, steady-state advection-reaction model for mineral dissolution in a fracture. The final goal is to calculate a dimensionless number that characterizes the system and use it to determine the rate-controlling regime.\n\nThe first step is to establish the governing equation from the principle of mass conservation for the dissolved reactive scalar, whose concentration is denoted by $C(x,t)$. The one-dimensional conservation equation is:\n$$ \\frac{\\partial C}{\\partial t} + \\frac{\\partial J}{\\partial x} = R $$\nwhere $t$ is time, $x$ is the spatial coordinate along the fracture, $J$ is the flux of the scalar, and $R$ is the net rate of production (source/sink term) per unit volume of fluid.\n\nThe problem states that molecular diffusion and dispersion are negligible compared to advection. Therefore, the flux $J$ is purely advective:\n$$ J = U C $$\nwhere $U$ is the constant interstitial fluid velocity.\n\nThe reaction is the dissolution of a reactive mineral, which adds the scalar to the fluid. The rate is described by a pseudo-first-order law in the reactive driving force. The driving force for dissolution is the difference between the equilibrium concentration, $C_{eq}$, and the local concentration, $C$. The source term $R$ is thus proportional to this driving force:\n$$ R = k(C_{eq} - C) $$\nHere, $k$ is the effective rate constant with units of inverse time (s$^{-1}$). This formulation is consistent with dissolution: if the fluid is undersaturated ($C  C_{eq}$), then $R  0$, and the concentration tends to increase.\n\nSubstituting the expressions for $J$ and $R$ into the conservation equation, and noting that $U$ is constant, we obtain the one-dimensional advection-reaction equation:\n$$ \\frac{\\partial C}{\\partial t} + U \\frac{\\partial C}{\\partial x} = k(C_{eq} - C) $$\nThe problem asks for the steady-state balance, which is achieved when the concentration field no longer changes with time, i.e., $\\frac{\\partial C}{\\partial t} = 0$. The governing equation simplifies to an ordinary differential equation (ODE):\n$$ U \\frac{dC}{dx} = k(C_{eq} - C) $$\nNext, we non-dimensionalize this equation. The problem specifies the characteristic length $L$ (the fracture length) and characteristic velocity $U$. We define a dimensionless position variable $x'$:\n$$ x' = \\frac{x}{L} $$\nTo define a dimensionless concentration, we normalize the concentration change relative to the total possible change. Let the concentration at the fracture inlet ($x=0$) be $C_{in}$. The concentration $C$ will vary between $C_{in}$ and $C_{eq}$. We define a dimensionless concentration $\\theta$:\n$$ \\theta = \\frac{C - C_{in}}{C_{eq} - C_{in}} $$\nFrom these definitions, we find the derivatives and terms needed for substitution:\n$$ C = C_{in} + \\theta (C_{eq} - C_{in}) \\implies \\frac{dC}{dx} = (C_{eq} - C_{in}) \\frac{d\\theta}{dx} $$\nUsing the chain rule, $\\frac{d\\theta}{dx} = \\frac{d\\theta}{dx'} \\frac{dx'}{dx} = \\frac{1}{L} \\frac{d\\theta}{dx'}$. Therefore:\n$$ \\frac{dC}{dx} = \\frac{C_{eq} - C_{in}}{L} \\frac{d\\theta}{dx'} $$\nThe reaction term can also be expressed in terms of $\\theta$:\n$$ k(C_{eq} - C) = k(C_{eq} - (C_{in} + \\theta (C_{eq} - C_{in}))) = k(1 - \\theta)(C_{eq} - C_{in}) $$\nSubstituting these expressions into the steady-state ODE:\n$$ U \\left( \\frac{C_{eq} - C_{in}}{L} \\frac{d\\theta}{dx'} \\right) = k(1 - \\theta)(C_{eq} - C_{in}) $$\nAssuming a non-zero driving force ($C_{eq} \\neq C_{in}$), we can divide both sides by $(C_{eq} - C_{in})$:\n$$ \\frac{U}{L} \\frac{d\\theta}{dx'} = k(1 - \\theta) $$\nRearranging this equation to group the parameters yields the final non-dimensional form:\n$$ \\frac{d\\theta}{dx'} = \\left( \\frac{kL}{U} \\right) (1 - \\theta) $$\nThe single dimensionless group that appears is $\\frac{kL}{U}$. This group is the Damköhler number, commonly denoted as $Da$. It compares the characteristic time of advection ($ \\tau_{\\text{adv}} = L/U $) with the characteristic time of reaction ($ \\tau_{\\text{react}} = 1/k $):\n$$ Da = \\frac{kL}{U} = \\frac{L/U}{1/k} = \\frac{\\tau_{\\text{adv}}}{\\tau_{\\text{react}}} $$\nThis is precisely the group that \"compares the characteristic time of chemical reaction with the characteristic time of advection across the fracture length\".\n\nNow, we evaluate this dimensionless group using the provided values:\n- $k = 2.5 \\times 10^{-4}$ $\\mathrm{s^{-1}}$\n- $U = 3.0 \\times 10^{-4}$ $\\mathrm{m\\,s^{-1}}$\n- $L = 0.75$ m\n\n$$ Da = \\frac{(2.5 \\times 10^{-4} \\text{ s}^{-1}) (0.75 \\text{ m})}{3.0 \\times 10^{-4} \\text{ m s}^{-1}} = \\frac{2.5 \\times 0.75}{3.0} = \\frac{1.875}{3.0} = 0.625 $$\nThe value of the dimensionless group is $0.625$.\n\nFinally, we assess the controlling regime based on the magnitude of the Damköhler number.\n- If $Da \\gg 1$, then $\\tau_{\\text{adv}} \\gg \\tau_{\\text{react}}$. The reaction is much faster than transport. The system would quickly reach chemical equilibrium ($C \\to C_{eq}$, or $\\theta \\to 1$). The overall rate of dissolution would be limited by the rate at which advection transports undersaturated fluid into the fracture. This is the **transport-controlled** regime.\n- If $Da \\ll 1$, then $\\tau_{\\text{adv}} \\ll \\tau_{\\text{react}}$. The transport is much faster than the reaction. The fluid resides in the fracture for a time too short for the reaction to proceed significantly toward equilibrium. The overall rate of dissolution is limited by the slow chemical kinetics. This is the **reaction-controlled** regime.\n\nOur calculated value is $Da = 0.625$. Since $Da  1$, the characteristic time for advection ($L/U$) is shorter than the characteristic time for reaction ($1/k$). This indicates that the chemical kinetics are the slower, rate-limiting process. Therefore, the dissolution is predominantly **reaction-controlled**.\n\nThis conclusion is justified by the non-dimensional balance $\\frac{d\\theta}{dx'} = Da(1-\\theta)$. With $Da = 0.625$, the dimensionless concentration gradient $\\frac{d\\theta}{dx'}$ is of a magnitude less than $1$ (near the inlet where $1-\\theta \\approx 1$). This implies a gradual increase in concentration along the fracture, rather than a sharp front characteristic of a transport-limited system. The extent of reaction over the fracture length $L$ is limited by the rate constant $k$, not the fluid velocity $U$.\n\nThe final requested value is the dimensionless group, rounded to three significant figures. The calculated value $0.625$ already has three significant figures.",
            "answer": "$$\\boxed{0.625}$$"
        },
        {
            "introduction": "The heart of fluid-rock interaction is the mineral-fluid interface, a complex zone where aqueous chemistry, surface reactions, and electrostatic forces are coupled. This advanced computational practice challenges you to construct and solve the system of non-linear equations that defines a two-layer surface complexation model . Successfully building this model demonstrates a comprehensive ability to integrate multiple geochemical principles into a cohesive, predictive tool for simulating interfacial processes under supercritical conditions.",
            "id": "4089409",
            "problem": "Consider a uniform mineral surface with amphoteric functional groups interacting with an aqueous solution in contact with supercritical carbon dioxide. Model the system using a two-layer surface complexation framework with a compact inner layer (the $0$-plane) and a diffuse layer (the $d$-plane). The aqueous solution is a carbon dioxide–water mixture at elevated temperature and pressure such that carbon dioxide is supercritical. Assume a single type of amphoteric site, denoted as $\\mathrm{S{-}OH}$, that can protonate to $\\mathrm{S{-}OH_2^+}$ and deprotonate to $\\mathrm{S{-}O^-}$. There is no specific ion adsorption beyond the electrostatic double layer, and activity coefficients are taken as unity. The compact layer is represented by a single capacitance between the $0$-plane and the $d$-plane.\n\nStarting only from fundamental bases appropriate to computational geochemistry and electrochemistry:\n- The law of mass action for chemical equilibria and activities,\n- Henry’s law (with fugacity) for dissolved carbon dioxide in water,\n- The acid dissociation equilibria of carbonic acid and water autoprotolysis,\n- Electroneutrality of the bulk aqueous solution,\n- The capacitor relation for the compact layer,\n- The Poisson–Boltzmann description of the diffuse layer for a symmetric electrolyte using ionic strength,\n\nset up the mathematical system needed to compute the following unknowns:\n- The bulk aqueous hydrogen ion concentration $[ \\mathrm{H^+} ]$ and bulk pH,\n- The surface site fractions $\\theta_{+}$, $\\theta_{0}$, and $\\theta_{-}$ for $\\mathrm{S{-}OH_2^+}$, $\\mathrm{S{-}OH}$, and $\\mathrm{S{-}O^-}$, respectively,\n- The electrostatic potentials $\\psi_0$ at the $0$-plane and $\\psi_d$ at the $d$-plane.\n\nDefine the surface site balance, the mass action relations at the $0$-plane using activities at the plane, the compact layer charge–potential relation, and the diffuse layer charge–potential relation. The solution must enforce charge neutrality between the $0$-plane and the diffuse layer.\n\nUse the following physically consistent parameterization and constants:\n- Temperature $T$ in kelvin,\n- Total pressure is large, and the carbon dioxide fugacity is $f_{\\mathrm{CO_2}} = \\varphi \\, p_{\\mathrm{CO_2}}$, where $\\varphi$ is the fugacity coefficient (dimensionless) and $p_{\\mathrm{CO_2}}$ is the partial pressure of carbon dioxide in bar,\n- Henry’s law for the bulk dissolved carbon dioxide concentration: $[\\mathrm{CO_2^*}] = k_H \\, f_{\\mathrm{CO_2}}$, where $k_H$ is Henry’s constant having units of $\\mathrm{mol\\,L^{-1}\\,bar^{-1}}$, and $\\mathrm{CO_2^*}$ includes $\\mathrm{CO_2(aq)}$ and $\\mathrm{H_2CO_3}$,\n- Carbonic acid dissociation constants $K_{a1}$ and $K_{a2}$, and water autoprotolysis constant $K_w$, all expressed on the molarity standard state,\n- Intrinsic surface equilibrium constants (dimensionless) $K_1$ for $\\mathrm{S{-}OH} + \\mathrm{H^+} \\rightleftharpoons \\mathrm{S{-}OH_2^+}$ and $K_2$ for $\\mathrm{S{-}OH} \\rightleftharpoons \\mathrm{S{-}O^-} + \\mathrm{H^+}$,\n- Total site density per area $\\Gamma_T$ in $\\mathrm{mol\\,m^{-2}}$,\n- Inner layer capacitance $C_1$ in $\\mathrm{F\\,m^{-2}}$,\n- Relative permittivity of water $\\varepsilon_r$ (dimensionless). The absolute permittivity is $\\varepsilon = \\varepsilon_r \\varepsilon_0$ with vacuum permittivity $\\varepsilon_0$.\n\nConstants to use in the computations:\n- Universal gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$,\n- Faraday constant $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$,\n- Vacuum permittivity $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$.\n\nThe bulk carbonate system should be computed from:\n- Henry’s law for $[\\mathrm{CO_2^*}]$,\n- Acid dissociation relationships $[\\mathrm{HCO_3^-}] = K_{a1} [\\mathrm{CO_2^*}] / [\\mathrm{H^+}]$ and $[\\mathrm{CO_3^{2-}}] = K_{a2} [\\mathrm{HCO_3^-}] / [\\mathrm{H^+}]$,\n- Water autoprotolysis $[\\mathrm{OH^-}] = K_w / [\\mathrm{H^+}]$,\n- Bulk electroneutrality $[\\mathrm{H^+}] = [\\mathrm{HCO_3^-}] + 2 [\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}]$.\n\nThe ionic strength $I$ in the bulk should be computed as $I = \\tfrac{1}{2} \\sum_i z_i^2 c_i$, in $\\mathrm{mol\\,L^{-1}}$, where the sum runs over $\\mathrm{H^+}$, $\\mathrm{OH^-}$, $\\mathrm{HCO_3^-}$, and $\\mathrm{CO_3^{2-}}$. Use the symmetric electrolyte approximation for the diffuse layer charge–potential relation expressed in terms of $I$.\n\nYour program must implement a robust numerical algorithm to solve this coupled system for each test case specified below. Ensure scientific realism by using the stated constants and relations without introducing shortcuts or pre-specified target formulas. Express all potentials in volts and all concentrations in $\\mathrm{mol\\,L^{-1}}$. Compute pH as $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$. The final numerical outputs must be floats rounded to six decimal places.\n\nTest suite:\n- Case A (general supercritical interaction): $T = 323\\,\\mathrm{K}$, $p_{\\mathrm{CO_2}} = 100\\,\\mathrm{bar}$, $\\varphi = 0.7$, $k_H = 0.02\\,\\mathrm{mol\\,L^{-1}\\,bar^{-1}}$, $K_{a1} = 1.0 \\times 10^{-6}$, $K_{a2} = 1.0 \\times 10^{-10}$, $K_w = 5.0 \\times 10^{-14}$, $K_1 = 1.0 \\times 10^{-4}$, $K_2 = 1.0 \\times 10^{-8}$, $\\Gamma_T = 5.0 \\times 10^{-6}\\,\\mathrm{mol\\,m^{-2}}$, $C_1 = 1.1\\,\\mathrm{F\\,m^{-2}}$, $\\varepsilon_r = 70.0$.\n- Case B (lower carbon dioxide loading): $T = 323\\,\\mathrm{K}$, $p_{\\mathrm{CO_2}} = 5\\,\\mathrm{bar}$, $\\varphi = 0.9$, $k_H = 0.02\\,\\mathrm{mol\\,L^{-1}\\,bar^{-1}}$, $K_{a1} = 1.0 \\times 10^{-6}$, $K_{a2} = 1.0 \\times 10^{-10}$, $K_w = 5.0 \\times 10^{-14}$, $K_1 = 1.0 \\times 10^{-4}$, $K_2 = 1.0 \\times 10^{-8}$, $\\Gamma_T = 5.0 \\times 10^{-6}\\,\\mathrm{mol\\,m^{-2}}$, $C_1 = 1.1\\,\\mathrm{F\\,m^{-2}}$, $\\varepsilon_r = 70.0$.\n- Case C (boundary: very low site density, high capacitance): $T = 323\\,\\mathrm{K}$, $p_{\\mathrm{CO_2}} = 100\\,\\mathrm{bar}$, $\\varphi = 0.7$, $k_H = 0.02\\,\\mathrm{mol\\,L^{-1}\\,bar^{-1}}$, $K_{a1} = 1.0 \\times 10^{-6}$, $K_{a2} = 1.0 \\times 10^{-10}$, $K_w = 5.0 \\times 10^{-14}$, $K_1 = 1.0 \\times 10^{-4}$, $K_2 = 1.0 \\times 10^{-8}$, $\\Gamma_T = 1.0 \\times 10^{-7}\\,\\mathrm{mol\\,m^{-2}}$, $C_1 = 5.0\\,\\mathrm{F\\,m^{-2}}$, $\\varepsilon_r = 70.0$.\n\nRequired final output for your program:\n- For each case, produce the list $[ \\mathrm{pH}, \\theta_{+}, \\theta_{-}, \\psi_0, \\psi_d ]$ where $\\mathrm{pH}$ is unitless, $\\theta_{+}$ and $\\theta_{-}$ are unitless fractions, and $\\psi_0$ and $\\psi_d$ are in volts. Each float must be rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one entry per test case. For example, a valid output for three cases has the form $[[x_1,x_2,x_3,x_4,x_5],[y_1,y_2,y_3,y_4,y_5],[z_1,z_2,z_3,z_4,z_5]]$, where there are no spaces anywhere in the output.",
            "solution": "The problem requires the formulation and numerical solution of a coupled system of equations describing the geochemical interactions at a mineral-water interface under supercritical carbon dioxide conditions. The model incorporates bulk aqueous equilibria, surface complexation on amphoteric sites, and an electrostatic double layer. The solution is developed by first establishing the governing equations from fundamental principles and then devising a numerical algorithm to solve them.\n\n### Part 1: Bulk Aqueous Solution Chemistry\n\nThe bulk aqueous solution is in equilibrium with a supercritical $\\mathrm{CO_2}$ phase. The composition of this solution provides the far-field boundary condition for the surface model.\n\n1.  **Dissolved Carbon Dioxide**: Per Henry's law, the concentration of dissolved aqueous $\\mathrm{CO_2}$ (denoted $\\mathrm{CO_2^*}$, which includes both $\\mathrm{CO_2(aq)}$ and $\\mathrm{H_2CO_3}$) is determined by the fugacity of $\\mathrm{CO_2}$, $f_{\\mathrm{CO_2}}$. The fugacity is given by $f_{\\mathrm{CO_2}} = \\varphi \\, p_{\\mathrm{CO_2}}$.\n    $$[\\mathrm{CO_2^*}] = k_H \\, f_{\\mathrm{CO_2}} = k_H \\, \\varphi \\, p_{\\mathrm{CO_2}}$$\n    This concentration is constant for a given temperature $T$ and partial pressure $p_{\\mathrm{CO_2}}$.\n\n2.  **Aqueous Equilibria**: The dissolved $\\mathrm{CO_2^*}$ establishes a series of equilibria characteristic of the carbonate system. Let $h_{bulk} = [\\mathrm{H^+}]$ be the bulk hydrogen ion concentration. The concentrations of bicarbonate, carbonate, and hydroxide ions are given by the law of mass action for their respective dissociation reactions (assuming unit activity coefficients):\n    $$[\\mathrm{HCO_3^-}] = \\frac{K_{a1} [\\mathrm{CO_2^*}]}{h_{bulk}}$$\n    $$[\\mathrm{CO_3^{2-}}] = \\frac{K_{a2} [\\mathrm{HCO_3^-}]}{h_{bulk}} = \\frac{K_{a1} K_{a2} [\\mathrm{CO_2^*}]}{h_{bulk}^2}$$\n    $$[\\mathrm{OH^-}] = \\frac{K_w}{h_{bulk}}$$\n\n3.  **Bulk Electroneutrality**: The bulk solution must be electrically neutral. The sum of positive charges must equal the sum of negative charges.\n    $$[\\mathrm{H^+}] = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}]$$\n    Substituting the equilibrium expressions into the charge balance equation yields a single equation for the unknown $h_{bulk}$:\n    $$h_{bulk} = \\frac{K_{a1} [\\mathrm{CO_2^*}]}{h_{bulk}} + 2 \\frac{K_{a1} K_{a2} [\\mathrm{CO_2^*}]}{h_{bulk}^2} + \\frac{K_w}{h_{bulk}}$$\n    Multiplying by $h_{bulk}^2$ and rearranging gives a cubic polynomial in $h_{bulk}$:\n    $$h_{bulk}^3 - (K_{a1} [\\mathrm{CO_2^*}] + K_w) h_{bulk} - 2 K_{a1} K_{a2} [\\mathrm{CO_2^*}] = 0$$\n    This equation can be solved numerically to find the unique positive real root for $h_{bulk}$.\n\n4.  **Ionic Strength**: Once $h_{bulk}$ is known, all other bulk species concentrations can be calculated. The ionic strength $I$ of the bulk solution, required for the electrostatic model, is then computed as:\n    $$I = \\frac{1}{2} \\sum_i c_i z_i^2 = \\frac{1}{2} ([\\mathrm{H^+}] (1)^2 + [\\mathrm{OH^-}] (-1)^2 + [\\mathrm{HCO_3^-}] (-1)^2 + [\\mathrm{CO_3^{2-}}] (-2)^2)$$\n    $$I = \\frac{1}{2} (h_{bulk} + [\\mathrm{OH^-}] + [\\mathrm{HCO_3^-}] + 4[\\mathrm{CO_3^{2-}}])$$\n    Note that ionic strength $I$ is in units of $\\mathrm{mol\\,L^{-1}}$. For use with other SI constants, it must be converted to $\\mathrm{mol\\,m^{-3}}$ by multiplying by $1000\\,\\mathrm{L\\,m^{-3}}$.\n\n### Part 2: Surface Complexation and Electrostatic Model\n\nThe mineral surface contains amphoteric sites $\\mathrm{S{-}OH}$ that react with hydrogen ions. This process is coupled with the development of an electrostatic potential at the surface.\n\n1.  **Surface Reactions**: The surface sites undergo protonation and deprotonation according to the following equilibria, with intrinsic constants $K_1$ and $K_2$:\n    $$\\mathrm{S{-}OH} + \\mathrm{H^+} \\xrightleftharpoons{K_1} \\mathrm{S{-}OH_2^+}$$\n    $$\\mathrm{S{-}OH} \\xrightleftharpoons{K_2} \\mathrm{S{-}O^-} + \\mathrm{H^+}$$\n    The problem specifies that these constants are dimensionless. This implies that the activity of $\\mathrm{H^+}$ in the mass-action expressions is taken relative to a standard state of $1\\,\\mathrm{mol\\,L^{-1}}$.\n\n2.  **Surface Mass Action and Electrostatics**: The activity of an ion at the surface is related to its bulk activity via the Boltzmann distribution. For $\\mathrm{H^+}$ at the $0$-plane, where the potential is $\\psi_0$:\n    $$\\{\\mathrm{H^+}\\}_0 = [\\mathrm{H^+}]_{bulk} \\exp\\left(\\frac{-e \\psi_0}{k_B T}\\right) = h_{bulk} \\exp\\left(\\frac{-F \\psi_0}{R T}\\right)$$\n    where $F$ is the Faraday constant, $R$ is the universal gas constant, and $T$ is the absolute temperature. The law of mass action for the surface reactions, with surface species activities given by their site fractions ($\\theta_{+}$, $\\theta_{0}$, $\\theta_{-}$), becomes:\n    $$K_1 = \\frac{\\theta_{+}}{\\theta_{0} \\{\\mathrm{H^+}\\}_0} \\implies \\theta_{+} = K_1 \\theta_{0} h_{bulk} \\exp\\left(\\frac{-F \\psi_0}{R T}\\right)$$\n    $$K_2 = \\frac{\\theta_{-} \\{\\mathrm{H^+}\\}_0}{\\theta_{0}} \\implies \\theta_{-} = K_2 \\frac{\\theta_{0}}{h_{bulk} \\exp\\left(\\frac{-F \\psi_0}{R T}\\right)}$$\n\n3.  **Site Balance and Site Fractions**: The sum of the site fractions must be unity:\n    $$\\theta_{+} + \\theta_{0} + \\theta_{-} = 1$$\n    Substituting the expressions for $\\theta_{+}$ and $\\theta_{-}$ allows us to solve for the fractions as a function of $\\psi_0$:\n    $$\\theta_{0} \\left( K_1 h_{bulk} e^{\\frac{-F \\psi_0}{R T}} + 1 + \\frac{K_2}{h_{bulk} e^{\\frac{-F \\psi_0}{R T}}} \\right) = 1$$\n    Let the denominator be $D = 1 + K_1 h_{bulk} e^{\\frac{-F \\psi_0}{R T}} + K_2 / (h_{bulk} e^{\\frac{-F \\psi_0}{R T}})$.\n    Then the site fractions are:\n    $$\\theta_{0}(\\psi_0) = \\frac{1}{D} \\quad, \\quad \\theta_{+}(\\psi_0) = \\frac{K_1 h_{bulk} e^{\\frac{-F \\psi_0}{R T}}}{D} \\quad, \\quad \\theta_{-}(\\psi_0) = \\frac{K_2 / (h_{bulk} e^{\\frac{-F \\psi_0}{R T}})}{D}$$\n\n4.  **Surface Charge Density ($\\sigma_0$)**: The net charge density at the $0$-plane is due to the charged surface species. With a total site density of $\\Gamma_T$ ($\\mathrm{mol\\,m^{-2}}$):\n    $$\\sigma_0(\\psi_0) = F (\\Gamma_T \\theta_{+} - \\Gamma_T \\theta_{-}) = F \\Gamma_T (\\theta_{+}(\\psi_0) - \\theta_{-}(\\psi_0))$$\n\n### Part 3: The Coupled System of Equations\n\nThe system is closed by linking the surface charge to the electrostatic potentials via the two-layer model.\n\n1.  **Compact Layer**: The region between the $0$-plane (potential $\\psi_0$) and the $d$-plane (potential $\\psi_d$) is modeled as a capacitor with capacitance $C_1$:\n    $$\\sigma_0 = C_1 (\\psi_0 - \\psi_d)$$\n\n2.  **Diffuse Layer**: The charge density in the diffuse layer, $\\sigma_d$, balances the potential $\\psi_d$. Following the prompt, we use the Grahame equation for a symmetric 1:1 electrolyte, but with the calculated ionic strength $I$ of the actual solution:\n    $$\\sigma_d = -\\sqrt{8 \\varepsilon_0 \\varepsilon_r R T (1000 I)} \\sinh\\left(\\frac{F \\psi_d}{2 R T}\\right)$$\n    where $\\varepsilon_0$ is the vacuum permittivity, $\\varepsilon_r$ is the relative permittivity of water, and the factor of $1000$ converts $I$ from $\\mathrm{mol\\,L^{-1}}$ to $\\mathrm{mol\\,m^{-3}}$.\n\n3.  **Overall Charge Neutrality**: The entire interface is neutral, so the surface charge must be balanced by the diffuse layer charge:\n    $$\\sigma_0 + \\sigma_d = 0 \\implies \\sigma_0 = -\\sigma_d$$\n\n4.  **Final Residual Equation**: We have a system of two equations for the two unknowns $\\psi_0$ and $\\psi_d$:\n    (i) $\\sigma_0(\\psi_0) = C_1 (\\psi_0 - \\psi_d)$\n    (ii) $\\sigma_0(\\psi_0) = \\sqrt{8 \\varepsilon_0 \\varepsilon_r R T (1000 I)} \\sinh\\left(\\frac{F \\psi_d}{2 R T}\\right)$\n    We can express $\\psi_d$ from (i) as $\\psi_d = \\psi_0 - \\sigma_0(\\psi_0)/C_1$ and substitute it into (ii). This yields a single, highly non-linear residual equation for $\\psi_0$:\n    $$F_{resid}(\\psi_0) = \\sigma_0(\\psi_0) - \\sqrt{8 \\varepsilon_0 \\varepsilon_r R T (1000 I)} \\sinh\\left( \\frac{F}{2 R T} \\left( \\psi_0 - \\frac{\\sigma_0(\\psi_0)}{C_1} \\right) \\right) = 0$$\n\n### Part 4: Numerical Solution Algorithm\n\nThe problem is solved using a two-step numerical procedure for each test case.\n\n1.  **Solve for Bulk Chemistry**: First, the cubic polynomial for $h_{bulk}$ is solved. With the known parameters for a given case ($k_H, \\varphi, p_{\\mathrm{CO_2}}, K_{a1}, K_{a2}, K_w$), the value of $[\\mathrm{CO_2^*}]$ is calculated. The coefficients of the cubic equation are determined, and its unique positive real root is found, yielding $h_{bulk}$. From this, the bulk $\\mathrm{pH}$, concentrations of all other ions, and the ionic strength $I$ are computed.\n\n2.  **Solve for Surface Properties**: With the bulk properties fixed, the residual equation $F_{resid}(\\psi_0) = 0$ is solved numerically for $\\psi_0$ using a root-finding algorithm (e.g., Brent's method).\n\n3.  **Calculate Final Outputs**: Once the self-consistent value of $\\psi_0$ is found, the other required quantities are calculated directly:\n    - The surface charge $\\sigma_0(\\psi_0)$ is computed.\n    - The potential $\\psi_d$ is found from $\\psi_d = \\psi_0 - \\sigma_0/C_1$.\n    - The site fractions $\\theta_{+}(\\psi_0)$ and $\\theta_{-}(\\psi_0)$ are calculated using their derived expressions.\n    - The bulk $\\mathrm{pH}$ is calculated as $\\mathrm{pH} = -\\log_{10}(h_{bulk})$.\n\nThe final output for each case is the vector $[\\mathrm{pH}, \\theta_{+}, \\theta_{-}, \\psi_0, \\psi_d]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the coupled geochemical and electrostatic system for mineral-fluid interactions.\n    \"\"\"\n    \n    # Define fundamental constants\n    R = 8.314462618  # J/mol/K\n    F = 96485.33212  # C/mol\n    EPSILON_0 = 8.8541878128e-12  # F/m\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case A: General supercritical interaction\n        {'T': 323.0, 'p_co2': 100.0, 'phi': 0.7, 'k_H': 0.02, 'K_a1': 1.0e-6,\n         'K_a2': 1.0e-10, 'K_w': 5.0e-14, 'K1': 1.0e-4, 'K2': 1.0e-8,\n         'Gamma_T': 5.0e-6, 'C1': 1.1, 'epsilon_r': 70.0},\n        # Case B: Lower carbon dioxide loading\n        {'T': 323.0, 'p_co2': 5.0, 'phi': 0.9, 'k_H': 0.02, 'K_a1': 1.0e-6,\n         'K_a2': 1.0e-10, 'K_w': 5.0e-14, 'K1': 1.0e-4, 'K2': 1.0e-8,\n         'Gamma_T': 5.0e-6, 'C1': 1.1, 'epsilon_r': 70.0},\n        # Case C: Boundary: very low site density, high capacitance\n        {'T': 323.0, 'p_co2': 100.0, 'phi': 0.7, 'k_H': 0.02, 'K_a1': 1.0e-6,\n         'K_a2': 1.0e-10, 'K_w': 5.0e-14, 'K1': 1.0e-4, 'K2': 1.0e-8,\n         'Gamma_T': 1.0e-7, 'C1': 5.0, 'epsilon_r': 70.0}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # --- Step 1: Solve for Bulk Aqueous Chemistry ---\n        f_co2 = case['phi'] * case['p_co2']\n        conc_co2_star = case['k_H'] * f_co2\n\n        # Solve h^3 - a*h - b = 0 for h = [H+]\n        a = case['K_a1'] * conc_co2_star + case['K_w']\n        b = 2 * case['K_a1'] * case['K_a2'] * conc_co2_star\n        poly_coeffs = [1, 0, -a, -b]\n        roots = np.roots(poly_coeffs)\n        \n        # Find the single positive real root for h_bulk\n        h_bulk = 0.0\n        for r in roots:\n            if np.isreal(r) and r > 0:\n                h_bulk = np.real(r)\n                break\n        \n        # Calculate bulk properties\n        pH = -np.log10(h_bulk)\n        conc_oh = case['K_w'] / h_bulk\n        conc_hco3 = case['K_a1'] * conc_co2_star / h_bulk\n        conc_co3 = case['K_a2'] * conc_hco3 / h_bulk\n        \n        # Ionic strength I in mol/L\n        I = 0.5 * (h_bulk + conc_oh + conc_hco3 + 4 * conc_co3)\n\n        # --- Step 2: Solve the Coupled Surface-Electrostatic System ---\n        RT = R * case['T']\n        F_RT = F / RT\n        \n        # Pre-calculate Grahame equation constant\n        epsilon = case['epsilon_r'] * EPSILON_0\n        grahame_const = np.sqrt(8 * epsilon * RT * (1000 * I)) # 1000 to convert I to mol/m^3\n\n        def calc_sigma0(psi_0):\n            # Calculate surface charge density as a function of psi_0\n            exp_term = np.exp(-F_RT * psi_0)\n            h_bulk_exp = h_bulk * exp_term\n            \n            denominator = 1.0 + case['K1'] * h_bulk_exp + case['K2'] / h_bulk_exp\n            \n            theta_plus = (case['K1'] * h_bulk_exp) / denominator\n            theta_minus = (case['K2'] / h_bulk_exp) / denominator\n            \n            sigma_0 = F * case['Gamma_T'] * (theta_plus - theta_minus)\n            return sigma_0, theta_plus, theta_minus\n\n        def residual(psi_0):\n            # Residual function F(psi_0) = 0\n            sigma_0, _, _ = calc_sigma0(psi_0)\n            psi_d = psi_0 - sigma_0 / case['C1']\n            \n            # Grahame equation for diffuse layer charge (sigma_d = -sigma_0)\n            sigma_d_calc = -grahame_const * np.sinh(F * psi_d / (2 * RT))\n            \n            return sigma_0 + sigma_d_calc\n\n        # Solve for psi_0 using a robust root-finder\n        sol = root_scalar(residual, bracket=[-0.5, 0.5], method='brentq')\n        psi_0 = sol.root\n\n        # --- Step 3: Calculate Final Outputs ---\n        sigma_0, theta_plus, theta_minus = calc_sigma0(psi_0)\n        psi_d = psi_0 - sigma_0 / case['C1']\n\n        # Format results for output string\n        case_result = [\n            f\"{pH:.6f}\",\n            f\"{theta_plus:.6f}\",\n            f\"{theta_minus:.6f}\",\n            f\"{psi_0:.6f}\",\n            f\"{psi_d:.6f}\"\n        ]\n        results.append(f\"[{','.join(case_result)}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}