{
    "hands_on_practices": [
        {
            "introduction": "建立污染物运移模型的第一步是理解污染物羽的迁移速度。本练习将引导你从基本原理（达西定律和质量守恒）出发，推导溶质运移速度，并通过滞留因子来量化吸附作用的减速效应。这是预测污染物到达时间的基石，也是评估场地风险的基础。",
            "id": "4086141",
            "problem": "一个性质均一的一维饱和含水层，在位置 $x=0$ 和时间 $t=0$ 时，接收到一个溶解溶质的瞬时阶跃输入。该含水层是均质和各向同性的，其水力传导系数为 $K$，水力梯度为 $i$，孔隙度为 $n$，容重为 $\\rho_b$。溶质经历线性瞬时平衡吸附，其特征由分配系数 $K_d$ 描述。在所考虑的运移距离内，弥散和一级衰减可以忽略不计。使用一个没有吸附作用的保守示踪剂作为参考。监测点位于源下游距离 $L$ 处。\n\n仅从达西定律以及包含在对流-弥散-反应方程（ADRE）中的液相和吸附相的质量守恒定律出发，推导在所述假设下溶质前缘的运动传播速度，并用它计算在 $x=L$ 处受阻滞溶质的穿透时间（相对于保守示踪剂）。然后使用以下数据对穿透时间进行数值评估：\n- 水力传导系数 $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$，\n- 水力梯度 $i = 1.0 \\times 10^{-2}$，\n- 孔隙度 $n = 0.30$，\n- 容重 $\\rho_b = 1600 \\,\\text{kg/m}^{3}$，\n- 分配系数 $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$，\n- 下游距离 $L = 100 \\,\\text{m}$。\n\n将最终穿透时间以天为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "本题要求推导受阻滞溶质的穿透时间并进行数值评估。推导必须从基本原理出发：达西定律和质量守恒定律。\n\n### 第1步：问题验证\n\n首先，根据指定标准验证问题陈述。\n\n**提取的已知条件：**\n- 系统：一维饱和含水层，均质，各向同性。\n- 输入：在 $x=0$, $t=0$ 时溶解溶质的瞬时阶跃输入。\n- 水力性质：水力传导系数 $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$，水力梯度 $i = 1.0 \\times 10^{-2}$，孔隙度 $n = 0.30$。\n- 含水层固体性质：容重 $\\rho_b = 1600 \\,\\text{kg/m}^{3}$。\n- 溶质性质：经历线性瞬时平衡吸附，其特征由分配系数 $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$ 描述。\n- 假设：弥散和一级衰减可以忽略。\n- 参考：使用保守示踪剂（无吸附，$K_d=0$）。\n- 监测点：下游距离 $L = 100 \\,\\text{m}$。\n- 任务：\n  1. 推导溶质前缘的运动传播速度。\n  2. 用它计算在 $x=L$ 处受阻滞溶质的穿透时间（相对于保守示踪剂）。\n  3. 以天为单位对穿透时间进行数值评估，并四舍五入到四位有效数字。\n\n**使用提取的已知条件进行验证：**\n- **科学依据：** 该问题基于对流-弥散-反应方程（ADRE）、达西定律和线性吸附概念，这些是污染物水文地质学和计算地球化学中的基本且普遍接受的原理。所作的假设（一维运移、可忽略的弥散/衰减、平衡吸附）是为获得解析解而采用的标准简化方法。\n- **适定性：** 该问题提供了所有必要的参数和一组清晰的初始/边界条件（阶跃输入）。它要求一个具体、可计算的量（穿透时间）。存在唯一且有意义的解。\n- **客观性：** 问题陈述使用了精确、定量且无偏见的语言。所有术语均为该学科内的标准术语。\n\n**结论：** 该问题有效。这是一个标准的、适定的问题，可以使用既定的科学原理解答。\n\n### 第2步：推导与求解\n\n求解过程首先推导在给定条件下溶质运移的控制性偏微分方程，然后求解溶质速度和穿透时间。\n\n**控制方程的推导**\n一维多孔介质中溶质的质量守恒原理指出，控制体积内总溶质质量的时间变化率与跨越其边界的溶质净通量以及任何内部源或汇相平衡。对于单位体积的含水层，这表示为：\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b S) = -\\frac{\\partial J}{\\partial x} - \\text{Reactions}\n$$\n其中：\n- $C$ 是溶质的液相浓度 [质量/流体体积]。\n- $S$ 是溶质的吸附浓度 [溶质质量/固体质量]。\n- $n$ 是孔隙度 [无量纲]。\n- $\\rho_b$ 是多孔介质的容重 [固体质量/含水层体积]。\n- $J$ 是总溶质通量 [质量/面积/时间]。\n- $nC + \\rho_b S$ 项代表含水层单位总体积内的总溶质质量。\n\n问题陈述一级衰减可以忽略，因此反应项为零。总通量 $J$ 是对流通量和弥散通量之和。对流通量是 $J_{adv} = qC$，其中 $q$ 是达西通量。根据假设，弥散通量可以忽略。因此，总通量为 $J = qC$。\n\n质量守恒方程简化为：\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b S) = -\\frac{\\partial (qC)}{\\partial x}\n$$\n问题指明了线性瞬时平衡吸附，其关系由 $S = K_d C$ 描述，其中 $K_d$ 是分配系数。将此代入守恒方程：\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b K_d C) = -\\frac{\\partial (qC)}{\\partial x}\n$$\n由于对于均质含水层，$n$、$\\rho_b$ 和 $K_d$ 是常数，我们可以将它们从时间导数中提出。含水层也是均一的，意味着水力性质是恒定的，因此达西通量 $q$ 相对于位置 $x$ 也是恒定的。\n$$\n(n + \\rho_b K_d) \\frac{\\partial C}{\\partial t} = -q \\frac{\\partial C}{\\partial x}\n$$\n为了将此方程表示为ADRE的标准形式，我们除以孔隙度 $n$：\n$$\n\\left(1 + \\frac{\\rho_b K_d}{n}\\right) \\frac{\\partial C}{\\partial t} = -\\frac{q}{n} \\frac{\\partial C}{\\partial x}\n$$\n我们定义两个关键参数。首先是**阻滞因子** $R$：\n$$\nR = 1 + \\frac{\\rho_b K_d}{n}\n$$\n其次是**平均线性地下水流速** $v$，即达西通量 $q$ 除以孔隙度 $n$。根据达西定律，$q = Ki$，其中 $K$ 是水力传导系数，$i$ 是水力梯度。\n$$\nv = \\frac{q}{n} = \\frac{Ki}{n}\n$$\n将这些定义代回方程，得到：\n$$\nR \\frac{\\partial C}{\\partial t} = -v \\frac{\\partial C}{\\partial x}\n$$\n整理后得到受阻滞溶质的一维对流方程的最终形式：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{v}{R} \\frac{\\partial C}{\\partial x} = 0\n$$\n这是一个一阶线性双曲型偏微分方程。它描述了浓度分布 $C(x,t)$ 以一个特征速度传播。\n\n**运动传播速度和穿透时间**\n从上面推导的对流方程可知，**溶质前缘的运动传播速度**（记作 $v_c$）是空间导数项的系数：\n$$\nv_c = \\frac{v}{R}\n$$\n这是溶质前缘移动的速度。在距离源 $L$ 处的穿透时间 $t_c$ 是距离除以该速度：\n$$\nt_c = \\frac{L}{v_c} = \\frac{L}{v/R} = \\frac{LR}{v}\n$$\n对于保守示踪剂，吸附为零（$K_d=0$），因此其阻滞因子 $R_{tracer} = 1 + \\frac{\\rho_b \\cdot 0}{n} = 1$。示踪剂的速度是 $v_{tracer} = v/R_{tracer} = v$，其穿透时间是 $t_{tracer} = L/v$。\n\n因此，受阻滞溶质相对于保守示踪剂的穿透时间为：\n$$\nt_c = R \\cdot t_{tracer}\n$$\n受阻滞溶质的移动速度比保守地下水流（以及保守示踪剂）慢 $R$ 倍，其穿透时间也晚 $R$ 倍。\n\n为了计算数值，我们可以通过代入 $R$ 和 $v$ 的公式来使用 $t_c$ 的完整表达式：\n$$\nt_c = \\frac{L \\left(1 + \\frac{\\rho_b K_d}{n}\\right)}{Ki/n} = \\frac{Ln \\left(1 + \\frac{\\rho_b K_d}{n}\\right)}{Ki} = \\frac{L(n + \\rho_b K_d)}{Ki}\n$$\n\n**数值计算**\n我们已知以下数值：\n- $L = 100 \\,\\text{m}$\n- $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$\n- $i = 1.0 \\times 10^{-2}$\n- $n = 0.30$\n- $\\rho_b = 1600 \\,\\text{kg/m}^{3}$\n- $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$\n\n首先，我们计算分子项 $L(n + \\rho_b K_d)$：\n$$\n\\text{分子} = 100 \\,\\text{m} \\times \\left(0.30 + (1600 \\,\\text{kg/m}^{3} \\times 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg})\\right)\n$$\n$$\n\\text{分子} = 100 \\,\\text{m} \\times (0.30 + 0.32) = 100 \\,\\text{m} \\times 0.62 = 62 \\,\\text{m}\n$$\n接下来，我们计算分母项 $Ki$：\n$$\n\\text{分母} = (1.0 \\times 10^{-4} \\,\\text{m/s}) \\times (1.0 \\times 10^{-2}) = 1.0 \\times 10^{-6} \\,\\text{m/s}\n$$\n现在，我们计算穿透时间 $t_c$（单位：秒）：\n$$\nt_c = \\frac{62 \\,\\text{m}}{1.0 \\times 10^{-6} \\,\\text{m/s}} = 62 \\times 10^{6} \\,\\text{s} = 6.2 \\times 10^{7} \\,\\text{s}\n$$\n最后，我们将时间从秒转换为天。一天中的秒数为 $24 \\times 60 \\times 60 = 86400 \\,\\text{s}$。\n$$\nt_c (\\text{天}) = \\frac{6.2 \\times 10^{7} \\,\\text{s}}{86400 \\,\\text{s/day}} \\approx 717.59259... \\,\\text{天}\n$$\n根据要求将结果四舍五入到四位有效数字：\n$$\nt_c \\approx 717.6 \\,\\text{天}\n$$",
            "answer": "$$\n\\boxed{717.6}\n$$"
        },
        {
            "introduction": "在理解了羽流速度之后，下一个关键问题是它如何扩散。本练习将超越简单的扩散概念，探索由水流驱动的、具有各向异性特征的水动力弥散现象——其在流动方向上更强。你将从物理原理出发，推导弥散张量的数学形式，并用它来计算特定方向上的弥散系数。",
            "id": "4086189",
            "problem": "一个经历一级衰减自然衰减过程的溶解污染物羽，在一个具有稳定均匀地下水流速的饱和、均质、各向同性多孔介质中输运。平流-弥散-反应（ADR）模型假设质量守恒和线性菲克通量来表示展布。在此类介质中，水动力弥散沿流向增强，在垂直于流向的方向上减弱，具有特征性的纵向和横向弥散度。从仅因存在非零流速而被破坏的各向同性第一性原理出发，推导水动力弥散的容许二阶张量形式，并确定其标量系数如何与纵向弥散度和横向弥散度相关。\n\n考虑地下水流速矢量 $\\mathbf{v} = \\left(2.0 \\times 10^{-4},\\,-1.5 \\times 10^{-4},\\,3.5 \\times 10^{-4}\\right)$ （单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$），纵向弥散度 $\\alpha_{L} = 10.0$ （单位为 $\\mathrm{m}$），横向弥散度 $\\alpha_{T} = 0.8$ （单位为 $\\mathrm{m}$），以及单位方向矢量 $\\mathbf{e} = \\frac{1}{\\sqrt{2}}(1,\\,0,\\,1)$。\n\n使用您构建的弥散张量，计算方向 $\\mathbf{e}$ 上的方向有效弥散系数 $D_{\\mathrm{eff}} = \\mathbf{e}^{\\top} \\mathbf{D}\\, \\mathbf{e}$。请用 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ 表示您的最终答案，并四舍五入到四位有效数字。",
            "solution": "首先对该问题进行验证过程，以确保其科学和逻辑的完整性。\n\n### 步骤1：提取已知条件\n问题陈述中提供了以下数据和定义：\n-   **系统**：饱和、均质、各向同性的多孔介质中的溶解污染物羽。\n-   **过程**：涉及输运和一级衰减的自然衰减。\n-   **输运模型**：平流-弥散-反应（ADR）模型。\n-   **弥散模型**：由流速增强的线性菲克通量。\n-   **地下水流速矢量**：$\\mathbf{v} = \\left(2.0 \\times 10^{-4},\\,-1.5 \\times 10^{-4},\\,3.5 \\times 10^{-4}\\right)$，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n-   **纵向弥散度**：$\\alpha_{L} = 10.0$，单位为 $\\mathrm{m}$。\n-   **横向弥散度**：$\\alpha_{T} = 0.8$，单位为 $\\mathrm{m}$。\n-   **单位方向矢量**：$\\mathbf{e} = \\frac{1}{\\sqrt{2}}(1,\\,0,\\,1)$。\n-   **待计算量**：方向有效弥散系数，定义为 $D_{\\mathrm{eff}} = \\mathbf{e}^{\\top} \\mathbf{D}\\, \\mathbf{e}$，其中 $\\mathbf{D}$ 是水动力弥散张量。\n\n### 步骤2：使用提取的已知条件进行验证\n根据指定标准对问题进行评估：\n-   **科学依据**：该问题基于多孔介质中力学弥散的标准且成熟的 Bear-Scheidegger 模型，这是水文地质学和污染物输运建模的基石。弥散度、平流和弥散的张量性质等概念是基本原理。ADR 方程是该领域的标准模型。给定的流速和弥散度数值在物理上是合理的。\n-   **良态性**：这是一个良态问题。它要求从物理原理推导标准张量形式，并随后使用所提供的数据进行计算。所要求的量，即方向有效弥散，由给定参数唯一确定。\n-   **客观性**：语言精确、专业，没有主观性或歧义。\n-   **完整性和一致性**：该问题提供了构建弥散张量和计算所需系数的所有必要信息（流速矢量、弥散度、方向矢量）。没有矛盾之处。关于一级衰减的信息，虽然是总体背景（ADR模型）的一部分，但对于分析弥散张量这一特定任务而言并非必需，这在隔离更广泛模型的组成部分时是常见做法。\n\n### 步骤3：结论与行动\n该问题是有效且适定的。我们将继续推导弥散张量并执行计算。\n\n### 步骤4：弥散张量的推导\n\n水动力弥散张量 $\\mathbf{D}$ 通常由两部分组成：分子扩散和机械弥散。本问题侧重于由流速引起的机械弥散。在各向同性的多孔介质中，弥散张量 $\\mathbf{D}$ 本身是一个二阶张量，其性质仅由流速矢量 $\\mathbf{v}$ 决定。\n\n根据张量表示理论，任何依赖于单个矢量 $\\mathbf{v}$ 的二阶张量 $\\mathbf{D}$ 必须具有以下一般形式：\n$$\nD_{ij} = c_1 \\delta_{ij} + c_2 v_i v_j\n$$\n其中 $c_1$ 和 $c_2$ 是标量系数，它们可以依赖于流速的大小 $|\\mathbf{v}|$，$\\delta_{ij}$ 是克罗内克符号。\n\n为了确定系数 $c_1$ 和 $c_2$，我们考虑一个局部坐标系，其主轴（例如，轴1）与流速矢量 $\\mathbf{v}$ 对齐。在此坐标系中，$\\mathbf{v} = (|\\mathbf{v}|, 0, 0)$。\n- 沿流动方向（纵向）的弥散系数定义为 $D_L = \\alpha_L |\\mathbf{v}|$。代入张量形式，我们得到：\n$$\nD_{11} = c_1 \\delta_{11} + c_2 v_1 v_1 = c_1 + c_2 |\\mathbf{v}|^2 = \\alpha_L |\\mathbf{v}|\n$$\n- 垂直于流动方向（横向）的弥散系数定义为 $D_T = \\alpha_T |\\mathbf{v}|$。例如，对于轴2，我们有：\n$$\nD_{22} = c_1 \\delta_{22} + c_2 v_2 v_2 = c_1 + c_2 (0)^2 = c_1 = \\alpha_T |\\mathbf{v}|\n$$\n通过求解这个由两个方程组成的系统，我们得到：\n$$\nc_1 = \\alpha_T |\\mathbf{v}|\n$$\n$$\nc_2 = \\frac{\\alpha_L |\\mathbf{v}| - c_1}{|\\mathbf{v}|^2} = \\frac{\\alpha_L |\\mathbf{v}| - \\alpha_T |\\mathbf{v}|}{|\\mathbf{v}|^2} = \\frac{\\alpha_L - \\alpha_T}{|\\mathbf{v}|}\n$$\n将这些系数代回一般形式，我们得到不考虑分子扩散的机械弥散张量（Bear-Scheidegger 张量）的最终形式：\n$$\nD_{ij} = \\alpha_T |\\mathbf{v}| \\delta_{ij} + (\\alpha_L - \\alpha_T) \\frac{v_i v_j}{|\\mathbf{v}|}\n$$\n\n### 步骤5：数值计算\n\n我们现在使用给定的值来计算方向有效弥散系数 $D_{\\mathrm{eff}} = \\mathbf{e}^{\\top} \\mathbf{D}\\, \\mathbf{e}$。\n首先，计算流速矢量 $\\mathbf{v}$ 的大小：\n$$\n|\\mathbf{v}| = \\sqrt{(2.0 \\times 10^{-4})^2 + (-1.5 \\times 10^{-4})^2 + (3.5 \\times 10^{-4})^2}\n$$\n$$\n|\\mathbf{v}| = \\sqrt{(4.0 + 2.25 + 12.25) \\times 10^{-8}} = \\sqrt{18.5 \\times 10^{-8}} = \\sqrt{18.5} \\times 10^{-4} \\approx 4.3011626 \\times 10^{-4} \\,\\mathrm{m/s}\n$$\n接下来，计算方向矢量 $\\mathbf{e}$ 与流速矢量 $\\mathbf{v}$ 的点积：\n$$\n\\mathbf{v} \\cdot \\mathbf{e} = (2.0 \\times 10^{-4}) \\left(\\frac{1}{\\sqrt{2}}\\right) + (-1.5 \\times 10^{-4})(0) + (3.5 \\times 10^{-4})\\left(\\frac{1}{\\sqrt{2}}\\right)\n$$\n$$\n\\mathbf{v} \\cdot \\mathbf{e} = \\frac{2.0 \\times 10^{-4} + 3.5 \\times 10^{-4}}{\\sqrt{2}} = \\frac{5.5 \\times 10^{-4}}{\\sqrt{2}} \\approx 3.8890873 \\times 10^{-4} \\,\\mathrm{m/s}\n$$\n方向有效弥散系数可以被更简洁地计算为：\n$$\nD_{\\mathrm{eff}} = \\mathbf{e}^{\\top} \\mathbf{D}\\, \\mathbf{e} = \\alpha_T |\\mathbf{v}| + (\\alpha_L - \\alpha_T) \\frac{(\\mathbf{v} \\cdot \\mathbf{e})^2}{|\\mathbf{v}|}\n$$\n现在代入数值：\n- $\\alpha_L = 10.0 \\,\\mathrm{m}$\n- $\\alpha_T = 0.8 \\,\\mathrm{m}$\n\n计算第一项：\n$$\n\\alpha_T |\\mathbf{v}| = 0.8 \\times (4.3011626 \\times 10^{-4} \\,\\mathrm{m/s}) \\approx 3.44093 \\times 10^{-4} \\,\\mathrm{m^2/s}\n$$\n计算第二项：\n$$\n(\\alpha_L - \\alpha_T) \\frac{(\\mathbf{v} \\cdot \\mathbf{e})^2}{|\\mathbf{v}|} = (10.0 - 0.8) \\frac{(3.8890873 \\times 10^{-4})^2}{4.3011626 \\times 10^{-4}}\n$$\n$$\n= 9.2 \\times \\frac{1.5125 \\times 10^{-7}}{4.3011626 \\times 10^{-4}} \\approx 3.2351 \\times 10^{-3} \\,\\mathrm{m^2/s}\n$$\n将两项相加得到 $D_{\\mathrm{eff}}$：\n$$\nD_{\\mathrm{eff}} \\approx 3.44093 \\times 10^{-4} + 3.2351 \\times 10^{-3} = 0.000344093 + 0.0032351 = 0.003579193 \\,\\mathrm{m^2/s}\n$$\n最后，将结果四舍五入到四位有效数字：\n$$\nD_{\\mathrm{eff}} \\approx 3.579 \\times 10^{-3} \\,\\mathrm{m^2/s}\n$$",
            "answer": "$$\\boxed{3.579 \\times 10^{-3}}$$"
        },
        {
            "introduction": "掌握了核心物理过程后，本练习将带你进入计算建模的实践领域。你将为稳态运移方程实现一个数值求解器，并通过与已知的解析解进行比较来验证其准确性，这是至关重要的一步。这个练习将向你介绍数值误差和模型验证等关键概念，这些是任何计算建模者都必须掌握的基本技能。",
            "id": "4086213",
            "problem": "考虑在具有均匀流的饱和、均质多孔介质中的一维污染物运移。从局部质量平衡和菲克（Fickian）色散本构关系出发，推导具有一阶衰减的守恒示踪剂的对流-弥散-反应方程。您需要比较稳态解析解与稳态数值解，并计算在不同佩克莱特数（Peclet number (Pe)）区间下的无量纲 $L^2$ 误差范数。您的程序必须仅使用以下信息实现下列要求。\n\n基本原理和模型设定：\n- 从包含对流和菲克（Fickian）水动力弥散，以及一阶衰减的局部质量守恒声明开始：一维瞬态对流-弥散-反应方程为\n$$\n\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} \\;=\\; D \\frac{\\partial^2 C}{\\partial x^2} \\;-\\; \\lambda\\, C,\n$$\n其中 $C$ 是水相浓度，$v$ 是孔隙水流速，$D$ 是纵向弥散系数，$\\lambda$ 是一阶衰减常数。\n- 考虑稳态，因此 $\\partial C/\\partial t = 0$，得到常微分方程\n$$\nD \\frac{d^2 C}{dx^2} \\;-\\; v \\frac{d C}{dx} \\;-\\; \\lambda\\, C \\;=\\; 0.\n$$\n- 边界条件模拟入口处的连续源和半无限出口：在入口处施加狄利克雷（Dirichlet）条件 $C(0)=C_0$，并在 $x=L$ 处施加一个与 $x \\to \\infty$ 时解有界相符的辐射（罗宾型，Robin-type）出口条件。有界解析解的形式为 $C(x)=C_0 \\exp(r_- x)$，其中\n$$\nr_- \\;=\\; \\frac{v - \\sqrt{v^2 + 4 \\lambda D}}{2D} \\;\\le\\; 0.\n$$\n相应的精确辐射边界条件是\n$$\n\\left.\\frac{dC}{dx}\\right|_{x=L} \\;=\\; r_-\\, C(L).\n$$\n\n解析参考解：\n- 稳态解析浓度分布为\n$$\nC_{\\text{exact}}(x) \\;=\\; C_0 \\, \\exp\\!\\big(r_- x\\big),\n$$\n其中 $r_-$ 的定义如上。\n\n待实现的数值格式：\n- 在均匀网格 $x_i = i\\,\\Delta x$（$i=0,1,\\dots,N$，$ \\Delta x = L/N$）上对稳态常微分方程进行离散化。\n- 对弥散项使用二阶中心差分，对适用于正 $v$ 值的对流项使用一阶迎风差分：\n$$\nD \\frac{C_{i+1} - 2 C_i + C_{i-1}}{\\Delta x^2} \\;-\\; v \\frac{C_i - C_{i-1}}{\\Delta x} \\;-\\; \\lambda C_i \\;=\\; 0,\\quad i=1,\\dots,N-1.\n$$\n- 在 $i=0$ 处施加 $C_0 = C(0)$，并在 $i=N$ 处使用一阶单边导数施加辐射边界条件，\n$$\n\\frac{C_N - C_{N-1}}{\\Delta x} \\;=\\; r_-\\, C_N.\n$$\n\n误差度量定义：\n- 将无量纲相对 $L^2$ 误差范数定义为\n$$\n\\varepsilon \\;=\\; \\frac{\\left( \\sum_{i=0}^{N} \\left(C_i - C_{\\text{exact}}(x_i)\\right)^2 \\,\\Delta x \\right)^{1/2}}{\\left( \\sum_{i=0}^{N} \\left(C_{\\text{exact}}(x_i)\\right)^2 \\,\\Delta x \\right)^{1/2}}.\n$$\n\n佩克莱特数变化：\n- 将域尺度佩克莱特数定义为 $\\mathrm{Pe}_L = v L / D$。对于每个测试用例，通过 $D = v L / \\mathrm{Pe}_L$ 计算 $D$，以获得指定的佩克莱特数区间。\n\n物理单位和常数：\n- 使用 $L$ 的单位为米，$v$ 的单位为米/天，$D$ 的单位为平方米/天，$\\lambda$ 的单位为 1/天。将入口浓度 $C_0$ 设置为 1（在一致的任意单位下）；所有输出均为无量纲。\n\n测试套件：\n- 您的程序必须评估以下四个用例，每个用例由 $(L, v, \\mathrm{Pe}_L, \\lambda, N)$ 指定：\n    - 用例 1：$L=100$, $v=1$, $\\mathrm{Pe}_L=0.1$, $\\lambda=0$, $N=200$。\n    - 用例 2：$L=100$, $v=1$, $\\mathrm{Pe}_L=1$, $\\lambda=0$, $N=200$。\n    - 用例 3：$L=100$, $v=1$, $\\mathrm{Pe}_L=10$, $\\lambda=0.01$, $N=200$。\n    - 用例 4：$L=100$, $v=1$, $\\mathrm{Pe}_L=100$, $\\lambda=0.01$, $N=200$。\n\n您的程序必须执行以下操作：\n- 对于每个测试用例，根据指定的 $\\mathrm{Pe}_L$ 计算 $D$，组装并求解由上述离散化定义的线性系统，评估解析解，并计算定义的无量纲相对 $L^2$ 误差 $\\varepsilon$。\n- 为每个测试用例报告一个与 $\\varepsilon$ 对应的浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述四个测试用例的顺序排列，例如 $[e_1,e_2,e_3,e_4]$，其中每个 $e_k$ 是用例 $k$ 的无量纲相对 $L^2$ 误差。",
            "solution": "该问题要求对一维稳态对流-弥散-反应方程（ADRE）的解析解和数值解进行比较。我们将计算四个不同佩克莱特数区间的测试用例的无量纲相对 $L^2$ 误差范数。该过程包括从指定的有限差分格式推导线性代数方程组，求解该系统以获得数值浓度分布，计算相应的解析分布，最后计算误差范数。\n\n### 1. 问题公式化\n\n在稳态（$\\partial C/\\partial t = 0$）下，一维污染物运移的控制方程是一个二阶常微分方程（ODE）：\n$$\nD \\frac{d^2 C}{dx^2} - v \\frac{d C}{dx} - \\lambda C = 0\n$$\n其中，$C(x)$ 是浓度，$v$ 是孔隙水流速，$D$ 是弥散系数，$\\lambda$ 是一阶衰减速率常数。域定义为 $x \\in [0, L]$。\n\n边界条件为：\n1.  入口处的狄利克雷（Dirichlet）条件：$C(0) = C_0$。\n2.  出口处的辐射（罗宾型，Robin-type）条件：$\\left.\\frac{dC}{dx}\\right|_{x=L} = r_- C(L)$。\n\n满足这些条件的半无限域的解析解为：\n$$\nC_{\\text{exact}}(x) = C_0 \\exp(r_- x)\n$$\n其中，速率常数 $r_-$ 是特征方程 $D r^2 - v r - \\lambda = 0$ 的负根：\n$$\nr_- = \\frac{v - \\sqrt{v^2 + 4 \\lambda D}}{2D}\n$$\n由于 $v, \\lambda, D$ 均为非负值，平方根下的项大于或等于 $v^2$，从而确保 $r_- \\le 0$。\n\n### 2. 数值离散化和线性系统\n\n域 $[0, L]$ 被离散化为一个包含 $N$ 个分段的均匀网格，产生 $N+1$ 个节点 $x_i = i \\Delta x$（$i=0, 1, \\dots, N$），其中 $\\Delta x = L/N$。这些节点上的浓度表示为 $C_i \\approx C(x_i)$。\n\n问题为内部节点（$i=1, \\dots, N-1$）指定了有限差分格式：对弥散项使用二阶中心差分，对对流项（当 $v > 0$ 时）使用一阶迎风差分。\n$$\nD \\frac{C_{i+1} - 2 C_i + C_{i-1}}{\\Delta x^2} - v \\frac{C_i - C_{i-1}}{\\Delta x} - \\lambda C_i = 0\n$$\n对对流项选择迎风格式可确保数值格式的稳定性，特别是对于对流主导的问题（即高网格佩克莱特数，$\\mathrm{Pe}_c = v \\Delta x / D$），但它会引入一阶截断误差，这是数值扩散的来源。\n\n重新整理方程，按节点索引（$C_{i-1}, C_i, C_{i+1}$）对各项进行分组：\n$$\n\\left(\\frac{D}{\\Delta x^2} + \\frac{v}{\\Delta x}\\right) C_{i-1} + \\left(-\\frac{2D}{\\Delta x^2} - \\frac{v}{\\Delta x} - \\lambda\\right) C_i + \\left(\\frac{D}{\\Delta x^2}\\right) C_{i+1} = 0\n$$\n该方程对于未知浓度 $C_i$ 是线性的。我们可以将这组方程（$i=1, \\dots, N-1$）写成矩阵形式。设未知向量为 $\\mathbf{C}_{\\text{unk}} = [C_1, C_2, \\dots, C_N]^T$。\n\n边界条件按以下方式纳入：\n-   **入口（$i=0$）：** $C_0$ 是一个已知值。对于 $i=1$ 处的方程，涉及 $C_0$ 的项被移到右侧。\n-   **出口（$i=N$）：** 辐射边界条件使用一阶单边差分进行离散化：\n    $$\n    \\frac{C_N - C_{N-1}}{\\Delta x} = r_- C_N\n    $$\n    重新整理得到一个涉及 $C_{N-1}$ 和 $C_N$ 的线性方程：\n    $$\n    -C_{N-1} + (1 - r_- \\Delta x) C_N = 0\n    $$\n\n我们组装一个 $N \\times N$ 的线性系统 $M \\mathbf{C}_{\\text{unk}} = \\mathbf{d}$。\n设内部节点的系数为：\n-   次对角线： $A_{\\text{sub}} = \\frac{D}{\\Delta x^2} + \\frac{v}{\\Delta x}$\n-   主对角线： $A_{\\text{main}} = -\\frac{2D}{\\Delta x^2} - \\frac{v}{\\Delta x} - \\lambda$\n-   超对角线： $A_{\\text{sup}} = \\frac{D}{\\Delta x^2}$\n\n系统构建如下（对未知量 $C_1, \\dots, C_N$ 和方程使用基于1的索引）：\n-   **方程 1（针对 $C_1$）：** 从 $i=1$ 处的模板，我们有 $A_{\\text{sub}}C_0 + A_{\\text{main}}C_1 + A_{\\text{sup}}C_2 = 0$。由于 $C_0$ 是已知的，这变为 $A_{\\text{main}}C_1 + A_{\\text{sup}}C_2 = -A_{\\text{sub}}C_0$。\n-   **方程 $i=2, \\dots, N-1$（针对 $C_2, \\dots, C_{N-1}$）：** 这些是 $A_{\\text{sub}}C_{i-1} + A_{\\text{main}}C_i + A_{\\text{sup}}C_{i+1} = 0$。这在矩阵 $M$ 的相应行中形成了三对角结构。\n-   **方程 $N$（针对 $C_N$）：** 从出口边界条件，我们有 $-C_{N-1} + (1 - r_- \\Delta x)C_N = 0$。\n\n最终得到的矩阵 $M$ 是近三对角的，该系统可以使用标准的线性求解器高效求解。\n\n### 3. 误差计算\n\n一旦获得数值解向量 $\\mathbf{C}_{\\text{num}} = [C_0, C_1, \\dots, C_N]^T$，我们将其与在网格点上求值的解析解 $\\mathbf{C}_{\\text{exact}} = [C_{\\text{exact}}(x_0), \\dots, C_{\\text{exact}}(x_N)]^T$进行比较。\n\n无量纲相对 $L^2$ 误差范数 $\\varepsilon$ 定义为：\n$$\n\\varepsilon = \\frac{\\left( \\sum_{i=0}^{N} (C_i - C_{\\text{exact}}(x_i))^2 \\Delta x \\right)^{1/2}}{\\left( \\sum_{i=0}^{N} (C_{\\text{exact}}(x_i))^2 \\Delta x \\right)^{1/2}}\n$$\n项 $\\Delta x$ 同时出现在分子和分母中，因此可以消去，将计算简化为误差向量和精确解向量的欧几里得范数之比：\n$$\n\\varepsilon = \\frac{\\|\\mathbf{C}_{\\text{num}} - \\mathbf{C}_{\\text{exact}}\\|_2}{\\|\\mathbf{C}_{\\text{exact}}\\|_2}\n$$\n\n### 4. 实现策略\n\n对于由 $(L, v, \\mathrm{Pe}_L, \\lambda, N)$ 指定的每个测试用例：\n1.  计算派生的物理和数值参数：$D = v L / \\mathrm{Pe}_L$ 和 $\\Delta x = L/N$。\n2.  计算解析常数 $r_-$。\n3.  在所有 $N+1$ 个网格点上评估解析解 $C_{\\text{exact}}(x_i)$。\n4.  为线性系统构建 $N \\times N$ 矩阵 $M$ 和 $N \\times 1$ 的右侧向量 $\\mathbf{d}$。\n5.  求解 $M \\mathbf{C}_{\\text{unk}} = \\mathbf{d}$ 以找到数值浓度 $C_1, \\dots, C_N$。\n6.  组装完整的数值解向量 $\\mathbf{C}_{\\text{num}} = [C_0, C_1, \\dots, C_N]^T$。\n7.  使用上述公式计算误差范数 $\\varepsilon$。将收集并打印所有四个用例的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the contaminant transport problem for all test cases.\n    \"\"\"\n    \n    # Test suite: (L, v, Pe_L, lambda, N)\n    test_cases = [\n        (100.0, 1.0, 0.1, 0.0, 200),\n        (100.0, 1.0, 1.0, 0.0, 200),\n        (100.0, 1.0, 10.0, 0.01, 200),\n        (100.0, 1.0, 100.0, 0.01, 200),\n    ]\n\n    results = []\n    for case in test_cases:\n        error = calculate_error_for_case(*case)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\ndef calculate_error_for_case(L, v, Pe_L, lam, N):\n    \"\"\"\n    Calculates the dimensionless relative L2 error for a single test case.\n\n    Args:\n        L (float): Domain length [m].\n        v (float): Pore-water velocity [m/day].\n        Pe_L (float): Domain-scale Peclet number.\n        lam (float): First-order decay constant [1/day].\n        N (int): Number of grid segments.\n\n    Returns:\n        float: The dimensionless relative L2 error.\n    \"\"\"\n    # --- 1. Calculate derived parameters ---\n    C0 = 1.0\n    dx = L / N\n    D = v * L / Pe_L\n    \n    # Check for non-physical conditions, though not expected from problem statement\n    if D == 0:\n        raise ValueError(\"Dispersion coefficient D must be positive.\")\n\n    # Calculate the exponent r_minus for the analytical solution\n    # The term under the square root is always non-negative for this problem\n    r_minus_sqrt_term = np.sqrt(v**2 + 4 * lam * D)\n    r_minus = (v - r_minus_sqrt_term) / (2 * D)\n\n    # --- 2. Evaluate Analytical Solution ---\n    x = np.linspace(0, L, N + 1)  # Grid with N+1 points\n    C_exact = C0 * np.exp(r_minus * x)\n\n    # --- 3. Set up and Solve the Numerical System ---\n    # The system is M * C_unk = d, for unknowns C_1, ..., C_N\n    M = np.zeros((N, N))\n    d = np.zeros(N)\n\n    # Coefficients for the interior node finite difference equation\n    A_sup = D / dx**2\n    A_sub = D / dx**2 + v / dx\n    A_main = -2 * D / dx**2 - v / dx - lam\n\n    # Assemble the matrix M and vector d\n    # The unknown vector is C_unk = [C_1, C_2, ..., C_N]\n    # Matrix indices are 0 to N-1 for unknowns 1 to N\n    \n    # Equation for node i=1 (matrix row 0)\n    # A_sub*C_0 + A_main*C_1 + A_sup*C_2 = 0\n    M[0, 0] = A_main\n    M[0, 1] = A_sup\n    d[0] = -A_sub * C0\n\n    # Equations for interior nodes i=2 to N-1 (matrix rows 1 to N-2)\n    for i in range(1, N - 1):\n        # row i is for node i+1\n        M[i, i - 1] = A_sub\n        M[i, i] = A_main\n        M[i, i + 1] = A_sup\n\n    # Equation for node i=N (outlet BC, matrix row N-1)\n    # (C_N - C_{N-1}) / dx = r_minus * C_N  => -C_{N-1} + (1 - r_minus*dx)*C_N = 0\n    M[N - 1, N - 2] = -1.0\n    M[N - 1, N - 1] = 1.0 - r_minus * dx\n\n    # Solve the linear system\n    C_unk = np.linalg.solve(M, d)\n\n    # Construct the full numerical solution vector [C_0, C_1, ..., C_N]\n    C_num = np.concatenate(([C0], C_unk))\n\n    # --- 4. Compute the Error Norm ---\n    # The dx term in the sum cancels out, so we can compute the norm directly.\n    numerator = np.linalg.norm(C_num - C_exact)\n    denominator = np.linalg.norm(C_exact)\n\n    if denominator == 0:\n        # This case would only occur if C_exact is uniformly zero, which doesn't happen here.\n        return 0.0 if numerator == 0 else np.inf\n\n    error = numerator / denominator\n    return error\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}