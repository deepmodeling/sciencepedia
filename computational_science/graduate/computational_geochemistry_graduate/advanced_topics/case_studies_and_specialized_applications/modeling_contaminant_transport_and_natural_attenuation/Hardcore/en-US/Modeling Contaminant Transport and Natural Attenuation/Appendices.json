{
    "hands_on_practices": [
        {
            "introduction": "Before building complex numerical models, it's essential to understand how fundamental geochemical processes alter contaminant migration. This exercise focuses on linear sorption, a key mechanism of natural attenuation, by deriving the concept of the retardation factor from first principles of mass conservation . By calculating the delayed arrival of a sorbing solute compared to a conservative tracer, you will gain a quantitative and intuitive grasp of how chemical interactions with aquifer materials can significantly slow the spread of contamination.",
            "id": "4086141",
            "problem": "A one-dimensional saturated aquifer of uniform properties receives an instantaneous step input of a dissolved solute at location $x=0$ and time $t=0$. The aquifer is homogeneous and isotropic with hydraulic conductivity $K$, hydraulic gradient $i$, porosity $n$, bulk density $\\rho_b$, and the solute undergoes linear, instantaneous equilibrium sorption characterized by distribution coefficient $K_d$. Dispersion and first-order decay are negligible over the travel distance considered. A conservative tracer, which has no sorption, is used as a reference. The monitoring point is located at distance $L$ downgradient from the source.\n\nStarting only from Darcy’s law and conservation of mass for the aqueous and sorbed phases embodied in the Advection–Dispersion–Reaction Equation (ADRE), derive the kinematic propagation speed of the solute front under the stated assumptions and use it to compute the breakthrough time at $x=L$ for the retarded solute, expressed relative to the conservative tracer. Then evaluate the breakthrough time numerically using the following data:\n- Hydraulic conductivity $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$,\n- Hydraulic gradient $i = 1.0 \\times 10^{-2}$,\n- Porosity $n = 0.30$,\n- Bulk density $\\rho_b = 1600 \\,\\text{kg/m}^{3}$,\n- Distribution coefficient $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$,\n- Downstream distance $L = 100 \\,\\text{m}$.\n\nExpress the final breakthrough time in days and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the breakthrough time for a retarded solute and its numerical evaluation. The derivation must start from fundamental principles: Darcy's law and the conservation of mass.\n\n### Step 1: Problem Validation\n\nFirst, the problem statement is validated against the specified criteria.\n\n**Extracted Givens:**\n- System: One-dimensional saturated aquifer, homogeneous, isotropic.\n- Input: Instantaneous step input of a dissolved solute at $x=0$, $t=0$.\n- Hydraulic properties: Hydraulic conductivity $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$, hydraulic gradient $i = 1.0 \\times 10^{-2}$, porosity $n = 0.30$.\n- Aquifer solid properties: Bulk density $\\rho_b = 1600 \\,\\text{kg/m}^{3}$.\n- Solute properties: Undergoes linear, instantaneous equilibrium sorption characterized by distribution coefficient $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$.\n- Assumptions: Dispersion and first-order decay are negligible.\n- Reference: A conservative tracer (no sorption, $K_d=0$) is used.\n- Monitoring point: Distance $L = 100 \\,\\text{m}$ downgradient.\n- Task:\n  1. Derive the kinematic propagation speed of the solute front.\n  2. Use it to compute the breakthrough time at $x=L$ for the retarded solute, expressed relative to the conservative tracer.\n  3. Evaluate the breakthrough time numerically in days, rounded to four significant figures.\n\n**Validation Using Extracted Givens:**\n- **Scientifically Grounded:** The problem is based on the Advection-Dispersion-Reaction Equation (ADRE), Darcy's law, and the concept of linear sorption, which are fundamental and universally accepted principles in contaminant hydrogeology and computational geochemistry. The assumptions (1D transport, negligible dispersion/decay, equilibrium sorption) are standard simplifications to achieve an analytical solution.\n- **Well-Posed:** The problem provides all necessary parameters and a clear set of initial/boundary conditions (a step input). It asks for a specific, calculable quantity (breakthrough time). A unique and meaningful solution exists.\n- **Objective:** The problem is stated using precise, quantitative, and unbiased language. All terms are standard within the discipline.\n\n**Verdict:** The problem is valid. It is a standard, well-posed problem that can be solved using established scientific principles.\n\n### Step 2: Derivation and Solution\n\nThe solution proceeds by first deriving the governing partial differential equation for solute transport under the given conditions, then solving for the solute velocity and breakthrough time.\n\n**Derivation of the Governing Equation**\nThe principle of conservation of mass for a solute in a one-dimensional porous medium states that the time rate of change of total solute mass in a control volume is balanced by the net flux of solute across its boundaries and any internal sources or sinks. For a unit volume of the aquifer, this is expressed as:\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b S) = -\\frac{\\partial J}{\\partial x} - \\text{Reactions}\n$$\nwhere:\n- $C$ is the aqueous concentration of the solute [mass/volume of fluid].\n- $S$ is the sorbed concentration of the solute [mass of solute/mass of solid].\n- $n$ is the porosity [dimensionless].\n- $\\rho_b$ is the bulk density of the porous medium [mass of solid/volume of aquifer].\n- $J$ is the total solute flux [mass/area/time].\n- The term $nC + \\rho_b S$ represents the total mass of solute per unit bulk volume of the aquifer.\n\nThe problem states that first-order decay is negligible, so the reaction term is zero. The total flux $J$ is the sum of advective and dispersive fluxes. Advective flux is $J_{adv} = qC$, where $q$ is the Darcy flux. Dispersive flux is negligible by assumption. Therefore, the total flux is $J = qC$.\n\nThe conservation equation simplifies to:\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b S) = -\\frac{\\partial (qC)}{\\partial x}\n$$\nThe problem specifies linear, instantaneous equilibrium sorption, which is described by the relation $S = K_d C$, where $K_d$ is the distribution coefficient. Substituting this into the conservation equation:\n$$\n\\frac{\\partial}{\\partial t} (nC + \\rho_b K_d C) = -\\frac{\\partial (qC)}{\\partial x}\n$$\nSince $n$, $\\rho_b$, and $K_d$ are constants for a homogeneous aquifer, we can factor them out of the time derivative. The aquifer is also uniform, meaning the hydraulic properties are constant, so the Darcy flux $q$ is also constant with respect to position $x$.\n$$\n(n + \\rho_b K_d) \\frac{\\partial C}{\\partial t} = -q \\frac{\\partial C}{\\partial x}\n$$\nTo express this equation in the standard form of the ADRE, we divide by the porosity $n$:\n$$\n\\left(1 + \\frac{\\rho_b K_d}{n}\\right) \\frac{\\partial C}{\\partial t} = -\\frac{q}{n} \\frac{\\partial C}{\\partial x}\n$$\nWe define two key parameters. First, the **retardation factor**, $R$:\n$$\nR = 1 + \\frac{\\rho_b K_d}{n}\n$$\nSecond, the **average linear groundwater velocity**, $v$, which is the Darcy flux $q$ divided by the porosity $n$. According to Darcy's law, $q = Ki$, where $K$ is the hydraulic conductivity and $i$ is the hydraulic gradient.\n$$\nv = \\frac{q}{n} = \\frac{Ki}{n}\n$$\nSubstituting these definitions back into the equation yields:\n$$\nR \\frac{\\partial C}{\\partial t} = -v \\frac{\\partial C}{\\partial x}\n$$\nRearranging gives the final form of the one-dimensional advection equation for a retarded solute:\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{v}{R} \\frac{\\partial C}{\\partial x} = 0\n$$\nThis is a first-order linear hyperbolic partial differential equation. It describes the propagation of the concentration profile $C(x,t)$ with a characteristic speed.\n\n**Kinematic Propagation Speed and Breakthrough Time**\nFrom the advection equation derived above, the **kinematic propagation speed of the solute front**, denoted as $v_c$, is the coefficient of the spatial derivative term:\n$$\nv_c = \\frac{v}{R}\n$$\nThis is the velocity at which the solute front travels. The breakthrough time, $t_c$, at a distance $L$ from the source is the distance divided by this velocity:\n$$\nt_c = \\frac{L}{v_c} = \\frac{L}{v/R} = \\frac{LR}{v}\n$$\nFor the conservative tracer, sorption is zero ($K_d=0$), so its retardation factor $R_{tracer} = 1 + \\frac{\\rho_b \\cdot 0}{n} = 1$. The tracer's velocity is $v_{tracer} = v/R_{tracer} = v$, and its breakthrough time is $t_{tracer} = L/v$.\n\nTherefore, the breakthrough time for the retarded solute relative to the conservative tracer is:\n$$\nt_c = R \\cdot t_{tracer}\n$$\nThe retarded solute travels $R$ times slower and its breakthrough occurs $R$ times later than that of the conservative groundwater flow (and the conservative tracer).\n\nTo compute the numerical value, we can use the full expression for $t_c$ by substituting the formulas for $R$ and $v$:\n$$\nt_c = \\frac{L \\left(1 + \\frac{\\rho_b K_d}{n}\\right)}{Ki/n} = \\frac{Ln \\left(1 + \\frac{\\rho_b K_d}{n}\\right)}{Ki} = \\frac{L(n + \\rho_b K_d)}{Ki}\n$$\n\n**Numerical Calculation**\nWe are given the following values:\n- $L = 100 \\,\\text{m}$\n- $K = 1.0 \\times 10^{-4} \\,\\text{m/s}$\n- $i = 1.0 \\times 10^{-2}$\n- $n = 0.30$\n- $\\rho_b = 1600 \\,\\text{kg/m}^{3}$\n- $K_d = 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg}$\n\nFirst, we calculate the numerator term $L(n + \\rho_b K_d)$:\n$$\n\\text{Numerator} = 100 \\,\\text{m} \\times \\left(0.30 + (1600 \\,\\text{kg/m}^{3} \\times 2.0 \\times 10^{-4} \\,\\text{m}^{3}/\\text{kg})\\right)\n$$\n$$\n\\text{Numerator} = 100 \\,\\text{m} \\times (0.30 + 0.32) = 100 \\,\\text{m} \\times 0.62 = 62 \\,\\text{m}\n$$\nNext, we calculate the denominator term $Ki$:\n$$\n\\text{Denominator} = (1.0 \\times 10^{-4} \\,\\text{m/s}) \\times (1.0 \\times 10^{-2}) = 1.0 \\times 10^{-6} \\,\\text{m/s}\n$$\nNow, we compute the breakthrough time $t_c$ in seconds:\n$$\nt_c = \\frac{62 \\,\\text{m}}{1.0 \\times 10^{-6} \\,\\text{m/s}} = 62 \\times 10^{6} \\,\\text{s} = 6.2 \\times 10^{7} \\,\\text{s}\n$$\nFinally, we convert the time from seconds to days. The number of seconds in one day is $24 \\times 60 \\times 60 = 86400 \\,\\text{s}$.\n$$\nt_c (\\text{days}) = \\frac{6.2 \\times 10^{7} \\,\\text{s}}{86400 \\,\\text{s/day}} \\approx 717.59259... \\,\\text{days}\n$$\nRounding the result to four significant figures as requested:\n$$\nt_c \\approx 717.6 \\,\\text{days}\n$$",
            "answer": "$$\n\\boxed{717.6}\n$$"
        },
        {
            "introduction": "While analytical solutions provide deep insight, most real-world problems require numerical models. A critical step in computational modeling is verification: ensuring your code correctly solves the intended equations. This practice guides you through implementing a finite difference solver for the steady-state advection-dispersion-reaction equation and comparing it against an exact analytical solution . By evaluating the model's error across different transport regimes defined by the Peclet number, you will develop essential skills in numerical methods and error analysis.",
            "id": "4086213",
            "problem": "Consider one-dimensional contaminant transport in a saturated, homogeneous porous medium with uniform flow. Start from the local mass balance and Fickian dispersion constitutive relation to obtain the advection–dispersion–reaction equation for a conservative tracer with first-order decay. You are to compare an analytical steady-state solution against a numerical steady-state solution and compute dimensionless $L^2$ error norms under varying Peclet number (Pe) regimes. Your program must implement the following, using only the information below.\n\nFundamental base and model specification:\n- Begin with the local mass conservation statement with advection and Fickian hydrodynamic dispersion, plus first-order decay: the transient advection–dispersion–reaction equation in one dimension is\n$$\n\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} \\;=\\; D \\frac{\\partial^2 C}{\\partial x^2} \\;-\\; \\lambda\\, C,\n$$\nwhere $C$ is aqueous concentration, $v$ is pore-water velocity, $D$ is the longitudinal dispersion coefficient, and $\\lambda$ is the first-order decay constant.\n- Consider steady state, so that $\\partial C/\\partial t = 0$, yielding the ordinary differential equation\n$$\nD \\frac{d^2 C}{dx^2} \\;-\\; v \\frac{d C}{dx} \\;-\\; \\lambda\\, C \\;=\\; 0.\n$$\n- Boundary conditions emulate a continuous source at the inlet and a semi-infinite outlet: impose a Dirichlet inlet $C(0)=C_0$, and a radiation (Robin-type) outlet at $x=L$ consistent with a bounded solution as $x \\to \\infty$. The bounded analytical solution has the form $C(x)=C_0 \\exp(r_- x)$, where\n$$\nr_- \\;=\\; \\frac{v - \\sqrt{v^2 + 4 \\lambda D}}{2D} \\;\\le\\; 0.\n$$\nThe corresponding exact radiation boundary condition is\n$$\n\\left.\\frac{dC}{dx}\\right|_{x=L} \\;=\\; r_-\\, C(L).\n$$\n\nAnalytical reference solution:\n- The steady analytical concentration profile is\n$$\nC_{\\text{exact}}(x) \\;=\\; C_0 \\, \\exp\\!\\big(r_- x\\big),\n$$\nwith $r_-$ defined above.\n\nNumerical scheme to be implemented:\n- Discretize the steady ordinary differential equation on a uniform grid $x_i = i\\,\\Delta x$ for $i=0,1,\\dots,N$ with $\\Delta x = L/N$.\n- Use a second-order central difference for the dispersive term and a first-order upwind difference for the advective term, appropriate for positive $v$:\n$$\nD \\frac{C_{i+1} - 2 C_i + C_{i-1}}{\\Delta x^2} \\;-\\; v \\frac{C_i - C_{i-1}}{\\Delta x} \\;-\\; \\lambda C_i \\;=\\; 0,\\quad i=1,\\dots,N-1.\n$$\n- Enforce $C_0 = C(0)$ at $i=0$ and the radiation boundary at $i=N$ using a first-order one-sided derivative,\n$$\n\\frac{C_N - C_{N-1}}{\\Delta x} \\;=\\; r_-\\, C_N.\n$$\n\nDefinition of error metric:\n- Define the dimensionless relative $L^2$ error norm as\n$$\n\\varepsilon \\;=\\; \\frac{\\left( \\sum_{i=0}^{N} \\left(C_i - C_{\\text{exact}}(x_i)\\right)^2 \\,\\Delta x \\right)^{1/2}}{\\left( \\sum_{i=0}^{N} \\left(C_{\\text{exact}}(x_i)\\right)^2 \\,\\Delta x \\right)^{1/2}}.\n$$\n\nPeclet number variation:\n- Define the domain-scale Peclet number as $\\mathrm{Pe}_L = v L / D$. For each test case, compute $D$ from $D = v L / \\mathrm{Pe}_L$ to obtain the specified Peclet regime.\n\nPhysical units and constants:\n- Use $L$ in meters, $v$ in meters per day, $D$ in square meters per day, and $\\lambda$ in per day. Set the inlet concentration to $C_0 = 1$ in consistent arbitrary units; all outputs are dimensionless.\n\nTest suite:\n- Your program must evaluate the following four cases, each specified by $(L, v, \\mathrm{Pe}_L, \\lambda, N)$:\n    - Case $1$: $L=100$, $v=1$, $\\mathrm{Pe}_L=0.1$, $\\lambda=0$, $N=200$.\n    - Case $2$: $L=100$, $v=1$, $\\mathrm{Pe}_L=1$, $\\lambda=0$, $N=200$.\n    - Case $3$: $L=100$, $v=1$, $\\mathrm{Pe}_L=10$, $\\lambda=0.01$, $N=200$.\n    - Case $4$: $L=100$, $v=1$, $\\mathrm{Pe}_L=100$, $\\lambda=0.01$, $N=200$.\n\nWhat your program must do:\n- For each test case, compute $D$ from the specified $\\mathrm{Pe}_L$, assemble and solve the linear system defined by the discretization above, evaluate the analytical solution, and compute the dimensionless relative $L^2$ error $\\varepsilon$ as defined.\n- Report one floating-point number per test case corresponding to $\\varepsilon$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the four test cases above, for example, $[e_1,e_2,e_3,e_4]$, where each $e_k$ is the dimensionless relative $L^2$ error for case $k$.",
            "solution": "The problem requires a comparison between an analytical solution and a numerical solution for the one-dimensional steady-state advection-dispersion-reaction equation (ADRE). We will compute the dimensionless relative $L^2$ error norm for four test cases under varying Peclet number regimes. The process involves deriving the system of linear algebraic equations from the specified finite difference scheme, solving this system to obtain the numerical concentration profile, calculating the corresponding analytical profile, and finally computing the error norm.\n\n### 1. Problem Formulation\n\nThe governing equation for one-dimensional contaminant transport at steady state ($\\partial C/\\partial t = 0$) is given as a second-order ordinary differential equation (ODE):\n$$\nD \\frac{d^2 C}{dx^2} - v \\frac{d C}{dx} - \\lambda C = 0\n$$\nwhere $C(x)$ is the concentration, $v$ is the pore-water velocity, $D$ is the dispersion coefficient, and $\\lambda$ is the first-order decay rate constant. The domain is defined for $x \\in [0, L]$.\n\nThe boundary conditions are:\n1.  A Dirichlet condition at the inlet: $C(0) = C_0$.\n2.  A radiation (Robin-type) condition at the outlet: $\\left.\\frac{dC}{dx}\\right|_{x=L} = r_- C(L)$.\n\nThe analytical solution for a semi-infinite domain, which satisfies these conditions, is provided as:\n$$\nC_{\\text{exact}}(x) = C_0 \\exp(r_- x)\n$$\nwhere the rate constant $r_-$ is the negative root of the characteristic equation $D r^2 - v r - \\lambda = 0$:\n$$\nr_- = \\frac{v - \\sqrt{v^2 + 4 \\lambda D}}{2D}\n$$\nSince $v, \\lambda, D$ are all non-negative, the term under the square root is greater than or equal to $v^2$, ensuring that $r_- \\le 0$.\n\n### 2. Numerical Discretization and Linear System\n\nThe domain $[0, L]$ is discretized into a uniform grid with $N$ segments, yielding $N+1$ nodes $x_i = i \\Delta x$ for $i=0, 1, \\dots, N$, where $\\Delta x = L/N$. The concentration at these nodes is denoted by $C_i \\approx C(x_i)$.\n\nThe problem specifies a finite difference scheme for the interior nodes ($i=1, \\dots, N-1$): a second-order central difference for the dispersion term and a first-order upwind difference for the advection term (for $v > 0$).\n$$\nD \\frac{C_{i+1} - 2 C_i + C_{i-1}}{\\Delta x^2} - v \\frac{C_i - C_{i-1}}{\\Delta x} - \\lambda C_i = 0\n$$\nThis choice of upwinding for the advective term ensures the stability of the numerical scheme, particularly for advection-dominated problems (i.e., high cell Peclet numbers, $\\mathrm{Pe}_c = v \\Delta x / D$), but it introduces first-order truncation error, which is a source of numerical diffusion.\n\nRearranging the equation to group terms by node index ($C_{i-1}, C_i, C_{i+1}$):\n$$\n\\left(\\frac{D}{\\Delta x^2} + \\frac{v}{\\Delta x}\\right) C_{i-1} + \\left(-\\frac{2D}{\\Delta x^2} - \\frac{v}{\\Delta x} - \\lambda\\right) C_i + \\left(\\frac{D}{\\Delta x^2}\\right) C_{i+1} = 0\n$$\nThis equation is linear in the unknown concentrations $C_i$. We can write this set of equations for $i=1, \\dots, N-1$ in matrix form. Let the vector of unknowns be $\\mathbf{C}_{\\text{unk}} = [C_1, C_2, \\dots, C_N]^T$.\n\nThe boundary conditions are incorporated as follows:\n-   **Inlet ($i=0$):** $C_0$ is a known value. For the equation at $i=1$, the term involving $C_0$ is moved to the right-hand side.\n-   **Outlet ($i=N$):** The radiation boundary condition is discretized using a first-order one-sided difference:\n    $$\n    \\frac{C_N - C_{N-1}}{\\Delta x} = r_- C_N\n    $$\n    Rearranging gives a linear equation involving $C_{N-1}$ and $C_N$:\n    $$\n    -C_{N-1} + (1 - r_- \\Delta x) C_N = 0\n    $$\n\nWe assemble an $N \\times N$ linear system $M \\mathbf{C}_{\\text{unk}} = \\mathbf{d}$.\nLet the coefficients for the interior nodes be:\n-   Sub-diagonal: $A_{\\text{sub}} = \\frac{D}{\\Delta x^2} + \\frac{v}{\\Delta x}$\n-   Main diagonal: $A_{\\text{main}} = -\\frac{2D}{\\Delta x^2} - \\frac{v}{\\Delta x} - \\lambda$\n-   Super-diagonal: $A_{\\text{sup}} = \\frac{D}{\\Delta x^2}$\n\nThe system is constructed as follows (using 1-based indexing for equations and unknowns $C_1, \\dots, C_N$):\n-   **Equation 1 (for $C_1$):** From the stencil at $i=1$, we have $A_{\\text{sub}}C_0 + A_{\\text{main}}C_1 + A_{\\text{sup}}C_2 = 0$. Since $C_0$ is known, this becomes $A_{\\text{main}}C_1 + A_{\\text{sup}}C_2 = -A_{\\text{sub}}C_0$.\n-   **Equations $i=2, \\dots, N-1$ (for $C_2, \\dots, C_{N-1}$):** These are $A_{\\text{sub}}C_{i-1} + A_{\\text{main}}C_i + A_{\\text{sup}}C_{i+1} = 0$. This forms a tridiagonal structure in the corresponding rows of the matrix $M$.\n-   **Equation $N$ (for $C_N$):** From the outlet boundary condition, we have $-C_{N-1} + (1 - r_- \\Delta x)C_N = 0$.\n\nThe resulting matrix $M$ is nearly tridiagonal, and the system can be efficiently solved using a standard linear solver.\n\n### 3. Error Calculation\n\nOnce the numerical solution vector $\\mathbf{C}_{\\text{num}} = [C_0, C_1, \\dots, C_N]^T$ is obtained, we compare it to the analytical solution evaluated at the grid points, $\\mathbf{C}_{\\text{exact}} = [C_{\\text{exact}}(x_0), \\dots, C_{\\text{exact}}(x_N)]^T$.\n\nThe dimensionless relative $L^2$ error norm, $\\varepsilon$, is defined as:\n$$\n\\varepsilon = \\frac{\\left( \\sum_{i=0}^{N} (C_i - C_{\\text{exact}}(x_i))^2 \\Delta x \\right)^{1/2}}{\\left( \\sum_{i=0}^{N} (C_{\\text{exact}}(x_i))^2 \\Delta x \\right)^{1/2}}\n$$\nThe term $\\Delta x$ appears in both the numerator and denominator and thus cancels, simplifying the calculation to the ratio of the Euclidean norms of the error vector and the exact solution vector:\n$$\n\\varepsilon = \\frac{\\|\\mathbf{C}_{\\text{num}} - \\mathbf{C}_{\\text{exact}}\\|_2}{\\|\\mathbf{C}_{\\text{exact}}\\|_2}\n$$\n\n### 4. Implementation Strategy\n\nFor each test case specified by $(L, v, \\mathrm{Pe}_L, \\lambda, N)$:\n1.  Calculate the derived physical and numerical parameters: $D = v L / \\mathrm{Pe}_L$ and $\\Delta x = L/N$.\n2.  Calculate the analytical constant $r_-$.\n3.  Evaluate the analytical solution $C_{\\text{exact}}(x_i)$ at all $N+1$ grid points.\n4.  Construct the $N \\times N$ matrix $M$ and the $N \\times 1$ right-hand side vector $\\mathbf{d}$ for the linear system.\n5.  Solve $M \\mathbf{C}_{\\text{unk}} = \\mathbf{d}$ to find the numerical concentrations $C_1, \\dots, C_N$.\n6.  Assemble the full numerical solution vector $\\mathbf{C}_{\\text{num}} = [C_0, C_1, \\dots, C_N]^T$.\n7.  Compute the error norm $\\varepsilon$ using the formula above. The results for all four cases will be collected and printed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the contaminant transport problem for all test cases.\n    \"\"\"\n    \n    # Test suite: (L, v, Pe_L, lambda, N)\n    test_cases = [\n        (100.0, 1.0, 0.1, 0.0, 200),\n        (100.0, 1.0, 1.0, 0.0, 200),\n        (100.0, 1.0, 10.0, 0.01, 200),\n        (100.0, 1.0, 100.0, 0.01, 200),\n    ]\n\n    results = []\n    for case in test_cases:\n        error = calculate_error_for_case(*case)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\ndef calculate_error_for_case(L, v, Pe_L, lam, N):\n    \"\"\"\n    Calculates the dimensionless relative L2 error for a single test case.\n\n    Args:\n        L (float): Domain length [m].\n        v (float): Pore-water velocity [m/day].\n        Pe_L (float): Domain-scale Peclet number.\n        lam (float): First-order decay constant [1/day].\n        N (int): Number of grid segments.\n\n    Returns:\n        float: The dimensionless relative L2 error.\n    \"\"\"\n    # --- 1. Calculate derived parameters ---\n    C0 = 1.0\n    dx = L / N\n    D = v * L / Pe_L\n    \n    # Check for non-physical conditions, though not expected from problem statement\n    if D <= 0:\n        raise ValueError(\"Dispersion coefficient D must be positive.\")\n\n    # Calculate the exponent r_minus for the analytical solution\n    # The term under the square root is always non-negative for this problem\n    r_minus_sqrt_term = np.sqrt(v**2 + 4 * lam * D)\n    r_minus = (v - r_minus_sqrt_term) / (2 * D)\n\n    # --- 2. Evaluate Analytical Solution ---\n    x = np.linspace(0, L, N + 1)  # Grid with N+1 points\n    C_exact = C0 * np.exp(r_minus * x)\n\n    # --- 3. Set up and Solve the Numerical System ---\n    # The system is M * C_unk = d, for unknowns C_1, ..., C_N\n    M = np.zeros((N, N))\n    d = np.zeros(N)\n\n    # Coefficients for the interior node finite difference equation\n    A_sup = D / dx**2\n    A_sub = D / dx**2 + v / dx\n    A_main = -2 * D / dx**2 - v / dx - lam\n\n    # Assemble the matrix M and vector d\n    # The unknown vector is C_unk = [C_1, C_2, ..., C_N]\n    # Matrix indices are 0 to N-1 for unknowns 1 to N\n    \n    # Equation for node i=1 (matrix row 0)\n    # A_sub*C_0 + A_main*C_1 + A_sup*C_2 = 0\n    M[0, 0] = A_main\n    M[0, 1] = A_sup\n    d[0] = -A_sub * C0\n\n    # Equations for interior nodes i=2 to N-1 (matrix rows 1 to N-2)\n    for i in range(1, N - 1):\n        # row i is for node i+1\n        M[i, i - 1] = A_sub\n        M[i, i] = A_main\n        M[i, i + 1] = A_sup\n\n    # Equation for node i=N (outlet BC, matrix row N-1)\n    # (C_N - C_{N-1}) / dx = r_minus * C_N  => -C_{N-1} + (1 - r_minus*dx)*C_N = 0\n    M[N - 1, N - 2] = -1.0\n    M[N - 1, N - 1] = 1.0 - r_minus * dx\n\n    # Solve the linear system\n    C_unk = np.linalg.solve(M, d)\n\n    # Construct the full numerical solution vector [C_0, C_1, ..., C_N]\n    C_num = np.concatenate(([C0], C_unk))\n\n    # --- 4. Compute the Error Norm ---\n    # The dx term in the sum cancels out, so we can compute the norm directly.\n    numerator = np.linalg.norm(C_num - C_exact)\n    denominator = np.linalg.norm(C_exact)\n\n    if denominator == 0:\n        # This case would only occur if C_exact is uniformly zero, which doesn't happen here.\n        return 0.0 if numerator == 0 else np.inf\n\n    error = numerator / denominator\n    return error\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "A verified model is a powerful tool for predictive analysis, and a common task is to determine which physical and chemical parameters most strongly influence its outcome. This practice elevates your skills by having you implement a transient transport model to perform a local sensitivity analysis . By systematically perturbing key parameters like velocity, dispersion, and reaction rates, you will quantify their impact on plume concentration and learn to rank their importance, a foundational technique in model calibration and risk assessment.",
            "id": "4086179",
            "problem": "You are tasked with implementing a local sensitivity analysis for a one-dimensional contaminant transport model with natural attenuation in a saturated porous medium. The governing physics are based on a mass balance for a dissolved species undergoing advection, hydrodynamic dispersion, linear equilibrium sorption, and first-order decay. The mathematical model is the advection-dispersion-reaction equation with linear retardation, expressed in one spatial dimension as\n$$\nR \\,\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} = D\\,\\frac{\\partial^2 C}{\\partial x^2} - \\lambda\\,R\\,C,\n$$\nwhere $C(x,t)$ is the dissolved concentration, $R$ is the retardation factor due to sorption, $v$ is the average linear groundwater velocity, $D$ is the hydrodynamic dispersion coefficient, and $\\lambda$ is the first-order decay constant. Linear equilibrium sorption is represented by the retardation factor\n$$\nR = 1 + \\frac{\\rho_b K_d}{n},\n$$\nwhere $\\rho_b$ is the bulk density, $K_d$ is the linear distribution coefficient, and $n$ is the porosity.\n\nInitial and boundary conditions are as follows:\n- Initial condition: $$C(x,0) = 0 \\quad \\text{for} \\quad 0 \\le x \\le L.$$\n- Left boundary at $x=0$ (source): $$C(0,t) = C_{\\mathrm{in}}(t), \\quad \\text{where } C_{\\mathrm{in}}(t) = \\begin{cases} C_0, & 0 \\le t \\le t_s, \\\\ 0, & t > t_s, \\end{cases}$$ with $C_0$ the constant source concentration and $t_s$ the source shut-off time.\n- Right boundary at $x=L$: Zero-gradient (Neumann) condition $$\\frac{\\partial C}{\\partial x}(L,t) = 0.$$\n\nYour program must:\n1. Discretize the governing equation using a fully implicit, first-order accurate in time, upwind scheme for the advective term and central differences for the dispersive term. Explicitly, divide by the retardation factor to write\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{v}{R}\\,\\frac{\\partial C}{\\partial x} = \\frac{D}{R}\\,\\frac{\\partial^2 C}{\\partial x^2} - \\lambda\\,C,\n$$\nthen time-discretize at $t^{n+1}$ and construct a tridiagonal linear system enforcing the left Dirichlet boundary and right Neumann boundary. The scheme must be unconditionally stable and monotone for $v > 0$.\n2. For a specified observation location $x_w$ and final time $t_f$, compute the predicted plume concentration $C(x_w,t_f)$ in $\\mathrm{mg/L}$ for a given parameter set $\\{v,D,\\lambda,K_d\\}$ along with fixed $\\{n,\\rho_b,L,x_w,\\Delta t,t_f,C_0,t_s,N\\}$, where $N$ is the number of spatial nodes.\n3. Perform a local sensitivity analysis by estimating the partial derivatives\n$$\n\\frac{\\partial C(x_w,t_f)}{\\partial p_i}\n$$\nfor each parameter $p_i \\in \\{v,D,\\lambda,K_d\\}$ using a symmetric two-sided finite-difference approximation\n$$\n\\frac{\\partial C}{\\partial p_i} \\approx \\frac{C(x_w,t_f; p_i + \\delta_i) - C(x_w,t_f; p_i - \\delta_i)}{2\\,\\delta_i},\n$$\nwhere the perturbation $\\delta_i$ must satisfy $\\delta_i = \\max(\\epsilon\\,|p_i|, \\delta_{i,\\min})$ with a small relative step $0 < \\epsilon \\ll 1$ and parameter-specific minimum steps $\\delta_{i,\\min}$ to avoid zero-step issues when $p_i$ is very small or zero. Ensure all perturbed parameters remain physically meaningful (e.g., nonnegative).\n4. Rank the parameters by the magnitude of their local sensitivity, i.e., sort indices of $p_i$ in descending order of $\\left|\\frac{\\partial C}{\\partial p_i}\\right|$. Use the index mapping $p_0 \\equiv v$, $p_1 \\equiv D$, $p_2 \\equiv \\lambda$, $p_3 \\equiv K_d$.\n\nExpress all concentrations internally and as computed values in $\\mathrm{mg/L}$, distances in $\\mathrm{m}$, time in $\\mathrm{s}$, velocity in $\\mathrm{m/s}$, dispersion in $\\mathrm{m^2/s}$, decay in $\\mathrm{s^{-1}}$, bulk density in $\\mathrm{kg/m^3}$, porosity as dimensionless, and distribution coefficient in $\\mathrm{m^3/kg}$. Angles do not appear. The final output is the ranking of parameter indices and is unitless.\n\nTest Suite. Implement and evaluate the following three test cases, each defined by a tuple of parameters in the order $(v,D,\\lambda,K_d,n,\\rho_b,L,x_w,\\Delta t,t_f,C_0,t_s,N)$:\n- Case A (typical conditions): $(1.0\\times 10^{-5},\\,1.0\\times 10^{-6},\\,1.0\\times 10^{-7},\\,5.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$.\n- Case B (low dispersion, faster flow): $(1.5\\times 10^{-5},\\,1.0\\times 10^{-8},\\,1.0\\times 10^{-7},\\,5.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$.\n- Case C (negligible decay, higher sorption): $(8.0\\times 10^{-6},\\,5.0\\times 10^{-7},\\,0.0,\\,7.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$.\n\nLocal sensitivity settings: Use a relative perturbation $\\epsilon = 0.01$ for all parameters and minimum perturbations $(\\delta_{v,\\min},\\delta_{D,\\min},\\delta_{\\lambda,\\min},\\delta_{K_d,\\min}) = (1.0\\times 10^{-8},\\,1.0\\times 10^{-10},\\,1.0\\times 10^{-10},\\,1.0\\times 10^{-6})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a list of the ranked parameter indices for the corresponding test case, for example, $$\\texttt{[[i_1,i_2,i_3,i_4],[j_1,j_2,j_3,j_4],[k_1,k_2,k_3,k_4]]}$$ with $i_1$ the most influential parameter index for Case A, and so on. The final outputs must be integer lists.",
            "solution": "The user has provided a computationally-intensive problem in the field of computational geochemistry, requiring the implementation of a numerical model for contaminant transport and a subsequent local sensitivity analysis.\n\n### Step 1: Extract Givens\n\n- **Governing Equation**: The one-dimensional advection-dispersion-reaction equation with linear retardation is given as:\n  $$\n  R \\,\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} = D\\,\\frac{\\partial^2 C}{\\partial x^2} - \\lambda\\,R\\,C\n  $$\n  where $C(x,t)$ is the dissolved concentration, $R$ is the retardation factor, $v$ is the average linear groundwater velocity, $D$ is the hydrodynamic dispersion coefficient, and $\\lambda$ is the first-order decay constant.\n\n- **Retardation Factor**:\n  $$\n  R = 1 + \\frac{\\rho_b K_d}{n}\n  $$\n  where $\\rho_b$ is the bulk density, $K_d$ is the linear distribution coefficient, and $n$ is the porosity.\n\n- **Initial and Boundary Conditions**:\n  - Initial condition: $C(x,0) = 0$ for $0 \\le x \\le L$.\n  - Left boundary ($x=0$): A pulse source specified by a Dirichlet condition, $C(0,t) = C_{\\mathrm{in}}(t)$, where $C_{\\mathrm{in}}(t) = C_0$ for $0 \\le t \\le t_s$ and $C_{\\mathrm{in}}(t) = 0$ for $t > t_s$.\n  - Right boundary ($x=L$): A zero-gradient Neumann condition, $\\frac{\\partial C}{\\partial x}(L,t) = 0$.\n\n- **Numerical Scheme**: A fully implicit, first-order accurate in time scheme is required. Spatial discretization uses a first-order upwind scheme for the advective term and a second-order central difference for the dispersive term.\n\n- **Sensitivity Analysis**: The partial derivatives $\\frac{\\partial C(x_w,t_f)}{\\partial p_i}$ for each parameter $p_i \\in \\{v,D,\\lambda,K_d\\}$ are to be estimated using a symmetric two-sided finite-difference approximation:\n  $$\n  \\frac{\\partial C}{\\partial p_i} \\approx \\frac{C(x_w,t_f; p_i + \\delta_i) - C(x_w,t_f; p_i - \\delta_i)}{2\\,\\delta_i}\n  $$\n  The perturbation $\\delta_i$ is defined as $\\delta_i = \\max(\\epsilon\\,|p_i|, \\delta_{i,\\min})$, with $\\epsilon = 0.01$. The minimum perturbations are given as $(\\delta_{v,\\min},\\delta_{D,\\min},\\delta_{\\lambda,\\min},\\delta_{K_d,\\min}) = (1.0\\times 10^{-8},\\,1.0\\times 10^{-10},\\,1.0\\times 10^{-10},\\,1.0\\times 10^{-6})$.\n\n- **Parameter Ranking**: Parameters are to be ranked in descending order of the magnitude of their local sensitivity, $\\left|\\frac{\\partial C}{\\partial p_i}\\right|$. The parameter index mapping is $p_0 \\equiv v$, $p_1 \\equiv D$, $p_2 \\equiv \\lambda$, $p_3 \\equiv K_d$.\n\n- **Test Cases**: Three specific sets of parameters are provided for evaluation.\n  - Case A: $(v,D,\\lambda,K_d,n,\\rho_b,L,x_w,\\Delta t,t_f,C_0,t_s,N) = (1.0\\times 10^{-5},\\,1.0\\times 10^{-6},\\,1.0\\times 10^{-7},\\,5.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$.\n  - Case B: $(1.5\\times 10^{-5},\\,1.0\\times 10^{-8},\\,1.0\\times 10^{-7},\\,5.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$.\n  - Case C: $(8.0\\times 10^{-6},\\,5.0\\times 10^{-7},\\,0.0,\\,7.0\\times 10^{-4},\\,0.30,\\,1700,\\,200,\\,100,\\,2.0\\times 10^{5},\\,2.0\\times 10^{7},\\,100,\\,5.0\\times 10^{6},\\,201)$.\n\n- **Units and Output Format**: All units are specified. The final output must be a single-line string representing a list of lists of ranked integer indices.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded**: The problem is fundamentally sound. The governing equation is the standard Advection-Dispersion-Reaction Equation (ADRE), a cornerstone of contaminant transport modeling. The formula for the retardation factor is the correct representation for linear equilibrium sorption.\n- **Well-Posed**: The problem is well-posed. The ADRE with the given initial and boundary conditions (a pulse-type source and a zero-flux outlet) is a standard initial-boundary value problem that admits a unique solution. The required numerical scheme is a known stable method (fully implicit). The method for sensitivity analysis is a standard numerical technique.\n- **Objective**: The problem is free of subjectivity. All parameters, variables, and constants are clearly defined with their respective units. The tasks are specified with mathematical and algorithmic precision.\n- **Completeness and Consistency**: The problem statement is self-contained. It provides all necessary physical parameters ($v, D, \\lambda, K_d, n, \\rho_b$), domain specifications ($L$), boundary condition parameters ($C_0, t_s$), numerical discretization parameters ($N, \\Delta t, t_f$), and observation details ($x_w, t_f$). The units are consistent. There are no contradictions.\n- **Feasibility**: The parameter values provided are physically realistic for typical groundwater contamination scenarios. The computational task, while intensive, is feasible to implement and execute.\n- **Other Flaws**: The problem is not trivial, non-formalizable, or unverifiable. It is a well-defined, standard problem in computational science.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A solution will be constructed.\n\n### Solution\n\nThe solution proceeds in two stages. First, we develop a numerical solver for the governing partial differential equation (PDE). Second, we use this solver to perform the local sensitivity analysis.\n\n**1. Numerical Model for the Governing Equation**\n\nThe governing PDE is first rewritten by dividing by the retardation factor $R$:\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{D}{R}\\frac{\\partial^2 C}{\\partial x^2} - \\frac{v}{R}\\frac{\\partial C}{\\partial x} - \\lambda C\n$$\nLet's define the effective (retarded) dispersion and velocity as $D' = D/R$ and $v' = v/R$, respectively. The equation becomes:\n$$\n\\frac{\\partial C}{\\partial t} = D'\\frac{\\partial^2 C}{\\partial x^2} - v'\\frac{\\partial C}{\\partial x} - \\lambda C\n$$\nWe discretize this equation on a uniform grid with spatial step $\\Delta x = L/(N-1)$ and time step $\\Delta t$. Let $C_i^j$ denote the numerical approximation of the concentration $C(x_i, t_j)$ where $x_i = i\\Delta x$ and $t_j = j\\Delta t$.\n\nA fully implicit time-stepping scheme evaluates all spatial derivatives at the future time level $j+1$:\n$$\n\\frac{C_i^{j+1} - C_i^j}{\\Delta t} = D' \\left(\\frac{\\partial^2 C}{\\partial x^2}\\right)_i^{j+1} - v' \\left(\\frac{\\partial C}{\\partial x}\\right)_i^{j+1} - \\lambda C_i^{j+1}\n$$\nThe spatial derivatives are approximated as specified: a first-order upwind scheme for advection (assuming $v' > 0$) and a second-order central difference for dispersion.\n$$\n\\left(\\frac{\\partial C}{\\partial x}\\right)_i^{j+1} \\approx \\frac{C_i^{j+1} - C_{i-1}^{j+1}}{\\Delta x}\n$$\n$$\n\\left(\\frac{\\partial^2 C}{\\partial x^2}\\right)_i^{j+1} \\approx \\frac{C_{i+1}^{j+1} - 2C_i^{j+1} + C_{i-1}^{j+1}}{(\\Delta x)^2}\n$$\nSubstituting these approximations into the time-discretized equation and rearranging terms to group unknowns (at time level $j+1$) on the left-hand side yields a linear equation for each internal node $i=1, \\dots, N-2$:\n$$\n\\left(-\\frac{v'}{\\Delta x} - \\frac{D'}{(\\Delta x)^2}\\right)C_{i-1}^{j+1} + \\left(\\frac{1}{\\Delta t} + \\frac{v'}{\\Delta x} + \\frac{2D'}{(\\Delta x)^2} + \\lambda\\right)C_i^{j+1} + \\left(-\\frac{D'}{(\\Delta x)^2}\\right)C_{i+1}^{j+1} = \\frac{C_i^j}{\\Delta t}\n$$\nThis forms a tridiagonal system of linear equations, $\\mathbf{A}\\mathbf{C}^{j+1} = \\mathbf{d}$, where $\\mathbf{C}^{j+1}$ is the vector of unknown concentrations at the new time step.\n\n**Boundary Conditions:**\n- **Left Boundary ($i=0$):** The Dirichlet condition $C_0^{j+1} = C_{\\mathrm{in}}(t_{j+1})$ is enforced directly. For the first equation of the system (at $i=1$), the term involving $C_0^{j+1}$ is known and moved to the right-hand side.\n- **Right Boundary ($i=N-1$):** The Neumann condition $\\frac{\\partial C}{\\partial x}(L, t) = 0$ is approximated using a second-order central difference involving a \"ghost\" node $C_N^{j+1}$: $\\frac{C_N^{j+1}-C_{N-2}^{j+1}}{2\\Delta x} = 0$, which implies $C_N^{j+1} = C_{N-2}^{j+1}$. Substituting this into the discretized PDE at node $i=N-1$ modifies the last equation of the linear system.\n\nThe resulting $(N-1) \\times (N-1)$ tridiagonal system is solved at each time step to advance the solution from $t_j$ to $t_{j+1}$. The system is strictly diagonally dominant, ensuring that a stable solution can be obtained efficiently using an algorithm like the Thomas algorithm (implemented in `scipy.linalg.solve_banded`). Starting with the initial condition $C(x,0) = 0$, the solution is marched forward in time until the final time $t_f$ is reached.\n\n**2. Local Sensitivity Analysis**\n\nThe core of the analysis is a function, `solve_pde`, that accepts the full set of model parameters and returns the concentration $C(x_w, t_f)$. To compute the sensitivity with respect to a parameter $p_i \\in \\{v, D, \\lambda, K_d\\}$, we use the two-sided finite difference formula. This requires two additional calls to the `solve_pde` function with perturbed parameter values, $p_i + \\delta_i$ and $p_i - \\delta_i$.\n\nA special case arises when a perturbed parameter value becomes physically meaningless (e.g., negative). The problem statement requires that perturbations maintain physical meaning. If $p_i - \\delta_i < 0$, the symmetric difference formula cannot be used. This occurs for parameter $\\lambda$ in Case C, where $\\lambda=0$. In such cases, we fall back to a first-order forward finite difference:\n$$\n\\frac{\\partial C}{\\partial p_i} \\approx \\frac{C(x_w,t_f; p_i + \\delta_i) - C(x_w,t_f; p_i)}{\\delta_i}\n$$\nThis requires one call with a perturbed parameter set and one with the base parameter set.\n\nFor each test case, this procedure is repeated for all four parameters of interest ($v$, $D$, $\\lambda$, $K_d$). The absolute values of the computed sensitivities, $\\left|\\frac{\\partial C}{\\partial p_i}\\right|$, are then used to rank the parameters from most influential (largest sensitivity) to least influential. The final output is an ordered list of the parameter indices ($0$ for $v$, $1$ for $D$, $2$ for $\\lambda$, $3$ for $K_d$).",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve_pde(v, D, lambda_rate, Kd, n, rhob, L, xw, dt, tf, C0, ts, N):\n    \"\"\"\n    Solves the 1D advection-dispersion-reaction equation using a fully implicit finite-difference scheme.\n\n    Returns:\n        Concentration at observation well xw and final time tf.\n    \"\"\"\n    # 1. Spatial and temporal discretization parameters\n    dx = L / (N - 1.0)\n    n_steps = int(round(tf / dt))\n    xw_idx = int(round(xw / dx))\n\n    # 2. Derived physical parameters\n    if n <= 0: return -1.0 # Avoid division by zero\n    retardation_factor = 1.0 + rhob * Kd / n\n    if retardation_factor <= 0: return -1.0 # Unphysical\n    \n    eff_velocity = v / retardation_factor\n    eff_dispersion = D / retardation_factor\n\n    # 3. Initialize concentration field\n    C = np.zeros(N)\n\n    # 4. Assemble the tridiagonal matrix for the linear system A*C = d\n    # The matrix is time-invariant for this problem.\n    # We solve for the N-1 internal nodes (1 to N-1).\n    sub_diag_val = -(eff_velocity / dx + eff_dispersion / (dx**2))\n    main_diag_val = 1.0 / dt + eff_velocity / dx + 2.0 * eff_dispersion / (dx**2) + lambda_rate\n    sup_diag_val = -eff_dispersion / (dx**2)\n\n    # Scipy's solve_banded uses a special format for the banded matrix\n    ab = np.zeros((3, N - 1))\n    ab[0, 1:] = sup_diag_val       # Super-diagonal\n    ab[1, :] = main_diag_val       # Main-diagonal\n    ab[2, :-1] = sub_diag_val      # Sub-diagonal\n\n    # Modify the last row for the zero-gradient Neumann boundary condition\n    # a_{N-1}' * C_{N-2} + b_{N-1} * C_{N-1} = d_{N-1}\n    # where a_{N-1}' = -(v'/dx + 2D'/dx^2)\n    ab[2, N - 2] = -(eff_velocity / dx + 2.0 * eff_dispersion / (dx**2))\n\n    # 5. Time-stepping loop\n    for step in range(n_steps):\n        t_current = (step + 1) * dt\n        C_in = C0 if t_current <= ts else 0.0\n\n        # Construct the right-hand side (RHS) vector\n        d = C[1:] / dt\n        \n        # Modify RHS for the Dirichlet boundary at x=0\n        # The term a_1*C_0 is moved to the RHS.\n        # d[0]' = d[0] - a_1 * C_0 where a_1 is sub_diag_val.\n        d[0] -= sub_diag_val * C_in\n\n        # Solve the tridiagonal system for internal nodes\n        C_internal = solve_banded((1, 1), ab, d)\n\n        # Update the full concentration vector\n        C[0] = C_in\n        C[1:] = C_internal\n\n    return C[xw_idx]\n\ndef run_sensitivity_analysis(case):\n    \"\"\"\n    Performs local sensitivity analysis for a given test case.\n    \"\"\"\n    v, D, lambda_rate, Kd, n, rhob, L, xw, dt, tf, C0, ts, N = case\n    params_to_analyze = [v, D, lambda_rate, Kd]\n    param_names = ['v', 'D', 'lambda', 'Kd']\n    \n    epsilon = 0.01\n    delta_mins = {\n        'v': 1.0e-8,\n        'D': 1.0e-10,\n        'lambda': 1.0e-10,\n        'Kd': 1.0e-6\n    }\n    \n    sensitivities = []\n\n    for i, p_val in enumerate(params_to_analyze):\n        p_name = param_names[i]\n        \n        delta = max(epsilon * abs(p_val), delta_mins[p_name])\n        \n        # Create argument list for the solver\n        args = list(case)\n\n        # Check if symmetric difference leads to negative parameters\n        if p_val - delta < 0:\n            # Use forward difference for physical plausibility\n            args_plus = list(args)\n            args_plus[i] = p_val + delta\n            C_plus = solve_pde(*args_plus)\n            \n            C_base = solve_pde(*args)\n            \n            sensitivity = (C_plus - C_base) / delta\n        else:\n            # Use central difference\n            args_plus = list(args)\n            args_plus[i] = p_val + delta\n            C_plus = solve_pde(*args_plus)\n            \n            args_minus = list(args)\n            args_minus[i] = p_val - delta\n            C_minus = solve_pde(*args_minus)\n            \n            sensitivity = (C_plus - C_minus) / (2.0 * delta)\n            \n        sensitivities.append(sensitivity)\n\n    # Rank parameters by sensitivity magnitude\n    # np.argsort returns indices that would sort the array.\n    # We use a negative sign for descending order.\n    # The result is a list of indices [0, 1, 2, 3] sorted by sensitivity.\n    ranked_indices = np.argsort(-np.abs(sensitivities)).tolist()\n    return ranked_indices\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Test cases: (v, D, lambda, Kd, n, rhob, L, xw, dt, tf, C0, ts, N)\n    test_cases = [\n        (1.0e-5, 1.0e-6, 1.0e-7, 5.0e-4, 0.30, 1700, 200, 100, 2.0e5, 2.0e7, 100, 5.0e6, 201),\n        (1.5e-5, 1.0e-8, 1.0e-7, 5.0e-4, 0.30, 1700, 200, 100, 2.0e5, 2.0e7, 100, 5.0e6, 201),\n        (8.0e-6, 5.0e-7, 0.0,    7.0e-4, 0.30, 1700, 200, 100, 2.0e5, 2.0e7, 100, 5.0e6, 201)\n    ]\n\n    results = []\n    for case in test_cases:\n        ranked_indices = run_sensitivity_analysis(case)\n        results.append(ranked_indices)\n\n    # Format the output string to match the problem specification (no spaces)\n    print(str(results).replace(\" \", \"\"))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}