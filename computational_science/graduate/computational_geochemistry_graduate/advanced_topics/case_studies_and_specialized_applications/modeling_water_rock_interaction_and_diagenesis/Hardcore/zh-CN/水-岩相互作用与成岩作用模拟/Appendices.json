{
    "hands_on_practices": [
        {
            "introduction": "在模拟反应速率之前，我们必须首先确定反应是否会自发进行。本练习引入反应亲和势 ($A$) 的概念，这是一个源于吉布斯自由能的关键热力学量，用以量化反应的驱动力。通过计算给定流体条件下矿物溶解反应的 $A$ 值，您将学会评估系统是处于欠饱和还是过饱和状态，并理解其趋向平衡的热力学驱动强度 。",
            "id": "4090177",
            "problem": "考虑钙斜长石端元钙长石的溶解，其宏观的、酸促进的化学计量关系为\n$$\\mathrm{CaAl_{2}Si_{2}O_{8}(s)} + 8\\,\\mathrm{H^{+}} + \\mathrm{H_{2}O} \\rightleftharpoons \\mathrm{Ca^{2+}} + 2\\,\\mathrm{Al^{3+}} + 2\\,\\mathrm{H_{4}SiO_{4}^{0}}.$$\n假设在一个标准态约定中，纯固相钙长石的活度为 $a_{\\mathrm{An}} = 1$，水的活度为 $a_{\\mathrm{H_{2}O}} = 1$。在温度 $T = 298.15\\,\\mathrm{K}$ 时，该反应的平衡常数以无量纲的 $K(T) = 1.0 \\times 10^{22}$ 形式给出。水溶液活度如下：\n- $a_{\\mathrm{Ca^{2+}}} = 1.0 \\times 10^{-4}$,\n- $a_{\\mathrm{Al^{3+}}} = 1.0 \\times 10^{-6}$,\n- $a_{\\mathrm{H_{4}SiO_{4}^{0}}} = 1.0 \\times 10^{-3}$,\n- $a_{\\mathrm{H^{+}}} = 1.0 \\times 10^{-5}$。\n\n从基础化学热力学出发，利用化学势和反应吉布斯能的定义，推导正向溶解反应的反应亲和势 (RA) $A$ 的表达式，该表达式应以平衡常数 $K(T)$ 和反应商 $Q$ 表示。然后，根据上述条件计算 $A$。使用普适气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。将最终数值结果四舍五入至四位有效数字，并以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示最终的亲和势。最后，根据 $A$ 的符号和大小，从未饱和或过饱和以及驱动力强度的角度，解释钙长石在该溶液中的溶解趋势。",
            "solution": "该问题经核实具有科学依据，提法明确且客观。完整解答所需的所有数据和条件均已提供。\n\n第一步是从基本热力学原理推导反应亲和势 $A$ 的表达式。对于一个通用的化学反应 $\\sum_i \\nu_i X_i = 0$，其反应吉布斯能 $\\Delta_rG$ 定义为反应物和产物化学势 $\\mu_i$ 的总和，并以其化学计量系数 $\\nu_i$（产物为正，反应物为负）进行加权：\n$$ \\Delta_rG = \\sum_i \\nu_i \\mu_i $$\n物种 $i$ 的化学势 $\\mu_i$ 与其标准态化学势 $\\mu_i^\\circ$ 及其活度 $a_i$ 的关系由以下表达式给出：\n$$ \\mu_i = \\mu_i^\\circ + RT \\ln(a_i) $$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度。\n\n将 $\\mu_i$ 的表达式代入 $\\Delta_rG$ 的方程中：\n$$ \\Delta_rG = \\sum_i \\nu_i (\\mu_i^\\circ + RT \\ln(a_i)) = \\sum_i \\nu_i \\mu_i^\\circ + RT \\sum_i \\nu_i \\ln(a_i) $$\n项 $\\sum_i \\nu_i \\mu_i^\\circ$ 是标准反应吉布斯能 $\\Delta_rG^\\circ$。项 $\\sum_i \\nu_i \\ln(a_i)$ 可以利用对数的性质改写为 $\\ln(\\prod_i a_i^{\\nu_i})$。乘积 $\\prod_i a_i^{\\nu_i}$ 是反应商 $Q$ 的定义。\n因此，$\\Delta_rG$ 的表达式变为：\n$$ \\Delta_rG = \\Delta_rG^\\circ + RT \\ln(Q) $$\n在化学平衡时，反应吉布斯能为零（$\\Delta_rG = 0$），反应商等于平衡常数 $K$。因此：\n$$ 0 = \\Delta_rG^\\circ + RT \\ln(K) \\implies \\Delta_rG^\\circ = -RT \\ln(K) $$\n将 $\\Delta_rG^\\circ$ 的这个表达式代回 $\\Delta_rG$ 的方程中：\n$$ \\Delta_rG = -RT \\ln(K) + RT \\ln(Q) = RT (\\ln(Q) - \\ln(K)) = RT \\ln\\left(\\frac{Q}{K}\\right) $$\n反应亲和势 $A$ 定义为摩尔反应吉布斯能的负值，即 $A = -\\Delta_rG$。因此：\n$$ A = -RT \\ln\\left(\\frac{Q}{K}\\right) = RT \\ln\\left(\\frac{K}{Q}\\right) $$\n这就是所求的反应亲和势 $A$、平衡常数 $K$ 和反应商 $Q$ 之间的关系。\n\n接下来，我们计算给定反应和水溶液活度下的 $Q$ 值。反应是：\n$$ \\mathrm{CaAl_{2}Si_{2}O_{8}(s)} + 8\\,\\mathrm{H^{+}} + \\mathrm{H_{2}O} \\rightleftharpoons \\mathrm{Ca^{2+}} + 2\\,\\mathrm{Al^{3+}} + 2\\,\\mathrm{H_{4}SiO_{4}^{0}} $$\n反应商 $Q$ 由以下表达式给出：\n$$ Q = \\frac{a_{\\mathrm{Ca^{2+}}} (a_{\\mathrm{Al^{3+}}})^{2} (a_{\\mathrm{H_{4}SiO_{4}^{0}}})^{2}}{a_{\\mathrm{CaAl_{2}Si_{2}O_{8}}} (a_{\\mathrm{H^{+}}})^{8} a_{\\mathrm{H_{2}O}}} $$\n使用所提供的活度：$a_{\\mathrm{Ca^{2+}}} = 1.0 \\times 10^{-4}$，$a_{\\mathrm{Al^{3+}}} = 1.0 \\times 10^{-6}$，$a_{\\mathrm{H_{4}SiO_{4}^{0}}} = 1.0 \\times 10^{-3}$，$a_{\\mathrm{H^{+}}} = 1.0 \\times 10^{-5}$，以及标准态约定 $a_{\\mathrm{CaAl_{2}Si_{2}O_{8}}} = 1$ 和 $a_{\\mathrm{H_{2}O}} = 1$：\n$$ Q = \\frac{(1.0 \\times 10^{-4}) (1.0 \\times 10^{-6})^{2} (1.0 \\times 10^{-3})^{2}}{(1) (1.0 \\times 10^{-5})^{8} (1)} $$\n$$ Q = \\frac{(1.0 \\times 10^{-4}) (1.0 \\times 10^{-12}) (1.0 \\times 10^{-6})}{1.0 \\times 10^{-40}} $$\n$$ Q = \\frac{1.0 \\times 10^{-22}}{1.0 \\times 10^{-40}} = 1.0 \\times 10^{18} $$\n现在，我们可以使用 $K = 1.0 \\times 10^{22}$，$Q = 1.0 \\times 10^{18}$，$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和 $T = 298.15\\,\\mathrm{K}$ 来计算反应亲和势 $A$。\n$$ A = RT \\ln\\left(\\frac{K}{Q}\\right) = (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(298.15\\,\\mathrm{K}) \\ln\\left(\\frac{1.0 \\times 10^{22}}{1.0 \\times 10^{18}}\\right) $$\n$$ A = (2478.9566...\\,\\mathrm{J\\,mol^{-1}}) \\ln(1.0 \\times 10^{4}) $$\n$$ A = (2478.9566...\\,\\mathrm{J\\,mol^{-1}}) \\times 9.21034... $$\n$$ A = 22832.06...\\,\\mathrm{J\\,mol^{-1}} $$\n问题要求最终答案以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位，并四舍五入至四位有效数字。\n$$ A = 22.83206...\\,\\mathrm{kJ\\,mol^{-1}} \\approx 22.83\\,\\mathrm{kJ\\,mol^{-1}} $$\n最后，我们对结果进行解释。反应亲和势 $A$ 为正值（$A = 22.83\\,\\mathrm{kJ\\,mol^{-1}} > 0$）。由于 $A = -\\Delta_rG$，正的亲和势意味着反应吉布斯能 $\\Delta_rG$ 为负值。负的 $\\Delta_rG$ 表明在指定条件下，正向反应（钙长石溶解）是自发的并且在热力学上是有利的。这意味着相对于钙长石，该溶液是**未饱和**的。亲和势的大小 $22.83\\,\\mathrm{kJ\\,mol^{-1}}$ 量化了溶解反应的热力学驱动力。这是一个显著的驱动力，表明钙长石会在此溶液中自发而有力地溶解，直到产物的活度增加（或反应物的活度减少）到达到平衡的点（$A = 0$）。",
            "answer": "$$\\boxed{22.83}$$"
        },
        {
            "introduction": "在理解了热力学驱动力的基础上，本练习将深入探讨反应动力学——即研究反应速率的学科。本练习运用从基本原理推导出的阿伦尼乌斯方程，来探索在地质过程（如埋藏）中温度变化如何影响矿物溶解速率。通过计算速率变化和相应的成岩时间尺度，您将对动力学如何控制地质转变的节奏获得定量的理解 。",
            "id": "4090138",
            "problem": "一个钠长石（骨架长石）颗粒状反应床经历埋藏加热，导致温度从初始环境值升高到一个更高的恒定值。考虑远离平衡的溶解过程，该过程中输运维持了恒定的水溶液欠饱和度。使用基本动力学理论推导并计算溶解速率的热敏感性以及由此产生的成岩时间尺度。\n\n从“反应事件发生于系统越过一个摩尔高度为 $E_a$ 的活化能垒”以及“具有足够能量越过该能垒的反应构型所占比例遵循玻尔兹曼分布”这一思想出发，推导溶解速率常数 $k(T)$ 的温度依赖关系，以及在两个温度 $T_1$ 和 $T_2$ 下的比率 $k(T_2)/k(T_1)$。然后，利用该结果，计算在更高的埋藏温度下溶解指定比例钠长石床所需的时间。\n\n假设以下物理上现实且内部一致的条件：\n- 活化能为 $E_a = 35\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 综合了尝试频率和空间因子的指前因子为 $k_0 = 1.0 \\times 10^{-4}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$。\n- 初始温度为 $T_1 = 298\\,\\mathrm{K}$，埋藏温度为 $T_2 = 353\\,\\mathrm{K}$。\n- 钠长石密度为 $\\rho = 2.62 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$，其摩尔质量为 $M = 0.262\\,\\mathrm{kg\\,mol^{-1}}$。\n- 反应床是一个厚度为 $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$ 的平面层，具有宏观平面几何形状，因此反应表面积等于几何面积。\n- 溶解在远离平衡的条件下进行，单位面积的溶解通量等于动力学速率常数 $k(T)$，并且在所关心的时间尺度内与溶解程度无关。\n- 你可以认为普适气体常数为 $R$。\n\n任务：\n1. 从玻尔兹曼分布和活化能垒的概念出发，推导 $k(T)$ 对 $T$ 的函数依赖关系，并用 $E_a$、$R$、$T_1$ 和 $T_2$ 表示比率 $k(T_2)/k(T_1)$ 的封闭形式。\n2. 使用给定参数，计算在 $T_1$ 和 $T_2$ 之间溶解速率的倍数变化。\n3. 确定在 $T_2$ 下溶解钠长石层 $f = 0.30$ 的比例所需的时间，以年为单位表示为一个数字。将你的答案四舍五入到三位有效数字。以年为单位表示最终时间。",
            "solution": "该问题要求基于基本动力学理论，推导并应用反应速率常数的温度依赖性，以计算钠长石溶解的成岩时间尺度。将首先验证其前提，然后按顺序完成三个指定任务来解决该问题。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **原理**：反应事件通过越过摩尔高度为 $E_a$ 的活化能垒而发生。具有足够能量的反应构型所占的比例遵循玻尔兹曼分布。\n- **活化能**：$E_a = 35\\,\\mathrm{kJ\\,mol^{-1}}$\n- **指前因子**：$k_0 = 1.0 \\times 10^{-4}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$\n- **初始温度**：$T_1 = 298\\,\\mathrm{K}$\n- **埋藏温度**：$T_2 = 353\\,\\mathrm{K}$\n- **钠长石密度**：$\\rho = 2.62 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$\n- **钠长石摩尔质量**：$M = 0.262\\,\\mathrm{kg\\,mol^{-1}}$\n- **床层厚度**：$h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$\n- **几何形状**：平面层，反应表面积等于几何面积。\n- **动力学条件**：溶解远离平衡；单位面积通量等于动力学速率常数 $k(T)$。\n- **待溶解比例**：$f = 0.30$\n- **普适气体常数**：$R$\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据。它基于化学动力学的阿伦尼乌斯模型，该模型源于统计力学（特别是玻尔兹曼分布）和活化能垒的概念。这是物理化学和地球化学中一个基本且被普遍接受的原理。所提供的钠长石参数（$E_a$, $\\rho$, $M$）在物理上是现实的，并与地质文献中的实验值一致。这些温度代表了一个合理的埋藏成岩情景。该问题提法得当，提供了所有必要信息、清晰的定义以及一组导向唯一解的逻辑任务。简化假设（平面几何、远离平衡动力学）是为复杂地球化学过程创建易于处理的模型的标准做法，并未削弱该问题的科学基础。问题陈述客观且无歧义。\n\n**第 3 步：结论与行动**\n问题有效。将提供解答。\n\n### 解答\n\n**任务 1：速率常数温度依赖性的推导**\n\n根据问题陈述，化学反应的速率与拥有足够能量以越过摩尔活化能垒 $E_a$ 的分子体系所占的比例成正比。在一个处于绝对温度 $T$ 的热平衡体系中，体系具有能量 $E$ 的概率 $P(E)$ 由玻尔兹曼分布给出，$P(E) \\propto \\exp(-E/k_B T)$，其中 $k_B$ 是玻尔兹曼常数。对于摩尔量，这使用摩尔活化能 $E_a$ 和普适气体常数 $R = N_A k_B$ 来表示，其中 $N_A$ 是阿伏伽德罗常数。能量大于或等于 $E_a$ 的体系所占的比例与项 $\\exp(-E_a/RT)$ 成正比。\n\n因此，溶解速率常数 $k(T)$ 与此概率因子成正比。比例常数，称为指前因子 $k_0$，整合了与反应的尝试频率和空间（取向）因子相关的项。这导出了阿伦尼乌斯方程：\n$$\nk(T) = k_0 \\exp\\left(-\\frac{E_a}{RT}\\right)\n$$\n该方程给出了 $k(T)$ 对 $T$ 的函数依赖关系。\n\n为了求出在两个不同温度 $T_1$ 和 $T_2$ 下速率常数的比率，我们分别写出它们的表达式：\n$$\nk(T_1) = k_0 \\exp\\left(-\\frac{E_a}{RT_1}\\right)\n$$\n$$\nk(T_2) = k_0 \\exp\\left(-\\frac{E_a}{RT_2}\\right)\n$$\n比率 $\\frac{k(T_2)}{k(T_1)}$ 则为：\n$$\n\\frac{k(T_2)}{k(T_1)} = \\frac{k_0 \\exp\\left(-\\frac{E_a}{RT_2}\\right)}{k_0 \\exp\\left(-\\frac{E_a}{RT_1}\\right)} = \\exp\\left(-\\frac{E_a}{RT_2} - \\left(-\\frac{E_a}{RT_1}\\right)\\right)\n$$\n简化指数，我们得到封闭形式的表达式：\n$$\n\\frac{k(T_2)}{k(T_1)} = \\exp\\left(\\frac{E_a}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right)\\right)\n$$\n\n**任务 2：速率倍数变化的计算**\n\n我们现在使用给定的参数计算该比率的数值。我们将使用 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- $E_a = 35\\,\\mathrm{kJ\\,mol^{-1}} = 35000\\,\\mathrm{J\\,mol^{-1}}$\n- $T_1 = 298\\,\\mathrm{K}$\n- $T_2 = 353\\,\\mathrm{K}$\n\n指数为：\n$$\n\\frac{E_a}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right) = \\frac{35000\\,\\mathrm{J\\,mol^{-1}}}{8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}}\\left(\\frac{1}{298\\,\\mathrm{K}} - \\frac{1}{353\\,\\mathrm{K}}\\right)\n$$\n$$\n\\approx 4209.8\\,\\mathrm{K} \\left(0.0033557\\,\\mathrm{K^{-1}} - 0.0028329\\,\\mathrm{K^{-1}}\\right) \\approx 4209.8\\,\\mathrm{K} \\left(0.0005228\\,\\mathrm{K^{-1}}\\right) \\approx 2.201\n$$\n溶解速率的倍数变化为：\n$$\n\\frac{k(T_2)}{k(T_1)} = \\exp(2.201) \\approx 9.03\n$$\n因此，将温度从 $298\\,\\mathrm{K}$ 升高到 $353\\,\\mathrm{K}$，溶解速率大约增加了 $9$ 倍。\n\n**任务 3：溶解时间尺度的确定**\n\n问题陈述，在远离平衡的条件下，溶解通量（单位面积单位时间的摩尔数），记为 $J$，等于速率常数 $k(T)$。在埋藏温度 $T_2$ 下，通量为 $J = k(T_2)$。\n我们必须首先计算 $k(T_2)$：\n$$\nk(T_2) = k_0 \\exp\\left(-\\frac{E_a}{RT_2}\\right) = (1.0 \\times 10^{-4}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}) \\exp\\left(-\\frac{35000\\,\\mathrm{J\\,mol^{-1}}}{8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times 353\\,\\mathrm{K}}\\right)\n$$\n$$\nk(T_2) \\approx (1.0 \\times 10^{-4}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}) \\exp\\left(-\\frac{35000}{2935.0}\\right) \\approx (1.0 \\times 10^{-4}) \\exp(-11.925)\n$$\n$$\nk(T_2) \\approx (1.0 \\times 10^{-4}) \\times (6.623 \\times 10^{-6}) \\approx 6.623 \\times 10^{-10}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}\n$$\n该摩尔通量 $J$ 导致钠长石层后退。后退速率（速度 $v$）可以通过将摩尔通量转换为质量通量（$J_m = J \\times M$），然后除以密度得到速度（$v = J_m / \\rho$）来求得。\n$$\nv = \\frac{J \\times M}{\\rho} = \\frac{k(T_2) M}{\\rho}\n$$\n假设该过程以恒定速率进行。溶解厚度 $\\Delta h$ 所需的总时间 $\\tau$ 由 $\\tau = \\Delta h / v$ 给出。我们要求的是溶解初始厚度 $h$ 的一个分数 $f$ 所需的时间，因此 $\\Delta h = f \\times h$。\n代入 $v$ 的表达式：\n$$\n\\tau = \\frac{\\Delta h}{v} = \\frac{f \\times h}{\\frac{k(T_2) M}{\\rho}} = \\frac{f h \\rho}{k(T_2) M}\n$$\n现在，我们代入数值：\n- $f = 0.30$\n- $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$\n- $\\rho = 2.62 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$\n- $k(T_2) \\approx 6.623 \\times 10^{-10}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$\n- $M = 0.262\\,\\mathrm{kg\\,mol^{-1}}$\n\n$$\n\\tau = \\frac{0.30 \\times (1.0 \\times 10^{-3}\\,\\mathrm{m}) \\times (2.62 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}})}{(6.623 \\times 10^{-10}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}) \\times (0.262\\,\\mathrm{kg\\,mol^{-1}})}\n$$\n$$\n\\tau \\approx \\frac{0.786\\,\\mathrm{kg\\,m^{-2}}}{1.735 \\times 10^{-10}\\,\\mathrm{kg\\,m^{-2}\\,s^{-1}}} \\approx 4.530 \\times 10^{9}\\,\\mathrm{s}\n$$\n问题要求答案以年为单位。一年中的秒数为 $365.25\\,\\mathrm{天/年} \\times 24\\,\\mathrm{小时/天} \\times 3600\\,\\mathrm{秒/小时} = 31,557,600\\,\\mathrm{秒/年}$，或约 $3.156 \\times 10^7\\,\\mathrm{s/year}$。\n$$\n\\tau_{\\text{years}} = \\frac{4.530 \\times 10^{9}\\,\\mathrm{s}}{3.156 \\times 10^{7}\\,\\mathrm{s/year}} \\approx 143.54\\,\\text{years}\n$$\n四舍五入到三位有效数字，所需时间为 $144$ 年。",
            "answer": "$$\n\\boxed{144}\n$$"
        },
        {
            "introduction": "真实的地质系统同时涉及化学反应和物理输运（例如，扩散）。这项高级练习旨在解决反应输运模拟的核心挑战：如何在数值上耦合这两个过程。您将实现并将一个完全耦合解与一种常见的近似方法——斯特朗算子分裂 (Strang operator splitting)——进行比较，以分析产生的数值误差。本练习将为您深入了解驱动现代地球化学模型的数值引擎的准确性和局限性提供关键视角 。",
            "id": "4090171",
            "problem": "考虑一个长度为 $L$ 的一维闭合多孔柱，其中充满了包含溶解钙离子 ($\\mathrm{Ca^{2+}}$) 和碳酸根离子 ($\\mathrm{CO_3^{2-}}$) 的水溶液，其浓度分别用 $A(x,t)$ 和 $B(x,t)$ 表示，单位为 $\\mathrm{mol/m^3}$。固体沉淀物（方解石）的浓度用 $S(x,t)$ 表示，单位为 $\\mathrm{mol/m^3}$。该系统由质量守恒、菲克扩散以及遵循质量作用定律的沉淀反应所控制。基本依据如下：\n- 质量守恒：对于每种物质，其变化率等于输运和反应贡献之和。\n- 菲克扩散定律：扩散通量与空间梯度成正比，从而根据菲克第二定律在平衡方程中产生扩散项。\n- 质量作用动力学定律：沉淀速率与离子活度积偏离阈值的程度成正比，此处使用浓度进行理想化处理。\n\n设 $D$ 为 $A$ 和 $B$ 的分子扩散系数（假定相等），$k$ 为沉淀速率常数，$K$ 为有效平衡参数（单位为 $\\mathrm{(mol/m^3)^2}$）。沉淀反应 $A + B \\rightarrow S$ 仅在 $A B - K \\ge 0$ 时发生，否则为零。在两端（$x=0$ 和 $x=L$）施加齐次诺伊曼（零通量）边界条件（$\\partial A/\\partial x = \\partial B/\\partial x = 0$），耦合的偏微分方程（PDE）组为\n$$\n\\frac{\\partial A}{\\partial t} = D \\frac{\\partial^2 A}{\\partial x^2} - r(A,B),\\quad\n\\frac{\\partial B}{\\partial t} = D \\frac{\\partial^2 B}{\\partial x^2} - r(A,B),\\quad\n\\frac{\\partial S}{\\partial t} = r(A,B),\n$$\n其中\n$$\nr(A,B) = k \\,\\max\\!\\big(A B - K,\\,0\\big).\n$$\n使用 $N$ 个均匀间隔的点（间距 $\\Delta x = L/(N-1)$）对空间域 $[0,L]$ 进行离散化，并利用标准的二阶有限差分来强制施加诺伊曼边界条件。由此得到一个有限维常微分方程（ODE）组\n$$\n\\frac{d\\mathbf{A}}{dt} = D \\mathbf{L}\\,\\mathbf{A} - \\mathbf{r}(\\mathbf{A},\\mathbf{B}),\\quad\n\\frac{d\\mathbf{B}}{dt} = D \\mathbf{L}\\,\\mathbf{B} - \\mathbf{r}(\\mathbf{A},\\mathbf{B}),\\quad\n\\frac{d\\mathbf{S}}{dt} = \\mathbf{r}(\\mathbf{A},\\mathbf{B}),\n$$\n其中 $\\mathbf{A}, \\mathbf{B}, \\mathbf{S} \\in \\mathbb{R}^N$，$\\mathbf{L} \\in \\mathbb{R}^{N\\times N}$ 是带有齐次诺伊曼边界条件的离散拉普拉斯算子，且\n$$\n\\mathbf{r}(\\mathbf{A},\\mathbf{B}) = k \\,\\max\\!\\big(\\mathbf{A}\\odot\\mathbf{B} - K\\mathbf{1},\\,\\mathbf{0}\\big),\n$$\n其中 $\\odot$ 表示逐元素乘法。\n\n您必须将 Strang 算子分裂解与一个全耦合参考解进行比较，以分析分裂误差及其随时间步长的标度关系。对于该系统，在时间步长 $\\Delta t$ 内的 Strang 分裂中，演化算子由以下部分组成：半步扩散、全步反应（空间局部）和半步扩散。全耦合参考解是通过在区间 $[0,T]$ 上高精度求解完整（无分裂）的常微分方程组得到的。\n\n根据上述基本依据，推导一个算法来计算两种解，并量化分裂误差，该误差定义为最终时间 $T$ 时水相物质浓度的均方根差：\n$$\n\\varepsilon(\\Delta t) = \\left( \\frac{1}{N} \\sum_{i=1}^{N} \\left[ \\big(A_i^{\\mathrm{split}}(T)-A_i^{\\mathrm{full}}(T)\\big)^2 + \\big(B_i^{\\mathrm{split}}(T)-B_i^{\\mathrm{full}}(T)\\big)^2 \\right] \\right)^{1/2}.\n$$\n假设使用以下符合物理实际的参数和初始条件：\n- 柱长 $L = 2.0\\times 10^{-2}\\,\\mathrm{m}$。\n- 空间点数 $N = 25$。\n- 扩散系数 $D = 1.0\\times 10^{-9}\\,\\mathrm{m^2/s}$。\n- 沉淀速率常数 $k = 5.0\\times 10^{-3}\\,\\mathrm{m^3/(mol\\cdot s)}$。\n- 有效平衡参数 $K = 1.0\\times 10^{-6}\\,\\mathrm{(mol/m^3)^2}$。\n- 最终时间 $T = 3.6\\times 10^{3}\\,\\mathrm{s}$。\n- 初始条件：对于 $x_j = j\\Delta x$, $j=0,\\dots,N-1$，\n$$\nA(x_j,0) = A_0 + A_{\\mathrm{amp}} \\cos\\!\\left(\\frac{\\pi x_j}{L}\\right),\\quad B(x_j,0) = B_0 + B_{\\mathrm{amp}} \\cos\\!\\left(\\frac{\\pi x_j}{L}\\right),\\quad S(x_j,0) = 0,\n$$\n其中 $A_0 = 5.0\\times 10^{-3}\\,\\mathrm{mol/m^3}$, $A_{\\mathrm{amp}} = 2.0\\times 10^{-3}\\,\\mathrm{mol/m^3}$, $B_0 = 4.0\\times 10^{-3}\\,\\mathrm{mol/m^3}$, 且 $B_{\\mathrm{amp}} = 1.0\\times 10^{-3}\\,\\mathrm{mol/m^3}$。\n\n实现 Strang 分裂时，使用 $D\\mathbf{L}$ 的矩阵指数来应用扩散半步，并通过积分每个网格点上的局部反应常微分方程来执行反应步骤。实现全耦合解时，通过在 $[0,T]$ 上高精度积分整个半离散常微分方程组来完成。两种方法使用相同的空间离散化方案。在 $t=T$ 时量化分裂误差 $\\varepsilon(\\Delta t)$。\n\n测试套件：\n- 三个不同的时间步长 $\\Delta t$ 来探究误差标度关系：\n    1. $\\Delta t = 1.2\\times 10^{3}\\,\\mathrm{s}$ (粗略)。\n    2. $\\Delta t = 6.0\\times 10^{2}\\,\\mathrm{s}$ (中等)。\n    3. $\\Delta t = 3.0\\times 10^{2}\\,\\mathrm{s}$ (精细)。\n每个 $\\Delta t$ 都能整除 $T$，因此 Strang 分裂的步数是整数。对于每种情况，计算并报告 $\\varepsilon(\\Delta t)$。\n\n答案规格：\n- 将报告的每个误差 $\\varepsilon(\\Delta t)$ 以 $\\mathrm{mol/m^3}$ 为单位，表示为十进制数。\n- 您的程序应生成单行输出，其中包含三个结果，格式为方括号内用逗号分隔的列表，例如 `[e1,e2,e3]`。",
            "solution": "该问题要求实现并比较两种数值方法，用于求解一个模拟多孔介质中方解石沉淀的一维反应扩散偏微分方程（PDE）组。目标是对于一组给定的时间步长，量化 Strang 算子分裂方案相对于高精度全耦合参考解的误差。\n\n水相物质 $A(x,t)$ 和 $B(x,t)$ 以及固体沉淀物 $S(x,t)$ 浓度的控制偏微分方程组为：\n$$\n\\frac{\\partial A}{\\partial t} = D \\frac{\\partial^2 A}{\\partial x^2} - r(A,B)\n$$\n$$\n\\frac{\\partial B}{\\partial t} = D \\frac{\\partial^2 B}{\\partial x^2} - r(A,B)\n$$\n$$\n\\frac{\\partial S}{\\partial t} = r(A,B)\n$$\n其中非线性反应项为 $r(A,B) = k \\,\\max\\!\\big(A B - K,\\,0\\big)$。该系统定义在空间域 $x \\in [0, L]$ 上，并带有零通量（齐次诺伊曼）边界条件。\n\n推导数值解的第一步是使用线方法对空间域进行离散化。将域 $[0,L]$ 划分为 $N$ 个均匀间隔的网格点 $x_i = i \\Delta x$（$i=0, 1, \\dots, N-1$），其中 $\\Delta x = L/(N-1)$。这些点上的浓度由向量 $\\mathbf{A}(t)$、$\\mathbf{B}(t)$ 和 $\\mathbf{S}(t)$ 表示，每个向量的大小均为 $N$。\n\n二阶空间导数算子 $\\frac{\\partial^2}{\\partial x^2}$ 通过有限差分矩阵算子 $\\mathbf{L}$ 进行近似。对于齐次诺伊曼边界条件 $\\frac{\\partial u}{\\partial x} = 0$，可以使用虚拟点（ghost points）推导出一个二阶精度的离散化格式。在内部节点 $i \\in \\{1, \\dots, N-2\\}$，使用标准的中心差分：\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{\\Delta x^2}\n$$\n在左边界 $i=0$，诺伊曼条件通过交错网格上的中心差分进行近似，$\\frac{u_1 - u_{-1}}{2\\Delta x} = 0$，这意味着虚拟点的值 $u_{-1} = u_1$。将其代入中心差分公式可得：\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_0 \\approx \\frac{u_{-1} - 2u_0 + u_1}{\\Delta x^2} = \\frac{2u_1 - 2u_0}{\\Delta x^2}\n$$\n类似地，在右边界 $i=N-1$，虚拟点的值为 $u_N = u_{N-2}$，可得：\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_{N-1} \\approx \\frac{u_{N-2} - 2u_{N-1} + u_N}{\\Delta x^2} = \\frac{2u_{N-2} - 2u_{N-1}}{\\Delta x^2}\n$$\n这些近似定义了 $N \\times N$ 的离散拉普拉斯矩阵 $\\mathbf{L}$：\n$$\n\\mathbf{L} = \\frac{1}{\\Delta x^2} \\begin{pmatrix}\n-2  2  0  \\cdots  0  0 \\\\\n1  -2  1  \\cdots  0  0 \\\\\n0  1  -2  1  \\cdots  0 \\\\\n\\vdots   \\ddots  \\ddots  \\ddots  \\vdots \\\\\n0  0  \\cdots  1  -2  1 \\\\\n0  0  \\cdots  0  2  -2\n\\end{pmatrix}\n$$\n这种半离散化方法将偏微分方程组转换为一个大型的耦合常微分方程（ODE）组：\n$$\n\\frac{d\\mathbf{y}}{dt} = f(t, \\mathbf{y}) =\n\\begin{pmatrix}\nD \\mathbf{L}\\,\\mathbf{A} - \\mathbf{r}(\\mathbf{A},\\mathbf{B}) \\\\\nD \\mathbf{L}\\,\\mathbf{B} - \\mathbf{r}(\\mathbf{A},\\mathbf{B}) \\\\\n\\mathbf{r}(\\mathbf{A},\\mathbf{B})\n\\end{pmatrix}\n$$\n其中状态向量为 $\\mathbf{y}(t) = [\\mathbf{A}(t)^T, \\mathbf{B}(t)^T, \\mathbf{S}(t)^T]^T \\in \\mathbb{R}^{3N}$，反应向量为 $\\mathbf{r}(\\mathbf{A},\\mathbf{B}) = k \\,\\max\\!\\big(\\mathbf{A}\\odot\\mathbf{B} - K\\mathbf{1},\\,\\mathbf{0}\\big)$，其中 $\\odot$ 为逐元素乘法。\n\n**全耦合参考解**\n参考解 $\\mathbf{y}_{\\mathrm{full}}(T)$ 是通过从 $t=0$ 到 $t=T$ 积分完整的（无任何算子分裂的）常微分方程组得到的。鉴于反应扩散问题通常是刚性的（由于反应和扩散之间的时间尺度差异很大），需要一个适用于刚性系统的高精度、自适应时间步长的积分器。`scipy.integrate.solve_ivp` 函数配合 `LSODA` 方法以及严格的相对和绝对容差（例如 $10^{-8}$ 或更低）是一个合适的选择。实现右手侧函数 `f(t, y)` 以计算完整的更新，同时包括扩散项和反应项。\n\n**Strang 算子分裂解**\n算子分裂法通过将复杂系统分解为更简单的子问题来求解。常微分方程组 $\\frac{d\\mathbf{y}}{dt} = (\\mathcal{D} + \\mathcal{R})\\mathbf{y}$ 被分裂为一个线性扩散部分 $\\mathcal{D}$ 和一个非线性反应部分 $\\mathcal{R}$。\n$$\n\\mathcal{D}(\\mathbf{y}) = \\begin{pmatrix} D\\mathbf{L}\\mathbf{A} \\\\ D\\mathbf{L}\\mathbf{B} \\\\ \\mathbf{0} \\end{pmatrix}, \\quad\n\\mathcal{R}(\\mathbf{y}) = \\begin{pmatrix} -\\mathbf{r}(\\mathbf{A},\\mathbf{B}) \\\\ -\\mathbf{r}(\\mathbf{A},\\mathbf{B}) \\\\ \\mathbf{r}(\\mathbf{A},\\mathbf{B}) \\end{pmatrix}\n$$\nStrang 分裂是一种二阶精度方法，它通过对称地组合子问题的解来近似时间步长 $\\Delta t$ 上的解算子：\n$$\n\\mathbf{y}(t+\\Delta t) \\approx e^{\\frac{\\Delta t}{2}\\mathcal{D}} e^{\\Delta t \\mathcal{R}} e^{\\frac{\\Delta t}{2}\\mathcal{D}} \\mathbf{y}(t)\n$$\n从 $t=0$到 $T$ 的每个时间步，算法按以下步骤进行：\n1. **扩散半步**：在 $\\Delta t/2$ 的时间段内求解 $\\frac{d\\mathbf{y}}{dt} = \\mathcal{D}(\\mathbf{y})$。这涉及求解线性系统 $\\frac{d\\mathbf{A}}{dt} = D\\mathbf{L}\\mathbf{A}$ 和 $\\frac{d\\mathbf{B}}{dt} = D\\mathbf{L}\\mathbf{B}$。其精确解由矩阵指数给出：\n$$\n\\mathbf{A}(t+\\tau) = e^{\\tau D \\mathbf{L}} \\mathbf{A}(t), \\quad \\mathbf{B}(t+\\tau) = e^{\\tau D \\mathbf{L}} \\mathbf{B}(t)\n$$\n此处，$\\tau = \\Delta t/2$。矩阵指数算子 $M_D = e^{\\frac{\\Delta t}{2} D\\mathbf{L}}$ 使用 `scipy.linalg.expm` 预先计算，该步骤通过矩阵-向量乘法执行。固体浓度 $\\mathbf{S}$ 不受扩散影响。\n2. **反应全步**：在 $\\Delta t$ 的时间段内求解 $\\frac{d\\mathbf{y}}{dt} = \\mathcal{R}(\\mathbf{y})$。这可以分解为 $N$ 个独立的、由 3 个常微分方程组成的系统，每个网格点 $i$ 对应一个系统：\n$$\n\\frac{dA_i}{dt} = -k \\max(A_i B_i - K, 0)\n$$\n$$\n\\frac{dB_i}{dt} = -k \\max(A_i B_i - K, 0)\n$$\n$$\n\\frac{dS_i}{dt} = k \\max(A_i B_i - K, 0)\n$$\n对于每个网格点 $i$，这些小的、可能是刚性的非线性常微分方程组在区间 $[0, \\Delta t]$ 上进行数值积分。同样，使用 `solve_ivp` 来确保该子问题的解既准确又稳定。\n3. **扩散半步**：重复步骤 (1) 的扩散步骤，将相同的算子 $M_D$ 应用于反应步骤后得到的状态向量。\n\n**误差量化**\n在计算出全耦合解的最终状态向量 $(\\mathbf{A}^{\\mathrm{full}}(T), \\mathbf{B}^{\\mathrm{full}}(T))$ 和给定 $\\Delta t$ 的分裂解的最终状态向量 $(\\mathbf{A}^{\\mathrm{split}}(T), \\mathbf{B}^{\\mathrm{split}}(T))$ 后，分裂误差 $\\varepsilon(\\Delta t)$ 计算为水相物质的均方根差：\n$$\n\\varepsilon(\\Delta t) = \\left( \\frac{1}{N} \\sum_{i=0}^{N-1} \\left[ \\big(A_i^{\\mathrm{split}}(T)-A_i^{\\mathrm{full}}(T)\\big)^2 + \\big(B_i^{\\mathrm{split}}(T)-B_i^{\\mathrm{full}}(T)\\big)^2 \\right] \\right)^{1/2}\n$$\n对测试套件中的每个时间步长 $\\Delta t$ 重复此过程，以分析误差对步长的依赖关系，对于 Strang 分裂，该关系预期为二阶（$O(\\Delta t^2)$）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.linalg import expm\n\ndef setup_laplacian(N, dx):\n    \"\"\"\n    Constructs the 1D finite difference Laplacian matrix for homogeneous\n    Neumann boundary conditions using the ghost point method.\n    \"\"\"\n    L = np.zeros((N, N))\n    dx2_inv = 1.0 / (dx**2)\n    \n    # Interior points\n    for i in range(1, N - 1):\n        L[i, i - 1] = 1.0\n        L[i, i]     = -2.0\n        L[i, i + 1] = 1.0\n        \n    # Boundary points (Neumann)\n    L[0, 0] = -2.0\n    L[0, 1] = 2.0\n    L[N - 1, N - 2] = 2.0\n    L[N - 1, N - 1] = -2.0\n    \n    return L * dx2_inv\n\ndef reaction_rate(A, B, k, K):\n    \"\"\"Computes the reaction rate vector.\"\"\"\n    ion_product = A * B\n    return k * np.maximum(ion_product - K, 0)\n\ndef full_system_rhs(t, y, N, D, k, K, L_matrix):\n    \"\"\"\n    RHS function for the fully coupled ODE system.\n    \"\"\"\n    A = y[0:N]\n    B = y[N:2*N]\n    # S = y[2*N:3*N] # S is implicitly handled by the solver.\n    \n    r = reaction_rate(A, B, k, K)\n    \n    dA_dt = D * (L_matrix @ A) - r\n    dB_dt = D * (L_matrix @ B) - r\n    dS_dt = r\n    \n    return np.concatenate((dA_dt, dB_dt, dS_dt))\n\ndef local_reaction_rhs(t, y_local, k, K):\n    \"\"\"\n    RHS function for the local reaction ODE at a single grid point.\n    \"\"\"\n    A_i, B_i, S_i = y_local\n    r_i = k * max(A_i * B_i - K, 0.0)\n    \n    dA_dt_i = -r_i\n    dB_dt_i = -r_i\n    dS_dt_i = r_i\n    \n    return [dA_dt_i, dB_dt_i, dS_dt_i]\n\ndef solve():\n    \"\"\"\n    Main function to set up, solve, and evaluate the problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        1.2e3,  # Timestep 1\n        6.0e2,  # Timestep 2\n        3.0e2   # Timestep 3\n    ]\n    \n    # Physical and numerical parameters\n    L = 2.0e-2       # m\n    N = 25           # number of points\n    D = 1.0e-9       # m^2/s\n    k = 5.0e-3       # m^3/(mol*s)\n    K = 1.0e-6       # (mol/m^3)^2\n    T = 3.6e3        # s\n    \n    # Initial condition parameters\n    A0 = 5.0e-3      # mol/m^3\n    A_amp = 2.0e-3   # mol/m^3\n    B0 = 4.0e-3      # mol/m^3\n    B_amp = 1.0e-3   # mol/m^3\n    \n    # Spatial discretization\n    dx = L / (N - 1)\n    x_grid = np.linspace(0, L, N)\n    \n    # Initial conditions\n    A_init = A0 + A_amp * np.cos(np.pi * x_grid / L)\n    B_init = B0 + B_amp * np.cos(np.pi * x_grid / L)\n    S_init = np.zeros(N)\n    \n    y0 = np.concatenate((A_init, B_init, S_init))\n    \n    # Construct Laplacian matrix\n    L_matrix = setup_laplacian(N, dx)\n    \n    # 1. Compute high-accuracy fully coupled reference solution\n    ref_sol = solve_ivp(\n        full_system_rhs,\n        [0, T],\n        y0,\n        method='LSODA',\n        args=(N, D, k, K, L_matrix),\n        rtol=1e-8,\n        atol=1e-10\n    )\n    y_full_T = ref_sol.y[:, -1]\n    A_full_T = y_full_T[0:N]\n    B_full_T = y_full_T[N:2*N]\n    \n    results = []\n    \n    # 2. Compute Strang splitting solution for each timestep and find error\n    for dt in test_cases:\n        A_split = A_init.copy()\n        B_split = B_init.copy()\n        S_split = S_init.copy()\n        \n        num_steps = int(round(T / dt))\n        \n        # Pre-compute matrix exponential for diffusion half-step\n        M_D_half = expm(0.5 * dt * D * L_matrix)\n        \n        # Main time-stepping loop for Strang splitting\n        for _ in range(num_steps):\n            # First diffusion half-step\n            A_split = M_D_half @ A_split\n            B_split = M_D_half @ B_split\n            \n            # Full reaction step (point-wise)\n            for i in range(N):\n                y_local_0 = [A_split[i], B_split[i], S_split[i]]\n                sol_local = solve_ivp(\n                    local_reaction_rhs,\n                    [0, dt],\n                    y_local_0,\n                    method='LSODA',\n                    args=(k, K),\n                    rtol=1e-8,\n                    atol=1e-10\n                )\n                A_split[i], B_split[i], S_split[i] = sol_local.y[:, -1]\n                \n            # Second diffusion half-step\n            A_split = M_D_half @ A_split\n            B_split = M_D_half @ B_split\n        \n        # Final state from splitting\n        A_split_T = A_split\n        B_split_T = B_split\n        \n        # Calculate RMS error against the reference solution\n        error_sq_sum = np.sum((A_split_T - A_full_T)**2) + np.sum((B_split_T - B_full_T)**2)\n        rms_error = np.sqrt(error_sq_sum / N)\n        results.append(rms_error)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}