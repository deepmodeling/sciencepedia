{
    "hands_on_practices": [
        {
            "introduction": "准确的地球化学模拟始于对含水层化学状态的精确描述。注入二氧化碳会形成碳酸，从而深刻改变地下盐水的化学性质，而计算由此产生的 pH 值是任何后续反应模拟的基石。本练习  将指导您从电中性原理出发，推导并求解碳酸盐体系中 pH 值的核心方程，这是所有反应输运模型研究者都必须掌握的基础技能。",
            "id": "4085884",
            "problem": "考虑一个封闭的水体系，该体系代表了温度为 $25\\,^{\\circ}\\mathrm{C}$ 的氯化钠 (Na–Cl) 盐水，与二氧化碳 ($\\mathrm{CO}_2$) 地质封存建模相关。在该体系中，无机碳仅以碳酸盐系统物种 $\\mathrm{H_2CO_3^*}$（其中星号表示溶解的分子二氧化碳和真实碳酸的总和）、$\\mathrm{HCO_3^-}$ 和 $\\mathrm{CO_3^{2-}}$ 的形式存在，并且水的自递质子反应产生 $\\mathrm{H^+}$ 和 $\\mathrm{OH^-}$。假设钠和氯化物源自强电解质，不参与酸碱反应。将平衡常数视为在指定离子强度下的条件浓度平衡常数，并忽略显式的活度系数校正。定义以下量：\n\n- $C_T$: 总无机碳，$C_T = [\\mathrm{H_2CO_3^*}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$，单位为摩尔/升。\n- $Alk$: 总碱度，定义为 $Alk = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]$，单位为摩尔/升。\n- $K_1$: 碳酸的一级解离常数，对应反应 $\\mathrm{H_2CO_3^*} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HCO_3^-}$，单位为摩尔/升。\n- $K_2$: 碳酸的二级解离常数，对应反应 $\\mathrm{HCO_3^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{CO_3^{2-}}$，单位为摩尔/升。\n- $K_w$: 水的自递质子常数，$K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$，单位为 (摩尔/升)²。\n- $\\mathrm{pH}$: 氢离子浓度指数 (pH)，定义为 $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$。\n\n从电中性原理（正电荷总和等于负电荷总和）出发，推导当只有碳酸盐系统和水对酸碱平衡有贡献时，Na-Cl 盐水的电荷平衡关系式。证明这将导出一个关于 $[\\mathrm{H^+}]$ 的单一非线性方程，在给定 $C_T$、$Alk$、$K_1$ 和 $K_2$ 以及 $K_w$ 的条件下，该方程可以通过计算求解 $\\mathrm{pH}$。\n\n使用以下核心定义和定律：\n- 碳酸盐系统的质量作用定律，忽略活度校正：$K_1 = \\dfrac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{[\\mathrm{H_2CO_3^*}]}$ 和 $K_2 = \\dfrac{[\\mathrm{H^+}][\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$。\n- 总无机碳守恒：$C_T = [\\mathrm{H_2CO_3^*}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$。\n- 水的自递质子反应：$K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$。\n- 总碱度定义：$Alk = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]$。\n- 电中性：$\\displaystyle \\sum_i z_i[\\mathrm{X_i}] = 0$，其中 $z_i$ 是离子电荷。\n\n用物种 $\\mathrm{Na^+}$、$\\mathrm{H^+}$、$\\mathrm{Cl^-}$、$\\mathrm{HCO_3^-}$、$\\mathrm{CO_3^{2-}}$ 和 $\\mathrm{OH^-}$ 推导该体系的电荷平衡，然后使用上述关系式消去未知数，以获得一个关于 $[\\mathrm{H^+}]$ 且适用于数值求根的单一方程。\n\n你的任务是实现一个程序，对下述测试套件中的每个测试用例，根据给定参数计算 $\\mathrm{pH}$。所有输入 $C_T$、$Alk$、$K_1$ 和 $K_2$ 的单位必须解释为摩尔/升，$K_w$ 的单位为 (摩尔/升)²。将最终的 $\\mathrm{pH}$ 值表示为四舍五入到六位小数的无量纲浮点数。\n\n测试套件和参数值（每个元组为 $(C_T, Alk, K_1, K_2, K_w)$，单位如上所述）：\n- 案例 $1$（一般碱性情况）：$(2.0\\times 10^{-3}, 2.0\\times 10^{-3}, 10^{-6.30}, 10^{-10.33}, 10^{-14})$。\n- 案例 $2$（中等碳含量，零碱度）：$(2.0\\times 10^{-3}, 0.0, 10^{-6.30}, 10^{-10.33}, 10^{-14})$。\n- 案例 $3$（接近纯水的碳含量，零碱度）：$(1.0\\times 10^{-6}, 0.0, 10^{-6.30}, 10^{-10.33}, 10^{-14})$。\n- 案例 $4$（高碳含量，负碱度）：$(1.0\\times 10^{-2}, -1.0\\times 10^{-3}, 10^{-6.30}, 10^{-10.33}, 10^{-14})$。\n- 案例 $5$（纯水极限）：$(0.0, 0.0, 10^{-6.30}, 10^{-10.33}, 10^{-14})$。\n\n你的程序应该产生单行输出，其中包含一个用方括号括起来并以逗号分隔的结果列表（例如，$[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3}]$），其中每个结果是对应测试用例计算出的 $\\mathrm{pH}$，并四舍五入到六位小数。",
            "solution": "该问题要求推导一个用于描述碳酸盐水体系 $\\mathrm{pH}$ 的控制方程，并对其进行数值求解。该体系由其总无机碳 $C_T$、总碱度 $Alk$ 以及相关的平衡常数 $K_1$、$K_2$ 和 $K_w$ 定义。这是水文地球化学中的一个标准问题。\n\n我们的推导始于电中性基本原理，该原理规定正电荷的总浓度必须等于负电荷的总浓度。在所述的氯化钠盐水中存在的离子物种为 $\\mathrm{Na^+}$、$\\mathrm{H^+}$、$\\mathrm{Cl^-}$、$\\mathrm{HCO_3^-}$、$\\mathrm{CO_3^{2-}}$ 和 $\\mathrm{OH^-}$。因此电荷平衡方程为：\n$$\n[\\mathrm{Na^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}]\n$$\n重排该方程，将不参与质子交换反应的保守离子（$\\mathrm{Na^+}$ 和 $\\mathrm{Cl^-}$）归到一边，得到：\n$$\n[\\mathrm{Na^+}] - [\\mathrm{Cl^-}] = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]\n$$\n问题中给出了总碱度 $Alk$ 的定义：\n$$\nAlk = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]\n$$\n通过比较这两个方程，我们可以看出 $Alk = [\\mathrm{Na^+}] - [\\mathrm{Cl^-}]$。这表明，给定的碱度是一个保守量，代表由强电解质引起的电荷不平衡。因此，问题就变为对于一个由已知的、固定的 $Alk$ 和 $C_T$ 值所指定的系统，求解氢离子的平衡浓度 $[\\mathrm{H^+}]$。\n\n下一步是将碱度定义中的所有浓度项表示为单一变量 $[\\mathrm{H^+}]$ 和给定常数的函数。设 $h = [\\mathrm{H^+}]$。\n根据水的自递质子反应，我们有 $[\\mathrm{OH^-}] = K_w / h$。\n\n碳酸盐物种的浓度（$[\\mathrm{H_2CO_3^*}]$、$[\\mathrm{HCO_3^-}]$、$[\\mathrm{CO_3^{2-}}]$）可以使用平衡常数定义与 $C_T$ 和 $h$ 关联起来：\n$K_1 = \\dfrac{h[\\mathrm{HCO_3^-}]}{[\\mathrm{H_2CO_3^*}]}$ 和 $K_2 = \\dfrac{h[\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$。\n由此，我们可以写出：\n$[\\mathrm{H_2CO_3^*}] = \\dfrac{h[\\mathrm{HCO_3^-}]}{K_1}$ 和 $[\\mathrm{CO_3^{2-}}] = \\dfrac{K_2[\\mathrm{HCO_3^-}]}{h}$。\n将这些代入总无机碳的定义 $C_T = [\\mathrm{H_2CO_3^*}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$，得到：\n$$\nC_T = \\frac{h[\\mathrm{HCO_3^-}]}{K_1} + [\\mathrm{HCO_3^-}] + \\frac{K_2[\\mathrm{HCO_3^-}]}{h} = [\\mathrm{HCO_3^-}]\\left(\\frac{h}{K_1} + 1 + \\frac{K_2}{h}\\right)\n$$\n这使我们能够将各个碳酸盐物种的浓度表示为 $C_T$ 的分数。这些分数记为 $\\alpha_i$，它们仅是 $h$ 的函数：\n$$\n[\\mathrm{H_2CO_3^*}] = C_T \\alpha_0(h) \\quad \\text{其中} \\quad \\alpha_0(h) = \\frac{h^2}{h^2 + K_1 h + K_1 K_2}\n$$\n$$\n[\\mathrm{HCO_3^-}] = C_T \\alpha_1(h) \\quad \\text{其中} \\quad \\alpha_1(h) = \\frac{K_1 h}{h^2 + K_1 h + K_1 K_2}\n$$\n$$\n[\\mathrm{CO_3^{2-}}] = C_T \\alpha_2(h) \\quad \\text{其中} \\quad \\alpha_2(h) = \\frac{K_1 K_2}{h^2 + K_1 h + K_1 K_2}\n$$\n现在，我们将 $[\\mathrm{HCO_3^-}]$、$[\\mathrm{CO_3^{2-}}]$ 和 $[\\mathrm{OH^-}]$ 的表达式代入碱度定义中：\n$$\nAlk = C_T \\alpha_1(h) + 2C_T \\alpha_2(h) + \\frac{K_w}{h} - h\n$$\n代入 $\\alpha_1(h)$ 和 $\\alpha_2(h)$ 的完整表达式：\n$$\nAlk = C_T \\left( \\frac{K_1 h}{h^2 + K_1 h + K_1 K_2} \\right) + 2C_T \\left( \\frac{K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) + \\frac{K_w}{h} - h\n$$\n这可以合并成一个单一的表达式：\n$$\nAlk = C_T \\left( \\frac{K_1 h + 2 K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) + \\frac{K_w}{h} - h\n$$\n这就是所求的关于未知数 $h = [\\mathrm{H^+}]$ 的单一非线性方程。为了数值求解 $h$，我们定义一个函数 $f(h)$ 并求其根：\n$$\nf(h) = C_T \\left( \\frac{K_1 h + 2 K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) + \\frac{K_w}{h} - h - Alk = 0\n$$\n对于具有物理意义的（正）浓度，此函数是良态的。它关于 $h$ 的导数恒为负，意味着 $f(h)$ 是单调递减的。这保证了 $h$ 存在唯一的正根。\n\n算法设计是实现一种数值求根方法。二分法或 Brent 方法适用于此目的，因为它们对于单调函数是稳健的。我们可以为 $h$ 建立一个搜索区间 $[a, b]$，其中 $f(a) > 0$ 且 $f(b)  0$。一个化学上合理的 $[\\mathrm{H^+}]$ 范围跨越了从强酸性到强碱性的条件，因此像 $[10^{-15}, 1.0]$ 摩尔/升这样的区间应该能安全地包含所有测试用例的根。`scipy.optimize.brentq` 函数是完成此任务的合适工具。\n\n一旦确定了根 $h_{root}$，就用其定义计算 $\\mathrm{pH}$：\n$$\n\\mathrm{pH} = -\\log_{10}(h_{root})\n$$\n然后按要求将该值四舍五入到六位小数。将此过程应用于每个测试用例以获得最终结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for pH in an aqueous carbonate system for a given set of parameters.\n\n    The problem is defined by the total inorganic carbon (Ct), total alkalinity (Alk),\n    and the equilibrium constants K1, K2, and Kw. The solution involves finding the\n    root of a nonlinear equation for the hydrogen ion concentration [H+].\n    \"\"\"\n    \n    # Test suite: (C_T, Alk, K1, K2, Kw)\n    # C_T and Alk in mol/L\n    # K1 and K2 in mol/L\n    # Kw in (mol/L)^2\n    test_cases = [\n        (2.0e-3, 2.0e-3, 10**-6.30, 10**-10.33, 10**-14.0), # Case 1\n        (2.0e-3, 0.0,    10**-6.30, 10**-10.33, 10**-14.0), # Case 2\n        (1.0e-6, 0.0,    10**-6.30, 10**-10.33, 10**-14.0), # Case 3\n        (1.0e-2, -1.0e-3, 10**-6.30, 10**-10.33, 10**-14.0),# Case 4\n        (0.0,    0.0,    10**-6.30, 10**-10.33, 10**-14.0), # Case 5\n    ]\n\n    results = []\n    \n    for i, case in enumerate(test_cases):\n        Ct, Alk, K1, K2, Kw = case\n        \n        # Special case: C_T = 0.\n        # The governing equation simplifies to h^2 + Alk*h - Kw = 0.\n        # This avoids numerical issues with the general form when Ct=0.\n        if Ct == 0.0:\n            # Using the quadratic formula for ax^2 + bx + c = 0\n            # a=1, b=Alk, c=-Kw\n            # We must take the positive root for h.\n            h_root = (-Alk + np.sqrt(Alk**2 + 4 * Kw)) / 2.0\n        else:\n            # General case: define the function f(h) whose root we need to find.\n            # f(h) = Ct * (alpha1 + 2*alpha2) + [OH-] - [H+] - Alk = 0\n            # Let h = [H+].\n            def f(h):\n                if h = 0:\n                    return np.inf  # Prevent division by zero and non-physical values.\n                \n                # Denominator for alpha fractions\n                denom = h**2 + K1 * h + K1 * K2\n                \n                # Carbonate alkalinity term: Ct * (alpha1 + 2*alpha2)\n                carb_alk_term = Ct * (K1 * h + 2 * K1 * K2) / denom\n                \n                # Water contribution to alkalinity: [OH-] - [H+]\n                water_alk_term = Kw / h - h\n                \n                return carb_alk_term + water_alk_term - Alk\n\n            # Use Brent's method to find the root. It is robust and efficient.\n            # The bracket [1e-15, 1.0] corresponds to pH range ~15 down to 0, which\n            # is a safe and comprehensive range for these geochemical systems.\n            try:\n                h_root = optimize.brentq(f, 1e-15, 1.0)\n            except ValueError:\n                # In case the root is not bracketed, which is highly unlikely for\n                # this function. Extend the search bracket for extreme cases.\n                try:\n                    h_root = optimize.brentq(f, 1e-16, 10.0)\n                except Exception as e:\n                    # Provide a diagnostic for failure\n                    print(f\"Failed to find root for case {i+1}: {e}\")\n                    results.append(np.nan)\n                    continue\n\n        # Calculate pH from the hydrogen ion concentration\n        ph = -np.log10(h_root)\n        \n        # Append the rounded result\n        results.append(round(ph, 6))\n\n    # Format the final output string as per requirements.\n    # The map(str,...) converts each float result to its string representation.\n    # The ','.join(...) concatenates them with commas.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在典型的储层条件下，二氧化碳是以超临界流体的形式存在的，其行为与理想气体相去甚远。它的化学势，即逸度，决定了其在盐水中的溶解能力，这是实现二氧化碳地质封存的关键过程。本练习  提供了通过编程实现 Peng-Robinson 状态方程来计算这一关键属性的动手实践，从而将热力学理论与储层模拟实践联系起来。",
            "id": "4085881",
            "problem": "您需要实现一个程序，使用Peng–Robinson状态方程（EOS）计算二氧化碳的逸度系数和逸度，并将其与理想气体逸度进行比较。该问题的背景是在计算地球化学领域中模拟二氧化碳地质封存，这需要储层条件下的精确热力学性质。\n\n使用以下科学既定基础：\n- 真实气体热力学通过化学势定义逸度，对于纯物质，化学势可与一个逸度系数相关联，该系数捕捉了与理想状态的偏差。\n- Peng–Robinson状态方程（EOS）是一个经过充分检验的、适用于真实气体和流体的立方型EOS，广泛应用于地下储层模拟。\n\n您的任务是：\n1. 对于在指定温度和压力下的二氧化碳，基于Peng–Robinson EOS计算其气相的压缩因子，然后计算逸度系数。\n2. 计算逸度 $f = \\phi P$，并将其与相同条件下的理想气体逸度进行比较。\n3. 报告以帕斯卡为单位的逸度，四舍五入到六位小数，并报告所有无量纲量，同样四舍五入到六位小数。\n\n二氧化碳的假设和常数：\n- 使用普适气体常数 $R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$。\n- 使用临界温度 $T_c = 304.1282 \\ \\mathrm{K}$ 和临界压力 $P_c = 7.3773 \\times 10^6 \\ \\mathrm{Pa}$。\n- 使用偏心因子 $\\omega = 0.22394$。\n- 对于Peng–Robinson EOS的参数化，使用 $a_c = 0.45724 \\, R^2 T_c^2 / P_c$ 和 $b = 0.07780 \\, R T_c / P_c$，其中 $a(T) = a_c \\, \\alpha(T)$ 和 $\\alpha(T) = \\left(1 + \\kappa \\left(1 - \\sqrt{T/T_c}\\right)\\right)^2$，以及 $\\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2$。\n- 在气相中进行计算；当求解压缩因子的立方型EOS时，选择最大的实数根来代表气相。\n\n科学要求：\n- 您的方法应基于上述基础进行推导。不要引入标准Peng–Robinson EOS分析之外的捷径。\n- 压缩因子必须通过求解以无量纲压缩因子表示的立方型EOS来获得。\n- 逸度系数必须通过在Peng–Robinson框架内对纯流体的EOS导出剩余性质进行积分来获得。\n- 确保单位处理一致：压力单位为帕斯卡，温度单位为开尔文。逸度应以帕斯卡报告。\n\n测试套件：\n计算以下情况 $(T, P)$ 的输出，其中 $T$ 的单位是开尔文， $P$ 的单位是帕斯卡：\n- 情况1（正常路径）：$T = 320.0$, $P = 5.0 \\times 10^6$。\n- 情况2（近临界点）：$T = 304.1282$, $P = 7.3773 \\times 10^6$。\n- 情况3（超临界，高压）：$T = 350.0$, $P = 1.5 \\times 10^7$。\n- 情况4（低压极限）：$T = 300.0$, $P = 1.0 \\times 10^5$。\n\n对于每种情况，生成一个包含四个值的列表：\n- 逸度系数 $\\phi$（无量纲），四舍五入到六位小数。\n- 逸度 $f$（单位：帕斯卡），四舍五入到六位小数。\n- 相同条件下的理想气体逸度，即压力 $P$（单位：帕斯卡），四舍五入到六位小数。\n- 相对偏差 $\\delta = (f - P)/P$，以小数形式表示，四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素是对应测试用例的四值列表，按上述顺序排列。例如：\"[[phi1,f1,ideal1,delta1],[phi2,f2,ideal2,delta2],...]\"。",
            "solution": "该问题要求使用Peng–Robinson（PR）状态方程（EOS）计算指定条件下二氧化碳的逸度系数和逸度。这是化学工程和储层工程中用于模拟真实流体行为的标准程序。解决方案源于基本热力学原理和PR EOS的具体公式。\n\nPeng–Robinson EOS是一个立方型状态方程，它关联了压力（$P$）、温度（$T$）和摩尔体积（$V_m$）：\n$$\nP = \\frac{RT}{V_m - b} - \\frac{a(T)}{V_m(V_m+b) + b(V_m-b)}\n$$\n其中$R$是普适气体常数，$a(T)$和$b$是特定物质的参数。\n\n参数$a(T)$和$b$由物质的临界性质——临界温度（$T_c$）和临界压力（$P_c$）——以及其偏心因子（$\\omega$）确定。\n\n对于给定物质，参数$b$是恒定的：\n$$\nb = 0.07780 \\frac{R T_c}{P_c}\n$$\n\n参数$a$是温度的函数，计算如下：\n$$\na(T) = a_c \\alpha(T)\n$$\n其中$a_c$是$a$在临界温度下的值：\n$$\na_c = 0.45724 \\frac{R^2 T_c^2}{P_c}\n$$\n而$\\alpha(T)$是对比温度$T_r = T/T_c$的无量纲函数：\n$$\n\\alpha(T) = \\left(1 + \\kappa \\left(1 - \\sqrt{T_r}\\right)\\right)^2\n$$\n项$\\kappa$是偏心因子$\\omega$的函数：\n$$\n\\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2\n$$\n\n为了计算方便，PR EOS通常表示为关于压缩因子$Z = PV_m/(RT)$的三次多项式。这通过引入两个无量纲数组$A$和$B$来实现：\n$$\nA = \\frac{a(T) P}{(RT)^2}\n$$\n$$\nB = \\frac{b P}{RT}\n$$\n将这些代入PR EOS，得到关于$Z$的三次方程：\n$$\nZ^3 - (1-B)Z^2 + (A - 2B - 3B^2)Z - (AB - B^2 - B^3) = 0\n$$\n该方程可能有一个或三个实数根。对于单相系统（气体或液体），只有一个实数根。在两相气液平衡中，有三个实数根：最小的对应于液相，最大的对应于气相，中间的根在物理上是不稳定的。根据要求，我们将选择最大的实数根，它代表气相。\n\n逸度系数 $\\phi = f/P$ 量化了真实气体的逸度（$f$）与其压力（$P$）的偏差。它源于基本热力学关系：\n$$\n\\ln \\phi = \\int_0^P \\frac{Z(P', T) - 1}{P'} dP' \\quad (\\text{constant } T)\n$$\n对于Peng–Robinson EOS，该积分可以进行解析求解，得到逸度系数自然对数的以下表达式：\n$$\n\\ln \\phi = Z - 1 - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\ln \\left( \\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B} \\right)\n$$\n一旦计算出$\\ln \\phi$，即可通过$\\phi = \\exp(\\ln \\phi)$求得逸度系数。\n\n对于每个给定的状态（$T, P$），计算步骤如下：\n1.  使用提供的CO₂常数（$T_c, P_c, \\omega$）和普适气体常数$R$，计算PR参数$\\kappa$、$a_c$和$b$。\n2.  对于给定的温度$T$，计算对比温度$T_r$、函数$\\alpha(T)$以及与温度相关的参数$a(T)$。\n3.  对于给定的$T$和$P$，计算无量纲数组$A$和$B$。\n4.  构建关于$Z$的三次多项式的系数并求解其根。选择最大的实数根作为气相压缩因子$Z$。\n5.  将计算出的$Z$、$A$和$B$的值代入$\\ln \\phi$的解析表达式中。\n6.  计算逸度系数$\\phi = \\exp(\\ln\\phi)$。\n7.  计算逸度$f = \\phi P$。\n8.  理想气体逸度等于压力$P$。\n9.  计算相对偏差$\\delta = (f-P)/P = \\phi-1$。\n10. 报告所需的值（$\\phi, f, P, \\delta$），每个值都四舍五入到六位小数。\n\n该算法为确定与地质封存模拟相关的各种条件下CO₂的逸度提供了一种严谨且有物理基础的方法。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes fugacity coefficient and fugacity for CO2 using the Peng–Robinson EOS.\n    \"\"\"\n\n    # Constants for Carbon Dioxide (CO2)\n    R = 8.314462618  # Universal gas constant, J/(mol*K)\n    TC = 304.1282     # Critical temperature, K\n    PC = 7.3773e6      # Critical pressure, Pa\n    OMEGA = 0.22394    # Acentric factor, dimensionless\n\n    # Test cases (T in Kelvin, P in Pascals)\n    test_cases = [\n        (320.0, 5.0e6),\n        (304.1282, 7.3773e6),\n        (350.0, 1.5e7),\n        (300.0, 1.0e5)\n    ]\n\n    def calculate_properties(T, P):\n        \"\"\"\n        Calculates fugacity related properties for a given T and P.\n        \"\"\"\n        # Step 1: Calculate Peng-Robinson parameters\n        kappa = 0.37464 + 1.54226 * OMEGA - 0.26992 * OMEGA**2\n        ac = 0.45724 * (R**2 * TC**2) / PC\n        b = 0.07780 * (R * TC) / PC\n\n        # Step 2: Calculate temperature-dependent 'a'\n        Tr = T / TC\n        alpha = (1 + kappa * (1 - np.sqrt(Tr)))**2\n        a = ac * alpha\n\n        # Step 3: Calculate dimensionless parameters A and B\n        A = a * P / (R**2 * T**2)\n        B = b * P / (R * T)\n\n        # Step 4: Solve the cubic EOS for compressibility factor Z\n        # Z^3 - (1-B)Z^2 + (A-2B-3B^2)Z - (AB-B^2-B^3) = 0\n        coeffs = [\n            1,\n            -(1 - B),\n            A - 2 * B - 3 * B**2,\n            -(A * B - B**2 - B**3)\n        ]\n        \n        roots = np.roots(coeffs)\n        \n        # Filter for real roots and select the largest one for the gas phase\n        real_roots = [r.real for r in roots if abs(r.imag)  1e-9]\n        if not real_roots:\n            # Should not happen for these cases, but good practice\n            raise ValueError(\"No real roots found for the compressibility factor Z.\")\n        Z = max(real_roots)\n\n        # Step 5  6: Calculate fugacity coefficient phi\n        # Check for B=0 case to avoid division by zero, although not expected here.\n        if abs(B)  1e-12:\n            ln_phi = Z - 1 - np.log(Z) - A / Z\n        else:\n            term1 = Z - 1\n            term2 = np.log(Z - B)\n            log_arg = (Z + (1 + np.sqrt(2)) * B) / (Z + (1 - np.sqrt(2)) * B)\n            term3 = (A / (2 * np.sqrt(2) * B)) * np.log(log_arg)\n            ln_phi = term1 - term2 - term3\n        \n        phi = np.exp(ln_phi)\n\n        # Step 7, 8, 9: Calculate fugacity, ideal fugacity, and deviation\n        f = phi * P\n        ideal_f = P\n        delta = (f - ideal_f) / ideal_f\n\n        return [phi, f, ideal_f, delta]\n\n    results = []\n    for T, P in test_cases:\n        case_result = calculate_properties(T, P)\n        results.append(case_result)\n\n    # Format the final output string exactly as required\n    result_strings = []\n    for res_list in results:\n        # Using f-strings to ensure 6 decimal places, even for trailing zeros\n        s = '[' + ','.join([f'{v:.6f}' for v in res_list]) + ']'\n        result_strings.append(s)\n\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "注入的二氧化碳的长期归宿取决于其与储层矿物发生的化学反应，这些反应是矿物捕获和盖层完整性评估的核心。这些反应的速率对温度高度敏感，而地下的温度随深度变化。本练习  将基础的过渡态理论与实用的阿伦尼乌斯定律联系起来，使您能够计算出随温度变化的反应速率常数，这是准确预测矿物捕获和储层长期演化的关键输入参数。",
            "id": "4085907",
            "problem": "在一个用于二氧化碳（CO$_2$）地质封存的目标盐水层中，钠长石（$\\mathrm{NaAlSi_3O_8}$）在CO$_2$酸化的盐水中的质子促进溶解被建模为一个相对于反应性表面络合物的表面控制一级基元步骤。反应输运模拟需要此步骤的温变速率常数。请从过渡态理论（TST）出发——该理论将基元反应的速率常数与活化自由能相关联——推导速率常数的温度依赖关系，使其在适用于中等储层温度范围的地球化学标准近似下，与Arrhenius定律的形式保持一致。您的推导必须从速率常数的TST表达式开始，并通过将活化自由能用焓和熵表示来继续进行。\n\n在标准条件下进行的实验室表征报告了在 $T_{\\mathrm{ref}} = 298 \\ \\mathrm{K}$ 时，同一步骤的参考速率常数 $k(T_{\\mathrm{ref}})$ 为 $k(T_{\\mathrm{ref}}) = 2.0 \\times 10^{-10} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}$。从头计算和程序升温测量表明，限速基元步骤的活化能 $E_{a} = 65 \\ \\mathrm{kJ \\ mol^{-1}}$。对于储层，假设其温度均匀为 $T_{\\mathrm{res}} = 343 \\ \\mathrm{K}$。\n\n使用您推导出的温度依赖关系，计算在 $T_{\\mathrm{res}}$ 下的速率常数 $k(T_{\\mathrm{res}})$。取普适气体常数 $R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$。将最终速率常数以 $\\mathrm{mol \\ m^{-2} \\ s^{-1}}$ 为单位表示，并将您的答案四舍五入至四位有效数字。",
            "solution": "该问题被评估为有效，因为它科学地基于化学动力学和地球化学的既定原理，问题提出得当，数据充分且一致，并以客观、明确的语言表达。该问题需要一个分两部分的回答：首先，从过渡态理论（TST）推导Arrhenius温度依赖关系；其次，计算在新温度下的反应速率常数。\n\n第一部分：从过渡态理论推导Arrhenius温度依赖关系\n\n问题要求从过渡态理论（TST）出发，推导速率常数的Arrhenius型温度依赖关系。基元反应速率常数 $k$ 的TST表达式（也称为Eyring方程）为：\n$$\nk = \\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger}{RT}\\right)\n$$\n其中 $\\kappa$ 是透射系数，$k_B$ 是Boltzmann常数，$h$ 是Planck常数，$T$ 是绝对温度，$R$ 是普适气体常数，$\\Delta G^\\ddagger$ 是活化吉布斯自由能，即活化络合物（过渡态）与反应物之间的自由能差。\n\n在许多应用中，包括矿物溶解动力学建模，速率常数 $k$ 可能代表一个宏观速率，单位如 $\\mathrm{mol \\ m^{-2} \\ s^{-1}}$。这个宏观常数与TST给出的基元速率常数成正比，比例因子考虑了反应物浓度、表面位点密度和其他系统特定参数。因此，我们可以写出：\n$$\nk = C \\cdot \\left(\\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger}{RT}\\right)\\right)\n$$\n其中 $C$ 是比例常数。对于许多反应，透射系数 $\\kappa$ 假定为1。\n\n活化吉布斯自由能 $\\Delta G^\\ddagger$ 与活化焓 $\\Delta H^\\ddagger$ 和活化熵 $\\Delta S^\\ddagger$ 通过基本热力学关系式相关联：\n$$\n\\Delta G^\\ddagger = \\Delta H^\\ddagger - T \\Delta S^\\ddagger\n$$\n将 $\\Delta G^\\ddagger$ 的这个表达式代入TST方程得到：\n$$\nk = C \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta H^\\ddagger - T \\Delta S^\\ddagger}{RT}\\right)\n$$\n该方程可以通过分离指数项重新整理：\n$$\nk = C \\frac{k_B T}{h} \\exp\\left(\\frac{T \\Delta S^\\ddagger}{RT}\\right) \\exp\\left(-\\frac{\\Delta H^\\ddagger}{RT}\\right)\n$$\n$$\nk = C \\frac{k_B T}{h} \\exp\\left(\\frac{\\Delta S^\\ddagger}{R}\\right) \\exp\\left(-\\frac{\\Delta H^\\ddagger}{RT}\\right)\n$$\nArrhenius方程是一个描述反应速率温度依赖性的经验关系式，由下式给出：\n$$\nk = A \\exp\\left(-\\frac{E_a}{RT}\\right)\n$$\n其中 $A$ 是指前因子（或频率因子），$E_a$ 是活化能。\n\n为了使TST表达式与经验的Arrhenius形式协调一致，我们可以将TST推导的方程中的各项进行分组：\n$$\nk = \\left(C \\frac{k_B T}{h} \\exp\\left(\\frac{\\Delta S^\\ddagger}{R}\\right)\\right) \\exp\\left(-\\frac{\\Delta H^\\ddagger}{RT}\\right)\n$$\n将其与Arrhenius方程进行比较，我们可以确定指前因子 $A$ 和活化能 $E_a$。Arrhenius指前因子是：\n$$\nA(T) = C \\frac{k_B T}{h} \\exp\\left(\\frac{\\Delta S^\\ddagger}{R}\\right)\n$$\n注意到从TST推导出的指前因子本身是温度的函数，因为它包含线性项 $T$。然而，对于在凝聚相中、中等温度范围内发生的反应，指数项 $\\exp(-\\Delta H^\\ddagger/RT)$ 的温度依赖性远比指前因子的线性温度依赖性显著。\n\n问题中提到的“地球化学标准近似”涉及在所关注的温度范围内将指前因子 $A$ 视为常数。当温度范围不是过大时，这是一个有效的假设。通过这个近似，我们有效地将指前因子的弱温度依赖性并入一个常数值中。在此近似下，直接比较指数项可得出经验Arrhenius活化能 $E_a$ 与活化焓 $\\Delta H^\\ddagger$ 的等同关系：\n$$\nE_a \\approx \\Delta H^\\ddagger\n$$\n因此，在指前因子随温度不变的标准近似下，速率常数的TST表达式具有Arrhenius定律的函数形式，$k = A \\exp(-E_a/RT)$，其中 $A$ 被视为常数，$E_a$ 是实验测定的活化能。\n\n第二部分：计算储层温度下的速率常数\n\n推导出的Arrhenius方程为 $k(T) = A \\exp(-E_a/RT)$。我们已知参考温度 $T_{\\mathrm{ref}}$ 下的数值，并要求计算在储层温度 $T_{\\mathrm{res}}$ 下的速率常数。我们可以为这两个温度写出Arrhenius方程：\n$$\nk(T_{\\mathrm{ref}}) = A \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{ref}}}\\right)\n$$\n$$\nk(T_{\\mathrm{res}}) = A \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{res}}}\\right)\n$$\n为消去未知的指前因子 $A$，我们取这两个方程的比值：\n$$\n\\frac{k(T_{\\mathrm{res}})}{k(T_{\\mathrm{ref}})} = \\frac{A \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{res}}}\\right)}{A \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{ref}}}\\right)} = \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{res}}} + \\frac{E_a}{R T_{\\mathrm{ref}}}\\right)\n$$\n这简化为Arrhenius方程的积分形式：\n$$\nk(T_{\\mathrm{res}}) = k(T_{\\mathrm{ref}}) \\exp\\left[\\frac{E_a}{R} \\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T_{\\mathrm{res}}}\\right)\\right]\n$$\n现在，我们将给定值代入此方程：\n-   参考速率常数：$k(T_{\\mathrm{ref}}) = 2.0 \\times 10^{-10} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}$\n-   参考温度：$T_{\\mathrm{ref}} = 298 \\ \\mathrm{K}$\n-   储层温度：$T_{\\mathrm{res}} = 343 \\ \\mathrm{K}$\n-   活化能：$E_a = 65 \\ \\mathrm{kJ \\ mol^{-1}} = 65000 \\ \\mathrm{J \\ mol^{-1}}$\n-   普适气体常数：$R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$\n\n首先，计算指数函数的参数：\n$$\n\\frac{E_a}{R} \\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T_{\\mathrm{res}}}\\right) = \\frac{65000 \\ \\mathrm{J \\ mol^{-1}}}{8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}} \\left(\\frac{1}{298 \\ \\mathrm{K}} - \\frac{1}{343 \\ \\mathrm{K}}\\right)\n$$\n$$\n\\approx 7817.5835 \\ \\mathrm{K} \\left(0.0033557047 \\ \\mathrm{K^{-1}} - 0.0029154519 \\ \\mathrm{K^{-1}}\\right)\n$$\n$$\n\\approx 7817.5835 \\ \\mathrm{K} \\left(0.0004402528 \\ \\mathrm{K^{-1}}\\right)\n$$\n$$\n\\approx 3.441908\n$$\n现在，计算速率常数 $k(T_{\\mathrm{res}})$：\n$$\nk(T_{\\mathrm{res}}) = (2.0 \\times 10^{-10} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}) \\times \\exp(3.441908)\n$$\n$$\nk(T_{\\mathrm{res}}) \\approx (2.0 \\times 10^{-10} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}) \\times 31.2476\n$$\n$$\nk(T_{\\mathrm{res}}) \\approx 6.24952 \\times 10^{-9} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}\n$$\n根据要求将最终结果四舍五入至四位有效数字：\n$$\nk(T_{\\mathrm{res}}) = 6.250 \\times 10^{-9} \\ \\mathrm{mol \\ m^{-2} \\ s^{-1}}\n$$",
            "answer": "$$\\boxed{6.250 \\times 10^{-9}}$$"
        }
    ]
}