{
    "hands_on_practices": [
        {
            "introduction": "To accurately model CO₂ geological sequestration, we must first characterize the thermodynamic state of the injected supercritical CO₂ under high-pressure and high-temperature reservoir conditions. The ideal gas law is insufficient for this task, so we turn to the concept of fugacity, which represents the \"effective pressure\" of a real fluid. This practice guides you through implementing the Peng–Robinson Equation of State, a cornerstone of chemical engineering, to compute the fugacity of CO₂ and understand its deviation from ideal behavior .",
            "id": "4085881",
            "problem": "You are to implement a program that, for carbon dioxide, computes the fugacity coefficient and fugacity using the Peng–Robinson Equation of State (EOS), and compares it to the ideal-gas fugacity. The context is modeling carbon dioxide geological sequestration in computational geochemistry, where accurate thermodynamic properties under reservoir conditions are required.\n\nUse the following scientifically established base:\n- Real-gas thermodynamics defines fugacity via the chemical potential, which for a pure substance can be related to a fugacity coefficient that captures deviations from ideality.\n- The Peng–Robinson Equation of State (EOS) is a well-tested cubic EOS for real gases and fluids, widely used in subsurface reservoir simulations.\n\nYour task is to:\n1. For carbon dioxide at specified temperature and pressure, compute the compressibility factor of the gas phase based on the Peng–Robinson EOS, and then compute the fugacity coefficient.\n2. Compute the fugacity as $f = \\phi P$ and compare it to the ideal-gas fugacity at the same conditions.\n3. Report the fugacity in pascals, rounded to six decimal places, and report all dimensionless quantities rounded to six decimal places.\n\nAssumptions and constants for carbon dioxide:\n- Use the universal gas constant $R = 8.314462618 \\, \\mathrm{J \\, mol^{-1} \\, K^{-1}}$.\n- Use the critical temperature $T_c = 304.1282 \\, \\mathrm{K}$ and critical pressure $P_c = 7.3773 \\times 10^6 \\, \\mathrm{Pa}$.\n- Use the acentric factor $\\omega = 0.22394$.\n- For the Peng–Robinson EOS parameterization, use $a_c = 0.45724 \\, R^2 T_c^2 / P_c$ and $b = 0.07780 \\, R T_c / P_c$, with $a(T) = a_c \\, \\alpha(T)$ and $\\alpha(T) = \\left(1 + \\kappa \\left(1 - \\sqrt{T/T_c}\\right)\\right)^2$, and $\\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2$.\n- Work in the gas phase; when solving the cubic EOS for the compressibility factor, select the largest real root to represent the vapor phase.\n\nScientific requirements:\n- Frame your approach in terms of derivations from the above base. Do not introduce shortcuts outside standard Peng–Robinson EOS analysis.\n- The compressibility factor must be obtained by solving the cubic EOS in terms of the dimensionless compressibility factor.\n- The fugacity coefficient must be obtained from integrating EOS-derived residual properties for a pure fluid within the Peng–Robinson framework.\n- Ensure units are handled consistently: pressure in pascals and temperature in kelvins. Fugacity should be reported in pascals.\n\nTest suite:\nCompute the outputs for the following cases $(T, P)$ where $T$ is in kelvins and $P$ is in pascals:\n- Case 1 (happy path): $T = 320.0$, $P = 5.0 \\times 10^6$.\n- Case 2 (near-critical): $T = 304.1282$, $P = 7.3773 \\times 10^6$.\n- Case 3 (supercritical, high pressure): $T = 350.0$, $P = 1.5 \\times 10^7$.\n- Case 4 (low pressure limit): $T = 300.0$, $P = 1.0 \\times 10^5$.\n\nFor each case, produce a list of four values:\n- The fugacity coefficient $\\phi$ (dimensionless) rounded to six decimal places.\n- The fugacity $f$ in pascals, rounded to six decimal places.\n- The ideal-gas fugacity at the same conditions, which is $P$ in pascals, rounded to six decimal places.\n- The relative deviation $\\delta = (f - P)/P$ as a decimal, rounded to six decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the four-value list for the corresponding test case, ordered as given above. For example: \"[[phi1,f1,ideal1,delta1],[phi2,f2,ideal2,delta2],...]\".",
            "solution": "The problem requires the computation of the fugacity coefficient and fugacity for carbon dioxide at specified conditions using the Peng–Robinson (PR) Equation of State (EOS). This is a standard procedure in chemical and reservoir engineering for modeling the behavior of real fluids. The solution is derived from fundamental thermodynamic principles and the specific formulation of the PR EOS.\n\nThe Peng–Robinson EOS is a cubic equation of state that relates pressure ($P$), temperature ($T$), and molar volume ($V_m$):\n$$\nP = \\frac{RT}{V_m - b} - \\frac{a(T)}{V_m(V_m+b) + b(V_m-b)}\n$$\nwhere $R$ is the universal gas constant, and $a(T)$ and $b$ are substance-specific parameters.\n\nThe parameters $a(T)$ and $b$ are determined from the substance's critical properties—critical temperature ($T_c$) and critical pressure ($P_c$)—and its acentric factor ($\\omega$).\n\nThe parameter $b$ is constant for a given substance:\n$$\nb = 0.07780 \\frac{R T_c}{P_c}\n$$\n\nThe parameter $a$ is a function of temperature, calculated as:\n$$\na(T) = a_c \\alpha(T)\n$$\nwhere $a_c$ is the value of $a$ at the critical temperature:\n$$\na_c = 0.45724 \\frac{R^2 T_c^2}{P_c}\n$$\nand $\\alpha(T)$ is a dimensionless function of the reduced temperature, $T_r = T/T_c$:\n$$\n\\alpha(T) = \\left(1 + \\kappa \\left(1 - \\sqrt{T_r}\\right)\\right)^2\n$$\nThe term $\\kappa$ is a function of the acentric factor $\\omega$:\n$$\n\\kappa = 0.37464 + 1.54226 \\, \\omega - 0.26992 \\, \\omega^2\n$$\n\nFor computational purposes, the PR EOS is typically expressed as a cubic polynomial in the compressibility factor, $Z = PV_m/(RT)$. This is achieved by introducing two dimensionless groups, $A$ and $B$:\n$$\nA = \\frac{a(T) P}{(RT)^2}\n$$\n$$\nB = \\frac{b P}{RT}\n$$\nSubstituting these into the PR EOS yields the cubic equation for $Z$:\n$$\nZ^3 - (1-B)Z^2 + (A - 2B - 3B^2)Z - (AB - B^2 - B^3) = 0\n$$\nThis equation may have one or three real roots. For a system in a single phase (gas or liquid), there is one real root. In a two-phase vapor-liquid equilibrium, there are three real roots: the smallest corresponds to the liquid phase, the largest to the vapor (gas) phase, and the intermediate root is physically unstable. As specified, we will select the largest real root, which represents the gas phase.\n\nThe fugacity coefficient, $\\phi = f/P$, quantifies the deviation of a real gas's fugacity ($f$) from its pressure ($P$). It is derived from the fundamental thermodynamic relation:\n$$\n\\ln \\phi = \\int_0^P \\frac{Z(P', T) - 1}{P'} dP' \\quad (\\text{constant } T)\n$$\nFor the Peng–Robinson EOS, this integral can be evaluated analytically, yielding the following expression for the natural logarithm of the fugacity coefficient:\n$$\n\\ln \\phi = Z - 1 - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\ln \\left( \\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B} \\right)\n$$\nOnce $\\ln \\phi$ is computed, the fugacity coefficient is found via $\\phi = \\exp(\\ln \\phi)$.\n\nThe computational procedure for each given state ($T, P$) is as follows:\n1.  Using the provided constants for CO₂ ($T_c, P_c, \\omega$) and the universal gas constant $R$, calculate the PR parameters $\\kappa$, $a_c$, and $b$.\n2.  For the given temperature $T$, compute the reduced temperature $T_r$, the function $\\alpha(T)$, and the temperature-dependent parameter $a(T)$.\n3.  Calculate the dimensionless groups $A$ and $B$ for the given $T$ and $P$.\n4.  Formulate the coefficients of the cubic polynomial in $Z$ and solve for its roots. Select the largest real root as the gas-phase compressibility factor, $Z$.\n5.  Substitute the calculated values of $Z$, $A$, and $B$ into the analytical expression for $\\ln \\phi$.\n6.  Calculate the fugacity coefficient $\\phi = \\exp(\\ln\\phi)$.\n7.  Calculate the fugacity $f = \\phi P$.\n8.  The ideal-gas fugacity is equal to the pressure $P$.\n9.  Calculate the relative deviation $\\delta = (f-P)/P = \\phi-1$.\n10. Report the required values ($\\phi, f, P, \\delta$), each rounded to six decimal places.\n\nThis algorithm provides a rigorous and physically grounded method for determining the fugacity of CO₂ under various conditions relevant to geological sequestration modeling.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes fugacity coefficient and fugacity for CO2 using the Peng–Robinson EOS.\n    \"\"\"\n\n    # Constants for Carbon Dioxide (CO2)\n    R = 8.314462618  # Universal gas constant, J/(mol*K)\n    TC = 304.1282     # Critical temperature, K\n    PC = 7.3773e6      # Critical pressure, Pa\n    OMEGA = 0.22394    # Acentric factor, dimensionless\n\n    # Test cases (T in Kelvin, P in Pascals)\n    test_cases = [\n        (320.0, 5.0e6),\n        (304.1282, 7.3773e6),\n        (350.0, 1.5e7),\n        (300.0, 1.0e5)\n    ]\n\n    def calculate_properties(T, P):\n        \"\"\"\n        Calculates fugacity related properties for a given T and P.\n        \"\"\"\n        # Step 1: Calculate Peng-Robinson parameters\n        kappa = 0.37464 + 1.54226 * OMEGA - 0.26992 * OMEGA**2\n        ac = 0.45724 * (R**2 * TC**2) / PC\n        b = 0.07780 * (R * TC) / PC\n\n        # Step 2: Calculate temperature-dependent 'a'\n        Tr = T / TC\n        alpha = (1 + kappa * (1 - np.sqrt(Tr)))**2\n        a = ac * alpha\n\n        # Step 3: Calculate dimensionless parameters A and B\n        A = a * P / (R**2 * T**2)\n        B = b * P / (R * T)\n\n        # Step 4: Solve the cubic EOS for compressibility factor Z\n        # Z^3 - (1-B)Z^2 + (A-2B-3B^2)Z - (AB-B^2-B^3) = 0\n        coeffs = [\n            1,\n            -(1 - B),\n            A - 2 * B - 3 * B**2,\n            -(A * B - B**2 - B**3)\n        ]\n        \n        roots = np.roots(coeffs)\n        \n        # Filter for real roots and select the largest one for the gas phase\n        real_roots = [r.real for r in roots if abs(r.imag) < 1e-9]\n        if not real_roots:\n            # Should not happen for these cases, but good practice\n            raise ValueError(\"No real roots found for the compressibility factor Z.\")\n        Z = max(real_roots)\n\n        # Step 5 & 6: Calculate fugacity coefficient phi\n        # Check for B=0 case to avoid division by zero, although not expected here.\n        if abs(B) < 1e-12:\n            ln_phi = Z - 1 - np.log(Z) - A / Z\n        else:\n            term1 = Z - 1\n            term2 = np.log(Z - B)\n            log_arg = (Z + (1 + np.sqrt(2)) * B) / (Z + (1 - np.sqrt(2)) * B)\n            term3 = (A / (2 * np.sqrt(2) * B)) * np.log(log_arg)\n            ln_phi = term1 - term2 - term3\n        \n        phi = np.exp(ln_phi)\n\n        # Step 7, 8, 9: Calculate fugacity, ideal fugacity, and deviation\n        f = phi * P\n        ideal_f = P\n        delta = (f - ideal_f) / ideal_f\n\n        return [phi, f, ideal_f, delta]\n\n    results = []\n    for T, P in test_cases:\n        case_result = calculate_properties(T, P)\n        results.append(case_result)\n\n    # Format the final output string exactly as required\n    result_strings = []\n    for res_list in results:\n        # Using f-strings to ensure 6 decimal places, even for trailing zeros\n        s = '[' + ','.join([f'{v:.6f}' for v in res_list]) + ']'\n        result_strings.append(s)\n\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "When CO₂ dissolves into the reservoir's saline water, it forms carbonic acid, triggering a cascade of acid-base reactions that fundamentally alter the brine's chemistry. The resulting pH is a master variable that controls mineral stability and overall geochemical evolution. This exercise focuses on deriving and solving the core charge balance equation for the aqueous carbonate system, a foundational skill for any quantitative modeling of subsurface geochemistry . You will develop a numerical tool to compute pH from key system parameters like total inorganic carbon ($C_T$) and alkalinity ($Alk$).",
            "id": "4085884",
            "problem": "Consider a closed aqueous system representative of a sodium–chloride (Na–Cl) brine at temperature $25\\,^{\\circ}\\mathrm{C}$ relevant to modeling carbon dioxide (CO₂) geological sequestration, in which inorganic carbon is present only as the carbonate system species $\\mathrm{H_2CO_3^*}$ (where the asterisk denotes the sum of dissolved molecular carbon dioxide and true carbonic acid), $\\mathrm{HCO_3^-}$, and $\\mathrm{CO_3^{2-}}$, and water autoprotolysis produces $\\mathrm{H^+}$ and $\\mathrm{OH^-}$. Assume sodium and chloride originate from a strong electrolyte and do not participate in acid–base reactions. Treat equilibrium constants as conditional concentration-based values at the specified ionic strength, and neglect explicit activity coefficient corrections. Let the following quantities be defined:\n\n- $C_T$: total inorganic carbon, $C_T = [\\mathrm{H_2CO_3^*}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$, with units of moles per liter.\n- $Alk$: total alkalinity, defined by $Alk = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]$, with units of moles per liter.\n- $K_1$: first dissociation constant of carbonic acid for $\\mathrm{H_2CO_3^*} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HCO_3^-}$, with units of moles per liter.\n- $K_2$: second dissociation constant of carbonic acid for $\\mathrm{HCO_3^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{CO_3^{2-}}$, with units of moles per liter.\n- $K_w$: water autoprotolysis constant, $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$, with units of moles squared per liter squared.\n- $\\mathrm{pH}$: potential of Hydrogen (pH), defined by $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$.\n\nStarting from the principle of electroneutrality (sum of positive charges equals sum of negative charges), derive the charge balance relation for the Na–Cl brine when only the carbonate system and water contribute to acid–base equilibria. Show that this leads to a single nonlinear equation in $[\\mathrm{H^+}]$ that can be solved computationally for $\\mathrm{pH}$ given $C_T$, $Alk$, $K_1$, and $K_2$, along with $K_w$.\n\nUse the core definitions and laws:\n- Mass action for the carbonate system, neglecting activity corrections: $K_1 = \\dfrac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{[\\mathrm{H_2CO_3^*}]}$ and $K_2 = \\dfrac{[\\mathrm{H^+}][\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$.\n- Total inorganic carbon conservation: $C_T = [\\mathrm{H_2CO_3^*}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$.\n- Water autoprotolysis: $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$.\n- Total alkalinity definition: $Alk = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]$.\n- Electroneutrality: $\\displaystyle \\sum_i z_i[\\mathrm{X_i}] = 0$, where $z_i$ are ionic charges.\n\nDerive the charge balance for this system in terms of the species $\\mathrm{Na^+}$, $\\mathrm{H^+}$, $\\mathrm{Cl^-}$, $\\mathrm{HCO_3^-}$, $\\mathrm{CO_3^{2-}}$, and $\\mathrm{OH^-}$, and then use the above relations to eliminate unknowns to obtain a single equation in $[\\mathrm{H^+}]$ suitable for numerical root finding.\n\nYour task is to implement a program that, for each test case in the test suite below, computes $\\mathrm{pH}$ from the given parameters. All inputs $C_T$, $Alk$, $K_1$, and $K_2$ must be interpreted in moles per liter, and $K_w$ in moles squared per liter squared. Express the final $\\mathrm{pH}$ values as dimensionless floats rounded to six decimal places.\n\nTest suite and parameter values (each tuple is $(C_T, Alk, K_1, K_2, K_w)$, with units as specified above):\n- Case $1$ (general alkaline case): $(2.0\\times 10^{-3}, 2.0\\times 10^{-3}, 10^{-6.30}, 10^{-10.33}, 10^{-14})$.\n- Case $2$ (zero alkalinity with moderate carbon): $(2.0\\times 10^{-3}, 0.0, 10^{-6.30}, 10^{-10.33}, 10^{-14})$.\n- Case $3$ (near-pure water carbon, zero alkalinity): $(1.0\\times 10^{-6}, 0.0, 10^{-6.30}, 10^{-10.33}, 10^{-14})$.\n- Case $4$ (negative alkalinity, high carbon): $(1.0\\times 10^{-2}, -1.0\\times 10^{-3}, 10^{-6.30}, 10^{-10.33}, 10^{-14})$.\n- Case $5$ (pure water limit): $(0.0, 0.0, 10^{-6.30}, 10^{-10.33}, 10^{-14})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3}]$), where each result is the computed $\\mathrm{pH}$ for the corresponding test case, rounded to six decimal places.",
            "solution": "The problem requires the derivation of a governing equation for the $\\mathrm{pH}$ of an aqueous carbonate system and its subsequent numerical solution. The system is defined by its total inorganic carbon, $C_T$, and total alkalinity, $Alk$, along with the relevant equilibrium constants $K_1$, $K_2$, and $K_w$. This is a standard problem in aqueous geochemistry.\n\nOur derivation begins with the fundamental principle of electroneutrality, which mandates that the total concentration of positive charges must equal the total concentration of negative charges. The ionic species present in the described sodium-chloride brine are $\\mathrm{Na^+}$, $\\mathrm{H^+}$, $\\mathrm{Cl^-}$, $\\mathrm{HCO_3^-}$, $\\mathrm{CO_3^{2-}}$, and $\\mathrm{OH^-}$. The charge balance equation is therefore:\n$$\n[\\mathrm{Na^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}]\n$$\nRearranging this equation to group the conservative ions ($\\mathrm{Na^+}$ and $\\mathrm{Cl^-}$, which do not participate in proton exchange reactions) on one side gives:\n$$\n[\\mathrm{Na^+}] - [\\mathrm{Cl^-}] = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]\n$$\nThe problem provides a definition for total alkalinity, $Alk$, as:\n$$\nAlk = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] - [\\mathrm{H^+}]\n$$\nBy comparing these two equations, we see that $Alk = [\\mathrm{Na^+}] - [\\mathrm{Cl^-}]$. This demonstrates that the given alkalinity is a conservative quantity representing the charge imbalance due to strong electrolytes. The problem is thus to find the equilibrium concentration of hydrogen ions, $[\\mathrm{H^+}]$, for a system specified by the known, fixed values of $Alk$ and $C_T$.\n\nThe next step is to express all concentration terms in the alkalinity definition as functions of a single variable, $[\\mathrm{H^+}]$, and the given constants. Let $h = [\\mathrm{H^+}]$.\nFrom the autoprotolysis of water, we have $[\\mathrm{OH^-}] = K_w / h$.\n\nThe concentrations of the carbonate species ($[\\mathrm{H_2CO_3^*}]$, $[\\mathrm{HCO_3^-}]$, $[\\mathrm{CO_3^{2-}}]$) can be related to $C_T$ and $h$ using the equilibrium constant definitions:\n$K_1 = \\dfrac{h[\\mathrm{HCO_3^-}]}{[\\mathrm{H_2CO_3^*}]}$ and $K_2 = \\dfrac{h[\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}$.\nFrom these, we can write:\n$[\\mathrm{H_2CO_3^*}] = \\dfrac{h[\\mathrm{HCO_3^-}]}{K_1}$ and $[\\mathrm{CO_3^{2-}}] = \\dfrac{K_2[\\mathrm{HCO_3^-}]}{h}$.\nSubstituting these into the definition for total inorganic carbon, $C_T = [\\mathrm{H_2CO_3^*}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$, yields:\n$$\nC_T = \\frac{h[\\mathrm{HCO_3^-}]}{K_1} + [\\mathrm{HCO_3^-}] + \\frac{K_2[\\mathrm{HCO_3^-}]}{h} = [\\mathrm{HCO_3^-}]\\left(\\frac{h}{K_1} + 1 + \\frac{K_2}{h}\\right)\n$$\nThis allows us to express the individual carbonate species concentrations as fractions of $C_T$. These fractions, denoted by $\\alpha_i$, are functions of $h$ only:\n$$\n[\\mathrm{H_2CO_3^*}] = C_T \\alpha_0(h) \\quad \\text{where} \\quad \\alpha_0(h) = \\frac{h^2}{h^2 + K_1 h + K_1 K_2}\n$$\n$$\n[\\mathrm{HCO_3^-}] = C_T \\alpha_1(h) \\quad \\text{where} \\quad \\alpha_1(h) = \\frac{K_1 h}{h^2 + K_1 h + K_1 K_2}\n$$\n$$\n[\\mathrm{CO_3^{2-}}] = C_T \\alpha_2(h) \\quad \\text{where} \\quad \\alpha_2(h) = \\frac{K_1 K_2}{h^2 + K_1 h + K_1 K_2}\n$$\nNow, we substitute these expressions for $[\\mathrm{HCO_3^-}]$, $[\\mathrm{CO_3^{2-}}]$, and $[\\mathrm{OH^-}]$ into the alkalinity definition:\n$$\nAlk = C_T \\alpha_1(h) + 2C_T \\alpha_2(h) + \\frac{K_w}{h} - h\n$$\nSubstituting the full expressions for $\\alpha_1(h)$ and $\\alpha_2(h)$:\n$$\nAlk = C_T \\left( \\frac{K_1 h}{h^2 + K_1 h + K_1 K_2} \\right) + 2C_T \\left( \\frac{K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) + \\frac{K_w}{h} - h\n$$\nThis can be combined into a single expression:\n$$\nAlk = C_T \\left( \\frac{K_1 h + 2 K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) + \\frac{K_w}{h} - h\n$$\nThis is the required single nonlinear equation in the unknown $h = [\\mathrm{H^+}]$. To solve for $h$ numerically, we define a function $f(h)$ and find its root:\n$$\nf(h) = C_T \\left( \\frac{K_1 h + 2 K_1 K_2}{h^2 + K_1 h + K_1 K_2} \\right) + \\frac{K_w}{h} - h - Alk = 0\n$$\nThis function is well-behaved for physically meaningful (positive) concentrations. Its derivative with respect to $h$ is always negative, meaning $f(h)$ is monotonically decreasing. This guarantees that a unique positive root for $h$ exists.\n\nThe algorithmic design is to implement a numerical root-finding method. The bisection or Brent's method is suitable for this purpose, as it is robust for monotonic functions. We can establish a search bracket $[a, b]$ for $h$ where $f(a) > 0$ and $f(b) < 0$. A chemically reasonable range for $[\\mathrm{H^+}]$ spans from highly acidic to highly alkaline conditions, so a bracket like $[10^{-15}, 1.0]$ moles per liter should safely contain the root for all test cases. The `scipy.optimize.brentq` function is an appropriate tool for this task.\n\nOnce the root $h_{root}$ is determined, the $\\mathrm{pH}$ is calculated using its definition:\n$$\n\\mathrm{pH} = -\\log_{10}(h_{root})\n$$\nThe value is then rounded to six decimal places as required. This procedure is applied to each test case to obtain the final results.",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for pH in an aqueous carbonate system for a given set of parameters.\n\n    The problem is defined by the total inorganic carbon (Ct), total alkalinity (Alk),\n    and the equilibrium constants K1, K2, and Kw. The solution involves finding the\n    root of a nonlinear equation for the hydrogen ion concentration [H+].\n    \"\"\"\n    \n    # Test suite: (C_T, Alk, K1, K2, Kw)\n    # C_T and Alk in mol/L\n    # K1 and K2 in mol/L\n    # Kw in (mol/L)^2\n    test_cases = [\n        (2.0e-3, 2.0e-3, 10**-6.30, 10**-10.33, 10**-14.0), # Case 1\n        (2.0e-3, 0.0,    10**-6.30, 10**-10.33, 10**-14.0), # Case 2\n        (1.0e-6, 0.0,    10**-6.30, 10**-10.33, 10**-14.0), # Case 3\n        (1.0e-2, -1.0e-3, 10**-6.30, 10**-10.33, 10**-14.0),# Case 4\n        (0.0,    0.0,    10**-6.30, 10**-10.33, 10**-14.0), # Case 5\n    ]\n\n    results = []\n    \n    for i, case in enumerate(test_cases):\n        Ct, Alk, K1, K2, Kw = case\n        \n        # Special case: C_T = 0.\n        # The governing equation simplifies to h^2 + Alk*h - Kw = 0.\n        # This avoids numerical issues with the general form when Ct=0.\n        if Ct == 0.0:\n            # Using the quadratic formula for ax^2 + bx + c = 0\n            # a=1, b=Alk, c=-Kw\n            # We must take the positive root for h.\n            h_root = (-Alk + np.sqrt(Alk**2 + 4 * Kw)) / 2.0\n        else:\n            # General case: define the function f(h) whose root we need to find.\n            # f(h) = Ct * (alpha1 + 2*alpha2) + [OH-] - [H+] - Alk = 0\n            # Let h = [H+].\n            def f(h):\n                if h <= 0:\n                    return np.inf  # Prevent division by zero and non-physical values.\n                \n                # Denominator for alpha fractions\n                denom = h**2 + K1 * h + K1 * K2\n                \n                # Carbonate alkalinity term: Ct * (alpha1 + 2*alpha2)\n                carb_alk_term = Ct * (K1 * h + 2 * K1 * K2) / denom\n                \n                # Water contribution to alkalinity: [OH-] - [H+]\n                water_alk_term = Kw / h - h\n                \n                return carb_alk_term + water_alk_term - Alk\n\n            # Use Brent's method to find the root. It is robust and efficient.\n            # The bracket [1e-15, 1.0] corresponds to pH range ~15 down to 0, which\n            # is a safe and comprehensive range for these geochemical systems.\n            try:\n                h_root = optimize.brentq(f, 1e-15, 1.0)\n            except ValueError:\n                # In case the root is not bracketed, which is highly unlikely for\n                # this function. Extend the search bracket for extreme cases.\n                try:\n                    h_root = optimize.brentq(f, 1e-16, 10.0)\n                except Exception as e:\n                    # Provide a diagnostic for failure\n                    print(f\"Failed to find root for case {i+1}: {e}\")\n                    results.append(np.nan)\n                    continue\n\n        # Calculate pH from the hydrogen ion concentration\n        ph = -np.log10(h_root)\n        \n        # Append the rounded result\n        results.append(round(ph, 6))\n\n    # Format the final output string as per requirements.\n    # The map(str,...) converts each float result to its string representation.\n    # The ','.join(...) concatenates them with commas.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The long-term fate of injected CO₂ and the integrity of the reservoir rock depend on the rates of mineral dissolution and precipitation reactions. These kinetic rates are highly sensitive to temperature, a dependence commonly modeled using the Arrhenius equation. This practice bridges fundamental theory with practical application by having you derive the form of the Arrhenius law from the principles of Transition State Theory (TST) . You will then use this relationship to calculate a temperature-corrected reaction rate constant for a mineral, a critical parameter in any reactive transport simulation.",
            "id": "4085907",
            "problem": "In a saline aquifer targeted for Carbon Dioxide (CO₂) geological sequestration, the proton-promoted dissolution of albite ($\\mathrm{NaAlSi_3O_8}$) in CO₂-acidified brine is modeled as a surface-controlled, first-order elementary step with respect to the reactive surface complex. Reactive transport simulations require a temperature-dependent rate constant for this step. Starting from Transition State Theory (TST), which relates the rate constant of an elementary reaction to the free energy of activation, derive the temperature dependence of the rate constant in the form consistent with the Arrhenius law under geochemically standard approximations for moderate reservoir temperature ranges. Your derivation must begin from the TST expression for the rate constant and proceed by expressing the free energy of activation in terms of enthalpy and entropy.\n\nA laboratory characterization at standard conditions reports a reference rate constant $k(T_{\\mathrm{ref}})$ for the same step at $T_{\\mathrm{ref}} = 298 \\ \\mathrm{K}$ as $k(T_{\\mathrm{ref}}) = 2.0 \\times 10^{-10} \\, \\mathrm{mol \\, m^{-2} \\, s^{-1}}$. Ab initio calculations and temperature-programmed measurements indicate an activation energy $E_{a} = 65 \\, \\mathrm{kJ \\, mol^{-1}}$ for the rate-limiting elementary step. For the reservoir, assume a uniform temperature $T_{\\mathrm{res}} = 343 \\ \\mathrm{K}$.\n\nUsing your derived temperature dependence, compute the rate constant $k(T_{\\mathrm{res}})$ at $T_{\\mathrm{res}}$. Take the universal gas constant as $R = 8.314462618 \\, \\mathrm{J \\, mol^{-1} \\, K^{-1}}$. Express the final rate constant in $\\mathrm{mol \\, m^{-2} \\, s^{-1}}$ and round your answer to four significant figures.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in established principles of chemical kinetics and geochemistry, is well-posed with sufficient and consistent data, and is expressed in objective, unambiguous language. The problem requires a two-part response: first, a derivation of the Arrhenius temperature dependence from Transition State Theory (TST), and second, a calculation of a reaction rate constant at a new temperature.\n\nPart 1: Derivation of the Arrhenius Temperature Dependence from Transition State Theory\n\nThe problem asks for a derivation of the Arrhenius-type temperature dependence of a rate constant starting from Transition State Theory (TST). The TST expression (also known as the Eyring equation) for the rate constant, $k$, of an elementary reaction is:\n$$\nk = \\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger}{RT}\\right)\n$$\nwhere $\\kappa$ is the transmission coefficient, $k_B$ is the Boltzmann constant, $h$ is the Planck constant, $T$ is the absolute temperature, $R$ is the universal gas constant, and $\\Delta G^\\ddagger$ is the Gibbs free energy of activation, which is the free energy difference between the activated complex (transition state) and the reactants.\n\nIn many applications, including the modeling of mineral dissolution kinetics, the rate constant $k$ may represent a macroscopic rate with units such as $\\mathrm{mol \\ m^{-2} \\ s^{-1}}$. This macroscopic constant is proportional to the elementary rate constant given by TST, with the proportionality factor accounting for reactant concentrations, surface site density, and other system-specific parameters. We can thus write:\n$$\nk = C \\cdot \\left(\\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger}{RT}\\right)\\right)\n$$\nwhere $C$ is a constant of proportionality. For many reactions, the transmission coefficient $\\kappa$ is assumed to be unity.\n\nThe Gibbs free energy of activation, $\\Delta G^\\ddagger$, is related to the enthalpy of activation, $\\Delta H^\\ddagger$, and the entropy of activation, $\\Delta S^\\ddagger$, by the fundamental thermodynamic relation:\n$$\n\\Delta G^\\ddagger = \\Delta H^\\ddagger - T \\Delta S^\\ddagger\n$$\nSubstituting this expression for $\\Delta G^\\ddagger$ into the TST equation yields:\n$$\nk = C \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta H^\\ddagger - T \\Delta S^\\ddagger}{RT}\\right)\n$$\nThis equation can be rearranged by separating the exponential term:\n$$\nk = C \\frac{k_B T}{h} \\exp\\left(\\frac{T \\Delta S^\\ddagger}{RT}\\right) \\exp\\left(-\\frac{\\Delta H^\\ddagger}{RT}\\right)\n$$\n$$\nk = C \\frac{k_B T}{h} \\exp\\left(\\frac{\\Delta S^\\ddagger}{R}\\right) \\exp\\left(-\\frac{\\Delta H^\\ddagger}{RT}\\right)\n$$\nThe Arrhenius equation is an empirical relationship that describes the temperature dependence of reaction rates, given by:\n$$\nk = A \\exp\\left(-\\frac{E_a}{RT}\\right)\n$$\nwhere $A$ is the pre-exponential factor (or frequency factor) and $E_a$ is the activation energy.\n\nTo reconcile the TST expression with the empirical Arrhenius form, we can group the terms in the TST-derived equation:\n$$\nk = \\left(C \\frac{k_B T}{h} \\exp\\left(\\frac{\\Delta S^\\ddagger}{R}\\right)\\right) \\exp\\left(-\\frac{\\Delta H^\\ddagger}{RT}\\right)\n$$\nComparing this to the Arrhenius equation, we can identify the pre-exponential factor $A$ and the activation energy $E_a$. The Arrhenius pre-exponential factor is:\n$$\nA(T) = C \\frac{k_B T}{h} \\exp\\left(\\frac{\\Delta S^\\ddagger}{R}\\right)\n$$\nNotice that the pre-exponential factor derived from TST is itself a function of temperature due to the linear term $T$. However, for reactions in condensed phases over moderate temperature ranges, the temperature dependence of the exponential term $\\exp(-\\Delta H^\\ddagger/RT)$ is much more significant than the linear temperature dependence of the pre-exponential factor.\n\nThe \"geochemically standard approximation\" mentioned in the problem involves treating the pre-exponential factor $A$ as a constant over the temperature range of interest. This is a valid assumption when the temperature range is not excessively large. By making this approximation, we effectively absorb the weak temperature dependence of the pre-exponential factor into a constant value. With this approximation, a direct comparison of the exponential terms leads to the identification of the empirical Arrhenius activation energy $E_a$ with the enthalpy of activation $\\Delta H^\\ddagger$:\n$$\nE_a \\approx \\Delta H^\\ddagger\n$$\nThus, under the standard approximation that the pre-exponential factor is constant with temperature, the TST expression for the rate constant takes the functional form of the Arrhenius law, $k = A \\exp(-E_a/RT)$, where $A$ is treated as a constant and $E_a$ is the experimentally determined activation energy.\n\nPart 2: Calculation of the Rate Constant at Reservoir Temperature\n\nThe derived Arrhenius equation is $k(T) = A \\exp(-E_a/RT)$. We are given values at a reference temperature $T_{\\mathrm{ref}}$ and asked to find the rate constant at a reservoir temperature $T_{\\mathrm{res}}$. We can write the Arrhenius equation for both temperatures:\n$$\nk(T_{\\mathrm{ref}}) = A \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{ref}}}\\right)\n$$\n$$\nk(T_{\\mathrm{res}}) = A \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{res}}}\\right)\n$$\nTo eliminate the unknown pre-exponential factor $A$, we take the ratio of these two equations:\n$$\n\\frac{k(T_{\\mathrm{res}})}{k(T_{\\mathrm{ref}})} = \\frac{A \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{res}}}\\right)}{A \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{ref}}}\\right)} = \\exp\\left(-\\frac{E_a}{R T_{\\mathrm{res}}} + \\frac{E_a}{R T_{\\mathrm{ref}}}\\right)\n$$\nThis simplifies to the integrated form of the Arrhenius equation:\n$$\nk(T_{\\mathrm{res}}) = k(T_{\\mathrm{ref}}) \\exp\\left[\\frac{E_a}{R} \\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T_{\\mathrm{res}}}\\right)\\right]\n$$\nNow, we substitute the given values into this equation:\n-   Reference rate constant: $k(T_{\\mathrm{ref}}) = 2.0 \\times 10^{-10} \\, \\mathrm{mol \\, m^{-2} \\, s^{-1}}$\n-   Reference temperature: $T_{\\mathrm{ref}} = 298 \\ \\mathrm{K}$\n-   Reservoir temperature: $T_{\\mathrm{res}} = 343 \\ \\mathrm{K}$\n-   Activation energy: $E_a = 65 \\ \\mathrm{kJ \\ mol^{-1}} = 65000 \\ \\mathrm{J \\ mol^{-1}}$\n-   Universal gas constant: $R = 8.314462618 \\, \\mathrm{J \\, mol^{-1} \\, K^{-1}}$\n\nFirst, calculate the argument of the exponential function:\n$$\n\\frac{E_a}{R} \\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T_{\\mathrm{res}}}\\right) = \\frac{65000 \\ \\mathrm{J \\ mol^{-1}}}{8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}} \\left(\\frac{1}{298 \\ \\mathrm{K}} - \\frac{1}{343 \\ \\mathrm{K}}\\right)\n$$\n$$\n\\approx 7817.5835 \\ \\mathrm{K} \\left(0.0033557047 \\ \\mathrm{K^{-1}} - 0.0029154519 \\ \\mathrm{K^{-1}}\\right)\n$$\n$$\n\\approx 7817.5835 \\ \\mathrm{K} \\left(0.0004402528 \\ \\mathrm{K^{-1}}\\right)\n$$\n$$\n\\approx 3.441908\n$$\nNow, compute the rate constant $k(T_{\\mathrm{res}})$:\n$$\nk(T_{\\mathrm{res}}) = (2.0 \\times 10^{-10} \\, \\mathrm{mol \\, m^{-2} \\, s^{-1}}) \\times \\exp(3.441908)\n$$\n$$\nk(T_{\\mathrm{res}}) \\approx (2.0 \\times 10^{-10} \\, \\mathrm{mol \\, m^{-2} \\, s^{-1}}) \\times 31.2476\n$$\n$$\nk(T_{\\mathrm{res}}) \\approx 6.24952 \\times 10^{-9} \\ \\mathrm{mol \\, m^{-2} \\, s^{-1}}\n$$\nRounding the final result to four significant figures as requested:\n$$\nk(T_{\\mathrm{res}}) = 6.250 \\times 10^{-9} \\ \\mathrm{mol \\, m^{-2} \\, s^{-1}}\n$$",
            "answer": "$$\\boxed{6.250 \\times 10^{-9}}$$"
        }
    ]
}