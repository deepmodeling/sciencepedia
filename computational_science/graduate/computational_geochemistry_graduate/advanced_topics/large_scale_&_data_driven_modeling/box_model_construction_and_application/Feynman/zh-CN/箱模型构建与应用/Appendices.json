{
    "hands_on_practices": [
        {
            "introduction": "任何箱式模型的基础，是对单个、充分混合储库中示踪剂浓度随时间演变的理解。本练习将引导你从质量守恒的第一性原理出发，推导一个具有恒定源（$I$）和一级去除（$k$）过程的单箱系统的瞬态解。掌握这一经典问题的解析解，可以让你深刻理解系统响应时间和趋近稳态的过程，这是地球化学建模的核心概念 。",
            "id": "4070971",
            "problem": "一个均匀混合的地球化学储库（单箱模型）代表了在恒定体积源和一级移除作用下，溶解示踪剂的浓度动态。设 $C(t)$ 表示示踪剂在时间 $t$ 时的空间均匀浓度，初始条件为 $C(0)=C_{0}$。该箱体经历一个恒定的内部体积生产（源），在没有损失的情况下，该生产会以速率 $I$ 提高浓度（$I$ 的单位是 $\\text{mol m}^{-3} \\text{s}^{-1}$），以及一个速率常数为 $k$（单位是 $\\text{s}^{-1}$）的一级移除过程（例如，清除或衰变）。\n\n假设理想混合并应用质量守恒定律（累积量等于源项减去汇项），写出关于 $C(t)$ 的质量平衡方程，并推导出满足初始条件 $C(0)=C_{0}$ 的瞬态解 $C(t)$。你的推导应从质量守恒和一级动力学的第一性原理出发，不要先验地假设解的任何特定形式。将你的最终答案表示为以 $C_{0}$、$I$、$k$ 和 $t$ 表示的闭式解析表达式。不要代入数值，最终答案中也不要包含单位。如果在推导过程中引入了任何辅助量，应在最终表达式中将其消除，以使最终答案仅依赖于 $C_{0}$、$I$、$k$ 和 $t$。最终答案应为单个表达式。",
            "solution": "该问题陈述经评估是有效的，因为它具有科学依据、适定且客观。它为计算地球化学中的一个标准初值问题提供了一个完整且一致的设置，没有任何可识别的缺陷。\n\n问题要求在一个单箱地球化学模型中推导瞬态浓度 $C(t)$。控制原理是质量守恒，即示踪剂的累积速率等于源速率减去汇速率。\n\n设 $C(t)$ 为示踪剂在时间 $t$（单位为 $\\text{s}$）时的浓度（单位为 $\\text{mol m}^{-3}$）。示踪剂浓度的累积速率由其时间导数 $\\frac{dC(t)}{dt}$ 给出。\n\n源项被指定为一个恒定的内部体积生产，其会以速率 $I$（单位为 $\\text{mol m}^{-3} \\text{s}^{-1}$）提高浓度。因此，源项就是 $I$。\n\n汇项被指定为一个速率常数为 $k$（单位为 $\\text{s}^{-1}$）的一级移除过程。一级过程意味着移除速率与浓度 $C(t)$ 成正比。因此，汇项是 $k C(t)$。\n\n应用质量守恒原理（累积 = 源 - 汇），我们可以写出该系统的控制常微分方程（ODE）：\n$$\n\\frac{dC(t)}{dt} = I - k C(t)\n$$\n这是一个一阶线性非齐次常微分方程。我们还已知初始条件 $C(0) = C_{0}$。\n\n为了在不假设解的形式的情况下解决这个初值问题，我们可以使用积分因子法。首先，我们将 ODE 重新整理成标准形式 $\\frac{dy}{dt} + p(t)y = q(t)$：\n$$\n\\frac{dC}{dt} + k C = I\n$$\n在这种形式下，我们确定 $p(t) = k$ 和 $q(t) = I$。积分因子 $\\mu(t)$ 定义为：\n$$\n\\mu(t) = \\exp\\left(\\int p(t) dt\\right)\n$$\n代入 $p(t) = k$，我们计算积分因子：\n$$\n\\mu(t) = \\exp\\left(\\int k dt\\right) = \\exp(kt)\n$$\n现在，我们将整个标准形式的 ODE 乘以积分因子 $\\mu(t)$：\n$$\n\\exp(kt) \\frac{dC}{dt} + k \\exp(kt) C = I \\exp(kt)\n$$\n根据微分的乘法法则，该方程的左边是 $C(t)$ 和积分因子 $\\mu(t)$ 乘积的导数：\n$$\n\\frac{d}{dt} \\left( C(t) \\exp(kt) \\right) = \\exp(kt) \\frac{dC}{dt} + C(t) \\frac{d}{dt}(\\exp(kt)) = \\exp(kt) \\frac{dC}{dt} + k \\exp(kt) C\n$$\n因此，我们的方程简化为：\n$$\n\\frac{d}{dt} \\left( C(t) \\exp(kt) \\right) = I \\exp(kt)\n$$\n为了求得 $C(t)$，我们对该方程两边关于时间 $t$ 进行积分：\n$$\n\\int \\frac{d}{dt} \\left( C(t) \\exp(kt) \\right) dt = \\int I \\exp(kt) dt\n$$\n左边的积分就是 $C(t) \\exp(kt)$。右边的积分是：\n$$\n\\int I \\exp(kt) dt = I \\int \\exp(kt) dt = I \\left( \\frac{1}{k} \\exp(kt) \\right) + A\n$$\n其中 $A$ 是积分常数。令两边相等，得到：\n$$\nC(t) \\exp(kt) = \\frac{I}{k} \\exp(kt) + A\n$$\n为了得到 $C(t)$ 的通解，我们将整个方程除以 $\\exp(kt)$（这等价于乘以 $\\exp(-kt)$）来分离出 $C(t)$：\n$$\nC(t) = \\frac{I}{k} + A \\exp(-kt)\n$$\n现在，我们必须使用给定的初始条件 $C(0) = C_{0}$ 来确定积分常数 $A$ 的值。我们将 $t=0$ 代入通解：\n$$\nC(0) = \\frac{I}{k} + A \\exp(-k \\cdot 0)\n$$\n$$\nC_{0} = \\frac{I}{k} + A \\exp(0) = \\frac{I}{k} + A\n$$\n解出 $A$，我们得到：\n$$\nA = C_{0} - \\frac{I}{k}\n$$\n最后，我们将这个 $A$ 的表达式代回通解中，得到满足初始条件的 $C(t)$ 的特定瞬态解：\n$$\nC(t) = \\frac{I}{k} + \\left(C_{0} - \\frac{I}{k}\\right) \\exp(-kt)\n$$\n这就是浓度 $C(t)$ 以初始浓度 $C_{0}$、源速率 $I$、移除速率常数 $k$ 和时间 $t$ 表示的闭式解析表达式。这个表达式也可以重新整理为 $C(t) = C_0 \\exp(-kt) + \\frac{I}{k}(1 - \\exp(-kt))$，这种形式清楚地显示了初始浓度的衰减贡献和源项引起的向稳态累积的贡献。然而，第一种形式是推导的直接结果。",
            "answer": "$$\\boxed{\\frac{I}{k} + \\left(C_{0} - \\frac{I}{k}\\right) \\exp(-kt)}$$"
        },
        {
            "introduction": "真实的地球化学系统通常涉及复杂的多物种反应网络。本练习将指导你从一组给定的生物地球化学反应（如硝化和反硝化作用）构建化学计量矩阵 $S$。通过构建此矩阵并验证元素和电荷守恒，你将掌握将复杂的反应系统转化为箱式模型数学框架的核心技能，这是确保模型物理真实性的关键一步 。",
            "id": "4070995",
            "problem": "考虑一个封闭、等温的沉积物孔隙水微环境的含水箱式模型，其中硝化作用和反硝化作用通过以下总反应进行，以溶解物质的形式表示，并假设电荷平衡通过氢离子明确追踪。物种向量为\n$$\n\\mathbf{x} = \\begin{pmatrix}\n\\mathrm{NH_4^+} \\\\\n\\mathrm{NO_2^-} \\\\\n\\mathrm{NO_3^-} \\\\\n\\mathrm{O_2(aq)} \\\\\n\\mathrm{H_2O} \\\\\n\\mathrm{H^+} \\\\\n\\mathrm{N_2(aq)} \\\\\n\\mathrm{CH_2O(aq)} \\\\\n\\mathrm{CO_2(aq)}\n\\end{pmatrix},\n$$\n反应集有 $3$ 列，分别对应于：\n$$\n\\begin{aligned}\nR_1:\\quad \\mathrm{NH_4^+} + 1.5\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{NO_2^-} + 2\\,\\mathrm{H^+} + \\mathrm{H_2O}, \\\\\nR_2:\\quad \\mathrm{NO_2^-} + 0.5\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{NO_3^-}, \\\\\nR_3:\\quad 4\\,\\mathrm{NO_3^-} + 5\\,\\mathrm{CH_2O(aq)} + 4\\,\\mathrm{H^+} \\rightarrow 2\\,\\mathrm{N_2(aq)} + 5\\,\\mathrm{CO_2(aq)} + 7\\,\\mathrm{H_2O}.\n\\end{aligned}\n$$\n这些总反应与水生系统中氨氧化和亚硝酸盐氧化（硝化作用）以及有机物驱动的反硝化作用的公认净化学计量一致。\n\n定义化学计量矩阵 $S \\in \\mathbb{R}^{9 \\times 3}$，使得箱中物种量 $\\mathbf{n}(t) \\in \\mathbb{R}^9$ 的质量平衡由下式给出\n$$\n\\frac{d\\mathbf{n}}{dt} = S\\,\\mathbf{v}(t),\n$$\n其中 $\\mathbf{v}(t) \\in \\mathbb{R}^3$ 是反应 $R_1$、$R_2$ 和 $R_3$ 的速率 ($\\text{mol s}^{-1}$)。$S$ 的元素对于反应物为负，对于产物为正。\n\n根据上述反应构建 $S$。然后构建元素-电荷统计矩阵 $B_{\\mathrm{NOC}} \\in \\mathbb{R}^{3 \\times 9}$，其行分别给出 $\\mathbf{x}$ 中每个物种的氮原子（$\\mathrm{N}$）数、氧原子（$\\mathrm{O}$）数和净电荷。利用化学反应中的原子守恒和电荷守恒基本定律，通过证明下式来验证 $\\mathrm{N}$、$\\mathrm{O}$ 和电荷的总量在所有反应中都是守恒的\n$$\nB_{\\mathrm{NOC}}\\,S = 0_{3 \\times 3}.\n$$\n最后，确定该网络中由 $\\mathrm{N}$、$\\mathrm{O}$ 和电荷贡献的独立守恒关系的数量；报告此数字。最终答案必须是一个实数值。不需要四舍五入，报告的数字中不应包含任何物理单位。",
            "solution": "将首先验证问题的前提，然后进行所需的构建和计算来解决该问题。\n\n### 第一步：问题验证\n\n问题提供了一组化学物种、一组化学反应、一个描述系统动力学的控制微分方程，以及需要执行的特定任务。\n\n**已知条件：**\n1.  一个物种向量 $\\mathbf{x} \\in \\mathbb{R}^9$：\n$$\n\\mathbf{x} = \\begin{pmatrix}\n\\mathrm{NH_4^+} \\\\ \\mathrm{NO_2^-} \\\\ \\mathrm{NO_3^-} \\\\ \\mathrm{O_2(aq)} \\\\ \\mathrm{H_2O} \\\\ \\mathrm{H^+} \\\\ \\mathrm{N_2(aq)} \\\\ \\mathrm{CH_2O(aq)} \\\\ \\mathrm{CO_2(aq)}\n\\end{pmatrix}\n$$\n2.  一组三个反应（$R_1$、$R_2$、$R_3$）：\n$$\n\\begin{aligned}\nR_1:\\quad \\mathrm{NH_4^+} + 1.5\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{NO_2^-} + 2\\,\\mathrm{H^+} + \\mathrm{H_2O} \\\\\nR_2:\\quad \\mathrm{NO_2^-} + 0.5\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{NO_3^-} \\\\\nR_3:\\quad 4\\,\\mathrm{NO_3^-} + 5\\,\\mathrm{CH_2O(aq)} + 4\\,\\mathrm{H^+} \\rightarrow 2\\,\\mathrm{N_2(aq)} + 5\\,\\mathrm{CO_2(aq)} + 7\\,\\mathrm{H_2O}\n\\end{aligned}\n$$\n3.  质量平衡方程：$\\frac{d\\mathbf{n}}{dt} = S\\,\\mathbf{v}(t)$，其中 $\\mathbf{n}(t)$ 是物种量，$S$ 是化学计量矩阵，$\\mathbf{v}(t)$ 是反应速率。\n4.  化学计量矩阵 $S \\in \\mathbb{R}^{9 \\times 3}$ 的定义，其元素为化学计量系数（反应物为负，产物为正）。\n5.  元素-电荷统计矩阵 $B_{\\mathrm{NOC}} \\in \\mathbb{R}^{3 \\times 9}$ 的定义，用于统计氮（$\\mathrm{N}$）、氧（$\\mathrm{O}$）和电荷。\n6.  待验证的守恒定律：$B_{\\mathrm{NOC}}\\,S = 0_{3 \\times 3}$。\n7.  最终任务：确定 $\\mathrm{N}$、$\\mathrm{O}$ 和电荷的独立守恒关系的数量。\n\n**根据标准进行验证：**\n-   **科学依据**：这些反应代表了硝化作用和反硝化作用，它们是基本的生物地球化学过程。使用化学计量矩阵和质量平衡方程是化学动力学和反应输运模拟中的标准核心方法。元素和电荷守恒原理是化学的基本定律。该问题具有科学合理性。\n-   **适定性**：问题要求根据清晰的规则构建特定的矩阵，进行矩阵乘法验证，并确定一个矩阵的秩。每个步骤都定义明确，并能得出一个唯一的、可验证的解。\n-   **客观性**：问题以精确、定量和无偏见的语言陈述。\n\n**结论：**\n该问题有效。它是一个计算地球化学领域中适定且科学合理的问题。\n\n### 第二步：求解\n\n**化学计量矩阵 $S$ 的构建**\n\n化学计量矩阵 $S$ 的维度为 $9 \\times 3$。行对应于向量 $\\mathbf{x}$ 中的 $9$ 个物种，列对应于 $3$ 个反应。元素 $S_{ij}$ 是物种 $i$ 在反应 $j$ 中的化学计量系数。反应物的系数为负，产物的系数为正。\n\n物种排序如下：$1: \\mathrm{NH_4^+}$，$2: \\mathrm{NO_2^-}$，$3: \\mathrm{NO_3^-}$，$4: \\mathrm{O_2(aq)}$，$5: \\mathrm{H_2O}$，$6: \\mathrm{H^+}$，$7: \\mathrm{N_2(aq)}$，$8: \\mathrm{CH_2O(aq)}$，$9: \\mathrm{CO_2(aq)}$。\n\n对于 $R_1: \\mathrm{NH_4^+} + 1.5\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{NO_2^-} + 2\\,\\mathrm{H^+} + \\mathrm{H_2O}$：\n系数为：$\\mathrm{NH_4^+}$ 为 $-1$，$\\mathrm{O_2(aq)}$ 为 $-1.5$，$\\mathrm{NO_2^-}$ 为 $+1$，$\\mathrm{H^+}$ 为 $+2$，$\\mathrm{H_2O}$ 为 $+1$。$S$ 的第一列是 $\\begin{pmatrix} -1  \\\\ 1  \\\\ 0  \\\\ -1.5  \\\\ 1  \\\\ 2  \\\\ 0  \\\\ 0  \\\\ 0 \\end{pmatrix}$。\n\n对于 $R_2: \\mathrm{NO_2^-} + 0.5\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{NO_3^-}$：\n系数为：$\\mathrm{NO_2^-}$ 为 $-1$，$\\mathrm{O_2(aq)}$ 为 $-0.5$，$\\mathrm{NO_3^-}$ 为 $+1$。$S$ 的第二列是 $\\begin{pmatrix} 0  \\\\ -1  \\\\ 1  \\\\ -0.5  \\\\ 0  \\\\ 0  \\\\ 0  \\\\ 0  \\\\ 0 \\end{pmatrix}$。\n\n对于 $R_3: 4\\,\\mathrm{NO_3^-} + 5\\,\\mathrm{CH_2O(aq)} + 4\\,\\mathrm{H^+} \\rightarrow 2\\,\\mathrm{N_2(aq)} + 5\\,\\mathrm{CO_2(aq)} + 7\\,\\mathrm{H_2O}$：\n系数为：$\\mathrm{NO_3^-}$ 为 $-4$，$\\mathrm{CH_2O(aq)}$ 为 $-5$，$\\mathrm{H^+}$ 为 $-4$，$\\mathrm{N_2(aq)}$ 为 $+2$，$\\mathrm{CO_2(aq)}$ 为 $+5$，$\\mathrm{H_2O}$ 为 $+7$。$S$ 的第三列是 $\\begin{pmatrix} 0  \\\\ 0  \\\\ -4  \\\\ 0  \\\\ 7  \\\\ -4  \\\\ 2  \\\\ -5  \\\\ 5 \\end{pmatrix}$。\n\n合并这些列得到矩阵 $S$：\n$$\nS = \\begin{pmatrix}\n-1  & 0  & 0 \\\\\n1  & -1  & 0 \\\\\n0  & 1  & -4 \\\\\n-1.5  & -0.5  & 0 \\\\\n1  & 0  & 7 \\\\\n2  & 0  & -4 \\\\\n0  & 0  & 2 \\\\\n0  & 0  & -5 \\\\\n0  & 0  & 5\n\\end{pmatrix}\n$$\n\n**元素-电荷统计矩阵 $B_{\\mathrm{NOC}}$ 的构建**\n\n矩阵 $B_{\\mathrm{NOC}}$ 的维度为 $3 \\times 9$。行分别表示氮原子（$\\mathrm{N}$）数、氧原子（$\\mathrm{O}$）数和净电荷。列对应于 $9$ 个物种。\n\n物种为：$\\mathrm{NH_4^+}$、$\\mathrm{NO_2^-}$、$\\mathrm{NO_3^-}$、$\\mathrm{O_2}$、$\\mathrm{H_2O}$、$\\mathrm{H^+}$、$\\mathrm{N_2}$、$\\mathrm{CH_2O}$、$\\mathrm{CO_2}$。\n\n第 1 行（氮，$\\mathrm{N}$）：\n$\\begin{pmatrix} 1  & 1  & 1  & 0  & 0  & 0  & 2  & 0  & 0 \\end{pmatrix}$\n\n第 2 行（氧，$\\mathrm{O}$）：\n$\\begin{pmatrix} 0  & 2  & 3  & 2  & 1  & 0  & 0  & 1  & 2 \\end{pmatrix}$\n\n第 3 行（电荷）：\n$\\begin{pmatrix} 1  & -1  & -1  & 0  & 0  & 1  & 0  & 0  & 0 \\end{pmatrix}$\n\n合并这些行得到矩阵 $B_{\\mathrm{NOC}}$：\n$$\nB_{\\mathrm{NOC}} = \\begin{pmatrix}\n1  & 1  & 1  & 0  & 0  & 0  & 2  & 0  & 0 \\\\\n0  & 2  & 3  & 2  & 1  & 0  & 0  & 1  & 2 \\\\\n1  & -1  & -1  & 0  & 0  & 1  & 0  & 0  & 0\n\\end{pmatrix}\n$$\n\n**守恒定律的验证**\n\n我们必须验证 $B_{\\mathrm{NOC}}\\,S = 0_{3 \\times 3}$。这等同于检查在三个反应中的每一个反应中，$\\mathrm{N}$ 原子、$\\mathrm{O}$ 原子和净电荷的总数是否守恒。乘积矩阵 $C = B_{\\mathrm{NOC}}\\,S$ 的计算如下：\n\n$$\nC = \\begin{pmatrix}\n1  & 1  & 1  & 0  & 0  & 0  & 2  & 0  & 0 \\\\\n0  & 2  & 3  & 2  & 1  & 0  & 0  & 1  & 2 \\\\\n1  & -1  & -1  & 0  & 0  & 1  & 0  & 0  & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n-1  & 0  & 0 \\\\\n1  & -1  & 0 \\\\\n0  & 1  & -4 \\\\\n-1.5  & -0.5  & 0 \\\\\n1  & 0  & 7 \\\\\n2  & 0  & -4 \\\\\n0  & 0  & 2 \\\\\n0  & 0  & -5 \\\\\n0  & 0  & 5\n\\end{pmatrix}\n$$\n\n我们来计算 $C$ 的元素：\n$C_{11} = (1)(-1) + (1)(1) = 0$\n$C_{12} = (1)(-1) + (1)(1) = 0$\n$C_{13} = (1)(-4) + (2)(2) = 0$\n\n$C_{21} = (2)(1) + (2)(-1.5) + (1)(1) = 2 - 3 + 1 = 0$\n$C_{22} = (2)(-1) + (3)(1) + (2)(-0.5) = -2 + 3 - 1 = 0$\n$C_{23} = (3)(-4) + (1)(7) + (1)(-5) + (2)(5) = -12 + 7 - 5 + 10 = 0$\n\n$C_{31} = (1)(-1) + (-1)(1) + (1)(2) = -1 - 1 + 2 = 0$\n$C_{32} = (-1)(-1) + (-1)(1) = 1 - 1 = 0$\n$C_{33} = (-1)(-4) + (1)(-4) = 4 - 4 = 0$\n\n因此，乘积是零矩阵：\n$$\nB_{\\mathrm{NOC}}\\,S = \\begin{pmatrix} 0  & 0  & 0 \\\\ 0  & 0  & 0 \\\\ 0  & 0  & 0 \\end{pmatrix} = 0_{3 \\times 3}\n$$\n守恒定律已验证。\n\n**独立守恒关系数量的确定**\n\n独立守恒关系的数量由矩阵 $B_{\\mathrm{NOC}}$ 的秩给出，即线性无关行的数量。我们检查 $B_{\\mathrm{NOC}}$ 的行是否线性无关。设各行为 $\\mathbf{r}_1$、$\\mathbf{r}_2$ 和 $\\mathbf{r}_3$。我们寻求方程 $c_1 \\mathbf{r}_1 + c_2 \\mathbf{r}_2 + c_3 \\mathbf{r}_3 = \\mathbf{0}$ 的非平凡解，其中 $\\mathbf{0}$ 是 $\\mathbb{R}^9$ 中的零向量。\n\n让我们写出向量分量的方程组：\n$$\nB_{\\mathrm{NOC}}^T \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n我们可以检查 $B_{\\mathrm{NOC}}$ 的特定列来约束系数 $c_i$。\n第 4 列（对于物种 $\\mathrm{O_2(aq)}$）：$c_1(0) + c_2(2) + c_3(0) = 0 \\implies 2c_2 = 0 \\implies c_2 = 0$。\n第 6 列（对于物种 $\\mathrm{H^+}$）：$c_1(0) + c_2(0) + c_3(1) = 0 \\implies c_3 = 0$。\n将 $c_2=0$ 和 $c_3=0$ 代回主方程，得到 $c_1 \\mathbf{r}_1 = \\mathbf{0}$。由于 $\\mathbf{r}_1$ 不是零向量，这意味着 $c_1 = 0$。\n\n唯一的解是 $c_1=c_2=c_3=0$。这证明了 $B_{\\mathrm{NOC}}$ 的行是线性无关的。\n一个矩阵的秩是其线性无关的行（或列）的数量。由于有 $3$ 个线性无关的行，$B_{\\mathrm{NOC}}$ 的秩为 $3$。\n\n因此，由氮、氧和电荷贡献的独立守恒关系的数量是 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "许多自然系统是动态变化的，其物理边界或体积并非恒定。本练习将箱式模型的应用推向一个更高级的场景：一个因水量消耗而体积随时间变化的湖泊。通过推导和求解这种移动边界问题的控制方程，你将学会如何为湖泊水位下降或冰川融化等动态环境场景建模，并体会到数值方法在解决复杂地球化学问题中的强大作用 。",
            "id": "4071004",
            "problem": "考虑一个表示为箱室的单一、混合均匀的湖泊，其体积因水位下降而随时间变化。湖中的溶质浓度 $C(t)$ 根据应用于溶质的质量守恒定律演变，而湖泊体积 $V(t)$ 是一个外部施加的函数。目标是构建并应用一个箱室模型，以分析在水位下降期间，施加的移动边界（变化的体积）对浓度动态的影响。\n\n您必须从以下基本原理出发：\n- 溶质的质量守恒：湖中溶质质量的时间变化率等于输入的溶质质量通量减去输出的溶质质量通量，再减去由一级反应引起的内部损失。\n- 溶质质量的定义：$M(t) = C(t)\\,V(t)$。\n\n假设：\n- 湖泊体积由 $V(t) = V_0 - \\alpha t$ 给出，其中 $V_0 > 0$ 是初始体积，$\\alpha \\ge 0$ 是一个恒定的水位下降速率，$t$ 是时间。将 $V(t)$ 视为一个给定的函数（移动边界）。\n- 存在一个恒定的体积入流 $Q_{\\mathrm{in}}$，其携带的溶质浓度为 $C_{\\mathrm{in}}$。\n- 存在一个恒定的体积出流 $Q_{\\mathrm{out}}$，其以湖泊的瞬时浓度 $C(t)$ 输送溶质。\n- 溶质在湖中经历一级去除反应，其速率系数为 $k$。\n- 初始浓度为 $C(0) = C_0$。\n- 所有量在箱室（混合均匀的湖泊）内空间上是均匀的。\n\n任务 1. 使用质量守恒定律和定义 $M(t) = C(t)\\,V(t)$，推导出关于 $C(t)$ 的常微分方程 (ODE)，该方程应明确包含移动边界 $V(t)$ 及其时间导数 $dV/dt$ 的影响。\n\n任务 2. 实现一个程序，该程序对推导出的 ODE 从 $t=0$ 到指定的最终时间 $T$ 进行数值积分，并为下文测试套件中的每个参数集返回最终浓度 $C(T)$。您的数值方法应与推导出的 ODE 一致，并能处理时变的 $V(t)$ 和 $dV/dt$。\n\n必须遵守物理单位：\n- 体积单位 $\\text{m}^3$。\n- 流量单位 $\\text{m}^3/\\text{s}$。\n- 时间单位 $\\text{s}$。\n- 浓度单位 $\\text{mol}/\\text{m}^3$。\n- 反应速率系数单位 $\\text{s}^{-1}$。\n\n报告每个最终浓度 $C(T)$，单位为 $\\text{mol}/\\text{m}^3$，四舍五入到六位小数。\n\n测试套件。对于每种情况，确保对于所有 $t \\in [0,T]$ 都有 $V(t) > 0$：\n1. 情况 A (中等程度的水位下降，有入流、出流和反应)：\n   - $V_0 = 1.0\\times 10^7\\,\\text{m}^3$, $\\alpha = 5.0\\,\\text{m}^3/\\text{s}$, $Q_{\\mathrm{in}} = 2.0\\,\\text{m}^3/\\text{s}$, $C_{\\mathrm{in}} = 0.2\\,\\text{mol}/\\text{m}^3$, $Q_{\\mathrm{out}} = 3.0\\,\\text{m}^3/\\text{s}$, $k = 1.0\\times 10^{-7}\\,\\text{s}^{-1}$, $C_0 = 0.1\\,\\text{mol}/\\text{m}^3$, $T = 1.0\\times 10^6\\,\\text{s}$。\n2. 情况 B (缓慢的水位下降，无反应)：\n   - $V_0 = 8.0\\times 10^6\\,\\text{m}^3$, $\\alpha = 1.0\\,\\text{m}^3/\\text{s}$, $Q_{\\mathrm{in}} = 5.0\\,\\text{m}^3/\\text{s}$, $C_{\\mathrm{in}} = 0.05\\,\\text{mol}/\\text{m}^3$, $Q_{\\mathrm{out}} = 4.0\\,\\text{m}^3/\\text{s}$, $k = 0.0\\,\\text{s}^{-1}$, $C_0 = 0.02\\,\\text{mol}/\\text{m}^3$, $T = 8.0\\times 10^5\\,\\text{s}$。\n3. 情况 C (纯粹的水位下降，有反应，无平流通量)：\n   - $V_0 = 5.0\\times 10^6\\,\\text{m}^3$, $\\alpha = 2.0\\,\\text{m}^3/\\text{s}$, $Q_{\\mathrm{in}} = 0.0\\,\\text{m}^3/\\text{s}$, $C_{\\mathrm{in}} = 0.0\\,\\text{mol}/\\text{m}^3$, $Q_{\\mathrm{out}} = 0.0\\,\\text{m}^3/\\text{s}$, $k = 5.0\\times 10^{-7}\\,\\text{s}^{-1}$, $C_0 = 0.05\\,\\text{mol}/\\text{m}^3$, $T = 1.0\\times 10^6\\,\\text{s}$。\n4. 情况 D (无移动边界，固定体积基线)：\n   - $V_0 = 4.0\\times 10^6\\,\\text{m}^3$, $\\alpha = 0.0\\,\\text{m}^3/\\text{s}$, $Q_{\\mathrm{in}} = 1.0\\,\\text{m}^3/\\text{s}$, $C_{\\mathrm{in}} = 0.1\\,\\text{mol}/\\text{m}^3$, $Q_{\\mathrm{out}} = 1.0\\,\\text{m}^3/\\text{s}$, $k = 3.0\\times 10^{-7}\\,\\text{s}^{-1}$, $C_0 = 0.1\\,\\text{mol}/\\text{m}^3$, $T = 5.0\\times 10^5\\,\\text{s}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按情况 A–D 的顺序列出结果，例如 `[`$c_A$`,`$c_B$`,`$c_C$`,`$c_D$`]`，其中每个 $c_i$ 是相应情况的 $C(T)$，四舍五入到六位小数。不应打印任何其他文本。",
            "solution": "该问题要求推导并数值求解一个常微分方程 (ODE)，该方程描述了一个混合均匀的湖泊中溶质浓度 $C(t)$ 的变化，而湖泊的体积 $V(t)$ 随时间线性变化。\n\n**任务 1：控制性常微分方程的推导**\n\n推导始于湖中溶质的质量守恒基本原理，湖泊被视为单个控制体积或“箱室”。该原理指出，体积内溶质总质量 $M(t)$ 的时间变化率等于质量流入速率减去质量流出速率，再减去由化学反应引起的内部损失速率。\n\n这可以写成：\n$$ \\frac{\\mathrm{d}M}{\\mathrm{d}t} = (\\text{Mass Flux In}) - (\\text{Mass Flux Out}) - (\\text{Reaction Loss Rate}) $$\n\n各项根据问题陈述定义如下：\n- 溶质总质量为 $M(t) = C(t)V(t)$，其中 $C(t)$ 是溶质浓度，$V(t)$ 是湖泊体积。\n- 质量流入是由于体积入流 $Q_{\\mathrm{in}}$，其溶质浓度恒为 $C_{\\mathrm{in}}$。因此，质量流入通量 $= Q_{\\mathrm{in}} C_{\\mathrm{in}}$。\n- 质量流出是由于体积出流 $Q_{\\mathrm{out}}$，其携带湖泊瞬时浓度 $C(t)$ 的溶质。因此，质量流出通量 $= Q_{\\mathrm{out}} C(t)$。\n- 溶质经历一级衰减，速率系数为 $k$。损失速率与湖中溶质总质量 $M(t)$ 成正比。因此，反应损失速率 $= k M(t) = k C(t) V(t)$。\n\n将这些项代入质量平衡方程，得到：\n$$ \\frac{\\mathrm{d}M}{\\mathrm{d}t} = Q_{\\mathrm{in}} C_{\\mathrm{in}} - Q_{\\mathrm{out}} C(t) - k V(t) C(t) $$\n\n为了获得关于浓度 $C(t)$ 的方程，我们将 $M(t) = C(t)V(t)$ 代入左侧，并应用乘积法则进行微分：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left[ C(t) V(t) \\right] = V(t) \\frac{\\mathrm{d}C}{\\mathrm{d}t} + C(t) \\frac{\\mathrm{d}V}{\\mathrm{d}t} $$\n\n令 $\\frac{\\mathrm{d}M}{\\mathrm{d}t}$ 的两个表达式相等：\n$$ V(t) \\frac{\\mathrm{d}C}{\\mathrm{d}t} + C(t) \\frac{\\mathrm{d}V}{\\mathrm{d}t} = Q_{\\mathrm{in}} C_{\\mathrm{in}} - Q_{\\mathrm{out}} C(t) - k V(t) C(t) $$\n\n现在，我们求解浓度的时间导数 $\\frac{\\mathrm{d}C}{\\mathrm{d}t}$：\n$$ V(t) \\frac{\\mathrm{d}C}{\\mathrm{d}t} = Q_{\\mathrm{in}} C_{\\mathrm{in}} - Q_{\\mathrm{out}} C(t) - k V(t) C(t) - C(t) \\frac{\\mathrm{d}V}{\\mathrm{d}t} $$\n\n除以 $V(t)$（在模拟期间指定为正值）并对包含 $C(t)$ 的项进行分组：\n$$ \\frac{\\mathrm{d}C}{\\mathrm{d}t} = \\frac{Q_{\\mathrm{in}} C_{\\mathrm{in}}}{V(t)} - \\left( \\frac{Q_{\\mathrm{out}}}{V(t)} + k + \\frac{1}{V(t)} \\frac{\\mathrm{d}V}{\\mathrm{d}t} \\right) C(t) $$\n\n问题指定湖泊体积的函数为 $V(t) = V_0 - \\alpha t$，其中 $V_0$ 是 $t=0$ 时的初始体积，$\\alpha$ 是恒定的水位下降速率。因此，体积的时间导数为 $\\frac{\\mathrm{d}V}{\\mathrm{d}t} = -\\alpha$。\n\n将 $V(t)$ 和 $\\frac{\\mathrm{d}V}{\\mathrm{d}t}$ 代入 ODE，得到最终的控制方程：\n$$ \\frac{\\mathrm{d}C}{\\mathrm{d}t} = \\frac{Q_{\\mathrm{in}} C_{\\mathrm{in}}}{V_0 - \\alpha t} - \\left( \\frac{Q_{\\mathrm{out}}}{V_0 - \\alpha t} + k + \\frac{-\\alpha}{V_0 - \\alpha t} \\right) C(t) $$\n$$ \\frac{\\mathrm{d}C}{\\mathrm{d}t} = \\frac{Q_{\\mathrm{in}} C_{\\mathrm{in}}}{V_0 - \\alpha t} - \\left( \\frac{Q_{\\mathrm{out}} - \\alpha}{V_0 - \\alpha t} + k \\right) C(t) $$\n\n这是一个关于 $C(t)$ 的一阶线性非齐次常微分方程。包含 $\\alpha$ 的项明确说明了“移动边界”（变化的体积）对浓度动态的影响，这与平流出流 $Q_{\\mathrm{out}}$ 是不同的。\n\n**任务 2：数值实现**\n\n推导出的 ODE 形式为 $\\frac{\\mathrm{d}C}{\\mathrm{d}t} = f(t, C)$，其中：\n$$ f(t, C) = \\frac{Q_{\\mathrm{in}} C_{\\mathrm{in}}}{V_0 - \\alpha t} - \\left( \\frac{Q_{\\mathrm{out}} - \\alpha}{V_0 - \\alpha t} + k \\right) C $$\n给定初始条件 $C(0) = C_0$，可以对该初值问题进行数值求解，以求得最终时间 $T$ 时的浓度 $C(T)$。\n\n算法设计如下：\n1.  对于每个测试用例，定义所有物理参数：$V_0$、$\\alpha$、$Q_{\\mathrm{in}}$、$C_{\\mathrm{in}}$、$Q_{\\mathrm{out}}$、$k$、$C_0$ 和 $T$。\n2.  实现一个表示 ODE 右侧的函数 $f(t, C)$。该函数将时间 $t$ 和浓度 $C$ 作为参数，并使用特定情况的参数返回 $\\frac{\\mathrm{d}C}{\\mathrm{d}t}$ 的值。\n3.  使用一个鲁棒的数值 ODE 求解器。Python 的 `scipy.integrate` 库中的 `solve_ivp` 函数非常适合此任务。它采用自适应步长的龙格-库塔方法（例如默认的 `RK45`）来在指定的时间区间内高效、准确地对 ODE 进行积分。\n4.  使用 ODE 函数、时间区间 $[0, T]$ 和初始条件 $[C_0]$ 来调用求解器。我们指示求解器仅返回最终时间 $T$ 的解，以提高效率。\n5.  从求解器的输出中提取最终浓度 $C(T)$。\n6.  按要求将结果四舍五入到六位小数。\n7.  对所有测试用例重复此过程，并将结果收集并格式化为指定的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the box model ODE for solute concentration in a lake with changing volume\n    for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Parameters: V0, alpha, Qin, Cin, Qout, k, C0, T\n    test_cases = [\n        # Case A (moderate drawdown with inflow, outflow, and reaction)\n        (1.0e7, 5.0, 2.0, 0.2, 3.0, 1.0e-7, 0.1, 1.0e6),\n        # Case B (slow drawdown, no reaction)\n        (8.0e6, 1.0, 5.0, 0.05, 4.0, 0.0, 0.02, 8.0e5),\n        # Case C (pure drawdown with reaction, no advective fluxes)\n        (5.0e6, 2.0, 0.0, 0.0, 0.0, 5.0e-7, 0.05, 1.0e6),\n        # Case D (no moving boundary, fixed volume baseline)\n        (4.0e6, 0.0, 1.0, 0.1, 1.0, 3.0e-7, 0.1, 5.0e5),\n    ]\n\n    results = []\n    for case in test_cases:\n        V0, alpha, Qin, Cin, Qout, k, C0, T = case\n\n        def ode_rhs(t, y):\n            \"\"\"\n            Right-hand side of the ODE: dC/dt = f(t, C).\n            The solver passes y as a 1-element array.\n            \"\"\"\n            C = y[0]\n            \n            # Current lake volume V(t)\n            Vt = V0 - alpha * t\n\n            # The problem statement guarantees V(t) > 0 for t in [0, T], so no\n            # check for division by zero is strictly necessary.\n            \n            # Derived ODE:\n            # dC/dt = (Qin*Cin)/V(t) - ( (Qout - alpha)/V(t) + k ) * C(t)\n            dC_dt = (Qin * Cin) / Vt - ((Qout - alpha) / Vt + k) * C\n            \n            return [dC_dt]\n\n        # Define the time span for integration\n        t_span = (0, T)\n        \n        # Define the initial condition\n        y0 = [C0]\n        \n        # Numerically solve the initial value problem.\n        # We use t_eval=[T] to instruct the solver to only return the solution\n        # at the final time point, which is efficient.\n        solution = solve_ivp(ode_rhs, t_span, y0, t_eval=[T], method='RK45')\n        \n        # Extract the final concentration C(T) from the solution object\n        C_T = solution.y[0, 0]\n        \n        # Append the rounded result to the list\n        results.append(f\"{C_T:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}