{
    "hands_on_practices": [
        {
            "introduction": "掌握任何理论的第一步都是应用其核心方程。本练习将指导您完成特定离子相互作用理论（SIT）的基本计算，确保您能够准确地计算混合电解质溶液中单个离子的活度系数。正确计算离子强度、Debye–Hückel 项以及特定相互作用项的总和，是进行更复杂地球化学模拟的基础 ()。",
            "id": "4099305",
            "problem": "在温度$T=298.15\\,\\mathrm{K}$下，一种电解质水溶液混合物含有盐$\\mathrm{NaCl}$和$\\mathrm{CaCl_2}$，其质量摩尔浓度分别为$m(\\mathrm{NaCl})=0.7\\,\\mathrm{mol\\,kg^{-1}}$和$m(\\mathrm{CaCl_2})=0.05\\,\\mathrm{mol\\,kg^{-1}}$。假设完全解离成离子$\\mathrm{Na^+}$、$\\mathrm{Ca^{2+}}$和$\\mathrm{Cl^-}$，并将溶剂视为标准条件下的水。使用与Debye–Hückel理论一致的长程静电非理想性框架，结合由二元相互作用系数参数化的短程特定离子相互作用（如特定离子相互作用理论(SIT)），计算该溶液中钙的质量摩尔活度系数的以10为底的对数，即$\\log_{10}\\gamma_{\\mathrm{Ca^{2+}}}$。\n\n采用在$T=298.15\\,\\mathrm{K}$下，质量摩尔浓度标度下的Debye–Hückel项的以下参考常数：$A=0.509$ 和 $b=1.5$。所需的SIT二元相互作用系数为 $\\varepsilon_{\\mathrm{Ca^{2+},Cl^-}}=0.12$ 和 $\\varepsilon_{\\mathrm{Ca^{2+},Na^+}}=-0.02$。\n\n您的答案必须是代表$\\log_{10}\\gamma_{\\mathrm{Ca^{2+}}}$的单个实数。将最终答案四舍五入至三位有效数字。无需报告单位。",
            "solution": "该问题是有效的，因为它在科学上基于溶液化学原理，提法明确，数据充分且一致，并使用客观、正式的语言表述。因此，我们可以继续进行求解。\n\n该问题要求使用特定离子相互作用理论(SIT)计算混合电解质溶液中钙离子的质量摩尔活度系数的以10为底的对数，即$\\log_{10}\\gamma_{\\mathrm{Ca^{2+}}}$。在含有多种阴离子$a_j$和阳离子$k_j$的溶液中，电荷为$z_c$的阳离子$c$的活度系数的通用SIT方程由下式给出：\n$$ \\log_{10}\\gamma_c = -z_c^2 D + \\sum_{a_j} \\varepsilon_{(c, a_j)} m_{a_j} + \\sum_{k_j \\neq c} \\varepsilon_{(c, k_j)} m_{k_j} $$\n其中$D$是Debye–Hückel项，$m$代表相应离子的质量摩尔浓度，$\\varepsilon$是特定离子相互作用系数。Debye–Hückel项定义为：\n$$ D = \\frac{A \\sqrt{I_m}}{1 + b \\sqrt{I_m}} $$\n这里，$A$和$b$是依赖于温度的常数，$I_m$是质量摩尔浓度标度下的离子强度。\n\n对于给定溶液中含有离子$\\mathrm{Na^+}$和$\\mathrm{Cl^-}$的特定阳离子$\\mathrm{Ca^{2+}}$，方程变为：\n$$ \\log_{10}\\gamma_{\\mathrm{Ca^{2+}}} = -z_{\\mathrm{Ca^{2+}}}^2 \\frac{A \\sqrt{I_m}}{1 + b \\sqrt{I_m}} + \\varepsilon_{(\\mathrm{Ca^{2+}}, \\mathrm{Cl^-})} m_{\\mathrm{Cl^-}} + \\varepsilon_{(\\mathrm{Ca^{2+}}, \\mathrm{Na^+})} m_{\\mathrm{Na^+}} $$\n钙离子的电荷为$z_{\\mathrm{Ca^{2+}}} = +2$。\n\n第一步是确定溶液中所有单个离子的质量摩尔浓度。假设盐$\\mathrm{NaCl}$和$\\mathrm{CaCl_2}$完全解离。\n\n对于质量摩尔浓度为$m(\\mathrm{NaCl}) = 0.7\\,\\mathrm{mol\\,kg^{-1}}$的$\\mathrm{NaCl}$：\n$$ \\mathrm{NaCl} \\rightarrow \\mathrm{Na^+} + \\mathrm{Cl^-} $$\n这贡献了$0.7\\,\\mathrm{mol\\,kg^{-1}}$的$\\mathrm{Na^+}$和$0.7\\,\\mathrm{mol\\,kg^{-1}}$的$\\mathrm{Cl^-}$。\n\n对于质量摩尔浓度为$m(\\mathrm{CaCl_2}) = 0.05\\,\\mathrm{mol\\,kg^{-1}}$的$\\mathrm{CaCl_2}$：\n$$ \\mathrm{CaCl_2} \\rightarrow \\mathrm{Ca^{2+}} + 2\\mathrm{Cl^-} $$\n这贡献了$0.05\\,\\mathrm{mol\\,kg^{-1}}$的$\\mathrm{Ca^{2+}}$和$2 \\times 0.05 = 0.1\\,\\mathrm{mol\\,kg^{-1}}$的$\\mathrm{Cl^-}$。\n\n离子的总质量摩尔浓度为：\n$m_{\\mathrm{Na^+}} = 0.7\\,\\mathrm{mol\\,kg^{-1}}$\n$m_{\\mathrm{Ca^{2+}}} = 0.05\\,\\mathrm{mol\\,kg^{-1}}$\n$m_{\\mathrm{Cl^-}} = 0.7 + 0.1 = 0.8\\,\\mathrm{mol\\,kg^{-1}}$\n\n下一步是计算溶液的离子强度$I_m$，其定义为：\n$$ I_m = \\frac{1}{2} \\sum_i m_i z_i^2 $$\n其中求和遍历溶液中所有离子$i$。\n$$ I_m = \\frac{1}{2} \\left( m_{\\mathrm{Na^+}} z_{\\mathrm{Na^+}}^2 + m_{\\mathrm{Ca^{2+}}} z_{\\mathrm{Ca^{2+}}}^2 + m_{\\mathrm{Cl^-}} z_{\\mathrm{Cl^-}}^2 \\right) $$\n代入数值：\n$$ I_m = \\frac{1}{2} \\left[ (0.7)(+1)^2 + (0.05)(+2)^2 + (0.8)(-1)^2 \\right] $$\n$$ I_m = \\frac{1}{2} [ 0.7 + (0.05)(4) + 0.8 ] $$\n$$ I_m = \\frac{1}{2} [ 0.7 + 0.2 + 0.8 ] $$\n$$ I_m = \\frac{1}{2} (1.7) = 0.85\\,\\mathrm{mol\\,kg^{-1}} $$\n\n现在我们可以计算Debye–Hückel项。给定$A=0.509$和$b=1.5$。\n该项为$-z_{\\mathrm{Ca^{2+}}}^2 D = -(2)^2 \\frac{A \\sqrt{I_m}}{1 + b \\sqrt{I_m}}$。\n$$ -(2)^2 \\frac{(0.509) \\sqrt{0.85}}{1 + (1.5) \\sqrt{0.85}} $$\n我们来计算该表达式：\n$\\sqrt{0.85} \\approx 0.921954$\n$$ -4 \\times \\frac{(0.509) \\times (0.921954)}{1 + (1.5) \\times (0.921954)} \\approx -4 \\times \\frac{0.469275}{1 + 1.382931} \\approx -4 \\times \\frac{0.469275}{2.382931} \\approx -4 \\times 0.196932 \\approx -0.787728 $$\n\n接下来，我们使用给定的系数$\\varepsilon_{\\mathrm{Ca^{2+},Cl^-}}=0.12$和$\\varepsilon_{\\mathrm{Ca^{2+},Na^+}}=-0.02$来计算特定相互作用项。\n与氯离子的相互作用项为：\n$$ \\varepsilon_{(\\mathrm{Ca^{2+}}, \\mathrm{Cl^-})} m_{\\mathrm{Cl^-}} = (0.12) \\times (0.8) = 0.096 $$\n与钠离子的相互作用项为：\n$$ \\varepsilon_{(\\mathrm{Ca^{2+}}, \\mathrm{Na^+})} m_{\\mathrm{Na^+}} = (-0.02) \\times (0.7) = -0.014 $$\n\n最后，我们将所有项相加求得$\\log_{10}\\gamma_{\\mathrm{Ca^{2+}}}$。\n$$ \\log_{10}\\gamma_{\\mathrm{Ca^{2+}}} \\approx -0.787728 + 0.096 - 0.014 $$\n$$ \\log_{10}\\gamma_{\\mathrm{Ca^{2+}}} \\approx -0.787728 + 0.082 $$\n$$ \\log_{10}\\gamma_{\\mathrm{Ca^{2+}}} \\approx -0.705728 $$\n\n问题要求答案四舍五入至三位有效数字。\n值$-0.705728$四舍五入至三位有效数字为$-0.706$。",
            "answer": "$$\\boxed{-0.706}$$"
        },
        {
            "introduction": "在掌握了基本计算之后，理解为何以及何时使用 SIT 模型至关重要。本练习通过将 SIT 与经典的扩展 Debye–Hückel (EDH) 模型进行直接比较，来探究这一问题。通过计算一个地球化学相关反应的平衡常数在不同模型下的变化，您将亲身体会到包含特定离子相互作用项对热力学预测的实际影响 ()。",
            "id": "4099222",
            "problem": "在 $25\\,^\\circ\\mathrm{C}$、背景电解质氯化钠质量摩尔浓度 $m_{\\mathrm{NaCl}} = 1.0\\,\\mathrm{mol\\,kg^{-1}}$（离子强度 $I = 1.0$）的条件下，研究了一个二价阳离子和一个二价阴离子之间的水相反应：$M^{2+} + L^{2-} \\rightleftharpoons ML^{0}$。目标是比较在此离子强度下，使用特定离子相互作用理论 (SIT) 和扩展的 Debye–Hückel 框架计算得到的平衡常数校正值的大小。采用以下在 $25\\,^\\circ\\mathrm{C}$ 时水的典型物理参数值：Debye–Hückel 常数 $A = 0.51$（以10为底），离子尺寸参数常数 $B = 0.33\\,\\mathrm{\\AA^{-1}}$，阳离子尺寸 $a_{M^{2+}} = 6.0\\,\\mathrm{\\AA}$，阴离子尺寸 $a_{L^{2-}} = 9.0\\,\\mathrm{\\AA}$。对于 SIT，只考虑与背景电解质之间的主要特定离子相互作用：$\\varepsilon(M^{2+}, \\mathrm{Cl}^{-}) = 0.15$ 和 $\\varepsilon(\\mathrm{Na}^{+}, L^{2-}) = 0.05$。假设中性络合物的非理想性可以忽略不计，因此 $\\gamma_{ML^{0}} \\approx 1$。使用特定离子相互作用理论 (SIT) 和扩展的 Debye–Hückel 框架的公认形式，计算比值\n$$R = \\frac{\\Delta \\log_{10} K_{\\mathrm{SIT}}(I)}{\\Delta \\log_{10} K_{\\mathrm{EDH}}(I)},$$\n其中 $\\Delta \\log_{10} K(I) \\equiv \\log_{10} K(I) - \\log_{10} K^{\\circ}$。将您的答案四舍五入到四位有效数字。将 $R$ 表示为一个无量纲数。",
            "solution": "本题要求计算由两种不同的电解质模型——特定离子相互作用理论 (SIT) 和扩展的 Debye–Hückel (EDH) 框架——所预测的平衡常数校正值的比值 $R$。这个校正项记为 $\\Delta \\log_{10} K(I)$，表示在指定离子强度 $I$ 下，质量摩尔浓度标度的平衡常数 $K(I)$ 的对数相对于热力学平衡常数 $K^{\\circ}$ 的对数的偏移量。\n\n所考虑的化学反应是一个二价阳离子和一个二价阴离子的缔合反应：\n$$M^{2+} + L^{2-} \\rightleftharpoons ML^{0}$$\n热力学平衡常数 $K^{\\circ}$ 由相关物种的活度 $a_j$ 定义：\n$$K^{\\circ} = \\frac{a_{ML^{0}}}{a_{M^{2+}} a_{L^{2-}}}$$\n物种的活度 $a_j$ 通过其质量摩尔活度系数 $\\gamma_j$ 与质量摩尔浓度 $m_j$ 相关，关系式为 $a_j = \\gamma_j m_j$。将此代入 $K^{\\circ}$ 的表达式中得到：\n$$K^{\\circ} = \\frac{\\gamma_{ML^{0}} m_{ML^{0}}}{\\gamma_{M^{2+}} m_{M^{2+}} \\gamma_{L^{2-}} m_{L^{2-}}}$$\n质量摩尔浓度标度的平衡常数 $K(I)$ 完全由质量摩尔浓度定义：\n$$K(I) = \\frac{m_{ML^{0}}}{m_{M^{2+}} m_{L^{2-}}}$$\n结合这两个表达式，我们建立了这两个常数之间的关系：\n$$K^{\\circ} = K(I) \\frac{\\gamma_{ML^{0}}}{\\gamma_{M^{2+}} \\gamma_{L^{2-}}}$$\n对两边取以10为底的对数并重新整理，得到平衡常数校正项的定义：\n$$\\Delta \\log_{10} K(I) \\equiv \\log_{10} K(I) - \\log_{10} K^{\\circ} = \\log_{10}(\\gamma_{M^{2+}}) + \\log_{10}(\\gamma_{L^{2-}}) - \\log_{10}(\\gamma_{ML^{0}})$$\n问题中指定了假设，即中性络合物 $ML^{0}$ 表现为理想行为，因此其活度系数为 $\\gamma_{ML^{0}} \\approx 1$，这意味着 $\\log_{10}(\\gamma_{ML^{0}}) \\approx 0$。因此，校正项简化为反应物离子的活度系数的对数之和：\n$$\\Delta \\log_{10} K(I) = \\log_{10}(\\gamma_{M^{2+}}) + \\log_{10}(\\gamma_{L^{2-}})$$\n我们现在将在给定的离子强度 $I = 1.0\\,\\mathrm{mol\\,kg^{-1}}$（即 $\\sqrt{I} = 1.0$）下，使用 EDH 和 SIT 模型计算这个量。\n\n首先，我们应用扩展的 Debye–Hückel 模型。单个离子活度系数 $\\gamma_i$ 的公式为：\n$$\\log_{10} \\gamma_i = -\\frac{A z_i^2 \\sqrt{I}}{1 + B a_i \\sqrt{I}}$$\n所需参数已给出：Debye–Hückel 常数 $A = 0.51$，离子尺寸参数常数 $B = 0.33\\,\\mathrm{\\AA^{-1}}$，阳离子尺寸 $a_{M^{2+}} = 6.0\\,\\mathrm{\\AA}$，阴离子尺寸 $a_{L^{2-}} = 9.0\\,\\mathrm{\\AA}$。对于两种离子，电荷的绝对值均为 $2$，因此 $z^2 = (\\pm 2)^2 = 4$。\n\n对于阳离子 $M^{2+}$：\n$$\\log_{10} \\gamma_{M^{2+}} = -\\frac{(0.51)(2^2)\\sqrt{1.0}}{1 + (0.33)(6.0)\\sqrt{1.0}} = -\\frac{2.04}{1 + 1.98} = -\\frac{2.04}{2.98}$$\n\n对于阴离子 $L^{2-}$：\n$$\\log_{10} \\gamma_{L^{2-}} = -\\frac{(0.51)((-2)^2)\\sqrt{1.0}}{1 + (0.33)(9.0)\\sqrt{1.0}} = -\\frac{2.04}{1 + 2.97} = -\\frac{2.04}{3.97}$$\n\n根据 EDH 模型的总校正值 $\\Delta \\log_{10} K_{\\mathrm{EDH}}(I)$ 是这些值的和：\n$$\\Delta \\log_{10} K_{\\mathrm{EDH}}(I) = -\\frac{2.04}{2.98} - \\frac{2.04}{3.97} = -2.04 \\left( \\frac{1}{2.98} + \\frac{1}{3.97} \\right)$$\n数值计算如下：\n$$\\Delta \\log_{10} K_{\\mathrm{EDH}}(I) \\approx -2.04(0.335570 + 0.251890) = -2.04(0.58746) \\approx -1.198418$$\n\n接下来，我们应用特定离子相互作用理论。$\\log_{10} \\gamma_i$ 的 SIT 公式包含一个特定相互作用项：\n$$\\log_{10} \\gamma_i = -\\frac{A z_i^2 \\sqrt{I}}{1 + 1.5 \\sqrt{I}} + \\sum_k \\varepsilon(i,k) m_k$$\n求和项是对背景电解质中的所有反离子 $k$ 进行的。电解质是 $\\mathrm{NaCl}$，其质量摩尔浓度为 $m_{\\mathrm{NaCl}} = 1.0\\,\\mathrm{mol\\,kg^{-1}}$，因此 $m_{\\mathrm{Na}^{+}} = 1.0\\,\\mathrm{mol\\,kg^{-1}}$ 且 $m_{\\mathrm{Cl}^{-}} = 1.0\\,\\mathrm{mol\\,kg^{-1}}$。给出的 SIT 相互作用系数为 $\\varepsilon(M^{2+}, \\mathrm{Cl}^{-}) = 0.15$ 和 $\\varepsilon(\\mathrm{Na}^{+}, L^{2-}) = 0.05$。\n\n对于阳离子 $M^{2+}$，我们考虑它与 $\\mathrm{Cl}^{-}$ 的相互作用：\n$$\\log_{10} \\gamma_{M^{2+}} = -\\frac{(0.51)(2^2)\\sqrt{1.0}}{1 + 1.5\\sqrt{1.0}} + \\varepsilon(M^{2+}, \\mathrm{Cl}^{-}) m_{\\mathrm{Cl}^{-}}$$\n$$\\log_{10} \\gamma_{M^{2+}} = -\\frac{2.04}{2.5} + (0.15)(1.0) = -0.816 + 0.15 = -0.666$$\n\n对于阴离子 $L^{2-}$，我们考虑它与 $\\mathrm{Na}^{+}$ 的相互作用。SIT 系数是对称的，所以 $\\varepsilon(L^{2-}, \\mathrm{Na}^{+}) = \\varepsilon(\\mathrm{Na}^{+}, L^{2-})$。\n$$\\log_{10} \\gamma_{L^{2-}} = -\\frac{(0.51)((-2)^2)\\sqrt{1.0}}{1 + 1.5\\sqrt{1.0}} + \\varepsilon(\\mathrm{Na}^{+}, L^{2-}) m_{\\mathrm{Na}^{+}}$$\n$$\\log_{10} \\gamma_{L^{2-}} = -\\frac{2.04}{2.5} + (0.05)(1.0) = -0.816 + 0.05 = -0.766$$\n\n根据 SIT 模型的总校正值 $\\Delta \\log_{10} K_{\\mathrm{SIT}}(I)$ 是这些值的和：\n$$\\Delta \\log_{10} K_{\\mathrm{SIT}}(I) = \\log_{10} \\gamma_{M^{2+}} + \\log_{10} \\gamma_{L^{2-}} = -0.666 - 0.766 = -1.432$$\n\n最后，我们计算所需的比值 $R$：\n$$R = \\frac{\\Delta \\log_{10} K_{\\mathrm{SIT}}(I)}{\\Delta \\log_{10} K_{\\mathrm{EDH}}(I)} = \\frac{-1.432}{-1.198418} \\approx 1.194903$$\n根据题目要求，将结果四舍五入到四位有效数字，得到 $R$ 的最终值。\n$$R \\approx 1.195$$",
            "answer": "$$\\boxed{1.195}$$"
        },
        {
            "introduction": "为了将理论应用于实际的地球化学问题，我们必须考虑如何在多组分体系中高效地实施计算。本练习将引导您从理论公式过渡到计算实践，通过构建相互作用矩阵来系统地处理复杂的离子混合物。您将学习如何利用该矩阵的稀疏和对称特性来优化计算，这是现代地球化学建模软件中一项核心的实用技能 ()。",
            "id": "4099302",
            "problem": "给定专用离子相互作用理论 (SIT) 框架，该框架通过特定的短程离子-离子相互作用来增强用于计算活度系数的静电德拜–休克尔项。本问题的基础是，SIT 将对离子 $i$ 活度系数的以10为底的对数的特定相互作用贡献，建模为溶液组成（以质量摩尔浓度表示）的线性泛函。具体来说，该贡献是质量摩尔浓度的线性组合，其系数取决于离子对。这些系数被排列成一个相互作用矩阵，其元素表示为 $\\varepsilon_{ij}$，其中 $\\varepsilon_{ij}$ 是专用离子相互作用系数，单位为 $\\mathrm{kg\\,mol^{-1}}$，而 $m_j$ 是质量摩尔浓度，单位为 $\\mathrm{mol\\,kg^{-1}}$。因此，总和 $\\sum_{j}\\varepsilon_{ij} m_j$ 是无量纲的。在SIT框架中，同电荷离子对（阳离子-阳离子或阴离子-阴离子）的系数根据构造规定为零，在此近似中对角线元素也为零，并且对于固定条件下的二元离子对，对称性 $\\varepsilon_{ij}=\\varepsilon_{ji}$ 成立。\n\n考虑一个包含以下 5 种离子的多电解质水溶液体系，其索引顺序如下：\n$0$: $\\mathrm{Na^+}$，\n$1$: $\\mathrm{Ca^{2+}}$，\n$2$: $\\mathrm{Mg^{2+}}$，\n$3$: $\\mathrm{Cl^-}$，\n$4$: $\\mathrm{SO_4^{2-}}$。\n\n在固定热力学条件下，假设阳离子-阴离子对具有以下非零专用相互作用系数 $\\varepsilon_{ij}$（单位为 $\\mathrm{kg\\,mol^{-1}}$）；对于所有其他未在下面列出的无序对 $(i,j)$（包括所有同电荷对和所有对角线元素），取 $\\varepsilon_{ij}=0$：\n$\\varepsilon_{\\mathrm{Na^+,Cl^-}}=\\varepsilon_{\\mathrm{Cl^-,Na^+}}=0.03$，\n$\\varepsilon_{\\mathrm{Na^+,SO_4^{2-}}}=\\varepsilon_{\\mathrm{SO_4^{2-},Na^+}}=0.09$，\n$\\varepsilon_{\\mathrm{Ca^{2+},Cl^-}}=\\varepsilon_{\\mathrm{Cl^-,Ca^{2+}}}=0.20$，\n$\\varepsilon_{\\mathrm{Ca^{2+},SO_4^{2-}}}=\\varepsilon_{\\mathrm{SO_4^{2-},Ca^{2+}}}=0.27$，\n$\\varepsilon_{\\mathrm{Mg^{2+},Cl^-}}=\\varepsilon_{\\mathrm{Cl^-,Mg^{2+}}}=0.21$，\n$\\varepsilon_{\\mathrm{Mg^{2+},SO_4^{2-}}}=\\varepsilon_{\\mathrm{SO_4^{2-},Mg^{2+}}}=0.35$。\n\n任务：\n- 根据上述规则构建完整的 $5\\times 5$ 相互作用矩阵 $\\boldsymbol{\\varepsilon}$。\n- 对于给定的质量摩尔浓度组成向量 $\\mathbf{m}=(m_0,m_1,m_2,m_3,m_4)^\\top$（单位为 $\\mathrm{mol\\,kg^{-1}}$，离子索引顺序同上），计算向量 $\\mathbf{E}=\\boldsymbol{\\varepsilon}\\,\\mathbf{m}$，其元素为 $E_i=\\sum_{j=0}^{4}\\varepsilon_{ij}m_j$。将 $\\mathbf{E}$ 解释为每种离子的无量纲专用相互作用贡献向量。\n- 解释并实现一种算法，该算法通过利用 $\\boldsymbol{\\varepsilon}$ 的稀疏性和对称性来高效地计算 $\\mathbf{E}$。\n\n数值细节和单位：\n- 使用质量摩尔浓度 $m_j$，单位为 $\\mathrm{mol\\,kg^{-1}}$。\n- 使用相互作用系数 $\\varepsilon_{ij}$，单位为 $\\mathrm{kg\\,mol^{-1}}$。\n- 乘积 $\\varepsilon_{ij}m_j$ 是无量纲的，每个 $E_i$ 也是如此。\n- 对于数值输出，使用标准四舍五入将 $\\mathbf{E}$ 的每个元素取整到 12 位小数。\n\n测试套件：\n您必须为以下 4 个测试组成 $\\mathbf{m}^{(k)}$ 评估 $\\mathbf{E}$，每个组成均以5元组 $(m_{\\mathrm{Na^+}},m_{\\mathrm{Ca^{2+}}},m_{\\mathrm{Mg^{2+}}},m_{\\mathrm{Cl^-}},m_{\\mathrm{SO_4^{2-}}})$ 的形式给出，其中每个 $m$ 的单位为 $\\mathrm{mol\\,kg^{-1}}$：\n- 情况 $1$（一般混合物）：$\\mathbf{m}^{(1)}=(0.5,\\,0.01,\\,0.02,\\,0.6,\\,0.02)$。\n- 情况 $2$（全零边界）：$\\mathbf{m}^{(2)}=(0,\\,0,\\,0,\\,0,\\,0)$。\n- 情况 $3$（单一阳离子存在）：$\\mathbf{m}^{(3)}=(1.0,\\,0,\\,0,\\,0,\\,0)$。\n- 情况 $4$（高盐度边缘）：$\\mathbf{m}^{(4)}=(0.8,\\,0.2,\\,0.1,\\,1.2,\\,0.15)$。\n\n程序要求：\n- 根据指定的非零无序对和其他位置为零的规则，一次性构建 $\\boldsymbol{\\varepsilon}$。\n- 对每个测试用例，使用两种方法计算 $\\mathbf{E}$：一种是稠密矩阵-向量积，另一种是利用零模式的稀疏矩阵-向量积。验证对于每个用例，两种方法的结果在每个分量上的绝对容差都在 $10^{-12}$ 以内。\n- 您的程序应生成单行输出，其中包含一个列表的列表形式的 4 个结果。每个内部列表是对应测试用例的 5 分量向量 $\\mathbf{E}$，四舍五入到 12 位小数，并按离子顺序 $(\\mathrm{Na^+},\\mathrm{Ca^{2+}},\\mathrm{Mg^{2+}},\\mathrm{Cl^-},\\mathrm{SO_4^{2-}})$ 排列。例如，格式必须与 $[[e_{1,0},e_{1,1},e_{1,2},e_{1,3},e_{1,4}],[e_{2,0},\\dots,e_{2,4}],\\dots,[e_{4,0},\\dots,e_{4,4}]]$ 完全一样，不得包含任何额外文本。",
            "solution": "该问题要求在专用离子相互作用理论 (SIT) 框架内计算专用离子相互作用贡献向量 $\\mathbf{E}$。此计算是针对一个包含五种指定离子的多电解质体系进行的。计算过程包括构建一个相互作用矩阵 $\\boldsymbol{\\varepsilon}$，并将其与给定的质量摩尔浓度向量 $\\mathbf{m}$ 进行矩阵-向量相乘。任务的核心是通过利用相互作用矩阵的内在结构来高效地实现这一计算。\n\n首先，我们根据问题描述建立数学表示。五种离子的专用相互作用贡献向量 $\\mathbf{E}$ 由线性变换 $\\mathbf{E} = \\boldsymbol{\\varepsilon}\\mathbf{m}$ 定义，其中 $\\boldsymbol{\\varepsilon}$ 是 $5 \\times 5$ 的相互作用矩阵，$\\mathbf{m}$ 是 $5 \\times 1$ 的离子质量摩尔浓度向量。$\\mathbf{E}$ 的每个分量 $E_i$ 由总和 $E_i = \\sum_{j=0}^{4} \\varepsilon_{ij} m_j$ 给出。\n\n离子索引如下：$0: \\mathrm{Na^+}$, $1: \\mathrm{Ca^{2+}}$, $2: \\mathrm{Mg^{2+}}$, $3: \\mathrm{Cl^-}$, $4: \\mathrm{SO_4^{2-}}$。前三种离子（索引 $0, 1, 2$）是阳离子，后两种（索引 $3, 4$）是阴离子。\n\n相互作用矩阵 $\\boldsymbol{\\varepsilon}$ 是根据SIT规则和一组给定的相互作用系数 $\\varepsilon_{ij}$（单位为 $\\mathrm{kg\\,mol^{-1}}$）构建的。规则如下：\n1.  同电荷离子对的相互作用系数为零。这意味着如果 $i$ 和 $j$ 都是阳离子（索引在 $\\{0,1,2\\}$ 中）或都是阴离子（索引在 $\\{3,4\\}$ 中），则 $\\varepsilon_{ij} = 0$。\n2.  对角线系数为零，即对于所有 $i$，$\\varepsilon_{ii} = 0$。\n3.  对于阳离子-阴离子对，矩阵是对称的，即 $\\varepsilon_{ij} = \\varepsilon_{ji}$。\n\n给定的非零系数是针对阳离子-阴离子对的：\n- $\\varepsilon_{0,3} = \\varepsilon_{3,0} = 0.03$\n- $\\varepsilon_{0,4} = \\varepsilon_{4,0} = 0.09$\n- $\\varepsilon_{1,3} = \\varepsilon_{3,1} = 0.20$\n- $\\varepsilon_{1,4} = \\varepsilon_{4,1} = 0.27$\n- $\\varepsilon_{2,3} = \\varepsilon_{3,2} = 0.21$\n- $\\varepsilon_{2,4} = \\varepsilon_{4,2} = 0.35$\n\n结合这些规则，我们构建 $5 \\times 5$ 矩阵 $\\boldsymbol{\\varepsilon}$。行和列按指定顺序 $(\\mathrm{Na^+}, \\mathrm{Ca^{2+}}, \\mathrm{Mg^{2+}}, \\mathrm{Cl^-}, \\mathrm{SO_4^{2-}})$ 对应于各种离子。\n\n$$\n\\boldsymbol{\\varepsilon} =\n\\begin{pmatrix}\n\\varepsilon_{00}  \\varepsilon_{01}  \\varepsilon_{02}  \\varepsilon_{03}  \\varepsilon_{04} \\\\\n\\varepsilon_{10}  \\varepsilon_{11}  \\varepsilon_{12}  \\varepsilon_{13}  \\varepsilon_{14} \\\\\n\\varepsilon_{20}  \\varepsilon_{21}  \\varepsilon_{22}  \\varepsilon_{23}  \\varepsilon_{24} \\\\\n\\varepsilon_{30}  \\varepsilon_{31}  \\varepsilon_{32}  \\varepsilon_{33}  \\varepsilon_{34} \\\\\n\\varepsilon_{40}  \\varepsilon_{41}  \\varepsilon_{42}  \\varepsilon_{43}  \\varepsilon_{44}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.00  0.00  0.00  0.03  0.09 \\\\\n0.00  0.00  0.00  0.20  0.27 \\\\\n0.00  0.00  0.00  0.21  0.35 \\\\\n0.03  0.20  0.21  0.00  0.00 \\\\\n0.09  0.27  0.35  0.00  0.00\n\\end{pmatrix}\n$$\n\n一种计算 $\\mathbf{E}$ 的直接但低效的方法是使用完整的 $\\boldsymbol{\\varepsilon}$ 矩阵执行稠密矩阵-向量乘法。每次计算将涉及 $5 \\times 5 = 25$ 次乘法和 $5 \\times 4 = 20$ 次加法。\n\n一种更高效的算法利用了 $\\boldsymbol{\\varepsilon}$ 的稀疏性和结构。该矩阵具有由阳离子和阴离子组决定的分块结构。设 $\\mathbf{m}_c = (m_0, m_1, m_2)^\\top$ 为阳离子质量摩尔浓度向量，$\\mathbf{m}_a = (m_3, m_4)^\\top$ 为阴离子质量摩尔浓度向量。类似地，设 $\\mathbf{E}_c = (E_0, E_1, E_2)^\\top$ 和 $\\mathbf{E}_a = (E_3, E_4)^\\top$ 为结果的相应子向量。矩阵 $\\boldsymbol{\\varepsilon}$ 可以写成分块形式：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\mathbf{0}_{3 \\times 3}  \\mathbf{B} \\\\ \\mathbf{B}^\\top  \\mathbf{0}_{2 \\times 2} \\end{pmatrix}\n$$\n其中 $\\mathbf{0}_{n \\times n}$ 是一个 $n \\times n$ 的零矩阵，而 $\\mathbf{B}$ 是 $3 \\times 2$ 的阳离子-阴离子相互作用系数子矩阵：\n$$\n\\mathbf{B} = \\begin{pmatrix} \\varepsilon_{03}  \\varepsilon_{04} \\\\ \\varepsilon_{13}  \\varepsilon_{14} \\\\ \\varepsilon_{23}  \\varepsilon_{24} \\end{pmatrix} = \\begin{pmatrix} 0.03  0.09 \\\\ 0.20  0.27 \\\\ 0.21  0.35 \\end{pmatrix}\n$$\n现在可以使用分块矩阵乘法来计算乘积 $\\mathbf{E} = \\boldsymbol{\\varepsilon}\\mathbf{m}$：\n$$\n\\begin{pmatrix} \\mathbf{E}_c \\\\ \\mathbf{E}_a \\end{pmatrix} = \\begin{pmatrix} \\mathbf{0}_{3 \\times 3}  \\mathbf{B} \\\\ \\mathbf{B}^\\top  \\mathbf{0}_{2 \\times 2} \\end{pmatrix} \\begin{pmatrix} \\mathbf{m}_c \\\\ \\mathbf{m}_a \\end{pmatrix} = \\begin{pmatrix} \\mathbf{0}_{3 \\times 3}\\mathbf{m}_c + \\mathbf{B}\\mathbf{m}_a \\\\ \\mathbf{B}^\\top\\mathbf{m}_c + \\mathbf{0}_{2 \\times 2}\\mathbf{m}_a \\end{pmatrix} = \\begin{pmatrix} \\mathbf{B}\\mathbf{m}_a \\\\ \\mathbf{B}^\\top\\mathbf{m}_c \\end{pmatrix}\n$$\n这导出了高效的算法：\n1.  计算阳离子相互作用贡献：$\\mathbf{E}_c = \\mathbf{B}\\mathbf{m}_a$。这是一个 $3 \\times 2$ 矩阵乘以一个 $2 \\times 1$ 向量，需要 $3 \\times 2 = 6$ 次乘法和 $3 \\times 1 = 3$ 次加法。\n2.  计算阴离子相互作用贡献：$\\mathbf{E}_a = \\mathbf{B}^\\top\\mathbf{m}_c$。这是一个 $2 \\times 3$ 矩阵乘以一个 $3 \\times 1$ 向量，需要 $2 \\times 3 = 6$ 次乘法和 $2 \\times 2 = 4$ 次加法。\n\n总共，这种稀疏方法仅使用 $12$ 次乘法和 $7$ 次加法，与稠密方法的 $25$ 次乘法和 $20$ 次加法相比，这是一个显著的减少。这种方法还利用了对称性，因为只需要存储 $\\mathbf{B}$ 矩阵中的 $6$ 个唯一系数。\n\n具体来说，各分量为：\n- $E_0 = \\varepsilon_{03}m_3 + \\varepsilon_{04}m_4$\n- $E_1 = \\varepsilon_{13}m_3 + \\varepsilon_{14}m_4$\n- $E_2 = \\varepsilon_{23}m_3 + \\varepsilon_{24}m_4$\n- $E_3 = \\varepsilon_{30}m_0 + \\varepsilon_{31}m_1 + \\varepsilon_{32}m_2 = \\varepsilon_{03}m_0 + \\varepsilon_{13}m_1 + \\varepsilon_{23}m_2$\n- $E_4 = \\varepsilon_{40}m_0 + \\varepsilon_{41}m_1 + \\varepsilon_{42}m_2 = \\varepsilon_{04}m_0 + \\varepsilon_{14}m_1 + \\varepsilon_{24}m_2$\n\n该算法将被实现并用于计算每个测试用例的 $\\mathbf{E}$。在四舍五入并格式化输出之前，将使用稠密矩阵-向量积验证稀疏实现的结果，以确保其正确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs the SIT interaction matrix, computes the interaction vector E for \n    several test cases using both dense and sparse methods, verifies their\n    equivalence, and prints the final results.\n    \"\"\"\n    \n    # Ions: 0:Na+, 1:Ca2+, 2:Mg2+, 3:Cl-, 4:SO4^2-\n    # Cations: 0, 1, 2\n    # Anions:  3, 4\n    \n    # Given non-zero interaction coefficients epsilon_ij in kg/mol.\n    # The keys are tuples of ion indices (i, j).\n    coeffs = {\n        (0, 3): 0.03, (0, 4): 0.09,\n        (1, 3): 0.20, (1, 4): 0.27,\n        (2, 3): 0.21, (2, 4): 0.35,\n    }\n\n    # -- 1. Construct the full 5x5 interaction matrix (epsilon) --\n    # This is for the dense calculation and verification.\n    epsilon_matrix = np.zeros((5, 5))\n    for (i, j), val in coeffs.items():\n        epsilon_matrix[i, j] = val\n        epsilon_matrix[j, i] = val  # Apply symmetry rule epsilon_ij = epsilon_ji\n\n    # -- 2. Construct the 3x2 cation-anion block B for the sparse method --\n    # This exploits the block structure of the matrix.\n    # B_ij = epsilon_{cation_i, anion_j}\n    B_matrix = np.array([\n        [coeffs[(0, 3)], coeffs[(0, 4)]],  # Na+ interactions with Cl-, SO4^2-\n        [coeffs[(1, 3)], coeffs[(1, 4)]],  # Ca2+ interactions with Cl-, SO4^2-\n        [coeffs[(2, 3)], coeffs[(2, 4)]],  # Mg2+ interactions with Cl-, SO4^2-\n    ])\n\n    # -- 3. Define the test cases for molality vectors m --\n    # Ordered as (m_Na+, m_Ca2+, m_Mg2+, m_Cl-, m_SO4^2-) in mol/kg.\n    test_cases = [\n        (0.5, 0.01, 0.02, 0.6, 0.02),      # Case 1 (general mixture)\n        (0.0, 0.0, 0.0, 0.0, 0.0),          # Case 2 (all zero boundary)\n        (1.0, 0.0, 0.0, 0.0, 0.0),          # Case 3 (single cation present)\n        (0.8, 0.2, 0.1, 1.2, 0.15),       # Case 4 (high salinity edge)\n    ]\n\n    results = []\n    for case in test_cases:\n        m = np.array(case)\n\n        # -- Dense Calculation: E = epsilon * m --\n        E_dense = epsilon_matrix @ m\n        \n        # -- Sparse Calculation: E_c = B*m_a, E_a = B.T*m_c --\n        m_c = m[:3]  # Cation molalities (Na+, Ca2+, Mg2+)\n        m_a = m[3:]  # Anion molalities (Cl-, SO4^2-)\n        \n        E_c_sparse = B_matrix @ m_a\n        E_a_sparse = B_matrix.T @ m_c\n        \n        E_sparse = np.concatenate((E_c_sparse, E_a_sparse))\n\n        # -- 4. Verification Step --\n        # Verify that dense and sparse methods yield the same result within tolerance.\n        assert np.allclose(E_dense, E_sparse, rtol=0, atol=1e-12), \\\n            f\"Mismatch between dense and sparse methods for case: {case}\"\n\n        # -- 5. Rounding and Storing Result --\n        # Round the final vector components to 12 decimal places.\n        rounded_E = np.round(E_dense, 12)\n        results.append(rounded_E.tolist())\n\n    # -- 6. Final Output --\n    # The output format is a string representation of a list of lists.\n    # Python's default str() for a list of lists matches the required format.\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}