{
    "hands_on_practices": [
        {
            "introduction": "这个首要练习旨在巩固对离子电荷和玻恩溶剂化能之间核心关系的理解。通过在一个简化的假设下比较两种离子，你将推导并量化溶剂化能如何随电荷变化，这是溶液中静电相互作用的一个基本方面。这项练习将为你应用玻恩模型中的 $z^2$ 依赖性提供基础。",
            "id": "4070442",
            "problem": "在计算地球化学中，离子的水合作用通常在Born溶剂化框架下，通过连续介质静电学进行建模。在该模型中，离子被视为一个嵌入代表水的均匀电介质中的带电球体。考虑两种单原子水合离子：钠离子，其电荷数为 $z_{\\mathrm{Na}}=+1$；钙离子，其电荷数为 $z_{\\mathrm{Ca}}=+2$。假设在环境条件下，两种离子在相对介电常数为 $\\varepsilon$ 的液态水中，都具有相同的有效Born空腔半径 $r$。从静电学和热力学的第一性原理出发，推导球形离子的Born溶剂化自由能表达式，并利用该表达式在半径相同的假设下计算比值 $\\Delta G_{\\mathrm{Born},\\mathrm{Ca}^{2+}} / \\Delta G_{\\mathrm{Born},\\mathrm{Na}^{+}}$。请将最终比值以精确的无量纲数形式给出，无需四舍五入。最后，根据推导出的依赖关系，定性解释在实际情况中，$\\mathrm{Na}^{+}$ 和 $\\mathrm{Ca}^{2+}$ 之间有效半径的差异将如何改变这一比值。",
            "solution": "首先验证该问题，以确保其科学上合理、良态且客观。\n\n**步骤1：提取已知条件**\n-   模型：Born溶剂化框架。\n-   系统：两种单原子水合离子，钠离子（$\\mathrm{Na}^{+}$）和钙离子（$\\mathrm{Ca}^{2+}$）。\n-   离子电荷数，钠：$z_{\\mathrm{Na}}=+1$。\n-   离子电荷数，钙：$z_{\\mathrm{Ca}}=+2$。\n-   计算假设：两种离子具有相同的有效Born空腔半径 $r$。\n-   溶剂：相对介电常数为 $\\varepsilon$ 的液态水。\n-   任务1：推导Born溶剂化自由能 $\\Delta G_{\\mathrm{Born}}$ 的表达式。\n-   任务2：在半径相同的假设下，计算比值 $\\Delta G_{\\mathrm{Born},\\mathrm{Ca}^{2+}} / \\Delta G_{\\mathrm{Born},\\mathrm{Na}^{+}}$。\n-   任务3：以精确的无量纲数形式给出最终比值。\n-   任务4：定性解释有效半径的差异将如何改变这一比值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为Born模型是物理化学和计算地球化学中用于估算溶剂化能的基本概念。该问题是良态的，提供了所有必要信息（$z_{\\mathrm{Na}}$, $z_{\\mathrm{Ca}}$）和一个清晰的简化假设（半径相同），从而可以计算出唯一的无量纲比值。语言客观、精确。该问题没有违反任何科学原理，内容完整且无矛盾，是应用静电学和热力学原理的一个标准的、非平凡的练习。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n**Born溶剂化自由能的推导**\n\nBorn模型将离子视为一个半径为 $r$、电荷为 $q$ 的刚性导电球体。溶剂化自由能 $\\Delta G_{\\mathrm{Born}}$ 的计算方法是，将在真空中为离子充电所需的静电功与在连续电介质（溶剂）中为离子充电所需的静电功相减。\n\n1.  **真空中的能量**：首先，考虑在真空中将球体从电荷为 $0$ 充电至最终电荷 $q$。真空的介电常数为 $\\epsilon_0$。对于一个带有中间电荷 $q'$ 的球体，其表面的静电势为：\n    $$V(q') = \\frac{q'}{4\\pi\\epsilon_0 r}$$\n    将无穷小电荷 $dq'$ 带到球体表面所做的功 $dW$ 为 $dW = V(q') dq'$。将球体从 $0$ 充电到 $q$ 所做的总功 $W_{\\mathrm{vac}}$ 是以下积分：\n    $$W_{\\mathrm{vac}} = \\int_0^q V(q') dq' = \\int_0^q \\frac{q'}{4\\pi\\epsilon_0 r} dq' = \\frac{1}{4\\pi\\epsilon_0 r} \\left[ \\frac{(q')^2}{2} \\right]_0^q = \\frac{q^2}{8\\pi\\epsilon_0 r}$$\n    这个功等于离子在真空中的静电吉布斯自由能 $G_{\\mathrm{vac}}$。\n\n2.  **溶剂中的能量**：接下来，考虑在溶剂中为同一个球体充电，溶剂被建模为相对介电常数 $\\varepsilon > 1$ 的均匀电介质。该介质的绝对介电常数为 $\\epsilon_m = \\varepsilon\\epsilon_0$。这个过程是类似的，但周围介质的介电常数现在是 $\\varepsilon\\epsilon_0$。所需的功 $W_{\\mathrm{solv}}$ 为：\n    $$W_{\\mathrm{solv}} = \\int_0^q \\frac{q'}{4\\pi\\varepsilon\\epsilon_0 r} dq' = \\frac{q^2}{8\\pi\\varepsilon\\epsilon_0 r}$$\n    这是离子在溶剂中的静电吉布斯自由能 $G_{\\mathrm{solv}}$。\n\n3.  **溶剂化能**：Born溶剂化自由能 $\\Delta G_{\\mathrm{Born}}$ 是将离子从真空转移到溶剂中的自由能变化。它是最终状态与初始状态之差：\n    $$\\Delta G_{\\mathrm{Born}} = G_{\\mathrm{solv}} - G_{\\mathrm{vac}} = \\frac{q^2}{8\\pi\\varepsilon\\epsilon_0 r} - \\frac{q^2}{8\\pi\\epsilon_0 r}$$\n    提取公因式可得：\n    $$\\Delta G_{\\mathrm{Born}} = \\frac{q^2}{8\\pi\\epsilon_0 r} \\left( \\frac{1}{\\varepsilon} - 1 \\right)$$\n    对于一个电荷数为 $z$、元电荷为 $e$ 的离子，总电荷为 $q = ze$。将此代入表达式，得到Born溶剂化自由能的最终形式：\n    $$\\Delta G_{\\mathrm{Born}} = \\frac{(ze)^2}{8\\pi\\epsilon_0 r} \\left( \\frac{1}{\\varepsilon} - 1 \\right)$$\n\n**比值的计算**\n\n利用推导出的表达式，我们可以写出钙离子（$\\mathrm{Ca}^{2+}$）和钠离子（$\\mathrm{Na}^{+}$）的Born溶剂化自由能。\n\n对于 $\\mathrm{Ca}^{2+}$，我们有 $z = z_{\\mathrm{Ca}} = +2$。假设其有效半径为 $r_{\\mathrm{Ca}}$：\n$$\\Delta G_{\\mathrm{Born},\\mathrm{Ca}^{2+}} = \\frac{(z_{\\mathrm{Ca}}e)^2}{8\\pi\\epsilon_0 r_{\\mathrm{Ca}}} \\left( \\frac{1}{\\varepsilon} - 1 \\right)$$\n对于 $\\mathrm{Na}^{+}$，我们有 $z = z_{\\mathrm{Na}} = +1$。假设其有效半径为 $r_{\\mathrm{Na}}$：\n$$\\Delta G_{\\mathrm{Born},\\mathrm{Na}^{+}} = \\frac{(z_{\\mathrm{Na}}e)^2}{8\\pi\\epsilon_0 r_{\\mathrm{Na}}} \\left( \\frac{1}{\\varepsilon} - 1 \\right)$$\n\n问题要求假设两种离子的半径相同，即 $r_{\\mathrm{Ca}} = r_{\\mathrm{Na}} = r$。现在我们可以计算该比值：\n$$\\frac{\\Delta G_{\\mathrm{Born},\\mathrm{Ca}^{2+}}}{\\Delta G_{\\mathrm{Born},\\mathrm{Na}^{+}}} = \\frac{\\frac{(z_{\\mathrm{Ca}}e)^2}{8\\pi\\epsilon_0 r} \\left( \\frac{1}{\\varepsilon} - 1 \\right)}{\\frac{(z_{\\mathrm{Na}}e)^2}{8\\pi\\epsilon_0 r} \\left( \\frac{1}{\\varepsilon} - 1 \\right)}$$\n项 $\\frac{e^2}{8\\pi\\epsilon_0 r} \\left( \\frac{1}{\\varepsilon} - 1 \\right)$ 是分子和分母的公因式，可以消去，剩下：\n$$\\frac{\\Delta G_{\\mathrm{Born},\\mathrm{Ca}^{2+}}}{\\Delta G_{\\mathrm{Born},\\mathrm{Na}^{+}}} = \\frac{z_{\\mathrm{Ca}}^2}{z_{\\mathrm{Na}}^2}$$\n代入给定的电荷数 $z_{\\mathrm{Ca}} = 2$ 和 $z_{\\mathrm{Na}} = 1$：\n$$\\frac{\\Delta G_{\\mathrm{Born},\\mathrm{Ca}^{2+}}}{\\Delta G_{\\mathrm{Born},\\mathrm{Na}^{+}}} = \\frac{2^2}{1^2} = \\frac{4}{1} = 4$$\n\n**半径差异的定性分析**\n\n在更现实的情况下，$\\mathrm{Na}^{+}$ 和 $\\mathrm{Ca}^{2+}$ 的有效Born半径并不相同。它们的溶剂化能比值的通用表达式为：\n$$\\frac{\\Delta G_{\\mathrm{Born},\\mathrm{Ca}^{2+}}}{\\Delta G_{\\mathrm{Born},\\mathrm{Na}^{+}}} = \\left(\\frac{z_{\\mathrm{Ca}}^2}{z_{\\mathrm{Na}}^2}\\right) \\left(\\frac{r_{\\mathrm{Na}}}{r_{\\mathrm{Ca}}}\\right) = 4 \\left(\\frac{r_{\\mathrm{Na}}}{r_{\\mathrm{Ca}}}\\right)$$\nBorn溶剂化自由能与半径成反比（$\\Delta G_{\\mathrm{Born}} \\propto 1/r$）。较小的离子具有较高的电荷密度，这导致其与溶剂的相互作用更强，溶剂化能更负（即更有利）。\n\n比较这两种离子，一个 $\\mathrm{Ca}^{2+}$ 离子有 $+20$ 的核电荷和 $18$ 个电子，而一个 $\\mathrm{Na}^{+}$ 离子有 $+11$ 的核电荷和 $10$ 个电子。虽然 $\\mathrm{Ca}^{2+}$ 比 $\\mathrm{Na}^{+}$ 多一个电子层，但其显著更高的核电荷和二价阳离子状态导致对其电子云的吸引力更强。根据晶体学数据和理论考虑，$\\mathrm{Ca}^{2+}$ 的有效离子半径（$r_{\\mathrm{Ca}}$）通常被认为略小于 $\\mathrm{Na}^{+}$ 的有效离子半径（$r_{\\mathrm{Na}}$）。例如，对于六配位情况，$\\mathrm{Ca}^{2+}$ 的Shannon半径约为 $1.00$ Å，而 $\\mathrm{Na}^{+}$ 的Shannon半径约为 $1.02$ Å。\n\n如果 $r_{\\mathrm{Ca}}  r_{\\mathrm{Na}}$，那么半径比 $r_{\\mathrm{Na}}/r_{\\mathrm{Ca}}$ 将大于 $1$。因此，在简化的半径相同假设下，Born溶剂化能的实际比值将略大于计算出的值 $4$。这反映了更小、电荷更高的钙离子表面具有更强的电场，导致其溶剂化能与钠离子相比不成比例地更大。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "在前一个练习的基础上，本实践通过考察一系列卤素离子来探讨离子半径的影响。你不仅将计算溶剂化能如何随尺寸变化，还将批判性地分析为何简单的连续介质模型对像氟离子这样的小离子会开始失效。这凸显了在真实化学系统中，特定分子相互作用（如氢键）的重要性。",
            "id": "4070498",
            "problem": "在计算地球化学中，离子水合的建模通常从连续介质静电学开始。考虑在温度 $T = 298\\ \\mathrm{K}$ 的液态水中的单价卤素离子 $\\mathrm{F^-}$、$\\mathrm{Cl^-}$、$\\mathrm{Br^-}$ 和 $\\mathrm{I^-}$。将每个离子视为一个半径为 $r$ 的刚性均匀带电球体，浸入一个代表水的均匀、各向同性的电介质连续体中，其静态相对介电常数为 $\\varepsilon_{\\mathrm{r}}$。该离子携带电荷 $q = -e$，其中 $e$ 是元电荷的大小。连续介质近似忽略了分子粒度和特定的短程相互作用。\n\n从静电学出发，将一个球形离子从 $q'=0$ 充电到 $q'=q$ 所需的可逆功，可以通过对离子表面的静电势关于 $q'$ 进行积分得到。溶剂化自由能是该可逆功在水中和真空中的差值。使用此框架，推导电荷为 $q$、半径为 $r$ 的球形离子的Born溶剂化自由能表达式，并使用以下物理上合理的数据将其应用于每种卤素离子：\n\n- 半径：$r(\\mathrm{F^-}) = 1.33\\ \\mathrm{\\AA}$，$r(\\mathrm{Cl^-}) = 1.81\\ \\mathrm{\\AA}$，$r(\\mathrm{Br^-}) = 1.96\\ \\mathrm{\\AA}$，$r(\\mathrm{I^-}) = 2.20\\ \\mathrm{\\AA}$。\n- 298 K 时水的介电常数：$\\varepsilon_{\\mathrm{r}} = 78.37$。\n- 真空介电常数：$\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F\\ m^{-1}}$。\n- 元电荷：$e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n- 阿伏伽德罗常数：$N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- 单位换算：$1\\ \\mathrm{\\AA} = 1.0 \\times 10^{-10}\\ \\mathrm{m}$。\n\n计算每个离子的Born溶剂化自由能 $\\Delta G_{\\mathrm{Born}}$，并以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位表示这些能量。然后，提供大小之比 $\\left|\\Delta G_{\\mathrm{Born}}(\\mathrm{F^-})\\right|/\\left|\\Delta G_{\\mathrm{Born}}(\\mathrm{I^-})\\right|$ 作为您最终报告的量。将此最终比值四舍五入到四位有效数字。在您的推理中，从物理上解释为什么由于 $\\mathrm{F^-}$ 的小半径和与水的强特定相互作用，预期它会强烈偏离Born模型的趋势。最终答案必须是单一的数值比率（无单位）。",
            "solution": "该问题是有效的，因为它在科学上基于经典静电学，提法恰当，有足够的数据得到唯一解，并且陈述客观。我们可以进行推导和计算。\n\nBorn模型将离子视为一个半径为 $r$、电荷为 $q$ 的带电导电球体，从真空（相对介电常数 $\\varepsilon_{\\mathrm{r}} = 1$）转移到电介质连续体（溶剂，本例中为水，其相对介电常数为 $\\varepsilon_{\\mathrm{r}}$）。溶剂化自由能 $\\Delta G_{\\mathrm{Born}}$ 是离子在这两种环境中的静电自能之差。\n\n一个半径为 $r$、携带电荷 $q'$ 的球体，浸没在绝对介电常数为 $\\varepsilon$ 的介质中，其表面的静电势 $\\Phi$ 由下式给出：\n$$ \\Phi(r) = \\frac{q'}{4\\pi\\varepsilon r} $$\n绝对介电常数 $\\varepsilon$ 与真空介电常数 $\\varepsilon_0$ 和相对介电常数（介电常数）$\\varepsilon_{\\mathrm{r}}$ 通过 $\\varepsilon = \\varepsilon_{\\mathrm{r}}\\varepsilon_0$ 相关联。\n\n将球体从中性状态（$q'=0$）充电到最终电荷 $q$ 所需的可逆功 $W$，可通过对电势关于所增加的电荷进行积分求得：\n$$ W = \\int_{0}^{q} \\Phi(q') dq' = \\int_{0}^{q} \\frac{q'}{4\\pi\\varepsilon r} dq' $$\n$$ W = \\frac{1}{4\\pi\\varepsilon r} \\int_{0}^{q} q' dq' = \\frac{1}{4\\pi\\varepsilon r} \\left[ \\frac{q'^2}{2} \\right]_{0}^{q} = \\frac{q^2}{8\\pi\\varepsilon r} $$\n\n这个表达式给出了单个离子的充电自由能。为了求得溶剂化自由能，我们计算该能量在溶剂（水）和真空中的差值。\n\n在真空中，$\\varepsilon_{\\mathrm{r}} = 1$，因此 $\\varepsilon = \\varepsilon_0$。功为：\n$$ W_{\\mathrm{vac}} = \\frac{q^2}{8\\pi\\varepsilon_0 r} $$\n\n在水中，相对介电常数为 $\\varepsilon_{\\mathrm{r}}$，功为：\n$$ W_{\\mathrm{water}} = \\frac{q^2}{8\\pi\\varepsilon_{\\mathrm{r}}\\varepsilon_0 r} $$\n\n单个离子的Born溶剂化自由能是其差值：\n$$ \\Delta G_{\\mathrm{Born, ion}} = W_{\\mathrm{water}} - W_{\\mathrm{vac}} = \\frac{q^2}{8\\pi\\varepsilon_0 r} \\left( \\frac{1}{\\varepsilon_{\\mathrm{r}}} - 1 \\right) $$\n由于对于任何像水一样的物质介质，$\\varepsilon_{\\mathrm{r}}  1$，所以项 $\\left(\\frac{1}{\\varepsilon_{\\mathrm{r}}} - 1\\right)$ 是负的，这正确地预测了溶剂化是一个自发的、能量上有利的过程（$\\Delta G  0$）。\n\n问题要求以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位的摩尔自由能。我们必须乘以阿伏伽德罗常数 $N_{\\mathrm{A}}$，并包含一个从焦耳到千焦的转换因子（$1/1000$）。对于单价卤素离子，电荷为 $q=-e$，所以 $q^2 = e^2$。\n摩尔Born溶剂化自由能是：\n$$ \\Delta G_{\\mathrm{Born}} = \\frac{N_{\\mathrm{A}} e^2}{8\\pi\\varepsilon_0 r} \\left( \\frac{1}{\\varepsilon_{\\mathrm{r}}} - 1 \\right) $$\n\n我们被要求为每个卤素离子计算这个值。让我们定义一个不依赖于离子半径 $r$ 的常数部分 $K$：\n$$ K = -\\frac{N_{\\mathrm{A}} e^2}{8\\pi\\varepsilon_0} \\left( \\frac{1}{\\varepsilon_{\\mathrm{r}}} - 1 \\right) = \\frac{N_{\\mathrm{A}} e^2}{8\\pi\\varepsilon_0} \\left( 1 - \\frac{1}{\\varepsilon_{\\mathrm{r}}} \\right) $$\n这样 $\\Delta G_{\\mathrm{Born}} = -K/r$。使用所提供的值：\n$N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$\n$e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F\\ m^{-1}}$\n$\\varepsilon_{\\mathrm{r}} = 78.37$\n\n常数 $K$ 的计算结果为：\n$$ K = \\frac{(6.02214076 \\times 10^{23}) (1.602176634 \\times 10^{-19})^2}{8\\pi (8.8541878128 \\times 10^{-12})} \\left(1 - \\frac{1}{78.37}\\right) \\approx 6.8584 \\times 10^{-5}\\ \\mathrm{J\\ m\\ mol^{-1}} $$\n为了以 $\\mathrm{kJ\\ mol^{-1}}$ 表示能量，我们使用 $K' = 6.8584 \\times 10^{-8}\\ \\mathrm{kJ\\ m\\ mol^{-1}}$，并且半径以米为单位。\n- 对于 $\\mathrm{F^-}$ ($r = 1.33 \\times 10^{-10}\\ \\mathrm{m}$)：$\\Delta G_{\\mathrm{Born}}(\\mathrm{F^-}) = - \\frac{6.8584 \\times 10^{-8}}{1.33 \\times 10^{-10}} \\approx -516\\ \\mathrm{kJ\\ mol^{-1}}$\n- 对于 $\\mathrm{I^-}$ ($r = 2.20 \\times 10^{-10}\\ \\mathrm{m}$)：$\\Delta G_{\\mathrm{Born}}(\\mathrm{I^-}) = - \\frac{6.8584 \\times 10^{-8}}{2.20 \\times 10^{-10}} \\approx -312\\ \\mathrm{kJ\\ mol^{-1}}$\n\n问题要求对 $\\mathrm{F^-}$ 的行为预期会偏离Born模型给出物理解释。Born模型的主要假设是离子是一个简单的球体，溶剂是一个无结构的电介质连续体。对于像 $\\mathrm{F^-}$ 这样具有高电荷密度的小离子，这些假设的失效最为严重。它的小半径（$1.33\\ \\mathrm{\\AA}$）在其表面产生非常强的电场。这种强的局部场导致了两种模型未能捕捉到的主要效应：\n1.  **介电饱和**：第一溶剂化层中的水分子被离子的电场强烈地取向，以至于它们重新取向和屏蔽电荷的能力减弱。局部有效介电常数远低于体相值 $\\varepsilon_{\\mathrm{r}} = 78.37$。这减小了稳定化作用的大小，使得实际的溶剂化能比Born模型的预测值负得更少。\n2.  **特定相互作用和溶剂结构**：Born模型忽略了水的分子性质。$\\mathrm{F^-}$ 是一个强氢键受体，与邻近的水分子形成强的、特定的、几何上有序的氢键。这创造了一个高度结构化的溶剂化层，这是一种连续介质静电学无法描述的、在焓上有利的相互作用。\n\n因此，Born模型过度简化了现实，其预测值会偏离实验值，特别是对于像 $\\mathrm{F^-}$ 这样连续介质近似最不适用的离子。\n\n最后，我们必须计算 $\\mathrm{F^-}$ 和 $\\mathrm{I^-}$ 的溶剂化自由能大小之比。\n$$ \\frac{\\left|\\Delta G_{\\mathrm{Born}}(\\mathrm{F^-})\\right|}{\\left|\\Delta G_{\\mathrm{Born}}(\\mathrm{I^-})\\right|} = \\frac{\\left| \\frac{N_{\\mathrm{A}} e^2}{8\\pi\\varepsilon_0 r(\\mathrm{F^-})} \\left( \\frac{1}{\\varepsilon_{\\mathrm{r}}} - 1 \\right) \\right|}{\\left| \\frac{N_{\\mathrm{A}} e^2}{8\\pi\\varepsilon_0 r(\\mathrm{I^-})} \\left( \\frac{1}{\\varepsilon_{\\mathrm{r}}} - 1 \\right) \\right|} $$\n除了半径之外的所有项都相互抵消，从而显著简化了该比率：\n$$ \\frac{\\left|\\Delta G_{\\mathrm{Born}}(\\mathrm{F^-})\\right|}{\\left|\\Delta G_{\\mathrm{Born}}(\\mathrm{I^-})\\right|} = \\frac{1/r(\\mathrm{F^-})}{1/r(\\mathrm{I^-})} = \\frac{r(\\mathrm{I^-})}{r(\\mathrm{F^-})} $$\n使用给定的半径：\n$r(\\mathrm{I^-}) = 2.20\\ \\mathrm{\\AA}$\n$r(\\mathrm{F^-}) = 1.33\\ \\mathrm{\\AA}$\n$$ \\frac{r(\\mathrm{I^-})}{r(\\mathrm{F^-})} = \\frac{2.20}{1.33} \\approx 1.654135... $$\n四舍五入到四位有效数字，该比率为 $1.654$。",
            "answer": "$$\\boxed{1.654}$$"
        },
        {
            "introduction": "最后的这个实践从理论计算转向实际应用，这是计算地球化学中的一项常见任务。你将学习如何开发一个协议，使用实验数据来拟合“有效玻恩半径”这一关键参数。通过将模型线性化以进行回归分析，并定量评估其拟合优度，这个练习将理论与作为预测工具的实际应用连接起来。",
            "id": "4070416",
            "problem": "您的任务是构建一个完整的计算协议，通过实施离子溶剂化的经典连续介质静电学图像，从测量的水合自由能中推断离子的有效玻恩半径。您必须从静电学的第一性原理出发，构建水合自由能作为离子电荷和溶剂相对介电常数函数的模型，然后执行约束最小二乘法拟合，以获得在所有溶剂热力学状态下对每种离子都恒定的有效玻恩半径。您还必须定量评估所得模型在不同温度和盐度子集上的拟合优度。\n\n从以下基本基础开始：\n- 在具有真空介电常数 $\\epsilon_0$ 和相对介电常数 $\\epsilon_r$ 的连续介质中，组建电荷分布所需的能量由静电学给出。\n- 离子的电荷为 $z e$，其中 $z$ 为化合价，$e$ 为基本电荷，每摩尔的水合自由能使用阿伏伽德罗常数 $N_A$ 计算。\n- 玻恩溶剂化图像将离子理想化为一个带电球体，其半径我们用有效玻恩半径表示，水合自由能源于真空和介电介质之间的功差。\n\n基于这些基础，推导出水合自由能、离子电荷、有效玻恩半径和相对介电常数之间的工作关系。使用该关系生成一个线性模型，该模型适用于在变化的溶剂状态下，对每种离子的单个有效玻恩半径进行最小二乘法拟合。问题陈述中不允许使用任何快捷公式；您的解答中必须明确给出推导过程。\n\n您将使用以下溶剂条件和测量的水合自由能数据集来拟合每种离子的有效玻恩半径。溶剂状态直接由其相对介电常数值指定，以消除经验介电常数关联中的模糊性。\n\n溶剂状态测试套件（五个条件）：\n- 条件 $1$：温度 $T = 298.15$ K，盐度 $S = 0.0$ mol/kg，相对介电常数 $\\epsilon_r = 78.37$。\n- 条件 $2$：温度 $T = 323.15$ K，盐度 $S = 0.0$ mol/kg，相对介电常数 $\\epsilon_r = 70.00$。\n- 条件 $3$：温度 $T = 298.15$ K，盐度 $S = 4.0$ mol/kg，相对介电常数 $\\epsilon_r = 67.00$。\n- 条件 $4$：温度 $T = 283.15$ K，盐度 $S = 0.0$ mol/kg，相对介电常数 $\\epsilon_r = 88.00$。\n- 条件 $5$：温度 $T = 323.15$ K，盐度 $S = 4.0$ mol/kg，相对介电常数 $\\epsilon_r = 60.00$。\n\n离子集和测量的水合自由能（单位：千焦耳/摩尔，$\\,\\mathrm{kJ/mol}$），按顺序对应上述五个条件：\n- 离子 $\\mathrm{Na}^+$，化合价 $z = +1$：测量的水合自由能 $[-361.3,\\,-360.0,\\,-359.8,\\,-362.0,\\,-359.5]$。\n- 离子 $\\mathrm{Cl}^-$，化合价 $z = -1$：测量的水合自由能 $[-299.2,\\,-298.2,\\,-297.9,\\,-300.3,\\,-297.0]$。\n- 离子 $\\mathrm{Ca}^{2+}$，化合价 $z = +2$：测量的水合自由能 $[-1715.0,\\,-1711.5,\\,-1711.2,\\,-1718.2,\\,-1710.3]$。\n\n执行以下任务：\n1. 从在真空和介电连续体中组建带电球体的静电功出发，推导出水合自由能表达式，使其成为离子化合价 $z$、基本电荷 $e$、真空介电常数 $\\epsilon_0$、阿伏伽德罗常数 $N_A$、有效玻恩半径 $r_B$ 和相对介电常数 $\\epsilon_r$ 的函数。展示如何将其写成一个线性模型，该模型在一个仅依赖于 $\\epsilon_r$ 的标量变量中是线性的，其斜率依赖于 $z$ 和 $r_B$。\n2. 对每种离子，使用零截距的约束线性最小二乘法，根据五个条件下的测量水合自由能和相对介电常数依赖关系来拟合斜率。从拟合的斜率中，推断出该离子在所有条件下都恒定的单个有效玻恩半径 $r_B$。以埃（$\\,\\mathrm{\\AA}$）为单位表示 $r_B$。\n3. 对每种离子，计算定量的拟合优度指标：\n   - 所有五个条件下的均方根误差（RMSE），以 $\\,\\mathrm{kJ/mol}$ 表示。\n   - 纯水条件子集（$S = 0.0$ mol/kg，即条件 $1$、$2$ 和 $4$）下的 RMSE，以 $\\,\\mathrm{kJ/mol}$ 表示。\n   - 盐水条件子集（$S  0$ mol/kg，即条件 $3$ 和 $5$）下的 RMSE，以 $\\,\\mathrm{kJ/mol}$ 表示。\n   - 所有五个条件下的决定系数 $R^2$（无量纲）。\n4. 将您的完整协议在代码中实现，使用提供的溶剂状态和测量的水合自由能。\n\n要使用的常数：\n- 阿伏伽德罗常数 $N_A = 6.02214076 \\times 10^{23}$ $\\mathrm{mol}^{-1}$。\n- 真空介电常数 $\\epsilon_0 = 8.8541878128 \\times 10^{-12}$ $\\mathrm{F/m}$。\n- 基本电荷 $e = 1.602176634 \\times 10^{-19}$ $\\mathrm{C}$。\n- 在您的推导中，使用精确因子 $1/(8 \\pi \\epsilon_0)$。\n\n数值单位约定：\n- 所有水合自由能必须以 $\\,\\mathrm{kJ/mol}$ 处理。\n- 有效玻恩半径必须以埃（$\\,\\mathrm{\\AA}$）报告。\n- 本问题中不出现角度。\n- 不出现百分比；任何分数数量必须是小数。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含离子 $\\mathrm{Na}^+$、$\\mathrm{Cl}^-$ 和 $\\mathrm{Ca}^{2+}$ 的以下结果：\n- 拟合的有效玻恩半径（单位 $\\,\\mathrm{\\AA}$）。\n- 所有条件下的 RMSE（单位 $\\,\\mathrm{kJ/mol}$）。\n- 纯水条件（$S=0$）下的 RMSE（单位 $\\,\\mathrm{kJ/mol}$）。\n- 盐水条件（$S0$）下的 RMSE（单位 $\\,\\mathrm{kJ/mol}$）。\n- 所有条件下的决定系数 $R^2$。\n\n例如，输出格式必须是：\n$[\\text{rB\\_Na\\_Ang},\\text{RMSE\\_Na\\_all},\\text{RMSE\\_Na\\_pure},\\text{RMSE\\_Na\\_saline},\\text{R2\\_Na},\\text{rB\\_Cl\\_Ang},\\text{RMSE\\_Cl\\_all},\\text{RMSE\\_Cl\\_pure},\\text{RMSE\\_Cl\\_saline},\\text{R2\\_Cl},\\text{rB\\_Ca\\_Ang},\\text{RMSE\\_Ca\\_all},\\text{RMSE\\_Ca\\_pure},\\text{RMSE\\_Ca\\_saline},\\text{R2\\_Ca}]$。\n\n将您的解决方案设计为确定性的和自包含的。不允许外部输入。确保所有计算在科学上是现实的并且量纲一致。在最终输出中，将半径和 $R^2$ 四舍五入到六位小数，RMSE 值四舍五入到三位小数。",
            "solution": "该问题要求开发一个计算协议，根据实验水合自由能数据确定几种离子的有效玻恩半径 $r_B$。这包括从第一性原理推导玻恩溶剂化模型，将其表述为适合最小二乘法拟合的线性模型，执行拟合以找到每种离子的 $r_B$，并评估拟合优度。\n\n### 步骤 1：摩尔水合自由能的玻恩模型推导\n\n玻恩模型将离子近似为一个半径为 $r_B$、总电荷为 $Q$ 的刚性带电球体。水合自由能 $\\Delta G_{hyd}$ 是将离子从真空（$\\epsilon_r = 1$）转移到代表溶剂的介电连续体（相对介电常数为 $\\epsilon_r  1$）时静电自由能的变化。\n\n首先，我们计算带电球体的静电自能，即在其表面上组建电荷 $Q$ 所做的功。在绝对介电常数为 $\\epsilon$ 的介质中，半径为 $r_B$、带有电荷 $q$ 的球体表面的静电势 $V$ 由 $V = \\frac{q}{4\\pi\\epsilon r_B}$ 给出。将一个额外的无穷小电荷 $dq$ 从无穷远处带到球体表面所需的增量功 $dW$ 是 $dW = V dq$。\n\n将球体从 $0$ 充电到最终电荷 $Q$ 的总功 $W$ 是这个增量功的积分：\n$$W = \\int_0^Q V(q) \\, dq = \\int_0^Q \\frac{q}{4\\pi\\epsilon r_B} \\, dq = \\frac{1}{4\\pi\\epsilon r_B} \\left[ \\frac{q^2}{2} \\right]_0^Q = \\frac{Q^2}{8\\pi\\epsilon r_B}$$\n\n这个功代表了离子在介质中的静电自能。\n\n对于真空中的离子，介电常数是真空介电常数 $\\epsilon = \\epsilon_0$（因为 $\\epsilon_r = 1$）。真空中的自能 $W_{vac}$ 是：\n$$W_{vac} = \\frac{Q^2}{8\\pi\\epsilon_0 r_B}$$\n\n对于在相对介电常数为 $\\epsilon_r$ 的溶剂中的同一个离子，绝对介电常数为 $\\epsilon = \\epsilon_r \\epsilon_0$。在溶剂中的自能 $W_{solv}$ 是：\n$$W_{solv} = \\frac{Q^2}{8\\pi\\epsilon_r\\epsilon_0 r_B}$$\n\n水合自由能 $\\Delta G_{hyd}$ 定义为溶剂化状态和真空状态之间的能量差：\n$$\\Delta G_{hyd} = W_{solv} - W_{vac} = \\frac{Q^2}{8\\pi\\epsilon_r\\epsilon_0 r_B} - \\frac{Q^2}{8\\pi\\epsilon_0 r_B}$$\n提取公因子得到单个离子的玻恩方程：\n$$\\Delta G_{hyd} = \\frac{Q^2}{8\\pi\\epsilon_0 r_B} \\left( \\frac{1}{\\epsilon_r} - 1 \\right)$$\n化合价为 $z$ 的离子的电荷是 $Q = z e$，其中 $e$ 是基本电荷。将其代入方程中得到：\n$$\\Delta G_{hyd} = \\frac{(ze)^2}{8\\pi\\epsilon_0 r_B} \\left( \\frac{1}{\\epsilon_r} - 1 \\right)$$\n问题提供了以摩尔为基础的水合自由能 $\\Delta G_{hyd,m}$。为了得到摩尔量，我们将单个离子的能量乘以阿伏伽德罗常数 $N_A$：\n$$\\Delta G_{hyd,m} = N_A \\frac{(ze)^2}{8\\pi\\epsilon_0 r_B} \\left( \\frac{1}{\\epsilon_r} - 1 \\right)$$\n\n### 步骤 2：用于最小二乘法拟合的线性化\n\n目标是为每种离子找到一个单一的有效玻恩半径 $r_B$，使其能够最好地解释在各种溶剂条件（即不同的 $\\epsilon_r$ 值）下测量的水合自由能。玻恩方程可以转换成零截距的线性模型形式 $Y = mX$。\n\n我们将因变量 $Y$ 定义为测量的摩尔水合自由能，$Y = \\Delta G_{hyd,m}$。\n我们将自变量 $X$ 定义为依赖于溶剂相对介电常数的项，$X = \\left( \\frac{1}{\\epsilon_r} - 1 \\right)$。\n通过这些定义，玻恩方程变为：\n$$Y = \\left( N_A \\frac{(ze)^2}{8\\pi\\epsilon_0 r_B} \\right) X$$\n这是一个形式为 $Y = mX$ 的线性方程，其中斜率 $m$ 是：\n$$m = N_A \\frac{(ze)^2}{8\\pi\\epsilon_0 r_B}$$\n对于一组 $N$ 个实验数据点 $(X_i, Y_i)$，其中 $Y_i$ 是条件 $i$ 下测量的水合自由能，而 $X_i = (1/\\epsilon_{r,i} - 1)$，使残差平方和 $\\sum_{i=1}^N (Y_i - mX_i)^2$ 最小化的斜率 $m$ 由通过原点的线性回归公式给出：\n$$m = \\frac{\\sum_{i=1}^N X_i Y_i}{\\sum_{i=1}^N X_i^2}$$\n一旦从拟合中确定了斜率 $m$，就可以通过重新排列斜率的表达式来计算有效玻恩半径 $r_B$：\n$$r_B = N_A \\frac{(ze)^2}{8\\pi\\epsilon_0 m}$$\n所有计算都必须使用一致的国际单位制（SI）单位。提供的能量 $\\Delta G_{hyd,m}$ 单位是 $\\mathrm{kJ/mol}$，在计算斜率 $m$ 之前必须转换为 $\\mathrm{J/mol}$。得到的 $r_B$ 将以米为单位，必须转换为埃（$\\mathrm{\\AA}$）才能用于最终报告（$1 \\, \\mathrm{\\AA} = 10^{-10} \\, \\mathrm{m}$）。\n\n### 步骤 3：拟合优度指标\n\n在拟合模型并获得 $r_B$ 的值后，我们可以计算每个条件的预测水合自由能 $\\Delta G_{pred,i}$：\n$$\\Delta G_{pred,i} = m \\left( \\frac{1}{\\epsilon_{r,i}} - 1 \\right)$$\n为了评估模型的性能，我们使用观测能量 $\\Delta G_{obs,i}$ 和预测能量 $\\Delta G_{pred,i}$ 计算以下指标。\n\n均方根误差（RMSE）测量残差的标准差：\n$$\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^N (\\Delta G_{obs,i} - \\Delta G_{pred,i})^2}$$\n这将对三组数据进行计算：所有五个条件、三个纯水条件（$S=0$）和两个盐水条件（$S0$）。\n\n决定系数 $R^2$ 量化了因变量方差中可由自变量预测的比例。其定义为：\n$$R^2 = 1 - \\frac{\\mathrm{SS}_{res}}{\\mathrm{SS}_{tot}}$$\n其中 $\\mathrm{SS}_{res} = \\sum_{i=1}^N (\\Delta G_{obs,i} - \\Delta G_{pred,i})^2$ 是残差平方和，而 $\\mathrm{SS}_{tot} = \\sum_{i=1}^N (\\Delta G_{obs,i} - \\overline{\\Delta G_{obs}})^2$ 是总平方和，其中 $\\overline{\\Delta G_{obs}}$ 是观测水合能的平均值。此计算将针对所有五个条件执行。\n\n所描述的程序将应用于每种离子（$\\mathrm{Na}^+$、$\\mathrm{Cl}^-$、$\\mathrm{Ca}^{2+}$）的数据，以确定它们各自的有效玻恩半径和拟合优度统计数据。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives effective Born radii from hydration free energies and evaluates the model fit.\n    \"\"\"\n    \n    # Define physical constants\n    N_A = 6.02214076e23  # Avogadro's number (mol^-1)\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C)\n\n    # Define solvent and ion data\n    solvent_states = [\n        # T (K), S (mol/kg), epsilon_r\n        (298.15, 0.0, 78.37),  # Cond 1\n        (323.15, 0.0, 70.00),  # Cond 2\n        (298.15, 4.0, 67.00),  # Cond 3\n        (283.15, 0.0, 88.00),  # Cond 4\n        (323.15, 4.0, 60.00),  # Cond 5\n    ]\n    \n    ion_data = [\n        {'name': 'Na+', 'z': 1, 'dG_hyd_obs': np.array([-361.3, -360.0, -359.8, -362.0, -359.5])},\n        {'name': 'Cl-', 'z': -1, 'dG_hyd_obs': np.array([-299.2, -298.2, -297.9, -300.3, -297.0])},\n        {'name': 'Ca2+', 'z': 2, 'dG_hyd_obs': np.array([-1715.0, -1711.5, -1711.2, -1718.2, -1710.3])},\n    ]\n\n    # Indices for data subsets\n    pure_water_indices = [i for i, state in enumerate(solvent_states) if state[1] == 0.0]\n    saline_water_indices = [i for i, state in enumerate(solvent_states) if state[1]  0.0]\n\n    # Prepare independent variable X for the linear model Y = mX\n    epsilon_r_values = np.array([s[2] for s in solvent_states])\n    X = (1.0 / epsilon_r_values) - 1.0\n\n    all_results = []\n\n    for ion in ion_data:\n        z = ion['z']\n        dG_obs_kJ_mol = ion['dG_hyd_obs']\n        \n        # Convert observed energies to J/mol for consistent SI units\n        Y_J_mol = dG_obs_kJ_mol * 1000.0\n\n        # --- Step 2: Constrained Linear Least-Squares Fit ---\n        # Model: Y = mX. Slope m = sum(X*Y) / sum(X*X)\n        slope_m = np.sum(X * Y_J_mol) / np.sum(X**2)\n\n        # Infer effective Born radius from the slope\n        # m = N_A * (z*e)^2 / (8*pi*epsilon_0*r_B) = r_B = N_A * (z*e)^2 / (8*pi*epsilon_0*m)\n        r_B_meters = (N_A * (z * E_CHARGE)**2) / (8 * np.pi * EPSILON_0 * slope_m)\n        \n        # Convert radius from meters to angstroms\n        r_B_angstroms = r_B_meters * 1e10\n\n        # --- Step 3: Goodness-of-Fit Metrics ---\n        # Calculate predicted energies using the fitted model\n        dG_pred_J_mol = slope_m * X\n        dG_pred_kJ_mol = dG_pred_J_mol / 1000.0\n\n        # Helper function for RMSE\n        def calculate_rmse(obs, pred):\n            return np.sqrt(np.mean((obs - pred)**2))\n\n        # RMSE across all conditions\n        rmse_all = calculate_rmse(dG_obs_kJ_mol, dG_pred_kJ_mol)\n        \n        # RMSE for pure water subset\n        rmse_pure = calculate_rmse(dG_obs_kJ_mol[pure_water_indices], dG_pred_kJ_mol[pure_water_indices])\n        \n        # RMSE for saline subset\n        rmse_saline = calculate_rmse(dG_obs_kJ_mol[saline_water_indices], dG_pred_kJ_mol[saline_water_indices])\n\n        # Coefficient of determination R^2\n        ss_res = np.sum((dG_obs_kJ_mol - dG_pred_kJ_mol)**2)\n        ss_tot = np.sum((dG_obs_kJ_mol - np.mean(dG_obs_kJ_mol))**2)\n        r_squared = 1 - (ss_res / ss_tot)\n        \n        # Collect results for this ion\n        all_results.extend([\n            round(r_B_angstroms, 6),\n            round(rmse_all, 3),\n            round(rmse_pure, 3),\n            round(rmse_saline, 3),\n            round(r_squared, 6)\n        ])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}