{
    "hands_on_practices": [
        {
            "introduction": "This first exercise serves as a fundamental building block for understanding ion association models. By considering a simple 1:1 electrolyte and assuming ideal behavior (activity coefficients are unity), we can isolate and master the core algebraic steps involving mass balance and the law of mass action. This practice  is essential for building the intuition needed to tackle more complex, non-ideal systems.",
            "id": "4083233",
            "problem": "An aqueous sodium chloride solution at standard laboratory conditions is represented using a classical ion association model in which only three chemical species are present: the sodium ion $\\mathrm{Na}^{+}$, the chloride ion $\\mathrm{Cl}^{-}$, and the neutral contact ion pair $\\mathrm{NaCl}^{0}$. The total molality of sodium chloride added to water is $m_{\\mathrm{NaCl,total}} = 1.0\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$. Assume an ideal solution for speciation (activity coefficients equal to unity) and neglect all other associated species or hydrolysis products. The molality-based ion-pair association constant is given as $K_{\\mathrm{ip}} = 0.2\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ at the stated conditions.\n\nStarting from the law of mass action and conservation laws appropriate for this system, determine the molality of the neutral ion pair $m_{\\mathrm{NaCl}^{0}}$ and the molalities of the free ions $m_{\\mathrm{Na}^{+}}$ and $m_{\\mathrm{Cl}^{-}}$. Express all molalities in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ and round your results to four significant figures. Report your final values in the order $\\left(m_{\\mathrm{NaCl}^{0}},\\, m_{\\mathrm{Na}^{+}},\\, m_{\\mathrm{Cl}^{-}}\\right)$.",
            "solution": "The problem requires the determination of the equilibrium molalities of the species $\\mathrm{Na}^{+}$, $\\mathrm{Cl}^{-}$, and $\\mathrm{NaCl}^{0}$ in an aqueous solution, given the total molality of added $\\mathrm{NaCl}$ and the ion-pair association constant. The solution is based on the law of mass action and principles of mass conservation.\n\nThe chemical equilibrium for the formation of the neutral ion pair $\\mathrm{NaCl}^{0}$ from its constituent free ions is given by the reaction:\n$$\n\\mathrm{Na}^{+} + \\mathrm{Cl}^{-} \\rightleftharpoons \\mathrm{NaCl}^{0}\n$$\nThe law of mass action for this reaction defines the molality-based association constant, $K_{\\mathrm{ip}}$.\n$$\nK_{\\mathrm{ip}} = \\frac{a_{\\mathrm{NaCl}^{0}}}{a_{\\mathrm{Na}^{+}} a_{\\mathrm{Cl}^{-}}}\n$$\nwhere $a_i$ represents the activity of species $i$. The problem specifies the assumption of an ideal solution for the purpose of speciation, which means the activity coefficients, $\\gamma_i$, of all species are equal to unity ($1$). Since activity is defined as $a_i = \\gamma_i m_i$, where $m_i$ is the molality, this assumption simplifies the mass action expression to:\n$$\nK_{\\mathrm{ip}} = \\frac{m_{\\mathrm{NaCl}^{0}}}{m_{\\mathrm{Na}^{+}} m_{\\mathrm{Cl}^{-}}}\n$$\nThe problem provides $K_{\\mathrm{ip}} = 0.2\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$.\n\nNext, we establish the mass balance (conservation) equations for the sodium and chloride components. The total molality of sodium chloride added to the solution is $m_{\\mathrm{NaCl,total}} = 1.0\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$.\n\nThe total molality of sodium, $m_{\\mathrm{Na,total}}$, is distributed between the free sodium ion, $\\mathrm{Na}^{+}$, and the ion pair, $\\mathrm{NaCl}^{0}$. Thus, the mass balance for sodium is:\n$$\nm_{\\mathrm{Na,total}} = m_{\\mathrm{Na}^{+}} + m_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{NaCl,total}}\n$$\nSimilarly, the total molality of chloride, $m_{\\mathrm{Cl,total}}$, is distributed between the free chloride ion, $\\mathrm{Cl}^{-}$, and the ion pair, $\\mathrm{NaCl}^{0}$. The mass balance for chloride is:\n$$\nm_{\\mathrm{Cl,total}} = m_{\\mathrm{Cl}^{-}} + m_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{NaCl,total}}\n$$\nFrom these two mass balance equations, it is evident that:\n$$\nm_{\\mathrm{Na}^{+}} + m_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{Cl}^{-}} + m_{\\mathrm{NaCl}^{0}}\n$$\nThis implies that the molalities of the free ions must be equal:\n$$\nm_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}}\n$$\nTo solve the system, let us define a variable $x$ representing the molality of the free ions:\n$$\nx = m_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}}\n$$\nUsing the mass balance equation for sodium, we can express the molality of the ion pair, $m_{\\mathrm{NaCl}^{0}}$, in terms of $x$:\n$$\nm_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{NaCl,total}} - m_{\\mathrm{Na}^{+}} = m_{\\mathrm{NaCl,total}} - x\n$$\nNow, substitute the expressions for $m_{\\mathrm{Na}^{+}}$, $m_{\\mathrm{Cl}^{-}}$, and $m_{\\mathrm{NaCl}^{0}}$ into the law of mass action equation:\n$$\nK_{\\mathrm{ip}} = \\frac{m_{\\mathrm{NaCl,total}} - x}{x \\cdot x} = \\frac{m_{\\mathrm{NaCl,total}} - x}{x^2}\n$$\nRearranging this equation yields a quadratic equation in $x$:\n$$\nK_{\\mathrm{ip}} x^2 = m_{\\mathrm{NaCl,total}} - x\n$$\n$$\nK_{\\mathrm{ip}} x^2 + x - m_{\\mathrm{NaCl,total}} = 0\n$$\nThis is a standard quadratic equation of the form $ax^2 + bx + c = 0$, with $a = K_{\\mathrm{ip}}$, $b = 1$, and $c = -m_{\\mathrm{NaCl,total}}$. The solution for $x$ is given by the quadratic formula:\n$$\nx = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} = \\frac{-1 \\pm \\sqrt{1^2 - 4(K_{\\mathrm{ip}})(-m_{\\mathrm{NaCl,total}})}}{2K_{\\mathrm{ip}}}\n$$\n$$\nx = \\frac{-1 \\pm \\sqrt{1 + 4 K_{\\mathrm{ip}} m_{\\mathrm{NaCl,total}}}}{2 K_{\\mathrm{ip}}}\n$$\nSince $x$ represents molality, it must be a positive, real quantity. The term under the square root, $1 + 4 K_{\\mathrm{ip}} m_{\\mathrm{NaCl,total}}$, is positive since $K_{\\mathrm{ip}} > 0$ and $m_{\\mathrm{NaCl,total}} > 0$. Furthermore, $\\sqrt{1 + 4 K_{\\mathrm{ip}} m_{\\mathrm{NaCl,total}}} > 1$. Therefore, the root with the minus sign, $\\frac{-1 - \\sqrt{\\dots}}{2 K_{\\mathrm{ip}}}$, would yield a negative value for $x$, which is physically meaningless. We must choose the positive root:\n$$\nx = \\frac{-1 + \\sqrt{1 + 4 K_{\\mathrm{ip}} m_{\\mathrm{NaCl,total}}}}{2 K_{\\mathrm{ip}}}\n$$\nWe are given $m_{\\mathrm{NaCl,total}} = 1.0\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ and $K_{\\mathrm{ip}} = 0.2\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$. Substituting these values into the expression for $x$:\n$$\nx = \\frac{-1 + \\sqrt{1 + 4(0.2)(1.0)}}{2(0.2)} = \\frac{-1 + \\sqrt{1 + 0.8}}{0.4} = \\frac{-1 + \\sqrt{1.8}}{0.4}\n$$\nCalculating the numerical value:\n$$\nx \\approx \\frac{-1 + 1.3416407865}{0.4} \\approx \\frac{0.3416407865}{0.4} \\approx 0.85410196625\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\nTherefore, the molalities of the free ions are:\n$$\nm_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}} = x \\approx 0.85410196625\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\nRounding to four significant figures, we get:\n$$\nm_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}} = 0.8541\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\nNow, we calculate the molality of the neutral ion pair, $m_{\\mathrm{NaCl}^{0}}$:\n$$\nm_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{NaCl,total}} - x = 1.0 - 0.85410196625 \\approx 0.14589803375\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\nRounding to four significant figures:\n$$\nm_{\\mathrm{NaCl}^{0}} = 0.1459\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\nThe final calculated molalities are $m_{\\mathrm{NaCl}^{0}} = 0.1459\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$, $m_{\\mathrm{Na}^{+}} = 0.8541\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$, and $m_{\\mathrm{Cl}^{-}} = 0.8541\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1459 & 0.8541 & 0.8541 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building upon foundational principles, this practice explores a critical consequence of ion pairing: the modification of ionic strength. You will quantify how the formation of a neutral pair in a 2:2 electrolyte solution reduces the concentration of free charges, a key parameter that governs electrostatic interactions in solution . Understanding this effect is crucial as it directly influences the activity coefficients of all ions present in more sophisticated models.",
            "id": "4083249",
            "problem": "An aqueous solution at temperature $T$ and pressure $P$ contains only the species $\\mathrm{Mg}^{2+}$, $\\mathrm{SO}_{4}^{2-}$, and the neutral ion pair $\\mathrm{MgSO}_{4}^{0}$. The solution is prepared by dissolving stoichiometric magnesium sulfate to a total analytical molality of $m_{T} = 0.5\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$, so that the total magnesium and total sulfate molalities are each $0.5\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$. Ion association proceeds via\n$$\\mathrm{Mg}^{2+} + \\mathrm{SO}_{4}^{2-} \\rightleftharpoons \\mathrm{MgSO}_{4}^{0}.$$\nAssume an ideal molality-scale standard state for all species (activity coefficients equal to $1$), neglect all other complexes, and treat water as the only solvent. The molality-based ion-pairing equilibrium constant is given as $K_{\\mathrm{ip}} = 10\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ at the specified $T$ and $P$, defined by the law of mass action\n$$K_{\\mathrm{ip}} = \\frac{m_{\\mathrm{MgSO}_{4}^{0}}}{m_{\\mathrm{Mg}^{2+}}\\,m_{\\mathrm{SO}_{4}^{2-}}}.$$\nUse the definition of ionic strength on the molality scale,\n$$I = \\frac{1}{2}\\sum_{i} m_{i} z_{i}^{2},$$\nwith $z_{i}$ the charge number of species $i$ and $m_{i}$ its molality. All neutral species have $z_{i}=0$.\n\nStarting from these definitions and conservation of mass and charge, compute:\n1. The fraction of total magnesium present as the neutral ion pair $\\mathrm{MgSO}_{4}^{0}$ at equilibrium.\n2. The change in ionic strength, $\\Delta I$, relative to the hypothetical fully dissociated state at the same total molality $m_{T}$.\n\nReport your final result as a row vector $\\big[f\\ \\ \\Delta I\\big]$, where $f$ is the dimensionless fraction of magnesium paired and $\\Delta I$ is in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$. Round both entries to four significant figures. Do not include units in your final boxed answer.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, and objective. It provides a complete and consistent set of data and definitions to solve a standard chemical equilibrium problem.\n\nLet $m_{\\mathrm{Mg}^{2+}}$, $m_{\\mathrm{SO}_{4}^{2-}}$, and $m_{\\mathrm{MgSO}_{4}^{0}}$ be the equilibrium molalities (in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$) of the magnesium ion, sulfate ion, and the neutral magnesium sulfate ion pair, respectively. The total analytical molality of magnesium sulfate is given as $m_{T} = 0.5\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$.\n\nAccording to the principle of conservation of mass for magnesium and sulfate, we have:\n$$m_{T} = m_{\\mathrm{Mg}^{2+}} + m_{\\mathrm{MgSO}_{4}^{0}}$$\n$$m_{T} = m_{\\mathrm{SO}_{4}^{2-}} + m_{\\mathrm{MgSO}_{4}^{0}}$$\nFrom these two equations, it is clear that the equilibrium molalities of the free ions must be equal:\n$$m_{\\mathrm{Mg}^{2+}} = m_{\\mathrm{SO}_{4}^{2-}}$$\nLet us define $x$ as the equilibrium molality of the ion pair, $x = m_{\\mathrm{MgSO}_{4}^{0}}$. Then, the molality of each free ion can be expressed as:\n$$m_{\\mathrm{Mg}^{2+}} = m_{\\mathrm{SO}_{4}^{2-}} = m_{T} - x$$\nThe law of mass action is given by:\n$$K_{\\mathrm{ip}} = \\frac{m_{\\mathrm{MgSO}_{4}^{0}}}{m_{\\mathrm{Mg}^{2+}}\\,m_{\\mathrm{SO}_{4}^{2-}}}$$\nSubstituting the expressions in terms of $x$ and $m_{T}$ into the equilibrium equation yields:\n$$K_{\\mathrm{ip}} = \\frac{x}{(m_{T} - x)(m_{T} - x)} = \\frac{x}{(m_{T} - x)^{2}}$$\nWe are given $K_{\\mathrm{ip}} = 10\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ and $m_{T} = 0.5\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$. Substituting these values:\n$$10 = \\frac{x}{(0.5 - x)^{2}}$$\nThis equation can be rearranged into a standard quadratic form, $ax^2+bx+c=0$:\n$$10(0.5 - x)^{2} = x$$\n$$10(0.25 - x + x^{2}) = x$$\n$$2.5 - 10x + 10x^{2} = x$$\n$$10x^{2} - 11x + 2.5 = 0$$\nWe solve for $x$ using the quadratic formula, $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$x = \\frac{11 \\pm \\sqrt{(-11)^{2} - 4(10)(2.5)}}{2(10)}$$\n$$x = \\frac{11 \\pm \\sqrt{121 - 100}}{20}$$\n$$x = \\frac{11 \\pm \\sqrt{21}}{20}$$\nThis gives two possible mathematical solutions for $x$:\n$$x_1 = \\frac{11 + \\sqrt{21}}{20} \\approx \\frac{11 + 4.5826}{20} \\approx 0.7791\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$$\n$$x_2 = \\frac{11 - \\sqrt{21}}{20} \\approx \\frac{11 - 4.5826}{20} \\approx 0.3209\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$$\nSince $x$ represents the molality of the ion pair, it cannot exceed the total analytical molality $m_{T} = 0.5\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$. Therefore, the first root $x_1$ is physically unrealistic, and the correct solution is $x_2$.\n$$x = m_{\\mathrm{MgSO}_{4}^{0}} = \\frac{11 - \\sqrt{21}}{20}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1} \\approx 0.32087\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$$\n\n**1. Compute the fraction of magnesium present as the neutral ion pair.**\nThe fraction, $f$, is the ratio of the molality of the ion pair to the total magnesium molality:\n$$f = \\frac{m_{\\mathrm{MgSO}_{4}^{0}}}{m_{T}} = \\frac{x}{m_{T}}$$\n$$f = \\frac{(11 - \\sqrt{21})/20}{0.5} = \\frac{11 - \\sqrt{21}}{10}$$\n$$f \\approx 0.64174$$\nRounding to four significant figures, $f = 0.6417$.\n\n**2. Compute the change in ionic strength, $\\Delta I$.**\nFirst, we calculate the ionic strength of the hypothetical fully dissociated state, $I_{\\text{dissociated}}$. In this state, $m_{\\mathrm{Mg}^{2+}} = m_{T} = 0.5$ and $m_{\\mathrm{SO}_{4}^{2-}} = m_{T} = 0.5$. The charge numbers are $z_{\\mathrm{Mg}^{2+}} = +2$ and $z_{\\mathrm{SO}_{4}^{2-}} = -2$.\n$$I_{\\text{dissociated}} = \\frac{1}{2}\\sum_{i} m_{i} z_{i}^{2} = \\frac{1}{2} \\left[ m_{\\mathrm{Mg}^{2+}} (z_{\\mathrm{Mg}^{2+}})^{2} + m_{\\mathrm{SO}_{4}^{2-}} (z_{\\mathrm{SO}_{4}^{2-}})^{2} \\right]$$\n$$I_{\\text{dissociated}} = \\frac{1}{2} \\left[ (0.5)(2)^{2} + (0.5)(-2)^{2} \\right] = \\frac{1}{2} [2 + 2] = 2.0\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$$\nNext, we calculate the ionic strength at equilibrium, $I_{\\text{equilibrium}}$. The molalities of the ions are $m_{\\mathrm{Mg}^{2+}} = m_{\\mathrm{SO}_{4}^{2-}} = m_{T} - x$. The neutral ion pair does not contribute to the ionic strength ($z=0$).\n$$m_{\\mathrm{Mg}^{2+}} = m_{\\mathrm{SO}_{4}^{2-}} = 0.5 - \\frac{11 - \\sqrt{21}}{20} = \\frac{10 - (11 - \\sqrt{21})}{20} = \\frac{\\sqrt{21} - 1}{20}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$$\n$$I_{\\text{equilibrium}} = \\frac{1}{2} \\left[ (m_{T}-x)(2)^{2} + (m_{T}-x)(-2)^{2} \\right] = 4(m_{T}-x)$$\n$$I_{\\text{equilibrium}} = 4 \\left( \\frac{\\sqrt{21} - 1}{20} \\right) = \\frac{\\sqrt{21} - 1}{5}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$$\n$$I_{\\text{equilibrium}} \\approx \\frac{4.5826 - 1}{5} \\approx 0.71651\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$$\nThe change in ionic strength is $\\Delta I = I_{\\text{equilibrium}} - I_{\\text{dissociated}}$.\n$$\\Delta I = \\frac{\\sqrt{21} - 1}{5} - 2 = \\frac{\\sqrt{21} - 1 - 10}{5} = \\frac{\\sqrt{21} - 11}{5}$$\n$$\\Delta I \\approx -1.28348$$\nRounding to four significant figures, $\\Delta I = -1.283\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$.\n\nThe final result is the row vector $[f, \\Delta I]$.\n$$f \\approx 0.6417$$\n$$\\Delta I \\approx -1.283$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.6417 & -1.283 \\end{pmatrix}}$$"
        },
        {
            "introduction": "This advanced computational practice integrates the concepts of competitive ion pairing and non-ideal solution behavior, presenting a challenge analogous to real-world geochemical modeling. You will develop a model for a multi-component system where activity coefficients are calculated self-consistently with the equilibrium speciation using the Davies equation . This exercise highlights the necessity of numerical methods for solving the coupled nonlinear equations that describe complex aqueous solutions found in nature.",
            "id": "4083189",
            "problem": "You are tasked with computing the distribution of calcium ion $\\,\\mathrm{Ca^{2+}}\\,$ among the neutral ion pairs $\\,\\mathrm{CaSO_4^0}\\,$, $\\,\\mathrm{CaCO_3^0}\\,$, and the free ion $\\,\\mathrm{Ca^{2+}}\\,$ under a set of closed-system conditions specified by given total analytical concentrations and ion association constants. The system is at standard temperature $\\,25\\,^\\circ\\mathrm{C}\\,$ and pressure, and only the following aqueous species are present: $\\,\\mathrm{Ca^{2+}}\\,$, $\\,\\mathrm{SO_4^{2-}}\\,$, $\\,\\mathrm{CO_3^{2-}}\\,$, $\\,\\mathrm{CaSO_4^0}\\,$, and $\\,\\mathrm{CaCO_3^0}\\,$. Assume that the neutral species have unit activity coefficients, the solution is well mixed, and there are no other complexation reactions. Concentrations are on the molarity scale, denoted by $\\,\\mathrm{M}\\,$ (moles per liter). All calculations must use physically consistent thermodynamic definitions.\n\nFundamental base for the calculation:\n- The law of mass action defines the ion association constants for neutral pairs as $\\,K_{\\mathrm{ip}} = \\dfrac{a_{\\text{pair}}}{a_{\\text{cation}}\\,a_{\\text{anion}}}\\,$, where $\\,a_i\\,$ denotes the activity of species $\\,i\\,$.\n- For each species, activity is $\\,a_i = \\gamma_i\\,c_i\\,$, where $\\,\\gamma_i\\,$ is the activity coefficient and $\\,c_i\\,$ is the molar concentration.\n- The ionic strength $\\,I\\,$ of the solution is $$I = \\dfrac{1}{2}\\sum_i c_i z_i^2,$$ where $\\,z_i\\,$ is the charge number of ion $\\,i\\,$ and the sum is over the charged (free) ions only.\n- The Davies equation (a widely used extension of the Debye–Hückel theory) at $\\,25\\,^\\circ\\mathrm{C}\\,$ gives the activity coefficient of an ion of charge $\\,z\\,$ as $$\\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right),$$ where $\\,A = 0.51\\,$ is the Debye–Hückel constant at $\\,25\\,^\\circ\\mathrm{C}\\,$.\n\nUnknowns and constraints:\n- Let $\\,c_{\\mathrm{Ca^{2+}}}\\,$, $\\,c_{\\mathrm{SO_4^{2-}}}\\,$, and $\\,c_{\\mathrm{CO_3^{2-}}}\\,$ denote the free ion concentrations in $\\,\\mathrm{M}\\,$.\n- The neutral pair concentrations satisfy the mass action relationships:\n  $$c_{\\mathrm{CaSO_4^0}} = K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}}\\,\\dfrac{\\gamma_{\\mathrm{Ca^{2+}}}\\,\\gamma_{\\mathrm{SO_4^{2-}}}}{\\gamma_{\\mathrm{CaSO_4^0}}}\\,c_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{SO_4^{2-}}},\\quad \\gamma_{\\mathrm{CaSO_4^0}} = 1,$$\n  $$c_{\\mathrm{CaCO_3^0}} = K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}}\\,\\dfrac{\\gamma_{\\mathrm{Ca^{2+}}}\\,\\gamma_{\\mathrm{CO_3^{2-}}}}{\\gamma_{\\mathrm{CaCO_3^0}}}\\,c_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{CO_3^{2-}}},\\quad \\gamma_{\\mathrm{CaCO_3^0}} = 1.$$\n- The mass balances (analytical totals) are\n  $$C_{\\mathrm{Ca}}^{\\mathrm{T}} = c_{\\mathrm{Ca^{2+}}} + c_{\\mathrm{CaSO_4^0}} + c_{\\mathrm{CaCO_3^0}},$$\n  $$C_{\\mathrm{SO_4}}^{\\mathrm{T}} = c_{\\mathrm{SO_4^{2-}}} + c_{\\mathrm{CaSO_4^0}},$$\n  $$C_{\\mathrm{CO_3}}^{\\mathrm{T}} = c_{\\mathrm{CO_3^{2-}}} + c_{\\mathrm{CaCO_3^0}}.$$\n- Electrically neutral closed systems without additional supporting electrolyte satisfy $$2\\,C_{\\mathrm{Ca}}^{\\mathrm{T}} = 2\\,C_{\\mathrm{SO_4}}^{\\mathrm{T}} + 2\\,C_{\\mathrm{CO_3}}^{\\mathrm{T}},$$ which is enforced in the provided test cases.\n\nYour computational task:\n- For each given parameter set, solve for $\\,c_{\\mathrm{Ca^{2+}}}\\,$, $\\,c_{\\mathrm{SO_4^{2-}}}\\,$, and $\\,c_{\\mathrm{CO_3^{2-}}}\\,$ such that the mass balances and mass action relationships are simultaneously satisfied, with activity coefficients computed self-consistently via the Davies equation using the ionic strength from the free ions.\n- Compute the fractions of total calcium present as $\\,\\mathrm{Ca^{2+}}\\,$, $\\,\\mathrm{CaSO_4^0}\\,$, and $\\,\\mathrm{CaCO_3^0}\\,$, respectively:\n  $$f_{\\mathrm{Ca^{2+}}} = \\dfrac{c_{\\mathrm{Ca^{2+}}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}},\\quad f_{\\mathrm{CaSO_4^0}} = \\dfrac{c_{\\mathrm{CaSO_4^0}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}},\\quad f_{\\mathrm{CaCO_3^0}} = \\dfrac{c_{\\mathrm{CaCO_3^0}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}}.$$\n- Express all input concentrations in $\\,\\mathrm{M}\\,$ and return the fractions as decimals rounded to six decimal places.\n\nTest suite:\n- Case $\\,1\\,$ (moderate concentrations): $\\,C_{\\mathrm{Ca}}^{\\mathrm{T}} = 0.02\\,\\mathrm{M}\\,$, $\\,C_{\\mathrm{SO_4}}^{\\mathrm{T}} = 0.012\\,\\mathrm{M}\\,$, $\\,C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0.008\\,\\mathrm{M}\\,$, $\\,K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = 10^{2.31}\\,$, $\\,K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}} = 10^{3.22}\\,$.\n- Case $\\,2\\,$ (no carbonate, weaker sulfate pairing): $\\,C_{\\mathrm{Ca}}^{\\mathrm{T}} = 0.02\\,\\mathrm{M}\\,$, $\\,C_{\\mathrm{SO_4}}^{\\mathrm{T}} = 0.02\\,\\mathrm{M}\\,$, $\\,C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0.0\\,\\mathrm{M}\\,$, $\\,K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = 10^{1.80}\\,$, $\\,K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}} = 10^{3.22}\\,$.\n- Case $\\,3\\,$ (higher totals, stronger carbonate pairing): $\\,C_{\\mathrm{Ca}}^{\\mathrm{T}} = 0.10\\,\\mathrm{M}\\,$, $\\,C_{\\mathrm{SO_4}}^{\\mathrm{T}} = 0.07\\,\\mathrm{M}\\,$, $\\,C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0.03\\,\\mathrm{M}\\,$, $\\,K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = 10^{2.00}\\,$, $\\,K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}} = 10^{3.80}\\,$.\n- Case $\\,4\\,$ (very dilute): $\\,C_{\\mathrm{Ca}}^{\\mathrm{T}} = 0.0001\\,\\mathrm{M}\\,$, $\\,C_{\\mathrm{SO_4}}^{\\mathrm{T}} = 0.00006\\,\\mathrm{M}\\,$, $\\,C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0.00004\\,\\mathrm{M}\\,$, $\\,K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = 10^{2.31}\\,$, $\\,K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}} = 10^{3.22}\\,$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, with each inner list holding $\\,\\left[f_{\\mathrm{Ca^{2+}}}, f_{\\mathrm{CaSO_4^0}}, f_{\\mathrm{CaCO_3^0}}\\right]\\,$ for the corresponding test case, rounded to six decimal places and with no spaces, enclosed in square brackets. For example: $\\,\\left[[0.123456,0.234567,0.641977],[\\dots]\\right]\\,$.",
            "solution": "The computation is based on first-principles thermodynamic definitions and mass conservation, integrated with activity corrections via the Davies equation. The closed system contains the free ions $\\,\\mathrm{Ca^{2+}}\\,$, $\\,\\mathrm{SO_4^{2-}}\\,$, and $\\,\\mathrm{CO_3^{2-}}\\,$, and the neutral ion pairs $\\,\\mathrm{CaSO_4^0}\\,$ and $\\,\\mathrm{CaCO_3^0}\\,$. The neutral species have unit activity coefficients, while the charged species have activity coefficients computed from the ionic strength using the Davies equation.\n\nStarting point is the law of mass action. For a neutral pair $\\,\\mathrm{CaSO_4^0}\\,$, the ion association constant on the molal (or molar) activity scale is defined by\n$$K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = \\dfrac{a_{\\mathrm{CaSO_4^0}}}{a_{\\mathrm{Ca^{2+}}}\\,a_{\\mathrm{SO_4^{2-}}}} = \\dfrac{\\gamma_{\\mathrm{CaSO_4^0}}\\,c_{\\mathrm{CaSO_4^0}}}{\\left(\\gamma_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{Ca^{2+}}}\\right)\\left(\\gamma_{\\mathrm{SO_4^{2-}}}\\,c_{\\mathrm{SO_4^{2-}}}\\right)}.$$\nSince $\\,\\gamma_{\\mathrm{CaSO_4^0}} = 1\\,$ for a neutral species, we obtain the constitutive relationship\n$$c_{\\mathrm{CaSO_4^0}} = K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}}\\,\\gamma_{\\mathrm{Ca^{2+}}}\\,\\gamma_{\\mathrm{SO_4^{2-}}}\\,c_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{SO_4^{2-}}}.$$\nAn identical derivation for $\\,\\mathrm{CaCO_3^0}\\,$ gives\n$$c_{\\mathrm{CaCO_3^0}} = K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}}\\,\\gamma_{\\mathrm{Ca^{2+}}}\\,\\gamma_{\\mathrm{CO_3^{2-}}}\\,c_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{CO_3^{2-}}}.$$\n\nMass conservation requires that the analytical totals satisfy\n$$C_{\\mathrm{Ca}}^{\\mathrm{T}} = c_{\\mathrm{Ca^{2+}}} + c_{\\mathrm{CaSO_4^0}} + c_{\\mathrm{CaCO_3^0}},$$\n$$C_{\\mathrm{SO_4}}^{\\mathrm{T}} = c_{\\mathrm{SO_4^{2-}}} + c_{\\mathrm{CaSO_4^0}},$$\n$$C_{\\mathrm{CO_3}}^{\\mathrm{T}} = c_{\\mathrm{CO_3^{2-}}} + c_{\\mathrm{CaCO_3^0}}.$$\nThe ionic strength $\\,I\\,$ is computed from the free ions as\n$$I = \\dfrac{1}{2}\\left(4\\,c_{\\mathrm{Ca^{2+}}} + 4\\,c_{\\mathrm{SO_4^{2-}}} + 4\\,c_{\\mathrm{CO_3^{2-}}}\\right) = 2\\left(c_{\\mathrm{Ca^{2+}}} + c_{\\mathrm{SO_4^{2-}}} + c_{\\mathrm{CO_3^{2-}}}\\right).$$\nThe Davies equation then provides $\\,\\gamma_{\\mathrm{Ca^{2+}}}\\,$, $\\,\\gamma_{\\mathrm{SO_4^{2-}}}\\,$, and $\\,\\gamma_{\\mathrm{CO_3^{2-}}}\\,$ as\n$$\\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3I\\right),\\quad A=0.51,\\quad z_i=\\pm 2.$$\nThese directly enter the mass action expressions for $\\,c_{\\mathrm{CaSO_4^0}}\\,$ and $\\,c_{\\mathrm{CaCO_3^0}}\\,$.\n\nAlgorithmic design proceeds as follows:\n1. Define the unknown vector $\\,\\mathbf{c} = \\left[c_{\\mathrm{Ca^{2+}}},\\,c_{\\mathrm{SO_4^{2-}}},\\,c_{\\mathrm{CO_3^{2-}}}\\right]\\,$. Given $\\,\\mathbf{c}\\,$, compute $\\,I\\,$, then $\\,\\gamma_{\\mathrm{Ca^{2+}}}\\,$, $\\,\\gamma_{\\mathrm{SO_4^{2-}}}\\,$, and $\\,\\gamma_{\\mathrm{CO_3^{2-}}}\\,$ via the Davies equation.\n2. Compute $\\,c_{\\mathrm{CaSO_4^0}}\\,$ and $\\,c_{\\mathrm{CaCO_3^0}}\\,$ using the mass action relationships with the current $\\,\\gamma\\,$ values.\n3. Evaluate the residuals of the mass balances as\n   $$r_1 = c_{\\mathrm{Ca^{2+}}} + c_{\\mathrm{CaSO_4^0}} + c_{\\mathrm{CaCO_3^0}} - C_{\\mathrm{Ca}}^{\\mathrm{T}},$$\n   $$r_2 = c_{\\mathrm{SO_4^{2-}}} + c_{\\mathrm{CaSO_4^0}} - C_{\\mathrm{SO_4}}^{\\mathrm{T}},$$\n   $$r_3 = c_{\\mathrm{CO_3^{2-}}} + c_{\\mathrm{CaCO_3^0}} - C_{\\mathrm{CO_3}}^{\\mathrm{T}}.$$\n4. Use a bound-constrained nonlinear least-squares solver to find $\\,\\mathbf{c}\\ge \\mathbf{0}\\,$ that minimizes $\\,\\|\\mathbf{r}\\|\\,$, ensuring nonnegativity and consistency with thermodynamics.\n5. After obtaining $\\,\\mathbf{c}\\,$, compute the neutral pairs and then the calcium fractions\n   $$f_{\\mathrm{Ca^{2+}}} = \\dfrac{c_{\\mathrm{Ca^{2+}}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}},\\quad f_{\\mathrm{CaSO_4^0}} = \\dfrac{c_{\\mathrm{CaSO_4^0}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}},\\quad f_{\\mathrm{CaCO_3^0}} = \\dfrac{c_{\\mathrm{CaCO_3^0}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}}.$$\n6. Round each fraction to six decimal places for reporting.\n\nScientific realism and edge cases:\n- Electrically neutral closed systems without supporting electrolyte satisfy $\\,2\\,C_{\\mathrm{Ca}}^{\\mathrm{T}} = 2\\,C_{\\mathrm{SO_4}}^{\\mathrm{T}} + 2\\,C_{\\mathrm{CO_3}}^{\\mathrm{T}}\\,$. Each test case is constructed to satisfy this, so that only the specified species are needed to maintain charge balance.\n- When $\\,C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0\\,$, the algorithm naturally yields $\\,c_{\\mathrm{CO_3^{2-}}} \\approx 0\\,$ and $\\,c_{\\mathrm{CaCO_3^0}} \\approx 0\\,$ since the carbonate-dependent equilibrium terms vanish.\n- At very low ionic strength, $\\,\\gamma_i \\to 1\\,$ and the results approach ideal-solution behavior. At higher totals or stronger pairing constants, the free-ion concentrations are reduced, which self-consistently lowers $\\,I\\,$ and hence increases $\\,\\gamma_i\\,$ toward $\\,1\\,$, stabilizing the computation.\n\nThe final program implements these steps using a robust nonlinear solver with positivity bounds and produces the fractions for each test case in the required single-line, bracketed, comma-separated format with six-decimal rounding.",
            "answer": "[[0.392095,0.297424,0.310481],[0.609653,0.390347,0.000000],[0.158589,0.116568,0.724843],[0.941935,0.034796,0.023269]]"
        }
    ]
}