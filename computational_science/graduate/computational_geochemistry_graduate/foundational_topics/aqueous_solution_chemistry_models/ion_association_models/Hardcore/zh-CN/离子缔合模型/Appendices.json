{
    "hands_on_practices": [
        {
            "introduction": "本练习是理解离子缔合模型的第一步。它将引导您应用质量作用定律和质量守恒这两个基本原理，来计算理想溶液中各物种的平衡分布。通过解决这个关于简单 $1:1$ 电解质的基础问题 ，您将掌握构建更复杂地球化学模型所必需的核心代数框架。",
            "id": "4083233",
            "problem": "在标准实验室条件下，一个氯化钠水溶液通过一个经典的离子缔合模型来表示，该模型中只存在三种化学物质：钠离子 $\\mathrm{Na}^{+}$、氯离子 $\\mathrm{Cl}^{-}$ 和中性接触离子对 $\\mathrm{NaCl}^{0}$。加入水中的氯化钠的总质量摩尔浓度为 $m_{\\mathrm{NaCl,total}} = 1.0$ $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$。假设物种形成遵循理想溶液模型（活度系数等于1），并忽略所有其他缔合物种或水解产物。在所述条件下，基于质量摩尔浓度的离子对缔合常数为 $K_{\\mathrm{ip}} = 0.2$ $\\mathrm{kg}\\,\\mathrm{mol}^{-1}$。\n\n从适用于该体系的质量作用定律和守恒定律出发，确定中性离子对的质量摩尔浓度 $m_{\\mathrm{NaCl}^{0}}$ 以及自由离子 $m_{\\mathrm{Na}^{+}}$ 和 $m_{\\mathrm{Cl}^{-}}$ 的质量摩尔浓度。所有质量摩尔浓度均以 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ 为单位表示，并将结果四舍五入至四位有效数字。按顺序 $\\left(m_{\\mathrm{NaCl}^{0}},\\, m_{\\mathrm{Na}^{+}},\\, m_{\\mathrm{Cl}^{-}}\\right)$ 报告您的最终值。",
            "solution": "本题要求在已知加入的 $\\mathrm{NaCl}$ 的总质量摩尔浓度和离子对缔合常数的条件下，确定水溶液中 $\\mathrm{Na}^{+}$、$\\mathrm{Cl}^{-}$ 和 $\\mathrm{NaCl}^{0}$ 物种的平衡质量摩尔浓度。求解过程基于质量作用定律和质量守恒原理。\n\n由其组成自由离子形成中性离子对 $\\mathrm{NaCl}^{0}$ 的化学平衡由以下反应给出：\n$$\n\\mathrm{Na}^{+} + \\mathrm{Cl}^{-} \\rightleftharpoons \\mathrm{NaCl}^{0}\n$$\n此反应的质量作用定律定义了基于质量摩尔浓度的缔合常数 $K_{\\mathrm{ip}}$。\n$$\nK_{\\mathrm{ip}} = \\frac{a_{\\mathrm{NaCl}^{0}}}{a_{\\mathrm{Na}^{+}} a_{\\mathrm{Cl}^{-}}}\n$$\n其中 $a_i$ 代表物种 $i$ 的活度。问题中指定为确定物种形态而假设为理想溶液，这意味着所有物种的活度系数 $\\gamma_i$ 均等于1。由于活度定义为 $a_i = \\gamma_i (m_i/m^\\circ)$（为使活度无量纲，通常除以标准浓度 $m^\\circ = 1 \\ \\mathrm{mol/kg}$），在计算中常省略 $m^\\circ$ 以简化表达式，此题中同样如此。这一假设将质量作用表达式简化为：\n$$\nK_{\\mathrm{ip}} = \\frac{m_{\\mathrm{NaCl}^{0}}}{m_{\\mathrm{Na}^{+}} m_{\\mathrm{Cl}^{-}}}\n$$\n问题给出 $K_{\\mathrm{ip}} = 0.2 \\, \\mathrm{kg}\\,\\mathrm{mol}^{-1}$。\n\n接下来，我们建立钠和氯组分的质量平衡（守恒）方程。加入溶液中的氯化钠的总质量摩尔浓度为 $m_{\\mathrm{NaCl,total}} = 1.0 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}$。\n\n钠的总质量摩尔浓度 $m_{\\mathrm{Na,total}}$ 分布在自由钠离子 $\\mathrm{Na}^{+}$ 和离子对 $\\mathrm{NaCl}^{0}$ 之间。因此，钠的质量平衡方程为：\n$$\nm_{\\mathrm{Na,total}} = m_{\\mathrm{Na}^{+}} + m_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{NaCl,total}}\n$$\n类似地，氯的总质量摩尔浓度 $m_{\\mathrm{Cl,total}}$ 分布在自由氯离子 $\\mathrm{Cl}^{-}$ 和离子对 $\\mathrm{NaCl}^{0}$ 之间。氯的质量平衡方程为：\n$$\nm_{\\mathrm{Cl,total}} = m_{\\mathrm{Cl}^{-}} + m_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{NaCl,total}}\n$$\n从这两个质量平衡方程可以明显看出：\n$$\nm_{\\mathrm{Na}^{+}} + m_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{Cl}^{-}} + m_{\\mathrm{NaCl}^{0}}\n$$\n这意味着自由离子的质量摩尔浓度必须相等：\n$$\nm_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}}\n$$\n为求解该方程组，我们定义一个变量 $x$ 来表示自由离子的质量摩尔浓度：\n$$\nx = m_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}}\n$$\n使用钠的质量平衡方程，我们可以用 $x$ 来表示离子对的质量摩尔浓度 $m_{\\mathrm{NaCl}^{0}}$：\n$$\nm_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{NaCl,total}} - m_{\\mathrm{Na}^{+}} = m_{\\mathrm{NaCl,total}} - x\n$$\n现在，将 $m_{\\mathrm{Na}^{+}}$、$m_{\\mathrm{Cl}^{-}}$ 和 $m_{\\mathrm{NaCl}^{0}}$ 的表达式代入质量作用定律方程：\n$$\nK_{\\mathrm{ip}} = \\frac{m_{\\mathrm{NaCl,total}} - x}{x \\cdot x} = \\frac{m_{\\mathrm{NaCl,total}} - x}{x^2}\n$$\n重新整理这个方程，得到一个关于 $x$ 的二次方程：\n$$\nK_{\\mathrm{ip}} x^2 = m_{\\mathrm{NaCl,total}} - x\n$$\n$$\nK_{\\mathrm{ip}} x^2 + x - m_{\\mathrm{NaCl,total}} = 0\n$$\n这是一个标准形式为 $ax^2 + bx + c = 0$ 的二次方程，其中 $a = K_{\\mathrm{ip}}$，$b = 1$，$c = -m_{\\mathrm{NaCl,total}}$。$x$ 的解由二次公式给出：\n$$\nx = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} = \\frac{-1 \\pm \\sqrt{1^2 - 4(K_{\\mathrm{ip}})(-m_{\\mathrm{NaCl,total}})}}{2K_{\\mathrm{ip}}}\n$$\n$$\nx = \\frac{-1 \\pm \\sqrt{1 + 4 K_{\\mathrm{ip}} m_{\\mathrm{NaCl,total}}}}{2 K_{\\mathrm{ip}}}\n$$\n由于 $x$ 代表质量摩尔浓度，它必须是一个正实数。平方根下的项 $1 + 4 K_{\\mathrm{ip}} m_{\\mathrm{NaCl,total}}$ 是正数，因为 $K_{\\mathrm{ip}} > 0$ 且 $m_{\\mathrm{NaCl,total}} > 0$。此外，$\\sqrt{1 + 4 K_{\\mathrm{ip}} m_{\\mathrm{NaCl,total}}} > 1$。因此，带有负号的根 $\\frac{-1 - \\sqrt{\\dots}}{2 K_{\\mathrm{ip}}}$ 将得出 $x$ 的一个负值，这在物理上是没有意义的。我们必须选择正根：\n$$\nx = \\frac{-1 + \\sqrt{1 + 4 K_{\\mathrm{ip}} m_{\\mathrm{NaCl,total}}}}{2 K_{\\mathrm{ip}}}\n$$\n已知 $m_{\\mathrm{NaCl,total}} = 1.0 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}$ 和 $K_{\\mathrm{ip}} = 0.2 \\, \\mathrm{kg}\\,\\mathrm{mol}^{-1}$。将这些值代入 $x$ 的表达式中：\n$$\nx = \\frac{-1 + \\sqrt{1 + 4(0.2)(1.0)}}{2(0.2)} = \\frac{-1 + \\sqrt{1 + 0.8}}{0.4} = \\frac{-1 + \\sqrt{1.8}}{0.4}\n$$\n计算数值：\n$$\nx \\approx \\frac{-1 + 1.3416407865}{0.4} \\approx \\frac{0.3416407865}{0.4} \\approx 0.85410196625 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\n因此，自由离子的质量摩尔浓度为：\n$$\nm_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}} = x \\approx 0.85410196625 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nm_{\\mathrm{Na}^{+}} = m_{\\mathrm{Cl}^{-}} = 0.8541 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\n现在，我们计算中性离子对的质量摩尔浓度 $m_{\\mathrm{NaCl}^{0}}$：\n$$\nm_{\\mathrm{NaCl}^{0}} = m_{\\mathrm{NaCl,total}} - x = 1.0 - 0.85410196625 \\approx 0.14589803375 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\n四舍五入到四位有效数字：\n$$\nm_{\\mathrm{NaCl}^{0}} = 0.1459 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}\n$$\n最终计算出的质量摩尔浓度为 $m_{\\mathrm{NaCl}^{0}} = 0.1459 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}$，$m_{\\mathrm{Na}^{+}} = 0.8541 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}$，以及 $m_{\\mathrm{Cl}^{-}} = 0.8541 \\, \\mathrm{mol}\\,\\mathrm{kg}^{-1}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1459  0.8541  0.8541 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在上一个练习的基础上，本实践将探讨离子缔合带来的重要化学后果。您将计算离子对的形成如何影响电解质溶液的一个关键宏观性质——离子强度。理解离子缔合会降低有效离子强度 ，这对于在更高级的模型中准确计算活度系数至关重要。",
            "id": "4083249",
            "problem": "一个在温度 $T$ 和压力 $P$ 下的水溶液仅包含 $\\mathrm{Mg}^{2+}$、$\\mathrm{SO}_{4}^{2-}$ 和中性离子对 $\\mathrm{MgSO}_{4}^{0}$。该溶液通过溶解化学计量的硫酸镁制备，总分析质量摩尔浓度为 $m_{T} = 0.5$ $\\mathrm{mol}\\ \\mathrm{kg}^{-1}$，因此总镁和总硫酸根的质量摩尔浓度均为 $0.5$ $\\mathrm{mol}\\ \\mathrm{kg}^{-1}$。离子缔合通过以下反应进行\n$$\\mathrm{Mg}^{2+} + \\mathrm{SO}_{4}^{2-} \\rightleftharpoons \\mathrm{MgSO}_{4}^{0}.$$\n假设所有物种均为理想的质量摩尔浓度标度标准态（活度系数等于$1$），忽略所有其他络合物，并将水视为唯一的溶剂。在指定的 $T$ 和 $P$ 下，基于质量摩尔浓度的离子对平衡常数为 $K_{\\mathrm{ip}} = 10$ $\\mathrm{kg}\\ \\mathrm{mol}^{-1}$，由质量作用定律定义\n$$K_{\\mathrm{ip}} = \\frac{m_{\\mathrm{MgSO}_{4}^{0}}}{m_{\\mathrm{Mg}^{2+}}\\,m_{\\mathrm{SO}_{4}^{2-}}}.$$\n使用质量摩尔浓度标度下的离子强度定义，\n$$I = \\frac{1}{2}\\sum_{i} m_{i} z_{i}^{2},$$\n其中 $z_{i}$ 是物种 $i$ 的电荷数，$m_{i}$ 是其质量摩尔浓度。所有中性物种的 $z_{i}=0$。\n\n从这些定义以及质量和电荷守恒出发，计算：\n1. 平衡时，以中性离子对 $\\mathrm{MgSO}_{4}^{0}$ 形式存在的镁占总镁的比例。\n2. 相对于在相同总质量摩尔浓度 $m_{T}$ 下的假想完全解离状态，离子强度 $\\Delta I$ 的变化量。\n\n将最终结果以行向量 $\\big[f\\ \\ \\Delta I\\big]$ 的形式报告，其中 $f$ 是配对的镁的无量纲分数，$\\Delta I$ 的单位是 $\\mathrm{mol}\\ \\mathrm{kg}^{-1}$。将两个条目都四舍五入到四位有效数字。在最终的方框答案中不要包含单位。",
            "solution": "该问题要求计算一个 $2:2$ 电解质溶液在考虑离子缔合时的平衡物种分布和离子强度变化。\n\n设 $m_{\\mathrm{Mg}^{2+}}$、$m_{\\mathrm{SO}_{4}^{2-}}$ 和 $m_{\\mathrm{MgSO}_{4}^{0}}$ 分别为镁离子、硫酸根离子和中性硫酸镁离子对的平衡质量摩尔浓度（单位为 $\\mathrm{mol}\\ \\mathrm{kg}^{-1}$）。硫酸镁的总分析质量摩尔浓度为 $m_{T} = 0.5 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$。\n\n根据镁和硫酸根的质量守恒原理，我们有：\n$$m_{T} = m_{\\mathrm{Mg}^{2+}} + m_{\\mathrm{MgSO}_{4}^{0}}$$\n$$m_{T} = m_{\\mathrm{SO}_{4}^{2-}} + m_{\\mathrm{MgSO}_{4}^{0}}$$\n从这两个方程可以清楚地看出，游离离子的平衡质量摩尔浓度必须相等：\n$$m_{\\mathrm{Mg}^{2+}} = m_{\\mathrm{SO}_{4}^{2-}}$$\n让我们定义 $x$ 为离子对的平衡质量摩尔浓度，$x = m_{\\mathrm{MgSO}_{4}^{0}}$。那么，每个游离离子的质量摩尔浓度可以表示为：\n$$m_{\\mathrm{Mg}^{2+}} = m_{\\mathrm{SO}_{4}^{2-}} = m_{T} - x$$\n质量作用定律由下式给出：\n$$K_{\\mathrm{ip}} = \\frac{m_{\\mathrm{MgSO}_{4}^{0}}}{m_{\\mathrm{Mg}^{2+}}\\,m_{\\mathrm{SO}_{4}^{2-}}}$$\n将以 $x$ 和 $m_{T}$ 表示的表达式代入平衡方程，得到：\n$$K_{\\mathrm{ip}} = \\frac{x}{(m_{T} - x)(m_{T} - x)} = \\frac{x}{(m_{T} - x)^{2}}$$\n我们已知 $K_{\\mathrm{ip}} = 10 \\ \\mathrm{kg}\\ \\mathrm{mol}^{-1}$ 和 $m_{T} = 0.5 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$。代入这些值：\n$$10 = \\frac{x}{(0.5 - x)^{2}}$$\n这个方程可以重新排列成一个标准的二次方程形式，$ax^2+bx+c=0$：\n$$10(0.5 - x)^{2} = x$$\n$$10(0.25 - x + x^{2}) = x$$\n$$2.5 - 10x + 10x^{2} = x$$\n$$10x^{2} - 11x + 2.5 = 0$$\n我们使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $x$：\n$$x = \\frac{11 \\pm \\sqrt{(-11)^{2} - 4(10)(2.5)}}{2(10)}$$\n$$x = \\frac{11 \\pm \\sqrt{121 - 100}}{20}$$\n$$x = \\frac{11 \\pm \\sqrt{21}}{20}$$\n这给出了 $x$ 的两个可能的数学解：\n$$x_1 = \\frac{11 + \\sqrt{21}}{20} \\approx \\frac{11 + 4.5826}{20} \\approx 0.7791 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$$\n$$x_2 = \\frac{11 - \\sqrt{21}}{20} \\approx \\frac{11 - 4.5826}{20} \\approx 0.3209 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$$\n由于 $x$ 代表离子对的质量摩尔浓度，它不能超过总分析质量摩尔浓度 $m_{T} = 0.5 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$。因此，第一个根 $x_1$ 在物理上是不现实的，正确的解是 $x_2$。\n$$x = m_{\\mathrm{MgSO}_{4}^{0}} = \\frac{11 - \\sqrt{21}}{20} \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1} \\approx 0.32087 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$$\n\n**1. 计算以中性离子对形式存在的镁的比例。**\n分数 $f$ 是离子对的质量摩尔浓度与总镁质量摩尔浓度的比值：\n$$f = \\frac{m_{\\mathrm{MgSO}_{4}^{0}}}{m_{T}} = \\frac{x}{m_{T}}$$\n$$f = \\frac{(11 - \\sqrt{21})/20}{0.5} = \\frac{11 - \\sqrt{21}}{10}$$\n$$f \\approx 0.64174$$\n四舍五入到四位有效数字，$f = 0.6417$。\n\n**2. 计算离子强度的变化量 $\\Delta I$。**\n首先，我们计算假想完全解离状态下的离子强度 $I_{\\text{dissociated}}$。在这种状态下，$m_{\\mathrm{Mg}^{2+}} = m_{T} = 0.5$ 且 $m_{\\mathrm{SO}_{4}^{2-}} = m_{T} = 0.5$。电荷数分别为 $z_{\\mathrm{Mg}^{2+}} = +2$ 和 $z_{\\mathrm{SO}_{4}^{2-}} = -2$。\n$$I_{\\text{dissociated}} = \\frac{1}{2}\\sum_{i} m_{i} z_{i}^{2} = \\frac{1}{2} \\left[ m_{\\mathrm{Mg}^{2+}} (z_{\\mathrm{Mg}^{2+}})^{2} + m_{\\mathrm{SO}_{4}^{2-}} (z_{\\mathrm{SO}_{4}^{2-}})^{2} \\right]$$\n$$I_{\\text{dissociated}} = \\frac{1}{2} \\left[ (0.5)(2)^{2} + (0.5)(-2)^{2} \\right] = \\frac{1}{2} [2 + 2] = 2.0 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$$\n接下来，我们计算平衡时的离子强度 $I_{\\text{equilibrium}}$。离子的质量摩尔浓度为 $m_{\\mathrm{Mg}^{2+}} = m_{\\mathrm{SO}_{4}^{2-}} = m_{T} - x$。中性离子对对离子强度没有贡献（$z=0$）。\n$$m_{\\mathrm{Mg}^{2+}} = m_{\\mathrm{SO}_{4}^{2-}} = 0.5 - \\frac{11 - \\sqrt{21}}{20} = \\frac{10 - (11 - \\sqrt{21})}{20} = \\frac{\\sqrt{21} - 1}{20} \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$$\n$$I_{\\text{equilibrium}} = \\frac{1}{2} \\left[ (m_{T}-x)(2)^{2} + (m_{T}-x)(-2)^{2} \\right] = 4(m_{T}-x)$$\n$$I_{\\text{equilibrium}} = 4 \\left( \\frac{\\sqrt{21} - 1}{20} \\right) = \\frac{\\sqrt{21} - 1}{5} \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$$\n$$I_{\\text{equilibrium}} \\approx \\frac{4.5826 - 1}{5} \\approx 0.71651 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$$\n离子强度的变化量为 $\\Delta I = I_{\\text{equilibrium}} - I_{\\text{dissociated}}$。\n$$\\Delta I = \\frac{\\sqrt{21} - 1}{5} - 2 = \\frac{\\sqrt{21} - 1 - 10}{5} = \\frac{\\sqrt{21} - 11}{5}$$\n$$\\Delta I \\approx -1.28348$$\n四舍五入到四位有效数字，$\\Delta I = -1.283 \\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$。\n\n最终结果是行向量 $[f, \\Delta I]$。\n$$f \\approx 0.6417$$\n$$\\Delta I \\approx -1.283$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.6417  -1.283 \\end{pmatrix}}$$"
        },
        {
            "introduction": "本练习是一项高级的、更贴近实际研究的计算任务。它将您从简单的单电解质体系带入一个存在竞争性平衡的多组分环境，并引入了活度系数校正来解释溶液的非理想行为。通过这个实践 ，您将体会到为何需要依赖数值方法来求解这类复杂的、自洽的地球化学问题，从而掌握现代计算地球化学的核心技能。",
            "id": "4083189",
            "problem": "您的任务是在一组给定的总分析浓度和离子缔合常数指定的封闭系统条件下，计算钙离子 $\\mathrm{Ca}^{2+}$ 在中性离子对 $\\mathrm{CaSO_4^0}$, $\\mathrm{CaCO_3^0}$ 和自由离子 $\\mathrm{Ca}^{2+}$ 之间的分布。系统处于标准温度 $25\\,^\\circ\\mathrm{C}$ 和压力下，且仅存在以下水相物种：$\\mathrm{Ca}^{2+}$, $\\mathrm{SO_4^{2-}}$, $\\mathrm{CO_3^{2-}}$, $\\mathrm{CaSO_4^0}$ 和 $\\mathrm{CaCO_3^0}$。假设中性物种的活度系数为1，溶液混合均匀，且没有其他络合反应。浓度以摩尔浓度 ($\\mathrm{M}$, 摩尔/升) 表示。所有计算必须使用物理上一致的热力学定义。\n\n计算的基本原理：\n- 质量作用定律将中性离子对的离子缔合常数定义为 $K_{\\mathrm{ip}} = \\dfrac{a_{\\text{pair}}}{a_{\\text{cation}}\\,a_{\\text{anion}}}$, 其中 $a_i$ 表示物种 $i$ 的活度。\n- 对每个物种，其活度为 $a_i = \\gamma_i c_i$, 其中 $\\gamma_i$ 是活度系数，$c_i$ 是摩尔浓度。\n- 溶液的离子强度 $I$ 为 $$I = \\dfrac{1}{2}\\sum_i c_i z_i^2,$$ 其中 $z_i$ 是离子 $i$ 的电荷数，求和仅针对带电（自由）离子。\n- 在 $25\\,^\\circ\\mathrm{C}$ 时，Davies 方程（Debye–Hückel 理论的一个广泛使用的扩展）给出电荷为 $z$ 的离子的活度系数为 $$\\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right),$$ 其中 $A = 0.51$ 是 $25\\,^\\circ\\mathrm{C}$ 时的 Debye–Hückel 常数。\n\n未知量与约束条件：\n- 令 $c_{\\mathrm{Ca^{2+}}}$, $c_{\\mathrm{SO_4^{2-}}}$ 和 $c_{\\mathrm{CO_3^{2-}}}$ 表示以 $\\mathrm{M}$ 为单位的自由离子浓度。\n- 中性离子对的浓度满足质量作用关系：\n  $$c_{\\mathrm{CaSO_4^0}} = K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}}\\,\\dfrac{\\gamma_{\\mathrm{Ca^{2+}}}\\,\\gamma_{\\mathrm{SO_4^{2-}}}}{\\gamma_{\\mathrm{CaSO_4^0}}}\\,c_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{SO_4^{2-}}},\\quad \\gamma_{\\mathrm{CaSO_4^0}} = 1,$$\n  $$c_{\\mathrm{CaCO_3^0}} = K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}}\\,\\dfrac{\\gamma_{\\mathrm{Ca^{2+}}}\\,\\gamma_{\\mathrm{CO_3^{2-}}}}{\\gamma_{\\mathrm{CaCO_3^0}}}\\,c_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{CO_3^{2-}}},\\quad \\gamma_{\\mathrm{CaCO_3^0}} = 1.$$\n- 质量平衡（分析总浓度）为\n  $$C_{\\mathrm{Ca}}^{\\mathrm{T}} = c_{\\mathrm{Ca^{2+}}} + c_{\\mathrm{CaSO_4^0}} + c_{\\mathrm{CaCO_3^0}},$$\n  $$C_{\\mathrm{SO_4}}^{\\mathrm{T}} = c_{\\mathrm{SO_4^{2-}}} + c_{\\mathrm{CaSO_4^0}},$$\n  $$C_{\\mathrm{CO_3}}^{\\mathrm{T}} = c_{\\mathrm{CO_3^{2-}}} + c_{\\mathrm{CaCO_3^0}}.$$\n- 不含额外支持电解质的电中性封闭系统满足 $$2 C_{\\mathrm{Ca}}^{\\mathrm{T}} = 2 C_{\\mathrm{SO_4}}^{\\mathrm{T}} + 2 C_{\\mathrm{CO_3}}^{\\mathrm{T}},$$ 在所提供的测试用例中此条件已强制执行。\n\n您的计算任务：\n- 对每个给定的参数集，求解 $c_{\\mathrm{Ca^{2+}}}$, $c_{\\mathrm{SO_4^{2-}}}$ 和 $c_{\\mathrm{CO_3^{2-}}}$, 使得质量平衡和质量作用关系同时满足，并且活度系数通过 Davies 方程使用自由离子计算出的离子强度进行自洽计算。\n- 计算总钙中以 $\\mathrm{Ca}^{2+}$, $\\mathrm{CaSO_4^0}$ 和 $\\mathrm{CaCO_3^0}$ 形式存在的分数：\n  $$f_{\\mathrm{Ca^{2+}}} = \\dfrac{c_{\\mathrm{Ca^{2+}}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}},\\quad f_{\\mathrm{CaSO_4^0}} = \\dfrac{c_{\\mathrm{CaSO_4^0}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}},\\quad f_{\\mathrm{CaCO_3^0}} = \\dfrac{c_{\\mathrm{CaCO_3^0}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}}.$$\n- 所有输入浓度以 $\\mathrm{M}$ 表示，返回的分数应为四舍五入到六位小数的小数。\n\n测试组：\n- 情况 1 (中等浓度): $C_{\\mathrm{Ca}}^{\\mathrm{T}} = 0.02\\,\\mathrm{M}$, $C_{\\mathrm{SO_4}}^{\\mathrm{T}} = 0.012\\,\\mathrm{M}$, $C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0.008\\,\\mathrm{M}$, $K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = 10^{2.31}$, $K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}} = 10^{3.22}$.\n- 情况 2 (无碳酸盐，较弱的硫酸盐配对): $C_{\\mathrm{Ca}}^{\\mathrm{T}} = 0.02\\,\\mathrm{M}$, $C_{\\mathrm{SO_4}}^{\\mathrm{T}} = 0.02\\,\\mathrm{M}$, $C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0.0\\,\\mathrm{M}$, $K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = 10^{1.80}$, $K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}} = 10^{3.22}$.\n- 情况 3 (较高总浓度，较强的碳酸盐配对): $C_{\\mathrm{Ca}}^{\\mathrm{T}} = 0.10\\,\\mathrm{M}$, $C_{\\mathrm{SO_4}}^{\\mathrm{T}} = 0.07\\,\\mathrm{M}$, $C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0.03\\,\\mathrm{M}$, $K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = 10^{2.00}$, $K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}} = 10^{3.80}$.\n- 情况 4 (非常稀): $C_{\\mathrm{Ca}}^{\\mathrm{T}} = 0.0001\\,\\mathrm{M}$, $C_{\\mathrm{SO_4}}^{\\mathrm{T}} = 0.00006\\,\\mathrm{M}$, $C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0.00004\\,\\mathrm{M}$, $K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = 10^{2.31}$, $K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}} = 10^{3.22}$.\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个逗号分隔的列表的列表。每个内部列表包含对应测试用例的 $\\left[f_{\\mathrm{Ca^{2+}}}, f_{\\mathrm{CaSO_4^0}}, f_{\\mathrm{CaCO_3^0}}\\right]$, 四舍五入到六位小数，不含空格，并用方括号括起来。例如：$\\left[[0.123456,0.234567,0.641977],[\\dots]\\right]$。",
            "solution": "计算基于第一性原理热力学定义和质量守恒，并结合通过 Davies 方程进行的活度校正。该封闭系统包含自由离子 $\\mathrm{Ca}^{2+}$, $\\mathrm{SO_4}^{2-}$ 和 $\\mathrm{CO_3}^{2-}$，以及中性离子对 $\\mathrm{CaSO_4^0}$ 和 $\\mathrm{CaCO_3^0}$。中性物种的活度系数为1，而带电物种的活度系数则根据离子强度使用 Davies 方程计算。\n\n计算的起点是质量作用定律。对于中性离子对 $\\mathrm{CaSO_4^0}$, 在体积摩尔活度标度上的离子缔合常数定义为\n$$K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}} = \\dfrac{a_{\\mathrm{CaSO_4^0}}}{a_{\\mathrm{Ca^{2+}}}\\,a_{\\mathrm{SO_4^{2-}}}} = \\dfrac{\\gamma_{\\mathrm{CaSO_4^0}}\\,c_{\\mathrm{CaSO_4^0}}}{\\left(\\gamma_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{Ca^{2+}}}\\right)\\left(\\gamma_{\\mathrm{SO_4^{2-}}}\\,c_{\\mathrm{SO_4^{2-}}}\\right)}.$$\n由于中性物种的 $\\gamma_{\\mathrm{CaSO_4^0}} = 1$, 我们得到本构关系\n$$c_{\\mathrm{CaSO_4^0}} = K_{\\mathrm{ip}}^{\\mathrm{CaSO_4^0}}\\,\\gamma_{\\mathrm{Ca^{2+}}}\\,\\gamma_{\\mathrm{SO_4^{2-}}}\\,c_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{SO_4^{2-}}}.$$\n对 $\\mathrm{CaCO_3^0}$ 进行相同的推导可得\n$$c_{\\mathrm{CaCO_3^0}} = K_{\\mathrm{ip}}^{\\mathrm{CaCO_3^0}}\\,\\gamma_{\\mathrm{Ca^{2+}}}\\,\\gamma_{\\mathrm{CO_3^{2-}}}\\,c_{\\mathrm{Ca^{2+}}}\\,c_{\\mathrm{CO_3^{2-}}}.$$\n\n质量守恒要求分析总浓度满足\n$$C_{\\mathrm{Ca}}^{\\mathrm{T}} = c_{\\mathrm{Ca^{2+}}} + c_{\\mathrm{CaSO_4^0}} + c_{\\mathrm{CaCO_3^0}},$$\n$$C_{\\mathrm{SO_4}}^{\\mathrm{T}} = c_{\\mathrm{SO_4^{2-}}} + c_{\\mathrm{CaSO_4^0}},$$\n$$C_{\\mathrm{CO_3}}^{\\mathrm{T}} = c_{\\mathrm{CO_3^{2-}}} + c_{\\mathrm{CaCO_3^0}}.$$\n离子强度 $I$ 根据自由离子计算如下\n$$I = \\dfrac{1}{2}\\left(4\\,c_{\\mathrm{Ca^{2+}}} + 4\\,c_{\\mathrm{SO_4^{2-}}} + 4\\,c_{\\mathrm{CO_3^{2-}}}\\right) = 2\\left(c_{\\mathrm{Ca^{2+}}} + c_{\\mathrm{SO_4^{2-}}} + c_{\\mathrm{CO_3^{2-}}}\\right).$$\nDavies 方程继而提供 $\\gamma_{\\mathrm{Ca^{2+}}}$, $\\gamma_{\\mathrm{SO_4^{2-}}}$ 和 $\\gamma_{\\mathrm{CO_3^{2-}}}$ 如下\n$$\\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3I\\right),\\quad A=0.51,\\quad z_i=\\pm 2.$$\n这些值直接代入 $c_{\\mathrm{CaSO_4^0}}$ 和 $c_{\\mathrm{CaCO_3^0}}$ 的质量作用表达式中。\n\n算法设计如下：\n1. 定义未知向量 $\\mathbf{c} = \\left[c_{\\mathrm{Ca^{2+}}},\\,c_{\\mathrm{SO_4^{2-}}},\\,c_{\\mathrm{CO_3^{2-}}}\\right]$。给定 $\\mathbf{c}$, 计算 $I$, 然后通过 Davies 方程计算 $\\gamma_{\\mathrm{Ca^{2+}}}$, $\\gamma_{\\mathrm{SO_4^{2-}}}$ 和 $\\gamma_{\\mathrm{CO_3^{2-}}}$。\n2. 使用当前的 $\\gamma$ 值和质量作用关系计算 $c_{\\mathrm{CaSO_4^0}}$ 和 $c_{\\mathrm{CaCO_3^0}}$。\n3. 计算质量平衡的残差如下：\n   $$r_1 = c_{\\mathrm{Ca^{2+}}} + c_{\\mathrm{CaSO_4^0}} + c_{\\mathrm{CaCO_3^0}} - C_{\\mathrm{Ca}}^{\\mathrm{T}},$$\n   $$r_2 = c_{\\mathrm{SO_4^{2-}}} + c_{\\mathrm{CaSO_4^0}} - C_{\\mathrm{SO_4}}^{\\mathrm{T}},$$\n   $$r_3 = c_{\\mathrm{CO_3^{2-}}} + c_{\\mathrm{CaCO_3^0}} - C_{\\mathrm{CO_3}}^{\\mathrm{T}}.$$\n4. 使用一个有界约束的非线性最小二乘求解器找到最小化 $\\|\\mathbf{r}\\|$ 的 $\\mathbf{c}\\ge \\mathbf{0}$, 以确保非负性和热力学一致性。\n5. 获得 $\\mathbf{c}$ 后，计算中性离子对，然后计算钙的分数\n   $$f_{\\mathrm{Ca^{2+}}} = \\dfrac{c_{\\mathrm{Ca^{2+}}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}},\\quad f_{\\mathrm{CaSO_4^0}} = \\dfrac{c_{\\mathrm{CaSO_4^0}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}},\\quad f_{\\mathrm{CaCO_3^0}} = \\dfrac{c_{\\mathrm{CaCO_3^0}}}{C_{\\mathrm{Ca}}^{\\mathrm{T}}}.$$\n6. 将每个分数四舍五入到六位小数以便报告。\n\n科学真实性与边界情况：\n- 不含支持电解质的电中性封闭系统满足 $2 C_{\\mathrm{Ca}}^{\\mathrm{T}} = 2 C_{\\mathrm{SO_4}}^{\\mathrm{T}} + 2 C_{\\mathrm{CO_3}}^{\\mathrm{T}}$。每个测试用例都构造成满足此条件，因此仅需指定的物种即可维持电荷平衡。\n- 当 $C_{\\mathrm{CO_3}}^{\\mathrm{T}} = 0$ 时，由于依赖于碳酸盐的平衡项消失，算法自然会得出 $c_{\\mathrm{CO_3^{2-}}} \\approx 0$ 和 $c_{\\mathrm{CaCO_3^0}} \\approx 0$。\n- 在非常低的离子强度下，$\\gamma_i \\to 1$, 结果接近理想溶液行为。在较高的总浓度或更强的配对常数下，自由离子浓度降低，这会自洽地降低 $I$，从而使 $\\gamma_i$ 趋近于 $1$, 进而稳定计算。\n\n最终的程序使用带有正值界限的鲁棒非线性求解器实现这些步骤，并为每个测试用例生成所需格式的结果：单行、方括号括起、逗号分隔、六位小数精度的分数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\n# Davies activity coefficient for ions at 25 C\n# log10(gamma) = -A * z^2 * ( sqrt(I)/(1+sqrt(I)) - 0.3*I ), A=0.51\ndef davies_gamma(z, I):\n    if I == 0.0:\n        return 1.0\n    A = 0.51\n    term = np.sqrt(I)\n    log10_gamma = -A * (z ** 2) * (term / (1.0 + term) - 0.3 * I)\n    return 10.0 ** log10_gamma\n\ndef solve_case(C_Ca, C_SO4, C_CO3, K_ip_CaSO4, K_ip_CaCO3):\n    # Residual function for least squares\n    def residuals(c):\n        # Enforce non-negativity softly via bounds in solver; here we just use c directly\n        cCa, cSO4, cCO3 = c\n\n        # Ionic strength from free ions (z=+2, -2, -2)\n        I = 2.0 * (cCa + cSO4 + cCO3)  # since I = 0.5 * sum(c_i z_i^2) and z^2=4 -> I = 2*(sum free)\n        # Activity coefficients via Davies equation\n        gamma_Ca = davies_gamma(2.0, I)\n        gamma_SO4 = davies_gamma(-2.0, I)\n        gamma_CO3 = davies_gamma(-2.0, I)\n\n        # Neutral species have gamma = 1\n        cCaSO4 = K_ip_CaSO4 * gamma_Ca * gamma_SO4 * cCa * cSO4\n        cCaCO3 = K_ip_CaCO3 * gamma_Ca * gamma_CO3 * cCa * cCO3\n\n        r1 = cCa + cCaSO4 + cCaCO3 - C_Ca\n        r2 = cSO4 + cCaSO4 - C_SO4\n        r3 = cCO3 + cCaCO3 - C_CO3\n        return np.array([r1, r2, r3])\n\n    # Initial guess: half of totals (small positive floor to avoid zero)\n    x0 = np.array([\n        max(C_Ca * 0.5, 1e-20),\n        max(C_SO4 * 0.5, 1e-20),\n        max(C_CO3 * 0.5, 1e-20),\n    ])\n\n    # Bounds: nonnegative concentrations\n    lower_bounds = np.array([0.0, 0.0, 0.0])\n    upper_bounds = np.array([np.inf, np.inf, np.inf])\n\n    # Solve using trust-region reflective least squares with bounds\n    res = least_squares(residuals, x0, bounds=(lower_bounds, upper_bounds), method='trf', xtol=1e-14, ftol=1e-14, gtol=1e-14, max_nfev=2000)\n\n    cCa, cSO4, cCO3 = res.x\n    # Recompute pairs for final reporting\n    I = 2.0 * (cCa + cSO4 + cCO3)\n    gamma_Ca = davies_gamma(2.0, I)\n    gamma_SO4 = davies_gamma(-2.0, I)\n    gamma_CO3 = davies_gamma(-2.0, I)\n    cCaSO4 = K_ip_CaSO4 * gamma_Ca * gamma_SO4 * cCa * cSO4\n    cCaCO3 = K_ip_CaCO3 * gamma_Ca * gamma_CO3 * cCa * cCO3\n\n    # Numerical safety: clip tiny negatives due to solver tolerances\n    cCa = max(cCa, 0.0)\n    cCaSO4 = max(cCaSO4, 0.0)\n    cCaCO3 = max(cCaCO3, 0.0)\n\n    # Fractions of total calcium\n    f_free = cCa / C_Ca if C_Ca > 0 else 0.0\n    f_CaSO4 = cCaSO4 / C_Ca if C_Ca > 0 else 0.0\n    f_CaCO3 = cCaCO3 / C_Ca if C_Ca > 0 else 0.0\n\n    return [f_free, f_CaSO4, f_CaCO3]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (C_Ca_T [M], C_SO4_T [M], C_CO3_T [M], K_ip_CaSO4, K_ip_CaCO3)\n    test_cases = [\n        (0.02, 0.012, 0.008, 10.0**2.31, 10.0**3.22),\n        (0.02, 0.02, 0.0, 10.0**1.80, 10.0**3.22),\n        (0.10, 0.07, 0.03, 10.0**2.00, 10.0**3.80),\n        (0.0001, 0.00006, 0.00004, 10.0**2.31, 10.0**3.22),\n    ]\n\n    results = []\n    for C_Ca, C_SO4, C_CO3, K_s, K_c in test_cases:\n        fractions = solve_case(C_Ca, C_SO4, C_CO3, K_s, K_c)\n        # Round to 6 decimal places as required\n        rounded = [float(f\"{x:.6f}\") for x in fractions]\n        results.append(rounded)\n\n    # Final print statement in the exact required format: [[a,b,c],[...],...], no spaces\n    out = '[' + ','.join('[' + ','.join(f\"{x:.6f}\" for x in triple) + ']' for triple in results) + ']'\n    print(out)\n\nsolve()\n```"
        }
    ]
}