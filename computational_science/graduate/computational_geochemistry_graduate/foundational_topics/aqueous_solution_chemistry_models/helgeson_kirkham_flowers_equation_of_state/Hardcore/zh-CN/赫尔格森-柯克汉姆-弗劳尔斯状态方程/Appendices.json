{
    "hands_on_practices": [
        {
            "introduction": "HKF状态方程的基础在于其能够精确描述热力学性质如何随温度变化。本练习将引导您完成一个基础的推导过程，从给定的热容函数出发，计算在恒定参考压力下熵和吉布斯自由能的表达式。掌握此过程是理解HKF模型中与温度相关的参数如何构建和使用的关键。",
            "id": "4082203",
            "problem": "在计算地球化学中，Helgeson–Kirkham–Flowers (HKF) 状态方程 (EOS) 将水合物种和矿物的标准态性质参数化为依赖于温度和压力的函数。在参考压力 $P_r$ 下，标准态摩尔等压热容 $C_P^\\circ(T,P_r)$ 的一个常用表达式是关于温度 $T$ 的有理多项式。考虑某物种，其在 $P_r$ 下的标准态摩尔热容由下式给出\n$$\nC_P^\\circ(T,P_r)=a_1+a_2\\,T+\\frac{a_3}{T}+\\frac{a_4}{T^{2}},\n$$\n其中 $a_1$、$a_2$、$a_3$ 和 $a_4$ 是不依赖于温度的参数。设参考温度 $T_r$ 和参考压力 $P_r$ 下的标准态摩尔熵为 $S^\\circ(T_r,P_r)=S_r$。为便于说明，假设摩尔体积 $V^\\circ$ 不依赖于温度和压力（即 $V^\\circ$ 为常数）。整个计算过程在固定压力 $P=P_r$ 下进行。\n\n仅从基本的热力学定义和定律出发，不使用任何快捷公式，推导参考压力 $P_r$ 下的标准态摩尔熵 $S^\\circ(T,P_r)$ 和标准态摩尔吉布斯能变 $\\Delta G^\\circ(T,P_r)\\equiv G^\\circ(T,P_r)-G^\\circ(T_r,P_r)$ 的闭式解析表达式。最终答案需用 $a_1$、$a_2$、$a_3$、$a_4$、$S_r$、$T$、$T_r$ 以及标准数学函数表示。可假设 $T>0$ 且 $T_r>0$。\n\n无需进行数值计算。请提供闭式表达式。如果引入对数，必须是自然对数。请明确说明假设 $V^\\circ$ 为常数对固定压力 $P_r$ 下的推导过程有何影响。",
            "solution": "在尝试求解之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 参考压力 $P_r$ 下的标准态摩尔等压热容由 $C_P^\\circ(T,P_r)=a_1+a_2\\,T+\\frac{a_3}{T}+\\frac{a_4}{T^{2}}$ 给出。\n- 参数 $a_1$、$a_2$、$a_3$ 和 $a_4$ 不依赖于温度。\n- 参考温度为 $T_r$，参考压力为 $P_r$。\n- 参考态的标准态摩尔熵为 $S^\\circ(T_r,P_r)=S_r$。\n- 假设摩尔体积 $V^\\circ$ 为常数。\n- 计算在固定压力 $P=P_r$ 下进行。\n- 目标是推导标准态摩尔熵 $S^\\circ(T,P_r)$ 和标准态摩尔吉布斯能变 $\\Delta G^\\circ(T,P_r)\\equiv G^\\circ(T,P_r)-G^\\circ(T_r,P_r)$ 的闭式解析表达式。\n- 推导必须从基本的热力学定义和定律出发。\n- 最终表达式应用 $a_1$、$a_2$、$a_3$、$a_4$、$S_r$、$T$ 和 $T_r$ 表示。\n- 附加要求是说明假设 $V^\\circ$ 为常数的影响。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于化学热力学的基本原理，并利用了计算地球化学模型（如 HKF 状态方程）中标准的热容函数形式。从热容推导熵和吉布斯自由能是一个标准的、成熟的程序。该问题具有科学合理性。\n- **适定性**：该问题提供了一个明确定义的 $C_P^\\circ(T)$ 函数、一个熵的初始条件（$T_r$ 时的 $S_r$），并要求求出此函数的积分以及后续的函数。这构成了一个存在唯一解的适定初值问题。\n- **客观性**：问题以精确、无歧义的科学语言陈述，没有主观或基于观点的内容。\n- **缺陷分析**：问题没有列出的缺陷。它是自洽的、科学上有效的，并且可以数学形式化。假设 $V^\\circ$ 为常数被明确声明为便于说明的简化，并且不会使在恒定压力下进行的核心热力学练习失效。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。将提供一个完整的、带有推理过程的解答。\n\n***\n\n### 标准态摩尔熵 $S^\\circ(T,P_r)$ 的推导\n\n推导从等压热容 $C_P$ 的基本热力学定义开始：\n$$C_P = \\left(\\frac{\\partial H}{\\partial T}\\right)_P = T \\left(\\frac{\\partial S}{\\partial T}\\right)_P$$\n由于整个过程处于固定的标准态压力 $P_r$ 下，因此关于温度 $T$ 的偏导数可以视为全导数。对于标准态性质，这给出：\n$$C_P^\\circ(T, P_r) = T \\frac{dS^\\circ(T, P_r)}{dT}$$\n重新整理此方程可得到熵的微分表达式：\n$$dS^\\circ = \\frac{C_P^\\circ}{T} dT$$\n为了求出任意温度 $T$ 下的熵 $S^\\circ(T, P_r)$，我们将此表达式从参考态 $(T_r, S_r)$ 积分到最终态 $(T, S^\\circ(T, P_r))$：\n$$\\int_{S^\\circ(T_r, P_r)}^{S^\\circ(T, P_r)} dS'^{\\circ} = \\int_{T_r}^{T} \\frac{C_P^\\circ(T', P_r)}{T'} dT'$$\n左侧计算结果为 $S^\\circ(T, P_r) - S^\\circ(T_r, P_r) = S^\\circ(T, P_r) - S_r$。我们代入 $C_P^\\circ(T, P_r)$ 的给定表达式：\n$$S^\\circ(T, P_r) - S_r = \\int_{T_r}^{T} \\frac{1}{T'} \\left(a_1+a_2\\,T'+\\frac{a_3}{T'}+\\frac{a_4}{T'^{2}}\\right) dT'$$\n简化被积函数得到：\n$$S^\\circ(T, P_r) - S_r = \\int_{T_r}^{T} \\left(\\frac{a_1}{T'} + a_2 + a_3 T'^{-2} + a_4 T'^{-3}\\right) dT'$$\n进行逐项积分：\n$$S^\\circ(T, P_r) - S_r = \\left[ a_1 \\ln(T') + a_2 T' + \\frac{a_3 T'^{-1}}{-1} + \\frac{a_4 T'^{-2}}{-2} \\right]_{T_r}^{T}$$\n$$S^\\circ(T, P_r) - S_r = \\left[ a_1 \\ln(T') + a_2 T' - \\frac{a_3}{T'} - \\frac{a_4}{2T'^{2}} \\right]_{T_r}^{T}$$\n计算定积分：\n$$S^\\circ(T, P_r) - S_r = \\left(a_1 \\ln(T) + a_2 T - \\frac{a_3}{T} - \\frac{a_4}{2T^{2}}\\right) - \\left(a_1 \\ln(T_r) + a_2 T_r - \\frac{a_3}{T_r} - \\frac{a_4}{2T_r^{2}}\\right)$$\n分离出 $S^\\circ(T, P_r)$ 并按系数分组，得到标准态摩尔熵的最终表达式：\n$$S^\\circ(T, P_r) = S_r + a_1 (\\ln(T) - \\ln(T_r)) + a_2(T-T_r) - a_3\\left(\\frac{1}{T} - \\frac{1}{T_r}\\right) - \\frac{a_4}{2}\\left(\\frac{1}{T^2} - \\frac{1}{T_r^2}\\right)$$\n这可以更紧凑地写为：\n$$S^\\circ(T, P_r) = S_r + a_1 \\ln\\left(\\frac{T}{T_r}\\right) + a_2(T-T_r) + a_3\\left(\\frac{1}{T_r} - \\frac{1}{T}\\right) + \\frac{a_4}{2}\\left(\\frac{1}{T_r^2} - \\frac{1}{T^2}\\right)$$\n\n### 吉布斯能变 $\\Delta G^\\circ(T,P_r)$ 的推导\n\n吉布斯能变的推导从其基本微分形式开始：$dG = V dP - S dT$。对于恒定压力 $P=P_r$ 下的标准态性质，$VdP$ 项为零，从而得到：\n$$dG^\\circ = -S^\\circ dT$$\n吉布斯能变 $\\Delta G^\\circ(T,P_r) = G^\\circ(T,P_r) - G^\\circ(T_r,P_r)$ 是通过将此表达式从 $T_r$ 积分到 $T$ 来找到的：\n$$\\Delta G^\\circ(T,P_r) = \\int_{G^\\circ(T_r,P_r)}^{G^\\circ(T,P_r)} dG'^{\\circ} = \\int_{T_r}^{T} (-S^\\circ(T', P_r)) dT'$$\n我们将上面推导出的 $S^\\circ(T', P_r)$ 表达式代入积分：\n$$\\Delta G^\\circ(T,P_r) = -\\int_{T_r}^{T} \\left[ S_r + a_1 \\ln\\left(\\frac{T'}{T_r}\\right) + a_2(T'-T_r) + a_3\\left(\\frac{1}{T_r} - \\frac{1}{T'}\\right) + \\frac{a_4}{2}\\left(\\frac{1}{T_r^2} - \\frac{1}{T'^2}\\right) \\right] dT'$$\n我们逐项积分：\n1.  含有 $S_r$ 的项：$-\\int_{T_r}^{T} S_r dT' = -S_r [T']_{T_r}^T = -S_r(T-T_r)$\n2.  含有 $a_1$ 的项：$-\\int_{T_r}^{T} a_1 \\ln(\\frac{T'}{T_r}) dT' = -a_1 \\int_{T_r}^{T} (\\ln T' - \\ln T_r) dT' = -a_1 [T'\\ln T' - T' - T' \\ln T_r]_{T_r}^T = -a_1 [T \\ln\\left(\\frac{T}{T_r}\\right) - (T-T_r)] = a_1 (T-T_r) - a_1 T\\ln\\left(\\frac{T}{T_r}\\right)$\n3.  含有 $a_2$ 的项：$-\\int_{T_r}^{T} a_2(T'-T_r) dT' = -a_2 [\\frac{T'^2}{2} - T_r T']_{T_r}^T = -a_2 [(\\frac{T^2}{2}-T_r T) - (\\frac{T_r^2}{2}-T_r^2)] = -a_2 [\\frac{T^2}{2}-T_r T + \\frac{T_r^2}{2}] = -\\frac{a_2}{2}(T-T_r)^2$\n4.  含有 $a_3$ 的项：$-\\int_{T_r}^{T} a_3(\\frac{1}{T_r} - \\frac{1}{T'}) dT' = -a_3 [\\frac{T'}{T_r} - \\ln T']_{T_r}^T = -a_3 [(\\frac{T}{T_r}-\\ln T) - (\\frac{T_r}{T_r} - \\ln T_r)] = -a_3 [\\frac{T-T_r}{T_r} - \\ln\\left(\\frac{T}{T_r}\\right)] = a_3\\ln\\left(\\frac{T}{T_r}\\right) - a_3\\frac{T-T_r}{T_r}$\n5.  含有 $a_4$ 的项：$-\\int_{T_r}^{T} \\frac{a_4}{2}(\\frac{1}{T_r^2} - T'^{-2}) dT' = -\\frac{a_4}{2} [\\frac{T'}{T_r^2} + \\frac{1}{T'}]_{T_r}^T = -\\frac{a_4}{2} [(\\frac{T}{T_r^2}+\\frac{1}{T}) - (\\frac{T_r}{T_r^2}+\\frac{1}{T_r})] = -\\frac{a_4}{2} [\\frac{T-T_r}{T_r^2} + \\frac{1}{T}-\\frac{1}{T_r}] = -\\frac{a_4}{2} [\\frac{T-T_r}{T_r^2} + \\frac{T_r-T}{TT_r}] = -\\frac{a_4}{2}(T-T_r)[\\frac{1}{T_r^2}-\\frac{1}{TT_r}] = -\\frac{a_4}{2}(T-T_r)\\frac{T-T_r}{TT_r^2} = -\\frac{a_4(T-T_r)^2}{2TT_r^2}$\n\n将这些项相加，得到标准态摩尔吉布斯能变的最终表达式：\n$$\\Delta G^\\circ(T,P_r) = -S_r(T-T_r) + a_1\\left((T-T_r) - T\\ln\\left(\\frac{T}{T_r}\\right)\\right) - \\frac{a_2}{2}(T-T_r)^2 + a_3\\left(\\ln\\left(\\frac{T}{T_r}\\right) - \\frac{T-T_r}{T_r}\\right) - \\frac{a_4(T-T_r)^2}{2TT_r^2}$$\n\n### 假设 $V^\\circ$ 为常数的影响\n\n问题询问假设摩尔体积 $V^\\circ$ 为常数如何影响推导过程。整个推导过程是在固定压力 $P = P_r$ 下进行的。\n$S^\\circ(T,P_r)$ 的推导仅依赖于 $\\frac{C_P^\\circ}{T}$ 对温度的积分。使用的基本关系是 $(\\frac{\\partial S}{\\partial T})_P = \\frac{C_P}{T}$。\n$\\Delta G^\\circ(T,P_r)$ 的推导仅依赖于 $-S^\\circ$ 对温度的积分。使用的基本关系是 $(\\frac{\\partial G}{\\partial T})_P = -S$。\n当在恒定压力下应用时，这两个热力学关系都不涉及摩尔体积 $V^\\circ$ 或其导数。摩尔体积仅在计算热力学性质相对于压力的变化时才变得相关，例如通过 $(\\frac{\\partial G}{\\partial P})_T = V$ 和 $(\\frac{\\partial S}{\\partial P})_T = -(\\frac{\\partial V}{\\partial T})_P$ 等关系式。\n由于问题局限于单一等压线 $P=P_r$，所提供的关于 $V^\\circ$ 为常数的信息是多余的。它对推导固定压力下 $S^\\circ$ 和 $G^\\circ$ 的温度依赖性**没有影响**。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nS_r + a_1 \\ln\\left(\\frac{T}{T_r}\\right) + a_2(T-T_r) + a_3\\left(\\frac{1}{T_r} - \\frac{1}{T}\\right) + \\frac{a_4}{2}\\left(\\frac{1}{T_r^2} - \\frac{1}{T^2}\\right) \\\\ -S_r(T-T_r) + a_1\\left((T-T_r) - T\\ln\\left(\\frac{T}{T_r}\\right)\\right) - \\frac{a_2}{2}(T-T_r)^2 + a_3\\left(\\ln\\left(\\frac{T}{T_r}\\right) - \\frac{T-T_r}{T_r}\\right) - \\frac{a_4(T-T_r)^2}{2TT_r^2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在温度依赖性的基础上，我们现在引入压力的影响来描述一个完整的热力学状态。本练习要求您通过沿特定路径积分，计算跨越温度和压力的吉布斯自由能变化，从而强化$G$作为一个状态函数的概念。这项技能对于将HKF模型应用于温度和压力都显著变化的多样化地质环境中至关重要。",
            "id": "4082222",
            "problem": "在计算地球化学中，Helgeson–Kirkham–Flowers (HKF) 状态方程为水溶液中物种的标准态吉布斯自由能如何随温度和压力变化提供了一个严谨的框架。从单组分系统吉布斯自由能的基本热力学恒等式 $dG^{\\circ}=-S^{\\circ}\\,dT+V^{\\circ}\\,dP$ 出发，并考虑到 $G^{\\circ}$ 是一个状态函数，我们考虑以下一个在窄温度和压力范围内有效的简化但科学上合理的模型：在参考压力 $P_{r}$ 下的标准态摩尔熵为 $S^{\\circ}(T,P_{r})=S_{0}+k\\,T$，其中 $S_{0}$ 和 $k$ 为常数；标准态偏摩尔体积与压力和温度无关，即 $V^{\\circ}(T,P)=V_{0}$，其中 $V_{0}$ 为常数。假设在此近似下，熵与压力无关，因此 $S^{\\circ}(T,P)=S^{\\circ}(T,P_{r})$。\n\n仅使用热力学恒等式和状态函数性质，通过沿连接 $(T_{r},P_{r})$ 到 $(T,P)$ 的任意可逆路径积分，计算标准态吉布斯自由能变化 $\\Delta G^{\\circ}(T,P)=G^{\\circ}(T,P)-G^{\\circ}(T_{r},P_{r})$。然后验证在所述假设下，$\\left(\\partial \\Delta G^{\\circ}/\\partial T\\right)_{P}=-S^{\\circ}(T,P)$ 和 $\\left(\\partial \\Delta G^{\\circ}/\\partial P\\right)_{T}=V^{\\circ}(T,P)$ 成立。将最终的 $\\Delta G^{\\circ}(T,P)$ 表示为包含 $S_{0}$、$k$、$V_{0}$、$T$、$P$、$T_{r}$ 和 $P_{r}$ 的闭式解析表达式。最终表达式中无需进行数值计算或四舍五入，也不应包含单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤1：提取已知条件**\n- 标准态吉布斯自由能的基本热力学恒等式为 $dG^{\\circ}=-S^{\\circ}\\,dT+V^{\\circ}\\,dP$。\n- $G^{\\circ}$ 是一个状态函数。\n- 参考压力 $P_{r}$ 下的标准态摩尔熵由模型 $S^{\\circ}(T,P_{r})=S_{0}+k\\,T$ 给出，其中 $S_{0}$ 和 $k$ 是常数。\n- 标准态偏摩尔体积是常数：$V^{\\circ}(T,P)=V_{0}$。\n- 熵被假设为与压力无关：$S^{\\circ}(T,P)=S^{\\circ}(T,P_{r})$，这意味着 $S^{\\circ}(T,P) = S_{0}+k\\,T$。\n- 目标是计算变化量 $\\Delta G^{\\circ}(T,P)=G^{\\circ}(T,P)-G^{\\circ}(T_{r},P_{r})$，并验证结果与关系式 $(\\partial \\Delta G^{\\circ}/\\partial T)_{P}=-S^{\\circ}(T,P)$ 和 $(\\partial \\Delta G^{\\circ}/\\partial P)_{T}=V^{\\circ}(T,P)$ 一致。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。它植根于化学热力学的基本原理。为确保热力学上的自洽性，所提供的熵和体积的本构关系必须满足相关的麦克斯韦关系。对于吉布斯自由能，此关系为：\n$$\n\\left(\\frac{\\partial S^{\\circ}}{\\partial P}\\right)_{T} = -\\left(\\frac{\\partial V^{\\circ}}{\\partial T}\\right)_{P}\n$$\n根据已知条件，我们有 $S^{\\circ}(T,P) = S_{0}+k\\,T$。在恒定温度下对压力的偏导数为：\n$$\n\\left(\\frac{\\partial S^{\\circ}}{\\partial P}\\right)_{T} = \\frac{\\partial}{\\partial P}(S_{0}+k\\,T) = 0\n$$\n我们还有 $V^{\\circ}(T,P) = V_{0}$。在恒定压力下对温度的偏导数为：\n$$\n\\left(\\frac{\\partial V^{\\circ}}{\\partial T}\\right)_{P} = \\frac{\\partial}{\\partial T}(V_{0}) = 0\n$$\n将这些结果代入麦克斯韦关系式，得到 $0 = -0$，这是一个有效的恒等式。该模型在热力学上是自洽的。问题没有科学缺陷、模糊之处或矛盾。所有必要的信息都已提供，可以找到唯一解。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将推导解答。\n\n**解题推导**\n标准态吉布斯自由能的变化量 $\\Delta G^{\\circ}$ 从初始状态 $(T_{r}, P_{r})$ 到最终状态 $(T, P)$ 由其全微分 $dG^{\\circ}$ 的积分给出：\n$$\n\\Delta G^{\\circ}(T,P) = G^{\\circ}(T,P) - G^{\\circ}(T_{r},P_{r}) = \\int_{(T_{r},P_{r})}^{(T,P)} dG^{\\circ}\n$$\n将给定的 $S^{\\circ}(T,P)$ 和 $V^{\\circ}(T,P)$ 表达式代入基本恒等式，得到：\n$$\ndG^{\\circ} = -(S_{0}+k\\,T)dT + V_{0}\\,dP\n$$\n由于 $G^{\\circ}$ 是状态函数，$\\Delta G^{\\circ}$ 的积分值与积分路径无关。我们可以选择从 $(T_{r},P_{r})$ 到 $(T,P)$ 的任何方便的可逆路径。一个计算上简单的路径包括两个步骤：\n1.  在参考压力 $P_{r}$ 下的等压步骤，将温度从 $T_{r}$ 变为 $T$。\n2.  在最终温度 $T$ 下的等温步骤，将压力从 $P_{r}$ 变为 $P$。\n\n总变化量 $\\Delta G^{\\circ}$ 是每一步变化的和，$\\Delta G^{\\circ} = \\Delta G_{1}^{\\circ} + \\Delta G_{2}^{\\circ}$。\n\n对于步骤1（在 $P_r$ 下从 $T_r$ 到 $T$ 的等压加热）：\n压力恒定，所以 $dP = 0$。吉布斯自由能的变化为：\n$$\n\\Delta G_{1}^{\\circ} = \\int_{T_{r}}^{T} -S^{\\circ}(T',P_{r})\\,dT' = \\int_{T_{r}}^{T} -(S_{0}+k\\,T')\\,dT'\n$$\n进行积分：\n$$\n\\Delta G_{1}^{\\circ} = -\\left[S_{0}T' + \\frac{1}{2}kT'^{2}\\right]_{T_{r}}^{T} = -\\left(S_{0}T + \\frac{1}{2}kT^{2}\\right) - \\left(-\\left(S_{0}T_{r} + \\frac{1}{2}kT_{r}^{2}\\right)\\right)\n$$\n$$\n\\Delta G_{1}^{\\circ} = -S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2})\n$$\n\n对于步骤2（在 $T$ 下从 $P_r$ 到 $P$ 的等温压缩/膨胀）：\n温度恒定，所以 $dT = 0$。吉布斯自由能的变化为：\n$$\n\\Delta G_{2}^{\\circ} = \\int_{P_{r}}^{P} V^{\\circ}(T,P')\\,dP' = \\int_{P_{r}}^{P} V_{0}\\,dP'\n$$\n进行积分：\n$$\n\\Delta G_{2}^{\\circ} = \\left[V_{0}P'\\right]_{P_{r}}^{P} = V_{0}P - V_{0}P_{r} = V_{0}(P-P_{r})\n$$\n\n吉布斯自由能的总变化是这两个步骤变化的和：\n$$\n\\Delta G^{\\circ}(T,P) = \\Delta G_{1}^{\\circ} + \\Delta G_{2}^{\\circ} = -S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}(P-P_{r})\n$$\n这就是标准态吉布斯自由能变化的闭式解析表达式。\n\n**验证**\n现在，我们必须验证这个表达式与基本偏导数关系式是否一致。注意，$\\Delta G^{\\circ}(T,P) = G^{\\circ}(T,P) - G^{\\circ}(T_r, P_r)$，并且由于 $G^{\\circ}(T_r, P_r)$ 是一个常数，$\\Delta G^{\\circ}$ 的偏导数与 $G^{\\circ}$ 的偏导数相同。\n\n首先，我们验证 $\\left(\\partial \\Delta G^{\\circ}/\\partial T\\right)_{P} = -S^{\\circ}(T,P)$：\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial T}\\right)_{P} = \\frac{\\partial}{\\partial T}\\left[-S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}(P-P_{r})\\right]_{P}\n$$\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial T}\\right)_{P} = \\frac{\\partial}{\\partial T}\\left[-S_{0}T + S_{0}T_{r} - \\frac{k}{2}T^{2} + \\frac{k}{2}T_{r}^{2} + V_{0}(P-P_{r})\\right]_{P}\n$$\n由于 $S_{0}$、$k$、$T_{r}$、$P$ 和 $P_{r}$ 相对于微分变量 $T$ 都是常数：\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial T}\\right)_{P} = -S_{0} + 0 - \\frac{k}{2}(2T) + 0 + 0 = -S_{0} - kT = -(S_{0}+kT)\n$$\n根据问题陈述，$S^{\\circ}(T,P) = S_{0}+k\\,T$。因此，我们成功验证了 $\\left(\\partial \\Delta G^{\\circ}/\\partial T\\right)_{P} = -S^{\\circ}(T,P)$。\n\n其次，我们验证 $\\left(\\partial \\Delta G^{\\circ}/\\partial P\\right)_{T} = V^{\\circ}(T,P)$：\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial P}\\right)_{T} = \\frac{\\partial}{\\partial P}\\left[-S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}(P-P_{r})\\right]_{T}\n$$\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial P}\\right)_{T} = \\frac{\\partial}{\\partial P}\\left[-S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}P - V_{0}P_{r}\\right]_{T}\n$$\n由于除了 $V_{0}P$ 之外的所有项相对于微分变量 $P$ 都是常数：\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial P}\\right)_{T} = 0 - 0 + V_{0} - 0 = V_{0}\n$$\n根据问题陈述，$V^{\\circ}(T,P) = V_{0}$。因此，我们成功验证了 $\\left(\\partial \\Delta G^{\\circ}/\\partial P\\right)_{T} = V^{\\circ}(T,P)$。\n推导出的 $\\Delta G^{\\circ}(T,P)$ 表达式是正确且自洽的。",
            "answer": "$$\n\\boxed{-S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}(P-P_{r})}\n$$"
        },
        {
            "introduction": "像HKF这样的理论模型依赖于准确的实验数据，特别是溶剂（水）的物理化学性质。本练习旨在弥合理论与实际应用之间的差距，要求您使用数值插值方法，从给定的表格数据中高效地计算水的密度和介电常数。这是使用HKF状态方程进行地球化学模拟时，一项至关重要且基础的计算技能。",
            "id": "4082164",
            "problem": "您的任务是设计一个高效的数值程序，用于计算 Helgeson-Kirkham-Flowers (HKF) 状态方程中所需的溶剂相关函数。目标函数依赖于液态水密度 $\\rho(T,P)$ 和静态介电常数 $\\epsilon(T,P)$，它们都是温度 $T$ 和压力 $P$ 的函数。该程序必须使用表格化的水状态方程 (EOS) 数据，并在矩形网格上采用三次样条插值，以获得表格化定义域内任意点的 $\\rho(T,P)$ 和 $\\epsilon(T,P)$ 值。\n\n从以下基本基础开始：\n- 样条插值函数的一般定义，它是一种分段多项式，在节点处确保函数及其导数的连续性。\n- 物理意义：静态介电常数 $\\epsilon$ 控制连续介质静电相互作用，而密度 $\\rho$ 则反映了溶剂的堆积和压缩效应。\n- 要求当列表数据相对于 $T$ 和 $P$ 是单调时，插值应保持平滑性，且不引入非物理振荡。\n\n实现以下内容：\n1. 使用提供的液态水列表数据，在矩形网格上为 $\\rho(T,P)$ 和 $\\epsilon(T,P)$ 构建双三次样条插值函数（张量积三次样条）。\n2. 使用这些插值函数，计算以下三个溶剂函数：\n   - $S_1(T,P) = 1 - \\epsilon(T,P)^{-1}$。\n   - $S_2(T,P) = \\ln\\big(\\rho(T,P)/\\rho_{\\text{ref}}\\big)$，其中 $\\rho_{\\text{ref}} = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n   - $S_3(T,P) = \\epsilon(T,P)^{-1/2}\\rho(T,P)^{-1/3}$。\n   这些函数是无量纲的，分别代表连续介质静电学（Born 型依赖关系）、可压缩性标度以及组合的屏蔽-密度标度。\n\n使用以下液态水性质的矩形网格。温度 $T$ 的单位为 $\\mathrm{K}$，压力 $P$ 的单位为 $\\mathrm{MPa}$。密度的单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$，介电常数为无量纲。网格点如下：\n$$\n\\boldsymbol{T} = [\\,298.15,\\;373.15,\\;473.15,\\;573.15,\\;673.15\\,]\\,\\mathrm{K},\\qquad\n\\boldsymbol{P} = [\\,10.0,\\;25.0,\\;40.0,\\;50.0\\,]\\,\\mathrm{MPa}.\n$$\n在这些点上，表格化的液态水性质如下：\n$$\n\\rho(T_i,P_j)\\;[\\mathrm{kg}\\,\\mathrm{m}^{-3}] =\n\\begin{bmatrix}\n1008  1012  1016  1020 \\\\\n971  988  1000  1008 \\\\\n900  930  950  970 \\\\\n780  820  850  870 \\\\\n600  650  690  720\n\\end{bmatrix},\n\\quad\n\\epsilon(T_i,P_j) =\n\\begin{bmatrix}\n80.0  81.0  82.0  82.5 \\\\\n57.0  59.0  60.5  61.5 \\\\\n38.0  42.0  44.5  47.0 \\\\\n24.0  28.0  31.0  33.0 \\\\\n12.0  15.0  18.0  20.0\n\\end{bmatrix}.\n$$\n\n您的程序必须：\n- 在由 $\\boldsymbol{T}$ 和 $\\boldsymbol{P}$ 定义的矩形网格上，为 $\\rho(T,P)$ 和 $\\epsilon(T,P)$ 构建双三次样条插值函数。\n- 在以下五个测试用例中计算 $S_1(T,P)$, $S_2(T,P)$ 和 $S_3(T,P)$ 的值，所有测试用例均位于表格化定义域内：\n  1. $(T,P) = (350.0\\,\\mathrm{K}, 20.0\\,\\mathrm{MPa})$,\n  2. $(T,P) = (298.15\\,\\mathrm{K}, 25.0\\,\\mathrm{MPa})$,\n  3. $(T,P) = (673.15\\,\\mathrm{K}, 50.0\\,\\mathrm{MPa})$,\n  4. $(T,P) = (573.15\\,\\mathrm{K}, 10.0\\,\\mathrm{MPa})$,\n  5. $(T,P) = (430.0\\,\\mathrm{K}, 30.0\\,\\mathrm{MPa})$.\n\n答案要求：\n- 将所有输出表示为四舍五入到六位小数的浮点数。\n- 最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，其顺序为\n$$\n[S_1^{(1)}, S_2^{(1)}, S_3^{(1)}, S_1^{(2)}, S_2^{(2)}, S_3^{(2)}, S_1^{(3)}, S_2^{(3)}, S_3^{(3)}, S_1^{(4)}, S_2^{(4)}, S_3^{(4)}, S_1^{(5)}, S_2^{(5)}, S_3^{(5)}],\n$$\n其中上标表示测试用例的索引。\n\n设计约束和说明：\n- 在 $T$ 和 $P$ 两个方向上都使用与张量积三次 B 样条一致的双三次样条插值，确保每个维度至少有 $4$ 个节点以支持三次样条。\n- 仅在列表网格的凸包内进行插值；所提供的测试用例均为内部点和边界点，从而避免了外插。\n- 科学真实性：列表中的数值遵循压缩液态水在物理上的合理趋势，即 $\\rho$ 随 $P$ 的增加而增加，随 $T$ 的增加而减少；而 $\\epsilon$ 通常随 $T$ 的增加而减少，随 $P$ 的增加而轻微增加。",
            "solution": "该问题是有效的。其科学基础是计算地球化学的原理，特别是与 Helgeson-Kirkham-Flowers (HKF) 状态方程相关。该问题是适定的，提供了所有必要的数据——温度和压力网格、相应的密度和介电常数矩阵，以及目标函数的精确定义。这个数值任务，即双三次样条插值，是一个标准且定义明确的程序，存在唯一且稳定的解。所有测试点都位于所提供数据网格的边界内，确保了是内插而非外插。问题陈述客观且无歧义。\n\n解决此问题需要为液态水的密度 $\\rho(T,P)$ 和静态介电常数 $\\epsilon(T,P)$ 创建一个数值模型，将它们表示为温度 $T$ 和压力 $P$ 的连续函数。我们在一个矩形网格上获得了这些性质的离散值。双三次样条插值是构建这些连续函数近似的指定方法。\n\n在由节点 $(T_i, P_j)$ 定义的矩形网格上的双三次样条插值函数是一个分段函数。在每个矩形单元 $[T_i, T_{i+1}] \\times [P_j, P_{j+1}]$ 内，该函数是一个形式如下的双三次多项式：\n$$ S(T,P) = \\sum_{k=0}^{3} \\sum_{l=0}^{3} c_{kl}^{(ij)} (T - T_i)^k (P - P_j)^l $$\n每个单元的系数 $c_{kl}^{(ij)}$ 是通过确保插值函数在节点处与给定数据值 $S(T_i, P_j) = Z_{ij}$ 相匹配，并且函数及其一阶和二阶偏导数在单元格边界上连续来确定的。这种方法，也称为张量积样条，能确保生成一个光滑的曲面，该曲面能准确地表示基础数据，而不会引入非物理振荡。\n\n计算过程如下：\n1.  定义网格轴：一个温度向量 $\\boldsymbol{T}$ 和一个压力向量 $\\boldsymbol{P}$。\n    $$ \\boldsymbol{T} = [298.15, 373.15, 473.15, 573.15, 673.15]\\,\\mathrm{K} $$\n    $$ \\boldsymbol{P} = [10.0, 25.0, 40.0, 50.0]\\,\\mathrm{MPa} $$\n2.  定义相应的密度数据矩阵 $\\boldsymbol{\\rho}$ 和介电常数数据矩阵 $\\boldsymbol{\\epsilon}$。\n3.  使用数值库构建两个独立的双三次样条插值对象。一个插值函数 $\\rho_{\\text{spline}}(T,P)$ 将用于建模密度，另一个 $\\epsilon_{\\text{spline}}(T,P)$ 将用于建模介电常数。这些对象是根据网格向量及其各自的数据矩阵创建的。`scipy.interpolate.RectBivariateSpline` 函数非常适合此任务，因为它实现了该算法的一个稳健版本。\n4.  对于五个指定的测试点 $(T_k, P_k)$ 中的每一个，计算插值函数的值以获得 $\\rho_k = \\rho_{\\text{spline}}(T_k, P_k)$ 和 $\\epsilon_k = \\epsilon_{\\text{spline}}(T_k, P_k)$。\n5.  使用这些插值得到的值，计算所需的三个无量纲溶剂函数：\n    -   Born 函数代理：$S_1^{(k)} = 1 - \\epsilon_k^{-1}$\n    -   可压缩性标度函数：$S_2^{(k)} = \\ln(\\rho_k/\\rho_{\\mathrm{ref}})$，其中 $\\rho_{\\mathrm{ref}} = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n    -   组合标度函数：$S_3^{(k)} = \\epsilon_k^{-1/2} \\rho_k^{-1/3}$\n6.  收集并格式化每个测试用例的结果 $(S_1^{(k)}, S_2^{(k)}, S_3^{(k)})$。对于测试点恰好位于网格节点上的情况，样条插值会正确返回原始的列表值。\n\n此过程能够在定义的温度和压力范围内的任何点上，为溶剂性质和派生函数提供准确的估计，这是将 HKF 状态方程应用于地球化学建模的一个基本要求。",
            "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import RectBivariateSpline\n\ndef solve():\n    \"\"\"\n    Constructs bicubic spline interpolants for water density and dielectric constant,\n    and evaluates derived solvent functions at specified test points.\n    \"\"\"\n    # Step 1: Define the grid and tabulated data\n    \n    # Grid vectors\n    T_grid = np.array([298.15, 373.15, 473.15, 573.15, 673.15])  # Temperature in K\n    P_grid = np.array([10.0, 25.0, 40.0, 50.0])  # Pressure in MPa\n\n    # Tabulated data matrices\n    # rho_data[i, j] corresponds to T_grid[i] and P_grid[j]\n    rho_data = np.array([\n        [1008, 1012, 1016, 1020],\n        [971, 988, 1000, 1008],\n        [900, 930, 950, 970],\n        [780, 820, 850, 870],\n        [600, 650, 690, 720]\n    ])  # Density in kg/m^3\n\n    epsilon_data = np.array([\n        [80.0, 81.0, 82.0, 82.5],\n        [57.0, 59.0, 60.5, 61.5],\n        [38.0, 42.0, 44.5, 47.0],\n        [24.0, 28.0, 31.0, 33.0],\n        [12.0, 15.0, 18.0, 20.0]\n    ])  # Dielectric constant (dimensionless)\n\n    # Reference density\n    rho_ref = 1000.0  # kg/m^3\n\n    # Step 2: Construct the bicubic spline interpolants\n    # kx=3 and ky=3 specify cubic splines in each dimension.\n    rho_spline = RectBivariateSpline(T_grid, P_grid, rho_data, kx=3, ky=3)\n    epsilon_spline = RectBivariateSpline(T_grid, P_grid, epsilon_data, kx=3, ky=3)\n\n    # Step 3: Define the test cases\n    test_cases = [\n        (350.0, 20.0),    # Case 1\n        (298.15, 25.0),   # Case 2 (on grid)\n        (673.15, 50.0),   # Case 3 (on grid)\n        (573.15, 10.0),   # Case 4 (on grid)\n        (430.0, 30.0)     # Case 5\n    ]\n\n    # Step 4: Evaluate functions for each test case\n    results = []\n    for T_eval, P_eval in test_cases:\n        # Interpolate to find rho and epsilon at the test point.\n        # The spline returns a 1x1 array, so we extract the scalar value.\n        rho_val = rho_spline(T_eval, P_eval)[0, 0]\n        epsilon_val = epsilon_spline(T_eval, P_eval)[0, 0]\n\n        # Calculate the derived solvent functions\n        s1 = 1.0 - 1.0 / epsilon_val\n        s2 = np.log(rho_val / rho_ref)\n        s3 = (epsilon_val**(-0.5)) * (rho_val**(-1.0/3.0))\n\n        # Append the three results for the current case\n        results.extend([s1, s2, s3])\n\n    # Step 5: Format and print the final output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}