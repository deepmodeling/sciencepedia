{
    "hands_on_practices": [
        {
            "introduction": "HKF状态方程的核心在于其对标准态热力学性质（特别是热容）的参数化。本练习将带您实践一项基本的热力学推导：从一个给定的标准摩尔等压热容 $C_P^\\circ$ 的温度函数出发，通过积分计算出标准摩尔熵 $S^\\circ$ 和吉布斯自由能 $G^\\circ$ 如何随温度变化。这项技能是理解和应用任何基于热容积分的热力学模型的基石 。",
            "id": "4082203",
            "problem": "在计算地球化学中，Helgeson–Kirkham–Flowers (HKF) 状态方程 (EOS) 将水溶液中物种和矿物的标准态性质参数化为与温度和压力相关的函数。在参考压力 $P_r$ 下，标准态摩尔等压热容 $C_P^\\circ(T,P_r)$ 的一种常用表示方法是关于温度 $T$ 的有理多项式。考虑一个物种，其在 $P_r$ 下的标准态摩尔热容由下式给出\n$$\nC_P^\\circ(T,P_r)=a_1+a_2\\,T+\\frac{a_3}{T}+\\frac{a_4}{T^{2}},\n$$\n其中 $a_1$、$a_2$、$a_3$ 和 $a_4$ 是不依赖于温度的参数。设参考温度 $T_r$ 和参考压力 $P_r$ 下的标准态摩尔熵为 $S^\\circ(T_r,P_r)=S_r$。为便于说明，假设摩尔体积 $V^\\circ$ 不依赖于温度和压力（$V^\\circ$ 为常数）。在整个计算过程中，均在固定压力 $P=P_r$ 下进行。\n\n仅从基本热力学定义和定律出发，而不使用任何快捷公式，推导在参考压力 $P_r$ 下，标准态摩尔熵 $S^\\circ(T,P_r)$ 和标准态摩尔吉布斯自由能变化 $\\Delta G^\\circ(T,P_r)\\equiv G^\\circ(T,P_r)-G^\\circ(T_r,P_r)$ 的闭合形式解析表达式。最终答案需用 $a_1$、$a_2$、$a_3$、$a_4$、$S_r$、$T$、$T_r$ 和标准数学函数表示。你可以假设 $T0$ 和 $T_r0$。\n\n不需要进行数值计算。请提供闭合形式的表达式。如果引入任何对数，它们必须是自然对数。清楚地说明在固定压力 $P_r$ 下，恒定 $V^\\circ$ 的假设如何影响推导过程。",
            "solution": "在尝试解答之前，需对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 参考压力 $P_r$ 下的标准态摩尔等压热容由 $C_P^\\circ(T,P_r)=a_1+a_2\\,T+\\frac{a_3}{T}+\\frac{a_4}{T^{2}}$ 给出。\n- 参数 $a_1$、$a_2$、$a_3$ 和 $a_4$ 不依赖于温度。\n- 参考温度为 $T_r$，参考压力为 $P_r$。\n- 参考状态下的标准态摩尔熵为 $S^\\circ(T_r,P_r)=S_r$。\n- 假设摩尔体积 $V^\\circ$ 为常数。\n- 计算在固定压力 $P=P_r$ 下进行。\n- 目标是推导标准态摩尔熵 $S^\\circ(T,P_r)$ 和标准态摩尔吉布斯自由能变化 $\\Delta G^\\circ(T,P_r)\\equiv G^\\circ(T,P_r)-G^\\circ(T_r,P_r)$ 的闭合形式解析表达式。\n- 推导必须从基本热力学定义和定律出发。\n- 最终表达式应用 $a_1$、$a_2$、$a_3$、$a_4$、$S_r$、$T$ 和 $T_r$ 表示。\n- 一项附加要求是说明恒定 $V^\\circ$ 假设的影响。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **有科学依据**：该问题基于化学热力学的基本原理，并使用了在计算地球化学模型（如 HKF 状态方程）中标准的热容函数形式。从热容推导熵和吉布斯自由能是一个标准的、成熟的程序。该问题在科学上是合理的。\n- **适定的**：该问题为 $C_P^\\circ(T)$ 提供了一个良定义的函数，一个熵的初始条件（$T_r$ 时的 $S_r$），并要求计算该函数和一个后续函数的积分。这构成了一个存在唯一解的适定初值问题。\n- **客观的**：该问题使用精确、无歧义的科学语言陈述，不含任何主观或基于意见的内容。\n- **缺陷分析**：该问题没有列出的缺陷。它是自洽的、科学上有效的，并且可以进行数学形式化。恒定 $V^\\circ$ 的假设被明确声明为为了说明目的而作的简化，并且不会使在恒定压力下进行的核心热力学练习无效。\n\n### 第 3 步：结论和行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n***\n\n### 标准态摩尔熵 $S^\\circ(T,P_r)$ 的推导\n\n推导从等压热容 $C_P$ 的基本热力学定义开始：\n$$C_P = \\left(\\frac{\\partial H}{\\partial T}\\right)_P = T \\left(\\frac{\\partial S}{\\partial T}\\right)_P$$\n由于整个过程都在固定的标准态压力 $P_r$ 下进行，因此关于温度 $T$ 的偏导数可以视为全导数。对于标准态性质，这给出：\n$$C_P^\\circ(T, P_r) = T \\frac{dS^\\circ(T, P_r)}{dT}$$\n重新整理此方程可得到熵的微分表达式：\n$$dS^\\circ = \\frac{C_P^\\circ}{T} dT$$\n为了求出任意温度 $T$ 下的熵 $S^\\circ(T, P_r)$，我们将此表达式从参考状态 $(T_r, S_r)$ 积分到最终状态 $(T, S^\\circ(T, P_r))$：\n$$\\int_{S^\\circ(T_r, P_r)}^{S^\\circ(T, P_r)} dS'^{\\circ} = \\int_{T_r}^{T} \\frac{C_P^\\circ(T', P_r)}{T'} dT'$$\n左边的计算结果为 $S^\\circ(T, P_r) - S^\\circ(T_r, P_r) = S^\\circ(T, P_r) - S_r$。我们代入 $C_P^\\circ(T, P_r)$ 的给定表达式：\n$$S^\\circ(T, P_r) - S_r = \\int_{T_r}^{T} \\frac{1}{T'} \\left(a_1+a_2\\,T'+\\frac{a_3}{T'}+\\frac{a_4}{T'^{2}}\\right) dT'$$\n简化被积函数得到：\n$$S^\\circ(T, P_r) - S_r = \\int_{T_r}^{T} \\left(\\frac{a_1}{T'} + a_2 + a_3 T'^{-2} + a_4 T'^{-3}\\right) dT'$$\n逐项进行积分：\n$$S^\\circ(T, P_r) - S_r = \\left[ a_1 \\ln(T') + a_2 T' + \\frac{a_3 T'^{-1}}{-1} + \\frac{a_4 T'^{-2}}{-2} \\right]_{T_r}^{T}$$\n$$S^\\circ(T, P_r) - S_r = \\left[ a_1 \\ln(T') + a_2 T' - \\frac{a_3}{T'} - \\frac{a_4}{2T'^{2}} \\right]_{T_r}^{T}$$\n计算定积分：\n$$S^\\circ(T, P_r) - S_r = \\left(a_1 \\ln(T) + a_2 T - \\frac{a_3}{T} - \\frac{a_4}{2T^{2}}\\right) - \\left(a_1 \\ln(T_r) + a_2 T_r - \\frac{a_3}{T_r} - \\frac{a_4}{2T_r^{2}}\\right)$$\n分离出 $S^\\circ(T, P_r)$ 并按系数对各项进行分组，得到标准态摩尔熵的最终表达式：\n$$S^\\circ(T, P_r) = S_r + a_1 (\\ln(T) - \\ln(T_r)) + a_2(T-T_r) - a_3\\left(\\frac{1}{T} - \\frac{1}{T_r}\\right) - \\frac{a_4}{2}\\left(\\frac{1}{T^2} - \\frac{1}{T_r^2}\\right)$$\n这可以更紧凑地写成：\n$$S^\\circ(T, P_r) = S_r + a_1 \\ln\\left(\\frac{T}{T_r}\\right) + a_2(T-T_r) + a_3\\left(\\frac{1}{T_r} - \\frac{1}{T}\\right) + \\frac{a_4}{2}\\left(\\frac{1}{T_r^2} - \\frac{1}{T^2}\\right)$$\n\n### 吉布斯自由能变化 $\\Delta G^\\circ(T,P_r)$ 的推导\n\n吉布斯自由能变化的推导从其基本微分形式开始：$dG = V dP - S dT$。对于恒定压力 $P=P_r$ 下的标准态性质，$VdP$ 项为零，从而得到：\n$$dG^\\circ = -S^\\circ dT$$\n吉布斯自由能的变化 $\\Delta G^\\circ(T,P_r) = G^\\circ(T,P_r) - G^\\circ(T_r,P_r)$，可以通过将此表达式从 $T_r$ 积分到 $T$ 来求得：\n$$\\Delta G^\\circ(T,P_r) = \\int_{G^\\circ(T_r,P_r)}^{G^\\circ(T,P_r)} dG'^{\\circ} = \\int_{T_r}^{T} (-S^\\circ(T', P_r)) dT'$$\n我们将上面推导出的 $S^\\circ(T', P_r)$ 表达式代入积分中：\n$$\\Delta G^\\circ(T,P_r) = -\\int_{T_r}^{T} \\left[ S_r + a_1 \\ln\\left(\\frac{T'}{T_r}\\right) + a_2(T'-T_r) + a_3\\left(\\frac{1}{T_r} - \\frac{1}{T'}\\right) + \\frac{a_4}{2}\\left(\\frac{1}{T_r^2} - \\frac{1}{T'^2}\\right) \\right] dT'$$\n我们逐项积分：\n1.  含 $S_r$ 的项：$-\\int_{T_r}^{T} S_r dT' = -S_r [T']_{T_r}^T = -S_r(T-T_r)$\n2.  含 $a_1$ 的项：$-\\int_{T_r}^{T} a_1 \\ln(\\frac{T'}{T_r}) dT' = -a_1 \\int_{T_r}^{T} (\\ln T' - \\ln T_r) dT' = -a_1 [T'\\ln T' - T' - T' \\ln T_r]_{T_r}^T = -a_1 [T \\ln\\left(\\frac{T}{T_r}\\right) - (T-T_r)] = a_1 (T-T_r) - a_1 T\\ln\\left(\\frac{T}{T_r}\\right)$\n3.  含 $a_2$ 的项：$-\\int_{T_r}^{T} a_2(T'-T_r) dT' = -a_2 [\\frac{T'^2}{2} - T_r T']_{T_r}^T = -a_2 [(\\frac{T^2}{2}-T_r T) - (\\frac{T_r^2}{2}-T_r^2)] = -a_2 [\\frac{T^2}{2}-T_r T + \\frac{T_r^2}{2}] = -\\frac{a_2}{2}(T-T_r)^2$\n4.  含 $a_3$ 的项：$-\\int_{T_r}^{T} a_3(\\frac{1}{T_r} - \\frac{1}{T'}) dT' = -a_3 [\\frac{T'}{T_r} - \\ln T']_{T_r}^T = -a_3 [(\\frac{T}{T_r}-\\ln T) - (\\frac{T_r}{T_r} - \\ln T_r)] = -a_3 [\\frac{T-T_r}{T_r} - \\ln\\left(\\frac{T}{T_r}\\right)] = a_3\\ln\\left(\\frac{T}{T_r}\\right) - a_3\\frac{T-T_r}{T_r}$\n5.  含 $a_4$ 的项：$-\\int_{T_r}^{T} \\frac{a_4}{2}(\\frac{1}{T_r^2} - T'^{-2}) dT' = -\\frac{a_4}{2} [\\frac{T'}{T_r^2} + \\frac{1}{T'}]_{T_r}^T = -\\frac{a_4}{2} [(\\frac{T}{T_r^2}+\\frac{1}{T}) - (\\frac{T_r}{T_r^2}+\\frac{1}{T_r})] = -\\frac{a_4}{2} [\\frac{T-T_r}{T_r^2} + \\frac{1}{T}-\\frac{1}{T_r}] = -\\frac{a_4}{2} [\\frac{T-T_r}{T_r^2} + \\frac{T_r-T}{TT_r}] = -\\frac{a_4}{2}(T-T_r)[\\frac{1}{T_r^2}-\\frac{1}{TT_r}] = -\\frac{a_4}{2}(T-T_r)\\frac{T-T_r}{TT_r^2} = -\\frac{a_4(T-T_r)^2}{2TT_r^2}$\n\n将这些项相加，得到标准态摩尔吉布斯自由能变化的最终表达式：\n$$\\Delta G^\\circ(T,P_r) = -S_r(T-T_r) + a_1\\left((T-T_r) - T\\ln\\left(\\frac{T}{T_r}\\right)\\right) - \\frac{a_2}{2}(T-T_r)^2 + a_3\\left(\\ln\\left(\\frac{T}{T_r}\\right) - \\frac{T-T_r}{T_r}\\right) - \\frac{a_4(T-T_r)^2}{2TT_r^2}$$\n\n### 恒定 $V^\\circ$ 假设的影响\n\n问题询问恒定摩尔体积 $V^\\circ$ 的假设如何影响推导过程。整个推导过程是在固定压力 $P = P_r$ 下进行的。\n$S^\\circ(T,P_r)$ 的推导仅依赖于 $\\frac{C_P^\\circ}{T}$ 对温度的积分。使用的基本关系是 $(\\frac{\\partial S}{\\partial T})_P = \\frac{C_P}{T}$。\n$\\Delta G^\\circ(T,P_r)$ 的推导仅依赖于 $-S^\\circ$ 对温度的积分。使用的基本关系是 $(\\frac{\\partial G}{\\partial T})_P = -S$。\n这两个热力学关系在恒定压力下应用时，都不涉及摩尔体积 $V^\\circ$ 或其导数。摩尔体积仅在计算热力学性质随压力的变化时才变得相关，例如通过 $(\\frac{\\partial G}{\\partial P})_T = V$ 和 $(\\frac{\\partial S}{\\partial P})_T = -(\\frac{\\partial V}{\\partial T})_P$ 等关系。\n由于问题被限制在单一等压线 $P=P_r$ 上，因此提供的关于 $V^\\circ$ 为常数的信息是多余的。它对在固定压力下推导 $S^\\circ$ 和 $G^\\circ$ 的温度依赖性**没有影响**。",
            "answer": "$$\n\\boxed{\n\\begin{align*}\nS^\\circ(T, P_r) = S_r + a_1 \\ln\\left(\\frac{T}{T_r}\\right) + a_2(T-T_r) + a_3\\left(\\frac{1}{T_r} - \\frac{1}{T}\\right) + \\frac{a_4}{2}\\left(\\frac{1}{T_r^2} - \\frac{1}{T^2}\\right) \\\\\n\\Delta G^\\circ(T,P_r) = -S_r(T-T_r) + a_1\\left((T-T_r) - T\\ln\\left(\\frac{T}{T_r}\\right)\\right) - \\frac{a_2}{2}(T-T_r)^2 \\\\\n\\quad + a_3\\left(\\ln\\left(\\frac{T}{T_r}\\right) - \\frac{T-T_r}{T_r}\\right) - \\frac{a_4(T-T_r)^2}{2TT_r^2}\n\\end{align*}\n}\n$$"
        },
        {
            "introduction": "地质过程通常涉及宽广的温度和压力变化范围，因此必须考虑吉布斯自由能对这两个变量的依赖性。本练习在前一个练习的基础上，将压力效应纳入考量，要求您从熵和体积的本构关系出发，推导吉布斯自由能变 $\\Delta G^\\circ(T,P)$ 。此过程将加深您对 $G^\\circ$ 作为状态函数的理解，即其变化仅取决于初末状态，而与T-P空间中的积分路径无关。",
            "id": "4082222",
            "problem": "在计算地球化学中，Helgeson–Kirkham–Flowers (HKF) 状态方程为水溶液中物种的标准态吉布斯自由能如何随温度和压力变化提供了一个严谨的框架。从单组分体系吉布斯自由能的基本热力学恒等式 $dG^{\\circ}=-S^{\\circ}\\,dT+V^{\\circ}\\,dP$ 以及 $G^{\\circ}$ 是一个状态函数这一事实出发，考虑以下一个在窄温压范围内有效、经过简化但科学上合理的模型：在参考压力 $P_{r}$ 下的标准态摩尔熵为 $S^{\\circ}(T,P_{r})=S_{0}+k\\,T$，其中 $S_{0}$ 和 $k$ 是常数；标准态偏摩尔体积与压力和温度无关，为 $V^{\\circ}(T,P)=V_{0}$，其中 $V_{0}$ 是一个常数。假设在此近似下，熵与压力无关，因此 $S^{\\circ}(T,P)=S^{\\circ}(T,P_{r})$。\n\n仅使用热力学恒等式和状态函数性质，通过沿连接 $(T_{r},P_{r})$ 到 $(T,P)$ 的任意可逆路径进行积分，计算标准态吉布斯自由能变 $\\Delta G^{\\circ}(T,P)=G^{\\circ}(T,P)-G^{\\circ}(T_{r},P_{r})$。然后验证在所述假设下，$\\left(\\partial \\Delta G^{\\circ}/\\partial T\\right)_{P}=-S^{\\circ}(T,P)$ 和 $\\left(\\partial \\Delta G^{\\circ}/\\partial P\\right)_{T}=V^{\\circ}(T,P)$ 成立。将最终的 $\\Delta G^{\\circ}(T,P)$ 表示为包含 $S_{0}$、$k$、$V_{0}$、$T$、$P$、$T_{r}$ 和 $P_{r}$ 的闭合形式解析表达式。无需进行数值计算或四舍五入，最终表达式中不应包含单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**第一步：提取已知条件**\n- 标准态吉布斯自由能的基本热力学恒等式为 $dG^{\\circ}=-S^{\\circ}\\,dT+V^{\\circ}\\,dP$。\n- $G^{\\circ}$ 是一个状态函数。\n- 参考压力 $P_{r}$ 下的标准态摩尔熵由模型 $S^{\\circ}(T,P_{r})=S_{0}+k\\,T$ 给出，其中 $S_{0}$ 和 $k$ 是常数。\n- 标准态偏摩尔体积是常数：$V^{\\circ}(T,P)=V_{0}$。\n- 熵被假设为与压力无关：$S^{\\circ}(T,P)=S^{\\circ}(T,P_{r})$，这意味着 $S^{\\circ}(T,P) = S_{0}+k\\,T$。\n- 目标是计算变化量 $\\Delta G^{\\circ}(T,P)=G^{\\circ}(T,P)-G^{\\circ}(T_{r},P_{r})$，并验证结果与关系式 $(\\partial \\Delta G^{\\circ}/\\partial T)_{P}=-S^{\\circ}(T,P)$ 和 $(\\partial \\Delta G^{\\circ}/\\partial P)_{T}=V^{\\circ}(T,P)$ 一致。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。它根植于化学热力学的基本原理。为确保热力学上的自洽性，所提供的熵和体积的本构关系必须满足相关的麦克斯韦关系。对于吉布斯自由能，该关系为：\n$$\n\\left(\\frac{\\partial S^{\\circ}}{\\partial P}\\right)_{T} = -\\left(\\frac{\\partial V^{\\circ}}{\\partial T}\\right)_{P}\n$$\n根据已知条件，我们有 $S^{\\circ}(T,P) = S_{0}+k\\,T$。在恒温下对压力的偏导数为：\n$$\n\\left(\\frac{\\partial S^{\\circ}}{\\partial P}\\right)_{T} = \\frac{\\partial}{\\partial P}(S_{0}+k\\,T) = 0\n$$\n我们还有 $V^{\\circ}(T,P) = V_{0}$。在恒压下对温度的偏导数为：\n$$\n\\left(\\frac{\\partial V^{\\circ}}{\\partial T}\\right)_{P} = \\frac{\\partial}{\\partial T}(V_{0}) = 0\n$$\n将这些结果代入麦克斯韦关系，得到 $0 = -0$，这是一个有效的恒等式。该模型在热力学上是自洽的。该问题没有科学缺陷、歧义或矛盾。已提供所有必要信息以求得唯一解。\n\n**第三步：结论与行动**\n问题被确定为**有效**。将推导解答。\n\n**解答推导**\n标准态吉布斯自由能从初始状态 $(T_{r}, P_{r})$ 到最终状态 $(T, P)$ 的变化量 $\\Delta G^{\\circ}$ 由其全微分 $dG^{\\circ}$ 的积分给出：\n$$\n\\Delta G^{\\circ}(T,P) = G^{\\circ}(T,P) - G^{\\circ}(T_{r},P_{r}) = \\int_{(T_{r},P_{r})}^{(T,P)} dG^{\\circ}\n$$\n将给定的 $S^{\\circ}(T,P)$ 和 $V^{\\circ}(T,P)$ 表达式代入基本恒等式，得到：\n$$\ndG^{\\circ} = -(S_{0}+k\\,T)dT + V_{0}\\,dP\n$$\n由于 $G^{\\circ}$ 是状态函数，$\\Delta G^{\\circ}$ 的积分值与积分路径无关。我们可以选择从 $(T_{r},P_{r})$ 到 $(T,P)$ 的任意方便的可逆路径。一条计算上简单的路径包括两个步骤：\n1.  在参考压力 $P_{r}$ 下的等压步骤，将温度从 $T_{r}$ 变为 $T$。\n2.  在最终温度 $T$ 下的等温步骤，将压力从 $P_{r}$ 变为 $P$。\n\n总变化量 $\\Delta G^{\\circ}$ 是每一步变化的和，即 $\\Delta G^{\\circ} = \\Delta G_{1}^{\\circ} + \\Delta G_{2}^{\\circ}$。\n\n对于步骤1（在 $P_r$ 下从 $T_r$ 等压加热到 $T$）：\n压力恒定，所以 $dP = 0$。吉布斯自由能的变化为：\n$$\n\\Delta G_{1}^{\\circ} = \\int_{T_{r}}^{T} -S^{\\circ}(T',P_{r})\\,dT' = \\int_{T_{r}}^{T} -(S_{0}+k\\,T')\\,dT'\n$$\n执行积分：\n$$\n\\Delta G_{1}^{\\circ} = -\\left[S_{0}T' + \\frac{1}{2}kT'^{2}\\right]_{T_{r}}^{T} = -\\left(S_{0}T + \\frac{1}{2}kT^{2}\\right) - \\left(-\\left(S_{0}T_{r} + \\frac{1}{2}kT_{r}^{2}\\right)\\right)\n$$\n$$\n\\Delta G_{1}^{\\circ} = -S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2})\n$$\n\n对于步骤2（在 $T$ 下从 $P_r$ 等温压缩/膨胀到 $P$）：\n温度恒定，所以 $dT = 0$。吉布斯自由能的变化为：\n$$\n\\Delta G_{2}^{\\circ} = \\int_{P_{r}}^{P} V^{\\circ}(T,P')\\,dP' = \\int_{P_{r}}^{P} V_{0}\\,dP'\n$$\n执行积分：\n$$\n\\Delta G_{2}^{\\circ} = \\left[V_{0}P'\\right]_{P_{r}}^{P} = V_{0}P - V_{0}P_{r} = V_{0}(P-P_{r})\n$$\n\n吉布斯自由能的总变化是这两个步骤变化的总和：\n$$\n\\Delta G^{\\circ}(T,P) = \\Delta G_{1}^{\\circ} + \\Delta G_{2}^{\\circ} = -S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}(P-P_{r})\n$$\n这就是标准态吉布斯自由能变化的闭合形式解析表达式。\n\n**验证**\n现在，我们必须验证该表达式与基本偏导数关系一致。注意到 $\\Delta G^{\\circ}(T,P) = G^{\\circ}(T,P) - G^{\\circ}(T_r, P_r)$，并且由于 $G^{\\circ}(T_r, P_r)$ 是一个常数，$\\Delta G^{\\circ}$ 的偏导数与 $G^{\\circ}$ 的偏导数相同。\n\n首先，我们验证 $\\left(\\partial \\Delta G^{\\circ}/\\partial T\\right)_{P} = -S^{\\circ}(T,P)$：\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial T}\\right)_{P} = \\frac{\\partial}{\\partial T}\\left[-S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}(P-P_{r})\\right]_{P}\n$$\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial T}\\right)_{P} = \\frac{\\partial}{\\partial T}\\left[-S_{0}T + S_{0}T_{r} - \\frac{k}{2}T^{2} + \\frac{k}{2}T_{r}^{2} + V_{0}(P-P_{r})\\right]_{P}\n$$\n由于 $S_{0}$、$k$、$T_{r}$、$P$ 和 $P_{r}$ 相对于微分变量 $T$ 都是常数：\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial T}\\right)_{P} = -S_{0} + 0 - \\frac{k}{2}(2T) + 0 + 0 = -S_{0} - kT = -(S_{0}+kT)\n$$\n根据问题陈述，$S^{\\circ}(T,P) = S_{0}+k\\,T$。因此，我们成功验证了 $\\left(\\partial \\Delta G^{\\circ}/\\partial T\\right)_{P} = -S^{\\circ}(T,P)$。\n\n其次，我们验证 $\\left(\\partial \\Delta G^{\\circ}/\\partial P\\right)_{T} = V^{\\circ}(T,P)$：\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial P}\\right)_{T} = \\frac{\\partial}{\\partial P}\\left[-S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}(P-P_{r})\\right]_{T}\n$$\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial P}\\right)_{T} = \\frac{\\partial}{\\partial P}\\left[-S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}P - V_{0}P_{r}\\right]_{T}\n$$\n由于除了 $V_{0}P$ 之外的所有项相对于微分变量 $P$ 都是常数：\n$$\n\\left(\\frac{\\partial \\Delta G^{\\circ}}{\\partial P}\\right)_{T} = 0 - 0 + V_{0} - 0 = V_{0}\n$$\n根据问题陈述，$V^{\\circ}(T,P) = V_{0}$。因此，我们成功验证了 $\\left(\\partial \\Delta G^{\\circ}/\\partial P\\right)_{T} = V^{\\circ}(T,P)$。\n推导出的 $\\Delta G^{\\circ}(T,P)$ 表达式是正确且自洽的。",
            "answer": "$$\n\\boxed{-S_{0}(T-T_{r}) - \\frac{k}{2}(T^{2}-T_{r}^{2}) + V_{0}(P-P_{r})}\n$$"
        },
        {
            "introduction": "从理论推导转向实际计算，HKF模型的应用离不开对溶剂（通常是水）性质在任意 $(T, P)$ 条件下的精确评估。本练习将指导您完成一项核心的计算任务：使用双三次样条插值技术，根据离散的实验数据点，构建水密度 $\\rho(T,P)$ 和介电常数 $\\epsilon(T,P)$ 的连续函数模型 。这不仅是实现HKF计算的有效方法，也是计算地球化学中处理表格数据的通用技能。",
            "id": "4082164",
            "problem": "您的任务是设计一个高效的数值程序，以评估 Helgeson-Kirkham-Flowers (HKF) 状态方程计算中所需的溶剂依赖函数。目标函数依赖于液态水密度 $\\,\\rho(T,P)\\,$ 和静态介电常数 $\\,\\epsilon(T,P)\\,$，二者均为温度 $\\,T\\,$ 和压力 $\\,P\\,$ 的函数。该程序必须使用表格化的状态方程 (EOS) 值，并采用矩形网格上的三次样条插值来获得在表格化域内任意点的 $\\,\\rho(T,P)\\,$ 和 $\\,\\epsilon(T,P)\\,$ 值。\n\n从以下基本原理出发：\n- 样条插值函数的通用定义，即它是一种分段多项式，可在节点处强制保证函数及其导数的连续性。\n- 静态介电常数 $\\,\\epsilon\\,$ 控制连续介质静电相互作用，而密度 $\\,\\rho\\,$ 则反映了溶剂堆积和可压缩性效应的物理意义。\n- 当表格数据相对于 $\\,T\\,$ 和 $\\,P\\,$ 是单调时，插值必须保持平滑性，并且不引入非物理振荡。\n\n实现以下内容：\n1. 使用提供的液态水表格化数值，在矩形网格上为 $\\,\\rho(T,P)\\,$ 和 $\\,\\epsilon(T,P)\\,$ 构建双三次样条插值函数（张量积三次样条）。\n2. 使用这些插值函数，评估以下三个溶剂函数：\n   - $\\,S_1(T,P) = 1 - \\epsilon(T,P)^{-1}\\,$。\n   - $\\,S_2(T,P) = \\ln\\big(\\rho(T,P)/\\rho_{\\text{ref}}\\big)\\,$，其中 $\\,\\rho_{\\text{ref}} = 1000\\,\\text{kg m}^{-3}\\,$。\n   - $\\,S_3(T,P) = \\epsilon(T,P)^{-1/2}\\,\\rho(T,P)^{-1/3}\\,$。\n   这些函数是无量纲的，分别代表连续介质静电学（Born 型依赖关系）、可压缩性标度以及组合屏蔽-密度标度。\n\n使用以下液态水性质的矩形网格。温度 $\\,T\\,$ 的单位是 $\\,\\text{K}\\,$，压力 $\\,P\\,$ 的单位是 $\\,\\text{MPa}\\,$。密度的单位是 $\\,\\text{kg m}^{-3}\\,$，介电常数是无量纲的。网格点为：\n$$\n\\boldsymbol{T} = [\\,298.15,\\;373.15,\\;473.15,\\;573.15,\\;673.15\\,]\\,\\text{K},\\qquad\n\\boldsymbol{P} = [\\,10.0,\\;25.0,\\;40.0,\\;50.0\\,]\\,\\text{MPa}.\n$$\n在这些点上，表格化的液态水性质为：\n$$\n\\rho(T_i,P_j)\\;[\\text{kg m}^{-3}] =\n\\begin{bmatrix}\n1008  1012  1016  1020 \\\\\n971  988  1000  1008 \\\\\n900  930  950  970 \\\\\n780  820  850  870 \\\\\n600  650  690  720\n\\end{bmatrix},\n\\quad\n\\epsilon(T_i,P_j) =\n\\begin{bmatrix}\n80.0  81.0  82.0  82.5 \\\\\n57.0  59.0  60.5  61.5 \\\\\n38.0  42.0  44.5  47.0 \\\\\n24.0  28.0  31.0  33.0 \\\\\n12.0  15.0  18.0  20.0\n\\end{bmatrix}.\n$$\n\n您的程序必须：\n- 为 $\\,\\rho(T,P)\\,$ 和 $\\,\\epsilon(T,P)\\,$ 在由 $\\,\\boldsymbol{T}\\,$ 和 $\\,\\boldsymbol{P}\\,$ 定义的矩形网格上构建双三次样条插值函数。\n- 在以下五个测试案例中评估 $\\,S_1(T,P)\\,$、$\\,S_2(T,P)\\,$ 和 $\\,S_3(T,P)\\,$，所有案例均位于表格化域内：\n  1. $(\\,T,P\\,) = (\\,350.0\\,\\text{K},\\,20.0\\,\\text{MPa}\\,)$,\n  2. $(\\,T,P\\,) = (\\,298.15\\,\\text{K},\\,25.0\\,\\text{MPa}\\,)$,\n  3. $(\\,T,P\\,) = (\\,673.15\\,\\text{K},\\,50.0\\,\\text{MPa}\\,)$,\n  4. $(\\,T,P\\,) = (\\,573.15\\,\\text{K},\\,10.0\\,\\text{MPa}\\,)$,\n  5. $(\\,T,P\\,) = (\\,430.0\\,\\text{K},\\,30.0\\,\\text{MPa}\\,)$.\n\n答案要求：\n- 所有输出均表示为四舍五入到六位小数的浮点数。\n- 最终输出必须是单行文本，包含一个用方括号括起来的逗号分隔列表，顺序如下\n$$\n[\\,S_1^{(1)},\\,S_2^{(1)},\\,S_3^{(1)},\\,S_1^{(2)},\\,S_2^{(2)},\\,S_3^{(3)},\\,S_1^{(3)},\\,S_2^{(3)},\\,S_3^{(3)},\\,S_1^{(4)},\\,S_2^{(4)},\\,S_3^{(4)},\\,S_1^{(5)},\\,S_2^{(5)},\\,S_3^{(5)}\\,],\n$$\n其中上标表示测试案例的索引。\n\n设计约束和说明：\n- 使用与 $\\,T\\,$ 和 $\\,P\\,$ 两个维度上的张量积三次 B 样条一致的双三次样条插值，确保每个维度至少有 $\\,4\\,$ 个节点以支持三次样条。\n- 仅在表格化网格的凸包内进行插值；所提供的测试案例均为内部点和边界点，从而避免外插。\n- 科学真实性：表格化的值遵循压缩液态水的物理上合理的趋势，即 $\\,\\rho\\,$ 随 $\\,P\\,$ 增加而增加，随 $\\,T\\,$ 增加而减少；而 $\\,\\epsilon\\,$ 通常随 $\\,T\\,$ 增加而减少，随 $\\,P\\,$ 增加而轻微增加。",
            "solution": "该问题是有效的。其科学基础在于计算地球化学的原理，特别是与 Helgeson-Kirkham-Flowers (HKF) 状态方程相关。该问题是适定的，提供了所有必要的数据——温度和压力网格、相应的密度和介电常数矩阵，以及目标函数的精确定义。双三次样条插值是一个标准的、定义明确的程序，存在唯一且稳定的解。所有测试点都位于所提供数据网格的边界内，确保了是内插而非外插。问题陈述客观且无歧义。\n\n解决此问题需要为液态水的密度 $\\rho(T,P)$ 和静态介电常数 $\\epsilon(T,P)$ 创建一个数值模型，将它们作为温度 $T$ 和压力 $P$ 的连续函数。我们在一个矩形网格上获得了这些属性的离散值。双三次样条插值是构建这些连续函数近似的指定方法。\n\n在由节点 $(T_i, P_j)$ 定义的矩形网格上的双三次样条插值函数是一个分段函数。在每个矩形单元 $[T_i, T_{i+1}] \\times [P_j, P_{j+1}]$ 中，该函数是一个双三次多项式，形式如下：\n$$ S(T,P) = \\sum_{k=0}^{3} \\sum_{l=0}^{3} c_{kl}^{(ij)} (T - T_i)^k (P - P_j)^l $$\n每个单元的系数 $c_{kl}^{(ij)}$ 是通过确保插值函数在节点处与给定的数据值相匹配（即 $S(T_i, P_j) = Z_{ij}$），并且函数及其一阶和二阶偏导数在单元边界上连续来确定的。该方法也称为张量积样条，它能确保生成一个光滑的曲面，精确地表示底层数据，而不会引入非物理振荡。\n\n计算过程如下：\n1.  定义网格轴：温度向量 $\\boldsymbol{T}$ 和压力向量 $\\boldsymbol{P}$。\n    $$ \\boldsymbol{T} = [298.15, 373.15, 473.15, 573.15, 673.15]\\,\\text{K} $$\n    $$ \\boldsymbol{P} = [10.0, 25.0, 40.0, 50.0]\\,\\text{MPa} $$\n2.  定义相应的密度数据矩阵 $\\boldsymbol{\\rho}$ 和介电常数数据矩阵 $\\boldsymbol{\\epsilon}$。\n3.  使用数值库构建两个独立的双三次样条插值对象。一个插值函数 $\\rho_{\\text{spline}}(T,P)$ 将用于模拟密度，另一个插值函数 $\\epsilon_{\\text{spline}}(T,P)$ 将用于模拟介电常数。这些对象是根据网格向量及其各自的数据矩阵创建的。`scipy.interpolate.RectBivariateSpline` 函数非常适合此任务，因为它实现了该算法的一个稳健版本。\n4.  对于五个指定的测试点 $(T_k, P_k)$ 中的每一个，评估插值函数以获得值 $\\rho_k = \\rho_{\\text{spline}}(T_k, P_k)$ 和 $\\epsilon_k = \\epsilon_{\\text{spline}}(T_k, P_k)$。\n5.  使用这些插值得到的值，计算所需的三个无量纲溶剂函数：\n    -   Born 函数代理： $S_1^{(k)} = 1 - \\epsilon_k^{-1}$\n    -   可压缩性标度函数： $S_2^{(k)} = \\ln(\\rho_k/\\rho_{\\text{ref}})$，其中 $\\rho_{\\text{ref}} = 1000\\,\\text{kg m}^{-3}$\n    -   组合标度函数： $S_3^{(k)} = \\epsilon_k^{-1/2} \\rho_k^{-1/3}$\n6.  收集并格式化每个测试案例的结果 $(S_1^{(k)}, S_2^{(k)}, S_3^{(k)})$。对于测试点恰好位于网格节点上的情况，样条插值会正确返回原始的表格值。\n\n该过程能够在定义的温度和压力范围内，对溶剂性质及派生函数进行精确估计，这是将 HKF 状态方程应用于地球化学建模的基本要求。",
            "answer": "[0.984852,0.003943,0.012353,0.987654,0.011929,0.011030,0.950000,-0.328504,0.033668,0.958333,-0.248461,0.021877,0.977464,-0.065268,0.016335]"
        }
    ]
}