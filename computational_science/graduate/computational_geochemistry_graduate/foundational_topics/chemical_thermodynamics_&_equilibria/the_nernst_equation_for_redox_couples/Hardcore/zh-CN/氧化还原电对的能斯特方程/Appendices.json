{
    "hands_on_practices": [
        {
            "introduction": "在地球化学计算中，区分活度与浓度是准确应用热力学模型的第一步。本练习将引导你运用能斯特方程和戴维斯方程，亲手计算在非理想溶液中活度修正对氧化还原电位的影响，从而量化理想溶液假设所带来的误差。通过这个实践，你将深刻理解为何在真实的地球化学体系（如盐化地下水）中，活度是不可或缺的概念。",
            "id": "4104426",
            "problem": "温度为 $T=298.15\\,\\mathrm{K}$ 的含盐地下水被氯化钠缓冲至离子强度 $I=0.1\\,\\mathrm{mol\\,kg^{-1}}$，使得溶解的铁以痕量水平存在，且不会显著扰动 $I$。氧化还原电对为 $\\mathrm{Fe^{3+}/Fe^{2+}}$，由半反应 $\\mathrm{Fe^{3+}} + \\mathrm{e^{-}} \\rightleftharpoons \\mathrm{Fe^{2+}}$ 描述，其标准还原电位相对于标准氢电极 (SHE) 为 $E^{\\circ} = 0.771\\,\\mathrm{V}$。铁物种的质量摩尔浓度分别为 $m_{\\mathrm{Fe^{3+}}} = 1.0\\times 10^{-4}\\,\\mathrm{mol\\,kg^{-1}}$ 和 $m_{\\mathrm{Fe^{2+}}} = 1.0\\times 10^{-6}\\,\\mathrm{mol\\,kg^{-1}}$。气体常数和法拉第常数分别为 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和 $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$。\n\n从电解质溶液中溶质化学势的定义以及将吉布斯能量变化与单电子转移电功联系起来的平衡条件出发，推导以氧化还原电对的活度 $a_{\\mathrm{Fe^{2+}}}$ 和 $a_{\\mathrm{Fe^{3+}}}$ 表示的半电池电位表达式。在质量摩尔浓度标度上处理活度，标准态为 $m^{\\circ} = 1\\,\\mathrm{mol\\,kg^{-1}}$，因此 $a_{i} = \\gamma_{i}\\,m_{i}$，其中 $\\gamma_{i}$ 是单离子活度系数，$m_{i}$ 是质量摩尔浓度。在 $T=298.15\\,\\mathrm{K}$ 时，使用 Davies 方程估算 $\\gamma_{\\mathrm{Fe^{2+}}}$ 和 $\\gamma_{\\mathrm{Fe^{3+}}}$，\n$$\n\\log_{10}\\gamma_{i} \\;=\\; -A\\,z_{i}^{2}\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right),\n$$\n其中 $A=0.509$，$z_{\\mathrm{Fe^{2+}}}=+2$，$z_{\\mathrm{Fe^{3+}}}=+3$。通过设置 $\\gamma_{i}=1$，分别使用 (i) 活度和 (ii) 浓度计算半电池电位，然后报告因假设 $\\gamma_{i}=1$ 而引入的误差 $\\Delta E = E_{\\text{conc}} - E_{\\text{act}}$。以 $\\mathrm{V}$ 为单位表示 $\\Delta E$，并将您的答案四舍五入到 $4$ 位有效数字。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、内容完整且适定的。所有必需的数据、定义和常数均已提供，不存在内部矛盾或违反基本原理的情况。我们可以进行正式求解。\n\n该问题的核心在于描述电化学电池电位的能斯特方程。我们首先被要求从基本热力学原理出发，为给定的半反应推导该方程。\n\n三价铁离子（$\\mathrm{Fe^{3+}}$）还原为二价铁离子（$\\mathrm{Fe^{2+}}$）的半反应为：\n$$\n\\mathrm{Fe^{3+}} + \\mathrm{e^{-}} \\rightleftharpoons \\mathrm{Fe^{2+}}\n$$\n溶液中溶质物种 $i$ 的化学势 $\\mu_i$ 定义为：\n$$\n\\mu_i = \\mu_i^{\\circ} + RT \\ln a_i\n$$\n其中 $\\mu_i^{\\circ}$ 是标准化学势，$R$ 是通用气体常数，$T$ 是绝对温度，$a_i$ 是物种的活度。活度通过 $a_i = \\gamma_i (m_i/m^{\\circ})$ 与质量摩尔浓度 $m_i$ 和单离子活度系数 $\\gamma_i$ 相关，其中 $m^{\\circ}$ 是标准态质量摩尔浓度（$1\\,\\mathrm{mol\\,kg^{-1}}$）。为简化符号，我们将质量摩尔浓度视为无量纲比值 $m_i/m^{\\circ}$。\n\n半反应化学部分（不包括电子）的吉布斯自由能变化 $\\Delta_r G$ 是产物和反应物化学势之差：\n$$\n\\Delta_r G = \\mu_{\\mathrm{Fe^{2+}}} - \\mu_{\\mathrm{Fe^{3+}}}\n$$\n代入各物种的化学势定义：\n$$\n\\Delta_r G = (\\mu_{\\mathrm{Fe^{2+}}}^{\\circ} + RT \\ln a_{\\mathrm{Fe^{2+}}}) - (\\mu_{\\mathrm{Fe^{3+}}}^{\\circ} + RT \\ln a_{\\mathrm{Fe^{3+}}})\n$$\n$$\n\\Delta_r G = (\\mu_{\\mathrm{Fe^{2+}}}^{\\circ} - \\mu_{\\mathrm{Fe^{3+}}}^{\\circ}) + RT \\ln \\left( \\frac{a_{\\mathrm{Fe^{2+}}}}{a_{\\mathrm{Fe^{3+}}}} \\right)\n$$\n项 $(\\mu_{\\mathrm{Fe^{2+}}}^{\\circ} - \\mu_{\\mathrm{Fe^{3+}}}^{\\circ})$ 是反应的标准吉布斯自由能变化，记为 $\\Delta_r G^{\\circ}$。\n$$\n\\Delta_r G = \\Delta_r G^{\\circ} + RT \\ln \\left( \\frac{a_{\\mathrm{Fe^{2+}}}}{a_{\\mathrm{Fe^{3+}}}} \\right)\n$$\n电化学反应的吉布斯自由能变化与电势 $E$ 通过方程 $\\Delta_r G = -nFE$ 相关联，其中 $n$ 是转移的电子数（在此情况下 $n=1$），$F$ 是法拉第常数。类似地，对于标准态条件，$\\Delta_r G^{\\circ} = -nFE^{\\circ} = -FE^{\\circ}$。\n\n将这些关系代入吉布斯能量表达式：\n$$\n-FE = -FE^{\\circ} + RT \\ln \\left( \\frac{a_{\\mathrm{Fe^{2+}}}}{a_{\\mathrm{Fe^{3+}}}} \\right)\n$$\n两边同除以 $-F$ 得到半电池电位的能斯特方程：\n$$\nE = E^{\\circ} - \\frac{RT}{F} \\ln \\left( \\frac{a_{\\mathrm{Fe^{2+}}}}{a_{\\mathrm{Fe^{3+}}}} \\right)\n$$\n问题要求计算因忽略活度系数（即假设所有物种的 $\\gamma_i = 1$）而引入的误差 $\\Delta E$。设 $E_{\\text{act}}$ 是使用活度计算的电位，$E_{\\text{conc}}$ 是使用质量摩尔浓度（浓度）计算的电位，其中 $a_i$ 被替换为 $m_i$。\n\n使用活度计算的电位是：\n$$\nE_{\\text{act}} = E^{\\circ} - \\frac{RT}{F} \\ln \\left( \\frac{a_{\\mathrm{Fe^{2+}}}}{a_{\\mathrm{Fe^{3+}}}} \\right) = E^{\\circ} - \\frac{RT}{F} \\ln \\left( \\frac{\\gamma_{\\mathrm{Fe^{2+}}} m_{\\mathrm{Fe^{2+}}}}{\\gamma_{\\mathrm{Fe^{3+}}} m_{\\mathrm{Fe^{3+}}}} \\right)\n$$\n使用浓度（质量摩尔浓度）计算的电位等效于设置 $\\gamma_{\\mathrm{Fe^{2+}}}=\\gamma_{\\mathrm{Fe^{3+}}}=1$：\n$$\nE_{\\text{conc}} = E^{\\circ} - \\frac{RT}{F} \\ln \\left( \\frac{m_{\\mathrm{Fe^{2+}}}}{m_{\\mathrm{Fe^{3+}}}} \\right)\n$$\n误差定义为 $\\Delta E = E_{\\text{conc}} - E_{\\text{act}}$：\n$$\n\\Delta E = \\left[ E^{\\circ} - \\frac{RT}{F} \\ln \\left( \\frac{m_{\\mathrm{Fe^{2+}}}}{m_{\\mathrm{Fe^{3+}}}} \\right) \\right] - \\left[ E^{\\circ} - \\frac{RT}{F} \\ln \\left( \\frac{\\gamma_{\\mathrm{Fe^{2+}}} m_{\\mathrm{Fe^{2+}}}}{\\gamma_{\\mathrm{Fe^{3+}}} m_{\\mathrm{Fe^{3+}}}} \\right) \\right]\n$$\n$$\n\\Delta E = \\frac{RT}{F} \\left[ \\ln \\left( \\frac{\\gamma_{\\mathrm{Fe^{2+}}} m_{\\mathrm{Fe^{2+}}}}{\\gamma_{\\mathrm{Fe^{3+}}} m_{\\mathrm{Fe^{3+}}}} \\right) - \\ln \\left( \\frac{m_{\\mathrm{Fe^{2+}}}}{m_{\\mathrm{Fe^{3+}}}} \\right) \\right]\n$$\n使用对数性质 $\\ln(x) - \\ln(y) = \\ln(x/y)$，我们简化表达式：\n$$\n\\Delta E = \\frac{RT}{F} \\ln \\left( \\frac{\\gamma_{\\mathrm{Fe^{2+}}}}{\\gamma_{\\mathrm{Fe^{3+}}}} \\right)\n$$\n为了计算该值，我们必须首先使用 Davies 方程计算活度系数：\n$$\n\\log_{10}\\gamma_{i} = -A\\,z_{i}^{2}\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right)\n$$\n给定数值 $T=298.15\\,\\mathrm{K}$，$I=0.1\\,\\mathrm{mol\\,kg^{-1}}$，$A=0.509$，$z_{\\mathrm{Fe^{2+}}}=+2$ 以及 $z_{\\mathrm{Fe^{3+}}}=+3$。我们来分析 $\\ln(\\gamma_{\\mathrm{Fe^{2+}}}/\\gamma_{\\mathrm{Fe^{3+}}})$ 这一项。\n使用性质 $\\ln(x) = \\ln(10) \\log_{10}(x)$：\n$$\n\\ln \\left( \\frac{\\gamma_{\\mathrm{Fe^{2+}}}}{\\gamma_{\\mathrm{Fe^{3+}}}} \\right) = \\ln(10) \\left( \\log_{10}\\gamma_{\\mathrm{Fe^{2+}}} - \\log_{10}\\gamma_{\\mathrm{Fe^{3+}}} \\right)\n$$\n将 Davies 方程代入每一项：\n$$\n\\log_{10}\\gamma_{\\mathrm{Fe^{2+}}} - \\log_{10}\\gamma_{\\mathrm{Fe^{3+}}} = \\left[ -A\\,z_{\\mathrm{Fe^{2+}}}^{2}\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right) \\right] - \\left[ -A\\,z_{\\mathrm{Fe^{3+}}}^{2}\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right) \\right]\n$$\n提取公因式：\n$$\n\\log_{10}\\gamma_{\\mathrm{Fe^{2+}}} - \\log_{10}\\gamma_{\\mathrm{Fe^{3+}}} = A \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I \\right) \\left( z_{\\mathrm{Fe^{3+}}}^{2} - z_{\\mathrm{Fe^{2+}}}^{2} \\right)\n$$\n现在，我们可以将其代回 $\\Delta E$ 的表达式中：\n$$\n\\Delta E = \\frac{RT \\ln(10)}{F} \\left[ A \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I \\right) \\left( z_{\\mathrm{Fe^{3+}}}^{2} - z_{\\mathrm{Fe^{2+}}}^{2} \\right) \\right]\n$$\n我们现在代入给定的数值：\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 298.15\\,\\mathrm{K}$\n$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$\n$A = 0.509$\n$I = 0.1$\n$z_{\\mathrm{Fe^{2+}}} = 2$\n$z_{\\mathrm{Fe^{3+}}} = 3$\n\n首先，计算各个组成项：\n来自 Davies 方程的项：\n$$\n\\frac{\\sqrt{0.1}}{1+\\sqrt{0.1}} - 0.3(0.1) \\approx \\frac{0.316227766}{1.316227766} - 0.03 \\approx 0.24025307 - 0.03 = 0.21025307\n$$\n电荷平方差：\n$$\nz_{\\mathrm{Fe^{3+}}}^{2} - z_{\\mathrm{Fe^{2+}}}^{2} = 3^2 - 2^2 = 9 - 4 = 5\n$$\n以伏特为单位的对数前因子：\n$$\n\\frac{RT \\ln(10)}{F} = \\frac{(8.314462618)(298.15)\\ln(10)}{96485.33212} \\approx 0.0591598\\,\\mathrm{V}\n$$\n现在，将这些组合起来计算 $\\Delta E$：\n$$\n\\Delta E \\approx (0.0591598\\,\\mathrm{V}) \\left[ 0.509 \\times (0.21025307) \\times 5 \\right]\n$$\n$$\n\\Delta E \\approx (0.0591598\\,\\mathrm{V}) \\left[ 0.5350927 \\right]\n$$\n$$\n\\Delta E \\approx 0.0316551\\,\\mathrm{V}\n$$\n将结果四舍五入到 $4$ 位有效数字，我们得到 $0.03166\\,\\mathrm{V}$。",
            "answer": "$$\n\\boxed{0.03166}\n$$"
        },
        {
            "introduction": "一个精确的模型不仅能预测系统的状态，更能揭示其内在的控制机制。本练习将带你从基本热力学原理出发，推导并进行灵敏度分析，以确定哪种化学物质的活度变化对氧化还原电位$E$的影响最大。这项实践旨在训练你识别地球化学系统中关键影响因素的能力，这是从单纯的计算者成长为模型分析者的重要一步。",
            "id": "4104414",
            "problem": "在一个温度为 $T = 318.15$ K 的酸化地下水系统中，考虑以水溶液活度表示的针铁矿还原半反应，其中反应商不包括纯固体和纯液体：\n$$\n\\mathrm{FeO(OH)}(s) + 3\\,\\mathrm{H}^{+} + e^{-} \\rightarrow \\mathrm{Fe}^{2+} + 2\\,\\mathrm{H}_{2}\\mathrm{O}.\n$$\n假设所有水溶液物种都具有明确的活度 $a_{i}$，并仅使用半反应中出现的水溶液物种的活度来定义反应商 $Q$。设 $n$ 为半反应中转移的电子数。使用以下基本热力学基础：\n- 反应吉布斯能与电极电势之间的电化学关系：$\\Delta_{r} G = -n F E$，其中 $F$ 是法拉第常数。\n- 化学势对活度的依赖关系：$\\mu_{i} = \\mu_{i}^{\\circ} + R T \\ln a_{i}$。\n- 以化学计量系数 $\\nu_{i}$ 和化学势表示的反应吉布斯能表达式：$\\Delta_{r} G = \\sum_{i} \\nu_{i} \\mu_{i}$，约定产物的 $\\nu_{i}  0$，反应物的 $\\nu_{i}  0$。\n\n严格从这些基础出发，推导电极电势 $E$ 相对于 $Q$ 中出现的每个水溶液物种 $i$ 的 $\\ln a_{i}$ 的灵敏度表达式。对于给定的半反应，取 $n = 1$，计算 $\\mathrm{Fe}^{2+}$ 和 $\\mathrm{H}^{+}$ 的这些灵敏度，并确定哪种物种的活度对 $E$ 的影响最大。最后，使用 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和 $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$，计算在 $T = 318.15$ K 时最大灵敏度的数值（以伏特为单位）。将你的答案四舍五入到四位有效数字。最终结果以伏特表示。",
            "solution": "目标是从基本热力学恒等式出发，获得电极电势 $E$ 相对于反应商 $Q$ 中每个水溶液物种的 $\\ln a_i$ 的灵敏度 $\\partial E / \\partial \\ln a_{i}$。\n\n我们从物种 $i$ 的化学势开始，\n$$\n\\mu_{i} = \\mu_{i}^{\\circ} + R T \\ln a_{i},\n$$\n以及用化学计量系数 $\\nu_i$ 表示的反应吉布斯能，\n$$\n\\Delta_{r} G = \\sum_{i} \\nu_{i} \\mu_{i}.\n$$\n将 $\\mu_{i}$ 的表达式代入反应吉布斯能，得到\n$$\n\\Delta_{r} G = \\sum_{i} \\nu_{i}\\left(\\mu_{i}^{\\circ} + R T \\ln a_{i}\\right)\n= \\sum_{i} \\nu_{i}\\mu_{i}^{\\circ} + R T \\sum_{i} \\nu_{i} \\ln a_{i}.\n$$\n将标准反应吉布斯能定义为\n$$\n\\Delta_{r} G^{\\circ} = \\sum_{i} \\nu_{i} \\mu_{i}^{\\circ},\n$$\n并注意到\n$$\n\\sum_{i} \\nu_{i} \\ln a_{i} = \\ln \\left(\\prod_{i} a_{i}^{\\nu_{i}}\\right) = \\ln Q,\n$$\n其中 $Q$ 是仅由水溶液物种构成的反应商（不包括纯固体和纯液体，其活度按惯例取为1）。因此，\n$$\n\\Delta_{r} G = \\Delta_{r} G^{\\circ} + R T \\ln Q.\n$$\n电化学热力学通过以下关系将反应吉布斯能与电极电势联系起来\n$$\n\\Delta_{r} G = - n F E, \\qquad \\Delta_{r} G^{\\circ} = - n F E^{\\circ},\n$$\n其中 $n$ 是转移的电子数，$F$ 是法拉第常数。将这些代入前面的表达式，得到\n$$\n- n F E = - n F E^{\\circ} + R T \\ln Q,\n$$\n整理后得到\n$$\nE = E^{\\circ} - \\frac{R T}{n F} \\ln Q.\n$$\n为了获得灵敏度，将 $E$ 对 $\\ln a_{i}$ 求导：\n$$\n\\frac{\\partial E}{\\partial \\ln a_{i}} = - \\frac{R T}{n F} \\frac{\\partial}{\\partial \\ln a_{i}}\\left(\\ln Q\\right).\n$$\n因为 $Q = \\prod_{j} a_{j}^{\\nu_{j}}$，我们有 $\\ln Q = \\sum_{j} \\nu_{j} \\ln a_{j}$，因此\n$$\n\\frac{\\partial}{\\partial \\ln a_{i}}\\left(\\ln Q\\right) = \\nu_{i}.\n$$\n因此，灵敏度为\n$$\n\\frac{\\partial E}{\\partial \\ln a_{i}} = - \\frac{R T}{n F} \\,\\nu_{i}.\n$$\n\n我们现在对给定的半反应进行评估，\n$$\n\\mathrm{FeO(OH)}(s) + 3\\,\\mathrm{H}^{+} + e^{-} \\rightarrow \\mathrm{Fe}^{2+} + 2\\,\\mathrm{H}_{2}\\mathrm{O}.\n$$\n进入 $Q$ 的水溶液物种是 $\\mathrm{Fe}^{2+}$ 和 $\\mathrm{H}^{+}$，因为根据惯例，纯固体 $\\mathrm{FeO(OH)}(s)$ 和纯液体 $\\mathrm{H}_{2}\\mathrm{O}$ 的活度为1。根据产物的 $\\nu_{i}  0$ 和反应物的 $\\nu_{i}  0$ 的约定，化学计量指数为：\n- 对于 $\\mathrm{Fe}^{2+}$ (产物): $\\nu_{\\mathrm{Fe}^{2+}} = +1$。\n- 对于 $\\mathrm{H}^{+}$ (反应物): $\\nu_{\\mathrm{H}^{+}} = -3$。\n\n当 $n = 1$ 时，灵敏度为\n$$\n\\frac{\\partial E}{\\partial \\ln a_{\\mathrm{Fe}^{2+}}} = - \\frac{R T}{n F} \\,\\nu_{\\mathrm{Fe}^{2+}} = - \\frac{R T}{F}\\cdot (1) = - \\frac{R T}{F},\n$$\n$$\n\\frac{\\partial E}{\\partial \\ln a_{\\mathrm{H}^{+}}} = - \\frac{R T}{n F} \\,\\nu_{\\mathrm{H}^{+}} = - \\frac{R T}{F}\\cdot (-3) = + \\frac{3 R T}{F}.\n$$\n其大小为\n$$\n\\left|\\frac{\\partial E}{\\partial \\ln a_{\\mathrm{Fe}^{2+}}}\\right| = \\frac{R T}{F}, \\qquad\n\\left|\\frac{\\partial E}{\\partial \\ln a_{\\mathrm{H}^{+}}}\\right| = \\frac{3 R T}{F}.\n$$\n因此，$\\mathrm{H}^{+}$ 的活度对 $E$ 的影响最大，其影响的量级是 $\\mathrm{Fe}^{2+}$ 的三倍。\n\n我们现在数值计算在 $T = 318.15$ K 时最大量级的灵敏度。首先计算 $R T$：\n$$\nR T = \\left(8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\right)\\left(318.15\\,\\mathrm{K}\\right) = 2645.2462819167\\,\\mathrm{J\\,mol^{-1}}.\n$$\n除以 $F$：\n$$\n\\frac{R T}{F} = \\frac{2645.2462819167\\,\\mathrm{J\\,mol^{-1}}}{96485.33212\\,\\mathrm{C\\,mol^{-1}}}\n= 0.0274157\\,\\mathrm{V}.\n$$\n乘以 $3$ 得到最大量级：\n$$\n\\left|\\frac{\\partial E}{\\partial \\ln a_{\\mathrm{H}^{+}}}\\right| = \\frac{3 R T}{F} = 3 \\times 0.0274157\\,\\mathrm{V} = 0.0822471\\,\\mathrm{V}.\n$$\n四舍五入到四位有效数字，得到 $0.08225\\,\\mathrm{V}$。因此，最大量级的灵敏度是 $0.08225$ 伏特每单位 $\\ln a_{\\mathrm{H}^{+}}$ 变化，并且它与 $\\mathrm{H}^{+}$ 相关。",
            "answer": "$$\\boxed{0.08225}$$"
        },
        {
            "introduction": "将理论付诸实践是计算科学的核心。这个练习要求你将前面所学的能斯特方程和活度校正模型转化为稳健的计算机代码，并特别关注在处理极低浓度时可能出现的数值稳定性问题。通过完成一系列精心设计的测试案例，你将掌握把复杂的地球化学理论构建为可靠计算工具的关键技能，为解决更广泛的科学问题奠定基础。",
            "id": "4104393",
            "problem": "你的任务是在计算地球化学的背景下，推导、实现并评估氧化还原半反应的电极电势。该实现必须基于第一性原理和经过充分检验的公式，不得使用任何预先给出的电极电势目标表达式。你必须从以下基本关系式中推导出电势所需的表达式。\n\n从以下事实出发：\n1. 反应的吉布斯自由能变化与反应商的关系为 $$\\Delta G = \\Delta G^\\circ + RT \\ln Q,$$ 其中 $R$ 是通用气体常数，$T$ 是绝对温度（单位：K），$Q$ 是热力学反应商。\n2. 每摩尔电子的电化学功将吉布斯自由能变化与电极电势关联起来，关系式为 $$\\Delta G = -n F E,$$ 其中 $n$ 是转移的电子数，$F$ 是法拉第常数。\n\n对于形式为 $$\\mathrm{Ox} + n e^- \\rightleftharpoons \\mathrm{Red},$$ 的氧化还原半反应，使用活度定义反应商 $Q$。如果产物 $i$ 的化学计量系数为 $\\nu_i$，反应物 $j$ 的化学计量系数为 $\\nu_j$，则半反应商为\n$$Q = \\frac{\\prod_{\\text{products } i} a_i^{\\nu_i}}{\\prod_{\\text{reactants } j} a_j^{\\nu_j}},$$\n其中电子不包含在 $Q$ 中。活度通过 $$a_i = \\gamma_i c_i,$$ 来建模，其中 $c_i$ 是基于 $1\\ \\mathrm{mol}/\\mathrm{kg}$ 标准态的分析浓度（因此 $c_i$ 和 $a_i$ 是无量纲的），$\\gamma_i$ 是通过 Davies 方程计算的活度系数，该方程是 Debye–Hückel 理论的一个广泛使用的扩展：\n$$\\log_{10} \\gamma_i = - A z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right),$$\n其中 $z_i$ 是物种 $i$ 的电荷，$I$ 是离子强度（在质量摩尔浓度标度上是无量纲的），$A$ 是一个与溶剂相关的常数。对于接近 $25^\\circ\\mathrm{C}$ 的水，取 $A = 0.509$，并在以下所有测试用例中使用此值。通用气体常数为 $R = 8.31446261815324\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$，法拉第常数为 $F = 96485.33212\\ \\mathrm{C}\\ \\mathrm{mol}^{-1}$。\n\n算法要求：\n- 你的程序必须严格通过组合上述两个基本关系式，并使用此处定义的基于活度的 $Q$ 来计算电极电势 $E$。\n- 在内部，使用以 10 为底的对数来计算反应商的对数，以确保数值的稳健性。也就是说，通过对带有相应化学计量符号的 $\\log_{10} a_i$ 求和来计算 $\\log_{10} Q$，而不是将 $Q$ 构建成一个可能发生下溢或上溢的乘积。通过 $$\\ln Q = (\\ln 10)\\, \\log_{10} Q,$$ 转换为自然对数，并且不要使用取整的常数；在代码中应使用标准数值函数提供的 $\\ln 10$ 的精确值。\n- 最终的电极电势以伏特为单位表示，并四舍五入到六位小数。\n\n测试套件：\n实现你的程序来评估以下五个测试用例，每个用例由 $(T, n, E^\\circ, I, \\text{species})$ 指定，其中 $T$ 是温度（单位：K），$n$ 是电子数，$E^\\circ$ 是标准电势（单位：V），$I$ 是离子强度，物种以元组 $(\\text{name}, z, c, \\nu, \\text{role})$ 的形式列出，其中 $z$ 是电荷，$c$ 是浓度（无量纲，相对于 $1\\ \\mathrm{mol}/\\mathrm{kg}$），$\\nu$ 是化学计量系数，role 是“product”或“reactant”。\n\n- 案例 1（理想情况，铁电对的反应商接近单位值）：\n  - $T = 298.15$, $n = 1$, $E^\\circ = 0.771$, $I = 0.1$。\n  - 物种：$(\\mathrm{Fe^{2+}}, 2, 10^{-3}, 1, \\text{product})$, $(\\mathrm{Fe^{3+}}, 3, 10^{-3}, 1, \\text{reactant})$。\n\n- 案例 2（边界条件，$Q = 1$ 且离子强度为零）：\n  - $T = 298.15$, $n = 1$, $E^\\circ = 0.153$, $I = 0.0$。\n  - 物种：$(\\mathrm{Cu^{+}}, 1, 2\\times 10^{-4}, 1, \\text{product})$, $(\\mathrm{Cu^{2+}}, 2, 2\\times 10^{-4}, 1, \\text{reactant})$。\n\n- 案例 3（多电子锡电对，中度非平衡）：\n  - $T = 298.15$, $n = 2$, $E^\\circ = 0.151$, $I = 0.05$。\n  - 物种：$(\\mathrm{Sn^{2+}}, 2, 10^{-2}, 1, \\text{product})$, $(\\mathrm{Sn^{4+}}, 4, 10^{-6}, 1, \\text{reactant})$。\n\n- 案例 4（高离子强度下的铁电对）：\n  - $T = 298.15$, $n = 1$, $E^\\circ = 0.771$, $I = 0.5$。\n  - 物种：$(\\mathrm{Fe^{2+}}, 2, 10^{-7}, 1, \\text{product})$, $(\\mathrm{Fe^{3+}}, 3, 10^{-2}, 1, \\text{reactant})$。\n\n- 案例 5（温度对铁电对能斯特斜率的影响）：\n  - $T = 323.15$, $n = 1$, $E^\\circ = 0.771$, $I = 0.05$。\n  - 物种：$(\\mathrm{Fe^{2+}}, 2, 10^{-5}, 1, \\text{product})$, $(\\mathrm{Fe^{3+}}, 3, 10^{-2}, 1, \\text{reactant})$。\n\n最终输出规范：\n你的程序应该生成单行输出，其中包含五个测试用例的结果，格式为方括号内以逗号分隔的列表，每个条目是电极电势 $E$（单位：V），四舍五入到六位小数。例如，正确格式的输出为\n$$[\\;E_1,\\ E_2,\\ E_3,\\ E_4,\\ E_5\\;].$$",
            "solution": "该问题提法清晰，有科学依据，并包含了进行求解所需的所有必要信息。我将首先从给定的基本关系式中推导出电极电势的控制方程，然后概述待实现的计算算法。\n\n**1. Nernst 方程的推导**\n\n推导从两个给定的热力学关系式开始：\n1.  吉布斯自由能的变化量 $\\Delta G$ 与标准吉布斯自由能变化量 $\\Delta G^\\circ$、绝对温度 $T$、通用气体常数 $R$ 和反应商 $Q$ 的关系如下：\n    $$\\Delta G = \\Delta G^\\circ + RT \\ln Q$$\n2.  对于一个涉及 $n$ 摩尔电子转移的电化学反应，吉布斯自由能变化量与电极电势 $E$ 之间的关系如下：\n    $$\\Delta G = -n F E$$\n    其中 $F$ 是法拉第常数。\n\n在标准条件下（所有物种的活度均为单位值，因此 $Q=1$ 从而 $\\ln Q=0$），吉布斯自由能变化量即为标准吉布斯自由能变化量 $\\Delta G^\\circ$，电势即为标准电势 $E^\\circ$。将第二个关系式应用于标准条件，得到：\n$$\\Delta G^\\circ = -n F E^\\circ$$\n\n现在，我们可以将 $\\Delta G$ 和 $\\Delta G^\\circ$ 的表达式代入第一个方程：\n$$-n F E = -n F E^\\circ + RT \\ln Q$$\n\n为了解出电极电势 $E$，我们将整个方程除以 $-nF$：\n$$E = E^\\circ - \\frac{RT}{nF} \\ln Q$$\n\n这个结果就是 Nernst 方程。它描述了氧化还原电对的电极电势作为温度和所涉及化学物种活度的函数。\n\n**2. 反应商的计算策略**\n\n数值计算任务的核心是评估项 $\\ln Q$。问题将半反应 $(\\mathrm{Ox} + n e^- \\rightleftharpoons \\mathrm{Red})$ 的反应商定义为：\n$$Q = \\frac{\\prod_{\\text{products } i} a_i^{\\nu_i}}{\\prod_{\\text{reactants } j} a_j^{\\nu_j}}$$\n其中 $a_i$ 是物种 $i$ 的活度，$\\nu_i$ 是其化学计量系数。为了在处理非常小或非常大的活度时避免数值上溢或下溢，我们将使用对数进行计算。$Q$ 的自然对数是：\n$$\\ln Q = \\sum_{\\text{products } i} \\nu_i \\ln a_i - \\sum_{\\text{reactants } j} \\nu_j \\ln a_j$$\n\n问题指定内部计算应使用以 10 为底的对数进行，然后再进行转换。关系式为 $\\ln x = (\\ln 10) \\log_{10} x$。因此，我们首先计算 $\\log_{10} Q$：\n$$\\log_{10} Q = \\sum_{\\text{products } i} \\nu_i \\log_{10} a_i - \\sum_{\\text{reactants } j} \\nu_j \\log_{10} a_j$$\n然后通过以下方式获得 $\\ln Q$：\n$$\\ln Q = (\\ln 10) \\log_{10} Q$$\n\n每个物种的活度 $a_i$ 被建模为其活度系数 $\\gamma_i$ 和其无量纲浓度 $c_i$ 的乘积：\n$$a_i = \\gamma_i c_i$$\n用对数形式表示，这变为：\n$$\\log_{10} a_i = \\log_{10} \\gamma_i + \\log_{10} c_i$$\n\n**3. 使用 Davies 方程计算活度系数**\n\n活度系数 $\\gamma_i$ 使用 Davies 方程计算：\n$$\\log_{10} \\gamma_i = - A z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right)$$\n这里，$z_i$ 是物种 $i$ 的整数电荷，$I$ 是溶液的无量纲离子强度，$A$ 是一个给定的常数，对于接近 $25^\\circ\\mathrm{C}$ 的水，其值为 $0.509$。\n\n请注意，对于给定的离子强度 $I$，括号中的项对于溶液中的所有物种都是一个常数。让我们将此项定义为 $f(I)$：\n$$f(I) = \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right)$$\n那么活度系数的表达式简化为：\n$$\\log_{10} \\gamma_i = -A z_i^2 f(I)$$\n如果离子强度 $I=0$，则 $f(I)=0$，这意味着 $\\log_{10} \\gamma_i = 0$ 且 $\\gamma_i=1$。在这种情况下，活度等于浓度，$a_i = c_i$。\n\n**4. 总体算法**\n\n计算每个测试用例的电极电势 $E$ 的完整算法如下：\n1.  获取给定案例的输入参数：$T, n, E^\\circ, I$，以及带有其属性（$z_i, c_i, \\nu_i$ 和 role）的物种列表。\n2.  从 Davies 方程计算依赖于离子强度的项 $f(I)$。如果 $I=0$，此项为 $0$。\n3.  初始化 $\\log_{10} Q = 0$。\n4.  对于反应中的每个物种 $i$：\n    a. 计算 $\\log_{10} \\gamma_i = -A z_i^2 f(I)$。\n    b. 计算 $\\log_{10} c_i$。\n    c. 计算活度 $\\log_{10} a_i = \\log_{10} \\gamma_i + \\log_{10} c_i$。\n    d. 更新 $\\log_{10} Q$：如果物种是产物，则加上 $\\nu_i \\log_{10} a_i$；如果是反应物，则减去 $\\nu_i \\log_{10} a_i$。\n5.  将 $\\log_{10} Q$ 转换为自然对数：$\\ln Q = (\\ln 10) \\log_{10} Q$。\n6.  使用推导出的 Nernst 方程计算电极电势 $E$：\n    $$E = E^\\circ - \\frac{RT}{nF} \\ln Q$$\n    并使用为常数 $R$ 和 $F$ 提供的高精度值。\n7.  将 $E$ 的最终结果四舍五入到六位小数以供输出。\n\n此过程严格遵循指令，并且仅依赖于所提供的基本原理和方程。",
            "answer": "$$[0.739345, 0.153000, 0.231908, 0.887968, 0.943187]$$"
        }
    ]
}