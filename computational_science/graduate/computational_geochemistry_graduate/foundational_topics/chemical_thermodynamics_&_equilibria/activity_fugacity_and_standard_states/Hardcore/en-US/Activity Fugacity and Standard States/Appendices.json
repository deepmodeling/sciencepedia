{
    "hands_on_practices": [
        {
            "introduction": "Before automating geochemical calculations, it is essential to master the underlying formulas by hand. This exercise provides practice in applying the extended Debye–Hückel equation, a cornerstone model that improves upon the limiting law by accounting for the finite size of ions. By working through this calculation for a simple electrolyte like $\\text{NaCl}$, you will solidify your understanding of how parameters such as ionic strength ($I$) and the ion-size parameter ($a_i$) quantitatively influence the mean activity coefficient, $\\gamma_{\\pm}$ .",
            "id": "4067266",
            "problem": "Aqueous electrolyte activities in computational geochemistry are referenced to a molality-based standard state, in which the chemical potential of an ion is expressed as $\\mu_{i} = \\mu_{i}^{\\circ} + R T \\ln a_{i}$ with $a_{i} = \\gamma_{i} m_{i}$, where $a_{i}$ is the activity, $\\gamma_{i}$ is the activity coefficient relative to the infinite-dilution reference state on the molality scale, and $m_{i}$ is the molality. The ionic strength is defined by $I = \\frac{1}{2} \\sum_{j} m_{j} z_{j}^{2}$, where $z_{j}$ is the charge of ion $j$. For a symmetric $1{:}1$ electrolyte such as sodium chloride, the mean activity coefficient is $\\gamma_{\\pm} = (\\gamma_{+}\\,\\gamma_{-})^{1/2}$.\n\nStarting from the Debye–Hückel theoretical framework for dilute electrolyte solutions and incorporating finite ion-size effects, compute the mean activity coefficient $\\gamma_{\\pm}$ for sodium chloride ($\\text{NaCl}$) at ionic strength $I = 0.100\\,\\mathrm{mol\\,kg}^{-1}$ in water at $25\\,^{\\circ}\\mathrm{C}$ using the extended Debye–Hückel formalism. Use the base-$10$ Debye–Hückel constant $A = 0.5085$ (appropriate for water at $25\\,^{\\circ}\\mathrm{C}$ on the molality scale), the ion-size coefficient $B = 0.3281\\,\\text{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}$, and ion-size parameters $a_{\\mathrm{Na}^{+}} = 4.0\\,\\text{\\AA}$ and $a_{\\mathrm{Cl}^{-}} = 3.5\\,\\text{\\AA}$. Take $z_{\\mathrm{Na}^{+}} = +1$ and $z_{\\mathrm{Cl}^{-}} = -1$.\n\nRound your final mean activity coefficient to four significant figures. Express the final answer as a pure number (dimensionless).",
            "solution": "The problem is subjected to validation. All givens are extracted verbatim:\n- Chemical potential of an ion: $\\mu_{i} = \\mu_{i}^{\\circ} + R T \\ln a_{i}$\n- Activity of an ion: $a_{i} = \\gamma_{i} m_{i}$\n- $\\gamma_{i}$: activity coefficient\n- $m_{i}$: molality\n- Ionic strength: $I = \\frac{1}{2} \\sum_{j} m_{j} z_{j}^{2}$\n- $z_{j}$: charge of ion $j$\n- Mean activity coefficient for a symmetric $1{:}1$ electrolyte: $\\gamma_{\\pm} = (\\gamma_{+}\\,\\gamma_{-})^{1/2}$\n- Task: Compute $\\gamma_{\\pm}$ for sodium chloride ($\\text{NaCl}$)\n- Ionic strength: $I = 0.100$ mol kg$^{-1}$\n- Temperature: $T = 25\\,^{\\circ}\\mathrm{C}$\n- Formalism: extended Debye–Hückel\n- Base-$10$ Debye–Hückel constant: $A = 0.5085$\n- Ion-size coefficient: $B = 0.3281\\,\\text{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}$\n- Ion-size parameter for sodium: $a_{\\mathrm{Na}^{+}} = 4.0\\,\\text{\\AA}$\n- Ion-size parameter for chloride: $a_{\\mathrm{Cl}^{-}} = 3.5\\,\\text{\\AA}$\n- Charge of sodium: $z_{\\mathrm{Na}^{+}} = +1$\n- Charge of chloride: $z_{\\mathrm{Cl}^{-}} = -1$\n- Final answer precision: Round to four significant figures.\n\nThe problem is scientifically grounded, well-posed, and objective. It is based on the standard extended Debye–Hückel theory, a fundamental concept in physical chemistry and geochemistry. All necessary constants and parameters are provided, and their values are consistent with established literature for aqueous solutions at the specified temperature. The problem is free of contradictions, ambiguities, and factual errors. Therefore, the problem is deemed valid and a solution will be provided.\n\nThe objective is to compute the mean activity coefficient, $\\gamma_{\\pm}$, for aqueous sodium chloride at a specified ionic strength using the extended Debye–Hückel formalism. The problem provides distinct ion-size parameters for $\\mathrm{Na}^{+}$ and $\\mathrm{Cl}^{-}$, which necessitates calculating their individual activity coefficients first.\n\nThe extended Debye–Hückel equation for the activity coefficient, $\\gamma_{i}$, of a single ion $i$ in a solution of ionic strength $I$ is given in base-$10$ logarithm form as:\n$$\n\\log_{10} \\gamma_{i} = - \\frac{A z_{i}^{2} \\sqrt{I}}{1 + B a_{i} \\sqrt{I}}\n$$\nwhere $A$ and $B$ are constants dependent on the solvent and temperature, $z_i$ is the charge number of the ion, $a_i$ is the effective hydrated ion-size parameter, and $I$ is the ionic strength of the solution.\n\nFor sodium chloride ($\\mathrm{NaCl}$), a $1{:}1$ electrolyte, the constituent ions are the sodium cation ($\\mathrm{Na}^{+}$) and the chloride anion ($\\mathrm{Cl}^{-}$). Their respective activity coefficients, $\\gamma_{\\mathrm{Na}^{+}}$ and $\\gamma_{\\mathrm{Cl}^{-}}$, are calculated using the above equation.\nFor the sodium ion ($i = \\mathrm{Na}^{+}$), we have $z_{\\mathrm{Na}^{+}}=+1$ and $a_{\\mathrm{Na}^{+}} = 4.0\\,\\text{\\AA}$.\n$$\n\\log_{10} \\gamma_{\\mathrm{Na}^{+}} = - \\frac{A (z_{\\mathrm{Na}^{+}})^{2} \\sqrt{I}}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}} = - \\frac{A (+1)^{2} \\sqrt{I}}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}}\n$$\nFor the chloride ion ($i = \\mathrm{Cl}^{-}$), we have $z_{\\mathrm{Cl}^{-}}=-1$ and $a_{\\mathrm{Cl}^{-}} = 3.5\\,\\text{\\AA}$.\n$$\n\\log_{10} \\gamma_{\\mathrm{Cl}^{-}} = - \\frac{A (z_{\\mathrm{Cl}^{-}})^{2} \\sqrt{I}}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}} = - \\frac{A (-1)^{2} \\sqrt{I}}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}}\n$$\nSince $(+1)^{2} = (-1)^{2} = 1$, both expressions simplify. Let's denote $\\gamma_{\\mathrm{Na}^{+}}$ as $\\gamma_{+}$ and $\\gamma_{\\mathrm{Cl}^{-}}$ as $\\gamma_{-}$.\n$$\n\\log_{10} \\gamma_{+} = - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}}\n$$\n$$\n\\log_{10} \\gamma_{-} = - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}}\n$$\nThe problem defines the mean activity coefficient, $\\gamma_{\\pm}$, for a symmetric $1{:}1$ electrolyte as the geometric mean of the individual ion activity coefficients:\n$$\n\\gamma_{\\pm} = (\\gamma_{+} \\gamma_{-})^{1/2}\n$$\nTaking the base-$10$ logarithm of this expression gives:\n$$\n\\log_{10} \\gamma_{\\pm} = \\log_{10} \\left( (\\gamma_{+} \\gamma_{-})^{1/2} \\right) = \\frac{1}{2} (\\log_{10} \\gamma_{+} + \\log_{10} \\gamma_{-})\n$$\nSubstituting the extended Debye–Hückel expressions for $\\log_{10} \\gamma_{+}$ and $\\log_{10} \\gamma_{-}$ yields:\n$$\n\\log_{10} \\gamma_{\\pm} = \\frac{1}{2} \\left[ \\left( - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}} \\right) + \\left( - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}} \\right) \\right]\n$$\nFactoring out the common term $-A\\sqrt{I}$ gives:\n$$\n\\log_{10} \\gamma_{\\pm} = - \\frac{A \\sqrt{I}}{2} \\left( \\frac{1}{1 + B a_{\\mathrm{Na}^{+}} \\sqrt{I}} + \\frac{1}{1 + B a_{\\mathrm{Cl}^{-}} \\sqrt{I}} \\right)\n$$\nNow, we substitute the given numerical values into this equation:\n- $I = 0.100\\,\\mathrm{mol\\,kg}^{-1}$, so $\\sqrt{I} \\approx 0.316228\\,(\\mathrm{mol/kg})^{1/2}$\n- $A = 0.5085$\n- $B = 0.3281\\,\\text{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}$\n- $a_{\\mathrm{Na}^{+}} = 4.0\\,\\text{\\AA}$\n- $a_{\\mathrm{Cl}^{-}} = 3.5\\,\\text{\\AA}$\n\nFirst, we calculate the dimensionless products $B a_i \\sqrt{I}$:\n$$\nB a_{\\mathrm{Na}^{+}} \\sqrt{I} = (0.3281\\,\\text{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}) \\times (4.0\\,\\text{\\AA}) \\times \\sqrt{0.100\\,(\\mathrm{mol/kg})} \\approx 0.41498\n$$\n$$\nB a_{\\mathrm{Cl}^{-}} \\sqrt{I} = (0.3281\\,\\text{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}) \\times (3.5\\,\\text{\\AA}) \\times \\sqrt{0.100\\,(\\mathrm{mol/kg})} \\approx 0.36311\n$$\nNow, we substitute these values into the expression for $\\log_{10} \\gamma_{\\pm}$:\n$$\n\\log_{10} \\gamma_{\\pm} = - \\frac{0.5085 \\times \\sqrt{0.100}}{2} \\left( \\frac{1}{1 + 0.41498} + \\frac{1}{1 + 0.36311} \\right)\n$$\n$$\n\\log_{10} \\gamma_{\\pm} = - \\frac{0.5085 \\times 0.316228}{2} \\left( \\frac{1}{1.41498} + \\frac{1}{1.36311} \\right)\n$$\n$$\n\\log_{10} \\gamma_{\\pm} \\approx - \\frac{0.16079}{2} \\left( 0.70672 + 0.73362 \\right)\n$$\n$$\n\\log_{10} \\gamma_{\\pm} \\approx -0.080395 \\times (1.44034)\n$$\n$$\n\\log_{10} \\gamma_{\\pm} \\approx -0.11580\n$$\nTo find the mean activity coefficient $\\gamma_{\\pm}$, we compute the antilogarithm:\n$$\n\\gamma_{\\pm} = 10^{\\log_{10} \\gamma_{\\pm}} = 10^{-0.11580}\n$$\n$$\n\\gamma_{\\pm} \\approx 0.765934\n$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\n\\gamma_{\\pm} \\approx 0.7659\n$$\nThe mean activity coefficient is a dimensionless quantity.",
            "answer": "$$\n\\boxed{0.7659}\n$$"
        },
        {
            "introduction": "While manual calculations are instructive, the power of computational geochemistry lies in automation and the ability to handle complex systems. This practice guides you through the process of translating theoretical equations into a robust computational tool by designing an algorithm to calculate aqueous ion activities using several standard models. Building this versatile activity calculator  is a foundational step toward developing more sophisticated geochemical simulation software.",
            "id": "4067265",
            "problem": "You are tasked with designing and implementing a deterministic algorithm that computes the activities of aqueous ionic species under the molality standard state at fixed temperature. The algorithm must accept the following inputs: the molalities $m_i$ (in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$), the ionic charges $z_i$ (dimensionless), the ionic strength $I$ (in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$), and a chosen activity model among the set $\\{\\text{Ideal}, \\text{Davies}, \\text{Extended Debye-Hückel}\\}$. The outputs must be the activities $a_i$ (dimensionless) for each species, computed consistently with the molality standard state, and aggregated across a provided test suite into a single required format.\n\nUse the following fundamental base:\n- The chemical potential of species $i$ on the molality scale is $\\mu_i = \\mu_i^{\\circ} + RT \\ln a_i$, where $R$ is the ideal gas constant, $T$ is temperature, and the standard state is infinite dilution with unit molality.\n- The activity on the molality scale is $a_i = \\gamma_i \\, m_i / m^{\\circ}$, where $\\gamma_i$ is the activity coefficient (dimensionless) and $m^{\\circ} = 1\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$.\n- The ionic strength is $I = \\dfrac{1}{2}\\sum_j m_j z_j^2$.\n\nImplement the following activity models in your algorithm:\n- Ideal model: assume $\\gamma_i = 1$ for all species.\n- Davies model: use the canonical base-10 formulation consistent with aqueous solutions at $25\\,^{\\circ}\\mathrm{C}$, with the appropriate constants for water. Do not assume any iteration is necessary.\n- Extended Debye-Hückel model: use the canonical base-10 formulation consistent with aqueous solutions at $25\\,^{\\circ}\\mathrm{C}$, including ion-size parameters (in $\\text{\\AA}$). Do not assume any higher-order interactions beyond the model.\n\nAdopt the constants appropriate for water at $25\\,^{\\circ}\\mathrm{C}$: the Debye-Hückel $A$-constant (base-10) $A_{\\phi} = 0.509$ and the $B$-constant (base-10) $B = 0.328\\,\\text{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}$. For neutral solutes with $z_i = 0$, set $\\gamma_i = 1$ independent of $I$.\n\nAlgorithmic requirements:\n- The algorithm must validate that $I \\ge 0$; if $I = 0$, it must return $\\gamma_i = 1$ for all species as required by infinite dilution.\n- If the activity model is Ideal, set $\\gamma_i = 1$ for all species.\n- If the activity model is Davies or Extended Debye-Hückel, compute $\\gamma_i$ using the model’s canonical base-10 formulation with $A_{\\phi}$ and $B$ as specified above; for Extended Debye-Hückel, the ion-size parameter for each ion must be supplied in $\\text{\\AA}$.\n- The final activity must be computed as $a_i = \\gamma_i \\, m_i / m^{\\circ}$, and reported as a dimensionless float.\n- Stopping criteria: all three activity models are non-iterative in this formulation. However, your algorithm must include a general convergence check scaffold that would be used if any iterative refinement were introduced (for example, if the provided $I$ had to be reconciled self-consistently with a more complex model): terminate when the absolute change in any computed quantity subject to iteration would be less than $\\varepsilon = 10^{-12}$ or when a maximum of $N_{\\max} = 100$ iterations is reached. In this problem, since the models are non-iterative, this scaffold will trigger immediate termination after a single pass.\n\nUnits:\n- Input molalities $m_i$ are in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$.\n- Input ionic strength $I$ is in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$.\n- Ion-size parameters for the Extended Debye-Hückel model are in $\\text{\\AA}$.\n- Output activities $a_i$ are dimensionless.\n\nTest suite:\nFor each test case, provide the tuple $(m, z, I, \\text{model}, a^{\\text{size}})$ where $m$ and $z$ are lists of equal length, $I$ is a nonnegative float, $\\text{model} \\in \\{\\text{ideal}, \\text{davies}, \\text{edh}\\}$, and $a^{\\text{size}}$ is either a list of ion-size parameters (for the extended Debye-Hückel model) or $\\text{None}$ otherwise.\n\n- Case 1 (happy path, ideal, dilute binary electrolyte):\n  - $m = [0.01, 0.01]$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $z = [1, -1]$,\n  - $I = 0.01$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $\\text{model} = \\text{ideal}$,\n  - $a^{\\text{size}} = \\text{None}$.\n- Case 2 (Davies, moderate ionic strength, divalent ions):\n  - $m = [0.05, 0.05]$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $z = [2, -2]$,\n  - $I = 0.2$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $\\text{model} = \\text{davies}$,\n  - $a^{\\text{size}} = \\text{None}$.\n- Case 3 (Extended Debye-Hückel, mixed valence, specified ion sizes):\n  - $m = [0.1, 0.2]$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $z = [2, -1]$,\n  - $I = 0.3$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $\\text{model} = \\text{edh}$,\n  - $a^{\\text{size}} = [9.0, 4.0]$ in $\\text{\\AA}$.\n- Case 4 (edge case, zero ionic strength, neutral solute):\n  - $m = [0.001]$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $z = [0]$,\n  - $I = 0.0$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $\\text{model} = \\text{edh}$,\n  - $a^{\\text{size}} = [3.0]$ in $\\text{\\AA}$ (ignored because $z=0$).\n- Case 5 (Davies boundary validity, near upper range):\n  - $m = [0.5, 0.5]$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $z = [1, -1]$,\n  - $I = 0.5$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $\\text{model} = \\text{davies}$,\n  - $a^{\\text{size}} = \\text{None}$.\n- Case 6 (Extended Debye-Hückel, high ionic strength beyond Davies range):\n  - $m = [1.0, 1.0]$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $z = [1, -1]$,\n  - $I = 1.0$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$,\n  - $\\text{model} = \\text{edh}$,\n  - $a^{\\text{size}} = [4.0, 4.0]$ in $\\text{\\AA}$.\n\nAnswer specification:\n- For each test case, the program must return the list of activities $[a_1, a_2, \\dots]$ as floats.\n- The final output must be a single line containing the aggregate results across all test cases as a comma-separated list of lists with no spaces, enclosed in square brackets, for example: $[ [a_{11},a_{12}], [a_{21},a_{22}], \\dots ]$, emitted exactly as a single Python-style list literal but without any spaces.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[result1,result2,result3]`). In this problem, each `result` is itself a list of floats, and there must be no spaces anywhere in the printed line.",
            "solution": "The problem statement has been meticulously validated and is determined to be valid. It is scientifically sound, self-contained, and well-posed. The task is to develop a deterministic algorithm for calculating the activities of aqueous species using one of three specified thermodynamic models: the Ideal model, the Davies model, or the Extended Debye-Hückel model. The problem provides all necessary equations, constants, and a comprehensive test suite. The provided ionic strength values in the test cases are consistent with the corresponding molalities and charges, confirming the internal consistency of the problem setup.\n\nThe solution proceeds by first defining the fundamental thermodynamic relationships and the specific equations for each activity model. Subsequently, a computational algorithm is designed to implement these models, handle the specified test cases, and produce the output in the required format.\n\nThe activity, $a_i$, of a species $i$ on the molality scale is defined as:\n$$\na_i = \\gamma_i \\frac{m_i}{m^{\\circ}}\n$$\nwhere $m_i$ is the molality of the species, $\\gamma_i$ is its dimensionless activity coefficient, and $m^{\\circ}$ is the standard state molality, equal to $1\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$. Since the input molalities are provided as numerical values, the calculation simplifies to $a_i = \\gamma_i m_i$.\n\nThe activity coefficient, $\\gamma_i$, depends on the ionic strength of the solution, $I$, and the chosen thermodynamic model. The ionic strength is given by:\n$$\nI = \\frac{1}{2} \\sum_{j} m_j z_j^2\n$$\nwhere $z_j$ is the charge of species $j$.\n\nThe algorithm must implement three models for $\\gamma_i$:\n\n1.  **Ideal Model**: In this simplified case, all inter-ionic interactions are neglected. The activity coefficient for every species is unity.\n    $$\n    \\gamma_i = 1\n    $$\n\n2.  **Davies Model**: This model provides an empirical extension to the Debye-Hückel theory. The base-$10$ logarithmic form of the activity coefficient for an ion $i$ is:\n    $$\n    \\log_{10} \\gamma_i = -A_{\\phi} z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right)\n    $$\n    where $A_{\\phi}$ is the Debye-Hückel constant for the osmotic coefficient. The problem specifies $A_{\\phi} = 0.509$ for water at $25\\,^{\\circ}\\mathrm{C}$.\n\n3.  **Extended Debye-Hückel (EDH) Model**: This model accounts for the finite size of ions. The base-$10$ logarithmic form is:\n    $$\n    \\log_{10} \\gamma_i = - \\frac{A_{\\phi} z_i^2 \\sqrt{I}}{1 + B a_i^{\\circ} \\sqrt{I}}\n    $$\n    Here, $a_i^{\\circ}$ is the effective hydrated radius of ion $i$ (the ion-size parameter, provided in $\\text{\\AA}$), and $B$ is another Debye-Hückel parameter. The problem specifies $A_{\\phi} = 0.509$ and $B = 0.328\\,\\text{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}$ for water at $25\\,^{\\circ}\\mathrm{C}$.\n\nFor all models, two boundary conditions are mandated:\n-   If an ion is neutral ($z_i = 0$), its activity coefficient is $\\gamma_i = 1$.\n-   At infinite dilution ($I = 0$), all activity coefficients are $\\gamma_i = 1$.\n\nThe algorithm is structured as follows:\nA main function iterates through each test case provided in the test suite. For each case, a dedicated calculation function is invoked. This function first unpacks the inputs: a list of molalities ($m_i$), a list of charges ($z_i$), the ionic strength ($I$), the model name, and a list of ion-size parameters ($a_i^{\\circ}$) if applicable.\n\nThe calculation function includes an \"iterative scaffold\" as a `for` loop running up to a maximum of $N_{\\max} = 100$ iterations. However, since the specified models are non-iterative (i.e., $\\gamma_i$ can be calculated directly from $I$), the loop is designed to execute only once and then terminate. This structure is nevertheless included to satisfy the problem's requirement for a design that could be extended to iterative schemes (e.g., self-consistent ionic strength calculation).\n\nInside the loop, the algorithm iterates over each species $i$ from $1$ to $N_{\\text{species}}$. For each species, it computes $\\gamma_i$ based on the selected model and the species' charge $z_i$:\n- It first checks for the special conditions: if $z_i = 0$ or $I = 0$, $\\gamma_i$ is set to $1.0$.\n- Otherwise, it uses a conditional block to select the formula for $\\log_{10} \\gamma_i$ corresponding to the \"ideal\", \"davies\", or \"edh\" model.\n- The activity coefficient is then found by exponentiation: $\\gamma_i = 10^{\\log_{10} \\gamma_i}$.\n\nAfter computing the list of activity coefficients for all species in the test case, the loop terminates. The final activities are then calculated as $a_i = \\gamma_i m_i$ for each species. The resulting list of activities for the current test case is stored.\n\nAfter processing all test cases, the collected list of results (which is a list of lists) is formatted into a single string. This string is constructed to be a Python-style list literal with no whitespace, as per the strict output specification, e.g., `[[a1,a2],[b1,b2,b3]]`. This is achieved by programmatically building the string from its components to ensure precise formatting.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes a suite of test cases for calculating aqueous species activities.\n    \"\"\"\n\n    # Constants for water at 25 C as specified in the problem\n    A_PHI = 0.509  # Debye-Hückel A-constant (base-10)\n    B = 0.328      # Debye-Hückel B-constant (base-10, in Angstrom^-1 * (kg/mol)^(1/2))\n    \n    # Iteration scaffold parameters (non-functional for this problem's models)\n    N_MAX = 100\n    EPSILON = 1e-12\n\n    # Test suite as defined in the problem statement\n    test_cases = [\n        # Case 1: happy path, ideal, dilute binary electrolyte\n        {'m': [0.01, 0.01], 'z': [1, -1], 'I': 0.01, 'model': 'ideal', 'a_size': None},\n        # Case 2: Davies, moderate ionic strength, divalent ions\n        {'m': [0.05, 0.05], 'z': [2, -2], 'I': 0.2, 'model': 'davies', 'a_size': None},\n        # Case 3: Extended Debye-Hückel, mixed valence, specified ion sizes\n        {'m': [0.1, 0.2], 'z': [2, -1], 'I': 0.3, 'model': 'edh', 'a_size': [9.0, 4.0]},\n        # Case 4: edge case, zero ionic strength, neutral solute\n        {'m': [0.001], 'z': [0], 'I': 0.0, 'model': 'edh', 'a_size': [3.0]},\n        # Case 5: Davies boundary validity, near upper range\n        {'m': [0.5, 0.5], 'z': [1, -1], 'I': 0.5, 'model': 'davies', 'a_size': None},\n        # Case 6: Extended Debye-Hückel, high ionic strength beyond Davies range\n        {'m': [1.0, 1.0], 'z': [1, -1], 'I': 1.0, 'model': 'edh', 'a_size': [4.0, 4.0]},\n    ]\n\n    def calculate_activities(case):\n        \"\"\"\n        Calculates activities for a single test case.\n        \"\"\"\n        m_vals = case['m']\n        z_vals = case['z']\n        I_val = case['I']\n        model = case['model']\n        a_size_vals = case['a_size']\n\n        if I_val  0:\n            raise ValueError(\"Ionic strength cannot be negative.\")\n\n        num_species = len(m_vals)\n        gammas = np.ones(num_species)\n\n        # Iterative scaffold: will run only once for these non-iterative models.\n        for _ in range(N_MAX):\n            \n            # Since the state does not change, calculate gammas and break.\n            gammas_new = np.ones(num_species)\n            sqrt_I = np.sqrt(I_val)\n\n            for i in range(num_species):\n                z_i = z_vals[i]\n\n                # Handle special conditions: neutral species or infinite dilution\n                if z_i == 0 or I_val == 0:\n                    gammas_new[i] = 1.0\n                    continue\n\n                if model == 'ideal':\n                    gammas_new[i] = 1.0\n                \n                elif model == 'davies':\n                    log10_gamma = -A_PHI * (z_i**2) * ( (sqrt_I / (1.0 + sqrt_I)) - 0.3 * I_val )\n                    gammas_new[i] = 10**log10_gamma\n                \n                elif model == 'edh':\n                    if a_size_vals is None:\n                        raise ValueError(\"Ion-size parameters must be provided for EDH model.\")\n                    a_i = a_size_vals[i]\n                    log10_gamma = - (A_PHI * (z_i**2) * sqrt_I) / (1.0 + B * a_i * sqrt_I)\n                    gammas_new[i] = 10**log10_gamma\n                \n                else:\n                    raise ValueError(f\"Unknown model: {model}\")\n            \n            # The scaffold's convergence check is trivially passed\n            # by breaking after the first and only pass.\n            gammas = gammas_new\n            break\n            # In a real iterative solver, you would check:\n            # if np.all(np.abs(gammas_new - gammas)  EPSILON):\n            #     gammas = gammas_new\n            #     break\n            # gammas = gammas_new\n\n        # Calculate activities: a_i = gamma_i * m_i / m_circ, with m_circ = 1\n        activities = gammas * np.array(m_vals)\n        return activities.tolist()\n\n    all_results = []\n    for case in test_cases:\n        result = calculate_activities(case)\n        all_results.append(result)\n\n    # Format the final output string to be a list of lists with no spaces.\n    # e.g., [[val1,val2],[val3,val4]]\n    inner_strings = []\n    for res_list in all_results:\n        inner_strings.append(f\"[{','.join(map(str, res_list))}]\")\n    \n    final_output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Standard thermodynamic models often fail to accurately predict ion behavior in the concentrated solutions frequently encountered in geological systems. This exercise elevates your skills from being a user of models to a developer, simulating the real-world scientific task of improving upon existing theory. You will construct a hybrid activity model that combines the long-range electrostatics of Debye-Hückel theory with the short-range corrections of Specific Ion Interaction Theory (SIT), fit its parameters to experimental data, and critically evaluate its performance . This is a core practice in modern geochemical model development.",
            "id": "4067293",
            "problem": "Consider the binary electrolyte calcium chloride, $\\text{CaCl}_2$, in water at temperature $T = 298.15\\,\\mathrm{K}$, where the mean activity coefficient $\\gamma_{\\pm}$ is defined by the relation between chemical potential and activity, $\\mu_i = \\mu_i^{\\circ} + RT \\ln a_i$, with solute activity $a_i = \\gamma_i m_i$ in the molality scale (molality $m_i$ in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$). For an electrolyte with stoichiometric coefficients $\\nu_+$ and $\\nu_-$, the mean activity coefficient is $ \\gamma_{\\pm} = \\left(\\gamma_+^{\\nu_+} \\gamma_-^{\\nu_-}\\right)^{1/(\\nu_+ + \\nu_-)}$. For $\\text{CaCl}_2$, $\\nu_+ = 1$ and $\\nu_- = 2$, so $\\nu_+ + \\nu_- = 3$. The ionic strength is $ I = \\frac{1}{2}\\sum_i m_i z_i^2 $, and for $\\text{CaCl}_2$ treated as fully dissociated into $\\mathrm{Ca}^{2+}$ and $\\mathrm{Cl}^-$, one has $m_{\\mathrm{Ca}^{2+}} = m$ and $m_{\\mathrm{Cl}^-} = 2m$, so $ I = 3m $.\n\nYou are to construct and test a hybrid activity-coefficient model that blends the long-range electrostatic contribution consistent with Debye–Hückel theory and a short-range specific interaction term consistent with the Specific Ion Interaction Theory (SIT), for the mean activity coefficient of $\\text{CaCl}_2$ as a function of molality $m$ up to $6\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$. The standard state is the infinite dilution reference where $\\gamma_{\\pm} \\to 1$ as $m \\to 0$.\n\nYour task is:\n- From the fundamental definitions above and the long-range Debye–Hückel concept, derive a computationally usable expression for the mean activity coefficient of $\\text{CaCl}_2$ that includes a single short-range interaction parameter in the spirit of SIT.\n- Given synthetic but physically plausible \"experimental\" data sets of $\\gamma_{\\pm}(m)$, test whether the chosen Debye–Hückel–SIT hybrid captures the curvature of $\\log_{10}\\gamma_{\\pm}$ as a function of $m$ over $m \\in [0.1, 6.0]\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$. Here, “curvature captured” is operationally defined as the root-mean-square error (RMSE) in $\\log_{10}\\gamma_{\\pm}$ between the hybrid model fit (with only the single short-range parameter) and the experimental dataset being less than or equal to a threshold $T$.\n- If the curvature is not captured (RMSE $$ $T$), propose a minimal correction term consistent with physically motivated higher-order short-range interactions, add it to the hybrid, and refit to the same data set. Report the fitted coefficient of this correction term.\n- All modeling and fitting must be performed on $\\log_{10}\\gamma_{\\pm}$, which is dimensionless. Report all outputs as dimensionless quantities. Angles are not present, and no percentages are required.\n\nUse the following physically plausible constants and definitions in your derivation and computation, without inventing new ones:\n- Charges: $z_+ = +2$, $z_- = -1$.\n- Ionic strength: $I = 3m$.\n- Debye–Hückel constants at $25\\,^{\\circ}\\mathrm{C}$ for the base-10 formulation: $A = 0.509$ and $B = 0.328\\,\\mathrm{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}$.\n- An effective ion-size parameter $a_{\\mathrm{eff}}$ (in $\\mathrm{\\AA}$) to be specified per test case.\n\nThe synthetic \"experimental\" $\\log_{10}\\gamma_{\\pm}(m)$ data are constructed over the molality grid $m \\in \\{0.1,\\,0.5,\\,1.0,\\,2.0,\\,3.5,\\,6.0\\}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ as the sum of a Debye–Hückel long-range term and short-range terms up to second order in $m$ (this reflects realistic upward or downward curvature at high concentration). You are not given the generating formula in the problem statement; instead, you will use the constants below to reproduce the data internally for testing.\n\nTest suite (each case specifies $a_{\\mathrm{eff}}$ in $\\mathrm{\\AA}$, a linear short-range coefficient $\\varepsilon_{\\mathrm{true}}$ in $(\\mathrm{mol\\,kg^{-1}})^{-1}$, and a quadratic short-range coefficient $\\kappa_{\\mathrm{true}}$ in $(\\mathrm{mol\\,kg^{-1}})^{-2}$):\n- Case 1 (happy path, mild curvature): $a_{\\mathrm{eff}} = 4.0$, $\\varepsilon_{\\mathrm{true}} = 0.08$, $\\kappa_{\\mathrm{true}} = 0.005$.\n- Case 2 (strong curvature): $a_{\\mathrm{eff}} = 3.5$, $\\varepsilon_{\\mathrm{true}} = 0.04$, $\\kappa_{\\mathrm{true}} = 0.012$.\n- Case 3 (near-linear behavior): $a_{\\mathrm{eff}} = 4.0$, $\\varepsilon_{\\mathrm{true}} = 0.06$, $\\kappa_{\\mathrm{true}} = 0.000$.\n- Case 4 (downward curvature at high $m$): $a_{\\mathrm{eff}} = 4.5$, $\\varepsilon_{\\mathrm{true}} = 0.10$, $\\kappa_{\\mathrm{true}} = -0.004$.\n\nDecision threshold:\n- Use $T = 0.05$ for the RMSE on $\\log_{10}\\gamma_{\\pm}$.\n\nModel-fitting and decision protocol:\n- Fit the hybrid with a single short-range parameter by least squares on $\\log_{10}\\gamma_{\\pm}$ as a function of $m$ across the grid.\n- Compute the RMSE of this fit.\n- If RMSE $\\leq T$, declare “curvature captured” and do not add a correction term.\n- If RMSE $ T$, introduce the minimal correction term you deem appropriate based on your derivation, refit, and report the fitted coefficient of this correction term.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- For each of the four cases, output two values in order: first, a boolean indicating whether the single-parameter hybrid captures the curvature (True if RMSE $\\leq T$, False otherwise), and second, the fitted coefficient of the proposed correction term if the curvature is not captured; otherwise output $0.0$ for the correction term. Thus, the final output will contain eight entries: $[\\text{case1\\_captured},\\text{case1\\_correction},\\text{case2\\_captured},\\text{case2\\_correction},\\text{case3\\_captured},\\text{case3\\_correction},\\text{case4\\_captured},\\text{case4\\_correction}]$.",
            "solution": "The user has provided a valid problem statement. It is scientifically grounded in the principles of physical chemistry, specifically electrolyte solution theory, and is well-posed with a clear, objective procedure for modeling and evaluation. All necessary data and constants are provided. I will now proceed with the solution.\n\nThe primary objective is to construct and test a hybrid model for the mean activity coefficient, $\\gamma_{\\pm}$, of aqueous calcium chloride ($\\mathrm{CaCl}_2$) at a temperature of $T = 298.15\\,\\mathrm{K}$. The model will combine the long-range electrostatic interactions described by Debye–Hückel theory with a short-range term inspired by Specific Ion Interaction Theory (SIT).\n\nFirst, we derive the mathematical expression for the model. The analysis will be performed on $\\log_{10}\\gamma_{\\pm}$.\n\n**1. Derivation of the Long-Range Debye–Hückel Term**\n\nThe extended Debye–Hückel theory provides an expression for the base-$10$ logarithm of the activity coefficient of a single ion $i$ as a function of ionic strength $I$:\n$$ \\log_{10} \\gamma_i = - \\frac{A z_i^2 \\sqrt{I}}{1 + B a_i \\sqrt{I}} $$\nwhere $z_i$ is the charge number of the ion, $a_i$ is its effective hydrated radius, and $A$ and $B$ are solvent- and temperature-dependent constants. For water at $T=298.15\\,\\mathrm{K}$, the given values are $A = 0.509$ and $B = 0.328\\,\\mathrm{\\AA}^{-1}\\,(\\mathrm{kg/mol})^{1/2}$.\n\nThe mean activity coefficient $\\gamma_{\\pm}$ for an electrolyte $C_{\\nu_+}A_{\\nu_-}$ is defined from the individual ionic activity coefficients $\\gamma_+$ and $\\gamma_-$ as:\n$$ \\log_{10} \\gamma_{\\pm} = \\frac{1}{\\nu_+ + \\nu_-} (\\nu_+ \\log_{10} \\gamma_+ + \\nu_- \\log_{10} \\gamma_-) $$\nFor $\\mathrm{CaCl}_2$, the dissociation is $\\mathrm{CaCl}_2 \\rightarrow \\mathrm{Ca}^{2+} + 2\\mathrm{Cl}^-$. The stoichiometric coefficients are $\\nu_+ = 1$ and $\\nu_- = 2$, and the ion charges are $z_+ = +2$ and $z_- = -1$.\nSubstituting the single-ion expressions into the equation for the mean, and assuming a common effective ion-size parameter $a_{\\mathrm{eff}}$ for both ions ($a_{\\mathrm{Ca}^{2+}} \\approx a_{\\mathrm{Cl}^{-}} \\approx a_{\\mathrm{eff}}$), we get:\n$$ \\log_{10} \\gamma_{\\pm} = \\frac{1}{\\nu_+ + \\nu_-} \\left( \\nu_+ \\left(- \\frac{A z_+^2 \\sqrt{I}}{1 + B a_{\\mathrm{eff}} \\sqrt{I}}\\right) + \\nu_- \\left(- \\frac{A z_-^2 \\sqrt{I}}{1 + B a_{\\mathrm{eff}} \\sqrt{I}}\\right) \\right) $$\n$$ \\log_{10} \\gamma_{\\pm} = - \\frac{A \\sqrt{I}}{1 + B a_{\\mathrm{eff}} \\sqrt{I}} \\left( \\frac{\\nu_+ z_+^2 + \\nu_- z_-^2}{\\nu_+ + \\nu_-} \\right) $$\nThe term in the parenthesis simplifies due to the electroneutrality condition ($\\nu_+ z_+ + \\nu_- z_- = 0$) to the absolute product of the charges, $|z_+ z_-|$. For $\\mathrm{CaCl}_2$, this is $|(+2)(-1)| = 2$. Therefore, the Debye–Hückel contribution to the mean activity coefficient is:\n$$ (\\log_{10} \\gamma_{\\pm})_{\\mathrm{DH}} = - \\frac{2A\\sqrt{I}}{1 + B a_{\\mathrm{eff}} \\sqrt{I}} $$\nThe ionic strength $I$ for a molality $m$ of $\\mathrm{CaCl}_2$ is given by $I = \\frac{1}{2} \\sum_i m_i z_i^2 = \\frac{1}{2}(m \\cdot z_+^2 + 2m \\cdot z_-^2) = \\frac{1}{2}(m \\cdot (+2)^2 + 2m \\cdot (-1)^2) = \\frac{1}{2}(4m + 2m) = 3m$.\nSubstituting $I = 3m$ into the expression gives the final form of the long-range term:\n$$ (\\log_{10} \\gamma_{\\pm})_{\\mathrm{DH}} = - \\frac{2A\\sqrt{3m}}{1 + B a_{\\mathrm{eff}} \\sqrt{3m}} $$\n\n**2. Formulation of the Hybrid Models**\n\nTo account for short-range, non-electrostatic interactions, we augment the Debye–Hückel term with additional terms, following the principles of SIT and virial expansions of the excess Gibbs energy.\n\n**Model 1: Single Short-Range Parameter**\nThe simplest extension is to add a term linear in concentration. In geochemistry, this term often represents binary interactions (e.g., $\\mathrm{Ca}^{2+}\\text{-}\\mathrm{Cl}^{-}$). We add a term $\\varepsilon m$, where $\\varepsilon$ is a single adjustable parameter representing the net effect of short-range forces. This gives our primary hybrid model:\n$$ \\log_{10} \\gamma_{\\pm}(m) = - \\frac{2A\\sqrt{3m}}{1 + B a_{\\mathrm{eff}} \\sqrt{3m}} + \\varepsilon m $$\nThis is a one-parameter model, as $\\varepsilon$ is the only coefficient to be fitted for a given test case (where $a_{\\mathrm{eff}}$ is fixed).\n\n**Model 2: Minimal Correction Term for Curvature**\nIf Model 1 fails to capture the curvature of the experimental data (i.e., the root-mean-square error (RMSE) of the fit is above a threshold $T$), we must add a correction. The next logical term in a virial expansion in molality is a quadratic term, $\\kappa m^2$. This term can account for higher-order interactions (e.g., $\\mathrm{Ca}^{2+}\\text{-}\\mathrm{Cl}^{-}\\text{-}\\mathrm{Cl}^{-}$) or the concentration dependence of the binary interaction parameter $\\varepsilon$. The corrected two-parameter model is:\n$$ \\log_{10} \\gamma_{\\pm}(m) = - \\frac{2A\\sqrt{3m}}{1 + B a_{\\mathrm{eff}} \\sqrt{3m}} + \\varepsilon m + \\kappa m^2 $$\nHere, both $\\varepsilon$ and $\\kappa$ are fitted simultaneously. The coefficient of the correction term is $\\kappa$.\n\n**3. Computational and Fitting Protocol**\n\nThe task is to test these models against synthetic \"experimental\" data for each of four cases. The protocol is as follows:\n\nFor each test case `(a_eff, eps_true, kappa_true)`:\n1.  **Generate Synthetic Data**: The experimental data, $(\\log_{10}\\gamma_{\\pm})_{\\mathrm{exp}}$, is generated for each molality $m$ in the grid $\\{0.1, 0.5, 1.0, 2.0, 3.5, 6.0\\}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ using the two-parameter model form and the provided `true` coefficients:\n    $$ (\\log_{10}\\gamma_{\\pm})_{\\mathrm{exp}} = - \\frac{2A\\sqrt{3m}}{1 + B a_{\\mathrm{eff}} \\sqrt{3m}} + \\varepsilon_{\\mathrm{true}} m + \\kappa_{\\mathrm{true}} m^2 $$\n2.  **Fit One-Parameter Model**: We fit Model 1 to the generated data. This is a linear least-squares problem. Let $y_i = (\\log_{10}\\gamma_{\\pm})_{\\mathrm{exp}}$ at molality $m_i$, and let $(\\log_{10}\\gamma_{\\pm})_{\\mathrm{DH},i}$ be the corresponding Debye–Hückel term. We seek the parameter $\\varepsilon$ that minimizes the sum of squared residuals for the equation:\n    $$ y_i - (\\log_{10}\\gamma_{\\pm})_{\\mathrm{DH},i} = \\varepsilon m_i $$\n    This is a regression of the short-range part of the activity coefficient against molality. In matrix form, we solve $\\mathbf{y}' = \\mathbf{X}\\beta$ for $\\beta = [\\varepsilon]$, where $\\mathbf{y}'$ is the vector of short-range contributions and $\\mathbf{X}$ is a column vector of molalities $m_i$.\n3.  **Evaluate Fit**: We calculate the predicted values from the fitted model, $(\\log_{10}\\gamma_{\\pm})_{\\mathrm{pred},1}$, and compute the root-mean-square error:\n    $$ \\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left( (\\log_{10}\\gamma_{\\pm})_{\\mathrm{exp},i} - (\\log_{10}\\gamma_{\\pm})_{\\mathrm{pred},1,i} \\right)^2} $$\n4.  **Decision**: We compare the RMSE to the threshold $T=0.05$.\n    -   If $\\mathrm{RMSE} \\le T$, the curvature is considered \"captured\". The result for this case is `(True, 0.0)`.\n    -   If $\\mathrm{RMSE}  T$, the curvature is not captured. We proceed to the next step.\n5.  **Fit Two-Parameter Model**: We fit Model 2 to the same experimental data. This is also a linear least-squares problem, now for two parameters:\n    $$ y_i - (\\log_{10}\\gamma_{\\pm})_{\\mathrm{DH},i} = \\varepsilon m_i + \\kappa m_i^2 $$\n    We solve $\\mathbf{y}' = \\mathbf{X}\\beta$ for $\\beta = [\\varepsilon, \\kappa]^T$, where the design matrix $\\mathbf{X}$ now has two columns: a vector of molalities $m_i$ and a vector of molalities squared, $m_i^2$. The fitted value of $\\kappa$ is the coefficient of the correction term. The result for this case is `(False, kappa_fit)`.\n\nThis entire procedure is implemented for all four test cases to produce the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geochemistry problem by deriving and testing a \n    hybrid activity-coefficient model for CaCl2.\n    \"\"\"\n    # Define physical constants and problem parameters\n    A = 0.509  # Debye-Hückel constant for log10 form\n    B = 0.328  # Debye-Hückel constant for log10 form, in Angstrom^-1 * (kg/mol)^(1/2)\n    RMSE_THRESHOLD = 0.05\n\n    # Define the molality grid for calculations\n    m_grid = np.array([0.1, 0.5, 1.0, 2.0, 3.5, 6.0])\n\n    # Define the test suite. Each tuple contains:\n    # (effective ion-size parameter a_eff [Angstrom], \n    #  true linear short-range coefficient eps_true [(mol/kg)^-1],\n    #  true quadratic short-range coefficient kappa_true [(mol/kg)^-2])\n    test_cases = [\n        (4.0, 0.08, 0.005),   # Case 1: Mild curvature\n        (3.5, 0.04, 0.012),   # Case 2: Strong curvature\n        (4.0, 0.06, 0.000),   # Case 3: Near-linear behavior\n        (4.5, 0.10, -0.004),  # Case 4: Downward curvature\n    ]\n\n    results = []\n\n    # Process each test case\n    for a_eff, eps_true, kappa_true in test_cases:\n        \n        # Step 1: Generate synthetic \"experimental\" data\n        # The generating function is the full 2-parameter model.\n        sqrt_I = np.sqrt(3 * m_grid)\n        dh_term = - (2 * A * sqrt_I) / (1 + B * a_eff * sqrt_I)\n        short_range_true = eps_true * m_grid + kappa_true * m_grid**2\n        y_exp = dh_term + short_range_true\n\n        # Step 2: Fit the 1-parameter hybrid model (DH + linear term)\n        # The model is: log10_gamma = DH_term + eps * m\n        # We perform a linear least squares fit for the parameter eps.\n        # This is equivalent to fitting: y_exp - DH_term = eps * m\n        y_prime = y_exp - dh_term\n        \n        # The design matrix M1 has one column: the molality values.\n        M1 = m_grid[:, np.newaxis]\n        \n        # Solve the linear system M1 * p1 = y_prime for p1 = [eps]\n        p1, _, _, _ = np.linalg.lstsq(M1, y_prime, rcond=None)\n        eps_fit_1 = p1[0]\n\n        # Step 3: Evaluate the 1-parameter fit\n        y_pred_1 = dh_term + eps_fit_1 * m_grid\n        rmse_1 = np.sqrt(np.mean((y_exp - y_pred_1)**2))\n\n        # Step 4: Decision based on RMSE and threshold\n        captured = rmse_1 = RMSE_THRESHOLD\n        \n        if captured:\n            # Curvature captured, no correction term needed.\n            correction_coeff = 0.0\n            results.extend([True, correction_coeff])\n        else:\n            # Curvature not captured, add a correction term and refit.\n            # The model is: log10_gamma = DH_term + eps * m + kappa * m^2\n            # We fit: y_exp - DH_term = eps * m + kappa * m^2\n            \n            # The design matrix M2 has two columns: m and m^2.\n            M2 = np.vstack([m_grid, m_grid**2]).T\n            \n            # Solve the linear system M2 * p2 = y_prime for p2 = [eps, kappa]\n            p2, _, _, _ = np.linalg.lstsq(M2, y_prime, rcond=None)\n            kappa_fit_2 = p2[1]\n            \n            correction_coeff = kappa_fit_2\n            results.extend([False, correction_coeff])\n            \n    # Format and print the final results in the required single-line format.\n    # The output format requires capitalized booleans (True/False) which str() provides.\n    # The list comprehension with map(str,...) achieves the desired formatting.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}