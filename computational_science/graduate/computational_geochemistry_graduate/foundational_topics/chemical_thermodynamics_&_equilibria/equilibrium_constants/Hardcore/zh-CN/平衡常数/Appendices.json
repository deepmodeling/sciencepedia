{
    "hands_on_practices": [
        {
            "introduction": "掌握了平衡常数的热力学基础后，我们首先通过一个基本练习来巩固其核心性质。这个实践旨在阐明如何通过组合已知的基元反应来计算复杂反应的总平衡常数，这在构建和使用地球化学数据库时是一项至关重要的技能。通过这个练习，你将验证吉布斯自由能的可加性原理如何直接转化为平衡常数的乘积关系，从而加深对 $K$ 与 $\\Delta_r G^\\circ$ 之间基本联系的理解。",
            "id": "4078814",
            "problem": "在温度 $T=298.15$ K 和压力 $P=1$ 巴的条件下，考虑在基于质量摩尔浓度的水相物质标准态（在无限稀释惯例下，1 质量摩尔浓度时活度为单位值）下镁的碳酸盐水相络合。一个地球化学数据库提供了两个组分缔合反应，其平衡常数是参考该标准态的无量纲量：\n(1) $\\mathrm{Mg^{2+} + CO_3^{2-} \\rightleftharpoons MgCO_3^{0}}$，其中 $K_1 = 10^{2.90}$，\n(2) $\\mathrm{MgCO_3^{0} + CO_3^{2-} \\rightleftharpoons Mg(CO_3)_2^{2-}}$，其中 $K_2 = 10^{1.40}$。\n构建一个反应路径以得到复合反应 $\\mathrm{Mg^{2+} + 2\\,CO_3^{2-} \\rightleftharpoons Mg(CO_3)_2^{2-}}$，并仅使用所提供的组分反应计算其总平衡常数 $K_{\\mathrm{overall}}$。然后，利用标准摩尔反应吉布斯能与平衡常数之间的基本热力学关系，以及加和反应的标准摩尔反应吉布斯能的可加性，验证您计算出的 $K_{\\mathrm{overall}}$ 与在 $T=298.15$ K 时组分标准摩尔反应吉布斯能之和相符。陈述您在推理过程中使用的任何标准态假设。\n将 $K_{\\mathrm{overall}}$ 的最终值以无量纲数的形式报告，并四舍五入至四位有效数字。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题明确且客观。这是一个涉及水相平衡的化学热力学标准练习，是计算地球化学的核心课题。所有必要信息均已提供，且问题内部一致。\n\n第一步是从两个给定的组分反应中推导出复合反应。所提供的反应如下：\n(1) $\\mathrm{Mg^{2+} + CO_3^{2-} \\rightleftharpoons MgCO_3^{0}}$，平衡常数 $K_1 = 10^{2.90}$。\n(2) $\\mathrm{MgCO_3^{0} + CO_3^{2-} \\rightleftharpoons Mg(CO_3)_2^{2-}}$，平衡常数 $K_2 = 10^{1.40}$。\n\n目标反应是 $\\mathrm{Mg^{2+} + 2\\,CO_3^{2-} \\rightleftharpoons Mg(CO_3)_2^{2-}}$。我们可以通过将反应 (1) 和反应 (2)相加来得到这个反应：\n$$ (\\mathrm{Mg^{2+} + CO_3^{2-}}) + (\\mathrm{MgCO_3^{0} + CO_3^{2-}}) \\rightleftharpoons (\\mathrm{MgCO_3^{0}}) + (\\mathrm{Mg(CO_3)_2^{2-}}) $$\n合并两边的项得到：\n$$ \\mathrm{Mg^{2+} + 2\\,CO_3^{2-} + MgCO_3^{0} \\rightleftharpoons MgCO_3^{0} + Mg(CO_3)_2^{2-} $$\n物质 $\\mathrm{MgCO_3^{0}}$ 同时出现在反应物和生成物两边，充当中间体。可以将其从方程中消去，得到所需复合反应：\n$$ \\mathrm{Mg^{2+} + 2\\,CO_3^{2-} \\rightleftharpoons Mg(CO_3)_2^{2-} $$\n对于加和反应，组合平衡常数的规则是，总平衡常数 $K_{\\mathrm{overall}}$ 是各个平衡常数的乘积。因此：\n$$ K_{\\mathrm{overall}} = K_1 \\times K_2 $$\n代入给定值：\n$$ K_{\\mathrm{overall}} = 10^{2.90} \\times 10^{1.40} $$\n利用指数性质 $x^a \\times x^b = x^{a+b}$：\n$$ K_{\\mathrm{overall}} = 10^{(2.90 + 1.40)} = 10^{4.30} $$\n\n接下来，我们使用标准摩尔反应吉布斯能 $\\Delta_r G^\\circ$ 和平衡常数 $K$ 之间的关系来验证这个结果。这个基本关系是：\n$$ \\Delta_r G^\\circ = -RT \\ln K $$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度。平衡常数 $K$ 是一个无量纲量，表示反应在平衡时的活度商。该方程的有效性依赖于对所有物质一致定义的标准态，这在问题中已经给出。\n\n对于这两个组分反应，我们可以将其标准摩尔吉布斯能写为：\n$$ \\Delta_{r,1} G^\\circ = -RT \\ln K_1 $$\n$$ \\Delta_{r,2} G^\\circ = -RT \\ln K_2 $$\n对于总反应，其标准摩尔吉布斯能为：\n$$ \\Delta_{r, \\mathrm{overall}} G^\\circ = -RT \\ln K_{\\mathrm{overall}} $$\n根据热力学状态函数的可加性原理（Hess定律的应用），一个总反应的标准吉布斯能是构成该反应的各反应的标准吉布斯能之和。因此：\n$$ \\Delta_{r, \\mathrm{overall}} G^\\circ = \\Delta_{r,1} G^\\circ + \\Delta_{r,2} G^\\circ $$\n代入以平衡常数表示的表达式：\n$$ -RT \\ln K_{\\mathrm{overall}} = (-RT \\ln K_1) + (-RT \\ln K_2) $$\n$$ -RT \\ln K_{\\mathrm{overall}} = -RT (\\ln K_1 + \\ln K_2) $$\n由于 $R$ 和 $T$ 均不为零，我们可以将两边同时除以 $-RT$：\n$$ \\ln K_{\\mathrm{overall}} = \\ln K_1 + \\ln K_2 $$\n利用对数性质 $\\ln a + \\ln b = \\ln(ab)$：\n$$ \\ln K_{\\mathrm{overall}} = \\ln(K_1 K_2) $$\n通过对两边取指数，我们确认了之前使用的关系：\n$$ K_{\\mathrm{overall}} = K_1 K_2 $$\n这表明，平衡常数相乘与标准摩尔反应吉布斯能相加在热力学上是一致的。\n\n必须明确陈述此推理中使用的标准态假设。\n$1$。核心假设是对所有水相物质一致使用指定的标准态：即基于质量摩尔浓度的标准态，其中对于表现得如同无限稀释的假想 1 质量摩尔浓度的溶液，溶质的活度为单位值。无量纲的平衡常数 $K_1$、$K_2$ 和 $K_{\\mathrm{overall}}$ 以及标准摩尔吉布斯能 $\\Delta_r G^\\circ$ 都是相对于此惯例定义的。\n$2$。此外，还隐含假设溶剂（水，$\\mathrm{H_2O}$）的标准态是在系统温度（$T=298.15$ K）和压力（$P=1$ 巴）下的纯液体。在此标准态下，水的活度定义为单位值（$a_{\\mathrm{H_2O}} = 1$），这对于这些平衡相关的稀水溶液来说是一个合理的近似。\n\n最后，我们计算 $K_{\\mathrm{overall}}$ 的数值，并按要求四舍五入到四位有效数字。\n$$ K_{\\mathrm{overall}} = 10^{4.30} \\approx 19952.6231 $$\n将此值四舍五入到四位有效数字得到 $19950$。为明确地用四位有效数字表示，我们使用科学记数法：\n$$ K_{\\mathrm{overall}} = 1.995 \\times 10^4 $$",
            "answer": "$$\\boxed{1.995 \\times 10^{4}}$$"
        },
        {
            "introduction": "在理想系统之外，真实水溶液中的离子相互作用会显著影响化学平衡。下一个练习将引导你从理想模型过渡到非理想系统，这是计算地球化学中的一个关键步骤。你将使用经典的 Debye–Hückel 理论来亲手计算离子的活度系数，并量化在给定离子强度下，热力学平衡常数 $K^\\circ$ 与基于浓度的条件平衡常数 $K_c$ 之间的差异。这个实践将让你直观地感受到，对于涉及不同价态离子的反应，忽略活度校正会如何导致对平衡位置的巨大误判。",
            "id": "4078818",
            "problem": "一个水地球化学体系在 $25^{\\circ}\\mathrm{C}$ 和总离子强度 $I = 0.10$（质量摩尔浓度标度）下，含有钠和碳酸盐，它们通过以下反应形成一价络合物 $\\mathrm{NaCO_3^-}$：\n$$\\mathrm{Na^+} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{NaCO_3^-}.$$\n在标准参考态（无限稀释，$1$ 巴）下，以活度定义的热力学平衡常数为 $K^{\\circ} = 10^{1.50}$（无量纲）。使用 $25^{\\circ}\\mathrm{C}$ 下的 Debye–Hückel 理论计算活度系数，其中常数 $A = 0.509$ 和 $B = 0.328\\,\\text{\\AA}^{-1}$，有效离子尺寸参数 $a_{\\mathrm{Na^+}} = 4.0\\,\\text{\\AA}$、$a_{\\mathrm{CO_3^{2-}}} = 4.5\\,\\text{\\AA}$ 和 $a_{\\mathrm{NaCO_3^-}} = 5.0\\,\\text{\\AA}$。请确定在离子强度 $I = 0.10$ 时，如果使用浓度（质量摩尔浓度）代替活度，可以推断出的条件平衡常数 $K_c$，从而量化价态不对称性（二价 $\\mathrm{CO_3^{2-}}$ 对比一价 $\\mathrm{Na^+}$ 和 $\\mathrm{NaCO_3^-}$）对表观平衡的影响。\n\n将最终的 $K_c$ 表示为无量纲数，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它科学上基于水地球化学的既定原理（Debye-Hückel 理论），提法得当且提供了所有必要数据，并以客观、明确的语言表述。\n\n对于反应\n$$ \\mathrm{Na^+} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{NaCO_3^-} $$\n的热力学平衡常数 $K^{\\circ}$ 是根据参与物种的活度 $a_i$ 来定义的：\n$$ K^{\\circ} = \\frac{a_{\\mathrm{NaCO_3^-}}}{a_{\\mathrm{Na^+}} a_{\\mathrm{CO_3^{2-}}}} $$\n物种 $i$ 的活度 $a_i$ 与其质量摩尔浓度 $m_i$ 和活度系数 $\\gamma_i$ 通过表达式 $a_i = \\gamma_i m_i$ 相关。将此代入 $K^{\\circ}$ 的定义中可得：\n$$ K^{\\circ} = \\frac{\\gamma_{\\mathrm{NaCO_3^-}} m_{\\mathrm{NaCO_3^-}}}{(\\gamma_{\\mathrm{Na^+}} m_{\\mathrm{Na^+}}) (\\gamma_{\\mathrm{CO_3^{2-}}} m_{\\mathrm{CO_3^{2-}}})} $$\n条件平衡常数 $K_c$ 是使用质量摩尔浓度而非活度定义的：\n$$ K_c = \\frac{m_{\\mathrm{NaCO_3^-}}}{m_{\\mathrm{Na^+}} m_{\\mathrm{CO_3^{2-}}}} $$\n通过结合这些表达式，我们可以将 $K_c$ 与 $K^{\\circ}$ 联系起来：\n$$ K^{\\circ} = K_c \\cdot \\frac{\\gamma_{\\mathrm{NaCO_3^-}}}{\\gamma_{\\mathrm{Na^+}} \\gamma_{\\mathrm{CO_3^{2-}}}} $$\n重新整理以求解 $K_c$ 可得：\n$$ K_c = K^{\\circ} \\cdot \\frac{\\gamma_{\\mathrm{Na^+}} \\gamma_{\\mathrm{CO_3^{2-}}}}{\\gamma_{\\mathrm{NaCO_3^-}}} $$\n为了求出 $K_c$，我们必须首先计算在指定离子强度 $I = 0.10$ 下，这三种离子的活度系数。题目指定使用扩展的 Debye-Hückel 方程：\n$$ \\log_{10}(\\gamma_i) = -\\frac{A z_i^2 \\sqrt{I}}{1 + B a_i \\sqrt{I}} $$\n其中 $z_i$ 是离子 $i$ 的电荷，$a_i$ 是其有效离子尺寸参数，$A$ 和 $B$ 是依赖于温度的常数。给定参数如下：\n- $A = 0.509$\n- $B = 0.328\\,\\text{\\AA}^{-1}$\n- $I = 0.10$ m, 所以 $\\sqrt{I} = \\sqrt{0.10} \\approx 0.316228$\n- $K^{\\circ} = 10^{1.50}$, 这意味着 $\\log_{10}(K^{\\circ}) = 1.50$\n\n离子特异性参数如下：\n- 对于 $\\mathrm{Na^+}$: $z_{\\mathrm{Na^+}} = +1$, $a_{\\mathrm{Na^+}} = 4.0\\,\\text{\\AA}$\n- 对于 $\\mathrm{CO_3^{2-}}$: $z_{\\mathrm{CO_3^{2-}}} = -2$, $a_{\\mathrm{CO_3^{2-}}} = 4.5\\,\\text{\\AA}$\n- 对于 $\\mathrm{NaCO_3^-}$: $z_{\\mathrm{NaCO_3^-}} = -1$, $a_{\\mathrm{NaCO_3^-}} = 5.0\\,\\text{\\AA}$\n\n我们现在计算每种物种的活度系数的对数。\n\n对于 $\\mathrm{Na^+}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{Na^+}}) = -\\frac{(0.509) (+1)^2 \\sqrt{0.10}}{1 + (0.328) (4.0) \\sqrt{0.10}} = -\\frac{0.509 \\times 0.316228}{1 + 1.312 \\times 0.316228} = -\\frac{0.160960}{1.41484} \\approx -0.113766 $$\n\n对于 $\\mathrm{CO_3^{2-}}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{CO_3^{2-}}}) = -\\frac{(0.509) (-2)^2 \\sqrt{0.10}}{1 + (0.328) (4.5) \\sqrt{0.10}} = -\\frac{4 \\times 0.509 \\times 0.316228}{1 + 1.476 \\times 0.316228} = -\\frac{0.643841}{1.46672} \\approx -0.439008 $$\n\n对于 $\\mathrm{NaCO_3^-}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{NaCO_3^-}}) = -\\frac{(0.509) (-1)^2 \\sqrt{0.10}}{1 + (0.328) (5.0) \\sqrt{0.10}} = -\\frac{0.509 \\times 0.316228}{1 + 1.640 \\times 0.316228} = -\\frac{0.160960}{1.51861} \\approx -0.105992 $$\n\n为了求出 $K_c$，使用对数进行运算最为精确：\n$$ \\log_{10}(K_c) = \\log_{10}(K^{\\circ}) + \\log_{10}(\\gamma_{\\mathrm{Na^+}}) + \\log_{10}(\\gamma_{\\mathrm{CO_3^{2-}}}) - \\log_{10}(\\gamma_{\\mathrm{NaCO_3^-}}) $$\n代入数值：\n$$ \\log_{10}(K_c) \\approx 1.50 + (-0.113766) + (-0.439008) - (-0.105992) $$\n$$ \\log_{10}(K_c) \\approx 1.50 - 0.113766 - 0.439008 + 0.105992 $$\n$$ \\log_{10}(K_c) \\approx 1.053218 $$\n现在，我们计算 $K_c$：\n$$ K_c = 10^{\\log_{10}(K_c)} \\approx 10^{1.053218} \\approx 11.3023 $$\n题目要求答案四舍五入到四位有效数字。\n$$ K_c \\approx 11.30 $$\n$K_c$ 与 $K^{\\circ}$ 的显著差异（$11.30$ 对比 $10^{1.50} \\approx 31.62$）凸显了该体系中非理想行为的巨大影响，这主要是由碳酸根离子的高电荷（$z = -2$）驱动的，导致其活度系数远低于一价离子。",
            "answer": "$$\\boxed{11.30}$$"
        },
        {
            "introduction": "最后，我们将挑战提升到一个新的维度：压力。在海底热液、深部地壳流体等许多地球化学环境中，压力是控制化学反应方向的关键变量。这个高级实践要求你应用热力学积分，利用基于 Helgeson–Kirkham–Flowers (HKF) 状态方程的偏摩尔体积模型，来计算平衡常数随压力的变化。通过从参考压力积分到目标高压条件，你将掌握将实验室测定的标准状态数据外推至真实地质环境的核心计算方法，这是地球化学建模不可或缺的一项高级技能。",
            "id": "4078762",
            "problem": "你的任务是实现一个程序，通过引入由 Helgeson–Kirkham–Flowers (HKF) 状态方程描述的、依赖于压力的偏摩尔体积，来计算指定热液氧化还原反应在不同温度和压力下的平衡常数。请从基本热力学关系出发，而非使用现成的简化公式，并推导在非理想压力下平衡常数与标准反应吉布斯能之间的联系。使用以下科学合理且自洽的场景和数据，并精确执行所有单位换算。\n\n给定反应及条件：\n- 热液氧化还原反应：$\\mathrm{H_2(aq)} + \\tfrac{1}{2}\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{H_2O(l)}$。\n- 目标温度：$T = 673.15\\,\\mathrm{K}$（对应于 $400\\,^{\\circ}\\mathrm{C}$）。\n- 参考压力：$P_\\mathrm{ref} = 1\\,\\mathrm{bar}$。\n- 溶剂 HKF 参数：$\\omega = 2600\\,\\mathrm{bar}$。\n- 在 $T$ 和 $P_\\mathrm{ref}$ 下的标准反应吉布斯能：$\\Delta_r G^{\\circ}(T,P_\\mathrm{ref}) = -2.20\\times 10^{5}\\,\\mathrm{J\\,mol^{-1}}$。\n\n依赖于压力的偏摩尔体积（无限稀释条件下的 HKF 型替代函数形式）：\n对于每个物种 $i$，在固定温度 $T$ 下，偏摩尔体积作为压力的函数由下式给出\n$$\n\\bar{V}_i(T,P) = v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P},\n$$\n其中，$v_{0,i}$ 的单位为 $\\mathrm{cm^3\\,mol^{-1}}$，$m_i$ 的单位为 $\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$，$k_i$ 的单位为 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$。该替代函数通过一个反比项 $(\\omega + P)$ 和低阶可压缩性贡献，捕捉了 HKF 型行为所蕴含的显著压力依赖性。\n\n物种参数（在 $T = 673.15\\,\\mathrm{K}$ 下）：\n- 对于 $\\mathrm{H_2(aq)}$：$v_{0,\\mathrm{H_2}} = 23.0\\,\\mathrm{cm^3\\,mol^{-1}}$，$m_{\\mathrm{H_2}} = -1.0\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$，$k_{\\mathrm{H_2}} = 600.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$。\n- 对于 $\\mathrm{O_2(aq)}$：$v_{0,\\mathrm{O_2}} = 30.0\\,\\mathrm{cm^3\\,mol^{-1}}$，$m_{\\mathrm{O_2}} = -1.2\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$，$k_{\\mathrm{O_2}} = 500.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$。\n- 对于 $\\mathrm{H_2O(l)}$：$v_{0,\\mathrm{H_2O}} = 26.0\\,\\mathrm{cm^3\\,mol^{-1}}$，$m_{\\mathrm{H_2O}} = -0.8\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$，$k_{\\mathrm{H_2O}} = 400.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$。\n\n用于反应吉布斯能加和的化学计量系数 $\\nu_i$：\n- $\\nu_{\\mathrm{H_2O}} = +1$，$\\nu_{\\mathrm{H_2}} = -1$，$\\nu_{\\mathrm{O_2}} = -\\tfrac{1}{2}$。\n\n推导和实现中使用的基本原理：\n- 平衡条件将平衡常数与由标准化学势（无限稀释时的活度）构成的标准反应吉布斯能联系起来。\n- 在恒定温度下，物种 $i$ 的化学势对压力的偏导数等于其偏摩尔体积，即 $\\left(\\partial \\mu_i / \\partial P\\right)_T = \\bar{V}_i(T,P)$。\n- 标准反应吉布斯能的压力依赖性可以通过对按化学计量加权的各物种贡献进行积分得到。\n\n要求与单位：\n- 通过对依赖于压力的反应偏摩尔体积从 $P_\\mathrm{ref}$ 到 $P$ 进行积分，实现 $\\Delta_r G^{\\circ}(T,P)$ 在给定压力 $P$ 下的计算。仔细进行单位换算：在压力积分中使用 $\\mathrm{bar}$ 作为压力单位，但需使用 $1\\,\\mathrm{bar} = 10^{5}\\,\\mathrm{Pa}$ 和 $1\\,\\mathrm{cm^3} = 10^{-6}\\,\\mathrm{m^3}$ 将积分得到的 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ 项转换为 $\\mathrm{J\\,mol^{-1}}$。将最终的平衡常数 $K$ 表示为一个无量纲的浮点数。\n- 使用通用气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 温度 $T$ 固定为 $673.15\\,\\mathrm{K}$；无需进行温度积分。\n\n测试组：\n计算以下压力（单位为 $\\mathrm{bar}$）下的平衡常数 $K(T,P)$：\n- 情况 1：$P = 500.0$（目标热液条件）。\n- 情况 2：$P = 1.0$（参考压力下的边界条件）。\n- 情况 3：$P = 3000.0$（远高于 $\\omega$ 标度的高压边缘情况）。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\left[\\mathrm{result_1},\\mathrm{result_2},\\mathrm{result_3}\\right]$，其中每个条目是对应测试用例计算出的 $K(T,P)$，格式为标准 Python 浮点数。不应打印任何其他文本。",
            "solution": "该问题是有效的，因为它科学地基于基本热力学原理，问题陈述清晰并提供了所有必要数据，且表述客观。我们将进行逐步推导和求解。\n\n问题的核心是确定一个化学反应在指定温度 $T$ 和压力 $P$ 下的平衡常数 $K$。平衡常数与标准反应吉布斯能 $\\Delta_r G^{\\circ}$ 之间的基本关系由下式给出：\n$$\n\\Delta_r G^{\\circ}(T, P) = - R T \\ln K(T, P)\n$$\n其中 $R$ 是通用气体常数。我们的主要任务是在给定参考压力 $P_\\mathrm{ref}$ 下的值后，计算目标压力 $P$ 下的 $\\Delta_r G^{\\circ}$。\n\n在恒定温度下，系统吉布斯能对压力的依赖关系由基本热力学关系描述：\n$$\n\\left( \\frac{\\partial G}{\\partial P} \\right)_T = V\n$$\n将此关系应用于单个物种 $i$ 的标准化学势 $\\mu_i^{\\circ}$ 和标准偏摩尔体积 $\\bar{V}_i^{\\circ}$：\n$$\n\\left( \\frac{\\partial \\mu_i^{\\circ}}{\\partial P} \\right)_T = \\bar{V}_i^{\\circ}(T, P)\n$$\n标准反应吉布斯能是产物的标准化学势之和减去反应物的标准化学势之和，并按其化学计量系数 $\\nu_i$ 加权：\n$$\n\\Delta_r G^{\\circ} = \\sum_i \\nu_i \\mu_i^{\\circ}\n$$\n在恒定温度下对压力求导，得到标准反应吉布斯能的压力依赖性：\n$$\n\\left( \\frac{\\partial \\Delta_r G^{\\circ}}{\\partial P} \\right)_T = \\sum_i \\nu_i \\left( \\frac{\\partial \\mu_i^{\\circ}}{\\partial P} \\right)_T = \\sum_i \\nu_i \\bar{V}_i^{\\circ}(T, P) = \\Delta_r \\bar{V}^{\\circ}(T, P)\n$$\n其中 $\\Delta_r \\bar{V}^{\\circ}$ 是标准反应偏摩尔体积。\n\n为了求出目标压力 $P$ 下的 $\\Delta_r G^{\\circ}$，我们将此表达式从参考压力 $P_\\mathrm{ref}$ 积分到 $P$：\n$$\n\\int_{P_\\mathrm{ref}}^{P} d(\\Delta_r G^{\\circ}) = \\int_{P_\\mathrm{ref}}^{P} \\Delta_r \\bar{V}^{\\circ}(T, P') dP'\n$$\n这给出了如下关系：\n$$\n\\Delta_r G^{\\circ}(T, P) - \\Delta_r G^{\\circ}(T, P_\\mathrm{ref}) = \\int_{P_\\mathrm{ref}}^{P} \\Delta_r \\bar{V}^{\\circ}(T, P') dP'\n$$\n$$\n\\Delta_r G^{\\circ}(T, P) = \\Delta_r G^{\\circ}(T, P_\\mathrm{ref}) + \\int_{P_\\mathrm{ref}}^{P} \\Delta_r \\bar{V}^{\\circ}(T, P') dP'\n$$\n积分项表示了由于压力从 $P_\\mathrm{ref}$ 变化到 $P$ 而对吉布斯能的校正。\n\n首先，我们必须根据给定的各物种特定函数形式 $\\bar{V}_i(T,P) = v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P}$ 构建标准反应偏摩尔体积 $\\Delta_r \\bar{V}^{\\circ}(T, P)$ 的表达式。\n$$\n\\Delta_r \\bar{V}^{\\circ}(T, P) = \\sum_i \\nu_i \\bar{V}_i = \\sum_i \\nu_i \\left( v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P} \\right)\n$$\n我们如下定义反应参数 $\\Delta v_0$、$\\Delta m$ 和 $\\Delta k$：\n$$\n\\Delta v_0 = \\sum_i \\nu_i v_{0,i} \\quad ; \\quad \\Delta m = \\sum_i \\nu_i m_i \\quad ; \\quad \\Delta k = \\sum_i \\nu_i k_i\n$$\n反应为 $\\mathrm{H_2(aq)} + \\tfrac{1}{2}\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{H_2O(l)}$，化学计量系数为 $\\nu_{\\mathrm{H_2O}} = +1$，$\\nu_{\\mathrm{H_2}} = -1$ 和 $\\nu_{\\mathrm{O_2}} = -1/2$。使用所提供的参数：\n$$\n\\Delta v_0 = (1)(26.0) + (-1)(23.0) + (-0.5)(30.0) = 26.0 - 23.0 - 15.0 = -12.0\\,\\mathrm{cm^3\\,mol^{-1}}\n$$\n$$\n\\Delta m = (1)(-0.8 \\times 10^{-3}) + (-1)(-1.0 \\times 10^{-3}) + (-0.5)(-1.2 \\times 10^{-3}) = (-0.8 + 1.0 + 0.6) \\times 10^{-3} = 0.8 \\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}\n$$\n$$\n\\Delta k = (1)(400.0) + (-1)(600.0) + (-0.5)(500.0) = 400.0 - 600.0 - 250.0 = -450.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\n因此，标准反应偏摩尔体积为：\n$$\n\\Delta_r \\bar{V}^{\\circ}(T, P) = \\Delta v_0 + \\Delta m (P - P_\\mathrm{ref}) + \\frac{\\Delta k}{\\omega + P}\n$$\n\n接下来，我们计算压力积分项，记为 $\\Delta G_P$：\n$$\n\\Delta G_P = \\int_{P_\\mathrm{ref}}^{P} \\left( \\Delta v_0 + \\Delta m (P' - P_\\mathrm{ref}) + \\frac{\\Delta k}{\\omega + P'} \\right) dP'\n$$\n对每一项进行解析积分：\n$$\n\\Delta G_P = \\left[ \\Delta v_0 P' \\right]_{P_\\mathrm{ref}}^{P} + \\left[ \\frac{\\Delta m}{2} (P' - P_\\mathrm{ref})^2 \\right]_{P_\\mathrm{ref}}^{P} + \\left[ \\Delta k \\ln(\\omega + P') \\right]_{P_\\mathrm{ref}}^{P}\n$$\n$$\n\\Delta G_P = \\Delta v_0 (P - P_\\mathrm{ref}) + \\frac{\\Delta m}{2} (P - P_\\mathrm{ref})^2 + \\Delta k \\ln \\left( \\frac{\\omega + P}{\\omega + P_\\mathrm{ref}} \\right)\n$$\n该表达式给出的压力校正项单位为 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$。我们必须使用给定的换算因子将其转换为 $\\mathrm{J\\,mol^{-1}}$：$1\\,\\mathrm{bar} = 10^5\\,\\mathrm{Pa}$ 和 $1\\,\\mathrm{cm^3} = 10^{-6}\\,\\mathrm{m^3}$。\n$$\n1\\,\\mathrm{cm^3\\,bar} = (10^{-6}\\,\\mathrm{m^3}) \\times (10^5\\,\\mathrm{Pa}) = 10^{-1}\\,\\mathrm{m^3\\,Pa} = 0.1\\,\\mathrm{J}\n$$\n所以，以焦耳每摩尔为单位的吉布斯能校正值是该积分表达式值的 0.1 倍。\n\n在压力 $P$ 下标准反应吉布斯能的完整表达式为：\n$$\n\\Delta_r G^{\\circ}(T, P) = \\Delta_r G^{\\circ}(T, P_\\mathrm{ref}) + 0.1 \\times \\left[ \\Delta v_0 (P - P_\\mathrm{ref}) + \\frac{\\Delta m}{2} (P - P_\\mathrm{ref})^2 + \\Delta k \\ln \\left( \\frac{\\omega + P}{\\omega + P_\\mathrm{ref}} \\right) \\right]\n$$\n最后，我们可以计算平衡常数 $K(T, P)$：\n$$\nK(T, P) = \\exp \\left( - \\frac{\\Delta_r G^{\\circ}(T, P)}{R T} \\right)\n$$\n我们拥有所有必需的常数和参数：\n- $T = 673.15\\,\\mathrm{K}$\n- $P_\\mathrm{ref} = 1.0\\,\\mathrm{bar}$\n- $\\Delta_r G^{\\circ}(T, P_\\mathrm{ref}) = -2.20 \\times 10^5\\,\\mathrm{J\\,mol^{-1}}$\n- $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- $\\omega = 2600.0\\,\\mathrm{bar}$\n- $\\Delta v_0 = -12.0\\,\\mathrm{cm^3\\,mol^{-1}}$\n- $\\Delta m = 0.8 \\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$\n- $\\Delta k = -450.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$\n\n现在我们将实现这一逻辑，为三个指定的压力计算平衡常数 $K$。对于每个压力 $P$，我们将计算压力校正项，将其加到 $\\Delta_r G^{\\circ}(T, P_\\mathrm{ref})$ 上得到 $\\Delta_r G^{\\circ}(T, P)$，然后用最终的吉布斯能求出 $K$。\n\n对于情况 1，当 $P = 500.0\\,\\mathrm{bar}$ 时：\n以 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ 为单位的压力校正项为：\n$$\n\\Delta G_P = (-12.0)(500-1) + \\frac{0.8\\times 10^{-3}}{2}(500-1)^2 + (-450.0)\\ln\\left(\\frac{2600+500}{2600+1}\\right) \\approx -5967.38\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\n换算成 $\\mathrm{J\\,mol^{-1}}$，该值为 $-596.74\\,\\mathrm{J\\,mol^{-1}}$。\n$$\n\\Delta_r G^{\\circ}(T, 500\\,\\mathrm{bar}) = -220000 - 596.74 = -220596.74\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 500\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-220596.74}{8.314462618 \\times 673.15}\\right)\n$$\n\n对于情况 2，当 $P = 1.0\\,\\mathrm{bar}$ 时：\n由于 $P = P_\\mathrm{ref}$，压力校正积分为零。\n$$\n\\Delta_r G^{\\circ}(T, 1\\,\\mathrm{bar}) = \\Delta_r G^{\\circ}(T, P_\\mathrm{ref}) = -220000\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 1\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-220000}{8.314462618 \\times 673.15}\\right)\n$$\n\n对于情况 3，当 $P = 3000.0\\,\\mathrm{bar}$ 时：\n以 $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ 为单位的压力校正项为：\n$$\n\\Delta G_P = (-12.0)(3000-1) + \\frac{0.8\\times 10^{-3}}{2}(3000-1)^2 + (-450.0)\\ln\\left(\\frac{2600+3000}{2600+1}\\right) \\approx -32735.49\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\n换算成 $\\mathrm{J\\,mol^{-1}}$，该值为 $-3273.55\\,\\mathrm{J\\,mol^{-1}}$。\n$$\n\\Delta_r G^{\\circ}(T, 3000\\,\\mathrm{bar}) = -220000 - 3273.55 = -223273.55\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 3000\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-223273.55}{8.314462618 \\times 673.15}\\right)\n$$\n最终的代码将以完整精度执行这些计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the equilibrium constant for a hydrothermal reaction as a function of pressure,\n    based on the Helgeson–Kirkham–Flowers (HKF) equations of state for partial molar volumes.\n    \"\"\"\n    \n    # --- Givens and Constants ---\n    \n    # Thermodynamic conditions and constants\n    T = 673.15  # Temperature in Kelvin (400 C)\n    P_ref = 1.0  # Reference pressure in bar\n    G_rxn_ref = -2.20e5  # Standard reaction Gibbs energy at T and P_ref (J/mol)\n    R = 8.314462618  # Universal gas constant (J/mol/K)\n    \n    # Solvent HKF parameter\n    omega = 2600.0  # Solvent HKF parameter (bar)\n    \n    # Stoichiometric coefficients for H2(aq) + 0.5*O2(aq) - H2O(l)\n    nu = {\n        'H2O': 1.0,\n        'H2': -1.0,\n        'O2': -0.5\n    }\n    \n    # Species parameters for partial molar volume at T\n    # v0: cm^3/mol\n    # m: cm^3/mol/bar\n    # k: cm^3*bar/mol\n    species_params = {\n        'H2':  {'v0': 23.0, 'm': -1.0e-3, 'k': 600.0},\n        'O2':  {'v0': 30.0, 'm': -1.2e-3, 'k': 500.0},\n        'H2O': {'v0': 26.0, 'm': -0.8e-3, 'k': 400.0}\n    }\n\n    # --- Derivation Implementation ---\n\n    # 1. Calculate reaction parameters (Delta_v0, Delta_m, Delta_k)\n    # These are summations of species parameters weighted by stoichiometry.\n    delta_v0 = sum(nu[s] * species_params[s]['v0'] for s in species_params)\n    delta_m = sum(nu[s] * species_params[s]['m'] for s in species_params)\n    delta_k = sum(nu[s] * species_params[s]['k'] for s in species_params)\n\n    # 2. Define a function to calculate K at a given pressure P\n    def calculate_K(P_bar):\n        \"\"\"\n        Calculates the equilibrium constant K at a given pressure P.\n\n        Args:\n            P_bar (float): The target pressure in bar.\n\n        Returns:\n            float: The dimensionless equilibrium constant K.\n        \"\"\"\n        # The change in Gibbs energy due to pressure is the integral of\n        # Delta_V_rxn from P_ref to P.\n        # Delta G_P = integral(Delta_v0 + Delta_m*(P'-P_ref) + Delta_k/(omega+P')) dP'\n        \n        # Analytically integrated terms\n        p_diff = P_bar - P_ref\n        \n        term1 = delta_v0 * p_diff\n        term2 = 0.5 * delta_m * p_diff**2\n        \n        # Handle the logarithm term carefully to avoid log(1) issues if P=P_ref\n        if P_bar == P_ref:\n            term3 = 0.0\n        else:\n            term3 = delta_k * np.log((omega + P_bar) / (omega + P_ref))\n        \n        # Total pressure correction in cm^3*bar/mol\n        delta_G_P_units = term1 + term2 + term3\n        \n        # Convert pressure correction from cm^3*bar/mol to J/mol\n        # 1 cm^3*bar = (1e-6 m^3) * (1e5 Pa) = 0.1 J\n        delta_G_P_J_mol = delta_G_P_units * 0.1\n        \n        # Calculate final Gibbs energy at pressure P\n        G_rxn_final = G_rxn_ref + delta_G_P_J_mol\n        \n        # Calculate the equilibrium constant K\n        # K = exp(-Delta_G_rxn / (R*T))\n        RT = R * T\n        K = np.exp(-G_rxn_final / RT)\n        \n        return K\n\n    # --- Test Suite Execution ---\n    \n    # Define the test cases from the problem statement\n    test_cases_P = [\n        500.0,   # Case 1: Target hydrothermal condition\n        1.0,     # Case 2: Boundary condition at reference pressure\n        3000.0   # Case 3: High-pressure edge case\n    ]\n\n    results = []\n    for P in test_cases_P:\n        K_val = calculate_K(P)\n        results.append(K_val)\n\n    # --- Final Output ---\n    # The final print statement must be in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}