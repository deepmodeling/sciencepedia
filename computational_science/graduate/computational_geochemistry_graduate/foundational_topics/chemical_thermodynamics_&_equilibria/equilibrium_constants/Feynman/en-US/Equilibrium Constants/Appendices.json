{
    "hands_on_practices": [
        {
            "introduction": "Geochemical databases often tabulate equilibrium constants for elementary reactions. This practice hones a fundamental skill: constructing the equilibrium constant for a complex overall reaction by combining these elementary steps. You will validate this procedure using the additive nature of the standard Gibbs free energy, $\\Delta_r G^\\circ$, reinforcing the deep connection between these two thermodynamic quantities .",
            "id": "4078814",
            "problem": "At temperature $T=298.15$ K and pressure $P=1$ bar, consider aqueous carbonate complexation of magnesium under the molality-based standard state for aqueous species (unit activity at $1$ molal with the infinite-dilution convention). Two constituent association reactions are provided from a geochemical database, with their equilibrium constants as dimensionless quantities referenced to this standard state:\n(1) $\\mathrm{Mg^{2+}} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{MgCO_3^{0}}$ with $K_1 = 10^{2.90}$,\n(2) $\\mathrm{MgCO_3^{0}} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{Mg(CO_3)_2^{2-}}$ with $K_2 = 10^{1.40}$.\nConstruct a reaction pathway to obtain the composite reaction $\\mathrm{Mg^{2+}} + 2\\,\\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{Mg(CO_3)_2^{2-}}$ and compute its overall equilibrium constant $K_{\\mathrm{overall}}$ using only the provided constituent reactions. Then, using fundamental thermodynamic relationships between standard molal reaction Gibbs energies and equilibrium constants together with the additivity of standard molal reaction Gibbs energies for summed reactions, validate that the $K_{\\mathrm{overall}}$ you computed is consistent with the addition of the constituent standard molal reaction Gibbs energies at $T=298.15$ K. State any standard-state assumptions you use in your reasoning.\nReport the final value of $K_{\\mathrm{overall}}$ as a dimensionless number rounded to four significant figures.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, and objective. It is a standard exercise in chemical thermodynamics involving aqueous equilibria, which is a core topic in computational geochemistry. All necessary information is provided, and the problem is internally consistent.\n\nThe first step is to derive the composite reaction from the two given constituent reactions. The provided reactions are:\n(1) $\\mathrm{Mg^{2+}} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{MgCO_3^{0}}$ with an equilibrium constant $K_1 = 10^{2.90}$.\n(2) $\\mathrm{MgCO_3^{0}} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{Mg(CO_3)_2^{2-}}$ with an equilibrium constant $K_2 = 10^{1.40}$.\n\nThe target reaction is $\\mathrm{Mg^{2+}} + 2\\,\\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{Mg(CO_3)_2^{2-}}$. We can obtain this reaction by summing reaction (1) and reaction (2):\n$$ (\\mathrm{Mg^{2+}} + \\mathrm{CO_3^{2-}}) + (\\mathrm{MgCO_3^{0}} + \\mathrm{CO_3^{2-}}) \\rightleftharpoons (\\mathrm{MgCO_3^{0}}) + (\\mathrm{Mg(CO_3)_2^{2-}}) $$\nCombining terms on each side gives:\n$$ \\mathrm{Mg^{2+}} + 2\\,\\mathrm{CO_3^{2-}} + \\mathrm{MgCO_3^{0}} \\rightleftharpoons \\mathrm{MgCO_3^{0}} + \\mathrm{Mg(CO_3)_2^{2-}} $$\nThe species $\\mathrm{MgCO_3^{0}}$ appears on both the reactant and product sides, acting as an intermediate. It can be cancelled from the equation, yielding the desired composite reaction:\n$$ \\mathrm{Mg^{2+}} + 2\\,\\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{Mg(CO_3)_2^{2-}} $$\nThe rule for combining equilibrium constants for summed reactions is that the overall equilibrium constant, $K_{\\mathrm{overall}}$, is the product of the individual equilibrium constants. Therefore:\n$$ K_{\\mathrm{overall}} = K_1 \\times K_2 $$\nSubstituting the given values:\n$$ K_{\\mathrm{overall}} = 10^{2.90} \\times 10^{1.40} $$\nUsing the property of exponents $x^a \\times x^b = x^{a+b}$:\n$$ K_{\\mathrm{overall}} = 10^{(2.90 + 1.40)} = 10^{4.30} $$\n\nNext, we validate this result using the relationship between the standard molal reaction Gibbs energy, $\\Delta_r G^\\circ$, and the equilibrium constant, $K$. This fundamental relationship is:\n$$ \\Delta_r G^\\circ = -RT \\ln K $$\nwhere $R$ is the universal gas constant and $T$ is the absolute temperature. The equilibrium constant $K$ is a dimensionless quantity representing the reaction's activity quotient at equilibrium. The validity of this equation relies on a consistently defined standard state for all substances, which is given in the problem.\n\nFor the two constituent reactions, we can write their standard molal Gibbs energies as:\n$$ \\Delta_{r,1} G^\\circ = -RT \\ln K_1 $$\n$$ \\Delta_{r,2} G^\\circ = -RT \\ln K_2 $$\nFor the overall reaction, the standard molal Gibbs energy is:\n$$ \\Delta_{r, \\mathrm{overall}} G^\\circ = -RT \\ln K_{\\mathrm{overall}} $$\nAccording to the principle of additivity of thermodynamic state functions (an application of Hess's Law), the standard Gibbs energy of an overall reaction is the sum of the standard Gibbs energies of the reactions that are summed to produce it. Thus:\n$$ \\Delta_{r, \\mathrm{overall}} G^\\circ = \\Delta_{r,1} G^\\circ + \\Delta_{r,2} G^\\circ $$\nSubstituting the expressions in terms of equilibrium constants:\n$$ -RT \\ln K_{\\mathrm{overall}} = (-RT \\ln K_1) + (-RT \\ln K_2) $$\n$$ -RT \\ln K_{\\mathrm{overall}} = -RT (\\ln K_1 + \\ln K_2) $$\nSince $R$ and $T$ are non-zero, we can divide both sides by $-RT$:\n$$ \\ln K_{\\mathrm{overall}} = \\ln K_1 + \\ln K_2 $$\nUsing the logarithmic property $\\ln a + \\ln b = \\ln(ab)$:\n$$ \\ln K_{\\mathrm{overall}} = \\ln(K_1 K_2) $$\nBy taking the exponential of both sides, we confirm the relationship used earlier:\n$$ K_{\\mathrm{overall}} = K_1 K_2 $$\nThis demonstrates that multiplying the equilibrium constants is thermodynamically consistent with the addition of standard molal reaction Gibbs energies.\n\nThe standard-state assumptions used in this reasoning must be explicitly stated.\n$1$. The core assumption is the consistent use of the specified standard state for all aqueous species: the molality-based standard state where the activity of a solute is unity for a hypothetical $1$ molal solution that behaves as if it were infinitely dilute. The dimensionless equilibrium constants $K_1$, $K_2$, and $K_{\\mathrm{overall}}$ and the standard molal Gibbs energies $\\Delta_r G^\\circ$ are all defined relative to this convention.\n$2$. It is also implicitly assumed that the standard state for the solvent (water, $\\mathrm{H_2O}$) is that of the pure liquid at the system temperature ($T=298.15$ K) and pressure ($P=1$ bar). In this standard state, the activity of water is defined as unity ($a_{\\mathrm{H_2O}} = 1$), which is a reasonable approximation for the dilute aqueous solutions where these equilibria are relevant.\n\nFinally, we compute the numerical value for $K_{\\mathrm{overall}}$ and round it to four significant figures as requested.\n$$ K_{\\mathrm{overall}} = 10^{4.30} \\approx 19952.6231 $$\nRounding this value to four significant figures gives $19950$. To express this unambiguously with four significant figures, we use scientific notation:\n$$ K_{\\mathrm{overall}} = 1.995 \\times 10^4 $$",
            "answer": "$$\\boxed{1.995 \\times 10^{4}}$$"
        },
        {
            "introduction": "Thermodynamic equilibrium constants are defined in terms of activities, but experimental measurements often yield concentrations. This exercise explores the crucial bridge between these two worlds: the activity coefficient, which accounts for non-ideal interactions in solution. By applying the Debye-Hückel model, you will quantify how ionic strength and charge asymmetry cause the conditional (concentration-based) constant to deviate from the true thermodynamic constant .",
            "id": "4078818",
            "problem": "An aqueous geochemical system at $25^{\\circ}\\mathrm{C}$ and bulk ionic strength $I = 0.10$ (molality scale) contains sodium and carbonate that form the monovalent complex $\\mathrm{NaCO_3^-}$ via the reaction\n$$\\mathrm{Na^+} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{NaCO_3^-}.$$\nThe thermodynamic equilibrium constant at the standard reference state (infinite dilution, $1$ bar), defined in terms of activities, is $K^{\\circ} = 10^{1.50}$ (dimensionless). Using Debye–Hückel theory for activity coefficients at $25^{\\circ}\\mathrm{C}$ with constants $A = 0.509$ and $B = 0.328\\,\\text{\\AA}^{-1}$, and effective ion-size parameters $a_{\\mathrm{Na^+}} = 4.0\\,\\text{\\AA}$, $a_{\\mathrm{CO_3^{2-}}} = 4.5\\,\\text{\\AA}$, and $a_{\\mathrm{NaCO_3^-}} = 5.0\\,\\text{\\AA}$, determine the conditional equilibrium constant $K_c$ that would be inferred if concentrations (molalities) were used in place of activities at $I = 0.10$, thereby quantifying the impact of valence asymmetry (divalent $\\mathrm{CO_3^{2-}}$ versus monovalent $\\mathrm{Na^+}$ and $\\mathrm{NaCO_3^-}$) on the apparent equilibrium.\n\nExpress the final $K_c$ as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem is deemed valid as it is scientifically grounded in established principles of aqueous geochemistry (Debye-Hückel theory), is well-posed with all necessary data provided, and is expressed in objective, unambiguous language.\n\nThe thermodynamic equilibrium constant, $K^{\\circ}$, for the reaction\n$$ \\mathrm{Na^+} + \\mathrm{CO_3^{2-}} \\rightleftharpoons \\mathrm{NaCO_3^-} $$\nis defined in terms of the activities, $a_i$, of the participating species:\n$$ K^{\\circ} = \\frac{a_{\\mathrm{NaCO_3^-}}}{a_{\\mathrm{Na^+}} a_{\\mathrm{CO_3^{2-}}}} $$\nThe activity of a species $i$ is related to its molality, $m_i$, and its activity coefficient, $\\gamma_i$, by the expression $a_i = \\gamma_i m_i$. Substituting this into the definition of $K^{\\circ}$ yields:\n$$ K^{\\circ} = \\frac{\\gamma_{\\mathrm{NaCO_3^-}} m_{\\mathrm{NaCO_3^-}}}{(\\gamma_{\\mathrm{Na^+}} m_{\\mathrm{Na^+}}) (\\gamma_{\\mathrm{CO_3^{2-}}} m_{\\mathrm{CO_3^{2-}}})} $$\nThe conditional equilibrium constant, $K_c$, is defined using molalities instead of activities:\n$$ K_c = \\frac{m_{\\mathrm{NaCO_3^-}}}{m_{\\mathrm{Na^+}} m_{\\mathrm{CO_3^{2-}}}} $$\nBy combining these expressions, we can relate $K_c$ to $K^{\\circ}$:\n$$ K^{\\circ} = K_c \\cdot \\frac{\\gamma_{\\mathrm{NaCO_3^-}}}{\\gamma_{\\mathrm{Na^+}} \\gamma_{\\mathrm{CO_3^{2-}}}} $$\nRearranging to solve for $K_c$ gives:\n$$ K_c = K^{\\circ} \\cdot \\frac{\\gamma_{\\mathrm{Na^+}} \\gamma_{\\mathrm{CO_3^{2-}}}}{\\gamma_{\\mathrm{NaCO_3^-}}} $$\nTo find $K_c$, we must first calculate the activity coefficients for the three ionic species at the specified ionic strength, $I = 0.10$. The problem specifies the use of the extended Debye-Hückel equation:\n$$ \\log_{10}(\\gamma_i) = -\\frac{A z_i^2 \\sqrt{I}}{1 + B a_i \\sqrt{I}} $$\nwhere $z_i$ is the charge of ion $i$, $a_i$ is its effective ion-size parameter, and $A$ and $B$ are temperature-dependent constants. The given parameters are:\n- $A = 0.509$\n- $B = 0.328\\,\\text{\\AA}^{-1}$\n- $I = 0.10$ m, so $\\sqrt{I} = \\sqrt{0.10} \\approx 0.316228$\n- $K^{\\circ} = 10^{1.50}$, which implies $\\log_{10}(K^{\\circ}) = 1.50$\n\nThe ion-specific parameters are:\n- For $\\mathrm{Na^+}$: $z_{\\mathrm{Na^+}} = +1$, $a_{\\mathrm{Na^+}} = 4.0\\,\\text{\\AA}$\n- For $\\mathrm{CO_3^{2-}}$: $z_{\\mathrm{CO_3^{2-}}} = -2$, $a_{\\mathrm{CO_3^{2-}}} = 4.5\\,\\text{\\AA}$\n- For $\\mathrm{NaCO_3^-}$: $z_{\\mathrm{NaCO_3^-}} = -1$, $a_{\\mathrm{NaCO_3^-}} = 5.0\\,\\text{\\AA}$\n\nWe now compute the logarithm of the activity coefficient for each species.\n\nFor $\\mathrm{Na^+}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{Na^+}}) = -\\frac{(0.509) (+1)^2 \\sqrt{0.10}}{1 + (0.328) (4.0) \\sqrt{0.10}} = -\\frac{0.509 \\times 0.316228}{1 + 1.312 \\times 0.316228} = -\\frac{0.160960}{1.41484} \\approx -0.113766 $$\n\nFor $\\mathrm{CO_3^{2-}}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{CO_3^{2-}}}) = -\\frac{(0.509) (-2)^2 \\sqrt{0.10}}{1 + (0.328) (4.5) \\sqrt{0.10}} = -\\frac{4 \\times 0.509 \\times 0.316228}{1 + 1.476 \\times 0.316228} = -\\frac{0.643841}{1.46672} \\approx -0.439008 $$\n\nFor $\\mathrm{NaCO_3^-}$:\n$$ \\log_{10}(\\gamma_{\\mathrm{NaCO_3^-}}) = -\\frac{(0.509) (-1)^2 \\sqrt{0.10}}{1 + (0.328) (5.0) \\sqrt{0.10}} = -\\frac{0.509 \\times 0.316228}{1 + 1.640 \\times 0.316228} = -\\frac{0.160960}{1.51861} \\approx -0.105992 $$\n\nTo find $K_c$, it is most accurate to work with logarithms:\n$$ \\log_{10}(K_c) = \\log_{10}(K^{\\circ}) + \\log_{10}(\\gamma_{\\mathrm{Na^+}}) + \\log_{10}(\\gamma_{\\mathrm{CO_3^{2-}}}) - \\log_{10}(\\gamma_{\\mathrm{NaCO_3^-}}) $$\nSubstituting the values:\n$$ \\log_{10}(K_c) \\approx 1.50 + (-0.113766) + (-0.439008) - (-0.105992) $$\n$$ \\log_{10}(K_c) \\approx 1.50 - 0.113766 - 0.439008 + 0.105992 $$\n$$ \\log_{10}(K_c) \\approx 1.053218 $$\nNow, we calculate $K_c$:\n$$ K_c = 10^{\\log_{10}(K_c)} \\approx 10^{1.053218} \\approx 11.3023 $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ K_c \\approx 11.30 $$\nThe significant departure of $K_c$ from $K^{\\circ}$ ($11.30$ versus $10^{1.50} \\approx 31.62$) highlights the substantial effect of non-ideal behavior in this system, driven primarily by the high charge of the carbonate ion ($z = -2$), which results in a much lower activity coefficient compared to the monovalent ions.",
            "answer": "$$\\boxed{11.30}$$"
        },
        {
            "introduction": "Beyond solution composition, pressure profoundly influences chemical equilibria, especially in hydrothermal and deep-earth settings. This advanced practice moves into computational modeling, asking you to calculate the pressure dependence of an equilibrium constant using a model inspired by the Helgeson-Kirkham-Flowers (HKF) formalism. You will implement the integration of the reaction's partial molar volume to correct the Gibbs free energy, a core technique for predicting geochemistry at extreme conditions .",
            "id": "4078762",
            "problem": "You are tasked with implementing a program that computes the equilibrium constant as a function of temperature and pressure for a specified hydrothermal redox reaction by incorporating pressure-dependent partial molar volumes described by the Helgeson–Kirkham–Flowers (HKF) equations of state. Begin from fundamental thermodynamic relations, not prepackaged shortcut formulas, and derive the connection between the equilibrium constant and the reaction Gibbs energy under non-ideal pressure. Use the following scientifically sound and self-consistent scenario and data, and enforce all unit conversions precisely.\n\nGiven reaction and conditions:\n- Hydrothermal redox reaction: $\\mathrm{H_2(aq)} + \\tfrac{1}{2}\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{H_2O(l)}$.\n- Target temperature: $T = 673.15\\,\\mathrm{K}$ (which corresponds to $400\\,^{\\circ}\\mathrm{C}$).\n- Reference pressure: $P_\\mathrm{ref} = 1\\,\\mathrm{bar}$.\n- Solvent HKF parameter: $\\omega = 2600\\,\\mathrm{bar}$.\n- Standard reaction Gibbs energy at $T$ and $P_\\mathrm{ref}$: $\\Delta G_\\mathrm{rxn}(T,P_\\mathrm{ref}) = -2.20\\times 10^{5}\\,\\mathrm{J\\,mol^{-1}}$.\n\nPressure-dependent partial molar volumes (HKF-style surrogate functional form at infinite dilution):\nFor each species $i$, the partial molar volume as a function of pressure at fixed $T$ is given by\n$$\n\\bar{V}_i(T,P) = v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P},\n$$\nwhere $v_{0,i}$ has units $\\mathrm{cm^3\\,mol^{-1}}$, $m_i$ has units $\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$, and $k_i$ has units $\\mathrm{cm^3\\,mol^{-1}\\,bar}$. This surrogate captures the salient pressure dependence implied by HKF-type behavior through an inverse $(\\omega + P)$ term and low-order compressibility contributions.\n\nSpecies parameters (at $T = 673.15\\,\\mathrm{K}$):\n- For $\\mathrm{H_2(aq)}$: $v_{0,\\mathrm{H_2}} = 23.0\\,\\mathrm{cm^3\\,mol^{-1}}$, $m_{\\mathrm{H_2}} = -1.0\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$, $k_{\\mathrm{H_2}} = 600.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$.\n- For $\\mathrm{O_2(aq)}$: $v_{0,\\mathrm{O_2}} = 30.0\\,\\mathrm{cm^3\\,mol^{-1}}$, $m_{\\mathrm{O_2}} = -1.2\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$, $k_{\\mathrm{O_2}} = 500.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$.\n- For $\\mathrm{H_2O(l)}$: $v_{0,\\mathrm{H_2O}} = 26.0\\,\\mathrm{cm^3\\,mol^{-1}}$, $m_{\\mathrm{H_2O}} = -0.8\\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$, $k_{\\mathrm{H_2O}} = 400.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$.\n\nStoichiometric coefficients $\\nu_i$ for the reaction Gibbs energy sum:\n- $\\nu_{\\mathrm{H_2O}} = +1$, $\\nu_{\\mathrm{H_2}} = -1$, $\\nu_{\\mathrm{O_2}} = -\\tfrac{1}{2}$.\n\nFundamental base to be used in your derivation and implementation:\n- The equilibrium condition relates the equilibrium constant to the reaction Gibbs energy built from the standard chemical potentials (activities at infinite dilution).\n- At fixed temperature, the pressure derivative of the chemical potential of species $i$ equals its partial molar volume, i.e., $\\left(\\partial \\mu_i / \\partial P\\right)_T = \\bar{V}_i(T,P)$.\n- The reaction Gibbs energy pressure dependence follows from integrating species contributions weighted by stoichiometry.\n\nRequirements and units:\n- Implement the calculation of $\\Delta G_\\mathrm{rxn}(T,P)$ at a given $P$ by integrating the pressure-dependent reaction partial molar volume from $P_\\mathrm{ref}$ to $P$. Carefully convert units: use $\\mathrm{bar}$ for pressure in the pressure integration, but convert the integrated $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ term to $\\mathrm{J\\,mol^{-1}}$ using $1\\,\\mathrm{bar} = 10^{5}\\,\\mathrm{Pa}$ and $1\\,\\mathrm{cm^3} = 10^{-6}\\,\\mathrm{m^3}$. Express the final equilibrium constant $K$ as a dimensionless float.\n- Use the universal gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Temperature $T$ is fixed at $673.15\\,\\mathrm{K}$; no temperature integration is required.\n\nTest suite:\nCompute the equilibrium constant $K(T,P)$ for the following pressures (in $\\mathrm{bar}$):\n- Case $1$: $P = 500.0$ (target hydrothermal condition).\n- Case $2$: $P = 1.0$ (boundary condition at the reference pressure).\n- Case $3$: $P = 3000.0$ (high-pressure edge case well above $\\omega$ scale).\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\left[\\mathrm{result_1},\\mathrm{result_2},\\mathrm{result_3}\\right]$, where each entry is the computed $K(T,P)$ for the corresponding test case as a floating-point number with standard Python formatting. No other text should be printed.",
            "solution": "The problem is valid as it is scientifically grounded in fundamental thermodynamics, well-posed with all necessary data, and objectively stated. We will proceed with a step-by-step derivation and solution.\n\nThe core of the problem is to determine the equilibrium constant, $K$, for a chemical reaction at a specified temperature, $T$, and pressure, $P$. The fundamental relationship between the equilibrium constant and the standard Gibbs energy of reaction, $\\Delta G^\\circ_\\mathrm{rxn}$, is given by:\n$$\n\\Delta G^\\circ_\\mathrm{rxn}(T, P) = - R T \\ln K(T, P)\n$$\nwhere $R$ is the universal gas constant. For aqueous species at infinite dilution, the reaction Gibbs energy, $\\Delta G_\\mathrm{rxn}$, takes the role of the standard state value. Thus, we have:\n$$\n\\Delta G_\\mathrm{rxn}(T, P) = - R T \\ln K(T, P)\n$$\nOur primary task is to calculate $\\Delta G_\\mathrm{rxn}$ at the target pressure $P$, given its value at a reference pressure $P_\\mathrm{ref}$.\n\nThe pressure dependence of the Gibbs energy of a system at constant temperature is described by the fundamental thermodynamic relation:\n$$\n\\left( \\frac{\\partial G}{\\partial P} \\right)_T = V\n$$\nApplying this to the chemical potential, $\\mu_i$, and partial molar volume, $\\bar{V}_i$, of an individual species $i$:\n$$\n\\left( \\frac{\\partial \\mu_i}{\\partial P} \\right)_T = \\bar{V}_i(T, P)\n$$\nThe Gibbs energy of reaction is the sum of the chemical potentials of products minus reactants, weighted by their stoichiometric coefficients, $\\nu_i$:\n$$\n\\Delta G_\\mathrm{rxn} = \\sum_i \\nu_i \\mu_i\n$$\nDifferentiating with respect to pressure at constant temperature yields the pressure dependence of the reaction Gibbs energy:\n$$\n\\left( \\frac{\\partial \\Delta G_\\mathrm{rxn}}{\\partial P} \\right)_T = \\sum_i \\nu_i \\left( \\frac{\\partial \\mu_i}{\\partial P} \\right)_T = \\sum_i \\nu_i \\bar{V}_i(T, P) = \\Delta \\bar{V}_\\mathrm{rxn}(T, P)\n$$\nwhere $\\Delta \\bar{V}_\\mathrm{rxn}$ is the reaction partial molar volume.\n\nTo find $\\Delta G_\\mathrm{rxn}$ at a target pressure $P$, we integrate this expression from the reference pressure $P_\\mathrm{ref}$ to $P$:\n$$\n\\int_{P_\\mathrm{ref}}^{P} d(\\Delta G_\\mathrm{rxn}) = \\int_{P_\\mathrm{ref}}^{P} \\Delta \\bar{V}_\\mathrm{rxn}(T, P') dP'\n$$\nThis gives the relationship:\n$$\n\\Delta G_\\mathrm{rxn}(T, P) - \\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) = \\int_{P_\\mathrm{ref}}^{P} \\Delta \\bar{V}_\\mathrm{rxn}(T, P') dP'\n$$\n$$\n\\Delta G_\\mathrm{rxn}(T, P) = \\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) + \\int_{P_\\mathrm{ref}}^{P} \\Delta \\bar{V}_\\mathrm{rxn}(T, P') dP'\n$$\nThe integral term represents the correction to the Gibbs energy due to the change in pressure from $P_\\mathrm{ref}$ to $P$.\n\nFirst, we must construct the expression for the reaction partial molar volume, $\\Delta \\bar{V}_\\mathrm{rxn}(T, P)$, from the given species-specific functional forms: $\\bar{V}_i(T,P) = v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P}$.\n$$\n\\Delta \\bar{V}_\\mathrm{rxn}(T, P) = \\sum_i \\nu_i \\bar{V}_i = \\sum_i \\nu_i \\left( v_{0,i} + m_i\\,(P - P_\\mathrm{ref}) + \\frac{k_i}{\\omega + P} \\right)\n$$\nWe define the reaction parameters $\\Delta v_0$, $\\Delta m$, and $\\Delta k$ as follows:\n$$\n\\Delta v_0 = \\sum_i \\nu_i v_{0,i} \\quad ; \\quad \\Delta m = \\sum_i \\nu_i m_i \\quad ; \\quad \\Delta k = \\sum_i \\nu_i k_i\n$$\nThe reaction is $\\mathrm{H_2(aq)} + \\tfrac{1}{2}\\,\\mathrm{O_2(aq)} \\rightarrow \\mathrm{H_2O(l)}$, with stoichiometric coefficients $\\nu_{\\mathrm{H_2O}} = +1$, $\\nu_{\\mathrm{H_2}} = -1$, and $\\nu_{\\mathrm{O_2}} = -1/2$. Using the provided parameters:\n$$\n\\Delta v_0 = (1)(26.0) + (-1)(23.0) + (-0.5)(30.0) = 26.0 - 23.0 - 15.0 = -12.0\\,\\mathrm{cm^3\\,mol^{-1}}\n$$\n$$\n\\Delta m = (1)(-0.8 \\times 10^{-3}) + (-1)(-1.0 \\times 10^{-3}) + (-0.5)(-1.2 \\times 10^{-3}) = (-0.8 + 1.0 + 0.6) \\times 10^{-3} = 0.8 \\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}\n$$\n$$\n\\Delta k = (1)(400.0) + (-1)(600.0) + (-0.5)(500.0) = 400.0 - 600.0 - 250.0 = -450.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\nSo, the reaction partial molar volume is:\n$$\n\\Delta \\bar{V}_\\mathrm{rxn}(T, P) = \\Delta v_0 + \\Delta m (P - P_\\mathrm{ref}) + \\frac{\\Delta k}{\\omega + P}\n$$\n\nNext, we evaluate the pressure integral term, which we denote as $\\Delta G_P$:\n$$\n\\Delta G_P = \\int_{P_\\mathrm{ref}}^{P} \\left( \\Delta v_0 + \\Delta m (P' - P_\\mathrm{ref}) + \\frac{\\Delta k}{\\omega + P'} \\right) dP'\n$$\nIntegrating each term analytically:\n$$\n\\Delta G_P = \\left[ \\Delta v_0 P' \\right]_{P_\\mathrm{ref}}^{P} + \\left[ \\frac{\\Delta m}{2} (P' - P_\\mathrm{ref})^2 \\right]_{P_\\mathrm{ref}}^{P} + \\left[ \\Delta k \\ln(\\omega + P') \\right]_{P_\\mathrm{ref}}^{P}\n$$\n$$\n\\Delta G_P = \\Delta v_0 (P - P_\\mathrm{ref}) + \\frac{\\Delta m}{2} (P - P_\\mathrm{ref})^2 + \\Delta k \\ln \\left( \\frac{\\omega + P}{\\omega + P_\\mathrm{ref}} \\right)\n$$\nThis expression gives the pressure correction in units of $\\mathrm{cm^3\\,mol^{-1}\\,bar}$. We must convert this to $\\mathrm{J\\,mol^{-1}}$ using the given conversion factors: $1\\,\\mathrm{bar} = 10^5\\,\\mathrm{Pa}$ and $1\\,\\mathrm{cm^3} = 10^{-6}\\,\\mathrm{m^3}$.\n$$\n1\\,\\mathrm{cm^3\\,bar} = (10^{-6}\\,\\mathrm{m^3}) \\times (10^5\\,\\mathrm{Pa}) = 10^{-1}\\,\\mathrm{m^3\\,Pa} = 0.1\\,\\mathrm{J}\n$$\nSo, the Gibbs energy correction in Joules per mole is $0.1$ times the value of the integral expression.\n\nThe complete expression for the Gibbs energy of reaction at pressure $P$ is:\n$$\n\\Delta G_\\mathrm{rxn}(T, P) = \\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) + 0.1 \\times \\left[ \\Delta v_0 (P - P_\\mathrm{ref}) + \\frac{\\Delta m}{2} (P - P_\\mathrm{ref})^2 + \\Delta k \\ln \\left( \\frac{\\omega + P}{\\omega + P_\\mathrm{ref}} \\right) \\right]\n$$\nFinally, we can calculate the equilibrium constant $K(T, P)$:\n$$\nK(T, P) = \\exp \\left( - \\frac{\\Delta G_\\mathrm{rxn}(T, P)}{R T} \\right)\n$$\nWe have all the necessary constants and parameters:\n- $T = 673.15\\,\\mathrm{K}$\n- $P_\\mathrm{ref} = 1.0\\,\\mathrm{bar}$\n- $\\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) = -2.20 \\times 10^5\\,\\mathrm{J\\,mol^{-1}}$\n- $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- $\\omega = 2600.0\\,\\mathrm{bar}$\n- $\\Delta v_0 = -12.0\\,\\mathrm{cm^3\\,mol^{-1}}$\n- $\\Delta m = 0.8 \\times 10^{-3}\\,\\mathrm{cm^3\\,mol^{-1}\\,bar^{-1}}$\n- $\\Delta k = -450.0\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}$\n\nWe will now implement this logic to compute the equilibrium constant $K$ for the three specified pressures. For each pressure $P$, we will calculate the pressure correction term, add it to $\\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref})$ to obtain $\\Delta G_\\mathrm{rxn}(T, P)$, and then use the final Gibbs energy to find $K$.\n\nFor case 1 where $P = 500.0\\,\\mathrm{bar}$:\nThe pressure correction term in units of $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ is:\n$$\n\\Delta G_P = (-12.0)(500-1) + \\frac{0.8\\times 10^{-3}}{2}(500-1)^2 + (-450.0)\\ln\\left(\\frac{2600+500}{2600+1}\\right) \\approx -5967.38\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\nIn $\\mathrm{J\\,mol^{-1}}$, this is $-596.74\\,\\mathrm{J\\,mol^{-1}}$.\n$$\n\\Delta G_\\mathrm{rxn}(T, 500\\,\\mathrm{bar}) = -220000 - 596.74 = -220596.74\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 500\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-220596.74}{8.314462618 \\times 673.15}\\right)\n$$\n\nFor case 2 where $P = 1.0\\,\\mathrm{bar}$:\nSince $P = P_\\mathrm{ref}$, the pressure correction integral is zero.\n$$\n\\Delta G_\\mathrm{rxn}(T, 1\\,\\mathrm{bar}) = \\Delta G_\\mathrm{rxn}(T, P_\\mathrm{ref}) = -220000\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 1\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-220000}{8.314462618 \\times 673.15}\\right)\n$$\n\nFor case 3 where $P = 3000.0\\,\\mathrm{bar}$:\nThe pressure correction term in units of $\\mathrm{cm^3\\,mol^{-1}\\,bar}$ is:\n$$\n\\Delta G_P = (-12.0)(3000-1) + \\frac{0.8\\times 10^{-3}}{2}(3000-1)^2 + (-450.0)\\ln\\left(\\frac{2600+3000}{2600+1}\\right) \\approx -32735.49\\,\\mathrm{cm^3\\,mol^{-1}\\,bar}\n$$\nIn $\\mathrm{J\\,mol^{-1}}$, this is $-3273.55\\,\\mathrm{J\\,mol^{-1}}$.\n$$\n\\Delta G_\\mathrm{rxn}(T, 3000\\,\\mathrm{bar}) = -220000 - 3273.55 = -223273.55\\,\\mathrm{J\\,mol^{-1}}\n$$\n$$\nK(T, 3000\\,\\mathrm{bar}) = \\exp\\left(-\\frac{-223273.55}{8.314462618 \\times 673.15}\\right)\n$$\nThe final code will perform these computations with full precision.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the equilibrium constant for a hydrothermal reaction as a function of pressure,\n    based on the Helgeson–Kirkham–Flowers (HKF) equations of state for partial molar volumes.\n    \"\"\"\n    \n    # --- Givens and Constants ---\n    \n    # Thermodynamic conditions and constants\n    T = 673.15  # Temperature in Kelvin (400 C)\n    P_ref = 1.0  # Reference pressure in bar\n    G_rxn_ref = -2.20e5  # Standard reaction Gibbs energy at T and P_ref (J/mol)\n    R = 8.314462618  # Universal gas constant (J/mol/K)\n    \n    # Solvent HKF parameter\n    omega = 2600.0  # Solvent HKF parameter (bar)\n    \n    # Stoichiometric coefficients for H2(aq) + 0.5*O2(aq) - H2O(l)\n    nu = {\n        'H2O': 1.0,\n        'H2': -1.0,\n        'O2': -0.5\n    }\n    \n    # Species parameters for partial molar volume at T\n    # v0: cm^3/mol\n    # m: cm^3/mol/bar\n    # k: cm^3*bar/mol\n    species_params = {\n        'H2':  {'v0': 23.0, 'm': -1.0e-3, 'k': 600.0},\n        'O2':  {'v0': 30.0, 'm': -1.2e-3, 'k': 500.0},\n        'H2O': {'v0': 26.0, 'm': -0.8e-3, 'k': 400.0}\n    }\n\n    # --- Derivation Implementation ---\n\n    # 1. Calculate reaction parameters (Delta_v0, Delta_m, Delta_k)\n    # These are summations of species parameters weighted by stoichiometry.\n    delta_v0 = sum(nu[s] * species_params[s]['v0'] for s in species_params)\n    delta_m = sum(nu[s] * species_params[s]['m'] for s in species_params)\n    delta_k = sum(nu[s] * species_params[s]['k'] for s in species_params)\n\n    # 2. Define a function to calculate K at a given pressure P\n    def calculate_K(P_bar):\n        \"\"\"\n        Calculates the equilibrium constant K at a given pressure P.\n\n        Args:\n            P_bar (float): The target pressure in bar.\n\n        Returns:\n            float: The dimensionless equilibrium constant K.\n        \"\"\"\n        # The change in Gibbs energy due to pressure is the integral of\n        # Delta_V_rxn from P_ref to P.\n        # Delta G_P = integral(Delta_v0 + Delta_m*(P'-P_ref) + Delta_k/(omega+P')) dP'\n        \n        # Analytically integrated terms\n        p_diff = P_bar - P_ref\n        \n        term1 = delta_v0 * p_diff\n        term2 = 0.5 * delta_m * p_diff**2\n        \n        # Handle the logarithm term carefully to avoid log(1) issues if P=P_ref\n        if P_bar == P_ref:\n            term3 = 0.0\n        else:\n            term3 = delta_k * np.log((omega + P_bar) / (omega + P_ref))\n        \n        # Total pressure correction in cm^3*bar/mol\n        delta_G_P_units = term1 + term2 + term3\n        \n        # Convert pressure correction from cm^3*bar/mol to J/mol\n        # 1 cm^3*bar = (1e-6 m^3) * (1e5 Pa) = 0.1 J\n        delta_G_P_J_mol = delta_G_P_units * 0.1\n        \n        # Calculate final Gibbs energy at pressure P\n        G_rxn_final = G_rxn_ref + delta_G_P_J_mol\n        \n        # Calculate the equilibrium constant K\n        # K = exp(-Delta_G_rxn / (R*T))\n        RT = R * T\n        K = np.exp(-G_rxn_final / RT)\n        \n        return K\n\n    # --- Test Suite Execution ---\n    \n    # Define the test cases from the problem statement\n    test_cases_P = [\n        500.0,   # Case 1: Target hydrothermal condition\n        1.0,     # Case 2: Boundary condition at reference pressure\n        3000.0   # Case 3: High-pressure edge case\n    ]\n\n    results = []\n    for P in test_cases_P:\n        K_val = calculate_K(P)\n        results.append(K_val)\n\n    # --- Final Output ---\n    # The final print statement must be in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}