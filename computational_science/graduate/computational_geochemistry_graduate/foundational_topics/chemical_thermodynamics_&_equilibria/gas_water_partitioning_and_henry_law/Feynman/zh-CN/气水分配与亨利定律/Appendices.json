{
    "hands_on_practices": [
        {
            "introduction": "亨利常数有多种表达形式，例如基于分压、摩尔浓度或质量摩尔浓度。在不同文献数据源和模型之间进行转换是一项基本技能。本练习将指导您如何将常见的浓度-压力亨利常数（$H_{cp}$）转换为无量纲的浓度比（$H_{cc}$），并阐明此转换背后的热力学假设，从而加深对理想气体定律在相平衡中作用的理解。",
            "id": "4080060",
            "problem": "一种痕量气体在等温条件下与纯水达到平衡。液相遵循亨利定律的无限稀释表述，其浓度-压力形式可以写成“水相摩尔浓度 $C_{w}$ 通过一个比例常数 $H_{cp}$ 与气相分压 $p$ 成正比”，而气相遵循理想气体定律 (IGL)。考虑在 $T=298\\ \\mathrm{K}$ 条件下的二氧化碳，其在此温度下的浓度-压力形式的亨利常数 $H_{cp}=3.30\\times 10^{-4}\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}\\ \\mathrm{Pa}^{-1}$。定义无量纲比率 $H_{cc}$ 为平衡时水相与气相的摩尔浓度之比，即 $H_{cc} \\equiv C_{w}/C_{a}$，其中 $C_{a}$ 是气相的摩尔浓度。\n\n仅从这些基本陈述（无限稀释条件下的亨利定律和理想气体定律）出发，推导出一个用 $H_{cp}$、$R$ 和 $T$ 表示 $H_{cc}$ 的解析表达式，然后针对所述条件下的二氧化碳，对 $H_{cc}$ 进行数值计算。使用普适摩尔气体常数 $R=8.314462618\\ \\mathrm{Pa}\\ \\mathrm{m}^{3}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$。将最终数值结果四舍五入至四位有效数字，并将其表示为一个不带单位标签的无量纲数。\n\n此外，请简要解释在计算地球化学实践中，为使从 $H_{cp}$ 到 $H_{cc}$ 的这种转换有效，需要满足哪些物理和热力学假设。",
            "solution": "问题陈述被评估为有效。它在科学上基于物理化学原理，特别是亨利定律和理想气体定律。该问题提法恰当，提供了推导解析表达式和计算唯一数值结果所需的所有定义、常数和条件。其语言客观，数据一致。\n\n主要任务是推导无量纲亨利常数 $H_{cc}$ 的表达式，并针对指定条件下的二氧化碳对其进行求值。次要任务是阐明此推导所依据的假设。\n\n无量纲亨利常数定义为水相摩尔浓度 $C_w$ 与气相摩尔浓度 $C_a$之比：\n$$\nH_{cc} \\equiv \\frac{C_w}{C_a}\n$$\n问题提供了控制各相浓度的两个基本定律。\n\n对于水相，给出了亨利定律的无限稀释形式：\n$$\nC_w = H_{cp} \\cdot p\n$$\n其中 $C_w$ 是水相中的摩尔浓度（单位为 $\\text{mol m}^{-3}$），$p$ 是液体上方气体的分压（单位为 $\\text{Pa}$），$H_{cp}$ 是浓度-压力形式的亨利定律常数（单位为 $\\text{mol m}^{-3} \\text{ Pa}^{-1}$）。\n\n对于气相，规定适用理想气体定律 (IGL)：\n$$\npV = nRT\n$$\n其中 $n$ 是气体的摩尔数，$V$ 是气相的体积（单位为 $\\text{m}^3$），$T$ 是绝对温度（单位为 $\\text{K}$），$R$ 是普适摩尔气体常数（单位为 $\\text{Pa m}^3 \\text{ mol}^{-1} \\text{ K}^{-1}$）。气体的摩尔浓度 $C_a$ 定义为单位体积的摩尔数，即 $C_a = n/V$。我们可以对理想气体定律进行重排以求解该浓度：\n$$\n\\frac{n}{V} = \\frac{p}{RT}\n$$\n因此，气相浓度为：\n$$\nC_a = \\frac{p}{RT}\n$$\n现在，我们可以将 $C_w$ 和 $C_a$ 的表达式代入 $H_{cc}$ 的定义中：\n$$\nH_{cc} = \\frac{C_w}{C_a} = \\frac{H_{cp} \\cdot p}{\\frac{p}{RT}}\n$$\n分压 $p$ 从分子和分母中约去，从而得出用 $H_{cp}$、$R$ 和 $T$ 表示 $H_{cc}$ 的所求解析表达式：\n$$\nH_{cc} = H_{cp} R T\n$$\n该表达式在量纲上是一致的，因为 $H_{cp}$、$R$ 和 $T$ 的单位之积为一个无量纲量：\n$$\n[\\text{mol} \\cdot \\text{m}^{-3} \\cdot \\text{Pa}^{-1}] \\cdot [\\text{Pa} \\cdot \\text{m}^{3} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}] \\cdot [\\text{K}] = 1\n$$\n接下来，我们使用所提供的 $T=298\\ \\mathrm{K}$ 时二氧化碳的数值来对该表达式进行数值计算：\n$H_{cp} = 3.30 \\times 10^{-4}\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}\\ \\mathrm{Pa}^{-1}$\n$R = 8.314462618\\ \\mathrm{Pa}\\ \\mathrm{m}^{3}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$\n$T = 298\\ \\mathrm{K}$\n\n将这些数值代入推导出的表达式：\n$$\nH_{cc} = (3.30 \\times 10^{-4}\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}\\ \\mathrm{Pa}^{-1}) \\times (8.314462618\\ \\mathrm{Pa}\\ \\mathrm{m}^{3}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}) \\times (298\\ \\mathrm{K})\n$$\n$$\nH_{cc} = 0.81764458...\n$$\n按要求将结果四舍五入至四位有效数字：\n$$\nH_{cc} \\approx 0.8176\n$$\n\n在计算地球化学实践中，为使从 $H_{cp}$ 到 $H_{cc}$ 的这种转换有效，需要满足的物理和热力学假设如下：\n\n1.  **热力学平衡**：假设系统处于热力学平衡状态，这意味着分配物种 ($CO_2$) 在气相和水相中的化学势相等 ($\\mu_{\\text{gas}} = \\mu_{\\text{aq}}$)。这表明系统已有足够的时间达到平衡，并且物种穿过相界的净通量为零。\n\n2.  **理想气体行为**：气相被视为理想气体。这等同于假设气体的逸度 $f_g$ 等于其分压 $p$。这个假设在低压（接近或低于 $1\\ \\text{atm}$）下通常是有效的，但在更高压力下，当分子间作用力和有限的分子体积不再可以忽略时，其准确性会降低。对于高压地球化学系统，必须引入逸度系数 $\\phi$ ($f_g = \\phi \\cdot p$)。\n\n3.  **无限稀释**：假设水溶液相对于溶解气体是无限稀释的。这意味着溶质的浓度足够低，以至于溶质-溶质之间的相互作用可以忽略不计。在热力学上，这意味着水相物种的活度系数为1 ($\\gamma_{aq} = 1$)，其活度 $a_{aq}$ 可以等同于其摩尔浓度（或质量摩尔浓度，取决于标准态）。其他溶解组分（特别是盐类）的存在会改变气体溶解度（“盐析效应”），这将需要对亨利常数进行校正。\n\n4.  **纯净且不可压缩的溶剂**：假设溶剂为纯水，其性质不受溶解气体的影响。同时假设它是不可压缩的，这对于典型地壳压力下的液态水来说是一个非常好的近似。\n\n5.  **等温系统**：假设温度 $T$ 在两相中都是恒定且均匀的。这是一个关键假设，因为亨利定律常数强烈依赖于温度。",
            "answer": "$$\\boxed{0.8176}$$"
        },
        {
            "introduction": "从单一的常数转换，我们现在进入一个更实际的挑战：构建一个综合性的溶解度预测模型。在真实地球化学系统中，温度、盐度和压力共同决定了气体的溶解度。本练习要求您开发一个计算程序，通过整合范特霍夫方程（van 't Hoff equation）来模拟温度效应，通过塞切诺夫关系（Setchenov relation）来处理盐度影响，并校正水蒸气压力，从而精确预测氧气在水中的溶解度。",
            "id": "4080044",
            "problem": "一位研究人员试图实现一个计算程序，用于预测在与大气接触的条件下，液态水中分子氧在任意温度、盐度和大气压力下的平衡溶解度。该实现必须基于适用于气体-水分配的基本热力学定义。该计算程序需要为指定的测试套件生成氧气溶解度，此外，还需对照一个小的嵌入式参考数据集报告一个验证指标。\n\n构建一个程序，对于下面定义的每个测试用例，使用以下第一性原理基础计算水中溶解氧的平衡浓度：\n\n- 使用浓度-压力形式的 Henry 定律，该定律定义了溶解浓度与气相热力学驱动力之间的平衡关系，写作 $c = k_{H}(T,S) \\, p_{\\mathrm{O_2}}^{\\mathrm{dry}}$，其中 $c$ 是溶解氧浓度（单位为 $\\mathrm{mol/m^3}$），$k_{H}(T,S)$ 是热力学溶解度系数（浓度形式的 Henry 常数），$p_{\\mathrm{O_2}}^{\\mathrm{dry}}$ 是界面处气相中氧气的干分压。\n- 大气压力 $P$ 包含水蒸气；因此，干分压为 $p_{\\mathrm{O_2}}^{\\mathrm{dry}} = y_{\\mathrm{O_2}} \\left(P - p_{\\mathrm{H_2O}}^{\\mathrm{sat}}(T)\\right)$，其中 $y_{\\mathrm{O_2}}$ 是大气中氧气的摩尔分数，$p_{\\mathrm{H_2O}}^{\\mathrm{sat}}(T)$ 是温度 $T$ 下水的饱和蒸气压。\n- $k_{H}$ 的温度依赖性必须通过平衡热力学，经由平衡常数的 van 't Hoff 关系式来表达，这给出了一个由溶解焓 $\\Delta H_{\\mathrm{sol}}$ 控制的对数温度依赖关系，即 $\\ln k_{H}(T) - \\ln k_{H}(T_{0}) = -\\dfrac{\\Delta H_{\\mathrm{sol}}}{R}\\left(\\dfrac{1}{T} - \\dfrac{1}{T_{0}}\\right)$，其中 $R$ 是普适气体常数，$T_{0}$ 是选定的参考温度。这反映了氧气在水中溶解的放热性质。\n- 盐度效应必须由 Setchenov 型“盐析”关系表示，采用其最简单的指数形式，其中溶解盐的存在会相对于纯水降低溶解度。一个合适的形式是 $k_{H}(T,S) = k_{H}(T,0) \\exp\\!\\left(-b\\,S\\right)$，其中 $S$ 是实用盐度单位 (PSU)，$b$ 是氧气在类海水盐水中的 Setchenov 系数。\n\n在您的实现中：\n- 使用 $y_{\\mathrm{O_2}} = 0.2095$作为大气中氧气的摩尔分数。\n- 使用 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 使用 $T_{0} = 298.15\\,\\mathrm{K}$ 作为参考温度。\n- 使用参考纯水溶解度系数 $k_{H}(T_{0},0)$，使得在 $T = T_{0}$、$S = 0$、$P = 101325\\,\\mathrm{Pa}$ 且 $p_{\\mathrm{H_2O}}^{\\mathrm{sat}}(T_{0})$ 在饱和状态下计算时，预测的 $c$ 值与广泛报道的 $25\\,^{\\circ}\\mathrm{C}$ 下与空气接触的淡水氧溶解度相匹配。设定 $k_{H}(T_{0},0) = 1.256\\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$。\n- 使用 $\\Delta H_{\\mathrm{sol}} = -16000\\,\\mathrm{J\\,mol^{-1}}$。\n- 使用 $b = 0.006$ 每 PSU。\n- 对于 $p_{\\mathrm{H_2O}}^{\\mathrm{sat}}(T)$，实现一个与国际水和水蒸气性质协会 (IAPWS) 1992 针对液态水的公式一致的、科学上公认的饱和蒸气压函数，并以 $\\mathrm{Pa}$ 为单位返回结果。\n\n您的程序不得接受任何输入，并且必须为以下测试套件计算结果。所有温度 $T$ 以 $\\mathrm{K}$ 给出，盐度 $S$ 以实用盐度单位 (PSU) 给出，大气压力 $P$ 以 $\\mathrm{Pa}$ 给出。要求的输出溶解氧浓度必须以 $\\mathrm{mol/m^3}$ 表示。\n\n带有嵌入式参考值 ($c_{\\mathrm{ref}}$) 的测试套件（单位为 $\\mathrm{mol/m^3}$）：\n- 用例 1 (一般情况): $T = 298.15$, $S = 0$, $P = 101325$, $c_{\\mathrm{ref}} = 0.258$。\n- 用例 2 (盐水、较冷): $T = 293.15$, $S = 35$, $P = 101325$, $c_{\\mathrm{ref}} = 0.228$。\n- 用例 3 (寒冷边界): $T = 273.15$, $S = 0$, $P = 101325$, $c_{\\mathrm{ref}} = 0.456$。\n- 用例 4 (低压边缘): $T = 283.15$, $S = 0$, $P = 81060$, $c_{\\mathrm{ref}} = 0.282$。\n- 用例 5 (暖盐水、高压): $T = 308.15$, $S = 35$, $P = 121590$, $c_{\\mathrm{ref}} = 0.214$。\n\n对于每个用例，计算：\n- 预测的平衡溶解氧浓度 $c$ (单位为 $\\mathrm{mol/m^3}$)。\n- 绝对相对验证误差 $e = \\left|\\dfrac{c - c_{\\mathrm{ref}}}{c_{\\mathrm{ref}}}\\right|$ (以小数形式)。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，该列表包含两个子列表：第一个子列表包含按上述顺序列出的五个用例的预测浓度（单位为 $\\mathrm{mol/m^3}$），第二个子列表包含相同用例的五个绝对相对误差。例如，打印的输出必须看起来像 $[[c_{1},c_{2},c_{3},c_{4},c_{5}],[e_{1},e_{2},e_{3},e_{4},e_{5}]]$.",
            "solution": "该问题要求构建一个计算模型，以预测水中溶解分子氧 ($O_2$) 的平衡浓度随温度、盐度和大气压力的变化。该模型必须基于基本热力学原理。随后，该模型将被实现在一个程序中，用于为一组指定的测试用例计算溶解氧浓度 $c$，并报告与所提供参考值的验证误差。\n\n建模方法基于对已建立的物理化学定律的分层应用，如下所述。\n\n核心关系是 Henry 定律，该定律指出，在平衡状态下，溶解气体的浓度与其在气相中的分压成正比。对于此问题，其形式为：\n$$\nc = k_{H}(T,S) \\, p_{\\mathrm{O_2}}^{\\mathrm{dry}}\n$$\n在此， $c$ 是溶解 $O_2$ 的摩尔浓度，单位为 $\\mathrm{mol/m^3}$，$p_{\\mathrm{O_2}}^{\\mathrm{dry}}$ 是氧气的干分压，单位为 $\\mathrm{Pa}$，$k_{H}(T,S)$ 是 Henry 定律溶解度系数，它是温度 $T$ (单位为 $\\mathrm{K}$) 和盐度 $S$ (单位为 PSU) 的函数。\n\n氧气的分压必须考虑气相中水蒸气的存在。总大气压力 $P$ 是干燥空气组分和水蒸气分压的总和。假设气相在界面处被水蒸气饱和，根据 Dalton 定律，氧气的干分压由下式给出：\n$$\np_{\\mathrm{O_2}}^{\\mathrm{dry}} = y_{\\mathrm{O_2}} \\left(P - p_{\\mathrm{H_2O}}^{\\mathrm{sat}}(T)\\right)\n$$\n其中 $y_{\\mathrm{O_2}}$ 是干燥空气中氧气的摩尔分数（给定为 $0.2095$），$p_{\\mathrm{H_2O}}^{\\mathrm{sat}}(T)$ 是温度 $T$ 下水的饱和蒸气压。为了精确地对此建模，需要使用 IAPWS (国际水和水蒸气性质协会) 针对液相水的饱和压力公式。基于 1992 年发布版（并被纳入后续标准如 IAPWS-95/97）的具体形式是：\n$$\np_{\\mathrm{H_2O}}^{\\mathrm{sat}}(T) = p_c \\exp\\left( \\frac{T_c}{T} \\sum_{i=1}^{6} n_i \\left(1 - \\frac{T}{T_c}\\right)^{e_i} \\right)\n$$\n其中水的临界点常数为 $T_c = 647.096\\,\\mathrm{K}$ 和 $p_c = 22.064 \\times 10^6\\,\\mathrm{Pa}$，以及经验拟合的系数 $n_i$ 和指数 $e_i$。\n\nHenry 系数 $k_{H}(T,S)$ 封装了温度和盐度对溶解度的影响。这些影响是分别建模的。\n\n首先，纯水（$S=0$）中溶解度的温度依赖性由 van 't Hoff 方程描述，该方程将平衡常数的变化与过程的焓联系起来。对于溶解过程，这个焓就是溶解焓 $\\Delta H_{\\mathrm{sol}}$。在参考温度 $T_0$ 和温度 $T$ 之间对 van 't Hoff 方程进行积分，得到：\n$$\n\\ln\\left(\\frac{k_{H}(T,0)}{k_{H}(T_0,0)}\\right) = -\\frac{\\Delta H_{\\mathrm{sol}}}{R} \\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)\n$$\n其中 $R$ 是普适气体常数。该式可以重新整理，以求解任意温度 $T$ 下的 Henry 系数：\n$$\nk_{H}(T,0) = k_{H}(T_0,0) \\exp\\left[ -\\frac{\\Delta H_{\\mathrm{sol}}}{R} \\left(\\frac{1}{T} - \\frac{1}{T_0}\\right) \\right]\n$$\n问题指定了参考常数：$T_0 = 298.15\\,\\mathrm{K}$，$k_{H}(T_0,0) = 1.256 \\times 10^{-5}\\,\\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$，$\\Delta H_{\\mathrm{sol}} = -16000\\,\\mathrm{J\\,mol^{-1}}$，以及 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。$\\Delta H_{\\mathrm{sol}}$ 的负号正确地模拟了氧溶解的放热性质，即溶解度随温度升高而降低。\n\n其次，盐度的影响使用 Setchenov “盐析”关系进行建模。这个经验定律指出，溶解度的对数随盐浓度线性下降。按要求，其指数形式为：\n$$\nk_{H}(T,S) = k_{H}(T,0) \\exp(-bS)\n$$\n其中 $b$ 是 Setchenov 系数，给定为 $0.006\\,\\mathrm{PSU}^{-1}$。\n\n对于每个测试用例 $(T, S, P)$ 的计算算法按以下步骤进行：\n1.  使用 IAPWS 公式计算水的饱和蒸气压 $p_{\\mathrm{H_2O}}^{\\mathrm{sat}}(T)$。\n2.  使用给定的大气压力 $P$ 和步骤 1 的结果，计算氧气的干分压 $p_{\\mathrm{O_2}}^{\\mathrm{dry}}$。\n3.  使用 van 't Hoff 关系式计算温度 $T$ 下纯水的 Henry 系数 $k_{H}(T,0)$。\n4.  使用 Setchenov 关系式应用盐度校正，以找到最终的 Henry 系数 $k_{H}(T,S)$。\n5.  将步骤 2 和 4 的结果代入 Henry 定律，计算最终的溶解氧浓度 $c$。\n6.  最后，为了验证，计算与该用例提供的参考值 $c_{\\mathrm{ref}}$ 的绝对相对误差 $e$：\n    $$\n    e = \\left| \\frac{c - c_{\\mathrm{ref}}}{c_{\\mathrm{ref}}} \\right|\n    $$\n将此过程应用于五个测试用例中的每一个，以生成所需的浓度和误差列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes dissolved oxygen concentration in water and validates against\n    reference data based on fundamental thermodynamic principles.\n    \"\"\"\n\n    # --- Define constants and parameters ---\n    Y_O2 = 0.2095  # Mole fraction of O2 in dry air\n    R = 8.314462618  # Universal gas constant (J mol^-1 K^-1)\n    T0 = 298.15  # Reference temperature (K)\n    # Reference Henry's constant at T0, S=0 (mol m^-3 Pa^-1)\n    K_H_T0_S0 = 1.256e-5\n    DELTA_H_SOL = -16000.  # Enthalpy of dissolution (J mol^-1)\n    B_SETCHENOV = 0.006  # Setchenov coefficient (per PSU)\n\n    # IAPWS-92/95 formulation constants for saturation vapor pressure\n    T_CRIT = 647.096  # Critical temperature for water (K)\n    P_CRIT = 22.064e6  # Critical pressure for water (Pa)\n    N_COEFFS = np.array([\n        -7.85951783, 1.84408259, -11.7866497, 22.6807411,\n        -15.9618719, 1.80122502\n    ])\n    E_EXPONENTS = np.array([1.0, 1.5, 3.0, 3.5, 4.0, 7.5])\n\n    # --- Test suite with embedded reference values ---\n    # (T in K, S in PSU, P in Pa, c_ref in mol/m^3)\n    test_cases = [\n        {'T': 298.15, 'S': 0, 'P': 101325, 'c_ref': 0.258},\n        {'T': 293.15, 'S': 35, 'P': 101325, 'c_ref': 0.228},\n        {'T': 273.15, 'S': 0, 'P': 101325, 'c_ref': 0.456},\n        {'T': 283.15, 'S': 0, 'P': 81060, 'c_ref': 0.282},\n        {'T': 308.15, 'S': 35, 'P': 121590, 'c_ref': 0.214},\n    ]\n\n    def p_h2o_sat(T):\n        \"\"\"\n        Calculates saturation vapor pressure of water using the IAPWS-95 formulation.\n        Args:\n            T (float): Temperature in Kelvin.\n        Returns:\n            float: Saturation vapor pressure in Pascals.\n        \"\"\"\n        tau = 1 - T / T_CRIT\n        sum_term = np.sum(N_COEFFS * (tau ** E_EXPONENTS))\n        ln_ps_pc = (T_CRIT / T) * sum_term\n        ps = P_CRIT * np.exp(ln_ps_pc)\n        return ps\n\n    def compute_solubility(T, S, P):\n        \"\"\"\n        Computes the equilibrium dissolved oxygen concentration.\n        Args:\n            T (float): Temperature in Kelvin.\n            S (float): Salinity in PSU.\n            P (float): Barometric pressure in Pascals.\n        Returns:\n            float: Dissolved oxygen concentration in mol/m^3.\n        \"\"\"\n        # Step 1: Calculate saturation vapor pressure of water\n        p_sat = p_h2o_sat(T)\n\n        # Step 2: Calculate dry partial pressure of oxygen\n        p_o2_dry = Y_O2 * (P - p_sat)\n\n        # Step 3: Calculate Henry's constant for pure water at temperature T\n        # (van 't Hoff relation)\n        vh_exponent = (-DELTA_H_SOL / R) * (1 / T - 1 / T0)\n        k_h_T_S0 = K_H_T0_S0 * np.exp(vh_exponent)\n\n        # Step 4: Apply salinity correction (Setchenov relation)\n        k_h_T_S = k_h_T_S0 * np.exp(-B_SETCHENOV * S)\n\n        # Step 5: Compute final concentration (Henry's Law)\n        c = k_h_T_S * p_o2_dry\n        \n        return c\n\n    predicted_concentrations = []\n    validation_errors = []\n\n    for case in test_cases:\n        T, S, P, c_ref = case['T'], case['S'], case['P'], case['c_ref']\n        \n        # Compute predicted concentration\n        c_pred = compute_solubility(T, S, P)\n        predicted_concentrations.append(c_pred)\n        \n        # Compute absolute relative validation error\n        error = np.abs((c_pred - c_ref) / c_ref)\n        validation_errors.append(error)\n\n    # Format the lists for printing\n    c_str = ','.join(f\"{c:.6f}\" for c in predicted_concentrations)\n    e_str = ','.join(f\"{e:.6f}\" for e in validation_errors)\n    \n    # Final print statement in the exact required format.\n    print(f\"[[{c_str}],[{e_str}]]\")\n\nsolve()\n```"
        },
        {
            "introduction": "亨利定律描述了在平坦界面上的理想平衡，但在自然水体中，情况往往更为复杂。本练习将挑战您处理一个非理想情景：水中存在微小气泡，这可能导致气体过饱和。您将通过建立模型，整合流体静力学压力和拉普拉斯压力，来解释这种偏离理想亨利定律的现象，这展示了如何将基本原理扩展应用于模拟真实世界的复杂性。",
            "id": "4080108",
            "problem": "要求您形式化、推导并实现一个计算模型，用以解释水中截留气泡引起的惰性气体偏离亨利定律的现象。请使用以下基本定律和事实来构建问题框架，并建立两个互补的平衡模型：一个封闭系统分配模型和一个开放系统界面平衡模型。\n\n所需基本原理：\n- 亨利定律将水中溶解的气体组分 $i$ 的摩尔浓度 $c_i$ 与其接触气相中的分压 $p_i$ 联系起来，关系式为 $c_i = k_H^i(T) \\, p_i$，其中 $k_H^i(T)$ 是亨利溶解度常数（单位为 $\\mathrm{mol/(m^3 \\cdot Pa)}$）。\n- 理想气体定律（IGL）指出，在体积为 $V$、压力为 $P$、温度为 $T$ 的空间中，理想气体的摩尔数 $n$ 为 $n = \\frac{P V}{R T}$，其中 $R$ 是普适气体常数。\n- 球形气泡的拉普拉斯压力为 $P_{\\mathrm{Laplace}} = \\frac{2 \\gamma}{R_b}$，其中 $\\gamma$ 是水的表面张力，$R_b$ 是气泡半径。\n- 水下深度 $h$ 处的静水压力为 $P_{\\mathrm{hyd}} = \\rho g h$，其中 $\\rho$ 是水的密度，$g$ 是重力加速度。\n- 气泡内部压力为 $P_b = P_{\\mathrm{atm}} + P_{\\mathrm{hyd}} + P_{\\mathrm{Laplace}}$。\n\n建模目标：\n- 从物理上解释为什么截留气泡会导致偏离基于大气顶空（$P_{\\mathrm{atm}}$）的经典亨利定律预测，重点关注两种情景：\n  1. 封闭微气泡-水系统：在水和气泡中，惰性气体 $i$ 的总摩尔数固定，无外部气顶空间。使用质量平衡结合亨利定律和理想气体定律，求解新的溶解浓度 $c_i$，以水体积 $V_w$、总气泡体积 $V_b$、温度 $T$ 和 $k_H^i(T)$ 表示。组分 $i$ 的总摩尔数应取为大气压下无气泡、空气饱和水中的含量。$V_w$ 和 $V_b$ 的单位是 $\\mathrm{m^3}$，$T$ 的单位是 $\\mathrm{K}$，浓度的单位是 $\\mathrm{mol/m^3}$。\n  2. 开放系统界面平衡：水与气泡达到平衡，气泡的内部压力 $P_b$ 由静水压力和拉普拉斯压力贡献，且气泡的成分由一个大的空气储库缓冲。溶解浓度 $c_i$ 随后取决于 $P_b$ 和组分 $i$ 在空气中的摩尔分数 $y_i$。\n\n实现所需的常数和参数：\n- 大气压力: $P_{\\mathrm{atm}} = 101325 \\ \\mathrm{Pa}$。\n- 水密度: $\\rho = 1000 \\ \\mathrm{kg/m^3}$。\n- 重力加速度: $g = 9.80665 \\ \\mathrm{m/s^2}$。\n- 室温下水的表面张力: $\\gamma = 0.072 \\ \\mathrm{N/m}$。\n- 普适气体常数: $R = 8.314462618 \\ \\mathrm{J/(mol \\cdot K)}$。\n- 温度: $T = 298.15 \\ \\mathrm{K}$。\n- 在温度 $T$ 下的亨利溶解度常数：\n  - 氩 (Ar): $k_H^{\\mathrm{Ar}} = 1.5 \\times 10^{-5} \\ \\mathrm{mol/(m^3 \\cdot Pa)}$。\n  - 氖 (Ne): $k_H^{\\mathrm{Ne}} = 4.8 \\times 10^{-6} \\ \\mathrm{mol/(m^3 \\cdot Pa)}$。\n- 干燥空气摩尔分数：\n  - $y_{\\mathrm{Ar}} = 9.34 \\times 10^{-3}$。\n  - $y_{\\mathrm{Ne}} = 1.818 \\times 10^{-5}$。\n\n用于比较的基准定义：\n- 与大气顶空平衡的无气泡水中的基准溶解浓度为 $c_{\\mathrm{base}} = k_H^i(T) \\, y_i \\, P_{\\mathrm{atm}}$。\n- 对于封闭系统模型，将水-气泡组合系统中的总摩尔数定义为 $n_i^{\\mathrm{tot}} = c_{\\mathrm{base}} \\, V_w$。\n\n您的程序必须为每个测试用例计算相对偏差（以小数表示），定义为 $\\delta = \\frac{c - c_{\\mathrm{base}}}{c_{\\mathrm{base}}}$，其中 $c$ 是指定情景下模型预测的溶解浓度。将 $\\delta$ 表示为四舍五入到六位小数的浮点数。\n\n测试套件：\n- 所有体积单位为 $\\mathrm{m^3}$，压力单位为 $\\mathrm{Pa}$，深度单位为 $\\mathrm{m}$，半径单位为 $\\mathrm{m}$，温度单位为 $\\mathrm{K}$，浓度单位为 $\\mathrm{mol/m^3}$。\n- 对于封闭系统情况，气泡体积 $V_b$ 通过 $V_b = \\phi_b V_w$ 设置，其中 $\\phi_b$ 是无量纲的气泡体积分数。\n- 对于开放系统情况，计算 $P_b = P_{\\mathrm{atm}} + \\rho g h + \\frac{2\\gamma}{R_b}$ 并使用适当的 $k_H^i$ 和 $y_i$。\n\n实现以下六个测试用例：\n1. 封闭系统，氩气：$V_w = 1.0$，$\\phi_b = 0.0$，$h = 0.0$，$R_b$ 不使用。\n2. 封闭系统，氩气：$V_w = 1.0$，$\\phi_b = 0.01$，$h = 0.0$，$R_b$ 不使用。\n3. 封闭系统，氩气：$V_w = 1.0$，$\\phi_b = 0.3$，$h = 0.0$，$R_b$ 不使用。\n4. 开放系统，氩气：$h = 10.0$，$R_b = 50 \\times 10^{-6}$，$V_w$ 和 $\\phi_b$ 与 $c$ 无关。\n5. 开放系统，氩气：$h = 0.0$，$R_b = 1 \\times 10^{-6}$，$V_w$ 和 $\\phi_b$ 与 $c$ 无关。\n6. 开放系统，氖气：$h = 100.0$，$R_b = 100 \\times 10^{-6}$，$V_w$ 和 $\\phi_b$ 与 $c$ 无关。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\left[ \\delta_1, \\delta_2, \\delta_3, \\delta_4, \\delta_5, \\delta_6 \\right]$，其中每个 $\\delta_k$ 都四舍五入到六位小数。",
            "solution": "该问题要求形式化并推导两个模型，以解释在水中存在截留气泡时，经典亨利定律出现的偏差。分析将首先基于与大气的平衡建立一个基准浓度。然后，将对两种不同的情景进行建模：一种是封闭系统，其中固定量的气体在水和气泡相之间分配；另一种是开放系统，其中水与气泡达到平衡，气泡的性质由外部环境条件决定。对于每个模型，我们将推导出新的平衡浓度表达式以及其与基准的相对偏差。\n\n控制该系统的基本物理原理是：\n1.  **亨利定律**：溶解气体 $i$ 的平衡摩尔浓度 $c_i$ 与其气相分压 $p_i$ 成正比：$c_i = k_H^i(T) p_i$。比例常数 $k_H^i(T)$ 是亨利定律常数。\n2.  **理想气体定律 (IGL)**：体积为 $V$ 中气体组分 $i$ 的摩尔数 $n_i$ 由 $n_i = \\frac{p_i V}{R T}$ 给出，其中 $p_i$ 是其分压，$T$ 是绝对温度，$R$ 是普适气体常数。\n3.  **气泡内部压力**：气泡内的绝对压力 $P_b$ 是环境大气压力 $P_{\\mathrm{atm}}$、由深度 $h$ 引起的静水压力 $P_{\\mathrm{hyd}} = \\rho g h$ 以及由作用在半径为 $R_b$ 的气泡上的表面张力 $\\gamma$ 引起的拉普拉斯压力 $P_{\\mathrm{Laplace}} = \\frac{2 \\gamma}{R_b}$ 的总和。\n\n**基准平衡浓度 ($c_{\\mathrm{base}}$)**\n\n参考状态是无气泡水在压力 $P_{\\mathrm{atm}}$ 下与标准大气平衡。大气中气体组分 $i$ 的分压为 $p_{i, \\mathrm{atm}} = y_i P_{\\mathrm{atm}}$，其中 $y_i$ 是其在干燥空气中的摩尔分数。根据亨利定律，相应的溶解浓度，我们定义为基准浓度 $c_{\\mathrm{base}}^i$，是：\n$$c_{\\mathrm{base}}^i = k_H^i(T) p_{i, \\mathrm{atm}} = k_H^i(T) y_i P_{\\mathrm{atm}}$$\n\n**模型1：封闭系统分配**\n\n此模型考虑在一个由水体积 $V_w$ 和总气泡体积 $V_b$ 组成的封闭系统中，包含固定总量的惰性气体组分 $i$，$n_i^{\\mathrm{tot}}$。问题指定组分 $i$ 的总摩尔数等于在基准大气平衡下溶解在水体积 $V_w$ 中的量。\n$$n_i^{\\mathrm{tot}} = c_{\\mathrm{base}}^i V_w$$\n这些总摩尔数在溶解的水相（$n_{i,w}$）和气态的气泡相（$n_{i,b}$）之间分配：\n$$n_i^{\\mathrm{tot}} = n_{i,w} + n_{i,b}$$\n设 $c_i$ 为水中新的平衡浓度。水相中的摩尔数为：\n$$n_{i,w} = c_i V_w$$\n气泡相中的摩尔数由理想气体定律给出，其中 $p_i$ 是新平衡下气泡中组分 $i$ 的分压：\n$$n_{i,b} = \\frac{p_i V_b}{R T}$$\n在平衡时，$c_i$ 和 $p_i$ 通过亨利定律相关联：$p_i = \\frac{c_i}{k_H^i(T)}$。将此代入 $n_{i,b}$ 的表达式中得到：\n$$n_{i,b} = \\frac{(c_i/k_H^i) V_b}{R T}$$\n我们现在可以用未知浓度 $c_i$ 来写出总质量平衡方程：\n$$c_{\\mathrm{base}}^i V_w = c_i V_w + \\frac{c_i V_b}{k_H^i R T}$$\n求解 $c_i$：\n$$c_{\\mathrm{base}}^i V_w = c_i \\left( V_w + \\frac{V_b}{k_H^i R T} \\right)$$\n$$c_i = c_{\\mathrm{base}}^i \\frac{V_w}{V_w + V_b / (k_H^i R T)}$$\n引入气泡体积分数 $\\phi_b = V_b / V_w$，表达式简化为：\n$$c_i = c_{\\mathrm{base}}^i \\frac{1}{1 + \\phi_b / (k_H^i R T)}$$\n无量纲乘积 $k_H^i R T$ 代表奥斯特瓦尔德溶解系数。与基准的相对偏差 $\\delta$ 为：\n$$\\delta = \\frac{c_i - c_{\\mathrm{base}}^i}{c_{\\mathrm{base}}^i} = \\frac{c_i}{c_{\\mathrm{base}}^i} - 1 = \\frac{1}{1 + \\frac{\\phi_b}{k_H^i R T}} - 1 = \\frac{1 - (1 + \\frac{\\phi_b}{k_H^i R T})}{1 + \\frac{\\phi_b}{k_H^i R T}} = \\frac{-\\frac{\\phi_b}{k_H^i R T}}{1 + \\frac{\\phi_b}{k_H^i R T}}$$\n此结果显示 $\\delta \\le 0$，表明在封闭系统中引入气泡相会导致气体从水相中分配出来，从而降低溶解浓度。\n\n**模型2：开放系统界面平衡**\n\n该模型描述了水与气泡达到平衡，其中气泡的内部压力 $P_b$ 和成分由外部因素固定，如同被一个大型储库缓冲。由于静水和表面张力效应，气泡内部压力高于大气压力：\n$$P_b = P_{\\mathrm{atm}} + P_{\\mathrm{hyd}} + P_{\\mathrm{Laplace}} = P_{\\mathrm{atm}} + \\rho g h + \\frac{2 \\gamma}{R_b}$$\n假设气泡气体成分为空气，因此气泡内组分 $i$ 的分压为 $p_i = y_i P_b$。与这些气泡平衡的水中溶解浓度 $c_i$ 直接由亨利定律给出：\n$$c_i = k_H^i(T) p_i = k_H^i(T) y_i P_b$$\n代入 $P_b$ 的表达式：\n$$c_i = k_H^i(T) y_i \\left( P_{\\mathrm{atm}} + \\rho g h + \\frac{2 \\gamma}{R_b} \\right)$$\n与基准 $c_{\\mathrm{base}}^i = k_H^i(T) y_i P_{\\mathrm{atm}}$ 的相对偏差 $\\delta$ 为：\n$$\\delta = \\frac{c_i - c_{\\mathrm{base}}^i}{c_{\\mathrm{base}}^i} = \\frac{k_H^i y_i P_b - k_H^i y_i P_{\\mathrm{atm}}}{k_H^i y_i P_{\\mathrm{atm}}} = \\frac{P_b - P_{\\mathrm{atm}}}{P_{\\mathrm{atm}}}$$\n$$\\delta = \\frac{(P_{\\mathrm{atm}} + \\rho g h + \\frac{2 \\gamma}{R_b}) - P_{\\mathrm{atm}}}{P_{\\mathrm{atm}}} = \\frac{\\rho g h + \\frac{2 \\gamma}{R_b}}{P_{\\mathrm{atm}}}$$\n在这种情景下，$\\delta \\ge 0$。气泡内的超压将气体驱入溶液，导致水相对于大气平衡变得过饱和。\n\n**测试用例计算**\n\n计算中使用以下常数：\n- $P_{\\mathrm{atm}} = 101325 \\ \\mathrm{Pa}$\n- $\\rho = 1000 \\ \\mathrm{kg/m^3}$\n- $g = 9.80665 \\ \\mathrm{m/s^2}$\n- $\\gamma = 0.072 \\ \\mathrm{N/m}$\n- $R = 8.314462618 \\ \\mathrm{J/(mol \\cdot K)}$\n- $T = 298.15 \\ \\mathrm{K}$\n- $k_H^{\\mathrm{Ar}} = 1.5 \\times 10^{-5} \\ \\mathrm{mol/(m^3 \\cdot Pa)}$\n- $k_H^{\\mathrm{Ne}} = 4.8 \\times 10^{-6} \\ \\mathrm{mol/(m^3 \\cdot Pa)}$\n- $y_{\\mathrm{Ar}} = 9.34 \\times 10^{-3}$\n- $y_{\\mathrm{Ne}} = 1.818 \\times 10^{-5}$\n\n1.  **封闭，Ar，$\\phi_b = 0.0$**: 此处 $\\phi_b = 0$，因此根据封闭系统公式，$\\delta = 0$。\n2.  **封闭，Ar，$\\phi_b = 0.01$**: 使用封闭系统公式和 $k_H^{\\mathrm{Ar}}$：\n    $k_H^{\\mathrm{Ar}} R T = (1.5 \\times 10^{-5}) \\times 8.314462618 \\times 298.15 \\approx 0.037233$。\n    $\\delta = - \\frac{0.01/0.037233}{1 + 0.01/0.037233} \\approx -0.211844$。\n3.  **封闭，Ar，$\\phi_b = 0.3$**: 使用封闭系统公式：\n    $\\delta = - \\frac{0.3/0.037233}{1 + 0.3/0.037233} \\approx -0.889694$。\n4.  **开放，Ar，$h=10.0 \\ \\mathrm{m}$，$R_b=50 \\times 10^{-6} \\ \\mathrm{m}$**: 使用开放系统公式。对于 $\\delta$ 来说，气体种类无关紧要。\n    $P_{\\mathrm{hyd}} = 1000 \\times 9.80665 \\times 10.0 = 98066.5 \\ \\mathrm{Pa}$。\n    $P_{\\mathrm{Laplace}} = (2 \\times 0.072) / (50 \\times 10^{-6}) = 2880 \\ \\mathrm{Pa}$。\n    $\\delta = (98066.5 + 2880) / 101325 = 100946.5 / 101325 \\approx 0.996264$。\n5.  **开放，Ar，$h=0.0 \\ \\mathrm{m}$，$R_b=1 \\times 10^{-6} \\ \\mathrm{m}$**: 使用开放系统公式。\n    $P_{\\mathrm{hyd}} = 0 \\ \\mathrm{Pa}$。\n    $P_{\\mathrm{Laplace}} = (2 \\times 0.072) / (1 \\times 10^{-6}) = 144000 \\ \\mathrm{Pa}$。\n    $\\delta = (0 + 144000) / 101325 \\approx 1.421150$。\n6.  **开放，Ne，$h=100.0 \\ \\mathrm{m}$，$R_b=100 \\times 10^{-6} \\ \\mathrm{m}$**: 使用开放系统公式。\n    $P_{\\mathrm{hyd}} = 1000 \\times 9.80665 \\times 100.0 = 980665 \\ \\mathrm{Pa}$。\n    $P_{\\mathrm{Laplace}} = (2 \\times 0.072) / (100 \\times 10^{-6}) = 1440 \\ \\mathrm{Pa}$。\n    $\\delta = (980665 + 1440) / 101325 = 982105 / 101325 \\approx 9.692621$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative deviation in dissolved noble gas concentration\n    due to entrapped air bubbles, based on two equilibrium models.\n    \"\"\"\n\n    # --- Define constants and parameters ---\n    CONSTANTS = {\n        \"P_atm\": 101325,       # Pa\n        \"rho\": 1000,           # kg/m^3\n        \"g\": 9.80665,          # m/s^2\n        \"gamma\": 0.072,        # N/m\n        \"R\": 8.314462618,      # J/(mol.K)\n        \"T\": 298.15,           # K\n    }\n    \n    GAS_PROPERTIES = {\n        \"Ar\": {\n            \"kH\": 1.5e-5,      # mol/(m^3.Pa)\n            \"y\": 9.34e-3       # mole fraction in air\n        },\n        \"Ne\": {\n            \"kH\": 4.8e-6,      # mol/(m^3.Pa)\n            \"y\": 1.818e-5      # mole fraction in air\n        }\n    }\n\n    # --- Define test cases ---\n    # Each case is a dictionary specifying the model and its parameters.\n    test_cases = [\n        {\"model\": \"closed\", \"species\": \"Ar\", \"phi_b\": 0.0},\n        {\"model\": \"closed\", \"species\": \"Ar\", \"phi_b\": 0.01},\n        {\"model\": \"closed\", \"species\": \"Ar\", \"phi_b\": 0.3},\n        {\"model\": \"open\", \"species\": \"Ar\", \"h\": 10.0, \"R_b\": 50e-6},\n        {\"model\": \"open\", \"species\": \"Ar\", \"h\": 0.0, \"R_b\": 1e-6},\n        {\"model\": \"open\", \"species\": \"Ne\", \"h\": 100.0, \"R_b\": 100e-6}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        delta = 0.0\n        if case[\"model\"] == \"closed\":\n            # --- Closed-System Model Calculation ---\n            # delta = - (phi_b / (kH*R*T)) / (1 + phi_b / (kH*R*T))\n            phi_b = case[\"phi_b\"]\n            if phi_b == 0.0:\n                delta = 0.0\n            else:\n                kH = GAS_PROPERTIES[case[\"species\"]][\"kH\"]\n                R = CONSTANTS[\"R\"]\n                T = CONSTANTS[\"T\"]\n                # Ostwald coefficient (dimensionless)\n                ostwald_coeff = kH * R * T\n                term = phi_b / ostwald_coeff\n                delta = -term / (1.0 + term)\n\n        elif case[\"model\"] == \"open\":\n            # --- Open-System Model Calculation ---\n            # delta = (rho*g*h + 2*gamma/R_b) / P_atm\n            P_atm = CONSTANTS[\"P_atm\"]\n            \n            # Hydrostatic pressure\n            P_hyd = CONSTANTS[\"rho\"] * CONSTANTS[\"g\"] * case[\"h\"]\n            \n            # Laplace pressure\n            P_laplace = (2 * CONSTANTS[\"gamma\"]) / case[\"R_b\"]\n            \n            # Pressure excess\n            P_excess = P_hyd + P_laplace\n            \n            delta = P_excess / P_atm\n        \n        results.append(f\"{delta:.6f}\")\n\n    # --- Print final output in the required format ---\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}