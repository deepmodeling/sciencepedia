{
    "hands_on_practices": [
        {
            "introduction": "理解多组分体系行为的第一步是从最简单的理想混合模型开始。本练习  将引导您从混合吉布斯自由能的表达式出发，通过数学推导得出化学势的表达式。这个过程不仅能加深您对化学势作为偏摩尔吉布斯自由能的基本定义的理解，还将通过验证吉布斯-杜亥姆关系，展示热力学变量之间固有的内在一致性。",
            "id": "4105011",
            "problem": "考虑一个用于计算地球化学中模拟公共亚晶格上端元之间构型混合的单相、三组分、置换理想溶液。在恒定温度 $T$ 和压力 $P$ 下，对总吉布斯自由能的混合贡献由下式给出\n$$\nG^{\\mathrm{mix}}(T,P,\\mathbf{n})=R T \\sum_{i=1}^{3} n_i \\ln x_i,\n$$\n其中 $R$ 是普适气体常数，$n_i$ 是组分 $i$ 的摩尔量，$\\mathbf{n}=(n_1,n_2,n_3)$，$x_i$ 是由 $x_i=n_i/n$ 定义的摩尔分数，而 $n=\\sum_{i=1}^{3} n_i$ 是总摩尔数。该系统是封闭的，在恒定 $T$ 和 $P$ 下，成分的变化受约束条件 $\\sum_{i=1}^{3} x_i=1$ 的限制。\n\n从化学势的基本定义和所给的混合吉布斯自由能出发，推导约化（无量纲）混合化学势 $\\hat{\\mu}_i=\\mu_i^{\\mathrm{mix}}/(R T)$（$i=1,2,3$）作为摩尔分数 $x_i$ 的函数表达式。然后，对于此混合模型，在恒定 $T$ 和 $P$ 下，通过在 $\\sum_{i=1}^{3} x_i=1$ 的约束下显式计算 $\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}}$ 来验证 Gibbs–Duhem 关系（Gibbs–Duhem (GD) 关系）。\n\n答案规格：\n- 以符号形式提供用 $x_1, x_2, x_3$ 表示的约化混合化学势 $\\hat{\\mu}_1, \\hat{\\mu}_2, \\hat{\\mu}_3$，不代入任何数值。\n- 对于满足 $\\sum_{i=1}^{3} x_i=1$ 的成分变化，在恒定 $T$ 和 $P$ 下，给出 $\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}}$ 的最终标量值，以验证 Gibbs–Duhem 关系。\n- 以单行矩阵的形式报告您的最终结果，顺序为 $\\hat{\\mu}_1, \\hat{\\mu}_2, \\hat{\\mu}_3$ 和已验证的 $\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}}$ 的标量值。\n- 最终表达式无需数值取约，也不应包含单位。",
            "solution": "问题陈述经评估有效。它在科学上基于化学热力学原理，提法恰当，提供了所有必要信息，且表述客观。这是一个关于理想溶液的标准推导和验证练习。\n\n第一个任务是推导三个组分的约化混合化学势 $\\hat{\\mu}_i$。混合物中组分 $i$ 的化学势 $\\mu_i$ 定义为偏摩尔吉布斯自由能。对于混合贡献，这表示为：\n$$\n\\mu_i^{\\mathrm{mix}} = \\left( \\frac{\\partial G^{\\mathrm{mix}}}{\\partial n_i} \\right)_{T, P, n_{j \\neq i}}\n$$\n其中，微分是在恒定温度 $T$、压力 $P$ 以及所有其他组分 $n_{j \\neq i}$ 的量保持不变的情况下进行的。\n\n给定的混合吉布斯自由能表达式为：\n$$\nG^{\\mathrm{mix}}(T,P,\\mathbf{n})=R T \\sum_{j=1}^{3} n_j \\ln x_j\n$$\n为了方便微分，我们将摩尔分数 $x_j$ 和总摩尔数 $n$ 用各自的摩尔量 $n_k$ 表示：\n$$\nx_j = \\frac{n_j}{n} \\quad \\text{其中} \\quad n = \\sum_{k=1}^{3} n_k\n$$\n将此代入 $G^{\\mathrm{mix}}$ 的表达式中：\n$$\nG^{\\mathrm{mix}} = R T \\sum_{j=1}^{3} n_j \\ln\\left(\\frac{n_j}{n}\\right) = R T \\left( \\sum_{j=1}^{3} n_j \\ln(n_j) - \\sum_{j=1}^{3} n_j \\ln(n) \\right)\n$$\n第二个求和项简化为 $n \\ln(n)$：\n$$\nG^{\\mathrm{mix}} = R T \\left( \\sum_{j=1}^{3} n_j \\ln(n_j) - n \\ln(n) \\right)\n$$\n现在我们可以计算关于 $n_i$ 的偏导数。我们分别对括号内的每一项进行微分。\n\n对于第一项 $\\sum_{j=1}^{3} n_j \\ln(n_j)$：\n$$\n\\frac{\\partial}{\\partial n_i} \\left( \\sum_{j=1}^{3} n_j \\ln(n_j) \\right) = \\frac{\\partial}{\\partial n_i} (n_i \\ln(n_i)) + \\sum_{j \\neq i} \\frac{\\partial}{\\partial n_i} (n_j \\ln(n_j))\n$$\n由于 $n_{j \\neq i}$ 的量保持不变，求和中的各项为零。对于包含 $n_i$ 的项，我们使用乘法法则：\n$$\n\\frac{\\partial}{\\partial n_i} (n_i \\ln(n_i)) = 1 \\cdot \\ln(n_i) + n_i \\cdot \\frac{1}{n_i} = \\ln(n_i) + 1\n$$\n对于第二项 $-n \\ln(n)$：\n$$\n\\frac{\\partial}{\\partial n_i} (n \\ln(n))\n$$\n由于 $n = \\sum_{k=1}^{3} n_k$，它对 $n_i$ 的偏导数是 $\\frac{\\partial n}{\\partial n_i} = 1$。再次使用乘法法则：\n$$\n\\frac{\\partial}{\\partial n_i} (n \\ln(n)) = \\frac{\\partial n}{\\partial n_i} \\ln(n) + n \\frac{\\partial(\\ln(n))}{\\partial n_i} = 1 \\cdot \\ln(n) + n \\left( \\frac{1}{n} \\frac{\\partial n}{\\partial n_i} \\right) = \\ln(n) + n \\left( \\frac{1}{n} \\cdot 1 \\right) = \\ln(n) + 1\n$$\n结合这些结果，我们得到混合化学势的表达式：\n$$\n\\mu_i^{\\mathrm{mix}} = R T \\left[ (\\ln(n_i) + 1) - (\\ln(n) + 1) \\right] = R T (\\ln(n_i) - \\ln(n)) = R T \\ln\\left(\\frac{n_i}{n}\\right)\n$$\n根据定义，摩尔分数为 $x_i = n_i/n$，所以：\n$$\n\\mu_i^{\\mathrm{mix}} = R T \\ln(x_i)\n$$\n问题要求的是约化（无量纲）混合化学势 $\\hat{\\mu}_i = \\mu_i^{\\mathrm{mix}}/(R T)$。将上述表达式除以 $R T$ 得到：\n$$\n\\hat{\\mu}_i = \\ln(x_i)\n$$\n这对每个组分都成立，所以对于 $i \\in \\{1, 2, 3\\}$，我们有：\n$$\n\\hat{\\mu}_1 = \\ln(x_1), \\quad \\hat{\\mu}_2 = \\ln(x_2), \\quad \\hat{\\mu}_3 = \\ln(x_3)\n$$\n\n第二个任务是在恒定 $T$ 和 $P$ 下验证 Gibbs–Duhem 关系。该关系指出，对于成分的任何变化：\n$$\n\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}} = 0\n$$\n我们使用推导出的 $\\mu_i^{\\mathrm{mix}}$ 表达式显式计算左边。在恒定 $T$ 和 $P$ 下，$\\mu_i^{\\mathrm{mix}}$ 的微分是：\n$$\nd\\mu_i^{\\mathrm{mix}} = d(R T \\ln(x_i)) = R T \\, d(\\ln(x_i)) = R T \\frac{dx_i}{x_i}\n$$\n将此代入 Gibbs–Duhem 求和式中：\n$$\n\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}} = \\sum_{i=1}^{3} n_i \\left( R T \\frac{dx_i}{x_i} \\right)\n$$\n使用关系式 $n_i = n x_i$，其中 $n$ 是总摩尔数：\n$$\n\\sum_{i=1}^{3} (n x_i) \\left( R T \\frac{dx_i}{x_i} \\right) = \\sum_{i=1}^{3} n R T \\, dx_i\n$$\n我们可以提取出常数项 $n, R, T$：\n$$\nn R T \\sum_{i=1}^{3} dx_i = n R T \\, d\\left(\\sum_{i=1}^{3} x_i\\right)\n$$\n系统受制于摩尔分数之和恒为1的闭合约束：\n$$\n\\sum_{i=1}^{3} x_i = 1\n$$\n常数的微分是零，因此：\n$$\nd\\left(\\sum_{i=1}^{3} x_i\\right) = d(1) = 0\n$$\n将此代回 Gibbs–Duhem 求和式的表达式中：\n$$\n\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}} = n R T \\cdot 0 = 0\n$$\n这证实了对于理想混合模型，Gibbs–Duhem 关系是满足的，且该表达式的标量值为 $0$。\n\n最终结果是约化化学势 $\\hat{\\mu}_1, \\hat{\\mu}_2, \\hat{\\mu}_3$ 的表达式以及 Gibbs-Duhem 求和的验证值。\n$$\n\\hat{\\mu}_1 = \\ln(x_1)\n$$\n$$\n\\hat{\\mu}_2 = \\ln(x_2)\n$$\n$$\n\\hat{\\mu}_3 = \\ln(x_3)\n$$\n$$\n\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}} = 0\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\ln(x_1)  \\ln(x_2)  \\ln(x_3)  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "真实的地质流体和熔体很少是理想的，因此我们需要处理非理想溶液。吉布斯-杜亥姆方程在这种情况下尤为重要，因为它为混合物中各组分的热力学行为提供了严格的约束。在本练习  中，您将应用该方程，根据一个组分的经验数据推导出二元熔体中另一个组分的活度系数，这是构建自洽的地球化学模型的一项关键技能。",
            "id": "4105058",
            "problem": "一种由组分 $1$ 和 $2$ 组成的二元硅酸盐熔体，在恒定温度 $T$ 和压力 $P$ 下，使用摩尔分数标准态（拉乌尔定律标准态）进行建模。化学势定义为 $ \\mu_i = \\mu_i^{\\ast}(T,P) + R T \\ln a_i$，其中 $a_i$ 是组分 $i$ 的活度，$R$ 是普适气体常数，$\\mu_i^{\\ast}(T,P)$ 是标准化学势。活度通过 $a_i = \\gamma_i x_i$ 与摩尔分数 $x_i$ 相关，其中 $\\gamma_i$ 是活度系数。该体系是封闭的，在恒定 $T$ 和 $P$ 下，满足 $x_1 + x_2 = 1$。\n\n在 $T = 1473\\,\\mathrm{K}$ 和 $P = 1\\,\\mathrm{bar}$ 时，该熔体的实验数据由组分 $1$ 的经验关联式表示：\n$$\n\\ln \\gamma_1(x_2) = A\\, x_2^{2} + B\\, x_2^{3},\n$$\n其中 $A = 1.20$ 和 $B = -0.50$ 是在此 $T$ 和 $P$ 下的常数。假设拉乌尔定律标准态边界条件成立，即 $\\lim_{x_i \\to 1} \\gamma_i = 1$。\n\n任务：\n- 仅从恒定 $T$ 和 $P$ 下的 Gibbs–Duhem 方程、化学势的定义和活度的定义出发，推导一个联系该二元混合物中 $\\ln \\gamma_1$ 和 $\\ln \\gamma_2$ 组分导数的积分关系，并用它来为上面给出的关联式获得 $\\ln \\gamma_2(x_2)$ 的显式闭合形式表达式。施加一个与所选标准态一致的适当边界条件，以确定任何积分常数。\n- 使用您推导的表达式，计算当 $x_1 = 0.40$（因此 $x_2 = 0.60$）时的 $\\gamma_2$ 值。\n\n将您最终的 $\\gamma_2$ 数值答案四舍五入到 4 位有效数字。将最终结果表示为一个纯数（无量纲的活度系数）。",
            "solution": "在恒定温度 $T$ 和压力 $P$ 下的基本出发点是：\n- 二元混合物的 Gibbs–Duhem 方程，其微分形式为 $x_1\\, d\\mu_1 + x_2\\, d\\mu_2 = 0$。\n- 用活度表示的化学势定义：$\\mu_i = \\mu_i^{\\ast}(T,P) + R T \\ln a_i$，其中 $a_i = \\gamma_i x_i$。\n- 组分约束 $x_1 + x_2 = 1$。\n\n首先，在恒定 $T$ 和 $P$ 下对 $\\mu_i$ 取微分：\n$$\nd\\mu_i = R T\\, d\\ln a_i = R T\\, d\\left(\\ln \\gamma_i + \\ln x_i\\right) = R T\\left(d\\ln \\gamma_i + d\\ln x_i\\right).\n$$\n将此代入 Gibbs–Duhem 方程 $x_1\\, d\\mu_1 + x_2\\, d\\mu_2 = 0$：\n$$\nx_1 R T\\left(d\\ln \\gamma_1 + d\\ln x_1\\right) + x_2 R T\\left(d\\ln \\gamma_2 + d\\ln x_2\\right) = 0.\n$$\n两边除以 $R T$ 并合并各项：\n$$\nx_1\\, d\\ln \\gamma_1 + x_2\\, d\\ln \\gamma_2 + x_1\\, d\\ln x_1 + x_2\\, d\\ln x_2 = 0.\n$$\n使用由 $x_1 + x_2 = 1$ 推导出的恒等式，即 $x_1\\, d\\ln x_1 + x_2\\, d\\ln x_2 = d x_1 + d x_2 = 0$。这得到了在恒定 $T$ 和 $P$ 下，二元混合物活度系数的简化 Gibbs–Duhem 关系：\n$$\nx_1\\, d\\ln \\gamma_1 + x_2\\, d\\ln \\gamma_2 = 0.\n$$\n重新整理以关联这些微分：\n$$\nd\\ln \\gamma_2 = -\\frac{x_1}{x_2}\\, d\\ln \\gamma_1.\n$$\n为了对此关系式进行积分，使用 $x_2$ 作为自变量，并注意 $x_1 = 1 - x_2$。然后\n$$\nd\\ln \\gamma_2 = -\\frac{1 - x_2}{x_2}\\, d\\ln \\gamma_1.\n$$\n施加组分 $2$ 的拉乌尔定律标准态边界条件，即 $\\lim_{x_2 \\to 1} \\gamma_2 = 1$，这意味着 $\\ln \\gamma_2(1) = 0$。从 $x_2 = 1$ 积分到一个通用的 $x_2$：\n$$\n\\ln \\gamma_2(x_2) - \\ln \\gamma_2(1) = - \\int_{1}^{x_2} \\frac{1 - u}{u}\\, d\\big(\\ln \\gamma_1(u)\\big),\n$$\n因此\n$$\n\\ln \\gamma_2(x_2) = - \\int_{1}^{x_2} \\frac{1 - u}{u}\\, d\\big(\\ln \\gamma_1(u)\\big).\n$$\n\n现在代入经验关联式 $\\ln \\gamma_1(u) = A u^{2} + B u^{3}$。那么\n$$\nd\\big(\\ln \\gamma_1(u)\\big) = \\left(2A u + 3B u^{2}\\right) du,\n$$\n并且被积函数变为\n$$\n-\\frac{1 - u}{u}\\left(2A u + 3B u^{2}\\right) du = -\\left(1 - u\\right)\\left(2A + 3B u\\right) du.\n$$\n因此，\n$$\n\\ln \\gamma_2(x_2) = - \\int_{1}^{x_2} \\left[\\left(1 - u\\right)\\left(2A + 3B u\\right)\\right] du.\n$$\n展开被积函数：\n$$\n\\left(1 - u\\right)\\left(2A + 3B u\\right) = 2A - 2A u + 3B u - 3B u^{2} = 2A + \\left(-2A + 3B\\right) u - 3B u^{2}.\n$$\n逐项积分：\n$$\n\\int \\left[2A + \\left(-2A + 3B\\right) u - 3B u^{2}\\right] du = 2A u + \\frac{\\left(-2A + 3B\\right)}{2} u^{2} - B u^{3}.\n$$\n应用积分限 $u = 1$ 到 $u = x_2$ 并包含前导的负号：\n$$\n\\ln \\gamma_2(x_2) = -\\left[2A x_2 + \\frac{\\left(-2A + 3B\\right)}{2} x_2^{2} - B x_2^{3} - \\left(2A + \\frac{\\left(-2A + 3B\\right)}{2} - B\\right)\\right].\n$$\n简化方括号中的常数项：\n$$\n2A + \\frac{\\left(-2A + 3B\\right)}{2} - B = A + \\frac{B}{2}.\n$$\n因此 $\\ln \\gamma_2(x_2)$ 的闭合形式表达式为\n$$\n\\ln \\gamma_2(x_2) = - 2A x_2 - \\frac{\\left(-2A + 3B\\right)}{2} x_2^{2} + B x_2^{3} + \\left(A + \\frac{B}{2}\\right).\n$$\n\n现在在 $A = 1.20$，$B = -0.50$ 以及 $x_1 = 0.40$ (因此 $x_2 = 0.60$) 处求值。首先计算系数：\n$$\n-2A + 3B = -2(1.20) + 3(-0.50) = -2.40 - 1.50 = -3.90,\n$$\n$$\nA + \\frac{B}{2} = 1.20 + \\frac{-0.50}{2} = 1.20 - 0.25 = 0.95.\n$$\n在 $x_2 = 0.60$ 处计算多项式的值：\n$$\n-2A x_2 = -2(1.20)(0.60) = -1.44,\n$$\n$$\n-\\frac{\\left(-2A + 3B\\right)}{2} x_2^{2} = -\\frac{-3.90}{2} (0.60)^{2} = +1.95 \\times 0.36 = 0.702,\n$$\n$$\nB x_2^{3} = (-0.50)(0.60)^{3} = (-0.50)(0.216) = -0.108.\n$$\n组合各项：\n$$\n\\ln \\gamma_2(0.60) = \\left(-1.44\\right) + 0.702 + \\left(-0.108\\right) + 0.95 = 0.104.\n$$\n最后，计算 $\\gamma_2$：\n$$\n\\gamma_2(0.60) = \\exp(0.104) \\approx 1.1096.\n$$\n四舍五入到 4 位有效数字，结果为 $1.110$。活度系数是无量纲的。",
            "answer": "$$\\boxed{1.110}$$"
        },
        {
            "introduction": "在计算地球化学中，一个核心问题是判断一个均一的相是否会自发地分离成多个相。这个问题的答案蕴含在吉布斯自由能曲面的几何形状中。本高级练习  将指导您构建并实现切平面距离（TPD）稳定性检验，这是一种将相稳定性的热力学原理（即自由能的凸性）转化为具体计算算法的强大方法。完成此练习将使您能够从根本上理解模拟软件如何预测矿物中的出溶等相分离现象。",
            "id": "4105002",
            "problem": "您的任务是为恒温恒压下的多组分地球化学体系，构建并以编程方式实现切平面距离 (TPD) 稳定性检验。目标是确定混合物的单一均相相对于无穷小相分离是否稳定。您的推导和实现需要基于适用于恒温恒压封闭体系的基本热力学原理。\n\n从以下基础出发：\n\n- 对于恒温恒压下的封闭多组分体系，单相的稳定性由混合摩尔吉布斯自由能 $g(\\boldsymbol{x})$ 的凸性决定，其中 $\\boldsymbol{x} = (x_1, x_2, \\dots, x_N)$ 是满足 $\\sum_{i=1}^N x_i = 1$ 和 $x_i \\ge 0$ 的摩尔分数。\n- 总吉布斯自由能为 $G = n \\, g(\\boldsymbol{x})$，其中总摩尔数为 $n = \\sum_{i=1}^N n_i$，组分 $i$ 的化学势定义为 $\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j \\ne i}}$。\n\n您的任务是：\n\n1.  通过将几何切平面构造应用于 $g(\\boldsymbol{x})$ 并利用化学势的定义，推导在参考组分 $\\boldsymbol{z}$ 处的切平面距离 (TPD) 的数学形式。明确构造一个标量函数 $D(\\boldsymbol{y} \\mid \\boldsymbol{z})$，使其在组分单纯形（$\\sum_i y_i = 1, y_i \\ge 0$）上的全局最小值的符号决定了相在 $\\boldsymbol{z}$ 处的稳定性。您的推导必须从上述基本定义开始，不得假设任何快捷公式。\n\n2.  将 $g(\\boldsymbol{x})$ 具体化为一个物理上合理、广泛使用且计算上易于处理的、适用于地球化学混合物的非理想正则溶液模型：\n    $$\\frac{g(\\boldsymbol{x})}{R T} = \\sum_{i=1}^N x_i \\ln x_i + \\sum_{1 \\le i  j \\le N} \\alpha_{ij} \\, x_i x_j,$$\n    其中 $R$ 是普适气体常数，$T$ 是绝对温度，$\\alpha_{ij}$ 是无量纲的对称相互作用参数（$\\alpha_{ij} = \\alpha_{ji}$），概括了与理想混合的偏差。所有计算都必须以无量纲形式进行，即以 $g/(R T)$、$\\mu_i/(R T)$ 和 $D/(R T)$ 为单位。\n\n3.  构建一个算法，仅使用基本定义 $\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j \\ne i}}$ 和约束 $\\sum_i x_i = 1$，从 $g(\\boldsymbol{x})/(R T)$ 计算 $\\boldsymbol{\\mu}(\\boldsymbol{z})/(R T)$。您的推导必须得出一个可实现的 $\\mu_i/(R T)$ 表达式，该表达式使用 $g(\\boldsymbol{x})/(R T)$ 对 $x_i$ 的偏导数并强制执行组分约束。\n\n4.  在组分单纯形上实现 TPD 最小化，并带有等式约束 $\\sum_i y_i = 1$ 和边界约束 $y_i \\ge \\varepsilon$（其中 $\\varepsilon$ 是一个小的正数），以维持涉及 $\\ln y_i$ 的项的数值稳健性。该算法必须确定 $D(\\boldsymbol{y} \\mid \\boldsymbol{z})/(R T)$ 的最小值是非负（稳定）还是负（不稳定）。报告 $D(\\boldsymbol{y} \\mid \\boldsymbol{z})/(R T)$ 的全局最小值和作为布尔值的稳定性决策。\n\n5.  使用以下测试套件，它涵盖了一系列地球化学相关行为，包括稳定情况、强不稳定情况、近边界组分、中等非理想性和非对称相互作用。每个测试都是一个三组分混合物（$N=3$）。在每种情况下，温度 $T$ 是一个参数，但对于此模型，仅使用无量纲量。相互作用参数是对称的。程序中所有以下数值必须被视为无量纲，所有浮点数必须不带单位报告：\n    - 测试 $1$（正常路径，预期稳定）：$\\boldsymbol{z} = (0.2, 0.5, 0.3)$，其中 $\\alpha_{12} = 0.2, \\alpha_{13} = 0.2, \\alpha_{23} = 0.2$。\n    - 测试 $2$（强非理想性，预期在近等摩尔时不稳定）：$\\boldsymbol{z} = (1/3, 1/3, 1/3)$，其中 $\\alpha_{12} = 4.0, \\alpha_{13} = 4.0, \\alpha_{23} = 4.0$。\n    - 测试 $3$（近边界组分）：$\\boldsymbol{z} = (0.98, 0.01, 0.01)$，其中 $\\alpha_{12} = 3.0, \\alpha_{13} = 3.0, \\alpha_{23} = 0.5$。\n    - 测试 $4$（中等非理想性，近凸）：$\\boldsymbol{z} = (0.4, 0.4, 0.2)$，其中 $\\alpha_{12} = 1.0, \\alpha_{13} = 1.0, \\alpha_{23} = 1.0$。\n    - 测试 $5$（非对称相互作用）：$\\boldsymbol{z} = (0.6, 0.1, 0.3)$，其中 $\\alpha_{12} = 2.5, \\alpha_{13} = 0.1, \\alpha_{23} = 2.5$。\n\n6.  数值要求和输出规范：\n    - 所有计算必须在组分单纯形上进行，并满足约束 $\\sum_i y_i = 1$ 和边界 $y_i \\in [\\varepsilon, 1 - (N-1)\\varepsilon]$，其中选择一个小的 $\\varepsilon$ 来确保 $\\ln y_i$ 项的数值稳定性。使用 $\\varepsilon = 10^{-12}$。\n    - 对于每个测试用例，您的程序必须返回一个双元素列表 $[\\text{stable}, \\text{min\\_tpd}]$，其中 $\\text{stable}$ 是一个布尔值，指示最小切平面距离在数值公差内是否为非负值，$\\text{min\\_tpd}$ 是 $D(\\boldsymbol{y} \\mid \\boldsymbol{z})/(R T)$ 在可行单纯形上的最小值，表示为四舍五入到六位小数的浮点数。\n    - 最终输出格式必须是单行，包含一个逗号分隔的五个测试结果列表，用方括号括起来，每个测试结果本身也用方括号括起来。例如，输出必须看起来像\n      $$[[\\text{True}, 0.000000],[\\text{False}, -0.123456],[\\text{True}, 0.000789],[\\text{True}, 0.000000],[\\text{False}, -0.010000]].$$\n    - 所有报告的浮点数都是无量纲数，四舍五入到六位小数。不应包含任何物理单位。\n\n您的程序必须是一个单一、可运行的脚本，不接受用户输入，并仅按指定的确切格式打印所需的单行输出。",
            "solution": "该问题要求推导并实现用于恒温恒压下多组分混合物的切平面距离 (TPD) 稳定性检验。解决方案分四个阶段进行：(1) 从基本热力学原理推导 TPD 判据，(2) 推导指定正则溶液模型的化学势表达式，(3) 构建 TPD 最小化的计算算法，以及 (4) 实现该算法以解决所提供的测试用例。\n\n**1. 切平面距离 (TPD) 判据的推导**\n\n对于恒温 $T$ 和恒压 $P$ 下的封闭系统，均相的热力学稳定性条件是其摩尔吉布斯自由能 $g(\\boldsymbol{x})$ 在由摩尔分数 $\\boldsymbol{x} = (x_1, \\dots, x_N)$（其中 $\\sum_{i=1}^N x_i = 1$ 且 $x_i \\ge 0$）定义的组分单纯形上必须是一个凸函数。\n\n一个函数在某一点是凸的，条件是其曲面位于其所有切平面之上或与之重合。让我们考虑一个参考组分 $\\boldsymbol{z}$。$g(\\boldsymbol{x})$ 曲面在 $\\boldsymbol{z}$ 处的切超平面方程由该组分处化学势 $\\boldsymbol{\\mu}(\\boldsymbol{z})$ 的线性组合给出。此切平面在任意组分 $\\boldsymbol{y}$ 处的值为：\n$$ T_z(\\boldsymbol{y}) = \\sum_{i=1}^N y_i \\mu_i(\\boldsymbol{z}) $$\n该平面穿过能量曲面上的点 $(\\boldsymbol{z}, g(\\boldsymbol{z}))$，因为吉布斯能量本身可以表示为 $g(\\boldsymbol{z}) = \\sum_{i=1}^N z_i \\mu_i(\\boldsymbol{z})$。\n\n切平面距离 $D(\\boldsymbol{y} \\mid \\boldsymbol{z})$ 定义为组分 $\\boldsymbol{y}$ 处的摩尔吉布斯能量与在 $\\boldsymbol{z}$ 处构建的切平面在 $\\boldsymbol{y}$ 处的值之间的差值。\n$$ D(\\boldsymbol{y} \\mid \\boldsymbol{z}) = g(\\boldsymbol{y}) - T_z(\\boldsymbol{y}) = g(\\boldsymbol{y}) - \\sum_{i=1}^N y_i \\mu_i(\\boldsymbol{z}) $$\n组分 $\\boldsymbol{z}$ 处的相稳定性条件是，均相的吉布斯能量必须低于或等于任何分离相组合的吉布斯能量。这转化为几何条件，即整个曲面 $g(\\boldsymbol{y})$ 必须位于 $\\boldsymbol{z}$ 处切平面的上方或与之重合。因此，当且仅当对于所有有效组分 $\\boldsymbol{y}$，都有 $D(\\boldsymbol{y} \\mid \\boldsymbol{z}) \\ge 0$ 时，$\\boldsymbol{z}$ 处的相是稳定的。\n\n因此，稳定性检验简化为在组分单纯形上寻找 TPD 函数的全局最小值。\n$$ \\min_{\\boldsymbol{y}} D(\\boldsymbol{y} \\mid \\boldsymbol{z}) \\ge 0 \\implies \\text{稳定} $$\n$$ \\min_{\\boldsymbol{y}} D(\\boldsymbol{y} \\mid \\boldsymbol{z})  0 \\implies \\text{不稳定} $$\n由于 $D(\\boldsymbol{z} \\mid \\boldsymbol{z}) = g(\\boldsymbol{z}) - \\sum_{i=1}^N z_i \\mu_i(\\boldsymbol{z}) = 0$，最小值总是小于或等于零。稳定性由该最小值是严格为负还是为零（在数值精度内）来确定。\n\n**2. 正则溶液模型化学势的推导**\n\n为了使用 TPD 判据，我们需要化学势 $\\mu_k$ 的表达式。我们从其基本定义 $\\mu_k = \\left(\\frac{\\partial G}{\\partial n_k}\\right)_{T,P,n_{j \\ne k}}$ 推导，其中 $G=n g(\\boldsymbol{x})$ 是总吉布斯能量，$n=\\sum_i n_i$ 是总摩尔数，$x_i = n_i/n$ 是摩尔分数。\n\n使用乘法法则和链式法则：\n$$ \\mu_k = \\frac{\\partial (n g)}{\\partial n_k} = g \\frac{\\partial n}{\\partial n_k} + n \\frac{\\partial g}{\\partial n_k} = g \\cdot 1 + n \\sum_{j=1}^N \\frac{\\partial g}{\\partial x_j} \\frac{\\partial x_j}{\\partial n_k} $$\n摩尔分数 $x_j=n_j/n$ 对摩尔数 $n_k$ 的偏导数为：\n$$ \\frac{\\partial x_j}{\\partial n_k} = \\frac{\\partial}{\\partial n_k}\\left(\\frac{n_j}{n}\\right) = \\frac{\\delta_{jk}n - n_j(1)}{n^2} = \\frac{\\delta_{jk} - x_j}{n} $$\n其中 $\\delta_{jk}$ 是克罗内克δ函数。将其代入 $\\mu_k$ 的表达式中：\n$$ \\mu_k = g(\\boldsymbol{x}) + n \\sum_{j=1}^N \\frac{\\partial g}{\\partial x_j} \\frac{\\delta_{jk} - x_j}{n} = g(\\boldsymbol{x}) + \\sum_{j=1}^N \\frac{\\partial g}{\\partial x_j} (\\delta_{jk} - x_j) $$\n$$ \\mu_k(\\boldsymbol{x}) = g(\\boldsymbol{x}) + \\frac{\\partial g(\\boldsymbol{x})}{\\partial x_k} - \\sum_{j=1}^N x_j \\frac{\\partial g(\\boldsymbol{x})}{\\partial x_j} $$\n这是对于任何摩尔性质 $g$ 的化学势的通用表达式。现在我们将其具体化为给定的无量纲正则溶液模型 $g'(\\boldsymbol{x}) = g(\\boldsymbol{x})/(RT)$:\n$$ g'(\\boldsymbol{x}) = \\sum_{i=1}^N x_i \\ln x_i + \\sum_{1 \\le i  j \\le N} \\alpha_{ij} x_i x_j $$\n我们需要偏导数 $\\partial g'/\\partial x_k$。\n$$ \\frac{\\partial g'}{\\partial x_k} = \\frac{\\partial}{\\partial x_k}\\left(\\sum_i x_i \\ln x_i\\right) + \\frac{\\partial}{\\partial x_k}\\left(\\sum_{i  j} \\alpha_{ij} x_i x_j \\right) $$\n**[NOTE: The provided solution text is truncated here.]**",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the Tangent Plane Distance (TPD) stability problem for five test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # z = (z1, z2, z3), alphas = (alpha12, alpha13, alpha23)\n        {'z': (0.2, 0.5, 0.3), 'alphas': (0.2, 0.2, 0.2)},\n        {'z': (1/3, 1/3, 1/3), 'alphas': (4.0, 4.0, 4.0)},\n        {'z': (0.98, 0.01, 0.01), 'alphas': (3.0, 3.0, 0.5)},\n        {'z': (0.4, 0.4, 0.2), 'alphas': (1.0, 1.0, 1.0)},\n        {'z': (0.6, 0.1, 0.3), 'alphas': (2.5, 0.1, 2.5)},\n    ]\n\n    results = []\n    \n    # Small positive constant for numerical stability of log terms\n    eps = 1e-12\n    # Number of components\n    N = 3\n\n    for case in test_cases:\n        z = np.array(case['z'])\n        alpha_vals = case['alphas']\n        \n        # Build the symmetric interaction parameter matrix A\n        A = np.zeros((N, N))\n        A[0, 1] = A[1, 0] = alpha_vals[0]  # alpha_12\n        A[0, 2] = A[2, 0] = alpha_vals[1]  # alpha_13\n        A[1, 2] = A[2, 1] = alpha_vals[2]  # alpha_23\n\n        def g_prime(x, A_matrix):\n            # Clip x to prevent log(0)\n            x_safe = np.maximum(x, eps)\n            ideal_term = np.sum(x_safe * np.log(x_safe))\n            # Regular solution term: 0.5 * sum(A_ij * x_i * x_j) for i!=j\n            # This is equivalent to 0.5 * (x.T @ A @ x)\n            excess_term = 0.5 * np.dot(x, np.dot(A_matrix, x))\n            return ideal_term + excess_term\n\n        def mu_prime(x, A_matrix):\n            x_safe = np.maximum(x, eps)\n            # General formula: mu_k' = g' + dg'/dx_k - sum(x_j * dg'/dx_j)\n            # For regular solution model, this simplifies to:\n            # mu_k' = ln(x_k) + sum_j(A_kj * x_j) - g_excess\n            g_ex = 0.5 * np.dot(x, np.dot(A_matrix, x))\n            mu = np.log(x_safe) + np.dot(A_matrix, x) - g_ex\n            return mu\n        \n        # 1. Calculate dimensionless chemical potentials mu_prime at z\n        mu_prime_at_z = mu_prime(z, A)\n        \n        # 2. Define the TPD objective function\n        def tpd_objective(y):\n            # TPD(y | z) = g(y) - y . mu(z)\n            return g_prime(y, A) - np.dot(y, mu_prime_at_z)\n\n        # 3. Set up the minimization problem\n        # Initial guess for the minimizer\n        y0 = np.full(N, 1/N)\n        \n        # Constraints: sum(y_i) = 1\n        constraints = ({'type': 'eq', 'fun': lambda y: np.sum(y) - 1})\n        \n        # Bounds: y_i >= eps\n        bounds = tuple((eps, 1.0) for _ in range(N))\n        \n        # 4. Perform the minimization\n        res = minimize(tpd_objective, y0, method='SLSQP', bounds=bounds, constraints=constraints)\n        \n        min_tpd = res.fun\n        \n        # 5. Determine stability\n        # Stable if the minimum TPD is non-negative (within a small tolerance)\n        stable = min_tpd >= -1e-9\n        \n        results.append([stable, round(min_tpd, 6)])\n\n    # Format the final output string as specified\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}