{
    "hands_on_practices": [
        {
            "introduction": "Understanding the behavior of thermodynamic systems begins with the simplest case: the ideal solution. This exercise provides fundamental practice in deriving partial molar properties, specifically the chemical potential ($\\mu_i$), from the integral Gibbs free energy of mixing ($G^{\\mathrm{mix}}$). By then validating the Gibbs-Duhem relation for this model, you will confirm the inherent thermodynamic consistency that must exist between the properties of all components in a mixture .",
            "id": "4105011",
            "problem": "Consider a single-phase, three-component, substitutional ideal solution used in computational geochemistry to model configurational mixing among endmembers on a common sublattice. At fixed temperature $T$ and pressure $P$, the mixing contribution to the total Gibbs free energy is given by\n$$\nG^{\\mathrm{mix}}(T,P,\\mathbf{n})=R T \\sum_{i=1}^{3} n_i \\ln x_i,\n$$\nwhere $R$ is the universal gas constant, $n_i$ is the amount of component $i$ in moles, $\\mathbf{n}=(n_1,n_2,n_3)$, $x_i$ is the mole fraction defined by $x_i=n_i/n$, and $n=\\sum_{i=1}^{3} n_i$ is the total number of moles. The system is closed, and composition may change subject to the constraint $\\sum_{i=1}^{3} x_i=1$ at fixed $T$ and $P$.\n\nStarting from the fundamental definition of chemical potential and the provided mixing Gibbs free energy, derive the expressions for the reduced (dimensionless) mixing chemical potentials $\\hat{\\mu}_i=\\mu_i^{\\mathrm{mix}}/(R T)$ for $i=1,2,3$ as functions of the mole fractions $x_i$. Then, validate the Gibbs–Duhem relation (Gibbs–Duhem (GD) relation) at fixed $T$ and $P$ for this mixing model by explicitly evaluating $\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}}$ under the constraint $\\sum_{i=1}^{3} x_i=1$.\n\nAnswer specification:\n- Provide the reduced mixing chemical potentials $\\hat{\\mu}_1$, $\\hat{\\mu}_2$, and $\\hat{\\mu}_3$ symbolically in terms of $x_1$, $x_2$, and $x_3$ without substituting numerical values.\n- Validate the Gibbs–Duhem relation by giving the final scalar value of $\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}}$ at fixed $T$ and $P$ for composition changes that satisfy $\\sum_{i=1}^{3} x_i=1$.\n- Report your final result as a single row matrix in the order $\\hat{\\mu}_1$, $\\hat{\\mu}_2$, $\\hat{\\mu}_3$, and the validated scalar value of $\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}}$.\n- No numerical rounding is required, and no units should be included in the final expressions.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of chemical thermodynamics, well-posed with all necessary information provided, and objective in its formulation. It represents a standard derivation and validation exercise concerning ideal solutions.\n\nThe first task is to derive the reduced mixing chemical potentials, $\\hat{\\mu}_i$, for the three components. The chemical potential of component $i$ in a mixture, $\\mu_i$, is defined as the partial molar Gibbs free energy. For the mixing contribution, this is expressed as:\n$$\n\\mu_i^{\\mathrm{mix}} = \\left( \\frac{\\partial G^{\\mathrm{mix}}}{\\partial n_i} \\right)_{T, P, n_{j \\neq i}}\n$$\nwhere the differentiation is performed at constant temperature $T$, pressure $P$, and amounts of all other components $n_{j \\neq i}$.\n\nThe given expression for the Gibbs free energy of mixing is:\n$$\nG^{\\mathrm{mix}}(T,P,\\mathbf{n})=R T \\sum_{j=1}^{3} n_j \\ln x_j\n$$\nTo facilitate the differentiation, we express the mole fractions $x_j$ and the total moles $n$ in terms of the individual mole amounts $n_k$:\n$$\nx_j = \\frac{n_j}{n} \\quad \\text{where} \\quad n = \\sum_{k=1}^{3} n_k\n$$\nSubstituting this into the expression for $G^{\\mathrm{mix}}$:\n$$\nG^{\\mathrm{mix}} = R T \\sum_{j=1}^{3} n_j \\ln\\left(\\frac{n_j}{n}\\right) = R T \\left( \\sum_{j=1}^{3} n_j \\ln(n_j) - \\sum_{j=1}^{3} n_j \\ln(n) \\right)\n$$\nThe second summation simplifies to $n \\ln(n)$:\n$$\nG^{\\mathrm{mix}} = R T \\left( \\sum_{j=1}^{3} n_j \\ln(n_j) - n \\ln(n) \\right)\n$$\nNow we can compute the partial derivative with respect to $n_i$. We differentiate each term inside the parentheses separately.\n\nFor the first term, $\\sum_{j=1}^{3} n_j \\ln(n_j)$:\n$$\n\\frac{\\partial}{\\partial n_i} \\left( \\sum_{j=1}^{3} n_j \\ln(n_j) \\right) = \\frac{\\partial}{\\partial n_i} (n_i \\ln(n_i)) + \\sum_{j \\neq i} \\frac{\\partial}{\\partial n_i} (n_j \\ln(n_j))\n$$\nSince the amounts $n_{j \\neq i}$ are held constant, the terms in the summation are zero. For the term involving $n_i$, we use the product rule:\n$$\n\\frac{\\partial}{\\partial n_i} (n_i \\ln(n_i)) = 1 \\cdot \\ln(n_i) + n_i \\cdot \\frac{1}{n_i} = \\ln(n_i) + 1\n$$\nFor the second term, $-n \\ln(n)$:\n$$\n\\frac{\\partial}{\\partial n_i} (n \\ln(n))\n$$\nSince $n = \\sum_{k=1}^{3} n_k$, its partial derivative with respect to $n_i$ is $\\frac{\\partial n}{\\partial n_i} = 1$. Using the product rule again:\n$$\n\\frac{\\partial}{\\partial n_i} (n \\ln(n)) = \\frac{\\partial n}{\\partial n_i} \\ln(n) + n \\frac{\\partial(\\ln(n))}{\\partial n_i} = 1 \\cdot \\ln(n) + n \\left( \\frac{1}{n} \\frac{\\partial n}{\\partial n_i} \\right) = \\ln(n) + n \\left( \\frac{1}{n} \\cdot 1 \\right) = \\ln(n) + 1\n$$\nCombining these results, we find the expression for the mixing chemical potential:\n$$\n\\mu_i^{\\mathrm{mix}} = R T \\left[ (\\ln(n_i) + 1) - (\\ln(n) + 1) \\right] = R T (\\ln(n_i) - \\ln(n)) = R T \\ln\\left(\\frac{n_i}{n}\\right)\n$$\nBy definition, the mole fraction is $x_i = n_i/n$, so:\n$$\n\\mu_i^{\\mathrm{mix}} = R T \\ln(x_i)\n$$\nThe problem asks for the reduced (dimensionless) mixing chemical potential, $\\hat{\\mu}_i = \\mu_i^{\\mathrm{mix}}/(R T)$. Dividing the expression above by $R T$ gives:\n$$\n\\hat{\\mu}_i = \\ln(x_i)\n$$\nThis holds for each component, so for $i \\in \\{1, 2, 3\\}$, we have:\n$$\n\\hat{\\mu}_1 = \\ln(x_1), \\quad \\hat{\\mu}_2 = \\ln(x_2), \\quad \\hat{\\mu}_3 = \\ln(x_3)\n$$\n\nThe second task is to validate the Gibbs–Duhem relation at fixed $T$ and $P$. The relation states that for any change in composition:\n$$\n\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}} = 0\n$$\nWe evaluate the left-hand side explicitly using the derived expression for $\\mu_i^{\\mathrm{mix}}$. At constant $T$ and $P$, the differential of $\\mu_i^{\\mathrm{mix}}$ is:\n$$\nd\\mu_i^{\\mathrm{mix}} = d(R T \\ln(x_i)) = R T \\, d(\\ln(x_i)) = R T \\frac{dx_i}{x_i}\n$$\nSubstituting this into the Gibbs–Duhem sum:\n$$\n\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}} = \\sum_{i=1}^{3} n_i \\left( R T \\frac{dx_i}{x_i} \\right)\n$$\nUsing the relationship $n_i = n x_i$, where $n$ is the total number of moles:\n$$\n\\sum_{i=1}^{3} (n x_i) \\left( R T \\frac{dx_i}{x_i} \\right) = \\sum_{i=1}^{3} n R T \\, dx_i\n$$\nWe can factor out the constant terms $n$, $R$, and $T$:\n$$\nn R T \\sum_{i=1}^{3} dx_i = n R T \\, d\\left(\\sum_{i=1}^{3} x_i\\right)\n$$\nThe system is subject to the closure constraint that the sum of mole fractions is always unity:\n$$\n\\sum_{i=1}^{3} x_i = 1\n$$\nThe differential of a constant is zero, therefore:\n$$\nd\\left(\\sum_{i=1}^{3} x_i\\right) = d(1) = 0\n$$\nSubstituting this back into the expression for the Gibbs–Duhem sum:\n$$\n\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}} = n R T \\cdot 0 = 0\n$$\nThis confirms that the Gibbs–Duhem relation is satisfied for the ideal mixing model, and the scalar value of the expression is $0$.\n\nThe final results are the expressions for the reduced chemical potentials $\\hat{\\mu}_1, \\hat{\\mu}_2, \\hat{\\mu}_3$ and the validated value of the Gibbs-Duhem sum.\n$$\n\\hat{\\mu}_1 = \\ln(x_1)\n$$\n$$\n\\hat{\\mu}_2 = \\ln(x_2)\n$$\n$$\n\\hat{\\mu}_3 = \\ln(x_3)\n$$\n$$\n\\sum_{i=1}^{3} n_i \\, d\\mu_i^{\\mathrm{mix}} = 0\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\ln(x_1)  \\ln(x_2)  \\ln(x_3)  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Real geochemical systems, like silicate melts, rarely behave ideally. This practice moves into the realm of non-ideal solutions, demonstrating the power of the Gibbs-Duhem equation as a practical tool for ensuring thermodynamic consistency . You will learn how an empirical model for the activity coefficient of one component can be used to derive the behavior of the other, a vital skill for constructing robust models of multicomponent systems from experimental data.",
            "id": "4105058",
            "problem": "A binary silicate melt composed of components $1$ and $2$ is modeled at fixed temperature $T$ and pressure $P$ using a mole-fraction standard state (Raoult’s law standard state). The chemical potentials are defined by $ \\mu_i = \\mu_i^{\\ast}(T,P) + R T \\ln a_i$, where $a_i$ is the activity of component $i$, $R$ is the universal gas constant, and $\\mu_i^{\\ast}(T,P)$ is the standard chemical potential. Activities are related to mole fractions $x_i$ by $a_i = \\gamma_i x_i$, where $\\gamma_i$ is the activity coefficient. The system is closed, with $x_1 + x_2 = 1$, at fixed $T$ and $P$.\n\nAt $T = 1473\\,\\mathrm{K}$ and $P = 1\\,\\mathrm{bar}$, laboratory data for this melt are represented by an empirical correlation for component $1$:\n$$\n\\ln \\gamma_1(x_2) = A\\, x_2^{2} + B\\, x_2^{3},\n$$\nwhere $A = 1.20$ and $B = -0.50$ are constants at this $T$ and $P$. Assume the Raoult’s law standard-state boundary condition holds, so that $\\lim_{x_i \\to 1} \\gamma_i = 1$.\n\nTasks:\n- Starting only from the Gibbs–Duhem equation at fixed $T$ and $P$, the definition of chemical potential, and the definition of activity, derive an integral relation linking the composition derivatives of $\\ln \\gamma_1$ and $\\ln \\gamma_2$ in this binary mixture, and use it to obtain an explicit closed-form expression for $\\ln \\gamma_2(x_2)$ for the correlation given above. Impose an appropriate boundary condition consistent with the chosen standard state to fix any integration constant.\n- Evaluate $\\gamma_2$ at $x_1 = 0.40$ (so that $x_2 = 0.60$) using your derived expression.\n\nRound your final numerical answer for $\\gamma_2$ to $4$ significant figures. Express the final result as a pure number (dimensionless activity coefficient).",
            "solution": "The fundamental starting points at fixed temperature $T$ and pressure $P$ are:\n- The Gibbs–Duhem equation for a binary mixture, written in differential form as $x_1\\, d\\mu_1 + x_2\\, d\\mu_2 = 0$.\n- The definition of chemical potential in terms of activity: $\\mu_i = \\mu_i^{\\ast}(T,P) + R T \\ln a_i$ with $a_i = \\gamma_i x_i$.\n- The composition constraint $x_1 + x_2 = 1$.\n\nFirst, take the differential of $\\mu_i$ at fixed $T$ and $P$:\n$$\nd\\mu_i = R T\\, d\\ln a_i = R T\\, d\\left(\\ln \\gamma_i + \\ln x_i\\right) = R T\\left(d\\ln \\gamma_i + d\\ln x_i\\right).\n$$\nInsert this into the Gibbs–Duhem equation $x_1\\, d\\mu_1 + x_2\\, d\\mu_2 = 0$:\n$$\nx_1 R T\\left(d\\ln \\gamma_1 + d\\ln x_1\\right) + x_2 R T\\left(d\\ln \\gamma_2 + d\\ln x_2\\right) = 0.\n$$\nDivide by $R T$ and group terms:\n$$\nx_1\\, d\\ln \\gamma_1 + x_2\\, d\\ln \\gamma_2 + x_1\\, d\\ln x_1 + x_2\\, d\\ln x_2 = 0.\n$$\nUse the identity that follows from $x_1 + x_2 = 1$, namely $x_1\\, d\\ln x_1 + x_2\\, d\\ln x_2 = d x_1 + d x_2 = 0$. This yields the simplified Gibbs–Duhem relation for activity coefficients in a binary mixture at fixed $T$ and $P$:\n$$\nx_1\\, d\\ln \\gamma_1 + x_2\\, d\\ln \\gamma_2 = 0.\n$$\nRearrange to relate the differentials:\n$$\nd\\ln \\gamma_2 = -\\frac{x_1}{x_2}\\, d\\ln \\gamma_1.\n$$\nTo integrate this relation, use $x_2$ as the independent variable and note $x_1 = 1 - x_2$. Then\n$$\nd\\ln \\gamma_2 = -\\frac{1 - x_2}{x_2}\\, d\\ln \\gamma_1.\n$$\nImpose the Raoult’s law standard-state boundary condition for component $2$, namely $\\lim_{x_2 \\to 1} \\gamma_2 = 1$, which implies $\\ln \\gamma_2(1) = 0$. Integrate from $x_2 = 1$ to a general $x_2$:\n$$\n\\ln \\gamma_2(x_2) - \\ln \\gamma_2(1) = - \\int_{1}^{x_2} \\frac{1 - u}{u}\\, d\\big(\\ln \\gamma_1(u)\\big),\n$$\nhence\n$$\n\\ln \\gamma_2(x_2) = - \\int_{1}^{x_2} \\frac{1 - u}{u}\\, d\\big(\\ln \\gamma_1(u)\\big).\n$$\n\nNow substitute the empirical correlation $\\ln \\gamma_1(u) = A u^{2} + B u^{3}$. Then\n$$\nd\\big(\\ln \\gamma_1(u)\\big) = \\left(2A u + 3B u^{2}\\right) du,\n$$\nand the integrand becomes\n$$\n-\\frac{1 - u}{u}\\left(2A u + 3B u^{2}\\right) du = -\\left(1 - u\\right)\\left(2A + 3B u\\right) du.\n$$\nTherefore,\n$$\n\\ln \\gamma_2(x_2) = - \\int_{1}^{x_2} \\left[\\left(1 - u\\right)\\left(2A + 3B u\\right)\\right] du.\n$$\nExpand the integrand:\n$$\n\\left(1 - u\\right)\\left(2A + 3B u\\right) = 2A - 2A u + 3B u - 3B u^{2} = 2A + \\left(-2A + 3B\\right) u - 3B u^{2}.\n$$\nIntegrate term by term:\n$$\n\\int \\left[2A + \\left(-2A + 3B\\right) u - 3B u^{2}\\right] du = 2A u + \\frac{\\left(-2A + 3B\\right)}{2} u^{2} - B u^{3}.\n$$\nApply the limits $u = 1$ to $u = x_2$ and include the leading negative sign:\n$$\n\\ln \\gamma_2(x_2) = -\\left[2A x_2 + \\frac{\\left(-2A + 3B\\right)}{2} x_2^{2} - B x_2^{3} - \\left(2A + \\frac{\\left(-2A + 3B\\right)}{2} - B\\right)\\right].\n$$\nSimplify the constant in brackets:\n$$\n2A + \\frac{\\left(-2A + 3B\\right)}{2} - B = A + \\frac{B}{2}.\n$$\nThus a closed-form expression for $\\ln \\gamma_2(x_2)$ is\n$$\n\\ln \\gamma_2(x_2) = - 2A x_2 - \\frac{\\left(-2A + 3B\\right)}{2} x_2^{2} + B x_2^{3} + \\left(A + \\frac{B}{2}\\right).\n$$\n\nNow evaluate at $A = 1.20$, $B = -0.50$, and $x_1 = 0.40$ so that $x_2 = 0.60$. First compute coefficients:\n$$\n-2A + 3B = -2(1.20) + 3(-0.50) = -2.40 - 1.50 = -3.90,\n$$\n$$\nA + \\frac{B}{2} = 1.20 + \\frac{-0.50}{2} = 1.20 - 0.25 = 0.95.\n$$\nEvaluate the polynomial at $x_2 = 0.60$:\n$$\n-2A x_2 = -2(1.20)(0.60) = -1.44,\n$$\n$$\n-\\frac{\\left(-2A + 3B\\right)}{2} x_2^{2} = -\\frac{-3.90}{2} (0.60)^{2} = +1.95 \\times 0.36 = 0.702,\n$$\n$$\nB x_2^{3} = (-0.50)(0.60)^{3} = (-0.50)(0.216) = -0.108.\n$$\nAssemble terms:\n$$\n\\ln \\gamma_2(0.60) = \\left(-1.44\\right) + 0.702 + \\left(-0.108\\right) + 0.95 = 0.104.\n$$\nFinally, compute $\\gamma_2$:\n$$\n\\gamma_2(0.60) = \\exp\\!\\left(0.104\\right) \\approx 1.1096.\n$$\nRounded to $4$ significant figures, the result is $1.110$. The activity coefficient is dimensionless.",
            "answer": "$$\\boxed{1.110}$$"
        },
        {
            "introduction": "This advanced practice bridges thermodynamic theory with computational implementation to address a central question in geochemistry: is a single-phase solution stable, or will it spontaneously separate into multiple phases? You will derive and implement the Tangent Plane Distance (TPD) criterion, a powerful algorithm that translates the geometric condition of Gibbs energy convexity into a quantitative stability test . Mastering this technique provides insight into the formation of miscibility gaps and exsolution textures observed in natural minerals.",
            "id": "4105002",
            "problem": "You are tasked with constructing and programmatically implementing the Tangent Plane Distance (TPD) stability test for a multicomponent geochemical system at constant temperature and pressure. The goal is to determine whether a single homogeneous phase of a mixture is stable with respect to infinitesimal phase separation. Base your derivation and implementation on fundamental thermodynamic principles that hold for closed systems at fixed temperature and pressure.\n\nStart from the following foundational base:\n\n- For a closed, multicomponent system at fixed temperature and pressure, stability of a single phase is governed by the convexity of the molar Gibbs free energy of mixing, denoted by $g(\\boldsymbol{x})$, where $\\boldsymbol{x} = (x_1, x_2, \\dots, x_N)$ are the mole fractions satisfying $\\sum_{i=1}^N x_i = 1$ and $x_i \\ge 0$.\n- The total Gibbs free energy is $G = n \\, g(\\boldsymbol{x})$, with total moles $n = \\sum_{i=1}^N n_i$, and the chemical potential of component $i$ is defined by $\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j \\ne i}}$.\n\nYour task is to:\n\n1. Derive the mathematical form of the Tangent Plane Distance (TPD) at a reference composition $\\boldsymbol{z}$ by applying the geometric tangent plane construction to $g(\\boldsymbol{x})$ and leveraging the definition of the chemical potentials. Explicitly construct a scalar function $D(\\boldsymbol{y} \\mid \\boldsymbol{z})$ such that the sign of its global minimum over the composition simplex ($\\sum_i y_i = 1$, $y_i \\ge 0$) determines stability of the phase at $\\boldsymbol{z}$. Your derivation must begin from the fundamental definitions given above and must not assume any shortcut formulas.\n\n2. Specialize $g(\\boldsymbol{x})$ to a physically plausible, widely used, and computationally tractable nonideal regular solution model appropriate for geochemical mixtures:\n   $$\\frac{g(\\boldsymbol{x})}{R T} = \\sum_{i=1}^N x_i \\ln x_i + \\sum_{1 \\le i  j \\le N} \\alpha_{ij} \\, x_i x_j,$$\n   where $R$ is the universal gas constant, $T$ is absolute temperature, and $\\alpha_{ij}$ are dimensionless symmetric interaction parameters ($\\alpha_{ij} = \\alpha_{ji}$) encapsulating deviations from ideal mixing. All calculations must be performed in dimensionless form, i.e., in units of $g/(R T)$, $\\mu_i/(R T)$, and $D/(R T)$.\n\n3. Construct an algorithm to compute $\\boldsymbol{\\mu}(\\boldsymbol{z})/(R T)$ from $g(\\boldsymbol{x})/(R T)$ using only the fundamental definition $\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j \\ne i}}$ and the constraint $\\sum_i x_i = 1$. Your derivation must yield an implementable expression for $\\mu_i/(R T)$ that uses partial derivatives of $g(\\boldsymbol{x})/(R T)$ with respect to $x_i$ and enforces the composition constraint.\n\n4. Implement the TPD minimization over the composition simplex with the equality constraint $\\sum_i y_i = 1$ and bound constraints $y_i \\ge \\varepsilon$ for a small positive $\\varepsilon$ to maintain numerical robustness for terms involving $\\ln y_i$. The algorithm must determine whether the minimum of $D(\\boldsymbol{y} \\mid \\boldsymbol{z})/(R T)$ is nonnegative (stable) or negative (unstable). Report the global minimum value of $D(\\boldsymbol{y} \\mid \\boldsymbol{z})/(R T)$ and the stability decision as a boolean.\n\n5. Use the following test suite, which covers a range of geochemically relevant behaviors, including a stable case, a strongly unstable case, near-boundary compositions, moderate nonideality, and asymmetric interactions. Each test is a three-component mixture ($N = 3$). In each case the temperature $T$ is a parameter but, for this model, only the dimensionless quantities are used. The interaction parameters are symmetric. All numeric values below must be treated as dimensionless in the program, and all floats must be reported without units:\n   - Test $1$ (happy path, expected stable): $\\boldsymbol{z} = (0.2, 0.5, 0.3)$, with $\\alpha_{12} = 0.2$, $\\alpha_{13} = 0.2$, $\\alpha_{23} = 0.2$.\n   - Test $2$ (strongly nonideal, expected unstable near equimolar): $\\boldsymbol{z} = (1/3, 1/3, 1/3)$, with $\\alpha_{12} = 4.0$, $\\alpha_{13} = 4.0$, $\\alpha_{23} = 4.0$.\n   - Test $3$ (near-boundary composition): $\\boldsymbol{z} = (0.98, 0.01, 0.01)$, with $\\alpha_{12} = 3.0$, $\\alpha_{13} = 3.0$, $\\alpha_{23} = 0.5$.\n   - Test $4$ (moderate nonideality, near-convex): $\\boldsymbol{z} = (0.4, 0.4, 0.2)$, with $\\alpha_{12} = 1.0$, $\\alpha_{13} = 1.0$, $\\alpha_{23} = 1.0$.\n   - Test $5$ (asymmetric interactions): $\\boldsymbol{z} = (0.6, 0.1, 0.3)$, with $\\alpha_{12} = 2.5$, $\\alpha_{13} = 0.1$, $\\alpha_{23} = 2.5$.\n\n6. Numerical requirements and output specification:\n   - All computations must be carried out on the composition simplex with the constraint $\\sum_i y_i = 1$ and bounds $y_i \\in [\\varepsilon, 1 - (N-1)\\varepsilon]$ for a small $\\varepsilon$ selected to ensure numerical stability of $\\ln y_i$ terms. Use $\\varepsilon = 10^{-12}$.\n   - For each test case, your program must return a two-element list $[\\text{stable}, \\text{min\\_tpd}]$, where $\\text{stable}$ is a boolean indicating whether the minimum tangent plane distance is nonnegative within numerical tolerance, and $\\text{min\\_tpd}$ is the minimum of $D(\\boldsymbol{y} \\mid \\boldsymbol{z})/(R T)$ over the feasible simplex, expressed as a float rounded to six decimal places.\n   - The final output format must be a single line containing a comma-separated list of the five per-test results, enclosed in square brackets, with each per-test result itself enclosed in square brackets. For example, the output must look like\n     $$[[\\text{True}, 0.000000],[\\text{False}, -0.123456],[\\text{True}, 0.000789],[\\text{True}, 0.000000],[\\text{False}, -0.010000]].$$\n   - All floats reported are dimensionless numbers, rounded to six decimal places. No physical units should be included.\n\nYour program must be a single, runnable script that takes no user input and prints only the required single-line output in the exact specified format.",
            "solution": "The problem requires the derivation and implementation of the Tangent Plane Distance (TPD) stability test for a multicomponent mixture at constant temperature and pressure. The solution proceeds in four stages: (1) derivation of the TPD criterion from fundamental thermodynamic principles, (2) derivation of the chemical potential expressions for the specified regular solution model, (3) formulation of the computational algorithm for TPD minimization, and (4) implementation of the algorithm to solve the provided test cases.\n\n**1. Derivation of the Tangent Plane Distance (TPD) Criterion**\n\nFor a closed system at constant temperature $T$ and pressure $P$, the condition for thermodynamic stability of a homogeneous phase is that its molar Gibbs free energy, $g(\\boldsymbol{x})$, must be a convex function over the composition simplex defined by mole fractions $\\boldsymbol{x} = (x_1, \\dots, x_N)$ where $\\sum_{i=1}^N x_i = 1$ and $x_i \\ge 0$.\n\nA function is convex at a point if its surface lies on or above all of its tangent planes. Let us consider a reference composition $\\boldsymbol{z}$. The equation for the tangent hyperplane to the $g(\\boldsymbol{x})$ surface at $\\boldsymbol{z}$ is given by a linear combination of the chemical potentials at that composition, $\\boldsymbol{\\mu}(\\boldsymbol{z})$. The value of this tangent plane at an arbitrary composition $\\boldsymbol{y}$ is:\n$$ T_z(\\boldsymbol{y}) = \\sum_{i=1}^N y_i \\mu_i(\\boldsymbol{z}) $$\nThis plane passes through the point $(\\boldsymbol{z}, g(\\boldsymbol{z}))$ on the energy surface, since the Gibbs energy itself can be expressed as $g(\\boldsymbol{z}) = \\sum_{i=1}^N z_i \\mu_i(\\boldsymbol{z})$.\n\nThe Tangent Plane Distance, $D(\\boldsymbol{y} \\mid \\boldsymbol{z})$, is defined as the difference between the molar Gibbs energy at composition $\\boldsymbol{y}$ and the value of the tangent plane (constructed at $\\boldsymbol{z}$) evaluated at $\\boldsymbol{y}$.\n$$ D(\\boldsymbol{y} \\mid \\boldsymbol{z}) = g(\\boldsymbol{y}) - T_z(\\boldsymbol{y}) = g(\\boldsymbol{y}) - \\sum_{i=1}^N y_i \\mu_i(\\boldsymbol{z}) $$\nThe condition for stability of the phase at composition $\\boldsymbol{z}$ is that the Gibbs energy of the homogeneous phase must be lower than or equal to that of any combination of separated phases. This translates to the geometric condition that the entire surface $g(\\boldsymbol{y})$ must lie on or above the tangent plane at $\\boldsymbol{z}$. Therefore, the phase at $\\boldsymbol{z}$ is stable if and only if $D(\\boldsymbol{y} \\mid \\boldsymbol{z}) \\ge 0$ for all valid compositions $\\boldsymbol{y}$.\n\nThe stability test thus reduces to finding the global minimum of the TPD function over the composition simplex.\n$$ \\min_{\\boldsymbol{y}} D(\\boldsymbol{y} \\mid \\boldsymbol{z}) \\ge 0 \\implies \\text{Stable} $$\n$$ \\min_{\\boldsymbol{y}} D(\\boldsymbol{y} \\mid \\boldsymbol{z})  0 \\implies \\text{Unstable} $$\nSince $D(\\boldsymbol{z} \\mid \\boldsymbol{z}) = g(\\boldsymbol{z}) - \\sum_{i=1}^N z_i \\mu_i(\\boldsymbol{z}) = 0$, the minimum value is always less than or equal to zero. Stability is determined by whether this minimum is strictly negative or zero (within numerical precision).\n\n**2. Derivation of Chemical Potentials for the Regular Solution Model**\n\nTo use the TPD criterion, we need an expression for the chemical potential, $\\mu_k$. We derive this from its fundamental definition, $\\mu_k = \\left(\\frac{\\partial G}{\\partial n_k}\\right)_{T,P,n_{j \\ne k}}$, where $G=n g(\\boldsymbol{x})$ is the total Gibbs energy, $n=\\sum_i n_i$ is the total moles, and $x_i = n_i/n$ is the mole fraction.\n\nUsing the product and chain rules:\n$$ \\mu_k = \\frac{\\partial (n g)}{\\partial n_k} = g \\frac{\\partial n}{\\partial n_k} + n \\frac{\\partial g}{\\partial n_k} = g \\cdot 1 + n \\sum_{j=1}^N \\frac{\\partial g}{\\partial x_j} \\frac{\\partial x_j}{\\partial n_k} $$\nThe partial derivative of a mole fraction $x_j=n_j/n$ with respect to moles $n_k$ is:\n$$ \\frac{\\partial x_j}{\\partial n_k} = \\frac{\\partial}{\\partial n_k}\\left(\\frac{n_j}{n}\\right) = \\frac{\\delta_{jk}n - n_j(1)}{n^2} = \\frac{\\delta_{jk} - x_j}{n} $$\nwhere $\\delta_{jk}$ is the Kronecker delta. Substituting this into the expression for $\\mu_k$:\n$$ \\mu_k = g(\\boldsymbol{x}) + n \\sum_{j=1}^N \\frac{\\partial g}{\\partial x_j} \\frac{\\delta_{jk} - x_j}{n} = g(\\boldsymbol{x}) + \\sum_{j=1}^N \\frac{\\partial g}{\\partial x_j} (\\delta_{jk} - x_j) $$\n$$ \\mu_k(\\boldsymbol{x}) = g(\\boldsymbol{x}) + \\frac{\\partial g(\\boldsymbol{x})}{\\partial x_k} - \\sum_{j=1}^N x_j \\frac{\\partial g(\\boldsymbol{x})}{\\partial x_j} $$\nThis is a general expression for the chemical potential for any molar property $g$. We now specialize this for the given dimensionless regular solution model, $g'(\\boldsymbol{x}) = g(\\boldsymbol{x})/(RT)$:\n$$ g'(\\boldsymbol{x}) = \\sum_{i=1}^N x_i \\ln x_i + \\sum_{1 \\le i  j \\le N} \\alpha_{ij} x_i x_j $$\nWe need the partial derivatives $\\partial g'/\\partial x_k$.\n$$ \\frac{\\partial g'}{\\partial x_k} = \\frac{\\partial}{\\partial x_k}\\left(\\sum_i x_i \\ln x_i\\right) + \\frac{\\partial}{\\partial x_k}\\left(\\sum_{ij} \\alpha_{ij} x_i x_j\\right) = (\\ln x_k + 1) + \\sum_{j \\ne k} \\alpha_{kj} x_j $$\nNext, we compute the summation term $\\sum_j x_j (\\partial g'/\\partial x_j)$:\n$$ \\sum_{j=1}^N x_j \\frac{\\partial g'}{\\partial x_j} = \\sum_{j=1}^N x_j \\left(\\ln x_j + 1 + \\sum_{i \\ne j} \\alpha_{ji} x_i \\right) = \\sum_j x_j \\ln x_j + \\sum_j x_j + \\sum_j \\sum_{i \\ne j} \\alpha_{ji} x_j x_i $$\n$$ = \\sum_j x_j \\ln x_j + 1 + 2 \\sum_{ij} \\alpha_{ij} x_i x_j $$\nSubstituting these components into the expression for the dimensionless chemical potential, $\\mu_k'(\\boldsymbol{z}) = \\mu_k(\\boldsymbol{z})/(RT)$, evaluated at reference composition $\\boldsymbol{z}$:\n$$ \\mu_k'(\\boldsymbol{z}) = g'(\\boldsymbol{z}) + \\left(\\frac{\\partial g'}{\\partial x_k}\\right)_{\\boldsymbol{z}} - \\sum_{j=1}^N z_j \\left(\\frac{\\partial g'}{\\partial x_j}\\right)_{\\boldsymbol{z}} $$\n$$ \\mu_k'(\\boldsymbol{z}) = \\left(\\sum_i z_i \\ln z_i + \\sum_{ij} \\alpha_{ij} z_i z_j\\right) + \\left(\\ln z_k + 1 + \\sum_{j \\ne k} \\alpha_{kj} z_j\\right) - \\left(\\sum_j z_j \\ln z_j + 1 + 2\\sum_{ij} \\alpha_{ij} z_i z_j\\right) $$\nSimplifying this expression by canceling terms yields the final computable formula:\n$$ \\mu_k'(\\boldsymbol{z}) = \\ln z_k + \\sum_{j \\ne k} \\alpha_{kj} z_j - \\sum_{ij} \\alpha_{ij} z_i z_j $$\n\n**3. Algorithmic Formulation for TPD Minimization**\n\nThe stability test is now formulated as the following constrained nonlinear optimization problem: find the minimum of the objective function\n$$ f(\\boldsymbol{y}) = D'(\\boldsymbol{y} \\mid \\boldsymbol{z}) = g'(\\boldsymbol{y}) - \\sum_{i=1}^N y_i \\mu_i'(\\boldsymbol{z}) $$\n$$ f(\\boldsymbol{y}) = \\left( \\sum_{i=1}^N y_i \\ln y_i + \\sum_{1 \\le i  j \\le N} \\alpha_{ij} y_i y_j \\right) - \\sum_{i=1}^N y_i \\mu_i'(\\boldsymbol{z}) $$\nsubject to the constraints:\n1.  Equality constraint: $\\sum_{i=1}^N y_i = 1$\n2.  Bound constraints: $y_i \\ge \\varepsilon$ for all $i=1, \\dots, N$, where $\\varepsilon=10^{-12}$ is a small positive constant to avoid numerical issues with the $\\ln y_i$ term.\n\nThe algorithmic procedure for each test case is as follows:\n1.  Given $\\boldsymbol{z}$ and $\\{\\alpha_{ij}\\}$, construct the symmetric interaction matrix $\\boldsymbol{A}$ where $A_{ij} = \\alpha_{ij}$ for $i \\ne j$ and $A_{ii}=0$.\n2.  Calculate the vector of constant dimensionless chemical potentials $\\boldsymbol{\\mu}'(\\boldsymbol{z})$ using the derived formula.\n3.  Define the objective function $f(\\boldsymbol{y})$ as shown above. This function is a scalar function of the vector variable $\\boldsymbol{y}$.\n4.  Since the objective function may be non-convex, a local optimization algorithm might find a local, rather than global, minimum. To mitigate this, we employ a multi-start strategy. We run the optimizer from several different initial guesses for $\\boldsymbol{y}$ and select the lowest minimum found. Prudent choices for initial guesses include the reference composition $\\boldsymbol{z}$ itself and compositions near the vertices of the simplex (e.g., $[1-2\\varepsilon, \\varepsilon, \\varepsilon]$ and its permutations for $N=3$).\n5.  The `scipy.optimize.minimize` function with the `SLSQP` (Sequential Least Squares Programming) method is well-suited for this problem, as it handles both equality and bound constraints.\n6.  The smallest minimum value obtained from all starting points, $\\min(D')$, is compared to zero. A small negative tolerance (e.g., $-10^{-9}$) is used to account for numerical precision limits. If $\\min(D')  -10^{-9}$, the system is declared unstable (False); otherwise, it is stable (True).\n\nThis procedure provides a robust method for determining the phase stability of the mixture as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the Tangent Plane Distance (TPD) stability problem for five test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # z = (z1, z2, z3), alphas = (alpha12, alpha13, alpha23)\n        {'z': (0.2, 0.5, 0.3), 'alphas': (0.2, 0.2, 0.2)},\n        {'z': (1/3, 1/3, 1/3), 'alphas': (4.0, 4.0, 4.0)},\n        {'z': (0.98, 0.01, 0.01), 'alphas': (3.0, 3.0, 0.5)},\n        {'z': (0.4, 0.4, 0.2), 'alphas': (1.0, 1.0, 1.0)},\n        {'z': (0.6, 0.1, 0.3), 'alphas': (2.5, 0.1, 2.5)},\n    ]\n\n    results = []\n    \n    # Small positive constant for numerical stability of log terms\n    eps = 1e-12\n    # Number of components\n    N = 3\n\n    for case in test_cases:\n        z = np.array(case['z'])\n        alpha_vals = case['alphas']\n        \n        # Build the symmetric interaction parameter matrix A\n        A = np.zeros((N, N))\n        A[0, 1] = A[1, 0] = alpha_vals[0]  # alpha_12\n        A[0, 2] = A[2, 0] = alpha_vals[1]  # alpha_13\n        A[1, 2] = A[2, 1] = alpha_vals[2]  # alpha_23\n\n        # 1. Calculate dimensionless chemical potentials mu_prime at z\n        # mu_k' = ln(z_k) + sum_{j!=k} alpha_kj*z_j - sum_{ij} alpha_ij*z_i*z_j\n        \n        # Scalar term: sum_{ij} alpha_ij*z_i*z_j can be written as 0.5 * z.T @ A @ z\n        scalar_term = 0.5 * z.T @ A @ z\n        \n        # Vector term: sum_{j!=k} alpha_kj*z_j is the k-th element of A @ z\n        vector_term = A @ z\n        \n        # Log term: ln(z_k)\n        log_term = np.log(z)\n        \n        mu_prime_z = log_term + vector_term - scalar_term\n\n        # 2. Define the TPD objective function to be minimized\n        # D'(y|z) = g'(y) - y . mu'(z)\n        # g'(y) = sum(y_i * ln(y_i)) + 0.5 * y.T @ A @ y\n        def tpd_objective(y):\n            # The log term might produce NaN if y is not strictly positive.\n            # The bounds should prevent this, but an extra check is safe.\n            if np.any(y = 0):\n                return np.inf\n            g_prime_y = np.sum(y * np.log(y)) + 0.5 * y.T @ A @ y\n            tpd = g_prime_y - np.dot(y, mu_prime_z)\n            return tpd\n\n        # 3. Set up constraints and bounds for the optimizer\n        constraints = ({'type': 'eq', 'fun': lambda y: np.sum(y) - 1.0})\n        bounds = [(eps, 1.0) for _ in range(N)]\n\n        # 4. Perform minimization from multiple starting points to find the global minimum\n        y0_list = [\n            z,  # The reference composition itself\n            np.array([1.0 - 2 * eps, eps, eps]),       # Vertex 1\n            np.array([eps, 1.0 - 2 * eps, eps]),       # Vertex 2\n            np.array([eps, eps, 1.0 - 2 * eps]),       # Vertex 3\n        ]\n\n        min_tpd_global = np.inf\n        \n        for y0 in y0_list:\n            res = minimize(tpd_objective, y0, method='SLSQP',\n                           bounds=bounds, constraints=constraints, tol=1e-12)\n            if res.success and res.fun  min_tpd_global:\n                min_tpd_global = res.fun\n        \n        # 5. Determine stability and format output\n        # System is stable if the minimum TPD is non-negative (within a small tolerance)\n        stable = min_tpd_global = -1e-9\n        \n        # The problem asks for rounding to six decimal places\n        min_tpd_rounded = round(min_tpd_global, 6)\n        \n        # A negative zero exists, explicitly handle it\n        if abs(min_tpd_rounded)  1e-7:\n            min_tpd_rounded = 0.0\n\n        results.append(f\"[{'True' if stable else 'False'}, {min_tpd_rounded:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}