{
    "hands_on_practices": [
        {
            "introduction": "The chemical potential is the fundamental quantity governing mass transfer and phase equilibrium. This exercise provides a direct calculation of chemical potential from thermodynamic activity, a measure of a component's \"effective concentration.\" By applying the core relationship $\\mu_i - \\mu_i^\\circ = RT \\ln a_i$ to a practical scenario in materials science, you will solidify your understanding of this foundational concept before moving to more complex systems. ",
            "id": "1288847",
            "problem": "During a high-temperature carburizing process used to harden steel components, a steel sample is held in a carbon-rich atmosphere at a constant temperature of 1000 °C. After reaching equilibrium, the thermodynamic activity of carbon ($a_C$) dissolved within the steel is measured to be 0.5. The standard state for the activity of carbon is defined as pure graphite at the same temperature and pressure.\n\nCalculate the chemical potential of carbon in the steel relative to the chemical potential of carbon in its standard state (pure graphite) at this temperature. Use the universal gas constant $R = 8.314 \\text{ J/(mol·K)}$. Express your final answer in kilojoules per mole (kJ/mol), rounded to three significant figures.",
            "solution": "The chemical potential of a solute in a phase relative to its standard state is given by the activity expression\n$$\\mu_{C} = \\mu_{C}^{\\circ} + RT \\ln a_{C}.$$\nTherefore, the difference relative to the standard state is\n$$\\Delta \\mu_{C} \\equiv \\mu_{C} - \\mu_{C}^{\\circ} = RT \\ln a_{C}.$$\n\nGiven $a_{C} = 0.5$ and temperature $T$ equal to $1000$ Celsius, convert to Kelvin:\n$$T = 1000 + 273.15 = 1273.15 \\text{ K}.$$\nSubstitute values:\n$$\\Delta \\mu_{C} = \\left(8.314 \\text{ J mol}^{-1} \\text{ K}^{-1}\\right)\\left(1273.15 \\text{ K}\\right)\\ln(0.5).$$\nUse $\\ln(0.5) = -\\ln 2$:\n$$\\Delta \\mu_{C} = \\left(8.314 \\times 1273.15\\right)\\left(-0.693147\\right) \\text{ J mol}^{-1}.$$\nCompute $RT$ and the product:\n$$RT = 10584.9691 \\text{ J mol}^{-1}, \\quad \\Delta \\mu_{C} \\approx -7336.94 \\text{ J mol}^{-1}.$$\nConvert to kilojoules per mole and round to three significant figures:\n$$\\Delta \\mu_{C} \\approx -7.33694 \\text{ kJ mol}^{-1} \\to -7.34 \\text{ kJ mol}^{-1}.$$",
            "answer": "$$\\boxed{-7.34}$$"
        },
        {
            "introduction": "While the concept of activity is powerful, calculating it for fluids under high pressure requires moving beyond ideal-gas assumptions. This practice introduces the use of an equation of state (EOS) to determine the fugacity and, consequently, the chemical potential of a real fluid under geologic conditions. By working through the Peng-Robinson EOS for a single-component system like $\\text{CO}_2$, you will develop the essential computational skills needed to model geochemical fluids accurately. ",
            "id": "4103841",
            "problem": "A carbon dioxide reservoir gas in a deep geothermal system is at temperature $T=500\\ \\mathrm{K}$ and pressure $P=150\\ \\mathrm{bar}$. Treat the gas as a single-component real fluid and use the Peng–Robinson equation of state (EOS) to evaluate the fugacity coefficient $\\phi(T,P)$ and fugacity $f$. The reference state is the ideal-gas standard at $P^{\\circ}=1\\ \\mathrm{bar}$ for the same $T$. The objective is to compute the quantity $\\mu_{\\mathrm{CO}_2}(T,P)-\\mu^{\\circ}_{\\mathrm{CO}_2}(T,P^{\\circ})$, where $\\mu_{\\mathrm{CO}_2}$ is the chemical potential of carbon dioxide under reservoir conditions and $\\mu^{\\circ}_{\\mathrm{CO}_2}$ is the standard-state chemical potential of the ideal gas.\n\nUse the following pure-component properties for carbon dioxide:\n- Critical temperature $T_{c}=304.1282\\ \\mathrm{K}$,\n- Critical pressure $P_{c}=73.773\\ \\mathrm{bar}$,\n- Acentric factor $\\omega=0.225$.\n\nUse the following constants in your thermodynamic modeling:\n- Universal gas constant in energy units $R=8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$,\n- Universal gas constant in pressure–volume units $R=0.08314\\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}}$.\n\nAssume single-phase gas behavior at the stated conditions. Report the final value of $\\mu_{\\mathrm{CO}_2}(T,P)-\\mu^{\\circ}_{\\mathrm{CO}_2}(T,P^{\\circ})$ in $\\mathrm{kJ\\ mol^{-1}}$, and round your answer to four significant figures.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **System**: Carbon dioxide ($\\mathrm{CO}_2$) reservoir gas, treated as a single-component real fluid.\n- **State Conditions**: Temperature $T=500\\ \\mathrm{K}$, Pressure $P=150\\ \\mathrm{bar}$.\n- **Thermodynamic Model**: Peng–Robinson equation of state (EOS).\n- **Reference State**: Ideal-gas standard at pressure $P^{\\circ}=1\\ \\mathrm{bar}$ and temperature $T=500\\ \\mathrm{K}$.\n- **Objective**: Compute the chemical potential difference $\\mu_{\\mathrm{CO}_2}(T,P)-\\mu^{\\circ}_{\\mathrm{CO}_2}(T,P^{\\circ})$.\n- **$\\mathrm{CO}_2$ Properties**:\n    - Critical temperature $T_{c}=304.1282\\ \\mathrm{K}$\n    - Critical pressure $P_{c}=73.773\\ \\mathrm{bar}$\n    - Acentric factor $\\omega=0.225$\n- **Constants**:\n    - Universal gas constant $R=8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n    - Universal gas constant $R=0.08314\\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}}$\n- **Assumption**: The system is in a single-phase gas state.\n- **Reporting Requirement**: Report the final value in $\\mathrm{kJ\\ mol^{-1}}$, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Soundness**: The problem is scientifically sound. It employs the Peng–Robinson equation of state, a widely accepted model for real fluid behavior in chemical engineering and geochemistry. The concepts of chemical potential, fugacity, and standard states are fundamental principles of chemical thermodynamics. The provided physical properties for $\\mathrm{CO}_2$ are standard literature values.\n2.  **Non-Formalizable or Irrelevant**: The problem is a standard, formalizable exercise in applied thermodynamics and is directly relevant to the field of computational geochemistry.\n3.  **Incomplete or Contradictory Setup**: The problem is well-defined and self-contained. It provides all necessary parameters ($T$, $P$, $T_c$, $P_c$, $\\omega$), constants ($R$), and a clear objective. The provision of two values for the gas constant $R$ in different units is not a contradiction but a practical convenience for calculations involving different physical quantities (energy vs. pressure-volume).\n4.  **Unrealistic or Infeasible**: The conditions ($T=500\\ \\mathrm{K}$, $P=150\\ \\mathrm{bar}$) are physically plausible for deep geological or geothermal systems. The data are dimensionally consistent.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. Given the specified EOS and parameters, a unique and meaningful solution for the chemical potential difference exists. The assumption of a single-phase gas simplifies the calculation by removing the need for phase stability analysis, which is a valid pedagogical choice and does not render the problem ill-posed.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem is not trivial. It requires a multi-step calculation involving the determination of EOS parameters, solving a cubic equation for the compressibility factor, and evaluating the expression for the fugacity coefficient, which constitutes a substantive exercise in applied thermodynamics.\n7.  **Outside Scientific Verifiability**: The calculation is deterministic and can be independently verified.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\nThe difference in chemical potential between a real fluid state at $(T, P)$ and an ideal gas standard state at $(T, P^{\\circ})$ is given by the fundamental thermodynamic relation:\n$$ \\mu(T,P) - \\mu^{\\circ}(T,P^{\\circ}) = RT \\ln\\left(\\frac{f(T,P)}{f^{\\circ}(T,P^{\\circ})}\\right) $$\nwhere $f$ is the fugacity. The reference state is an ideal gas, for which fugacity is equal to pressure, so $f^{\\circ}(T,P^{\\circ}) = P^{\\circ}$. The fugacity of the real gas is related to its pressure via the fugacity coefficient, $\\phi$, such that $f(T,P) = \\phi(T,P) \\cdot P$. Substituting these definitions yields:\n$$ \\mu(T,P) - \\mu^{\\circ}(T,P^{\\circ}) = RT \\ln\\left(\\frac{\\phi P}{P^{\\circ}}\\right) = RT \\ln(\\phi) + RT \\ln\\left(\\frac{P}{P^{\\circ}}\\right) $$\nThe problem is thus reduced to calculating the fugacity coefficient $\\phi(T,P)$ using the Peng–Robinson (PR) equation of state.\n\nThe PR-EOS is given by:\n$$ P = \\frac{RT}{V_m - b} - \\frac{a(T)}{V_m(V_m+b) + b(V_m-b)} $$\nwhere $V_m$ is the molar volume. The component-specific parameters $a(T)$ and $b$ are determined from the critical properties ($T_c$, $P_c$) and the acentric factor ($\\omega$).\n\nFirst, we calculate the temperature-dependent parameter $a(T)$:\n$$ a(T) = a_c \\alpha(T) $$\nwhere\n$$ a_c = 0.457235 \\frac{(RT_c)^2}{P_c} $$\n$$ \\alpha(T) = \\left[1 + \\kappa \\left(1 - \\sqrt{\\frac{T}{T_c}}\\right)\\right]^2 $$\n$$ \\kappa = 0.37464 + 1.54226\\omega - 0.26992\\omega^2 $$\nThe parameter $b$ is constant:\n$$ b = 0.077796 \\frac{RT_c}{P_c} $$\nFor these calculations, it is convenient to use the gas constant in pressure-volume units, $R=0.08314\\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}}$.\n\nGiven data: $T=500\\ \\mathrm{K}$, $P=150\\ \\mathrm{bar}$, $T_c=304.1282\\ \\mathrm{K}$, $P_c=73.773\\ \\mathrm{bar}$, $\\omega=0.225$.\n\n1.  **Calculate PR parameters for $\\mathrm{CO}_2$**:\n    The reduced temperature is $T_r = \\frac{T}{T_c} = \\frac{500}{304.1282} \\approx 1.64402$.\n    The parameter $\\kappa$ is:\n    $$ \\kappa = 0.37464 + 1.54226(0.225) - 0.26992(0.225)^2 \\approx 0.707975 $$\n    The temperature correction factor $\\alpha(T)$ is:\n    $$ \\alpha(T_r) = [1 + 0.707975(1 - \\sqrt{1.64402})]^2 \\approx [1 + 0.707975(1 - 1.282195)]^2 \\approx (0.80023)^2 \\approx 0.64037 $$\n    The parameters $a_c$ and $b$ are:\n    $$ a_c = 0.457235 \\frac{(0.08314 \\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}} \\times 304.1282\\ \\mathrm{K})^2}{73.773\\ \\mathrm{bar}} \\approx 3.9647\\ \\mathrm{L^2\\ bar\\ mol^{-2}} $$\n    $$ b = 0.077796 \\frac{0.08314 \\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}} \\times 304.1282\\ \\mathrm{K}}{73.773\\ \\mathrm{bar}} \\approx 0.026669\\ \\mathrm{L\\ mol^{-1}} $$\n    Thus, the temperature-dependent parameter $a(T)$ is:\n    $$ a(T) = a_c \\alpha(T_r) = 3.9647 \\times 0.64037 \\approx 2.5389\\ \\mathrm{L^2\\ bar\\ mol^{-2}} $$\n\n2.  **Solve for the Compressibility Factor ($Z$)**:\n    The PR-EOS can be written as a cubic equation in terms of the compressibility factor $Z = \\frac{PV_m}{RT}$:\n    $$ Z^3 - (1-B)Z^2 + (A - 3B^2 - 2B)Z - (AB - B^2 - B^3) = 0 $$\n    where $A$ and $B$ are dimensionless parameters:\n    $$ A = \\frac{a(T)P}{(RT)^2} \\quad \\text{and} \\quad B = \\frac{bP}{RT} $$\n    Using $T=500\\ \\mathrm{K}$ and $P=150\\ \\mathrm{bar}$:\n    $$ RT = 0.08314 \\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}} \\times 500\\ \\mathrm{K} = 41.57 \\ \\mathrm{L\\ bar\\ mol^{-1}} $$\n    $$ A = \\frac{2.5389 \\times 150}{(41.57)^2} \\approx 0.22039 $$\n    $$ B = \\frac{0.026669 \\times 150}{41.57} \\approx 0.09623 $$\n    Substituting $A$ and $B$ into the cubic equation:\n    $$ Z^3 - (1 - 0.09623)Z^2 + (0.22039 - 3(0.09623)^2 - 2(0.09623))Z - (0.22039 \\cdot 0.09623 - (0.09623)^2 - (0.09623)^3) = 0 $$\n    $$ Z^3 - 0.90377 Z^2 + 0.00015 Z - 0.011057 = 0 $$\n    Solving this cubic equation for $Z$ yields one real root (consistent with a single-phase fluid above its critical temperature), which is the one we must use. The root is:\n    $$ Z \\approx 0.91638 $$\n\n3.  **Calculate the Fugacity Coefficient ($\\phi$)**:\n    For the PR-EOS, the natural logarithm of the fugacity coefficient is given by:\n    $$ \\ln\\phi = Z - 1 - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\ln\\left[\\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B}\\right] $$\n    Substituting the values for $Z$, $A$, and $B$:\n    $$ Z - 1 = 0.91638 - 1 = -0.08362 $$\n    $$ \\ln(Z-B) = \\ln(0.91638 - 0.09623) = \\ln(0.82015) \\approx -0.19828 $$\n    $$ \\frac{A}{2\\sqrt{2}B} = \\frac{0.22039}{2\\sqrt{2} \\times 0.09623} \\approx 0.80971 $$\n    $$ \\ln\\left[\\frac{0.91638 + (1+\\sqrt{2})0.09623}{0.91638 + (1-\\sqrt{2})0.09623}\\right] = \\ln\\left[\\frac{0.91638 + 0.23233}{0.91638 - 0.03986}\\right] = \\ln\\left(\\frac{1.14871}{0.87652}\\right) \\approx \\ln(1.31053) \\approx 0.27042 $$\n    Combining these terms:\n    $$ \\ln\\phi \\approx -0.08362 - (-0.19828) - (0.80971)(0.27042) $$\n    $$ \\ln\\phi \\approx 0.11466 - 0.21896 = -0.10430 $$\n\n4.  **Calculate the Chemical Potential Difference**:\n    We now use the formula for the chemical potential difference. For this step, we must use the gas constant in energy units, $R=8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$.\n    $$ \\mu(T,P) - \\mu^{\\circ}(T,P^{\\circ}) = RT \\left[\\ln\\left(\\frac{P}{P^{\\circ}}\\right) + \\ln(\\phi)\\right] $$\n    The problem specifies $P=150\\ \\mathrm{bar}$ and $P^{\\circ}=1\\ \\mathrm{bar}$.\n    $$ \\mu - \\mu^{\\circ} = (8.31446\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}})(500\\ \\mathrm{K}) \\left[\\ln\\left(\\frac{150}{1}\\right) + (-0.10430)\\right] $$\n    $$ \\mu - \\mu^{\\circ} = 4157.23\\ \\mathrm{J\\ mol^{-1}} [\\ln(150) - 0.10430] $$\n    $$ \\mu - \\mu^{\\circ} = 4157.23\\ \\mathrm{J\\ mol^{-1}} [5.010635 - 0.10430] $$\n    $$ \\mu - \\mu^{\\circ} = 4157.23\\ \\mathrm{J\\ mol^{-1}} [4.906335] $$\n    $$ \\mu - \\mu^{\\circ} \\approx 20401.8\\ \\mathrm{J\\ mol^{-1}} $$\n    Converting to $\\mathrm{kJ\\ mol^{-1}}$:\n    $$ \\mu - \\mu^{\\circ} \\approx 20.4018\\ \\mathrm{kJ\\ mol^{-1}} $$\n    Rounding to four significant figures as requested:\n    $$ \\mu_{\\mathrm{CO}_2}(T,P)-\\mu^{\\circ}_{\\mathrm{CO}_2}(T,P^{\\circ}) \\approx 20.40\\ \\mathrm{kJ\\ mol^{-1}} $$",
            "answer": "$$\\boxed{20.40}$$"
        },
        {
            "introduction": "Real geochemical fluids are mixtures, where interactions between different components further complicate thermodynamic behavior. This exercise extends the equation-of-state approach to a multi-component gas system, introducing the critical concepts of mixing rules and binary interaction parameters. By implementing a complete computational model, you will learn to calculate component chemical potentials in a realistic mixture and quantitatively assess when the simpler ideal gas model is an acceptable approximation. ",
            "id": "4103838",
            "problem": "You are tasked with validating a numerical chemical potential calculator for multicomponent gas mixtures by comparing ideal-gas and real-gas results across pressure and temperature ranges relevant to subsurface carbon dioxide sequestration. The validation must be framed from first principles and implemented as a complete, runnable program.\n\nThe chemical potential of component $i$ in a mixture, denoted $\\mu_i$, must be computed for both the ideal-gas mixture case and for a non-ideal mixture described by a cubic equation of state suited to subsurface conditions. The validation criterion is based on the magnitude of the departure from ideality for each test case.\n\nStarting from core thermodynamic definitions and well-tested models (without using or presupposing shortcut formulas), derive and implement the necessary expressions to compute the real-gas chemical potentials for a gas-phase mixture of carbon dioxide, methane, and nitrogen. You must use the Peng–Robinson Equation of State (PR-EOS) and obtain fugacity coefficients for mixture components to quantify non-ideality. The program must strictly use the International System of Units (SI).\n\nPhysical constants and component properties:\n- Universal gas constant: $R = 8.314462618 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Critical properties and acentric factors for each species, to be used in PR-EOS parameterization:\n  - Carbon dioxide ($\\mathrm{CO_2}$): $T_c = 304.1282 \\,\\mathrm{K}$, $P_c = 73.773 \\,\\mathrm{bar}$, $\\omega = 0.22394$.\n  - Methane ($\\mathrm{CH_4}$): $T_c = 190.564 \\,\\mathrm{K}$, $P_c = 45.990 \\,\\mathrm{bar}$, $\\omega = 0.0115$.\n  - Nitrogen ($\\mathrm{N_2}$): $T_c = 126.192 \\,\\mathrm{K}$, $P_c = 33.980 \\,\\mathrm{bar}$, $\\omega = 0.0372$.\n- Binary interaction parameters $k_{ij}$ (symmetric, with $k_{ii} = 0$) for the mixture combining rule:\n  - $k_{\\mathrm{CO_2,CH_4}} = 0.12$, $k_{\\mathrm{CO_2,N_2}} = 0.10$, $k_{\\mathrm{CH_4,N_2}} = 0.00$.\n- Pressures provided in $\\mathrm{bar}$ must be converted to $\\mathrm{Pa}$ using $1 \\,\\mathrm{bar} = 10^5 \\,\\mathrm{Pa}$.\n\nYour derivation and program must satisfy the following:\n- Begin from the definition of chemical potential as a partial derivative of the Gibbs free energy, and from the concepts of partial pressure, fugacity, and fugacity coefficient under constant temperature and pressure. Do not write down any ready-made target formulas in the problem statement; instead, build them in your solution from the fundamental base.\n- Implement a PR-EOS-based mixture model appropriate to subsurface $\\mathrm{CO_2}$ sequestration conditions to compute fugacity coefficients for the vapor phase. Use a physically consistent root selection for the compressibility factor in the gas phase.\n- Compute the ideal-gas chemical potential and the real-gas chemical potential for each component consistently on the same reference scale, and use this to determine the departure from ideality. Express the departure for component $i$ as a difference in $\\mathrm{J/mol}$, and use this to decide whether the ideal-gas approximation is adequate.\n\nValidation criterion:\n- For each test case, compute $\\Delta \\mu_i = \\mu_i^{\\mathrm{real}} - \\mu_i^{\\mathrm{ideal}}$ for all components $i \\in \\{\\mathrm{CO_2}, \\mathrm{CH_4}, \\mathrm{N_2}\\}$. Define the case-level error metric as $\\max_i \\left| \\Delta \\mu_i \\right|$.\n- Declare the ideal-gas approximation adequate for a test case if $\\max_i \\left| \\Delta \\mu_i \\right| \\le 300 \\,\\mathrm{J/mol}$, and inadequate otherwise. Your program must return a boolean for each test case.\n\nAngle units are not applicable. All physical quantities used internally must be in SI units. All outputs must be unitless booleans.\n\nTest suite:\n- Case $1$: $P = 30 \\,\\mathrm{bar}$, $T = 350 \\,\\mathrm{K}$, composition vector $\\boldsymbol{y} = [0.90, 0.05, 0.05]$ for $(\\mathrm{CO_2}, \\mathrm{CH_4}, \\mathrm{N_2})$.\n- Case $2$: $P = 75 \\,\\mathrm{bar}$, $T = 304.2 \\,\\mathrm{K}$, $\\boldsymbol{y} = [0.95, 0.03, 0.02]$.\n- Case $3$: $P = 200 \\,\\mathrm{bar}$, $T = 450 \\,\\mathrm{K}$, $\\boldsymboly} = [0.80, 0.10, 0.10]$.\n- Case $4$: $P = 100 \\,\\mathrm{bar}$, $T = 310 \\,\\mathrm{K}$, $\\boldsymbol{y} = [0.70, 0.20, 0.10]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\left[ \\text{result}_1, \\text{result}_2, \\text{result}_3, \\text{result}_4 \\right]$, where each $\\text{result}_k$ is a boolean indicating whether the ideal-gas approximation is adequate for the $k$-th test case.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique and meaningful solution. It is based on established principles of chemical thermodynamics and utilizes a standard industry model (the Peng-Robinson Equation of State) for a relevant application (subsurface $\\mathrm{CO_2}$ sequestration). The parameters provided are physically realistic and the validation criteria are unambiguous. Therefore, the problem is deemed valid and a full solution follows.\n\nThe core task is to compute the departure of the chemical potential of each component in a gas mixture from its value in an ideal gas mixture at the same temperature, pressure, and composition. This departure, $\\Delta \\mu_i$, is the key to assessing the validity of the ideal gas approximation under the specified conditions.\n\nWe begin with the fundamental definition of the chemical potential, $\\mu_i$, and fugacity, $f_i$. At constant temperature $T$, the differential of the chemical potential is related to the differential of fugacity by:\n$$d\\mu_i = RT \\, d(\\ln f_i)$$\nwhere $R$ is the universal gas constant. Integrating this from a reference state (denoted by a superscript $\\circ$) to the state of interest gives:\n$$\\mu_i(T, P, \\boldsymbol{y}) - \\mu_i^{\\circ}(T, P^{\\circ}) = RT \\ln \\left( \\frac{f_i(T, P, \\boldsymbol{y})}{f_i^{\\circ}(T, P^{\\circ})} \\right)$$\nA convenient reference state is the pure component $i$ as an ideal gas at the system temperature $T$ and a reference pressure $P^{\\circ}$ (e.g., $1$ bar). In this state, the fugacity is equal to the pressure, so $f_i^{\\circ}(T, P^{\\circ}) = P^{\\circ}$. The expression for the chemical potential becomes:\n$$\\mu_i(T, P, \\boldsymbol{y}) = \\mu_i^{\\circ}(T, P^{\\circ}) + RT \\ln \\left( \\frac{f_i(T, P, \\boldsymbol{y})}{P^{\\circ}} \\right)$$\n\nFor an ideal gas mixture, the fugacity of a component $i$ is equal to its partial pressure, $f_i^{\\mathrm{ideal}} = y_i P$, where $y_i$ is the mole fraction of component $i$ and $P$ is the total pressure. The chemical potential is thus:\n$$\\mu_i^{\\mathrm{ideal}}(T, P, \\boldsymbol{y}) = \\mu_i^{\\circ}(T, P^{\\circ}) + RT \\ln \\left( \\frac{y_i P}{P^{\\circ}} \\right)$$\n\nFor a real gas mixture, non-idealities are captured by the fugacity coefficient, $\\phi_i$, defined as the ratio of the actual fugacity to the ideal-gas fugacity:\n$$\\phi_i(T, P, \\boldsymbol{y}) = \\frac{f_i(T, P, \\boldsymbol{y})}{y_i P}$$\nThe fugacity is then $f_i = \\phi_i y_i P$. The chemical potential for the real gas is:\n$$\\mu_i^{\\mathrm{real}}(T, P, \\boldsymbol{y}) = \\mu_i^{\\circ}(T, P^{\\circ}) + RT \\ln \\left( \\frac{\\phi_i y_i P}{P^{\\circ}} \\right)$$\n\nThe departure from ideality, $\\Delta \\mu_i$, is the difference between the real and ideal chemical potentials:\n$$\\Delta \\mu_i = \\mu_i^{\\mathrm{real}} - \\mu_i^{\\mathrm{ideal}}$$\n$$\\Delta \\mu_i = \\left[ \\mu_i^{\\circ} + RT \\ln \\left( \\frac{\\phi_i y_i P}{P^{\\circ}} \\right) \\right] - \\left[ \\mu_i^{\\circ} + RT \\ln \\left( \\frac{y_i P}{P^{\\circ}} \\right) \\right]$$\n$$\\Delta \\mu_i = RT \\left[ \\ln(\\phi_i y_i P) - \\ln(y_i P) \\right] = RT \\ln \\left( \\frac{\\phi_i y_i P}{y_i P} \\right)$$\n$$\\Delta \\mu_i = RT \\ln \\phi_i$$\nThis elegant result demonstrates that the entire problem reduces to the calculation of the fugacity coefficient $\\phi_i$ for each component. To do this, we employ the Peng-Robinson Equation of State (PR-EOS).\n\nThe PR-EOS is given by:\n$$P = \\frac{RT}{V_m - b_m} - \\frac{a_m(T)}{V_m(V_m + b_m) + b_m(V_m - b_m)}$$\nwhere $V_m$ is the molar volume of the mixture, and $a_m$ and $b_m$ are the mixture's EOS parameters. For a pure component $i$, the parameters $a_i$ and $b_i$ are determined from its critical properties ($T_{c,i}$, $P_{c,i}$) and acentric factor ($\\omega_i$):\n$$a_i(T) = a_{c,i} \\alpha_i(T)$$\n$$a_{c,i} = 0.45724 \\frac{R^2 T_{c,i}^2}{P_{c,i}}$$\n$$b_i = 0.07780 \\frac{R T_{c,i}}{P_{c,i}}$$\nThe temperature-dependent term $\\alpha_i(T)$ is:\n$$\\alpha_i(T) = \\left[ 1 + m_i \\left(1 - \\sqrt{T_{r,i}}\\right) \\right]^2$$\nwhere $T_{r,i} = T/T_{c,i}$ is the reduced temperature and $m_i$ is a function of the acentric factor:\n$$m_i = 0.37464 + 1.54226 \\omega_i - 0.26992 \\omega_i^2$$\n\nFor a multicomponent mixture, the parameters $a_m$ and $b_m$ are calculated using the van der Waals one-fluid mixing rules:\n$$a_m = \\sum_{i} \\sum_{j} y_i y_j a_{ij}$$\n$$b_m = \\sum_{i} y_i b_i$$\nThe cross-term $a_{ij}$ incorporates a binary interaction parameter, $k_{ij}$, to improve accuracy:\n$$a_{ij} = \\sqrt{a_i a_j} (1 - k_{ij})$$\n\nThe PR-EOS can be written as a cubic polynomial in the compressibility factor, $Z = PV_m/(RT)$:\n$$Z^3 - (1-B)Z^2 + (A - 3B^2 - 2B)Z - (AB - B^2 - B^3) = 0$$\nwhere $A = \\frac{a_m P}{(RT)^2}$ and $B = \\frac{b_m P}{RT}$ are dimensionless parameters for the mixture. Solving this equation yields one or three real roots for $Z$. For a single-phase gas, the physically correct root is the largest positive real root.\n\nThe fugacity coefficient for a component $k$ in the mixture can be derived from the EOS. For the PR-EOS, the resulting expression is:\n$$ \\ln \\phi_k = \\frac{b_k}{b_m}(Z-1) - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\left( \\frac{2 \\sum_i y_i a_{ik}}{a_m} - \\frac{b_k}{b_m} \\right) \\ln \\left( \\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B} \\right) $$\nThis expression allows for the direct computation of $\\ln \\phi_k$ once the compressibility factor $Z$ is known.\n\nThe computational procedure to validate the ideal gas approximation for each test case is as follows:\n1.  **Initialization**: For each component $i \\in \\{\\mathrm{CO_2}, \\mathrm{CH_4}, \\mathrm{N_2}\\}$, convert its critical pressure $P_{c,i}$ to SI units ($\\mathrm{Pa}$). Pre-compute the temperature-independent parameters $m_i$, $a_{c,i}$, and $b_i$.\n2.  **State-Dependent Parameter Calculation**: For a given test case ($T$, $P$, $\\boldsymbol{y}$), convert the system pressure $P$ to $\\mathrm{Pa}$. For each component $i$, calculate its temperature-dependent parameter $a_i(T)$.\n3.  **Mixture Parameter Calculation**: Using the mixing rules, compute the mixture parameters $a_m$ and $b_m$.\n4.  **Compressibility Factor Calculation**: Compute the dimensionless groups $A$ and $B$. Solve the cubic EOS for $Z$ and select the largest positive real root, corresponding to the vapor phase.\n5.  **Fugacity Coefficient Calculation**: For each component $k$, calculate its fugacity coefficient $\\phi_k$ using the derived expression for $\\ln \\phi_k$. This requires computing the intermediate sum $\\sum_i y_i a_{ik}$.\n6.  **Chemical Potential Departure**: For each component $k$, calculate the departure $\\Delta \\mu_k = RT \\ln \\phi_k$.\n7.  **Validation**: Determine the case-level error metric $\\max_k |\\Delta \\mu_k|$. If this value is less than or equal to $300 \\, \\mathrm{J/mol}$, the ideal gas approximation is deemed adequate (True); otherwise, it is inadequate (False).\n8.  **Output**: Report the boolean result for the test case. Repeat for all cases and format the final output as specified.\nThis procedure provides a rigorous, first-principles-based validation of the ideal gas model under conditions relevant to geologic carbon storage.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes real-gas chemical potentials for a CO2-CH4-N2 mixture using\n    the Peng-Robinson Equation of State to validate the ideal-gas assumption.\n    \"\"\"\n    # Universal gas constant in SI units (J/mol/K)\n    R = 8.314462618\n\n    # Species data: Tc (K), Pc (bar), omega (dimensionless)\n    # The order is: CO2, CH4, N2\n    species_data = {\n        'CO2': {'Tc': 304.1282, 'Pc': 73.773, 'omega': 0.22394},\n        'CH4': {'Tc': 190.564, 'Pc': 45.990, 'omega': 0.0115},\n        'N2':  {'Tc': 126.192, 'Pc': 33.980, 'omega': 0.0372}\n    }\n    species_order = ['CO2', 'CH4', 'N2']\n    num_species = len(species_order)\n\n    # Binary interaction parameters, k_ij (symmetric)\n    k_ij_matrix = np.array([\n        [0.0, 0.12, 0.10],  # CO2 with (CO2, CH4, N2)\n        [0.12, 0.0, 0.00],  # CH4 with (CO2, CH4, N2)\n        [0.10, 0.00, 0.0]   # N2  with (CO2, CH4, N2)\n    ])\n\n    test_cases = [\n        {'P_bar': 30, 'T_K': 350, 'y': np.array([0.90, 0.05, 0.05])},\n        {'P_bar': 75, 'T_K': 304.2, 'y': np.array([0.95, 0.03, 0.02])},\n        {'P_bar': 200, 'T_K': 450, 'y': np.array([0.80, 0.10, 0.10])},\n        {'P_bar': 100, 'T_K': 310, 'y': np.array([0.70, 0.20, 0.10])},\n    ]\n\n    # Pre-calculate temperature-independent pure component parameters\n    pure_params = []\n    for i in range(num_species):\n        name = species_order[i]\n        data = species_data[name]\n        Tc = data['Tc']\n        Pc_Pa = data['Pc'] * 1.0e5  # Convert bar to Pa\n        omega = data['omega']\n        \n        m_i = 0.37464 + 1.54226 * omega - 0.26992 * omega**2\n        a_c_i = 0.45724 * (R**2 * Tc**2) / Pc_Pa\n        b_i = 0.07780 * R * Tc / Pc_Pa\n        \n        pure_params.append({'m_i': m_i, 'a_c_i': a_c_i, 'b_i': b_i, 'Tc': Tc})\n\n    results = []\n    for case in test_cases:\n        P_Pa = case['P_bar'] * 1.0e5\n        T_K = case['T_K']\n        y = case['y']\n\n        # 1. Calculate T-dependent pure component parameters\n        a_i_T = np.zeros(num_species)\n        b_i = np.array([p['b_i'] for p in pure_params])\n        for i in range(num_species):\n            params = pure_params[i]\n            Tr = T_K / params['Tc']\n            alpha_i = (1 + params['m_i'] * (1 - np.sqrt(Tr)))**2\n            a_i_T[i] = params['a_c_i'] * alpha_i\n            \n        # 2. Calculate mixture parameters using mixing rules\n        b_m = np.sum(y * b_i)\n        \n        a_m = 0.0\n        for i in range(num_species):\n            for j in range(num_species):\n                a_ij = np.sqrt(a_i_T[i] * a_i_T[j]) * (1 - k_ij_matrix[i, j])\n                a_m += y[i] * y[j] * a_ij\n\n        # 3. Calculate dimensionless parameters A and B for the mixture\n        A = a_m * P_Pa / (R**2 * T_K**2)\n        B = b_m * P_Pa / (R * T_K)\n\n        # 4. Solve the cubic EOS for the compressibility factor Z\n        c2 = -(1 - B)\n        c1 = A - 3*B**2 - 2*B\n        c0 = -(A*B - B**2 - B**3)\n        poly_coeffs = [1, c2, c1, c0]\n        \n        roots = np.roots(poly_coeffs)\n        real_roots = roots[np.isreal(roots)].real\n        positive_real_roots = real_roots[real_roots > B] # Physical roots Z > B\n\n        # For the gas phase, select the largest real root\n        Z = np.max(positive_real_roots)\n\n        # 5. Calculate fugacity coefficients\n        delta_mu = np.zeros(num_species)\n        \n        # Pre-compute terms for fugacity coefficient calculation\n        term_Z_minus_1 = Z - 1\n        term_ln_Z_B = np.log(Z - B)\n        sqrt2 = np.sqrt(2)\n        log_ratio_arg = (Z + (1 + sqrt2) * B) / (Z + (1 - sqrt2) * B)\n        term_log_ratio = np.log(log_ratio_arg)\n        \n        sum_y_a_ik = np.zeros(num_species)\n        for k in range(num_species):\n            for i in range(num_species):\n                a_ik = np.sqrt(a_i_T[i] * a_i_T[k]) * (1 - k_ij_matrix[i, k])\n                sum_y_a_ik[k] += y[i] * a_ik\n        \n        for k in range(num_species):\n            term_b = b_i[k] / b_m\n            term_a = (2 * sum_y_a_ik[k]) / a_m\n            bracket_term = term_a - term_b\n            \n            ln_phi_k = term_b * term_Z_minus_1 - term_ln_Z_B - (A / (2 * sqrt2 * B)) * bracket_term * term_log_ratio\n            \n            # 6. Calculate chemical potential departure\n            delta_mu[k] = R * T_K * ln_phi_k\n\n        # 7. Apply validation criterion\n        max_abs_delta_mu = np.max(np.abs(delta_mu))\n        is_adequate = max_abs_delta_mu <= 300.0\n        results.append(str(is_adequate).lower())\n\n    # Format the final output string\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}