{
    "hands_on_practices": [
        {
            "introduction": "热力学平衡态对应于吉布斯自由能的最小值。本练习将探讨当吉布斯自由能曲线不再是凸函数时系统会发生什么，这种情况将导致相分离。通过计算拐点（spinodal）成分——即吉布斯自由能二阶导数为零的点——您将把抽象的数学稳定性判据与散相分解（spinodal decomposition）这一物理现象直接联系起来 。",
            "id": "4080529",
            "problem": "一个由组分 $A$ 和 $B$ 构成的二元地球化学溶液，在恒定温度 $T$ 和压力 $P$ 下，被建模为对称规整溶体。其均相的摩尔吉布斯自由能为\n$$\nG_{m}(x,T) \\;=\\; x\\,G_{A}^{0}(T) \\;+\\; (1-x)\\,G_{B}^{0}(T) \\;+\\; R T \\big[x \\ln x + (1-x)\\ln(1-x)\\big] \\;+\\; W\\,x(1-x),\n$$\n其中 $x \\in (0,1)$ 是组分 $A$ 的摩尔分数，$G_{A}^{0}(T)$ 和 $G_{B}^{0}(T)$ 是纯组分 $A$ 和 $B$ 在温度 $T$ 下的标准摩尔吉布斯能，$R$ 是通用气体常数，$W>0$ 是一个与温度无关的相互作用参数，单位为能量/摩尔。假设一个宏观大尺度的封闭系统，在固定的 $T$ 和 $P$ 下，考虑在没有梯度能量惩罚的情况下的空间均匀状态，因此对无穷小成分涨落的稳定性由 $G_{m}(x,T)$ 关于 $x$ 的曲率控制。\n\n利用基本原理，即在固定的 $T$ 和 $P$ 下，平衡态使吉布斯自由能最小化，并且对小涨落的局部稳定性要求吉布斯自由能的二阶变分为正，来确定旋节线成分 $x_{\\mathrm{sp}}^{-}(T)$ 和 $x_{\\mathrm{sp}}^{+}(T)$。在这些成分点，均相溶液开始对无穷小成分涨落变得不稳定。请将你的答案表示为单个闭合形式的解析表达式，用 $T$、$R$ 和 $W$ 表示，并将两个旋节线成分并排写在一行中。不需要进行数值计算。仅用 $T$、$R$ 和 $W$ 表述你的结果，不要在最终表达式中包含单位。假设温度 $T$ 满足旋节线存在的条件。",
            "solution": "该问题要求确定在恒定温度 $T$ 和压力 $P$ 下，对称规整二元溶体的旋节线成分，记为 $x_{\\mathrm{sp}}^{-}(T)$ 和 $x_{\\mathrm{sp}}^{+}(T)$。\n\n均相抵抗无穷小成分涨落的局部稳定性基本原理是，吉布斯自由能必须是成分的凸函数。在数学上，这意味着摩尔吉布斯自由能 $G_m$ 相对于摩尔分数 $x$ 的二阶导数必须为正。这种稳定性的极限定义了旋节线曲线，它出现在吉布斯自由能函数的曲率为零的地方。因此，旋节线成分是以下方程的解：\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = 0\n$$\n\n对称规整溶体的摩尔吉布斯自由能由下式给出：\n$$\nG_{m}(x,T) = x\\,G_{A}^{0}(T) + (1-x)\\,G_{B}^{0}(T) + R T \\big[x \\ln x + (1-x)\\ln(1-x)\\big] + W\\,x(1-x)\n$$\n其中，$x$ 是组分 $A$ 的摩尔分数，$G_{A}^{0}(T)$ 和 $G_{B}^{0}(T)$ 是纯组分的标准摩尔吉布斯能，$R$ 是通用气体常数，$T$ 是绝对温度，$W$ 是一个恒定的相互作用参数。为求导清晰起见，我们可以将最后一项写为 $W x - W x^2$。\n\n首先，我们计算 $G_m$ 对 $x$ 的一阶导数：\n$$\n\\frac{\\partial G_m}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( x\\,G_{A}^{0} + (1-x)\\,G_{B}^{0} + RT[x \\ln x + (1-x)\\ln(1-x)] + Wx - Wx^2 \\right)\n$$\n逐项求导得到：\n$$\n\\frac{\\partial G_m}{\\partial x} = G_{A}^{0} - G_{B}^{0} + RT \\left[ \\left(1 \\cdot \\ln x + x \\cdot \\frac{1}{x}\\right) + \\left(-1 \\cdot \\ln(1-x) + (1-x) \\cdot \\frac{-1}{1-x}\\right) \\right] + W(1-2x)\n$$\n$$\n\\frac{\\partial G_m}{\\partial x} = G_{A}^{0} - G_{B}^{0} + RT [(\\ln x + 1) - (\\ln(1-x) + 1)] + W(1-2x)\n$$\n$$\n\\frac{\\partial G_m}{\\partial x} = G_{A}^{0} - G_{B}^{0} + RT (\\ln x - \\ln(1-x)) + W(1-2x)\n$$\n$$\n\\frac{\\partial G_m}{\\partial x} = G_{A}^{0} - G_{B}^{0} + RT \\ln\\left(\\frac{x}{1-x}\\right) + W(1-2x)\n$$\n\n接下来，我们计算 $G_m$ 对 $x$ 的二阶导数：\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( G_{A}^{0} - G_{B}^{0} + RT \\ln\\left(\\frac{x}{1-x}\\right) + W(1-2x) \\right)\n$$\n$G_{A}^{0}$ 和 $G_{B}^{0}$ 项相对于 $x$ 是常数。对其余项求导得到：\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = RT \\frac{\\partial}{\\partial x} \\left( \\ln x - \\ln(1-x) \\right) - 2W\n$$\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = RT \\left( \\frac{1}{x} - \\frac{-1}{1-x} \\right) - 2W\n$$\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = RT \\left( \\frac{1}{x} + \\frac{1}{1-x} \\right) - 2W\n$$\n合并括号中的项：\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = RT \\left( \\frac{1-x+x}{x(1-x)} \\right) - 2W\n$$\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = \\frac{RT}{x(1-x)} - 2W\n$$\n令此表达式等于零，即可找到旋节线成分：\n$$\n\\frac{RT}{x(1-x)} - 2W = 0\n$$\n$$\n\\frac{RT}{x(1-x)} = 2W\n$$\n$$\nRT = 2W x(1-x)\n$$\n展开并重新排列此方程，得到一个关于 $x$ 的二次方程：\n$$\nRT = 2Wx - 2Wx^2\n$$\n$$\n2Wx^2 - 2Wx + RT = 0\n$$\n我们使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $x$，其中 $a = 2W$，$b = -2W$，$c = RT$。\n$$\nx_{\\mathrm{sp}} = \\frac{-(-2W) \\pm \\sqrt{(-2W)^2 - 4(2W)(RT)}}{2(2W)}\n$$\n$$\nx_{\\mathrm{sp}} = \\frac{2W \\pm \\sqrt{4W^2 - 8WRT}}{4W}\n$$\n我们可以通过提取因子 $4W^2$ 来简化平方根下的项：\n$$\nx_{\\mathrm{sp}} = \\frac{2W \\pm \\sqrt{4W^2 \\left(1 - \\frac{8WRT}{4W^2}\\right)}}{4W}\n$$\n$$\nx_{\\mathrm{sp}} = \\frac{2W \\pm 2W \\sqrt{1 - \\frac{2RT}{W}}}{4W}\n$$\n将分子和分母同除以 $2W$，得到两个旋节线成分的最终表达式：\n$$\nx_{\\mathrm{sp}} = \\frac{1}{2} \\pm \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}}\n$$\n这两个成分，$x_{\\mathrm{sp}}^{-}$ 和 $x_{\\mathrm{sp}}^{+}$，定义了旋节线区域的边界。按照要求，它们仅用 $T$、$R$ 和 $W$ 表示。题目假设温度 $T$ 满足旋节线存在的条件，这意味着平方根的参数为非负，即 $1 - \\frac{2RT}{W} \\geq 0$，或 $T \\leq \\frac{W}{2R}$。\n\n两个旋节线成分是：\n$$\nx_{\\mathrm{sp}}^{-} = \\frac{1}{2} - \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}}\n$$\n$$\nx_{\\mathrm{sp}}^{+} = \\frac{1}{2} + \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} - \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}} & \\frac{1}{2} + \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{W}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在定义了热力学模型后，求解平衡组成通常需要解决一个非线性质量平衡方程组。本实践将引导您实现牛顿-拉弗森（Newton-Raphson, NR）法这一核心算法来求解此类问题。您将亲身体验推导雅可比矩阵（Jacobian matrix）的过程，并理解它在引导迭代求解趋向吉布斯自由能最小值过程中的关键作用 。",
            "id": "4080479",
            "problem": "在计算地球化学中，考虑一个由两种基底组分（活度为 $a_{\\mathrm{A}}$ 和 $a_{\\mathrm{B}}$）和三种络合物（活度为 $a_{\\mathrm{AB}}$、$a_{\\mathrm{A_2B}}$ 和 $a_{\\mathrm{AB_2}}$）组成的等温等压理想水溶液体系。假设为理想混合，因此任何物种 $i$ 的化学势为 $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$，其中 $R$ 是普适气体常数，$T$ 是温度。并假设标准态反应自由能决定了平衡常数 $K$，该常数将络合物活度与基底活度关联起来。在恒定温度和压力下进行吉布斯自由能最小化时，相对于每种络合物形成的定常性意味着存在质量作用关系，将络合物的活度与基底组分的活度联系起来。设基底组分的总活度（在理想条件下与总摩尔浓度成正比）为 $T_{\\mathrm{A}}$ 和 $T_{\\mathrm{B}}$，并假设络合物的化学计量如下：$\\mathrm{AB}$ 的化学计量为 $\\nu_{\\mathrm{A}}=1, \\nu_{\\mathrm{B}}=1$；$\\mathrm{A_2B}$ 的化学计量为 $\\nu_{\\mathrm{A}}=2, \\nu_{\\mathrm{B}}=1$；$\\mathrm{AB_2}$ 的化学计量为 $\\nu_{\\mathrm{A}}=1, \\nu_{\\mathrm{B}}=2$。给定平衡常数 $K_{\\mathrm{AB}}$、$K_{\\mathrm{A_2B}}$、$K_{\\mathrm{AB_2}}$（无量纲，在给定的 $T$ 和 $P$ 下定义），且在理想条件下，络合物活度满足 $a_{\\mathrm{AB}} = K_{\\mathrm{AB}} a_{\\mathrm{A}} a_{\\mathrm{B}}$、$a_{\\mathrm{A_2B}} = K_{\\mathrm{A_2B}} a_{\\mathrm{A}}^2 a_{\\mathrm{B}}$ 和 $a_{\\mathrm{AB_2}} = K_{\\mathrm{AB_2}} a_{\\mathrm{A}} a_{\\mathrm{B}}^2$。质量平衡方程则强制基底组分的守恒：\n$$\nF_1(a_{\\mathrm{A}}, a_{\\mathrm{B}}) \\equiv a_{\\mathrm{A}} + a_{\\mathrm{AB}} + 2 a_{\\mathrm{A_2B}} + a_{\\mathrm{AB_2}} - T_{\\mathrm{A}} = 0,\n$$\n$$\nF_2(a_{\\mathrm{A}}, a_{\\mathrm{B}}) \\equiv a_{\\mathrm{B}} + a_{\\mathrm{AB}} + a_{\\mathrm{A_2B}} + 2 a_{\\mathrm{AB_2}} - T_{\\mathrm{B}} = 0.\n$$\n从这些基本定义和约束出发，建立一个牛顿-拉夫逊（Newton–Raphson, NR）方法（首次使用时定义缩写），使用对数变量 $u_{\\mathrm{A}} = \\ln a_{\\mathrm{A}}$ 和 $u_{\\mathrm{B}} = \\ln a_{\\mathrm{B}}$ 来确保正值。从第一性原理推导相应的雅可比矩阵项，并实现一个算法，对于给定的参数，计算所有五种物种 $[a_{\\mathrm{A}}, a_{\\mathrm{B}}, a_{\\mathrm{AB}}, a_{\\mathrm{A_2B}}, a_{\\mathrm{AB_2}}]$ 的平衡活度。在您的解答叙述中讨论雅可比矩阵在收敛中的作用。\n\n您的程序必须实现上述体系的 NR 迭代，并为以下参数值的测试套件生成结果，每个参数值以元组 $(T_{\\mathrm{A}}, T_{\\mathrm{B}}, K_{\\mathrm{AB}}, K_{\\mathrm{A_2B}}, K_{\\mathrm{AB_2}})$ 的形式指定：\n\n-   案例1（中等络合，均衡总量）：$(T_{\\mathrm{A}}, T_{\\mathrm{B}}, K_{\\mathrm{AB}}, K_{\\mathrm{A_2B}}, K_{\\mathrm{AB_2}}) = (\\,1.0,\\,1.0,\\,10^3,\\,10^2,\\,5 \\cdot 10^1\\,)$。\n-   案例2（强烈倾向于 $\\mathrm{A_2B}$ 生成）：$(\\,1.0,\\,0.5,\\,10^3,\\,10^{12},\\,10^1\\,)$。\n-   案例3（弱络合且总量极小）：$(\\,10^{-6},\\,10^{-6},\\,10^{-3},\\,10^{-6},\\,10^{-6}\\,)$。\n-   案例4（化学计量不平衡且强烈倾向于 $\\mathrm{AB_2}$ 生成）：$(\\,10^{-1},\\,10^{1},\\,10^2,\\,10^{-4},\\,10^8\\,)$。\n-   案例5（近乎奇异，所有络合物均强烈倾向于生成）：$(\\,1.0,\\,1.0,\\,10^{10},\\,10^{10},\\,10^{10}\\,)$。\n\n科学真实性约束：\n-   将所有活度视为与理想溶液行为一致的无量纲数。\n-   使用绝对容差和保障措施来确保在刚性区域的数值稳定性。\n\n角度单位不适用。由于所有量均为无量纲，因此不需要物理单位；以浮点数报告数值输出。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试案例的结果本身必须是一个用方括号括起来的、按 $[a_{\\mathrm{A}}, a_{\\mathrm{B}}, a_{\\mathrm{AB}}, a_{\\mathrm{A_2B}}, a_{\\mathrm{AB_2}}]$ 顺序排列的五个平衡活度的逗号分隔列表。例如，总输出格式为\n$$\n[\\,[x_1,x_2,x_3,x_4,x_5],\\,[y_1,y_2,y_3,y_4,y_5],\\,\\ldots\\,],\n$$\n字符串中不含任何空格。\n\n期望的输出是浮点数列表。当残差向量 $[F_1, F_2]$ 的范数低于一个小的容差或达到最大迭代次数时，NR 迭代必须终止，并在需要时采用线搜索或阻尼来保持收敛。雅可比矩阵必须在每次迭代中显式地构建和使用。",
            "solution": "该问题要求解一个描述水溶液地球化学体系中化学平衡的非线性方程组。解将使用牛顿-拉夫逊（Newton-Raphson, NR）迭代法求得。该问题是适定的，并且其科学基础在于质量作用和质量平衡原理，这些原理源于在恒定温度和压力下吉布斯自由能的最小化。\n\n该体系由两种基底组分 A 和 B，以及三种络合物 AB、A$_2$B 和 AB$_2$ 组成。体系的状态由五种物种的活度定义：$a_{\\mathrm{A}}$、$a_{\\mathrm{B}}$、$a_{\\mathrm{AB}}$、$a_{\\mathrm{A_2B}}$ 和 $a_{\\mathrm{AB_2}}$。这些活度通过三个源于化学平衡的质量作用定律相关联：\n$$a_{\\mathrm{AB}} = K_{\\mathrm{AB}} a_{\\mathrm{A}} a_{\\mathrm{B}}$$\n$$a_{\\mathrm{A_2B}} = K_{\\mathrm{A_2B}} a_{\\mathrm{A}}^2 a_{\\mathrm{B}}$$\n$$a_{\\mathrm{AB_2}} = K_{\\mathrm{AB_2}} a_{\\mathrm{A}} a_{\\mathrm{B}}^2$$\n其中 $K_{\\mathrm{AB}}$、$K_{\\mathrm{A_2B}}$ 和 $K_{\\mathrm{AB_2}}$ 是给定的无量纲平衡常数。\n\n该体系相对于基底组分是封闭的，其总活度为 $T_{\\mathrm{A}}$ 和 $T_{\\mathrm{B}}$。这些组分的守恒由两个质量平衡方程表示：\n$$F_1(a_{\\mathrm{A}}, a_{\\mathrm{B}}) = a_{\\mathrm{A}} + a_{\\mathrm{AB}} + 2 a_{\\mathrm{A_2B}} + a_{\\mathrm{AB_2}} - T_{\\mathrm{A}} = 0$$\n$$F_2(a_{\\mathrm{A}}, a_{\\mathrm{B}}) = a_{\\mathrm{B}} + a_{\\mathrm{AB}} + a_{\\mathrm{A_2B}} + 2 a_{\\mathrm{AB_2}} - T_{\\mathrm{B}} = 0$$\n这些总和中的系数（$F_1$ 中的 $\\nu_{\\mathrm{A},i}$，$F_2$ 中的 $\\nu_{\\mathrm{B},i}$）是每种物种 $i$ 中基底组分 A 和 B 的化学计量系数。\n\n核心任务是求解这个由两个非线性方程组成的方程组，以求得两个未知的基底活度 $a_{\\mathrm{A}}$ 和 $a_{\\mathrm{B}}$。为确保在迭代求解过程中活度保持正值，并处理活度值的宽动态范围，我们使用变量替换为对数：\n$$u_{\\mathrm{A}} = \\ln a_{\\mathrm{A}} \\implies a_{\\mathrm{A}} = e^{u_{\\mathrm{A}}}$$\n$$u_{\\mathrm{B}} = \\ln a_{\\mathrm{B}} \\implies a_{\\mathrm{B}} = e^{u_{\\mathrm{B}}}$$\n因此，用于 NR 方法的未知变量向量是 $\\mathbf{u} = [u_{\\mathrm{A}}, u_{\\mathrm{B}}]^T$。\n\n我们必须用 $u_{\\mathrm{A}}$ 和 $u_{\\mathrm{B}}$ 来重写质量平衡方程。首先，络合物活度变为：\n$$a_{\\mathrm{AB}} = K_{\\mathrm{AB}} e^{u_{\\mathrm{A}}} e^{u_{\\mathrm{B}}} = K_{\\mathrm{AB}} e^{u_{\\mathrm{A}} + u_{\\mathrm{B}}}$$\n$$a_{\\mathrm{A_2B}} = K_{\\mathrm{A_2B}} (e^{u_{\\mathrm{A}}})^2 e^{u_{\\mathrm{B}}} = K_{\\mathrm{A_2B}} e^{2u_{\\mathrm{A}} + u_{\\mathrm{B}}}$$\n$$a_{\\mathrm{AB_2}} = K_{\\mathrm{AB_2}} e^{u_{\\mathrm{A}}} (e^{u_{\\mathrm{B}}})^2 = K_{\\mathrm{AB_2}} e^{u_{\\mathrm{A}} + 2u_{\\mathrm{B}}}$$\n将这些代入质量平衡方程，得到残差向量函数 $\\mathbf{F}(\\mathbf{u}) = [F_1(\\mathbf{u}), F_2(\\mathbf{u})]^T$：\n$$F_1(\\mathbf{u}) = e^{u_{\\mathrm{A}}} + K_{\\mathrm{AB}}e^{u_{\\mathrm{A}}+u_{\\mathrm{B}}} + 2K_{\\mathrm{A_2B}}e^{2u_{\\mathrm{A}}+u_{\\mathrm{B}}} + K_{\\mathrm{AB_2}}e^{u_{\\mathrm{A}}+2u_{\\mathrm{B}}} - T_{\\mathrm{A}} = 0$$\n$$F_2(\\mathbf{u}) = e^{u_{\\mathrm{B}}} + K_{\\mathrm{AB}}e^{u_{\\mathrm{A}}+u_{\\mathrm{B}}} + K_{\\mathrm{A_2B}}e^{2u_{\\mathrm{A}}+u_{\\mathrm{B}}} + 2K_{\\mathrm{AB_2}}e^{u_{\\mathrm{A}}+2u_{\\mathrm{B}}} - T_{\\mathrm{B}} = 0$$\n\n牛顿-拉夫逊方法通过从初始猜测值 $\\mathbf{u}_0$ 开始迭代来找到 $\\mathbf{F}(\\mathbf{u}) = \\mathbf{0}$ 的根。每次迭代 $k$ 通过 $\\mathbf{u}_{k+1} = \\mathbf{u}_k + \\Delta\\mathbf{u}_k$ 更新解，其中步长 $\\Delta\\mathbf{u}_k$ 通过求解线性系统得到：\n$$J(\\mathbf{u}_k) \\Delta\\mathbf{u}_k = -\\mathbf{F}(\\mathbf{u}_k)$$\n这里，$J$ 是 $\\mathbf{F}$ 关于 $\\mathbf{u}$ 的雅可比矩阵，其元素为 $J_{ij} = \\frac{\\partial F_i}{\\partial u_j}$。我们从第一性原理推导这些元素。\n\n物种活度 $a_k = K_k \\exp(\\sum_j \\nu_{jk} u_j)$ 对数活度 $u_m$ 的偏导数为 $\\frac{\\partial a_k}{\\partial u_m} = a_k \\cdot \\nu_{mk}$。使用此规则：\n$J_{11} = \\frac{\\partial F_1}{\\partial u_{\\mathrm{A}}} = \\frac{\\partial a_{\\mathrm{A}}}{\\partial u_{\\mathrm{A}}} + \\frac{\\partial a_{\\mathrm{AB}}}{\\partial u_{\\mathrm{A}}} + 2\\frac{\\partial a_{\\mathrm{A_2B}}}{\\partial u_{\\mathrm{A}}} + \\frac{\\partial a_{\\mathrm{AB_2}}}{\\partial u_{\\mathrm{A}}} = 1 \\cdot a_{\\mathrm{A}} + 1 \\cdot a_{\\mathrm{AB}} + 2(2 \\cdot a_{\\mathrm{A_2B}}) + 1 \\cdot a_{\\mathrm{AB_2}}$\n$$J_{11} = a_{\\mathrm{A}} + a_{\\mathrm{AB}} + 4a_{\\mathrm{A_2B}} + a_{\\mathrm{AB_2}}$$\n$J_{12} = \\frac{\\partial F_1}{\\partial u_{\\mathrm{B}}} = \\frac{\\partial a_{\\mathrm{A}}}{\\partial u_{\\mathrm{B}}} + \\frac{\\partial a_{\\mathrm{AB}}}{\\partial u_{\\mathrm{B}}} + 2\\frac{\\partial a_{\\mathrm{A_2B}}}{\\partial u_{\\mathrm{B}}} + \\frac{\\partial a_{\\mathrm{AB_2}}}{\\partial u_{\\mathrm{B}}} = 0 + 1 \\cdot a_{\\mathrm{AB}} + 2(1 \\cdot a_{\\mathrm{A_2B}}) + 1(2 \\cdot a_{\\mathrm{AB_2}})$\n$$J_{12} = a_{\\mathrm{AB}} + 2a_{\\mathrm{A_2B}} + 2a_{\\mathrm{AB_2}}$$\n$J_{21} = \\frac{\\partial F_2}{\\partial u_{\\mathrm{A}}} = \\frac{\\partial a_{\\mathrm{B}}}{\\partial u_{\\mathrm{A}}} + \\frac{\\partial a_{\\mathrm{AB}}}{\\partial u_{\\mathrm{A}}} + \\frac{\\partial a_{\\mathrm{A_2B}}}{\\partial u_{\\mathrm{A}}} + 2\\frac{\\partial a_{\\mathrm{AB_2}}}{\\partial u_{\\mathrm{A}}} = 0 + 1 \\cdot a_{\\mathrm{AB}} + 1(2 \\cdot a_{\\mathrm{A_2B}}) + 2(1 \\cdot a_{\\mathrm{AB_2}})$\n$$J_{21} = a_{\\mathrm{AB}} + 2a_{\\mathrm{A_2B}} + 2a_{\\mathrm{AB_2}}$$\n$J_{22} = \\frac{\\partial F_2}{\\partial u_{\\mathrm{B}}} = \\frac{\\partial a_{\\mathrm{B}}}{\\partial u_{\\mathrm{B}}} + \\frac{\\partial a_{\\mathrm{AB}}}{\\partial u_{\\mathrm{B}}} + \\frac{\\partial a_{\\mathrm{A_2B}}}{\\partial u_{\\mathrm{B}}} + 2\\frac{\\partial a_{\\mathrm{AB_2}}}{\\partial u_{\\mathrm{B}}} = 1 \\cdot a_{\\mathrm{B}} + 1 \\cdot a_{\\mathrm{AB}} + 1 \\cdot a_{\\mathrm{A2B}} + 2(2 \\cdot a_{\\mathrm{AB_2}})$\n$$J_{22} = a_{\\mathrm{B}} + a_{\\mathrm{AB}} + a_{\\mathrm{A_2B}} + 4a_{\\mathrm{AB_2}}$$\n雅可比矩阵是对称的（$J_{12} = J_{21}$），这一性质源于其基础方程是从一个标量热力学势（吉布斯自由能）推导出来的。\n\n雅可比矩阵对于 NR 方法的收敛特性至关重要。它在当前迭代点 $\\mathbf{u}_k$ 附近提供了系统行为的线性模型。当初始猜测接近真实解且雅可比矩阵是良态的（可逆且不接近奇异）时，该方法呈二次收敛，速度极快。然而，如果雅可比矩阵变得奇异或近乎奇异（病态的），其逆矩阵未定义或数值上不稳定，导致计算出的步长 $\\Delta\\mathbf{u}_k$ 巨大且不可靠。这会导致发散或不规则振荡。这种病态条件可能出现在化学极端体系中，例如，当某些反应近乎完全进行时，将基底组分锁定在固定的化学计量比中，从而在质量平衡方程中产生线性相关性。案例5，所有络合物的平衡常数都非常大，就是被设计成近乎奇异的。\n\n为确保即使在初始猜测不佳或在病态区域也能稳健收敛，我们实现了一个简单的阻尼或线搜索策略。更新步骤被修改为 $\\mathbf{u}_{k+1} = \\mathbf{u}_k + \\alpha \\Delta\\mathbf{u}_k$，其中步长 $\\alpha \\in (0, 1]$ 从其初始值1开始减小，直到更新导致残差向量的范数减小，即 $||\\mathbf{F}(\\mathbf{u}_{k+1})|| < ||\\mathbf{F}(\\mathbf{u}_k)||$。这种保障措施可防止算法采取过大的、远离解的非物理步骤。\n\n该算法按以下步骤进行：\n1.  初始化 $\\mathbf{u}_0 = [\\ln T_{\\mathrm{A}}, \\ln T_{\\mathrm{B}}]$。\n2.  对于每次迭代，计算活度、残差向量 $\\mathbf{F}$ 和雅可比矩阵 $J$。\n3.  检查 $||\\mathbf{F}||$ 是否低于指定的容差。如果是，则已找到解。\n4.  求解线性系统 $J \\Delta\\mathbf{u} = -\\mathbf{F}$ 以获得牛顿步长 $\\Delta\\mathbf{u}$。\n5.  执行线搜索以找到一个合适的阻尼因子 $\\alpha$，确保残差范数减小。\n6.  更新解向量：$\\mathbf{u} \\leftarrow \\mathbf{u} + \\alpha \\Delta\\mathbf{u}$。\n7.  重复此过程，直到收敛或达到最大迭代次数。\n当收敛到最终向量 $\\mathbf{u}^* = [u_{\\mathrm{A}}^*, u_{\\mathrm{B}}^*]$ 后，计算并报告所有五种物种的平衡活度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_geochem_system(T_A, T_B, K_AB, K_A2B, K_AB2):\n    \"\"\"\n    Solves the geochemical equilibrium system using the Newton-Raphson method\n    with logarithmic variables and a backtracking line search.\n\n    Args:\n        T_A (float): Total activity of component A.\n        T_B (float): Total activity of component B.\n        K_AB (float): Equilibrium constant for complex AB.\n        K_A2B (float): Equilibrium constant for complex A2B.\n        K_AB2 (float): Equilibrium constant for complex AB2.\n\n    Returns:\n        list: A list of the five equilibrium activities\n              [a_A, a_B, a_AB, a_A2B, a_AB2].\n    \"\"\"\n    # NR algorithm parameters\n    max_iter = 100\n    tolerance = 1e-12\n\n    # Initial guess for u = [ln(a_A), ln(a_B)]\n    # A small positive constant is added to avoid log(0) if totals are zero,\n    # though given test cases have positive totals.\n    u = np.array([np.log(T_A + 1e-20), np.log(T_B + 1e-20)], dtype=np.float64)\n\n    for _ in range(max_iter):\n        # 1. Calculate activities from the current u\n        a_A = np.exp(u[0])\n        a_B = np.exp(u[1])\n\n        # Calculate complex activities using mass-action laws\n        a_AB = K_AB * a_A * a_B\n        a_A2B = K_A2B * (a_A ** 2) * a_B\n        a_AB2 = K_AB2 * a_A * (a_B ** 2)\n\n        # 2. Calculate the residual vector F based on mass-balance\n        F1 = a_A + a_AB + 2 * a_A2B + a_AB2 - T_A\n        F2 = a_B + a_AB + a_A2B + 2 * a_AB2 - T_B\n        F = np.array([F1, F2])\n\n        # 3. Check for convergence by the norm of the residual\n        norm_F = np.linalg.norm(F)\n        if norm_F < tolerance:\n            break\n\n        # 4. Calculate the Jacobian matrix J\n        J11 = a_A + a_AB + 4 * a_A2B + a_AB2\n        J12 = a_AB + 2 * a_A2B + 2 * a_AB2  # J21 is identical\n        J22 = a_B + a_AB + a_A2B + 4 * a_AB2\n        J = np.array([[J11, J12], [J12, J22]])\n\n        # 5. Solve the linear system J * delta_u = -F for the step delta_u\n        try:\n            delta_u = np.linalg.solve(J, -F)\n        except np.linalg.LinAlgError:\n            # Jacobian is singular, indicating severe numerical issues.\n            # The line search might handle large steps, but convergence\n            # is unlikely. Terminate for this case.\n            # Using NaN to signal failure to converge.\n            return [np.nan] * 5\n\n        # 6. Damped update (Backtracking Line Search) to ensure global convergence\n        alpha = 1.0\n        while alpha > 1e-8:\n            u_new = u + alpha * delta_u\n            \n            # Recalculate F for the new proposed u\n            a_A_new = np.exp(u_new[0])\n            a_B_new = np.exp(u_new[1])\n            a_AB_new = K_AB * a_A_new * a_B_new\n            a_A2B_new = K_A2B * (a_A_new ** 2) * a_B_new\n            a_AB2_new = K_AB2 * a_A_new * (a_B_new ** 2)\n            \n            F1_new = a_A_new + a_AB_new + 2 * a_A2B_new + a_AB2_new - T_A\n            F2_new = a_B_new + a_AB_new + a_A2B_new + 2 * a_AB2_new - T_B\n\n            # If the new residual norm is smaller, accept the step\n            if np.linalg.norm(np.array([F1_new, F2_new])) < norm_F:\n                u = u_new\n                break\n            \n            alpha /= 2.0\n        \n        # If the line search fails to find a better step, terminate\n        if alpha <= 1e-8:\n            break\n\n    # After loop (converged or max_iter/line search failed), compute final activities\n    final_a_A = np.exp(u[0])\n    final_a_B = np.exp(u[1])\n    final_a_AB = K_AB * final_a_A * final_a_B\n    final_a_A2B = K_A2B * (final_a_A ** 2) * final_a_B\n    final_a_AB2 = K_AB2 * final_a_A * (final_a_B ** 2)\n    \n    return [final_a_A, final_a_B, final_a_AB, final_a_A2B, final_a_AB2]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results in the required format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T_A, T_B, K_AB, K_A2B, K_AB2)\n        (1.0, 1.0, 1.0e3, 1.0e2, 5.0e1),\n        (1.0, 0.5, 1.0e3, 1.0e12, 1.0e1),\n        (1.0e-6, 1.0e-6, 1.0e-3, 1.0e-6, 1.0e-6),\n        (1.0e-1, 10.0, 1.0e2, 1.0e-4, 1.0e8),\n        (1.0, 1.0, 1.0e10, 1.0e10, 1.0e10)\n    ]\n\n    all_results = []\n    for case in test_cases:\n        T_A, T_B, K_AB, K_A2B, K_AB2 = case\n        result_list = solve_geochem_system(T_A, T_B, K_AB, K_A2B, K_AB2)\n        all_results.append(result_list)\n\n    # Format the final output string exactly as specified:\n    # e.g., [[r1_1,...,r1_5],[r2_1,...,r2_5],...] with no spaces.\n    inner_strings = [f\"[{','.join(map(str, sublist))}]\" for sublist in all_results]\n    final_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_string)\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型必须以数值稳健的方式实现。本练习深入探讨了约束矩阵中常见的病态条件（ill-conditioning）问题，该问题可能源于我们定义组分和守恒方程的方式（例如，质量、电荷与碱度平衡之间的选择）。通过分析约束向量之间的相关性，您将学会如何诊断和改善吉布斯自由能最小化问题的数值稳定性，这是开发稳健地球化学模型的关键技能 。",
            "id": "4080498",
            "problem": "考虑一个在恒定温度和压力下的碳酸盐水溶液体系的吉布斯自由能最小化问题，其目标是在线性化学计量约束 $A \\mathbf{n} = \\mathbf{b}$下，最小化 $G(T,P,\\mathbf{n})$。物种向量按顺序表示为 $\\mathbf{s} = \\left[\\mathrm{CO_2(aq)}, \\mathrm{HCO_3^-}, \\mathrm{CO_3^{2-}}, \\mathrm{H^+}, \\mathrm{OH^-}, \\mathrm{Na^+}\\right]$。我们关心的两个约束是总无机碳平衡和电中性（电荷）平衡，由以下行向量表示\n$$\nr_C = [1,\\,1,\\,1,\\,0,\\,0,\\,0], \\qquad r_Q = [0,\\,-1,\\,-2,\\,+1,\\,-1,\\,+1].\n$$\n在碳酸盐体系中，一个常用的派生平衡是总碱度，（对于此物种集合）表示为\n$$\nr_A = [0,\\,+1,\\,+2,\\,-1,\\,+1,\\,0].\n$$\n在计算地球化学中，用于约束最小化的 Karush-Kuhn-Tucker (KKT) 系统的数值条件数受到约束之间相关性的强烈影响。在这里，两个约束之间的相关性由它们在物种空间中行向量之间夹角的余弦值来量化。你需要评估组分和约束的选择如何影响相关性，并找出一个能减少这种相关性的变换。\n\n下列陈述中，哪些是正确的？\n\nA. 对于给定的物种和约束， $r_C$ 和 $r_Q$ 之间的余弦值为负，并且选择一个标量 $\\alpha = \\dfrac{r_C \\cdot r_Q}{\\|r_C\\|^2}$ 来构造 $r_Q' = r_Q - \\alpha r_C$，会得到一个与碳平衡完全正交的变换后的电荷平衡，从而通过构造减少了它们的相关性。\n\nB. 对于此物种集合，用碱度平衡 $r_A$ 替换电中性平衡 $r_Q$ 会严格减小与 $r_C$ 的夹角余弦的绝对值，使得 $r_C$ 和 $r_A$ 的相关性低于 $r_C$ 和 $r_Q$。\n\nC. 在此物种集合中，将强离子项（如 $\\mathrm{Na^+}$）包含在 $r_Q$ 中但从 $r_A$ 中排除，倾向于减小 $(r_C,r_Q)$ 的 $\\left|\\cos \\theta\\right|$（相对于 $(r_C,r_A)$），因为强离子项增加了 $\\|r_Q\\|$ 而没有增加与 $r_C$ 的重叠。\n\nD. 选择组分 $\\{\\mathrm{CO_2(aq)}, \\mathrm{H^+}, \\mathrm{Na^+}\\}$ 并将 $\\mathrm{HCO_3^-}$, $\\mathrm{CO_3^{2-}}$ 和 $\\mathrm{OH^-}$ 视为次要物种，消除了在约束最小化中显式执行电中性约束的需要，从而保证了一个条件良好的 KKT 系统。\n\nE. 对约束矩阵 $A$ 进行行正交化（例如，通过薄 QR 分解）以获得一组具有标准正交行的等价约束，是一种改善条件数的数值上可靠的方法，并且由于该变换是可逆的，它保持了吉布斯自由能最小化问题的可行集。",
            "solution": "用户要求对问题陈述进行审慎验证，然后给出详细的解法和对所提供选项的评估。\n\n**问题验证**\n\n**步骤 1：提取给定信息**\n- **体系：** 在恒定温度 $T$ 和压力 $P$ 下的碳酸盐水溶液体系。\n- **方法：** $G(T,P,\\mathbf{n})$ 的吉布斯自由能最小化。\n- **约束：** 线性化学计量约束 $A \\mathbf{n} = \\mathbf{b}$。\n- **物种向量：** 物种按顺序表示为 $\\mathbf{s} = \\left[\\mathrm{CO_2(aq)}, \\mathrm{HCO_3^-}, \\mathrm{CO_3^{2-}}, \\mathrm{H^+}, \\mathrm{OH^-}, \\mathrm{Na^+}\\right]$。摩尔数向量为 $\\mathbf{n}$。\n- **约束向量：**\n    - 总无机碳平衡：$r_C = [1,\\,1,\\,1,\\,0,\\,0,\\,0]$。\n    - 电中性（电荷）平衡：$r_Q = [0,\\,-1,\\,-2,\\,+1,\\,-1,\\,+1]$。\n    - 总碱度：$r_A = [0,\\,+1,\\,+2,\\,-1,\\,+1,\\,0]$。\n- **相关性度量：** 两个约束之间的相关性由它们行向量之间夹角的余弦值量化。\n- **目标：** 评估组分和约束的选择如何影响相关性，并找出一个能减少这种相关性的变换。\n\n**步骤 2：使用提取的信息进行验证**\n- **科学上合理：** 该问题牢固地植根于计算地球化学和数值优化。吉布斯自由能最小化、将质量和电荷平衡表示为线性约束、所列出的物种以及碱度的概念都是标准和基础的。对由于相关约束导致的 Karush-Kuhn-Tucker (KKT) 系统的数值条件问题的关注，是应用数值分析中的一个关键且有效的问题。\n- **良构的：** 该问题提供了具体的向量和定义。选项中提出的问题可以使用标准线性代数（点积、范数、夹角）和约束优化的数值方法知识进行评估。该问题是自洽的并且在数学上是可处理的。\n- **客观的：** 语言是技术性的、精确的，并且没有主观性。约束向量的定义清晰，并与给定物种集合的标准地球化学惯例相对应。\n\n**缺陷检查清单：**\n1.  **科学或事实不健全：** 无。对于指定的物种列表，碳平衡、电荷平衡和碱度的向量表示是正确的。它们之间的关系在化学上是一致的。\n2.  **不可形式化或不相关：** 无。该问题与主题直接相关。\n3.  **不完整或矛盾的设置：** 无。所有必要的向量和定义都已提供。\n4.  **不切实际或不可行：** 无。该设置描述了一种常见的地球化学建模问题。\n5.  **病态或结构不良：** 无。问题有明确的答案。\n6.  **伪深刻、琐碎或同义反复：** 无。该问题需要将线性代数的实质性概念应用于一个真实的科学问题。\n7.  **超出科学可验证性：** 无。所有主张都可以通过数学方式验证。\n\n**步骤 3：结论和行动**\n问题陈述是有效的。我将继续进行完整解答。\n\n**解题推导**\n\n首先，我们计算必要的向量范数和点积。给定的向量是：\n$$\nr_C = [1,\\,1,\\,1,\\,0,\\,0,\\,0]\n$$\n$$\nr_Q = [0,\\,-1,\\,-2,\\,+1,\\,-1,\\,+1]\n$$\n$$\nr_A = [0,\\,+1,\\,+2,\\,-1,\\,+1,\\,0]\n$$\n\n欧几里得范数的平方是：\n$$\n\\|r_C\\|^2 = 1^2 + 1^2 + 1^2 + 0^2 + 0^2 + 0^2 = 3\n$$\n$$\n\\|r_Q\\|^2 = 0^2 + (-1)^2 + (-2)^2 + 1^2 + (-1)^2 + 1^2 = 1 + 4 + 1 + 1 + 1 = 8\n$$\n$$\n\\|r_A\\|^2 = 0^2 + 1^2 + 2^2 + (-1)^2 + 1^2 + 0^2 = 1 + 4 + 1 + 1 = 7\n$$\n相应的范数是 $\\|r_C\\| = \\sqrt{3}$，$\\|r_Q\\| = \\sqrt{8} = 2\\sqrt{2}$，以及 $\\|r_A\\| = \\sqrt{7}$。\n\n碳平衡向量 $r_C$ 与另外两个向量的点积是：\n$$\nr_C \\cdot r_Q = (1)(0) + (1)(-1) + (1)(-2) + (0)(1) + (0)(-1) + (0)(1) = -3\n$$\n$$\nr_C \\cdot r_A = (1)(0) + (1)(1) + (1)(2) + (0)(-1) + (0)(1) + (0)(0) = 3\n$$\n\n两个向量 $\\mathbf{u}$ 和 $\\mathbf{v}$ 之间夹角 $\\theta$ 的余弦值由 $\\cos\\theta = \\frac{\\mathbf{u} \\cdot \\mathbf{v}}{\\|\\mathbf{u}\\| \\|\\mathbf{v}\\|}$ 给出。\n\n$r_C$ 和 $r_Q$ 之间夹角的余弦值是：\n$$\n\\cos(r_C, r_Q) = \\frac{r_C \\cdot r_Q}{\\|r_C\\| \\|r_Q\\|} = \\frac{-3}{\\sqrt{3}\\sqrt{8}} = \\frac{-3}{\\sqrt{24}} = -\\sqrt{\\frac{9}{24}} = -\\sqrt{\\frac{3}{8}}\n$$\n\n$r_C$ 和 $r_A$ 之间夹角的余弦值是：\n$$\n\\cos(r_C, r_A) = \\frac{r_C \\cdot r_A}{\\|r_C\\| \\|r_A\\|} = \\frac{3}{\\sqrt{3}\\sqrt{7}} = \\frac{3}{\\sqrt{21}} = \\sqrt{\\frac{9}{21}} = \\sqrt{\\frac{3}{7}}\n$$\n\n现在我们评估每个选项。\n\n**选项 A 评估**\n“对于给定的物种和约束， $r_C$ 和 $r_Q$ 之间的余弦值为负，并且选择一个标量 $\\alpha = \\frac{r_C \\cdot r_Q}{\\|r_C\\|^2}$ 来构造 $r_Q' = r_Q - \\alpha r_C$，会得到一个与碳平衡完全正交的变换后的电荷平衡，从而通过构造减少了它们的相关性。”\n\n1.  **余弦值的符号：** 我们计算出 $r_C \\cdot r_Q = -3$。由于范数总是正的，余弦值 $\\cos(r_C, r_Q)$ 为负。这部分是正确的。\n2.  **正交化：** 使用 $\\alpha = \\frac{r_C \\cdot r_Q}{\\|r_C\\|^2}$ 的变换 $r_Q' = r_Q - \\alpha r_C$ 是将 $r_Q$ 相对于 $r_C$ 进行正交化的 Gram-Schmidt 过程。我们来验证结果向量 $r_Q'$ 与 $r_C$ 的正交性：\n    $$\n    r_Q' \\cdot r_C = (r_Q - \\alpha r_C) \\cdot r_C = r_Q \\cdot r_C - \\alpha (r_C \\cdot r_C)\n    $$\n    代入 $\\alpha$ 的表达式：\n    $$\n    r_Q' \\cdot r_C = r_Q \\cdot r_C - \\left(\\frac{r_C \\cdot r_Q}{\\|r_C\\|^2}\\right) \\|r_C\\|^2 = r_Q \\cdot r_C - r_C \\cdot r_Q = 0\n    $$\n    由于点积为零，这两个向量是正交的。正交意味着它们之间夹角的余弦值为 $0$，这是可能达到的最小相关性。该过程通过构造将相关性降低到零。该陈述完全正确。\n\n**对 A 的结论：** 正确。\n\n**选项 B 评估**\n“对于此物种集合，用碱度平衡 $r_A$ 替换电中性平衡 $r_Q$ 会严格减小与 $r_C$ 的夹角余弦的绝对值，使得 $r_C$ 和 $r_A$ 的相关性低于 $r_C$ 和 $r_Q$。”\n\n该陈述声称 $|\\cos(r_C, r_A)| < |\\cos(r_C, r_Q)|$。让我们比较我们计算出的值：\n$$\n|\\cos(r_C, r_Q)| = \\left|-\\sqrt{\\frac{3}{8}}\\right| = \\sqrt{\\frac{3}{8}}\n$$\n$$\n|\\cos(r_C, r_A)| = \\sqrt{\\frac{3}{7}}\n$$\n为了比较这些值，我们比较平方根内的参数。因为 $7 < 8$，我们有 $\\frac{1}{7} > \\frac{1}{8}$。乘以一个正数 $3$，我们得到 $\\frac{3}{7} > \\frac{3}{8}$。因此，$\\sqrt{\\frac{3}{7}} > \\sqrt{\\frac{3}{8}}$。\n这意味着 $|\\cos(r_C, r_A)| > |\\cos(r_C, r_Q)|$。用 $r_A$ 替换 $r_Q$ 会*增加*与 $r_C$ 的相关性，而不是减少它。该陈述是错误的。\n\n**对 B 的结论：** 不正确。\n\n**选项 C 评估**\n“在此物种集合中，将强离子项（如 $\\mathrm{Na^+}$）包含在 $r_Q$ 中但从 $r_A$ 中排除，倾向于减小 $\\left|\\cos \\theta\\right|$ for $(r_C,r_Q)$ 相对于 $(r_C,r_A)$，因为强离子项增加了 $\\|r_Q\\|$ 而没有增加与 $r_C$ 的重叠。”\n\n让我们分析其逻辑。向量 $r_C$ 在对应 $\\mathrm{Na^+}$ 的位置上为 $0$。向量 $r_Q$ 在该位置上为 $1$，而 $r_A$ 为 $0$。\n1.  **对重叠的影响：** “重叠”即点积。$\\mathrm{Na^+}$ 组分对点积 $r_C \\cdot r_Q$ 的贡献是 $(r_C)_6 \\times (r_Q)_6 = 0 \\times 1 = 0$。因此，在 $r_Q$ 中包含强离子项不会改变点积 $r_C \\cdot r_Q$。重叠仍然是 $r_C \\cdot r_Q = -3$。\n2.  **对范数的影响：** $r_Q$ 的范数是 $\\|r_Q\\| = \\sqrt{0^2 + (-1)^2 + (-2)^2 + 1^2 + (-1)^2 + 1^2} = \\sqrt{8}$。如果不包括 $\\mathrm{Na^+}$ 项，向量将是 $[0,\\,-1,\\,-2,\\,+1,\\,-1,\\,0]$，其范数的平方将是 $1+4+1+1=7$。因此，由于包含了 $\\mathrm{Na^+}$ 项，范数从 $\\sqrt{7}$ 增加到 $\\sqrt{8}$。\n3.  **对余弦值的影响：** 余弦值的绝对值是 $|\\cos(r_C, r_Q)| = \\frac{|r_C \\cdot r_Q|}{\\|r_C\\| \\|r_Q\\|} = \\frac{|-3|}{\\sqrt{3} \\|r_Q\\|}$。由于包含 $\\mathrm{Na^+}$ 项增加了 $\\|r_Q\\|$ 而保持 $|r_C \\cdot r_Q|$ 和 $\\|r_C\\|$ 不变，因此它减小了 $|\\cos(r_C, r_Q)|$ 的值。\n4.  **与 $(r_C, r_A)$ 的比较：** 向量 $r_A$ 不包含强离子项。其范数为 $\\|r_A\\|=\\sqrt{7}$。其与 $r_C$ 的点积大小为 $|r_C \\cdot r_A| = |3| = 3$。我们在比较 $|\\cos(r_C, r_Q)| = \\frac{3}{\\sqrt{3}\\sqrt{8}}$ 和 $|\\cos(r_C, r_A)| = \\frac{3}{\\sqrt{3}\\sqrt{7}}$。正如在选项 B 的分析中确立的，$\\frac{3}{\\sqrt{3}\\sqrt{8}} < \\frac{3}{\\sqrt{3}\\sqrt{7}}$。因此，关于在 $r_Q$ 中包含强离子项会导致 $(r_C, r_Q)$ 的相关性大小小于 $(r_C, r_A)$ 的陈述是正确的。选项中提供的推理也完全合理。\n\n**对 C 的结论：** 正确。\n\n**选项 D 评估**\n“选择组分 $\\{\\mathrm{CO_2(aq)}, \\mathrm{H^+}, \\mathrm{Na^+}\\}$ 并将 $\\mathrm{HCO_3^-}$, $\\mathrm{CO_3^{2-}}$ 和 $\\mathrm{OH^-}$ 视为次要物种，消除了在约束最小化中显式执行电中性约束的需要，从而保证了一个条件良好的 KKT 系统。”\n\n这描述了一种基切换或基于组分的方法。次要物种的量通过平衡常数表达式表示为组分物种量的函数。然而，系统的基本约束，如总碳量和电中性，仍然必须满足。在这种表述中，它们变成了关于组分物种量的非线性方程。电中性约束没有被移除；它仅仅被转换成另一种非线性的代数形式。为了找到正确的化学平衡状态，仍然必须强制执行它。\n此外，“保证了一个条件良好的 KKT 系统”的说法过于强烈且是错误的。虽然改变基底有时可以改善数值性能，但它也可能使其恶化。由此产生的非线性系统的条件数是依赖于具体问题的，并没有这样的保证。事实上，这类方法本身也可能存在数值挑战（例如，收敛性差）。\n\n**对 D 的结论：** 不正确。\n\n**选项 E 评估**\n“对约束矩阵 $A$ 进行行正交化（例如，通过薄 $QR$ 分解）以获得一组具有标准正交行的等价约束，是一种改善条件数的数值上可靠的方法，并且由于该变换是可逆的，它保持了吉布斯自由能最小化问题的可行集。”\n\n设原始的线性约束集为 $A\\mathbf{n} = \\mathbf{b}$。行变换对应于左乘一个可逆矩阵 $M$。新系统是 $(MA)\\mathbf{n} = M\\mathbf{b}$。设 $A' = MA$ 且 $\\mathbf{b}' = M\\mathbf{b}$。\n1.  **可行集的保持：** 一个向量 $\\mathbf{n}$ 满足 $A\\mathbf{n}=\\mathbf{b}$ 当且仅当它满足 $M(A\\mathbf{n}) = M\\mathbf{b}$，即 $A'\\mathbf{n}=\\mathbf{b}'$。这是成立的，因为 $M$ 是可逆的。因此，可行解 $\\mathbf{n}$ 的集合保持不变。这部分陈述是正确的。\n2.  **数值条件：** 用于解决约束最小化问题的 KKT 系统的条件数，对约束矩阵 $A$ 各行之间的线性依赖性高度敏感。高度相关的行会导致一个病态（近乎奇异）的 KKT 矩阵，这对数值求解器构成了重大问题。将 $A$ 的行变换为正交（或标准正交）可以完全消除这种病态的来源。这是数值优化中一种标准且强大的预处理技术。\n3.  **QR 分解：** 使用 $A^T$ 的薄 QR 分解（即 $A^T = QR$）是计算 $A$ 的行空间的一个标准正交基的一种标准且数值稳定的方法。$Q^T$ 的行构成了新的标准正交约束向量。\n整个陈述描述了在数值计算中解决约束优化问题时一种有效且常见的做法。\n\n**对 E 的结论：** 正确。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}