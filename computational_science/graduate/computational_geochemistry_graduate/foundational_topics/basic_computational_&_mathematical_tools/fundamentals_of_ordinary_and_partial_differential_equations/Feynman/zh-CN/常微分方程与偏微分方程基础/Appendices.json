{
    "hands_on_practices": [
        {
            "introduction": "任何数值方案的首要前提是稳定性——一个不稳定的方案会产生无物理意义的、爆炸性的结果。本练习将介绍冯·诺依曼稳定性分析，这是一种用于检验线性、常系数偏微分方程离散格式稳定性的基本工具。通过对一个标准的一维扩散方程显式格式进行分析 ，您将亲手推导出稳定性的关键条件，从而深刻理解离散步长 $\\Delta t$ 和 $\\Delta x$ 之间的内在制约关系。",
            "id": "4079415",
            "problem": "在等温和孔隙度恒定的条件下，模拟了一个保守性水相示踪剂通过长度为 $L$ 的均质、水饱和沉积物岩心的一维扩散过程。设 $C(x,t)$ 表示溶解的示踪剂浓度（单位孔隙水体积的摩尔数）。在无平流和无化学反应的假设下，控制方程源于质量守恒和 Fick 扩散第一定律：守恒表达式为 $\\partial C/\\partial t + \\partial J/\\partial x = 0$，通量为 $J = -D\\,\\partial C/\\partial x$，其中 $D$ 是恒定的有效扩散系数。结合这些可得扩散方程 $\\partial C/\\partial t = D\\,\\partial^{2} C/\\partial x^{2}$。\n\n考虑一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格，以及以下通过时间上向前欧拉法和空间上中心二阶有限差分得到的显式时间推进格式：\n$$\nC_{j}^{n+1} \\;=\\; C_{j}^{n} \\;+\\; \\alpha \\,\\big(C_{j+1}^{n} \\;-\\; 2\\,C_{j}^{n} \\;+\\; C_{j-1}^{n}\\big),\n$$\n其中 $j$ 是空间索引，$n$ 是时间索引，$\\alpha \\equiv D\\,\\Delta t/\\Delta x^{2}$ 是无量纲扩散数（也称为傅里叶数）。\n\n假设周期性边界条件，使得傅里叶模能够张成离散解空间，并从上述控制守恒定律、本构关系以及给定的离散化方法出发，进行 von Neumann 稳定性分析。施加必要且充分的条件，即对于所有可分辨的波数，放大因子的模不超过1。确定最大的允许值 $\\alpha_{\\max}$，使得该格式对于所有 $0 \\leq \\alpha \\leq \\alpha_{\\max}$ 都是稳定的。请以单个精确数字的形式提供答案，不带单位。",
            "solution": "用户提供了一个有效的问题陈述。控制偏微分方程、其有限差分格式以及分析方法都是标准的且适定的。该问题具有科学依据，陈述规范，并包含推导唯一解所需的所有信息。\n\n任务是针对给定的一维扩散方程显式有限差分格式进行 von Neumann 稳定性分析，以找出无量纲扩散数 $\\alpha$ 的最大允许值。\n\n有限差分格式由下式给出：\n$$\nC_{j}^{n+1} \\;=\\; C_{j}^{n} \\;+\\; \\alpha \\,\\big(C_{j+1}^{n} \\;-\\; 2\\,C_{j}^{n} \\;+\\; C_{j-1}^{n}\\big)\n$$\n其中 $C_j^n$ 表示空间索引为 $j$、时间索引为 $n$ 处的浓度，且 $\\alpha = \\frac{D \\Delta t}{\\Delta x^2}$。\n\n在 von Neumann 稳定性分析中，我们考察解的单个傅里叶模随时间演变的放大情况。一个离散傅里叶模可以表示为：\n$$\nC_j^n = \\hat{C}^n(k) \\exp(i k x_j)\n$$\n其中 $x_j = j \\Delta x$ 是空间坐标，$k$ 是波数，$i = \\sqrt{-1}$，$\\hat{C}^n(k)$ 是该模在时间层 $n$ 的振幅。\n\n由于有限差分方程的线性性质，该单模在下一时间步 $n+1$ 的解将具有以下形式：\n$$\nC_j^{n+1} = \\hat{C}^{n+1}(k) \\exp(i k x_j)\n$$\n放大因子 $\\mathcal{G}(k)$ 定义为连续时间步长上振幅的比值：\n$$\n\\mathcal{G}(k) = \\frac{\\hat{C}^{n+1}(k)}{\\hat{C}^n(k)}\n$$\n因此，我们可以写成 $C_j^{n+1} = \\mathcal{G}(k) C_j^n$。格式稳定的充分必要条件是，对于所有可能的波数，放大因子的模都小于或等于1，即 $|\\mathcal{G}(k)| \\le 1$。\n\n我们将傅里叶模的表示形式代入有限差分格式中。\n对于项 $C_j^n$，我们有 $\\hat{C}^n \\exp(i k j \\Delta x)$。\n对于 $C_{j+1}^n$，我们有 $\\hat{C}^n \\exp(i k (j+1) \\Delta x) = \\hat{C}^n \\exp(i k j \\Delta x) \\exp(i k \\Delta x)$。\n对于 $C_{j-1}^n$，我们有 $\\hat{C}^n \\exp(i k (j-1) \\Delta x) = \\hat{C}^n \\exp(i k j \\Delta x) \\exp(-i k \\Delta x)$。\n对于 $C_j^{n+1}$，我们有 $\\mathcal{G} \\hat{C}^n \\exp(i k j \\Delta x)$。\n\n将这些代入格式中得到：\n$$\n\\mathcal{G} \\hat{C}^n \\exp(i k j \\Delta x) = \\hat{C}^n \\exp(i k j \\Delta x) + \\alpha \\left[ \\hat{C}^n \\exp(i k j \\Delta x) \\exp(i k \\Delta x) - 2\\hat{C}^n \\exp(i k j \\Delta x) + \\hat{C}^n \\exp(i k j \\Delta x) \\exp(-i k \\Delta x) \\right]\n$$\n我们可以两边同除以公共非零项 $\\hat{C}^n \\exp(i k j \\Delta x)$ 来求解 $\\mathcal{G}$：\n$$\n\\mathcal{G} = 1 + \\alpha \\left( \\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x) \\right)\n$$\n使用欧拉公式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，并令 $\\theta = k \\Delta x$，我们简化括号中的表达式：\n$$\n\\mathcal{G} = 1 + \\alpha \\left( 2\\cos(k \\Delta x) - 2 \\right) = 1 + 2\\alpha \\left( \\cos(k \\Delta x) - 1 \\right)\n$$\n接下来，我们使用三角恒等式 $\\cos(\\theta) - 1 = -2\\sin^2(\\theta/2)$：\n$$\n\\mathcal{G} = 1 + 2\\alpha \\left( -2\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\right)\n$$\n$$\n\\mathcal{G} = 1 - 4\\alpha \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n放大因子 $\\mathcal{G}$ 是一个实数。稳定性条件是 $|\\mathcal{G}| \\le 1$，这等价于两个不等式 $-1 \\le \\mathcal{G} \\le 1$。\n\n让我们分析每个不等式：\n1.  $\\mathcal{G} \\le 1$：\n    $$1 - 4\\alpha \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1$$\n    $$-4\\alpha \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 0$$\n    由于 $\\alpha = D \\Delta t / \\Delta x^2$ 是非负的（因为 $D \\ge 0$，$ \\Delta t > 0$，且 $\\Delta x^{2} > 0$），并且 $\\sin^2(\\cdot)$ 总是非负的，所以乘积 $-4\\alpha \\sin^2(\\cdot)$ 总是小于或等于零。因此，这个不等式总是满足的，对 $\\alpha$ 没有施加任何限制。\n\n2.  $\\mathcal{G} \\ge -1$：\n    $$1 - 4\\alpha \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1$$\n    $$2 \\ge 4\\alpha \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$$\n    $$\\alpha \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le \\frac{2}{4}$$\n    $$\\alpha \\le \\frac{1}{2\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)}$$\n这个条件必须对网格上可以表示的所有波数 $k$ 都成立。为确保这一点，我们必须考虑“最坏情况”，即对 $\\alpha$ 施加最严格（即最小）上界的情况。这种情况发生在分母 $2\\sin^2(k \\Delta x / 2)$ 达到其最大值时。\n\n函数 $\\sin^2(\\theta)$ 的最大值是 $1$。自变量是 $\\theta = k \\Delta x / 2$。对于网格上可分辨的最高频率（振荡最剧烈）的模，项 $\\sin^2(k \\Delta x / 2)$ 达到其最大值 $1$，该模对应的波长为 $2 \\Delta x$。这是奈奎斯特频率，此时波数为 $k = \\pi/\\Delta x$，使得自变量 $k \\Delta x / 2 = \\pi/2$。\n\n对于这个“最坏情况”的模，我们有：\n$$\n\\sin^2\\left(\\frac{\\pi \\Delta x}{2 \\Delta x}\\right) = \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1^2 = 1\n$$\n将这个最大值代入稳定性不等式，得到对 $\\alpha$ 的最严格条件：\n$$\n\\alpha \\le \\frac{1}{2(1)} \\implies \\alpha \\le \\frac{1}{2}\n$$\n因此，为使格式对所有可分辨的模都稳定，无量纲扩散数 $\\alpha$ 不得大于 $1/2$。最大的允许值 $\\alpha_{\\max}$ 就是这个上界。\n$$\n\\alpha_{\\max} = \\frac{1}{2}\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "在地球化学反应输运模型中，化学反应项常常引入“刚性”（stiffness）问题，即不同反应的速率可能相差数个数量级。对于这类刚性系统，显式时间积分方法（如显式欧拉法）的稳定性会受到极大限制，迫使我们采用极小的时间步长。本练习  旨在通过线性稳定性分析，揭示显式欧拉法在处理刚性动力学问题时不稳定的根本原因，并推导其稳定性对时间步长的苛刻要求。",
            "id": "4079418",
            "problem": "在计算地球化学的反应输运模拟中，溶解-沉淀动力学与输运过程耦合，共同控制水相浓度。考虑在反应步骤中通过算子分裂法处理的单个网格单元，因此局部化学反应在没有平流或扩散的情况下随时间推进。设 $c(t)$ 表示参与溶解-沉淀过程的某个水相物种的浓度，该过程具有一个光滑的动力学源项 $S(c)$，它将系统驱动至满足 $S(c^{\\ast})=0$ 的化学平衡态 $c^{\\ast}$。假设条件为等温、孔隙度恒定，且质量守恒给出常微分方程 (ODE) $dc/dt=S(c)$。在 $c^{\\ast}$ 附近，动力学的线性化得到 $S(c)\\approx S(c^{\\ast})+S^{\\prime}(c^{\\ast})(c-c^{\\ast})$，因此扰动 $\\delta c(t)=c(t)-c^{\\ast}$ 服从一个近似线性的常微分方程，其稳定性由 $S^{\\prime}(c^{\\ast})$ 的符号和大小决定。在具有向量状态 $\\mathbf{c}(t)\\in\\mathbb{R}^{m}$ 的多物种系统中，质量守恒和光滑的动力学项 $\\mathbf{S}(\\mathbf{c})$ 在满足 $\\mathbf{S}(\\mathbf{c}^{\\ast})=\\mathbf{0}$ 的稳态 $\\mathbf{c}^{\\ast}$ 附近线性化，得到 $d\\boldsymbol{\\delta c}/dt=\\mathbf{J}\\boldsymbol{\\delta c}$，其中 $\\mathbf{J}=\\partial \\mathbf{S}/\\partial \\mathbf{c}|_{\\mathbf{c}^{\\ast}}$ 是雅可比矩阵。在许多地球化学系统中，溶解-沉淀动力学产生刚性问题，这意味着与缓慢的输运时间尺度相比，$\\mathbf{J}$ 的特征值可以具有很大的负实部。\n\n有时会对反应步骤应用显式欧拉时间离散：在标量情况下为 $c^{n+1}=c^{n}+\\Delta t\\,S(c^{n})$；在线性化多物种情况下为 $\\boldsymbol{\\delta c}^{\\,n+1}=(\\mathbf{I}+\\Delta t\\,\\mathbf{J})\\,\\boldsymbol{\\delta c}^{\\,n}$，其中 $\\Delta t$ 是时间步长，$\\mathbf{I}$ 是单位矩阵。请仅使用质量守恒的基本原理、速率定律的光滑性以及线性化系统的线性稳定性分析，解释为什么在存在刚性溶解-沉淀动力学时，显式欧拉法会变得不稳定，并推导在标量情况和一般多物种情况下保证线性稳定的 $\\Delta t$ 条件。\n\n选择所有正确的陈述：\n\nA. 在标量线性化情况 $d\\delta c/dt=\\lambda\\,\\delta c$ 中，其中 $\\lambda=S^{\\prime}(c^{\\ast})0$，显式欧拉法是线性稳定的当且仅当 $|1+\\Delta t\\,\\lambda|1$，对于实数 $\\lambda0$，这等价于 $0\\Delta t\\dfrac{2}{|\\lambda|}$。当 $\\Delta t$ 超过此界限时，数值解会振荡并发散。\n\nB. 对于任何标量 $\\lambda0$，显式欧拉法对所有 $\\Delta t>0$ 都是无条件稳定的，因为精确解是衰减的，所以数值解也必须衰减。\n\nC. 在线性化多物种情况 $d\\boldsymbol{\\delta c}/dt=\\mathbf{J}\\,\\boldsymbol{\\delta c}$ 中，显式欧拉法是线性稳定的当且仅当 $\\mathbf{J}$ 的每个特征值 $\\lambda_{i}$ 都满足 $|1+\\Delta t\\,\\lambda_{i}|1$，这等价于谱半径条件 $\\rho(\\mathbf{I}+\\Delta t\\,\\mathbf{J})1$；几何上，$\\Delta t\\,\\lambda_{i}$ 必须严格位于复平面上以 $-1$ 为中心、半径为 $1$ 的开圆盘内部。\n\nD. 当反应与输运耦合时，对 $\\Delta t$ 的唯一相关限制是来自平流的 Courant–Friedrichs–Lewy (CFL) 条件，即 $\\Delta t\\leq \\Delta x/|u|$，因此刚性溶解-沉淀动力学不会对显式欧拉法施加任何额外的稳定性限制。\n\nE. 显式欧拉法对于刚性溶解-沉淀动力学的不稳定性主要是由舍入误差引起的；如果使用精确算术，即使动力学是刚性的，显式欧拉法对于大的 $\\Delta t$ 也会是稳定的。",
            "solution": "该问题陈述是应用于计算地球化学的数值分析领域中一个有效且提法恰当的问题。它提出了反应输运模型中算子分裂的一个标准场景，其中化学反应步骤会引入刚性问题，并要求对显式欧拉法的稳定性进行分析。所有术语都是标准的，前提条件在科学上是合理的。\n\n该问题要求解释不稳定机制，并为使用显式欧拉法离散的刚性常微分方程(ODE)系统推导稳定性条件。\n\n让我们从一般多物种情况开始，因为标量情况是它的一个特例。关于平衡态的扰动 $\\boldsymbol{\\delta c}(t) = \\mathbf{c}(t) - \\mathbf{c}^{\\ast}$ 的线性化系统由下式给出：\n$$\n\\frac{d\\boldsymbol{\\delta c}}{dt} = \\mathbf{J}\\boldsymbol{\\delta c}\n$$\n其中 $\\mathbf{J}$ 是在平衡态 $\\mathbf{c}^{\\ast}$ 处计算的动力学源项 $\\mathbf{S}(\\mathbf{c})$ 的雅可比矩阵。为使物理系统稳定（即，扰动衰减且系统返回平衡），$\\mathbf{J}$ 的所有特征值的实部必须为非正数。我们假设一个稳定的平衡态，因此对于 $\\mathbf{J}$ 的所有特征值 $\\lambda_i$，都有 $\\text{Re}(\\lambda_i) \\leq 0$。\n\n使用显式欧拉法离散该 ODE 系统：\n$$\n\\boldsymbol{\\delta c}^{\\,n+1} = \\boldsymbol{\\delta c}^{\\,n} + \\Delta t \\, (\\mathbf{J}\\boldsymbol{\\delta c}^{\\,n})\n$$\n在右侧提出公因子 $\\boldsymbol{\\delta c}^{\\,n}$，得到迭代映射：\n$$\n\\boldsymbol{\\delta c}^{\\,n+1} = (\\mathbf{I} + \\Delta t\\,\\mathbf{J})\\,\\boldsymbol{\\delta c}^{\\,n}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵，$\\Delta t$ 是时间步长。令 $\\mathbf{G} = \\mathbf{I} + \\Delta t\\,\\mathbf{J}$ 为放大矩阵。经过 $k$ 步后，解为 $\\boldsymbol{\\delta c}^{\\,k} = \\mathbf{G}^k \\boldsymbol{\\delta c}^{\\,0}$。\n\n为使数值解稳定（即，对于任意初始扰动 $\\boldsymbol{\\delta c}^{\\,0}$，当 $k \\to \\infty$ 时 $\\boldsymbol{\\delta c}^{\\,k} \\to \\mathbf{0}$），放大矩阵 $\\mathbf{G}$ 必须是一个“压缩映射”。在线性代数中，这等价于 $\\mathbf{G}$ 的谱半径（记为 $\\rho(\\mathbf{G})$）必须严格小于 $1$ 的条件。\n$$\n\\rho(\\mathbf{G})  1\n$$\n谱半径定义为 $\\mathbf{G}$ 的特征值模的最大值。设 $\\mathbf{J}$ 的特征值为 $\\{\\lambda_i\\}$。那么 $\\mathbf{G} = \\mathbf{I} + \\Delta t\\,\\mathbf{J}$ 的特征值为 $\\{1+\\Delta t\\,\\lambda_i\\}$。\n因此，稳定性条件变为：\n$$\n\\rho(\\mathbf{I} + \\Delta t\\,\\mathbf{J}) = \\max_{i} |1 + \\Delta t\\,\\lambda_i|  1\n$$\n这意味着条件 $|1 + \\Delta t\\,\\lambda_i|  1$ 必须对雅可比矩阵 $\\mathbf{J}$ 的*每一个*特征值 $\\lambda_i$ 都成立。\n\n在几何上，这个条件可以在复平面中解释。如果我们令 $z = \\Delta t\\,\\lambda_i$，条件就是 $|1+z|  1$，或 $|z - (-1)|  1$。这描述了复平面上以点 $-1+0i$ 为中心、半径为 $1$ 的一个开圆盘。因此，为使显式欧拉法稳定，所有的 $z_i = \\Delta t\\,\\lambda_i$ 值（对于 $\\mathbf{J}$ 的所有特征值 $\\lambda_i$）都必须严格位于此圆盘内部。该圆盘是显式欧拉法的绝对稳定域。\n\n地球化学动力学中的刚性意味着，与其他反应或输运时间尺度相比，某些反应非常快。在数学上，这转化为雅可比矩阵 $\\mathbf{J}$ 至少有一个特征值 $\\lambda_s$ 具有绝对值很大的负实部。设 $\\lambda_s = a+ib$，其中 $a = \\text{Re}(\\lambda_s) \\ll 0$。稳定性条件要求 $\\Delta t\\,\\lambda_s$ 位于稳定域圆盘内。此圆盘最左侧的点是 $-2$。因此我们必须有 $\\text{Re}(\\Delta t\\,\\lambda_s) > -2$，即 $\\Delta t \\cdot a > -2$。由于 $a$ 是负数，这意味着 $\\Delta t  -2/a = 2/|a| = 2/|\\text{Re}(\\lambda_s)|$。\n这就是不稳定的解释：刚性（即大的 $|\\text{Re}(\\lambda_s)|$）为稳定的数值积分施加了一个非常小的时间步长 $\\Delta t$ 上限。如果选择一个较大的 $\\Delta t$，最刚性模式的放大因子 $|1+\\Delta t\\,\\lambda_s|$ 将会超过 $1$，导致数值解的相应分量指数增长，从而引发灾难性的不稳定。\n\n现在我们可以推导标量情况下的条件。此时，系统为 $d\\delta c/dt = \\lambda \\delta c$，其中 $\\lambda = S'(c^{\\ast})$。对于一个稳定的平衡，我们必须有 $\\lambda  0$。显式欧拉法的更新公式是 $\\delta c^{n+1} = (1 + \\Delta t \\lambda) \\delta c^n$。稳定性条件就是标量放大因子的模小于 $1$：\n$$\n|1 + \\Delta t \\lambda|  1\n$$\n由于 $\\lambda$ 是一个负实数，这个不等式等价于：\n$$\n-1  1 + \\Delta t \\lambda  1\n$$\n所有部分都减去 $1$ 得到：\n$$\n-2  \\Delta t \\lambda  0\n$$\n由于 $\\Delta t > 0$ 且物理稳定性要求 $\\lambda  0$，右侧的不等式 $\\Delta t \\lambda  0$ 总是满足的。我们关注左侧的不等式：\n$$\n-2  \\Delta t \\lambda\n$$\n除以 $\\lambda$（因为是负数，所以我们反转不等号）：\n$$\n\\frac{-2}{\\lambda} > \\Delta t\n$$\n由于 $\\lambda$ 是负数，$-\\lambda = |\\lambda|$。最终的稳定性条件是：\n$$\n0  \\Delta t  \\frac{2}{|\\lambda|}\n$$\n\n我们现在来评估每个选项。\n\nA. 在标量线性化情况 $d\\delta c/dt=\\lambda\\,\\delta c$ 中，其中 $\\lambda=S^{\\prime}(c^{\\ast})0$，显式欧拉法是线性稳定的当且仅当 $|1+\\Delta t\\,\\lambda|1$，对于实数 $\\lambda0$，这等价于 $0\\Delta t\\dfrac{2}{|\\lambda|}$。当 $\\Delta t$ 超过此界限时，数值解会振荡并发散。\n这个陈述与我们的推导完全一致。稳定性条件 $|1+\\Delta t\\,\\lambda|1$ 是正确的。推导出的界限 $0\\Delta t2/|\\lambda|$ 也是正确的。如果超过这个界限，即 $\\Delta t > 2/|\\lambda|$，那么 $\\Delta t \\lambda  -2$，这意味着 $1+\\Delta t \\lambda  -1$。放大因子是一个模大于 $1$ 且符号为负的实数。这将导致数值解在每一步都交替变号（振荡）且数值增大（发散）。\n**结论：正确。**\n\nB. 对于任何标量 $\\lambda0$，显式欧拉法对所有 $\\Delta t>0$ 都是无条件稳定的，因为精确解是衰减的，所以数值解也必须衰减。\n这是错误的。如选项 A 的分析所示，显式欧拉法的稳定性是关于 $\\Delta t$ 的条件稳定性。其推理是谬误的；常微分方程解析解的稳定性并不能保证其通过给定方法得到的数值近似解的稳定性。显式欧拉法是条件稳定方法的一个著名例子。\n**结论：错误。**\n\nC. 在线性化多物种情况 $d\\boldsymbol{\\delta c}/dt=\\mathbf{J}\\,\\boldsymbol{\\delta c}$ 中，显式欧拉法是线性稳定的当且仅当 $\\mathbf{J}$ 的每个特征值 $\\lambda_{i}$ 都满足 $|1+\\Delta t\\,\\lambda_{i}|1$，这等价于谱半径条件 $\\rho(\\mathbf{I}+\\Delta t\\,\\mathbf{J})1$；几何上，$\\Delta t\\,\\lambda_{i}$ 必须严格位于复平面上以 $-1$ 为中心、半径为 $1$ 的开圆盘内部。\n这个陈述是对多物种情况下稳定性条件的正确且完整的描述。我们的推导表明，稳定性要求放大矩阵 $\\mathbf{G} = \\mathbf{I}+\\Delta t\\,\\mathbf{J}$ 的谱半径小于 $1$，这等价于对 $\\mathbf{J}$ 的所有特征值 $\\lambda_i$ 都有 $|1+\\Delta t\\,\\lambda_i|1$。将其几何解释为以 $-1+0i$ 为中心、半径为 $1$ 的开圆盘也是正确的。\n**结论：正确。**\n\nD. 当反应与输运耦合时，对 $\\Delta t$ 的唯一相关限制是来自平流的 Courant–Friedrichs–Lewy (CFL) 条件，即 $\\Delta t\\leq \\Delta x/|u|$，因此刚性溶解-沉淀动力学不会对显式欧拉法施加任何额外的稳定性限制。\n这是错误的。当对输运和反应都使用显式方法并结合算子分裂时，总的时间步长必须满足*所有*子问题的稳定性约束。在存在刚性动力学的情况下，反应稳定性约束 $\\Delta t  2/|\\text{Re}(\\lambda_{\\max})|$ 通常远比平流 CFL 条件更严格。刚性动力学对显式方法的时间步长 $\\Delta t$ 施加了严重的额外限制。\n**结论：错误。**\n\nE. 显式欧拉法对于刚性溶解-沉淀动力学的不稳定性主要是由舍入误差引起的；如果使用精确算术，即使动力学是刚性的，显式欧拉法对于大的 $\\Delta t$ 也会是稳定的。\n这是错误的。这种不稳定性是算法固有的数学性质，而不是有限精度算术的产物。对放大因子 $|1+\\Delta t\\lambda|$ 的分析表明，对于 $\\Delta t$ 和 $\\lambda$ 的某些组合，其值可以大于 $1$。当这种情况发生时，无论舍入误差如何，数值解都必然会增长。这是截断误差导致离散动力系统不稳定的一个表现。\n**结论：错误。**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "编写复杂的数值代码后，我们如何确保其正确性？“制造解方法”（Method of Manufactured Solutions, MMS）是验证代码实现是否准确的黄金标准。本综合练习  要求您为一个完整的时变对流-扩散-反应（ADR）方程构建一个数值求解器。您将通过MMS推导源项，实现包括上游差分在内的离散格式，并最终通过网格加密研究来计算经验收敛阶，从而验证您的代码是否达到了预期的理论精度。",
            "id": "4079440",
            "problem": "考虑在一个饱和地球化学柱中的一维溶质运移，该过程由平流-扩散-反应 (Advection–Diffusion–Reaction, ADR) 偏微分方程 (Partial Differential Equation, PDE) 建模。设 $u(x,t)$ 表示水相浓度，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，其中空间坐标 $x \\in [0,L]$ 单位为 $\\mathrm{m}$，时间 $t \\in [0,T]$ 单位为 $\\mathrm{s}$。ADR 偏微分方程为\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; k\\,u \\;+\\; s(x,t),\n$$\n其中 $a$ 是平流速度，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$；$D$ 是扩散（水动力弥散）系数，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$；$k$ 是一级反应速率常数，单位为 $\\mathrm{s}^{-1}$；$s(x,t)$ 是代表外部输入的源项，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n\n使用人造解法，定义精确浓度场\n$$\nu_{\\mathrm{m}}(x,t) \\;=\\; \\sin\\!\\big(2\\pi x/L\\big)\\,\\mathrm{e}^{-t} \\;+\\; \\tfrac{1}{2}\\,x\\,(L-x),\n$$\n其中域长度 $L = 1$ $\\mathrm{m}$，最终时间 $T = 0.1$ $\\mathrm{s}$。施加与人造解匹配的狄利克雷边界条件，使得对于所有 $t \\in [0,T]$，有 $u(0,t) = u_{\\mathrm{m}}(0,t)$ 和 $u(L,t) = u_{\\mathrm{m}}(L,t)$；以及初始条件，对于所有 $x \\in [0,L]$，有 $u(x,0) = u_{\\mathrm{m}}(x,0)$。从上述 ADR 定义出发，推导源项 $s(x,t)$，该源项使得 $u_{\\mathrm{m}}(x,t)$ 成为连续 ADR 偏微分方程对于任意常数 $a$、$D$ 和 $k$ 的精确解。\n\n通过具有 $N$ 个内部点（因此包括边界在内共有 $N+2$ 个节点）的均匀网格来离散化空间域，网格间距为 $h = L/(N+1)$。对一阶导数 $\\partial u/\\partial x$ 使用迎风有限差分法，对二阶导数 $\\partial^2 u/\\partial x^2$ 使用二阶中心差分法，对 $\\partial u/\\partial t$ 使用前向欧拉时间积分器。具体来说，对于给定的 $a$ 的符号，使用相应的迎风单边差分。令时间步长 $\\Delta t$ 满足显式稳定性条件，取\n$$\n\\Delta t \\;=\\; 0.4 \\times \\min{\\left(\\frac{h}{|a|}, \\; \\frac{h^2}{2D}, \\; \\frac{1}{k}\\right)},\n$$\n约定在求最小值时，分母为零的项被视为 $+\\infty$。使用在当前时间层上求值的人造源项 $s(x,t)$，通过前向欧拉法从 $t=0$ 积分到 $t=T$，并在每个时间步强制施加来自 $u_{\\mathrm{m}}(x,t)$ 的狄利克雷边界值。到达 $t=T$ 后，计算相对离散 $L^2$ 误差\n$$\nE_h \\;=\\; \\frac{\\left(h \\sum_{i=0}^{N+1} \\big(u_i(T) - u_{\\mathrm{m}}(x_i,T)\\big)^2\\right)^{1/2}}{\\left(h \\sum_{i=0}^{N+1} \\big(u_{\\mathrm{m}}(x_i,T)\\big)^2\\right)^{1/2}},\n$$\n该误差是无量纲的。使用网格加密 $N \\in \\{40, 80, 160\\}$，估算观测到的收敛率\n$$\np \\;=\\; \\frac{\\ln\\big(E_{h_2}/E_{h_3}\\big)}{\\ln\\big(h_2/h_3\\big)},\n$$\n其中 $h_j = L/(N_j+1)$ 且 $N_2=80$，$N_3=160$。\n\n测试集：\n- A组（扩散主导）：$a = 0.05$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-3}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- B组（平流主导，正速度）：$a = 1.0$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- C组（平流主导，负速度）：$a = -1.0$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 0.1$ $\\mathrm{s}^{-1}$。\n- D组（反应主导）：$a = 0.01$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$D = 1.0\\times 10^{-4}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k = 5.0$ $\\mathrm{s}^{-1}$。\n\n您的程序必须：\n- 从 ADR 偏微分方程和 $u_{\\mathrm{m}}(x,t)$ 推导并实现人造源项 $s(x,t)$。\n- 对每组参数 A、B、C 和 D，计算 $N \\in \\{40,80,160\\}$ 时的相对离散 $L^2$ 误差 $E_{h}$，然后使用上述公式计算 $p$。\n- 生成单行输出，其中包含四组参数的观测收敛率，格式为方括号内以逗号分隔的列表，顺序为 A、B、C、D，每个浮点数四舍五入到三位小数，例如 $[p_A,p_B,p_C,p_D]$。\n\n所有输出都是无量纲的，并且必须以浮点数形式报告。不涉及角度。不涉及百分比。",
            "solution": "用户提供的问题是计算科学领域一个适定的练习，具体是使用人造解法进行代码验证，以求得偏微分方程（PDE）的数值解。该问题具有科学依据、内容自洽，并且所有参数和方法都定义清晰。解决此问题，首先需要推导必要的源项，然后基于指定的有限差分格式开发一个数值模型，最后使用该模型计算几种物理情景下的经验收敛率。\n\n### 1. 人造源项的推导\n\n问题由平流-扩散-反应（ADR）方程描述：\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; k\\,u \\;+\\; s(x,t)\n$$\n必须选择源项 $s(x,t)$，使得人造解 $u_{\\mathrm{m}}(x,t)$ 是该 PDE 的一个精确解。我们可以通过重新整理 ADR 方程并代入 $u_{\\mathrm{m}}(x,t)$ 来求得 $s(x,t)$：\n$$\ns(x,t) = \\frac{\\partial u_{\\mathrm{m}}}{\\partial t} + a\\,\\frac{\\partial u_{\\mathrm{m}}}{\\partial x} - D\\,\\frac{\\partial^2 u_{\\mathrm{m}}}{\\partial x^2} + k\\,u_{\\mathrm{m}}\n$$\n给定的人造解为：\n$$\nu_{\\mathrm{m}}(x,t) \\;=\\; \\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} \\;+\\; \\frac{1}{2}\\,x\\,(L-x)\n$$\n为求得 $s(x,t)$，我们首先计算 $u_{\\mathrm{m}}(x,t)$ 的必要偏导数：\n\\begin{itemize}\n    \\item 时间导数：\n    $$\n    \\frac{\\partial u_{\\mathrm{m}}}{\\partial t} = -\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t}\n    $$\n    \\item 空间一阶导数：\n    $$\n    \\frac{\\partial u_{\\mathrm{m}}}{\\partial x} = \\frac{2\\pi}{L}\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{L}{2} - x\n    $$\n    \\item 空间二阶导数：\n    $$\n    \\frac{\\partial^2 u_{\\mathrm{m}}}{\\partial x^2} = -\\left(\\frac{2\\pi}{L}\\right)^2\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} - 1\n    $$\n\\end{itemize}\n将这些表达式代入 $s(x,t)$ 的方程中：\n$$\ns(x,t) = \\left[-\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t}\\right] + a\\left[\\frac{2\\pi}{L}\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{L}{2} - x\\right] - D\\left[-\\left(\\frac{2\\pi}{L}\\right)^2\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} - 1\\right] + k\\left[\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\mathrm{e}^{-t} + \\frac{1}{2}\\,x\\,(L-x)\\right]\n$$\n按 $x$ 和 $t$ 的函数依赖关系对项进行分组：\n$$\ns(x,t) = \\left(k - 1 + D\\left(\\frac{2\\pi}{L}\\right)^2\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\mathrm{e}^{-t} + \\left(\\frac{2\\pi a}{L}\\right)\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\mathrm{e}^{-t} + a\\left(\\frac{L}{2} - x\\right) + D + \\frac{k}{2}x(L-x)\n$$\n这是将在数值模型中实现的源项的解析表达式。\n\n### 2. 数值离散化\n\nPDE 在均匀空间网格 $x_i = i h$（其中 $i \\in \\{0, 1, \\dots, N+1\\}$，$h = L/(N+1)$ 是网格间距）上进行离散化。时间离散为 $t_n = n \\Delta t$。我们将 $u(x_i, t_n)$ 的数值近似记为 $u_i^n$。\n\n指定的数值格式为：\n\\begin{itemize}\n    \\item **时间导数**：前向欧拉法，$\\frac{\\partial u}{\\partial t} \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}$。\n    \\item **扩散项**：二阶中心差分，$\\frac{\\partial^2 u}{\\partial x^2} \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}$。\n    \\item **平流项**：一阶迎风差分。其形式取决于速度 $a$ 的符号：\n    \\begin{itemize}\n        \\item 若 $a \\ge 0$ (向右流动)，使用后向差分：$\\frac{\\partial u}{\\partial x} \\approx \\frac{u_i^n - u_{i-1}^n}{h}$。\n        \\item 若 $a  0$ (向左流动)，使用前向差分：$\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{i+1}^n - u_i^n}{h}$。\n    \\end{itemize}\n\\end{itemize}\n\n将 PDE 重排为 $\\frac{\\partial u}{\\partial t} = \\dots$ 并代入离散近似，得到更新规则 $u_i^{n+1} = u_i^n + \\Delta t (\\dots)$。\n\n对于 $a \\ge 0$：\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left[ D\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} - a\\frac{u_i^n - u_{i-1}^n}{h} - k u_i^n + s(x_i, t_n) \\right]\n$$\n对于 $a  0$：\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left[ D\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} - a\\frac{u_{i+1}^n - u_i^n}{h} - k u_i^n + s(x_i, t_n) \\right]\n$$\n这些方程应用于所有内部网格点 $i \\in \\{1, 2, \\dots, N\\}$。边界值由狄利克雷条件固定：$u_0^{n+1} = u_{\\mathrm{m}}(0, t_{n+1}) = 0$ 和 $u_{N+1}^{n+1} = u_{\\mathrm{m}}(L, t_{n+1}) = 0$。\n\n### 3. 时间步长与收敛性分析\n\n选择时间步长 $\\Delta t$ 以满足前向欧拉格式的显式稳定性条件：\n$$\n\\Delta t \\;=\\; 0.4 \\times \\min{\\left(\\frac{h}{|a|}, \\; \\frac{h^2}{2D}, \\; \\frac{1}{k}\\right)}\n$$\n因子 $0.4$ 是一个安全因子，确保平流和扩散的 Courant–Friedrichs–Lewy (CFL) 条件以及反应项的稳定性条件都得到满足。\n\n模拟从初始条件 $u_i^0 = u_{\\mathrm{m}}(x_i, 0)$ 开始，一直进行到最终时间 $T$。数值解 $u_i(T)$ 的精度由相对离散 $L^2$ 误差量化：\n$$\nE_h \\;=\\; \\frac{\\left(h \\sum_{i=0}^{N+1} \\big(u_i(T) - u_{\\mathrm{m}}(x_i,T)\\big)^2\\right)^{1/2}}{\\left(h \\sum_{i=0}^{N+1} \\big(u_{\\mathrm{m}}(x_i,T)\\big)^2\\right)^{1/2}}\n$$\n观测到的收敛阶 $p$ 通过计算两种不同网格分辨率 $h_2$（对应 $N_2=80$）和 $h_3$（对应 $N_3=160$）下的误差来估算：\n$$\np \\;=\\; \\frac{\\ln\\big(E_{h_2}/E_{h_3}\\big)}{\\ln\\big(h_2/h_3\\big)}\n$$\n数值格式对时间积分（前向欧拉法）和平流（迎风法）采用一阶方法，对扩散采用二阶方法。总体精度受最低阶项的限制，因此理论收敛率预期为 $p \\approx 1$。\n\n### 4. 实现\n\n该算法使用 Python 的 `numpy` 库实现，以进行高效的向量化操作。定义一个函数，用于对给定的参数集 $(a, D, k)$ 和网格大小 $N$ 运行模拟。该函数初始化网格和解向量，计算稳定的时间步长，并在一个时间循环中迭代更新解。在循环内部，源项在当前时间求值，并根据 $a$ 的符号选择合适的迎风格式。达到最终时间 $T$ 后，函数计算并返回相对 $L^2$ 误差。脚本的主体部分遍历四个测试集，对 $N=80$ 和 $N=160$ 调用模拟函数，为每个测试集计算收敛率 $p$，并以指定格式打印结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the observed convergence rates for the ADR equation\n    solution for four different parameter sets.\n    \"\"\"\n\n    def u_manufactured(x: np.ndarray, t: float, L: float) -> np.ndarray:\n        \"\"\"\n        Calculates the manufactured solution u_m(x, t).\n        \"\"\"\n        term1 = np.sin(2 * np.pi * x / L) * np.exp(-t)\n        term2 = 0.5 * x * (L - x)\n        return term1 + term2\n\n    def source_manufactured(x: np.ndarray, t: float, a: float, D: float, k: float, L: float) -> np.ndarray:\n        \"\"\"\n        Calculates the manufactured source term s(x, t).\n        \"\"\"\n        pi_term = 2 * np.pi / L\n        exp_t = np.exp(-t)\n        \n        sin_term = np.sin(pi_term * x)\n        cos_term = np.cos(pi_term * x)\n        \n        # Grouping terms as derived in the solution\n        term1 = (k - 1 + D * pi_term**2) * sin_term * exp_t\n        term2 = a * pi_term * cos_term * exp_t\n        term3 = a * (L/2 - x)\n        term4 = D\n        term5 = k * 0.5 * x * (L - x)\n\n        return term1 + term2 + term3 + term4 + term5\n\n    def run_simulation(N: int, a: float, D: float, k: float, L: float, T: float) -> float:\n        \"\"\"\n        Runs one simulation for a given grid size and parameter set.\n        \n        Returns:\n            The relative discrete L2 error.\n        \"\"\"\n        # Grid setup\n        h = L / (N + 1)\n        x = np.linspace(0, L, N + 2)\n\n        # Time step calculation based on stability criteria\n        # Handle cases where denominators might be zero\n        dt_adv = h / abs(a) if a != 0 else np.inf\n        dt_diff = h**2 / (2 * D) if D != 0 else np.inf\n        dt_react = 1 / k if k != 0 else np.inf\n        \n        dt = 0.4 * min(dt_adv, dt_diff, dt_react)\n        \n        num_steps = int(np.ceil(T / dt))\n        dt = T / num_steps  # Adjust dt to hit T exactly\n\n        # Initial condition\n        u = u_manufactured(x, 0, L)\n        \n        # Time-stepping loop\n        t = 0\n        for n in range(num_steps):\n            t = n * dt\n            u_n = u.copy()\n            \n            # Evaluate source term for interior points at current time t\n            s = source_manufactured(x[1:-1], t, a, D, k, L)\n\n            # Slicing for vectorized update\n            u_interior = u_n[1:-1]\n            u_left = u_n[0:-2]\n            u_right = u_n[2:]\n\n            # Diffusion and reaction terms\n            diffusion_term = D * (u_left - 2 * u_interior + u_right) / h**2\n            reaction_term = -k * u_interior\n\n            # Advection term (upwinding)\n            if a >= 0:\n                advection_term = -a * (u_interior - u_left) / h\n            else: # a  0\n                advection_term = -a * (u_right - u_interior) / h\n\n            # Update interior points\n            u[1:-1] = u_interior + dt * (diffusion_term + advection_term + reaction_term + s)\n\n            # Boundary conditions for the next step (t + dt) are u_m(0, t+dt) and u_m(L, t+dt)\n            # which are both 0 for all t.\n            u[0] = u_manufactured(x[0], t + dt, L)\n            u[-1] = u_manufactured(x[-1], t + dt, L)\n\n        # Final time reached\n        t_final = T\n        u_exact_T = u_manufactured(x, t_final, L)\n\n        # Compute relative discrete L2 error\n        err_numerator_sq = h * np.sum((u - u_exact_T)**2)\n        err_denominator_sq = h * np.sum(u_exact_T**2)\n        \n        if err_denominator_sq == 0:\n            return 0.0 if err_numerator_sq == 0 else np.inf\n            \n        error = np.sqrt(err_numerator_sq) / np.sqrt(err_denominator_sq)\n        \n        return error\n\n    def calculate_convergence_rate(params: tuple) -> float:\n        \"\"\"\n        Calculates the convergence rate for a given parameter set.\n        \"\"\"\n        a, D, k = params\n        L, T = 1.0, 0.1\n        N_vals = {'N2': 80, 'N3': 160}\n\n        h2 = L / (N_vals['N2'] + 1)\n        h3 = L / (N_vals['N3'] + 1)\n        \n        E_h2 = run_simulation(N_vals['N2'], a, D, k, L, T)\n        E_h3 = run_simulation(N_vals['N3'], a, D, k, L, T)\n        \n        # Handle cases where error might be zero\n        if E_h2 == 0 or E_h3 == 0:\n            return np.nan # Or some other indicator of non-standard convergence\n            \n        p = np.log(E_h2 / E_h3) / np.log(h2 / h3)\n        return p\n\n    # Test suite from the problem statement\n    test_cases = [\n        (0.05, 1.0e-3, 0.1),    # Set A: diffusion-dominated\n        (1.0, 1.0e-4, 0.1),     # Set B: advection-dominated, positive a\n        (-1.0, 1.0e-4, 0.1),    # Set C: advection-dominated, negative a\n        (0.01, 1.0e-4, 5.0),    # Set D: reaction-dominated\n    ]\n\n    results = []\n    for case in test_cases:\n        p = calculate_convergence_rate(case)\n        results.append(p)\n\n    # Format output as specified: [p_A,p_B,p_C,p_D] rounded to 3 decimal places.\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}