{
    "hands_on_practices": [
        {
            "introduction": "在任何水化学分析中，电中性原理都是一个基本且不可或缺的检验标准。该原理指出，在宏观尺度上，溶液中所有阳离子所带正电荷的总和必须等于所有阴离子所带负电荷的总和。这个练习  将引导你完成一项核心计算：通过计算给定水样中所有离子的电荷平衡残差，来定量评估其分析数据的准确性。",
            "id": "4072190",
            "problem": "一个在恒温下充分混合的水溶液包含以下溶解物质及其形式电荷和摩尔浓度：$\\{(\\text{Na}^+,\\,0.010),\\,(\\text{Cl}^-,\\,0.0098),\\,(\\text{HCO}_3^-,\\,2\\times 10^{-4}),\\,(\\text{Ca}^{2+},\\,1\\times 10^{-3}),\\,(\\text{OH}^-,\\,1\\times 10^{-7}),\\,(\\text{H}^+,\\,1\\times 10^{-7})\\}$，其中每个数字是摩尔浓度，单位为 $\\text{mol L}^{-1}$。在计算地球化学中，宏观电中性原理断言，溶液中的总摩尔电荷应在数值容差范围内为零。该总摩尔电荷通过将每种物质的摩尔浓度乘以其整数电荷的符号和大小后求和得到。利用此原理以及价态为 $z$ 的离子的当量浓度定义为其电荷大小与摩尔浓度的乘积，计算净电荷平衡残差，单位为 $\\text{eq L}^{-1}$。净电荷平衡残差定义为所有列出离子的当量浓度的代数和。然后，根据您计算出的残差，判断在 $10^{-4}$ $\\text{eq L}^{-1}$ 的容差范围内，电中性是否得到满足。将残差四舍五入至四位有效数字，并以 $\\text{eq L}^{-1}$ 为单位表示。",
            "solution": "该问题要求计算给定水溶液的净电荷平衡残差，并确定宏观电中性条件是否在指定的容差范围内得到满足。这是计算地球化学中用于验证水质分析质量的标准程序。\n\n首先，我们必须陈述其基本原理。电中性原理断言，对于任何宏观体积的电解质溶液，正电荷的摩尔浓度之和必须等于负电荷的摩尔浓度之和。我们用 $R_{cb}$ 表示的净电荷平衡残差，是这一原理的定量表达。它被定义为每种溶解物质 $i$ 的摩尔浓度 $M_i$ 乘以其整数电荷（价态）$z_i$ 后的代数和。\n\n电荷平衡残差的公式为：\n$$R_{cb} = \\sum_{i} z_i M_i$$\n$R_{cb}$ 的单位通常是当量/升，即 $\\text{eq L}^{-1}$。$R_{cb} = 0$ 的值表示完美的电荷平衡。\n\n问题提供了以下物质及其形式电荷和摩尔浓度：\n- 阳离子（带正电的离子）：\n  - $\\text{Na}^+$: $z_{\\text{Na}^+} = +1$, $M_{\\text{Na}^+} = 0.010 \\, \\text{mol L}^{-1}$\n  - $\\text{Ca}^{2+}$: $z_{\\text{Ca}^{2+}} = +2$, $M_{\\text{Ca}^{2+}} = 1 \\times 10^{-3} \\, \\text{mol L}^{-1} = 0.001 \\, \\text{mol L}^{-1}$\n  - $\\text{H}^+$: $z_{\\text{H}^+} = +1$, $M_{\\text{H}^+} = 1 \\times 10^{-7} \\, \\text{mol L}^{-1}$\n- 阴离子（带负电的离子）：\n  - $\\text{Cl}^-$: $z_{\\text{Cl}^-} = -1$, $M_{\\text{Cl}^-} = 0.0098 \\, \\text{mol L}^{-1}$\n  - $\\text{HCO}_3^-$: $z_{\\text{HCO}_3^-} = -1$, $M_{\\text{HCO}_3^-} = 2 \\times 10^{-4} \\, \\text{mol L}^{-1} = 0.0002 \\, \\text{mol L}^{-1}$\n  - $\\text{OH}^-$: $z_{\\text{OH}^-} = -1$, $M_{\\text{OH}^-} = 1 \\times 10^{-7} \\, \\text{mol L}^{-1}$\n\n我们可以分别计算正电荷当量之和与负电荷当量之和。问题将价态为 $z$、摩尔浓度为 $M$ 的离子的当量浓度定义为 $|z|M$。\n\n正当量之和，$\\sum C_{\\text{cations}}$，为：\n$$\\sum C_{\\text{cations}} = |z_{\\text{Na}^+}|M_{\\text{Na}^+} + |z_{\\text{Ca}^{2+}}|M_{\\text{Ca}^{2+}} + |z_{\\text{H}^+}|M_{\\text{H}^+}$$\n$$\\sum C_{\\text{cations}} = (1)(0.010) + (2)(0.001) + (1)(1 \\times 10^{-7})$$\n$$\\sum C_{\\text{cations}} = 0.010 + 0.002 + 0.0000001 = 0.0120001 \\, \\text{eq L}^{-1}$$\n\n负当量之和，$\\sum C_{\\text{anions}}$，为：\n$$\\sum C_{\\text{anions}} = |z_{\\text{Cl}^-}|M_{\\text{Cl}^-} + |z_{\\text{HCO}_3^-}|M_{\\text{HCO}_3^-} + |z_{\\text{OH}^-}|M_{\\text{OH}^-}$$\n$$\\sum C_{\\text{anions}} = (1)(0.0098) + (1)(0.0002) + (1)(1 \\times 10^{-7})$$\n$$\\sum C_{\\text{anions}} = 0.0098 + 0.0002 + 0.0000001 = 0.0100001 \\, \\text{eq L}^{-1}$$\n\n净电荷平衡残差 $R_{cb}$ 是正当量之和与负当量之和的差值：\n$$R_{cb} = \\sum C_{\\text{cations}} - \\sum C_{\\text{anions}}$$\n$$R_{cb} = 0.0120001 - 0.0100001 = 0.002 \\, \\text{eq L}^{-1}$$\n\n问题要求将结果四舍五入至四位有效数字。精确结果为 $0.002$。为了用四位有效数字表示，我们写作：\n$$R_{cb} = 0.002000 \\, \\text{eq L}^{-1}$$\n用科学记数法表示，即为 $2.000 \\times 10^{-3} \\, \\text{eq L}^{-1}$。\n\n任务的第二部分是确定在 $10^{-4} \\, \\text{eq L}^{-1}$ 的容差范围内，电中性是否得到满足。这需要检查残差的绝对值是否小于或等于指定的容差。\n$$\\text{Tolerance} = 10^{-4} \\, \\text{eq L}^{-1} = 0.0001 \\, \\text{eq L}^{-1}$$\n我们必须检查是否 $|R_{cb}| \\le 0.0001$。\n$$|0.002000| \\le 0.0001$$\n$$0.002000 \\le 0.0001$$\n这个不等式显然不成立。由于计算出的残差 $0.002000 \\, \\text{eq L}^{-1}$ 大于容差 $0.0001 \\, \\text{eq L}^{-1}$，因此在该给定的容差范围内，此溶液分析不满足电中性条件。",
            "answer": "$$\\boxed{2.000 \\times 10^{-3}}$$"
        },
        {
            "introduction": "电荷平衡约束不仅是验证数据质量的工具，更是一种强大的求解手段。在地球化学实践中，我们常常利用它来确定那些难以直接测量的组分的浓度。这个练习  将带你进入高盐度卤水这一更复杂的场景，应用电荷平衡原理求解氯离子的未知浓度，并深入探讨在非理想体系中区分和转换质量摩尔浓度 ($m_i$) 与物质的量浓度 ($c_i$) 的重要性。",
            "id": "4072167",
            "problem": "一种在 $60\\,^\\circ\\text{C}$ 的高盐度盐水含有以下溶解离子，其质量摩尔浓度（每千克溶剂的摩尔数）如下：钠离子 $\\mathrm{Na}^+$ 为 $5.2$，钾离子 $\\mathrm{K}^+$ 为 $0.3$，钙离子 $\\mathrm{Ca}^{2+}$ 为 $0.6$，镁离子 $\\mathrm{Mg}^{2+}$ 为 $0.4$，硫酸根离子 $\\mathrm{SO}_4^{2-}$ 为 $0.2$，溴离子 $\\mathrm{Br}^-$ 为 $0.05$。氯离子 $\\mathrm{Cl}^-$ 的质量摩尔浓度未知，必须通过电中性（电荷平衡）来确定。在 $60\\,^\\circ\\text{C}$ 下测得的盐水密度为 $\\rho = 1.22\\,\\text{kg L}^{-1}$。所用的原子或离子摩尔质量（单位为 $\\text{kg mol}^{-1}$）为：$\\mathrm{Na}^+$ ($0.0229898$)、$\\mathrm{K}^+$ ($0.039098$)、$\\mathrm{Ca}^{2+}$ ($0.040078$)、$\\mathrm{Mg}^{2+}$ ($0.024305$)、$\\mathrm{Cl}^-$ ($0.03545$)、$\\mathrm{Br}^-$ ($0.079904$) 和 $\\mathrm{SO}_4^{2-}$ ($0.09606$)。\n\n从质量摩尔浓度、物质的量浓度、电中性（正电荷总和等于负电荷总和）和离子强度的基本定义出发，完成以下任务：\n\n- 在质量摩尔浓度的基础上，使用电荷平衡约束计算氯离子 $\\mathrm{Cl}^-$ 的质量摩尔浓度。\n- 使用定义 $I_m = \\frac{1}{2}\\sum_i m_i z_i^2$ 计算基于质量摩尔浓度的离子强度 $I_m$，其中 $m_i$ 是质量摩尔浓度，$z_i$ 是离子电荷。\n- 根据质量守恒和密度，推导每个离子从质量摩尔浓度 $m_i$ 到物质的量浓度 $c_i$ 的转换因子，表示为 $c_i = m_i \\,\\frac{\\rho}{1 + \\sum_j m_j M_j}$，其中 $M_j$ 是物质 $j$ 的摩尔质量，$\\sum_j m_j M_j$ 是每千克溶剂的总溶质质量。使用此公式，根据给定的 $\\rho$ 计算基于物质的量浓度的离子强度 $I_c = \\frac{1}{2}\\sum_i c_i z_i^2$。\n- 然后，通过设置 $\\rho = 1.00\\,\\text{kg L}^{-1}$（同时保持溶质质量项 $\\sum_j m_j M_j$ 不变）来量化忽略密度变化在 $I_c$ 计算中引入的误差。将相对误差定义为 $\\epsilon = \\frac{|I_c^{(\\rho=1.00)} - I_c^{(\\rho=\\mathrm{actual})}|}{I_c^{(\\rho=\\mathrm{actual})}}$。\n\n将 $\\epsilon$ 的最终答案表示为无量纲小数，并四舍五入到四位有效数字。",
            "solution": "该问题经检验在科学上是合理的、提法得当且客观的。它展示了一系列基于物理化学和地球化学基本原理的计算。所有需要的数据和定义均已提供。\n\n解决方案按照问题陈述中概述的四个主要步骤进行：\n1.  通过电中性约束确定氯离子的质量摩尔浓度 $m_{\\mathrm{Cl}^-}$。\n2.  计算基于质量摩尔浓度的离子强度 $I_m$。\n3.  推导质量摩尔浓度到物质的量浓度的转换因子，并计算在实际密度和近似密度下基于物质的量浓度的离子强度 $I_c$。\n4.  计算相对误差 $\\epsilon$。\n\n**步骤 1：计算氯离子的质量摩尔浓度 ($m_{\\mathrm{Cl}^-}$) **\n电中性原理要求溶液中的总正电荷必须与总负电荷相平衡。在质量摩尔浓度的基础上，这表示为 $\\sum_i m_i z_i = 0$，其中 $m_i$ 是离子 $i$ 的质量摩尔浓度，$z_i$ 是其电荷数。\n\n存在的离子有 $\\mathrm{Na}^+$ ($z=+1$)、$\\mathrm{K}^+$ ($z=+1$)、$\\mathrm{Ca}^{2+}$ ($z=+2$)、$\\mathrm{Mg}^{2+}$ ($z=+2$)、$\\mathrm{SO}_4^{2-}$ ($z=-2$)、$\\mathrm{Br}^-$ ($z=-1$) 和未知的 $\\mathrm{Cl}^-$ ($z=-1$)。\n\n电荷平衡方程为：\n$$m_{\\mathrm{Na}^+} (+1) + m_{\\mathrm{K}^+} (+1) + m_{\\mathrm{Ca}^{2+}} (+2) + m_{\\mathrm{Mg}^{2+}} (+2) + m_{\\mathrm{Br}^-} (-1) + m_{\\mathrm{SO}_4^{2-}} (-2) + m_{\\mathrm{Cl}^-} (-1) = 0$$\n\n让我们将正负电荷分开：\n$$\\sum m_{\\text{cations}} z_{\\text{cations}} = \\sum m_{\\text{anions}} |z_{\\text{anions}}|$$\n$$m_{\\mathrm{Na}^+} (1) + m_{\\mathrm{K}^+} (1) + m_{\\mathrm{Ca}^{2+}} (2) + m_{\\mathrm{Mg}^{2+}} (2) = m_{\\mathrm{Br}^-} (1) + m_{\\mathrm{SO}_4^{2-}} (2) + m_{\\mathrm{Cl}^-} (1)$$\n\n代入给定的质量摩尔浓度（单位为 $\\text{mol kg}^{-1}$）：\n$$(5.2)(1) + (0.3)(1) + (0.6)(2) + (0.4)(2) = (0.05)(1) + (0.2)(2) + m_{\\mathrm{Cl}^-}$$\n$$5.2 + 0.3 + 1.2 + 0.8 = 0.05 + 0.4 + m_{\\mathrm{Cl}^-}$$\n$$7.5 = 0.45 + m_{\\mathrm{Cl}^-}$$\n解出 $m_{\\mathrm{Cl}^-}$：\n$$m_{\\mathrm{Cl}^-} = 7.5 - 0.45 = 7.05\\,\\text{mol kg}^{-1}$$\n\n**步骤 2：计算基于质量摩尔浓度的离子强度 ($I_m$) **\n基于质量摩尔浓度的离子强度 $I_m$ 定义为：\n$$I_m = \\frac{1}{2} \\sum_i m_i z_i^2$$\n我们对所有离子求和，包括我们刚刚计算出的氯离子：\n$$I_m = \\frac{1}{2} \\left( m_{\\mathrm{Na}^+} (1)^2 + m_{\\mathrm{K}^+} (1)^2 + m_{\\mathrm{Ca}^{2+}} (2)^2 + m_{\\mathrm{Mg}^{2+}} (2)^2 + m_{\\mathrm{Br}^-} (-1)^2 + m_{\\mathrm{SO}_4^{2-}} (-2)^2 + m_{\\mathrm{Cl}^-} (-1)^2 \\right)$$\n代入质量摩尔浓度：\n$$I_m = \\frac{1}{2} \\left[ (5.2)(1) + (0.3)(1) + (0.6)(4) + (0.4)(4) + (0.05)(1) + (0.2)(4) + (7.05)(1) \\right]$$\n$$I_m = \\frac{1}{2} (5.2 + 0.3 + 2.4 + 1.6 + 0.05 + 0.8 + 7.05)$$\n$$I_m = \\frac{1}{2} (17.4) = 8.7\\,\\text{mol kg}^{-1}$$\n\n**步骤 3：推导转换因子并计算基于物质的量浓度的离子强度 ($I_c$) **\n首先，我们推导从质量摩尔浓度 ($m_i$) 到物质的量浓度 ($c_i$) 的转换因子。物质的量浓度为 $c_i = n_i / V_{\\text{solution}}$，质量摩尔浓度为 $m_i = n_i / M_{\\text{solvent}}$。\n以 $1\\,\\mathrm{kg}$ 溶剂为基准，$M_{\\text{solvent}} = 1\\,\\mathrm{kg}$。任何溶质 $j$ 的摩尔数为 $n_j = m_j$。溶质 $j$ 的质量为 $m_j M_j$，其中 $M_j$ 是其摩尔质量，单位为 $\\text{kg mol}^{-1}$。\n溶液的总质量是溶剂质量加上所有溶质质量的总和：\n$$M_{\\text{solution}} = M_{\\text{solvent}} + \\sum_j m_j M_j = 1 + \\sum_j m_j M_j$$\n溶液的体积为 $V_{\\text{solution}} = M_{\\text{solution}} / \\rho = (1 + \\sum_j m_j M_j) / \\rho$。\n因此，对于 $n_i=m_i$（在我们的 $1\\,\\mathrm{kg}$ 溶剂基准上），物质的量浓度为：\n$$c_i = \\frac{n_i}{V_{\\text{solution}}} = \\frac{m_i}{(1 + \\sum_j m_j M_j) / \\rho} = m_i \\frac{\\rho}{1 + \\sum_j m_j M_j}$$\n这证实了问题中给出的表达式。\n\n接下来，我们计算每千克溶剂的溶质质量总和 $\\sum_j m_j M_j$：\n物质种类有 $\\mathrm{Na}^+$, $\\mathrm{K}^+$, $\\mathrm{Ca}^{2+}$, $\\mathrm{Mg}^{2+}$, $\\mathrm{Cl}^-$, $\\mathrm{Br}^-$, 和 $\\mathrm{SO}_4^{2-}$。\n$$ \\sum_j m_j M_j = (5.2)(0.0229898) + (0.3)(0.039098) + (0.6)(0.040078) + (0.4)(0.024305) + (7.05)(0.03545) + (0.05)(0.079904) + (0.2)(0.09606) $$\n$$ \\sum_j m_j M_j = 0.11954696 + 0.0117294 + 0.0240468 + 0.009722 + 0.2500225 + 0.0039952 + 0.019212 = 0.43827486\\,\\mathrm{kg} $$\n设这个总和用 $S_{m,M} = 0.43827486$ 表示。\n\n基于物质的量浓度的离子强度为 $I_c = \\frac{1}{2} \\sum_i c_i z_i^2$。代入 $c_i$ 的表达式：\n$$I_c = \\frac{1}{2} \\sum_i \\left(m_i \\frac{\\rho}{1 + S_{m,M}}\\right) z_i^2 = \\left( \\frac{\\rho}{1 + S_{m,M}} \\right) \\left( \\frac{1}{2} \\sum_i m_i z_i^2 \\right) = I_m \\frac{\\rho}{1 + S_{m,M}}$$\n\n使用实际密度 $\\rho_{\\mathrm{actual}} = 1.22\\,\\text{kg L}^{-1}$：\n$$ I_c^{(\\rho=\\mathrm{actual})} = (8.7) \\frac{1.22}{1 + 0.43827486} = (8.7) \\frac{1.22}{1.43827486} \\approx 7.37973\\,\\text{mol L}^{-1} $$\n\n按照指示，使用近似密度 $\\rho=1.00\\,\\text{kg L}^{-1}$，同时保持 $S_{m,M}$ 不变：\n$$ I_c^{(\\rho=1.00)} = (8.7) \\frac{1.00}{1 + 0.43827486} = (8.7) \\frac{1.00}{1.43827486} \\approx 6.04896\\,\\text{mol L}^{-1} $$\n\n**步骤 4：量化相对误差 ($\\epsilon$) **\n相对误差 $\\epsilon$ 定义为：\n$$ \\epsilon = \\frac{|I_c^{(\\rho=1.00)} - I_c^{(\\rho=\\mathrm{actual})}|}{I_c^{(\\rho=\\mathrm{actual})}} $$\n代入 $I_c$ 的表达式：\n$$ \\epsilon = \\frac{\\left| I_m \\frac{1.00}{1 + S_{m,M}} - I_m \\frac{1.22}{1 + S_{m,M}} \\right|}{I_m \\frac{1.22}{1 + S_{m,M}}} $$\n分子和分母中的项 $I_m / (1 + S_{m,M})$ 可以消掉：\n$$ \\epsilon = \\frac{|1.00 - 1.22|}{1.22} = \\frac{|-0.22|}{1.22} = \\frac{0.22}{1.22} $$\n$$ \\epsilon = \\frac{11}{61} \\approx 0.1803278688... $$\n四舍五入到四位有效数字，相对误差为 $0.1803$。",
            "answer": "$$\\boxed{0.1803}$$"
        },
        {
            "introduction": "在构建地球化学计算模型时，我们首先要将质量和电荷守恒定律转化为一个线性方程组 $A \\mathbf{n} = \\mathbf{b}$，其中 $A$ 是组分矩阵。这个矩阵的数学性质直接决定了模型求解的稳定性和可靠性。本练习  介绍了一种强大的诊断工具——奇异值分解（Singular Value Decomposition, SVD），用于分析组分矩阵的内在结构，识别化学组分间的近似或精确线性相关性，从而预判并解决潜在的数值计算问题。",
            "id": "4072186",
            "problem": "您的任务是在质量守恒和电荷守恒的约束下，构建和分析含盐水溶液的成分矩阵。设成分矩阵表示为 $A \\in \\mathbb{R}^{m \\times n}$，其中每一列对应一种化学物质，每一行对应一个守恒量（每种化学元素和电荷）。条目 $a_{ij}$ 是物质 $j$ 中守恒量 $i$ 的化学计量数，表示为每摩尔物质中无量纲的整数或有理数摩尔数。电荷由一个专门行中的无量纲整数电荷数表示。控制质量和电荷平衡的方程为 $A \\, \\mathbf{n} = \\mathbf{b}$，其中 $\\mathbf{n} \\in \\mathbb{R}^n$ 是各物质摩尔量的向量，$\\mathbf{b} \\in \\mathbb{R}^m$ 是总守恒量的向量（对于元素是摩尔数，对于电荷行是电荷数）。这里的分析侧重于 $A$ 本身的数值特性，与 $\\mathbf{b}$ 无关。\n\n您的程序必须对每个测试矩阵 $A$ 执行奇异值分解（Singular Value Decomposition (SVD)）分析，计算有序的奇异值 $\\sigma_1 \\geq \\sigma_2 \\geq \\dots \\geq \\sigma_r \\geq 0$（其中 $r = \\min(m,n)$），并根据物质成分向量的近似相关性和质量电荷平衡方程的数值条件来解释较小的奇异值。作为参考，正交三角分解（QR）是另一种诊断秩和条件数的有效方法，但在此任务中，您必须使用奇异值分解（SVD）。\n\n定义和要实现的任务：\n- 设最大奇异值为 $\\sigma_{\\max} = \\sigma_1$。\n- 给定一个容差 $\\tau > 0$，将有效秩定义为满足 $\\sigma_i \\geq \\tau \\, \\sigma_{\\max}$ 的奇异值的数量。\n- 将近似相关性计数定义为满足 $\\sigma_i \\leq \\tau \\, \\sigma_{\\max}$ 的奇异值的数量。\n- 将条件数代理 $\\kappa_{\\tau}(A)$ 定义为 $\\sigma_{\\max}$ 除以被认为高于容差的奇异值中的最小值，即 $\\kappa_{\\tau}(A) = \\sigma_{\\max} / \\min\\{\\sigma_i \\mid \\sigma_i \\geq \\tau \\, \\sigma_{\\max}\\}$；如果没有奇异值满足该阈值（当 $\\sigma_{\\max} > 0$ 且 $\\tau \\leq 1$ 时不会发生），则返回 $+\\infty$。\n\n解释要求：较小的奇异值表示 $A$ 中的某些物质成分列是其他列的近似线性组合，这意味着组分之间存在近似相关性，并且相关的质量电荷平衡方程存在数值病态问题。奇异谱中的精确零值揭示了精确的线性相关性和秩亏。\n\n测试套件。使用以下三个科学上合理的矩阵和容差：\n- 测试用例 1（良态，独立成分）。行序为 $[\\mathrm{Na}, \\mathrm{Cl}, \\mathrm{Ca}, \\mathrm{S}, \\mathrm{C}, \\mathrm{O}, \\mathrm{H}, q]$，其中 $q$ 表示电荷。列（物质）为 $[\\mathrm{Na}^+, \\mathrm{Cl}^-, \\mathrm{Ca}^{2+}, \\mathrm{SO}_4^{2-}, \\mathrm{HCO}_3^{-}, \\mathrm{CO}_3^{2-}, \\mathrm{H}_2\\mathrm{O}]$。列的化学计量如下：\n  - $\\mathrm{Na}^+$: $[1, 0, 0, 0, 0, 0, 0, +1]$\n  - $\\mathrm{Cl}^-$: $[0, 1, 0, 0, 0, 0, 0, -1]$\n  - $\\mathrm{Ca}^{2+}$: $[0, 0, 1, 0, 0, 0, 0, +2]$\n  - $\\mathrm{SO}_4^{2-}$: $[0, 0, 0, 1, 0, 4, 0, -2]$\n  - $\\mathrm{HCO}_3^{-}$: $[0, 0, 0, 0, 1, 3, 1, -1]$\n  - $\\mathrm{CO}_3^{2-}$: $[0, 0, 0, 0, 1, 3, 0, -2]$\n  - $\\mathrm{H}_2\\mathrm{O}$: $[0, 0, 0, 0, 0, 1, 2, 0]$\n  使用 $\\tau = 10^{-12}$。\n- 测试用例 2（由于水合中性对导致的近似相关性）。行序为 $[\\mathrm{Na}, \\mathrm{Cl}, \\mathrm{O}, \\mathrm{H}, q]$。列（物质）为 $[\\mathrm{Na}^+, \\mathrm{Cl}^-, \\mathrm{NaCl}^0(\\mathrm{aq}), \\mathrm{H}_2\\mathrm{O}]$，其中水合作用由水对中性对的微小贡献表示。设 $\\varepsilon = 10^{-8}$。列的化学计量如下：\n  - $\\mathrm{Na}^+$: $[1, 0, 0, 0, +1]$\n  - $\\mathrm{Cl}^-$: $[0, 1, 0, 0, -1]$\n  - $\\mathrm{NaCl}^0(\\mathrm{aq})$: $[1, 1, \\varepsilon, 2\\varepsilon, 0]$\n  - $\\mathrm{H}_2\\mathrm{O}$: $[0, 0, 1, 2, 0]$\n  使用 $\\tau = 10^{-8}$。\n- 测试用例 3（由于水的自电离导致的精确相关性）。行序为 $[\\mathrm{H}, \\mathrm{O}, \\mathrm{Na}, \\mathrm{Cl}, q]$。列（物质）为 $[\\mathrm{H}^+, \\mathrm{OH}^-, \\mathrm{H}_2\\mathrm{O}, \\mathrm{Na}^+, \\mathrm{Cl}^-]$。列的化学计量如下：\n  - $\\mathrm{H}^+$: $[1, 0, 0, 0, +1]$\n  - $\\mathrm{OH}^-$: $[1, 1, 0, 0, -1]$\n  - $\\mathrm{H}_2\\mathrm{O}$: $[2, 1, 0, 0, 0]$\n  - $\\mathrm{Na}^+$: $[0, 0, 1, 0, +1]$\n  - $\\mathrm{Cl}^-$: $[0, 0, 0, 1, -1]$\n  注意，$\\mathrm{H}_2\\mathrm{O}$ 精确地是 $\\mathrm{H}^+$ 和 $\\mathrm{OH}^-$ 的和。使用 $\\tau = 10^{-12}$。\n\n输出规范。对于每个测试用例，程序必须返回一个列表 $[\\text{rank}, \\kappa_{\\tau}(A), \\text{near}]$，其中 $\\text{rank}$ 是有效秩（一个整数），$\\kappa_{\\tau}(A)$ 是条件数代理（一个浮点数，可能为 $+\\infty$），$\\text{near}$ 是近似相关性的数量（一个整数）。您的程序应生成单行输出，其中包含三个测试用例的结果，形式为逗号分隔的每个用例的列表，并用方括号括起来，例如 $[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot]]$。不需要进行物理单位转换，因为所有化学计量系数和电荷都是每摩尔物质的无量纲计数。",
            "solution": "问题陈述是有效的。它在科学上基于化学计量学以及质量/电荷平衡的原理，这些是地球化学的基础。该问题是适定的，提供了使用奇异值分解（SVD）执行所需数值分析的所有必要数据、定义和约束。定义是精确的，测试用例是水溶液体系的科学上合理的表示，旨在测试良态、近似相关和精确相关的场景。\n\n总体目标是分析代表质量和电荷平衡的线性系统 $A \\mathbf{n} = \\mathbf{b}$ 的数值条件，其中 $A$ 是一个成分矩阵。$A$ 的性质，特别是其奇异值，揭示了潜在的数值不稳定性。较小的奇异值表示某些物质的成分向量（$A$ 的列）是其他向量的近似线性组合。这会导致一个病态或秩亏的矩阵，在这种情况下，求解物质的量 $\\mathbf{n}$ 对总数量向量 $\\mathbf{b}$ 的微小误差或变化高度敏感。\n\n每个测试用例的分析过程如下：\n$1$. 构建成分矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其中 $m$ 代表守恒量的数量，$n$ 是化学物质的数量。\n$2$. 计算 $A$ 的 SVD 以获得其奇异值 $\\sigma_1 \\geq \\sigma_2 \\geq \\dots \\geq \\sigma_r \\geq 0$，其中 $r = \\min(m, n)$。\n$3$. 基于奇异值和给定的容差 $\\tau$ 计算以下指标：\n    - 最大奇异值为 $\\sigma_{\\max} = \\sigma_1$。\n    - 定义一个显著性阈值 $\\sigma_{\\text{threshold}} = \\tau \\cdot \\sigma_{\\max}$。\n    - 有效秩是奇异值 $\\sigma_i$ 中满足 $\\sigma_i \\geq \\sigma_{\\text{threshold}}$ 的数量。\n    - 近似相关性的数量是奇异值 $\\sigma_i$ 中满足 $\\sigma_i \\leq \\sigma_{\\text{threshold}}$ 的数量。\n    - 条件数代理为 $\\kappa_{\\tau}(A) = \\sigma_{\\max} / \\min\\{\\sigma_i \\mid \\sigma_i \\geq \\sigma_{\\text{threshold}}\\}$。\n\n**测试用例 1：良态系统**\n该用例涉及 $m=8$ 个守恒量 ($[\\mathrm{Na}, \\mathrm{Cl}, \\mathrm{Ca}, \\mathrm{S}, \\mathrm{C}, \\mathrm{O}, \\mathrm{H}, q]$) 和 $n=7$ 种物质 ($[\\mathrm{Na}^+, \\mathrm{Cl}^-, \\mathrm{Ca}^{2+}, \\mathrm{SO}_4^{2-}, \\mathrm{HCO}_3^{-}, \\mathrm{CO}_3^{2-}, \\mathrm{H}_2\\mathrm{O}]$)。$8 \\times 7$ 的成分矩阵 $A_1$ 为：\n$$\nA_1 = \\begin{pmatrix}\n1  & 0  & 0  & 0  & 0  & 0  & 0 \\\\\n0  & 1  & 0  & 0  & 0  & 0  & 0 \\\\\n0  & 0  & 1  & 0  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 1  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 0  & 1  & 1  & 0 \\\\\n0  & 0  & 0  & 4  & 3  & 3  & 1 \\\\\n0  & 0  & 0  & 0  & 1  & 0  & 2 \\\\\n1  & -1  & 2  & -2  & -1  & -2  & 0\n\\end{pmatrix}\n$$\n容差 $\\tau = 10^{-12}$ 非常小。物质的成分是不同的，这表明 $A_1$ 的列是线性独立的。我们预期该矩阵具有满列秩，即 $7$。SVD 将产生 $r = \\min(8, 7) = 7$ 个奇异值。预计所有 $7$ 个奇异值都将显著大于由小 $\\tau$ 设定的阈值。这将导致有效秩为 $7$，近似相关性计数为 $0$，以及一个小的条件数代理 $\\kappa_{\\tau}(A_1) = \\sigma_{1} / \\sigma_{7}$，表明这是一个良态系统。\n\n**测试用例 2：近似相关**\n该系统有 $m=5$ 个量 ($[\\mathrm{Na}, \\mathrm{Cl}, \\mathrm{O}, \\mathrm{H}, q]$) 和 $n=4$ 种物质 ($[\\mathrm{Na}^+, \\mathrm{Cl}^-, \\mathrm{NaCl}^0(\\mathrm{aq}), \\mathrm{H}_2\\mathrm{O}]$)。对于 $\\varepsilon = 10^{-8}$，$5 \\times 4$ 的矩阵 $A_2$ 为：\n$$\nA_2 = \\begin{pmatrix}\n1  & 0  & 1  & 0 \\\\\n0  & 1  & 1  & 0 \\\\\n0  & 0  & \\varepsilon  & 1 \\\\\n0  & 0  & 2\\varepsilon  & 2 \\\\\n1  & -1  & 0  & 0\n\\end{pmatrix}\n$$\n容差为 $\\tau = 10^{-8}$。存在近似线性相关：$\\mathrm{NaCl}^0(\\mathrm{aq})$ 的列几乎是 $\\mathrm{Na}^+$ 和 $\\mathrm{Cl}^-$ 列的和。这意味着 $r = \\min(5, 4) = 4$ 个奇异值中的一个 $\\sigma_4$ 将非常小，数量级约为 $\\varepsilon$。其他三个的数量级将为 1。容差 $\\tau = 10^{-8}$ 是故意选择与 $\\varepsilon$ 相同的数量级。$\\sigma_4$ 与阈值 $\\tau \\sigma_{\\max}$ 的比较至关重要。预计 $\\sigma_4$ 将小于阈值，从而导致有效秩为 $3$。这揭示了一个近似线性相关性的存在，因此近似相关性的计数将为 $1$。条件数代理 $\\kappa_{\\tau}(A_2)$ 将计算为 $\\sigma_1 / \\sigma_3$。\n\n**测试用例 3：精确相关**\n该用例有 $m=5$ 个量 ($[\\mathrm{H}, \\mathrm{O}, \\mathrm{Na}, \\mathrm{Cl}, q]$) 和 $n=5$ 种物质 ($[\\mathrm{H}^+, \\mathrm{OH}^-, \\mathrm{H}_2\\mathrm{O}, \\mathrm{Na}^+, \\mathrm{Cl}^-]$)。$5 \\times 5$ 的矩阵 $A_3$ 为：\n$$\nA_3 = \\begin{pmatrix}\n1  & 1  & 2  & 0  & 0 \\\\\n0  & 1  & 1  & 0  & 0 \\\\\n0  & 0  & 0  & 1  & 0 \\\\\n0  & 0  & 0  & 0  & 1 \\\\\n1  & -1  & 0  & 1  & -1\n\\end{pmatrix}\n$$\n容差为 $\\tau = 10^{-12}$。该矩阵是围绕水的自电离反应 $\\mathrm{H}^+ + \\mathrm{OH}^- \\rightleftharpoons \\mathrm{H}_2\\mathrm{O}$ 构建的。这产生了一个精确的线性相关性：$\\mathrm{H}_2\\mathrm{O}$ 的列向量是 $\\mathrm{H}^+$ 和 $\\mathrm{OH}^-$ 向量的和。因此，$A_3$ 是秩亏的，真实秩为 $4$。SVD 将产生 $n=5$ 个奇异值，其中一个 $\\sigma_5$ 将为零（或在数值上与零无法区分，例如 $\\approx 10^{-16}$）。由于 $\\tau = 10^{-12}$ 远大于机器精度，$\\sigma_5$ 将远低于阈值。这将正确地识别出有效秩为 $4$，近似相关性计数为 $1$。条件数代理 $\\kappa_{\\tau}(A_3) = \\sigma_1 / \\sigma_4$ 将反映剩余独立组分的条件状况。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_matrix(A: np.ndarray, tau: float) -> list:\n    \"\"\"\n    Performs SVD analysis on a composition matrix A.\n\n    Args:\n        A: The composition matrix.\n        tau: The tolerance for defining effective rank.\n\n    Returns:\n        A list containing [effective_rank, kappa_tau, near_dependencies_count].\n    \"\"\"\n    # Ensure A is a numpy array of floats for numerical stability\n    A = np.asarray(A, dtype=float)\n\n    # Perform Singular Value Decomposition\n    # We only need the singular values s (sigma)\n    try:\n        s = np.linalg.svd(A, compute_uv=False)\n    except np.linalg.LinAlgError:\n        # Handle cases where SVD might fail, though not expected for these inputs\n        r = min(A.shape)\n        return [0, np.inf, r]\n\n    # The singular values are sorted in descending order.\n    # Handle the case of a zero matrix or empty singular value array.\n    if s.size == 0 or s[0] == 0:\n        r = min(A.shape) if A.shape else 0\n        return [0, np.inf, r]\n\n    sigma_max = s[0]\n    threshold = tau * sigma_max\n\n    # Calculate effective rank: count of singular values sigma_i >= tau * sigma_max\n    effective_rank = np.sum(s >= threshold)\n\n    # Calculate count of near-dependencies: count of sigma_i = tau * sigma_max\n    near_dependencies_count = np.sum(s = threshold)\n\n    # Calculate conditional number proxy kappa_tau(A)\n    # Get singular values >= threshold\n    s_above_tolerance = s[s >= threshold]\n    \n    # The problem statement guarantees this set is not empty for the given inputs.\n    if s_above_tolerance.size == 0:\n        kappa_tau = np.inf\n    else:\n        min_s_above = np.min(s_above_tolerance)\n        if min_s_above == 0:\n             kappa_tau = np.inf\n        else:\n             kappa_tau = sigma_max / min_s_above\n\n    return [int(effective_rank), float(kappa_tau), int(near_dependencies_count)]\n\ndef solve():\n    \"\"\"\n    Constructs matrices for three test cases, analyzes them, and prints results.\n    \"\"\"\n    # Test case 1: Well-conditioned\n    # Rows: [Na, Cl, Ca, S, C, O, H, q]\n    # Cols: [Na+, Cl-, Ca2+, SO4^2-, HCO3-, CO3^2-, H2O]\n    A1 = np.array([\n        [1, 0, 0, 0, 0, 0, 0],\n        [0, 1, 0, 0, 0, 0, 0],\n        [0, 0, 1, 0, 0, 0, 0],\n        [0, 0, 0, 1, 0, 0, 0],\n        [0, 0, 0, 0, 1, 1, 0],\n        [0, 0, 0, 4, 3, 3, 1],\n        [0, 0, 0, 0, 1, 0, 2],\n        [1, -1, 2, -2, -1, -2, 0],\n    ])\n    tau1 = 1e-12\n\n    # Test case 2: Near-dependence\n    # Rows: [Na, Cl, O, H, q]\n    # Cols: [Na+, Cl-, NaCl^0(aq), H2O]\n    eps = 1e-8\n    A2 = np.array([\n        [1, 0, 1, 0],\n        [0, 1, 1, 0],\n        [0, 0, eps, 1],\n        [0, 0, 2 * eps, 2],\n        [1, -1, 0, 0],\n    ])\n    tau2 = 1e-8\n\n    # Test case 3: Exact dependence\n    # Rows: [H, O, Na, Cl, q]\n    # Cols: [H+, OH-, H2O, Na+, Cl-]\n    A3 = np.array([\n        [1, 1, 2, 0, 0],\n        [0, 1, 1, 0, 0],\n        [0, 0, 0, 1, 0],\n        [0, 0, 0, 0, 1],\n        [1, -1, 0, 1, -1],\n    ])\n    tau3 = 1e-12\n\n    test_cases = [\n        (A1, tau1),\n        (A2, tau2),\n        (A3, tau3)\n    ]\n\n    results = []\n    for A, tau in test_cases:\n        result = analyze_matrix(A, tau)\n        results.append(result)\n\n    # Format the final output string exactly as specified: [[r,k,n],[r,k,n],...]\n    output_str = f\"[{','.join([f'[{r},{k},{n}]' for r, k, n in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}