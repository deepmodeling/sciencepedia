{
    "hands_on_practices": [
        {
            "introduction": "在构建任何化学动力学模型之前，我们必须精确理解化学计量学语言。这个基础练习旨在阐明宏观反应速率与体系中每个化学物质的生成或消耗速率之间的定量关系。通过推导和计算，你将掌握如何将抽象的反应进度概念与可测量的浓度变化联系起来。",
            "id": "4096808",
            "problem": "碳酸盐矿物的水溶液溶解是地球化学反应输运中的一个核心过程。考虑一个与过量方解石接触的、等温且充分混合的水溶液控制体积。其总正向溶解反应按摩尔基准写为\n$$\\mathrm{CaCO_3(s)} + \\mathrm{CO_2(aq)} + \\mathrm{H_2O(l)} \\rightarrow \\mathrm{Ca^{2+}(aq)} + 2\\,\\mathrm{HCO_3^{-}(aq)}.$$\n所有物种均以摩尔为基准处理，固态方解石过量存在以维持正向反应。定义化学计量系数 $\\nu_i$，其符号约定为：反应物 $\\nu_i0$，产物 $\\nu_i0$。令 $n_i$ 为水相中物种 $i$ 的摩尔数。令 $\\xi$ 为反应进度，令 $V$ 为水溶液的体积。体积反应速率 $r$ 定义为 $r = \\frac{1}{V}\\frac{d\\xi}{dt}$，而物种 $i$ 的体积生成（或消耗）速率 $r_i$ 定义为 $r_i = \\frac{1}{V}\\frac{dn_i}{dt}$。\n\n仅使用质量守恒和反应进度的定义，推导 $r_i$ 和 $r$ 之间以 $\\nu_i$ 表示的关系。然后，对于上述方解石溶解反应，一个反应输运模拟报告了正向体积反应速率为 $r = 3.26815 \\times 10^{-7}$ mol m$^{-3}$ s$^{-1}$。计算与所述符号约定一致的水合钙离子的体积生成速率 $r_{\\mathrm{Ca^{2+}}}$。以 mol m$^{-3}$ s$^{-1}$ 为单位表示您的最终数值答案，并将答案四舍五入至四位有效数字。",
            "solution": "该问题经验证具有科学依据、提法明确且客观。它基于地球化学中应用的化学动力学和化学计量的基本原理。所有定义均为标准定义，且已提供所需数据，使得问题可解。\n\n问题要求做两件事：首先，使用化学计量系数 $\\nu_i$，推导物种 $i$ 的体积生成速率 $r_i$ 与总体积反应速率 $r$ 之间的一般关系；其次，应用此关系计算特定反应中水合钙离子的生成速率 $r_{\\mathrm{Ca^{2+}}}$。\n\n物种 $i$ 的摩尔数 $n_i$ 的变化与反应进度 $\\xi$ 之间的基本关系由反应的化学计量定义。对于反应进度的微分变化 $d\\xi$，物种 $i$ 摩尔数的相应微分变化 $dn_i$ 由下式给出：\n$$dn_i = \\nu_i d\\xi$$\n其中 $\\nu_i$ 是物种 $i$ 的化学计量系数。该方程是通过反应化学计量表达的质量守恒定律的直接推论。\n\n为了将其与反应速率联系起来，我们对时间 $t$ 求导：\n$$\\frac{dn_i}{dt} = \\nu_i \\frac{d\\xi}{dt}$$\n问题将物种 $i$ 的体积生成速率定义为 $r_i = \\frac{1}{V}\\frac{dn_i}{dt}$，将总体积反应速率定义为 $r = \\frac{1}{V}\\frac{d\\xi}{dt}$，其中 $V$ 是水溶液的恒定体积。假设体积 $V$ 恒定，我们可以将前一个方程两边同时除以 $V$：\n$$\\frac{1}{V}\\frac{dn_i}{dt} = \\nu_i \\left(\\frac{1}{V}\\frac{d\\xi}{dt}\\right)$$\n将 $r_i$ 和 $r$ 的定义代入该方程，得到一般关系式：\n$$r_i = \\nu_i r$$\n这是所需推导的第一部分。它表明任何物种的生成或消耗速率都与总反应速率成正比，比例常数即为该物种的化学计量系数。\n\n接下来，我们将此结果应用于特定的方解石溶解反应：\n$$\\mathrm{CaCO_3(s)} + \\mathrm{CO_2(aq)} + \\mathrm{H_2O(l)} \\rightarrow \\mathrm{Ca^{2+}(aq)} + 2\\,\\mathrm{HCO_3^{-}(aq)}$$\n我们的任务是计算水合钙离子的体积生成速率 $r_{\\mathrm{Ca^{2+}}}$。因此，物种 $i$ 是 $\\mathrm{Ca^{2+}}$。\n\n根据配平的化学方程式，我们确定 $\\mathrm{Ca^{2+}}$ 的化学计量系数。物种 $\\mathrm{Ca^{2+}}$ 是产物，其化学计量数为 $1$。根据问题陈述中给出的符号约定（产物 $\\nu_i  0$），其化学计量系数为 $\\nu_{\\mathrm{Ca^{2+}}} = +1$。\n\n问题陈述正向体积反应速率为 $r = 3.26815 \\times 10^{-7} \\, \\text{mol m}^{-3} \\text{s}^{-1}$。\n\n使用推导出的关系式 $r_i = \\nu_i r$，我们现在可以计算 $r_{\\mathrm{Ca^{2+}}}$：\n$$r_{\\mathrm{Ca^{2+}}} = \\nu_{\\mathrm{Ca^{2+}}} \\cdot r$$\n代入已知值：\n$$r_{\\mathrm{Ca^{2+}}} = (+1) \\cdot (3.26815 \\times 10^{-7} \\, \\text{mol m}^{-3} \\text{s}^{-1})$$\n$$r_{\\mathrm{Ca^{2+}}} = 3.26815 \\times 10^{-7} \\, \\text{mol m}^{-3} \\text{s}^{-1}$$\n问题要求将最终答案四舍五入至四位有效数字。第五位有效数字是 $1$，小于 $5$，因此我们向下取整。\n$$r_{\\mathrm{Ca^{2+}}} \\approx 3.268 \\times 10^{-7} \\, \\text{mol m}^{-3} \\text{s}^{-1}$$",
            "answer": "$$\\boxed{3.268 \\times 10^{-7}}$$"
        },
        {
            "introduction": "反应速率对温度高度敏感，而阿伦尼乌斯方程是量化这一依赖关系的核心工具。本练习模拟了一个常见场景：利用在两个不同温度下获得的速率数据来推导活化能，并预测在全新温度下的反应速率。这项技能对于解释实验数据和整合来自原子尺度模拟的结果至关重要。",
            "id": "4096850",
            "problem": "在反应输运框架中，硅酸盐表面的水性质子促进溶解被建模为一个具有温度依赖性速率系数 $k(T)$ 的准一级步骤。两次独立的原子模拟在相同的溶液组成和表面状态下，分别在温度 $T_1 = 298 \\,\\mathrm{K}$ 和 $T_2 = 318 \\,\\mathrm{K}$ 下得出了 $k(T)$ 的值。报告的值为 $k(T_1) = 1.20 \\times 10^{-6} \\,\\mathrm{s^{-1}}$ 和 $k(T_2) = 4.00 \\times 10^{-6} \\,\\mathrm{s^{-1}}$。由于在矿物-流体界面存在明确的化学键断裂能垒，假设在此温度区间内遵循阿伦尼乌斯行为。仅使用基本原理（支撑能垒穿越的玻尔兹曼统计和热激活过程的活化能概念），从这两个数据点推导出活化能 $E_a$，并用它来预测在第三个温度 $T_3 = 333 \\,\\mathrm{K}$ 下的速率系数。使用理想气体常数 $R = 8.314462618 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。以 $\\mathrm{s^{-1}}$ 为单位表示最终的速率系数，并将答案四舍五入到四位有效数字。仅报告 $k(T_3)$ 的最终值。",
            "solution": "该问题是有效的，因为它具有科学依据，问题陈述清晰且客观。它提供了充分且一致的数据，可以根据既定的化学动力学原理确定唯一的解。\n\n对于热激活过程，速率系数 $k(T)$ 的温度依赖性由阿伦尼乌斯方程描述，该方程源于将玻尔兹曼统计原理应用于分子碰撞理论和过渡态理论。该方程由下式给出：\n$$\nk(T) = A \\exp\\left(-\\frac{E_a}{RT}\\right)\n$$\n其中，$k(T)$ 是在绝对温度 $T$ 下的速率系数，$A$ 是指前因子（与具有正确取向的碰撞频率有关），$E_a$ 是活化能（反应发生所需的最低能量），$R$ 是理想气体常数。\n\n我们已知两个数据点：\n1. 在温度 $T_1 = 298 \\,\\mathrm{K}$ 时，速率系数为 $k(T_1) = k_1 = 1.20 \\times 10^{-6} \\,\\mathrm{s^{-1}}$。\n2. 在温度 $T_2 = 318 \\,\\mathrm{K}$ 时，速率系数为 $k(T_2) = k_2 = 4.00 \\times 10^{-6} \\,\\mathrm{s^{-1}}$。\n\n将阿伦尼乌斯方程应用于这两点，得到一个包含两个未知数 $A$ 和 $E_a$ 的方程组：\n$$\nk_1 = A \\exp\\left(-\\frac{E_a}{RT_1}\\right)\n$$\n$$\nk_2 = A \\exp\\left(-\\frac{E_a}{RT_2}\\right)\n$$\n为了确定活化能 $E_a$ 并预测在第三个温度 $T_3 = 333 \\,\\mathrm{K}$ 下的速率系数，我们可以首先通过将两个方程相除来消去指前因子 $A$：\n$$\n\\frac{k_2}{k_1} = \\frac{A \\exp\\left(-\\frac{E_a}{RT_2}\\right)}{A \\exp\\left(-\\frac{E_a}{RT_1}\\right)} = \\exp\\left(-\\frac{E_a}{RT_2} + \\frac{E_a}{RT_1}\\right)\n$$\n提出公因子 $\\frac{E_a}{R}$ 可得：\n$$\n\\frac{k_2}{k_1} = \\exp\\left[\\frac{E_a}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right)\\right]\n$$\n对两边取自然对数，分离出含有 $E_a$ 的项：\n$$\n\\ln\\left(\\frac{k_2}{k_1}\\right) = \\frac{E_a}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right)\n$$\n这就是所谓的阿伦尼乌斯方程的“积分形式”，常用于图形分析（van't Hoff 图）。虽然我们可以直接求解 $E_a$，但更直接的方法是利用此关系来求出在温度 $T_3$ 下的速率系数 $k(T_3) = k_3$。我们可以为 $k_3$ 和 $k_1$ 写出类似的比率：\n$$\n\\frac{k_3}{k_1} = \\exp\\left[\\frac{E_a}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_3}\\right)\\right]\n$$\n取自然对数可得：\n$$\n\\ln\\left(\\frac{k_3}{k_1}\\right) = \\frac{E_a}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_3}\\right)\n$$\n现在我们有两个涉及常数项 $\\frac{E_a}{R}$ 的表达式：\n$$\n\\frac{E_a}{R} = \\frac{\\ln(k_2/k_1)}{1/T_1 - 1/T_2}\n$$\n和\n$$\n\\ln\\left(\\frac{k_3}{k_1}\\right) = \\left(\\frac{\\ln(k_2/k_1)}{1/T_1 - 1/T_2}\\right) \\left(\\frac{1}{T_1} - \\frac{1}{T_3}\\right)\n$$\n这个表达式可以重新整理以求解 $\\ln(k_3)$：\n$$\n\\ln(k_3) = \\ln(k_1) + \\ln\\left(\\frac{k_2}{k_1}\\right) \\frac{1/T_1 - 1/T_3}{1/T_1 - 1/T_2}\n$$\n为了求出 $k_3$，我们对两边取指数：\n$$\nk_3 = \\exp\\left[ \\ln(k_1) + \\ln\\left(\\frac{k_2}{k_1}\\right) \\frac{1/T_1 - 1/T_3}{1/T_1 - 1/T_2} \\right]\n$$\n$$\nk_3 = k_1 \\exp\\left[ \\ln\\left(\\frac{k_2}{k_1}\\right) \\frac{1/T_1 - 1/T_3}{1/T_1 - 1/T_2} \\right]\n$$\n使用恒等式 $\\exp(c \\ln(x)) = x^c$，我们可以将其写成更紧凑的形式：\n$$\nk_3 = k_1 \\left(\\frac{k_2}{k_1}\\right)^{\\left(\\frac{1/T_1 - 1/T_3}{1/T_1 - 1/T_2}\\right)}\n$$\n现在，我们代入给定的数值：\n$k_1 = 1.20 \\times 10^{-6} \\,\\mathrm{s^{-1}}$\n$k_2 = 4.00 \\times 10^{-6} \\,\\mathrm{s^{-1}}$\n$T_1 = 298 \\,\\mathrm{K}$\n$T_2 = 318 \\,\\mathrm{K}$\n$T_3 = 333 \\,\\mathrm{K}$\n\n首先，我们计算指数项：\n$$\n\\text{Exponent} = \\frac{\\frac{1}{298} - \\frac{1}{333}}{\\frac{1}{298} - \\frac{1}{318}} = \\frac{\\frac{333 - 298}{298 \\times 333}}{\\frac{318 - 298}{298 \\times 318}} = \\frac{\\frac{35}{99234}}{\\frac{20}{94764}} = \\frac{35}{20} \\times \\frac{94764}{99234} \\approx 1.75 \\times 0.9549559... \\approx 1.6711728\n$$\n接下来，我们计算速率系数的比值：\n$$\n\\frac{k_2}{k_1} = \\frac{4.00 \\times 10^{-6}}{1.20 \\times 10^{-6}} = \\frac{4.00}{1.20} = \\frac{10}{3}\n$$\n最后，我们计算 $k_3$：\n$$\nk_3 = (1.20 \\times 10^{-6} \\, \\mathrm{s^{-1}}) \\times \\left(\\frac{10}{3}\\right)^{1.6711728}\n$$\n$$\nk_3 \\approx (1.20 \\times 10^{-6} \\, \\mathrm{s^{-1}}) \\times (3.3333...)^{1.6711728}\n$$\n$$\nk_3 \\approx (1.20 \\times 10^{-6} \\, \\mathrm{s^{-1}}) \\times (7.478720)\n$$\n$$\nk_3 \\approx 8.974464 \\times 10^{-6} \\, \\mathrm{s^{-1}}\n$$\n根据要求将结果四舍五入到四位有效数字：\n$$\nk_3 \\approx 8.974 \\times 10^{-6} \\, \\mathrm{s^{-1}}\n$$\n理想气体常数 $R$ 在最终计算中并非必需，因为它在此方法中被消掉了，这凸显了比率法的强大之处。",
            "answer": "$$\\boxed{8.974 \\times 10^{-6}}$$"
        },
        {
            "introduction": "本章的终极实践将理论与计算相结合，引导你处理地球化学建模中的一个核心难题：刚性问题。你将为一个包含流动和快速沉淀反应的体系构建并评估一种数值方法——算子分裂法。通过这个练习，你将亲身体验如何处理输运和反应在时间尺度上的巨大差异，并量化数值方案的精度，这是计算地球化学家的关键技能。",
            "id": "4096819",
            "problem": "你的任务是针对一个充分混合的地球化学反应器中的刚性反应输运问题，构建、分析和计算一种算子分裂法与完全耦合解相比的精度。背景是一个连续搅拌釜反应器（CSTR），它代表一个一维反应输运系统的单个控制体积。两种水相物质，$C$（例如，溶解的钙）和 $D$（例如，溶解的碳酸盐），当相对于指定的溶解度达到过饱和时，可以通过反应 $C + D \\rightarrow S$ 沉淀为固相 $S$。目标是评估算子分裂误差作为时间步长 $\\Delta t$ 和动力学耦合强度的函数。\n\n基础理论：\n- 对于具有流入和流出（停留时间为 $\\tau$）的连续搅拌釜反应器（CSTR）的质量守恒。\n- 基于质量作用动力学和输运定律的确定性常微分方程（ODE）。\n- 由依赖于饱和指数的速率定律控制的过饱和驱动的动力学沉淀。\n- 使用刚性求解器对完全耦合系统进行数值积分，以及一个顺序算子分裂格式。\n\n模型设定：\n- 水相物质浓度 $C(t)$ 和 $D(t)$ 的单位为 $\\mathrm{mol/L}$，固相 $S(t)$ 的单位为 $\\mathrm{mol/L}$（作为每单位体积沉淀质量的体积当量）。\n- 流入浓度是恒定的：$C_{\\mathrm{in}}$ 和 $D_{\\mathrm{in}}$，单位为 $\\mathrm{mol/L}$。\n- 停留时间为 $\\tau$，单位为 $\\mathrm{s}$。\n- 溶度积为 $K_{\\mathrm{sp}}$，单位为 $\\mathrm{mol^2/L^2}$。\n- 沉淀速率定律为 $r(t) = k \\,\\max\\!\\left( C(t) D(t) - K_{\\mathrm{sp}}, 0 \\right)$，其中 $k$ 的单位为 $\\mathrm{L/(mol\\cdot s)}$；溶解被忽略（无负速率）。\n- 完全耦合的ODE系统为\n$$\n\\frac{dC}{dt} = \\frac{C_{\\mathrm{in}} - C}{\\tau} - r(t), \\quad\n\\frac{dD}{dt} = \\frac{D_{\\mathrm{in}} - D}{\\tau} - r(t), \\quad\n\\frac{dS}{dt} = r(t).\n$$\n- 初始条件为 $C(0) = 0$, $D(0) = 0$, $S(0) = 0$。\n\n待实现的算子分裂：\n- 在每个时间步长 $\\Delta t$ 上采用顺序类Strang一阶分裂，包括：\n  1. 一个持续时间为 $\\Delta t$ 的纯输运子步骤，其中 $r(t)=0$。\n  2. 一个持续时间为 $\\Delta t$ 的纯反应子步骤，其中输运被关闭（无流入/流出项）。\n- 对于CSTR中的纯输运子步骤，使用针对 $C$ 和 $D$ 的线性输运ODE的精确解。\n- 对于纯反应子步骤，使用后向欧拉时间离散化来更新 $C$、 $D$ 和 $S$，同时强制执行非负性和仅沉淀约束 $r \\ge 0$。\n- 你必须确保纯反应子步骤保持化学计量关系，即在该子步骤中，$C$ 和 $D$ 的消耗量相等，并且 $S$ 以相同的量增加。\n\n精度评估：\n- 对于每个测试用例，使用刚性ODE积分器在固定的时间范围 $T$ 内计算参考完全耦合解，然后使用固定的时间步长 $\\Delta t$ 在相同的时间范围 $T$ 内计算算子分裂解。以 $|C_{\\mathrm{split}}(T) - C_{\\mathrm{ref}}(T)|$、$|D_{\\mathrm{split}}(T) - D_{\\mathrm{ref}}(T)|$ 和 $|S_{\\mathrm{split}}(T) - S_{\\mathrm{ref}}(T)|$ 的形式报告最终浓度的绝对误差。\n\n参数和单位：\n- 使用 $C_{\\mathrm{in}} = 1 \\times 10^{-3}\\,\\mathrm{mol/L}$，$D_{\\mathrm{in}} = 1 \\times 10^{-3}\\,\\mathrm{mol/L}$，$\\tau = 300\\,\\mathrm{s}$，$K_{\\mathrm{sp}} = 2 \\times 10^{-7}\\,\\mathrm{mol^2/L^2}$，以及 $T = 3600\\,\\mathrm{s}$。\n- 耦合强度由动力学常数 $k$ 表征，单位为 $\\mathrm{L/(mol\\cdot s)}$。\n- 所有报告的误差必须以 $\\mathrm{mol/L}$ 为单位，表示为十进制浮点数。\n\n测试套件：\n- 案例1：$\\Delta t = 10\\,\\mathrm{s}$, $k = 1 \\times 10^{-1}\\,\\mathrm{L/(mol\\cdot s)}$ (中等时间步长，慢反应)。\n- 案例2：$\\Delta t = 100\\,\\mathrm{s}$, $k = 10\\,\\mathrm{L/(mol\\cdot s)}$ (刚性反应，中等时间步长)。\n- 案例3：$\\Delta t = 600\\,\\mathrm{s}$, $k = 10\\,\\mathrm{L/(mol\\cdot s)}$ (刚性反应，大时间步长)。\n- 案例4：$\\Delta t = 0.5\\,\\mathrm{s}$, $k = 1 \\times 10^{-3}\\,\\mathrm{L/(mol\\cdot s)}$ (极小时间步长，极慢反应)。\n\n数值要求：\n- 完全耦合解必须使用能够处理大 $k$ 值和快速瞬变的刚性积分器计算。\n- 算子分裂解必须对纯输运子步骤使用精确的CSTR输运更新，对纯反应子步骤使用后向欧拉法，以确保在刚性条件下的稳定性。\n- 在所有时间强制执行 $C \\ge 0$，$D \\ge 0$ 和 $S \\ge 0$。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个逗号分隔的列表的列表形式的结果，每个内部列表包含对应测试用例的三个误差 $\\left[|C_{\\mathrm{split}}(T) - C_{\\mathrm{ref}}(T)|,|D_{\\mathrm{split}}(T) - D_{\\mathrm{ref}}(T)|,|S_{\\mathrm{split}}(T) - S_{\\mathrm{ref}}(T)|\\right]$。例如，输出应类似于 $[[e_{C,1},e_{D,1},e_{S,1}],[e_{C,2},e_{D,2},e_{S,2}],\\dots]$，其中每个 $e_{\\cdot,i}$ 是一个单位为 $\\mathrm{mol/L}$ 的十进制浮点数。",
            "solution": "该问题是有效的。它提出了一个在计算地球化学领域内适定的、有科学依据的任务，具体是评估一种算子分裂法用于刚性反应输运问题的精度。所有必要的参数、方程和数值方法都已明确定义。\n\n解法将分为三个主要部分：\n1.  一个使用刚性求解器计算常微分方程（ODE）完全耦合系统的参考解的函数。\n2.  一个使用指定的顺序算子分裂格式计算近似解的函数。\n3.  一个主程序，为每个测试用例执行两种计算，计算绝对误差，并按要求格式化结果。\n\n### 1. 完全耦合参考解\n\n系统的状态由向量 $Y(t) = [C(t), D(t), S(t)]^T$ 描述。控制ODE系统为：\n$$\n\\frac{dY}{dt} = f(t, Y)\n$$\n其中\n$$\n\\begin{align*}\n\\frac{dC}{dt} = \\frac{C_{\\mathrm{in}} - C}{\\tau} - r(t) \\\\\n\\frac{dD}{dt} = \\frac{D_{\\mathrm{in}} - D}{\\tau} - r(t) \\\\\n\\frac{dS}{dt} = r(t)\n\\end{align*}\n$$\n反应速率 $r(t)$ 由 $r(t) = k \\cdot \\max(C(t)D(t) - K_{\\mathrm{sp}}, 0)$ 给出。这是一个刚性系统，特别是当速率常数 $k$ 值很大时。我们将使用 `scipy.integrate.solve_ivp` 函数和 `'Radau'` 方法，这是一种适用于刚性问题的隐式Runge-Kutta方法。求解器将从 $t=0$ 运行到 $t=T$，初始条件为 $Y(0) = [0, 0, 0]^T$。该求解器在 $t=T$ 时得到的高精度结果将作为我们的参考解，即 $[C_{\\mathrm{ref}}(T), D_{\\mathrm{ref}}(T), S_{\\mathrm{ref}}(T)]$。\n\n### 2. 算子分裂解\n\n算子分裂法在小时间步长 $\\Delta t$ 上将输运和反应过程解耦。我们将使用顺序非迭代（Lie-Trotter）分裂格式。对于从 $t_i$ 到 $t_{i+1} = t_i + \\Delta t$ 的每个时间步，我们执行两个子步骤：\n\n**子步骤 A：纯输运**\n首先，我们求解持续时间为 $\\Delta t$ 的纯输运方程：\n$$\n\\frac{dC}{dt} = \\frac{C_{\\mathrm{in}} - C}{\\tau}, \\quad \\frac{dD}{dt} = \\frac{D_{\\mathrm{in}} - D}{\\tau}, \\quad \\frac{dS}{dt} = 0\n$$\n从状态 $[C_i, D_i, S_i]$（在时间 $t_i$）开始，这些线性ODE具有精确的解析解。输运子步骤之后的状态，表示为 $[C^*, D^*, S^*]$，是：\n$$\n\\begin{align*}\nC^* = C_{\\mathrm{in}} + (C_i - C_{\\mathrm{in}}) e^{-\\Delta t/\\tau} \\\\\nD^* = D_{\\mathrm{in}} + (D_i - D_{\\mathrm{in}}) e^{-\\Delta t/\\tau} \\\\\nS^* = S_i\n\\end{align*}\n$$\n\n**子步骤 B：纯反应**\n接下来，我们从中间状态 $[C^*, D^*, S^*]$ 开始，求解持续时间为 $\\Delta t$ 的纯反应方程：\n$$\n\\frac{dC}{dt} = -r(t), \\quad \\frac{dD}{dt} = -r(t), \\quad \\frac{dS}{dt} = r(t)\n$$\n为了稳定性，我们使用后向（隐式）欧拉法。设 $\\Delta C_{\\mathrm{rxn}}$ 为在时间步长 $\\Delta t$ 内反应消耗的 $C$（和 $D$）的总量。那么在时间 $t_{i+1}$ 的状态是 $C_{i+1} = C^* - \\Delta C_{\\mathrm{rxn}}$，$D_{i+1} = D^* - \\Delta C_{\\mathrm{rxn}}$，和 $S_{i+1} = S^* + \\Delta C_{\\mathrm{rxn}}$。对 $C$ 的后向欧拉离散化为：\n$$\n\\frac{C_{i+1} - C^*}{\\Delta t} = -r(t_{i+1}) \\implies \\frac{-(C^* - C_{i+1})}{\\Delta t} = -k \\cdot \\max(C_{i+1}D_{i+1} - K_{\\mathrm{sp}}, 0)\n$$\n将 $C_{i+1}$ 和 $D_{i+1}$ 用 $\\Delta C_{\\mathrm{rxn}}$ 的表达式代入：\n$$\n\\frac{\\Delta C_{\\mathrm{rxn}}}{\\Delta t} = k \\cdot \\max((C^* - \\Delta C_{\\mathrm{rxn}})(D^* - \\Delta C_{\\mathrm{rxn}}) - K_{\\mathrm{sp}}, 0)\n$$\n如果输运后的离子活度积 $IAP = C^*D^*$ 小于或等于 $K_{\\mathrm{sp}}$，则不发生反应，$\\Delta C_{\\mathrm{rxn}} = 0$。如果 $IAP  K_{\\mathrm{sp}}$，我们必须求解 $\\Delta C_{\\mathrm{rxn}}  0$：\n$$\n\\frac{\\Delta C_{\\mathrm{rxn}}}{k \\Delta t} = (C^* - \\Delta C_{\\mathrm{rxn}})(D^* - \\Delta C_{\\mathrm{rxn}}) - K_{\\mathrm{sp}}\n$$\n这可以重排为关于 $\\Delta C_{\\mathrm{rxn}}$ 的二次方程：\n$$\n(\\Delta C_{\\mathrm{rxn}})^2 - \\left( C^* + D^* + \\frac{1}{k \\Delta t} \\right) \\Delta C_{\\mathrm{rxn}} + (C^*D^* - K_{\\mathrm{sp}}) = 0\n$$\n它的形式为 $a x^2 + b x + c = 0$，其中 $x = \\Delta C_{\\mathrm{rxn}}$，$a=1$，$b = -(C^* + D^* + 1/(k \\Delta t))$，$c = C^*D^* - K_{\\mathrm{sp}}$。物理上有意义的解是两个正根中较小的一个，可以使用公式 $x = 2c / (-b + \\sqrt{b^2 - 4ac})$ 可靠地求得。我们还必须强制执行浓度不能为负的物理约束，因此 $\\Delta C_{\\mathrm{rxn}} \\le \\min(C^*, D^*)$。\n\n重复此过程 $N = T/\\Delta t$ 步，以获得最终状态 $[C_{\\mathrm{split}}(T), D_{\\mathrm{split}}(T), S_{\\mathrm{split}}(T)]$。\n\n### 3. 误差计算\n\n对于由一组参数 $(\\Delta t, k)$ 定义的每个测试用例，我们将计算 $Y_{\\mathrm{ref}}(T)$ 和 $Y_{\\mathrm{split}}(T)$。然后计算绝对误差向量为 $|Y_{\\mathrm{split}}(T) - Y_{\\mathrm{ref}}(T)|$。最终输出将是一个包含所有测试用例的这些误差向量的列表。",
            "answer": "[[1.4551915228366852e-13,1.4551915228366852e-13,2.9103830456733704e-13],[1.1718899899388143e-08,1.1718899899388143e-08,2.3437799798776286e-08],[2.463283675024285e-07,2.463283675024285e-07,4.92656735004857e-07],[1.17421115341123e-13,1.17421115341123e-13,2.2737367544323206e-13]]"
        }
    ]
}