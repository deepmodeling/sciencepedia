{
    "hands_on_practices": [
        {
            "introduction": "Before we can model reaction kinetics, we need a clear, quantitative link between the overall reaction progress and the change in concentration of each participating chemical species. This exercise grounds our understanding in the law of mass conservation, expressed through stoichiometric coefficients ($\\nu_i$). By deriving this fundamental relationship, you'll gain the essential skill of translating a balanced chemical equation into a system of rate equations, a cornerstone of any kinetic model .",
            "id": "4096808",
            "problem": "Aqueous dissolution of carbonate minerals is a central process in geochemical reactive transport. Consider an isothermal, well-mixed control volume of aqueous solution in contact with excess calcite. The overall forward dissolution reaction is written on a molar basis as\n$$\\mathrm{CaCO_3(s)} + \\mathrm{CO_2(aq)} + \\mathrm{H_2O(l)} \\rightarrow \\mathrm{Ca}^{2+}\\text{(aq)} + 2\\,\\mathrm{HCO_3^{-}}\\text{(aq)}.$$\nAll species are treated on a molar basis, with solid calcite present in excess so that the forward reaction is sustained. Define stoichiometric coefficients $\\nu_i$ with the sign convention that $\\nu_i<0$ for reactants and $\\nu_i>0$ for products, and let $n_i$ be the number of moles of species $i$ in the aqueous phase. Let $\\xi$ be the extent of reaction, and let $V$ be the aqueous solution volume. The volumetric reaction rate $r$ is defined by $r = \\frac{1}{V}\\frac{d\\xi}{dt}$, and the volumetric rate of production (or consumption) of species $i$ is $r_i = \\frac{1}{V}\\frac{dn_i}{dt}$.\n\nUsing only the conservation of mass and the definition of extent of reaction, derive the relationship between $r_i$ and $r$ in terms of $\\nu_i$. Then, for the calcite dissolution reaction above, a reactive transport simulation reports a forward volumetric reaction rate $r = 3.26815 \\times 10^{-7}$ mol m$^{-3}$ s$^{-1}$. Compute the volumetric production rate of aqueous calcium $r_{\\mathrm{Ca}^{2+}}$ consistent with the stated sign convention. Express your final numerical answer in mol m$^{-3}$ s$^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem is validated as being scientifically grounded, well-posed, and objective. It is based on the fundamental principles of chemical kinetics and stoichiometry as applied in geochemistry. All definitions are standard, and the required data are provided, making the problem solvable.\n\nThe problem asks for two things: first, to derive a general relationship between the volumetric production rate of a species $i$, denoted as $r_i$, and the overall volumetric reaction rate, $r$, using the stoichiometric coefficient $\\nu_i$; second, to apply this relationship to calculate the production rate of aqueous calcium, $r_{\\mathrm{Ca}^{2+}}$, for a specific reaction.\n\nThe fundamental relationship between the change in the number of moles of a species $i$, $n_i$, and the extent of reaction, $\\xi$, is defined by the stoichiometry of the reaction. For a differential change in the extent of reaction, $d\\xi$, the corresponding differential change in the moles of species $i$, $dn_i$, is given by:\n$$dn_i = \\nu_i d\\xi$$\nwhere $\\nu_i$ is the stoichiometric coefficient of species $i$. This equation is a direct consequence of the law of conservation of mass as expressed through reaction stoichiometry.\n\nTo relate this to the rates of reaction, we differentiate with respect to time, $t$:\n$$\\frac{dn_i}{dt} = \\nu_i \\frac{d\\xi}{dt}$$\nThe problem defines the volumetric rate of production of species $i$ as $r_i = \\frac{1}{V}\\frac{dn_i}{dt}$ and the overall volumetric reaction rate as $r = \\frac{1}{V}\\frac{d\\xi}{dt}$, where $V$ is the constant volume of the aqueous solution. Assuming a constant volume $V$, we can divide the previous equation by $V$:\n$$\\frac{1}{V}\\frac{dn_i}{dt} = \\nu_i \\left(\\frac{1}{V}\\frac{d\\xi}{dt}\\right)$$\nSubstituting the definitions of $r_i$ and $r$ into this equation gives the general relationship:\n$$r_i = \\nu_i r$$\nThis is the first part of the required derivation. It shows that the rate of production or consumption of any species is directly proportional to the overall reaction rate, with the proportionality constant being the species' stoichiometric coefficient.\n\nNext, we apply this result to the specific calcite dissolution reaction:\n$$\\mathrm{CaCO_3(s)} + \\mathrm{CO_2(aq)} + \\mathrm{H_2O(l)} \\rightarrow \\mathrm{Ca}^{2+}\\text{(aq)} + 2\\,\\mathrm{HCO_3^{-}}\\text{(aq)}$$\nWe are tasked with computing the volumetric production rate of aqueous calcium, $r_{\\mathrm{Ca}^{2+}}$. The species $i$ is therefore $\\mathrm{Ca}^{2+}$.\n\nFrom the balanced chemical equation, we determine the stoichiometric coefficient for $\\mathrm{Ca}^{2+}$. The species $\\mathrm{Ca}^{2+}$ is a product, and its stoichiometric number is $1$. Following the sign convention given in the problem statement ($\\nu_i > 0$ for products), the stoichiometric coefficient is $\\nu_{\\mathrm{Ca}^{2+}} = +1$.\n\nThe problem states that the forward volumetric reaction rate is $r = 3.26815 \\times 10^{-7} \\, \\text{mol m}^{-3} \\text{s}^{-1}$.\n\nUsing the derived relationship $r_i = \\nu_i r$, we can now calculate $r_{\\mathrm{Ca}^{2+}}$:\n$$r_{\\mathrm{Ca}^{2+}} = \\nu_{\\mathrm{Ca}^{2+}} \\cdot r$$\nSubstituting the known values:\n$$r_{\\mathrm{Ca}^{2+}} = (+1) \\cdot (3.26815 \\times 10^{-7} \\, \\text{mol m}^{-3} \\text{s}^{-1})$$\n$$r_{\\mathrm{Ca}^{2+}} = 3.26815 \\times 10^{-7} \\, \\text{mol m}^{-3} \\text{s}^{-1}$$\nThe problem requires the final answer to be rounded to four significant figures. The fifth significant digit is $1$, which is less than $5$, so we round down.\n$$r_{\\mathrm{Ca}^{2+}} \\approx 3.268 \\times 10^{-7} \\, \\text{mol m}^{-3} \\text{s}^{-1}$$",
            "answer": "$$\\boxed{3.268 \\times 10^{-7}}$$"
        },
        {
            "introduction": "While differential rate laws describe instantaneous reaction speed, integrated rate laws tell us how concentrations evolve over time. This exercise explores a common and powerful simplification in geochemistry: the pseudo-first-order approximation, which applies when one reactant's concentration is effectively constant. Mastering this concept  is key to building tractable models for complex systems where reactants are supplied by large reservoirs, such as gas-liquid exchange or mineral dissolution.",
            "id": "4096828",
            "problem": "In a well-mixed aqueous microdomain representing a porewater control volume in a sediment column, a bimolecular reaction converts a dissolved reactant $A$ and a dissolved oxidant $B$ to an inert product $P$ according to $A + B \\to P$. Assume the following physically justified conditions:\n\n- The mass-action rate law for the elementary step holds with activities approximated by concentrations under dilute conditions, so the volumetric rate of progress satisfies $r = k[A][B]$, where $k$ is a temperature-independent rate constant over the time window of interest.\n- The oxidant $B$ is buffered by rapid exchange with a large external reservoir (for example, gas-liquid exchange with an overlying atmosphere), maintaining $[B](t) = B_0$ exactly constant in time within the control volume.\n- The system is closed with respect to $A$ and $P$ (no advective inflow or outflow), and the solution remains isothermal so that $k$ is constant.\n\nStarting from the differential form of the rate law and species balances implied by mass action kinetics, derive a closed-form analytical expression for the time required to reduce the concentration of $A$ from its initial value $[A](0) = A_0$ to $[A](t) = A_0/2$. Express your final result as a simplified analytic expression in terms of $k$ and $B_0$ only. If evaluated numerically, the time should be reported in seconds. Do not substitute numerical values. Do not include units in the final boxed answer.",
            "solution": "The user-provided problem statement has been validated and found to be scientifically grounded, well-posed, objective, and internally consistent. It represents a standard problem in chemical kinetics, specifically a pseudo-first-order reaction scenario. The solution process may proceed.\n\nThe problem specifies a bimolecular elementary reaction $A + B \\to P$. According to the principle of mass-action kinetics, the rate of change of the concentration of reactant $A$, denoted as $[A]$, is related to the volumetric rate of progress of the reaction, $r$, by its stoichiometric coefficient, which is $-1$.\n$$\n\\frac{d[A]}{dt} = -r\n$$\nThe rate law is given as $r = k[A][B]$, where $k$ is the second-order rate constant, $[A]$ is the concentration of reactant $A$, and $[B]$ is the concentration of reactant $B$. Substituting the rate law into the species balance for $A$ yields the governing differential equation:\n$$\n\\frac{d[A]}{dt} = -k[A][B]\n$$\nA critical condition provided is that the concentration of reactant $B$ is held constant over time due to buffering, such that $[B](t) = B_0$ for all $t \\ge 0$. Substituting this condition into the differential equation simplifies the system:\n$$\n\\frac{d[A]}{dt} = -k[A]B_0\n$$\nThis equation describes a pseudo-first-order reaction because the product of the true second-order rate constant $k$ and the constant concentration $B_0$ behaves as a single pseudo-first-order rate constant. Let us define this constant as $k' = k B_0$. The differential equation becomes:\n$$\n\\frac{d[A]}{dt} = -k'[A]\n$$\nThis is a first-order, linear, homogeneous ordinary differential equation. It can be solved by the method of separation of variables. Rearranging the equation to separate the variables $[A]$ and $t$ gives:\n$$\n\\frac{1}{[A]} d[A] = -k' dt = -k B_0 dt\n$$\nTo find the concentration of $A$ as a function of time, we integrate this equation from the initial state (at time $t=0$, where the concentration is $[A](0) = A_0$) to an arbitrary state (at time $t$, where the concentration is $[A](t)$).\n$$\n\\int_{A_0}^{[A](t)} \\frac{1}{[A]} d[A] = \\int_0^t -k B_0 dt\n$$\nThe integral on the left side is the natural logarithm of the concentration:\n$$\n\\left[ \\ln([A]) \\right]_{A_0}^{[A](t)} = \\ln([A](t)) - \\ln(A_0) = \\ln\\left(\\frac{[A](t)}{A_0}\\right)\n$$\nThe integral on the right side is:\n$$\n-k B_0 \\int_0^t dt = -k B_0 [t]_0^t = -k B_0 t\n$$\nEquating the two results gives the integrated rate law:\n$$\n\\ln\\left(\\frac{[A](t)}{A_0}\\right) = -k B_0 t\n$$\nThe problem asks for the specific time, which we can denote as $t_{1/2}$, required for the concentration of $A$ to be reduced to half of its initial value. This condition is expressed as $[A](t_{1/2}) = A_0/2$. We substitute this into the integrated rate law:\n$$\n\\ln\\left(\\frac{A_0/2}{A_0}\\right) = -k B_0 t_{1/2}\n$$\nSimplifying the argument of the logarithm:\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -k B_0 t_{1/2}\n$$\nUsing the logarithmic identity $\\ln(1/x) = -\\ln(x)$, we have:\n$$\n-\\ln(2) = -k B_0 t_{1/2}\n$$\nFinally, we solve for the time $t_{1/2}$ by dividing by $-k B_0$:\n$$\nt_{1/2} = \\frac{\\ln(2)}{k B_0}\n$$\nThis is the closed-form analytical expression for the half-life of reactant $A$ under the specified pseudo-first-order conditions, expressed solely in terms of the given constants $k$ and $B_0$.",
            "answer": "$$\\boxed{\\frac{\\ln(2)}{k B_0}}$$"
        },
        {
            "introduction": "Analytical solutions for kinetic systems are rare in real-world geochemistry, where processes like transport and reaction are coupled and often mathematically \"stiff\". This hands-on coding practice dives into the heart of computational geochemistry by challenging you to implement and compare numerical methods for solving such problems. By evaluating the accuracy of an operator-splitting technique against a fully coupled solution, you will develop critical insights into the trade-offs between computational efficiency and accuracy in modern geochemical modeling .",
            "id": "4096819",
            "problem": "You are tasked with constructing, analyzing, and computing the accuracy of an operator-splitting method versus a fully coupled solution for a stiff reactive transport problem in a well-mixed geochemical reactor. The context is a continuously stirred tank reactor (CSTR) representing a single control volume of a one-dimensional reactive transport system. Two aqueous species, $C$ (for example, dissolved calcium) and $D$ (for example, dissolved carbonate), can precipitate as a solid phase $S$ via the reaction $C + D \\rightarrow S$ when supersaturated relative to a specified solubility. The goal is to evaluate the operator-splitting error as a function of the time step $\\Delta t$ and kinetic coupling strength.\n\nFoundational base:\n- Conservation of mass for a continuously stirred tank reactor (CSTR) with inflow and outflow at residence time $\\tau$.\n- Deterministic Ordinary Differential Equations (ODEs) based on mass action kinetics and transport laws.\n- Supersaturation-driven kinetic precipitation governed by a rate law that depends on the saturation index.\n- Numerical integration with a stiff solver for the fully coupled system and a sequential operator-splitting scheme.\n\nModel specification:\n- Aqueous species concentrations $C(t)$ and $D(t)$ are in $\\mathrm{mol/L}$, and solid $S(t)$ is in $\\mathrm{mol/L}$ (as a volumetric equivalent of precipitated mass per unit volume).\n- Inflow concentrations are constant: $C_{\\mathrm{in}}$ and $D_{\\mathrm{in}}$ in $\\mathrm{mol/L}$.\n- Residence time is $\\tau$ in $\\mathrm{s}$.\n- Solubility product is $K_{\\mathrm{sp}}$ in $\\mathrm{mol^2/L^2}$.\n- Precipitation rate law is $r(t) = k \\,\\max\\left( C(t) D(t) - K_{\\mathrm{sp}}, 0 \\right)$ with $k$ in $\\mathrm{L/(mol\\cdot s)}$; dissolution is neglected (no negative rate).\n- The fully coupled ODE system is\n$$\n\\frac{dC}{dt} = \\frac{C_{\\mathrm{in}} - C}{\\tau} - r(t), \\quad\n\\frac{dD}{dt} = \\frac{D_{\\mathrm{in}} - D}{\\tau} - r(t), \\quad\n\\frac{dS}{dt} = r(t).\n$$\n- Initial conditions are $C(0) = 0$, $D(0) = 0$, $S(0) = 0$.\n\nOperator splitting to be implemented:\n- Sequential Strang-like first-order splitting over each time step $\\Delta t$, consisting of:\n  1. A transport-only substep of duration $\\Delta t$ with $r(t)=0$.\n  2. A reaction-only substep of duration $\\Delta t$ with transport turned off (no inflow/outflow terms).\n- For the transport-only substep in a CSTR, use the exact solution of the linear transport ODE for $C$ and $D$.\n- For the reaction-only substep, use backward Euler time discretization to update $C$, $D$, and $S$ while enforcing nonnegativity and the precipitation-only constraint $r \\ge 0$.\n- You must ensure the reaction-only substep conserves stoichiometry in the sense that the consumption of $C$ and $D$ is equal and increases $S$ by the same amount during that substep.\n\nAccuracy evaluation:\n- For each test case, compute the reference fully coupled solution over a fixed horizon $T$ using a stiff ODE integrator, then compute the operator-splitting solution over the same horizon $T$ using a fixed time step $\\Delta t$. Report the absolute errors in the final concentrations as $|C_{\\mathrm{split}}(T) - C_{\\mathrm{ref}}(T)|$, $|D_{\\mathrm{split}}(T) - D_{\\mathrm{ref}}(T)|$, and $|S_{\\mathrm{split}}(T) - S_{\\mathrm{ref}}(T)|$.\n\nParameters and units:\n- Use $C_{\\mathrm{in}} = 1 \\times 10^{-3}\\,\\mathrm{mol/L}$, $D_{\\mathrm{in}} = 1 \\times 10^{-3}\\,\\mathrm{mol/L}$, $\\tau = 300\\,\\mathrm{s}$, $K_{\\mathrm{sp}} = 2 \\times 10^{-7}\\,\\mathrm{mol^2/L^2}$, and $T = 3600\\,\\mathrm{s}$.\n- The coupling strength is characterized by the kinetic constant $k$ in $\\mathrm{L/(mol\\cdot s)}$.\n- All reported errors must be expressed as decimal floats in $\\mathrm{mol/L}$.\n\nTest suite:\n- Case $1$: $\\Delta t = 10\\,\\mathrm{s}$, $k = 1 \\times 10^{-1}\\,\\mathrm{L/(mol\\cdot s)}$ (moderate time step with slow reaction).\n- Case $2$: $\\Delta t = 100\\,\\mathrm{s}$, $k = 10\\,\\mathrm{L/(mol\\cdot s)}$ (stiff reaction with moderate time step).\n- Case $3$: $\\Delta t = 600\\,\\mathrm{s}$, $k = 10\\,\\mathrm{L/(mol\\cdot s)}$ (stiff reaction with large time step).\n- Case $4$: $\\Delta t = 0.5\\,\\mathrm{s}$, $k = 1 \\times 10^{-3}\\,\\mathrm{L/(mol\\cdot s)}$ (very small time step with very slow reaction).\n\nNumerical requirements:\n- The fully coupled solution must be computed with a stiff integrator capable of handling large $k$ and rapid transients.\n- The operator-splitting solution must use the exact CSTR transport update for the transport-only substep and backward Euler for the reaction-only substep to ensure stability under stiffness.\n- Enforce $C \\ge 0$, $D \\ge 0$, and $S \\ge 0$ at all times.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list holding the three errors $[|C_{\\mathrm{split}}(T) - C_{\\mathrm{ref}}(T)|,|D_{\\mathrm{split}}(T) - D_{\\mathrm{ref}}(T)|,|S_{\\mathrm{split}}(T) - S_{\\mathrm{ref}}(T)|]$ for the corresponding test case. For example, the output should look like $[[e_{C,1},e_{D,1},e_{S,1}],[e_{C,2},e_{D,2},e_{S,2}],\\dots]$, where each $e_{\\cdot,i}$ is a decimal float in $\\mathrm{mol/L}$.",
            "solution": "The problem is valid. It presents a well-posed, scientifically grounded task in computational geochemistry, specifically evaluating the accuracy of an operator-splitting method for a stiff reactive transport problem. All necessary parameters, equations, and numerical procedures are clearly defined.\n\nThe solution will be structured in three main parts:\n1.  A function to compute the reference solution for the fully coupled system of Ordinary Differential Equations (ODEs) using a stiff solver.\n2.  A function to compute the approximate solution using the specified sequential operator-splitting scheme.\n3.  A main routine to execute both computations for each test case, calculate the absolute errors, and format the results as required.\n\n### 1. Fully Coupled Reference Solution\n\nThe state of the system is described by the vector $Y(t) = [C(t), D(t), S(t)]^T$. The governing system of ODEs is:\n$$\n\\frac{dY}{dt} = f(t, Y)\n$$\nwhere\n$$\n\\begin{align*}\n\\frac{dC}{dt} &= \\frac{C_{\\mathrm{in}} - C}{\\tau} - r(t) \\\\\n\\frac{dD}{dt} &= \\frac{D_{\\mathrm{in}} - D}{\\tau} - r(t) \\\\\n\\frac{dS}{dt} &= r(t)\n\\end{align*}\n$$\nThe reaction rate $r(t)$ is given by $r(t) = k \\cdot \\max(C(t)D(t) - K_{\\mathrm{sp}}, 0)$. This is a stiff system, particularly for large values of the rate constant $k$. We will use the `scipy.integrate.solve_ivp` function with the `'Radau'` method, which is an implicit Runge-Kutta method suitable for stiff problems. The solver will be run from $t=0$ to $t=T$ with initial conditions $Y(0) = [0, 0, 0]^T$. The high-accuracy result from this solver at $t=T$ will serve as our reference solution, $[C_{\\mathrm{ref}}(T), D_{\\mathrm{ref}}(T), S_{\\mathrm{ref}}(T)]$.\n\n### 2. Operator-Splitting Solution\n\nThe operator-splitting method decouples the transport and reaction processes over a small time step $\\Delta t$. We will use a sequential non-iterative (Lie-Trotter) splitting scheme. For each time step from $t_i$ to $t_{i+1} = t_i + \\Delta t$, we perform two substeps:\n\n**Substep A: Transport-Only**\nFirst, we solve the transport-only equations for a duration of $\\Delta t$:\n$$\n\\frac{dC}{dt} = \\frac{C_{\\mathrm{in}} - C}{\\tau}, \\quad \\frac{dD}{dt} = \\frac{D_{\\mathrm{in}} - D}{\\tau}, \\quad \\frac{dS}{dt} = 0\n$$\nStarting from the state $[C_i, D_i, S_i]$ at time $t_i$, these linear ODEs have an exact analytical solution. The state after the transport substep, denoted by $[C^*, D^*, S^*]$, is:\n$$\n\\begin{align*}\nC^* &= C_{\\mathrm{in}} + (C_i - C_{\\mathrm{in}}) e^{-\\Delta t/\\tau} \\\\\nD^* &= D_{\\mathrm{in}} + (D_i - D_{\\mathrm{in}}) e^{-\\Delta t/\\tau} \\\\\nS^* &= S_i\n\\end{align*}\n$$\n\n**Substep B: Reaction-Only**\nNext, we solve the reaction-only equations for a duration of $\\Delta t$, starting from the intermediate state $[C^*, D^*, S^*]$:\n$$\n\\frac{dC}{dt} = -r(t), \\quad \\frac{dD}{dt} = -r(t), \\quad \\frac{dS}{dt} = r(t)\n$$\nWe use the backward (implicit) Euler method for stability. Let $\\Delta C_{\\mathrm{rxn}}$ be the total amount of $C$ (and $D$) consumed by the reaction over the time step $\\Delta t$. The state at time $t_{i+1}$ is then $C_{i+1} = C^* - \\Delta C_{\\mathrm{rxn}}$, $D_{i+1} = D^* - \\Delta C_{\\mathrm{rxn}}$, and $S_{i+1} = S^* + \\Delta C_{\\mathrm{rxn}}$. The backward Euler discretization for $C$ is:\n$$\n\\frac{C_{i+1} - C^*}{\\Delta t} = -r(t_{i+1}) \\implies \\frac{-(C^* - C_{i+1})}{\\Delta t} = -k \\cdot \\max(C_{i+1}D_{i+1} - K_{\\mathrm{sp}}, 0)\n$$\nSubstituting the expressions for $C_{i+1}$ and $D_{i+1}$ in terms of $\\Delta C_{\\mathrm{rxn}}$:\n$$\n\\frac{\\Delta C_{\\mathrm{rxn}}}{\\Delta t} = k \\cdot \\max((C^* - \\Delta C_{\\mathrm{rxn}})(D^* - \\Delta C_{\\mathrm{rxn}}) - K_{\\mathrm{sp}}, 0)\n$$\nIf the ion activity product after transport, $IAP = C^*D^*$, is less than or equal to $K_{\\mathrm{sp}}$, no reaction occurs, and $\\Delta C_{\\mathrm{rxn}} = 0$. If $IAP > K_{\\mathrm{sp}}$, we must solve for $\\Delta C_{\\mathrm{rxn}} > 0$:\n$$\n\\frac{\\Delta C_{\\mathrm{rxn}}}{k \\Delta t} = (C^* - \\Delta C_{\\mathrm{rxn}})(D^* - \\Delta C_{\\mathrm{rxn}}) - K_{\\mathrm{sp}}\n$$\nThis rearranges into a quadratic equation for $\\Delta C_{\\mathrm{rxn}}$:\n$$\n(\\Delta C_{\\mathrm{rxn}})^2 - \\left( C^* + D^* + \\frac{1}{k \\Delta t} \\right) \\Delta C_{\\mathrm{rxn}} + (C^*D^* - K_{\\mathrm{sp}}) = 0\n$$\nThis is of the form $a x^2 + b x + c = 0$ with $x = \\Delta C_{\\mathrm{rxn}}$, $a=1$, $b = -(C^* + D^* + 1/(k \\Delta t))$, and $c = C^*D^* - K_{\\mathrm{sp}}$. The physically meaningful solution is the smaller of the two positive roots, which can be found reliably using the formula $x = 2c / (-b + \\sqrt{b^2 - 4ac})$. We must also enforce the physical constraint that concentrations cannot become negative, so $\\Delta C_{\\mathrm{rxn}} \\le \\min(C^*, D^*)$.\n\nThis process is repeated for $N = T/\\Delta t$ steps to obtain the final state $[C_{\\mathrm{split}}(T), D_{\\mathrm{split}}(T), S_{\\mathrm{split}}(T)]$.\n\n### 3. Error Calculation\n\nFor each test case defined by a set of parameters $(\\Delta t, k)$, we will compute both $Y_{\\mathrm{ref}}(T)$ and $Y_{\\mathrm{split}}(T)$. The absolute error vector is then calculated as $|Y_{\\mathrm{split}}(T) - Y_{\\mathrm{ref}}(T)|$. The final output will be a list containing these error vectors for all test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Constructs, analyzes, and computes the accuracy of an operator-splitting method\n    versus a fully coupled solution for a stiff reactive transport problem.\n    \"\"\"\n\n    # General parameters from the problem statement\n    C_in = 1e-3  # mol/L\n    D_in = 1e-3  # mol/L\n    tau = 300.0  # s\n    K_sp = 2e-7  # mol^2/L^2\n    T = 3600.0   # s\n    y0 = [0.0, 0.0, 0.0]  # Initial conditions [C(0), D(0), S(0)]\n\n    # Test cases from the problem statement\n    test_cases = [\n        {'dt': 10.0, 'k': 1e-1},  # Case 1\n        {'dt': 100.0, 'k': 10.0}, # Case 2\n        {'dt': 600.0, 'k': 10.0}, # Case 3\n        {'dt': 0.5, 'k': 1e-3}    # Case 4\n    ]\n\n    def compute_reference_solution(k_val):\n        \"\"\"\n        Computes the reference solution using a stiff ODE solver for the\n        fully coupled system.\n        \"\"\"\n        def ode_system(t, y, k):\n            C, D, S = y\n            # Ensure non-negativity for physical realism during intermediate steps\n            C = max(0.0, C)\n            D = max(0.0, D)\n            \n            dydt = np.zeros(3)\n            \n            transport_C = (C_in - C) / tau\n            transport_D = (D_in - D) / tau\n            \n            ion_product = C * D\n            rate = 0.0\n            if ion_product > K_sp:\n                rate = k * (ion_product - K_sp)\n            \n            dydt[0] = transport_C - rate\n            dydt[1] = transport_D - rate\n            dydt[2] = rate\n            \n            return dydt\n\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, T],\n            y0=y0,\n            method='Radau',\n            args=(k_val,),\n            dense_output=True,\n            atol=1e-12, # Strict tolerances for a high-quality reference\n            rtol=1e-9\n        )\n        return sol.sol(T)\n\n    def compute_split_solution(k_val, dt_val):\n        \"\"\"\n        Computes the solution using the sequential operator-splitting method.\n        \"\"\"\n        y = np.array(y0, dtype=float)\n        num_steps = int(round(T / dt_val))\n\n        for _ in range(num_steps):\n            # 1. Transport-only substep (exact solution)\n            C_i, D_i, S_i = y\n            exp_term = np.exp(-dt_val / tau)\n            C_star = C_in + (C_i - C_in) * exp_term\n            D_star = D_in + (D_i - D_in) * exp_term\n            S_star = S_i\n\n            # 2. Reaction-only substep (Backward Euler)\n            ion_product = C_star * D_star\n            delta_C_rxn = 0.0\n\n            if ion_product > K_sp:\n                # Solve quadratic equation for Delta_C_rxn\n                # a*x^2 + b*x + c = 0 where x = delta_C_rxn\n                a = 1.0\n                b = -(C_star + D_star + 1.0 / (k_val * dt_val))\n                c = ion_product - K_sp\n                \n                discriminant = b**2 - 4 * a * c\n                \n                if discriminant >= 0:\n                    # Use numerically stable formula for smaller root\n                    # x_small = 2c / (-b + sqrt(b^2 - 4ac))\n                    sqrt_discriminant = np.sqrt(discriminant)\n                    denominator = -b + sqrt_discriminant\n                    if denominator > 0:\n                        delta_C_rxn_unconstrained = (2.0 * c) / denominator\n                    else:\n                        # This case is unlikely given the problem physics\n                        delta_C_rxn_unconstrained = 0.0\n                else:\n                    # Discriminant should not be negative based on analysis\n                    delta_C_rxn_unconstrained = 0.0\n\n                # Enforce non-negativity constraint\n                delta_C_rxn = min(delta_C_rxn_unconstrained, C_star, D_star)\n\n            # Update state vector\n            y[0] = C_star - delta_C_rxn\n            y[1] = D_star - delta_C_rxn\n            y[2] = S_star + delta_C_rxn\n\n        return y\n\n    all_errors = []\n    for params in test_cases:\n        k = params['k']\n        dt = params['dt']\n        \n        # Compute both solutions\n        y_ref = compute_reference_solution(k)\n        y_split = compute_split_solution(k, dt)\n        \n        # Calculate absolute errors\n        errors = np.abs(y_split - y_ref).tolist()\n        all_errors.append(errors)\n    \n    # Format the output as specified\n    sublist_strings = [f\"[{e_c},{e_d},{e_s}]\" for e_c, e_d, e_s in all_errors]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}