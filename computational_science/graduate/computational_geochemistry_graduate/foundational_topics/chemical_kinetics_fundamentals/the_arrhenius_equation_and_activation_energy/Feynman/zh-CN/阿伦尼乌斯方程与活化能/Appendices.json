{
    "hands_on_practices": [
        {
            "introduction": "在进行任何计算地球化学模拟之前，确保模型方程的量纲一致性是避免基本错误的关键第一步。本练习将引导你通过严格的量纲分析，推导任意级数$n$反应中指前因子$A$的单位，这是构建可靠动力学模型的基础技能。这种方法对于在编写代码或设置模型时验证物理量的正确性至关重要。",
            "id": "4103253",
            "problem": "在一个均相含水地球化学系统中，考虑一种溶解物质的单步转化，其速率定律基于物质的量浓度。设浓度为 $C(t)$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，宏观消耗速率定义为 $r(t) = -\\,\\mathrm{d}C/\\mathrm{d}t$，其中 $r$ 的单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。假设反应相对于 $C$ 遵循 $n$ 级定律，因此 $r(t) = k(T)\\,C(t)^{n}$，其中 $k(T)$ 是与温度相关的速率系数。在数值模拟中，$k(T)$ 使用阿伦尼乌斯表达式 $k(T) = A\\,\\exp\\!\\big(-E_{a}/(R\\,T)\\big)$ 进行建模，其中 $E_{a}$ 是活化能，$R$ 是通用气体常数，$T$ 是绝对温度。假设 $E_{a}$ 的单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$R$ 的单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$T$ 的单位为 $\\mathrm{K}$，且数值实现使用国际单位制（SI）的基本单位。\n\n从速率 $r$ 和浓度 $C$ 的基本定义出发，推导量纲指数 $\\alpha(n)$、$\\beta(n)$ 和 $\\gamma(n)$，使得指前因子 $A$ 的单位形式为 $\\mathrm{mol}^{\\alpha(n)}\\,\\mathrm{m}^{\\beta(n)}\\,\\mathrm{s}^{\\gamma(n)}$。您的推导必须证明阿伦尼乌斯表达式中指数的自变量是无量纲的，并且必须明确说明在所述测量框架下，$A$ 的量纲是如何从 $n$ 级速率定律中产生的。\n\n此外，阐述一个基于量纲分析和基本单位一致使用的严谨程序，该程序可应用于计算地球化学模拟中，以验证当反应级数 $n$ 可能为非整数时，所实现的 $k(T)$ 和 $A$ 的单位一致性。该程序应足够详细，以便在模拟运行前，仅使用 $r$、$C$、$E_{a}$、$R$ 和 $T$ 的已声明单位即可执行。\n\n将量纲指数的最终结果以有序三元组 $(\\alpha(n), \\beta(n), \\gamma(n))$ 的封闭解析形式表示。不需要进行数值计算，最终表达式中不应出现任何单位。",
            "solution": "所述问题具有科学依据、提法恰当、客观且内部一致。它提出了一个化学动力学和计算科学领域中标准的、非平凡的问题，需要严格应用量纲分析。所有必要信息均已提供。因此，该问题是有效的，并将提供解答。\n\n分析始于量纲齐次性原理，该原理要求一个有效的物理方程中的每一项都必须具有相同的量纲。给定消耗浓度为 $C$ 的物质的 $n$ 级速率定律：\n$$r(t) = k(T)\\,C(t)^{n}$$\n其中 $r(t) = -\\frac{\\mathrm{d}C}{\\mathrm{d}t}$。\n\n令 $[X]$ 表示量 $X$ 的量纲。问题指定了在国际单位制（SI）中浓度和速率的基本单位。设基本量纲为物质的量（$\\mathrm{N}$）、长度（$\\mathrm{L}$）和时间（$\\mathrm{T}$）。\n浓度 $C$ 的单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，因此其量纲为：\n$$[C] = \\frac{\\mathrm{N}}{\\mathrm{L}^{3}} = \\mathrm{N}\\,\\mathrm{L}^{-3}$$\n消耗速率 $r$ 的单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，因此其量纲为：\n$$[r] = \\frac{\\mathrm{N}}{\\mathrm{L}^{3}\\,\\mathrm{T}} = \\mathrm{N}\\,\\mathrm{L}^{-3}\\,\\mathrm{T}^{-1}$$\n将量纲齐次性原理应用于速率定律，我们得到：\n$$[r] = [k(T)]\\,[C]^{n}$$\n我们可以解出速率系数的量纲 $[k(T)]$：\n$$[k(T)] = \\frac{[r]}{[C]^{n}}$$\n代入 $r$ 和 $C$ 的量纲：\n$$[k(T)] = \\frac{\\mathrm{N}\\,\\mathrm{L}^{-3}\\,\\mathrm{T}^{-1}}{(\\mathrm{N}\\,\\mathrm{L}^{-3})^{n}} = \\frac{\\mathrm{N}\\,\\mathrm{L}^{-3}\\,\\mathrm{T}^{-1}}{\\mathrm{N}^{n}\\,\\mathrm{L}^{-3n}}$$\n通过应用指数定律，我们得到 $k(T)$ 的量纲：\n$$[k(T)] = \\mathrm{N}^{1-n}\\,\\mathrm{L}^{-3 - (-3n)}\\,\\mathrm{T}^{-1} = \\mathrm{N}^{1-n}\\,\\mathrm{L}^{3n-3}\\,\\mathrm{T}^{-1}$$\n接下来，我们考虑速率系数与温度相关的阿伦尼乌斯表达式：\n$$k(T) = A\\,\\exp\\!\\left(-\\frac{E_{a}}{R\\,T}\\right)$$\n一个基本的数学原理是，任何超越函数（如指数函数 $\\exp(x)$）的自变量都必须是无量纲的。我们必须验证自变量 $-\\frac{E_{a}}{R\\,T}$ 的量纲是否如此。问题提供了所涉及各量的单位：\n-   活化能 $E_{a}$：$\\mathrm{J}\\,\\mathrm{mol}^{-1}$\n-   通用气体常数 $R$：$\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n-   绝对温度 $T$：$\\mathrm{K}$\n\n因此，自变量的量纲为：\n$$\\left[\\frac{E_{a}}{R\\,T}\\right] = \\frac{[\\mathrm{J}\\,\\mathrm{mol}^{-1}]}{[\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}] \\cdot [\\mathrm{K}]} = \\frac{\\mathrm{J}\\,\\mathrm{mol}^{-1}}{\\mathrm{J}\\,\\mathrm{mol}^{-1}} = 1$$\n自变量确实是无量纲的，这证实了阿伦尼乌斯表达式的一致性。由于指数项 $\\exp(-E_{a}/(RT))$ 是一个无量纲因子，速率系数 $k(T)$ 的量纲必须与指前因子 $A$ 的量纲相同。\n$$[A] = [k(T)] = \\mathrm{N}^{1-n}\\,\\mathrm{L}^{3n-3}\\,\\mathrm{T}^{-1}$$\n问题要求将 $A$ 的单位表示为 $\\mathrm{mol}^{\\alpha(n)}\\,\\mathrm{m}^{\\beta(n)}\\,\\mathrm{s}^{\\gamma(n)}$ 的形式。通过将量纲符号映射回其对应的 SI 基本单位（$\\mathrm{N} \\to \\mathrm{mol}$，$\\mathrm{L} \\to \\mathrm{m}$，$\\mathrm{T} \\to \\mathrm{s}$），我们可以确定这些指数：\n-   摩尔（$\\mathrm{mol}$）的指数是 $\\alpha(n) = 1 - n$。\n-   米（$\\mathrm{m}$）的指数是 $\\beta(n) = 3n - 3$。\n-   秒（$\\mathrm{s}$）的指数是 $\\gamma(n) = -1$。\n\n这样就完成了量纲指数的推导。\n\n任务的第二部分是阐述一个严谨的程序，用于在计算地球化学模拟中验证单位一致性，特别是当反应级数 $n$ 为非整数时。这样的程序可以作为模拟前检查来实现，以防止因物理单位不一致而产生的错误。\n\n一个严谨的程序如下：\n1.  **建立基本单位系统：** 为模型所需的基本量纲定义基本单位。对于本问题，这些是物质的量（$\\mathrm{U_{N}}$）、长度（$\\mathrm{U_{L}}$）和时间（$\\mathrm{U_{T}}$）。在问题的背景下，它们分别是 $\\mathrm{mol}$、$\\mathrm{m}$ 和 $\\mathrm{s}$。\n2.  **声明输入参数单位：** 对于给定的反应，模拟代码必须能访问所有相关输入参数的已声明单位：\n    -   浓度 $C$：单位 $[C]_{decl}$。\n    -   速率 $r$：单位 $[r]_{decl}$。\n    -   活化能 $E_a$：单位 $[E_a]_{decl}$。\n    -   气体常数 $R$：单位 $[R]_{decl}$。\n    -   温度 $T$：单位 $[T]_{decl}$。\n    -   指前因子 $A$：单位 $[A]_{decl}$。\n    -   反应级数 $n$（一个无量纲的标量）。\n3.  **验证指数自变量的无量纲性：** 构建阿伦尼乌斯指数自变量的单位表达式 $\\frac{[E_a]_{decl}}{[R]_{decl} \\cdot [T]_{decl}}$。对该表达式进行代数化简。最终结果必须是无量纲的（即等价于 $1$）。如果不是，则必须因热力学参数单位不一致而停止模拟，并报告错误。\n4.  **推导指前因子的所需单位：** 基于 $n$ 级速率定律，推导速率系数 $k$ 的量纲正确的单位，从而也得到 $A$ 的单位。这是验证的核心。$A$ 的所需单位是 $[A]_{req} = \\frac{[r]_{decl}}{([C]_{decl})^{n}}$。通过代入已声明的速率和浓度单位来计算此表达式。对于给定的问题，这将是：\n    $$[A]_{req} = \\frac{\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}}{(\\mathrm{mol}\\,\\mathrm{m}^{-3})^{n}} = (\\mathrm{mol})^{1-n}\\,(\\mathrm{m})^{3n-3}\\,(\\mathrm{s})^{-1}$$\n    这一步对任何实数 $n$ 都有效，因为量纲分析允许单位上存在非整数指数。\n5.  **比较和验证：** 将指前因子的已声明单位 $[A]_{decl}$ 与上一步推导出的所需单位 $[A]_{req}$进行比较。两者必须完全相同。如果 $[A]_{decl} \\neq [A]_{req}$，则动力学参数与指定的速率定律不一致，必须停止模拟，并显示错误消息指出差异。例如，如果 $n=2$，则 $A$ 的所需单位为 $(\\mathrm{mol})^{-1}\\,(\\mathrm{m})^{3}\\,(\\mathrm{s})^{-1}$。如果用户为 $A$ 提供了任何其他单位，检查将失败。\n6.  **用速率定律进行确认：** 作为最后检查，可以通过确保 $[A]_{req} \\cdot ([C]_{decl})^{n}$ 能精确化简为 $[r]_{decl}$ 来确认内部一致性。此步骤在算法上等同于步骤4，但可作为对推导本身进行稳健验证的方法。\n\n此程序提供了一个完整、可自动化且严谨的方法，用以在计算地球化学框架内进行任何数值积分之前，确保速率计算中的量纲一致性。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 - n  3n - 3  -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "计算地球化学的一个核心任务是从实验测量中确定活化能等关键模型参数。本练习将演示如何构建一个结合了温度和化学饱和度效应的反应速率模型，并应用多元线性回归技术从实验数据中估算活化能$E_a$、指前因子$A$以及反应级数$n$ 。掌握此方法将使你能够将原始实验数据转化为有意义的动力学参数。",
            "id": "4103248",
            "problem": "一个计算地球化学实验室在受控的水溶液条件下，测量了多个温度和饱和状态下的表面归一化方解石沉淀速率。沉淀速率依赖于温度 $T$（单位为 $\\mathrm{K}$），通过一个具有能垒的活化过程；同时依赖于饱和状态 $\\Omega$，通过一个非线性的过饱和响应。饱和状态 $\\Omega$ 定义为离子活度积与方解石溶度积之比，因此 $\\Omega \\gt 1$ 表示过饱和。目标是估计活化能 $E_a$，同时明确地考虑 $\\Omega$ 中的非线性关系。\n\n从基本统计力学出发，使用 Boltzmann 分布来模拟能够越过能垒的构型所占的比例。论证一个可分离性假设的合理性，在该假设下，温度依赖性和过饱和依赖性可以分解为两个函数的乘积。采用一个关于过饱和度的单调响应函数，该函数可通过偏离平衡的过饱和距离的幂来建模，并论证使用对数变换以线性化该估计问题的合理性。您的程序必须：\n\n- 从第一性原理出发，推导出一个回归模型，该模型使用超过能量阈值的构型比例和关于 $\\Omega$ 的参数化非线性函数来分离出 $E_a$。\n- 实现一个估计程序，该程序在给定 $(T_i, \\Omega_i)$ 数组和测量的速率 $r_i$（单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$）的情况下，返回三个参数的估计值：\n  - 活化能 $E_a$（以 $\\mathrm{kJ\\,mol^{-1}}$ 表示），\n  - 过饱和非线性指数 $n$（无量纲），\n  - 指前因子 $A$（单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$）。\n- 使用理想气体常数 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。本问题不涉及角度。\n\n设计该估计方法，使其可测试且可复现。为此，请使用以下四个测试用例。每个测试用例提供三元组 $(T_i, \\Omega_i, r_i)$；将它们组合成向量并拟合模型。该测试套件涵盖了一般情况、低过饱和度边界行为、高温下的高活化能情况以及一个简单的非线性情况。\n\n测试用例 1（一般“理想”情况）：\n- 温度 $T$（单位 K）：$[298.15, 298.15, 298.15, 308.15, 308.15, 308.15, 318.15, 318.15, 318.15, 328.15, 328.15, 328.15]$\n- $\\Omega$：$[1.2, 1.5, 2.0, 1.2, 1.5, 2.0, 1.2, 1.5, 2.0, 1.2, 1.5, 2.0]$\n- 速率 $r$（单位 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$）：$[3.92\\times 10^{-10}, 2.45\\times 10^{-9}, 9.80\\times 10^{-9}, 6.64\\times 10^{-10}, 4.15\\times 10^{-9}, 1.66\\times 10^{-8}, 1.09\\times 10^{-9}, 6.83\\times 10^{-9}, 2.73\\times 10^{-8}, 1.75\\times 10^{-9}, 1.10\\times 10^{-8}, 4.39\\times 10^{-8}]$\n\n测试用例 2（边界，低过饱和度）：\n- 温度 $T$（单位 K）：$[298.15, 298.15, 298.15, 308.15, 308.15, 308.15]$\n- $\\Omega$：$[1.05, 1.10, 1.20, 1.05, 1.10, 1.20]$\n- 速率 $r$（单位 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$）：$[5.48\\times 10^{-12}, 3.10\\times 10^{-11}, 1.75\\times 10^{-10}, 9.27\\times 10^{-12}, 5.25\\times 10^{-11}, 2.97\\times 10^{-10}]$\n\n测试用例 3（高活化能，高温）：\n- 温度 $T$（单位 K）：$[328.15, 328.15, 328.15, 338.15, 338.15, 338.15, 348.15, 348.15, 348.15]$\n- $\\Omega$：$[1.20, 2.00, 3.00, 1.20, 2.00, 3.00, 1.20, 2.00, 3.00]$\n- 速率 $r$（单位 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$）：$[3.22\\times 10^{-11}, 3.60\\times 10^{-10}, 1.02\\times 10^{-9}, 7.34\\times 10^{-11}, 8.20\\times 10^{-10}, 2.32\\times 10^{-9}, 1.79\\times 10^{-10}, 2.00\\times 10^{-9}, 5.66\\times 10^{-9}]$\n\n测试用例 4（简单非线性）：\n- 温度 $T$（单位 K）：$[293.15, 293.15, 293.15, 303.15, 303.15, 303.15, 313.15, 313.15, 313.15]$\n- $\\Omega$：$[1.10, 1.30, 2.00, 1.10, 1.30, 2.00, 1.10, 1.30, 2.00]$\n- 速率 $r$（单位 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$）：$[1.00\\times 10^{-13}, 3.00\\times 10^{-13}, 1.00\\times 10^{-12}, 2.25\\times 10^{-13}, 6.75\\times 10^{-13}, 2.25\\times 10^{-12}, 4.85\\times 10^{-13}, 1.455\\times 10^{-12}, 4.85\\times 10^{-12}]$\n\n您的程序必须输出单行结果，将所有四个测试用例的估计值聚合到一个列表中。对于每个测试用例，输出一个包含三个数字的列表 $[E_a, n, A]$，其中：\n- $E_a$ 以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位，四舍五入到三位有效数字，\n- $n$ 为无量纲，四舍五入到三位有效数字，\n- $A$ 以 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ 为单位，四舍五入到三位有效数字。\n\n最终输出格式：单行包含一个外层列表，内含四个内层列表，条目以逗号分隔并用方括号括起，例如 $[[E_{a,1}, n_1, A_1],[E_{a,2}, n_2, A_2],[E_{a,3}, n_3, A_3],[E_{a,4}, n_4, A_4]]$。",
            "solution": "问题陈述已经过分析并被确定为有效。它在科学上基于化学动力学和统计力学原理，作为一个参数估计问题是适定的，并且为获得唯一解指定了所有必要的数据和约束。因此，我们可以继续进行推导和实现。\n\n目标是根据实验速率数据确定活化能 $E_a$、指前因子 $A$ 和非线性指数 $n$。沉淀速率 $r$ 是绝对温度 $T$ 和方解石饱和状态 $\\Omega$ 的函数。问题建议使用一个模型，其中对温度和饱和度的依赖性是可分离的。这是一个常见且物理上合理的假设，从而得出以下形式的速率定律：\n$$\nr(T, \\Omega) = f(T) \\cdot g(\\Omega)\n$$\n其中 $f(T)$ 表示温度依赖性，而 $g(\\Omega)$ 表示对过饱和度的依赖性。\n\n**1. 温度依赖性, $f(T)$**\n\n温度依赖性据称源于一个活化过程。根据统计力学和 Boltzmann 分布，在给定温度 $T$ 下，系统中拥有至少为 $E_a$（活化能）的最低摩尔能量的分子所占的比例与 Boltzmann 因子 $e^{-E_a / (RT)}$ 成正比。这里，$R$ 是理想气体常数。这是 Arrhenius 方程的基石。因此，我们将速率常数的温度依赖部分建模为：\n$$\nf(T) \\propto e^{-E_a / (RT)}\n$$\n\n**2. 过饱和度依赖性, $g(\\Omega)$**\n\n问题指明，过饱和度依赖性 $g(\\Omega)$ 应建模为偏离平衡的过饱和距离的幂。饱和状态 $\\Omega$ 定义为离子活度积与溶度积之比。平衡对应于 $\\Omega=1$。要发生沉淀，系统必须是过饱和的，即 $\\Omega  1$。“偏离平衡的距离”可以量化为 $(\\Omega - 1)$。因此，一个普遍的非线性响应可以建模为幂律：\n$$\ng(\\Omega) \\propto (\\Omega - 1)^n\n$$\n其中 $n$ 是一个无量纲指数，描述了相对于过饱和驱动力的反应级数。\n\n**3. 组合速率定律**\n\n结合这两种依赖关系，并引入一个合并了所有比例常数的单一指前因子 $A$，我们得到完整的速率定律：\n$$\nr(T, \\Omega) = A \\cdot e^{-E_a / (RT)} \\cdot (\\Omega - 1)^n\n$$\n需要从实验数据 $(T_i, \\Omega_i, r_i)$ 中估计的参数是 $A$、$E_a$ 和 $n$。\n\n**4. 为参数估计而进行的线性化**\n\n这个模型在其参数 $E_a$ 和 $n$ 上是非线性的，这使得直接拟合变得复杂。按照建议，我们可以通过对等式两边取自然对数来将其线性化：\n$$\n\\ln(r) = \\ln\\left(A \\cdot e^{-E_a / (RT)} \\cdot (\\Omega - 1)^n\\right)\n$$\n使用对数的性质 $\\ln(xy) = \\ln(x) + \\ln(y)$ 和 $\\ln(x^p) = p\\ln(x)$，我们展开该表达式：\n$$\n\\ln(r) = \\ln(A) + \\ln\\left(e^{-E_a / (RT)}\\right) + \\ln\\left((\\Omega - 1)^n\\right)\n$$\n$$\n\\ln(r) = \\ln(A) - \\frac{E_a}{RT} + n \\ln(\\Omega - 1)\n$$\n这个方程可以重新排列成多元线性回归模型的形式，$Y = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2$。对于给定的数据点 $i$，我们作如下识别：\n- 响应变量：$Y_i = \\ln(r_i)$\n- 预测变量：$X_{i,1} = \\frac{1}{T_i}$ 和 $X_{i,2} = \\ln(\\Omega_i - 1)$\n- 回归系数：$\\beta_0 = \\ln(A)$，$\\beta_1 = -\\frac{E_a}{R}$ 和 $\\beta_2 = n$。\n\n线性化模型为：\n$$\nY_i = \\beta_0 + \\beta_1 X_{i,1} + \\beta_2 X_{i,2} + \\epsilon_i\n$$\n其中 $\\epsilon_i$ 代表第 $i$ 次测量的残差。\n\n**5. 通过普通最小二乘法 (OLS) 求解**\n\n系数向量 $\\boldsymbol{\\beta} = [\\beta_0, \\beta_1, \\beta_2]^T$ 可以通过最小化残差平方和来估计。这就是普通最小二乘法 (OLS)。OLS 解由正规方程给出：\n$$\n\\boldsymbol{\\beta} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{Y}\n$$\n其中 $\\mathbf{Y}$ 是观测响应向量 $[Y_1, Y_2, \\dots, Y_m]^T$，$\\mathbf{X}$ 是 $m \\times 3$ 的设计矩阵。$\\mathbf{X}$ 的每一行对应一个实验数据点，形式为 $[1, X_{i,1}, X_{i,2}]$，其中开头的 $1$ 对应于截距项 $\\beta_0$：\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1  1/T_1  \\ln(\\Omega_1 - 1) \\\\\n1  1/T_2  \\ln(\\Omega_2 - 1) \\\\\n\\vdots  \\vdots  \\vdots \\\\\n1  1/T_m  \\ln(\\Omega_m - 1)\n\\end{pmatrix}\n, \\quad\n\\mathbf{Y} = \\begin{pmatrix}\n\\ln(r_1) \\\\\n\\ln(r_2) \\\\\n\\vdots \\\\\n\\ln(r_m)\n\\end{pmatrix}\n$$\n该系统将使用标准的线性代数程序进行数值求解，例如 `numpy.linalg` 中提供的程序。\n\n**6. 恢复物理参数**\n\n一旦确定了回归系数 $\\beta_0$、$\\beta_1$ 和 $\\beta_2$，模型的物理参数将按如下方式恢复：\n- 指前因子：$A = e^{\\beta_0}$\n- 活化能：$E_a = -\\beta_1 \\cdot R$。给定 $R$ 的单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$E_a$ 的单位将是 $\\mathrm{J\\,mol^{-1}}$。为了以 $\\mathrm{kJ\\,mol^{-1}}$ 表示，我们除以 $1000$：$E_a\\ [\\mathrm{kJ\\,mol^{-1}}] = \\frac{-\\beta_1 \\cdot R}{1000}$。\n- 非线性指数：$n = \\beta_2$\n\n该实现将处理四个测试用例中的每一个，通过构建各自的 $\\mathbf{X}$ 和 $\\mathbf{Y}$ 矩阵，求解 $\\boldsymbol{\\beta}$，然后计算物理参数 $E_a$、$n$ 和 $A$ 并将其四舍五入到三位有效数字。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef round_to_significant_figures(x, n):\n    \"\"\"\n    Rounds a number to a specified number of significant figures.\n\n    Args:\n        x (float): The number to round.\n        n (int): The number of significant figures.\n\n    Returns:\n        float: The rounded number.\n    \"\"\"\n    if x == 0:\n        return 0.0\n    if np.isnan(x) or np.isinf(x):\n        return x\n    # Calculate the power of 10 to shift the decimal point\n    power = n - int(math.floor(math.log10(abs(x)))) - 1\n    # Round the number and then shift the decimal point back\n    return round(x * (10**power)) / (10**power)\n\ndef estimate_parameters(T, Omega, r):\n    \"\"\"\n    Estimates kinetic parameters Ea, n, and A from experimental data.\n\n    The function fits the model r = A * exp(-Ea/(R*T)) * (Omega - 1)^n\n    by linearizing it to ln(r) = ln(A) - Ea/R * (1/T) + n * ln(Omega - 1)\n    and performing a multiple linear regression.\n\n    Args:\n        T (np.ndarray): Array of temperatures in Kelvin.\n        Omega (np.ndarray): Array of saturation states (dimensionless).\n        r (np.ndarray): Array of measured rates in mol m^-2 s^-1.\n\n    Returns:\n        list: A list containing [Ea, n, A] with values rounded to\n              three significant figures. Ea is in kJ/mol.\n    \"\"\"\n    R = 8.314462618  # Ideal Gas Constant in J mol^-1 K^-1\n\n    # 1. Prepare data for linear regression\n    # Y = ln(r)\n    y_vec = np.log(r)\n\n    # Design matrix X with columns for intercept, 1/T, and ln(Omega - 1)\n    # X_0 = 1 (for intercept)\n    # X_1 = 1/T\n    # X_2 = ln(Omega - 1)\n    ones_col = np.ones_like(T)\n    x1_col = 1.0 / T\n    x2_col = np.log(Omega - 1)\n    X_matrix = np.vstack([ones_col, x1_col, x2_col]).T\n\n    # 2. Perform Ordinary Least Squares (OLS) regression\n    # Solves for beta in X @ beta = y\n    beta, _, _, _ = np.linalg.lstsq(X_matrix, y_vec, rcond=None)\n    beta0, beta1, beta2 = beta\n\n    # 3. Recover physical parameters from regression coefficients\n    # beta0 = ln(A)\n    A = np.exp(beta0)\n\n    # beta1 = -Ea / R\n    Ea_J_per_mol = -beta1 * R\n    Ea_kJ_per_mol = Ea_J_per_mol / 1000.0\n\n    # beta2 = n\n    n = beta2\n\n    # 4. Round results to three significant figures\n    Ea_rounded = round_to_significant_figures(Ea_kJ_per_mol, 3)\n    n_rounded = round_to_significant_figures(n, 3)\n    A_rounded = round_to_significant_figures(A, 3)\n\n    return [Ea_rounded, n_rounded, A_rounded]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (general “happy path”)\n        {\n            'T': np.array([298.15, 298.15, 298.15, 308.15, 308.15, 308.15, 318.15, 318.15, 318.15, 328.15, 328.15, 328.15]),\n            'Omega': np.array([1.2, 1.5, 2.0, 1.2, 1.5, 2.0, 1.2, 1.5, 2.0, 1.2, 1.5, 2.0]),\n            'r': np.array([3.92e-10, 2.45e-9, 9.80e-9, 6.64e-10, 4.15e-9, 1.66e-8, 1.09e-9, 6.83e-9, 2.73e-8, 1.75e-9, 1.10e-8, 4.39e-8])\n        },\n        # Test case 2 (boundary, low supersaturation)\n        {\n            'T': np.array([298.15, 298.15, 298.15, 308.15, 308.15, 308.15]),\n            'Omega': np.array([1.05, 1.10, 1.20, 1.05, 1.10, 1.20]),\n            'r': np.array([5.48e-12, 3.10e-11, 1.75e-10, 9.27e-12, 5.25e-11, 2.97e-10])\n        },\n        # Test case 3 (high activation energy, elevated temperatures)\n        {\n            'T': np.array([328.15, 328.15, 328.15, 338.15, 338.15, 338.15, 348.15, 348.15, 348.15]),\n            'Omega': np.array([1.20, 2.00, 3.00, 1.20, 2.00, 3.00, 1.20, 2.00, 3.00]),\n            'r': np.array([3.22e-11, 3.60e-10, 1.02e-9, 7.34e-11, 8.20e-10, 2.32e-9, 1.79e-10, 2.00e-9, 5.66e-9])\n        },\n        # Test case 4 (simple nonlinearity)\n        {\n            'T': np.array([293.15, 293.15, 293.15, 303.15, 303.15, 303.15, 313.15, 313.15, 313.15]),\n            'Omega': np.array([1.10, 1.30, 2.00, 1.10, 1.30, 2.00, 1.10, 1.30, 2.00]),\n            'r': np.array([1.00e-13, 3.00e-13, 1.00e-12, 2.25e-13, 6.75e-13, 2.25e-12, 4.85e-13, 1.455e-12, 4.85e-12])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        params = estimate_parameters(case['T'], case['Omega'], case['r'])\n        results.append(params)\n\n    # Format the final output string exactly as specified.\n    # The `map(str, results)` will convert each inner list to its string representation.\n    # e.g., '[40.0, 2.5, 1.0e-05]'\n    # `','.join(...)` joins these strings with commas.\n    # The outer `f\"[{...}]\"` adds the outer brackets.\n    output_string = f\"[{','.join(map(str, results))}]\"\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "从实验数据中估算的参数总是伴随着不确定性，理解这种不确定性如何影响模型预测是高级建模的关键。这个练习探讨了如何量化活化能$E_a$的不确定性对不同温度下反应速率预测的传播。通过这个练习，你将学会不确定性传播的分析方法，并得出一个概率性（对数正态）的速率常数预测，这比单一的确定性数值更为完整和真实。",
            "id": "4103296",
            "problem": "您正在研究一个地球化学反应体系，其中反应速率常数的温度依赖性源于一个越垒过程。根据平衡统计力学和动力学理论，能量至少等于某个势垒的分子分数可以从玻尔兹曼因子导出，这意味着单位时间内成功越过势垒的次数与势垒能量成指数关系，与绝对温度成反比。考虑在绝对温度 $T_{\\text{cal}}$ 下对反应速率常数进行的校准测量，测得的校准速率常数 $k_{\\text{cal}}$ 在本分析中被视为精确值。势垒高度即为活化能 $E_a$，由于实验拟合存在不确定性，它被建模为一个均值为 $\\mu_{E_a}$、标准差为 $\\sigma_{E_a}$ 的正态随机变量。活化能 $E_a$ 以每摩尔为单位给出，相关的热能尺度由普适气体常数 $R$ 决定。从玻尔兹曼布居和碰撞频率图像出发，推导速率常数对活化能和温度的依赖关系，并使用在 $T_{\\text{cal}}$ 的校准测量值来消除任何未知的频率因子，使得在另一温度 $T_{\\text{out}}$ 的预测速率仅依赖于 $k_{\\text{cal}}$、$E_a$、$T_{\\text{cal}}$ 和 $T_{\\text{out}}$。然后，假设 $E_a \\sim \\mathcal{N}(\\mu_{E_a},\\sigma_{E_a}^2)$，将不确定性解析地传播到在 $T_{\\text{out}}$ 的预测速率常数，并计算其分布的均值、中位数和中心 95% 区间。\n\n使用以下常数和单位：\n- 使用普适气体常数 $R = 8.31446261815324\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 所有绝对温度必须以 $\\mathrm{K}$ 为单位指定和使用。\n- 所有活化能必须以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位指定，但在计算中内部转换为 $\\mathrm{J\\,mol^{-1}}$。\n- 所有速率常数必须以 $\\mathrm{s^{-1}}$ 为单位计算和报告。\n- 将区间边界和摘要统计信息表示为十进制数；不要使用百分号。\n\n假设：\n- 在 $T_{\\text{cal}}$ 的校准速率常数 $k_{\\text{cal}}$ 被视为精确值。\n- 唯一的不确定性来源是活化能 $E_a$，建模为 $E_a \\sim \\mathcal{N}(\\mu_{E_a},\\sigma_{E_a}^2)$。\n\n每个测试用例的所需输出：\n- 计算在 $T_{\\text{out}}$ 的预测速率常数分布，并返回一个包含四个数字的列表：分布的均值、分布的中位数、中心 95% 区间的下界和中心 95% 区间的上界。所有四个数字都必须以 $\\mathrm{s^{-1}}$ 为单位，并四舍五入到八位有效数字。\n\n测试套件：\n- 用例 1（正常路径）：$T_{\\text{cal}} = 298.15\\,\\mathrm{K}$，$k_{\\text{cal}} = 1.0\\times10^{-10}\\,\\mathrm{s^{-1}}$，$\\mu_{E_a} = 60\\,\\mathrm{kJ\\,mol^{-1}}$，$\\sigma_{E_a} = 5\\,\\mathrm{kJ\\,mol^{-1}}$，$T_{\\text{out}} = 373.15\\,\\mathrm{K}$。\n- 用例 2（边界，无外推）：$T_{\\text{cal}} = 298.15\\,\\mathrm{K}$，$k_{\\text{cal}} = 3.2\\times10^{-9}\\,\\mathrm{s^{-1}}$，$\\mu_{E_a} = 80\\,\\mathrm{kJ\\,mol^{-1}}$，$\\sigma_{E_a} = 10\\,\\mathrm{kJ\\,mol^{-1}}$，$T_{\\text{out}} = 298.15\\,\\mathrm{K}$。\n- 用例 3（具有较大不确定性的高温外推）：$T_{\\text{cal}} = 323.15\\,\\mathrm{K}$，$k_{\\text{cal}} = 5.0\\times10^{-12}\\,\\mathrm{s^{-1}}$，$\\mu_{E_a} = 100\\,\\mathrm{kJ\\,mol^{-1}}$，$\\sigma_{E_a} = 15\\,\\mathrm{kJ\\,mol^{-1}}$，$T_{\\text{out}} = 573.15\\,\\mathrm{K}$。\n- 用例 4（低温外推）：$T_{\\text{cal}} = 333.15\\,\\mathrm{K}$，$k_{\\text{cal}} = 2.0\\times10^{-9}\\,\\mathrm{s^{-1}}$，$\\mu_{E_a} = 75\\,\\mathrm{kJ\\,mol^{-1}}$，$\\sigma_{E_a} = 8\\,\\mathrm{kJ\\,mol^{-1}}$，$T_{\\text{out}} = 263.15\\,\\mathrm{K}$。\n- 用例 5（活化能零不确定性）：$T_{\\text{cal}} = 298.15\\,\\mathrm{K}$，$k_{\\text{cal}} = 3.0\\times10^{-11}\\,\\mathrm{s^{-1}}$，$\\mu_{E_a} = 50\\,\\mathrm{kJ\\,mol^{-1}}$，$\\sigma_{E_a} = 0\\,\\mathrm{kJ\\,mol^{-1}}$，$T_{\\text{out}} = 423.15\\,\\mathrm{K}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，每个元素对应一个测试用例，并且本身是一个包含四个所要求数字（单位为 $\\mathrm{s^{-1}}$，四舍五入到八位有效数字）的列表。例如，输出格式应如下所示：$[[m_1,\\tilde{m}_1,\\ell_1,u_1],[m_2,\\tilde{m}_2,\\ell_2,u_2],\\dots]$，其中 $m_i$ 表示均值，$\\tilde{m}_i$ 表示中位数，$\\ell_i$ 表示下界，而 $u_i$ 表示第 $i$ 个用例的上界。",
            "solution": "用户提供了一个计算地球化学问题，要求推导并应用阿伦尼乌斯方程的一种形式来传播不确定性。该问题具有科学依据，提法明确，并包含获得唯一解所需的所有信息。\n\n### 第1步：速率常数关系的推导\n该问题基于阿伦尼乌斯方程，该方程描述了反应速率常数 $k$ 的温度依赖性：\n$$\nk(T) = A \\exp\\left(-\\frac{E_a}{RT}\\right)\n$$\n在这里，$A$ 是指前因子，$E_a$ 是活化能，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n校准测量提供了在特定温度 $T_{\\text{cal}}$ 下的速率常数 $k_{\\text{cal}}$。此测量被视为精确值。\n$$\nk_{\\text{cal}} = A \\exp\\left(-\\frac{E_a}{RT_{\\text{cal}}}\\right)\n$$\n我们可以求解该方程以得到未知的指前因子 $A$：\n$$\nA = k_{\\text{cal}} \\exp\\left(\\frac{E_a}{RT_{\\text{cal}}}\\right)\n$$\n为了预测在不同温度 $T_{\\text{out}}$ 下的速率常数 $k_{\\text{out}}$，我们将 $A$ 的这个表达式代回通用的阿伦尼乌斯方程：\n$$\nk_{\\text{out}} = k(T_{\\text{out}}) = \\left( k_{\\text{cal}} \\exp\\left(\\frac{E_a}{RT_{\\text{cal}}}\\right) \\right) \\exp\\left(-\\frac{E_a}{RT_{\\text{out}}}\\right)\n$$\n合并指数项得到所需的关系式，该关系式消除了指前因子：\n$$\nk_{\\text{out}} = k_{\\text{cal}} \\exp\\left(\\frac{E_a}{RT_{\\text{cal}}} - \\frac{E_a}{RT_{\\text{out}}}\\right) = k_{\\text{cal}} \\exp\\left(\\frac{E_a}{R} \\left(\\frac{1}{T_{\\text{cal}}} - \\frac{1}{T_{\\text{out}}}\\right)\\right)\n$$\n\n### 第2步：不确定性传播\n活化能 $E_a$ 是唯一的不确定性来源，并被建模为正态随机变量：$E_a \\sim \\mathcal{N}(\\mu_{E_a}, \\sigma_{E_a}^2)$。我们的目标是确定由这种不确定性导致的 $k_{\\text{out}}$ 的分布。\n\n让我们定义一个常数 $b$ 来概括温度依赖性：\n$$\nb = \\frac{1}{R} \\left(\\frac{1}{T_{\\text{cal}}} - \\frac{1}{T_{\\text{out}}}\\right)\n$$\n$k_{\\text{out}}$ 的表达式变为：\n$$\nk_{\\text{out}} = k_{\\text{cal}} \\exp(b E_a)\n$$\n由于 $E_a$ 是一个正态随机变量，指数 $b E_a$ 也是一个正态随机变量。设 $X = E_a$。随机变量 $Y = k_{\\text{out}}$ 的形式为 $c \\exp(\\text{正态变量})$，这定义了一个对数正态分布。\n\n为了找到该分布的参数，我们对 $k_{\\text{out}}$ 取自然对数：\n$$\n\\ln(k_{\\text{out}}) = \\ln(k_{\\text{cal}}) + b E_a\n$$\n由于 $\\ln(k_{\\text{cal}})$ 是一个常数（因为 $k_{\\text{cal}}$ 是精确的）而 $E_a$ 是一个正态随机变量，所以 $\\ln(k_{\\text{out}})$ 也服从正态分布。让我们来计算它的均值和方差。\n$\\ln(k_{\\text{out}})$ 的均值为：\n$$\n\\mu_{\\ln k} = E[\\ln(k_{\\text{out}})] = E[\\ln(k_{\\text{cal}}) + b E_a] = \\ln(k_{\\text{cal}}) + b E[E_a] = \\ln(k_{\\text{cal}}) + b \\mu_{E_a}\n$$\n$\\ln(k_{\\text{out}})$ 的方差为：\n$$\n\\sigma_{\\ln k}^2 = \\text{Var}[\\ln(k_{\\text{out}})] = \\text{Var}[\\ln(k_{\\text{cal}}) + b E_a] = b^2 \\text{Var}[E_a] = b^2 \\sigma_{E_a}^2\n$$\n因此，$\\ln(k_{\\text{out}}) \\sim \\mathcal{N}(\\mu_{\\ln k}, \\sigma_{\\ln k}^2)$，这意味着 $k_{\\text{out}}$ 服从对数正态分布，$k_{\\text{out}} \\sim \\text{LogNormal}(\\mu_{\\ln k}, \\sigma_{\\ln k}^2)$。\n\n### 第3步：统计特性的计算\n对于一个随机变量 $Y \\sim \\text{LogNormal}(\\mu, \\sigma^2)$，其中 $\\mu$ 和 $\\sigma^2$ 分别是 $\\ln(Y)$ 的均值和方差，其均值、中位数和分位数由标准公式给出。\n\n1.  **均值**：$k_{\\text{out}}$ 的均值由以下公式给出：\n    $$\n    E[k_{\\text{out}}] = \\exp\\left(\\mu_{\\ln k} + \\frac{\\sigma_{\\ln k}^2}{2}\\right) = \\exp\\left( \\ln(k_{\\text{cal}}) + b\\mu_{E_a} + \\frac{(b\\sigma_{E_a})^2}{2} \\right)\n    $$\n    $$\n    E[k_{\\text{out}}] = k_{\\text{cal}} \\exp\\left(b\\mu_{E_a} + \\frac{b^2\\sigma_{E_a}^2}{2}\\right)\n    $$\n\n2.  **中位数**：$k_{\\text{out}}$ 的中位数是：\n    $$\n    \\text{Median}[k_{\\text{out}}] = \\exp(\\mu_{\\ln k}) = \\exp(\\ln(k_{\\text{cal}}) + b\\mu_{E_a}) = k_{\\text{cal}} \\exp(b\\mu_{E_a})\n    $$\n    这是在平均活化能 $\\mu_{E_a}$ 处计算的 $k_{\\text{out}}$ 的确定性值。\n\n3.  **中心 95% 区间**：该区间是通过变换其对应的基础正态分布 $\\ln(k_{\\text{out}})$ 的区间得到的。对于中心 95% 区间，我们需要第 2.5 百分位数和第 97.5 百分位数。设 $z_p$ 为标准正态分布 $\\mathcal{N}(0, 1)$ 的第 $p$ 个分位数。则边界为：\n    $$\n    \\text{Lower Bound, } \\ell = \\exp(\\mu_{\\ln k} + z_{0.025} \\sigma_{\\ln k})\n    $$\n    $$\n    \\text{Upper Bound, } u = \\exp(\\mu_{\\ln k} + z_{0.975} \\sigma_{\\ln k})\n    $$\n    其中 $z_{0.025} = -z_{0.975} \\approx -1.959964$，并且 $\\sigma_{\\ln k} = |b|\\sigma_{E_a}$。\n\n### 特殊情况\n-   如果 $T_{\\text{cal}} = T_{\\text{out}}$，则 $b=0$。预测速率 $k_{\\text{out}} = k_{\\text{cal}}$ 是一个确定性常数。因此，均值、中位数和区间边界都等于 $k_{\\text{cal}}$。\n-   如果 $\\sigma_{E_a} = 0$，则活化能是确定性值 $\\mu_{E_a}$。那么 $\\sigma_{\\ln k} = 0$，分布坍缩为单一点。均值、中位数和区间边界都等于确定性预测值 $k_{\\text{cal}} \\exp(b\\mu_{E_a})$。\n\n该算法包括将输入能量从 $\\mathrm{kJ\\,mol^{-1}}$ 转换为 $\\mathrm{J\\,mol^{-1}}$，计算常数 $b$，确定参数 $\\mu_{\\ln k}$ 和 $\\sigma_{\\ln k}$，然后应用上述公式计算均值、中位数和区间边界。所有结果以 $\\mathrm{s^{-1}}$ 为单位报告，并四舍五入到八位有效数字。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves the geochemical uncertainty propagation problem for a suite of test cases.\n\n    The solution involves deriving the relationship for an extrapolated rate constant\n    based on the Arrhenius equation and a calibration point. It then propagates the\n    uncertainty from a normally distributed activation energy (Ea) to the predicted\n    rate constant (k_out). The resulting k_out follows a log-normal distribution.\n    The function calculates the mean, median, and central 95% confidence interval\n    for this log-normal distribution for each test case.\n    \"\"\"\n    # Universal gas constant in J mol^-1 K^-1\n    R = 8.31446261815324\n\n    # Test cases parameters:\n    # (T_cal (K), k_cal (s^-1), mu_Ea (kJ/mol), sigma_Ea (kJ/mol), T_out (K))\n    test_cases = [\n        (298.15, 1.0e-10, 60.0, 5.0, 373.15),\n        (298.15, 3.2e-9, 80.0, 10.0, 298.15),\n        (323.15, 5.0e-12, 100.0, 15.0, 573.15),\n        (333.15, 2.0e-9, 75.0, 8.0, 263.15),\n        (298.15, 3.0e-11, 50.0, 0.0, 423.15),\n    ]\n\n    results = []\n\n    for t_cal, k_cal, mu_ea_kj, sigma_ea_kj, t_out in test_cases:\n        # Convert activation energy from kJ/mol to J/mol\n        mu_ea = mu_ea_kj * 1000.0\n        sigma_ea = sigma_ea_kj * 1000.0\n\n        # Handle special cases where uncertainty collapses to zero\n        if t_cal == t_out or sigma_ea == 0:\n            if t_cal == t_out:\n                # If temperatures are the same, k_out = k_cal deterministically.\n                result_val = k_cal\n            else: # sigma_ea == 0 case\n                # If there's no uncertainty in Ea, the result is deterministic.\n                b = (1.0 / t_cal - 1.0 / t_out) / R\n                result_val = k_cal * np.exp(b * mu_ea)\n            \n            # For deterministic cases, mean, median, and bounds are all the same.\n            case_results = [result_val, result_val, result_val, result_val]\n\n        else: # General case with uncertainty\n            # Calculate the temperature-dependent constant 'b'\n            b = (1.0 / t_cal - 1.0 / t_out) / R\n\n            # Parameters of the underlying normal distribution for ln(k_out)\n            mu_ln_k = np.log(k_cal) + b * mu_ea\n            sigma_ln_k = abs(b) * sigma_ea\n\n            # Calculate statistics for the log-normal distribution of k_out\n            \n            # Mean\n            mean_k = np.exp(mu_ln_k + (sigma_ln_k**2) / 2.0)\n            \n            # Median\n            median_k = np.exp(mu_ln_k)\n\n            # Central 95% interval\n            # Find z-scores for 2.5th and 97.5th percentiles\n            z_lower = norm.ppf(0.025)  # approx -1.96\n            z_upper = norm.ppf(0.975)  # approx +1.96\n            \n            lower_bound = np.exp(mu_ln_k + z_lower * sigma_ln_k)\n            upper_bound = np.exp(mu_ln_k + z_upper * sigma_ln_k)\n            \n            case_results = [mean_k, median_k, lower_bound, upper_bound]\n\n        results.append(case_results)\n\n    # Format the final output string according to the problem specification.\n    # Each number is rounded to 8 significant digits.\n    # The final string is a list of lists of numbers, with no spaces.\n    formatted_cases = []\n    for res_list in results:\n        # Use '.8g' format specifier for 8 significant digits.\n        inner_list_str = \",\".join(f\"{num:.8g}\" for num in res_list)\n        formatted_cases.append(f\"[{inner_list_str}]\")\n    \n    final_output_str = f\"[{','.join(formatted_cases)}]\"\n\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}