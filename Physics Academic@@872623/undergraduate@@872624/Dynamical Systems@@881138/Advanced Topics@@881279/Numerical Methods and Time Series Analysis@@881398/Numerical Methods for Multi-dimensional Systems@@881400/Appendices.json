{"hands_on_practices": [{"introduction": "The first step in mastering numerical methods is to apply the core algorithm in a clear and direct context. This exercise provides a fundamental two-dimensional system representing a nonlinear oscillator, allowing you to focus on the mechanics of the calculation. By manually computing a single step using the fourth-order Runge-Kutta (RK4) method, you will gain a concrete understanding of how the algorithm advances a state vector in time, building an essential foundation for more complex applications [@problem_id:1695392].", "problem": "A point-mass moves in the $xy$-plane, and its position vector $\\mathbf{r}(t) = (x(t), y(t))$ is governed by the following system of autonomous ordinary differential equations, which represents a non-linear oscillator:\n$$\n\\frac{dx}{dt} = -y\n$$\n$$\n\\frac{dy}{dt} = x - \\alpha x^3\n$$\nHere, $\\alpha$ is a parameter that controls the strength of the non-linear term.\n\nSuppose the particle is initially at position $(x_0, y_0) = (2.0, 0)$ at time $t=0$. The system parameters are given by $\\alpha = 0.1$ and the time step for numerical integration is $h = 0.5$.\n\nUsing the classical fourth-order Runge-Kutta (RK4) method, compute the approximate position of the particle, $(x_1, y_1)$, after one time step.\n\nPresent your final answer as a row matrix containing the values of $x_1$ and $y_1$ in that order, with both values rounded to four significant figures.", "solution": "We have the autonomous system given by\n$$\n\\frac{dx}{dt} = f_{1}(x,y) = -y, \\quad \\frac{dy}{dt} = f_{2}(x,y) = x - \\alpha x^{3},\n$$\nwith initial condition $(x_{0},y_{0})=(2.0,0)$, parameter $\\alpha=0.1$, and step size $h=0.5$.\n\nFor a single RK4 step from $(x_{0},y_{0})$ to $(x_{1},y_{1})$, the stage vectors are\n$$\n\\mathbf{k}_{1} = \\begin{pmatrix} f_{1}(x_{0},y_{0}) \\\\ f_{2}(x_{0},y_{0}) \\end{pmatrix}, \\quad\n\\mathbf{k}_{2} = \\begin{pmatrix} f_{1}\\!\\left(x_{0}+\\frac{h}{2}k_{1x},\\,y_{0}+\\frac{h}{2}k_{1y}\\right) \\\\ f_{2}\\!\\left(x_{0}+\\frac{h}{2}k_{1x},\\,y_{0}+\\frac{h}{2}k_{1y}\\right) \\end{pmatrix},\n$$\n$$\n\\mathbf{k}_{3} = \\begin{pmatrix} f_{1}\\!\\left(x_{0}+\\frac{h}{2}k_{2x},\\,y_{0}+\\frac{h}{2}k_{2y}\\right) \\\\ f_{2}\\!\\left(x_{0}+\\frac{h}{2}k_{2x},\\,y_{0}+\\frac{h}{2}k_{2y}\\right) \\end{pmatrix}, \\quad\n\\mathbf{k}_{4} = \\begin{pmatrix} f_{1}\\!\\left(x_{0}+h k_{3x},\\,y_{0}+h k_{3y}\\right) \\\\ f_{2}\\!\\left(x_{0}+h k_{3x},\\,y_{0}+h k_{3y}\\right) \\end{pmatrix},\n$$\nand the update is\n$$\n\\begin{pmatrix} x_{1} \\\\ y_{1} \\end{pmatrix}\n=\n\\begin{pmatrix} x_{0} \\\\ y_{0} \\end{pmatrix}\n+\n\\frac{h}{6}\\left(\\mathbf{k}_{1}+2\\mathbf{k}_{2}+2\\mathbf{k}_{3}+\\mathbf{k}_{4}\\right).\n$$\n\nCompute each stage:\n1) $\\mathbf{k}_{1}$ at $(2,0)$:\n$$\nk_{1x} = -y_{0} = 0, \\quad k_{1y} = x_{0} - \\alpha x_{0}^{3} = 2 - 0.1\\cdot 8 = 1.2.\n$$\n\n2) Midpoint for $\\mathbf{k}_{2}$:\n$$\nx_{0}+\\frac{h}{2}k_{1x} = 2 + 0.25\\cdot 0 = 2, \\quad y_{0}+\\frac{h}{2}k_{1y} = 0 + 0.25\\cdot 1.2 = 0.3.\n$$\nThus\n$$\nk_{2x} = -0.3, \\quad k_{2y} = 2 - 0.1\\cdot 8 = 1.2.\n$$\n\n3) Midpoint for $\\mathbf{k}_{3}$:\n$$\nx_{0}+\\frac{h}{2}k_{2x} = 2 + 0.25\\cdot(-0.3) = 1.925, \\quad y_{0}+\\frac{h}{2}k_{2y} = 0 + 0.25\\cdot 1.2 = 0.3.\n$$\nCompute $1.925^{3} = 7.133328125$, hence\n$$\nk_{3x} = -0.3, \\quad k_{3y} = 1.925 - 0.1\\cdot 7.133328125 = 1.2116671875.\n$$\n\n4) Endpoint for $\\mathbf{k}_{4}$:\n$$\nx_{0}+h k_{3x} = 2 + 0.5\\cdot(-0.3) = 1.85, \\quad y_{0}+h k_{3y} = 0 + 0.5\\cdot 1.2116671875 = 0.60583359375.\n$$\nCompute $1.85^{3} = 6.331625$, hence\n$$\nk_{4x} = -0.60583359375, \\quad k_{4y} = 1.85 - 0.1\\cdot 6.331625 = 1.2168375.\n$$\n\nCombine to get $(x_{1},y_{1})$ with $\\frac{h}{6}=\\frac{1}{12}$:\n$$\nx_{1} = 2 + \\frac{1}{12}\\left(0 + 2(-0.3) + 2(-0.3) + (-0.60583359375)\\right)\n= 2 - \\frac{1.80583359375}{12}\n= 1.8495138671875,\n$$\n$$\ny_{1} = 0 + \\frac{1}{12}\\left(1.2 + 2\\cdot 1.2 + 2\\cdot 1.2116671875 + 1.2168375\\right)\n= \\frac{7.240171875}{12}\n= 0.60334765625.\n$$\n\nRounding each to four significant figures gives $x_{1}\\approx 1.850$ and $y_{1}\\approx 0.6033$.", "answer": "$$\\boxed{\\begin{pmatrix}1.850 & 0.6033\\end{pmatrix}}$$", "id": "1695392"}, {"introduction": "Beyond single-step calculations, the true power of numerical methods lies in revealing the long-term, qualitative behavior of dynamical systems. We explore this using the famous Van der Pol oscillator, a classic model for systems with self-sustaining oscillations known as limit cycles. This exercise requires you to use the RK4 method to simulate trajectories and analyze how the system's behavior changes with the sign of the nonlinear damping parameter $\\mu$, connecting numerical output to the fundamental concept of a phase portrait [@problem_id:1695382].", "problem": "The Van der Pol oscillator is a non-conservative oscillator with non-linear damping. It is a canonical example in the study of dynamical systems and is described by a second-order Ordinary Differential Equation (ODE). By defining $x_1 = x$ and $x_2 = \\frac{dx}{dt}$, we can represent it as a system of two first-order ODEs:\n$$\n\\frac{dx_1}{dt} = x_2\n$$\n$$\n\\frac{dx_2}{dt} = -x_1 - \\mu x_2 (x_1^2 - 1)\n$$\nHere, $\\mu$ is a scalar parameter that controls the non-linearity and the strength of the damping.\n\nYour task is to analyze the long-term behavior of this system in the $(x_1, x_2)$ phase plane for two different values of $\\mu$ and from two different starting points. You are to use the fourth-order Runge-Kutta (RK4) method with a fixed time step of $h=0.01$ to numerically integrate the system.\n\nConsider the following two scenarios for the parameter $\\mu$:\n1.  $\\mu = 0.2$\n2.  $\\mu = -0.2$\n\nFor each of these scenarios, investigate the long-term behavior of the trajectories starting from two distinct initial conditions:\n-   A \"near\" point: $(x_1(0), x_2(0)) = (0.1, 0.1)$\n-   A \"far\" point: $(x_1(0), x_2(0)) = (3.0, 3.0)$\n\nBased on your numerical exploration, which of the following statements accurately describes the qualitative long-term behavior (i.e., as $t \\to \\infty$) of the system for both values of $\\mu$?\n\nA. For $\\mu=0.2$, both trajectories converge to the origin. For $\\mu=-0.2$, both trajectories diverge, moving infinitely far from the origin.\n\nB. For $\\mu=0.2$, both trajectories converge to a single, non-zero closed loop. For $\\mu=-0.2$, the \"near\" trajectory converges to the origin, while the \"far\" trajectory diverges.\n\nC. For $\\mu=0.2$, the \"near\" trajectory converges to the origin, while the \"far\" trajectory diverges. For $\\mu=-0.2$, both trajectories converge to a single, non-zero closed loop.\n\nD. For both $\\mu=0.2$ and $\\mu=-0.2$, the \"near\" trajectory converges to the origin and the \"far\" trajectory diverges.\n\nE. For both $\\mu=0.2$ and $\\mu=-0.2$, both trajectories converge to a single, non-zero closed loop.", "solution": "The problem asks us to analyze the behavior of the Van der Pol oscillator system for positive and negative values of the parameter $\\mu$ using the fourth-order Runge-Kutta (RK4) method. The system is given by the vector equation $\\frac{d\\mathbf{x}}{dt} = \\mathbf{f}(t, \\mathbf{x})$, where $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ and $\\mathbf{f}(t, \\mathbf{x}) = \\begin{pmatrix} x_2 \\\\ -x_1 - \\mu x_2 (x_1^2 - 1) \\end{pmatrix}$.\n\nThe RK4 method for a system of ODEs updates the state vector from time $t_n$ to $t_{n+1} = t_n + h$ using the following steps:\nLet $\\mathbf{x}_n = \\mathbf{x}(t_n)$.\n$$\n\\mathbf{k}_1 = \\mathbf{f}(t_n, \\mathbf{x}_n)\n$$\n$$\n\\mathbf{k}_2 = \\mathbf{f}\\left(t_n + \\frac{h}{2}, \\mathbf{x}_n + \\frac{h}{2}\\mathbf{k}_1\\right)\n$$\n$$\n\\mathbf{k}_3 = \\mathbf{f}\\left(t_n + \\frac{h}{2}, \\mathbf{x}_n + \\frac{h}{2}\\mathbf{k}_2\\right)\n$$\n$$\n\\mathbf{k}_4 = \\mathbf{f}\\left(t_n + h, \\mathbf{x}_n + h\\mathbf{k}_3\\right)\n$$\nThe next state is then calculated as:\n$$\n\\mathbf{x}_{n+1} = \\mathbf{x}_n + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nWe apply this method to the four specified cases.\n\n**Case 1: $\\mu = 0.2$**\nThe damping term is $-0.2 x_2 (x_1^2 - 1)$.\n- If $x_1^2 > 1$, the term $-0.2(x_1^2-1)$ is negative. The equation for $\\dot{x}_2$ has a term proportional to $-x_2$, which corresponds to positive damping, removing energy from the system.\n- If $x_1^2 < 1$, the term $-0.2(x_1^2-1)$ is positive. The equation for $\\dot{x}_2$ has a term proportional to $+x_2$, which corresponds to negative damping (anti-damping), pumping energy into the system.\n\nLet's analyze the trajectories from the two initial points:\n-   **Initial Condition: \"near\" point $(0.1, 0.1)$**. Here, $x_1^2 = 0.01 \\ll 1$. The system is in the region of negative damping. Energy is pumped into the oscillator, causing the trajectory to spiral outwards, away from the origin.\n-   **Initial Condition: \"far\" point $(3.0, 3.0)$**. Here, $x_1^2 = 9 \\gg 1$. The system is mostly in the region of positive damping. Energy is dissipated from the oscillator, causing the trajectory to spiral inwards.\n\nThe interplay between these two regions leads to a situation where trajectories starting inside the region $|x_1| \\approx 1$ spiral outwards, and trajectories starting well outside spiral inwards. Both will asymptotically approach a stable, closed loop in the phase plane known as a limit cycle. Therefore, for $\\mu=0.2$, both the \"near\" and \"far\" trajectories will converge to the same non-zero closed loop.\n\n**Case 2: $\\mu = -0.2$**\nThe damping term becomes $-(-0.2) x_2 (x_1^2 - 1) = +0.2 x_2 (x_1^2 - 1)$. This is equivalent to reversing time in the first case. The stability of the features in the phase plane will be reversed.\n- If $x_1^2 > 1$, the term $+0.2(x_1^2-1)$ is positive. This corresponds to negative damping, pumping energy into the system.\n- If $x_1^2 < 1$, the term $+0.2(x_1^2-1)$ is negative. This corresponds to positive damping, removing energy from the system.\n\nLet's analyze the trajectories:\n-   **Initial Condition: \"near\" point $(0.1, 0.1)$**. Here, $x_1^2 \\ll 1$. The system experiences positive damping. Energy is removed, and the trajectory spirals inwards toward the stable fixed point at the origin $(0,0)$.\n-   **Initial Condition: \"far\" point $(3.0, 3.0)$**. Here, $x_1^2 \\gg 1$. The system experiences negative damping. Energy is continuously pumped in, causing the trajectory to spiral outwards, with its amplitude growing indefinitely. The trajectory diverges.\n\nIn this case, the limit cycle that existed for $\\mu > 0$ is now unstable. It acts as a separatrix: trajectories inside it are drawn to the origin, and trajectories outside it are repelled to infinity.\n\n**Summary of Observations:**\n-   For $\\mu = 0.2$: Both the \"near\" and \"far\" trajectories converge to a single, non-zero closed loop.\n-   For $\\mu = -0.2$: The \"near\" trajectory converges to the origin, while the \"far\" trajectory diverges.\n\nComparing this summary with the given options:\n-   A is incorrect.\n-   B correctly states: \"For $\\mu=0.2$, both trajectories converge to a single, non-zero closed loop. For $\\mu=-0.2$, the 'near' trajectory converges to the origin, while the 'far' trajectory diverges.\"\n-   C, D, and E are incorrect.\n\nThus, the correct description is provided in option B.", "answer": "$$\\boxed{B}$$", "id": "1695382"}, {"introduction": "Numerical integrators can be used as powerful tools for scientific investigation, going beyond simple trajectory plotting. This practice challenges you to use the RK4 method as part of a larger numerical experiment to determine a critical physical parameter in the Kuramoto model, a cornerstone for understanding synchronization. You will investigate how two coupled oscillators transition from a drifting state to being phase-locked as their coupling strength $K$ increases, and you will pinpoint the critical value $K_c$ where this bifurcation occurs [@problem_id:1695341].", "problem": "The Kuramoto model is a mathematical model used to describe synchronization in a large set of coupled oscillators. Consider a simplified version of this model consisting of two phase oscillators, whose dynamics are described by the following system of coupled ordinary differential equations:\n$$\n\\dot{\\theta}_1 = \\omega_1 + \\frac{K}{2} \\sin(\\theta_2 - \\theta_1)\n$$\n$$\n\\dot{\\theta}_2 = \\omega_2 + \\frac{K}{2} \\sin(\\theta_1 - \\theta_2)\n$$\nHere, $\\theta_1(t)$ and $\\theta_2(t)$ are the phases of the two oscillators in radians, and $\\dot{\\theta}_i$ represents their instantaneous angular frequencies. The parameters $\\omega_1$ and $\\omega_2$ are the natural frequencies of the isolated oscillators, and $K \\ge 0$ is the coupling strength, which determines how strongly the oscillators influence each other.\n\nThe oscillators are said to be \"phase-locked\" when their phase difference, $\\Delta\\theta(t) = \\theta_2(t) - \\theta_1(t)$, approaches a constant value for large times. If the phase difference grows or shrinks indefinitely, the oscillators are in a \"drifting\" state. There exists a critical coupling strength, $K_c$, which is the minimum value of $K$ for which the system transitions from a drifting to a phase-locked state.\n\nGiven the natural frequencies $\\omega_1 = 2.5 \\text{ rad/s}$ and $\\omega_2 = 3.8 \\text{ rad/s}$, and initial conditions $\\theta_1(0) = 0$ radians and $\\theta_2(0) = \\frac{\\pi}{4}$ radians, determine the value of the critical coupling strength $K_c$.\n\nTo do this, you must numerically integrate the system using the fourth-order Runge-Kutta (RK4) method with a fixed time step of $h = 0.01 \\text{ s}$. A simulation for a given $K$ is to be considered phase-locked if the absolute value of the average rate of change of the phase difference, $\\langle \\dot{\\Delta\\theta} \\rangle$, calculated over the time interval from $t = 400 \\text{ s}$ to $t = 500 \\text{ s}$, is less than a tolerance of $\\epsilon = 10^{-4} \\text{ rad/s}$.\n\nExpress your final answer for $K_c$ in rad/s, rounded to three significant figures.", "solution": "The problem asks for the critical coupling strength $K_c$ for a system of two coupled oscillators described by the Kuramoto model. We need to find this value numerically using the fourth-order Runge-Kutta (RK4) method and a specific criterion for phase-locking.\n\nFirst, let's simplify the system of two equations into a single equation describing the phase difference, $\\Delta\\theta(t) = \\theta_2(t) - \\theta_1(t)$. We differentiate $\\Delta\\theta(t)$ with respect to time:\n$$\n\\dot{\\Delta\\theta} = \\dot{\\theta}_2 - \\dot{\\theta}_1\n$$\nSubstituting the given equations for $\\dot{\\theta}_1$ and $\\dot{\\theta}_2$:\n$$\n\\dot{\\Delta\\theta} = \\left(\\omega_2 + \\frac{K}{2} \\sin(\\theta_1 - \\theta_2)\\right) - \\left(\\omega_1 + \\frac{K}{2} \\sin(\\theta_2 - \\theta_1)\\right)\n$$\n$$\n\\dot{\\Delta\\theta} = (\\omega_2 - \\omega_1) + \\frac{K}{2} \\sin(-(\\theta_2 - \\theta_1)) - \\frac{K}{2} \\sin(\\theta_2 - \\theta_1)\n$$\nUsing the identity $\\sin(-x) = -\\sin(x)$:\n$$\n\\dot{\\Delta\\theta} = (\\omega_2 - \\omega_1) - \\frac{K}{2} \\sin(\\Delta\\theta) - \\frac{K}{2} \\sin(\\Delta\\theta)\n$$\n$$\n\\dot{\\Delta\\theta} = (\\omega_2 - \\omega_1) - K \\sin(\\Delta\\theta)\n$$\nThis single first-order ordinary differential equation governs the dynamics of the phase difference. Let's define the natural frequency difference $\\Delta\\omega = \\omega_2 - \\omega_1$. With the given values, $\\Delta\\omega = 3.8 - 2.5 = 1.3 \\text{ rad/s}$. The equation to be solved numerically is:\n$$\n\\dot{\\Delta\\theta} = 1.3 - K \\sin(\\Delta\\theta)\n$$\nThe initial condition for the phase difference is $\\Delta\\theta(0) = \\theta_2(0) - \\theta_1(0) = \\frac{\\pi}{4} - 0 = \\frac{\\pi}{4}$.\nLet's denote the right-hand side of the ODE as $f(\\Delta\\theta, K) = 1.3 - K \\sin(\\Delta\\theta)$.\n\nThe problem requires us to use the RK4 method with a time step $h = 0.01 \\text{ s}$. The update rule for $\\Delta\\theta$ from time step $n$ to $n+1$ is:\n$$\n\\Delta\\theta_{n+1} = \\Delta\\theta_n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\nwhere\n$$\n\\begin{aligned}\nk_1 &= h \\cdot f(\\Delta\\theta_n, K) \\\\\nk_2 &= h \\cdot f(\\Delta\\theta_n + k_1/2, K) \\\\\nk_3 &= h \\cdot f(\\Delta\\theta_n + k_2/2, K) \\\\\nk_4 &= h \\cdot f(\\Delta\\theta_n + k_3, K)\n\\end{aligned}\n$$\n\nWe are looking for the minimum value of $K$, which we call $K_c$, that satisfies the phase-locking criterion. This is a search problem. An efficient way to find $K_c$ is to use a bisection search method. We need to find an interval $[K_{low}, K_{high}]$ that we know contains $K_c$.\nLet's analyze the behavior. Phase-locking corresponds to $\\dot{\\Delta\\theta} \\to 0$, which means a stable fixed point exists for the ODE. A fixed point $\\Delta\\theta^*$ must satisfy $f(\\Delta\\theta^*, K) = 0$, which means $1.3 = K \\sin(\\Delta\\theta^*)$. For a real solution $\\Delta\\theta^*$ to exist, we must have $|\\sin(\\Delta\\theta^*)| \\le 1$, which implies $|1.3/K| \\le 1$, or $K \\ge 1.3$. This analytical result tells us that $K_c = 1.3$. Our numerical search should converge to this value.\n\nLet's check two test cases for our search interval:\n- If $K=1.0$ (which is less than 1.3), the system will be in a drifting state. This will be our initial $K_{low}$.\n- If $K=2.0$ (which is greater than 1.3), the system will be phase-locked. This will be our initial $K_{high}$.\nSo, we start our bisection search on the interval $[K_{low}, K_{high}] = [1.0, 2.0]$.\n\nThe search proceeds as follows:\n1.  Set $K_{mid} = (K_{low} + K_{high})/2$.\n2.  Run the RK4 simulation for this $K_{mid}$ from $t=0$ to $t=500$ s.\n3.  Calculate the average derivative $\\langle \\dot{\\Delta\\theta} \\rangle$ over the interval $t \\in [400, 500]$ s. This time interval corresponds to the last $N_{avg} = (500-400)/h = 100/0.01 = 10000$ simulation steps. Let the total number of steps be $N_{total} = 500/h = 50000$.\n    $$ \\langle \\dot{\\Delta\\theta} \\rangle = \\frac{1}{N_{avg}} \\sum_{n=N_{total}-N_{avg}}^{N_{total}-1} f(\\Delta\\theta_n, K_{mid}) $$\n4.  Check the locking criterion: If $|\\langle \\dot{\\Delta\\theta} \\rangle| < 10^{-4}$, the system is locked.\n    - If it is locked, we have found a potential upper bound for $K_c$. We update $K_{high} = K_{mid}$.\n    - If it is unlocked, $K_{mid}$ is too small. We update $K_{low} = K_{mid}$.\n5.  Repeat until the interval $[K_{low}, K_{high}]$ is narrow enough to determine $K_c$ to three significant figures.\n\nLet's trace a few iterations of the bisection search:\n- **Initial Interval:** $[K_{low}, K_{high}] = [1.0, 2.0]$.\n- **Iteration 1:** $K_{mid} = 1.5$.\n    - A simulation shows the system locks. For example, $\\langle \\dot{\\Delta\\theta} \\rangle$ will be very close to zero.\n    - New interval: $[1.0, 1.5]$.\n- **Iteration 2:** $K_{mid} = 1.25$.\n    - This value is less than the analytical critical value of 1.3. A simulation shows the system is drifting. $\\langle \\dot{\\Delta\\theta} \\rangle$ will be significantly larger than $10^{-4}$.\n    - New interval: $[1.25, 1.5]$.\n- **Iteration 3:** $K_{mid} = 1.375$.\n    - Locked. New interval: $[1.25, 1.375]$.\n- **Iteration 4:** $K_{mid} = 1.3125$.\n    - Locked. New interval: $[1.25, 1.3125]$.\n- **Iteration 5:** $K_{mid} = 1.28125$.\n    - Drifting. New interval: $[1.28125, 1.3125]$.\n- **Iteration 6:** $K_{mid} = 1.296875$.\n    - Drifting. New interval: $[1.296875, 1.3125]$.\n\nContinuing this process, the interval containing $K_c$ will shrink around the true value of 1.3. After about 10-12 iterations, the interval width $|K_{high} - K_{low}|$ will be less than $0.001$. For instance, we might end up with an interval like $[1.2995, 1.3005]$. Any value in this interval, when rounded to three significant figures, gives $1.30$.\n\nTherefore, the numerically determined critical coupling strength is $K_c \\approx 1.30 \\text{ rad/s}$.", "answer": "$$\\boxed{1.30}$$", "id": "1695341"}]}