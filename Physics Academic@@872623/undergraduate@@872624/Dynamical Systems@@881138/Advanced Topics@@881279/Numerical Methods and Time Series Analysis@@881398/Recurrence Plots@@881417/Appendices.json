{"hands_on_practices": [{"introduction": "Before we can interpret the rich patterns in a recurrence plot, we must first understand how they are built. This foundational practice walks you through the essential steps: generating a time series from a dynamical system—in this case, the well-known tent map—and then applying the definition of recurrence to construct the corresponding matrix. Completing this exercise [@problem_id:1702866] will solidify your understanding of the direct relationship between a system's trajectory and its visual representation as a recurrence plot.", "problem": "In the study of dynamical systems, a recurrence plot is a tool used to visualize the times at which a state of the system recurs. This is captured by a recurrence matrix, $R$, whose elements indicate whether the system's state at time $i$ is close to its state at time $j$.\n\nConsider the one-dimensional discrete dynamical system known as the tent map, defined by the recurrence relation:\n$$x_{n+1} = 2 \\min(x_n, 1-x_n)$$\nwhere $x_n$ is the state of the system at step $n$.\n\nLet the initial state of the system be $x_0 = 0.1$. First, generate the trajectory for the first four time steps, which is the set of points $\\{x_0, x_1, x_2, x_3\\}$.\n\nThen, construct the $4 \\times 4$ recurrence matrix $R$ for this trajectory. The elements of the matrix, $R_{ij}$, for $i,j \\in \\{0, 1, 2, 3\\}$, are determined by the rule:\n$$\nR_{ij} =\n\\begin{cases}\n1 & \\text{if } |x_i - x_j| \\le \\epsilon \\\\\n0 & \\text{if } |x_i - x_j| > \\epsilon\n\\end{cases}\n$$\nUse a recurrence threshold of $\\epsilon = 0.3$.\n\nPresent your final answer as a $4 \\times 4$ matrix.", "solution": "The tent map is given by $x_{n+1}=2\\min(x_{n},1-x_{n})$, which is equivalent to\n$$\nx_{n+1}=\n\\begin{cases}\n2x_{n} & \\text{if } x_{n}\\le \\frac{1}{2},\\\\\n2-2x_{n} & \\text{if } x_{n}\\ge \\frac{1}{2}.\n\\end{cases}\n$$\nStarting from $x_{0}=0.1$:\n- Since $x_{0}\\le \\frac{1}{2}$, $x_{1}=2x_{0}=0.2$.\n- Since $x_{1}\\le \\frac{1}{2}$, $x_{2}=2x_{1}=0.4$.\n- Since $x_{2}\\le \\frac{1}{2}$, $x_{3}=2x_{2}=0.8$.\nThus the trajectory is $\\{x_{0},x_{1},x_{2},x_{3}\\}=\\{0.1,0.2,0.4,0.8\\}$.\n\nWith recurrence threshold $\\epsilon=0.3$, the recurrence matrix $R$ with entries $R_{ij}=1$ if $|x_{i}-x_{j}|\\le \\epsilon$ and $R_{ij}=0$ otherwise is determined by the pairwise absolute differences:\n$$|x_{0}-x_{0}|=0,\\quad |x_{0}-x_{1}|=0.1,\\quad |x_{0}-x_{2}|=0.3,\\quad |x_{0}-x_{3}|=0.7,$$\n$$|x_{1}-x_{0}|=0.1,\\quad |x_{1}-x_{1}|=0,\\quad |x_{1}-x_{2}|=0.2,\\quad |x_{1}-x_{3}|=0.6,$$\n$$|x_{2}-x_{0}|=0.3,\\quad |x_{2}-x_{1}|=0.2,\\quad |x_{2}-x_{2}|=0,\\quad |x_{2}-x_{3}|=0.4,$$\n$$|x_{3}-x_{0}|=0.7,\\quad |x_{3}-x_{1}|=0.6,\\quad |x_{3}-x_{2}|=0.4,\\quad |x_{3}-x_{3}|=0.$$\nApplying the rule with $\\epsilon=0.3$ yields\n$$\nR=\\begin{pmatrix}\n1 & 1 & 1 & 0\\\\\n1 & 1 & 1 & 0\\\\\n1 & 1 & 1 & 0\\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1 & 1 & 1 & 0\\\\ 1 & 1 & 1 & 0\\\\ 1 & 1 & 1 & 0\\\\ 0 & 0 & 0 & 1\\end{pmatrix}}$$", "id": "1702866"}, {"introduction": "Recurrence plots are powerful because they provide a visual signature for different types of dynamical behavior. This exercise [@problem_id:1702871] challenges you to think conceptually about the simplest possible dynamic: a system at a stable fixed point. By deducing the structure of its recurrence plot, you will learn to connect fundamental system states to their corresponding patterns, a crucial first step in learning to read these intricate maps of dynamics.", "problem": "A chemical process is monitored by a sensor that reads the concentration $x(t)$ of a certain substance at discrete time intervals $t_k = k \\Delta t$ for $k = 1, 2, \\dots, N$. After an initial transient phase, the chemical reaction reaches equilibrium, and the concentration settles at a stable fixed point $x^*$. We analyze the time series data $\\{x_k = x(t_k)\\}$ for $k \\ge K$, where $t_K$ is the time after which the system is considered to be at the fixed point.\n\nTo visualize the system's dynamics, a Recurrence Plot (RP) is constructed from this equilibrium portion of the time series. An RP is a square matrix where the entry at position $(i,j)$ is marked with a black point if the state of the system at time $t_i$ is close to its state at time $t_j$. Mathematically, a point $(i, j)$ is black if the distance between the states $x_i$ and $x_j$ is less than or equal to a predefined threshold $\\epsilon$. Specifically, the recurrence matrix $R$ is defined by its elements $R_{i,j} = \\Theta(\\epsilon - |x_i - x_j|)$, where $\\Theta$ is the Heaviside step function (which is 1 for non-negative arguments and 0 otherwise), and the analysis is performed with an arbitrary but strictly positive threshold, $\\epsilon > 0$.\n\nGiven that the system remains at the stable fixed point $x^*$ for the entire duration of the analyzed time series (i.e., for all $i,j \\in \\{K, K+1, \\ldots, N\\}$), which of the following descriptions best characterizes the appearance of the resulting Recurrence Plot?\n\nA. The plot is entirely white, with no black points.\n\nB. The plot consists of a single black diagonal line (the line of identity) on a white background.\n\nC. The plot consists of multiple, parallel black diagonal lines on a white background.\n\nD. The plot is a solid, completely black square.\n\nE. The plot displays a complex, texture-like pattern with short diagonal segments and isolated points.", "solution": "We analyze the recurrence matrix defined by $R_{i,j} = \\Theta\\!\\left(\\epsilon - |x_{i} - x_{j}|\\right)$ for indices $i,j \\in \\{K, K+1, \\ldots, N\\}$, with $\\epsilon > 0$ and $\\Theta$ the Heaviside step function taking the value $1$ for non-negative arguments.\n\nGiven the system is at a stable fixed point over the analyzed interval, we have\n$$\nx_{i} = x^{*} \\quad \\text{for all } i \\in \\{K, K+1, \\ldots, N\\}.\n$$\nTherefore, for any pair $(i,j)$ in this range,\n$$\n|x_{i} - x_{j}| = |x^{*} - x^{*}| = 0.\n$$\nSubstituting into the definition of the recurrence matrix yields\n$$\nR_{i,j} = \\Theta\\!\\left(\\epsilon - 0\\right) = \\Theta(\\epsilon).\n$$\nSince $\\epsilon > 0$, the argument of $\\Theta$ is strictly positive, and by the given convention $\\Theta$ equals $1$ for non-negative arguments. Hence,\n$$\nR_{i,j} = 1 \\quad \\text{for all } i,j \\in \\{K, K+1, \\ldots, N\\}.\n$$\nA recurrence plot marks entries with $R_{i,j} = 1$ as black points. Because every entry is $1$, every point in the plot is black. Thus the RP is a solid, completely black square, which corresponds to option D.", "answer": "$$\\boxed{D}$$", "id": "1702871"}, {"introduction": "The concept of \"recurrence\" can depend on how closely we look at the system. This advanced problem [@problem_id:1702889] explores the relationship between a recurrence plot of a continuous chaotic trajectory and one generated from its simplified \"symbolic\" representation. By comparing these two plots, you will gain insight into the idea of coarse-graining and how our choice of state space representation impacts the observed dynamics.", "problem": "Consider the one-dimensional full tent map, a discrete-time dynamical system defined on the interval $[0, 1]$ by the function $f(x) = 2 \\min(x, 1-x)$. A time series $\\{x_n\\}_{n=0}^{N-1}$ is generated by iterating the map, $x_{n+1} = f(x_n)$, starting from a generic initial condition $x_0$ that produces a chaotic trajectory.\n\nFrom this time series, we construct a binary symbolic sequence $\\{s_n\\}_{n=0}^{N-1}$ using a partition at $x=1/2$. The symbol $s_n$ is assigned as follows:\n- $s_n = 0$ if $x_n \\in [0, 1/2]$\n- $s_n = 1$ if $x_n \\in (1/2, 1]$\n\nTwo different recurrence plots are then generated, both represented by $N \\times N$ matrices. Let's denote a recurrence plot as a matrix $R$ where $R_{ij}=1$ if states at time $i$ and $j$ are recurrent, and $R_{ij}=0$ otherwise.\n\n1.  The first recurrence plot, $R^{(x)}$, is based on the original time series $\\{x_n\\}$. A recurrence is recorded if the distance between two states is less than or equal to a small threshold $\\epsilon$, where $0 < \\epsilon \\ll 1/2$. Specifically, $R^{(x)}_{ij} = 1$ if $|x_i - x_j| \\le \\epsilon$, and $R^{(x)}_{ij} = 0$ otherwise.\n\n2.  The second recurrence plot, $R^{(s)}$, is based on the symbolic sequence $\\{s_n\\}$. A recurrence is recorded if two symbols are identical. Specifically, $R^{(s)}_{ij} = 1$ if $s_i = s_j$, and $R^{(s)}_{ij} = 0$ otherwise.\n\nWhich of the following statements best describes the relationship between the set of recurrent points in $R^{(x)}$ and the set of recurrent points in $R^{(s)}$ for a sufficiently large $N$ and a typical chaotic trajectory? (A recurrent point is a pair $(i,j)$ for which $R_{ij}=1$.)\n\nA. The set of recurrent points in $R^{(x)}$ is always a subset of the set of recurrent points in $R^{(s)}$.\n\nB. The set of recurrent points in $R^{(s)}$ is always a subset of the set of recurrent points in $R^{(x)}$.\n\nC. The two sets of recurrent points are always identical.\n\nD. The recurrence plot $R^{(s)}$ is a coarse-grained representation of $R^{(x)}$, capturing recurrences to larger regions of the state space. As a result, neither set of recurrent points is a subset of the other.\n\nE. The two recurrence plots are statistically uncorrelated and share no structural similarities because one is derived from a continuous variable and the other from a discrete binary sequence.", "solution": "The full tent map $f(x)=2\\min(x,1-x)$ on $[0,1]$ with the partition at $x=\\frac{1}{2}$ produces a binary symbolic encoding $h(x)$ defined by $h(x)=0$ for $x\\in[0,\\frac{1}{2}]$ and $h(x)=1$ for $x\\in(\\frac{1}{2},1]$. For a typical chaotic trajectory and large $N$, the invariant density is Lebesgue and the system is mixing, so empirical pair-distributions of $(x_{i},x_{j})$ over index pairs approximate independent draws $(X,Y)$ uniform on $[0,1]^{2}$ by ergodicity and mixing.\n\nDefine the sets of recurrent pairs\n$$\nS_{x}=\\{(i,j):|x_{i}-x_{j}|\\le \\epsilon\\},\\quad S_{s}=\\{(i,j):h(x_{i})=h(x_{j})\\},\n$$\nwith $0<\\epsilon\\ll \\frac{1}{2}$. To compare $S_{x}$ and $S_{s}$, compute the corresponding probabilities for independent uniform $X,Y$.\n\nFirst, compute the probability that two points are $\\epsilon$-close:\n$$\n\\mathbb{P}(|X-Y|\\le \\epsilon)=\\text{area of the band of width }\\epsilon\\text{ around the diagonal} = 2\\epsilon-\\epsilon^{2}.\n$$\n\nNext, compute the portion of this band lying on opposite sides of the partition boundary $x=\\frac{1}{2}$. Consider the region $\\{X\\le \\tfrac{1}{2}<Y,\\;Y-X\\le \\epsilon\\}$. This region is nonempty only for $X\\in[\\tfrac{1}{2}-\\epsilon,\\tfrac{1}{2}]$, and for such $X$ we must have $Y\\in[\\tfrac{1}{2},X+\\epsilon]$. Its area is\n$$\n\\int_{x=\\frac{1}{2}-\\epsilon}^{\\frac{1}{2}}\\left[(x+\\epsilon)-\\tfrac{1}{2}\\right]\\,dx\n=\\int_{0}^{\\epsilon}(\\epsilon-t)\\,dt=\\frac{\\epsilon^{2}}{2},\n$$\nafter the substitution $x=\\tfrac{1}{2}-t$. By symmetry, the counterpart with $Y\\le \\tfrac{1}{2}<X$ has the same area, so the total area of pairs with $|X-Y|\\le \\epsilon$ but $h(X)\\ne h(Y)$ is\n$$\n\\epsilon^{2}.\n$$\nTherefore,\n$$\n\\mathbb{P}\\big(|X-Y|\\le \\epsilon,\\;h(X)\\ne h(Y)\\big)=\\epsilon^{2}>0,\n$$\nfor every $\\epsilon>0$. By ergodicity, for large $N$ there will be many index pairs $(i,j)$ with $|x_{i}-x_{j}|\\le \\epsilon$ but $h(x_{i})\\ne h(x_{j})$. Hence $S_{x}\\nsubseteq S_{s}$, so option A is false.\n\nNow, compute the measure of pairs with the same symbol but not $\\epsilon$-close:\n$$\n\\mathbb{P}(h(X)=h(Y))=\\frac{1}{2},\n$$\nsince this is the area of the two diagonal quadrants, each of area $\\frac{1}{4}$. The portion of the $\\epsilon$-band contained within the same-symbol region is the total band minus the cross-boundary part, namely\n$$\n(2\\epsilon-\\epsilon^{2})-\\epsilon^{2}=2\\epsilon-2\\epsilon^{2}.\n$$\nTherefore,\n$$\n\\mathbb{P}\\big(h(X)=h(Y),\\,|X-Y|>\\epsilon\\big)\n=\\frac{1}{2}-(2\\epsilon-2\\epsilon^{2})\n=\\frac{1}{2}-2\\epsilon+2\\epsilon^{2}>0\n$$\nfor $0<\\epsilon<\\frac{1}{2}$. By ergodicity, for large $N$ there are many pairs with $h(x_{i})=h(x_{j})$ but $|x_{i}-x_{j}|>\\epsilon$, so $S_{s}\\nsubseteq S_{x}$. Hence option B is false, and the two sets are not identical, so option C is false.\n\nFinally, $R^{(s)}$ aggregates all points within each half-interval into a single symbol, thereby recording recurrences to large regions rather than to small $\\epsilon$-balls. This is precisely a coarse-graining of $R^{(x)}$. Moreover, the two plots are not statistically uncorrelated: for small $\\epsilon$, most $\\epsilon$-close pairs lie on the same side of the partition, since only an $\\epsilon^{2}$ fraction of the band crosses the boundary. Thus option E is false.\n\nTherefore, the correct description is that $R^{(s)}$ is a coarse-grained representation of $R^{(x)}$, and neither set of recurrent points contains the other.", "answer": "$$\\boxed{D}$$", "id": "1702889"}]}