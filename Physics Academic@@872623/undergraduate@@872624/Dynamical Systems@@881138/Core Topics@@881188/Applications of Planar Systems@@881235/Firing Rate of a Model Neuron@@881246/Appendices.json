{"hands_on_practices": [{"introduction": "The Leaky Integrate-and-Fire (LIF) model is a cornerstone of computational neuroscience, balancing simplicity with the ability to capture essential neural behavior. This first practice provides a foundational exercise in calculating the time it takes for an LIF neuron to fire its first spike when subjected to a constant stimulus [@problem_id:1675499]. Mastering this derivation is key to understanding how a neuron's intrinsic properties and its inputs collectively determine its response timing.", "problem": "A foundational model in computational neuroscience is the Leaky Integrate-and-Fire (LIF) neuron model. The dynamics of its membrane potential, $V(t)$, are governed by the first-order ordinary differential equation:\n$$C \\frac{dV}{dt} = -\\frac{V(t) - V_{rest}}{R} + I(t)$$\nwhere $C$ is the membrane capacitance, $R$ is the membrane resistance, $V_{rest}$ is the resting potential of the neuron, and $I(t)$ is the external input current.\n\nThe \"integrate-and-fire\" behavior is as follows: the neuron's potential $V(t)$ integrates the input current over time. If $V(t)$ reaches a threshold potential $V_{th}$, the neuron is said to \"fire\" a spike. Immediately after firing, its potential is instantaneously reset to a value $V_{reset}$. For a physically meaningful model, we assume $V_{reset}  V_{th}$.\n\nConsider an LIF neuron that is initially at its reset potential, such that $V(0) = V_{reset}$. At time $t=0$, a constant, suprathreshold current $I(t) = I_0$ is injected into the neuron and maintained. A \"suprathreshold\" current is one that is large enough to eventually cause the membrane potential to reach the threshold, which mathematically corresponds to the condition $R I_0  V_{th} - V_{rest}$.\n\nDetermine the analytical expression for the time $T_{spike}$ at which the neuron fires its first spike. Your answer should be expressed in terms of the parameters $R, C, V_{rest}, V_{reset}, V_{th},$ and $I_0$.", "solution": "We start from the linear first-order ODE with constant input:\n$$C \\frac{dV}{dt} = -\\frac{V - V_{rest}}{R} + I_{0}.$$\nDivide both sides by $C$ to write the standard linear form:\n$$\\frac{dV}{dt} + \\frac{1}{RC}V = \\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}.$$\nThis is a linear ODE with constant coefficients. The integrating factor is\n$$\\mu(t) = \\exp\\!\\left(\\int \\frac{1}{RC}\\,dt\\right) = \\exp\\!\\left(\\frac{t}{RC}\\right).$$\nMultiplying through by $\\mu(t)$ yields\n$$\\exp\\!\\left(\\frac{t}{RC}\\right)\\frac{dV}{dt} + \\frac{1}{RC}\\exp\\!\\left(\\frac{t}{RC}\\right)V = \\left(\\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}\\right)\\exp\\!\\left(\\frac{t}{RC}\\right).$$\nThe left-hand side is the derivative of the product $\\exp\\!\\left(\\frac{t}{RC}\\right)V(t)$, so\n$$\\frac{d}{dt}\\!\\left[\\exp\\!\\left(\\frac{t}{RC}\\right)V(t)\\right] = \\left(\\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}\\right)\\exp\\!\\left(\\frac{t}{RC}\\right).$$\nIntegrating in time and absorbing the constant of integration into $V(t)$ gives the general solution in the standard relaxation form. It is convenient to first identify the steady-state (equilibrium) potential for constant input by setting $\\frac{dV}{dt}=0$ in the original ODE:\n$$0 = -\\frac{V_{\\infty} - V_{rest}}{R} + I_{0} \\quad \\Rightarrow \\quad V_{\\infty} = V_{rest} + R I_{0}.$$\nUsing the integrating factor solution and applying the initial condition $V(0)=V_{reset}$, we obtain\n$$V(t) = V_{\\infty} + \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{t}{RC}\\right).$$\nThe first spike occurs at the time $T_{spike}$ when $V(T_{spike})=V_{th}$. Imposing this threshold condition gives\n$$V_{th} = V_{\\infty} + \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right).$$\nRearrange to isolate the exponential:\n$$V_{th} - V_{\\infty} = \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right),$$\n$$\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right) = \\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}}.$$\nTaking the natural logarithm and solving for $T_{spike}$ yields\n$$-\\frac{T_{spike}}{RC} = \\ln\\!\\left(\\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}}\\right), \\quad \\text{so} \\quad T_{spike} = RC \\ln\\!\\left(\\frac{V_{\\infty} - V_{reset}}{V_{\\infty} - V_{th}}\\right).$$\nSubstituting $V_{\\infty} = V_{rest} + R I_{0}$ gives the requested expression in terms of the model parameters. Under the suprathreshold condition $R I_{0}  V_{th} - V_{rest}$, we have $V_{\\infty}  V_{th}$, and with $V_{reset}  V_{th}$ the argument of the logarithm is greater than one, ensuring $T_{spike}  0$.", "answer": "$$\\boxed{RC\\,\\ln\\!\\left(\\frac{V_{rest}+R I_{0}-V_{reset}}{V_{rest}+R I_{0}-V_{th}}\\right)}$$", "id": "1675499"}, {"introduction": "To appreciate the diversity of neural dynamics, it is useful to explore models beyond the standard LIF. This exercise introduces the Quadratic Integrate-and-Fire (QIF) model, which features a nonlinear voltage evolution that can better approximate the firing onset of certain neuron classes [@problem_id:1675521]. By deriving its firing rate, you will employ a different mathematical approach and discover how a change in the model's structure alters the fundamental relationship between input current and output frequency.", "problem": "A simplified model for the electrical activity of a neuron is the Quadratic Integrate-and-Fire (QIF) model. In this model, the membrane potential of the neuron, denoted by $V(t)$, evolves according to the differential equation:\n$$\n\\frac{dV}{dt} = V^2 + I\n$$\nHere, $I$ is a constant, positive parameter representing a steady input current to the neuron. A neuron \"fires\" or \"spikes\" when its membrane potential grows unbounded. For this model, we define a spike as the moment $V(t)$ diverges to positive infinity. Immediately after a spike, the voltage is instantaneously reset to negative infinity, and the process begins anew. The time between two consecutive spikes is called the interspike interval, and the firing rate, $f$, is the reciprocal of this interval.\n\nDetermine the firing rate, $f$, of this QIF neuron as a function of the input current $I$. Your final answer should be a symbolic expression in terms of $I$ and any necessary mathematical constants.", "solution": "We consider the autonomous ordinary differential equation $dV/dt = V^{2} + I$ with $I0$. Between spikes the trajectory evolves continuously, and since $V^{2} + I  0$ for all $V$, the membrane potential $V(t)$ is strictly increasing in time. A spike occurs when $V(t) \\to +\\infty$, after which $V$ is reset to $-\\infty$. Therefore, the interspike interval $T$ equals the time it takes for $V$ to move from $-\\infty$ to $+\\infty$ under the flow.\n\nWe separate variables to compute this time:\n$$\n\\frac{dV}{dt} = V^{2} + I \\quad \\Longrightarrow \\quad dt = \\frac{dV}{V^{2} + I}.\n$$\nHence, the time to move from $V_{0}$ to $V_{1}$ is\n$$\nT(V_{0} \\to V_{1}) = \\int_{V_{0}}^{V_{1}} \\frac{dV}{V^{2} + I}.\n$$\nThe interspike interval is thus\n$$\nT = \\int_{-\\infty}^{+\\infty} \\frac{dV}{V^{2} + I}.\n$$\n\nTo evaluate the integral, note that with $a = \\sqrt{I}$,\n$$\n\\int \\frac{dV}{V^{2} + I} = \\int \\frac{dV}{V^{2} + a^{2}}.\n$$\nUsing the standard antiderivative,\n$$\n\\int \\frac{dV}{V^{2} + a^{2}} = \\frac{1}{a} \\arctan\\!\\left(\\frac{V}{a}\\right) + C,\n$$\nwhich can also be derived by writing\n$$\n\\frac{1}{V^{2} + I} = \\frac{1}{I} \\cdot \\frac{1}{1 + \\left(\\frac{V}{\\sqrt{I}}\\right)^{2}}\n$$\nand substituting $u = V/\\sqrt{I}$, $du = dV/\\sqrt{I}$, leading to\n$$\n\\int \\frac{dV}{V^{2} + I} = \\frac{1}{\\sqrt{I}} \\arctan\\!\\left(\\frac{V}{\\sqrt{I}}\\right) + C.\n$$\n\nTherefore,\n$$\nT = \\left.\\frac{1}{\\sqrt{I}} \\arctan\\!\\left(\\frac{V}{\\sqrt{I}}\\right)\\right|_{V=-\\infty}^{V=+\\infty} = \\frac{1}{\\sqrt{I}}\\left(\\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right)\\right) = \\frac{\\pi}{\\sqrt{I}}.\n$$\nThe firing rate is the reciprocal of the interspike interval:\n$$\nf = \\frac{1}{T} = \\frac{\\sqrt{I}}{\\pi}.\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{I}}{\\pi}}$$", "id": "1675521"}, {"introduction": "We now return to the LIF model to investigate its behavior in a critical and revealing regime: when the input current is just barely strong enough to elicit a spike. This threshold current is known as the rheobase, and analyzing the firing period near this point uncovers a universal scaling law characteristic of a saddle-node bifurcation [@problem_id:1675495]. This practice connects the concrete dynamics of a single neuron to a deeper principle in the theory of dynamical systems, explaining why some neurons can fire at arbitrarily low rates.", "problem": "The Leaky Integrate-and-Fire (LIF) model is a fundamental tool for understanding neural dynamics. It describes how the membrane potential $V$ of a neuron evolves over time in response to an input current $I$. The dynamics are governed by the following differential equation:\n$$ \\tau_m \\frac{d V}{d t} = -(V - V_{rest}) + R_m I $$\nHere, $\\tau_m$ is the membrane time constant, $V_{rest}$ is the resting potential, and $R_m$ is the membrane resistance. All of these are positive constants.\n\nThe neuron generates an action potential, or \"fires,\" whenever its membrane potential $V(t)$ reaches a threshold value $V_{th}$. Immediately after firing, the potential is reset to a value $V_{reset}$. For this model, we assume $V_{rest}  V_{reset}  V_{th}$. The time between two consecutive firings is called the interspike interval, $T_{ISI}$.\n\nA constant current $I$ is applied to the neuron, starting at time $t=0$ with the neuron's potential at the reset value, $V(0) = V_{reset}$. The rheobase current, $I_{rh}$, is defined as the minimum constant input current that is sufficient to make the neuron fire.\n\nConsider the case where the input current $I$ is slightly greater than the rheobase current. Let $\\Delta I = I - I_{rh}$, where $\\Delta I$ is a small, positive quantity. Find an approximate analytical expression for the interspike interval, $T_{ISI}$, which is valid for $\\Delta I \\to 0$. Your expression should capture the leading-order behavior of $T_{ISI}$ as a function of $\\Delta I$ and the model parameters $\\tau_m$, $V_{th}$, $V_{reset}$, and $R_m$.", "solution": "We start from the leaky integrate-and-fire dynamics with constant input current $I$:\n$$\n\\tau_{m} \\frac{dV}{dt} = -(V - V_{rest}) + R_{m} I.\n$$\nFor constant $I$, define the asymptotic (fixed-point) potential $V_{\\infty} = V_{rest} + R_{m} I$. The equation becomes\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau_{m}}(V - V_{\\infty}),\n$$\nwhose solution with initial condition $V(0) = V_{reset}$ is\n$$\nV(t) = V_{\\infty} + \\bigl(V_{reset} - V_{\\infty}\\bigr)\\exp\\!\\left(-\\frac{t}{\\tau_{m}}\\right).\n$$\nThe interspike interval $T_{ISI}$ is the first time $T$ such that $V(T) = V_{th}$, which gives\n$$\nV_{th} = V_{\\infty} + \\bigl(V_{reset} - V_{\\infty}\\bigr)\\exp\\!\\left(-\\frac{T_{ISI}}{\\tau_{m}}\\right).\n$$\nRearranging,\n$$\n\\exp\\!\\left(-\\frac{T_{ISI}}{\\tau_{m}}\\right) = \\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}} = \\frac{V_{\\infty} - V_{th}}{V_{\\infty} - V_{reset}},\n$$\nso\n$$\nT_{ISI} = \\tau_{m} \\ln\\!\\left(\\frac{V_{\\infty} - V_{reset}}{V_{\\infty} - V_{th}}\\right).\n$$\n\nThe rheobase current $I_{rh}$ is defined by the condition that the fixed point reaches threshold:\n$$\nV_{rest} + R_{m} I_{rh} = V_{th} \\quad \\Rightarrow \\quad I_{rh} = \\frac{V_{th} - V_{rest}}{R_{m}}.\n$$\nFor $I = I_{rh} + \\Delta I$ with small $\\Delta I  0$, the fixed point becomes\n$$\nV_{\\infty} = V_{rest} + R_{m}(I_{rh} + \\Delta I) = V_{th} + R_{m}\\Delta I.\n$$\nSubstitute into the exact $T_{ISI}$ formula:\n$$\nT_{ISI} = \\tau_{m} \\ln\\!\\left(\\frac{V_{th} + R_{m}\\Delta I - V_{reset}}{V_{th} + R_{m}\\Delta I - V_{th}}\\right) = \\tau_{m} \\ln\\!\\left(\\frac{V_{th} - V_{reset} + R_{m}\\Delta I}{R_{m}\\Delta I}\\right).\n$$\nFor $\\Delta I \\to 0^{+}$, expand the logarithm:\n$$\nT_{ISI} = \\tau_{m} \\left[ \\ln\\!\\left(\\frac{V_{th} - V_{reset}}{R_{m}\\Delta I}\\right) + \\ln\\!\\left(1 + \\frac{R_{m}\\Delta I}{V_{th} - V_{reset}}\\right) \\right].\n$$\nSince $\\ln(1+x) = x + O(x^{2})$ and $x = \\frac{R_{m}\\Delta I}{V_{th} - V_{reset}} \\to 0$, the second term is $o\\!\\left(\\ln\\!\\left(\\frac{1}{\\Delta I}\\right)\\right)$ and the leading-order behavior is\n$$\nT_{ISI} \\sim \\tau_{m} \\ln\\!\\left(\\frac{V_{th} - V_{reset}}{R_{m}\\Delta I}\\right), \\quad \\text{as } \\Delta I \\to 0^{+}.\n$$\nThis captures the logarithmic divergence of the interspike interval near rheobase in terms of $\\tau_{m}$, $V_{th}$, $V_{reset}$, $R_{m}$, and $\\Delta I$.", "answer": "$$\\boxed{\\tau_{m}\\,\\ln\\!\\left(\\frac{V_{th}-V_{reset}}{R_{m}\\,\\Delta I}\\right)}$$", "id": "1675495"}]}