{"hands_on_practices": [{"introduction": "Before we can simulate the thermal behavior of a physical system, we must first know how to describe its state. In many statistical models like the Ising model, the state is defined by its total energy, which depends on the configuration of its components. This exercise provides foundational practice in calculating this energy for a specific arrangement of spins, paying close attention to neighbor interactions and periodic boundary conditions. [@problem_id:1964969]", "problem": "Consider a two-dimensional Ising model on a 3x3 square lattice. Each lattice site $i$ is occupied by a spin $s_i$ that can take values of +1 (spin up) or -1 (spin down). The total energy $E$ of a spin configuration is given by the Hamiltonian $E = -J \\sum_{\\langle i,j \\rangle} s_i s_j$, where $J$ is a positive ferromagnetic coupling constant and the sum is over all unique nearest-neighbor pairs of spins.\n\nThe system is subject to periodic boundary conditions. This means the lattice wraps around toroidally: the rightmost column of spins is considered a nearest neighbor to the leftmost column, and the bottom row of spins is a nearest neighbor to the top row.\n\nA specific configuration of spins is given as follows, described row by row from top to bottom, with spins within each row listed from left to right:\n- Row 1: +1, -1, +1\n- Row 2: +1, +1, -1\n- Row 3: -1, +1, -1\n\nCalculate the total energy $E$ of this specific configuration. Express your answer as a single numerical value in units of the coupling constant $J$.", "solution": "The Hamiltonian is $E=-J\\sum_{\\langle i,j\\rangle}s_{i}s_{j}$, where the sum runs over all unique nearest-neighbor bonds. On a $3\\times 3$ square lattice with periodic boundary conditions, there are $2L^{2}=18$ unique bonds: $9$ horizontal and $9$ vertical.\n\nLabel the spins by $s_{r,c}$ with $r,c\\in\\{1,2,3\\}$, and use the given configuration:\n$s_{1,1}=+1$, $s_{1,2}=-1$, $s_{1,3}=+1$;\n$s_{2,1}=+1$, $s_{2,2}=+1$, $s_{2,3}=-1$;\n$s_{3,1}=-1$, $s_{3,2}=+1$, $s_{3,3}=-1$.\n\nCompute the horizontal bond sums row by row, using periodicity within each row:\n$H_{1}=s_{1,1}s_{1,2}+s_{1,2}s_{1,3}+s_{1,3}s_{1,1}=(-1)+(-1)+(+1)=-1$,\n$H_{2}=s_{2,1}s_{2,2}+s_{2,2}s_{2,3}+s_{2,3}s_{2,1}=(+1)+(-1)+(-1)=-1$,\n$H_{3}=s_{3,1}s_{3,2}+s_{3,2}s_{3,3}+s_{3,3}s_{3,1}=(-1)+(-1)+(+1)=-1$.\nThus $\\sum_{\\text{horizontal}}s_{i}s_{j}=H_{1}+H_{2}+H_{3}=-3$.\n\nCompute the vertical bond sums column by column, using periodicity within each column:\n$V_{1}=s_{1,1}s_{2,1}+s_{2,1}s_{3,1}+s_{3,1}s_{1,1}=(+1)+(-1)+(-1)=-1$,\n$V_{2}=s_{1,2}s_{2,2}+s_{2,2}s_{3,2}+s_{3,2}s_{1,2}=(-1)+(+1)+(-1)=-1$,\n$V_{3}=s_{1,3}s_{2,3}+s_{2,3}s_{3,3}+s_{3,3}s_{1,3}=(-1)+(+1)+(-1)=-1$.\nThus $\\sum_{\\text{vertical}}s_{i}s_{j}=V_{1}+V_{2}+V_{3}=-3$.\n\nTherefore the total nearest-neighbor sum is\n$$\n\\sum_{\\langle i,j\\rangle}s_{i}s_{j}=(-3)+(-3)=-6,\n$$\nand the energy is\n$$\nE=-J\\left(-6\\right)=6J.\n$$\nExpressed in units of $J$, this gives $E/J=6$.", "answer": "$$\\boxed{6}$$", "id": "1964969"}, {"introduction": "Monte Carlo simulations explore the vast space of possible configurations through a sequence of small, local \"trial moves.\" The crucial quantity for the Metropolis algorithm is not the absolute energy of the system, but the *change* in energy, $\\Delta E$, that a trial move induces. This practice problem focuses on the efficient calculation of $\\Delta E$ for a single spin-flip, which is the fundamental operation performed at each step of a typical simulation. [@problem_id:1964946]", "problem": "Consider a one-dimensional (1D) classical Ising model consisting of a chain of $N=8$ spins, labeled $s_1, s_2, \\dots, s_8$. Each spin $s_i$ can take a value of either $+1$ (up) or $-1$ (down). The system is subject to periodic boundary conditions, meaning that spin $s_8$ is considered a nearest neighbor to spin $s_1$. The total energy, or Hamiltonian, of the system is given by:\n$$H = -J \\sum_{\\langle i,j \\rangle} s_i s_j$$\nwhere $J$ is a positive constant representing the ferromagnetic interaction strength, and the sum is over all unique nearest-neighbor pairs.\n\nSuppose the system is initially in the specific microscopic configuration described by the sequence:\n$$s = (+1, -1, +1, -1, +1, -1, +1, -1)$$\nwhere the $i$-th element in the sequence corresponds to the state of spin $s_i$. A single spin-flip is proposed where only spin $s_1$ is flipped from its initial state to the opposite state, while all other spins ($s_2$ through $s_8$) remain unchanged.\n\nWhat is the change in the total energy of the system, $\\Delta E = E_{\\text{final}} - E_{\\text{initial}}$, due to this single spin-flip?\n\nA. $4J$\n\nB. $2J$\n\nC. $0$\n\nD. $-2J$\n\nE. $-4J$", "solution": "The Hamiltonian is $H=-J\\sum_{\\langle i,j\\rangle}s_{i}s_{j}$ with periodic boundary conditions, so only the two bonds involving $s_{1}$, namely $(8,1)$ and $(1,2)$, change upon flipping $s_{1}$. All other bond contributions cancel in the energy difference.\n\nThe initial local energy from these two bonds is\n$$\nE_{\\text{initial, local}}=-J\\left(s_{8}s_{1}+s_{1}s_{2}\\right).\n$$\nAfter flipping $s_{1}\\to -s_{1}$, the final local energy is\n$$\nE_{\\text{final, local}}=-J\\left(s_{8}(-s_{1})+(-s_{1})s_{2}\\right)=J\\left(s_{8}s_{1}+s_{1}s_{2}\\right).\n$$\nTherefore, the change in total energy is\n$$\n\\Delta E=E_{\\text{final}}-E_{\\text{initial}}=E_{\\text{final, local}}-E_{\\text{initial, local}}=2J\\left(s_{8}s_{1}+s_{1}s_{2}\\right)=2J\\,s_{1}\\left(s_{8}+s_{2}\\right).\n$$\nFor the given configuration, $s_{1}=+1$, $s_{2}=-1$, and $s_{8}=-1$, so\n$$\n\\Delta E=2J\\cdot(+1)\\cdot\\left((-1)+(-1)\\right)=-4J.\n$$\nThis corresponds to option E.", "answer": "$$\\boxed{E}$$", "id": "1964946"}, {"introduction": "After calculating the energy change $\\Delta E$, the algorithm must probabilistically decide whether to accept or reject the new configuration. This decision is the core of the Metropolis algorithm, ensuring that the simulation correctly samples states according to the Boltzmann distribution. This final exercise challenges you to analyze a concise and common implementation of this acceptance rule, revealing how a single line of code can correctly handle both energy-increasing and energy-decreasing moves. [@problem_id:1964945]", "problem": "A student, Alex, is writing a Metropolis Monte Carlo simulation for a simple 2D lattice gas model. In this model, particles occupy sites on a grid, and the total energy $E$ of the system is calculated based on the interactions between neighboring particles. The goal of the simulation is to sample configurations from the canonical ensemble at a given temperature $T$.\n\nAlex's simulation proceeds in steps. At each step, a trial move is proposed (e.g., moving a single particle to a random adjacent empty site). Let the energy of the current configuration be $E_{old}$ and the energy of the proposed new configuration be $E_{new}$. The change in energy is $\\Delta E = E_{new} - E_{old}$.\n\nAlex implements the core acceptance/rejection logic with the following line of pseudo-code, where `rand()` is a function that returns a uniformly distributed random floating-point number from the interval $[0, 1)$. The move is accepted if the condition is true.\n\n`if rand()  exp(-ΔE / (k_B * T))`\n\nHere, $k_B$ is the Boltzmann constant. Alex runs the simulation and finds that the system seems to be reaching a reasonable equilibrium state. However, they are concerned because their code does not contain an explicit `if/else` structure to distinguish between moves that increase energy ($\\Delta E > 0$) and moves that decrease energy ($\\Delta E \\le 0$), which is how the algorithm was presented in their textbook.\n\nWhich of the following statements provides the most accurate analysis of Alex's implementation?\n\nA. The code is fundamentally flawed because it will never accept moves that lower the system's energy ($\\Delta E \\le 0$).\n\nB. The code is fundamentally flawed because it accepts all proposed moves, regardless of the energy change, preventing the system from reaching thermal equilibrium.\n\nC. The code functions correctly because for any move that lowers the energy ($\\Delta E \\le 0$), the term $\\exp(-\\Delta E / (k_B T))$ evaluates to a value greater than or equal to 1, ensuring the acceptance condition is always met.\n\nD. The code is only correct in the high-temperature limit ($k_B T \\gg |\\Delta E|$), where the exponential term can be approximated as 1, but it fails at low temperatures.\n\nE. The code is fundamentally flawed because it violates the principle of detailed balance by not explicitly handling the case where $\\Delta E \\le 0$ with an acceptance probability of 1.", "solution": "Let $\\beta$ denote the inverse temperature, $\\beta = \\frac{1}{k_{B}T}$. In the Metropolis algorithm with a symmetric proposal distribution, the acceptance probability that ensures sampling from the canonical ensemble and satisfies detailed balance is\n$$\nA(\\Delta E) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\nAlex’s code accepts the move if a uniform random variate $r \\sim \\text{Uniform}[0,1)$ satisfies\n$$\nr  \\exp(-\\beta \\Delta E).\n$$\nThe acceptance probability realized by this rule is the probability, with respect to $r$, that the event $\\{r  \\exp(-\\beta \\Delta E)\\}$ occurs. Since $r$ is uniform on $[0,1)$,\n$$\nP(\\text{accept}) = \\int_{0}^{1} \\mathbf{1}\\{r  \\exp(-\\beta \\Delta E)\\} \\, dr.\n$$\nThis integral evaluates piecewise, depending on the value of $\\exp(-\\beta \\Delta E)$ relative to $1$:\n\n1) If $\\Delta E \\le 0$, then $-\\beta \\Delta E \\ge 0$, hence\n$$\n\\exp(-\\beta \\Delta E) \\ge 1.\n$$\nBecause $r \\in [0,1)$ and $\\exp(-\\beta \\Delta E) \\ge 1$, the inequality $r  \\exp(-\\beta \\Delta E)$ holds for all $r$ in $[0,1)$. Therefore,\n$$\nP(\\text{accept}) = 1 = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\nIn particular, when $\\Delta E = 0$, $\\exp(0) = 1$ and, since $r  1$ almost surely for $r \\in [0,1)$, acceptance occurs with probability $1$, as required.\n\n2) If $\\Delta E  0$, then $-\\beta \\Delta E  0$, hence\n$$\n\\exp(-\\beta \\Delta E)  1,\n$$\nand the event $\\{r  \\exp(-\\beta \\Delta E)\\}$ occurs with probability exactly $\\exp(-\\beta \\Delta E)$, because the length of the interval $\\{r \\in [0,1) : r  \\exp(-\\beta \\Delta E)\\}$ is $\\exp(-\\beta \\Delta E)$. Thus,\n$$\nP(\\text{accept}) = \\exp(-\\beta \\Delta E) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\n\nCombining these cases,\n$$\nP(\\text{accept}) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right),\n$$\nwhich is precisely the Metropolis acceptance rule that enforces detailed balance for a symmetric proposal. Therefore, Alex’s single-line condition implicitly implements the $\\min$ operation because $r$ is restricted to $[0,1)$. It accepts all energy-lowering or equal-energy moves with probability $1$ and accepts energy-increasing moves with probability $\\exp(-\\beta \\Delta E)$. Consequently:\n- It is not the case that energy-lowering moves are rejected (rejects A).\n- It does not accept all moves (rejects B).\n- It is not limited to the high-temperature regime (rejects D).\n- It does not violate detailed balance; the correct acceptance probability is realized (rejects E).\n\nHence, the most accurate statement is that the code functions correctly for all temperatures because $\\exp(-\\Delta E/(k_{B}T)) \\ge 1$ when $\\Delta E \\le 0$, ensuring acceptance, and yields the correct probabilistic acceptance when $\\Delta E  0$.", "answer": "$$\\boxed{C}$$", "id": "1964945"}]}