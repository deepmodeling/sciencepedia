{"hands_on_practices": [{"introduction": "The proof that BQP is contained in PP relies on mapping quantum transition amplitudes to functions in the counting complexity class GapP. For circuits composed of gates with rational entries, this connection is direct and exact. This exercise provides a foundational, hands-on calculation to demystify this link by computing the integer \"GapP value\" corresponding to a specific transition amplitude in a simple 2-qubit circuit [@problem_id:130916].", "problem": "**Background:** The complexity class GapP consists of functions $f(x)$ that compute the difference between the number of accepting and rejecting paths of a non-deterministic polynomial-time Turing machine. Transition amplitudes of quantum circuits constructed from gates with rational-valued matrix entries are themselves rational numbers. For a transition amplitude $A = p/q$, the integer numerator $p$ can be computed by a GapP function for a fixed denominator $q$. This integer $p$ is referred to as the GapP value of the amplitude for the specified denominator $q$.\n\n**Problem:** Consider a 2-qubit system prepared in the initial state $|\\psi_{in}\\rangle = |00\\rangle$. A quantum circuit $U$ is applied, which is defined as the sequence of three operations: $U = U_3 U_2 U_1$. The operations are as follows:\n1.  $U_1 = H \\otimes I$: A Hadamard gate $H$ is applied to the first qubit, while the second qubit is unchanged.\n2.  $U_2 = C-R$: A controlled-gate, with the first qubit as the control and the second qubit as the target. The single-qubit unitary operation $R$ is described by the real-valued matrix:\n    $$\n    R = \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n    $$\n    where $s = a/d$ and $c = b/d$ are rational parameters, with $a, b, d$ being integers.\n3.  $U_3 = H \\otimes I$: Another Hadamard gate is applied to the first qubit.\n\nYour task is to compute the GapP value of the transition amplitude $A = \\langle 11 | U | 00 \\rangle$. The denominator for this amplitude is fixed to be $2d$. Express your answer in terms of the parameter $a$.", "solution": "1. Initial state and first Hadamard:\n$$|\\psi_0\\rangle = |0\\rangle\\otimes|0\\rangle,\\quad\nU_1=H\\otimes I,\\quad\nH|0\\rangle=\\frac{|0\\rangle+|1\\rangle}{\\sqrt2}.$$\nThus\n$$|\\psi_1\\rangle\n=U_1|\\psi_0\\rangle\n=\\frac{1}{\\sqrt2}(|0\\rangle+|1\\rangle)\\otimes|0\\rangle\n=\\frac{|00\\rangle+|10\\rangle}{\\sqrt2}.$$\n\n2. Controlled-$R$ with\n$$R=\\begin{pmatrix}c&-s\\\\s&c\\end{pmatrix},\\quad\nc=\\frac{b}{d},\\;s=\\frac{a}{d}.$$\nOn $|00\\rangle$ (control=0) it acts trivially; on $|10\\rangle$ (control=1):\n$$|10\\rangle\\mapsto|1\\rangle\\otimes R|0\\rangle\n=|1\\rangle\\otimes\\bigl(c|0\\rangle+s|1\\rangle\\bigr)\n=c|10\\rangle+s|11\\rangle.$$\nHence\n$$|\\psi_2\\rangle\n=\\frac{1}{\\sqrt2}\\bigl(|00\\rangle+c|10\\rangle+s|11\\rangle\\bigr).$$\n\n3. Second Hadamard on the first qubit:\n$$U_3=H\\otimes I,\\quad\nH|0\\rangle=\\tfrac{|0\\rangle+|1\\rangle}{\\sqrt2},\\;\nH|1\\rangle=\\tfrac{|0\\rangle-|1\\rangle}{\\sqrt2}.$$\nApply to each term in $|\\psi_2\\rangle$:\n\n$$\n\\begin{aligned}\n|00\\rangle&\\mapsto\\tfrac1{\\sqrt2}(|0\\rangle+|1\\rangle)\\otimes|0\\rangle,\\\\\nc\\,|10\\rangle&\\mapsto\\tfrac{c}{\\sqrt2}(|0\\rangle-|1\\rangle)\\otimes|0\\rangle,\\\\\ns\\,|11\\rangle&\\mapsto\\tfrac{s}{\\sqrt2}(|0\\rangle-|1\\rangle)\\otimes|1\\rangle.\n\\end{aligned}\n$$\n\nSumming and including the prefactor $1/\\sqrt2$ gives\n$$|\\psi_3\\rangle\n=\\frac1{2}\\Bigl[(1+c)|00\\rangle+(1-c)|10\\rangle\n+s\\,|01\\rangle -s\\,|11\\rangle\\Bigr].$$\n\n4. Extract the amplitude $A=\\langle11|\\psi_3\\rangle$:\n$$A=-\\frac{s}{2}=-\\frac{a/d}{2}=-\\frac{a}{2d}.$$\n\n5. For denominator $2d$, the integer numerator (GapP value) is\n$$p=-a.$$", "answer": "$$\\boxed{-a}$$", "id": "130916"}, {"introduction": "In general, quantum circuits involve gates with irrational amplitudes, which must be approximated for classical simulation. This practice explores the Feynman path integral formalism, a cornerstone of the BQP $\\subseteq$ PP proof, where you will simulate a quantum computation by summing over weighted computational paths. You will apply the crucial technique of dyadic rational approximation to determine the total weight of constructive paths ($N_{acc}$), a value that belongs to the counting class #P, and see how it contributes to the overall transition amplitude [@problem_id:130813].", "problem": "In the study of computational complexity, the relationship between the quantum complexity class BQP (Bounded-error Quantum Polynomial time) and classical complexity classes like P and NP is a subject of fundamental importance. It has been shown that BQP is contained in PP (Probabilistic Polynomial time), a class of problems solvable by a probabilistic Turing machine with an exponentially small probability gap. The proof of this containment, BQP $\\subseteq$ PP, relies on simulating a quantum computation via a path integral formalism, reminiscent of Feynman's path integrals in quantum mechanics.\n\nA quantum computation is described by a sequence of unitary gates $U = U_m U_{m-1} \\dots U_1$. The amplitude of transitioning from an initial state $|x\\rangle$ to a final state $|y\\rangle$ is given by the sum over all possible computational paths:\n$$\n\\langle y | U | x \\rangle = \\sum_{z_1, \\dots, z_{m-1}} \\langle y | U_m | z_{m-1} \\rangle \\dots \\langle z_1 | U_1 | x \\rangle\n$$\nEach term in the sum corresponds to the amplitude of a single path. To simulate this on a classical probabilistic machine, the gate amplitudes, which can be irrational complex numbers, are approximated by dyadic rationals (fractions with a power-of-two denominator). For a given precision parameter $p$, each real-valued gate matrix element $g_{uv} = \\langle u | G | v \\rangle$ is approximated by $\\tilde{g}_{uv} = k_{uv}/2^p$, where $k_{uv} = \\text{round}(2^p \\cdot g_{uv})$ is an integer. For complex amplitudes, real and imaginary parts are approximated separately.\n\nThe total approximate amplitude is a sum of products of these dyadic rationals, which can be written as $S / 2^{mp}$. The integer quantity $S = \\sum_{\\text{paths}} \\prod_{\\text{gates}} k_{uv}$ is a GapP function, meaning it can be expressed as the difference between the number of accepting paths ($N_{acc}$) and rejecting paths ($N_{rej}$) of a non-deterministic Turing machine. Specifically, we define the weight of a path as the product of its integer numerators $W(\\text{path}) = \\prod k_{uv}$. Then, $N_{acc} = \\sum_{W>0} W(\\text{path})$ and $N_{rej} = \\sum_{W<0} |W(\\text{path})|$. The values $N_{acc}$ and $N_{rej}$ are computable in #P.\n\nYour task is to perform such a calculation for a specific 2-qubit quantum circuit.\n\n**Problem Statement:**\n\nConsider a 2-qubit quantum circuit described by the unitary operator $U = U_3 U_2 U_1$, where:\n1.  $U_1 = -H \\otimes I$, where $H$ is the Hadamard gate and $I$ is the identity gate.\n2.  $U_2$ is a controlled-$R_Y(\\theta)$ gate, with the first qubit as control and the second as target, with rotation angle $\\theta = \\pi/3$. The $R_Y(\\theta)$ gate is defined as:\n    $$R_Y(\\theta) = \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix}$$\n3.  $U_3 = H \\otimes I$.\n\nThe gate matrices act on the standard computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$. All gate matrix entries are real. The dyadic approximation for a gate entry $g_{uv}$ is $\\tilde{g}_{uv} = k_{uv} / 2^p$, with the integer numerator $k_{uv} = \\text{round}(2^p \\cdot g_{uv})$ and precision $p=5$. The $\\text{round()}$ function rounds a real number to the nearest integer (with half-integers rounded up).\n\nCalculate the value of $N_{acc}$ for the transition amplitude from initial state $|x\\rangle = |00\\rangle$ to final state $|y\\rangle = |11\\rangle$. This value is the sum of weights of all computational paths that have a positive total weight.", "solution": "1. The amplitude for the transition $|00\\rangle\\to|11\\rangle$ is\n$$\n\\langle11|U_3U_2U_1|00\\rangle\n=\\sum_{z_1,z_2}\\langle11|U_3|z_2\\rangle\\langle z_2|U_2|z_1\\rangle\\langle z_1|U_1|00\\rangle.\n$$\n\n2. Matrix-element amplitudes (exact):\n- $U_1=-H\\otimes I$ gives \n  $$\\langle z_1|U_1|00\\rangle=\n  \\begin{cases}\n  -\\tfrac1{\\sqrt2},&z_1=00,10,\\\\\n  0,&\\text{otherwise.}\n  \\end{cases}$$\n- $U_2=\\mathrm{C}\\!R_Y(\\pi/3)$ acts as identity if first bit $=0$, and as\n  $$R_Y(\\tfrac\\pi3)=\\begin{pmatrix}\\cos\\tfrac\\pi6&-\\sin\\tfrac\\pi6\\\\\\sin\\tfrac\\pi6&\\cos\\tfrac\\pi6\\end{pmatrix}\n  $$\n  if first bit $=1$.  Hence\n  $$\\langle z_2|U_2|z_1\\rangle\\neq0\\iff z_1=10,\\ z_2\\in\\{10,11\\},$$\n  with \n  $$\\langle11|U_2|10\\rangle=\\sin\\tfrac\\pi6=\\tfrac12.$$\n- $U_3=H\\otimes I$ gives\n  $$\\langle11|U_3|z_2\\rangle\\neq0\\iff z_2\\in\\{01,11\\},\\quad\n  \\langle11|U_3|11\\rangle=-\\tfrac1{\\sqrt2}.$$\n\n3. The only nonzero path is $00\\to z_1=10\\to z_2=11\\to11$, with exact amplitude\n$$\n(-\\tfrac1{\\sqrt2})\\times(\\tfrac12)\\times(-\\tfrac1{\\sqrt2})\n=\\;\\frac1{4}.\n$$\n\n4. Dyadic approximation with $p=5$: multiply each exact entry $g$ by $2^5=32$ and round.\n   - For $U_1$: $g=-\\tfrac1{\\sqrt2}=-\\tfrac{\\sqrt2}{2}\\;\\Longrightarrow\\;k_1=\\round(32\\cdot(-\\tfrac{\\sqrt2}{2}))=\\round(-16\\sqrt2)=-23$.\n   - For $U_2$: $g=\\tfrac12\\;\\Longrightarrow\\;k_2=\\round(32\\cdot\\tfrac12)=16$.\n   - For $U_3$: $g=-\\tfrac1{\\sqrt2}\\;\\Longrightarrow\\;k_3=-23$.\n\n5. The integer weight of the unique path is\n$$\nW = k_1\\,k_2\\,k_3 = (-23)\\times16\\times(-23)=23^2\\cdot16=8464>0.\n$$\nThus $N_{acc}$, the sum of positive weights, is $8464$.", "answer": "$$\\boxed{8464}$$", "id": "130813"}, {"introduction": "The dyadic rational approximation is essential for simulating quantum circuits on a classical machine, but it introduces a controlled error and breaks the perfect unitarity of the quantum evolution. This exercise highlights the practical consequences of this approximation by having you compare the simulated outcome of a circuit at two different levels of precision. By calculating the difference in acceptance probability, you will gain a deeper appreciation for the nature of the BQP-to-PP simulation and why the computational power of PP is required to handle it [@problem_id:130804].", "problem": "The proof that the complexity class BQP is contained within PP (BQP $\\subseteq$ PP) involves simulating a quantum circuit with a probabilistic Turing machine. A crucial element of this simulation is the approximation of the unitary gate matrices. The entries of these matrices, which can be arbitrary complex numbers, are approximated by dyadic rationals (numbers of the form $k/2^p$), which can be handled by a classical computer. This process allows the PP machine to precisely calculate the amplitude of any computational path.\n\nConsider a simple quantum circuit composed of a single two-qubit controlled-$R_z(\\theta)$ gate, with the rotation angle set to $\\theta = \\pi/4$. The gate matrix is given by:\n$$\nC-R_z(\\theta) = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & e^{-i\\theta/2} & 0 \\\\\n0 & 0 & 0 & e^{i\\theta/2}\n\\end{pmatrix}\n$$\nThe system is initialized in the state $|\\psi_{\\text{in}}\\rangle = |+\\rangle \\otimes |+\\rangle$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$. The computation is defined to \"accept\" if a measurement of the first (control) qubit in the computational basis yields the outcome $|1\\rangle$.\n\nThe simulation approximates the true gate matrix $U = C-R_z(\\pi/4)$ with a matrix $\\tilde{U}_D$ whose entries are based on dyadic rationals with a denominator $D$. The approximation rule is as follows: For the non-trivial entries $e^{\\pm i\\pi/8}$, their real and imaginary parts are individually rounded to the nearest rational of the form $k/D$, where $k$ is an integer. In the case of a tie (a value being exactly halfway between two such rationals), the value with the larger magnitude is chosen. The entries $1$ and $0$ are already exact dyadic rationals and are not changed.\n\nLet $\\tilde{P}_D$ be the acceptance probability calculated using the gate matrix $\\tilde{U}_D$ approximated with denominator $D$. Your task is to calculate the absolute difference $|\\tilde{P}_{16} - \\tilde{P}_8|$.", "solution": "We have the input state  \n$$|\\psi_\\text{in}\\rangle = |+\\rangle\\otimes|+\\rangle\n=\\frac12\\bigl(|00\\rangle+|01\\rangle+|10\\rangle+|11\\rangle\\bigr)\\,. $$\nAfter applying $U=C\\!-\\!R_z(\\pi/4)$ the exact output is  \n$$|\\psi_\\text{out}\\rangle\n=\\frac12\\bigl(|00\\rangle+|01\\rangle+e^{-i\\pi/8}|10\\rangle+e^{i\\pi/8}|11\\rangle\\bigr)\\,. $$\nMeasuring the first qubit and accepting on outcome $|1\\rangle$ gives the exact probability  \n$$P=\\frac14\\bigl|e^{-i\\pi/8}\\bigr|^2+\\frac14\\bigl|e^{i\\pi/8}\\bigr|^2\n=\\frac14(1+1)=\\frac12\\,. $$\n\nUnder the dyadic approximation with denominator $D$, we replace\n$$e^{\\pm i\\pi/8}=\\cos\\frac{\\pi}{8}\\pm i\\sin\\frac{\\pi}{8}$$\nby rounding each of $\\{\\cos\\frac{\\pi}{8},\\sin\\frac{\\pi}{8}\\}$ to the nearest multiple of $1/D$.  \n\n1. For $D=16$:\n   $$\\cos\\frac{\\pi}{8}\\approx0.9239\\to\\frac{15}{16},\\quad\n     \\sin\\frac{\\pi}{8}\\approx0.3827\\to\\frac{6}{16},$$\n   so \n   $$\\tilde a_{16}=e^{-i\\pi/8}\\to\\frac{15-6i}{16},\\quad\n     \\tilde b_{16}=e^{i\\pi/8}\\to\\frac{15+6i}{16}.$$\n   Then\n   $$|\\tilde a_{16}|^2\n     =\\Bigl(\\frac{15}{16}\\Bigr)^2+\\Bigl(\\frac{6}{16}\\Bigr)^2\n     =\\frac{225+36}{256}=\\frac{261}{256},$$\n   and the acceptance probability is\n   $$\\tilde P_{16}\n     =\\frac14\\bigl(|\\tilde a_{16}|^2+|\\tilde b_{16}|^2\\bigr)\n     =\\frac12\\,|\\tilde a_{16}|^2\n     =\\frac12\\cdot\\frac{261}{256}\n     =\\frac{261}{512}.$$\n\n2. For $D=8$:\n   $$\\cos\\frac{\\pi}{8}\\approx0.9239\\to\\frac{7}{8},\\quad\n     \\sin\\frac{\\pi}{8}\\approx0.3827\\to\\frac{3}{8},$$\n   so \n   $$\\tilde a_{8}=\\frac{7-3i}{8},\\quad \\tilde b_{8}=\\frac{7+3i}{8}.$$\n   Then\n   $$|\\tilde a_{8}|^2\n     =\\Bigl(\\frac{7}{8}\\Bigr)^2+\\Bigl(\\frac{3}{8}\\Bigr)^2\n     =\\frac{49+9}{64}=\\frac{58}{64}=\\frac{29}{32},$$\n   and\n   $$\\tilde P_{8}\n     =\\frac12\\,|\\tilde a_{8}|^2\n     =\\frac12\\cdot\\frac{29}{32}\n     =\\frac{29}{64}.$$\n\nTherefore the absolute difference is\n$$\\bigl|\\tilde P_{16}-\\tilde P_{8}\\bigr|\n=\\Bigl|\\frac{261}{512}-\\frac{29}{64}\\Bigr|\n=\\frac{261-232}{512}\n=\\frac{29}{512}\\,. $$", "answer": "$$\\boxed{\\frac{29}{512}}$$", "id": "130804"}]}