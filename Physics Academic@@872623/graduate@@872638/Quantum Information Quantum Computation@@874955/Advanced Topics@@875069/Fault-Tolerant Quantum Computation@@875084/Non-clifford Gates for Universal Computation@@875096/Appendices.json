{"hands_on_practices": [{"introduction": "In fault-tolerant quantum computation, the T-gate is an essential but costly resource. The efficiency of a quantum algorithm is therefore often measured by its 'T-count'—the total number of T-gates required. This exercise [@problem_id:105286] provides a practical scenario in magic state distillation where you can apply logical reasoning to dramatically reduce the T-count, highlighting the crucial role of circuit optimization in making quantum algorithms feasible.", "problem": "In the theory of fault-tolerant quantum computation, non-Clifford gates are considered a critical but expensive resource. The cost of a quantum circuit is often dominated by the number of non-Clifford T gates, a metric known as the T-count. The Toffoli (CCNOT) gate is a fundamental non-Clifford gate. A highly optimized circuit for the Toffoli gate using the Clifford+T gate set has a T-count of 7.\n\nA crucial application of non-Clifford resources is in the preparation of \"magic states,\" which are required to perform T gates in many fault-tolerant architectures. The 15-to-1 magic state distillation protocol is a well-known method for producing high-fidelity magic states from 15 lower-quality ones. A particular implementation of this protocol's circuit uses 8 Toffoli gates, with the rest of the circuit consisting of Clifford gates (Hadamard, CNOT, S, etc.) and measurements.\n\nAn optimization is proposed for this distillation circuit. Analysis of the algorithm reveals that for 4 of the 8 Toffoli gates, one of the two control qubits is always in the computational basis state $|0\\rangle$ when the gate is applied. A Toffoli gate is a doubly-controlled-NOT gate, applying an $X$ gate to the target qubit if and only if both control qubits are in the state $|1\\rangle$.\n\nCalculate the total T-count for the entire 15-to-1 distillation circuit after implementing the proposed optimization.", "solution": "The 15-to-1 magic state distillation circuit initially uses 8 Toffoli gates, each with a T-count of 7. The total T-count for these gates is:\n\n$$\n8 \\times 7 = 56\n$$\n\nThe optimization identifies that for 4 of these Toffoli gates, one control qubit is always in the state $|0\\rangle$. Since a Toffoli gate applies an $X$ gate to the target only if both controls are $|1\\rangle$, and one control is $|0\\rangle$, the gate has no effect on the target qubit. Moreover, because the control is in a computational basis state and the gate is classical in behavior (no phase changes in the computational basis), these gates can be removed without altering the circuit's functionality. Thus, the T-count for these 4 gates is reduced to 0.\n\nThe remaining 4 Toffoli gates, without this condition, each retain a T-count of 7. Their total T-count is:\n\n$$\n4 \\times 7 = 28\n$$\n\nThe rest of the circuit consists of Clifford gates (Hadamard, CNOT, S, etc.) and measurements. Clifford gates have a T-count of 0, and measurements do not contribute to the T-count. Therefore, the total T-count of the entire optimized circuit is solely due to the 4 unoptimized Toffoli gates:\n\n$$\n28\n$$", "answer": "$$ \\boxed{28} $$", "id": "105286"}, {"introduction": "The Clifford+T gate set is universal, meaning it can approximate any desired quantum operation. This practice [@problem_id:105345] delves into the practical task of gate synthesis: approximating a continuous rotation gate, which is not in our native gate set, with a sequence of Clifford and T-gates. You will use a standard algorithm based on dyadic fractions to find an approximation and calculate its corresponding T-count, a core function of modern quantum compilers.", "problem": "In the field of fault-tolerant quantum computation, arbitrary single-qubit rotations are synthesized by sequences of gates from a universal fault-tolerant set, typically composed of Clifford gates and the non-Clifford T-gate. The number of T-gates, or T-count, is a primary metric for the cost of the synthesized circuit.\n\nAn arbitrary $Z$-rotation, $R_z(\\theta) = \\exp(-i\\theta Z/2)$, cannot generally be synthesized exactly. Instead, it is approximated by an exactly synthesizable rotation, $R_z(\\theta_{approx})$. A common method approximates $\\theta$ with a dyadic angle $\\theta_{approx} = 2\\pi \\frac{m}{2^N}$, where $N$ is a given integer precision parameter. The integer $m$ is chosen by rounding the fractional part of the target angle to the nearest dyadic fraction: $m = \\text{round}\\left(2^N \\frac{\\theta}{2\\pi}\\right)$.\n\nFor such an angle, the rotation $R_z(\\theta_{approx})$ can be synthesized (up to a global phase) using a circuit of Clifford and T-gates. A prominent synthesis algorithm yields a T-count given by the formula:\n$$ T_{count} = 2 \\cdot |m|_{CSD} - 2 $$\nwhere $|m|_{CSD}$ is the Hamming weight (number of non-zero digits) of the Canonical Signed-Digit (CSD) representation of the integer $m$. The CSD representation of an integer is a base-2 representation where the digits are from the set $\\{-1, 0, 1\\}$ and no two consecutive digits are non-zero. For example, the CSD representation of $3$ is $10\\bar{1}$, where $\\bar{1}$ denotes $-1$, and its CSD weight is $2$.\n\n**Problem:**\nCalculate the T-count required to synthesize a Z-rotation gate $R_z(\\theta)$, where the angle $\\theta \\in [0, \\pi]$ is defined by $\\cos(\\theta) = 3/5$. The synthesis is to be performed for an approximant with precision parameter $N=10$. Assume the T-count is given by the formula above.", "solution": "The problem asks for the T-count to synthesize an approximation of a specific Z-rotation, $R_z(\\theta)$, where $\\cos(\\theta) = 3/5$. The T-count depends on the integer $m$ which defines the approximating angle $\\theta_{approx} = 2\\pi \\frac{m}{2^N}$.\n\n**Step 1: Determine the angle $\\theta$.**\nWe are given $\\cos(\\theta) = 3/5$ and that $\\theta \\in [0, \\pi]$. We need to find the value of $\\theta$ to compute the fraction $\\frac{\\theta}{2\\pi}$.\nThe angle $\\theta$ is explicitly $\\theta = \\arccos(3/5)$.\n\n**Step 2: Calculate the integer $m$.**\nThe parameter $m$ is determined by $m = \\text{round}\\left(2^N \\frac{\\theta}{2\\pi}\\right)$. We are given $N=10$, so $2^N = 1024$.\n$$ m = \\text{round}\\left(1024 \\cdot \\frac{\\arccos(3/5)}{2\\pi}\\right) $$\nFirst, we find the numerical value of the argument:\n$\\theta = \\arccos(3/5) \\approx 0.927295218$ radians.\n$$ \\frac{\\theta}{2\\pi} \\approx \\frac{0.927295218}{2 \\pi} \\approx 0.147583617 $$\nNow, we can find $m$:\n$$ m = \\text{round}(1024 \\cdot 0.147583617) = \\text{round}(151.12501) = 151 $$\n\n**Step 3: Find the Canonical Signed-Digit (CSD) representation of $m=151$.**\nThe CSD representation uses digits $\\{0, 1, \\bar{1}\\}$, where $\\bar{1}=-1$, with the property that no two consecutive digits are non-zero. We can find the CSD representation of $m=151$ algorithmically. Let $m_0=151$.\n\n-   $m_0 = 151$. This is odd. $151 \\pmod 4 = 3$. The last digit is $\\bar{1}$. $m_1 = (151 - \\bar{1})/2 = (151+1)/2 = 76$. Current CSD: $\\bar{1}$.\n-   $m_1 = 76$. This is even. The next digit is $0$. $m_2 = 76/2 = 38$. Current CSD: $0\\bar{1}$.\n-   $m_2 = 38$. This is even. The next digit is $0$. $m_3 = 38/2 = 19$. Current CSD: $00\\bar{1}$.\n-   $m_3 = 19$. This is odd. $19 \\pmod 4 = 3$. The next digit is $\\bar{1}$. $m_4 = (19 - \\bar{1})/2 = (19+1)/2 = 10$. Current CSD: $\\bar{1}00\\bar{1}$.\n-   $m_4 = 10$. This is even. The next digit is $0$. $m_5 = 10/2 = 5$. Current CSD: $0\\bar{1}00\\bar{1}$.\n-   $m_5 = 5$. This is odd. $5 \\pmod 4 = 1$. The next digit is $1$. $m_6 = (5 - 1)/2 = 2$. Current CSD: $10\\bar{1}00\\bar{1}$.\n-   $m_6 = 2$. This is even. The next digit is $0$. $m_7 = 2/2 = 1$. Current CSD: $010\\bar{1}00\\bar{1}$.\n-   $m_7 = 1$. This is odd. $1 \\pmod 4 = 1$. The next digit is $1$. $m_8 = (1 - 1)/2 = 0$. Current CSD: $1010\\bar{1}00\\bar{1}$.\n\nThe CSD representation of $151$ is $1010\\bar{1}00\\bar{1}$.\nLet's verify this: $1 \\cdot 2^7 + 0 \\cdot 2^6 + 1 \\cdot 2^5 + 0 \\cdot 2^4 - 1 \\cdot 2^3 + 0 \\cdot 2^2 + 0 \\cdot 2^1 - 1 \\cdot 2^0 = 128 + 32 - 8 - 1 = 160 - 9 = 151$. The representation is correct.\n\n**Step 4: Calculate the CSD Hamming weight $|m|_{CSD}$.**\nThe Hamming weight is the number of non-zero digits in the CSD representation.\nFor $m=151$, the CSD is $1010\\bar{1}00\\bar{1}$. The non-zero digits are $1, 1, \\bar{1}, \\bar{1}$.\nSo, $|m|_{CSD} = 4$.\n\n**Step 5: Calculate the final T-count.**\nUsing the given formula, $T_{count} = 2 \\cdot |m|_{CSD} - 2$.\n$$ T_{count} = 2 \\cdot 4 - 2 = 8 - 2 = 6 $$\nThe T-count for synthesizing the approximated rotation is 6.", "answer": "$$ \\boxed{6} $$", "id": "105345"}, {"introduction": "What makes non-Clifford gates so powerful? The answer lies in their ability to generate 'magic' states, which exhibit quantum contextuality—a feature that defies classical explanation. This 'magic' is the key resource enabling computational speedups. In this final exercise [@problem_id:105274], you will quantify the magic of a state generated by a T-gate by calculating the expectation value of a Peres-Mermin contextuality witness, providing a tangible link between a specific gate and this fundamental quantum property.", "problem": "In the theory of fault-tolerant quantum computation, non-Clifford gates are a crucial resource that elevates a quantum computer from simulating only a restricted class of \"classical-like\" computations (described by the Gottesman-Knill theorem) to full universality. The resourcefulness of non-Clifford gates is deeply connected to the quantum phenomenon of contextuality. One way to quantify this resource, often termed \"magic,\" is by evaluating the expectation value of a contextuality witness operator for a given quantum state.\n\nA canonical example demonstrating contextuality is the Peres-Mermin square, which uses a set of nine commuting two-qubit observables. Consider a subset of these observables, namely $O_x = \\sigma_x \\otimes \\sigma_x$, $O_y = \\sigma_y \\otimes \\sigma_y$, and $O_z = \\sigma_z \\otimes \\sigma_z$, where $\\sigma_i$ are the Pauli matrices. These three operators are mutually commuting, but their product is $O_x O_y O_z = -I \\otimes I$. This relationship imposes constraints on any non-contextual hidden variable theory.\n\nWe define a specific witness operator $\\mathcal{W}$ as a linear combination of these observables:\n$$\n\\mathcal{W} = (\\sigma_x \\otimes \\sigma_x) + (\\sigma_y \\otimes \\sigma_y) + \\sqrt{2}(\\sigma_z \\otimes \\sigma_z)\n$$\nThe state to be analyzed is a mixture of a \"magic state\" and a maximally mixed state, parametrized by a probability $p \\in [0, 1]$. The magic state $|T\\Phi^+\\rangle$ is created by applying a single-qubit T-gate to the first qubit of a Bell state $|\\Phi^+\\rangle$. The state of the system is given by the density matrix:\n$$\n\\rho(p) = p |T\\Phi^+\\rangle\\langle T\\Phi^+| + (1-p)\\frac{I}{4}\n$$\nwhere $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$, the T-gate is $T = \\begin{pmatrix} 1 & 0 \\\\ 0 & e^{i\\pi/4} \\end{pmatrix}$, the gate operation is $T \\otimes I$, and $I$ is the $4 \\times 4$ identity matrix.\n\nYour task is to derive the expectation value of the witness operator $\\mathcal{W}$ for the state $\\rho(p)$.", "solution": "The expectation value of the witness operator $\\mathcal{W}$ for the state $\\rho(p)$ is given by:\n\n$$\n\\langle \\mathcal{W} \\rangle = \\text{Tr}[\\mathcal{W} \\rho(p)]\n$$\n\nSubstituting $\\rho(p) = p |T\\Phi^+\\rangle\\langle T\\Phi^+| + (1-p)\\frac{I}{4}$ and using the linearity of the trace:\n\n$$\n\\langle \\mathcal{W} \\rangle = p \\cdot \\text{Tr}[\\mathcal{W} |T\\Phi^+\\rangle\\langle T\\Phi^+|] + (1-p) \\cdot \\text{Tr}\\left[\\mathcal{W} \\frac{I}{4}\\right]\n$$\n\nThe second term vanishes because $\\mathcal{W}$ is a linear combination of Pauli operators (which are traceless), and the trace of any traceless operator with the identity is zero:\n\n$$\n\\text{Tr}\\left[\\mathcal{W} \\frac{I}{4}\\right] = 0\n$$\n\nThus:\n\n$$\n\\langle \\mathcal{W} \\rangle = p \\cdot \\langle T\\Phi^+ | \\mathcal{W} | T\\Phi^+ \\rangle\n$$\n\nNow compute $\\langle T\\Phi^+ | \\mathcal{W} | T\\Phi^+ \\rangle$, where $\\mathcal{W} = \\sigma_x \\otimes \\sigma_x + \\sigma_y \\otimes \\sigma_y + \\sqrt{2} \\sigma_z \\otimes \\sigma_z$. The state is:\n\n$$\n|T\\Phi^+\\rangle = (T \\otimes I) |\\Phi^+\\rangle, \\quad |\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}} (|00\\rangle + |11\\rangle)\n$$\n\nApplying the T-gate to the first qubit:\n\n$$\nT|0\\rangle = |0\\rangle, \\quad T|1\\rangle = e^{i\\pi/4} |1\\rangle\n$$\n\nSo:\n\n$$\n|T\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}} (|00\\rangle + e^{i\\pi/4} |11\\rangle)\n$$\n\nThe expectation value decomposes as:\n\n$$\n\\langle T\\Phi^+ | \\mathcal{W} | T\\Phi^+ \\rangle = \\langle \\sigma_x \\otimes \\sigma_x \\rangle + \\langle \\sigma_y \\otimes \\sigma_y \\rangle + \\sqrt{2} \\langle \\sigma_z \\otimes \\sigma_z \\rangle\n$$\n\nEvaluate each term separately using the state vector in the basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$:\n\n$$\n|T\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ e^{i\\pi/4} \\end{pmatrix}, \\quad \\langle T\\Phi^+| = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 0 & 0 & e^{-i\\pi/4} \\end{pmatrix}\n$$\n\nFor $\\sigma_x \\otimes \\sigma_x$:\n\n$$\n\\sigma_x \\otimes \\sigma_x = \\begin{pmatrix}\n0 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0\n\\end{pmatrix}, \\quad (\\sigma_x \\otimes \\sigma_x) |T\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} e^{i\\pi/4} \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n\n\n$$\n\\langle T\\Phi^+ | \\sigma_x \\otimes \\sigma_x | T\\Phi^+ \\rangle = \\frac{1}{2} \\begin{pmatrix} 1 & 0 & 0 & e^{-i\\pi/4} \\end{pmatrix} \\begin{pmatrix} e^{i\\pi/4} \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{2} (e^{i\\pi/4} + e^{-i\\pi/4}) = \\frac{1}{2} \\cdot 2 \\cos(\\pi/4) = \\frac{\\sqrt{2}}{2}\n$$\n\nFor $\\sigma_y \\otimes \\sigma_y$:\n\n$$\n\\sigma_y \\otimes \\sigma_y = \\begin{pmatrix}\n0 & 0 & 0 & -1 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n-1 & 0 & 0 & 0\n\\end{pmatrix}, \\quad (\\sigma_y \\otimes \\sigma_y) |T\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -e^{i\\pi/4} \\\\ 0 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n\n\n$$\n\\langle T\\Phi^+ | \\sigma_y \\otimes \\sigma_y | T\\Phi^+ \\rangle = \\frac{1}{2} \\begin{pmatrix} 1 & 0 & 0 & e^{-i\\pi/4} \\end{pmatrix} \\begin{pmatrix} -e^{i\\pi/4} \\\\ 0 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\frac{1}{2} (-e^{i\\pi/4} - e^{-i\\pi/4}) = -\\frac{\\sqrt{2}}{2}\n$$\n\nFor $\\sigma_z \\otimes \\sigma_z$:\n\n$$\n\\sigma_z \\otimes \\sigma_z = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 0 \\\\\n0 & 0 & -1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}, \\quad (\\sigma_z \\otimes \\sigma_z) |T\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ e^{i\\pi/4} \\end{pmatrix}\n$$\n\n\n$$\n\\langle T\\Phi^+ | \\sigma_z \\otimes \\sigma_z | T\\Phi^+ \\rangle = \\frac{1}{2} \\begin{pmatrix} 1 & 0 & 0 & e^{-i\\pi/4} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ e^{i\\pi/4} \\end{pmatrix} = \\frac{1}{2} (1 + 1) = 1\n$$\n\nSumming the terms:\n\n$$\n\\langle T\\Phi^+ | \\mathcal{W} | T\\Phi^+ \\rangle = \\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} + \\sqrt{2} \\cdot 1 = \\sqrt{2}\n$$\n\nTherefore, the expectation value for $\\rho(p)$ is:\n\n$$\n\\langle \\mathcal{W} \\rangle = p \\cdot \\sqrt{2}\n$$", "answer": "$$\\boxed{\\sqrt{2}\\, p}$$", "id": "105274"}]}