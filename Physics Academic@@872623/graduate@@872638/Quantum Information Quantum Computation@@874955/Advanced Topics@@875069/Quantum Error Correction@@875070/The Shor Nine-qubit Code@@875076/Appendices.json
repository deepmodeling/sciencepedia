{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we first need to build an intuition for the structure of the Shor code's logical states. This exercise [@problem_id:172065] invites you to calculate the expectation value of a specific multi-qubit operator. The process will reveal a key symmetry of the block-level cat states, demonstrating how they function as eigenstates to certain operators, a property that is fundamental to the code's ability to detect and correct phase-flip errors.", "problem": "The Shor nine-qubit code is a quantum error-correcting code that encodes a single logical qubit into nine physical qubits. It is constructed as a concatenated code. The logical basis states, $|\\bar{0}\\rangle$ and $|\\bar{1}\\rangle$, are defined over a system of nine qubits, labeled 1 to 9.\n\nFirst, let's define two specific three-qubit states:\n$$ |C_0\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle) $$\n$$ |C_1\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle - |111\\rangle) $$\nThese are GHZ-type states for three qubits.\n\nThe logical basis states of the Shor code are constructed by taking tensor products of these states over three blocks of three qubits each. The first block consists of qubits {1, 2, 3}, the second block of qubits {4, 5, 6}, and the third block of qubits {7, 8, 9}. The definitions are:\n$$ |\\bar{0}\\rangle = |C_0\\rangle_{1,2,3} \\otimes |C_0\\rangle_{4,5,6} \\otimes |C_0\\rangle_{7,8,9} $$\n$$ |\\bar{1}\\rangle = |C_1\\rangle_{1,2,3} \\otimes |C_1\\rangle_{4,5,6} \\otimes |C_1\\rangle_{7,8,9} $$\nThe subscripts denote the physical qubits upon which the states are defined.\n\nA logical \"plus\" state, denoted $|\\bar{+}\\rangle$, is defined as the superposition:\n$$ |\\bar{+}\\rangle = \\frac{1}{\\sqrt{2}}(|\\bar{0}\\rangle + |\\bar{1}\\rangle) $$\n\nConsider the nine-qubit operator $K$ defined as the sum of three multi-qubit Pauli-X operators, each acting on one of the three-qubit blocks:\n$$ K = X_1X_2X_3 + X_4X_5X_6 + X_7X_8X_9 $$\nwhere $X_i$ is the Pauli-X operator acting on qubit $i$.\n\nCalculate the expectation value of the operator $K$ for a system in the logical plus state $|\\bar{+}\\rangle$. That is, compute $\\langle K \\rangle = \\langle \\bar{+} | K | \\bar{+} \\rangle$.", "solution": "We wish to compute  \n$$\\langle K\\rangle=\\langle\\bar+|\\,X_1X_2X_3+X_4X_5X_6+X_7X_8X_9\\,|\\bar+\\rangle,$$  \nwhere  \n$$|\\bar+\\rangle=\\frac1{\\sqrt2} \\bigl(|\\bar0\\rangle+|\\bar1\\rangle\\bigr),$$  \n$$|\\bar0\\rangle=|C_0\\rangle_{123}\\otimes|C_0\\rangle_{456}\\otimes|C_0\\rangle_{789},\\quad\n|\\bar1\\rangle=|C_1\\rangle_{123}\\otimes|C_1\\rangle_{456}\\otimes|C_1\\rangle_{789},$$  \nand  \n$$|C_0\\rangle=\\frac1{\\sqrt2}(|000\\rangle+|111\\rangle),\\quad\n|C_1\\rangle=\\frac1{\\sqrt2}(|000\\rangle-|111\\rangle).$$  \n\n1. Action of $X_1X_2X_3$ on the first block:  \n   $$X^{\\otimes3}|000\\rangle=|111\\rangle,\\quad X^{\\otimes3}|111\\rangle=|000\\rangle$$  \n   so  \n   $$X^{\\otimes3}|C_0\\rangle\n     =\\frac1{\\sqrt2}(|111\\rangle+|000\\rangle)=|C_0\\rangle,$$  \n   $$X^{\\otimes3}|C_1\\rangle\n     =\\frac1{\\sqrt2}(|111\\rangle-|000\\rangle)\n     =-\\frac1{\\sqrt2}(|000\\rangle-|111\\rangle)=-|C_1\\rangle.$$  \n   Thus $X_1X_2X_3$ has eigenvalue $+1$ on $|C_0\\rangle$ and $-1$ on $|C_1\\rangle$.  \n\n2. By identical reasoning each block operator $X_4X_5X_6$ and $X_7X_8X_9$ also has eigenvalue $+1$ on $|C_0\\rangle$ and $-1$ on $|C_1\\rangle$.  \n\n3. Hence  \n   $$K|\\bar0\\rangle=(+1+1+1)\\,|\\bar0\\rangle=3\\,|\\bar0\\rangle,$$  \n   $$K|\\bar1\\rangle=(-1-1-1)\\,|\\bar1\\rangle=-3\\,|\\bar1\\rangle.$$  \n\n4. Finally  \n   \n$$\n   \\langle K\\rangle\n   =\\langle\\bar+|K|\\bar+\\rangle\n   =\\frac1{2}\\bigl(\\langle\\bar0|+\\langle\\bar1|\\bigr)\\,(3|\\bar0\\rangle-3|\\bar1\\rangle)\n   =\\frac1{2}(3-3)=0.\n   $$", "answer": "$$\\boxed{0}$$", "id": "172065"}, {"introduction": "The essence of quantum error correction lies not just in the encoding, but in the full cycle of error detection and correction. This practice [@problem_id:172091] simulates a realistic scenario where this cycle is compromised by a fault in the measurement apparatus itself. By tracing the consequences of a bit-flip error followed by a faulty syndrome measurement, you will see firsthand how an incorrect diagnosis leads to a failed correction, providing a concrete understanding of the challenges in building a truly fault-tolerant system.", "problem": "The Shor nine-qubit code is a quantum error-correcting code designed to protect a single logical qubit from arbitrary single-qubit errors. The logical basis states $|\\bar{0}\\rangle$ and $|\\bar{1}\\rangle$ are encoded in a nine-qubit state space. The logical zero state is given by:\n$$\n|\\bar{0}\\rangle = \\frac{1}{2\\sqrt{2}} (|000\\rangle + |111\\rangle) \\otimes (|000\\rangle + |111\\rangle) \\otimes (|000\\rangle + |111\\rangle)\n$$\nThis structure is a concatenation of a three-qubit bit-flip code and a three-qubit phase-flip code. It can be viewed as three blocks of three qubits each. Errors are diagnosed by measuring a set of stabilizer operators.\n\nTo detect single-qubit bit-flip errors ($X$-errors) within the first block (qubits 1, 2, 3), one measures the eigenvalues of the stabilizer operators $S_A = Z_1Z_2$ and $S_B = Z_2Z_3$. The resulting pair of eigenvalues, or syndrome, identifies the corrupted qubit. The standard lookup table for correcting single-qubit $X$ errors in this block is:\n- Syndrome $(+1, +1)$: No error. Correction: $I$.\n- Syndrome $(-1, +1)$: $X_1$ error. Correction: $X_1$.\n- Syndrome $(-1, -1)$: $X_2$ error. Correction: $X_2$.\n- Syndrome $(+1, -1)$: $X_3$ error. Correction: $X_3$.\n\nConsider the following scenario involving a fault in the measurement process:\n1.  The system is prepared in the logical state $|\\psi_{init}\\rangle = |\\bar{0}\\rangle$.\n2.  A single-qubit bit-flip error $E = X_1$ occurs on the first qubit.\n3.  The error correction procedure is initiated. The stabilizer $S_A = Z_1Z_2$ is measured correctly.\n4.  However, due to a fault, instead of measuring $S_B = Z_2Z_3$, the operator $S'_B = Z_1Z_3$ is measured.\n5.  The control system is unaware of the fault. It takes the measurement outcomes from $(S_A, S'_B)$, assumes they correspond to the syndrome for $(S_A, S_B)$, and applies the correction operator prescribed by the standard lookup table shown above.\n\nCalculate the final fidelity $F = |\\langle \\psi_{ideal} | \\psi_{final} \\rangle|^2$, where $|\\psi_{final}\\rangle$ is the state of the nine-qubit system after the faulty correction is applied, and $|\\psi_{ideal}\\rangle = |\\bar{0}\\rangle$ is the desired, error-free state.", "solution": "The problem asks for the fidelity of the final state after a faulty error correction procedure. We will proceed in steps: identify the state after the error, determine the measured syndrome, find the applied correction based on this syndrome, calculate the final state, and finally compute the fidelity.\n\n**1. Initial State and State after Error**\n\nThe system starts in the logical zero state:\n$$\n|\\psi_{init}\\rangle = |\\bar{0}\\rangle = \\frac{1}{2\\sqrt{2}} \\bigotimes_{k=1}^{3} (|000\\rangle_k + |111\\rangle_k)\n$$\nwhere the subscript $k$ denotes the qubit block. Let's denote the state for a single block as $|S\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)$. So, $|\\bar{0}\\rangle = |S\\rangle_1 |S\\rangle_2 |S\\rangle_3$.\n\nA bit-flip error $E=X_1$ occurs on the first qubit. The state becomes:\n$$\n|\\psi_{err}\\rangle = X_1 |\\bar{0}\\rangle = (X_1 |S\\rangle_1) |S\\rangle_2 |S\\rangle_3\n$$\n\n**2. Syndrome Measurement**\n\nThe error correction procedure measures two operators.\n\nFirst, $S_A = Z_1Z_2$ is measured. To find the outcome, we check if $|\\psi_{err}\\rangle$ is an eigenstate of $S_A$.\n$S_A |\\psi_{err}\\rangle = Z_1Z_2 X_1 |\\bar{0}\\rangle$.\nThe operators $Z_1$ and $Z_2$ commute with all operators on blocks 2 and 3. On block 1, $Z_1Z_2$ anticommutes with $X_1$:\n$$\nZ_1Z_2 X_1 = Z_1 (Z_2 X_1) = Z_1 (X_1 Z_2) = (Z_1 X_1) Z_2 = (-X_1 Z_1) Z_2 = -X_1 Z_1 Z_2\n$$\nSince $|\\bar{0}\\rangle$ is a stabilizer state, it is an eigenstate of $S_A$ with eigenvalue $+1$, i.e., $S_A|\\bar{0}\\rangle = |\\bar{0}\\rangle$.\nSo, $S_A |\\psi_{err}\\rangle = -X_1 S_A |\\bar{0}\\rangle = -X_1 |\\bar{0}\\rangle = -|\\psi_{err}\\rangle$.\nThe measurement of $S_A$ yields the eigenvalue $s_A = -1$. Since $|\\psi_{err}\\rangle$ is an eigenstate of $S_A$, the measurement does not change the state.\n\nSecond, the faulty operator $S'_B = Z_1Z_3$ is measured. We check if $|\\psi_{err}\\rangle$ is an eigenstate of $S'_B$.\n$S'_B |\\psi_{err}\\rangle = Z_1Z_3 X_1 |\\bar{0}\\rangle$.\nThe operator $S'_B=Z_1Z_3$ is part of the stabilizer group since it is the product of two stabilizers of the Shor code for the first block: $(Z_1Z_2)(Z_2Z_3) = Z_1Z_3$. Therefore, $S'_B |\\bar{0}\\rangle = |\\bar{0}\\rangle$.\nWe check the commutation with the error $X_1$:\n$$\nZ_1Z_3 X_1 = Z_1(Z_3 X_1) = Z_1(X_1 Z_3) = (Z_1 X_1) Z_3 = (-X_1 Z_1) Z_3 = -X_1Z_1Z_3\n$$\nSo, $S'_B |\\psi_{err}\\rangle = -X_1 S'_B |\\bar{0}\\rangle = -X_1 |\\bar{0}\\rangle = -|\\psi_{err}\\rangle$.\nThe measurement of $S'_B$ yields the eigenvalue $s'_B = -1$. Again, the state is not altered.\n\nThe measured syndrome is $(s_A, s'_B) = (-1, -1)$.\n\n**3. Incorrect Correction**\n\nThe control system receives the syndrome $(-1, -1)$ but assumes it came from measuring $(S_A, S_B) = (Z_1Z_2, Z_2Z_3)$. It consults its lookup table:\n- $X_1$ error gives syndrome $(-1, +1)$ because $X_1$ anticommutes with $S_A$ but commutes with $S_B$.\n- $X_2$ error gives syndrome $(-1, -1)$ because $X_2$ anticommutes with both $S_A$ and $S_B$.\n- $X_3$ error gives syndrome $(+1, -1)$ because $X_3$ commutes with $S_A$ but anticommutes with $S_B$.\n\nBased on the measured syndrome $(-1, -1)$, the system incorrectly diagnoses an $X_2$ error and applies the corresponding correction operator, $C=X_2$.\n\n**4. Final State and Fidelity**\n\nThe correction $C=X_2$ is applied to the state after the error, $|\\psi_{err}\\rangle = X_1 |\\bar{0}\\rangle$.\n$$\n|\\psi_{final}\\rangle = C |\\psi_{err}\\rangle = X_2 (X_1 |\\bar{0}\\rangle) = X_2 X_1 |\\bar{0}\\rangle\n$$\nThe ideal state is $|\\psi_{ideal}\\rangle = |\\bar{0}\\rangle$. The fidelity is given by:\n$$\nF = |\\langle \\psi_{ideal} | \\psi_{final} \\rangle|^2 = |\\langle \\bar{0} | X_2 X_1 | \\bar{0} \\rangle|^2\n$$\nLet's compute the inner product. The operator $X_1X_2$ only acts on the first block of qubits.\n$$\n\\langle \\bar{0} | X_2 X_1 | \\bar{0} \\rangle = (\\langle S|_1 \\langle S|_2 \\langle S|_3) (X_2X_1 |S\\rangle_1 |S\\rangle_2 |S\\rangle_3)\n$$\n$$\n= (\\langle S|_1 X_2 X_1 |S\\rangle_1) (\\langle S|_2 |S\\rangle_2) (\\langle S|_3 |S\\rangle_3) = \\langle S|_1 X_2 X_1 |S\\rangle_1\n$$\nsince $\\langle S|_k | S\\rangle_k = 1$. Now we evaluate the matrix element for the first block:\n$$\n|S\\rangle_1 = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)\n$$\nThe operator $X_1X_2$ acts on this state:\n$$\nX_2 X_1 |S\\rangle_1 = \\frac{1}{\\sqrt{2}} (X_2X_1|000\\rangle + X_2X_1|111\\rangle) = \\frac{1}{\\sqrt{2}} (|110\\rangle + |001\\rangle)\n$$\nNow we take the inner product with $\\langle S|_1$:\n$$\n\\langle S|_1 X_2 X_1 |S\\rangle_1 = \\frac{1}{\\sqrt{2}}(\\langle000| + \\langle111|) \\left( \\frac{1}{\\sqrt{2}} (|110\\rangle + |001\\rangle) \\right)\n$$\n$$\n= \\frac{1}{2} (\\langle000|110\\rangle + \\langle000|001\\rangle + \\langle111|110\\rangle + \\langle111|001\\rangle)\n$$\nAll the inner products of these computational basis states are zero because the bit strings are different.\n$$\n\\langle000|110\\rangle = 0, \\quad \\langle000|001\\rangle = 0, \\quad \\langle111|110\\rangle = 0, \\quad \\langle111|001\\rangle = 0\n$$\nThus, the inner product is:\n$$\n\\langle \\bar{0} | X_2 X_1 | \\bar{0} \\rangle = 0\n$$\nThe final fidelity is:\n$$\nF = |0|^2 = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "172091"}, {"introduction": "Quantum error-correcting codes are designed with specific error models in mind; the Shor code, for instance, is designed to correct arbitrary single-qubit errors. This advanced exercise [@problem_id:172113] \"stress-tests\" the code by subjecting it to a correlated two-qubit error that falls outside its design specifications. You will discover the critical concept of how an uncorrectable physical error can be misidentified by the decoding procedure, ultimately manifesting as a destructive logical operator that corrupts the encoded information.", "problem": "The Shor nine-qubit code is a quantum error-correcting code that can protect a single logical qubit from an arbitrary single-qubit error on any of its nine physical qubits. The code is a concatenated code, and one standard construction leads to the logical basis states $|\\bar{0}_L\\rangle$ and $|\\bar{1}_L\\rangle$ defined as follows.\n\nFirst, define the three-qubit states:\n$$|C_0\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)$$\n$$|C_1\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle - |111\\rangle)$$\n\nThe nine qubits are partitioned into three blocks: block A (qubits 1, 2, 3), block B (qubits 4, 5, 6), and block C (qubits 7, 8, 9). The logical basis states are then given by:\n$$|\\bar{0}_L\\rangle = |C_0\\rangle_A \\otimes |C_0\\rangle_B \\otimes |C_0\\rangle_C$$\n$$|\\bar{1}_L\\rangle = |C_1\\rangle_A \\otimes |C_1\\rangle_B \\otimes |C_1\\rangle_C$$\n\nError correction is performed by measuring a set of stabilizer generators. There are two types of generators for this code:\n1.  Six generators to detect bit-flip type errors within each block:\n    $S_Z = \\{Z_1Z_2, Z_2Z_3, Z_4Z_5, Z_5Z_6, Z_7Z_8, Z_8Z_9\\}$\n2.  Two generators to detect phase-flip type errors across the blocks:\n    $S_X = \\{ (X_1X_2X_3)(X_4X_5X_6), (X_4X_5X_6)(X_7X_8X_9) \\}$\n\nThe standard decoding procedure for single-qubit errors involves measuring the eigenvalues of all eight stabilizer generators. A non-trivial syndrome (any eigenvalue being -1) indicates an error. The procedure assumes at most a single-qubit error has occurred. If a syndrome indicates an error localized to a specific block (e.g., a phase error on block C), the correction operation is, by convention, applied to the first qubit of that block (e.g., $Z_7$ for a phase error on block C).\n\nSuppose the system is initialized in the state:\n$$|\\psi_{in}\\rangle = \\frac{1}{\\sqrt{3}}|\\bar{0}_L\\rangle + \\sqrt{\\frac{2}{3}}|\\bar{1}_L\\rangle$$\nA correlated two-qubit error $E = Z_1Z_4$ occurs, where $Z_k$ is the Pauli-Z operator on qubit $k$. Following this error, the standard single-qubit error correction procedure described above is performed.\n\nCalculate the final fidelity $F = |\\langle \\psi_{in} | \\psi_{final} \\rangle|^2$, where $|\\psi_{final}\\rangle$ is the state of the system after the error and the subsequent correction attempt.", "solution": "The problem asks for the fidelity between an initial state $|\\psi_{in}\\rangle$ and the final state $|\\psi_{final}\\rangle$ after a correlated error $E=Z_1Z_4$ and a subsequent standard single-qubit error correction procedure.\n\n**Step 1: Analyze the error and the resulting syndrome**\n\nThe state after the error is $|\\psi_{err}\\rangle = E |\\psi_{in}\\rangle = Z_1Z_4 |\\psi_{in}\\rangle$. The error correction procedure measures the eigenvalues of the stabilizer generators. An operator $O$ gives eigenvalue $+1$ if it commutes with the error ($[E,O]=0$) and $-1$ if it anti-commutes ($\\{E,O\\}=0$), assuming the initial state is a stabilized state.\n\nFirst, we check the bit-flip syndromes by measuring the stabilizers in $S_Z$:\nFor any generator $Z_iZ_j \\in S_Z$, the Pauli-Z operators commute with each other. Thus, $[Z_1Z_4, Z_iZ_j] = 0$ for all generators in $S_Z$. The measurement of all six $S_Z$ generators will yield $+1$. The decoder concludes that no $X$ or $Y$ error has occurred.\n\nNext, we check the phase-flip syndromes by measuring the stabilizers in $S_X$:\nLet $S_{X,1} = (X_1X_2X_3)(X_4X_5X_6)$ and $S_{X,2} = (X_4X_5X_6)(X_7X_8X_9)$. We check their commutation with the error $E=Z_1Z_4$.\nFor $S_{X,1}$:\n$S_{X,1} E = (X_1X_2X_3 X_4X_5X_6) (Z_1Z_4)$.\nSince $X_i$ and $Z_j$ anti-commute if $i=j$ and commute otherwise, $X_1$ anti-commutes with $Z_1$, and $X_4$ anti-commutes with $Z_4$. All other Pauli operators in $S_{X,1}$ commute with $E$.\n$S_{X,1} (Z_1Z_4) = (-1) Z_1 S_{X,1} (-1) Z_4 = Z_1 Z_4 S_{X,1} = E S_{X,1}$.\nSo, $[S_{X,1}, E] = 0$. The measurement of $S_{X,1}$ yields $+1$.\n\nFor $S_{X,2}$:\n$S_{X,2} E = (X_4X_5X_6 X_7X_8X_9) (Z_1Z_4)$.\nHere, only $X_4$ anti-commutes with a term in $E$ (namely $Z_4$). $Z_1$ commutes with all operators in $S_{X,2}$.\n$S_{X,2} (Z_1Z_4) = S_{X,2} Z_1 Z_4 = Z_1 S_{X,2} Z_4 = Z_1 (-1) Z_4 S_{X,2} = -E S_{X,2}$.\nSo, $\\{S_{X,2}, E\\} = 0$. The measurement of $S_{X,2}$ yields $-1$.\n\nThe full syndrome for phase errors is $(+1, -1)$.\n\n**Step 2: Determine the correction operator**\n\nThe decoder is designed to correct single-qubit errors. It interprets the syndrome $(+1, -1)$ as arising from a single Pauli-Z error.\n- A single $Z$ error on block A (qubits 1,2,3) would anti-commute with $S_{X,1}$ and commute with $S_{X,2}$, giving syndrome $(-1, +1)$.\n- A single $Z$ error on block B (qubits 4,5,6) would anti-commute with both $S_{X,1}$ and $S_{X,2}$, giving syndrome $(-1, -1)$.\n- A single $Z$ error on block C (qubits 7,8,9) would commute with $S_{X,1}$ and anti-commute with $S_{X,2}$, giving syndrome $(+1, -1)$.\n\nThe measured syndrome $(+1, -1)$ matches a single $Z$ error on block C. By the stated convention, a correction is applied to the first qubit of that block. So, the correction operator is $C = Z_7$.\n\n**Step 3: Determine the residual logical operator**\n\nThe final state after the correction attempt is:\n$|\\psi_{final}\\rangle = C |\\psi_{err}\\rangle = C E |\\psi_{in}\\rangle = Z_7 (Z_1Z_4) |\\psi_{in}\\rangle$.\nThe state is transformed by the residual operator $O_{res} = Z_1Z_4Z_7$.\n\nWe need to determine how this operator acts on the logical subspace. We examine its action on the logical basis states $|\\bar{0}_L\\rangle$ and $|\\bar{1}_L\\rangle$. Note that $O_{res}$ acts as $Z_1$ on block A, $Z_4$ on block B, and $Z_7$ on block C. A single Pauli-Z on any qubit in a block will flip the sign of the $|111\\rangle$ component, thus swapping $|C_0\\rangle \\leftrightarrow |C_1\\rangle$.\n$Z_i |C_0\\rangle \\leftrightarrow |C_1\\rangle$ for $i$ in the respective block.\n\nNow, we apply $O_{res} = Z_1Z_4Z_7$ to the logical basis states:\n$O_{res} |\\bar{0}_L\\rangle = (Z_1Z_4Z_7) (|C_0\\rangle_A |C_0\\rangle_B |C_0\\rangle_C) = (Z_1|C_0\\rangle_A)(Z_4|C_0\\rangle_B)(Z_7|C_0\\rangle_C) = |C_1\\rangle_A|C_1\\rangle_B|C_1\\rangle_C = |\\bar{1}_L\\rangle$.\n$O_{res} |\\bar{1}_L\\rangle = (Z_1Z_4Z_7) (|C_1\\rangle_A |C_1\\rangle_B |C_1\\rangle_C) = (Z_1|C_1\\rangle_A)(Z_4|C_1\\rangle_B)(Z_7|C_1\\rangle_C) = |C_0\\rangle_A|C_0\\rangle_B|C_0\\rangle_C = |\\bar{0}_L\\rangle$.\n\nThe operator $O_{res}$ swaps the logical basis states. This is the definition of the logical Pauli-X operator, $\\bar{X}_L$. So, $O_{res} = \\bar{X}_L$.\n\n**Step 4: Calculate the fidelity**\n\nThe initial state is $|\\psi_{in}\\rangle = \\frac{1}{\\sqrt{3}}|\\bar{0}_L\\rangle + \\sqrt{\\frac{2}{3}}|\\bar{1}_L\\rangle$.\nThe final state is $|\\psi_{final}\\rangle = O_{res} |\\psi_{in}\\rangle = \\bar{X}_L |\\psi_{in}\\rangle$.\nApplying $\\bar{X}_L$ to $|\\psi_{in}\\rangle$:\n$$|\\psi_{final}\\rangle = \\bar{X}_L \\left( \\frac{1}{\\sqrt{3}}|\\bar{0}_L\\rangle + \\sqrt{\\frac{2}{3}}|\\bar{1}_L\\rangle \\right) = \\frac{1}{\\sqrt{3}}\\bar{X}_L|\\bar{0}_L\\rangle + \\sqrt{\\frac{2}{3}}\\bar{X}_L|\\bar{1}_L\\rangle = \\frac{1}{\\sqrt{3}}|\\bar{1}_L\\rangle + \\sqrt{\\frac{2}{3}}|\\bar{0}_L\\rangle$$\n\nNow we calculate the fidelity $F = |\\langle \\psi_{in} | \\psi_{final} \\rangle|^2$:\n$$\\langle \\psi_{in} | \\psi_{final} \\rangle = \\left( \\frac{1}{\\sqrt{3}}\\langle\\bar{0}_L| + \\sqrt{\\frac{2}{3}}\\langle\\bar{1}_L| \\right) \\left( \\sqrt{\\frac{2}{3}}|\\bar{0}_L\\rangle + \\frac{1}{\\sqrt{3}}|\\bar{1}_L\\rangle \\right)$$\nUsing the orthogonality of the logical basis states, $\\langle\\bar{0}_L|\\bar{0}_L\\rangle = \\langle\\bar{1}_L|\\bar{1}_L\\rangle = 1$ and $\\langle\\bar{0}_L|\\bar{1}_L\\rangle = \\langle\\bar{1}_L|\\bar{0}_L\\rangle = 0$.\n$$\\langle \\psi_{in} | \\psi_{final} \\rangle = \\frac{1}{\\sqrt{3}}\\sqrt{\\frac{2}{3}}\\langle\\bar{0}_L|\\bar{0}_L\\rangle + \\frac{1}{\\sqrt{3}}\\frac{1}{\\sqrt{3}}\\langle\\bar{0}_L|\\bar{1}_L\\rangle + \\sqrt{\\frac{2}{3}}\\sqrt{\\frac{2}{3}}\\langle\\bar{1}_L|\\bar{0}_L\\rangle + \\sqrt{\\frac{2}{3}}\\frac{1}{\\sqrt{3}}\\langle\\bar{1}_L|\\bar{1}_L\\rangle$$\n$$\\langle \\psi_{in} | \\psi_{final} \\rangle = \\frac{\\sqrt{2}}{3} \\cdot 1 + \\frac{1}{3} \\cdot 0 + \\frac{2}{3} \\cdot 0 + \\frac{\\sqrt{2}}{3} \\cdot 1 = \\frac{\\sqrt{2}}{3} + \\frac{\\sqrt{2}}{3} = \\frac{2\\sqrt{2}}{3}$$\nThe fidelity is the squared modulus of this value:\n$$F = \\left|\\frac{2\\sqrt{2}}{3}\\right|^2 = \\frac{4 \\cdot 2}{9} = \\frac{8}{9}$$", "answer": "$$ \\boxed{\\frac{8}{9}} $$", "id": "172113"}]}