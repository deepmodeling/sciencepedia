{"hands_on_practices": [{"introduction": "Two-qubit gates form the backbone of quantum algorithms, and in Nuclear Magnetic Resonance (NMR), they are synthesized using a combination of targeted radio-frequency pulses and periods of natural interaction. To achieve the high fidelity required for computation, control parameters such as the duration of this free evolution must be precisely calibrated. This exercise provides practice in the quantitative analysis of gate performance by calculating the analytic gradient of the CNOT gate fidelity with respect to the inter-pulse delay, a foundational step in optimizing gate synthesis through gradient-based methods [@problem_id:106536].", "problem": "In Nuclear Magnetic Resonance (NMR) based quantum computing, two-qubit gates are often implemented by a sequence of radio-frequency (RF) pulses and periods of free evolution. Consider a two-qubit system consisting of two spin-1/2 nuclei, labeled 1 and 2. In a suitable rotating frame and assuming resonance conditions (i.e., chemical shifts are zero or have been refocused), the dominant interaction is the scalar coupling, or J-coupling. The Hamiltonian for this interaction is given by:\n$$\nH_J = \\frac{\\hbar J}{2} \\sigma_{1z} \\otimes \\sigma_{2z}\n$$\nwhere $J$ is the J-coupling constant (in units of rad/s), $\\hbar$ is the reduced Planck constant, and $\\sigma_{1z}, \\sigma_{2z}$ are the Pauli-Z operators for qubit 1 and qubit 2, respectively. The evolution operator for a period of time $\\tau$ under this Hamiltonian is $U_J(\\tau) = \\exp(-i H_J \\tau / \\hbar)$.\n\nA specific sequence is proposed to implement a quantum gate. The sequence consists of an initial pulse $P_2$ on qubit 1, a free evolution for a time $\\tau$ under $H_J$, and a final pulse $P_1$ on qubit 1. The pulses are considered ideal and instantaneous (hard pulses). The total implemented unitary operation is thus $U_{real}(\\tau) = P_1 U_J(\\tau) P_2$. Let the pulses be defined as:\n$$\nP_1 = R_1^x(\\pi/2) = \\exp(-i\\frac{\\pi}{4}\\sigma_{1x})\n$$\n$$\nP_2 = R_1^x(-\\pi/2) = \\exp(i\\frac{\\pi}{4}\\sigma_{1x})\n$$\nThe target gate is the standard CNOT gate, where qubit 1 is the control and qubit 2 is the target. Its unitary is given by:\n$$\nU_{CNOT} = |0\\rangle\\langle0| \\otimes I + |1\\rangle\\langle1| \\otimes \\sigma_{2x}\n$$\nThe quality of the implementation is measured by the gate fidelity, $F_g$, defined as:\n$$\nF_g(U_{real}, U_{ideal}) = \\frac{1}{d^2} \\left| \\text{Tr}(U_{ideal}^\\dagger U_{real}) \\right|^2\n$$\nwhere $d$ is the dimension of the Hilbert space (for two qubits, $d=4$).\n\nYour task is to find the analytic gradient of the gate fidelity $F_g$ with respect to the inter-pulse delay time $\\tau$. That is, compute $\\frac{\\partial F_g}{\\partial \\tau}$ as a function of $J$ and $\\tau$.", "solution": "The problem asks for the gradient of the CNOT gate fidelity with respect to the delay time $\\tau$. The implemented unitary is $U_{real}(\\tau) = P_1 U_J(\\tau) P_2$.\n\n**Step 1: Simplify the implemented unitary operator $U_{real}(\\tau)$**\n\nThe pulses are $P_1 = R_1^x(\\pi/2)$ and $P_2 = R_1^x(-\\pi/2)$. Notice that $P_2 = P_1^\\dagger$.\nThe evolution operator is $U_J(\\tau) = \\exp\\left(-i \\frac{\\hbar J}{2} \\sigma_{1z} \\otimes \\sigma_{2z} \\frac{\\tau}{\\hbar}\\right) = \\exp\\left(-i \\frac{J\\tau}{2} \\sigma_{1z} \\otimes \\sigma_{2z}\\right)$.\nSo, the implemented unitary is:\n$$\nU_{real}(\\tau) = R_1^x(\\pi/2) \\exp\\left(-i \\frac{J\\tau}{2} \\sigma_{1z} \\otimes \\sigma_{2z}\\right) R_1^x(-\\pi/2)\n$$\nThis is a conjugation of the evolution operator by $P_1$. We can write it as:\n$$\nU_{real}(\\tau) = \\exp\\left(-i \\frac{J\\tau}{2} \\left( R_1^x(\\pi/2) (\\sigma_{1z} \\otimes \\sigma_{2z}) R_1^x(-\\pi/2) \\right) \\right)\n$$\nThe rotation $R_1^x(\\pi/2)$ only affects operators on qubit 1. So, we have:\n$$\nR_1^x(\\pi/2) (\\sigma_{1z} \\otimes \\sigma_{2z}) R_1^x(-\\pi/2) = (R_1^x(\\pi/2) \\sigma_{1z} R_1^x(-\\pi/2)) \\otimes \\sigma_{2z}\n$$\nWe use the general formula for the rotation of a Pauli operator: $e^{-i\\theta\\sigma_n/2} \\sigma_k e^{i\\theta\\sigma_n/2} = \\sigma_k \\cos\\theta + (\\vec{n}\\times\\vec{k})\\cdot\\vec{\\sigma} \\sin\\theta$.\nFor a rotation about the x-axis by $\\theta=\\pi/2$, we have:\n$R_1^x(\\pi/2) \\sigma_{1z} R_1^x(-\\pi/2) = \\sigma_{1z}\\cos(\\pi/2) - \\sigma_{1y}\\sin(\\pi/2) = -\\sigma_{1y}$.\nSubstituting this back, the transformed Hamiltonian argument is $-\\sigma_{1y} \\otimes \\sigma_{2z}$.\nTherefore, $U_{real}(\\tau)$ simplifies to:\n$$\nU_{real}(\\tau) = \\exp\\left(-i \\frac{J\\tau}{2} (-\\sigma_{1y} \\otimes \\sigma_{2z})\\right) = \\exp\\left(i \\frac{J\\tau}{2} \\sigma_{1y} \\otimes \\sigma_{2z}\\right)\n$$\nUsing Euler's formula for matrix exponentials, since $(\\sigma_{1y}\\sigma_{2z})^2 = I$:\n$$\nU_{real}(\\tau) = \\cos\\left(\\frac{J\\tau}{2}\\right)I + i\\sin\\left(\\frac{J\\tau}{2}\\right)(\\sigma_{1y} \\otimes \\sigma_{2z})\n$$\n\n**Step 2: Calculate the trace $\\text{Tr}(U_{CNOT}^\\dagger U_{real})$**\n\nFirst, we express $U_{CNOT}$ in the Pauli basis.\n$U_{CNOT} = |0\\rangle\\langle0| \\otimes I + |1\\rangle\\langle1| \\otimes \\sigma_{2x}$. Using projectors $P_0 = |0\\rangle\\langle0| = \\frac{I_1+\\sigma_{1z}}{2}$ and $P_1 = |1\\rangle\\langle1| = \\frac{I_1-\\sigma_{1z}}{2}$:\n$$\nU_{CNOT} = \\frac{I_1+\\sigma_{1z}}{2} \\otimes I_2 + \\frac{I_1-\\sigma_{1z}}{2} \\otimes \\sigma_{2x} = \\frac{1}{2}(I \\otimes I + \\sigma_{1z} \\otimes I + I \\otimes \\sigma_{2x} - \\sigma_{1z} \\otimes \\sigma_{2x})\n$$\nThe CNOT gate is Hermitian, so $U_{CNOT}^\\dagger = U_{CNOT}$. We need to compute $Z = \\text{Tr}(U_{CNOT} U_{real})$.\nThe trace of a product of two operators expanded in the Pauli basis, $A = \\sum_k a_k P_k$ and $B = \\sum_k b_k P_k$, is $\\text{Tr}(AB) = d \\sum_k a_k b_k$, where $P_k$ are the Pauli basis matrices and $d=4$.\nThe expansion for $U_{real}(\\tau)$ only has two non-zero coefficients:\n$c_I = \\cos(J\\tau/2)$ for the identity matrix $I$.\n$c_{1y,2z} = i\\sin(J\\tau/2)$ for the operator $\\sigma_{1y} \\otimes \\sigma_{2z}$.\nThe expansion for $U_{CNOT}$ has four non-zero coefficients:\n$c'_I = 1/2$ for $I$.\n$c'_{1z} = 1/2$ for $\\sigma_{1z} \\otimes I$.\n$c'_{2x} = 1/2$ for $I \\otimes \\sigma_{2x}$.\n$c'_{1z,2x} = -1/2$ for $\\sigma_{1z} \\otimes \\sigma_{2x}$.\nThe only common operator in both expansions is the identity operator $I$. Therefore, only this term contributes to the trace.\n$$\nZ = \\text{Tr}(U_{CNOT}^\\dagger U_{real}) = d \\cdot c'_I \\cdot c_I = 4 \\cdot \\frac{1}{2} \\cdot \\cos\\left(\\frac{J\\tau}{2}\\right) = 2\\cos\\left(\\frac{J\\tau}{2}\\right)\n$$\n\n**Step 3: Calculate the gate fidelity $F_g(\\tau)$**\n\nThe gate fidelity is given by $F_g = \\frac{1}{d^2} |Z|^2$.\n$$\nF_g(\\tau) = \\frac{1}{4^2} \\left| 2\\cos\\left(\\frac{J\\tau}{2}\\right) \\right|^2 = \\frac{4}{16} \\cos^2\\left(\\frac{J\\tau}{2}\\right) = \\frac{1}{4} \\cos^2\\left(\\frac{J\\tau}{2}\\right)\n$$\n\n**Step 4: Compute the gradient of the fidelity with respect to $\\tau$**\n\nWe now differentiate $F_g(\\tau)$ with respect to $\\tau$ using the chain rule.\n$$\n\\frac{\\partial F_g}{\\partial \\tau} = \\frac{\\partial}{\\partial \\tau} \\left[ \\frac{1}{4} \\cos^2\\left(\\frac{J\\tau}{2}\\right) \\right]\n$$\n$$\n\\frac{\\partial F_g}{\\partial \\tau} = \\frac{1}{4} \\cdot 2\\cos\\left(\\frac{J\\tau}{2}\\right) \\cdot \\left(-\\sin\\left(\\frac{J\\tau}{2}\\right)\\right) \\cdot \\frac{d}{d\\tau}\\left(\\frac{J\\tau}{2}\\right)\n$$\n$$\n\\frac{\\partial F_g}{\\partial \\tau} = \\frac{1}{2} \\cos\\left(\\frac{J\\tau}{2}\\right) \\left(-\\sin\\left(\\frac{J\\tau}{2}\\right)\\right) \\cdot \\frac{J}{2}\n$$\n$$\n\\frac{\\partial F_g}{\\partial \\tau} = -\\frac{J}{4} \\sin\\left(\\frac{J\\tau}{2}\\right) \\cos\\left(\\frac{J\\tau}{2}\\right)\n$$\nUsing the double-angle identity $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$, we have $\\sin(J\\tau) = 2\\sin(J\\tau/2)\\cos(J\\tau/2)$.\n$$\n\\frac{\\partial F_g}{\\partial \\tau} = -\\frac{J}{8} \\left(2 \\sin\\left(\\frac{J\\tau}{2}\\right) \\cos\\left(\\frac{J\\tau}{2}\\right)\\right) = -\\frac{J}{8} \\sin(J\\tau)\n$$", "answer": "$$\n\\boxed{-\\frac{J}{8} \\sin(J\\tau)}\n$$", "id": "106536"}, {"introduction": "In the real world, no quantum gate is perfect; systematic errors arising from miscalibrated control fields are a dominant source of computational infidelity. Quantum Process Tomography (QPT) provides a complete experimental framework for diagnosing these imperfections by mapping the actual operation performed by a gate. This practice simulates a key element of QPT, where you will calculate a specific observable expectation value that is sensitive to a common flawâ€”an incorrect flip angle in the conditional rotation of a CNOT gate [@problem_id:106532].", "problem": "In the context of liquid-state Nuclear Magnetic Resonance (NMR) quantum computing, a two-qubit Controlled-NOT (CNOT) gate is often implemented through a sequence of radio-frequency pulses and periods of free evolution under the spin-spin coupling Hamiltonian. An essential part of characterizing the performance of such a gate is quantum process tomography.\n\nConsider a two-qubit system, with qubit 1 as the control and qubit 2 as the target. A common systematic error in pulse implementation is an amplitude error, which results in a rotation angle deviating from the intended value. Let's model an imperfect CNOT gate, where the conditional rotation on the target qubit has such an error. The ideal CNOT gate is given by $U_{CNOT} = |0\\rangle\\langle 0|^{(1)} \\otimes I^{(2)} + |1\\rangle\\langle 1|^{(1)} \\otimes \\sigma_x^{(2)}$, which corresponds to an identity operation on the target qubit if the control is in state $|0\\rangle$, and a Pauli-X gate ($\\pi$-rotation about the x-axis) if the control is in state $|1\\rangle$.\n\nThe imperfect gate, denoted $U_{err}$, performs a conditional rotation on the target qubit by an angle of $\\pi(1+\\epsilon)$ instead of $\\pi$, where $\\epsilon$ is a dimensionless, real-valued error parameter. The operator for this imperfect gate is:\n$$\nU_{err} = |0\\rangle\\langle 0|^{(1)} \\otimes I^{(2)} + |1\\rangle\\langle 1|^{(1)} \\otimes R_x^{(2)}(\\pi(1+\\epsilon))\n$$\nwhere $R_x(\\theta) = \\exp(-i\\theta\\sigma_x/2)$ is the rotation operator around the x-axis.\n\nThe system is prepared in the initial state $|\\psi_{in}\\rangle = |+\\rangle^{(1)} \\otimes |0\\rangle^{(2)}$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$. The imperfect CNOT gate $U_{err}$ is then applied to the system.\n\nAs part of a process tomography experiment, you are tasked to compute the expectation value of the Pauli-Z operator for the target qubit, $\\langle \\sigma_z^{(2)} \\rangle$, in the final state. Express your answer as a function of the error parameter $\\epsilon$.", "solution": "We start with the initial state\n$$\n|\\psi_{\\rm in}\\rangle\n=|+\\rangle^{(1)}\\otimes|0\\rangle^{(2)}\n=\\frac{1}{\\sqrt2}\\bigl(|0,0\\rangle+|1,0\\rangle\\bigr).\n$$\nThe imperfect CNOT acts as\n$$\nU_{\\rm err}|0,0\\rangle=|0\\rangle\\otimes I|0\\rangle=|0,0\\rangle,\n\\qquad\nU_{\\rm err}|1,0\\rangle\n=|1\\rangle\\otimes R_x(\\pi(1+\\epsilon))|0\\rangle,\n$$\nwith\n$$\nR_x(\\theta)|0\\rangle\n=\\cos\\frac{\\theta}{2}\\,|0\\rangle\n-i\\sin\\frac{\\theta}{2}\\,|1\\rangle.\n$$\nSet $\\phi=\\frac{\\pi(1+\\epsilon)}2$.  Then\n$$\n|\\psi_{\\rm out}\\rangle\n=U_{\\rm err}|\\psi_{\\rm in}\\rangle\n=\\frac{1}{\\sqrt2}\\Bigl(|0,0\\rangle\n+\\cos\\phi\\,|1,0\\rangle\n-i\\sin\\phi\\,|1,1\\rangle\\Bigr).\n$$\nThe expectation of $\\sigma_z^{(2)}$ is\n$$\n\\langle\\sigma_z^{(2)}\\rangle\n=\\langle\\psi_{\\rm out}|\\,I\\otimes\\sigma_z\\,|\\psi_{\\rm out}\\rangle\n=P_{\\rm target=0}-P_{\\rm target=1},\n$$\nwhere\n$$\nP_{\\rm target=0}\n=\\frac{|1|^2+|\\cos\\phi|^2}{2}\n=\\frac{1+\\cos^2\\phi}{2},\\quad\nP_{\\rm target=1}\n=\\frac{|\\sin\\phi|^2}{2}\n=\\frac{\\sin^2\\phi}{2}.\n$$\nHence\n$$\n\\langle\\sigma_z^{(2)}\\rangle\n=\\frac{1+\\cos^2\\phi-\\sin^2\\phi}{2}\n=\\frac{1+\\cos2\\phi}{2}.\n$$\nSince $2\\phi=\\pi(1+\\epsilon)$, we have\n$$\n\\cos2\\phi=\\cos\\bigl(\\pi(1+\\epsilon)\\bigr)\n=-\\cos(\\pi\\epsilon),\n$$\nso\n$$\n\\langle\\sigma_z^{(2)}\\rangle\n=\\frac{1-\\cos(\\pi\\epsilon)}{2}.\n$$", "answer": "$$\\boxed{\\frac{1-\\cos(\\pi\\epsilon)}{2}}$$", "id": "106532"}, {"introduction": "Quantum Error Correction (QEC) offers a path to fault-tolerant computation by actively detecting and reversing errors. A full QEC cycle, however, relies on applying corrective pulses that are themselves subject to implementation errors. This final practice delves into this recursive challenge by analyzing the bit-flip code, where the corrective pulse meant to fix a qubit has a systematic flip-angle error. By calculating the final state fidelity, you will quantify the effectiveness of a QEC protocol when the very tools used for correction are imperfect, providing insight into the practical resilience of error-correcting codes [@problem_id:106658].", "problem": "In Nuclear Magnetic Resonance (NMR) based quantum computation, logical operations are implemented by applying carefully tailored radio-frequency pulses. A significant challenge in this paradigm is the precision of these pulses. Systematic errors can lead to small deviations from the intended unitary operations, which can accumulate and degrade the fidelity of a quantum computation.\n\nConsider the three-qubit bit-flip code, a simple quantum error correction code. The logical basis states are defined as:\n$$\n|0_L\\rangle = |000\\rangle\n$$\n$$\n|1_L\\rangle = |111\\rangle\n$$\nA general encoded state is a superposition $|\\psi_L\\rangle = \\alpha|0_L\\rangle + \\beta|1_L\\rangle$, where $\\alpha, \\beta$ are complex coefficients satisfying $|\\alpha|^2 + |\\beta|^2 = 1$.\n\nSuppose such an encoded state $|\\psi_L\\rangle$ is subjected to a single bit-flip error on the first qubit. This error is described by the operator $X_1 = \\sigma_x \\otimes I \\otimes I$. A subsequent syndrome measurement correctly identifies that this specific error has occurred.\n\nTo correct the error, a recovery operation is applied. Ideally, this would be a perfect $X$ gate on the first qubit. However, due to a systematic error in the pulse generation, the applied operation is not a perfect $X$ gate, but rather a rotation about the x-axis by an angle slightly different from $\\pi$. The applied faulty corrective operator on the first qubit is given by $U_{corr, 1} = R_x(\\pi + \\epsilon) = \\exp[-i(\\pi+\\epsilon)X_1/2]$, where $\\epsilon$ is a small, constant angle deviation. The total recovery operator is $U_{corr} = U_{corr, 1} \\otimes I \\otimes I$.\n\nCalculate the fidelity $F = |\\langle \\psi_L | \\psi_{corr} \\rangle|^2$ of the state after correction, $|\\psi_{corr}\\rangle$, with respect to the original ideal state $|\\psi_L\\rangle$. Your final answer should be expressed as a function of the error angle $\\epsilon$.", "solution": "We have the encoded state \n$$|\\psi_L\\rangle=\\alpha|000\\rangle+\\beta|111\\rangle,$$\nan error $X_1=\\sigma_x\\otimes I\\otimes I$ and the faulty recovery \n$$U_{corr}=R_x(\\pi+\\epsilon)\\otimes I\\otimes I,\\quad \nR_x(\\pi+\\epsilon)=\\exp\\bigl[-i(\\pi+\\epsilon)\\sigma_x/2\\bigr].$$\n1.  Expand the rotation:  \n$$R_x(\\pi+\\epsilon)=\\cos\\!\\tfrac{\\pi+\\epsilon}{2}\\,I - i\\sin\\!\\tfrac{\\pi+\\epsilon}{2}\\,\\sigma_x.$$\n2.  Compute $U_{corr}X_1$ on the first qubit:  \n$$\\bigl[\\cos\\tfrac{\\pi+\\epsilon}{2}I - i\\sin\\tfrac{\\pi+\\epsilon}{2}\\sigma_x\\bigr]\\sigma_x\n=\\cos\\tfrac{\\pi+\\epsilon}{2}\\,\\sigma_x - i\\sin\\tfrac{\\pi+\\epsilon}{2}\\,I.$$\n3.  Apply this to $|\\psi_L\\rangle$:  \n$$|\\psi_{corr}\\rangle\n=\\Bigl[\\cos\\tfrac{\\pi+\\epsilon}{2}\\,\\sigma_{x1}-i\\sin\\tfrac{\\pi+\\epsilon}{2}\\,I_1\\Bigr]\n(\\alpha|000\\rangle+\\beta|111\\rangle)$$\n$$=\\cos\\tfrac{\\pi+\\epsilon}{2}(\\alpha|100\\rangle+\\beta|011\\rangle)\n -i\\sin\\tfrac{\\pi+\\epsilon}{2}(\\alpha|000\\rangle+\\beta|111\\rangle).$$\n4.  Compute the overlap with $|\\psi_L\\rangle$:  \n$$\\langle\\psi_L|\\psi_{corr}\\rangle\n=-i\\sin\\tfrac{\\pi+\\epsilon}{2}\\bigl(|\\alpha|^2+|\\beta|^2\\bigr)\n=-i\\sin\\tfrac{\\pi+\\epsilon}{2}.$$\n5.  The fidelity is  \n$$F=\\bigl|\\langle\\psi_L|\\psi_{corr}\\rangle\\bigr|^2\n=\\sin^2\\!\\tfrac{\\pi+\\epsilon}{2}\n=\\cos^2\\!\\tfrac{\\epsilon}{2}.$$", "answer": "$$\\boxed{\\cos^2\\frac{\\epsilon}{2}}$$", "id": "106658"}]}