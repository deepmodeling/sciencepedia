{"hands_on_practices": [{"introduction": "To verify the security of the quantum channel in the E91 protocol, Alice and Bob must first confirm that they indeed share entangled states. This is done by performing a Bell test and calculating the Clauser-Horne-Shimony-Holt (CHSH) parameter, $S$. This foundational practice [@problem_id:152753] walks you through the direct calculation of $S$ for an ideal singlet state $|\\psi^{-}\\rangle$ and a specific set of measurement choices, allowing you to see firsthand how quantum correlations lead to a value that is impossible under classical physics.", "problem": "The E91 quantum key distribution protocol, proposed by Artur Ekert in 1991, leverages the properties of quantum entanglement to ensure secure communication. A key part of the protocol involves two parties, Alice and Bob, performing a Bell test on shared pairs of entangled qubits to verify the security of their quantum channel. This test checks for a violation of the Clauser-Horne-Shimony-Holt (CHSH) inequality, which is a necessary condition for the correlations to be explainable by local hidden-variable theories.\n\nSuppose Alice and Bob share a great number of qubit pairs, each prepared in the singlet state:\n$$|\\psi^{-}\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\nTo perform the Bell test, Alice and Bob each measure the spin of their respective qubit along one of two chosen directions. The measurement operator for a spin projection along a direction vector $\\vec{u}$ in the x-z plane making an angle $\\theta$ with the positive z-axis is given by $\\sigma(\\theta) = \\vec{u} \\cdot \\vec{\\sigma} = \\sin\\theta \\, \\sigma_x + \\cos\\theta \\, \\sigma_z$, where $\\vec{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ is the vector of Pauli matrices.\n\nAlice randomly chooses between two measurement settings, $A = \\sigma(\\theta_A)$ and $A' = \\sigma(\\theta_{A'})$, with angles $\\theta_A = 0$ and $\\theta_{A'} = \\pi/2$.\nSimilarly, Bob randomly chooses between his two settings, $B = \\sigma(\\theta_B)$ and $B' = \\sigma(\\theta_{B'})$, with angles $\\theta_B = \\pi/4$ and $\\theta_{B'} = 3\\pi/4$.\n\nThe CHSH parameter, $S$, is constructed from the expectation values of the products of these measurements:\n$$S = E(A, B) - E(A, B') + E(A', B) + E(A', B')$$\nwhere, for example, $E(A, B) = \\langle \\psi^{-} | A \\otimes B | \\psi^{-} \\rangle$. Calculate the value of $S$ for the given state and measurement settings.", "solution": "The singlet state is given by:\n$$|\\psi^{-}\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\n\nThe measurement operators are defined as $\\sigma(\\theta) = \\sin\\theta \\, \\sigma_x + \\cos\\theta \\, \\sigma_z$. For Alice:\n- $A = \\sigma(0) = \\cos(0) \\, \\sigma_z = \\sigma_z$ (since $\\sin(0)=0$)\n- $A' = \\sigma(\\pi/2) = \\sin(\\pi/2) \\, \\sigma_x = \\sigma_x$ (since $\\cos(\\pi/2)=0$)\n\nFor Bob:\n- $B = \\sigma(\\pi/4) = \\sin(\\pi/4) \\, \\sigma_x + \\cos(\\pi/4) \\, \\sigma_z = \\frac{\\sqrt{2}}{2} (\\sigma_x + \\sigma_z)$\n- $B' = \\sigma(3\\pi/4) = \\sin(3\\pi/4) \\, \\sigma_x + \\cos(3\\pi/4) \\, \\sigma_z = \\frac{\\sqrt{2}}{2} (\\sigma_x - \\sigma_z)$\n\nThe expectation value for the singlet state is given by:\n$$\\langle \\psi^{-} | (\\vec{a} \\cdot \\vec{\\sigma}) \\otimes (\\vec{b} \\cdot \\vec{\\sigma}) | \\psi^{-} \\rangle = -\\vec{a} \\cdot \\vec{b}$$\nwhere $\\vec{a}$ and $\\vec{b}$ are unit vectors in the directions of the measurements.\n\nThe direction vectors in the x-z plane are:\n- For $A$: $\\vec{a}_A = (0, 0, 1)$ (along z-axis)\n- For $A'$: $\\vec{a}_{A'} = (1, 0, 0)$ (along x-axis)\n- For $B$: $\\vec{b}_B = (\\sin(\\pi/4), 0, \\cos(\\pi/4)) = \\left( \\frac{\\sqrt{2}}{2}, 0, \\frac{\\sqrt{2}}{2} \\right)$\n- For $B'$: $\\vec{b}_{B'} = (\\sin(3\\pi/4), 0, \\cos(3\\pi/4)) = \\left( \\frac{\\sqrt{2}}{2}, 0, -\\frac{\\sqrt{2}}{2} \\right)$\n\nNow compute each expectation value:\n- $E(A, B) = -\\vec{a}_A \\cdot \\vec{b}_B = - \\left[ (0)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (1)\\left(\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n- $E(A, B') = -\\vec{a}_A \\cdot \\vec{b}_{B'} = - \\left[ (0)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (1)\\left(-\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\left(-\\frac{\\sqrt{2}}{2}\\right) = \\frac{\\sqrt{2}}{2}$\n- $E(A', B) = -\\vec{a}_{A'} \\cdot \\vec{b}_B = - \\left[ (1)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (0)\\left(\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n- $E(A', B') = -\\vec{a}_{A'} \\cdot \\vec{b}_{B'} = - \\left[ (1)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (0)\\left(-\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n\nThe CHSH parameter is:\n$$S = E(A, B) - E(A, B') + E(A', B) + E(A', B')$$\nSubstitute the values:\n$$S = \\left(-\\frac{\\sqrt{2}}{2}\\right) - \\left(\\frac{\\sqrt{2}}{2}\\right) + \\left(-\\frac{\\sqrt{2}}{2}\\right) + \\left(-\\frac{\\sqrt{2}}{2}\\right) = -\\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} = -4 \\cdot \\frac{\\sqrt{2}}{2} = -2\\sqrt{2}$$", "answer": "$$\\boxed{-2\\sqrt{2}}$$", "id": "152753"}, {"introduction": "The true power of the E91 protocol lies in its ability to detect eavesdropping. Any attempt by an eavesdropper, Eve, to measure the transmitted qubits will disturb the delicate entanglement shared between Alice and Bob. This hands-on problem [@problem_id:152778] simulates a classic intercept-resend attack, where Eve measures Bob's qubit and sends him a new one based on her result. By calculating the new CHSH value, you will discover how such an intrusion collapses the quantum correlations and makes Eve's presence detectable.", "problem": "In the E91 protocol for quantum key distribution, Alice and Bob share a large number of entangled qubit pairs to establish a secret key. A crucial part of the protocol is to test for the presence of an eavesdropper (Eve) by checking for a violation of a Bell inequality on a subset of the shared pairs.\n\nConsider that the source produces pairs of qubits in the singlet state:\n$$|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\nOne qubit is sent to Alice, and the other to Bob. To test the security of the channel, they perform measurements according to the Clauser-Horne-Shimony-Holt (CHSH) formalism. Alice chooses between two measurement observables, $A_1$ and $A_2$, and Bob chooses between $B_1$ and $B_2$. The observables are defined as follows:\n- Alice's observables: $A_1 = \\sigma_Z$, $A_2 = \\sigma_X$\n- Bob's observables: $B_1 = \\frac{1}{\\sqrt{2}}(\\sigma_Z + \\sigma_X)$, $B_2 = \\frac{1}{\\sqrt{2}}(-\\sigma_Z + \\sigma_X)$\n\nwhere $\\sigma_X, \\sigma_Y, \\sigma_Z$ are the standard Pauli matrices. The effectiveness of the test is quantified by the CHSH value $S$, defined as:\n$$S = \\langle A_1 B_1 \\rangle - \\langle A_1 B_2 \\rangle + \\langle A_2 B_1 \\rangle + \\langle A_2 B_2 \\rangle$$\nwhere $\\langle \\cdot \\rangle$ denotes the expectation value with respect to the shared quantum state. For a pure singlet state, these settings yield $S = -2\\sqrt{2}$, maximally violating the classical bound of $|S| \\le 2$.\n\nNow, suppose an eavesdropper, Eve, performs an intercept-resend attack on the channel to Bob. For every qubit traveling from the source to Bob, Eve intercepts it, measures it in the computational basis $\\{|0\\rangle, |1\\rangle\\}$, and then sends a new qubit to Bob prepared in the state corresponding to her measurement outcome. Specifically, if Eve measures the qubit in the state $|0\\rangle$, she sends a fresh qubit in the state $|0\\rangle$ to Bob. If she measures $|1\\rangle$, she sends $|1\\rangle$.\n\nCalculate the value of the CHSH parameter $S$ that Alice and Bob would observe under this specific intercept-resend attack.", "solution": "First, we determine the post-attack state $\\rho_{AB}$ that Alice and Bob share. The source prepares the singlet state $|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$. Eve intercepts Bob's qubit and measures it in the computational basis $\\{|0\\rangle, |1\\rangle\\}$.\n\n- With probability $\\frac{1}{2}$, Eve's measurement outcome is $|0\\rangle$. This collapses Alice's qubit into the state $|1\\rangle$. Eve then sends a new qubit in the state $|0\\rangle$ to Bob. The shared state for this case is $|10\\rangle$.\n- With probability $\\frac{1}{2}$, Eve's measurement outcome is $|1\\rangle$. This collapses Alice's qubit into the state $|0\\rangle$. Eve then sends a new qubit in the state $|1\\rangle$ to Bob. The shared state for this case is $|01\\rangle$.\n\nSince these two outcomes are equally likely, the final state shared by Alice and Bob is a classical mixture:\n$$ \\rho_{AB} = \\frac{1}{2}\\left(|10\\rangle\\langle 10| + |01\\rangle\\langle 01|\\right) $$\n\nNow, we compute the expectation value for each term in the CHSH parameter $S$.\n1.  $\\langle A_1 B_1 \\rangle = \\text{Tr}(\\rho_{AB} (A_1 \\otimes B_1))$. Since $\\rho_{AB}$ is a mixture of product states, we can average the expectation values for each part:\n    $$ \\langle A_1 B_1 \\rangle = \\frac{1}{2} \\langle 10 | \\sigma_Z \\otimes \\frac{\\sigma_Z+\\sigma_X}{\\sqrt{2}} | 10 \\rangle + \\frac{1}{2} \\langle 01 | \\sigma_Z \\otimes \\frac{\\sigma_Z+\\sigma_X}{\\sqrt{2}} | 01 \\rangle $$\n    $$ = \\frac{1}{2} \\langle 1 | \\sigma_Z | 1 \\rangle \\langle 0 | \\frac{\\sigma_Z+\\sigma_X}{\\sqrt{2}} | 0 \\rangle + \\frac{1}{2} \\langle 0 | \\sigma_Z | 0 \\rangle \\langle 1 | \\frac{\\sigma_Z+\\sigma_X}{\\sqrt{2}} | 1 \\rangle $$\n    $$ = \\frac{1}{2}(-1) \\left(\\frac{1}{\\sqrt{2}}\\right) + \\frac{1}{2}(1) \\left(\\frac{-1}{\\sqrt{2}}\\right) = -\\frac{1}{2\\sqrt{2}} - \\frac{1}{2\\sqrt{2}} = -\\frac{1}{\\sqrt{2}} $$\n2.  $\\langle A_1 B_2 \\rangle = \\text{Tr}(\\rho_{AB} (A_1 \\otimes B_2))$:\n    $$ \\langle A_1 B_2 \\rangle = \\frac{1}{2} \\langle 1 | \\sigma_Z | 1 \\rangle \\langle 0 | \\frac{-\\sigma_Z+\\sigma_X}{\\sqrt{2}} | 0 \\rangle + \\frac{1}{2} \\langle 0 | \\sigma_Z | 0 \\rangle \\langle 1 | \\frac{-\\sigma_Z+\\sigma_X}{\\sqrt{2}} | 1 \\rangle $$\n    $$ = \\frac{1}{2}(-1) \\left(\\frac{-1}{\\sqrt{2}}\\right) + \\frac{1}{2}(1) \\left(\\frac{1}{\\sqrt{2}}\\right) = \\frac{1}{2\\sqrt{2}} + \\frac{1}{2\\sqrt{2}} = \\frac{1}{\\sqrt{2}} $$\n3.  $\\langle A_2 B_1 \\rangle = \\text{Tr}(\\rho_{AB} (A_2 \\otimes B_1))$. Since $\\langle 0 | \\sigma_X | 0 \\rangle = \\langle 1 | \\sigma_X | 1 \\rangle = 0$, both terms in the average will be zero. Thus, $\\langle A_2 B_1 \\rangle = 0$.\n4.  $\\langle A_2 B_2 \\rangle = \\text{Tr}(\\rho_{AB} (A_2 \\otimes B_2))$. For the same reason, $\\langle A_2 B_2 \\rangle = 0$.\n\nFinally, we assemble the CHSH parameter:\n$$ S = \\langle A_1 B_1 \\rangle - \\langle A_1 B_2 \\rangle + \\langle A_2 B_1 \\rangle + \\langle A_2 B_2 \\rangle = -\\frac{1}{\\sqrt{2}} - \\frac{1}{\\sqrt{2}} + 0 + 0 = -\\frac{2}{\\sqrt{2}} = -\\sqrt{2} $$", "answer": "$$\\boxed{-\\sqrt{2}}$$", "id": "152778"}, {"introduction": "Beyond malicious attacks, real-world implementations of quantum communication must contend with environmental noise, which can also corrupt entangled states. This exercise [@problem_id:152873] explores the effect of a depolarizing channel on Bob's qubit, a common model for noise where a state has a probability $p$ of becoming completely random. By calculating the maximum possible CHSH value as a function of $p$, you will gain insight into the protocol's resilience and determine the critical noise threshold above which secure key distribution is no longer possible.", "problem": "In the E91 protocol for quantum key distribution, Alice and Bob share a large number of entangled two-qubit pairs. To ensure the security of their communication channel, they perform a statistical test on a subset of these pairs to check for violations of a Bell inequality, typically the Clauser-Horne-Shimony-Holt (CHSH) inequality. A significant violation confirms the presence of quantum correlations and bounds the information an eavesdropper could have gained.\n\nSuppose Alice and Bob ideally share pairs in the singlet state $|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$. However, the quantum channel is noisy. Specifically, Bob's qubit of each pair is subjected to a depolarizing channel before his measurement. The single-qubit depolarizing channel $\\mathcal{E}_p$ is described by its action on an arbitrary single-qubit state $\\rho_B$:\n$$ \\mathcal{E}_p(\\rho_B) = (1-p)\\rho_B + p \\frac{I_B}{2} $$\nwhere $p$ is the depolarization probability ($0 \\le p \\le 1$) and $I_B$ is the identity operator on Bob's Hilbert space.\n\nAlice and Bob perform measurements of spin projections along chosen directions. These measurements correspond to observables $A_i = \\vec{a}_i \\cdot \\vec{\\sigma}$ for Alice and $B_j = \\vec{b}_j \\cdot \\vec{\\sigma}$ for Bob, where $\\vec{a}_i$ and $\\vec{b}_j$ are unit vectors in $\\mathbb{R}^3$ and $\\vec{\\sigma}=(\\sigma_x, \\sigma_y, \\sigma_z)$ is the vector of Pauli matrices. They use two measurement settings each ($i, j \\in \\{1, 2\\}$) to test the CHSH inequality. The CHSH value is the expectation value of the operator:\n$$ S = A_1 \\otimes B_1 - A_1 \\otimes B_2 + A_2 \\otimes B_1 + A_2 \\otimes B_2 $$\nCalculate the maximum possible value of $\\langle S \\rangle$, maximized over all possible measurement directions $(\\vec{a}_1, \\vec{a}_2, \\vec{b}_1, \\vec{b}_2)$, as a function of the depolarization probability $p$.", "solution": "The initial state is the singlet state $\\rho_{AB} = |\\psi^-\\rangle\\langle\\psi^-|$.\nWhen the depolarizing channel $\\mathcal{E}_p$ acts on Bob's qubit, the state becomes $\\rho'_{AB} = (I_A \\otimes \\mathcal{E}_p)(\\rho_{AB})$. For a maximally entangled state, the action of a single-qubit depolarizing channel with probability $p$ is equivalent to mixing the original state with the maximally mixed state $I_{AB}/4$. The resulting state is a Werner state:\n$$ \\rho'_{AB} = (1-p) \\rho_{AB} + p \\frac{I_{AB}}{4} $$\nThis is because $\\operatorname{Tr}_B(\\rho_{AB}) = I_A/2$, so $(I_A \\otimes \\mathcal{E}_p)(\\rho_{AB}) = (1-p)\\rho_{AB} + p (I_A/2 \\otimes I_B/2) = (1-p)\\rho_{AB} + p I_{AB}/4$.\n\nThe expectation value of a CHSH operator term $A_i \\otimes B_j$ in this new state is:\n$$ \\langle A_i \\otimes B_j \\rangle' = \\operatorname{Tr}(\\rho'_{AB} (A_i \\otimes B_j)) = (1-p) \\operatorname{Tr}(\\rho_{AB} (A_i \\otimes B_j)) + p \\operatorname{Tr}\\left( \\frac{I_{AB}}{4} (A_i \\otimes B_j) \\right) $$\nSince the Pauli matrices are traceless, $\\operatorname{Tr}(A_i) = \\operatorname{Tr}(B_j) = 0$, which means $\\operatorname{Tr}(A_i \\otimes B_j) = 0$. The second term vanishes.\nThus, the expectation value is simply scaled by $(1-p)$:\n$$ \\langle A_i \\otimes B_j \\rangle' = (1-p) \\langle A_i \\otimes B_j \\rangle_0 $$\nwhere $\\langle \\cdot \\rangle_0$ denotes the expectation in the original singlet state. For the singlet state, we know that $\\langle A_i \\otimes B_j \\rangle_0 = -\\vec{a}_i \\cdot \\vec{b}_j$.\nTherefore, the CHSH expectation value is:\n$$ \\langle S \\rangle = \\langle A_1 B_1 \\rangle' - \\langle A_1 B_2 \\rangle' + \\langle A_2 B_1 \\rangle' + \\langle A_2 B_2 \\rangle' $$\n$$ \\langle S \\rangle = (1-p) \\left[ -(\\vec{a}_1 \\cdot \\vec{b}_1) - (-(\\vec{a}_1 \\cdot \\vec{b}_2)) + (-(\\vec{a}_2 \\cdot \\vec{b}_1)) + (-(\\vec{a}_2 \\cdot \\vec{b}_2)) \\right] $$\n$$ \\langle S \\rangle = -(1-p) \\left[ \\vec{a}_1 \\cdot \\vec{b}_1 - \\vec{a}_1 \\cdot \\vec{b}_2 + \\vec{a}_2 \\cdot \\vec{b}_1 + \\vec{a}_2 \\cdot \\vec{b}_2 \\right] $$\nLet's define the classical part $C = \\vec{a}_1 \\cdot (\\vec{b}_1 - \\vec{b}_2) + \\vec{a}_2 \\cdot (\\vec{b}_1 + \\vec{b}_2)$. To maximize $\\langle S \\rangle$, we need to maximize $|C|$.\nBy choosing $\\vec{a}_1$ parallel to $(\\vec{b}_1 - \\vec{b}_2)$ and $\\vec{a}_2$ parallel to $(\\vec{b}_1 + \\vec{b}_2)$, the maximum value of $C$ for fixed $\\vec{b}_1, \\vec{b}_2$ is:\n$$ \\max_{\\vec{a}_1, \\vec{a}_2} |C| = |\\vec{b}_1 - \\vec{b}_2| + |\\vec{b}_1 + \\vec{b}_2| $$\nUsing $|\\vec{u} \\pm \\vec{v}|^2 = |\\vec{u}|^2 + |\\vec{v}|^2 \\pm 2\\vec{u}\\cdot\\vec{v}$, and since $\\vec{b}_1, \\vec{b}_2$ are unit vectors:\n$$ |\\vec{b}_1 - \\vec{b}_2|^2 = 2 - 2\\vec{b}_1 \\cdot \\vec{b}_2 $$\n$$ |\\vec{b}_1 + \\vec{b}_2|^2 = 2 + 2\\vec{b}_1 \\cdot \\vec{b}_2 $$\nThe sum is $\\sqrt{2 - 2\\cos\\theta} + \\sqrt{2 + 2\\cos\\theta}$, where $\\theta$ is the angle between $\\vec{b}_1$ and $\\vec{b}_2$.\nThis function is maximized when $\\cos\\theta=0$ (i.e., $\\vec{b}_1 \\perp \\vec{b}_2$), which gives $\\sqrt{2} + \\sqrt{2} = 2\\sqrt{2}$.\nTherefore, the maximum possible value for $|C|$ is $2\\sqrt{2}$. This is the Tsirelson bound for the classical part of the CHSH expression.\n\nThe maximum value for the CHSH parameter $\\langle S \\rangle$ is then:\n$$ \\max \\langle S \\rangle = (1-p) \\times (\\max|C|) = (1-p) \\cdot 2\\sqrt{2} $$\nThe maximum is achieved by choosing the measurement settings appropriately. For example, by choosing $\\vec{b}_1$ and $\\vec{b}_2$ to be orthogonal, and $\\vec{a}_1, \\vec{a}_2$ aligned with $\\vec{b}_1 \\mp \\vec{b}_2$. A standard choice would give $S = 2\\sqrt{2}$. Then the value in the noisy case is $S_{max} = 2\\sqrt{2}(1-p)$.", "answer": "$$ \\boxed{2\\sqrt{2}\\left(1 - p\\right)} $$", "id": "152873"}]}