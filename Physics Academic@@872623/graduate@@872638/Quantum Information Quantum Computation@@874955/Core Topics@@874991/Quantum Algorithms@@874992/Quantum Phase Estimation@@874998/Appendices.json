{"hands_on_practices": [{"introduction": "Understanding the Quantum Phase Estimation (QPE) algorithm begins with dissecting its core mechanics. This first practice invites you to analyze a simplified QPE circuit where the target register is intentionally prepared in a superposition of eigenstates. By tracing the state evolution step-by-step, you will gain a concrete understanding of how QPE effectively performs a measurement in the eigenbasis of the unitary operator, revealing the probabilistic nature of its output for superposition inputs [@problem_id:125935].", "problem": "The Quantum Phase Estimation (QPE) algorithm is a fundamental quantum algorithm for determining the eigenvalue of a unitary operator $U$. Given an eigenstate $|\\psi\\rangle$ of $U$ such that $U|\\psi\\rangle = e^{i\\theta}|\\psi\\rangle$, the algorithm estimates the phase $\\theta$. A common representation of the phase is $\\theta = 2\\pi\\phi$, where $\\phi \\in [0, 1)$ is the phase fraction. The standard QPE circuit uses a $t$-qubit control register and a target register that holds the eigenstate $|\\psi\\rangle$. The algorithm consists of three main stages:\n1.  Initialization: The control register is initialized to $|0\\rangle^{\\otimes t}$ and then a Hadamard transform is applied to each control qubit. The target register is prepared in the state $|\\psi\\rangle$.\n2.  Controlled Unitary Operations: For each control qubit $k$ (from $0$ to $t-1$), a controlled-$U^{2^k}$ gate is applied to the target register.\n3.  Inverse Quantum Fourier Transform (IQFT): The IQFT is applied to the control register.\n4.  Measurement: The control register is measured in the computational basis. The result provides an estimate of the phase $\\phi$.\n\nConsider a simplified QPE circuit with a single-qubit control register ($t=1$) and a single-qubit target register. The unitary operator is the Pauli-$Z$ gate, $U=Z$. The eigenstates of the $Z$ gate are $|0\\rangle$ and $|1\\rangle$, with eigenvalues $+1$ and $-1$ respectively, corresponding to phase fractions $\\phi=0$ and $\\phi=1/2$.\n\nInstead of preparing the target register in an eigenstate of $Z$, it is prepared in the state $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$. The control register is initialized to $|0\\rangle$.\n\nThe QPE circuit for this setup is as follows:\n1.  Initialize the system to $|0\\rangle_c |+\\rangle_t$.\n2.  Apply a Hadamard gate $H$ to the control qubit.\n3.  Apply a controlled-$Z$ gate, with the control on the control qubit and the target on the target qubit.\n4.  Apply an Inverse QFT to the control qubit. For a single qubit, the IQFT is simply the Hadamard gate $H$.\n\nCalculate the probability of measuring the state $|0\\rangle$ in the control register after the full circuit has been applied.\n\nGate definitions:\n- Hadamard gate: $H = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$\n- Pauli-Z gate: $Z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$\n- Controlled-Z (CZ) gate: $CZ|c,t\\rangle = (-1)^{ct}|c,t\\rangle$ for control bit $c \\in \\{0,1\\}$ and target bit $t \\in \\{0,1\\}$.", "solution": "We label the control qubit by 'c' and the target qubit by 't'.\n1. Initial state:  \n$$|\\Psi_0\\rangle \\;=\\; |0\\rangle_c\\otimes|+\\rangle_t \\;=\\; |0\\rangle_c\\otimes\\frac{1}{\\sqrt{2}}(|0\\rangle_t+|1\\rangle_t)\\,. $$  \n2. After Hadamard on the control qubit:  \n$$H_c|0\\rangle_c = \\frac{1}{\\sqrt{2}}(|0\\rangle_c+|1\\rangle_c)\\,, $$  \nso  \n$$|\\Psi_1\\rangle \\;=\\; \\frac{1}{\\sqrt{2}}(|0\\rangle_c+|1\\rangle_c)\\otimes\\frac{1}{\\sqrt{2}}(|0\\rangle_t+|1\\rangle_t)\n=\\frac{1}{2}\\sum_{c,t\\in\\{0,1\\}}|c,t\\rangle\\,. $$  \n3. Apply the controlled-$Z$ gate, which acts as $CZ|c,t\\rangle =(-1)^{c\\,t}|c,t\\rangle$. Thus  \n$$|\\Psi_2\\rangle \n=\\frac{1}{2}\\bigl(|0,0\\rangle+|0,1\\rangle+|1,0\\rangle -|1,1\\rangle\\bigr)\\,. $$  \n4. Apply Hadamard on the control again (this is the 1-qubit IQFT):  \nFor each basis $|c,t\\rangle$,  \n$$H_c|c\\rangle = \\frac{1}{\\sqrt{2}}\\bigl(|0\\rangle +(-1)^c|1\\rangle\\bigr)\\,. $$  \nHence the joint amplitudes become  \n\n$$\n|\\Psi_3\\rangle\n=\\sum_{t}\\Bigl[\\frac{a_{0t}+a_{1t}}{\\sqrt{2}}\\,|0,t\\rangle\n           +\\frac{a_{0t}-a_{1t}}{\\sqrt{2}}\\,|1,t\\rangle\\Bigr]\n$$\n\nwith $a_{00}=a_{01}=a_{10}=+\\tfrac12$, $a_{11}=-\\tfrac12$.  One finds explicitly  \n\n$$\n|\\Psi_3\\rangle\n=\\frac{1}{\\sqrt{2}}\\,|0,0\\rangle\n+\\frac{1}{\\sqrt{2}}\\,|1,1\\rangle\\,.\n$$\n  \n5. The probability to measure the control in $|0\\rangle$ is the sum of squared moduli of amplitudes with control $=0$:  \n$$P(0_c)=\\Bigl|\\tfrac{1}{\\sqrt{2}}\\Bigr|^2 = \\tfrac12\\,. $$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "125935"}, {"introduction": "One of the most powerful applications of QPE is in determining the energy eigenvalues of physical systems, a central task in quantum chemistry and materials science. This exercise moves from abstract principles to a practical application: estimating the ground state energy of a two-qubit Hamiltonian. You will explore what happens when the initial state prepared is only an approximation of the true ground state, a common scenario in variational methods, and calculate the probability of successfully measuring the true ground energy [@problem_id:125794].", "problem": "The Quantum Phase Estimation (QPE) algorithm is a cornerstone of quantum computation, primarily used to determine the eigenvalues of a unitary operator $U$. When an input state $|\\psi_{in}\\rangle$ is prepared, which can be expressed as a linear combination of the eigenstates $|\\phi_j\\rangle$ of $U$ (i.e., $|\\psi_{in}\\rangle = \\sum_j c_j |\\phi_j\\rangle$), the QPE algorithm will measure the phase $\\theta_j$ of a corresponding eigenvalue $e^{i\\theta_j}$ with a probability given by $|c_j|^2$.\n\nConsider a QPE procedure designed to find the energy eigenvalues of a two-qubit Hamiltonian given by:\n$$\nH = Z_1 + g X_1 X_2\n$$\nHere, $Z_1 = Z \\otimes I$ and $X_1 X_2 = X \\otimes X$ are operators acting on a two-qubit Hilbert space, where $Z$ and $X$ are the standard Pauli matrices. The parameter $g$ is a real, positive coupling constant. The QPE procedure uses the unitary $U = e^{-iHt}$ for some evolution time $t$ and effectively probes the energy spectrum of $H$.\n\nThe system is prepared in the initial state $|\\psi_{in}\\rangle = |10\\rangle$. Note that this state is one of the two degenerate ground states of the isolated Hamiltonian term $H_0 = Z_1$.\n\nA \"successful\" measurement is defined as one that yields the ground state energy, $E_g$, of the full Hamiltonian $H$. Assuming the QPE circuit has a sufficient number of ancillary qubits to resolve the distinct energy eigenvalues of $H$ without any approximation error, calculate the probability of success, $P_{succ}$, as a function of the coupling parameter $g$.", "solution": "The Hamiltonian is given by $ H = Z_1 + g X_1 X_2 $, where $ Z_1 = Z \\otimes I $ and $ X_1 X_2 = X \\otimes X $. The initial state is $ |\\psi_{\\text{in}}\\rangle = |10\\rangle $. The goal is to find the probability of measuring the ground state energy $ E_g $ of $ H $ using the Quantum Phase Estimation algorithm, which depends on expressing $ |\\psi_{\\text{in}}\\rangle $ in the eigenbasis of $ H $ and extracting the coefficient for the ground state.\n\nThe matrix representation of $ H $ in the computational basis $ \\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\} $ is:\n$$\nH = \\begin{pmatrix}\n1 & 0 & 0 & g \\\\\n0 & 1 & g & 0 \\\\\n0 & g & -1 & 0 \\\\\ng & 0 & 0 & -1\n\\end{pmatrix}.\n$$\nThis matrix is block-diagonal, with two invariant subspaces: $ \\{|00\\rangle, |11\\rangle\\} $ and $ \\{|01\\rangle, |10\\rangle\\} $. The block for $ \\{|01\\rangle, |10\\rangle\\} $ is:\n$$\nH_{\\{01,10\\}} = \\begin{pmatrix}\n1 & g \\\\\ng & -1\n\\end{pmatrix}.\n$$\nThe initial state $ |10\\rangle $ lies entirely in this subspace. The eigenvalues of this block are found by solving the characteristic equation:\n$$\n\\det \\begin{pmatrix}\n1 - \\lambda & g \\\\\ng & -1 - \\lambda\n\\end{pmatrix} = 0 \\implies (1 - \\lambda)(-1 - \\lambda) - g^2 = 0 \\implies \\lambda^2 - 1 - g^2 = 0.\n$$\nThe solutions are $ \\lambda = \\pm \\sqrt{1 + g^2} $. The ground state energy $ E_g $ corresponds to the lower eigenvalue $ \\lambda_{-} = -\\sqrt{1 + g^2} $.\n\nThe eigenvector $ |v_{-}\\rangle $ for $ \\lambda_{-} $ in the subspace $ \\{|01\\rangle, |10\\rangle\\} $ satisfies:\n$$\n\\begin{pmatrix}\n1 & g \\\\\ng & -1\n\\end{pmatrix} \\begin{pmatrix} A \\\\ B \\end{pmatrix} = -\\sqrt{1 + g^2} \\begin{pmatrix} A \\\\ B \\end{pmatrix},\n$$\nleading to the equation:\n$$\n(1 + \\sqrt{1 + g^2})A + gB = 0 \\implies B = -\\frac{1 + \\sqrt{1 + g^2}}{g} A.\n$$\nChoosing an unnormalized form $ |v_{-}\\rangle = g |01\\rangle - (1 + \\sqrt{1 + g^2}) |10\\rangle $, the norm is:\n$$\n\\| |v_{-}\\rangle \\|^2 = g^2 + (1 + \\sqrt{1 + g^2})^2 = g^2 + 1 + 2\\sqrt{1 + g^2} + 1 + g^2 = 2(1 + g^2 + \\sqrt{1 + g^2}).\n$$\nThus, the normalized eigenvector is:\n$$\n|v_{-}\\rangle = \\frac{g |01\\rangle - (1 + \\sqrt{1 + g^2}) |10\\rangle}{\\sqrt{2(1 + g^2 + \\sqrt{1 + g^2})}}.\n$$\nThe overlap with the initial state $ |10\\rangle $ is:\n$$\n\\langle v_{-} | 10 \\rangle = -\\frac{1 + \\sqrt{1 + g^2}}{\\sqrt{2(1 + g^2 + \\sqrt{1 + g^2})}}.\n$$\nThe probability of measuring the ground state energy is the square of the magnitude of this overlap:\n$$\nP_{\\text{succ}} = \\left| \\langle v_{-} | 10 \\rangle \\right|^2 = \\frac{(1 + \\sqrt{1 + g^2})^2}{2(1 + g^2 + \\sqrt{1 + g^2})}.\n$$\nSimplifying, let $ s = \\sqrt{1 + g^2} $, so:\n$$\nP_{\\text{succ}} = \\frac{(1 + s)^2}{2(s^2 + s)} = \\frac{(1 + s)^2}{2s(s + 1)} = \\frac{1 + s}{2s} = \\frac{1}{2} \\left( 1 + \\frac{1}{s} \\right) = \\frac{1}{2} \\left( 1 + \\frac{1}{\\sqrt{1 + g^2}} \\right).\n$$\nThe initial state $ |10\\rangle $ has no component in the other subspace $ \\{|00\\rangle, |11\\rangle\\} $, so the probability is solely from $ |v_{-}\\rangle $.\n\nThus, the probability of success is:\n$$\nP_{\\text{succ}} = \\frac{1}{2} \\left( 1 + \\frac{1}{\\sqrt{1 + g^2}} \\right).\n$$", "answer": "$$ \\boxed{\\dfrac{1}{2}\\left(1 + \\dfrac{1}{\\sqrt{1 + g^{2}}}\\right)} $$", "id": "125794"}, {"introduction": "In practice, implementing the unitary evolution $U = e^{-iHt}$ required by QPE is often challenging, necessitating approximations like the Trotter-Suzuki decomposition which introduce systematic errors. This advanced exercise introduces a powerful error mitigation technique known as Richardson extrapolation. By combining results from several experiments with different Trotter step sizes, it is possible to cancel out the leading error terms, a crucial technique for achieving high-precision results on near-term quantum hardware [@problem_id:125854].", "problem": "In the quantum simulation of a Hamiltonian $H = \\sum_j H_j$ for a total time $t$, the evolution unitary $U = e^{-iHt}$ is often approximated. A common method is the first-order Trotter-Suzuki decomposition. When used within the Quantum Phase Estimation (QPE) algorithm, this approximation introduces a systematic error in the estimated phase.\n\nAssume that for a fixed total evolution time, the phase $\\hat{\\theta}(\\delta)$ estimated by QPE using a first-order Trotter approximation with a small step size $\\delta$ has an error that can be expanded as a power series:\n$$\n\\hat{\\theta}(\\delta) = \\theta_{true} + C_1 \\delta + C_2 \\delta^2 + C_3 \\delta^3 + \\mathcal{O}(\\delta^4)\n$$\nHere, $\\theta_{true}$ is the exact phase corresponding to an eigenvalue of $U$, and $C_1, C_2, C_3$ are unknown constants determined by the Hamiltonian and the associated eigenstate.\n\nTo mitigate this error, three separate QPE experiments are conducted using Trotter step sizes of $\\epsilon$, $\\epsilon/2$, and $\\epsilon/4$. The resulting phase estimates are denoted as $\\hat{\\theta}(\\epsilon)$, $\\hat{\\theta}(\\epsilon/2)$, and $\\hat{\\theta}(\\epsilon/4)$, respectively.\n\nUsing these three measurements, derive the Richardson-extrapolated estimate for $\\theta_{true}$ that is accurate up to $\\mathcal{O}(\\epsilon^3)$. Express this improved estimate as a single linear combination of the three measured phases $\\hat{\\theta}(\\epsilon)$, $\\hat{\\theta}(\\epsilon/2)$, and $\\hat{\\theta}(\\epsilon/4)$.", "solution": "We have expansions for the measured phase at different step sizes:\n$$\n\\hat\\theta(\\epsilon)=\\theta_{true}+C_1\\epsilon+C_2\\epsilon^2+C_3\\epsilon^3+\\mathcal{O}(\\epsilon^4),\n$$\n$$\n\\hat\\theta\\bigl(\\tfrac\\epsilon2\\bigr)\n=\\theta_{true}+C_1\\tfrac\\epsilon2+C_2\\tfrac{\\epsilon^2}{4}+C_3\\tfrac{\\epsilon^3}{8}+\\mathcal{O}(\\epsilon^4),\n$$\n$$\n\\hat\\theta\\bigl(\\tfrac\\epsilon4\\bigr)\n=\\theta_{true}+C_1\\tfrac\\epsilon4+C_2\\tfrac{\\epsilon^2}{16}+C_3\\tfrac{\\epsilon^3}{64}+\\mathcal{O}(\\epsilon^4).\n$$\nWe seek a linear combination \n$$L=a\\,\\hat\\theta(\\epsilon)+b\\,\\hat\\theta(\\tfrac\\epsilon2)+c\\,\\hat\\theta(\\tfrac\\epsilon4)$$\nsuch that $L=\\theta_{true}+\\mathcal{O}(\\epsilon^3)$.  Matching coefficients gives the system\n$$\na+b+c=1,\\quad\na+\\tfrac b2+\\tfrac c4=0,\\quad\na+\\tfrac b4+\\tfrac c{16}=0.\n$$\nSubtracting the second from the third yields $4b+3c=0\\implies b=-\\tfrac{3c}4$.  Then from the third,\n$$\na=-\\frac b4-\\frac c{16}=\\frac{c}{8}.\n$$\nEnforcing $a+b+c=1$ gives\n$$\n\\frac{c}{8}-\\frac{3c}{4}+c=1\n\\;\\Longrightarrow\\;3c=8\n\\;\\Longrightarrow\\;c=\\frac{8}{3},\\quad b=-2,\\quad a=\\frac{1}{3}.\n$$\nHence the Richardson-extrapolated estimate is\n$$\nL=\\frac{1}{3}\\,\\hat\\theta(\\epsilon)-2\\,\\hat\\theta\\bigl(\\tfrac\\epsilon2\\bigr)\n+\\frac{8}{3}\\,\\hat\\theta\\bigl(\\tfrac\\epsilon4\\bigr)\n=\\frac{\\hat\\theta(\\epsilon)-6\\,\\hat\\theta(\\tfrac\\epsilon2)+8\\,\\hat\\theta(\\tfrac\\epsilon4)}{3}.\n$$", "answer": "$$\\boxed{\\frac{\\hat{\\theta}(\\epsilon)-6\\,\\hat{\\theta}(\\epsilon/2)+8\\,\\hat{\\theta}(\\epsilon/4)}{3}}$$", "id": "125854"}]}