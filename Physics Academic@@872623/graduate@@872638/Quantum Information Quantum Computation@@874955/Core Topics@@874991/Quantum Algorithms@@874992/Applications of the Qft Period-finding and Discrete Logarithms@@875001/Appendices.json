{"hands_on_practices": [{"introduction": "To build a solid understanding of period-finding, we first examine its core engine: the Quantum Phase Estimation (QPE) algorithm. This initial exercise explores an ideal, noise-free scenario to reveal why the Quantum Fourier Transform is so effective. By calculating the measurement probability for a specific case [@problem_id:48169], you will see how the QPE algorithm can perfectly pinpoint a phase that is exactly representable, concentrating the entire probability onto a single outcome.", "problem": "The quantum phase estimation (QPE) algorithm is a fundamental subroutine in many quantum algorithms, including Shor's algorithm for integer factorization. The goal of QPE is to estimate the phase $\\phi \\in [0, 1)$ of an eigenvalue $e^{i2\\pi\\phi}$ of a given unitary operator $U$.\n\nThe standard QPE circuit consists of two quantum registers:\n1.  A control register with $n$ qubits, initialized to the state $|0\\rangle^{\\otimes n}$.\n2.  A target register, prepared in an eigenstate $|\\psi\\rangle$ of $U$ such that $U|\\psi\\rangle = e^{i2\\pi\\phi}|\\psi\\rangle$.\n\nThe algorithm proceeds as follows:\n1.  Apply a Hadamard gate to each qubit in the control register.\n2.  For each qubit $k$ (from $k=0$ to $n-1$) in the control register, apply the controlled-$U^{2^k}$ gate to the target register.\n3.  Apply the inverse Quantum Fourier Transform (IQFT) to the control register.\n4.  Measure the control register in the computational basis. The measurement outcome is an $n$-bit string, which represents an integer $j$ that approximates $2^n\\phi$.\n\nConsider a specific instance of the QPE routine as part of Shor's algorithm for factoring the number $N=51$ with base $a=10$. Suppose that the target register is prepared in a specific eigenstate of the modular exponentiation operator, and this eigenstate corresponds to an exact phase of $\\phi=3/8$. A control register with $n=4$ qubits is used for the estimation.\n\nCalculate the exact probability of measuring the outcome $|1000\\rangle$ in the control register.", "solution": "The problem asks for the probability of measuring a specific outcome in the control register of the quantum phase estimation (QPE) algorithm under a given set of parameters.\n\nThe state of the two registers is initially $|0\\rangle^{\\otimes n} |\\psi\\rangle$.\n\n1.  After applying Hadamard gates to the $n=4$ qubits of the control register, the state becomes:\n    $$\n    \\frac{1}{\\sqrt{2^4}} \\sum_{k=0}^{2^4-1} |k\\rangle |\\psi\\rangle = \\frac{1}{4} \\sum_{k=0}^{15} |k\\rangle |\\psi\\rangle\n    $$\n\n2.  Next, controlled-$U^{2^k}$ operations are applied. The state of the system evolves to:\n    $$\n    \\frac{1}{4} \\sum_{k=0}^{15} |k\\rangle U^k |\\psi\\rangle\n    $$\n    Given that $|\\psi\\rangle$ is an eigenstate of $U$ with eigenvalue $e^{i2\\pi\\phi}$, we have $U^k|\\psi\\rangle = (e^{i2\\pi\\phi})^k |\\psi\\rangle = e^{i2\\pi k \\phi} |\\psi\\rangle$. The state is therefore:\n    $$\n    |\\Psi_{pre-IQFT}\\rangle = \\frac{1}{4} \\sum_{k=0}^{15} e^{i2\\pi k \\phi} |k\\rangle |\\psi\\rangle\n    $$\n\n3.  The inverse Quantum Fourier Transform (IQFT) is applied to the control register. The IQFT acts on a basis state $|k\\rangle$ as:\n    $$\n    \\text{IQFT}|k\\rangle = \\frac{1}{\\sqrt{2^n}} \\sum_{j=0}^{2^n-1} e^{-i2\\pi kj/2^n} |j\\rangle\n    $$\n    Applying this to the control register's state:\n    $$\n    |\\Psi_{final}\\rangle = \\frac{1}{4} \\sum_{k=0}^{15} e^{i2\\pi k \\phi} \\left( \\frac{1}{4} \\sum_{j=0}^{15} e^{-i2\\pi kj/16} |j\\rangle \\right) |\\psi\\rangle\n    $$\n    Rearranging the sums, we get:\n    $$\n    |\\Psi_{final}\\rangle = \\frac{1}{16} \\sum_{j=0}^{15} \\left( \\sum_{k=0}^{15} e^{i2\\pi k \\phi} e^{-i2\\pi kj/16} \\right) |j\\rangle |\\psi\\rangle\n    $$\n    The amplitude of measuring the outcome $|j\\rangle$ in the control register is:\n    $$\n    A_j = \\frac{1}{16} \\sum_{k=0}^{15} e^{i2\\pi k (\\phi - j/16)}\n    $$\n\n4.  We need to calculate the probability of measuring the outcome $|1000\\rangle$. In decimal, this binary string corresponds to the integer $j$:\n    $$\n    j = 1 \\cdot 2^3 + 0 \\cdot 2^2 + 0 \\cdot 2^1 + 0 \\cdot 2^0 = 8\n    $$\n\n5.  We substitute the given values into the amplitude expression for $j=8$:\n    -   $n=4$\n    -   $\\phi=3/8$\n    -   $j=8$\n\n    The argument of the exponent is:\n    $$\n    \\phi - \\frac{j}{16} = \\frac{3}{8} - \\frac{8}{16} = \\frac{3}{8} - \\frac{1}{2} = \\frac{3-4}{8} = -\\frac{1}{8}\n    $$\n    The amplitude $A_8$ is:\n    $$\n    A_8 = \\frac{1}{16} \\sum_{k=0}^{15} e^{i2\\pi k (-1/8)} = \\frac{1}{16} \\sum_{k=0}^{15} e^{-i\\pi k/4}\n    $$\n\n6.  This is a finite geometric series of the form $\\sum_{k=0}^{M-1} r^k$ with $M=16$ and $r = e^{-i\\pi/4}$.\n    The sum of a finite geometric series is given by $\\frac{1-r^M}{1-r}$ for $r \\neq 1$.\n    Here, $r = e^{-i\\pi/4} = \\cos(-\\pi/4) + i\\sin(-\\pi/4) = \\frac{1}{\\sqrt{2}} - i\\frac{1}{\\sqrt{2}}$, which is not equal to 1.\n    So, we can use the formula. Let's evaluate the term $r^M = r^{16}$:\n    $$\n    r^{16} = \\left(e^{-i\\pi/4}\\right)^{16} = e^{-i(16\\pi/4)} = e^{-i4\\pi}\n    $$\n    Using Euler's formula, $e^{-i4\\pi} = \\cos(-4\\pi) + i\\sin(-4\\pi) = 1 + 0i = 1$.\n\n7.  Now substitute this back into the sum formula:\n    $$\n    \\sum_{k=0}^{15} (e^{-i\\pi/4})^k = \\frac{1 - r^{16}}{1 - r} = \\frac{1-1}{1 - e^{-i\\pi/4}} = \\frac{0}{1 - e^{-i\\pi/4}} = 0\n    $$\n    Note that the denominator is not zero.\n\n8.  The amplitude for measuring $j=8$ is:\n    $$\n    A_8 = \\frac{1}{16} \\cdot 0 = 0\n    $$\n\n9.  The probability of an outcome is the squared magnitude of its amplitude.\n    $$\n    P(j=8) = |A_8|^2 = |0|^2 = 0\n    $$\n    The fact that the given phase $\\phi=3/8$ can be expressed exactly with a denominator that divides $2^n=16$ (since $3/8 = 6/16$) implies that the QPE algorithm will yield the outcome $j=6$ with probability 1. Consequently, the probability of measuring any other outcome, including $j=8$, is exactly 0.", "answer": "$$ \\boxed{0} $$", "id": "48169"}, {"introduction": "A successful quantum algorithm relies on both its quantum computation and its classical post-processing. This next practice explores the crucial link between a measurement from the quantum computer and the classical algorithm used to interpret it. You will investigate how a single bit-flip error in a measurement outcome, a plausible hardware fault, propagates through the continued fraction algorithm [@problem_id:48302], demonstrating the sensitivity of the classical analysis and the importance of error detection.", "problem": "The quantum period-finding algorithm is a key component of Shor's algorithm for factoring integers. It aims to find the period $r$ of a function $f(x)$ where $f(x+r)=f(x)$. The algorithm uses an $n$-qubit register, which, after the application of a quantum Fourier transform (QFT) and measurement, yields an integer outcome $k$. Under ideal conditions, the fraction $k/2^n$ is a very good approximation of an unknown rational number $c/r$, where $c$ is a random integer coprime to $r$.\n\nThe classical post-processing of the algorithm involves using the continued fraction algorithm on $k/2^n$ to find candidate fractions $p/q$ that approximate it. The denominators, $q$, of these convergents are the candidates for the period $r$. The sequence of convergents, denoted $C_m = p_m/q_m$ for $m=0, 1, 2, \\dots$, provides successively better approximations.\n\nConsider an instantiation of the period-finding algorithm using an $n=11$ qubit register. The underlying function has a period of $r=7$. A successful run of the quantum part of the algorithm would correctly yield a measurement outcome of $k=585$. However, during the measurement process, a single bit-flip error occurs on the most significant bit (MSB) of the measurement outcome $k$. This results in an erroneous value $k'$.\n\nUsing this incorrect value $k'$, perform the classical post-processing step. Calculate the denominator of the third convergent, $C_2 = p_2/q_2$, of the continued fraction expansion for the ratio $k'/2^n$.", "solution": "1. Flip the MSB of the 11-bit measurement 585.  In 11 bits, 585 has MSB = 0, so flipping it adds $2^{10}$:\n$$k' = 585 + 2^{10} = 585 + 1024 = 1609$$\n\n2. Form the ratio\n$$\\frac{k'}{2^n} = \\frac{1609}{2^{11}} = \\frac{1609}{2048}$$\n\n3. Compute the continued-fraction expansion of $1609/2048$:\n$$\\frac{1609}{2048} = [0;1,3,1,1,1,72,2]$$\n\n4. Use the standard recurrences \n$$p_{-2}=0,\\quad p_{-1}=1,\\quad p_k = a_k p_{k-1} + p_{k-2},$$\n$$q_{-2}=1,\\quad q_{-1}=0,\\quad q_k = a_k q_{k-1} + q_{k-2}$$\nThen\n- $C_0 = p_0/q_0 = 0/1$,\n- $C_1 = p_1/q_1 = 1/1$,\n- $C_2 = p_2/q_2$ with \n  $$p_2 = 3\\cdot p_1 + p_0 = 3\\cdot1 + 0 = 3,$$\n  $$q_2 = 3\\cdot q_1 + q_0 = 3\\cdot1 + 1 = 4$$\nThus the third convergent $C_2 = 3/4$ has denominator $q_2 = 4$.", "answer": "$$\\boxed{4}$$", "id": "48302"}, {"introduction": "Real quantum computers are not perfect; they are susceptible to environmental noise that can corrupt the computation. This exercise moves beyond single bit-flips to a more realistic model of hardware imperfection: depolarizing noise affecting the quantum gates. By analyzing how this noise systematically degrades the quantum state, you will calculate the resulting suppression of the main Fourier peak [@problem_id:48239], providing a quantitative look at how algorithm performance is impacted by decoherence.", "problem": "**Background:** The quantum period-finding algorithm is a key subroutine in several quantum algorithms, including Shor's algorithm for factoring. It is designed to find the period $r$ of a function $f: \\{0, 1, \\dots, N-1\\} \\to Y$, which satisfies the property $f(x) = f(x+r)$ for all $x$. The algorithm typically starts with an $n$-qubit input register (where $N=2^n$) prepared in a uniform superposition $\\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1}|x\\rangle$, and an auxiliary output register. An oracle $U_f$ is applied to map the state to $\\frac{1}{\\sqrt{N}} \\sum_{x=0}^{N-1} |x\\rangle |f(x)\\rangle$. Subsequently, a Quantum Fourier Transform (QFT) is performed on the input register. A measurement on this register yields outcomes $k$ that are heavily concentrated at integer multiples of $N/r$. These concentrations are known as the primary Fourier peaks in the probability distribution of the measurement outcomes. For an ideal quantum computer, the probability of measuring any one of these peaks is $1/r$.\n\n**Problem:** Consider a noisy implementation of the period-finding algorithm where the function $f$ has a period $r$ that is a divisor of $N=2^n$. The oracle $U_f$ is constructed as a sequence of $n$ distinct two-qubit controlled-unitary gates. Following each of these $n$ gates, the two qubits involved are affected by a two-qubit depolarizing channel $\\mathcal{E}(\\rho_{2q}) = (1-p)\\rho_{2q} + p \\frac{I_4}{4}$, where $\\rho_{2q}$ is the state of the two qubits, $p$ is the error probability per gate, and $I_4$ is the identity operator on the two-qubit Hilbert space.\n\nYou are to model the cumulative effect of these $n$ noisy gates on the total system's density matrix, $\\rho_{sys}$, as a global depolarization process. That is, the final state of the system after the noisy oracle is given by:\n$$\n\\rho_{final} = (1-p_{eff})\\rho_{ideal} + p_{eff}\\frac{I_{total}}{D}\n$$\nwhere $\\rho_{ideal}$ is the state created by a perfect oracle, $p_{eff}$ is the effective probability of at least one error occurring across the $n$ gates, $I_{total}$ is the identity on the Hilbert space of both registers, and $D$ is the total dimension of this space. The output register is assumed to be large enough to store all function values uniquely.\n\nCalculate the probability of measuring a specific non-zero primary Fourier peak (e.g., the one corresponding to $k=N/r$) from the input register. Express your answer as a closed-form analytical expression in terms of $n$, the period $r$, and the per-gate error probability $p$.", "solution": "We model the action of the $n$ noisy two-qubit gates as a global depolarization with effective error probability \n$$\np_{\\rm eff}=1-(1-p)^n,\n$$\nsince each gate is followed by an independent depolarizing channel of error probability $p$.  Thus the final state after the oracle is\n$$\n\\rho_{\\rm final}=(1-p_{\\rm eff})\\rho_{\\rm ideal}+p_{\\rm eff}\\frac{I_{\\rm total}}{D},\n$$\nwith $D$ the total dimension.\n\nMeasurement of the input register in the Fourier basis yields for a specific peak $k$ the probability\n$$\nP(k)=(1-p_{\\rm eff})P_{\\rm ideal}(k)+p_{\\rm eff}P_{\\rm mixed}(k).\n$$\nFor a nonzero primary Fourier peak in the ideal case,\n$$\nP_{\\rm ideal}(k)=\\frac1r,\n$$\nand under the maximally mixed state the reduced input register is uniform over $N=2^n$ outcomes,\n$$\nP_{\\rm mixed}(k)=\\frac1N=\\frac1{2^n}.\n$$\nSubstituting $p_{\\rm eff}=1-(1-p)^n$ and $1-p_{\\rm eff}=(1-p)^n$ gives\n$$\nP(k)\n=(1-p)^n\\frac1r+\\bigl[1-(1-p)^n\\bigr]\\frac1{2^n}.\n$$", "answer": "$$\\boxed{\\frac{(1-p)^n}{r}+\\frac{1-(1-p)^n}{2^n}}$$", "id": "48239"}]}