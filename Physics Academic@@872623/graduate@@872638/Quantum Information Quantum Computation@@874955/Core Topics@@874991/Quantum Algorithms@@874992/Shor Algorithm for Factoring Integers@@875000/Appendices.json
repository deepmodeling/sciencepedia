{"hands_on_practices": [{"introduction": "The output of Shor's quantum subroutine is not the factor itself, but a measurement that encodes the period $r$ of a modular exponential function. This practice will guide you through the essential classical post-processing step: using the continued fraction algorithm to decode the quantum measurement and recover a candidate for the period. Mastering this technique is fundamental to connecting the quantum computation to the final classical answer. [@problem_id:132720]", "problem": "In Shor's algorithm for factoring an integer $N$, a key subroutine involves using the Quantum Phase Estimation (QPE) algorithm to find the period $r$ of the function $f(x) = a^x \\pmod{N}$ for a randomly chosen base $a$. The QPE circuit, using a $t$-bit register, produces a measurement outcome, an integer $y$ where $0 \\le y < Q = 2^t$. This measurement provides an estimate of the phase $\\phi = s/r$ for some integer $s$ ($0 \\le s < r$), given by the approximation $\\phi \\approx y/Q$.\n\nTo recover the period $r$ from this approximation, one classically computes the continued fraction expansion of $y/Q$. The rational convergents of this expansion are successively better rational approximations of $y/Q$. The denominator of one of these convergents is a good candidate for the period $r$ or a factor of $r$.\n\nThe continued fraction expansion of a real number $x$ is an expression of the form $[a_0; a_1, a_2, \\dots]$, where the integers $a_i$ are calculated as follows:\n$x_0 = x, a_0 = \\lfloor x_0 \\rfloor$\n$x_1 = 1/(x_0 - a_0), a_1 = \\lfloor x_1 \\rfloor$\n$x_2 = 1/(x_1 - a_1), a_2 = \\lfloor x_2 \\rfloor$\n... and so on, until the process terminates (for rational $x$) or indefinitely (for irrational $x$).\n\nThe $k$-th rational convergent, $C_k = p_k/q_k$, is given by the first $k+1$ terms of this expansion: $C_k = [a_0; a_1, \\dots, a_k]$. The numerators $p_k$ and denominators $q_k$ can be calculated efficiently using the following recurrence relations:\n$p_k = a_k p_{k-1} + p_{k-2}$ with $p_{-2} = 0, p_{-1} = 1$\n$q_k = a_k q_{k-1} + q_{k-2}$ with $q_{-2} = 1, q_{-1} = 0$\n\nConsider an instance of Shor's algorithm attempting to find the period of $a=2$ modulo $N=33$. The QPE circuit uses a $t=8$-bit register (so $Q=2^8=256$) and returns the measurement outcome $y=102$. Your task is to compute the rational convergent $C_2 = p_2/q_2$ from the continued fraction expansion of the measured phase estimate $y/Q$.", "solution": "The problem asks for the rational convergent $C_2 = p_2/q_2$ of the fraction $y/Q = 102/256$.\n\nFirst, we simplify the fraction:\n$$ x = \\frac{102}{256} = \\frac{51}{128} $$\n\nNext, we apply the continued fraction algorithm to find the coefficients $a_0, a_1, a_2$.\n\n**Step 0:**\n$x_0 = \\frac{51}{128}$\n$a_0 = \\lfloor x_0 \\rfloor = \\lfloor \\frac{51}{128} \\rfloor = 0$\n\n**Step 1:**\n$x_1 = \\frac{1}{x_0 - a_0} = \\frac{1}{\\frac{51}{128} - 0} = \\frac{128}{51}$\n$a_1 = \\lfloor x_1 \\rfloor = \\lfloor \\frac{128}{51} \\rfloor = \\lfloor 2.509... \\rfloor = 2$\n\n**Step 2:**\n$x_2 = \\frac{1}{x_1 - a_1} = \\frac{1}{\\frac{128}{51} - 2} = \\frac{1}{\\frac{128 - 102}{51}} = \\frac{1}{\\frac{26}{51}} = \\frac{51}{26}$\n$a_2 = \\lfloor x_2 \\rfloor = \\lfloor \\frac{51}{26} \\rfloor = \\lfloor 1.961... \\rfloor = 1$\n\nWe have now found the first three coefficients of the continued fraction expansion: $a_0=0$, $a_1=2$, and $a_2=1$. The expansion begins as $[0; 2, 1, \\dots]$. This is sufficient to calculate the convergent $C_2$.\n\nNow, we use the recurrence relations to find the numerators $p_k$ and denominators $q_k$ for $k=0, 1, 2$.\nThe initial conditions are $p_{-2} = 0, p_{-1} = 1$ and $q_{-2} = 1, q_{-1} = 0$.\n\n**For k = 0:** ($a_0 = 0$)\n$p_0 = a_0 p_{-1} + p_{-2} = 0 \\cdot 1 + 0 = 0$\n$q_0 = a_0 q_{-1} + q_{-2} = 0 \\cdot 0 + 1 = 1$\nSo, the zeroth convergent is $C_0 = p_0/q_0 = 0/1$.\n\n**For k = 1:** ($a_1 = 2$)\n$p_1 = a_1 p_0 + p_{-1} = 2 \\cdot 0 + 1 = 1$\n$q_1 = a_1 q_0 + q_{-1} = 2 \\cdot 1 + 0 = 2$\nThe first convergent is $C_1 = p_1/q_1 = 1/2$.\n\n**For k = 2:** ($a_2 = 1$)\n$p_2 = a_2 p_1 + p_0 = 1 \\cdot 1 + 0 = 1$\n$q_2 = a_2 q_1 + q_0 = 1 \\cdot 2 + 1 = 3$\nThe second convergent is $C_2 = p_2/q_2 = 1/3$.\n\nThe requested convergent is $C_2$.", "answer": "$$ \\boxed{\\frac{1}{3}} $$", "id": "132720"}, {"introduction": "The success of the classical post-processing hinges on the precision of the quantum phase estimation, which is determined by the number of qubits $t$ in the primary register. A larger $t$ provides better accuracy but requires more resources and a longer computation time. This exercise demonstrates how to calculate the minimum $t$ needed to factor an integer $N$ with a desired probability of success, linking theoretical error bounds to practical hardware requirements. [@problem_id:132696]", "problem": "In Shor's algorithm for factoring an integer $N$, a key subroutine is the Quantum Phase Estimation (QPE) algorithm. This subroutine is used to find the period $r$ of the function $f(x) = a^x \\pmod N$ for a randomly chosen base $a$ that is coprime to $N$. The QPE algorithm is applied to the unitary operator $U$ defined by its action on computational basis states $|y\\rangle$ as $U|y\\rangle = |ay \\pmod N\\rangle$. The eigenvalues of this operator are of the form $e^{i\\phi_s}$ where the phases are $\\phi_s = 2\\pi s/r$ for integers $s \\in \\{0, 1, \\dots, r-1\\}$.\n\nThe QPE algorithm uses a $t$-qubit register (the 'phase register') and outputs an integer $j \\in \\{0, 1, \\dots, 2^t-1\\}$. This measurement is used to produce a rational approximation $\\tilde{\\phi} = j/2^t$ for one of the phases $\\phi = s/r$ (where we drop the factor of $2\\pi$).\n\nFor the subsequent classical part of Shor's algorithm, which uses the continued fractions algorithm to find the period $r$ from the estimate $j/2^t$, the phase estimation must be highly accurate. Specifically, the error must satisfy the inequality:\n$$ \\left| \\frac{s}{r} - \\frac{j}{2^t} \\right| < \\frac{1}{2N^2} $$\nTo achieve a high probability of success, the number of qubits $t$ in the phase register must be chosen carefully. The QPE algorithm guarantees that it can estimate a phase $\\phi$ to an accuracy of $n$ bits (i.e., the error $|\\phi - \\tilde{\\phi}|$ is bounded by $2^{-n}$) with a probability of success of at least $1 - \\epsilon$. This guarantee holds if the number of qubits $t$ is chosen as:\n$$ t = n + \\left\\lceil \\log_2\\left(2 + \\frac{1}{2\\epsilon}\\right) \\right\\rceil $$\nYour task is to calculate the minimum integer number of qubits $t$ required for the phase-estimation register to factor the integer $N=511$, ensuring that the measured phase is accurate enough for the continued fractions algorithm to succeed with a probability of at least $1 - \\epsilon$, for a failure tolerance of $\\epsilon = 1/4$.", "solution": "We require the phase-estimation error bound \n$$ \\left|\\frac{s}{r}-\\frac{j}{2^t}\\right|  \\frac{1}{2N^2} $$\nand QPE guarantees an error $|\\phi-\\tilde{\\phi}| \\le 2^{-n}$, so we impose\n$$ 2^{-n} \\le \\frac{1}{2N^2} \\quad\\Longrightarrow\\quad 2^n \\ge 2N^2 \\quad\\Longrightarrow\\quad n \\ge \\lceil\\log_2(2N^2)\\rceil. $$\nFor $N=511$ we compute\n$$ 2N^2 = 2 \\cdot 511^2 = 2 \\cdot 261,121 = 522,242, $$\nand since $2^{18} = 262,144  522,242  524,288 = 2^{19}$, we have\n$$ n = \\lceil\\log_2(522,242)\\rceil = 19. $$\nNext, to succeed with failure tolerance $\\epsilon=1/4$, we use\n$$ t = n + \\left\\lceil \\log_2\\left(2 + \\frac{1}{2\\epsilon}\\right) \\right\\rceil = 19 + \\left\\lceil \\log_2(2+2) \\right\\rceil = 19 + \\lceil\\log_2(4)\\rceil = 19+2=21. $$", "answer": "$$\\boxed{21}$$", "id": "132696"}, {"introduction": "We have focused on finding the period $r$, but how does this lead to factoring the number $N$? The connection is rooted in number theory and the structure of multiplicative groups modulo composite numbers. This exercise uses the Chinese Remainder Theorem to illustrate that the period $r$ modulo $N$ is the least common multiple of the periods modulo $N$'s prime factors, revealing the mathematical foundation that Shor's algorithm ingeniously exploits. [@problem_id:132634]", "problem": "In Shor's algorithm for factoring a composite integer $N = p_1 p_2$, where $p_1$ and $p_2$ are distinct prime factors, a crucial step is the period-finding subroutine. This subroutine uses a quantum computer to find the period $r$ of the function $f(x) = a^x \\pmod{N}$ for a randomly chosen base $a$ that is coprime to $N$. The period $r$ is defined as the smallest positive integer such that $a^r \\equiv 1 \\pmod{N}$.\n\nAccording to the Chinese Remainder Theorem, the multiplicative group of integers modulo $N$, $(\\mathbb{Z}/N\\mathbb{Z})^\\times$, is isomorphic to the direct product of the groups modulo its prime factors, $(\\mathbb{Z}/p_1\\mathbb{Z})^\\times \\times (\\mathbb{Z}/p_2\\mathbb{Z})^\\times$. This implies that the order (or period) $r$ of an element $a$ modulo $N$ is determined by its orders modulo $p_1$ and $p_2$. Let $r_1$ be the order of $a$ modulo $p_1$ and $r_2$ be the order of $a$ modulo $p_2$.\n\nConsider the task of factoring a number $N$. We are given that its prime factors are $p_1$ and $p_2$. For a particular choice of base $a$, it is found that its order modulo $p_1$ is $r_1 = 6$, and its order modulo $p_2$ is $r_2 = 5$.\n\nDetermine the period $r$ of the function $f(x) = a^x \\pmod{N}$.", "solution": "The period $r$ of $f(x) = a^x \\pmod{N}$ is the smallest positive integer satisfying $a^r \\equiv 1 \\pmod{N}$. Given $N = p_1 p_2$ with $p_1$ and $p_2$ distinct primes, and $a$ coprime to $N$, the Chinese Remainder Theorem implies:\n\n$$\na^r \\equiv 1 \\pmod{N} \\quad \\text{if and only if} \\quad \n\\begin{cases}\na^r \\equiv 1 \\pmod{p_1} \\\\\na^r \\equiv 1 \\pmod{p_2}\n\\end{cases}\n$$\n\nThe conditions $a^r \\equiv 1 \\pmod{p_1}$ and $a^r \\equiv 1 \\pmod{p_2}$ require $r$ to be a multiple of the orders $r_1$ and $r_2$ modulo $p_1$ and $p_2$, respectively. Given $r_1 = 6$ and $r_2 = 5$, so:\n\n$$\nr \\text{ must be a multiple of } 6 \\quad \\text{and} \\quad r \\text{ must be a multiple of } 5.\n$$\n\nThus, $r$ is a common multiple of $5$ and $6$. The least common multiple (LCM) is the smallest such positive integer. Since $5$ and $6$ are coprime ($\\gcd(5,6) = 1$):\n\n$$\n\\operatorname{lcm}(5, 6) = 5 \\times 6 = 30.\n$$\n\nVerifying that $r = 30$ satisfies $a^r \\equiv 1 \\pmod{N}$:\n- Modulo $p_1$: $a^{30} = (a^6)^5 \\equiv 1^5 \\equiv 1 \\pmod{p_1}$ since $r_1 = 6$ divides $30$.\n- Modulo $p_2$: $a^{30} = (a^5)^6 \\equiv 1^6 \\equiv 1 \\pmod{p_2}$ since $r_2 = 5$ divides $30$.\nBy the Chinese Remainder Theorem, $a^{30} \\equiv 1 \\pmod{N}$. Any smaller positive common multiple of $5$ and $6$ would be less than $30$, but no such integer exists since $30$ is the LCM. Therefore, $r = 30$ is the period.", "answer": "$$ \\boxed{30} $$", "id": "132634"}]}