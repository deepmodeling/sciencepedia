{"hands_on_practices": [{"introduction": "The hybrid argument is one of the most intuitive tools for proving quantum lower bounds. It works by quantifying how much two computational paths, corresponding to two different inputs, can diverge with each query. This exercise [@problem_id:107573] applies the hybrid method to a quantum walk-based search, a powerful generalization of Grover's algorithm. By bounding the \"distinguishability\" gained per query when the marked item's location is shifted, we can establish a firm lower bound on the total queries needed for a successful search.", "problem": "A crucial method for establishing query complexity lower bounds in quantum computation is the hybrid argument. It relies on quantifying the distinguishability between the final states of an algorithm run on two different inputs. For a quantum walk-based search algorithm, this translates to bounding the one-step change in the state vector when the location of the marked item is shifted.\n\nConsider a quantum walk search on a directed, $d$-regular graph with $N$ vertices. The Hilbert space of the walk is $\\mathcal{H} = \\mathcal{H}_V \\otimes \\mathcal{H}_C = \\mathbb{C}^N \\otimes \\mathbb{C}^d$, with basis states $|v, j\\rangle$ representing an edge starting from vertex $v$ with label $j \\in \\{1, \\dots, d\\}$.\n\nThe search algorithm evolves an initial state using a walk operator $W_m = S C_m$, where $m$ is the index of the marked vertex. The operator consists of two parts:\n1.  A coin operator $C_m$ that acts on the second register (the \"coin\" space $\\mathcal{H}_C$) and depends on the vertex in the first register. We define it as:\n    $$C_m = (I_N - |m\\rangle\\langle m|) \\otimes C_U + |m\\rangle\\langle m| \\otimes C_M$$\n    where $I_N$ is the identity on the vertex space $\\mathcal{H}_V$. For simplicity, we choose the unmarked coin to be the identity, $C_U = I_d$, and the marked coin to be a phase flip, $C_M = -I_d$.\n2.  A shift operator $S$ that is independent of the marked vertex $m$. It describes the fixed connectivity of the underlying graph by permuting the basis states: $S|v, j\\rangle = |\\text{neighbor}(v, j), f_{v,j}\\rangle$, where $\\text{neighbor}(v, j)$ is the vertex at the other end of the j-th edge from $v$, and $f_{v,j}$ is the label of that same edge from the perspective of the neighbor. As a permutation, $S$ is unitary.\n\nThe initial state of the algorithm, $|\\Psi_0\\rangle$, is the uniform superposition over all possible edges:\n$$|\\Psi_0\\rangle = \\frac{1}{\\sqrt{Nd}} \\sum_{v=1}^N \\sum_{j=1}^d |v, j\\rangle$$\n\nTo find the lower bound on the number of steps (queries) required, we analyze how much the state vector can change in a single step if the marked item is at location $m$ versus location $l$ (where $m \\neq l$). This one-step distinguishability is given by the norm $D = \\|(W_m - W_l)|\\Psi_0\\rangle\\|$.\n\nDerive the value of $D\\sqrt{N}$. Your final answer should be a single real number.", "solution": "To derive $D\\sqrt{N}$, recall that $D = \\|(W_m - W_l)|\\Psi_0\\rangle\\|$ and $W_k = S C_k$ for $k \\in \\{m, l\\}$. The shift operator $S$ is unitary, so:\n\n$$\n\\|(W_m - W_l)|\\Psi_0\\rangle\\| = \\|S(C_m - C_l)|\\Psi_0\\rangle\\| = \\|(C_m - C_l)|\\Psi_0\\rangle\\|,\n$$\n\nsince unitary operators preserve the norm. Thus, $D = \\|(C_m - C_l)|\\Psi_0\\rangle\\|$.\n\nThe coin operator $C_k$ is defined as:\n\n$$\nC_k = (I_N - |k\\rangle\\langle k|) \\otimes C_U + |k\\rangle\\langle k| \\otimes C_M,\n$$\n\nwith $C_U = I_d$ and $C_M = -I_d$. Substituting these values:\n\n$$\nC_k = (I_N - |k\\rangle\\langle k|) \\otimes I_d + |k\\rangle\\langle k| \\otimes (-I_d) = I_N \\otimes I_d - 2|k\\rangle\\langle k| \\otimes I_d.\n$$\n\nTherefore:\n\n$$\nC_m - C_l = \\left(I_N \\otimes I_d - 2|m\\rangle\\langle m| \\otimes I_d\\right) - \\left(I_N \\otimes I_d - 2|l\\rangle\\langle l| \\otimes I_d\\right) = 2\\left(|l\\rangle\\langle l| - |m\\rangle\\langle m|\\right) \\otimes I_d.\n$$\n\nThe initial state is:\n\n$$\n|\\Psi_0\\rangle = \\frac{1}{\\sqrt{Nd}} \\sum_{v=1}^N \\sum_{j=1}^d |v, j\\rangle.\n$$\n\nApplying $C_m - C_l$:\n\n$$\n(C_m - C_l)|\\Psi_0\\rangle = 2\\left(|l\\rangle\\langle l| - |m\\rangle\\langle m|\\right) \\otimes I_d \\cdot \\frac{1}{\\sqrt{Nd}} \\sum_{v=1}^N \\sum_{j=1}^d |v, j\\rangle.\n$$\n\nThe operator $\\left(|l\\rangle\\langle l| - |m\\rangle\\langle m|\\right) \\otimes I_d$ acts as:\n\n$$\n\\left(|l\\rangle\\langle l| \\otimes I_d\\right) |v, j\\rangle = \\delta_{v,l} |l, j\\rangle, \\quad \\left(|m\\rangle\\langle m| \\otimes I_d\\right) |v, j\\rangle = \\delta_{v,m} |m, j\\rangle.\n$$\n\nThus:\n\n$$\n\\left(|l\\rangle\\langle l| - |m\\rangle\\langle m|\\right) \\otimes I_d \\cdot |\\Psi_0\\rangle = \\frac{1}{\\sqrt{Nd}} \\left( \\sum_{j=1}^d |l, j\\rangle - \\sum_{j=1}^d |m, j\\rangle \\right).\n$$\n\nLet $|A\\rangle = \\sum_{j=1}^d |l, j\\rangle$ and $|B\\rangle = \\sum_{j=1}^d |m, j\\rangle$, so:\n\n$$\n(C_m - C_l)|\\Psi_0\\rangle = \\frac{2}{\\sqrt{Nd}} \\left(|A\\rangle - |B\\rangle\\right).\n$$\n\nThe norm is:\n\n$$\n\\|(C_m - C_l)|\\Psi_0\\rangle\\| = \\left\\| \\frac{2}{\\sqrt{Nd}} \\left(|A\\rangle - |B\\rangle\\right) \\right\\| = \\frac{2}{\\sqrt{Nd}} \\left\\| |A\\rangle - |B\\rangle \\right\\|.\n$$\n\nCompute $\\left\\| |A\\rangle - |B\\rangle \\right\\|^2$:\n\n$$\n\\left\\| |A\\rangle - |B\\rangle \\right\\|^2 = \\langle A - B | A - B \\rangle = \\langle A|A\\rangle + \\langle B|B\\rangle - \\langle A|B\\rangle - \\langle B|A\\rangle.\n$$\n\nSince $l \\neq m$, the states $|l, j\\rangle$ and $|m, k\\rangle$ are orthogonal for all $j, k$. Thus:\n\n$$\n\\langle A|B\\rangle = \\sum_{j=1}^d \\sum_{k=1}^d \\langle l,j|m,k\\rangle = 0, \\quad \\langle B|A\\rangle = 0.\n$$\n\nAlso:\n\n$$\n\\langle A|A\\rangle = \\sum_{j=1}^d \\sum_{k=1}^d \\langle l,j|l,k\\rangle = \\sum_{j=1}^d \\langle l,j|l,j\\rangle = d, \\quad \\langle B|B\\rangle = d,\n$$\n\nsince the basis is orthonormal. Therefore:\n\n$$\n\\left\\| |A\\rangle - |B\\rangle \\right\\|^2 = d + d - 0 - 0 = 2d, \\quad \\left\\| |A\\rangle - |B\\rangle \\right\\| = \\sqrt{2d}.\n$$\n\nSubstituting:\n\n$$\nD = \\|(C_m - C_l)|\\Psi_0\\rangle\\| = \\frac{2}{\\sqrt{Nd}} \\cdot \\sqrt{2d} = \\frac{2\\sqrt{2d}}{\\sqrt{Nd}} = \\frac{2\\sqrt{2}}{\\sqrt{N}}.\n$$\n\nFinally:\n\n$$\nD\\sqrt{N} = \\frac{2\\sqrt{2}}{\\sqrt{N}} \\cdot \\sqrt{N} = 2\\sqrt{2}.\n$$", "answer": "$$\\boxed{2\\sqrt{2}}$$", "id": "107573"}, {"introduction": "The polynomial method provides a powerful algebraic framework for understanding the limits of quantum algorithms. It leverages the fact that the success probability of a $T$-query algorithm can be described by a polynomial of degree at most $2T$ in the input parameters. This practice [@problem_id:107629] explores this connection by tasking you with finding the query lower bound for amplitude estimation, a core subroutine in many quantum algorithms. Using fundamental properties of polynomials, you will see how an algorithm's required precision imposes a minimum on its query complexity.", "problem": "A quantum algorithm is designed to estimate the squared overlap, $p = |\\langle s|w\\rangle|^2$, between a known initial state $|s\\rangle$ and an unknown quantum state $|w\\rangle$. The algorithm can prepare the state $|s\\rangle$ and has query access to a \"marking\" oracle $O_w = I - 2|w\\rangle\\langle w\\rangle$, which is a reflection about the hyperplane orthogonal to $|w\\rangle$. The algorithm makes $k$ queries to the oracle $O_w$, interspersed with unitary operations that are independent of $|w\\rangle$. After $k$ queries, a measurement is performed to produce an estimate $\\tilde{p}$ of $p$.\n\nThe algorithm must satisfy the following condition for any unknown state $|w\\rangle$: with a probability of success of at least $2/3$, the estimate $\\tilde{p}$ must be within a desired precision $\\epsilon$ of the true value $p$, i.e., $|\\tilde{p} - p| \\le \\epsilon$.\n\nIt is a known result from the analysis of quantum query algorithms that for any specific measurement outcome, its probability, denoted $f(p)$, can be expressed as a real polynomial in $p$ of degree at most $2k$.\n\nTo satisfy the specified success condition, the algorithm must be able to distinguish between the case where the overlap is $p$ and the case where it is $p+\\epsilon$. This implies that for any $p \\in [0, 1-\\epsilon]$, there must exist a binary measurement outcome whose probability $f(p)$ satisfies $|f(p) - f(p+\\epsilon)| \\ge c$, where $c$ is a constant related to the success probability. You may use $c=1/3$.\n\nUsing the polynomial method, find the query complexity for this estimation problem. You are given Bernstein's inequality for a polynomial $P(x)$ of degree $d$ on $[-1, 1]$:\n$$|P'(x)| \\le \\frac{d}{\\sqrt{1-x^2}} \\max_{z \\in [-1, 1]} |P(z)|$$\nDetermine the minimum number of queries $k$ required. Your answer for the lower bound on $k$ should be of the form $k \\ge C/\\epsilon$. Find the constant $C$.", "solution": "1. Let $F(p)$ be the probability of a measurement outcome. After $k$ queries, $F(p)$ is a polynomial in $p$ of degree at most $d \\le 2k$. The success condition implies that for any $p \\in [0, 1-\\epsilon]$, there is an outcome probability $F(p)$ that distinguishes $p$ from $p+\\epsilon$. This means $|F(p) - F(p+\\epsilon)| \\ge c$, where we use $c=1/3$.\n\n2. By the Mean-Value Theorem, for some $p' \\in (p, p+\\epsilon)$, we have $|F(p) - F(p+\\epsilon)| = \\epsilon |F'(p')|$. The condition implies $\\epsilon|F'(p')| \\ge c$.\n\n3. To relate this to the degree $d$, we use polynomial inequalities on the standard interval $[-1, 1]$. Let $x = 2p-1$, which maps $p \\in [0,1]$ to $x \\in [-1,1]$. Let $G(x) = F((x+1)/2)$. $G(x)$ is a polynomial of degree $d \\le 2k$. By the chain rule, $F'(p) = G'(x) \\cdot \\frac{dx}{dp} = 2G'(x)$. The condition on the derivative becomes $2|G'(x')| \\ge c/\\epsilon$ for some $x'$ corresponding to $p'$.\n\n4. We use Bernstein's inequality for the polynomial $G(x)$ on $[-1, 1]$: $|G'(x)| \\le \\frac{d}{\\sqrt{1-x^2}} \\max_{z \\in [-1, 1]} |G(z)|$. As $G(x)$ is a probability, $\\max|G(z)| \\le 1$, so $|G'(x)| \\le \\frac{d}{\\sqrt{1-x^2}}$.\n\n5. Our algorithm must work for any $p$. An adversary will choose the $p$ that is hardest for the algorithm, i.e., the one that requires the largest degree $d$. We have the condition $\\epsilon |F'(p')| \\ge c$, which we can rewrite using the bound on the derivative:\n$$\\epsilon \\cdot 2|G'(x')| \\ge c \\implies \\epsilon \\cdot 2 \\frac{d}{\\sqrt{1-(x')^2}} \\ge c$$\nThis inequality must be satisfiable by the algorithm's choice of $d$. Rearranging for $d$:\n$$d \\ge \\frac{c}{2\\epsilon} \\sqrt{1-(x')^2}$$\nTo find the minimum required degree $d$, the algorithm must be prepared for the worst-case $p'$, which is the one that maximizes the right-hand side. The term $\\sqrt{1-(x')^2}$ is maximized at $x'=0$ (corresponding to $p'=1/2$), where its value is 1. Therefore, the degree must satisfy:\n$$d \\ge \\frac{c}{2\\epsilon}$$\n\n6. Since the degree of the polynomial is at most $2k$, we have $d \\le 2k$.\n$$2k \\ge d \\ge \\frac{c}{2\\epsilon} \\implies k \\ge \\frac{c}{4\\epsilon}$$\n\n7. Plugging in $c=1/3$ yields the final lower bound on the number of queries:\n$$k \\ge \\frac{1/3}{4\\epsilon} = \\frac{1}{12\\epsilon}$$\nTherefore, the constant is $C=1/12$.", "answer": "$$\\boxed{\\frac{1}{12}}$$", "id": "107629"}, {"introduction": "The adversary method offers a general and robust recipe for deriving quantum query lower bounds by analyzing the \"confusability\" between different inputs an algorithm must distinguish. In this exercise [@problem_id:107574], you will first use the adversary method to derive the fundamental $\\Omega(\\sqrt{N})$ lower bound for the standard search problem. You will then see the true power of this technique by using the composition theorem to find the lower bound for a more complex, nested search problem, demonstrating the method's modularity and wide applicability.", "problem": "The general adversary method is a powerful technique for establishing lower bounds on the quantum query complexity of a function $F(x)$. The adversary bound is given by the expression:\n$$ADV(F) = \\max_{\\Gamma} \\frac{\\|\\Gamma\\|}{\\max_i \\|\\Gamma_i\\|}$$\nHere, $\\Gamma$ is a symmetric \"adversary\" matrix, indexed by pairs of inputs $(x, y)$ from the function's domain, with the constraint that $\\Gamma_{xy} = 0$ if $F(x) = F(y)$. The matrix $\\Gamma_i$ is derived from $\\Gamma$ by keeping only the entries corresponding to pairs of inputs $(x,y)$ that differ in the $i$-th coordinate (i.e., $x_i \\neq y_i$). The notation $\\|\\cdot\\|$ represents the spectral norm of a matrix.\n\nA key property of this method is the composition theorem. For a function of the form $F(z_1, \\dots, z_N) = f(g(z_1), \\dots, g(z_N))$, the adversary bound is at least the product of the bounds for the constituent functions: $ADV(F) \\ge ADV(f) \\cdot ADV(g)$.\n\n**Problem:**\nConsider a computational problem where we are given access to an oracle representing an $N \\times k$ matrix $A$. We are promised that exactly one row of this matrix contains duplicate elements (a collision), while the elements within any other row are all unique. An algorithm can make queries to the oracle to learn the values of entries $A_{ij}$. The goal is to determine the index $i_0$ of the row containing the collision.\n\nThis problem can be viewed as the composition of an outer \"unique search\" function $f_S$ acting on $N$ items, and an inner \"collision\" function $f_C$ acting on $k$ items. Your task is to calculate the adversary lower bound for this composite problem.\n\nTo do so, you must derive the bound for the unique search component, $f_S$. For this derivation, assume the inputs are the standard basis vectors $\\{e_1, \\dots, e_N\\}$ in $\\mathbb{R}^N$ and use the specific adversary matrix $\\Gamma$ defined by $\\Gamma_{xy} = 1$ for all distinct inputs $x, y$. For the inner collision component $f_C$, you may use the known result that its adversary bound is $ADV(f_C) = k^{1/3}$.", "solution": "The problem asks for the adversary lower bound of a composite function $F$, which is described as finding a unique row with a collision in an $N \\times k$ matrix. This can be modeled as $F(A) = f_S(f_C(A_1), \\dots, f_C(A_N))$, where $A_i$ is the $i$-th row of the matrix.\n\nAccording to the composition theorem for the adversary bound:\n$$ADV(F) \\ge ADV(f_S) \\cdot ADV(f_C)$$\n\nWe are given the adversary bound for the inner collision function $f_C$:\n$$ADV(f_C) = k^{1/3}$$\n\nOur main task is to derive the adversary bound $ADV(f_S)$ for the outer unique search function.\n\nThe function $f_S$ takes as input an $N$-bit string promised to contain exactly one '1'. These inputs can be represented by the set of standard basis vectors $X = \\{e_1, e_2, \\dots, e_N\\}$, where $e_i$ is a column vector with a 1 in the $i$-th position and 0s elsewhere. The function's output is the position of the '1': $f_S(e_i) = i$.\n\nThe adversary bound is $ADV(f_S) = \\frac{\\|\\Gamma\\|}{\\max_j \\|\\Gamma_j\\|}$. The problem specifies using the adversary matrix $\\Gamma$ defined by $\\Gamma_{xy} = 1$ for all distinct inputs $x, y \\in X$. Since $f_S(x) \\neq f_S(y)$ for any distinct $x, y \\in X$, this is a valid adversary matrix.\n\nLet's order the inputs as $e_1, \\dots, e_N$. The matrix $\\Gamma$ is an $N \\times N$ matrix with 0s on the diagonal and 1s elsewhere. This matrix can be written as $\\Gamma = J - I$, where $J$ is the $N \\times N$ all-ones matrix and $I$ is the identity matrix.\n\n**Step 1: Calculate the spectral norm of $\\Gamma$.**\nThe eigenvalues of $J$ are $N$ (with eigenvector $[1, \\dots, 1]^T$) and $0$ (with multiplicity $N-1$, spanning the space orthogonal to $[1, \\dots, 1]^T$). The eigenvalues of $I$ are all 1. Since $J$ and $I$ commute, the eigenvalues of $\\Gamma = J - I$ are the differences of their eigenvalues.\nThe eigenvalue of $\\Gamma$ corresponding to the eigenvector $[1, \\dots, 1]^T$ is $N - 1$. The other $N-1$ eigenvalues are $0 - 1 = -1$.\nThe spectral norm $\\|\\Gamma\\|$ is the largest singular value, which for a symmetric matrix is the maximum absolute value of its eigenvalues.\n$$\\|\\Gamma\\| = \\max(|N-1|, |-1|) = N-1 \\quad (\\text{for } N \\ge 2)$$\n\n**Step 2: Calculate the spectral norm of $\\Gamma_j$.**\nThe matrix $\\Gamma_j$ has entries $(\\Gamma_j)_{xy} = \\Gamma_{xy}$ if $x_j \\neq y_j$, and 0 otherwise. Let the inputs be $x = e_a$ and $y = e_b$. The condition $x_j \\neq y_j$ translates to $(e_a)_j \\neq (e_b)_j$, which is $\\delta_{aj} \\neq \\delta_{bj}$. This inequality holds if and only if one of the indices $a$ or $b$ is equal to $j$, and the other is not.\n\nSo, the non-zero entries of the matrix $\\Gamma_j$ are those where one index corresponds to $e_j$ and the other to $e_b$ with $b \\neq j$. As $\\Gamma_{e_j, e_b} = 1$ for $b \\neq j$, the matrix $\\Gamma_j$ has entries:\n$$ (\\Gamma_j)_{ab} = \\begin{cases} 1 & \\text{if } a=j \\text{ and } b \\neq j \\\\ 1 & \\text{if } b=j \\text{ and } a \\neq j \\\\ 0 & \\text{otherwise} \\end{cases} $$\nThis is the adjacency matrix of a star graph on $N$ vertices, with the vertex corresponding to input $e_j$ being the center.\n\nThe characteristic polynomial of the adjacency matrix of a star graph on $N$ vertices is $P(\\lambda) = \\lambda^{N-2}(\\lambda^2 - (N-1))$. The eigenvalues are $\\lambda = 0$ (with multiplicity $N-2$) and $\\lambda = \\pm\\sqrt{N-1}$.\nThe spectral norm of $\\Gamma_j$ is the maximum absolute value of its eigenvalues:\n$$\\|\\Gamma_j\\| = \\sqrt{N-1}$$\nThis norm is the same for all query indices $j=1, \\dots, N$. Thus, $\\max_j \\|\\Gamma_j\\| = \\sqrt{N-1}$.\n\n**Step 3: Calculate $ADV(f_S)$.**\nWe can now compute the adversary bound for the unique search function:\n$$ADV(f_S) = \\frac{\\|\\Gamma\\|}{\\max_j \\|\\Gamma_j\\|} = \\frac{N-1}{\\sqrt{N-1}} = \\sqrt{N-1}$$\n\n**Step 4: Combine the bounds.**\nUsing the composition theorem, we find the lower bound for the composite problem:\n$$ADV(F) \\ge ADV(f_S) \\cdot ADV(f_C) = \\sqrt{N-1} \\cdot k^{1/3}$$\n\nThis is the adversary lower bound for finding the unique row with a collision.", "answer": "$$ \\boxed{k^{1/3}\\sqrt{N-1}} $$", "id": "107574"}]}