{"hands_on_practices": [{"introduction": "The most fundamental and experimentally accessible feature of Bloch oscillations is their frequency. This practice explores the direct relationship between the applied external force and the oscillation frequency. By analyzing a hypothetical experiment, you will derive this key proportionality, which forms the basis for applications like tunable terahertz radiation sources. [@problem_id:1762312]", "problem": "An experimental physicist is investigating the properties of a custom-engineered one-dimensional semiconductor superlattice, which can be modeled as a 1D crystal with an effective lattice constant $a$. The goal of the experiment is to generate tunable Terahertz (THz) radiation by inducing Bloch oscillations in the conduction band electrons. The frequency of the emitted radiation is equal to the frequency of the Bloch oscillations, $f_B$.\n\nIn the first stage of the experiment, a constant DC electric field of magnitude $E_0$ is applied across the superlattice. A detector measures the emitted electromagnetic radiation and finds a sharp emission peak at a frequency of $f_0 = 1.25 \\text{ THz}$.\n\nIn the second stage, to tune the output, the physicist adjusts the applied electric field to a new constant magnitude, $E_1$. The detector now measures a new emission peak at a frequency of $f_1 = 4.375 \\text{ THz}$.\n\nAssuming the semiclassical model of electron dynamics in a periodic potential is valid, determine the ratio of the final electric field strength to the initial electric field strength, $\\frac{E_1}{E_0}$.", "solution": "In the semiclassical dynamics of an electron in a periodic potential under a uniform electric field, the crystal momentum obeys $\\hbar \\dot{k} = -q_{e} E$, where $q_{e}$ is the electron charge. Because the Bloch wavevector is defined modulo a reciprocal lattice vector of magnitude $2\\pi/a$, a complete traversal of the Brillouin zone corresponds to a change $\\Delta k = 2\\pi/a$. Over one Bloch period $T_{B}$, using the magnitude of the charge, this gives\n$$\n\\left|\\dot{k}\\right| T_{B}=\\frac{2\\pi}{a}\n\\quad\\Rightarrow\\quad\n\\frac{|q_{e}| E}{\\hbar} T_{B}=\\frac{2\\pi}{a}\n\\quad\\Rightarrow\\quad\nT_{B}=\\frac{2\\pi \\hbar}{|q_{e}| E a}=\\frac{h}{|q_{e}| E a}.\n$$\nHence the Bloch frequency is\n$$\nf_{B}=\\frac{1}{T_{B}}=\\frac{|q_{e}| E a}{h}.\n$$\nFor fixed lattice constant $a$ and constants $|q_{e}|$ and $h$, the Bloch frequency is proportional to the electric field, so\n$$\n\\frac{E_{1}}{E_{0}}=\\frac{f_{1}}{f_{0}}.\n$$\nWith the measured values $f_{0}=1.25\\,\\text{THz}$ and $f_{1}=4.375\\,\\text{THz}$, the ratio is\n$$\n\\frac{E_{1}}{E_{0}}=\\frac{f_{1}}{f_{0}}=\\frac{4.375}{1.25}=\\frac{\\frac{35}{8}}{\\frac{5}{4}}=\\frac{35}{8}\\cdot\\frac{4}{5}=\\frac{35}{10}=\\frac{7}{2}.\n$$", "answer": "$$\\boxed{\\frac{7}{2}}$$", "id": "1762312"}, {"introduction": "While the frequency of Bloch oscillations is determined by the external field, their spatial extent is intimately linked to the material's intrinsic properties, specifically its energy band structure. This exercise challenges you to connect the abstract concept of an energy band's width, characterized by the hopping integral $\\gamma$, to the real-space amplitude of the oscillation. You will discover how a \"flatter\" or \"steeper\" band dramatically changes the particle's trajectory, providing crucial intuition for designing quantum devices. [@problem_id:1762299]", "problem": "Consider two different one-dimensional crystalline materials, Material A and Material B, each with the same lattice constant $a$. The energy dispersion relation for an electron in the lowest conduction band of each material can be approximated by a single-band tight-binding model:\n$$E(k) = E_C - 2\\gamma \\cos(ka)$$\nwhere $k$ is the crystal wavevector, $E_C$ is a constant energy offset, and $\\gamma$ is the nearest-neighbor hopping integral, which is directly related to the bandwidth of the energy band.\n\nMaterial A is characterized by a hopping integral $\\gamma_A = 0.45 \\, \\text{eV}$.\nMaterial B is characterized by a hopping integral $\\gamma_B = 1.65 \\, \\text{eV}$.\n\nA weak, uniform, static electric field with magnitude $\\mathcal{E}$ is applied along the length of each material. In both cases, an electron is initially at rest at the bottom of the conduction band (i.e., at $k=0$ with zero group velocity). The applied electric field causes the electron to undergo Bloch oscillations. Let $\\Delta x_A$ and $\\Delta x_B$ be the spatial amplitudes (maximum displacement from the center of oscillation) of the Bloch oscillations for the electron in Material A and Material B, respectively.\n\nCalculate the ratio $\\frac{\\Delta x_B}{\\Delta x_A}$. Provide your answer as a number rounded to three significant figures.", "solution": "The analysis begins with the semiclassical equations of motion for an electron in a one-dimensional crystal subjected to a uniform electric field $\\mathcal{E}$. The crystal momentum $\\hbar k$ changes according to the external force:\n$$\n\\hbar \\frac{dk}{dt} = -e\\mathcal{E}\n$$\nwhere $e$ is the elementary charge. The group velocity $v_g$ of the electron is determined by the energy band structure $E(k)$:\n$$\nv_g(k) = \\frac{1}{\\hbar} \\frac{dE}{dk}\n$$\nFirst, we solve for the time-evolution of the wavevector $k$. Integrating the first equation with the initial condition that the electron starts at $k=0$ at time $t=0$:\n$$\n\\int_0^{k(t)} \\hbar \\, dk' = \\int_0^t -e\\mathcal{E} \\, dt'\n$$\n$$\n\\hbar k(t) = -e\\mathcal{E}t\n$$\n$$\nk(t) = -\\frac{e\\mathcal{E}}{\\hbar}t\n$$\nThis shows that the wavevector evolves linearly in time.\n\nNext, we determine the group velocity using the given tight-binding energy dispersion relation, $E(k) = E_C - 2\\gamma \\cos(ka)$:\n$$\nv_g(k) = \\frac{1}{\\hbar} \\frac{d}{dk} \\left( E_C - 2\\gamma \\cos(ka) \\right)\n$$\n$$\nv_g(k) = \\frac{1}{\\hbar} \\left( -2\\gamma \\cdot [-\\sin(ka) \\cdot a] \\right) = \\frac{2\\gamma a}{\\hbar} \\sin(ka)\n$$\nThe initial condition that the electron is at rest at $k=0$ is satisfied, as $v_g(0) = \\frac{2\\gamma a}{\\hbar}\\sin(0) = 0$.\n\nThe position of the electron, $x(t)$, is found by integrating its group velocity from $t=0$. Let its initial position be $x(0)$.\n$$\nx(t) = x(0) + \\int_0^t v_g(k(t')) dt'\n$$\nSubstitute the expressions for $v_g(k)$ and $k(t')$ into the integral:\n$$\nx(t) = x(0) + \\int_0^t \\frac{2\\gamma a}{\\hbar} \\sin\\left(k(t') a\\right) dt'\n$$\n$$\nx(t) = x(0) + \\int_0^t \\frac{2\\gamma a}{\\hbar} \\sin\\left( -\\frac{e\\mathcal{E}a}{\\hbar}t' \\right) dt'\n$$\nUsing the identity $\\sin(-z) = -\\sin(z)$, we get:\n$$\nx(t) = x(0) - \\frac{2\\gamma a}{\\hbar} \\int_0^t \\sin\\left( \\frac{e\\mathcal{E}a}{\\hbar}t' \\right) dt'\n$$\nThe term $\\frac{e\\mathcal{E}a}{\\hbar}$ is the angular frequency of the Bloch oscillations, denoted as $\\omega_B$. The integral becomes:\n$$\n\\int_0^t \\sin(\\omega_B t') dt' = \\left[ -\\frac{1}{\\omega_B}\\cos(\\omega_B t') \\right]_0^t = -\\frac{1}{\\omega_B}(\\cos(\\omega_B t) - \\cos(0)) = \\frac{1 - \\cos(\\omega_B t)}{\\omega_B}\n$$\nSubstituting this result back into the expression for $x(t)$:\n$$\nx(t) = x(0) - \\frac{2\\gamma a}{\\hbar} \\left( \\frac{1 - \\cos(\\omega_B t)}{\\omega_B} \\right)\n$$\n$$\nx(t) = \\left( x(0) - \\frac{2\\gamma a}{\\hbar \\omega_B} \\right) + \\frac{2\\gamma a}{\\hbar \\omega_B} \\cos(\\omega_B t)\n$$\nThis equation describes a simple harmonic motion. The term in front of the cosine function is the amplitude of the oscillation. Let's call it $\\Delta x$:\n$$\n\\Delta x = \\frac{2\\gamma a}{\\hbar \\omega_B}\n$$\nNow, we substitute the definition of $\\omega_B = \\frac{e\\mathcal{E}a}{\\hbar}$:\n$$\n\\Delta x = \\frac{2\\gamma a}{\\hbar \\left(\\frac{e\\mathcal{E}a}{\\hbar}\\right)} = \\frac{2\\gamma}{e\\mathcal{E}}\n$$\nThis important result shows that the spatial amplitude of Bloch oscillations is directly proportional to the hopping integral $\\gamma$ and inversely proportional to the electric field magnitude $\\mathcal{E}$, while being independent of the lattice constant $a$.\n\nWe need to compute the ratio $\\frac{\\Delta x_B}{\\Delta x_A}$. Using the derived expression for the amplitude for each material:\n$$\n\\Delta x_A = \\frac{2\\gamma_A}{e\\mathcal{E}}\n$$\n$$\n\\Delta x_B = \\frac{2\\gamma_B}{e\\mathcal{E}}\n$$\nSince the electric field $\\mathcal{E}$ and the charge $e$ are the same for both scenarios, the ratio simplifies to:\n$$\n\\frac{\\Delta x_B}{\\Delta x_A} = \\frac{\\frac{2\\gamma_B}{e\\mathcal{E}}}{\\frac{2\\gamma_A}{e\\mathcal{E}}} = \\frac{\\gamma_B}{\\gamma_A}\n$$\nFinally, we substitute the given numerical values for the hopping integrals:\n$$\n\\gamma_A = 0.45 \\, \\text{eV}\n$$\n$$\n\\gamma_B = 1.65 \\, \\text{eV}\n$$\n$$\n\\frac{\\Delta x_B}{\\Delta x_A} = \\frac{1.65}{0.45} = 3.6666...\n$$\nRounding the result to three significant figures, we get 3.67.", "answer": "$$\\boxed{3.67}$$", "id": "1762299"}, {"introduction": "The semiclassical equations of motion provide a powerful and intuitive model for Bloch oscillations, but they are ultimately an approximation. This advanced computational practice invites you to test the limits of this model by comparing it directly against a full quantum-mechanical simulation on a finite lattice. By solving the time-dependent Schrödinger equation for a wave packet, you will gain a deeper appreciation for the conditions under which the semiclassical picture is valid and identify the quantum effects that emerge beyond its scope. [@problem_id:2972562]", "problem": "Consider a one-dimensional nearest-neighbor tight-binding chain with open boundary conditions, subject to a spatially uniform, static electric field. Work in natural units where the reduced Planck constant is set to $1$, the lattice constant is set to $1$, and the elementary charge is set to $1$. All quantities are therefore dimensionless. The single-particle Hamiltonian on a chain of $N$ sites is\n$$\n\\hat{H} = -J \\sum_{n=0}^{N-2} \\left( \\lvert n \\rangle \\langle n+1 \\rvert + \\lvert n+1 \\rangle \\langle n \\rvert \\right) + F \\sum_{n=0}^{N-1} n \\lvert n \\rangle \\langle n \\rvert,\n$$\nwhere $J>0$ is the hopping amplitude, $F>0$ is the electric field magnitude, and $\\lvert n \\rangle$ denotes the Wannier state localized on site $n$. The time-dependent Schrödinger equation is\n$$\ni \\frac{d}{dt} \\lvert \\psi(t) \\rangle = \\hat{H} \\lvert \\psi(t) \\rangle.\n$$\nYou will compare the full quantum dynamics to the semiclassical dynamics of a wave packet.\n\nInitial state. The initial wave function is a Gaussian wave packet centered at site $n_0$ with quasimomentum $k_0$,\n$$\n\\psi_n(0) = \\mathcal{N} \\exp\\!\\left( -\\frac{(n-n_0)^2}{2 \\sigma^2} \\right) e^{i k_0 n},\n$$\nwhere $\\sigma$ is the real-space standard deviation, and $\\mathcal{N}$ is the normalization chosen so that $\\sum_{n=0}^{N-1} \\lvert \\psi_n(0) \\rvert^2 = 1$. The quantum expectation value of position at time $t$ is\n$$\nx_{\\mathrm{qm}}(t) = \\sum_{n=0}^{N-1} n \\, \\lvert \\psi_n(t) \\rvert^2.\n$$\n\nSemiclassical description. In the single-band semiclassical limit of a narrow wave packet in quasimomentum, use the following well-tested foundational relations as your starting point:\n- The energy dispersion for the nearest-neighbor tight-binding band is $\\varepsilon(k) = -2J \\cos k$.\n- The group velocity is $v(k) = \\frac{1}{\\hbar} \\frac{d \\varepsilon}{d k}$, which reduces in these units to $v(k) = \\frac{d \\varepsilon}{d k}$.\n- The acceleration theorem is $\\hbar \\, \\frac{d k}{d t} = -F$, which in these units reduces to $\\frac{d k}{d t} = -F$.\n\nTreat the wave packet as characterized by a single quasimomentum $k_0$ initially, and integrate the semiclassical equations of motion to obtain the semiclassical position $x_{\\mathrm{sc}}(t)$, with the initial condition $x_{\\mathrm{sc}}(0) = x_{\\mathrm{qm}}(0)$. Do not assume any final formulas; derive and implement what you need directly from these principles.\n\nComparison metric. For a given parameter set and a time interval $[0,T]$ with a uniform grid of $M$ sample times, define the root-mean-square deviation between the quantum and semiclassical positions as\n$$\n\\Delta = \\sqrt{ \\frac{1}{M} \\sum_{m=1}^{M} \\left( x_{\\mathrm{qm}}(t_m) - x_{\\mathrm{sc}}(t_m) \\right)^2 }.\n$$\nReport $\\Delta$ as a dimensionless float in lattice-site units. Round each reported value to $6$ decimal places.\n\nImplementation requirements.\n- Solve the full quantum dynamics exactly for the finite chain by diagonalizing $\\hat{H}$ and using unitary time evolution to obtain $\\lvert \\psi(t) \\rangle$ at the required times.\n- Implement the semiclassical evolution using the principles listed above.\n- Use open boundary conditions. Choose the center $n_0$ near the middle of the chain. No artificial absorbing boundaries or windowing are allowed.\n\nAngle unit. The quasimomentum $k_0$ must be specified and treated in radians.\n\nTime grid. For each case below, use a uniform grid of $M$ times $t_m = m \\, T / M$ for $m = 1, 2, \\dots, M$.\n\nTest suite. Use the following four parameter sets that probe the convergence to semiclassics and its breakdown:\n- Case $1$ (broad wave packet, weak field): $N=201$, $J=1.0$, $F=0.05$, $k_0=0.7$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$.\n- Case $2$ (narrow wave packet, same weak field): $N=201$, $J=1.0$, $F=0.05$, $k_0=0.7$, $\\sigma=3.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$.\n- Case $3$ (broad wave packet, stronger field): $N=201$, $J=1.0$, $F=0.3$, $k_0=0.7$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$.\n- Case $4$ (boundary-limited motion): $N=121$, $J=1.0$, $F=0.02$, $k_0=0.0$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$.\n\nOutput format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases $1$ through $4$. For example, the output must look like\n$$\n[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4],\n$$\nwith each $\\Delta_i$ rounded to $6$ decimal places. The output is dimensionless and must be interpreted in lattice-site units.", "solution": "The problem requires a detailed comparison between the full quantum-mechanical evolution of a wave packet in a one-dimensional tight-binding chain and its corresponding semiclassical trajectory. This is a classic problem in solid-state physics for studying Bloch oscillations and the quantum-to-classical correspondence. I will first derive the necessary formulas for both descriptions and then outline the numerical implementation.\n\n### Quantum-Mechanical Dynamics\n\nThe system is a finite chain of $N$ discrete sites, indexed by the integer $n=0, 1, \\dots, N-1$. The state of a particle on this chain is described by a state vector $|\\psi(t)\\rangle = \\sum_{n=0}^{N-1} \\psi_n(t) |n\\rangle$, where $\\psi_n(t)$ is the complex amplitude for the particle to be at site $n$ at time $t$. The dynamics are governed by the time-dependent Schrödinger equation, $i \\frac{d}{dt} |\\psi(t)\\rangle = \\hat{H} |\\psi(t)\\rangle$, with units where $\\hbar=1$.\n\nThe Hamiltonian $\\hat{H}$ is given by:\n$$\n\\hat{H} = -J \\sum_{n=0}^{N-2} \\left( |n\\rangle\\langle n+1| + |n+1\\rangle\\langle n| \\right) + F \\sum_{n=0}^{N-1} n |n\\rangle\\langle n|\n$$\nThe first term describes hopping between adjacent sites with amplitude $J$, and the second term represents a linear potential due to a static electric field of magnitude $F$. This potential gives rise to the Wannier-Stark ladder.\n\nThis operator can be represented as an $N \\times N$ real symmetric (and thus Hermitian) matrix $H$ in the site basis $\\{|n\\rangle\\}$. The matrix elements are:\n$$\nH_{ij} = \\langle i | \\hat{H} | j \\rangle = \\begin{cases}\n    F \\cdot i & \\text{if } i=j \\\\\n    -J & \\text{if } |i-j|=1 \\\\\n    0 & \\text{otherwise}\n\\end{cases}\n$$\nSince the Hamiltonian is time-independent, the formal solution to the Schrödinger equation is $|\\psi(t)\\rangle = e^{-iHt} |\\psi(0)\\rangle$, where $|\\psi(0)\\rangle$ is the initial state. A numerically exact solution can be obtained by diagonalizing the Hamiltonian matrix $H$. Let the eigenvalues be $E_j$ and the corresponding eigenvectors be $|\\phi_j\\rangle$, satisfying $H|\\phi_j\\rangle = E_j|\\phi_j\\rangle$. The time evolution operator can be expressed in this eigenbasis as $e^{-iHt} = \\sum_j e^{-iE_j t} |\\phi_j\\rangle\\langle\\phi_j|$.\n\nThe state at time $t$ is then:\n$$\n|\\psi(t)\\rangle = \\left(\\sum_j e^{-iE_j t} |\\phi_j\\rangle\\langle\\phi_j|\\right) |\\psi(0)\\rangle = \\sum_j c_j e^{-iE_j t} |\\phi_j\\rangle\n$$\nwhere $c_j = \\langle\\phi_j|\\psi(0)\\rangle$ are the coefficients of the initial state projected onto the eigenbasis.\n\nThe initial state is a Gaussian wave packet:\n$$\n\\psi_n(0) = \\langle n | \\psi(0) \\rangle = \\mathcal{N} \\exp\\left( -\\frac{(n-n_0)^2}{2\\sigma^2} \\right) e^{ik_0n}\n$$\nThe normalization constant $\\mathcal{N}$ is chosen such that $\\sum_{n=0}^{N-1} |\\psi_n(0)|^2 = 1$, which gives $\\mathcal{N} = 1 / \\sqrt{\\sum_{n=0}^{N-1} \\exp\\left(-\\frac{(n-n_0)^2}{\\sigma^2}\\right)}$.\n\nThe quantum expectation value of the position at time $t$ is calculated by:\n$$\nx_{\\mathrm{qm}}(t) = \\langle\\psi(t)|\\hat{x}|\\psi(t)\\rangle = \\sum_{n=0}^{N-1} n |\\psi_n(t)|^2\n$$\n\n### Semiclassical Dynamics\n\nThe semiclassical model treats the wave packet as a point-like particle whose dynamics are governed by the band structure $\\varepsilon(k)$ and the acceleration theorem.\nThe provided principles are:\n1.  Energy dispersion: $\\varepsilon(k) = -2J \\cos(k)$.\n2.  Group velocity: $v(k) = \\frac{d\\varepsilon}{dk} = 2J \\sin(k)$.\n3.  Acceleration: $\\frac{dk}{dt} = -F$.\n\nIntegrating the acceleration equation with the initial condition $k(0) = k_0$ gives the time-dependent quasimomentum:\n$$\nk(t) = k_0 - Ft\n$$\nThe semiclassical position $x_{\\mathrm{sc}}(t)$ is found by integrating the group velocity, $\\frac{dx_{\\mathrm{sc}}}{dt} = v(k(t))$:\n$$\n\\frac{dx_{\\mathrm{sc}}}{dt} = 2J \\sin(k_0 - Ft)\n$$\nIntegrating this from $t=0$ to $t$ yields the change in position:\n$$\nx_{\\mathrm{sc}}(t) - x_{\\mathrm{sc}}(0) = \\int_0^t 2J \\sin(k_0 - Ft') dt' = 2J \\left[ \\frac{\\cos(k_0 - Ft')}{F} \\right]_0^t\n$$\n$$\nx_{\\mathrm{sc}}(t) = x_{\\mathrm{sc}}(0) + \\frac{2J}{F} \\left( \\cos(k_0 - Ft) - \\cos(k_0) \\right)\n$$\nThe initial semiclassical position $x_{\\mathrm{sc}}(0)$ is set equal to the initial quantum expectation value, $x_{\\mathrm{sc}}(0) = x_{\\mathrm{qm}}(0) = \\sum_{n=0}^{N-1} n |\\psi_n(0)|^2$.\n\n### Numerical Implementation and Comparison\n\nThe algorithm proceeds as follows for each test case:\n1.  **Set up**: Define all parameters ($N, J, F, k_0, \\sigma, n_0, T, M$) and construct the uniform time grid $t_m = m T/M$ for $m=1, \\dots, M$.\n2.  **Initial State**: Construct the discrete initial wave function $\\psi_n(0)$ and normalize it.\n3.  **Quantum Dynamics**:\n    a. Construct the $N \\times N$ Hamiltonian matrix $H$.\n    b. Numerically diagonalize $H$ using a standard eigensolver for Hermitian matrices (e.g., `numpy.linalg.eigh`) to obtain the eigenvalues $\\{E_j\\}$ and the unitary matrix of eigenvectors $U$ (whose columns are $|\\phi_j\\rangle$).\n    c. Project the initial state into the eigenbasis: $|\\psi(0)\\rangle_{\\mathrm{eig}} = U^\\dagger |\\psi(0)\\rangle$.\n    d. For each time $t_m$ in the grid, compute the evolved state by applying the phase factors $e^{-iE_j t_m}$ to the components of $|\\psi(0)\\rangle_{\\mathrm{eig}}$ and transforming back to the site basis: $|\\psi(t_m)\\rangle = U (e^{-iE t_m} |\\psi(0)\\rangle_{\\mathrm{eig}})$. This is implemented efficiently using vectorized operations for all times at once.\n    e. Compute the array of quantum positions $x_{\\mathrm{qm}}(t_m)$.\n4.  **Semiclassical Dynamics**:\n    a. Compute the initial position $x_{\\mathrm{qm}}(0)$ and set $x_{\\mathrm{sc}}(0)$ to this value.\n    b. Use the derived analytical formula to compute the array of semiclassical positions $x_{\\mathrm{sc}}(t_m)$.\n5.  **Deviation**: Calculate the root-mean-square deviation $\\Delta$ using the computed arrays $x_{\\mathrm{qm}}(t_m)$ and $x_{\\mathrm{sc}}(t_m)$ over the time grid.\n6.  **Output**: The final $\\Delta$ value is rounded to $6$ decimal places and stored. The results for all cases are then formatted into the required output string.\n\nThis procedure provides a rigorous and numerically exact (within machine precision) evaluation of the quantum dynamics on the finite chain, allowing for a precise comparison with the idealized semiclassical model.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the root-mean-square deviation between quantum and semiclassical\n    dynamics for four specified test cases.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # (N, J, F, k0, sigma, M)\n    # n0 and T are derived from these.\n    test_cases_params = [\n        (201, 1.0, 0.05, 0.7, 12.0, 256),\n        (201, 1.0, 0.05, 0.7, 3.0, 256),\n        (201, 1.0, 0.3, 0.7, 12.0, 256),\n        (121, 1.0, 0.02, 0.0, 12.0, 256),\n    ]\n\n    results = []\n\n    for N, J, F, k0, sigma, M in test_cases_params:\n        # Derived parameters\n        n0 = N // 2\n        T = 2 * np.pi / F\n        \n        # 1. Time grid\n        # The sum for Delta is from m=1 to M, so we start at t=T/M.\n        times = np.linspace(T / M, T, M)\n        \n        # 2. Site indices\n        sites = np.arange(N)\n        \n        # 3. Initial State Preparation\n        psi_unnormalized = np.exp(-(sites - n0)**2 / (2 * sigma**2)) * np.exp(1j * k0 * sites)\n        norm = np.linalg.norm(psi_unnormalized)\n        psi_0 = psi_unnormalized / norm\n\n        # 4. Quantum Dynamics Calculation\n        # a. Construct Hamiltonian\n        H_diag = F * sites\n        H_offdiag = -J * np.ones(N - 1)\n        H = np.diag(H_diag) + np.diag(H_offdiag, k=1) + np.diag(H_offdiag, k=-1)\n        \n        # b. Eigendecomposition of the Hermitian Hamiltonian\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # c. Project initial state onto the eigenbasis\n        # For a real symmetric matrix H, eigenvectors are real, so U.T.conj()=U.T\n        psi_0_eigenbasis = eigenvectors.T @ psi_0\n        \n        # d. Evolve state in time (vectorized for all time steps)\n        # Outer product creates an (N, M) matrix of phases e^{-i*E_j*t_m}\n        time_evolution_factors = np.exp(np.outer(-1j * eigenvalues, times))\n        # Multiply each eigen-coefficient with its time evolution factor\n        psi_t_eigenbasis = psi_0_eigenbasis[:, np.newaxis] * time_evolution_factors\n        # Transform back to the site basis\n        psi_t = eigenvectors @ psi_t_eigenbasis  # Shape (N, M)\n        \n        # e. Calculate quantum expectation value of position\n        x_qm = np.sum(sites[:, np.newaxis] * np.abs(psi_t)**2, axis=0) # Shape (M,)\n\n        # 5. Semiclassical Dynamics Calculation\n        # a. Initial position\n        x_qm_0 = np.sum(sites * np.abs(psi_0)**2)\n        x_sc_0 = x_qm_0\n\n        # b. Semiclassical trajectory for all time steps\n        x_sc = x_sc_0 + (2 * J / F) * (np.cos(k0 - F * times) - np.cos(k0))\n        \n        # 6. Comparison Metric\n        deviation = np.sqrt(np.mean((x_qm - x_sc)**2))\n        results.append(deviation)\n\n    # 7. Final output formatting\n    # Round to 6 decimal places and format to ensure trailing zeros.\n    formatted_results = [f'{round(r, 6):.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2972562"}]}