{"hands_on_practices": [{"introduction": "The journey of a qubit from a source to a measurement station is rarely perfect. This first exercise explores one of the most fundamental sources of error: noise in the quantum channel. By analyzing how a simple bit-flip error on a single qubit affects the entanglement swapping process [@problem_id:669300], you will calculate the final state fidelity and gain a crucial understanding of how transmission losses directly impact the quality of the entanglement shared between distant parties.", "problem": "### Problem: Fidelity of Entanglement Swapping with a Bit-Flip Channel\n\nAn entanglement swapping protocol is designed to entangle two qubits that have never directly interacted. Consider two sources, A and B. Source A produces a pair of qubits (1, 2) in the Bell state $|\\Phi^+\\rangle_{12}$, and Source B produces a pair of qubits (3, 4) in the Bell state $|\\Phi^+\\rangle_{34}$. The state $|\\Phi^+\\rangle$ is defined as $\\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$.\n\nQubits 1 and 4 are delivered to two distant parties, Alice and Bob, respectively. Qubits 2 and 3 are sent to a central station, Charlie.\n\nThe standard, noiseless protocol is as follows:\n1.  The initial state of the four-qubit system is $|\\Psi\\rangle_{1234} = |\\Phi^+\\rangle_{12} \\otimes |\\Phi^+\\rangle_{34}$.\n2.  Charlie performs a Bell State Measurement (BSM) on the qubit pair (2, 3), projecting it onto one of the four Bell states:\n    -   $|\\Phi^\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle \\pm |11\\rangle)$\n    -   $|\\Psi^\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle \\pm |10\\rangle)$\n3.  Charlie communicates his measurement outcome to Alice via a classical channel.\n4.  Based on Charlie's message, Alice applies a local unitary correction to her qubit (qubit 1). The corrections are chosen to transform the resulting state of the pair (1, 4) into the target state $|\\Phi^+\\rangle_{14}$. The standard correction map is:\n    -   If outcome is $|\\Phi^+\\rangle_{23}$, Alice applies $I_1$ (identity).\n    -   If outcome is $|\\Phi^-\\rangle_{23}$, Alice applies $Z_1$ (Pauli-Z).\n    -   If outcome is $|\\Psi^+\\rangle_{23}$, Alice applies $X_1$ (Pauli-X).\n    -   If outcome is $|\\Psi^-\\rangle_{23}$, Alice applies $iY_1$ (where $Y_1 = -iXZ$).\n\nNow, consider a modification to this protocol. Before the BSM is performed by Charlie, qubit 3 passes through a single-qubit bit-flip channel. This channel is described by the quantum operation $\\mathcal{E}_3$, which acts on an arbitrary state $\\rho$ of qubit 3 as:\n$$\n\\mathcal{E}_3(\\rho) = (1-p)\\rho + p X_3 \\rho X_3\n$$\nwhere $X_3$ is the Pauli-X operator on qubit 3, and $p$ is the probability of a bit flip.\n\nDerive the fidelity, $F$, of the final state of the qubit pair (1, 4), $\\rho_{14}^{\\text{final}}$, with the ideal target Bell state $|\\Phi^+\\rangle_{14}$. The final state $\\rho_{14}^{\\text{final}}$ is the state after Charlie's BSM and Alice's corresponding correction have been performed. You will find that the fidelity is independent of Charlie's specific measurement outcome. Express your answer in terms of the bit-flip probability $p$.\n\nThe fidelity $F$ is defined as $F = \\langle\\Phi^+_{14}|\\rho_{14}^{\\text{final}}|\\Phi^+_{14}\\rangle$.", "solution": "1.  **Initial State and Channel Action**: The total initial state is $|\\Psi\\rangle_{1234} = |\\Phi^+\\rangle_{12} \\otimes |\\Phi^+\\rangle_{34}$. The bit-flip channel acts on qubit 3. With probability $1-p$, the state remains unchanged. With probability $p$, the state becomes $|\\Psi_{\\text{flip}}\\rangle = (I_{12} \\otimes X_3 \\otimes I_4)|\\Psi\\rangle_{1234} = |\\Phi^+\\rangle_{12} \\otimes |\\Psi^+\\rangle_{34}$, because the Pauli-$X$ operator transforms $|\\Phi^+\\rangle_{34}$ to $|\\Psi^+\\rangle_{34}$.\n\n2.  **Analysis of the Ideal Component (Probability $1-p$)**: If no bit-flip occurs, the standard entanglement swapping protocol is executed. After Charlie's BSM on qubits (2,3) and Alice's corresponding correction on qubit 1, the final state of qubits (1,4) is deterministically the target state $|\\Phi^+\\rangle_{14}$. The fidelity for this outcome is 1.\n\n3.  **Analysis of the Flipped Component (Probability $p$)**: If a bit-flip occurs, the initial state for the swap is $|\\Phi^+\\rangle_{12} \\otimes |\\Psi^+\\rangle_{34}$. We must trace the effect of the BSM and the pre-defined correction rules on this state. The swapping operation projects the state of qubits (1,4) into a Bell state that depends on the BSM outcome on (2,3).\n    *   If BSM on (2,3) yields $|\\Phi^+\\rangle$, the state on (1,4) becomes $|\\Psi^+\\rangle_{14}$. Alice applies the standard correction for this outcome, $I_1$. The final state is $I_1|\\Psi^+\\rangle_{14} = |\\Psi^+\\rangle_{14}$.\n    *   If BSM on (2,3) yields $|\\Phi^-\\rangle$, the state on (1,4) becomes $|\\Psi^-\\rangle_{14}$. Alice applies the correction $Z_1$. The final state is $Z_1|\\Psi^-\\rangle_{14} = |\\Psi^+\\rangle_{14}$.\n    *   If BSM on (2,3) yields $|\\Psi^+\\rangle$, the state on (1,4) becomes $|\\Phi^+\\rangle_{14}$. Alice applies the correction $X_1$. The final state is $X_1|\\Phi^+\\rangle_{14} = |\\Psi^+\\rangle_{14}$.\n    *   If BSM on (2,3) yields $|\\Psi^-\\rangle$, the state on (1,4) becomes $|\\Phi^-\\rangle_{14}$. Alice applies the correction $iY_1 = X_1 Z_1$. The final state is $(X_1 Z_1)|\\Phi^-\\rangle_{14} = |\\Psi^+\\rangle_{14}$.\n\n    In all four cases, when a bit-flip occurs, the final state is $|\\Psi^+\\rangle_{14}$.\n\n4.  **Final Fidelity Calculation**: The state $|\\Psi^+\\rangle_{14}$ is orthogonal to the target state $|\\Phi^+\\rangle_{14}$, so its fidelity is $\\langle\\Phi^+_{14}|\\Psi^+_{14}\\rangle = 0$. The final fidelity is the weighted average over the two possibilities (flip or no-flip):\n    $$ F = (1-p) \\cdot \\text{Fidelity}(\\text{no-flip}) + p \\cdot \\text{Fidelity}(\\text{flip}) $$\n    $$ F = (1-p) \\cdot 1 + p \\cdot 0 = 1-p $$", "answer": "$$\\boxed{1-p}$$", "id": "669300"}, {"introduction": "Beyond channel noise, the active operations within a quantum repeater are also prone to error. This practice focuses on the heart of the swapping protocol: the Bell State Measurement (BSM). You will investigate the consequences of a faulty CNOT gate within the BSM circuit [@problem_id:669383], a common and realistic hardware imperfection. This analysis highlights how errors in quantum logic gates can corrupt the measurement information, leading to incorrect corrections and a degraded final entangled state.", "problem": "An essential protocol in quantum communication is entanglement swapping, which allows two spatially separated parties, Alice and Bob, to share an entangled state without their quantum systems ever interacting directly. The protocol relies on a central station that performs a Bell State Measurement (BSM).\n\nConsider the following setup for entanglement swapping:\n1.  Alice prepares an entangled pair of qubits (A, 1) in the Bell state $|\\Phi^+\\rangle_{A1} = \\frac{1}{\\sqrt{2}}(|00\\rangle_{A1} + |11\\rangle_{A1})$. She keeps qubit A and sends qubit 1 to a central station.\n2.  Bob prepares another entangled pair of qubits (B, 2) in the Bell state $|\\Phi^+\\rangle_{B2} = \\frac{1}{\\sqrt{2}}(|00\\rangle_{B2} + |11\\rangle_{B2})$. He keeps qubit B and sends qubit 2 to the same central station.\n3.  The central station performs a BSM on qubits 1 and 2. The standard BSM circuit consists of a CNOT gate with qubit 1 as control and qubit 2 as target (CNOT$_{12}$), followed by a Hadamard gate on qubit 1. Subsequently, both qubits 1 and 2 are measured in the computational basis $\\{|0\\rangle, |1\\rangle\\}$.\n4.  The classical measurement outcome is communicated to Bob, who then applies a specific Pauli correction ($I, \\sigma_x, \\sigma_y, \\sigma_z$) to his qubit B. In an ideal scenario, this procedure results in the qubits A and B being projected into the target state $|\\Phi^+\\rangle_{AB}$.\n\nHowever, the CNOT$_{12}$ gate at the central station is faulty. With probability $p$, the gate's operation is altered: it performs an ideal CNOT$_{12}$ followed by an unwanted Pauli $\\sigma_x$ gate on the target qubit (qubit 2). With probability $(1-p)$, it functions as a perfect CNOT$_{12}$ gate. The rest of the BSM (Hadamard gate and measurements) and Bob's correction operation are assumed to be perfect. The correction procedure applied by Bob is the one designed for the ideal, error-free protocol.\n\nDerive the fidelity of the final state of the qubit pair (A, B) with the ideal target state $|\\Phi^+\\rangle_{AB}$. The fidelity should be expressed as a function of the error probability $p$. Assume the final state is averaged over all four possible measurement outcomes at the central station.", "solution": "1. **Ideal Case (Probability $1-p$)**: The CNOT gate works perfectly. The entanglement swap is successful, and after Bob's correction, the final state of the pair (A, B) is the target state $|\\Phi^+\\rangle_{AB}$. The fidelity in this case is 1.\n\n2. **Faulty Case (Probability $p$)**: An unwanted Pauli $X_2$ gate is applied to qubit 2 after the CNOT$_{12}$ gate.\n   *   The BSM circuit (CNOT then H) is designed to map the four Bell states $|\\Psi_{ij}\\rangle_{12} = (X^i Z^j \\otimes I)|\\Phi^+\\rangle_{12}$ to the four computational basis states $|ji\\rangle_{12}$.\n   *   The extra $X_2$ gate flips the state of qubit 2 before the final measurement. This corresponds to flipping the measurement outcome bit $i \\to i \\oplus 1$. The other measurement outcome bit, $j$, remains unchanged.\n   *   Therefore, if the state of qubits (1,2) before the BSM was $|\\Psi_{ij}\\rangle_{12}$, the central station measures $(j, i \\oplus 1)$ instead of $(j, i)$.\n\n3. **Correction Error**: The entanglement swap projects the state of (A,B) into the same Bell state as (1,2), which is $|\\Psi_{ij}\\rangle_{AB}$. The ideal correction for Bob to apply would be $U_{ideal} = Z_B^j X_B^i$. However, based on the faulty measurement outcome $(j, i \\oplus 1)$, Bob applies the correction $U_{faulty} = Z_B^j X_B^{i \\oplus 1}$.\n\n4. **Final State Calculation**: The final state of the (A,B) pair is the result of applying the faulty correction to the actual state:\n   $$ |\\psi_{final}\\rangle = U_{faulty} |\\Psi_{ij}\\rangle_{AB} = (U_{faulty} U_{ideal}^{-1}) (U_{ideal} |\\Psi_{ij}\\rangle_{AB}) = (U_{faulty} U_{ideal}^{-1}) |\\Phi^+\\rangle_{AB} $$\n   The error operator is:\n   $$ U_{faulty} U_{ideal}^{-1} = (I_A \\otimes Z_B^j X_B^{i \\oplus 1}) (I_A \\otimes (Z_B^j X_B^i)^{-1}) = I_A \\otimes (Z_B^j X_B^{i \\oplus 1} X_B^i Z_B^j) $$\n   Since $X^{i \\oplus 1} X^i = X$, the operator simplifies to $Z_B^j X_B Z_B^j$.\n   *   If $j=0$, this is $X_B$.\n   *   If $j=1$, this is $Z_B X_B Z_B = -X_B$.\n   In all cases, the applied operation is $X_B$ up to an irrelevant global phase. The final state is $X_B |\\Phi^+\\rangle_{AB} = |\\Psi^+\\rangle_{AB}$.\n\n5. **Average Fidelity**: The final state is a statistical mixture:\n   $$ \\rho_{AB} = (1-p) |\\Phi^+\\rangle\\langle\\Phi^+| + p |\\Psi^+\\rangle\\langle\\Psi^+| $$\n   The fidelity with the target state $|\\Phi^+\\rangle_{AB}$ is:\n   $$ F = \\langle\\Phi^+|\\rho_{AB}|\\Phi^+\\rangle = (1-p) \\cdot \\langle\\Phi^+|\\Phi^+\\rangle + p \\cdot \\langle\\Phi^+|\\Psi^+\\rangle = (1-p) \\cdot 1 + p \\cdot 0 = 1-p $$", "answer": "$$\\boxed{1-p}$$", "id": "669383"}, {"introduction": "Quantum repeaters are hybrid systems relying on both quantum resources and classical communication for feed-forward corrections. This final practice presents a complex scenario involving simultaneous failures in both domains: a faulty classical channel corrupts the measurement result, and the subsequent corrective operation is misapplied [@problem_id:669349]. By deriving the complete density matrix of the final state, you will learn to trace the propagation of multiple, distinct error types, providing a comprehensive picture of the challenges in building robust quantum networks.", "problem": "An elementary quantum repeater segment operates via entanglement swapping. Two sources produce ideal, entangled Bell pairs. The first pair, shared between Alice (A) and Bob (B), is in the state $|\\Phi^+_{AB}\\rangle$. The second pair, shared between Charlie (C) and David (D), is in the state $|\\Phi^+_{CD}\\rangle$. Alice and David are at distant locations, while Bob and Charlie are co-located at a central node. The state $|\\Phi^+\\rangle$ is defined as $\\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$.\n\nTo entangle Alice's and David's qubits, a Bell State Measurement (BSM) is performed on qubits B and C. The BSM projects the two-qubit state onto one of the four Bell states, $|\\Phi^\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle \\pm |11\\rangle)$ and $|\\Psi^\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle \\pm |10\\rangle)$. The outcome of the BSM is encoded into two classical bits, $m_1 m_0$, which are communicated to one of the end stations to perform a corrective Pauli rotation, thereby establishing a $|\\Phi^+\\rangle$ state between A and D. The mapping between the BSM measurement outcome and the two classical bits is:\n- $|\\Phi^+\\rangle_{BC} \\leftrightarrow 00$\n- $|\\Psi^+\\rangle_{BC} \\leftrightarrow 01$\n- $|\\Phi^-\\rangle_{BC} \\leftrightarrow 10$\n- $|\\Psi^-\\rangle_{BC} \\leftrightarrow 11$\n\nThe corresponding corrective Pauli operation for an outcome $m_1 m_0$ is $U = X^{m_0} Z^{m_1}$, where $X$ and $Z$ are the standard Pauli matrices.\n\nConsider a scenario where two implementation errors occur simultaneously:\n1.  The corrective Pauli operation $U$ is mistakenly applied to Alice's qubit (A) instead of David's qubit (D).\n2.  The classical communication channel that transmits the bits $(m_1, m_0)$ from the BSM station to Alice is faulty. It is a bit-flip channel that flips the second bit, $m_0$, with a probability $p$, while the first bit, $m_1$, is always transmitted correctly.\n\nDerive the density matrix $\\rho_{AD}$ of the final two-qubit state shared by Alice and David. Express your answer as a matrix in the computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$.", "solution": "1.  **State After Swapping**: The initial state is $|\\Phi^+_{AB}\\rangle \\otimes |\\Phi^+_{CD}\\rangle$. After the BSM is performed on qubits B and C, the state of qubits A and D is projected into the same Bell state as the BSM outcome. If the BSM outcome is $|\\Psi_{m_1m_0}\\rangle_{BC}$, the state on AD becomes $|\\Psi_{m_1m_0}\\rangle_{AD}$. Each of the four outcomes $(m_1, m_0)$ occurs with equal probability $1/4$.\n\n2.  **Identifying States and Corrections**: The mapping provided implies that the state $|\\Psi_{m_1m_0}\\rangle_{AD}$ corresponding to bits $(m_1, m_0)$ is the state that would be transformed to $|\\Phi^+\\rangle_{AD}$ by the correction $U=X^{m_0}Z^{m_1}$. The states are:\n    *   $m_1m_0=00$: State is $|\\Phi^+\\rangle_{AD}$.\n    *   $m_1m_0=01$: State is $|\\Psi^+\\rangle_{AD}$.\n    *   $m_1m_0=10$: State is $|\\Phi^-\\rangle_{AD}$.\n    *   $m_1m_0=11$: State is $|\\Psi^-\\rangle_{AD}$.\n\n3.  **Error Propagation**: Two errors occur. First, the classical channel flips $m_0 \\to \\tilde{m}_0 = m_0 \\oplus f$, where $f=1$ with probability $p$. Second, the correction based on the received bits $(m_1, \\tilde{m}_0)$ is applied to qubit A. The applied operation is $U'_A = X_A^{\\tilde{m}_0} Z_A^{m_1}$.\n\n4.  **Final State Analysis (Case by Case)**: We calculate the final state for each BSM outcome, averaging over the channel error $f$.\n    *   **Outcome `00`**: State on AD is $|\\Phi^+\\rangle$. The applied correction is $U'_A = X_A^{0 \\oplus f} Z_A^0 = X_A^f$. The final state is $X_A^f|\\Phi^+\\rangle$.\n    *   **Outcome `01`**: State on AD is $|\\Psi^+\\rangle$. The applied correction is $U'_A = X_A^{1 \\oplus f} Z_A^0 = X_A^{1 \\oplus f}$. The final state is $X_A^{1 \\oplus f}|\\Psi^+\\rangle = X_A^{1 \\oplus f}X_A^1|\\Phi^+\\rangle = X_A^f|\\Phi^+\\rangle$.\n    *   **Outcome `10`**: State on AD is $|\\Phi^-\\rangle$. The applied correction is $U'_A = X_A^{0 \\oplus f} Z_A^1 = X_A^f Z_A$. The final state is $(X_A^f Z_A)|\\Phi^-\\rangle = (X_A^f Z_A)Z_A|\\Phi^+\\rangle = X_A^f|\\Phi^+\\rangle$.\n    *   **Outcome `11`**: State on AD is $|\\Psi^-\\rangle$. The applied correction is $U'_A = X_A^{1 \\oplus f} Z_A^1$. The final state is $(X_A^{1 \\oplus f} Z_A)|\\Psi^-\\rangle = (X_A^{1 \\oplus f} Z_A)(Z_A X_A)|\\Phi^+\\rangle = -X_A^{1 \\oplus f} X_A|\\Phi^+\\rangle = -X_A^f|\\Phi^+\\rangle$.\n\n5.  **Averaging Over Errors**: Remarkably, for any BSM outcome, the final state (up to an irrelevant global phase) depends only on the classical channel error $f$.\n    *   With probability $1-p$ (no flip, $f=0$), the final state is $|\\Phi^+\\rangle_{AD}$.\n    *   With probability $p$ (flip, $f=1$), the final state is $X_A|\\Phi^+\\rangle_{AD} = |\\Psi^+\\rangle_{AD}$.\n\n6.  **Density Matrix**: The final state is a statistical mixture of these two outcomes, averaged over the BSM possibilities (which all lead to the same mixture):\n    $$ \\rho_{AD} = (1-p) |\\Phi^+\\rangle\\langle\\Phi^+| + p |\\Psi^+\\rangle\\langle\\Psi^+| $$\n    In the computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$, this is:\n    $$ \\rho_{AD} = (1-p) \\frac{1}{2}\\begin{pmatrix} 1  0  0  1 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\\\ 1  0  0  1 \\end{pmatrix} + p \\frac{1}{2}\\begin{pmatrix} 0  0  0  0 \\\\ 0  1  1  0 \\\\ 0  1  1  0 \\\\ 0  0  0  0 \\end{pmatrix} $$\n    $$ \\rho_{AD} = \\frac{1}{2}\\begin{pmatrix} 1-p  0  0  1-p \\\\ 0  p  p  0 \\\\ 0  p  p  0 \\\\ 1-p  0  0  1-p \\end{pmatrix} $$", "answer": "$$\\boxed{\\frac{1}{2}\\begin{pmatrix}1-p001-p\\\\0pp0\\\\0pp0\\\\1-p001-p\\end{pmatrix}}$$", "id": "669349"}]}