{"hands_on_practices": [{"introduction": "In practical reactor engineering, idealized geometries are rarely achieved. Small physical deformations, such as fuel rod bowing or thermal expansion, can impact a reactor's criticality. This exercise introduces first-order perturbation theory as a powerful tool to quantify the effects of such small changes on core parameters without needing to fully re-solve the neutron transport equations [@problem_id:405684]. By analyzing a hypothetical deformation of a cylindrical reactor, you will practice using adjoint flux-weighted integrals to calculate the resulting shift in the geometric buckling, a fundamental skill in advanced reactor analysis and design.", "problem": "Consider a bare, homogeneous, critical cylindrical nuclear reactor of unperturbed radius $R_0$ and height $H_0$. The neutron population is described by two-group diffusion theory. The fast (group 1) and thermal (group 2) neutron fluxes, $\\phi_1(\\vec{r})$ and $\\phi_2(\\vec{r})$, satisfy the following steady-state equations:\n$$\nD_1 \\nabla^2 \\phi_1 - \\Sigma_{R1} \\phi_1 + \\nu\\Sigma_{f2} \\phi_2 = 0\n$$\n$$\nD_2 \\nabla^2 \\phi_2 - \\Sigma_{a2} \\phi_2 + \\Sigma_{s1\\to2} \\phi_1 = 0\n$$\nwhere $D_g$ are the diffusion coefficients, $\\Sigma_{R1}$ is the fast removal cross-section, $\\Sigma_{a2}$ is the thermal absorption cross-section, $\\Sigma_{s1\\to2}$ is the scattering cross-section from group 1 to 2, and $\\nu\\Sigma_{f2}$ is the neutron production cross-section (fission is induced by thermal neutrons only, producing fast neutrons). The reactor material is specified by these constant parameters.\n\nThe unperturbed reactor is critical, with the flux vanishing on the extrapolated boundaries defined by $r=R_0$ and $z=0, H_0$. The solutions have the form $\\phi_g(r,z) = \\Phi_g J_0(\\frac{\\nu_0 r}{R_0})\\sin(\\frac{\\pi z}{H_0})$, where $J_0$ is the zeroth-order Bessel function of the first kind and $\\nu_0$ is its first zero ($J_0(\\nu_0)=0$).\n\nThe reactor's radial boundary is now perturbed, such that the new radius is given by $R(z) = R_0 + d_0 \\sin^2\\left(\\frac{\\pi z}{H_0}\\right)$, where $d_0$ is a small constant displacement ($d_0 \\ll R_0$). The height remains $H_0$.\n\nUsing first-order perturbation theory based on the adjoint flux method, calculate the change in the geometric buckling, $\\delta B_g^2$, caused by this boundary deformation. Express your answer in terms of $R_0$, $d_0$, and $\\nu_0$.", "solution": "We consider the Helmholtz‐eigenvalue problem for the unperturbed geometry,\n$$\\nabla^2\\phi + B^2\\phi=0,\\quad \\phi|_{r=R_0}=0,\\;\\phi|_{z=0,H_0}=0,$$\nwith eigenfunction\n$$\\phi(r,z)=N\\,J_0\\!\\Bigl(\\nu_0\\frac{r}{R_0}\\Bigr)\\sin\\!\\Bigl(\\frac{\\pi z}{H_0}\\Bigr),\\quad\nB^2=\\Bigl(\\frac{\\nu_0}{R_0}\\Bigr)^2+\\Bigl(\\frac{\\pi}{H_0}\\Bigr)^2,$$\nwhere $J_0(\\nu_0)=0$.  \n\nUnder a small radial boundary displacement \n$$\\delta r(z)=d_0\\sin^2\\!\\Bigl(\\frac{\\pi z}{H_0}\\Bigr),$$\nthe first‐order shift in the eigenvalue is given by the shape‐perturbation formula  \n$$\n\\delta B^2\n=-\\frac{\\displaystyle\\int_{\\partial V}\n\\bigl|\\partial_n\\phi\\bigr|^2\\,\\delta r\\,dS}\n{\\displaystyle\\int_V\\phi^2\\,dV}\\,.\n$$\n\n1. Normal derivative at $r=R_0$:\n$$\n\\partial_n\\phi=\\partial_r\\phi\\Big|_{r=R_0}\n=N\\,\\frac{\\nu_0}{R_0}\\,J_1(\\nu_0)\\,\\sin\\!\\Bigl(\\frac{\\pi z}{H_0}\\Bigr)\\,.\n$$\n\n2. Denominator (normalization):\n\n$$\n\\int_V\\phi^2\\,dV\n=N^2\\,(2\\pi)\\int_0^{R_0}J_0^2\\!\\Bigl(\\nu_0\\frac{r}{R_0}\\Bigr)\\,rdr\n\\int_0^{H_0}\\sin^2\\!\\Bigl(\\frac{\\pi z}{H_0}\\Bigr)dz\n=N^2\\,\\frac{\\pi R_0^2H_0}{2}\\,J_1^2(\\nu_0)\\,.\n$$\n\n\n3. Numerator:\n\n$$\n\\int_{\\partial V}|\\partial_n\\phi|^2\\,\\delta r\\,dS\n=\\int_0^{2\\pi}\\!\\!d\\theta\\int_0^{H_0}\n\\Bigl[N^2\\frac{\\nu_0^2}{R_0^2}J_1^2(\\nu_0)\\sin^2\\!\\tfrac{\\pi z}{H_0}\\Bigr]\n\\,d_0\\sin^2\\!\\tfrac{\\pi z}{H_0}\\,R_0\\,dz\n$$\n\n\n$$\n= N^2\\,\\frac{\\nu_0^2}{R_0}\\,J_1^2(\\nu_0)\\,d_0\\,(2\\pi)\\,\n\\int_0^{H_0}\\sin^4\\!\\tfrac{\\pi z}{H_0}\\,dz\n= N^2\\,\\frac{\\nu_0^2}{R_0}\\,J_1^2(\\nu_0)\\,d_0\\,\n\\frac{3\\pi H_0}{4}\\,.\n$$\n\n\n4. Assemble $\\delta B^2$:\n$$\n\\delta B^2\n=-\\frac{N^2\\,\\dfrac{\\nu_0^2}{R_0}\\,J_1^2(\\nu_0)\\,d_0\\,\\dfrac{3\\pi H_0}{4}}\n{N^2\\,\\dfrac{\\pi R_0^2H_0}{2}\\,J_1^2(\\nu_0)}\n=-\\frac{3\\,\\nu_0^2\\,d_0}{2\\,R_0^3}\\,. \n$$", "answer": "$$\\boxed{-\\frac{3\\,\\nu_0^2\\,d_0}{2\\,R_0^3}}$$", "id": "405684"}, {"introduction": "The safety and reliability of a nuclear reactor design depend critically on the accurate prediction of its effective multiplication factor, $k_{\\text{eff}}$. However, the underlying nuclear cross-section data used in simulations are based on experiments and carry inherent uncertainties. This practice delves into the essential task of uncertainty quantification, demonstrating how sensitivity analysis—an application of perturbation theory—is used to propagate these data uncertainties to the final calculated value of $k_{\\text{eff}}$ [@problem_id:405631]. Mastering this \"sandwich rule\" calculation is fundamental to establishing robust safety margins and understanding the confidence level of predictive reactor simulations.", "problem": "The accurate prediction of the effective multiplication factor, $k_{\\text{eff}}$, is of paramount importance in the design and safety analysis of nuclear reactors. The value of $k_{\\text{eff}}$ is computed using neutron transport or diffusion theory with nuclear cross-section data as input. These nuclear data are derived from experiments and have inherent uncertainties, which propagate through the calculations and result in uncertainty in the predicted $k_{\\text{eff}}$.\n\nFirst-order perturbation theory provides a powerful method to quantify this uncertainty propagation. For a quantity $Y$ that is a function of several parameters $X_1, X_2, \\ldots, X_n$, its variance, $\\text{Var}(Y)$, can be approximated by:\n$$ \\text{Var}(Y) \\approx \\sum_{i=1}^n \\sum_{j=1}^n \\frac{\\partial Y}{\\partial X_i} \\frac{\\partial Y}{\\partial X_j} \\text{Cov}(X_i, X_j) $$\nwhere $\\text{Cov}(X_i, X_j)$ is the covariance between parameters $X_i$ and $X_j$.\n\nIn reactor physics, we are interested in $Y=k_{\\text{eff}}$ and the parameters $X_i$ are the nuclear data, which we denote by $\\sigma_i$. It is often convenient to work with relative quantities. The relative sensitivity of $k_{\\text{eff}}$ with respect to a parameter $\\sigma_i$ is defined as:\n$$ S_i = \\frac{\\sigma_i}{k_{\\text{eff}}} \\frac{\\partial k_{\\text{eff}}}{\\partial \\sigma_i} $$\nThe relative covariance between two parameters $\\sigma_i$ and $\\sigma_j$ is given by:\n$$ C^{\\text{rel}}_{ij} = \\frac{\\text{Cov}(\\sigma_i, \\sigma_j)}{\\sigma_i \\sigma_j} $$\nUsing these definitions, the variance of $k_{\\text{eff}}$ can be expressed in matrix form as:\n$$ \\text{Var}(k_{\\text{eff}}) = k_{\\text{eff}}^2 S^T C^{\\text{rel}} S $$\nwhere $S$ is the column vector of relative sensitivities and $C^{\\text{rel}}$ is the relative covariance matrix.\n\nConsider a conceptual critical reactor operating at a nominal effective multiplication factor of $k_{\\text{eff},0} = K$. The uncertainty in $k_{\\text{eff}}$ is assumed to be dominated by the uncertainties in four key two-group nuclear data parameters:\n- $\\sigma_1$: fast group nu-fission macroscopic cross-section, $(\\nu\\Sigma_f)_1$\n- $\\sigma_2$: fast group absorption macroscopic cross-section, $\\Sigma_{a,1}$\n- $\\sigma_3$: thermal group nu-fission macroscopic cross-section, $(\\nu\\Sigma_f)_2$\n- $\\sigma_4$: thermal group absorption macroscopic cross-section, $\\Sigma_{a,2}$\n\nThe vector of relative sensitivities of $k_{\\text{eff}}$ with respect to these parameters has been determined to be:\n$$ S = \\begin{pmatrix} S_1 \\\\ S_2 \\\\ S_3 \\\\ S_4 \\end{pmatrix} = \\begin{pmatrix} A \\\\ -B \\\\ C \\\\ -D \\end{pmatrix} $$\nwhere $A, B, C, D$ are positive real constants.\n\nThe relative covariance matrix for these four parameters is given by:\n$$ C^{\\text{rel}} = \\begin{pmatrix} v_1  c_{12}  c_{13}  0 \\\\ c_{12}  v_2  0  0 \\\\ c_{13}  0  v_3  c_{34} \\\\ 0  0  c_{34}  v_4 \\end{pmatrix} $$\nwhere $v_i$ are the relative variances and $c_{ij}$ are the relative covariances. All entries are known real constants.\n\nYour task is to calculate the variance of the effective multiplication factor, $\\text{Var}(k_{\\text{eff}})$.", "solution": "The variance of the effective multiplication factor, $\\text{Var}(k_{\\text{eff}})$, is determined by propagating the uncertainties in the nuclear data parameters using first-order perturbation theory. The problem provides the relevant formula in matrix form:\n$$ \\text{Var}(k_{\\text{eff}}) = k_{\\text{eff},0}^2 S^T C^{\\text{rel}} S $$\n\nWe are given the following:\n- The nominal effective multiplication factor: $k_{\\text{eff},0} = K$.\n- The relative sensitivity vector: $S = \\begin{pmatrix} A \\\\ -B \\\\ C \\\\ -D \\end{pmatrix}$.\n- The relative covariance matrix: $C^{\\text{rel}} = \\begin{pmatrix} v_1  c_{12}  c_{13}  0 \\\\ c_{12}  v_2  0  0 \\\\ c_{13}  0  v_3  c_{34} \\\\ 0  0  c_{34}  v_4 \\end{pmatrix}$.\n\nThe calculation proceeds by evaluating the matrix product $S^T C^{\\text{rel}} S$.\n\nFirst, we find the transpose of the sensitivity vector, $S^T$:\n$$ S^T = \\begin{pmatrix} A  -B  C  -D \\end{pmatrix} $$\n\nNext, we compute the product of the row vector $S^T$ with the matrix $C^{\\text{rel}}$:\n$$ S^T C^{\\text{rel}} = \\begin{pmatrix} A  -B  C  -D \\end{pmatrix} \\begin{pmatrix} v_1  c_{12}  c_{13}  0 \\\\ c_{12}  v_2  0  0 \\\\ c_{13}  0  v_3  c_{34} \\\\ 0  0  c_{34}  v_4 \\end{pmatrix} $$\nPerforming the matrix multiplication gives a $1 \\times 4$ row vector:\nComponent 1: $A(v_1) - B(c_{12}) + C(c_{13}) - D(0) = A v_1 - B c_{12} + C c_{13}$\nComponent 2: $A(c_{12}) - B(v_2) + C(0) - D(0) = A c_{12} - B v_2$\nComponent 3: $A(c_{13}) - B(0) + C(v_3) - D(c_{34}) = A c_{13} + C v_3 - D c_{34}$\nComponent 4: $A(0) - B(0) + C(c_{34}) - D(v_4) = C c_{34} - D v_4$\n\nSo, the resulting row vector is:\n$$ S^T C^{\\text{rel}} = \\begin{pmatrix} A v_1 - B c_{12} + C c_{13}  A c_{12} - B v_2  A c_{13} + C v_3 - D c_{34}  C c_{34} - D v_4 \\end{pmatrix} $$\n\nNow, we multiply this row vector by the column vector $S$:\n$$ S^T C^{\\text{rel}} S = \\begin{pmatrix} A v_1 - B c_{12} + C c_{13}  A c_{12} - B v_2  A c_{13} + C v_3 - D c_{34}  C c_{34} - D v_4 \\end{pmatrix} \\begin{pmatrix} A \\\\ -B \\\\ C \\\\ -D \\end{pmatrix} $$\nThis is a dot product, resulting in a scalar value:\n$$ S^T C^{\\text{rel}} S = A(A v_1 - B c_{12} + C c_{13}) - B(A c_{12} - B v_2) + C(A c_{13} + C v_3 - D c_{34}) - D(C c_{34} - D v_4) $$\nWe expand each term:\n$$ = (A^2 v_1 - A B c_{12} + A C c_{13}) + (-A B c_{12} + B^2 v_2) + (A C c_{13} + C^2 v_3 - C D c_{34}) + (-C D c_{34} + D^2 v_4) $$\nNow, we collect like terms:\n$$ = A^2 v_1 + B^2 v_2 + C^2 v_3 + D^2 v_4 - 2 A B c_{12} + 2 A C c_{13} - 2 C D c_{34} $$\n\nFinally, we substitute this result into the original formula for the variance:\n$$ \\text{Var}(k_{\\text{eff}}) = k_{\\text{eff},0}^2 (S^T C^{\\text{rel}} S) $$\n$$ \\text{Var}(k_{\\text{eff}}) = K^2 (A^2 v_1 + B^2 v_2 + C^2 v_3 + D^2 v_4 - 2 A B c_{12} + 2 A C c_{13} - 2 C D c_{34}) $$\nThis is the final expression for the variance of $k_{\\text{eff}}$.", "answer": "$$ \\boxed{K^2 (A^2 v_1 + B^2 v_2 + C^2 v_3 + D^2 v_4 - 2 A B c_{12} + 2 A C c_{13} - 2 C D c_{34})} $$", "id": "405631"}, {"introduction": "Modeling the long-term evolution of nuclear fuel composition, or \"burnup,\" is crucial for fuel cycle analysis, waste management, and safety assessment. This process is governed by a large system of coupled ordinary differential equations, the solution of which involves calculating a matrix exponential. This exercise explores a key numerical technique used in modern reactor simulation codes: approximating the matrix exponential with a rational function, specifically a Padé approximant [@problem_id:405620]. By optimizing the approximant's coefficients for a simplified transmutation chain, you will gain insight into the methods that make large-scale, high-fidelity burnup calculations computationally feasible.", "problem": "The time evolution of nuclide concentrations in a nuclear reactor is described by a set of coupled first-order ordinary differential equations, often referred to as the Bateman equations. For a simplified transmutation chain involving two nuclides, where nuclide 1 transmutes to nuclide 2, and both are removed (by radioactive decay or neutron absorption), the system can be written in matrix form as:\n$$\n\\frac{d\\mathbf{N}(t)}{dt} = -\\mathbf{A} \\mathbf{N}(t)\n$$\nwhere $\\mathbf{N}(t) = [N_1(t), N_2(t)]^T$ is the vector of nuclide concentrations, and $\\mathbf{A}$ is the depletion matrix. For the chain where nuclide 1 is converted into nuclide 2 with a rate constant $\\lambda_1$, and nuclide 2 is removed with a rate constant $\\lambda_2$, the matrix $\\mathbf{A}$ is given by:\n$$\n\\mathbf{A} = \\begin{pmatrix} \\lambda_1  0 \\\\ -\\lambda_1  \\lambda_2 \\end{pmatrix}\n$$\nThe formal solution over a time step of duration $h$ is $\\mathbf{N}(h) = \\exp(-\\mathbf{A}h) \\mathbf{N}(0)$. Numerically, the matrix exponential $\\exp(-\\mathbf{A}h)$ is often approximated by a rational function. A common choice is the [1/1] Padé approximant. We consider a generalized form of this approximant:\n$$\n\\exp(-\\mathbf{A}h) \\approx R(\\mathbf{A},h) = (\\mathbf{I} - p h \\mathbf{A})(\\mathbf{I} + q h\\mathbf{A})^{-1}\n$$\nwhere $\\mathbf{I}$ is the identity matrix, and $p$ and $q$ are scalar coefficients to be determined.\n\nTo find the optimal coefficients for this specific physical system, we impose the condition that the approximation is exact for the components of the solution corresponding to the eigenvalues of the matrix $\\mathbf{A}$. This means that for each eigenvalue $\\mu$ of $\\mathbf{A}$, the scalar relation must hold:\n$$\ne^{-\\mu h} = \\frac{1 - p \\mu h}{1 + q \\mu h}\n$$\nConsider a specific case where the effective removal rate of the daughter nuclide is twice that of the parent nuclide, i.e., $\\lambda_2 = 2\\lambda_1$. Let $\\alpha = \\lambda_1 h$. Determine the ratio of the optimal coefficients, $p/q$, as a function of $\\alpha$.", "solution": "We seek $p$ and $q$ such that for each eigenvalue $\\mu$ of $\\mathbf{A}$,\n$$\ne^{-\\mu h} \\;=\\;\\frac{1 - p\\,\\mu h}{1 + q\\,\\mu h}\\,.\n$$\nHere, $\\lambda_2=2\\lambda_1$ and $\\alpha=\\lambda_1 h$, so the eigenvalues are\n$$\n\\mu_1=\\lambda_1,\\quad \\mu_2=2\\lambda_1,\n$$\nand \n$E_1=e^{-\\alpha}$, $E_2=e^{-2\\alpha}=E_1^2$.\nThus the two scalar conditions are\n\n$$\n1 - p\\alpha = E_1\\,(1 + q\\alpha),\n\\tag{1}\n$$\n\n\n$$\n1 - 2p\\alpha = E_2\\,(1 + 2q\\alpha).\n\\tag{2}\n$$\n\nRewrite each in the form $p + (\\cdot)q = (\\cdot)$:\nFrom (1): \n\n$$\n1 - p\\alpha = E_1 + E_1 q\\alpha\n\\;\\Longrightarrow\\;\np + E_1 q = \\frac{1 - E_1}{\\alpha}.\n\\tag{1'}\n$$\n\nFrom (2):\n\n$$\n1 - 2p\\alpha = E_2 + 2E_2 q\\alpha\n\\;\\Longrightarrow\\;\np + E_2 q = \\frac{1 - E_2}{2\\alpha}.\n\\tag{2'}\n$$\n\nSubtract (2') from (1'):\n\n$$\n(E_1 - E_2)\\,q = \\frac{1 - E_1}{\\alpha} - \\frac{1 - E_2}{2\\alpha}\n= \\frac{1 - 2E_1 + E_2}{2\\alpha}\n= \\frac{(1 - E_1)^2}{2\\alpha}\\,.\n$$\n\nSince $E_1-E_2=E_1(1-E_1)$, we get\n\n$$\nq=\\frac{(1 - E_1)^2}{2\\alpha\\,E_1(1 - E_1)}\n=\\frac{1 - E_1}{2\\alpha\\,E_1}\n=\\frac{1 - e^{-\\alpha}}{2\\alpha\\,e^{-\\alpha}}\n=\\frac{e^{\\alpha}-1}{2\\alpha}\\,.\n$$\n\nThen from (1'):\n\n$$\np=\\frac{1 - E_1}{\\alpha}-E_1 q\n=\\frac{1 - E_1}{\\alpha}-\\frac{1 - E_1}{2\\alpha}\n=\\frac{1 - E_1}{2\\alpha}\n=\\frac{1 - e^{-\\alpha}}{2\\alpha}\\,.\n$$\n\nTherefore\n\n$$\n\\frac{p}{q}\n=\\frac{\\frac{1 - e^{-\\alpha}}{2\\alpha}}{\\frac{e^{\\alpha}-1}{2\\alpha}}\n=\\frac{1 - e^{-\\alpha}}{e^{\\alpha}-1}\n=e^{-\\alpha}\\,.\n$$", "answer": "$$\\boxed{e^{-\\alpha}}$$", "id": "405620"}]}