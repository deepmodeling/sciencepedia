{"hands_on_practices": [{"introduction": "At any non-zero temperature, the perfectly ordered ferromagnetic ground state is perturbed by a gas of thermally excited magnons. This exercise explores the thermodynamic consequences of these spin-wave excitations, specifically their effect on the total magnetization. By analyzing the thermal population of magnons, you will uncover a profound result related to the Mermin-Wagner theorem: long-range magnetic order in two dimensions is fragile and requires an anisotropy gap for stability at finite temperatures [@problem_id:3017157].", "problem": "Consider a two-dimensional isotropic Heisenberg ferromagnet in the long-wavelength, low-temperature regime where the spin dynamics are well described by noninteracting magnons (linear spin-wave theory). Let the magnon dispersion be given by either the gapless form $\\epsilon_{\\mathbf{k}}=D k^{2}$ (isotropic case) or the gapped form $\\epsilon_{\\mathbf{k}}=\\Delta + D k^{2}$ (easy-axis anisotropy), where $D$ is the spin-wave stiffness and $\\Delta>0$ is the anisotropy gap. The reduction of the magnetization density due to thermal magnons is\n$$\n\\delta M(T)= (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, n_{B}(\\epsilon_{\\mathbf{k}}),\n$$\nwhere $g$ is the Landé factor, $\\mu_{B}$ is the Bohr magneton, and $n_{B}(x)=\\left[\\exp(x/T)-1\\right]^{-1}$ is the Bose–Einstein (BE) distribution. Work in units where the Boltzmann constant $k_{B}=1$ so that temperature $T$ has units of energy.\n\n(a) Using only the long-wavelength form of $\\epsilon_{\\mathbf{k}}$, analyze the infrared behavior of the integral for the gapless case $\\epsilon_{\\mathbf{k}}=Dk^{2}$ and determine whether $\\delta M(T)$ is finite or divergent for any fixed $T>0$.\n\n(b) For the gapped case $\\epsilon_{\\mathbf{k}}=\\Delta + D k^{2}$, derive the leading-order asymptotic form of $\\delta M(T)$ in the low-temperature limit $T\\ll \\Delta$. Your derivation must start from the expression above and proceed from first principles of the BE distribution and continuum $\\mathbf{k}$-space integration, without invoking any pre-tabulated asymptotic result.\n\nProvide your final answer as a single closed-form analytic expression for the leading-order low-temperature asymptotic form of $\\delta M(T)$ per unit area for the gapped case, expressed in terms of $g$, $\\mu_{B}$, $D$, $\\Delta$, and $T$. Express the answer in units of magnetic moment per area by leaving $g\\,\\mu_{B}$ explicit. No numerical evaluation is required.", "solution": "### Solution\n\n**(a) Analysis of the Gapless Case ($\\epsilon_{\\mathbf{k}}=Dk^{2}$)**\n\nFor the gapless case, the reduction in magnetization density is given by:\n$$ \\delta M(T) = (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, n_{B}(Dk^{2}) = (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, \\frac{1}{\\exp(Dk^{2}/T) - 1} $$\nWe are asked to analyze the infrared behavior, which corresponds to the behavior of the integral for small wavevectors, i.e., as $k \\to 0$. For any fixed temperature $T>0$, as $k \\to 0$, the argument of the exponential $Dk^{2}/T \\to 0$. In this limit, we can use the Taylor expansion of the exponential function, $\\exp(x) \\approx 1 + x$ for small $x$.\nApplying this to the Bose-Einstein distribution:\n$$ n_{B}(Dk^{2}) = \\frac{1}{\\exp(Dk^{2}/T) - 1} \\approx \\frac{1}{(1 + Dk^{2}/T) - 1} = \\frac{T}{Dk^{2}} \\quad \\text{for } k \\to 0 $$\nThe integral for $\\delta M(T)$ is over the two-dimensional $\\mathbf{k}$-space. It is convenient to switch to polar coordinates, where the differential area element is $d^{2}k = 2\\pi k \\, dk$. The integral becomes:\n$$ \\delta M(T) = \\frac{g\\,\\mu_{B}}{(2\\pi)^2} \\int_{0}^{k_{c}} 2\\pi k \\, dk \\, n_{B}(Dk^{2}) = \\frac{g\\,\\mu_{B}}{2\\pi} \\int_{0}^{k_{c}} k \\, dk \\, \\frac{1}{\\exp(Dk^{2}/T) - 1} $$\nwhere $k_{c}$ is an upper cutoff wavevector, defining the boundary of the long-wavelength regime. The convergence of the integral is determined by its behavior near the lower limit $k=0$. Substituting the small-$k$ approximation for the integrand:\n$$ \\int_{0}^{k_{c}} k \\left(\\frac{T}{Dk^{2}}\\right) dk = \\frac{T}{D} \\int_{0}^{k_{c}} \\frac{1}{k} \\, dk $$\nThis integral is of the form $\\int (1/k) \\, dk = \\ln(k)$. Evaluating it from a small, non-zero lower limit $\\epsilon \\to 0$:\n$$ \\lim_{\\epsilon \\to 0} \\left[ \\ln(k) \\right]_{\\epsilon}^{k_{c}} = \\ln(k_{c}) - \\lim_{\\epsilon \\to 0} \\ln(\\epsilon) $$\nAs $\\epsilon \\to 0$, $\\ln(\\epsilon) \\to -\\infty$. Therefore, the integral diverges logarithmically at the lower limit. This is known as an infrared divergence.\nConsequently, for any finite temperature $T > 0$, the calculated reduction in magnetization $\\delta M(T)$ is infinite. This implies that thermal fluctuations completely destroy the long-range ferromagnetic order, a result consistent with the Mermin-Wagner theorem for two-dimensional systems with continuous symmetries and short-range interactions.\n\n**Conclusion for (a):** $\\delta M(T)$ is divergent for any $T>0$.\n\n**(b) Asymptotic Form for the Gapped Case ($\\epsilon_{\\mathbf{k}}=\\Delta + D k^{2}$)**\n\nFor the gapped case, the magnetization reduction is:\n$$ \\delta M(T) = (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, \\frac{1}{\\exp((\\Delta + D k^{2})/T) - 1} $$\nWe are interested in the low-temperature limit, where $T \\ll \\Delta$. This implies that the ratio $\\Delta/T \\gg 1$.\nThe argument of the Bose-Einstein distribution is $(\\Delta + Dk^2)/T$. Since $\\Delta > 0$, $D > 0$, and $k^2 \\ge 0$, this argument is always greater than or equal to $\\Delta/T$. Given $T \\ll \\Delta$, the argument is always large.\nFor a large argument $x \\gg 1$, the Bose-Einstein distribution can be approximated by neglecting the $-1$ in the denominator compared to the large $\\exp(x)$ term:\n$$ n_{B}(x) = \\frac{1}{\\exp(x) - 1} \\approx \\frac{1}{\\exp(x)} = \\exp(-x) $$\nApplying this approximation to our integral:\n$$ \\delta M(T) \\approx (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, \\exp\\left(-\\frac{\\Delta + D k^{2}}{T}\\right) $$\nWe convert the integral over $\\mathbf{k}$-space to polar coordinates, with $k = |\\mathbf{k}|$ and $d^{2}k = 2\\pi k \\, dk$. The integration range for $k$ is from $0$ to $\\infty$. The contribution from large $k$ is exponentially suppressed, so extending the upper limit to infinity from a finite cutoff $k_c$ does not affect the leading-order asymptotic behavior.\n$$ \\delta M(T) \\approx \\frac{g\\,\\mu_{B}}{(2\\pi)^2} \\int_0^\\infty (2\\pi k \\, dk) \\, \\exp\\left(-\\frac{\\Delta}{T}\\right) \\exp\\left(-\\frac{D k^{2}}{T}\\right) $$\nSimplifying and factoring out the term independent of $k$:\n$$ \\delta M(T) \\approx \\frac{g\\,\\mu_{B}}{2\\pi} \\exp\\left(-\\frac{\\Delta}{T}\\right) \\int_0^\\infty k \\exp\\left(-\\frac{D}{T} k^{2}\\right) dk $$\nThe remaining integral is a standard Gaussian integral. Let us evaluate it. We perform a change of variables. Let $u = \\frac{D}{T} k^{2}$. Then $du = \\frac{2D}{T} k \\, dk$, which gives $k \\, dk = \\frac{T}{2D} du$. The limits of integration for $u$ are from $u(k=0)=0$ to $u(k=\\infty)=\\infty$.\n$$ \\int_0^\\infty k \\exp\\left(-\\frac{D}{T} k^{2}\\right) dk = \\int_0^\\infty \\exp(-u) \\left(\\frac{T}{2D} du\\right) = \\frac{T}{2D} \\int_0^\\infty \\exp(-u) du $$\nThe definite integral $\\int_0^\\infty \\exp(-u) du = [-\\exp(-u)]_0^\\infty = (0) - (-1) = 1$.\nSo, the value of the integral is $\\frac{T}{2D}$.\nSubstituting this result back into the expression for $\\delta M(T)$:\n$$ \\delta M(T) \\approx \\frac{g\\,\\mu_{B}}{2\\pi} \\exp\\left(-\\frac{\\Delta}{T}\\right) \\left(\\frac{T}{2D}\\right) $$\nCombining the terms gives the leading-order asymptotic form for the magnetization reduction in the low-temperature limit:\n$$ \\delta M(T) \\approx \\frac{g\\,\\mu_{B} T}{4\\pi D} \\exp\\left(-\\frac{\\Delta}{T}\\right) $$\nThis expression shows that the magnetization reduction is exponentially suppressed at low temperatures due to the presence of the energy gap $\\Delta$.", "answer": "$$\n\\boxed{\\frac{g \\mu_{B} T}{4 \\pi D} \\exp\\left(-\\frac{\\Delta}{T}\\right)}\n$$", "id": "3017157"}, {"introduction": "Beyond their collective thermodynamic effects, magnons are quasiparticles that propagate through the crystal lattice, interacting with its imperfections. This practice shifts the focus from thermodynamics to dynamics, investigating how magnons scatter elastically from static disorder, a feature of any real material. By applying the Born approximation to calculate the magnon mean free path $\\ell(\\varepsilon)$, you will gain a quantitative understanding of how crystalline defects limit the propagation and lifetime of spin waves [@problem_id:3017115].", "problem": "Consider a three-dimensional nearest-neighbor Heisenberg ferromagnet on a simple cubic lattice with lattice constant $a$, spin length $S$, and uniform exchange $J_0>0$, perturbed by weak quenched exchange disorder. At zero temperature, focus on long-wavelength spin waves (magnons), which may be treated as noninteracting bosonic quasiparticles with dispersion $\\varepsilon_{\\boldsymbol{k}}=\\hbar \\omega_{\\boldsymbol{k}}=D k^2$, where $D$ is the spin-wave stiffness. In the clean limit, for the simple cubic lattice, the stiffness is $D=2 S J_0 a^2$. Assume that weak exchange randomness $\\delta J(\\boldsymbol{r})$ can be coarse-grained into a scalar random potential $V(\\boldsymbol{r})$ that couples to the magnon density as $V(\\boldsymbol{r}) \\psi^{\\dagger}(\\boldsymbol{r}) \\psi(\\boldsymbol{r})$, with $V(\\boldsymbol{r})=2 S z\\, \\delta J(\\boldsymbol{r})$, where $z=6$ is the coordination number. The disorder is Gaussian, static, and $\\delta$-correlated in space, with zero mean and correlator $\\langle \\delta J(\\boldsymbol{r}) \\delta J(\\boldsymbol{r}') \\rangle = \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r}')$, where $\\Delta_J$ is the root-mean-square amplitude of exchange fluctuations. Neglect dipolar interactions, anisotropy gaps, and any inelastic magnon-magnon scattering; work strictly within the harmonic approximation and consider only elastic scattering from the random potential.\n\nUsing the first Born approximation for elastic scattering in three dimensions and assuming an infinite sample, compute the elastic magnon mean free path $\\ell(\\varepsilon)$ at magnon energy $\\varepsilon=\\hbar \\omega$. Your derivation must begin from fundamental principles appropriate to this context, namely: the quadratic magnon dispersion, the group velocity defined by $v(\\varepsilon)=(1/\\hbar)\\, \\partial \\varepsilon_{\\boldsymbol{k}}/\\partial k$, the density of states per unit volume for an isotropic quadratic band in three dimensions, and the Born approximation expression for the elastic scattering rate in terms of the disorder correlator. Express the final answer as a single closed-form analytic expression for $\\ell(\\varepsilon)$ in terms of $J_0$, $\\Delta_J$, $a$, $z$, and fundamental constants, assuming the above coarse-grained mapping between $\\delta J(\\boldsymbol{r})$ and $V(\\boldsymbol{r})$. State clearly the energy dependence and the dependence on the disorder strength. Express your answer in meters when International System of Units (SI) are used for all inputs. Do not substitute numerical values; provide a symbolic result only. The final answer must be a single analytic expression.", "solution": "### Derivation\nThe elastic mean free path $\\ell(\\varepsilon)$ of a quasiparticle is defined as the product of its group velocity $v(\\varepsilon)$ and its elastic scattering lifetime $\\tau(\\varepsilon)$:\n$$ \\ell(\\varepsilon) = v(\\varepsilon) \\tau(\\varepsilon) $$\nWe will compute $v(\\varepsilon)$ and $\\tau(\\varepsilon)$ separately.\n\n**1. Group Velocity, $v(\\varepsilon)$**\nThe group velocity is defined as $v_g = \\frac{1}{\\hbar} \\frac{\\partial \\varepsilon_{\\boldsymbol{k}}}{\\partial k}$. Given the isotropic dispersion relation $\\varepsilon_k = Dk^2$, we have:\n$$ v_k = \\frac{1}{\\hbar} \\frac{\\partial}{\\partial k} (Dk^2) = \\frac{2Dk}{\\hbar} $$\nTo express the velocity as a function of energy $\\varepsilon$, we use the relation $k = \\sqrt{\\varepsilon/D}$. Substituting this into the expression for $v_k$:\n$$ v(\\varepsilon) = \\frac{2D}{\\hbar} \\sqrt{\\frac{\\varepsilon}{D}} = \\frac{2}{\\hbar}\\sqrt{D\\varepsilon} $$\n\n**2. Elastic Scattering Lifetime, $\\tau(\\varepsilon)$**\nThe elastic scattering lifetime is the inverse of the scattering rate, $1/\\tau(\\varepsilon)$. Within the first Born approximation (equivalent to Fermi's Golden Rule), the rate for scattering from an initial state $|\\boldsymbol{k}\\rangle$ to any final state $|\\boldsymbol{k'}\\rangle$ is given by:\n$$ \\frac{1}{\\tau_{\\boldsymbol{k}}} = \\frac{2\\pi}{\\hbar} \\sum_{\\boldsymbol{k'}} \\langle |\\langle\\boldsymbol{k'}|H'|\\boldsymbol{k}\\rangle|^2 \\rangle_{\\text{dis}} \\delta(\\varepsilon_{\\boldsymbol{k'}} - \\varepsilon_{\\boldsymbol{k}}) $$\nwhere $H'$ is the scattering Hamiltonian and $\\langle \\dots \\rangle_{\\text{dis}}$ denotes an average over the disorder ensemble. The scattering potential is $V(\\boldsymbol{r})$, and the matrix element between plane-wave states $|\\boldsymbol{k}\\rangle = (1/\\sqrt{\\mathcal{V}})e^{i\\boldsymbol{k}\\cdot\\boldsymbol{r}}$ (where $\\mathcal{V}$ is the system volume) is:\n$$ \\langle\\boldsymbol{k'}|V|\\boldsymbol{k}\\rangle = \\frac{1}{\\mathcal{V}} \\int d^3r \\, e^{-i\\boldsymbol{k'}\\cdot\\boldsymbol{r}} V(\\boldsymbol{r}) e^{i\\boldsymbol{k}\\cdot\\boldsymbol{r}} = \\frac{1}{\\mathcal{V}} \\tilde{V}(\\boldsymbol{q}) $$\nwhere $\\boldsymbol{q} = \\boldsymbol{k'} - \\boldsymbol{k}$ is the scattering wavevector and $\\tilde{V}(\\boldsymbol{q})$ is the Fourier transform of the potential $V(\\boldsymbol{r})$.\n\nWe need the disorder average of the squared matrix element:\n$$ \\langle |\\langle\\boldsymbol{k'}|V|\\boldsymbol{k}\\rangle|^2 \\rangle_{\\text{dis}} = \\frac{1}{\\mathcal{V}^2} \\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}} $$\nLet's compute $\\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}}$:\n$$ \\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}} = \\left\\langle \\int d^3r \\, e^{-i\\boldsymbol{q}\\cdot\\boldsymbol{r}} V(\\boldsymbol{r}) \\int d^3r' \\, e^{i\\boldsymbol{q}\\cdot\\boldsymbol{r'}} V(\\boldsymbol{r'}) \\right\\rangle_{\\text{dis}} $$\n$$ = \\iint d^3r \\, d^3r' \\, e^{-i\\boldsymbol{q}\\cdot(\\boldsymbol{r}-\\boldsymbol{r'})} \\langle V(\\boldsymbol{r}) V(\\boldsymbol{r'}) \\rangle_{\\text{dis}} $$\nUsing the given relations $V(\\boldsymbol{r}) = 2Sz\\,\\delta J(\\boldsymbol{r})$ and $\\langle \\delta J(\\boldsymbol{r}) \\delta J(\\boldsymbol{r'}) \\rangle = \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r'})$, the potential correlator is:\n$$ \\langle V(\\boldsymbol{r}) V(\\boldsymbol{r'}) \\rangle_{\\text{dis}} = (2Sz)^2 \\langle \\delta J(\\boldsymbol{r}) \\delta J(\\boldsymbol{r'}) \\rangle_{\\text{dis}} = (2Sz)^2 \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r'}) $$\nSubstituting this back into the expression for $\\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}}$:\n$$ \\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}} = \\iint d^3r \\, d^3r' \\, e^{-i\\boldsymbol{q}\\cdot(\\boldsymbol{r}-\\boldsymbol{r'})} (2Sz)^2 \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r'}) $$\n$$ = (2Sz)^2 \\Delta_J^2 a^3 \\int d^3r \\, e^{-i\\boldsymbol{q}\\cdot(\\boldsymbol{r}-\\boldsymbol{r})} = (2Sz)^2 \\Delta_J^2 a^3 \\int d^3r = (2Sz)^2 \\Delta_J^2 a^3 \\mathcal{V} $$\nThe result is independent of $\\boldsymbol{q}$, which is characteristic of a $\\delta$-correlated (white-noise) random potential. Let's denote the constant $(2Sz)^2 \\Delta_J^2 a^3$ as $C_V$.\n\nNow, we can write the scattering rate. We replace the sum over $\\boldsymbol{k'}$ with an integral over the continuum of states: $\\sum_{\\boldsymbol{k'}} \\to \\mathcal{V} \\int \\frac{d^3k'}{(2\\pi)^3}$.\n$$ \\frac{1}{\\tau(\\varepsilon)} = \\frac{2\\pi}{\\hbar} \\mathcal{V} \\int \\frac{d^3k'}{(2\\pi)^3} \\frac{C_V \\mathcal{V}}{\\mathcal{V}^2} \\delta(\\varepsilon_{\\boldsymbol{k'}} - \\varepsilon) $$\n$$ \\frac{1}{\\tau(\\varepsilon)} = \\frac{2\\pi C_V}{\\hbar(2\\pi)^3} \\int d^3k' \\, \\delta(\\varepsilon_{k'} - \\varepsilon) $$\nThe integral is $(2\\pi)^3$ times the density of states per unit volume, $g(\\varepsilon)$.\n$$ \\int d^3k' \\, \\delta(\\varepsilon_{k'} - \\varepsilon) = (2\\pi)^3 g(\\varepsilon) $$\nFor a 3D isotropic quadratic dispersion $\\varepsilon_k=Dk^2$, the density of states per unit volume is:\n$$ g(\\varepsilon) = \\frac{d}{d\\varepsilon} \\left( \\frac{1}{(2\\pi)^3} \\frac{4}{3}\\pi k^3 \\right) = \\frac{d}{d\\varepsilon} \\left( \\frac{1}{6\\pi^2} \\left(\\frac{\\varepsilon}{D}\\right)^{3/2} \\right) = \\frac{1}{6\\pi^2 D^{3/2}} \\frac{3}{2} \\varepsilon^{1/2} = \\frac{\\sqrt{\\varepsilon}}{4\\pi^2 D^{3/2}} $$\nSubstituting this into the expression for the scattering rate:\n$$ \\frac{1}{\\tau(\\varepsilon)} = \\frac{2\\pi C_V}{\\hbar} g(\\varepsilon) = \\frac{2\\pi}{\\hbar} ((2Sz)^2 \\Delta_J^2 a^3) \\left( \\frac{\\sqrt{\\varepsilon}}{4\\pi^2 D^{3/2}} \\right) $$\n$$ \\frac{1}{\\tau(\\varepsilon)} = \\frac{(2Sz)^2 \\Delta_J^2 a^3 \\sqrt{\\varepsilon}}{2\\pi \\hbar D^{3/2}} $$\nSo, the scattering lifetime is:\n$$ \\tau(\\varepsilon) = \\frac{2\\pi \\hbar D^{3/2}}{(2Sz)^2 \\Delta_J^2 a^3 \\sqrt{\\varepsilon}} $$\n\n**3. Mean Free Path, $\\ell(\\varepsilon)$**\nNow we combine the expressions for $v(\\varepsilon)$ and $\\tau(\\varepsilon)$:\n$$ \\ell(\\varepsilon) = v(\\varepsilon) \\tau(\\varepsilon) = \\left( \\frac{2\\sqrt{D\\varepsilon}}{\\hbar} \\right) \\left( \\frac{2\\pi \\hbar D^{3/2}}{(2Sz)^2 \\Delta_J^2 a^3 \\sqrt{\\varepsilon}} \\right) $$\nThe factors of $\\hbar$ and $\\sqrt{\\varepsilon}$ cancel, indicating that the mean free path is independent of energy for this model.\n$$ \\ell = \\frac{4\\pi D^{1/2} D^{3/2}}{(2Sz)^2 \\Delta_J^2 a^3} = \\frac{4\\pi D^2}{4z^2 S^2 \\Delta_J^2 a^3} = \\frac{\\pi D^2}{z^2 S^2 \\Delta_J^2 a^3} $$\nFinally, we substitute the given expression for the spin-wave stiffness, $D = 2 S J_0 a^2$:\n$$ \\ell = \\frac{\\pi (2 S J_0 a^2)^2}{z^2 S^2 \\Delta_J^2 a^3} = \\frac{\\pi (4 S^2 J_0^2 a^4)}{z^2 S^2 \\Delta_J^2 a^3} $$\nThe factors of $S^2$ also cancel. Simplifying the expression, we get:\n$$ \\ell = \\frac{4\\pi J_0^2 a}{z^2 \\Delta_J^2} $$\nThis is the final expression for the elastic mean free path. It is independent of the magnon energy $\\varepsilon$ (a consequence of the $k^2$ dispersion in 3D with $\\delta$-correlated disorder) and also independent of the spin length $S$. The mean free path is inversely proportional to the square of the disorder strength, $\\ell \\propto \\Delta_J^{-2}$, as expected from scattering theory where the scattering cross-section is proportional to the square of the potential strength.", "answer": "$$ \\boxed{\\frac{4\\pi J_{0}^{2} a}{z^{2} \\Delta_{J}^{2}}} $$", "id": "3017115"}, {"introduction": "The theoretical concepts of spin-wave dispersion are not merely abstract; they are directly accessible through powerful experimental techniques like inelastic neutron scattering. This capstone practice bridges the gap between theory and experiment by challenging you to develop a computational tool for data analysis. By fitting a theoretical dispersion model to synthetic scattering data and estimating the underlying exchange constants, you will gain hands-on experience in the essential workflow that connects theory, experiment, and statistical inference in modern condensed matter physics [@problem_id:3017112].", "problem": "You are tasked with building a complete, principled estimator to extract exchange constants from synthetic inelastic neutron scattering data for magnons in ferromagnets, using a first-principles baseline and accounting for instrumental resolution. Your estimator must be implemented as a program that (i) synthesizes measurement data from known ground-truth parameters, (ii) fits model parameters to the synthesized data using a physically grounded weighting derived from instrumental resolution, and (iii) reports uncertainties estimated from the Fisher information. All results must be reported in millielectronvolts (meV), and all trigonometric arguments must be evaluated in radians. The final program must print a single line containing a list of lists of floats as specified under Final Output Format.\n\nThe base of the problem is the quantum Heisenberg ferromagnet with spin $S$ on a Bravais lattice and weak uniaxial anisotropy. The Hamiltonian is\n$$\n\\hat{H} \\;=\\; -\\sum_{\\langle i,j \\rangle} J_{ij}\\,\\hat{\\mathbf{S}}_i\\cdot \\hat{\\mathbf{S}}_j \\;-\\; K\\sum_i \\left(\\hat{S}_i^z\\right)^2,\n$$\nwith exchange constants $J_{ij} \\ge 0$ favoring ferromagnetic alignment and anisotropy $K \\ge 0$. In the linear spin-wave approximation about the ferromagnetic ground state, there is a single-magnon branch with energy $\\epsilon_{\\mathbf{q}}$ and a delta-like dynamical structure factor $S(\\mathbf{q},\\omega)$ concentrated at $\\omega = \\epsilon_{\\mathbf{q}}/\\hbar$. Instrumental resolution of an inelastic neutron spectrometer can be modeled by a Gaussian broadening in both momentum and energy. When scanning in energy $\\omega$ at a fixed nominal wavevector $\\mathbf{q}$, an effective energy width arises from both the intrinsic energy resolution and the dispersion slope via error propagation.\n\nYou must design and implement a procedure that:\n- Constructs the magnon dispersion $\\epsilon_{\\mathbf{q}}$ for a ferromagnet in one spatial dimension (with up to next-nearest-neighbor exchange) and for a two-dimensional square lattice along the $\\Gamma$–$X$ direction (nearest neighbor only), starting from the linear spin-wave framework. The anisotropy introduces a gap $\\Delta$ at $\\mathbf{q}=0$.\n- Synthesizes “measured” peak energies $\\{\\epsilon_i\\}$ at discrete momenta $\\{\\mathbf{q}_i\\}$ and the corresponding dynamical structure factor $S(\\mathbf{q}_i,\\omega)$ as a Gaussian in energy centered at $\\epsilon_i$ with an effective width obtained by propagating instrumental resolutions. For the purposes of this task, you should treat the measured peak positions as the true dispersion values at the sampled momenta, while using the effective widths to define the statistical weights in the parameter estimation.\n- Estimates the unknown exchange constants and anisotropy gap by weighted nonlinear least squares, using the instrumental-resolution-limited effective variance for each point. Use the Fisher information (equivalently, the curvature of the weighted least-squares objective) to estimate one-standard-deviation uncertainties for the fitted parameters.\n- Produces results for each test case as specified and aggregates them into a single-line output.\n\nYour estimator must adhere to the following physical and mathematical specifications:\n\n- Start from the linear spin-wave result that the single-magnon peak in $S(\\mathbf{q},\\omega)$ is centered at the magnon dispersion $\\epsilon_{\\mathbf{q}}$ and that the dispersion is determined by the Fourier transform of exchange couplings in the ferromagnetic phase together with an anisotropy-induced gap $\\Delta$.\n- For a one-dimensional chain with nearest-neighbor spacing $a$ and exchange constants $J_1$ (nearest neighbor) and $J_2$ (next-nearest neighbor), and spin $S$, you must work out the dispersion $\\epsilon_q$ as a function of wavevector $q$ and the momentum derivative $\\partial \\epsilon_q/\\partial q$ needed for uncertainty propagation. The gap $\\Delta$ enters additively in energy units. For the two-dimensional square lattice with only nearest-neighbor exchange $J_1$ along the $\\Gamma$–$X$ path with $q_y = 0$, you must derive the analogous dispersion and slope along this cut.\n- Model the measured dynamical structure factor at each nominal momentum as\n$$\nS(\\mathbf{q}_i,\\omega) \\;=\\; A_i \\exp\\!\\left[-\\frac{\\left(\\omega - \\epsilon_{\\mathbf{q}_i}\\right)^2}{2\\,\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i)^2}\\right],\n$$\nwith a constant amplitude $A_i$ that may be taken as unity, and an effective energy width\n$$\n\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i) \\;=\\; \\sqrt{ \\sigma_\\omega^2 \\;+\\; \\left(\\frac{\\partial \\epsilon_{\\mathbf{q}}}{\\partial q}\\bigg|_{\\mathbf{q}_i}\\right)^2 \\sigma_q^2 }.\n$$\nHere $\\sigma_\\omega$ is the instrument’s energy resolution (in meV), $\\sigma_q$ is the momentum resolution (in inverse ångström), and $\\partial \\epsilon_{\\mathbf{q}}/\\partial q$ is the dispersion slope projected along the scan direction for the one-dimensional cut. Treat $q a$ in radians.\n- Use the effective variances $\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i)^2$ as weights in a weighted nonlinear least-squares fit of model parameters $\\boldsymbol{\\theta}$ to the measured peak energies $\\{\\epsilon_i\\}$. That is, minimize the sum of squared residuals\n$$\n\\chi^2(\\boldsymbol{\\theta}) \\;=\\; \\sum_i \\frac{\\left[ \\epsilon_i - \\epsilon_{\\mathrm{model}}(\\mathbf{q}_i;\\boldsymbol{\\theta}) \\right]^2}{\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i;\\boldsymbol{\\theta})^2},\n$$\ntreating the effective variances as known. You may recompute $\\sigma_{\\mathrm{eff}}$ iteratively using the current parameter estimates during optimization.\n- Estimate parameter uncertainties from the Fisher information matrix\n$$\n\\mathcal{I}(\\boldsymbol{\\theta}^\\star) \\;=\\; \\mathbf{J}(\\boldsymbol{\\theta}^\\star)^\\top \\mathbf{W}(\\boldsymbol{\\theta}^\\star) \\mathbf{J}(\\boldsymbol{\\theta}^\\star),\n$$\nwhere $\\mathbf{J}$ is the Jacobian of the unweighted model $\\epsilon_{\\mathrm{model}}(\\mathbf{q}_i;\\boldsymbol{\\theta})$ with respect to the parameters, evaluated at the best-fit parameters $\\boldsymbol{\\theta}^\\star$, and $\\mathbf{W}$ is the diagonal weight matrix with entries $1/\\sigma_{\\mathrm{eff}}^2$. Report one-standard-deviation uncertainties as the square roots of the diagonal elements of $\\mathcal{I}^{-1}$.\n\nTest Suite. Implement and solve the following three test cases. For each case, synthesize data using the provided ground-truth parameters and then estimate the parameters via your procedure.\n\n- Case 1 (One-dimensional chain, nearest neighbor only):\n  - Spin $S = 1$.\n  - Lattice spacing $a = 2.7$ ångström.\n  - Ground truth: $J_1 = 3.2$ meV, $\\Delta = 0.35$ meV.\n  - Instrumental resolutions: $\\sigma_q = 0.03$ ångström$^{-1}$, $\\sigma_\\omega = 0.12$ meV.\n  - Sampling: wavevectors $q$ uniformly in $[0.0, 1.0]$ ångström$^{-1}$ with step $0.05$ ångström$^{-1}$.\n  - Unknowns to fit and report: $J_1$ and $\\Delta$.\n- Case 2 (One-dimensional chain with next-nearest neighbor):\n  - Spin $S = 1$.\n  - Lattice spacing $a = 3.0$ ångström.\n  - Ground truth: $J_1 = 2.8$ meV, $J_2 = 0.6$ meV, $\\Delta = 0.20$ meV.\n  - Instrumental resolutions: $\\sigma_q = 0.02$ ångström$^{-1}$, $\\sigma_\\omega = 0.08$ meV.\n  - Sampling: wavevectors $q$ uniformly in $[0.0, 0.9]$ ångström$^{-1}$ with step $0.03$ ångström$^{-1}$.\n  - Unknowns to fit and report: $J_1$, $J_2$, and $\\Delta$.\n- Case 3 (Two-dimensional square lattice along $\\Gamma$–$X$, nearest neighbor only):\n  - Spin $S = 1$.\n  - Lattice spacing $a = 3.1$ ångström.\n  - Ground truth: $J_1 = 5.0$ meV, $\\Delta = 0.40$ meV.\n  - Instrumental resolutions: $\\sigma_q = 0.04$ ångström$^{-1}$, $\\sigma_\\omega = 0.15$ meV.\n  - Sampling: wavevectors along the $\\Gamma$–$X$ path with $q_x$ uniformly in $[0.0, 0.8]$ ångström$^{-1}$ with step $0.04$ ångström$^{-1}$ and $q_y = 0$.\n  - Unknowns to fit and report: $J_1$ and $\\Delta$.\n\nAngle convention and units:\n- Always evaluate trigonometric functions using $q a$ in radians.\n- All exchange constants $J_1$, $J_2$ and the gap $\\Delta$ are in meV.\n- Momentum $q$ is in ångström$^{-1}$.\n- Instrument resolutions $\\sigma_q$ and $\\sigma_\\omega$ are in ångström$^{-1}$ and meV, respectively.\n\nFinal Output Format:\n- For Case 1, output the list $[J_1,\\Delta,\\sigma_{J_1},\\sigma_{\\Delta}]$.\n- For Case 2, output the list $[J_1,J_2,\\Delta,\\sigma_{J_1},\\sigma_{J_2},\\sigma_{\\Delta}]$.\n- For Case 3, output the list $[J_1,\\Delta,\\sigma_{J_1},\\sigma_{\\Delta}]$.\n- Your program should produce a single line of output containing a list of the three case-specific lists, with all numbers rounded to three decimal places, as a comma-separated list enclosed in square brackets. For example:\n  - \"[[case1_vals],[case2_vals],[case3_vals]]\"\n- No additional text should be printed.\n\nYour implementation must be deterministic and must not use any external inputs. Do not add random noise to the synthetic data; only incorporate instrumental resolution through the effective widths as specified. Use radians for all trigonometric arguments and report all energies in meV rounded to three decimals.", "solution": "### Part 1: Theoretical Model Derivation\n\nThe analysis begins with the Heisenberg Hamiltonian including a uniaxial anisotropy term:\n$$\n\\hat{H} = -\\sum_{\\langle i,j \\rangle} J_{ij}\\,\\hat{\\mathbf{S}}_i\\cdot \\hat{\\mathbf{S}}_j - K\\sum_i \\left(\\hat{S}_i^z\\right)^2\n$$\nWithin the linear spin-wave approximation, the magnon dispersion relation $\\epsilon_{\\mathbf{q}}$ for a Bravais lattice can be derived. The standard result, obtained via the Holstein-Primakoff transformation and retaining terms quadratic in the boson operators, is:\n$$\n\\epsilon_{\\mathbf{q}} = \\Delta + 2S \\left[ J(\\mathbf{0}) - J(\\mathbf{q}) \\right]\n$$\nHere, $J(\\mathbf{q}) = \\sum_{\\mathbf{R}} J_{\\mathbf{R}} e^{i\\mathbf{q}\\cdot\\mathbf{R}}$ is the Fourier transform of the exchange interactions $J_{ij} = J(\\mathbf{R}_i - \\mathbf{R}_j)$. The term $\\Delta$ is an energy gap at $\\mathbf{q}=\\mathbf{0}$, which originates from the symmetry-breaking anisotropy term. The standard result for the exchange contribution is $\\epsilon_{\\mathbf{q}}^{\\text{exch}} = 2S(J(\\mathbf{0}) - \\text{Re}[J(\\mathbf{q})])$. For a 1D chain with NN and NNN interactions, this gives $\\epsilon_q = 4SJ_1(1-\\cos(qa)) + 4SJ_2(1-\\cos(2qa))$.\n\nWith these principles, we derive the specific dispersion relations and their slopes required for the test cases.\n\n**Case 1 & 3: 1D Chain and 2D Square Lattice ($\\Gamma-X$) with Nearest-Neighbor (NN) Interaction**\nFor a 1D chain with lattice spacing $a$ and NN exchange $J_1$, and for a 2D square lattice along the $\\Gamma-X$ path ($q_y=0, q_x=q$), both systems have the same functional form for the dispersion along the specified path for NN interactions. Given spin $S=1$, the model is:\n$$\n\\epsilon(q; J_1, \\Delta) = \\Delta + 4 J_1 (1 - \\cos(qa))\n$$\nThe derivative with respect to the wavevector $q$, required for the effective resolution calculation, is:\n$$\n\\frac{\\partial\\epsilon}{\\partial q} = 4 J_1 a \\sin(qa)\n$$\n\n**Case 2: 1D Chain with Next-Nearest-Neighbor (NNN) Interaction**\nThe model includes both NN exchange $J_1$ (at distance $a$) and NNN exchange $J_2$ (at distance $2a$). With $S=1$:\n$$\n\\epsilon(q; J_1, J_2, \\Delta) = \\Delta + 4 J_1 (1 - \\cos(qa)) + 4 J_2 (1 - \\cos(2qa))\n$$\nThe corresponding dispersion slope is:\n$$\n\\frac{\\partial\\epsilon}{\\partial q} = 4 J_1 a \\sin(qa) + 8 J_2 a \\sin(2qa)\n$$\n\n### Part 2: Parameter Estimation and Uncertainty Quantification\n\nThe estimation procedure is based on weighted non-linear least squares. We aim to find the parameters $\\boldsymbol{\\theta}$ that minimize the chi-squared function:\n$$\n\\chi^2(\\boldsymbol{\\theta}) = \\sum_i \\frac{\\left[ \\epsilon_i - \\epsilon_{\\mathrm{model}}(\\mathbf{q}_i;\\boldsymbol{\\theta}) \\right]^2}{\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i;\\boldsymbol{\\theta})^2}\n$$\nThe data points $\\{\\epsilon_i\\}$ are synthesized using the ground-truth parameters without added noise: $\\epsilon_i = \\epsilon_{\\mathrm{model}}(\\mathbf{q}_i; \\boldsymbol{\\theta}_{\\text{true}})$. The statistical weights are derived from the effective energy variance $\\sigma_{\\mathrm{eff}}^2$.\n\nSince the weights $w_i = 1/\\sigma_{\\mathrm{eff}}^2$ depend on the model parameters $\\boldsymbol{\\theta}$ through the dispersion slope $\\partial\\epsilon/\\partial q$, an Iteratively Reweighted Least Squares (IRLS) procedure is employed.\n\n1.  **Initialization**: Start with an initial guess for the parameters, $\\boldsymbol{\\theta}_0$.\n2.  **Iteration**: For step $k=0, 1, 2, \\dots$:\n    a.  Calculate the dispersion slope $\\frac{\\partial\\epsilon}{\\partial q}(\\mathbf{q}_i; \\boldsymbol{\\theta}_k)$ for each momentum point.\n    b.  Compute the effective standard deviation $\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i; \\boldsymbol{\\theta}_k) = \\sqrt{\\sigma_\\omega^2 + \\left(\\frac{\\partial\\epsilon}{\\partial q}\\right)^2 \\sigma_q^2}$.\n    c.  Solve the weighted least-squares problem for $\\boldsymbol{\\theta}_{k+1}$ using the weights $w_i = 1/\\sigma_{\\mathrm{eff}}^2(\\mathbf{q}_i; \\boldsymbol{\\theta}_k)$. This is achieved using `scipy.optimize.curve_fit`.\n3.  **Convergence**: The loop terminates when the parameter estimates converge.\n\nUpon convergence to the best-fit parameters $\\boldsymbol{\\theta}^\\star$, the parameter uncertainties are estimated. The `curve_fit` function, when used with `absolute_sigma=True`, returns the covariance matrix $\\mathbf{C} = \\mathcal{I}^{-1}$, where $\\mathcal{I}$ is the Fisher information matrix. The one-standard-deviation uncertainty for parameter $\\theta_j$ is given by $\\sigma_j = \\sqrt{C_{jj}} = \\sqrt{(\\mathcal{I}^{-1})_{jj}}$.\n\n### Part 3: Implementation for Test Cases\n\nA Python program is constructed to implement this entire workflow for each of the three specified test cases.\n\n-   A generic solver function encapsulates the IRLS procedure and uncertainty calculation.\n-   The specific physical models and their derivatives are defined as separate functions.\n-   For each case, the appropriate model, ground-truth parameters, and instrumental/sampling parameters are supplied to the solver.\n-   The initial guess for all parameters in the fitting procedure is set to $1.0$. Since the synthetic data is noise-free, the fit is expected to converge precisely to the ground-truth values. The non-trivial part of the calculation lies in the determination of the uncertainties.\n-   The final results for each case are collected, formatted to three decimal places, and printed as a single-line list of lists, strictly adhering to the specified output format.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom functools import partial\n\n# --- Part 1: Physical Models and Derivatives ---\n\n# For cases 1 and 3 (NN model on 1D chain or Gamma-X in 2D)\ndef model_nn(q, J1, Delta, S, a):\n    \"\"\"Magnon dispersion for NN model.\"\"\"\n    return Delta + 4 * S * J1 * (1 - np.cos(q * a))\n\ndef slope_nn(q, J1, Delta, S, a):\n    \"\"\"Dispersion slope for NN model. Delta is a dummy arg for signature matching.\"\"\"\n    return 4 * S * J1 * a * np.sin(q * a)\n\n# For case 2 (NNN model on 1D chain)\ndef model_nnn(q, J1, J2, Delta, S, a):\n    \"\"\"Magnon dispersion for NNN model.\"\"\"\n    return Delta + 4 * S * J1 * (1 - np.cos(q * a)) + 4 * S * J2 * (1 - np.cos(2 * q * a))\n\ndef slope_nnn(q, J1, J2, Delta, S, a):\n    \"\"\"Dispersion slope for NNN model. Delta is a dummy arg for signature matching.\"\"\"\n    return 4 * S * J1 * a * np.sin(q * a) + 8 * S * J2 * a * np.sin(2 * q * a)\n\n# --- Part 2: Parameter Estimation ---\n\ndef estimate_parameters(q_data, model_func, slope_func, true_params, sigma_q, sigma_omega, p0):\n    \"\"\"\n    Synthesizes data and fits parameters using Iteratively Reweighted Least Squares.\n    \n    Args:\n        q_data (np.array): Array of wavevectors.\n        model_func (callable): The dispersion model function f(q, *params).\n        slope_func (callable): The dispersion slope function df/dq(q, *params).\n        true_params (list): Ground-truth parameters for data synthesis.\n        sigma_q (float): Momentum resolution.\n        sigma_omega (float): Energy resolution.\n        p0 (list): Initial guess for parameters.\n\n    Returns:\n        tuple: (best_fit_params, uncertainties)\n    \"\"\"\n    # Synthesize \"measured\" data using ground-truth parameters (no noise)\n    epsilon_data = model_func(q_data, *true_params)\n    \n    p_k = np.array(p0, dtype=float)\n    \n    # Iteratively Reweighted Least Squares (IRLS) loop\n    for _ in range(15):  # 15 iterations is more than sufficient for convergence\n        p_prev = p_k.copy()\n        \n        # Calculate weights based on current parameter estimates\n        slope_k = slope_func(q_data, *p_k)\n        sigma_eff_k = np.sqrt(sigma_omega**2 + (slope_k**2) * sigma_q**2)\n        # Prevent division by zero if sigma_eff is ever zero.\n        sigma_eff_k[sigma_eff_k  1e-12] = 1e-12\n        \n        # Perform weighted non-linear least squares fit\n        try:\n            popt, _ = curve_fit(model_func, q_data, epsilon_data, p0=p_k, sigma=sigma_eff_k, absolute_sigma=True)\n            p_k = popt\n        except RuntimeError:\n            # Fit failed, break with last good parameters\n            p_k = p_prev  # Revert to previous\n            break\n\n        # Check for convergence\n        if np.allclose(p_k, p_prev, rtol=1e-9, atol=1e-9):\n            break\n            \n    # Final fit at converged parameters to get the covariance matrix\n    p_final = p_k\n    slope_final = slope_func(q_data, *p_final)\n    sigma_eff_final = np.sqrt(sigma_omega**2 + (slope_final**2) * sigma_q**2)\n    sigma_eff_final[sigma_eff_final  1e-12] = 1e-12\n\n    popt, pcov = curve_fit(model_func, q_data, epsilon_data, p0=p_final, sigma=sigma_eff_final, absolute_sigma=True)\n    \n    # Uncertainties are the sqrt of the diagonal of the covariance matrix\n    perr = np.sqrt(np.diag(pcov))\n    \n    return popt, perr\n\ndef solve():\n    \"\"\"\n    Main function to solve the specified test cases and print the results.\n    \"\"\"\n    # --- Part 3: Test Suite ---\n    \n    # Case 1: 1D chain, NN\n    case1 = {\n        'S': 1.0, 'a': 2.7,\n        'true_params': [3.2, 0.35],  # [J1, Delta]\n        'p0': [1.0, 1.0],\n        'sigma_q': 0.03, 'sigma_omega': 0.12,\n        'q_range': (0.0, 1.0, 21), # start, stop, num_points\n        'model': model_nn, 'slope': slope_nn,\n        'num_params': 2\n    }\n\n    # Case 2: 1D chain, NNN\n    case2 = {\n        'S': 1.0, 'a': 3.0,\n        'true_params': [2.8, 0.6, 0.20],  # [J1, J2, Delta]\n        'p0': [1.0, 1.0, 1.0],\n        'sigma_q': 0.02, 'sigma_omega': 0.08,\n        'q_range': (0.0, 0.9, 31),\n        'model': model_nnn, 'slope': slope_nnn,\n        'num_params': 3\n    }\n    \n    # Case 3: 2D square lattice, NN, Gamma-X\n    case3 = {\n        'S': 1.0, 'a': 3.1,\n        'true_params': [5.0, 0.40], # [J1, Delta]\n        'p0': [1.0, 1.0],\n        'sigma_q': 0.04, 'sigma_omega': 0.15,\n        'q_range': (0.0, 0.8, 21),\n        'model': model_nn, 'slope': slope_nn,\n        'num_params': 2\n    }\n\n    test_cases = [case1, case2, case3]\n    all_results = []\n\n    for case in test_cases:\n        # Generate q-vector\n        q_start, q_stop, q_num = case['q_range']\n        q_data = np.linspace(q_start, q_stop, int(np.round((q_stop - q_start) / (q_stop / (q_num - 1))) + 1))\n        if case['q_range'] == (0.0, 1.0, 21): # Case 1 has step 0.05\n            q_data = np.arange(0.0, 1.0 + 1e-9, 0.05)\n        elif case['q_range'] == (0.0, 0.9, 31): # Case 2 has step 0.03\n            q_data = np.arange(0.0, 0.9 + 1e-9, 0.03)\n        elif case['q_range'] == (0.0, 0.8, 21): # Case 3 has step 0.04\n            q_data = np.arange(0.0, 0.8 + 1e-9, 0.04)\n\n        # Create model and slope functions with fixed S and a\n        model = partial(case['model'], S=case['S'], a=case['a'])\n        slope = partial(case['slope'], S=case['S'], a=case['a'])\n        \n        # Estimate parameters and uncertainties\n        popt, perr = estimate_parameters(\n            q_data, model, slope,\n            case['true_params'], case['sigma_q'], case['sigma_omega'], case['p0']\n        )\n        \n        # Format results as [param1, param2, ..., err1, err2, ...]\n        result_list = list(popt) + list(perr)\n        all_results.append(result_list)\n\n    # Final printing in the exact required format\n    formatted_case_results = []\n    for res_list in all_results:\n        formatted_vals = [f\"{val:.3f}\" for val in res_list]\n        formatted_case_results.append(f\"[{','.join(formatted_vals)}]\")\n    \n    print(f\"[[{formatted_case_results[0][1:-1]}],[{formatted_case_results[1][1:-1]}],[{formatted_case_results[2][1:-1]}]]\")\n\nif __name__ == '__main__':\n    # This block is a guard against execution when the script is imported.\n    # The actual execution happens in the environment calling this script.\n    # The `solve()` function contains the logic. A direct call is simulated here for clarity.\n    solve()\n```", "id": "3017112"}]}