{"hands_on_practices": [{"introduction": "To begin our practical exploration, we start with the fundamental quantum description of photon-phonon coupling. This exercise [@problem_id:3010576] tasks you with diagonalizing the Hopfield Hamiltonian to derive the polariton dispersion relations. By subsequently calculating the group velocity and effective mass, you will treat the polariton as a new quasiparticle and characterize its essential properties, which are crucial for understanding energy transport and the dynamics of these hybrid light-matter states.", "problem": "Consider a three-dimensional, non-magnetic polar insulator characterized by a high-frequency dielectric constant $\\varepsilon_{\\infty}$ and a single, dispersionless transverse optical phonon of angular frequency $\\omega_{0}$. Electromagnetic waves in this medium have a photon-like dispersion $\\omega_{\\mathrm{c}}(k) = v\\,k$, where $v = c/\\sqrt{\\varepsilon_{\\infty}}$ and $c$ is the speed of light in vacuum. The photon field couples to the optical phonon through the electric dipole interaction, which, in the long-wavelength limit and under the Rotating-Wave Approximation (RWA), can be modeled by the Hopfield-like Hamiltonian\n$$\n\\hat{H} = \\hbar\\,\\omega_{\\mathrm{c}}(k)\\,\\hat{a}_{k}^{\\dagger}\\hat{a}_{k} + \\hbar\\,\\omega_{0}\\,\\hat{b}_{k}^{\\dagger}\\hat{b}_{k} + \\hbar\\,g\\left(\\hat{a}_{k}^{\\dagger}\\hat{b}_{k} + \\hat{b}_{k}^{\\dagger}\\hat{a}_{k}\\right),\n$$\nwhere $\\hat{a}_{k}$ and $\\hat{b}_{k}$ are the annihilation operators for the photon-like and phonon-like normal modes, respectively, and $g$ is a real-valued light-matter coupling rate (with units of angular frequency).\n\nStarting from the above Hamiltonian, and using only well-established principles of electrodynamics in media and quantum harmonic oscillators:\n1. Diagonalize the Hamiltonian to obtain the coupled normal-mode angular frequencies $\\omega_{\\pm}(k)$ of the polariton branches.\n2. Derive the group velocity $v_{g}^{-}(k) = \\mathrm{d}\\omega_{-}(k)/\\mathrm{d}k$ of the lower polariton branch at the resonance wavevector $k_{0}$ defined implicitly by $\\omega_{\\mathrm{c}}(k_{0}) = \\omega_{0}$.\n3. Define the local effective mass of the lower polariton branch at $k_{0}$ by $E(k) = \\hbar\\,\\omega_{-}(k)$ and $m_{*}^{-}(k_{0})$ via the curvature relation $m_{*}^{-}(k_{0})^{-1} = \\left(1/\\hbar^{2}\\right)\\,\\left.\\mathrm{d}^{2}E/\\mathrm{d}k^{2}\\right|_{k_{0}}$, and obtain a closed-form expression for $m_{*}^{-}(k_{0})$ in terms of $v$ and $g$.\n4. Assuming impurity-dominated momentum relaxation characterized by a $k$-independent scattering time $\\tau$ for the lower polariton near $k_{0}$, compute the mean free path $\\ell = v_{g}^{-}(k_{0})\\,\\tau$.\n\nFor the final numerical evaluation, use $v = 9.0\\times 10^{7}\\,\\mathrm{m/s}$, $\\omega_{0} = 4.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $g = 6.0\\times 10^{12}\\,\\mathrm{s}^{-1}$, and $\\tau = 1.0\\times 10^{-12}\\,\\mathrm{s}$. Round your answer to three significant figures. Express the mean free path $\\ell$ in meters (m). Provide only the value of $\\ell$ as your final answer.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The problem describes the formation of phonon-polaritons from the coupling of photons and transverse optical phonons in a polar insulator. The Hamiltonian provided is the standard Hopfield model for two coupled quantum harmonic oscillators, which is the correct theoretical framework for this phenomenon. All definitions, including those for group velocity and effective mass, are standard in condensed matter physics. The given parameters are physically plausible for a typical polar semiconductor. The tasks are logically structured and lead to a computable result. The problem is therefore deemed valid. The solution proceeds by executing the four requested tasks sequentially.\n\nThe Hamiltonian for the coupled photon-phonon system is given by:\n$$\n\\hat{H} = \\hbar\\,\\omega_{\\mathrm{c}}(k)\\,\\hat{a}_{k}^{\\dagger}\\hat{a}_{k} + \\hbar\\,\\omega_{0}\\,\\hat{b}_{k}^{\\dagger}\\hat{b}_{k} + \\hbar\\,g\\left(\\hat{a}_{k}^{\\dagger}\\hat{b}_{k} + \\hat{b}_{k}^{\\dagger}\\hat{a}_{k}\\right)\n$$\nwhere $\\omega_{\\mathrm{c}}(k) = v\\,k$. This Hamiltonian acts on the basis of single-excitation states, which can be represented as $|n_{\\mathrm{photon}}, n_{\\mathrm{phonon}}\\rangle = |1_{k}, 0_{k}\\rangle$ for a single photon and no phonons, and $|0_{k}, 1_{k}\\rangle$ for a single phonon and no photons. In this basis, the Hamiltonian can be written as a $2 \\times 2$ matrix:\n$$\n\\mathbf{H}_{k} = \\begin{pmatrix} \\langle 1_{k}, 0_{k} | \\hat{H} | 1_{k}, 0_{k} \\rangle  \\langle 1_{k}, 0_{k} | \\hat{H} | 0_{k}, 1_{k} \\rangle \\\\ \\langle 0_{k}, 1_{k} | \\hat{H} | 1_{k}, 0_{k} \\rangle  \\langle 0_{k}, 1_{k} | \\hat{H} | 0_{k}, 1_{k} \\rangle \\end{pmatrix} = \\hbar \\begin{pmatrix} \\omega_{\\mathrm{c}}(k)  g \\\\ g  \\omega_{0} \\end{pmatrix}\n$$\n\n1. Diagonalization of the Hamiltonian to find the polariton frequencies $\\omega_{\\pm}(k)$.\nThe eigenvalues of the Hamiltonian matrix are the energies $E$ of the coupled modes, or polaritons. They are found by solving the secular equation $\\det(\\mathbf{H}_{k} - E\\mathbf{I}) = 0$. Writing $E = \\hbar\\omega$, we have:\n$$\n\\det\\begin{pmatrix} \\hbar\\omega_{\\mathrm{c}}(k) - \\hbar\\omega  \\hbar g \\\\ \\hbar g  \\hbar\\omega_{0} - \\hbar\\omega \\end{pmatrix} = 0\n$$\n$$\n(\\omega_{\\mathrm{c}}(k) - \\omega)(\\omega_{0} - \\omega) - g^2 = 0\n$$\nExpanding this gives a quadratic equation for the eigenfrequencies $\\omega$:\n$$\n\\omega^2 - (\\omega_{\\mathrm{c}}(k) + \\omega_{0})\\omega + (\\omega_{\\mathrm{c}}(k)\\omega_{0} - g^2) = 0\n$$\nSolving for $\\omega$ using the quadratic formula yields the two polariton branches, the upper polariton $\\omega_{+}(k)$ and the lower polariton $\\omega_{-}(k)$:\n$$\n\\omega_{\\pm}(k) = \\frac{\\omega_{\\mathrm{c}}(k) + \\omega_{0}}{2} \\pm \\sqrt{\\left(\\frac{\\omega_{\\mathrm{c}}(k) + \\omega_{0}}{2}\\right)^{2} - (\\omega_{\\mathrm{c}}(k)\\omega_{0} - g^2)}\n$$\n$$\n\\omega_{\\pm}(k) = \\frac{\\omega_{\\mathrm{c}}(k) + \\omega_{0}}{2} \\pm \\sqrt{\\frac{\\omega_{\\mathrm{c}}(k)^2 + 2\\omega_{\\mathrm{c}}(k)\\omega_{0} + \\omega_{0}^2 - 4\\omega_{\\mathrm{c}}(k)\\omega_{0} + 4g^2}{4}}\n$$\n$$\n\\omega_{\\pm}(k) = \\frac{\\omega_{\\mathrm{c}}(k) + \\omega_{0}}{2} \\pm \\sqrt{\\frac{(\\omega_{\\mathrm{c}}(k) - \\omega_{0})^2}{4} + g^2} = \\frac{\\omega_{\\mathrm{c}}(k) + \\omega_{0}}{2} \\pm \\sqrt{\\left(\\frac{\\omega_{\\mathrm{c}}(k) - \\omega_{0}}{2}\\right)^2 + g^2}\n$$\n\n2. Derivation of the group velocity $v_{g}^{-}(k_{0})$ of the lower polariton branch.\nThe lower polariton branch is given by:\n$$\n\\omega_{-}(k) = \\frac{\\omega_{\\mathrm{c}}(k) + \\omega_{0}}{2} - \\sqrt{\\left(\\frac{\\omega_{\\mathrm{c}}(k) - \\omega_{0}}{2}\\right)^2 + g^2}\n$$\nThe group velocity is defined as $v_{g}^{-}(k) = \\mathrm{d}\\omega_{-}(k)/\\mathrm{d}k$. Using $\\omega_{\\mathrm{c}}(k) = v\\,k$, its derivative is $\\mathrm{d}\\omega_{\\mathrm{c}}/\\mathrm{d}k = v$.\nDifferentiating $\\omega_{-}(k)$ with respect to $k$:\n$$\nv_{g}^{-}(k) = \\frac{d\\omega_{-}}{dk} = \\frac{1}{2}\\frac{d\\omega_{\\mathrm{c}}}{dk} - \\frac{1}{2\\sqrt{\\left(\\frac{\\omega_{c}(k) - \\omega_{0}}{2}\\right)^2 + g^2}} \\cdot 2\\left(\\frac{\\omega_{c}(k) - \\omega_{0}}{2}\\right) \\cdot \\left(\\frac{1}{2}\\frac{d\\omega_{c}}{dk}\\right)\n$$\n$$\nv_{g}^{-}(k) = \\frac{v}{2} - \\frac{\\frac{\\omega_{c}(k) - \\omega_{0}}{2} \\cdot \\frac{v}{2}}{\\sqrt{\\left(\\frac{\\omega_{c}(k) - \\omega_{0}}{2}\\right)^2 + g^2}} = \\frac{v}{2} \\left[1 - \\frac{\\frac{\\omega_{c}(k) - \\omega_{0}}{2}}{\\sqrt{\\left(\\frac{\\omega_{c}(k) - \\omega_{0}}{2}\\right)^2 + g^2}}\\right]\n$$\nWe need to evaluate this at the resonance wavevector $k_{0}$, which is defined by the condition $\\omega_{\\mathrm{c}}(k_{0}) = v\\,k_{0} = \\omega_{0}$. At this point, the term $\\omega_{\\mathrm{c}}(k_{0}) - \\omega_{0} = 0$.\n$$\nv_{g}^{-}(k_{0}) = \\frac{v}{2} \\left[1 - \\frac{0}{\\sqrt{0^2 + g^2}}\\right] = \\frac{v}{2}\n$$\n\n3. Calculation of the effective mass $m_{*}^{-}(k_{0})$.\nThe effective mass is defined by the curvature of the energy band:\n$$\n\\frac{1}{m_{*}^{-}(k_{0})} = \\frac{1}{\\hbar^{2}}\\left.\\frac{\\mathrm{d}^{2}E}{\\mathrm{d}k^{2}}\\right|_{k_{0}} = \\frac{1}{\\hbar}\\left.\\frac{\\mathrm{d}^{2}\\omega_{-}}{\\mathrm{d}k^{2}}\\right|_{k_{0}}\n$$\nWe must find the second derivative of $\\omega_{-}(k)$. This is the derivative of $v_{g}^{-}(k)$:\n$$\n\\frac{\\mathrm{d}^{2}\\omega_{-}}{\\mathrm{d}k^{2}} = \\frac{\\mathrm{d}}{\\mathrm{d}k}v_{g}^{-}(k) = \\frac{\\mathrm{d}}{\\mathrm{d}k} \\left\\{ \\frac{v}{2} \\left[1 - \\frac{\\omega_{c}(k) - \\omega_{0}}{2\\sqrt{\\left(\\frac{\\omega_{c}(k) - \\omega_{0}}{2}\\right)^2 + g^2}}\\right] \\right\\}\n$$\nLet's differentiate the term in the brackets. Let $X(k) = (\\omega_{c}(k) - \\omega_{0})/2$. Then $\\mathrm{d}X/\\mathrm{d}k = v/2$.\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}k}\\left(\\frac{X}{\\sqrt{X^2 + g^2}}\\right) = \\frac{\\mathrm{d}X}{\\mathrm{d}k} \\frac{\\mathrm{d}}{\\mathrm{d}X}\\left(\\frac{X}{\\sqrt{X^2 + g^2}}\\right) = \\frac{v}{2} \\left[ \\frac{\\sqrt{X^2+g^2} - X(X/\\sqrt{X^2+g^2})}{X^2+g^2} \\right]\n$$\n$$\n= \\frac{v}{2} \\left[ \\frac{(X^2+g^2) - X^2}{(X^2+g^2)^{3/2}} \\right] = \\frac{v}{2} \\frac{g^2}{(X^2+g^2)^{3/2}}\n$$\nSo, the second derivative is:\n$$\n\\frac{\\mathrm{d}^{2}\\omega_{-}}{\\mathrm{d}k^{2}} = -\\frac{v}{4} \\frac{\\mathrm{d}}{\\mathrm{d}k}\\left(\\frac{\\omega_c(k) - \\omega_{0}}{\\sqrt{\\left(\\frac{\\omega_{c}(k) - \\omega_{0}}{2}\\right)^2 + g^2}}\\right) = -\\frac{v}{2} \\cdot \\frac{v}{2} \\frac{g^2}{\\left(\\left(\\frac{\\omega_c(k) - \\omega_{0}}{2}\\right)^2 + g^2\\right)^{3/2}}\n$$\n$$\n\\frac{\\mathrm{d}^{2}\\omega_{-}}{\\mathrm{d}k^{2}} = -\\frac{v^2 g^2}{4\\left(\\left(\\frac{\\omega_c(k) - \\omega_{0}}{2}\\right)^2 + g^2\\right)^{3/2}}\n$$\nEvaluating at $k=k_{0}$, where $\\omega_{\\mathrm{c}}(k_0) - \\omega_0 = 0$:\n$$\n\\left.\\frac{\\mathrm{d}^{2}\\omega_{-}}{\\mathrm{d}k^{2}}\\right|_{k_{0}} = -\\frac{v^2 g^2}{4(0 + g^2)^{3/2}} = -\\frac{v^2 g^2}{4|g|^3}\n$$\nSince $g$ is a real-valued rate, we can assume $g0$, so $|g|=g$.\n$$\n\\left.\\frac{\\mathrm{d}^{2}\\omega_{-}}{\\mathrm{d}k^{2}}\\right|_{k_{0}} = -\\frac{v^2}{4g}\n$$\nThe inverse effective mass is then:\n$$\n\\frac{1}{m_{*}^{-}(k_{0})} = \\frac{1}{\\hbar} \\left(-\\frac{v^2}{4g}\\right) = -\\frac{v^2}{4\\hbar g}\n$$\nTherefore, the effective mass of the lower polariton at resonance is:\n$$\nm_{*}^{-}(k_{0}) = -\\frac{4\\hbar g}{v^2}\n$$\n\n4. Computation of the mean free path $\\ell$.\nThe problem specifies the mean free path as $\\ell = v_{g}^{-}(k_{0})\\,\\tau$.\nUsing the result from Part 2, $v_{g}^{-}(k_{0}) = v/2$, we get:\n$$\n\\ell = \\frac{v}{2}\\tau\n$$\nNote that this expression for $\\ell$ does not depend on the coupling strength $g$ or the phonon frequency $\\omega_0$. These parameters were necessary for the calculation of the effective mass in Part 3, but are not needed for the final answer.\nWe are given the numerical values:\n$v = 9.0 \\times 10^{7}\\,\\mathrm{m/s}$\n$\\tau = 1.0 \\times 10^{-12}\\,\\mathrm{s}$\nSubstituting these values:\n$$\n\\ell = \\frac{9.0 \\times 10^{7}\\,\\mathrm{m/s}}{2} \\times 1.0 \\times 10^{-12}\\,\\mathrm{s}\n$$\n$$\n\\ell = (4.5 \\times 10^{7}\\,\\mathrm{m/s}) \\times (1.0 \\times 10^{-12}\\,\\mathrm{s})\n$$\n$$\n\\ell = 4.5 \\times 10^{-5}\\,\\mathrm{m}\n$$\nThe problem requests the answer to be rounded to $3$ significant figures.\n$$\n\\ell = 4.50 \\times 10^{-5}\\,\\mathrm{m}\n$$", "answer": "$$\\boxed{4.50 \\times 10^{-5}}$$", "id": "3010576"}, {"introduction": "Having characterized the polariton at the quantum level, we now shift to a macroscopic perspective to see how these quasiparticles manifest in an optical experiment. This practice [@problem_id:3010573] guides you through modeling the infrared reflectivity of a polar crystal by combining the Lorentz oscillator model for the dielectric function with Fresnel's equations. Implementing this model computationally allows you to predict and visualize the famous Reststrahlen band, a key experimental signature of phonon-polaritons.", "problem": "Consider a semi-infinite polar insulating crystal occupying $z \\ge 0$, interfaced with vacuum for $z  0$. The crystal hosts a single infrared (IR) active optical phonon that couples to the electromagnetic field and produces photon-phonon polaritons. You are asked to derive and implement the reflectivity at the vacuum-crystal interface using Fresnel analysis based on first principles. \n\nStarting only from the following bases:\n- Maxwell’s equations in matter together with the constitutive relations $\\mathbf{D} = \\varepsilon_0 \\mathbf{E} + \\mathbf{P}$ and $\\mathbf{B} = \\mu_0 \\mathbf{H}$.\n- A Lorentz oscillator description of the IR-active lattice polarization with a single resonance at the transverse optical (TO) phonon frequency, i.e., the driven damped harmonic oscillator equation of motion for the ionic displacement.\n- The applicability of boundary conditions at a planar interface ensuring continuity of tangential $\\mathbf{E}$ and $\\mathbf{H}$ fields, and Snell’s law generalized to complex refractive indices.\n\nYour task is to:\n1. Derive the complex, frequency-dependent dielectric function $\\varepsilon(\\omega)$ of the crystal in terms of the high-frequency dielectric constant $\\varepsilon_\\infty$, the transverse optical phonon angular frequency $\\omega_{\\mathrm{TO}}$, the longitudinal optical phonon angular frequency $\\omega_{\\mathrm{LO}}$, and the damping rate $\\gamma$. Use the Lorentz oscillator model for the lattice polarization and impose the longitudinal optical (LO) condition associated with zeros of $\\varepsilon(\\omega)$ in the lossless limit to express the response in a form consistent with the Lyddane–Sachs–Teller relation.\n2. Derive the Fresnel reflection amplitude coefficients for $s$-polarization (transverse electric) and $p$-polarization (transverse magnetic) at the vacuum-crystal interface for an arbitrary real incidence angle $\\theta_1$ in vacuum, taking into account a complex refractive index of the crystal $n_2(\\omega) = \\sqrt{\\varepsilon(\\omega)}$. The vacuum refractive index is $n_1 = 1$. Define the reflectivity $R$ as the squared modulus of the corresponding reflection amplitude.\n3. Implement these derivations in a program that computes the reflectivity for a specified set of test cases. The transmitted angle $\\theta_2$ inside the crystal must be obtained via the generalized Snell’s law $n_1 \\sin \\theta_1 = n_2 \\sin \\theta_2$, choosing the branch of $\\cos \\theta_2$ consistent with energy not radiating to infinity inside an absorbing medium.\n\nPhysical units and output requirements:\n- All angular frequencies must be expressed and handled in $\\mathrm{rad/s}$.\n- All angles must be expressed and handled in radians.\n- Reflectivity is dimensionless and must be returned as a floating-point number.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, following the order specified in the test suite.\n\nUse the following fixed material parameters for all test cases:\n- High-frequency dielectric constant: $\\varepsilon_\\infty = 5.0$.\n- Transverse optical phonon angular frequency: $\\omega_{\\mathrm{TO}} = 6.0 \\times 10^{13}\\ \\mathrm{rad/s}$.\n- Longitudinal optical phonon angular frequency: $\\omega_{\\mathrm{LO}} = 1.0 \\times 10^{14}\\ \\mathrm{rad/s}$.\n- Damping rate: $\\gamma = 5.0 \\times 10^{11}\\ \\mathrm{s^{-1}}$.\n- Speed of light: $c = 2.99792458 \\times 10^8\\ \\mathrm{m/s}$ (if needed in intermediate steps; it does not appear explicitly in the final Fresnel interface formulas).\n\nDefine polarization selector $p_{\\mathrm{sel}}$ as $0$ for $s$-polarization and $1$ for $p$-polarization.\n\nTest suite (provide outputs in the exact order below):\n- Case 1 (general case, below resonance): Compute reflectivity $R$ at $\\omega = 3.0 \\times 10^{13}\\ \\mathrm{rad/s}$, $\\theta_1 = 0$ (normal incidence), $p_{\\mathrm{sel}} = 0$.\n- Case 2 (inside Reststrahlen band): Compute $R$ at $\\omega = 8.0 \\times 10^{13}\\ \\mathrm{rad/s}$, $\\theta_1 = 0$, $p_{\\mathrm{sel}} = 0$.\n- Case 3 (above LO): Compute $R$ at $\\omega = 1.5 \\times 10^{14}\\ \\mathrm{rad/s}$, $\\theta_1 = 0$, $p_{\\mathrm{sel}} = 0$.\n- Case 4 (oblique incidence, $s$): Compute $R$ at $\\omega = 1.5 \\times 10^{14}\\ \\mathrm{rad/s}$, $\\theta_1 = \\pi/4$, $p_{\\mathrm{sel}} = 0$.\n- Case 5 (near Brewster-like incidence in the weakly absorbing high-frequency regime, $p$): Compute $R$ at $\\omega = 1.5 \\times 10^{14}\\ \\mathrm{rad/s}$, $\\theta_1 = \\arctan\\!\\left(\\sqrt{\\varepsilon_\\infty}\\right)$, $p_{\\mathrm{sel}} = 1$.\n- Case 6 (at TO resonance): Compute $R$ at $\\omega = \\omega_{\\mathrm{TO}}$, $\\theta_1 = 0$, $p_{\\mathrm{sel}} = 0$.\n- Case 7 (at LO frequency): Compute $R$ at $\\omega = \\omega_{\\mathrm{LO}}$, $\\theta_1 = 0$, $p_{\\mathrm{sel}} = 0$.\n- Case 8 (Lyddane–Sachs–Teller check): Return a boolean value indicating whether $\\left|\\frac{\\varepsilon(0)}{\\varepsilon_\\infty} - \\left(\\frac{\\omega_{\\mathrm{LO}}}{\\omega_{\\mathrm{TO}}}\\right)^2\\right|  10^{-9}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order: $[R_1, R_2, R_3, R_4, R_5, R_6, R_7, \\text{LST\\_check}]$.", "solution": "The problem requires the derivation of the reflectivity at a vacuum-crystal interface, accounting for photon-phonon coupling in the crystal. The solution is structured in three parts: first, a derivation of the crystal's dielectric function $\\varepsilon(\\omega)$ from the Lorentz oscillator model; second, the derivation of the Fresnel reflection coefficients; and third, the implementation of these formulas to compute reflectivity for specific cases.\n\n### Part 1: Derivation of the Dielectric Function $\\varepsilon(\\omega)$\n\nWe begin by modeling the response of the infrared (IR) active optical phonons in the polar crystal to an external electric field $\\mathbf{E}$. The ionic displacement $\\mathbf{w}$ relative to the equilibrium positions can be described by the equation of a driven, damped harmonic oscillator:\n$$ M(\\ddot{\\mathbf{w}} + \\gamma \\dot{\\mathbf{w}} + \\omega_{\\mathrm{TO}}^2 \\mathbf{w}) = q^* \\mathbf{E} $$\nHere, $M$ is the reduced mass of the ion pair, $q^*$ is the effective ionic charge, $\\gamma$ is the phenomenological damping rate, and $\\omega_{\\mathrm{TO}}$ is the natural resonance frequency, corresponding to the transverse optical (TO) phonon frequency.\n\nAssuming a harmonic time dependence for the fields, $\\mathbf{E}(t) = \\mathbf{E}_0 e^{-i\\omega t}$ and $\\mathbf{w}(t) = \\mathbf{w}_0 e^{-i\\omega t}$, the equation of motion becomes algebraic:\n$$ M(-\\omega^2 - i\\omega\\gamma + \\omega_{\\mathrm{TO}}^2) \\mathbf{w} = q^* \\mathbf{E} $$\nSolving for the displacement $\\mathbf{w}$:\n$$ \\mathbf{w} = \\frac{q^*/M}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} \\mathbf{E} $$\nThis displacement creates a lattice polarization $\\mathbf{P}_{\\text{ion}} = N \\mathbf{p} = N q^* \\mathbf{w}$, where $N$ is the density of ion pairs:\n$$ \\mathbf{P}_{\\text{ion}} = \\frac{N (q^*)^2 / M}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} \\mathbf{E} $$\nThe total dielectric displacement $\\mathbf{D}$ is given by the constitutive relation $\\mathbf{D} = \\varepsilon_0 \\mathbf{E} + \\mathbf{P}$, where $\\varepsilon_0$ is the vacuum permittivity. The total polarization $\\mathbf{P}$ has two contributions: the ionic polarization $\\mathbf{P}_{\\text{ion}}$ and the electronic polarization $\\mathbf{P}_{\\text{elec}}$, which arises from the distortion of electron clouds. At frequencies far above the phonon resonance ($\\omega \\gg \\omega_{\\mathrm{TO}}$), the ions cannot respond, so only the electronic part contributes. In this limit, the dielectric function is the high-frequency dielectric constant $\\varepsilon_\\infty$, so $\\mathbf{D} = \\varepsilon_0 \\varepsilon_\\infty \\mathbf{E}$. This implies $\\mathbf{P}_{\\text{elec}} = \\varepsilon_0(\\varepsilon_\\infty - 1)\\mathbf{E}$.\n\nThe total displacement is therefore $\\mathbf{D} = \\varepsilon_0\\mathbf{E} + \\mathbf{P}_{\\text{elec}} + \\mathbf{P}_{\\text{ion}} = \\varepsilon_0\\varepsilon_\\infty\\mathbf{E} + \\mathbf{P}_{\\text{ion}}$. We define the frequency-dependent dielectric function $\\varepsilon(\\omega)$ via $\\mathbf{D} = \\varepsilon_0 \\varepsilon(\\omega) \\mathbf{E}$. Comparing these expressions gives:\n$$ \\varepsilon_0 \\varepsilon(\\omega) \\mathbf{E} = \\varepsilon_0 \\varepsilon_\\infty \\mathbf{E} + \\frac{N (q^*)^2 / M}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} \\mathbf{E} $$\n$$ \\varepsilon(\\omega) = \\varepsilon_\\infty + \\frac{N (q^*)^2 / (M \\varepsilon_0)}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} $$\nTo express this in terms of the given parameters, we must determine the oscillator strength term. The problem instructs us to use the longitudinal optical (LO) phonon condition, which states that for longitudinal modes, $\\varepsilon(\\omega_{\\mathrm{LO}}) = 0$ in the lossless limit ($\\gamma = 0$).\n\nIn the lossless limit, the dielectric function is:\n$$ \\varepsilon(\\omega) = \\varepsilon_\\infty + \\frac{S \\omega_{\\mathrm{TO}}^2}{\\omega_{\\mathrm{TO}}^2 - \\omega^2} $$\nwhere we have defined an oscillator strength parameter $S \\omega_{\\mathrm{TO}}^2 = N (q^*)^2 / (M \\varepsilon_0)$. Applying the condition $\\varepsilon(\\omega_{\\mathrm{LO}}) = 0$:\n$$ 0 = \\varepsilon_\\infty + \\frac{S \\omega_{\\mathrm{TO}}^2}{\\omega_{\\mathrm{TO}}^2 - \\omega_{\\mathrm{LO}}^2} \\implies S \\omega_{\\mathrm{TO}}^2 = -\\varepsilon_\\infty(\\omega_{\\mathrm{TO}}^2 - \\omega_{\\mathrm{LO}}^2) = \\varepsilon_\\infty(\\omega_{\\mathrm{LO}}^2 - \\omega_{\\mathrm{TO}}^2) $$\nSubstituting this back into the full damped expression for $\\varepsilon(\\omega)$:\n$$ \\varepsilon(\\omega) = \\varepsilon_\\infty + \\frac{\\varepsilon_\\infty(\\omega_{\\mathrm{LO}}^2 - \\omega_{\\mathrm{TO}}^2)}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} $$\nThis is the required formula for the dielectric function. As a check, we can evaluate this at $\\omega=0$ to find the static dielectric constant $\\varepsilon_s = \\varepsilon(0)$:\n$$ \\varepsilon_s = \\varepsilon_\\infty + \\frac{\\varepsilon_\\infty(\\omega_{\\mathrm{LO}}^2 - \\omega_{\\mathrm{TO}}^2)}{\\omega_{\\mathrm{TO}}^2} = \\varepsilon_\\infty \\left(1 + \\frac{\\omega_{\\mathrm{LO}}^2}{\\omega_{\\mathrm{TO}}^2} - 1\\right) = \\varepsilon_\\infty \\left(\\frac{\\omega_{\\mathrm{LO}}}{\\omega_{\\mathrm{TO}}}\\right)^2 $$\nThis yields the Lyddane-Sachs-Teller (LST) relation: $\\varepsilon_s/\\varepsilon_\\infty = (\\omega_{\\mathrm{LO}}/\\omega_{\\mathrm{TO}})^2$.\n\n### Part 2: Fresnel Reflection Coefficients\n\nWe consider a plane wave incident from vacuum (medium 1, refractive index $n_1=1$) onto the crystal (medium 2, complex refractive index $n_2(\\omega) = \\sqrt{\\varepsilon(\\omega)}$). The angle of incidence in vacuum is $\\theta_1$. The angle of transmission into the crystal is $\\theta_2$.\n\nThe relationship between angles is given by the generalized Snell's law: $n_1 \\sin\\theta_1 = n_2 \\sin\\theta_2$. With $n_1=1$:\n$$ \\sin\\theta_2 = \\frac{\\sin\\theta_1}{n_2(\\omega)} $$\nWe need $\\cos\\theta_2 = \\sqrt{1 - \\sin^2\\theta_2}$.\n$$ \\cos\\theta_2 = \\sqrt{1 - \\frac{\\sin^2\\theta_1}{n_2^2(\\omega)}} = \\frac{\\sqrt{n_2^2(\\omega) - \\sin^2\\theta_1}}{n_2(\\omega)} = \\frac{\\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}}{n_2(\\omega)} $$\nThe wave propagating into medium 2 has a spatial dependence of the form $e^{i k_{2z} z}$. For the wave to be physically realistic (i.e., not growing infinitely inside an absorbing medium), its amplitude must decay with increasing $z$. This requires the z-component of the wavevector, $k_{2z} = k_2 \\cos\\theta_2 = \\frac{\\omega}{c} n_2 \\cos\\theta_2$, to have a non-negative imaginary part: $\\text{Im}(k_{2z}) \\ge 0$.\n$$ k_{2z} = \\frac{\\omega}{c} \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1} $$\nThus, we must choose the branch of the complex square root such that $\\text{Im}(\\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}) \\ge 0$.\n\nThe Fresnel amplitude reflection coefficients $r$ are given for the electric field components. For $s$-polarization (TE, E-field perpendicular to the plane of incidence):\n$$ r_s = \\frac{n_1 \\cos\\theta_1 - n_2 \\cos\\theta_2}{n_1 \\cos\\theta_1 + n_2 \\cos\\theta_2} = \\frac{\\cos\\theta_1 - \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}}{\\cos\\theta_1 + \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}} $$\nFor $p$-polarization (TM, E-field parallel to the plane of incidence):\n$$ r_p = \\frac{n_2 \\cos\\theta_1 - n_1 \\cos\\theta_2}{n_2 \\cos\\theta_1 + n_1 \\cos\\theta_2} = \\frac{\\varepsilon(\\omega)\\cos\\theta_1 - \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}}{\\varepsilon(\\omega)\\cos\\theta_1 + \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}} $$\nThe reflectivity $R$ is the squared modulus of the reflection coefficient: $R_s = |r_s|^2$ and $R_p = |r_p|^2$.\n\nFor normal incidence ($\\theta_1 = 0$), these simplify. We have $\\cos\\theta_1=1$ and $\\sin\\theta_1=0$.\n$$ r_s = r_p = \\frac{1 - \\sqrt{\\varepsilon(\\omega)}}{1 + \\sqrt{\\varepsilon(\\omega)}} = \\frac{1 - n_2(\\omega)}{1 + n_2(\\omega)} $$\nThe reflectivity is $R = \\left|\\frac{1 - n_2(\\omega)}{1 + n_2(\\omega)}\\right|^2$.\n\n### Part 3: Implementation Strategy\n\nThe implementation will follow the derived formulas.\n1. A function calculates $\\varepsilon(\\omega)$ using the derived expression for any given angular frequency $\\omega$.\n2. For a specified set of input parameters ($\\omega$, $\\theta_1$, $p_{\\mathrm{sel}}$), the program computes the reflectivity.\n3. For normal incidence ($\\theta_1=0$), the simplified formula is used. The complex refractive index $n_2(\\omega) = \\sqrt{\\varepsilon(\\omega)}$ is computed, ensuring the principal root (positive real and imaginary parts for a passive medium) is taken.\n4. For oblique incidence ($\\theta_1 > 0$), the quantity $Y = \\varepsilon(\\omega) - \\sin^2\\theta_1$ is calculated. Its square root, $\\sqrt{Y}$, is computed and its sign is adjusted if necessary to ensure its imaginary part is non-negative, satisfying the physical condition for a decaying wave. The appropriate Fresnel coefficient ($r_s$ or $r_p$) is then computed.\n5. The reflectivity $R$ is calculated as the squared absolute value of the complex reflection coefficient.\n6. For the LST check, $\\varepsilon(0)$ is computed using the general formula with $\\omega=0$, and the result is compared against the LST prediction within a small tolerance.\nThe program structure will process each test case and format the results into the required output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes reflectivity for a vacuum-crystal interface and performs LST check.\n    The crystal's dielectric function is modeled using a Lorentz oscillator\n    accounting for photon-phonon coupling.\n    \"\"\"\n    # Fixed material parameters\n    eps_inf = 5.0\n    w_TO = 6.0e13  # rad/s\n    w_LO = 1.0e14  # rad/s\n    gamma = 5.0e11 # s^-1\n\n    params = {\n        'eps_inf': eps_inf,\n        'w_TO': w_TO,\n        'w_LO': w_LO,\n        'gamma': gamma\n    }\n\n    def get_epsilon(omega, p):\n        \"\"\"Calculates the complex dielectric function epsilon(omega).\"\"\"\n        w_sq = omega**2\n        w_TO_sq = p['w_TO']**2\n        w_LO_sq = p['w_LO']**2\n        \n        numerator = p['eps_inf'] * (w_LO_sq - w_TO_sq)\n        denominator = w_TO_sq - w_sq - 1j * omega * p['gamma']\n        \n        return p['eps_inf'] + numerator / denominator\n\n    def get_reflectivity(omega, theta1, p_sel, p):\n        \"\"\"\n        Calculates reflectivity R for s- or p-polarization.\n        p_sel = 0 for s-polarization, 1 for p-polarization.\n        \"\"\"\n        epsilon = get_epsilon(omega, p)\n\n        if np.isclose(theta1, 0):\n            # Normal incidence\n            n2 = np.sqrt(epsilon)\n            # Principal root of sqrt for complex has Re(n2) = 0.\n            # For a passive medium, Im(epsilon) = 0, which implies Im(n2) = 0.\n            # So, the principal root is the correct one.\n            r = (1.0 - n2) / (1.0 + n2)\n            return np.abs(r)**2\n\n        # Oblique incidence\n        cos_theta1 = np.cos(theta1)\n        sin_theta1_sq = np.sin(theta1)**2\n\n        # Calculate sqrt(epsilon - sin^2(theta1))\n        # The branch must be chosen such that the wave decays into the medium,\n        # which means Im(k_z) = 0. k_z is proportional to this square root.\n        # Thus, we need Im(sqrt_term) = 0.\n        sqrt_term_arg = epsilon - sin_theta1_sq\n        sqrt_term = np.sqrt(sqrt_term_arg)\n        if np.imag(sqrt_term)  0:\n            sqrt_term = -sqrt_term\n\n        if p_sel == 0:  # s-polarization\n            r = (cos_theta1 - sqrt_term) / (cos_theta1 + sqrt_term)\n        else:  # p-polarization\n            r = (epsilon * cos_theta1 - sqrt_term) / (epsilon * cos_theta1 + sqrt_term)\n        \n        return np.abs(r)**2\n\n    test_cases = [\n        # Case 1: general case, below resonance\n        {'omega': 3.0e13, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 2: inside Reststrahlen band\n        {'omega': 8.0e13, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 3: above LO\n        {'omega': 1.5e14, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 4: oblique incidence, s-pol\n        {'omega': 1.5e14, 'theta1': np.pi/4, 'p_sel': 0, 'type': 'R'},\n        # Case 5: near Brewster-like incidence, p-pol\n        {'omega': 1.5e14, 'theta1': np.arctan(np.sqrt(eps_inf)), 'p_sel': 1, 'type': 'R'},\n        # Case 6: at TO resonance\n        {'omega': w_TO, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 7: at LO frequency\n        {'omega': w_LO, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 8: Lyddane–Sachs–Teller check\n        {'type': 'LST'}\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'R':\n            result = get_reflectivity(case['omega'], case['theta1'], case['p_sel'], params)\n            results.append(f\"{result:.10f}\")\n        elif case['type'] == 'LST':\n            # Calculate epsilon(0) using the general function\n            epsilon_0 = get_epsilon(0.0, params)\n            \n            # The LST relation is derived from the oscillator model, so it should be exact.\n            # The check is whether the implementation of epsilon(omega) fulfills the LST relation.\n            ratio_eps = epsilon_0 / params['eps_inf']\n            ratio_w_sq = (params['w_LO'] / params['w_TO'])**2\n            \n            lst_check_val = np.abs(ratio_eps - ratio_w_sq)  1e-9\n            results.append(str(lst_check_val))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3010573"}, {"introduction": "To complete our hands-on journey, we will now tackle the inverse problem: extracting fundamental material parameters from experimental data. This final exercise [@problem_id:3010575] challenges you to develop a method to determine a crystal's dielectric properties from its measured polariton dispersion curve. By algebraically reformulating the polariton secular equation into a linear form suitable for regression, you will practice a critical skill for any physicist: using theoretical models to interpret experimental results and extract meaningful physical constants.", "problem": "You are tasked with extracting dielectric parameters of a polar crystal from experimentally measured photon-phonon polariton dispersion. The fundamental base of this problem is the electrodynamics of waves in a homogeneous, isotropic medium and the Lorentz oscillator model of the dielectric function for a single polar transverse optical phonon. In a homogeneous medium, plane-wave solutions of Maxwell’s equations imply the dispersion relation between the angular frequency and wavevector magnitude, given by the relation $$c^2 k^2 = \\omega^2 \\varepsilon(\\omega),$$ where $c$ is the speed of light in vacuum, $k$ is the wavevector magnitude, and $\\varepsilon(\\omega)$ is the frequency-dependent dielectric function. For a polar crystal with one infrared-active transverse optical phonon in the lossless limit, the dielectric function can be modeled by the Lorentz oscillator leading to $$\\varepsilon(\\omega) = \\varepsilon_\\infty \\frac{\\omega_L^2 - \\omega^2}{\\omega_T^2 - \\omega^2},$$ where $\\varepsilon_\\infty$ is the high-frequency dielectric constant, $\\omega_T$ is the transverse optical (TO) phonon angular frequency, and $\\omega_L$ is the longitudinal optical (LO) phonon angular frequency. These relations are well-tested and physically realistic in the regime of negligible damping.\n\nYou are given sets of measured polariton frequencies that correspond to the two branches at each wavevector $k$: the lower-branch angular frequency $\\omega_-(k)$ and the upper-branch angular frequency $\\omega_+(k)$. Starting only from the fundamental base stated above, derive a principled estimation method to determine the three dielectric parameters $\\varepsilon_\\infty$, $\\omega_T$, and $\\omega_L$ from the measured pairs $(\\omega_-(k), \\omega_+(k))$ at multiple values of $k$. Your derivation must use the stated base, be logically complete, and avoid any shortcut formulas not directly justified from the base.\n\nImplement this estimation method as a complete, runnable program. The program must:\n- Use the speed of light $c = 2.99792458 \\times 10^8$ m/s.\n- For each test case, generate synthetic measured data by exactly solving the stated lossless polariton dispersion for given parameter sets and wavevectors $k$.\n- Apply your derived estimation method to the synthetic measured data to recover $\\varepsilon_\\infty$, $\\omega_T$, and $\\omega_L$.\n- Express $\\omega_T$ and $\\omega_L$ in radians per second (rad/s). Express $\\varepsilon_\\infty$ as a dimensionless number. Round each reported number to six significant figures.\n\nTest suite:\n- Test Case A (happy path): $\\varepsilon_\\infty = 5.0$, $\\omega_T = 1.5 \\times 10^{13}$ rad/s, $\\omega_L = 1.8 \\times 10^{13}$ rad/s; $k$ values in m$^{-1}$: $[0.0, 1.5 \\times 10^5, 2.5 \\times 10^5, 3.0 \\times 10^5]$.\n- Test Case B (boundary condition includes $k=0$): $\\varepsilon_\\infty = 2.5$, $\\omega_T = 0.8 \\times 10^{13}$ rad/s, $\\omega_L = 1.0 \\times 10^{13}$ rad/s; $k$ values in m$^{-1}$: $[0.0, 1.0 \\times 10^5, 1.8 \\times 10^5, 3.0 \\times 10^5]$.\n- Test Case C (edge case with large $\\varepsilon_\\infty$ and no $k=0$): $\\varepsilon_\\infty = 10.0$, $\\omega_T = 2.2 \\times 10^{13}$ rad/s, $\\omega_L = 2.5 \\times 10^{13}$ rad/s; $k$ values in m$^{-1}$: $[5.0 \\times 10^4, 2.0 \\times 10^5, 6.0 \\times 10^5]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is a list of the three recovered parameters $[\\varepsilon_\\infty,\\omega_T,\\omega_L]$, in SI units and rounded to six significant figures. For example, $[[e_A,t_A,l_A],[e_B,t_B,l_B],[e_C,t_C,l_C]]$. No other output is allowed.", "solution": "The objective is to derive a principled method for estimating the dielectric parameters $\\varepsilon_\\infty$ (high-frequency dielectric constant), $\\omega_T$ (transverse optical phonon angular frequency), and $\\omega_L$ (longitudinal optical phonon angular frequency) from measured polariton dispersion data. The derivation will be based solely on the provided fundamental relations.\n\nThe fundamental relations given are:\n1. The dispersion relation for electromagnetic waves in a medium:\n$$c^2 k^2 = \\omega^2 \\varepsilon(\\omega)$$\nwhere $c$ is the speed of light in vacuum, $k$ is the wavevector magnitude, $\\omega$ is the angular frequency, and $\\varepsilon(\\omega)$ is the frequency-dependent dielectric function.\n\n2. The Lorentz oscillator model for the dielectric function of a polar crystal with a single, lossless transverse optical phonon:\n$$\\varepsilon(\\omega) = \\varepsilon_\\infty \\frac{\\omega_L^2 - \\omega^2}{\\omega_T^2 - \\omega^2}$$\n\nOur goal is to find $\\varepsilon_\\infty$, $\\omega_T$, and $\\omega_L$ from a set of measured data points $(\\omega_-(k_i), \\omega_+(k_i))$, which represent the lower and upper polariton branches at various wavevectors $k_i$.\n\nFirst, we combine the two fundamental equations to obtain the secular equation for the polariton modes. Substituting the expression for $\\varepsilon(\\omega)$ into the dispersion relation gives:\n$$c^2 k^2 = \\omega^2 \\left( \\varepsilon_\\infty \\frac{\\omega_L^2 - \\omega^2}{\\omega_T^2 - \\omega^2} \\right)$$\nTo find the frequencies $\\omega$ that satisfy this equation for a given $k$, we rearrange the equation. We multiply both sides by $(\\omega_T^2 - \\omega^2)$ to clear the denominator, assuming $\\omega \\neq \\omega_T$:\n$$c^2 k^2 (\\omega_T^2 - \\omega^2) = \\varepsilon_\\infty \\omega^2 (\\omega_L^2 - \\omega^2)$$\nExpanding both sides of the equation yields:\n$$c^2 k^2 \\omega_T^2 - c^2 k^2 \\omega^2 = \\varepsilon_\\infty \\omega_L^2 \\omega^2 - \\varepsilon_\\infty \\omega^4$$\nThis equation can be rearranged into a standard polynomial form. Let's group terms by powers of $\\omega$:\n$$\\varepsilon_\\infty \\omega^4 - \\varepsilon_\\infty \\omega_L^2 \\omega^2 - c^2 k^2 \\omega^2 + c^2 k^2 \\omega_T^2 = 0$$\n$$\\varepsilon_\\infty \\omega^4 - (\\varepsilon_\\infty \\omega_L^2 + c^2 k^2) \\omega^2 + c^2 k^2 \\omega_T^2 = 0$$\nThis is a quadratic equation in terms of $\\omega^2$. Let us define a new variable $x = \\omega^2$. The equation becomes:\n$$\\varepsilon_\\infty x^2 - (\\varepsilon_\\infty \\omega_L^2 + c^2 k^2) x + c^2 k^2 \\omega_T^2 = 0$$\nFor any given value of $k$, the two solutions for $x$, let's call them $x_-$ and $x_+$, correspond to the squares of the angular frequencies of the lower and upper polariton branches, i.e., $x_- = \\omega_-^2(k)$ and $x_+ = \\omega_+^2(k)$.\n\nTo establish a method for finding the unknown parameters $\\varepsilon_\\infty$, $\\omega_T$, and $\\omega_L$, we can use Vieta's formulas, which relate the coefficients of a polynomial to the sums and products of its roots. For a general quadratic equation $ax^2 + bx + c_{quad} = 0$ with roots $x_1$ and $x_2$, the formulas are:\n$$x_1 + x_2 = -b/a$$\n$$x_1 x_2 = c_{quad}/a$$\n\nApplying these formulas to our quadratic equation for $x = \\omega^2$, we identify the coefficients:\n$a = \\varepsilon_\\infty$\n$b = -(\\varepsilon_\\infty \\omega_L^2 + c^2 k^2)$\n$c_{quad} = c^2 k^2 \\omega_T^2$\n\nThe sum of the roots is:\n$$\\omega_-^2(k) + \\omega_+^2(k) = - \\frac{-(\\varepsilon_\\infty \\omega_L^2 + c^2 k^2)}{\\varepsilon_\\infty} = \\frac{\\varepsilon_\\infty \\omega_L^2 + c^2 k^2}{\\varepsilon_\\infty} = \\omega_L^2 + \\frac{c^2}{\\varepsilon_\\infty} k^2$$\nThe product of the roots is:\n$$\\omega_-^2(k) \\cdot \\omega_+^2(k) = \\frac{c^2 k^2 \\omega_T^2}{\\varepsilon_\\infty}$$\n\nThese two derived relations form the basis of our estimation method. They transform the non-linear dispersion problem into two linear relationships with respect to $k^2$.\n\nLet's analyze the first relation. We can define new variables from experimental data: $Y(k) = \\omega_-^2(k) + \\omega_+^2(k)$ and $X(k) = k^2$. The relation becomes:\n$$Y(k) = \\left(\\frac{c^2}{\\varepsilon_\\infty}\\right) X(k) + \\omega_L^2$$\nThis is the equation of a straight line, $Y = m_1 X + b_1$. By performing a linear regression on the experimental data points $(X_i, Y_i) = (k_i^2, \\omega_-^2(k_i) + \\omega_+^2(k_i))$, we can determine the slope $m_1$ and the y-intercept $b_1$. From these fitted values, we can extract two of the unknown parameters:\nThe slope is $m_1 = \\frac{c^2}{\\varepsilon_\\infty}$, which allows us to determine $\\varepsilon_\\infty$:\n$$\\varepsilon_\\infty = \\frac{c^2}{m_1}$$\nThe y-intercept is $b_1 = \\omega_L^2$, which directly gives us $\\omega_L$:\n$$\\omega_L = \\sqrt{b_1}$$\n\nNow, let's analyze the second relation involving the product of the roots. We define another variable from data: $Z(k) = \\omega_-^2(k) \\cdot \\omega_+^2(k)$. The relation is:\n$$Z(k) = \\left(\\frac{c^2 \\omega_T^2}{\\varepsilon_\\infty}\\right) X(k)$$\nThis is the equation of a straight line passing through the origin, $Z = m_2 X$. We can perform a second linear regression on the data points $(X_i, Z_i) = (k_i^2, \\omega_-^2(k_i) \\cdot \\omega_+^2(k_i))$ to find the slope $m_2$.\nThe slope is $m_2 = \\frac{c^2 \\omega_T^2}{\\varepsilon_\\infty}$. We can use this to find the final unknown parameter, $\\omega_T$:\n$$\\omega_T^2 = \\frac{m_2 \\varepsilon_\\infty}{c^2}$$\nSubstituting the expression we found for $\\varepsilon_\\infty = c^2/m_1$:\n$$\\omega_T^2 = \\frac{m_2 (c^2/m_1)}{c^2} = \\frac{m_2}{m_1}$$\nThus, $\\omega_T$ can be determined as:\n$$\\omega_T = \\sqrt{\\frac{m_2}{m_1}}$$\n\nThis completes the derivation of the estimation method. The procedure is as follows:\n1. For each experimental data point $(k_i, \\omega_-(k_i), \\omega_+(k_i))$, calculate three values: $X_i = k_i^2$, $Y_i = \\omega_-^2(k_i) + \\omega_+^2(k_i)$, and $Z_i = \\omega_-^2(k_i) \\cdot \\omega_+^2(k_i)$.\n2. Perform a linear least-squares fit on the set of points $(X_i, Y_i)$ to find the slope $m_1$ and intercept $b_1$.\n3. Perform a linear least-squares fit on the set of points $(X_i, Z_i)$ to find the slope $m_2$.\n4. Calculate the dielectric parameters using the formulas:\n    - $\\varepsilon_\\infty = c^2/m_1$\n    - $\\omega_L = \\sqrt{b_1}$\n    - $\\omega_T = \\sqrt{m_2/m_1}$\n\nThis method is principled as it is derived directly from the fundamental equations and employs a standard statistical technique (linear regression) to determine the parameters from a set of measurements, which may be overdetermined.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives dielectric parameters from synthetic polariton dispersion data.\n    \"\"\"\n    # Define the speed of light in vacuum (m/s)\n    C = 2.99792458e8\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A (happy path)\n        (5.0, 1.5e13, 1.8e13, [0.0, 1.5e5, 2.5e5, 3.0e5]),\n        # Test Case B (boundary condition includes k=0)\n        (2.5, 0.8e13, 1.0e13, [0.0, 1.0e5, 1.8e5, 3.0e5]),\n        # Test Case C (edge case with large eps_inf and no k=0)\n        (10.0, 2.2e13, 2.5e13, [5.0e4, 2.0e5, 6.0e5]),\n    ]\n\n    def format_s_figs(n, s=6):\n        \"\"\"Formats a number to a specified number of significant figures in scientific notation.\"\"\"\n        if n == 0:\n            return '0.00000e+00'\n        return f\"{n:.{s-1}e}\"\n\n    all_results_str = []\n    \n    for case in test_cases:\n        eps_inf_true, omega_T_true, omega_L_true, k_values_list = case\n        k_values = np.array(k_values_list, dtype=np.float64)\n\n        # Step 1: Generate synthetic measured data\n        omega_minus_sq_data = []\n        omega_plus_sq_data = []\n\n        for k in k_values:\n            # Solve the quadratic equation for omega^2:\n            # a*x^2 + b*x + c = 0, where x = omega^2\n            a = eps_inf_true\n            b = -(eps_inf_true * omega_L_true**2 + C**2 * k**2)\n            c_quad = C**2 * k**2 * omega_T_true**2\n            \n            # Using the quadratic formula: x = (-b +/- sqrt(b^2 - 4ac)) / 2a\n            discriminant = np.sqrt(b**2 - 4 * a * c_quad)\n            \n            # The two roots for omega^2\n            x_minus = (-b - discriminant) / (2 * a)\n            x_plus = (-b + discriminant) / (2 * a)\n            \n            omega_minus_sq_data.append(x_minus)\n            omega_plus_sq_data.append(x_plus)\n            \n        omega_minus_sq = np.array(omega_minus_sq_data)\n        omega_plus_sq = np.array(omega_plus_sq_data)\n\n        # Step 2: Apply the derived estimation method\n        # Prepare variables for linear regression\n        X = k_values**2\n        Y = omega_minus_sq + omega_plus_sq\n        Z = omega_minus_sq * omega_plus_sq\n\n        # Perform the two linear regressions using numpy.polyfit\n        # Fit 1: Y = m1*X + b1\n        m1, b1 = np.polyfit(X, Y, 1)\n        \n        # Fit 2: Z = m2*X + b2 (we expect b2 to be near zero)\n        m2, b2 = np.polyfit(X, Z, 1)\n\n        # Step 3: Estimate the parameters from fit results\n        est_eps_inf = C**2 / m1\n        est_omega_L = np.sqrt(b1)\n        # Using the derived relation omega_T = sqrt(m2/m1)\n        est_omega_T = np.sqrt(m2 / m1)\n        \n        # Step 4: Format results to six significant figures\n        case_results = [\n            format_s_figs(est_eps_inf, 6),\n            format_s_figs(est_omega_T, 6),\n            format_s_figs(est_omega_L, 6),\n        ]\n        all_results_str.append(f\"[{','.join(case_results)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```", "id": "3010575"}]}