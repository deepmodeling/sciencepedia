{"hands_on_practices": [{"introduction": "Understanding a crystal begins with its fundamental geometry: the arrangement of its atoms in space. This first practice serves as a foundational exercise, guiding you from the abstract definition of a Bravais lattice to concrete, measurable properties. By systematically analyzing the simple cubic (sc) structure, you will learn to calculate coordination numbers and the distances to successive neighbor shells, a core skill essential for describing any crystalline material [@problem_id:2976225].", "problem": "A monatomic crystal forms a simple cubic (sc) Bravais lattice with conventional cubic lattice constant $a$. Using only the definitions of a Bravais lattice, the Euclidean metric for interatomic separations in real space, and the definition of coordination number as the number of atoms in the first neighbor shell, derive from first principles the coordination number and the nearest-neighbor distance in the simple cubic structure as functions of $a$. Further, enumerate the second- and third-neighbor shells by giving their multiplicities (how many neighbors in each shell) and their corresponding distances from a reference atom, again as functions of $a$. \n\nYour derivation must start from the lattice vectors and the set of lattice translation vectors, and proceed by identifying the distinct shells as sets of lattice points at equal distance from the origin, excluding the origin itself.\n\nReport your final result as a single row matrix containing, in order,\n$z_{1}$, $r_{1}$, $z_{2}$, $r_{2}$, $z_{3}$, $r_{3}$,\nwhere $z_{n}$ is the multiplicity of the $n$-th neighbor shell and $r_{n}$ is its distance, all expressed in terms of $a$.\n\nDo not include units in your final answer. No numerical rounding is required; provide exact symbolic expressions.", "solution": "The problem is well-posed and scientifically sound, resting on foundational concepts of crystallography and solid-state physics. We will proceed with a rigorous derivation from first principles.\n\nA Bravais lattice is an infinite array of points defined by position vectors $\\vec{R}$ of the form:\n$$\n\\vec{R} = n_1 \\vec{a}_1 + n_2 \\vec{a}_2 + n_3 \\vec{a}_3\n$$\nwhere $\\vec{a}_1$, $\\vec{a}_2$, $\\vec{a}_3$ are the primitive lattice vectors, and $n_1, n_2, n_3$ are any integers. For a simple cubic (sc) lattice with a conventional cubic lattice constant $a$, the simplest choice for the primitive lattice vectors aligns them with a Cartesian coordinate system:\n$$\n\\vec{a}_1 = a \\hat{x}, \\quad \\vec{a}_2 = a \\hat{y}, \\quad \\vec{a}_3 = a \\hat{z}\n$$\nThus, any lattice point can be expressed by the vector $\\vec{R}$ corresponding to an integer triplet $(n_x, n_y, n_z)$:\n$$\n\\vec{R}(n_x, n_y, n_z) = a(n_x \\hat{x} + n_y \\hat{y} + n_z \\hat{z})\n$$\nWe establish a reference atom at the origin, corresponding to the triplet $(0, 0, 0)$. The distance $d$ from this reference atom to any other atom at position $\\vec{R}$ is given by the Euclidean norm of the vector $\\vec{R}$:\n$$\nd = |\\vec{R}| = \\sqrt{\\vec{R} \\cdot \\vec{R}} = \\sqrt{(a n_x)^2 + (a n_y)^2 + (a n_z)^2} = a \\sqrt{n_x^2 + n_y^2 + n_z^2}\n$$\nNeighbor shells are defined as sets of atoms located at the same distance from the reference atom. To identify these shells, we must find the distinct values of $d$ by considering all non-zero integer triplets $(n_x, n_y, n_z)$ and systematically evaluating the sum of squares $S = n_x^2 + n_y^2 + n_z^2$. The distance to a shell is then $r = a\\sqrt{S}$, and the multiplicity (number of atoms in the shell) is the number of distinct integer triplets $(n_x, n_y, n_z)$ that yield the same value of $S$.\n\n**First Neighbor Shell ($n=1$):**\nWe seek the smallest non-zero value of $S = n_x^2 + n_y^2 + n_z^2$. Since $n_x, n_y, n_z$ are integers, the smallest possible non-zero values for $n_i^2$ are $1, 4, 9, \\dots$. The minimum sum $S_1$ is achieved when one of the integers is $\\pm 1$ and the other two are $0$.\n$$\nS_1 = (\\pm 1)^2 + 0^2 + 0^2 = 1\n$$\nThe distance to this first shell, the nearest-neighbor distance $r_1$, is:\n$$\nr_1 = a \\sqrt{S_1} = a \\sqrt{1} = a\n$$\nThe multiplicity $z_1$ of this shell, which is the coordination number, is the count of all integer triplets that result in $S_1=1$. These are the permutations of $(\\pm 1, 0, 0)$:\n- $(\\pm 1, 0, 0)$: $2$ atoms (along the positive and negative $x$-axis)\n- $(0, \\pm 1, 0)$: $2$ atoms (along the positive and negative $y$-axis)\n- $(0, 0, \\pm 1)$: $2$ atoms (along the positive and negative $z$-axis)\nThe total multiplicity is $z_1 = 2 + 2 + 2 = 6$.\n\n**Second Neighbor Shell ($n=2$):**\nThe next smallest value for the sum of squares, $S_2$, is found by setting two integers to $\\pm 1$ and one to $0$.\n$$\nS_2 = (\\pm 1)^2 + (\\pm 1)^2 + 0^2 = 1 + 1 + 0 = 2\n$$\nThe distance to the second neighbor shell, $r_2$, is:\n$$\nr_2 = a \\sqrt{S_2} = a \\sqrt{2}\n$$\nThe multiplicity $z_2$ is the count of all integer triplets resulting in $S_2=2$. These are the permutations of $(\\pm 1, \\pm 1, 0)$:\n- $(\\pm 1, \\pm 1, 0)$: $4$ atoms (in the $xy$-plane at $(\\pm a, \\pm a, 0)$)\n- $(\\pm 1, 0, \\pm 1)$: $4$ atoms (in the $xz$-plane at $(\\pm a, 0, \\pm a)$)\n- $(0, \\pm 1, \\pm 1)$: $4$ atoms (in the $yz$-plane at $(0, \\pm a, \\pm a)$)\nThe total multiplicity is $z_2 = 4 + 4 + 4 = 12$. These neighbors are located at the centers of the faces of the cube of side length $2a$ centered on the origin.\n\n**Third Neighbor Shell ($n=3$):**\nThe next distinct value for the sum of squares, $S_3$, is found by setting all three integers to $\\pm 1$.\n$$\nS_3 = (\\pm 1)^2 + (\\pm 1)^2 + (\\pm 1)^2 = 1 + 1 + 1 = 3\n$$\nNote that the sum $S=4$ (e.g., from $2^2+0^2+0^2$) is greater than $S=3$. The distance to the third neighbor shell, $r_3$, is:\n$$\nr_3 = a \\sqrt{S_3} = a \\sqrt{3}\n$$\nThe multiplicity $z_3$ is the count of all integer triplets resulting in $S_3=3$. These are the triplets where all components are $\\pm 1$:\n- $(\\pm 1, \\pm 1, \\pm 1)$: There are $2 \\times 2 \\times 2 = 8$ possible combinations of signs.\nThe total multiplicity is $z_3 = 8$. These neighbors are located at the corners of the cube of side length $2a$ centered on the origin.\n\nIn summary, we have derived the following quantities for the first three neighbor shells of a simple cubic lattice:\n- 1st shell: $z_1 = 6$, $r_1 = a$\n- 2nd shell: $z_2 = 12$, $r_2 = a\\sqrt{2}$\n- 3rd shell: $z_3 = 8$, $r_3 = a\\sqrt{3}$\n\nThese results are now compiled into the required matrix format.", "answer": "$$\n\\boxed{\\begin{pmatrix} 6 & a & 12 & a\\sqrt{2} & 8 & a\\sqrt{3} \\end{pmatrix}}\n$$", "id": "2976225"}, {"introduction": "Building on the principles of lattice geometry, we now turn to one of the most common and important crystal structures: the face-centered cubic (fcc) lattice. This exercise connects the abstract atomic arrangement to a critical physical propertyâ€”the packing efficiency. By determining the maximum radius of atoms that can fit into the fcc structure and calculating the resulting packing fraction, you will gain insight into why this dense arrangement is so prevalent in nature [@problem_id:2976229].", "problem": "A monatomic crystal is described by a face-centered cubic (FCC) lattice, where identical atoms can be modeled as impenetrable hard spheres of radius $r$ located at the lattice points. Consider the conventional cubic cell of edge length $a$. In this structure, nearest neighbors are known to be related by the geometry of a face diagonal of the cube.\n\nStarting from the geometric definition of the face-centered cubic (FCC) lattice and the notion of nearest-neighbor contact for hard spheres, derive the exact relation between the hard-sphere radius $r$ and the conventional lattice parameter $a$. Then, by counting the number of atoms associated with the conventional FCC cell and using the standard formula for the volume of a sphere, derive the exact packing fraction $\\eta_{\\mathrm{fcc}}$, defined as the ratio of the total volume of the hard spheres contained within the conventional cell to the volume of the conventional cell. Provide your final results for $r$ and $\\eta_{\\mathrm{fcc}}$ (in that order) in exact symbolic form. No rounding is required, and no physical units should be included in the final expressions.", "solution": "The problem is found to be valid as it is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is a standard problem in introductory solid-state physics.\n\nThe first step is to establish the geometric relationship between the hard-sphere radius $r$ and the lattice parameter $a$ of the conventional cubic cell for a face-centered cubic (FCC) lattice. The conventional FCC cell is a cube of edge length $a$ with atoms at each of the $8$ corners and at the center of each of the $6$ faces. The problem states that the atoms are modeled as impenetrable hard spheres and that nearest-neighbor atoms are in contact.\n\nIn the FCC structure, the shortest distance between atoms occurs along the face diagonal of the cube. Let us consider one face of the cube. There are atoms at the four corners and one atom at the center of the face. The atom at the face center is a nearest neighbor to the four corner atoms of that face. The hard-sphere model dictates that these atoms touch along the line connecting their centers, which is the face diagonal.\n\nThe full length of a face diagonal, which connects two opposite corners of a square face of side length $a$, can be calculated using the Pythagorean theorem: $d_{\\mathrm{face}} = \\sqrt{a^2 + a^2} = \\sqrt{2a^2} = a\\sqrt{2}$.\n\nThis diagonal passes through one corner atom (contributing a length equal to its radius, $r$), the full diameter of the face-centered atom (contributing a length of $2r$), and the opposite corner atom (contributing a length equal to its radius, $r$). Therefore, the total length of the face diagonal in terms of the atomic radius is the sum of these lengths: $d_{\\mathrm{face}} = r + 2r + r = 4r$.\n\nBy equating the two expressions for the length of the face diagonal, we obtain the relationship between $r$ and $a$:\n$$4r = a\\sqrt{2}$$\nSolving for the radius $r$ gives:\n$$r = \\frac{a\\sqrt{2}}{4}$$\nThis expression can also be written as $r = \\frac{a}{2\\sqrt{2}}$, but we will use the form with the rationalized denominator. This is the first required result.\n\nThe second step is to calculate the atomic packing fraction, $\\eta_{\\mathrm{fcc}}$. This is defined as the ratio of the total volume occupied by the atoms within the conventional unit cell to the volume of the unit cell itself.\n$$\\eta_{\\mathrm{fcc}} = \\frac{V_{\\mathrm{atoms}}}{V_{\\mathrm{cell}}}$$\nThe volume of the conventional cubic cell is simply:\n$$V_{\\mathrm{cell}} = a^3$$\nTo find the total volume of the atoms, $V_{\\mathrm{atoms}}$, we must first determine the number of atoms, $N_{\\mathrm{cell}}$, contained within one conventional cell.\nThe atoms at the $8$ corners of the cube are each shared by $8$ adjacent unit cells. Thus, the contribution from the corner atoms is $8 \\times \\frac{1}{8} = 1$ atom.\nThe atoms at the centers of the $6$ faces are each shared by $2$ adjacent unit cells. Thus, the contribution from the face-centered atoms is $6 \\times \\frac{1}{2} = 3$ atoms.\nThe total number of atoms per conventional cell is the sum of these contributions:\n$$N_{\\mathrm{cell}} = 1 + 3 = 4$$\nThe volume of a single spherical atom with radius $r$ is given by the standard formula:\n$$V_{\\mathrm{sphere}} = \\frac{4}{3}\\pi r^3$$\nThe total volume of the atoms within the conventional cell is therefore:\n$$V_{\\mathrm{atoms}} = N_{\\mathrm{cell}} \\times V_{\\mathrm{sphere}} = 4 \\times \\frac{4}{3}\\pi r^3 = \\frac{16}{3}\\pi r^3$$\nNow, we substitute the expression for $r$ in terms of $a$ ($r = \\frac{a\\sqrt{2}}{4}$) into the equation for $V_{\\mathrm{atoms}}$:\n$$V_{\\mathrm{atoms}} = \\frac{16}{3}\\pi \\left(\\frac{a\\sqrt{2}}{4}\\right)^3 = \\frac{16}{3}\\pi \\left(\\frac{a^3 (\\sqrt{2})^3}{4^3}\\right) = \\frac{16}{3}\\pi \\left(\\frac{a^3 \\cdot 2\\sqrt{2}}{64}\\right)$$\nSimplifying this expression:\n$$V_{\\mathrm{atoms}} = \\frac{32\\pi\\sqrt{2}a^3}{192} = \\frac{\\pi\\sqrt{2}a^3}{6}$$\nFinally, we can calculate the packing fraction $\\eta_{\\mathrm{fcc}}$ by taking the ratio of $V_{\\mathrm{atoms}}$ to $V_{\\mathrm{cell}}$:\n$$\\eta_{\\mathrm{fcc}} = \\frac{V_{\\mathrm{atoms}}}{V_{\\mathrm{cell}}} = \\frac{\\frac{\\pi\\sqrt{2}a^3}{6}}{a^3}$$\nThe term $a^3$ cancels out, yielding the exact packing fraction for the FCC lattice:\n$$\\eta_{\\mathrm{fcc}} = \\frac{\\pi\\sqrt{2}}{6}$$\nThis is the second required result. It is a dimensionless constant with an approximate value of $0.74$, representing the maximum possible packing density for spheres of equal size.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{a\\sqrt{2}}{4} & \\frac{\\pi\\sqrt{2}}{6} \\end{pmatrix}}$$", "id": "2976229"}, {"introduction": "How do we experimentally verify the crystal structures we've analyzed? The answer lies in diffraction. This final practice is a computational exercise that bridges the gap between theoretical models and experimental observation by simulating an X-ray Laue diffraction pattern. By implementing the rules of diffraction for an fcc crystal, you will translate your knowledge of real and reciprocal space into a predictive tool, gaining a deeper appreciation for how we probe the atomic world [@problem_id:2976233].", "problem": "Consider a face-centered cubic (FCC) crystal oriented such that the crystallographic direction $[001]$ is aligned with the incident polychromatic X-ray beam. You will simulate a back-reflection Laue pattern under the following assumptions and derive a program that identifies symmetry-equivalent reflections and systematic absences.\n\nUse as fundamental base the following principles and definitions:\n- The reciprocal lattice of a cubic lattice of parameter $a$ has primitive vectors $\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$, $\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$, and $\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$. For Miller indices $(h,k,l)$, the reciprocal lattice vector is $\\mathbf{G} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3$.\n- In elastic X-ray scattering, the Laue condition states that $\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G}$ with $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}| = \\frac{2\\pi}{\\lambda}$, where $\\lambda$ is the wavelength. With $\\mathbf{k}_{\\text{in}} = k_0 \\hat{\\mathbf{z}}$, imposing $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}|$ yields the scalar constraint $|\\mathbf{G}|^2 + 2 k_0 G_z = 0$, which can be solved for $k_0$ as $k_0 = -\\frac{|\\mathbf{G}|^2}{2 G_z}$. A physically meaningful positive $k_0$ requires $G_z < 0$ (for back-reflection with incident beam along $+\\hat{\\mathbf{z}}$).\n- The structure factor for a face-centered cubic lattice with identical atoms at basis positions $(0,0,0)$, $(0,\\frac{1}{2},\\frac{1}{2})$, $(\\frac{1}{2},0,\\frac{1}{2})$, $(\\frac{1}{2},\\frac{1}{2},0)$ is $F(h,k,l) = f\\left[1 + e^{i\\pi(k+l)} + e^{i\\pi(h+l)} + e^{i\\pi(h+k)}\\right]$, where $f$ is the atomic form factor. This implies the selection rule $F(h,k,l) \\neq 0$ if and only if $h$, $k$, and $l$ are all even or all odd (systematic absences otherwise).\n- Place a flat detector perpendicular to the incident beam at $z = -D$ (with $D > 0$) on the incident side to record back-reflections. For each diffracted beam with direction $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{|\\mathbf{k}_{\\text{out}}|}$ and $\\hat{\\mathbf{u}}\\cdot\\hat{\\mathbf{z}} < 0$, the intersection with the detector plane occurs at a parameter $t = -\\frac{D}{\\hat{\\mathbf{u}}_z}$ along the ray $\\mathbf{r}(t) = t \\hat{\\mathbf{u}}$, giving screen coordinates $(x,y) = (t \\hat{\\mathbf{u}}_x, t \\hat{\\mathbf{u}}_y)$. The screen radius is $R = \\sqrt{x^2 + y^2}$.\n\nYour task:\n1. Generate all Miller indices $(h,k,l)$ with $-N \\le h,k,l \\le N$ excluding $(0,0,0)$ and restricted to $l < 0$ to ensure $G_z < 0$ for candidates of back-reflection. For each candidate, compute $\\mathbf{G}$, $k_0 = -\\frac{|\\mathbf{G}|^2}{2 G_z}$, and the wavelength $\\lambda = \\frac{2\\pi}{k_0}$.\n2. Apply the FCC selection rule to identify systematic absences (those with $h$, $k$, $l$ not all even or not all odd). Discard these from further geometric consideration.\n3. Impose a physically realistic white-radiation band by accepting only reflections with $\\lambda_{\\min} \\le \\lambda \\le \\lambda_{\\max}$; discard those outside the band as not recorded.\n4. Compute the diffracted direction $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{in}} + \\mathbf{G}}{|\\mathbf{k}_{\\text{in}} + \\mathbf{G}|}$ with $\\mathbf{k}_{\\text{in}} = k_0 \\hat{\\mathbf{z}}$ and accept only back-reflections with $\\hat{\\mathbf{u}}_z < 0$. For each accepted reflection, compute the screen radius $R$ and express it in millimeters.\n5. Identify symmetry-equivalent reflections under the fourfold rotational symmetry around $[001]$ combined with in-plane mirror symmetries (the point group $4/mmm$ around $[001]$). Two reflections $(h,k,l)$ and $(h',k',l')$ are considered equivalent if $l' = l$ and $(h',k')$ can be obtained from $(h,k)$ by any combination of 90-degree rotations and sign flips in the $x$-$y$ plane. For implementation, classify equivalence using the canonical key $(l, \\min(|h|,|k|), \\max(|h|,|k|))$.\n6. For each test case, produce the following outputs:\n   - An integer: the total number of candidate indices with $l<0$ considered (excluding $(0,0,0)$).\n   - An integer: the number of systematic absences among those candidates (FCC selection rule failures).\n   - An integer: the number of recorded reflections after all physical filters (wavelength band and back-reflection direction).\n   - An integer: the number of symmetry-equivalence classes among the recorded reflections based on the key above.\n   - A float: the mean screen radius of recorded reflections in millimeters, rounded to six decimal places. If no reflections are recorded, return $0.0$.\n\nUse the following test suite, with all length parameters expressed in meters and wavelengths in meters:\n- Test case 1 (happy path): $a = 4.05\\times 10^{-10}$, $D = 0.10$, $N = 4$, $\\lambda_{\\min} = 0.5\\times 10^{-10}$, $\\lambda_{\\max} = 2.0\\times 10^{-10}$.\n- Test case 2 (expanded coverage): $a = 3.52\\times 10^{-10}$, $D = 0.15$, $N = 5$, $\\lambda_{\\min} = 0.4\\times 10^{-10}$, $\\lambda_{\\max} = 2.5\\times 10^{-10}$.\n- Test case 3 (edge case with narrow band): $a = 4.05\\times 10^{-10}$, $D = 0.10$, $N = 2$, $\\lambda_{\\min} = 1.5\\times 10^{-10}$, $\\lambda_{\\max} = 1.6\\times 10^{-10}$.\n\nYour program should aggregate the results for all test cases into a single line of output as a comma-separated list enclosed in square brackets. Each test case result must be a list in the order specified above, so the final output must be of the form\n$[ [r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}, r_{1,5}], [r_{2,1}, r_{2,2}, r_{2,3}, r_{2,4}, r_{2,5}], [r_{3,1}, r_{3,2}, r_{3,3}, r_{3,4}, r_{3,5}] ]$,\nwhere $r_{j,i}$ are integers or floats as defined. The last entry in each inner list must be the mean radius expressed in millimeters, rounded to six decimal places.", "solution": "The user wants to simulate a back-reflection Laue X-ray diffraction pattern for a face-centered cubic (FCC) crystal and analyze the results. The problem is scientifically sound, well-posed, and all parameters and steps are clearly defined. I will proceed with a step-by-step solution derivation that will form the basis of the final program.\n\n### 1. Theoretical Framework\n\nThe problem is grounded in the kinematics of X-ray diffraction, described by the Laue conditions and the geometry of the reciprocal lattice.\n\n**Reciprocal Lattice and Incident Beam:**\nThe crystal is a face-centered cubic (FCC) lattice, which has a body-centered cubic (BCC) reciprocal lattice. However, for a cubic conventional cell of side length $a$, it is simpler to use the reciprocal lattice vectors based on a simple cubic basis:\n_$\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$, $\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$, $\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$._\nA reciprocal lattice vector $\\mathbf{G}$ is given by Miller indices $(h,k,l)$:\n_$\\mathbf{G} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3 = \\frac{2\\pi}{a}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$._\nThe incident X-ray beam has a wavevector $\\mathbf{k}_{\\text{in}}$ aligned with the $[001]$ direction (the $\\hat{\\mathbf{z}}$ axis). Its magnitude is $k_0 = |\\mathbf{k}_{\\text{in}}| = \\frac{2\\pi}{\\lambda}$, where $\\lambda$ is the wavelength.\n_$\\mathbf{k}_{\\text{in}} = k_0\\hat{\\mathbf{z}}$._\n\n**Laue Condition and Wavelength Selection:**\nThe condition for elastic scattering is $\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G}$ with $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}|$. Squaring the first equation gives:\n_$$|\\mathbf{k}_{\\text{out}}|^2 = |\\mathbf{k}_{\\text{in}}|^2 + |\\mathbf{G}|^2 + 2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G}$$_\nSubstituting $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}| = k_0$ simplifies this to the fundamental equation of the Ewald sphere construction:\n_$$|\\mathbf{G}|^2 + 2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G} = 0$$_\nWith $\\mathbf{k}_{\\text{in}} = k_0\\hat{\\mathbf{z}}$ and $\\mathbf{G} = \\frac{2\\pi}{a}(h, k, l)$, the dot product becomes $2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G} = 2k_0 G_z = 2k_0 \\frac{2\\pi l}{a}$. The squared magnitude is $|\\mathbf{G}|^2 = (\\frac{2\\pi}{a})^2(h^2+k^2+l^2)$. Substituting these gives:\n_$$(\\frac{2\\pi}{a})^2(h^2+k^2+l^2) + 2k_0 (\\frac{2\\pi l}{a}) = 0$$_\nSolving for $k_0$ yields:\n_$$k_0 = -\\frac{(\\frac{2\\pi}{a})^2(h^2+k^2+l^2)}{2 (\\frac{2\\pi l}{a})} = -\\frac{\\pi}{a}\\frac{h^2+k^2+l^2}{l}$$_\nSince $k_0$ must be positive, and $h^2+k^2+l^2 > 0$, we must have $l < 0$. This confirms the problem's constraint for candidate reflections. The corresponding wavelength $\\lambda = \\frac{2\\pi}{k_0}$ is:\n_$$\\lambda = \\frac{2\\pi}{-\\frac{\\pi}{a}\\frac{h^2+k^2+l^2}{l}} = -2a \\frac{l}{h^2+k^2+l^2}$$_\nThis simple formula will be used to check if the reflection is excited by the given wavelength band $[\\lambda_{\\min}, \\lambda_{\\max}]$.\n\n**FCC Selection Rules:**\nThe structure factor $F(h,k,l)$ for an FCC lattice with a monoatomic basis at $(0,0,0), (0,\\frac{1}{2},\\frac{1}{2}), (\\frac{1}{2},0,\\frac{1}{2}), (\\frac{1}{2},\\frac{1}{2},0)$ is:\n_$$F(h,k,l) = f\\left[1 + e^{i\\pi(k+l)} + e^{i\\pi(h+l)} + e^{i\\pi(h+k)}\\right]$$_\nwhere $f$ is the atomic form factor. This sum is non-zero only if the Miller indices $h, k, l$ are either all even or all odd. Reflections with mixed-parity indices are \"systematically absent\".\n\n**Back-Reflection Geometry and Detector Coordinates:**\nA diffracted beam must travel backwards to be recorded in a back-reflection setup. The direction of the diffracted beam is $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{k_0}$. Its $z$-component must be negative, i.e., $\\hat{u}_z < 0$.\n_$$\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G} = k_0\\hat{\\mathbf{z}} + \\frac{2\\pi}{a}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$$_\n_$$\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{k_0} = \\hat{\\mathbf{z}} + \\frac{2\\pi}{ak_0}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$$__\nSubstituting the expression for $k_0$:\n_$$\\hat{u}_z = 1 + \\frac{2\\pi l}{ak_0} = 1 + \\frac{2\\pi l}{a} \\left( -\\frac{a}{\\pi}\\frac{l}{h^2+k^2+l^2} \\right) = 1 - \\frac{2l^2}{h^2+k^2+l^2} = \\frac{h^2+k^2-l^2}{h^2+k^2+l^2}$$__\nThe condition $\\hat{u}_z < 0$ thus simplifies to $h^2+k^2-l^2 < 0$, or $h^2+k^2 < l^2$.\n\nThe detector is a plane at $z=-D$. A diffracted ray along $\\hat{\\mathbf{u}}$ from the origin reaches the detector at $(x,y,-D)$. The position vector is $t\\hat{\\mathbf{u}}$, so $t\\hat{u}_z = -D$, which means $t = -D/\\hat{u}_z$. The spot radius $R$ is:\n_$$R = \\sqrt{(t\\hat{u}_x)^2 + (t\\hat{u}_y)^2} = |t|\\sqrt{\\hat{u}_x^2 + \\hat{u}_y^2} = t\\sqrt{1-\\hat{u}_z^2} = -\\frac{D}{\\hat{u}_z}\\sqrt{1-\\hat{u}_z^2}$$__\nThis is equivalent to $R = D\\tan\\theta$, where $\\theta$ is the angle of deviation from the central axis normal to the film. We can derive a direct expression in terms of Miller indices:\n_$$R = D \\frac{2|l|\\sqrt{h^2+k^2}}{l^2 - (h^2+k^2)}$$_\nSince $l<0$, this can also be written as:\n_$$R = D \\frac{-2l\\sqrt{h^2+k^2}}{l^2 - (h^2+k^2)}$$_\n\n**Symmetry Equivalence:**\nThe problem defines symmetry equivalence based on the fourfold rotational symmetry and mirror planes of the $[001]$ axis (point group $4/mmm$). For a fixed $l$, any two reflections $(h,k,l)$ and $(h',k',l')$ are equivalent if the pair $(|h'|,|k'|)$ is a permutation of $(|h|,|k|)$. A canonical key to represent each equivalence class is $(l, \\min(|h|,|k|), \\max(|h|,|k|))$.\n\n### 2. Algorithm Design\n\nThe solution will be implemented by iterating through candidate Miller indices and applying a series of filters.\n\n1.  **Generate Candidates**: Iterate through all integers $h, k, l$ such that $-N \\le h,k \\le N$ and $-N \\le l < 0$. Count these to get `total_candidates`.\n2.  **Filter 1 (Systematic Absences)**: For each $(h,k,l)$, check if the indices are all even or all odd. If they have mixed parity, increment `systematic_absences` and discard.\n3.  **Filter 2 (Wavelength)**: Calculate $\\lambda = -2a \\frac{l}{h^2+k^2+l^2}$. If $\\lambda$ is not in the range $[\\lambda_{\\min}, \\lambda_{\\max}]$, discard the reflection.\n4.  **Filter 3 (Back-Reflection Geometry)**: Check if $h^2+k^2 < l^2$. If not, the diffracted beam does not travel backwards, so it is discarded.\n5.  **Process Recorded Reflections**: If a reflection $(h,k,l)$ passes all filters:\n    *   Increment `recorded_reflections`.\n    *   Calculate its screen radius $R$ using the formula derived above. Convert it to millimeters by multiplying by $1000$. Store this value.\n    *   Generate the symmetry key $(l, \\min(|h|,|k|), \\max(|h|,|k|))$ and add it to a set to keep track of unique classes.\n6.  **Final Computations**:\n    *   The number of `symmetry_classes` is the final size of the set of keys.\n    *   Calculate the mean of all stored radii. If no reflections were recorded, the mean is $0.0$.\n    *   Round the mean radius to six decimal places.\n7.  **Output**: Assemble the five computed values (`total_candidates`, `systematic_absences`, `recorded_reflections`, `symmetry_classes`, `mean_radius_mm`) into a list for the current test case. Repeat for all test cases and format the final output as specified.\n\nThis structured approach ensures all conditions from the problem statement are met precisely.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    def _solve_case(a, D, N, lambda_min, lambda_max):\n        \"\"\"\n        Solves one test case for the Laue pattern simulation.\n\n        Args:\n            a (float): Lattice parameter in meters.\n            D (float): Sample-to-detector distance in meters.\n            N (int): Maximum absolute value for Miller indices h, k, l.\n            lambda_min (float): Minimum wavelength in the X-ray beam in meters.\n            lambda_max (float): Maximum wavelength in the X-ray beam in meters.\n        \n        Returns:\n            list: A list containing the five required output values for the test case.\n        \"\"\"\n        total_candidates = 0\n        systematic_absences = 0\n        recorded_reflections_count = 0\n        \n        recorded_radii_m = []\n        recorded_keys = set()\n\n        # Task 1: Generate all Miller indices (h, k, l) with -N <= h,k,l <= N,\n        # excluding (0,0,0) and restricted to l < 0.\n        for h in range(-N, N + 1):\n            for k in range(-N, N + 1):\n                for l in range(-N, 0):  # This ensures l < 0.\n                    \n                    # (0,0,0) is automatically excluded since l cannot be 0.\n                    total_candidates += 1\n\n                    # Task 2: Apply FCC selection rule.\n                    # Indices must be all even or all odd.\n                    # We check if the parities of |h|, |k|, |l| are the same.\n                    parities = {abs(h) % 2, abs(k) % 2, abs(l) % 2}\n                    if len(parities) > 1: # Mixed parities\n                        systematic_absences += 1\n                        continue\n                    \n                    # Task 1 (cont.): Compute wavelength for the reflection.\n                    hkl_sq_sum = h**2 + k**2 + l**2\n                    \n                    # This check is for safety, though hkl_sq_sum > 0 since l < 0.\n                    if hkl_sq_sum == 0:\n                        continue\n\n                    lambda_val = -2 * a * l / hkl_sq_sum\n                    \n                    # Task 3: Impose wavelength band filter.\n                    if not (lambda_min <= lambda_val <= lambda_max):\n                        continue\n\n                    # Task 4: Impose geometric back-reflection condition.\n                    # The condition for back-reflection is h^2 + k^2 < l^2.\n                    if not (h**2 + k**2 < l**2):\n                        continue\n\n                    # If we reach here, the reflection is recorded.\n                    recorded_reflections_count += 1\n\n                    # Task 4 (cont.): Compute the screen radius R.\n                    # Formula: R = D * (-2*l*sqrt(h^2+k^2)) / (l^2 - (h^2+k^2))\n                    # The sign works out because l < 0 and l^2 > h^2+k^2.\n                    radius_m = D * (-2 * l * np.sqrt(h**2 + k**2)) / (l**2 - (h**2 + k**2))\n                    recorded_radii_m.append(radius_m)\n\n                    # Task 5: Identify symmetry-equivalence class.\n                    # The key is (l, min(|h|,|k|), max(|h|,|k|)).\n                    key = (l, min(abs(h), abs(k)), max(abs(h), abs(k)))\n                    recorded_keys.add(key)\n\n        # Task 6: Produce final outputs for the test case.\n        num_symmetry_classes = len(recorded_keys)\n        \n        if recorded_reflections_count > 0:\n            # Calculate mean radius and convert from meters to millimeters.\n            mean_radius_mm = np.mean(recorded_radii_m) * 1000.0\n        else:\n            mean_radius_mm = 0.0\n\n        # Round the mean radius to six decimal places as required.\n        mean_radius_mm = round(mean_radius_mm, 6)\n\n        return [\n            total_candidates,\n            systematic_absences,\n            recorded_reflections_count,\n            num_symmetry_classes,\n            mean_radius_mm\n        ]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, D, N, lambda_min, lambda_max)\n        (4.05e-10, 0.10, 4, 0.5e-10, 2.0e-10),\n        (3.52e-10, 0.15, 5, 0.4e-10, 2.5e-10),\n        (4.05e-10, 0.10, 2, 1.5e-10, 1.6e-10),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # str() on a list creates a string like '[1, 2, 3]', then we join them.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2976233"}]}