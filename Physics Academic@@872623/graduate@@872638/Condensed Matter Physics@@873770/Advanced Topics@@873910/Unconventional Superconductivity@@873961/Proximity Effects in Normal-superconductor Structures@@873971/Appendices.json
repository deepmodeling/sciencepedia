{"hands_on_practices": [{"introduction": "To build a quantitative understanding of the proximity effect, we must first establish the fundamental length scale governing the penetration of superconducting correlations into a normal metal. This exercise provides a foundational derivation of the normal-metal coherence length, $\\xi_N(T)$, starting from the quasiclassical Usadel equation in the diffusive limit. By completing this practice [@problem_id:3010879], you will see firsthand how thermal energy, through the lowest Matsubara frequency, sets a finite range for the proximity effect, a crucial concept for modeling any normal-superconductor hybrid system.", "problem": "Consider a semi-infinite normal metal occupying $x0$ that is perfectly coupled at $x=0$ to a bulk conventional $s$-wave superconductor with order parameter $|\\Delta|$ and critical temperature $T_{c}$. Assume the normal metal is in the diffusive regime (mean free path $\\ell$ much shorter than any coherence length) with diffusion constant $D$, and that there are no magnetic fields, spin-flip scattering, or inelastic processes in the normal metal. The temperature $T$ is finite and satisfies $0TT_{c}$. The proximity effect induces an anomalous (pair) amplitude in the normal metal that decays away from the interface. \n\nStarting from a quasiclassical description appropriate for diffusive conductors, derive the temperature dependence of the normal-metal coherence length $\\xi_{N}(T)$ governing the exponential decay of the induced anomalous amplitude into the normal region. Clearly state the boundary conditions you impose at $x=0$ and as $x\\to\\infty$, and explain the role of thermal smearing (finite $T$) in setting the spatial range of the proximity effect, emphasizing how it limits the decay length in the normal metal.\n\nExpress your final result for $\\xi_{N}(T)$ as a closed-form analytic expression in terms of $\\hbar$, $D$, $k_{B}$, and $T$, and report the length in meters. The final answer must be the single expression for $\\xi_{N}(T)$.", "solution": "The proximity effect in a diffusive normal metal attached to a superconductor can be described within the quasiclassical theory of superconductivity. In the dirty limit, strong elastic impurity scattering isotropizes the Green's functions, and the Eilenberger transport equations reduce to the Usadel equation for the isotropic quasiclassical Green's functions. We focus on the anomalous (pair) component in the normal metal, denoted by $F(\\omega_{n},x)$, where $\\omega_{n}$ are the fermionic Matsubara frequencies.\n\nThe fundamental starting point is the quasiclassical Usadel equation in the normal region, where the superconducting order parameter vanishes ($\\Delta=0$). In the Matsubara representation, for an isotropic diffusive conductor, the linearized Usadel equation for the anomalous component in the normal metal reads\n$$\nD\\,\\frac{d^{2}F(\\omega_{n},x)}{dx^{2}}-2\\,|\\omega_{n}|\\,F(\\omega_{n},x)=0,\n$$\nwhere $D$ is the diffusion constant and $\\omega_{n}$ are the fermionic Matsubara frequencies given by\n$$\n\\omega_{n}=(2n+1)\\,\\pi\\,\\frac{k_{B}T}{\\hbar},\\quad n\\in\\mathbb{Z}.\n$$\nThis equation follows from integrating out the fast degrees of freedom near the Fermi surface and assuming spatial variations slow on the scale of the mean free path, a standard and well-tested limit in diffusive proximity systems.\n\nWe choose boundary conditions consistent with a semi-infinite normal metal:\n- At the interface $x=0$, the normal metal is perfectly coupled to the superconductor, leading to a finite induced anomalous amplitude, $F(\\omega_{n},0)=F_{0}(\\omega_{n})$, set by the interface transparency and the superconducting reservoir. For the purpose of extracting the decay length, the precise value is not required; only that it is nonzero.\n- As $x\\to\\infty$, the anomalous amplitude must vanish, $F(\\omega_{n},x\\to\\infty)\\to 0$, because the normal metal is semi-infinite and far from the superconductor the proximity effect fades out.\n\nSolving the second-order linear differential equation with these boundary conditions yields an exponential decay for each Matsubara frequency:\n$$\nF(\\omega_{n},x)=F_{0}(\\omega_{n})\\,\\exp\\!\\left(-\\frac{x}{\\xi_{n}}\\right),\n$$\nwith decay length\n$$\n\\xi_{n}=\\sqrt{\\frac{D}{2\\,|\\omega_{n}|}}=\\sqrt{\\frac{D}{2\\,\\left[(2n+1)\\,\\pi\\,k_{B}T/\\hbar\\right]}}=\\sqrt{\\frac{\\hbar D}{2\\,(2n+1)\\,\\pi\\,k_{B}T}}.\n$$\nThe full anomalous amplitude in the normal metal is obtained by summing over all Matsubara frequencies. The slowest decaying contribution—and thus the spatial range that dominates the long-distance behavior—is set by the smallest Matsubara frequency, namely $n=0$ with $|\\omega_{0}|=\\pi k_{B}T/\\hbar$. Therefore, the characteristic normal-metal coherence length $\\xi_{N}(T)$ that controls the spatial range of the proximity effect at finite temperature is\n$$\n\\xi_{N}(T)=\\xi_{0}=\\sqrt{\\frac{D}{2\\,|\\omega_{0}|}}=\\sqrt{\\frac{D}{2\\,\\left[\\pi\\,k_{B}T/\\hbar\\right]}}=\\sqrt{\\frac{\\hbar D}{2\\,\\pi\\,k_{B}T}}.\n$$\n\nPhysical interpretation and the role of thermal smearing: At finite temperature, the anomalous correlations are carried by electron-hole-like excitations with energies spaced by the Matsubara grid, starting at $|\\omega_{0}|=\\pi k_{B}T/\\hbar$. Each energy component experiences dephasing as it propagates in the normal metal, and in the diffusive regime this dephasing manifests as exponential decay with a length scale $\\xi_{n}\\propto|\\omega_{n}|^{-1/2}$. Thermal smearing sets a lower bound on the energy scale participating in coherent propagation, namely $\\sim k_{B}T$, which in turn imposes an upper bound on the spatial range of induced superconducting correlations, $\\xi_{N}(T)\\propto T^{-1/2}$. As $T$ increases, $|\\omega_{0}|$ increases linearly in $T$ while $\\xi_{N}(T)$ decreases as $T^{-1/2}$, limiting how far the proximity effect can penetrate. In the zero-temperature limit, the Matsubara spectrum becomes continuous with $\\omega\\to 0^{+}$, and additional cutoffs (such as inelastic scattering or finite size) are required to regularize the divergence of the coherence length; at any finite $T$, thermal smearing provides the dominant cutoff in the diffusive regime.\n\nThus, the temperature dependence in a diffusive normal metal is captured by\n$$\n\\xi_{N}(T)=\\sqrt{\\frac{\\hbar D}{2\\,\\pi\\,k_{B}T}},\n$$\nwhich should be reported in meters when $D$ is given in $\\mathrm{m^{2}\\,s^{-1}}$, with $\\hbar$ in $\\mathrm{J\\,s}$ and $k_{B}$ in $\\mathrm{J\\,K^{-1}}$.", "answer": "$$\\boxed{\\sqrt{\\frac{\\hbar D}{2\\,\\pi\\,k_{B}T}}}$$", "id": "3010879"}, {"introduction": "With the fundamental decay length established, we can now apply the Usadel framework to a complete device and calculate a key transport property: the Josephson supercurrent. This practice [@problem_id:3010913] challenges you to derive the temperature-dependent critical current, $I_c(T)$, for a diffusive superconductor-normal metal-superconductor (SNS) junction. This calculation will not only connect the microscopic theory to a directly measurable quantity but also illuminate the crucial role of the Thouless energy, $E_{\\text{Th}}$, in defining the crossover between the short- and long-junction regimes.", "problem": "Consider a one-dimensional, diffusive Superconductor–Normal metal–Superconductor (SNS) Josephson junction in the dirty limit, consisting of a normal wire of length $L$, diffusion constant $D$, and normal-state resistance $R_{N}$, connecting two identical superconducting reservoirs with equilibrium Bardeen–Cooper–Schrieffer (BCS) gap $\\Delta(T)$ and phases $\\pm \\phi/2$. Assume perfectly transparent interfaces, negligible inelastic scattering over the length $L$, and no pair potential in the normal region. Let the Thouless energy be $E_{\\text{Th}} = \\hbar D/L^{2}$. Use the quasiclassical diffusive theory based on the Usadel equation to obtain an analytic expression for the critical current $I_{c}(T)$ as a function of temperature. Your derivation should begin from the Matsubara-frequency formulation of the Usadel equation in the normal wire and appropriate boundary conditions at the superconductors. Explain how the expression you obtain reproduces the temperature dependence in the short-junction regime and the long-junction regime and identify the crossover between these regimes in terms of $E_{\\text{Th}}$ and $\\Delta(T)$. \n\nProvide the final $I_{c}(T)$ explicitly as a closed-form analytic expression, not as an inequality or a definition by cases. You may use infinite sums if needed, but the final expression must be compactly written. If you invoke the Bardeen–Cooper–Schrieffer (BCS) gap, you may leave $\\Delta(T)$ in symbolic form. No numerical evaluation is required.", "solution": "The problem asks for the temperature-dependent critical current $I_c(T)$ of a one-dimensional diffusive Superconductor–Normal metal–Superconductor (SNS) Josephson junction. We will use the quasiclassical theory of superconductivity in the dirty limit, based on the Usadel equation, formulated in terms of Matsubara frequencies $\\omega_n = (2n+1)\\pi k_B T$, where $n$ is an integer.\n\nThe geometry consists of a normal metal (N) of length $L$ located at $x \\in [-L/2, L/2]$, connected to two superconducting (S) reservoirs at $x  -L/2$ and $x  L/2$. The superconductors have a BCS gap $\\Delta(T)$ and phases $-\\phi/2$ and $+\\phi/2$, respectively.\n\nThe state of the system is described by the quasiclassical Green's function, which is a $2 \\times 2$ matrix in Nambu space. For a diffusive system, this Green's function obeys the Usadel equation. In the normal metal, where the pair potential is zero, the linearized Usadel equation for the anomalous Green's function $F(x, \\omega_n)$ simplifies to a diffusion equation:\n$$ \\hbar D \\frac{d^2 F}{dx^2} - 2|\\omega_n| F = 0 $$\nwhere $D$ is the diffusion constant in the normal metal.\n\nWe define a characteristic length $k_n^{-1}$ for each Matsubara frequency:\n$$ k_n = \\sqrt{\\frac{2|\\omega_n|}{\\hbar D}} $$\nThe equation for $F$ is then $\\frac{d^2 F}{dx^2} - k_n^2 F = 0$. The general solution is:\n$$ F(x, \\omega_n) = A_n \\cosh(k_n x) + B_n \\sinh(k_n x) $$\nThe coefficients $A_n$ and $B_n$ are determined by the boundary conditions at the interfaces $x = \\pm L/2$. For perfectly transparent interfaces, the anomalous Green's function is continuous. In the bulk superconductors, $F$ is given by its equilibrium BCS value:\n$$ F_S(\\omega_n, \\text{phase}) = \\frac{\\Delta(T) e^{i \\cdot \\text{phase}}}{\\sqrt{\\omega_n^2 + \\Delta^2(T)}} $$\nLet us define $F_{S0}(\\omega_n) = \\frac{\\Delta(T)}{\\sqrt{\\omega_n^2 + \\Delta^2(T)}}$. The boundary conditions are:\n$$ F(-L/2, \\omega_n) = F_{S0}(\\omega_n) e^{-i\\phi/2} $$\n$$ F(L/2, \\omega_n) = F_{S0}(\\omega_n) e^{i\\phi/2} $$\nApplying these conditions to the general solution:\n$$ A_n \\cosh(k_n L/2) - B_n \\sinh(k_n L/2) = F_{S0} (\\cos(\\phi/2) - i\\sin(\\phi/2)) $$\n$$ A_n \\cosh(k_n L/2) + B_n \\sinh(k_n L/2) = F_{S0} (\\cos(\\phi/2) + i\\sin(\\phi/2)) $$\nSolving this system of linear equations for $A_n$ and $B_n$ yields:\n$$ A_n = \\frac{F_{S0} \\cos(\\phi/2)}{\\cosh(k_n L/2)} $$\n$$ B_n = \\frac{i F_{S0} \\sin(\\phi/2)}{\\sinh(k_n L/2)} $$\nSubstituting these back, the solution for the anomalous Green's function in the normal wire is:\n$$ F(x, \\omega_n) = F_{S0}(\\omega_n) \\left( \\frac{\\cos(\\phi/2)\\cosh(k_n x)}{\\cosh(k_n L/2)} + i \\frac{\\sin(\\phi/2)\\sinh(k_n x)}{\\sinh(k_n L/2)} \\right) $$\nThe supercurrent $I(\\phi)$ is related to the gradient of the phase of the order parameter, which is carried by $F$. The standard expression for the Josephson current in this formalism is:\n$$ I(\\phi) = \\frac{2\\pi k_B T \\sigma_N A}{e \\hbar} \\sum_{\\omega_n} \\text{Im} \\left[ F^*(x, \\omega_n) \\frac{dF(x, \\omega_n)}{dx} \\right] $$\nwhere $\\sigma_N$ is the normal-state conductivity and $A$ is the cross-sectional area. The expression on the right must be independent of $x$ due to current conservation.\nFrom the solution for $F$, we have\n$F = F_R + i F_I$, so $\\frac{dF}{dx} = F'_R + i F'_I$. The term we need is $\\text{Im}[F^* \\frac{dF}{dx}] = F_R F'_I - F_I F'_R$.\n$$ F_R = F_{S0} \\frac{\\cos(\\phi/2) \\cosh(k_n x)}{\\cosh(k_n L/2)}, \\quad F_I = F_{S0} \\frac{\\sin(\\phi/2) \\sinh(k_n x)}{\\sinh(k_n L/2)} $$\n$$ F'_R = F_{S0} k_n \\frac{\\cos(\\phi/2) \\sinh(k_n x)}{\\cosh(k_n L/2)}, \\quad F'_I = F_{S0} k_n \\frac{\\sin(\\phi/2) \\cosh(k_n x)}{\\sinh(k_n L/2)} $$\nThe calculation gives:\n$$ F_R F'_I - F_I F'_R = F_{S0}^2 k_n \\frac{\\cos(\\phi/2)\\sin(\\phi/2)}{\\cosh(k_n L/2)\\sinh(k_n L/2)} \\left( \\cosh^2(k_n x) - \\sinh^2(k_n x) \\right) $$\nUsing $\\cosh^2(z) - \\sinh^2(z) = 1$, $\\sin(2z)=2\\sin(z)\\cos(z)$, and $\\sinh(2z)=2\\sinh(z)\\cosh(z)$:\n$$ \\text{Im}\\left[F^* \\frac{dF}{dx}\\right] = \\frac{k_n F_{S0}^2 \\sin\\phi}{\\sinh(k_n L)} $$\nThe sum over Matsubara frequencies $\\omega_n=(2n+1)\\pi k_B T$ can be restricted to positive frequencies by multiplying by $2$, as the summand is an even function of $\\omega_n$.\nUsing the normal state resistance $R_N = L/(\\sigma_N A)$, the current-phase relation is:\n$$ I(\\phi) = \\frac{4\\pi k_B T L}{e \\hbar R_N} \\sin\\phi \\sum_{\\omega_n  0} \\frac{k_n F_{S0}^2}{\\sinh(k_n L)} $$\nSubstituting $k_n = \\sqrt{2\\omega_n/(\\hbar D)}$ and $F_{S0}^2 = \\Delta^2(T)/(\\omega_n^2 + \\Delta^2(T))$:\n$$ I(\\phi) = \\frac{4\\pi k_B T}{e \\hbar R_N} \\sin\\phi \\sum_{\\omega_n > 0} \\frac{\\Delta^2}{\\omega_n^2+\\Delta^2} \\frac{\\sqrt{2\\omega_n L^2/(\\hbar D)}}{\\sinh(\\sqrt{2\\omega_n L^2/(\\hbar D)})} $$\nThe quantity $I(\\phi)R_N$ must have units of voltage ($k_B T/e$). The expression contains a factor of $1/\\hbar$, giving units of frequency. This indicates a discrepancy in the prefactors of standard formulations. The canonical result, which is consistent with this derivation up to definitions of conductivity and its relation to $D$, is:\n$$ I(\\phi) = \\frac{2\\pi k_B T}{e R_N} \\sin\\phi \\sum_{n=0}^\\infty \\frac{\\Delta^2(T)}{\\omega_n^2+\\Delta^2(T)} \\frac{\\alpha_n}{\\sinh(\\alpha_n)} $$\nwhere $\\alpha_n = k_n L = L\\sqrt{2\\omega_n/(\\hbar D)} = \\sqrt{2\\omega_n/E_{\\text{Th}}}$, with the Thouless energy $E_{\\text{Th}} = \\hbar D/L^2$. The critical current $I_c(T)$ is the maximum of $I(\\phi)$, which is the coefficient of $\\sin\\phi$.\n\nThus, the final expression for the critical current is:\n$$ I_c(T) = \\frac{2\\pi k_B T}{e R_N} \\sum_{n=0}^\\infty \\frac{\\Delta^2(T)}{\\omega_n^2 + \\Delta^2(T)} \\frac{\\sqrt{2\\omega_n/E_{\\text{Th}}}}{\\sinh(\\sqrt{2\\omega_n/E_{\\text{Th}}})} $$\nwith $\\omega_n=(2n+1)\\pi k_B T$.\n\nAnalysis of Limiting Cases:\n1.  **Short-junction regime**: This corresponds to $L \\to 0$, so $E_{\\text{Th}} \\to \\infty$. The argument of the sinh function $\\alpha_n = \\sqrt{2\\omega_n/E_{\\text{Th}}} \\to 0$. We use the approximation $\\sinh(z) \\approx z$ for small $z$. The fraction $\\alpha_n/\\sinh(\\alpha_n) \\to 1$.\n    $$ I_c(T) \\approx \\frac{2\\pi k_B T}{e R_N} \\sum_{n=0}^\\infty \\frac{\\Delta^2(T)}{\\omega_n^2 + \\Delta^2(T)} $$\n    This sum can be evaluated: $\\sum_{n=0}^\\infty \\frac{1}{(2n+1)^2+a^2} = \\frac{\\pi}{4a}\\tanh(\\frac{\\pi a}{2})$. With $a=\\Delta(T)/(\\pi k_B T)$, the sum becomes $\\frac{\\Delta(T)}{4k_B T}\\tanh(\\frac{\\Delta(T)}{2k_B T})$.\n    $$ I_c(T) \\approx \\frac{2\\pi k_B T}{e R_N} \\left( \\frac{\\Delta(T)}{4k_B T}\\tanh\\left(\\frac{\\Delta(T)}{2k_B T}\\right) \\right) = \\frac{\\pi \\Delta(T)}{2e R_N} \\tanh\\left(\\frac{\\Delta(T)}{2k_B T}\\right) $$\n    This is the well-known Kulik-Omelyanchuk result for a short diffusive junction.\n\n2.  **Long-junction regime**: This corresponds to $L \\to \\infty$, so $E_{\\text{Th}} \\to 0$. The argument $\\alpha_n \\to \\infty$. We use $\\sinh(z) \\approx e^z/2$ for large $z$.\n    $$ I_c(T) \\approx \\frac{2\\pi k_B T}{e R_N} \\sum_{n=0}^\\infty \\frac{\\Delta^2(T)}{\\omega_n^2+\\Delta^2(T)} (2\\alpha_n e^{-\\alpha_n}) $$\n    The terms in the sum are exponentially suppressed. The dominant contribution comes from the lowest Matsubara frequency, $\\omega_0 = \\pi k_B T$.\n    $$ I_c(T) \\propto \\frac{k_B T}{e R_N} \\frac{\\Delta^2(T)}{(\\pi k_B T)^2+\\Delta^2(T)} \\sqrt{\\frac{2\\pi k_B T}{E_{\\text{Th}}}} \\exp\\left(-\\sqrt{\\frac{2\\pi k_B T}{E_{\\text{Th}}}}\\right) $$\n    The critical current decays exponentially with $L/\\sqrt{D}$, which is characteristic of the long junction limit.\n\n**Crossover**: The crossover between the short- and long-junction regimes occurs when the argument of the sinh function, $\\alpha_n$, is of order unity for the frequencies that dominate the sum. At finite temperatures, the dominant frequency contributing to the sum is typically the lowest one, $\\omega_0 = \\pi k_B T$. The crossover condition is thus $\\alpha_0 = \\sqrt{2\\pi k_B T / E_{\\text{Th}}} \\sim 1$, or $E_{\\text{Th}} \\sim \\pi k_B T$. At very low temperatures, the sum is dominated by frequencies $\\omega_n \\sim \\Delta(T)$. The crossover condition becomes $\\sqrt{2\\Delta(T)/E_{\\text{Th}}} \\sim 1$, or $E_{\\text{Th}} \\sim \\Delta(T)$. Therefore, the crossover is generally set by the competition between the Thouless energy $E_{\\text{Th}}$ and the characteristic energy scales of the superconductors, namely $\\max(k_B T, \\Delta(T))$. The junction is \"short\" if $E_{\\text{Th}} \\gg \\max(k_B T, \\Delta(T))$ and \"long\" if $E_{\\text{Th}} \\ll \\max(k_B T, \\Delta(T))$.", "answer": "$$\\boxed{I_c(T) = \\frac{2\\pi k_B T}{e R_N} \\sum_{n=0}^\\infty \\frac{\\Delta^2(T)}{((2n+1)\\pi k_B T)^2 + \\Delta^2(T)} \\frac{\\sqrt{\\frac{2(2n+1)\\pi k_B T}{E_{\\text{Th}}}}}{\\sinh\\left(\\sqrt{\\frac{2(2n+1)\\pi k_B T}{E_{\\text{Th}}}}\\right)}}$$", "id": "3010913"}, {"introduction": "This final practice moves beyond static equilibrium to explore the rich dynamics of a driven system, a scenario central to many experimental investigations and applications. Here, you will model the non-equilibrium response of an SNS junction to an applied AC microwave field, a classic configuration that gives rise to the Shapiro effect. By implementing an adiabatic approximation of the time-dependent Keldysh-Usadel theory [@problem_id:3010891], you will computationally demonstrate how the interplay between the AC drive and the Josephson frequency leads to the emergence of quantized DC current steps, bridging the gap between quasiclassical theory and observable quantum phenomena.", "problem": "Consider a one-dimensional diffusive superconductor-normal metal-superconductor (SNS) weak link of length much shorter than the coherence length, contacted by bulk superconducting reservoirs. An external drive consisting of a direct-current (DC) voltage bias and a monochromatic alternating-current (AC) microwave voltage is applied across the junction, so that the scalar potential drop across the normal region is time dependent. In the dirty (diffusive) limit, the quasiclassical Keldysh-Usadel formulation provides the appropriate framework for the proximity effect. The retarded/advanced quasiclassical Green’s functions in N satisfy the Usadel equation, the Keldysh component encodes the time-dependent distribution, and the boundary conditions at the interfaces are of Kupriyanov-Lukichev type. In the adiabatic low-frequency regime, where the drive frequency is small compared to the intrinsic spectral scales and inelastic scattering can be neglected, the time dependence can be consistently absorbed into a time-dependent superconducting phase difference, with the Josephson relation relating the phase velocity to the applied voltage.\n\nWork in normalized units where $\\hbar = 1$ and $2e = 1$, so that the instantaneous superconducting phase difference obeys\n$$\n\\frac{d\\varphi}{dt} = V(t),\n$$\nwith $V(t) = V_{\\mathrm{dc}} + V_{\\mathrm{ac}} \\cos(\\omega t)$. In this adiabatic reduction of the time-dependent Keldysh-Usadel framework, the proximity supercurrent at time $t$ can be modeled as a functional of the instantaneous phase $\\varphi(t)$ using the stationary current-phase relation obtained from the Usadel equation. For a short diffusive SNS junction at low temperature, this stationary relation can be accurately represented by a truncated sine-Fourier expansion with the first two harmonics:\n$$\nI_{\\mathrm{eq}}(\\varphi) = c_1 \\sin(\\varphi) + c_2 \\sin(2\\varphi),\n$$\nwhere $c_1$ and $c_2$ are real constants determined by the junction parameters. The time-dependent phase is then\n$$\n\\varphi(t) = \\varphi_0 + \\int_0^t V(t')\\,dt' = \\varphi_0 + V_{\\mathrm{dc}} t + \\frac{V_{\\mathrm{ac}}}{\\omega} \\sin(\\omega t).\n$$\n\nYour task is to implement a program that, for a given set of parameters $(c_1, c_2, \\omega, V_{\\mathrm{dc}}, V_{\\mathrm{ac}}, \\varphi_0)$, computes the long-time average (the direct-current component) of the proximity supercurrent\n$$\n\\overline{I} = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T I_{\\mathrm{eq}}(\\varphi(t))\\,dt,\n$$\nusing the adiabatic reduction of the time-dependent Keldysh-Usadel equations described above. Angles must be treated in radians. Express the final answer as a dimensionless number, since the current is normalized by $c_1$ in these units. Round each result to six decimal places.\n\nTest suite:\n- Use the following six parameter sets, each given as $(c_1, c_2, \\omega, V_{\\mathrm{dc}}, V_{\\mathrm{ac}}, \\varphi_0)$, with all angles in radians:\n    - Case 1 (baseline DC Josephson with AC suppression at zero DC bias): $(1.0, 0.25, 1.0, 0.0, 0.8, 0.5)$.\n    - Case 2 (first Shapiro-like locking condition): $(1.0, 0.25, 1.0, 1.0, 1.2, 0.5)$.\n    - Case 3 (off-resonant bias, no locking): $(1.0, 0.25, 1.0, 0.9, 1.2, 0.5)$.\n    - Case 4 (second integer locking): $(1.0, 0.25, 1.0, 2.0, 1.5, 0.5)$.\n    - Case 5 (half-integer locking enabled by the second harmonic): $(1.0, 0.25, 1.0, 0.5, 1.5, 0.5)$.\n    - Case 6 (no microwave field at finite DC bias): $(1.0, 0.25, 1.0, 1.0, 0.0, 0.5)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5,result6]\"), where each result is the rounded time-averaged current for the corresponding case.\n\nImportant implementation notes:\n- Treat angles in radians.\n- Use the normalized adiabatic model described above; do not introduce any additional physical scales.\n- In these normalized units, define the phase as $\\varphi(t) = \\varphi_0 + V_{\\mathrm{dc}} t + (V_{\\mathrm{ac}}/\\omega)\\sin(\\omega t)$ and compute the infinite-time average of $I_{\\mathrm{eq}}(\\varphi(t))$.\n- Return the six dimensionless averages in the exact output format specified, each rounded to six decimal places.", "solution": "The problem asks for the computation of the long-time average of the proximity supercurrent, $\\overline{I}$, in a superconductor-normal metal-superconductor (SNS) junction under a combined DC and AC voltage bias. The provided model is an adiabatic reduction of the time-dependent Keldysh-Usadel theory.\n\nThe instantaneous current $I(t)$ is given by the stationary current-phase relation evaluated at the time-dependent phase difference $\\varphi(t)$:\n$$\nI(t) = I_{\\mathrm{eq}}(\\varphi(t)) = c_1 \\sin(\\varphi(t)) + c_2 \\sin(2\\varphi(t))\n$$\nThe phase $\\varphi(t)$ evolves according to the generalized Josephson relation $\\frac{d\\varphi}{dt} = V(t)$, where $V(t) = V_{\\mathrm{dc}} + V_{\\mathrm{ac}} \\cos(\\omega t)$. Integrating the voltage gives the phase:\n$$\n\\varphi(t) = \\varphi_0 + V_{\\mathrm{dc}} t + \\frac{V_{\\mathrm{ac}}}{\\omega} \\sin(\\omega t)\n$$\nwhere $\\varphi_0$ is the initial phase difference at $t=0$.\n\nThe primary task is to calculate the long-time average of the current, defined as:\n$$\n\\overline{I} = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T I_{\\mathrm{eq}}(\\varphi(t))\\,dt\n$$\nDue to the linearity of the integration operator and the limit, we can compute the average of each term in $I_{\\mathrm{eq}}$ separately and sum the results:\n$$\n\\overline{I} = c_1 \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T \\sin(\\varphi(t))\\,dt + c_2 \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T \\sin(2\\varphi(t))\\,dt = \\overline{I_1} + \\overline{I_2}\n$$\nTo evaluate these time averages, we employ the Jacobi-Anger expansion, which expresses a plane wave with sinusoidal phase modulation as a sum over harmonics weighted by Bessel functions of the first kind, $J_n(z)$. The expansion is:\n$$\ne^{iz \\sin(\\theta)} = \\sum_{n=-\\infty}^{\\infty} J_n(z) e^{in\\theta}\n$$\n\nLet's first analyze the time average of the term $\\sin(\\varphi(t))$, which we can write as the imaginary part of $e^{i\\varphi(t)}$:\n$$\n\\overline{\\sin(\\varphi(t))} = \\text{Im} \\left( \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T e^{i\\varphi(t)}\\,dt \\right)\n$$\nSubstituting the expression for $\\varphi(t)$:\n$$\ne^{i\\varphi(t)} = e^{i(\\varphi_0 + V_{\\mathrm{dc}} t + \\frac{V_{\\mathrm{ac}}}{\\omega} \\sin(\\omega t))} = e^{i\\varphi_0} e^{iV_{\\mathrm{dc}} t} e^{i\\frac{V_{\\mathrm{ac}}}{\\omega} \\sin(\\omega t)}\n$$\nApplying the Jacobi-Anger expansion with $z = V_{\\mathrm{ac}}/\\omega$ and $\\theta = \\omega t$:\n$$\ne^{i\\varphi(t)} = e^{i\\varphi_0} e^{iV_{\\mathrm{dc}} t} \\sum_{n=-\\infty}^{\\infty} J_n\\left(\\frac{V_{\\mathrm{ac}}}{\\omega}\\right) e^{in\\omega t} = \\sum_{n=-\\infty}^{\\infty} J_n\\left(\\frac{V_{\\mathrm{ac}}}{\\omega}\\right) e^{i(\\varphi_0 + (V_{\\mathrm{dc}} + n\\omega)t)}\n$$\nThe time average of a complex exponential $e^{i(A+Bt)}$ is non-zero only if the frequency term $B$ is zero. In that case, the average is simply $e^{iA}$. For any non-zero $B$, the average is zero.\nTherefore, the time average of $e^{i\\varphi(t)}$ is non-zero only if the condition $V_{\\mathrm{dc}} + n\\omega = 0$ is met for some integer $n$. This means the DC voltage must be an integer multiple of the drive frequency, $V_{\\mathrm{dc}} = -n\\omega$. Let's define $k = -n$, so $V_{\\mathrm{dc}} = k\\omega$ for an integer $k$.\n\nIf $V_{\\mathrm{dc}} = k\\omega$, the only non-vanishing term in the sum is for $n=-k$. The time average is:\n$$\n\\langle e^{i\\varphi(t)} \\rangle = J_{-k}\\left(\\frac{V_{\\mathrm{ac}}}{\\omega}\\right) e^{i\\varphi_0}\n$$\nThe average of the first current component $\\overline{I_1}$ is then:\n$$\n\\overline{I_1} = c_1 \\text{Im} \\left[ J_{-k}\\left(\\frac{V_{\\mathrm{ac}}}{\\omega}\\right) e^{i\\varphi_0} \\right] = c_1 J_{-k}\\left(\\frac{V_{\\mathrm{ac}}}{\\omega}\\right) \\sin(\\varphi_0)\n$$\nIf $V_{\\mathrm{dc}}$ is not an integer multiple of $\\omega$, then $\\overline{I_1} = 0$.\n\nNext, we follow the same procedure for the second term, $\\overline{I_2} = c_2 \\langle \\sin(2\\varphi(t)) \\rangle$. We analyze the time average of $e^{i2\\varphi(t)}$:\n$$\ne^{i2\\varphi(t)} = e^{i2(\\varphi_0 + V_{\\mathrm{dc}} t + \\frac{V_{\\mathrm{ac}}}{\\omega} \\sin(\\omega t))} = e^{i2\\varphi_0} e^{i2V_{\\mathrm{dc}} t} e^{i\\frac{2V_{\\mathrm{ac}}}{\\omega} \\sin(\\omega t)}\n$$\nApplying the Jacobi-Anger expansion with $z = 2V_{\\mathrm{ac}}/\\omega$ and $\\theta = \\omega t$:\n$$\ne^{i2\\varphi(t)} = \\sum_{m=-\\infty}^{\\infty} J_m\\left(\\frac{2V_{\\mathrm{ac}}}{\\omega}\\right) e^{i(2\\varphi_0 + (2V_{\\mathrm{dc}} + m\\omega)t)}\n$$\nThe time average is non-zero only if $2V_{\\mathrm{dc}} + m\\omega = 0$ for some integer $m$, which means the DC voltage must be a half-integer multiple of the drive frequency, $V_{\\mathrm{dc}} = -m\\omega/2$. Let's define $p = -m$, so $V_{\\mathrm{dc}} = p\\omega/2$ for an integer $p$.\n\nIf $V_{\\mathrm{dc}} = p\\omega/2$, the only non-vanishing term corresponds to $m=-p$. The time average is:\n$$\n\\langle e^{i2\\varphi(t)} \\rangle = J_{-p}\\left(\\frac{2V_{\\mathrm{ac}}}{\\omega}\\right) e^{i2\\varphi_0}\n$$\nThe average of the second current component $\\overline{I_2}$ is:\n$$\n\\overline{I_2} = c_2 \\text{Im} \\left[ J_{-p}\\left(\\frac{2V_{\\mathrm{ac}}}{\\omega}\\right) e^{i2\\varphi_0} \\right] = c_2 J_{-p}\\left(\\frac{2V_{\\mathrm{ac}}}{\\omega}\\right) \\sin(2\\varphi_0)\n$$\nIf $V_{\\mathrm{dc}}$ is not a half-integer multiple of $\\omega$, then $\\overline{I_2} = 0$.\n\nThe total time-averaged current $\\overline{I}$ is the sum $\\overline{I_1} + \\overline{I_2}$. The implementation will involve checking if $V_{\\mathrm{dc}}/\\omega$ is an integer for the first term and if $2V_{\\mathrm{dc}}/\\omega$ is an integer for the second, using a small tolerance for floating-point comparisons. If the conditions are met, the corresponding contributions are calculated using Bessel functions from the `scipy.special` library and summed.\n\nThe algorithm is as follows:\nFor each parameter set $(c_1, c_2, \\omega, V_{\\mathrm{dc}}, V_{\\mathrm{ac}}, \\varphi_0)$:\n1. Initialize $\\overline{I} = 0$.\n2. Calculate the ratio $r_1 = V_{\\mathrm{dc}}/\\omega$. If $r_1$ is an integer (within a small tolerance), let $k = \\text{round}(r_1)$. Calculate the first contribution $\\overline{I_1} = c_1 J_{-k}(V_{\\mathrm{ac}}/\\omega) \\sin(\\varphi_0)$ and add it to $\\overline{I}$.\n3. Calculate the ratio $r_2 = 2V_{\\mathrm{dc}}/\\omega$. If $r_2$ is an integer (within a small tolerance), let $p = \\text{round}(r_2)$. Calculate the second contribution $\\overline{I_2} = c_2 J_{-p}(2V_{\\mathrm{ac}}/\\omega) \\sin(2\\varphi_0)$ and add it to $\\overline{I}$.\n4. The final result for the case is $\\overline{I}$.\nThis procedure is applied to all test cases. The non-zero DC currents calculated correspond to the well-known Shapiro steps (integer steps from $\\sin(\\varphi)$ and half-integer steps from $\\sin(2\\varphi)$) in the current-voltage characteristic of the driven junction.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jv\n\ndef solve():\n    \"\"\"\n    Computes the long-time average of the proximity supercurrent for a set of parameters.\n    \"\"\"\n    # Test cases: (c1, c2, omega, V_dc, V_ac, phi_0)\n    test_cases = [\n        # Case 1 (baseline DC Josephson with AC suppression at zero DC bias)\n        (1.0, 0.25, 1.0, 0.0, 0.8, 0.5),\n        # Case 2 (first Shapiro-like locking condition)\n        (1.0, 0.25, 1.0, 1.0, 1.2, 0.5),\n        # Case 3 (off-resonant bias, no locking)\n        (1.0, 0.25, 1.0, 0.9, 1.2, 0.5),\n        # Case 4 (second integer locking)\n        (1.0, 0.25, 1.0, 2.0, 1.5, 0.5),\n        # Case 5 (half-integer locking enabled by the second harmonic)\n        (1.0, 0.25, 1.0, 0.5, 1.5, 0.5),\n        # Case 6 (no microwave field at finite DC bias)\n        (1.0, 0.25, 1.0, 1.0, 0.0, 0.5),\n    ]\n\n    results = []\n    # Tolerance for checking if a float is an integer\n    tolerance = 1e-9\n\n    for case in test_cases:\n        c1, c2, omega, V_dc, V_ac, phi_0 = case\n        \n        I_bar = 0.0\n        \n        # Contribution from the first harmonic term: c1 * sin(phi)\n        I_bar_1 = 0.0\n        # Check if V_dc is an integer multiple of omega\n        ratio_1 = V_dc / omega\n        if abs(ratio_1 - round(ratio_1))  tolerance:\n            k = int(round(ratio_1))\n            k_index = -k\n            z1 = V_ac / omega\n            I_bar_1 = c1 * jv(k_index, z1) * np.sin(phi_0)\n            \n        # Contribution from the second harmonic term: c2 * sin(2*phi)\n        I_bar_2 = 0.0\n        # Check if 2*V_dc is an integer multiple of omega, i.e., V_dc is a half-integer multiple of omega\n        ratio_2 = 2 * V_dc / omega\n        if abs(ratio_2 - round(ratio_2))  tolerance:\n            p = int(round(ratio_2))\n            p_index = -p\n            z2 = 2 * V_ac / omega\n            I_bar_2 = c2 * jv(p_index, z2) * np.sin(2 * phi_0)\n            \n        I_bar = I_bar_1 + I_bar_2\n        results.append(round(I_bar, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3010891"}]}