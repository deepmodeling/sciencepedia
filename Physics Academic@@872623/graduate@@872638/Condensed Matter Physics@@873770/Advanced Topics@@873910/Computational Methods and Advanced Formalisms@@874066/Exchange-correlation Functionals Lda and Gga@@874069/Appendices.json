{"hands_on_practices": [{"introduction": "The power of Kohn-Sham DFT lies in mapping the complex many-body problem onto a simpler system of non-interacting electrons moving in an effective potential. A crucial component of this potential is the exchange-correlation potential, $v_{xc}(\\mathbf{r})$, which is formally defined as the functional derivative of the exchange-correlation energy, $E_{xc}[n]$, with respect to the electron density $n(\\mathbf{r})$. This exercise provides direct practice in applying the rules of functional calculus to derive the LDA correlation potential, $v_c^{\\text{LDA}}$, from its corresponding energy functional, making the abstract definition concrete [@problem_id:2987547].", "problem": "Consider Kohn–Sham density functional theory (DFT), in which the correlation energy within the Local Density Approximation (LDA) is modeled by the functional $$E_{c}^{\\text{LDA}}[n]=\\int d^{3}r\\,n(\\mathbf{r})\\,\\varepsilon_{c}\\!\\left(r_{s}(n(\\mathbf{r}))\\right),$$ where the Wigner–Seitz radius is defined in atomic units as $$r_{s}(n)=\\left(\\frac{3}{4\\pi n}\\right)^{1/3}.$$ The LDA correlation potential is given by the functional derivative $$v_{c}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{c}^{\\text{LDA}}[n]}{\\delta n(\\mathbf{r})}.$$ Assume a uniform electron gas so that $n(\\mathbf{r})=n_{0}$ is constant, and consider the following parametrization of the correlation energy per electron in atomic units (Hartree): $$\\varepsilon_{c}(r_{s})=-\\frac{\\alpha}{1+\\beta r_{s}+\\gamma r_{s}^{2}},$$ with $\\alpha=0.08$, $\\beta=0.9$, and $\\gamma=0.1$. Starting from the definitions above and using only standard calculus and functional differentiation, derive the expression for $v_{c}^{\\text{LDA}}$ as a function of $n$, and then evaluate it at the density corresponding to $r_{s}=2$. Express the final energy in Hartree. Round your answer to four significant figures.", "solution": "The problem requires the derivation and evaluation of the correlation potential, $v_{c}^{\\text{LDA}}$, within the Local Density Approximation (LDA) of Kohn-Sham Density Functional Theory (DFT). The starting point is the definition of the correlation energy functional and the correlation potential as its functional derivative.\n\nThe correlation energy functional is given as:\n$$E_{c}^{\\text{LDA}}[n]=\\int d^{3}r\\,n(\\mathbf{r})\\,\\varepsilon_{c}\\!\\left(r_{s}(n(\\mathbf{r}))\\right)$$\nwhere $n(\\mathbf{r})$ is the electron density, and $\\varepsilon_{c}$ is the correlation energy per particle in a uniform electron gas. $\\varepsilon_{c}$ is a function of the Wigner-Seitz radius, $r_s$, which is itself a function of the local density:\n$$r_{s}(n)=\\left(\\frac{3}{4\\pi n}\\right)^{1/3}$$\nThe correlation potential is defined as the functional derivative of the correlation energy with respect to the electron density:\n$$v_{c}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{c}^{\\text{LDA}}[n]}{\\delta n(\\mathbf{r})}$$\nTo compute this derivative, we use the chain rule for functional derivatives. The integrand is a function of the local density, $f(n(\\mathbf{r}')) = n(\\mathbf{r}') \\varepsilon_{c}(r_s(n(\\mathbf{r}')))$. For a functional of the general form $F[n] = \\int f(n(\\mathbf{r}')) \\,d^3r'$, its functional derivative is $\\frac{\\delta F[n]}{\\delta n(\\mathbf{r})} = \\frac{d f(n)}{dn}\\big|_{n=n(\\mathbf{r})}$.\nTherefore, the correlation potential is given by the ordinary derivative of the energy density term, $n\\varepsilon_{c}$, with respect to $n$:\n$$v_{c}^{\\text{LDA}}(n(\\mathbf{r})) = \\frac{d}{dn} \\left[ n\\,\\varepsilon_{c}(r_s(n)) \\right]_{n=n(\\mathbf{r})}$$\nUsing the product rule for differentiation, we get:\n$$v_{c}^{\\text{LDA}}(n) = \\frac{d(n)}{dn}\\varepsilon_{c}(r_s(n)) + n \\frac{d}{dn}\\left[\\varepsilon_{c}(r_s(n))\\right]$$\n$$v_{c}^{\\text{LDA}}(n) = \\varepsilon_{c}(r_s(n)) + n \\frac{d\\varepsilon_{c}}{dr_{s}}\\frac{dr_{s}}{dn}$$\nNext, we must find the derivative of $r_s$ with respect to $n$:\n$$r_{s}(n) = \\left(\\frac{3}{4\\pi}\\right)^{1/3} n^{-1/3}$$\n$$\\frac{dr_{s}}{dn} = \\left(\\frac{3}{4\\pi}\\right)^{1/3} \\left(-\\frac{1}{3} n^{-4/3}\\right) = -\\frac{1}{3} \\left(\\frac{3}{4\\pi n}\\right)^{1/3} \\frac{1}{n} = -\\frac{r_{s}}{3n}$$\nSubstituting this result back into the expression for $v_{c}^{\\text{LDA}}(n)$:\n$$v_{c}^{\\text{LDA}}(n) = \\varepsilon_{c}(r_s(n)) + n \\frac{d\\varepsilon_{c}}{dr_{s}} \\left(-\\frac{r_{s}}{3n}\\right)$$\nThis simplifies to a general expression for the LDA correlation potential in terms of $\\varepsilon_{c}(r_s)$ and its derivative. Since $r_s$ is a unique function of $n$, we can express the potential as a function of $r_s$:\n$$v_{c}^{\\text{LDA}}(r_s) = \\varepsilon_{c}(r_s) - \\frac{r_s}{3}\\frac{d\\varepsilon_{c}}{dr_{s}}$$\nThe problem provides a specific parametrization for $\\varepsilon_{c}(r_s)$:\n$$\\varepsilon_{c}(r_{s})=-\\frac{\\alpha}{1+\\beta r_{s}+\\gamma r_{s}^{2}} = -\\alpha(1+\\beta r_{s}+\\gamma r_{s}^{2})^{-1}$$\nWe compute its derivative with respect to $r_s$:\n$$\\frac{d\\varepsilon_{c}}{dr_{s}} = -\\alpha(-1)(1+\\beta r_{s}+\\gamma r_{s}^{2})^{-2} \\frac{d}{dr_s}(1+\\beta r_{s}+\\gamma r_{s}^{2})$$\n$$\\frac{d\\varepsilon_{c}}{dr_{s}} = \\frac{\\alpha(\\beta + 2\\gamma r_{s})}{(1+\\beta r_{s}+\\gamma r_{s}^{2})^2}$$\nNow, we substitute both $\\varepsilon_{c}(r_s)$ and its derivative into the expression for $v_{c}^{\\text{LDA}}(r_s)$:\n$$v_{c}^{\\text{LDA}}(r_s) = -\\frac{\\alpha}{1+\\beta r_{s}+\\gamma r_{s}^{2}} - \\frac{r_s}{3} \\left[ \\frac{\\alpha(\\beta + 2\\gamma r_{s})}{(1+\\beta r_{s}+\\gamma r_{s}^{2})^2} \\right]$$\nThis is the required expression for the correlation potential as a function of $r_s$, and by extension, as a function of $n$ via $r_{s}(n)=(3/(4\\pi n))^{1/3}$.\n\nThe final step is to evaluate this expression for the given parameters: $\\alpha=0.08$, $\\beta=0.9$, $\\gamma=0.1$, at a density corresponding to $r_s=2$.\n\nFirst, let's evaluate the denominator term $D = 1+\\beta r_{s}+\\gamma r_{s}^{2}$ at $r_s=2$:\n$$D = 1 + (0.9)(2) + (0.1)(2^2) = 1 + 1.8 + 0.1(4) = 1 + 1.8 + 0.4 = 3.2$$\nNow, we calculate the two terms of $v_{c}^{\\text{LDA}}(r_s=2)$:\nThe first term is $\\varepsilon_{c}(r_s=2)$:\n$$\\varepsilon_{c}(r_s=2) = -\\frac{\\alpha}{D} = -\\frac{0.08}{3.2} = -0.025 \\, \\text{Hartree}$$\nThe second term is $-\\frac{r_s}{3}\\frac{d\\varepsilon_{c}}{dr_{s}}$ evaluated at $r_s=2$:\n$$-\\frac{r_s}{3}\\frac{d\\varepsilon_{c}}{dr_{s}} = -\\frac{2}{3} \\left[ \\frac{\\alpha(\\beta + 2\\gamma r_{s})}{D^2} \\right]_{r_s=2}$$\nThe numerator inside the bracket is:\n$$\\alpha(\\beta + 2\\gamma(2)) = 0.08(0.9 + 2(0.1)(2)) = 0.08(0.9+0.4) = 0.08(1.3) = 0.104$$\nThe denominator is $D^2 = (3.2)^2 = 10.24$.\nSo, the second term is:\n$$-\\frac{2}{3} \\left( \\frac{0.104}{10.24} \\right) = -\\frac{0.208}{30.72} \\approx -0.006770833... \\, \\text{Hartree}$$\nThe total correlation potential is the sum of these two terms:\n$$v_{c}^{\\text{LDA}}(r_s=2) = -0.025 - 0.006770833... = -0.031770833... \\, \\text{Hartree}$$\nRounding the result to four significant figures, we get $-0.03177$.", "answer": "$$\\boxed{-0.03177}$$", "id": "2987547"}, {"introduction": "While powerful, approximate functionals like LDA and GGA suffer from fundamental limitations. One of the most significant is the self-interaction error (SIE), where an electron spuriously interacts with its own density. This exercise provides a clear, quantitative demonstration of the SIE by examining a simple one-electron system, for which the exact exchange energy must precisely cancel the artificial Hartree self-repulsion [@problem_id:2987515]. By calculating this residual error within LDA, you will gain insight into a key source of inaccuracy in many DFT calculations.", "problem": "A single-electron density in three dimensions is modeled by a normalized Gaussian of the form $n(\\mathbf{r}) = N \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp\\!\\left(-\\alpha r^{2}\\right)$ with $N=1$, where $\\alpha>0$ sets the localization scale. Work in atomic units so that the electron charge magnitude, reduced Planck constant, and electron mass are all unity. Treat the system as fully spin-polarized so that the spin-up density is $n_{\\uparrow}(\\mathbf{r})=n(\\mathbf{r})$ and the spin-down density is $n_{\\downarrow}(\\mathbf{r})=0$.\n\nStarting from the real-space definitions of the Hartree (classical Coulomb) energy and the exchange energy in the spin-dependent Local Density Approximation (LDA),\n- the Hartree energy $E_{H}[n]$ is given by $E_{H}[n] = \\frac{1}{2}\\int d^{3}r \\int d^{3}r' \\frac{n(\\mathbf{r})\\, n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$,\n- and the LDA exchange energy for a fully spin-polarized density is $E_{x}^{\\mathrm{LDA}}[n_{\\uparrow},n_{\\downarrow}] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int d^{3}r\\, n_{\\uparrow}(\\mathbf{r})^{4/3}$,\n\nderive closed-form expressions for $E_{H}$ and $E_{x}^{\\mathrm{LDA}}$ in terms of $\\alpha$. Using the fact that the exact exchange for a single electron cancels the Hartree energy, $E_{x}^{\\mathrm{exact}}=-E_{H}$, define the self-interaction error of LDA exchange as $S(\\alpha) \\equiv E_{H} + E_{x}^{\\mathrm{LDA}}$ and determine how it scales with $\\alpha$.\n\nAnswer specification:\n- Express your final answer as a single closed-form analytic expression for $S(\\alpha)$ involving only $\\alpha$ and mathematical constants.\n- Do not include units in the final answer. No numerical rounding is required.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. All necessary information is provided, and the requested calculations are standard within the framework of Density Functional Theory.\n\nThe one-electron density is given by $n(\\mathbf{r}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp(-\\alpha r^2)$, where the normalization $N=1$ is used. The system is fully spin-polarized, so $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$ and $n_{\\downarrow}(\\mathbf{r}) = 0$. We work in atomic units.\n\nFirst, we calculate the Hartree energy, $E_H[n]$, defined as:\n$$E_{H}[n] = \\frac{1}{2}\\int d^{3}r \\int d^{3}r' \\frac{n(\\mathbf{r})\\, n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$$\nThis expression is a convolution. It is most easily calculated in Fourier space. The Fourier transform of the density $n(\\mathbf{r})$ is $\\tilde{n}(\\mathbf{k}) = \\int d^3r\\, n(\\mathbf{r})e^{-i\\mathbf{k}\\cdot\\mathbf{r}}$. The Fourier transform of a normalized 3D Gaussian $n(\\mathbf{r}) = (\\frac{\\alpha}{\\pi})^{3/2}\\exp(-\\alpha r^2)$ is:\n$$\\tilde{n}(\\mathbf{k}) = \\exp\\left(-\\frac{k^2}{4\\alpha}\\right)$$\nwhere $k=|\\mathbf{k}|$.\nThe Fourier transform of the Coulomb kernel $\\frac{1}{|\\mathbf{r}|}$ is $\\frac{4\\pi}{k^2}$. Using the convolution theorem and Parseval's theorem, the Hartree energy can be expressed in k-space as:\n$$E_{H} = \\frac{1}{2} \\int \\frac{d^3k}{(2\\pi)^3} |\\tilde{n}(\\mathbf{k})|^2 \\left(\\frac{4\\pi}{k^2}\\right) = \\frac{2\\pi}{(2\\pi)^3} \\int d^3k \\frac{|\\tilde{n}(\\mathbf{k})|^2}{k^2}$$\nSubstituting the expression for $\\tilde{n}(\\mathbf{k})$:\n$$E_{H} = \\frac{1}{4\\pi^2} \\int d^3k \\frac{\\left|\\exp\\left(-\\frac{k^2}{4\\alpha}\\right)\\right|^2}{k^2} = \\frac{1}{4\\pi^2} \\int d^3k \\frac{\\exp\\left(-\\frac{k^2}{2\\alpha}\\right)}{k^2}$$\nThe integrand is spherically symmetric, so we integrate in spherical coordinates in k-space ($d^3k = 4\\pi k^2 dk$):\n$$E_{H} = \\frac{1}{4\\pi^2} \\int_0^\\infty 4\\pi k^2 dk \\frac{\\exp\\left(-\\frac{k^2}{2\\alpha}\\right)}{k^2} = \\frac{1}{\\pi} \\int_0^\\infty \\exp\\left(-\\frac{k^2}{2\\alpha}\\right) dk$$\nThis is a standard Gaussian integral of the form $\\int_0^\\infty \\exp(-ax^2)dx = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$. Here, $a = \\frac{1}{2\\alpha}$.\n$$E_{H} = \\frac{1}{\\pi} \\left(\\frac{1}{2}\\sqrt{\\frac{\\pi}{1/(2\\alpha)}}\\right) = \\frac{1}{2\\pi}\\sqrt{2\\pi\\alpha} = \\sqrt{\\frac{2\\pi\\alpha}{4\\pi^2}} = \\sqrt{\\frac{\\alpha}{2\\pi}}$$\nThus, the Hartree energy is $E_{H} = \\left(\\frac{\\alpha}{2\\pi}\\right)^{1/2}$.\n\nNext, we calculate the exchange energy in the Local Density Approximation (LDA), as defined in the problem for a fully spin-polarized system:\n$$E_{x}^{\\mathrm{LDA}}[n_{\\uparrow}, n_{\\downarrow}] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int d^{3}r\\, n_{\\uparrow}(\\mathbf{r})^{4/3}$$\nWith $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$, we first evaluate the term $n(\\mathbf{r})^{4/3}$:\n$$n(\\mathbf{r})^{4/3} = \\left[ \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp(-\\alpha r^2) \\right]^{4/3} = \\left(\\frac{\\alpha}{\\pi}\\right)^2 \\exp\\left(-\\frac{4}{3}\\alpha r^2\\right)$$\nNow we compute the integral $\\int d^3r\\, n(\\mathbf{r})^{4/3}$ in spherical coordinates:\n$$\\int d^3r\\, n(\\mathbf{r})^{4/3} = \\int_0^\\infty 4\\pi r^2 dr \\left(\\frac{\\alpha}{\\pi}\\right)^2 \\exp\\left(-\\frac{4}{3}\\alpha r^2\\right) = 4\\pi\\left(\\frac{\\alpha}{\\pi}\\right)^2 \\int_0^\\infty r^2 \\exp\\left(-\\frac{4}{3}\\alpha r^2\\right) dr$$\nUsing the standard integral $\\int_0^\\infty x^2 e^{-ax^2}dx = \\frac{1}{4}\\sqrt{\\frac{\\pi}{a^3}}$ with $a=\\frac{4\\alpha}{3}$:\n$$\\int_0^\\infty r^2 \\exp\\left(-\\frac{4\\alpha}{3} r^2\\right) dr = \\frac{1}{4}\\sqrt{\\frac{\\pi}{(4\\alpha/3)^3}} = \\frac{1}{4}\\sqrt{\\frac{27\\pi}{64\\alpha^3}} = \\frac{3\\sqrt{3\\pi}}{32\\alpha^{3/2}}$$\nSubstituting this result back into the integral for $n^{4/3}$:\n$$\\int d^3r\\, n(\\mathbf{r})^{4/3} = 4\\pi\\frac{\\alpha^2}{\\pi^2} \\left(\\frac{3\\sqrt{3\\pi}}{32\\alpha^{3/2}}\\right) = \\frac{4\\alpha^2}{\\pi} \\frac{3\\cdot 3^{1/2}\\pi^{1/2}}{32\\alpha^{3/2}} = \\frac{12 \\cdot 3^{1/2} \\alpha^{1/2}}{32 \\pi^{1/2}} = \\frac{3 \\cdot 3^{1/2} \\alpha^{1/2}}{8 \\pi^{1/2}} = \\frac{3^{3/2}}{8} \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2}$$\nNow, we can find the LDA exchange energy:\n$$E_{x}^{\\mathrm{LDA}} = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left[ \\frac{3^{3/2}}{8} \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\right] = -\\frac{3^1 \\cdot 3^{1/3} \\cdot 3^{3/2}}{4 \\cdot 8} \\frac{\\alpha^{1/2}}{\\pi^{1/3}\\pi^{1/2}}$$\nCombining the exponents for $3$ and $\\pi$:\n$$1 + \\frac{1}{3} + \\frac{3}{2} = \\frac{6+2+9}{6} = \\frac{17}{6}$$\n$$\\frac{1}{3} + \\frac{1}{2} = \\frac{2+3}{6} = \\frac{5}{6}$$\n$$E_{x}^{\\mathrm{LDA}} = -\\frac{3^{17/6}}{32} \\frac{\\alpha^{1/2}}{\\pi^{5/6}} = -\\frac{3^{17/6}}{32\\pi^{5/6}} \\alpha^{1/2}$$\nThe self-interaction error $S(\\alpha)$ is defined as $S(\\alpha) = E_{H} + E_{x}^{\\mathrm{LDA}}$.\n$$S(\\alpha) = \\left(\\frac{\\alpha}{2\\pi}\\right)^{1/2} - \\frac{3^{17/6}}{32\\pi^{5/6}} \\alpha^{1/2} = \\left( \\frac{1}{(2\\pi)^{1/2}} - \\frac{3^{17/6}}{32\\pi^{5/6}} \\right) \\alpha^{1/2}$$\nThis expression shows that the self-interaction error scales as $\\alpha^{1/2}$. To present a single closed-form expression, we combine the constant prefactors over a common denominator.\nThe first term's prefactor is $\\frac{1}{2^{1/2}\\pi^{1/2}}$. The second is $-\\frac{3^{17/6}}{32\\pi^{5/6}}$. The common denominator is $32\\pi^{5/6}$.\nRewriting the first term's prefactor:\n$$ \\frac{1}{2^{1/2}\\pi^{3/6}} = \\frac{16 \\cdot 2^{1/2} \\pi^{2/6}}{16 \\cdot 2^{1/2} \\pi^{2/6}} \\cdot \\frac{1}{2^{1/2}\\pi^{3/6}} = \\frac{16 \\cdot 2^{1/2} \\pi^{1/3}}{32\\pi^{5/6}} $$\nCombining with the second term:\n$$S(\\alpha) = \\left( \\frac{16 \\cdot 2^{1/2} \\pi^{1/3} - 3^{17/6}}{32\\pi^{5/6}} \\right) \\alpha^{1/2}$$\nThis is the final closed-form expression for the self-interaction error $S(\\alpha)$.", "answer": "$$\\boxed{\\left( \\frac{16 \\cdot 2^{1/2} \\pi^{1/3} - 3^{17/6}}{32\\pi^{5/6}} \\right) \\alpha^{1/2}}$$", "id": "2987515"}, {"introduction": "Ultimately, the value of an exchange-correlation functional is determined by its ability to predict measurable physical properties. This exercise moves from formal properties to practical performance by simulating a common task in computational materials science: benchmarking functional accuracy for the cohesive energy of solids. By analyzing a set of hypothetical but plausible computed data, you will identify the well-known systematic trends of LDA and GGA—namely, LDA's tendency to overbind and GGA's general improvement—and explore how these errors correlate with the physical characteristics of the material [@problem_id:2987552].", "problem": "You are given a set of monatomic solids with reference cohesive energies computed from high-level benchmarks, along with cohesive energies predicted by two exchange-correlation approximations in Density Functional Theory (DFT): the Local Density Approximation (LDA) and the Generalized Gradient Approximation (GGA). For each solid, you are also given the valence electron density parameter $r_s$ (the Wigner-Seitz radius in Bohr radii corresponding to the valence electron density).\n\nStarting from the foundation of Kohn-Sham Density Functional Theory (DFT), the cohesive energy per atom is defined as the difference between the total energy per atom in the solid and the energy of an isolated atom, both evaluated with the same approximation. The exchange-correlation contribution is approximated either locally in LDA or with density gradients in GGA. Your task is to compute the relative error in cohesive energy for each solid under both LDA and GGA compared to the reference values, then quantify the trend of these errors with the valence electron density parameter $r_s$.\n\nDefinitions and requirements:\n- The relative error in cohesive energy for a method is defined for each solid as $$\\varepsilon = \\frac{E_{\\text{method}} - E_{\\text{ref}}}{E_{\\text{ref}}},$$ where $E_{\\text{ref}}$ is the reference cohesive energy per atom, and $E_{\\text{method}}$ is the cohesive energy per atom from LDA or GGA.\n- The Pearson correlation coefficient between a list of $r_s$ values and a list of relative errors $\\varepsilon$ must be computed using $$\\rho = \\frac{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)(\\varepsilon^{(i)} - \\bar{\\varepsilon})}{\\sqrt{\\left[\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)^2\\right]\\left[\\sum_{i=1}^{N} (\\varepsilon^{(i)} - \\bar{\\varepsilon})^2\\right]}},$$ where $\\bar{r}_s$ and $\\bar{\\varepsilon}$ are the sample means of $r_s$ and $\\varepsilon$ respectively.\n- The least-squares slope of the linear fit of $\\varepsilon$ versus $r_s$ must be computed as $$m = \\frac{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)(\\varepsilon^{(i)} - \\bar{\\varepsilon})}{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)^2}.$$\n- A monotonic trend indicator should be provided for each method: return $\\,\\texttt{True}\\,$ if the slope $m$ is positive (indicating an increasing trend of error with $r_s$), and $\\,\\texttt{False}\\,$ otherwise.\n\nUse the following test suite of $N=5$ monatomic solids. All cohesive energies are given in electronvolts per atom, and $r_s$ is dimensionless in Bohr units. The program should treat these as exact inputs without performing any unit conversions. The values are chosen to be scientifically plausible and to span a range of $r_s$:\n- Solid $1$: $r_s = 3.25$, $E_{\\text{ref}} = 1.63$, $E_{\\text{LDA}} = 1.95$, $E_{\\text{GGA}} = 1.55$.\n- Solid $2$: $r_s = 3.93$, $E_{\\text{ref}} = 1.13$, $E_{\\text{LDA}} = 1.35$, $E_{\\text{GGA}} = 1.05$.\n- Solid $3$: $r_s = 2.07$, $E_{\\text{ref}} = 3.39$, $E_{\\text{LDA}} = 4.05$, $E_{\\text{GGA}} = 3.36$.\n- Solid $4$: $r_s = 2.01$, $E_{\\text{ref}} = 4.63$, $E_{\\text{LDA}} = 5.30$, $E_{\\text{GGA}} = 4.60$.\n- Solid $5$: $r_s = 4.96$, $E_{\\text{ref}} = 0.93$, $E_{\\text{LDA}} = 1.10$, $E_{\\text{GGA}} = 0.85$.\n\nYour program must:\n1. Compute the list of relative errors for LDA, $$\\{\\varepsilon_{\\text{LDA}}^{(i)}\\}_{i=1}^{5},$$ and for GGA, $$\\{\\varepsilon_{\\text{GGA}}^{(i)}\\}_{i=1}^{5}.$$\n2. Compute the Pearson correlation coefficients $\\rho_{\\text{LDA}}$ and $\\rho_{\\text{GGA}}$ between $r_s$ and the corresponding error lists.\n3. Compute the least-squares slopes $m_{\\text{LDA}}$ and $m_{\\text{GGA}}$ for the linear fits of error versus $r_s$.\n4. Compute the monotonic trend booleans for each method, defined as $\\,\\texttt{True}\\,$ if $m > 0$ and $\\,\\texttt{False}\\,$ if $m \\le 0$.\n\nAngle units are not applicable. Express all computed floating-point outputs rounded to six decimal places. The final output format must be a single line containing a comma-separated list enclosed in square brackets, structured as\n$$[\\,[\\varepsilon_{\\text{LDA}}^{(1)},\\ldots,\\varepsilon_{\\text{LDA}}^{(5)}],\\,[\\varepsilon_{\\text{GGA}}^{(1)},\\ldots,\\varepsilon_{\\text{GGA}}^{(5)}],\\,\\rho_{\\text{LDA}},\\,m_{\\text{LDA}},\\,\\rho_{\\text{GGA}},\\,m_{\\text{GGA}},\\,\\texttt{monotonic\\_LDA},\\,\\texttt{monotonic\\_GGA}\\,],$$\nwhere each $\\varepsilon$, $\\rho$, and $m$ is a float rounded to six decimal places, and the monotonicity indicators are booleans.\n\nThis design includes a general case and edge variety by covering low and high $r_s$ solids and a range of cohesive energies, testing both overbinding and underbinding regimes expected from LDA and GGA respectively. Your program should produce the specified single line with the exact output format.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of Density Functional Theory (DFT), a fundamental method in condensed matter physics. It is mathematically well-posed, with all necessary data and explicit, standard formulas provided for the required computations. The terms are defined unambiguously, and the data are physically plausible.\n\nOur objective is to analyze the performance of two common exchange-correlation functionals, the Local Density Approximation (LDA) and the Generalized Gradient Approximation (GGA), by quantifying the error in their predicted cohesive energies for a set of monatomic solids relative to benchmark reference values. We will then investigate if this error exhibits a systematic trend with the valence electron density, characterized by the Wigner-Seitz radius $r_s$.\n\nThe solution proceeds in three main steps:\n1.  Calculation of the relative error for each solid and each method.\n2.  Statistical analysis of the error as a function of $r_s$, including the computation of the least-squares slope and the Pearson correlation coefficient.\n3.  Assembly of the results into the specified output format.\n\nThe provided data for the $N=5$ solids are:\n- Solid $1$: $r_s^{(1)}=3.25$, $E_{\\text{ref}}^{(1)}=1.63$, $E_{\\text{LDA}}^{(1)}=1.95$, $E_{\\text{GGA}}^{(1)}=1.55$\n- Solid $2$: $r_s^{(2)}=3.93$, $E_{\\text{ref}}^{(2)}=1.13$, $E_{\\text{LDA}}^{(2)}=1.35$, $E_{\\text{GGA}}^{(2)}=1.05$\n- Solid $3$: $r_s^{(3)}=2.07$, $E_{\\text{ref}}^{(3)}=3.39$, $E_{\\text{LDA}}^{(3)}=4.05$, $E_{\\text{GGA}}^{(3)}=3.36$\n- Solid $4$: $r_s^{(4)}=2.01$, $E_{\\text{ref}}^{(4)}=4.63$, $E_{\\text{LDA}}^{(4)}=5.30$, $E_{\\text{GGA}}^{(4)}=4.60$\n- Solid $5$: $r_s^{(5)}=4.96$, $E_{\\text{ref}}^{(5)}=0.93$, $E_{\\text{LDA}}^{(5)}=1.10$, $E_{\\text{GGA}}^{(5)}=0.85$\n\nAll energies are in units of eV/atom, and $r_s$ is dimensionless.\n\n**Step 1: Calculation of Relative Errors**\n\nThe relative error $\\varepsilon$ for a given method (LDA or GGA) and a specific solid $i$ is defined as:\n$$ \\varepsilon^{(i)} = \\frac{E_{\\text{method}}^{(i)} - E_{\\text{ref}}^{(i)}}{E_{\\text{ref}}^{(i)}} $$\nA positive error indicates overestimation of the cohesive energy (overbinding), while a negative error indicates underestimation (underbinding).\n\nFor LDA:\n- $\\varepsilon_{\\text{LDA}}^{(1)} = (1.95 - 1.63) / 1.63 \\approx 0.196319$\n- $\\varepsilon_{\\text{LDA}}^{(2)} = (1.35 - 1.13) / 1.13 \\approx 0.194690$\n- $\\varepsilon_{\\text{LDA}}^{(3)} = (4.05 - 3.39) / 3.39 \\approx 0.194690$\n- $\\varepsilon_{\\text{LDA}}^{(4)} = (5.30 - 4.63) / 4.63 \\approx 0.144708$\n- $\\varepsilon_{\\text{LDA}}^{(5)} = (1.10 - 0.93) / 0.93 \\approx 0.182796$\nThe list of LDA relative errors is $\\{0.196319, 0.194690, 0.194690, 0.144708, 0.182796\\}$.\n\nFor GGA:\n- $\\varepsilon_{\\text{GGA}}^{(1)} = (1.55 - 1.63) / 1.63 \\approx -0.049080$\n- $\\varepsilon_{\\text{GGA}}^{(2)} = (1.05 - 1.13) / 1.13 \\approx -0.070796$\n- $\\varepsilon_{\\text{GGA}}^{(3)} = (3.36 - 3.39) / 3.39 \\approx -0.008850$\n- $\\varepsilon_{\\text{GGA}}^{(4)} = (4.60 - 4.63) / 4.63 \\approx -0.006479$\n- $\\varepsilon_{\\text{GGA}}^{(5)} = (0.85 - 0.93) / 0.93 \\approx -0.086022$\nThe list of GGA relative errors is $\\{-0.049080, -0.070796, -0.008850, -0.006479, -0.086022\\}$.\n\nAs expected from known trends in DFT, LDA consistently overestimates the cohesive energy, while GGA provides a correction, in this case leading to slight underestimation.\n\n**Step 2: Statistical Analysis**\n\nWe now compute the least-squares slope $m$ and the Pearson correlation coefficient $\\rho$ for the linear relationship between the relative errors $\\varepsilon$ and the Wigner-Seitz radii $r_s$. The formulas are:\n$$ m = \\frac{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)(\\varepsilon^{(i)} - \\bar{\\varepsilon})}{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)^2} $$\n$$ \\rho = \\frac{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)(\\varepsilon^{(i)} - \\bar{\\varepsilon})}{\\sqrt{\\left[\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)^2\\right]\\left[\\sum_{i=1}^{N} (\\varepsilon^{(i)} - \\bar{\\varepsilon})^2\\right]}} $$\nLet $x_i = r_s^{(i)}$ and $y_i = \\varepsilon^{(i)}$. The numerator in both expressions is the sum of products of deviations, $S_{xy} = \\sum_{i=1}^{N} (x_i - \\bar{x})(y_i - \\bar{y})$. The denominator for the slope is the sum of squared deviations for $x$, $S_{xx} = \\sum_{i=1}^{N} (x_i - \\bar{x})^2$, and for the correlation coefficient it is $\\sqrt{S_{xx} S_{yy}}$, where $S_{yy} = \\sum_{i=1}^{N} (y_i - \\bar{y})^2$.\n\nFirst, we compute sample means and sums of squares for the $r_s$ data, which are common to both LDA and GGA analyses.\nThe set of $r_s$ values is $\\{3.25, 3.93, 2.07, 2.01, 4.96\\}$.\nThe mean is $\\bar{r}_s = (3.25 + 3.93 + 2.07 + 2.01 + 4.96) / 5 = 3.244$.\nThe sum of squared deviations is $S_{xx} = \\sum_{i=1}^{5} (r_s^{(i)} - \\bar{r}_s)^2 \\approx 6.31632$.\n\n**Analysis for LDA:**\n- The mean relative error is $\\bar{\\varepsilon}_{\\text{LDA}} \\approx 0.182641$.\n- The sum of products of deviations is $S_{xy, \\text{LDA}} = \\sum (r_s^{(i)} - \\bar{r}_s)(\\varepsilon_{\\text{LDA}}^{(i)} - \\bar{\\varepsilon}_{\\text{LDA}}) \\approx 0.041277$.\n- The sum of squared deviations for error is $S_{yy, \\text{LDA}} = \\sum (\\varepsilon_{\\text{LDA}}^{(i)} - \\bar{\\varepsilon}_{\\text{LDA}})^2 \\approx 0.001916$.\n\nThe slope for LDA is:\n$$ m_{\\text{LDA}} = \\frac{S_{xy, \\text{LDA}}}{S_{xx}} \\approx \\frac{0.041277}{6.31632} \\approx 0.006535 $$\nSince $m_{\\text{LDA}} > 0$, the monotonic trend indicator for LDA is $\\texttt{True}$.\n\nThe Pearson correlation coefficient for LDA is:\n$$ \\rho_{\\text{LDA}} = \\frac{S_{xy, \\text{LDA}}}{\\sqrt{S_{xx} S_{yy, \\text{LDA}}}} \\approx \\frac{0.041277}{\\sqrt{6.31632 \\times 0.001916}} \\approx 0.375179 $$\nThe small positive correlation suggests a weak tendency for the LDA error to increase with $r_s$.\n\n**Analysis for GGA:**\n- The mean relative error is $\\bar{\\varepsilon}_{\\text{GGA}} \\approx -0.044245$.\n- The sum of products of deviations is $S_{xy, \\text{GGA}} = \\sum (r_s^{(i)} - \\bar{r}_s)(\\varepsilon_{\\text{GGA}}^{(i)} - \\bar{\\varepsilon}_{\\text{GGA}}) \\approx -0.178085$.\n- The sum of squared deviations for error is $S_{yy, \\text{GGA}} = \\sum (\\varepsilon_{\\text{GGA}}^{(i)} - \\bar{\\varepsilon}_{\\text{GGA}})^2 \\approx 0.005153$.\n\nThe slope for GGA is:\n$$ m_{\\text{GGA}} = \\frac{S_{xy, \\text{GGA}}}{S_{xx}} \\approx \\frac{-0.178085}{6.31632} \\approx -0.028197 $$\nSince $m_{\\text{GGA}} < 0$, the monotonic trend indicator for GGA is $\\texttt{False}$.\n\nThe Pearson correlation coefficient for GGA is:\n$$ \\rho_{\\text{GGA}} = \\frac{S_{xy, \\text{GGA}}}{\\sqrt{S_{xx} S_{yy, \\text{GGA}}}} \\approx \\frac{-0.178085}{\\sqrt{6.31632 \\times 0.005153}} \\approx -0.987156 $$\nThe strong negative correlation ($\\rho$ close to $-1$) indicates a clear trend: as $r_s$ increases (i.e., as the electron gas becomes less dense), the GGA cohesive energy becomes progressively more underestimated.\n\n**Step 3: Final Result Assembly**\n\nThe computed values are collected and formatted as required. All floating-point numbers are rounded to six decimal places.\n\n- List of LDA errors: $[0.196319, 0.194690, 0.194690, 0.144708, 0.182796]$\n- List of GGA errors: $[-0.049080, -0.070796, -0.008850, -0.006479, -0.086022]$\n- $\\rho_{\\text{LDA}} \\approx 0.375179$\n- $m_{\\text{LDA}} \\approx 0.006535$\n- $\\rho_{\\text{GGA}} \\approx -0.987156$\n- $m_{\\text{GGA}} \\approx -0.028197$\n- Monotonic trend for LDA: $\\texttt{True}$\n- Monotonic trend for GGA: $\\texttt{False}$\n\nThese results are combined into a single-line string as specified in the problem statement.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes relative errors in DFT cohesive energies and their correlation \n    with the electron density parameter r_s.\n    \"\"\"\n    \n    # The test suite of N=5 monatomic solids.\n    # Format: (r_s, E_ref, E_LDA, E_GGA)\n    test_cases = [\n        (3.25, 1.63, 1.95, 1.55),\n        (3.93, 1.13, 1.35, 1.05),\n        (2.07, 3.39, 4.05, 3.36),\n        (2.01, 4.63, 5.30, 4.60),\n        (4.96, 0.93, 1.10, 0.85),\n    ]\n\n    # Unpack the data into NumPy arrays for vectorized calculations.\n    rs_vals = np.array([case[0] for case in test_cases])\n    e_ref = np.array([case[1] for case in test_cases])\n    e_lda = np.array([case[2] for case in test_cases])\n    e_gga = np.array([case[3] for case in test_cases])\n\n    # 1. Compute the lists of relative errors for LDA and GGA.\n    # Formula: eps = (E_method - E_ref) / E_ref\n    eps_lda = (e_lda - e_ref) / e_ref\n    eps_gga = (e_gga - e_ref) / e_ref\n    \n    def compute_statistics(x, y):\n        \"\"\"\n        Helper function to compute Pearson correlation, least-squares slope, \n        and monotonic trend.\n        x: Independent variable (rs_vals)\n        y: Dependent variable (error values)\n        \"\"\"\n        # Calculate sample means\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n\n        # Calculate deviations from the mean\n        dx = x - x_mean\n        dy = y - y_mean\n        \n        # Calculate terms as per provided formulas\n        # Numerator for both slope and rho\n        # S_xy = sum((x_i - x_bar)(y_i - y_bar))\n        s_xy = np.sum(dx * dy)\n        \n        # Denominator term for slope\n        # S_xx = sum((x_i - x_bar)^2)\n        s_xx = np.sum(dx**2)\n        \n        # Denominator term for rho\n        s_yy = np.sum(dy**2)\n        \n        # 2. Compute least-squares slope m.\n        # m = S_xy / S_xx\n        # Handle potential division by zero, though unlikely with the given data.\n        m = s_xy / s_xx if s_xx != 0 else 0.0\n\n        # 3. Compute Pearson correlation coefficient rho.\n        # rho = S_xy / sqrt(S_xx * S_yy)\n        denom_rho = np.sqrt(s_xx * s_yy)\n        rho = s_xy / denom_rho if denom_rho != 0 else 0.0\n        \n        # 4. Compute the monotonic trend boolean.\n        monotonic_trend = m > 0\n        \n        return rho, m, monotonic_trend\n\n    # Perform statistical analysis for LDA errors vs. r_s\n    rho_lda, m_lda, monotonic_lda = compute_statistics(rs_vals, eps_lda)\n\n    # Perform statistical analysis for GGA errors vs. r_s\n    rho_gga, m_gga, monotonic_gga = compute_statistics(rs_vals, eps_gga)\n\n    # Format the results for the final output string.\n    # Lists of errors, rounded to six decimal places.\n    eps_lda_list_str = [f\"{val:.6f}\" for val in eps_lda]\n    eps_gga_list_str = [f\"{val:.6f}\" for val in eps_gga]\n    \n    # Construct the string representation of the lists.\n    eps_lda_output = f\"[{','.join(eps_lda_list_str)}]\"\n    eps_gga_output = f\"[{','.join(eps_gga_list_str)}]\"\n\n    # Assemble all parts of the output into a list of strings.\n    # Floats are rounded to six decimal places. Booleans are converted to \"True\"/\"False\".\n    all_results = [\n        eps_lda_output,\n        eps_gga_output,\n        f\"{rho_lda:.6f}\",\n        f\"{m_lda:.6f}\",\n        f\"{rho_gga:.6f}\",\n        f\"{m_gga:.6f}\",\n        str(monotonic_lda),\n        str(monotonic_gga)\n    ]\n\n    # Join all string parts with commas and enclose in square brackets.\n    output_string = f\"[{','.join(all_results)}]\"\n\n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "2987552"}]}