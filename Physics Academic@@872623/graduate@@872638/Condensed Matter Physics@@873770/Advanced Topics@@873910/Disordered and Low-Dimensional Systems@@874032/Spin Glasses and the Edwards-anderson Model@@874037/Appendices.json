{"hands_on_practices": [{"introduction": "The concept of frustration—where competing interactions prevent all bonds from being simultaneously satisfied—is the cornerstone of spin glass physics. This exercise provides a direct way to quantify this effect. By calculating the probability of frustration for a simple loop, you will develop a concrete understanding of how quenched disorder gives rise to the complex energy landscapes characteristic of these systems [@problem_id:3016871].", "problem": "Consider the Edwards-Anderson Ising spin glass, defined on a regular lattice by the Hamiltonian $H=-\\sum_{\\langle i j\\rangle} J_{i j} S_{i} S_{j}$ with Ising spins $S_{i}\\in\\{-1,+1\\}$ and quenched nearest-neighbor couplings $J_{i j}$. A loop (for example, an elementary plaquette) is said to be frustrated if and only if the product of the couplings $J_{i j}$ along that loop is negative. Let the couplings be independently and identically distributed according to a bimodal law $J_{i j}\\in\\{+J,-J\\}$, with $\\mathbb{P}(J_{i j}=-J)=p$ and $\\mathbb{P}(J_{i j}=+J)=1-p$, where $J0$.\n\n- Using only the fundamental definitions above, compute the probability that an elementary square plaquette on the square lattice is frustrated when $p=1/2$.\n- Then, generalize your result to a simple loop of length $\\ell$ on any $z$-regular graph (each vertex has coordination number $z$), expressing the probability of frustration in closed form as a function of $\\ell$ and $p$.\n\nProvide your final answer as a single closed-form expression that depends on $\\ell$ and $p$, and that reduces to your square-plaquette value when $\\ell=4$ and $p=1/2$. No numerical evaluation is required, and no units are involved. State no inequalities in your final answer.", "solution": "The user wants me to solve a problem about frustration in the Edwards-Anderson spin glass model.\n\nThe problem is validated as follows:\n- **Step 1: Extract Givens**\n    - Hamiltonian: $H=-\\sum_{\\langle i j\\rangle} J_{i j} S_{i} S_{j}$\n    - Spins: $S_{i}\\in\\{-1,+1\\}$\n    - Couplings: $J_{i j}$ are quenched, independent, and identically distributed (i.i.d.) nearest-neighbor couplings.\n    - Distribution of couplings: $J_{i j}$ follows a bimodal distribution, $J_{i j}\\in\\{+J,-J\\}$, with $J0$.\n    - Probabilities for couplings: $\\mathbb{P}(J_{i j}=-J)=p$ and $\\mathbb{P}(J_{i j}=+J)=1-p$.\n    - Definition of frustration: A loop is frustrated if the product of the couplings $J_{i j}$ along that loop is negative.\n    - Task 1: Compute the probability of frustration for an elementary square plaquette ($\\ell=4$) on a square lattice with $p=1/2$.\n    - Task 2: Generalize the result for a simple loop of length $\\ell$ on any $z$-regular graph, expressing the probability as a function of $\\ell$ and $p$.\n    - Task 3: The final answer must be a single closed-form expression depending on $\\ell$ and $p$.\n\n- **Step 2: Validate Using Extracted Givens**\n    - The problem is scientifically grounded, as it deals with standard concepts in the theory of spin glasses (the Edwards-Anderson model, frustration, bimodal disorder).\n    - The problem is well-posed. The definitions are clear and the probabilistic setup is complete, allowing for a unique solution. The information about the graph being \"$z$-regular\" is auxiliary context; the calculation depends only on the properties of a specific loop (its length), for which all necessary information is provided.\n    - The problem is objective and uses precise scientific language.\n    - The problem does not violate any of the invalidity criteria. It is a standard, formalizable problem in statistical physics.\n\n- **Step 3: Verdict and Action**\n    - The problem is valid. A solution will be provided.\n\nThe problem asks for the probability that a loop in a lattice is frustrated. A loop is defined as frustrated if the product of the quenched random couplings $J_{ij}$ along its bonds is negative. Let the loop be a simple cycle of length $\\ell$, with couplings $J_1, J_2, \\dots, J_\\ell$. The condition for frustration is:\n$$ \\prod_{i=1}^{\\ell} J_i  0 $$\nThe couplings $J_i$ are independent and identically distributed random variables drawn from a bimodal distribution: $J_i = +J$ with probability $1-p$ and $J_i = -J$ with probability $p$, where $J0$.\n\nThe sign of the product $\\prod_{i=1}^{\\ell} J_i$ is determined by the number of negative couplings (i.e., those with value $-J$) in the set $\\{J_1, \\dots, J_\\ell\\}$. Let $k$ be the number of negative couplings in the loop. The product can be written as:\n$$ \\prod_{i=1}^{\\ell} J_i = (-1)^k J^{\\ell} $$\nSince $J0$, $J^{\\ell}$ is always positive. Therefore, the condition for frustration, $\\prod_{i=1}^{\\ell} J_i  0$, is equivalent to $(-1)^k = -1$, which means that the number of negative couplings, $k$, must be odd.\n\nWe need to calculate the probability that $k$ is an odd number. Since the $\\ell$ couplings are independent, the number of negative couplings $k$ follows a binomial distribution with parameters $n=\\ell$ (the number of trials, i.e., bonds in the loop) and $p$ (the probability of success, i.e., a coupling being negative). The probability mass function is given by:\n$$ \\mathbb{P}(k) = \\binom{\\ell}{k} p^k (1-p)^{\\ell-k} $$\nThe probability of frustration, $P_{\\text{frust}}$, is the sum of probabilities for all possible odd values of $k$:\n$$ P_{\\text{frust}}(\\ell, p) = \\sum_{j=0}^{\\lfloor (\\ell-1)/2 \\rfloor} \\mathbb{P}(k=2j+1) = \\sum_{j=0}^{\\lfloor (\\ell-1)/2 \\rfloor} \\binom{\\ell}{2j+1} p^{2j+1} (1-p)^{\\ell-(2j+1)} $$\nTo find a closed-form expression for this sum, we use a standard technique involving the binomial theorem. Consider the expansions of $(a+b)^\\ell$ and $(a-b)^\\ell$:\n$$ (a+b)^\\ell = \\sum_{k=0}^{\\ell} \\binom{\\ell}{k} b^k a^{\\ell-k} $$\n$$ (a-b)^\\ell = \\sum_{k=0}^{\\ell} \\binom{\\ell}{k} (-b)^k a^{\\ell-k} = \\sum_{k=0}^{\\ell} (-1)^k \\binom{\\ell}{k} b^k a^{\\ell-k} $$\nSubtracting the second equation from the first:\n$$ (a+b)^\\ell - (a-b)^\\ell = \\sum_{k=0}^{\\ell} \\binom{\\ell}{k}b^k a^{\\ell-k}(1 - (-1)^k) $$\nThe term $(1 - (-1)^k)$ equals $2$ if $k$ is odd, and $0$ if $k$ is even. Thus, the sum only includes terms with odd $k$:\n$$ (a+b)^\\ell - (a-b)^\\ell = 2 \\sum_{k \\text{ is odd}} \\binom{\\ell}{k} b^k a^{\\ell-k} $$\nNow, we set $a = 1-p$ and $b=p$. The sum on the right-hand side becomes exactly the probability of frustration, $P_{\\text{frust}}(\\ell, p)$:\n$$ ((1-p)+p)^\\ell - ((1-p)-p)^\\ell = 2 \\sum_{k \\text{ is odd}} \\binom{\\ell}{k} p^k (1-p)^{\\ell-k} = 2 P_{\\text{frust}}(\\ell, p) $$\nSimplifying the left-hand side:\n$$ 1^\\ell - (1-2p)^\\ell = 2 P_{\\text{frust}}(\\ell, p) $$\n$$ 1 - (1-2p)^\\ell = 2 P_{\\text{frust}}(\\ell, p) $$\nSolving for $P_{\\text{frust}}(\\ell, p)$, we get the general closed-form expression for the probability of frustration for a loop of length $\\ell$:\n$$ P_{\\text{frust}}(\\ell, p) = \\frac{1}{2} \\left(1 - (1 - 2p)^{\\ell}\\right) $$\nThis expression depends only on the loop length $\\ell$ and the probability $p$ of a negative bond. The coordination number $z$ of the graph is irrelevant as long as the loop is well-defined.\n\nThe first part of the problem asks for the specific case of an elementary square plaquette on a square lattice with $p=1/2$. A square plaquette is a loop of length $\\ell=4$. Substituting $\\ell=4$ and $p=1/2$ into our general formula:\n$$ P_{\\text{frust}}(4, 1/2) = \\frac{1}{2} \\left(1 - \\left(1 - 2\\left(\\frac{1}{2}\\right)\\right)^{4}\\right) $$\n$$ P_{\\text{frust}}(4, 1/2) = \\frac{1}{2} \\left(1 - (1 - 1)^{4}\\right) = \\frac{1}{2} \\left(1 - 0^{4}\\right) = \\frac{1}{2} (1 - 0) = \\frac{1}{2} $$\nThe final answer required is the single closed-form expression that generalizes this result.", "answer": "$$\n\\boxed{\\frac{1}{2} \\left(1 - (1 - 2p)^{\\ell}\\right)}\n$$", "id": "3016871"}, {"introduction": "The Edwards-Anderson Hamiltonian possesses a local $\\mathbb{Z}_{2}$ gauge symmetry that is not immediately obvious but has profound implications for the physics of spin glasses. This exercise guides you through proving this invariance and exploring its consequences for physical observables [@problem_id:3016817]. Understanding this symmetry is critical to appreciating why the conventional order parameters for magnetism are inadequate and why a concept like replica overlap is the correct language to describe the spin glass state.", "problem": "Consider the Edwards-Anderson spin-glass model with Ising spins $S_i \\in \\{-1,+1\\}$ on a finite undirected graph with $N$ sites and $M$ edges. The Hamiltonian is\n$$\nH[\\{S\\}\\,|\\,\\{J\\}] \\equiv - \\sum_{\\langle i j \\rangle} J_{i j}\\, S_i S_j,\n$$\nwhere the couplings $J_{i j} = J_{j i}$ are quenched random variables drawn independently from a bond distribution that is symmetric under $J_{i j} \\to - J_{i j}$ and supported on a finite interval. Define a site-dependent transformation with $\\epsilon_i \\in \\{-1,+1\\}$ acting as\n$$\nS_i \\to S_i' \\equiv \\epsilon_i S_i, \\qquad J_{i j} \\to J_{i j}' \\equiv \\epsilon_i \\epsilon_j J_{i j}.\n$$\nStarting from the basic definitions of the Hamiltonian, the Boltzmann weight $\\exp(-\\beta H)$ at inverse temperature $\\beta$, and the partition function\n$$\nZ[\\{J\\}] \\equiv \\sum_{\\{S\\}} \\exp\\!\\big(-\\beta H[\\{S\\}\\,|\\,\\{J\\}]\\big),\n$$\nperform the following tasks:\n\n- Demonstrate explicitly that the transformed Hamiltonian $H[\\{S'\\}\\,|\\,\\{J'\\}]$ equals $H[\\{S\\}\\,|\\,\\{J\\}]$ for any choice of $\\{\\epsilon_i\\}$, and deduce that $Z[\\{J'\\}] = Z[\\{J\\}]$ by an appropriate change of summation variables.\n\n- Using only the transformation rules above and without introducing any unmotivated shortcuts, determine how the following observables transform: the magnetization $m \\equiv \\frac{1}{N} \\sum_{i=1}^{N} S_i$, the bond energy density $e_b \\equiv -\\frac{1}{M} \\sum_{\\langle i j \\rangle} J_{i j} S_i S_j$, and the two-replica overlap (Edwards-Anderson order-parameter candidate) $q \\equiv \\frac{1}{N} \\sum_{i=1}^{N} S_i^{(1)} S_i^{(2)}$, where superscripts denote two independent thermal replicas evolving with the same quenched disorder $\\{J\\}$.\n\n- Derive a general selection rule for gauge invariance of any observable that can be written as a single monomial\n$$\n\\mathcal{O}(\\{S\\},\\{J\\}) = \\prod_{i=1}^{N} S_i^{a_i} \\prod_{\\langle i j \\rangle} J_{i j}^{b_{i j}},\n$$\nwith nonnegative integers $a_i$ and $b_{i j}$, in terms of parity constraints on exponents at each site.\n\nYour derivation must begin from the definitions provided above and clearly justify each step. As your final answer, report the explicit analytic expression for the gauge-invariant Edwards-Anderson order parameter in terms of $N$ and the spin variables of $2$ replicas. No numerical evaluation is required, and no units are involved.", "solution": "The problem is to analyze the local gauge symmetry of the Edwards-Anderson spin-glass model. The analysis is performed in three parts: demonstrating the invariance of the Hamiltonian and partition function, determining the transformation properties of specific physical observables, and deriving a general selection rule for the gauge invariance of monomial observables.\n\n### Part 1: Invariance of the Hamiltonian and Partition Function\n\nThe Hamiltonian of the Edwards-Anderson model is given by\n$$\nH[\\{S\\}\\,|\\,\\{J\\}] \\equiv - \\sum_{\\langle i j \\rangle} J_{i j}\\, S_i S_j\n$$\nwhere $\\{S\\}$ denotes a configuration of Ising spins $S_i \\in \\{-1,+1\\}$ and $\\{J\\}$ is a realization of quenched random couplings $J_{ij}$. The sum is over all edges $\\langle ij \\rangle$ of the graph.\n\nA local gauge transformation is defined by a set of site-dependent variables $\\epsilon_i \\in \\{-1,+1\\}$, which act on the spins and couplings as follows:\n$$\nS_i \\to S_i' \\equiv \\epsilon_i S_i\n$$\n$$\nJ_{i j} \\to J_{i j}' \\equiv \\epsilon_i \\epsilon_j J_{i j}\n$$\n\nFirst, we demonstrate that the analytical expression for the Hamiltonian is invariant under this transformation. We substitute the transformed variables $S_i'$ and $J_{ij}'$ into the defining expression for the Hamiltonian:\n$$\nH[\\{S'\\}\\,|\\,\\{J'\\}] = - \\sum_{\\langle i j \\rangle} J_{i j}'\\, S_i' S_j'\n$$\nSubstituting the transformation rules, we obtain:\n$$\nH[\\{S'\\}\\,|\\,\\{J'\\}] = - \\sum_{\\langle i j \\rangle} (\\epsilon_i \\epsilon_j J_{i j})\\, (\\epsilon_i S_i) (\\epsilon_j S_j)\n$$\nRearranging the terms and using the property $\\epsilon_k^2 = 1$ for any site $k$:\n$$\nH[\\{S'\\}\\,|\\,\\{J'\\}] = - \\sum_{\\langle i j \\rangle} (\\epsilon_i^2 \\epsilon_j^2) J_{i j}\\, S_i S_j = - \\sum_{\\langle i j \\rangle} (1 \\cdot 1) J_{i j}\\, S_i S_j = - \\sum_{\\langle i j \\rangle} J_{i j}\\, S_i S_j\n$$\nThis is identical to the original Hamiltonian expression, $H[\\{S\\}\\,|\\,\\{J\\}]$. Thus, we have shown that $H[\\{S'\\}\\,|\\,\\{J'\\}] = H[\\{S\\}\\,|\\,\\{J\\}]$.\n\nNext, we deduce the invariance of the partition function $Z[\\{J\\}]$. The partition function for a system with couplings $\\{J'\\}$ is defined as:\n$$\nZ[\\{J'\\}] \\equiv \\sum_{\\{S\\}} \\exp\\!\\big(-\\beta H[\\{S\\}\\,|\\,\\{J'\\}]\\big)\n$$\nThe summation is over all $2^N$ spin configurations $\\{S\\}$. The Hamiltonian in the exponent is evaluated with spin variables $\\{S\\}$ and transformed couplings $\\{J'\\}$:\n$$\nH[\\{S\\}\\,|\\,\\{J'\\}] = - \\sum_{\\langle i j \\rangle} J'_{i j}\\, S_i S_j = - \\sum_{\\langle i j \\rangle} (\\epsilon_i \\epsilon_j J_{i j})\\, S_i S_j\n$$\nSubstituting this into the expression for $Z[\\{J'\\}]$:\n$$\nZ[\\{J'\\}] = \\sum_{\\{S\\}} \\exp\\left( \\beta \\sum_{\\langle i j \\rangle} (\\epsilon_i \\epsilon_j J_{i j})\\, S_i S_j \\right)\n$$\nWe now perform a change of variables in the summation over spin configurations. Let us define a new set of spin variables $\\{S'\\}$ such that $S_i' = \\epsilon_i S_i$. Since $\\epsilon_i^2 = 1$, the inverse transformation is $S_i = \\epsilon_i S_i'$. This transformation is a one-to-one map of the set of all spin configurations onto itself. Therefore, summing over all $\\{S\\}$ is equivalent to summing over all $\\{S'\\}$.\nSubstituting $S_i = \\epsilon_i S_i'$ into the expression for $Z[\\{J'\\}]$ yields:\n$$\nZ[\\{J'\\}] = \\sum_{\\{S'\\}} \\exp\\left( \\beta \\sum_{\\langle i j \\rangle} (\\epsilon_i \\epsilon_j J_{i j})\\, (\\epsilon_i S_i') (\\epsilon_j S_j') \\right)\n$$\nSimplifying the terms within the exponential:\n$$\n(\\epsilon_i \\epsilon_j J_{i j})\\, (\\epsilon_i S_i') (\\epsilon_j S_j') = (\\epsilon_i^2 \\epsilon_j^2) J_{i j} S_i' S_j' = J_{i j} S_i' S_j'\n$$\nThe expression for $Z[\\{J'\\}]$ becomes:\n$$\nZ[\\{J'\\}] = \\sum_{\\{S'\\}} \\exp\\left( \\beta \\sum_{\\langle i j \\rangle} J_{i j} S_i' S_j' \\right) = \\sum_{\\{S'\\}} \\exp\\left( -\\beta H[\\{S'\\}\\,|\\,\\{J\\}] \\right)\n$$\nSince $\\{S'\\}$ is a dummy variable of summation, this expression is precisely the definition of the partition function $Z[\\{J\\}]$. Thus, we have shown that $Z[\\{J'\\}] = Z[\\{J\\}]$.\n\n### Part 2: Transformation of Observables\n\nWe determine how the given observables transform by applying the gauge transformation to their defining expressions.\n\n1.  **Magnetization, $m$**:\n    The magnetization is $m \\equiv \\frac{1}{N} \\sum_{i=1}^{N} S_i$. The transformed observable $m'$ is obtained by replacing $S_i$ with $S_i' = \\epsilon_i S_i$:\n    $$\n    m' = \\frac{1}{N} \\sum_{i=1}^{N} S_i' = \\frac{1}{N} \\sum_{i=1}^{N} \\epsilon_i S_i\n    $$\n    In general, $m' \\neq m$. The magnetization is not gauge invariant.\n\n2.  **Bond energy density, $e_b$**:\n    The bond energy density is $e_b \\equiv -\\frac{1}{M} \\sum_{\\langle i j \\rangle} J_{i j} S_i S_j$. The transformed observable $e_b'$ is:\n    $$\n    e_b' = -\\frac{1}{M} \\sum_{\\langle i j \\rangle} J_{i j}' S_i' S_j'\n    $$\n    From Part 1, we established that the expression for the Hamiltonian is invariant, i.e., $\\sum_{\\langle i j \\rangle} J_{i j}' S_i' S_j' = \\sum_{\\langle i j \\rangle} J_{i j} S_i S_j$. Therefore:\n    $$\n    e_b' = -\\frac{1}{M} \\sum_{\\langle i j \\rangle} J_{i j} S_i S_j = e_b\n    $$\n    The bond energy density is gauge invariant.\n\n3.  **Two-replica overlap, $q$**:\n    The two-replica overlap is $q \\equiv \\frac{1}{N} \\sum_{i=1}^{N} S_i^{(1)} S_i^{(2)}$. The gauge transformation applies to all physical variables at a given site $i$. Thus, the spin variables for both replicas transform identically: $S_i^{(1)} \\to S_i^{(1)'} \\equiv \\epsilon_i S_i^{(1)}$ and $S_i^{(2)} \\to S_i^{(2)'} \\equiv \\epsilon_i S_i^{(2)}$. The transformed observable $q'$ is:\n    $$\n    q' = \\frac{1}{N} \\sum_{i=1}^{N} S_i^{(1)'} S_i^{(2)'} = \\frac{1}{N} \\sum_{i=1}^{N} (\\epsilon_i S_i^{(1)}) (\\epsilon_i S_i^{(2)})\n    $$\n    Using $\\epsilon_i^2=1$:\n    $$\n    q' = \\frac{1}{N} \\sum_{i=1}^{N} \\epsilon_i^2 S_i^{(1)} S_i^{(2)} = \\frac{1}{N} \\sum_{i=1}^{N} S_i^{(1)} S_i^{(2)} = q\n    $$\n    The two-replica overlap is gauge invariant.\n\n### Part 3: General Selection Rule for Gauge Invariance\n\nWe consider a general monomial observable of the form:\n$$\n\\mathcal{O}(\\{S\\},\\{J\\}) = \\prod_{i=1}^{N} S_i^{a_i} \\prod_{\\langle i j \\rangle} J_{i j}^{b_{i j}}\n$$\nwhere $a_i$ and $b_{ij}$ are non-negative integers. We seek the condition for $\\mathcal{O}$ to be gauge invariant, i.e., $\\mathcal{O}' = \\mathcal{O}$. The transformed observable $\\mathcal{O}'$ is:\n$$\n\\mathcal{O}' = \\prod_{i=1}^{N} (S_i')^{a_i} \\prod_{\\langle i j \\rangle} (J_{i j}')^{b_{i j}} = \\prod_{i=1}^{N} (\\epsilon_i S_i)^{a_i} \\prod_{\\langle i j \\rangle} (\\epsilon_i \\epsilon_j J_{i j})^{b_{i j}}\n$$\nSeparating the factors involving $\\epsilon_k$:\n$$\n\\mathcal{O}' = \\left( \\prod_{i=1}^{N} S_i^{a_i} \\prod_{\\langle i j \\rangle} J_{i j}^{b_{i j}} \\right) \\left( \\prod_{i=1}^{N} \\epsilon_i^{a_i} \\prod_{\\langle i j \\rangle} (\\epsilon_i \\epsilon_j)^{b_{i j}} \\right) = \\mathcal{O} \\left( \\prod_{i=1}^{N} \\epsilon_i^{a_i} \\prod_{\\langle i j \\rangle} \\epsilon_i^{b_{i j}} \\epsilon_j^{b_{i j}} \\right)\n$$\nFor $\\mathcal{O}'=\\mathcal{O}$, the product of $\\epsilon$ factors must equal $1$ for any choice of $\\{\\epsilon_i\\}$. We can rewrite this product by collecting the exponents for each site $k$:\n$$\n\\prod_{k=1}^{N} \\epsilon_k^{P_k}\n$$\nThe total exponent $P_k$ for a given site $k$ consists of the term $a_k$ from the spin factors, plus a contribution from each edge connected to site $k$. For each edge $\\langle k j \\rangle$, the factor $J_{kj}^{b_{kj}}$ contributes $b_{kj}$ to the exponent of $\\epsilon_k$. Therefore, the total exponent is:\n$$\nP_k = a_k + \\sum_{j \\in \\mathcal{N}(k)} b_{kj}\n$$\nwhere $\\mathcal{N}(k)$ is the set of neighbors of site $k$. For the product $\\prod_k \\epsilon_k^{P_k}$ to be $1$ for an arbitrary choice of $\\{\\epsilon_k\\}$, each exponent $P_k$ must be an even number. This can be seen by choosing $\\epsilon_k = -1$ and $\\epsilon_j = 1$ for all $j \\neq k$, which isolates the condition $(-1)^{P_k} = 1$.\n\nThus, the general selection rule for a monomial observable to be gauge invariant is that for each site $k$ in the graph, the sum of the exponent of the spin at that site and the exponents of all bonds incident to that site must be an even integer:\n$$\na_k + \\sum_{j \\in \\mathcal{N}(k)} b_{kj} \\equiv 0 \\pmod 2 \\quad \\forall k \\in \\{1, \\dots, N\\}\n$$\nThe two-replica overlap $q$ is a sum of monomials of the form $S_i^{(1)}S_i^{(2)}$. This can be seen as a specific case of a more general multi-replica observable. For a term like $S_k^{(1)}S_k^{(2)}$, the total spin exponent at site $k$ is $1+1=2$, and all other exponents are $0$. The condition at site $k$ is $2+0=2$ (even), and at any other site $i\\neq k$ is $0+0=0$ (even). Since each term in the sum for $q$ is individually gauge invariant, their sum $q$ is also gauge invariant, as demonstrated in Part 2. This structure is precisely what is needed for a well-defined order parameter in a system with this local symmetry.\n\nThe explicit analytic expression for the gauge-invariant Edwards-Anderson order parameter is the two-replica overlap $q$, which was shown to be invariant.", "answer": "$$\n\\boxed{\\frac{1}{N} \\sum_{i=1}^{N} S_i^{(1)} S_i^{(2)}}\n$$", "id": "3016817"}, {"introduction": "While finding the ground state of the Edwards-Anderson model is generally an NP-hard problem, exact solutions exist in specific dimensions and for particular coupling distributions. This practice explores the celebrated mapping of the two-dimensional bimodal spin glass problem onto a minimum-weight perfect matching problem on a dual graph [@problem_id:3016831]. By implementing this algorithm, you will gain hands-on experience connecting the abstract concepts of frustration and domain walls to a concrete and exact computational solution for the ground-state energy.", "problem": "Consider the two-dimensional Edwards-Anderson spin glass with bimodal couplings on a rectangular square lattice with free boundary conditions. Let there be $L \\times M$ Ising spins with variables $S_i \\in \\{-1,+1\\}$ at the lattice vertices, and nearest-neighbor couplings $J_{ij} \\in \\{-1,+1\\}$ on the edges. The Edwards-Anderson Hamiltonian is $H = -\\sum_{\\langle i j\\rangle} J_{ij} S_i S_j$, where the sum is over nearest-neighbor pairs. In the absence of a magnetic field, and with free boundaries, the ground state can be computed exactly via a mapping to a minimum-weight perfect matching (MWPM) on a planar graph derived from the dual lattice. The goal of this problem is to construct that computation from first principles, using the definitions of frustration and domain walls, and to explain how the MWPM on the dual planar graph produces the exact ground-state energy.\n\nYou must write a complete program that, for each of the test instances specified below, constructs the appropriate planar dual graph, builds the set of demand vertices corresponding to frustrated plaquettes, assigns edge weights, and solves the corresponding minimum-weight perfect matching to obtain the exact ground-state energy. The program must be self-contained and must not read any input. It must produce a single line of output containing the results for all test instances.\n\nFundamental base for the derivation and method:\n- Use the Edwards-Anderson Hamiltonian definition $H = -\\sum_{\\langle i j\\rangle} J_{ij} S_i S_j$.\n- Use the definition of a frustrated plaquette: for each elementary square face (plaquette), compute the product of the four incident couplings; a plaquette is frustrated if and only if the product equals $-1$.\n- Use the parity argument on the dual lattice: the set of unsatisfied edges forms a subgraph with odd incidence at frustrated plaquettes and even incidence elsewhere, which is representable as a union of paths connecting pairs of frustrated plaquettes (and possibly the outer face when the number of frustrated plaquettes is odd).\n- Use the fact that in the bimodal case with $J_{ij} \\in \\{-1,+1\\}$, edge weights on the dual graph are equal to $1$ for each crossed nearest-neighbor edge; distances on the dual grid are therefore the Manhattan distances between plaquette centers, and the distance from a plaquette to the outer face equals the minimal number of dual steps to the boundary plus $1$.\n\nYou must implement the following steps algorithmically:\n1. For each test instance, compute the set of frustrated plaquettes by evaluating the product of the four couplings of each plaquette. Denote the number of bonds by $N_{\\text{bonds}}$ and the number of frustrated plaquettes by $N_{\\text{frust}}$.\n2. If $N_{\\text{frust}}$ is odd, include a single outer-face demand vertex to ensure that the total number of demand vertices is even.\n3. Construct the complete weighted graph on the demand vertices where the weight between two interior plaquettes is the Manhattan distance between their coordinates on the plaquette grid, and the weight between an interior plaquette and the outer face is the minimal number of steps to any boundary plus $1$.\n4. Solve the minimum-weight perfect matching on this complete graph to obtain the minimal total path length $W$. Your implementation must be exact; use a method appropriate for small graphs, such as a dynamic programming over subsets that pairs vertices to minimize total weight.\n5. Compute the exact ground-state energy in units of $J$ with $J=1$ as an integer. Your program must output integer energies in units of $J$, with no other units. Energies must be computed in a scientifically consistent way from the above construction.\n\nTest suite:\nFor each case, the horizontal couplings are given by a matrix $H$ of shape $L \\times (M-1)$, where $H_{r,c}$ is the coupling between spins at $(r,c)$ and $(r,c+1)$, and the vertical couplings are given by a matrix $V$ of shape $(L-1) \\times M$, where $V_{r,c}$ is the coupling between spins at $(r,c)$ and $(r+1,c)$. All entries are in $\\{-1,+1\\}$.\n\n- Case $1$ (small, one frustrated plaquette):\n  $L = 2$, $M = 2$,\n  $H = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$,\n  $V = \\begin{bmatrix} 1  -1 \\end{bmatrix}$.\n\n- Case $2$ (odd number of frustrated plaquettes, requires outer-face pairing):\n  $L = 3$, $M = 3$,\n  $H = \\begin{bmatrix} 1  -1 \\\\ -1  1 \\\\ 1  1 \\end{bmatrix}$,\n  $V = \\begin{bmatrix} 1  1  -1 \\\\ -1  1  1 \\end{bmatrix}$.\n\n- Case $3$ (larger grid with multiple frustrated plaquettes):\n  $L = 4$, $M = 4$,\n  $H = \\begin{bmatrix} 1  -1  1 \\\\ 1  1  -1 \\\\ -1  1  1 \\\\ 1  -1  -1 \\end{bmatrix}$,\n  $V = \\begin{bmatrix} 1  -1  1  1 \\\\ 1  1  -1  -1 \\\\ -1  1  1  1 \\end{bmatrix}$.\n\n- Case $4$ (rectangular grid with mixed couplings):\n  $L = 3$, $M = 4$,\n  $H = \\begin{bmatrix} 1  1  -1 \\\\ -1  1  1 \\\\ 1  -1  1 \\end{bmatrix}$,\n  $V = \\begin{bmatrix} 1  -1  1  -1 \\\\ 1  1  -1  1 \\end{bmatrix}$.\n\nAnswer specification:\n- For each case, your program must output the exact ground-state energy in units of $J$ with $J=1$ as an integer.\n- Aggregate the results from the four cases into a single line of output as a comma-separated list enclosed in square brackets, with no spaces, for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$.\n- No angles or percentages are involved in this problem.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\").", "solution": "The problem requires the computation of the ground-state energy for a two-dimensional Edwards-Anderson spin glass model on a rectangular lattice with free boundary conditions and bimodal couplings. The solution is based on a well-established mapping of this specific problem to a minimum-weight perfect matching (MWPM) problem on a related graph.\n\nThe system consists of $L \\times M$ Ising spins, described by variables $S_i \\in \\{-1, +1\\}$, located at the vertices of a square lattice. The interactions are restricted to nearest neighbors and are defined by couplings $J_{ij} \\in \\{-1, +1\\}$. The Hamiltonian of the system is given by\n$$H = -\\sum_{\\langle i j\\rangle} J_{ij} S_i S_j$$\nwhere the sum is over all nearest-neighbor pairs $\\langle i j\\rangle$. The ground state corresponds to the spin configuration $\\{S_i\\}$ that minimizes this Hamiltonian.\n\nTo find the ground-state energy, we analyze the energy of individual bonds. An individual bond $\\langle ij \\rangle$ contributes $-J_{ij}S_iS_j$ to the total energy. This contribution is $-1$ if the bond is \"satisfied\" ($J_{ij}S_iS_j = 1$) and $+1$ if the bond is \"unsatisfied\" ($J_{ij}S_iS_j = -1$). Let $N_{\\text{unsat}}$ be the number of unsatisfied bonds and $N_{\\text{sat}}$ be the number of satisfied bonds. The total number of bonds on the lattice is $N_{\\text{bonds}} = N_{\\text{unsat}} + N_{\\text{sat}}$. The total energy $E$ is the sum of all bond energy contributions:\n$$E = N_{\\text{unsat}} \\times (+1) + N_{\\text{sat}} \\times (-1) = N_{\\text{unsat}} - N_{\\text{sat}}$$\nBy substituting $N_{\\text{sat}} = N_{\\text{bonds}} - N_{\\text{unsat}}$, we can express the energy solely in terms of the number of unsatisfied bonds:\n$$E = N_{\\text{unsat}} - (N_{\\text{bonds}} - N_{\\text{unsat}}) = 2N_{\\text{unsat}} - N_{\\text{bonds}}$$\nMinimizing the energy $E$ is therefore equivalent to minimizing the number of unsatisfied bonds $N_{\\text{unsat}}$, since $N_{\\text{bonds}}$ is a fixed constant for a given lattice.\n\nThe key insight relates the locations of unsatisfied bonds to the concept of \"frustration\". A plaquette (an elementary square of the lattice) is defined by four spins at its corners and the four bonds connecting them. The frustration of a plaquette $p$ is determined by the product of the couplings around it:\n$$P_p = \\prod_{\\langle ij \\rangle \\in \\partial p} J_{ij}$$\nA plaquette $p$ is frustrated if $P_p = -1$. For any given spin configuration $\\{S_i\\}$, the product of bond energies around a plaquette is $\\prod_{\\langle ij \\rangle \\in \\partial p} \\sigma_{ij} = \\prod (J_{ij}S_iS_j) = (\\prod J_{ij})(\\prod S_iS_j)$. Since each spin vertex is part of two bonds in the plaquette boundary, each spin variable appears twice in the second product, so $\\prod S_iS_j = \\prod S_k^2 = 1$. Thus, $\\prod \\sigma_{ij} = P_p$.\nIf a plaquette is unfrustrated ($P_p = +1$), it must be surrounded by an even number of unsatisfied bonds. If it is frustrated ($P_p = -1$), it must be surrounded by an odd number of unsatisfied bonds.\n\nThis property allows us to visualize the problem on the dual lattice. The vertices of the dual lattice correspond to the centers of the plaquettes of the original lattice. The set of unsatisfied bonds in the original lattice forms a collection of paths and closed loops on the dual lattice. The frustrated plaquettes are the endpoints of these paths, as they are the only vertices on the dual lattice that can have an odd degree (odd number of incident unsatisfied bonds).\n\nTo minimize $N_{\\text{unsat}}$, we must find a configuration of such paths that has the minimum total length, connecting all frustrated plaquettes in pairs. This is exactly a minimum-weight perfect matching problem. The vertices of the matching graph are the \"demand vertices\", which consist of the frustrated plaquettes. Since a matching pairs up vertices, the number of demand vertices must be even. If the number of frustrated plaquettes $N_{\\text{frust}}$ is odd, it implies that one of the paths must terminate at the boundary of the system. This is modeled by adding a single \"outer face\" vertex to the set of demand vertices.\n\nThe algorithmic procedure is as follows:\n1.  **Identify Frustrated Plaquettes**: For a given $L \\times M$ lattice with horizontal couplings $H$ and vertical couplings $V$, we consider the $(L-1) \\times (M-1)$ grid of plaquettes. For each plaquette at plaquette-grid coordinates $(r, c)$, where $r \\in [0, L-2]$ and $c \\in [0, M-2]$, we compute the product of its four surrounding bond couplings. If the product is $-1$, the plaquette is frustrated. We record the coordinates of all frustrated plaquettes.\n\n2.  **Construct Demand Vertices**: We form a list of demand vertices. This list comprises the coordinates of all frustrated plaquettes. If the number of frustrated plaquettes $N_{\\text{frust}}$ is odd, we add a virtual \"outer face\" vertex to the list to ensure the total count is even.\n\n3.  **Build Cost Matrix**: We construct a complete weighted graph on the set of demand vertices. The weight of an edge between two vertices is the cost of connecting them with a path of unsatisfied bonds. For bimodal couplings ($J_{ij}=\\pm 1$), this cost is simply the path length on the dual grid.\n    *   The weight between two interior plaquettes at $(r_1, c_1)$ and $(r_2, c_2)$ is their Manhattan distance: $w = |r_1 - r_2| + |c_1 - c_2|$.\n    *   The weight between an interior plaquette at $(r, c)$ and the outer face vertex is the shortest Manhattan distance to the boundary of the plaquette grid plus one. For a plaquette at $(r, c)$ on an $(L-1) \\times (M-1)$ plaquette grid, this is $w = \\min(r, (L-2)-r, c, (M-2)-c) + 1$.\n\n4.  **Solve MWPM**: We solve the minimum-weight perfect matching problem on this complete graph. For a small number of vertices, this can be done exactly using a dynamic programming algorithm over subsets of vertices. Let the cost matrix be $C$. The recursive function $f(\\text{mask})$ computes the minimum matching cost for the subset of vertices represented by the bitmask. If $i$ is the smallest-indexed vertex in the mask, the recursion is:\n    $$f(\\text{mask}) = \\min_{j > i, j \\in \\text{mask}} \\left\\{ C_{ij} + f(\\text{mask} \\setminus \\{i, j\\}) \\right\\}$$\n    The total minimum weight of the matching, $W$, is the result of the initial call with all vertices included.\n\n5.  **Calculate Ground-State Energy**: The minimum weight $W$ from the MWPM is the minimum possible number of unsatisfied bonds, $N_{\\text{unsat}}^{\\min}$. The ground-state energy $E_0$ is then calculated using the formula derived earlier:\n    $$E_0 = 2W - N_{\\text{bonds}}$$\n    where $N_{\\text{bonds}} = L(M-1) + (L-1)M$ is the total number of bonds on the lattice.\n\nThis procedure is applied to each test case to find its exact ground-state energy.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom itertools import combinations\nimport sys\n\n# Set a higher recursion limit for the MWPM solver, although not strictly\n# necessary for the small problem sizes given.\nsys.setrecursionlimit(2000)\n\ndef solve():\n    \"\"\"\n    Computes the exact ground-state energy for several 2D Edwards-Anderson\n    spin glass instances using a mapping to a minimum-weight perfect matching problem.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"L\": 2, \"M\": 2,\n            \"H\": np.array([[1], [1]]),\n            \"V\": np.array([[1, -1]])\n        },\n        # Case 2\n        {\n            \"L\": 3, \"M\": 3,\n            \"H\": np.array([[1, -1], [-1, 1], [1, 1]]),\n            \"V\": np.array([[1, 1, -1], [-1, 1, 1]])\n        },\n        # Case 3\n        {\n            \"L\": 4, \"M\": 4,\n            \"H\": np.array([[1, -1, 1], [1, 1, -1], [-1, 1, 1], [1, -1, -1]]),\n            \"V\": np.array([[1, -1, 1, 1], [1, 1, -1, -1], [-1, 1, 1, 1]])\n        },\n        # Case 4\n        {\n            \"L\": 3, \"M\": 4,\n            \"H\": np.array([[1, 1, -1], [-1, 1, 1], [1, -1, 1]]),\n            \"V\": np.array([[1, -1, 1, -1], [1, 1, -1, 1]])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        L, M = case[\"L\"], case[\"M\"]\n        H_couplings, V_couplings = case[\"H\"], case[\"V\"]\n\n        # The number of plaquettes is (L-1) x (M-1)\n        num_plaq_rows, num_plaq_cols = L - 1, M - 1\n\n        frustrated_plaquettes = []\n        if num_plaq_rows > 0 and num_plaq_cols > 0:\n            for r in range(num_plaq_rows):\n                for c in range(num_plaq_cols):\n                    # Bonds for plaquette (r,c) are H(r,c), H(r+1,c), V(r,c), V(r,c+1)\n                    p_prod = (H_couplings[r, c] * H_couplings[r + 1, c] *\n                              V_couplings[r, c] * V_couplings[r, c + 1])\n                    if p_prod == -1:\n                        frustrated_plaquettes.append((r, c))\n\n        demand_nodes = list(frustrated_plaquettes)\n        num_frustrated = len(demand_nodes)\n        \n        # If the number of frustrated plaquettes is odd, add the outer face as a demand node.\n        # We represent the outer face with a special coordinate, e.g., None.\n        outer_face_node = None\n        has_outer_face_node = False\n        if num_frustrated % 2 != 0:\n            demand_nodes.append(outer_face_node)\n            has_outer_face_node = True\n\n        num_demand_nodes = len(demand_nodes)\n        if num_demand_nodes == 0:\n            min_matching_weight = 0\n        else:\n            cost_matrix = np.zeros((num_demand_nodes, num_demand_nodes), dtype=int)\n            for i in range(num_demand_nodes):\n                for j in range(i + 1, num_demand_nodes):\n                    node1 = demand_nodes[i]\n                    node2 = demand_nodes[j]\n                    \n                    is_node1_outer = (node1 is outer_face_node)\n                    is_node2_outer = (node2 is outer_face_node)\n\n                    cost = 0\n                    if is_node1_outer and not is_node2_outer:\n                        # Cost between outer face and an inner plaquette\n                        r, c = node2\n                        cost = min(r, num_plaq_rows - 1 - r, c, num_plaq_cols - 1 - c) + 1\n                    elif not is_node1_outer and is_node2_outer:\n                        # Symmetric case\n                        r, c = node1\n                        cost = min(r, num_plaq_rows - 1 - r, c, num_plaq_cols - 1 - c) + 1\n                    else: # Both are inner plaquettes\n                        r1, c1 = node1\n                        r2, c2 = node2\n                        cost = abs(r1 - r2) + abs(c1 - c2)\n                    \n                    cost_matrix[i, j] = cost_matrix[j, i] = cost\n            \n            # --- Minimum Weight Perfect Matching Solver (DP with memoization) ---\n            memo = {}\n            def solve_mwpm(mask):\n                if mask == 0:\n                    return 0\n                if mask in memo:\n                    return memo[mask]\n\n                min_cost = float('inf')\n                \n                # Find the first vertex `i` in the mask\n                i = 0\n                while not (mask  (1  i)):\n                    i += 1\n                \n                # Pair `i` with every other vertex `j` in the mask\n                for j in range(i + 1, num_demand_nodes):\n                    if mask  (1  j):\n                        new_mask = mask ^ (1  i) ^ (1  j)\n                        current_cost = cost_matrix[i, j] + solve_mwpm(new_mask)\n                        if current_cost  min_cost:\n                            min_cost = current_cost\n                \n                memo[mask] = min_cost\n                return min_cost\n\n            initial_mask = (1  num_demand_nodes) - 1\n            min_matching_weight = solve_mwpm(initial_mask)\n\n        # Calculate total number of bonds\n        num_bonds = L * (M - 1) + (L - 1) * M\n\n        # Ground state energy E_0 = 2 * W - N_bonds, where W is the min number of unsatisfied bonds\n        ground_energy = 2 * min_matching_weight - num_bonds\n        results.append(ground_energy)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3016831"}]}