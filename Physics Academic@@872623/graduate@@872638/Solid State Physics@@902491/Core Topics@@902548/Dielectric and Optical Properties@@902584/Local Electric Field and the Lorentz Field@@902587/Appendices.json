{"hands_on_practices": [{"introduction": "A central goal in condensed matter physics is to connect macroscopic, measurable properties to the underlying microscopic behavior of atoms and electrons. The Clausius-Mossotti relation provides just such a bridge for dielectric materials, linking the bulk dielectric constant $\\epsilon_r$ to the atomic polarizability $\\alpha$. This exercise offers a practical application of this fundamental equation, allowing you to calculate a microscopic quantity for Argon atoms based on macroscopic experimental data.", "problem": "Solid Argon, at low temperatures, forms a crystalline structure. Experiments reveal that it adopts a Face-Centered Cubic (FCC) lattice structure with a lattice parameter of $a = 0.531$ nm. When subjected to a static electric field, the material exhibits a relative static dielectric constant of $\\epsilon_r = 1.66$. Assuming the solid can be modeled as a classical dielectric material composed of non-polar atoms, calculate the electronic polarizability, $\\alpha$, of a single Argon atom.\n\nUse the value for the permittivity of free space, $\\epsilon_0 = 8.854 \\times 10^{-12}$ F/m.\n\nExpress your answer in units of C·m²/V, and round your final answer to three significant figures.", "solution": "For a non-polar dielectric composed of atoms, the Clausius–Mossotti relation connects the relative dielectric constant to the microscopic polarizability:\n$$\n\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}=\\frac{N\\alpha}{3\\epsilon_{0}},\n$$\nwhere $N$ is the number density of atoms and $\\alpha$ is the electronic polarizability per atom.\n\nFor an FCC lattice of a monatomic solid, the conventional cubic cell contains $4$ atoms, so the number density is\n$$\nN=\\frac{4}{a^{3}}.\n$$\nSolving the Clausius–Mossotti relation for $\\alpha$ gives\n$$\n\\alpha=\\frac{3\\epsilon_{0}}{N}\\,\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}\n=3\\epsilon_{0}\\left(\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}\\right)\\frac{a^{3}}{4}.\n$$\n\nSubstitute the given values. Convert the lattice parameter to meters:\n$$\na=0.531\\times 10^{-9}\\ \\text{m},\\quad a^{3}=(0.531\\times 10^{-9})^{3}=1.49721291\\times 10^{-28}\\ \\text{m}^{3}.\n$$\nThen\n$$\n\\frac{a^{3}}{4}=3.743032275\\times 10^{-29}\\ \\text{m}^{3},\\quad \\frac{3a^{3}}{4}=1.1229096825\\times 10^{-28}\\ \\text{m}^{3}.\n$$\nWith $\\epsilon_{r}=1.66$ and $\\epsilon_{0}=8.854\\times 10^{-12}$,\n$$\n\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}=\\frac{0.66}{3.66}=\\frac{11}{61}\\approx 0.1803278689,\n$$\nso\n$$\n\\alpha=\\epsilon_{0}\\left(\\frac{3a^{3}}{4}\\right)\\left(\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}\\right)\n=(8.854\\times 10^{-12})(1.1229096825\\times 10^{-28})(0.1803278689).\n$$\nCarrying out the multiplication,\n$$\n\\alpha\\approx 1.792863\\times 10^{-40}.\n$$\nExpressed to three significant figures,\n$$\n\\alpha\\approx 1.79\\times 10^{-40}\\ \\text{(in SI units C m}^2\\text{/V)}.\n$$", "answer": "$$\\boxed{1.79 \\times 10^{-40}}$$", "id": "1818331"}, {"introduction": "The Lorentz field expression, $\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{\\mathrm{mac}} + \\frac{\\mathbf{P}}{3\\epsilon_{0}}$, is a cornerstone of dielectric theory, but what is its origin? A robust understanding requires moving beyond rote application to deriving the formula from first principles. This practice guides you through the elegant Lorentz sphere construction, a classic thought experiment that dissects the local field into distinct contributions and reveals the crucial role of lattice symmetry in obtaining the final, celebrated result.", "problem": "An insulating crystal is modeled as an infinite, simple cubic Bravais lattice of identical, polarizable point dipoles of number density $n$ in vacuum. The crystal is subjected to a static, spatially slowly varying external excitation such that the macroscopic Maxwell electric field $\\mathbf{E}_{\\mathrm{mac}}$ and the macroscopic polarization $\\mathbf{P}$ can be treated as uniform over mesoscopic scales. The polarization is $\\mathbf{P}=n\\,\\langle \\mathbf{p}\\rangle$, where $\\langle \\mathbf{p}\\rangle$ is the ensemble-averaged dipole moment per lattice site. The local electric field $\\mathbf{E}_{\\mathrm{loc}}$ at a chosen lattice site is defined as the actual microscopic electric field at that site due to all charges and dipoles in the system except the field of the dipole at that site itself.\n\nUsing only fundamental electromagnetic laws and core definitions (Maxwell’s equations in matter, the definition of polarization and bound charge densities, and electrostatic boundary conditions), construct a Lorentz spherical cavity of radius $a$ centered at the chosen lattice site and derive, from first principles, the decomposition of $\\mathbf{E}_{\\mathrm{loc}}$ into well-defined contributions. In particular, separate the contributions into:\n- fields produced by sources outside the cavity,\n- fields produced by the bound surface charge on the spherical cavity that arises from the discontinuity of $\\mathbf{P}$ across the cavity boundary,\n- and fields produced by discrete dipoles that would lie inside the cavity other than the central dipole itself.\n\nInvoke only symmetry properties of the simple cubic lattice where appropriate, and take the spherical cavity either (i) sufficiently small that it contains no other lattice sites besides the central site, or (ii) sufficiently large to contain an integer number of complete cubic shells, but in either case argue the vanishing of the contribution from discrete neighbors inside the cavity by cubic symmetry. Then, without using any shortcut formulas stated in advance, evaluate the field at the cavity center due to the cavity’s bound surface charge by solving the appropriate boundary-value problem on the spherical surface.\n\nExpress your final result for the vector local field $\\mathbf{E}_{\\mathrm{loc}}$ in terms of $\\mathbf{E}_{\\mathrm{mac}}$, $\\mathbf{P}$, and the vacuum permittivity $\\epsilon_{0}$. Provide a single, closed-form analytic expression for $\\mathbf{E}_{\\mathrm{loc}}$. State your answer in SI units of volts per meter (V/m).", "solution": "The problem presented is a standard, well-posed problem in the electrodynamics of continuous media and solid-state physics. It asks for a first-principles derivation of the Lorentz local field in an insulating crystal with a simple cubic lattice structure. The premises are scientifically sound, the terminology is precise, and the required steps form a logical path to a unique, well-defined solution. The problem is valid. We shall proceed with the derivation.\n\nThe objective is to determine the local electric field, $\\mathbf{E}_{\\mathrm{loc}}$, at a specific lattice site within a polarized dielectric material. By definition, $\\mathbf{E}_{\\mathrm{loc}}$ is the microscopic electric field at the chosen site (which we set as the origin, $\\mathbf{r}=0$) due to all sources of charge, *except* for the dipole located at that site itself.\n\nWe begin by decomposing the sources of the electric field. A standard method, which we will employ, is to imagine a fictitious spherical cavity, the Lorentz sphere, of radius $a$ centered at the lattice site of interest. The local field $\\mathbf{E}_{\\mathrm{loc}}$ can then be expressed as the sum of three distinct contributions:\n$$\n\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{1} + \\mathbf{E}_{2} + \\mathbf{E}_{3}\n$$\nHere, $\\mathbf{E}_{1}$ is the electric field generated by all charges and dipoles outside the Lorentz sphere. $\\mathbf{E}_{2}$ is the field from the bound surface charge that appears on the boundary of the cavity due to the discontinuity in the polarization vector $\\mathbf{P}$. $\\mathbf{E}_{3}$ is the field from any other discrete dipoles that lie inside the sphere.\n\nThe contribution $\\mathbf{E}_{1}$ from sources outside the sphere can be related to the macroscopic electric field, $\\mathbf{E}_{\\mathrm{mac}}$. If the radius $a$ of the Lorentz sphere is chosen to be large compared to the lattice spacing, the discrete lattice of dipoles outside the sphere can be treated as a continuous medium with uniform polarization $\\mathbf{P}$. The field at the center of a spherical cavity within a uniformly polarized medium, due to the polarized material outside the cavity, is precisely what we a call $\\mathbf{E}_{1}$. However, this field is more conveniently calculated by considering that the total field due to all sources external to the crystal, plus all polarization charges on the outer surface of the crystal, plus the bulk and surface polarization charges of the continuous medium outside the sphere, is simply the macroscopic field $\\mathbf{E}_{\\mathrm{mac}}$ that would exist at the origin if the material were a continuum without a cavity. Thus, we can identify the field contribution from all sources outside the cavity as being equivalent to the macroscopic field, $\\mathbf{E}_{\\mathrm{mac}}$. This leads to the decomposition:\n$$\n\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{\\mathrm{mac}} + \\mathbf{E}_{2} + \\mathbf{E}_{3}\n$$\nHere, $\\mathbf{E}_{\\mathrm{mac}}$ accounts for the field from external sources and distant dipoles (treated as a continuum), $\\mathbf{E}_{2}$ accounts for the specific geometry of the cavity we introduced, and $\\mathbf{E}_{3}$ accounts for the discrete nature of the dipoles near the origin.\n\nFirst, we analyze the contribution $\\mathbf{E}_{3}$, which is a sum over the fields of discrete dipoles inside the sphere, excluding the one at the origin. The electric field at the origin due to a point dipole $\\mathbf{p}_{j}$ at position $\\mathbf{r}_{j}$ is given by:\n$$\n\\mathbf{E}_{j} = \\frac{1}{4\\pi\\epsilon_{0}} \\left[ \\frac{3(\\mathbf{p}_{j} \\cdot \\mathbf{r}_{j})\\mathbf{r}_{j}}{r_{j}^{5}} - \\frac{\\mathbf{p}_{j}}{r_{j}^{3}} \\right]\n$$\nThe total field is $\\mathbf{E}_{3} = \\sum_{j \\neq 0, \\text{inside sphere}} \\mathbf{E}_{j}$. For a crystal subjected to a uniform field, all induced dipole moments are, on average, identical: $\\langle \\mathbf{p}_{j} \\rangle = \\langle \\mathbf{p} \\rangle$. We can therefore replace $\\mathbf{p}_{j}$ with a constant vector $\\mathbf{p}$. The problem specifies a simple cubic lattice. For such a lattice, for any site at position $\\mathbf{r}_{j} = (x_j, y_j, z_j)$, there are corresponding sites at positions that are permutations and sign changes of these coordinates. Let us align the polarization $\\mathbf{p}$ with the $z$-axis, $\\mathbf{p} = p\\hat{\\mathbf{z}}$. The $z$-component of $\\mathbf{E}_{3}$ is:\n$$\nE_{3,z} = \\frac{p}{4\\pi\\epsilon_{0}} \\sum_{j \\neq 0} \\frac{3z_{j}^{2} - r_{j}^{2}}{r_{j}^{5}} = \\frac{p}{4\\pi\\epsilon_{0}} \\sum_{j \\neq 0} \\frac{2z_{j}^{2} - x_{j}^{2} - y_{j}^{2}}{r_{j}^{5}}\n$$\nDue to the cubic symmetry of the lattice, the sum over all lattice sites within one or more complete cubic shells satisfies $\\sum_{j} f(x_{j}) = \\sum_{j} f(y_{j}) = \\sum_{j} f(z_{j})$. Consequently, $\\sum_{j} \\frac{x_{j}^{2}}{r_{j}^{5}} = \\sum_{j} \\frac{y_{j}^{2}}{r_{j}^{5}} = \\sum_{j} \\frac{z_{j}^{2}}{r_{j}^{5}}$. The summation for $E_{3,z}$ then becomes proportional to $2\\sum \\frac{z_{j}^{2}}{r_{j}^{5}} - \\sum \\frac{x_{j}^{2}}{r_{j}^{5}} - \\sum \\frac{y_{j}^{2}}{r_{j}^{5}} = 0$. Similarly, the $x$ and $y$ components of $\\mathbf{E}_{3}$ also vanish. This holds if the sphere is large enough to contain many lattice sites such that the sum is performed over complete shells that approximate the sphere, or if the sphere is so small that it contains no other lattice sites, in which case the sum is empty. In either case, as instructed, we conclude that for a simple cubic lattice, the contribution from near neighbors is zero:\n$$\n\\mathbf{E}_{3} = 0\n$$\n\nNext, we evaluate $\\mathbf{E}_{2}$, the field at the center of the cavity due to the bound charge on its surface. When we create the cavity, we remove polarized material, leaving a surface charge density $\\sigma_{b}$ on the spherical boundary $r=a$. This is given by $\\sigma_{b} = \\mathbf{P} \\cdot \\hat{\\mathbf{n}}$, where $\\hat{\\mathbf{n}}$ is the normal vector pointing out of the polarized medium, which is into the cavity. Thus, $\\hat{\\mathbf{n}} = -\\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}}$ is the spherical radial unit vector.\n$$\n\\sigma_{b} = \\mathbf{P} \\cdot (-\\hat{\\mathbf{r}})\n$$\nLet us align the $z$-axis with the uniform polarization vector $\\mathbf{P}$, so $\\mathbf{P} = P\\hat{\\mathbf{z}}$. In spherical coordinates, $\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{z}} = \\cos\\theta$.\n$$\n\\sigma_{b}(\\theta) = -P\\cos\\theta\n$$\nWe must find the electric field at the center of the sphere due to this charge distribution. As requested, we solve the boundary value problem. Inside the cavity ($r<a$), there is no charge, so the electrostatic potential $\\Phi_{\\text{in}}$ satisfies Laplace's equation, $\\nabla^2 \\Phi_{\\text{in}} = 0$. The general regular solution with azimuthal symmetry is:\n$$\n\\Phi_{\\text{in}}(r, \\theta) = \\sum_{l=0}^{\\infty} A_{l} r^{l} P_{l}(\\cos\\theta)\n$$\nwhere $P_{l}$ are the Legendre polynomials. The electric field is $\\mathbf{E}_{2} = -\\nabla \\Phi_{\\text{in}}$. We require the boundary condition on the discontinuity of the electric field at $r=a$:\n$$\n\\left( \\mathbf{E}_{\\text{out}} - \\mathbf{E}_{\\text{in}} \\right) \\cdot \\hat{\\mathbf{n}} = \\frac{\\sigma_{b}}{\\epsilon_{0}}\n$$\nwhere $\\mathbf{E}_{\\text{in}} = \\mathbf{E}_2$ and $\\mathbf{E}_{\\text{out}}$ is the field just outside the surface in the vacuum. Here, it is simpler to relate the potential and its derivative. The boundary condition is $\\frac{\\partial\\Phi_{\\text{in}}}{\\partial r}|_{r=a} - \\frac{\\partial\\Phi_{\\text{out}}}{\\partial r}|_{r=a} = \\frac{\\sigma_b}{\\epsilon_0}$. For our specific problem of finding the field *only* from the surface charge, we assume the potential vanishes at infinity, so $\\Phi_{\\text{out}}(r, \\theta) = \\sum_{l=0}^{\\infty} B_{l} r^{-(l+1)} P_{l}(\\cos\\theta)$. The continuity of the potential $\\Phi_{\\text{in}}(a,\\theta) = \\Phi_{\\text{out}}(a,\\theta)$ gives $A_{l}a^{l} = B_{l}a^{-(l+1)}$. The boundary condition on the field derivative becomes:\n$$\n\\sum_{l=0}^{\\infty} \\left[lA_{l}a^{l-1} - (-(l+1)B_{l}a^{-l-2})\\right] P_{l}(\\cos\\theta) = \\frac{-P\\cos\\theta}{\\epsilon_{0}}\n$$\nSubstituting $B_{l} = A_{l}a^{2l+1}$ and using $P_{1}(\\cos\\theta) = \\cos\\theta$:\n$$\n\\sum_{l=0}^{\\infty} (2l+1)A_{l}a^{l-1} P_{l}(\\cos\\theta) = \\frac{-P}{\\epsilon_{0}} P_{1}(\\cos\\theta)\n$$\nBy orthogonality of the Legendre polynomials, all coefficients must be zero except for $l=1$:\n$$\n(2(1)+1)A_{1}a^{1-1} = \\frac{-P}{\\epsilon_{0}} \\implies 3A_{1} = \\frac{-P}{\\epsilon_{0}} \\implies A_{1} = -\\frac{P}{3\\epsilon_{0}}\n$$\nAll other $A_{l}=0$ for $l \\neq 1$. The potential inside the cavity is therefore:\n$$\n\\Phi_{\\text{in}}(r, \\theta) = A_{1}rP_{1}(\\cos\\theta) = -\\frac{P}{3\\epsilon_{0}} r\\cos\\theta\n$$\nIn Cartesian coordinates, this is $\\Phi_{\\text{in}} = -\\frac{P}{3\\epsilon_{0}} z$. The electric field inside the cavity is uniform:\n$$\n\\mathbf{E}_{2} = -\\nabla \\Phi_{\\text{in}} = -\\nabla \\left(-\\frac{Pz}{3\\epsilon_{0}}\\right) = \\frac{P}{3\\epsilon_{0}}\\hat{\\mathbf{z}}\n$$\nSince we defined $\\mathbf{P} = P\\hat{\\mathbf{z}}$, we can write this in vector form:\n$$\n\\mathbf{E}_{2} = \\frac{\\mathbf{P}}{3\\epsilon_{0}}\n$$\nThis field is the so-called Lorentz field.\n\nFinally, we assemble the components of the local field:\n$$\n\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{\\mathrm{mac}} + \\mathbf{E}_{2} + \\mathbf{E}_{3} = \\mathbf{E}_{\\mathrm{mac}} + \\frac{\\mathbf{P}}{3\\epsilon_{0}} + 0\n$$\nThe final expression for the local electric field at a site in a simple cubic lattice is therefore given by the Lorentz relation. All fields in this expression are measured in SI units of volts per meter (V/m).\n$$\n\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{\\mathrm{mac}} + \\frac{\\mathbf{P}}{3\\epsilon_{0}}\n$$", "answer": "$$\n\\boxed{\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{\\mathrm{mac}} + \\frac{\\mathbf{P}}{3\\epsilon_{0}}}\n$$", "id": "2836905"}, {"introduction": "Theoretical models often rely on powerful approximations, such as treating a discrete lattice of atoms as a continuous medium. The Lorentz field calculation is a prime example, but how accurate is this assumption? This advanced computational practice challenges you to test the limits of the continuum model by directly summing the fields from a discrete lattice of dipoles, offering a tangible sense of how the continuum model emerges and quantifying the errors introduced by this approximation.", "problem": "You are tasked with computing finite-cavity corrections to the Lorentz local field in a crystalline dielectric by explicitly summing the discrete dipole field outside a spherical cavity carved around a lattice site. Start from the following fundamental bases:\n\n- The definition of polarization: for a uniform polarization $\\mathbf{P} = P \\,\\hat{\\mathbf{z}}$, the dipole moment per site is $\\mathbf{\\mu} = \\mu \\,\\hat{\\mathbf{z}}$ with $\\mu = P \\, V_{\\text{site}}$, where $V_{\\text{site}}$ is the volume per lattice site.\n- The electrostatic field of a point dipole: the electric field at position $\\mathbf{r}$ caused by a point dipole $\\mathbf{\\mu}$ located at the origin is\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\epsilon_0} \\left[\\frac{3(\\mathbf{\\mu}\\cdot \\hat{\\mathbf{r}})\\,\\hat{\\mathbf{r}} - \\mathbf{\\mu}}{r^3}\\right],\n$$\nwith $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ and $r=\\|\\mathbf{r}\\|$.\n- For a spherical cavity embedded in a uniformly polarized continuum, the field at the center due to the polarized matter outside the cavity equals $E_{z}^{\\text{cont}} = P/(3\\epsilon_0)$ along $\\hat{\\mathbf{z}}$. In units where $1/(4\\pi\\epsilon_0)=1$, this reference equals $E_{z}^{\\text{cont}} = 4\\pi P/3$.\n\nYou will model three cubic lattices: simple cubic (SC), body-centered cubic (BCC), and face-centered cubic (FCC). Take a conventional cubic cell of lattice constant $a$ with basis:\n- SC: a single site at fractional coordinates $(0,0,0)$, so $n_{\\text{site}}=1$,\n- BCC: sites at $(0,0,0)$ and $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$, so $n_{\\text{site}}=2$,\n- FCC: sites at $(0,0,0)$, $(0,\\tfrac{1}{2},\\tfrac{1}{2})$, $(\\tfrac{1}{2},0,\\tfrac{1}{2})$, and $(\\tfrac{1}{2},\\tfrac{1}{2},0)$, so $n_{\\text{site}}=4$.\n\nLet $\\mathbf{P}=P\\,\\hat{\\mathbf{z}}$ with $P$ a constant. For each lattice type, construct a finite cubic array of conventional cells with integer indices $(i,j,k)$ bounded by $-N \\le i,j,k \\le N$, yielding a supercell of side length $(2N+1)a$. Place dipoles at positions $\\mathbf{r} = a\\,(i+\\xi, j+\\eta, k+\\zeta)$ for each basis vector $(\\xi,\\eta,\\zeta)$ in the chosen lattice. Remove the dipoles whose centers lie within a spherical cavity of radius $R_c$ centered at the origin by excluding all sites with $r < R_c$. Exclude also the central site at the origin if present. Assign to each site a dipole moment $\\mathbf{\\mu} = \\mu \\hat{\\mathbf{z}}$ with $\\mu = P a^3 / n_{\\text{site}}$, consistent with uniform polarization.\n\nCompute the discrete estimate of the $z$-component of the field at the origin due to all included dipoles,\n$$\nE_{z}^{\\text{disc}}(R_c,N;\\text{lattice}) = \\sum_{\\mathbf{r}} \\left[\\frac{1}{4\\pi \\epsilon_0}\\left(\\frac{3(\\mathbf{\\mu}\\cdot\\mathbf{r})\\,z}{r^5} - \\frac{\\mu}{r^3}\\right)\\right],\n$$\nwhere $z$ is the $z$-coordinate of $\\mathbf{r}$, and the sum runs over all included dipoles in the finite array.\n\nAdopt dimensionless units with $1/(4\\pi \\epsilon_0)=1$ and $P=1$, so that $E_{z}^{\\text{cont}}=4\\pi/3$ and $\\mu = a^3/n_{\\text{site}}$.\n\nDefine the dimensionless finite-cavity correction as\n$$\n\\delta(R_c,N;\\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c,N;\\text{lattice})}{E_{z}^{\\text{cont}}} - 1.\n$$\n\nYour task is to implement a program that:\n- Constructs the specified lattice and basis.\n- Sums the discrete dipole contributions outside the spherical cavity of radius $R_c$ and inside the cubic cutoff set by $N$.\n- Computes $\\delta(R_c,N;\\text{lattice})$ for each test case.\n\nAll outputs must be dimensionless real numbers (floats). Angles, if any appear internally, must be treated in radians. No International System of Units (SI) dimensions appear in the outputs because of the chosen unit normalization.\n\nTest suite to evaluate coverage:\n- Case $1$: lattice $\\in\\{\\text{SC}\\}$, $a=1.0$, $R_c=1.2$, $N=10$ (general convergence case).\n- Case $2$: lattice $\\in\\{\\text{SC}\\}$, $a=1.0$, $R_c=0.51$, $N=10$ (small cavity radius close to the nearest-site exclusion).\n- Case $3$: lattice $\\in\\{\\text{SC}\\}$, $a=1.0$, $R_c=1.2$, $N=3$ (small cutoff to probe incomplete shell convergence).\n- Case $4$: lattice $\\in\\{\\text{BCC}\\}$, $a=1.0$, $R_c=1.2$, $N=10$ (different basis density).\n- Case $5$: lattice $\\in\\{\\text{FCC}\\}$, $a=1.0$, $R_c=1.2$, $N=10$ (close-packed basis).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"). The list elements correspond to the cases above in order and must be the numerical values of $\\delta$ for each case, as defined. All intermediate choices must follow the definitions above, and no external input is allowed.", "solution": "The problem statement presented is a well-defined exercise in computational physics. It requires the direct summation of the electric fields from a discrete lattice of dipoles to compute the local field correction, a fundamental concept in the study of dielectrics. The problem is scientifically grounded, internally consistent, and all parameters are specified. It is therefore deemed valid and a rigorous solution can be constructed.\n\nThe task is to compute the finite-cavity correction to the Lorentz local field. The local field, $\\mathbf{E}_{\\text{local}}$, at a given lattice site is the total electric field from all sources *except* the dipole at that site. P. A. M. Lorentz proposed a method to calculate this by conceptually carving out a small spherical cavity around the site. The field is then decomposed into contributions from dipoles inside the cavity (the \"near field\") and the polarized medium outside the cavity (the \"far field\").\n\nIn the standard Lorentz model, the far field from the uniformly polarized continuum outside the sphere contributes $\\mathbf{E}_{\\text{cont}} = \\mathbf{P}/(3\\epsilon_0)$ at the center of the cavity. The near field sum over the discrete dipoles inside the cavity is then performed. For lattices with high (e.g., cubic) symmetry, this near-field sum evaluates to zero, leading to the famous Lorentz relation.\n\nThis problem re-examines the far-field contribution. Instead of treating it as a continuum, we compute it by a direct, discrete sum of dipole fields from sites outside a cavity of radius $R_c$ and within a larger finite cube of size $(2N+1)a$. The deviation of this discrete sum from the continuum value gives the finite-cavity correction $\\delta$.\n\nThe electric field at the origin due to a point dipole $\\mathbf{\\mu}$ at position $\\mathbf{r}$ is given by:\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\epsilon_0} \\left[ \\frac{3(\\mathbf{\\mu} \\cdot \\mathbf{r})\\mathbf{r}}{r^5} - \\frac{\\mathbf{\\mu}}{r^3} \\right]\n$$\nThe problem specifies a uniform polarization $\\mathbf{P} = P \\hat{\\mathbf{z}}$, so each dipole moment is $\\mathbf{\\mu} = \\mu \\hat{\\mathbf{z}}$. For a position vector $\\mathbf{r} = (x, y, z)$, the dot product is $\\mathbf{\\mu} \\cdot \\mathbf{r} = \\mu z$. The $z$-component of the electric field from this single dipole is:\n$$\nE_z = \\frac{1}{4\\pi \\epsilon_0} \\left[ \\frac{3(\\mu z)z}{r^5} - \\frac{\\mu}{r^3} \\right] = \\frac{\\mu}{4\\pi \\epsilon_0} \\left( \\frac{3z^2}{r^5} - \\frac{1}{r^3} \\right)\n$$\nWe adopt dimensionless units such that $1/(4\\pi\\epsilon_0) = 1$ and the polarization magnitude $P=1$. The dipole moment per site is $\\mu = P V_{\\text{site}}$. For a conventional cubic cell of side $a$ containing $n_{\\text{site}}$ basis atoms, the volume per site is $V_{\\text{site}} = a^3/n_{\\text{site}}$. Thus, the dipole moment in these units is $\\mu = a^3/n_{\\text{site}}$.\n\nThe discrete sum for the $z$-component of the field, $E_z^{\\text{disc}}$, is performed over all lattice sites $\\mathbf{r}_{i,j,k,\\beta}$ that satisfy two conditions:\n$1$. They lie within the computational supercell defined by integer indices $-N \\le i, j, k \\le N$.\n$2$. They lie outside the spherical cavity of radius $R_c$, i.e., $\\|\\mathbf{r}_{i,j,k,\\beta}\\| \\ge R_c$.\nThe position of a site is given by $\\mathbf{r}_{i,j,k,\\beta} = a((i, j, k) + (\\xi, \\eta, \\zeta)_{\\beta})$, where $(i,j,k)$ is the cell index and $(\\xi, \\eta, \\zeta)_{\\beta}$ is the fractional coordinate of a basis site $\\beta$. The site at the origin $(\\mathbf{r} = \\mathbf{0})$ is explicitly excluded.\n\nThe total discrete field is the sum:\n$$\nE_{z}^{\\text{disc}}(R_c, N; \\text{lattice}) = \\sum_{i,j,k,\\beta \\text{ s.t. } r \\ge R_c, r \\ne 0} \\mu \\left( \\frac{3z_{i,j,k,\\beta}^2}{r_{i,j,k,\\beta}^5} - \\frac{1}{r_{i,j,k,\\beta}^3} \\right)\n$$\nThe reference continuum field in our chosen units is $E_z^{\\text{cont}} = 4\\pi P/3$. With $P=1$, this is $E_z^{\\text{cont}} = 4\\pi/3$.\n\nThe dimensionless finite-cavity correction $\\delta$ is then calculated as:\n$$\n\\delta(R_c, N; \\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c, N; \\text{lattice})}{E_{z}^{\\text{cont}}} - 1\n$$\nThis quantity measures the relative error incurred by replacing the discrete lattice outside the cavity with a uniform continuum. This error arises from the granularity of the lattice and the finite, cubic shape of the summation volume. For an infinite, spherically-summed lattice, this correction would vanish.\n\nThe algorithm to be implemented is as follows:\n$1$. For each test case, specified by lattice type (SC, BCC, or FCC), lattice constant $a$, cavity radius $R_c$, and supercell size parameter $N$, we initialize the total discrete field $E_{z}^{\\text{disc}}$ to $0$.\n$2$. We define the basis vectors $(\\xi, \\eta, \\zeta)$ and the number of sites $n_{\\text{site}}$ for the chosen lattice. We calculate the dipole moment $\\mu = a^3/n_{\\text{site}}$.\n$3$. We iterate through all cell indices $(i, j, k)$ from $-N$ to $N$.\n$4$. Within each cell, we iterate through all basis vectors. For each site, we compute its position vector $\\mathbf{r} = (x, y, z)$.\n$5$. We check if the site is at the origin ($r=0$). If it is, we skip it.\n$6$. We check if the site is within the spherical cavity ($r < R_c$). If it is, we skip it.\n$7. If the site is included, we calculate its contribution to the field, $\\Delta E_z = \\mu (3z^2/r^5 - 1/r^3)$, and add it to $E_{z}^{\\text{disc}}$.\n$8$. After summing over all included sites, we calculate the reference field $E_z^{\\text{cont}} = 4\\pi/3$.\n$9$. Finally, we compute the correction $\\delta = E_{z}^{\\text{disc}}/E_z^{\\text{cont}} - 1$ and report the result.\n\nThis procedure constitutes a direct numerical evaluation of the problem as stated.", "answer": "```python\nimport numpy as np\n\ndef calculate_delta(lattice_type: str, a: float, Rc: float, N: int) -> float:\n    \"\"\"\n    Computes the finite-cavity correction to the Lorentz local field.\n\n    Args:\n        lattice_type: The type of cubic lattice ('SC', 'BCC', 'FCC').\n        a: The lattice constant.\n        Rc: The radius of the spherical exclusion cavity.\n        N: The half-size of the cubic supercell in units of conventional cells.\n\n    Returns:\n        The dimensionless finite-cavity correction delta.\n    \"\"\"\n    # Define lattice basis vectors in fractional coordinates and number of sites per conventional cell.\n    bases = {\n        'SC': np.array([[0.0, 0.0, 0.0]]),\n        'BCC': np.array([[0.0, 0.0, 0.0], [0.5, 0.5, 0.5]]),\n        'FCC': np.array([[0.0, 0.0, 0.0], [0.0, 0.5, 0.5], [0.5, 0.0, 0.5], [0.5, 0.5, 0.0]]),\n    }\n    nsites = {\n        'SC': 1,\n        'BCC': 2,\n        'FCC': 4,\n    }\n\n    n_site = nsites[lattice_type]\n    basis_vectors = bases[lattice_type]\n    \n    # In dimensionless units, P=1, so mu = V_site = a^3 / n_site.\n    mu = a**3 / n_site\n    \n    E_z_disc = 0.0\n    \n    # Loop over conventional cells indexed by (i, j, k) from -N to N.\n    cell_indices = np.arange(-N, N + 1)\n    for i in cell_indices:\n        for j in cell_indices:\n            for k in cell_indices:\n                # Loop over basis sites within the cell.\n                for basis_vec in basis_vectors:\n                    pos_vec = a * (np.array([i, j, k]) + basis_vec)\n                    \n                    r_sq = np.sum(pos_vec**2)\n                    \n                    # Exclude the site at the origin where the field is calculated.\n                    # A small tolerance is used for floating-point comparison to zero.\n                    if r_sq < 1e-12:\n                        continue\n                    \n                    r = np.sqrt(r_sq)\n                    \n                    # Include only dipoles outside the cavity radius Rc.\n                    if r >= Rc:\n                        z = pos_vec[2]\n                        # The z-component of the field from a single dipole, with 1/(4*pi*eps_0) = 1.\n                        # E_z = mu * (3*z^2/r^5 - 1/r^3)\n                        r_cubed = r**3\n                        r_fifth = r_cubed * r**2 # Computationally cheaper than r**5\n                        E_z_single = mu * (3 * z**2 / r_fifth - 1 / r_cubed)\n                        E_z_disc += E_z_single\n\n    # The continuum field at the center of a spherical cavity, with P=1 and 1/(4*pi*eps_0)=1.\n    E_z_cont = 4 * np.pi / 3.0\n    \n    # Calculate the dimensionless finite-cavity correction.\n    delta = E_z_disc / E_z_cont - 1.0\n    \n    return delta\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 0.51, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 3},\n        {'lattice': 'BCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'FCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n    ]\n\n    results = []\n    for case in test_cases:\n        delta = calculate_delta(case['lattice'], case['a'], case['R_c'], case['N'])\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2836909"}]}