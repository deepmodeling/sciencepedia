{"hands_on_practices": [{"introduction": "The heart of the Ewald method lies in its elegant splitting of a conditionally convergent sum into two rapidly converging series: one in real space and one in reciprocal space. This first exercise [@problem_id:97935] focuses on the reciprocal-space component, which captures the long-range part of the electrostatic interaction. By applying the general formula to a simplified one-dimensional ionic chain, you will practice calculating the structure factor and summing over reciprocal lattice vectors, two fundamental skills for any Ewald calculation.", "problem": "The Ewald summation method is a powerful technique for calculating the electrostatic energy of periodic systems. It splits the slowly-converging lattice sum of point-charge interactions into a rapidly-converging real-space sum and a rapidly-converging reciprocal-space sum.\n\nThe contribution to the total energy per unit cell from the reciprocal-space sum, for a system of charges in three dimensions, is given by:\n$$ U_{\\text{recip}} = \\frac{1}{2V} \\sum_{\\mathbf{G} \\neq 0} \\frac{4\\pi}{G^2} |S(\\mathbf{G})|^2 e^{-G^2 / (4\\eta^2)} $$\nwhere $V$ is the volume of the unit cell, $\\mathbf{G}$ are the non-zero reciprocal lattice vectors, $\\eta$ is the Ewald splitting parameter, and $S(\\mathbf{G})$ is the structure factor for the unit cell. The structure factor is defined as $S(\\mathbf{G}) = \\sum_{j} q_j e^{-i \\mathbf{G} \\cdot \\mathbf{r}_j}$, where the sum runs over all charges $q_j$ at positions $\\mathbf{r}_j$ within the unit cell.\n\nConsider an infinite one-dimensional chain of alternating point charges aligned along the x-axis. The unit cell has length $a$ and contains two charges: a charge $+q$ at position $x_1=0$ and a charge $-q$ at position $x_2=a/2$. For such a 1D system embedded in 3D space, the unit cell \"volume\" is taken to be its length, $V=a$, and the reciprocal lattice vectors are given by $G_n = \\frac{2\\pi n}{a}$ for any non-zero integer $n$.\n\nYour task is to calculate the partial sum $U_{\\text{recip}}^{(5)}$, which represents the contribution to the reciprocal-space energy from the first five non-zero positive-indexed reciprocal lattice vectors, i.e., those corresponding to $n=1, 2, 3, 4, 5$. Express your answer in terms of the charge $q$, the lattice constant $a$, and the Ewald parameter $\\eta$.", "solution": "We start from the reciprocal‐space energy per cell in 3D, specialized to a 1D chain of length $a$ (unit “volume” $V=a$):\n$$\nU_{\\rm recip}\n=\\frac{1}{2V}\\sum_{G\\neq0}\\frac{4\\pi}{G^2}\\bigl|S(G)\\bigr|^2\\,e^{-G^2/(4\\eta^2)}.\n$$\nHere $G_n=\\tfrac{2\\pi n}{a}$, $n\\in\\mathbb Z\\setminus\\{0\\}$, and for charges $+q$ at $x_1=0$, $-q$ at $x_2=a/2$,\n$$\nS(G)=\\sum_j q_j e^{-iGx_j}\n= q\\bigl(1 - e^{-iG\\,a/2}\\bigr).\n$$\nHence\n$$\n|S(G_n)|^2\n= q^2\\bigl|1 - e^{-i\\pi n}\\bigr|^2\n= q^2\\bigl(2 -2\\cos(\\pi n)\\bigr)\n=2q^2\\bigl[1-(-1)^n\\bigr].\n$$\nThus $|S(G_n)|^2=4q^2$ for $n$ odd and zero for $n$ even.  The partial sum over $n=1,\\dots,5$ reduces to $n=1,3,5$.  Substituting $G_n^2=(2\\pi n/a)^2$ gives\n$$\nU_{\\rm recip}^{(5)}\n=\\frac{1}{2a}\\sum_{n=1,3,5}\\frac{4\\pi}{(2\\pi n/a)^2}\\,4q^2\n\\exp\\!\\Bigl[-\\frac{(2\\pi n/a)^2}{4\\eta^2}\\Bigr].\n$$\nSimplify each term:\n$$\n\\frac{4\\pi}{(2\\pi n/a)^2}\\,4q^2\n=4q^2\\frac{4\\pi}{4\\pi^2n^2/a^2}\n=\\frac{4q^2a^2}{\\pi n^2},\n\\quad\n\\exp\\!\\Bigl[-\\frac{(2\\pi n/a)^2}{4\\eta^2}\\Bigr]\n=\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr].\n$$\nThus\n$$\nU_{\\rm recip}^{(5)}\n=\\frac{1}{2a}\\sum_{n=1,3,5}\\frac{4q^2a^2}{\\pi n^2}\n\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr]\n=\\frac{2q^2a}{\\pi}\\sum_{n=1,3,5}\\frac{1}{n^2}\n\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr].\n$$\nExplicitly,\n$$\nU_{\\rm recip}^{(5)}\n=\\frac{2q^2a}{\\pi}\\Bigl(\ne^{-\\frac{\\pi^2}{a^2\\eta^2}}\n+\\frac{1}{9}e^{-\\frac{9\\pi^2}{a^2\\eta^2}}\n+\\frac{1}{25}e^{-\\frac{25\\pi^2}{a^2\\eta^2}}\n\\Bigr).\n$$", "answer": "$$\\boxed{\\frac{2q^2a}{\\pi}\\Bigl(e^{-\\frac{\\pi^2}{a^2\\eta^2}}+\\frac{1}{9}e^{-\\frac{9\\pi^2}{a^2\\eta^2}}+\\frac{1}{25}e^{-\\frac{25\\pi^2}{a^2\\eta^2}}\\Bigr)}$$", "id": "97935"}, {"introduction": "A correct Ewald calculation requires more than just the real and reciprocal space sums; it also involves crucial correction terms that arise from the mathematical construction of the method. This practice [@problem_id:97840] directs your attention to two of these terms: the self-potential, which removes the unphysical interaction of a charge with its own screening cloud, and the constant potential offset, which corrects for the average potential of the system. Mastering these concepts is essential for understanding the complete and self-consistent nature of the Ewald potential.", "problem": "In solid-state physics, the Ewald summation method is a powerful technique for calculating the long-range electrostatic potential in periodic systems. The method splits the slowly-converging lattice sum into two rapidly-converging parts: a sum in real space and a sum in reciprocal space. This process introduces correction terms to avoid double-counting and to handle self-interaction artifacts.\n\nConsider a crystal structure described by a charge-neutral unit cell of volume $\\Omega$ containing ions with charges $q_j$ at positions $\\mathbf{r}_j$. The total electrostatic potential at a specific ion site can be broken down into several components. Your task is to compute the sum of two such components for a specific crystal lattice at the ion site located at the origin.\n\nThe crystal has a cubic unit cell of side length $a$. It contains two ions: one with charge $+q$ at the origin $\\mathbf{r}_1 = (0,0,0)$ and another with charge $-q$ at the body center $\\mathbf{r}_2 = (a/2, a/2, a/2)$.\n\nCalculate the sum of the following two potential contributions at the ion site at the origin ($\\mathbf{r}_1$):\n\n1.  **The self-potential term ($V_{self}$):** This term corrects for the interaction of an ion's point charge with its own screening Gaussian charge cloud, which is an artifact of the Ewald method. The potential at the center of a Gaussian charge distribution $\\rho^G(\\mathbf{r}) = q (\\eta/\\pi)^{3/2} \\exp(-\\eta r^2)$ is given by $V_{self} = \\frac{q \\sqrt{\\eta}}{2\\epsilon_0\\pi\\sqrt{\\pi}}$. Here, $q$ is the charge of the ion at the site of interest, $\\eta$ is the Ewald convergence parameter, and $\\epsilon_0$ is the vacuum permittivity.\n\n2.  **The constant potential offset ($V_{offset}$):** This term represents the average potential created by the smooth part of the charge distribution used in the reciprocal-space sum. For a periodic system in vacuum, this potential is constant across the unit cell and is given by the formula $V_{offset} = -\\frac{1}{6\\epsilon_0 \\Omega} \\sum_{j \\in \\text{cell}} q_j |\\mathbf{r}_j|^2$. The sum is over all ions within one unit cell.\n\nProvide the total potential $V_{total} = V_{self} + V_{offset}$ as a single symbolic expression.", "solution": "The electrostatic potential at the ion site at the origin, $\\mathbf{r}_1 = (0,0,0)$, is the sum of the self-potential term and the constant potential offset:\n\n$$\nV_{\\text{total}} = V_{\\text{self}} + V_{\\text{offset}}.\n$$\n\n\n**Step 1: Compute $V_{\\text{self}}$ for the ion at the origin.**\nThe self-potential for an ion with charge $q_j$ is given by:\n\n$$\nV_{\\text{self}} = \\frac{q_j \\sqrt{\\eta}}{2 \\epsilon_0 \\pi \\sqrt{\\pi}}.\n$$\n\nFor the ion at the origin, $q_j = q_1 = +q$. Thus:\n\n$$\nV_{\\text{self}} = \\frac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi \\sqrt{\\pi}} = \\frac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}}.\n$$\n\n\n**Step 2: Compute $V_{\\text{offset}}$.**\nThe constant potential offset is given by:\n\n$$\nV_{\\text{offset}} = -\\frac{1}{6 \\epsilon_0 \\Omega} \\sum_{j \\in \\text{cell}} q_j |\\mathbf{r}_j|^2,\n$$\n\nwhere $\\Omega = a^3$ is the volume of the cubic unit cell. The sum runs over both ions in the unit cell.\n\n- For ion 1 at $\\mathbf{r}_1 = (0,0,0)$ with charge $q_1 = +q$:\n  \n$$\n  |\\mathbf{r}_1|^2 = 0^2 + 0^2 + 0^2 = 0, \\quad \\text{so} \\quad q_1 |\\mathbf{r}_1|^2 = q \\cdot 0 = 0.\n  $$\n\n- For ion 2 at $\\mathbf{r}_2 = (a/2, a/2, a/2)$ with charge $q_2 = -q$:\n  \n$$\n  |\\mathbf{r}_2|^2 = \\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2}\\right)^2 = 3 \\cdot \\frac{a^2}{4} = \\frac{3a^2}{4}, \\quad \\text{so} \\quad q_2 |\\mathbf{r}_2|^2 = (-q) \\cdot \\frac{3a^2}{4} = -\\frac{3q a^2}{4}.\n  $$\n\nSumming these contributions:\n\n$$\n\\sum_{j} q_j |\\mathbf{r}_j|^2 = 0 + \\left(-\\frac{3q a^2}{4}\\right) = -\\frac{3q a^2}{4}.\n$$\n\nSubstitute into the formula for $V_{\\text{offset}}$:\n\n$$\nV_{\\text{offset}} = -\\frac{1}{6 \\epsilon_0 a^3} \\left(-\\frac{3q a^2}{4}\\right) = \\frac{1}{6 \\epsilon_0 a^3} \\cdot \\frac{3q a^2}{4} = \\frac{3q a^2}{24 \\epsilon_0 a^3} = \\frac{q}{8 \\epsilon_0 a}.\n$$\n\n\n**Step 3: Sum the components to find $V_{\\text{total}}$.**\n\n$$\nV_{\\text{total}} = V_{\\text{self}} + V_{\\text{offset}} = \\frac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}} + \\frac{q}{8 \\epsilon_0 a}.\n$$\n\nThis expression is the total electrostatic potential at the origin.", "answer": "$$\n\\boxed{\\dfrac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}} + \\dfrac{q}{8 \\epsilon_0 a}}\n$$", "id": "97840"}, {"introduction": "Moving from theory to application, the efficiency of an Ewald summation in a computer simulation is paramount. This efficiency is governed by the choice of the splitting parameter $\\alpha$ and the cutoffs used for the real-space ($R_{cut}$) and reciprocal-space ($G_{cut}$) sums. This final exercise [@problem_id:97871] challenges you to think like a computational physicist by finding the optimal relationship between these parameters to minimize computational cost for a desired accuracy, providing a valuable glimpse into the practical art of algorithm optimization.", "problem": "In the Ewald summation method for calculating electrostatic interactions in periodic systems, the total potential energy calculation is split into a rapidly converging real-space sum and a rapidly converging reciprocal-space sum. The convergence of these sums is controlled by a splitting parameter $\\alpha$. In practical implementations, both sums are truncated at finite cutoffs: the real-space sum at a radius $R_{cut}$ and the reciprocal-space sum at a wavevector magnitude $G_{cut}$.\n\nThe accuracy of the calculation depends on the choice of $\\alpha$, $R_{cut}$, and $G_{cut}$. For a given desired accuracy $\\epsilon$, the parameters are chosen to balance the truncation errors from both sums. Let the root-mean-square (RMS) error contributions from the real-space and reciprocal-space sums be given by $\\epsilon_R$ and $\\epsilon_K$, respectively:\n\n$$\n\\epsilon_R = C_1 \\frac{\\exp[-(\\alpha R_{cut})^2]}{(\\alpha R_{cut})^2}\n$$\n$$\n\\epsilon_K = C_2 \\frac{\\exp[-(G_{cut}/(2\\alpha))^2]}{G_{cut}/(2\\alpha)}\n$$\n\nwhere $C_1$ and $C_2$ are positive constants dependent on the system properties. A common strategy to achieve an overall accuracy of $\\epsilon$ is to require that both error contributions are individually equal to $\\epsilon$: $\\epsilon_R = \\epsilon$ and $\\epsilon_K = \\epsilon$.\n\nThe computational cost of the calculation is the sum of the costs for the real-space and reciprocal-space parts, $T = T_R + T_K$. For a particular (perhaps non-standard) implementation, these costs are given by:\n\n$$\nT_R = K_R R_{cut}^2\n$$\n$$\nT_K = K_G G_{cut}^3\n$$\n\nwhere $K_R$ and $K_G$ are positive constants related to the algorithm and machine performance.\n\nYour task is to find the optimal partitioning of computational effort between the real and reciprocal-space calculations. To do this, first express $R_{cut}$ and $G_{cut}$ in terms of $\\alpha$ and the target accuracy $\\epsilon$. Then, find the value of $\\alpha$ that minimizes the total computational cost $T(\\alpha)$. Finally, derive the numerical value of the ratio of the computational costs, $\\frac{T_R}{T_K}$, for this optimal choice of $\\alpha$.\n\n**Approximation Guidance:** For a high-accuracy calculation, $\\epsilon$ is very small. This implies that the arguments $u = \\alpha R_{cut}$ and $v = G_{cut}/(2\\alpha)$ are large. In solving equations of the form $\\epsilon = C' \\frac{e^{-x^2}}{x^n}$ for $x$, you may use the leading-order approximation $x^2 \\approx \\ln(C'/\\epsilon)$, neglecting the slowly varying logarithmic corrections.", "solution": "We are given:\n- The RMS error for the real-space sum: $\\epsilon_R = C_1 \\frac{\\exp[-(\\alpha R_{cut})^2]}{(\\alpha R_{cut})^2} = \\epsilon$\n- The RMS error for the reciprocal-space sum: $\\epsilon_K = C_2 \\frac{\\exp[-(G_{cut}/(2\\alpha))^2]}{G_{cut}/(2\\alpha)} = \\epsilon$\n- Computational costs: $T_R = K_R R_{cut}^2$ and $T_K = K_G G_{cut}^3$\n\nFor high accuracy ($\\epsilon$ small), we use the approximation $x^2 \\approx \\ln(C'/\\epsilon)$ for equations of the form $\\epsilon = C' e^{-x^2}/x^n$.\n\n**Step 1: Solve for $R_{cut}$ and $G_{cut}$ in terms of $\\alpha$ and $\\epsilon$.**\n\nFor $\\epsilon_R = \\epsilon$:\n- Let $u = \\alpha R_{cut}$. Then $\\epsilon = C_1 e^{-u^2} / u^2$.\n- Approximation: $u^2 \\approx \\ln(C_1 / \\epsilon)$.\n- Thus, $(\\alpha R_{cut})^2 \\approx \\ln(C_1 / \\epsilon)$.\n- Solving for $R_{cut}$: $R_{cut} \\approx \\frac{1}{\\alpha} \\sqrt{\\ln(C_1 / \\epsilon)}$.\n\nFor $\\epsilon_K = \\epsilon$:\n- Let $v = G_{cut}/(2\\alpha)$. Then $\\epsilon = C_2 e^{-v^2} / v$.\n- Approximation: $v^2 \\approx \\ln(C_2 / \\epsilon)$ (since $n=1$).\n- Thus, $\\left( \\frac{G_{cut}}{2\\alpha} \\right)^2 \\approx \\ln(C_2 / \\epsilon)$.\n- Solving for $G_{cut}$: $G_{cut} \\approx 2\\alpha \\sqrt{\\ln(C_2 / \\epsilon)}$.\n\n**Step 2: Express computational costs $T_R$ and $T_K$.**\n\nSubstitute $R_{cut}$ and $G_{cut}$:\n- $T_R = K_R R_{cut}^2 \\approx K_R \\left( \\frac{1}{\\alpha} \\sqrt{\\ln(C_1 / \\epsilon)} \\right)^2 = K_R \\frac{\\ln(C_1 / \\epsilon)}{\\alpha^2}$\n- $T_K = K_G G_{cut}^3 \\approx K_G \\left( 2\\alpha \\sqrt{\\ln(C_2 / \\epsilon)} \\right)^3 = K_G \\cdot 8 \\alpha^3 \\left( \\ln(C_2 / \\epsilon) \\right)^{3/2}$\n\n**Step 3: Total cost $T(\\alpha) = T_R + T_K$ and minimization.**\n\nDefine constants:\n- $A = K_R \\ln(C_1 / \\epsilon)$ (independent of $\\alpha$)\n- $B = 8 K_G \\left( \\ln(C_2 / \\epsilon) \\right)^{3/2}$ (independent of $\\alpha$)\n\nThen:\n- $T(\\alpha) = A \\alpha^{-2} + B \\alpha^3$\n\nMinimize $T(\\alpha)$ by setting derivative to zero:\n- $\\frac{dT}{d\\alpha} = -2A \\alpha^{-3} + 3B \\alpha^2 = 0$\n- Rearrange: $3B \\alpha^2 = 2A \\alpha^{-3}$\n- Multiply both sides by $\\alpha^3$: $3B \\alpha^5 = 2A$\n- Thus, $A = \\frac{3}{2} B \\alpha^5$\n\n**Step 4: Find ratio $T_R / T_K$ at optimum.**\n\nFrom the cost expressions and the minimization condition:\n- $T_R = A \\alpha^{-2}$\n- $T_K = B \\alpha^3$\n- Ratio: $\\frac{T_R}{T_K} = \\frac{A \\alpha^{-2}}{B \\alpha^3} = \\frac{A}{B \\alpha^5}$\n\nSubstitute $A = \\frac{3}{2} B \\alpha^5$:\n- $\\frac{T_R}{T_K} = \\frac{\\frac{3}{2} B \\alpha^5}{B \\alpha^5} = \\frac{3}{2}$\n\nThus, the ratio is $3/2$.", "answer": "$$\\boxed{\\dfrac{3}{2}}$$", "id": "97871"}]}