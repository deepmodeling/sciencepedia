{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds our understanding of integrability in a clear and simple setting. We will examine a distribution on $\\mathbb{R}^3$ spanned by two coordinate vector fields and confirm its integrability using two fundamental approaches: the involutivity of the Lie bracket and the differential forms version of the Frobenius theorem . This exercise builds a strong foundation by connecting the abstract algebraic criteria to the tangible geometric picture of a foliation by parallel planes.",
            "id": "3740104",
            "problem": "Consider the smooth manifold $\\mathbb{R}^{3}$ with global coordinates $(x,y,z)$ and its tangent bundle $T\\mathbb{R}^{3}$. A smooth rank-$2$ distribution $\\mathcal{D} \\subset T\\mathbb{R}^{3}$ is given at each point $(x,y,z)$ as the span of the two coordinate vector fields $\\partial_{x}$ and $\\partial_{y}$. Use only the foundational facts and definitions of smooth distributions, Lie brackets of vector fields, and Frobenius's theorem (which states that a $C^{\\infty}$ distribution $\\mathcal{D}$ is integrable if and only if it is involutive, i.e., closed under the Lie bracket, equivalently if its annihilator defines a differential ideal).\n\nYour tasks are:\n- Starting from the definition of a distribution and the Lie bracket, verify that the distribution $\\mathcal{D}=\\operatorname{span}\\{\\partial_{x},\\partial_{y}\\}$ is involutive. Then, using Frobenius's theorem, conclude that $\\mathcal{D}$ is integrable.\n- Alternatively, starting from the definition of the annihilator of a distribution, exhibit a smooth $1$-form $\\alpha$ such that $\\ker(\\alpha)=\\mathcal{D}$ and verify directly that $\\alpha$ and its exterior derivative $d\\alpha$ satisfy the Frobenius condition, thereby concluding integrability from the differential ideal perspective.\n- Describe the maximal connected integral manifolds (leaves) through an arbitrary point $(x_{0},y_{0},z_{0})$ in two equivalent ways: (i) as the level sets of a smooth submersion $F:\\mathbb{R}^{3}\\to\\mathbb{R}$, and (ii) by giving an explicit parametrization as an immersed surface in $\\mathbb{R}^{3}$ whose tangent spaces coincide with $\\mathcal{D}$.\n- Provide, as your final answer, the explicit analytic expression for the submersion $F(x,y,z)$ whose level sets are precisely the leaves of the foliation integrating $\\mathcal{D}$.\n\nNo numerical rounding is required. Express the final answer as a single analytic expression for the function $F(x,y,z)$.",
            "solution": "The problem asks for an analysis of a given rank-$2$ distribution on $\\mathbb{R}^{3}$ from the perspective of integrability, culminating in the explicit description of its integral manifolds.\n\nThe smooth manifold is $M = \\mathbb{R}^{3}$ with global coordinates $(x,y,z)$. The distribution $\\mathcal{D}$ is a rank-$2$ subbundle of the tangent bundle $TM = T\\mathbb{R}^{3}$. At each point $p=(x,y,z) \\in \\mathbb{R}^{3}$, the fiber $\\mathcal{D}_{p}$ is defined as the linear span of the basis vectors of the tangent space $T_{p}\\mathbb{R}^{3}$ corresponding to the first two coordinates:\n$$\n\\mathcal{D}_{p} = \\operatorname{span}\\{\\partial_{x}|_{p}, \\partial_{y}|_{p}\\}\n$$\nWe can represent the distribution globally as being spanned by the vector fields $X_{1} = \\partial_{x}$ and $X_{2} = \\partial_{y}$.\n\nFirst, we verify that the distribution $\\mathcal{D}$ is involutive. A distribution is involutive if for any two vector fields $V, W$ belonging to the distribution (i.e., $V(p), W(p) \\in \\mathcal{D}_{p}$ for all $p$), their Lie bracket $[V,W]$ also belongs to the distribution. Since $\\mathcal{D}$ is spanned by $X_{1} = \\partial_{x}$ and $X_{2} = \\partial_{y}$, it is sufficient to check if the Lie bracket $[X_{1}, X_{2}]$ is in $\\mathcal{D}$.\n\nThe Lie bracket of two vector fields $V = \\sum_{i} V^{i} \\partial_{i}$ and $W = \\sum_{j} W^{j} \\partial_{j}$ is given by the formula:\n$$\n[V,W] = \\sum_{k} \\left( \\sum_{i} V^{i} \\frac{\\partial W^{k}}{\\partial x^{i}} - W^{i} \\frac{\\partial V^{k}}{\\partial x^{i}} \\right) \\partial_{k}\n$$\nIn our case, $X_{1} = \\partial_{x}$ has components $(X_{1}^{x}, X_{1}^{y}, X_{1}^{z}) = (1,0,0)$ and $X_{2} = \\partial_{y}$ has components $(X_{2}^{x}, X_{2}^{y}, X_{2}^{z}) = (0,1,0)$. All these component functions are constants. Therefore, all their partial derivatives are zero.\n$$\n\\frac{\\partial X_{1}^{k}}{\\partial x^{i}} = 0 \\quad \\text{and} \\quad \\frac{\\partial X_{2}^{k}}{\\partial x^{i}} = 0 \\quad \\text{for all } i,k \\in \\{x,y,z\\}.\n$$\nThe Lie bracket is thus:\n$$\n[\\partial_{x}, \\partial_{y}] = \\sum_{k} \\left( \\sum_{i} \\delta_{ix} \\frac{\\partial \\delta_{ky}}{\\partial x^{i}} - \\delta_{iy} \\frac{\\partial \\delta_{kx}}{\\partial x^{i}} \\right) \\partial_{k} = \\sum_{k} (0 - 0) \\partial_{k} = 0\n$$\nThe result is the zero vector field. The zero vector field belongs to every vector subspace, so $0 \\in \\mathcal{D}_{p}$ for all $p$. Thus, the distribution $\\mathcal{D}$ is involutive.\nAccording to Frobenius's theorem, a smooth distribution is integrable if and only if it is involutive. Since $\\mathcal{D}$ is involutive, it is integrable.\n\nAlternatively, we can use the language of differential forms and annihilators. The annihilator of $\\mathcal{D}$, denoted $\\mathcal{D}^{0}$, is the set of $1$-forms $\\alpha$ on $\\mathbb{R}^{3}$ such that $\\alpha(V) = 0$ for all vector fields $V \\in \\mathcal{D}$. A general $1$-form on $\\mathbb{R}^{3}$ can be written as $\\alpha = a(x,y,z)dx + b(x,y,z)dy + c(x,y,z)dz$.\nThe condition $\\alpha(V)=0$ for all $V \\in \\mathcal{D}$ is equivalent to $\\alpha(X_{1})=0$ and $\\alpha(X_{2})=0$.\n$$\n\\alpha(\\partial_{x}) = (a dx + b dy + c dz)(\\partial_{x}) = a(x,y,z) = 0\n$$\n$$\n\\alpha(\\partial_{y}) = (a dx + b dy + c dz)(\\partial_{y}) = b(x,y,z) = 0\n$$\nSo, any $1$-form in $\\mathcal{D}^{0}$ must be of the form $\\alpha = c(x,y,z)dz$. The module of annihilating $1$-forms is generated by the single $1$-form $dz$.\nSince $\\mathcal{D}$ has codimension $3 - 2 = 1$, we can describe it as the kernel of a single non-vanishing $1$-form. We can choose the simplest generator, $\\alpha = dz$.\nLet's check that $\\ker(\\alpha) = \\mathcal{D}$. The kernel of $\\alpha$ consists of all tangent vectors $V = V^{x}\\partial_{x} + V^{y}\\partial_{y} + V^{z}\\partial_{z}$ such that $\\alpha(V)=0$.\n$$\n\\alpha(V) = dz(V^{x}\\partial_{x} + V^{y}\\partial_{y} + V^{z}\\partial_{z}) = V^{z}\n$$\nSo, $\\alpha(V)=0$ implies $V^{z}=0$. The vectors with a zero $z$-component are precisely the linear combinations of $\\partial_{x}$ and $\\partial_{y}$. Thus, $\\ker(\\alpha) = \\operatorname{span}\\{\\partial_{x}, \\partial_{y}\\} = \\mathcal{D}$.\n\nThe Frobenius integrability condition stated in terms of differential forms is that the ideal generated by the annihilating forms is a differential ideal. For a codimension-$1$ distribution defined by $\\ker(\\alpha)$, this condition simplifies to $\\alpha \\wedge d\\alpha = 0$.\nLet's compute the exterior derivative of $\\alpha = dz$:\n$$\nd\\alpha = d(dz) = d(0 dx + 0 dy + 1 dz) = 0\n$$\nThe exterior derivative $d\\alpha$ is the zero $2$-form. Therefore, the condition is satisfied trivially:\n$$\n\\alpha \\wedge d\\alpha = dz \\wedge 0 = 0\n$$\nThis confirms that $\\mathcal{D}$ is integrable. The condition $d\\alpha=0$ is a stronger condition known as being completely integrable, which implies the existence of a function $F$ such that $\\alpha$ is proportional to $dF$. In our case, $\\alpha=dz=d(z)$, so we can take $F=z$.\n\nNow we describe the integral manifolds (leaves) of the foliation integrating $\\mathcal{D}$. An integral manifold $S$ is an immersed submanifold of $\\mathbb{R}^{3}$ such that for every point $p \\in S$, the tangent space $T_{p}S$ is equal to $\\mathcal{D}_{p}$.\nThis means that for any $p \\in S$, $T_{p}S = \\operatorname{span}\\{\\partial_{x}|_{p}, \\partial_{y}|_{p}\\}$. Any tangent vector to the surface must be a linear combination of $\\partial_{x}$ and $\\partial_{y}$, and thus has no component in the $\\partial_{z}$ direction. This implies that the surface must be locally \"flat\" with respect to the $z$-axis. More formally, for any smooth curve $\\gamma(t) = (x(t),y(t),z(t))$ lying in an integral manifold, its tangent vector $\\dot{\\gamma}(t) = \\dot{x}(t)\\partial_{x} + \\dot{y}(t)\\partial_{y} + \\dot{z}(t)\\partial_{z}$ must belong to $\\mathcal{D}_{\\gamma(t)}$. This requires $\\dot{z}(t)=0$ for all $t$. This implies that $z(t)$ is constant along any such curve. Since any two points in a connected manifold can be joined by a smooth curve, the $z$-coordinate must be constant over the entire connected integral manifold.\nThe maximal connected integral manifolds, or leaves, are therefore the planes of constant $z$.\n\nWe describe these leaves in two ways as requested:\n(i) As the level sets of a smooth submersion $F:\\mathbb{R}^{3}\\to\\mathbb{R}$.\nThe leaves are the sets $\\{(x,y,z) \\in \\mathbb{R}^{3} \\mid z = c\\}$ for constants $c \\in \\mathbb{R}$. We can define a function $F(x,y,z) = z$. The level sets of this function are $F^{-1}(c) = \\{(x,y,z) \\in \\mathbb{R}^{3} \\mid z=c\\}$, which are precisely the leaves of the foliation.\nTo be a submersion, the differential $dF$ must be surjective at every point. The differential is a $1$-form:\n$$\ndF = \\frac{\\partial F}{\\partial x}dx + \\frac{\\partial F}{\\partial y}dy + \\frac{\\partial F}{\\partial z}dz = 0 \\cdot dx + 0 \\cdot dy + 1 \\cdot dz = dz\n$$\nSince $dF=dz$ is non-zero at every point in $\\mathbb{R}^{3}$, its rank as a linear map from the tangent space to $\\mathbb{R}$ is always $1$, which is the dimension of the target space $\\mathbb{R}$. Thus, $F$ is a submersion. The tangent space to a level set of $F$ is precisely the kernel of $dF$. Here, $\\ker(dF) = \\ker(dz) = \\mathcal{D}$, as required. The leaf passing through an arbitrary point $(x_{0}, y_{0}, z_{0})$ is the level set $F(x,y,z) = F(x_{0}, y_{0}, z_{0}) = z_{0}$, i.e., the plane $z=z_{0}$.\n\n(ii) By giving an explicit parametrization as an immersed surface.\nThe leaf through an arbitrary point $(x_{0}, y_{0}, z_{0})$ is the plane $z=z_{0}$. We can parametrize this plane using parameters $(u,v) \\in \\mathbb{R}^{2}$. An explicit parametrization $\\Phi: \\mathbb{R}^{2} \\to \\mathbb{R}^{3}$ is given by:\n$$\n\\Phi(u,v) = (u,v,z_{0})\n$$\nThe tangent space to this surface at a point $\\Phi(u,v)$ is spanned by the vectors $\\frac{\\partial\\Phi}{\\partial u}$ and $\\frac{\\partial\\Phi}{\\partial v}$.\n$$\n\\frac{\\partial\\Phi}{\\partial u} = (1,0,0), \\text{ which corresponds to the vector field } \\partial_{x}.\n$$\n$$\n\\frac{\\partial\\Phi}{\\partial v} = (0,1,0), \\text{ which corresponds to the vector field } \\partial_{y}.\n$$\nThe tangent space to the parametrized surface at any point is $\\operatorname{span}\\{\\partial_{x}, \\partial_{y}\\} = \\mathcal{D}$. This confirms that this parametrization describes the integral manifold.\n\nFinally, the problem asks for the explicit analytic expression for the submersion $F(x,y,z)$ whose level sets are the leaves of the foliation. As derived above, the simplest such function is $F(x,y,z)=z$.",
            "answer": "$$\n\\boxed{z}\n$$"
        },
        {
            "introduction": "Not all distributions are integrable, and quantifying the degree of non-integrability is crucial in fields like control theory and sub-Riemannian geometry. This exercise introduces the concept of the derived flag and the growth vector, powerful tools for diagnosing non-involutive distributions . By computing the growth vector for a specific non-integrable distribution on $\\mathbb{R}^3$, we will observe how the dimension of the distribution's span \"grows\" under the Lie bracket operation, a direct indicator of non-integrability.",
            "id": "3740108",
            "problem": "Let $M=\\mathbb{R}^{3}$ with global coordinates $(x,y,z)$ and consider the smooth rank-$2$ distribution $D\\subset TM$ spanned by the vector fields $X_{1}=\\partial_{x}+y\\,\\partial_{z}$ and $X_{2}=\\partial_{y}$. Using only the standard definitions of distributions, Lie brackets of vector fields, and Frobenius’s theorem on involutivity and integrability, do the following:\n\n- State a precise definition of the growth vector of a smooth distribution $D$ at a point $p\\in M$, by constructing the derived flag $D^{1}\\subset D^{2}\\subset\\cdots$ via Lie brackets and recording the sequence of dimensions until stabilization.\n\n- Compute the growth vector of $D=\\operatorname{span}\\{X_{1},X_{2}\\}$ at an arbitrary point $p\\in\\mathbb{R}^{3}$.\n\nExpress your final answer as a single row matrix listing the successive dimensions in the growth vector. No rounding is required. Do not include units.",
            "solution": "The problem asks for two things: first, a precise definition of the growth vector of a smooth distribution, and second, the computation of this vector for a specific distribution on $\\mathbb{R}^{3}$.\n\nFirst, let's define the growth vector. Let $M$ be a smooth manifold and let $D \\subset TM$ be a smooth rank-$k$ distribution on $M$. Let $\\Gamma(D)$ denote the set of all smooth vector fields on $M$ whose values lie in $D$. The derived flag of $D$ is a sequence of nested distributions $D^1 \\subseteq D^2 \\subseteq D^3 \\subseteq \\dots$ constructed as follows:\n1.  Define the first distribution in the sequence as $D^1 = D$.\n2.  For $j \\ge 1$, define the $(j+1)$-th distribution, $D^{j+1}$, as the span of $D^j$ and all Lie brackets of vector fields from $D^j$ with vector fields from $D^1$. More precisely, at each point $p \\in M$, the fiber $D_p^{j+1}$ is given by\n    $$D_p^{j+1} = D_p^j + \\operatorname{span}\\{ [X, Y](p) \\mid X \\in \\Gamma(D^j), Y \\in \\Gamma(D^1) \\}$$\nThis construction generates a sequence of distributions, the derived flag, $D^1 \\subseteq D^2 \\subseteq \\dots \\subseteq TM$. Since each $D_p^j$ is a subspace of the finite-dimensional tangent space $T_pM$, the sequence of their dimensions, $\\dim(D_p^j)$, must eventually stabilize. That is, there exists a smallest integer $m$ such that $D^m = D^{m+1}$. The growth vector of the distribution $D$ at the point $p$ is the finite sequence of these dimensions up to stabilization:\n$$ (\\dim(D_p^1), \\dim(D_p^2), \\dots, \\dim(D_p^m)) $$\nFrobenius's integrability theorem states that a distribution $D$ is integrable if and only if it is involutive, which means that for any two vector fields $X, Y \\in \\Gamma(D)$, their Lie bracket $[X, Y]$ is also in $\\Gamma(D)$. This is equivalent to the condition $D^2 = D^1$, which in terms of the growth vector means the sequence stabilizes immediately.\n\nNow, we compute the growth vector for the given distribution on $M=\\mathbb{R}^{3}$ with coordinates $(x,y,z)$. The distribution is $D = \\operatorname{span}\\{X_1, X_2\\}$, where $X_1 = \\partial_x + y\\,\\partial_z$ and $X_2 = \\partial_y$.\n\nThe first element of the growth vector is $\\dim(D_p^1)$. We have $D^1 = D$. The spanning vector fields are $X_1$ and $X_2$. In the basis $\\{\\partial_x, \\partial_y, \\partial_z\\}$, they can be represented as vectors $(1,0,y)$ and $(0,1,0)$, respectively. These two vectors are linearly independent for all points $p=(x,y,z) \\in \\mathbb{R}^3$. Thus, the rank of the distribution is $2$ everywhere.\n$$ \\dim(D_p^1) = 2 \\quad \\forall p \\in \\mathbb{R}^3 $$\n\nNext, we determine $D^2$. $D^2$ is spanned by the vector fields in $D^1$ and their Lie brackets. We only need to compute the Lie bracket of the spanning vector fields, $[X_1, X_2]$. Let $f$ be an arbitrary smooth function on $\\mathbb{R}^3$.\n$$ [X_1, X_2](f) = X_1(X_2(f)) - X_2(X_1(f)) $$\nWe compute each term:\n$X_2(f) = \\partial_y f$\n$X_1(X_2(f)) = (\\partial_x + y\\,\\partial_z)(\\partial_y f) = \\frac{\\partial^2 f}{\\partial x \\partial y} + y \\frac{\\partial^2 f}{\\partial z \\partial y}$\n$X_1(f) = (\\partial_x + y\\,\\partial_z)f = \\frac{\\partial f}{\\partial x} + y \\frac{\\partial f}{\\partial z}$\n$X_2(X_1(f)) = \\partial_y \\left( \\frac{\\partial f}{\\partial x} + y \\frac{\\partial f}{\\partial z} \\right) = \\frac{\\partial^2 f}{\\partial y \\partial x} + \\frac{\\partial y}{\\partial y}\\frac{\\partial f}{\\partial z} + y \\frac{\\partial^2 f}{\\partial y \\partial z} = \\frac{\\partial^2 f}{\\partial x \\partial y} + \\frac{\\partial f}{\\partial z} + y \\frac{\\partial^2 f}{\\partial z \\partial y}$\nHere we have used the equality of mixed partial derivatives.\nSubtracting the two results:\n$$ [X_1, X_2](f) = \\left(\\frac{\\partial^2 f}{\\partial x \\partial y} + y \\frac{\\partial^2 f}{\\partial z \\partial y}\\right) - \\left(\\frac{\\partial^2 f}{\\partial x \\partial y} + \\frac{\\partial f}{\\partial z} + y \\frac{\\partial^2 f}{\\partial z \\partial y}\\right) = -\\frac{\\partial f}{\\partial z} $$\nThis shows that the Lie bracket vector field is $[X_1, X_2] = -\\partial_z$.\n\nThe distribution $D^2$ is spanned by $\\{X_1, X_2, [X_1, X_2]\\}$. At any point $p=(x,y,z)$, the fiber $D_p^2$ is spanned by the vectors:\n$X_1(p) \\equiv (1, 0, y)$\n$X_2(p) \\equiv (0, 1, 0)$\n$[X_1, X_2](p) \\equiv (0, 0, -1)$\nTo find the dimension of $D_p^2$, we check the linear independence of these three vectors. We can form a matrix with these vectors as rows and compute its determinant:\n$$ \\det \\begin{pmatrix} 1  0  y \\\\ 0  1  0 \\\\ 0  0  -1 \\end{pmatrix} = (1)(1)(-1) - 0 = -1 $$\nSince the determinant is non-zero for all $(x,y,z)$, the three vectors are linearly independent at every point $p \\in \\mathbb{R}^3$.\nTherefore, the dimension of $D_p^2$ is $3$.\n$$ \\dim(D_p^2) = 3 \\quad \\forall p \\in \\mathbb{R}^3 $$\nThe dimension of the ambient tangent space $T_p\\mathbb{R}^3$ is $3$. Since $D_p^2$ is a $3$-dimensional subspace of $T_p\\mathbb{R}^3$, it must be that $D_p^2 = T_p\\mathbb{R}^3$.\n\nFinally, we consider $D^3$. By definition, $D^2 \\subseteq D^3$. Since $D^2$ is already the entire tangent bundle $TM$, we must have $D^3 = TM$. This implies that $\\dim(D_p^3) = 3$ for all $p$.\nThe sequence of dimensions is therefore $(2, 3, 3, \\dots)$. The sequence stabilizes at the second term, since $\\dim(D^2) = \\dim(D^3) = 3$. The growth vector is the sequence of dimensions until stabilization, which is $(2, 3)$. The distribution is not integrable because the dimension grew, i.e., $D^1 \\neq D^2$.\n\nThe growth vector at any point $p \\in \\mathbb{R}^3$ is $(2, 3)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  3\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The Lie bracket possesses a deep geometric interpretation related to the flows of vector fields, an idea best explored through computation. This final practice provides a numerical lens on the Frobenius theorem, connecting the algebraic condition of involutivity to the geometric behavior of path-following . By simulating flows around an infinitesimal rectangular loop, we can visualize how a non-zero Lie bracket leads to a \"holonomy effect\" where the loop fails to close, making the abstract concept of non-integrability tangible.",
            "id": "3740187",
            "problem": "Consider a smooth two-dimensional distribution on $\\mathbb{R}^3$ given by the span of two smooth vector fields $X$ and $Y$. The distribution is defined in Cartesian coordinates $(x,y,z)$ by\n$$\nX(x,y,z) = \\left(1,\\,0,\\,a(x,y)\\right),\\qquad\nY(x,y,z) = \\left(0,\\,1,\\,b(x,y)\\right),\n$$\nwhere\n$$\na(x,y) = \\tfrac{1}{2}\\,y^2 + c\\,x\\,y,\\qquad\nb(x,y) = \\tfrac{1}{2}\\,x^2 + c\\,x\\,y,\n$$\nand $c \\in \\mathbb{R}$ is a constant parameter. The Lie bracket $[X,Y]$ is defined by $[X,Y] = X\\cdot \\nabla Y - Y\\cdot \\nabla X$ componentwise. A distribution is said to be involutive if $[X,Y]$ lies in the span of $X$ and $Y$ at every point, and by Frobenius's theorem, an involutive distribution is integrable into a foliation by immersed submanifolds (integral leaves).\n\nFundamental base for the problem:\n- The Lie bracket of vector fields $X$ and $Y$ on $\\mathbb{R}^n$ is the vector field $[X,Y]$ whose $i$th component is $X(Y_i) - Y(X_i)$, where $X_i$ and $Y_i$ are the component functions of $X$ and $Y$.\n- Integral leaves are obtained by integrating flows of tangent vector fields; a point $p$ evolved by the flow of $X$ for time $t$ solves the ordinary differential equation $\\dot{\\gamma}(s) = X(\\gamma(s))$ with $\\gamma(0) = p$ for $s \\in [0,t]$, and similarly for $Y$.\n- Frobenius's theorem states that a smooth distribution is integrable if and only if it is involutive (closed under Lie bracket).\n\nTasks:\n1. For each test case below, compute the following two quantities at the specified initial point $p_0$ and step size $h$:\n   - The least-squares residual norm $r$ of expressing $[X,Y](p_0)$ as a linear combination of $X(p_0)$ and $Y(p_0)$, i.e., the Euclidean norm of the component of $[X,Y](p_0)$ orthogonal to the span of $\\{X(p_0), Y(p_0)\\}$ under the standard inner product on $\\mathbb{R}^3$.\n   - The loop-closure error $E$ obtained by composing flows around a small rectangle: starting at $p_0$, flow along $X$ for time $h$, then along $Y$ for time $h$, then along $X$ for time $-h$, then along $Y$ for time $-h$, and define $E$ as the Euclidean norm of the resulting displacement from $p_0$. This numerically probes the commutator effect consistent with the Baker–Campbell–Hausdorff intuition.\n\n2. Numerically approximate integral leaves locally near $p_0$ by computing the grid of points obtained by alternating short flows of $X$ and $Y$, but do not output these points; use them internally if needed to ensure the numerical procedure is coherent. Your program should robustly integrate the flows using ordinary differential equation solvers with appropriate tolerances to control local error.\n\n3. Discuss, through the computed quantities $r$ and $E$, the consistency with the Frobenius involutivity condition:\n   - If $[X,Y](p_0)$ lies in $\\mathrm{span}\\{X(p_0),Y(p_0)\\}$, then $r$ should be zero (up to numerical precision).\n   - For small $h$, $E$ should scale like $\\mathcal{O}(h^2)$ with proportionality related to the magnitude of $[X,Y](p_0)$; in particular, if $[X,Y](p_0)=0$, the loop should close to second order and $E$ should be near machine precision.\n\nTest suite:\n- Case A (integrable distribution by parameter choice): $c = 1.0$, $p_0 = (0.2,\\,0.7,\\,0.0)$, $h = 10^{-2}$.\n- Case B (nonintegrable at $p_0$): $c = 0.0$, $p_0 = (0.2,\\,0.7,\\,0.0)$, $h = 10^{-2}$.\n- Case C (nearly integrable distribution): $c = 0.9$, $p_0 = (0.2,\\,0.7,\\,0.0)$, $h = 10^{-2}$.\n- Case D (nonintegrable parameter but bracket vanishes at $p_0$): $c = 0.0$, $p_0 = (0.5,\\,0.5,\\,0.0)$, $h = 10^{-2}$.\n\nAnswer specification:\n- For each case, output a list containing two floating-point numbers $[r, E]$ in that order.\n- Aggregate the results for all cases into a single list of lists in the order A, B, C, D.\n- Your program should produce a single line of output containing the aggregated results as a comma-separated list enclosed in square brackets, where each element is the inner list of two floats. For example, an output with two cases would look like $[[r_1,E_1],[r_2,E_2]]$.\n\nAngles are not used in this problem, and there are no physical units to report.",
            "solution": "We begin from the fundamental definitions of distributions, Lie brackets, and flows. A smooth distribution of dimension $2$ on $\\mathbb{R}^3$ is given by the pointwise span of two smooth vector fields $X$ and $Y$. Frobenius's theorem asserts that such a distribution is integrable if and only if it is involutive, i.e., for all points $p$, the Lie bracket $[X,Y](p)$ lies in the span $\\mathrm{span}\\{X(p),Y(p)\\}$.\n\nGiven the specific $X$ and $Y$,\n$$\nX(x,y,z) = \\left(1,\\,0,\\,a(x,y)\\right),\\quad a(x,y) = \\tfrac{1}{2}y^2 + cxy,\n$$\n$$\nY(x,y,z) = \\left(0,\\,1,\\,b(x,y)\\right),\\quad b(x,y) = \\tfrac{1}{2}x^2 + cxy,\n$$\nwe compute the Lie bracket $[X,Y]$ using the componentwise formula $[X,Y]_i = X(Y_i) - Y(X_i)$. The $x$ and $y$ components of $X$ and $Y$ are constant ($1$ or $0$), so their derivatives vanish under $X$ and $Y$. The only nontrivial component is the $z$-component:\n$$\n[X,Y]_z = X(b) - Y(a).\n$$\nWriting $X = X_x \\partial_x + X_y \\partial_y + X_z \\partial_z$ with $X_x = 1$, $X_y = 0$, $X_z = a$, and $Y = Y_x \\partial_x + Y_y \\partial_y + Y_z \\partial_z$ with $Y_x = 0$, $Y_y = 1$, $Y_z = b$, we have\n$$\nX(b) = \\frac{\\partial b}{\\partial x} X_x + \\frac{\\partial b}{\\partial y} X_y + \\frac{\\partial b}{\\partial z} X_z\n= \\frac{\\partial b}{\\partial x} + a \\frac{\\partial b}{\\partial z},\n$$\n$$\nY(a) = \\frac{\\partial a}{\\partial x} Y_x + \\frac{\\partial a}{\\partial y} Y_y + \\frac{\\partial a}{\\partial z} Y_z\n= \\frac{\\partial a}{\\partial y} + b \\frac{\\partial a}{\\partial z}.\n$$\nIn our case $a$ and $b$ depend only on $x$ and $y$, so $\\frac{\\partial a}{\\partial z} = 0$ and $\\frac{\\partial b}{\\partial z} = 0$, and therefore\n$$\n[X,Y](x,y,z) = \\left(0,\\,0,\\,\\frac{\\partial b}{\\partial x} - \\frac{\\partial a}{\\partial y}\\right).\n$$\nCompute the partial derivatives:\n$$\n\\frac{\\partial a}{\\partial y} = y + cx,\\qquad \\frac{\\partial b}{\\partial x} = x + cy,\n$$\nhence\n$$\n[X,Y](x,y,z) = \\left(0,\\,0,\\,(x + cy) - (y + cx)\\right) = \\left(0,\\,0,\\,(1-c)(x - y)\\right).\n$$\nThis expression shows that for $c = 1$, $[X,Y] \\equiv 0$, so the distribution is involutive and thus integrable. For $c \\neq 1$, the bracket generally does not vanish; however, on the line $x = y$, the bracket also vanishes, illustrating a pointwise involutivity at those points even when the parameter choice is nonintegrable elsewhere.\n\nTo numerically assess integrability via Frobenius's condition and to illustrate integral leaves, we perform two computations per test case:\n\n1. Membership residual of $[X,Y](p_0)$ in $\\mathrm{span}\\{X(p_0),Y(p_0)\\}$:\n   We form the $3 \\times 2$ matrix $B = [X(p_0)\\; Y(p_0)]$ whose columns are the vectors $X(p_0)$ and $Y(p_0)$, and the vector $v = [X,Y](p_0)$. The orthogonal projection of $v$ onto $\\mathrm{span}\\{X(p_0),Y(p_0)\\}$ under the Euclidean inner product is $v_{\\mathrm{proj}} = B \\hat{\\beta}$ where $\\hat{\\beta}$ solves the least-squares problem $\\min_{\\beta \\in \\mathbb{R}^2} \\|B\\beta - v\\|_2$. This can be obtained by the Moore–Penrose pseudoinverse or numerically via a linear least-squares solver. The residual norm is\n   $$\n   r = \\|v - v_{\\mathrm{proj}}\\|_2.\n   $$\n   If $v$ lies in the span, then $r = 0$ (up to numerical tolerance). Otherwise, $r  0$; in our construction, when $c \\neq 1$ and $x \\neq y$, the bracket points in the pure $z$ direction and cannot be represented by any linear combination of $X(p_0)$ and $Y(p_0)$ since any nontrivial combination has nonzero $x$ or $y$ components, so $r$ will equal the magnitude of the $z$-component of the bracket up to the contribution of the $z$-components of $X$ and $Y$ in the least-squares fit, which selects the zero coefficients to avoid $x$ and $y$ mismatches, making $r$ essentially the norm of $v$.\n\n2. Loop-closure error around a small rectangle:\n   The flows of $X$ and $Y$ are defined by solving $\\dot{\\gamma}(s) = X(\\gamma(s))$ and $\\dot{\\gamma}(s) = Y(\\gamma(s))$ respectively. Starting at $p_0$, we compute the composed flow\n   $$\n   p_1 = \\Phi_X^h(p_0),\\quad p_2 = \\Phi_Y^h(p_1),\\quad p_3 = \\Phi_X^{-h}(p_2),\\quad p_4 = \\Phi_Y^{-h}(p_3),\n   $$\n   where $\\Phi_X^t$ denotes the time-$t$ flow of $X$, and similarly for $Y$. The loop-closure error is\n   $$\n   E = \\|p_4 - p_0\\|_2.\n   $$\n   For small $h$, the composition error encodes the commutator $[X,Y](p_0)$ and scales like $\\mathcal{O}(h^2)$ with a coefficient related to the magnitude of $[X,Y](p_0)$; the Baker–Campbell–Hausdorff series motivates that when $[X,Y](p_0) = 0$, the loop closes to second order and $E$ is very small (near machine precision in numerical solvers). When $[X,Y](p_0)$ is nonzero, $E$ grows quadratically with $h$ and is proportional to the bracket magnitude for sufficiently small $h$.\n\nNumerical method:\n- We use an ordinary differential equation solver for each short flow segment, with tight tolerances to limit integration error. The vector fields are smooth polynomials, making the numerical integration stable and accurate for the chosen small step sizes.\n- The least-squares residual is computed via a robust linear algebra routine that returns the orthogonal projection and residual norm.\n\nTest suite interpretation:\n- Case A with $c = 1.0$ has $[X,Y] \\equiv 0$, so we expect $r \\approx 0$ and $E$ near numerical precision.\n- Case B with $c = 0.0$ yields $[X,Y](p_0) = (0,0,x-y) = (0,0,-0.5)$ at $p_0 = (0.2,0.7,0.0)$, so we expect $r$ approximately $0.5$ and a nonzero $E$ scaling like $h^2$ times a factor consistent with the bracket magnitude.\n- Case C with $c = 0.9$ yields $[X,Y](p_0) = (0,0,(1-0.9)(x-y)) = (0,0,-0.05)$, so we expect $r$ small and $E$ correspondingly smaller than in Case B by roughly a factor of $10$.\n- Case D with $c = 0.0$ but $p_0$ on the line $x=y$ gives $[X,Y](p_0) = 0$, so we expect $r \\approx 0$ and $E$ near numerical precision, despite the parameter choice being nonintegrable elsewhere; this tests a boundary condition where the bracket vanishes pointwise.\n\nThe final program carries out these computations and outputs, for each case, the pair $[r,E]$ as floating-point numbers. The aggregated output is a single list of these pairs in the specified order.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef a_func(x, y, c):\n    # a(x,y) = 0.5*y^2 + c*x*y\n    return 0.5 * y * y + c * x * y\n\ndef b_func(x, y, c):\n    # b(x,y) = 0.5*x^2 + c*x*y\n    return 0.5 * x * x + c * x * y\n\ndef X_vec(p, c):\n    x, y, z = p\n    return np.array([1.0, 0.0, a_func(x, y, c)], dtype=float)\n\ndef Y_vec(p, c):\n    x, y, z = p\n    return np.array([0.0, 1.0, b_func(x, y, c)], dtype=float)\n\ndef bracket_vec(p, c):\n    # [X,Y]_z = d b / d x - d a / d y, since a,b are independent of z.\n    x, y, z = p\n    da_dy = y + c * x\n    db_dx = x + c * y\n    bz = db_dx - da_dy\n    return np.array([0.0, 0.0, bz], dtype=float)\n\ndef proj_residual_norm(p, c):\n    # Compute the least-squares residual of expressing bracket in span{X(p), Y(p)}\n    B = np.column_stack((X_vec(p, c), Y_vec(p, c)))  # 3x2 matrix\n    v = bracket_vec(p, c)\n    # Solve least squares B beta ~ v\n    beta, residuals, rank, s = np.linalg.lstsq(B, v, rcond=None)\n    v_proj = B @ beta\n    r = np.linalg.norm(v - v_proj)\n    return r\n\ndef flow_field(field_fn, p0, t, c):\n    # Integrate dp/ds = field_fn(p(s), c) from s=0 to s=t\n    def odefun(s, y):\n        return field_fn(y, c)\n    # Ensure we get the endpoint at t\n    # Use tight tolerances for accuracy\n    sol = solve_ivp(odefun, (0.0, t), p0, method='RK45', rtol=1e-9, atol=1e-12, t_eval=[t])\n    return sol.y[:, -1]\n\ndef loop_closure_error(p0, h, c):\n    # Compose flows: X(h) - Y(h) - X(-h) - Y(-h)\n    p1 = flow_field(X_vec, p0, h, c)\n    p2 = flow_field(Y_vec, p1, h, c)\n    p3 = flow_field(X_vec, p2, -h, c)\n    p4 = flow_field(Y_vec, p3, -h, c)\n    return float(np.linalg.norm(p4 - p0))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c, (x0,y0,z0), h)\n    test_cases = [\n        (1.0, (0.2, 0.7, 0.0), 1e-2),  # Case A: integrable parameter\n        (0.0, (0.2, 0.7, 0.0), 1e-2),  # Case B: nonintegrable at p0\n        (0.9, (0.2, 0.7, 0.0), 1e-2),  # Case C: nearly integrable\n        (0.0, (0.5, 0.5, 0.0), 1e-2),  # Case D: bracket vanishes at p0\n    ]\n\n    results = []\n    for c, p0_tuple, h in test_cases:\n        p0 = np.array(p0_tuple, dtype=float)\n        r = proj_residual_norm(p0, c)\n        E = loop_closure_error(p0, h, c)\n        results.append([float(r), float(E)])\n\n    # Final print statement in the exact required format.\n    # A single line: list of lists [[r1,E1],[r2,E2],...]\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}