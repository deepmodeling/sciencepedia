{
    "hands_on_practices": [
        {
            "introduction": "Before relying on the standard coordinate formula for the Poisson bracket, it is crucial to understand its origin in the underlying symplectic geometry. This exercise takes you back to first principles, requiring you to compute a Poisson bracket directly from the definition of Hamiltonian vector fields and the symplectic two-form $\\omega$. This foundational practice  solidifies the connection between functions on phase space and the vector fields that generate flows, providing a direct interpretation of the bracket's value.",
            "id": "3761098",
            "problem": "Consider the cotangent bundle $T^{*}\\mathbb{R}^{2}$ with canonical coordinates $(q_{1},q_{2},p_{1},p_{2})$ and canonical symplectic form $\\omega = dq_{1} \\wedge dp_{1} + dq_{2} \\wedge dp_{2}$. For any smooth function $h(q,p)$ on phase space, the associated Hamiltonian vector field (HVF) $X_{h}$ is defined implicitly by the interior product condition $\\iota_{X_{h}} \\omega = dh$. The Poisson bracket of two smooth functions $f$ and $g$ is defined intrinsically by $\\{f,g\\} = \\omega(X_{f},X_{g})$, equivalently by pairing one function’s differential with the other’s Hamiltonian vector field.\n\nLet $f(q,p) = q_{1}^{2} p_{2}$ and $g(q,p) = q_{2} p_{1}^{3}$. Using only the canonical symplectic structure described above and the definitions of Hamiltonian vector fields and Poisson brackets, compute the Poisson bracket $\\{f,g\\}$ in these canonical coordinates and simplify your result to a single analytic expression. Then, interpret the sign and nonvanishing structure of $\\{f,g\\}$ in terms of whether $f$ and $g$ are in involution and the infinitesimal change of one observable along the Hamiltonian flow generated by the other. Your final answer must be the simplified analytic expression for $\\{f,g\\}$ with no units attached.",
            "solution": "The problem is valid as it is a well-posed, self-contained, and scientifically grounded exercise in Hamiltonian mechanics. We are tasked with computing the Poisson bracket $\\{f,g\\}$ for the functions $f(q,p) = q_{1}^{2} p_{2}$ and $g(q,p) = q_{2} p_{1}^{3}$ on the phase space $T^{*}\\mathbb{R}^{2}$ with canonical coordinates $(q_{1}, q_{2}, p_{1}, p_{2})$ and the canonical symplectic form $\\omega = dq_{1} \\wedge dp_{1} + dq_{2} \\wedge dp_{2}$. The calculation must proceed from the fundamental definitions provided: the Hamiltonian vector field (HVF) $X_{h}$ is defined by $\\iota_{X_{h}} \\omega = dh$, and the Poisson bracket is defined by $\\{f,g\\} = \\omega(X_{f}, X_{g})$.\n\nFirst, we determine the general form of a Hamiltonian vector field $X_{h}$ in the given canonical coordinates. Let $X_{h}$ be expressed in the coordinate basis as:\n$$X_{h} = A_{1} \\frac{\\partial}{\\partial q_{1}} + A_{2} \\frac{\\partial}{\\partial q_{2}} + B_{1} \\frac{\\partial}{\\partial p_{1}} + B_{2} \\frac{\\partial}{\\partial p_{2}}$$\nwhere the components $A_{i}$ and $B_{i}$ are functions on the phase space. The interior product of $X_{h}$ with the symplectic form $\\omega$ is:\n$$\\iota_{X_{h}} \\omega = \\iota_{X_{h}} (dq_{1} \\wedge dp_{1} + dq_{2} \\wedge dp_{2})$$\nUsing the linearity of the interior product and the identity $\\iota_{V}(\\alpha \\wedge \\beta) = (\\iota_{V}\\alpha)\\beta - (\\iota_{V}\\beta)\\alpha$, we compute the action on each term:\n\\begin{align*} \\iota_{X_{h}} (dq_{1} \\wedge dp_{1}) &= \\iota_{A_{1} \\frac{\\partial}{\\partial q_{1}}} (dq_{1} \\wedge dp_{1}) + \\iota_{B_{1} \\frac{\\partial}{\\partial p_{1}}} (dq_{1} \\wedge dp_{1}) \\\\ &= A_{1} (\\iota_{\\frac{\\partial}{\\partial q_{1}}} dq_{1}) dp_{1} - A_{1} (\\iota_{\\frac{\\partial}{\\partial q_{1}}} dp_{1}) dq_{1} + B_{1} (\\iota_{\\frac{\\partial}{\\partial p_{1}}} dq_{1}) dp_{1} - B_{1} (\\iota_{\\frac{\\partial}{\\partial p_{1}}} dp_{1}) dq_{1} \\\\ &= A_{1}(1) dp_{1} - A_{1}(0) dq_{1} + B_{1}(0) dp_{1} - B_{1}(1) dq_{1} \\\\ &= A_{1} dp_{1} - B_{1} dq_{1}\\end{align*}\nSimilarly, for the second term:\n$$\\iota_{X_{h}} (dq_{2} \\wedge dp_{2}) = A_{2} dp_{2} - B_{2} dq_{2}$$\nCombining these results, we have:\n$$\\iota_{X_{h}} \\omega = -B_{1} dq_{1} - B_{2} dq_{2} + A_{1} dp_{1} + A_{2} dp_{2}$$\nThe exterior derivative of a function $h$ is given by:\n$$dh = \\frac{\\partial h}{\\partial q_{1}} dq_{1} + \\frac{\\partial h}{\\partial q_{2}} dq_{2} + \\frac{\\partial h}{\\partial p_{1}} dp_{1} + \\frac{\\partial h}{\\partial p_{2}} dp_{2}$$\nBy the defining relation $\\iota_{X_{h}} \\omega = dh$, we equate the coefficients of the basis 1-forms $dq_{i}$ and $dp_{i}$:\n$$A_{1} = \\frac{\\partial h}{\\partial p_{1}}, \\quad A_{2} = \\frac{\\partial h}{\\partial p_{2}}, \\quad -B_{1} = \\frac{\\partial h}{\\partial q_{1}}, \\quad -B_{2} = \\frac{\\partial h}{\\partial q_{2}}$$\nThis yields the expression for the HVF in canonical coordinates:\n$$X_{h} = \\frac{\\partial h}{\\partial p_{1}} \\frac{\\partial}{\\partial q_{1}} + \\frac{\\partial h}{\\partial p_{2}} \\frac{\\partial}{\\partial q_{2}} - \\frac{\\partial h}{\\partial q_{1}} \\frac{\\partial}{\\partial p_{1}} - \\frac{\\partial h}{\\partial q_{2}} \\frac{\\partial}{\\partial p_{2}}$$\nNext, we apply this formula to our specific functions $f$ and $g$.\nFor $f = q_{1}^{2} p_{2}$, the partial derivatives are:\n$\\frac{\\partial f}{\\partial q_{1}} = 2q_{1}p_{2}$, $\\frac{\\partial f}{\\partial q_{2}} = 0$, $\\frac{\\partial f}{\\partial p_{1}} = 0$, $\\frac{\\partial f}{\\partial p_{2}} = q_{1}^{2}$.\nThe corresponding HVF $X_{f}$ is:\n$$X_{f} = (0) \\frac{\\partial}{\\partial q_{1}} + (q_{1}^{2}) \\frac{\\partial}{\\partial q_{2}} - (2q_{1}p_{2}) \\frac{\\partial}{\\partial p_{1}} - (0) \\frac{\\partial}{\\partial p_{2}} = q_{1}^{2} \\frac{\\partial}{\\partial q_{2}} - 2q_{1}p_{2} \\frac{\\partial}{\\partial p_{1}}$$\nFor $g = q_{2} p_{1}^{3}$, the partial derivatives are:\n$\\frac{\\partial g}{\\partial q_{1}} = 0$, $\\frac{\\partial g}{\\partial q_{2}} = p_{1}^{3}$, $\\frac{\\partial g}{\\partial p_{1}} = 3q_{2}p_{1}^{2}$, $\\frac{\\partial g}{\\partial p_{2}} = 0$.\nThe corresponding HVF $X_{g}$ is:\n$$X_{g} = (3q_{2}p_{1}^{2}) \\frac{\\partial}{\\partial q_{1}} + (0) \\frac{\\partial}{\\partial q_{2}} - (0) \\frac{\\partial}{\\partial p_{1}} - (p_{1}^{3}) \\frac{\\partial}{\\partial p_{2}} = 3q_{2}p_{1}^{2} \\frac{\\partial}{\\partial q_{1}} - p_{1}^{3} \\frac{\\partial}{\\partial p_{2}}$$\nNow, we compute the Poisson bracket $\\{f,g\\}$ using its definition in terms of the symplectic form and the Hamiltonian vector fields:\n$$\\{f,g\\} = \\omega(X_{f}, X_{g}) = (dq_{1} \\wedge dp_{1} + dq_{2} \\wedge dp_{2})(X_{f}, X_{g})$$\nWe use the property $(\\alpha \\wedge \\beta)(V, W) = \\alpha(V)\\beta(W) - \\alpha(W)\\beta(V)$.\nFor the first term:\n\\begin{align*} (dq_{1} \\wedge dp_{1})(X_{f}, X_{g}) &= dq_{1}(X_{f})dp_{1}(X_{g}) - dq_{1}(X_{g})dp_{1}(X_{f}) \\\\ &= (0)(0) - (3q_{2}p_{1}^{2})(-2q_{1}p_{2}) \\\\ &= 6q_{1}q_{2}p_{1}^{2}p_{2} \\end{align*}\nFor the second term:\n\\begin{align*} (dq_{2} \\wedge dp_{2})(X_{f}, X_{g}) &= dq_{2}(X_{f})dp_{2}(X_{g}) - dq_{2}(X_{g})dp_{2}(X_{f}) \\\\ &= (q_{1}^{2})(-p_{1}^{3}) - (0)(0) \\\\ &= -q_{1}^{2}p_{1}^{3} \\end{align*}\nSumming these two results gives the Poisson bracket:\n$$\\{f,g\\} = 6q_{1}q_{2}p_{1}^{2}p_{2} - q_{1}^{2}p_{1}^{3}$$\nThis is the required simplified analytic expression.\n\nFinally, we interpret this result.\nFirst, two observables are in involution if their Poisson bracket is identically zero. Since $\\{f,g\\} = 6q_{1}q_{2}p_{1}^{2}p_{2} - q_{1}^{2}p_{1}^{3}$ is not identically zero on the phase space, the functions $f$ and $g$ are not in involution. This implies that if one of them is taken as the Hamiltonian of a system, the other is not a conserved quantity (an integral of motion) along the resulting flow, as its value will change over time.\n\nSecond, the Poisson bracket $\\{f,g\\}$ quantifies the infinitesimal change of one observable along the Hamiltonian flow generated by the other. Specifically, $\\{f,g\\} = L_{X_g} f = -L_{X_f} g$, where $L_X$ is the Lie derivative. Thus, $\\{f,g\\}$ is the rate of change of $f$ along the flow generated by $g$. The expression $\\{f,g\\} = q_{1}p_{1}^{2}(6q_{2}p_{2} - q_{1}p_{1})$ shows that the sign of this rate of change depends on the position in phase space. The rate of change is zero on the union of the submanifolds defined by $q_{1}=0$, $p_{1}=0$, and $6q_{2}p_{2} = q_{1}p_{1}$. Away from these submanifolds, the value of $f$ either increases or decreases along the trajectories of the Hamiltonian system defined by $g$. Similarly, the value of $g$ changes at a rate $\\{g,f\\} = -\\{f,g\\} = q_{1}^{2}p_{1}^{3} - 6q_{1}q_{2}p_{1}^{2}p_{2}$ along the flow generated by $f$.",
            "answer": "$$\n\\boxed{6q_{1}q_{2}p_{1}^{2}p_{2} - q_{1}^{2}p_{1}^{3}}\n$$"
        },
        {
            "introduction": "Canonical transformations are a cornerstone of advanced Hamiltonian mechanics, allowing us to simplify problems by choosing more convenient coordinate systems. This exercise provides hands-on practice with the machinery of generating functions, a powerful method for constructing such transformations . By deriving a new set of canonical coordinates and then explicitly verifying that the transformation is symplectic, you will gain a concrete understanding of what it means to preserve the fundamental structure of phase space.",
            "id": "3761108",
            "problem": "Consider a canonical transformation generated by a type-2 generating function $F_{2}(q,P)$ on a symplectic phase space with coordinates $(q,p)\\in\\mathbb{R}^{n}\\times\\mathbb{R}^{n}$, where $q=(q_{1},\\dots,q_{n})$ and $p=(p_{1},\\dots,p_{n})$. Let the generating function be\n$$\nF_{2}(q,P)=\\sum_{i=1}^{n}\\frac{1}{2}q_{i}^{2}P_{i}.\n$$\nUsing only the defining relations of type-2 generating functions, derive the explicit transformation $(Q,P)$ induced by $F_{2}$ in terms of $(q,p)$ on the open subset where $q_{i}\\neq 0$ for all $i$. Then compute the Jacobian matrix $J=\\frac{\\partial(Q,P)}{\\partial(q,p)}$ of this transformation and verify its canonicity by showing that it preserves the standard symplectic form, i.e., $J^{T}\\Omega J=\\Omega$, where\n$$\n\\Omega=\\begin{pmatrix}\n0 & I_{n}\\\\\n-I_{n} & 0\n\\end{pmatrix}.\n$$\nFinally, compute the fundamental Poisson bracket $\\{Q_{i},P_{j}\\}$ for arbitrary indices $i,j\\in\\{1,\\dots,n\\}$ using the definition of the Poisson bracket in canonical coordinates. Provide this Poisson bracket as your final answer in closed form. No numerical rounding is required, and no physical units are involved.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of Hamiltonian mechanics, is well-posed, and is expressed in objective mathematical language. We will proceed with the solution.\n\nThe canonical transformation is generated by a type-$2$ generating function $F_{2}(q, P)$, which relates the old coordinates $(q, p)$ to the new coordinates $(Q, P)$ via the following defining relations for each component $i \\in \\{1, \\dots, n\\}$:\n$$\np_{i} = \\frac{\\partial F_{2}}{\\partial q_{i}}\n$$\n$$\nQ_{i} = \\frac{\\partial F_{2}}{\\partial P_{i}}\n$$\nThe given generating function is:\n$$\nF_{2}(q,P)=\\sum_{k=1}^{n}\\frac{1}{2}q_{k}^{2}P_{k}\n$$\n\nFirst, we derive the explicit form of the transformation. We compute the partial derivatives of $F_{2}$.\nThe relationship for the old momentum $p_i$ is:\n$$\np_{i} = \\frac{\\partial}{\\partial q_{i}}\\left(\\sum_{k=1}^{n}\\frac{1}{2}q_{k}^{2}P_{k}\\right) = \\frac{1}{2}\\frac{\\partial}{\\partial q_{i}}(q_{i}^{2}P_{i}) = \\frac{1}{2}(2q_{i})P_{i} = q_{i}P_{i}\n$$\nSince the problem states that we are on the open subset where $q_{i}\\neq 0$ for all $i$, we can solve for the new momentum $P_i$:\n$$\nP_{i} = \\frac{p_{i}}{q_{i}}\n$$\nThe relationship for the new coordinate $Q_i$ is:\n$$\nQ_{i} = \\frac{\\partial}{\\partial P_{i}}\\left(\\sum_{k=1}^{n}\\frac{1}{2}q_{k}^{2}P_{k}\\right) = \\frac{1}{2}\\frac{\\partial}{\\partial P_{i}}(q_{i}^{2}P_{i}) = \\frac{1}{2}q_{i}^{2}\n$$\nThus, the canonical transformation is given by:\n$$\nQ_{i} = \\frac{1}{2}q_{i}^{2} \\quad \\text{and} \\quad P_{i} = \\frac{p_{i}}{q_{i}}\n$$\n\nNext, we compute the Jacobian matrix $J = \\frac{\\partial(Q, P)}{\\partial(q, p)}$. This is a $2n \\times 2n$ block matrix:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial Q}{\\partial q} & \\frac{\\partial Q}{\\partial p} \\\\ \\frac{\\partial P}{\\partial q} & \\frac{\\partial P}{\\partial p} \\end{pmatrix}\n$$\nwhere each block is an $n \\times n$ matrix. Let the matrix elements be indexed by $i$ (row) and $j$ (column).\nThe elements of the top-left block $\\frac{\\partial Q}{\\partial q}$ are:\n$$\n\\left(\\frac{\\partial Q}{\\partial q}\\right)_{ij} = \\frac{\\partial Q_i}{\\partial q_j} = \\frac{\\partial}{\\partial q_j}\\left(\\frac{1}{2}q_{i}^{2}\\right) = q_i \\delta_{ij}\n$$\nThis block is a diagonal matrix, which we denote as $\\text{diag}(q_{1}, \\dots, q_{n})$.\nThe elements of the top-right block $\\frac{\\partial Q}{\\partial p}$ are:\n$$\n\\left(\\frac{\\partial Q}{\\partial p}\\right)_{ij} = \\frac{\\partial Q_i}{\\partial p_j} = \\frac{\\partial}{\\partial p_j}\\left(\\frac{1}{2}q_{i}^{2}\\right) = 0\n$$\nThis block is the $n \\times n$ zero matrix, $0_{n}$.\nThe elements of the bottom-left block $\\frac{\\partial P}{\\partial q}$ are:\n$$\n\\left(\\frac{\\partial P}{\\partial q}\\right)_{ij} = \\frac{\\partial P_i}{\\partial q_j} = \\frac{\\partial}{\\partial q_j}\\left(\\frac{p_i}{q_i}\\right) = p_i \\frac{\\partial}{\\partial q_j}\\left(\\frac{1}{q_i}\\right) = p_i \\left(-\\frac{1}{q_i^2}\\right)\\delta_{ij} = -\\frac{p_i}{q_i^2}\\delta_{ij}\n$$\nThis block is the diagonal matrix $\\text{diag}(-\\frac{p_1}{q_1^2}, \\dots, -\\frac{p_n}{q_n^2})$.\nThe elements of the bottom-right block $\\frac{\\partial P}{\\partial p}$ are:\n$$\n\\left(\\frac{\\partial P}{\\partial p}\\right)_{ij} = \\frac{\\partial P_i}{\\partial p_j} = \\frac{\\partial}{\\partial p_j}\\left(\\frac{p_i}{q_i}\\right) = \\frac{1}{q_i}\\delta_{ij}\n$$\nThis block is the diagonal matrix $\\text{diag}(\\frac{1}{q_1}, \\dots, \\frac{1}{q_n})$.\nCombining these blocks, the Jacobian matrix is:\n$$\nJ = \\begin{pmatrix} \\text{diag}(q_i) & 0_{n} \\\\ \\text{diag}(-p_i/q_i^2) & \\text{diag}(1/q_i) \\end{pmatrix}\n$$\n\nNow, we verify the canonicity of the transformation by showing that $J$ is a symplectic matrix, i.e., $J^{T}\\Omega J = \\Omega$. The standard symplectic form is given by $\\Omega = \\begin{pmatrix} 0_{n} & I_{n} \\\\ -I_{n} & 0_{n} \\end{pmatrix}$, where $I_n$ is the $n \\times n$ identity matrix.\nThe transpose of the Jacobian is:\n$$\nJ^{T} = \\begin{pmatrix} \\text{diag}(q_i)^{T} & \\text{diag}(-p_i/q_i^2)^{T} \\\\ 0_{n}^{T} & \\text{diag}(1/q_i)^{T} \\end{pmatrix} = \\begin{pmatrix} \\text{diag}(q_i) & \\text{diag}(-p_i/q_i^2) \\\\ 0_{n} & \\text{diag}(1/q_i) \\end{pmatrix}\n$$\nsince diagonal matrices are symmetric. We compute the product $J^{T}\\Omega J$:\n$$\nJ^{T}\\Omega J = \\begin{pmatrix} \\text{diag}(q_i) & \\text{diag}(-p_i/q_i^2) \\\\ 0_{n} & \\text{diag}(1/q_i) \\end{pmatrix} \\begin{pmatrix} 0_{n} & I_{n} \\\\ -I_{n} & 0_{n} \\end{pmatrix} \\begin{pmatrix} \\text{diag}(q_i) & 0_{n} \\\\ \\text{diag}(-p_i/q_i^2) & \\text{diag}(1/q_i) \\end{pmatrix}\n$$\nFirst, multiply $J^{T}$ by $\\Omega$:\n$$\nJ^{T}\\Omega = \\begin{pmatrix} \\text{diag}(-p_i/q_i^2)(-I_n) & \\text{diag}(q_i)I_n \\\\ \\text{diag}(1/q_i)(-I_n) & 0_n \\end{pmatrix} = \\begin{pmatrix} \\text{diag}(p_i/q_i^2) & \\text{diag}(q_i) \\\\ \\text{diag}(-1/q_i) & 0_{n} \\end{pmatrix}\n$$\nNow, multiply this result by $J$:\n$$\n(J^{T}\\Omega) J = \\begin{pmatrix} \\text{diag}(p_i/q_i^2) & \\text{diag}(q_i) \\\\ \\text{diag}(-1/q_i) & 0_{n} \\end{pmatrix} \\begin{pmatrix} \\text{diag}(q_i) & 0_{n} \\\\ \\text{diag}(-p_i/q_i^2) & \\text{diag}(1/q_i) \\end{pmatrix}\n$$\nWe compute the four blocks of the final product.\nTop-left block: $\\text{diag}(p_i/q_i^2)\\text{diag}(q_i) + \\text{diag}(q_i)\\text{diag}(-p_i/q_i^2) = \\text{diag}(p_i/q_i) - \\text{diag}(p_i/q_i) = 0_n$.\nTop-right block: $\\text{diag}(p_i/q_i^2) \\cdot 0_n + \\text{diag}(q_i)\\text{diag}(1/q_i) = \\text{diag}(q_i/q_i) = \\text{diag}(1) = I_n$.\nBottom-left block: $\\text{diag}(-1/q_i)\\text{diag}(q_i) + 0_n \\cdot \\text{diag}(-p_i/q_i^2) = -\\text{diag}(q_i/q_i) = -I_n$.\nBottom-right block: $\\text{diag}(-1/q_i) \\cdot 0_n + 0_n \\cdot \\text{diag}(1/q_i) = 0_n$.\nThus, we have:\n$$\nJ^{T}\\Omega J = \\begin{pmatrix} 0_{n} & I_{n} \\\\ -I_{n} & 0_{n} \\end{pmatrix} = \\Omega\n$$\nThis confirms the transformation is canonical.\n\nFinally, we compute the fundamental Poisson bracket $\\{Q_{i}, P_{j}\\}$ using its definition in the original canonical coordinates $(q, p)$:\n$$\n\\{f, g\\}_{q,p} = \\sum_{k=1}^{n} \\left(\\frac{\\partial f}{\\partial q_k}\\frac{\\partial g}{\\partial p_k} - \\frac{\\partial f}{\\partial p_k}\\frac{\\partial g}{\\partial q_k}\\right)\n$$\nLet $f = Q_i = \\frac{1}{2}q_i^2$ and $g = P_j = p_j/q_j$. We need the following partial derivatives:\n$$\n\\frac{\\partial Q_i}{\\partial q_k} = \\frac{\\partial}{\\partial q_k}\\left(\\frac{1}{2}q_i^2\\right) = q_i \\delta_{ik}\n$$\n$$\n\\frac{\\partial Q_i}{\\partial p_k} = \\frac{\\partial}{\\partial p_k}\\left(\\frac{1}{2}q_i^2\\right) = 0\n$$\n$$\n\\frac{\\partial P_j}{\\partial q_k} = \\frac{\\partial}{\\partial q_k}\\left(\\frac{p_j}{q_j}\\right) = -\\frac{p_j}{q_j^2}\\delta_{jk}\n$$\n$$\n\\frac{\\partial P_j}{\\partial p_k} = \\frac{\\partial}{\\partial p_k}\\left(\\frac{p_j}{q_j}\\right) = \\frac{1}{q_j}\\delta_{jk}\n$$\nSubstituting these into the Poisson bracket formula:\n$$\n\\{Q_i, P_j\\} = \\sum_{k=1}^{n} \\left( (q_i \\delta_{ik}) \\left(\\frac{1}{q_j}\\delta_{jk}\\right) - (0) \\left(-\\frac{p_j}{q_j^2}\\delta_{jk}\\right) \\right)\n$$\n$$\n\\{Q_i, P_j\\} = \\sum_{k=1}^{n} \\frac{q_i}{q_j} \\delta_{ik} \\delta_{jk}\n$$\nThe product of Kronecker deltas $\\delta_{ik}\\delta_{jk}$ is non-zero (and equal to $1$) only if $k=i$ and $k=j$. This implies that the term is non-zero only if $i=j$. Let's analyze the two cases for the indices $i$ and $j$.\nCase 1: $i \\neq j$.\nIn this case, for any value of $k$, it is impossible for $k$ to be equal to both $i$ and $j$ simultaneously. Thus, the product $\\delta_{ik}\\delta_{jk}$ is always $0$ for all $k \\in \\{1, \\dots, n\\}$. The sum is a sum of zeros, so $\\{Q_i, P_j\\} = 0$.\nCase 2: $i = j$.\nThe expression becomes:\n$$\n\\{Q_i, P_i\\} = \\sum_{k=1}^{n} \\frac{q_i}{q_i} \\delta_{ik} \\delta_{ik} = \\sum_{k=1}^{n} (1) \\cdot \\delta_{ik} = \\sum_{k=1}^{n} \\delta_{ik}\n$$\nThis sum over $k$ contains only one non-zero term, which occurs when $k=i$. The value of this term is $1$. Therefore, $\\{Q_i, P_i\\} = 1$.\nCombining both cases, we can write the result using the Kronecker delta:\n$$\n\\{Q_i, P_j\\} = \\delta_{ij}\n$$\nThis result is expected, as canonical transformations preserve the structure of the fundamental Poisson brackets.",
            "answer": "$$\n\\boxed{\\delta_{ij}}\n$$"
        },
        {
            "introduction": "In complex systems, exact integrals of motion are rare, but approximate ones, known as adiabatic invariants, are essential for understanding the dynamics. This practice moves beyond simple calculations to use the Poisson bracket as a powerful diagnostic tool in a model of molecular dynamics, combining analytical derivation with numerical simulation . By computing and monitoring the value of $\\{I_f, H\\}$, where $I_f$ is an adiabatic action, you will quantitatively explore the conditions under which a quantity is 'almost' conserved and witness the breakdown of this invariance near dynamical resonances.",
            "id": "3435753",
            "problem": "Consider a two-mode molecular Hamiltonian with one fast intramolecular mode and one slow collective mode in reduced, dimensionless units. The canonical coordinates are $(q_f,p_f)$ for the fast mode and $(q_s,p_s)$ for the slow mode. The Hamiltonian is\n$$\nH(q_f,p_f,q_s,p_s) \\;=\\; \\frac{p_f^2}{2} \\;+\\; \\frac{1}{2}\\,\\Omega(q_s)^2\\,q_f^2 \\;+\\; \\frac{p_s^2}{2} \\;+\\; \\frac{1}{2}\\,\\omega_s^2\\,q_s^2 \\;+\\; \\epsilon\\,q_f^2\\,q_s,\n$$\nwhere the fast-mode frequency depends on the slow coordinate via\n$$\n\\Omega(q_s) \\;=\\; \\sqrt{\\omega_{f0}^2 + \\gamma\\,q_s^2}.\n$$\nHere $\\omega_s>0$ is the slow-mode frequency, $\\omega_{f0}>0$ is the base fast-mode frequency, $\\gamma\\ge 0$ controls the parametric modulation of the fast frequency by the slow coordinate, and $\\epsilon$ is a small bilinear coupling constant. All quantities are dimensionless. Angles appearing below must be interpreted in radians.\n\nYour tasks:\n\n1) Starting from the definitions of Hamilton's equations and the Poisson bracket, and using the classical definition of the action variable for a one-dimensional integrable system, construct an adiabatic fast-mode action $I_f$ by idealizing the fast mode as a harmonic oscillator with slowly varying frequency $\\Omega(q_s)$. Derive an explicit expression for $I_f(q_f,p_f,q_s)$ in terms of $(q_f,p_f,q_s)$ and $\\Omega(q_s)$ alone, without time integrals.\n\n2) Using the canonical Poisson bracket\n$$\n\\{A,B\\} \\;=\\; \\frac{\\partial A}{\\partial q_f}\\frac{\\partial B}{\\partial p_f} - \\frac{\\partial A}{\\partial p_f}\\frac{\\partial B}{\\partial q_f} \\;+\\; \\frac{\\partial A}{\\partial q_s}\\frac{\\partial B}{\\partial p_s} - \\frac{\\partial A}{\\partial p_s}\\frac{\\partial B}{\\partial q_s},\n$$\ncompute the exact expression for $\\{I_f,H\\}$ for the Hamiltonian above, expressed only in terms of $(q_f,p_f,q_s,p_s)$, $\\Omega(q_s)$, its derivative with respect to $q_s$, and the parameters $(\\omega_s,\\omega_{f0},\\gamma,\\epsilon)$. Simplify as far as possible. Explain why $\\{I_f,H\\}\\approx 0$ when there is a clear separation of time scales and weak coupling.\n\n3) Quantify, by direct simulation of Hamilton’s equations, the breakdown of adiabatic invariance near resonances by monitoring the time-averaged magnitude of the Poisson bracket $\\{I_f,H\\}$ across a parameter sweep in the frequency ratio $r=\\omega_{f0}/\\omega_s$ and couplings $(\\gamma,\\epsilon)$. Use a separable splitting of $H$ into kinetic plus potential terms to implement a symplectic velocity-Verlet integrator. Initialize on a torus consistent with uncoupled harmonic energies $E_{f0}$ and $E_{s0}$:\n- Set $q_f(0)=A_f\\cos\\phi_f$ and $p_f(0)=-\\Omega(q_s(0))\\,A_f\\sin\\phi_f$, where $A_f=\\sqrt{2E_{f0}}/\\Omega(q_s(0))$.\n- Set $q_s(0)=A_s\\cos\\phi_s$ and $p_s(0)=-\\omega_s\\,A_s\\sin\\phi_s$, where $A_s=\\sqrt{2E_{s0}}/\\omega_s$.\nTake $\\phi_f=\\pi/4$ and $\\phi_s=\\pi/3$.\n\nSimulate for a total time\n$$\nT \\;=\\; N_{\\text{slow}}\\frac{2\\pi}{\\omega_s}, \\quad N_{\\text{slow}}=10,\n$$\nusing a time step\n$$\n\\Delta t \\;=\\; \\min\\!\\left(\\frac{0.02}{\\omega_{f0}},\\,0.01\\right).\n$$\nAt each step, evaluate the instantaneous Poisson bracket $\\{I_f,H\\}$ from your expression in part $2$ and accumulate the absolute value. Report the normalized time average\n$$\n\\mathcal{B} \\;=\\; \\frac{1}{T}\\int_0^T \\frac{\\left|\\{I_f,H\\}\\right|}{\\omega_{f0}\\,E_{f0}}\\,dt,\n$$\nas a dimensionless measure of adiabatic invariance breakdown.\n\nUse the following fixed values: $\\omega_s=1$, $E_{f0}=0.5$, $E_{s0}=0.5$.\n\nTest Suite:\nProvide $\\mathcal{B}$ for the parameter sets below, which probe baseline, adiabatic, parametric-only, progressively stronger coupling, and near-resonance behavior:\n- Case A: $r=10$, $\\epsilon=0$, $\\gamma=0$.\n- Case B: $r=10$, $\\epsilon=0.02$, $\\gamma=0.10$.\n- Case C: $r=5$, $\\epsilon=0.20$, $\\gamma=0.50$.\n- Case D: $r=3$, $\\epsilon=0$, $\\gamma=0.50$.\n- Case E: $r=2$, $\\epsilon=0.05$, $\\gamma=0.20$.\n- Case F: $r=1.5$, $\\epsilon=0.05$, $\\gamma=0.20$.\n\nIn each case set $\\omega_{f0}=r\\,\\omega_s$. Angles are in radians. All quantities are dimensionless.\n\nFinal Output Specification:\nYour program should produce a single line of output containing the six values of $\\mathcal{B}$, in the order of Cases A through F, as a comma-separated list enclosed in square brackets (for example, \"[0.000001,0.012345,0.067890,0.023456,0.078900,0.123456]\"). Each value must be rounded to six decimal places.",
            "solution": "The problem statement has been meticulously validated and found to be scientifically grounded, well-posed, and complete. It constitutes a standard problem in the field of nonlinear dynamics and classical mechanics, suitable for analysis and numerical simulation. We now proceed to the solution, which is organized into three parts as requested.\n\n### Part 1: Derivation of the Adiabatic Fast-Mode Action $I_f$\n\nThe adiabatic principle allows us to treat the fast mode as a separate one-dimensional system whose parameters vary slowly due to the motion of the slow mode. For a fixed value of the slow coordinate $q_s$, the fast-mode part of the Hamiltonian is that of a simple harmonic oscillator with frequency $\\Omega(q_s)$:\n$$\nH_f(q_f, p_f; q_s) = \\frac{p_f^2}{2} + \\frac{1}{2}\\Omega(q_s)^2 q_f^2\n$$\nThis quantity represents the instantaneous energy of the fast oscillator, which we denote by $E_f$. The action variable for a one-dimensional periodic system is defined as the area enclosed by its phase-space trajectory, divided by $2\\pi$.\n$$\nI_f = \\frac{1}{2\\pi} \\oint p_f \\, dq_f\n$$\nThe trajectory for the fast mode at a constant energy $E_f$ and fixed $q_s$ is an ellipse in the $(q_f, p_f)$ phase plane, described by the equation:\n$$\nE_f = \\frac{p_f^2}{2} + \\frac{1}{2}\\Omega(q_s)^2 q_f^2\n$$\nRearranging this into the standard form of an ellipse, $\\frac{x^2}{a^2} + \\frac{y^2}{b^2} = 1$:\n$$\n\\frac{q_f^2}{2E_f/\\Omega(q_s)^2} + \\frac{p_f^2}{2E_f} = 1\n$$\nThe semi-axes of the ellipse are $a = \\sqrt{2E_f}/\\Omega(q_s)$ and $b = \\sqrt{2E_f}$. The area of the ellipse is $\\mathcal{A} = \\pi a b$.\n$$\n\\mathcal{A} = \\pi \\left( \\frac{\\sqrt{2E_f}}{\\Omega(q_s)} \\right) \\left( \\sqrt{2E_f} \\right) = \\frac{2\\pi E_f}{\\Omega(q_s)}\n$$\nThe action $I_f$ is therefore:\n$$\nI_f = \\frac{\\mathcal{A}}{2\\pi} = \\frac{E_f}{\\Omega(q_s)}\n$$\nTo obtain an expression for $I_f$ in terms of the instantaneous phase-space coordinates $(q_f, p_f, q_s)$, we substitute the expression for the instantaneous fast-mode energy $E_f = H_f$:\n$$\nI_f(q_f, p_f, q_s) = \\frac{1}{\\Omega(q_s)} \\left( \\frac{p_f^2}{2} + \\frac{1}{2}\\Omega(q_s)^2 q_f^2 \\right) = \\frac{p_f^2}{2\\Omega(q_s)} + \\frac{1}{2}\\Omega(q_s)q_f^2\n$$\nThis is the required explicit expression for the adiabatic fast-mode action $I_f$.\n\n### Part 2: Poisson Bracket $\\{I_f, H\\}$ and Adiabatic Invariance\n\nThe time evolution of any observable $A$ without explicit time dependence is governed by Hamilton's equations in Poisson bracket form: $\\frac{dA}{dt} = \\{A, H\\}$. The adiabatic action $I_f$ is an approximate constant of motion (an adiabatic invariant), meaning $\\frac{dI_f}{dt} \\approx 0$. This requires the Poisson bracket $\\{I_f, H\\}$ to be small. We now compute this bracket using its canonical definition.\n\nThe two quantities are:\n$$\nI_f = \\frac{p_f^2}{2\\Omega(q_s)} + \\frac{1}{2}\\Omega(q_s)q_f^2\n$$\n$$\nH = \\frac{p_f^2}{2} + \\frac{1}{2}\\Omega(q_s)^2 q_f^2 + \\frac{p_s^2}{2} + \\frac{1}{2}\\omega_s^2 q_s^2 + \\epsilon q_f^2 q_s\n$$\nWe compute the necessary partial derivatives of $I_f$ and $H$. For brevity, we let $\\Omega \\equiv \\Omega(q_s)$.\nDerivatives of $I_f$:\n$$\n\\frac{\\partial I_f}{\\partial q_f} = \\Omega q_f, \\quad \\frac{\\partial I_f}{\\partial p_f} = \\frac{p_f}{\\Omega}, \\quad \\frac{\\partial I_f}{\\partial p_s} = 0\n$$\n$$\n\\frac{\\partial I_f}{\\partial q_s} = \\frac{\\partial}{\\partial q_s} \\left( \\frac{p_f^2}{2\\Omega} + \\frac{1}{2}\\Omega q_f^2 \\right) = -\\frac{p_f^2}{2\\Omega^2}\\frac{d\\Omega}{dq_s} + \\frac{1}{2}q_f^2\\frac{d\\Omega}{dq_s} = \\frac{1}{2}\\frac{d\\Omega}{dq_s}\\left(q_f^2 - \\frac{p_f^2}{\\Omega^2}\\right)\n$$\nDerivatives of $H$:\n$$\n\\frac{\\partial H}{\\partial q_f} = \\Omega^2 q_f + 2\\epsilon q_s q_f, \\quad \\frac{\\partial H}{\\partial p_f} = p_f, \\quad \\frac{\\partial H}{\\partial p_s} = p_s\n$$\nThe Poisson bracket is $\\{I_f, H\\} = \\left(\\frac{\\partial I_f}{\\partial q_f}\\frac{\\partial H}{\\partial p_f} - \\frac{\\partial I_f}{\\partial p_f}\\frac{\\partial H}{\\partial q_f}\\right) + \\left(\\frac{\\partial I_f}{\\partial q_s}\\frac{\\partial H}{\\partial p_s} - \\frac{\\partial I_f}{\\partial p_s}\\frac{\\partial H}{\\partial q_s}\\right)$.\n\nThe fast-mode contribution is:\n$$\n(\\Omega q_f)(p_f) - \\left(\\frac{p_f}{\\Omega}\\right)(\\Omega^2 q_f + 2\\epsilon q_s q_f) = \\Omega q_f p_f - \\Omega q_f p_f - \\frac{2\\epsilon q_s p_f q_f}{\\Omega} = -\\frac{2\\epsilon q_s}{\\Omega} p_f q_f\n$$\nThe slow-mode contribution is:\n$$\n\\left(\\frac{1}{2}\\frac{d\\Omega}{dq_s}\\left(q_f^2 - \\frac{p_f^2}{\\Omega^2}\\right)\\right)(p_s) - (0) \\cdot (\\dots) = \\frac{p_s}{2}\\frac{d\\Omega}{dq_s}\\left(q_f^2 - \\frac{p_f^2}{\\Omega^2}\\right)\n$$\nCombining these terms gives:\n$$\n\\{I_f, H\\} = \\frac{p_s}{2}\\frac{d\\Omega}{dq_s}\\left(q_f^2 - \\frac{p_f^2}{\\Omega^2}\\right) - \\frac{2\\epsilon q_s}{\\Omega} p_f q_f\n$$\nTo obtain the final expression, we compute the derivative of $\\Omega(q_s) = \\sqrt{\\omega_{f0}^2 + \\gamma q_s^2}$:\n$$\n\\frac{d\\Omega}{dq_s} = \\frac{1}{2}(\\omega_{f0}^2 + \\gamma q_s^2)^{-1/2} (2\\gamma q_s) = \\frac{\\gamma q_s}{\\sqrt{\\omega_{f0}^2 + \\gamma q_s^2}} = \\frac{\\gamma q_s}{\\Omega(q_s)}\n$$\nSubstituting this into the bracket expression yields the final result:\n$$\n\\{I_f, H\\} = \\frac{p_s}{2}\\left(\\frac{\\gamma q_s}{\\Omega(q_s)}\\right)\\left(q_f^2 - \\frac{p_f^2}{\\Omega(q_s)^2}\\right) - \\frac{2\\epsilon q_s}{\\Omega(q_s)} p_f q_f\n$$\nThis expression shows that $\\{I_f, H\\}$ is explicitly proportional to the coupling constants $\\gamma$ and $\\epsilon$. If both are zero, $\\{I_f, H\\} = 0$, and $I_f$ is an exact constant of motion, as expected for two uncoupled harmonic oscillators.\n\nThe condition $\\{I_f, H\\} \\approx 0$ holds, and $I_f$ is an adiabatic invariant, when:\n1.  **Time-scale separation**: The fast-mode frequency is much greater than the slow-mode frequency ($\\Omega(q_s) \\gg \\omega_s$). This corresponds to a large frequency ratio $r = \\omega_{f0} / \\omega_s$.\n2.  **Weak coupling**: The parameters $\\gamma$ and $\\epsilon$ are small.\n\nUnder these conditions, the terms on the right-hand side are not only small but also oscillate rapidly. The terms involving fast coordinates, such as $p_f q_f$ and $q_f^2 - p_f^2/\\Omega^2$, oscillate at approximately twice the fast frequency, $2\\Omega$. When the slow variables $(q_s, p_s)$ evolve on a much slower timescale, the net effect of these rapid oscillations tends to average to zero over long times. Adiabatic invariance breaks down when this averaging fails, which typically occurs near resonances, i.e., when $m\\omega_s \\approx n\\Omega(q_s)$ for small integers $m, n$.\n\n### Part 3: Numerical Simulation of Adiabatic Invariance Breakdown\n\nWe perform direct numerical simulations of Hamilton's equations for the given system. The Hamiltonian is of the form $H = T(\\boldsymbol{p}) + V(\\boldsymbol{q})$, with kinetic energy $T = \\frac{p_f^2}{2} + \\frac{p_s^2}{2}$ and potential energy $V = \\frac{1}{2}\\Omega(q_s)^2 q_f^2 + \\frac{1}{2}\\omega_s^2 q_s^2 + \\epsilon q_f^2 q_s$. This separation allows the use of a symplectic velocity-Verlet integrator, which conserves phase-space volume and exhibits excellent long-term energy stability.\n\nThe equations of motion are $\\dot{\\boldsymbol{q}} = \\boldsymbol{p}$ and $\\dot{\\boldsymbol{p}} = \\boldsymbol{F}(\\boldsymbol{q}) = -\\nabla_{\\boldsymbol{q}} V$. The force components are:\n$$\nF_f = -\\frac{\\partial V}{\\partial q_f} = -(\\Omega(q_s)^2 + 2\\epsilon q_s)q_f\n$$\n$$\nF_s = -\\frac{\\partial V}{\\partial q_s} = -(\\gamma q_f^2 + \\omega_s^2)q_s - \\epsilon q_f^2\n$$\nThe velocity-Verlet algorithm proceeds as:\n1.  $\\boldsymbol{p}(t + \\Delta t/2) = \\boldsymbol{p}(t) + \\boldsymbol{F}(\\boldsymbol{q}(t)) \\frac{\\Delta t}{2}$\n2.  $\\boldsymbol{q}(t + \\Delta t) = \\boldsymbol{q}(t) + \\boldsymbol{p}(t + \\Delta t/2) \\Delta t$\n3.  $\\boldsymbol{p}(t + \\Delta t) = \\boldsymbol{p}(t + \\Delta t/2) + \\boldsymbol{F}(\\boldsymbol{q}(t + \\Delta t)) \\frac{\\Delta t}{2}$\n\nThe simulation is initialized for each parameter case according to the specified conditions. At each time step, we evaluate the exact Poisson bracket $\\{I_f, H\\}$ using the formula derived in Part 2. We then compute the normalized time-averaged aagnitude, $\\mathcal{B}$, which serves as a metric for the breakdown of adiabatic invariance. A larger $\\mathcal{B}$ indicates a greater deviation from adiabaticity. The calculation uses the discrete time average:\n$$\n\\mathcal{B} = \\frac{1}{\\omega_{f0}E_{f0}} \\left( \\frac{1}{N_{\\text{steps}}} \\sum_{i=1}^{N_{\\text{steps}}} \\left| \\{I_f,H\\}(t_i) \\right| \\right)\n$$\nThe following code implements this procedure for the six specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by simulating the molecular Hamiltonian for six test cases\n    and calculating the breakdown of adiabatic invariance.\n    \"\"\"\n\n    test_cases = [\n        # Case A: Baseline (uncoupled)\n        {'r': 10.0, 'epsilon': 0.0, 'gamma': 0.0},\n        # Case B: Adiabatic (weak coupling)\n        {'r': 10.0, 'epsilon': 0.02, 'gamma': 0.10},\n        # Case C: Stronger coupling\n        {'r': 5.0, 'epsilon': 0.20, 'gamma': 0.50},\n        # Case D: Parametric-only coupling\n        {'r': 3.0, 'epsilon': 0.0, 'gamma': 0.50},\n        # Case E: Near resonance (2:1)\n        {'r': 2.0, 'epsilon': 0.05, 'gamma': 0.20},\n        # Case F: Near resonance (3:2)\n        {'r': 1.5, 'epsilon': 0.05, 'gamma': 0.20},\n    ]\n\n    results = []\n    for case in test_cases:\n        b_val = run_simulation(**case)\n        results.append(b_val)\n\n    # Format the final output as a comma-separated list in brackets,\n    # with each value rounded to six decimal places.\n    formatted_results = ','.join([f\"{r:.6f}\" for r in results])\n    print(f\"[{formatted_results}]\")\n\ndef run_simulation(r: float, epsilon: float, gamma: float) -> float:\n    \"\"\"\n    Runs a single simulation for a given set of parameters (r, epsilon, gamma)\n    and returns the measure of adiabatic invariance breakdown, B.\n    \"\"\"\n    # Fixed physical parameters\n    omega_s = 1.0\n    E_f0 = 0.5\n    E_s0 = 0.5\n    N_slow = 10\n\n    # Derived parameters\n    omega_f0 = r * omega_s\n\n    # Simulation time parameters\n    T = N_slow * 2.0 * np.pi / omega_s\n    dt = min(0.02 / omega_f0, 0.01)\n    n_steps = int(np.ceil(T / dt))\n\n    # Initial conditions\n    phi_f = np.pi / 4.0\n    phi_s = np.pi / 3.0\n\n    A_s = np.sqrt(2.0 * E_s0) / omega_s\n    q_s = A_s * np.cos(phi_s)\n    p_s = -omega_s * A_s * np.sin(phi_s)\n\n    # Initial Omega(q_s) is needed for fast-mode initial conditions\n    # Note: As derived p_f(0) = -sqrt(2*E_f0)*sin(phi_f) is constant\n    # and q_f(0) depends on Omega(q_s(0))\n    omega_q_s_initial = np.sqrt(omega_f0**2 + gamma * q_s**2)\n    A_f = np.sqrt(2.0 * E_f0) / omega_q_s_initial \n    q_f = A_f * np.cos(phi_f)\n    p_f = -np.sqrt(2.0 * E_f0) * np.sin(phi_f)\n\n    bracket_sum = 0.0\n\n    for _ in range(n_steps):\n        # 1. Evaluate Poisson Bracket at current state (q_f, p_f, q_s, p_s)\n        omega_q_s = np.sqrt(omega_f0**2 + gamma * q_s**2)\n        \n        # Guard against division by zero, although omega_f0 > 0 makes omega_q_s > 0\n        if omega_q_s > 1e-12:\n            term1 = (p_s / 2.0) * (gamma * q_s / omega_q_s) * (q_f**2 - p_f**2 / omega_q_s**2)\n            term2 = (-2.0 * epsilon * q_s / omega_q_s) * q_f * p_f\n            poisson_bracket = term1 + term2\n        else:\n            poisson_bracket = 0.0\n        \n        bracket_sum += np.abs(poisson_bracket)\n\n        # 2. Propagate dynamics using Velocity-Verlet\n        \n        # First half-step for momenta\n        omega_q_s_sq = omega_q_s**2\n        F_f = -(omega_q_s_sq + 2.0 * epsilon * q_s) * q_f\n        F_s = -(gamma * q_f**2 + omega_s**2) * q_s - epsilon * q_f**2\n        \n        p_f_half = p_f + F_f * dt / 2.0\n        p_s_half = p_s + F_s * dt / 2.0\n        \n        # Full step for positions\n        q_f += p_f_half * dt\n        q_s += p_s_half * dt\n        \n        # Second half-step for momenta\n        omega_q_s_new_sq = omega_f0**2 + gamma * q_s**2\n        F_f_new = -(omega_q_s_new_sq + 2.0 * epsilon * q_s) * q_f\n        F_s_new = -(gamma * q_f**2 + omega_s**2) * q_s - epsilon * q_f**2\n\n        p_f = p_f_half + F_f_new * dt / 2.0\n        p_s = p_s_half + F_s_new * dt / 2.0\n\n    # Calculate final metric B\n    avg_bracket_mag = bracket_sum / n_steps\n    # Normalization factor, guard against division by zero if omega_f0 or E_f0 is zero\n    norm_factor = omega_f0 * E_f0\n    if abs(norm_factor) < 1e-12:\n        return 0.0\n        \n    B = avg_bracket_mag / norm_factor\n    return B\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}