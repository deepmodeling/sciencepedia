{
    "hands_on_practices": [
        {
            "introduction": "Darboux's theorem has a direct analogue in linear algebra, stating that any two symplectic forms on a finite-dimensional vector space are linearly equivalent. This exercise grounds the geometric theorem in a concrete matrix calculation by asking you to find an explicit linear transformation that converts a given constant symplectic form into the standard canonical form. Mastering this linear algebraic foundation provides essential intuition for the more general geometric setting .",
            "id": "3737679",
            "problem": "Let $\\omega$ be a constant symplectic $2$-form on $\\mathbb{R}^{4}$ with global coordinates $(q_{1},q_{2},p_{1},p_{2})$ and suppose that, in these coordinates, $\\omega$ is represented by the skew-symmetric, nondegenerate matrix $W$ via the identification $\\omega(u,v)=u^{\\top}Wv$ for tangent vectors $u$ and $v$. The standard symplectic form $\\omega_{0}$ corresponds to the matrix $J=\\begin{pmatrix}0 & I_{2}\\\\ -I_{2} & 0\\end{pmatrix}$, where $I_{2}$ is the $2\\times 2$ identity matrix. In the linear-algebraic shadow of the Moser path method for Darboux's theorem, a linear change of variables $x=S\\,y$ with $S\\in\\mathrm{GL}(4,\\mathbb{R})$ transforms the matrix of $\\omega$ by congruence to $S^{\\top}WS$.\n\nConsider the constant symplectic form whose matrix in the ordered basis $(q_{1},q_{2},p_{1},p_{2})$ is\n$$\nW=\\begin{pmatrix}\n0 & 0 & 2 & 1\\\\\n0 & 0 & 0 & 3\\\\\n-2 & 0 & 0 & 0\\\\\n-1 & -3 & 0 & 0\n\\end{pmatrix}.\n$$\nConstruct explicitly a linear change of variables $x=S\\,y$ such that $S^{\\top}WS=J$. Your answer must be the single $4\\times 4$ matrix $S$ written in exact form with rational entries. Do not provide an inequality or an equation; provide only the matrix $S$ itself as your final answer.",
            "solution": "The problem requires us to find a matrix $S \\in \\mathrm{GL}(4,\\mathbb{R})$ such that the congruence transformation $S^{\\top}WS$ brings the matrix $W$ to the standard symplectic matrix $J$. The given matrices are:\n$$\nW=\\begin{pmatrix}\n0 & 0 & 2 & 1\\\\\n0 & 0 & 0 & 3\\\\\n-2 & 0 & 0 & 0\\\\\n-1 & -3 & 0 & 0\n\\end{pmatrix}\n\\quad \\text{and} \\quad\nJ=\\begin{pmatrix}\n0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & 1\\\\\n-1 & 0 & 0 & 0\\\\\n0 & -1 & 0 & 0\n\\end{pmatrix}.\n$$\nThe coordinates are ordered as $(q_1, q_2, p_1, p_2)$. We can express $W$ and $J$ in a $2 \\times 2$ block form based on this partition of coordinates into $q$ and $p$ types. Let $0_2$ be the $2 \\times 2$ zero matrix and $I_2$ be the $2 \\times 2$ identity matrix.\nThe matrix $W$ has the form\n$$\nW = \\begin{pmatrix} 0_2 & A \\\\ -A^{\\top} & 0_2 \\end{pmatrix}\n$$\nwhere $A$ is the $2 \\times 2$ matrix from the upper-right block:\n$$\nA = \\begin{pmatrix} 2 & 1 \\\\ 0 & 3 \\end{pmatrix}.\n$$\nThe standard matrix $J$ has the same block structure:\n$$\nJ = \\begin{pmatrix} 0_2 & I_2 \\\\ -I_2 & 0_2 \\end{pmatrix}.\n$$\nWe are looking for a linear transformation $x=Sy$. Let's try to find a solution for $S$ that respects the block structure, i.e., a block-diagonal matrix of the form:\n$$\nS = \\begin{pmatrix} S_q & 0_2 \\\\ 0_2 & S_p \\end{pmatrix}\n$$\nwhere $S_q$ and $S_p$ are invertible $2 \\times 2$ matrices. Such a transformation corresponds to changing the $q$ coordinates among themselves and the $p$ coordinates among themselves.\nLet's substitute this form of $S$ into the congruence equation $S^{\\top}WS=J$:\n$$\nS^{\\top}WS = \n\\begin{pmatrix} S_q^{\\top} & 0_2 \\\\ 0_2 & S_p^{\\top} \\end{pmatrix}\n\\begin{pmatrix} 0_2 & A \\\\ -A^{\\top} & 0_2 \\end{pmatrix}\n\\begin{pmatrix} S_q & 0_2 \\\\ 0_2 & S_p \\end{pmatrix}\n= \\begin{pmatrix} S_q^{\\top} & 0_2 \\\\ 0_2 & S_p^{\\top} \\end{pmatrix}\n\\begin{pmatrix} 0_2 & A S_p \\\\ -A^{\\top} S_q & 0_2 \\end{pmatrix}\n= \\begin{pmatrix} 0_2 & S_q^{\\top} A S_p \\\\ -S_p^{\\top} A^{\\top} S_q & 0_2 \\end{pmatrix}.\n$$\nFor this to be equal to $J$, we must have:\n$$\nS_q^{\\top} A S_p = I_2.\n$$\nThe second block condition, $-S_p^{\\top} A^{\\top} S_q = -I_2$, is equivalent to $S_p^{\\top} A^{\\top} S_q = I_2$, which is the transpose of the first condition, so it is automatically satisfied.\n\nThe equation $S_q^{\\top} A S_p = I_2$ provides a condition on the $2 \\times 2$ matrices $S_q$ and $S_p$. There is no unique solution; we only need to find one pair of matrices. A straightforward approach is to choose one of the matrices to be the identity. Let's set $S_q = I_2$:\n$$\nI_2^{\\top} A S_p = I_2 \\implies A S_p = I_2.\n$$\nThis gives $S_p = A^{-1}$. We need to compute the inverse of $A$.\nThe determinant of $A$ is $\\det(A) = (2)(3) - (1)(0) = 6$.\nThe inverse of a $2 \\times 2$ matrix $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ is $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$.\nThus, the inverse of $A$ is:\n$$\nA^{-1} = \\frac{1}{6} \\begin{pmatrix} 3 & -1 \\\\ 0 & 2 \\end{pmatrix} = \\begin{pmatrix} 3/6 & -1/6 \\\\ 0/6 & 2/6 \\end{pmatrix} = \\begin{pmatrix} 1/2 & -1/6 \\\\ 0 & 1/3 \\end{pmatrix}.\n$$\nSo we have found a possible choice for the blocks of $S$:\n$$\nS_q = I_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\quad \\text{and} \\quad S_p = A^{-1} = \\begin{pmatrix} 1/2 & -1/6 \\\\ 0 & 1/3 \\end{pmatrix}.\n$$\nAssembling these blocks into the $4 \\times 4$ matrix $S$, we get:\n$$\nS = \\begin{pmatrix} S_q & 0_2 \\\\ 0_2 & S_p \\end{pmatrix} = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1/2 & -1/6 \\\\\n0 & 0 & 0 & 1/3\n\\end{pmatrix}.\n$$\nThis matrix provides the desired linear change of variables. The entries are rational as required.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & \\frac{1}{2} & -\\frac{1}{6} \\\\\n0 & 0 & 0 & \\frac{1}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This exercise guides you through the constructive heart of the proof of Darboux's theorem: the Moser path method. You will build the essential components of the proof, starting with a path of forms $\\omega_t$ that connects a given symplectic form $\\omega$ to the standard form $\\omega_0$. By explicitly constructing the potential $1$-form $\\alpha$ and solving for the time-dependent Moser vector field $X_t$, you will see firsthand how the abstract machinery of the theorem translates into a concrete procedure for finding the Darboux chart .",
            "id": "3737657",
            "problem": "Consider the smooth manifold $\\mathbb{R}^{2n}$ with global canonical coordinates $(q_1,\\dots,q_n,p_1,\\dots,p_n)$. Let the symplectic form be given by\n$$\n\\omega=\\sum_{i=1}^{n} a_i(x)\\,dq_i\\wedge dp_i,\n$$\nwhere $x=(q,p)$ and each coefficient $a_i:\\mathbb{R}^{2n}\\to\\mathbb{R}$ is smooth with $a_i(0)=1$. Let\n$$\n\\omega_0=\\sum_{i=1}^{n}dq_i\\wedge dp_i,\n$$\nand define the path of $2$-forms\n$$\n\\omega_t=(1-t)\\,\\omega_0+t\\,\\omega,\\qquad t\\in[0,1].\n$$\nUsing only core definitions and well-tested facts (including the Poincaré Lemma and Cartan’s identity for the Lie derivative), proceed as follows:\n\n1. Establish that $\\omega_t$ is nondegenerate in a neighborhood of the origin $x=0$ for all $t\\in[0,1]$.\n\n2. Construct a $1$-form $\\alpha$ such that $d\\alpha=\\omega-\\omega_0$ and $\\alpha(0)=0$ by employing the homotopy operator associated to the radial vector field $R=\\sum_{i=1}^{n}\\big(q_i\\,\\partial_{q_i}+p_i\\,\\partial_{p_i}\\big)$.\n\n3. For each $t\\in[0,1]$, solve the contraction equation\n$$\ni_{X_t}\\,\\omega_t=\\alpha\n$$\nto obtain an explicit coordinate expression for the Moser vector field $X_t$ in terms of the data $a_i$. Your expression may involve integrals over an auxiliary parameter introduced by the homotopy operator.\n\n4. Briefly explain why the time-dependent ordinary differential equation (ODE) for the flow $\\phi_t$ generated by $X_t$, namely $\\frac{d}{dt}\\phi_t=X_t\\circ\\phi_t$ with $\\phi_0=\\operatorname{id}$, yields a local diffeomorphism $\\phi_1$ near $x=0$ satisfying $\\phi_1^{*}\\omega=\\omega_0$.\n\nYour final answer must be the explicit analytic expression for $X_t$ obtained in step 3. No numerical approximation is required. Express your final answer as a single closed-form analytic expression.",
            "solution": "The problem asks for a detailed derivation of the Moser vector field $X_t$ following four specified steps.\n\n**1. Non-degeneracy of $\\omega_t$**\n\nThe path of $2$-forms $\\omega_t$ is given by\n$$\n\\omega_t = (1-t)\\omega_0 + t\\omega = (1-t)\\sum_{i=1}^n dq_i \\wedge dp_i + t\\sum_{i=1}^n a_i(x) dq_i \\wedge dp_i = \\sum_{i=1}^n \\left( (1-t) + t a_i(x) \\right) dq_i \\wedge dp_i.\n$$\nLet's define the coefficients $b_i(x,t) = (1-t) + t a_i(x)$. A $2$-form is non-degenerate if its matrix representation is non-singular. In the canonical basis of $1$-forms $\\{dq_1, \\dots, dq_n, dp_1, \\dots, dp_n\\}$, the form $\\omega_t$ has a block-diagonal matrix representation, where the $i$-th block, corresponding to the $(q_i, p_i)$ plane, is given by\n$$\n\\begin{pmatrix} 0 & b_i(x,t) \\\\ -b_i(x,t) & 0 \\end{pmatrix}.\n$$\nThe determinant of this $2 \\times 2$ block is $b_i(x,t)^2$. The determinant of the full $2n \\times 2n$ matrix of $\\omega_t$ is the product of the determinants of these blocks:\n$$\n\\det(\\omega_t) = \\prod_{i=1}^n b_i(x,t)^2.\n$$\nFor $\\omega_t$ to be non-degenerate, this determinant must be non-zero, which requires $b_i(x,t) \\neq 0$ for all $i=1,\\dots,n$.\nWe are given that $a_i(0)=1$. At the origin $x=0$, the coefficients $b_i$ become\n$$\nb_i(0,t) = (1-t) + t a_i(0) = (1-t) + t(1) = 1,\n$$\nfor all $t \\in [0,1]$ and all $i=1,\\dots,n$. The functions $a_i(x)$ are smooth, so the functions $b_i(x,t)$ are continuous in both $x$ and $t$. Consider the product $B(x,t) = \\prod_{i=1}^n b_i(x,t)$. At the origin, $B(0,t)=1$ for all $t \\in [0,1]$. Since $B(x,t)$ is a continuous function on $\\mathbb{R}^{2n} \\times [0,1]$ and the set $\\{0\\} \\times [0,1]$ is compact, there exists an open neighborhood $U \\times [0,1]$ of this set, where $U$ is a neighborhood of the origin in $\\mathbb{R}^{2n}$, on which $B(x,t)$ is non-zero.\nTherefore, there exists a neighborhood of the origin $U$ such that for all $x \\in U$ and all $t \\in [0,1]$, $\\det(\\omega_t)(x) \\neq 0$. This establishes that $\\omega_t$ is a path of non-degenerate $2$-forms in a neighborhood of the origin. Since $d\\omega_0=0$ and $d\\omega=0$ (as $\\omega$ is a symplectic form), it follows that $d\\omega_t = (1-t)d\\omega_0 + t d\\omega = 0$, so each $\\omega_t$ is closed. Thus, $\\omega_t$ is a path of symplectic forms near the origin.\n\n**2. Construction of the 1-form $\\alpha$**\n\nWe must find a $1$-form $\\alpha$ such that $d\\alpha = \\omega-\\omega_0$ and $\\alpha(0)=0$. The form $\\eta = \\omega-\\omega_0$ is closed, as $d\\eta = d\\omega - d\\omega_0 = 0$. Since $\\mathbb{R}^{2n}$ is star-shaped with respect to the origin, the Poincaré Lemma guarantees that $\\eta$ is exact. We use the homotopy operator associated with the radial vector field $R = \\sum_{i=1}^{n}\\big(q_i\\,\\partial_{q_i}+p_i\\,\\partial_{p_i}\\big)$.\nA standard formula for constructing the potential $\\alpha$ from a closed $k$-form $\\eta$ on a star-shaped domain is:\n$$\n\\alpha(x) = \\int_0^1 \\lambda^{k-1} (\\phi_\\lambda^* (i_R \\eta))(x) d\\lambda\n$$\nwhere $\\phi_\\lambda(x) = \\lambda x$. For a 2-form ($k=2$), this simplifies. An equivalent and more direct formula for the resulting 1-form $\\alpha$ is:\n$$\n\\alpha = \\sum_{J} \\left( \\int_0^1 s (a_J(sx)-1) ds \\right) \\sum_{i=1}^n (q_i dp_i - p_i dq_i)\n$$\nLet's apply this principle more carefully. First, we compute the interior product $i_R \\eta$:\n$$\n\\eta = \\omega - \\omega_0 = \\sum_{j=1}^n (a_j(x)-1) dq_j \\wedge dp_j.\n$$\n$$\ni_R \\eta = \\sum_{j=1}^n (a_j(x)-1) i_R(dq_j \\wedge dp_j) = \\sum_{j=1}^n (a_j(x)-1) ( (i_R dq_j)\\wedge dp_j - dq_j \\wedge (i_R dp_j) ).\n$$\nSince $i_R dq_j = dq_j(R) = q_j$ and $i_R dp_j = dp_j(R) = p_j$, we have\n$$\ni_R \\eta = \\sum_{j=1}^n (a_j(x)-1) (q_j dp_j - p_j dq_j).\n$$\nThe homotopy operator then involves pulling back this form by the scaling map $\\phi_s(x)=sx$ and integrating:\n$$\n\\alpha = \\int_0^1 \\phi_s^*(i_R \\eta) \\frac{ds}{s}\n$$\nPulling back $i_R\\eta$:\n$$\n\\phi_s^*(i_R \\eta) = \\sum_{j=1}^n (a_j(sx)-1) ( (sq_j) (s dp_j) - (sp_j) (s dq_j) ) = s^2 \\sum_{j=1}^n (a_j(sx)-1) (q_j dp_j - p_j dq_j)\n$$\nIntegrating this gives:\n$$\n\\alpha = \\int_0^1 \\frac{1}{s} \\left( s^2 \\sum_{j=1}^n (a_j(sx)-1) (q_j dp_j - p_j dq_j) \\right) ds = \\sum_{j=1}^n \\left( \\int_0^1 s (a_j(sx)-1) ds \\right) (q_j dp_j - p_j dq_j).\n$$\nAt $x=0$, the terms $q_j$ and $p_j$ are zero, so $\\alpha(0)=0$ as required.\n\n**3. The Moser Vector Field $X_t$**\n\nWe need to solve the contraction equation $i_{X_t}\\,\\omega_t=\\alpha$. Let the vector field $X_t$ be expressed in coordinates as\n$$\nX_t = \\sum_{k=1}^n \\left( Q_k(x,t) \\partial_{q_k} + P_k(x,t) \\partial_{p_k} \\right).\n$$\nThe interior product is\n$$\ni_{X_t} \\omega_t = \\sum_{i=1}^n b_i(x,t) i_{X_t}(dq_i \\wedge dp_i) = \\sum_{i=1}^n b_i(x,t) ( (i_{X_t}dq_i) \\wedge dp_i - dq_i \\wedge (i_{X_t}dp_i) ).\n$$\nWe find $i_{X_t}dq_i = dq_i(X_t)=Q_i$ and $i_{X_t}dp_i = dp_i(X_t)=P_i$. Substituting these gives\n$$\ni_{X_t} \\omega_t = \\sum_{i=1}^n b_i(x,t) (Q_i dp_i - P_i dq_i).\n$$\nWe equate this to the expression for $\\alpha$ from part 2:\n$$\n\\sum_{i=1}^n b_i(x,t) (Q_i dp_i - P_i dq_i) = \\sum_{i=1}^n \\left( \\int_0^1 s (a_i(sx)-1) ds \\right) (q_i dp_i - p_i dq_i).\n$$\nBy comparing the coefficients of the basis $1$-forms $dp_i$ and $dq_i$ for each $i=1,\\dots,n$, we obtain two sets of equations:\n$$\nb_i(x,t) Q_i = q_i \\int_0^1 s (a_i(sx)-1) ds\n$$\n$$\n-b_i(x,t) P_i = -p_i \\int_0^1 s (a_i(sx)-1) ds \\implies b_i(x,t) P_i = p_i \\int_0^1 s (a_i(sx)-1) ds\n$$\nAs established in part 1, $b_i(x,t)=(1-t)+ta_i(x)$ is non-zero in a neighborhood of the origin. We can therefore solve for the components $Q_i$ and $P_i$:\n$$\nQ_i(x,t) = \\frac{\\int_0^1 s (a_i(sx)-1) ds}{(1-t)+ta_i(x)} q_i\n$$\n$$\nP_i(x,t) = \\frac{\\int_0^1 s (a_i(sx)-1) ds}{(1-t)+ta_i(x)} p_i\n$$\nCombining these, we obtain the explicit expression for the Moser vector field $X_t$. To avoid ambiguity with the coordinate $x$, we use $s$ as the integration variable.\n$$\nX_t = \\sum_{i=1}^n \\left( \\frac{\\int_0^1 s (a_i(sx)-1) ds}{(1-t)+ta_i(x)} \\right) (q_i \\partial_{q_i} + p_i \\partial_{p_i}).\n$$\n\n**4. Explanation of the Flow Map**\n\nThe time-dependent vector field $X_t$ generates a flow $\\phi_t$, which is a family of local diffeomorphisms satisfying $\\frac{d}{dt}\\phi_t=X_t\\circ\\phi_t$ with initial condition $\\phi_0=\\operatorname{id}$. We want to show that $\\phi_1^*\\omega = \\omega_0$. To do this, we investigate the Lie derivative of $\\omega_t$ along the flow. Consider the time derivative of the pullback $\\phi_t^*\\omega_t$:\n$$\n\\frac{d}{dt} (\\phi_t^* \\omega_t) = \\phi_t^* \\left( \\mathcal{L}_{X_t}\\omega_t + \\frac{d\\omega_t}{dt} \\right).\n$$\nUsing Cartan's identity, $\\mathcal{L}_{X_t}\\omega_t = d(i_{X_t}\\omega_t) + i_{X_t}(d\\omega_t)$. As shown in part 1, $\\omega_t$ is closed for all $t$, so $d\\omega_t=0$. The identity simplifies to $\\mathcal{L}_{X_t}\\omega_t = d(i_{X_t}\\omega_t)$. By construction of $X_t$, we have $i_{X_t}\\omega_t = \\alpha$. Thus,\n$$\n\\mathcal{L}_{X_t}\\omega_t = d\\alpha.\n$$\nFrom part 2, we constructed $\\alpha$ such that $d\\alpha = \\omega-\\omega_0$.\nThe time derivative of the path $\\omega_t$ is\n$$\n\\frac{d\\omega_t}{dt} = \\frac{d}{dt}((1-t)\\omega_0+t\\omega) = -\\omega_0+\\omega = \\omega-\\omega_0.\n$$\nSubstituting these results back into the expression for the total time derivative:\n$$\n\\frac{d}{dt} (\\phi_t^* \\omega_t) = \\phi_t^* \\left( d\\alpha - (\\omega-\\omega_0) \\right) = \\phi_t^*(0) = 0.\n$$\nThis implies that $\\phi_t^*\\omega_t$ is constant in $t$. Therefore, its value at $t=1$ equals its value at $t=0$:\n$$\n\\phi_1^*\\omega_1 = \\phi_0^*\\omega_0.\n$$\nBy definition, $\\omega_1=\\omega$. Also, $\\phi_0=\\operatorname{id}$, so $\\phi_0^*\\omega_0 = \\omega_0$. This yields the desired result:\n$$\n\\phi_1^*\\omega = \\omega_0.\n$$\nThe map $\\phi_1$ is a local diffeomorphism near the origin that transforms the given symplectic form $\\omega$ into the standard canonical form $\\omega_0$. This argument constitutes the constructive proof of Darboux's theorem.",
            "answer": "$$\n\\boxed{X_t = \\sum_{i=1}^{n} \\left( \\frac{\\int_{0}^{1} s (a_i(sx)-1) ds}{(1-t) + t a_i(x)} \\right) (q_i \\partial_{q_i} + p_i \\partial_{p_i})}\n$$"
        },
        {
            "introduction": "Understanding which transformations preserve the symplectic structure is as crucial as knowing such transformations exist. This problem investigates a linear map that is not generated by a Hamiltonian flow and asks you to quantify its failure to be symplectic by computing the pullback $\\phi^*\\omega$ from first principles. This practice sharpens your understanding of the defining properties of symplectomorphisms and their connection to infinitesimal generators, a cornerstone of both geometric mechanics and the Moser method .",
            "id": "3737690",
            "problem": "Consider the phase space $\\mathbb{R}^{2n}$ with canonical coordinates $(q,p)$, where $q=(q_{1},\\dots,q_{n})$ and $p=(p_{1},\\dots,p_{n})$. Let the standard symplectic form be $\\omega=\\sum_{i=1}^{n} dq_{i}\\wedge dp_{i}$. Define a linear map $\\phi:\\mathbb{R}^{2n}\\to\\mathbb{R}^{2n}$ by $\\phi(q,p)=\\big(q+Aq,\\;p+Ap\\big)$, where $A\\in\\mathbb{R}^{n\\times n}$ is a small symmetric matrix. Starting from the foundational definitions of the pullback of differential forms and the characterization of symplectic diffeomorphisms (those that preserve the symplectic form), compute the explicit expression for the difference $\\phi^{*}\\omega-\\omega$ in terms of $A$, and justify whether $\\phi$ is symplectic in this setting. Relate your reasoning to the local normal form guaranteed by Darboux's theorem and the construction principles behind the Moser path method, emphasizing how infinitesimal and finite conditions arise from first principles without invoking ready-made symplectic matrix criteria.\n\nYour final answer must be the closed-form analytic expression for $\\phi^{*}\\omega-\\omega$ in terms of $A$. No numerical rounding is required, and no physical units are involved. Express the final answer as a single analytic expression only.",
            "solution": "The core of the problem is to compute the pullback of the symplectic form $\\omega$ under the map $\\phi$ and to analyze the result. A map $\\phi$ is a symplectomorphism, or a symplectic map, if it preserves the symplectic form, i.e., if $\\phi^*\\omega = \\omega$.\n\nLet the coordinates on the domain be $(q,p)$ and on the codomain be $(q', p')$. The map $\\phi$ is given by:\n$$ q' = \\phi_q(q,p) = q+Aq $$\n$$ p' = \\phi_p(q,p) = p+Ap $$\nIn component form, for $i=1,\\dots,n$:\n$$ q'_{i}(q,p) = q_i + \\sum_{k=1}^{n} A_{ik} q_k = \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) q_k $$\n$$ p'_{i}(q,p) = p_i + \\sum_{k=1}^{n} A_{ik} p_k = \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) p_k $$\nwhere $\\delta_{ik}$ is the Kronecker delta.\n\nThe standard symplectic form on the codomain is $\\omega = \\sum_{i=1}^{n} dq'_{i} \\wedge dp'_{i}$. We compute its pullback $\\phi^*\\omega$ by applying $\\phi^*$ to the basis $1$-forms $dq'_i$ and $dp'_i$.\nBy definition of the pullback of a function, we have $\\phi^*(q'_i) = q'_i \\circ \\phi$ and $\\phi^*(p'_i) = p'_i \\circ \\phi$. The pullback of the differential is given by $d(\\phi^*f) = \\phi^*(df)$. Thus, we compute the total differentials of the component functions $q'_i(q,p)$ and $p'_i(q,p)$:\n$$ \\phi^*(dq'_{i}) = d(q'_{i}(q,p)) = d\\left(\\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) q_k\\right) = \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) dq_k $$\n$$ \\phi^*(dp'_{i}) = d(p'_{i}(q,p)) = d\\left(\\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) p_k\\right) = \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) dp_k $$\n\nNow we compute the pullback of $\\omega$:\n$$ \\phi^*\\omega = \\phi^*\\left(\\sum_{i=1}^{n} dq'_{i} \\wedge dp'_{i}\\right) = \\sum_{i=1}^{n} \\phi^*(dq'_{i}) \\wedge \\phi^*(dp'_{i}) $$\nSubstituting the expressions for the pulled-back $1$-forms:\n$$ \\phi^*\\omega = \\sum_{i=1}^{n} \\left( \\sum_{j=1}^{n} (\\delta_{ij} + A_{ij}) dq_j \\right) \\wedge \\left( \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) dp_k \\right) $$\nUsing the bilinearity of the wedge product, we can rearrange the sums:\n$$ \\phi^*\\omega = \\sum_{j,k=1}^{n} \\left( \\sum_{i=1}^{n} (\\delta_{ij} + A_{ij})(\\delta_{ik} + A_{ik}) \\right) dq_j \\wedge dp_k $$\nLet $B = I+A$. The coefficient of $dq_j \\wedge dp_k$ is $\\sum_{i=1}^{n} B_{ij} B_{ik}$. This sum is the $(k,j)$-th entry of the matrix product $B^T B$. That is, $(B^T B)_{kj} = \\sum_{i=1}^{n} (B^T)_{ki} B_{ij} = \\sum_{i=1}^{n} B_{ik} B_{ij}$.\nSo, we can write $\\phi^*\\omega$ as:\n$$ \\phi^*\\omega = \\sum_{j,k=1}^{n} (B^T B)_{kj} dq_j \\wedge dp_k $$\nThe problem states that $A$ is a symmetric matrix, so $A^T=A$. This implies $B^T = (I+A)^T = I^T+A^T = I+A = B$.\nTherefore, $B^T B = B^2 = (I+A)^2$.\nExpanding this matrix product:\n$$ (I+A)^2 = (I+A)(I+A) = I^2 + IA + AI + A^2 = I + 2A + A^2 $$\nThe components are $(B^T B)_{kj} = \\delta_{kj} + 2A_{kj} + (A^2)_{kj}$.\nSubstituting this back into the expression for $\\phi^*\\omega$:\n$$ \\phi^*\\omega = \\sum_{j,k=1}^{n} (\\delta_{kj} + 2A_{kj} + (A^2)_{kj}) dq_j \\wedge dp_k $$\nWe can split the sum:\n$$ \\phi^*\\omega = \\sum_{j,k=1}^{n} \\delta_{kj} dq_j \\wedge dp_k + \\sum_{j,k=1}^{n} (2A_{kj} + (A^2)_{kj}) dq_j \\wedge dp_k $$\nThe first term is, by definition, the original symplectic form:\n$$ \\sum_{j,k=1}^{n} \\delta_{kj} dq_j \\wedge dp_k = \\sum_{j=1}^{n} dq_j \\wedge dp_j = \\omega $$\nThus, we arrive at the expression for the pulled-back form:\n$$ \\phi^*\\omega = \\omega + \\sum_{j,k=1}^{n} (2A_{kj} + (A^2)_{kj}) dq_j \\wedge dp_k $$\nThe difference $\\phi^*\\omega - \\omega$ is therefore:\n$$ \\phi^*\\omega - \\omega = \\sum_{j,k=1}^{n} (2A_{kj} + (A^2)_{kj}) dq_j \\wedge dp_k $$\n\nFor $\\phi$ to be a symplectic map, we must have $\\phi^*\\omega - \\omega = 0$. This requires all coefficients of the basis $2$-forms $dq_j \\wedge dp_k$ to be zero. That is, for all $j,k \\in \\{1,\\dots,n\\}$:\n$$ 2A_{kj} + (A^2)_{kj} = 0 $$\nIn matrix form, this is the condition $2A + A^2 = 0$, or $A(2I+A) = 0$. This is not satisfied for an arbitrary non-zero symmetric matrix $A$. For example, if $A=cI$ for a scalar $c \\neq 0$, the condition becomes $2cI + c^2I = 0$, which implies $2c+c^2=0$, meaning $c=-2$ or $c=0$. For any other value of $c$, the map is not symplectic. Hence, in general, $\\phi$ is not a symplectic map.\n\nThe connection to Darboux's theorem and the Moser path method provides deeper context.\n**Darboux's Theorem** guarantees that any symplectic form locally looks like the standard form $\\omega = \\sum dq_i \\wedge dp_i$. Our problem starts within such a standard local model. The question is whether the map $\\phi$ preserves this pre-existing canonical structure. Our calculation shows it generally does not.\n\n**The Moser Path Method** provides a way to construct symplectomorphisms. For a family of forms $\\omega_t$, Moser's trick constructs a path of diffeomorphisms $\\psi_t$ satisfying $\\psi_t^* \\omega_t = \\text{const.}$ by solving for a generating time-dependent vector field $X_t$. A key condition is that $X_t$ must be \"$\\omega_t$-Hamiltonian\" in a certain sense. Let's consider the family of maps $\\phi_t(q,p) = (q+tAq, p+tAp)$ for $t \\in [0,1]$. The infinitesimal generator of this path at $t=0$ is the vector field $X = \\frac{d}{dt}\\phi_t|_{t=0} = (Aq, Ap)$. A map generated by the flow of a Hamiltonian vector field is a symplectomorphism. Let's check if $X$ is Hamiltonian with respect to $\\omega$. This requires the $1$-form $i_X \\omega$ to be exact (i.e., equal to $-dH$ for some function $H$).\n$$ i_X \\omega = i_{(Aq,Ap)}\\left(\\sum_{k=1}^n dq_k \\wedge dp_k\\right) = \\sum_{k=1}^n \\left( (Aq)_k dp_k - (Ap)_k dq_k \\right) $$\nFor this $1$-form to be exact, its exterior derivative must be zero.\n$$ d(i_X \\omega) = \\sum_{k=1}^n \\left( d(Aq)_k \\wedge dp_k - d(Ap)_k \\wedge dq_k \\right) $$\nUsing $(Aq)_k = \\sum_j A_{kj}q_j$ and $(Ap)_k = \\sum_j A_{kj}p_j$:\n$$ d(i_X \\omega) = \\sum_{k,j=1}^n \\left( A_{kj} dq_j \\wedge dp_k - A_{kj} dp_j \\wedge dq_k \\right) $$\nSince $dp_j \\wedge dq_k = -dq_k \\wedge dp_j$:\n$$ d(i_X \\omega) = \\sum_{j,k=1}^n (A_{kj} + A_{jk}) dq_j \\wedge dp_k $$\nAs $A$ is symmetric, $A_{jk}=A_{kj}$, so $d(i_X \\omega) = \\sum_{j,k=1}^n 2A_{kj} dq_j \\wedge dp_k$.\nFor $i_X \\omega$ to be closed, we need $d(i_X \\omega)=0$, which implies $A=0$. Thus, the generating vector field $X$ is Hamiltonian only in the trivial case $A=0$. This explains from first principles why the finite map $\\phi$ is generally not symplectic. The map is not a Hamiltonian flow. The \"infinitesimal\" condition for symplecticity is $A=0$, whereas the \"finite\" condition is $2A+A^2=0$. The discrepancy arises because the map $\\phi(z)=(I+A)z$ is not the time-1 map of the flow generated by $Az$ (which would be $\\exp(A)z$).",
            "answer": "$$ \\boxed{\\sum_{j,k=1}^{n} \\left(2A_{kj} + (A^2)_{kj}\\right) dq_j \\wedge dp_k} $$"
        }
    ]
}