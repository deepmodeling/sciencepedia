{
    "hands_on_practices": [
        {
            "introduction": "达布定理指出，所有辛流形在局部都是相同的。在学习使用莫泽路径法证明这一定理之前，理解其线性代数版本是很有帮助的。这个练习要求你找到一个线性变换，将一个给定的常数辛形式转换为标准形式，这实际上是在为该向量空间构造一个达布基 。这个计算为更普适的几何问题提供了一个坚实的、具体的起点。",
            "id": "3737679",
            "problem": "设 $\\omega$ 是 $\\mathbb{R}^{4}$ 上的一个常辛 2-形式，其全局坐标为 $(q_{1},q_{2},p_{1},p_{2})$。并假设在这些坐标下，$\\omega$ 通过对切向量 $u$ 和 $v$ 的等同关系 $\\omega(u,v)=u^{\\top}Wv$ 由斜对称非退化矩阵 $W$ 表示。标准辛形式 $\\omega_{0}$ 对应于矩阵 $J=\\begin{pmatrix}0 & I_{2}\\\\ -I_{2} & 0\\end{pmatrix}$，其中 $I_{2}$ 是 $2\\times 2$ 单位矩阵。在 Darboux 定理的 Moser 路径法的线性代数投影中，一个线性变量代换 $x=S\\,y$（其中 $S\\in\\mathrm{GL}(4,\\mathbb{R})$）通过合同变换将 $\\omega$ 的矩阵转换为 $S^{\\top}WS$。\n\n考虑这样一个常辛形式，它在有序基 $(q_{1},q_{2},p_{1},p_{2})$ 下的矩阵为\n$$\nW=\\begin{pmatrix}\n0 & 0 & 2 & 1\\\\\n0 & 0 & 0 & 3\\\\\n-2 & 0 & 0 & 0\\\\\n-1 & -3 & 0 & 0\n\\end{pmatrix}.\n$$\n显式地构造一个线性变量代换 $x=S\\,y$，使得 $S^{\\top}WS=J$。你的答案必须是单个 $4\\times 4$ 矩阵 $S$，以有理数分量的精确形式写出。不要提供不等式或方程；你的最终答案只应提供矩阵 $S$ 本身。",
            "solution": "这个问题要求我们找到一个矩阵 $S \\in \\mathrm{GL}(4,\\mathbb{R})$，使得合同变换 $S^{\\top}WS$ 将矩阵 $W$ 变换为标准辛矩阵 $J$。给定的矩阵是：\n$$\nW=\\begin{pmatrix}\n0 & 0 & 2 & 1\\\\\n0 & 0 & 0 & 3\\\\\n-2 & 0 & 0 & 0\\\\\n-1 & -3 & 0 & 0\n\\end{pmatrix}\n\\quad \\text{和} \\quad\nJ=\\begin{pmatrix}\n0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & 1\\\\\n-1 & 0 & 0 & 0\\\\\n0 & -1 & 0 & 0\n\\end{pmatrix}.\n$$\n坐标的排序为 $(q_1, q_2, p_1, p_2)$。我们可以根据这种将坐标划分为 $q$ 和 $p$ 类型的方式，将 $W$ 和 $J$ 表示为 $2 \\times 2$ 的分块形式。设 $0_2$ 为 $2 \\times 2$ 零矩阵，$I_2$ 为 $2 \\times 2$ 单位矩阵。\n矩阵 $W$ 具有以下形式\n$$\nW = \\begin{pmatrix} 0_2 & A \\\\ -A^{\\top} & 0_2 \\end{pmatrix}\n$$\n其中 $A$ 是来自右上分块的 $2 \\times 2$ 矩阵：\n$$\nA = \\begin{pmatrix} 2 & 1 \\\\ 0 & 3 \\end{pmatrix}.\n$$\n标准矩阵 $J$ 具有相同的分块结构：\n$$\nJ = \\begin{pmatrix} 0_2 & I_2 \\\\ -I_2 & 0_2 \\end{pmatrix}.\n$$\n我们正在寻找一个线性变换 $x=Sy$。让我们尝试找到一个尊重分块结构的 $S$ 的解，即一个形如下式的分块对角矩阵：\n$$\nS = \\begin{pmatrix} S_q & 0_2 \\\\ 0_2 & S_p \\end{pmatrix}\n$$\n其中 $S_q$ 和 $S_p$ 是可逆的 $2 \\times 2$ 矩阵。这样的变换对应于将 $q$ 坐标在自身内部进行变换，并将 $p$ 坐标在自身内部进行变换。\n让我们将这种形式的 $S$ 代入合同方程 $S^{\\top}WS=J$ 中：\n$$\nS^{\\top}WS = \n\\begin{pmatrix} S_q^{\\top} & 0_2 \\\\ 0_2 & S_p^{\\top} \\end{pmatrix}\n\\begin{pmatrix} 0_2 & A \\\\ -A^{\\top} & 0_2 \\end{pmatrix}\n\\begin{pmatrix} S_q & 0_2 \\\\ 0_2 & S_p \\end{pmatrix}\n= \\begin{pmatrix} S_q^{\\top} & 0_2 \\\\ 0_2 & S_p^{\\top} \\end{pmatrix}\n\\begin{pmatrix} 0_2 & A S_p \\\\ -A^{\\top} S_q & 0_2 \\end{pmatrix}\n= \\begin{pmatrix} 0_2 & S_q^{\\top} A S_p \\\\ -S_p^{\\top} A^{\\top} S_q & 0_2 \\end{pmatrix}.\n$$\n为了使其等于 $J$，我们必须有：\n$$\nS_q^{\\top} A S_p = I_2.\n$$\n第二个分块条件 $-S_p^{\\top} A^{\\top} S_q = -I_2$ 等价于 $S_p^{\\top} A^{\\top} S_q = I_2$，这是第一个条件的转置，因此它自动满足。\n\n方程 $S_q^{\\top} A S_p = I_2$ 提供了对 $2 \\times 2$ 矩阵 $S_q$ 和 $S_p$ 的一个条件。解不是唯一的；我们只需要找到一对矩阵。一个直接的方法是选择其中一个矩阵为单位矩阵。设 $S_q = I_2$：\n$$\nI_2^{\\top} A S_p = I_2 \\implies A S_p = I_2.\n$$\n这得出 $S_p = A^{-1}$。我们需要计算 $A$ 的逆矩阵。\n$A$ 的行列式是 $\\det(A) = (2)(3) - (1)(0) = 6$。\n一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 的逆是 $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n因此，$A$ 的逆是：\n$$\nA^{-1} = \\frac{1}{6} \\begin{pmatrix} 3 & -1 \\\\ 0 & 2 \\end{pmatrix} = \\begin{pmatrix} 3/6 & -1/6 \\\\ 0/6 & 2/6 \\end{pmatrix} = \\begin{pmatrix} 1/2 & -1/6 \\\\ 0 & 1/3 \\end{pmatrix}.\n$$\n所以我们找到了 $S$ 的分块的一种可能选择：\n$$\nS_q = I_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\quad \\text{和} \\quad S_p = A^{-1} = \\begin{pmatrix} 1/2 & -1/6 \\\\ 0 & 1/3 \\end{pmatrix}.\n$$\n将这些分块组合成 $4 \\times 4$ 矩阵 $S$，我们得到：\n$$\nS = \\begin{pmatrix} S_q & 0_2 \\\\ 0_2 & S_p \\end{pmatrix} = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1/2 & -1/6 \\\\\n0 & 0 & 0 & 1/3\n\\end{pmatrix}.\n$$\n这个矩阵提供了所需的线性变量代换。其元素按要求为有理数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & \\frac{1}{2} & -\\frac{1}{6} \\\\\n0 & 0 & 0 & \\frac{1}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "几何学的中心主题之一是研究保持结构的变换。在辛几何中，这些变换被称为辛同胚——即保持辛形式 $\\omega$ 不变的映射 $\\phi$，满足 $\\phi^*\\omega = \\omega$。这个练习提供了一个直接的计算来检验这一性质 。通过为一个特定的线性映射计算拉回，你将看到对辛条件的偏离如何被量化，并深入理解一个流成为辛流所需的无穷小条件，这也是莫泽方法的一块基石。",
            "id": "3737690",
            "problem": "考虑相空间 $\\mathbb{R}^{2n}$，其正则坐标为 $(q,p)$，其中 $q=(q_{1},\\dots,q_{n})$ 且 $p=(p_{1},\\dots,p_{n})$。设标准辛形式为 $\\omega=\\sum_{i=1}^{n} dq_{i}\\wedge dp_{i}$。定义一个线性映射 $\\phi:\\mathbb{R}^{2n}\\to\\mathbb{R}^{2n}$ 为 $\\phi(q,p)=\\big(q+Aq,\\;p+Ap\\big)$，其中 $A\\in\\mathbb{R}^{n\\times n}$ 是一个小的对称矩阵。从微分形式的拉回的基本定义以及辛微分同胚（即保持辛形式的微分同胚）的特征出发，计算差值 $\\phi^{*}\\omega-\\omega$ 关于 $A$ 的显式表达式，并论证在此设置下 $\\phi$ 是否为辛映射。将你的推理与Darboux定理所保证的局部范式以及Moser路径法背后的构造原理联系起来，强调无穷小条件和有限条件是如何从第一性原理中产生的，而无需援引现成的辛矩阵判据。\n\n你的最终答案必须是 $\\phi^{*}\\omega-\\omega$ 关于 $A$ 的闭式解析表达式。不需要数值舍入，也不涉及物理单位。最终答案仅表示为单个解析表达式。",
            "solution": "问题的核心是计算辛形式 $\\omega$ 在映射 $\\phi$ 下的拉回，并分析结果。一个映射 $\\phi$ 是辛同胚或辛映射，如果它保持辛形式不变，即 $\\phi^*\\omega = \\omega$。\n\n设定义域上的坐标为 $(q,p)$，到达域上的坐标为 $(q', p')$。映射 $\\phi$ 由下式给出：\n$$ q' = \\phi_q(q,p) = q+Aq $$\n$$ p' = \\phi_p(q,p) = p+Ap $$\n分量形式为，对于 $i=1,\\dots,n$：\n$$ q'_{i}(q,p) = q_i + \\sum_{k=1}^{n} A_{ik} q_k = \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) q_k $$\n$$ p'_{i}(q,p) = p_i + \\sum_{k=1}^{n} A_{ik} p_k = \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) p_k $$\n其中 $\\delta_{ik}$ 是克罗内克δ函数。\n\n到达域上的标准辛形式为 $\\omega = \\sum_{i=1}^{n} dq'_{i} \\wedge dp'_{i}$。我们通过将 $\\phi^*$ 应用于基$1$-形式 $dq'_i$ 和 $dp'_i$ 来计算其拉回 $\\phi^*\\omega$。\n根据函数拉回的定义，我们有 $\\phi^*(q'_i) = q'_i \\circ \\phi$ 和 $\\phi^*(p'_i) = p'_i \\circ \\phi$。微分的拉回由 $d(\\phi^*f) = \\phi^*(df)$ 给出。因此，我们计算分量函数 $q'_i(q,p)$ 和 $p'_i(q,p)$ 的全微分：\n$$ \\phi^*(dq'_{i}) = d(q'_{i}(q,p)) = d\\left(\\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) q_k\\right) = \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) dq_k $$\n$$ \\phi^*(dp'_{i}) = d(p'_{i}(q,p)) = d\\left(\\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) p_k\\right) = \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) dp_k $$\n\n现在我们计算 $\\omega$ 的拉回：\n$$ \\phi^*\\omega = \\phi^*\\left(\\sum_{i=1}^{n} dq'_{i} \\wedge dp'_{i}\\right) = \\sum_{i=1}^{n} \\phi^*(dq'_{i}) \\wedge \\phi^*(dp'_{i}) $$\n代入拉回的$1$-形式的表达式：\n$$ \\phi^*\\omega = \\sum_{i=1}^{n} \\left( \\sum_{j=1}^{n} (\\delta_{ij} + A_{ij}) dq_j \\right) \\wedge \\left( \\sum_{k=1}^{n} (\\delta_{ik} + A_{ik}) dp_k \\right) $$\n利用楔积的双线性，我们可以重新排列求和：\n$$ \\phi^*\\omega = \\sum_{j,k=1}^{n} \\left( \\sum_{i=1}^{n} (\\delta_{ij} + A_{ij})(\\delta_{ik} + A_{ik}) \\right) dq_j \\wedge dp_k $$\n令 $B = I+A$。$dq_j \\wedge dp_k$ 的系数是 $\\sum_{i=1}^{n} B_{ij} B_{ik}$。这个和是矩阵乘积 $B^T B$ 的第 $(k,j)$ 个元素。也就是说，$(B^T B)_{kj} = \\sum_{i=1}^{n} (B^T)_{ki} B_{ij} = \\sum_{i=1}^{n} B_{ik} B_{ij}$。\n所以，我们可以将 $\\phi^*\\omega$ 写成：\n$$ \\phi^*\\omega = \\sum_{j,k=1}^{n} (B^T B)_{kj} dq_j \\wedge dp_k $$\n问题陈述 $A$ 是一个对称矩阵，因此 $A^T=A$。这意味着 $B^T = (I+A)^T = I^T+A^T = I+A = B$。\n因此，$B^T B = B^2 = (I+A)^2$。\n展开这个矩阵乘积：\n$$ (I+A)^2 = (I+A)(I+A) = I^2 + IA + AI + A^2 = I + 2A + A^2 $$\n其分量为 $(B^T B)_{kj} = \\delta_{kj} + 2A_{kj} + (A^2)_{kj}$。\n将此代入 $\\phi^*\\omega$ 的表达式中：\n$$ \\phi^*\\omega = \\sum_{j,k=1}^{n} (\\delta_{kj} + 2A_{kj} + (A^2)_{kj}) dq_j \\wedge dp_k $$\n我们可以拆分这个和：\n$$ \\phi^*\\omega = \\sum_{j,k=1}^{n} \\delta_{kj} dq_j \\wedge dp_k + \\sum_{j,k=1}^{n} (2A_{kj} + (A^2)_{kj}) dq_j \\wedge dp_k $$\n第一项根据定义就是原始的辛形式：\n$$ \\sum_{j,k=1}^{n} \\delta_{kj} dq_j \\wedge dp_k = \\sum_{j=1}^{n} dq_j \\wedge dp_j = \\omega $$\n因此，我们得到拉回形式的表达式：\n$$ \\phi^*\\omega = \\omega + \\sum_{j,k=1}^{n} (2A_{kj} + (A^2)_{kj}) dq_j \\wedge dp_k $$\n所以差值 $\\phi^*\\omega - \\omega$ 为：\n$$ \\phi^*\\omega - \\omega = \\sum_{j,k=1}^{n} (2A_{kj} + (A^2)_{kj}) dq_j \\wedge dp_k $$\n\n要使 $\\phi$ 成为一个辛映射，我们必须有 $\\phi^*\\omega - \\omega = 0$。这要求基$2$-形式 $dq_j \\wedge dp_k$ 的所有系数都为零。也就是说，对于所有的 $j,k \\in \\{1,\\dots,n\\}$：\n$$ 2A_{kj} + (A^2)_{kj} = 0 $$\n以矩阵形式表示，这个条件是 $2A + A^2 = 0$，或 $A(2I+A) = 0$。对于任意非零对称矩阵 $A$，这个条件不成立。例如，如果对于标量 $c \\neq 0$，$A=cI$，则条件变为 $2cI + c^2I = 0$，这意味着 $2c+c^2=0$，即 $c=-2$ 或 $c=0$。对于任何其他 $c$ 值，该映射都不是辛映射。因此，一般而言，$\\phi$ 不是一个辛映射。\n\n与Darboux定理和Moser路径法的联系提供了更深的背景。\n**Darboux定理**保证了任何辛形式在局部上都看起来像标准形式 $\\omega = \\sum dq_i \\wedge dp_i$。我们的问题始于这样一个标准的局部模型。问题在于映射 $\\phi$ 是否保持这个预先存在的正则结构。我们的计算表明，它通常不保持。\n\n**Moser路径法**提供了一种构造辛同胚的方法。对于一族形式 $\\omega_t$，Moser技巧通过求解一个生成性的时变向量场 $X_t$ 来构造一条微分同胚路径 $\\psi_t$，满足 $\\psi_t^* \\omega_t = \\text{常数}$。一个关键条件是 $X_t$ 在某种意义上必须是“$\\omega_t$-哈密顿的”。让我们考虑映射族 $\\phi_t(q,p) = (q+tAq, p+tAp)$，其中 $t \\in [0,1]$。该路径在 $t=0$ 处的无穷小生成元是向量场 $X = \\frac{d}{dt}\\phi_t|_{t=0} = (Aq, Ap)$。由哈密顿向量场的流生成的映射是辛同胚。让我们检查 $X$ 相对于 $\\omega$ 是否是哈密顿的。这要求$1$-形式 $i_X \\omega$ 是恰当的（即等于 $-dH$ 对于某个函数 $H$）。\n$$ i_X \\omega = i_{(Aq,Ap)}\\left(\\sum_{k=1}^n dq_k \\wedge dp_k\\right) = \\sum_{k=1}^n \\left( (Aq)_k dp_k - (Ap)_k dq_k \\right) $$\n要使这个$1$-形式是恰当的，其外微分必须为零。\n$$ d(i_X \\omega) = \\sum_{k=1}^n \\left( d(Aq)_k \\wedge dp_k - d(Ap)_k \\wedge dq_k \\right) $$\n使用 $(Aq)_k = \\sum_j A_{kj}q_j$ 和 $(Ap)_k = \\sum_j A_{kj}p_j$:\n$$ d(i_X \\omega) = \\sum_{k,j=1}^n \\left( A_{kj} dq_j \\wedge dp_k - A_{kj} dp_j \\wedge dq_k \\right) $$\n由于 $dp_j \\wedge dq_k = -dq_k \\wedge dp_j$:\n$$ d(i_X \\omega) = \\sum_{j,k=1}^n (A_{kj} + A_{jk}) dq_j \\wedge dp_k $$\n由于 $A$ 是对称的，$A_{jk}=A_{kj}$，所以 $d(i_X \\omega) = \\sum_{j,k=1}^n 2A_{kj} dq_j \\wedge dp_k$。\n要使 $i_X \\omega$ 是闭的，我们需要 $d(i_X \\omega)=0$，这意味着 $A=0$。因此，生成向量场 $X$ 仅在 $A=0$ 的平凡情况下是哈密顿的。这从第一性原理上解释了为什么有限映射 $\\phi$ 通常不是辛映射。该映射不是一个哈密顿流。辛性的“无穷小”条件是 $A=0$，而“有限”条件是 $2A+A^2=0$。这种差异的产生是因为映射 $\\phi(z)=(I+A)z$ 不是由 $Az$ 生成的流的时间-1映射（那将是 $\\exp(A)z$）。",
            "answer": "$$ \\boxed{\\sum_{j,k=1}^{n} \\left(2A_{kj} + (A^2)_{kj}\\right) dq_j \\wedge dp_k} $$"
        },
        {
            "introduction": "莫泽路径法是构造关联几何结构的微分同胚的强大技术。这个练习将引导你完整地应用此方法来证明达布定理。你将构造一个显式的含时向量场，其流将标准的辛结构形变为一个给定的结构 。这个练习是本主题的核心，它将抽象的证明过程转化为一个具体的、分步的算法，并揭示了闭性、恰当性和向量场流之间的深刻相互作用。",
            "id": "3737657",
            "problem": "考虑光滑流形 $\\mathbb{R}^{2n}$，其全局典范坐标为 $(q_1,\\dots,q_n,p_1,\\dots,p_n)$。设辛形式由下式给出\n$$\n\\omega=\\sum_{i=1}^{n} a_i(x)\\,dq_i\\wedge dp_i,\n$$\n其中 $x=(q,p)$ 且每个系数 $a_i:\\mathbb{R}^{2n}\\to\\mathbb{R}$ 都是光滑的，并满足 $a_i(0)=1$。设\n$$\n\\omega_0=\\sum_{i=1}^{n}dq_i\\wedge dp_i,\n$$\n并定义 2-形式的路径\n$$\n\\omega_t=(1-t)\\,\\omega_0+t\\,\\omega,\\qquad t\\in[0,1].\n$$\n仅使用核心定义和熟知事实（包括 Poincaré 引理和李导数的 Cartan 恒等式），按以下步骤进行：\n\n1. 证明对所有 $t\\in[0,1]$，$\\omega_t$ 在原点 $x=0$ 的一个邻域内是非退化的。\n\n2. 利用与径向向量场 $R=\\sum_{i=1}^{n}\\big(q_i\\,\\partial_{q_i}+p_i\\,\\partial_{p_i}\\big)$ 相关联的同伦算子，构造一个 1-形式 $\\alpha$，使得 $d\\alpha=\\omega-\\omega_0$ 且 $\\alpha(0)=0$。\n\n3. 对每个 $t\\in[0,1]$，求解缩并方程\n$$\ni_{X_t}\\,\\omega_t=\\alpha\n$$\n以获得 Moser 向量场 $X_t$ 关于数据 $a_i$ 的显式坐标表达式。您的表达式可能包含对由同伦算子引入的辅助参数的积分。\n\n4. 简要说明由 $X_t$ 生成的流 $\\phi_t$ 的含时常微分方程(ODE)（即 $\\frac{d}{dt}\\phi_t=X_t\\circ\\phi_t$ 且 $\\phi_0=\\operatorname{id}$）为何在 $x=0$ 附近产生一个局部微分同胚 $\\phi_1$，满足 $\\phi_1^{*}\\omega=\\omega_0$。\n\n您的最终答案必须是在步骤3中获得的 $X_t$ 的显式解析表达式。不需要数值近似。请将您的最终答案表示为单个闭式解析表达式。",
            "solution": "问题要求按照四个指定步骤详细推导 Moser 向量场 $X_t$。\n\n**1. $\\omega_t$ 的非退化性**\n\n2-形式的路径 $\\omega_t$ 由下式给出\n$$\n\\omega_t = (1-t)\\omega_0 + t\\omega = (1-t)\\sum_{i=1}^n dq_i \\wedge dp_i + t\\sum_{i=1}^n a_i(x) dq_i \\wedge dp_i = \\sum_{i=1}^n \\left( (1-t) + t a_i(x) \\right) dq_i \\wedge dp_i.\n$$\n我们定义系数 $b_i(x,t) = (1-t) + t a_i(x)$。一个 2-形式是非退化的，如果其矩阵表示是非奇异的。在 1-形式的典范基 $\\{dq_1, \\dots, dq_n, dp_1, \\dots, dp_n\\}$ 中，形式 $\\omega_t$ 有一个分块对角矩阵表示，其中对应于 $(q_i, p_i)$ 平面的第 $i$ 个块由下式给出\n$$\n\\begin{pmatrix} 0 & b_i(x,t) \\\\ -b_i(x,t) & 0 \\end{pmatrix}.\n$$\n这个 $2 \\times 2$ 块的行列式是 $b_i(x,t)^2$。$\\omega_t$ 的完整 $2n \\times 2n$ 矩阵的行列式是这些块的行列式的乘积：\n$$\n\\det(\\omega_t) = \\prod_{i=1}^n b_i(x,t)^2.\n$$\n为使 $\\omega_t$ 非退化，此行列式必须非零，这要求对所有 $i=1,\\dots,n$，都有 $b_i(x,t) \\neq 0$。\n我们已知 $a_i(0)=1$。在原点 $x=0$ 处，系数 $b_i$ 变为\n$$\nb_i(0,t) = (1-t) + t a_i(0) = (1-t) + t(1) = 1,\n$$\n对所有 $t \\in [0,1]$ 和所有 $i=1,\\dots,n$ 成立。函数 $a_i(x)$ 是光滑的，因此函数 $b_i(x,t)$ 关于 $x$ 和 $t$ 都是连续的。考虑乘积 $B(x,t) = \\prod_{i=1}^n b_i(x,t)$。在原点处，$B(0,t)=1$ 对所有 $t \\in [0,1]$ 成立。由于 $B(x,t)$ 是 $\\mathbb{R}^{2n} \\times [0,1]$ 上的连续函数，且集合 $\\{0\\} \\times [0,1]$ 是紧集，因此存在该集合的一个开邻域 $U \\times [0,1]$，其中 $U$ 是 $\\mathbb{R}^{2n}$ 中原点的一个邻域，在该邻域上 $B(x,t)$ 非零。\n因此，存在原点的一个邻域 $U$，使得对所有 $x \\in U$ 和所有 $t \\in [0,1]$，$\\det(\\omega_t)(x) \\neq 0$。这证明了 $\\omega_t$ 是原点邻域内的一条非退化 2-形式的路径。由于 $d\\omega_0=0$ 和 $d\\omega=0$（因为 $\\omega$ 是一个辛形式），可得 $d\\omega_t = (1-t)d\\omega_0 + t d\\omega = 0$，所以每个 $\\omega_t$ 都是闭的。因此，$\\omega_t$ 是原点附近的一条辛形式的路径。\n\n**2. 1-形式 $\\alpha$ 的构造**\n\n我们必须找到一个 1-形式 $\\alpha$ 使得 $d\\alpha = \\omega-\\omega_0$ 且 $\\alpha(0)=0$。形式 $\\eta = \\omega-\\omega_0$ 是闭的，因为 $d\\eta = d\\omega - d\\omega_0 = 0$。由于 $\\mathbb{R}^{2n}$ 是关于原点的星形域，Poincaré 引理保证了 $\\eta$ 是恰当的。我们使用与径向向量场 $R = \\sum_{i=1}^{n}\\big(q_i\\,\\partial_{q_i}+p_i\\,\\partial_{p_i}\\big)$ 相关联的同伦算子。\n1-形式 $\\alpha$ 可通过以下公式构造\n$$\n\\alpha = \\int_0^1 \\phi_s^*(i_R \\eta) ds,\n$$\n其中 $\\phi_s(x)=sx$ 是径向伸缩映射。首先，我们计算内积 $i_R \\eta$：\n$$\n\\eta = \\omega - \\omega_0 = \\sum_{j=1}^n (a_j(x)-1) dq_j \\wedge dp_j.\n$$\n$$\ni_R \\eta = \\sum_{j=1}^n (a_j(x)-1) i_R(dq_j \\wedge dp_j) = \\sum_{j=1}^n (a_j(x)-1) ( (i_R dq_j)\\wedge dp_j - dq_j \\wedge (i_R dp_j) ).\n$$\n由于 $i_R dq_j = dq_j(R) = q_j$ 且 $i_R dp_j = dp_j(R) = p_j$，我们有\n$$\ni_R \\eta = \\sum_{j=1}^n (a_j(x)-1) (q_j dp_j - p_j dq_j).\n$$\n在星形域上，作用于一个 k-形式 $\\beta = \\sum_J \\beta_J(x)dx^J$ 的同伦算子 $I$ 有一个更直接的公式\n$$\nI(\\beta) = \\sum_J \\left( \\int_0^1 s^{k-1} \\beta_J(sx) ds \\right) \\sum_{i=1}^k (-1)^{i-1} x_{j_i} dx^{j_1} \\wedge \\dots \\wedge \\widehat{dx^{j_i}} \\wedge \\dots \\wedge dx^{j_k}.\n$$\n我们的形式是 $\\eta$，它是一些 2-形式的和 ($k=2$)。对于单项 $\\eta_j = (a_j(x)-1) dq_j \\wedge dp_j$，该公式得出\n$$\nI(\\eta_j) = \\left( \\int_0^1 s^{2-1} (a_j(sx)-1) ds \\right) (q_j dp_j - p_j dq_j).\n$$\n对所有 $j$ 求和，我们得到所需的 1-形式 $\\alpha$：\n$$\n\\alpha = \\sum_{j=1}^n \\left( \\int_0^1 s (a_j(sx)-1) ds \\right) (q_j dp_j - p_j dq_j).\n$$\n在 $x=0$ 处，$q_j$ 和 $p_j$ 项为零，因此按要求有 $\\alpha(0)=0$。\n\n**3. Moser 向量场 $X_t$**\n\n我们需要求解缩并方程 $i_{X_t}\\,\\omega_t=\\alpha$。设向量场 $X_t$ 用坐标表示为\n$$\nX_t = \\sum_{k=1}^n \\left( Q_k(x,t) \\partial_{q_k} + P_k(x,t) \\partial_{p_k} \\right).\n$$\n内积为\n$$\ni_{X_t} \\omega_t = \\sum_{i=1}^n b_i(x,t) i_{X_t}(dq_i \\wedge dp_i) = \\sum_{i=1}^n b_i(x,t) ( (i_{X_t}dq_i) \\wedge dp_i - dq_i \\wedge (i_{X_t}dp_i) ).\n$$\n我们发现 $i_{X_t}dq_i = dq_i(X_t)=Q_i$ 和 $i_{X_t}dp_i = dp_i(X_t)=P_i$。代入这些可得\n$$\ni_{X_t} \\omega_t = \\sum_{i=1}^n b_i(x,t) (Q_i dp_i - P_i dq_i).\n$$\n我们将此式与第2部分中 $\\alpha$ 的表达式相等：\n$$\n\\sum_{i=1}^n b_i(x,t) (Q_i dp_i - P_i dq_i) = \\sum_{i=1}^n \\left( \\int_0^1 s (a_i(sx)-1) ds \\right) (q_i dp_i - p_i dq_i).\n$$\n通过对每个 $i=1,\\dots,n$ 比较基 1-形式 $dp_i$ 和 $dq_i$ 的系数，我们得到两组方程：\n$$\nb_i(x,t) Q_i = q_i \\int_0^1 s (a_i(sx)-1) ds\n$$\n$$\n-b_i(x,t) P_i = -p_i \\int_0^1 s (a_i(sx)-1) ds \\implies b_i(x,t) P_i = p_i \\int_0^1 s (a_i(sx)-1) ds\n$$\n如第1部分所述，$b_i(x,t)=(1-t)+ta_i(x)$ 在原点的一个邻域内非零。因此我们可以求解分量 $Q_i$ 和 $P_i$：\n$$\nQ_i(x,t) = \\frac{\\int_0^1 s (a_i(sx)-1) ds}{(1-t)+ta_i(x)} q_i\n$$\n$$\nP_i(x,t) = \\frac{\\int_0^1 s (a_i(sx)-1) ds}{(1-t)+ta_i(x)} p_i\n$$\n结合这些，我们得到 Moser 向量场 $X_t$ 的显式表达式。为避免与坐标 $x$ 混淆，我们使用 $\\lambda$ 作为积分变量。\n$$\nX_t = \\sum_{i=1}^n \\left( \\frac{\\int_0^1 \\lambda (a_i(\\lambda x)-1) d\\lambda}{(1-t)+ta_i(x)} \\right) (q_i \\partial_{q_i} + p_i \\partial_{p_i}).\n$$\n\n**4. 关于流映射的解释**\n\n含时向量场 $X_t$ 生成一个流 $\\phi_t$，它是一个局部微分同胚族，满足 $\\frac{d}{dt}\\phi_t=X_t\\circ\\phi_t$ 及初始条件 $\\phi_0=\\operatorname{id}$。我们想证明 $\\phi_1^*\\omega = \\omega_0$。为此，我们研究 $\\omega_t$ 沿着流的李导数。考虑拉回 $\\phi_t^*\\omega_t$ 的时间导数：\n$$\n\\frac{d}{dt} (\\phi_t^* \\omega_t) = \\phi_t^* \\left( L_{X_t}\\omega_t + \\frac{d\\omega_t}{dt} \\right).\n$$\n使用 Cartan 恒等式，$L_{X_t}\\omega_t = d(i_{X_t}\\omega_t) + i_{X_t}(d\\omega_t)$。如第1部分所示，对所有 $t$，$\\omega_t$ 都是闭的，所以 $d\\omega_t=0$。该恒等式简化为 $L_{X_t}\\omega_t = d(i_{X_t}\\omega_t)$。根据 $X_t$ 的构造，我们有 $i_{X_t}\\omega_t = \\alpha$。因此，\n$$\nL_{X_t}\\omega_t = d\\alpha.\n$$\n从第2部分，我们构造了 $\\alpha$ 使得 $d\\alpha = \\omega-\\omega_0$。\n路径 $\\omega_t$ 的时间导数是\n$$\n\\frac{d\\omega_t}{dt} = \\frac{d}{dt}((1-t)\\omega_0+t\\omega) = -\\omega_0+\\omega = \\omega-\\omega_0.\n$$\n将这些结果代回到全时间导数的表达式中：\n$$\n\\frac{d}{dt} (\\phi_t^* \\omega_t) = \\phi_t^* \\left( (\\omega-\\omega_0) - (\\omega-\\omega_0) \\right) = \\phi_t^*(0) = 0.\n$$\n这意味着 $\\phi_t^*\\omega_t$ 关于 $t$ 是常数。因此，它在 $t=1$ 处的值等于它在 $t=0$ 处的值：\n$$\n\\phi_1^*\\omega_1 = \\phi_0^*\\omega_0.\n$$\n根据定义，$\\omega_1=\\omega$。此外，$\\phi_0=\\operatorname{id}$，所以 $\\phi_0^*\\omega_0 = \\omega_0$。这得出了期望的结果：\n$$\n\\phi_1^*\\omega = \\omega_0.\n$$\n映射 $\\phi_1$ 是原点附近的一个局部微分同胚，它将给定的辛形式 $\\omega$ 变换为标准典范形式 $\\omega_0$。这一论证构成了 Darboux 定理的构造性证明。\n\n所要求的最终答案是 $X_t$ 的表达式。",
            "answer": "$$\n\\boxed{X_t = \\sum_{i=1}^{n} \\left( \\frac{\\int_{0}^{1} s (a_i(sx)-1) ds}{(1-t) + t a_i(x)} \\right) (q_i \\partial_{q_i} + p_i \\partial_{p_i})}\n$$"
        }
    ]
}