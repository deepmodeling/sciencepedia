{
    "hands_on_practices": [
        {
            "introduction": "要真正理解辛几何的独特性，关键在于区分辛变换与我们更熟悉的欧几里得几何中的正交变换。此练习通过一个具体的线性映射（剪切变换），让您亲手验证一个变换如何能够保持辛形式（即保持“相空间面积”），却不保持向量的长度和角度。通过这个计算 ，您将深刻体会到辛群 $Sp(2n, \\mathbb{R})$ 与正交群 $O(2n)$ 的根本区别，为理解哈密顿系统的几何特性打下坚实基础。",
            "id": "3769701",
            "problem": "设 $\\mathbb{R}^{2}$ 配备有典范辛形式 $\\omega_{0}$，其定义为 $\\omega_{0}(u,v) = u^{\\top} J v$ 对所有 $u,v \\in \\mathbb{R}^{2}$ 成立，其中 $J = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$，并配备有欧几里得度量 $g(u,v) = u^{\\top} v$。对于一个固定的参数 $a \\in \\mathbb{R}$ 且 $a \\neq 0$，考虑线性映射 $S_{a} : \\mathbb{R}^{2} \\to \\mathbb{R}^{2}$，在典范坐标 $(q,p)$ 下由 $S_{a}(q,p) = (q,\\, a q + p)$ 给出，即 $S_{a}$ 在标准基下的矩阵表示为\n$$\nS_{a} = \\begin{pmatrix} 1 & 0 \\\\ a & 1 \\end{pmatrix}.\n$$\n仅使用辛形式保持和关于欧几里得度量的正交性的基本定义，完成以下任务：\n- 验证 $S_{a}$ 保持 $\\omega_{0}$，也就是说，直接验证对所有 $u,v \\in \\mathbb{R}^{2}$，都有 $\\omega_{0}(S_{a} u, S_{a} v) = \\omega_{0}(u,v)$。\n- 验证当 $a \\neq 0$ 时，$S_{a}$ 关于 $g$ 不是正交的。\n- 设 $e_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。计算标量 $g(S_{a} e_{1}, S_{a} e_{1})$，作为关于 $a$ 的闭式表达式。\n\n以单个解析表达式的形式提供你的最终答案。不需要单位。",
            "solution": "该问题陈述已经过验证，被认为是一个适定的、具有科学依据的线性代数和辛几何练习题。\n\n该问题要求完成关于由矩阵 $S_{a} = \\begin{pmatrix} 1 & 0 \\\\ a & 1 \\end{pmatrix}$（对于非零参数 $a \\in \\mathbb{R}$）定义的线性映射 $S_{a}: \\mathbb{R}^{2} \\to \\mathbb{R}^{2}$ 的三项任务。空间 $\\mathbb{R}^{2}$ 配备有典范辛形式 $\\omega_{0}(u,v) = u^{\\top} J v$（其中 $J = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$）以及标准欧几里得度量 $g(u,v) = u^{\\top} v$。\n\n首先，我们验证 $S_{a}$ 保持辛形式 $\\omega_{0}$。问题要求使用基本定义 $\\omega_{0}(S_{a} u, S_{a} v) = \\omega_{0}(u,v)$ 对所有 $u, v \\in \\mathbb{R}^{2}$ 成立。\n设 $u = \\begin{pmatrix} q_{1} \\\\ p_{1} \\end{pmatrix}$ 和 $v = \\begin{pmatrix} q_{2} \\\\ p_{2} \\end{pmatrix}$ 是 $\\mathbb{R}^{2}$ 中的两个任意向量。\n辛形式作用于这两个向量的值为：\n$$\n\\omega_{0}(u,v) = u^{\\top} J v = \\begin{pmatrix} q_{1} & p_{1} \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} \\begin{pmatrix} q_{2} \\\\ p_{2} \\end{pmatrix} = \\begin{pmatrix} q_{1} & p_{1} \\end{pmatrix} \\begin{pmatrix} p_{2} \\\\ -q_{2} \\end{pmatrix} = q_{1}p_{2} - p_{1}q_{2}\n$$\n现在，我们将变换 $S_{a}$ 应用于这两个向量：\n$$\nS_{a} u = \\begin{pmatrix} 1 & 0 \\\\ a & 1 \\end{pmatrix} \\begin{pmatrix} q_{1} \\\\ p_{1} \\end{pmatrix} = \\begin{pmatrix} q_{1} \\\\ aq_{1} + p_{1} \\end{pmatrix}\n$$\n$$\nS_{a} v = \\begin{pmatrix} 1 & 0 \\\\ a & 1 \\end{pmatrix} \\begin{pmatrix} q_{2} \\\\ p_{2} \\end{pmatrix} = \\begin{pmatrix} q_{2} \\\\ aq_{2} + p_{2} \\end{pmatrix}\n$$\n接下来，我们计算变换后向量上的辛形式：\n$$\n\\omega_{0}(S_{a} u, S_{a} v) = (S_{a} u)^{\\top} J (S_{a} v) = \\begin{pmatrix} q_{1} & aq_{1} + p_{1} \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} \\begin{pmatrix} q_{2} \\\\ aq_{2} + p_{2} \\end{pmatrix}\n$$\n$$\n\\omega_{0}(S_{a} u, S_{a} v) = \\begin{pmatrix} q_{1} & aq_{1} + p_{1} \\end{pmatrix} \\begin{pmatrix} aq_{2} + p_{2} \\\\ -q_{2} \\end{pmatrix}\n$$\n$$\n\\omega_{0}(S_{a} u, S_{a} v) = q_{1}(aq_{2} + p_{2}) - (aq_{1} + p_{1})q_{2} = aq_{1}q_{2} + q_{1}p_{2} - aq_{1}q_{2} - p_{1}q_{2} = q_{1}p_{2} - p_{1}q_{2}\n$$\n比较结果，我们发现 $\\omega_{0}(S_{a} u, S_{a} v) = \\omega_{0}(u,v)$，这验证了映射 $S_{a}$ 是一个辛同胚。\n\n其次，我们验证当 $a \\neq 0$ 时，$S_{a}$ 关于欧几里得度量 $g$ 不是正交的。一个线性变换 $S$ 是正交的，当且仅当它保持内积，即对所有向量 $u, v$，都有 $g(Su, Sv) = g(u,v)$。我们可以通过找到一个反例来证明情况并非如此。\n我们选择标准基向量 $u = e_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n度量作用于该向量与自身的值即为其范数的平方：\n$$\ng(e_{1}, e_{1}) = e_{1}^{\\top} e_{1} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1\n$$\n现在，我们将变换 $S_{a}$ 应用于 $e_{1}$：\n$$\nS_{a} e_{1} = \\begin{pmatrix} 1 & 0 \\\\ a & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ a \\end{pmatrix}\n$$\n接下来，我们计算变换后向量的度量：\n$$\ng(S_{a} e_{1}, S_{a} e_{1}) = (S_{a} e_{1})^{\\top} (S_{a} e_{1}) = \\begin{pmatrix} 1 & a \\end{pmatrix} \\begin{pmatrix} 1 \\\\ a \\end{pmatrix} = 1^{2} + a^{2} = 1+a^{2}\n$$\n正交性条件要求 $g(S_{a} e_{1}, S_{a} e_{1}) = g(e_{1}, e_{1})$，这意味着 $1+a^{2} = 1$。这蕴含着 $a^{2}=0$，因此 $a=0$。然而，问题指定 $a \\neq 0$。因此，对任意 $a \\neq 0$，我们有 $g(S_{a} e_{1}, S_{a} e_{1}) = 1+a^{2} \\neq 1 = g(e_{1}, e_{1})$。这表明 $S_{a}$ 对于 $a \\neq 0$ 不是一个正交变换。\n\n第三，我们计算标量 $g(S_{a} e_{1}, S_{a} e_{1})$，作为关于 $a$ 的闭式表达式。这个计算在第二步中已经为了证明非正交性而执行。作为问题的最后一部分，我们在此为完整性重复该计算。\n向量 $e_{1}$ 由 $e_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 给出。\n应用映射 $S_{a}$ 得到：\n$$\nS_{a} e_{1} = \\begin{pmatrix} 1 & 0 \\\\ a & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ a \\end{pmatrix}\n$$\n标量 $g(S_{a} e_{1}, S_{a} e_{1})$ 使用度量定义 $g(u,v) = u^{\\top}v$ 计算如下：\n$$\ng(S_{a} e_{1}, S_{a} e_{1}) = \\left(\\begin{pmatrix} 1 \\\\ a \\end{pmatrix}\\right)^{\\top} \\begin{pmatrix} 1 \\\\ a \\end{pmatrix} = \\begin{pmatrix} 1 & a \\end{pmatrix} \\begin{pmatrix} 1 \\\\ a \\end{pmatrix} = 1 \\cdot 1 + a \\cdot a = 1+a^{2}\n$$\n这就是所求的闭式表达式。",
            "answer": "$$\n\\boxed{1+a^{2}}\n$$"
        },
        {
            "introduction": "在理解了什么是辛变换之后，下一个核心问题是这些变换是如何产生的。哈密顿力学的中心思想是，哈密顿函数是辛变换流的无穷小生成元。这个练习  引导您从一个简单的几何变换——动量空间中的平移——出发，反向推导出生成此变换的哈密顿函数 $H$ 和相应的哈密顿向量场 $X_H$。这个过程不仅能加深您对定义方程 $\\iota_{X_H}\\omega = dH$ 的理解，也揭示了物理可观测量（以哈密顿函数形式存在）与其在相空间中引起的几何动力学之间的深刻联系。",
            "id": "3769650",
            "problem": "设 $(\\mathbb{R}^{2n},\\omega)$ 为标准辛向量空间，其典范坐标为 $(q,p)=(q^{1},\\dots,q^{n},p_{1},\\dots,p_{n})$，辛形式为 $\\omega=\\sum_{i=1}^{n} dq^{i}\\wedge dp_{i}$。回顾一下，对于一个光滑函数 $H:\\mathbb{R}^{2n}\\to\\mathbb{R}$，哈密顿向量场 $X_{H}$ 由内积恒等式 $\\iota_{X_{H}}\\omega=dH$ 定义，其流 $\\varphi_{t}$ 是自治常微分方程 $\\dot{z}(t)=X_{H}(z(t))$ 在初始条件 $z(0)=(q,p)$ 下的解。\n\n固定一个常向量 $c=(c_{1},\\dots,c_{n})\\in\\mathbb{R}^{n}$，并考虑由 $\\Phi_{c}(q,p)=(q,p+c)$ 定义的平移映射 $\\Phi_{c}:\\mathbb{R}^{2n}\\to\\mathbb{R}^{2n}$。从上述基本定义出发，通过确定一个哈密顿函数 $H:\\mathbb{R}^{2n}\\to\\mathbb{R}$，使其哈密顿流的时间-1 映射为此平移映射，来证明 $\\Phi_{c}$ 是一个哈密顿微分同胚。仅使用定义 $\\iota_{X_{H}}\\omega=dH$ 和基本的多变量微积分，推导出典范坐标下相关的哈密顿向量场 $X_{H}$。最后断定 $X_{H}$ 的时间-1 流与 $\\Phi_{c}$ 一致。\n\n你的最终答案必须是 $X_{H}$ 在典范坐标下的单一解析表达式。无需进行数值计算，也不涉及任何单位。如果出现角度，必须以弧度为单位；但此问题不涉及角度。",
            "solution": "该问题陈述是微分几何中的一个有效练习，特别是在辛流形上的哈密顿力学主题内。它的提法是恰当的，具有科学依据，并且不包含矛盾或歧义。它要求从第一性原理进行推导，这是验证基本概念的标准方法。\n\n核心任务是确定一个哈密顿函数 $H: \\mathbb{R}^{2n} \\to \\mathbb{R}$，其时间-1 流 $\\varphi_1$ 是平移映射 $\\Phi_c(q, p) = (q, p+c)$，其中 $c \\in \\mathbb{R}^n$ 是一个常向量。流 $\\varphi_t(q_0, p_0) = (q(t), p(t))$ 是微分方程 $\\dot{z}(t) = X_{H}(z(t))$ 在初始条件 $z(0) = (q_0, p_0)$ 下的解。要使时间-1 映射为 $\\Phi_c$，我们必须有 $(q(1), p(1)) = (q_0, p_0+c)$。\n\n在时间区间 $t \\in [0, 1]$ 上，连接初始点 $(q_0, p_0)$ 和终点 $(q_0, p_0+c)$ 的一条简单路径是线性轨迹：\n$$ z(t) = (q(t), p(t)) = (q_0, p_0 + t c) $$\n沿此路径的速度向量场是 $z(t)$ 的时间导数：\n$$ \\dot{z}(t) = \\left(\\frac{d}{dt} q_0, \\frac{d}{dt} (p_0 + t c)\\right) = (0, c) $$\n由于该速度向量是常数（既不依赖于位置 $(q,p)$ 也不依赖于时间 $t$），它在 $\\mathbb{R}^{2n}$ 上定义了一个常向量场。我们提议将其作为哈密顿向量场的候选者：\n$$ X = \\sum_{i=1}^{n} 0 \\cdot \\frac{\\partial}{\\partial q^i} + \\sum_{i=1}^{n} c_i \\frac{\\partial}{\\partial p_i} = \\sum_{i=1}^{n} c_i \\frac{\\partial}{\\partial p_i} $$\n为了验证这是否是某个函数 $H$ 的哈密顿向量场 $X_H$，我们必须检查 1-形式 $\\iota_X \\omega$ 是否为恰当的，正如定义 $\\iota_{X_H}\\omega = dH$ 所要求的那样。根据典范约定，辛形式为 $\\omega = \\sum_{j=1}^{n} dq^j \\wedge dp_j$。我们计算内积：\n$$ \\iota_X \\omega = \\iota_{\\left(\\sum_{i=1}^{n} c_i \\frac{\\partial}{\\partial p_i}\\right)} \\left(\\sum_{j=1}^{n} dq^j \\wedge dp_j\\right) $$\n利用内积的线性和恒等式 $\\iota_V(\\alpha \\wedge \\beta) = (\\iota_V \\alpha)\\beta - \\alpha(\\iota_V \\beta)$（其中 $V$ 是向量场，$\\alpha, \\beta$ 是 1-形式）：\n$$ \\iota_X \\omega = \\sum_{j=1}^{n} \\left[ (\\iota_X dq^j) dp_j - dq^j (\\iota_X dp_j) \\right] $$\n我们计算向量场 $X$ 作用在基 1-形式 $dq^j$ 和 $dp_j$ 上的结果：\n$$ \\iota_X dq^j = dq^j(X) = dq^j\\left(\\sum_{i=1}^{n} c_i \\frac{\\partial}{\\partial p_i}\\right) = \\sum_{i=1}^{n} c_i \\cdot dq^j\\left(\\frac{\\partial}{\\partial p_i}\\right) = \\sum_{i=1}^{n} c_i \\cdot 0 = 0 $$\n$$ \\iota_X dp_j = dp_j(X) = dp_j\\left(\\sum_{i=1}^{n} c_i \\frac{\\partial}{\\partial p_i}\\right) = \\sum_{i=1}^{n} c_i \\cdot dp_j\\left(\\frac{\\partial}{\\partial p_i}\\right) = \\sum_{i=1}^{n} c_i \\delta_{ji} = c_j $$\n将这些标量函数代回 $\\iota_X \\omega$ 的表达式中：\n$$ \\iota_X \\omega = \\sum_{j=1}^{n} \\left[ 0 \\cdot dp_j - c_j dq^j \\right] = -\\sum_{j=1}^{n} c_j dq^j $$\n得到的 1-形式是恰当的，因为它是函数 $H(q,p) = -\\sum_{j=1}^{n} c_j q^j$ 的外微分。\n$$ dH = d\\left(-\\sum_{j=1}^{n} c_j q^j\\right) = -\\sum_{j=1}^{n} c_j dq^j = \\iota_X \\omega $$\n因此，向量场 $X = \\sum_{i=1}^{n} c_i \\frac{\\partial}{\\partial p_i}$ 确实是由哈密顿量 $H(q,p) = -\\sum_{j=1}^{n} c_j q^j$ 生成的哈密顿向量场 $X_H$。\n\n最后，我们确认 $X_H$ 的时间-1 流是 $\\Phi_c$。运动方程为 $\\dot{z}(t) = X_H(z(t))$，在坐标下表示为：\n$$ \\dot{q}^i = 0 $$\n$$ \\dot{p}_i = c_i $$\n从 $t=0$ 时的初始状态 $(q_0, p_0)$ 积分这些方程，我们得到流：\n$$ q^i(t) = q_0^i $$\n$$ p_i(t) = p_{0i} + c_i t $$\n因此，流映射为 $\\varphi_t(q_0, p_0) = (q_0, p_0 + t c)$。在 $t=1$ 时计算：\n$$ \\varphi_1(q_0, p_0) = (q_0, p_0 + c) = \\Phi_c(q_0, p_0) $$\n这证明了 $\\Phi_c$ 是一个哈密顿流的时间-1 映射。由于哈密顿流由辛同胚构成，且 $\\Phi_c$ 是一个微分同胚（其逆为 $\\Phi_{-c}$），因此它是一个哈密顿微分同胚。相关的哈密顿向量场在典范坐标下的表达式即为前面所述的 $X_H$ 的表达式。",
            "answer": "$$\\boxed{\\sum_{i=1}^{n} c_i \\frac{\\partial}{\\partial p_i}}$$"
        },
        {
            "introduction": "掌握了辛变换的生成和性质后，我们便能运用这些工具来解决实际的动力学问题。在分析复杂哈密顿系统的长期行为时，一个极其有力的策略是通过辛坐标变换来简化哈密顿函数，此过程称为正规化。本练习  将指导您运用伯克霍夫正规形（Birkhoff Normal Form）理论，通过构造一个近恒等辛变换，系统性地消除非共振椭圆平衡点附近哈密顿函数中的非本质项。这不仅是高级动力系统理论中的一项核心技能，也展示了辛几何在揭示系统内在对称性和守恒量方面的强大威力。",
            "id": "3769697",
            "problem": "考虑辛向量空间 $\\mathbb{R}^{2n}$，其具有典范坐标 $(q,p) = (q_{1},\\dots,q_{n},p_{1},\\dots,p_{n})$ 和典范辛形式 $\\omega_{\\mathrm{can}} = \\sum_{j=1}^{n} dq_{j} \\wedge dp_{j}$。设 $H:\\mathbb{R}^{2n} \\to \\mathbb{R}$ 是一个在原点有椭圆平衡点的哈密顿量，其泰勒展开以一个正定二次部分开始，后跟三次项：\n$$\nH(q,p) = H_{2}(q,p) + H_{3}(q,p) + H_{\\geq 4}(q,p),\n$$\n其中\n$$\nH_{2}(q,p) = \\frac{1}{2}\\sum_{j=1}^{n} \\omega_{j}\\left(q_{j}^{2} + p_{j}^{2}\\right),\n$$\n且 $\\omega_{j} > 0$，频率向量 $(\\omega_{1},\\dots,\\omega_{n})$ 是有理无关的，即对于任意 $k \\in \\mathbb{Z}^{n}\\setminus\\{0\\}$ 都有 $\\sum_{j=1}^{n} k_{j}\\omega_{j} \\neq 0$。项 $H_{3}(q,p)$ 是 $(q,p)$ 中任意一个总次数为 3 的实齐次多项式，而 $H_{\\geq 4}(q,p)$ 汇集了总次数至少为 4 的项。\n\n仅使用典范辛结构 $\\omega_{\\mathrm{can}}$、相关的泊松括号和哈密顿流，构造一个近恒等辛变换，在给定的非共振条件下，将 $H$ 变换到其在原点附近的伯克霍夫范式 (BNF)，直到三次项。然后，将归一化到三次项的哈密顿量纯粹表示为作用量 $J_{j} = \\frac{1}{2}\\left(q_{j}^{2} + p_{j}^{2}\\right)$ 的函数。\n\n你的最终答案必须是截断到三次项的归一化哈密顿量 $H_{\\mathrm{BNF}}$，写成一个关于变量 $J_{1},\\dots,J_{n}$ 和参数 $\\omega_{1},\\dots,\\omega_{n}$ 的单一闭式解析表达式。不需要数值近似。",
            "solution": "用户希望找到给定哈密顿量截至三次项的伯克霍夫范式 (BNF)。\n\n**1. 问题验证**\n\n*   **步骤1：提取已知条件**\n    *   辛空间：$\\mathbb{R}^{2n}$，坐标为 $(q,p) = (q_1, \\dots, q_n, p_1, \\dots, p_n)$。\n    *   辛形式：$\\omega_{\\mathrm{can}} = \\sum_{j=1}^{n} dq_{j} \\wedge dp_{j}$。\n    *   哈密顿量：$H(q,p) = H_2(q,p) + H_3(q,p) + H_{\\geq 4}(q,p)$。\n    *   二次部分：$H_2(q,p) = \\frac{1}{2}\\sum_{j=1}^{n} \\omega_{j}(q_{j}^{2} + p_{j}^{2})$，频率 $\\omega_j > 0$。\n    *   三次部分：$H_3(q,p)$ 是一个总次数为 3 的实齐次多项式。\n    *   高阶部分：$H_{\\geq 4}(q,p)$ 包含总次数至少为 4 的项。\n    *   非共振条件：对于任意 $k \\in \\mathbb{Z}^{n}\\setminus\\{0\\}$，有 $\\sum_{j=1}^{n} k_j \\omega_j \\neq 0$。\n    *   目标：求出 $H$ 截断到三次项的伯克霍夫范式，并表示为作用量 $J_j = \\frac{1}{2}(q_j^2 + p_j^2)$ 的函数。\n\n*   **步骤2：使用提取的已知条件进行验证**\n    *   **科学依据：** 这个问题是哈密顿微扰理论和范式理论中的一个标准练习，这是经典力学和动力系统的基石。所有概念都是公认的。\n    *   **良定性：** 问题陈述清晰。非共振条件正是保证在微扰理论的每一阶上伯克霍夫范式存在且唯一的必要条件。目标具体且可实现。\n    *   **客观性：** 问题以精确的数学语言表述，没有歧义或主观性。\n\n*   **步骤3：结论与行动**\n    *   此问题是**有效的**。其科学前提合理，表述完整无歧义，并且是数学物理中的一个良定问题。我将继续进行求解。\n\n**2. 求解**\n\n目标是找到一个近恒等典范变换 $\\Phi$，通过消除尽可能多的项，将哈密顿量 $H$ 变换为一个更简单的形式，即伯克霍夫范式 (BNF)。如果简化后的哈密顿量 $K = H \\circ \\Phi$ 与二次部分 $H_2$ 泊松对易，即 $\\{K, H_2\\} = 0$，则称其处于范式中。\n\n变换 $\\Phi$ 可被构造为由哈密顿函数 $S$ 生成的哈密顿向量场 $X_S$ 的时间-1流。变换后的哈密顿量 $K$ 由李级数展开给出：\n$$\nK = \\exp(L_S)H = H + \\{S, H\\} + \\frac{1}{2!}\\{S, \\{S, H\\}\\} + \\dots\n$$\n其中 $L_S(\\cdot) = \\{S, \\cdot\\}$ 是与 $S$ 相关的李导数，$\\{f, g\\} = \\sum_{j=1}^{n} (\\frac{\\partial f}{\\partial q_j}\\frac{\\partial g}{\\partial p_j} - \\frac{\\partial f}{\\partial p_j}\\frac{\\partial g}{\\partial q_j})$ 是典范泊松括号。\n\n我们将 $H$ 和 $S$ 都展开为齐次多项式：$H = H_2 + H_3 + \\dots$，并寻求一个生成函数 $S = S_3 + S_4 + \\dots$，其中 $S_k$ 是 $k$ 次齐次多项式。变换后的哈密顿量为 $K = K_2 + K_3 + \\dots$。通过令同次项相等，我们有：\n$$ K_2 = H_2 $$\n$$ K_3 = H_3 + \\{S_3, H_2\\} $$\n目标是选择生成函数 $S_3$ 以尽可能简化 $K_3$。“简化”意味着使 $K_3$ 与 $H_2$ 对易。我们想要满足的方程是 $\\{K_3, H_2\\} = 0$。用于求解 $S_3$ 的方程被称为同调方程：\n$$ \\{H_2, S_3\\} = H_3 - K_3 $$\n这里，$K_3$ 是 $H_3$ 的“共振”部分，即 $H_3$ 在算子 $L_{H_2}(\\cdot) = \\{\\cdot, H_2\\}$ 的核上的投影，而 $H_3 - K_3$ 是“非共振”部分，它位于 $L_{H_2}$ 的像中。频率 $\\omega_j$ 的非共振条件确保了算子 $L_{H_2}$ 在其像上是可逆的，从而保证了解 $S_3$ 的存在。\n\n我们来刻画 $L_{H_2}$ 的核。如果一个函数 $f(q,p)$ 位于核中，则有 $\\{f, H_2\\} = 0$。\n由 $H_2$ 生成的哈密顿流是一组 $n$ 个非耦合的谐振子。在作用量-角度坐标 $(J_j, \\theta_j)$（定义为 $q_j = \\sqrt{2J_j/\\omega_j'} \\cos\\theta_j$ 和 $p_j = \\sqrt{2J_j\\omega_j'} \\sin\\theta_j$，其中 $\\omega'_j$ 是某个缩放因子，为简单起见可取为 $\\omega_j$，尽管问题中 $J_j$ 的定义是基于坐标的）下，$H_2$ 变成一个仅依赖于作用量的函数：$H_2 = \\sum_{j=1}^n \\omega_j J_j$。问题中使用的 $J_j = \\frac{1}{2}(q_j^2+p_j^2)$ 已经处于所期望的形式。在任何典范坐标系中，泊松括号的形式为 $\\{f, H_2\\} = \\sum_j \\omega_j \\frac{\\partial f}{\\partial \\theta_j}$。要使其为零，$f$ 必须与角度变量 $\\theta_j$ 无关。\n对于 $k \\in \\mathbb{Z}^n \\setminus \\{0\\}$，非共振条件 $\\sum_j k_j \\omega_j \\neq 0$ 的关键推论是，沿着 $H_2$ 的流为常数的唯一解析函数是仅依赖于作用量 $J_j = \\frac{1}{2}(q_j^2 + p_j^2)$ 的函数。\n因此，任何处于范式中的函数 $f$（即 $\\{f, H_2\\}=0$）必须仅是作用量 $J_1, \\dots, J_n$ 的函数。\n\n现在我们分析三次项 $K_3$。\n1.  作为 $H_3$ 的范式，$K_3$ 必须是变量 $(q_1, \\dots, q_n, p_1, \\dots, p_n)$ 的一个 3 次齐次多项式。这是因为定义核投影的平均化过程保持了齐次性的次数。\n2.  要使 $K_3$ 处于范式中，它必须是作用量 $J_j$ 的函数：$K_3 = F(J_1, \\dots, J_n)$，其中 $F$ 是某个函数。\n\n让我们检查一个作用量函数的结构。每个作用量变量 $J_j = \\frac{1}{2}(q_j^2 + p_j^2)$ 是一个 2 次齐次多项式。任何关于变量 $J_1, \\dots, J_n$ 的多项式函数都是形如 $c \\cdot J_1^{k_1} J_2^{k_2} \\cdots J_n^{k_n}$ 的项之和。这样一个项作为 $(q,p)$ 的多项式的次数是 $2k_1 + 2k_2 + \\dots + 2k_n = 2\\sum_j k_j$，这总是一个偶数。\n因此，任何可以写成作用量 $J_j$ 函数的 $(q,p)$ 多项式，必须是一个仅由偶次齐次项组成的多项式。换言之，在宇称变换 $(q,p) \\mapsto (-q, -p)$ 下，它必须是一个偶函数。\n\n我们得到了一个矛盾。$K_3$ 必须是一个 3 次（奇数次）齐次多项式，但它又必须能表示为作用量 $J_j$ 的函数，这要求它是一个偶次多项式。唯一能同时满足这两个条件的的多项式是零多项式。\n因此，我们必须有 $K_3 = 0$。\n\n这意味着哈密顿量的整个三次部分 $H_3$ 是非共振的，可以通过由 $S_3$ 生成的近恒等辛变换来消除，其中 $S_3$ 是方程 $\\{H_2, S_3\\} = H_3$ 的解。非共振条件保证了这样一个 $S_3$ （在与核正交的多项式空间中）的存在性和唯一性。\n\n因此，截断到三次项的归一化哈密顿量 $K_{\\le 3} = K_2 + K_3$ 为：\n$$\nK_{\\le 3} = H_2 + 0 = \\frac{1}{2}\\sum_{j=1}^{n} \\omega_{j}\\left(q_{j}^{2} + p_{j}^{2}\\right)\n$$\n用给定的作用量变量 $J_j = \\frac{1}{2}(q_j^2 + p_j^2)$ 来表示，我们得到：\n$$\nH_{\\mathrm{BNF}, \\le 3} = \\sum_{j=1}^{n} \\omega_{j} J_{j}\n$$\n截断到三次项的伯克霍夫范式只包含原始的二次项，没有三次部分。",
            "answer": "$$\n\\boxed{\\sum_{j=1}^{n} \\omega_{j} J_{j}}\n$$"
        }
    ]
}