{
    "hands_on_practices": [
        {
            "introduction": "典范变换是保持哈密顿方程结构不变的坐标变换，使其成为高等力学的基石。本练习  深入探讨了构造这些变换的最有力方法：使用母函数。你将看到一个简单的函数 $S(q,Q)$ 如何巧妙地编码一个复杂的变换，并揭示这个实用工具与拉格朗日（Lagrangian）子流形这一抽象几何概念之间的深刻联系。",
            "id": "3745610",
            "problem": "考虑余切丛 $T^{*}\\mathbb{R}_{q}$ 和 $T^{*}\\mathbb{R}_{Q}$，其正则坐标分别为 $(q,p)$ 和 $(Q,P)$。为积流形 $M = T^{*}\\mathbb{R}_{q} \\times T^{*}\\mathbb{R}_{Q}$ 配备辛形式 $\\omega = \\mathrm{d}q \\wedge \\mathrm{d}p - \\mathrm{d}Q \\wedge \\mathrm{d}P$ 和正则1-形式 $\\theta = p\\,\\mathrm{d}q - P\\,\\mathrm{d}Q$。如果一个子流形 $L \\subset M$ 是最大迷向的，即 $\\omega|_{L} = 0$ 且 $\\dim L = \\frac{1}{2}\\dim M$，则称其为拉格朗日子流形。设 $S(q,Q)$ 是 $\\mathbb{R} \\times \\mathbb{R}$ 上的一个光滑函数，称为母函数。\n\n从正则1-形式和辛形式的定义，以及拉格朗日子流形的判据出发，证明母函数 $S(q,Q)$ 如何定义一个拉格朗日子流形 $L_{S} \\subset M$，并通过将 $\\theta$ 在 $L_{S}$ 上的拉回是恰当1-形式 $\\mathrm{d}S$ 这一条件，来编码 $(q,p)$ 和 $(Q,P)$ 之间的一个正则变换。解释为什么 $S$ 的混合二阶导数的非退化条件能保证从 $L_S$ 的投影定义了 $(q,p)$ 和 $(Q,P)$ 之间的一个局部微分同胚，从而是一个正则变换。\n\n然后，对于特定的选择\n$$\nS(q,Q) = \\frac{1}{2} a\\,q^{2} + b\\,q\\,Q + \\frac{1}{2} c\\,Q^{2},\n$$\n（其中常数 $a, b, c \\in \\mathbb{R}$ 且 $b \\neq 0$）以及单自由度哈密顿量\n$$\nH(q,p) = \\frac{p^{2}}{2 m} + \\frac{1}{2} k\\,q^{2},\n$$\n（其中常数 $m0$ 且 $k0$），通过由 $S$ 生成的正则变换将 $q$ 和 $p$ 用 $(Q,P)$ 表示，计算变换后的哈密顿量 $K(Q,P)$。以 $Q$, $P$ 和常数 $a$, $b$, $c$, $m$, $k$ 的单个闭式解析表达式的形式给出最终答案。不需要进行数值计算，最终表达式中不应包含单位。",
            "solution": "该问题需要进行验证。\n\n### 步骤1：提取已知条件\n-   积流形：$M = T^{*}\\mathbb{R}_{q} \\times T^{*}\\mathbb{R}_{Q}$，在 $T^{*}\\mathbb{R}_{q}$ 上的坐标为 $(q,p)$，在 $T^{*}\\mathbb{R}_{Q}$ 上的坐标为 $(Q,P)$。$M$ 上的坐标为 $(q,p,Q,P)$。\n-   $M$ 上的辛形式：$\\omega = \\mathrm{d}q \\wedge \\mathrm{d}p - \\mathrm{d}Q \\wedge \\mathrm{d}P$。\n-   $M$ 上的正则1-形式：$\\theta = p\\,\\mathrm{d}q - P\\,\\mathrm{d}Q$。\n-   拉格朗日子流形 $L \\subset M$：一个子流形，满足 $\\omega|_{L} = 0$ 且 $\\dim L = \\frac{1}{2}\\dim M$。\n-   母函数：$\\mathbb{R} \\times \\mathbb{R}$ 上的一个光滑函数 $S(q,Q)$。\n-   定义拉格朗日子流形 $L_S$ 的条件：$\\theta$ 在 $L_S$ 上的拉回，记为 $\\iota^*\\theta$，是恰当1-形式 $\\mathrm{d}S$。即 $\\iota^*\\theta = \\mathrm{d}S$。\n-   特定母函数：$S(q,Q) = \\frac{1}{2} a\\,q^{2} + b\\,q\\,Q + \\frac{1}{2} c\\,Q^{2}$，其中常数 $a, b, c \\in \\mathbb{R}$ 且 $b \\neq 0$。\n-   哈密顿量：$H(q,p) = \\frac{p^{2}}{2 m} + \\frac{1}{2} k\\,q^{2}$，其中常数 $m0$ 且 $k0$。\n-   任务：\n    1.  证明 $S(q,Q)$ 如何定义一个拉格朗日子流形 $L_{S}$ 和一个正则变换。\n    2.  解释 $S$ 混合二阶导数的非退化条件的作用。\n    3.  对于给定的 $S(q,Q)$ 和 $H(q,p)$，计算变换后的哈密顿量 $K(Q,P)$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在几何力学和辛几何的框架内是良定义的。\n-   **科学依据：** 余切丛、辛形式、正则1-形式、拉格朗日子流形和母函数的定义都是标准的。从类型为 $F_1(q,Q)$（此处记为 $S(q,Q)$）的母函数构造正则变换是哈密顿力学的基石。所给出的哈密顿量是一维简谐振子，一个基本的物理系统。\n-   **适定性：** 问题结构清晰，首先要求进行标准推导，然后进行具体计算。它提供了所有必要的信息。条件 $b \\neq 0$ 是保证变换为局部微分同胚所需的非退化条件，这使得问题是适定的。\n-   **客观性：** 语言是形式化的、数学的，没有歧义或主观陈述。\n-   **内部一致性：** 给定的1-形式 $\\theta$ 和辛形式 $\\omega$ 之间的关系是一致的。我们检查 $\\theta$ 的外微分：$\\mathrm{d}\\theta = \\mathrm{d}(p\\,\\mathrm{d}q - P\\,\\mathrm{d}Q) = \\mathrm{d}p \\wedge \\mathrm{d}q - \\mathrm{d}P \\wedge \\mathrm{d}Q$。所给的辛形式为 $\\omega = \\mathrm{d}q \\wedge \\mathrm{d}p - \\mathrm{d}Q \\wedge \\mathrm{d}P = -(\\mathrm{d}p \\wedge \\mathrm{d}q) + \\mathrm{d}P \\wedge \\mathrm{d}Q = -(\\mathrm{d}\\theta)$。一个恰当的、非退化的2-形式是一个有效的辛形式，因此定义是一致的。\n\n### 步骤3：结论与行动\n该问题是有效的。将提供完整解答。\n\n一个母函数 $S(q,Q)$ 定义了积相空间 $M = T^{*}\\mathbb{R}_{q} \\times T^{*}\\mathbb{R}_{Q}$ 的一个子流形。我们可以用 $(q,Q)$ 作为这个子流形的坐标，记为 $L_S$。$L_S$ 到 $M$ 的嵌入由以下条件定义：1-形式 $\\theta = p\\,\\mathrm{d}q - P\\,\\mathrm{d}Q$ 到 $L_S$ 的拉回是 $S$ 的外微分。设 $\\iota: L_S \\to M$ 是包含映射，则条件为 $\\iota^*\\theta = \\mathrm{d}S$。\n\n在 $L_S$ 的坐标 $(q,Q)$ 中，$S(q,Q)$ 的外微分是 $\\mathrm{d}S = \\frac{\\partial S}{\\partial q}\\mathrm{d}q + \\frac{\\partial S}{\\partial Q}\\mathrm{d}Q$。拉回的1-形式 $\\iota^*\\theta$ 只是 $\\theta$ 限制在子流形上，其中 $p$ 和 $P$ 被视为 $(q,Q)$ 的函数。条件 $\\iota^*\\theta = \\mathrm{d}S$ 变为：\n$$\np\\,\\mathrm{d}q - P\\,\\mathrm{d}Q = \\frac{\\partial S}{\\partial q}\\mathrm{d}q + \\frac{\\partial S}{\\partial Q}\\mathrm{d}Q\n$$\n通过比较基1-形式 $\\mathrm{d}q$ 和 $\\mathrm{d}Q$ 的系数，我们得到定义子流形 $L_S$ 的方程：\n$$\np = \\frac{\\partial S}{\\partial q}(q,Q) \\quad \\text{和} \\quad P = -\\frac{\\partial S}{\\partial Q}(q,Q)\n$$\n这两个方程在4维相空间 $M$ 中定义了一个2维曲面 $L_S$，因此 $\\dim L_S = 2 = \\frac{1}{2}\\dim M$。\n\n为了证明 $L_S$ 是一个拉格朗日子流形，我们必须验证辛形式限制在其上时为零，即 $\\omega|_{L_S} = 0$。我们计算 $\\omega = \\mathrm{d}q \\wedge \\mathrm{d}p - \\mathrm{d}Q \\wedge \\mathrm{d}P$ 到 $L_S$ 的拉回。在 $L_S$ 上，我们有 $p$ 和 $P$ 关于 $\\mathrm{d}q$ 和 $\\mathrm{d}Q$ 的微分：\n$$\n\\mathrm{d}p = \\frac{\\partial^2 S}{\\partial q^2}\\mathrm{d}q + \\frac{\\partial^2 S}{\\partial Q\\partial q}\\mathrm{d}Q\n$$\n$$\n\\mathrm{d}P = -\\frac{\\partial^2 S}{\\partial q\\partial Q}\\mathrm{d}q - \\frac{\\partial^2 S}{\\partial Q^2}\\mathrm{d}Q\n$$\n将这些代入 $\\omega$ 的表达式中：\n$$\n\\omega|_{L_S} = \\mathrm{d}q \\wedge \\left(\\frac{\\partial^2 S}{\\partial q^2}\\mathrm{d}q + \\frac{\\partial^2 S}{\\partial Q\\partial q}\\mathrm{d}Q\\right) - \\mathrm{d}Q \\wedge \\left(-\\frac{\\partial^2 S}{\\partial q\\partial Q}\\mathrm{d}q - \\frac{\\partial^2 S}{\\partial Q^2}\\mathrm{d}Q\\right)\n$$\n利用楔积的性质，$\\mathrm{d}q \\wedge \\mathrm{d}q = 0$ 和 $\\mathrm{d}Q \\wedge \\mathrm{d}q = - \\mathrm{d}q \\wedge \\mathrm{d}Q$：\n$$\n\\omega|_{L_S} = \\frac{\\partial^2 S}{\\partial Q\\partial q}(\\mathrm{d}q \\wedge \\mathrm{d}Q) + \\frac{\\partial^2 S}{\\partial q\\partial Q}(\\mathrm{d}Q \\wedge \\mathrm{d}q) = \\left(\\frac{\\partial^2 S}{\\partial Q\\partial q} - \\frac{\\partial^2 S}{\\partial q\\partial Q}\\right) \\mathrm{d}q \\wedge \\mathrm{d}Q\n$$\n根据关于光滑函数 $S$ 混合偏导数相等的克莱罗定理，括号中的项为零。因此，$\\omega|_{L_S} = 0$，证实了 $L_S$ 是一个拉格朗日子流形。由 $L_S$ 上的关系定义的 $(q,p)$ 和 $(Q,P)$ 之间的映射是一个正则变换。\n\n混合二阶导数的非退化条件 $\\frac{\\partial^2 S}{\\partial q \\partial Q} \\neq 0$ 确保了该变换是一个局部微分同胚。为了将 $(Q,P)$ 表示为 $(q,p)$ 的函数，我们需要求解方程组。从 $p = \\frac{\\partial S}{\\partial q}(q,Q)$ 出发，我们希望解出 $Q=Q(q,p)$。根据隐函数定理，如果 $\\frac{\\partial}{\\partial Q} \\left( p - \\frac{\\partial S}{\\partial q} \\right) \\neq 0$，即 $-\\frac{\\partial^2 S}{\\partial Q \\partial q} \\neq 0$，则这是局部可能的。类似地，要将 $(q,p)$ 表示为 $(Q,P)$ 的函数，我们需要从 $P = -\\frac{\\partial S}{\\partial Q}(q,Q)$ 解出 $q=q(Q,P)$。如果 $\\frac{\\partial}{\\partial q} \\left( P + \\frac{\\partial S}{\\partial Q} \\right) \\neq 0$，即 $\\frac{\\partial^2 S}{\\partial q \\partial Q} \\neq 0$，则这是可能的。这个条件保证了变换是局部可逆的，从而在新旧正则坐标之间建立了一一对应关系。\n\n现在，我们将此应用于 $S(q,Q) = \\frac{1}{2} a\\,q^{2} + b\\,q\\,Q + \\frac{1}{2} c\\,Q^{2}$ 的特定情况，其中 $b \\neq 0$。变换方程为：\n$$\np = \\frac{\\partial S}{\\partial q} = a\\,q + b\\,Q\n$$\n$$\nP = -\\frac{\\partial S}{\\partial Q} = -(b\\,q + c\\,Q) = -b\\,q - c\\,Q\n$$\n非退化条件为 $\\frac{\\partial^2 S}{\\partial q \\partial Q} = b \\neq 0$，这是已知的。\n为了求出变换后的哈密顿量 $K(Q,P) = H(q(Q,P), p(Q,P))$，我们必须将 $q$ 和 $p$ 用 $Q$ 和 $P$ 表示。从第二个方程：\n$$\nb\\,q = -P - c\\,Q \\implies q = -\\frac{1}{b}(P + c\\,Q)\n$$\n将这个 $q$ 的表达式代入第一个方程求 $p$：\n$$\np = a\\left(-\\frac{1}{b}(P + c\\,Q)\\right) + b\\,Q = -\\frac{a}{b}P - \\frac{ac}{b}Q + b\\,Q = \\left(b - \\frac{ac}{b}\\right)Q - \\frac{a}{b}P = \\frac{b^2 - ac}{b}Q - \\frac{a}{b}P\n$$\n我们得到逆变换：\n$$\nq(Q,P) = -\\frac{c}{b}Q - \\frac{1}{b}P\n$$\n$$\np(Q,P) = \\frac{b^2 - ac}{b}Q - \\frac{a}{b}P\n$$\n现在我们将这些代入哈密顿量 $H(q,p) = \\frac{p^{2}}{2 m} + \\frac{k}{2} q^{2}$：\n$$\nK(Q,P) = \\frac{1}{2m}\\left(\\frac{b^2 - ac}{b}Q - \\frac{a}{b}P\\right)^2 + \\frac{k}{2}\\left(-\\frac{c}{b}Q - \\frac{1}{b}P\\right)^2\n$$\n展开平方项：\n$$\nK(Q,P) = \\frac{1}{2mb^2}\\left( (b^2-ac)^2 Q^2 - 2a(b^2-ac)PQ + a^2 P^2 \\right) + \\frac{k}{2b^2}\\left( c^2 Q^2 + 2cPQ + P^2 \\right)\n$$\n按 $Q$ 和 $P$ 的幂次对各项进行分组：\n$$\nK(Q,P) = \\left( \\frac{(b^2-ac)^2}{2mb^2} + \\frac{kc^2}{2b^2} \\right)Q^2 + \\left( \\frac{a^2}{2mb^2} + \\frac{k}{2b^2} \\right)P^2 + \\left( \\frac{2kc}{2b^2} - \\frac{2a(b^2-ac)}{2mb^2} \\right)PQ\n$$\n简化表达式得到最终变换后的哈密顿量：\n$$\nK(Q,P) = \\frac{1}{2b^2} \\left[ \\left(\\frac{(b^2-ac)^2}{m} + kc^2\\right)Q^2 + \\left(\\frac{a^2}{m} + k\\right)P^2 + 2\\left(kc - \\frac{a(b^2-ac)}{m}\\right)PQ \\right]\n$$\n这就是新哈密顿量 $K(Q,P)$ 的闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{2b^2} \\left[ \\left(\\frac{(b^2-ac)^2}{m} + kc^2\\right)Q^2 + \\left(\\frac{a^2}{m} + k\\right)P^2 + 2\\left(kc - \\frac{a(b^2-ac)}{m}\\right)PQ \\right]}\n$$"
        },
        {
            "introduction": "虽然母函数提供了变换的一般机制，但其主要目标之一是找到能最大限度简化动力学的坐标。本练习  将引导你完成一个经典范例：求解谐振子的作用量-角度变量。通过计算代表相空间轨道面积的作用量变量 $I$，你将把哈密顿量变换为一个仅依赖于 $I$ 的函数，从而揭示该系统内在的简洁性。",
            "id": "3745627",
            "problem": "考虑一个质量为 $m0$、角频率为 $\\omega0$ 的一维谐振子，其哈密顿量为 $$H(q,p)=\\dfrac{p^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}q^{2}$$。对于固定的能级 $E0$，其运动是周期性的。仅使用哈密顿力学的基本定义，即哈密顿方程 $\\dot{q}=\\dfrac{\\partial H}{\\partial p}$ 和 $\\dot{p}=-\\dfrac{\\partial H}{\\partial q}$，以及一个自由度系统的作用量变量的定义，\n$$\nI=\\dfrac{1}{2\\pi}\\oint p\\,\\mathrm{d}q,\n$$\n其中积分是沿着能量壳层 $H(q,p)=E$ 上的闭合轨道进行一周，计算 $I$ 作为 $E$、$m$ 和 $\\omega$ 的函数。然后，将哈密顿量完全表示为 $I$ 和 $\\omega$ 的函数。将两个结果按 $(I(E,m,\\omega),\\,H(I,\\omega))$ 的顺序表示为一个包含两个分量的行向量，并将最终答案表示为闭式解析表达式。不要使用任何数值近似。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- **系统：** $1$ 维谐振子。\n- **参数：** 质量 $m0$，角频率 $\\omega0$。\n- **哈密顿量：** $H(q,p)=\\dfrac{p^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}q^{2}$。\n- **能级：** 一个固定的能量 $E0$。\n- **运动方程：** 哈密顿方程，$\\dot{q}=\\dfrac{\\partial H}{\\partial p}$ 和 $\\dot{p}=-\\dfrac{\\partial H}{\\partial q}$。\n- **定义：** 作用量变量由 $I=\\dfrac{1}{2\\pi}\\oint p\\,\\mathrm{d}q$ 给出，其中积分是沿着对应于能量 $E$ 的闭合轨道进行的。\n- **目标1：** 计算 $I$ 作为 $E$、$m$ 和 $\\omega$ 的函数。\n- **目标2：** 将哈密顿量 $H$ 表示为 $I$ 和 $\\omega$ 的函数。\n- **输出格式：** 一个行向量 $(I(E,m,\\omega), H(I,\\omega))$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在科学上和数学上都是合理的。它在成熟的哈密顿力学框架内描述了简谐振子，这是物理学中的一个基本模型。所提供的哈密顿量是该系统的标准形式。作用量变量的定义是正确的。所有参数（$m, \\omega, E$）都被限制为正值，确保了一个物理上有意义的振荡系统，在相空间中具有非平凡的闭合轨道。该问题是自洽、明确且适定的，要求在经典力学中进行与作用量-角度变量相关的标准推导。它没有任何科学不准确性、矛盾或主观因素。\n\n**第三步：结论与行动**\n该问题有效。将提供解答。\n\n### 解答\n\n出发点是一维谐振子的哈密顿量，给定为：\n$$\nH(q,p) = \\dfrac{p^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}q^{2}\n$$\n系统的运动根据哈密顿方程 $\\dot{q}=\\dfrac{\\partial H}{\\partial p}$ 和 $\\dot{p}=-\\dfrac{\\partial H}{\\partial q}$ 演化。对于像这样的保守系统，哈密顿量是一个运动常数，等于总能量 $E$。由正则坐标 $(q,p)$ 参数化的相空间轨迹位于哈密顿量的等值集上。对于固定的能量 $E0$，轨迹是由以下方程定义的闭合曲线：\n$$\n\\dfrac{p^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}q^{2} = E\n$$\n这是在 $(q,p)$ 相平面中以原点为中心的椭圆方程。为了确定其几何形状，我们可以将其写成标准形式 $\\dfrac{x^2}{a^2} + \\dfrac{y^2}{b^2} = 1$：\n$$\n\\dfrac{q^2}{\\left(\\dfrac{2E}{m\\omega^{2}}\\right)} + \\dfrac{p^2}{2mE} = 1\n$$\n这确定了椭圆半轴的平方。沿 $q$ 轴的半轴是 $q_{\\text{max}} = \\sqrt{\\dfrac{2E}{m\\omega^2}}$，沿 $p$ 轴的半轴是 $p_{\\text{max}} = \\sqrt{2mE}$。\n\n第一个目标是计算作用量变量 $I$，其定义为：\n$$\nI = \\dfrac{1}{2\\pi}\\oint p\\,\\mathrm{d}q\n$$\n积分 $\\oint p\\,\\mathrm{d}q$ 代表相空间中闭合轨道所包围的面积。对于椭圆路径，该面积由公式 $\\mathcal{A} = \\pi \\times (q \\text{ 轴上的半轴}) \\times (p \\text{ 轴上的半轴})$ 给出。\n使用上面确定的半轴，面积为：\n$$\n\\mathcal{A} = \\oint p\\,\\mathrm{d}q = \\pi \\left( \\sqrt{\\dfrac{2E}{m\\omega^2}} \\right) \\left( \\sqrt{2mE} \\right)\n$$\n简化此表达式，我们得到：\n$$\n\\mathcal{A} = \\pi \\sqrt{\\left(\\dfrac{2E}{m\\omega^2}\\right)(2mE)} = \\pi \\sqrt{\\dfrac{4mE^2}{m\\omega^2}} = \\pi \\sqrt{\\dfrac{4E^2}{\\omega^2}}\n$$\n由于 $E0$ 且 $\\omega0$，我们可以开平方根得到：\n$$\n\\mathcal{A} = \\pi \\dfrac{2E}{\\omega}\n$$\n现在，我们将这个面积代回作用量变量 $I$ 的定义中：\n$$\nI = \\dfrac{1}{2\\pi} \\mathcal{A} = \\dfrac{1}{2\\pi} \\left( \\pi \\dfrac{2E}{\\omega} \\right)\n$$\n这简化为第一个要求的结果，即作用量变量作为能量的函数：\n$$\nI(E, \\omega) = \\dfrac{E}{\\omega}\n$$\n值得注意的是，作用量变量取决于能量 $E$ 和频率 $\\omega$，但与质量 $m$ 无关。\n\n第二个目标是将哈密顿量 $H$ 表示为作用量变量 $I$ 和 $\\omega$ 的函数。根据上面推导的关系，我们可以将能量 $E$ 表示为 $I$ 和 $\\omega$ 的形式：\n$$\nE = I \\omega\n$$\n由于哈密顿函数 $H(q,p)$ 在任何轨迹上的值都是该轨迹的恒定能量 $E$，我们可以用新坐标 $I$ 来表示哈密顿量。这就是向作用量-角度坐标变换的本质。因此，当用作用量 $I$ 表示时，哈密顿函数为：\n$$\nH(I, \\omega) = I\\omega\n$$\n这个结果表明，在作用量-角度坐标系中，谐振子的哈密顿量线性依赖于作用量变量，这意味着运动频率 $\\dfrac{\\partial H}{\\partial I} = \\omega$ 是一个常数，且与能量无关，这是简谐振子的一个定义性特征。\n\n两个要求的结果是 $I(E,m,\\omega) = \\dfrac{E}{\\omega}$ 和 $H(I,\\omega) = I\\omega$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{E}{\\omega}  I\\omega \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个性质良好的哈密顿系统的解通常在所有时间上都存在。然而，这一点并非必然。本练习  挑战你通过构建一个其流是“不完备”的光滑哈密顿量来探索动力学系统的这一关键方面。你将找到一个显式解，其中粒子在有限时间内逃逸至无穷远，这为局部解的存在性与其全局行为之间的重要区别提供了一个具体的例证。",
            "id": "3745613",
            "problem": "考虑带有全局坐标 $(q,p)$ 和典范辛形式 $\\omega = dq \\wedge dp$ 的 $\\mathbb{R}^2$。与光滑函数 $H:\\mathbb{R}^2 \\to \\mathbb{R}$ 相关联的哈密顿向量场 $X_H$ 由方程 $i_{X_H}\\omega = dH$ 定义，其中 $i_{X_H}$ 表示内积，$dH$ 是 $H$ 的微分。哈密顿方程是 $X_H$ 的积分曲线的坐标表达式。\n\n在 $\\mathbb{R}^2$ 上显式地构造一个光滑的哈密顿量 $H(q,p)$，使得其产生的哈密顿流在正向时间上是不完备的，因为某些轨迹在有限时间内达到 $|q|=\\infty$。从定义 $i_{X_H}\\omega = dH$ 出发，推导出相应的哈密顿方程，对于初始数据 $(q(0),p(0))=(q_0,p_0)$（其中 $q_00$）精确求解这些方程，并确定该解的最大正向存在时间 $T_+(q_0,p_0)$。使用向量场完备性的定义，解释为什么该流不是完备的。\n\n您的最终答案必须是 $T_+(q_0,p_0)$ 的单一闭式表达式，不带单位。无需四舍五入。",
            "solution": "用户希望在 $\\mathbb{R}^2$ 上构造一个光滑的哈密顿量，其流是不完备的，且轨迹在有限时间内达到 $|q|=\\infty$。我们必须为这个系统推导并求解哈密顿方程，并确定给定初始条件下的最大正向存在时间。\n\n首先，我们验证问题。该问题设置在辛流形上的哈密顿力学的标准框架内。使用的所有术语——辛形式、哈密顿向量场、内积、流的完备性——在微分几何和力学中都是标准的且定义明确。任务是构造并分析一个展示已知现象（有限时间逃逸）的具体例子，这是一个适定的数学问题。没有科学或逻辑上的矛盾。该问题是有效的。\n\n我们开始构造解。设相空间为带有全局坐标 $(q,p)$ 的 $\\mathbb{R}^2$。典范辛形式为 $\\omega = dq \\wedge dp$。我们需要选择一个光滑的哈密顿函数 $H(q,p)$，使得其哈密顿向量场 $X_H$ 的某些积分曲线在有限时间内逃逸到无穷远。一个能引起 $q$ 坐标快速增长的简单选择是 $H(q,p) = q^2 p$。这个函数是关于 $q$ 和 $p$ 的多项式，因此在整个 $\\mathbb{R}^2$ 上是光滑的（$\\mathcal{C}^\\infty$）。\n\n接下来，我们从基本定义 $i_{X_H}\\omega = dH$ 推导哈密顿方程。\n设哈密顿向量场在坐标中写作 $X_H = A(q,p)\\frac{\\partial}{\\partial q} + B(q,p)\\frac{\\partial}{\\partial p}$。$X_H$ 与 $\\omega$ 的内积是：\n$$i_{X_H}\\omega = i_{A\\frac{\\partial}{\\partial q} + B\\frac{\\partial}{\\partial p}}(dq \\wedge dp)$$\n$$i_{X_H}\\omega = A \\cdot i_{\\frac{\\partial}{\\partial q}}(dq \\wedge dp) + B \\cdot i_{\\frac{\\partial}{\\partial p}}(dq \\wedge dp)$$\n使用性质 $i_V( \\alpha \\wedge \\beta) = (i_V \\alpha) \\wedge \\beta - \\alpha \\wedge (i_V \\beta)$，并知道 $i_{\\frac{\\partial}{\\partial q}}dq=1$, $i_{\\frac{\\partial}{\\partial q}}dp=0$, $i_{\\frac{\\partial}{\\partial p}}dq=0$, $i_{\\frac{\\partial}{\\partial p}}dp=1$：\n$$i_{\\frac{\\partial}{\\partial q}}(dq \\wedge dp) = (i_{\\frac{\\partial}{\\partial q}} dq) \\wedge dp - dq \\wedge (i_{\\frac{\\partial}{\\partial q}} dp) = 1 \\wedge dp - dq \\wedge 0 = dp$$\n$$i_{\\frac{\\partial}{\\partial p}}(dq \\wedge dp) = (i_{\\frac{\\partial}{\\partial p}} dq) \\wedge dp - dq \\wedge (i_{\\frac{\\partial}{\\partial p}} dp) = 0 \\wedge dp - dq \\wedge 1 = -dq$$\n将这些代回，我们得到：\n$$i_{X_H}\\omega = A \\cdot dp + B \\cdot (-dq) = -B dq + A dp$$\n哈密顿量 $H$ 的外微分是：\n$$dH = \\frac{\\partial H}{\\partial q} dq + \\frac{\\partial H}{\\partial p} dp$$\n令两个表达式相等，$i_{X_H}\\omega = dH$：\n$$-B dq + A dp = \\frac{\\partial H}{\\partial q} dq + \\frac{\\partial H}{\\partial p} dp$$\n通过比较基 1-形式 $dq$ 和 $dp$ 的系数，我们找到向量场的分量：\n$$A = \\frac{\\partial H}{\\partial p} \\quad \\text{和} \\quad -B = \\frac{\\partial H}{\\partial q} \\implies B = -\\frac{\\partial H}{\\partial q}$$\n$X_H$ 的一条积分曲线 $(q(t), p(t))$ 是一条路径，其上每一点的速度向量由该向量场给出。在坐标中，这意味着 $\\frac{d}{dt}(q(t),p(t)) = (\\dot{q}(t), \\dot{p}(t)) = (A(q,p), B(q,p))$。这就得到了哈密顿方程：\n$$\\dot{q} = \\frac{\\partial H}{\\partial p} \\quad \\text{和} \\quad \\dot{p} = -\\frac{\\partial H}{\\partial q}$$\n对于我们选择的哈密顿量 $H(q,p) = q^2 p$，这些方程变为：\n$$\\dot{q} = \\frac{\\partial}{\\partial p}(q^2 p) = q^2$$\n$$\\dot{p} = -\\frac{\\partial}{\\partial q}(q^2 p) = -2qp$$\n现在，我们为初始条件 $(q(0),p(0))=(q_0,p_0)$（给定约束 $q_0  0$）求解这个常微分方程组。\n关于 $q$ 的方程与 $p$ 无关，可以通过分离变量法求解：\n$$\\frac{dq}{dt} = q^2 \\implies \\frac{dq}{q^2} = dt$$\n从 $t=0$ 积分到一般时间 $t$：\n$$\\int_{q_0}^{q(t)} \\frac{1}{s^2} ds = \\int_0^t d\\tau$$\n$$\\left[-\\frac{1}{s}\\right]_{q_0}^{q(t)} = t$$\n$$-\\frac{1}{q(t)} + \\frac{1}{q_0} = t$$\n求解 $q(t)$：\n$$\\frac{1}{q(t)} = \\frac{1}{q_0} - t = \\frac{1 - q_0 t}{q_0}$$\n$$q(t) = \\frac{q_0}{1 - q_0 t}$$\n$q(t)$ 的这个解在分母非零时有定义。因为 $q_0  0$，分母在 $t = 1/q_0$ 时为零。当 $t \\to (1/q_0)^-$ 时，分母从正方向趋近于 $0$，所以 $q(t) \\to +\\infty$。\n\n接下来，我们将 $q(t)$ 的解代入第二个方程来求解 $p(t)$：\n$$\\frac{dp}{dt} = -2q(t)p = -2\\left(\\frac{q_0}{1 - q_0 t}\\right)p$$\n这是一个关于 $p(t)$ 的线性可分离方程：\n$$\\frac{dp}{p} = -2q_0 \\frac{dt}{1 - q_0 t}$$\n从 $t=0$ 积分到 $t$：\n$$\\int_{p_0}^{p(t)} \\frac{1}{s} ds = -2q_0 \\int_0^t \\frac{1}{1-q_0\\tau} d\\tau$$\n假设 $p_0 \\neq 0$：\n$$\\ln|p(t)| - \\ln|p_0| = \\left[ 2\\ln(1-q_0\\tau) \\right]_0^t$$\n$$\\ln\\left|\\frac{p(t)}{p_0}\\right| = 2\\ln(1-q_0 t) - 2\\ln(1) = \\ln((1-q_0 t)^2)$$\n这意味着 $|p(t)| = |p_0|(1-q_0 t)^2$。对于 $t  1/q_0$，有 $(1-q_0 t)^2  0$，所以 $p(t)$ 不会变号。因此我们可以写出：\n$$p(t) = p_0 (1-q_0 t)^2$$\n如果 $p_0=0$，方程 $\\dot{p}=0$ 得到 $p(t)=0$，这与推导出的公式一致。\n\n对于初始数据 $(q_0, p_0)$ 且 $q_00$，精确解是：\n$$q(t) = \\frac{q_0}{1 - q_0 t}, \\quad p(t) = p_0 (1 - q_0 t)^2$$\n该解在包含 $t=0$ 且表达式有效的最大时间区间 $(-\\infty, 1/q_0)$ 上有定义。\n最大正向存在时间，记为 $T_+(q_0, p_0)$，是从 $(q_0, p_0)$ 出发的解存在的正时间 $t$ 的上确界。根据我们的分析，当 $t$ 从下方趋近于 $1/q_0$ 时，解会发生爆破。因此，最大正向存在时间是：\n$$T_+(q_0, p_0) = \\frac{1}{q_0}$$\n注意这个时间只依赖于 $q_0$ 而不依赖于 $p_0$。\n\n最后，我们解释为什么流是不完备的。如果流形上的一个向量场的流对所有时间都有定义，那么该向量场就称为完备的，这意味着每条最大积分曲线都在整个 $\\mathbb{R}$ 上有定义。哈密顿流是哈密顿向量场 $X_H$ 的流。我们已经明确地找到了初始条件，例如任何满足 $q_0  0$ 的 $(q_0, p_0)$，其最大积分曲线 $\\gamma(t)=(q(t),p(t))$ 仅在区间 $(-\\infty, 1/q_0)$ 上有定义。由于这个区间是 $\\mathbb{R}$ 的一个真子集，所以该积分曲线并非对所有时间都有定义。只要存在至少一条这样的轨迹，就足以证明向量场 $X_H = q^2 \\frac{\\partial}{\\partial q} - 2qp \\frac{\\partial}{\\partial p}$ 是不完备的。因此，它的流是不完备的，具体来说，对于任何 $q(0)  0$ 的轨迹，它都不是正向完备的。",
            "answer": "$$\n\\boxed{\\frac{1}{q_0}}\n$$"
        }
    ]
}