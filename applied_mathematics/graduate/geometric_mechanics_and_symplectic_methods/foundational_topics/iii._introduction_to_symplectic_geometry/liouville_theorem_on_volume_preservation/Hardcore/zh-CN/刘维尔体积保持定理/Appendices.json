{
    "hands_on_practices": [
        {
            "introduction": "理解一个定理最直接的方法就是在一个基本模型上进行验证。这个练习将使用物理学中的基石——简谐振子模型——来显式计算哈密顿流及其雅可比矩阵，从而直接确认相空间体积确实随时间守恒。通过这个练习，你将为抽象的刘维尔定理建立一个坚实的、具体的直观理解。",
            "id": "3754654",
            "problem": "考虑相空间 $\\mathbb{R}^{2n}$，其上的正则坐标为 $(q_1,\\dots,q_n,p_1,\\dots,p_n)$，正则辛二阶形式为 $\\omega=\\sum_{i=1}^{n} dq_i \\wedge dp_i$。设哈密顿量为\n$$\nH(q,p)=\\frac{1}{2}\\sum_{i=1}^{n}\\left(p_i^{2}+\\omega_i^{2} q_i^{2}\\right),\n$$\n其中每个 $\\omega_i$ 都是一个正常数。从哈密顿向量场 $X_H$ 由内积与辛形式定义的公式 $i_{X_H}\\omega=dH$ 出发，推导 $(q_i(t),p_i(t))$ 对应的常微分方程（ODE）组。对任意初始条件 $(q_i(0),p_i(0))$ 求解此初值问题，从而得到显式的哈密顿流 $\\Phi_t:\\mathbb{R}^{2n}\\to\\mathbb{R}^{2n}$。使用你得到的 $\\Phi_t$ 的显式表达式，计算雅可比矩阵 $D\\Phi_t$ 并确定其在任意 $t\\in\\mathbb{R}$ 下的行列式。你的最终答案必须是 $\\det D\\Phi_t$ 的值的单个封闭形式表达式。无需四舍五入。不包含任何物理单位。",
            "solution": "相空间为 $\\mathbb{R}^{2n}$，其正则坐标为 $(q_1, \\dots, q_n, p_1, \\dots, p_n)$。\n哈密顿量由下式给出\n$$\nH(q,p) = \\frac{1}{2}\\sum_{i=1}^{n}\\left(p_i^{2}+\\omega_i^{2} q_i^{2}\\right)\n$$\n其中每个 $\\omega_i$ 都是一个正常数。正则辛二阶形式为 $\\omega = \\sum_{i=1}^{n} dq_i \\wedge dp_i$。\n\n首先，我们推导运动方程。我们从计算哈密顿量的外微分 $dH$ 开始：\n$$\ndH = \\sum_{i=1}^{n} \\left( \\frac{\\partial H}{\\partial q_i} dq_i + \\frac{\\partial H}{\\partial p_i} dp_i \\right)\n$$\n偏导数是：\n$$\n\\frac{\\partial H}{\\partial q_i} = \\frac{1}{2} (2 \\omega_i^2 q_i) = \\omega_i^2 q_i\n$$\n$$\n\\frac{\\partial H}{\\partial p_i} = \\frac{1}{2} (2 p_i) = p_i\n$$\n将这些代入 $dH$ 的表达式，得到：\n$$\ndH = \\sum_{i=1}^{n} \\left( \\omega_i^2 q_i dq_i + p_i dp_i \\right)\n$$\n接下来，我们考虑哈密顿向量场 $X_H$。系统的时间演化由 $X_H$ 的积分曲线描述，因此我们可以用坐标的时间导数来表示它：\n$$\nX_H = \\sum_{j=1}^{n} \\left( \\dot{q}_j \\frac{\\partial}{\\partial q_j} + \\dot{p}_j \\frac{\\partial}{\\partial p_j} \\right)\n$$\n哈密顿向量场的定义由关系式 $i_{X_H}\\omega = dH$ 给出，其中 $i_{X_H}$ 是关于 $X_H$ 的内积。我们计算左侧：\n$$\ni_{X_H}\\omega = i_{X_H} \\left( \\sum_{k=1}^{n} dq_k \\wedge dp_k \\right) = \\sum_{j=1}^{n} \\sum_{k=1}^{n} \\left( \\dot{q}_j i_{\\frac{\\partial}{\\partial q_j}}(dq_k \\wedge dp_k) + \\dot{p}_j i_{\\frac{\\partial}{\\partial p_j}}(dq_k \\wedge dp_k) \\right)\n$$\n使用内积的性质 $i_V(A \\wedge B) = (i_V A) \\wedge B - A \\wedge (i_V B)$，以及对于基向量和基1-形式 $i_{\\frac{\\partial}{\\partial x^a}}dx^b = \\delta_a^b$ 的事实，我们有：\n$$\ni_{\\frac{\\partial}{\\partial q_j}}(dq_k \\wedge dp_k) = \\delta_{jk} dp_k\n$$\n$$\ni_{\\frac{\\partial}{\\partial p_j}}(dq_k \\wedge dp_k) = - \\delta_{jk} dq_k\n$$\n将这些代入 $i_{X_H}\\omega$ 的表达式中：\n$$\ni_{X_H}\\omega = \\sum_{j=1}^{n} \\sum_{k=1}^{n} \\left( \\dot{q}_j \\delta_{jk} dp_k - \\dot{p}_j \\delta_{jk} dq_k \\right) = \\sum_{j=1}^{n} \\left( \\dot{q}_j dp_j - \\dot{p}_j dq_j \\right)\n$$\n现在，我们将 $i_{X_H}\\omega$ 和 $dH$ 的两个表达式相等：\n$$\n\\sum_{i=1}^{n} \\left( \\dot{q}_i dp_i - \\dot{p}_i dq_i \\right) = \\sum_{i=1}^{n} \\left( p_i dp_i + \\omega_i^2 q_i dq_i \\right)\n$$\n通过比较每个 $i \\in \\{1, \\dots, n\\}$ 的基1-形式 $dq_i$ 和 $dp_i$ 的系数，我们得到哈密顿方程：\n$$\n\\dot{q}_i = p_i \\quad (\\text{来自 } dp_i \\text{ 的系数})\n$$\n$$\n-\\dot{p}_i = \\omega_i^2 q_i \\implies \\dot{p}_i = -\\omega_i^2 q_i \\quad (\\text{来自 } dq_i \\text{ 的系数})\n$$\n这就是描述运动的常微分方程（ODE）组。该系统解耦为 $n$ 对独立的方程，每个自由度 $i$ 对应一对。\n\n其次，我们求解这个常微分方程组以找到哈密顿流 $\\Phi_t$。对于每个 $i$，我们有：\n$$\n\\ddot{q}_i = \\dot{p}_i = -\\omega_i^2 q_i \\implies \\ddot{q}_i + \\omega_i^2 q_i = 0\n$$\n这是简谐振子的方程。其通解为：\n$$\nq_i(t) = A_i \\cos(\\omega_i t) + B_i \\sin(\\omega_i t)\n$$\n其中 $A_i$ 和 $B_i$ 是由初始条件 $(q_i(0), p_i(0))$ 决定的常数。我们将初始条件表示为 $(q_{i0}, p_{i0})$。\n在 $t=0$ 时，我们有 $q_i(0) = q_{i0}$，所以 $A_i = q_{i0}$。\n动量为 $p_i(t) = \\dot{q}_i(t) = -A_i \\omega_i \\sin(\\omega_i t) + B_i \\omega_i \\cos(\\omega_i t)$。\n在 $t=0$ 时，我们有 $p_i(0) = p_{i0}$，所以 $p_{i0} = B_i \\omega_i$，这给出 $B_i = \\frac{p_{i0}}{\\omega_i}$。\n将 $A_i$ 和 $B_i$ 代回，我们得到从 $(q_0, p_0)$ 开始的轨迹的显式解：\n$$\nq_i(t) = q_{i0} \\cos(\\omega_i t) + \\frac{p_{i0}}{\\omega_i} \\sin(\\omega_i t)\n$$\n$$\np_i(t) = -q_{i0} \\omega_i \\sin(\\omega_i t) + p_{i0} \\cos(\\omega_i t)\n$$\n哈密顿流 $\\Phi_t: \\mathbb{R}^{2n} \\to \\mathbb{R}^{2n}$ 是将初始状态映射到时间 $t$ 状态的映射。设 $z = (q_1, \\dots, q_n, p_1, \\dots, p_n)$ 是相空间中的一个点。那么 $\\Phi_t(z_0) = z(t)$，其中 $z_0 = z(0)$。\n\n第三，我们计算流的雅可比矩阵 $D\\Phi_t$。这是一个 $2n \\times 2n$ 矩阵，其元素是最终坐标相对于初始坐标的偏导数。坐标按 $(q_1, \\dots, q_n, p_1, \\dots, p_n)$ 排序。\n方程组 $(q_i(t), p_i(t))$ 只依赖于 $(q_{i0}, p_{i0})$。这意味着当 $i \\neq j$ 时，像 $\\frac{\\partial q_i(t)}{\\partial q_{j0}}$ 这样的导数为零。因此，雅可比矩阵 $D\\Phi_t$ 是块对角矩阵。如果我们将坐标排序为 $(q_1, p_1, q_2, p_2, \\ldots, q_n, p_n)$，雅可比矩阵的形式为：\n$$\nD\\Phi_t = \\begin{pmatrix} J_1  0  \\dots  0 \\\\ 0  J_2  \\dots  0 \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ 0  0  \\dots  J_n \\end{pmatrix}\n$$\n其中每个 $J_i$ 是第 $i$ 个子系统的 $2 \\times 2$ 雅可比矩阵，由下式给出：\n$$\nJ_i = \\begin{pmatrix} \\frac{\\partial q_i(t)}{\\partial q_{i0}}  \\frac{\\partial q_i(t)}{\\partial p_{i0}} \\\\ \\frac{\\partial p_i(t)}{\\partial q_{i0}}  \\frac{\\partial p_i(t)}{\\partial p_{i0}} \\end{pmatrix}\n$$\n我们从解的方程中计算这些偏导数：\n$$\n\\frac{\\partial q_i(t)}{\\partial q_{i0}} = \\cos(\\omega_i t)\n$$\n$$\n\\frac{\\partial q_i(t)}{\\partial p_{i0}} = \\frac{1}{\\omega_i} \\sin(\\omega_i t)\n$$\n$$\n\\frac{\\partial p_i(t)}{\\partial q_{i0}} = -\\omega_i \\sin(\\omega_i t)\n$$\n$$\n\\frac{\\partial p_i(t)}{\\partial p_{i0}} = \\cos(\\omega_i t)\n$$\n所以块 $J_i$ 是：\n$$\nJ_i = \\begin{pmatrix} \\cos(\\omega_i t)  \\frac{1}{\\omega_i} \\sin(\\omega_i t) \\\\ -\\omega_i \\sin(\\omega_i t)  \\cos(\\omega_i t) \\end{pmatrix}\n$$\n第四，我们确定完整雅可比矩阵的行列式 $\\det D\\Phi_t$。由于 $D\\Phi_t$ 是块对角矩阵，其行列式是对角块行列式的乘积：\n$$\n\\det D\\Phi_t = \\prod_{i=1}^{n} \\det J_i\n$$\n我们计算单个块 $J_i$ 的行列式：\n$$\n\\det J_i = (\\cos(\\omega_i t))(\\cos(\\omega_i t)) - \\left(\\frac{1}{\\omega_i} \\sin(\\omega_i t)\\right)(-\\omega_i \\sin(\\omega_i t))\n$$\n$$\n\\det J_i = \\cos^2(\\omega_i t) + \\sin^2(\\omega_i t) = 1\n$$\n每个块 $J_i$ 的行列式对于所有 $t \\in \\mathbb{R}$ 都等于 $1$。\n因此，完整雅可比矩阵的行列式是：\n$$\n\\det D\\Phi_t = \\prod_{i=1}^{n} 1 = 1\n$$\n这个结果是对这个特定哈密顿系统的刘维尔定理（关于体积保持）的显式验证，该定理指出哈密顿流保持相空间体积元，这意味着流映射的雅可比行列式为1。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "现在，我们将视角从有限时间的流映射转移到运动的无穷小生成元——哈密顿向量场。刘维尔定理的一个等价表述是哈密顿向量场是无散度的。这个练习将为一个非平凡的哈密顿量验证这一性质，并强调该定理的普适性源于哈密顿方程的基本结构。",
            "id": "3754655",
            "problem": "考虑一个 $2n$ 维相空间 $\\mathbb{R}^{2n}$，其正则坐标为 $(q^{1},\\dots,q^{n},p_{1},\\dots,p_{n})$，正则辛形式为 $\\omega=\\sum_{i=1}^{n} dq^{i}\\wedge dp_{i}$，以及刘维尔体积形式 $\\mu=\\omega^{n}/n!$。设哈密顿量为\n$$\nH(q,p)=\\sum_{i=1}^{n}\\Big(\\ln(1+p_{i}^{2})+\\exp(q^{i})\\Big).\n$$\n从由内积 $i_{X_{H}}\\omega=dH$ 给出的哈密顿向量场 $X_{H}$ 的定义关系出发，推导在正则坐标下关于 $(\\dot{q}^{i},\\dot{p}_{i})$ 的相应常微分方程组 (ODE)。使用关于体积形式的散度定义，即 $\\mathcal{L}_{X}\\mu=(\\operatorname{div}_{\\mu}X)\\mu$，以及在正则坐标下 $\\mu$ 具有常数密度，散度化简为\n$$\n\\operatorname{div}_{\\mu}X_{H}=\\sum_{i=1}^{n}\\left(\\frac{\\partial \\dot{q}^{i}}{\\partial q^{i}}+\\frac{\\partial \\dot{p}_{i}}{\\partial p_{i}}\\right),\n$$\n这一事实，计算给定非多项式哈密顿量 $H(q,p)$ 的 $\\operatorname{div}_{\\mu}X_{H}$，并给出最终的简化解析表达式。将你的最终答案表示为单个闭式表达式。无需四舍五入。",
            "solution": "求解过程包括两部分：首先，从关系式 $i_{X_{H}}\\omega=dH$ 推导哈密顿运动方程；其次，计算所得向量场 $X_{H}$ 的散度。\n\n**第1部分：运动方程的推导**\n\n哈密顿量由下式给出\n$$\nH(q,p)=\\sum_{j=1}^{n}\\Big(\\ln(1+p_{j}^{2})+\\exp(q^{j})\\Big)\n$$\n我们计算其外微分 $dH$。\n$$\ndH = \\sum_{i=1}^{n} \\left( \\frac{\\partial H}{\\partial q^{i}} dq^{i} + \\frac{\\partial H}{\\partial p_{i}} dp_{i} \\right)\n$$\n$H$ 关于正则坐标的偏导数为：\n$$\n\\frac{\\partial H}{\\partial q^{i}} = \\frac{\\partial}{\\partial q^{i}} \\sum_{j=1}^{n}\\Big(\\ln(1+p_{j}^{2})+\\exp(q^{j})\\Big) = \\exp(q^{i})\n$$\n$$\n\\frac{\\partial H}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}} \\sum_{j=1}^{n}\\Big(\\ln(1+p_{j}^{2})+\\exp(q^{j})\\Big) = \\frac{1}{1+p_{i}^{2}} \\cdot (2p_{i}) = \\frac{2p_{i}}{1+p_{i}^{2}}\n$$\n因此，哈密顿量的外微分是\n$$\ndH = \\sum_{i=1}^{n} \\left( \\exp(q^{i}) dq^{i} + \\frac{2p_{i}}{1+p_{i}^{2}} dp_{i} \\right)\n$$\n哈密顿向量场 $X_{H}$ 在坐标形式下写为\n$$\nX_{H} = \\sum_{j=1}^{n} \\left( \\dot{q}^{j} \\frac{\\partial}{\\partial q^{j}} + \\dot{p}_{j} \\frac{\\partial}{\\partial p_{j}} \\right)\n$$\n其中 $\\dot{q}^{j}$ 和 $\\dot{p}_{j}$ 是我们要求解的向量场的分量函数。$X_{H}$ 与辛形式 $\\omega = \\sum_{k=1}^{n} dq^{k} \\wedge dp_{k}$ 的内积是\n$$\ni_{X_{H}}\\omega = i_{\\sum_{j=1}^{n} ( \\dot{q}^{j} \\frac{\\partial}{\\partial q^{j}} + \\dot{p}_{j} \\frac{\\partial}{\\partial p_{j}} )} \\left( \\sum_{k=1}^{n} dq^{k} \\wedge dp_{k} \\right)\n$$\n利用内积的线性性质、其对楔积的作用规则 $i_{V}(A \\wedge B) = (i_{V}A)B - A(i_{V}B)$，以及对基底形式的作用规则 $i_{\\partial/\\partial x^{\\alpha}}dx^{\\beta} = \\delta^{\\beta}_{\\alpha}$，我们得到：\n\\begin{align*}\n i_{X_{H}}\\omega = \\sum_{j=1}^{n} \\left( \\dot{q}^{j} i_{\\partial/\\partial q^{j}}\\omega + \\dot{p}_{j} i_{\\partial/\\partial p_{j}}\\omega \\right) \\\\\n = \\sum_{j=1}^{n} \\left( \\dot{q}^{j} \\left( \\sum_{k=1}^{n} (\\delta^{k}_{j} dp_{k} - 0) \\right) + \\dot{p}_{j} \\left( \\sum_{k=1}^{n} (0 - dq^{k} \\delta_{k}^{j}) \\right) \\right) \\\\\n = \\sum_{j=1}^{n} \\left( \\dot{q}^{j} dp_{j} - \\dot{p}_{j} dq^{j} \\right)\n\\end{align*}\n为保持一致性，使用 $i$ 重新索引：\n$$\ni_{X_{H}}\\omega = \\sum_{i=1}^{n} \\left( -\\dot{p}_{i} dq^{i} + \\dot{q}^{i} dp_{i} \\right)\n$$\n现在我们应用定义关系 $i_{X_{H}}\\omega = dH$：\n$$\n\\sum_{i=1}^{n} \\left( -\\dot{p}_{i} dq^{i} + \\dot{q}^{i} dp_{i} \\right) = \\sum_{i=1}^{n} \\left( \\exp(q^{i}) dq^{i} + \\frac{2p_{i}}{1+p_{i}^{2}} dp_{i} \\right)\n$$\n通过对每个 $i \\in \\{1, \\dots, n\\}$ 比较基底1-形式 $dq^{i}$ 和 $dp_{i}$ 的系数，我们得到哈密顿方程：\n$$\n\\dot{q}^{i} = \\frac{\\partial H}{\\partial p_{i}} = \\frac{2p_{i}}{1+p_{i}^{2}}\n$$\n$$\n\\dot{p}_{i} = -\\frac{\\partial H}{\\partial q^{i}} = -\\exp(q^{i})\n$$\n这就是描述系统演化的常微分方程组。\n\n**第2部分：散度的计算**\n\n问题给出了 $X_{H}$ 关于刘维尔体积形式 $\\mu$ 在正则坐标下的散度公式：\n$$\n\\operatorname{div}_{\\mu}X_{H}=\\sum_{i=1}^{n}\\left(\\frac{\\partial \\dot{q}^{i}}{\\partial q^{i}}+\\frac{\\partial \\dot{p}_{i}}{\\partial p_{i}}\\right)\n$$\n我们使用在第1部分中推导出的 $\\dot{q}^{i}$ 和 $\\dot{p}_{i}$ 的表达式。对每个 $i$，我们计算所需的偏导数。\n\n分量 $\\dot{q}^{i} = \\frac{2p_{i}}{1+p_{i}^{2}}$ 仅是 $p_{i}$ 的函数。因此，它关于 $q^{i}$ 的偏导数为：\n$$\n\\frac{\\partial \\dot{q}^{i}}{\\partial q^{i}} = \\frac{\\partial}{\\partial q^{i}} \\left( \\frac{2p_{i}}{1+p_{i}^{2}} \\right) = 0\n$$\n因为 $q^{i}$ 和 $p_i$ 是独立坐标。\n\n分量 $\\dot{p}_{i} = -\\exp(q^{i})$ 仅是 $q^{i}$ 的函数。因此，它关于 $p_{i}$ 的偏导数为：\n$$\n\\frac{\\partial \\dot{p}_{i}}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}} \\left( -\\exp(q^{i}) \\right) = 0\n$$\n因为 $p_i$ 和 $q^i$ 是独立坐标。\n\n将这些结果代入散度公式：\n$$\n\\operatorname{div}_{\\mu}X_{H} = \\sum_{i=1}^{n} (0 + 0) = \\sum_{i=1}^{n} 0 = 0\n$$\n哈密顿向量场的散度为 $0$。这个结果是对关于相空间体积守恒的刘维尔定理的一个具体验证。该定理指出，对于任何哈密顿系统，其向量场关于正则体积形式的散度恒等于零，即 $\\operatorname{div}_{\\mu}X_{H}=0$。这通常是成立的，因为对于任何足够光滑的哈密顿量 $H$，\n$$\n\\operatorname{div}_{\\mu}X_{H} = \\sum_{i=1}^{n}\\left(\\frac{\\partial}{\\partial q^{i}}\\left(\\frac{\\partial H}{\\partial p_{i}}\\right)+\\frac{\\partial}{\\partial p_{i}}\\left(-\\frac{\\partial H}{\\partial q^{i}}\\right)\\right) = \\sum_{i=1}^{n}\\left(\\frac{\\partial^{2}H}{\\partial q^{i}\\partial p_{i}} - \\frac{\\partial^{2}H}{\\partial p_{i}\\partial q^{i}}\\right) = 0\n$$\n根据混合偏导数的相等性（施瓦茨定理）。我们的显式计算证实了这一普遍原理对于给定的非多项式哈密顿量也成立。最终的简化解析表达式为 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "辛映射总是保体积的，但反过来是否成立？这个练习探讨了保体积性和辛性之间的关键区别，这是几何数值积分中的一个核心概念。通过分析一个特殊构造的映射，你将发现，仅仅保持体积并不足以保留哈密顿动力学的完整几何结构，从而更深刻地体会到哈密顿系统的独特之处。",
            "id": "3754652",
            "problem": "考虑一个在相空间 $\\mathbb{R}^{4}$ 上具有两个自由度的哈密顿系统，其正则坐标为 $(q_{1},q_{2},p_{1},p_{2})$，正则辛形式为 $\\omega = dq_{1} \\wedge dp_{1} + dq_{2} \\wedge dp_{2}$。设哈密顿量为 $H(q,p) = \\frac{1}{2}\\left(p_{1}^{2} + p_{2}^{2}\\right) + \\frac{1}{2}\\left(\\Omega_{1}^{2} q_{1}^{2} + \\Omega_{2}^{2} q_{2}^{2}\\right)$，其中 $\\Omega_{1}$ 和 $\\Omega_{2}$ 为正常数。定义单步数值方法（一个离散时间映射）$\\Phi_{h,\\alpha} : \\mathbb{R}^{4} \\to \\mathbb{R}^{4}$ 如下\n$$\n\\Phi_{h,\\alpha}(q_{1},q_{2},p_{1},p_{2}) = \\left(q_{1} + h\\,p_{1},\\; q_{2} + h\\,p_{2},\\; p_{1},\\; p_{2} + \\alpha\\, q_{1}\\right),\n$$\n其中 $h > 0$ 是时间步长，$\\alpha \\in \\mathbb{R}$ 是一个固定参数。\n\n从以下基本定义出发：(i) 一个映射是辛的，当且仅当其切映射保持正则辛形式，等价于 $D\\Phi^{\\top} J\\, D\\Phi = J$，其中 $J = \\begin{pmatrix} 0  I \\\\ -I  0 \\end{pmatrix}$，$I$ 是 $2 \\times 2$ 单位矩阵；(ii) Liouville定理指出哈密顿流保持Liouville体积形式 $\\Omega = \\frac{1}{2}\\omega \\wedge \\omega$（因此其雅可比行列式等于1）。请执行以下操作：\n\n1. 计算方法 $\\Phi_{h,\\alpha}$ 的雅可比矩阵 $D\\Phi_{h,\\alpha}$ 及其行列式。判断该方法对于所有的 $h$ 和 $\\alpha$ 是否是保体积的。\n\n2. 使用辛条件 $D\\Phi_{h,\\alpha}^{\\top} J\\, D\\Phi_{h,\\alpha} = J$，确定使 $\\Phi_{h,\\alpha}$ 成为辛映射的关于 $\\alpha$ 的充分必要条件（用 $h$ 和任何相关常数表示）。\n\n3. 使用几何力学的基本原理，解释为什么仅保持体积（即 $\\det(D\\Phi_{h,\\alpha}) = 1$）并不能保证正确的长期哈密顿结构。你的解释应说明为什么非辛保体积方法通常在后向误差分析（BEA）的意义下不容许一个修正哈密顿量，从而即使相空间体积得以保持，不变量中也会出现伪长期漂移。\n\n作为你最终报告的答案，给出使 $\\Phi_{h,\\alpha}$ 成为辛映射的参数 $\\alpha$ 的唯一值。无需四舍五入，无需单位。",
            "solution": "该问题要求对哈密顿系统的一个数值方法 $\\Phi_{h,\\alpha}$ 进行分析。分析内容包括检查保体积性和辛性，并解释这两种性质的不同含义。系统的状态向量为 $z = (q_{1}, q_{2}, p_{1}, p_{2})^{\\top} \\in \\mathbb{R}^{4}$。\n\n数值方法由映射 $\\Phi_{h,\\alpha}: \\mathbb{R}^{4} \\to \\mathbb{R}^{4}$ 给出，定义为：\n$$\n\\Phi_{h,\\alpha}(q_{1}, q_{2}, p_{1}, p_{2}) = (q_{1} + h p_{1}, q_{2} + h p_{2}, p_{1}, p_{2} + \\alpha q_{1})\n$$\n其中 $h > 0$ 是时间步长，$\\alpha \\in \\mathbb{R}$ 是一个参数。\n\n让我们将映射的分量记为 $z' = \\Phi_{h,\\alpha}(z)$:\n$q_{1}' = q_{1} + h p_{1}$\n$q_{2}' = q_{2} + h p_{2}$\n$p_{1}' = p_{1}$\n$p_{2}' = p_{2} + \\alpha q_{1}$\n\n**1. 雅可比矩阵与保体积性**\n\n第一个任务是计算映射的雅可比矩阵 $D\\Phi_{h,\\alpha}$ 及其行列式。如果一个映射的雅可比行列式等于 $1$，则该映射是保体积的。\n\n雅可比矩阵为 $D\\Phi_{h,\\alpha} = \\frac{\\partial z'}{\\partial z}$。其分量是输出坐标对输入坐标的偏导数。\n坐标按 $(q_{1}, q_{2}, p_{1}, p_{2})$ 的顺序排列。\n\n偏导数如下：\n$\\frac{\\partial q_{1}'}{\\partial q_{1}} = 1$, $\\frac{\\partial q_{1}'}{\\partial q_{2}} = 0$, $\\frac{\\partial q_{1}'}{\\partial p_{1}} = h$, $\\frac{\\partial q_{1}'}{\\partial p_{2}} = 0$\n$\\frac{\\partial q_{2}'}{\\partial q_{1}} = 0$, $\\frac{\\partial q_{2}'}{\\partial q_{2}} = 1$, $\\frac{\\partial q_{2}'}{\\partial p_{1}} = 0$, $\\frac{\\partial q_{2}'}{\\partial p_{2}} = h$\n$\\frac{\\partial p_{1}'}{\\partial q_{1}} = 0$, $\\frac{\\partial p_{1}'}{\\partial q_{2}} = 0$, $\\frac{\\partial p_{1}'}{\\partial p_{1}} = 1$, $\\frac{\\partial p_{1}'}{\\partial p_{2}} = 0$\n$\\frac{\\partial p_{2}'}{\\partial q_{1}} = \\alpha$, $\\frac{\\partial p_{2}'}{\\partial q_{2}} = 0$, $\\frac{\\partial p_{2}'}{\\partial p_{1}} = 0$, $\\frac{\\partial p_{2}'}{\\partial p_{2}} = 1$\n\n将这些偏导数组合成一个矩阵，我们得到雅可比矩阵：\n$$\nD\\Phi_{h,\\alpha} = \\begin{pmatrix}\n1  0  h  0 \\\\\n0  1  0  h \\\\\n0  0  1  0 \\\\\n\\alpha  0  0  1\n\\end{pmatrix}\n$$\n为了求行列式，我们可以使用代数余子式展开。沿第三行展开（该行大部分为零）可以简化计算：\n$$\n\\det(D\\Phi_{h,\\alpha}) = (-1)^{3+3} \\cdot 1 \\cdot \\det \\begin{pmatrix}\n1  0  0 \\\\\n0  1  h \\\\\n\\alpha  0  1\n\\end{pmatrix}\n$$\n现在，我们计算这个 $3 \\times 3$ 矩阵的行列式，例如沿第一行展开：\n$$\n\\det \\begin{pmatrix}\n1  0  0 \\\\\n0  1  h \\\\\n\\alpha  0  1\n\\end{pmatrix} = (-1)^{1+1} \\cdot 1 \\cdot \\det \\begin{pmatrix}\n1  h \\\\\n0  1\n\\end{pmatrix} = 1 \\cdot (1 \\cdot 1 - h \\cdot 0) = 1\n$$\n因此，我们有：\n$$\n\\det(D\\Phi_{h,\\alpha}) = 1\n$$\n对于所有 $h > 0$ 和 $\\alpha \\in \\mathbb{R}$ 的值，行列式均为 $1$。因此，方法 $\\Phi_{h,\\alpha}$ 对所有的 $h$ 和 $\\alpha$ 都是保体积的。\n\n**2. 辛性条件**\n\n如果映射 $\\Phi$ 的雅可比矩阵 $D\\Phi$ 满足条件 $D\\Phi^{\\top} J D\\Phi = J$，则该映射是辛的。\n对于坐标顺序 $(q_{1}, q_{2}, p_{1}, p_{2})$，正则辛矩阵 $J$ 由下式给出：\n$$\nJ = \\begin{pmatrix} 0  I \\\\ -I  0 \\end{pmatrix}_4 = \\begin{pmatrix}\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-1  0  0  0 \\\\\n0  -1  0  0\n\\end{pmatrix}\n$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。我们记 $M = D\\Phi_{h,\\alpha}$。我们需要计算 $M^{\\top} J M$ 并使其等于 $J$。\n\n$M$ 的转置是：\n$$\nM^{\\top} = \\begin{pmatrix}\n1  0  0  \\alpha \\\\\n0  1  0  0 \\\\\nh  0  1  0 \\\\\n0  h  0  1\n\\end{pmatrix}\n$$\n首先，我们计算乘积 $J M$：\n$$\nJ M = \\begin{pmatrix}\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-1  0  0  0 \\\\\n0  -1  0  0\n\\end{pmatrix} \\begin{pmatrix}\n1  0  h  0 \\\\\n0  1  0  h \\\\\n0  0  1  0 \\\\\n\\alpha  0  0  1\n\\end{pmatrix} = \\begin{pmatrix}\n0  0  1  0 \\\\\n\\alpha  0  0  1 \\\\\n-1  0  -h  0 \\\\\n0  -1  0  -h\n\\end{pmatrix}\n$$\n接下来，我们左乘 $M^{\\top}$：\n$$\nM^{\\top}JM = \\begin{pmatrix}\n1  0  0  \\alpha \\\\\n0  1  0  0 \\\\\nh  0  1  0 \\\\\n0  h  0  1\n\\end{pmatrix} \\begin{pmatrix}\n0  0  1  0 \\\\\n\\alpha  0  0  1 \\\\\n-1  0  -h  0 \\\\\n0  -1  0  -h\n\\end{pmatrix} = \\begin{pmatrix}\n0  -\\alpha  1  -h\\alpha \\\\\n\\alpha  0  0  1 \\\\\n-1  0  0  0 \\\\\nh\\alpha  -1  0  0\n\\end{pmatrix}\n$$\n为使映射是辛的，这个结果矩阵必须等于 $J$：\n$$\n\\begin{pmatrix}\n0  -\\alpha  1  -h\\alpha \\\\\n\\alpha  0  0  1 \\\\\n-1  0  0  0 \\\\\nh\\alpha  -1  0  0\n\\end{pmatrix} = \\begin{pmatrix}\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-1  0  0  0 \\\\\n0  -1  0  0\n\\end{pmatrix}\n$$\n逐个元素比较这两个矩阵，我们得到关于 $\\alpha$ 的几个条件：\n\\begin{itemize}\n    \\item 从元素 $(1,2)$: $-\\alpha = 0 \\implies \\alpha = 0$。\n    \\item 从元素 $(1,4)$: $-h\\alpha = 0$。由于 $h > 0$，这意味着 $\\alpha = 0$。\n    \\item 从元素 $(2,1)$: $\\alpha = 0$。\n    \\item 从元素 $(4,1)$: $h\\alpha = 0$。由于 $h > 0$，这意味着 $\\alpha = 0$。\n\\end{itemize}\n所有其他元素要么完全匹配（例如 $(1,1)$、$(1,3)$ 等），要么与条件 $\\alpha=0$ 一致。例如，如果 $\\alpha=0$，结果矩阵就与 $J$ 完全相同。\n因此，使映射 $\\Phi_{h,\\alpha}$ 成为辛映射的充分必要条件是 $\\alpha = 0$。\n\n**3. 保体积性与辛性**\n\n第三部分要求解释为什么保体积性（$\\det(D\\Phi_{h,\\alpha}) = 1$）对于数值方法正确捕捉哈密顿系统的长期行为来说是不充分的。\n\n哈密顿流 $\\phi_t$ 是辛的，意味着它保持辛2-形式 $\\omega$。这表示为 $\\phi_t^*\\omega = \\omega$。这个性质的一个推论是，该流也保持Liouville体积形式，在这个 $2n=4$ 维的情况下是 $\\Omega = \\frac{1}{2}\\omega \\wedge \\omega = dq_{1} \\wedge dp_{1} \\wedge dq_{2} \\wedge dp_{2}$。保持体积形式等价于流映射的雅可比行列式等于 $1$。因此，任何辛映射都自动是保体积的。\n\n反之不成立，正如对于任何 $\\alpha \\neq 0$ 的映射 $\\Phi_{h,\\alpha}$ 所展示的。这个映射是保体积的，但不是辛的。\n\n辛映射对于数值积分的关键性质根植于后向误差分析（BEA）。对于一个辛积分子 $\\Phi_h$，存在一个修正哈密顿量 $\\tilde{H}$，通常表示为关于步长 $h$ 的渐近级数：\n$$ \\tilde{H}(q,p) = H(q,p) + h H_1(q,p) + h^2 H_2(q,p) + \\dots $$\n关键结果是，在忽略 $h$ 的指数级小项的意义下，数值方法 $\\Phi_h$ 是由 $\\tilde{H}$ 控制的修正哈密顿系统的精确时间-$h$流映射。这意味着辛积分子产生的数值解位于一个邻近哈密顿系统的精确轨道上。\n\n这对长期积分具有深远的影响。任何作为修正哈密顿量 $\\tilde{H}$ 的首次积分的量都将被该数值方法精确保守。特别是，修正能量 $\\tilde{H}$ 是守恒的。由于 $\\tilde{H}$ 是原始哈密顿量 $H$ 的一个小扰动，原始能量 $H$ 将在其初始值附近表现出有界振荡，但在长的积分时间内不会表现出系统性漂移。这种能量的近似守恒是辛积分子的一个标志，对于哈密顿系统（例如天体力学或分子动力学）的稳定长期模拟至关重要。\n\n对于一个非辛方法，即使它是保体积的，修正哈密顿量通常也不存在。该数值映射不对应于任何哈密顿系统的流。因此，没有类似于 $\\tilde{H}$ 的守恒量来约束动力学。虽然点集的总相空间体积是守恒的，但单个点的轨道并不局限于一个特定的能量面（或一个轻微扰动的能量面）。这通常会导致像能量这样本应守恒的量出现伪的、长期的漂移。能量误差可以无界增长，例如与积分时间或其平方根成正比，从而导致长期模拟中出现定性上不正确的物理行为。\n\n总之，保持辛形式 $\\omega$（辛性）是比保持体积形式 $\\Omega$（保体积性）强得多的条件。辛性确保了哈密顿力学几何结构的保持，这不仅包括体积，还包括正则泊松括号代数。正是这种结构保持保证了修正哈密顿量的存在以及数值解优异的长期保真度。仅靠保体积性无法提供这种保证。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}