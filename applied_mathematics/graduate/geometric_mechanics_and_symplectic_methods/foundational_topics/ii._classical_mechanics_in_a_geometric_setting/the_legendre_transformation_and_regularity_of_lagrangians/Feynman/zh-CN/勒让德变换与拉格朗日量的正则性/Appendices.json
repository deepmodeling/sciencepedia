{
    "hands_on_practices": [
        {
            "introduction": "从拉格朗日力学到哈密顿力学的转换，其核心是勒让德变换。本练习提供了一个具体的例子，旨在训练通过检验纤维黑塞矩阵来判断系统正则性的核心技能。通过解决这个问题，你将看到一个参数如何控制系统是正则的还是奇异的，并练习为正则情况构建哈密顿量。",
            "id": "3778709",
            "problem": "设 $Q=\\mathbb{R}^{2}$ 为一个位形流形，其全局坐标为 $(q_{1},q_{2})$，并令 $(v_{1},v_{2})$ 表示切丛 $TQ$ 上相应的纤维坐标。考虑由下式给出的单参数拉格朗日量族 $L_{\\lambda}:TQ\\to\\mathbb{R}$\n$$\nL_{\\lambda}(q,v)=\\frac{1}{2}\\big(v_{1}-q_{2}v_{2}\\big)^{2}+\\frac{\\lambda}{2}\\,v_{2}^{2}-U(q),\n$$\n其中 $q=(q_{1},q_{2})$，$v=(v_{1},v_{2})$，$\\lambda\\ge 0$ 是一个参数，且 $U:Q\\to\\mathbb{R}$ 是一个固定的光滑势。\n\n仅使用勒让德变换和拉格朗日量正则性的基本定义，完成以下任务：\n\n- 推导动量 $p_{i}=\\frac{\\partial L_{\\lambda}}{\\partial v_{i}}$ 和纤维黑塞矩阵 $W_{ij}=\\frac{\\partial^{2}L_{\\lambda}}{\\partial v_{i}\\partial v_{j}}$。显式地计算 $\\det W$ 作为 $q$ 和 $\\lambda$ 的函数。\n\n- 根据 $\\det W$，判断对于哪些 $\\lambda$ 值，拉格朗日量 $L_{\\lambda}$ 是正则的，并在正则性失效时，给出一个正则性失效的具体位形-速度点 $(q,v)\\in TQ$。\n\n- 对于 $\\lambda>0$ 的情况，对勒让德变换求逆，将 $v$ 表示为 $(q,p)$ 的函数，然后计算由下式定义的哈密顿量 $H_{\\lambda}(q,p)$\n$$\nH_{\\lambda}(q,p)=p_{1}v_{1}+p_{2}v_{2}-L_{\\lambda}(q,v),\n$$\n其中通过逆勒让德变换消去 $v$ 而以 $(q,p)$ 表示。将你的最终结果表示为一个关于 $(q,p)$ 和 $\\lambda$ 的单一显式解析表达式。\n\n你的最终答案必须是针对 $\\lambda>0$ 的 $H_{\\lambda}(q,p)$ 的单一闭式表达式。",
            "solution": "该问题是适定的，其科学基础为经典力学原理，并提供了求解所需的所有必要信息。因此，该问题被认为是有效的。\n\n单参数拉格朗日量族由下式给出\n$$\nL_{\\lambda}(q,v)=\\frac{1}{2}\\big(v_{1}-q_{2}v_{2}\\big)^{2}+\\frac{\\lambda}{2}\\,v_{2}^{2}-U(q),\n$$\n其中 $q=(q_{1},q_{2})$，$v=(v_{1},v_{2})$，且 $\\lambda \\ge 0$。\n\n### 第1部分：动量和纤维黑塞矩阵\n\n首先，我们使用定义 $p_{i} = \\frac{\\partial L_{\\lambda}}{\\partial v_{i}}$ 计算正则共轭动量 $p_{i}$。\n对于 $i=1$：\n$$\np_{1} = \\frac{\\partial L_{\\lambda}}{\\partial v_{1}} = \\frac{1}{2} \\cdot 2(v_{1}-q_{2}v_{2})\\frac{\\partial}{\\partial v_{1}}(v_{1}-q_{2}v_{2}) = v_{1}-q_{2}v_{2}.\n$$\n对于 $i=2$：\n$$\np_{2} = \\frac{\\partial L_{\\lambda}}{\\partial v_{2}} = \\frac{1}{2} \\cdot 2(v_{1}-q_{2}v_{2})\\frac{\\partial}{\\partial v_{2}}(v_{1}-q_{2}v_{2}) + \\frac{\\lambda}{2}(2v_{2}) = (v_{1}-q_{2}v_{2})(-q_{2}) + \\lambda v_{2}.\n$$\n将 $p_1$ 的表达式代入 $p_2$ 的表达式中，我们得到：\n$$\np_{2} = -q_{2}p_{1} + \\lambda v_{2}.\n$$\n接下来，我们计算纤维黑塞矩阵 $W$，其分量为 $W_{ij} = \\frac{\\partial^{2}L_{\\lambda}}{\\partial v_{i}\\partial v_{j}} = \\frac{\\partial p_{i}}{\\partial v_{j}}$。\n$$\nW_{11} = \\frac{\\partial p_{1}}{\\partial v_{1}} = \\frac{\\partial}{\\partial v_{1}}(v_{1}-q_{2}v_{2}) = 1.\n$$\n$$\nW_{12} = \\frac{\\partial p_{1}}{\\partial v_{2}} = \\frac{\\partial}{\\partial v_{2}}(v_{1}-q_{2}v_{2}) = -q_{2}.\n$$\n为了计算第二行，我们首先将 $p_2$ 完全用速度表示：$p_2 = -q_2v_1 + q_2^2 v_2 + \\lambda v_2 = -q_2v_1 + (q_2^2+\\lambda)v_2$。\n$$\nW_{21} = \\frac{\\partial p_{2}}{\\partial v_{1}} = \\frac{\\partial}{\\partial v_{1}}(-q_{2}v_{1} + (q_{2}^{2}+\\lambda)v_{2}) = -q_{2}.\n$$\n$$\nW_{22} = \\frac{\\partial p_{2}}{\\partial v_{2}} = \\frac{\\partial}{\\partial v_{2}}(-q_{2}v_{1} + (q_{2}^{2}+\\lambda)v_{2}) = q_{2}^{2}+\\lambda.\n$$\n因此，纤维黑塞矩阵是：\n$$\nW = \\begin{pmatrix} W_{11}  W_{12} \\\\ W_{21}  W_{22} \\end{pmatrix} = \\begin{pmatrix} 1  -q_{2} \\\\ -q_{2}  q_{2}^{2}+\\lambda \\end{pmatrix}.\n$$\n$W$ 的行列式是：\n$$\n\\det W = (1)(q_{2}^{2}+\\lambda) - (-q_{2})(-q_{2}) = q_{2}^{2}+\\lambda-q_{2}^{2} = \\lambda.\n$$\n所以，$\\det W = \\lambda$，它只依赖于参数 $\\lambda$ 而不依赖于位形 $q$。\n\n### 第2部分：拉格朗日量的正则性\n\n一个拉格朗日量被定义为正则的，如果其纤维黑塞矩阵是非奇异的，这意味着 $\\det W \\neq 0$。\n根据我们的计算，$\\det W = \\lambda$。因此，拉格朗日量 $L_{\\lambda}$ 是正则的当且仅当 $\\lambda \\neq 0$。考虑到约束 $\\lambda \\ge 0$，这意味着对于所有 $\\lambda > 0$，$L_{\\lambda}$ 都是正则的。\n当 $\\lambda=0$ 时，拉格朗日量是奇异的。在这种情况下，对于所有位形 $q \\in Q$，都有 $\\det W = 0$。正则性对整个系统都失效，而不仅仅是在一个特定的点。为了展示一个正则性失效的具体位形-速度点，对于 $\\lambda=0$ 的情况，我们可以选择 $TQ$ 中的任意一点。例如，在 $\\lambda=0$ 时，正则性在点 $q=(q_1,q_2)=(0,1)$ 和 $v=(v_1,v_2)=(1,0)$ 处失效。当 $\\lambda=0$ 时，动量由 $p_2 = -q_2 p_1$ 关联，这是一个表示简并性的主约束。\n\n### 第3部分：$\\lambda>0$ 时的哈密顿量\n\n对于 $\\lambda>0$，拉格朗日量是正则的，且勒让德变换是一个微分同胚。我们可以对动量的关系式求逆，以便将速度 $v$ 表示为相空间坐标 $(q,p)$ 的函数。这些关系是：\n1. $p_{1} = v_{1} - q_{2} v_{2}$\n2. $p_{2} = -q_{2} p_{1} + \\lambda v_{2}$\n\n从方程(2)，因为 $\\lambda>0$，我们可以解出 $v_2$：\n$$\n\\lambda v_{2} = p_{2} + q_{2} p_{1} \\implies v_{2} = \\frac{1}{\\lambda}(p_{2} + q_{2} p_{1}).\n$$\n将此代入方程(1)以解出 $v_1$：\n$$\nv_{1} = p_{1} + q_{2} v_{2} = p_{1} + q_{2} \\left[ \\frac{1}{\\lambda}(p_{2} + q_{2} p_{1}) \\right] = p_{1} + \\frac{q_2 p_2 + q_2^2 p_1}{\\lambda} = \\frac{\\lambda p_1 + q_2 p_2 + q_2^2 p_1}{\\lambda}.\n$$\n哈密顿量 $H_{\\lambda}(q,p)$ 由勒让德变换定义：\n$$\nH_{\\lambda}(q,p) = p_{1}v_{1} + p_{2}v_{2} - L_{\\lambda}(q,v),\n$$\n其中 $v$ 被消去，转而用 $p$ 表示。拉格朗日量的动能部分 $T=\\frac{1}{2}(v_1-q_2 v_2)^2 + \\frac{\\lambda}{2}v_2^2$ 是速度的二次型，并且可以写成 $T = \\frac{1}{2}v^T W v$。对于这样的拉格朗日量 $L = \\frac{1}{2}v^T W v - U$，哈密顿量由 $H = \\frac{1}{2}p^T W^{-1} p + U$ 给出。首先，我们计算 $W$ 的逆矩阵：\n$$\nW^{-1} = \\frac{1}{\\det W} \\begin{pmatrix} q_{2}^{2}+\\lambda  q_{2} \\\\ q_{2}  1 \\end{pmatrix} = \\frac{1}{\\lambda} \\begin{pmatrix} q_{2}^{2}+\\lambda  q_{2} \\\\ q_{2}  1 \\end{pmatrix}.\n$$\n现在我们计算二次型 $\\frac{1}{2}p^T W^{-1} p$：\n$$\n\\frac{1}{2} p^T W^{-1} p = \\frac{1}{2\\lambda} \\begin{pmatrix} p_{1}  p_{2} \\end{pmatrix} \\begin{pmatrix} q_{2}^{2}+\\lambda  q_{2} \\\\ q_{2}  1 \\end{pmatrix} \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix}\n$$\n$$\n= \\frac{1}{2\\lambda} \\begin{pmatrix} p_{1}  p_{2} \\end{pmatrix} \\begin{pmatrix} (q_{2}^{2}+\\lambda)p_{1} + q_{2}p_{2} \\\\ q_{2}p_{1} + p_{2} \\end{pmatrix}\n$$\n$$\n= \\frac{1}{2\\lambda} \\left[ p_{1}((q_{2}^{2}+\\lambda)p_{1} + q_{2}p_{2}) + p_{2}(q_{2}p_{1} + p_{2}) \\right]\n$$\n$$\n= \\frac{1}{2\\lambda} \\left[ (q_{2}^{2}+\\lambda)p_{1}^{2} + q_{2}p_{1}p_{2} + q_{2}p_{1}p_{2} + p_{2}^{2} \\right]\n$$\n$$\n= \\frac{1}{2\\lambda} \\left[ (\\lambda+q_{2}^{2})p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right].\n$$\n此表达式可以通过展开并重新组合各项来简化：\n$$\n\\frac{1}{2\\lambda} \\left[ \\lambda p_{1}^{2} + q_{2}^{2}p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right] = \\frac{\\lambda p_{1}^{2}}{2\\lambda} + \\frac{1}{2\\lambda} \\left[ q_{2}^{2}p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right]\n$$\n$$\n= \\frac{1}{2}p_{1}^{2} + \\frac{1}{2\\lambda} (q_{2}p_{1} + p_{2})^{2}.\n$$\n完整的哈密顿量通过加上势能项 $U(q)$ 得到：\n$$\nH_{\\lambda}(q,p) = \\frac{1}{2}p_{1}^{2} + \\frac{1}{2\\lambda}(q_{2}p_{1} + p_{2})^{2} + U(q).\n$$\n这是针对 $\\lambda > 0$ 的哈密顿量的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{2}p_{1}^{2} + \\frac{(q_{2}p_{1} + p_{2})^{2}}{2\\lambda} + U(q)}\n$$"
        },
        {
            "introduction": "当勒让德变换不可逆时，拉格朗日量是奇异的，通往哈密顿量的标准路径便被阻断。这种情况会在相空间上产生约束，需要借助强大的狄拉克-伯格曼算法来构建一个自洽的哈密顿描述。本问题将引导你实践这一核心算法，从识别主约束和次生约束，到计算狄拉克括号——它在约束子流形上取代了泊松括号的角色。",
            "id": "3778708",
            "problem": "考虑一个力学系统，其位形流形为 $\\mathbb{R}^{3}$，坐标为 $(x,y,z)$，拉格朗日量为\n$$\nL(x,y,z; v_{x}, v_{y}, v_{z}) \\;=\\; \\frac{1}{2} m \\left(v_{x}^{2} + v_{y}^{2}\\right) \\;+\\; c\\, z\\, v_{x} \\;+\\; d\\, x\\, v_{z},\n$$\n其中 $m>0$ 和 $c,d \\in \\mathbb{R}$ 是常数，且 $c \\neq d$。从纤维导数（勒让德变换）$p_{i} = \\partial L/\\partial v_{i}$ 和 $T^{*}\\mathbb{R}^{3}$ 上的正则泊松括号的核心定义出发，应用针对约束系统的狄拉克-伯格曼算法来：\n\n- 识别由纤维导数的简并性产生的主约束，\n- 构造正则哈密顿量，\n- 通过要求主约束随时间保持不变来寻找任何次级约束，\n- 确定所产生约束的类别（第一类或第二类）。\n\n假设算法在没有更多约束的情况下闭合，并且所有得到的约束都是第二类的。在最终的约束曲面上，计算坐标 $x$ 和 $z$ 之间的狄拉克括号，并用 $c$ 和 $d$ 的闭式解析表达式表示你的最终答案。不要提供中间结果；只给出狄拉克括号 $\\{x, z\\}_{D}$ 的最终表达式作为你的答案。",
            "solution": "首先验证该问题，以确保其具有科学依据、良定且客观。\n\n### 步骤1：提取已知条件\n-   位形流形：$\\mathbb{R}^{3}$，坐标为 $(x, y, z)$。\n-   拉格朗日量：$L(x,y,z; v_{x}, v_{y}, v_{z}) = \\frac{1}{2} m \\left(v_{x}^{2} + v_{y}^{2}\\right) + c\\, z\\, v_{x} + d\\, x\\, v_{z}$。\n-   常数：$m>0$，$c,d \\in \\mathbb{R}$，且 $c \\neq d$。\n-   步骤：应用狄拉克-伯格曼算法。\n-   任务：\n    1.  从勒让德变换 $p_{i} = \\partial L/\\partial v_{i}$ 中识别主约束。\n    2.  构造正则哈密顿量。\n    3.  通过要求主约束的时间守恒来寻找次级约束。\n    4.  确定所有约束的类别。\n-   假设：\n    1.  算法在找到次级约束后终止。\n    2.  所有约束都是第二类的。\n-   目标：在最终约束曲面上计算狄拉克括号 $\\{x, z\\}_{D}$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是哈密顿力学中关于简并拉格朗日量系统的一个标准练习。狄拉克-伯格曼算法是用于此目的的既定理论工具。该拉格朗日量虽然不对应于简单的教科书系统，但它是切丛 $T\\mathbb{R}^3$ 上的一个有效数学函数，并且速度的线性项在物理学中很常见（例如，电磁相互作用）。\n-   **良定性**：该问题是良定的。它提供了一个特定的拉格朗日量，并要求使用标准算法进行计算。条件 $m>0$ 和 $c \\neq d$，以及所有约束都是第二类的假设，确保了约束矩阵是可逆的，并且狄拉克括号是良定义的，从而得到唯一的解。\n-   **客观性**：该问题以精确的数学语言陈述，没有歧义或主观内容。\n\n该问题没有违反任何无效标准。它是理论力学中一个合法的、非平凡的问题。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 求解推导\n\n通过应用狄拉克-伯格曼算法进行分析。\n\n首先，我们通过拉格朗日量 $L$ 的纤维导数（也称为勒让德变换）来定义正则动量 $p_i$。设坐标为 $q = (x,y,z)$，速度为 $v = (v_x, v_y, v_z)$。\n$$\np_x = \\frac{\\partial L}{\\partial v_x} = m v_x + c z\n$$\n$$\np_y = \\frac{\\partial L}{\\partial v_y} = m v_y\n$$\n$$\np_z = \\frac{\\partial L}{\\partial v_z} = d x\n$$\n我们尝试用相空间变量 $(q, p)$ 来表示速度。\n由前两个方程，因为 $m>0$：\n$$\nv_x = \\frac{1}{m}(p_x - c z)\n$$\n$$\nv_y = \\frac{1}{m} p_y\n$$\n第三个方程 $p_z = d x$ 不涉及任何速度分量。这意味着无法用正则变量解出 $v_z$。因此，这个方程是相空间上的一个约束，称为主约束。\n$$\n\\phi_1(x, p_z) = p_z - d x \\approx 0\n$$\n符号 $\\approx$ 表示在相空间的约束子流形上成立的“弱相等”。\n\n接下来，我们构造正则哈密顿量 $H_c = \\sum_i p_i v_i - L$。速度 $v_z$ 是不确定的，所以我们暂时将其视为一个自由参数。\n$$\nH_c = p_x v_x + p_y v_y + p_z v_z - \\left( \\frac{1}{2} m (v_x^2 + v_y^2) + c z v_x + d x v_z \\right)\n$$\n代入 $v_x$ 和 $v_y$ 的表达式：\n$$\nH_c = p_x \\left(\\frac{p_x - c z}{m}\\right) + p_y \\left(\\frac{p_y}{m}\\right) + p_z v_z - \\left[ \\frac{1}{2}m \\left( \\left(\\frac{p_x-cz}{m}\\right)^2 + \\left(\\frac{p_y}{m}\\right)^2 \\right) + c z \\left(\\frac{p_x - cz}{m}\\right) + d x v_z \\right]\n$$\n经过代数化简，得到：\n$$\nH_c = \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m} + (p_z - dx)v_z\n$$\n系统的动力学由总哈密顿量 $H_T$ 控制，它是正则哈密顿量加上所有主约束乘以时间的任意函数（拉格朗日乘子）。\n$$\nH_T = H_0 + u \\phi_1\n$$\n其中 $H_0 = \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m}$ 是 $H_c$ 在主约束曲面上定义的部分，而 $u$ 是一个拉格朗日乘子（可以等同于 $v_z$）。\n\n为了使系统的轨迹保持在约束曲面上，主约束必须随时间保持不变。这意味着它与总哈密顿量的泊松括号必须弱等于零。\n$$\n\\dot{\\phi}_1 = \\{\\phi_1, H_T\\} = \\{\\phi_1, H_0 + u\\phi_1\\} = \\{\\phi_1, H_0\\} + u\\{\\phi_1, \\phi_1\\} \\approx 0\n$$\n由于 $\\{\\phi_1, \\phi_1\\} = 0$，我们只需要计算 $\\{\\phi_1, H_0\\}$。正则泊松括号为 $\\{f, g\\} = \\sum_i (\\frac{\\partial f}{\\partial q_i}\\frac{\\partial g}{\\partial p_i} - \\frac{\\partial f}{\\partial p_i}\\frac{\\partial g}{\\partial q_i})$。\n$$\n\\{\\phi_1, H_0\\} = \\{p_z - dx, \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m}\\}\n$$\n$\\phi_1 = p_z - dx$ 唯一不为零的偏导数是 $\\frac{\\partial \\phi_1}{\\partial x} = -d$ 和 $\\frac{\\partial \\phi_1}{\\partial p_z} = 1$。与它们配对的 $H_0$ 的唯一不为零的偏导数是 $\\frac{\\partial H_0}{\\partial p_x} = \\frac{1}{m}(p_x-cz)$ 和 $\\frac{\\partial H_0}{\\partial z} = -\\frac{c}{m}(p_x-cz)$。\n$$\n\\{\\phi_1, H_0\\} = \\frac{\\partial \\phi_1}{\\partial x}\\frac{\\partial H_0}{\\partial p_x} - \\frac{\\partial \\phi_1}{\\partial p_z}\\frac{\\partial H_0}{\\partial z} = (-d)\\left(\\frac{p_x-cz}{m}\\right) - (1)\\left(-\\frac{c}{m}(p_x-cz)\\right) = \\frac{c-d}{m}(p_x-cz)\n$$\n因此，条件 $\\dot{\\phi}_1 \\approx 0$ 意味着 $\\frac{c-d}{m}(p_x-cz) \\approx 0$。由于给定 $m>0$ 和 $c \\neq d$，这导出一个次级约束：\n$$\n\\phi_2(x, z, p_x) = p_x - cz \\approx 0\n$$\n根据问题陈述，我们假设算法闭合。我们通过检查 $\\phi_2$ 的时间守恒来验证这一点：\n$$\n\\dot{\\phi}_2 = \\{\\phi_2, H_T\\} = \\{\\phi_2, H_0\\} + u\\{\\phi_2, \\phi_1\\} \\approx 0\n$$\n首先，我们计算 $\\{\\phi_2, H_0\\}$：\n$$\n\\{\\phi_2, H_0\\} = \\{p_x - cz, \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m}\\} = \\{p_x-cz, \\frac{1}{2m}(p_x-cz)^2\\} = 0\n$$\n接下来，我们计算 $\\{\\phi_2, \\phi_1\\}$：\n$$\n\\{\\phi_2, \\phi_1\\} = \\{p_x - cz, p_z - dx\\} = \\frac{\\partial \\phi_2}{\\partial z}\\frac{\\partial \\phi_1}{\\partial p_z} - \\frac{\\partial \\phi_2}{\\partial p_x}\\frac{\\partial \\phi_1}{\\partial x} = (-c)(1) - (1)(-d) = d-c\n$$\n条件 $\\dot{\\phi}_2 \\approx 0$ 变为 $u(d-c) \\approx 0$。由于 $d \\neq c$，这确定了拉格朗日乘子：$u=0$。没有生成新的约束，算法终止。\n\n我们有两个约束 $\\phi_1$ 和 $\\phi_2$。问题说明它们是第二类的。我们构建约束矩阵 $C_{ij} = \\{\\phi_i, \\phi_j\\}$。\n$$\nC_{11} = \\{\\phi_1, \\phi_1\\} = 0\n$$\n$$\nC_{12} = \\{\\phi_1, \\phi_2\\} = -\\{\\phi_2, \\phi_1\\} = -(d-c) = c-d\n$$\n$$\nC_{21} = \\{\\phi_2, \\phi_1\\} = d-c\n$$\n$$\nC_{22} = \\{\\phi_2, \\phi_2\\} = 0\n$$\n约束矩阵是 $C = \\begin{pmatrix} 0  c-d \\\\ d-c  0 \\end{pmatrix}$。其行列式为 $\\det(C) = -(c-d)(d-c) = (c-d)^2$。由于 $c \\neq d$，$\\det(C) \\neq 0$，所以该矩阵是可逆的，约束确实是第二类的。\n逆矩阵为：\n$$\nC^{-1} = \\frac{1}{(c-d)^2} \\begin{pmatrix} 0  d-c \\\\ c-d  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{d-c}{(c-d)^2} \\\\ \\frac{c-d}{(c-d)^2}  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\frac{1}{c-d} \\\\ \\frac{1}{c-d}  0 \\end{pmatrix}\n$$\n两个函数 $f$ 和 $g$ 的狄拉克括号定义为 $\\{f, g\\}_D = \\{f, g\\} - \\sum_{i,j=1,2} \\{f, \\phi_i\\} (C^{-1})_{ij} \\{\\phi_j, g\\}$。我们想计算 $\\{x, z\\}_D$。\n\n首先，正则括号 $\\{x, z\\} = 0$。\n接下来，我们计算 $x$ 和 $z$ 与约束的括号：\n$$\n\\{x, \\phi_1\\} = \\{x, p_z - dx\\} = \\{x, p_z\\} - d\\{x, x\\} = 0 - 0 = 0\n$$\n$$\n\\{x, \\phi_2\\} = \\{x, p_x - cz\\} = \\{x, p_x\\} - c\\{x, z\\} = 1 - 0 = 1\n$$\n$$\n\\{\\phi_1, z\\} = \\{p_z - dx, z\\} = \\{p_z, z\\} - d\\{x, z\\} = -1 - 0 = -1\n$$\n$$\n\\{\\phi_2, z\\} = \\{p_x - cz, z\\} = \\{p_x, z\\} - c\\{z, z\\} = 0 - 0 = 0\n$$\n现在，我们计算修正项：\n$$\n\\sum_{i,j} \\{x, \\phi_i\\} (C^{-1})_{ij} \\{\\phi_j, g\\} = \n\\begin{pmatrix} \\{x, \\phi_1\\}  \\{x, \\phi_2\\} \\end{pmatrix} \n\\begin{pmatrix} (C^{-1})_{11}  (C^{-1})_{12} \\\\ (C^{-1})_{21}  (C^{-1})_{22} \\end{pmatrix} \n\\begin{pmatrix} \\{\\phi_1, z\\} \\\\ \\{\\phi_2, z\\} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0  1 \\end{pmatrix} \n\\begin{pmatrix} 0  -1/(c-d) \\\\ 1/(c-d)  0 \\end{pmatrix} \n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\n$$\n进行矩阵乘法：\n$$\n= \\begin{pmatrix} 1/(c-d)  0 \\end{pmatrix} \n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = -\\frac{1}{c-d}\n$$\n最后，狄拉克括号是：\n$$\n\\{x, z\\}_D = \\{x, z\\} - \\left(-\\frac{1}{c-d}\\right) = 0 - \\left(-\\frac{1}{c-d}\\right) = \\frac{1}{c-d}\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{c-d}}\n$$"
        },
        {
            "introduction": "正则性不仅是一个全局属性，它也可能在位形空间的特定子流形上失效，从而产生丰富的物理现象。本练习探讨了一个具有旋转对称性的系统，其转动惯量依赖于位形并在某处为零，导致了所谓的G-正则性失效。通过执行鲁斯约化并分析其有效势，你将揭示数学上的奇异性如何导致物理上的离心势垒和动力学分岔，这是几何力学中的一个核心主题。",
            "id": "3765240",
            "problem": "考虑一个机械系统，其位形空间为 $Q = \\mathbb{R}^{2} \\times S^{1}$，坐标为 $(x,y,\\phi)$，拉格朗日量的形式为\n$$\nL(x,y,\\phi;\\dot{x},\\dot{y},\\dot{\\phi}) \\;=\\; \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) \\;+\\; \\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\dot{\\phi} \\;+\\; \\alpha \\left(y\\,\\dot{x} \\;-\\; x\\,\\dot{y}\\right)\\right)^{2} \\;-\\; V(x,y),\n$$\n其中 $m>0$, $\\gamma>0$ 和 $\\alpha \\in \\mathbb{R}$ 是常数，而 $V:\\mathbb{R}^{2}\\to\\mathbb{R}$ 是一个在 $(x,y)=(0,0)$ 处具有非退化极小值的光滑势。圆 $S^{1}$ 通过在 $\\phi$ 上的平移作用，使得 $\\phi$ 成为一个循环坐标。该模型通过函数 $\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)$ 捕捉了一个具有规范式动能耦合的主圆丛，以及一个沿子流形 $\\mathcal{S}=\\{(x,y)\\in\\mathbb{R}^{2}\\mid x=0\\}$ 消失的、依赖于位形的转动惯量 $I(x,y)=\\gamma x^{2}$。\n\n仅从循环坐标、守恒动量以及针对具有一维纤维（圆 $S^{1}$）的对称群的劳斯约化的定义出发，执行以下操作：\n\n1. 识别与循环坐标相关的守恒动量，并说明在该系统中群正则性（也称为 G-正则性）条件满足或不满足的条件。\n\n2. 在 G-正则性成立的开子集上，对固定的动量 $\\mu \\in \\mathbb{R}$ 进行劳斯约化，并消去 $\\dot{\\phi}$ 以获得一个纯粹用 $(x,y)$ 和 $(\\dot{x},\\dot{y})$ 表示的约化劳斯函数。\n\n3. 基于基本原理，用文字分析当 $\\mu$ 变化时，约化动力学在 $\\mathcal{S}$ 附近的有效自由度数如何变化，并讨论由于沿 $\\mathcal{S}$ 的 G-正则性失效以及 $V$ 的非退化极小值的存在，约化动力学在 $(x,y)=(0,0)$ 附近可能经历分岔的定性机制。\n\n你的最终答案必须是第 2 项中推导出的约化劳斯函数的单个闭式解析表达式。不需要进行数值计算，最终答案中也不应包含单位。如果在任何中间步骤中使用了三角函数或指数函数，请以精确形式保留它们。",
            "solution": "首先验证问题，以确保其科学上成立、良定且客观。\n\n### 第 1 步：提取已知条件\n- 位形空间: $Q = \\mathbb{R}^{2} \\times S^{1}$，坐标为 $(x,y,\\phi)$。\n- 拉格朗日量: $L(x,y,\\phi;\\dot{x},\\dot{y},\\dot{\\phi}) = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)^{2} - V(x,y)$。\n- 常数: $m>0$, $\\gamma>0$, $\\alpha \\in \\mathbb{R}$。\n- 势: $V:\\mathbb{R}^{2}\\to\\mathbb{R}$ 是一个在 $(x,y)=(0,0)$ 处具有非退化极小值的光滑势。\n- 对称性: 圆群 $S^{1}$ 通过在 $\\phi$ 上的平移作用，因此 $\\phi$ 是一个循环坐标。\n- 转动惯量消失的子流形: $\\mathcal{S}=\\{(x,y)\\in\\mathbb{R}^{2}\\mid x=0\\}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学上成立:** 该问题在流形上的拉格朗日力学的既定框架内描述了一个机械系统，特别是针对具有对称性的系统进行劳斯约化。拉格朗日量具有卡鲁扎-克莱因（Kaluza-Klein）或规范式结构，这是几何力学中一个标准且经过充分研究的课题。依赖于位形并在子流形上消失的转动惯量是奇异约化问题的关键特征。所有方面都牢固地植根于数学物理学。\n- **良定:** 问题陈述清晰，包含所有必要的定义和约束。任务是具体的，可以导出一个唯一的约化劳斯函数解析表达式和一个明确的定性分析。\n- **客观:** 问题以精确的数学语言表述，没有任何主观性或歧义。\n\n### 第 3 步：结论与行动\n问题是**有效的**。将提供完整解答。\n\n***\n\n### 1. 守恒动量与 G-正则性条件\n\n如果拉格朗日量不显式依赖于某个坐标，则该坐标是循环坐标。给定的拉格朗日量 $L$ 与 $\\phi$ 无关，因此 $\\phi$ 是一个循环坐标。根据诺特定理，这种在 $\\phi$ 平移下的不变性意味着存在一个守恒量，即与 $\\phi$ 共轭的正则动量。该动量记为 $p_{\\phi}$，定义为：\n$$\np_{\\phi} = \\frac{\\partial L}{\\partial \\dot{\\phi}}\n$$\n根据给定的拉格朗日量计算此导数：\n$$\np_{\\phi} = \\frac{\\partial}{\\partial \\dot{\\phi}} \\left[ \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)^{2} - V(x,y) \\right]\n$$\n$$\np_{\\phi} = \\gamma x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)\n$$\n这个量沿着系统的任何轨迹都是守恒的，因此我们设 $p_{\\phi} = \\mu$，其中 $\\mu \\in \\mathbb{R}$ 是一个常数。\n\n群正则性条件（或在对称群 $G$ 的背景下称为 G-正则性条件，这里 $G=S^1$）关系到纤维勒让德变换的可逆性，该变换将纤维速度映射到纤维动量。具体来说，它要求我们能够根据动量 $\\mu$ 和其余的坐标 $(x,y)$ 及速度 $(\\dot{x},\\dot{y})$ 唯一地解出速度 $\\dot{\\phi}$。这当且仅当拉格朗日量对纤维速度的二阶导数非零时才可能。这个量 $\\frac{\\partial^{2} L}{\\partial \\dot{\\phi}^{2}}$ 对应于动能度量张量沿纤维方向的分量，也称为转动惯量。\n$$\n\\frac{\\partial^{2} L}{\\partial \\dot{\\phi}^{2}} = \\frac{\\partial}{\\partial \\dot{\\phi}} \\left( \\gamma x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right) \\right) = \\gamma x^{2}\n$$\n由于根据定义 $\\gamma > 0$，G-正则性条件满足当且仅当 $\\gamma x^{2} \\neq 0$，这等价于 $x \\neq 0$。该条件在子流形 $\\mathcal{S}=\\{(x,y)\\in\\mathbb{R}^{2}\\mid x=0\\}$ 上不成立，在此处，$\\phi$ 转动的有效转动惯量为零。\n\n### 2. 劳斯约化与约化劳斯函数\n\n劳斯约化是消除一个循环坐标以获得一个在较低维空间上的约化动力系统的过程。劳斯函数 $R_{\\mu}$ 作为约化系统的有效拉格朗日量。它被定义为 $R_{\\mu} = L - p_{\\phi}\\dot{\\phi}$，在常数动量 $p_{\\phi} = \\mu$ 下求值，并将 $\\dot{\\phi}$ 用其他变量表示。\n\n首先，我们假设 $x \\neq 0$，求解动量守恒方程以得到 $\\dot{\\phi}$：\n$$\n\\mu = \\gamma x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)\n$$\n$$\n\\frac{\\mu}{\\gamma x^{2}} = \\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\n$$\n$$\n\\dot{\\phi} = \\frac{\\mu}{\\gamma x^{2}} - \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\n$$\n现在，我们构造劳斯函数 $R_{\\mu} = L - \\mu \\dot{\\phi}$：\n$$\nR_{\\mu} = \\left[ \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)^{2} - V(x,y) \\right] - \\mu \\dot{\\phi}\n$$\n我们可以通过代入动量方程中的关系式 $\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right) = \\frac{\\mu}{\\gamma x^{2}}$ 来简化包含平方括号的项。\n$$\n\\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\frac{\\mu}{\\gamma x^{2}}\\right)^{2} = \\frac{1}{2}\\, \\gamma\\, x^{2} \\frac{\\mu^{2}}{\\gamma^{2} x^{4}} = \\frac{\\mu^{2}}{2\\gamma x^{2}}\n$$\n将此代入 $R_{\\mu}$ 的表达式中：\n$$\nR_{\\mu} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{\\mu^{2}}{2\\gamma x^{2}} - V(x,y) - \\mu \\dot{\\phi}\n$$\n最后，我们代入 $\\dot{\\phi}$ 的表达式：\n$$\nR_{\\mu} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{\\mu^{2}}{2\\gamma x^{2}} - V(x,y) - \\mu \\left( \\frac{\\mu}{\\gamma x^{2}} - \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right) \\right)\n$$\n展开并合并项：\n$$\nR_{\\mu} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{\\mu^{2}}{2\\gamma x^{2}} - \\frac{\\mu^{2}}{\\gamma x^{2}} - V(x,y) + \\mu\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\n$$\n纯粹用 $(x,y)$ 和 $(\\dot{x},\\dot{y})$ 表示的约化劳斯函数为：\n$$\nR_{\\mu}(x,y,\\dot{x},\\dot{y}) = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\mu\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right) - V(x,y) - \\frac{\\mu^{2}}{2\\gamma x^{2}}\n$$\n\n### 3. 约化动力学与分岔分析\n\n劳斯函数具有一个质量为 $m$ 的粒子在坐标为 $(x,y)$ 的二维位形空间中运动的拉格朗日量的结构。只要约化是正则的 ($x \\neq 0$)，系统就有 2 个自由度。运动由一个有效势和附加的速度相关力所支配。\n劳斯函数可以写成 $R_{\\mu} = T_{red} + A_{\\mu} - V_{eff}$，其中：\n- $T_{red} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right)$ 是约化动能。\n- $A_{\\mu} = \\mu\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)$ 是一个磁力项或陀螺项。它产生一个与速度成正比且垂直于速度的力，类似于磁场中的洛伦兹力。\n- $V_{eff} = V(x,y) + \\frac{\\mu^{2}}{2\\gamma x^{2}}$ 是有效势。第二项 $V_{cent} = \\frac{\\mu^{2}}{2\\gamma x^{2}}$ 被称为离心势，它源于循环运动的惯性。\n\n在劳斯函数良定的任何地方（即 $x \\neq 0$），有效自由度数为 2。在子流形 $\\mathcal{S}$（其中 $x=0$）附近的行为严重依赖于动量 $\\mu$ 的值。\n\n- **对于 $\\mu \\neq 0$**: 离心势 $V_{cent}$ 沿着直线 $x=0$ 产生一个无限高的势垒。这个势垒有效地将动力学限制在两个半平面之一，即 $x > 0$ 或 $x < 0$，阻止系统到达 G-正则性失效的子流形 $\\mathcal{S}$。系统在受限的定义域上严格保持为一个 2 自由度系统。\n\n- **对于 $\\mu = 0$**: 离心势和陀螺项都消失了。劳斯函数简化为 $R_{0} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) - V(x,y)$。约化动力学就是粒子在原始势 $V(x,y)$ 中运动的动力学。系统现在可以到达直线 $x=0$。在这条线上，原始问题是奇异的，但在 $\\mu=0$ 的约化图像中，动力学是完全正则的。\n\n当 $\\mu$ 变化时，有效势结构的这种改变导致了约化系统在原点 $(0,0)$ 附近的平衡结构发生分岔。\n\n- 势 $V(x,y)$ 在 $(0,0)$ 处有一个非退化极小值。对于 $\\mu=0$，$V_{eff} = V(x,y)$，所以约化系统在 $(0,0)$ 有一个稳定平衡点。\n\n- 对于 $\\mu \\neq 0$，平衡点可以通过将有效势的梯度设为零来找到：$\\nabla V_{eff} = 0$。\n  $$\n  \\frac{\\partial V_{eff}}{\\partial x} = \\frac{\\partial V}{\\partial x} - \\frac{\\mu^{2}}{\\gamma x^{3}} = 0\n  $$\n  $$\n  \\frac{\\partial V_{eff}}{\\partial y} = \\frac{\\partial V}{\\partial y} = 0\n  $$\n  由于奇异项 $\\frac{\\mu^{2}}{\\gamma x^{3}}$ 的存在，原点 $(0,0)$ 不再是一个解。对于任何非零动量 $\\mu$，原点处的原始稳定平衡点被离心力破坏。$V$ 的约束性质（将系统拉向原点）和 $V_{cent}$ 的排斥性质（将系统推离 $y$ 轴）相互竞争。这种竞争导致在远离 $y$ 轴的地方出现新的平衡位置。在原点附近，$\\frac{\\partial V}{\\partial x} \\approx k_{xx} x$（对于某个常数 $k_{xx} > 0$），第一个方程变为 $k_{xx} x \\approx \\frac{\\mu^{2}}{\\gamma x^{3}}$，导致 $x_{eq}$ 的解满足 $x_{eq}^4 \\propto \\mu^2$。这表明，对于任何无穷小但非零的 $\\mu$，$x=0$ 处的平衡点会分裂成两个位于 $x \\neq 0$ 的新平衡点。这是一个叉式分岔。系统相图的定性变化是由约化的奇异性驱动的，即在 $x=0$ 处转动惯量的消失为任何非零角动量产生了无限强的离心排斥力。",
            "answer": "$$\n\\boxed{\\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\mu\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right) - V(x,y) - \\frac{\\mu^{2}}{2\\gamma x^{2}}}\n$$"
        }
    ]
}