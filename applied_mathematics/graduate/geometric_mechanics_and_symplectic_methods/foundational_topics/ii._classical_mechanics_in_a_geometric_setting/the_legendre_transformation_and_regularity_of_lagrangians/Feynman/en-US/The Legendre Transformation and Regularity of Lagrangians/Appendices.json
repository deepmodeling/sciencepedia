{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a fundamental workout in applying the core definitions of the Legendre transformation. You will analyze a parameterized Lagrangian to see precisely how regularity is determined by the non-singularity of the fiber Hessian matrix. By explicitly calculating the Hamiltonian for the regular case, you will practice the complete procedure of transitioning from the Lagrangian description on the tangent bundle to the Hamiltonian description on the cotangent bundle. ",
            "id": "3778709",
            "problem": "Let $Q=\\mathbb{R}^{2}$ be a configuration manifold with global coordinates $(q_{1},q_{2})$ and let $(v_{1},v_{2})$ denote the corresponding fiber coordinates on the tangent bundle $TQ$. Consider the one-parameter family of Lagrangians $L_{\\lambda}:TQ\\to\\mathbb{R}$ given by\n$$\nL_{\\lambda}(q,v)=\\frac{1}{2}\\big(v_{1}-q_{2}v_{2}\\big)^{2}+\\frac{\\lambda}{2}\\,v_{2}^{2}-U(q),\n$$\nwhere $q=(q_{1},q_{2})$, $v=(v_{1},v_{2})$, $\\lambda\\ge 0$ is a parameter, and $U:Q\\to\\mathbb{R}$ is a fixed smooth potential.\n\nUsing only the fundamental definitions of the Legendre transformation and the regularity of a Lagrangian, do the following:\n\n- Derive the momenta $p_{i}=\\frac{\\partial L_{\\lambda}}{\\partial v_{i}}$ and the fiber Hessian matrix $W_{ij}=\\frac{\\partial^{2}L_{\\lambda}}{\\partial v_{i}\\partial v_{j}}$. Compute $\\det W$ explicitly as a function of $q$ and $\\lambda$.\n\n- From $\\det W$, decide for which values of $\\lambda$ the Lagrangian $L_{\\lambda}$ is regular, and exhibit a specific configuration–velocity point $(q,v)\\in TQ$ at which regularity fails when it does.\n\n- For $\\lambda>0$, invert the Legendre transformation to express $v$ in terms of $(q,p)$, and then compute the Hamiltonian $H_{\\lambda}(q,p)$ defined by\n$$\nH_{\\lambda}(q,p)=p_{1}v_{1}+p_{2}v_{2}-L_{\\lambda}(q,v),\n$$\nwith $v$ eliminated in favor of $(q,p)$ via the inverse Legendre transformation. Provide your final result as a single explicit analytic expression in terms of $(q,p)$ and $\\lambda$.\n\nYour final answer must be the single closed-form expression for $H_{\\lambda}(q,p)$ for $\\lambda>0$.",
            "solution": "The one-parameter family of Lagrangians is given by\n$$\nL_{\\lambda}(q,v)=\\frac{1}{2}\\big(v_{1}-q_{2}v_{2}\\big)^{2}+\\frac{\\lambda}{2}\\,v_{2}^{2}-U(q),\n$$\nwhere $q=(q_{1},q_{2})$, $v=(v_{1},v_{2})$, and $\\lambda \\ge 0$.\n\n### Part 1: Momenta and Fiber Hessian\n\nFirst, we compute the canonically conjugate momenta $p_{i}$ using the definition $p_{i} = \\frac{\\partial L_{\\lambda}}{\\partial v_{i}}$.\nFor $i=1$:\n$$\np_{1} = \\frac{\\partial L_{\\lambda}}{\\partial v_{1}} = \\frac{1}{2} \\cdot 2(v_{1}-q_{2}v_{2})\\frac{\\partial}{\\partial v_{1}}(v_{1}-q_{2}v_{2}) = v_{1}-q_{2}v_{2}.\n$$\nFor $i=2$:\n$$\np_{2} = \\frac{\\partial L_{\\lambda}}{\\partial v_{2}} = \\frac{1}{2} \\cdot 2(v_{1}-q_{2}v_{2})\\frac{\\partial}{\\partial v_{2}}(v_{1}-q_{2}v_{2}) + \\frac{\\lambda}{2}(2v_{2}) = (v_{1}-q_{2}v_{2})(-q_{2}) + \\lambda v_{2}.\n$$\nSubstituting the expression for $p_1$ into the expression for $p_2$, we get:\n$$\np_{2} = -q_{2}p_{1} + \\lambda v_{2}.\n$$\nNext, we compute the fiber Hessian matrix $W$, whose components are $W_{ij} = \\frac{\\partial^{2}L_{\\lambda}}{\\partial v_{i}\\partial v_{j}} = \\frac{\\partial p_{i}}{\\partial v_{j}}$.\n$$\nW_{11} = \\frac{\\partial p_{1}}{\\partial v_{1}} = \\frac{\\partial}{\\partial v_{1}}(v_{1}-q_{2}v_{2}) = 1.\n$$\n$$\nW_{12} = \\frac{\\partial p_{1}}{\\partial v_{2}} = \\frac{\\partial}{\\partial v_{2}}(v_{1}-q_{2}v_{2}) = -q_{2}.\n$$\nTo compute the second row, we first express $p_2$ fully in terms of velocities: $p_2 = -q_2v_1 + q_2^2 v_2 + \\lambda v_2 = -q_2v_1 + (q_2^2+\\lambda)v_2$.\n$$\nW_{21} = \\frac{\\partial p_{2}}{\\partial v_{1}} = \\frac{\\partial}{\\partial v_{1}}(-q_{2}v_{1} + (q_{2}^{2}+\\lambda)v_{2}) = -q_{2}.\n$$\n$$\nW_{22} = \\frac{\\partial p_{2}}{\\partial v_{2}} = \\frac{\\partial}{\\partial v_{2}}(-q_{2}v_{1} + (q_{2}^{2}+\\lambda)v_{2}) = q_{2}^{2}+\\lambda.\n$$\nThe fiber Hessian matrix is therefore:\n$$\nW = \\begin{pmatrix} W_{11} & W_{12} \\\\ W_{21} & W_{22} \\end{pmatrix} = \\begin{pmatrix} 1 & -q_{2} \\\\ -q_{2} & q_{2}^{2}+\\lambda \\end{pmatrix}.\n$$\nThe determinant of $W$ is:\n$$\n\\det W = (1)(q_{2}^{2}+\\lambda) - (-q_{2})(-q_{2}) = q_{2}^{2}+\\lambda-q_{2}^{2} = \\lambda.\n$$\nSo, $\\det W = \\lambda$, which depends only on the parameter $\\lambda$ and not on the configuration $q$.\n\n### Part 2: Regularity of the Lagrangian\n\nA Lagrangian is defined as regular if its fiber Hessian matrix is non-singular, which means $\\det W \\neq 0$.\nFrom our calculation, $\\det W = \\lambda$. Therefore, the Lagrangian $L_{\\lambda}$ is regular if and only if $\\lambda \\neq 0$. Given the constraint $\\lambda \\ge 0$, this implies that $L_{\\lambda}$ is regular for all $\\lambda > 0$.\nThe Lagrangian is singular when $\\lambda=0$. In this case, $\\det W = 0$ for all configurations $q \\in Q$. Regularity fails for the entire system, not just at a specific point. To exhibit a specific configuration-velocity point where regularity fails, we can choose any point in $TQ$ for the case $\\lambda=0$. For instance, at $\\lambda=0$, regularity fails at the point where $q=(q_1,q_2)=(0,1)$ and $v=(v_1,v_2)=(1,0)$. When $\\lambda=0$, the momenta are related by $p_2 = -q_2 p_1$, a primary constraint indicating degeneracy.\n\n### Part 3: Hamiltonian for $\\lambda>0$\n\nFor $\\lambda>0$, the Lagrangian is regular, and the Legendre transformation is a diffeomorphism. We can invert the relations for the momenta to express the velocities $v$ in terms of the phase space coordinates $(q,p)$. The relations are:\n1. $p_{1} = v_{1} - q_{2} v_{2}$\n2. $p_{2} = -q_{2} p_{1} + \\lambda v_{2}$\n\nFrom equation (2), since $\\lambda>0$, we can solve for $v_2$:\n$$\n\\lambda v_{2} = p_{2} + q_{2} p_{1} \\implies v_{2} = \\frac{1}{\\lambda}(p_{2} + q_{2} p_{1}).\n$$\nSubstitute this into equation (1) to solve for $v_1$:\n$$\nv_{1} = p_{1} + q_{2} v_{2} = p_{1} + q_{2} \\left[ \\frac{1}{\\lambda}(p_{2} + q_{2} p_{1}) \\right] = p_{1} + \\frac{q_2 p_2 + q_2^2 p_1}{\\lambda} = \\frac{\\lambda p_1 + q_2 p_2 + q_2^2 p_1}{\\lambda}.\n$$\nThe Hamiltonian $H_{\\lambda}(q,p)$ is defined by the Legendre transform:\n$$\nH_{\\lambda}(q,p) = p_{1}v_{1} + p_{2}v_{2} - L_{\\lambda}(q,v),\n$$\nwhere $v$ is eliminated in favor of $p$. The kinetic part of the Lagrangian, $T=\\frac{1}{2}(v_1-q_2 v_2)^2 + \\frac{\\lambda}{2}v_2^2$, is quadratic in velocities and can be written as $T = \\frac{1}{2}v^T W v$. For such Lagrangians, $L = \\frac{1}{2}v^T W v - U$, the Hamiltonian is given by $H = \\frac{1}{2}p^T W^{-1} p + U$. First, we compute the inverse of $W$:\n$$\nW^{-1} = \\frac{1}{\\det W} \\begin{pmatrix} q_{2}^{2}+\\lambda & q_{2} \\\\ q_{2} & 1 \\end{pmatrix} = \\frac{1}{\\lambda} \\begin{pmatrix} q_{2}^{2}+\\lambda & q_{2} \\\\ q_{2} & 1 \\end{pmatrix}.\n$$\nNow we compute the quadratic form $\\frac{1}{2}p^T W^{-1} p$:\n$$\n\\frac{1}{2} p^T W^{-1} p = \\frac{1}{2\\lambda} \\begin{pmatrix} p_{1} & p_{2} \\end{pmatrix} \\begin{pmatrix} q_{2}^{2}+\\lambda & q_{2} \\\\ q_{2} & 1 \\end{pmatrix} \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix}\n$$\n$$\n= \\frac{1}{2\\lambda} \\begin{pmatrix} p_{1} & p_{2} \\end{pmatrix} \\begin{pmatrix} (q_{2}^{2}+\\lambda)p_{1} + q_{2}p_{2} \\\\ q_{2}p_{1} + p_{2} \\end{pmatrix}\n$$\n$$\n= \\frac{1}{2\\lambda} \\left[ p_{1}((q_{2}^{2}+\\lambda)p_{1} + q_{2}p_{2}) + p_{2}(q_{2}p_{1} + p_{2}) \\right]\n$$\n$$\n= \\frac{1}{2\\lambda} \\left[ (q_{2}^{2}+\\lambda)p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right].\n$$\nThis expression can be simplified by expanding and regrouping terms:\n$$\n\\frac{1}{2\\lambda} \\left[ \\lambda p_{1}^{2} + q_{2}^{2}p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right] = \\frac{\\lambda p_{1}^{2}}{2\\lambda} + \\frac{1}{2\\lambda} \\left[ q_{2}^{2}p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right]\n$$\n$$\n= \\frac{1}{2}p_{1}^{2} + \\frac{1}{2\\lambda} (q_{2}p_{1} + p_{2})^{2}.\n$$\nThe full Hamiltonian is obtained by adding the potential term $U(q)$:\n$$\nH_{\\lambda}(q,p) = \\frac{1}{2}p_{1}^{2} + \\frac{1}{2\\lambda}(q_{2}p_{1} + p_{2})^{2} + U(q).\n$$\nThis is the final expression for the Hamiltonian for $\\lambda > 0$.",
            "answer": "$$\n\\boxed{\\frac{1}{2}p_{1}^{2} + \\frac{(q_{2}p_{1} + p_{2})^{2}}{2\\lambda} + U(q)}\n$$"
        },
        {
            "introduction": "Building on the test for regularity, we now explore the consequences of its failure. This problem investigates a singular Lagrangian, where the Legendre map is not invertible, leading directly to a primary constraint that restricts the dynamics to a submanifold of the phase space. This practice offers a foundational look at the origin of constraints and also connects the structure of the Lagrangian to the important concept of gauge freedom, revealing how certain ambiguities in the Lagrangian manifest within the Hamiltonian framework. ",
            "id": "3768261",
            "problem": "Consider a one-dimensional configuration space with coordinate $x(t)$ and a Lagrangian $L(x,\\dot{x})=\\frac{1}{2}m\\,\\dot{x}^{2}+\\lambda(x)\\,\\dot{x}$, where $m$ is a constant parameter and $\\lambda(x)$ is a smooth function. Using the geometric Legendre transform from the tangent bundle to the cotangent bundle and the Dirac–Bergmann theory of constraints, determine whether the Lagrangian is regular and identify any primary constraints. Explicitly construct the primary constraint function $\\phi(x,p)$ on phase space when the Legendre map is not invertible. Then analyze how adding a total time derivative $dA(x)/dt$ of a smooth function $A(x)$ to the Lagrangian affects the canonical momentum and interpret this as a gauge freedom in the canonical one-form and symplectic structure.\n\nAnswer specification:\n- Provide the primary constraint function as a single closed-form analytic expression in $x$ and $p$.\n- No numerical values are required.\n- If no primary constraint exists, you must still provide the constraint function as an explicit expression and justify your choice in the solution.",
            "solution": "The problem requires an analysis of a one-dimensional Lagrangian system described by $L(x,\\dot{x})=\\frac{1}{2}m\\,\\dot{x}^{2}+\\lambda(x)\\,\\dot{x}$, focusing on its regularity, primary constraints, and the effect of adding a total time derivative.\n\nFirst, we determine the regularity of the Lagrangian by examining the Legendre transform, which maps the velocity phase space (on the tangent bundle $TQ$) to the momentum phase space (on the cotangent bundle $T^*Q$). The canonical momentum $p$ conjugate to the coordinate $x$ is defined as the partial derivative of the Lagrangian with respect to the velocity $\\dot{x}$:\n$$\np = \\frac{\\partial L}{\\partial \\dot{x}}\n$$\nFor the given Lagrangian, this calculation yields:\n$$\np = \\frac{\\partial}{\\partial \\dot{x}} \\left(\\frac{1}{2}m\\,\\dot{x}^{2}+\\lambda(x)\\,\\dot{x}\\right) = m\\,\\dot{x} + \\lambda(x)\n$$\nA Lagrangian is defined as regular if the Legendre map $(x, \\dot{x}) \\mapsto (x, p)$ is a local diffeomorphism. This is equivalent to being able to invert the expression for $p$ to solve for $\\dot{x}$ as a unique function of $x$ and $p$. The condition for this invertibility is that the Hessian matrix of the Lagrangian with respect to the velocities is non-singular. In our one-dimensional case, this corresponds to the scalar condition:\n$$\n\\frac{\\partial^2 L}{\\partial \\dot{x}^2} \\neq 0\n$$\nCalculating this second derivative gives:\n$$\n\\frac{\\partial^2 L}{\\partial \\dot{x}^2} = \\frac{\\partial}{\\partial \\dot{x}} (m\\,\\dot{x} + \\lambda(x)) = m\n$$\nThe regularity of the system thus depends entirely on the constant parameter $m$. We must consider two cases.\n\nCase 1: $m \\neq 0$.\nIn this case, the Hessian $\\frac{\\partial^2 L}{\\partial \\dot{x}^2} = m$ is non-zero. The Lagrangian is regular. The Legendre transform is invertible, and we can explicitly solve for the velocity $\\dot{x}$:\n$$\n\\dot{x} = \\frac{p - \\lambda(x)}{m}\n$$\nSince $\\dot{x}$ is uniquely determined by $x$ and $p$, the mapping from the tangent bundle coordinates $(x, \\dot{x})$ to the cotangent bundle coordinates $(x, p)$ is a global diffeomorphism. In the context of the Dirac–Bergmann theory, a regular system has no primary constraints. A primary constraint is a function $\\phi(x, p)$ on the phase space that must vanish, i.e., $\\phi(x,p)=0$, as a direct consequence of the definition of momentum. For a regular system, the image of the Legendre map is the entire cotangent bundle, so there are no such restrictions on $(x,p)$. The constraint surface is the entire phase space.\n\nCase 2: $m = 0$.\nIn this case, the Hessian $\\frac{\\partial^2 L}{\\partial \\dot{x}^2} = 0$. The Lagrangian is singular (or degenerate). The Legendre transform is not invertible. When $m=0$, the Lagrangian and the canonical momentum become:\n$$\nL(x, \\dot{x}) = \\lambda(x)\\,\\dot{x}\n$$\n$$\np = \\frac{\\partial L}{\\partial \\dot{x}} = \\lambda(x)\n$$\nThis relationship, $p = \\lambda(x)$, does not involve the velocity $\\dot{x}$. It is impossible to solve for $\\dot{x}$ in terms of $p$. Instead, this equation imposes a restriction on the phase space variables $(x, p)$ themselves. The dynamics of the system are confined to a submanifold of the phase space defined by this relation. This is a primary constraint in the Dirac–Bergmann formalism. The primary constraint function $\\phi(x,p)$ is the expression that must be zero:\n$$\n\\phi(x,p) = p - \\lambda(x)\n$$\nThe problem asks for the primary constraint function, which exists only when the Legendre map is not invertible, i.e., in the singular case where $m=0$.\n\nNext, we analyze the effect of adding a total time derivative of a smooth function $A(x)$ to the Lagrangian. The new Lagrangian is $L'$.\n$$\nL'(x, \\dot{x}) = L(x, \\dot{x}) + \\frac{d}{dt}A(x)\n$$\nUsing the chain rule, $\\frac{d}{dt}A(x) = \\frac{dA}{dx}\\dot{x}$. So, the new Lagrangian is:\n$$\nL'(x, \\dot{x}) = \\frac{1}{2}m\\,\\dot{x}^{2}+\\lambda(x)\\,\\dot{x} + \\frac{dA}{dx}\\dot{x} = \\frac{1}{2}m\\,\\dot{x}^{2} + \\left(\\lambda(x) + \\frac{dA}{dx}\\right)\\dot{x}\n$$\nThe new canonical momentum, $p'$, is:\n$$\np' = \\frac{\\partial L'}{\\partial \\dot{x}} = m\\,\\dot{x} + \\lambda(x) + \\frac{dA}{dx}\n$$\nComparing this to the original momentum $p = m\\dot{x} + \\lambda(x)$, we find the transformation rule:\n$$\np' = p + \\frac{dA}{dx}\n$$\nThis transformation represents a gauge freedom. To interpret this geometrically, we consider the canonical one-form $\\theta$ and symplectic two-form $\\omega$ on the cotangent bundle $T^*Q$. In local coordinates $(x,p)$, the canonical one-form is $\\theta = p\\,dx$. The symplectic form is its exterior derivative, $\\omega = d\\theta = dp \\wedge dx$.\n\nUnder the transformation induced by adding $dA/dt$, the canonical momentum is shifted. The new canonical one-form, $\\theta'$, is expressed in terms of the new momentum $p'$:\n$$\n\\theta' = p'\\,dx\n$$\nSubstituting the expression for $p'$ in terms of $p$:\n$$\n\\theta' = \\left(p + \\frac{dA}{dx}\\right)dx = p\\,dx + \\frac{dA}{dx}dx\n$$\nWe recognize $\\frac{dA}{dx}dx$ as the exterior derivative (total differential) of the function $A(x)$, which is denoted $dA$. Thus:\n$$\n\\theta' = \\theta + dA\n$$\nThe canonical one-form is changed by the addition of an exact one-form $dA$. This is characteristic of a gauge transformation.\n\nNow, we examine the effect on the symplectic form $\\omega$. The new symplectic form $\\omega'$ is derived from the new one-form $\\theta'$:\n$$\n\\omega' = d\\theta' = d(\\theta + dA) = d\\theta + d(dA)\n$$\nA fundamental property of the exterior derivative is that it is nilpotent, i.e., $d^2=0$. Therefore, $d(dA) = d^2A = 0$. This leaves:\n$$\n\\omega' = d\\theta = \\omega\n$$\nThe symplectic form is invariant under this transformation. Since the symplectic form encodes the fundamental structure for Hamilton's equations and Poisson brackets, its invariance means that the underlying physics and dynamics are unchanged. Adding a total time derivative to the Lagrangian modifies the definition of the canonical momentum and shifts the canonical one-form by an exact form, but it preserves the symplectic structure. This is the geometric essence of this gauge freedom.\nThe problem requests the primary constraint function for the case when the Legendre map is not invertible, which is the singular case $m=0$. This function is $p - \\lambda(x)$.",
            "answer": "$$\n\\boxed{p - \\lambda(x)}\n$$"
        },
        {
            "introduction": "Singular Lagrangians require a systematic treatment, which is provided by the powerful Dirac–Bergmann algorithm. This final practice guides you through this procedure for a system with a non-trivial constraint structure. You will begin with the degenerate Legendre transformation to identify a primary constraint, impose its preservation in time to uncover a secondary constraint, and culminate in the calculation of the Dirac bracket—the correct modification of the Poisson bracket for defining dynamics on the true physical phase space. ",
            "id": "3778708",
            "problem": "Consider a mechanical system with configuration manifold $\\mathbb{R}^{3}$ coordinatized by $(x,y,z)$ and Lagrangian\n$$\nL(x,y,z; v_{x}, v_{y}, v_{z}) \\;=\\; \\frac{1}{2} m \\left(v_{x}^{2} + v_{y}^{2}\\right) \\;+\\; c\\, z\\, v_{x} \\;+\\; d\\, x\\, v_{z},\n$$\nwhere $m>0$ and $c,d \\in \\mathbb{R}$ are constants with $c \\neq d$. Starting from the core definitions of the fiber derivative (Legendre transformation) $p_{i} = \\partial L/\\partial v_{i}$ and the canonical Poisson bracket on $T^{*}\\mathbb{R}^{3}$, apply the Dirac–Bergmann algorithm for constrained systems to:\n\n- Identify the primary constraint(s) arising from the degeneracy of the fiber derivative,\n- Construct the canonical Hamiltonian,\n- Impose preservation in time of the primary constraint(s) to find any secondary constraint(s),\n- Determine the class (first or second) of the constraints that arise.\n\nAssume the algorithm closes with no further constraints and that all constraints obtained are second class. Compute, on the final constraint surface, the Dirac bracket between the coordinates $x$ and $z$, and express your final answer as a closed-form analytic expression in terms of $c$ and $d$. Do not provide intermediate results; present only the final expression for the Dirac bracket $\\{x, z\\}_{D}$ as your answer.",
            "solution": "First, we define the canonical momenta $p_i$ via the fiber derivative of the Lagrangian $L$, also known as the Legendre transformation. Let the coordinates be $q = (x,y,z)$ and velocities be $v = (v_x, v_y, v_z)$.\n$$\np_x = \\frac{\\partial L}{\\partial v_x} = m v_x + c z\n$$\n$$\np_y = \\frac{\\partial L}{\\partial v_y} = m v_y\n$$\n$$\np_z = \\frac{\\partial L}{\\partial v_z} = d x\n$$\nWe attempt to express the velocities in terms of the phase space variables $(q, p)$.\nFrom the first two equations, as $m>0$:\n$$\nv_x = \\frac{1}{m}(p_x - c z)\n$$\n$$\nv_y = \\frac{1}{m} p_y\n$$\nThe third equation, $p_z = d x$, does not involve any velocity component. This means it is not possible to solve for $v_z$ in terms of the canonical variables. This equation is therefore a constraint on the phase space, known as a primary constraint.\n$$\n\\phi_1(x, p_z) = p_z - d x \\approx 0\n$$\nThe symbol $\\approx$ denotes a \"weak equality\" that holds on the constraint submanifold of the phase space.\n\nNext, we construct the canonical Hamiltonian $H_c = \\sum_i p_i v_i - L$.\n$$\nH_c = p_x v_x + p_y v_y + p_z v_z - \\left( \\frac{1}{2} m (v_x^2 + v_y^2) + c z v_x + d x v_z \\right)\n$$\nSubstituting the expressions for $v_x$ and $v_y$ and simplifying:\n$$\nH_c = \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m} + (p_z - dx)v_z\n$$\nThe dynamics of the system are governed by the total Hamiltonian $H_T$, which is the canonical Hamiltonian plus all primary constraints multiplied by arbitrary functions of time (Lagrange multipliers).\n$$\nH_T = H_0 + u \\phi_1\n$$\nwhere $H_0 = \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m}$ is the part of $H_c$ that is defined on the primary constraint surface, and $u$ is a Lagrange multiplier (which can be identified with $v_z$).\n\nFor the system's trajectory to remain on the constraint surface, the primary constraint must be preserved in time. This means its Poisson bracket with the total Hamiltonian must vanish weakly.\n$$\n\\dot{\\phi}_1 = \\{\\phi_1, H_T\\} = \\{\\phi_1, H_0 + u\\phi_1\\} = \\{\\phi_1, H_0\\} + u\\{\\phi_1, \\phi_1\\} \\approx 0\n$$\nSince $\\{\\phi_1, \\phi_1\\} = 0$, we only need to compute $\\{\\phi_1, H_0\\}$. The canonical Poisson bracket is $\\{f, g\\} = \\sum_i (\\frac{\\partial f}{\\partial q_i}\\frac{\\partial g}{\\partial p_i} - \\frac{\\partial f}{\\partial p_i}\\frac{\\partial g}{\\partial q_i})$.\n$$\n\\{\\phi_1, H_0\\} = \\{p_z - dx, \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m}\\}\n$$\nThe non-zero partial derivatives are $\\frac{\\partial \\phi_1}{\\partial x} = -d$, $\\frac{\\partial \\phi_1}{\\partial p_z} = 1$, $\\frac{\\partial H_0}{\\partial p_x} = \\frac{1}{m}(p_x-cz)$, and $\\frac{\\partial H_0}{\\partial z} = -\\frac{c}{m}(p_x-cz)$.\n$$\n\\{\\phi_1, H_0\\} = \\frac{\\partial \\phi_1}{\\partial x}\\frac{\\partial H_0}{\\partial p_x} - \\frac{\\partial \\phi_1}{\\partial p_z}\\frac{\\partial H_0}{\\partial z} = (-d)\\left(\\frac{p_x-cz}{m}\\right) - (1)\\left(-\\frac{c}{m}(p_x-cz)\\right) = \\frac{c-d}{m}(p_x-cz)\n$$\nThe condition $\\dot{\\phi}_1 \\approx 0$ thus implies $\\frac{c-d}{m}(p_x-cz) \\approx 0$. Since we are given $m>0$ and $c \\neq d$, this leads to a secondary constraint:\n$$\n\\phi_2(x, z, p_x) = p_x - cz \\approx 0\n$$\nPer the problem statement, we assume the algorithm closes. We verify this by checking the time preservation of $\\phi_2$:\n$$\n\\dot{\\phi}_2 = \\{\\phi_2, H_T\\} = \\{\\phi_2, H_0\\} + u\\{\\phi_2, \\phi_1\\} \\approx 0\n$$\nFirst, $\\{\\phi_2, H_0\\} = \\{p_x - cz, \\frac{1}{2m}(p_x - cz)^2\\} = 0$. Next, we compute $\\{\\phi_2, \\phi_1\\}$:\n$$\n\\{\\phi_2, \\phi_1\\} = \\{p_x - cz, p_z - dx\\} = \\frac{\\partial \\phi_2}{\\partial z}\\frac{\\partial \\phi_1}{\\partial p_z} - \\frac{\\partial \\phi_2}{\\partial p_x}\\frac{\\partial \\phi_1}{\\partial x} = (-c)(1) - (1)(-d) = d-c\n$$\nThe condition $\\dot{\\phi}_2 \\approx 0$ becomes $u(d-c) \\approx 0$. Since $d \\neq c$, this fixes the Lagrange multiplier: $u=0$. No new constraints are generated, and the algorithm terminates.\n\nWe have two constraints, $\\phi_1$ and $\\phi_2$. We form the constraint matrix $C_{ij} = \\{\\phi_i, \\phi_j\\}$.\n$$\nC = \\begin{pmatrix} \\{\\phi_1, \\phi_1\\} & \\{\\phi_1, \\phi_2\\} \\\\ \\{\\phi_2, \\phi_1\\} & \\{\\phi_2, \\phi_2\\} \\end{pmatrix} = \\begin{pmatrix} 0 & c-d \\\\ d-c & 0 \\end{pmatrix}\n$$\nIts determinant is $\\det(C) = -(c-d)(d-c) = (c-d)^2 \\neq 0$, so the constraints are second-class. The inverse matrix is:\n$$\nC^{-1} = \\frac{1}{(c-d)^2} \\begin{pmatrix} 0 & d-c \\\\ c-d & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & -\\frac{1}{c-d} \\\\ \\frac{1}{c-d} & 0 \\end{pmatrix}\n$$\nThe Dirac bracket of two functions $f$ and $g$ is defined as $\\{f, g\\}_D = \\{f, g\\} - \\sum_{i,j=1,2} \\{f, \\phi_i\\} (C^{-1})_{ij} \\{\\phi_j, g\\}$. We want to compute $\\{x, z\\}_D$.\n\nThe canonical bracket $\\{x, z\\} = 0$. Next, we compute the brackets with the constraints:\n$$\n\\{x, \\phi_1\\} = \\{x, p_z - dx\\} = 0\n$$\n$$\n\\{x, \\phi_2\\} = \\{x, p_x - cz\\} = 1\n$$\n$$\n\\{\\phi_1, z\\} = \\{p_z - dx, z\\} = -1\n$$\n$$\n\\{\\phi_2, z\\} = \\{p_x - cz, z\\} = 0\n$$\nThe correction term is $-\\sum_{i,j} \\{x, \\phi_i\\} (C^{-1})_{ij} \\{\\phi_j, z\\}$, which is:\n$$\n- \\begin{pmatrix} \\{x, \\phi_1\\} & \\{x, \\phi_2\\} \\end{pmatrix} \nC^{-1}\n\\begin{pmatrix} \\{\\phi_1, z\\} \\\\ \\{\\phi_2, z\\} \\end{pmatrix}\n= - \\begin{pmatrix} 0 & 1 \\end{pmatrix} \n\\begin{pmatrix} 0 & -1/(c-d) \\\\ 1/(c-d) & 0 \\end{pmatrix} \n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\n$$\nPerforming the matrix multiplication:\n$$\n= - \\begin{pmatrix} 1/(c-d) & 0 \\end{pmatrix} \n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = - \\left(-\\frac{1}{c-d}\\right) = \\frac{1}{c-d}\n$$\nFinally, the Dirac bracket is:\n$$\n\\{x, z\\}_D = \\{x, z\\} - (\\text{correction term before minus sign}) = 0 - \\left(-\\frac{1}{c-d}\\right) = \\frac{1}{c-d}\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{c-d}}\n$$"
        }
    ]
}