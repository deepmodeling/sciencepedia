{
    "hands_on_practices": [
        {
            "introduction": "第一个实践练习将巩固我们对拉格朗日量正则性的理解。通过分析一个其属性取决于单一参数 $\\lambda$ 的拉格朗日系统，你将直接计算纤维海森矩阵来确定正则性条件，并了解正则的勒让德变换如何让我们构建相应的哈密顿量。这个练习建立了勒让德映射的可逆性与哈密顿表述的良定性之间的基本联系。",
            "id": "3778709",
            "problem": "设 $Q=\\mathbb{R}^{2}$ 是一个位形流形，其全局坐标为 $(q_{1},q_{2})$，并设 $(v_{1},v_{2})$ 表示切丛 $TQ$ 上相应的纤维坐标。考虑由下式给出的单参数拉格朗日量族 $L_{\\lambda}:TQ\\to\\mathbb{R}$\n$$\nL_{\\lambda}(q,v)=\\frac{1}{2}\\big(v_{1}-q_{2}v_{2}\\big)^{2}+\\frac{\\lambda}{2}\\,v_{2}^{2}-U(q),\n$$\n其中 $q=(q_{1},q_{2})$，$v=(v_{1},v_{2})$，$\\lambda\\ge 0$ 是一个参数，且 $U:Q\\to\\mathbb{R}$ 是一个固定的光滑势。\n\n仅使用 Legendre 变换和拉格朗日量正则性的基本定义，完成以下任务：\n\n- 推导动量 $p_{i}=\\frac{\\partial L_{\\lambda}}{\\partial v_{i}}$ 和纤维 Hessian 矩阵 $W_{ij}=\\frac{\\partial^{2}L_{\\lambda}}{\\partial v_{i}\\partial v_{j}}$。将 $\\det W$ 显式地计算为 $q$ 和 $\\lambda$ 的函数。\n\n- 根据 $\\det W$，判断对于哪些 $\\lambda$ 值，拉格朗日量 $L_{\\lambda}$ 是正则的，并找出一个具体的位形-速度点 $(q,v)\\in TQ$，在该点上正则性失效（如果存在这种情况）。\n\n- 对于 $\\lambda0$，对 Legendre 变换求逆，将 $v$ 表示为 $(q,p)$ 的函数，然后计算由下式定义的哈密顿量 $H_{\\lambda}(q,p)$\n$$\nH_{\\lambda}(q,p)=p_{1}v_{1}+p_{2}v_{2}-L_{\\lambda}(q,v),\n$$\n其中通过逆 Legendre 变换用 $(q,p)$ 消去 $v$。以 $(q,p)$ 和 $\\lambda$ 的单一显式解析表达式的形式给出你的最终结果。\n\n你的最终答案必须是 $\\lambda0$ 时 $H_{\\lambda}(q,p)$ 的单一闭式表达式。",
            "solution": "单参数拉格朗日量族由下式给出\n$$\nL_{\\lambda}(q,v)=\\frac{1}{2}\\big(v_{1}-q_{2}v_{2}\\big)^{2}+\\frac{\\lambda}{2}\\,v_{2}^{2}-U(q),\n$$\n其中 $q=(q_{1},q_{2})$，$v=(v_{1},v_{2})$，且 $\\lambda \\ge 0$。\n\n### 第 1 部分：动量和纤维 Hessian 矩阵\n\n首先，我们使用定义 $p_{i} = \\frac{\\partial L_{\\lambda}}{\\partial v_{i}}$ 计算正则共轭动量 $p_{i}$。\n对于 $i=1$：\n$$\np_{1} = \\frac{\\partial L_{\\lambda}}{\\partial v_{1}} = \\frac{1}{2} \\cdot 2(v_{1}-q_{2}v_{2})\\frac{\\partial}{\\partial v_{1}}(v_{1}-q_{2}v_{2}) = v_{1}-q_{2}v_{2}.\n$$\n对于 $i=2$：\n$$\np_{2} = \\frac{\\partial L_{\\lambda}}{\\partial v_{2}} = \\frac{1}{2} \\cdot 2(v_{1}-q_{2}v_{2})\\frac{\\partial}{\\partial v_{2}}(v_{1}-q_{2}v_{2}) + \\frac{\\lambda}{2}(2v_{2}) = (v_{1}-q_{2}v_{2})(-q_{2}) + \\lambda v_{2}.\n$$\n将 $p_1$ 的表达式代入 $p_2$ 的表达式中，我们得到：\n$$\np_{2} = -q_{2}p_{1} + \\lambda v_{2}.\n$$\n接下来，我们计算纤维 Hessian 矩阵 $W$，其分量为 $W_{ij} = \\frac{\\partial^{2}L_{\\lambda}}{\\partial v_{i}\\partial v_{j}} = \\frac{\\partial p_{i}}{\\partial v_{j}}$。\n$$\nW_{11} = \\frac{\\partial p_{1}}{\\partial v_{1}} = \\frac{\\partial}{\\partial v_{1}}(v_{1}-q_{2}v_{2}) = 1.\n$$\n$$\nW_{12} = \\frac{\\partial p_{1}}{\\partial v_{2}} = \\frac{\\partial}{\\partial v_{2}}(v_{1}-q_{2}v_{2}) = -q_{2}.\n$$\n为了计算第二行，我们首先将 $p_2$ 完全用速度表示：$p_2 = -q_2v_1 + q_2^2 v_2 + \\lambda v_2 = -q_2v_1 + (q_2^2+\\lambda)v_2$。\n$$\nW_{21} = \\frac{\\partial p_{2}}{\\partial v_{1}} = \\frac{\\partial}{\\partial v_{1}}(-q_{2}v_{1} + (q_{2}^{2}+\\lambda)v_{2}) = -q_{2}.\n$$\n$$\nW_{22} = \\frac{\\partial p_{2}}{\\partial v_{2}} = \\frac{\\partial}{\\partial v_{2}}(-q_{2}v_{1} + (q_{2}^{2}+\\lambda)v_{2}) = q_{2}^{2}+\\lambda.\n$$\n因此，纤维 Hessian 矩阵为：\n$$\nW = \\begin{pmatrix} W_{11}  W_{12} \\\\ W_{21}  W_{22} \\end{pmatrix} = \\begin{pmatrix} 1  -q_{2} \\\\ -q_{2}  q_{2}^{2}+\\lambda \\end{pmatrix}.\n$$\n$W$ 的行列式为：\n$$\n\\det W = (1)(q_{2}^{2}+\\lambda) - (-q_{2})(-q_{2}) = q_{2}^{2}+\\lambda-q_{2}^{2} = \\lambda.\n$$\n所以，$\\det W = \\lambda$，它只依赖于参数 $\\lambda$，而不依赖于位形 $q$。\n\n### 第 2 部分：拉格朗日量的正则性\n\n如果一个拉格朗日量的纤维 Hessian 矩阵是非奇异的，即 $\\det W \\neq 0$，则该拉格朗日量被定义为正则的。\n根据我们的计算，$\\det W = \\lambda$。因此，拉格朗日量 $L_{\\lambda}$ 是正则的当且仅当 $\\lambda \\neq 0$。考虑到约束条件 $\\lambda \\ge 0$，这意味着对于所有 $\\lambda > 0$，$L_{\\lambda}$ 都是正则的。\n当 $\\lambda=0$ 时，拉格朗日量是奇异的。在这种情况下，对于所有位形 $q \\in Q$，$\\det W = 0$。正则性对整个系统失效，而不仅仅是在某个特定点。为了展示正则性失效的一个具体位形-速度点，我们可以为 $\\lambda=0$ 的情况选择 $TQ$ 中的任意一点。例如，当 $\\lambda=0$ 时，在点 $q=(q_1,q_2)=(0,1)$ 和 $v=(v_1,v_2)=(1,0)$ 处，正则性失效。当 $\\lambda=0$ 时，动量由 $p_2 = -q_2 p_1$ 关联，这是一个表示简并性的第一类约束。\n\n### 第 3 部分：$\\lambda>0$ 时的哈密顿量\n\n对于 $\\lambda>0$，拉格朗日量是正则的，且 Legendre 变换是一个微分同胚。我们可以对动量的关系式求逆，以将速度 $v$ 表示为相空间坐标 $(q,p)$ 的函数。这些关系是：\n1. $p_{1} = v_{1} - q_{2} v_{2}$\n2. $p_{2} = -q_{2} p_{1} + \\lambda v_{2}$\n\n从方程 (2) 中，由于 $\\lambda>0$，我们可以解出 $v_2$：\n$$\n\\lambda v_{2} = p_{2} + q_{2} p_{1} \\implies v_{2} = \\frac{1}{\\lambda}(p_{2} + q_{2} p_{1}).\n$$\n将此结果代入方程 (1) 以解出 $v_1$：\n$$\nv_{1} = p_{1} + q_{2} v_{2} = p_{1} + q_{2} \\left[ \\frac{1}{\\lambda}(p_{2} + q_{2} p_{1}) \\right] = p_{1} + \\frac{q_2 p_2 + q_2^2 p_1}{\\lambda} = \\frac{\\lambda p_1 + q_2 p_2 + q_2^2 p_1}{\\lambda}.\n$$\n哈密顿量 $H_{\\lambda}(q,p)$ 由 Legendre 变换定义：\n$$\nH_{\\lambda}(q,p) = p_{1}v_{1} + p_{2}v_{2} - L_{\\lambda}(q,v),\n$$\n其中 $v$ 被 $p$ 消去。拉格朗日量的动能部分 $T=\\frac{1}{2}(v_1-q_2 v_2)^2 + \\frac{\\lambda}{2}v_2^2$ 是速度的二次型。对于此类拉格朗日量 $L = \\frac{1}{2}v^T W v - U$，哈密顿量由 $H = \\frac{1}{2}p^T W^{-1} p + U$ 给出。首先，我们计算 $W$ 的逆矩阵：\n$$\nW^{-1} = \\frac{1}{\\det W} \\begin{pmatrix} q_{2}^{2}+\\lambda  q_{2} \\\\ q_{2}  1 \\end{pmatrix} = \\frac{1}{\\lambda} \\begin{pmatrix} q_{2}^{2}+\\lambda  q_{2} \\\\ q_{2}  1 \\end{pmatrix}.\n$$\n现在我们计算二次型 $\\frac{1}{2}p^T W^{-1} p$：\n$$\n\\frac{1}{2} p^T W^{-1} p = \\frac{1}{2\\lambda} \\begin{pmatrix} p_{1}  p_{2} \\end{pmatrix} \\begin{pmatrix} q_{2}^{2}+\\lambda  q_{2} \\\\ q_{2}  1 \\end{pmatrix} \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix}\n$$\n$$\n= \\frac{1}{2\\lambda} \\begin{pmatrix} p_{1}  p_{2} \\end{pmatrix} \\begin{pmatrix} (q_{2}^{2}+\\lambda)p_{1} + q_{2}p_{2} \\\\ q_{2}p_{1} + p_{2} \\end{pmatrix}\n$$\n$$\n= \\frac{1}{2\\lambda} \\left[ p_{1}((q_{2}^{2}+\\lambda)p_{1} + q_{2}p_{2}) + p_{2}(q_{2}p_{1} + p_{2}) \\right]\n$$\n$$\n= \\frac{1}{2\\lambda} \\left[ (q_{2}^{2}+\\lambda)p_{1}^{2} + q_{2}p_{1}p_{2} + q_{2}p_{1}p_{2} + p_{2}^{2} \\right]\n$$\n$$\n= \\frac{1}{2\\lambda} \\left[ (\\lambda+q_{2}^{2})p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right].\n$$\n这个表达式可以通过展开并重新组合各项来简化：\n$$\n\\frac{1}{2\\lambda} \\left[ \\lambda p_{1}^{2} + q_{2}^{2}p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right] = \\frac{\\lambda p_{1}^{2}}{2\\lambda} + \\frac{1}{2\\lambda} \\left[ q_{2}^{2}p_{1}^{2} + 2q_{2}p_{1}p_{2} + p_{2}^{2} \\right]\n$$\n$$\n= \\frac{1}{2}p_{1}^{2} + \\frac{1}{2\\lambda} (q_{2}p_{1} + p_{2})^{2}.\n$$\n通过加上势能项 $U(q)$，我们得到完整的哈密顿量：\n$$\nH_{\\lambda}(q,p) = \\frac{1}{2}p_{1}^{2} + \\frac{1}{2\\lambda}(q_{2}p_{1} + p_{2})^{2} + U(q).\n$$\n这是 $\\lambda > 0$ 时哈密顿量的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{2}p_{1}^{2} + \\frac{(q_{2}p_{1} + p_{2})^{2}}{2\\lambda} + U(q)}\n$$"
        },
        {
            "introduction": "当拉格朗日量非正则时，勒让德变换是退化的，从而导致一个约束哈密顿系统。本练习将引导你完成强大的狄拉克-贝尔格曼算法，这是处理此类奇异系统的标准流程。你将识别主约束和次级约束，并计算狄拉克括号，它修正了正则泊松结构，以正确描述约束子流形上的动力学。这项实践对于理解规范理论和其他复杂物理系统至关重要。",
            "id": "3778708",
            "problem": "考虑一个力学系统，其位形空间为 $\\mathbb{R}^{3}$，坐标为 $(x,y,z)$，拉格朗日量为\n$$\nL(x,y,z; v_{x}, v_{y}, v_{z}) \\;=\\; \\frac{1}{2} m \\left(v_{x}^{2} + v_{y}^{2}\\right) \\;+\\; c\\, z\\, v_{x} \\;+\\; d\\, x\\, v_{z},\n$$\n其中 $m0$，$c,d \\in \\mathbb{R}$ 为常数，且 $c \\neq d$。从纤维导数（勒让德变换）$p_{i} = \\partial L/\\partial v_{i}$ 和 $T^{*}\\mathbb{R}^{3}$ 上的正则泊松括号的核心定义出发，对约束系统应用 Dirac–Bergmann 算法以：\n\n- 识别由纤维导数的退化性产生的主约束，\n- 构建正则哈密顿量，\n- 通过施加主约束的时间守恒条件来寻找次级约束，\n- 确定所产生约束的类别（第一类或第二类）。\n\n假设该算法闭合，没有进一步的约束，并且所有得到的约束都是第二类约束。在最终的约束曲面上，计算坐标 $x$ 和 $z$ 之间的狄拉克括号 $\\{x, z\\}_{D}$，并将你的最终答案表示为关于 $c$ 和 $d$ 的闭式解析表达式。不要提供中间结果；只给出狄拉克括号 $\\{x, z\\}_{D}$ 的最终表达式作为你的答案。",
            "solution": "分析过程通过应用 Dirac–Bergmann 算法来进行。\n\n首先，我们通过拉格朗日量 $L$ 的纤维导数（也称为勒让德变换）来定义正则动量 $p_i$。设坐标为 $q = (x,y,z)$，速度为 $v = (v_x, v_y, v_z)$。\n$$\np_x = \\frac{\\partial L}{\\partial v_x} = m v_x + c z\n$$\n$$\np_y = \\frac{\\partial L}{\\partial v_y} = m v_y\n$$\n$$\np_z = \\frac{\\partial L}{\\partial v_z} = d x\n$$\n我们尝试用相空间变量 $(q, p)$ 来表示速度。\n从前两个方程，由于 $m0$：\n$$\nv_x = \\frac{1}{m}(p_x - c z)\n$$\n$$\nv_y = \\frac{1}{m} p_y\n$$\n第三个方程 $p_z = d x$ 不涉及任何速度分量。这意味着无法用正则变量解出 $v_z$。因此，这个方程是相空间上的一个约束，称为主约束。\n$$\n\\phi_1(x, p_z) = p_z - d x \\approx 0\n$$\n符号 $\\approx$ 表示在相空间的约束子流形上成立的“弱等式”。\n\n接下来，我们构建正则哈密顿量 $H_c = \\sum_i p_i v_i - L$。速度 $v_z$ 是不确定的，所以我们暂时将其视为一个自由参数。\n$$\nH_c = p_x v_x + p_y v_y + p_z v_z - \\left( \\frac{1}{2} m (v_x^2 + v_y^2) + c z v_x + d x v_z \\right)\n$$\n代入 $v_x$ 和 $v_y$ 的表达式：\n$$\nH_c = p_x \\left(\\frac{p_x - c z}{m}\\right) + p_y \\left(\\frac{p_y}{m}\\right) + p_z v_z - \\left[ \\frac{1}{2}m \\left( \\left(\\frac{p_x-cz}{m}\\right)^2 + \\left(\\frac{p_y}{m}\\right)^2 \\right) + c z \\left(\\frac{p_x - cz}{m}\\right) + d x v_z \\right]\n$$\n经过代数化简，得到：\n$$\nH_c = \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m} + (p_z - dx)v_z\n$$\n系统的动力学由总哈密顿量 $H_T$ 控制，它是正则哈密顿量加上所有主约束乘以时间的任意函数（拉格朗日乘子）。\n$$\nH_T = H_0 + u \\phi_1\n$$\n其中 $H_0 = \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m}$ 是 $H_c$ 在主约束曲面上定义的部分，而 $u$ 是一个拉格朗日乘子（可以等同于 $v_z$）。\n\n为使系统的轨迹保持在约束曲面上，主约束必须随时间守恒。这意味着它与总哈密顿量的泊松括号必须弱为零。\n$$\n\\dot{\\phi}_1 = \\{\\phi_1, H_T\\} = \\{\\phi_1, H_0 + u\\phi_1\\} = \\{\\phi_1, H_0\\} + u\\{\\phi_1, \\phi_1\\} \\approx 0\n$$\n由于 $\\{\\phi_1, \\phi_1\\} = 0$，我们只需要计算 $\\{\\phi_1, H_0\\}$。正则泊松括号为 $\\{f, g\\} = \\sum_i (\\frac{\\partial f}{\\partial q_i}\\frac{\\partial g}{\\partial p_i} - \\frac{\\partial f}{\\partial p_i}\\frac{\\partial g}{\\partial q_i})$。\n$$\n\\{\\phi_1, H_0\\} = \\{p_z - dx, \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m}\\}\n$$\n$\\phi_1 = p_z - dx$ 的非零偏导数只有 $\\frac{\\partial \\phi_1}{\\partial x} = -d$ 和 $\\frac{\\partial \\phi_1}{\\partial p_z} = 1$。与它们配对的 $H_0$ 的非零偏导数只有 $\\frac{\\partial H_0}{\\partial p_x} = \\frac{1}{m}(p_x-cz)$ 和 $\\frac{\\partial H_0}{\\partial z} = -\\frac{c}{m}(p_x-cz)$。\n$$\n\\{\\phi_1, H_0\\} = \\frac{\\partial \\phi_1}{\\partial x}\\frac{\\partial H_0}{\\partial p_x} - \\frac{\\partial \\phi_1}{\\partial p_z}\\frac{\\partial H_0}{\\partial z} = (-d)\\left(\\frac{p_x-cz}{m}\\right) - (1)\\left(-\\frac{c}{m}(p_x-cz)\\right) = \\frac{c-d}{m}(p_x-cz)\n$$\n因此，条件 $\\dot{\\phi}_1 \\approx 0$ 意味着 $\\frac{c-d}{m}(p_x-cz) \\approx 0$。由于给定 $m>0$ 和 $c \\neq d$，这导致一个次级约束：\n$$\n\\phi_2(x, z, p_x) = p_x - cz \\approx 0\n$$\n根据问题陈述，我们假设算法闭合。我们通过检查 $\\phi_2$ 的时间守恒来验证这一点：\n$$\n\\dot{\\phi}_2 = \\{\\phi_2, H_T\\} = \\{\\phi_2, H_0\\} + u\\{\\phi_2, \\phi_1\\} \\approx 0\n$$\n首先，我们计算 $\\{\\phi_2, H_0\\}$：\n$$\n\\{\\phi_2, H_0\\} = \\{p_x - cz, \\frac{1}{2m}(p_x - cz)^2 + \\frac{p_y^2}{2m}\\} = \\{p_x-cz, \\frac{1}{2m}(p_x-cz)^2\\} = 0\n$$\n接下来，我们计算 $\\{\\phi_2, \\phi_1\\}$：\n$$\n\\{\\phi_2, \\phi_1\\} = \\{p_x - cz, p_z - dx\\} = \\frac{\\partial \\phi_2}{\\partial z}\\frac{\\partial \\phi_1}{\\partial p_z} - \\frac{\\partial \\phi_2}{\\partial p_x}\\frac{\\partial \\phi_1}{\\partial x} = (-c)(1) - (1)(-d) = d-c\n$$\n条件 $\\dot{\\phi}_2 \\approx 0$ 变为 $u(d-c) \\approx 0$。由于 $d \\neq c$，这确定了拉格朗日乘子：$u=0$。没有新的约束产生，算法终止。\n\n我们有两个约束，$\\phi_1$ 和 $\\phi_2$。问题陈述它们是第二类的。我们构成约束矩阵 $C_{ij} = \\{\\phi_i, \\phi_j\\}$。\n$$\nC_{11} = \\{\\phi_1, \\phi_1\\} = 0\n$$\n$$\nC_{12} = \\{\\phi_1, \\phi_2\\} = -\\{\\phi_2, \\phi_1\\} = -(d-c) = c-d\n$$\n$$\nC_{21} = \\{\\phi_2, \\phi_1\\} = d-c\n$$\n$$\nC_{22} = \\{\\phi_2, \\phi_2\\} = 0\n$$\n约束矩阵是 $C = \\begin{pmatrix} 0  c-d \\\\ d-c  0 \\end{pmatrix}$。其行列式为 $\\det(C) = -(c-d)(d-c) = (c-d)^2$。由于 $c \\neq d$，$\\det(C) \\neq 0$，所以矩阵是可逆的，约束确实是第二类的。\n逆矩阵是：\n$$\nC^{-1} = \\frac{1}{(c-d)^2} \\begin{pmatrix} 0  d-c \\\\ c-d  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{d-c}{(c-d)^2} \\\\ \\frac{c-d}{(c-d)^2}  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\frac{1}{c-d} \\\\ \\frac{1}{c-d}  0 \\end{pmatrix}\n$$\n两个函数 $f$ 和 $g$ 的狄拉克括号定义为 $\\{f, g\\}_D = \\{f, g\\} - \\sum_{i,j=1,2} \\{f, \\phi_i\\} (C^{-1})_{ij} \\{\\phi_j, g\\}$。我们想计算 $\\{x, z\\}_D$。\n\n首先，正则括号 $\\{x, z\\} = 0$。\n接下来，我们计算 $x$ 和 $z$ 与约束的括号：\n$$\n\\{x, \\phi_1\\} = \\{x, p_z - dx\\} = \\{x, p_z\\} - d\\{x, x\\} = 0 - 0 = 0\n$$\n$$\n\\{x, \\phi_2\\} = \\{x, p_x - cz\\} = \\{x, p_x\\} - c\\{x, z\\} = 1 - 0 = 1\n$$\n$$\n\\{\\phi_1, z\\} = \\{p_z - dx, z\\} = \\{p_z, z\\} - d\\{x, z\\} = -1 - 0 = -1\n$$\n$$\n\\{\\phi_2, z\\} = \\{p_x - cz, z\\} = \\{p_x, z\\} - c\\{z, z\\} = 0 - 0 = 0\n$$\n现在，我们计算修正项：\n$$\n\\sum_{i,j} \\{x, \\phi_i\\} (C^{-1})_{ij} \\{\\phi_j, g\\} = \n\\begin{pmatrix} \\{x, \\phi_1\\}  \\{x, \\phi_2\\} \\end{pmatrix} \n\\begin{pmatrix} (C^{-1})_{11}  (C^{-1})_{12} \\\\ (C^{-1})_{21}  (C^{-1})_{22} \\end{pmatrix} \n\\begin{pmatrix} \\{\\phi_1, z\\} \\\\ \\{\\phi_2, z\\} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0  1 \\end{pmatrix} \n\\begin{pmatrix} 0  -1/(c-d) \\\\ 1/(c-d)  0 \\end{pmatrix} \n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n= \\begin{pmatrix} 1/(c-d)  0 \\end{pmatrix} \n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = -\\frac{1}{c-d}\n$$\n最后，狄拉克括号是：\n$$\n\\{x, z\\}_D = \\{x, z\\} - \\left(-\\frac{1}{c-d}\\right) = 0 - \\left(-\\frac{1}{c-d}\\right) = \\frac{1}{c-d}\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{c-d}}\n$$"
        },
        {
            "introduction": "正则性的概念超越了简单系统，并具有深刻的几何意义，尤其是在具有对称性的系统中。这个问题探讨了一个系统，其正则性不是处处都失效，而是在位形空间的特定子流形上失效，这是几何力学中的一个普遍特征。通过执行劳斯约化，你将揭示这种奇点如何在约化系统中表现为一个有效势，从而导致平衡点分岔等有趣的物理现象。",
            "id": "3765240",
            "problem": "考虑一个力学系统，其位形空间为 $Q = \\mathbb{R}^{2} \\times S^{1}$，坐标为 $(x,y,\\phi)$，其拉格朗日量形式如下\n$$\nL(x,y,\\phi;\\dot{x},\\dot{y},\\dot{\\phi}) \\;=\\; \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) \\;+\\; \\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\dot{\\phi} \\;+\\; \\alpha \\left(y\\,\\dot{x} \\;-\\; x\\,\\dot{y}\\right)\\right)^{2} \\;-\\; V(x,y),\n$$\n其中 $m0$、$\\gamma0$ 和 $\\alpha \\in \\mathbb{R}$ 是常数，而 $V:\\mathbb{R}^{2}\\to\\mathbb{R}$ 是一个在 $(x,y)=(0,0)$ 处具有非退化极小值点的光滑势。圆 $S^{1}$ 通过平移作用于 $\\phi$，使得 $\\phi$ 成为一个循环坐标。该模型捕捉了一个主圆丛，其通过函数 $\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)$ 具有规范式动能耦合，以及一个依赖于位形的转动惯量 $I(x,y)=\\gamma x^{2}$，该转动惯量在子流形 $\\mathcal{S}=\\{(x,y)\\in\\mathbb{R}^{2}\\mid x=0\\}$ 上为零。\n\n仅从循环坐标、守恒动量和针对具有一维纤维（圆 $S^{1}$）的对称群的Routh约化的定义出发，完成以下任务：\n\n1. 确定与循环坐标相关的守恒动量，并陈述在该系统中群正则性（也称 $G$-正则性）条件成立或失效的条件。\n\n2. 在 $G$-正则性成立的开子集上，对固定的动量 $\\mu \\in \\mathbb{R}$ 执行Routh约化，并消去 $\\dot{\\phi}$ 以得到一个纯粹用 $(x,y)$ 和 $(\\dot{x},\\dot{y})$ 表示的约化Routh函数。\n\n3. 基于第一性原理，用文字分析当 $\\mu$ 变化时，约化动力学中的有效自由度数在 $\\mathcal{S}$ 附近如何变化，并讨论由于沿 $\\mathcal{S}$ 的 $G$-正则性失效以及 $V$ 的非退化极小值的存在，约化动力学在 $(x,y)=(0,0)$ 附近可能经历分岔的定性机制。\n\n你的最终答案必须是在第2项中推导出的约化Routh函数的单一闭式解析表达式。不需要数值计算，最终答案中不应包含单位。如果在任何中间步骤中使用了三角函数或指数函数，请以精确形式保留它们。",
            "solution": "### 1. 守恒动量与G-正则性条件\n\n如果拉格朗日量不显式地依赖于某个坐标，则该坐标是循环坐标。给定的拉格朗日量 $L$ 与 $\\phi$ 无关，因此 $\\phi$ 是一个循环坐标。根据诺特定理，这种在 $\\phi$ 平移下的不变性意味着存在一个守恒量，即与 $\\phi$ 共轭的正则动量。该动量记为 $p_{\\phi}$，定义为：\n$$\np_{\\phi} = \\frac{\\partial L}{\\partial \\dot{\\phi}}\n$$\n从给定的拉格朗日量计算此导数：\n$$\np_{\\phi} = \\frac{\\partial}{\\partial \\dot{\\phi}} \\left[ \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)^{2} - V(x,y) \\right]\n$$\n$$\np_{\\phi} = \\gamma x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)\n$$\n这个量沿着系统的任何轨迹都是守恒的，因此我们设 $p_{\\phi} = \\mu$，其中 $\\mu \\in \\mathbb{R}$ 是一个常数。\n\n群正则性条件（或在对称群 $G$ 的背景下的 $G$-正则性条件，此处 $G=S^1$）关系到纤维勒让德变换的可逆性，该变换将纤维速度映射到纤维动量。具体来说，它要求我们能够唯一地用动量 $\\mu$ 和其余的坐标 $(x,y)$ 及速度 $(\\dot{x},\\dot{y})$ 来求解速度 $\\dot{\\phi}$。这当且仅当拉格朗日量对纤维速度的二阶导数非零时才可能。这个量 $\\frac{\\partial^{2} L}{\\partial \\dot{\\phi}^{2}}$ 对应于动能度量张量沿纤维方向的分量，也称为转动惯量。\n$$\n\\frac{\\partial^{2} L}{\\partial \\dot{\\phi}^{2}} = \\frac{\\partial}{\\partial \\dot{\\phi}} \\left( \\gamma x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right) \\right) = \\gamma x^{2}\n$$\n根据定义，由于 $\\gamma > 0$，$G$-正则性条件成立当且仅当 $\\gamma x^{2} \\neq 0$，这等价于 $x \\neq 0$。该条件在子流形 $\\mathcal{S}=\\{(x,y)\\in\\mathbb{R}^{2}\\mid x=0\\}$ 上失效，在該子流形上，$\\phi$ 转动的有效转动惯量为零。\n\n### 2. Routh约化与约化Routh函数\n\nRouth约化是消除循环坐标并在一个较低维空间上获得约化动力系统的过程。Routh函数 $R_{\\mu}$ 作为约化系统的有效拉格朗日量。其定义为 $R_{\\mu} = L - p_{\\phi}\\dot{\\phi}$，在常动量 $p_{\\phi} = \\mu$ 下求值，并将 $\\dot{\\phi}$ 用其他变量表示。\n\n首先，我们假设 $x \\neq 0$，对动量守恒方程求解 $\\dot{\\phi}$：\n$$\n\\mu = \\gamma x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)\n$$\n$$\n\\frac{\\mu}{\\gamma x^{2}} = \\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\n$$\n$$\n\\dot{\\phi} = \\frac{\\mu}{\\gamma x^{2}} - \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\n$$\n现在，我们构造Routh函数 $R_{\\mu} = L - \\mu \\dot{\\phi}$：\n$$\nR_{\\mu} = \\left[ \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\\right)^{2} - V(x,y) \\right] - \\mu \\dot{\\phi}\n$$\n我们可以通过代入动量方程 $\\dot{\\phi} + \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right) = \\frac{\\mu}{\\gamma x^{2}}$ 来简化包含平方括号的项。\n$$\n\\frac{1}{2}\\, \\gamma\\, x^{2} \\left(\\frac{\\mu}{\\gamma x^{2}}\\right)^{2} = \\frac{1}{2}\\, \\gamma\\, x^{2} \\frac{\\mu^{2}}{\\gamma^{2} x^{4}} = \\frac{\\mu^{2}}{2\\gamma x^{2}}\n$$\n将此代入 $R_{\\mu}$ 的表达式中：\n$$\nR_{\\mu} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{\\mu^{2}}{2\\gamma x^{2}} - V(x,y) - \\mu \\dot{\\phi}\n$$\n最后，我们代入 $\\dot{\\phi}$ 的表达式：\n$$\nR_{\\mu} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{\\mu^{2}}{2\\gamma x^{2}} - V(x,y) - \\mu \\left( \\frac{\\mu}{\\gamma x^{2}} - \\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right) \\right)\n$$\n展开并合并同类项：\n$$\nR_{\\mu} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\frac{\\mu^{2}}{2\\gamma x^{2}} - \\frac{\\mu^{2}}{\\gamma x^{2}} - V(x,y) + \\mu\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)\n$$\n纯粹用 $(x,y)$ 和 $(\\dot{x},\\dot{y})$ 表示的约化Routh函数为：\n$$\nR_{\\mu}(x,y,\\dot{x},\\dot{y}) = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\mu\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right) - V(x,y) - \\frac{\\mu^{2}}{2\\gamma x^{2}}\n$$\n\n### 3. 约化动力学与分岔分析\n\nRouth函数具有一个质量为 $m$ 的粒子在坐标为 $(x,y)$ 的二维位形空间中运动的拉格朗日量结构。只要约化是正则的（$x \\neq 0$），系统就具有 $2$ 个自由度。运动由一个有效势和附加的速度相关力支配。\nRouth函数可以写成 $R_{\\mu} = T_{red} + A_{\\mu} - V_{eff}$，其中：\n- $T_{red} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right)$ 是约化动能。\n- $A_{\\mu} = \\mu\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right)$ 是一个磁力项或陀螺项。它产生一个与速度成正比且垂直于速度的力，类似于磁场中的洛伦兹力。\n- $V_{eff} = V(x,y) + \\frac{\\mu^{2}}{2\\gamma x^{2}}$ 是有效势。第二项 $V_{cent} = \\frac{\\mu^{2}}{2\\gamma x^{2}}$ 被称为离心势，它源于循环运动的惯性。\n\n在Routh函数良定的任何地方（即 $x \\neq 0$），有效自由度数都是 $2$。在子流形 $\\mathcal{S}$（其中 $x=0$）附近的行为严重依赖于动量 $\\mu$ 的值。\n\n- **对于 $\\mu \\neq 0$**：离心势 $V_{cent}$ 沿着直线 $x=0$ 产生一个无限高的势垒。这个势垒有效地将动力学限制在两个半平面之一，即 $x > 0$ 或 $x  0$，从而阻止系统到达 $G$-正则性失效的子流形 $\\mathcal{S}$。系统在受限的定义域上严格保持为一个 $2$ 自由度系统。\n\n- **对于 $\\mu = 0$**：离心势和陀螺项都消失了。Routh函数简化为 $R_{0} = \\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) - V(x,y)$。约化动力学就是粒子在原始势 $V(x,y)$ 中运动的动力学。系统现在可以到达直线 $x = 0$。在这条直线上，原始问题是奇异的，但在 $\\mu=0$ 的约化图像中，动力学是完全正则的。\n\n当 $\\mu$ 变化时，有效势结构的这种变化导致了约化系统在原点 $(0,0)$ 附近的平衡结构发生分岔。\n\n- 势 $V(x,y)$ 在 $(0,0)$ 处有一个非退化极小值。对于 $\\mu=0$，$V_{eff} = V(x,y)$，因此约化系统在 $(0,0)$ 处有一个稳定平衡点。\n\n- 对于 $\\mu \\neq 0$，平衡点可以通过将有效势的梯度设为零来找到：$\\nabla V_{eff} = 0$。\n  $$\n  \\frac{\\partial V_{eff}}{\\partial x} = \\frac{\\partial V}{\\partial x} - \\frac{\\mu^{2}}{\\gamma x^{3}} = 0\n  $$\n  $$\n  \\frac{\\partial V_{eff}}{\\partial y} = \\frac{\\partial V}{\\partial y} = 0\n  $$\n  由于奇异项 $\\frac{\\mu^{2}}{\\gamma x^{3}}$ 的存在，原点 $(0,0)$ 不再是一个解。对于任何非零动量 $\\mu$，原点处的原始稳定平衡点被离心力所破坏。$V$ 的约束性质（将系统拉向原点）和 $V_{cent}$ 的排斥性质（将系统推离 $y$ 轴）相互竞争。这种竞争导致了远离 $y$ 轴的新平衡位置的产生。在原点附近，其中 $\\frac{\\partial V}{\\partial x} \\approx k_{xx} x$（对于某个常数 $k_{xx} > 0$），第一个方程变为 $k_{xx} x \\approx \\frac{\\mu^{2}}{\\gamma x^{3}}$，这导致了 $x_{eq}$ 的解满足 $x_{eq}^4 \\propto \\mu^2$。这表明，对于任何无穷小但非零的 $\\mu$，$x=0$ 处的平衡点会分裂成两个位于 $x \\neq 0$ 的新平衡点。这是一个叉式分岔。系统相图的定性变化是由约化的奇异性质驱动的，即在 $x=0$ 处转动惯量的消失为任何非零角动量产生了无限强的离心排斥力。",
            "answer": "$$\n\\boxed{\\frac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2}\\right) + \\mu\\alpha \\left(y\\,\\dot{x} - x\\,\\dot{y}\\right) - V(x,y) - \\frac{\\mu^{2}}{2\\gamma x^{2}}}\n$$"
        }
    ]
}