{
    "hands_on_practices": [
        {
            "introduction": "我们首先来研究联系拉格朗日形式和哈密顿形式的关键环节：勒让德变换。本练习将引导您计算一个一般力学系统的雅可比矩阵，从而推导出系统“超正则”的精确条件——即保证能够平滑过渡到哈密顿描述的条件 。理解这一条件对于领会经典力学的结构至关重要。",
            "id": "3744702",
            "problem": "考虑一个维数为 $n$ 的光滑位形流形 $Q$，其局部坐标为 $q = (q^{1},\\dots,q^{n})$。令 $TQ$表示其切丛，其诱导的局部纤维坐标为 $v = \\dot{q} = (\\dot{q}^{1},\\dots,\\dot{q}^{n})$。设拉格朗日量为机械类型\n$$\nL(q,v) \\;=\\; \\frac{1}{2}\\, v^{\\top} M(q)\\, v \\;+\\; b(q)\\cdot v \\;-\\; V(q),\n$$\n其中 $M(q)$ 是一个光滑的 $n\\times n$ 矩阵值函数，$b(q)$ 是一个光滑的 $\\mathbb{R}^{n}$ 值函数，$V(q)$ 是一个光滑的实值函数。哈密顿原理指出，在固定端点的变分中，物理轨迹使作用量 $S[q] = \\int L(q,\\dot{q})\\, dt$ 保持驻定，由此可导出欧拉-拉格朗日方程。哈密顿描述是通过纤维导数（也称为勒让德变换）$\\mathcal{F}L : TQ \\to T^{\\ast}Q$ 得到的，在局部坐标中定义为 $(q,v) \\mapsto (q,p)$，其中 $p = \\partial L/\\partial v$。\n\n从这些基础和纤维导数的定义出发，在局部坐标中计算 $\\mathcal{F}L$ 作为从 $TQ$ 到 $T^{\\ast}Q$ 的映射的雅可比矩阵（全导数），并将其表示为一个关于变量 $(q,v)$ 和像坐标 $(q,p)$ 的 $2n\\times 2n$ 分块矩阵。您的推导必须从第一性原理出发：从给定的 $L$ 计算动量映射 $p(q,v)$，然后对 $q$ 和 $v$ 求导以获得雅可比分块。用 $M(q)$、$b(q)$ 及其关于 $q$ 各分量的偏导数明确地表示最终的雅可比矩阵。\n\n此外，陈述使拉格朗日量 $L$ 成为超正则（即纤维导数 $\\mathcal{F}L$ 是一个从 $TQ$ 到 $T^{\\ast}Q$ 的微分同胚）时 $M(q)$ 需满足的精确充要条件。根据您推导出的结构直接证明您的条件。\n\n作为最终答案，仅报告 $\\mathcal{F}L$ 的 $2n\\times 2n$ 雅可比分块矩阵。不需要单位。不要在最终报告的答案中包含任何不等式或文字条件。",
            "solution": "该问题要求计算给定拉格朗日量的纤维导数（勒让德变换）的雅可比矩阵，并确定该变换成为微分同胚（即拉格朗日量是超正则的）的条件。\n\n给定的拉格朗日量为机械类型：\n$$\nL(q,v) = \\frac{1}{2}\\, v^{\\top} M(q)\\, v + b(q)\\cdot v - V(q)\n$$\n其中 $q = (q^1, \\dots, q^n)$ 是位形流形 $Q$ 上的局部坐标，而 $v = \\dot{q} = (v^1, \\dots, v^n)$ 是切丛 $TQ$ 上相应的纤维坐标。$M(q)$ 是一个 $n \\times n$ 矩阵值函数，$b(q)$ 是一个 $\\mathbb{R}^n$ 值函数（一个向量场），$V(q)$ 是一个标量势。\n\n为进行计算，我们将拉格朗日量用指数表示法写出：\n$$\nL(q,v) = \\frac{1}{2} \\sum_{i,j=1}^n M_{ij}(q) v^i v^j + \\sum_{i=1}^n b_i(q) v^i - V(q)\n$$\n纤维导数 $\\mathcal{F}L: TQ \\to T^*Q$ 将坐标 $(q,v)$ 映射到 $(q,p)$，其中共轭动量 $p = (p_1, \\dots, p_n)$ 定义为 $p_k = \\frac{\\partial L}{\\partial v^k}$。我们来计算 $p$ 的分量：\n$$\np_k = \\frac{\\partial}{\\partial v^k} \\left( \\frac{1}{2} \\sum_{i,j} M_{ij}(q) v^i v^j + \\sum_i b_i(q) v^i - V(q) \\right)\n$$\n二次项的导数是：\n$$\n\\frac{\\partial}{\\partial v^k} \\left( \\frac{1}{2} \\sum_{i,j} M_{ij} v^i v^j \\right) = \\frac{1}{2} \\sum_{i,j} M_{ij} \\left( \\frac{\\partial v^i}{\\partial v^k} v^j + v^i \\frac{\\partial v^j}{\\partial v^k} \\right) = \\frac{1}{2} \\sum_{i,j} M_{ij} (\\delta^i_k v^j + v^i \\delta^j_k)\n$$\n$$\n= \\frac{1}{2} \\left( \\sum_j M_{kj} v^j + \\sum_i M_{ik} v^i \\right)\n$$\n这个表达式同时依赖于 $M$ 及其转置 $M^\\top$。我们将其重写：\n$$\n= \\frac{1}{2} \\sum_j (M_{kj} + M_{jk}) v^j\n$$\n线性项的导数是 $\\frac{\\partial}{\\partial v^k} (\\sum_i b_i v^i) = b_k$。势能项 $V(q)$ 与 $v$ 无关，因此其导数为零。\n合并这些项，动量为：\n$$\np_k(q,v) = \\frac{1}{2} \\sum_{j=1}^n (M_{kj}(q) + M_{jk}(q)) v^j + b_k(q)\n$$\n通常引入矩阵 $M(q)$ 的对称部分，记作 $\\tilde{M}(q)$，其元素为 $\\tilde{M}_{kj}(q) = \\frac{1}{2}(M_{kj}(q) + M_{jk}(q))$。用矩阵表示法，$\\tilde{M}(q) = \\frac{1}{2}(M(q) + M(q)^\\top)$。动量映射可以简洁地写成向量形式：\n$$\np(q,v) = \\tilde{M}(q)v + b(q)\n$$\n纤维导数 $\\mathcal{F}L$ 是从 $TQ$ 到 $T^*Q$ 的映射，在局部坐标中由 $\\mathcal{F}L(q,v) = (q, p(q,v))$ 给出。我们需要求它的雅可比矩阵，这是一个 $2n \\times 2n$ 矩阵，表示此映射关于坐标向量 $(q, v)$ 的全导数。雅可比矩阵具有分块结构：\n$$\nD(\\mathcal{F}L)(q,v) = \\begin{pmatrix} \\frac{\\partial q}{\\partial q}  \\frac{\\partial q}{\\partial v} \\\\ \\frac{\\partial p}{\\partial q}  \\frac{\\partial p}{\\partial v} \\end{pmatrix}\n$$\n我们计算四个 $n \\times n$ 分块中的每一个：\n1.  左上分块：$\\frac{\\partial q}{\\partial q}$。其元素为 $(\\frac{\\partial q}{\\partial q})_{ij} = \\frac{\\partial q^i}{\\partial q^j} = \\delta_{ij}$。这个分块是 $n \\times n$ 单位矩阵 $I_n$。\n2.  右上分块：$\\frac{\\partial q}{\\partial v}$。其元素为 $(\\frac{\\partial q}{\\partial v})_{ij} = \\frac{\\partial q^i}{\\partial v^j} = 0$，因为 $q$ 不依赖于 $v$。这个分块是 $n \\times n$ 零矩阵 $0_n$。\n3.  右下分块：$\\frac{\\partial p}{\\partial v}$。其元素为 $(\\frac{\\partial p}{\\partial v})_{ij} = \\frac{\\partial p_i}{\\partial v^j}$。使用 $p_i$ 的表达式：\n    $$\n    \\frac{\\partial p_i}{\\partial v^j} = \\frac{\\partial}{\\partial v^j} \\left( \\sum_{k=1}^n \\tilde{M}_{ik}(q) v^k + b_i(q) \\right) = \\sum_{k=1}^n \\tilde{M}_{ik}(q) \\frac{\\partial v^k}{\\partial v^j} = \\sum_{k=1}^n \\tilde{M}_{ik}(q) \\delta_{kj} = \\tilde{M}_{ij}(q)\n    $$\n    所以，这个分块是矩阵 $\\tilde{M}(q) = \\frac{1}{2}(M(q) + M(q)^\\top)$。\n4.  左下分块：$\\frac{\\partial p}{\\partial q}$。其元素为 $(\\frac{\\partial p}{\\partial q})_{ij} = \\frac{\\partial p_i}{\\partial q^j}$。这需要将 $p_i$ 的表达式对 $q$ 的分量求导：\n    $$\n    \\frac{\\partial p_i}{\\partial q^j} = \\frac{\\partial}{\\partial q^j} \\left( \\sum_{k=1}^n \\tilde{M}_{ik}(q) v^k + b_i(q) \\right) = \\sum_{k=1}^n \\frac{\\partial \\tilde{M}_{ik}(q)}{\\partial q^j} v^k + \\frac{\\partial b_i(q)}{\\partial q^j}\n    $$\n    将 $\\tilde{M}_{ik} = \\frac{1}{2}(M_{ik} + M_{ki})$ 代回，我们得到该元素的最终表达式：\n    $$\n    \\left(\\frac{\\partial p}{\\partial q}\\right)_{ij} = \\sum_{k=1}^n \\frac{1}{2} \\left( \\frac{\\partial M_{ik}(q)}{\\partial q^j} + \\frac{\\partial M_{ki}(q)}{\\partial q^j} \\right) v^k + \\frac{\\partial b_i(q)}{\\partial q^j}\n    $$\n组合这些分块，纤维导数的雅可比矩阵为：\n$$\nD(\\mathcal{F}L)(q,v) = \\begin{pmatrix} I_n  0_n \\\\ \\left[\\frac{\\partial p_i}{\\partial q^j}\\right]  \\tilde{M}(q) \\end{pmatrix}\n$$\n其中左下分块的第 $(i,j)$ 个元素是上面推导出的表达式。\n\n接下来，我们确定拉格朗日量 $L$ 为超正则的条件。根据定义，如果纤维导数 $\\mathcal{F}L: TQ \\to T^*Q$ 是一个微分同胚，则 $L$ 是超正则的。微分同胚是一个具有光滑逆映射的光滑映射。\n\n根据反函数定理，一个光滑映射在某点是局部微分同胚，当且仅当其雅可比矩阵在该点可逆。$\\mathcal{F}L$ 的雅可比矩阵是分块下三角矩阵，因此其行列式是对角分块行列式的乘积：\n$$\n\\det(D(\\mathcal{F}L)(q,v)) = \\det(I_n) \\det(\\tilde{M}(q)) = \\det(\\tilde{M}(q))\n$$\n为了使 $\\mathcal{F}L$ 在任何地方都是局部微分同胚，其雅可比矩阵必须对所有 $(q,v) \\in TQ$ 都可逆。这要求对所有 $q \\in Q$ 都有 $\\det(\\tilde{M}(q)) \\neq 0$。这意味着动能矩阵的对称部分 $\\tilde{M}(q)$ 必须在整个流形 $Q$ 上是非奇异的（可逆的）。\n\n我们来检查这个条件是否也足以使 $\\mathcal{F}L$ 成为一个全局微分同胚。我们必须证明该映射是双射的，并且其逆映射是光滑的。该映射为 $\\mathcal{F}L(q,v) = (q', p')$，其中 $q'=q$ 且 $p' = \\tilde{M}(q)v + b(q)$。为了找到逆映射，我们用 $(q',p')$ 来求解 $(q,v)$。显然，$q=q'$。然后我们求解 $v$：\n$$\np' = \\tilde{M}(q')v + b(q') \\implies \\tilde{M}(q')v = p' - b(q')\n$$\n如果 $\\tilde{M}(q')$ 可逆，我们可以求得 $v$ 的唯一解：\n$$\nv = (\\tilde{M}(q'))^{-1} (p' - b(q'))\n$$\n这定义了逆映射 $\\mathcal{F}L^{-1}: T^*Q \\to TQ$ 为 $\\mathcal{F}L^{-1}(q',p') = (q', (\\tilde{M}(q'))^{-1}(p' - b(q')))$。该映射是良定义且双射的，当且仅当 $\\tilde{M}(q)$ 对所有 $q \\in Q$ 都可逆。\n此外，如果此条件成立，则逆映射是光滑的。由于 $M(q)$ 和 $b(q)$ 是光滑的，$\\tilde{M}(q)$ 也是光滑的。逆矩阵 $(\\tilde{M}(q))^{-1}$ 的元素是 $\\tilde{M}(q)$ 元素的有理函数（通过伴随矩阵公式），并且由于行列式非零，逆矩阵也是 $q$ 的光滑函数。因此，映射 $\\mathcal{F}L^{-1}$ 是光滑的。\n\n因此，拉格朗日量 $L$ 为超正则的充要条件是矩阵 $\\tilde{M}(q) = \\frac{1}{2}(M(q) + M(q)^\\top)$ 对所有 $q \\in Q$ 都是非奇异的。\n\n问题要求将雅可比矩阵作为最终答案。我们以分块形式给出，并指明每个分块的元素。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nI_n  0_n \\\\\n\\left[ \\sum_{k=1}^n \\frac{1}{2} \\left( \\frac{\\partial M_{ik}}{\\partial q^j} + \\frac{\\partial M_{ki}}{\\partial q^j} \\right) v^k + \\frac{\\partial b_i}{\\partial q^j} \\right]  \\frac{1}{2}\\left(M(q) + M(q)^\\top\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "并非所有物理系统都是超正则的。本练习将探讨奇异拉格朗日量这一重要情况，此时勒让德变换是不可逆的。通过一个具体的例子 ，您将看到这种不可逆性如何导致主约束的出现——一个与速度无关、仅联系相空间变量的方程。这个概念是理解约束系统和规范理论的入门，而这两者都是现代物理学的核心。",
            "id": "3744691",
            "problem": "设 $Q$ 为位形流形 $\\mathbb{R}^{2}$，其全局坐标为 $(q_{1},q_{2})$，并令 $TQ$ 表示其切丛，其诱导坐标为 $(q_{1},q_{2},v_{1},v_{2})$。考虑作用量泛函 $S[q]=\\int_{t_{0}}^{t_{1}}L(q(t),\\dot{q}(t))\\,dt$，其中拉格朗日量 $L:TQ\\to\\mathbb{R}$ 由 $L(q,v)=\\tfrac{1}{2}(1+q_{1}^{2})\\,v_{1}^{2}+q_{2}\\,v_{1}+\\sin(q_{1})\\,v_{2}-U(q)$ 给出，其中 $U:Q\\to\\mathbb{R}$ 是一个光滑势。纤维导数（也称为勒让德变换）$\\mathcal{F}L:TQ\\to T^{*}Q$ 由广义动量 $p_{i}=\\frac{\\partial L}{\\partial v_{i}}$ 逐点定义，因此 $\\mathcal{F}L(q,v)=(q,p)$，其中 $p=(p_{1},p_{2})$。\n\n从哈密顿原理和欧拉-拉格朗日方程的定义出发，并仅使用几何力学和辛方法的标准构造，完成以下任务：\n- 确定与给定拉格朗日量相关的广义动量 $(p_{1},p_{2})$，并用它们分析映射 $\\mathcal{F}L$ 在 $TQ$ 上任意点附近的局部可逆性。\n- 确定 $\\mathcal{F}L$ 是否不具有局部可逆性，若是，则将主约束子流形识别为余切丛 $T^{*}Q$ 中的一个嵌入子流形。\n- 将你的最终答案表示为一个约束函数 $\\phi(q,p)$ 的单一解析表达式，其零点集定义了 $T^{*}Q$ 中的主约束子流形。不要写等式，也不要包含任何单位。\n\n你的最终答案必须是如上所述的单一解析表达式 $\\phi(q,p)$。",
            "solution": "该问题要求分析给定拉格朗日量的纤维导数（勒让德变换）的局部可逆性，并识别余切丛 $T^*Q$ 中的主约束子流形。位形流形是 $Q=\\mathbb{R}^2$，坐标为 $(q_1, q_2)$。切丛 $TQ$ 的诱导坐标为 $(q_1, q_2, v_1, v_2)$。拉格朗日量 $L: TQ \\to \\mathbb{R}$ 由下式给出：\n$$L(q,v) = \\frac{1}{2}(1+q_1^2)v_1^2 + q_2 v_1 + \\sin(q_1)v_2 - U(q)$$\n其中 $U(q)$ 是一个势能函数。余切丛 $T^*Q$ 的坐标为 $(q_1, q_2, p_1, p_2)$。\n\n首先，我们通过计算拉格朗日量 $L$ 对广义速度 $v_i$ 的偏导数来确定广义动量 $p_i$。纤维导数 $\\mathcal{F}L: TQ \\to T^*Q$ 将 $(q,v)$ 映射到 $(q,p)$，其中 $p_i = \\frac{\\partial L}{\\partial v_i}$。\n\n对于 $p_1$，我们有：\n$$p_1 = \\frac{\\partial L}{\\partial v_1} = \\frac{\\partial}{\\partial v_1}\\left(\\frac{1}{2}(1+q_1^2)v_1^2 + q_2 v_1 + \\sin(q_1)v_2 - U(q)\\right)$$\n$$p_1 = (1+q_1^2)v_1 + q_2$$\n\n对于 $p_2$，我们有：\n$$p_2 = \\frac{\\partial L}{\\partial v_2} = \\frac{\\partial}{\\partial v_2}\\left(\\frac{1}{2}(1+q_1^2)v_1^2 + q_2 v_1 + \\sin(q_1)v_2 - U(q)\\right)$$\n$$p_2 = \\sin(q_1)$$\n\n对于一个固定的位形 $q=(q_1, q_2)$，从速度 $v=(v_1, v_2)$ 到动量 $p=(p_1, p_2)$ 的映射由这两个方程给出。此映射以及纤维导数 $\\mathcal{F}L$ 的局部可逆性，取决于我们是否能根据动量 $p_1, p_2$ 和位形 $q_1, q_2$ 唯一地解出速度 $v_1$ 和 $v_2$。\n\n根据反函数定理，该映射是局部可逆的，当且仅当其雅可比矩阵是非奇异的。这个雅可比矩阵是拉格朗日量关于速度的黑塞矩阵，即 $W_{ij}(q,v) = \\frac{\\partial^2 L}{\\partial v_i \\partial v_j}$。如果这个矩阵可逆，则称拉格朗日量是正则的，否则是奇异的。\n\n我们来计算黑塞矩阵 $W$ 的分量：\n$$W_{11} = \\frac{\\partial^2 L}{\\partial v_1^2} = \\frac{\\partial p_1}{\\partial v_1} = \\frac{\\partial}{\\partial v_1}((1+q_1^2)v_1 + q_2) = 1+q_1^2$$\n$$W_{12} = \\frac{\\partial^2 L}{\\partial v_1 \\partial v_2} = \\frac{\\partial p_1}{\\partial v_2} = \\frac{\\partial}{\\partial v_2}((1+q_1^2)v_1 + q_2) = 0$$\n$$W_{21} = \\frac{\\partial^2 L}{\\partial v_2 \\partial v_1} = \\frac{\\partial p_2}{\\partial v_1} = \\frac{\\partial}{\\partial v_1}(\\sin(q_1)) = 0$$\n$$W_{22} = \\frac{\\partial^2 L}{\\partial v_2^2} = \\frac{\\partial p_2}{\\partial v_2} = \\frac{\\partial}{\\partial v_2}(\\sin(q_1)) = 0$$\n\n因此，黑塞矩阵为：\n$$W(q,v) = \\begin{pmatrix} 1+q_1^2  0 \\\\ 0  0 \\end{pmatrix}$$\n该矩阵的行列式为 $\\det(W) = (1+q_1^2)(0) - (0)(0) = 0$。由于对于所有点 $(q,v) \\in TQ$，行列式都为零，所以黑塞矩阵处处奇异。这意味着拉格朗日量是奇异的，并且纤维导数 $\\mathcal{F}L$ 在任何点都不是局部可逆的。\n\n勒让德变换的奇异性意味着存在主约束。这些是相空间变量 $(q,p)$ 之间与速度 $v$ 无关的关系。我们可以通过检查动量的方程来找到它们：\n1. $\\quad p_1 = (1+q_1^2)v_1 + q_2$\n2. $\\quad p_2 = \\sin(q_1)$\n\n第二个方程 $p_2 = \\sin(q_1)$ 是相空间坐标 $(q_1, p_2)$ 之间的一个关系，它不涉及任何速度。对于任何位于纤维导数 $\\mathcal{F}L$ 像中的点 $(q,p)$，这个方程都必须成立。此关系将主约束子流形定义为余切丛 $T^*Q$ 的一个子集。\n\n第一个方程可以解出 $v_1$：\n$$v_1 = \\frac{p_1 - q_2}{1+q_1^2}$$\n这是良定义的，因为对于所有实数 $q_1$，$1+q_1^2 \\ge 1$。然而，速度 $v_2$ 没有出现在任何定义动量的方程中。这就是奇异性的来源。\n\n主约束子流形是 $T^*Q$ 中约束关系成立的点的集合。问题要求一个约束函数 $\\phi(q,p)$ 的单一解析表达式，其零点集 $\\phi(q,p)=0$ 定义了这个子流形。从关系式 $p_2 = \\sin(q_1)$，我们可以将约束函数 $\\phi$ 定义为：\n$$\\phi(q,p) = p_2 - \\sin(q_1)$$\n因此，主约束子流形是集合 $\\{(q,p) \\in T^*Q \\mid p_2 - \\sin(q_1) = 0\\}$。这就是所要求的最终表达式。",
            "answer": "$$\\boxed{p_{2} - \\sin(q_{1})}$$"
        },
        {
            "introduction": "哈密顿原理的初级教学通常建立在固定端点的简化假设上，这使得作用量变分的边界项消失。本练习将移除这一简化，以揭示变分原理更深层的威力 。您将推导自由端点的“自然边界条件”，以及更一般的、端点受限于一流形时的“横截性条件”，从而揭示动力学与几何学之间优美的联系。",
            "id": "3744671",
            "problem": "考虑一个机械系统，其位形空间为 $Q=\\mathbb{R}^{n}$，具有一个光滑的拉格朗日量 $L: TQ \\times \\mathbb{R} \\to \\mathbb{R}$，在局域坐标中写作 $L(q,\\dot{q},t)$，其中 $q \\in \\mathbb{R}^{n}$ 且 $\\dot{q} \\in \\mathbb{R}^{n}$。设作用量泛函为 $S[q]=\\int_{t_{0}}^{t_{1}} L(q(t),\\dot{q}(t),t)\\,dt$。假设初始端点 $q(t_{0})$ 是固定的，但末端端点 $q(t_{1})$ 不固定。\n\nA部分：从哈密顿原理（即对于所有容许变分 $\\delta q$，一阶变分 $\\delta S$ 为零）出发，推导内部方程，并明确展示当端点完全自由时，允许 $\\delta q(t_{1})\\neq 0$ 如何在 $t_{1}$ 处产生一个自然边界条件。\n\nB部分：现在假设末端端点 $q(t_{1})$ 被约束在一个光滑嵌入子流形 $\\mathcal{S}\\subset \\mathbb{R}^{n}$ 上，该子流形在局部定义为\n$$\n\\mathcal{S}=\\{\\,q\\in\\mathbb{R}^{n}\\mid g_{i}(q)=0,\\;i=1,\\dots,k\\,\\},\n$$\n其中每个 $g_{i}:\\mathbb{R}^{n}\\to\\mathbb{R}$ 都是光滑的，并且 $k\\times n$ 的雅可比矩阵在 $q(t_{1})$ 处的秩为 $k$，因此 $\\mathcal{S}$ 的余维为 $k$。对于容许变分，要求 $\\delta q(t_{0})=0$ 且 $\\delta q(t_{1})\\in T_{q(t_{1})}\\mathcal{S}$，即在端点处 $\\mathcal{S}$ 的切空间。\n\n使用哈密顿原理以及仅有的基本定义和运算（分部积分法以及通过约束的梯度来定义切空间和法空间），计算在 $t_{1}$ 处受约束端点的横截条件。将你最终的横截条件表示为一个单一的解析表达式，该表达式将 $\\frac{\\partial L}{\\partial \\dot{q}}(t_{1})$ 与梯度 $\\nabla g_{i}(q(t_{1}))$ 联系起来。\n\n你的最终答案必须是一个单一的闭式解析表达式。不需要进行数值计算。",
            "solution": "该问题要求为一个轨迹端点被约束在子流形上的机械系统推导横截条件。我们将从哈密顿原理的基本陈述出发。\n\n设系统在时间 $t$ 的位形由广义坐标 $q(t) = (q_1(t), \\dots, q_n(t)) \\in \\mathbb{R}^n$ 描述。作用量泛函定义为拉格朗日量 $L(q, \\dot{q}, t)$ 的时间积分：\n$$\nS[q] = \\int_{t_{0}}^{t_{1}} L(q(t), \\dot{q}(t), t) \\, dt\n$$\n哈密顿原理假定，系统在固定的初始状态 $q(t_0)$ 和一个末状态之间所采取的实际路径使作用量取驻值。这意味着对于路径 $q(t)$ 的任何容许变分 $\\delta q(t)$，作用量的一阶变分 $\\delta S$ 必须为零。一个容许变分是路径的一个无穷小微扰 $\\delta q(t)$，它遵守给定的约束。\n\n我们首先计算作用量的一阶变分 $\\delta S$。拉格朗日量的变分由链式法则给出：\n$$\n\\delta L = \\sum_{j=1}^{n} \\frac{\\partial L}{\\partial q_j} \\delta q_j + \\sum_{j=1}^{n} \\frac{\\partial L}{\\partial \\dot{q}_j} \\delta \\dot{q}_j\n$$\n利用变分与时间微分的可交换性，$\\delta \\dot{q}_j = \\delta \\left(\\frac{dq_j}{dt}\\right) = \\frac{d}{dt}(\\delta q_j)$，作用量的变分变为：\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\delta L(q, \\dot{q}, t) \\, dt = \\int_{t_{0}}^{t_{1}} \\left( \\sum_{j=1}^{n} \\frac{\\partial L}{\\partial q_j} \\delta q_j + \\sum_{j=1}^{n} \\frac{\\partial L}{\\partial \\dot{q}_j} \\frac{d}{dt}(\\delta q_j) \\right) dt\n$$\n我们对每个分量 $j$ 的第二项应用分部积分：\n$$\n\\int_{t_{0}}^{t_{1}} \\frac{\\partial L}{\\partial \\dot{q}_j} \\frac{d}{dt}(\\delta q_j) \\, dt = \\left[ \\frac{\\partial L}{\\partial \\dot{q}_j} \\delta q_j \\right]_{t_{0}}^{t_{1}} - \\int_{t_{0}}^{t_{1}} \\left( \\frac{d}{dt} \\frac{\\partial L}{\\partial \\dot{q}_j} \\right) \\delta q_j \\, dt\n$$\n将此代回 $\\delta S$ 的表达式并重新整理各项，得到：\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\sum_{j=1}^{n} \\left( \\frac{\\partial L}{\\partial q_j} - \\frac{d}{dt} \\frac{\\partial L}{\\partial \\dot{q}_j} \\right) \\delta q_j \\, dt + \\left[ \\sum_{j=1}^{n} \\frac{\\partial L}{\\partial \\dot{q}_j} \\delta q_j \\right]_{t_{0}}^{t_{1}}\n$$\n这个表达式是基本的。在更紧凑的矢量记法中，其中 $\\frac{\\partial L}{\\partial q}$ 和 $\\frac{\\partial L}{\\partial \\dot{q}}$ 表示偏导数向量，点积表示 $\\mathbb{R}^n$ 上的标准内积，我们有：\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\left( \\frac{\\partial L}{\\partial q} - \\frac{d}{dt} \\frac{\\partial L}{\\partial \\dot{q}} \\right) \\cdot \\delta q \\, dt + \\left[ \\frac{\\partial L}{\\partial \\dot{q}} \\cdot \\delta q \\right]_{t_{0}}^{t_{1}}\n$$\n为了使哈密顿原理 $\\delta S = 0$ 对开区间 $(t_0, t_1)$ 内的任意变分 $\\delta q(t)$ 成立，乘以 $\\delta q$ 的被积函数必须恒等于零。根据变分法基本引理，这一结论得出了欧拉-拉格朗日运动方程：\n$$\n\\frac{\\partial L}{\\partial q_j} - \\frac{d}{dt} \\frac{\\partial L}{\\partial \\dot{q}_j} = 0, \\quad j=1, \\dots, n\n$$\n在欧拉-拉格朗日方程被满足的情况下，条件 $\\delta S = 0$ 简化为边界项为零：\n$$\n\\left[ \\frac{\\partial L}{\\partial \\dot{q}} \\cdot \\delta q \\right]_{t_{0}}^{t_{1}} = \\frac{\\partial L}{\\partial \\dot{q}}(t_1) \\cdot \\delta q(t_1) - \\frac{\\partial L}{\\partial \\dot{q}}(t_0) \\cdot \\delta q(t_0) = 0\n$$\n边界条件的具体形式取决于对变分 $\\delta q(t_0)$ 和 $\\delta q(t_1)$ 所施加的约束。\n\nA部分：问题指定了一个固定的初始端点 $q(t_0)$，这意味着任何容许变分在初始时刻必须为零，即 $\\delta q(t_0)=0$。如果末端端点 $q(t_1)$ 是完全自由的，那么变分 $\\delta q(t_1)$ 是 $\\mathbb{R}^n$ 中的一个任意向量。边界条件方程则简化为：\n$$\n\\frac{\\partial L}{\\partial \\dot{q}}(t_1) \\cdot \\delta q(t_1) = 0\n$$\n因为这对任意向量 $\\delta q(t_1) \\in \\mathbb{R}^n$ 都必须成立，所以点积为零的唯一方式是另一个向量为零向量。这就给出了自由端点的自然边界条件：\n$$\n\\frac{\\partial L}{\\partial \\dot{q}}(t_1) = 0\n$$\n这个向量 $p(t_1) = \\frac{\\partial L}{\\partial \\dot{q}}(t_1)$ 是在时间 $t_1$ 的广义动量。因此，对于一个自由端点，动量必须为零。\n\nB部分：我们现在来回答主要问题。初始端点保持固定，所以 $\\delta q(t_0) = 0$。末端端点 $q(t_1)$ 被约束在一个光滑子流形 $\\mathcal{S} \\subset \\mathbb{R}^n$ 上，该子流形定义为 $k$ 个光滑函数的零点集：\n$$\n\\mathcal{S} = \\{\\, q \\in \\mathbb{R}^n \\mid g_i(q)=0, \\; i=1, \\dots, k \\,\\}\n$$\n路径 $q(t)$ 必须终结于这个曲面上，所以 $q(t_1) \\in \\mathcal{S}$。一个容许变分 $\\delta q$ 必须将一个终结于 $\\mathcal{S}$ 上的路径映射到另一个终结于 $\\mathcal{S}$ 上的路径。到一阶，这要求在端点处的变分向量 $\\delta q(t_1)$ 位于点 $q(t_1)$ 处 $\\mathcal{S}$ 的切空间内。即 $\\delta q(t_1) \\in T_{q(t_1)}\\mathcal{S}$。\n\n切空间 $T_{q(t_1)}\\mathcal{S}$ 是 $\\mathbb{R}^n$ 中所有与在 $q(t_1)$ 处计算的所有约束函数的梯度正交的向量的集合。令 $v = \\delta q(t_1)$。那么 $v \\in T_{q(t_1)}\\mathcal{S}$ 当且仅当：\n$$\n\\nabla g_i(q(t_1)) \\cdot v = 0 \\quad \\text{对于所有 } i=1, \\dots, k\n$$\n对边界变分的条件仍然是 $\\frac{\\partial L}{\\partial \\dot{q}}(t_1) \\cdot \\delta q(t_1) = 0$。然而，现在这个条件不是对任意的 $\\delta q(t_1)$ 成立，而是对所有属于子空间 $T_{q(t_1)}\\mathcal{S}$ 的 $\\delta q(t_1)$ 成立。\n\n令 $p(t_1) = \\frac{\\partial L}{\\partial \\dot{q}}(t_1)$。条件是对于所有 $v \\in T_{q(t_1)}\\mathcal{S}$，都有 $p(t_1) \\cdot v = 0$。这意味着向量 $p(t_1)$ 与整个切空间 $T_{q(t_1)}\\mathcal{S}$ 正交。在一个欧几里得空间中，一个与子空间正交的向量必须位于其正交补空间中。切空间的正交补 $(T_{q(t_1)}\\mathcal{S})^\\perp$ 是子流形 $\\mathcal{S}$ 在 $q(t_1)$ 处的法空间。\n\n法空间由约束函数的梯度向量 $\\{\\nabla g_i(q(t_1))\\}_{i=1,\\dots,k}$ 张成。问题说明 $g_i$ 的雅可比矩阵具有满秩 $k$，这确保了这 $k$ 个梯度向量是线性无关的，从而构成了 $k$ 维法空间的一个基。\n\n因此，由于动量向量 $p(t_1) = \\frac{\\partial L}{\\partial \\dot{q}}(t_1)$ 属于法空间，它必须可以表示为这些基向量的线性组合。这导致存在 $k$ 个实值标量 $\\lambda_1, \\dots, \\lambda_k$（即拉格朗日乘子），使得：\n$$\n\\frac{\\partial L}{\\partial \\dot{q}}(t_1) = \\sum_{i=1}^{k} \\lambda_i \\nabla g_i(q(t_1))\n$$\n这就是受约束端点的横截条件。它表明，系统在末端时刻的广义动量向量必须垂直于约束曲面 $\\mathcal{S}$。这个单一的解析表达式通过 $L$ 将依赖于动力学的动量与通过函数 $g_i$ 的梯度将依赖于约束曲面几何的量联系起来。",
            "answer": "$$\n\\boxed{\\frac{\\partial L}{\\partial \\dot{q}}(t_{1}) = \\sum_{i=1}^{k} \\lambda_i \\nabla g_i(q(t_{1}))}\n$$"
        }
    ]
}