{
    "hands_on_practices": [
        {
            "introduction": "哈密顿力学的威力在于其泊松括号优美的代数结构。然而，这些括号并非凭空而来。本练习旨在夯实基础，它将展示这些我们熟悉的括号关系是如何从余切丛的内蕴几何——即典范辛形式——中直接推导出来的。通过这个练习，你将亲手连接起抽象的几何定义（如辛形式 $\\omega$ 和哈密顿向量场 $X_H$）与具体的计算法则，深刻理解哈密顿力学的几何本质。",
            "id": "3736163",
            "problem": "设 $Q$ 是一个光滑的 $n$ 维流形，并考虑其具有局部正则坐标 $(q^{i},p_{i})$ 的余切丛 $T^{*}Q$，其中 $i=1,\\dots,n$。正则（重言）1-形式定义为 $\\theta = p_{i}\\,dq^{i}$，正则辛形式定义为 $\\omega = -d\\theta$。根据构造，$\\omega$ 是非退化和闭的。与一个光滑函数 $f \\in C^{\\infty}(T^{*}Q)$ 相关联的哈密顿向量场 $X_{f}$ 由关系式 $i_{X_{f}}\\omega = df$ 定义，其中 $i_{X_{f}}$ 表示内缩。两个光滑函数 $f,g \\in C^{\\infty}(T^{*}Q)$ 的泊松括号定义为 $\\{f,g\\} := \\omega(X_{f},X_{g})$。\n\n仅从这些定义和无坐标原理出发，在局部坐标 $(q^{i},p_{i})$ 中推导哈密顿向量场 $X_{q^{i}}$ 和 $X_{p_{j}}$，然后计算坐标函数的泊松括号。具体而言，在正则坐标下确定 $\\{q^{i},q^{j}\\}$、$\\{p_{i},p_{j}\\}$ 和 $\\{q^{i},p_{j}\\}$ 的值。将 $i$ 和 $j$ 视为固定指标，当它们一起出现在同一个括号中时，不对它们求和。\n\n以单行矩阵的形式给出你的最终答案，按顺序列出 $\\{q^{i},q^{j}\\}$、$\\{p_{i},p_{j}\\}$ 和 $\\{q^{i},p_{j}\\}$ 这三个值。无需四舍五入，也不涉及物理单位。用精确的符号形式表示你的答案。",
            "solution": "问题陈述是微分几何和哈密顿力学中的一个标准练习。它是自洽的、有科学依据且适定的。所提供的所有定义都是标准且正确的。因此，我们可以直接进行推导。\n\n目标是使用所提供的无坐标定义计算基本泊松括号 $\\{q^{i},q^{j}\\}$、$\\{p_{i},p_{j}\\}$ 和 $\\{q^{i},p_{j}\\}$。该过程包括三个主要步骤：\n1.  在局部坐标 $(q^{i},p_{i})$ 中表示正则辛形式 $\\omega$。\n2.  确定坐标函数 $f=q^{i}$ 和 $f=p_{j}$ 的哈密顿向量场 $X_{f}$。\n3.  使用定义 $\\{f,g\\} = \\omega(X_{f},X_{g})$ 计算泊松括号。\n\n让我们开始。为避免指标混淆，我们将对哑指标 $k$（从 $1$ 到 $n$）应用爱因斯坦求和约定，而 $i$ 和 $j$ 将按规定被视为固定指标。\n\n**步骤 1：局部坐标下的正则辛形式**\n\n正则 1-形式由 $\\theta = p_{k}\\,dq^{k}$ 给出。辛形式 $\\omega$ 定义为其外微分，$\\omega = -d\\theta$。我们计算这个微分：\n$$\n\\omega = -d(p_{k}\\,dq^{k})\n$$\n应用外微分的莱布尼茨法则，$d(\\alpha \\wedge \\beta) = d\\alpha \\wedge \\beta + (-1)^{\\deg(\\alpha)}\\alpha \\wedge d\\beta$，这里我们有一个 0-形式 $p_k$ 和一个 1-形式 $dq^k$：\n$$\n\\omega = -(dp_{k} \\wedge dq^{k} + p_{k} d(dq^{k}))\n$$\n外微分的一个基本性质是它是幂零的，即 $d^{2}=0$。因此，$d(dq^{k}) = d(d(q^k)) = 0$。这将 $\\omega$ 的表达式简化为：\n$$\n\\omega = -dp_{k} \\wedge dq^{k}\n$$\n使用楔积的反交换性，$dp_{k} \\wedge dq^{k} = -dq^{k} \\wedge dp_{k}$，我们可以将 $\\omega$ 写成其更常规的形式：\n$$\n\\omega = dq^{k} \\wedge dp_{k}\n$$\n这就是在局部坐标 $(q^k, p_k)$ 下正则辛形式的表达式。\n\n**步骤 2：坐标函数的哈密顿向量场**\n\n$T^{*}Q$ 上的一个一般向量场 $X$ 在局部坐标下可以写成 $X = A^{k}\\frac{\\partial}{\\partial q^{k}} + B_{k}\\frac{\\partial}{\\partial p_{k}}$。函数 $f$ 的哈密顿向量场 $X_{f}$ 由关系式 $i_{X_{f}}\\omega = df$ 定义。我们将此定义应用于坐标函数 $q^i$ 和 $p_j$。\n\n首先，我们计算一般向量场 $X$ 的内缩 $i_{X}\\omega$：\n$$\ni_{X}\\omega = i_{A^{l}\\frac{\\partial}{\\partial q^{l}} + B_{l}\\frac{\\partial}{\\partial p_{l}}}(dq^{k} \\wedge dp_{k})\n$$\n利用内缩的线性和它在楔积上的作用，$i_V(\\alpha \\wedge \\beta) = (i_V\\alpha)\\wedge\\beta - \\alpha\\wedge(i_V\\beta)$:\n$$\n\\begin{aligned}\ni_{X}\\omega = \\sum_{k,l} \\left( A^{l} i_{\\frac{\\partial}{\\partial q^{l}}}(dq^{k} \\wedge dp_{k}) + B_{l} i_{\\frac{\\partial}{\\partial p_{l}}}(dq^{k} \\wedge dp_{k}) \\right) \\\\\n= \\sum_{k,l} A^{l} \\left( (i_{\\frac{\\partial}{\\partial q^{l}}}dq^{k}) \\wedge dp_{k} - dq^{k} \\wedge (i_{\\frac{\\partial}{\\partial q^{l}}}dp_{k}) \\right) + \\sum_{k,l} B_{l} \\left( (i_{\\frac{\\partial}{\\partial p_{l}}}dq^{k}) \\wedge dp_{k} - dq^{k} \\wedge (i_{\\frac{\\partial}{\\partial p_{l}}}dp_{k}) \\right)\n\\end{aligned}\n$$\n根据定义，$dq^{k}(\\frac{\\partial}{\\partial q^{l}}) = \\delta^{k}_{l}$，$dp_{k}(\\frac{\\partial}{\\partial p_{l}}) = \\delta_{k}^{l}$，所有其他组合均为零。因此：\n$$\n\\begin{aligned}\ni_{X}\\omega = \\sum_{k,l} A^{l} ( \\delta^{k}_{l} \\wedge dp_{k} - dq^{k} \\wedge 0 ) + \\sum_{k,l} B_{l} ( 0 \\wedge dp_{k} - dq^{k} \\wedge \\delta_{k}^{l} ) \\\\\n= \\sum_{l} A^{l}dp_{l} - \\sum_{l} B_{l}dq^{l} \\\\\n= A^{k}dp_{k} - B_{k}dq^{k}\n\\end{aligned}\n$$\n\n现在我们来寻找特定的向量场。\n\n对于 $f=q^{i}$（其中 $i$ 固定）：\n微分是 $df = dq^{i}$。我们必须求解 $i_{X_{q^{i}}}\\omega = dq^{i}$。设 $X_{q^{i}} = A^{k}\\frac{\\partial}{\\partial q^{k}} + B_{k}\\frac{\\partial}{\\partial p_{k}}$。将我们的一般结果与 $dq^{i}$ 等同：\n$$\nA^{k}dp_{k} - B_{k}dq^{k} = dq^{i}\n$$\n1-形式 $\\{dq^{k}\\}$ 和 $\\{dp_{k}\\}$ 构成了每一点上余切空间的基。通过比较系数：\n- $dp_k$ 的系数在左边是 $A^k$，在右边是 $0$，所以对所有 $k$ 都有 $A^k = 0$。\n- $dq^k$ 的系数在左边是 $-B_k$，在右边是 $\\delta^i_k$，所以 $-B_k = \\delta^i_k$，这意味着 $B_k = -\\delta^i_k$。\n将这些系数代入 $X_{q^i}$ 的表达式中：\n$$\nX_{q^{i}} = 0 \\cdot \\frac{\\partial}{\\partial q^{k}} + (-\\delta^{i}_{k})\\frac{\\partial}{\\partial p_{k}} = -\\frac{\\partial}{\\partial p_{i}}\n$$\n\n对于 $f=p_{j}$（其中 $j$ 固定）：\n微分是 $df = dp_{j}$。设 $X_{p_{j}} = C^{k}\\frac{\\partial}{\\partial q^{k}} + D_{k}\\frac{\\partial}{\\partial p_{k}}$。定义方程是 $i_{X_{p_{j}}}\\omega = dp_{j}$。\n$$\nC^{k}dp_{k} - D_{k}dq^{k} = dp_{j}\n$$\n比较基 1-形式的系数：\n- $dp_k$ 的系数在左边是 $C^k$，在右边是 $\\delta^k_j$，所以 $C^k = \\delta^k_j$。\n- $dq^k$ 的系数在左边是 $-D_k$，在右边是 $0$，所以对所有 $k$ 都有 $D_k = 0$。\n代入这些系数：\n$$\nX_{p_{j}} = \\delta^{k}_{j}\\frac{\\partial}{\\partial q^{k}} + 0 \\cdot \\frac{\\partial}{\\partial p_{k}} = \\frac{\\partial}{\\partial q^{j}}\n$$\n\n**步骤 3：泊松括号的计算**\n\n泊松括号定义为 $\\{f,g\\} = \\omega(X_{f},X_{g})$。我们现在计算所需的括号。2-形式 $\\omega = dq^k \\wedge dp_k$ 在两个向量场 $V$ 和 $W$ 上的作用由 $\\omega(V,W) = \\sum_k (dq^k(V)dp_k(W) - dq^k(W)dp_k(V))$ 给出。\n\n1.  **$\\{q^{i},q^{j}\\}$**:\n    $$\n    \\{q^{i},q^{j}\\} = \\omega(X_{q^{i}}, X_{q^{j}}) = \\omega\\left(-\\frac{\\partial}{\\partial p_{i}}, -\\frac{\\partial}{\\partial p_{j}}\\right) = \\omega\\left(\\frac{\\partial}{\\partial p_{i}}, \\frac{\\partial}{\\partial p_{j}}\\right)\n    $$\n    $$\n    \\{q^{i},q^{j}\\} = \\sum_{k} \\left( dq^{k}\\left(\\frac{\\partial}{\\partial p_{i}}\\right)dp_{k}\\left(\\frac{\\partial}{\\partial p_{j}}\\right) - dq^{k}\\left(\\frac{\\partial}{\\partial p_{j}}\\right)dp_{k}\\left(\\frac{\\partial}{\\partial p_{i}}\\right) \\right) = \\sum_{k} (0 \\cdot \\delta_{k}^{j} - 0 \\cdot \\delta_{k}^{i}) = 0\n    $$\n\n2.  **$\\{p_{i},p_{j}\\}$**:\n    $$\n    \\{p_{i},p_{j}\\} = \\omega(X_{p_{i}}, X_{p_{j}}) = \\omega\\left(\\frac{\\partial}{\\partial q^{i}}, \\frac{\\partial}{\\partial q^{j}}\\right)\n    $$\n    $$\n    \\{p_{i},p_{j}\\} = \\sum_{k} \\left( dq^{k}\\left(\\frac{\\partial}{\\partial q^{i}}\\right)dp_{k}\\left(\\frac{\\partial}{\\partial q^{j}}\\right) - dq^{k}\\left(\\frac{\\partial}{\\partial q^{j}}\\right)dp_{k}\\left(\\frac{\\partial}{\\partial q^{i}}\\right) \\right) = \\sum_{k} (\\delta^{k}_{i} \\cdot 0 - \\delta^{k}_{j} \\cdot 0) = 0\n    $$\n\n3.  **$\\{q^{i},p_{j}\\}$**:\n    $$\n    \\{q^{i},p_{j}\\} = \\omega(X_{q^{i}}, X_{p_{j}}) = \\omega\\left(-\\frac{\\partial}{\\partial p_{i}}, \\frac{\\partial}{\\partial q^{j}}\\right)\n    $$\n    $$\n    \\{q^{i},p_{j}\\} = \\sum_{k} \\left( dq^{k}\\left(-\\frac{\\partial}{\\partial p_{i}}\\right)dp_{k}\\left(\\frac{\\partial}{\\partial q^{j}}\\right) - dq^{k}\\left(\\frac{\\partial}{\\partial q^{j}}\\right)dp_{k}\\left(-\\frac{\\partial}{\\partial p_{i}}\\right) \\right)\n    $$\n    将微分作用于基向量的值代入：\n    $$\n    \\{q^{i},p_{j}\\} = \\sum_{k} \\left( 0 \\cdot 0 - \\delta^{k}_{j}(-\\delta_{k}^{i}) \\right) = \\sum_{k} \\delta^{k}_{j}\\delta_{k}^{i} = \\delta^{i}_{j}\n    $$\n    最终的恒等式是通过对指标 $k$ 收缩克罗内克 δ 符号得出的。\n\n总之，正则坐标的基本泊松括号是：\n$\\{q^{i},q^{j}\\} = 0$\n$\\{p_{i},p_{j}\\} = 0$\n$\\{q^{i},p_{j}\\} = \\delta^{i}_{j}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  \\delta^{i}_{j} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在建立了基本的泊松括号关系之后，下一步自然是观察它们如何运作。本练习将展示泊松括号在描述物理系统演化中的核心作用，即任何可观测量的时间导数都由其与哈密顿量的泊松括号给出。通过为一个具体的、非平凡的系统计算并验证 $\\dot{f} = \\{f, H\\}$ 这一等式，你将加深对辛结构如何主宰动力学的理解。",
            "id": "3736137",
            "problem": "考虑一个光滑的位形流形 $Q = \\mathbb{R}^{2}$，其全局坐标为 $(q_{1}, q_{2})$。其上的余切丛 $T^{*}Q$ 带有典范1-形式 $\\theta = p_{1}\\,\\mathrm{d}q_{1} + p_{2}\\,\\mathrm{d}q_{2}$ 和辛2-形式 $\\omega = \\mathrm{d}\\theta = \\mathrm{d}q_{1} \\wedge \\mathrm{d}p_{1} + \\mathrm{d}q_{2} \\wedge \\mathrm{d}p_{2}$，其中 $(q_{1}, q_{2}, p_{1}, p_{2})$ 是典范坐标。设哈密顿量 $H \\colon T^{*}Q \\to \\mathbb{R}$ 和可观测量 $f \\colon T^{*}Q \\to \\mathbb{R}$ 由下式给出\n$$\nH(q_{1}, q_{2}, p_{1}, p_{2}) = \\frac{1}{2}\\big(p_{1}^{2} + p_{2}^{2}\\big) + \\gamma\\, q_{1}\\, p_{2} + \\delta\\, q_{1}^{2}\\, q_{2},\n$$\n$$\nf(q_{1}, q_{2}, p_{1}, p_{2}) = p_{1}\\, q_{2}^{2} + \\sin(q_{1})\\, p_{2} + q_{1}\\, q_{2},\n$$\n其中 $\\gamma \\in \\mathbb{R}$ 和 $\\delta \\in \\mathbb{R}$ 是固定常数。\n\n从 $T^{*}Q$ 上的典范几何结构以及哈密顿向量场 $X_{H}$ 由其与辛形式的内积定义的式子，即 $\\,\\iota_{X_{H}}\\omega = \\mathrm{d}H\\,$ 出发，推导 $T^{*}Q$ 上的哈密顿运动方程，以及一个函数沿着由 $H$ 生成的哈密顿流的时间导数公式。利用这些结果，计算 $f$ 沿着 $X_{H}$ 的积分曲线的时间导数 $\\dot{f}$。然后，独立地从 $\\,\\iota_{X_{f}}\\omega = \\mathrm{d}f\\,$ 构造与 $f$ 相关的哈密顿向量场 $X_{f}$，并验证辛配对 $\\omega(X_{f}, X_{H})$ 与先前计算的 $\\dot{f}$ 一致。\n\n将您的最终结果表示为关于 $(q_{1}, q_{2}, p_{1}, p_{2}, \\gamma, \\delta)$ 的单个闭式解析表达式。不需要数值近似。",
            "solution": "在典范坐标 $(q_{1}, q_{2}, p_{1}, p_{2})$ 下，$Q = \\mathbb{R}^{2}$ 的余切丛 $T^{*}Q$ 配备有典范1-形式 $\\theta = p_{1}\\,\\mathrm{d}q_{1} + p_{2}\\,\\mathrm{d}q_{2}$ 和辛2-形式 $\\omega = \\mathrm{d}\\theta = \\mathrm{d}q_{1} \\wedge \\mathrm{d}p_{1} + \\mathrm{d}q_{2} \\wedge \\mathrm{d}p_{2}$。根据定义，与 $T^{*}Q$ 上的光滑函数 $H$ 相关的哈密顿向量场 $X_{H}$ 由以下条件确定\n$$\n\\iota_{X_{H}} \\omega = \\mathrm{d}H,\n$$\n其中 $\\iota_{X_{H}}$ 表示内积。在典范坐标中，写作\n$$\nX_{H} = a_{1}\\,\\frac{\\partial}{\\partial q_{1}} + a_{2}\\,\\frac{\\partial}{\\partial q_{2}} + b_{1}\\,\\frac{\\partial}{\\partial p_{1}} + b_{2}\\,\\frac{\\partial}{\\partial p_{2}}.\n$$\n使用 $\\omega$ 的显式形式，内积计算为\n$$\n\\iota_{X_{H}}\\omega = a_{1}\\,\\mathrm{d}p_{1} - b_{1}\\,\\mathrm{d}q_{1} + a_{2}\\,\\mathrm{d}p_{2} - b_{2}\\,\\mathrm{d}q_{2}.\n$$\n通过比较 $\\iota_{X_{H}}\\omega = \\mathrm{d}H$ 中的系数，得到\n$$\na_{i} = \\frac{\\partial H}{\\partial p_{i}}, \\quad b_{i} = -\\frac{\\partial H}{\\partial q_{i}}, \\quad i \\in \\{1,2\\}.\n$$\n因此，哈密顿运动方程为\n$$\n\\dot{q}_{i} = \\frac{\\partial H}{\\partial p_{i}}, \\qquad \\dot{p}_{i} = -\\frac{\\partial H}{\\partial q_{i}}.\n$$\n\n给定\n$$\nH(q_{1}, q_{2}, p_{1}, p_{2}) = \\frac{1}{2}\\big(p_{1}^{2} + p_{2}^{2}\\big) + \\gamma\\, q_{1}\\, p_{2} + \\delta\\, q_{1}^{2}\\, q_{2},\n$$\n我们计算其偏导数：\n$$\n\\frac{\\partial H}{\\partial p_{1}} = p_{1}, \\qquad \\frac{\\partial H}{\\partial p_{2}} = p_{2} + \\gamma\\, q_{1},\n$$\n$$\n\\frac{\\partial H}{\\partial q_{1}} = \\gamma\\, p_{2} + 2\\,\\delta\\, q_{1}\\, q_{2}, \\qquad \\frac{\\partial H}{\\partial q_{2}} = \\delta\\, q_{1}^{2}.\n$$\n因此，哈密顿向量场的分量和运动方程为\n$$\n\\dot{q}_{1} = p_{1}, \\qquad \\dot{q}_{2} = p_{2} + \\gamma\\, q_{1},\n$$\n$$\n\\dot{p}_{1} = -\\gamma\\, p_{2} - 2\\,\\delta\\, q_{1}\\, q_{2}, \\qquad \\dot{p}_{2} = -\\delta\\, q_{1}^{2}.\n$$\n\n对于光滑可观测量 $f \\colon T^{*}Q \\to \\mathbb{R}$，其沿着由 $H$ 生成的哈密顿流的时间导数，根据链式法则，沿着 $X_{H}$ 的积分曲线 $(q(t), p(t))$ 计算为：\n$$\n\\dot{f} = \\sum_{i=1}^{2}\\left(\\frac{\\partial f}{\\partial q_{i}}\\,\\dot{q}_{i} + \\frac{\\partial f}{\\partial p_{i}}\\,\\dot{p}_{i}\\right).\n$$\n对于\n$$\nf(q_{1}, q_{2}, p_{1}, p_{2}) = p_{1}\\, q_{2}^{2} + \\sin(q_{1})\\, p_{2} + q_{1}\\, q_{2},\n$$\n我们计算其偏导数：\n$$\n\\frac{\\partial f}{\\partial q_{1}} = \\cos(q_{1})\\, p_{2} + q_{2}, \\qquad \\frac{\\partial f}{\\partial q_{2}} = 2\\, p_{1}\\, q_{2} + q_{1},\n$$\n$$\n\\frac{\\partial f}{\\partial p_{1}} = q_{2}^{2}, \\qquad \\frac{\\partial f}{\\partial p_{2}} = \\sin(q_{1}).\n$$\n将先前求得的 $\\dot{q}_{i}$ 和 $\\dot{p}_{i}$ 代入链式法则，得到\n\\begin{align*}\n\\dot{f} = \\left(\\cos(q_{1})\\, p_{2} + q_{2}\\right)\\, \\dot{q}_{1} + \\left(2\\, p_{1}\\, q_{2} + q_{1}\\right)\\, \\dot{q}_{2} + q_{2}^{2}\\, \\dot{p}_{1} + \\sin(q_{1})\\, \\dot{p}_{2} \\\\\n= \\left(\\cos(q_{1})\\, p_{2} + q_{2}\\right)\\, p_{1} + \\left(2\\, p_{1}\\, q_{2} + q_{1}\\right)\\, (p_{2} + \\gamma\\, q_{1}) + q_{2}^{2}\\, \\big(-\\gamma\\, p_{2} - 2\\,\\delta\\, q_{1}\\, q_{2}\\big) + \\sin(q_{1})\\, \\big(-\\delta\\, q_{1}^{2}\\big).\n\\end{align*}\n展开并合并同类项，我们得到\n\\begin{align*}\n\\dot{f} = p_{1}\\, p_{2}\\, \\cos(q_{1}) + p_{1}\\, q_{2} + 2\\, p_{1}\\, q_{2}\\, p_{2} + q_{1}\\, p_{2} + 2\\, \\gamma\\, p_{1}\\, q_{1}\\, q_{2} + \\gamma\\, q_{1}^{2} \\\\\n\\quad - \\gamma\\, p_{2}\\, q_{2}^{2} - 2\\, \\delta\\, q_{1}\\, q_{2}^{3} - \\delta\\, q_{1}^{2}\\, \\sin(q_{1}).\n\\end{align*}\n\n我们现在使用辛形式 $\\omega$ 来验证这个结果。与 $f$ 相关的哈密顿向量场 $X_{f}$ 满足 $\\iota_{X_{f}}\\omega = \\mathrm{d}f$，并且通过与 $X_{H}$ 相同的坐标计算，我们有\n$$\nX_{f} = \\sum_{i=1}^{2}\\left(\\frac{\\partial f}{\\partial p_{i}}\\, \\frac{\\partial}{\\partial q_{i}} - \\frac{\\partial f}{\\partial q_{i}}\\, \\frac{\\partial}{\\partial p_{i}}\\right).\n$$\n在典范坐标中，两个向量场 $X$ 和 $Y$ 的辛配对是\n$$\n\\omega(X, Y) = \\sum_{i=1}^{2}\\left(\\mathrm{d}q_{i} \\wedge \\mathrm{d}p_{i}\\right)(X, Y) = \\sum_{i=1}^{2}\\left(X^{q_{i}}\\, Y^{p_{i}} - X^{p_{i}}\\, Y^{q_{i}}\\right),\n$$\n其中 $X^{q_{i}}$ 和 $X^{p_{i}}$ 分别表示 $X$ 沿 $\\partial/\\partial q_{i}$ 和 $\\partial/\\partial p_{i}$ 的分量。代入 $X_{f}$ 和 $X_{H}$ 得到\n\\begin{align*}\n\\omega(X_{f}, X_{H}) = \\sum_{i=1}^{2}\\left(\\frac{\\partial f}{\\partial p_{i}}\\, \\left(-\\frac{\\partial H}{\\partial q_{i}}\\right) - \\left(-\\frac{\\partial f}{\\partial q_{i}}\\right)\\, \\frac{\\partial H}{\\partial p_{i}}\\right) \\\\\n= \\sum_{i=1}^{2}\\left(\\frac{\\partial f}{\\partial q_{i}}\\, \\frac{\\partial H}{\\partial p_{i}} - \\frac{\\partial f}{\\partial p_{i}}\\, \\frac{\\partial H}{\\partial q_{i}}\\right).\n\\end{align*}\n另一方面，$\\dot{f}$ 沿着哈密顿流的链式法则表达式为\n$$\n\\dot{f} = \\sum_{i=1}^{2}\\left(\\frac{\\partial f}{\\partial q_{i}}\\, \\dot{q}_{i} + \\frac{\\partial f}{\\partial p_{i}}\\, \\dot{p}_{i}\\right) = \\sum_{i=1}^{2}\\left(\\frac{\\partial f}{\\partial q_{i}}\\, \\frac{\\partial H}{\\partial p_{i}} - \\frac{\\partial f}{\\partial p_{i}}\\, \\frac{\\partial H}{\\partial q_{i}}\\right),\n$$\n因为 $\\dot{q}_{i} = \\partial H/\\partial p_{i}$ 和 $\\dot{p}_{i} = -\\partial H/\\partial q_{i}$。因此，\n$$\n\\dot{f} = \\omega(X_{f}, X_{H}),\n$$\n并且显式计算与辛验证的结果一致。$\\dot{f}$ 的最终闭式表达式为\n$$\n\\dot{f} = p_{1}\\, p_{2}\\, \\cos(q_{1}) + 2\\, p_{1}\\, q_{2}\\, p_{2} + p_{1}\\, q_{2} + q_{1}\\, p_{2} + 2\\, \\gamma\\, p_{1}\\, q_{1}\\, q_{2} + \\gamma\\, q_{1}^{2} - \\gamma\\, p_{2}\\, q_{2}^{2} - 2\\, \\delta\\, q_{1}\\, q_{2}^{3} - \\delta\\, q_{1}^{2}\\, \\sin(q_{1}).\n$$",
            "answer": "$$\\boxed{p_{1} p_{2} \\cos(q_{1}) + 2 p_{1} q_{2} p_{2} + p_{1} q_{2} + q_{1} p_{2} + 2 \\gamma p_{1} q_{1} q_{2} + \\gamma q_{1}^{2} - \\gamma p_{2} q_{2}^{2} - 2 \\delta q_{1} q_{2}^{3} - \\delta q_{1}^{2} \\sin(q_{1})}$$"
        },
        {
            "introduction": "哈密顿力学中的一个核心概念是典范变换——一种保持哈密顿方程形式不变的坐标变换。这类变换之所以强大，是因为它们揭示了系统的对称性并能简化问题。本练习提供了一个动手实践的机会，通过计算一个线性变换的雅可比矩阵 $J$ 并验证其是否满足辛条件 $J^{T}\\Omega J=\\Omega$，你将对“典范”一词的几何意义获得具体而深入的认识。",
            "id": "3736180",
            "problem": "考虑 $Q=\\mathbb{R}^{2}$ 的余切丛 $T^{\\ast}Q$，其具有典范 Darboux 坐标 $(q^{1},q^{2},p_{1},p_{2})$ 和典范 1-形式 $\\theta = p_{i}\\,\\mathrm{d}q^{i}$，因此典范辛 2-形式为 $\\omega = \\mathrm{d}\\theta = \\mathrm{d}q^{i}\\wedge \\mathrm{d}p_{i}$。在这些坐标中，辛结构由 $4\\times 4$ 矩阵 $\\Omega$ 表示，其分块形式为 $\\Omega=\\begin{pmatrix}0  I_{2}\\\\-I_{2}  0\\end{pmatrix}$，其中 $I_{2}$ 是 $2\\times 2$ 单位矩阵。\n\n在 $T^{\\ast}Q$ 上定义一个局部变量变换如下：\n$$\n\\begin{pmatrix}\nQ^{1}\\\\\nQ^{2}\n\\end{pmatrix}\n=\nA\n\\begin{pmatrix}\nq^{1}\\\\\nq^{2}\n\\end{pmatrix},\n\\qquad\n\\begin{pmatrix}\nP_{1}\\\\\nP_{2}\n\\end{pmatrix}\n=\nA^{-T}\n\\begin{pmatrix}\np_{1}\\\\\np_{2}\n\\end{pmatrix}\n+\nS\n\\begin{pmatrix}\nQ^{1}\\\\\nQ^{2}\n\\end{pmatrix},\n$$\n其中 $A=\\begin{pmatrix}1  2\\\\0  1\\end{pmatrix}$，$S=\\begin{pmatrix}3  1\\\\1  2\\end{pmatrix}$ 是对称矩阵。将 $(Q^{1},Q^{2},P_{1},P_{2})$ 视为 $(q^{1},q^{2},p_{1},p_{2})$ 的函数，显式计算雅可比矩阵 $J=\\frac{\\partial(Q^{1},Q^{2},P_{1},P_{2})}{\\partial(q^{1},q^{2},p_{1},p_{2})}$。然后，从典范辛形式 $\\omega$ 及其矩阵表示 $\\Omega$ 的定义出发，检验辛条件 $J^{T}\\Omega J=\\Omega$ 在定义域的每一点都成立。\n\n将最终答案表示为具有数值元素的显式 $4\\times 4$ 雅可比矩阵 $J$。无需四舍五入。",
            "solution": "首先验证问题以确保其是适定的、有科学依据且一致的。\n\n**1. 提取已知条件**\n- 位形空间: $Q = \\mathbb{R}^{2}$。\n- 相空间: 余切丛 $T^*Q$。\n- 典范坐标: $(q^{1}, q^{2}, p_{1}, p_{2})$。\n- 典范 1-形式: $\\theta = p_{i}\\,\\mathrm{d}q^{i}$。\n- 典范辛 2-形式: $\\omega = \\mathrm{d}\\theta = \\mathrm{d}q^{i}\\wedge \\mathrm{d}p_{i}$。\n- 辛形式的矩阵: $\\Omega=\\begin{pmatrix}0  I_{2}\\\\-I_{2}  0\\end{pmatrix}$。\n- 新坐标 $(Q^{1}, Q^{2}, P_{1}, P_{2})$ 由以下变换定义：\n$$\n\\begin{pmatrix} Q^{1}\\\\ Q^{2} \\end{pmatrix} = A \\begin{pmatrix} q^{1}\\\\ q^{2} \\end{pmatrix}, \\qquad \\begin{pmatrix} P_{1}\\\\ P_{2} \\end{pmatrix} = A^{-T} \\begin{pmatrix} p_{1}\\\\ p_{2} \\end{pmatrix} + S \\begin{pmatrix} Q^{1}\\\\ Q^{2} \\end{pmatrix}\n$$\n- 给定矩阵: $A=\\begin{pmatrix}1  2\\\\0  1\\end{pmatrix}$ 和 $S=\\begin{pmatrix}3  1\\\\1  2\\end{pmatrix}$，其中 $S$ 是对称的。\n\n**2. 验证**\n该问题是关于线性典范变换的哈密顿力学中的一个标准练习。该变换是适定的，因为 $A$ 是可逆的（$\\det(A) = 1 \\neq 0$）。所使用的概念是辛几何的基础。各量定义清晰，目标具体且可形式化。因此，该问题被认为是有效的。\n\n**3. 求解**\n\n任务是计算变换的雅可比矩阵，并验证它代表一个辛映射。如果一个变换保持辛 2-形式 $\\omega$ 不变，则该变换是辛变换。对于雅可比矩阵为 $J$ 的线性变换，该条件以矩阵形式表示为 $J^{T}\\Omega J = \\Omega$。\n\n我们将 $\\mathbb{R}^{4}$ 中的坐标向量定义为 $z = (q^{1}, q^{2}, p_{1}, p_{2})^{T}$ 和 $Z = (Q^{1}, Q^{2}, P_{1}, P_{2})^{T}$。用分块矩阵形式表示，我们有 $q = (q^{1}, q^{2})^{T}$，$p = (p_{1}, p_{2})^{T}$，$Q = (Q^{1}, Q^{2})^{T}$ 和 $P = (P_{1}, P_{2})^{T}$。变换方程为：\n$$\nQ = Aq\n$$\n$$\nP = A^{-T}p + SQ\n$$\n将 $Q$ 的表达式代入第二个方程，我们得到完全用原始坐标 $(q, p)$ 表示的 $P$ 的变换：\n$$\nP = A^{-T}p + S(Aq)\n$$\n因此，从 $z$到 $Z$ 的完整变换可以写成分块矩阵形式：\n$$\nZ = \\begin{pmatrix} Q \\\\ P \\end{pmatrix} = \\begin{pmatrix} A  0 \\\\ SA  A^{-T} \\end{pmatrix} \\begin{pmatrix} q \\\\ p \\end{pmatrix}\n$$\n这是一个线性变换。该变换的雅可比矩阵 $J$ 是表示此线性映射的常数矩阵：\n$$\nJ = \\frac{\\partial(Q, P)}{\\partial(q, p)} = \\begin{pmatrix} \\frac{\\partial Q}{\\partial q}  \\frac{\\partial Q}{\\partial p} \\\\ \\frac{\\partial P}{\\partial q}  \\frac{\\partial P}{\\partial p} \\end{pmatrix} = \\begin{pmatrix} A  0 \\\\ SA  A^{-T} \\end{pmatrix}\n$$\n子块推导如下：\n- 从 $Q = Aq$ 可得 $\\frac{\\partial Q}{\\partial q} = A$ 和 $\\frac{\\partial Q}{\\partial p} = 0$。\n- 从 $P = A^{-T}p + SAq$ 可得 $\\frac{\\partial P}{\\partial q} = SA$ 和 $\\frac{\\partial P}{\\partial p} = A^{-T}$。\n\n现在，我们使用给定的矩阵 $A$ 和 $S$ 计算这些块的数值。\n$$\nA = \\begin{pmatrix} 1  2 \\\\ 0  1 \\end{pmatrix}, \\quad S = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}\n$$\n首先，我们计算 $A^{-1}$：\n$$\n\\det(A) = 1(1) - 2(0) = 1\n$$\n$$\nA^{-1} = \\frac{1}{1} \\begin{pmatrix} 1  -2 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  -2 \\\\ 0  1 \\end{pmatrix}\n$$\n然后，我们求逆的转置 $A^{-T} = (A^{-1})^{T}$：\n$$\nA^{-T} = \\begin{pmatrix} 1  0 \\\\ -2  1 \\end{pmatrix}\n$$\n接下来，我们计算乘积 $SA$：\n$$\nSA = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 1  2 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 3(1)+1(0)  3(2)+1(1) \\\\ 1(1)+2(0)  1(2)+2(1) \\end{pmatrix} = \\begin{pmatrix} 3  7 \\\\ 1  4 \\end{pmatrix}\n$$\n现在我们组装 $4 \\times 4$ 的雅可比矩阵 $J$：\n$$\nJ = \\begin{pmatrix} A  0 \\\\ SA  A^{-T} \\end{pmatrix} = \\begin{pmatrix} 1  2  0  0 \\\\ 0  1  0  0 \\\\ 3  7  1  0 \\\\ 1  4  -2  1 \\end{pmatrix}\n$$\n这就是所要求的显式雅可比矩阵。\n\n问题的第二部分要求检验辛条件 $J^{T}\\Omega J = \\Omega$。用分块矩阵形式表示，我们有：\n$$\nJ^T = \\begin{pmatrix} A^T  (SA)^T \\\\ 0  (A^{-T})^T \\end{pmatrix} = \\begin{pmatrix} A^T  A^T S^T \\\\ 0  A^{-1} \\end{pmatrix}\n$$\n因为 $S$ 是对称的（$S^T = S$），这可以简化为：\n$$\nJ^T = \\begin{pmatrix} A^T  A^T S \\\\ 0  A^{-1} \\end{pmatrix}\n$$\n现在，我们进行乘法运算 $J^T \\Omega J$：\n$$\nJ^T \\Omega J = \\begin{pmatrix} A^T  A^T S \\\\ 0  A^{-1} \\end{pmatrix} \\begin{pmatrix} 0  I_2 \\\\ -I_2  0 \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ SA  A^{-T} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} A^T(0) + A^T S(-I_2)  A^T(I_2) + A^T S(0) \\\\ 0(0) + A^{-1}(-I_2)  0(I_2) + A^{-1}(0) \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ SA  A^{-T} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -A^T S  A^T \\\\ -A^{-1}  0 \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ SA  A^{-T} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} (-A^T S)A + A^T(SA)  (-A^T S)(0) + A^T(A^{-T}) \\\\ (-A^{-1})A + 0(SA)  (-A^{-1})(0) + 0(A^{-T}) \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -A^T S A + A^T S A  A^T(A^T)^{-1} \\\\ -A^{-1}A  0 \\end{pmatrix} = \\begin{pmatrix} 0  I_2 \\\\ -I_2  0 \\end{pmatrix} = \\Omega\n$$\n这个符号验证证实了任何具有对称矩阵 $S$ 的这种形式的变换都是辛变换。\n\n为了完整起见，我们用显式的数值矩阵进行检验。\n$$\nJ = \\begin{pmatrix} 1  2  0  0 \\\\ 0  1  0  0 \\\\ 3  7  1  0 \\\\ 1  4  -2  1 \\end{pmatrix}, \\quad \\Omega = \\begin{pmatrix} 0  0  1  0 \\\\ 0  0  0  1 \\\\ -1  0  0  0 \\\\ 0  -1  0  0 \\end{pmatrix}\n$$\n$$\nJ^T = \\begin{pmatrix} 1  0  3  1 \\\\ 2  1  7  4 \\\\ 0  0  1  -2 \\\\ 0  0  0  1 \\end{pmatrix}\n$$\n首先，计算 $J^T \\Omega$：\n$$\nJ^T \\Omega = \\begin{pmatrix} 1  0  3  1 \\\\ 2  1  7  4 \\\\ 0  0  1  -2 \\\\ 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 0  0  1  0 \\\\ 0  0  0  1 \\\\ -1  0  0  0 \\\\ 0  -1  0  0 \\end{pmatrix} = \\begin{pmatrix} -3  -1  1  0 \\\\ -7  -4  2  1 \\\\ -1  2  0  0 \\\\ 0  -1  0  0 \\end{pmatrix}\n$$\n最后，计算 $(J^T \\Omega) J$：\n$$\n(J^T \\Omega) J = \\begin{pmatrix} -3  -1  1  0 \\\\ -7  -4  2  1 \\\\ -1  2  0  0 \\\\ 0  -1  0  0 \\end{pmatrix} \\begin{pmatrix} 1  2  0  0 \\\\ 0  1  0  0 \\\\ 3  7  1  0 \\\\ 1  4  -2  1 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -3+0+3+0  -6-1+7+0  0+0+1+0  0+0+0+0 \\\\ -7+0+6+1  -14-4+14+4  0+0+2-2  0+0+0+1 \\\\ -1+0+0+0  -2+2+0+0  0+0+0+0  0+0+0+0 \\\\ 0+0+0+0  0-1+0+0  0+0+0+0  0+0+0+0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0  0  1  0 \\\\ 0  0  0  1 \\\\ -1  0  0  0 \\\\ 0  -1  0  0 \\end{pmatrix} = \\Omega\n$$\n条件得到满足，证实该变换是辛变换。最终答案是雅可比矩阵 $J$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2  0  0 \\\\\n0  1  0  0 \\\\\n3  7  1  0 \\\\\n1  4  -2  1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}