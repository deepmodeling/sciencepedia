{
    "hands_on_practices": [
        {
            "introduction": "The essence of an implicit Hamiltonian system lies in the fact that the equations of motion may not be solvable for the velocity at all points in phase space. This exercise provides a foundational look at this issue by considering a simple presymplectic manifold where the dynamics equation $i_{\\dot{x}}\\omega = dH$ is not always invertible . By working through this problem, you will derive the solvability condition that gives rise to a primary constraint, gaining a direct insight into the algebraic origins of constrained dynamics.",
            "id": "3747502",
            "problem": "Consider a smooth manifold $\\mathbb{R}^{3}$ with global coordinates $(q,p,s)$ and the differential $2$-form $\\omega = dq \\wedge dp$ of constant rank on $\\mathbb{R}^{3}$. Let $H \\colon \\mathbb{R}^{3} \\to \\mathbb{R}$ be a smooth Hamiltonian. The implicit Hamiltonian dynamics is defined by the requirement that a curve $x(t) = (q(t),p(t),s(t))$ satisfies $i_{\\dot{x}(t)}\\omega = dH(x(t))$, where $i_{\\dot{x}(t)}$ denotes interior contraction with the velocity vector $\\dot{x}(t)$.\n\nUsing only the definitions of interior contraction and the kernel of a bilinear form, perform the following:\n\n- Compute the pointwise kernel $\\ker\\omega(x) = \\{ v \\in T_{x}\\mathbb{R}^{3} \\mid i_{v}\\omega(x) = 0 \\}$ at an arbitrary point $x \\in \\mathbb{R}^{3}$.\n- Starting from the linear map $b_{\\omega}(x) \\colon T_{x}\\mathbb{R}^{3} \\to T^{*}_{x}\\mathbb{R}^{3}$ defined by $b_{\\omega}(x)(v) = i_{v}\\omega(x)$, derive a necessary and sufficient solvability condition for the implicit Hamiltonian system $i_{\\dot{x}}\\omega = dH$ in terms of the cotangent vector $dH(x)$ and the kernel subspace $\\ker\\omega(x)$. Explain how a nontrivial $\\ker\\omega(x)$ induces constraints on the dynamics and clarifies the nonuniqueness of $\\dot{x}$.\n- For the specific Hamiltonian\n$$\nH(q,p,s) = \\frac{1}{2}p^{2} + V(q) + s\\,q\\,p,\n$$\nwith $V \\colon \\mathbb{R} \\to \\mathbb{R}$ a smooth potential depending only on $q$, define the primary constraint function $C(q,p,s)$ as the obstruction to solvability given by evaluating $dH$ on a generator $Z$ of $\\ker\\omega(x)$. Compute the closed-form expression for $C(q,p,s)$.\n\nYour final answer must be the explicit closed-form expression for $C(q,p,s)$. No numerical approximation is required.",
            "solution": "The problem will be addressed by sequentially completing the three tasks outlined. The validation step confirms the problem is well-posed and scientifically sound within the framework of geometric mechanics.\n\nFirst, we compute the pointwise kernel $\\ker\\omega(x)$ of the $2$-form $\\omega = dq \\wedge dp$ on $\\mathbb{R}^{3}$. The tangent space at any point $x=(q,p,s) \\in \\mathbb{R}^{3}$ is $T_{x}\\mathbb{R}^{3}$, which has a natural basis of coordinate vector fields $\\{\\frac{\\partial}{\\partial q}, \\frac{\\partial}{\\partial p}, \\frac{\\partial}{\\partial s}\\}$. An arbitrary tangent vector $v \\in T_{x}\\mathbb{R}^{3}$ can be expressed in this basis as $v = v^q \\frac{\\partial}{\\partial q} + v^p \\frac{\\partial}{\\partial p} + v^s \\frac{\\partial}{\\partial s}$ for some real coefficients $(v^q, v^p, v^s)$.\n\nBy definition, the kernel of the bilinear form $\\omega(x)$ at a point $x$ is the set of vectors $v \\in T_{x}\\mathbb{R}^{3}$ such that the interior product $i_{v}\\omega(x)$ is the zero $1$-form. This is equivalent to the condition that $\\omega(x)(v, w) = 0$ for all vectors $w \\in T_{x}\\mathbb{R}^{3}$.\n\nLet's evaluate $\\omega(v,w)$ for an arbitrary test vector $w = w^q \\frac{\\partial}{\\partial q} + w^p \\frac{\\partial}{\\partial p} + w^s \\frac{\\partial}{\\partial s}$. Using the definition of the wedge product and the action of a differential $1$-form $dx^i$ on a coordinate vector field $\\frac{\\partial}{\\partial x^j}$, where $dx^i(\\frac{\\partial}{\\partial x^j}) = \\delta^i_j$:\n$$\n\\omega(v,w) = (dq \\wedge dp)(v,w) = dq(v)dp(w) - dp(v)dq(w)\n$$\nThe components of the $1$-forms evaluated on the vectors are:\n$dq(v) = v^q$, $dp(v) = v^p$.\n$dq(w) = w^q$, $dp(w) = w^p$.\nSubstituting these into the expression for $\\omega(v,w)$ gives:\n$$\n\\omega(v,w) = v^q w^p - v^p w^q\n$$\nFor $v$ to be in $\\ker\\omega(x)$, this expression must be zero for all possible choices of $w \\in T_x\\mathbb{R}^3$, which means for any choice of components $(w^q, w^p, w^s)$.\nIf we choose $w = \\frac{\\partial}{\\partial q}$, its components are $(w^q, w^p, w^s) = (1, 0, 0)$. The condition becomes:\n$$\nv^q (0) - v^p (1) = -v^p = 0\n$$\nThus, we must have $v^p = 0$.\nIf we choose $w = \\frac{\\partial}{\\partial p}$, its components are $(w^q, w^p, w^s) = (0, 1, 0)$. The condition becomes:\n$$\nv^q (1) - v^p (0) = v^q = 0\n$$\nThus, we must have $v^q = 0$.\nThe component $v^s$ does not appear in the equation $v^q w^p - v^p w^q = 0$, so it remains unconstrained. Therefore, any vector $v \\in \\ker\\omega(x)$ must be of the form $v = 0 \\cdot \\frac{\\partial}{\\partial q} + 0 \\cdot \\frac{\\partial}{\\partial p} + v^s \\cdot \\frac{\\partial}{\\partial s} = v^s \\frac{\\partial}{\\partial s}$ for any $v^s \\in \\mathbb{R}$. This means the kernel is a one-dimensional subspace spanned by the vector field $\\frac{\\partial}{\\partial s}$.\n$$\n\\ker\\omega(x) = \\mathrm{span}\\left\\{\\frac{\\partial}{\\partial s}\\right\\}\n$$\nThis result is independent of the point $x$.\n\nSecond, we derive the solvability condition for the implicit Hamiltonian system $i_{\\dot{x}}\\omega = dH$. This equation represents a linear algebraic problem for the unknown velocity vector $\\dot{x} \\in T_x\\mathbb{R}^3$. Let's introduce the linear map $b_{\\omega}(x) \\colon T_{x}\\mathbb{R}^{3} \\to T^{*}_{x}\\mathbb{R}^{3}$ defined by $v \\mapsto i_v\\omega(x)$. The dynamics equation is then cast as:\n$$\nb_{\\omega}(x)(\\dot{x}) = dH(x)\n$$\nFrom linear algebra, this equation for $\\dot{x}$ has a solution if and only if the vector $dH(x)$ on the right-hand side lies in the image (or range) of the linear map $b_{\\omega}(x)$. The image of $b_{\\omega}(x)$ is the set of all $1$-forms $\\alpha \\in T_x^*\\mathbb{R}^3$ for which there exists a vector $v \\in T_x\\mathbb{R}^3$ such that $\\alpha = i_v\\omega$.\n\nThe image of $b_{\\omega}(x)$ is related to the kernel of $\\omega(x)$. Specifically, the image of $b_{\\omega}(x)$ is the annihilator of the kernel of $\\omega(x)$, denoted $(\\ker\\omega(x))^\\circ$. The annihilator of a subspace $W \\subseteq V$ is the subspace $W^\\circ \\subseteq V^*$ consisting of all covectors that vanish on every vector in $W$. That is, $\\alpha \\in W^\\circ$ if and only if $\\alpha(w) = 0$ for all $w \\in W$.\n\nThus, a necessary and sufficient condition for the existence of a solution $\\dot{x}$ is that $dH(x)$ must belong to the annihilator of $\\ker\\omega(x)$. This means that the $1$-form $dH(x)$ must evaluate to zero on every vector in $\\ker\\omega(x)$. If $Z$ is any vector in $\\ker\\omega(x)$, the condition is:\n$$\ndH(x)(Z) = 0\n$$\nThis is the required solvability condition. It acts as a constraint on the points $x=(q,p,s)$ of the phase space where the dynamics can occur. The set of points satisfying this condition forms a submanifold called the primary constraint surface.\n\nIf this condition is met, a solution $\\dot{x}_0$ exists. However, it is not unique. If $\\dot{x}_0$ is a solution, then for any vector $Z \\in \\ker\\omega(x)$, the vector $\\dot{x} = \\dot{x}_0 + Z$ is also a solution, because:\n$$\ni_{\\dot{x}_0 + Z}\\omega = i_{\\dot{x}_0}\\omega + i_Z\\omega = dH(x) + 0 = dH(x)\n$$\nThe non-triviality of $\\ker\\omega(x)$ thus leads to both a constraint on the allowable states and a non-uniqueness in the time evolution of the system. The velocity vector component in the direction of the kernel generators (here, $\\frac{\\partial}{\\partial s}$) is left undetermined by the equations of motion.\n\nThird, we compute the primary constraint function $C(q,p,s)$ for the specific Hamiltonian $H(q,p,s) = \\frac{1}{2}p^{2} + V(q) + s\\,q\\,p$. The constraint function is the obstruction to solvability, obtained by evaluating $dH$ on a generator of $\\ker\\omega(x)$.\nFirst, we compute the exterior derivative $dH$:\n$$\ndH = \\frac{\\partial H}{\\partial q} dq + \\frac{\\partial H}{\\partial p} dp + \\frac{\\partial H}{\\partial s} ds\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial H}{\\partial q} = \\frac{dV}{dq} + sp\n$$\n$$\n\\frac{\\partial H}{\\partial p} = p + sq\n$$\n$$\n\\frac{\\partial H}{\\partial s} = qp\n$$\nSo, the $1$-form $dH$ is:\n$$\ndH(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right) dq + (p + sq) dp + (qp) ds\n$$\nFrom our previous analysis, a generator for $\\ker\\omega(x)$ is the vector field $Z = \\frac{\\partial}{\\partial s}$. The primary constraint function $C(q,p,s)$ is defined as the evaluation of $dH$ on $Z$.\n$$\nC(q,p,s) = dH(Z) = \\left\\langle dH, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\nUsing the pairing $\\langle dx^i, \\frac{\\partial}{\\partial x^j} \\rangle = \\delta^i_j$, we find:\n$$\nC(q,p,s) = \\left\\langle \\left(\\frac{dV}{dq} + sp\\right) dq + (p + sq) dp + (qp) ds, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\n$$\nC(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right) \\left\\langle dq, \\frac{\\partial}{\\partial s} \\right\\rangle + (p + sq) \\left\\langle dp, \\frac{\\partial}{\\partial s} \\right\\rangle + (qp) \\left\\langle ds, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\n$$\nC(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right)(0) + (p + sq)(0) + (qp)(1)\n$$\n$$\nC(q,p,s) = qp\n$$\nThe solvability condition $C(q,p,s)=0$ confines the dynamics to the surface in $\\mathbb{R}^3$ defined by the equation $qp=0$.",
            "answer": "$$\\boxed{qp}$$"
        },
        {
            "introduction": "Singular Lagrangians, which lead to a non-invertible Legendre transform, are a common origin for implicit Hamiltonian systems. This exercise guides you through the complete modern analysis of such a system, starting from the Hamilton-Pontryagin principle to derive the initial constraints . You will then apply the powerful Gotay–Nester algorithm to systematically uncover all consistency conditions and determine the final submanifold where consistent dynamics can unfold.",
            "id": "3747517",
            "problem": "Consider the configuration manifold $Q=\\mathbb{R}$ and the Lagrangian $L:TQ\\to\\mathbb{R}$ defined by $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$. \n\n1. Starting from the definition of the Legendre transform (also called the fiber derivative) $\\mathbb{F}L:TQ\\to T^{*}Q$ given by $\\mathbb{F}L(q,v)=(q,p)$ with $p=\\frac{\\partial L}{\\partial v}(q,v)$, explain why the Legendre transform is noninvertible for this $L$.\n\n2. Using the Hamilton–Pontryagin (HP) variational principle with action functional $S(q,v,p)=\\int_{t_{0}}^{t_{1}}\\left(L(q,v)+p(\\dot{q}-v)\\right)\\,dt$, derive the implicit Euler–Lagrange–Pontryagin equations. Identify the primary constraint submanifold $\\mathcal{C}_{0}\\subset TQ\\oplus T^{*}Q$ and the generalized energy $E:TQ\\oplus T^{*}Q\\to\\mathbb{R}$.\n\n3. Apply the Gotay–Nester (GN) constraint algorithm for presymplectic systems to this HP formulation. Use the canonical two-form $\\omega=dq\\wedge dp$ on $T^{*}Q$ and its pullback to the constraint submanifolds to enforce the compatibility condition $i_{X}\\omega=dH$ restricted to constraints, where $H$ is the reduced Hamiltonian obtained from $E$ on $\\mathcal{C}_{0}$. Determine the secondary constraint(s) and show whether the algorithm terminates. Identify the final constraint submanifold $\\mathcal{C}_{\\infty}$ and the reduced Hamiltonian vector field $X$ on it.\n\nYour final answer must be the unique admissible pair $(q,p)\\in T^{*}Q$ selected by the GN algorithm for this example. Express this pair as a row matrix using the $\\mathrm{pmatrix}$ environment. No units are required. If more than one admissible pair exists, select the one that is dynamically consistent and has minimal Euclidean norm in $\\mathbb{R}^{2}$, and report that pair. No rounding is needed.",
            "solution": "The problem asks for a complete analysis of a system described by a singular Lagrangian, using the Hamilton-Pontryagin principle and the Gotay-Nester constraint algorithm. We will validate the problem and then proceed through the three parts as requested.\n\nThe problem statement is scientifically grounded in the principles of geometric mechanics, specifically the theory of constrained Hamiltonian systems. The Lagrangian $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$ on the configuration manifold $Q=\\mathbb{R}$ is a well-defined mathematical object. The tasks involve standard, albeit advanced, procedures for analyzing such systems, namely the Hamilton-Pontryagin variational principle and the Gotay-Nester (GN) algorithm. The problem is self-contained, well-posed, and all terms are clearly defined. Therefore, the problem is valid and we may proceed with the solution.\n\n### Part 1: Noninvertibility of the Legendre Transform\n\nThe Legendre transform (or fiber derivative) $\\mathbb{F}L: TQ \\to T^*Q$ maps a point $(q, v) \\in TQ$ to a point $(q, p) \\in T^*Q$, where the momentum $p$ is defined as $p = \\frac{\\partial L}{\\partial v}$.\n\nFor the given Lagrangian, $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$, the momentum is:\n$$\np = \\frac{\\partial L}{\\partial v}(q,v) = \\frac{\\partial}{\\partial v}\\left(\\sin(q)\\,v-\\frac{1}{2}q^{2}\\right) = \\sin(q)\n$$\nThe Legendre transform is therefore the map $\\mathbb{F}L(q,v) = (q, \\sin(q))$.\n\nTo be invertible, the map $\\mathbb{F}L$ must be a bijection; that is, for every $(q, p) \\in T^*Q$, there must exist a unique $(q, v) \\in TQ$ that maps to it. This requires solving for $v$ in terms of $q$ and $p$. The equation $p = \\sin(q)$ is independent of $v$, making it impossible to determine a unique $v$ for a given $(q,p)$.\n\nMore formally, the noninvertibility can be demonstrated in two ways:\n1.  The map is not surjective (onto). The image of $\\mathbb{F}L$ is the set of points $\\{(q,p) \\in T^*Q \\mid p = \\sin(q)\\}$. This is a one-dimensional submanifold of the two-dimensional cotangent bundle $T^*Q \\cong \\mathbb{R}^2$. Any point $(q,p)$ not on this submanifold (i.e., where $p \\neq \\sin(q)$) has no preimage in $TQ$.\n2.  The map is not injective (one-to-one). For any point $(q,p)$ in the image of $\\mathbb{F}L$, the preimage is not a single point. For a fixed $q_0$, all points $(q_0, v)$ for any $v \\in \\mathbb{R}$ are mapped to the same point $(q_0, \\sin(q_0))$.\n\nA systematic way to check for the local invertibility of the Legendre transform is to compute the fiber Hessian matrix, whose components are $W_{ij} = \\frac{\\partial^2 L}{\\partial v^i \\partial v^j}$. The transform is locally invertible if and only if this matrix is non-singular. In our one-dimensional case ($v$ is a scalar), this reduces to a single component:\n$$\nW = \\frac{\\partial^2 L}{\\partial v^2} = \\frac{\\partial}{\\partial v}\\left(\\frac{\\partial L}{\\partial v}\\right) = \\frac{\\partial}{\\partial v}(\\sin(q)) = 0\n$$\nSince the Hessian is identically zero (which is singular), the Legendre transform is noninvertible. Such a Lagrangian is termed singular.\n\n### Part 2: Hamilton–Pontryagin Variational Principle\n\nThe Hamilton–Pontryagin (HP) action functional is given on the extended space $TQ \\oplus T^*Q$ with coordinates $(q,v,p)$. The action is:\n$$\nS(q,v,p) = \\int_{t_{0}}^{t_{1}} \\left( L(q,v) + p(\\dot{q}-v) \\right) \\,dt = \\int_{t_{0}}^{t_{1}} \\left( \\sin(q)v - \\frac{1}{2}q^2 + p\\dot{q} - pv \\right) \\,dt\n$$\nWe find the equations of motion by taking variations of $S$ with respect to $q$, $v$, and $p$, and setting $\\delta S = 0$.\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\left( \\frac{\\partial L}{\\partial q}\\delta q + \\frac{\\partial L}{\\partial v}\\delta v + \\delta p(\\dot{q}-v) + p(\\delta\\dot{q} - \\delta v) \\right) \\,dt\n$$\nIntegrating the $p\\delta\\dot{q}$ term by parts, $\\int p\\delta\\dot{q}\\,dt = [p\\delta q]_{t_0}^{t_1} - \\int \\dot{p}\\delta q\\,dt$, where the boundary term vanishes since $\\delta q(t_0)=\\delta q(t_1)=0$. Substituting $\\frac{\\partial L}{\\partial q} = \\cos(q)v - q$ and $\\frac{\\partial L}{\\partial v} = \\sin(q)$:\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\left( (\\cos(q)v - q - \\dot{p})\\delta q + (\\sin(q)-p)\\delta v + (\\dot{q}-v)\\delta p \\right) \\,dt = 0\n$$\nSince the variations $\\delta q$, $\\delta v$, and $\\delta p$ are independent, their coefficients must vanish. This yields the Euler-Lagrange-Pontryagin equations:\n1.  $\\delta q: \\quad \\dot{p} = \\cos(q)v - q$\n2.  $\\delta v: \\quad p = \\sin(q)$\n3.  $\\delta p: \\quad \\dot{q} = v$\n\nThe **primary constraint submanifold** $\\mathcal{C}_0$ is the subset of $TQ \\oplus T^*Q$ on which the algebraic (non-differential) equations from the variational principle must hold. This is given by equation (2).\n$$\n\\mathcal{C}_{0} = \\{ (q,v,p) \\in TQ \\oplus T^*Q \\mid p - \\sin(q) = 0 \\}\n$$\nThe **generalized energy** $E: TQ \\oplus T^*Q \\to \\mathbb{R}$ is defined as $E = pv - L(q,v)$:\n$$\nE(q,v,p) = pv - \\left(\\sin(q)v - \\frac{1}{2}q^2\\right) = (p - \\sin(q))v + \\frac{1}{2}q^2\n$$\n\n### Part 3: Gotay–Nester Constraint Algorithm\n\nThe GN algorithm is applied to the presymplectic system that arises from this formulation. As suggested by the problem, we will work on the cotangent bundle $T^*Q$ with coordinates $(q,p)$ and its canonical symplectic form $\\omega = dq \\wedge dp$.\n\nThe primary constraint manifold is the image of the Legendre transform, a submanifold of $T^*Q$:\n$$\nM_1 = \\{ (q,p) \\in T^*Q \\mid \\phi_1(q,p) := p - \\sin(q) = 0 \\}\n$$\nThe reduced Hamiltonian $H$ on $M_1$ is obtained by restricting the generalized energy $E$ to the constraint manifold $\\mathcal{C}_0$. On $\\mathcal{C}_0$, where $p=\\sin(q)$, we have:\n$$\nH = E|_{\\mathcal{C}_0} = (p-\\sin(q))v + \\frac{1}{2}q^2 \\Big|_{p=\\sin(q)} = (0)v + \\frac{1}{2}q^2 = \\frac{1}{2}q^2\n$$\nWe can consider $H(q,p) = \\frac{1}{2}q^2$ as a function on the ambient space $T^*Q$. The algorithm seeks a vector field $X$ that is tangent to $M_1$ and satisfies the presymplectic Hamilton's equation $i_X \\omega = dH$ on $M_1$.\n\nFirst, we solve for a candidate vector field $X$ on $T^*Q$ from the equation $i_X \\omega = dH$.\nThe differential of the Hamiltonian is $dH = d(\\frac{1}{2}q^2) = q\\,dq$.\nLet $X = A(q,p)\\frac{\\partial}{\\partial q} + B(q,p)\\frac{\\partial}{\\partial p}$. The interior product is:\n$$\ni_X \\omega = i_{A\\partial_q + B\\partial_p}(dq \\wedge dp) = A\\,dp - B\\,dq\n$$\nEquating this with $dH$:\n$$\nA\\,dp - B\\,dq = q\\,dq\n$$\nBy comparing the coefficients of the basis 1-forms $dq$ and $dp$, we find $A=0$ and $B=-q$. Thus, the candidate Hamiltonian vector field is:\n$$\nX = -q \\frac{\\partial}{\\partial p}\n$$\nNext, we check if $X$ is tangent to the constraint manifold $M_1$. The tangency condition is $X[\\phi_1] = 0$ for all points on $M_1$.\n$$\nX[\\phi_1] = \\left(-q \\frac{\\partial}{\\partial p}\\right)[p - \\sin(q)] = -q \\cdot (1 - 0) = -q\n$$\nFor $X$ to be tangent to $M_1$, we must have $X[\\phi_1] = 0$, which implies $-q = 0$. This is a new condition that must be satisfied for the dynamics to be consistent. This gives rise to a **secondary constraint**, $\\phi_2(q,p) := q = 0$.\n\nThe algorithm proceeds to a new, smaller constraint submanifold $M_2$, which is the intersection of $M_1$ and the surface defined by the new constraint:\n$$\nM_2 = \\{ (q,p) \\in M_1 \\mid q=0 \\} = \\{ (q,p) \\in T^*Q \\mid p - \\sin(q) = 0 \\text{ and } q=0 \\}\n$$\nSubstituting $q=0$ into the first constraint gives $p - \\sin(0) = 0 \\implies p = 0$. Therefore, the second-stage constraint submanifold consists of a single point:\n$$\nM_2 = \\{ (0,0) \\}\n$$\nThe algorithm now must be checked on $M_2$. We need to find a vector field tangent to $M_2$ that satisfies the Hamilton's equation on $M_2$. At the point $(0,0)$, the Hamiltonian is $H=\\frac{1}{2}(0)^2=0$ and its differential is $dH = q\\,dq|_{(0,0)} = 0$. The equation is $i_X \\omega = 0$. Since $\\omega$ is non-degenerate on $T^*Q$, the only solution is $X=0$.\nThe zero vector field is trivially tangent to any submanifold, including the point manifold $M_2$. The tangency condition $X[\\phi_1]=-q$ becomes $0 = 0$ on $M_2$, and $X[\\phi_2]=0$ is also satisfied.\nSince a consistent vector field ($X=0$) exists and is tangent to the submanifold $M_2$, the **algorithm terminates**.\n\nThe final constraint submanifold is $\\mathcal{C}_{\\infty} = M_2 = \\{(0,0)\\}$.\nThe reduced Hamiltonian vector field on $\\mathcal{C}_{\\infty}$ is $X=0$. This implies that the point $(0,0)$ is a fixed point of the system's dynamics.\nThe GN algorithm has selected a unique admissible state (a stationary point) for the system. This point is the pair $(q,p) = (0,0)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "When constraints are imposed on a Hamiltonian system, the dynamics is restricted to a submanifold of the phase space, which inherits a geometric structure from the ambient symplectic space. This induced structure is typically presymplectic, meaning it possesses a degenerate direction, or kernel . This practice challenges you to compute this kernel for a holonomically constrained system and describe the resulting geometric foliation, providing crucial insight into the structure of the reduced phase space.",
            "id": "3747487",
            "problem": "Let $Q$ be a smooth $n$-dimensional manifold and let $\\pi:T^{*}Q\\to Q$ be the cotangent bundle projection. Consider a holonomic constraint submanifold $C\\subset T^{*}Q$ defined as the zero level of a smooth map $\\phi:T^{*}Q\\to \\mathbb{R}^{r}$ that depends only on the base point, i.e., there exists a smooth submersion $h:Q\\to \\mathbb{R}^{r}$ such that $\\phi=h\\circ\\pi$ and $C=\\{(q,p)\\in T^{*}Q\\mid h(q)=0\\}$. Let $\\theta$ denote the tautological (Liouville) one-form on $T^{*}Q$, defined by $\\theta_{(q,p)}(V)=p\\big(\\pi_{*}V\\big)$ for every $V\\in T_{(q,p)}(T^{*}Q)$, and let $\\omega=-\\mathrm{d}\\theta$ be the canonical symplectic two-form on $T^{*}Q$. Denote by $\\iota_{C}:C\\hookrightarrow T^{*}Q$ the inclusion map and set $\\omega_{C}=\\iota_{C}^{*}\\omega$, the pullback two-form on the constraint manifold $C$.\n\nStarting from the definitions above, derive an explicit expression for the pullback two-form $\\omega_{C}$ in local coordinates and characterize the characteristic distribution (the kernel) of $\\omega_{C}$ at a point $(q,p)\\in C$ in terms of the derivatives of the constraints. Then use this characterization to describe the presymplectic leaves of the presymplectic manifold $(C,\\omega_{C})$ as maximal integral manifolds of the characteristic distribution.\n\nExpress your final answer as a single closed-form analytical expression for the characteristic distribution $\\ker\\omega_{C}(q,p)\\subset T_{(q,p)}C$ in terms of $h$ at $q$. No numerical approximation is required.",
            "solution": "The problem is valid as it is a standard, well-posed question in geometric mechanics, grounded in the established principles of differential geometry and symplectic methods. All terms are formally defined, and the setup is self-contained and consistent.\n\nWe begin by establishing a local coordinate representation. Let $(q^{1}, \\dots, q^{n})$ be local coordinates on an open set of the manifold $Q$. These induce canonical local coordinates $(q^{1}, \\dots, q^{n}, p_{1}, \\dots, p_{n})$ on the cotangent bundle $T^{*}Q$. In these coordinates, the tautological one-form $\\theta$ is given by the expression $\\theta = \\sum_{i=1}^{n} p_{i} \\mathrm{d}q^{i}$. The canonical symplectic two-form $\\omega$ is then $\\omega = -\\mathrm{d}\\theta = -\\mathrm{d}(\\sum_{i=1}^{n} p_{i} \\mathrm{d}q^{i}) = -\\sum_{i=1}^{n} \\mathrm{d}p_{i} \\wedge \\mathrm{d}q^{i} = \\sum_{i=1}^{n} \\mathrm{d}q^{i} \\wedge \\mathrm{d}p_{i}$.\n\nThe constraint submanifold $C \\subset T^{*}Q$ is defined as the zero level set of $\\phi = h \\circ \\pi$, where $h: Q \\to \\mathbb{R}^{r}$ is a smooth submersion. In local coordinates, the components of $h$ are $h^{a}(q^{1}, \\dots, q^{n})$ for $a=1, \\dots, r$. The manifold $C$ is thus the set of points $(q, p) \\in T^{*}Q$ satisfying the $r$ equations $h^{a}(q) = 0$.\n\nThe tangent space to $C$ at a point $(q,p) \\in C$, denoted $T_{(q,p)}C$, consists of all vectors $V \\in T_{(q,p)}(T^{*}Q)$ that are tangent to the constraint surface. A vector $V$ can be written in local coordinates as $V = \\sum_{i=1}^{n} (v^{i} \\frac{\\partial}{\\partial q^{i}} + w_{i} \\frac{\\partial}{\\partial p_{i}})$. The condition for $V$ to be in $T_{(q,p)}C$ is that it must be annihilated by the differentials of the constraint functions $\\phi^{a}(q,p) = h^{a}(q)$. The differential is $\\mathrm{d}\\phi^{a} = \\sum_{i=1}^{n} \\frac{\\partial h^{a}}{\\partial q^{i}} \\mathrm{d}q^{i}$. Thus, $V \\in T_{(q,p)}C$ if and only if:\n$$\n\\mathrm{d}\\phi^{a}(V) = \\left( \\sum_{i=1}^{n} \\frac{\\partial h^{a}}{\\partial q^{i}} \\mathrm{d}q^{i} \\right) \\left( \\sum_{j=1}^{n} v^{j} \\frac{\\partial}{\\partial q^{j}} + w_{j} \\frac{\\partial}{\\partial p_{j}} \\right) = \\sum_{i=1}^{n} \\frac{\\partial h^{a}}{\\partial q^{i}}(q) v^{i} = 0\n$$\nfor all $a \\in \\{1, \\dots, r\\}$. This condition constrains only the \"horizontal\" components $v^{i}$ of the tangent vector, while the \"vertical\" components $w_{i}$ are unconstrained.\n\nThe pullback two-form $\\omega_{C} = \\iota_{C}^{*}\\omega$ is defined by its action on tangent vectors $X, Y \\in T_{(q,p)}C$. Since $\\iota_{C}$ is the inclusion map, its pushforward $\\iota_{C*}$ is also an inclusion. Thus, for $X, Y \\in T_{(q,p)}C$, we have $\\omega_{C}(X, Y) = \\omega(\\iota_{C*}X, \\iota_{C*}Y) = \\omega(X, Y)$. In local coordinates, if $X = X^{i} \\frac{\\partial}{\\partial q^{i}} + X_{i} \\frac{\\partial}{\\partial p_{i}}$ and $Y = Y^{i} \\frac{\\partial}{\\partial q^{i}} + Y_{i} \\frac{\\partial}{\\partial p_{i}}$, the expression for $\\omega_{C}$ is:\n$$\n\\omega_{C}(X, Y) = \\omega(X, Y) = \\sum_{i=1}^{n} (\\mathrm{d}q^{i} \\wedge \\mathrm{d}p_{i})(X, Y) = \\sum_{i=1}^{n} (X^{i}Y_{i} - Y^{i}X_{i})\n$$\nwhere the components of $X$ and $Y$ must satisfy the tangency condition derived above.\n\nNext, we characterize the characteristic distribution (or kernel) of $\\omega_{C}$. The kernel of $\\omega_{C}$ at $(q,p) \\in C$, denoted $\\ker\\omega_{C}(q,p)$, is the set of vectors $X \\in T_{(q,p)}C$ such that $\\omega_{C}(X, Y) = 0$ for all $Y \\in T_{(q,p)}C$. This is equivalent to finding $X \\in T_{(q,p)}C$ such that $\\omega(X, Y) = 0$ for all $Y \\in T_{(q,p)}C$. This means $\\ker\\omega_{C}(q,p) = T_{(q,p)}C \\cap (T_{(q,p)}C)^{\\omega}$, where $(T_{(q,p)}C)^{\\omega}$ is the symplectic orthogonal complement of $T_{(q,p)}C$.\n\nLet us consider the Hamiltonian vector fields $X_{\\phi^{a}}$ associated with the constraint functions $\\phi^{a}$. They are defined by the relation $\\iota_{X_{\\phi^{a}}}\\omega = \\mathrm{d}\\phi^{a}$. We have $\\mathrm{d}\\phi^a = \\sum_{i=1}^n \\frac{\\partial h^a}{\\partial q^i} \\mathrm{d}q^i$. Let $X_{\\phi^a}$ have components $(v^i, w_i)$. Then $\\iota_{X_{\\phi^a}}\\omega = \\sum_{i=1}^n (v^i \\mathrm{d}p_i - w_i \\mathrm{d}q^i)$. Comparing this with $\\mathrm{d}\\phi^a$, we find $v^i = 0$ and $w_i = -\\frac{\\partial h^a}{\\partial q^i}$. Thus, the Hamiltonian vector field is purely vertical:\n$$\nX_{\\phi^{a}} = -\\sum_{i=1}^{n} \\frac{\\partial h^{a}}{\\partial q^{i}}(q) \\frac{\\partial}{\\partial p_{i}}\n$$\nThe tangent space $T_{(q,p)}C$ can be characterized as the symplectic orthogonal complement of the span of these Hamiltonian vector fields. A vector $Y \\in T_{(q,p)}(T^{*}Q)$ belongs to $T_{(q,p)}C$ if and only if $\\mathrm{d}\\phi^{a}(Y) = 0$ for all $a$. This condition can be rewritten as $\\omega(X_{\\phi^{a}}, Y) = 0$ for all $a$, which means $T_{(q,p)}C = (\\text{span}\\{X_{\\phi^{a}}\\})^{\\omega}$.\n\nUsing the property of symplectic complements that $(V^{\\omega})^{\\omega} = V$ for any vector subspace $V$, we find the symplectic orthogonal complement of $T_{(q,p)}C$:\n$$\n(T_{(q,p)}C)^{\\omega} = \\left((\\text{span}\\{X_{\\phi^{a}}\\})^{\\omega}\\right)^{\\omega} = \\text{span}\\{X_{\\phi^{a}}\\}\n$$\nThe characteristic distribution is therefore $\\ker\\omega_{C}(q,p) = T_{(q,p)}C \\cap \\text{span}\\{X_{\\phi^{a}}\\}$. We must check which vectors in $\\text{span}\\{X_{\\phi^{a}}\\}$ are tangent to $C$. A general vector $X = \\sum_{a=1}^{r} c_{a}X_{\\phi^{a}}$ (for some scalars $c_a$) is tangent to $C$ if $\\mathrm{d}\\phi^{b}(X) = 0$ for all $b=1, \\dots, r$. We calculate:\n$$\n\\mathrm{d}\\phi^{b}(X) = \\omega(X_{\\phi^{b}}, X) = \\omega(X_{\\phi^{b}}, \\sum_{a=1}^{r} c_{a}X_{\\phi^{a}}) = \\sum_{a=1}^{r} c_{a} \\omega(X_{\\phi^{b}}, X_{\\phi^{a}})\n$$\nThe term $\\omega(X_{\\phi^{b}}, X_{\\phi^{a}})$ is the Poisson bracket $\\{\\phi^{b}, \\phi^{a}\\}$. Since the constraints $\\phi^{a}(q,p) = h^{a}(q)$ depend only on the position coordinates $q$, their Poisson brackets are identically zero:\n$$\n\\{\\phi^{b}, \\phi^{a}\\} = \\sum_{i=1}^{n}\\left(\\frac{\\partial \\phi^{b}}{\\partial q^{i}}\\frac{\\partial \\phi^{a}}{\\partial p_{i}} - \\frac{\\partial \\phi^{b}}{\\partial p_{i}}\\frac{\\partial \\phi^{a}}{\\partial q^{i}}\\right) = \\sum_{i=1}^{n}\\left(\\frac{\\partial h^{b}}{\\partial q^{i}} \\cdot 0 - 0 \\cdot \\frac{\\partial h^{a}}{\\partial q^{i}}\\right) = 0\n$$\nSince $\\{\\phi^{b}, \\phi^{a}\\}=0$, the condition $\\mathrm{d}\\phi^{b}(X) = 0$ is satisfied for any choice of scalars $c_a$. This means that the entire space $\\text{span}\\{X_{\\phi^{a}}\\}$ is a subspace of $T_{(q,p)}C$. Therefore, the intersection is simply the space itself:\n$$\n\\ker\\omega_{C}(q,p) = \\text{span}\\{X_{\\phi^{a}}\\}_{a=1,\\dots,r}\n$$\nSubstituting the coordinate expression for $X_{\\phi^{a}}$ (and dropping the irrelevant sign as we are describing the span), we obtain the final characterization:\n$$\n\\ker\\omega_{C}(q,p) = \\text{span}\\left\\{ \\sum_{i=1}^{n} \\frac{\\partial h^{a}}{\\partial q^{i}}(q) \\frac{\\partial}{\\partial p_{i}} \\right\\}_{a=1,\\dots,r}\n$$\nSince $h$ is a submersion, the differentials $\\mathrm{d}h^{a}$ are linearly independent, which implies that the vectors spanning the kernel are also linearly independent. Thus, the dimension of the kernel is $r$.\n\nThe presymplectic leaves of $(C, \\omega_C)$ are the maximal integral manifolds of the characteristic distribution $\\ker\\omega_C$. Since $\\omega_C$ is closed (as $\\mathrm{d}\\omega_C = \\mathrm{d}\\iota_C^*\\omega = \\iota_C^*\\mathrm{d}\\omega = 0$), Frobenius' theorem guarantees this distribution is integrable.\nThe vector fields spanning $\\ker\\omega_C$ are purely vertical (no $\\partial/\\partial q^i$ components). This means that any integral curve of a vector field in $\\ker\\omega_C$ must have constant $q$ coordinates. Consequently, the integral manifolds (the leaves) are confined within the fibers of the projection $\\pi: C \\to Q$. For any point $q_0$ on the submanifold $M = h^{-1}(0) \\subset Q$, the fiber over it is $T_{q_0}^*Q$. The tangent space to a leaf at $(q_0, p) \\in C$ is the $r$-dimensional vector subspace of $T_{q_0}^*Q$ given by $\\ker\\omega_C(q_0,p)$. This subspace can be identified with $(T_{q_0}M)^0$, the annihilator of the tangent space to $M$ at $q_0$. Therefore, the presymplectic leaves are the affine subspaces of the fibers $T_{q_0}^*Q$ of the form $\\{q_0\\} \\times (p_0 + (T_{q_0}M)^0)$, each being an $r$-dimensional affine subspace of $T_{q_0}^*Q$.",
            "answer": "$$\\boxed{\\mathrm{span}\\left\\{ \\sum_{i=1}^{n} \\frac{\\partial h^{a}}{\\partial q^{i}}(q) \\frac{\\partial}{\\partial p_{i}} \\right\\}_{a=1,\\dots,r}}$$"
        }
    ]
}