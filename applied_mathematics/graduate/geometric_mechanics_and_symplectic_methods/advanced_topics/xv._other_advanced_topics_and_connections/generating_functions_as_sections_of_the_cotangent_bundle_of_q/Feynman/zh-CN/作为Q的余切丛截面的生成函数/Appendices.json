{
    "hands_on_practices": [
        {
            "introduction": "本练习是掌握第一类母函数 $S(q,Q)$ 如何生成辛变换（即典范变换）的基础。通过一个具体的二次型函数示例，你将实践从母函数的定义出发，推导出相空间中新旧坐标之间显式关系的全过程。这个计算将巩固你对混合黑塞矩阵可逆性重要性的理解，并让你亲手构建一个线性辛同胚。",
            "id": "3742786",
            "problem": "设 $Q$ 是一个光滑流形，与 $\\mathbb{R}^2$ 微分同胚，其全局坐标为 $q = (q_1,q_2)$。考虑其上的余切丛 $T^*Q$，其典范坐标为 $(q,p)$，其中 $p=(p_1,p_2)$ 是纤维坐标。余切丛 $T^*Q$ 上赋有典范1-形式 $\\theta = p_i \\, dq^i$ 和典范辛形式 $\\omega = d\\theta$。一个微分同胚 $\\Phi: T^*Q \\to T^*Q$ 如果保持 $\\omega$ 不变，则称为辛同胚。构造局部辛同胚的一种方法是通过母函数，即利用 $Q \\times Q$ 上的光滑函数 $S(q,Q)$ 来定义 $T^*Q \\times T^*Q$ 中关于辛形式 $\\pi_1^* \\omega - \\pi_2^* \\omega$ 的一个精确拉格朗日子流形，其中 $\\pi_1$ 和 $\\pi_2$ 分别是到第一和第二个因子的投影。\n\n仅从 $T^*Q$ 上 $\\theta$ 和 $\\omega$ 的典范定义出发，并利用辛同胚的图像是 $T^*Q \\times T^*Q$ 中关于 $\\pi_1^* \\omega - \\pi_2^* \\omega$ 的拉格朗日子流形这一特征，推导出一个光滑函数 $S(q,Q)$ 生成一个辛同胚 $\\Phi: (q,p) \\mapsto (Q,P)$ 的局部条件，并解释为什么混合Hessian矩阵 $\\frac{\\partial^2 S}{\\partial q \\, \\partial Q}$ 的可逆性保证了在某个邻域内 $(Q,P)$ 作为 $(q,p)$ 的函数是可解的。\n\n然后，对于给定的具体函数\n$$\nS(q,Q) = \\frac{1}{2} q^{\\top} A q + q^{\\top} B Q + \\frac{1}{2} Q^{\\top} C Q,\n$$\n其中\n$$\nA = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}, \n\\quad B = \\begin{pmatrix} 1  2 \\\\ 3  1 \\end{pmatrix}, \n\\quad C = \\begin{pmatrix} 4  0 \\\\ 0  5 \\end{pmatrix},\n$$\n验证混合Hessian矩阵 $\\frac{\\partial^2 S}{\\partial q \\partial Q}$ 在每一点都可逆，构造由 $S$ 生成的相应辛同胚 $\\Phi$，并显式地解出 $Q=(Q_1,Q_2)$ 和 $P=(P_1,P_2)$ 作为 $q=(q_1,q_2)$ 和 $p=(p_1,p_2)$ 的函数。\n\n你的最终答案必须是一个单一的解析表达式，以单个行矩阵的形式，给出四个分量 $Q_1, Q_2, P_1, P_2$ 关于 $q_1, q_2, p_1, p_2$ 的表达式。",
            "solution": "我们从余切丛 $T^*Q$ 开始，其上赋有典范1-形式 $\\theta = p_i \\, dq^i$ 和辛形式 $\\omega = d\\theta$。在积空间 $T^*Q \\times T^*Q$ 上，其坐标为 $(q,p; Q,P)$，考虑辛形式 $\\pi_1^* \\omega - \\pi_2^* \\omega$。一个微分同胚 $\\Phi: T^*Q \\to T^*Q$ 的图像，即集合\n$$\n\\Gamma_{\\Phi} = \\{ (q,p; Q,P) \\in T^*Q \\times T^*Q \\mid (Q,P) = \\Phi(q,p) \\},\n$$\n是关于 $\\pi_1^* \\omega - \\pi_2^* \\omega$ 的拉格朗日子流形，当且仅当 $\\Phi$ 是一个辛同胚。\n\n第一类母函数是一个光滑函数 $S: Q \\times Q \\to \\mathbb{R}$。它在 $Q \\times Q$ 上定义了一个1-形式，由 $dS = \\frac{\\partial S}{\\partial q_i} \\, dq^i + \\frac{\\partial S}{\\partial Q_i} \\, dQ^i$ 给出。考虑 $T^*Q \\times T^*Q$ 上的1-形式，\n$$\n\\beta = \\pi_1^* \\theta - \\pi_2^* \\theta - dS = p_i \\, dq^i - P_i \\, dQ^i - \\frac{\\partial S}{\\partial q_i} \\, dq^i - \\frac{\\partial S}{\\partial Q_i} \\, dQ^i.\n$$\n于是\n$$\nd\\beta = \\pi_1^* \\omega - \\pi_2^* \\omega,\n$$\n因为 $d(dS)=0$。$\\beta$ 的零点集定义了一个子流形\n$$\nL = \\{ (q,p; Q,P) \\in T^*Q \\times T^*Q \\mid \\beta = 0 \\}.\n$$\n沿 $L$，等式 $\\beta=0$ 意味着 $dq^i$ 和 $dQ^i$ 的系数为零，从而得到关系式\n$$\np_i = \\frac{\\partial S}{\\partial q_i}, \\qquad P_i = - \\frac{\\partial S}{\\partial Q_i}.\n$$\n这些方程将 $p$ 和 $P$ 指定为 $q$ 和 $Q$ 的函数。此外，由于 $d\\beta = \\pi_1^* \\omega - \\pi_2^* \\omega$，子流形 $L$ 是拉格朗日子流形。当混合Hessian矩阵 $\\frac{\\partial^2 S}{\\partial q \\partial Q}$ 可逆时，根据隐函数定理，方程组\n$$\np - \\frac{\\partial S}{\\partial q}(q,Q) = 0\n$$\n可以在局部解出 $Q$ 作为 $(q,p)$ 的光滑函数。将此 $Q(q,p)$ 代入 $P = - \\frac{\\partial S}{\\partial Q}(q,Q)$，便得到一个光滑的局部映射 $\\Phi(q,p) = \\big(Q(q,p), P(q,p)\\big)$，其图像为 $L$，因此 $\\Phi$ 是一个局部辛同胚。\n\n我们现在将此构造应用于具体的函数\n$$\nS(q,Q) = \\frac{1}{2} q^{\\top} A q + q^{\\top} B Q + \\frac{1}{2} Q^{\\top} C Q,\n$$\n其中\n$$\nA = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}, \n\\quad B = \\begin{pmatrix} 1  2 \\\\ 3  1 \\end{pmatrix}, \n\\quad C = \\begin{pmatrix} 4  0 \\\\ 0  5 \\end{pmatrix}.\n$$\n关于 $q$ 和 $Q$ 的梯度为\n$$\n\\frac{\\partial S}{\\partial q} = A q + B Q, \n\\qquad \n\\frac{\\partial S}{\\partial Q} = B^{\\top} q + C Q.\n$$\n因此，定义 $L$ 的关系式为\n$$\np = A q + B Q, \n\\qquad \nP = - B^{\\top} q - C Q.\n$$\n混合Hessian矩阵为\n$$\n\\frac{\\partial^2 S}{\\partial q \\partial Q} = B,\n$$\n它是一个常数。其行列式为\n$$\n\\det(B) = (1)(1) - (2)(3) = 1 - 6 = -5 \\neq 0,\n$$\n因此 $B$ 可逆，从而混合Hessian矩阵处处可逆。因此，我们可以对第一个方程求解 $Q$：\n$$\nB Q = p - A q \n\\quad\\Longrightarrow\\quad\nQ = B^{-1} \\big( p - A q \\big).\n$$\n对于给定的 $B$，其逆矩阵为\n$$\nB^{-1} = \\frac{1}{\\det(B)} \\begin{pmatrix} 1  -2 \\\\ -3  1 \\end{pmatrix}\n= -\\frac{1}{5} \\begin{pmatrix} 1  -2 \\\\ -3  1 \\end{pmatrix}.\n$$\n记 $q = (q_1,q_2)^{\\top}$ 和 $p = (p_1,p_2)^{\\top}$。于是\n$$\nA q = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} q_1 \\\\ q_2 \\end{pmatrix}\n= \\begin{pmatrix} 2 q_1 + q_2 \\\\ q_1 + 3 q_2 \\end{pmatrix},\n$$\n且\n$$\np - A q = \\begin{pmatrix} p_1 - (2 q_1 + q_2) \\\\ p_2 - (q_1 + 3 q_2) \\end{pmatrix}.\n$$\n因此\n\\begin{align*}\nQ = B^{-1} (p - A q) \\\\\n= -\\frac{1}{5} \n\\begin{pmatrix} \n1  -2 \\\\ \n-3  1 \n\\end{pmatrix}\n\\begin{pmatrix} \np_1 - (2 q_1 + q_2) \\\\ \np_2 - (q_1 + 3 q_2) \n\\end{pmatrix}.\n\\end{align*}\n展开各分量：\n\\begin{align*}\nQ_1 = -\\frac{1}{5} \\Big( \\big(p_1 - 2 q_1 - q_2\\big) - 2\\big(p_2 - q_1 - 3 q_2\\big) \\Big)\n= -\\frac{1}{5} \\big( p_1 - 2 p_2 + 5 q_2 \\big)\n= -\\frac{1}{5} p_1 + \\frac{2}{5} p_2 - q_2, \\\\[6pt]\nQ_2 = -\\frac{1}{5} \\Big( -3\\big(p_1 - 2 q_1 - q_2\\big) + \\big(p_2 - q_1 - 3 q_2\\big) \\Big)\n= -\\frac{1}{5} \\big( -3 p_1 + p_2 + 5 q_1 \\big)\n= \\frac{3}{5} p_1 - \\frac{1}{5} p_2 - q_1.\n\\end{align*}\n将 $Q$ 表示为 $(q,p)$ 的函数后，我们用\n$$\nP = - B^{\\top} q - C Q.\n$$\n计算 $P$。由于 $B^{\\top} = \\begin{pmatrix} 1  3 \\\\ 2  1 \\end{pmatrix}$，我们有\n$$\n- B^{\\top} q = \\begin{pmatrix} -q_1 - 3 q_2 \\\\ -2 q_1 - q_2 \\end{pmatrix},\n\\qquad\nC Q = \\begin{pmatrix} 4  0 \\\\ 0  5 \\end{pmatrix} \\begin{pmatrix} Q_1 \\\\ Q_2 \\end{pmatrix}\n= \\begin{pmatrix} 4 Q_1 \\\\ 5 Q_2 \\end{pmatrix}.\n$$\n因此\n\\begin{align*}\nP_1 = -q_1 - 3 q_2 - 4 Q_1 \n= -q_1 - 3 q_2 - 4\\Big( -\\frac{1}{5} p_1 + \\frac{2}{5} p_2 - q_2 \\Big)\n= -q_1 + q_2 + \\frac{4}{5} p_1 - \\frac{8}{5} p_2, \\\\[6pt]\nP_2 = -2 q_1 - q_2 - 5 Q_2 \n= -2 q_1 - q_2 - 5\\Big( \\frac{3}{5} p_1 - \\frac{1}{5} p_2 - q_1 \\Big)\n= 3 q_1 - q_2 - 3 p_1 + p_2.\n\\end{align*}\n因此，由 $S$ 生成的局部辛同胚 $\\Phi: (q,p) \\mapsto (Q,P)$ 由上述分量式公式明确给出，这些公式在隐函数定理适用的邻域内有效（在这个线性情况下，由于 $B$ 可逆，因此全局有效）。混合Hessian矩阵是常数且等于 $B$，而 $B$ 处处可逆，因此 $(Q,P)$ 作为 $(q,p)$ 的函数的可解性直接可得。\n\n按要求收集四个分量，我们得到最终表达式\n\\begin{align*}\nQ_1 = -\\frac{1}{5} p_1 + \\frac{2}{5} p_2 - q_2, \\\\\nQ_2 = \\frac{3}{5} p_1 - \\frac{1}{5} p_2 - q_1, \\\\\nP_1 = \\frac{4}{5} p_1 - \\frac{8}{5} p_2 - q_1 + q_2, \\\\\nP_2 = -3 p_1 + p_2 + 3 q_1 - q_2.\n\\end{align*}\n这些公式给出了对于给定的母函数 $S$，$ (Q,P)$ 作为 $(q,p)$ 的函数的显式解。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\frac{1}{5} p_1 + \\frac{2}{5} p_2 - q_2  \\frac{3}{5} p_1 - \\frac{1}{5} p_2 - q_1  \\frac{4}{5} p_1 - \\frac{8}{5} p_2 - q_1 + q_2  -3 p_1 + p_2 + 3 q_1 - q_2\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "这个实践将抽象的母函数理论与物理动力学紧密联系起来。你将看到，一个基本物理系统（谐振子）的精确时间演化本身就是一个由“精确离散拉格朗日量” $L_d(q_0, q_1)$ 生成的辛变换。通过推导这个 $L_d$ 并验证其性质，你不仅能加深对母函数的理解，还能体会到变分原理在构造保结构算法中的深刻威力。",
            "id": "3742803",
            "problem": "考虑一个单自由度力学系统，其位形流形为 $Q=\\mathbb{R}$，余切丛为 $T^{\\ast}Q$，配备了典范辛形式 $\\omega_{\\mathrm{can}}=\\mathrm{d}q\\wedge \\mathrm{d}p$。设该系统为谐振子，其质量 $m>0$，刚度 $k>0$，连续时间拉格朗日量为 $L(q,\\dot{q})=\\tfrac{1}{2}m\\,\\dot{q}^{2}-\\tfrac{1}{2}k\\,q^{2}$。定义角频率 $\\omega=\\sqrt{k/m}$ 和一个固定的时间步长 $h>0$。\n\n精确离散拉格朗日量 $L_{d}(q_{0},q_{1};h)$ 定义为在时间区间 $[0,h]$ 上，沿着插值边界值 $q(0)=q_{0}$ 和 $q(h)=q_{1}$ 的欧拉-拉格朗日方程的唯一解的作用量积分：\n$$\nL_{d}(q_{0},q_{1};h)=\\int_{0}^{h} L\\big(q(t),\\dot{q}(t)\\big)\\,\\mathrm{d}t,\n$$\n其中 $q(t)$ 满足 $m\\,\\ddot{q}(t)+k\\,q(t)=0$ 以及给定的端点条件。仅使用基本定义和经过充分检验的事实来：\n- 求解具有指定边界条件的 $q(t)$ 的常微分方程（ODE）。\n- 计算作用量积分，以 $q_{0}$、$q_{1}$、$m$、$\\omega$ 和 $h$ 的形式，得到 $L_{d}(q_{0},q_{1};h)$ 的闭式解析表达式，其中所有三角函数参数均为弧度。\n- 使用离散勒让德变换 $p_{0}=-D_{1}L_{d}(q_{0},q_{1};h)$ 和 $p_{1}=D_{2}L_{d}(q_{0},q_{1};h)$，推导诱导出的离散映射 $\\Phi_{h}:(q_{0},p_{0})\\mapsto(q_{1},p_{1})$，并将其解释为由谐振子流在 $(q,p)$ 平面中生成的旋转。\n- 验证所得到的离散映射关于 $\\omega_{\\mathrm{can}}$ 是辛的。\n- 证明对于所有 $h$，机械能 $H(q,p)=\\tfrac{1}{2m}p^{2}+\\tfrac{1}{2}k\\,q^{2}$ 都被该离散映射精确守恒。\n\n仅报告 $L_{d}(q_{0},q_{1};h)$ 的显式闭式解析表达式作为你的最终答案。量 $L_{d}$ 的单位是作用量（焦耳-秒），但在你的最终方框答案中不要包含单位。所有角度必须以弧度为单位。不需要四舍五入。",
            "solution": "### 求解推导\n\n该过程涉及问题陈述中概述的五个主要步骤。最终需要的答案仅为 $L_{d}(q_{0},q_{1};h)$ 的表达式。\n\n**1. 求解路径 $q(t)$ 的常微分方程**\n给定拉格朗日量的欧拉-拉格朗日方程由 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\frac{\\partial L}{\\partial \\dot{q}} - \\frac{\\partial L}{\\partial q} = 0$ 导出。\n$\\frac{\\partial L}{\\partial \\dot{q}} = m\\dot{q}$ 且 $\\frac{\\partial L}{\\partial q} = -kq$。\n因此，运动方程为 $m\\ddot{q} + kq = 0$。使用定义 $\\omega^2 = k/m$，方程变为：\n$$\n\\ddot{q}(t) + \\omega^2 q(t) = 0\n$$\n这个二阶线性齐次常微分方程的通解是：\n$$\nq(t) = A\\cos(\\omega t) + B\\sin(\\omega t)\n$$\n其中 $A$ 和 $B$ 是由边界条件 $q(0)=q_{0}$ 和 $q(h)=q_{1}$ 决定的常数。\n在 $t=0$ 处应用第一个条件：\n$$\nq(0) = A\\cos(0) + B\\sin(0) = A = q_{0}\n$$\n所以，解变为 $q(t) = q_{0}\\cos(\\omega t) + B\\sin(\\omega t)$。\n在 $t=h$ 处应用第二个条件：\n$$\nq(h) = q_{0}\\cos(\\omega h) + B\\sin(\\omega h) = q_{1}\n$$\n求解 $B$，假设 $\\sin(\\omega h) \\neq 0$：\n$$\nB = \\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\n$$\n将 $A$ 和 $B$ 代回通解，得到满足边界条件的唯一轨迹：\n$$\nq(t) = q_{0}\\cos(\\omega t) + \\left(\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\\right)\\sin(\\omega t)\n$$\n沿此轨迹的速度为 $\\dot{q}(t)$：\n$$\n\\dot{q}(t) = -q_{0}\\omega\\sin(\\omega t) + \\omega\\left(\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\\right)\\cos(\\omega t)\n$$\n\n**2. 计算作用量积分以得到 $L_{d}(q_{0},q_{1};h)$**\n离散拉格朗日量为 $L_{d}=\\int_{0}^{h} (\\tfrac{1}{2}m\\,\\dot{q}^{2}-\\tfrac{1}{2}k\\,q^{2})\\,\\mathrm{d}t$。直接积分会很繁琐。一种更优雅的方法是利用分部积分和运动方程。\n$$\n\\int_{0}^{h} \\tfrac{1}{2}m\\dot{q}^{2} \\,\\mathrm{d}t = \\frac{1}{2}m \\int_{0}^{h} \\dot{q} \\cdot \\dot{q} \\,\\mathrm{d}t\n$$\n使用 $u=\\dot{q}$ 和 $\\mathrm{d}v=\\dot{q}\\mathrm{d}t$ 进行分部积分：\n$$\n\\frac{1}{2}m \\int_{0}^{h} \\dot{q}^{2} \\,\\mathrm{d}t = \\frac{1}{2}m \\left[ \\dot{q}(t)q(t) \\right]_{0}^{h} - \\frac{1}{2}m \\int_{0}^{h} \\ddot{q}(t)q(t) \\,\\mathrm{d}t\n$$\n根据运动方程，$m\\ddot{q} = -kq$。将其代入积分：\n$$\n- \\frac{1}{2}m \\int_{0}^{h} \\ddot{q}q \\,\\mathrm{d}t = - \\frac{1}{2} \\int_{0}^{h} (-kq)q \\,\\mathrm{d}t = \\int_{0}^{h} \\tfrac{1}{2}kq^2 \\,\\mathrm{d}t\n$$\n所以我们有：\n$$\n\\int_{0}^{h} \\tfrac{1}{2}m\\dot{q}^{2} \\,\\mathrm{d}t = \\frac{1}{2}m \\left( \\dot{q}(h)q(h) - \\dot{q}(0)q(0) \\right) + \\int_{0}^{h} \\tfrac{1}{2}kq^2 \\,\\mathrm{d}t\n$$\n现在将此结果代回 $L_d$ 的定义：\n$$\nL_{d} = \\left[ \\frac{1}{2}m (\\dot{q}(h)q_{1} - \\dot{q}(0)q_{0}) + \\int_{0}^{h} \\tfrac{1}{2}kq^2 \\,\\mathrm{d}t \\right] - \\int_{0}^{h} \\tfrac{1}{2}kq^2 \\,\\mathrm{d}t\n$$\n$$\nL_{d}(q_{0},q_{1};h) = \\frac{1}{2}m \\left( \\dot{q}(h)q_{1} - \\dot{q}(0)q_{0} \\right)\n$$\n我们需要端点处的速度。\n在 $t=0$ 时：\n$$\n\\dot{q}(0) = -q_{0}\\omega\\sin(0) + \\omega\\left(\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\\right)\\cos(0) = \\omega\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\n$$\n在 $t=h$ 时：\n$$\n\\dot{q}(h) = -q_{0}\\omega\\sin(\\omega h) + \\omega\\left(\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\\right)\\cos(\\omega h)\n$$\n$$\n\\dot{q}(h) = \\frac{\\omega}{\\sin(\\omega h)} \\left( -q_{0}\\sin^2(\\omega h) + q_{1}\\cos(\\omega h) - q_{0}\\cos^2(\\omega h) \\right)\n$$\n$$\n\\dot{q}(h) = \\frac{\\omega}{\\sin(\\omega h)} \\left( q_{1}\\cos(\\omega h) - q_{0}(\\sin^2(\\omega h) + \\cos^2(\\omega h)) \\right) = \\frac{\\omega(q_{1}\\cos(\\omega h) - q_{0})}{\\sin(\\omega h)}\n$$\n将这些速度代入 $L_d$ 的表达式：\n$$\nL_{d} = \\frac{1}{2}m \\left[ \\left(\\frac{\\omega(q_{1}\\cos(\\omega h) - q_{0})}{\\sin(\\omega h)}\\right)q_{1} - \\left(\\frac{\\omega(q_{1} - q_{0}\\cos(\\omega h))}{\\sin(\\omega h)}\\right)q_{0} \\right]\n$$\n$$\nL_{d} = \\frac{m\\omega}{2\\sin(\\omega h)} \\left[ (q_{1}^2\\cos(\\omega h) - q_{0}q_{1}) - (q_{0}q_{1} - q_{0}^2\\cos(\\omega h)) \\right]\n$$\n$$\nL_{d}(q_{0},q_{1};h) = \\frac{m\\omega}{2\\sin(\\omega h)} \\left[ (q_{0}^2 + q_{1}^2)\\cos(\\omega h) - 2q_{0}q_{1} \\right]\n$$\n这就是精确离散拉格朗日量的闭式表达式。\n\n**3. 推导离散映射 $\\Phi_{h}$**\n离散动量 $p_0$ 和 $p_1$ 通过离散勒让德变换求得：\n$p_0 = -D_1 L_d = -\\frac{\\partial L_d}{\\partial q_0}$：\n$$\np_0 = -\\frac{m\\omega}{2\\sin(\\omega h)} \\left[ 2q_{0}\\cos(\\omega h) - 2q_{1} \\right] = \\frac{m\\omega}{\\sin(\\omega h)} \\left( q_{1} - q_{0}\\cos(\\omega h) \\right)\n$$\n$p_1 = D_2 L_d = \\frac{\\partial L_d}{\\partial q_1}$：\n$$\np_1 = \\frac{m\\omega}{2\\sin(\\omega h)} \\left[ 2q_{1}\\cos(\\omega h) - 2q_{0} \\right] = \\frac{m\\omega}{\\sin(\\omega h)} \\left( q_{1}\\cos(\\omega h) - q_{0} \\right)\n$$\n为了找到 $\\Phi_h: (q_0, p_0)\\mapsto(q_1, p_1)$，我们必须用 $q_0$ 和 $p_0$ 来表示 $q_1$ 和 $p_1$。从 $p_0$ 的方程开始：\n$$\np_0 \\sin(\\omega h) = m\\omega q_1 - m\\omega q_0\\cos(\\omega h)\n$$\n$$\nq_1 = q_0\\cos(\\omega h) + \\frac{p_0}{m\\omega}\\sin(\\omega h)\n$$\n现在将此结果代入 $p_1$ 的方程：\n$$\np_1 = \\frac{m\\omega}{\\sin(\\omega h)} \\left[ \\left(q_0\\cos(\\omega h) + \\frac{p_0}{m\\omega}\\sin(\\omega h)\\right)\\cos(\\omega h) - q_0 \\right]\n$$\n$$\np_1 = \\frac{m\\omega}{\\sin(\\omega h)} \\left[ q_0 \\cos^2(\\omega h) + \\frac{p_0}{m\\omega}\\sin(\\omega h)\\cos(\\omega h) - q_0 \\right]\n$$\n$$\np_1 = \\frac{m\\omega}{\\sin(\\omega h)} \\left[ q_0(\\cos^2(\\omega h)-1) + \\frac{p_0}{m\\omega}\\sin(\\omega h)\\cos(\\omega h) \\right]\n$$\n$$\np_1 = \\frac{m\\omega}{\\sin(\\omega h)} \\left[ -q_0\\sin^2(\\omega h) + \\frac{p_0}{m\\omega}\\sin(\\omega h)\\cos(\\omega h) \\right]\n$$\n$$\np_1 = -m\\omega q_0\\sin(\\omega h) + p_0\\cos(\\omega h)\n$$\n所以，离散映射 $\\Phi_h$ 由下式给出：\n$$\n\\begin{pmatrix} q_1 \\\\ p_1 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\omega h)  \\frac{1}{m\\omega}\\sin(\\omega h) \\\\ -m\\omega\\sin(\\omega h)  \\cos(\\omega h) \\end{pmatrix} \\begin{pmatrix} q_0 \\\\ p_0 \\end{pmatrix}\n$$\n这正是连续谐振子的时间-$h$ 流映射，它描述了在缩放相空间中的一个旋转。\n\n**4. 验证映射是辛的**\n该映射是一个线性变换 $(q_1, p_1)^T = M(q_0, p_0)^T$，其中 $M$ 是上面的矩阵。如果其雅可比矩阵 $DF=M$ 满足 $M^T J M = J$，其中 $J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$，则该映射是辛的。对于一个 $2 \\times 2$ 矩阵，此条件等价于 $\\det(M)=1$。\n$$\n\\det(M) = (\\cos(\\omega h))(\\cos(\\omega h)) - (\\frac{1}{m\\omega}\\sin(\\omega h))(-m\\omega\\sin(\\omega h))\n$$\n$$\n\\det(M) = \\cos^2(\\omega h) + \\sin^2(\\omega h) = 1\n$$\n行列式为 $1$，因此映射 $\\Phi_h$ 是辛的。这是从生成函数（$L_d$）推导映射的预期结果，这一过程被称为典范变换。\n\n**5. 验证能量守恒**\n哈密顿量是 $H(q,p) = \\frac{p^2}{2m} + \\frac{1}{2}kq^2 = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2$。我们必须证明 $H(q_1,p_1)=H(q_0,p_0)$。\n考虑 $2mH(q_1, p_1) = p_1^2 + m^2\\omega^2q_1^2$。代入 $q_1$ 和 $p_1$ 的表达式：\n$$\np_1^2 = (-m\\omega q_0\\sin(\\omega h) + p_0\\cos(\\omega h))^2 = m^2\\omega^2q_0^2\\sin^2(\\omega h) - 2m\\omega q_0 p_0 \\sin(\\omega h)\\cos(\\omega h) + p_0^2\\cos^2(\\omega h)\n$$\n$$\nq_1^2 = (q_0\\cos(\\omega h) + \\frac{p_0}{m\\omega}\\sin(\\omega h))^2 = q_0^2\\cos^2(\\omega h) + \\frac{2q_0 p_0}{m\\omega}\\cos(\\omega h)\\sin(\\omega h) + \\frac{p_0^2}{m^2\\omega^2}\\sin^2(\\omega h)\n$$\n$$\nm^2\\omega^2q_1^2 = m^2\\omega^2q_0^2\\cos^2(\\omega h) + 2m\\omega q_0 p_0 \\cos(\\omega h)\\sin(\\omega h) + p_0^2\\sin^2(\\omega h)\n$$\n将 $p_1^2$ 和 $m^2\\omega^2q_1^2$ 相加：\n$$\np_1^2+m^2\\omega^2q_1^2 = (m^2\\omega^2q_0^2\\sin^2(\\omega h) + p_0^2\\cos^2(\\omega h)) + (m^2\\omega^2q_0^2\\cos^2(\\omega h) + p_0^2\\sin^2(\\omega h))\n$$\n交叉项相互抵消。将含有 $q_0^2$ 和 $p_0^2$ 的项分组：\n$$\np_1^2+m^2\\omega^2q_1^2 = m^2\\omega^2q_0^2(\\sin^2(\\omega h)+\\cos^2(\\omega h)) + p_0^2(\\cos^2(\\omega h)+\\sin^2(\\omega h))\n$$\n$$\np_1^2+m^2\\omega^2q_1^2 = m^2\\omega^2q_0^2 + p_0^2\n$$\n两边同除以 $2m$，我们得到：\n$$\n\\frac{p_1^2}{2m} + \\frac{1}{2}m\\omega^2q_1^2 = \\frac{p_0^2}{2m} + \\frac{1}{2}m\\omega^2q_0^2\n$$\n因此，$H(q_1,p_1)=H(q_0,p_0)$，这表明精确离散映射精确地守恒能量，这对于时间无关的哈密顿系统的精确解是符合预期的。\n\n要求的最终答案是 $L_{d}(q_{0},q_{1};h)$ 的表达式。",
            "answer": "$$\n\\boxed{\\frac{m\\omega}{2\\sin(\\omega h)} \\left[ (q_{0}^{2} + q_{1}^{2})\\cos(\\omega h) - 2q_{0}q_{1} \\right]}\n$$"
        },
        {
            "introduction": "在将母函数用于描述变换之后，我们转向另一种应用：生成代表系统“状态”的拉格朗日截面。本练习使用第零类母函数 $S(q)$，它直接定义了余切丛中的一个拉格朗日图。通过计算其临界点的莫尔斯指数，你将揭示母函数的局部性质（如鞍点或极值点）如何决定了相应状态在相空间中的几何形态，特别是在其与零截面相交处的结构。",
            "id": "3742811",
            "problem": "令 $Q$ 为光滑流形 $\\mathbb{R}^{4}$，其全局坐标为 $(q_{1}, q_{2}, q_{3}, q_{4})$，并考虑配备了典范辛形式的余切丛 $T^{*}Q$。令 $S: Q \\to \\mathbb{R}$ 为光滑函数\n$$\nS(q_{1}, q_{2}, q_{3}, q_{4}) = \\frac{1}{2}\\left(-2 q_{1}^{2} - q_{2}^{2} + 3 q_{3}^{2} + 5 q_{4}^{2}\\right) + q_{1} q_{2} + 2 q_{3} q_{4}.\n$$\n恰当 1-形式 $dS$ 定义了一个拉格朗日截面 $\\Lambda = \\operatorname{graph}(dS) \\subset T^{*}Q$。仅从梯度、赫斯矩阵、莫尔斯指数的定义，以及将图像的切空间刻画为导数的图像出发，按以下步骤进行：\n\n1. 确定 $S$ 的临界点，并验证它们是非退化的。\n\n2. 计算 $S$ 在临界点处的莫尔斯指数。莫尔斯指数是 $S$ 在该临界点处的赫斯矩阵的负特征值的数量（计入重数）。\n\n3. 使用恒等关系 $T_{(q_{0}, dS(q_{0}))}\\Lambda = \\{(v, \\mathrm{Hess}_{q_{0}}(S)\\cdot v) : v \\in T_{q_{0}}Q\\}$ 和投影 $\\pi: T^{*}Q \\to Q$，将莫尔斯指数与 $\\Lambda$ 和零截面的局部相交定向联系起来，并描述赫斯矩阵的符号差如何决定 $\\Lambda$ 在临界点附近于投影 $\\pi$ 下的局部行为。\n\n提供 $S$ 在其临界点处的莫尔斯指数的单个整数值作为最终答案。无需四舍五入，不涉及单位。将答案表示为单个整数。",
            "solution": "令光滑流形为 $Q = \\mathbb{R}^{4}$，其全局坐标为 $(q_{1}, q_{2}, q_{3}, q_{4})$。光滑函数 $S: Q \\to \\mathbb{R}$ 由下式给出\n$$\nS(q_{1}, q_{2}, q_{3}, q_{4}) = \\frac{1}{2}\\left(-2 q_{1}^{2} - q_{2}^{2} + 3 q_{3}^{2} + 5 q_{4}^{2}\\right) + q_{1} q_{2} + 2 q_{3} q_{4}.\n$$\n拉格朗日截面 $\\Lambda$ 是恰当 1-形式 $dS$ 的图像。\n\n**1. 临界点与非退化性**\n\n如果微分 $dS$ 在点 $q_{0} \\in Q$ 处为零，则该点是 $S$ 的一个临界点。在局部坐标中，这意味着 $S$ 的所有一阶偏导数在 $q_{0}$ 处都为零。我们计算 $S$ 的梯度：\n$$\n\\nabla S = \\left( \\frac{\\partial S}{\\partial q_{1}}, \\frac{\\partial S}{\\partial q_{2}}, \\frac{\\partial S}{\\partial q_{3}}, \\frac{\\partial S}{\\partial q_{4}} \\right).\n$$\n偏导数为：\n$$\n\\frac{\\partial S}{\\partial q_{1}} = -2 q_{1} + q_{2}\n$$\n$$\n\\frac{\\partial S}{\\partial q_{2}} = -q_{2} + q_{1}\n$$\n$$\n\\frac{\\partial S}{\\partial q_{3}} = 3 q_{3} + 2 q_{4}\n$$\n$$\n\\frac{\\partial S}{\\partial q_{4}} = 5 q_{4} + 2 q_{3}\n$$\n将这些导数设为零，得到一个线性方程组：\n\\begin{align*}\n-2 q_{1} + q_{2} = 0 \\\\\nq_{1} - q_{2} = 0 \\\\\n3 q_{3} + 2 q_{4} = 0 \\\\\n2 q_{3} + 5 q_{4} = 0\n\\end{align*}\n由前两个方程，有 $q_{2} = 2 q_{1}$ 和 $q_{1} = q_{2}$。这意味着 $q_{1} = 2 q_{1}$，即 $q_{1} = 0$，因此 $q_{2} = 0$。\n由第三个方程，有 $q_{4} = -\\frac{3}{2} q_{3}$。将其代入第四个方程，得到 $2 q_{3} + 5(-\\frac{3}{2} q_{3}) = 0$，化简为 $2 q_{3} - \\frac{15}{2} q_{3} = 0$，即 $-\\frac{11}{2} q_{3} = 0$。这意味着 $q_{3} = 0$，因此 $q_{4} = 0$。\n因此，在 $q_{0} = (0, 0, 0, 0)$ 处有一个唯一的临界点。\n\n如果 $S$ 在某临界点处的赫斯矩阵是可逆的，则该临界点是非退化的。赫斯矩阵 $H = \\mathrm{Hess}(S)$ 的元素为 $H_{ij} = \\frac{\\partial^2 S}{\\partial q_i \\partial q_j}$。由于 $S$ 是一个二次函数，其赫斯矩阵是一个常数矩阵。\n$$\nH = \\begin{pmatrix}\n\\frac{\\partial^2 S}{\\partial q_{1}^2}  \\frac{\\partial^2 S}{\\partial q_{1} \\partial q_{2}}  \\frac{\\partial^2 S}{\\partial q_{1} \\partial q_{3}}  \\frac{\\partial^2 S}{\\partial q_{1} \\partial q_{4}} \\\\\n\\frac{\\partial^2 S}{\\partial q_{2} \\partial q_{1}}  \\frac{\\partial^2 S}{\\partial q_{2}^2}  \\frac{\\partial^2 S}{\\partial q_{2} \\partial q_{3}}  \\frac{\\partial^2 S}{\\partial q_{2} \\partial q_{4}} \\\\\n\\frac{\\partial^2 S}{\\partial q_{3} \\partial q_{1}}  \\frac{\\partial^2 S}{\\partial q_{3} \\partial q_{2}}  \\frac{\\partial^2 S}{\\partial q_{3}^2}  \\frac{\\partial^2 S}{\\partial q_{3} \\partial q_{4}} \\\\\n\\frac{\\partial^2 S}{\\partial q_{4} \\partial q_{1}}  \\frac{\\partial^2 S}{\\partial q_{4} \\partial q_{2}}  \\frac{\\partial^2 S}{\\partial q_{4} \\partial q_{3}}  \\frac{\\partial^2 S}{\\partial q_{4}^2}\n\\end{pmatrix} = \\begin{pmatrix}\n-2  1  0  0 \\\\\n1  -1  0  0 \\\\\n0  0  3  2 \\\\\n0  0  2  5\n\\end{pmatrix}.\n$$\n这个块对角矩阵的行列式是对角块行列式的乘积：\n$$\n\\det(H) = \\det\\begin{pmatrix} -2  1 \\\\ 1  -1 \\end{pmatrix} \\cdot \\det\\begin{pmatrix} 3  2 \\\\ 2  5 \\end{pmatrix} = ((-2)(-1) - (1)(1)) \\cdot ((3)(5) - (2)(2)) = (2-1)(15-4) = (1)(11) = 11.\n$$\n由于 $\\det(H) = 11 \\neq 0$，赫斯矩阵是可逆的。因此，临界点 $q_{0} = (0, 0, 0, 0)$ 是非退化的。\n\n**2. 莫尔斯指数**\n\n$S$ 在一个临界点处的莫尔斯指数是该点赫斯矩阵的负特征值的数量。我们需要求出 $H$ 的特征值。由于其块对角结构，我们可以分别求出每个 $2 \\times 2$ 块的特征值。\n\n对于第一个块，$H_{11} = \\begin{pmatrix} -2  1 \\\\ 1  -1 \\end{pmatrix}$，特征方程为 $\\det(H_{11} - \\lambda I) = 0$：\n$$\n(-2-\\lambda)(-1-\\lambda) - 1 = \\lambda^2 + 3\\lambda + 2 - 1 = \\lambda^2 + 3\\lambda + 1 = 0.\n$$\n特征值为 $\\lambda = \\frac{-3 \\pm \\sqrt{3^2 - 4(1)(1)}}{2} = \\frac{-3 \\pm \\sqrt{5}}{2}$。因为 $\\sqrt{5} \\approx 2.236$，所以两个特征值 $\\lambda_{1} = \\frac{-3+\\sqrt{5}}{2}$ 和 $\\lambda_{2} = \\frac{-3-\\sqrt{5}}{2}$ 都是负的。\n\n对于第二个块，$H_{22} = \\begin{pmatrix} 3  2 \\\\ 2  5 \\end{pmatrix}$，特征方程为 $\\det(H_{22} - \\lambda I) = 0$：\n$$\n(3-\\lambda)(5-\\lambda) - 4 = \\lambda^2 - 8\\lambda + 15 - 4 = \\lambda^2 - 8\\lambda + 11 = 0.\n$$\n特征值为 $\\lambda = \\frac{8 \\pm \\sqrt{(-8)^2 - 4(1)(11)}}{2} = \\frac{8 \\pm \\sqrt{64-44}}{2} = \\frac{8 \\pm \\sqrt{20}}{2} = 4 \\pm \\sqrt{5}$。因为 $\\sqrt{5} \\approx 2.236  4$，所以两个特征值 $\\lambda_{3} = 4+\\sqrt{5}$ 和 $\\lambda_{4} = 4-\\sqrt{5}$ 都是正的。\n\n$H$ 的特征值集合为 $\\{\\frac{-3+\\sqrt{5}}{2}, \\frac{-3-\\sqrt{5}}{2}, 4+\\sqrt{5}, 4-\\sqrt{5}\\}$。恰好有两个负特征值。\n因此，$S$ 在临界点 $q_{0}=(0,0,0,0)$ 处的莫尔斯指数为 $2$。\n\n**3. 几何解释**\n\n拉格朗日截面 $\\Lambda = \\operatorname{graph}(dS)$ 与零截面 $Z = \\{(q, 0) \\mid q \\in Q\\}$ 在点 $(q, p) \\in T^*Q$ 处相交，其中 $p = dS(q) = 0$。这恰好对应于 $S$ 的临界点。在我们的例子中，唯一的交点是 $(q_{0}, 0) = ((0,0,0,0), 0)$。\n\n在该交点处，$\\Lambda$ 的切空间是 $T_{(q_{0}, 0)}\\Lambda = \\{(v, \\mathrm{Hess}_{q_{0}}(S)\\cdot v) : v \\in T_{q_{0}}Q\\}$，零截面的切空间是 $T_{(q_{0}, 0)}Z = \\{(v, 0) : v \\in T_{q_{0}}Q\\}$。如果 $T_{(q_{0}, 0)}\\Lambda \\cap T_{(q_{0}, 0)}Z = \\{0\\}$，这两个切空间的交是横截的。这要求如果 $(v, \\mathrm{Hess}_{q_{0}}(S)\\cdot v) = (v, 0)$，则 $v=0$。这等价于要求 $\\mathrm{Hess}_{q_{0}}(S)\\cdot v = 0$ 意味着 $v=0$，这当且仅当 $\\mathrm{Hess}_{q_{0}}(S)$ 可逆时成立。正如我们已经证明的 $\\det(H) \\neq 0$，该交点是横截的。\n\n莫尔斯指数描述了该交点的局部几何性质。根据莫尔斯引理，存在局部坐标 $(y_1, y_2, y_3, y_4)$ 使得在 $q_0$ 附近，$S$ 具有以下形式\n$$\nS(y) = S(q_0) - \\frac{1}{2}(y_1^2 + y_2^2) + \\frac{1}{2}(y_3^2 + y_4^2),\n$$\n其中负项的数量对应于莫尔斯指数，即 $2$。\n在这些坐标下，截面 $\\Lambda$ 由 $p_i = \\partial S/\\partial y_i$ 给出，所以 $p_1 = -y_1$, $p_2 = -y_2$, $p_3 = y_3$, $p_4 = y_4$。\n在这些坐标下，赫斯矩阵为 $\\mathrm{diag}(-1, -1, 1, 1)$，其符号差为 $(2, 2)$（正、负特征值的数量）。莫尔斯指数是负特征值的数量，即 $k=2$。\n\n“局部相交定向”可以用 $T_{q_0}Q$ 上的一个二次型来描述，该二次型度量了 $T\\Lambda$ 和 $TZ$ 之间的差异。该二次型由 $B(v,v) = - \\langle v, \\mathrm{Hess}_{q_0}(S) \\cdot v \\rangle$ 给出。其符号差为 $(k, n-k)$，其中 $n=\\dim Q=4$，$k$ 是莫尔斯指数。在我们的例子中，符号差为 $(2, 2)$。\n\n投影 $\\pi: T^*Q \\to Q$ 将 $(q,p)$ 映射到 $q$。其在 $\\Lambda$ 上的限制 $\\pi|_\\Lambda: \\Lambda \\to Q$，在临界点周围是一个局部微分同胚，因为它的微分是一个同构（这是赫斯矩阵非退化性的一个推论）。莫尔斯指数不影响投影本身的局部微分同胚性质，而是描述了截面 $\\Lambda$ 相对于零截面 $Z$ 是如何“倾斜”的。莫尔斯指数 $k=2$ 意味着在局部，$\\Lambda$ 在两个方向上“向下倾斜”（动量与位置位移方向相反），在另外两个方向上“向上倾斜”（动量与位置位移方向一致）。这描述了 $\\Lambda$ 在临界点附近相对于基空间 $Q$ 的局部行为。",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}