{
    "hands_on_practices": [
        {
            "introduction": "Mastering the concept of a Dirac structure begins with the ability to verify its defining properties in a concrete setting. This first exercise provides a subspace $D$ defined by matrix relations, representing a common scenario in the interconnection of linear systems. By directly applying the definition of a maximally isotropic subspace, you will calculate its dimension and check the isotropy condition, confirming whether $D$ indeed constitutes a valid Dirac structure. ",
            "id": "3749210",
            "problem": "Consider the vector space $X=\\mathbb{R}^{4}$ and its dual $X^{*}=(\\mathbb{R}^{4})^{*}$. The symmetric bilinear pairing on $X\\oplus X^{*}$ is defined by $\\langle (v,\\alpha),(w,\\beta)\\rangle=\\alpha(w)+\\beta(v)$ for all $(v,\\alpha),(w,\\beta)\\in X\\oplus X^{*}$. In the context of interconnecting Hamiltonian subsystems via Dirac structures, take the constant subspace $D\\subset X\\oplus X^{*}$ given by the matrix relations\n$$\nGv=0,\\qquad \\alpha=Jv+G^{\\top}\\mu,\n$$\nwhere $v\\in\\mathbb{R}^{4}$, $\\alpha\\in(\\mathbb{R}^{4})^{*}$, and $\\mu\\in\\mathbb{R}^{2}$, with\n$$\nJ=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n-1 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 2\\\\\n0 & 0 & -2 & 0\n\\end{pmatrix},\\qquad\nG=\\begin{pmatrix}\n1 & 0 & -1 & 0\\\\\n0 & 1 & 0 & 1\n\\end{pmatrix}.\n$$\nUsing only the fundamental definition of a Dirac structure as a maximally isotropic subspace of $X\\oplus X^{*}$ with respect to the above pairing, determine whether $D$ is maximally isotropic and compute its dimension. Express your final answer as a row matrix $\\begin{pmatrix}d & \\chi\\end{pmatrix}$, where $d$ is the dimension of $D$ and $\\chi$ equals $1$ if $D$ is maximally isotropic and equals $0$ otherwise.",
            "solution": "The problem asks us to determine if a given subspace $D$ of $X \\oplus X^*$ is a Dirac structure, which by definition is a maximally isotropic subspace. We are given $X=\\mathbb{R}^{4}$, and its dual $X^{*}$ is identified with $\\mathbb{R}^{4}$. The ambient space is $X \\oplus X^{*} \\cong \\mathbb{R}^{4} \\oplus \\mathbb{R}^{4} = \\mathbb{R}^{8}$. The symmetric bilinear pairing is given by $\\langle (v,\\alpha),(w,\\beta)\\rangle=\\alpha(w)+\\beta(v)$. Identifying dual vectors with column vectors, this pairing is $\\langle (v,\\alpha),(w,\\beta)\\rangle=\\alpha^{\\top}w+\\beta^{\\top}v$.\n\nA subspace $D$ is **isotropic** if for any two elements $d_1, d_2 \\in D$, their pairing is zero: $\\langle d_1, d_2 \\rangle = 0$. This is equivalent to the condition $D \\subseteq D^{\\perp}$.\nA subspace $D$ is **maximally isotropic** if it is isotropic and its dimension is half the dimension of the ambient space. In this case, $\\dim(X \\oplus X^{*}) = \\dim(\\mathbb{R}^{4}) + \\dim((\\mathbb{R}^{4})^{*}) = 4+4=8$. Thus, $D$ is maximally isotropic if it is isotropic and $\\dim(D) = \\frac{1}{2} \\dim(X \\oplus X^{*}) = \\frac{8}{2} = 4$. Such a subspace satisfies $D = D^{\\perp}$.\n\nThe subspace $D$ is defined by the set of pairs $(v,\\alpha) \\in \\mathbb{R}^{4} \\oplus (\\mathbb{R}^{4})^{*}$ such that:\n1. $Gv=0$\n2. $\\alpha=Jv+G^{\\top}\\mu$ for some $\\mu\\in\\mathbb{R}^{2}$.\n\nHere, $v \\in \\mathbb{R}^{4}$, $\\alpha \\in (\\mathbb{R}^{4})^{*} \\cong \\mathbb{R}^{4}$, and the matrices are:\n$$\nJ=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n-1 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 2\\\\\n0 & 0 & -2 & 0\n\\end{pmatrix},\\qquad\nG=\\begin{pmatrix}\n1 & 0 & -1 & 0\\\\\n0 & 1 & 0 & 1\n\\end{pmatrix}.\n$$\n\nThe analysis proceeds in two main steps: first, we compute the dimension of $D$, denoted by $d$; second, we check if $D$ is isotropic.\n\n**Step 1: Compute the dimension of $D$**\n\nThe condition $Gv=0$ means that $v$ must belong to the null space (kernel) of the linear transformation represented by matrix $G$. The matrix $G$ is a $2 \\times 4$ matrix. Its rows are $(1, 0, -1, 0)$ and $(0, 1, 0, 1)$, which are linearly independent. Thus, the rank of $G$ is $\\text{rank}(G)=2$.\nBy the rank-nullity theorem, the dimension of the null space of $G$ is given by:\n$$\n\\dim(\\ker(G)) = \\dim(\\mathbb{R}^{4}) - \\text{rank}(G) = 4 - 2 = 2.\n$$\nLet's call the subspace $V_G = \\ker(G)$, so $\\dim(V_G)=2$.\n\nThe elements of $D$ are pairs $(v, \\alpha)$ where $v \\in V_G$ and $\\alpha$ is of the form $Jv + G^{\\top}\\mu$ for some $\\mu \\in \\mathbb{R}^{2}$.\nConsider the linear map $\\Phi: V_G \\oplus \\mathbb{R}^{2} \\to \\mathbb{R}^{4} \\oplus \\mathbb{R}^{4}$ defined by\n$$\n\\Phi(v, \\mu) = (v, Jv + G^{\\top}\\mu).\n$$\nThe image of this map is precisely the subspace $D$. The dimension of $D$ is the dimension of the image of $\\Phi$, which is equal to the dimension of the domain minus the dimension of the kernel of $\\Phi$.\nLet's find the kernel of $\\Phi$. We seek $(v, \\mu) \\in V_G \\oplus \\mathbb{R}^{2}$ such that $\\Phi(v, \\mu) = (0, 0)$.\nThis implies two conditions:\n1. $v=0$.\n2. $Jv + G^{\\top}\\mu = 0$.\n\nSubstituting $v=0$ from the first condition into the second gives $G^{\\top}\\mu = 0$.\nThe matrix $G^{\\top}$ is a $4 \\times 2$ matrix:\n$$\nG^{\\top} = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n-1 & 0 \\\\\n0 & 1\n\\end{pmatrix}.\n$$\nThe columns of $G^{\\top}$ are $(1, 0, -1, 0)^{\\top}$ and $(0, 1, 0, 1)^{\\top}$. These two vectors are linearly independent. Therefore, the only solution to $G^{\\top}\\mu = 0$ is $\\mu = 0 \\in \\mathbb{R}^{2}$.\nThus, the kernel of $\\Phi$ is $\\{(0,0)\\}$, which has dimension $0$. This means the map $\\Phi$ is injective.\nSince $\\Phi$ is an injective linear map from $V_G \\oplus \\mathbb{R}^{2}$ to $D$, it is an isomorphism between these spaces. Therefore, their dimensions are equal:\n$$\nd = \\dim(D) = \\dim(V_G \\oplus \\mathbb{R}^{2}) = \\dim(V_G) + \\dim(\\mathbb{R}^{2}) = 2 + 2 = 4.\n$$\nThe dimension of the subspace $D$ is $d=4$.\n\n**Step 2: Check for isotropy**\n\nTo check if $D$ is isotropic, we must verify that $\\langle d_1, d_2 \\rangle = 0$ for any two elements $d_1, d_2 \\in D$.\nLet $d_1 = (v_1, \\alpha_1)$ and $d_2 = (v_2, \\alpha_2)$ be two arbitrary elements of $D$.\nAccording to the definition of $D$, we have:\n$Gv_1 = 0$ and $\\alpha_1 = Jv_1 + G^{\\top}\\mu_1$ for some $\\mu_1 \\in \\mathbb{R}^{2}$.\n$Gv_2 = 0$ and $\\alpha_2 = Jv_2 + G^{\\top}\\mu_2$ for some $\\mu_2 \\in \\mathbb{R}^{2}$.\n\nNow we compute the pairing, identifying vectors in $(\\mathbb{R}^4)^*$ with vectors in $\\mathbb{R}^4$:\n$$\n\\langle d_1, d_2 \\rangle = \\alpha_1^{\\top}v_2 + \\alpha_2^{\\top}v_1.\n$$\nSubstitute the expressions for $\\alpha_1$ and $\\alpha_2$:\n$$\n\\langle d_1, d_2 \\rangle = (Jv_1 + G^{\\top}\\mu_1)^{\\top}v_2 + (Jv_2 + G^{\\top}\\mu_2)^{\\top}v_1.\n$$\nUsing the property $(A+B)^{\\top} = A^{\\top} + B^{\\top}$ and $(AB)^{\\top} = B^{\\top}A^{\\top}$:\n$$\n\\langle d_1, d_2 \\rangle = (v_1^{\\top}J^{\\top} + \\mu_1^{\\top}G)v_2 + (v_2^{\\top}J^{\\top} + \\mu_2^{\\top}G)v_1.\n$$\nDistributing the terms:\n$$\n\\langle d_1, d_2 \\rangle = v_1^{\\top}J^{\\top}v_2 + \\mu_1^{\\top}Gv_2 + v_2^{\\top}J^{\\top}v_1 + \\mu_2^{\\top}Gv_1.\n$$\nSince $v_1, v_2 \\in \\ker(G)$, we have $Gv_1 = 0$ and $Gv_2 = 0$. The expression simplifies to:\n$$\n\\langle d_1, d_2 \\rangle = v_1^{\\top}J^{\\top}v_2 + v_2^{\\top}J^{\\top}v_1.\n$$\nLet's examine the matrix $J$. Its transpose is:\n$$\nJ^{\\top} = \\begin{pmatrix}\n0 & -1 & 0 & 0\\\\\n1 & 0 & 0 & 0\\\\\n0 & 0 & 0 & -2\\\\\n0 & 0 & 2 & 0\n\\end{pmatrix} = -J.\n$$\nSo, $J$ is a skew-symmetric matrix. Substituting $J^{\\top}=-J$ into the pairing expression gives:\n$$\n\\langle d_1, d_2 \\rangle = v_1^{\\top}(-J)v_2 + v_2^{\\top}(-J)v_1 = -v_1^{\\top}Jv_2 - v_2^{\\top}Jv_1.\n$$\nThe term $v_2^{\\top}Jv_1$ is a scalar ($1 \\times 1$ matrix), so it is equal to its own transpose:\n$$\nv_2^{\\top}Jv_1 = (v_2^{\\top}Jv_1)^{\\top} = v_1^{\\top}J^{\\top}v_2 = v_1^{\\top}(-J)v_2 = -v_1^{\\top}Jv_2.\n$$\nSubstituting this back into the expression for the pairing:\n$$\n\\langle d_1, d_2 \\rangle = -v_1^{\\top}Jv_2 - (-v_1^{\\top}Jv_2) = -v_1^{\\top}Jv_2 + v_1^{\\top}Jv_2 = 0.\n$$\nSince this holds for any two elements $d_1, d_2 \\in D$, the subspace $D$ is isotropic.\n\n**Conclusion on Maximal Isotropy**\n\nWe have established two facts:\n1. The dimension of $D$ is $d=4$.\n2. The subspace $D$ is isotropic.\n\nThe dimension of the total space is $\\dim(X \\oplus X^{*}) = 8$. A subspace is maximally isotropic if it is isotropic and its dimension is half that of the ambient space. Here, $\\dim(D) = 4 = \\frac{1}{2}\\dim(X \\oplus X^{*})$.\nTherefore, $D$ is a maximally isotropic subspace. By definition, this means $D$ is a Dirac structure.\n\nThe question asks for the final answer in the form of a row matrix $\\begin{pmatrix} d & \\chi \\end{pmatrix}$, where $d$ is the dimension of $D$ and $\\chi$ is an indicator variable which is $1$ if $D$ is maximally isotropic and $0$ otherwise.\nFrom our analysis:\n$d = \\dim(D) = 4$.\nSince $D$ is maximally isotropic, $\\chi = 1$.\n\nThe final result is the pair $(4, 1)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond verifying the geometric properties of a given structure, it is crucial to understand its dynamical implications. Many Hamiltonian systems, particularly those arising from Lie group symmetries, possess degenerate Poisson structures leading to conserved quantities known as Casimirs. This practice challenges you to compute the Casimir functions for a system combining rotational dynamics and a trivial component, a task that involves solving a system of first-order partial differential equations.  Understanding these invariants is key, as they define the symplectic leaves on which the system's dynamics are confined, thereby constraining any possible interconnection.",
            "id": "3749205",
            "problem": "Consider the manifold $\\mathbb{R}^{4}$ with coordinates $x = (x_{1}, x_{2}, x_{3}, x_{4})$ and a degenerate Poisson structure defined by the matrix\n$$\n\\Pi(x) \\;=\\;\n\\begin{pmatrix}\n0 & x_{3} & -x_{2} & 0 \\\\\n-x_{3} & 0 & x_{1} & 0 \\\\\nx_{2} & -x_{1} & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\nThis structure arises as the direct product of the Lie–Poisson structure on the dual of the special orthogonal Lie algebra in three dimensions $\\mathfrak{so}(3)^{*}$ and a trivial Poisson structure on a line.\n\nUsing the definition of a Poisson bracket via a Poisson tensor and the characterization of Casimir functions as functions $C$ such that $\\Pi(x)\\nabla C(x) = 0$, compute a complete set of functionally independent Casimir functions for $\\Pi$ by solving the first-order Partial Differential Equation (PDE) system $\\Pi\\nabla C = 0$. Present your final answer as two polynomial representatives that generate all Casimirs as smooth functions of them.\n\nThen, starting from the definition of a Dirac structure as a maximally isotropic, integrable subbundle $L \\subset T\\mathcal{M} \\oplus T^{*}\\mathcal{M}$ with respect to the natural pairing, explain how these Casimir functions constrain the interconnection of this Hamiltonian subsystem with another via a power-conserving Dirac structure (Port-Hamiltonian (PH) interconnection), specifically in terms of reachable sets and equilibrium manifolds. Do not perform any numerical computation in this second part.\n\nYour final answer must be the pair of functionally independent Casimir functions in symbolic form, written as a single row matrix using the $\\mathrm{pmatrix}$ environment. No rounding is required, and no physical units are involved.",
            "solution": "We begin with the fundamental definition of a Poisson manifold and Casimir functions. A Poisson structure on a manifold $\\mathcal{M}$ is given by a bivector field (Poisson tensor) $\\Pi$ that defines a bracket on smooth functions $\\{f,g\\} = \\nabla f^{\\top}\\Pi\\nabla g$, and the dynamics of a Hamiltonian $H$ are $\\dot{x} = \\Pi(x)\\nabla H(x)$. A Casimir function $C$ is a function that lies in the center of the Poisson algebra, i.e., $\\{C,f\\}=0$ for all smooth $f$, which is equivalent to the condition $\\Pi(x)\\nabla C(x) = 0$.\n\nIn our case, the Poisson matrix is\n$$\n\\Pi(x) \\;=\\;\n\\begin{pmatrix}\n0 & x_{3} & -x_{2} & 0 \\\\\n-x_{3} & 0 & x_{1} & 0 \\\\\nx_{2} & -x_{1} & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix},\n$$\nso the Casimir PDE is\n$$\n\\Pi(x)\\nabla C(x) \\;=\\; 0.\n$$\nLet us denote the gradient of $C$ by\n$$\n\\nabla C(x) \\;=\\; \\begin{pmatrix} \\partial_{x_{1}}C \\\\ \\partial_{x_{2}}C \\\\ \\partial_{x_{3}}C \\\\ \\partial_{x_{4}}C \\end{pmatrix}.\n$$\nMultiplying out the first three rows of $\\Pi(x)\\nabla C(x)$ yields\n\\begin{align*}\nx_{3}\\,\\partial_{x_{2}}C \\;-\\; x_{2}\\,\\partial_{x_{3}}C \\;&=\\; 0, \\\\\n-x_{3}\\,\\partial_{x_{1}}C \\;+\\; x_{1}\\,\\partial_{x_{3}}C \\;&=\\; 0, \\\\\nx_{2}\\,\\partial_{x_{1}}C \\;-\\; x_{1}\\,\\partial_{x_{2}}C \\;&=\\; 0,\n\\end{align*}\nand the fourth row is identically $0=0$, imposing no constraint on $\\partial_{x_{4}}C$.\n\nIt is illuminating to rewrite the system for the first three components using vector calculus. Let $x_{\\mathrm{so}} = (x_{1}, x_{2}, x_{3}) \\in \\mathbb{R}^{3}$ and $g = (\\partial_{x_{1}}C, \\partial_{x_{2}}C, \\partial_{x_{3}}C) \\in \\mathbb{R}^{3}$. The $\\mathfrak{so}(3)$ Poisson matrix acting on $g$ is precisely the cross product $x_{\\mathrm{so}} \\times g$. Indeed, the skew-symmetric matrix\n$$\nA(x_{\\mathrm{so}}) \\;=\\; \\begin{pmatrix} 0 & x_{3} & -x_{2} \\\\ -x_{3} & 0 & x_{1} \\\\ x_{2} & -x_{1} & 0 \\end{pmatrix}\n$$\nsatisfies $A(x_{\\mathrm{so}})g = x_{\\mathrm{so}}\\times g$. Thus the PDE system for the first three components is equivalent to\n$$\nx_{\\mathrm{so}} \\times g \\;=\\; 0,\n$$\nwhich implies that $g$ is parallel to $x_{\\mathrm{so}}$. That is, there exists a scalar function $\\lambda(x)$ such that\n$$\n\\begin{pmatrix} \\partial_{x_{1}}C \\\\ \\partial_{x_{2}}C \\\\ \\partial_{x_{3}}C \\end{pmatrix}\n\\;=\\;\n\\lambda(x)\\,\\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix}.\n$$\nThis necessary and sufficient condition expresses the fact that the gradient of $C$ in the $\\mathfrak{so}(3)$ variables is radial. To integrate this condition, define the rotationally invariant squared radius\n$$\ns \\;=\\; x_{1}^{2} + x_{2}^{2} + x_{3}^{2}.\n$$\nLet $G$ be any smooth function and consider $C(x) = G\\big(s, x_{4}\\big)$. Then by the chain rule,\n$$\n\\partial_{x_{i}}C \\;=\\; \\frac{\\partial G}{\\partial s}\\cdot \\partial_{x_{i}}s \\;=\\; \\frac{\\partial G}{\\partial s}\\cdot 2x_{i}, \\quad i=1,2,3,\n$$\nso $g = 2\\frac{\\partial G}{\\partial s}\\,x_{\\mathrm{so}}$ is indeed parallel to $x_{\\mathrm{so}}$, making $x_{\\mathrm{so}}\\times g = 0$. Moreover, the fourth component is unconstrained by the PDE, so $C$ may depend arbitrarily on $x_{4}$ via the function $G$. Hence the general solution set of Casimirs is\n$$\nC(x) \\;=\\; \\widetilde{G}\\big(x_{1}^{2}+x_{2}^{2}+x_{3}^{2},\\,x_{4}\\big)\n$$\nfor an arbitrary smooth function $\\widetilde{G}$. A complete set of functionally independent generators is obtained by choosing\n$$\nC_{1}(x) \\;=\\; x_{1}^{2} + x_{2}^{2} + x_{3}^{2}, \\qquad C_{2}(x) \\;=\\; x_{4}.\n$$\nAny Casimir is then a smooth function of $C_{1}$ and $C_{2}$.\n\nWe now explain, from first principles of geometric mechanics and interconnection via Dirac structures, how these Casimirs influence interconnection. A Dirac structure on a manifold $\\mathcal{M}$ is a maximally isotropic, integrable subbundle $L \\subset T\\mathcal{M} \\oplus T^{*}\\mathcal{M}$ with respect to the symmetric pairing $\\langle (v,\\alpha),(w,\\beta)\\rangle = \\beta(v) + \\alpha(w)$. In the Port-Hamiltonian (PH) framework, an open Hamiltonian system is described by a Dirac structure that encodes power-conserving interconnection of storage elements and ports, and the dynamics satisfy $(\\dot{x}, \\mathrm{d}H(x)) \\in L(x)$ for a given Hamiltonian $H$.\n\nFor a Poisson system, the image of the Poisson map $\\Pi^{\\sharp}: T^{*}\\mathcal{M} \\to T\\mathcal{M}$ defines the characteristic distribution tangent to the symplectic leaves, given by the common level sets of the Casimir functions. Specifically, for our $\\Pi$, the leaves are the products of spheres in $(x_{1},x_{2},x_{3})$ with the lines in $x_{4}$: the invariants $C_{1}$ and $C_{2}$ stay constant along any Hamiltonian flow $\\dot{x} = \\Pi\\nabla H$. When interconnecting two PH subsystems via a power-conserving Dirac structure, the composition of Dirac structures yields a new Dirac structure whose characteristic distribution contains the sum of the individual characteristic distributions (modulo constraints imposed by the interconnection). Because interconnection is power-conserving and respects the underlying geometric constraints ($(\\dot{x},\\mathrm{d}H) \\in L$), the flows remain tangent to the common symplectic leaves of the interconnected structure. Thus:\n- The invariants $C_{1}$ and $C_{2}$ constrain the reachable set of the interconnected system to manifolds defined by fixed values of these Casimirs.\n- Equilibria of the interconnected system are organized on the equilibrium manifolds defined by the Energy–Casimir method: critical points of $H$ restricted to the leaves $\\{C_{1}=\\mathrm{const},\\,C_{2}=\\mathrm{const}\\}$.\n- If interconnection couples only port variables and does not modify the Poisson tensor in directions orthogonal to the kernel of $\\Pi$, then the Casimirs persist; any shaping via interconnection adjusts the energy landscape on leaves but cannot break invariants defined by Casimirs without altering the Dirac structure itself to change the characteristic distribution.\n\nTherefore, for the given $\\Pi$, the functionally independent Casimirs are $C_{1} = x_{1}^{2}+x_{2}^{2}+x_{3}^{2}$ and $C_{2} = x_{4}$, and any interconnection via a power-conserving Dirac structure respects these invariants by keeping trajectories confined to their joint level sets.",
            "answer": "$$\\boxed{\\begin{pmatrix} x_{1}^{2} + x_{2}^{2} + x_{3}^{2} \\; & \\; x_{4} \\end{pmatrix}}$$"
        },
        {
            "introduction": "The true power of the geometric framework for Hamiltonian systems is revealed in its practical applications, especially in the design of numerical algorithms. This final exercise demonstrates how the concept of a Dirac structure can be discretized to create structure-preserving numerical integrators. You will analyze a \"discrete Dirac\" integrator—equivalent to the implicit midpoint rule—and compare its energy conservation properties for a harmonic oscillator against the standard Symplectic Euler method.  This comparison powerfully illustrates why geometric integrators are essential for long-term, physically faithful simulations.",
            "id": "3749230",
            "problem": "Consider a linear port-Hamiltonian system with state $x = (q,p) \\in \\mathbb{R}^{2}$, Hamiltonian $H(q,p) = \\frac{1}{2m}p^{2} + \\frac{k}{2}q^{2}$ with $m>0$ and $k>0$, and canonical interconnection matrix $J = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$. The continuous-time dynamics is given by the power-preserving interconnection relation $\\dot{x} = J \\nabla H(x)$, which realizes the Dirac structure $\\mathcal{D} = \\{(f,e) \\mid f = J e\\}$ on $\\mathbb{R}^{2} \\times \\mathbb{R}^{2}$, where $f = \\dot{x}$ is the flow and $e = \\nabla H(x)$ is the effort.\n\nDefine the discrete Dirac integrator by enforcing the discrete interconnection constraint at the midpoint:\n$$\n\\frac{x_{1} - x_{0}}{h} = J \\nabla H\\!\\left( \\frac{x_{1} + x_{0}}{2} \\right),\n$$\nwith time-step $h>0$, where $x_{0} = (q_{0},p_{0})$ and $x_{1} = (q_{1},p_{1})$ denote successive states. In parallel, consider the Symplectic Euler (SE) method in its canonical partitioned form:\n$$\nq_{1} = q_{0} + \\frac{h}{m}p_{0}, \\quad p_{1} = p_{0} - hk\\, q_{1}.\n$$\n\nStarting from the definitions of the Dirac structure and the Hamiltonian vector field, derive the one-step update of the discrete Dirac integrator in closed form and compute the one-step energy increment $\\Delta H_{\\mathrm{Dirac}} = H(q_{1},p_{1}) - H(q_{0},p_{0})$. Then compute the one-step energy increment for Symplectic Euler, $\\Delta H_{\\mathrm{SE}} = H(q_{1},p_{1}) - H(q_{0},p_{0})$, using the update above. Express your final answer as a single closed-form analytical expression for the difference $\\Delta H_{\\mathrm{SE}} - \\Delta H_{\\mathrm{Dirac}}$ in terms of $h$, $m$, $k$, $q_{0}$, and $p_{0}$.\n\nNo numerical rounding is required. The final answer must be a single analytical expression.",
            "solution": "The problem asks for the difference in one-step energy increment between the discrete Dirac integrator (implicit midpoint rule) and the Symplectic Euler method for a harmonic oscillator.\n\nFirst, let's analyze the **Discrete Dirac Integrator**. The integrator is defined by the midpoint rule:\n$$\n\\frac{x_{1} - x_{0}}{h} = J \\nabla H\\left( \\frac{x_{1} + x_{0}}{2} \\right)\n$$\nThe Hamiltonian is a quadratic function of the state $x=(q,p)$, which can be written as $H(x) = \\frac{1}{2} x^T M x$, with $M = \\begin{pmatrix} k & 0 \\\\ 0 & 1/m \\end{pmatrix}$. The gradient is therefore linear: $\\nabla H(x) = M x$.\nThe energy increment is $\\Delta H_{\\mathrm{Dirac}} = H(x_1) - H(x_0)$. To find this, we take the inner product of the integrator equation with the average gradient, $(\\nabla H(\\frac{x_1+x_0}{2}))^T$:\n$$\n\\left(\\nabla H\\left(\\frac{x_1+x_0}{2}\\right)\\right)^T \\frac{x_1 - x_0}{h} = \\left(\\nabla H\\left(\\frac{x_1+x_0}{2}\\right)\\right)^T J \\nabla H\\left(\\frac{x_1+x_0}{2}\\right)\n$$\nSince $J$ is skew-symmetric ($J^T = -J$), the quadratic form on the right-hand side is zero for any vector. Thus,\n$$\n\\left(\\nabla H\\left(\\frac{x_1+x_0}{2}\\right)\\right)^T (x_1 - x_0) = 0\n$$\nSubstituting the expression for the gradient, $\\nabla H(x) = M x$:\n$$\n\\left(M \\frac{x_1 + x_0}{2}\\right)^T (x_1 - x_0) = 0 \\implies \\frac{1}{2}(x_1^T + x_0^T)M^T(x_1-x_0) = 0\n$$\nSince $M$ is symmetric ($M^T = M$), this expands to:\n$$\nx_1^T M x_1 - x_1^T M x_0 + x_0^T M x_1 - x_0^T M x_0 = 0\n$$\nThe middle terms cancel because $x_0^T M x_1 = (x_0^T M x_1)^T = x_1^T M^T x_0 = x_1^T M x_0$. This leaves:\n$$\nx_1^T M x_1 - x_0^T M x_0 = 0 \\implies \\frac{1}{2}x_1^T M x_1 - \\frac{1}{2}x_0^T M x_0 = 0\n$$\nThis is equivalent to $H(x_1) - H(x_0) = 0$. Therefore, for this quadratic Hamiltonian, the discrete Dirac integrator exactly conserves energy:\n$$\n\\Delta H_{\\mathrm{Dirac}} = 0\n$$\n\nNext, we analyze the **Symplectic Euler (SE) method**. The update rules are:\n$$\nq_1 = q_0 + \\frac{h}{m} p_0\n$$\n$$\np_1 = p_0 - h k q_1 = p_0 - hk\\left(q_0 + \\frac{h}{m}p_0\\right) = \\left(1 - \\frac{h^2k}{m}\\right)p_0 - hkq_0\n$$\nThe energy increment is $\\Delta H_{\\mathrm{SE}} = H(q_1, p_1) - H(q_0, p_0) = \\frac{k}{2}(q_1^2 - q_0^2) + \\frac{1}{2m}(p_1^2 - p_0^2)$.\nLet's compute the two parts of the increment:\n$$\n\\frac{k}{2}(q_1^2 - q_0^2) = \\frac{k}{2}\\left(\\left(q_0 + \\frac{h}{m}p_0\\right)^2 - q_0^2\\right) = \\frac{k}{2}\\left(\\frac{2h}{m}q_0p_0 + \\frac{h^2}{m^2}p_0^2\\right) = \\frac{kh}{m}q_0p_0 + \\frac{kh^2}{2m^2}p_0^2\n$$\n$$\n\\frac{1}{2m}(p_1^2 - p_0^2) = \\frac{1}{2m}\\left(\\left(\\left(1 - \\frac{h^2k}{m}\\right)p_0 - hkq_0\\right)^2 - p_0^2\\right)\n$$\n$$\n= \\frac{1}{2m}\\left( \\left(1 - \\frac{h^2k}{m}\\right)^2 p_0^2 - 2hkq_0\\left(1 - \\frac{h^2k}{m}\\right)p_0 + h^2k^2q_0^2 - p_0^2 \\right)\n$$\n$$\n= \\frac{1}{2m}\\left( \\left(1-\\frac{2h^2k}{m}+\\frac{h^4k^2}{m^2}\\right)p_0^2 - 2hkq_0p_0 + \\frac{2h^3k^2}{m}q_0p_0 + h^2k^2q_0^2 - p_0^2 \\right)\n$$\n$$\n= \\frac{1}{2m}\\left( \\left(-\\frac{2h^2k}{m}+\\frac{h^4k^2}{m^2}\\right)p_0^2 - 2hkq_0p_0 + \\frac{2h^3k^2}{m}q_0p_0 + h^2k^2q_0^2 \\right)\n$$\n$$\n= \\left(-\\frac{h^2k}{m^2}+\\frac{h^4k^2}{2m^3}\\right)p_0^2 - \\frac{hk}{m}q_0p_0 + \\frac{h^3k^2}{m^2}q_0p_0 + \\frac{h^2k^2}{2m}q_0^2\n$$\nSumming the two parts, the term $\\frac{kh}{m}q_0p_0$ cancels with $-\\frac{hk}{m}q_0p_0$:\n$$\n\\Delta H_{\\mathrm{SE}} = \\left(\\frac{kh^2}{2m^2}\\right)p_0^2 + \\left(-\\frac{h^2k}{m^2}+\\frac{h^4k^2}{2m^3}\\right)p_0^2 + \\frac{h^2k^2}{2m}q_0^2 + \\frac{h^3k^2}{m^2}q_0p_0\n$$\n$$\n\\Delta H_{\\mathrm{SE}} = \\frac{h^2k^2}{2m}q_0^2 + \\frac{h^3k^2}{m^2}q_0p_0 + \\left(\\frac{kh^2}{2m^2} - \\frac{h^2k}{m^2} + \\frac{h^4k^2}{2m^3}\\right)p_0^2\n$$\n$$\n\\Delta H_{\\mathrm{SE}} = \\frac{h^2k^2}{2m}q_0^2 + \\frac{h^3k^2}{m^2}q_0p_0 + \\left(\\frac{h^4k^2}{2m^3} - \\frac{h^2k}{2m^2}\\right)p_0^2\n$$\nFinally, the difference in energy increments is:\n$$\n\\Delta H_{\\mathrm{SE}} - \\Delta H_{\\mathrm{Dirac}} = \\Delta H_{\\mathrm{SE}} - 0 = \\frac{h^2k^2}{2m}q_0^2 + \\frac{h^3k^2}{m^2}q_0p_0 + \\left(\\frac{h^4k^2}{2m^3} - \\frac{h^2k}{2m^2}\\right)p_0^2\n$$\nThis completes the derivation.",
            "answer": "$$\n\\boxed{\\frac{h^2k^2}{2m}q_0^2 + \\frac{h^3k^2}{m^2}q_0p_0 + \\left(\\frac{h^4k^2}{2m^3} - \\frac{h^2k}{2m^2}\\right)p_0^2}\n$$"
        }
    ]
}