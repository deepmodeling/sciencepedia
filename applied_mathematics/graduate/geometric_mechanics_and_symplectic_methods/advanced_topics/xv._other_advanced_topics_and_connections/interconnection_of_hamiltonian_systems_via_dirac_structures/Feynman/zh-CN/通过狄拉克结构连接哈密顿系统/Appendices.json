{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始。这个实践将直接应用狄拉克结构的定义——即一个极大迷向子空间——到一个具体的例子中。通过直接计算维数和检验迷向性，这个练习有助于将抽象的代数定义具体化，是建立几何直觉的关键第一步。",
            "id": "3749210",
            "problem": "考虑向量空间 $X=\\mathbb{R}^{4}$ 及其对偶空间 $X^{*}=(\\mathbb{R}^{4})^{*}$。在 $X\\oplus X^{*}$ 上的对称双线性配对定义为 $\\langle (v,\\alpha),(w,\\beta)\\rangle=\\alpha(w)+\\beta(v)$，对所有 $(v,\\alpha),(w,\\beta)\\in X\\oplus X^{*}$ 成立。在通过狄拉克结构互联哈密顿子系统的背景下，取由以下矩阵关系给出的常数子空间 $D\\subset X\\oplus X^{*}$\n$$\nGv=0,\\qquad \\alpha=Jv+G^{\\top}\\mu,\n$$\n其中 $v\\in\\mathbb{R}^{4}$，$\\alpha\\in(\\mathbb{R}^{4})^{*}$，且 $\\mu\\in\\mathbb{R}^{2}$，以及\n$$\nJ=\\begin{pmatrix}\n0  1  0  0\\\\\n-1  0  0  0\\\\\n0  0  0  2\\\\\n0  0  -2  0\n\\end{pmatrix},\\qquad\nG=\\begin{pmatrix}\n1  0  -1  0\\\\\n0  1  0  1\n\\end{pmatrix}.\n$$\n仅使用狄拉克结构作为 $X\\oplus X^{*}$ 关于上述配对的最大迷向子空间的基本定义，判断 $D$ 是否为最大迷向子空间，并计算其维数。将你的最终答案表示为一个行矩阵 $\\begin{pmatrix}d  \\chi\\end{pmatrix}$，其中 $d$ 是 $D$ 的维数，如果 $D$ 是最大迷向的，则 $\\chi$ 等于 $1$，否则等于 $0$。",
            "solution": "问题要求我们判断 $X \\oplus X^*$ 的一个给定子空间 $D$ 是否为狄拉克结构，根据定义，狄拉克结构是一个最大迷向子空间。给定 $X=\\mathbb{R}^{4}$，其对偶空间 $X^{*}$ 可等同于 $\\mathbb{R}^{4}$。环境空间是 $X \\oplus X^{*} \\cong \\mathbb{R}^{4} \\oplus \\mathbb{R}^{4} = \\mathbb{R}^{8}$。对称双线性配对由 $\\langle (v,\\alpha),(w,\\beta)\\rangle=\\alpha(w)+\\beta(v)$ 给出。将对偶向量等同于列向量，该配对为 $\\langle (v,\\alpha),(w,\\beta)\\rangle=\\alpha^{\\top}w+\\beta^{\\top}v$。\n\n一个子空间 $D$ 是**迷向的** (isotropic)，如果对于 $D$ 中的任意两个元素 $d_1, d_2$，它们的配对为零：$\\langle d_1, d_2 \\rangle = 0$。这等价于条件 $D \\subseteq D^{\\perp}$。\n一个子空间 $D$ 是**最大迷向的** (maximally isotropic)，如果它是迷向的，并且其维数是环境空间维数的一半。在本例中，$\\dim(X \\oplus X^{*}) = \\dim(\\mathbb{R}^{4}) + \\dim((\\mathbb{R}^{4})^{*}) = 4+4=8$。因此，如果 $D$ 是迷向的且 $\\dim(D) = \\frac{1}{2} \\dim(X \\oplus X^{*}) = \\frac{8}{2} = 4$，则 $D$ 是最大迷向的。这样的子空间满足 $D = D^{\\perp}$。\n\n子空间 $D$ 由满足以下条件的点对 $(v,\\alpha) \\in \\mathbb{R}^{4} \\oplus (\\mathbb{R}^{4})^{*}$ 的集合定义：\n$1$. $Gv=0$\n$2$. $\\alpha=Jv+G^{\\top}\\mu$ 对于某个 $\\mu\\in\\mathbb{R}^{2}$。\n\n这里，$v \\in \\mathbb{R}^{4}$，$\\alpha \\in (\\mathbb{R}^{4})^{*} \\cong \\mathbb{R}^{4}$，矩阵为：\n$$\nJ=\\begin{pmatrix}\n0  1  0  0\\\\\n-1  0  0  0\\\\\n0  0  0  2\\\\\n0  0  -2  0\n\\end{pmatrix},\\qquad\nG=\\begin{pmatrix}\n1  0  -1  0\\\\\n0  1  0  1\n\\end{pmatrix}.\n$$\n\n分析分为两个主要步骤：首先，我们计算 $D$ 的维数，记为 $d$；其次，我们检查 $D$ 是否是迷向的。\n\n**步骤 1：计算 $D$ 的维数**\n\n条件 $Gv=0$ 意味着 $v$ 必须属于由矩阵 $G$ 表示的线性变换的零空间（核）。矩阵 $G$ 是一个 $2 \\times 4$ 矩阵。其行向量为 $(1, 0, -1, 0)$ 和 $(0, 1, 0, 1)$，它们是线性无关的。因此，$G$ 的秩为 $\\text{rank}(G)=2$。\n根据秩-零度定理，$G$ 的零空间的维数由下式给出：\n$$\n\\dim(\\ker(G)) = \\dim(\\mathbb{R}^{4}) - \\text{rank}(G) = 4 - 2 = 2.\n$$\n我们称该子空间为 $V_G = \\ker(G)$，所以 $\\dim(V_G)=2$。\n\n$D$ 的元素是点对 $(v, \\alpha)$，其中 $v \\in V_G$ 且 $\\alpha$ 的形式为 $Jv + G^{\\top}\\mu$，对于某个 $\\mu \\in \\mathbb{R}^{2}$。\n考虑线性映射 $\\Phi: V_G \\oplus \\mathbb{R}^{2} \\to \\mathbb{R}^{4} \\oplus \\mathbb{R}^{4}$，定义为\n$$\n\\Phi(v, \\mu) = (v, Jv + G^{\\top}\\mu).\n$$\n该映射的像恰好是子空间 $D$。$D$ 的维数是 $\\Phi$ 的像的维数，它等于定义域的维数减去 $\\Phi$ 的核的维数。\n我们来求 $\\Phi$ 的核。我们寻找 $(v, \\mu) \\in V_G \\oplus \\mathbb{R}^{2}$ 使得 $\\Phi(v, \\mu) = (0, 0)$。\n这蕴含了两个条件：\n$1$. $v=0$。\n$2$. $Jv + G^{\\top}\\mu = 0$。\n\n将第一个条件 $v=0$ 代入第二个条件，得到 $G^{\\top}\\mu = 0$。\n矩阵 $G^{\\top}$ 是一个 $4 \\times 2$ 矩阵：\n$$\nG^{\\top} = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n-1  0 \\\\\n0  1\n\\end{pmatrix}.\n$$\n$G^{\\top}$ 的列向量是 $(1, 0, -1, 0)^{\\top}$ 和 $(0, 1, 0, 1)^{\\top}$。这两个向量是线性无关的。因此，$G^{\\top}\\mu = 0$ 的唯一解是 $\\mu = 0 \\in \\mathbb{R}^{2}$。\n因此，$\\Phi$ 的核是 $\\{(0,0)\\}$，其维数为 $0$。这意味着映射 $\\Phi$ 是单射的。\n由于 $\\Phi$ 是从 $V_G \\oplus \\mathbb{R}^{2}$ 到 $D$ 的一个单射线性映射，它是这两个空间之间的一个同构。因此，它们的维数相等：\n$$\nd = \\dim(D) = \\dim(V_G \\oplus \\mathbb{R}^{2}) = \\dim(V_G) + \\dim(\\mathbb{R}^{2}) = 2 + 2 = 4.\n$$\n子空间 $D$ 的维数是 $d=4$。\n\n**步骤 2：检查迷向性**\n\n为检查 $D$ 是否是迷向的，我们必须验证对于 $D$ 中的任意两个元素 $d_1, d_2$，都有 $\\langle d_1, d_2 \\rangle = 0$。\n设 $d_1 = (v_1, \\alpha_1)$ 和 $d_2 = (v_2, \\alpha_2)$ 是 $D$ 中的两个任意元素。\n根据 $D$ 的定义，我们有：\n$Gv_1 = 0$ 且 $\\alpha_1 = Jv_1 + G^{\\top}\\mu_1$ 对于某个 $\\mu_1 \\in \\mathbb{R}^{2}$。\n$Gv_2 = 0$ 且 $\\alpha_2 = Jv_2 + G^{\\top}\\mu_2$ 对于某个 $\\mu_2 \\in \\mathbb{R}^{2}$。\n\n现在我们计算配对，将 $(\\mathbb{R}^4)^*$ 中的向量等同于 $\\mathbb{R}^4$ 中的向量：\n$$\n\\langle d_1, d_2 \\rangle = \\alpha_1^{\\top}v_2 + \\alpha_2^{\\top}v_1.\n$$\n代入 $\\alpha_1$ 和 $\\alpha_2$ 的表达式：\n$$\n\\langle d_1, d_2 \\rangle = (Jv_1 + G^{\\top}\\mu_1)^{\\top}v_2 + (Jv_2 + G^{\\top}\\mu_2)^{\\top}v_1.\n$$\n使用性质 $(A+B)^{\\top} = A^{\\top} + B^{\\top}$ 和 $(AB)^{\\top} = B^{\\top}A^{\\top}$：\n$$\n\\langle d_1, d_2 \\rangle = (v_1^{\\top}J^{\\top} + \\mu_1^{\\top}G)v_2 + (v_2^{\\top}J^{\\top} + \\mu_2^{\\top}G)v_1.\n$$\n展开各项：\n$$\n\\langle d_1, d_2 \\rangle = v_1^{\\top}J^{\\top}v_2 + \\mu_1^{\\top}Gv_2 + v_2^{\\top}J^{\\top}v_1 + \\mu_2^{\\top}Gv_1.\n$$\n因为 $v_1, v_2 \\in \\ker(G)$，我们有 $Gv_1 = 0$ 和 $Gv_2 = 0$。表达式简化为：\n$$\n\\langle d_1, d_2 \\rangle = v_1^{\\top}J^{\\top}v_2 + v_2^{\\top}J^{\\top}v_1.\n$$\n我们来考察矩阵 $J$。它的转置是：\n$$\nJ^{\\top} = \\begin{pmatrix}\n0  -1  0  0\\\\\n1  0  0  0\\\\\n0  0  0  -2\\\\\n0  0  2  0\n\\end{pmatrix} = -J.\n$$\n所以，$J$ 是一个斜对称矩阵。将 $J^{\\top}=-J$ 代入配对表达式中得到：\n$$\n\\langle d_1, d_2 \\rangle = v_1^{\\top}(-J)v_2 + v_2^{\\top}(-J)v_1 = -v_1^{\\top}Jv_2 - v_2^{\\top}Jv_1.\n$$\n项 $v_2^{\\top}Jv_1$ 是一个标量（$1 \\times 1$ 矩阵），所以它等于其自身的转置：\n$$\nv_2^{\\top}Jv_1 = (v_2^{\\top}Jv_1)^{\\top} = v_1^{\\top}J^{\\top}v_2 = v_1^{\\top}(-J)v_2 = -v_1^{\\top}Jv_2.\n$$\n将此代回配对的表达式中：\n$$\n\\langle d_1, d_2 \\rangle = -v_1^{\\top}Jv_2 - (-v_1^{\\top}Jv_2) = -v_1^{\\top}Jv_2 + v_1^{\\top}Jv_2 = 0.\n$$\n因为这对 $D$ 中的任意两个元素 $d_1, d_2$ 都成立，所以子空间 $D$ 是迷向的。\n\n**关于最大迷向性的结论**\n\n我们已经确定了两个事实：\n$1$. $D$ 的维数是 $d=4$。\n$2$. 子空间 $D$ 是迷向的。\n\n总空间的维数是 $\\dim(X \\oplus X^{*}) = 8$。一个子空间是最大迷向的，如果它是迷向的，并且其维数是环境空间维数的一半。这里，$\\dim(D) = 4 = \\frac{1}{2}\\dim(X \\oplus X^{*})$。\n因此，$D$ 是一个最大迷向子空间。根据定义，这意味着 $D$ 是一个狄拉克结构。\n\n问题要求最终答案以行矩阵 $\\begin{pmatrix} d  \\chi \\end{pmatrix}$ 的形式给出，其中 $d$ 是 $D$ 的维数，$\\chi$ 是一个指示变量，如果 $D$ 是最大迷向的，则 $\\chi=1$，否则 $\\chi=0$。\n根据我们的分析：\n$d = \\dim(D) = 4$。\n由于 $D$ 是最大迷向的，所以 $\\chi = 1$。\n\n最终结果是行矩阵 $\\begin{pmatrix} 4 & 1 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在验证了基本属性之后，我们现在来探讨系统内部结构（特别是其简并性）所带来的推论。这个实践将要求我们找到卡西米尔函数，这些函数是由泊松结构的简并性产生的守恒量。理解这些不变量至关重要，因为它们对系统的动力学行为以及它如何与其他系统互联施加了基本约束。",
            "id": "3749205",
            "problem": "考虑流形 $\\mathbb{R}^{4}$，其坐标为 $x = (x_{1}, x_{2}, x_{3}, x_{4})$，并带有一个由矩阵定义的退化泊松结构\n$$\n\\Pi(x) \\;=\\;\n\\begin{pmatrix}\n0  x_{3}  -x_{2}  0 \\\\\n-x_{3}  0  x_{1}  0 \\\\\nx_{2}  -x_{1}  0  0 \\\\\n0  0  0  0\n\\end{pmatrix}.\n$$\n该结构是三维特殊正交李代数 $\\mathfrak{so}(3)$ 对偶空间 $\\mathfrak{so}(3)^{*}$ 上的李-泊松结构与一条直线上的平凡泊松结构的直积。\n\n利用通过泊松张量定义的泊松括号以及卡西米尔函数 $C$ 满足 $\\Pi(x)\\nabla C(x) = 0$ 的特征，通过求解一阶偏微分方程 (PDE) 组 $\\Pi\\nabla C = 0$ 来计算 $\\Pi$ 的一组完备的函数无关的卡西米尔函数。将最终答案表示为两个多项式代表，所有卡西米尔函数都可以表示为它们的平滑函数。\n\n然后，从狄拉克结构（Dirac structure）是关于自然配对的最大迷向、可积子丛 $L \\subset T\\mathcal{M} \\oplus T^{*}\\mathcal{M}$ 的定义出发，解释这些卡西米尔函数如何通过一个功率守恒的狄拉克结构（端口-哈密顿 (PH) 互联）来约束该哈密顿子系统与另一个子系统的互联，特别是在可达集和平衡流形方面。在第二部分中不要进行任何数值计算。\n\n您的最终答案必须是以符号形式表示的一对函数无关的卡西米尔函数，使用 pmatrix 环境写成一个单行矩阵。无需四舍五入，也不涉及物理单位。",
            "solution": "我们从泊松流形和卡西米尔函数的基本定义开始。流形 $\\mathcal{M}$ 上的泊松结构由一个双向量场（泊松张量）$\\Pi$ 给出，它在光滑函数上定义了一个括号 $\\{f,g\\} = \\nabla f^{\\top}\\Pi\\nabla g$，哈密顿量 $H$ 的动力学为 $\\dot{x} = \\Pi(x)\\nabla H(x)$。卡西米尔函数 $C$ 是一个位于泊松代数中心的函数，即对所有光滑函数 $f$ 都有 $\\{C,f\\}=0$，这等价于 $\\Pi(x)\\nabla C(x) = 0$。\n\n在本例中，泊松矩阵为\n$$\n\\Pi(x) \\;=\\;\n\\begin{pmatrix}\n0  x_{3}  -x_{2}  0 \\\\\n-x_{3}  0  x_{1}  0 \\\\\nx_{2}  -x_{1}  0  0 \\\\\n0  0  0  0\n\\end{pmatrix},\n$$\n因此卡西米尔偏微分方程为\n$$\n\\Pi(x)\\nabla C(x) \\;=\\; 0.\n$$\n我们将 $C$ 的梯度记为\n$$\n\\nabla C(x) \\;=\\; \\begin{pmatrix} \\partial_{x_{1}}C \\\\ \\partial_{x_{2}}C \\\\ \\partial_{x_{3}}C \\\\ \\partial_{x_{4}}C \\end{pmatrix}.\n$$\n将 $\\Pi(x)\\nabla C(x)$ 的前三行展开，得到\n\\begin{align*}\nx_{3}\\,\\partial_{x_{2}}C \\;-\\; x_{2}\\,\\partial_{x_{3}}C \\;=\\; 0, \\\\\n-x_{3}\\,\\partial_{x_{1}}C \\;+\\; x_{1}\\,\\partial_{x_{3}}C \\;=\\; 0, \\\\\nx_{2}\\,\\partial_{x_{1}}C \\;-\\; x_{1}\\,\\partial_{x_{2}}C \\;=\\; 0,\n\\end{align*}\n而第四行恒为 $0=0$，不对 $\\partial_{x_{4}}C$ 施加任何约束。\n\n使用向量微积分重写前三个分量的方程组是很有启发性的。令 $x_{\\mathrm{so}} = (x_{1}, x_{2}, x_{3}) \\in \\mathbb{R}^{3}$ 且 $g = (\\partial_{x_{1}}C, \\partial_{x_{2}}C, \\partial_{x_{3}}C) \\in \\mathbb{R}^{3}$。作用于 $g$ 的 $\\mathfrak{so}(3)$ 泊松矩阵恰好是叉积 $x_{\\mathrm{so}} \\times g$。实际上，斜对称矩阵\n$$\nA(x_{\\mathrm{so}}) \\;=\\; \\begin{pmatrix} 0  x_{3}  -x_{2} \\\\ -x_{3}  0  x_{1} \\\\ x_{2}  -x_{1}  0 \\end{pmatrix}\n$$\n满足 $A(x_{\\mathrm{so}})g = x_{\\mathrm{so}}\\times g$。因此，前三个分量的偏微分方程组等价于\n$$\nx_{\\mathrm{so}} \\times g \\;=\\; 0,\n$$\n这意味着 $g$ 与 $x_{\\mathrm{so}}$ 平行。也就是说，存在一个标量函数 $\\lambda(x)$ 使得\n$$\n\\begin{pmatrix} \\partial_{x_{1}}C \\\\ \\partial_{x_{2}}C \\\\ \\partial_{x_{3}}C \\end{pmatrix}\n\\;=\\;\n\\lambda(x)\\,\\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix}.\n$$\n这个充要条件表明，$C$ 在 $\\mathfrak{so}(3)$ 变量中的梯度是径向的。为了对这个条件进行积分，我们定义旋转不变的半径平方\n$$\ns \\;=\\; x_{1}^{2} + x_{2}^{2} + x_{3}^{2}.\n$$\n令 $G$ 为任意光滑函数，并考虑 $C(x) = G\\big(s, x_{4}\\big)$。根据链式法则，\n$$\n\\partial_{x_{i}}C \\;=\\; \\frac{\\partial G}{\\partial s}\\cdot \\partial_{x_{i}}s \\;=\\; \\frac{\\partial G}{\\partial s}\\cdot 2x_{i}, \\quad i=1,2,3,\n$$\n所以 $g = 2\\frac{\\partial G}{\\partial s}\\,x_{\\mathrm{so}}$ 确实与 $x_{\\mathrm{so}}$ 平行，使得 $x_{\\mathrm{so}}\\times g = 0$。此外，第四个分量不受偏微分方程的约束，因此 $C$ 可以通过函数 $G$ 任意地依赖于 $x_{4}$。因此，卡西米尔函数的通解集为\n$$\nC(x) \\;=\\; \\widetilde{G}\\big(x_{1}^{2}+x_{2}^{2}+x_{3}^{2},\\,x_{4}\\big)\n$$\n其中 $\\widetilde{G}$ 是一个任意光滑函数。通过选择\n$$\nC_{1}(x) \\;=\\; x_{1}^{2} + x_{2}^{2} + x_{3}^{2}, \\qquad C_{2}(x) \\;=\\; x_{4}\n$$\n可以得到一组完备的函数无关的生成元。任何卡西米尔函数都是 $C_{1}$ 和 $C_{2}$ 的光滑函数。\n\n现在我们从几何力学的第一性原理以及通过狄拉克结构的互联出发，解释这些卡西米尔函数如何影响互联。流形 $\\mathcal{M}$ 上的狄拉克结构是一个关于对称配对 $\\langle (v,\\alpha),(w,\\beta)\\rangle = \\beta(v) + \\alpha(w)$ 的最大迷向、可积子丛 $L \\subset T\\mathcal{M} \\oplus T^{*}\\mathcal{M}$。在端口-哈密顿 (PH) 框架中，一个开放哈密顿系统由一个狄拉克结构描述，该结构编码了储能元件和端口的功率守恒互联，并且对于哈密顿量 $H$，其动力学满足 $(\\dot{x}, \\mathrm{d}H(x)) \\in L(x)$。\n\n对于一个泊松系统，泊松映射 $\\Pi^{\\sharp}: T^{*}\\mathcal{M} \\to T\\mathcal{M}$ 的像定义了与辛叶相切的特征分布，这些辛叶由卡西米尔函数的公共水平集给出。具体来说，对于我们的 $\\Pi$，叶是 $(x_{1},x_{2},x_{3})$ 中的球面与 $x_{4}$ 中的直线的乘积：不变量 $C_{1}$ 和 $C_{2}$ 沿着任何哈密顿流 $\\dot{x} = \\Pi\\nabla H$ 保持恒定。当通过一个功率守恒的狄拉克结构互联两个 PH 子系统时，狄拉克结构的复合会产生一个新的狄拉克结构，其特征分布包含各个特征分布的和（模去互联施加的约束）。因为互联是功率守恒的并且遵守底层的几何约束（$(\\dot{x},\\mathrm{d}H) \\in L$），所以流仍然与互联结构的公共辛叶相切。因此：\n- 不变量 $C_{1}$ 和 $C_{2}$ 将互联系统的可达集约束到由这些卡西米尔函数的固定值定义的流形上。\n- 互联系统的平衡点组织在由能量-卡西米尔方法定义的平衡流形上：即 $H$ 限制在叶 $\\{C_{1}=\\mathrm{const},\\,C_{2}=\\mathrm{const}\\}$ 上的临界点。\n- 如果互联仅耦合端口变量，并且不改变泊松张量在与 $\\Pi$ 的核正交方向上的分量，那么卡西米尔函数将保持不变；任何通过互联进行的整形都会调整叶上的能量景观，但如果不改变狄拉克结构本身以改变特征分布，就无法破坏由卡西米尔函数定义的不变量。\n\n因此，对于给定的 $\\Pi$，函数无关的卡西米尔函数是 $C_{1} = x_{1}^{2}+x_{2}^{2}+x_{3}^{2}$ 和 $C_{2} = x_{4}$，并且任何通过功率守恒的狄拉克结构的互联都会通过将轨迹限制在其联合水平集内来遵守这些不变量。",
            "answer": "$$\\boxed{\\begin{pmatrix} x_{1}^{2} + x_{2}^{2} + x_{3}^{2} \\;  \\; x_{4} \\end{pmatrix}}$$"
        },
        {
            "introduction": "几何力学的原理不仅是理论性的，它们还指导着更优越数值算法的设计。最后一个实践展示了狄拉克结构的概念如何被离散化，以创造出能够保持基本物理定律（如能量守恒）的数值积分器。通过比较一个保结构积分器与一个标准积分器，我们可以体会到这种几何方法的实际优势。",
            "id": "3749230",
            "problem": "考虑一个线性端口哈密顿系统，其状态为 $x = (q,p) \\in \\mathbb{R}^{2}$，哈密顿量为 $H(q,p) = \\frac{1}{2m}p^{2} + \\frac{k}{2}q^{2}$（其中 $m>0$ 且 $k>0$），典范互联矩阵为 $J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$。其连续时间动力学由保功率互联关系 $\\dot{x} = J \\nabla H(x)$ 给出，该关系在 $\\mathbb{R}^{2} \\times \\mathbb{R}^{2}$ 上实现了狄拉克结构 $\\mathcal{D} = \\{(f,e) \\mid f = J e\\}$，其中 $f = \\dot{x}$ 是流， $e = \\nabla H(x)$ 是功。\n\n通过在中点处施加离散互联约束来定义离散狄拉克积分器：\n$$\n\\frac{x_{1} - x_{0}}{h} = J \\nabla H\\!\\left( \\frac{x_{1} + x_{0}}{2} \\right),\n$$\n其中时间步长 $h>0$，$x_{0} = (q_{0},p_{0})$ 和 $x_{1} = (q_{1},p_{1})$ 表示相继的状态。同时，考虑其典范分离形式的辛欧拉（SE）方法：\n$$\nq_{1} = q_{0} + \\frac{h}{m}p_{0}, \\quad p_{1} = p_{0} - hk\\, q_{1}.\n$$\n\n从狄拉克结构和哈密顿向量场的定义出发，推导离散狄拉克积分器的单步更新的闭式形式，并计算单步能量增量 $\\Delta H_{\\mathrm{Dirac}} = H(q_{1},p_{1}) - H(q_{0},p_{0})$。然后，使用上述更新公式计算辛欧拉方法的单步能量增量 $\\Delta H_{\\mathrm{SE}} = H(q_{1},p_{1}) - H(q_{0},p_{0})$。将你的最终答案表示为差值 $\\Delta H_{\\mathrm{SE}} - \\Delta H_{\\mathrm{Dirac}}$ 的单个闭式解析表达式，用 $h$、$m$、$k$、$q_{0}$ 和 $p_{0}$ 表示。\n\n无需进行数值舍入。最终答案必须是单个解析表达式。",
            "solution": "### 推导与求解\n\n核心任务是计算两种指定数值积分器的能量增量，然后求出它们的差值。\n\n**1. 离散狄拉克积分器的能量增量（$\\Delta H_{\\mathrm{Dirac}}$）**\n\n离散狄拉克积分器由以下关系定义：\n$$\n\\frac{x_{1} - x_{0}}{h} = J \\nabla H\\left( \\frac{x_{1} + x_{0}}{2} \\right)\n$$\n这是应用于哈密顿系统的隐式中点法则。此积分器的一个关键特性是其对于连续系统守恒量的行为。对于二次哈密顿量，该积分器精确地保持能量守恒。我们来证明这个性质。\n\n哈密顿量为 $H(x) = \\frac{1}{2m}p^2 + \\frac{k}{2}q^2$。这可以写成矩阵形式 $H(x) = \\frac{1}{2}x^T M x$，其中 $x = \\begin{pmatrix} q \\\\ p \\end{pmatrix}$ 且 $M = \\begin{pmatrix} k  0 \\\\ 0  1/m \\end{pmatrix}$。注意 $M$ 是一个对称矩阵。\n\n哈密顿量的梯度是 $\\nabla H(x) = M x$。设 $x_{mid} = \\frac{x_1 + x_0}{2}$。积分器方程为：\n$$\nx_1 - x_0 = h J \\nabla H(x_{mid}) = h J M x_{mid}\n$$\n能量增量为 $\\Delta H_{\\mathrm{Dirac}} = H(x_1) - H(x_0)$。为了计算它，我们可以将积分器方程与 $(\\nabla H(x_{mid}))^T$ 进行点积：\n$$\n(\\nabla H(x_{mid}))^T (x_1 - x_0) = h (\\nabla H(x_{mid}))^T J \\nabla H(x_{mid})\n$$\n互联矩阵 $J$ 是斜对称的，即 $J^T = -J$。对于任何向量 $v$，二次型 $v^T J v$ 恒为零。这是因为 $v^T J v = (v^T J v)^T = v^T J^T v = -v^T J v$，这意味着 $2v^T J v = 0$。因此，方程的右侧为零。\n$$\n(\\nabla H(x_{mid}))^T (x_1 - x_0) = 0\n$$\n代入 $\\nabla H(x_{mid}) = M x_{mid} = M \\left(\\frac{x_1 + x_0}{2}\\right)$:\n$$\n\\left( M \\frac{x_1 + x_0}{2} \\right)^T (x_1 - x_0) = 0\n$$\n$$\n\\frac{1}{2} (x_1^T + x_0^T) M^T (x_1 - x_0) = 0\n$$\n由于 $M$ 是对称的（$M^T=M$），这变成：\n$$\n(x_1^T + x_0^T) M (x_1 - x_0) = 0\n$$\n$$\nx_1^T M x_1 - x_1^T M x_0 + x_0^T M x_1 - x_0^T M x_0 = 0\n$$\n项 $x_0^T M x_1$ 是一个标量，所以它等于它的转置：$x_0^T M x_1 = (x_0^T M x_1)^T = x_1^T M^T x_0 = x_1^T M x_0$。中间两项相互抵消。\n$$\nx_1^T M x_1 - x_0^T M x_0 = 0\n$$\n乘以 $\\frac{1}{2}$，我们得到：\n$$\n\\frac{1}{2}x_1^T M x_1 - \\frac{1}{2}x_0^T M x_0 = 0\n$$\n$$\nH(x_1) - H(x_0) = 0\n$$\n因此，离散狄拉克积分器的能量增量恰好为零。\n$$\n\\Delta H_{\\mathrm{Dirac}} = 0\n$$\n\n**2. 辛欧拉积分器的能量增量（$\\Delta H_{\\mathrm{SE}}$）**\n\n辛欧拉方法由以下更新规则定义：\n$$\nq_1 = q_0 + \\frac{h}{m} p_0\n$$\n$$\np_1 = p_0 - h k q_1\n$$\n我们计算能量增量 $\\Delta H_{\\mathrm{SE}} = H(q_1, p_1) - H(q_0, p_0)$。\n$$\n\\Delta H_{\\mathrm{SE}} = \\left( \\frac{k}{2}q_1^2 + \\frac{1}{2m}p_1^2 \\right) - \\left( \\frac{k}{2}q_0^2 + \\frac{1}{2m}p_0^2 \\right) = \\frac{k}{2}(q_1^2 - q_0^2) + \\frac{1}{2m}(p_1^2 - p_0^2)\n$$\n我们分别计算这两项。首先，对于位置部分：\n$$\n\\frac{k}{2}(q_1^2 - q_0^2) = \\frac{k}{2}\\left( \\left(q_0 + \\frac{h}{m}p_0\\right)^2 - q_0^2 \\right) = \\frac{k}{2}\\left( q_0^2 + \\frac{2h}{m}q_0 p_0 + \\frac{h^2}{m^2}p_0^2 - q_0^2 \\right) = \\frac{kh}{m}q_0 p_0 + \\frac{kh^2}{2m^2}p_0^2\n$$\n对于动量部分，我们首先将 $p_1$ 完全用初始状态 $(q_0, p_0)$ 表示：\n$$\np_1 = p_0 - hk q_1 = p_0 - hk\\left(q_0 + \\frac{h}{m}p_0\\right) = \\left(1 - \\frac{h^2k}{m}\\right)p_0 - hkq_0\n$$\n现在我们计算 $p_1^2 - p_0^2$：\n$$\np_1^2-p_0^2 = \\left( \\left(1 - \\frac{h^2k}{m}\\right)p_0 - hkq_0 \\right)^2 - p_0^2\n$$\n$$\n= \\left(1 - \\frac{h^2k}{m}\\right)^2 p_0^2 - 2hkq_0\\left(1 - \\frac{h^2k}{m}\\right)p_0 + h^2k^2q_0^2 - p_0^2\n$$\n$$\n= \\left(1 - \\frac{2h^2k}{m} + \\frac{h^4k^2}{m^2}\\right)p_0^2 - \\left(2hkq_0 - \\frac{2h^3k^2}{m}q_0\\right)p_0 + h^2k^2q_0^2 - p_0^2\n$$\n$$\n= \\left(1 - \\frac{2h^2k}{m} + \\frac{h^4k^2}{m^2} - 1\\right)p_0^2 - 2hkq_0p_0 + \\frac{2h^3k^2}{m}q_0p_0 + h^2k^2q_0^2\n$$\n$$\n= \\left(-\\frac{2h^2k}{m} + \\frac{h^4k^2}{m^2}\\right)p_0^2 - 2hkq_0p_0 + \\frac{2h^3k^2}{m}q_0p_0 + h^2k^2q_0^2\n$$\n现在，我们计算能量增量的动量部分：\n$$\n\\frac{1}{2m}(p_1^2 - p_0^2) = \\frac{1}{2m}\\left[ \\left(-\\frac{2h^2k}{m} + \\frac{h^4k^2}{m^2}\\right)p_0^2 - 2hkq_0p_0 + \\frac{2h^3k^2}{m}q_0p_0 + h^2k^2q_0^2 \\right]\n$$\n$$\n= \\left(-\\frac{h^2k}{m^2} + \\frac{h^4k^2}{2m^3}\\right)p_0^2 - \\frac{hk}{m}q_0p_0 + \\frac{h^3k^2}{m^2}q_0p_0 + \\frac{h^2k^2}{2m}q_0^2\n$$\n最后，我们将位置和动量的贡献相加得到 $\\Delta H_{\\mathrm{SE}}$：\n$$\n\\Delta H_{\\mathrm{SE}} = \\left(\\frac{kh}{m}q_0 p_0 + \\frac{kh^2}{2m^2}p_0^2\\right) + \\left[ \\left(-\\frac{h^2k}{m^2} + \\frac{h^4k^2}{2m^3}\\right)p_0^2 - \\frac{hk}{m}q_0p_0 + \\frac{h^3k^2}{m^2}q_0p_0 + \\frac{h^2k^2}{2m}q_0^2 \\right]\n$$\n项 $\\frac{kh}{m}q_0p_0$ 与 $-\\frac{hk}{m}q_0p_0$ 抵消。我们合并关于 $q_0^2$、$p_0^2$ 和 $q_0p_0$ 的项：\n$$\n\\Delta H_{\\mathrm{SE}} = \\frac{h^2k^2}{2m}q_0^2 + \\frac{h^3k^2}{m^2}q_0p_0 + \\left( \\frac{kh^2}{2m^2} - \\frac{h^2k}{m^2} + \\frac{h^4k^2}{2m^3} \\right)p_0^2\n$$\n简化 $p_0^2$ 项的系数：\n$$\n\\left( \\frac{kh^2}{2m^2} - \\frac{2kh^2}{2m^2} + \\frac{h^4k^2}{2m^3} \\right)p_0^2 = \\left( -\\frac{kh^2}{2m^2} + \\frac{h^4k^2}{2m^3} \\right)p_0^2 = \\left(\\frac{h^4k^2}{2m^3} - \\frac{h^2k}{2m^2}\\right)p_0^2\n$$\n所以，辛欧拉方法的总能量增量为：\n$$\n\\Delta H_{\\mathrm{SE}} = \\frac{h^2k^2}{2m}q_0^2 + \\frac{h^3k^2}{m^2}q_0p_0 + \\left(\\frac{h^4k^2}{2m^3} - \\frac{h^2k}{2m^2}\\right)p_0^2\n$$\n\n**3. 能量增量的差值**\n\n问题要求计算 $\\Delta H_{\\mathrm{SE}} - \\Delta H_{\\mathrm{Dirac}}$。使用前面几节的结果：\n$$\n\\Delta H_{\\mathrm{SE}} - \\Delta H_{\\mathrm{Dirac}} = \\Delta H_{\\mathrm{SE}} - 0 = \\Delta H_{\\mathrm{SE}}\n$$\n因此，最终表达式就是为 $\\Delta H_{\\mathrm{SE}}$ 推导出的那个。",
            "answer": "$$\n\\boxed{\\frac{h^2k^2}{2m}q_0^2 + \\frac{h^3k^2}{m^2}q_0p_0 + \\left(\\frac{h^4k^2}{2m^3} - \\frac{h^2k}{2m^2}\\right)p_0^2}\n$$"
        }
    ]
}