{
    "hands_on_practices": [
        {
            "introduction": "为了运用接触几何的强大功能来剖析热力学，我们首先需要熟练掌握其核心的数学语言。这项练习将引导你通过具体计算，来验证一个给定的 $1$-形式是否满足定义接触结构的条件 。更进一步，你将实践如何通过坐标变换，将一个看似复杂的形式化为简洁的达布标准型，这是理解所有接触流形局部行为的关键一步。",
            "id": "3783492",
            "problem": "考虑一个封闭的单组分热力学系统，其体积和物质的量固定，因此热力学第一定律简化为 $dU = T\\,dS$，其中 $U$ 是内能，$S$ 是熵，$T$ 是温度。在以 $(U,T,S)$ 为局部坐标的 $3$ 维流形上，吉布斯 $1$-形式 $\\theta_{0} = dU - T\\,dS$ 定义了一个切触结构。$\\theta_{0}$ 的任何光滑无处为零的倍数都定义了相同的切触结构。设 $\\alpha$ 为一个固定的非零实常数，并考虑标度化的切触形式\n$$\n\\theta_{\\alpha} = \\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS.\n$$\n这个 $1$-形式描述了与内能势相关的相同热力学切触结构，但以非达布规范写出。\n\n任务：\n- 从切触流形和切触条件的定义出发，显式计算 $\\theta_{\\alpha} \\wedge d\\theta_{\\alpha}$，并验证它在一个以 $(U,T,S)$ 为有效坐标的开集上是一个无处为零的 $3$-形式，从而证实 $\\theta_{\\alpha}$ 是一个切触形式。\n- 构造一个显式的局部变量变换 $(U,T,S) \\mapsto (Z,P,Q)$ 到Darboux（达布）坐标，使得在新坐标下该形式变为 $\\theta_{\\alpha} = dZ - P\\,dQ$。\n- 作为变换的定量检验，计算你的变量变换的雅可比行列式 $\\det\\left(\\frac{\\partial(Z,P,Q)}{\\partial(U,T,S)}\\right)$，并将该行列式作为最终答案。\n\n将最终答案表示为关于 $S$ 和 $\\alpha$ 的单个闭式解析表达式。不需要进行数值四舍五入。最终答案中不包含任何单位。",
            "solution": "该问题要求完成与三维流形上坐标为 $(U,T,S)$ 的切触 $1$-形式 $\\theta_{\\alpha} = \\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS$ 相关的三个任务。我们按顺序处理每个任务。\n\n首先，我们通过计算 $\\theta_{\\alpha} \\wedge d\\theta_{\\alpha}$ 并证明其为一个无处为零的 $3$-形式来验证 $\\theta_{\\alpha}$ 是一个切触形式。该形式由下式给出\n$$\n\\theta_{\\alpha} = \\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS\n$$\n其中 $\\alpha$ 是一个非零实常数。我们计算其外微分 $d\\theta_{\\alpha}$。\n$$\nd\\theta_{\\alpha} = d(\\exp(\\alpha S)\\,dU) - d(\\exp(\\alpha S)\\,T\\,dS)\n$$\n使用外微分的乘积法则 $d(\\omega \\wedge \\eta) = d\\omega \\wedge \\eta + (-1)^p \\omega \\wedge d\\eta$，其中 $\\omega$ 是一个 $p$-形式。这里，我们可以将函数视为 $0$-形式。\n$$\nd\\theta_{\\alpha} = (d(\\exp(\\alpha S)) \\wedge dU + \\exp(\\alpha S) \\wedge d(dU)) - (d(\\exp(\\alpha S)T) \\wedge dS + \\exp(\\alpha S)T \\wedge d(dS))\n$$\n由于 $d(dU)=0$ 和 $d(dS)=0$，这简化为\n$$\nd\\theta_{\\alpha} = d(\\exp(\\alpha S)) \\wedge dU - d(\\exp(\\alpha S)T) \\wedge dS\n$$\n系数函数的外微分是：\n$$\nd(\\exp(\\alpha S)) = \\frac{\\partial}{\\partial S}(\\exp(\\alpha S))\\,dS = \\alpha \\exp(\\alpha S)\\,dS\n$$\n$$\nd(\\exp(\\alpha S)T) = \\frac{\\partial}{\\partial T}(\\exp(\\alpha S)T)\\,dT + \\frac{\\partial}{\\partial S}(\\exp(\\alpha S)T)\\,dS = \\exp(\\alpha S)\\,dT + \\alpha \\exp(\\alpha S)T\\,dS\n$$\n将这些代回到 $d\\theta_{\\alpha}$ 的表达式中：\n$$\nd\\theta_{\\alpha} = (\\alpha \\exp(\\alpha S)\\,dS) \\wedge dU - (\\exp(\\alpha S)\\,dT + \\alpha \\exp(\\alpha S)T\\,dS) \\wedge dS\n$$\n使用楔积的性质，$dS \\wedge dU = -dU \\wedge dS$ 和 $dS \\wedge dS = 0$：\n$$\nd\\theta_{\\alpha} = -\\alpha \\exp(\\alpha S)\\,dU \\wedge dS - \\exp(\\alpha S)\\,dT \\wedge dS - \\alpha \\exp(\\alpha S)T\\,dS \\wedge dS\n$$\n$$\nd\\theta_{\\alpha} = -\\alpha \\exp(\\alpha S)\\,dU \\wedge dS - \\exp(\\alpha S)\\,dT \\wedge dS\n$$\n现在我们计算楔积 $\\theta_{\\alpha} \\wedge d\\theta_{\\alpha}$：\n$$\n\\theta_{\\alpha} \\wedge d\\theta_{\\alpha} = (\\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS) \\wedge (-\\alpha \\exp(\\alpha S)\\,dU \\wedge dS - \\exp(\\alpha S)\\,dT \\wedge dS)\n$$\n我们展开乘积。任何包含重复 $1$-形式的项，例如 $dU \\wedge dU$ 或 $dS \\wedge dS$，都将为零。\n$\\theta_{\\alpha}$ 的第一项得到：\n$$\n\\exp(\\alpha S)\\,dU \\wedge (-\\alpha \\exp(\\alpha S)\\,dU \\wedge dS) = -\\alpha \\exp(2\\alpha S)\\,dU \\wedge dU \\wedge dS = 0\n$$\n$$\n\\exp(\\alpha S)\\,dU \\wedge (-\\exp(\\alpha S)\\,dT \\wedge dS) = -\\exp(2\\alpha S)\\,dU \\wedge dT \\wedge dS\n$$\n$\\theta_{\\alpha}$ 的第二项得到：\n$$\n-\\exp(\\alpha S)\\,T\\,dS \\wedge (-\\alpha \\exp(\\alpha S)\\,dU \\wedge dS) = \\alpha T \\exp(2\\alpha S)\\,dS \\wedge dU \\wedge dS = 0\n$$\n$$\n-\\exp(\\alpha S)\\,T\\,dS \\wedge (-\\exp(\\alpha S)\\,dT \\wedge dS) = T \\exp(2\\alpha S)\\,dS \\wedge dT \\wedge dS = 0\n$$\n合并非零项，我们发现：\n$$\n\\theta_{\\alpha} \\wedge d\\theta_{\\alpha} = -\\exp(2\\alpha S)\\,dU \\wedge dT \\wedge dS\n$$\n由于 $\\alpha$ 是一个非零实常数，对于任何实数 $S$，$\\exp(2\\alpha S)$ 严格为正。因此，$-\\exp(2\\alpha S)$ 永不为零。形式 $dU \\wedge dT \\wedge dS$ 是坐标图 $(U,T,S)$ 上的标准体积形式。因此，$\\theta_{\\alpha} \\wedge d\\theta_{\\alpha}$ 是一个无处为零的 $3$-形式，这证实了 $\\theta_{\\alpha}$ 是一个有效的切触形式。\n\n第二，我们构造变量变换 $(U,T,S) \\mapsto (Z,P,Q)$，将 $\\theta_{\\alpha}$ 变换为达布形式 $dZ - P\\,dQ$。我们需要求解方程：\n$$\n\\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS = dZ - P\\,dQ\n$$\n其中 $Z, P, Q$ 是 $(U,T,S)$ 的函数。一个标准的方法是为其中一个新坐标做一个有根据的猜测。我们选择 $Q=S$。这意味着 $dQ=dS$。将此代入方程得到：\n$$\n\\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS = dZ - P\\,dS\n$$\n重新整理以求解 $dZ$：\n$$\ndZ = \\exp(\\alpha S)\\,dU + (P - \\exp(\\alpha S)T)\\,dS\n$$\n由于 $Z$ 是 $(U,T,S)$ 的函数，其全微分为 $dZ = \\frac{\\partial Z}{\\partial U}dU + \\frac{\\partial Z}{\\partial T}dT + \\frac{\\partial Z}{\\partial S}dS$。比较系数，我们得到：\n1. $\\frac{\\partial Z}{\\partial U} = \\exp(\\alpha S)$\n2. $\\frac{\\partial Z}{\\partial T} = 0$\n3. $\\frac{\\partial Z}{\\partial S} = P - \\exp(\\alpha S)T$\n\n根据条件2，$Z$ 不依赖于 $T$，所以 $Z=Z(U,S)$。对条件1关于 $U$ 积分，我们得到：\n$$\nZ(U,S) = \\int \\exp(\\alpha S)\\,dU = U\\exp(\\alpha S) + g(S)\n$$\n其中 $g(S)$ 是 $S$ 的任意函数。将此 $Z$ 的表达式对 $S$ 求导：\n$$\n\\frac{\\partial Z}{\\partial S} = \\alpha U \\exp(\\alpha S) + g'(S)\n$$\n将此代入条件3：\n$$\n\\alpha U \\exp(\\alpha S) + g'(S) = P - \\exp(\\alpha S)T\n$$\n这给出了新坐标 $P$ 用旧坐标和 $g'(S)$ 表示的表达式：\n$$\nP(U,T,S) = \\alpha U \\exp(\\alpha S) + T \\exp(\\alpha S) + g'(S)\n$$\n我们可以自由选择 $g(S)$。定义一个有效坐标变换的最简单选择是取 $g(S)$ 为一个常数，这意味着 $g'(S)=0$。在此选择下，我们的变换变为：\n$$\nZ = U \\exp(\\alpha S)\n$$\n$$\nP = (\\alpha U + T) \\exp(\\alpha S)\n$$\n$$\nQ = S\n$$\n这就是到达布坐标的显式局部变量变换。\n\n第三，我们计算雅可比行列式 $\\det\\left(\\frac{\\partial(Z,P,Q)}{\\partial(U,T,S)}\\right)$。雅可比矩阵 $J$ 由下式给出：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial Z}{\\partial U} & \\frac{\\partial Z}{\\partial T} & \\frac{\\partial Z}{\\partial S} \\\\ \\frac{\\partial P}{\\partial U} & \\frac{\\partial P}{\\partial T} & \\frac{\\partial P}{\\partial S} \\\\ \\frac{\\partial Q}{\\partial U} & \\frac{\\partial Q}{\\partial T} & \\frac{\\partial Q}{\\partial S} \\end{pmatrix}\n$$\n我们计算必要的偏导数：\n$\\frac{\\partial Z}{\\partial U} = \\exp(\\alpha S)$\n$\\frac{\\partial Z}{\\partial T} = 0$\n$\\frac{\\partial Z}{\\partial S} = \\alpha U \\exp(\\alpha S)$\n\n$\\frac{\\partial P}{\\partial U} = \\alpha \\exp(\\alpha S)$\n$\\frac{\\partial P}{\\partial T} = \\exp(\\alpha S)$\n$\\frac{\\partial P}{\\partial S} = \\frac{\\partial}{\\partial S}[(\\alpha U + T) \\exp(\\alpha S)] = (\\alpha U + T) (\\alpha \\exp(\\alpha S)) = \\alpha(\\alpha U + T)\\exp(\\alpha S)$\n\n$\\frac{\\partial Q}{\\partial U} = 0$\n$\\frac{\\partial Q}{\\partial T} = 0$\n$\\frac{\\partial Q}{\\partial S} = 1$\n\n组合成雅可比矩阵：\n$$\nJ = \\begin{pmatrix} \\exp(\\alpha S) & 0 & \\alpha U \\exp(\\alpha S) \\\\ \\alpha \\exp(\\alpha S) & \\exp(\\alpha S) & \\alpha(\\alpha U + T)\\exp(\\alpha S) \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n行列式可以通过沿第三行进行余子式展开来计算：\n$$\n\\det(J) = 1 \\cdot \\det\\begin{pmatrix} \\exp(\\alpha S) & 0 \\\\ \\alpha \\exp(\\alpha S) & \\exp(\\alpha S) \\end{pmatrix} - 0 + 0\n$$\n$$\n\\det(J) = (\\exp(\\alpha S))(\\exp(\\alpha S)) - (0)(\\alpha \\exp(\\alpha S)) = \\exp(2\\alpha S)\n$$\n雅可比行列式是 $\\exp(2\\alpha S)$。",
            "answer": "$$\\boxed{\\exp(2\\alpha S)}$$"
        },
        {
            "introduction": "现在，我们将抽象的几何概念与具体的物理世界联系起来。在热力学接触流形的框架中，一个系统的所有平衡态并非随意散落的点集，而是构成了一个具有特殊几何性质的勒让德子流形 。本练习将向你展示如何利用这一几何观点，来检验一组给定的经验物态方程是否在物理上自洽，并最终判断其所描述的热力学系统是否稳定。",
            "id": "3783533",
            "problem": "考虑一个热力学切触流形，其局域坐标为 $(U,S,V,N,T,p,\\mu)$，切触1-形式为 $\\eta = dU - T\\,dS + p\\,dV - \\mu\\,dN$。一个勒让德子流形是一个积分子流形，在该子流形上 $\\eta$ 为零，并且它可以用一个生成函数（热力学势）来描述。该生成函数的全微分再现了热力学第一定律（FLT），即 $dU = T\\,dS - p\\,dV + \\mu\\,dN$。在能量表示下，状态方程满足 $T = \\partial U/\\partial S$，$p = -\\partial U/\\partial V$ 和 $\\mu = \\partial U/\\partial N$。存在这样一个势的充分必要条件是 1-形式 $T\\,dS - p\\,dV + \\mu\\,dN$ 在状态空间上是恰当的，这等价于混合偏导数的对称性（麦克斯韦关系）。\n\n给定一个简单的单组分系统，其广延变量为 $(S,V,N)$，强度变量为 $(T,p,\\mu)$，其经验状态方程如下：\n$$\nT(S,V,N) = A\\,S\\,V^{\\lambda},\\qquad p(S,V,N) = -\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1},\\qquad \\mu(S,V,N) = 3\\,B\\,N^{2},\n$$\n其中 $A>0$，$B>0$，$\\lambda \\in \\mathbb{R}$ 是固定常数，且 $S>0$，$V>0$，$N>0$。从热力学第一定律和勒让德子流形的定义出发，完成以下任务：\n\n1. 推导为使势 $U(S,V,N)$ 存在，$T$、$p$ 和 $\\mu$ 之间必须满足的恰当性条件（类麦克斯韦关系），并验证给定的经验状态方程是否满足这些关系。\n\n2. 如果恰当性条件成立，构造一个热力学势 $U(S,V,N)$，使得 $T = \\partial U/\\partial S$，$p = -\\partial U/\\partial V$ 和 $\\mu = \\partial U/\\partial N$。该势在相差一个加性常数的意义下是唯一的。\n\n3. 通过计算 Hessian 矩阵 $H = \\nabla^{2}_{(S,V,N)}U$ 并分析其主子式，评估 $U(S,V,N)$ 关于 $(S,V,N)$ 的凸性（热力学稳定性）。给出 行列式 $\\det(H)$ 作为 $(S,V,N)$ 和 $(A,B,\\lambda)$ 函数的闭式解析表达式。\n\n将你的最终答案表示为 $\\det(H)$ 关于 $(S,V,N)$ 和 $(A,B,\\lambda)$ 的解析表达式。不需要数值近似或四舍五入，最终答案中不应包含单位。",
            "solution": "该问题要求我们验证一个热力学系统的一组经验状态方程，如果存在相应的内能势 $U(S,V,N)$，则构造该势，并通过计算其 Hessian 矩阵的行列式来分析其凸性。出发点是开放系统的热力学第一定律。在切触形式为零的勒让德子流形上，该定律表示为 $dU = T\\,dS - p\\,dV + \\mu\\,dN$。\n\n为使势 $U(S,V,N)$ 存在，1-形式 $\\omega = T\\,dS - p\\,dV + \\mu\\,dN$ 必须是恰当的。这意味着 $T$、$-p$ 和 $\\mu$ 必须分别是 $U$ 关于 $S$、$V$ 和 $N$ 的偏导数：\n$$\nT = \\frac{\\partial U}{\\partial S}, \\quad -p = \\frac{\\partial U}{\\partial V}, \\quad \\mu = \\frac{\\partial U}{\\partial N}\n$$\n问题陈述中给出的 $p = -\\frac{\\partial U}{\\partial V}$ 与上述关系一致。$\\omega$ 恰当的条件是 $U$ 的混合二阶偏导数必须相等（Clairaut 定理）。这导出了一组类麦克斯韦关系。\n\n**1. 恰当性条件的推导与验证**\n\n三个恰当性条件如下：\n1.  $\\frac{\\partial^2 U}{\\partial V \\partial S} = \\frac{\\partial^2 U}{\\partial S \\partial V} \\implies \\frac{\\partial}{\\partial V}\\left(\\frac{\\partial U}{\\partial S}\\right) = \\frac{\\partial}{\\partial S}\\left(\\frac{\\partial U}{\\partial V}\\right) \\implies \\frac{\\partial T}{\\partial V} = \\frac{\\partial(-p)}{\\partial S} = -\\frac{\\partial p}{\\partial S}$\n2.  $\\frac{\\partial^2 U}{\\partial N \\partial S} = \\frac{\\partial^2 U}{\\partial S \\partial N} \\implies \\frac{\\partial}{\\partial N}\\left(\\frac{\\partial U}{\\partial S}\\right) = \\frac{\\partial}{\\partial S}\\left(\\frac{\\partial U}{\\partial N}\\right) \\implies \\frac{\\partial T}{\\partial N} = \\frac{\\partial \\mu}{\\partial S}$\n3.  $\\frac{\\partial^2 U}{\\partial N \\partial V} = \\frac{\\partial^2 U}{\\partial V \\partial N} \\implies \\frac{\\partial}{\\partial N}\\left(\\frac{\\partial U}{\\partial V}\\right) = \\frac{\\partial}{\\partial V}\\left(\\frac{\\partial U}{\\partial N}\\right) \\implies \\frac{\\partial(-p)}{\\partial N} = \\frac{\\partial \\mu}{\\partial V} \\implies -\\frac{\\partial p}{\\partial N} = \\frac{\\partial \\mu}{\\partial V}$\n\n我们现在使用给定的经验状态方程来验证这三个关系：\n$T(S,V,N) = A\\,S\\,V^{\\lambda}$\n$p(S,V,N) = -\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}$\n$\\mu(S,V,N) = 3\\,B\\,N^{2}$\n\n对于第一个关系，$\\frac{\\partial T}{\\partial V} = -\\frac{\\partial p}{\\partial S}$：\n$$\n\\frac{\\partial T}{\\partial V} = \\frac{\\partial}{\\partial V}(A\\,S\\,V^{\\lambda}) = A\\,\\lambda\\,S\\,V^{\\lambda-1}\n$$\n$$\n-\\frac{\\partial p}{\\partial S} = -\\frac{\\partial}{\\partial S}\\left(-\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}\\right) = \\frac{A\\,\\lambda}{2}\\,(2S)\\,V^{\\lambda-1} = A\\,\\lambda\\,S\\,V^{\\lambda-1}\n$$\n由于 $A\\,\\lambda\\,S\\,V^{\\lambda-1} = A\\,\\lambda\\,S\\,V^{\\lambda-1}$，第一个关系成立。\n\n对于第二个关系，$\\frac{\\partial T}{\\partial N} = \\frac{\\partial \\mu}{\\partial S}$：\n$$\n\\frac{\\partial T}{\\partial N} = \\frac{\\partial}{\\partial N}(A\\,S\\,V^{\\lambda}) = 0\n$$\n$$\n\\frac{\\partial \\mu}{\\partial S} = \\frac{\\partial}{\\partial S}(3\\,B\\,N^{2}) = 0\n$$\n由于 $0 = 0$，第二个关系成立。\n\n对于第三个关系，$-\\frac{\\partial p}{\\partial N} = \\frac{\\partial \\mu}{\\partial V}$：\n$$\n-\\frac{\\partial p}{\\partial N} = -\\frac{\\partial}{\\partial N}\\left(-\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}\\right) = 0\n$$\n$$\n\\frac{\\partial \\mu}{\\partial V} = \\frac{\\partial}{\\partial V}(3\\,B\\,N^{2}) = 0\n$$\n由于 $0=0$，第三个关系成立。\n所有三个恰当性条件都成立，因此存在一个热力学势 $U(S,V,N)$。\n\n**2. 热力学势 $U(S,V,N)$ 的构造**\n\n我们通过对其偏导数进行积分来构造 $U(S,V,N)$。\n首先，我们将 $\\frac{\\partial U}{\\partial S} = T(S,V,N)$ 对 S 积分：\n$$\nU(S,V,N) = \\int T(S,V,N)\\,dS + f(V,N) = \\int A\\,S\\,V^{\\lambda}\\,dS + f(V,N) = \\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + f(V,N)\n$$\n其中 $f(V,N)$ 是 $V$ 和 $N$ 的一个任意函数。\n接着，我们使用条件 $\\frac{\\partial U}{\\partial V} = -p(S,V,N)$：\n$$\n\\frac{\\partial U}{\\partial V} = \\frac{\\partial}{\\partial V}\\left(\\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + f(V,N)\\right) = \\frac{A}{2}\\,S^{2}\\,\\lambda\\,V^{\\lambda-1} + \\frac{\\partial f}{\\partial V}\n$$\n我们令其等于 $-p = -(-\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}) = \\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}$：\n$$\n\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1} + \\frac{\\partial f}{\\partial V} = \\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}\n$$\n这意味着 $\\frac{\\partial f}{\\partial V} = 0$，所以 $f$ 不是 $V$ 的函数。它只能是 $N$ 的函数，我们将其记为 $g(N)$。因此，我们的势具有以下形式：\n$$\nU(S,V,N) = \\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + g(N)\n$$\n最后，我们使用条件 $\\frac{\\partial U}{\\partial N} = \\mu(S,V,N)$：\n$$\n\\frac{\\partial U}{\\partial N} = \\frac{\\partial}{\\partial N}\\left(\\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + g(N)\\right) = \\frac{dg}{dN}\n$$\n令其等于 $\\mu = 3\\,B\\,N^{2}$：\n$$\n\\frac{dg}{dN} = 3\\,B\\,N^{2}\n$$\n对 $N$ 积分得到：\n$$\ng(N) = \\int 3\\,B\\,N^{2}\\,dN = B\\,N^{3} + C_0\n$$\n其中 $C_0$ 是一个任意积分常数。因此，热力学势为：\n$$\nU(S,V,N) = \\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + B\\,N^{3} + C_0\n$$\n该势在相差一个加性常数 $C_0$ 的意义下是唯一的。\n\n**3. 凸性与 Hessian 行列式**\n\n系统的热力学稳定性由内能 $U(S,V,N)$ 的凸性决定。局部凸性的一个充分条件是二阶偏导数的 Hessian 矩阵是正定的。关于变量 $(S,V,N)$ 的 Hessian 矩阵 $H$ 为：\n$$\nH = \\nabla^{2}_{(S,V,N)}U = \\begin{pmatrix}\n\\frac{\\partial^2 U}{\\partial S^2} & \\frac{\\partial^2 U}{\\partial S \\partial V} & \\frac{\\partial^2 U}{\\partial S \\partial N} \\\\\n\\frac{\\partial^2 U}{\\partial V \\partial S} & \\frac{\\partial^2 U}{\\partial V^2} & \\frac{\\partial^2 U}{\\partial V \\partial N} \\\\\n\\frac{\\partial^2 U}{\\partial N \\partial S} & \\frac{\\partial^2 U}{\\partial N \\partial V} & \\frac{\\partial^2 U}{\\partial N^2}\n\\end{pmatrix}\n$$\n我们计算 Hessian 矩阵的元素：\n$\\frac{\\partial^2 U}{\\partial S^2} = \\frac{\\partial T}{\\partial S} = \\frac{\\partial}{\\partial S}(A\\,S\\,V^{\\lambda}) = A\\,V^{\\lambda}$\n$\\frac{\\partial^2 U}{\\partial V^2} = \\frac{\\partial(-p)}{\\partial V} = \\frac{\\partial}{\\partial V}(\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}) = \\frac{A\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{\\lambda-2}$\n$\\frac{\\partial^2 U}{\\partial N^2} = \\frac{\\partial \\mu}{\\partial N} = \\frac{\\partial}{\\partial N}(3\\,B\\,N^{2}) = 6\\,B\\,N$\n混合偏导数为：\n$\\frac{\\partial^2 U}{\\partial S \\partial V} = \\frac{\\partial T}{\\partial V} = A\\,\\lambda\\,S\\,V^{\\lambda-1}$\n$\\frac{\\partial^2 U}{\\partial S \\partial N} = \\frac{\\partial T}{\\partial N} = 0$\n$\\frac{\\partial^2 U}{\\partial V \\partial N} = \\frac{\\partial(-p)}{\\partial N} = 0$\n\n正如预期的那样，Hessian 矩阵是对称的：\n$$\nH = \\begin{pmatrix}\nA\\,V^{\\lambda} & A\\,\\lambda\\,S\\,V^{\\lambda-1} & 0 \\\\\nA\\,\\lambda\\,S\\,V^{\\lambda-1} & \\frac{A\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{\\lambda-2} & 0 \\\\\n0 & 0 & 6\\,B\\,N\n\\end{pmatrix}\n$$\n这个块对角矩阵的行列式是左上角 $2 \\times 2$ 子块的行列式与第三个对角元素 $H_{33}$ 的乘积：\n$$\n\\det(H) = (6\\,B\\,N) \\cdot \\det\\begin{pmatrix}\nA\\,V^{\\lambda} & A\\,\\lambda\\,S\\,V^{\\lambda-1} \\\\\nA\\,\\lambda\\,S\\,V^{\\lambda-1} & \\frac{A\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{\\lambda-2}\n\\end{pmatrix}\n$$\n$$\n\\det(H) = (6\\,B\\,N) \\left[ (A\\,V^{\\lambda})\\left(\\frac{A\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{\\lambda-2}\\right) - (A\\,\\lambda\\,S\\,V^{\\lambda-1})^{2} \\right]\n$$\n$$\n\\det(H) = (6\\,B\\,N) \\left[ \\frac{A^2\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{2\\lambda-2} - A^2\\,\\lambda^2\\,S^2\\,V^{2\\lambda-2} \\right]\n$$\n提取方括号内的公因子：\n$$\n\\det(H) = (6\\,B\\,N) \\left( A^2\\,S^2\\,V^{2\\lambda-2} \\right) \\left[ \\frac{\\lambda(\\lambda-1)}{2} - \\lambda^2 \\right]\n$$\n$$\n\\det(H) = (6\\,B\\,N\\,A^2\\,S^2\\,V^{2\\lambda-2}) \\left[ \\frac{\\lambda^2 - \\lambda - 2\\lambda^2}{2} \\right]\n$$\n$$\n\\det(H) = (6\\,B\\,N\\,A^2\\,S^2\\,V^{2\\lambda-2}) \\left[ \\frac{-\\lambda^2 - \\lambda}{2} \\right]\n$$\n$$\n\\det(H) = -3\\,A^2\\,B\\,\\lambda(\\lambda+1)\\,N\\,S^2\\,V^{2\\lambda-2}\n$$\n为了保证热力学稳定性（凸性），$H$ 的所有顺序主子式都必须为正。\n$D_1 = A\\,V^{\\lambda} > 0$ (因为 $A>0, V>0$）。\n$D_2 = -\\frac{A^2\\,\\lambda(\\lambda+1)}{2}\\,S^{2}\\,V^{2\\lambda-2} > 0$，这要求 $\\lambda(\\lambda+1) < 0$，即 $-1 < \\lambda < 0$。\n$D_3 = \\det(H) > 0$，这也要求 $\\lambda(\\lambda+1) < 0$。\n因此，系统是稳定的当且仅当 $-1 < \\lambda < 0$。评估得出了这个条件，而问题要求的是行列式的闭式表达式。",
            "answer": "$$\n\\boxed{-3\\,A^{2}\\,B\\,\\lambda(\\lambda+1)\\,N\\,S^{2}\\,V^{2\\lambda-2}}\n$$"
        },
        {
            "introduction": "本章的前述实践主要关注静态的平衡态，但接触几何的真正威力在于其描述动态过程的能力。这项高级练习将引导你超越平衡态分析，进入非平衡热力学领域 。你将面临一个设计挑战：构建一个接触哈密顿量，使其动力学流能够精确地引导一个系统在等温条件下弛豫到其亥姆霍兹自由能决定的平衡流形上，这充分展示了该理论在建模和控制物理过程中的应用潜力。",
            "id": "3783552",
            "problem": "考虑一个具有达布坐标三元组 $\\left(x,p,z\\right) \\in \\mathbb{R}_{>0} \\times \\mathbb{R} \\times \\mathbb{R}$ 的切触流形，其切触 1-形式为 $\\lambda = \\mathrm{d}z - p\\,\\mathrm{d}x$。设里布向量场 (Reeb vector field) 为满足 $\\iota_R \\mathrm{d}\\lambda = 0$ 和 $\\iota_R \\lambda = 1$ 的向量场 $R$。由光滑哈密顿量 $H(x,p,z)$ 生成的切触哈密顿场 $X_H$ 由以下方程定义：\n$$\n\\iota_{X_H}\\mathrm{d}\\lambda = \\mathrm{d}H - \\left(R(H)\\right)\\lambda,\\qquad \\iota_{X_H}\\lambda = -H.\n$$\n从这些定义出发，不使用任何其他预先推导的公式，在将热力学系统建模为切触流形的背景下，完成以下任务：\n\n1) 将三元组 $\\left(x,p,z\\right)$ 解释如下：$x$ 是一个约束在 $x \\in \\mathbb{R}_{>0}$ 上的无量纲类温度坐标，$z$ 是一个无量纲的类亥姆霍兹自由能势，而 $p$ 是其共轭量。设亥姆霍兹自由能流形（一个勒让德子流形）由一个光滑、严格凸的函数 $\\psi(x)$ 通过以下关系指定：\n$$\nz = \\psi(x), \\qquad p = \\frac{\\mathrm{d}\\psi}{\\mathrm{d}x}(x).\n$$\n假设亥姆霍兹自由能的具体无量纲模型为：\n$$\n\\psi(x) = \\alpha\\, x \\ln x + \\frac{\\beta}{2}\\, x^2,\\qquad \\alpha>0,\\ \\beta>0,\\ x>0,\n$$\n其导数为：\n$$\n\\psi'(x) = \\alpha\\left(\\ln x + 1\\right) + \\beta x.\n$$\n\n2) 构造一个切触哈密顿量 $H(x,p,z)$，使其在以下意义上强制实现向亥姆霍兹自由能流形的等温弛豫：\n- 流使 $x$ 随时间保持恒定（等温条件）。\n- 量 $\\Delta_0 := z - \\psi(x)$ 单调弛豫到 $0$。\n- 量 $\\Delta_1 := p - \\psi'(x)$ 也弛豫到 $0$。\n\n你的构造应仅使用上述基本定义，并且必须确保所得到的常微分方程（ODE）对于 $x>0$ 是全局良定的。\n\n3) 使用在第 2) 项中建立的切触哈密顿量，推导 $\\left(x(t),p(t),z(t)\\right)$ 的达布坐标下的常微分方程，并针对一般初始条件 $\\left(x(0),p(0),z(0)\\right)$ 显式求解它们，将解纯粹用参数、初始条件和时间 $t$ 表示。\n\n4) 将时间 $t$ 的等温弛豫误差定义为：\n$$\n\\mathcal{E}(t) := \\max\\left( \\left|p(t) - \\psi'(x(t))\\right|,\\ \\left|z(t) - \\psi(x(t))\\right| \\right).\n$$\n提供 $\\mathcal{E}(t)$ 的闭式表达式，用参数和初始条件表示。\n\n5) 实现一个程序，为五个测试用例计算 $\\mathcal{E}(t_f)$。所有量都是无量纲的。你必须使用在第 3) 项中推导的显式解来评估 $\\mathcal{E}(t_f)$。对于每个案例，输出一个四舍五入到六位小数的浮点数。这五个测试用例是：\n\n- 案例 1 (正常路径): $\\alpha=1.0$, $\\beta=0.5$, $\\gamma=2.0$, $x_0=1.5$, $p_0=-1.0$, $z_0=0.0$, $t_f=1.0$。\n- 案例 2 (流形上初始条件): $\\alpha=0.8$, $\\beta=0.3$, $\\gamma=4.0$, $x_0=2.0$, $p_0=\\psi'(2.0)$, $z_0=\\psi(2.0)$, $t_f=1.0$。\n- 案例 3 (无弛豫边界): $\\alpha=1.0$, $\\beta=1.0$, $\\gamma=0.0$, $x_0=1.2$, $p_0=2.0$, $z_0=-0.5$, $t_f=3.0$。\n- 案例 4 (小 $x$ 边界情况): $\\alpha=1.5$, $\\beta=0.2$, $\\gamma=3.0$, $x_0=0.1$, $p_0=0.0$, $z_0=1.0$, $t_f=2.0$。\n- 案例 5 (刚性弛豫): $\\alpha=0.7$, $\\beta=0.4$, $\\gamma=50.0$, $x_0=1.1$, $p_0=5.0$, $z_0=-2.0$, $t_f=0.5$。\n\n这里 $\\gamma \\ge 0$ 是你在切触哈密顿量中引入的弛豫率参数，你必须在推导中一致地使用它。\n\n6) 最终输出格式要求：你的程序应生成单行输出，包含五个浮点数结果的逗号分隔列表 $\\left[\\mathcal{E}(t_f)_{\\text{案例 1}},\\ldots,\\mathcal{E}(t_f)_{\\text{案例 5}}\\right]$，用方括号括起来，每个值四舍五入到六位小数，例如 $\\left[0.123456,0.000000,1.234000,0.010000,0.000001\\right]$。不应打印任何其他文本。",
            "solution": "该问题是良定的、有科学依据且内部一致的。我们按照指定的任务进行求解。\n\n首先，我们在给定的达布坐标 $(x, p, z)$ 中推导里布向量场 $R$ 和切触哈密顿向量场 $X_H$ 的一般表达式。\n\n切触 1-形式为 $\\lambda = \\mathrm{d}z - p\\,\\mathrm{d}x$。其外微分为 $\\mathrm{d}\\lambda = \\mathrm{d}(\\mathrm{d}z - p\\,\\mathrm{d}x) = -\\mathrm{d}p \\wedge \\mathrm{d}x = \\mathrm{d}x \\wedge \\mathrm{d}p$。\n设里布向量场为 $R = R_x \\frac{\\partial}{\\partial x} + R_p \\frac{\\partial}{\\partial p} + R_z \\frac{\\partial}{\\partial z}$。它必须满足两个条件：\n1.  $\\iota_R \\lambda = 1$: $\\lambda(R) = (\\mathrm{d}z - p\\,\\mathrm{d}x)(R) = R_z - p R_x = 1$。\n2.  $\\iota_R \\mathrm{d}\\lambda = 0$: $\\iota_R(\\mathrm{d}x \\wedge \\mathrm{d}p) = (\\iota_R \\mathrm{d}x)\\mathrm{d}p - (\\iota_R \\mathrm{d}p)\\mathrm{d}x = R_x \\mathrm{d}p - R_p \\mathrm{d}x = 0$。\n第二个条件意味着 $R_x = 0$ 和 $R_p = 0$。将 $R_x=0$ 代入第一个条件得到 $R_z = 1$。因此，里布向量场为 $R = \\frac{\\partial}{\\partial z}$。\n\n设切触哈密顿向量场为 $X_H = \\dot{x}\\frac{\\partial}{\\partial x} + \\dot{p}\\frac{\\partial}{\\partial p} + \\dot{z}\\frac{\\partial}{\\partial z}$。它由两个方程定义：\n1.  $\\iota_{X_H}\\lambda = -H$: $\\lambda(X_H) = \\dot{z} - p\\dot{x} = -H$。\n2.  $\\iota_{X_H}\\mathrm{d}\\lambda = \\mathrm{d}H - (R(H))\\lambda$:\n    左侧为 $\\iota_{X_H}(\\mathrm{d}x \\wedge \\mathrm{d}p) = \\dot{x}\\mathrm{d}p - \\dot{p}\\mathrm{d}x$。\n    对于右侧，我们首先求出 $R(H) = \\frac{\\partial}{\\partial z}(H) = \\frac{\\partial H}{\\partial z}$。\n    然后 $\\mathrm{d}H - (R(H))\\lambda = \\left(\\frac{\\partial H}{\\partial x}\\mathrm{d}x + \\frac{\\partial H}{\\partial p}\\mathrm{d}p + \\frac{\\partial H}{\\partial z}\\mathrm{d}z\\right) - \\frac{\\partial H}{\\partial z}(\\mathrm{d}z - p\\,\\mathrm{d}x) = \\left(\\frac{\\partial H}{\\partial x} + p\\frac{\\partial H}{\\partial z}\\right)\\mathrm{d}x + \\frac{\\partial H}{\\partial p}\\mathrm{d}p$。\n    通过令基 1-形式 $\\mathrm{d}x$ 和 $\\mathrm{d}p$ 的系数相等，我们得到：\n    $\\dot{x} = \\frac{\\partial H}{\\partial p}$\n    $-\\dot{p} = \\frac{\\partial H}{\\partial x} + p\\frac{\\partial H}{\\partial z} \\implies \\dot{p} = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z}$。\n从第一个定义，我们发现 $\\dot{z} = p\\dot{x} - H = p\\frac{\\partial H}{\\partial p} - H$。\n流的常微分方程为：\n$$\n\\dot{x} = \\frac{\\partial H}{\\partial p}, \\qquad \\dot{p} = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z}, \\qquad \\dot{z} = p\\frac{\\partial H}{\\partial p} - H.\n$$\n\n有了这些一般方程，我们可以继续构造用于等温弛豫的特定哈密顿量。\n\n等温条件要求 $\\dot{x}=0$。从流方程可知，这意味着 $\\frac{\\partial H}{\\partial p} = 0$，所以哈密顿量 $H$ 必须仅是 $x$ 和 $z$ 的函数，即 $H=H(x,z)$。\n\n当 $H=H(x,z)$ 时，流方程简化为：\n$$\n\\dot{x} = 0, \\qquad \\dot{p} = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z}, \\qquad \\dot{z} = -H.\n$$\n条件 $\\dot{x}=0$ 意味着对于所有时间 $t$，$x(t) = x_0$，其中 $x_0$ 是初始值。\n\n我们希望量 $\\Delta_0(t) := z(t) - \\psi(x(t))$ 和 $\\Delta_1(t) := p(t) - \\psi'(x(t))$ 弛豫到 $0$。让我们研究它们的时间演化：\n$\\dot{\\Delta}_0 = \\dot{z} - \\frac{\\mathrm{d}}{\\mathrm{d}t}\\psi(x(t)) = \\dot{z} - \\psi'(x)\\dot{x}$。由于 $\\dot{x}=0$，我们有 $\\dot{\\Delta}_0 = \\dot{z} = -H$。\n$\\dot{\\Delta}_1 = \\dot{p} - \\frac{\\mathrm{d}}{\\mathrm{d}t}\\psi'(x(t)) = \\dot{p} - \\psi''(x)\\dot{x}$。由于 $\\dot{x}=0$，我们有 $\\dot{\\Delta}_1 = \\dot{p} = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z}$。\n\n为了实现到 $0$ 的单调弛豫，我们可以用指数衰减来模拟动力学。让我们要求 $\\dot{\\Delta}_0 = -\\gamma \\Delta_0$，其中 $\\gamma$ 是某个非负弛豫率。这意味着 $-H = -\\gamma \\Delta_0$，从而选择哈密顿量为：\n$$\nH(x,z) = \\gamma \\Delta_0 = \\gamma(z - \\psi(x)).\n$$\n这个哈密顿量如要求的那样与 $p$ 无关。让我们验证它是否为 $\\Delta_1$ 产生了期望的弛豫。我们计算 $H$ 的偏导数：\n$\\frac{\\partial H}{\\partial x} = -\\gamma\\psi'(x)$\n$\\frac{\\partial H}{\\partial z} = \\gamma$。\n\n将这些代入 $\\dot{\\Delta}_1$ 的方程中：\n$\\dot{\\Delta}_1 = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z} = -(-\\gamma\\psi'(x)) - p(\\gamma) = \\gamma\\psi'(x) - \\gamma p = -\\gamma(p - \\psi'(x)) = -\\gamma \\Delta_1$。\n这证实了我们选择的 $H$ 导致 $\\Delta_0$ 和 $\\Delta_1$ 以相同的速率 $\\gamma$ 进行指数弛豫。这完成了哈密顿量的构造。\n\n接下来，我们推导并显式求解具有初始条件 $(x_0, p_0, z_0)$ 的系统的常微分方程。\n常微分方程组为：\n1.  $\\dot{x}(t) = 0$\n2.  $\\dot{p}(t) = -\\gamma(p(t) - \\psi'(x(t)))$\n3.  $\\dot{z}(t) = -\\gamma(z(t) - \\psi(x(t)))$\n\n解第一个方程：$x(t) = x_0$ 对所有 $t \\ge 0$。\n由于 $x(t) = x_0$，项 $\\psi(x(t))$ 和 $\\psi'(x(t))$ 是常数。我们将其表示为 $\\psi_0 := \\psi(x_0)$ 和 $\\psi'_0 := \\psi'(x_0)$。常微分方程变为：\n$\\dot{p}(t) = -\\gamma(p(t) - \\psi'_0)$\n$\\dot{z}(t) = -\\gamma(z(t) - \\psi_0)$\n这些是标准的一阶线性常微分方程。形如 $\\dot{y} = -a(y-c)$ 的方程的解是 $y(t) = c + (y(0) - c)e^{-at}$。\n将此应用于我们的系统：\n$p(t) = \\psi'_0 + (p_0 - \\psi'_0)e^{-\\gamma t}$\n$z(t) = \\psi_0 + (z_0 - \\psi_0)e^{-\\gamma t}$\n\n完整的显式解是：\n$$\nx(t) = x_0\n$$\n$$\np(t) = \\psi'(x_0) + (p_0 - \\psi'(x_0)) e^{-\\gamma t}\n$$\n$$\nz(t) = \\psi(x_0) + (z_0 - \\psi(x_0)) e^{-\\gamma t}\n$$\n其中 $\\psi(x_0) = \\alpha x_0 \\ln x_0 + \\frac{\\beta}{2} x_0^2$ 且 $\\psi'(x_0) = \\alpha(\\ln x_0 + 1) + \\beta x_0$。\n\n最后，我们推导等温弛豫误差 $\\mathcal{E}(t)$ 的闭式表达式，其定义为：\n$$\n\\mathcal{E}(t) := \\max\\left( \\left|p(t) - \\psi'(x(t))\\right|,\\ \\left|z(t) - \\psi(x(t))\\right| \\right).\n$$\n使用我们找到的解：\n$p(t) - \\psi'(x(t)) = p(t) - \\psi'(x_0) = (p_0 - \\psi'(x_0))e^{-\\gamma t}$\n$z(t) - \\psi(x(t)) = z(t) - \\psi(x_0) = (z_0 - \\psi(x_0))e^{-\\gamma t}$\n\n取绝对值：\n$|p(t) - \\psi'(x_0)| = |p_0 - \\psi'(x_0)|e^{-\\gamma t}$\n$|z(t) - \\psi(x_0)| = |z_0 - \\psi(x_0)|e^{-\\gamma t}$\n（因为对于 $\\gamma \\ge 0, t \\ge 0$，有 $e^{-\\gamma t} \\ge 0$）。\n\n将这些代入 $\\mathcal{E}(t)$ 的定义中：\n$\\mathcal{E}(t) = \\max\\left( |p_0 - \\psi'(x_0)|e^{-\\gamma t}, |z_0 - \\psi(x_0)|e^{-\\gamma t} \\right)$\n由于 $e^{-\\gamma t}$ 是一个公共的非负因子，可以将其从最大值函数中提出：\n$$\n\\mathcal{E}(t) = e^{-\\gamma t} \\max\\left( |p_0 - \\psi'(x_0)|, |z_0 - \\psi(x_0)| \\right)\n$$\n这就是所要求的闭式表达式。项 $\\max\\left( |p_0 - \\psi'(x_0)|, |z_0 - \\psi(x_0)| \\right)$ 表示初始误差 $\\mathcal{E}(0)$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the isothermal relaxation error E(t_f) for a set of test cases.\n    \"\"\"\n\n    def psi(x, alpha, beta):\n        \"\"\"\n        Computes the Helmholtz free energy-like function psi(x).\n        \"\"\"\n        if x == 0:\n            # log(x) is undefined for x = 0.\n            # Problem constraints state x > 0.\n            raise ValueError(\"x must be positive.\")\n        return alpha * x * np.log(x) + (beta / 2.0) * x**2\n\n    def psi_prime(x, alpha, beta):\n        \"\"\"\n        Computes the derivative of psi(x).\n        \"\"\"\n        if x == 0:\n            raise ValueError(\"x must be positive.\")\n        return alpha * (np.log(x) + 1.0) + beta * x\n\n    def calculate_error(alpha, beta, gamma, x0, p0, z0, tf):\n        \"\"\"\n        Calculates the relaxation error E(tf) using the derived closed-form solution.\n        \n        The formula is E(t) = max(|p0 - psi'(x0)|, |z0 - psi(x0)|) * exp(-gamma * t).\n        \"\"\"\n        # Calculate the equilibrium values at x0\n        psi_val_at_x0 = psi(x0, alpha, beta)\n        psi_prime_val_at_x0 = psi_prime(x0, alpha, beta)\n        \n        # Calculate the initial errors in p and z\n        error_p0 = np.abs(p0 - psi_prime_val_at_x0)\n        error_z0 = np.abs(z0 - psi_val_at_x0)\n        \n        # Determine the maximum initial error E(0)\n        error_t0 = np.maximum(error_p0, error_z0)\n        \n        # Calculate the error at time tf\n        error_tf = error_t0 * np.exp(-gamma * tf)\n        \n        return error_tf\n\n    # Define the five test cases from the problem statement.\n    test_cases = [\n        # Case 1: alpha=1.0, beta=0.5, gamma=2.0, x0=1.5, p0=-1.0, z0=0.0, tf=1.0\n        (1.0, 0.5, 2.0, 1.5, -1.0, 0.0, 1.0),\n        # Case 2: alpha=0.8, beta=0.3, gamma=4.0, x0=2.0, p0=psi'(2.0), z0=psi(2.0), tf=1.0\n        (0.8, 0.3, 4.0, 2.0, 'psi_prime', 'psi', 1.0),\n        # Case 3: alpha=1.0, beta=1.0, gamma=0.0, x0=1.2, p0=2.0, z0=-0.5, tf=3.0\n        (1.0, 1.0, 0.0, 1.2, 2.0, -0.5, 3.0),\n        # Case 4: alpha=1.5, beta=0.2, gamma=3.0, x0=0.1, p0=0.0, z0=1.0, tf=2.0\n        (1.5, 0.2, 3.0, 0.1, 0.0, 1.0, 2.0),\n        # Case 5: alpha=0.7, beta=0.4, gamma=50.0, x0=1.1, p0=5.0, z0=-2.0, tf=0.5\n        (0.7, 0.4, 50.0, 1.1, 5.0, -2.0, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, beta, gamma, x0, p0_val, z0_val, tf = case\n        \n        # Handle special case where initial conditions are on the manifold\n        if p0_val == 'psi_prime':\n            p0 = psi_prime(x0, alpha, beta)\n        else:\n            p0 = p0_val\n            \n        if z0_val == 'psi':\n            z0 = psi(x0, alpha, beta)\n        else:\n            z0 = z0_val\n\n        result = calculate_error(alpha, beta, gamma, x0, p0, z0, tf)\n        results.append(result)\n\n    # Format the results to six decimal places for the final output string.\n    formatted_results = [f'{res:.6f}' for res in results]\n    \n    # Print the final output in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}