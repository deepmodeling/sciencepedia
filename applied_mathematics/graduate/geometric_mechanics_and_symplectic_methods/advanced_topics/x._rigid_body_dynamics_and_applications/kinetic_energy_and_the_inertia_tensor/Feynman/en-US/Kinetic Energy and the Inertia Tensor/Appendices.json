{
    "hands_on_practices": [
        {
            "introduction": "Before exploring the complex geometry of rotational motion, it is essential to ground our understanding of the inertia tensor in its physical origins. This first practice challenges you to derive the inertia tensor from the fundamental integral definition of kinetic energy for a continuous body. By then applying this formula to calculate the moments of inertia for a uniform rectangular block, you will solidify the connection between the abstract tensor and a concrete physical object. ",
            "id": "3740943",
            "problem": "Consider a free rigid body whose configuration space is the Special Orthogonal Group ($SO(3)$). In body coordinates, let the mass density be a smooth function $\\rho(x)$ supported on a bounded region $\\mathcal{B} \\subset \\mathbb{R}^{3}$, with $x \\in \\mathcal{B}$ measured relative to the body-fixed origin at the center of mass. The rigid body has angular velocity $\\omega \\in \\mathbb{R}^{3}$ expressed in body coordinates, and the instantaneous body velocity field is $v(x) = \\omega \\times x$. The kinetic energy is given by the integral $T = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, dx$.\n\nStarting from this fundamental base, first derive an explicit integral formula for the inertia tensor $I \\in \\mathbb{R}^{3 \\times 3}$ such that $T = \\frac{1}{2} \\, \\omega^{\\top} I \\, \\omega$ holds for all $\\omega$. Second, evaluate this formula for a uniform rectangular block occupying the body domain $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$, with constant density $\\rho_{0} > 0$ and total mass $m = \\rho_{0} L_{x} L_{y} L_{z}$. Use the body-fixed coordinate axes aligned with the edges of the block (so that the inertia tensor and its principal moments are computed about the center-of-mass frame with axes along the block edges).\n\nProvide the final answer as the ordered triple of principal moments $(I_{xx}, I_{yy}, I_{zz})$ in terms of $m$, $L_{x}$, $L_{y}$, and $L_{z}$. Express your final answer in the International System of Units (SI) as kilogram meter squared. Write your final triple as a single row matrix. No rounding is required.",
            "solution": "The problem presents a valid and well-posed question in classical mechanics, specifically the dynamics of a free rigid body. All definitions and given conditions are standard, scientifically sound, and self-consistent. The problem is comprised of two parts: first, a general derivation of the inertia tensor from the kinetic energy, and second, the evaluation of this tensor for a specific geometry.\n\nPart 1: Derivation of the Inertia Tensor\n\nThe kinetic energy $T$ of a rigid body is given by the integral of the kinetic energy of its infinitesimal mass elements over its volume. In a body-fixed frame with origin at the center of mass, the velocity of a point $x \\in \\mathcal{B}$ is purely rotational, given by $v(x) = \\omega \\times x$, where $\\omega$ is the body's angular velocity vector.\n\nThe kinetic energy is:\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, d^3x = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|\\omega \\times x\\|^{2} \\, d^3x\n$$\nWe use the vector identity $\\|\\mathbf{a} \\times \\mathbf{b}\\|^2 = \\|\\mathbf{a}\\|^2 \\|\\mathbf{b}\\|^2 - (\\mathbf{a} \\cdot \\mathbf{b})^2$. Let $\\omega = (\\omega_1, \\omega_2, \\omega_3)$ and $x = (x_1, x_2, x_3)$. Then, $\\|\\omega\\|^2 = \\sum_i \\omega_i^2$, $\\|x\\|^2 = \\sum_k x_k^2$, and $\\omega \\cdot x = \\sum_j \\omega_j x_j$.\nSo,\n$$\n\\|\\omega \\times x\\|^2 = \\left(\\sum_i \\omega_i^2\\right) \\left(\\sum_k x_k^2\\right) - \\left(\\sum_j \\omega_j x_j\\right)^2\n$$\nWe can express this as a quadratic form in $\\omega$. Let us use index notation with Einstein summation convention.\n$$\n\\|\\omega \\times x\\|^2 = \\omega_i \\omega_i x_k x_k - (\\omega_j x_j)(\\omega_m x_m)\n$$\nTo write this in the form $\\omega_j I_{jm} \\omega_m$, we manipulate the indices:\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\delta_{jm} \\omega_m x_k x_k - \\omega_j x_j \\omega_m x_m\n$$\nwhere $\\delta_{jm}$ is the Kronecker delta. Factoring out $\\omega_j$ and $\\omega_m$:\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\left( \\delta_{jm} (x_k x_k) - x_j x_m \\right) \\omega_m\n$$\nSubstituting this back into the kinetic energy integral:\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\left( \\omega_j \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\omega_m \\right) \\, d^3x\n$$\nSince the components $\\omega_j$ of the angular velocity are constant with respect to the spatial integration over the body $\\mathcal{B}$, we can pull them out of the integral:\n$$\nT = \\frac{1}{2} \\, \\omega_j \\left( \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x \\right) \\omega_m\n$$\nThis expression is of the form $T = \\frac{1}{2} \\omega^{\\top} I \\omega$, which in index notation is $T = \\frac{1}{2} \\omega_j I_{jm} \\omega_m$. By direct comparison, we identify the components of the inertia tensor $I$ as:\n$$\nI_{jm} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x\n$$\nThis is the general integral formula for the inertia tensor.\nThe diagonal components ($j=m$), called the moments of inertia, are:\n$$\nI_{jj} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\|x\\|^2 - x_j^2 \\right) \\, d^3x\n$$\nFor example, using coordinates $(x,y,z)$ for $(x_1, x_2, x_3)$:\n$$\nI_{xx} = I_{11} = \\int_{\\mathcal{B}} \\rho(x,y,z) (y^2+z^2) \\, dx\\,dy\\,dz\n$$\nThe off-diagonal components ($j \\neq m$), called the products of inertia, are:\n$$\nI_{jm} = - \\int_{\\mathcal{B}} \\rho(x) x_j x_m \\, d^3x\n$$\n\nPart 2: Evaluation for a Uniform Rectangular Block\n\nWe are given a rectangular block with constant density $\\rho_0$ and dimensions $L_x, L_y, L_z$. The domain is $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$. The total mass is $m = \\rho_0 L_x L_y L_z$. The body-fixed axes are aligned with the block's edges.\n\nFirst, we check the products of inertia. For instance, $I_{xy}$:\n$$\nI_{xy} = - \\int_{\\mathcal{B}} \\rho_0 x y \\, dx\\,dy\\,dz = -\\rho_0 \\left( \\int_{-L_x/2}^{L_x/2} x \\, dx \\right) \\left( \\int_{-L_y/2}^{L_y/2} y \\, dy \\right) \\left( \\int_{-L_z/2}^{L_z/2} dz \\right)\n$$\nThe integral $\\int_{-L_x/2}^{L_x/2} x \\, dx = \\left[ \\frac{x^2}{2} \\right]_{-L_x/2}^{L_x/2} = \\frac{1}{2}\\left(\\left(\\frac{L_x}{2}\\right)^2 - \\left(-\\frac{L_x}{2}\\right)^2\\right) = 0$.\nThe integral is zero because the integrand is an odd function over a symmetric interval. Consequently, $I_{xy} = 0$. By symmetry, $I_{xz} = 0$ and $I_{yz} = 0$. The inertia tensor is diagonal, and its diagonal elements are the principal moments of inertia.\n\nNow, we compute the principal moments. Let's start with $I_{xx}$:\n$$\nI_{xx} = \\int_{\\mathcal{B}} \\rho_0 (y^2 + z^2) \\, dx\\,dy\\,dz = \\rho_0 \\left( \\int_{\\mathcal{B}} y^2 \\, dV + \\int_{\\mathcal{B}} z^2 \\, dV \\right)\n$$\nwhere $dV = dx\\,dy\\,dz$. We evaluate the first integral:\n$$\n\\int_{\\mathcal{B}} y^2 \\, dV = \\int_{-L_x/2}^{L_x/2} dx \\int_{-L_y/2}^{L_y/2} y^2 \\, dy \\int_{-L_z/2}^{L_z/2} dz\n$$\nThe separate integrals are:\n$\\int_{-L_x/2}^{L_x/2} dx = L_x$\n$\\int_{-L_z/2}^{L_z/2} dz = L_z$\n$\\int_{-L_y/2}^{L_y/2} y^2 \\, dy = \\left[ \\frac{y^3}{3} \\right]_{-L_y/2}^{L_y/2} = \\frac{1}{3}\\left( \\left(\\frac{L_y}{2}\\right)^3 - \\left(-\\frac{L_y}{2}\\right)^3 \\right) = \\frac{1}{3}\\left(\\frac{L_y^3}{8} + \\frac{L_y^3}{8}\\right) = \\frac{L_y^3}{12}$\nThus, $\\int_{\\mathcal{B}} y^2 \\, dV = L_x \\left( \\frac{L_y^3}{12} \\right) L_z = \\frac{L_x L_y^3 L_z}{12}$.\nBy a symmetric argument, $\\int_{\\mathcal{B}} z^2 \\, dV = \\frac{L_x L_y L_z^3}{12}$.\nSubstituting these results back into the expression for $I_{xx}$:\n$$\nI_{xx} = \\rho_0 \\left( \\frac{L_x L_y^3 L_z}{12} + \\frac{L_x L_y L_z^3}{12} \\right) = \\frac{\\rho_0 L_x L_y L_z}{12} (L_y^2 + L_z^2)\n$$\nUsing the given relation for the total mass, $m = \\rho_0 L_x L_y L_z$, we obtain:\n$$\nI_{xx} = \\frac{m}{12} (L_y^2 + L_z^2)\n$$\nThe other two principal moments, $I_{yy}$ and $I_{zz}$, can be found by cyclic permutation of the indices $x, y, z$ and the corresponding dimensions $L_x, L_y, L_z$:\n$$\nI_{yy} = \\frac{m}{12} (L_x^2 + L_z^2)\n$$\n$$\nI_{zz} = \\frac{m}{12} (L_x^2 + L_y^2)\n$$\nThe ordered triple of principal moments $(I_{xx}, I_{yy}, I_{zz})$ is therefore:\n$$\n\\left( \\frac{m}{12}(L_y^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_y^2) \\right)\n$$\nThese expressions have units of mass times length squared (e.g., kg m$^2$ in SI units), as required for moments of inertia. The final answer is requested as a single row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{m}{12}(L_y^2 + L_z^2) & \\frac{m}{12}(L_x^2 + L_z^2) & \\frac{m}{12}(L_x^2 + L_y^2) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the inertia tensor established, we now elevate the discussion to the body's configuration manifold, the Special Orthogonal Group $SO(3)$. The kinetic energy induces a natural Riemannian metric on this space, but its local representation $M(q)$ is critically dependent on our choice of coordinates, such as Euler angles. This practice explores the profound consequences of this dependency, including the emergence of coordinate singularities, and demonstrates why intrinsic, coordinate-free formulations are a cornerstone of modern geometric mechanics. ",
            "id": "3750965",
            "problem": "A free rigid body moves on the Special Orthogonal Group ($SO(3)$). Let $R \\in SO(3)$ denote its orientation, and let $\\boldsymbol{\\omega} \\in \\mathbb{R}^3$ denote its angular velocity expressed in the body frame, with inertia tensor $\\mathbb{I} \\in \\mathbb{R}^{3 \\times 3}$, symmetric and positive definite. The kinetic energy is defined from first principles as the mass-weighted integral of the squared speed of material points, and for a rigid body reduces to an expression that depends quadratically on $\\boldsymbol{\\omega}$ and $\\mathbb{I}$. If one uses a local coordinate chart $q$ on $SO(3)$ (for example, a set of Euler angles) to describe the orientation, the kinetic energy admits a local representation $T(q,\\dot{q}) = \\frac{1}{2} \\dot{q}^{\\top} M(q) \\dot{q}$, where $M(q)$ is the coordinate expression of the Riemannian metric induced by the kinetic energy. Coordinate singularities in charts such as Euler angles are known to occur (e.g., gimbal lock), at which the local map from $\\dot{q}$ to $\\boldsymbol{\\omega}$ loses rank. In geometric mechanics, one often avoids such singularities by using intrinsic formulations based on frames (rotation matrices) or unit quaternions.\n\nSelect all statements that are correct and justify them from first principles:\n\nA. In a chart with Euler angles, at a coordinate singularity the local map from $\\dot{q}$ to $\\boldsymbol{\\omega}$ loses rank, which causes $M(q)$ to lose rank. Consequently, $M(q)$ becomes non-invertible at the singularity even though the physical kinetic energy remains finite.\n\nB. Using unit quaternions yields a one-to-one, unconstrained parameterization of $SO(3)$ that completely removes singularities and makes the kinetic energy matrix independent of orientation when expressed in quaternion rate coordinates.\n\nC. Expressing dynamics intrinsically with body-frame angular velocity via left-trivialization of $TSO(3)$ produces a globally nonsingular kinetic energy $T = \\frac{1}{2} \\boldsymbol{\\omega}^{\\top} \\mathbb{I} \\boldsymbol{\\omega}$ with $\\mathbb{I}$ constant, so the corresponding inertia matrix is configuration-independent and avoids coordinate singularities on $SO(3)$.\n\nD. At Euler angle singularities, the kinetic energy diverges to infinity because the angular velocity $\\boldsymbol{\\omega}$ necessarily becomes unbounded when $\\dot{q}$ is finite, implying that the rigid body cannot pass through those orientations.\n\nE. Unit quaternions remove local coordinate singularities but represent a double cover of $SO(3)$ and are constrained to lie on the unit three-sphere; the metric in quaternion rate coordinates generally depends on the quaternion, while using $\\boldsymbol{\\omega}$ still yields a constant $\\mathbb{I}$.\n\nF. Orthonormal frames (rotation matrices) provide a globally valid, one-to-one, unconstrained parameterization of $SO(3)$ in terms of nine entries; in this representation the inertia matrix is constant and independent of configuration without additional constraints.\n\nChoose all that apply.",
            "solution": "The problem statement describes the kinetic energy of a free rigid body and asks for an evaluation of several statements regarding its representation using different parameterizations of the special orthogonal group $SO(3)$. The problem statement is physically and mathematically sound, well-posed, and provides a sufficient basis for a rigorous analysis.\n\nThe kinetic energy of a rigid body, expressed in the body-fixed frame, is given by the formula:\n$$\nT = \\frac{1}{2} \\boldsymbol{\\omega}^{\\top} \\mathbb{I} \\boldsymbol{\\omega}\n$$\nwhere $\\boldsymbol{\\omega} \\in \\mathbb{R}^3$ is the angular velocity vector in the body frame, and $\\mathbb{I} \\in \\mathbb{R}^{3 \\times 3}$ is the constant, symmetric, positive-definite inertia tensor in the body frame. This expression is intrinsic and globally valid. Any other expression for kinetic energy must be reconcilable with this fundamental form.\n\nLet's evaluate each option:\n\n**A. In a chart with Euler angles, at a coordinate singularity the local map from $\\dot{q}$ to $\\boldsymbol{\\omega}$ loses rank, which causes $M(q)$ to lose rank. Consequently, $M(q)$ becomes non-invertible at the singularity even though the physical kinetic energy remains finite.**\n\nLet $q \\in \\mathbb{R}^3$ be a set of local coordinates for $SO(3)$, such as Euler angles. The body angular velocity $\\boldsymbol{\\omega}$ is linearly related to the coordinate time derivatives $\\dot{q}$ by a matrix $A(q)$ that depends on the current orientation $q$:\n$$\n\\boldsymbol{\\omega} = A(q) \\dot{q}\n$$\nSubstituting this into the kinetic energy expression gives the local coordinate form:\n$$\nT(q, \\dot{q}) = \\frac{1}{2} (A(q) \\dot{q})^{\\top} \\mathbb{I} (A(q) \\dot{q}) = \\frac{1}{2} \\dot{q}^{\\top} [A(q)^{\\top} \\mathbb{I} A(q)] \\dot{q}\n$$\nThe matrix $M(q) = A(q)^{\\top} \\mathbb{I} A(q)$ is the representation of the kinetic energy metric in the chosen coordinates. A coordinate singularity (like gimbal lock) is defined as a configuration $q$ where the matrix $A(q)$ becomes singular, i.e., it loses rank and its determinant is zero, $\\det(A(q)) = 0$.\n\nThe determinant of $M(q)$ is:\n$$\n\\det(M(q)) = \\det(A(q)^{\\top} \\mathbb{I} A(q)) = \\det(A(q)^{\\top}) \\det(\\mathbb{I}) \\det(A(q)) = (\\det(A(q)))^2 \\det(\\mathbb{I})\n$$\nSince the inertia tensor $\\mathbb{I}$ is positive definite, its determinant is strictly positive, $\\det(\\mathbb{I}) > 0$. Thus, $\\det(M(q)) = 0$ if and only if $\\det(A(q)) = 0$. This means that at a coordinate singularity, the metric representation $M(q)$ also becomes singular, loses rank, and is non-invertible.\nThe physical kinetic energy, defined by $T = \\frac{1}{2} \\boldsymbol{\\omega}^{\\top} \\mathbb{I} \\boldsymbol{\\omega}$, remains finite for any physically realizable motion, as the body's angular velocity $\\boldsymbol{\\omega}$ must be finite. The singularity is an artifact of the chosen coordinate system, not a physical impossibility or a state of infinite energy.\nTherefore, the statement is **Correct**.\n\n**B. Using unit quaternions yields a one-to-one, unconstrained parameterization of $SO(3)$ that completely removes singularities and makes the kinetic energy matrix independent of orientation when expressed in quaternion rate coordinates.**\n\nThis statement contains several inaccuracies:\n1.  **\"one-to-one\"**: A unit quaternion $\\mathbf{q} \\in S^3 \\subset \\mathbb{R}^4$ and its negative $-\\mathbf{q}$ represent the exact same rotation in $SO(3)$. Thus, the mapping from the unit $3$-sphere $S^3$ to $SO(3)$ is a two-to-one map (a double cover), not one-to-one.\n2.  **\"unconstrained\"**: The four components of a unit quaternion $(q_0, q_1, q_2, q_3)$ are subject to the constraint $q_0^2 + q_1^2 + q_2^2 + q_3^2 = 1$. This is a fundamental constraint, so the parameterization is not unconstrained.\n3.  **\"makes the kinetic energy matrix independent of orientation\"**: The body angular velocity $\\boldsymbol{\\omega}$ can be expressed in terms of the quaternion $\\mathbf{q}$ and its time derivative $\\dot{\\mathbf{q}}$ via a linear map. A common relation is $\\dot{\\mathbf{q}} = \\frac{1}{2}G(\\mathbf{q})\\boldsymbol{\\omega}$, where $G(\\mathbf{q})$ is a $4 \\times 3$ matrix whose entries are linear in the components of $\\mathbf{q}$. Inverting this (on the appropriate subspace) gives $\\boldsymbol{\\omega}$ in terms of $\\dot{\\mathbf{q}}$. Substituting this into the kinetic energy gives an expression of the form $T = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\top} M(\\mathbf{q}) \\dot{\\mathbf{q}}$. The resulting $4 \\times 4$ mass matrix $M(\\mathbf{q})$ explicitly depends on the quaternion $\\mathbf{q}$ itself and is therefore configuration-dependent.\nTherefore, the statement is **Incorrect**.\n\n**C. Expressing dynamics intrinsically with body-frame angular velocity via left-trivialization of $TSO(3)$ produces a globally nonsingular kinetic energy $T = \\frac{1}{2} \\boldsymbol{\\omega}^{\\top} \\mathbb{I} \\boldsymbol{\\omega}$ with $\\mathbb{I}$ constant, so the corresponding inertia matrix is configuration-independent and avoids coordinate singularities on $SO(3)$.**\n\nThis statement describes the core idea of geometric mechanics. The tangent bundle $TSO(3)$ is the space of all possible states (orientation and angular velocity). A state is a pair $(R, \\dot{R})$, where $R \\in SO(3)$ and $\\dot{R} \\in T_R SO(3)$. The tangent bundle can be trivialized, meaning it can be identified with the product space $SO(3) \\times \\mathbb{R}^3$. Left-trivialization achieves this by mapping a tangent vector $\\dot{R}$ at $R$ to a vector in the Lie algebra $\\mathfrak{so}(3) \\cong \\mathbb{R}^3$ via left translation: $(R, \\dot{R}) \\mapsto (R, R^T \\dot{R})$. The matrix $\\hat{\\boldsymbol{\\omega}} = R^T \\dot{R}$ is the skew-symmetric representation of the body angular velocity vector $\\boldsymbol{\\omega}$. This map is a global diffeomorphism, meaning it is well-defined and invertible everywhere on $SO(3)$, thus avoiding any coordinate singularities.\nIn these intrinsic coordinates $(R, \\boldsymbol{\\omega})$, the kinetic energy is simply $T(R, \\boldsymbol{\\omega}) = \\frac{1}{2} \\boldsymbol{\\omega}^{\\top} \\mathbb{I} \\boldsymbol{\\omega}$. In this expression, the matrix $\\mathbb{I}$ is the \"mass matrix\" with respect to the velocity variables $\\boldsymbol{\\omega}$. Since $\\mathbb{I}$ is the inertia tensor in the body-fixed frame, it is a constant matrix. It does not depend on the configuration $R$. This formulation is globally nonsingular and configuration-independent in its velocity representation.\nTherefore, the statement is **Correct**.\n\n**D. At Euler angle singularities, the kinetic energy diverges to infinity because the angular velocity $\\boldsymbol{\\omega}$ necessarily becomes unbounded when $\\dot{q}$ is finite, implying that the rigid body cannot pass through those orientations.**\n\nThis statement misinterprets the nature of a coordinate singularity. First, the relationship is $\\boldsymbol{\\omega} = A(q)\\dot{q}$. If $\\dot{q}$ is finite, and the matrix $A(q)$ has finite entries (which it does), then the resulting angular velocity $\\boldsymbol{\\omega}$ must also be finite. The problem at a singularity is the inverse mapping: for a general, finite $\\boldsymbol{\\omega}$, finding a corresponding finite $\\dot{q}$ may be impossible because the equation $\\boldsymbol{\\omega} = A(q)\\dot{q}$ may have no solution for $\\dot{q}$, or the solution may require some components of $\\dot{q}$ to be infinite. The physical angular velocity $\\boldsymbol{\\omega}$ and kinetic energy $T = \\frac{1}{2} \\boldsymbol{\\omega}^{\\top} \\mathbb{I} \\boldsymbol{\\omega}$ remain finite as a rigid body rotates through any orientation. The singularity is a failure of the coordinate system, not a physical barrier. A rigid body can certainly pass through orientations that correspond to Euler angle singularities.\nTherefore, the statement is **Incorrect**.\n\n**E. Unit quaternions remove local coordinate singularities but represent a double cover of $SO(3)$ and are constrained to lie on the unit three-sphere; the metric in quaternion rate coordinates generally depends on the quaternion, while using $\\boldsymbol{\\omega}$ still yields a constant $\\mathbb{I}$.**\n\nThis statement is a collection of correct facts about quaternions and the intrinsic formulation:\n1.  **\"remove local coordinate singularities\"**: True. The use of four parameters subject to one constraint avoids the breakdown that occurs in three-parameter charts like Euler angles. The mapping from quaternion rates to angular velocity is always well-defined.\n2.  **\"represent a double cover of $SO(3)$\"**: True. Both $\\mathbf{q}$ and $-\\mathbf{q}$ correspond to the same rotation.\n3.  **\"constrained to lie on the unit three-sphere\"**: True. The quaternion components must satisfy $||\\mathbf{q}||^2 = 1$.\n4.  **\"the metric in quaternion rate coordinates generally depends on the quaternion\"**: True. As discussed in the analysis of option B, the mass matrix $M(\\mathbf{q})$ in the expression $T = \\frac{1}{2}\\dot{\\mathbf{q}}^\\top M(\\mathbf{q}) \\dot{\\mathbf{q}}$ is a function of $\\mathbf{q}$.\n5.  **\"while using $\\boldsymbol{\\omega}$ still yields a constant $\\mathbb{I}$\"**: True. As described in the analysis of option C, the intrinsic formulation $T = \\frac{1}{2} \\boldsymbol{\\omega}^{\\top} \\mathbb{I} \\boldsymbol{\\omega}$ involves the constant body inertia tensor $\\mathbb{I}$.\nAll parts of the statement are accurate.\nTherefore, the statement is **Correct**.\n\n**F. Orthonormal frames (rotation matrices) provide a globally valid, one-to-one, unconstrained parameterization of $SO(3)$ in terms of nine entries; in this representation the inertia matrix is constant and independent of configuration without additional constraints.**\n\nThe primary flaw in this statement is the claim that this parameterization is \"unconstrained\". A general $3 \\times 3$ matrix has $9$ independent entries. However, a matrix $R$ being an element of $SO(3)$ requires it to satisfy two conditions:\n1.  $R^T R = I$ (orthonormality)\n2.  $\\det(R) = 1$ (special, i.e., orientation-preserving)\nThe condition $R^T R = I$ imposes six independent scalar constraints (because $R^T R$ is a symmetric matrix). These constraints reduce the number of degrees of freedom from $9$ to $3$, which is the dimension of $SO(3)$. Therefore, using the nine entries of a matrix is a highly constrained parameterization, not an unconstrained one. Because of these constraints, the nine entries cannot be used as independent generalized coordinates for a Lagrangian formulation without including the constraints, for example with Lagrange multipliers.\nTherefore, the statement is **Incorrect**.",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "Theory becomes most powerful when it can be translated into practical algorithms. This final exercise bridges the gap between the abstract framework of geometric mechanics and its application in computational dynamics. You will implement the intrinsic relationship between the time-varying orientation matrix $R(t)$ and the body-frame angular velocity $\\boldsymbol{\\omega}_b$ to analyze motion data, providing a robust, singularity-free method for calculating the kinetic energy of a rigid body from its observed trajectory. ",
            "id": "3750940",
            "problem": "You are given a time series of attitude matrices $R(t_k) \\in \\mathrm{SO}(3)$, where $\\mathrm{SO}(3)$ denotes the Special Orthogonal Group consisting of $3 \\times 3$ real orthogonal matrices with determinant $1$, and a constant body-frame inertia tensor $I_b \\in \\mathbb{R}^{3 \\times 3}$ that is symmetric and positive definite. Your task is to derive from first principles how to compute the body-frame angular velocity $\\omega_b(t_k) \\in \\mathbb{R}^3$ from the time series $R(t_k)$, and then use it to estimate the rotational kinetic energy $T_{\\text{rot}}(t_k)$ of the rigid body. All angles must be in radians, time in seconds, inertia in kilogram-meter-squared ($\\mathrm{kg \\cdot m^2}$), angular velocity in radians per second ($\\mathrm{rad/s}$), and energy in joules ($\\mathrm{J}$).\n\nFundamental base to use:\n- The definition of $\\mathrm{SO}(3)$ implies $R(t)^\\top R(t) = I$ and $\\det R(t) = 1$ for all $t$, where $I$ is the identity.\n- The Lie algebra of the Special Orthogonal Group (SO(3)) consists of $3 \\times 3$ skew-symmetric matrices.\n- The rigid body rotational kinetic energy arises from the kinetic energy density integrated over the mass distribution in the body and can be expressed in terms of the inertia tensor in the body frame and the body angular velocity.\n\nYour algorithmic implementation should:\n- Construct $R(t_k)$ from the provided test suite specifications.\n- Approximate $\\dot{R}(t_k)$ from the discrete time series using a finite difference scheme that is consistent with the units and the geometric structure. Use a central difference for interior points and forward/backward difference at the endpoints.\n- Derive and implement the relation between the body angular velocity and the attitude matrix derivative implied by the structure of the Special Orthogonal Group and its Lie algebra. Numerically enforce skew-symmetry when mapping to the Lie algebra to mitigate discretization artifacts.\n- Map the resulting skew-symmetric matrix at each time $t_k$ to the unique angular velocity vector $\\omega_b(t_k) \\in \\mathbb{R}^3$ via the standard isomorphism between $\\mathfrak{so}(3)$ and $\\mathbb{R}^3$ (the \"vee\" operator).\n- Compute $T_{\\text{rot}}(t_k)$ from $\\omega_b(t_k)$ and $I_b$ using the appropriate expression that follows from the definition of the inertia tensor.\n\nTest suite:\n- Case $1$ (happy path, constant rotation about the $z$-axis):\n  - Inertia tensor $I_b = \\mathrm{diag}(2.0, 3.0, 4.0)$ in $\\mathrm{kg \\cdot m^2}$.\n  - Time samples $t_k = k \\Delta t$ with $\\Delta t = 0.001$ and $k = 0,1,\\dots,2000$, so total duration $2.000$ seconds.\n  - Attitude $R(t) = R_z(\\theta(t))$ with $\\theta(t) = t$ in radians, where $R_z(\\theta)$ is the rotation about the $z$-axis by angle $\\theta$. Use the standard construction of $R_z(\\theta)$ from trigonometric functions.\n  - Let the true constant angular speed be $\\omega_z = 1\\,\\mathrm{rad/s}$ so the true rotational kinetic energy is $T^\\star = \\tfrac{1}{2} I_{zz} \\omega_z^2 = 2.0\\,\\mathrm{J}$. Compute and return the maximum absolute deviation $E_1 = \\max_k \\lvert T_{\\text{rot}}(t_k) - T^\\star \\rvert$, expressed in joules.\n\n- Case $2$ (edge case, near-identity small-angle jitter):\n  - Inertia tensor $I_b = \\mathrm{diag}(2.0, 3.0, 4.0)$ in $\\mathrm{kg \\cdot m^2}$.\n  - Time samples $t_k = k \\Delta t$ with $\\Delta t = 0.001$ and $k = 0,1,\\dots,1000$, so total duration $1.000$ seconds.\n  - Small-angle functions $\\alpha(t) = \\varepsilon \\sin(2 \\pi t)$ and $\\beta(t) = \\varepsilon \\cos(2 \\pi t)$ with $\\varepsilon = 10^{-3}$ radians.\n  - Attitude $R(t) = R_x(\\alpha(t)) R_y(\\beta(t))$, where $R_x(\\cdot)$ and $R_y(\\cdot)$ are rotations about the $x$- and $y$-axes constructed from trigonometric functions.\n  - Compute and return $M_2 = \\max_k \\lVert \\omega_b(t_k) \\rVert_2$ in $\\mathrm{rad/s}$.\n\n- Case $3$ (general time-varying rotation with non-diagonal inertia):\n  - Inertia tensor\n    $$I_b = \\begin{bmatrix}\n    3.0 & 0.2 & 0.1 \\\\\n    0.2 & 2.0 & 0.3 \\\\\n    0.1 & 0.3 & 1.5\n    \\end{bmatrix} \\quad \\text{in } \\mathrm{kg \\cdot m^2}.$$\n  - Time samples $t_k = k \\Delta t$ with $\\Delta t = 0.002$ and $k = 0,1,\\dots,500$, so total duration $1.000$ seconds.\n  - Attitude\n    $$R(t) = R_z(0.8 t) R_x(0.3 \\sin(2 t)) R_y(0.5 t^2),$$\n    where the arguments to $R_x, R_y, R_z$ are in radians.\n  - Compute and return the mean rotational kinetic energy\n    $$M_3 = \\frac{1}{N} \\sum_{k=0}^{N-1} T_{\\text{rot}}(t_k),$$\n    expressed in joules.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets: $[E_1, M_2, M_3]$. Ensure the three numbers are returned in this exact order, using the specified units: $E_1$ in joules, $M_2$ in radians per second, and $M_3$ in joules.",
            "solution": "The problem is valid as it is scientifically grounded in rigid body mechanics, mathematically well-posed, and all provided data and constraints are self-consistent and objective. We shall now proceed with a complete solution derived from first principles.\n\n### Theoretical Foundation\n\nThe core of the problem lies in the relationship between the orientation of a rigid body, represented by an attitude matrix $R(t) \\in \\mathrm{SO}(3)$, and its angular velocity $\\omega_b(t) \\in \\mathbb{R}^3$. This relationship is rooted in the geometric structure of the special orthogonal group $\\mathrm{SO}(3)$ and its associated Lie algebra $\\mathfrak{so}(3)$.\n\n#### 1. Derivation of Body Angular Velocity\n\nThe attitude matrix $R(t)$ transforms vectors from a body-fixed reference frame to a spatial (inertial) reference frame. Let $\\mathbf{x}_b$ be a constant vector in the body frame. Its representation in the spatial frame is time-dependent: $\\mathbf{x}_s(t) = R(t)\\mathbf{x}_b$.\n\nThe velocity of the point $\\mathbf{x}_s(t)$ in the spatial frame is obtained by time differentiation:\n$$ \\dot{\\mathbf{x}}_s(t) = \\frac{d}{dt}(R(t)\\mathbf{x}_b) = \\dot{R}(t)\\mathbf{x}_b $$\nFrom kinematics, the velocity of this point is also given by the cross product of the spatial angular velocity vector $\\omega_s(t)$ with the position vector $\\mathbf{x}_s(t)$:\n$$ \\dot{\\mathbf{x}}_s(t) = \\omega_s(t) \\times \\mathbf{x}_s(t) $$\nThe cross product with a vector $\\mathbf{v}$ can be represented by a matrix multiplication with a skew-symmetric matrix $[\\mathbf{v}]_\\times$, known as the \"hat\" map. If $\\mathbf{v} = (v_1, v_2, v_3)^\\top$, then:\n$$ [\\mathbf{v}]_\\times = \\begin{pmatrix} 0 & -v_3 & v_2 \\\\ v_3 & 0 & -v_1 \\\\ -v_2 & v_1 & 0 \\end{pmatrix} $$\nUsing this notation, we have $\\dot{\\mathbf{x}}_s(t) = [\\omega_s(t)]_\\times \\mathbf{x}_s(t)$. Substituting $\\mathbf{x}_s(t) = R(t)\\mathbf{x}_b$:\n$$ \\dot{R}(t)\\mathbf{x}_b = [\\omega_s(t)]_\\times R(t)\\mathbf{x}_b $$\nSince this equality must hold for any vector $\\mathbf{x}_b$ fixed in the body, we can deduce the matrix relationship:\n$$ \\dot{R}(t) = [\\omega_s(t)]_\\times R(t) $$\nThe body angular velocity $\\omega_b(t)$ is related to the spatial angular velocity $\\omega_s(t)$ by the rotation $R(t)$:\n$$ \\omega_s(t) = R(t)\\omega_b(t) $$\nSubstituting this into the equation for $\\dot{R}(t)$:\n$$ \\dot{R}(t) = [R(t)\\omega_b(t)]_\\times R(t) $$\nA key property of the hat map is its behavior under rotations: for any $R \\in \\mathrm{SO}(3)$ and $\\mathbf{v} \\in \\mathbb{R}^3$, we have $[R\\mathbf{v}]_\\times = R[\\mathbf{v}]_\\times R^\\top$. Applying this property:\n$$ \\dot{R}(t) = \\left( R(t)[\\omega_b(t)]_\\times R(t)^\\top \\right) R(t) = R(t)[\\omega_b(t)]_\\times $$\nTo solve for $[\\omega_b(t)]_\\times$, we left-multiply by $R(t)^\\top$. Since $R(t) \\in \\mathrm{SO}(3)$, we know $R(t)^\\top R(t) = I$, where $I$ is the $3 \\times 3$ identity matrix.\n$$ R(t)^\\top \\dot{R}(t) = R(t)^\\top R(t) [\\omega_b(t)]_\\times = I [\\omega_b(t)]_\\times $$\nThis gives us the fundamental relationship between the time derivative of the attitude matrix and the body angular velocity:\n$$ [\\omega_b(t)]_\\times = R(t)^\\top \\dot{R}(t) $$\nThe matrix $[\\omega_b(t)]_\\times$ is an element of the Lie algebra $\\mathfrak{so}(3)$, which consists of all $3 \\times 3$ real skew-symmetric matrices. Given such a matrix $\\Omega = [\\omega_b]_\\times$, we can recover the vector $\\omega_b$ using the \"vee\" operator ($\\vee$), which is the inverse of the hat map:\n$$ \\omega_b = \\begin{pmatrix} \\Omega_{21} \\\\ \\Omega_{02} \\\\ \\Omega_{10} \\end{pmatrix} $$\nwhere $\\Omega_{ij}$ are the elements of $\\Omega$ using $0$-based indexing.\n\n#### 2. Derivation of Rotational Kinetic Energy\n\nThe rotational kinetic energy of a rigid body is the integral of the kinetic energy of its infinitesimal mass elements over its volume, relative to its center of mass.\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\|\\mathbf{v}(\\mathbf{p}_b)\\|^2 dm $$\nHere, $\\mathbf{p}_b$ is the position vector of a mass element $dm$ in the body frame (with origin at the center of mass), and $\\mathbf{v}(\\mathbf{p}_b)$ is its velocity in the spatial frame, which is $\\mathbf{v}(\\mathbf{p}_b) = \\omega_s \\times (R \\mathbf{p}_b)$.\nIt is more convenient to perform calculations in the body frame. The velocity of the mass element relative to the center of mass, expressed in body-frame coordinates, is $\\omega_b \\times \\mathbf{p}_b$. The magnitude of this velocity is invariant under rotation, so $\\|\\mathbf{v}(\\mathbf{p}_b)\\|^2 = \\|\\omega_b \\times \\mathbf{p}_b\\|^2$.\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\|\\omega_b \\times \\mathbf{p}_b\\|^2 dm = \\frac{1}{2} \\int_V (-[\\mathbf{p}_b]_\\times \\omega_b)^\\top (-[\\mathbf{p}_b]_\\times \\omega_b) dm $$\nUsing the property $([\\mathbf{p}_b]_\\times)^\\top = -[\\mathbf{p}_b]_\\times$, this simplifies to:\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\omega_b^\\top ([\\mathbf{p}_b]_\\times^\\top [\\mathbf{p}_b]_\\times) \\omega_b dm = \\frac{1}{2} \\omega_b^\\top \\left( -\\int_V [\\mathbf{p}_b]_\\times^2 dm \\right) \\omega_b $$\nThe term in the parenthesis is the body-frame inertia tensor $I_b$:\n$$ I_b = -\\int_V [\\mathbf{p}_b]_\\times^2 dm = \\int_V \\begin{pmatrix} y^2+z^2 & -xy & -xz \\\\ -yx & x^2+z^2 & -yz \\\\ -zx & -zy & x^2+y^2 \\end{pmatrix} dm $$\nwhere $\\mathbf{p}_b = (x,y,z)^\\top$. Thus, the rotational kinetic energy is given by the quadratic form:\n$$ T_{\\text{rot}}(t) = \\frac{1}{2} \\omega_b(t)^\\top I_b \\omega_b(t) $$\n\n### Numerical Implementation\n\nThe algorithm proceeds by first generating the discrete time series of attitude matrices $R(t_k)$. Then, for each time step $t_k$, it executes the following computations.\n\n1.  **Approximate $\\dot{R}(t_k)$**: The time derivative of the attitude matrix sequence is approximated using finite differences. We use a central difference scheme for interior points for its second-order accuracy, and forward/backward differences for the endpoints. For a time series $R_k = R(t_k)$ with uniform time step $\\Delta t$:\n    -   $\\dot{R}_0 \\approx \\frac{R_1 - R_0}{\\Delta t}$ (Forward difference)\n    -   $\\dot{R}_k \\approx \\frac{R_{k+1} - R_{k-1}}{2 \\Delta t}$ for $0 < k < N-1$ (Central difference)\n    -   $\\dot{R}_{N-1} \\approx \\frac{R_{N-1} - R_{N-2}}{\\Delta t}$ (Backward difference)\n    This scheme is readily implemented using `numpy.gradient`.\n\n2.  **Compute Body Angular Velocity $\\omega_b(t_k)$**:\n    a.  Compute the matrix $\\Omega_k = R(t_k)^\\top \\dot{R}(t_k)$.\n    b.  Due to numerical errors from the finite difference scheme, $\\Omega_k$ may not be perfectly skew-symmetric. We enforce this property by projecting it onto the space $\\mathfrak{so}(3)$:\n        $$ \\Omega'_k = \\frac{1}{2} (\\Omega_k - \\Omega_k^\\top) $$\n    c.  Extract the angular velocity vector $\\omega_{b,k}$ from the skew-symmetric matrix $\\Omega'_k$ using the vee operator:\n        $$ \\omega_{b,k} = (\\Omega'_{k,21}, \\Omega'_{k,02}, \\Omega'_{k,10})^\\top $$\n\n3.  **Compute Rotational Kinetic Energy $T_{\\text{rot}}(t_k)$**:\n    Using the computed body angular velocity $\\omega_{b,k}$ and the given inertia tensor $I_b$, the kinetic energy is calculated as:\n    $$ T_{\\text{rot},k} = \\frac{1}{2} \\omega_{b,k}^\\top I_b \\omega_{b,k} $$\n\nThis procedure is applied to each test case to compute the specified metrics.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the rotational dynamics problem for three test cases.\n    Derives angular velocity and kinetic energy from a time series of attitude matrices.\n    \"\"\"\n\n    def get_rot_matrices(theta, axis):\n        \"\"\"Constructs a rotation matrix for a given angle and axis.\"\"\"\n        c, s = np.cos(theta), np.sin(theta)\n        if axis == 'x':\n            return np.array([[1, 0, 0], [0, c, -s], [0, s, c]])\n        elif axis == 'y':\n            return np.array([[c, 0, s], [0, 1, 0], [-s, 0, c]])\n        elif axis == 'z':\n            return np.array([[c, -s, 0], [s, c, 0], [0, 0, 1]])\n        else:\n            raise ValueError(\"Invalid axis\")\n\n    def compute_from_R_series(R_series, dt, I_b):\n        \"\"\"\n        Computes omega_b and T_rot from a series of rotation matrices.\n        \n        Args:\n            R_series (np.ndarray): Array of shape (N, 3, 3) containing rotation matrices.\n            dt (float): Time step.\n            I_b (np.ndarray): Body-frame inertia tensor of shape (3, 3).\n            \n        Returns:\n            tuple: (omega_b_series, T_rot_series)\n        \"\"\"\n        # Step 1: Approximate dR/dt using finite differences.\n        # np.gradient uses central differences for interior and 1st-order\n        # forward/backward differences for boundaries, as specified.\n        R_dot_series = np.gradient(R_series, dt, axis=0)\n\n        # Step 2: Compute omega_b for each time step.\n        N = R_series.shape[0]\n        omega_b_series = np.zeros((N, 3))\n        T_rot_series = np.zeros(N)\n\n        for k in range(N):\n            R = R_series[k]\n            R_dot = R_dot_series[k]\n            \n            # a. Compute Omega = R^T * R_dot\n            Omega = R.T @ R_dot\n            \n            # b. Enforce skew-symmetry\n            Omega_skew = 0.5 * (Omega - Omega.T)\n            \n            # c. Extract omega_b using the 'vee' operator\n            omega_b = np.array([Omega_skew[2, 1], Omega_skew[0, 2], Omega_skew[1, 0]])\n            omega_b_series[k, :] = omega_b\n            \n            # Step 3: Compute rotational kinetic energy\n            T_rot = 0.5 * omega_b.T @ I_b @ omega_b\n            T_rot_series[k] = T_rot\n            \n        return omega_b_series, T_rot_series\n\n    # Test Case 1\n    def run_case_1():\n        I_b = np.diag([2.0, 3.0, 4.0])\n        dt = 0.001\n        num_steps = 2001\n        t_samples = np.linspace(0.0, (num_steps - 1) * dt, num_steps)\n        \n        R_series = np.array([get_rot_matrices(t, 'z') for t in t_samples])\n        \n        _ , T_rot_series = compute_from_R_series(R_series, dt, I_b)\n        \n        T_star = 2.0  # True kinetic energy\n        E1 = np.max(np.abs(T_rot_series - T_star))\n        return E1\n\n    # Test Case 2\n    def run_case_2():\n        I_b = np.diag([2.0, 3.0, 4.0])\n        dt = 0.001\n        num_steps = 1001\n        t_samples = np.linspace(0.0, (num_steps - 1) * dt, num_steps)\n        epsilon = 1e-3\n        \n        alpha = epsilon * np.sin(2 * np.pi * t_samples)\n        beta = epsilon * np.cos(2 * np.pi * t_samples)\n        \n        R_series = np.zeros((num_steps, 3, 3))\n        for k in range(num_steps):\n            Rx = get_rot_matrices(alpha[k], 'x')\n            Ry = get_rot_matrices(beta[k], 'y')\n            R_series[k] = Rx @ Ry\n\n        omega_b_series, _ = compute_from_R_series(R_series, dt, I_b)\n        \n        M2 = np.max(np.linalg.norm(omega_b_series, axis=1))\n        return M2\n\n    # Test Case 3\n    def run_case_3():\n        I_b = np.array([[3.0, 0.2, 0.1],\n                        [0.2, 2.0, 0.3],\n                        [0.1, 0.3, 1.5]])\n        dt = 0.002\n        num_steps = 501\n        t_samples = np.linspace(0.0, (num_steps - 1) * dt, num_steps)\n        \n        R_series = np.zeros((num_steps, 3, 3))\n        for k, t in enumerate(t_samples):\n            Rz = get_rot_matrices(0.8 * t, 'z')\n            Rx = get_rot_matrices(0.3 * np.sin(2 * t), 'x')\n            Ry = get_rot_matrices(0.5 * t**2, 'y')\n            R_series[k] = Rz @ Rx @ Ry\n        \n        _, T_rot_series = compute_from_R_series(R_series, dt, I_b)\n        \n        M3 = np.mean(T_rot_series)\n        return M3\n\n    results = [run_case_1(), run_case_2(), run_case_3()]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}