{
    "hands_on_practices": [
        {
            "introduction": "掌握刚体动力学的第一步是理解其基本方程的来源和行为。本练习将引导您从几何力学的核心——左不变动能系统的拉格朗日-达朗贝尔原理出发，推导带扭矩的欧拉-庞加莱方程。通过求解球形转子这一特殊情况，您将清晰地看到外力矩如何影响角动量，而无需考虑由非球对称性引起的复杂内部陀螺效应 。",
            "id": "3773474",
            "problem": "考虑一个自由刚体，其姿态由特殊正交群(SO(3))中的一条曲线 $R(t)$ 描述，其物体角速度 $\\boldsymbol{\\omega}(t)\\in\\mathbb{R}^{3}$ 由运动学关系 $\\dot{R}(t)=R(t)\\,\\widehat{\\boldsymbol{\\omega}}(t)$ 定义，其中 $\\widehat{\\boldsymbol{\\omega}}$ 是通过同构 $\\mathbb{R}^{3}\\cong\\mathfrak{so}(3)$ 与 $\\boldsymbol{\\omega}$ 相关联的斜对称矩阵。物体角动量为 $\\mathbf{M}(t)\\in\\mathbb{R}^{3}$，通过惯性算子 $I:\\mathbb{R}^{3}\\to\\mathbb{R}^{3}$ 与 $\\boldsymbol{\\omega}$ 相关，即 $\\mathbf{M}=I\\,\\boldsymbol{\\omega}$。假设该物体是球形的，其惯性算子为 $I=\\lambda\\,\\mathbf{1}$（其中 $\\lambda>0$ 为常数），并受到一个恒定的物体力矩 $\\boldsymbol{\\tau}\\in\\mathbb{R}^{3}$（即 $\\boldsymbol{\\tau}$ 在物体坐标系中是恒定的）。设初始条件为 $R(0)=R_{0}\\in\\mathrm{SO}(3)$ 和 $\\mathbf{M}(0)=\\mathbf{M}_{0}\\in\\mathbb{R}^{3}$。\n\n从作用于 $\\mathrm{SO}(3)$ 上的左不变动能的 Lagrange-d'Alembert 原理出发，其中包含由物体力矩产生的功项，并利用 $\\mathfrak{so}(3)\\cong\\mathbb{R}^{3}$ 与向量叉积的等同关系，推导在物体力矩作用下 $\\mathbf{M}(t)$ 的物体固定演化方程，然后在球形情况下显式地求解该方程。在你的分析中，解释为何对于球形惯量，余伴随项会消失；描述所得的 $\\boldsymbol{\\omega}(t)$ 的特性；描述动能如何随时间演化；并讨论 $R(t)$ 在一般情况以及在 $\\mathbf{M}_{0}$ 和 $\\boldsymbol{\\tau}$ 共线的特殊情况下的结构。\n\n你的最终答案必须是 $\\mathbf{M}(t)$ 关于 $\\mathbf{M}_{0}$、$\\boldsymbol{\\tau}$ 和 $t$ 的显式闭式表达式。不需要进行数值计算，最终答案中不应包含单位。",
            "solution": "此问题要求从几何力学的框架内，基于 Lagrange-d'Alembert 原理，推导并求解一个受到恒定物体固定力矩作用的球形刚体的运动方程。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n- 位形空间是特殊正交群， $R(t) \\in \\mathrm{SO}(3)$。\n- 物体角速度为 $\\boldsymbol{\\omega}(t) \\in \\mathbb{R}^3$。\n- 运动学方程为 $\\dot{R}(t) = R(t)\\,\\widehat{\\boldsymbol{\\omega}}(t)$，其中 $\\widehat{\\cdot}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ 是定义李代数同构的 hat 映射。\n- 物体角动量为 $\\mathbf{M}(t) \\in \\mathbb{R}^3$，通过惯性算子 $I$ 与 $\\boldsymbol{\\omega}(t)$ 相关，即 $\\mathbf{M}=I\\,\\boldsymbol{\\omega}$。\n- 物体是球形的，因此 $I = \\lambda \\mathbf{1}$，其中 $\\lambda > 0$ 是一个标量。\n- 存在一个恒定的物体固定力矩 $\\boldsymbol{\\tau} \\in \\mathbb{R}^3$。\n- 初始条件为 $R(0)=R_0$ 和 $\\mathbf{M}(0)=\\mathbf{M}_0$。\n\n该问题在经典力学和几何力学中有科学依据，作为一个初值问题是适定的，并使用客观、形式化的语言陈述。它是自洽且一致的。因此，该问题是有效的。\n\n我们从应用 Lagrange-d'Alembert 原理开始。由于没有势能，系统的拉格朗日量就是其动能。对于刚体，动能是切丛 $T\\mathrm{SO}(3)$ 上的一个左不变二次型。在物体坐标系中，它由以下公式给出：\n$$\nT = \\frac{1}{2} \\langle \\boldsymbol{\\omega}, I\\boldsymbol{\\omega} \\rangle\n$$\n这里，$\\langle \\cdot, \\cdot \\rangle$ 表示 $\\mathbb{R}^3$ 上的标准内积。对于有外力作用的系统，Lagrange-d'Alembert 原理为：\n$$\n\\delta \\int_{t_1}^{t_2} T(\\boldsymbol{\\omega}) \\, dt + \\int_{t_1}^{t_2} \\mathcal{W}(\\delta q) \\, dt = 0\n$$\n其中 $\\mathcal{W}$ 是非保守力所做的虚功。轨迹 $R(t)$ 的一个变分可以在物体坐标系中通过一条曲线 $\\boldsymbol{\\eta}(t) \\in \\mathbb{R}^3$ 来表示，使得无穷小位移为 $\\delta R = R(t)\\widehat{\\boldsymbol{\\eta}}(t)$。对于这样一个虚位移，物体固定力矩 $\\boldsymbol{\\tau}$ 所做的虚功为 $\\mathcal{W} = \\langle \\boldsymbol{\\tau}, \\boldsymbol{\\eta} \\rangle$。注意，$\\boldsymbol{\\eta}$ 代表位移的虚角速度。因此，该原理为：\n$$\n\\int_{t_1}^{t_2} \\left[ \\delta T(\\boldsymbol{\\omega}) + \\langle \\boldsymbol{\\tau}, \\boldsymbol{\\eta} \\rangle \\right] dt = 0\n$$\n动能的变分为：\n$$\n\\delta T = \\frac{1}{2} \\delta \\langle \\boldsymbol{\\omega}, I\\boldsymbol{\\omega} \\rangle = \\langle \\delta\\boldsymbol{\\omega}, I\\boldsymbol{\\omega} \\rangle = \\langle \\mathbf{M}, \\delta\\boldsymbol{\\omega} \\rangle\n$$\n角速度的变分 $\\delta\\boldsymbol{\\omega}$ 与变分参数 $\\boldsymbol{\\eta}$ 通过李群上的变分公式（Euler-Poincaré 变分公式）相关联：\n$$\n\\delta\\boldsymbol{\\omega} = \\dot{\\boldsymbol{\\eta}} + \\boldsymbol{\\omega} \\times \\boldsymbol{\\eta}\n$$\n将这些代入原理中，得到：\n$$\n\\int_{t_1}^{t_2} \\left[ \\langle \\mathbf{M}, \\dot{\\boldsymbol{\\eta}} + \\boldsymbol{\\omega} \\times \\boldsymbol{\\eta} \\rangle + \\langle \\boldsymbol{\\tau}, \\boldsymbol{\\eta} \\rangle \\right] dt = 0\n$$\n我们对 $\\langle \\mathbf{M}, \\dot{\\boldsymbol{\\eta}} \\rangle$ 项进行分部积分：\n$$\n\\int_{t_1}^{t_2} \\langle \\mathbf{M}, \\dot{\\boldsymbol{\\eta}} \\rangle dt = \\left[ \\langle \\mathbf{M}, \\boldsymbol{\\eta} \\rangle \\right]_{t_1}^{t_2} - \\int_{t_1}^{t_2} \\langle \\dot{\\mathbf{M}}, \\boldsymbol{\\eta} \\rangle dt\n$$\n边界项为零，因为变分 $\\boldsymbol{\\eta}$ 在端点处取值为零，即 $\\boldsymbol{\\eta}(t_1) = \\boldsymbol{\\eta}(t_2) = \\mathbf{0}$。利用标量三重积的循环性质，$\\langle \\mathbf{M}, \\boldsymbol{\\omega} \\times \\boldsymbol{\\eta} \\rangle = \\langle \\boldsymbol{\\eta}, \\mathbf{M} \\times \\boldsymbol{\\omega} \\rangle$。积分变为：\n$$\n\\int_{t_1}^{t_2} \\left[ - \\langle \\dot{\\mathbf{M}}, \\boldsymbol{\\eta} \\rangle + \\langle \\mathbf{M} \\times \\boldsymbol{\\omega}, \\boldsymbol{\\eta} \\rangle + \\langle \\boldsymbol{\\tau}, \\boldsymbol{\\eta} \\rangle \\right] dt = 0\n$$\n$$\n\\int_{t_1}^{t_2} \\langle -\\dot{\\mathbf{M}} + \\mathbf{M} \\times \\boldsymbol{\\omega} + \\boldsymbol{\\tau}, \\boldsymbol{\\eta} \\rangle dt = 0\n$$\n由于这对任何在端点为零的任意光滑变分 $\\boldsymbol{\\eta}(t)$ 都必须成立，所以内积内的表达式必须为零。这就得到了带有外部物体力矩的刚体的 Euler-Poincaré 方程：\n$$\n\\dot{\\mathbf{M}} = \\mathbf{M} \\times \\boldsymbol{\\omega} + \\boldsymbol{\\tau}\n$$\n这个方程，通常写作 $\\dot{\\mathbf{M}} + \\boldsymbol{\\omega} \\times \\mathbf{M} = \\boldsymbol{\\tau}$，是物体角动量 $\\mathbf{M}$ 的一般演化方程。项 $\\mathbf{M} \\times \\boldsymbol{\\omega}$ 源于旋转的非对易性，并与李群在其李代数对偶空间上的余伴随作用有关。\n\n现在我们将其特化到给定的球形物体。惯性算子为 $I = \\lambda \\mathbf{1}$，其中 $\\lambda > 0$ 是一个常数。角动量 $\\mathbf{M}$ 和角速度 $\\boldsymbol{\\omega}$ 之间的关系变为：\n$$\n\\mathbf{M} = I\\boldsymbol{\\omega} = \\lambda\\mathbf{1}\\boldsymbol{\\omega} = \\lambda\\boldsymbol{\\omega}\n$$\n这意味着 $\\boldsymbol{\\omega} = \\frac{1}{\\lambda}\\mathbf{M}$。对于球形物体，物体角动量和角速度始终是平行的。\n\n我们将这个关系代入演化方程：\n$$\n\\dot{\\mathbf{M}} = \\mathbf{M} \\times \\left(\\frac{1}{\\lambda}\\mathbf{M}\\right) + \\boldsymbol{\\tau}\n$$\n任何向量与其自身的标量倍数的叉积为零：$\\mathbf{M} \\times (\\frac{1}{\\lambda}\\mathbf{M}) = \\frac{1}{\\lambda}(\\mathbf{M} \\times \\mathbf{M}) = \\mathbf{0}$。余伴随项 $\\mathbf{M}\\times \\boldsymbol{\\omega}$ 正是由于这种共线性而消失，这是球形惯性张量的一个独有特征。物理上，一个球形物体没有优选的旋转轴，因此物体的运动不会产生内部的陀螺力矩。\n\n因此，球形物体的演化方程大大简化为：\n$$\n\\dot{\\mathbf{M}}(t) = \\boldsymbol{\\tau}\n$$\n由于物体力矩 $\\boldsymbol{\\tau}$ 被给定为常数，这是一个简单的一阶向量常微分方程。我们可以直接对它从 $t=0$ 到任意时间 $t$ 进行积分：\n$$\n\\int_{0}^{t} \\dot{\\mathbf{M}}(s) ds = \\int_{0}^{t} \\boldsymbol{\\tau} ds\n$$\n$$\n\\mathbf{M}(t) - \\mathbf{M}(0) = \\boldsymbol{\\tau} t\n$$\n使用初始条件 $\\mathbf{M}(0) = \\mathbf{M}_0$，我们求得物体角动量的显式解：\n$$\n\\mathbf{M}(t) = \\mathbf{M}_0 + t\\boldsymbol{\\tau}\n$$\n\n现在我们可以描述 $\\boldsymbol{\\omega}(t)$、动能 $T(t)$ 和姿态 $R(t)$ 的特性。\n角速度为 $\\boldsymbol{\\omega}(t) = \\frac{1}{\\lambda}\\mathbf{M}(t)$，因此：\n$$\n\\boldsymbol{\\omega}(t) = \\frac{1}{\\lambda}(\\mathbf{M}_0 + t\\boldsymbol{\\tau})\n$$\n物体角速度向量 $\\boldsymbol{\\omega}(t)$ 从 $\\boldsymbol{\\omega}_0 = \\mathbf{M}_0/\\lambda$ 开始，并沿 $\\boldsymbol{\\tau}$ 的恒定方向随时间线性增加。$\\boldsymbol{\\omega}(t)$ 向量的尖端在物体坐标系中描绘出一条直线。\n\n动能为 $T = \\frac{1}{2}\\langle \\boldsymbol{\\omega}, \\mathbf{M} \\rangle = \\frac{1}{2\\lambda}\\|\\mathbf{M}\\|^2$。动能的演化为：\n$$\nT(t) = \\frac{1}{2\\lambda} \\|\\mathbf{M}_0 + t\\boldsymbol{\\tau}\\|^2 = \\frac{1}{2\\lambda} \\langle \\mathbf{M}_0 + t\\boldsymbol{\\tau}, \\mathbf{M}_0 + t\\boldsymbol{\\tau} \\rangle\n$$\n$$\nT(t) = \\frac{1}{2\\lambda} \\left( \\|\\mathbf{M}_0\\|^2 + 2t\\langle \\mathbf{M}_0, \\boldsymbol{\\tau} \\rangle + t^2\\|\\boldsymbol{\\tau}\\|^2 \\right)\n$$\n动能是时间的二次函数。其变化率为 $\\dot{T}(t) = \\frac{1}{\\lambda} (\\langle \\mathbf{M}_0, \\boldsymbol{\\tau} \\rangle + t\\|\\boldsymbol{\\tau}\\|^2)$。这等于力矩的功率输入 $P(t) = \\langle \\boldsymbol{\\tau}, \\boldsymbol{\\omega}(t) \\rangle = \\langle \\boldsymbol{\\tau}, \\frac{1}{\\lambda}(\\mathbf{M}_0 + t\\boldsymbol{\\tau}) \\rangle = \\frac{1}{\\lambda}(\\langle \\boldsymbol{\\tau}, \\mathbf{M}_0 \\rangle + t\\|\\boldsymbol{\\tau}\\|^2)$，这证实了功能定理。\n\n最后，我们讨论姿态矩阵 $R(t)$ 的结构。它是以下运动学初值问题的解：\n$$\n\\dot{R}(t) = R(t)\\,\\widehat{\\boldsymbol{\\omega}}(t), \\quad R(0) = R_0\n$$\n在一般情况下，矩阵生成元 $\\widehat{\\boldsymbol{\\omega}}(t) = \\frac{1}{\\lambda}(\\widehat{\\mathbf{M}_0} + t\\widehat{\\boldsymbol{\\tau}})$ 是依赖于时间的。解不能写成一个简单的矩阵指数形式，因为对于不同的时间 $t_1, t_2$，矩阵 $\\widehat{\\boldsymbol{\\omega}}(t_1)$ 和 $\\widehat{\\boldsymbol{\\omega}}(t_2)$ 不对易，除非 $\\mathbf{M}_0$ 和 $\\boldsymbol{\\tau}$ 是共线的。其对易子为 $[\\widehat{\\boldsymbol{\\omega}}(t_1), \\widehat{\\boldsymbol{\\omega}}(t_2)] = \\widehat{\\boldsymbol{\\omega}(t_1) \\times \\boldsymbol{\\omega}(t_2)} = \\frac{1}{\\lambda^2}(t_1-t_2)\\widehat{\\mathbf{M}_0 \\times \\boldsymbol{\\tau}} \\neq \\mathbf{0}$。形式解涉及一个时间排序指数，它通常没有简单的闭式形式。\n\n在 $\\mathbf{M}_0$ 和 $\\boldsymbol{\\tau}$ 共线（即它们平行或其中一个为零）的特殊情况下，向量 $\\mathbf{M}_0 \\times \\boldsymbol{\\tau} = \\mathbf{0}$，因此对易子 $[\\widehat{\\boldsymbol{\\omega}}(t_1), \\widehat{\\boldsymbol{\\omega}}(t_2)]$ 为零。在这种情况下，可以使用矩阵指数：\n$$\nR(t) = R_0 \\exp\\left( \\int_0^t \\widehat{\\boldsymbol{\\omega}}(s) ds \\right)\n$$\n积分角速度为：\n$$\n\\boldsymbol{\\theta}(t) = \\int_0^t \\boldsymbol{\\omega}(s) ds = \\int_0^t \\frac{1}{\\lambda}(\\mathbf{M}_0 + s\\boldsymbol{\\tau}) ds = \\frac{1}{\\lambda}\\left( t\\mathbf{M}_0 + \\frac{1}{2}t^2\\boldsymbol{\\tau} \\right)\n$$\n由于 $\\mathbf{M}_0$ 和 $\\boldsymbol{\\tau}$ 共线，$\\boldsymbol{\\theta}(t)$ 是一个始终指向它们共同方向的向量。解为 $R(t) = R_0 \\exp(\\widehat{\\boldsymbol{\\theta}(t)})$，这表示从初始方向 $R_0$ 开始，绕物体坐标系中的一个固定轴（$\\boldsymbol{\\tau}$ 的方向）旋转，旋转角度为 $\\|\\boldsymbol{\\theta}(t)\\|$，是时间的二次函数。\n\n问题要求给出 $\\mathbf{M}(t)$ 的显式闭式表达式。如上所述，这是一个时间的线性函数。",
            "answer": "$$\n\\boxed{\\mathbf{M}(t) = \\mathbf{M}_{0} + t\\boldsymbol{\\tau}}\n$$"
        },
        {
            "introduction": "在掌握了简单的球形刚体模型后，我们进一步探讨更普遍、动力学行为更丰富的非对称刚体。本练习将分析一个三轴惯量各不相同（三轴体）的刚体，在恒定体坐标系力矩作用下的稳态转动问题 。您将发现，由于刚体的非对称性，角速度 $\\boldsymbol{\\omega}$ 与角动量 $\\mathbf{M}$ 不再共线，这使得系统能够在外力矩下达到一种动态平衡，这是球形刚体无法实现的奇特现象。",
            "id": "3773453",
            "problem": "一个具有三个不同主转动惯量 $I_1$、$I_2$ 和 $I_3$（绕体固定的标准正交主轴 $\\{\\mathbf{e}_1,\\mathbf{e}_2,\\mathbf{e}_3\\}$）的刚体，以角速度 $\\boldsymbol{\\omega}$（在体坐标系中表示）进行转动。其体角动量为 $\\mathbf{M}=I\\boldsymbol{\\omega}$，其中在此基底下 $I=\\operatorname{diag}(I_1,I_2,I_3)$。该刚体受到一个恒定的体固定力矩 $\\boldsymbol{\\tau}=\\tau_3 \\mathbf{e}_3$，其中 $\\tau_3>0$。假设 $I_1 < I_2 < I_3$。求出刚体能维持这种稳态运动所需的最小动能。",
            "solution": "我们从体坐标系中的 Newton–Euler 方程开始，\n$$\n\\frac{d\\mathbf{M}}{dt}+\\boldsymbol{\\omega}\\times \\mathbf{M}=\\boldsymbol{\\tau}.\n$$\n体坐标系中的匀速转动稳态意味着 $\\boldsymbol{\\omega}$ 在体坐标系中是恒定的。由于 $\\mathbf{M}=I\\boldsymbol{\\omega}$，且 $I$ 在体坐标系（主轴）中是恒定的，这意味着 $\\frac{d\\mathbf{M}}{dt}=\\mathbf{0}$。因此，稳态条件简化为\n$$\n\\boldsymbol{\\omega}\\times \\mathbf{M}=\\boldsymbol{\\tau}.\n$$\n在主轴基底下，将 $\\boldsymbol{\\omega}=(\\omega_1,\\omega_2,\\omega_3)$ 和 $\\mathbf{M}=(I_1\\omega_1,I_2\\omega_2,I_3\\omega_3)$ 写出，我们计算叉积的分量：\n$$\n(\\boldsymbol{\\omega}\\times \\mathbf{M})_1=(I_3-I_2)\\,\\omega_2\\omega_3,\\quad\n(\\boldsymbol{\\omega}\\times \\mathbf{M})_2=(I_1-I_3)\\,\\omega_3\\omega_1,\\quad\n(\\boldsymbol{\\omega}\\times \\mathbf{M})_3=(I_2-I_1)\\,\\omega_1\\omega_2.\n$$\n施加的力矩为 $\\boldsymbol{\\tau}=(0,0,\\tau_3)$，其中 $\\tau_3>0$，所以稳态方程为\n$$\n(I_3-I_2)\\,\\omega_2\\omega_3=0,\\qquad\n(I_1-I_3)\\,\\omega_3\\omega_1=0,\\qquad\n(I_2-I_1)\\,\\omega_1\\omega_2=\\tau_3.\n$$\n假设 $I_1 < I_2 < I_3$，这意味着 $(I_3-I_2)>0$，$(I_1-I_3)<0$，以及 $(I_2-I_1)>0$。由于这些系数非零，前两个方程简化为 $\\omega_2\\omega_3=0$ 和 $\\omega_3\\omega_1=0$。这组方程意味着 $\\omega_3=0$ 或者 $\\omega_1=0=\\omega_2$。如果 $\\omega_1=\\omega_2=0$，那么第三个方程 $(I_2-I_1)\\omega_1\\omega_2=0$，但这与 $\\tau_3>0$ 相矛盾。因此，我们必须有 $\\omega_3=0$。\n\n当 $\\omega_3=0$ 时，前两个方程得到满足，第三个方程变为\n$$\n\\omega_1\\omega_2=\\frac{\\tau_3}{I_2-I_1}.\n$$\n动能为 $T=\\frac{1}{2}\\boldsymbol{\\omega}\\cdot\\mathbf{M}=\\frac{1}{2}(I_1\\omega_1^2+I_2\\omega_2^2)$（因为 $\\omega_3=0$）。我们现在需要最小化 $T$ 并满足约束 $\\omega_1\\omega_2=C$，其中 $C=\\frac{\\tau_3}{I_2-I_1}$。将 $\\omega_2=C/\\omega_1$ 代入 $T$ 的表达式中，\n$$\nT(\\omega_1)=\\frac{1}{2}\\left(I_1\\omega_1^2+\\frac{I_2 C^2}{\\omega_1^2}\\right).\n$$\n为求最小值，我们对 $\\omega_1$ 求导并令其为零：\n$$\n\\frac{dT}{d\\omega_1}=\\frac{1}{2}\\left(2 I_1\\omega_1-\\frac{2 I_2 C^2}{\\omega_1^3}\\right)=0.\n$$\n这给出 $I_1\\omega_1^4=I_2 C^2$，因此 $I_1\\omega_1^2 = \\sqrt{I_1 I_2} C$。同样地，我们可以证明 $I_2\\omega_2^2=\\sqrt{I_1 I_2}C$。因此，动能的最小值为\n$$\nT_{\\min}=\\frac{1}{2}(\\sqrt{I_1 I_2}C+\\sqrt{I_1 I_2}C)=\\sqrt{I_1 I_2}C=\\frac{\\tau_3\\sqrt{I_1 I_2}}{I_2-I_1}.\n$$",
            "answer": "$$\\boxed{\\frac{\\tau_3\\,\\sqrt{I_1 I_2}}{I_2 - I_1}}$$"
        },
        {
            "introduction": "从解析理论到计算实践是应用物理学和工程学的关键一步。虽然欧拉方程的解析解非常罕见，但数值积分使我们能够探索任意复杂情况下的刚体动力学行为 。本练习旨在将您在前两个练习中分析过的方程转化为可执行的代码，通过对比分量形式和矢量形式的数值实现，加深您对欧拉方程数学结构的理解，并锻炼您在计算动力学中的基本编程技能。",
            "id": "3773475",
            "problem": "考虑一个在其体坐标系中观测的自由转动刚体，其角速度表示为 $\\boldsymbol{\\omega}(t)$，体坐标系角动量为 $\\mathbf{L}(t)=\\mathbf{I}\\boldsymbol{\\omega}(t)$。此处，$\\mathbf{I}$ 是体坐标系中的转动惯量张量，取其对于主轴为对角阵，形式为 $\\mathbf{I}=\\mathrm{diag}(I_{1},I_{2},I_{3})$，而 $\\boldsymbol{\\tau}(t)$ 是体坐标系中的外加力矩。从角动量平衡和转动参考系的运动学出发，推导 $\\boldsymbol{\\omega}(t)$ 的固连于刚体的运动方程，要求以两种等价形式呈现：(i) 一组与主轴对齐的分量形式的常微分方程（ordinary differential equation (ODE)），以及 (ii) 一种包含叉积的紧凑矢量形式。然后，实现这两种形式，并针对下述数值测试套件，对它们随时间进行数值积分。通过计算在整个时间区间内，两种积分方法产生的角速度之间的最大分量绝对差，来对这两种实现进行定量比较。\n\n您的推导必须仅从基本定律和定义出发，例如空间坐标系中的角动量平衡以及空间坐标系与体坐标系之间时间导数的变换法则。不要假设或直接引用目标的分量形式或叉积形式的公式；应从第一性原理推导它们。\n\n数值细节与单位：\n- 转动惯量参数 $I_{1}$、$I_{2}$、$I_{3}$ 的单位为 $\\mathrm{kg}\\cdot\\mathrm{m}^{2}$。\n- 力矩 $\\boldsymbol{\\tau}(t)$ 的单位为 $\\mathrm{N}\\cdot\\mathrm{m}$。\n- 角速度 $\\boldsymbol{\\omega}(t)$ 的单位为 $\\mathrm{rad/s}$。\n- 时间 $t$ 的单位为 $\\mathrm{s}$，角度单位为弧度。\n\n积分要求：\n- 使用一个标准的数值ODE积分器，在指定的时间区间上，以相同的时间采样，为两种形式的公式计算 $\\boldsymbol{\\omega}(t)$。\n- 对于每个测试用例，在闭区间 $[0,T]$ 上的 $1001$ 个均匀间隔的时间点处对解进行采样。\n- 对于每个测试用例，计算标量\n$$\n\\Delta = \\max_{0\\leq k \\leq 1000} \\max_{j\\in\\{1,2,3\\}} \\left|\\omega^{(\\mathrm{comp})}_{j}(t_{k}) - \\omega^{(\\mathrm{vec})}_{j}(t_{k})\\right|,\n$$\n其中 $\\boldsymbol{\\omega}^{(\\mathrm{comp})}(t)$ 是从分量形式ODE得到的解，$\\boldsymbol{\\omega}^{(\\mathrm{vec})}(t)$ 是从矢量叉积形式得到的解。将 $\\Delta$ 以 $\\mathrm{rad/s}$ 为单位表示，并四舍五入至六位有效数字。\n\n测试套件：\n- 情况A（一般各向异性转动惯量，自由刚体）：\n  - $\\mathbf{I}=\\mathrm{diag}(2.0,1.5,1.0)\\ \\mathrm{kg}\\cdot\\mathrm{m}^{2}$，\n  - $\\boldsymbol{\\tau}(t)=\\mathbf{0}\\ \\mathrm{N}\\cdot\\mathrm{m}$，\n  - $\\boldsymbol{\\omega}(0)=\\begin{bmatrix}2.0\\\\0.8\\\\-1.2\\end{bmatrix}\\ \\mathrm{rad/s}$，\n  - $T=2.5\\ \\mathrm{s}$。\n- 情况B（绕第三轴的恒定力矩）：\n  - $\\mathbf{I}=\\mathrm{diag}(3.0,2.0,1.0)\\ \\mathrm{kg}\\cdot\\mathrm{m}^{2}$，\n  - $\\boldsymbol{\\tau}(t)=\\begin{bmatrix}0.0\\\\0.0\\\\0.2\\end{bmatrix}\\ \\mathrm{N}\\cdot\\mathrm{m}$，\n  - $\\boldsymbol{\\omega}(0)=\\begin{bmatrix}0.1\\\\-0.2\\\\0.0\\end{bmatrix}\\ \\mathrm{rad/s}$，\n  - $T=5.0\\ \\mathrm{s}$。\n- 情况C（前两轴近似对称，绕第一轴的正弦力矩）：\n  - $\\mathbf{I}=\\mathrm{diag}(1.0,1.01,2.0)\\ \\mathrm{kg}\\cdot\\mathrm{m}^{2}$，\n  - $\\boldsymbol{\\tau}(t)=\\begin{bmatrix}0.5\\sin(2\\pi t)\\\\0.0\\\\0.0\\end{bmatrix}\\ \\mathrm{N}\\cdot\\mathrm{m}$，\n  - $\\boldsymbol{\\omega}(0)=\\begin{bmatrix}0.0\\\\1.0\\\\0.0\\end{bmatrix}\\ \\mathrm{rad/s}$，\n  - $T=3.0\\ \\mathrm{s}$。\n- 情况D（各向同性转动惯量，自由刚体）：\n  - $\\mathbf{I}=\\mathrm{diag}(1.5,1.5,1.5)\\ \\mathrm{kg}\\cdot\\mathrm{m}^{2}$，\n  - $\\boldsymbol{\\tau}(t)=\\mathbf{0}\\ \\mathrm{N}\\cdot\\mathrm{m}$，\n  - $\\boldsymbol{\\omega}(0)=\\begin{bmatrix}0.5\\\\-0.5\\\\1.0\\end{bmatrix}\\ \\mathrm{rad/s}$，\n  - $T=4.0\\ \\mathrm{s}$。\n\n程序输出规范：\n- 您的程序应生成单行输出，其中包含情况A–D的结果，形式为一个由方括号括起来的逗号分隔列表。每个条目都是对应情况下 $\\Delta$ 的值（单位为 $\\mathrm{rad/s}$），并四舍五入至六位有效数字（例如，$\\left[1.23456\\mathrm{e}{-7},3.21000\\mathrm{e}{-8},\\dots\\right]$）。输出格式必须为：$\\left[\\Delta_{A},\\Delta_{B},\\Delta_{C},\\Delta_{D}\\right]$，不得包含任何额外文本。",
            "solution": "该问题是有效的，因为它科学上基于经典刚体动力学原理，是良构的，并为获得唯一解提供了充分信息，且以客观、正式的语言表述。该任务涉及欧拉运动方程的标准推导，随后进行数值实现和比较，这是计算力学中的一个标准练习。\n\n### 第1部分：固连于刚体的欧拉方程的推导\n\n我们的推导从两个基本原理开始：在惯性参考系中观测到的角动量守恒定律，以及转动参考系与惯性参考系之间矢量时间导数的运动学关系。\n\n设 $S$ 表示一个惯性参考系（“空间”坐标系），$B$ 表示一个固连于转动刚体的非惯性参考系（“体”坐标系）。设 $\\mathbf{A}$ 为任意矢量。在空间坐标系中观测到的 $\\mathbf{A}$ 的时间导数 $(\\frac{d\\mathbf{A}}{dt})_S$ 与在体坐标系中观测到的其时间导数 $(\\frac{d\\mathbf{A}}{dt})_B$ 通过输运定理相关联：\n$$\n\\left(\\frac{d\\mathbf{A}}{dt}\\right)_S = \\left(\\frac{d\\mathbf{A}}{dt}\\right)_B + \\boldsymbol{\\omega} \\times \\mathbf{A}\n$$\n此处，$\\boldsymbol{\\omega}$ 是体坐标系 $B$ 相对于空间坐标系 $S$ 的角速度矢量。在本推导的其余部分，除非另有明确说明，所有矢量（$\\boldsymbol{\\omega}$、角动量 $\\mathbf{L}$、力矩 $\\boldsymbol{\\tau}$）都以其在体坐标系 $B$ 中的分量表示。项 $(\\frac{d\\mathbf{A}}{dt})_B$ 表示矢量 $\\mathbf{A}$ 在体坐标系基底下的分量的变化率，我们将用一个点来表示，例如 $\\dot{\\mathbf{A}}$。\n\n转动动力学的基本定律（牛顿第二转动定律）指出，在惯性系中，角动量矢量 $\\mathbf{L}_S$ 的时间变化率等于施加于刚体上的净外力矩 $\\boldsymbol{\\tau}_S$（同样在惯性系中观测）。\n$$\n\\left(\\frac{d\\mathbf{L}}{dt}\\right)_S = \\boldsymbol{\\tau}_S\n$$\n我们现在将输运定理应用于角动量矢量 $\\mathbf{L}$：\n$$\n\\left(\\frac{d\\mathbf{L}}{dt}\\right)_S = \\dot{\\mathbf{L}} + \\boldsymbol{\\omega} \\times \\mathbf{L}\n$$\n力矩矢量 $\\boldsymbol{\\tau}$ 在坐标系之间的变换与其他任何矢量一样。如果 $R(t)$ 是从体坐标系到空间坐标系的旋转矩阵，则 $\\boldsymbol{\\tau}_S(t) = R(t)\\boldsymbol{\\tau}(t)$。令 $(\\frac{d\\mathbf{L}}{dt})_S$ 的两个表达式相等，并将力矩以体坐标系分量表示，可得：\n$$\n\\dot{\\mathbf{L}} + \\boldsymbol{\\omega} \\times \\mathbf{L} = \\boldsymbol{\\tau}\n$$\n这就是在体坐标系中欧拉运动方程的一般形式。\n\n体坐标系中的角动量 $\\mathbf{L}$ 通过转动惯量张量 $\\mathbf{I}$（也在体坐标系中）与角速度 $\\boldsymbol{\\omega}$ 相关：$\\mathbf{L} = \\mathbf{I}\\boldsymbol{\\omega}$。由于体坐标系固连于刚体，转动惯量张量 $\\mathbf{I}$ 在此坐标系中是恒定的。因此，其时间导数为零，我们有 $\\dot{\\mathbf{L}} = \\frac{d}{dt}(\\mathbf{I}\\boldsymbol{\\omega}) = \\mathbf{I}\\frac{d\\boldsymbol{\\omega}}{dt} = \\mathbf{I}\\dot{\\boldsymbol{\\omega}}$。\n\n将此代入一般形式可得：\n$$\n\\mathbf{I}\\dot{\\boldsymbol{\\omega}} + \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) = \\boldsymbol{\\tau}\n$$\n这就是所求的欧拉方程的**紧凑矢量形式 (ii)**。为了获得关于 $\\dot{\\boldsymbol{\\omega}}$ 的ODE，我们可以将其重新排列为 $\\dot{\\boldsymbol{\\omega}} = \\mathbf{I}^{-1} \\left( \\boldsymbol{\\tau} - \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) \\right)$。\n\n为了推导**分量形式 (i)**，我们将体坐标系的坐标轴与惯性主轴对齐。在此基底下，转动惯量张量 $\\mathbf{I}$ 是对角阵：\n$$\n\\mathbf{I} = \\begin{pmatrix} I_1 & 0 & 0 \\\\ 0 & I_2 & 0 \\\\ 0 & 0 & I_3 \\end{pmatrix}\n$$\n设 $\\boldsymbol{\\omega} = (\\omega_1, \\omega_2, \\omega_3)^T$ 和 $\\boldsymbol{\\tau} = (\\tau_1, \\tau_2, \\tau_3)^T$。我们计算矢量方程中的各项。\n首先，$\\mathbf{I}\\boldsymbol{\\omega} = (I_1\\omega_1, I_2\\omega_2, I_3\\omega_3)^T$。\n其次，是叉积项：\n$$\n\\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) = \\begin{pmatrix} \\omega_1 \\\\ \\omega_2 \\\\ \\omega_3 \\end{pmatrix} \\times \\begin{pmatrix} I_1\\omega_1 \\\\ I_2\\omega_2 \\\\ I_3\\omega_3 \\end{pmatrix} = \\begin{pmatrix} \\omega_2(I_3\\omega_3) - \\omega_3(I_2\\omega_2) \\\\ \\omega_3(I_1\\omega_1) - \\omega_1(I_3\\omega_3) \\\\ \\omega_1(I_2\\omega_2) - \\omega_2(I_1\\omega_1) \\end{pmatrix} = \\begin{pmatrix} (I_3 - I_2)\\omega_2\\omega_3 \\\\ (I_1 - I_3)\\omega_1\\omega_3 \\\\ (I_2 - I_1)\\omega_1\\omega_2 \\end{pmatrix}\n$$\n项 $\\mathbf{I}\\dot{\\boldsymbol{\\omega}} = (I_1\\dot{\\omega}_1, I_2\\dot{\\omega}_2, I_3\\dot{\\omega}_3)^T$。\n将这些代入矢量方程 $\\mathbf{I}\\dot{\\boldsymbol{\\omega}} + \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) = \\boldsymbol{\\tau}$，我们得到三个分量方程：\n$$\n\\begin{cases}\nI_1 \\dot{\\omega}_1 + (I_3 - I_2)\\omega_2\\omega_3 = \\tau_1 \\\\\nI_2 \\dot{\\omega}_2 + (I_1 - I_3)\\omega_1\\omega_3 = \\tau_2 \\\\\nI_3 \\dot{\\omega}_3 + (I_2 - I_1)\\omega_1\\omega_2 = \\tau_3\n\\end{cases}\n$$\n分离出时间导数 $\\dot{\\omega}_j$ 得到显式的一阶常微分方程组：\n$$\n\\begin{cases}\n\\dot{\\omega}_1 = \\frac{1}{I_1}\\left(\\tau_1 + (I_2 - I_3)\\omega_2\\omega_3\\right) \\\\\n\\dot{\\omega}_2 = \\frac{1}{I_2}\\left(\\tau_2 + (I_3 - I_1)\\omega_1\\omega_3\\right) \\\\\n\\dot{\\omega}_3 = \\frac{1}{I_3}\\left(\\tau_3 + (I_1 - I_2)\\omega_1\\omega_2\\right)\n\\end{cases}\n$$\n这就是所求的分量形式 (i)。\n\n### 第2部分：数值实现计划\n\n问题的数值部分要求使用两种公式，对四个测试用例中的每一个求解 $\\dot{\\boldsymbol{\\omega}} = f(t, \\boldsymbol{\\omega})$ 的初值问题。\n\n1.  **ODE求解器**：我们将为常微分方程系统 $\\dot{\\boldsymbol{\\omega}} = f(t, \\boldsymbol{\\omega})$ 的右端项（RHS）实现两个不同的函数，分别对应于推导出的两种形式。\n    *   `euler_comp_rhs(t, w, I, tau_func)`：此函数将直接实现分量形式的方程，其输入为状态矢量 `w`$=(\\omega_1, \\omega_2, \\omega_3)$、转动惯量张量 `I`$=(I_1, I_2, I_3)$ 以及一个用于表示力矩的函数 `tau_func(t)`。\n    *   `euler_vec_rhs(t, w, I, tau_func)`：此函数将实现紧凑矢量形式 $\\dot{\\boldsymbol{\\omega}} = \\mathbf{I}^{-1} \\left( \\boldsymbol{\\tau} - \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) \\right)$。它将使用NumPy的矢量和矩阵运算（`np.cross`、逐元素乘法和除法）以实现简洁的实现。\n\n2.  **积分**：对于每个测试用例，我们将使用 `scipy.integrate.solve_ivp` 函数，这是一个鲁棒的、自适应步长的ODE求解器。\n    *   我们将为每个RHS函数（`euler_comp_rhs` 和 `euler_vec_rhs`）各调用一次 `solve_ivp`，但使用相同的初始条件 $\\boldsymbol{\\omega}(0)$、时间区间 $[0, T]$ 和积分容差。\n    *   为了最小化源于积分器本身的数值误差，并分离出两种RHS实现之间的浮点差异，我们将使用严格的相对和绝对容差（例如 `rtol=1e-13`, `atol=1e-13`）。\n    *   将使用 `solve_ivp` 的 `t_eval` 参数，在 $[0, T]$ 区间内的 $1001$ 个均匀间隔的时间点 $t_k$ 上对解进行求值。\n\n3.  **比较**：在获得两个解的轨迹 $\\boldsymbol{\\omega}^{(\\mathrm{comp})}(t_k)$ 和 $\\boldsymbol{\\omega}^{(\\mathrm{vec})}(t_k)$ 之后，我们将计算所需的差异度量 $\\Delta$：\n    $$\n    \\Delta = \\max_{0\\leq k \\leq 1000} \\max_{j\\in\\{1,2,3\\}} \\left|\\omega^{(\\mathrm{comp})}_{j}(t_{k}) - \\omega^{(\\mathrm{vec})}_{j}(t_{k})\\right|\n    $$\n    这等价于在两个解数组的逐元素差中找到最大的绝对值。\n\n4.  **输出**：对于四个情况中的每一种，计算出的 $\\Delta$ 值将被格式化为六位有效数字的科学记数法，并以方括号括起来的逗号分隔列表形式打印。\n\n这个过程将被封装在一个遵循指定环境和输出格式的Python脚本中。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef euler_comp_rhs(t, w, I, tau_func):\n    \"\"\"\n    Computes the RHS of the Euler equations in component-wise form.\n    dot(w) = f(t, w)\n    \"\"\"\n    I1, I2, I3 = I\n    w1, w2, w3 = w\n    tau = tau_func(t)\n    tau1, tau2, tau3 = tau\n\n    dw1_dt = (tau1 + (I2 - I3) * w2 * w3) / I1\n    dw2_dt = (tau2 + (I3 - I1) * w1 * w3) / I2\n    dw3_dt = (tau3 + (I1 - I2) * w1 * w2) / I3\n\n    return np.array([dw1_dt, dw2_dt, dw3_dt])\n\ndef euler_vec_rhs(t, w, I_vec, tau_func):\n    \"\"\"\n    Computes the RHS of the Euler equations in vector form.\n    dot(w) = I_inv * (tau - w x (I*w))\n    \"\"\"\n    tau = tau_func(t)\n    # Since I is diagonal, I*w is element-wise multiplication\n    Iw = I_vec * w\n    # I_inv is also diagonal, so I_inv * vector is element-wise division\n    dw_dt = (tau - np.cross(w, Iw)) / I_vec\n    return dw_dt\n\ndef format_to_6_sf(n):\n    \"\"\"\n    Formats a number to 6 significant figures in scientific notation.\n    e.g., 1.234567e-8 -> 1.23457e-08.\n    The precision for 'e' format is (number of significant figures - 1).\n    \"\"\"\n    if n == 0.0:\n        return \"0.00000e+00\"\n    return f\"{n:.5e}\"\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run simulations, and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"I\": np.array([2.0, 1.5, 1.0]),\n            \"tau_func\": lambda t: np.zeros(3),\n            \"w0\": np.array([2.0, 0.8, -1.2]),\n            \"T\": 2.5,\n        },\n        {\n            \"name\": \"B\",\n            \"I\": np.array([3.0, 2.0, 1.0]),\n            \"tau_func\": lambda t: np.array([0.0, 0.0, 0.2]),\n            \"w0\": np.array([0.1, -0.2, 0.0]),\n            \"T\": 5.0,\n        },\n        {\n            \"name\": \"C\",\n            \"I\": np.array([1.0, 1.01, 2.0]),\n            \"tau_func\": lambda t: np.array([0.5 * np.sin(2.0 * np.pi * t), 0.0, 0.0]),\n            \"w0\": np.array([0.0, 1.0, 0.0]),\n            \"T\": 3.0,\n        },\n        {\n            \"name\": \"D\",\n            \"I\": np.array([1.5, 1.5, 1.5]),\n            \"tau_func\": lambda t: np.zeros(3),\n            \"w0\": np.array([0.5, -0.5, 1.0]),\n            \"T\": 4.0,\n        },\n    ]\n\n    results = []\n    num_points = 1001\n    # Use tight tolerances to minimize integrator error and isolate\n    # floating-point differences between the two RHS function implementations.\n    rtol = 1e-13\n    atol = 1e-13\n\n    for case in test_cases:\n        I = case['I']\n        tau_func = case['tau_func']\n        w0 = case['w0']\n        T = case['T']\n        \n        t_span = [0, T]\n        t_eval = np.linspace(0, T, num_points)\n\n        # Integrate component-wise formulation\n        sol_comp = solve_ivp(\n            euler_comp_rhs, t_span, w0, args=(I, tau_func),\n            t_eval=t_eval, rtol=rtol, atol=atol, method='RK45'\n        )\n        omega_comp = sol_comp.y\n        \n        # Integrate vector formulation\n        sol_vec = solve_ivp(\n            euler_vec_rhs, t_span, w0, args=(I, tau_func),\n            t_eval=t_eval, rtol=rtol, atol=atol, method='RK45'\n        )\n        omega_vec = sol_vec.y\n\n        # Calculate the maximum absolute componentwise difference\n        delta = np.max(np.abs(omega_comp - omega_vec))\n        \n        results.append(delta)\n\n    # Format results as specified\n    formatted_results = [format_to_6_sf(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}