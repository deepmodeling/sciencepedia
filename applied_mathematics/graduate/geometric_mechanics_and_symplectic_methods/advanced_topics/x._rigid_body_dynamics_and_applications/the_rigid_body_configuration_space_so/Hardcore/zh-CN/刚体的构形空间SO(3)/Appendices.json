{
    "hands_on_practices": [
        {
            "introduction": "这项练习旨在建立抽象的李代数语言与经典力学中我们熟悉的矢量运算之间的关键联系。通过显式计算 $\\mathfrak{so}(3)$ 上的李括号并将其映射回 $\\mathbb{R}^3$，您将正式证明两个斜对称矩阵的交换子对应于其矢量对应项的叉积。这个基本结果揭示了 $\\mathfrak{so}(3)$ 代数结构的神秘面纱，并且对于在体坐标系中推导运动方程至关重要。",
            "id": "3782390",
            "problem": "考虑一个自由刚体，其位形空间为特殊正交群 (SO(3))。其关联的李代数是实反对称矩阵的集合，记为 $\\mathfrak{so}(3)$，并配备有李括号 $[\\Omega,\\eta]=\\Omega\\,\\eta-\\eta\\,\\Omega$。三维实向量空间 $\\mathbb{R}^{3}$ 与 $\\mathfrak{so}(3)$ 之间的规范恒同（“帽映射”）定义为：为每个向量 $\\omega \\in \\mathbb{R}^{3}$ 指定一个反对称矩阵 $\\widehat{\\omega} \\in \\mathfrak{so}(3)$，使得对于所有 $x\\in\\mathbb{R}^{3}$，都有 $\\widehat{\\omega}\\,x=\\omega\\times x$，其中 $\\times$ 表示向量叉积。设 $\\Omega=\\widehat{\\omega}$ 和 $\\eta=\\widehat{\\eta}$ 是 $\\mathfrak{so}(3)$ 中分别对应于向量 $\\omega,\\eta\\in\\mathbb{R}^{3}$ 的两个元素。从 $\\mathfrak{so}(3)$ 上李括号的基本定义和帽映射的定义性质出发，计算伴随算子 $\\mathrm{ad}_{\\Omega}(\\eta)=[\\Omega,\\eta]$，并将其在逆帽映射下的像表示为 $\\mathbb{R}^{3}$ 中的单个向量。请用 $\\omega$ 和 $\\eta$ 将你的最终答案表示为单个闭式解析表达式（无需单位，也无需数值近似）。",
            "solution": "我们的目标是证明李代数 $\\mathfrak{so}(3)$ 上的李括号（矩阵交换子）在帽映射下对应于 $\\mathbb{R}^3$ 中的向量叉乘，即证明 $[\\widehat{\\omega},\\widehat{\\eta}] = \\widehat{\\omega\\times\\eta}$。\n\n最直接的证明方法是利用帽映射的定义性质 $\\widehat{v}x = v \\times x$ 和向量运算的雅可比恒等式。根据定义，矩阵 $[\\widehat{\\omega},\\widehat{\\eta}]$ 是否等于 $\\widehat{\\omega\\times\\eta}$，取决于它们对任意向量 $x \\in \\mathbb{R}^3$ 是否产生相同的作用。\n\n首先，计算李括号 $[\\widehat{\\omega},\\widehat{\\eta}]$ 对任意向量 $x \\in \\mathbb{R}^3$ 的作用：\n$$\n[\\widehat{\\omega},\\widehat{\\eta}]x = (\\widehat{\\omega}\\widehat{\\eta} - \\widehat{\\eta}\\widehat{\\omega})x = \\widehat{\\omega}(\\widehat{\\eta}x) - \\widehat{\\eta}(\\widehat{\\omega}x)\n$$\n利用帽映射的定义，将矩阵-向量乘法替换为叉乘：\n$$\n\\widehat{\\omega}(\\widehat{\\eta}x) = \\omega \\times (\\eta \\times x)\n$$\n$$\n\\widehat{\\eta}(\\widehat{\\omega}x) = \\eta \\times (\\omega \\times x)\n$$\n因此，\n$$\n[\\widehat{\\omega},\\widehat{\\eta}]x = \\omega \\times (\\eta \\times x) - \\eta \\times (\\omega \\times x)\n$$\n现在，我们应用向量三重积的雅可比恒等式：\n$$\nA \\times (B \\times C) + B \\times (C \\times A) + C \\times (A \\times B) = 0\n$$\n令 $A=\\omega$, $B=\\eta$, $C=x$。整理上式可得：\n$$\n\\omega \\times (\\eta \\times x) = - \\eta \\times (x \\times \\omega) - x \\times (\\omega \\times \\eta)\n$$\n利用叉乘的反交换性 $x \\times \\omega = - \\omega \\times x$ 和 $x \\times (\\omega \\times \\eta) = - (\\omega \\times \\eta) \\times x$，我们得到：\n$$\n\\omega \\times (\\eta \\times x) = \\eta \\times (\\omega \\times x) + (\\omega \\times \\eta) \\times x\n$$\n移项可得：\n$$\n\\omega \\times (\\eta \\times x) - \\eta \\times (\\omega \\times x) = (\\omega \\times \\eta) \\times x\n$$\n将此结果与我们之前的表达式相结合：\n$$\n[\\widehat{\\omega},\\widehat{\\eta}]x = (\\omega \\times \\eta) \\times x\n$$\n最后，根据帽映射的定义，$(\\omega \\times \\eta) \\times x$ 正是矩阵 $\\widehat{\\omega\\times\\eta}$ 对向量 $x$ 的作用。\n$$\n\\widehat{\\omega\\times\\eta}x = (\\omega \\times \\eta) \\times x\n$$\n由于 $[\\widehat{\\omega},\\widehat{\\eta}]x = \\widehat{\\omega\\times\\eta}x$ 对所有 $x \\in \\mathbb{R}^3$ 都成立，我们必然得出矩阵本身是相等的：\n$$\n[\\widehat{\\omega},\\widehat{\\eta}] = \\widehat{\\omega\\times\\eta}\n$$\n对两边应用逆帽映射（vee map），我们得到伴随作用在 $\\mathbb{R}^3$ 中的向量形式：\n$$\n(\\mathrm{ad}_{\\widehat{\\omega}}(\\widehat{\\eta}))^{\\vee} = ([\\widehat{\\omega},\\widehat{\\eta}])^{\\vee} = \\omega\\times\\eta\n$$\n因此，在帽映射同构 $\\mathbb{R}^{3}\\cong\\mathfrak{so}(3)$ 下，伴随算子对应于 $\\mathbb{R}^{3}$ 中的向量叉积，所求的表达式即为单个向量 $\\omega\\times\\eta$。",
            "answer": "$$\\boxed{\\omega\\times\\eta}$$"
        },
        {
            "introduction": "虽然群 $SO(3)$ 完整地描述了刚体的姿态，但在实际应用中我们常常依赖于像欧拉角这样的局部坐标。本练习将通过推导连接欧拉角速率与物体角速度的雅可比矩阵，来探究广泛使用的 $ZYZ$ 欧拉角参数化的性质。通过分析该雅可比矩阵在何处变得奇异，您将对“万向节死锁”现象——这一许多姿态表示方法的关键局限——获得一个具体而深刻的理解。",
            "id": "3782402",
            "problem": "令特殊正交群 (SO(3)) 由 $ZYZ$ 欧拉角映射 $\\Phi : \\mathbb{R}^{3} \\to SO(3)$ 参数化，其表达式为\n$$\nR(\\phi,\\theta,\\psi) \\;=\\; R_{z}(\\phi)\\,R_{y}(\\theta)\\,R_{z}(\\psi),\n$$\n其中 $R_{z}(\\alpha)$ 是绕 z 轴旋转角度 $\\alpha$ 的旋转，$R_{y}(\\beta)$ 是绕 y 轴旋转角度 $\\beta$ 的旋转。假设所有角度均以弧度为单位。仅使用以下基本定义和事实：\n- $SO(3) = \\{ R \\in \\mathbb{R}^{3 \\times 3} \\mid R^{\\top}R = I,\\ \\det R = 1 \\}$，\n- 帽映射 $\\widehat{(\\cdot)} : \\mathbb{R}^{3} \\to \\mathfrak{so}(3)$ 满足 $\\widehat{\\omega}\\,x = \\omega \\times x$，\n- 物体角速度 $\\omega \\in \\mathbb{R}^{3}$ 由 $\\widehat{\\omega} = R^{\\top}\\dot{R}$ 定义，\n- 对任意 $Q \\in SO(3)$ 和 $v \\in \\mathbb{R}^{3}$ 成立的恒等式 $Q^{\\top}\\,\\widehat{v}\\,Q = \\widehat{Q^{\\top}v}$，\n\n推导左平凡化雅可比矩阵 $J(\\phi,\\theta,\\psi) \\in \\mathbb{R}^{3 \\times 3}$，该矩阵通过 $\\omega = J(\\phi,\\theta,\\psi)\\,(\\dot{\\phi},\\dot{\\theta},\\dot{\\psi})^{\\top}$ 将欧拉角速率 $(\\dot{\\phi},\\dot{\\theta},\\dot{\\psi})$ 映射到物体角速度 $\\omega$。然后计算行列式 $\\det J(\\phi,\\theta,\\psi)$ 并找出雅可比矩阵降秩的奇点集合。\n\n对于您的最终答案，仅提供 $\\det J(\\phi,\\theta,\\psi)$ 关于 $\\phi,\\theta,\\psi$ 的精确解析表达式（无单位，不进行四舍五入）。角度必须以弧度处理。",
            "solution": "我们的目标是推导左平凡化雅可比矩阵 $J(\\phi, \\theta, \\psi)$，它通过线性映射 $\\omega = J(\\phi, \\theta, \\psi) (\\dot{\\phi}, \\dot{\\theta}, \\dot{\\psi})^{\\top}$ 将欧拉角的时间导数 $(\\dot{\\phi}, \\dot{\\theta}, \\dot{\\psi})$ 与物体角速度 $\\omega$ 联系起来。随后，我们必须计算该雅可比矩阵的行列式并确定其奇点。\n\n刚体的位形由一个旋转矩阵 $R \\in SO(3)$ 描述，该矩阵通过 $ZYZ$ 欧拉角 $(\\phi, \\theta, \\psi)$ 参数化为\n$$\nR(\\phi, \\theta, \\psi) = R_{z}(\\phi) R_{y}(\\theta) R_{z}(\\psi)\n$$\n为简洁起见，我们记 $R_1 = R_z(\\phi)$，$R_2 = R_y(\\theta)$，$R_3 = R_z(\\psi)$，因此 $R = R_1 R_2 R_3$。\n\n物体角速度 $\\omega \\in \\mathbb{R}^3$ 由关系式 $\\widehat{\\omega} = R^{\\top}\\dot{R}$ 定义，其中 $\\widehat{(\\cdot)}$ 是从 $\\mathbb{R}^3$ 到由 $3 \\times 3$ 斜对称矩阵构成的李代数 $\\mathfrak{so}(3)$ 的帽映射。\n\n我们首先使用乘法法则计算 $R$ 的时间导数：\n$$\n\\dot{R} = \\frac{d}{dt}(R_1 R_2 R_3) = \\dot{R}_1 R_2 R_3 + R_1 \\dot{R}_2 R_3 + R_1 R_2 \\dot{R}_3\n$$\n将此代入 $\\widehat{\\omega}$ 的定义中：\n$$\n\\widehat{\\omega} = (R_1 R_2 R_3)^{\\top} (\\dot{R}_1 R_2 R_3 + R_1 \\dot{R}_2 R_3 + R_1 R_2 \\dot{R}_3)\n$$\n使用对任意 $Q \\in SO(3)$ 均有 $Q^{\\top}Q = I$（$3 \\times 3$ 单位矩阵）的性质，我们分配转置：\n$$\n\\widehat{\\omega} = R_3^{\\top} R_2^{\\top} R_1^{\\top} \\dot{R}_1 R_2 R_3 + R_3^{\\top} R_2^{\\top} R_1^{\\top} R_1 \\dot{R}_2 R_3 + R_3^{\\top} R_2^{\\top} R_1^{\\top} R_1 R_2 \\dot{R}_3\n$$\n$$\n\\widehat{\\omega} = R_3^{\\top} R_2^{\\top} (R_1^{\\top} \\dot{R}_1) R_2 R_3 + R_3^{\\top} (R_2^{\\top} \\dot{R}_2) R_3 + (R_3^{\\top} \\dot{R}_3)\n$$\n形式为 $Q^{\\top}\\dot{Q}$ 的项表示瞬时角速度。令 $e_1 = (1,0,0)^{\\top}$，$e_2 = (0,1,0)^{\\top}$ 和 $e_3 = (0,0,1)^{\\top}$ 为 $\\mathbb{R}^3$ 中的标准基向量。我们有：\n$$\n\\dot{R}_1 = \\frac{dR_z(\\phi)}{d\\phi}\\dot{\\phi} \\implies R_1^{\\top}\\dot{R}_1 = R_z(\\phi)^{\\top} \\frac{dR_z(\\phi)}{d\\phi}\\dot{\\phi} = \\widehat{e_3}\\dot{\\phi}\n$$\n$$\n\\dot{R}_2 = \\frac{dR_y(\\theta)}{d\\theta}\\dot{\\theta} \\implies R_2^{\\top}\\dot{R}_2 = R_y(\\theta)^{\\top} \\frac{dR_y(\\theta)}{d\\theta}\\dot{\\theta} = \\widehat{e_2}\\dot{\\theta}\n$$\n$$\n\\dot{R}_3 = \\frac{dR_z(\\psi)}{d\\psi}\\dot{\\psi} \\implies R_3^{\\top}\\dot{R}_3 = R_z(\\psi)^{\\top} \\frac{dR_z(\\psi)}{d\\psi}\\dot{\\psi} = \\widehat{e_3}\\dot{\\psi}\n$$\n将这些表达式代回 $\\widehat{\\omega}$ 的方程中：\n$$\n\\widehat{\\omega} = R_3^{\\top} R_2^{\\top} (\\widehat{e_3}\\dot{\\phi}) R_2 R_3 + R_3^{\\top} (\\widehat{e_2}\\dot{\\theta}) R_3 + \\widehat{e_3}\\dot{\\psi}\n$$\n使用帽映射的线性性质以及给定的恒等式 $Q^{\\top}\\widehat{v}Q = \\widehat{Q^{\\top}v}$（对于 $Q \\in SO(3)$）：\n第一项变为 $\\widehat{(R_2 R_3)^{\\top} e_3} \\dot{\\phi} = \\widehat{R_3^{\\top}R_2^{\\top} e_3} \\dot{\\phi}$。\n第二项变为 $\\widehat{R_3^{\\top} e_2} \\dot{\\theta}$。\n第三项为 $\\widehat{e_3} \\dot{\\psi}$。\n\n结合这些项：\n$$\n\\widehat{\\omega} = \\widehat{R_3^{\\top}R_2^{\\top} e_3} \\dot{\\phi} + \\widehat{R_3^{\\top} e_2} \\dot{\\theta} + \\widehat{e_3} \\dot{\\psi} = \\widehat{(R_3^{\\top}R_2^{\\top} e_3 \\dot{\\phi} + R_3^{\\top} e_2 \\dot{\\theta} + e_3 \\dot{\\psi})}\n$$\n由于帽映射是 $\\mathbb{R}^3$ 到 $\\mathfrak{so}(3)$ 的一个同构，我们可以令向量参数相等：\n$$\n\\omega = (R_3^{\\top}R_2^{\\top} e_3) \\dot{\\phi} + (R_3^{\\top} e_2) \\dot{\\theta} + e_3 \\dot{\\psi}\n$$\n该方程的形式为 $\\omega = J (\\dot{\\phi}, \\dot{\\theta}, \\dot{\\psi})^{\\top}$，其中雅可比矩阵 $J$ 的列是角速率的向量系数：\n$$\nJ(\\phi, \\theta, \\psi) = \\begin{pmatrix} R_3^{\\top}R_2^{\\top} e_3 & R_3^{\\top} e_2 & e_3 \\end{pmatrix}\n$$\n我们现在显式地计算这些列向量。所需的旋转矩阵为：\n$$\nR_y(\\theta) = \\begin{pmatrix} \\cos\\theta & 0 & \\sin\\theta \\\\ 0 & 1 & 0 \\\\ -\\sin\\theta & 0 & \\cos\\theta \\end{pmatrix} \\quad , \\quad R_z(\\psi) = \\begin{pmatrix} \\cos\\psi & -\\sin\\psi & 0 \\\\ \\sin\\psi & \\cos\\psi & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n它们的转置是 $R_y(\\theta)^{\\top} = R_y(-\\theta)$ 和 $R_z(\\psi)^{\\top} = R_z(-\\psi)$。\n\n$J$ 的第三列：\n$j_3 = e_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n\n$J$ 的第二列：\n$j_2 = R_3^{\\top} e_2 = R_z(-\\psi) e_2 = \\begin{pmatrix} \\cos\\psi & \\sin\\psi & 0 \\\\ -\\sin\\psi & \\cos\\psi & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sin\\psi \\\\ \\cos\\psi \\\\ 0 \\end{pmatrix}$。\n\n$J$ 的第一列：\n$j_1 = R_3^{\\top}R_2^{\\top} e_3$。首先，$R_2^{\\top} e_3 = R_y(-\\theta) e_3 = \\begin{pmatrix} \\cos\\theta & 0 & -\\sin\\theta \\\\ 0 & 1 & 0 \\\\ \\sin\\theta & 0 & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -\\sin\\theta \\\\ 0 \\\\ \\cos\\theta \\end{pmatrix}$。\n然后，$j_1 = R_3^{\\top} (R_2^{\\top} e_3) = \\begin{pmatrix} \\cos\\psi & \\sin\\psi & 0 \\\\ -\\sin\\psi & \\cos\\psi & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ 0 \\\\ \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} -\\sin\\theta\\cos\\psi \\\\ \\sin\\theta\\sin\\psi \\\\ \\cos\\theta \\end{pmatrix}$。\n\n组合成雅可比矩阵 $J$：\n$$\nJ(\\phi, \\theta, \\psi) = \\begin{pmatrix}\n-\\sin\\theta\\cos\\psi & \\sin\\psi & 0 \\\\\n\\sin\\theta\\sin\\psi & \\cos\\psi & 0 \\\\\n\\cos\\theta & 0 & 1\n\\end{pmatrix}\n$$\n注意，对于 $ZYZ$ 序列，物体速度的雅可比矩阵与第一个角 $\\phi$ 无关。\n\n接下来，我们计算 $J$ 的行列式。为简便起见，我们沿第三列进行代数余子式展开：\n$$\n\\det J = (0) C_{13} + (0) C_{23} + (1) C_{33}\n$$\n其中 $C_{ij}$ 是代数余子式。\n$$\n\\det J = C_{33} = (-1)^{3+3} \\det \\begin{pmatrix} -\\sin\\theta\\cos\\psi & \\sin\\psi \\\\ \\sin\\theta\\sin\\psi & \\cos\\psi \\end{pmatrix}\n$$\n$$\n\\det J = (-\\sin\\theta\\cos\\psi)(\\cos\\psi) - (\\sin\\psi)(\\sin\\theta\\sin\\psi)\n$$\n$$\n\\det J = -\\sin\\theta\\cos^2\\psi - \\sin\\theta\\sin^2\\psi\n$$\n提出公因子 $-\\sin\\theta$：\n$$\n\\det J = -\\sin\\theta(\\cos^2\\psi + \\sin^2\\psi)\n$$\n使用基本三角恒等式 $\\cos^2\\psi + \\sin^2\\psi = 1$：\n$$\n\\det J(\\phi, \\theta, \\psi) = -\\sin\\theta\n$$\n欧拉角表示的奇点发生在雅可比矩阵 $J$ 降秩时，这等价于其行列式为零。\n$$\n\\det J = 0 \\implies -\\sin\\theta = 0\n$$\n当 $\\theta = k\\pi$（对于任意整数 $k \\in \\mathbb{Z}$）时，此条件满足。这些 $\\theta$ 值对应于所谓的“万向节死锁”现象，此时三个旋转轴中的两个会重合，导致从角速率到角速度的映射失去一个自由度。",
            "answer": "$$\\boxed{-\\sin(\\theta)}$$"
        },
        {
            "introduction": "对刚体运动进行数值积分带来了一个挑战：标准方法往往无法遵循 $SO(3)$ 流形的几何约束，导致非物理性的漂移。这个动手编程任务将引导您实现并比较一个朴素的欧拉积分器与两种保结构方法：一种是投影法，另一种是基于指数映射的李群积分器。通过这种比较，您将直观地领会到几何积分方法对于实现刚体动力学长期稳定且精确的仿真所具有的实际重要性。",
            "id": "3782405",
            "problem": "考虑由特殊正交群 $SO(3)$ 定义的刚体位形空间，即所有满足 $R^\\top R = I$ 和 $\\det(R) = 1$ 的实 $3 \\times 3$ 矩阵 $R$ 的集合。刚体运动学由一阶常微分方程 $\\dot{R} = R \\widehat{\\omega}$ 控制，其中 $\\omega \\in \\mathbb{R}^3$ 是体角速度，$\\widehat{\\omega} \\in \\mathfrak{so}(3)$ 是对应的斜对称矩阵表示，其定义为对于任何 $v \\in \\mathbb{R}^3$ 都有 $\\widehat{\\omega} v = \\omega \\times v$。全文中的角度单位必须是弧度。\n\n从这些基本定义出发，您必须：\n\n1. 推导并实现一个到 $SO(3)$ 上的正交投影方法。该方法给定一个通过单步显式欧拉法 $\\widetilde{R} = R + h R \\widehat{\\omega}$ 产生的数值更新矩阵 $\\widetilde{R}$，返回一个矩阵 $R_{\\text{proj}} \\in SO(3)$。该投影必须通过求解在约束集 $SO(3)$ 上最小化与 $\\widetilde{R}$ 的弗罗贝尼乌斯范数距离的最小二乘问题来获得。您必须用极分解或数学上等价的构造来表达您的推导，但不得在没有论证的情况下假设或引用任何现成的公式。\n\n2. 基于 $SO(3)$ 上的指数映射，使用从初始 $R$ 开始的 $\\dot{R} = R \\widehat{\\omega}$ 的时间-$h$ 流，实现一个李群更新 $R_{\\text{lie}}$。对于常数 $\\omega$ 的运动学方程，此更新必须是精确的，即 $R_{\\text{lie}} = R \\exp(h \\widehat{\\omega})$。\n\n3. 对三个矩阵 $R_{\\text{naive}} = \\widetilde{R}$、$R_{\\text{proj}}$ 和 $R_{\\text{lie}}$，定量比较以下结构保持和漂移度量：\n   - 正交性误差，通过弗罗贝尼乌斯范数 $e_{\\text{orth}}(R) = \\lVert R^\\top R - I \\rVert_F$ 衡量。\n   - 特殊性误差，通过 $e_{\\det}(R) = \\lvert \\det(R) - 1 \\rvert$ 衡量。\n   - 成员布尔值 $b_{\\text{SO3}}(R)$，当且仅当 $e_{\\text{orth}}(R) \\le \\varepsilon$ 且 $e_{\\det}(R) \\le \\varepsilon$ 且 $\\det(R) > 0$ 时为真，其中 $\\varepsilon$ 是一个固定的容差。\n   - 相对于李群方法的漂移，通过弗罗贝尼乌斯距离 $d_F(R, R_{\\text{lie}}) = \\lVert R - R_{\\text{lie}} \\rVert_F$ 衡量。\n   - 相对于李群方法的漂移，通过测地角 $d_\\theta(R, R_{\\text{lie}})$ 衡量，其中 $d_\\theta$ 是 $R^\\top R_{\\text{lie}} \\in SO(3)$ 的旋转角，使用恒等式 $\\theta = \\arccos\\!\\left(\\frac{\\operatorname{tr}(R^\\top R_{\\text{lie}}) - 1}{2}\\right)$ 从其迹计算得出，为确保数值稳定性，$\\arccos$ 的参数被限制在区间 $[-1, 1]$ 内。\n\n使用以下由初始条件、角速度和时间步组成的测试套件。在所有情况下，初始旋转矩阵 $R_0$ 必须使用标准的轴-角到$SO(3)$映射，由一个轴-角对 $(u, \\alpha)$ 构建；所有角度均以弧度为单位，时间步长 $h$ 以秒为单位：\n\n- 测试用例 1：$R_0 = I$，$\\omega = [0.3, -0.2, 0.5]$，$h = 0.05$。\n- 测试用例 2：$R_0$ 是绕 $x$ 轴旋转角度 $\\alpha = 1.0$ 的旋转，即轴 $u = [1, 0, 0]$，$\\omega = [0.7, 1.2, -0.4]$，$h = 0.2$。\n- 测试用例 3：$R_0 = I$，$\\omega = [0.0, 0.0, 0.0]$，$h = 1.0$。\n- 测试用例 4：$R_0$ 是绕轴 $u = \\frac{1}{\\sqrt{3}}[1, 1, 1]$ 旋转角度 $\\alpha = \\pi - 0.001$ 的旋转，$\\omega = [10.0, -8.0, 6.0]$，$h = 0.001$。\n\n对于每个测试用例，执行一个显式欧拉运动学步骤以获得 $\\widetilde{R}$，然后通过您推导的投影方法计算 $R_{\\text{proj}}$，通过指数映射李群更新计算 $R_{\\text{lie}}$。使用容差 $\\varepsilon = 10^{-12}$，为每个测试用例生成列表\n$[e_{\\text{orth}}(R_{\\text{naive}}), e_{\\det}(R_{\\text{naive}}), b_{\\text{SO3}}(R_{\\text{naive}}), e_{\\text{orth}}(R_{\\text{proj}}), e_{\\det}(R_{\\text{proj}}), b_{\\text{SO3}}(R_{\\text{proj}}), e_{\\text{orth}}(R_{\\text{lie}}), e_{\\det}(R_{\\text{lie}}), b_{\\text{SO3}}(R_{\\text{lie}}), d_F(R_{\\text{naive}}, R_{\\text{lie}}), d_\\theta(R_{\\text{naive}}, R_{\\text{lie}}), d_F(R_{\\text{proj}}, R_{\\text{lie}}), d_\\theta(R_{\\text{proj}}, R_{\\text{lie}})]$，其中所有浮点数条目必须四舍五入到 $12$ 位小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身就是上述列表（例如，$[[\\dots],[\\dots],[\\dots],[\\dots]]$）。不允许外部输入，所有计算必须按照上述规范执行。",
            "solution": "该问题要求对特殊正交群 $SO(3)$ 上的刚体运动学的三种数值更新方案进行比较分析。该运动学由常微分方程 $\\dot{R} = R \\widehat{\\omega}$ 描述，其中 $R(t) \\in SO(3)$ 是姿态矩阵，$\\omega \\in \\mathbb{R}^3$ 是恒定的体固角速度。我们将从初始姿态 $R_0$ 开始，分析大小为 $h$ 的单个时间步。要比较的方法是一个朴素的显式欧拉步、一个将欧拉步投影到 $SO(3)$ 上的投影法，以及一个基于指数映射的精确李群积分器。\n\n首先，我们建立数学框架。位形空间是李群 $SO(3) = \\{ R \\in \\mathbb{R}^{3 \\times 3} \\mid R^\\top R = I, \\det(R) = 1 \\}$。其对应的李代数是 $\\mathfrak{so}(3)$，即 $3 \\times 3$ 斜对称矩阵的空间。帽子映射 $\\widehat{\\cdot}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ 提供了 $\\mathbb{R}^3$ 中的向量与斜对称矩阵之间的一个同构，使得对于 $\\omega = [\\omega_x, \\omega_y, \\omega_z]^\\top$，我们有：\n$$ \\widehat{\\omega} = \\begin{pmatrix} 0 & -\\omega_z & \\omega_y \\\\ \\omega_z & 0 & -\\omega_x \\\\ -\\omega_y & \\omega_x & 0 \\end{pmatrix} $$\n\n比较的基础将是一个朴素的欧拉更新 $R_{\\text{naive}}$ 和两个保结构更新 $R_{\\text{proj}}$ 和 $R_{\\text{lie}}$。\n\n**1. 正交投影方法 ($R_{\\text{proj}}$)**\n\n显式欧拉法将姿态更新为 $R_{k+1} = R_k + h \\dot{R}_k$。对于我们的系统，这会产生一个更新后的矩阵 $\\widetilde{R} = R_0 + h R_0 \\widehat{\\omega}$。这个我们记为 $R_{\\text{naive}}$ 的矩阵 $\\widetilde{R}$ 通常不属于 $SO(3)$，也就是说，它不会是完全正交的，其行列式也不会恰好为 $1$。\n\n任务是找到一个矩阵 $R_{\\text{proj}} \\in SO(3)$，它在弗罗贝尼乌斯范数下最接近 $\\widetilde{R}$。这等价于求解以下约束优化问题：\n$$ R_{\\text{proj}} = \\arg\\min_{R \\in SO(3)} \\lVert \\widetilde{R} - R \\rVert_F $$\n弗罗贝尼乌斯范数的平方是 $\\lVert A \\rVert_F^2 = \\operatorname{tr}(A^\\top A)$。最小化范数等价于最小化其平方：\n$$ \\min_{R \\in SO(3)} \\operatorname{tr}\\left( (\\widetilde{R} - R)^\\top (\\widetilde{R} - R) \\right) $$\n展开迹，我们得到：\n$$ \\operatorname{tr}(\\widetilde{R}^\\top \\widetilde{R} - \\widetilde{R}^\\top R - R^\\top \\widetilde{R} + R^\\top R) = \\operatorname{tr}(\\widetilde{R}^\\top \\widetilde{R}) - \\operatorname{tr}(\\widetilde{R}^\\top R) - \\operatorname{tr}(R^\\top \\widetilde{R}) + \\operatorname{tr}(R^\\top R) $$\n给定 $R \\in SO(3)$，我们知道 $R^\\top R = I$，所以 $\\operatorname{tr}(R^\\top R) = \\operatorname{tr}(I) = 3$。项 $\\operatorname{tr}(\\widetilde{R}^\\top \\widetilde{R})$ 相对于优化变量 $R$ 是一个常数。利用迹的性质 $\\operatorname{tr}(A) = \\operatorname{tr}(A^\\top)$，我们有 $\\operatorname{tr}(\\widetilde{R}^\\top R) = \\operatorname{tr}(( \\widetilde{R}^\\top R )^\\top) = \\operatorname{tr}(R^\\top \\widetilde{R})$。因此，最小化问题等价于最大化项 $\\operatorname{tr}(R^\\top \\widetilde{R})$。\n\n为了解决这个最大化问题，我们使用 $\\widetilde{R}$ 的奇异值分解（SVD），其形式为 $\\widetilde{R} = U S V^\\top$，其中 $U, V \\in O(3)$ 是正交矩阵，$S$ 是一个对角矩阵，其对角线上的奇异值为非负数，$\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$。\n我们希望最大化 $\\operatorname{tr}(R^\\top U S V^\\top)$。利用迹的循环性质，这等于 $\\operatorname{tr}(V^\\top R^\\top U S)$。令 $Q = V^\\top R^\\top U$。由于 $V, R, U$ 都是正交矩阵，$Q$ 也是一个正交矩阵。目标变为最大化 $\\operatorname{tr}(Q S)$。\n$$ \\operatorname{tr}(Q S) = \\sum_{i=1}^3 (QS)_{ii} = \\sum_{i=1}^3 \\sum_{j=1}^3 Q_{ij} S_{jj} \\delta_{ij} = \\sum_{i=1}^3 Q_{ii} \\sigma_i $$\n由于 $Q$ 是正交的，其对角元素满足 $|Q_{ii}| \\le 1$。因为 $\\sigma_i \\ge 0$，当 $Q_{ii}$ 尽可能大时，该和达到最大值。\n\n约束 $R \\in SO(3)$ 意味着 $\\det(R)=1$。我们有 $\\det(Q) = \\det(V^\\top)\\det(R^\\top)\\det(U) = \\det(V)\\det(R)\\det(U) = \\det(U)\\det(V)$。我们必须选择一个具有此行列式值的正交矩阵 $Q$ 来最大化 $\\sum Q_{ii}\\sigma_i$。\n欧拉步 $\\widetilde{R} = R_0(I+h\\widehat{\\omega})$ 确保了对于足够小的 $h$，有 $\\det(\\widetilde{R}) > 0$。因为 $\\det(\\widetilde{R}) = \\det(U)\\det(S)\\det(V)$，且 $\\det(S) \\ge 0$，所以 $\\det(U)\\det(V) > 0$。由于 $\\det(U), \\det(V) \\in \\{-1, 1\\}$，我们必须有 $\\det(U)\\det(V) = 1$。因此，$\\det(Q)=1$。在满足 $\\det(Q)=1$ 的正交矩阵 $Q \\in O(3)$ 中，使 $\\operatorname{tr}(QS)$ 最大化的矩阵是 $Q=I$。\n设 $Q=I$ 得到 $V^\\top R^\\top U = I$，这意味着 $R^\\top = V U^\\top$，因此 $R = U V^\\top$。\n这个选择，$R_{\\text{proj}} = U V^\\top$，属于 $SO(3)$，因为 $\\det(R_{\\text{proj}}) = \\det(U)\\det(V^\\top) = \\det(U)\\det(V)=1$。这就得到了所需的投影方法。\n对于 $\\det(\\widetilde{R})$ 可能为负的一般情况，最优选择是 $R=U\\operatorname{diag}(1,1,\\det(UV^\\top))V^\\top$。\n\n**2. 李群积分器 ($R_{\\text{lie}}$)**\n\n对于一个恒定的角速度 $\\omega$，运动学方程 $\\dot{R} = R \\widehat{\\omega}$ 有一个精确的解析解，该解由从李代数 $\\mathfrak{so}(3)$ 到李群 $SO(3)$ 的指数映射给出。\n在时间 $t$ 的解是 $R(t) = R(0) \\exp(t\\widehat{\\omega})$。因此，对于大小为 $h$ 的单个时间步，精确更新为：\n$$ R_{\\text{lie}} = R_0 \\exp(h \\widehat{\\omega}) $$\n对于一个斜对称矩阵 $A = h\\widehat{\\omega}$，矩阵指数 $\\exp(A)$ 可以使用罗德里格旋转公式高效计算。令 $\\theta = h \\lVert \\omega \\rVert$ 为总旋转角，$\\mathbf{u} = \\omega / \\lVert \\omega \\rVert$ 为单位旋转轴（对于 $\\omega \\neq 0$）。那么：\n$$ \\exp(h \\widehat{\\omega}) = I + (\\sin \\theta) \\widehat{\\mathbf{u}} + (1 - \\cos \\theta) \\widehat{\\mathbf{u}}^2 $$\n这个公式是精确的，并且通过构造可以得到一个在 $SO(3)$ 中的矩阵。在计算上，使用稳健的库函数来计算矩阵指数，例如 `scipy.linalg.expm`，以处理 $\\lVert\\omega\\rVert$ 接近于零的情况，从而避免数值不稳定性。\n\n**3. 定量度量**\n\n三个矩阵 $R_{\\text{naive}}$、$R_{\\text{proj}}$ 和 $R_{\\text{lie}}$ 使用几种度量进行评估：\n- $e_{\\text{orth}}(R) = \\lVert R^\\top R - I \\rVert_F$：这衡量了与正交性的偏差。对于 $R \\in SO(3)$，此误差为 $0$。\n- $e_{\\det}(R) = |\\det(R) - 1|$：这衡量了与行列式为 $1$ 的“特殊”性质的偏差。对于 $R \\in SO(3)$，此误差为 $0$。\n- $b_{\\text{SO3}}(R)$：这是一个布尔指标，如果矩阵在满足 $SO(3)$ 属性的小容差 $\\varepsilon$ 范围内，则为真。\n- $d_F(R, R_{\\text{lie}}) = \\lVert R - R_{\\text{lie}} \\rVert_F$：这衡量了给定更新方案在环境欧几里得空间 $\\mathbb{R}^{3 \\times 3}$ 中与精确李群解的漂移。\n- $d_\\theta(R, R_{\\text{lie}}) = \\arccos\\left(\\frac{\\operatorname{tr}(R^\\top R_{\\text{lie}}) - 1}{2}\\right)$：这衡量了在流形 $SO(3)$ 上近似解 $R$ 和精确解 $R_{\\text{lie}}$ 之间的测地距离。它表示将 $R$ 与 $R_{\\text{lie}}$ 对齐的相对旋转 $R^\\top R_{\\text{lie}}$ 的角度。\n\n通过将这些方法和度量应用于指定的测试用例，我们可以定量评估每种积分方案的性能。朴素欧拉法预计会累积误差并偏离 $SO(3)$ 流形。投影法将在每一步强制执行流形约束，但可能无法精确地遵循真实轨迹。李群方法，由于对本问题是精确的，可作为基准真值，并且预计其正交性和特殊性误差在机器精度范围内为零。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the rigid body kinematics problem by comparing three update methods:\n    naive Euler, projection onto SO(3), and a Lie group integrator.\n    \"\"\"\n\n    def hat(v):\n        \"\"\"Maps a 3D vector to its corresponding skew-symmetric matrix.\"\"\"\n        return np.array([\n            [0, -v[2], v[1]],\n            [v[2], 0, -v[0]],\n            [-v[1], v[0], 0]\n        ])\n\n    def axis_angle_to_R(u, alpha):\n        \"\"\"Constructs a rotation matrix from an axis-angle representation.\"\"\"\n        if np.linalg.norm(u) == 0:\n            return np.identity(3)\n        u_hat = hat(u / np.linalg.norm(u))\n        return np.identity(3) + np.sin(alpha) * u_hat + (1 - np.cos(alpha)) * (u_hat @ u_hat)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'R0': np.identity(3), 'omega': np.array([0.3, -0.2, 0.5]), 'h': 0.05},\n        {'R0': axis_angle_to_R(np.array([1., 0., 0.]), 1.0), 'omega': np.array([0.7, 1.2, -0.4]), 'h': 0.2},\n        {'R0': np.identity(3), 'omega': np.array([0.0, 0.0, 0.0]), 'h': 1.0},\n        {'R0': axis_angle_to_R(np.array([1., 1., 1.]) / np.sqrt(3), np.pi - 0.001), 'omega': np.array([10.0, -8.0, 6.0]), 'h': 0.001},\n    ]\n\n    all_results = []\n    TOL = 1e-12\n\n    for case in test_cases:\n        R0 = case['R0']\n        omega = case['omega']\n        h = case['h']\n        \n        omega_hat = hat(omega)\n\n        # 1. Naive explicit Euler update\n        R_naive = R0 + h * (R0 @ omega_hat)\n\n        # 2. Lie group update (exact solution for constant omega)\n        R_lie = R0 @ expm(h * omega_hat)\n        \n        # 3. Orthogonal projection of R_naive onto SO(3)\n        U, _, Vt = np.linalg.svd(R_naive)\n        D = np.identity(3)\n        D[2, 2] = np.linalg.det(U @ Vt)\n        R_proj = U @ D @ Vt\n\n        matrices = {'naive': R_naive, 'proj': R_proj, 'lie': R_lie}\n        results = []\n\n        # Calculate metrics for each matrix\n        metrics_per_matrix = {}\n        for name, R in matrices.items():\n            e_orth = np.linalg.norm(R.T @ R - np.identity(3), 'fro')\n            det_R = np.linalg.det(R)\n            e_det = np.abs(det_R - 1)\n            b_so3 = (e_orth <= TOL) and (e_det <= TOL) and (det_R > 0)\n            metrics_per_matrix[name] = [round(e_orth, 12), round(e_det, 12), b_so3]\n\n        # Append metrics in the specified order\n        results.extend(metrics_per_matrix['naive'])\n        results.extend(metrics_per_matrix['proj'])\n        results.extend(metrics_per_matrix['lie'])\n\n        # Calculate drift metrics relative to R_lie\n        for R_test in [R_naive, R_proj]:\n            # Frobenius distance\n            d_F = np.linalg.norm(R_test - R_lie, 'fro')\n            \n            # Geodesic angle\n            R_rel = R_test.T @ R_lie\n            trace_R_rel = np.trace(R_rel)\n            # Clamp argument to arccos to handle potential floating point inaccuracies\n            arg = np.clip((trace_R_rel - 1.0) / 2.0, -1.0, 1.0)\n            d_theta = np.arccos(arg)\n            \n            results.append(round(d_F, 12))\n            results.append(round(d_theta, 12))\n        \n        all_results.append(results)\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to string representation.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\n# solve() # The call is commented out to prevent execution in this environment. The output should be generated by the user.\n```"
        }
    ]
}