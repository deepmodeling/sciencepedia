{
    "hands_on_practices": [
        {
            "introduction": "掌握任何新理论的第一步，是将其与已知的经典结果联系起来。本练习旨在通过亲手计算，验证抽象的李-泊松括号如何自然地导出我们所熟悉的刚体欧拉方程 。这是一个基础性的实践，它确保我们能够正确运用李-泊松形式体系来描述动力学演化，从而巩固我们对该理论核心机制的理解。",
            "id": "647224",
            "problem": "自由刚体的动力学可以在旋转李代数的对偶空间 $\\mathfrak{so}(3)^*$ 上的哈密顿框架中描述。我们可以将此对偶空间等同于 $\\mathbb{R}^3$，其中坐标 $(L_1, L_2, L_3)$ 表示在一个固定于刚体上的参考系（体参考系）中角动量矢量的分量。\n\n光滑函数空间 $F, G \\in C^\\infty(\\mathfrak{so}(3)^*)$ 上的泊松结构由李-泊松括号给出：\n$$\n\\{F, G\\}(\\mathbf{L}) = - \\sum_{i,j,k=1}^3 \\epsilon_{ijk} L_k \\frac{\\partial F}{\\partial L_i} \\frac{\\partial G}{\\partial L_j}\n$$\n其中 $\\epsilon_{ijk}$ 是列维-奇维塔符号。该括号由基本括号关系 $\\{L_i, L_j\\} = -\\epsilon_{ijk} L_k$ 确定。\n\n自由刚体的哈密顿量，用体参考系角动量分量表示，由其动能给出：\n$$\nH(L_1, L_2, L_3) = \\frac{1}{2}\\left(\\frac{L_1^2}{I_1} + \\frac{L_2^2}{I_2} + \\frac{L_3^2}{I_3}\\right)\n$$\n其中 $I_1, I_2, I_3$ 是刚体的主转动惯量。\n\n任何可观测量 $F$ 的时间演化由哈密顿方程 $\\frac{dF}{dt} = \\{F, H\\}$ 控制。使用所提供的定义，推导角动量第一个分量时间演化的显式表达式，这对应于计算李-泊松括号 $\\{L_1, H\\}$。",
            "solution": "我们使用李-泊松括号\n$$\\{F,G\\}(\\mathbf L)=-\\sum_{i,j,k}\\epsilon_{ijk}L_k\\frac{\\partial F}{\\partial L_i}\\frac{\\partial G}{\\partial L_j},$$\n和哈密顿方程 $\\dot F=\\{F,H\\}$。因此\n$$\\{L_1,H\\}=-\\sum_{j,k=1}^3\\epsilon_{1jk}L_k\\frac{\\partial H}{\\partial L_j}.$$\n由于\n$$\\frac{\\partial H}{\\partial L_j}=\\frac{L_j}{I_j},\\quad j=1,2,3,$$\n只有 $j=2,3$ 对求和有贡献。我们有\n$$\\{L_1,H\\}=-\\bigl(\\epsilon_{123}L_3\\frac{L_2}{I_2}+\\epsilon_{132}L_2\\frac{L_3}{I_3}\\bigr)\n=-\\Bigl(L_3\\frac{L_2}{I_2}-L_2\\frac{L_3}{I_3}\\Bigr)\n=L_2L_3\\Bigl(\\frac1{I_3}-\\frac1{I_2}\\Bigr).$$\n注意到 $\\frac1{I_3}-\\frac1{I_2}=\\frac{I_2-I_3}{I_2I_3}$，即可得到最终结果。",
            "answer": "$$\\boxed{\\frac{I_2-I_3}{I_2I_3}L_2L_3}$$"
        },
        {
            "introduction": "在掌握了如何通过李-泊松括号生成动力学方程之后，我们自然要深入探索其背后丰富的几何结构。这个练习将引导我们从计算转向概念综合，挑战我们对李-泊松约化理论中一系列核心概念的理解 。通过分析卡西米尔不变量 (Casimir invariants)、余伴随轨道 (coadjoint orbits) 以及平衡点的稳定性，我们将揭示该几何框架的深刻内涵。",
            "id": "3754326",
            "problem": "考虑一个自由刚体，其位形流形为 $SO(3)$，体坐标系下的惯性算子为 $I:\\mathbb{R}^3\\to\\mathbb{R}^3$，该算子是对称正定的，并且沿着一个标准正交基 $\\{e_1,e_2,e_3\\}$ 有三个互异的主转动惯量 $I_1  I_2  I_3$。系统的动力学通过李-泊松约化被描述在 $\\mathfrak{so}(3)^* \\cong \\mathbb{R}^3$ 上，状态由体角动量 $M$ 给出。\n\n下列哪些陈述是正确的？\n\nA. $\\mathfrak{so}(3)^*$ 上的约化动力学是关于李-泊松括号的哈密顿系统，其哈密顿量为 $H(M)=\\tfrac{1}{2}\\,M\\cdot I^{-1}M$，且协伴随轨道是 $\\lVert M\\rVert^2$ 的水平集，因此是 2-球面。\n\nB. 函数 $C(M)=\\tfrac{1}{2}\\lVert M\\rVert^2$ 是一个卡西米尔函数，即在李-泊松括号下，它与任意光滑函数都泊松对易，因此在 $\\mathfrak{so}(3)^*$ 上的任意哈密顿流中都是守恒的。\n\nC. 约化动力学的非平凡平衡点恰好是那些与 $I$ 的主轴对齐的 $M$。对于 $I_1  I_2  I_3$，绕中间轴 $e_2$ 的旋转是不稳定的，而绕最小轴 $e_1$ 和最大轴 $e_3$ 的旋转是稳定的。\n\nD. 协伴随轨道是辛流形，其辛形式由基里洛夫-康斯坦-苏里奥形式给出。$\\mathfrak{so}(3)^*$ 上的李-泊松括号本身是非退化的。\n\nE. 系统的每条轨迹都是能量椭球 $\\{M \\mid H(M) = E\\}$ 和卡西米尔球面 $\\{M \\mid \\lVert M \\rVert^2 = c^2\\}$ 的交集。",
            "solution": "问题陈述描述了一个自由刚体的约化动力学。我们首先为李群 $G=SO(3)$ 建立李-泊松约化的数学框架。\n\n$SO(3)$ 的李代数是 $\\mathfrak{so}(3)$，即 $3 \\times 3$ 反对称矩阵的空间。该代数与配备了叉积的 $\\mathbb{R}^3$ 同构。这个同构由“帽子”映射 $\\hat{\\cdot}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ 给出，它将一个向量 $\\xi = (\\xi_1, \\xi_2, \\xi_3)^T$ 映射到矩阵\n$$ \\hat{\\xi} = \\begin{pmatrix} 0  -\\xi_3  \\xi_2 \\\\ \\xi_3  0  -\\xi_1 \\\\ -\\xi_2  \\xi_1  0 \\end{pmatrix} $$\n$\\mathfrak{so}(3)$ 上的李括号是矩阵对易子，它通过 $[\\hat{\\xi}, \\hat{\\eta}] = \\widehat{\\xi \\times \\eta}$ 与 $\\mathbb{R}^3$ 中的叉积相关联。\n\n李代数的对偶空间 $\\mathfrak{so}(3)^*$ 可以通过标准点积与 $\\mathbb{R}^3$ 等同。一个元素 $\\mu \\in \\mathfrak{so}(3)^*$ 被等同为一个向量 $M \\in \\mathbb{R}^3$，使得它们的配对为 $\\langle \\mu, \\hat{\\xi} \\rangle = M \\cdot \\xi$。在刚体的背景下，$M$ 表示在物体固联坐标系中的角动量。\n\n对于一个一般的李代数 $\\mathfrak{g}$，其对偶空间 $\\mathfrak{g}^*$ 上的李-泊松括号对两个光滑函数 $F, H \\in C^\\infty(\\mathfrak{g}^*)$ 定义为\n$$ \\{F, H\\}(\\mu) = \\left\\langle \\mu, \\left[ \\frac{\\delta F}{\\delta \\mu}, \\frac{\\delta H}{\\delta \\mu} \\right] \\right\\rangle $$\n这里，$\\frac{\\delta F}{\\delta \\mu} \\in \\mathfrak{g}$ 是 $F$ 的泛函导数。对于坐标为 $M$ 的 $\\mathfrak{g}^* \\cong \\mathbb{R}^3$，泛函导数 $\\frac{\\delta F}{\\delta M}$ 就是梯度 $\\nabla_M F \\in \\mathbb{R}^3$。在 $\\mathfrak{so}(3) \\cong \\mathbb{R}^3$ 的等同关系下，李括号是叉积，配对是点积。因此，$\\mathfrak{so}(3)^* \\cong \\mathbb{R}^3$ 上的李-泊松括号是\n$$ \\{F, H\\}(M) = - M \\cdot (\\nabla_M F \\times \\nabla_M H) $$\n这里的负号取决于约定，但它必须与运动方程保持一致。变量 $M$ 的哈密顿运动方程由 $\\dot{M}_i = \\{M_i, H\\}$ 给出。如果使用此处的负号，计算结果为 $\\dot{M} = - M \\times \\nabla_M H$。欧拉方程的标准形式是 $\\dot{M} + \\Omega \\times M = 0$，即 $\\dot{M} = M \\times \\Omega$。由于 $\\Omega = I^{-1}M = \\nabla_M H$，我们需要李-泊松括号为 $\\{F, H\\}(M) = - M \\cdot (\\nabla_M F \\times \\nabla_M H)$。所以我们的公式是正确的。运动方程是：$\\dot{M}_i = \\{M_i,H\\} = -M \\cdot (\\nabla M_i \\times \\nabla H) = -M \\cdot (e_i \\times \\nabla H) = -(M \\times e_i) \\cdot \\nabla H = (e_i \\times M)\\cdot \\nabla H = e_i \\cdot (M \\times \\nabla H)$。因此，$\\dot{M}=M\\times \\nabla_M H$。\n\n自由刚体的哈密顿量是其动能。在体坐标系中，角速度为 $\\Omega = I^{-1}M$，其中 $I$ 是惯性张量。哈密顿量是\n$$ H(M) = \\frac{1}{2} M \\cdot \\Omega = \\frac{1}{2} M \\cdot (I^{-1}M) $$\n在主轴坐标系 $\\{e_1, e_2, e_3\\}$ 中，惯性张量是对角的，$I = \\text{diag}(I_1, I_2, I_3)$，所以 $I^{-1} = \\text{diag}(1/I_1, 1/I_2, 1/I_3)$。哈密顿量是\n$$ H(M) = \\frac{1}{2} \\left( \\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3} \\right) $$\n哈密顿量的梯度是 $\\nabla_M H = I^{-1}M$。运动方程，即著名的欧拉方程，是：\n$$ \\dot{M} = M \\times (I^{-1}M) $$\n\n现在我们来评估每个陈述。\n\n**A. $\\mathfrak{so}(3)^*$ 上的约化动力学是关于李-泊松括号的哈密顿系统，其哈密顿量为 $H(M)=\\tfrac{1}{2}\\,M\\cdot I^{-1}M$，且协伴随轨道是 $\\lVert M\\rVert^2$ 的水平集，因此是 2-球面。**\n\n陈述的第一部分是正确的，这已由一个世纪的力学研究工作所确立，并由上述推导所证实。该系统是具有指定括号和哈密顿量的哈密顿系统。\n对于第二部分，我们必须确定协伴随轨道。$G$ 在 $\\mathfrak{g}^*$ 上的协伴随作用定义为 $\\langle \\text{Ad}^*_g \\mu, \\xi \\rangle = \\langle \\mu, \\text{Ad}_{g^{-1}} \\xi \\rangle$，对于 $g \\in G, \\mu \\in \\mathfrak{g}^*, \\xi \\in \\mathfrak{g}$。对于 $G=SO(3)$，在 $\\mathfrak{so}(3) \\cong \\mathbb{R}^3$ 上的伴随作用是 $\\text{Ad}_R \\omega = R\\omega$，对于 $R \\in SO(3)$ 和 $\\omega \\in \\mathbb{R}^3$。因此，对于 $M \\in \\mathfrak{so}(3)^* \\cong \\mathbb{R}^3$：\n$$ \\langle \\text{Ad}^*_R M, \\omega \\rangle = \\langle M, \\text{Ad}_{R^{-1}} \\omega \\rangle = M \\cdot (R^{-1}\\omega) = (R M) \\cdot \\omega $$\n这意味着 $\\text{Ad}^*_R M = RM$。通过一个点 $M_0 \\in \\mathbb{R}^3$ 的协伴随轨道是集合 $\\{ R M_0 \\mid R \\in SO(3) \\}$。对于 $M_0 \\neq 0$，这是一个半径为 $\\lVert M_0 \\rVert$ 的球面。这些球面正是函数 $f(M) = \\lVert M \\rVert^2$ 的水平集。如果 $M_0=0$，轨道就是点 $\\{0\\}$。因此，协伴随轨道是以原点为中心的 2-球面（以及原点本身）。\n该陈述是正确的。\n_结论：正确。_\n\n**B. 函数 $C(M)=\\tfrac{1}{2}\\lVert M\\rVert^2$ 是一个卡西米尔函数，即在李-泊松括号下，它与任意光滑函数都泊松对易，因此在 $\\mathfrak{so}(3)^*$ 上的任意哈密顿流中都是守恒的。**\n\n一个函数 $C$ 是卡西米尔函数，当且仅当对所有光滑函数 $F$，都有 $\\{C, F\\} = 0$。使用 $\\mathfrak{so}(3)^*$ 的李-泊松括号：\n$$ \\{C, F\\}(M) = - M \\cdot (\\nabla_M C \\times \\nabla_M F) $$\n对于 $C(M) = \\frac{1}{2}\\lVert M \\rVert^2 = \\frac{1}{2}(M_1^2 + M_2^2 + M_3^2)$，其梯度为 $\\nabla_M C = M$。\n将此代入括号公式：\n$$ \\{C, F\\}(M) = - M \\cdot (M \\times \\nabla_M F) $$\n根据定义，向量 $M \\times \\nabla_M F$ 与 $M$ 正交。因此，它们的点积对于任何 $M$ 和任何 $F$ 都为零。因此，$C(M)=\\frac{1}{2}\\lVert M\\rVert^2$ 是一个卡西米尔函数。\n相空间上任意函数 $C$ 的时间演化由 $\\dot{C} = \\{C, H\\}$ 给出。如果 $C$ 是一个卡西米尔函数，那么对于*任何*哈密顿量 $H$，都有 $\\{C, H\\}=0$。因此，卡西米尔函数是给定李-泊松流形上所有哈密顿系统的守恒量。\n该陈述是正确的。\n_结论：正确。_\n\n**C. 约化动力学的非平凡平衡点恰好是那些与 $I$ 的主轴对齐的 $M$。对于 $I_1  I_2  I_3$，绕中间轴 $e_2$ 的旋转是不稳定的，而绕最小轴 $e_1$ 和最大轴 $e_3$ 的旋转是稳定的。**\n\n平衡点是 $\\dot{M}=0$ 的点。从欧拉方程 $\\dot{M} = M \\times (I^{-1}M)$ 可知，平衡点满足 $M \\times (I^{-1}M) = 0$。这意味着 $M$ 和 $I^{-1}M$ 是平行的。由于 $I^{-1}$ 是对角矩阵 $\\text{diag}(1/I_1, 1/I_2, 1/I_3)$ 且主惯量互异，这种情况只在 $M$ 沿着三个主轴之一时发生（除非 $M=0$）。所以平衡点是形如 $(c,0,0), (0,c,0), (0,0,c)$ 的点。\n稳定性可以通过线性化或能量-卡西米尔方法来确定。著名的结果是，绕具有最大和最小转动惯量的主轴旋转是稳定的，而绕中间轴的旋转是不稳定的。\n该陈述是正确的。\n_结论：正确。_\n\n**D. 协伴随轨道是辛流形，其辛形式由基里洛夫-康斯坦-苏里奥形式给出。$\\mathfrak{so}(3)^*$ 上的李-泊松括号本身是非退化的。**\n\n陈述的第一部分是正确的。协伴随轨道确实是辛流形，配备了自然的基里洛夫-康斯坦-苏里奥（KKS）辛形式。\n然而，陈述的第二部分是错误的。李-泊松括号在整个空间 $\\mathfrak{so}(3)^*$ 上是*退化*的。一个泊松括号是非退化的当且仅当它没有卡西米尔函数（除了常数函数）。正如我们在（B）中看到的，$C(M)=\\frac{1}{2}\\lVert M\\rVert^2$ 是一个非平凡的卡西米尔函数。它的存在意味着括号是退化的。退化的方向由卡西米尔函数的梯度给出。李-泊松流形的叶状结构由辛叶组成，在我们的例子中，这些辛叶就是协伴随轨道。括号*在限制于*每个协伴随轨道（辛叶）时是非退化的。\n由于陈述的第二部分是错误的，所以整个陈述 D 是错误的。\n_结论：错误。_\n\n**E. 系统的每条轨迹都是能量椭球 $\\{M \\mid H(M) = E\\}$ 和卡西米尔球面 $\\{M \\mid \\lVert M \\rVert^2 = c^2\\}$ 的交集。**\n\n动力学守恒两个独立的量：哈密顿量 $H(M)$（能量）和卡西米尔函数 $C(M)=\\frac{1}{2}\\lVert M \\rVert^2$（角动量大小的平方）。因此，系统的任何轨迹都必须位于由 $H(M)=E_0$ 和 $C(M)=C_0$ 定义的两个曲面的交集上，其中 $E_0$ 和 $C_0$ 由初始条件决定。这些曲面分别是能量椭球和以原点为中心的球面。\n该陈述是正确的。\n_结论：正确。_\n\n综上所述，陈述 A, B, C, E 是正确的，而陈述 D 是错误的。问题要求选出所有正确的陈述。",
            "answer": "$$\\boxed{ABCE}$$"
        },
        {
            "introduction": "理论的价值最终体现在其应用之中。为什么我们需要用几何的观点来重新审视刚体动力学？最后一个实践将我们从纯粹的理论分析带入计算科学的前沿 。通过动手编写并比较两种数值积分方法，我们将直观地看到，李-泊松系统的几何特性如何指导我们设计出能够“尊重”系统内在守恒律的、性能卓越的数值算法。",
            "id": "3776216",
            "problem": "考虑自由刚体问题，该问题被表述为三维特殊正交群对偶空间（记作 $\\mathfrak{so}(3)^{\\ast}$）上的一个李-泊松系统。设物体角动量为 $M=(M_{1},M_{2},M_{3})\\in\\mathbb{R}^{3}$，并假设惯性张量为对角阵，其主转动惯量为 $I=(I_{1},I_{2},I_{3})$，其中每个 $I_{k}0$。哈密顿量为 $H(M)=\\frac{1}{2}\\,M\\cdot I^{-1}M=\\frac{1}{2}\\left(\\frac{M_{1}^{2}}{I_{1}}+\\frac{M_{2}^{2}}{I_{2}}+\\frac{M_{3}^{2}}{I_{3}}\\right)$，$\\mathfrak{so}(3)^{\\ast}$ 上的李-泊松括号对光滑函数 $F,G$ 定义为 $\\{F,G\\}(M)=-M\\cdot\\left(\\nabla F(M)\\times\\nabla G(M)\\right)$。由此导出的哈密顿动力学即为刚体方程\n$$\n\\dot{M}=\\{M,H\\}(M)=M\\times\\Omega,\n$$\n其中 $\\Omega=I^{-1}M$，$\\times$ 是叉积，$\\Omega$ 是物体坐标系中的角速度。\n\n您的任务是编写一个完整、可运行的程序，该程序：\n- 实现两种用于 $\\dot{M}=M\\times I^{-1}M$ 的时间积分方法：\n  1. 一种与上述演化方程一致的简单显式欧拉法。\n  2. 一种李-泊松保持方法，通过将哈密顿量分裂为坐标分量 $H_{k}(M)=\\frac{1}{2}\\frac{M_{k}^{2}}{I_{k}}$ (其中 $k\\in\\{1,2,3\\}$) 构建，精确积分每个子流，并通过斯特朗 (Strang) 分裂将它们组合起来。精确的子流是由与每个 $H_k$ 相关的恒定角速度生成的刚性旋转；角度必须以弧度计算和应用。\n- 对每种方法和每个测试案例，在指定的时间范围内演化系统，并通过计算以下量来量化能量漂移：\n  1. 最终绝对能量误差，$\\left|H(M(T))-H(M(0))\\right|$，其中 $T$ 是最终时间。\n  2. 最大绝对能量偏差，$\\max_{0\\leq t\\leq T}\\left|H(M(t))-H(M(0))\\right|$。\n- 使用无量纲参数，并以浮点数形式返回所有请求的量。\n\n设计程序以运行以下测试套件。对于每个案例，使用给定的惯性 $I$、初始动量 $M(0)$、时间步长 $\\Delta t$ 和步数 $N$；总积分时间为 $T=N\\,\\Delta t$。所有旋转角度必须以弧度处理。\n\n- 测试案例 1：$I=(1.0,2.0,3.0)$，$M(0)=(0.5,0.4,0.3)$，$\\Delta t=0.005$，$N=40000$。\n- 测试案例 2：$I=(1.0,1.0,1.0)$，$M(0)=(0.3,-0.2,0.4)$，$\\Delta t=0.010$，$N=30000$。\n- 测试案例 3：$I=(1.5,2.5,3.5)$，$M(0)=(1.0,0.0,0.0)$，$\\Delta t=0.200$，$N=1000$。\n- 测试案例 4：$I=(0.8,1.1,1.3)$，$M(0)=(0.7,0.6,0.5)$，$\\Delta t=0.050$，$N=8000$。\n\n输出规范：\n- 对于每个测试案例，生成一个包含四个浮点数的列表，顺序为 $[\\text{final\\_error\\_Euler},\\text{max\\_deviation\\_Euler},\\text{final\\_error\\_LP},\\text{max\\_deviation\\_LP}]$，其中 $\\text{LP}$ 表示李-泊松保持分裂法。\n- 您的程序应生成单行输出，其中包含这些按案例排列的列表，形式为逗号分隔的列表，不含空格，并用方括号括起来。例如，两个案例的输出应类似于 $[[a_{1},b_{1},c_{1},d_{1}],[a_{2},b_{2},c_{2},d_{2}]]$。\n\n所有量都是无量纲的，所有角度必须以弧度处理。每个测试案例的答案必须是浮点数。程序必须是自包含的，严格按照指定格式生成单行输出，并且不需要用户输入或外部文件。",
            "solution": "用户提供的问题是几何力学和数值分析领域一个适定且标准的任务。它要求实现并比较两种用于自由刚体欧拉方程的数值积分器。验证过程如下。\n\n### 步骤1：提取给定信息\n- **系统**：自由刚体被描述为 $\\mathfrak{so}(3)^{\\ast}$ 上的李-泊松系统，即三维特殊正交群李代数的对偶空间。\n- **状态向量**：物体坐标系中的角动量为 $M=(M_{1},M_{2},M_{3})\\in\\mathbb{R}^{3}$。\n- **惯性张量**：物体的惯性张量是对角阵，主转动惯量为 $I=(I_{1},I_{2},I_{3})$，其中 $I_{k}0$。\n- **哈密顿量**：系统的能量由哈密顿量给出 $H(M)=\\frac{1}{2}\\,M\\cdot I^{-1}M=\\frac{1}{2}\\sum_{k=1}^{3}\\frac{M_{k}^{2}}{I_{k}}$。\n- **李-泊松括号**：对于 $\\mathfrak{so}(3)^{\\ast}$ 上的任意两个光滑函数 $F,G$，其括号为 $\\{F,G\\}(M)=-M\\cdot\\left(\\nabla F(M)\\times\\nabla G(M)\\right)$。\n- **运动方程**：动力学由哈密顿方程 $\\dot{M}=\\{M,H\\}(M)$ 给出，计算结果为欧拉方程 $\\dot{M}=M\\times\\Omega$，其中 $\\Omega=I^{-1}M$ 是物体坐标系中的角速度。\n- **任务**：实现、测试并比较两种数值积分方法：\n    1.  **显式欧拉法**：一种标准的一阶非保守数值格式。\n    2.  **李-泊松分裂法**：一种几何积分器，通过分裂哈密顿量 $H = \\sum_{k=1}^{3} H_{k}$（其中 $H_{k}(M)=\\frac{1}{2}\\frac{M_{k}^{2}}{I_{k}}$）、精确积分每个 $H_k$ 的流，并使用二阶斯特朗 (Strang) 分裂将它们组合起来构建。\n- **分析**：对于每种方法和每个测试案例，计算最终绝对能量误差 $\\left|H(M(T))-H(M(0))\\right|$ 和积分区间内的最大绝对能量偏差 $\\max_{0\\leq t\\leq T}\\left|H(M(t))-H(M(0))\\right|$。\n- **测试案例**：提供了四个具体的测试案例，每个案例都给定了 $I$、$M(0)$、时间步长 $\\Delta t$ 和步数 $N$ 的值。\n\n### 步骤2：使用提取的给定信息进行验证\n对问题进行严格验证。\n- **科学依据**：该问题基于刚体运动的经典力学及其在几何力学中的现代表述。$\\mathfrak{so}(3)^{\\ast}$ 的欧拉方程、哈密顿量和李-泊松括号都是标准且正确的。\n- **适定性**：该问题是一个定义良好的常微分方程组的初值问题。向量场是光滑的，保证了局部解的存在性和唯一性。比较数值积分器是一项计算科学中标准而有意义的任务。\n- **客观性**：问题以精确、客观的数学术语陈述。所有参数都已定义，并且要求的输出是定量指定的。\n- **完整性与一致性**：问题陈述是自包含的。它提供了所有必要的信息，包括控制方程、数值方法的构造以及测试套件的参数。没有矛盾之处。\n- **可行性**：指定的计算在数值上是可行的，并且可以在标准编程环境中实现。参数在物理上和数值上都是合理的。非几何方法（欧拉法）与几何方法（李-泊松分裂法）之间的比较是一个典型的练习，它突出了数值积分的基本概念。\n\n### 步骤3：结论与行动\n该问题是**有效的**。它是一个可靠、适定且重要的几何数值积分问题。将提供一个解决方案。\n\n### 求解推导\n\n自由刚体的动力学由欧拉方程控制：\n$$ \\dot{M} = M \\times \\Omega, \\quad \\text{其中} \\quad \\Omega=I^{-1}M = \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) $$\n\n**方法1：显式欧拉法**\n这是一个标准的一阶数值积分格式。给定在时间 $t_n$ 的状态 $M^n$，在时间 $t_{n+1} = t_n + \\Delta t$ 的状态 $M^{n+1}$ 近似为：\n$$ M^{n+1} = M^n + \\Delta t \\cdot \\dot{M}^n = M^n + \\Delta t \\cdot (M^n \\times (I^{-1}M^n)) $$\n此方法实现简单，但并未设计用于保持系统的几何结构。特别是，它不守恒哈密顿量 $H(M)$（能量）或卡西米尔函数 $C(M) = \\|M\\|^2$（角动量的平方范数）。能量误差预计会随时间增长，这种现象称为长期漂移。\n\n**方法2：李-泊松分裂法**\n这是一种几何积分器，旨在保持精确流的某些定性特征。该方法通过分裂哈密顿量并组合更简单子系统的精确流来构建。\n\n1.  **哈密顿量分裂**：哈密顿量被加性分裂为三个分量，每个主轴对应一个：\n    $$ H(M) = H_1(M) + H_2(M) + H_3(M), \\quad \\text{其中} \\quad H_k(M) = \\frac{1}{2}\\frac{M_k^2}{I_k} $$\n\n2.  **子系统动力学**：对于每个子哈密顿量 $H_k$，动力学由李-泊松括号给出：\n    $$ \\dot{M} = \\{M, H_k\\}(M) = M \\times \\nabla_M H_k(M) $$\n    每个 $H_k$ 的梯度很简单：\n    $$ \\nabla_M H_1 = \\frac{M_1}{I_1}e_1, \\quad \\nabla_M H_2 = \\frac{M_2}{I_2}e_2, \\quad \\nabla_M H_3 = \\frac{M_3}{I_3}e_3 $$\n    其中 $e_k$ 是标准基向量。第 $k$ 个子系统的运动方程是：\n    $$ \\dot{M} = M \\times \\left(\\frac{M_k}{I_k}e_k\\right) $$\n    对于此子系统，分量 $M_k$ 是常数，因为 $\\dot{M}_k = e_k \\cdot \\dot{M} = e_k \\cdot (M \\times (\\frac{M_k}{I_k}e_k)) = 0$。因此，项 $\\frac{M_k}{I_k}e_k$ 是一个常数向量。该方程描述了向量 $M$ 绕固定轴 $e_k$ 以恒定角速度 $\\frac{M_k}{I_k}$ 进行的纯旋转。\n\n3.  **精确子流**：第 $k$ 个子系统在时间间隔 $\\Delta t$ 上的精确解（流），记作 $\\phi_{H_k}^{\\Delta t}$，是动量向量 $M$ 绕轴 $e_k$ 旋转角度 $\\alpha_k = \\frac{M_k}{I_k}\\Delta t$。这可以使用标准旋转矩阵来实现。例如，对于 $k=1$，旋转为：\n    $$ \\phi_{H_1}^{\\Delta t}(M) = R_1\\left(\\frac{M_1}{I_1}\\Delta t\\right) M, \\quad \\text{其中} \\quad R_1(\\alpha) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha \\end{pmatrix} $$\n    类似的旋转矩阵 $R_2(\\alpha)$ 和 $R_3(\\alpha)$ 也适用于其他子系统。\n\n4.  **斯特朗 (Strang) 分裂组合**：为了近似完整哈密顿量 $H$ 的流，我们使用一种二阶对称组合，称为斯特朗分裂。从 $t_n$ 到 $t_n+\\Delta t$ 的积分器的一个步骤由下式给出：\n    $$ M^{n+1} = \\left( \\phi_{H_1}^{\\Delta t/2} \\circ \\phi_{H_2}^{\\Delta t/2} \\circ \\phi_{H_3}^{\\Delta t} \\circ \\phi_{H_2}^{\\Delta t/2} \\circ \\phi_{H_1}^{\\Delta t/2} \\right) M^n $$\n    这意味着我们应用一个由五次旋转组成的序列。至关重要的是，每次旋转的角度必须使用前一次旋转*结果*的动量向量分量来计算。因为每一步都是一次旋转，所以范数 $\\|M\\|$ 被这种数值方法精确守恒。因此，卡西米尔不变量被精确保持，该积分器是李-泊松积分器。哈密顿量 $H$ 通常不是卡西米尔函数，因此它不会被精确守恒，但其误差预计在长时间积分中保持有界，不会出现长期漂移。\n\n对于精确解为不动点的特殊测试案例（案例2：球形陀螺，案例3：绕主轴旋转），两种方法预计都会产生零或机器精度的误差。球形陀螺特别有趣，因为总的哈密顿流是平凡的（$\\dot{M}=0$），但单个分裂的流不是。在这种情况下，李-泊松方法的完美抵消证明了其几何特性，因为它精确守恒了由守恒量 $\\|M\\|$ 构建的哈密顿量 $H \\propto \\|M\\|^2$。\n\n程序将实现这两种方法，对给定的测试案例运行模拟，并计算指定的误差度量以展示这些特性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the rigid body dynamics problem.\n    It runs simulations for predefined test cases using two different\n    numerical integrators and prints the energy error metrics.\n    \"\"\"\n\n    test_cases = [\n        # I, M(0), dt, N\n        ((1.0, 2.0, 3.0), (0.5, 0.4, 0.3), 0.005, 40000),\n        ((1.0, 1.0, 1.0), (0.3, -0.2, 0.4), 0.010, 30000),\n        ((1.5, 2.5, 3.5), (1.0, 0.0, 0.0), 0.200, 1000),\n        ((0.8, 1.1, 1.3), (0.7, 0.6, 0.5), 0.050, 8000),\n    ]\n\n    results = []\n    for I_tuple, M0_tuple, dt, N in test_cases:\n        I = np.array(I_tuple, dtype=float)\n        M0 = np.array(M0_tuple, dtype=float)\n        I_inv = 1.0 / I\n\n        def hamiltonian(M, inv_I):\n            \"\"\"Computes the Hamiltonian (energy) of the rigid body.\"\"\"\n            return 0.5 * np.sum(M**2 * inv_I)\n\n        # --- 1. Explicit Euler Method ---\n        M_e = M0.copy()\n        H0 = hamiltonian(M_e, I_inv)\n        max_deviation_euler = 0.0\n        \n        for _ in range(N):\n            M_dot = np.cross(M_e, M_e * I_inv)\n            M_e += dt * M_dot\n            current_H = hamiltonian(M_e, I_inv)\n            deviation = abs(current_H - H0)\n            if deviation > max_deviation_euler:\n                max_deviation_euler = deviation\n        \n        final_error_euler = abs(hamiltonian(M_e, I_inv) - H0)\n\n        # --- 2. Lie-Poisson Splitting Method ---\n        def lie_poisson_step(M_current, inv_I, step_t):\n            \"\"\"Performs one step of the Lie-Poisson Strang splitting integrator.\"\"\"\n            M = M_current.copy()\n            \n            # phi_H1(dt/2)\n            angle1 = M[0] * inv_I[0] * step_t / 2.0\n            c1, s1 = np.cos(angle1), np.sin(angle1)\n            R1 = np.array([[1.0, 0.0, 0.0], [0.0, c1, -s1], [0.0, s1, c1]])\n            M = R1 @ M\n\n            # phi_H2(dt/2)\n            angle2 = M[1] * inv_I[1] * step_t / 2.0\n            c2, s2 = np.cos(angle2), np.sin(angle2)\n            R2 = np.array([[c2, 0.0, s2], [0.0, 1.0, 0.0], [-s2, 0.0, c2]])\n            M = R2 @ M\n\n            # phi_H3(dt)\n            angle3 = M[2] * inv_I[2] * step_t\n            c3, s3 = np.cos(angle3), np.sin(angle3)\n            R3 = np.array([[c3, -s3, 0.0], [s3, c3, 0.0], [0.0, 0.0, 1.0]])\n            M = R3 @ M\n\n            # phi_H2(dt/2)\n            angle2_rev = M[1] * inv_I[1] * step_t / 2.0\n            c2_rev, s2_rev = np.cos(angle2_rev), np.sin(angle2_rev)\n            R2_rev = np.array([[c2_rev, 0.0, s2_rev], [0.0, 1.0, 0.0], [-s2_rev, 0.0, c2_rev]])\n            M = R2_rev @ M\n\n            # phi_H1(dt/2)\n            angle1_rev = M[0] * inv_I[0] * step_t / 2.0\n            c1_rev, s1_rev = np.cos(angle1_rev), np.sin(angle1_rev)\n            R1_rev = np.array([[1.0, 0.0, 0.0], [0.0, c1_rev, -s1_rev], [0.0, s1_rev, c1_rev]])\n            M = R1_rev @ M\n\n            return M\n\n        M_lp = M0.copy()\n        # H0 is the same as for Euler\n        max_deviation_lp = 0.0\n        \n        for _ in range(N):\n            M_lp = lie_poisson_step(M_lp, I_inv, dt)\n            current_H = hamiltonian(M_lp, I_inv)\n            deviation = abs(current_H - H0)\n            if deviation > max_deviation_lp:\n                max_deviation_lp = deviation\n        \n        final_error_lp = abs(hamiltonian(M_lp, I_inv) - H0)\n        \n        # Collect results for the current test case\n        case_results = [\n            final_error_euler, \n            max_deviation_euler,\n            final_error_lp,\n            max_deviation_lp\n        ]\n        results.append(case_results)\n\n    # Format the output string to match the specification \"[ [r1,r2,...],[...],... ]\"\n    # with no spaces.\n    inner_strings = [f\"[{','.join(map(str, r))}]\" for r in results]\n    final_output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}