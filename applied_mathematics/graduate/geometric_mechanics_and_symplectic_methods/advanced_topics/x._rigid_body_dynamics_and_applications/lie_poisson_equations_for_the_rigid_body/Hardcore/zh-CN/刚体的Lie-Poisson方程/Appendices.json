{
    "hands_on_practices": [
        {
            "introduction": "掌握任何新数学形式的第一步，是将其应用于一个基础计算。本练习旨在将定义在 $\\mathfrak{so}(3)^*$ 上的抽象李-泊松括号应用于刚体哈密顿量，从而推导出角动量分量的运动方程。通过这个计算，你将亲手验证这一几何框架如何具体地重现我们所熟悉的欧拉方程，从而在抽象理论与经典物理之间建立起坚实的联系。",
            "id": "647224",
            "problem": "自由刚体的动力学可以在旋转李代数的对偶空间 $\\mathfrak{so}(3)^*$ 上的哈密顿框架中描述。我们可以将此对偶空间等同于 $\\mathbb{R}^3$，其中坐标 $(\\Pi_1, \\Pi_2, \\Pi_3)$ 表示在固定于刚体的参考系（体坐标系）中角动量矢量的分量。\n\n在光滑函数空间 $F, G \\in C^\\infty(\\mathfrak{so}(3)^*)$ 上的泊松结构由李-泊松括号给出：\n$$\n\\{F, G\\}(\\mathbf{\\Pi}) = - \\sum_{i,j,k=1}^3 \\epsilon_{ijk} \\Pi_k \\frac{\\partial F}{\\partial \\Pi_i} \\frac{\\partial G}{\\partial \\Pi_j}\n$$\n其中 $\\epsilon_{ijk}$ 是 Levi-Civita 符号。该括号由基本括号关系 $\\{\\Pi_i, \\Pi_j\\} = -\\epsilon_{ijk} \\Pi_k$ 确定。\n\n以体坐标系角动量分量表示的自由刚体的哈密顿量由其动能给出：\n$$\nH(\\Pi_1, \\Pi_2, \\Pi_3) = \\frac{1}{2}\\left(\\frac{\\Pi_1^2}{I_1} + \\frac{\\Pi_2^2}{I_2} + \\frac{\\Pi_3^2}{I_3}\\right)\n$$\n其中 $I_1, I_2, I_3$ 是刚体的主转动惯量。\n\n任何可观测量 $F$ 的时间演化由哈密顿方程 $\\frac{dF}{dt} = \\{F, H\\}$ 支配。使用所给的定义，推导角动量第一个分量的时间演化的显式表达式，这对应于计算李-泊松括号 $\\{\\Pi_1, H\\}$。",
            "solution": "我们使用李-泊松括号\n$$\\{F,G\\}(\\mathbf \\Pi)=-\\sum_{i,j,k}\\epsilon_{ijk}\\Pi_k\\frac{\\partial F}{\\partial \\Pi_i}\\frac{\\partial G}{\\partial \\Pi_j},$$ \n和哈密顿方程 $\\dot F=\\{F,H\\}$。因此\n$$\\{\\Pi_1,H\\}=-\\sum_{j,k=1}^3\\epsilon_{1jk}\\Pi_k\\frac{\\partial H}{\\partial \\Pi_j}.$$\n因为\n$$\\frac{\\partial H}{\\partial \\Pi_j}=\\frac{\\Pi_j}{I_j},\\quad j=1,2,3,$$ \n只有 $j=2,3$ 有贡献。我们有\n$$\\{\\Pi_1,H\\}=-\\bigl(\\epsilon_{123}\\Pi_3\\frac{\\Pi_2}{I_2}+\\epsilon_{132}\\Pi_2\\frac{\\Pi_3}{I_3}\\bigr)\n=-\\Bigl(\\Pi_3\\frac{\\Pi_2}{I_2}-\\Pi_2\\frac{\\Pi_3}{I_3}\\Bigr)\n=\\Pi_2\\Pi_3\\Bigl(\\frac1{I_3}-\\frac1{I_2}\\Bigr).$$\n注意到 $\\frac1{I_3}-\\frac1{I_2}=\\frac{I_2-I_3}{I_2I_3}$ 即可得到最终结果。",
            "answer": "$$\\boxed{\\frac{I_2-I_3}{I_2I_3}\\Pi_2\\Pi_3}$$"
        },
        {
            "introduction": "在掌握了基本计算之后，理解刚体动力学系统的几何结构变得至关重要。本练习综合考察了关于李-泊松约化动力学的多个核心概念，包括其哈密顿结构、作为余伴轨道的相空间分层，以及由卡西米尔不变量 $C(\\Pi) = \\frac{1}{2} \\lVert \\Pi \\rVert^2$ 所保证的守恒律。通过分析这些关键特性，特别是平衡点的稳定性，你将深化对系统内在几何及其如何决定其长期行为的理解。",
            "id": "3754326",
            "problem": "考虑一个自由刚体，其位形流形为 $SO(3)$，其物体坐标系下的惯性算子 $I:\\mathbb{R}^3\\to\\mathbb{R}^3$ 是对称、正定的，并且沿标准正交基 $\\{e_1,e_2,e_3\\}$ 的主转动惯量 $I_1  I_2  I_3$。系统的约化动力学在李代数对偶空间 $\\mathfrak{so}(3)^* \\cong \\mathbb{R}^3$ 上给出，其坐标为角动量 $\\Pi$。\n\n下列哪些陈述是正确的？\n\nA. $\\mathfrak{so}(3)^*$ 上的约化动力学是关于李-泊松括号的哈密顿系统，其哈密顿量为 $H(\\Pi)=\\tfrac{1}{2}\\,\\Pi\\cdot I^{-1}\\Pi$，且协伴随轨道是 $\\lVert \\Pi \\rVert^2$ 的水平集，因此是 $2$-球面。\n\nB. 函数 $C(\\Pi)=\\tfrac{1}{2}\\lVert \\Pi \\rVert^2$ 是一个卡西米尔(Casimir)函数，即在李-泊松括号下，它与任意光滑函数都泊松对易，因此在 $\\mathfrak{so}(3)^*$ 上的每个哈密顿流中都是守恒的。\n\nC. 约化动力学的非平凡平衡点恰好是那些与 $I$ 的主轴对齐的 $\\Pi$。对于 $I_1  I_2  I_3$ 的情况，绕最小转动惯量轴 ($e_1$) 和最大转动惯量轴 ($e_3$) 的旋转是（非线性）稳定的，而绕中间转动惯量轴 ($e_2$) 的旋转是不稳定的。\n\nD. 对于 $\\mathfrak{so}(3)^*$ 上的任何哈密顿流，量 $\\lVert \\Pi \\rVert$ 都是守恒的。\n\nE. 如果使用基于哈密顿量分裂（$H=H_1+H_2+H_3$）的斯特朗(Strang)分裂积分器来对该系统进行数值模拟，该积分器会精确地保持卡西米尔不变量 $C(\\Pi)$，但通常不会精确地保持哈密顿量 $H(\\Pi)$。",
            "solution": "问题陈述描述了一个自由刚体的约化动力学。我们首先为李群 $G=SO(3)$ 建立李-泊松约化的数学框架。\n\n$SO(3)$ 的李代数是 $\\mathfrak{so}(3)$，即 $3 \\times 3$ 反对称矩阵的空间。这个代数与配备了叉积的 $\\mathbb{R}^3$ 同构。该同构由“帽子映射”$\\hat{\\cdot}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ 给出，它将向量 $\\xi = (\\xi_1, \\xi_2, \\xi_3)^T$ 映射到矩阵\n$$ \\hat{\\xi} = \\begin{pmatrix} 0  -\\xi_3  \\xi_2 \\\\ \\xi_3  0  -\\xi_1 \\\\ -\\xi_2  \\xi_1  0 \\end{pmatrix} $$\n$\\mathfrak{so}(3)$ 上的李括号是矩阵对易子，它通过 $[\\hat{\\xi}, \\hat{\\eta}] = \\widehat{\\xi \\times \\eta}$ 与 $\\mathbb{R}^3$ 中的叉积相关联。\n\n李代数的对偶空间 $\\mathfrak{so}(3)^*$ 可以通过标准点积与 $\\mathbb{R}^3$ 等同起来。$\\mathfrak{so}(3)^*$ 中的一个元素 $\\mu$ 与一个向量 $\\Pi \\in \\mathbb{R}^3$ 等同，使得配对为 $\\langle \\mu, \\hat{\\xi} \\rangle = \\Pi \\cdot \\xi$。在刚体的背景下，$\\Pi$ 代表在物体固连坐标系中的角动量。\n\n对于一个一般的李代数 $\\mathfrak{g}$，其对偶空间 $\\mathfrak{g}^*$ 上的李-泊松括号对两个光滑函数 $F, H \\in C^\\infty(\\mathfrak{g}^*)$ 定义为\n$$ \\{F, H\\}(\\mu) = \\langle \\mu, [ \\frac{\\delta F}{\\delta \\mu}, \\frac{\\delta H}{\\delta \\mu} ] \\rangle $$\n这里，$\\frac{\\delta F}{\\delta \\mu} \\in \\mathfrak{g}$ 是 $F$ 的泛函导数。对于坐标为 $\\Pi$ 的 $\\mathfrak{g}^* \\cong \\mathbb{R}^3$，泛函导数 $\\frac{\\delta F}{\\delta \\Pi}$ 就是梯度 $\\nabla_\\Pi F \\in \\mathbb{R}^3$。在 $\\mathfrak{so}(3) \\cong \\mathbb{R}^3$ 的等同关系下，李括号是叉积，配对是点积。因此，$\\mathfrak{so}(3)^* \\cong \\mathbb{R}^3$ 上的李-泊松括号是\n$$ \\{F, H\\}(\\Pi) = \\Pi \\cdot (\\nabla_\\Pi F \\times \\nabla_\\Pi H) $$\n变量 $\\Pi$ 的哈密顿运动方程由 $\\dot{\\Pi}_i = \\{\\Pi_i, H\\}$ 给出。计算结果为 $\\dot{\\Pi} = \\Pi \\times \\nabla_\\Pi H$。\n\n自由刚体的哈密顿量是其动能。在物体坐标系中，角速度为 $\\Omega = I^{-1}\\Pi$，其中 $I$ 是惯性张量。哈密顿量是\n$$ H(\\Pi) = \\frac{1}{2} \\Pi \\cdot \\Omega = \\frac{1}{2} \\Pi \\cdot (I^{-1}\\Pi) $$\n在主轴坐标系 $\\{e_1, e_2, e_3\\}$ 中，惯性张量是对角的，$I = \\text{diag}(I_1, I_2, I_3)$，所以 $I^{-1} = \\text{diag}(1/I_1, 1/I_2, 1/I_3)$。哈密顿量是\n$$ H(\\Pi) = \\frac{1}{2} \\left( \\frac{\\Pi_1^2}{I_1} + \\frac{\\Pi_2^2}{I_2} + \\frac{\\Pi_3^2}{I_3} \\right) $$\n哈密顿量的梯度是 $\\nabla_\\Pi H = I^{-1}\\Pi$。运动方程，即著名的欧拉方程，是：\n$$ \\dot{\\Pi} = \\Pi \\times (I^{-1}\\Pi) $$\n\n现在我们评估每个陈述。\n\n**A. $\\mathfrak{so}(3)^*$ 上的约化动力学是关于李-泊松括号的哈密顿系统，其哈密顿量为 $H(\\Pi)=\\tfrac{1}{2}\\,\\Pi\\cdot I^{-1}\\Pi$，且协伴随轨道是 $\\lVert \\Pi\\rVert^2$ 的水平集，因此是 $2$-球面。**\n\n陈述的第一部分是正确的，这由力学领域一个世纪的研究成果所确立，并由上述推导所证实。该系统对于指定的括号和哈密顿量是哈密顿系统。\n对于第二部分，我们必须确定协伴随轨道。$G$ 在 $\\mathfrak{g}^*$ 上的协伴随作用定义为 $\\langle \\text{Ad}^*_g \\mu, \\xi \\rangle = \\langle \\mu, \\text{Ad}_{g^{-1}} \\xi \\rangle$，对于 $g \\in G, \\mu \\in \\mathfrak{g}^*, \\xi \\in \\mathfrak{g}$。对于 $G=SO(3)$，在 $\\mathfrak{so}(3) \\cong \\mathbb{R}^3$ 上的伴随作用是 $\\text{Ad}_R \\omega = R\\omega$，对于 $R \\in SO(3)$ 和 $\\omega \\in \\mathbb{R}^3$。因此，对于 $\\Pi \\in \\mathfrak{so}(3)^* \\cong \\mathbb{R}^3$：\n$$ \\langle \\text{Ad}^*_R \\Pi, \\omega \\rangle = \\langle \\Pi, \\text{Ad}_{R^{-1}} \\omega \\rangle = \\Pi \\cdot (R^{-1}\\omega) = (R \\Pi) \\cdot \\omega $$\n这意味着 $\\text{Ad}^*_R \\Pi = R\\Pi$。通过一个点 $\\Pi_0 \\in \\mathbb{R}^3$ 的协伴随轨道是集合 $\\{ R \\Pi_0 \\mid R \\in SO(3) \\}$。对于 $\\Pi_0 \\neq 0$，这是一个半径为 $\\lVert \\Pi_0 \\rVert$ 的球面。这些球面恰好是函数 $f(\\Pi) = \\lVert \\Pi \\rVert^2$ 的水平集。如果 $\\Pi_0=0$，轨道是点 $\\{0\\}$。因此，协伴随轨道是以原点为中心的 $2$-球面（以及原点本身）。\n该陈述事实正确。\n_结论：正确。_\n\n**B. 函数 $C(\\Pi)=\\tfrac{1}{2}\\lVert \\Pi\\rVert^2$ 是一个卡西米尔(Casimir)函数，即在李-泊松括号下，它与任意光滑函数都泊松对易，因此在 $\\mathfrak{so}(3)^*$ 上的每个哈密顿流中都是守恒的。**\n\n一个函数 $C$ 是卡西米尔函数，当且仅当对于所有光滑函数 $F$，都有 $\\{C, F\\} = 0$。使用 $\\mathfrak{so}(3)^*$ 的李-泊松括号：\n$$ \\{C, F\\}(\\Pi) = \\Pi \\cdot (\\nabla_\\Pi C \\times \\nabla_\\Pi F) $$\n对于 $C(\\Pi) = \\frac{1}{2}\\lVert \\Pi \\rVert^2 = \\frac{1}{2}(\\Pi_1^2 + \\Pi_2^2 + \\Pi_3^2)$，其梯度是 $\\nabla_\\Pi C = \\Pi$。\n将此代入括号公式：\n$$ \\{C, F\\}(\\Pi) = \\Pi \\cdot (\\Pi \\times \\nabla_\\Pi F) $$\n根据定义，向量 $\\Pi \\times \\nabla_\\Pi F$ 与 $\\Pi$ 正交。因此，它们的点积对于任何 $\\Pi$ 和任何 $F$ 都为零。因此，$C(\\Pi)=\\frac{1}{2}\\lVert \\Pi\\rVert^2$ 是一个卡西米尔函数。\n相空间上任何函数 $C$ 的时间演化由 $\\dot{C} = \\{C, H\\}$ 给出。如果 $C$ 是一个卡西米尔函数，那么对于*任何*哈密顿量 $H$，都有 $\\{C, H\\}=0$。因此，卡西米尔函数对于给定李-泊松流形上的所有哈密顿系统都是守恒量。\n该陈述事实正确。\n_结论：正确。_\n\n**C. 约化动力学的非平凡平衡点恰好是那些与 $I$ 的主轴对齐的 $\\Pi$。对于 $I_1  I_2  I_3$ 的情况，绕最小转动惯量轴 ($e_1$) 和最大转动惯量轴 ($e_3$) 的旋转是（非线性）稳定的，而绕中间转动惯量轴 ($e_2$) 的旋转是不稳定的。**\n\n平衡点是使 $\\dot{\\Pi}=0$ 的点。欧拉方程 $\\dot{\\Pi} = \\Pi \\times (I^{-1}\\Pi)$ 表明，平衡点出现在 $\\Pi$ 和 $I^{-1}\\Pi$ 平行时。由于 $I^{-1}$ 是对角的，这意味着 $\\Pi$ 必须与其中一个主轴 $e_k$ 对齐。\n稳定性的分析可以通过能量-卡西米尔方法进行。这表明绕最小和最大转动惯量轴的旋转是稳定的，而绕中间轴的旋转是不稳定的。这与著名的网球拍定理一致。\n该陈述事实正确。\n_结论：正确。_\n\n**D. 对于 $\\mathfrak{so}(3)^*$ 上的任何哈密顿流，量 $\\lVert \\Pi \\rVert$ 都是守恒的。**\n\n正如在B中所确立的，$C(\\Pi) = \\frac{1}{2}\\lVert \\Pi \\rVert^2$ 是一个卡西米尔函数。这意味着它对于由该李-泊松结构定义的*任何*哈密顿量 $H$ 都是一个守恒量。由于 $\\lVert \\Pi \\rVert = \\sqrt{2C(\\Pi)}$ 且范数是非负的，如果 $C(\\Pi)$ 是守恒的，那么 $\\lVert \\Pi \\rVert$ 也必须是守恒的。因此，该陈述是正确的。\n_结论：正确。_\n\n**E. 如果使用基于哈密顿量分裂（$H=H_1+H_2+H_3$）的斯特朗(Strang)分裂积分器来对该系统进行数值模拟，该积分器会精确地保持卡西米尔不变量 $C(\\Pi)$，但通常不会精确地保持哈密顿量 $H(\\Pi)$。**\n\n所述的分裂方法通过将总流近似为由子哈密顿量 $H_k = \\frac{1}{2}\\Pi_k^2/I_k$ 生成的精确流的组合来工作。每个子流 $\\dot{\\Pi} = \\{\\Pi, H_k\\}$ 都对应于绕 $e_k$ 轴的旋转。旋转是保范运算，因此每个子流都保持 $\\lVert \\Pi \\rVert$。由于数值积分器是这些保范映射的组合，它也将精确地保持范数 $\\lVert \\Pi \\rVert$，从而保持卡西米尔不变量 $C(\\Pi)$。然而，哈密顿量 $H$ 本身不是卡西米尔函数（除非 $I_1=I_2=I_3$）。分裂方法通常不保持非卡西米尔的守恒量，因此能量 $H$ 不会被精确保持。它通常表现出有界的振荡，而不是像非几何方法那样的长期漂移。\n该陈述事实正确。\n_结论：正确。_\n\n由于所有五个陈述 A, B, C, D, E 都是正确的，因此正确的答案应包括所有这些。",
            "answer": "$$\\boxed{ABCDE}$$"
        },
        {
            "introduction": "几何力学的真正威力体现在其解决实际问题的能力上，尤其是在计算动力学领域。这个实践练习要求你编写代码，去实现并比较一个标准的欧拉积分器和一个保持李-泊松结构的几何积分器。通过亲手实现并观察能量在长时间积分下的表现，你将直观地领会到为何结构保持算法在保证物理系统仿真的长期保真度方面具有无可比拟的优势。",
            "id": "3776216",
            "problem": "考虑自由刚体问题，它被表述为三维特殊正交群对偶空间（记作 $\\mathfrak{so}(3)^{\\ast}$）上的一个李-泊松系统。令刚体角动量为 $M=(M_{1},M_{2},M_{3})\\in\\mathbb{R}^{3}$，并假设惯性张量是对角阵，其主转动惯量为 $I=(I_{1},I_{2},I_{3})$，其中每个 $I_{k}0$。哈密顿量为 $H(M)=\\frac{1}{2}\\,M\\cdot I^{-1}M=\\frac{1}{2}\\left(\\frac{M_{1}^{2}}{I_{1}}+\\frac{M_{2}^{2}}{I_{2}}+\\frac{M_{3}^{2}}{I_{3}}\\right)$，$\\mathfrak{so}(3)^{\\ast}$ 上的李-泊松括号对光滑函数 $F,G$ 定义为 $\\{F,G\\}(M)=-M\\cdot\\left(\\nabla F(M)\\times\\nabla G(M)\\right)$。其导出的哈密顿动力学是刚体运动方程\n$$\n\\dot{M}=\\{M,H\\}(M)=M\\times\\Omega,\\quad\\text{其中}\\quad\\Omega=I^{-1}M,\n$$\n其中 $\\times$ 是叉积，$\\Omega$ 是体坐标系中的角速度。\n\n您的任务是编写一个完整、可运行的程序，该程序：\n- 为 $\\dot{M}=M\\times I^{-1}M$ 实现两种时间积分方法：\n  1. 一种与上述演化方程一致的简单显式欧拉法。\n  2. 一种保李-泊松结构的方法，通过将哈密顿量分裂为坐标分量 $H_{k}(M)=\\frac{1}{2}\\frac{M_{k}^{2}}{I_{k}}$（对于 $k\\in\\{1,2,3\\}$），精确积分每个子流，并通过斯特朗分裂（Strang splitting）将它们组合起来，来构造该方法。精确的子流是由与每个 $H_{k}$ 相关的恒定角速度生成的刚性旋转；角度必须以弧度计算和应用。\n- 对于每种方法和每个测试用例，在指定的时间范围内演化系统，并通过计算以下量来量化能量漂移：\n  1. 最终绝对能量误差，$\\left|H(M(T))-H(M(0))\\right|$，其中 $T$ 是最终时间。\n  2. 最大绝对能量偏差，$\\max_{0\\leq t\\leq T}\\left|H(M(t))-H(M(0))\\right|$。\n- 使用无量纲参数，并以浮点数形式返回所有请求的量。\n\n设计程序以运行以下测试套件。对于每个案例，使用给定的惯量 $I$、初始动量 $M(0)$、时间步长 $\\Delta t$ 和步数 $N$；总积分时间为 $T=N\\,\\Delta t$。所有旋转角必须以弧度处理。\n\n- 测试用例 1：$I=(1.0,2.0,3.0)$，$M(0)=(0.5,0.4,0.3)$，$\\Delta t=0.005$，$N=40000$。\n- 测试用例 2：$I=(1.0,1.0,1.0)$，$M(0)=(0.3,-0.2,0.4)$，$\\Delta t=0.010$，$N=30000$。\n- 测试用例 3：$I=(1.5,2.5,3.5)$，$M(0)=(1.0,0.0,0.0)$，$\\Delta t=0.200$，$N=1000$。\n- 测试用例 4：$I=(0.8,1.1,1.3)$，$M(0)=(0.7,0.6,0.5)$，$\\Delta t=0.050$，$N=8000$。\n\n输出规范：\n- 对于每个测试用例，按顺序 $[\\text{final\\_error\\_Euler},\\text{max\\_deviation\\_Euler},\\text{final\\_error\\_LP},\\text{max\\_deviation\\_LP}]$ 生成一个包含四个浮点数的列表，其中 $\\text{LP}$ 表示保李-泊松结构的分裂法。\n- 您的程序应生成单行输出，其中包含一个由这些逐案例列表组成的逗号分隔列表，不含空格，并用方括号括起来。例如，两个案例的输出应类似于 $[[a_{1},b_{1},c_{1},d_{1}],[a_{2},b_{2},c_{2},d_{2}]]$。\n\n所有量都是无量纲的，所有角度都必须以弧度处理。每个测试用例的答案必须是浮点数。程序必须是自包含的，严格按照指定格式生成单行输出，并且不需要用户输入或外部文件。",
            "solution": "用户提供的问题是几何力学和数值分析领域中一个适定且标准的任务。它要求实现并比较两种用于自由刚体欧拉方程的数值积分器。验证过程如下。\n\n### 步骤 1：提取给定信息\n- **系统**：自由刚体被描述为 $\\mathfrak{so}(3)^{\\ast}$（三维特殊正交群李代数的对偶空间）上的一个李-泊松系统。\n- **状态向量**：体坐标系中的角动量为 $M=(M_{1},M_{2},M_{3})\\in\\mathbb{R}^{3}$。\n- **惯性张量**：刚体具有一个对角惯性张量，其主转动惯量为 $I=(I_{1},I_{2},I_{3})$，其中 $I_{k}0$。\n- **哈密顿量**：系统的能量由哈密顿量 $H(M)=\\frac{1}{2}\\,M\\cdot I^{-1}M=\\frac{1}{2}\\sum_{k=1}^{3}\\frac{M_{k}^{2}}{I_{k}}$ 给出。\n- **李-泊松括号**：对于 $\\mathfrak{so}(3)^{\\ast}$ 上的任意两个光滑函数 $F,G$，其括号为 $\\{F,G\\}(M)=-M\\cdot\\left(\\nabla F(M)\\times\\nabla G(M)\\right)$。\n- **运动方程**：动力学由哈密顿方程 $\\dot{M}=\\{M,H\\}(M)$ 给出，其计算结果为欧拉方程 $\\dot{M}=M\\times\\Omega$，其中 $\\Omega=I^{-1}M$ 是体坐标系中的角速度。\n- **任务**：实现、测试和比较两种数值积分方法：\n    1.  **显式欧拉法**：一种标准的、一阶的、非守恒的数值格式。\n    2.  **李-泊松分裂法**：一种几何积分器，通过分裂哈密顿量 $H = \\sum_{k=1}^{3} H_{k}$（其中 $H_{k}(M)=\\frac{1}{2}\\frac{M_{k}^{2}}{I_{k}}$）、精确积分每个 $H_k$ 的流，并使用二阶斯特朗分裂（Strang splitting）将它们组合起来构造。\n- **分析**：对于每种方法和每个测试用例，计算最终绝对能量误差 $\\left|H(M(T))-H(M(0))\\right|$，以及在积分区间内的最大绝对能量偏差 $\\max_{0\\leq t\\leq T}\\left|H(M(t))-H(M(0))\\right|$。\n- **测试用例**：提供了四个具体的测试用例，每个用例都给出了 $I$、$M(0)$、时间步长 $\\Delta t$ 和步数 $N$ 的值。\n\n### 步骤 2：使用提取的给定信息进行验证\n对问题进行严格验证。\n- **科学基础**：该问题基于刚体运动的经典力学及其在几何力学中的现代表述。欧拉方程、哈密顿量以及 $\\mathfrak{so}(3)^{\\ast}$ 的李-泊松括号都是标准且正确的。\n- **适定性**：该问题是一个定义明确的常微分方程组初值问题。矢量场是光滑的，保证了局部解的存在性和唯一性。比较数值积分器是一项计算科学中标准且有意义的任务。\n- **客观性**：问题以精确、客观的数学术语陈述。所有参数都已定义，所需的输出也已定量指定。\n- **完整性与一致性**：问题陈述是自包含的。它提供了所有必要的信息，包括控制方程、数值方法的构造以及测试套件的参数。没有矛盾之处。\n- **可行性**：指定的计算在数值上是可行的，并且可以在标准编程环境中实现。参数在物理上和数值上都是合理的。非几何方法（欧拉法）与几何方法（李-泊松分裂法）之间的比较是一个典型的练习，突出了数值积分的基本概念。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个可靠、适定且非平凡的几何数值积分问题。将提供一个解。\n\n### 求解推导\n\n自由刚体的动力学由欧拉方程控制：\n$$ \\dot{M} = M \\times \\Omega, \\quad \\text{其中} \\quad \\Omega=I^{-1}M = \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) $$\n\n**方法 1：显式欧拉法**\n这是一种标准的一阶数值积分格式。给定在时间 $t_n$ 的状态 $M^n$，在时间 $t_{n+1} = t_n + \\Delta t$ 的状态 $M^{n+1}$ 可近似为：\n$$ M^{n+1} = M^n + \\Delta t \\cdot \\dot{M}^n = M^n + \\Delta t \\cdot (M^n \\times (I^{-1}M^n)) $$\n该方法易于实现，但其设计并未保持系统的几何结构。特别是，它不守恒哈密顿量 $H(M)$（能量）或卡西米尔函数 $C(M) = \\|M\\|^2$（角动量范数的平方）。能量误差预计会随时间增长，这种现象称为长期漂移。\n\n**方法 2：李-泊松分裂法**\n这是一种几何积分器，旨在保持精确流的某些定性特征。该方法通过分裂哈密顿量并组合更简单子系统的精确流来构造。\n\n1.  **哈密顿量分裂**：哈密顿量被加性地分裂为三个分量，每个主轴对应一个：\n    $$ H(M) = H_1(M) + H_2(M) + H_3(M), \\quad \\text{其中} \\quad H_k(M) = \\frac{1}{2}\\frac{M_k^2}{I_k} $$\n\n2.  **子系统动力学**：对于每个子哈密顿量 $H_k$，动力学由李-泊松括号给出：\n    $$ \\dot{M} = \\{M, H_k\\}(M) = M \\times \\nabla_M H_k(M) $$\n    每个 $H_k$ 的梯度很简单：\n    $$ \\nabla_M H_1 = \\frac{M_1}{I_1}e_1, \\quad \\nabla_M H_2 = \\frac{M_2}{I_2}e_2, \\quad \\nabla_M H_3 = \\frac{M_3}{I_3}e_3 $$\n    其中 $e_k$ 是标准基向量。第 $k$ 个子系统的运动方程为：\n    $$ \\dot{M} = M \\times \\left(\\frac{M_k}{I_k}e_k\\right) $$\n    对于这个子系统，分量 $M_k$ 是恒定的，因为 $\\dot{M}_k = e_k \\cdot \\dot{M} = e_k \\cdot (M \\times (\\frac{M_k}{I_k}e_k)) = 0$。因此，项 $\\frac{M_k}{I_k}e_k$ 是一个常向量。该方程描述了向量 $M$ 围绕固定轴 $e_k$ 以恒定角速度 $\\frac{M_k}{I_k}$ 进行的纯旋转。\n\n3.  **精确子流**：第 $k$ 个子系统在时间间隔 $\\Delta t$ 内的精确解（流），记为 $\\phi_{H_k}^{\\Delta t}$，是动量向量 $M$ 围绕轴 $e_k$ 旋转一个角度 $\\alpha_k = \\frac{M_k}{I_k}\\Delta t$。这可以使用标准旋转矩阵来实现。例如，对于 $k=1$，旋转为：\n    $$ \\phi_{H_1}^{\\Delta t}(M) = R_1\\left(\\frac{M_1}{I_1}\\Delta t\\right) M, \\quad \\text{其中} \\quad R_1(\\alpha) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha \\end{pmatrix} $$\n    其他子系统也适用类似的旋转矩阵 $R_2(\\alpha)$ 和 $R_3(\\alpha)$。\n\n4.  **斯特朗分裂组合**：为了近似完整哈密顿量 $H$ 的流，我们使用一种二阶对称组合，称为斯特朗分裂。从 $t_n$ 到 $t_n+\\Delta t$ 的一个积分步长由以下公式给出：\n    $$ M^{n+1} = \\left( \\phi_{H_1}^{\\Delta t/2} \\circ \\phi_{H_2}^{\\Delta t/2} \\circ \\phi_{H_3}^{\\Delta t} \\circ \\phi_{H_2}^{\\Delta t/2} \\circ \\phi_{H_1}^{\\Delta t/2} \\right) M^n $$\n    这意味着我们应用一个由五次旋转组成的序列。至关重要的是，每次旋转的角度必须使用前一次旋转*结果*的动量分量来计算。因为每一步都是一次旋转，所以范数 $\\|M\\|$ 被此数值方法精确守恒。因此，卡西米尔不变量是守恒的，该积分器是李-泊松的。哈密顿量 $H$ 通常不是卡西米尔函数，所以它不会被精确守恒，但误差预计将在长时间积分中保持有界，不表现出长期漂移。\n\n对于精确解是固定点的特殊测试用例（案例 2：球形陀螺，案例 3：绕主轴旋转），预计两种方法都会产生零误差或机器精度误差。球形陀螺特别有趣，因为总的哈密顿流是平凡的（$\\dot{M}=0$），但单个分裂流并非如此。李-泊松方法在这种情况下能够完美抵消，证明了其几何特性，因为它精确地守恒了由守恒量 $\\|M\\|$ 构成的哈密顿量 $H \\propto \\|M\\|^2$。\n\n程序将实现这两种方法，对给定的测试用例进行模拟，并计算指定的误差度量，以展示这些特性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the rigid body dynamics problem.\n    It runs simulations for predefined test cases using two different\n    numerical integrators and prints the energy error metrics.\n    \"\"\"\n\n    test_cases = [\n        # I, M(0), dt, N\n        ((1.0, 2.0, 3.0), (0.5, 0.4, 0.3), 0.005, 40000),\n        ((1.0, 1.0, 1.0), (0.3, -0.2, 0.4), 0.010, 30000),\n        ((1.5, 2.5, 3.5), (1.0, 0.0, 0.0), 0.200, 1000),\n        ((0.8, 1.1, 1.3), (0.7, 0.6, 0.5), 0.050, 8000),\n    ]\n\n    results = []\n    for I_tuple, M0_tuple, dt, N in test_cases:\n        I = np.array(I_tuple, dtype=float)\n        M0 = np.array(M0_tuple, dtype=float)\n        I_inv = 1.0 / I\n\n        def hamiltonian(M, inv_I):\n            \"\"\"Computes the Hamiltonian (energy) of the rigid body.\"\"\"\n            return 0.5 * np.sum(M**2 * inv_I)\n\n        # --- 1. Explicit Euler Method ---\n        M_e = M0.copy()\n        H0 = hamiltonian(M_e, I_inv)\n        max_deviation_euler = 0.0\n        \n        for _ in range(N):\n            M_dot = np.cross(M_e, M_e * I_inv)\n            M_e += dt * M_dot\n            current_H = hamiltonian(M_e, I_inv)\n            deviation = abs(current_H - H0)\n            if deviation > max_deviation_euler:\n                max_deviation_euler = deviation\n        \n        final_error_euler = abs(hamiltonian(M_e, I_inv) - H0)\n\n        # --- 2. Lie-Poisson Splitting Method ---\n        def lie_poisson_step(M_current, inv_I, step_t):\n            \"\"\"Performs one step of the Lie-Poisson Strang splitting integrator.\"\"\"\n            M = M_current.copy()\n            \n            # phi_H1(dt/2)\n            angle1 = M[0] * inv_I[0] * step_t / 2.0\n            c1, s1 = np.cos(angle1), np.sin(angle1)\n            R1 = np.array([[1.0, 0.0, 0.0], [0.0, c1, -s1], [0.0, s1, c1]])\n            M = R1 @ M\n\n            # phi_H2(dt/2)\n            angle2 = M[1] * inv_I[1] * step_t / 2.0\n            c2, s2 = np.cos(angle2), np.sin(angle2)\n            R2 = np.array([[c2, 0.0, s2], [0.0, 1.0, 0.0], [-s2, 0.0, c2]])\n            M = R2 @ M\n\n            # phi_H3(dt)\n            angle3 = M[2] * inv_I[2] * step_t\n            c3, s3 = np.cos(angle3), np.sin(angle3)\n            R3 = np.array([[c3, -s3, 0.0], [s3, c3, 0.0], [0.0, 0.0, 1.0]])\n            M = R3 @ M\n\n            # phi_H2(dt/2)\n            angle2_rev = M[1] * inv_I[1] * step_t / 2.0\n            c2_rev, s2_rev = np.cos(angle2_rev), np.sin(angle2_rev)\n            R2_rev = np.array([[c2_rev, 0.0, s2_rev], [0.0, 1.0, 0.0], [-s2_rev, 0.0, c2_rev]])\n            M = R2_rev @ M\n\n            # phi_H1(dt/2)\n            angle1_rev = M[0] * inv_I[0] * step_t / 2.0\n            c1_rev, s1_rev = np.cos(angle1_rev), np.sin(angle1_rev)\n            R1_rev = np.array([[1.0, 0.0, 0.0], [0.0, c1_rev, -s1_rev], [0.0, s1_rev, c1_rev]])\n            M = R1_rev @ M\n\n            return M\n\n        M_lp = M0.copy()\n        # H0 is the same as for Euler\n        max_deviation_lp = 0.0\n        \n        for _ in range(N):\n            M_lp = lie_poisson_step(M_lp, I_inv, dt)\n            current_H = hamiltonian(M_lp, I_inv)\n            deviation = abs(current_H - H0)\n            if deviation > max_deviation_lp:\n                max_deviation_lp = deviation\n        \n        final_error_lp = abs(hamiltonian(M_lp, I_inv) - H0)\n        \n        # Collect results for the current test case\n        case_results = [\n            final_error_euler, \n            max_deviation_euler,\n            final_error_lp,\n            max_deviation_lp\n        ]\n        results.append(case_results)\n\n    # Format the output string to match the specification \"[ [r1,r2,...],[...],... ]\"\n    # with no spaces.\n    inner_strings = [f\"[{','.join(map(str, r))}]\" for r in results]\n    final_output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}