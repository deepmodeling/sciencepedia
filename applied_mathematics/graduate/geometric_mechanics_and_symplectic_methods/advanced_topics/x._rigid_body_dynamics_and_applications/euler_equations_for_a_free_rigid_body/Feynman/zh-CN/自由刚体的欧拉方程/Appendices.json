{
    "hands_on_practices": [
        {
            "introduction": "在研究刚体的动力学之前，我们必须首先了解其质量分布如何影响其转动。惯性张量 $I$ 正是描述这一性质的关键物理量。本练习将引导你从动能的积分定义出发，推导出惯性张量的通用表达式，并将其应用于一个均匀矩形块的具体案例，从而将抽象的张量概念与可触知的物理对象联系起来 ()。",
            "id": "3740943",
            "problem": "考虑一个自由刚体，其位形空间为特殊正交群 (SO(3))。在体坐标系中，设质量密度是一个光滑函数 $\\rho(x)$，其支集为有界区域 $\\mathcal{B} \\subset \\mathbb{R}^{3}$，其中 $x \\in \\mathcal{B}$ 是相对于位于质心的体固定坐标系原点测量的。该刚体具有以体坐标系表示的角速度 $\\omega \\in \\mathbb{R}^{3}$，瞬时体速度场为 $v(x) = \\omega \\times x$。动能由积分 $T = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, dx$ 给出。\n\n从这个基本出发点开始，首先推导惯性张量 $I \\in \\mathbb{R}^{3 \\times 3}$ 的显式积分公式，使得对于所有 $\\omega$ 都有 $T = \\frac{1}{2} \\, \\omega^{\\top} I \\, \\omega$ 成立。其次，对于一个占据体域 $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$ 的均匀长方体，计算该公式。该长方体具有恒定密度 $\\rho_{0} > 0$，总质量为 $m = \\rho_{0} L_{x} L_{y} L_{z}$。使用与长方体边缘对齐的体固定坐标轴（因此惯性张量及其主惯性矩是关于以长方体边缘为轴的质心坐标系计算的）。\n\n以 $m$、$L_{x}$、$L_{y}$ 和 $L_{z}$ 表示，给出主惯性矩的有序三元组 $(I_{xx}, I_{yy}, I_{zz})$作为最终答案。以国际单位制 (SI) 中的千克米平方为单位表示您的最终答案。将您的最终三元组写成单行矩阵。无需四舍五入。",
            "solution": "该问题提出了一个经典力学中的有效且适定的问题，特别是关于自由刚体的动力学。所有定义和给定条件都是标准的、科学上合理的且自洽的。该问题由两部分组成：首先，从动能推导惯性张量的一般形式；其次，针对特定几何形状计算该张量。\n\n第 1 部分：惯性张量的推导\n\n刚体的动能 $T$ 由其微小质量元的动能在其整个体积上的积分给出。在以质心为原点的体固定坐标系中，点 $x \\in \\mathcal{B}$ 的速度是纯旋转的，由 $v(x) = \\omega \\times x$ 给出，其中 $\\omega$ 是刚体的角速度矢量。\n\n动能为：\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, d^3x = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|\\omega \\times x\\|^{2} \\, d^3x\n$$\n我们使用矢量恒等式 $\\|\\mathbf{a} \\times \\mathbf{b}\\|^2 = \\|\\mathbf{a}\\|^2 \\|\\mathbf{b}\\|^2 - (\\mathbf{a} \\cdot \\mathbf{b})^2$。令 $\\omega = (\\omega_1, \\omega_2, \\omega_3)$ 和 $x = (x_1, x_2, x_3)$。那么，$\\|\\omega\\|^2 = \\sum_i \\omega_i^2$，$\\|x\\|^2 = \\sum_k x_k^2$ 且 $\\omega \\cdot x = \\sum_j \\omega_j x_j$。\n所以，\n$$\n\\|\\omega \\times x\\|^2 = \\left(\\sum_i \\omega_i^2\\right) \\left(\\sum_k x_k^2\\right) - \\left(\\sum_j \\omega_j x_j\\right)^2\n$$\n我们可以将其表示为 $\\omega$ 的二次型。让我们使用爱因斯坦求和约定的索引表示法。\n$$\n\\|\\omega \\times x\\|^2 = \\omega_i \\omega_i x_k x_k - (\\omega_j x_j)(\\omega_m x_m)\n$$\n为了将其写成 $\\omega_j I_{jm} \\omega_m$ 的形式，我们处理一下索引：\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\delta_{jm} \\omega_m x_k x_k - \\omega_j x_j \\omega_m x_m\n$$\n其中 $\\delta_{jm}$ 是克罗内克 δ。将 $\\omega_j$ 和 $\\omega_m$ 提出公因子：\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\left( \\delta_{jm} (x_k x_k) - x_j x_m \\right) \\omega_m\n$$\n将此代入动能积分中：\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\left( \\omega_j \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\omega_m \\right) \\, d^3x\n$$\n由于角速度的分量 $\\omega_j$ 相对于在刚体 $\\mathcal{B}$ 上的空间积分是常数，我们可以将它们从积分中提出：\n$$\nT = \\frac{1}{2} \\, \\omega_j \\left( \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x \\right) \\omega_m\n$$\n该表达式的形式为 $T = \\frac{1}{2} \\omega^{\\top} I \\omega$，用索引表示法即为 $T = \\frac{1}{2} \\omega_j I_{jm} \\omega_m$。通过直接比较，我们确定惯性张量 $I$ 的分量为：\n$$\nI_{jm} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x\n$$\n这是惯性张量的一般积分公式。\n对角分量 ($j=m$)，称为转动惯量，是：\n$$\nI_{jj} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\|x\\|^2 - x_j^2 \\right) \\, d^3x\n$$\n例如，使用坐标 $(x,y,z)$ 表示 $(x_1, x_2, x_3)$：\n$$\nI_{xx} = I_{11} = \\int_{\\mathcal{B}} \\rho(x,y,z) (y^2+z^2) \\, dx\\,dy\\,dz\n$$\n非对角分量 ($j \\neq m$)，称为惯性积，是：\n$$\nI_{jm} = - \\int_{\\mathcal{B}} \\rho(x) x_j x_m \\, d^3x\n$$\n\n第 2 部分：对均匀长方体的计算\n\n给定一个具有恒定密度 $\\rho_0$ 和尺寸 $L_x, L_y, L_z$ 的长方体。区域为 $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$。总质量为 $m = \\rho_0 L_x L_y L_z$。体固定坐标轴与长方体的边缘对齐。\n\n首先，我们检查惯性积。例如，$I_{xy}$：\n$$\nI_{xy} = - \\int_{\\mathcal{B}} \\rho_0 x y \\, dx\\,dy\\,dz = -\\rho_0 \\left( \\int_{-L_x/2}^{L_x/2} x \\, dx \\right) \\left( \\int_{-L_y/2}^{L_y/2} y \\, dy \\right) \\left( \\int_{-L_z/2}^{L_z/2} dz \\right)\n$$\n积分 $\\int_{-L_x/2}^{L_x/2} x \\, dx = \\left[ \\frac{x^2}{2} \\right]_{-L_x/2}^{L_x/2} = \\frac{1}{2}\\left(\\left(\\frac{L_x}{2}\\right)^2 - \\left(-\\frac{L_x}{2}\\right)^2\\right) = 0$。\n该积分为零，因为被积函数是在对称区间上的奇函数。因此，$I_{xy} = 0$。根据对称性，$I_{xz} = 0$ 且 $I_{yz} = 0$。惯性张量是对角矩阵，其对角元素是主转动惯量。\n\n现在，我们计算主惯性矩。让我们从 $I_{xx}$ 开始：\n$$\nI_{xx} = \\int_{\\mathcal{B}} \\rho_0 (y^2 + z^2) \\, dx\\,dy\\,dz = \\rho_0 \\left( \\int_{\\mathcal{B}} y^2 \\, dV + \\int_{\\mathcal{B}} z^2 \\, dV \\right)\n$$\n其中 $dV = dx\\,dy\\,dz$。我们计算第一个积分：\n$$\n\\int_{\\mathcal{B}} y^2 \\, dV = \\int_{-L_x/2}^{L_x/2} dx \\int_{-L_y/2}^{L_y/2} y^2 \\, dy \\int_{-L_z/2}^{L_z/2} dz\n$$\n各个积分分别是：\n$\\int_{-L_x/2}^{L_x/2} dx = L_x$\n$\\int_{-L_z/2}^{L_z/2} dz = L_z$\n$\\int_{-L_y/2}^{L_y/2} y^2 \\, dy = \\left[ \\frac{y^3}{3} \\right]_{-L_y/2}^{L_y/2} = \\frac{1}{3}\\left( \\left(\\frac{L_y}{2}\\right)^3 - \\left(-\\frac{L_y}{2}\\right)^3 \\right) = \\frac{1}{3}\\left(\\frac{L_y^3}{8} + \\frac{L_y^3}{8}\\right) = \\frac{L_y^3}{12}$\n因此，$\\int_{\\mathcal{B}} y^2 \\, dV = L_x \\left( \\frac{L_y^3}{12} \\right) L_z = \\frac{L_x L_y^3 L_z}{12}$。\n通过对称性论证，$\\int_{\\mathcal{B}} z^2 \\, dV = \\frac{L_x L_y L_z^3}{12}$。\n将这些结果代回 $I_{xx}$ 的表达式中：\n$$\nI_{xx} = \\rho_0 \\left( \\frac{L_x L_y^3 L_z}{12} + \\frac{L_x L_y L_z^3}{12} \\right) = \\frac{\\rho_0 L_x L_y L_z}{12} (L_y^2 + L_z^2)\n$$\n使用给定的总质量关系 $m = \\rho_0 L_x L_y L_z$，我们得到：\n$$\nI_{xx} = \\frac{m}{12} (L_y^2 + L_z^2)\n$$\n另外两个主惯性矩，$I_{yy}$ 和 $I_{zz}$，可以通过对索引 $x, y, z$ 和相应的尺寸 $L_x, L_y, L_z$ 进行轮换置换得到：\n$$\nI_{yy} = \\frac{m}{12} (L_x^2 + L_z^2)\n$$\n$$\nI_{zz} = \\frac{m}{12} (L_x^2 + L_y^2)\n$$\n因此，主惯性矩的有序三元组 $(I_{xx}, I_{yy}, I_{zz})$ 是：\n$$\n\\left( \\frac{m}{12}(L_y^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_y^2) \\right)\n$$\n这些表达式的单位是质量乘以长度的平方（例如，在国际单位制中为 kg m$^2$），这符合转动惯量的要求。最终答案要求以单行矩阵的形式给出。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{m}{12}(L_y^2 + L_z^2) & \\frac{m}{12}(L_x^2 + L_z^2) & \\frac{m}{12}(L_x^2 + L_y^2) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一旦定义了惯性张量，我们便可以构建刚体运动的动力学方程。本练习将展示如何运用几何力学中强大而优美的李-泊松框架，从哈密顿量和李-泊松括号出发，系统地推导出刚体自由转动的欧拉方程。这个推导过程是理解刚体动力学几何结构的核心实践 ()。",
            "id": "3748149",
            "problem": "考虑一个自由刚体（欧拉陀螺），其主转动惯量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 互不相同，在体坐标系中于特殊正交群 $\\operatorname{SO}(3)$ 上演化。设体角动量为 $M = (M_{1}, M_{2}, M_{3}) \\in \\mathfrak{so}(3)^{\\ast}$，体角速度为 $\\Omega = (\\Omega_{1}, \\Omega_{2}, \\Omega_{3}) \\in \\mathbb{R}^{3}$，它们之间的关系为 $M = \\mathbb{I}\\Omega$，其中 $\\mathbb{I} = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$。该动力学系统在李代数对偶空间 $\\mathfrak{so}(3)^{\\ast}$ 上是哈密顿的，其李-泊松括号（LP括号）对于光滑函数 $F, G : \\mathfrak{so}(3)^{\\ast} \\to \\mathbb{R}$ 定义为\n$$\n\\{F, G\\}(M) = -\\,M \\cdot \\big(\\nabla F(M) \\times \\nabla G(M)\\big),\n$$\n哈密顿量为\n$$\nH(M) = \\tfrac{1}{2}\\,\\Omega \\cdot M = \\tfrac{1}{2}\\,M \\cdot \\mathbb{I}^{-1}M.\n$$\n从这些定义出发，推导坐标函数 $M_{i}$ ($i \\in \\{1,2,3\\}$) 的哈密顿运动方程，并以 $M$ 的分量以及主转动惯量 $I_{1}, I_{2}, I_{3}$ 表示时间导数 $\\frac{d}{dt}(M_{i})$。通过将 $\\frac{d}{dt}(M_{i})$ 完全用 $M_{j}$ 和 $I_{k}$ 表示，明确验证各分量如何通过转动惯量耦合。\n\n将最终答案表示为一个单行矩阵，其中包含三个分量表达式 $\\frac{d}{dt}(M_{1})$、$\\frac{d}{dt}(M_{2})$ 和 $\\frac{d}{dt}(M_{3})$。不需要进行数值计算，也不需要包含单位。",
            "solution": "首先根据既定标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取给定条件**\n- **系统**：一个自由刚体（欧拉陀螺）。\n- **主转动惯量**：$I_{1}$、$I_{2}$ 和 $I_{3}$（互不相同）。\n- **体角动量**：$M = (M_{1}, M_{2}, M_{3}) \\in \\mathfrak{so}(3)^{\\ast}$。\n- **体角速度**：$\\Omega = (\\Omega_{1}, \\Omega_{2}, \\Omega_{3}) \\in \\mathbb{R}^{3}$。\n- **M 与 $\\Omega$ 之间的关系**：$M = \\mathbb{I}\\Omega$，其中 $\\mathbb{I} = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$。\n- **李-泊松括号**：对于光滑函数 $F, G : \\mathfrak{so}(3)^{\\ast} \\to \\mathbb{R}$，括号定义为 $\\{F, G\\}(M) = -\\,M \\cdot \\big(\\nabla F(M) \\times \\nabla G(M)\\big)$。\n- **哈密顿量**：$H(M) = \\tfrac{1}{2}\\,\\Omega \\cdot M = \\tfrac{1}{2}\\,M \\cdot \\mathbb{I}^{-1}M$。\n\n**第2步：使用提取的给定条件进行验证**\n- **科学依据**：该问题描述了欧拉陀螺在 $\\operatorname{SO}(3)$ 李代数对偶空间上的哈密顿表述。所提供的哈密顿量是动能，李-泊松括号是 $\\mathfrak{so}(3)^{\\ast}$ 的标准括号。这种表述是几何力学的基石。因此，该问题是科学合理的。\n- **适定性**：该问题提供了推导运动方程所需的所有定义和方程。它要求进行一个由给定条件唯一确定的特定计算。\n- **客观性**：该问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n- **缺陷检查**：\n  1. **科学/事实不准确**：无。所涉及的物理和数学是标准且正确的。\n  2. **不可形式化/不相关**：无。该问题是指定领域的核心练习。\n  3. **不完整/矛盾的设置**：无。所有定义均已提供且相互一致。\n  4. **不切实际/不可行**：无。这是一个标准的、具有物理意义的模型。\n  5. **不适定/结构不良**：无。推导过程得出一个唯一的、定义明确的结果。\n  6. **伪深刻/琐碎**：无。该推导是一个基础计算，展示了李-泊松形式体系的应用。\n  7. **超出科学可验证性范围**：无。该推导是一个数学证明。\n\n**第3步：结论与行动**\n该问题是**有效的**。继续进行求解。\n\n### 运动方程的推导\n\n相空间 $\\mathfrak{so}(3)^{\\ast}$ 上任意可观测量 $F(M)$ 的时间演化由哈密顿方程决定：\n$$\n\\frac{dF}{dt} = \\{F, H\\}\n$$\n其中 $H$ 是哈密顿量，$\\{\\cdot, \\cdot\\}$ 是李-泊松括号。我们的任务是求出角动量矢量分量 $M_i$ 的运动方程。这对应于将可观测量 $F$ 分别设为坐标函数 $M_1$、$M_2$ 和 $M_3$。\n\n李-泊松括号由下式给出：\n$$\n\\{F, G\\}(M) = -M \\cdot \\left(\\nabla F(M) \\times \\nabla G(M)\\right)\n$$\n这里，$\\nabla$ 是关于坐标 $M = (M_1, M_2, M_3)$ 的梯度，即 $\\nabla = \\left(\\frac{\\partial}{\\partial M_1}, \\frac{\\partial}{\\partial M_2}, \\frac{\\partial}{\\partial M_3}\\right)$。\n\n我们需要计算 $\\frac{dM_i}{dt} = \\{M_i, H\\}$，其中 $i \\in \\{1, 2, 3\\}$。这需要计算函数 $M_i$ 和哈密顿量 $H$ 的梯度。\n\n首先，我们求哈密顿量 $H$ 的梯度。哈密顿量由下式给出：\n$$\nH(M) = \\frac{1}{2} M \\cdot \\mathbb{I}^{-1}M = \\frac{1}{2} \\left( \\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3} \\right)\n$$\n梯度 $\\nabla H$ 是一个矢量，其分量是 $H$ 对每个 $M_i$ 的偏导数：\n$$\n\\frac{\\partial H}{\\partial M_1} = \\frac{M_1}{I_1}, \\quad \\frac{\\partial H}{\\partial M_2} = \\frac{M_2}{I_2}, \\quad \\frac{\\partial H}{\\partial M_3} = \\frac{M_3}{I_3}\n$$\n因此，梯度矢量为：\n$$\n\\nabla H = \\left( \\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3} \\right) = \\mathbb{I}^{-1}M = \\Omega\n$$\n\n接下来，我们计算坐标函数 $F = M_i$ 的梯度。\n对于 $F = M_1$：\n$$\n\\nabla M_1 = \\left(\\frac{\\partial M_1}{\\partial M_1}, \\frac{\\partial M_1}{\\partial M_2}, \\frac{\\partial M_1}{\\partial M_3}\\right) = (1, 0, 0) = \\mathbf{e}_1\n$$\n同理，$\\nabla M_2 = \\mathbf{e}_2$ 且 $\\nabla M_3 = \\mathbf{e}_3$。\n\n现在我们可以计算每个分量 $M_i$ 的时间导数。\n\n**对于 $M_1$：**\n$$\n\\frac{dM_1}{dt} = \\{M_1, H\\} = -M \\cdot (\\nabla M_1 \\times \\nabla H)\n$$\n我们计算叉积：\n$$\n\\nabla M_1 \\times \\nabla H = \\mathbf{e}_1 \\times \\Omega = (1, 0, 0) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(0, -\\frac{M_3}{I_3}, \\frac{M_2}{I_2}\\right)\n$$\n现在，我们与 $-M$ 求点积：\n$$\n\\frac{dM_1}{dt} = -(M_1, M_2, M_3) \\cdot \\left(0, -\\frac{M_3}{I_3}, \\frac{M_2}{I_2}\\right) = -\\left( M_2 \\left(-\\frac{M_3}{I_3}\\right) + M_3 \\left(\\frac{M_2}{I_2}\\right) \\right)\n$$\n$$\n\\frac{dM_1}{dt} = -\\left( -\\frac{M_2 M_3}{I_3} + \\frac{M_2 M_3}{I_2} \\right) = M_2 M_3 \\left(\\frac{1}{I_3} - \\frac{1}{I_2}\\right)\n$$\n\n**对于 $M_2$：**\n$$\n\\frac{dM_2}{dt} = \\{M_2, H\\} = -M \\cdot (\\nabla M_2 \\times \\nabla H)\n$$\n叉积是：\n$$\n\\nabla M_2 \\times \\nabla H = \\mathbf{e}_2 \\times \\Omega = (0, 1, 0) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(\\frac{M_3}{I_3}, 0, -\\frac{M_1}{I_1}\\right)\n$$\n与 $-M$ 求点积：\n$$\n\\frac{dM_2}{dt} = -(M_1, M_2, M_3) \\cdot \\left(\\frac{M_3}{I_3}, 0, -\\frac{M_1}{I_1}\\right) = -\\left( M_1 \\left(\\frac{M_3}{I_3}\\right) + M_3 \\left(-\\frac{M_1}{I_1}\\right) \\right)\n$$\n$$\n\\frac{dM_2}{dt} = -\\left( \\frac{M_1 M_3}{I_3} - \\frac{M_1 M_3}{I_1} \\right) = M_1 M_3 \\left(\\frac{1}{I_1} - \\frac{1}{I_3}\\right)\n$$\n\n**对于 $M_3$：**\n$$\n\\frac{dM_3}{dt} = \\{M_3, H\\} = -M \\cdot (\\nabla M_3 \\times \\nabla H)\n$$\n叉积是：\n$$\n\\nabla M_3 \\times \\nabla H = \\mathbf{e}_3 \\times \\Omega = (0, 0, 1) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(-\\frac{M_2}{I_2}, \\frac{M_1}{I_1}, 0\\right)\n$$\n与 $-M$ 求点积：\n$$\n\\frac{dM_3}{dt} = -(M_1, M_2, M_3) \\cdot \\left(-\\frac{M_2}{I_2}, \\frac{M_1}{I_1}, 0\\right) = -\\left( M_1 \\left(-\\frac{M_2}{I_2}\\right) + M_2 \\left(\\frac{M_1}{I_1}\\right) \\right)\n$$\n$$\n\\frac{dM_3}{dt} = -\\left( -\\frac{M_1 M_2}{I_2} + \\frac{M_1 M_2}{I_1} \\right) = M_1 M_2 \\left(\\frac{1}{I_2} - \\frac{1}{I_1}\\right)\n$$\n\n这些是自由刚体的欧拉运动方程，以体坐标系中的角动量分量 $M_i$ 和主转动惯量 $I_k$ 表示。分量之间的耦合通过其他两个动量分量的乘积以及逆转动惯量的差值明确地显示出来。\n\n最终结果是 $\\frac{d}{dt}(M_i)$ 的三个表达式集合。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} M_{2}M_{3}\\left(\\frac{1}{I_{3}} - \\frac{1}{I_{2}}\\right) & M_{1}M_{3}\\left(\\frac{1}{I_{1}} - \\frac{1}{I_{3}}\\right) & M_{1}M_{2}\\left(\\frac{1}{I_{2}} - \\frac{1}{I_{1}}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然我们推导出了欧拉方程的解析形式，但对于复杂的初始条件，求解其长期演化通常需要借助数值方法。本计算练习将带你进入实际应用的领域，通过编程实现并比较两种常见的数值积分方法。你将亲手验证理论上的守恒量（如角动量模长）在数值计算中如何表现，并量化不同方法和步长带来的误差 ()。",
            "id": "3776192",
            "problem": "考虑体坐标系中的自由刚体，该刚体被建模为特殊正交群李代数的对偶空间（记为 $\\mathfrak{so}(3)^{\\ast}$）上的一个李-泊松系统。设体角动量为 $M \\in \\mathbb{R}^{3}$，对角惯性张量为 $I = \\mathrm{diag}(I_{1}, I_{2}, I_{3})$（其元素严格为正），体角速度为 $\\omega = I^{-1} M$。自由刚体在体坐标系中的演化方程（欧拉方程）由以下常微分方程 (ODE) 给出：\n$$\n\\dot{M} = M \\times \\omega = M \\times (I^{-1} M),\n$$\n这是一个李-泊松系统，其哈密顿量为 $H(M) = \\tfrac{1}{2} M \\cdot I^{-1} M$，对于光滑函数 $F,G : \\mathbb{R}^{3} \\to \\mathbb{R}$，其泊松括号为 $\\{F,G\\}(M) = -M \\cdot (\\nabla F \\times \\nabla G)$。该李-泊松系统的一个基本不变量（卡西米尔不变量）是角动量范数的平方 $C(M) = \\tfrac{1}{2} \\|M\\|^{2}$。\n\n你的任务是编写一个完整的、可运行的程序，该程序能够：\n- 使用两种固定步长方法（显式 Euler 法和经典四阶 Runge-Kutta (RK4) 法）对该 ODE 进行数值积分。\n- 通过为每种方法和步长量化 $\\|M\\|$ 中由离散化引起的漂移，来数值验证对于精确动力学 $\\|M(t)\\|$ 保持不变。\n- 通过报告每个测试用例在整个模拟过程中范数与其初始值的最大相对偏差，来评估对离散化误差的敏感性。\n\n在无量纲单位下进行计算。对于由数值方法在时间区间 $[0,T]$ 上以固定步长 $h$ 计算出的给定轨迹 $M_{0}, M_{1}, \\dots, M_{N}$，将最大相对范数漂移定义为\n$$\n\\Delta = \\max_{0 \\leq n \\leq N} \\frac{\\big|\\|M_{n}\\| - \\|M_{0}\\|\\big|}{\\|M_{0}\\|}.\n$$\n\n将两种方法均实现为固定步长积分器：\n- 显式 Euler 法：$M_{n+1} = M_{n} + h f(M_{n})$，其中 $f(M) = M \\times (I^{-1} M)$。\n- 经典 RK4 法，使用 $f(M)$ 和常规的 Butcher 表。\n\n测试套件：\n计算以下八个测试用例中每个用例的 $\\Delta$。每个用例由惯性分量 $(I_{1}, I_{2}, I_{3})$、初始动量分量 $(M_{0x}, M_{0y}, M_{0z})$、总时间 $T$、固定时间步长 $h$ 以及要使用的数值方法（\"euler\" 或 \"rk4\"）指定。\n\n1. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$，$(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$，$T = 5.0$，$h = 1\\times 10^{-3}$，方法 = \"rk4\"。\n2. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$，$(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$，$T = 5.0$，$h = 5\\times 10^{-3}$，方法 = \"rk4\"。\n3. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$，$(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$，$T = 5.0$，$h = 5\\times 10^{-2}$，方法 = \"rk4\"。\n4. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$，$(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$，$T = 5.0$，$h = 1\\times 10^{-3}$，方法 = \"euler\"。\n5. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$，$(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$，$T = 5.0$，$h = 5\\times 10^{-3}$，方法 = \"euler\"。\n6. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$，$(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$，$T = 5.0$，$h = 5\\times 10^{-2}$，方法 = \"euler\"。\n7. $(I_{1},I_{2},I_{3}) = (1.0, 1.0, 1.0)$，$(M_{0x}, M_{0y}, M_{0z}) = (0.7, 0.0, 0.0)$，$T = 5.0$，$h = 1\\times 10^{-1}$，方法 = \"euler\"。\n8. $(I_{1},I_{2},I_{3}) = (1.0, 2.0, 3.0)$，$(M_{0x}, M_{0y}, M_{0z}) = (1.0, 0.0, 0.5)$，$T = 10.0$，$h = 1\\times 10^{-2}$，方法 = \"rk4\"。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每个条目是对应测试用例的最大相对范数漂移 $\\Delta$（如上定义），并四舍五入到十位有效数字。例如，输出应如下所示：\n$$\n[\\Delta_{1},\\Delta_{2},\\dots,\\Delta_{8}]\n$$\n其中每个 $\\Delta_{k}$ 是一个四舍五入到十位有效数字的浮点数。",
            "solution": "在尝试任何解决方案之前，问题陈述都经过了严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **系统**: 体坐标系中的自由刚体。\n- **模型**: 特殊正交群李代数的对偶空间 $\\mathfrak{so}(3)^{\\ast}$ 上的一个李-泊松系统。\n- **状态变量**: 体角动量，$M \\in \\mathbb{R}^{3}$。\n- **参数**: 对角惯性张量 $I = \\mathrm{diag}(I_{1}, I_{2}, I_{3})$，其中 $I_{k} > 0$。\n- **导出变量**: 体角速度，$\\omega = I^{-1} M$。\n- **运动方程**: 自由刚体的欧拉方程，由 ODE $\\dot{M} = M \\times \\omega = M \\times (I^{-1} M)$ 给出。\n- **哈密顿量**: $H(M) = \\tfrac{1}{2} M \\cdot I^{-1} M$。\n- **泊松括号**: $\\{F,G\\}(M) = -M \\cdot (\\nabla F \\times \\nabla G)$。\n- **卡西米尔不变量**: 角动量范数的平方，$C(M) = \\tfrac{1}{2} \\|M\\|^{2}$，这意味着 $\\|M(t)\\|$ 是真实动力学的一个守恒量。\n- **任务**: 使用两种方法对 ODE 进行数值积分，并量化卡西米尔不变量 $\\|M\\|$ 的数值漂移。\n- **数值方法**:\n    1.  显式 Euler 法：$M_{n+1} = M_{n} + h f(M_{n})$，其中 $f(M) = M \\times (I^{-1} M)$。\n    2.  经典四阶 Runge-Kutta (RK4) 法。\n- **度量**: 在模拟区间 $[0,T]$ 上的最大相对范数漂移定义为 $\\Delta = \\max_{0 \\leq n \\leq N} \\frac{\\big|\\|M_{n}\\| - \\|M_{0}\\|\\big|}{\\|M_{0}\\|}$，其中 $N$ 是步数。\n- **测试套件**: 指定了八个测试用例，每个用例都给定了 $(I_{1}, I_{2}, I_{3})$、$(M_{0x}, M_{0y}, M_{0z})$、总时间 $T$、步长 $h$ 以及所选数值方法的值。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学基础**: 该问题是几何力学中一个经典且基础的例子。将刚体动力学表述为 $\\mathfrak{so}(3)^{\\ast}$ 上的李-泊松系统、欧拉方程的形式、哈密顿量以及将 $\\|M\\|^2$ 识别为卡西米尔不变量，这些都是标准且正确的。\n2.  **适定性**: 该问题是一个标准的常微分方程组初值问题。方程右侧 $f(M) = M \\times (I^{-1} M)$ 是一个关于 $M$ 分量的向量值多项式，这使其在任何有界域上都是光滑且全局利普希茨的。这保证了对于给定的初始条件 $M_0$，解的存在性和唯一性。为每个测试用例提供了所有参数和初始条件，并且度量 $\\Delta$ 的定义是明确的（因为在所有情况下 $\\|M_0\\| \\neq 0$）。\n3.  **客观性**: 该问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n4.  **完整性与一致性**: 该问题是自洽的。为八个测试用例中的每一个都提供了所有必要的数据（$I$, $M_0$, $T$, $h$, 方法）。没有矛盾之处。\n5.  **平凡性**: 该问题并非微不足道。它要求正确实现两种标准的数值方法，并理解它们如何与动力学系统的守恒量相互作用。$I_1=I_2=I_3$ 的特殊情况作为一个非平凡的合理性检查，因为此时动力学变得平凡（$\\dot{M}=0$），任何非零的漂移都将表明存在实现错误。\n\n### 步骤 3：结论与行动\n该问题是有效的。它是计算物理和数值分析领域一个定义明确的任务，其基础是经典力学和几何力学的既定原理。将提供一个解决方案。\n\n### 解法推导\n问题的核心是求解角动量向量 $M(t) \\in \\mathbb{R}^3$ 的初值问题：\n$$\n\\frac{dM}{dt} = M(t) \\times (I^{-1} M(t)), \\quad M(0) = M_0\n$$\n惯性张量 $I$ 是对角阵，因此其逆 $I^{-1}$ 也是对角阵，元素为 $1/I_1$、$1/I_2$ 和 $1/I_3$。ODE 的右侧（我们记为 $f(M)$）可以按分量计算。如果 $M = (M_x, M_y, M_z)^T$，则\n$$\nf(M) = \n\\begin{pmatrix} M_x \\\\ M_y \\\\ M_z \\end{pmatrix} \n\\times\n\\begin{pmatrix} M_x/I_1 \\\\ M_y/I_2 \\\\ M_z/I_3 \\end{pmatrix} \n=\n\\begin{pmatrix} M_y M_z (1/I_3 - 1/I_2) \\\\ M_z M_x (1/I_1 - 1/I_3) \\\\ M_x M_y (1/I_2 - 1/I_1) \\end{pmatrix}\n$$\n该问题要求使用固定步长 $h$ 从 $t=0$ 积分到 $t=T$。步数为 $N = T/h$。对于所有提供的测试用例，$T/h$ 都是一个整数。设 $M_n$ 是 $M(n h)$ 的数值近似。\n\n**1. 显式 Euler 法**\n这是一种一阶方法。单步更新规则为：\n$$\nM_{n+1} = M_n + h f(M_n)\n$$\n这种方法实现简单，但众所周知它不保持像卡西米尔不变量这样的几何不变量。对于 Euler-Poincaré 方程，显式 Euler 法通常会导致动量范数呈现出长期的、单调的漂移。分析表明 $\\|M_{n+1}\\|^2 = \\|M_n\\|^2 + h^2 \\|M_n \\times (I^{-1}M_n)\\|^2$，证实了范数是不减的。\n\n**2. 经典四阶 Runge-Kutta (RK4) 法**\n这是一种标准的高阶方法。单步更新规则为：\n$$\n\\begin{aligned}\nk_1 = f(M_n) \\\\\nk_2 = f(M_n + \\frac{h}{2} k_1) \\\\\nk_3 = f(M_n + \\frac{h}{2} k_2) \\\\\nk_4 = f(M_n + h k_3) \\\\\nM_{n+1} = M_n + \\frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\n虽然对于给定的步长 $h$，RK4 比显式 Euler 法要精确得多，但它也是一种通用积分器，通常不保持卡西米尔不变量 $\\|M\\|^2$。然而，当 $h \\to 0$ 时，不变量的误差预计会小得多，并且会以更快的速度（如 $O(h^4)$ 或类似的高阶幂次）减小。\n\n**3. 实现与漂移计算**\n对每个测试用例，流程如下：\n- 用其初始值 $M_0$ 初始化动量向量 $M$。\n- 计算并存储初始范数 $\\|M_0\\|$。\n- 将最大相对漂移变量 $\\Delta_{max}$ 初始化为 $0$。\n- 迭代 $N = T/h$ 次。在每次迭代 $n$ 中：\n    - 使用 Euler 或 RK4 公式将 $M_n$ 更新为 $M_{n+1}$。\n    - 计算新向量的范数 $\\|M_{n+1}\\|$。\n    - 计算当前相对漂移：$\\delta_n = \\big|\\|M_{n+1}\\| - \\|M_0\\|\\big| / \\|M_0\\|$。\n    - 更新最大值：$\\Delta_{max} = \\max(\\Delta_{max}, \\delta_n)$。\n- 循环完成后，$\\Delta_{max}$ 的最终值就是该测试用例的结果 $\\Delta$。\n\n对问题中定义的所有八个测试用例重复此过程，并收集和格式化结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of numerically integrating the rigid body equations and\n    quantifying the drift in the norm of the angular momentum.\n    \"\"\"\n\n    test_cases = [\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 1e-3, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-3, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-2, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 1e-3, 'method': 'euler'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-3, 'method': 'euler'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-2, 'method': 'euler'},\n        {'I': (1.0, 1.0, 1.0), 'M0': (0.7, 0.0, 0.0), 'T': 5.0, 'h': 1e-1, 'method': 'euler'},\n        {'I': (1.0, 2.0, 3.0), 'M0': (1.0, 0.0, 0.5), 'T': 10.0, 'h': 1e-2, 'method': 'rk4'},\n    ]\n\n    def run_simulation(I_tuple, M0_tuple, T, h, method):\n        \"\"\"\n        Runs a single simulation and returns the maximum relative norm drift.\n\n        Args:\n            I_tuple (tuple): Principal moments of inertia (I1, I2, I3).\n            M0_tuple (tuple): Initial angular momentum (Mx, My, Mz).\n            T (float): Total integration time.\n            h (float): Fixed time step.\n            method (str): Integration method, \"euler\" or \"rk4\".\n\n        Returns:\n            float: The maximum relative norm drift Delta.\n        \"\"\"\n        I = np.array(I_tuple)\n        M0 = np.array(M0_tuple)\n        \n        # Pre-calculate inverse of inertia tensor\n        I_inv = 1.0 / I\n\n        def f(M_vec):\n            \"\"\"The right-hand side of the ODE: dM/dt = M x (I^-1 * M)\"\"\"\n            omega = I_inv * M_vec\n            return np.cross(M_vec, omega)\n\n        # Use rounding to prevent floating-point issues in calculating num_steps\n        num_steps = int(round(T / h))\n        M = np.copy(M0)\n        norm_M0 = np.linalg.norm(M0)\n\n        # If initial momentum is zero, norm is always zero, so drift is zero.\n        if norm_M0 == 0:\n            return 0.0\n\n        max_rel_drift = 0.0\n\n        # Integration loop\n        for _ in range(num_steps):\n            if method == \"euler\":\n                M = M + h * f(M)\n            elif method == \"rk4\":\n                k1 = f(M)\n                k2 = f(M + 0.5 * h * k1)\n                k3 = f(M + 0.5 * h * k2)\n                k4 = f(M + h * k3)\n                M = M + (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n            \n            # Calculate and track the maximum relative drift\n            current_norm = np.linalg.norm(M)\n            rel_drift = abs(current_norm - norm_M0) / norm_M0\n            if rel_drift > max_rel_drift:\n                max_rel_drift = rel_drift\n        \n        return max_rel_drift\n\n    results = []\n    for case in test_cases:\n        delta = run_simulation(case['I'], case['M0'], case['T'], case['h'], case['method'])\n        results.append(delta)\n\n    # Format the final output string as required\n    # \"{:.10g}\" formats a number to 10 significant digits.\n    formatted_results = [f\"{res:.10g}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}