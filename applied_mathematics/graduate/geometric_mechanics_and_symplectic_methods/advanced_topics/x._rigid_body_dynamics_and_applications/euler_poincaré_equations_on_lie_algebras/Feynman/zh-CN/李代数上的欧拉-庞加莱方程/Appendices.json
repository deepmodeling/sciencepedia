{
    "hands_on_practices": [
        {
            "introduction": "这项练习将欧拉-庞加莱框架应用于对称重陀螺这一经典问题。你将从一个包含势能和外力矩的约化拉格朗日量出发，推导出一个半直积李代数上的完整运动方程。这项实践对于理解如何在几何力学形式体系中为具有平流输运量和外力的物理系统建模非常有价值。",
            "id": "3741446",
            "problem": "考虑一个对称重陀螺，其被建模为一个刚体，位形在特殊正交群 $\\mathrm{SO}(3)$ 中，体角速度为 $\\boldsymbol{\\omega} \\in \\mathfrak{so}(3) \\simeq \\mathbb{R}^{3}$，并有一个伴随单位矢量 $\\boldsymbol{\\Gamma} \\in S^{2}$，表示在体坐标系中表达的空间重力方向。该刚体关于体固连标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 的主转动惯量为 $I_{1}=I_{2}\\neq I_{3}$，其对称轴为 $\\mathbf{e}_{3}$。质心沿 $\\mathbf{e}_{3}$ 轴距支点为 $l$，重力加速度为 $g$。一个恒定的转子力矩 $\\boldsymbol{\\tau}=\\tau_{0}\\,\\mathbf{e}_{3}$ 在体坐标系中沿对称轴施加。其约化拉格朗日量为\n$$\n\\ell(\\boldsymbol{\\omega},\\boldsymbol{\\Gamma})=\\tfrac{1}{2}\\,\\boldsymbol{\\omega}\\cdot \\mathbb{I}\\,\\boldsymbol{\\omega}-m g l\\,\\boldsymbol{\\Gamma}\\cdot \\mathbf{e}_{3},\n$$\n其中 $\\mathbb{I}=\\mathrm{diag}(I_{1},I_{1},I_{3})$ 是惯性张量，$m$ 是质量。\n\n从约化拉格朗日量的定义、通过叉积进行的李代数同构 $\\mathfrak{so}(3)\\simeq \\mathbb{R}^{3}$ 以及带伴随参数的哈密顿变分原理出发，推导该带力矩的重陀螺在李代数 $\\mathfrak{so}(3)$ 上的受迫欧拉-庞加莱 (EP) 方程。然后，将稳态进动定义为约化变量下的相对平衡，其中 $\\mathbf{e}_{3}$ 和 $\\boldsymbol{\\Gamma}$ 之间的夹角 $\\theta\\in(0,\\pi)$ 为常数，并要求 $\\dot{\\boldsymbol{\\omega}}=\\mathbf{0}$ 和 $\\dot{\\boldsymbol{\\Gamma}}=\\mathbf{0}$。在这些条件下，计算进动率 $\\Omega$ 的稳态进动关系式，并确定实现非平凡稳态进动（即 $\\sin\\theta\\neq 0$）时 $\\tau_{0}$ 所受的限制。以闭式解的形式给出最终答案，表示为数对 $(\\Omega^{2},\\tau_{0})$。不需要数值计算，也无需四舍五入。角度应以符号形式处理（无需指定单位）。",
            "solution": "首先验证该问题是自洽的、有科学依据且适定的。所有给定的参数和定义都与几何力学和刚体动力学的原理一致。因此，该问题被认定为有效，并按如下方式推导求解。\n\n该系统是一个受体固连力矩作用的对称重陀螺。其位形由约化变量 $(\\boldsymbol{\\omega}, \\boldsymbol{\\Gamma}) \\in \\mathfrak{so}(3) \\times S^2$ 描述，其中 $\\boldsymbol{\\omega}$ 是体坐标系中的角速度，$\\boldsymbol{\\Gamma}$ 是表示空间重力方向的单位矢量，也以体坐标系表达。李代数 $\\mathfrak{so}(3)$ 通过帽子映射与 $\\mathbb{R}^3$ 同构，这使我们可以将 $\\boldsymbol{\\omega}$ 视为一个矢量，并将李括号视为叉积。\n\n约化拉格朗日量由下式给出\n$$\n\\ell(\\boldsymbol{\\omega},\\boldsymbol{\\Gamma})=\\tfrac{1}{2}\\,\\boldsymbol{\\omega}\\cdot \\mathbb{I}\\,\\boldsymbol{\\omega}-m g l\\,\\boldsymbol{\\Gamma}\\cdot \\mathbf{e}_{3}\n$$\n其中 $\\mathbb{I} = \\mathrm{diag}(I_1, I_1, I_3)$ 是惯性张量，$m$ 是质量，$g$ 是重力加速度，$l$ 是从支点到质心沿对称轴 $\\mathbf{e}_3$ 的距离。施加一个恒定力矩 $\\boldsymbol{\\tau}=\\tau_{0}\\,\\mathbf{e}_{3}$。\n\n系统的动力学由带伴随参数的拉格朗日量的受迫欧拉-庞加莱方程决定。这些方程在李代数 $\\mathfrak{g}$ 上的普遍形式为\n$$\n\\frac{d}{dt}\\frac{\\partial \\ell}{\\partial \\boldsymbol{\\omega}} = \\mathrm{ad}_{\\boldsymbol{\\omega}}^* \\frac{\\partial \\ell}{\\partial \\boldsymbol{\\omega}} + \\left(\\frac{\\partial \\ell}{\\partial \\boldsymbol{\\Gamma}}\\right) \\diamond \\boldsymbol{\\Gamma} + \\boldsymbol{\\tau}\n$$\n并与 $\\boldsymbol{\\Gamma}$ 的伴随方程耦合：\n$$\n\\dot{\\boldsymbol{\\Gamma}} = -\\mathrm{ad}_{\\boldsymbol{\\omega}} \\boldsymbol{\\Gamma}\n$$\n对于李代数 $\\mathfrak{so}(3) \\simeq \\mathbb{R}^3$，余伴随作用 $\\mathrm{ad}_{\\boldsymbol{\\omega}}^*$ 由叉积给出：$\\mathrm{ad}_{\\boldsymbol{\\omega}}^* \\boldsymbol{\\mu} = \\boldsymbol{\\mu} \\times \\boldsymbol{\\omega}$。伴随作用为 $\\mathrm{ad}_{\\boldsymbol{\\omega}} \\boldsymbol{\\Gamma} = \\boldsymbol{\\omega} \\times \\boldsymbol{\\Gamma}$。菱形积 $(\\diamond)$ 的定义是，对于余矢量 $\\mathbf{f} = \\partial\\ell/\\partial\\boldsymbol{\\Gamma}$，我们有 $\\mathbf{f} \\diamond \\boldsymbol{\\Gamma} = \\mathbf{f} \\times \\boldsymbol{\\Gamma}$。\n\n首先，我们计算拉格朗日量的偏导数：\n体角动量为 $\\boldsymbol{\\Pi} = \\frac{\\partial \\ell}{\\partial \\boldsymbol{\\omega}} = \\mathbb{I}\\boldsymbol{\\omega}$。\n重力项的导数为 $\\frac{\\partial \\ell}{\\partial \\boldsymbol{\\Gamma}} = -mgl\\,\\mathbf{e}_3$。\n\n将这些代入一般方程，我们得到该系统的具体运动方程：\n1. 欧拉-庞加莱方程：\n$$\n\\frac{d}{dt}(\\mathbb{I}\\boldsymbol{\\omega}) = (\\mathbb{I}\\boldsymbol{\\omega}) \\times \\boldsymbol{\\omega} + (-mgl\\,\\mathbf{e}_3) \\times \\boldsymbol{\\Gamma} + \\tau_0 \\mathbf{e}_3\n$$\n利用叉积的反交换性，上式变为：\n$$\n\\frac{d}{dt}(\\mathbb{I}\\boldsymbol{\\omega}) = (\\mathbb{I}\\boldsymbol{\\omega}) \\times \\boldsymbol{\\omega} + mgl(\\boldsymbol{\\Gamma} \\times \\mathbf{e}_3) + \\tau_0 \\mathbf{e}_3\n$$\n2. $\\boldsymbol{\\Gamma}$ 的伴随方程：\n$$\n\\dot{\\boldsymbol{\\Gamma}} = -(\\boldsymbol{\\omega} \\times \\boldsymbol{\\Gamma}) = \\boldsymbol{\\Gamma} \\times \\boldsymbol{\\omega}\n$$\n这两个方程构成了完整的运动方程组。\n\n接下来，我们分析稳态进动的条件，该条件在问题中定义为相对平衡，此时 $\\dot{\\boldsymbol{\\omega}}=\\mathbf{0}$ 且 $\\dot{\\boldsymbol{\\Gamma}}=\\mathbf{0}$。\n从伴随方程可知，$\\dot{\\boldsymbol{\\Gamma}}=\\mathbf{0}$ 意味着 $\\boldsymbol{\\Gamma} \\times \\boldsymbol{\\omega} = \\mathbf{0}$。由于 $\\boldsymbol{\\Gamma}$ 是单位矢量（因此非零），此条件意味着 $\\boldsymbol{\\omega}$ 必须与 $\\boldsymbol{\\Gamma}$ 平行。因此，我们可以写出 $\\boldsymbol{\\omega} = \\Omega \\boldsymbol{\\Gamma}$，其中标量 $\\Omega$ 代表恒定的进动率。\n\n根据条件 $\\dot{\\boldsymbol{\\omega}}=\\mathbf{0}$，我们有 $\\frac{d}{dt}(\\mathbb{I}\\boldsymbol{\\omega}) = \\mathbb{I}\\dot{\\boldsymbol{\\omega}} = \\mathbf{0}$。欧拉-庞加莱方程简化为一个代数方程：\n$$\n\\mathbf{0} = (\\mathbb{I}\\boldsymbol{\\omega}) \\times \\boldsymbol{\\omega} + mgl(\\boldsymbol{\\Gamma} \\times \\mathbf{e}_3) + \\tau_0 \\mathbf{e}_3\n$$\n代入 $\\boldsymbol{\\omega} = \\Omega \\boldsymbol{\\Gamma}$：\n$$\n\\mathbf{0} = (\\mathbb{I}(\\Omega\\boldsymbol{\\Gamma})) \\times (\\Omega\\boldsymbol{\\Gamma}) + mgl(\\boldsymbol{\\Gamma} \\times \\mathbf{e}_3) + \\tau_0 \\mathbf{e}_3\n$$\n$$\n\\mathbf{0} = \\Omega^2 (\\mathbb{I}\\boldsymbol{\\Gamma}) \\times \\boldsymbol{\\Gamma} + mgl(\\boldsymbol{\\Gamma} \\times \\mathbf{e}_3) + \\tau_0 \\mathbf{e}_3\n$$\n为求解此矢量方程，我们引入一个与体轴 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$ 对齐的坐标系。设 $\\theta$ 为 $\\boldsymbol{\\Gamma}$ 与对称轴 $\\mathbf{e}_3$ 之间的恒定夹角。不失一般性，我们可以调整坐标系使得 $\\boldsymbol{\\Gamma}$ 位于 $\\mathbf{e}_1$-$\\mathbf{e}_3$ 平面内。\n$$\n\\mathbf{e}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad \\boldsymbol{\\Gamma} = \\begin{pmatrix} \\sin\\theta \\\\ 0 \\\\ \\cos\\theta \\end{pmatrix}\n$$\n力矩矢量为 $\\boldsymbol{\\tau} = \\tau_0 \\mathbf{e}_3 = (0, 0, \\tau_0)^T$。\n现在我们计算叉积项。\n$$\n\\mathbb{I}\\boldsymbol{\\Gamma} = \\begin{pmatrix} I_1 & 0 & 0 \\\\ 0 & I_1 & 0 \\\\ 0 & 0 & I_3 \\end{pmatrix} \\begin{pmatrix} \\sin\\theta \\\\ 0 \\\\ \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} I_1\\sin\\theta \\\\ 0 \\\\ I_3\\cos\\theta \\end{pmatrix}\n$$\n$$\n(\\mathbb{I}\\boldsymbol{\\Gamma}) \\times \\boldsymbol{\\Gamma} = \\begin{pmatrix} I_1\\sin\\theta \\\\ 0 \\\\ I_3\\cos\\theta \\end{pmatrix} \\times \\begin{pmatrix} \\sin\\theta \\\\ 0 \\\\ \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ (I_3\\cos\\theta)\\sin\\theta - (I_1\\sin\\theta)\\cos\\theta \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ (I_3 - I_1)\\sin\\theta\\cos\\theta \\\\ 0 \\end{pmatrix}\n$$\n重力矩项：\n$$\n\\boldsymbol{\\Gamma} \\times \\mathbf{e}_3 = \\begin{pmatrix} \\sin\\theta \\\\ 0 \\\\ \\cos\\theta \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\sin\\theta \\\\ 0 \\end{pmatrix}\n$$\n将这些表达式代入代数方程：\n$$\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\Omega^2 \\begin{pmatrix} 0 \\\\ (I_3 - I_1)\\sin\\theta\\cos\\theta \\\\ 0 \\end{pmatrix} + mgl \\begin{pmatrix} 0 \\\\ -\\sin\\theta \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ \\tau_0 \\end{pmatrix}\n$$\n这个矢量方程可以分解为其分量：\n\\begin{itemize}\n    \\item $x$-分量：$0 = 0$，此式成立。\n    \\item $z$-分量：$0 = 0 + 0 + \\tau_0 \\implies \\tau_0 = 0$。这是此类稳态运动对所施加力矩的限制。\n    \\item $y$-分量：$0 = \\Omega^2(I_3-I_1)\\sin\\theta\\cos\\theta - mgl\\sin\\theta$。\n\\end{itemize}\n问题指定了非平凡进动，此时 $\\sin\\theta \\neq 0$（因为 $\\theta \\in (0, \\pi)$）。因此，我们可以将 $y$-分量方程两边同除以 $\\sin\\theta$：\n$$\n0 = \\Omega^2(I_3-I_1)\\cos\\theta - mgl\n$$\n求解 $\\Omega^2$，我们得到稳态进动关系式：\n$$\n\\Omega^2(I_3-I_1)\\cos\\theta = mgl\n$$\n$$\n\\Omega^2 = \\frac{mgl}{(I_3-I_1)\\cos\\theta}\n$$\n此关系式成立的条件是等式右侧为正。对于一个物理陀螺，$m,g,l$ 均为正常数。条件 $\\Omega^2 > 0$ 意味着 $(I_3-I_1)\\cos\\theta > 0$。\n\n最终结果是数对 $(\\Omega^2, \\tau_0)$，即进动率平方的表达式和所施加力矩分量 $\\tau_0$ 的值。",
            "answer": "$$\n\\boxed{(\\Omega^2, \\tau_0) = \\left( \\frac{mgl}{(I_3-I_1)\\cos\\theta}, 0 \\right)}\n$$"
        },
        {
            "introduction": "这个问题通过将欧拉-庞加莱形式体系推广到无限维系统——理想流体，展示了其威力。你将计算矢量场李代数的余伴随作用，这是流体动力学中欧拉方程的基石。这项练习阐明了抽象的李代数概念如何为描述刚体和流体等截然不同的现象提供一个统一的结构。",
            "id": "3741453",
            "problem": "设 $\\Omega \\subset \\mathbb{R}^{n}$ 为一个$n$维环面（具有周期性边界条件）或一个有界光滑域，其边界条件保证所有边界积分在分部积分下为零。考虑光滑向量场的李代数 $\\mathfrak{X}(\\Omega)$，其李括号定义为 $[u,v] = u \\cdot \\nabla v - v \\cdot \\nabla u$，在欧几里得坐标下写作 $[u,v]_{j} = u_{i} \\partial_{i} v_{j} - v_{i} \\partial_{i} u_{j}$，其中重复指标表示求和，且 $\\partial_{i} = \\frac{\\partial}{\\partial x_{i}}$。\n\n为 $\\mathfrak{X}(\\Omega)$ 配备与1-形式密度的配对，其中1-形式密度通过欧几里得度量与向量密度等同：对于光滑的 $m:\\Omega \\to \\mathbbR^{n}$ 和 $v:\\Omega \\to \\mathbb{R}^{n}$，定义\n$$\n\\langle m, v \\rangle = \\int_{\\Omega} m \\cdot v \\, dx = \\int_{\\Omega} m_{j} v_{j} \\, dx .\n$$\n通过以下要求定义余伴随作用 $ad_{u}^{*} m$\n$$\n\\langle ad_{u}^{*} m, v \\rangle = \\langle m, -[u,v] \\rangle\n$$\n该式对所有光滑检验向量场 $v$ 成立。假设 $u$ 是无散度的，即 $\\nabla \\cdot u = \\partial_{i} u_{i} = 0$。\n\n仅从上述定义和基础的多变量微积分（包括乘法法则和分部积分）出发，计算 $ad_{u}^{*} m$ 的欧几里得坐标表达式，并将其表示为紧凑的向量形式。你的最终答案必须是一个以 $u$、$m$ 及其空间导数表示的单一闭式解析表达式。不要引入除所述之外的任何额外假设。不需要进行数值计算。",
            "solution": "问题是在域 $\\Omega \\subset \\mathbb{R}^{n}$ 上，为一个光滑无散度向量场 $u$ 和一个光滑1-形式密度 $m$ 求余伴随作用 $ad_{u}^{*} m$ 的表达式。这个问题是适定的，并且在几何力学领域有其科学基础。我们将使用所提供的定义和标准的多变量微积分运算进行推导。\n\n余伴随作用 $ad_{u}^{*} m$ 由以下关系隐式定义：\n$$\n\\langle ad_{u}^{*} m, v \\rangle = \\langle m, -[u,v] \\rangle\n$$\n此式对 $\\Omega$ 上的所有光滑检验向量场 $v$ 成立。\n\n配对 $\\langle \\cdot, \\cdot \\rangle$ 和李括号 $[u,v]$ 由以下公式给出：\n$$\n\\langle m, v \\rangle = \\int_{\\Omega} m \\cdot v \\, dx = \\int_{\\Omega} m_{j} v_{j} \\, dx\n$$\n$$\n[u,v]_{j} = u_{i} \\partial_{i} v_{j} - v_{i} \\partial_{i} u_{j}\n$$\n其中重复指标意味着求和（爱因斯坦求和约定），且 $\\partial_{i} = \\frac{\\partial}{\\partial x_{i}}$。\n\n我们首先使用指标表示法写出余伴随作用定义的右侧：\n$$\n\\langle m, -[u,v] \\rangle = \\int_{\\Omega} m \\cdot (-[u,v]) \\, dx = - \\int_{\\Omega} m_{j} [u,v]_{j} \\, dx\n$$\n代入李括号的表达式可得：\n$$\n\\langle m, -[u,v] \\rangle = - \\int_{\\Omega} m_{j} (u_{i} \\partial_{i} v_{j} - v_{i} \\partial_{i} u_{j}) \\, dx = \\int_{\\Omega} (m_{j} v_{i} \\partial_{i} u_{j} - m_{j} u_{i} \\partial_{i} v_{j}) \\, dx\n$$\n我们的目标是将此表达式变换成 $\\int_{\\Omega} (\\text{expression})_{j} v_{j} \\, dx$ 的形式。然后 $(\\text{expression})_{j}$ 项就可以被确定为 $(ad_{u}^{*} m)_{j}$。目前该积分由两项组成。第一项 $\\int_{\\Omega} m_{j} v_{i} \\partial_{i} u_{j} \\, dx$ 已包含未微分的 $v$。第二项 $\\int_{\\Omega} -m_{j} u_{i} \\partial_{i} v_{j} \\, dx$ 中有一个作用于 $v_j$ 的导数。我们必须使用分部积分将这个导数从 $v_j$ 上移走。\n\n我们关注被积函数的第二项 $-m_{j} u_{i} \\partial_{i} v_{j}$。我们将此项在 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} (-m_{j} u_{i}) (\\partial_{i} v_{j}) \\, dx\n$$\n使用多维分部积分法，该方法源于散度定理（对于任意向量场 $F$ 和标量场 $\\phi$，有 $\\int_{\\Omega} F \\cdot \\nabla \\phi \\, dx = \\oint_{\\partial \\Omega} \\phi (F \\cdot \\hat{n}) \\, dS - \\int_{\\Omega} \\phi (\\nabla \\cdot F) \\, dx$），我们可以移动导数。让我们固定指标 $j$ 并考虑关于 $i$ 的求和。设向量场为 $F_{i} = -m_{j}u_{i}$，标量场为 $\\phi = v_{j}$。\n$$\n\\int_{\\Omega} \\sum_{i=1}^{n} (-m_{j} u_{i}) \\partial_{i} v_{j} \\, dx = \\oint_{\\partial \\Omega} v_{j}(-m_{j} u \\cdot \\hat{n}) \\, dS - \\int_{\\Omega} v_{j} \\sum_{i=1}^{n} \\partial_{i}(-m_{j} u_{i}) \\, dx\n$$\n问题陈述指明，边界条件使得所有边界积分在分部积分下为零。因此，边界积分为零。我们得到：\n$$\n\\int_{\\Omega} (-m_{j} u_{i} \\partial_{i} v_{j}) \\, dx = \\int_{\\Omega} v_{j} \\partial_{i}(m_{j} u_{i}) \\, dx\n$$\n现在，将此结果代回到 $\\langle m, -[u,v] \\rangle$ 的表达式中：\n$$\n\\langle m, -[u,v] \\rangle = \\int_{\\Omega} m_{j} v_{i} \\partial_{i} u_{j} \\, dx + \\int_{\\Omega} v_{j} \\partial_{i}(m_{j} u_{i}) \\, dx\n$$\n为了合并这些项，我们必须确保检验向量场 $v$ 的指标相同。在第一项中，我们有 $v_i$。我们可以重命名求和指标。我们将 $i$ 重命名为 $k$。在第二项中，我们有 $v_j$。我们将 $j$ 重命名为 $k$。对哑指标的求和与所使用的字母无关。\n第一个积分变为： $\\int_{\\Omega} m_{j} v_{k} \\partial_{k} u_{j} \\, dx = \\int_{\\Omega} (m_{j} \\partial_{k} u_{j}) v_{k} \\, dx$。\n第二个积分变为： $\\int_{\\Omega} v_{k} \\partial_{i}(m_{k} u_{i}) \\, dx = \\int_{\\Omega} (\\partial_{i}(m_{k} u_{i})) v_{k} \\, dx$。\n将它们合并，我们得到：\n$$\n\\langle m, -[u,v] \\rangle = \\int_{\\Omega} \\left( m_{j} \\partial_{k} u_{j} + \\partial_{i}(m_{k} u_{i}) \\right) v_{k} \\, dx\n$$\n我们起始定义的左侧是 $\\langle ad_{u}^{*} m, v \\rangle = \\int_{\\Omega} (ad_{u}^{*} m)_{k} v_{k} \\, dx$。通过比较被积函数（因为等式必须对所有光滑的 $v$ 成立），我们确定 $ad_{u}^{*} m$ 的第 $k$ 个分量为：\n$$\n(ad_{u}^{*} m)_{k} = m_{j} \\partial_{k} u_{j} + \\partial_{i}(m_{k} u_{i})\n$$\n我们可以使用导数的乘法法则展开第二项： $\\partial_{i}(m_{k} u_{i}) = (\\partial_{i} m_{k}) u_{i} + m_{k} (\\partial_{i} u_{i})$。\n$$\n(ad_{u}^{*} m)_{k} = m_{j} \\partial_{k} u_{j} + u_{i} \\partial_{i} m_{k} + m_{k} (\\partial_{i} u_{i})\n$$\n此时，我们使用给定的条件即 $u$ 是无散度的：$\\nabla \\cdot u = \\partial_{i} u_{i} = 0$。这使得第三项为零：\n$$\nm_{k} (\\partial_{i} u_{i}) = m_{k} (0) = 0\n$$\n$ad_{u}^{*} m$ 的分量表达式化简为：\n$$\n(ad_{u}^{*} m)_{k} = m_{j} \\partial_{k} u_{j} + u_{i} \\partial_{i} m_{k}\n$$\n最后一步是将其表示为紧凑的向量形式。\n第二项 $u_{i} \\partial_{i} m_{k}$ 是 $m$ 关于 $u$ 的对流导数的第 $k$ 个分量，写作 $(u \\cdot \\nabla)m$。\n第一项 $m_{j} \\partial_{k} u_{j}$ 需要仔细解释。设 $\\nabla u$ 为 $u$ 各分量梯度的张量（或矩阵），其元素为 $(\\nabla u)_{ji} = \\partial_{i} u_{j}$。其转置 $(\\nabla u)^{T}$ 的元素为 $((\\nabla u)^{T})_{ij} = (\\nabla u)_{ji} = \\partial_{i} u_{j}$。现在考虑这个转置矩阵作用于向量 $m$。所得向量 $(\\nabla u)^{T} m$ 的第 $k$ 个分量是：\n$$\n((\\nabla u)^{T} m)_{k} = \\sum_{j} ((\\nabla u)^{T})_{kj} m_{j} = \\sum_{j} (\\partial_{k} u_{j}) m_{j} = m_{j} \\partial_{k} u_{j}\n$$\n这与我们得到的 $(ad_{u}^{*} m)_{k}$ 表达式中的第一项相匹配。\n\n因此，将这两项以向量形式合并，我们得到了余伴随作用的最终表达式：\n$$\nad_{u}^{*} m = (u \\cdot \\nabla)m + (\\nabla u)^{T} m\n$$",
            "answer": "$$\n\\boxed{ (u \\cdot \\nabla)m + (\\nabla u)^{T} m }\n$$"
        },
        {
            "introduction": "虽然推导连续运动方程是关键的第一步，但求解这些方程通常需要数值方法。这项实践通过比较一个保持结构的变分积分器与一个标准的非变分方法，深入探讨了几何积分领域。你将从理论上论证为何几何方法能保持一个关键的不变量（卡西米尔不变量），然后通过计算证明标准方法如何失效，从而让你深刻理解为长期模拟选择正确算法的重要性。",
            "id": "3738931",
            "problem": "考虑特殊正交群 $SO(3)$ 上的自由刚体，其右平凡化角速度为 $\\omega \\in \\mathbb{R}^{3} \\cong \\mathfrak{so}(3)$，约化拉格朗日量为 $l(\\omega) = \\tfrac{1}{2} \\omega^{\\top} \\mathbb{I} \\,\\omega$，体角动量为 $M = \\mathbb{I} \\,\\omega \\in \\mathbb{R}^{3} \\cong \\mathfrak{so}(3)^{*}$，其中惯性张量为 $\\mathbb{I} = \\mathrm{diag}(2,3,4)$。在 $\\mathfrak{so}(3)^{*}$ 上的连续欧拉-庞加莱（EP）动力学为 $\\dot{M} = M \\times \\omega$，其中 $\\omega = \\mathbb{I}^{-1} M$。该动力学保持由二次卡西米尔不变量 $C(M) = |M|^{2}$ 表征的协伴轨道不变。该系统的一个李群变分积分器由一个具有右不变离散拉格朗日量 $L_{d}: SO(3) \\times SO(3) \\to \\mathbb{R}$ 的离散变分原理得到；离散欧拉-庞加莱方程和离散诺特定理意味着离散更新通过协伴作用来推进 $M$，并在离散层面上保持 $C(M)$ 不变。\n\n现在，将此与对偶李代数上的以下非变分李群方法进行对比：对于固定的时间步长 $h > 0$，显式代数欧拉步为\n$$\nM_{k+1} = M_{k} + h \\,\\Phi(M_{k}), \\quad \\text{其中} \\quad \\Phi(M) = M \\times \\omega, \\quad \\omega = \\mathbb{I}^{-1} M,\n$$\n\n仅使用基本定义和李群的离散变分原理（而非任何预先给出的离散 EP 更新公式），首先论证为何右不变离散拉格朗日量产生的离散更新能够保持二次卡西米尔不变量 $C(M) = |M|^{2}$，从而保持 $SO(3)$ 中的协伴轨道。然后，通过计算在上述显式代数欧拉方法下，对于初始条件\n$$\nM_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\qquad \\mathbb{I} = \\mathrm{diag}(2,3,4),\n$$\n二次卡西米尔不变量的单步变化，显式地构造一个反例，以表明非变分方法无法保持协伴轨道。您的答案应该是单步卡西米尔不变量变化\n$$\n\\Delta C = |M_{1}|^{2} - |M_{0}|^{2}\n$$\n关于 $h$ 的精确解析表达式。不需要进行数值舍入，最终答案中不包含任何单位。",
            "solution": "该问题提出了两个任务：第一，为源自右不变离散拉格朗日量的变分积分器为何能保持自由刚体的二次卡西米尔不变量提供理论论证；第二，为一个特定的非变分数值方法计算此卡西米尔不变量的单步变化。\n\n问题陈述的验证如下：\n- **步骤1：提取的已知条件：**\n  - 系统：$SO(3)$ 上的自由刚体。\n  - 右平凡化角速度：$\\omega \\in \\mathbb{R}^{3} \\cong \\mathfrak{so}(3)$。\n  - 约化拉格朗日量：$l(\\omega) = \\tfrac{1}{2} \\omega^{\\top} \\mathbb{I} \\,\\omega$。\n  - 惯性张量：$\\mathbb{I} = \\mathrm{diag}(2,3,4)$。\n  - 体角动量：$M = \\mathbb{I} \\,\\omega \\in \\mathbb{R}^{3} \\cong \\mathfrak{so}(3)^{*}$。\n  - 连续欧拉-庞加莱动力学：$\\dot{M} = M \\times \\omega$，其中 $\\omega = \\mathbb{I}^{-1} M$。\n  - 守恒量：二次卡西米尔不变量 $C(M) = |M|^{2}$。\n  - 变分积分器：源自右不变离散拉格朗日量 $L_{d}: SO(3) \\times SO(3) \\to \\mathbb{R}$。\n  - 非变分方法：显式代数欧拉步 $M_{k+1} = M_{k} + h \\,\\Phi(M_{k})$，其中 $\\Phi(M) = M \\times \\omega$ 且 $\\omega = \\mathbb{I}^{-1} M$。\n  - 初始条件：$M_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n  - 要求计算：非变分方法的 $\\Delta C = |M_{1}|^{2} - |M_{0}|^{2}$。\n\n- **步骤2：验证：** 该问题在几何力学和李群上数值积分的既有理论框架内具有科学依据。它是一个适定、客观且自洽的问题，为理论论证和具体计算提供了所有必要的定义和数据。不存在内部矛盾、歧义或事实性错误。\n\n- **步骤3：结论：** 该问题有效。\n\n我们开始解答，依次处理问题的两个部分。\n\n**第一部分：变分积分器保持卡西米尔不变量的论证**\n\n论证的核心在于将离散版本的诺特定理应用于具有右对称性的系统。二次卡西米尔不变量 $C(M) = |M|^2$ 的守恒是离散动量更新是一个协伴作用这一事实的直接结果。\n\n1.  **对称性与离散诺特定理：** 问题假设存在一个右不变的离散拉格朗日量 $L_d: SO(3) \\times SO(3) \\to \\mathbb{R}$。这意味着它在群自身的右对角作用下是不变的，即对于任意恒定的旋转 $H \\in SO(3)$，都有 $L_d(g_k H, g_{k+1} H) = L_d(g_k, g_{k+1})$。根据李群的离散诺特定理，这种对称性意味着沿着由离散欧拉-拉格朗日方程定义的离散轨迹存在一个守恒量。这个守恒量是空间角动量，记为 $\\mu \\in \\mathfrak{so}(3)^*$。\n\n2.  **体动量与空间动量：** 对于刚体，区分体角动量 $M$（在附着于物体的坐标系中测量）和空间角动量 $\\mu$（在固定的实验室坐标系中测量）至关重要。这两个量通过代表刚体位形的群元素 $g \\in SO(3)$ 的伴随作用联系起来。其关系为 $M_k = \\text{Ad}^*_{g_k^{-1}} \\mu_k$。逆关系为 $\\mu_k = \\text{Ad}^*_{g_k} M_k$。对于像 $SO(3)$ 这样的矩阵李群，对 $M \\in \\mathbb{R}^3 \\cong \\mathfrak{so}(3)^*$ 的协伴作用 $\\text{Ad}^*_g M$ 由旋转矩阵本身的作用给出：$\\text{Ad}^*_g M = g M$。因此，$M_k = g_k^{-1} \\mu_k$。\n\n3.  **离散动量更新：** 由诺特定理确立的空间动量守恒意味着对于所有步数 $k$，都有 $\\mu_{k+1} = \\mu_k$。我们现在可以推导出体动量 $M_k$ 的更新规则。\n    $$\n    M_{k+1} = \\text{Ad}^*_{g_{k+1}^{-1}} \\mu_{k+1}\n    $$\n    因为 $\\mu_{k+1} = \\mu_k$，我们有\n    $$\n    M_{k+1} = \\text{Ad}^*_{g_{k+1}^{-1}} \\mu_k\n    $$\n    代入 $\\mu_k = \\text{Ad}^*_{g_k} M_k$，我们得到\n    $$\n    M_{k+1} = \\text{Ad}^*_{g_{k+1}^{-1}} (\\text{Ad}^*_{g_k} M_k) = \\text{Ad}^*_{g_k g_{k+1}^{-1}} M_k\n    $$\n    该方程表明，体动量 $M_{k+1}$ 是通过相对旋转 $g_k g_{k+1}^{-1}$ 的协伴作用从 $M_k$ 获得的。\n\n4.  **卡西米尔不变量的守恒：** 根据定义，卡西米尔函数是李代数对偶上的一个函数，它在协伴作用下是不变的。也就是说，对于所有 $g \\in SO(3)$ 和 $M \\in \\mathfrak{so}(3)^*$，都有 $C(\\text{Ad}^*_g M) = C(M)$。对于 $SO(3)$，二次卡西米尔不变量是 $C(M) = |M|^2 = M^\\top M$。对于 $g \\in SO(3)$，协伴作用 $\\text{Ad}^*_g M = gM$ 是一个正交变换。因此，其不变性是显而易见的：\n    $$\n    C(gM) = |gM|^2 = (gM)^\\top(gM) = M^\\top g^\\top g M = M^\\top I M = M^\\top M = |M|^2 = C(M)\n    $$\n    将此不变性应用于离散动量更新，我们发现\n    $$\n    C(M_{k+1}) = C(\\text{Ad}^*_{g_k g_{k+1}^{-1}} M_k) = C(M_k)\n    $$\n    这等价于 $|M_{k+1}|^2 = |M_k|^2$。这就完成了论证：基于右不变离散拉格朗日量的变分积分器在每一步都精确地保持二次卡西米尔不变量，因为底层的动量映射是通过协伴作用演化的。\n\n**第二部分：非变分方法的反例**\n\n我们现在分析非变分显式代数欧拉方法，并计算卡西米尔不变量的单步变化。\n\n更新规则由下式给出\n$$\nM_{k+1} = M_{k} + h (M_{k} \\times \\omega_{k})\n$$\n其中 $\\omega_k = \\mathbb{I}^{-1} M_k$。我们需要计算从 $k=0$ 开始单步的 $\\Delta C = |M_1|^2 - |M_0|^2$。\n\n1.  **初始条件：** 给定的初始动量和惯性张量为：\n    $$\n    M_0 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\qquad \\mathbb{I} = \\mathrm{diag}(2,3,4)\n    $$\n    惯性张量的逆为\n    $$\n    \\mathbb{I}^{-1} = \\mathrm{diag}\\left(\\frac{1}{2}, \\frac{1}{3}, \\frac{1}{4}\\right)\n    $$\n\n2.  **计算 $\\omega_0$：**\n    $$\n    \\omega_0 = \\mathbb{I}^{-1} M_0 = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{1}{3} & 0 \\\\ 0 & 0 & \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{3} \\\\ 0 \\end{pmatrix}\n    $$\n\n3.  **计算叉积项：** 这对应于向量场 $\\Phi(M_0) = \\dot{M}|_{M_0}$。\n    $$\n    M_0 \\times \\omega_0 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\times \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{3} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (1)(0) - (0)(\\frac{1}{3}) \\\\ (0)(\\frac{1}{2}) - (1)(0) \\\\ (1)(\\frac{1}{3}) - (1)(\\frac{1}{2}) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{2}{6} - \\frac{3}{6} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -\\frac{1}{6} \\end{pmatrix}\n    $$\n\n4.  **计算 $M_1$：**\n    $$\n    M_1 = M_0 + h (M_0 \\times \\omega_0) = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} + h \\begin{pmatrix} 0 \\\\ 0 \\\\ -\\frac{1}{6} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ -\\frac{h}{6} \\end{pmatrix}\n    $$\n\n5.  **计算卡西米尔不变量及其变化 $\\Delta C$：**\n    初始卡西米尔值为：\n    $$\n    |M_0|^2 = 1^2 + 1^2 + 0^2 = 1 + 1 + 0 = 2\n    $$\n    一步后的卡西米尔值为：\n    $$\n    |M_1|^2 = 1^2 + 1^2 + \\left(-\\frac{h}{6}\\right)^2 = 1 + 1 + \\frac{h^2}{36} = 2 + \\frac{h^2}{36}\n    $$\n    因此，卡西米尔不变量的单步变化为：\n    $$\n    \\Delta C = |M_1|^2 - |M_0|^2 = \\left(2 + \\frac{h^2}{36}\\right) - 2 = \\frac{h^2}{36}\n    $$\n由于时间步长 $h > 0$，变化量 $\\Delta C = \\frac{h^2}{36}$ 是严格为正的。这明确表明，非变分显式代数欧拉方法未能保持协伴轨道，因为它人为地增加了二次卡西米尔不变量的值。这是非几何积分器应用于非欧几里得相空间上的哈密顿系统时的典型行为。",
            "answer": "$$\\boxed{\\frac{h^2}{36}}$$"
        }
    ]
}