{
    "hands_on_practices": [
        {
            "introduction": "在应用任何物理理论时，一个关键的步骤是将其抽象的、无坐标的公式转化为具体的、可用的坐标形式。本练习侧重于垂直拉格朗日-庞加莱（LP）方程，该方程控制着约化动量的演化。通过这个练习，你将亲手推导出该方程的坐标形式，并清晰地看到李代数结构常数和联络1-形式是如何在动力学中显式出现的 。",
            "id": "3751262",
            "problem": "考虑一个主丛 $\\pi: Q \\to M$，其结构群为 $G$，李代数为 $\\mathfrak{g}$，并选取了 $\\mathfrak{g}$ 的一组基 $\\{e_{a}\\}$，其结构常数 $c^{c}_{ab}$ 由 $[e_{a}, e_{b}] = c^{c}_{ab} e_{c}$ 定义。设 $\\mathcal{A}$ 是 $Q$ 上的一个主联络，在 $M$ 上的一个局部平凡化中，其局部联络1-形式系数为 $A_{i}^{a}(x)$，因此沿着 $M$ 中的一条曲线 $x(t)$，有 $\\mathcal{A}(\\dot{x}) = A_{i}^{a}(x) \\dot{x}^{i} e_{a}$。设 $\\mu(t) \\in \\mathfrak{g}^{*}$ 为一个约化动量，其在对偶基中的分量为 $\\mu_{a}(t)$；并设 $\\sigma(t) \\in \\mathfrak{g}$ 为对流速度，其在给定基中的分量为 $\\sigma^{a}(t)$。\n\n从以下基本定义出发：\n- 由相伴的余伴随丛上的联络诱导的 $\\mu(t)$ 的协变时间导数为 $D\\mu/Dt = \\dot{\\mu} + \\operatorname{ad}^{*}_{\\mathcal{A}(\\dot{x})}\\mu$。\n- 余伴随作用 $\\operatorname{ad}^{*}_{\\xi} \\mu$ 通过配对 $\\langle \\operatorname{ad}^{*}_{\\xi} \\mu, \\eta \\rangle = \\langle \\mu, [\\eta, \\xi] \\rangle$ 对所有 $\\eta \\in \\mathfrak{g}$ 定义。\n\n推导垂直拉格朗日-庞加莱（LP）方程的坐标形式（其抽象形式为 $D\\mu/Dt - \\operatorname{ad}^{*}_{\\sigma} \\mu = 0$），并得到 $\\dot{\\mu}_{a}$ 关于 $c^{c}_{ab}$、$A_{i}^{b}(x)$、$\\dot{x}^{i}$、$\\sigma^{b}$ 和 $\\mu_{c}$ 的显式表达式。你的最终答案必须是 $\\dot{\\mu}_{a}$ 的一个单一闭式解析表达式，无单位且无近似。",
            "solution": "本题要求从垂直拉格朗日-庞加莱（LP）方程的抽象定义和其他给定的几何力学基本关系出发，推导其坐标形式。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n- 一个主丛 $\\pi: Q \\to M$，其结构群为 $G$。\n- $G$ 的李代数是 $\\mathfrak{g}$，其一组基为 $\\{e_{a}\\}$，结构常数 $c^{c}_{ab}$ 由李括号关系 $[e_{a}, e_{b}] = c^{c}_{ab} e_{c}$ 定义。这里暗含对重复指标 $c$ 的爱因斯坦求和约定。\n- $Q$ 上的一个主联络 $\\mathcal{A}$。在 $M$ 的一个局部平凡化中，其局部1-形式系数为 $A_{i}^{a}(x)$。该联络作用于沿曲线 $x(t) \\subset M$ 的速度矢量 $\\dot{x}(t)$ 上，表示为 $\\mathcal{A}(\\dot{x}) = A_{i}^{a}(x) \\dot{x}^{i} e_{a}$。该表达式存在自由指标冲突，因为 $a$ 出现了两次。科学上的标准解释是，这代表李代数中的一个元素 $\\mathcal{A}(\\dot{x}) = (A_{i}^{b}(x)\\dot{x}^{i})e_{b}$，其中对 $i$ 和 $b$ 都暗含求和。我们将采纳此解释。\n- 一个约化动量 $\\mu(t) \\in \\mathfrak{g}^{*}$，其在对偶基 $\\{e^{a}\\}$ 中的分量为 $\\mu_{a}(t)$，使得 $\\mu(t) = \\mu_{a}(t) e^{a}$。\n- 一个对流速度 $\\sigma(t) \\in \\mathfrak{g}$，其在基 $\\{e_{a}\\}$ 中的分量为 $\\sigma^{a}(t)$，使得 $\\sigma(t) = \\sigma^{a}(t) e_{a}$。\n- $\\mu$ 的协变时间导数定义为 $D\\mu/Dt = \\dot{\\mu} + \\operatorname{ad}^{*}_{\\mathcal{A}(\\dot{x})}\\mu$。\n- 对于 $\\xi \\in \\mathfrak{g}$ 和 $\\mu \\in \\mathfrak{g}^{*}$，余伴随作用 $\\operatorname{ad}^{*}_{\\xi} \\mu$ 通过配对 $\\langle \\operatorname{ad}^{*}_{\\xi} \\mu, \\eta \\rangle = \\langle \\mu, [\\eta, \\xi] \\rangle$ 对所有 $\\eta \\in \\mathfrak{g}$ 定义。\n- 抽象的垂直拉格朗日-庞加莱（LP）方程为 $D\\mu/Dt - \\operatorname{ad}^{*}_{\\sigma} \\mu = 0$。\n\n**1.2. 验证：**\n- **科学基础：** 该问题牢固地植根于几何力学和约化理论已建立的数学框架。所有概念和定义都是标准且正确的。\n- **良定性：** 任务是从一组给定的定义出发，进行特定的数学推导，以获得一个坐标表达式。这是一个具有唯一解的良定问题。\n- **客观性：** 问题陈述使用了精确、无歧义的数学语言。\n- **完整性与一致性：** 问题提供了推导所需的所有必要信息。在 $\\mathcal{A}(\\dot{x})$ 的定义中存在的微小记法模糊，可以很容易地通过上下文，根据该领域的标准表述来解决，并不构成根本性缺陷。\n\n**1.3. 结论：**\n该问题有效，且可按所述求解。\n\n### 步骤 2：坐标形式方程的推导\n\n目标是找到约化动量 $\\mu$ 的第 $a$ 个分量的时间导数 $\\dot{\\mu}_{a}$ 的显式表达式。我们从给定的垂直拉格朗日-庞加莱方程的抽象形式开始：\n$$\n\\frac{D\\mu}{Dt} - \\operatorname{ad}^{*}_{\\sigma} \\mu = 0\n$$\n将协变时间导数 $D\\mu/Dt$ 的定义代入此方程，得到：\n$$\n\\left(\\dot{\\mu} + \\operatorname{ad}^{*}_{\\mathcal{A}(\\dot{x})}\\mu\\right) - \\operatorname{ad}^{*}_{\\sigma} \\mu = 0\n$$\n我们重排此方程以求解 $\\dot{\\mu}$：\n$$\n\\dot{\\mu} = \\operatorname{ad}^{*}_{\\sigma} \\mu - \\operatorname{ad}^{*}_{\\mathcal{A}(\\dot{x})}\\mu\n$$\n利用余伴随表示映射 $\\xi \\mapsto \\operatorname{ad}^{*}_{\\xi}$ 的线性性，我们可以合并右侧的项：\n$$\n\\dot{\\mu} = \\operatorname{ad}^{*}_{\\sigma - \\mathcal{A}(\\dot{x})} \\mu\n$$\n为了找到余矢量 $\\dot{\\mu} = \\dot{\\mu}_{a} e^{a}$ 的分量 $\\dot{\\mu}_{a}$，我们计算 $\\dot{\\mu}$ 与基矢量 $e_{a} \\in \\mathfrak{g}$ 的配对。分量由 $\\dot{\\mu}_{a} = \\langle \\dot{\\mu}, e_{a} \\rangle$ 给出。\n$$\n\\dot{\\mu}_{a} = \\langle \\operatorname{ad}^{*}_{\\sigma - \\mathcal{A}(\\dot{x})} \\mu, e_{a} \\rangle\n$$\n现在，我们应用余伴随作用的定义 $\\langle \\operatorname{ad}^{*}_{\\xi} \\mu, \\eta \\rangle = \\langle \\mu, [\\eta, \\xi] \\rangle$，其中 $\\xi = \\sigma - \\mathcal{A}(\\dot{x})$ 且 $\\eta = e_{a}$：\n$$\n\\dot{\\mu}_{a} = \\langle \\mu, [e_{a}, \\sigma - \\mathcal{A}(\\dot{x})] \\rangle\n$$\n接下来，我们将所有量用其坐标表示来表达。\n李代数元素 $\\sigma - \\mathcal{A}(\\dot{x})$ 在基 $\\{e_b\\}$ 下的表达式为：\n$$\n\\sigma - \\mathcal{A}(\\dot{x}) = \\sigma^{b} e_{b} - (A_{i}^{b}(x) \\dot{x}^{i}) e_{b} = (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}) e_{b}\n$$\n这里，对指标 $b$ 和 $i$ 暗含求和。我们现在利用李括号的双线性性质和给定的结构常数 $[e_{a}, e_{b}] = c^{c}_{ab} e_{c}$ 来计算李括号 $[e_{a}, \\sigma - \\mathcal{A}(\\dot{x})]$：\n$$\n[e_{a}, \\sigma - \\mathcal{A}(\\dot{x})] = [e_{a}, (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}) e_{b}] = (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}) [e_{a}, e_{b}] = (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}) c^{c}_{ab} e_{c}\n$$\n这里，对指标 $b$、$c$ 和 $i$ 暗含求和。\n现在我们将此结果代回 $\\dot{\\mu}_{a}$ 的表达式中。约化动量为 $\\mu = \\mu_{c} e^{c}$。为避免指标冲突，我们写成 $\\mu = \\mu_{d} e^{d}$，其中 $d$ 是一个哑求和指标。\n$$\n\\dot{\\mu}_{a} = \\langle \\mu_{d} e^{d}, (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}) c^{c}_{ab} e_{c} \\rangle\n$$\n利用配对 $\\langle \\cdot, \\cdot \\rangle$ 的线性性，我们可以将标量系数因子提出：\n$$\n\\dot{\\mu}_{a} = \\mu_{d} (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}) c^{c}_{ab} \\langle e^{d}, e_{c} \\rangle\n$$\n对偶基矢量 $e^d$ 和基矢量 $e_c$ 的配对由克罗内克δ给出，即 $\\langle e^{d}, e_{c} \\rangle = \\delta^{d}_{c}$。代入此式可得：\n$$\n\\dot{\\mu}_{a} = \\mu_{d} (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}) c^{c}_{ab} \\delta^{d}_{c}\n$$\n最后，对指标 $d$ 求和会将 $\\mu_{d}$ 与 $\\delta^{d}_{c}$ 进行缩并，这会将指标 $d$ 替换为 $c$：\n$$\n\\dot{\\mu}_{a} = \\mu_{c} (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}) c^{c}_{ab}\n$$\n习惯上将结构常数写在前面。重新排列各项，我们得到 $\\dot{\\mu}_{a}$ 的最终显式表达式，其中对重复的上下指标（$b$、$c$ 和 $i$）暗含求和：\n$$\n\\dot{\\mu}_{a} = c^{c}_{ab} \\mu_{c} (\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i})\n$$\n这就是垂直拉格朗日-庞加莱方程的坐标形式。",
            "answer": "$$\n\\boxed{c^{c}_{ab} \\mu_{c} \\left(\\sigma^{b} - A_{i}^{b}(x) \\dot{x}^{i}\\right)}\n$$"
        },
        {
            "introduction": "约化理论最深刻的洞见之一，是主丛的几何结构（特别是机械联络的曲率）如何在约化系统中体现为等效力。本练习将探讨这一现象，在一个阿贝尔群的设定下揭示其与电磁学中洛伦兹力的深刻类比 。你将通过计算证明，这种由曲率诱导的力是回转力（gyroscopic force），它本身不做功，这是这类力的一个标志性特征。",
            "id": "3751212",
            "problem": "考虑一个主丛 $\\pi: Q \\to S$，其结构李群为 $G$，其中假设 $G$ 是阿贝尔且连通的。设 $Q$ 上有一个简单机械类型的 $G$-不变黎曼度量，并设 $\\mathcal{A} \\in \\Omega^{1}(Q; \\mathfrak{g})$ 为相应的机械联络，其在形状空间 $S$ 上的曲率二阶形式由 $\\widetilde{\\mathcal{B}} \\in \\Omega^{2}(S; \\mathfrak{g})$ 给出。假设 $S$ 上的约化形状度量为 $g_{S}$，且势仅依赖于形状，$V: S \\to \\mathbb{R}$。用 $\\mu \\in \\mathfrak{g}^{\\ast}$ 表示沿群方向的固定守恒动量。$S$ 上的约化动力学由一个形式如下的约化拉格朗日量描述\n$$\n\\ell(s,\\dot{s}) \\;=\\; \\frac{1}{2}\\, g_{S}(\\dot{s},\\dot{s}) \\;+\\; \\langle \\mu, \\alpha_{s}(\\dot{s}) \\rangle \\;-\\; V(s),\n$$\n其中 $\\alpha \\in \\Omega^{1}(S; \\mathfrak{g})$ 是一个满足 $d\\alpha = \\widetilde{\\mathcal{B}}$ 的局域规范势。\n\n从哈密顿原理和变分法的基本原理出发，推导 $S$ 上的约化欧拉-拉格朗日方程，并分离出由非零曲率 $\\widetilde{\\mathcal{B}}$ 诱导作用于形状动力学上的等效力。解释该曲率诱导力在何种意义上是陀螺力，并因此类似于磁力。\n\n然后，使用机械功是功率的时间积分这一定义，计算曲率诱导力沿任意足够光滑的曲线 $s: [t_{0}, t_{1}] \\to S$ 所做的功，即\n$$\nW_{\\mathrm{curv}}[s] \\;:=\\; \\int_{t_{0}}^{t_{1}} g_{S}\\!\\left(F_{\\mathrm{curv}}(s(t),\\dot{s}(t)),\\, \\dot{s}(t)\\right)\\, dt,\n$$\n用形状度量 $g_{S}$、动量 $\\mu$ 和曲率 $\\widetilde{\\mathcal{B}}$ 来表示。请以单一闭式解析表达式的形式提供最终答案。不需要数值近似或四舍五入，最终答案中也不应报告单位。",
            "solution": "所述问题是有效的。这是一个关于拉格朗日约化的几何力学中的适定问题，它具有科学依据，是客观的，并包含进行严格推导所需的所有必要信息。\n\n我们的任务是为给定的拉格朗日量推导约化欧拉-拉格朗日方程，然后计算曲率诱导力所做的功。\n\n形状空间 $S$ 上的约化拉格朗日量由下式给出\n$$\n\\ell(s, \\dot{s}) = \\frac{1}{2} g_{S}(\\dot{s}, \\dot{s}) + \\langle \\mu, \\alpha_{s}(\\dot{s}) \\rangle - V(s)\n$$\n其中 $s \\in S$，$\\dot{s} \\in T_s S$，$g_S$ 是 $S$ 上的约化度量，$V: S \\to \\mathbb{R}$ 是一个势，$\\mu \\in \\mathfrak{g}^{\\ast}$ 是一个常数动量，$\\alpha \\in \\Omega^{1}(S; \\mathfrak{g})$ 是一个局域联络 1-形式，其外微分是曲率 $d\\alpha = \\widetilde{\\mathcal{B}} \\in \\Omega^2(S; \\mathfrak{g})$。\n\n运动方程由哈密顿原理得出，该原理指出作用量积分 $\\mathcal{S}[s] = \\int_{t_0}^{t_1} \\ell(s(t), \\dot{s}(t)) dt$ 的变分对于任何在端点处为零的路径 $s(t)$ 的变分 $\\delta s$（即 $\\delta s(t_0) = \\delta s(t_1) = 0$）为零。在局域坐标 $\\{s^i\\}$ 下，欧拉-拉格朗日方程具有以下形式：\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial \\ell}{\\partial \\dot{s}^k}\\right) - \\frac{\\partial \\ell}{\\partial s^k} = 0\n$$\n\n让我们计算必要的偏导数。\n拉格朗日量在局域坐标下为：\n$$\n\\ell = \\frac{1}{2} g_{ij}(s) \\dot{s}^i \\dot{s}^j + \\langle \\mu, (\\alpha_j)_a(s) \\dot{s}^j \\rangle - V(s)\n$$\n其中我们已将 $\\langle \\mu, \\alpha_s(\\dot{s}) \\rangle$ 在 $\\mathfrak{g}$ 和 $\\mathfrak{g}^*$ 的一组基下写作 $\\mu_a (\\alpha_j)_a \\dot{s}^j$。为简单起见，我们将其写作 $\\langle \\mu, \\alpha_j \\dot{s}^j \\rangle$。\n\n1. 关于 $\\dot{s}^k$ 的偏导数：\n$$\n\\frac{\\partial \\ell}{\\partial \\dot{s}^k} = g_{ki}(s) \\dot{s}^i + \\langle \\mu, \\alpha_k(s) \\rangle\n$$\n\n2. 关于 $s^k$ 的偏导数：\n$$\n\\frac{\\partial \\ell}{\\partial s^k} = \\frac{1}{2} \\frac{\\partial g_{ij}}{\\partial s^k} \\dot{s}^i \\dot{s}^j + \\left\\langle \\mu, \\frac{\\partial \\alpha_j}{\\partial s^k} \\dot{s}^j \\right\\rangle - \\frac{\\partial V}{\\partial s^k}\n$$\n\n3. $\\frac{\\partial \\ell}{\\partial \\dot{s}^k}$ 的全时间导数：\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial \\ell}{\\partial \\dot{s}^k}\\right) = \\frac{d}{dt} \\left( g_{ki} \\dot{s}^i \\right) + \\frac{d}{dt} \\left( \\langle \\mu, \\alpha_k \\rangle \\right) = \\left( \\frac{\\partial g_{ki}}{\\partial s^j} \\dot{s}^j \\dot{s}^i + g_{ki} \\ddot{s}^i \\right) + \\left\\langle \\mu, \\frac{\\partial \\alpha_k}{\\partial s^j} \\dot{s}^j \\right\\rangle\n$$\n组合欧拉-拉格朗日方程得到：\n$$\n\\left( g_{ki} \\ddot{s}^i + \\frac{\\partial g_{ki}}{\\partial s^j} \\dot{s}^j \\dot{s}^i \\right) - \\left( \\frac{1}{2} \\frac{\\partial g_{ij}}{\\partial s^k} \\dot{s}^i \\dot{s}^j \\right) + \\left\\langle \\mu, \\frac{\\partial \\alpha_k}{\\partial s^j} \\dot{s}^j \\right\\rangle - \\left\\langle \\mu, \\frac{\\partial \\alpha_j}{\\partial s^k} \\dot{s}^j \\right\\rangle + \\frac{\\partial V}{\\partial s^k} = 0\n$$\n我们来分析这些项。涉及度量的项可以用 $g_S$ 的列维-奇维塔联络的克里斯托费尔符号 $\\Gamma^i_{jk}$ 来表示：\n$$\ng_{ki} \\Gamma^i_{jl} = \\frac{1}{2} \\left( \\frac{\\partial g_{kl}}{\\partial s^j} + \\frac{\\partial g_{jl}}{\\partial s^k} - \\frac{\\partial g_{kj}}{\\partial s^l} \\right)\n$$\n方程的前三项变为：\n$$\ng_{ki} \\ddot{s}^i + \\frac{\\partial g_{ki}}{\\partial s^j} \\dot{s}^j \\dot{s}^i - \\frac{1}{2} \\frac{\\partial g_{ij}}{\\partial s^k} \\dot{s}^i \\dot{s}^j = g_{ki}(\\ddot{s}^i + \\Gamma^i_{jl} \\dot{s}^j \\dot{s}^l)\n$$\n这是与协变加速度矢量 $\\nabla_t \\dot{s}$ 对应的协变余矢量的第 $k$ 个分量，即 $(g_S(\\nabla_t \\dot{s}, \\cdot))_k$。\n\n涉及势的项对应于 $V$ 的梯度的负数：$(\\text{grad}_S V)^k = g^{ki} \\frac{\\partial V}{\\partial s^i}$，所以项 $\\frac{\\partial V}{\\partial s^k}$ 是 1-形式 $dV$ 的第 $k$ 个分量。\n\n涉及 $\\alpha$ 的项是：\n$$\n\\left\\langle \\mu, \\frac{\\partial \\alpha_k}{\\partial s^j} \\dot{s}^j \\right\\rangle - \\left\\langle \\mu, \\frac{\\partial \\alpha_j}{\\partial s^k} \\dot{s}^j \\right\\rangle = \\left\\langle \\mu, \\left( \\frac{\\partial \\alpha_k}{\\partial s^j} - \\frac{\\partial \\alpha_j}{\\partial s^k} \\right) \\dot{s}^j \\right\\rangle\n$$\n括号中的项 $(\\frac{\\partial \\alpha_k}{\\partial s^j} - \\frac{\\partial \\alpha_j}{\\partial s^k})$ 是 $\\mathfrak{g}$-值 2-形式 $d\\alpha = \\widetilde{\\mathcal{B}}$ 的分量。因此，这一项是 $\\langle \\mu, \\widetilde{\\mathcal{B}}_{jk} \\dot{s}^j \\rangle$。这是 1-形式 $i_{\\dot{s}} \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle$ 的第 $k$ 个分量，其中 $i_{\\dot{s}}$ 表示与矢量场 $\\dot{s}$ 的内积。\n\n将所有项用内在的、无坐标的表示法组合在一起，约化欧拉-拉格朗日方程为：\n$$\n(g_S(\\nabla_t \\dot{s}, \\cdot))^\\flat + dV + i_{\\dot{s}} \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle = 0\n$$\n应用音乐同构 $(\\cdot)^{\\sharp}$（用度量 $g_S$ 升指标）将这个 1-形式方程转换为矢量场方程，并回顾 $\\text{grad}_S V = (dV)^\\sharp$，我们得到：\n$$\n\\nabla_t \\dot{s} = - \\text{grad}_S V - (i_{\\dot{s}} \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle)^\\sharp\n$$\n这个方程的形式是“质量 $\\times$ 加速度 = 力”。因此，由曲率诱导的对形状动力学的等效力是：\n$$\nF_{\\mathrm{curv}} = - (i_{\\dot{s}} \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle)^\\sharp\n$$\n负号可以被吸收到力的定义中，或者被看作是约定的结果。如果选择力是加在势梯度上的项，我们有 $F_{\\mathrm{curv}} = -(i_{\\dot{s}}\\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle)^\\sharp$。然而，标准的物理类比将洛伦兹力视为平衡加速度和其他力的项，从而得到形式 $\\nabla_t \\dot{s} + \\text{grad}_S V = F_{Lorentz}$。为了与此保持一致，我们定义 $F_{\\mathrm{curv}} = (i_{\\dot{s}}\\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle)^\\sharp$。这个选择不影响最终的功的计算，我们将会看到。让我们继续使用 $F_{\\mathrm{curv}} = (i_{\\dot{s}} \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle)^\\sharp$。\n\n这种曲率诱导力类似于磁力。动量 $\\mu \\in \\mathfrak{g}^*$ 扮演电荷的角色，曲率 2-形式 $\\widetilde{\\mathcal{B}}$ 扮演磁场 2-形式的角色。该力与速度相关，其结构类似于叉积，这是磁力的特征。这种力的一个关键特性是它们是陀螺力，这意味着它们不做功，因为它们总是与速度正交。\n\n我们可以通过计算功率来验证这一点，功率是功表达式的被积函数：\n$$\nP_{\\mathrm{curv}}(t) = g_{S}(F_{\\mathrm{curv}}(s(t), \\dot{s}(t)),\\, \\dot{s}(t))\n$$\n代入 $F_{\\mathrm{curv}}$ 的表达式：\n$$\nP_{\\mathrm{curv}}(t) = g_{S}((i_{\\dot{s}} \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle)^\\sharp,\\, \\dot{s})\n$$\n根据音乐同构 $(\\cdot)^\\sharp$ 的定义，对于任意 1-形式 $\\omega$ 和矢量 $X$，我们有 $g_S(\\omega^\\sharp, X) = \\omega(X)$。这里，$\\omega = i_{\\dot{s}} \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle$ 且 $X = \\dot{s}$。所以，\n$$\nP_{\\mathrm{curv}}(t) = (i_{\\dot{s}} \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle)(\\dot{s})\n$$\n根据内积的定义，对于任意 2-形式 $\\Omega$ 和矢量 $X$，我们有 $(i_X \\Omega)(X) = \\Omega(X, X)$。因此：\n$$\nP_{\\mathrm{curv}}(t) = \\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle (\\dot{s}, \\dot{s})\n$$\n对象 $\\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle$ 是 $S$ 上的一个实值 2-形式。一个 2-形式是切矢量上的一个反对称双线性映射。对于任意 2-形式 $\\Omega$ 和任意矢量 $v$，由反对称性可知 $\\Omega(v, v) = -\\Omega(v, v)$，这意味着 $\\Omega(v, v) = 0$。\n应用此性质，我们有：\n$$\n\\langle \\mu, \\widetilde{\\mathcal{B}} \\rangle (\\dot{s}, \\dot{s}) = \\langle \\mu, \\widetilde{\\mathcal{B}}(\\dot{s}, \\dot{s}) \\rangle = \\langle \\mu, 0 \\rangle = 0\n$$\n由于功率 $P_{\\mathrm{curv}}(t)$ 对于所有 $t \\in [t_0, t_1]$ 恒为零，曲率诱导力沿任何路径 $s(t)$ 所做的功为：\n$$\nW_{\\mathrm{curv}}[s] = \\int_{t_{0}}^{t_{1}} P_{\\mathrm{curv}}(t) \\, dt = \\int_{t_{0}}^{t_{1}} 0 \\, dt = 0\n$$\n曲率诱导力所做的功为零。这证实了其陀螺性质。该力只改变速度的方向，而不改变其大小，因此不改变形状自由度的动能。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "本练习旨在连接解析理论与计算实践，处理一个经典的带有规范对称性的系统——卡鲁扎-克莱因（Kaluza-Klein）模型。你不仅需要推导其运动方程，还要运用离散变分力学的原理，构造一个能精确保持系统离散动量守恒的数值积分器 。这展示了辛几何算法在长时间模拟中保持系统内在几何结构和守恒律方面的卓越能力。",
            "id": "3751217",
            "problem": "考虑主丛 $Q = \\mathbb{R}^2 \\times S^1$，其底为 $S = \\mathbb{R}^2$，李群 $G = S^1$ 通过旋转作用于 $S^1$ 因子。设纤维坐标为 $\\theta \\in S^1$（以弧度为单位的角度），底坐标为 $\\mathbf{x}=(x,y)\\in \\mathbb{R}^2$。通过机械规范势，在底上指定一个联络1-形式来赋予 $Q$ 联络：\n\n$$\nA(\\mathbf{x}) \\cdot \\mathrm{d}\\mathbf{x} \\;=\\; \\frac{B}{2}\\left(-y \\,\\mathrm{d}x + x\\, \\mathrm{d}y\\right), \n$$\n\n其中 $B \\in \\mathbb{R}$ 是一个常数。因此，曲率2-形式为 $F = \\mathrm{d}A = B\\, \\mathrm{d}x \\wedge \\mathrm{d}y$，当 $B \\neq 0$ 时该形式非零。\n\n考虑卡鲁扎-克莱因拉格朗日量\n\n$$\nL(q,\\dot{q}) \\;=\\; \\frac{m}{2}\\|\\dot{\\mathbf{x}}\\|^2 \\;+\\; \\frac{I}{2}\\left(\\dot{\\theta} + A(\\mathbf{x}) \\cdot \\dot{\\mathbf{x}}\\right)^2,\n$$\n\n其中质量参数 $m>0$，惯性参数 $I>0$。该拉格朗日量在 $\\theta$ 的平移下是 $G$-不变的，因此拥有一个与 $S^1$-对称性相关的守恒动量映射。\n\n您的任务是：\n\n1) 仅从主丛、联络和 $G$-不变拉格朗日量的拉格朗日-庞加莱约化的定义出发，为上述卡鲁扎-克莱因系统推导在 $TS \\times \\mathfrak{g}$ 上的约化运动方程。识别守恒动量映射\n\n$$\nJ \\;=\\; \\frac{\\partial L}{\\partial \\dot{\\theta}} \\;=\\; I\\left(\\dot{\\theta} + A(\\mathbf{x})\\cdot \\dot{\\mathbf{x}}\\right),\n$$\n\n并解释为什么它在连续欧拉-拉格朗日方程的解上是守恒的。明确说明曲率 $F$ 如何在约化动力学中于底上导出磁力型力项。\n\n2) 基于离散拉格朗日量 $L_d: Q \\times Q \\to \\mathbb{R}$ 构造一个离散变分积分器，该拉格朗日量是通过对大小为 $h>0$ 的时间步长上的中点求积得到的，\n\n$$\nL_d(q_k,q_{k+1}) \\;\\approx\\; \\int_{t_k}^{t_{k+1}} L(q(t),\\dot{q}(t))\\,\\mathrm{d}t,\n$$\n\n其中中点法则应用于卡鲁扎-克莱因拉格朗日量。使用此 $L_d$ 写出离散欧拉-拉格朗日方程\n\n$$\nD_2 L_d(q_{k-1}, q_k) \\;+\\; D_1 L_d(q_k, q_{k+1}) \\;=\\; 0,\n$$\n\n并解释为什么离散诺特定理意味着与 $S^1$-对称性相关的离散动量映射被所得的变分积分器精确守恒。特别地，证明离散欧拉-拉格朗日方程的 $\\theta$-分量产生一个与 $k$ 无关的量，该量对应于守恒的离散动量。\n\n3) 将所得的离散变分积分器实现为针对未知量 $q_{k+1}$ 的隐式两步法，每一步通过求根迭代求解。按如下方式从 $(q_0, q_1)$ 初始化该格式：给定 $\\mathbf{x}_0 \\in \\mathbb{R}^2$、$\\dot{\\mathbf{x}}_0 \\in \\mathbb{R}^2$、$\\theta_0 \\in \\mathbb{R}$（弧度）以及一个给定的恒定动量水平 $\\mu \\in \\mathbb{R}$，定义 $\\mathbf{x}_1 = \\mathbf{x}_0 + h\\, \\dot{\\mathbf{x}}_0$ 并唯一地选择 $\\theta_1$ 以在第一步满足离散动量约束，从而使离散动量映射等于 $\\mu$。\n\n4) 对于下面的测试套件，数值上验证该积分器将离散动量映射保持在数值舍入误差范围内。对每个测试用例，积分 $N$ 步，并计算在所有步中离散动量值的最大绝对漂移，\n\n$$\n\\Delta_\\text{max} \\;=\\; \\max_{0 \\le k \\le N-1} \\left| J_k^\\text{disc} - \\mu \\right|,\n$$\n\n其中 $J_k^\\text{disc}$ 是从 $(q_k, q_{k+1})$ 计算出的离散动量。为每个测试用例将 $\\Delta_\\text{max}$ 报告为浮点数。\n\n角度单位：所有 $\\theta$ 值均以弧度为单位。不需要其他物理单位转换，所有输入在实现中应被视为无量纲标量。\n\n测试套件（请精确使用这些参数）：\n\n- 测试 1 (非零曲率，中等步长): $m=1.0$, $I=1.0$, $B=2.0$, $\\mu=0.7$, $h=0.1$, $N=200$, $\\mathbf{x}_0=(1.0,\\,0.0)$, $\\dot{\\mathbf{x}}_0=(0.0,\\,1.0)$, $\\theta_0=0.0$。\n- 测试 2 (零曲率边界情况): $m=1.0$, $I=0.5$, $B=0.0$, $\\mu=1.1$, $h=0.1$, $N=100$, $\\mathbf{x}_0=(0.0,\\,0.0)$, $\\dot{\\mathbf{x}}_0=(1.0,\\,0.5)$, $\\theta_0=0.0$。\n- 测试 3 (不同符号和参数的非零曲率): $m=1.5$, $I=0.3$, $B=-3.0$, $\\mu=-0.9$, $h=0.05$, $N=200$, $\\mathbf{x}_0=(0.5,\\,0.5)$, $\\dot{\\mathbf{x}}_0=(1.0,\\,0.2)$, $\\theta_0=1.0$。\n\n最终输出格式：您的程序应生成单行输出，其中包含三个测试的结果，形式为方括号括起来的逗号分隔列表，按上述顺序排列，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是相应测试用例的浮点数 $\\Delta_\\text{max}$。",
            "solution": "该问题是有效的，因为它在科学上基于几何力学的原理，问题适定，有通向唯一解的清晰路径，并且陈述客观无歧义。该设置描述了一个磁场中带电粒子的标准卡鲁扎-克莱因模型，任务涉及拉格朗日-庞加莱约化和离散变分积分器构造的标准程序。所有必要的数据和定义都已提供。\n\n### 第1部分：约化运动方程的推导\n\n位形空间是主丛 $Q = \\mathbb{R}^2 \\times S^1$，其底为 $S=\\mathbb{R}^2$，结构群为 $G=S^1$。坐标为 $q = (\\mathbf{x}, \\theta)$，其中 $\\mathbf{x}=(x,y) \\in \\mathbb{R}^2$ 且 $\\theta \\in S^1$。卡鲁扎-克莱因系统的拉格朗日量由下式给出\n$$\nL(q,\\dot{q}) = L(\\mathbf{x}, \\theta, \\dot{\\mathbf{x}}, \\dot{\\theta}) = \\frac{m}{2}\\|\\dot{\\mathbf{x}}\\|^2 + \\frac{I}{2}\\left(\\dot{\\theta} + A(\\mathbf{x}) \\cdot \\dot{\\mathbf{x}}\\right)^2\n$$\n其中 $m, I > 0$ 是常数，而 $A(\\mathbf{x}) = \\frac{B}{2}(-y, x)$ 是机械联络势。\n\n李群 $G=S^1$ 在 $Q$ 上的作用是对 $\\theta$ 坐标的加法：$\\phi \\in S^1$ 的作用为 $(\\mathbf{x}, \\theta) \\mapsto (\\mathbf{x}, \\theta+\\phi)$。拉格朗日量与 $\\theta$ 无关（即 $\\frac{\\partial L}{\\partial \\theta} = 0$），这意味着它在该群作用下是不变的。根据诺特定理，与此对称性相对应的动量映射是守恒的。动量映射 $J: TQ \\to \\mathfrak{g}^*$ 由拉格朗日量对纤维速度的导数给出。由于 $G=S^1$ 是阿贝尔群，其李代数为 $\\mathfrak{g} \\cong \\mathbb{R}$，其对偶为 $\\mathfrak{g}^* \\cong \\mathbb{R}$。动量映射计算如下\n$$\nJ = \\frac{\\partial L}{\\partial \\dot{\\theta}} = I\\left(\\dot{\\theta} + A(\\mathbf{x}) \\cdot \\dot{\\mathbf{x}}\\right)\n$$\n$\\theta$ 坐标的欧拉-拉格朗日方程为 $\\frac{d}{dt}\\frac{\\partial L}{\\partial \\dot{\\theta}} - \\frac{\\partial L}{\\partial \\theta} = 0$。由于 $\\frac{\\partial L}{\\partial \\theta}=0$，这立即得出 $\\frac{dJ}{dt} = 0$，证实了 $J$ 是系统解上的一个守恒量。我们将其常数值记为 $\\mu$。\n\n为了执行拉格朗日-庞加莱约化，我们用约化变量来表示拉格朗日量。速度 $\\dot{q}=(\\dot{\\mathbf{x}}, \\dot{\\theta}) \\in T_q Q$ 使用联络 $A$ 分解为一个水平部分和一个垂直部分。垂直速度是李代数 $\\mathfrak{g}$ 的一个元素，被识别为 $\\Omega = \\dot{\\theta} + A(\\mathbf{x})\\cdot \\dot{\\mathbf{x}}$。拉格朗日量可以在约化空间 $TS \\times \\mathfrak{g}$ 上写为\n$$\nl(\\mathbf{x}, \\dot{\\mathbf{x}}, \\Omega) = \\frac{m}{2}\\|\\dot{\\mathbf{x}}\\|^2 + \\frac{I}{2}\\Omega^2\n$$\n对于具有阿贝尔群 $G$ 的系统，拉格朗日-庞加莱方程为\n$$\n\\begin{cases}\n\\frac{d}{dt} \\frac{\\partial l}{\\partial \\dot{\\mathbf{x}}} - \\frac{\\partial l}{\\partial \\mathbf{x}} = \\left\\langle \\frac{\\partial l}{\\partial \\Omega}, F(\\dot{\\mathbf{x}}, \\cdot) \\right\\rangle  \\text{(水平方程)} \\\\\n\\frac{d}{dt} \\frac{\\partial l}{\\partial \\Omega} = 0  \\text{(垂直方程)}\n\\end{cases}\n$$\n这里，$F = dA$ 是联络的曲率，而 $\\langle\\cdot, \\cdot\\rangle$ 表示 $\\mathfrak{g}$ 和 $\\mathfrak{g}^*$ 之间的配对。\n\n对于我们的系统，我们计算 $l$ 的偏导数：\n$\\frac{\\partial l}{\\partial \\dot{\\mathbf{x}}} = m\\dot{\\mathbf{x}}$，$\\frac{\\partial l}{\\partial \\mathbf{x}} = 0$，以及 $\\frac{\\partial l}{\\partial \\Omega} = I\\Omega$。\n垂直方程变为 $\\frac{d}{dt}(I\\Omega) = 0$，这证实了动量映射 $J = I\\Omega = \\mu$ 是守恒的。\n\n水平方程变为 $m\\ddot{\\mathbf{x}} = \\langle \\mu, F(\\dot{\\mathbf{x}}, \\cdot) \\rangle$。曲率为 $F = dA = B \\,dx \\wedge dy$。对于底速度 $\\dot{\\mathbf{x}} = (\\dot{x}, \\dot{y})$ 和底上的任意向量场 $v=(v_x, v_y)$，曲率形式的作用是\n$$\nF(\\dot{\\mathbf{x}}, v) = (B \\,dx \\wedge dy)((\\dot{x}, \\dot{y}), (v_x, v_y)) = B(\\dot{x}v_y - \\dot{y}v_x)\n$$\n水平方程右侧的力项是一个余向量，可以通过 $\\mathbb{R}^2$ 上的欧几里得内积与一个向量 $\\mathbf{F}_{\\text{mag}}$ 等同：$\\mathbf{F}_{\\text{mag}} \\cdot v = \\mu F(\\dot{\\mathbf{x}}, v)$。\n$$\n\\mathbf{F}_{\\text{mag}} \\cdot v = \\mu B(\\dot{x}v_y - \\dot{y}v_x) = \\mu B (-\\dot{y}, \\dot{x}) \\cdot (v_x, v_y)\n$$\n因此，我们将磁力确定为 $\\mathbf{F}_{\\text{mag}} = \\mu B (-\\dot{y}, \\dot{x})$。底空间 $S = \\mathbb{R}^2$ 上的约化运动方程为\n$$\nm\\ddot{\\mathbf{x}} = \\mu B (-\\dot{y}, \\dot{x})\n$$\n可以分量形式写为 $m\\ddot{x} = -\\mu B \\dot{y}$ 和 $m\\ddot{y} = \\mu B \\dot{x}$。这是质量为 $m$、电荷为 $\\mu$ 的粒子在垂直于平面的强度为 $B$ 的恒定磁场中的运动方程。\n\n### 第2部分：离散变分积分器\n\n我们通过对一个时间步长 $h$ 上的作用量积分应用中点求积法则来构造一个离散拉格朗日量 $L_d: Q \\times Q \\to \\mathbb{R}$：\n$$\nL_d(q_k, q_{k+1}) = h L\\left( \\frac{q_k+q_{k+1}}{2}, \\frac{q_{k+1}-q_k}{h} \\right)\n$$\n其中 $q_k = (\\mathbf{x}_k, \\theta_k)$。$L$ 的参数是中点位置 $q_{k+1/2} = (\\frac{\\mathbf{x}_k+\\mathbf{x}_{k+1}}{2}, \\frac{\\theta_k+\\theta_{k+1}}{2})$ 和有限差分速度 $\\dot{q}_{k+1/2} = (\\frac{\\mathbf{x}_{k+1}-\\mathbf{x}_k}{h}, \\frac{\\theta_{k+1}-\\theta_k}{h})$。代入连续拉格朗日量可得\n$$\nL_d(q_k, q_{k+1}) = h \\left[ \\frac{m}{2} \\left\\| \\frac{\\mathbf{x}_{k+1}-\\mathbf{x}_k}{h} \\right\\|^2 + \\frac{I}{2} \\left( \\frac{\\theta_{k+1}-\\theta_k}{h} + A\\left(\\frac{\\mathbf{x}_k+\\mathbf{x}_{k+1}}{2}\\right) \\cdot \\frac{\\mathbf{x}_{k+1}-\\mathbf{x}_k}{h} \\right)^2 \\right]\n$$\n联络项简化为\n$A\\left(\\frac{\\mathbf{x}_k+\\mathbf{x}_{k+1}}{2}\\right) \\cdot (\\mathbf{x}_{k+1}-\\mathbf{x}_k) = \\frac{B}{2} \\left( -\\frac{y_k+y_{k+1}}{2}, \\frac{x_k+x_{k+1}}{2} \\right) \\cdot (x_{k+1}-x_k, y_{k+1}-y_k) = \\frac{B}{2}(x_k y_{k+1} - y_k x_{k+1})$。\n因此，离散拉格朗日量为\n$$\nL_d(q_k, q_{k+1}) = \\frac{m}{2h} \\|\\mathbf{x}_{k+1}-\\mathbf{x}_k\\|^2 + \\frac{I}{2h} \\left[ (\\theta_{k+1}-\\theta_k) + \\frac{B}{2}(x_k y_{k+1} - x_{k+1} y_k) \\right]^2\n$$\n动力学由离散欧拉-拉格朗日 (DEL) 方程决定：\n$$\nD_2 L_d(q_{k-1}, q_k) + D_1 L_d(q_k, q_{k+1}) = 0\n$$\n其中 $D_1$ 和 $D_2$ 分别表示对 $L_d$ 的第一个和第二个参数求导。$\\theta$ 坐标的方程为 $\\frac{\\partial L_d(q_{k-1}, q_k)}{\\partial\\theta_k} + \\frac{\\partial L_d(q_k, q_{k+1})}{\\partial\\theta_k} = 0$。\n\n离散拉格朗日量在同时平移 $(\\theta_k, \\theta_{k+1}) \\to (\\theta_k+\\alpha, \\theta_{k+1}+\\alpha)$ 下是不变的，因为它只依赖于差值 $\\theta_{k+1}-\\theta_k$。离散诺特定理保证了与此对称性相关的一个守恒量。我们定义离散动量映射 $J_k^{\\text{disc}}$：\n$$\nJ_k^{\\text{disc}} := -\\frac{\\partial L_d(q_k, q_{k+1})}{\\partial \\theta_k} = \\frac{I}{h} \\left[ (\\theta_{k+1}-\\theta_k) + \\frac{B}{2}(x_k y_{k+1} - x_{k+1} y_k) \\right]\n$$\n我们还计算 $\\frac{\\partial L_d(q_k, q_{k+1})}{\\partial \\theta_{k+1}} = -J_k^{\\text{disc}}$。\n因此，在第 $k$ 步的 DEL 方程的 $\\theta$-分量 $\\frac{\\partial L_d(q_{k-1}, q_k)}{\\partial \\theta_k} + \\frac{\\partial L_d(q_k, q_{k+1})}{\\partial \\theta_k} = 0$ 变为 $J_{k-1}^{\\text{disc}} - J_k^{\\text{disc}} = 0$，这意味着 $J_k^{\\text{disc}} = J_{k-1}^{\\text{disc}}$。这表明离散动量 $J_k^{\\text{disc}}$ 被该积分器对所有 $k$ 精确守恒。\n\n### 第3部分：变分积分器的实现\n\n该积分器是一个映射 $(q_{k-1}, q_k) \\mapsto q_{k+1}$。令离散动量的恒定值为 $\\mu$。$\\theta$-方程提供了一种在给定 $(\\mathbf{x}_k, \\theta_k)$ 和 $\\mathbf{x}_{k+1}$ 的情况下更新 $\\theta_{k+1}$ 的方法：\n$$\n\\theta_{k+1} = \\theta_k + \\frac{h\\mu}{I} - \\frac{B}{2}(x_k y_{k+1} - x_{k+1} y_k)\n$$\nDEL 方程的 $\\mathbf{x}$-分量给出了 $\\mathbf{x}_{k+1}$ 的更新：\n$D_2 L_d(q_{k-1}, q_k)_{\\mathbf{x}} + D_1 L_d(q_k, q_{k+1})_{\\mathbf{x}} = 0$。\n导数为：\n$$\n\\frac{\\partial L_d(q_k, q_{k+1})}{\\partial\\mathbf{x}_k} = \\frac{m}{h}(\\mathbf{x}_k - \\mathbf{x}_{k+1}) + J_k^{\\text{disc}} \\frac{B}{2} (y_{k+1}, -x_{k+1}) = \\frac{m}{h}(\\mathbf{x}_k - \\mathbf{x}_{k+1}) - \\mu \\frac{B}{2} \\mathbf{x}_{k+1}^{\\perp}\n$$\n$$\n\\frac{\\partial L_d(q_{k-1}, q_k)}{\\partial\\mathbf{x}_k} = \\frac{m}{h}(\\mathbf{x}_k - \\mathbf{x}_{k-1}) + J_{k-1}^{\\text{disc}} \\frac{B}{2} (-y_{k-1}, x_{k-1}) = \\frac{m}{h}(\\mathbf{x}_k - \\mathbf{x}_{k-1}) + \\mu \\frac{B}{2} \\mathbf{x}_{k-1}^{\\perp}\n$$\n其中 $\\mathbf{v}^{\\perp} = (-v_y, v_x)$。将它们相加得到：\n$$\n\\frac{m}{h}(2\\mathbf{x}_k - \\mathbf{x}_{k-1} - \\mathbf{x}_{k+1}) + \\mu\\frac{B}{2}(\\mathbf{x}_{k-1}^{\\perp} - \\mathbf{x}_{k+1}^{\\perp}) = 0\n$$\n$$\nm \\mathbf{x}_{k+1} + \\mu\\frac{hB}{2}\\mathbf{x}_{k+1}^{\\perp} = m(2\\mathbf{x}_k - \\mathbf{x}_{k-1}) + \\mu\\frac{hB}{2}\\mathbf{x}_{k-1}^{\\perp}\n$$\n这是一个关于 $\\mathbf{x}_{k+1} = (x_{k+1}, y_{k+1})$ 的 $2 \\times 2$ 线性系统，而不是需要求根迭代的一般非线性方程。令 $\\alpha = \\frac{\\mu h B}{2}$。该系统为：\n$$\n\\begin{pmatrix} m  -\\alpha \\\\ \\alpha  m \\end{pmatrix} \\begin{pmatrix} x_{k+1} \\\\ y_{k+1} \\end{pmatrix} = \\begin{pmatrix} m(2x_k - x_{k-1}) - \\alpha y_{k-1} \\\\ m(2y_k - y_{k-1}) + \\alpha x_{k-1} \\end{pmatrix}\n$$\n行列式为 $m^2+\\alpha^2 > 0$，因此每一步都存在 $\\mathbf{x}_{k+1}$ 的唯一解。\n\n**初始化：** 给定 $(\\mathbf{x}_0, \\dot{\\mathbf{x}}_0, \\theta_0, \\mu, h)$，我们设 $q_0 = (\\mathbf{x}_0, \\theta_0)$。下一个点 $q_1$ 通过对底空间使用前向欧拉步和对纤维满足约束条件来构造。\n$\\mathbf{x}_1 = \\mathbf{x}_0 + h \\dot{\\mathbf{x}}_0$。\n选择 $\\theta_1$ 以满足离散动量约束 $J_0^{\\text{disc}} = \\mu$：\n$$\n\\frac{I}{h} \\left[ (\\theta_1-\\theta_0) + \\frac{B}{2}(x_0 y_1 - x_1 y_0) \\right] = \\mu \\implies \\theta_1 = \\theta_0 + \\frac{h\\mu}{I} - \\frac{B}{2}(x_0 y_1 - x_1 y_0)\n$$\n在 $q_0$ 和 $q_1$ 初始化后，积分器可以继续求解 $q_2, q_3, \\dots, q_N$。\n\n### 第4部分：数值验证\n\n数值任务是实现所描述的算法。对于每个测试用例，我们将模拟运行 $N$ 步。在从 $0$ 到 $N-1$ 的每一步 $k$，计算出 $q_{k+1}$ 后，我们使用其定义计算离散动量 $J_k^{\\text{disc}}$。然后我们找出计算出的 $J_k^{\\text{disc}}$ 与给定的恒定值 $\\mu$ 之间的最大绝对差。这个差值应该在机器浮点精度的量级，从而数值上验证了变分积分器的精确动量守恒性质。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Test 1: nonzero curvature, moderate step\n        {'m': 1.0, 'I': 1.0, 'B': 2.0, 'mu': 0.7, 'h': 0.1, 'N': 200, \n         'x0': np.array([1.0, 0.0]), 'x_dot0': np.array([0.0, 1.0]), 'theta0': 0.0},\n        # Test 2: zero curvature boundary case\n        {'m': 1.0, 'I': 0.5, 'B': 0.0, 'mu': 1.1, 'h': 0.1, 'N': 100, \n         'x0': np.array([0.0, 0.0]), 'x_dot0': np.array([1.0, 0.5]), 'theta0': 0.0},\n        # Test 3: nonzero curvature with different signs and parameters\n        {'m': 1.5, 'I': 0.3, 'B': -3.0, 'mu': -0.9, 'h': 0.05, 'N': 200, \n         'x0': np.array([0.5, 0.5]), 'x_dot0': np.array([1.0, 0.2]), 'theta0': 1.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_max = run_integration(\n            m=case['m'], I=case['I'], B=case['B'], mu=case['mu'],\n            h=case['h'], N=case['N'], x0=case['x0'],\n            x_dot0=case['x_dot0'], theta0=case['theta0']\n        )\n        results.append(delta_max)\n\n    print(f\"[{','.join(f'{r:.16e}' for r in results)}]\")\n\ndef run_integration(m, I, B, mu, h, N, x0, x_dot0, theta0):\n    \"\"\"\n    Implements the discrete variational integrator and computes the\n    maximum drift in the discrete momentum.\n\n    Args:\n        m, I, B, mu, h, N: System and integration parameters.\n        x0, x_dot0, theta0: Initial conditions.\n\n    Returns:\n        The maximum absolute drift of the discrete momentum value.\n    \"\"\"\n    # Store trajectory q_k = (x_k, y_k, theta_k)\n    q = np.zeros((N + 1, 3))\n    \n    # Initialize q_0\n    q[0, :2] = x0\n    q[0, 2] = theta0\n    \n    # Initialize q_1\n    # x_1 = x_0 + h * x_dot_0\n    x1 = x0 + h * x_dot0\n    q[1, :2] = x1\n    \n    # Choose theta_1 to satisfy J_0^disc = mu\n    # J_0^disc = (I/h) * [ (theta_1-theta_0) + (B/2)*(x0*y1 - x1*y0) ] = mu\n    # theta_1 = theta_0 + h*mu/I - (B/2)*(x0*y1 - x1*y0)\n    theta1 = theta0 + (h * mu / I) - (B / 2) * (x0[0] * x1[1] - x1[0] * x0[1])\n    q[1, 2] = theta1\n\n    # Setup the linear system for the integrator step\n    # A * x_{k+1} = b\n    alpha = mu * h * B / 2.0\n    A = np.array([[m, -alpha], [alpha, m]])\n    \n    # Run the integrator for N steps\n    for k in range(1, N):\n        xk_minus_1 = q[k - 1, :2]\n        xk = q[k, :2]\n        thetak = q[k, 2]\n        \n        # Calculate the right-hand side of the linear system for x_{k+1}\n        # b = m*(2*xk - xk_m1) + alpha * xk_m1_perp\n        # xk_m1_perp = [-y, x]\n        b = m * (2 * xk - xk_minus_1) + \\\n            alpha * np.array([-xk_minus_1[1], xk_minus_1[0]])\n        \n        # Solve for x_{k+1}\n        xk_plus_1 = np.linalg.solve(A, b)\n        q[k + 1, :2] = xk_plus_1\n        \n        # Update theta_{k+1} by enforcing discrete momentum conservation\n        # J_k^disc = (I/h) * [ (theta_{k+1}-theta_k) + (B/2)*(xk_y_{k+1} - x_{k+1}_yk) ] = mu\n        # theta_{k+1} = theta_k + h*mu/I - (B/2)*(xk_y_{k+1} - x_{k+1}_yk)\n        thetak_plus_1 = thetak + (h * mu / I) - \\\n            (B / 2) * (xk[0] * xk_plus_1[1] - xk_plus_1[0] * xk[1])\n        q[k + 1, 2] = thetak_plus_1\n\n    # Calculate discrete momentum and its drift for all steps\n    drifts = []\n    for k in range(N):\n        x_k, y_k, theta_k = q[k]\n        x_kp1, y_kp1, theta_kp1 = q[k+1]\n        \n        # J_k^disc = (I/h) * [ (theta_kp1-theta_k) + (B/2)*(xk_y_kp1 - x_kp1_yk) ]\n        j_k_disc = (I / h) * ((theta_kp1 - theta_k) + \\\n                   (B / 2.0) * (x_k * y_kp1 - x_kp1 * y_k))\n        \n        drifts.append(np.abs(j_k_disc - mu))\n    \n    return np.max(drifts)\n\nsolve()\n```"
        }
    ]
}