{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固您对李代数 $\\mathfrak{so}(3)$ 与三维欧氏空间 $\\mathbb{R}^3$ 之间基本同构关系的理解。通过计算伴随表示 (adjoint representation)，我们将具体揭示 $\\mathfrak{so}(3)$ 中的李括号运算（矩阵换位子）如何精确地对应于 $\\mathbb{R}^3$ 中的向量叉乘积。这一实践是理解为何能将旋转的无穷小生成元等同于三维向量的关键。",
            "id": "3779331",
            "problem": "考虑特殊正交群 $\\mathrm{SO}(3)$ 及其李代数 $\\mathfrak{so}(3)$，通过线性映射 $a \\mapsto \\widehat{a}$ 与 $\\mathbb{R}^3$ 等同，该映射定义为 $\\widehat{a} x = a \\times x$ 对所有 $x \\in \\mathbb{R}^3$ 成立，其中 $\\times$ 表示向量叉积。令 $\\{e_{1}, e_{2}, e_{3}\\}$ 表示 $\\mathbb{R}^3$ 的标准基，并定义 $\\mathfrak{so}(3)$ 的基 $\\{E_{1}, E_{2}, E_{3}\\}$ 为 $E_{i} := \\widehat{e_{i}}$。$\\mathfrak{so}(3)$ 上的李括号是矩阵交换子 $[A,B] = AB - BA$。令 $\\epsilon_{ijk}$ 表示 Levi-Civita 符号，并假设除非明确说明，否则不使用爱因斯坦求和约定。\n\n从上述核心定义出发，计算线性映射 $\\mathrm{ad}_{\\widehat{a}} : \\mathfrak{so}(3) \\to \\mathfrak{so}(3)$ 在基向量 $\\{E_{1}, E_{2}, E_{3}\\}$ 上的作用，该映射定义为 $\\mathrm{ad}_{\\widehat{a}}(X) = [\\widehat{a}, X]$。然后将 $\\mathrm{ad}_{\\widehat{a}}$ 表示为关于有序基 $\\{E_{1}, E_{2}, E_{3}\\}$ 的一个 $3 \\times 3$ 矩阵，其元素用 $\\epsilon_{ijk}$ 和 $a$ 的分量 $a_{1}, a_{2}, a_{3}$ 表示。你的最终答案必须是一个封闭形式的解析表达式（不需要进行数值计算）。",
            "solution": "该问题是有效的，因为它是科学上合理的、良定的和客观的。这是李代数（特别是 $\\mathfrak{so}(3)$ 及其伴随表示）研究中的一个标准练习。所有术语都得到了正式定义，且前提条件是一致和完整的。\n\n我们的目标是找到线性映射 $\\mathrm{ad}_{\\widehat{a}} : \\mathfrak{so}(3) \\to \\mathfrak{so}(3)$ 关于有序基 $\\{E_{1}, E_{2}, E_{3}\\}$ 的 $3 \\times 3$ 矩阵表示。该映射定义为 $\\mathrm{ad}_{\\widehat{a}}(X) = [\\widehat{a}, X]$，其中括号是矩阵交换子。\n\n设 $a \\in \\mathbb{R}^3$ 是一个分量为 $(a_1, a_2, a_3)$ 的向量，因此 $a = \\sum_{i=1}^{3} a_i e_i$。$\\mathfrak{so}(3)$ 中的相应元素是 $\\widehat{a}$。$\\mathfrak{so}(3)$ 的基由 $E_i = \\widehat{e_i}$ 给出，其中 $i \\in \\{1, 2, 3\\}$。根据帽映射的线性性质，我们可以在此基中表示 $\\widehat{a}$：\n$$\n\\widehat{a} = \\widehat{\\sum_{i=1}^{3} a_i e_i} = \\sum_{i=1}^{3} a_i \\widehat{e_i} = \\sum_{i=1}^{3} a_i E_i\n$$\n$\\mathrm{ad}_{\\widehat{a}}$ 的矩阵表示是一个矩阵，其第 $j$ 列是 $\\mathrm{ad}_{\\widehat{a}}(E_j)$ 在基 $\\{E_1, E_2, E_3\\}$ 下的坐标向量。我们计算 $\\mathrm{ad}_{\\widehat{a}}$ 对基向量 $E_j$ 的作用：\n$$\n\\mathrm{ad}_{\\widehat{a}}(E_j) = [\\widehat{a}, E_j]\n$$\n使用 $\\widehat{a}$ 的表达式和李括号的双线性性质：\n$$\n\\mathrm{ad}_{\\widehat{a}}(E_j) = \\left[ \\sum_{i=1}^{3} a_i E_i, E_j \\right] = \\sum_{i=1}^{3} a_i [E_i, E_j]\n$$\n为了继续，我们必须计算基向量的交换子 $[E_i, E_j]$。这些是李代数的结构常数。两个帽映射向量的交换子由它们叉积的帽映射给出：$[\\widehat{u}, \\widehat{v}] = \\widehat{u \\times v}$。这是 $(\\mathbb{R}^3, \\times)$ 和 $(\\mathfrak{so}(3), [,])$ 之间李代数同构的一个基本性质。\n将此性质应用于我们的基向量 $E_i = \\widehat{e_i}$ 和 $E_j = \\widehat{e_j}$：\n$$\n[E_i, E_j] = [\\widehat{e_i}, \\widehat{e_j}] = \\widehat{e_i \\times e_j}\n$$\n$\\mathbb{R}^3$ 的标准基向量的叉积由 Levi-Civita 符号 $\\epsilon_{ijk}$ 给出：\n$$\ne_i \\times e_j = \\sum_{k=1}^{3} \\epsilon_{ijk} e_k\n$$\n将此代入交换子的表达式中：\n$$\n[E_i, E_j] = \\widehat{\\sum_{k=1}^{3} \\epsilon_{ijk} e_k} = \\sum_{k=1}^{3} \\epsilon_{ijk} \\widehat{e_k} = \\sum_{k=1}^{3} \\epsilon_{ijk} E_k\n$$\n现在我们将此结果代回我们关于 $\\mathrm{ad}_{\\widehat{a}}(E_j)$ 的表达式中：\n$$\n\\mathrm{ad}_{\\widehat{a}}(E_j) = \\sum_{i=1}^{3} a_i [E_i, E_j] = \\sum_{i=1}^{3} a_i \\left( \\sum_{k=1}^{3} \\epsilon_{ijk} E_k \\right)\n$$\n通过重新排列求和顺序，我们可以将此结果表示为基向量 $E_k$ 的线性组合：\n$$\n\\mathrm{ad}_{\\widehat{a}}(E_j) = \\sum_{k=1}^{3} \\left( \\sum_{i=1}^{3} a_i \\epsilon_{ijk} \\right) E_k\n$$\n$\\mathrm{ad}_{\\widehat{a}}(E_j)$ 展开式中 $E_k$ 的系数是 $\\mathrm{ad}_{\\widehat{a}}$ 的变换矩阵 $M$ 的矩阵元素 $M_{kj}$（其中 $k$ 是行索引，$j$ 是列索引）。因此：\n$$\nM_{kj} = \\sum_{i=1}^{3} a_i \\epsilon_{ijk}\n$$\n我们现在可以显式计算 $3 \\times 3$ 矩阵 $M = [\\mathrm{ad}_{\\widehat{a}}]$ 的元素。\n\n对于第一列 ($j=1$):\n$M_{11} = \\sum_{i=1}^{3} a_i \\epsilon_{i11} = 0$\n$M_{21} = \\sum_{i=1}^{3} a_i \\epsilon_{i12} = a_3 \\epsilon_{312} = a_3(1) = a_3$\n$M_{31} = \\sum_{i=1}^{3} a_i \\epsilon_{i13} = a_2 \\epsilon_{213} = a_2(-1) = -a_2$\n\n对于第二列 ($j=2$):\n$M_{12} = \\sum_{i=1}^{3} a_i \\epsilon_{i21} = a_3 \\epsilon_{321} = a_3(-1) = -a_3$\n$M_{22} = \\sum_{i=1}^{3} a_i \\epsilon_{i22} = 0$\n$M_{32} = \\sum_{i=1}^{3} a_i \\epsilon_{i23} = a_1 \\epsilon_{123} = a_1(1) = a_1$\n\n对于第三列 ($j=3$):\n$M_{13} = \\sum_{i=1}^{3} a_i \\epsilon_{i31} = a_2 \\epsilon_{231} = a_2(1) = a_2$\n$M_{23} = \\sum_{i=1}^{3} a_i \\epsilon_{i32} = a_1 \\epsilon_{132} = a_1(-1) = -a_1$\n$M_{33} = \\sum_{i=1}^{3} a_i \\epsilon_{i33} = 0$\n\n将这些分量组合成矩阵 $M$：\n$$\nM = \\begin{pmatrix} M_{11}  M_{12}  M_{13} \\\\ M_{21}  M_{22}  M_{23} \\\\ M_{31}  M_{32}  M_{33} \\end{pmatrix} = \\begin{pmatrix} 0  -a_3  a_2 \\\\ a_3  0  -a_1 \\\\ -a_2  a_1  0 \\end{pmatrix}\n$$\n所得矩阵正是应用于向量 $a$ 的帽映射的矩阵表示，即 $M = \\widehat{a}$。因此，伴随映射 $\\mathrm{ad}_{\\widehat{a}}$ 在基 $\\{E_1, E_2, E_3\\}$ 下的矩阵就是 $\\widehat{a}$ 本身。\n该矩阵的元素 $M_{kj}$ 可以使用 Levi-Civita 符号和性质 $\\epsilon_{ijk} = \\epsilon_{kij}$ 紧凑地写出：\n$$\nM_{kj} = \\sum_{i=1}^{3} a_i \\epsilon_{ijk} = \\sum_{i=1}^{3} a_i \\epsilon_{kij} = \\sum_{i=1}^{3} \\epsilon_{kij} a_i\n$$\n表达式 $\\sum_{i=1}^{3} \\epsilon_{kij} a_i$ 是矩阵 $\\widehat{a}$ 的 $(k,j)$ 元的标准公式。这证实了我们的结果。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -a_{3}  a_{2} \\\\ a_{3}  0  -a_{1} \\\\ -a_{2}  a_{1}  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "掌握了代数结构后，本练习将带您实践李代数与李群之间的映射关系，即指数映射（罗德里格斯公式）及其逆运算。您将计算两个连续旋转的复合效果，并找出等效的单一旋转轴和旋转角，这是机器人学和航空航天领域中的一个常见任务。这个计算过程也直观地展示了三维旋转的非交换性。",
            "id": "3779363",
            "problem": "考虑李代数 $\\mathfrak{so}(3)$，它通过帽子映射 $\\,\\widehat{\\cdot} : \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ 与 $\\mathbb{R}^3$ 等同。对于 $a \\in \\mathbb{R}^3$，矩阵 $\\widehat{a}$ 的作用为叉积运算：对所有 $x \\in \\mathbb{R}^3$ 都有 $\\widehat{a}\\,x = a \\times x$。矩阵指数 $\\exp(\\widehat{a}) \\in \\mathrm{SO}(3)$ 属于特殊正交群 (SO(3))，表示一个旋转，其旋转轴为 $a/\\|a\\|$，旋转角为 $\\|a\\|$（以弧度为单位）。\n\n设 $a = (\\alpha,0,0)$，其中 $\\alpha = \\pi/3$，以及 $b=(0,\\beta,0)$，其中 $\\beta=\\pi/4$。使用罗德里格斯公式 (Rodrigues’ formula)，计算旋转矩阵 $R = \\exp(\\widehat{a})\\,\\exp(\\widehat{b})$。然后，通过匹配 $R$ 的迹和反对称部分，提取唯一的轴-角表示 $c = \\theta\\,n \\in \\mathbb{R}^3$，其中旋转角 $\\theta \\in (0,\\pi)$（以弧度为单位），$n \\in \\mathbb{S}^2$ 为单位旋转轴，使得 $R = \\exp(\\widehat{c})$。\n\n你的最终答案必须是单个轴-角向量 $c$，写成一个 $1 \\times 3$ 的行矩阵。角度用弧度表示，并提供精确的解析表达式（无数值近似）。",
            "solution": "问题要求解出与复合旋转 $R = \\exp(\\widehat{a})\\exp(\\widehat{b})$ 对应的轴-角向量 $c \\in \\mathbb{R}^3$，其中 $a = (\\alpha, 0, 0)$ 且 $\\alpha = \\pi/3$，$b = (0, \\beta, 0)$ 且 $\\beta = \\pi/4$。向量 $c$ 满足 $R = \\exp(\\widehat{c})$，其中 $c = \\theta n$，$\\theta \\in (0, \\pi)$ 是旋转角，$n \\in \\mathbb{S}^2$ 是单位旋转轴。\n\n解题过程分为三个步骤：\n1.  使用罗德里格斯公式计算单个旋转矩阵 $R_a = \\exp(\\widehat{a})$ 和 $R_b = \\exp(\\widehat{b})$。\n2.  计算复合旋转矩阵 $R = R_a R_b$。\n3.  通过分析 $R$ 的迹和反对称部分，从中提取轴-角向量 $c$。\n\n步骤 1：计算 $R_a$ 和 $R_b$\n\n罗德里格斯旋转公式给出了反对称矩阵 $\\widehat{v} \\in \\mathfrak{so}(3)$ 的矩阵指数：\n$$\n\\exp(\\widehat{v}) = I + \\frac{\\sin(\\|v\\|)}{\\|v\\|} \\widehat{v} + \\frac{1 - \\cos(\\|v\\|)}{\\|v\\|^2} \\widehat{v}^2\n$$\n其中 $I$ 是 $3 \\times 3$ 的单位矩阵。\n\n对于第一次旋转，向量为 $a = (\\pi/3, 0, 0)$。\n旋转角为 $\\theta_a = \\|a\\| = \\pi/3$。单位轴为 $n_a = a/\\|a\\| = (1, 0, 0)$。\n使用罗德里格斯公式，其中 $\\theta_a = \\alpha = \\pi/3$，$\\cos(\\alpha) = 1/2$，$\\sin(\\alpha) = \\sqrt{3}/2$，我们得到绕 x 轴的旋转矩阵：\n$$\nR_a = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos(\\alpha)  -\\sin(\\alpha) \\\\ 0  \\sin(\\alpha)  \\cos(\\alpha) \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1/2  -\\sqrt{3}/2 \\\\ 0  \\sqrt{3}/2  1/2 \\end{pmatrix}\n$$\n\n对于第二次旋转，向量为 $b = (0, \\pi/4, 0)$。\n旋转角为 $\\theta_b = \\|b\\| = \\beta = \\pi/4$。单位轴为 $n_b = b/\\|b\\| = (0, 1, 0)$。\n使用罗德里格斯公式，其中 $\\theta_b = \\beta = \\pi/4$，$\\cos(\\beta) = \\sqrt{2}/2$，$\\sin(\\beta) = \\sqrt{2}/2$，我们得到绕 y 轴的旋转矩阵：\n$$\nR_b = \\begin{pmatrix} \\cos(\\beta)  0  \\sin(\\beta) \\\\ 0  1  0 \\\\ -\\sin(\\beta)  0  \\cos(\\beta) \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2}/2  0  \\sqrt{2}/2 \\\\ 0  1  0 \\\\ -\\sqrt{2}/2  0  \\sqrt{2}/2 \\end{pmatrix}\n$$\n\n步骤 2：计算复合旋转 $R = R_a R_b$\n\n我们将两个矩阵相乘得到复合旋转矩阵 $R = R_a R_b$：\n$$\nR = \\begin{pmatrix} 1  0  0 \\\\ 0  1/2  -\\sqrt{3}/2 \\\\ 0  \\sqrt{3}/2  1/2 \\end{pmatrix} \\begin{pmatrix} \\sqrt{2}/2  0  \\sqrt{2}/2 \\\\ 0  1  0 \\\\ -\\sqrt{2}/2  0  \\sqrt{2}/2 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{2}}{2}  & 0  & \\frac{\\sqrt{2}}{2} \\\\ \\frac{\\sqrt{6}}{4}  & \\frac{1}{2}  & -\\frac{\\sqrt{6}}{4} \\\\ -\\frac{\\sqrt{2}}{4}  & \\frac{\\sqrt{3}}{2}  & \\frac{\\sqrt{2}}{4} \\end{pmatrix}\n$$\n\n步骤 3：从 $R$ 中提取轴-角向量 $c = \\theta n$\n\n旋转角 $\\theta$ 可以从旋转矩阵 $R$ 的迹中求出：\n$$\n\\mathrm{Tr}(R) = 1 + 2\\cos(\\theta)\n$$\n计算我们的矩阵 $R$ 的迹：\n$$\n\\mathrm{Tr}(R) = \\frac{\\sqrt{2}}{2} + \\frac{1}{2} + \\frac{\\sqrt{2}}{4} = \\frac{2\\sqrt{2} + 2 + \\sqrt{2}}{4} = \\frac{2 + 3\\sqrt{2}}{4}\n$$\n求解 $\\cos(\\theta)$：\n$$\n\\cos(\\theta) = \\frac{\\mathrm{Tr}(R) - 1}{2} = \\frac{\\frac{2 + 3\\sqrt{2}}{4} - 1}{2} = \\frac{\\frac{2 + 3\\sqrt{2} - 4}{4}}{2} = \\frac{3\\sqrt{2} - 2}{8}\n$$\n由于 $\\cos(\\theta) \\approx 0.28 > 0$，所以 $\\theta \\in (0, \\pi/2)$，这满足条件 $\\theta \\in (0, \\pi)$。角度为：\n$$\n\\theta = \\arccos\\left(\\frac{3\\sqrt{2} - 2}{8}\\right)\n$$\n旋转轴 $n$ 可以从 $R$ 的反对称部分求出：\n$$\n\\sin(\\theta)\\widehat{n} = \\frac{1}{2}(R - R^T)\n$$\n向量 $v = \\sin(\\theta)n$ 的分量可以通过 \"vee\" 映射提取：$(v_x, v_y, v_z) = (\\frac{1}{2}(R_{32}-R_{23}), \\frac{1}{2}(R_{13}-R_{31}), \\frac{1}{2}(R_{21}-R_{12}))$。\n$$\nv_x = \\frac{1}{2}\\left(\\frac{\\sqrt{3}}{2} - \\left(-\\frac{\\sqrt{6}}{4}\\right)\\right) = \\frac{1}{2}\\left(\\frac{2\\sqrt{3}+\\sqrt{6}}{4}\\right) = \\frac{2\\sqrt{3}+\\sqrt{6}}{8}\n$$\n$$\nv_y = \\frac{1}{2}\\left(\\frac{\\sqrt{2}}{2} - \\left(-\\frac{\\sqrt{2}}{4}\\right)\\right) = \\frac{1}{2}\\left(\\frac{2\\sqrt{2}+\\sqrt{2}}{4}\\right) = \\frac{3\\sqrt{2}}{8}\n$$\n$$\nv_z = \\frac{1}{2}\\left(\\frac{\\sqrt{6}}{4} - 0\\right) = \\frac{\\sqrt{6}}{8}\n$$\n所以向量 $v = \\sin(\\theta)n$ 是：\n$$\n\\sin(\\theta)n = \\frac{1}{8}\\left(2\\sqrt{3}+\\sqrt{6}, 3\\sqrt{2}, \\sqrt{6}\\right)\n$$\n轴-角向量为 $c = \\theta n$。我们可以将其写为 $c = \\frac{\\theta}{\\sin(\\theta)}(\\sin(\\theta)n)$。我们需要求出 $\\sin(\\theta)$：\n$$\n\\sin^2(\\theta) = 1 - \\cos^2(\\theta) = 1 - \\left(\\frac{3\\sqrt{2} - 2}{8}\\right)^2 = 1 - \\frac{18 - 12\\sqrt{2} + 4}{64} = 1 - \\frac{22 - 12\\sqrt{2}}{64} = \\frac{64 - 22 + 12\\sqrt{2}}{64} = \\frac{42 + 12\\sqrt{2}}{64}\n$$\n由于 $\\theta \\in (0, \\pi)$，$\\sin(\\theta) > 0$，所以：\n$$\n\\sin(\\theta) = \\frac{\\sqrt{42 + 12\\sqrt{2}}}{8}\n$$\n现在我们可以组合出最终的向量 $c$：\n$$\nc = \\frac{\\theta}{\\sin(\\theta)}(\\sin(\\theta)n) = \\frac{\\arccos\\left(\\frac{3\\sqrt{2} - 2}{8}\\right)}{\\frac{\\sqrt{42 + 12\\sqrt{2}}}{8}} \\cdot \\frac{1}{8}\\left(2\\sqrt{3}+\\sqrt{6}, 3\\sqrt{2}, \\sqrt{6}\\right)\n$$\n$$\nc = \\frac{\\arccos\\left(\\frac{3\\sqrt{2} - 2}{8}\\right)}{\\sqrt{42 + 12\\sqrt{2}}} \\left(2\\sqrt{3}+\\sqrt{6}, 3\\sqrt{2}, \\sqrt{6}\\right)\n$$\n这就是轴-角向量 $c$ 的最终精确解析表达式。\n注意到向量 $(2\\sqrt{3}+\\sqrt{6}, 3\\sqrt{2}, \\sqrt{6})$ 的范数平方是 $(2\\sqrt{3}+\\sqrt{6})^2 + (3\\sqrt{2})^2 + (\\sqrt{6})^2 = (12+6+4\\sqrt{18}) + 18 + 6 = 18+12\\sqrt{2} + 18 + 6 = 42+12\\sqrt{2}$，这与我们为 $\\sin^2(\\theta) \\cdot 64$ 计算的值是一致的。\n\n最终答案表示为一个 $1 \\times 3$ 的行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\arccos\\left(\\frac{3\\sqrt{2} - 2}{8}\\right)}{\\sqrt{42 + 12\\sqrt{2}}} (2\\sqrt{3}+\\sqrt{6})  \\frac{\\arccos\\left(\\frac{3\\sqrt{2} - 2}{8}\\right)}{\\sqrt{42 + 12\\sqrt{2}}} (3\\sqrt{2})  \\frac{\\arccos\\left(\\frac{3\\sqrt{2} - 2}{8}\\right)}{\\sqrt{42 + 12\\sqrt{2}}} (\\sqrt{6}) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "本练习将理论与数值计算相结合，探讨一个在动力学仿真中至关重要的高级应用。标准的数值积分方法（如欧拉法）在求解旋转运动时，往往会破坏旋转矩阵的正交性，导致误差累积和物理意义的丧失。此练习要求您设计并分析一种基于奇异值分解 (SVD) 的投影方法，以强制保持旋转矩阵的几何约束，从而确保仿真的长期稳定性与准确性。",
            "id": "3779340",
            "problem": "考虑特殊正交矩阵李群 $\\mathrm{SO}(3)$ 及其李代数 $\\mathfrak{so}(3)$，通过帽子映射 $\\,\\widehat{(\\cdot)}:\\mathbb{R}^3\\to\\mathfrak{so}(3)$ 将后者与 $\\mathbb{R}^3$ 等同。该映射对任意 $\\,\\omega,v\\in\\mathbb{R}^3$ 满足 $\\widehat{\\omega}\\,v=\\omega\\times v$。令 $\\,\\Omega(t)\\in\\mathfrak{so}(3)\\,$ 表示角速度，并考虑 $\\,R(t)\\in\\mathrm{SO}(3)$ 的运动学方程 $\\,\\dot{R}(t)=R(t)\\,\\Omega(t)\\,$。对于一个时间步长 $\\,h>0\\,$ 内的恒定角速度，从 $\\,t\\,$ 到 $\\,t+h\\,$ 的精确更新为 $\\,R(t+h)=R(t)\\,\\exp(h\\,\\Omega)\\,$，其中 $\\,\\exp:\\mathfrak{so}(3)\\to\\mathrm{SO}(3)\\,$ 是矩阵指数。\n\n在数值积分中，从 $\\,R(t)\\,$ 出发的一个一阶显式 Euler 步产生 $\\,\\widetilde{R}=R(t)+h\\,R(t)\\,\\Omega=R(t)\\,(I+h\\,\\Omega)\\,$。该结果通常违反正交性约束 $\\,\\widetilde{R}^\\top\\widetilde{R}=I\\,$，且其行列式可能不为 $\\,1$。一个到 $\\mathrm{SO}(3)$ 上的投影方法，旨在将 $\\,\\widetilde{R}\\,$ 映射到一个矩阵 $\\,R_{\\mathrm{proj}}\\in\\mathrm{SO}(3)\\,$，该矩阵在某个合适的范数下与 $\\,\\widetilde{R}\\,$ 最接近，并强制满足 $\\,R_{\\mathrm{proj}}^\\top R_{\\mathrm{proj}}=I\\,$ 和 $\\,\\det(R_{\\mathrm{proj}})=1\\,$。\n\n你的任务是：\n\n- 从第一性原理出发，推导一种投影方法：给定 $\\,\\widetilde{R}\\in\\mathbb{R}^{3\\times 3}\\,$，返回一个 $\\,R_{\\mathrm{proj}}\\in\\mathrm{SO}(3)\\,$，使得 $\\,\\|\\,\\widetilde{R}-R_{\\mathrm{proj}}\\,\\|_F\\,$ 最小化，同时满足约束 $\\,R_{\\mathrm{proj}}^\\top R_{\\mathrm{proj}}=I\\,$ 和 $\\,\\det(R_{\\mathrm{proj}})=1\\,$，其中 $\\,\\|\\cdot\\|_F\\,$ 表示 Frobenius 范数。证明这个最小化解等于通过 $\\,\\widetilde{R}=U\\,\\Sigma\\,V^\\top\\,$ 的奇异值分解（SVD）得到的 $\\,U\\,V^\\top\\,$，并做出调整，即在必要时通过翻转相应奇异向量的符号来强制使 $\\,\\det(U\\,V^\\top)\\,$ 为 $\\,1$。\n\n- 考虑在时间步长 $\\,h\\,$ 内，$\\,R(t)=I\\,$ 且 $\\,\\Omega=\\widehat{\\omega}\\,$（其中 $\\,\\omega\\in\\mathbb{R}^3\\,$ 为常数）的情况，建立该投影方法与指数映射之间的关系。使用到所需阶数的级数展开，证明在 $\\,\\mathrm{SO}(3)$ 的典范双不变黎曼度量下，投影后的 Euler 更新 $\\,R_{\\mathrm{proj}}(h)\\,$ 满足 $\\,R_{\\mathrm{proj}}(h)=\\exp(h\\,\\widehat{\\omega})+O(h^2)\\,$，并计算偏差的主阶项。\n\n- 在一个程序中实现以下内容：\n  1. 使用 Rodrigues 公式实现帽子映射 $\\,\\widehat{(\\cdot)}\\,$ 和指数映射 $\\,\\exp:\\mathfrak{so}(3)\\to\\mathrm{SO}(3)\\,$。角度必须以弧度计算和报告。\n  2. 实现上述推导的投影方法，并根据需要进行行列式校正。\n  3. 对每个测试用例，从 $\\,R(t)=I\\,$ 开始，计算 $\\,\\widetilde{R}=I+h\\,\\widehat{\\omega}\\,$，将其投影为 $\\,R_{\\mathrm{proj}}\\,$，并通过报告以下内容将其与 $\\,R_{\\mathrm{true}}=\\exp(h\\,\\widehat{\\omega})$进行比较：\n     - 投影前的正交性误差 $\\,\\|\\,\\widetilde{R}^\\top\\widetilde{R}-I\\,\\|_F$。\n     - 投影后的正交性误差 $\\,\\|\\,R_{\\mathrm{proj}}^\\top R_{\\mathrm{proj}}-I\\,\\|_F$。\n     - 测地线误差 $\\,d_{\\mathrm{SO(3)}}(R_{\\mathrm{proj}},R_{\\mathrm{true}})\\,$，定义为 $\\,R_{\\mathrm{proj}}^\\top R_{\\mathrm{true}}\\,$ 的旋转角（以弧度为单位）。\n     - 一个布尔值，指示不等式 $\\,|\\det(R_{\\mathrm{proj}})-1| < \\varepsilon\\,$ 是否对于容差 $\\varepsilon=10^{-12}$ 成立。\n\n- 角度必须是弧度。所有报告的浮点值均为实数。\n\n使用以下参数值测试套件，这些值被解释为 $\\,\\omega\\in\\mathbb{R}^3\\,$ 和步长 $\\,h>0$：\n\n- 测试用例 $\\,1$：$\\,\\omega=(0.3,-0.4,0.5)\\,$, $\\,h=0.1$。\n- 测试用例 $\\,2$：$\\,\\omega=(10^{-8},-2\\times 10^{-8},3\\times 10^{-8})\\,$, $\\,h=1.0$。\n- 测试用例 $\\,3$：$\\,\\omega=(2.0,3.0,-1.0)\\,$, $\\,h=0.5$。\n- 测试用例 $\\,4$：$\\,\\omega=(10.0,0.0,0.0)\\,$, $\\,h=\\pi/10$。\n\n你的程序应产生单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个测试用例贡献一个列表 $[\\,\\text{pre\\_orth\\_err},\\text{post\\_orth\\_err},\\text{geodesic\\_err},\\text{det\\_is\\_one}\\,]$。例如，输出格式必须是 $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],\\ldots]$，无任何附加文本。",
            "solution": "该问题是有效的，因为它在几何力学和数值分析方面有科学依据，是适定的、客观的、自洽的。所有组成部分都是标准且可验证的。\n\n### 第1部分：投影方法的推导\n\n第一个任务是找到一个矩阵 $R_{\\mathrm{proj}} \\in \\mathrm{SO}(3)$，它能最小化与给定矩阵 $\\widetilde{R} \\in \\mathbb{R}^{3\\times 3}$ 之差的 Frobenius 范数。优化问题是：\n$$\n\\min_{R \\in \\mathrm{SO}(3)} \\|\\widetilde{R} - R\\|_F^2\n$$\nFrobenius 范数的平方由 $\\|\\mathbf{A}\\|_F^2 = \\mathrm{tr}(\\mathbf{A}^\\top \\mathbf{A})$ 给出。我们可以展开目标函数：\n$$\n\\|\\widetilde{R} - R\\|_F^2 = \\mathrm{tr}\\left((\\widetilde{R} - R)^\\top (\\widetilde{R} - R)\\right) = \\mathrm{tr}(\\widetilde{R}^\\top \\widetilde{R} - \\widetilde{R}^\\top R - R^\\top \\widetilde{R} + R^\\top R)\n$$\n利用迹的线性性质，上式变为：\n$$\n\\|\\widetilde{R} - R\\|_F^2 = \\mathrm{tr}(\\widetilde{R}^\\top \\widetilde{R}) - \\mathrm{tr}(\\widetilde{R}^\\top R) - \\mathrm{tr}(R^\\top \\widetilde{R}) + \\mathrm{tr}(R^\\top R)\n$$\n由于 $R \\in \\mathrm{SO}(3)$，它是一个正交矩阵，所以 $R^\\top R = I$。迹为 $\\mathrm{tr}(I) = 3$。此外，$\\mathrm{tr}(R^\\top \\widetilde{R}) = \\mathrm{tr}((R^\\top \\widetilde{R})^\\top) = \\mathrm{tr}(\\widetilde{R}^\\top R)$。表达式化简为：\n$$\n\\|\\widetilde{R} - R\\|_F^2 = \\mathrm{tr}(\\widetilde{R}^\\top \\widetilde{R}) - 2\\mathrm{tr}(\\widetilde{R}^\\top R) + 3\n$$\n项 $\\mathrm{tr}(\\widetilde{R}^\\top \\widetilde{R})$ 是一个关于优化变量 $R$ 的常数。因此，最小化 $\\|\\widetilde{R} - R\\|_F^2$ 等价于最大化 $\\mathrm{tr}(\\widetilde{R}^\\top R)$。\n\n设 $\\widetilde{R}$ 的奇异值分解（SVD）为 $\\widetilde{R} = U\\Sigma V^\\top$，其中 $U, V \\in \\mathrm{O}(3)$ 是正交矩阵，$\\Sigma = \\mathrm{diag}(\\sigma_1, \\sigma_2, \\sigma_3)$ 是一个由非负奇异值组成的对角矩阵，按惯例排序为 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$。\n\n将 SVD 代入我们需要最大化的迹表达式中：\n$$\n\\mathrm{tr}(\\widetilde{R}^\\top R) = \\mathrm{tr}((U\\Sigma V^\\top)^\\top R) = \\mathrm{tr}(V\\Sigma U^\\top R)\n$$\n使用迹的循环性质 $\\mathrm{tr}(ABC) = \\mathrm{tr}(CAB)$：\n$$\n\\mathrm{tr}(V\\Sigma U^\\top R) = \\mathrm{tr}(\\Sigma U^\\top R V)\n$$\n我们定义一个新矩阵 $Z = U^\\top R V$。由于 $U$、$R$ 和 $V$ 都是正交的，所以 $Z$ 也是一个正交矩阵（$Z^\\top Z = V^\\top R^\\top U U^\\top R V = V^\\top R^\\top R V = V^\\top V = I$）。问题现在转化为在所有可以这样构成的正交矩阵 $Z$ 上最大化 $\\mathrm{tr}(\\Sigma Z)$。\n迹为 $\\mathrm{tr}(\\Sigma Z) = \\sum_{i=1}^3 \\sigma_i Z_{ii}$。由于 $Z$ 是正交的，其列向量是单位向量，这意味着 $|Z_{ii}| \\le 1$。为了最大化这个和，考虑到 $\\sigma_i \\ge 0$，我们应该使对角线元素 $Z_{ii}$ 尽可能大。当对所有 $i$ 都有 $Z_{ii}=1$ 时，即 $Z=I$ 时，达到最大值。\n\n如果我们选择 $Z=I$，那么 $U^\\top R V = I$，这意味着 $R = U I V^\\top = UV^\\top$。这个矩阵属于 $\\mathrm{O}(3)$，但我们需要满足约束 $R \\in \\mathrm{SO}(3)$，这要求 $\\det(R)=1$。\n我们来分析 $\\det(UV^\\top)$：$\\det(UV^\\top) = \\det(U)\\det(V^\\top) = \\det(U)\\det(V)$。从 SVD 得到的 $U$ 和 $V$ 的行列式可以是 $\\pm 1$。问题分为两种情况：\n\n情况1：$\\det(UV^\\top) = 1$。\n在这种情况下，我们的解 $R_{\\mathrm{proj}} = UV^\\top$ 已经属于 $\\mathrm{SO}(3)$。选择 $Z=I$ 是有效的，因为 $\\det(Z)=\\det(U^\\top R_{\\mathrm{proj}} V) = \\det(U^\\top)\\det(UV^\\top)\\det(V) = \\det(U)^{-1}(1)\\det(V) = \\det(U)\\det(V)=1$。所以 $R_{\\mathrm{proj}} = UV^\\top$ 是正确的最小化解。\n\n情况2：$\\det(UV^\\top) = -1$。\n我们之前的选择 $Z=I$ 是无效的，因为它会导致 $\\det(R_{\\mathrm{proj}})=-1$。我们必须在 $Z \\in \\mathrm{O}(3)$ 和 $\\det(Z) = \\det(U^\\top R V) = \\det(U^\\top)\\det(R)\\det(V) = \\det(U)\\det(V) = -1$ 的约束下，找到 $\\mathrm{tr}(\\Sigma Z)$ 的最大值。\n我们想要最大化 $\\sum_i \\sigma_i Z_{ii}$。由于 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$，为了最大化这个和，我们应该使 $Z_{ii}$ 尽可能大，但同时必须满足 $\\det(Z)=-1$。最优的选择是，将对应最大奇异值的对角线元素设为 $1$，并将对应最小奇异值的那个元素的符号翻转。我们选择 $Z = \\mathrm{diag}(1, 1, -1)$。这个矩阵是正交的，且行列式为 $-1$。迹的值为 $\\sigma_1 + \\sigma_2 - \\sigma_3$。在给定的约束下，这个迹是最大的。\n这个 $Z$ 的选择给出 $R_{\\mathrm{proj}} = U Z V^\\top = U \\mathrm{diag}(1, 1, -1) V^\\top$。我们来检查行列式：$\\det(R_{\\mathrm{proj}}) = \\det(U)\\det(\\mathrm{diag}(1,1,-1))\\det(V^\\top) = \\det(U)(-1)\\det(V) = -\\det(UV^\\top) = -(-1) = 1$。这个矩阵属于 $\\mathrm{SO}(3)$。\n\n一种对两种情况都适用的紧凑写法是：\n$$\nR_{\\mathrm{proj}} = U \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\det(UV^\\top) \\end{pmatrix} V^\\top.\n$$\n这个公式强制使结果矩阵属于 $\\mathrm{SO}(3)$，并且是在 Frobenius 范数下最接近 $\\widetilde{R}$ 的矩阵。对于 $\\widetilde{R} = I + h\\widehat{\\omega}$，我们有 $\\det(\\widetilde{R}) = \\det(I+h\\widehat{\\omega}) = 1 + h^2\\|\\omega\\|^2 > 0$。如果 $\\widetilde{R}$ 是非奇异的，那么 $\\det(\\widetilde{R}) = \\det(U)\\det(\\Sigma)\\det(V^\\top) = \\det(UV^\\top)\\prod\\sigma_i$。因此 $\\mathrm{sgn}(\\det(UV^\\top)) = \\mathrm{sgn}(\\det(\\widetilde{R}))$。对于 Euler 步，$\\det(\\widetilde{R})>0$，所以我们总是在情况1中，并且 $R_{\\mathrm{proj}} = UV^\\top$。\n\n### 第2部分：投影 Euler 方法的分析\n\n我们考虑从 $R(t)=I$ 出发，在恒定角速度 $\\omega$ 下的一个 Euler 步，因此 $\\Omega = \\widehat{\\omega}$。近似旋转为 $\\widetilde{R} = I + h \\widehat{\\omega}$。我们使用推导出的方法将此矩阵投影到 $\\mathrm{SO}(3)$ 上。结果 $R_{\\mathrm{proj}}$ 是 $\\widetilde{R}$ 的极分解的正交部分，可以计算为 $R_{\\mathrm{proj}} = \\widetilde{R} (\\widetilde{R}^\\top \\widetilde{R})^{-1/2}$。\n\n首先，我们计算 $\\widetilde{R}^\\top \\widetilde{R}$：\n$$\n\\widetilde{R}^\\top \\widetilde{R} = (I + h \\widehat{\\omega})^\\top (I + h \\widehat{\\omega}) = (I - h \\widehat{\\omega})(I + h \\widehat{\\omega}) = I - h^2 \\widehat{\\omega}^2.\n$$\n令 $\\phi = h\\|\\omega\\|$ 为步长 $h$ 内的总旋转角，$n = \\omega/\\|\\omega\\|$ 为归一化的旋转轴。那么 $h\\widehat{\\omega} = \\phi\\widehat{n}$。我们使用恒等式 $\\widehat{n}^2 = nn^\\top - I$。\n$$\n\\widetilde{R}^\\top \\widetilde{R} = I - \\phi^2 \\widehat{n}^2 = I - \\phi^2(nn^\\top - I) = (1+\\phi^2)I - \\phi^2 nn^\\top.\n$$\n矩阵 $S = (\\widetilde{R}^\\top \\widetilde{R})^{1/2}$ 与 $\\widetilde{R}^\\top \\widetilde{R}$ 具有相同的特征向量，即 $n$（特征值为 $1$）和任何与 $n$ 正交的向量（特征值为 $1+\\phi^2$）。$S$ 的特征值是这些值的平方根，即 $1$ 和 $\\sqrt{1+\\phi^2}$。所以，可以使用投影算子 $P_n = nn^\\top$ 将 $S$ 写为：\n$$\nS = 1 \\cdot P_n + \\sqrt{1+\\phi^2} \\cdot (I - P_n).\n$$\n它的逆是 $S^{-1} = 1 \\cdot P_n + \\frac{1}{\\sqrt{1+\\phi^2}} \\cdot (I - P_n)$。现在我们计算 $R_{\\mathrm{proj}} = \\widetilde{R} S^{-1}$：\n$$\nR_{\\mathrm{proj}} = (I + \\phi\\widehat{n}) \\left(P_n + \\frac{1}{\\sqrt{1+\\phi^2}}(I-P_n)\\right) = P_n + \\frac{I-P_n}{\\sqrt{1+\\phi^2}} + \\phi\\widehat{n}P_n + \\frac{\\phi\\widehat{n}(I-P_n)}{\\sqrt{1+\\phi^2}}.\n$$\n使用 $\\widehat{n}P_n=0$ 和 $\\widehat{n}(I-P_n) = \\widehat{n}$，我们得到：\n$$\nR_{\\mathrm{proj}} = P_n + \\frac{1}{\\sqrt{1+\\phi^2}}(I-P_n) + \\frac{\\phi}{\\sqrt{1+\\phi^2}}\\widehat{n}.\n$$\n这具有 Rodrigues 旋转公式的形式，$R = I + \\sin\\alpha \\widehat{n} + (1-\\cos\\alpha)\\widehat{n}^2$，重新整理为 $R = P_n + \\cos\\alpha (I-P_n) + \\sin\\alpha \\widehat{n}$。\n通过比较， $R_{\\mathrm{proj}}$ 的旋转角 $\\theta_{\\mathrm{proj}}$ 满足：$\\cos(\\theta_{\\mathrm{proj}}) = \\frac{1}{\\sqrt{1+\\phi^2}}$ 和 $\\sin(\\theta_{\\mathrm{proj}}) = \\frac{\\phi}{\\sqrt{1+\\phi^2}}$。这意味着 $\\tan(\\theta_{\\mathrm{proj}}) = \\phi$。所以，投影后旋转的角度是 $\\theta_{\\mathrm{proj}} = \\arctan(\\phi) = \\arctan(h\\|\\omega\\|)$。旋转轴是 $n = \\omega/\\|\\omega\\|$。\n\n真实解是 $R_{\\mathrm{true}} = \\exp(h\\widehat{\\omega})$，这是一个绕轴 $n$ 旋转角度 $\\theta_{\\mathrm{true}} = \\phi = h\\|\\omega\\|$ 的旋转。\n\n$\\mathrm{SO}(3)$ 上的测地距离 $d_{\\mathrm{SO(3)}}(R_1, R_2)$ 是相对旋转 $R_1^\\top R_2$ 的角度。由于 $R_{\\mathrm{proj}}$ 和 $R_{\\mathrm{true}}$ 共享相同的旋转轴 $n$，该距离就是它们旋转角度的绝对差值：\n$$\nd(R_{\\mathrm{proj}}, R_{\\mathrm{true}}) = |\\theta_{\\mathrm{true}} - \\theta_{\\mathrm{proj}}| = |\\phi - \\arctan(\\phi)|.\n$$\n使用 $\\arctan(\\phi) = \\phi - \\frac{\\phi^3}{3} + O(\\phi^5)$ 的 Taylor 级数，我们找到测地距离的主阶项：\n$$\nd(R_{\\mathrm{proj}}, R_{\\mathrm{true}}) = \\left|\\phi - \\left(\\phi - \\frac{\\phi^3}{3} + O(\\phi^5)\\right)\\right| = \\frac{\\phi^3}{3} + O(\\phi^5) = \\frac{1}{3}h^3\\|\\omega\\|^3 + O(h^5).\n$$\n这个误差是 $O(h^3)$，因此满足 $O(h^2)$ 的要求。\n偏差的主阶项是：\n$$\nR_{\\mathrm{proj}} - R_{\\mathrm{true}} = -\\frac{1}{3}h^3\\|\\omega\\|^2 \\widehat{\\omega} + O(h^4).\n$$\n\n### 第3部分：实现\n\n下面是生成答案所需的 Python 代码。\n```python\nimport numpy as np\nfrom scipy.linalg import svd\n\ndef hat(v):\n    \"\"\"\n    Computes the hat map of a vector v in R^3, mapping it to so(3).\n    \"\"\"\n    if v.shape != (3,):\n        raise ValueError(\"Input must be a 3-element vector.\")\n    return np.array([\n        [0, -v[2], v[1]],\n        [v[2], 0, -v[0]],\n        [-v[1], v[0], 0]\n    ])\n\ndef exp_so3(Omega):\n    \"\"\"\n    Computes the exponential map from so(3) to SO(3) using Rodrigues' formula.\n    Omega is a 3x3 skew-symmetric matrix.\n    \"\"\"\n    w = np.array([Omega[2, 1], Omega[0, 2], Omega[1, 0]])\n    theta = np.linalg.norm(w)\n    I = np.identity(3)\n\n    if theta  1e-12: # Handle small angles to avoid division by zero\n        # Taylor expansion: I + Omega + Omega^2/2\n        return I + Omega + 0.5 * (Omega @ Omega)\n    \n    K = Omega / theta\n    # Rodrigues' formula\n    R = I + np.sin(theta) * K + (1 - np.cos(theta)) * (K @ K)\n    return R\n\ndef project_to_so3(R_tilde):\n    \"\"\"\n    Projects a 3x3 matrix R_tilde to the closest matrix in SO(3)\n    in the Frobenius norm using SVD.\n    \"\"\"\n    U, _, Vt = svd(R_tilde)\n    R_proj = U @ Vt\n    \n    # Ensure the determinant is +1.\n    if np.linalg.det(R_proj)  0:\n        # Flip the sign of the last column of U\n        U_corr = U.copy()\n        U_corr[:, -1] *= -1\n        R_proj = U_corr @ Vt\n        \n    return R_proj\n\ndef get_geodesic_error(R1, R2):\n    \"\"\"\n    Computes the geodesic distance on SO(3) between two rotation matrices.\n    This is the angle of the relative rotation R1^T @ R2.\n    \"\"\"\n    R_rel = R1.T @ R2\n    # The trace of a rotation matrix is 1 + 2*cos(theta)\n    trace_val = np.trace(R_rel)\n    # Clip the argument to arccos to handle potential floating point inaccuracies\n    arg = np.clip((trace_val - 1.0) / 2.0, -1.0, 1.0)\n    angle = np.arccos(arg)\n    return angle\n\ndef solve():\n    test_cases = [\n        (np.array([0.3, -0.4, 0.5]), 0.1),\n        (np.array([1e-8, -2e-8, 3e-8]), 1.0),\n        (np.array([2.0, 3.0, -1.0]), 0.5),\n        (np.array([10.0, 0.0, 0.0]), np.pi / 10.0),\n    ]\n\n    results = []\n    det_tolerance = 1e-12\n\n    for omega, h in test_cases:\n        Omega = hat(omega)\n        R_tilde = np.identity(3) + h * Omega\n        R_true = exp_so3(h * Omega)\n        pre_orth_err = np.linalg.norm((R_tilde.T @ R_tilde) - np.identity(3), 'fro')\n        R_proj = project_to_so3(R_tilde)\n        post_orth_err = np.linalg.norm((R_proj.T @ R_proj) - np.identity(3), 'fro')\n        geodesic_err = get_geodesic_error(R_proj, R_true)\n        det_is_one = abs(np.linalg.det(R_proj) - 1.0)  det_tolerance\n\n        case_results = [\n            pre_orth_err,\n            post_orth_err,\n            geodesic_err,\n            det_is_one\n        ]\n        results.append(case_results)\n\n    output_str = \"[\"\n    for i, res_list in enumerate(results):\n        res_list_str = [f\"{v:.15e}\" if isinstance(v, float) else str(v).lower() for v in res_list]\n        output_str += f\"[{','.join(res_list_str)}]\"\n        if i  len(results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    \n    return output_str\n```",
            "answer": "[[7.071067811865474e-02,2.220446049250313e-16,8.838834764831809e-05,true],[4.472135954999579e-15,0.000000000000000e+00,9.930136611370252e-24,true],[2.692582403790103e+00,4.440892098500626e-16,3.013589926442655e-01,true],[6.283185307179587e+00,6.661338147750939e-16,1.028169994338525e+00,true]]"
        }
    ]
}