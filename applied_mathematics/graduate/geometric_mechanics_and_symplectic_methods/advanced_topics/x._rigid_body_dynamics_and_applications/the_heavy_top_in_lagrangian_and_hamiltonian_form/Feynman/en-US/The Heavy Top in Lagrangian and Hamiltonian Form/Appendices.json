{
    "hands_on_practices": [
        {
            "introduction": "To study the dynamics of the heavy top, we must first establish a clear kinematic description. This practice guides you through the essential first step: translating the abstract orientation of the top, parameterized by Euler angles, into the physically meaningful body angular velocity $\\Omega$. Mastering this connection between the configuration manifold $\\mathrm{SO}(3)$ and its tangent space is fundamental to correctly formulating the kinetic energy, a cornerstone of both the Lagrangian and Hamiltonian approaches. ",
            "id": "3777105",
            "problem": "Consider the rigid heavy top whose attitude is represented by an element $R \\in \\mathrm{SO}(3)$, the Special Orthogonal Group (SO(3)), mapping body-frame vectors to space-frame vectors according to $v_{\\mathrm{space}} = R\\,v_{\\mathrm{body}}$. Let $R(\\phi,\\theta,\\psi)$ be parameterized by the $Z\\!Y\\!Z$ Euler angles $(\\phi,\\theta,\\psi)$, where $\\phi$ is a rotation about the space $z$-axis, followed by $\\theta$ about the intermediate $y$-axis, followed by $\\psi$ about the final body $z$-axis. All angles are measured in radians.\n\nStarting from first principles in geometric mechanics and symplectic methods, do the following:\n\n1. Using only the definition of $Z\\!Y\\!Z$ Euler angles as successive active rotations, derive the explicit $3\\times 3$ attitude matrix $R(\\phi,\\theta,\\psi)$ as a product of elementary rotations about the $z$- and $y$-axes. Your derivation should start from standard rotation matrices and proceed by matrix multiplication to obtain the entries of $R(\\phi,\\theta,\\psi)$.\n\n2. Define the body angular velocity $\\Omega \\in \\mathbb{R}^{3}$ via the left-trivialized Maurer–Cartan form on $\\mathrm{SO}(3)$, namely the skew-symmetric matrix relation $\\widehat{\\Omega} = R^{\\top}\\dot{R}$, where the “hat” map $\\widehat{(\\cdot)} : \\mathbb{R}^{3} \\to \\mathfrak{so}(3)$ associates a vector with its corresponding skew-symmetric matrix. Use this definition, together with the product rule and the properties of elementary rotations, to compute the three components of $\\Omega$ in the body frame in terms of $(\\dot{\\phi},\\dot{\\theta},\\dot{\\psi})$ and $(\\phi,\\theta,\\psi)$.\n\nExplain each step of your derivations, beginning from the foundational definitions of rotation matrices and the Maurer–Cartan form on $\\mathrm{SO}(3)$, and justify why the expressions you obtain are consistent with the structure of the heavy top in both Lagrangian and Hamiltonian form (for instance, the role of $\\Omega$ in the kinetic energy and of $R$ in the gravitational potential). Express your final answer for the three components of $\\Omega$ as a single symbolic expression. No numerical evaluation is required, and no rounding is needed. The angles are in radians, and angular velocities are in radians per second; do not include units in the final boxed expression.",
            "solution": "This problem is a standard and well-posed exercise in classical rigid body mechanics, formulated in the language of geometric mechanics. All definitions and conditions are standard and self-consistent. The problem is scientifically grounded, objective, and complete. Therefore, it is deemed valid and a full solution is provided below.\n\nThe solution is presented in two parts as requested by the problem statement. First, the rotation matrix $R$ is derived from the definition of $Z\\!Y\\!Z$ Euler angles. Second, the body angular velocity vector $\\Omega$ is derived using the provided Maurer-Cartan form. Finally, a brief discussion connects these results to the Lagrangian formulation of the heavy top.\n\n**Part 1: Derivation of the Attitude Matrix $R(\\phi,\\theta,\\psi)$**\n\nThe problem specifies that the orientation of the top is given by a sequence of three active rotations, parameterized by the $Z\\!Y\\!Z$ Euler angles $(\\phi, \\theta, \\psi)$. An active rotation transforms the object itself within a fixed coordinate system. The sequence is:\n1.  A rotation by an angle $\\phi$ about the space $z$-axis ($Z$).\n2.  A rotation by an angle $\\theta$ about the new, intermediate $y$-axis ($Y'$).\n3.  A rotation by an angle $\\psi$ about the final body $z$-axis ($Z''$).\n\nThis sequence of rotations corresponds to a total rotation matrix $R$ that is a product of elementary rotation matrices. Let $R_k(\\alpha)$ denote a rotation by an angle $\\alpha$ about the $k$-axis. The elementary rotation matrices about the $y$- and $z$-axes are:\n$$R_y(\\alpha) = \\begin{pmatrix} \\cos\\alpha  0  \\sin\\alpha \\\\ 0  1  0 \\\\ -\\sin\\alpha  0  \\cos\\alpha \\end{pmatrix}, \\quad R_z(\\alpha) = \\begin{pmatrix} \\cos\\alpha  -\\sin\\alpha  0 \\\\ \\sin\\alpha  \\cos\\alpha  0 \\\\ 0  0  1 \\end{pmatrix}$$\nThe composite rotation for the specified sequence of mixed body- and space-fixed rotations is equivalent to a sequence of intrinsic rotations (rotations about the moving body axes) taken in the same order, but applied via right-multiplication, or a sequence of extrinsic rotations (rotations about the fixed space axes) taken in the reverse order. A more direct construction shows that the total rotation matrix $R$ that maps body-frame vectors to space-frame vectors is given by the product:\n$$R(\\phi,\\theta,\\psi) = R_z(\\phi) R_y(\\theta) R_z(\\psi)$$\nWe perform this matrix multiplication step-by-step. First, we compute the product of the second and third rotations:\n$$R_y(\\theta) R_z(\\psi) = \\begin{pmatrix} \\cos\\theta  0  \\sin\\theta \\\\ 0  1  0 \\\\ -\\sin\\theta  0  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} \\cos\\psi  -\\sin\\psi  0 \\\\ \\sin\\psi  \\cos\\psi  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta\\cos\\psi  -\\cos\\theta\\sin\\psi  \\sin\\theta \\\\ \\sin\\psi  \\cos\\psi  0 \\\\ -\\sin\\theta\\cos\\psi  \\sin\\theta\\sin\\psi  \\cos\\theta \\end{pmatrix}$$\nNext, we pre-multiply this result by the first rotation matrix, $R_z(\\phi)$:\n$$R(\\phi,\\theta,\\psi) = \\begin{pmatrix} \\cos\\phi  -\\sin\\phi  0 \\\\ \\sin\\phi  \\cos\\phi  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta\\cos\\psi  -\\cos\\theta\\sin\\psi  \\sin\\theta \\\\ \\sin\\psi  \\cos\\psi  0 \\\\ -\\sin\\theta\\cos\\psi  \\sin\\theta\\sin\\psi  \\cos\\theta \\end{pmatrix}$$\nCarrying out the multiplication yields the final explicit form of the attitude matrix $R$:\n$$R(\\phi,\\theta,\\psi) = \\begin{pmatrix} \\cos\\phi\\cos\\theta\\cos\\psi - \\sin\\phi\\sin\\psi  -\\cos\\phi\\cos\\theta\\sin\\psi - \\sin\\phi\\cos\\psi  \\cos\\phi\\sin\\theta \\\\ \\sin\\phi\\cos\\theta\\cos\\psi + \\cos\\phi\\sin\\psi  -\\sin\\phi\\cos\\theta\\sin\\psi + \\cos\\phi\\cos\\psi  \\sin\\phi\\sin\\theta \\\\ -\\sin\\theta\\cos\\psi  \\sin\\theta\\sin\\psi  \\cos\\theta \\end{pmatrix}$$\nThis completes the derivation for the first part of the problem.\n\n**Part 2: Derivation of the Body Angular Velocity $\\Omega$**\n\nThe body angular velocity vector $\\Omega \\in \\mathbb{R}^3$ is defined through the left-trivialized Maurer–Cartan form, $\\widehat{\\Omega} = R^{\\top}\\dot{R}$. The \"hat\" map $\\widehat{(\\cdot)}$ is the isomorphism from $\\mathbb{R}^3$ to the Lie algebra $\\mathfrak{so}(3)$ of skew-symmetric $3 \\times 3$ matrices, where for a vector $v=(v_1, v_2, v_3)^\\top$,\n$$\\widehat{v} = \\begin{pmatrix} 0  -v_3  v_2 \\\\ v_3  0  -v_1 \\\\ -v_2  v_1  0 \\end{pmatrix}$$\nWe start by computing the time derivative of $R = R_z(\\phi) R_y(\\theta) R_z(\\psi)$. Using the product rule for differentiation:\n$$\\dot{R} = \\frac{d}{dt}(R_z(\\phi) R_y(\\theta) R_z(\\psi)) = \\dot{R_z}(\\phi) R_y(\\theta) R_z(\\psi) + R_z(\\phi) \\dot{R_y}(\\theta) R_z(\\psi) + R_z(\\phi) R_y(\\theta) \\dot{R_z}(\\psi)$$\nNow substitute this into the expression for $\\widehat{\\Omega}$:\n$$\\widehat{\\Omega} = R^{\\top}\\dot{R} = (R_z(\\psi)^{\\top}R_y(\\theta)^{\\top}R_z(\\phi)^{\\top}) (\\dot{R_z}(\\phi) R_y(\\theta) R_z(\\psi) + R_z(\\phi) \\dot{R_y}(\\theta) R_z(\\psi) + R_z(\\phi) R_y(\\theta) \\dot{R_z}(\\psi))$$\nDistributing $R^\\top$ and using the orthogonality property $R^\\top R = I$, we get three terms:\n$$ \\widehat{\\Omega} = R_z(\\psi)^{\\top}R_y(\\theta)^{\\top} (R_z(\\phi)^{\\top}\\dot{R_z}(\\phi)) R_y(\\theta) R_z(\\psi) + R_z(\\psi)^{\\top} (R_y(\\theta)^{\\top}\\dot{R_y}(\\theta)) R_z(\\psi) + (R_z(\\psi)^{\\top}\\dot{R_z}(\\psi)) $$\nFor any elementary rotation $R_k(\\alpha)$, the matrix $R_k^{\\top}\\dot{R}_k$ is a skew-symmetric matrix representing the angular velocity of that single rotation in its own frame. Specifically, if $e_1, e_2, e_3$ are the standard basis vectors:\n$$R_z(\\phi)^{\\top}\\dot{R_z}(\\phi) = \\dot{\\phi} \\widehat{e_3}, \\quad R_y(\\theta)^{\\top}\\dot{R_y}(\\theta) = \\dot{\\theta} \\widehat{e_2}, \\quad R_z(\\psi)^{\\top}\\dot{R_z}(\\psi) = \\dot{\\psi} \\widehat{e_3}$$\nSubstituting these into the expression for $\\widehat{\\Omega}$:\n$$ \\widehat{\\Omega} = \\dot{\\phi} \\, R_z(\\psi)^{\\top}R_y(\\theta)^{\\top} \\widehat{e_3} R_y(\\theta) R_z(\\psi) + \\dot{\\theta} \\, R_z(\\psi)^{\\top} \\widehat{e_2} R_z(\\psi) + \\dot{\\psi} \\, \\widehat{e_3} $$\nWe use the adjoint transformation property for skew-symmetric matrices, $Q^{\\top}\\widehat{v}Q = \\widehat{Q^{\\top}v}$ for any $Q \\in \\mathrm{SO}(3)$ and $v \\in \\mathbb{R}^3$. Applying this property to each term:\n\\begin{align*} \\dot{\\phi} \\, R_z(\\psi)^{\\top}R_y(\\theta)^{\\top} \\widehat{e_3} R_y(\\theta) R_z(\\psi) = \\dot{\\phi} \\, (R_y(\\theta)R_z(\\psi))^{\\top} \\widehat{e_3} (R_y(\\theta)R_z(\\psi)) = \\widehat{\\dot{\\phi} (R_y(\\theta)R_z(\\psi))^{\\top} e_3} \\\\ \\dot{\\theta} \\, R_z(\\psi)^{\\top} \\widehat{e_2} R_z(\\psi) = \\widehat{\\dot{\\theta} R_z(\\psi)^{\\top} e_2} \\\\ \\dot{\\psi} \\, \\widehat{e_3} = \\widehat{\\dot{\\psi} e_3} \\end{align*}\nSumming these gives $\\widehat{\\Omega} = \\widehat{ \\dot{\\phi} (R_y(\\theta)R_z(\\psi))^{\\top} e_3 + \\dot{\\theta} R_z(\\psi)^{\\top} e_2 + \\dot{\\psi} e_3 }$.\nBy the isomorphism of the hat map, the body angular velocity vector $\\Omega$ is:\n$$ \\Omega = \\dot{\\phi} (R_y(\\theta)R_z(\\psi))^{\\top} e_3 + \\dot{\\theta} R_z(\\psi)^{\\top} e_2 + \\dot{\\psi} e_3 $$\nWe now compute the vector terms:\n$$ R_z(\\psi)^{\\top} e_2 = \\begin{pmatrix} \\cos\\psi  \\sin\\psi  0 \\\\ -\\sin\\psi  \\cos\\psi  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sin\\psi \\\\ \\cos\\psi \\\\ 0 \\end{pmatrix} $$\n$$ (R_y(\\theta)R_z(\\psi))^{\\top} e_3 = R_z(\\psi)^{\\top}R_y(\\theta)^{\\top} e_3 = R_z(\\psi)^{\\top} \\begin{pmatrix} -\\sin\\theta \\\\ 0 \\\\ \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} \\cos\\psi  \\sin\\psi  0 \\\\ -\\sin\\psi  \\cos\\psi  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ 0 \\\\ \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} -\\sin\\theta\\cos\\psi \\\\ \\sin\\theta\\sin\\psi \\\\ \\cos\\theta \\end{pmatrix} $$\nSubstituting these vectors back into the expression for $\\Omega$:\n$$ \\Omega = \\dot{\\phi} \\begin{pmatrix} -\\sin\\theta\\cos\\psi \\\\ \\sin\\theta\\sin\\psi \\\\ \\cos\\theta \\end{pmatrix} + \\dot{\\theta} \\begin{pmatrix} \\sin\\psi \\\\ \\cos\\psi \\\\ 0 \\end{pmatrix} + \\dot{\\psi} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\nThis yields the three components of the body angular velocity vector $\\Omega = (\\Omega_1, \\Omega_2, \\Omega_3)^{\\top}$:\n\\begin{align*} \\Omega_1 = \\dot{\\theta}\\sin\\psi - \\dot{\\phi}\\sin\\theta\\cos\\psi \\\\ \\Omega_2 = \\dot{\\theta}\\cos\\psi + \\dot{\\phi}\\sin\\theta\\sin\\psi \\\\ \\Omega_3 = \\dot{\\psi} + \\dot{\\phi}\\cos\\theta \\end{align*}\n\n**Consistency with Lagrangian and Hamiltonian Formulations**\n\nThe derived expressions for $R$ and $\\Omega$ are fundamental inputs for the Lagrangian formulation of the heavy top.\nThe kinetic energy $T$ of a rigid body is expressed in the body frame as $T = \\frac{1}{2}\\Omega^{\\top} I \\Omega$, where $I$ is the constant body-frame inertia tensor. For an axisymmetric top, $I = \\mathrm{diag}(I_1, I_1, I_3)$, and the kinetic energy becomes $T = \\frac{1}{2}I_1(\\Omega_1^2 + \\Omega_2^2) + \\frac{1}{2}I_3 \\Omega_3^2$. Substituting our derived expressions for $\\Omega_i$ in terms of Euler angle rates $(\\dot{\\phi}, \\dot{\\theta}, \\dot{\\psi})$ gives the kinetic energy as a function on the tangent bundle of the configuration manifold.\n\nThe gravitational potential energy $V$ depends on the height of the center of mass. Let the pivot point be at the origin, the gravitational acceleration be $-g e_3^{\\mathrm{space}}$, and the center of mass be at position $\\ell = l e_3^{\\mathrm{body}}$ in the body frame. The potential energy is $V = mg (R \\ell) \\cdot e_3^{\\mathrm{space}} = mgl (R e_3^{\\mathrm{body}}) \\cdot e_3^{\\mathrm{space}}$. This dot product is simply the $(3,3)$ component of the rotation matrix $R$, which we found to be $R_{33} = \\cos\\theta$. Thus, $V = mgl\\cos\\theta$.\n\nThe Lagrangian is $L = T-V = L(\\theta, \\dot{\\phi}, \\dot{\\theta}, \\dot{\\psi})$. The Lagrangian explicitly depends on $\\theta$ but not on $\\phi$ or $\\psi$. These are cyclic coordinates, leading to two conserved quantities: the canonical momenta $p_{\\phi} = \\frac{\\partial L}{\\partial \\dot{\\phi}}$ and $p_{\\psi} = \\frac{\\partial L}{\\partial \\dot{\\psi}}$. These conserved quantities correspond to the vertical component of the angular momentum and the component of angular momentum along the top's symmetry axis, respectively. This structure is the starting point for solving the equations of motion for the heavy top, confirming that our derived quantities are consistent with and central to the problem's physical description.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\dot{\\theta}\\sin\\psi - \\dot{\\phi}\\sin\\theta\\cos\\psi \\\\ \\dot{\\theta}\\cos\\psi + \\dot{\\phi}\\sin\\theta\\sin\\psi \\\\ \\dot{\\psi} + \\dot{\\phi}\\cos\\theta \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With the kinematic relationship between Euler angle rates and angular velocity established, we can now construct the Lagrangian, the master function that governs the heavy top's motion. This exercise involves deriving the kinetic energy from the angular velocity and the potential energy from the top's orientation in the gravitational field. By assembling the Lagrangian $L = T - V$ and identifying its symmetries through cyclic variables, you lay the groundwork for solving the equations of motion and understanding the system's conserved quantities. ",
            "id": "3777089",
            "problem": "Consider a rigid body (heavy top) with a single fixed point and a symmetry axis aligned with the body-fixed unit vector $e_3$. Let the body have principal moments of inertia $I_1 = I_2 = I$ and $I_3$ about the fixed point, mass $m$, and center of mass located at a constant distance $l$ along $e_3$ from the fixed point. The body's orientation relative to an inertial frame is represented by a rotation matrix $R \\in SO(3)$, where $SO(3)$ denotes the Special Orthogonal Group. Use the $Z$-$X$-$Z$ Euler angle convention so that $R = R_z(\\phi) R_x(\\theta) R_z(\\psi)$, where $(\\phi,\\theta,\\psi)$ are measured in radians and $\\dot{\\phi}$, $\\dot{\\theta}$, $\\dot{\\psi}$ denote their time derivatives. Gravity acts in the inertial frame along the space-fixed unit vector $e_3$, with gravitational acceleration $g$.\n\nStarting from fundamental principles:\n- The rotational kinetic energy about the fixed point is $T = \\frac{1}{2} \\Omega^{\\mathsf{T}} \\mathbb{I} \\Omega$, where $\\Omega$ is the angular velocity expressed in the body frame and $\\mathbb{I} = \\mathrm{diag}(I,I,I_3)$ is the inertia tensor in the body frame.\n- The gravitational potential energy is $V = m g h$, where $h$ is the vertical height of the center of mass measured along the space-fixed $e_3$ axis.\n\nDerive an explicit expression, in closed form, for the Lagrangian $L(\\phi,\\theta,\\psi,\\dot{\\phi},\\dot{\\theta},\\dot{\\psi}) = T - V$ in terms of the Euler angles and their time derivatives. In addition, identify any cyclic variables and state the assumption(s) under which they are cyclic.\n\nProvide your final answer as the single closed-form analytic expression for $L(\\phi,\\theta,\\psi,\\dot{\\phi},\\dot{\\theta},\\dot{\\psi})$. Do not include any identification of cyclic variables in the final boxed answer.",
            "solution": "The problem requires the derivation of the Lagrangian for a heavy symmetric top, followed by the identification of any cyclic variables. The problem statement is validated as scientifically grounded, well-posed, and objective. It represents a standard problem in classical mechanics. For clarity in the derivation, the space-fixed unit vector for the direction of gravity will be denoted as $\\mathbf{E}_3$, and the body-fixed unit vector along the symmetry axis will be denoted as $\\mathbf{e}_3$. The corresponding basis vectors for the space frame are $\\{\\mathbf{E}_1, \\mathbf{E}_2, \\mathbf{E}_3\\}$ and for the body frame are $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$.\n\nThe Lagrangian is defined as $L = T - V$, where $T$ is the kinetic energy and $V$ is the potential energy. We must express both $T$ and $V$ in terms of the generalized coordinates $(\\phi, \\theta, \\psi)$ and their time derivatives $(\\dot{\\phi}, \\dot{\\theta}, \\dot{\\psi})$.\n\n**1. Kinetic Energy, $T$**\n\nThe rotational kinetic energy is given by $T = \\frac{1}{2} \\mathbf{\\Omega}^{\\mathsf{T}} \\mathbb{I} \\mathbf{\\Omega}$, where $\\mathbf{\\Omega} = (\\Omega_1, \\Omega_2, \\Omega_3)^{\\mathsf{T}}$ is the angular velocity vector expressed in the body frame, and $\\mathbb{I}$ is the diagonal inertia tensor in the body frame, $\\mathbb{I} = \\mathrm{diag}(I, I, I_3)$. The expression for $T$ is therefore:\n$$\nT = \\frac{1}{2} (I\\Omega_1^2 + I\\Omega_2^2 + I_3\\Omega_3^2) = \\frac{1}{2} I (\\Omega_1^2 + \\Omega_2^2) + \\frac{1}{2} I_3 \\Omega_3^2\n$$\nWe need to find the components of $\\mathbf{\\Omega}$ in terms of the Euler angles and their time derivatives. The angular velocity vector $\\mathbf{\\Omega}$ can be derived from the rotation matrix $R$ via the relation $\\hat{\\Omega} = R^{\\mathsf{T}} \\dot{R}$, where the hat map `ˆ` converts a vector into a skew-symmetric matrix. The vector $\\mathbf{\\Omega}$ is recovered from $\\hat{\\Omega}$ by the inverse operation $(\\cdot)^\\vee$.\n\nThe total rotation is given as $R = R_z(\\phi) R_x(\\theta) R_z(\\psi)$. The total angular velocity is the sum of contributions from each Euler rate: a rotation at rate $\\dot{\\phi}$ about the space axis $\\mathbf{E}_3$, a rotation at rate $\\dot{\\theta}$ about the line of nodes (the new $x$-axis), and a rotation at rate $\\dot{\\psi}$ about the body axis $\\mathbf{e}_3$. To find the components in the body frame, we must project these angular velocity vectors onto the body-frame basis $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$.\n\nA standard derivation for the $ZXZ$ convention yields the following components for the angular velocity vector $\\mathbf{\\Omega}$ in the body frame:\n$$\n\\Omega_1 = \\dot{\\phi}\\sin\\theta\\sin\\psi + \\dot{\\theta}\\cos\\psi\n$$\n$$\n\\Omega_2 = \\dot{\\phi}\\sin\\theta\\cos\\psi - \\dot{\\theta}\\sin\\psi\n$$\n$$\n\\Omega_3 = \\dot{\\phi}\\cos\\theta + \\dot{\\psi}\n$$\nNow, we compute the term $\\Omega_1^2 + \\Omega_2^2$:\n$$\n\\Omega_1^2 = \\dot{\\phi}^2\\sin^2\\theta\\sin^2\\psi + \\dot{\\theta}^2\\cos^2\\psi + 2\\dot{\\phi}\\dot{\\theta}\\sin\\theta\\sin\\psi\\cos\\psi\n$$\n$$\n\\Omega_2^2 = \\dot{\\phi}^2\\sin^2\\theta\\cos^2\\psi + \\dot{\\theta}^2\\sin^2\\psi - 2\\dot{\\phi}\\dot{\\theta}\\sin\\theta\\cos\\psi\\sin\\psi\n$$\n$$\n\\Omega_1^2 + \\Omega_2^2 = \\dot{\\phi}^2\\sin^2\\theta(\\sin^2\\psi + \\cos^2\\psi) + \\dot{\\theta}^2(\\cos^2\\psi + \\sin^2\\psi) = \\dot{\\phi}^2\\sin^2\\theta + \\dot{\\theta}^2\n$$\nSubstituting this into the expression for $T$:\n$$\nT = \\frac{1}{2} I (\\dot{\\phi}^2\\sin^2\\theta + \\dot{\\theta}^2) + \\frac{1}{2} I_3 (\\dot{\\phi}\\cos\\theta + \\dot{\\psi})^2\n$$\n\n**2. Potential Energy, $V$**\n\nThe potential energy is $V = mgh$, where $h$ is the vertical height of the center of mass. The center of mass is located at a distance $l$ along the body's symmetry axis $\\mathbf{e}_3$. Its position vector in the body frame is $\\mathbf{r}_{cm,B} = (0, 0, l)^{\\mathsf{T}}$.\n\nTo find the height $h$, we need the vertical component of the center of mass position vector in the space frame, $\\mathbf{r}_{cm,S}$. The transformation is $\\mathbf{r}_{cm,S} = R \\mathbf{r}_{cm,B}$. The vertical direction is along $\\mathbf{E}_3$. Thus, $h = \\mathbf{r}_{cm,S} \\cdot \\mathbf{E}_3 = (R \\mathbf{r}_{cm,B}) \\cdot \\mathbf{E}_3$.\n$$\nh = \\left( R \\begin{pmatrix} 0 \\\\ 0 \\\\ l \\end{pmatrix} \\right) \\cdot \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = l \\left( R_{31} \\cdot 0 + R_{32} \\cdot 0 + R_{33} \\cdot 1 \\right) = l R_{33}\n$$\nWe need the $(3,3)$ component of the matrix $R = R_z(\\phi) R_x(\\theta) R_z(\\psi)$.\n$$\nR_z(\\psi) = \\begin{pmatrix} \\cos\\psi  -\\sin\\psi  0 \\\\ \\sin\\psi  \\cos\\psi  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\nR_x(\\theta) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos\\theta  -\\sin\\theta \\\\ 0  \\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\n$$\nR_z(\\phi) = \\begin{pmatrix} \\cos\\phi  -\\sin\\phi  0 \\\\ \\sin\\phi  \\cos\\phi  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe product is $R = (R_z(\\phi) R_x(\\theta)) R_z(\\psi)$. The $(3,3)$ entry of $R_z(\\phi) R_x(\\theta)$ is $\\cos\\theta$. Since $R_z(\\psi)$ has $(0,0,1)$ as its third row and column, the $(3,3)$ entry of the final product $R$ is simply $\\cos\\theta$.\nThus, $h = l \\cos\\theta$. The potential energy is:\n$$\nV = mgl \\cos\\theta\n$$\n\n**3. Lagrangian and Cyclic Variables**\n\nCombining the expressions for $T$ and $V$, the Lagrangian $L = T - V$ is:\n$$\nL(\\phi,\\theta,\\psi,\\dot{\\phi},\\dot{\\theta},\\dot{\\psi}) = \\frac{1}{2} I (\\dot{\\phi}^2\\sin^2\\theta + \\dot{\\theta}^2) + \\frac{1}{2} I_3 (\\dot{\\phi}\\cos\\theta + \\dot{\\psi})^2 - mgl \\cos\\theta\n$$\nA coordinate $q_k$ is cyclic if the Lagrangian does not depend explicitly on it, i.e., $\\frac{\\partial L}{\\partial q_k} = 0$.\nBy inspection of the Lagrangian expression:\n- The coordinate $\\phi$ does not appear explicitly, so $\\frac{\\partial L}{\\partial \\phi} = 0$. Thus, $\\phi$ is a cyclic variable.\n- The coordinate $\\psi$ does not appear explicitly, so $\\frac{\\partial L}{\\partial \\psi} = 0$. Thus, $\\psi$ is a cyclic variable.\n- The coordinate $\\theta$ appears in several terms ($\\sin^2\\theta$, $\\cos\\theta$). $\\frac{\\partial L}{\\partial \\theta} \\neq 0$, so $\\theta$ is not cyclic.\n\nThe assumptions given in the problem lead to the existence of these cyclic variables:\n- The cyclic nature of $\\phi$ is a consequence of the symmetry of the system (both kinetic and potential energy) with respect to rotations about the vertical space axis $\\mathbf{E}_3$. This holds because the gravitational field is assumed to be uniform and vertical.\n- The cyclic nature of $\\psi$ is a consequence of the axial symmetry of the top. The kinetic energy's independence from $\\psi$ is due to the equality of the principal moments of inertia $I_1 = I_2 = I$. The potential energy's independence from $\\psi$ is due to the center of mass lying on the symmetry axis $\\mathbf{e}_3$.",
            "answer": "$$\n\\boxed{\\frac{1}{2} I (\\dot{\\phi}^2\\sin^2\\theta + \\dot{\\theta}^2) + \\frac{1}{2} I_3 (\\dot{\\phi}\\cos\\theta + \\dot{\\psi})^2 - mgl \\cos\\theta}\n$$"
        },
        {
            "introduction": "The power of the Lagrangian and Hamiltonian frameworks lies in their systematic identification of conserved quantities. This practice delves into the physical interpretation of one of the heavy top's key invariants, the Casimir invariant $C_{2} = \\Pi \\cdot \\Gamma$, which is conserved due to the underlying geometric structure of the problem. By examining the force-free limit ($g \\to 0$) where the heavy top becomes a free rigid body (Euler top), you will uncover the profound connection between this abstract quantity and the conservation of spatial angular momentum, providing deep physical intuition. ",
            "id": "3777130",
            "problem": "Consider a rigid body with a fixed point subject to a uniform gravitational field, known as the heavy top. Let the configuration be described by a rotation matrix $R \\in \\mathrm{SO}(3)$, the Special Orthogonal group in three dimensions, mapping body coordinates to spatial coordinates. Denote the body angular velocity by $\\Omega \\in \\mathbb{R}^{3}$, the body angular momentum by $\\Pi = \\mathbb{I}\\Omega \\in \\mathbb{R}^{3}$ where $\\mathbb{I}$ is the positive-definite inertia tensor, the fixed spatial direction of gravity by $\\mathbf{e} \\in \\mathbb{R}^{3}$ with $|\\mathbf{e}|=1$, and the body-frame unit vector from the fixed point to the center of mass by $\\chi \\in \\mathbb{R}^{3}$ with $|\\chi|=1$. Let $\\Gamma = R^{\\top}\\mathbf{e}$ denote the gravity direction expressed in the body frame. The heavy top reduced Hamiltonian is given by\n$$\nH_{g}(\\Pi,\\Gamma) = \\frac{1}{2}\\,\\Pi \\cdot \\mathbb{I}^{-1}\\Pi - m g \\ell\\,\\Gamma \\cdot \\chi,\n$$\nwhere $m$ is the mass of the body, $g$ is the gravitational acceleration, and $\\ell$ is the distance from the fixed point to the center of mass. On the dual of the Lie algebra of the Special Euclidean group in three dimensions, $\\mathfrak{se}(3)^{*}$, with variables $(\\Pi,\\Gamma)\\in\\mathbb{R}^{3}\\times\\mathbb{R}^{3}$, the Lie–Poisson bracket for smooth functions $F,G$ is\n$$\n\\{F,G\\}(\\Pi,\\Gamma) = -\\Pi \\cdot \\big(\\nabla_{\\Pi}F \\times \\nabla_{\\Pi}G\\big) - \\Gamma \\cdot \\big(\\nabla_{\\Pi}F \\times \\nabla_{\\Gamma}G + \\nabla_{\\Gamma}F \\times \\nabla_{\\Pi}G\\big).\n$$\nFrom this structure, the heavy top equations of motion are\n$$\n\\dot{\\Pi} = \\Pi \\times \\Omega - m g \\ell\\,\\Gamma \\times \\chi,\\qquad \\dot{\\Gamma} = \\Gamma \\times \\Omega,\\qquad \\Omega = \\mathbb{I}^{-1}\\Pi.\n$$\nThese equations preserve the Casimir invariants $C_{1}(\\Pi,\\Gamma) = \\frac{1}{2}|\\Gamma|^{2}$ and $C_{2}(\\Pi,\\Gamma) = \\Pi \\cdot \\Gamma$. For the free rigid body (Euler top), the gravitational acceleration is set to zero, $g \\to 0$, and the Hamiltonian reduces to $H_{0}(\\Pi) = \\frac{1}{2}\\,\\Pi \\cdot \\mathbb{I}^{-1}\\Pi$ with equations $\\dot{\\Pi} = \\Pi \\times \\Omega$, $\\dot{R} = R\\,\\Omega^{\\times}$, where $\\Omega^{\\times}$ is the skew-symmetric matrix such that $\\Omega^{\\times}v = \\Omega \\times v$ for all $v \\in \\mathbb{R}^{3}$.\n\nStarting from these definitions and structures, derive how the conserved quantity $C_{2} = \\Pi \\cdot \\Gamma$ in the heavy top relates to conservation laws in the Euler top as $g \\to 0$. In particular, identify the conserved quantity in the $g \\to 0$ limit associated to an arbitrary fixed spatial unit vector $\\mathbf{e} \\in \\mathbb{R}^{3}$ expressed in terms of the spatial angular momentum vector $\\mathbf{L} = R\\Pi$. Express your final answer as a single symbolic expression without units.",
            "solution": "The problem requires us to relate the Casimir invariant $C_{2}(\\Pi,\\Gamma) = \\Pi \\cdot \\Gamma$ of the heavy top system to a conserved quantity of the free rigid body (Euler top) in the limit of zero gravitational acceleration, $g \\to 0$. The resulting quantity should be expressed in terms of the spatial angular momentum vector $\\mathbf{L}$.\n\nFirst, we validate the problem statement.\nThe problem provides a standard and correct formulation of the heavy top within the framework of geometric mechanics.\n- **Givens**: The configuration space is $\\mathrm{SO}(3)$. The phase space variables are the body angular momentum $\\Pi \\in \\mathbb{R}^3$ and the body-frame gravity vector $\\Gamma \\in \\mathbb{R}^3$. The Hamiltonian $H_{g}(\\Pi,\\Gamma)$, Lie-Poisson bracket $\\{F,G\\}$, equations of motion, and Casimir invariants $C_{1}$ and $C_{2}$ are all standard definitions for the heavy top on the dual of the Lie algebra $\\mathfrak{se}(3)^*$. The relationships between body-frame and spatial-frame quantities are correctly defined: $\\mathbf{L} = R\\Pi$ for the spatial angular momentum and $\\Gamma = R^{\\top}\\mathbf{e}$ for the body-frame gravity vector, where $R \\in \\mathrm{SO}(3)$ is the rotation from body to spatial coordinates and $\\mathbf{e}$ is a fixed spatial vector.\n- **Validation**: The problem is scientifically grounded, well-posed, and objective. It is a standard exercise in advanced classical mechanics connecting the description of a system with external forces (heavy top) to its force-free limit (Euler top). The provided information is complete and consistent. The question asks for a specific derivation and expression, which can be obtained through logical steps. Therefore, the problem is valid.\n\nWe now proceed with the derivation.\n\nThe conserved quantity in question is the Casimir invariant $C_{2}$:\n$$\nC_{2}(\\Pi,\\Gamma) = \\Pi \\cdot \\Gamma\n$$\nThis quantity is conserved for the heavy top dynamics for any value of $g$, including the limit $g \\to 0$, which corresponds to the Euler top. Our goal is to express this quantity using spatial-frame variables, namely the spatial angular momentum $\\mathbf{L}$ and the fixed spatial vector $\\mathbf{e}$.\n\nThe problem provides the definitions relating the body-frame variables $(\\Pi, \\Gamma)$ to the spatial-frame variables $(\\mathbf{L}, \\mathbf{e})$ via the rotation matrix $R \\in \\mathrm{SO}(3)$:\n1. The spatial angular momentum $\\mathbf{L}$ is related to the body angular momentum $\\Pi$ by $\\mathbf{L} = R\\Pi$.\n2. The body-frame gravity vector $\\Gamma$ is related to the fixed spatial gravity vector $\\mathbf{e}$ by $\\Gamma = R^{\\top}\\mathbf{e}$.\n\nFrom the first relation, we can express the body angular momentum $\\Pi$ in terms of the spatial angular momentum $\\mathbf{L}$. Since $R$ is a special orthogonal matrix, its inverse is its transpose, i.e., $R^{-1} = R^{\\top}$.\n$$\n\\mathbf{L} = R\\Pi \\implies R^{\\top}\\mathbf{L} = R^{\\top}R\\Pi = \\mathbb{I}_{3}\\Pi = \\Pi\n$$\nwhere $\\mathbb{I}_{3}$ is the $3 \\times 3$ identity matrix. Thus, we have $\\Pi = R^{\\top}\\mathbf{L}$.\n\nNow, we substitute the expressions for $\\Pi$ and $\\Gamma$ into the formula for $C_{2}$:\n$$\nC_{2} = \\Pi \\cdot \\Gamma = (R^{\\top}\\mathbf{L}) \\cdot (R^{\\top}\\mathbf{e})\n$$\nThe dot product is invariant under orthogonal transformations. This means for any two vectors $u, v \\in \\mathbb{R}^3$ and any orthogonal matrix $A$, we have $(Au) \\cdot (Av) = u \\cdot v$. To see this explicitly, we can write the dot product using matrix transposition:\n$$\n(A u) \\cdot (A v) = (A u)^{\\top}(A v) = (u^{\\top}A^{\\top})(A v) = u^{\\top}(A^{\\top}A)v\n$$\nSince $A$ is an orthogonal matrix, $A^{\\top}A = \\mathbb{I}_{3}$. Therefore,\n$$\nu^{\\top}(\\mathbb{I}_{3})v = u^{\\top}v = u \\cdot v\n$$\nIn our case, the orthogonal matrix is $R^{\\top}$ (the transpose of an orthogonal matrix is also orthogonal). Applying this property to our expression for $C_2$:\n$$\nC_{2} = (R^{\\top}\\mathbf{L}) \\cdot (R^{\\top}\\mathbf{e}) = \\mathbf{L} \\cdot \\mathbf{e}\n$$\nThis shows that the conserved quantity $C_{2} = \\Pi \\cdot \\Gamma$ is identical to the scalar quantity $\\mathbf{L} \\cdot \\mathbf{e}$ when expressed in spatial coordinates.\n\nFor the Euler top ($g \\to 0$), there are no external torques acting on the rigid body. By Noether's theorem, this rotational symmetry of space implies the conservation of total angular momentum. In the spatial frame, this means the spatial angular momentum vector $\\mathbf{L}$ is constant in time:\n$$\n\\frac{d\\mathbf{L}}{dt} = \\mathbf{0}\n$$\nThe vector $\\mathbf{e}$ is defined as a fixed spatial unit vector. Therefore, its time derivative is also zero. The time derivative of our derived quantity is:\n$$\n\\frac{d}{dt}(\\mathbf{L} \\cdot \\mathbf{e}) = \\frac{d\\mathbf{L}}{dt} \\cdot \\mathbf{e} + \\mathbf{L} \\cdot \\frac{d\\mathbf{e}}{dt} = \\mathbf{0} \\cdot \\mathbf{e} + \\mathbf{L} \\cdot \\mathbf{0} = 0\n$$\nThis confirms that $\\mathbf{L} \\cdot \\mathbf{e}$ is indeed a conserved quantity for the Euler top. It represents the component of the conserved spatial angular momentum vector along an arbitrary fixed direction in space.\n\nIn summary, the Casimir invariant $C_2$ from the heavy top formulation, which is conserved regardless of the value of $g$, corresponds directly to the projection of the spatial angular momentum vector $\\mathbf{L}$ onto the fixed spatial direction $\\mathbf{e}$. In the $g \\to 0$ limit, this becomes a component of the conserved total angular momentum of the free rigid body.\n\nThe final answer is the expression for this conserved quantity in terms of $\\mathbf{L}$ and $\\mathbf{e}$.",
            "answer": "$$\n\\boxed{\\mathbf{L} \\cdot \\mathbf{e}}\n$$"
        }
    ]
}