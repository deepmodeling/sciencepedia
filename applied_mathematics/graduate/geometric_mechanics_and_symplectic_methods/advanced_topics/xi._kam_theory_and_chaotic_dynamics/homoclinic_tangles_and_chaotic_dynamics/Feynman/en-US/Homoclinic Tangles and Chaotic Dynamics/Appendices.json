{
    "hands_on_practices": [
        {
            "introduction": "Many complex continuous-time Hamiltonian systems can be understood by studying a simplified discrete-time map, known as a Poincaré map. This exercise  focuses on one of the most famous examples, the Chirikov standard map, derived from a periodically kicked rotor. By explicitly constructing this map and computing its Jacobian, you will directly verify its symplectic nature, a fundamental property ensuring the conservation of phase-space area and underpinning the rich, conservative chaos it exhibits.",
            "id": "3746892",
            "problem": "Consider the periodically kicked rotor in canonical coordinates $(q,p) \\in \\mathbb{R} \\times \\mathbb{R}$ with time-periodic Hamiltonian\n$$\nH(q,p,t) = \\frac{p^{2}}{2} + \\kappa \\cos(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n),\n$$\nwhere $\\kappa \\in \\mathbb{R}$ is a parameter and $\\delta(\\cdot)$ is the Dirac delta distribution. Let $\\Phi_{\\kappa}$ denote the Poincaré map that advances the state from just after one kick to just after the next kick (i.e., stroboscopic sampling with period $1$). Work in canonical coordinates with the canonical symplectic matrix\n$$\nJ = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}.\n$$\nStarting from Hamilton's equations and the definition of the Poincaré map, derive the explicit form of $\\Phi_{\\kappa}$ as a composition of a kick and a drift over one unit of time, compute the Jacobian matrix $D\\Phi_{\\kappa}(q,p)$ at a general point $(q,p)$, and determine its Jacobian determinant. Then verify symplecticity by checking the condition $D\\Phi_{\\kappa}(q,p)^{T} J \\, D\\Phi_{\\kappa}(q,p) = J$ for all $(q,p)$. \n\nReport the value of the Jacobian determinant $ \\det(D\\Phi_{\\kappa}(q,p)) $ as your final answer, expressed as a single closed-form analytic expression in simplest form. No numerical rounding is required, and no units are involved.",
            "solution": "The problem requires the derivation and analysis of the Poincaré map for a periodically kicked rotor, a canonical model in Hamiltonian dynamics. We will validate the problem setup, derive the map, compute its Jacobian, and verify its symplectic nature.\n\nFirst, we begin with the provided time-dependent Hamiltonian:\n$$\nH(q,p,t) = \\frac{p^{2}}{2} + \\kappa \\cos(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n)\n$$\nThe dynamics of the system are governed by Hamilton's equations:\n$$\n\\dot{q} = \\frac{\\partial H}{\\partial p} \\quad \\text{and} \\quad \\dot{p} = -\\frac{\\partial H}{\\partial q}\n$$\nSubstituting the Hamiltonian, we obtain:\n$$\n\\dot{q} = p\n$$\n$$\n\\dot{p} = \\kappa \\sin(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n)\n$$\nThe Poincaré map $\\Phi_{\\kappa}$ advances the state $(q,p)$ from a time $t = n^{+}$ (just after the $n$-th kick) to $t = (n+1)^{+}$ (just after the $(n+1)$-th kick). This evolution over one time period, from $t \\in [n^{+}, (n+1)^{+}]$, consists of two distinct parts: a \"free drift\" for $t \\in (n, n+1)$ and an instantaneous \"kick\" at $t = n+1$.\n\nLet $(q_n, p_n)$ be the state at $t=n^{+}$. We will track its evolution to find $(q_{n+1}, p_{n+1})$ at $t=(n+1)^{+}$.\n\n1.  **Free Drift:** For $t \\in (n, n+1)$, the term with the Dirac delta distribution vanishes. The Hamiltonian simplifies to $H_{drift} = \\frac{p^2}{2}$. The corresponding Hamilton's equations are:\n    $$\n    \\dot{q} = p\n    $$\n    $$\n    \\dot{p} = 0\n    $$\n    Integrating these equations from $t=n^{+}$ to $t=(n+1)^{-}$ over a time interval of duration $1$ gives the state $(\\tilde{q}, \\tilde{p})$ just before the next kick:\n    $$\n    \\int_{p_n}^{\\tilde{p}} dp' = \\int_{n^{+}}^{(n+1)^{-}} 0 \\, dt' \\implies \\tilde{p} = p_n\n    $$\n    Since $p$ is constant during this interval, we have:\n    $$\n    \\int_{q_n}^{\\tilde{q}} dq' = \\int_{n^{+}}^{(n+1)^{-}} p(t') \\, dt' = \\int_{n^{+}}^{(n+1)^{-}} p_n \\, dt' = p_n \\cdot 1 \\implies \\tilde{q} = q_n + p_n\n    $$\n    Thus, the drift map, let's call it $D_1$, transforms $(q_n, p_n)$ to $(\\tilde{q}, \\tilde{p}) = (q_n + p_n, p_n)$.\n\n2.  **Kick:** At the discrete time $t = n+1$, the kick term is active. We integrate Hamilton's equations across the infinitesimal interval $[(n+1)^{-}, (n+1)^{+}]$.\n    For the coordinate $q$, the change is:\n    $$\n    q_{n+1} - \\tilde{q} = \\int_{(n+1)^{-}}^{(n+1)^{+}} p(t') \\, dt'\n    $$\n    Since the kick is instantaneous and $p(t)$ does not contain a delta function, the momentum $p$ remains bounded during the kick. Therefore, the integral over an infinitesimal duration vanishes, implying $q_{n+1} = \\tilde{q}$.\n    For the momentum $p$, the change is:\n    $$\n    p_{n+1} - \\tilde{p} = \\int_{(n+1)^{-}}^{(n+1)^{+}} \\kappa \\sin(q(t')) \\delta(t' - (n+1)) \\, dt'\n    $$\n    Since $q(t)$ is continuous across the kick ($q((n+1)^{+}) = q((n+1)^{-}) = \\tilde{q}$), we can evaluate $\\sin(q(t'))$ at $t'=n+1$:\n    $$\n    p_{n+1} - \\tilde{p} = \\kappa \\sin(\\tilde{q})\n    $$\n    This gives $p_{n+1} = \\tilde{p} + \\kappa \\sin(\\tilde{q})$. The kick map, let's call it $K_{\\kappa}$, transforms $(\\tilde{q}, \\tilde{p})$ to $(q_{n+1}, p_{n+1}) = (\\tilde{q}, \\tilde{p} + \\kappa \\sin(\\tilde{q}))$.\n\n3.  **Poincaré Map $\\Phi_{\\kappa}$:** The full Poincaré map is the composition of the drift and the kick: $\\Phi_{\\kappa} = K_{\\kappa} \\circ D_1$. Let $(q', p') = \\Phi_{\\kappa}(q,p)$.\n    Starting with $(q, p)$, the drift $D_1$ yields $(q+p, p)$.\n    Applying the kick $K_{\\kappa}$ to this intermediate state gives:\n    $$\n    q' = q+p\n    $$\n    $$\n    p' = p + \\kappa \\sin(q+p)\n    $$\n    This is the explicit form of the Poincaré map, often called the Chirikov standard map.\n\nNext, we compute the Jacobian matrix $D\\Phi_{\\kappa}(q,p)$ of the map $\\Phi_{\\kappa}(q,p) = (q'(q,p), p'(q,p))$.\n$$\nD\\Phi_{\\kappa}(q,p) = \\begin{pmatrix} \\frac{\\partial q'}{\\partial q} & \\frac{\\partial q'}{\\partial p} \\\\ \\frac{\\partial p'}{\\partial q} & \\frac{\\partial p'}{\\partial p} \\end{pmatrix}\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial q'}{\\partial q} = \\frac{\\partial}{\\partial q}(q+p) = 1\n$$\n$$\n\\frac{\\partial q'}{\\partial p} = \\frac{\\partial}{\\partial p}(q+p) = 1\n$$\n$$\n\\frac{\\partial p'}{\\partial q} = \\frac{\\partial}{\\partial q}(p + \\kappa \\sin(q+p)) = \\kappa \\cos(q+p)\n$$\n$$\n\\frac{\\partial p'}{\\partial p} = \\frac{\\partial}{\\partial p}(p + \\kappa \\sin(q+p)) = 1 + \\kappa \\cos(q+p)\n$$\nSo, the Jacobian matrix is:\n$$\nD\\Phi_{\\kappa}(q,p) = \\begin{pmatrix} 1 & 1 \\\\ \\kappa \\cos(q+p) & 1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\nWe can now compute its determinant:\n$$\n\\det(D\\Phi_{\\kappa}(q,p)) = (1)(1 + \\kappa \\cos(q+p)) - (1)(\\kappa \\cos(q+p))\n$$\n$$\n\\det(D\\Phi_{\\kappa}(q,p)) = 1 + \\kappa \\cos(q+p) - \\kappa \\cos(q+p) = 1\n$$\nThe Jacobian determinant of the map is $1$ for all $(q,p)$ and any $\\kappa$. This result is a manifestation of Liouville's theorem for Hamiltonian systems, which states that phase space volume is conserved under Hamiltonian flow. Maps derived from Hamiltonian systems are area-preserving, which corresponds to the Jacobian determinant being unity.\n\nFinally, we verify that the map is symplectic. A map is symplectic if its Jacobian matrix $M = D\\Phi_{\\kappa}$ satisfies the condition $M^T J M = J$, where $J = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$ is the canonical symplectic matrix.\nThe transpose of the Jacobian is:\n$$\nM^T = \\begin{pmatrix} 1 & \\kappa \\cos(q+p) \\\\ 1 & 1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\nWe compute the product $M^T J M$:\n$$\nM^T J = \\begin{pmatrix} 1 & \\kappa \\cos(q+p) \\\\ 1 & 1 + \\kappa \\cos(q+p) \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} = \\begin{pmatrix} -\\kappa \\cos(q+p) & 1 \\\\ -1 - \\kappa \\cos(q+p) & 1 \\end{pmatrix}\n$$\n$$\n(M^T J) M = \\begin{pmatrix} -\\kappa \\cos(q+p) & 1 \\\\ -1 - \\kappa \\cos(q+p) & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ \\kappa \\cos(q+p) & 1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\nLet's compute the components of the resulting matrix product:\n- Element $(1,1)$: $(-\\kappa \\cos(q+p))(1) + (1)(\\kappa \\cos(q+p)) = 0$\n- Element $(1,2)$: $(-\\kappa \\cos(q+p))(1) + (1)(1 + \\kappa \\cos(q+p)) = 1$\n- Element $(2,1)$: $(-1 - \\kappa \\cos(q+p))(1) + (1)(\\kappa \\cos(q+p)) = -1$\n- Element $(2,2)$: $(-1 - \\kappa \\cos(q+p))(1) + (1)(1 + \\kappa \\cos(q+p)) = 0$\nThe result is:\n$$\nM^T J M = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} = J\n$$\nThe condition is satisfied, confirming that the Poincaré map $\\Phi_{\\kappa}$ is indeed a symplectic transformation for all points $(q,p)$ in the phase space. The problem asks for the Jacobian determinant as the final answer.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "The hallmark of chaos is sensitive dependence on initial conditions, where nearby trajectories diverge exponentially. The maximal Lyapunov exponent provides a precise measure of this divergence rate. In this computational practice , you will develop an algorithm to numerically estimate this exponent for the standard map, connecting the abstract theory of the homoclinic tangle to a tangible, quantitative diagnostic of chaotic behavior.",
            "id": "3746886",
            "problem": "Consider the two-dimensional, area-preserving Chirikov standard map on the two-torus defined by angles in radians, given by a smooth map $F_{K} : \\mathbb{T}^{2} \\to \\mathbb{T}^{2}$ depending on a real parameter $K > 0$. The two-torus $\\mathbb{T}^{2}$ is identified with the square $[-\\pi,\\pi) \\times [-\\pi,\\pi)$ with the edges identified. The map acts on a state $(x,y)$ with both $x$ and $y$ treated as angles in radians, and all iterates are taken modulo $2\\pi$ in both components.\n\nYou are to start from first principles of geometric mechanics and symplectic methods: the definition of the derivative cocycle of a smooth map, the properties of area-preserving diffeomorphisms, and the Multiplicative Ergodic Theorem (Oseledets theorem) for smooth dynamical systems. Using these, formulate the definition of the maximal Lyapunov exponent for a $C^{1}$ area-preserving map on $\\mathbb{T}^{2}$ and deduce the constraint that the sum of Lyapunov exponents along any orbit is zero for such a map. Then, focusing on the hyperbolic fixed point at $(x,y)=(0,0)$ for $K>0$, argue how its stable and unstable manifolds generate a homoclinic tangle, and explain why orbits initiated near the unstable manifold of $(0,0)$ are naturally confined to the homoclinic tangle for a finite time. Based on this, construct a computational procedure to estimate the finite-time maximal Lyapunov exponent along orbits confined to the tangle.\n\nYour program must implement the following tasks in a scientifically sound and self-consistent way:\n\n- Implement the map $F_{K}$ on $\\mathbb{T}^{2}$, ensuring angle variables are always wrapped into $[-\\pi,\\pi)$ after each iterate, and all trigonometric functions interpret angles in radians.\n\n- Derive the Jacobian matrix $DF_{K}(x,y)$ of the map at a point $(x,y)$ by differentiating the map with respect to $(x,y)$, and verify that its determinant equals $1$ at every point, consistent with area preservation. Use this Jacobian to build the derivative cocycle along an orbit.\n\n- Using the eigenstructure of $DF_{K}(0,0)$, compute a unit unstable eigenvector associated with the eigenvalue larger than $1$ at $(0,0)$ for $K>0$. Initialize several nearby initial conditions along this unstable direction at small distances $\\delta$ (treated as angle displacements in radians) from $(0,0)$ to obtain orbits that begin on the unstable side of the homoclinic tangle.\n\n- Define a confinement region intended to approximate the local homoclinic tangle near $(0,0)$ by bounding both the wrapped coordinates: require $|x| \\le r_{x}$ and $|y| \\le r_{y}$, with $x,y \\in [-\\pi,\\pi)$, where $r_{x}$ and $r_{y}$ are positive thresholds given in radians. Only accumulate Lyapunov growth while the orbit remains inside this region, and stop accumulating once it leaves the region or after a maximum number of iterates $N_{\\max}$.\n\n- Estimate the finite-time maximal Lyapunov exponent along the confined segment by iterating a tangent vector with the Jacobians along the orbit, normalizing at each step to prevent overflow, and averaging the instantaneous growth rates. Average the exponent estimates over several small initial displacements $\\delta$ along the unstable eigenvector to reduce sensitivity to the exact initial condition.\n\nYour program must produce numerical estimates of the finite-time maximal Lyapunov exponent for the following parameter test suite:\n$$\\{10^{-6},\\, 0.5,\\, 1.0,\\, 2.0,\\, 4.0,\\, 6.0\\}.$$\nUse three initial offsets $\\delta \\in \\{10^{-8},\\, 5 \\cdot 10^{-8},\\, 10^{-7}\\}$ radians along the unstable eigenvector at $(0,0)$ and average the results for each $K$. Use confinement thresholds $r_{x} = 1.0$ and $r_{y} = 1.0$ radians, and a maximum of $N_{\\max} = 5000$ iterates per initial condition. All angles must be treated and reported in radians, and all computations should be performed with double-precision floating-point arithmetic.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the parameter test suite, for example:\n$$[\\lambda(K_{1}),\\lambda(K_{2}),\\ldots,\\lambda(K_{6})],$$\nwhere each entry is a floating-point number. No additional text, spaces, or units should be printed beyond this single-line format. If an orbit leaves the confinement region immediately (in zero steps), the exponent for that initial condition must be treated as $0$ for averaging purposes. The final outputs must be in pure floating-point numbers without any percentage signs or angle-unit annotations.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the established theory of Hamiltonian dynamics and chaos, well-posed with a clear and achievable computational objective, and devoid of subjective or ambiguous language. The \"Chirikov standard map\" is a canonical model, and its standard definition will be assumed.\n\nThe problem requires a formulation of the finite-time maximal Lyapunov exponent for the Chirikov standard map, focusing on orbits initiated near the hyperbolic fixed point at the origin. This will be accomplished by following the principles of geometric mechanics and the theory of dynamical systems.\n\nThe Chirikov standard map $F_{K} : \\mathbb{T}^{2} \\to \\mathbb{T}^{2}$ is a discrete-time dynamical system on the two-torus, parameterized by a real number $K > 0$. We identify the torus $\\mathbb{T}^{2}$ with the square $[-\\pi, \\pi) \\times [-\\pi, \\pi)$. A point on the torus is represented by coordinates $(x, y)$, which are angles in radians. The standard map is given by:\n$$\n\\begin{align*}\ny_{n+1} &= y_n + K \\sin(x_n) \\\\\nx_{n+1} &= x_n + y_{n+1}\n\\end{align*}\n$$\nAfter each application of the map, the coordinates are wrapped to remain in the interval $[-\\pi, \\pi)$. Let $p_n = (x_n, y_n)$. Then the map can be written as $p_{n+1} = F_K(p_n)$.\n\n**1. Area-Preserving Property and Symplectic Structure**\n\nA map is area-preserving if the determinant of its Jacobian matrix is unity. The Jacobian matrix $DF_K(p)$ of the map $F_K$ at a point $p=(x,y)$ describes the linear transformation of infinitesimal vectors in the tangent space at $p$. Let $p' = (x', y') = F_K(x,y)$. The components are $y' = y + K \\sin(x)$ and $x' = x+y' = x + y + K \\sin(x)$. The Jacobian is:\n$$\nDF_K(x,y) = \\begin{pmatrix} \\frac{\\partial x'}{\\partial x} & \\frac{\\partial x'}{\\partial y} \\\\ \\frac{\\partial y'}{\\partial x} & \\frac{\\partial y'}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 1 + K \\cos(x) & 1 \\\\ K \\cos(x) & 1 \\end{pmatrix}\n$$\nThe determinant of this matrix is:\n$$\n\\det(DF_K(x,y)) = (1 + K \\cos(x))(1) - (1)(K \\cos(x)) = 1 + K \\cos(x) - K \\cos(x) = 1\n$$\nSince the determinant is $1$ for all points $(x,y)$ and any parameter $K$, the Chirikov standard map is an area-preserving diffeomorphism. This is a key property of symplectic maps, which arise from Hamiltonian systems.\n\n**2. Lyapunov Exponents and the Multiplicative Ergodic Theorem**\n\nThe evolution of a tangent vector $v_0$ under the dynamics is governed by the derivative cocycle, which is the product of Jacobian matrices along an orbit $\\{p_n\\}$:\n$$\nDF_K^n(p_0) = DF_K(p_{n-1}) \\cdots DF_K(p_1) DF_K(p_0)\n$$\nThe Multiplicative Ergodic Theorem (Oseledets theorem) states that for almost all initial points $p_0$ and any tangent vector $v_0$, the limit\n$$\n\\lambda(p_0, v_0) = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\|DF_K^n(p_0) v_0\\|\n$$\nexists and is called a Lyapunov exponent. The value of $\\lambda$ depends only on $p_0$, not on the direction of $v_0$ (for almost all $v_0$). For a $d$-dimensional system, there are $d$ such exponents.\n\nFor a symplectic map, the Lyapunov exponents come in pairs $(\\lambda_i, -\\lambda_i)$. Since the standard map is a $2$-dimensional area-preserving map, we have two exponents, $\\lambda_1$ and $\\lambda_2$. The symplectic structure ensures that $\\lambda_1 + \\lambda_2 = 0$. Therefore, $\\lambda_2 = -\\lambda_1$. We define the maximal Lyapunov exponent as $\\lambda_{max} = \\max(\\lambda_1, \\lambda_2)$. If $\\lambda_{max} > 0$, the orbit is chaotic, exhibiting sensitive dependence on initial conditions. If $\\lambda_{max} = 0$, the orbit is regular (periodic or quasi-periodic).\n\n**3. Hyperbolic Fixed Point and Homoclinic Tangle**\n\nA fixed point of the map satisfies $F_K(p) = p$. The point $(0,0)$ is a fixed point for all $K$, since for $(x,y)=(0,0)$, we have $y' = 0 + K\\sin(0)=0$ and $x' = 0+0=0$.\n\nThe stability of the fixed point is determined by the eigenvalues of the Jacobian evaluated at that point, $DF_K(0,0)$. With $\\cos(0)=1$, we have:\n$$\nDF_K(0,0) = \\begin{pmatrix} 1+K & 1 \\\\ K & 1 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(DF_K(0,0) - \\lambda I) = 0$:\n$$\n(1+K-\\lambda)(1-\\lambda) - K = 0 \\implies \\lambda^2 - (2+K)\\lambda + 1 = 0\n$$\nThe solutions are:\n$$\n\\lambda_{\\pm} = \\frac{(2+K) \\pm \\sqrt{(2+K)^2 - 4}}{2} = \\frac{2+K \\pm \\sqrt{K^2 + 4K}}{2}\n$$\nFor $K>0$, $K^2+4K > 0$, so the eigenvalues are real and distinct. Notice that $\\lambda_+\\lambda_- = 1$. One eigenvalue, $\\lambda_+ = \\frac{2+K + \\sqrt{K^2+4K}}{2}$, is greater than $1$. The other, $\\lambda_- = \\frac{1}{\\lambda_+}$, is between $0$ and $1$. A fixed point with real eigenvalues, one with magnitude greater than $1$ and one with magnitude less than $1$, is a hyperbolic fixed point.\n\nAssociated with these eigenvalues are the unstable and stable eigenspaces, spanned by eigenvectors $v_u$ and $v_s$, respectively. These eigenspaces form the tangent spaces to the unstable manifold $W^u(0,0)$ and stable manifold $W^s(0,0)$ at the fixed point. Orbits starting on $W^u(0,0)$ are repelled from $(0,0)$, while those on $W^s(0,0)$ approach it.\n\nFor the standard map, these manifolds extend into the phase space and intersect each other transversally, creating a complex structure known as a homoclinic tangle. The Smale-Birkhoff theorem implies that the existence of such a tangle is a signature of chaos. An orbit initiated near the unstable manifold is stretched along it, but the global folding action of the map causes it to repeatedly return to the vicinity of the original fixed point. This process confines the chaotic motion to the region of phase space occupied by the tangle for potentially long times.\n\n**4. Computational Procedure for Finite-Time Lyapunov Exponent**\n\nWe estimate the finite-time maximal Lyapunov exponent, $\\lambda_{FTLE}$, by numerically simulating the evolution of a tangent vector along a finite orbit segment.\n1.  **Initialization**: For a given $K$, compute the eigenvector $v_u$ of $DF_K(0,0)$ corresponding to the eigenvalue $\\lambda_+ > 1$. Normalize it to be a unit vector, $\\hat{v}_u$. To probe the homoclinic tangle, we initialize orbits at points $p_0 = (0,0) + \\delta \\hat{v}_u$ for several small displacements $\\delta$.\n2.  **Orbit and Tangent Vector Iteration**: We start with an orbit at $p_0$ and an arbitrary initial unit tangent vector $w_0$ (e.g., $w_0 = [1,0]^T$).\n3.  **Accumulation**: For each step $n = 0, 1, 2, \\ldots, N_{max}-1$:\n    a. Check if the current point $p_n$ is within the confinement region defined by $|x_n| \\le r_x$ and $|y_n| \\le r_y$. If not, the computation for this orbit terminates.\n    b. If $p_n$ is confined, compute the next tangent vector before normalization: $w'_{n+1} = DF_K(p_n) w_n$.\n    c. The local expansion rate is the norm $\\|w'_{n+1}\\|$. We add its logarithm to a running sum: $S_{n+1} = S_n + \\ln(\\|w'_{n+1}\\|)$.\n    d. Normalize the tangent vector for the next step: $w_{n+1} = w'_{n+1} / \\|w'_{n+1}\\|$.\n    e. Compute the next point in the orbit: $p_{n+1} = F_K(p_n)$, ensuring its components are wrapped into $[-\\pi, \\pi)$.\n4.  **Estimation**: If the orbit stayed in the confinement region for $N_{stop}$ steps ($N_{stop} > 0$), the exponent estimate is $\\lambda_{FTLE} \\approx S_{N_{stop}} / N_{stop}$. If the orbit leaves immediately ($N_{stop}=0$), its contribution to the average is defined as $0$.\n5.  **Averaging**: Repeat this process for several initial displacements $\\delta$ and average the resulting $\\lambda_{FTLE}$ values for each $K$ to obtain a more robust estimate.\n\nThis procedure, implemented in the following program, calculates the average finite-time maximal Lyapunov exponent for orbits confined to a region approximating the homoclinic tangle near the origin.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the finite-time maximal Lyapunov exponent for the\n    Chirikov standard map for a suite of K parameters.\n    \"\"\"\n\n    def wrap_angle(angle):\n        \"\"\"Wraps an angle in radians to the interval [-pi, pi).\"\"\"\n        return (angle + np.pi) % (2.0 * np.pi) - np.pi\n\n    def standard_map(p, K):\n        \"\"\"\n        Applies the Chirikov standard map F_K to a point p = (x, y).\n\n        Args:\n            p (np.ndarray): A 2-element array representing the state (x, y).\n            K (float): The stochasticity parameter.\n\n        Returns:\n            np.ndarray: The next state (x_new, y_new), with components wrapped.\n        \"\"\"\n        x, y = p\n        y_new = y + K * np.sin(x)\n        x_new = x + y_new\n        return np.array([wrap_angle(x_new), wrap_angle(y_new)])\n\n    def jacobian_map(p, K):\n        \"\"\"\n        Computes the Jacobian matrix of the standard map at point p = (x, y).\n\n        Args:\n            p (np.ndarray): A 2-element array representing the state (x, y).\n            K (float): The stochasticity parameter.\n\n        Returns:\n            np.ndarray: The 2x2 Jacobian matrix.\n        \"\"\"\n        x, _ = p\n        cos_x = np.cos(x)\n        return np.array([\n            [1.0 + K * cos_x, 1.0],\n            [K * cos_x, 1.0]\n        ])\n\n    def calculate_single_orbit_lyapunov(p0, K, rx, ry, Nmax):\n        \"\"\"\n        Calculates the finite-time Lyapunov exponent for a single orbit.\n\n        Args:\n            p0 (np.ndarray): The initial condition (x0, y0).\n            K (float): The stochasticity parameter.\n            rx (float): The confinement radius for the x-coordinate.\n            ry (float): The confinement radius for the y-coordinate.\n            Nmax (int): The maximum number of iterations.\n\n        Returns:\n            float: The estimated finite-time maximal Lyapunov exponent.\n        \"\"\"\n        p = p0\n        # Initialize a random tangent vector and normalize it.\n        w = np.array([1.0, 0.0])\n        log_sum = 0.0\n        n_steps = 0\n\n        for _ in range(Nmax):\n            # Check for confinement before accumulating growth\n            if abs(p[0]) > rx or abs(p[1]) > ry:\n                break\n            \n            # Evolve the tangent vector using the Jacobian at the current point\n            J_p = jacobian_map(p, K)\n            w_next_unnormalized = J_p @ w\n\n            # Calculate the norm and add its log to the sum\n            norm_w = np.linalg.norm(w_next_unnormalized)\n            if norm_w > 0:\n                log_sum += np.log(norm_w)\n                # Normalize the vector for the next step\n                w = w_next_unnormalized / norm_w\n            else:\n                # This case is unlikely but would terminate growth\n                break\n\n            # Evolve the orbit to the next point\n            p = standard_map(p, K)\n            n_steps += 1\n\n        if n_steps > 0:\n            return log_sum / n_steps\n        else:\n            return 0.0\n\n    # Define the test parameters from the problem statement.\n    K_values = [1e-6, 0.5, 1.0, 2.0, 4.0, 6.0]\n    deltas = [1e-8, 5e-8, 1e-7]\n    rx, ry = 1.0, 1.0\n    Nmax = 5000\n\n    results = []\n    \n    # Run the simulation for each K value\n    for K in K_values:\n        k_results = []\n\n        # Find the unstable eigenvector at the origin (0,0)\n        J0 = jacobian_map(np.array([0.0, 0.0]), K)\n        eigenvalues, eigenvectors = np.linalg.eig(J0)\n        \n        # The unstable eigenvector corresponds to the eigenvalue > 1\n        # which is the largest eigenvalue for K > 0.\n        unstable_vec_idx = np.argmax(eigenvalues)\n        unstable_vec = eigenvectors[:, unstable_vec_idx].real\n\n        # Average over several initial displacements along the unstable manifold\n        for delta in deltas:\n            p0 = delta * unstable_vec\n            lyap_exponent = calculate_single_orbit_lyapunov(p0, K, rx, ry, Nmax)\n            k_results.append(lyap_exponent)\n        \n        # Average the results for the current K and store it\n        avg_lyap = np.mean(k_results)\n        results.append(avg_lyap)\n\n    # Format and print the final output exactly as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Homoclinic tangles do not appear out of nowhere; they are typically born when a perturbation breaks the perfect connection between a saddle point's stable and unstable manifolds. This exercise  delves into this creation process using the powerful Melnikov method, a perturbative tool that measures the splitting of separatrices. By analyzing a perturbed pendulum system, you will determine the precise parameter values at which a symmetric homoclinic orbit is created or destroyed, offering a window into the birth of chaos.",
            "id": "3746857",
            "problem": "Consider the one-degree-of-freedom Hamiltonian system with a time-periodic perturbation\n$$\nH(q,p,t;\\varepsilon,\\omega,\\phi)=\\frac{1}{2}p^{2}+1-\\cos(q)+\\varepsilon\\,\\cos\\!\\left(\\frac{q}{2}\\right)\\cos\\!\\big(\\omega t+\\phi\\big),\n$$\nwhere $q\\in\\mathbb{R}$ is the configuration variable, $p\\in\\mathbb{R}$ is the conjugate momentum, $\\varepsilon>0$ is sufficiently small, $\\omega>0$ is the forcing frequency, and $\\phi\\in[0,2\\pi)$ is a phase parameter. The unperturbed Hamiltonian $H_{0}(q,p)=\\frac{1}{2}p^{2}+1-\\cos(q)$ has a hyperbolic equilibrium at $(q,p)=(\\pi,0)$ whose separatrix is a homoclinic orbit. For $\\varepsilon>0$ sufficiently small, this hyperbolic equilibrium continues to a hyperbolic periodic orbit of the $T$-periodic flow, with $T=\\frac{2\\pi}{\\omega}$, and generically its stable and unstable manifolds split, producing or destroying homoclinic connections to the hyperbolic periodic orbit.\n\nThe system admits a standard reversing symmetry given by the involution $R(q,p)=(q,-p)$ combined with time-reversal $t\\mapsto -t$. A homoclinic orbit that is symmetric with respect to $R$ must intersect the fixed-point set $\\mathrm{Fix}(R)=\\{(q,p):p=0\\}$ at a time that can be chosen to be $t=0$.\n\nStarting only from Hamilton's equations, the definition of the Poisson bracket, and first-order splitting analysis based on the leading-order effect of the perturbation along the unperturbed homoclinic orbit, determine the values of the phase parameter $\\phi\\in[0,2\\pi)$ (express your answer in radians) at which a symmetric homoclinic orbit to the hyperbolic periodic orbit is created or destroyed due to the symmetry constraint. Your final answer must be the value or values of $\\phi$ alone; no intermediate quantities or conditions. No rounding is required; provide exact values.",
            "solution": "The user wants to find the values of the phase parameter $\\phi$ at which symmetric homoclinic orbits are created or destroyed for a perturbed Hamiltonian system.\n\n### Step 1: Problem Validation\n\nThe problem provides a one-degree-of-freedom Hamiltonian system with a time-periodic perturbation:\n$$\nH(q,p,t;\\varepsilon,\\omega,\\phi)=\\frac{1}{2}p^{2}+1-\\cos(q)+\\varepsilon\\,\\cos\\!\\left(\\frac{q}{2}\\right)\\cos\\!\\big(\\omega t+\\phi\\big)\n$$\nThe unperturbed part is $H_0(q,p) = \\frac{1}{2}p^2 + 1-\\cos(q)$. The system is subject to a reversing symmetry $R(q,p)=(q,-p)$ combined with time reversal $t\\mapsto -t$. The problem requires a first-order analysis based on the perturbation's effect along the unperturbed homoclinic orbit to determine the bifurcation values of $\\phi$.\n\nThe problem is scientifically grounded, rooted in the standard theory of nonlinear dynamics and Hamiltonian mechanics, specifically the Melnikov method for detecting homoclinic bifurcations. It is well-posed, with sufficient information provided to perform the analysis. The language is objective and mathematically precise. The setup is a classic textbook example, free of scientific flaws or contradictions, and the required task is non-trivial but feasible. Therefore, the problem is deemed valid.\n\n### Step 2: Solution Derivation\n\nThe solution proceeds by applying the Melnikov method to analyze the splitting of separatrices.\n\n**2.1 The Unperturbed System and its Homoclinic Orbit**\n\nThe unperturbed Hamiltonian is $H_0(q,p) = \\frac{1}{2}p^2 + 1 - \\cos(q)$. The equations of motion are $\\dot{q} = \\frac{\\partial H_0}{\\partial p} = p$ and $\\dot{p} = -\\frac{\\partial H_0}{\\partial q} = -\\sin(q)$. The system has hyperbolic (saddle) equilibrium points at $(q,p) = ((2n+1)\\pi, 0)$ for $n \\in \\mathbb{Z}$. The problem specifies the hyperbolic equilibrium at $(\\pi, 0)$.\n\nThe energy at this equilibrium is $H_0(\\pi, 0) = \\frac{1}{2}(0)^2 + 1 - \\cos(\\pi) = 1 - (-1) = 2$. The separatrix is the level set $H_0(q,p) = 2$.\n$$\n\\frac{1}{2}p^2 + 1 - \\cos(q) = 2 \\implies \\frac{1}{2}p^2 = 1 + \\cos(q) = 2\\cos^2\\left(\\frac{q}{2}\\right).\n$$\nThis gives the momentum along the separatrix as $p = \\pm 2\\cos(q/2)$. Let's consider the trajectory connecting the saddle at $(-\\pi,0)$ to the saddle at $(\\pi,0)$, which corresponds to a branch of the separatrix with $p>0$. The equation of motion for $q$ is $\\frac{dq}{dt} = 2\\cos(q/2)$. Solving this differential equation by separation of variables, with the condition that $q=0$ at $t=0$, yields:\n$$\n\\int_0^q \\frac{d\\xi}{2\\cos(\\xi/2)} = \\int_0^t d\\tau \\implies \\left[\\ln\\left|\\sec\\left(\\frac{\\xi}{2}\\right)+\\tan\\left(\\frac{\\xi}{2}\\right)\\right|\\right]_0^q = t.\n$$\nThis leads to the parameterized unperturbed homoclinic (more accurately, heteroclinic) orbit $\\mathbf{x}_0(t) = (q_0(t), p_0(t))$:\n$$\nq_0(t) = 4\\arctan(e^t) - \\pi\n$$\n$$\np_0(t) = \\frac{dq_0}{dt} = \\frac{4e^t}{1+e^{2t}} = \\frac{2}{e^{-t}+e^t} = 2\\,\\mathrm{sech}(t)\n$$\nThis trajectory limits to $(-\\pi, 0)$ as $t \\to -\\infty$ and to $(\\pi, 0)$ as $t \\to +\\infty$.\n\n**2.2 The Melnikov Function**\n\nThe Melnikov function measures the first-order signed distance between the stable and unstable manifolds of the perturbed hyperbolic periodic orbit. It is given by the integral of the Poisson bracket of the unperturbed Hamiltonian $H_0$ and the perturbation Hamiltonian $H_1$ along the unperturbed homoclinic orbit:\n$$\nM(t_0) = \\int_{-\\infty}^{\\infty} \\{H_0, H_1\\}(q_0(t), p_0(t), t+t_0) dt\n$$\nwhere $H_1(q,p,t) = \\cos(q/2)\\cos(\\omega t+\\phi)$. The Poisson bracket is\n$$\n\\{H_0, H_1\\} = \\frac{\\partial H_0}{\\partial q}\\frac{\\partial H_1}{\\partial p} - \\frac{\\partial H_0}{\\partial p}\\frac{\\partial H_1}{\\partial q}\n$$\nSince $H_1$ is independent of $p$, $\\frac{\\partial H_1}{\\partial p}=0$.\n$$\n\\{H_0, H_1\\} = - p \\frac{\\partial}{\\partial q}\\left[\\cos\\left(\\frac{q}{2}\\right)\\cos(\\omega \\tau + \\phi)\\right] = - p \\left[-\\frac{1}{2}\\sin\\left(\\frac{q}{2}\\right)\\cos(\\omega \\tau + \\phi)\\right] = \\frac{1}{2}p \\sin\\left(\\frac{q}{2}\\right)\\cos(\\omega \\tau + \\phi)\n$$\nwhere $\\tau$ is time. The Melnikov function is therefore:\n$$\nM(t_0, \\phi) = \\int_{-\\infty}^{\\infty} \\frac{1}{2} p_0(t) \\sin\\left(\\frac{q_0(t)}{2}\\right) \\cos(\\omega(t+t_0)+\\phi) dt\n$$\nWe evaluate the terms involving the unperturbed orbit:\n$p_0(t) = 2\\,\\mathrm{sech}(t)$.\nFor $q_0(t)/2 = 2\\arctan(e^t) - \\pi/2$, we have $\\sin(q_0(t)/2) = \\sin(2\\arctan(e^t) - \\pi/2) = -\\cos(2\\arctan(e^t))$.\nLet $\\theta = \\arctan(e^t)$. Then $\\cos(2\\theta) = \\cos^2\\theta-\\sin^2\\theta = \\frac{1-e^{2t}}{1+e^{2t}} = -\\tanh(t)$.\nSo, $\\sin(q_0(t)/2) = -(-\\tanh(t)) = \\tanh(t)$.\nThe product is $\\frac{1}{2} p_0(t) \\sin(q_0(t)/2) = \\frac{1}{2} (2\\,\\mathrm{sech}(t))(\\tanh(t)) = \\mathrm{sech}(t)\\tanh(t)$.\nThis function is odd in $t$. The Melnikov integral becomes:\n$$\nM(t_0, \\phi) = \\int_{-\\infty}^{\\infty} \\mathrm{sech}(t)\\tanh(t) \\cos(\\omega(t+t_0)+\\phi) dt\n$$\nExpanding the cosine term: $\\cos(\\omega t+\\omega t_0+\\phi) = \\cos(\\omega t)\\cos(\\omega t_0+\\phi) - \\sin(\\omega t)\\sin(\\omega t_0+\\phi)$.\nSince $\\mathrm{sech}(t)\\tanh(t)$ is an odd function, its integral against the even function $\\cos(\\omega t)$ over $(-\\infty, \\infty)$ is zero. The integral against the odd function $\\sin(\\omega t)$ is non-zero.\n$$\nM(t_0, \\phi) = -\\sin(\\omega t_0+\\phi) \\int_{-\\infty}^{\\infty} \\mathrm{sech}(t)\\tanh(t)\\sin(\\omega t) dt\n$$\nLet the integral be $I_M = \\int_{-\\infty}^{\\infty} \\mathrm{sech}(t)\\tanh(t)\\sin(\\omega t) dt$. This integral can be evaluated using integration by parts, noting that $\\frac{d}{dt}\\mathrm{sech}(t) = -\\mathrm{sech}(t)\\tanh(t)$:\n$$\nI_M = \\int_{-\\infty}^{\\infty} \\left(-\\frac{d}{dt}\\mathrm{sech}(t)\\right)\\sin(\\omega t) dt = \\left[-\\mathrm{sech}(t)\\sin(\\omega t)\\right]_{-\\infty}^\\infty + \\int_{-\\infty}^\\infty \\mathrm{sech}(t) \\frac{d}{dt}\\sin(\\omega t) dt\n$$\nThe boundary terms vanish.\n$$\nI_M = \\omega \\int_{-\\infty}^\\infty \\mathrm{sech}(t)\\cos(\\omega t) dt\n$$\nThis is a known Fourier transform pair: $\\int_{-\\infty}^\\infty \\mathrm{sech}(t) e^{-i\\omega t} dt = \\pi\\,\\mathrm{sech}(\\pi\\omega/2)$. Taking the real part gives the cosine transform:\n$$\nI_M = \\omega \\left(\\pi\\,\\mathrm{sech}\\left(\\frac{\\pi\\omega}{2}\\right)\\right) = \\pi\\omega\\,\\mathrm{sech}\\left(\\frac{\\pi\\omega}{2}\\right)\n$$\nSince $\\omega > 0$, $I_M > 0$. The Melnikov function is:\n$$\nM(t_0, \\phi) = -I_M \\sin(\\omega t_0+\\phi)\n$$\n\n**2.3 Bifurcation Condition for Symmetric Orbits**\n\nThe problem states a reversing symmetry $R(q,p)=(q,-p)$ with $t \\mapsto -t$. A homoclinic orbit $\\mathbf{z}(t)=(q(t),p(t))$ is symmetric with respect to $R$ if $\\mathbf{z}(t)=R(\\mathbf{z}(-t))$, which implies $q(t)=q(-t)$ (even) and $p(t)=-p(-t)$ (odd). This requires the orbit to cross the fixed-point set $\\mathrm{Fix}(R)=\\{(q,p): p=0\\}$ at $t=0$.\n\nThe creation or destruction of symmetric homoclinic orbits is a bifurcation that occurs under specific conditions on the Melnikov function. For a system with the given symmetry, this type of bifurcation happens when the even part of the Melnikov function (with respect to $t_0$) vanishes identically.\n\nWe decompose $M(t_0, \\phi)$ into its even and odd parts:\n$M_e(t_0, \\phi) = \\frac{1}{2}[M(t_0, \\phi) + M(-t_0, \\phi)]$.\n$M_o(t_0, \\phi) = \\frac{1}{2}[M(t_0, \\phi) - M(-t_0, \\phi)]$.\n\nLet's compute $M(-t_0, \\phi)$:\n$$\nM(-t_0, \\phi) = -I_M \\sin(\\omega(-t_0)+\\phi) = -I_M \\sin(\\phi-\\omega t_0)\n$$\nThe even part is:\n$$\nM_e(t_0, \\phi) = \\frac{1}{2}[-I_M \\sin(\\phi+\\omega t_0) - I_M \\sin(\\phi-\\omega t_0)] = -\\frac{I_M}{2}[\\sin(\\phi+\\omega t_0) + \\sin(\\phi-\\omega t_0)]\n$$\nUsing the sum-to-product identity $\\sin(A+B)+\\sin(A-B) = 2\\sin(A)\\cos(B)$:\n$$\nM_e(t_0, \\phi) = -\\frac{I_M}{2}[2\\sin(\\phi)\\cos(\\omega t_0)] = -I_M \\sin(\\phi) \\cos(\\omega t_0)\n$$\nThe bifurcation that creates or destroys symmetric orbits occurs when $M_e(t_0, \\phi)$ becomes identically zero for all $t_0$.\n$$\n-I_M \\sin(\\phi) \\cos(\\omega t_0) = 0 \\quad \\forall t_0\n$$\nSince $I_M \\neq 0$ and $\\cos(\\omega t_0)$ is not identically zero, this condition requires:\n$$\n\\sin(\\phi) = 0\n$$\nThe values of $\\phi$ in the interval $[0, 2\\pi)$ that satisfy this condition are $\\phi=0$ and $\\phi=\\pi$. At these values, the Melnikov function becomes purely odd in $t_0$, which is the condition for a pitchfork bifurcation of symmetric homoclinic orbits.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\pi \\end{pmatrix}}\n$$"
        }
    ]
}