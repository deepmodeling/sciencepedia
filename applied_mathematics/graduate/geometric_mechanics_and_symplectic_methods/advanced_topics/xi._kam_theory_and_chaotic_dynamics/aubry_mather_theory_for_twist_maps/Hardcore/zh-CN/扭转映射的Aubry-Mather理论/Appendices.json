{
    "hands_on_practices": [
        {
            "introduction": "当一个不变环破裂时，输运不再被完全阻挡。由此产生的不变集，即坎托环 (cantorus)，如同一个有泄漏的屏障。本练习提供了一种直接的方法，利用 MacKay-Meiss-Percival 原理，通过特殊周期轨道的作用量来量化这种泄漏或“通量”。通过处理给定的数据，您将进行一次切实的计算，将作用量变分原理与混沌输运的物理现象联系起来 ()。",
            "id": "3746888",
            "problem": "考虑一个由离散拉格朗日量（生成函数）$S(x,x')$ 生成的柱面上的辛扭转映射，该映射 $(x,p) \\mapsto (x',p')$ 满足离散欧拉-拉格朗日关系 $p = -\\partial_{x} S(x,x')$ 和 $p' = \\partial_{x'} S(x,x')$。对于 Chirikov–Taylor 标准映射，取其生成函数为\n$$\nS(x,x') = \\frac{1}{2} (x' - x)^{2} - \\frac{K}{2\\pi} \\cos(2\\pi x),\n$$\n其中 $K = 1.0$。当具有无理旋转数（此处取黄金分割数）的不变环面被破坏后，会留下一个不变集，称为 cantorus，其输运性质可以通过有理逼近 $p/q$ 来探测。\n\n你需要使用 MacKay–Meiss–Percival (MMP) 变分原理，该原理将穿过 cantorus 的通量与极值轨道的作用量之差，以及由邻近双曲不变集的稳定和不稳定流形形成的 Smale–Birkhoff 同宿缠结中的旋转门叶面积联系起来。\n\n从离散变分原理和辛面积守恒出发，完成以下任务：\n\n1. 将旋转数为 $p/q$ 的 $q$-周期轨道在一个周期内的作用量定义为 $W = \\sum_{k=0}^{q-1} S(x_{k},x_{k+1})$，并解释为什么对于给定的有理旋转数 $p/q$，在具有生成函数 $S$ 的单调扭转映射类中，存在两个不同的极值 $q$-周期轨道：一个极小化轨道和一个极小极大（鞍点）轨道。仅使用基本定义和性质（离散欧拉-拉格朗日方程、辛面积守恒以及极值轨道存在性），推导与该无理旋转数相关的 cantorus 在每次迭代中的净通量等于其有理逼近的极小化轨道和极小极大轨道的作用量之差，并且这个差值等于旋转门每次迭代交换的总面积，即其出口叶的面积之和。\n\n2. 对于逼近 $p/q = 3/5$，给定沿着两条极值 $q$-周期轨道计算出的链作用量 $S(x_{k},x_{k+1})$：\n- 极小化轨道的链作用量（按 $k=0,1,2,3,4$ 顺序）：\n$$\n0.188735049,\\quad 0.214681923,\\quad 0.205193411,\\quad 0.197451208,\\quad 0.210875996.\n$$\n- 极小极大轨道的链作用量（按 $k=0,1,2,3,4$ 顺序）：\n$$\n0.189103482,\\quad 0.215097256,\\quad 0.205481033,\\quad 0.197838021,\\quad 0.211263167.\n$$\n计算作用量之差 $\\Delta W = W_{\\mathrm{minimax}} - W_{\\mathrm{min}}$，并将其解释为穿过 cantorus 的每次迭代通量。在邻近的同宿缠结每次迭代产生 $q$ 个全等出口叶的假设下，计算单个出口叶的预测面积为 $\\Delta W/q$。\n\n3. 对邻近同宿缠结中单个出口叶面积的直接测量得到 $3.69074 \\times 10^{-4}$。解释该测量值与你的预测以及 MMP 变分原理的一致性。\n\n将你的最终结果表示为穿过 cantorus 的每次迭代通量。将最终数值答案四舍五入到六位有效数字。该相空间面积不需要物理单位；报告一个无量纲值。在相关情况下，角度被理解为单位圆上的无量纲相位。",
            "solution": "该问题已经过验证，被认为是具有科学依据、适定、客观和完整的。这是几何力学和混沌动力学领域的一个标准问题，要求将 MacKay–Meiss–Percival (MMP) 变分原理应用于 Chirikov–Taylor 标准映射。\n\n解答按要求分为三个部分。\n\n第 1 部分：理论框架\n\n如果一个由映射 $(x,p) \\mapsto (x',p')$ 描述的离散时间动力系统保持面积元 $dp \\wedge dx$ 不变，则该系统是辛的。对于扭转映射，这样的系统可以从基于生成函数（或离散拉格朗日量）$S(x,x')$ 的变分原理导出。一条由位置序列 $\\{x_k\\}_{k \\in \\mathbb{Z}}$ 表示的轨道，如果它能使其作用量（即生成函数沿路径的总和）取极值，那么它就是系统的物理轨迹：\n$$\nW = \\sum_{k} S(x_k, x_{k+1})\n$$\n极值条件 $\\frac{\\partial W}{\\partial x_k} = 0$（对所有 $k$）导出离散欧拉-拉格朗日方程：\n$$\n\\frac{\\partial S(x_{k-1}, x_k)}{\\partial x_k} + \\frac{\\partial S(x_k, x_{k+1})}{\\partial x_k} = 0\n$$\n对于映射 $(x_k, p_k) \\to (x_{k+1}, p_{k+1})$，我们有：\n$$\np_k = -\\frac{\\partial S(x_k, x_{k+1})}{\\partial x_k} \\quad \\text{和} \\quad p_{k+1} = \\frac{\\partial S(x_k, x_{k+1})}{\\partial x_{k+1}}\n$$\n这是对离散欧拉-拉格朗日方程的重述，其中我们将从步 $k \\to k+1$ 导出的 $p_{k+1}$ 与作为步 $k+1 \\to k+2$ 输入的 $p_{k+1}$ 等同起来。\n\n对于生成函数为 $S(x,x') = \\frac{1}{2} (x' - x)^{2} - \\frac{K}{2\\pi} \\cos(2\\pi x)$ 的 Chirikov-Taylor 标准映射，当 $K$ 足够小时，该映射是一个扭转映射。针对此类映射的 Aubry-Mather 理论预测，对于任意无理旋转数 $\\omega$，都存在一个不变集（如果 $\\omega$ 足够无理且 $K$ 很小，则为 KAM 环面；如果环面已被破坏，则为 cantorus）。对于有理旋转数 $p/q$，该理论保证周期轨道的存在。对于一个一般的扭转映射，至少存在两个旋转数为 $p/q$ 的 $q$-周期轨道。一个是极小化轨道，对应于作用量泛函 $W = \\sum_{k=0}^{q-1} S(x_k, x_{k+1})$ 在所有具有该旋转数的位形上的全局最小值。另一个是极小极大（或鞍点）轨道，它不是一个最小值，但仍然是一个极值（路径函数空间中的一个鞍点）。极小化轨道通常是稳定的（椭圆型或抛物型），而极小极大轨道是双曲的（不稳定的）。\n\nMacKay-Meiss-Percival (MMP) 原理提供了这些周期轨道与混沌输运之间的关键联系。当具有无理旋转数的 KAM 环面破裂时，它会留下一个 cantorus，这是一个不连通的不变集，作为输运的部分势垒。跨越此势垒的输运由一个旋转门介导，旋转门是相空间中的一个区域，其边界由邻近的双曲（极小极大）周期轨道的稳定和不稳定流形段构成。每次迭代的通量定义为在一次映射迭代中穿过 cantorus 势垒的旋转门叶的总面积。\n\nMMP 定理指出，该通量精确地等于逼近 cantorus 的极小极大轨道和极小化轨道的作用量之差：\n$$\n\\text{每次迭代通量} = \\Delta W = W_{\\mathrm{minimax}} - W_{\\mathrm{min}}\n$$\n这个结果是通过在相空间中构建一个曲面来推导的，该曲面的边界由两条周期轨道（$\\gamma_{\\mathrm{minimax}}$ 和 $\\gamma_{\\mathrm{min}}$）构成。作用量积分之差 $\\oint_{\\gamma_{\\mathrm{minimax}}} p \\, dx - \\oint_{\\gamma_{\\mathrm{min}}} p \\, dx$ 等于作用量之差 $\\Delta W$。根据斯托克斯定理，这个线积分之差等于面积分 $\\iint_{\\mathcal{A}} dp \\wedge dx$，其中 $\\mathcal{A}$ 是由轨道界定的曲面面积。这个辛面积恰好是映射跨越势垒输运的面积，根据定义，它就是旋转门叶的通量。因此，作用量之差（一个变分量）等于通量（一个几何量）。\n\n第 2 部分：对 $p/q = 3/5$ 逼近的计算\n\n我们已知旋转数为 $3/5$ 的极小化和极小极大 $5$-周期轨道（$q=5$）的链作用量 $S(x_k, x_{k+1})$。\n\n首先，我们通过将其链作用量相加来计算极小化轨道的总作用量 $W_{\\mathrm{min}}$：\n$$\nW_{\\mathrm{min}} = \\sum_{k=0}^{4} S_{\\mathrm{min}}(x_{k},x_{k+1}) = 0.188735049 + 0.214681923 + 0.205193411 + 0.197451208 + 0.210875996\n$$\n$$\nW_{\\mathrm{min}} = 1.016937587\n$$\n\n接下来，我们计算极小极大轨道的总作用量 $W_{\\mathrm{minimax}}$：\n$$\nW_{\\mathrm{minimax}} = \\sum_{k=0}^{4} S_{\\mathrm{minimax}}(x_{k},x_{k+1}) = 0.189103482 + 0.215097256 + 0.205481033 + 0.197838021 + 0.211263167\n$$\n$$\nW_{\\mathrm{minimax}} = 1.018782959\n$$\n\n穿过 cantorus 的每次迭代通量是作用量之差 $\\Delta W$：\n$$\n\\Delta W = W_{\\mathrm{minimax}} - W_{\\mathrm{min}} = 1.018782959 - 1.016937587 = 0.001845372\n$$\n\n问题假设，由于缠结的周期性，与 $q=5$ 极小极大轨道相关的同宿缠结每次迭代产生 $q=5$ 个全等的出口叶。总通量 $\\Delta W$ 是这些叶的面积之和。因此，单个出口叶的预测面积为：\n$$\n\\text{叶面积}_{\\text{lobe}} = \\frac{\\Delta W}{q} = \\frac{0.001845372}{5} = 0.0003690744\n$$\n\n第 3 部分：与直接测量的一致性\n\n根据变分原理计算出的单个出口叶的预测面积为 $0.0003690744$。这可以用科学记数法写成 $3.690744 \\times 10^{-4}$。\n\n我们已知对同宿缠结中单个出口叶面积的直接数值测量得到的值为 $3.69074 \\times 10^{-4}$。\n\n比较两个结果：\n- 预测面积：$3.690744 \\times 10^{-4}$\n- 测量面积：$3.69074 \\times 10^{-4}$\n\n这两个值非常一致，与测量值提供的六位有效数字相匹配。这种显著的一致性为 MacKay–Meiss–Percival 变分原理的有效性提供了强有力的数值证据。它证实了在哈密顿系统中，周期轨道的变分性质（作用量）与混沌输运的几何性质（同宿缠结中的叶面积）之间存在着深刻的联系。通量是输运的一个关键度量，可以通过寻找极值周期轨道来精确确定，这在计算上通常比直接测量缠结叶的面积更直接。\n\n要求的最终结果是穿过 cantorus 的每次迭代通量，即 $\\Delta W$。将此值四舍五入到六位有效数字：\n$$\n\\Delta W = 0.001845372 \\approx 0.00184537\n$$",
            "answer": "$$\n\\boxed{0.00184537}\n$$"
        },
        {
            "introduction": "从理论理解转向实际应用，本练习将指导您完成格林判据的数值实现。您将开发一个算法来寻找标准映射的周期轨道并计算它们的稳定性留数，从而创建一个工具来检验不变圆的存在性。这个综合性实践使您能够通过实验验证 KAM 和奥布里-马瑟理论的预测 ()。",
            "id": "3746903",
            "problem": "考虑Chirikov标准映射，这是一个二维柱面上的精确辛微分同胚，由下式给出：\n$$\np_{n+1} = p_n + K \\sin(x_n), \\qquad x_{n+1} = x_n + p_{n+1},\n$$\n其中 $x_n \\in \\mathbb{R}/(2\\pi\\mathbb{Z})$ 是一个角变量（以弧度为单位），$p_n \\in \\mathbb{R}$ 是一个类作用量变量，$K \\geq 0$ 是一个无量纲非线性参数。\n\n从辛映射和周期轨道线性稳定性的基本定义出发，使用Greene判据——该判据基于旋转数为无理旋转数的连分式渐近分数的有理周期轨道序列的稳定性留数——来确定具有黄金平均旋转数\n$$\n\\omega_g = \\frac{\\sqrt{5}-1}{2}\n$$\n的不变圆发生破裂时的临界值 $K_c$。您的推导必须：\n- 从映射的精确辛结构和线性化动力学开始，定义周期为 $q$ 的轨道的单值矩阵，并根据其迹来定义其稳定性，以及将留数定义为二维辛映射的典则椭圆-双曲指示量，\n- 应用Greene判据，通过追踪 $\\omega_g$ 的有理逼近序列 $p_n/q_n$ 的留数，并确定极限留数指示不变圆破裂时的阈值 $K$，\n- 将破裂后的结构与一个类康托尔不变集（cantorus）联系起来，并解释相关的双曲周期轨道的同宿缠结如何产生作为部分输运壁垒的旋转门瓣，\n- 作为推理的一部分，通过将渐近旋转门通量写成沿周期逼近的极小化序列和极小极大序列的极限作用量差，用标准映射的精确辛生成函数\n$$\nS(x,x') = \\frac{1}{2}\\,(x'-x)^2 + K \\cos(x),\n$$\n来表示穿过黄金cantorus的渐近旋转门通量。\n\n计算 $K_c$ 并提供其数值，四舍五入到六位有效数字。最终答案必须是答案框内的一个不带单位的实数。",
            "solution": "问题要求使用Greene判据及哈密顿动力学中的相关概念，推导Chirikov标准映射中黄金平均不变圆破裂的临界非线性参数 $K_c$。\n\n首先，我们验证问题陈述的有效性。\nChirikov标准映射由以下方程给出：\n$$\np_{n+1} = p_n + K \\sin(x_n)\n$$\n$$\nx_{n+1} = x_n + p_{n+1}\n$$\n其中 $x_n \\pmod{2\\pi}$ 且 $p_n \\in \\mathbb{R}$。参数 $K \\ge 0$ 控制非线性。问题研究的是具有黄金平均旋转数 $\\omega_g = (\\sqrt{5}-1)/2$ 的不变圆。分析将基于Greene判据，涉及周期轨道的稳定性，并与cantori、同宿缠结以及通过给定的辛生成函数 $S(x,x') = \\frac{1}{2}(x'-x)^2 + K \\cos(x)$ 进行的通量计算相关。问题的所有组成部分——标准映射、KAM理论、Greene判据、Aubry-Mather理论（cantori）和生成函数——都是几何力学和混沌动力学领域中基本且成熟的概念。该问题具有科学依据、是适定的且客观的。它是混沌理论中的一个典则问题。因此，该问题是有效的，我们可以开始求解。\n\n我们首先确定映射的辛性质并建立稳定性分析的框架。该映射是一个变换 $T: (x_n, p_n) \\mapsto (x_{n+1}, p_{n+1})$。将第一个方程代入第二个方程，得到显式形式 $T(x, p) = (x + p + K\\sin(x), p + K\\sin(x))$。该变换的雅可比矩阵为\n$$\nDT(x, p) = \\begin{pmatrix} \\frac{\\partial x_{n+1}}{\\partial x_n}  \\frac{\\partial x_{n+1}}{\\partial p_n} \\\\ \\frac{\\partial p_{n+1}}{\\partial x_n}  \\frac{\\partial p_{n+1}}{\\partial p_n} \\end{pmatrix} = \\begin{pmatrix} 1 + K \\cos(x)  1 \\\\ K \\cos(x)  1 \\end{pmatrix}\n$$\n雅可比矩阵的行列式为 $\\det(DT) = (1 + K \\cos(x))(1) - (1)(K \\cos(x)) = 1$。由于行列式为常数1，该映射是辛的；具体来说，它在 $(x,p)$ 相平面上是保面积的。\n\n周期为 $q$ 的周期轨道是一系列点 $\\{(x_i, p_i)\\}_{i=0}^{q-1}$，满足对于某个整数 $m$ 有 $T^q(x_0, p_0) = (x_0 + 2\\pi m, p_0)$。其稳定性由 $q$ 次迭代映射 $T^q$ 在轨道上任意一点周围的线性化决定。这个线性化映射的矩阵就是单值矩阵 $M_q = DT(x_{q-1}, p_{q-1}) \\cdots DT(x_0, p_0)$。作为单位行列式矩阵的乘积，$M_q$ 的行列式也为 $\\det(M_q)=1$。$M_q$ 的特征值 $\\lambda$ 是特征多项式 $\\lambda^2 - \\text{Tr}(M_q)\\lambda + 1 = 0$ 的根。轨道的稳定性取决于迹：\n- 如果 $|\\text{Tr}(M_q)|  2$，特征值是位于单位圆上的一对共轭复数，轨道是线性稳定的（椭圆型）。\n- 如果 $|\\text{Tr}(M_q)|  2$，特征值是互为倒数的实数（$\\lambda, 1/\\lambda$），轨道是不稳定的（双曲型）。\n- 如果 $|\\text{Tr}(M_q)| = 2$，轨道是临界稳定的（抛物型）。\n\n一个方便的稳定性指示量是留数 $R$，定义为 $R = \\frac{1}{4}(2 - \\text{Tr}(M_q))$。根据这个定义，椭圆轨道的 $R > 0$，双曲轨道的 $R  0$。\n\nGreene判据将具有给定无理旋转数 $\\omega$ 的光滑不变圆（KAM环）的存在性与旋转数为 $\\omega$ 的连分式渐近分数 $p_k/q_k$ 的周期轨道的行为联系起来。该判据指出，不变圆存在的充要条件是这些周期轨道的留数 $R_k$ 在 $k \\to \\infty$ 时收敛到一个正的极限。圆的破裂对应于极限留数变为零时的参数值 $K_c$。\n\n我们将此应用于具有黄金平均旋转数 $\\omega_g = \\frac{\\sqrt{5}-1}{2}$ 的不变圆。其连分式展开为 $[0; 1, 1, 1, \\dots]$。其渐近分数序列 $p_k/q_k$ 由连续斐波那契数的比值 $F_{k-1}/F_k$ 构成，其中 $F_k$ 是标准斐波那契数，满足 $F_0=0, F_1=1$：$0/1, 1/1, 1/2, 2/3, 3/5, \\dots$。为了找到 $K_c$，必须对于给定的 $K$，数值计算出旋转数为 $p_k/q_k$ 的周期为 $q_k$ 的轨道，计算它们的单值矩阵和留数 $R_k$，然后分析极限 $\\lim_{k\\to\\infty} R_k$。临界值 $K_c$ 是使该极限为零的特定 $K$ 值：\n$$\n\\lim_{k\\to\\infty} R(K_c; p_k/q_k) = 0\n$$\n对于 $K  K_c$，该极限为正，存在一个光滑的KAM圆。对于 $K  K_c$，该极限变为负，表明逼近该圆的“最鲁棒”的周期轨道已变为双曲型，光滑圆已被破坏。\n\n当 $K > K_c$ 时不变圆破裂，其残迹是一个被称为*cantorus*的不变康托尔集，这由Aubry-Mather理论所描述。这个集合是无处稠密的，并且有间隙。现在构成cantorus骨架的双曲周期轨道（例如，斐波那契逼近轨道）具有稳定 ($W^s$) 和不稳定 ($W^u$) 流形。这些流形横截相交，形成一种称为*同宿缠结*的复杂结构。由连续交点（同宿点）之间的 $W^s$ 和 $W^u$ 段所界定的相平面区域被称为瓣。这些瓣创造了一种“旋转门”机制，在每次映射迭代中输运相空间面积穿过cantorus。因此，对于 $K > K_c$，cantorus是一个部分输运壁垒。\n\n通量，即每次映射迭代中穿过cantorus的输运面积，可以使用给定的生成函数 $S(x,x') = \\frac{1}{2}(x'-x)^2 + K \\cos(x)$ 从作用量原理计算。这是一个第一类生成函数 $F_1(x_n, x_{n+1})$，动力学可以通过 $p_{n+1} = \\frac{\\partial S}{\\partial x_{n+1}}$ 和 $p_n = -\\frac{\\partial S}{\\partial x_n}$ 推导出来。Aubry-Mather理论的一个关键结果是，对于 $K > K_c$，对于每个有理旋转数 $p_k/q_k$，至少存在两个不同的周期轨道：一个是使作用量 $W = \\sum_{i=0}^{q_k-1} S(x_i, x_{i+1})$ 最小化的轨道，另一个是“极小极大”轨道，它是作用量的一个鞍点。当 $k \\to \\infty$ 时，这些轨道序列收敛到cantorus上的两个不同构型。穿过黄金cantorus的渐近通量 $\\Delta W$ 正是这些极小极大和极小化周期逼近序列之间的极限作用量差：\n$$\n\\Delta W(K) = \\lim_{k\\to\\infty} \\left[ W_{\\text{minimax}}(p_k/q_k) - W_{\\text{min}}(p_k/q_k) \\right]\n$$\n这个作用量差 $\\Delta W(K)$ 在 $K \\le K_c$ 时为零，在 $K > K_c$ 时为正，量化了cantorus的“泄漏性”。\n\n临界值 $K_c$ 是这类映射中黄金环破裂的一个普适常数。它的值已通过基于上述Greene方法的大量数值计算被高精度地确定。公认值为 $K_c \\approx 0.97163540631$。问题要求此值四舍五入到六位有效数字。\n\n因此，临界值为 $K_c = 0.971635$。",
            "answer": "$$\\boxed{0.971635}$$"
        },
        {
            "introduction": "从理论理解转向实际应用，本练习将指导您完成格林判据的数值实现。您将开发一个算法来寻找标准映射的周期轨道并计算它们的稳定性留数，从而创建一个工具来检验不变圆的存在性。这个综合性实践使您能够通过实验验证 KAM 和奥布里-马瑟理论的预测 ()。",
            "id": "3730073",
            "problem": "考虑定义在柱面上的标准保面积扭转映射，也称为Chirikov标准映射，其迭代规则为\n$$\ny_{n+1} = y_n + K \\sin(2\\pi x_n), \\quad x_{n+1} = x_n + y_{n+1},\n$$\n其中 $K \\in \\mathbb{R}$ 是非线性参数，$\\sin(2\\pi x_n)$ 中的角度 $2\\pi x_n$ 以弧度计算。该映射是辛的、单调扭转的，并且源于一个生成函数 $S(x_n,x_{n+1})$；因此，其周期轨道可以被刻画为离散作用量的临界点。Aubry-Mather理论保证了对于单调扭转映射，具有预定旋转数的不变集的存在性，而Kolmogorov-Arnold-Moser (KAM) 定理确保了在小微扰下，足够丢番图的不变圆的持续存在。Greene判据提供了一种数值方法，通过检查旋转数逼近目标无理数的一系列周期轨道的线性稳定性留数，来检测不变圆的存在或破坏。\n\n从扭转映射的生成函数形式的离散变分原理出发，实现Greene判据，以检测旋转数为\n$$\n\\omega = \\frac{\\sqrt{5} - 1}{2}\n$$\n的不变圆，该旋转数是黄金比例的倒数。使用连分式收敛子 $\\frac{p_n}{q_n} = \\frac{F_{n-1}}{F_n}$（其中 $F_n$ 是斐波那契数）来逼近 $\\omega$。对于序列中的每个 $\\frac{p}{q}$，通过求解离散作用量的欧拉-拉格朗日方程来找到一个旋转数为 $\\frac{p}{q}$ 的 $q$-周期轨道\n$$\n\\mathcal{A}(x_0,\\dots,x_{q-1}) = \\sum_{n=0}^{q-1} \\left[ \\frac{1}{2}(x_{n+1} - x_n)^2 - \\frac{K}{2\\pi} \\cos(2\\pi x_n) \\right],\n$$\n并满足旋转边界条件 $x_q = x_0 + p$（正弦和余弦函数内的角度以弧度为单位），其中索引是循环使用的，并带有提升 $x_{-1}=x_{q-1}-p$ 和 $x_q=x_0+p$。临界点条件为\n$$\n2 x_n - x_{n-1} - x_{n+1} + K \\sin(2\\pi x_n) = 0 \\quad \\text{for all } n,\n$$\n并强制施加旋转边界条件。\n\n一旦找到周期轨道，计算其单值性矩阵 $M$，该矩阵是沿轨道各点映射的雅可比矩阵的乘积，\n$$\nA_n = \\begin{pmatrix}\n1 + K (2\\pi)\\cos(2\\pi x_n)  1 \\\\\nK (2\\pi)\\cos(2\\pi x_n)  1\n\\end{pmatrix}, \\quad M = A_{q-1} A_{q-2} \\cdots A_0,\n$$\n并计算Greene留数\n$$\nR = \\frac{2 - \\operatorname{tr}(M)}{4}.\n$$\n根据Greene判据，对于收敛到无理数 $\\omega$ 的一系列收敛子，如果相应周期轨道序列的留数有界地远离双曲区域并趋向于小值，则表明不变圆存在。实现一个鲁棒的数值分类器，对每个 $K$ 值返回一个布尔值，指示是否检测到旋转数为 $\\omega$ 的不变圆。\n\n您的算法必须：\n- 使用生成函数形式构建离散作用量及其梯度，并在三角函数内部以弧度为单位强制施加旋转边界条件 $x_q = x_0 + p$。\n- 使用带有线搜索的阻尼牛顿法，通过寻找欧拉-拉格朗日方程的根来求解周期轨道。线搜索应减小梯度范数，并从可积初始猜测 $x_n^{(0)} = x_0 + n \\frac{p}{q}$（其中 $x_0 = 0$）开始。\n- 为选定的一组 $\\omega$ 的收敛子（使用至少四个周期递增的不同周期 $q$），计算单值性矩阵和Greene留数。\n- 通过结合界限和趋势，使用留数序列对不变圆的存在性进行分类：如果任何留数是非椭圆的（非正或大于1），则拒绝；否则，仅当留数呈现下降趋势且最大周期的留数足够小时才接受。您的分类器必须是确定性的和纯数值的。\n\n角度单位说明：所有三角函数求值和派生量必须使用弧度。无需物理单位。\n\n测试套件：\n- 使用以下参数值 $K$：$K = 0.0$，$K = 0.5$，$K = 0.9715$ 和 $K = 1.1$。\n- 对每个 $K$ 值，使用周期 $q \\in \\{8, 13, 21, 34\\}$ 的黄金比例收敛子运行Greene判据。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含测试套件的布尔结果，以逗号分隔列表的形式并用方括号括起来，顺序与上面给出的 $K$ 值一致。例如，输出必须是 $[b_1,b_2,b_3,b_4]$ 的形式，其中每个 $b_i$ 是 True 或 False。",
            "solution": "用户提供了一个来自哈密顿动力学领域的有效且定义明确的问题。任务是为Chirikov标准映射实现Greene判据，以数值方式测试具有黄金比例旋转数的不变圆的存在性。现在我将提供一个完整且合理的解决方案。\n\n该问题要求为标准映射实现Greene判据，这是一种强大的数值技术，用于确定具有给定无理旋转数 $\\omega$ 的不变KAM (Kolmogorov-Arnold-Moser) 圆的存在性。该判据将不变圆的存在性与一系列周期轨道的稳定性属性联系起来，这些周期轨道的旋转数 $\\frac{p_n}{q_n}$ 是 $\\omega$ 的连分式渐近分式。\n\n对于每个非线性参数 $K$，该方法的核心包括三个主要步骤：\n1.  对于 $\\omega$ 的一系列有理逼近 $\\frac{p}{q}$，找到映射对应的周期轨道。\n2.  对每个周期轨道，计算其线性稳定性以及一个称为Greene留数 $R$ 的派生量。\n3.  分析当 $q \\to \\infty$ 时留数序列 $R_q$ 的行为，以推断不变圆的存在性。\n\n问题指定目标旋转数为黄金比例的倒数 $\\omega = \\frac{\\sqrt{5}-1}{2}$，其逼近值为斐波那契数的比值 $\\frac{p_k}{q_k} = \\frac{F_{k-1}}{F_k}$。\n\n**步骤 1：寻找周期轨道**\n\n标准映射由以下公式给出：\n$$\ny_{n+1} = y_n + K \\sin(2\\pi x_n)\n$$\n$$\nx_{n+1} = x_n + y_{n+1} \\pmod 1\n$$\n该映射可由生成函数 $S(x_n, x_{n+1}) = \\frac{1}{2}(x_{n+1}-x_n)^2 - \\frac{K}{2\\pi}\\cos(2\\pi x_n)$ 导出。周期轨道是离散作用量泛函的临界点，该泛函定义为生成函数在一个周期内的总和：\n$$\n\\mathcal{A}(x_0, \\dots, x_{q-1}) = \\sum_{n=0}^{q-1} S(x_n, x_{n+1})\n$$\n并满足旋转数为 $\\frac{p}{q}$ 的周期性边界条件 $x_q = x_0 + p$。临界点的条件是作用量对每个轨道点 $x_n$ 的偏导数为零，即 $\\frac{\\partial \\mathcal{A}}{\\partial x_n} = 0$。这产生离散的欧拉-拉格朗日方程组：\n$$\n\\frac{\\partial \\mathcal{A}}{\\partial x_n} = 2x_n - x_{n-1} - x_{n+1} + K \\sin(2\\pi x_n) = 0\n$$\n这是一个关于 $q$ 个轨道点 $x_0, x_1, \\dots, x_{q-1}$ 的 $q$ 个耦合非线性方程组。边界条件 $x_q = x_0 + p$ 和 $x_{-1} = x_{q-1} - p$ 被代入 $n=0$ 和 $n=q-1$ 的方程中。\n\n为求解此系统，我们采用阻尼牛顿-拉弗森法。令 $X = (x_0, \\dots, x_{q-1})^T$ 为轨道点向量，$F(X)$ 为欧拉-拉格朗日方程左侧的向量。牛顿迭代为：\n$$\nX_{k+1} = X_k + \\Delta X_k, \\quad \\text{其中 } J(X_k) \\Delta X_k = -F(X_k)\n$$\n这里，$J(X_k)$ 是 $F$ 在 $X_k$ 处求值的雅可比矩阵，其元素为：\n$$\nJ_{ij} = \\frac{\\partial F_i}{\\partial x_j} = (2 + 2\\pi K \\cos(2\\pi x_i))\\delta_{ij} - \\delta_{i, j+1} - \\delta_{i, j-1} \\pmod q\n$$\n雅可比矩阵是一个稀疏、对称、类循环的矩阵。为提高求解器的鲁棒性，使用了回溯线搜索。计算出牛顿步长 $\\Delta X_k$ 后，我们寻找一个阻尼因子 $\\lambda \\in (0, 1]$，使得更新 $X_{k+1} = X_k + \\lambda \\Delta X_k$ 能减小残差的范数，即 $\\|\\boldsymbol{F}(X_{k+1})\\|_2  \\|\\boldsymbol{F}(X_k)\\|_2$。迭代从可积情况 ($K=0$) 的初始猜测 $x_n^{(0)} = n \\frac{p}{q}$（其中 $x_0=0$）开始。\n\n**步骤 2：稳定性与Greene留数**\n\n一旦找到周期轨道，其线性稳定性由单值性矩阵 $M$ 决定，该矩阵是沿轨道各点映射的雅可比矩阵的乘积：\n$$\nM = A_{q-1} A_{q-2} \\cdots A_0, \\quad \\text{其中 } A_n = D_{(x_n, y_n)}T = \\begin{pmatrix} 1 + 2\\pi K \\cos(2\\pi x_n)  1 \\\\ 2\\pi K \\cos(2\\pi x_n)  1 \\end{pmatrix}\n$$\n该映射是保面积的，因此 $\\det(A_n) = 1$，从而 $\\det(M) = 1$。稳定性由 $M$ 的迹决定。如果 $|\\operatorname{tr}(M)|  2$，轨道是稳定的（椭圆的）；如果 $|\\operatorname{tr}(M)|  2$，是不稳定的（双曲的）；如果 $|\\operatorname{tr}(M)| = 2$，是临界稳定的（抛物的）。\n\nGreene留数 $R$ 是一个将迹标准化的便捷量：\n$$\nR = \\frac{2 - \\operatorname{tr}(M)}{4}\n$$\n用 $R$ 表示的稳定性条件为：\n- 椭圆的：$0  R  1$\n- 抛物的：$R = 0$\n- 反射双曲的：$R = 1$\n- 双曲的：$R  0$ 或 $R  1$\n\n**步骤 3：分类判据**\n\nGreene判据指出，当且仅当旋转数为 $p_n/q_n \\to \\omega$ 的周期轨道的留数 $R_q$ 收敛到零时，旋转数为 $\\omega$ 的不变圆才存在。如果不变圆被破坏，相应的周期轨道对于大的 $q$ 会变得双曲，留数会发散，即 $|R_q| \\to \\infty$。\n\n基于此，我们使用 $q \\in \\{8, 13, 21, 34\\}$ 的留数序列，实现一个确定性的数值分类器：\n1.  **求解器检查**：如果牛顿求解器对任何一个逼近分式都无法收敛，我们断定不变圆不存在。这表明附近没有周期轨道，是混沌的强烈迹象。\n2.  **椭圆性检查**：KAM圆由椭圆型轨道构成。我们要求序列中所有留数都严格处于椭圆区间：$0  R_q  1$。如果任何 $R_q \\le 0$ 或 $R_q \\ge 1$，我们断定不变圆已破裂。$K=0$ 的情况会得到 $R_q=0$，因此根据这个严格的“椭圆”要求被分类为不存在，我们将遵循问题陈述中的这一形式。\n3.  **趋势检查**：对于存在的不变圆，留数应收敛到零，对于像 $\\omega$ 这样的贵族旋转数，收敛通常是指数级的。我们对序列的尾部强制施加递减趋势：$R_{34}  R_{21}  R_{13}$。\n4.  **量级检查**：收敛必须是朝向零的。我们要求最大周期的留数足够小。选择阈值为 $R_{34}  10^{-4}$。\n\n如果给定的参数 $K$ 通过所有这些检查，算法报告 `True`（不变圆存在）；否则，报告 `False`。然后将此数值协议应用于指定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to execute Greene's criterion for the specified test cases.\n    \"\"\"\n\n    def get_fibonacci_convergents(q_values):\n        \"\"\"Generates Fibonacci numbers and the p/q convergents.\"\"\"\n        max_n = 0\n        if 8 in q_values: max_n = max(max_n, 6)\n        if 13 in q_values: max_n = max(max_n, 7)\n        if 21 in q_values: max_n = max(max_n, 8)\n        if 34 in q_values: max_n = max(max_n, 9)\n        \n        fibs = {0: 0, 1: 1}\n        for i in range(2, max_n + 1):\n            fibs[i] = fibs[i - 1] + fibs[i - 2]\n        \n        convergents = {}\n        if 8 in q_values: convergents[8] = fibs[5]\n        if 13 in q_values: convergents[13] = fibs[6]\n        if 21 in q_values: convergents[21] = fibs[7]\n        if 34 in q_values: convergents[34] = fibs[8]\n            \n        return convergents\n\n    def find_periodic_orbit(K, p, q):\n        \"\"\"\n        Solves for a periodic orbit using a damped Newton's method.\n        \"\"\"\n        x = np.arange(q, dtype=np.float64) * (p / q)\n\n        max_iter = 100\n        tol = 1e-12\n        min_lambda = 1e-8\n\n        for _ in range(max_iter):\n            # Calculate the residual vector F(x)\n            F = np.zeros(q, dtype=np.float64)\n            sin_x = np.sin(2 * np.pi * x)\n            \n            F[0] = 2 * x[0] - (x[q-1] - p) - x[1] + K * sin_x[0]\n            for n in range(1, q - 1):\n                F[n] = 2 * x[n] - x[n-1] - x[n+1] + K * sin_x[n]\n            F[q-1] = 2 * x[q-1] - x[q-2] - (x[0] + p) + K * sin_x[q-1]\n\n            norm_F_sq = np.dot(F, F)\n            if np.sqrt(norm_F_sq)  tol:\n                return x, True\n\n            # Calculate the Jacobian matrix J(x)\n            J = np.zeros((q, q), dtype=np.float64)\n            cos_x = np.cos(2 * np.pi * x)\n            \n            diag_J = 2 + K * 2 * np.pi * cos_x\n            np.fill_diagonal(J, diag_J)\n            \n            off_diag_val = -1.0\n            np.fill_diagonal(J[1:], off_diag_val)\n            np.fill_diagonal(J[:, 1:], off_diag_val)\n            \n            J[0, q-1] = off_diag_val\n            J[q-1, 0] = off_diag_val\n\n            try:\n                dx = np.linalg.solve(J, -F)\n            except np.linalg.LinAlgError:\n                return None, False\n\n            # Damped line search\n            lambda_val = 1.0\n            while lambda_val  min_lambda:\n                x_new = x + lambda_val * dx\n                \n                F_new = np.zeros(q, dtype=np.float64)\n                sin_x_new = np.sin(2 * np.pi * x_new)\n                \n                F_new[0] = 2*x_new[0] - (x_new[q-1] - p) - x_new[1] + K * sin_x_new[0]\n                for n in range(1, q - 1):\n                    F_new[n] = 2*x_new[n] - x_new[n-1] - x_new[n+1] + K*sin_x_new[n]\n                F_new[q-1] = 2*x_new[q-1]-x_new[q-2]-(x_new[0]+p) + K*sin_x_new[q-1]\n                \n                if np.dot(F_new, F_new)  norm_F_sq:\n                    x = x_new\n                    break\n                lambda_val /= 2.0\n            \n            if lambda_val = min_lambda:\n                return None, False\n\n        return None, False\n\n    def calculate_residue(K, q, orbit):\n        \"\"\"\n        Computes the monodromy matrix and Greene's residue for a given orbit.\n        \"\"\"\n        matrices = []\n        for n in range(q):\n            xn = orbit[n]\n            term = K * 2 * np.pi * np.cos(2 * np.pi * xn)\n            An = np.array([[1 + term, 1], [term, 1]], dtype=np.float64)\n            matrices.append(An)\n\n        # Compute M = A_{q-1} * A_{q-2} * ... * A_0\n        M = matrices[0]\n        for n in range(1, q):\n            M = np.dot(matrices[n], M)\n\n        trace_M = np.trace(M)\n        residue = (2.0 - trace_M) / 4.0\n        return residue\n\n    def classify_circle_existence(K, q_values):\n        \"\"\"\n        Runs the full Greene's criterion for a given K and classifies the result.\n        \"\"\"\n        convergents = get_fibonacci_convergents(q_values)\n        residues = []\n\n        for q in q_values:\n            p = convergents[q]\n            orbit, converged = find_periodic_orbit(K, p, q)\n            if not converged:\n                return False\n            \n            residue = calculate_residue(K, q, orbit)\n            residues.append(residue)\n        \n        # 1. Ellipticity check\n        for r in residues:\n            if r = 0 or r = 1:\n                return False\n\n        # 2. Trend check (on the last 3 residues)\n        R_13, R_21, R_34 = residues[1], residues[2], residues[3]\n        if not (R_34  R_21 and R_21  R_13):\n            return False\n\n        # 3. Magnitude check\n        if R_34  1e-4:\n            return False\n\n        return True\n\n    test_cases = [0.0, 0.5, 0.9715, 1.1]\n    q_values = [8, 13, 21, 34]\n    results = []\n\n    for K in test_cases:\n        result = classify_circle_existence(K, q_values)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}