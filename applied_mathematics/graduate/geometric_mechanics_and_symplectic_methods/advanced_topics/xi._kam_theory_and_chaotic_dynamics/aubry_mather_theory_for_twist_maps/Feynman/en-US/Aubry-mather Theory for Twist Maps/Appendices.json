{
    "hands_on_practices": [
        {
            "introduction": "The theoretical framework of Aubry-Mather theory is powerfully demonstrated through computation. This first practice invites you to implement Greene's criterion, a seminal numerical method that bridges the abstract existence of an invariant circle with the tangible stability properties of its periodic approximants . By coding this criterion for the Chirikov standard map, you will gain hands-on experience in how the structure of phase space is probed and understood in modern nonlinear dynamics.",
            "id": "3730073",
            "problem": "Consider the standard area-preserving twist map, also known as the Chirikov standard map, defined on the cylinder by the update rule\n$$\ny_{n+1} = y_n + K \\sin(2\\pi x_n), \\quad x_{n+1} = x_n + y_{n+1},\n$$\nwhere $K \\in \\mathbb{R}$ is the nonlinearity parameter and $\\sin(2\\pi x_n)$ is evaluated with the angle $2\\pi x_n$ in radians. This map is symplectic, monotone twist, and arises from a generating function $S(x_n,x_{n+1})$; consequently, its periodic orbits can be characterized as critical points of a discrete action. Aubry-Mather theory guarantees the existence of invariant sets with prescribed rotation numbers for monotone twist maps, and the Kolmogorov-Arnold-Moser (KAM) theorem ensures the persistence of sufficiently Diophantine invariant circles under small perturbations. Greene’s criterion provides a numerical method to detect the existence or destruction of invariant circles by examining the linear stability residues of a sequence of periodic orbits whose rotation numbers approximate a target irrational.\n\nStarting from the discrete variational principle for the generating function formulation of twist maps, implement Greene’s criterion for detecting the invariant circle of rotation number\n$$\n\\omega = \\frac{\\sqrt{5} - 1}{2},\n$$\nwhich is the inverse of the golden ratio. Use the continued fraction convergents $\\frac{p_n}{q_n} = \\frac{F_{n-1}}{F_n}$, where $F_n$ are Fibonacci numbers, to approximate $\\omega$. For each $\\frac{p}{q}$ in the sequence, find a $q$-periodic orbit with rotation number $\\frac{p}{q}$ by solving the Euler-Lagrange equations of the discrete action\n$$\n\\mathcal{A}(x_0,\\dots,x_{q-1}) = \\sum_{n=0}^{q-1} \\left[ \\frac{1}{2}(x_{n+1} - x_n)^2 - \\frac{K}{2\\pi} \\cos(2\\pi x_n) \\right],\n$$\nsubject to the rotation boundary condition $x_q = x_0 + p$ (angles inside sine and cosine are in radians), where indices are taken cyclically with the lift $x_{-1}=x_{q-1}-p$ and $x_q=x_0+p$. The critical point condition is\n$$\n2 x_n - x_{n-1} - x_{n+1} + K \\sin(2\\pi x_n) = 0 \\quad \\text{for all } n,\n$$\nwith the rotation boundary condition enforced.\n\nOnce a periodic orbit is found, compute the monodromy matrix $M$ as the product of the Jacobians of the map along the orbit,\n$$\nA_n = \\begin{pmatrix}\n1 + K (2\\pi)\\cos(2\\pi x_n) & 1 \\\\\nK (2\\pi)\\cos(2\\pi x_n) & 1\n\\end{pmatrix}, \\quad M = A_{q-1} A_{q-2} \\cdots A_0,\n$$\nand compute the Greene residue\n$$\nR = \\frac{2 - \\operatorname{tr}(M)}{4}.\n$$\nAs per Greene’s criterion, for a sequence of convergents to an irrational $\\omega$, the existence of the invariant circle is indicated if the residues for the sequence of periodic orbits remain bounded away from hyperbolic regimes and tend toward small values. Implement a robust numerical classification that returns a boolean for each $K$ indicating whether the invariant circle with rotation number $\\omega$ is detected.\n\nYour algorithm must:\n- Construct the discrete action and its gradient using the generating function formulation and enforce the rotation boundary condition $x_q = x_0 + p$ in radians inside trigonometric functions.\n- Solve for periodic orbits by finding roots of the Euler-Lagrange equations using a damped Newton method with a line search that decreases the gradient norm, starting from the integrable initial guess $x_n^{(0)} = x_0 + n \\frac{p}{q}$ with $x_0 = 0$.\n- Compute monodromy matrices and Greene residues for a chosen set of convergents to $\\omega$ (use at least four distinct periods with increasing $q$).\n- Classify the existence of the invariant circle using the sequence of residues by combining bounds and trend: reject if any residue is non-elliptic (nonpositive or larger than one), otherwise accept only if the residues exhibit a decreasing trend and the largest-period residue is sufficiently small. Your classifier must be deterministic and purely numerical.\n\nAngle unit specification: All trigonometric evaluations and derived quantities must use radians. No physical units are required.\n\nTest Suite:\n- Use the following parameter values for $K$: $K = 0.0$, $K = 0.5$, $K = 0.9715$, and $K = 1.1$.\n- For each $K$, run Greene’s criterion for the golden-mean convergents with periods $q \\in \\{8, 13, 21, 34\\}$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the boolean results for the test suite as a comma-separated list enclosed in square brackets, in the order of $K$ given above. For example, the output must be of the form $[b_1,b_2,b_3,b_4]$ where each $b_i$ is either True or False.",
            "solution": "The user has provided a valid, well-posed problem from the field of Hamiltonian dynamics. The task is to implement Greene's criterion for the Chirikov standard map to numerically test for the existence of the invariant circle with the golden ratio rotation number. I will now provide a complete, reasoned solution.\n\nThe problem asks for an implementation of Greene's criterion for the standard map, which is a powerful numerical technique for determining the existence of an invariant KAM (Kolmogorov-Arnold-Moser) circle with a given irrational rotation number $\\omega$. The criterion connects the existence of the circle to the stability properties of a sequence of periodic orbits whose rotation numbers $\\frac{p_n}{q_n}$ are continued fraction approximants to $\\omega$.\n\nThe core of the method involves three main steps for each nonlinearity parameter $K$:\n1.  For a sequence of rational approximants $\\frac{p}{q}$ to $\\omega$, find the corresponding periodic orbits of the map.\n2.  For each periodic orbit, compute its linear stability and a derived quantity known as Greene's residue, $R$.\n3.  Analyze the sequence of residues $R_q$ as $q \\to \\infty$ to infer the existence of the invariant circle.\n\nThe problem specifies the target rotation number as the inverse golden ratio $\\omega = \\frac{\\sqrt{5}-1}{2}$, and the approximants as ratios of Fibonacci numbers, $\\frac{p_k}{q_k} = \\frac{F_{k-1}}{F_k}$.\n\n**Step 1: Finding Periodic Orbits**\n\nThe standard map is given by\n$$\ny_{n+1} = y_n + K \\sin(2\\pi x_n)\n$$\n$$\nx_{n+1} = x_n + y_{n+1} \\pmod 1\n$$\nThis map can be derived from the generating function $S(x_n, x_{n+1}) = \\frac{1}{2}(x_{n+1}-x_n)^2 - \\frac{K}{2\\pi}\\cos(2\\pi x_n)$. Periodic orbits are critical points of the discrete action functional, defined as the sum of the generating function over one period:\n$$\n\\mathcal{A}(x_0, \\dots, x_{q-1}) = \\sum_{n=0}^{q-1} S(x_n, x_{n+1})\n$$\nsubject to the periodic boundary condition for a rotation number $\\frac{p}{q}$, which is $x_q = x_0 + p$. The condition for a critical point is that the partial derivatives of the action with respect to each orbit point $x_n$ are zero, $\\frac{\\partial \\mathcal{A}}{\\partial x_n} = 0$. This yields the discrete Euler-Lagrange equations:\n$$\n\\frac{\\partial \\mathcal{A}}{\\partial x_n} = 2x_n - x_{n-1} - x_{n+1} + K \\sin(2\\pi x_n) = 0\n$$\nThis is a system of $q$ coupled, nonlinear equations for the $q$ orbit points $x_0, x_1, \\dots, x_{q-1}$. The boundary conditions $x_q = x_0 + p$ and $x_{-1} = x_{q-1} - p$ are substituted into the equations for $n=0$ and $n=q-1$.\n\nTo solve this system, we employ a damped Newton-Raphson method. Let $X = (x_0, \\dots, x_{q-1})^T$ be the vector of orbit points and $F(X)$ be the vector of the left-hand sides of the Euler-Lagrange equations. The Newton iteration is:\n$$\nX_{k+1} = X_k + \\Delta X_k, \\quad \\text{where } J(X_k) \\Delta X_k = -F(X_k)\n$$\nHere, $J(X_k)$ is the Jacobian matrix of $F$ evaluated at $X_k$, with entries:\n$$\nJ_{ij} = \\frac{\\partial F_i}{\\partial x_j} = (2 + 2\\pi K \\cos(2\\pi x_i))\\delta_{ij} - \\delta_{i, j+1} - \\delta_{i, j-1}\n$$\nwhere indices are taken modulo $q$. The Jacobian is a sparse, symmetric, circulant-like matrix. To improve the robustness of the solver, a backtracking line search is used. After computing the Newton step $\\Delta X_k$, we find a damping factor $\\lambda \\in (0, 1]$ such that the update $X_{k+1} = X_k + \\lambda \\Delta X_k$ decreases the norm of the residual, i.e., $\\|F(X_{k+1})\\|_2 < \\|F(X_k)\\|_2$. The iteration starts from the initial guess for the integrable case ($K=0$), given by $x_n^{(0)} = n \\frac{p}{q}$ (with $x_0=0$).\n\n**Step 2: Stability and Greene's Residue**\n\nOnce a periodic orbit is found, its linear stability is determined by the monodromy matrix $M$, which is the product of the Jacobians of the map along the orbit:\n$$\nM = A_{q-1} A_{q-2} \\cdots A_0, \\quad \\text{where } A_n = D_{(x_n, y_n)}T = \\begin{pmatrix} 1 + 2\\pi K \\cos(2\\pi x_n) & 1 \\\\ 2\\pi K \\cos(2\\pi x_n) & 1 \\end{pmatrix}\n$$\nThe map is area-preserving, so $\\det(A_n) = 1$ and thus $\\det(M) = 1$. The stability is determined by the trace of $M$. The orbit is stable (elliptic) if $|\\operatorname{tr}(M)| < 2$, unstable (hyperbolic) if $|\\operatorname{tr}(M)| > 2$, and marginally stable (parabolic) if $|\\operatorname{tr}(M)| = 2$.\n\nGreene's residue $R$ is a convenient quantity that normalizes the trace:\n$$\nR = \\frac{2 - \\operatorname{tr}(M)}{4}\n$$\nThe conditions for stability in terms of $R$ are:\n- Elliptic: $0 < R < 1$\n- Parabolic: $R = 0$\n- Reflection-hyperbolic: $R = 1$\n- Hyperbolic: $R < 0$ or $R > 1$\n\n**Step 3: Classification Criterion**\n\nGreene's criterion states that an invariant circle with rotation number $\\omega$ exists if and only if the residues $R_q$ of the periodic orbits with rotation numbers $p_n/q_n \\to \\omega$ converge to zero. If the circle is destroyed, the corresponding periodic orbits become hyperbolic for large $q$, and the residues diverge, $|R_q| \\to \\infty$.\n\nBased on this, we implement a deterministic, numerical classifier using the sequence of residues for $q \\in \\{8, 13, 21, 34\\}$:\n1.  **Solver Check**: If the Newton solver fails to converge for any approximant, we conclude the circle does not exist. This indicates the absence of a nearby periodic orbit, a strong sign of chaos.\n2.  **Ellipticity Check**: The KAM circle is composed of elliptic-type orbits. We require all residues in the sequence to be strictly in the elliptic range: $0 < R_q < 1$. If any $R_q \\le 0$ or $R_q \\ge 1$, we conclude the circle is broken. The $K=0$ case yields $R_q=0$ and is therefore classified as non-existent under this strict \"elliptic\" requirement, which we will follow as per the problem's formulation.\n3.  **Trend Check**: For an existing circle, the residues should converge to zero, typically exponentially fast for a noble rotation number like $\\omega$. We enforce a decreasing trend on the tail of the sequence: $R_{34} < R_{21} < R_{13}$.\n4.  **Magnitude Check**: The convergence must be towards zero. We require the residue for the largest period to be sufficiently small. A threshold of $R_{34} < 10^{-4}$ is chosen.\n\nIf a given parameter $K$ passes all these checks, the algorithm reports `True` (circle exists); otherwise, it reports `False`. This numerical protocol is then applied to the specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to execute Greene's criterion for the specified test cases.\n    \"\"\"\n\n    def get_fibonacci_convergents(q_values):\n        \"\"\"Generates Fibonacci numbers and the p/q convergents.\"\"\"\n        max_n = 0\n        if 8 in q_values: max_n = max(max_n, 6)\n        if 13 in q_values: max_n = max(max_n, 7)\n        if 21 in q_values: max_n = max(max_n, 8)\n        if 34 in q_values: max_n = max(max_n, 9)\n        \n        fibs = {0: 0, 1: 1}\n        for i in range(2, max_n + 1):\n            fibs[i] = fibs[i - 1] + fibs[i - 2]\n        \n        convergents = {}\n        if 8 in q_values: convergents[8] = fibs[5]\n        if 13 in q_values: convergents[13] = fibs[6]\n        if 21 in q_values: convergents[21] = fibs[7]\n        if 34 in q_values: convergents[34] = fibs[8]\n            \n        return convergents\n\n    def find_periodic_orbit(K, p, q):\n        \"\"\"\n        Solves for a periodic orbit using a damped Newton's method.\n        \"\"\"\n        x = np.arange(q, dtype=np.float64) * (p / q)\n\n        max_iter = 100\n        tol = 1e-12\n        min_lambda = 1e-8\n\n        for _ in range(max_iter):\n            # Calculate the residual vector F(x)\n            F = np.zeros(q, dtype=np.float64)\n            sin_x = np.sin(2 * np.pi * x)\n            \n            F[0] = 2 * x[0] - (x[q-1] - p) - x[1] + K * sin_x[0]\n            for n in range(1, q - 1):\n                F[n] = 2 * x[n] - x[n-1] - x[n+1] + K * sin_x[n]\n            F[q-1] = 2 * x[q-1] - x[q-2] - (x[0] + p) + K * sin_x[q-1]\n\n            norm_F_sq = np.dot(F, F)\n            if np.sqrt(norm_F_sq) < tol:\n                return x, True\n\n            # Calculate the Jacobian matrix J(x)\n            J = np.zeros((q, q), dtype=np.float64)\n            cos_x = np.cos(2 * np.pi * x)\n            \n            diag_J = 2 + K * 2 * np.pi * cos_x\n            np.fill_diagonal(J, diag_J)\n            \n            off_diag_val = -1.0\n            np.fill_diagonal(J[1:], off_diag_val)\n            np.fill_diagonal(J[:, 1:], off_diag_val)\n            \n            J[0, q-1] = off_diag_val\n            J[q-1, 0] = off_diag_val\n\n            try:\n                dx = np.linalg.solve(J, -F)\n            except np.linalg.LinAlgError:\n                return None, False\n\n            # Damped line search\n            lambda_val = 1.0\n            while lambda_val > min_lambda:\n                x_new = x + lambda_val * dx\n                \n                F_new = np.zeros(q, dtype=np.float64)\n                sin_x_new = np.sin(2 * np.pi * x_new)\n                \n                F_new[0] = 2*x_new[0] - (x_new[q-1] - p) - x_new[1] + K * sin_x_new[0]\n                for n in range(1, q - 1):\n                    F_new[n] = 2*x_new[n] - x_new[n-1] - x_new[n+1] + K * sin_x_new[n]\n                F_new[q-1] = 2*x_new[q-1]-x_new[q-2]-(x_new[0]+p) + K*sin_x_new[q-1]\n                \n                if np.dot(F_new, F_new) < norm_F_sq:\n                    x = x_new\n                    break\n                lambda_val /= 2.0\n            \n            if lambda_val <= min_lambda:\n                return None, False\n\n        return None, False\n\n    def calculate_residue(K, q, orbit):\n        \"\"\"\n        Computes the monodromy matrix and Greene's residue for a given orbit.\n        \"\"\"\n        matrices = []\n        for n in range(q):\n            xn = orbit[n]\n            term = K * 2 * np.pi * np.cos(2 * np.pi * xn)\n            An = np.array([[1 + term, 1], [term, 1]], dtype=np.float64)\n            matrices.append(An)\n\n        # Compute M = A_{q-1} * A_{q-2} * ... * A_0\n        M = matrices[0]\n        for n in range(1, q):\n            M = np.dot(matrices[n], M)\n\n        trace_M = np.trace(M)\n        residue = (2.0 - trace_M) / 4.0\n        return residue\n\n    def classify_circle_existence(K, q_values):\n        \"\"\"\n        Runs the full Greene's criterion for a given K and classifies the result.\n        \"\"\"\n        convergents = get_fibonacci_convergents(q_values)\n        residues = []\n\n        for q in q_values:\n            p = convergents[q]\n            orbit, converged = find_periodic_orbit(K, p, q)\n            if not converged:\n                return False\n            \n            residue = calculate_residue(K, q, orbit)\n            residues.append(residue)\n        \n        # 1. Ellipticity check\n        for r in residues:\n            if r <= 0 or r >= 1:\n                return False\n\n        # 2. Trend check (on the last 3 residues)\n        R_13, R_21, R_34 = residues[1], residues[2], residues[3]\n        if not (R_34 < R_21 and R_21 < R_13):\n            return False\n\n        # 3. Magnitude check\n        if R_34 > 1e-4:\n            return False\n\n        return True\n\n    test_cases = [0.0, 0.5, 0.9715, 1.1]\n    q_values = [8, 13, 21, 34]\n    results = []\n\n    for K in test_cases:\n        result = classify_circle_existence(K, q_values)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having established a method for detecting invariant circles, we now apply this understanding to a critical question: at what precise point does a circle break? This exercise challenges you to consider the breakup of the golden mean invariant circle, the most robust of all KAM tori, by determining the critical parameter value $K_c$ . This problem deepens the connection between the stability of periodic orbits and the global transition to large-scale chaos, a central theme in Hamiltonian dynamics.",
            "id": "3746903",
            "problem": "Consider the Chirikov standard map, an exact symplectic diffeomorphism of the two-dimensional cylinder given by\n$$\np_{n+1} = p_n + K \\sin(x_n), \\qquad x_{n+1} = x_n + p_{n+1},\n$$\nwhere $x_n \\in \\mathbb{R}/(2\\pi\\mathbb{Z})$ is an angle variable (measured in radians), $p_n \\in \\mathbb{R}$ is an action-like variable, and $K \\geq 0$ is a dimensionless nonlinearity parameter.\n\nStarting from the fundamental definitions of symplectic maps and linear stability of periodic orbits, use Greene's criterion—which is based on the stability residues of sequences of rational periodic orbits whose rotation numbers are the continued-fraction convergents of an irrational rotation number—to determine the critical value $K_c$ at which the invariant circle with golden mean rotation number\n$$\n\\omega_g = \\frac{\\sqrt{5}-1}{2}\n$$\nbreaks up. Your derivation must:\n- begin from the exact symplectic structure of the map and the linearized dynamics, defining the monodromy matrix of a period-$q$ orbit and its stability in terms of the trace, and the residue as the canonical elliptic–hyperbolic indicator for two-dimensional symplectic maps,\n- apply Greene's criterion by tracking the residues along the sequence of rational approximants $p_n/q_n$ to $\\omega_g$ and identifying the threshold $K$ at which the limiting residue indicates breakup of the invariant circle,\n- relate the post-breakup structure to a Cantor-like invariant set (a cantorus) and explain how the associated homoclinic tangles of hyperbolic periodic orbits generate turnstile lobes acting as partial transport barriers,\n- express, as part of your reasoning, the asymptotic turnstile flux across the golden cantorus in terms of the exact symplectic generating function for the standard map,\n$$\nS(x,x') = \\frac{1}{2}\\,(x'-x)^2 + K \\cos(x),\n$$\nby writing it as a limiting action difference along the minimizing and minimax sequences of periodic approximants.\n\nCompute $K_c$ and provide its numerical value rounded to six significant figures. The final answer must be a single real number with no units inside the answer box.",
            "solution": "The problem asks for the critical nonlinearity parameter $K_c$ for the breakup of the golden mean invariant circle in the Chirikov standard map, derived using Greene's criterion and related concepts from Hamiltonian dynamics.\n\nFirst, we validate the problem statement.\nThe Chirikov standard map is given by the equations:\n$$\np_{n+1} = p_n + K \\sin(x_n)\n$$\n$$\nx_{n+1} = x_n + p_{n+1}\n$$\nwhere $x_n \\pmod{2\\pi}$ and $p_n \\in \\mathbb{R}$. The parameter $K \\ge 0$ controls the nonlinearity. The problem investigates the invariant circle with the golden mean rotation number, $\\omega_g = (\\sqrt{5}-1)/2$. The analysis is to be based on Greene's criterion, involving stability of periodic orbits, and related to cantori, homoclinic tangles, and flux calculations via the provided symplectic generating function $S(x,x') = \\frac{1}{2}(x'-x)^2 + K \\cos(x)$. All components of the problem—the standard map, KAM theory, Greene's criterion, Aubry-Mather theory (cantori), and generating functions—are fundamental and well-established concepts in the field of geometric mechanics and chaotic dynamics. The problem is scientifically grounded, well-posed, and objective. It is a canonical problem in chaos theory. Thus, the problem is valid, and we may proceed with the solution.\n\nWe begin by establishing the symplectic nature of the map and the framework for stability analysis. The map is a transformation $T: (x_n, p_n) \\mapsto (x_{n+1}, p_{n+1})$. Substituting the first equation into the second gives the explicit form $T(x, p) = (x + p + K\\sin(x), p + K\\sin(x))$. The Jacobian matrix of this transformation is\n$$\nDT(x, p) = \\begin{pmatrix} \\frac{\\partial x_{n+1}}{\\partial x_n} & \\frac{\\partial x_{n+1}}{\\partial p_n} \\\\ \\frac{\\partial p_{n+1}}{\\partial x_n} & \\frac{\\partial p_{n+1}}{\\partial p_n} \\end{pmatrix} = \\begin{pmatrix} 1 + K \\cos(x) & 1 \\\\ K \\cos(x) & 1 \\end{pmatrix}\n$$\nThe determinant of the Jacobian is $\\det(DT) = (1 + K \\cos(x))(1) - (1)(K \\cos(x)) = 1$. Since the determinant is a constant value of $1$, the map is symplectic; specifically, it is area-preserving in the $(x,p)$ phase plane.\n\nThe stability of a periodic orbit of period $q$, which is a sequence of points $\\{(x_i, p_i)\\}_{i=0}^{q-1}$ such that $T^q(x_0, p_0) = (x_0 + 2\\pi m, p_0)$ for some integer $m$, is determined by the linearization of the $q$-times iterated map, $T^q$, around any point on the orbit. The matrix of this linearized map is the monodromy matrix, $M_q = DT(x_{q-1}, p_{q-1}) \\cdots DT(x_0, p_0)$. As a product of matrices with unit determinant, $M_q$ also has $\\det(M_q)=1$. The eigenvalues $\\lambda$ of $M_q$ are roots of the characteristic polynomial $\\lambda^2 - \\text{Tr}(M_q)\\lambda + 1 = 0$. The stability of the orbit depends on the trace:\n- If $|\\text{Tr}(M_q)| < 2$, the eigenvalues are a complex conjugate pair on the unit circle, and the orbit is linearly stable (elliptic).\n- If $|\\text{Tr}(M_q)| > 2$, the eigenvalues are real and reciprocal ($\\lambda, 1/\\lambda$), and the orbit is unstable (hyperbolic).\n- If $|\\text{Tr}(M_q)| = 2$, the orbit is marginally stable (parabolic).\n\nA convenient stability indicator is the residue, $R$, defined as $R = \\frac{1}{4}(2 - \\text{Tr}(M_q))$. With this definition, $0  R  1$ for elliptic orbits. An orbit is hyperbolic if $R  0$ or $R > 1$.\n\nGreene's criterion connects the existence of a smooth invariant circle (a KAM torus) with a given irrational rotation number $\\omega$ to the behavior of periodic orbits whose rational rotation numbers $p_k/q_k$ are continued-fraction convergents of $\\omega$. The criterion states that the invariant circle exists if and only if the residues $R_k$ of these periodic orbits converge to a positive limit as $k \\to \\infty$. The breakup of the circle corresponds to the parameter value $K_c$ at which this limiting residue becomes zero.\n\nWe apply this to the invariant circle with the golden mean rotation number, $\\omega_g = \\frac{\\sqrt{5}-1}{2}$. Its continued fraction expansion is $[0; 1, 1, 1, \\dots]$. The sequence of convergents $p_k/q_k$ is formed by ratios of consecutive Fibonacci numbers, $F_{k-1}/F_k$, where $F_k$ are the standard Fibonacci numbers with $F_0=0, F_1=1$: $0/1, 1/1, 1/2, 2/3, 3/5, \\dots$. To find $K_c$, one must, for a given $K$, numerically find the period-$q_k$ orbits with rotation number $p_k/q_k$, compute their monodromy matrices and residues $R_k$, and then analyze the limit $\\lim_{k\\to\\infty} R_k$. The critical value $K_c$ is the specific value of $K$ for which this limit vanishes:\n$$\n\\lim_{k\\to\\infty} R(K_c; p_k/q_k) = 0\n$$\nFor $K  K_c$, this limit is positive, and a smooth KAM circle exists. For $K  K_c$, the limit becomes negative, signifying that the \"most robust\" periodic orbits approximating the circle have turned hyperbolic, and the smooth circle has been destroyed.\n\nWhen the invariant circle breaks up for $K  K_c$, its remnant is an invariant Cantor set known as a *cantorus*, as described by Aubry-Mather theory. This set is nowhere dense and has gaps. The hyperbolic periodic orbits (e.g., the Fibonacci approximants) which now constitute the backbone of the cantorus have stable ($W^s$) and unstable ($W^u$) manifolds. These manifolds intersect transversally, forming a complex structure called a *homoclinic tangle*. The regions in the phase plane bounded by segments of $W^s$ and $W^u$ between consecutive intersection points (homoclinic points) are called lobes. These lobes create a \"turnstile\" mechanism, which transports phase space area across the cantorus with each iteration of the map. Thus, for $K  K_c$, the cantorus is a partial transport barrier.\n\nThe flux, which is the area transported across the cantorus per map iteration, can be computed from the action principle using the given generating function $S(x,x') = \\frac{1}{2}(x'-x)^2 + K \\cos(x)$. This is a type-1 generating function $F_1(x_n, x_{n+1})$, from which the dynamics can be derived via $p_{n+1} = \\frac{\\partial S}{\\partial x_{n+1}}$ and $p_n = -\\frac{\\partial S}{\\partial x_n}$. A key result from Aubry-Mather theory is that for $K  K_c$, for each rational rotation number $p_k/q_k$, there exist at least two distinct periodic orbits: one that minimizes the action $W = \\sum_{i=0}^{q_k-1} S(x_i, x_{i+1})$, and another, a \"minimax\" orbit, which is a saddle point of the action. As $k \\to \\infty$, these sequences of orbits converge to two distinct configurations on the cantorus. The asymptotic flux across the golden cantorus, $\\Delta W$, is precisely the limiting difference in action between these minimax and minimizing sequences of periodic approximants:\n$$\n\\Delta W(K) = \\lim_{k\\to\\infty} \\left[ W_{\\text{minimax}}(p_k/q_k) - W_{\\text{min}}(p_k/q_k) \\right]\n$$\nThis action difference $\\Delta W(K)$ is zero for $K \\le K_c$ and becomes positive for $K  K_c$, quantifying the \"leakiness\" of the cantorus.\n\nThe critical value $K_c$ is a universal constant for the breakup of the golden mean torus in this class of maps. Its value has been determined with high precision through extensive numerical computation based on Greene's method described above. The accepted value is $K_c \\approx 0.97163540631$. The problem requires this value rounded to six significant figures.\n\nTherefore, the critical value is $K_c = 0.971635$.",
            "answer": "$$\\boxed{0.971635}$$"
        },
        {
            "introduction": "When an invariant circle breaks, what remains? The answer from Aubry-Mather theory is a cantorus, a leaky barrier that governs chaotic transport. This final practice uses the MacKay-Meiss-Percival principle to quantify this transport, revealing a profound connection between variational action and geometric flux . Using provided data from extremal orbits, you will calculate the flux $\\Delta W$ across the golden mean cantorus, making the abstract consequences of KAM theory breakdown concrete and calculable.",
            "id": "3746888",
            "problem": "Consider a symplectic twist map of the cylinder generated by a discrete Lagrangian (generating function) $S(x,x')$ so that the map $(x,p) \\mapsto (x',p')$ satisfies the discrete Euler–Lagrange relations $p = -\\partial_{x} S(x,x')$ and $p' = \\partial_{x'} S(x,x')$. For the Chirikov–Taylor standard map, take the generating function\n$$\nS(x,x') = \\frac{1}{2} (x' - x)^{2} - \\frac{K}{2\\pi} \\cos(2\\pi x),\n$$\nwith $K = 1.0$. A cantorus is the invariant set remaining after the destruction of an invariant torus with irrational rotation number (here, take the golden mean), and its transport properties can be probed by rational approximants $p/q$.\n\nYou are to use the MacKay–Meiss–Percival (MMP) variational principle, which relates flux across a cantorus to action differences of extremal orbits and to turnstile lobe areas in the adjacent Smale–Birkhoff homoclinic tangle formed by the stable and unstable manifolds of a nearby hyperbolic invariant set.\n\nStarting from the discrete variational principle and symplectic area conservation, do the following:\n\n1. Define the action over one period for a $q$-periodic orbit with rotation number $p/q$ as $W = \\sum_{k=0}^{q-1} S(x_{k},x_{k+1})$, and explain why there exist, for a given rational rotation number $p/q$, two distinct extremal $q$-periodic orbits: a minimizing orbit and a minimax (saddle) orbit, both in the class of monotone twist maps with generating function $S$. Using only fundamental definitions and properties (the discrete Euler–Lagrange equations, symplectic area conservation, and the existence of extremals), derive that the net flux per iterate across the cantorus associated with the irrational rotation number is equal to the difference of the actions of the minimizing and minimax orbits of the rational approximant, and that this equals the total area exchanged by the turnstile per iterate, i.e., the sum of the areas of its exit lobes.\n\n2. For the approximant $p/q = 3/5$, you are given the computed link actions $S(x_{k},x_{k+1})$ along the two extremal $q$-periodic orbits:\n- Minimizing orbit link actions (in order $k=0,1,2,3,4$):\n$$\n0.188735049,\\quad 0.214681923,\\quad 0.205193411,\\quad 0.197451208,\\quad 0.210875996.\n$$\n- Minimax orbit link actions (in order $k=0,1,2,3,4$):\n$$\n0.189103482,\\quad 0.215097256,\\quad 0.205481033,\\quad 0.197838021,\\quad 0.211263167.\n$$\nCompute the action difference $\\Delta W = W_{\\mathrm{minimax}} - W_{\\mathrm{min}}$ and interpret this as the flux per iterate across the cantorus. Under the hypothesis that the adjacent homoclinic tangle produces $q$ congruent exit lobes per iterate, compute the predicted area of a single exit lobe as $\\Delta W/q$.\n\n3. A direct measurement of the area of a single exit lobe from the adjacent homoclinic tangle yields $3.69074 \\times 10^{-4}$. Explain the consistency of this measurement with your prediction and the MMP variational principle.\n\nExpress your final result as the flux per iterate across the cantorus. Round your final numerical answer to six significant figures. No physical units are required for this phase-space area; report a dimensionless value. Angles, where relevant, are understood to be dimensionless phases on the unit circle.",
            "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, objective, and complete. It is a standard problem in the field of geometric mechanics and chaotic dynamics, asking for the application of the MacKay–Meiss–Percival (MMP) variational principle to the Chirikov–Taylor standard map.\n\nThe solution proceeds in three parts as requested.\n\nPart 1: Theoretical Framework\n\nA discrete-time dynamical system described by a map $(x,p) \\mapsto (x',p')$ is symplectic if it preserves the area element $dp \\wedge dx$. For a twist map, the map $(x_k, p_k) \\to (x_{k+1}, p_{k+1})$ can be implicitly defined by a generating function $S(x_k, x_{k+1})$ through the relations:\n$$\np_k = -\\frac{\\partial S(x_k, x_{k+1})}{\\partial x_k} \\quad \\text{and} \\quad p_{k+1} = \\frac{\\partial S(x_k, x_{k+1})}{\\partial x_{k+1}}\n$$\nAn orbit—a sequence of positions $\\{x_k\\}$—is a physical trajectory of the system if it is a critical point of the action $W = \\sum_{k} S(x_k, x_{k+1})$. The condition $\\partial W / \\partial x_k = 0$ for all $k$ leads to the discrete Euler-Lagrange equations:\n$$\n\\frac{\\partial S(x_{k-1}, x_k)}{\\partial x_k} + \\frac{\\partial S(x_k, x_{k+1})}{\\partial x_k} = 0\n$$\n\nFor the Chirikov-Taylor standard map, the map is a twist map for sufficiently small $K$. Aubry-Mather theory for such maps predicts that for any irrational rotation number $\\omega$, there exists an invariant set (a KAM torus if $\\omega$ is sufficiently irrational and $K$ is small, or a cantorus if the torus has been destroyed). For a rational rotation number $p/q$, the theory guarantees the existence of periodic orbits. For a generic twist map, at least two such $q$-periodic orbits with rotation number $p/q$ exist. One is a minimizing orbit, which corresponds to a global minimum of the action functional $W = \\sum_{k=0}^{q-1} S(x_k, x_{k+1})$ over all configurations with that rotation number. The other is a minimax (or saddle) orbit, which is not a minimum but is still an extremum (a saddle point in the function space of paths). The minimizing orbit is typically stable (elliptic or parabolic), while the minimax orbit is hyperbolic (unstable).\n\nThe MacKay-Meiss-Percival (MMP) principle provides the crucial link between these periodic orbits and chaotic transport. When the KAM torus with an irrational rotation number breaks, it leaves behind a cantorus, which is a disconnected invariant set that acts as a partial barrier to transport. Transport across this barrier is mediated by a turnstile, a region of phase space bounded by segments of the stable and unstable manifolds of the nearby hyperbolic (minimax) periodic orbit. The flux per iterate is defined as the total area of the lobes of the turnstile that cross the cantorus barrier in one iteration of the map.\n\nThe MMP theorem states that this flux is exactly equal to the difference in actions of the minimax and minimizing periodic orbits that approximate the cantorus:\n$$\n\\text{Flux per iterate} = \\Delta W = W_{\\mathrm{minimax}} - W_{\\mathrm{min}}\n$$\nThis result is derived by constructing a surface in phase space whose boundary is formed by the two periodic orbits ($\\gamma_{\\mathrm{minimax}}$ and $\\gamma_{\\mathrm{min}}$). The difference in the action integrals, $\\oint_{\\gamma_{\\mathrm{minimax}}} p \\, dx - \\oint_{\\gamma_{\\mathrm{min}}} p \\, dx$, is equal to the action difference $\\Delta W$. By Stokes's theorem, this difference of line integrals is equal to the area integral $\\iint_{\\mathcal{A}} dp \\wedge dx$, where $\\mathcal{A}$ is the area of the surface bounded by the orbits. This symplectic area is precisely the area transported across the barrier by the map, which is, by definition, the flux of the turnstile lobes. Thus, the action difference, a variational quantity, equals the flux, a geometric quantity.\n\nPart 2: Calculation for the $p/q = 3/5$ Approximant\n\nWe are given the link actions $S(x_k, x_{k+1})$ for the minimizing and minimax $5$-periodic orbits ($q=5$) with rotation number $3/5$.\n\nFirst, we calculate the total action $W_{\\mathrm{min}}$ for the minimizing orbit by summing its link actions:\n$$\nW_{\\mathrm{min}} = \\sum_{k=0}^{4} S_{\\mathrm{min}}(x_{k},x_{k+1}) = 0.188735049 + 0.214681923 + 0.205193411 + 0.197451208 + 0.210875996\n$$\n$$\nW_{\\mathrm{min}} = 1.016937587\n$$\n\nNext, we calculate the total action $W_{\\mathrm{minimax}}$ for the minimax orbit:\n$$\nW_{\\mathrm{minimax}} = \\sum_{k=0}^{4} S_{\\mathrm{minimax}}(x_{k},x_{k+1}) = 0.189103482 + 0.215097256 + 0.205481033 + 0.197838021 + 0.211263167\n$$\n$$\nW_{\\mathrm{minimax}} = 1.018782959\n$$\n\nThe flux per iterate across the cantorus is the action difference $\\Delta W$:\n$$\n\\Delta W = W_{\\mathrm{minimax}} - W_{\\mathrm{min}} = 1.018782959 - 1.016937587 = 0.001845372\n$$\n\nThe problem hypothesizes that the homoclinic tangle associated with the $q=5$ minimax orbit produces $q=5$ congruent exit lobes per iterate due to the periodic nature of the tangle. The total flux $\\Delta W$ is the sum of the areas of these lobes. Therefore, the predicted area of a single exit lobe is:\n$$\n\\text{Area}_{\\text{lobe}} = \\frac{\\Delta W}{q} = \\frac{0.001845372}{5} = 0.0003690744\n$$\n\nPart 3: Consistency with Direct Measurement\n\nThe predicted area of a single exit lobe, calculated from the variational principle, is $0.0003690744$. This can be written in scientific notation as $3.690744 \\times 10^{-4}$.\n\nWe are given that a direct numerical measurement of the area of a single exit lobe from the homoclinic tangle yields the value $3.69074 \\times 10^{-4}$.\n\nComparing the two results:\n- Predicted area: $3.690744 \\times 10^{-4}$\n- Measured area: $3.69074 \\times 10^{-4}$\n\nThe values are in excellent agreement, matching to the six significant figures provided for the measured value. This remarkable consistency provides strong numerical evidence for the validity of the MacKay–Meiss–Percival variational principle. It confirms the profound connection in Hamiltonian systems between variational properties of periodic orbits (actions) and the geometric properties of chaotic transport (lobe areas in a homoclinic tangle). The flux, a key measure of transport, can be accurately determined by finding extremal periodic orbits, which is often computationally more straightforward than directly measuring the areas of tangled lobes.\n\nThe final result requested is the flux per iterate across the cantorus, which is $\\Delta W$. Rounding this value to six significant figures:\n$$\n\\Delta W = 0.001845372 \\approx 0.00184537\n$$",
            "answer": "$$\n\\boxed{0.00184537}\n$$"
        }
    ]
}