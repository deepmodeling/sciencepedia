{
    "hands_on_practices": [
        {
            "introduction": "The persistence of invariant tori under perturbation, as guaranteed by the KAM theorem, fundamentally relies on the unperturbed system possessing a 'twist'. This means that the frequencies of motion on the tori must vary with the actions. This practice  provides a foundational exercise in verifying this crucial Kolmogorov nondegeneracy condition by having you compute the frequency map and its Jacobian for a standard integrable system.",
            "id": "3749706",
            "problem": "Consider an autonomous integrable Hamiltonian system with $n$ degrees of freedom in action-angle variables $(I,\\theta) \\in \\mathbb{R}^{n} \\times \\mathbb{T}^{n}$, where the angles are measured in radians and the symplectic structure is the canonical form $\\sum_{i=1}^{n} dI_{i} \\wedge d\\theta_{i}$. The unperturbed Hamiltonian is given by\n$$\nH_{0}(I) = \\frac{1}{2} \\sum_{i=1}^{n} a_{i} I_{i}^{2},\n$$\nwhere $a_{i} \\in \\mathbb{R}$ are constant parameters. Starting from Hamilton’s equations and the definition of the frequency map for integrable systems, derive the frequency map $\\omega(I)$ associated to $H_{0}(I)$. Then compute the Jacobian matrix $\\frac{\\partial \\omega}{\\partial I}(I)$ and, as a single analytic expression, give its determinant in terms of the coefficients $a_{i}$. Use these results to identify the Kolmogorov nondegeneracy condition for $H_{0}(I)$ in terms of the $a_{i}$, explaining how it follows from the determinant you computed. Your final answer must consist of the frequency map and the determinant of $\\frac{\\partial \\omega}{\\partial I}(I)$, presented together as a single composite expression. No numerical approximation is required.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of classical Hamiltonian mechanics and KAM theory, self-contained, well-posed, objective, and presents a standard, solvable exercise in the field.\n\nThe analysis proceeds by deriving the required quantities from first principles.\n\nThe system is an integrable Hamiltonian system with $n$ degrees of freedom, described by action-angle variables $(I, \\theta) \\in \\mathbb{R}^{n} \\times \\mathbb{T}^{n}$. The unperturbed Hamiltonian is given by:\n$$\nH_{0}(I) = \\frac{1}{2} \\sum_{j=1}^{n} a_{j} I_{j}^{2}\n$$\nwhere $a_{j} \\in \\mathbb{R}$ are constants and $I = (I_1, \\dots, I_n)$ are the action variables.\n\nFirst, we derive the frequency map $\\omega(I)$. The frequency map for an integrable system with Hamiltonian $H_0(I)$ is defined by the time evolution of the angle variables, which is given by Hamilton's equations.\nHamilton's equations for the canonical coordinates $(I_i, \\theta_i)$ are:\n$$\n\\dot{I}_{i} = -\\frac{\\partial H_{0}}{\\partial \\theta_{i}}\n$$\n$$\n\\dot{\\theta}_{i} = \\frac{\\partial H_{0}}{\\partial I_{i}}\n$$\nSince the Hamiltonian $H_0(I)$ depends only on the action variables $I$, the first set of equations yields:\n$$\n\\dot{I}_{i} = -\\frac{\\partial H_{0}}{\\partial \\theta_{i}} = 0\n$$\nThis confirms that the actions $I_i$ are constants of motion, which is the characteristic feature of an integrable system expressed in action-angle coordinates.\n\nThe second set of equations gives the frequencies of motion on the invariant tori. The frequency vector, or frequency map, $\\omega(I) = (\\omega_1(I), \\dots, \\omega_n(I))$ has components $\\omega_i(I) = \\dot{\\theta}_{i}$. Therefore, we compute:\n$$\n\\omega_{i}(I) = \\frac{\\partial H_{0}}{\\partial I_{i}} = \\frac{\\partial}{\\partial I_{i}} \\left( \\frac{1}{2} \\sum_{j=1}^{n} a_{j} I_{j}^{2} \\right)\n$$\nThe partial derivative acts on the sum. Since the variables $I_j$ are independent, the derivative $\\frac{\\partial I_j^2}{\\partial I_i}$ is non-zero only when $j=i$:\n$$\n\\frac{\\partial I_{j}^{2}}{\\partial I_{i}} = 2 I_{j} \\delta_{ij}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta.\nSubstituting this into the expression for $\\omega_i(I)$:\n$$\n\\omega_{i}(I) = \\frac{1}{2} \\sum_{j=1}^{n} a_{j} (2 I_{j} \\delta_{ij}) = \\frac{1}{2} (a_{i} \\cdot 2 I_{i}) = a_{i} I_{i}\n$$\nThus, the frequency map is the vector function $\\omega: \\mathbb{R}^n \\to \\mathbb{R}^n$ given by:\n$$\n\\omega(I) = (a_{1}I_{1}, a_{2}I_{2}, \\dots, a_{n}I_{n})\n$$\n\nNext, we compute the Jacobian matrix of the frequency map, $\\frac{\\partial \\omega}{\\partial I}(I)$. The elements of this matrix, which we denote as $J$, are given by $J_{ij} = \\frac{\\partial \\omega_i}{\\partial I_j}$.\nUsing the expression for $\\omega_i(I)$ we just derived:\n$$\nJ_{ij} = \\frac{\\partial \\omega_{i}}{\\partial I_{j}} = \\frac{\\partial}{\\partial I_{j}} (a_{i}I_{i})\n$$\nThis partial derivative is $a_i$ if $j=i$, and $0$ if $j \\neq i$.\n$$\nJ_{ij} = a_{i} \\delta_{ij}\n$$\nTherefore, the Jacobian matrix is a diagonal matrix:\n$$\n\\frac{\\partial \\omega}{\\partial I}(I) = \\begin{pmatrix}\na_1 & 0 & \\cdots & 0 \\\\\n0 & a_2 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\cdots & a_n\n\\end{pmatrix}\n$$\nNote that the Jacobian matrix is constant and does not depend on the action variables $I$.\n\nNow, we compute the determinant of this Jacobian matrix. The determinant of a diagonal matrix is the product of its diagonal elements.\n$$\n\\det\\left(\\frac{\\partial \\omega}{\\partial I}(I)\\right) = \\det\\begin{pmatrix}\na_1 & 0 & \\cdots & 0 \\\\\n0 & a_2 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\cdots & a_n\n\\end{pmatrix} = a_1 \\cdot a_2 \\cdot \\dots \\cdot a_n = \\prod_{i=1}^{n} a_{i}\n$$\nThis gives the required analytic expression for the determinant.\n\nFinally, we use this result to state the Kolmogorov nondegeneracy condition for the Hamiltonian $H_0(I)$. The KAM theorem requires that the unperturbed frequency map $\\omega(I)$ be a local diffeomorphism, which means its Jacobian matrix must be invertible. A matrix is invertible if and only if its determinant is non-zero. This is the Kolmogorov nondegeneracy condition:\n$$\n\\det\\left(\\frac{\\partial \\omega}{\\partial I}(I)\\right) \\neq 0\n$$\nApplying this to our result, the condition becomes:\n$$\n\\prod_{i=1}^{n} a_{i} \\neq 0\n$$\nThis product is non-zero if and only if none of the individual factors are zero. Therefore, the Kolmogorov nondegeneracy condition for the given Hamiltonian $H_0(I)$ is that all coefficients $a_i$ must be non-zero:\n$$\na_i \\neq 0 \\quad \\text{for all } i = 1, \\dots, n.\n$$\nIf this condition holds, the frequencies vary with the actions, and the system is non-degenerate. If any $a_k = 0$, then the frequency $\\omega_k = a_k I_k = 0$ is independent of the action $I_k$, leading to a degeneracy that violates the hypothesis of the KAM theorem.\n\nThe problem asks for the frequency map and the determinant as a single composite expression. The frequency map is $\\omega(I) = (a_{1}I_{1}, \\dots, a_{n}I_{n})$ and the determinant is $\\prod_{i=1}^{n} a_{i}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} (a_1 I_1, a_2 I_2, \\dots, a_n I_n) & \\prod_{i=1}^{n} a_i \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond the Hamiltonian's structure, the KAM theorem imposes a strict arithmetic condition on the frequencies themselves to avoid the destructive effects of resonance. This 'Diophantine' condition ensures that the frequencies are 'sufficiently irrational'. This exercise  demystifies this abstract concept by connecting it to the tangible and elegant theory of continued fractions, allowing you to characterize which numbers satisfy this non-resonance requirement.",
            "id": "3749725",
            "problem": "Consider the irrational rotation on the circle generated by a frequency $\\omega \\in (0,1)$, viewed as a one-dimensional integrable system in the sense of geometric mechanics and symplectic methods. In Kolmogorov–Arnold–Moser (KAM) theory, nonresonance is encoded by a Diophantine condition on $\\omega$ that controls small divisors arising in perturbation expansions. For the one-dimensional case $n=1$, the Diophantine condition is defined as the existence of constants $\\gamma>0$ and $\\tau \\geq 1$ such that\n$$\n|q \\,\\omega - p| \\geq \\gamma \\, q^{-\\tau} \\quad \\text{for all } p \\in \\mathbb{Z}, \\; q \\in \\mathbb{N}.\n$$\nLet $\\omega$ be irrational with continued fraction expansion $\\omega = [0;a_{1},a_{2},\\dots]$, and let $\\frac{p_{n}}{q_{n}}$ denote the $n$th convergent, where the partial quotients $a_{n}$ are integers with $a_{n} \\geq 1$ for all $n$. Using only fundamental facts about continued fractions and best rational approximations, do the following:\n\n1. Explain how the one-dimensional Diophantine condition with exponent $\\tau=1$ is characterized by the boundedness of the partial quotients $\\{a_{n}\\}$ (that is, by the existence of a finite bound on $a_{n}$).\n2. Assume there exists a fixed integer $A \\geq 1$ such that $a_{n} \\leq A$ for all $n$. Derive explicit constants $\\gamma$ and $\\tau$ (with $\\tau \\geq 1$) such that the Diophantine inequality above holds for all $p \\in \\mathbb{Z}$ and $q \\in \\mathbb{N}$. Your derivation must proceed from the foundational properties of continued fractions and their convergents, and should not rely on any unproven shortcut formulas. Express the final constants $\\gamma$ and $\\tau$ in closed form in terms of $A$.\n\nProvide your final answer as the pair $(\\gamma,\\tau)$.",
            "solution": "The problem statement is a valid exercise in the mathematical field of Diophantine approximation, which is a cornerstone of KAM theory. It is scientifically grounded, well-posed, and objective. It contains no scientific or factual unsoundness, is formalizable, and is directly relevant to the topic of geometric mechanics. The setup is complete and consistent. Therefore, a full solution can be provided.\n\nThe problem asks for two things: first, to explain the equivalence between the one-dimensional Diophantine condition with exponent $\\tau=1$ and the boundedness of the partial quotients of $\\omega$; second, to derive explicit constants $\\gamma$ and $\\tau$ for this condition assuming the partial quotients are bounded by an integer $A$.\n\n### Part 1: Characterization of the Diophantine Condition with $\\tau=1$\n\nAn irrational number $\\omega$ is said to satisfy a Diophantine condition with exponent $\\tau=1$ if there exists a constant $\\gamma > 0$ such that for all integers $p$ and positive integers $q$, the inequality $|q\\omega - p| \\ge \\gamma q^{-1}$ holds. We demonstrate that this condition is equivalent to the partial quotients $a_n$ in the continued fraction of $\\omega = [0; a_1, a_2, \\dots]$ being bounded.\n\n**($\\Rightarrow$) Bounded partial quotients imply the Diophantine condition with $\\tau=1$.**\n\nLet us assume there exists an integer $A \\ge 1$ such that $a_n \\le A$ for all. We need to show there is a $\\gamma > 0$ such that $|q\\omega - p| \\ge \\gamma/q$ for all $p \\in \\mathbb{Z}, q \\in \\mathbb{N}$.\n\nThe quality of a rational approximation $p/q$ to $\\omega$ is measured by $|\\omega - p/q|$. A fundamental result from the theory of continued fractions (Legendre's criterion on best rational approximations) states that if a rational number $p/q$ satisfies $|\\omega - p/q| < \\frac{1}{2q^2}$, then $p/q$ must be one of the convergents $p_n/q_n$ of $\\omega$.\n\nThis allows us to partition the problem into two cases for any given pair $(p,q)$.\n\n1.  **$p/q$ is not a convergent of $\\omega$.** In this case, Legendre's criterion implies that $|\\omega - p/q| \\ge \\frac{1}{2q^2}$. Multiplying by $q$ gives $|q\\omega - p| \\ge \\frac{1}{2q}$. This satisfies the Diophantine condition with $\\gamma_1=1/2$ and $\\tau=1$.\n\n2.  **$p/q$ is a convergent, $p_n/q_n$.** For convergents, we have the exact formula for the approximation error:\n    $$\n    |\\omega - \\frac{p_n}{q_n}| = \\frac{1}{q_n (\\alpha_{n+1} q_n + q_{n-1})}\n    $$\n    where $\\alpha_{n+1} = [a_{n+1}; a_{n+2}, \\dots]$ is the $(n+1)$-th complete quotient. Since $a_k \\ge 1$ for all $k$, we have $\\alpha_{n+1} = a_{n+1} + 1/\\alpha_{n+2} < a_{n+1}+1$. Also, from the recurrence $q_k = a_k q_{k-1} + q_{k-2}$, we know $q_n/q_{n-1} > 1$, hence $q_{n-1}/q_n < 1$.\n    The term in the denominator can be bounded:\n    $$\n    \\alpha_{n+1} q_n + q_{n-1} = (\\alpha_{n+1} + \\frac{q_{n-1}}{q_n}) q_n < ((a_{n+1}+1) + 1) q_n = (a_{n+1}+2) q_n\n    $$\n    Since the partial quotients are bounded by $A$, i.e., $a_{n+1} \\le A$, we get:\n    $$\n    \\alpha_{n+1} q_n + q_{n-1} < (A+2) q_n\n    $$\n    Substituting this into the error formula gives a lower bound on the approximation error for convergents:\n    $$\n    |\\omega - \\frac{p_n}{q_n}| > \\frac{1}{q_n ((A+2)q_n)} = \\frac{1}{(A+2)q_n^2}\n    $$\n    Multiplying by $q_n$ yields $|q_n\\omega - p_n| > \\frac{1}{(A+2)q_n}$. This satisfies the Diophantine condition with $\\gamma_2=1/(A+2)$ and $\\tau=1$.\n\nCombining both cases, the inequality $|q\\omega - p| \\ge \\gamma/q$ holds for all $p,q$ if we choose $\\gamma = \\min(\\gamma_1, \\gamma_2) = \\min(1/2, 1/(A+2))$. Since $A \\ge 1$, $A+2 \\ge 3$, so $1/(A+2) \\le 1/3 < 1/2$. Thus, we can take $\\gamma = 1/(A+2)$, and the condition holds with $\\tau=1$.\n\n**($\\Leftarrow$) The Diophantine condition with $\\tau=1$ implies bounded partial quotients.**\n\nAssume $\\omega$ satisfies $|q\\omega - p| \\ge \\gamma/q$ for some $\\gamma > 0$ and all $p \\in \\mathbb{Z}, q \\in \\mathbb{N}$. We want to show that the partial quotients $a_n$ are bounded.\nConsider the $n$-th convergent $p_n/q_n$. For this specific pair, the condition states:\n$$\n|q_n\\omega - p_n| \\ge \\frac{\\gamma}{q_n}\n$$\nFrom the theory of continued fractions, we also have a sharp upper bound on the error of convergents:\n$$\n|\\omega - \\frac{p_n}{q_n}| < \\frac{1}{q_n q_{n+1}}\n$$\nwhere $q_{n+1}$ is the denominator of the next convergent. Multiplying by $q_n$ gives:\n$$\n|q_n\\omega - p_n| < \\frac{1}{q_{n+1}}\n$$\nCombining the two inequalities, we have:\n$$\n\\frac{\\gamma}{q_n} \\le |q_n\\omega - p_n| < \\frac{1}{q_{n+1}} \\implies q_{n+1} < \\frac{q_n}{\\gamma}\n$$\nNow, we use the recurrence relation for the denominators of the convergents: $q_{n+1} = a_{n+1}q_n + q_{n-1}$. Since $q_{n-1} > 0$ for $n \\ge 1$, we have $q_{n+1} > a_{n+1}q_n$.\nCombining this with the previous result:\n$$\na_{n+1}q_n < q_{n+1} < \\frac{q_n}{\\gamma} \\implies a_{n+1}q_n < \\frac{q_n}{\\gamma}\n$$\nDividing by $q_n$ (which is positive) yields:\n$$\na_{n+1} < \\frac{1}{\\gamma}\n$$\nSince this holds for all $n \\ge 1$, the sequence of partial quotients $\\{a_n\\}$ is bounded by the constant $1/\\gamma$. This completes the demonstration of the equivalence.\n\n### Part 2: Derivation of Explicit Constants $\\gamma$ and $\\tau$\n\nWe are given that $a_n \\le A$ for some fixed integer $A \\ge 1$ and for all $n$. We need to derive explicit constants $\\gamma$ and $\\tau$ such that $|q \\omega - p| \\ge \\gamma q^{-\\tau}$ for all $p \\in \\mathbb{Z}, q \\in \\mathbb{N}$.\n\nOur derivation mirrors the first part of the argument above, but we will make it fully explicit and self-contained, based on foundational properties of continued fractions. The exponent $\\tau$ will naturally emerge from the analysis.\n\nLet $p \\in \\mathbb{Z}$ and $q \\in \\mathbb{N}$ be an arbitrary pair of integers. We seek a lower bound on $|q\\omega - p|$. We distinguish two cases.\n\n**Case 1: The rational number $p/q$ is a convergent of $\\omega$.**\nLet $p/q = p_n/q_n$ for some $n \\ge 0$. The error of a convergent is given by\n$$\n|q_n\\omega - p_n| = \\frac{1}{\\alpha_{n+1}q_n + q_{n-1}}\n$$\nwhere $\\alpha_{n+1} = [a_{n+1}; a_{n+2}, \\dots]$ is the $(n+1)$-th complete quotient.\nWe need an upper bound on the denominator $\\alpha_{n+1}q_n + q_{n-1}$.\nThe complete quotient $\\alpha_{n+1}$ can be written as $\\alpha_{n+1} = a_{n+1} + \\frac{1}{\\alpha_{n+2}}$. Since $a_k \\ge 1$ for all $k$, we have $\\alpha_{k} = [a_k; a_{k+1}, \\dots] \\ge 1$. Consequently, $0 < 1/\\alpha_{n+2} \\le 1$. This implies $a_{n+1} < \\alpha_{n+1} \\le a_{n+1}+1$.\nUsing the assumption $a_{n+1} \\le A$, we get $\\alpha_{n+1} \\le A+1$.\nAlso, the denominators of the convergents satisfy $q_k \\ge 1$ for all $k \\ge 1$, and they form a strictly increasing sequence. Thus, $q_{n-1} < q_n$ for $n \\ge 2$. For $n=1$, $q_0=1, q_1=a_1$, so $q_0 \\le q_1$. The inequality $q_{n-1} \\le q_n$ holds for all $n \\ge 1$.\nWe can now bound the denominator:\n$$\n\\alpha_{n+1}q_n + q_{n-1} \\le (A+1)q_n + q_{n-1} \\le (A+1)q_n + q_n = (A+2)q_n\n$$\nTherefore, for convergents, we have the lower bound:\n$$\n|q_n\\omega - p_n| = \\frac{1}{\\alpha_{n+1}q_n + q_{n-1}} \\ge \\frac{1}{(A+2)q_n}\n$$\nThe inequality is strict because $\\alpha_{n+1} < A+1$ unless all subsequent $a_k=1$ and $\\omega$ is quadratic, and $q_{n-1}<q_n$ for $n\\ge 2$. For our purposes, the non-strict inequality is sufficient. This shows that for any convergent $p_n/q_n$, the Diophantine inequality holds with $\\gamma = \\frac{1}{A+2}$ and $\\tau=1$.\n\n**Case 2: The rational number $p/q$ is not a convergent of $\\omega$.**\nWe invoke Legendre's criterion, a fundamental theorem in the theory of continued fractions, which states that if $p, q$ are integers with $q \\ge 1$ and\n$$\n|\\omega - \\frac{p}{q}| < \\frac{1}{2q^2}\n$$\nthen $p/q$ must be a convergent of $\\omega$.\nBy contraposition, if $p/q$ is *not* a convergent of $\\omega$, it must satisfy\n$$\n|\\omega - \\frac{p}{q}| \\ge \\frac{1}{2q^2}\n$$\nMultiplying by $q$ (and noting that this inequality holds for any integer $p$ associated with $q$, as long as $p/q$ is not a convergent), we get:\n$$\n|q\\omega - p| \\ge \\frac{1}{2q}\n$$\nThis demonstrates that for any approximation $p/q$ that is not a convergent, the Diophantine inequality is satisfied with $\\gamma = \\frac{1}{2}$ and $\\tau=1$. (If $p, q$ are not coprime, let $p=dp', q=dq'$. Then $|q\\omega-p| = d|q'\\omega-p'|$. If $p'/q'$ is not a convergent, $|q'\\omega-p'| \\ge 1/(2q')$, so $|q\\omega-p| \\ge d/(2q')=d^2/(2q) \\ge 1/(2q)$. If $p'/q'$ is a convergent $p_n/q_n$, then $|q\\omega-p| = d|q_n\\omega-p_n| \\ge d/((A+2)q_n) = d^2/((A+2)q) \\ge 1/((A+2)q)$. The argument holds).\n\n**Synthesis of Both Cases:**\nWe have shown that for any $q \\in \\mathbb{N}$ and any $p \\in \\mathbb{Z}$:\n- If $p/q$ is a convergent, $|q\\omega - p| \\ge \\frac{1}{(A+2)q}$.\n- If $p/q$ is not a convergent, $|q\\omega - p| \\ge \\frac{1}{2q}$.\n\nTo ensure the inequality $|q\\omega - p| \\ge \\gamma q^{-\\tau}$ holds for all pairs $(p,q)$, we must choose $\\tau$ and $\\gamma$ that satisfy both conditions. We see that an exponent of $\\tau=1$ works for both cases. We must then choose a value of $\\gamma$ that is a valid lower bound for both scenarios. This is achieved by taking the minimum of the two derived constants:\n$$\n\\gamma = \\min\\left(\\frac{1}{A+2}, \\frac{1}{2}\\right)\n$$\nSince we are given that $A \\ge 1$, it follows that $A+2 \\ge 3$. Therefore, $\\frac{1}{A+2} \\le \\frac{1}{3}$. This implies that $\\frac{1}{A+2} < \\frac{1}{2}$.\nThe minimum is thus:\n$$\n\\gamma = \\frac{1}{A+2}\n$$\nIn conclusion, for an irrational number $\\omega$ whose continued fraction partial quotients $a_n$ are bounded by $A$, the Diophantine condition $|q \\omega - p| \\ge \\gamma q^{-\\tau}$ is satisfied with the explicit constants $\\tau=1$ and $\\gamma = \\frac{1}{A+2}$.\n\nThe final pair of derived constants is $(\\gamma, \\tau)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{A+2} & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "When a system is non-degenerate and its frequencies are non-resonant, we can systematically 'tame' the effects of a small perturbation through a process of averaging. This leads to the Birkhoff normal form, which reveals the underlying, nearly-integrable structure of the perturbed system. This practice  walks you through this powerful technique, showing how to eliminate angle-dependent terms to construct an approximate new integral of motion, a key step in understanding long-term stability.",
            "id": "3749654",
            "problem": "Consider the Hamiltonian system on the symplectic vector space with canonical coordinates $(q_1,p_1,q_2,p_2)$ and the standard symplectic form, with Hamiltonian\n$$\nH(q,p) \\;=\\; \\frac{1}{2}\\big(\\omega_1(q_1^{2}+p_1^{2})+\\omega_2(q_2^{2}+p_2^{2})\\big)\\;+\\;\\epsilon\\, q_1^{2}\\,q_2^{2},\n$$\nwhere $\\omega_1,\\omega_2>0$ and $\\epsilon$ is a small real parameter. Work in the framework of action-angle variables for the unperturbed system and canonical Lie-transform perturbation theory based on the Poisson bracket. Assume a Kolmogorov-Arnold-Moser (KAM) nonresonance condition relevant to quartic terms: namely, for all integer vectors $(k_1,k_2)$ with $|k_1|+|k_2|\\leq 2$, one has $k_1\\omega_1+k_2\\omega_2\\neq 0$, so in particular $\\omega_1\\neq \\omega_2$.\n\nStarting from the definitions of action-angle variables for the harmonic oscillators and the Poisson bracket, construct the Birkhoff normal form of $H$ up to quartic order. That is, find a near-identity canonical transformation generated by a function of order $\\epsilon$ that eliminates all angle-dependent quartic terms and yields a normal-form Hamiltonian depending only on the actions to quartic order.\n\nExpress the final normal-form Hamiltonian as a single closed-form analytic expression in terms of the actions $I_1=\\frac{1}{2}(q_1^2+p_1^2)$ and $I_2=\\frac{1}{2}(q_2^2+p_2^2)$, the frequencies $\\omega_1,\\omega_2$, and the parameter $\\epsilon$. Your final answer must be a single analytic expression. No rounding is required and no units are to be included.",
            "solution": "The user has provided a valid problem statement.\n\nThe problem asks for the Birkhoff normal form, up to quartic order in the canonical coordinates $(q_k, p_k)$, of the Hamiltonian\n$$\nH(q,p) = \\frac{1}{2}\\big(\\omega_1(q_1^{2}+p_1^{2})+\\omega_2(q_2^{2}+p_2^{2})\\big)\\;+\\;\\epsilon\\, q_1^{2}\\,q_2^{2}\n$$\nThe Hamiltonian can be split into an unperturbed part $H_0$ and a perturbation $H_p$:\n$$\nH = H_0 + H_p\n$$\nwhere $H_0 = \\frac{1}{2}\\big(\\omega_1(q_1^{2}+p_1^{2})+\\omega_2(q_2^{2}+p_2^{2})\\big)$ is quadratic in the coordinates, and $H_p = \\epsilon\\, q_1^{2}\\,q_2^{2}$ is quartic.\n\nThe first step is to introduce action-angle variables $(I_1, I_2, \\theta_1, \\theta_2)$ for the unperturbed system $H_0$. The problem defines the action variables as $I_k = \\frac{1}{2}(q_k^2+p_k^2)$ for $k=1,2$. In terms of these actions, the unperturbed Hamiltonian $H_0$ is simply:\n$$\nH_0(I_1, I_2) = \\omega_1 I_1 + \\omega_2 I_2\n$$\nThis is already in normal form, as it depends only on the actions. The dynamics under $H_0$ are given by Hamilton's equations in action-angle variables:\n$$\n\\dot{I}_k = -\\frac{\\partial H_0}{\\partial \\theta_k} = 0\n$$\n$$\n\\dot{\\theta}_k = \\frac{\\partial H_0}{\\partial I_k} = \\omega_k\n$$\nThe transformation from canonical coordinates $(q_k, p_k)$ to action-angle variables $(I_k, \\theta_k)$ is given by:\n$$\nq_k = \\sqrt{2I_k} \\sin(\\theta_k)\n$$\n$$\np_k = \\sqrt{2I_k} \\cos(\\theta_k)\n$$\nThis choice is consistent with the definition of $I_k$ and the equations of motion for the unperturbed harmonic oscillators.\n\nNext, we express the perturbation $H_p$ in these action-angle variables:\n$$\nH_p = \\epsilon q_1^2 q_2^2 = \\epsilon (\\sqrt{2I_1} \\sin\\theta_1)^2 (\\sqrt{2I_2} \\sin\\theta_2)^2 = 4\\epsilon I_1 I_2 \\sin^2\\theta_1 \\sin^2\\theta_2\n$$\nThe full Hamiltonian is now $H = \\omega_1 I_1 + \\omega_2 I_2 + 4\\epsilon I_1 I_2 \\sin^2\\theta_1 \\sin^2\\theta_2$. The perturbation term is dependent on the angles $\\theta_1$ and $\\theta_2$.\n\nThe goal of constructing the Birkhoff normal form up to quartic order is to find a canonical transformation that eliminates the angle dependence in the quartic part of the Hamiltonian. The method of Lie transforms provides a systematic way to achieve this. The normal form $K$ is obtained by averaging the perturbation over the fast angular variables. The procedure, to first order in $\\epsilon$, yields a new Hamiltonian $K$ which is angle-independent up to that order.\n\nThe normal form $K$ is given by $K = H_0 + \\epsilon K_1 + O(\\epsilon^2)$. The first-order term $K_1$ is the average of the original perturbation term $H_1 = H_p/\\epsilon$ over a full period of the angles:\n$$\nK_1 = \\langle H_1 \\rangle = \\frac{1}{(2\\pi)^2} \\int_0^{2\\pi} \\int_0^{2\\pi} 4 I_1 I_2 \\sin^2\\theta_1 \\sin^2\\theta_2 \\, d\\theta_1 d\\theta_2\n$$\nThe average can be computed by separating the integrals:\n$$\nK_1 = 4 I_1 I_2 \\left( \\frac{1}{2\\pi} \\int_0^{2\\pi} \\sin^2\\theta_1 \\, d\\theta_1 \\right) \\left( \\frac{1}{2\\pi} \\int_0^{2\\pi} \\sin^2\\theta_2 \\, d\\theta_2 \\right)\n$$\nThe average value of $\\sin^2\\theta$ over one period is a standard result:\n$$\n\\frac{1}{2\\pi} \\int_0^{2\\pi} \\sin^2\\theta \\, d\\theta = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{1-\\cos(2\\theta)}{2} \\, d\\theta = \\frac{1}{4\\pi} \\left[ \\theta - \\frac{1}{2}\\sin(2\\theta) \\right]_0^{2\\pi} = \\frac{1}{4\\pi} (2\\pi) = \\frac{1}{2}\n$$\nSubstituting this back into the expression for $K_1$:\n$$\nK_1 = 4 I_1 I_2 \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = I_1 I_2\n$$\nThe Birkhoff normal form up to first order in $\\epsilon$ is therefore:\n$$\nK = H_0 + \\epsilon K_1 = \\omega_1 I_1 + \\omega_2 I_2 + \\epsilon I_1 I_2\n$$\nThe term \"up to quartic order\" refers to the polynomial degree of the terms in the phase space variables $(q_k, p_k)$. The term $H_0$ is of degree $2$. The term $\\epsilon K_1 = \\epsilon I_1 I_2 = \\epsilon (\\frac{1}{2}(q_1^2+p_1^2)) (\\frac{1}{2}(q_2^2+p_2^2))$ is of degree $4$. Higher-order terms in the normal form expansion (of order $\\epsilon^2$ and higher) would involve Poisson brackets of terms like $H_1$ and the generating function $S_1$. As $H_1$ is quartic, these higher-order terms would be of degree $6$ or greater in the phase space variables. Thus, the expression $K = H_0 + \\epsilon K_1$ represents the complete normal form up to and including quartic terms.\n\nThe existence of the canonical transformation that brings the Hamiltonian to this normal form relies on the non-resonance condition. The part of the perturbation to be eliminated is $\\tilde{H}_1 = H_1 - \\langle H_1 \\rangle$. Using trigonometric identities, one finds this contains terms with angular dependence $\\cos(2\\theta_1)$, $\\cos(2\\theta_2)$, and combinations like $\\cos(2\\theta_1 \\pm 2\\theta_2)$. Eliminating these terms via the homological equation $\\{H_0, S_1\\} + \\tilde{H}_1 = 0$ requires division by the frequencies $k_1\\omega_1+k_2\\omega_2$, where the integer vector $k=(k_1,k_2)$ corresponds to the Fourier modes present in $\\tilde{H}_1$. These vectors are $(\\pm 2, 0)$, $(0, \\pm 2)$, $(\\pm 2, \\pm 2)$, and $(\\pm 2, \\mp 2)$. The necessary conditions are therefore $2\\omega_1 \\neq 0$, $2\\omega_2 \\neq 0$, and $2\\omega_1 \\pm 2\\omega_2 \\neq 0$. Since $\\omega_1, \\omega_2 > 0$, these simplify to the single condition $\\omega_1 \\neq \\omega_2$, which is explicitly assumed in the problem statement. The stated KAM condition, $k_1\\omega_1+k_2\\omega_2 \\neq 0$ for $|k_1|+|k_2|\\leq 2$, is sufficient to ensure the procedure is well-defined.\n\nThe final normal-form Hamiltonian to the specified order, expressed in terms of the actions $I_1$ and $I_2$, is:\n$$\nH_{NF}(I_1, I_2) = \\omega_1 I_1 + \\omega_2 I_2 + \\epsilon I_1 I_2\n$$\nThis expression depends only on the actions $I_1$ and $I_2$, as required for a normal form.",
            "answer": "$$\n\\boxed{\\omega_1 I_1 + \\omega_2 I_2 + \\epsilon I_1 I_2}\n$$"
        }
    ]
}