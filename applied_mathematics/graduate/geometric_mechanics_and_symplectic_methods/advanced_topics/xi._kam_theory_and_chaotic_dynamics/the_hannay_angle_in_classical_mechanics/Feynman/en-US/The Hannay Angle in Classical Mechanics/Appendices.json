{
    "hands_on_practices": [
        {
            "introduction": "Mastering the Hannay angle begins with the ability to perform a direct calculation from first principles. This exercise challenges you to compute the geometric phase for a two-dimensional anisotropic harmonic oscillator whose principal axes are slowly rotated. By applying the formalism of canonical transformations and adiabatic averaging, you will uncover how symmetries within the system's dynamics can lead to a vanishing Hannay angle, a result that underscores the subtle nature of geometric effects .",
            "id": "3776742",
            "problem": "Consider a planar, two-degree-of-freedom, anisotropic harmonic oscillator of mass $m$ with principal-axis coordinates $(x',y')$ and conjugate momenta $(p_{x}',p_{y}')$. Its Hamiltonian in the principal frame is\n$$\nH(x',y',p_{x}',p_{y}')=\\frac{1}{2m}\\left(p_{x}'^{2}+p_{y}'^{2}\\right)+\\frac{m}{2}\\left(\\omega_{1}^{2}\\,x'^{2}+\\omega_{2}^{2}\\,y'^{2}\\right),\n$$\nwhere $\\omega_{1}\\neq\\omega_{2}$ are fixed, positive frequencies. The principal axes $(x',y')$ are related to lab coordinates $(x,y)$ by a rotation through an angle $\\theta(t)$, with $\\theta(0)=0$ and $\\theta(T)=2\\pi$ for some time $T$. The rotation is quasistatic in the sense that $|\\dot{\\theta}(t)|\\ll \\min\\{\\omega_{1},\\omega_{2}\\}$ for all $t\\in[0,T]$, and the ratio $\\omega_{1}/\\omega_{2}$ is irrational (nonresonant). Assume adiabatic invariance of the actions throughout the evolution.\n\nAt each instant, introduce the action-angle variables $(J_{1},\\phi_{1})$ and $(J_{2},\\phi_{2})$ for the decoupled oscillators along the instantaneous principal axes. The Hannay angle is defined as the angle-variable increment over the cycle $[0,T]$ beyond the dynamical contribution, induced purely by the slow cyclic transport of the parameter $\\theta$.\n\nCompute the Hannay angle accumulated by the first normal mode angle variable $\\phi_{1}$ after one full rotation of the principal axes from $\\theta=0$ to $\\theta=2\\pi$. Express your final answer in radians. No rounding is required.",
            "solution": "The user wants to compute the Hannay angle for a 2D anisotropic harmonic oscillator whose principal axes are slowly rotated.\n\n### Step 1: Problem Validation\n\n**1. Extraction of Givens:**\n- System: A planar, two-degree-of-freedom, anisotropic harmonic oscillator.\n- Mass: $m$.\n- Principal-axis coordinates and conjugate momenta: $(x', y', p_{x}', p_{y}')$.\n- Hamiltonian in the principal frame: $H(x',y',p_{x}',p_{y}')=\\frac{1}{2m}\\left(p_{x}'^{2}+p_{y}'^{2}\\right)+\\frac{m}{2}\\left(\\omega_{1}^{2}\\,x'^{2}+\\omega_{2}^{2}\\,y'^{2}\\right)$.\n- Frequencies: $\\omega_{1}\\neq\\omega_{2}$ are fixed, positive constants.\n- Coordinate transformation: Principal axes $(x',y')$ are related to lab coordinates $(x,y)$ by a rotation angle $\\theta(t)$.\n- Parameter cycle: $\\theta(0)=0$ and $\\theta(T)=2\\pi$.\n- Adiabatic condition: The rotation is quasistatic, $|\\dot{\\theta}(t)|\\ll \\min\\{\\omega_{1},\\omega_{2}\\}$.\n- Non-resonance condition: The ratio $\\omega_{1}/\\omega_{2}$ is irrational.\n- Action-angle variables: At each instant, $(J_{1},\\phi_{1})$ and $(J_{2},\\phi_{2})$ are introduced for the decoupled oscillators along the instantaneous principal axes.\n- Adiabatic Invariance Assumption: The actions $J_1$ and $J_2$ are assumed to be invariant throughout the evolution.\n- Objective: Compute the Hannay angle for the angle variable $\\phi_1$ after one full rotation from $\\theta=0$ to $\\theta=2\\pi$.\n\n**2. Validation using Extracted Givens:**\n- **Scientific Groundedness:** The problem describes a standard physical system within classical mechanics and investigates a well-established concept (the Hannay angle) in the context of adiabatic theory. The Hamiltonian is standard for an anisotropic oscillator. The setup is scientifically sound.\n- **Well-Posedness:** The problem is well-posed. It provides a clear objective and all the necessary physical parameters, initial/final conditions for the slow parameter, and crucial assumptions (adiabatic rotation, non-resonant frequencies, invariance of the specified actions).\n- **Objectivity:** The problem is stated in precise, objective mathematical language.\n- **Completeness:** The problem is self-contained. The Hamiltonian, the parameter that is being varied ($\\theta$), the path in parameter space, and the specific quantities to be held invariant ($J_1$, $J_2$) are all explicitly defined.\n\n**3. Verdict and Action:**\nThe problem is deemed **valid** as it is self-contained, scientifically sound, and well-posed based on the provided text. The instructions and assumptions, though leading to a specific outcome, are clear and must be followed rigorously.\n\n### Step 2: Solution\n\nThe Hannay angle is the geometric contribution to the change in an angle variable when a system's parameters are varied adiabatically around a closed loop. We begin by establishing the Hamiltonian that governs the dynamics in a coordinate system suitable for applying the adiabatic hypothesis.\n\nThe transformation from the lab coordinates $(x,y)$ to the rotating principal-axis coordinates $(x',y')$ is given by a rotation matrix $R(\\theta(t))$:\n$$\n\\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} x' \\\\ y' \\end{pmatrix}\n$$\nThis is a time-dependent point transformation. The Hamiltonian in the moving frame $(x', y')$ with conjugate momenta $(p'_x, p'_y)$ is found by a canonical transformation. Let the generating function be $F_2(x,y,p'_x,p'_y,t) = p'_x x'(x,y,t) + p'_y y'(x,y,t)$. The Hamiltonian $K$ in the new coordinates is given by $K = H_{\\text{lab}} + \\frac{\\partial F_2}{\\partial t}$.\n\nThe lab-frame Hamiltonian $H_{\\text{lab}}$ expressed in the rotating-frame variables becomes the given Hamiltonian, which we call $H_0$:\n$$ H_0 = \\frac{1}{2m}\\left(p_{x}'^{2}+p_{y}'^{2}\\right)+\\frac{m}{2}\\left(\\omega_{1}^{2}\\,x'^{2}+\\omega_{2}^{2}\\,y'^{2}\\right) $$\nThe time-dependent part of the generating function gives rise to an additional term in the Hamiltonian:\n$$ \\frac{\\partial F_2}{\\partial t} = \\frac{\\partial F_2}{\\partial \\theta} \\dot{\\theta} $$\nThe generating function is $F_2 = p'_x (x\\cos\\theta + y\\sin\\theta) + p'_y(-x\\sin\\theta+y\\cos\\theta)$.\n$$ \\frac{\\partial F_2}{\\partial \\theta} = p'_x(-x\\sin\\theta+y\\cos\\theta) + p'_y(-x\\cos\\theta-y\\sin\\theta) = p'_x y' - p'_y x' = -L_z' $$\nwhere $L_z' = x'p'_y - y'p'_x$ is the angular momentum expressed in the rotating frame's canonical variables.\n\nThus, the Hamiltonian governing the dynamics in the rotating frame is:\n$$ K = H_0 - \\dot{\\theta} L_z' $$\nThe problem defines the action-angle variables $(J_1, \\phi_1, J_2, \\phi_2)$ for the unperturbed, decoupled Hamiltonian $H_0$. In these variables, $H_0 = \\omega_1 J_1 + \\omega_2 J_2$. The full Hamiltonian in these action-angle variables is:\n$$ K(J_1, J_2, \\phi_1, \\phi_2, t) = \\omega_1 J_1 + \\omega_2 J_2 - \\dot{\\theta}(t) L_z'(J_1, J_2, \\phi_1, \\phi_2) $$\nThe time evolution of the angle variable $\\phi_1$ is given by Hamilton's equation:\n$$ \\dot{\\phi_1} = \\frac{\\partial K}{\\partial J_1} = \\frac{\\partial H_0}{\\partial J_1} - \\dot{\\theta} \\frac{\\partial L_z'}{\\partial J_1} = \\omega_1 - \\dot{\\theta} \\frac{\\partial L_z'}{\\partial J_1} $$\nThe total change in $\\phi_1$ over the cycle $[0, T]$ is:\n$$ \\Delta\\phi_1 = \\int_0^T \\dot{\\phi_1} dt = \\int_0^T \\omega_1 dt - \\int_0^T \\dot{\\theta} \\frac{\\partial L_z'}{\\partial J_1} dt $$\nThe first term is the dynamical phase. The second term, the Hannay angle $\\Delta\\phi_{H,1}$, is the geometric contribution that depends on the path in parameter space. In the adiabatic limit, the instantaneous state explores the invariant torus of $H_0$. We replace the rapidly oscillating term $\\frac{\\partial L_z'}{\\partial J_1}$ with its average over the fast motion, denoted by $\\langle \\cdot \\rangle$.\n$$ \\Delta\\phi_{H,1} = - \\int_0^T \\dot{\\theta} \\left\\langle \\frac{\\partial L_z'}{\\partial J_1} \\right\\rangle dt = - \\int_0^{2\\pi} \\left\\langle \\frac{\\partial L_z'}{\\partial J_1} \\right\\rangle d\\theta $$\nSince the actions $J_k$ are assumed to be constant during the fast motion, we can interchange averaging and differentiation:\n$$ \\Delta\\phi_{H,1} = - \\int_0^{2\\pi} \\frac{\\partial \\langle L_z' \\rangle}{\\partial J_1} d\\theta $$\nWe now compute $\\langle L_z' \\rangle$. The expressions for the coordinates and momenta in terms of the action-angle variables of $H_0$ are:\n$$ x' = \\sqrt{\\frac{2J_1}{m\\omega_1}} \\cos\\phi_1 \\quad , \\quad p_x' = -\\sqrt{2m\\omega_1 J_1} \\sin\\phi_1 $$\n$$ y' = \\sqrt{\\frac{2J_2}{m\\omega_2}} \\cos\\phi_2 \\quad , \\quad p_y' = -\\sqrt{2m\\omega_2 J_2} \\sin\\phi_2 $$\nSubstituting into the expression for $L_z' = x'p'_y - y'p'_x$:\n$$ x'p'_y = \\left( \\sqrt{\\frac{2J_1}{m\\omega_1}} \\cos\\phi_1 \\right) \\left( -\\sqrt{2m\\omega_2 J_2} \\sin\\phi_2 \\right) = -2\\sqrt{J_1 J_2 \\frac{\\omega_2}{\\omega_1}} \\cos\\phi_1 \\sin\\phi_2 $$\n$$ y'p'_x = \\left( \\sqrt{\\frac{2J_2}{m\\omega_2}} \\cos\\phi_2 \\right) \\left( -\\sqrt{2m\\omega_1 J_1} \\sin\\phi_1 \\right) = -2\\sqrt{J_1 J_2 \\frac{\\omega_1}{\\omega_2}} \\cos\\phi_2 \\sin\\phi_1 $$\n$$ L_z' = 2\\sqrt{J_1 J_2} \\left[ \\sqrt{\\frac{\\omega_1}{\\omega_2}} \\sin\\phi_1 \\cos\\phi_2 - \\sqrt{\\frac{\\omega_2}{\\omega_1}} \\cos\\phi_1 \\sin\\phi_2 \\right] $$\nThe average $\\langle L_z' \\rangle$ is taken over the invariant torus parameterized by $\\phi_1$ and $\\phi_2$. Since the ratio of frequencies $\\omega_1/\\omega_2$ is irrational, the motion is ergodic, and the time average is equivalent to the phase-space average:\n$$ \\langle f(\\phi_1, \\phi_2) \\rangle = \\frac{1}{(2\\pi)^2} \\int_0^{2\\pi} \\int_0^{2\\pi} f(\\phi_1, \\phi_2) d\\phi_1 d\\phi_2 $$\nThe average of the terms in $L_z'$ involves integrals like:\n$$ \\int_0^{2\\pi}\\int_0^{2\\pi} \\sin\\phi_1 \\cos\\phi_2 \\, d\\phi_1 d\\phi_2 = \\left(\\int_0^{2\\pi} \\sin\\phi_1 d\\phi_1\\right) \\left(\\int_0^{2\\pi} \\cos\\phi_2 d\\phi_2\\right) = 0 \\times 0 = 0 $$\nAnd similarly for the other term. Therefore, the average angular momentum is zero:\n$$ \\langle L_z' \\rangle = 0 $$\nThe integrand for the Hannay angle is $\\frac{\\partial \\langle L_z' \\rangle}{\\partial J_1} = \\frac{\\partial (0)}{\\partial J_1} = 0$.\nThe Hannay angle is therefore:\n$$ \\Delta\\phi_{H,1} = - \\int_0^{2\\pi} 0 \\, d\\theta = 0 $$\nThis result is a direct and necessary consequence of the problem's explicit assumptions: that the adiabatic invariants are the actions $J_k$ corresponding to the unperturbed Hamiltonian $H_0$. While a more advanced treatment might yield a non-zero result by defining the invariants differently or using higher-order averaging theory, adhering strictly to the premises of the problem leads to this conclusion.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "From a formal exercise, we now turn to one of the most celebrated physical manifestations of a geometric phase: the Foucault pendulum. This problem guides you to reinterpret the famous precession of the pendulum's swing plane as a Hannay angle arising from the adiabatic transport of its oscillation plane by the Earth's daily rotation. Solving this problem  provides a profound physical intuition for anholonomy, connecting an abstract mathematical concept to a tangible, observable phenomenon.",
            "id": "3776746",
            "problem": "Consider a small-amplitude, planar pendulum of length $\\ell$ under uniform gravitational acceleration $g$, installed at geographic latitude $\\lambda$ on a rotating Earth. Let the Earth's constant angular speed be $\\Omega$, and assume the adiabatic regime $\\Omega \\ll \\omega_{0}$, where $\\omega_{0} = \\sqrt{g/\\ell}$ is the small-oscillation angular frequency of the pendulum. Work in a local frame attached to the Earth at the pendulum, and ignore centrifugal corrections to $g$. Over one sidereal day, the local frame completes a slow cyclic change of orientation with period $T = \\frac{2\\pi}{\\Omega}$, while the pendulum executes fast oscillations at instantaneous frequency $\\omega_{0}$.\n\nUsing Hamiltonian mechanics and action–angle variables for the two-dimensional isotropic harmonic oscillator representation of the small-amplitude pendulum, analyze the adiabatic transport of the system over the cycle of duration $T$. Starting from the canonical Hamiltonian description with the Coriolis coupling to the Earth's rotation, and using the adiabatic invariance of actions, derive the evolution equations for appropriate angle variables. Then show that the total change in the relevant angle variables after the cycle can be decomposed into a sum of a dynamical contribution equal to the time integral of the instantaneous frequency and a geometric contribution (the Hannay angle). By explicitly subtracting the dynamical contribution $\\int_{0}^{T} \\omega_{0}\\,\\mathrm{d}t$ from the total accumulated change of the fast angle, isolate the geometric Hannay precession of the pendulum's plane.\n\nCompute the Hannay angle accumulated by the plane of oscillation after one full cycle of the Earth's rotation, expressed as a closed-form analytic expression in terms of $\\lambda$, and give your answer in radians. Your final answer must be a single analytic expression. No numerical evaluation is required.",
            "solution": "The user wants me to derive the Hannay angle for a Foucault pendulum.\n\n### Step 1: Problem Validation\n\n**1.1. Extraction of Givens:**\n- System: Small-amplitude, planar pendulum.\n- Parameters: Length $\\ell$, uniform gravitational acceleration $g$.\n- Location: Geographic latitude $\\lambda$.\n- Earth's rotation: Constant angular speed $\\Omega$.\n- Regime: Adiabatic, $\\Omega \\ll \\omega_{0}$, where $\\omega_{0} = \\sqrt{g/\\ell}$.\n- Frame of Reference: Local frame attached to the Earth, ignoring centrifugal corrections to $g$.\n- Process: Cyclic change of orientation of the local frame over one sidereal day, $T = \\frac{2\\pi}{\\Omega}$.\n- Dynamics: Fast pendulum oscillations at instantaneous frequency $\\omega_{0}$, slow precession.\n- Task:\n    - Use Hamiltonian mechanics and action-angle variables for a 2D isotropic harmonic oscillator.\n    - Start from the Hamiltonian with Coriolis coupling.\n    - Use adiabatic invariance of actions.\n    - Derive evolution equations for angle variables.\n    - Decompose the total angle change into dynamical and geometric parts.\n    - Isolate the Hannay angle, identified as the precession of the pendulum's plane, by subtracting the dynamical contribution $\\int_{0}^{T} \\omega_{0}\\,\\mathrm{d}t$ from the total change of a fast angle.\n    - Compute the final angle in terms of $\\lambda$.\n\n**1.2. Validation Using Extracted Givens:**\n- **Scientifically Grounded:** The problem describes the Foucault pendulum, a standard, verifiable phenomenon in classical mechanics. The use of geometric phase concepts like the Hannay angle to explain it is a well-established approach in advanced mechanics. The physical principles (Coriolis effect, pendulum motion) are sound.\n- **Well-Posed:** The problem provides a clear objective and all necessary parameters and simplifying assumptions (small amplitude, adiabatic regime). A unique, meaningful solution is expected.\n- **Objective:** The language is formal, precise, and free from subjective or biased statements.\n\n**1.3. Verdict:**\nThe problem is valid. It is a standard problem in geometric mechanics, though the phrasing regarding the decomposition of angles requires careful interpretation.\n\n### Step 2: Solution Derivation\n\nThe motion of the pendulum is analyzed in a local reference frame rotating with the Earth. Let the origin be the equilibrium point of the pendulum, with the $x$-axis pointing East, the $y$-axis pointing North, and the $z$-axis pointing vertically upward. For small-amplitude oscillations, the motion is confined to the $xy$-plane.\n\nThe angular velocity vector of the Earth in this local frame is $\\mathbf{\\Omega} = (0, \\Omega \\cos\\lambda, \\Omega \\sin\\lambda)$. The dominant term affecting the planar motion is the vertical component, $\\Omega_z = \\Omega \\sin\\lambda$. The equations of motion for the pendulum bob of mass $m$, including the Coriolis force, are:\n$$\n\\ddot{x} = -\\omega_{0}^{2} x + 2\\Omega_z \\dot{y}\n$$\n$$\n\\ddot{y} = -\\omega_{0}^{2} y - 2\\Omega_z \\dot{x}\n$$\nwhere $\\omega_{0} = \\sqrt{g/\\ell}$ is the natural frequency of the pendulum.\n\nTo solve this system, we introduce the complex coordinate $u(t) = x(t) + iy(t)$. The equations of motion combine into a single equation for $u$:\n$$\n\\ddot{u} + 2i\\Omega_z \\dot{u} + \\omega_{0}^{2} u = 0\n$$\nThis is a second-order linear ordinary differential equation with constant coefficients. We seek solutions of the form $u(t) \\propto \\exp(i\\omega t)$. Substituting this into the equation yields the characteristic equation for the frequencies $\\omega$:\n$$\n-\\omega^2 - 2\\Omega_z \\omega + \\omega_{0}^{2} = 0 \\quad \\implies \\quad \\omega^2 + 2\\Omega_z \\omega - \\omega_{0}^{2} = 0\n$$\nThe solutions for $\\omega$ are:\n$$\n\\omega = \\frac{-2\\Omega_z \\pm \\sqrt{4\\Omega_z^2 + 4\\omega_{0}^{2}}}{2} = -\\Omega_z \\pm \\sqrt{\\omega_{0}^{2} + \\Omega_z^2}\n$$\nIn the adiabatic regime $\\Omega \\ll \\omega_{0}$, we have $\\Omega_z \\ll \\omega_{0}$. We can approximate the square root: $\\sqrt{\\omega_{0}^{2} + \\Omega_z^2} \\approx \\omega_{0}$. The two normal mode frequencies are:\n$$\n\\omega_+ \\approx \\omega_{0} - \\Omega_z\n$$\n$$\n\\omega_- \\approx -\\omega_{0} - \\Omega_z\n$$\nThese frequencies correspond to right and left circularly polarized motions. The general solution is a superposition of these modes:\n$$\nu(t) = C_+ \\exp(i\\omega_+ t) + C_- \\exp(i\\omega_- t)\n$$\nwhere $C_+$ and $C_-$ are complex constants determined by initial conditions.\n\nA planar oscillation corresponds to a specific superposition of the two circular modes. For the oscillation to be linear (planar), the amplitudes of the two circular modes must be equal. Let's set $|C_+| = |C_-| = A$ and for simplicity of illustration, let their phases be such that at $t=0$ the oscillation is along the $x$-axis. This can be achieved by setting $C_+ = C_- = A$.\nThe solution becomes:\n$$\nu(t) = A (\\exp(i\\omega_+ t) + \\exp(i\\omega_- t))\n$$\n$$\nu(t) = A \\exp\\left(i\\frac{\\omega_+ + \\omega_-}{2}t\\right) \\left[ \\exp\\left(i\\frac{\\omega_+ - \\omega_-}{2}t\\right) + \\exp\\left(-i\\frac{\\omega_+ - \\omega_-}{2}t\\right) \\right]\n$$\n$$\nu(t) = 2A \\cos\\left(\\frac{\\omega_+ - \\omega_-}{2}t\\right) \\exp\\left(i\\frac{\\omega_+ + \\omega_-}{2}t\\right)\n$$\nLet's evaluate the frequency components:\nThe fast oscillation frequency is:\n$$\n\\omega_{fast} = \\frac{\\omega_+ - \\omega_-}{2} \\approx \\frac{(\\omega_{0} - \\Omega_z) - (-\\omega_{0} - \\Omega_z)}{2} = \\omega_{0}\n$$\nThe precession frequency of the plane is:\n$$\n\\omega_{plane} = \\frac{\\omega_+ + \\omega_-}{2} \\approx \\frac{(\\omega_{0} - \\Omega_z) + (-\\omega_{0} - \\Omega_z)}{2} = -\\Omega_z\n$$\nSubstituting these back into the expression for $u(t)$:\n$$\nu(t) = \\underbrace{2A \\cos(\\omega_{0} t)}_{\\text{Real Amplitude}} \\cdot \\underbrace{\\exp(-i\\Omega_z t)}_{\\text{Rotating Phase}}\n$$\nThis expression describes a linear oscillation with amplitude $2A \\cos(\\omega_{0} t)$ along a line that rotates in the complex plane with angular velocity $-\\Omega_z$. The angle of the plane of oscillation, $\\psi(t)$, with respect to the $x$-axis (East) is given by the phase of the complex exponential term:\n$$\n\\psi(t) = -\\Omega_z t = -(\\Omega \\sin\\lambda) t\n$$\nThe rate of precession of the pendulum's plane is $\\dot{\\psi} = -\\Omega \\sin\\lambda$. A negative sign indicates clockwise rotation in the Northern Hemisphere ($\\lambda>0$), which is consistent with observation.\n\nThe problem asks for the total Hannay angle accumulated after one full cycle of the Earth's rotation, which is a sidereal day of duration $T = \\frac{2\\pi}{\\Omega}$. This angle is the total change in the plane's orientation, $\\Delta\\psi$.\n$$\n\\Delta\\psi = \\int_{0}^{T} \\dot{\\psi}(t) \\,dt = \\int_{0}^{T} (-\\Omega \\sin\\lambda) \\,dt = -(\\Omega \\sin\\lambda) T\n$$\nSubstituting $T = \\frac{2\\pi}{\\Omega}$:\n$$\n\\Delta\\psi = -(\\Omega \\sin\\lambda) \\left(\\frac{2\\pi}{\\Omega}\\right) = -2\\pi \\sin\\lambda\n$$\nThis quantity is the geometric phase, or Hannay angle, associated with the adiabatic transport of the pendulum's oscillation plane around a circle of latitude. It depends only on the geometry of the path (the latitude $\\lambda$) and not on the dynamical details of the pendulum like its frequency or amplitude.\n\nThe problem's instruction about subtracting the dynamical phase $\\int_0^T \\omega_{0} dt$ from the \"fast angle\" can be interpreted in the context of the normal modes. The phase accumulation of a normal mode, e.g., $\\Delta\\theta = \\omega_+ T = (\\omega_{0} - \\Omega_z)T$, can be decomposed into a dynamical part $\\omega_{0} T$ and a geometric part $-\\Omega_z T$. The precession of the physical plane of oscillation is directly given by this geometric part. The calculation above directly computes this precession angle.",
            "answer": "$$\\boxed{-2\\pi\\sin(\\lambda)}$$"
        },
        {
            "introduction": "Theoretical concepts are most powerful when their limits are understood. This final practice bridges the gap between idealized theory and practical dynamics by asking you to compare the theoretical Hannay angle with a direct numerical simulation for a time-dependent harmonic oscillator. While the theory for this one-dimensional system predicts a zero Hannay angle, numerical integration reveals a small, non-zero residual. This computational exercise  allows you to quantify the error inherent in the adiabatic approximation and appreciate the conditions required for the geometric phase to emerge cleanly.",
            "id": "3776757",
            "problem": "Consider a one-degree-of-freedom integrable Hamiltonian system, the time-dependent harmonic oscillator, with Hamiltonian $$H(q,p,t)=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\,\\omega(t)^{2}q^{2},$$ where $q$ is position, $p$ is momentum, $m$ is mass, and $\\omega(t)$ is a slowly varying angular frequency that returns to its initial value after a cycle. Assume a cyclic parameter variation $$\\omega(t)=\\omega_{0}\\left(1+\\varepsilon\\cos(\\Omega t)\\right),$$ with fixed $\\omega_{0}>0$, amplitude $0\\leq \\varepsilon<1$ ensuring $\\omega(t)>0$, and slow modulation rate $\\Omega>0$. The system is integrable and admits action-angle variables $(I,\\theta)$ for each frozen value of the parameter, defined by the canonical transformation $$q=\\sqrt{\\frac{2I}{m\\,\\omega}}\\sin\\theta,\\qquad p=\\sqrt{2I\\,m\\,\\omega}\\cos\\theta.$$ In the adiabatic regime, the action $I$ is an adiabatic invariant and the angle $\\theta$ evolves primarily with the instantaneous frequency; the Hannay angle is the geometric contribution to the net change in $\\theta$ over one closed cycle in parameter space, beyond the dynamical part $\\int_{0}^{T}\\omega(t)\\,dt$, where $T=\\frac{2\\pi}{\\Omega}$ is the cycle period.\n\nYour tasks are:\n- Starting from the fundamental Hamiltonian framework and the definition of canonical action-angle variables, formulate the canonical perturbation theory needed to identify the Hannay angle for the one-degree-of-freedom harmonic oscillator under a cyclic, slowly varying frequency. Show that, due to the trivial curvature of the Hannay connection for this one-dimensional linear system, the Hannay angle predicted by canonical perturbation theory is zero for any closed loop of $\\omega(t)$ that returns to its initial value.\n- Design an algorithm that numerically integrates Hamilton’s equations over one modulation cycle, extracts the instantaneous angle $\\theta(t)$ using the frozen-parameter action-angle mapping, and computes the net numerical Hannay angle as the residual $$\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt,$$ where $\\Delta\\theta=\\theta(T)-\\theta(0)$ is computed with continuous phase unwrapping.\n- Estimate the error of the adiabatic approximation by comparing the numerical Hannay angle to the canonical perturbation prediction (which is zero), and report the absolute error.\n\nPhysical and numerical units must be explicitly respected: use $m$ in $\\mathrm{kg}$, $q$ in $\\mathrm{m}$, $p$ in $\\mathrm{kg \\cdot m/s}$, time $t$ in $\\mathrm{s}$, angular frequency $\\omega$ and $\\Omega$ in $\\mathrm{rad/s}$, and angles in $\\mathrm{radians}$. Express all angle-related outputs in $\\mathrm{radians}$.\n\nImplement a complete, runnable program that:\n- Integrates Hamilton’s equations $$\\dot{q}=\\frac{p}{m},\\qquad \\dot{p}=-m\\,\\omega(t)^{2}\\,q,$$ over one cycle $[0,T]$ with $T=\\frac{2\\pi}{\\Omega}$ for each test case.\n- Computes the instantaneous angle $$\\theta(t)=\\operatorname{atan2}\\!\\left(\\sqrt{m\\,\\omega(t)}\\,q(t),\\;\\frac{p(t)}{\\sqrt{m\\,\\omega(t)}}\\right),$$ and uses continuous unwrapping to obtain $\\Delta\\theta$.\n- Approximates the dynamical angle $\\int_{0}^{T}\\omega(t)\\,dt$ via numerical quadrature that is consistent with the integration grid.\n- Returns, for each test case, the absolute error $$E=\\left|\\left(\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt\\right)-0\\right|=\\left|\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt\\right|,$$ in $\\mathrm{radians}$.\n\nUse the following test suite, which covers a typical adiabatic case, a boundary case, and a non-adiabatic edge case. In each case, set $m=1$ $\\mathrm{kg}$, initial position $q(0)=0$ $\\mathrm{m}$, and choose initial momentum $p(0)=m\\,\\omega(0)\\,A$ with amplitude $A$ in $\\mathrm{m}$ so that the initial angle is $\\theta(0)\\approx 0$:\n- Test case $1$ (adiabatic regime): $\\omega_{0}=10$ $\\mathrm{rad/s}$, $\\varepsilon=0.2$, $\\Omega=0.2$ $\\mathrm{rad/s}$, $A=0.05$ $\\mathrm{m}$.\n- Test case $2$ (boundary case with no modulation): $\\omega_{0}=10$ $\\mathrm{rad/s}$, $\\varepsilon=0$, $\\Omega=0.5$ $\\mathrm{rad/s}$, $A=0.03$ $\\mathrm{m}$.\n- Test case $3$ (non-adiabatic regime): $\\omega_{0}=10$ $\\mathrm{rad/s}$, $\\varepsilon=0.2$, $\\Omega=5.0$ $\\mathrm{rad/s}$, $A=0.05$ $\\mathrm{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_{1},r_{2},r_{3}]$), where each $r_{i}$ is the absolute error $E$ in $\\mathrm{radians}$ for the corresponding test case, represented as a floating-point number.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of Hamiltonian mechanics and adiabatic theory, is well-posed with a complete and consistent set of definitions and parameters, and is formulated with objective and precise language.\n\nWe will first provide the theoretical derivation requested, followed by the design of the numerical algorithm.\n\n### Part 1: Theoretical Derivation of the Hannay Angle\n\nThe system is a one-degree-of-freedom time-dependent harmonic oscillator described by the Hamiltonian:\n$$H(q,p,t) = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega(t)^2 q^2$$\nwhere $\\omega(t)$ is a slowly varying parameter that undergoes a cyclic evolution, i.e., $\\omega(T) = \\omega(0)$ for some period $T$.\n\nFor any fixed value of the parameter $\\omega$, the system is integrable. We can introduce action-angle variables $(I, \\theta)$ via the canonical transformation provided:\n$$q = \\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta, \\qquad p = \\sqrt{2Im\\omega}\\cos\\theta$$\nSubstituting this into the Hamiltonian for a frozen $\\omega$ yields:\n$$H(I, \\theta) = \\frac{(\\sqrt{2Im\\omega}\\cos\\theta)^2}{2m} + \\frac{1}{2}m\\omega^2\\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right)^2$$\n$$H(I, \\theta) = \\frac{2Im\\omega\\cos^2\\theta}{2m} + \\frac{1}{2}m\\omega^2\\left(\\frac{2I}{m\\omega}\\sin^2\\theta\\right)$$\n$$H(I, \\theta) = I\\omega\\cos^2\\theta + I\\omega\\sin^2\\theta = I\\omega(\\cos^2\\theta + \\sin^2\\theta) = I\\omega$$\nAs required for action-angle variables, the new Hamiltonian depends only on the action $I$. The frequency of motion on the invariant torus is $\\frac{\\partial H}{\\partial I} = \\omega$. The dynamical part of the angle evolution over a cycle of duration $T$ is therefore $\\Delta\\theta_{\\text{dyn}} = \\int_0^T \\omega(t) dt$.\n\nThe Hannay angle, $\\Delta\\theta_H$, is the additional geometric phase acquired by the angle variable $\\theta$ due to the cyclic variation of the parameter $\\omega(t)$. For a system with one parameter $\\lambda$ (here, $\\lambda = \\omega$), the Hannay angle for a closed loop in parameter space is given by the integral of the Hannay connection one-form $A_\\omega$:\n$$\\Delta\\theta_H = \\oint A_\\omega d\\omega$$\nThe connection is defined by averaging over the fast motion on an invariant torus (a cycle in $\\theta$ from $0$ to $2\\pi$):\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\frac{\\partial q}{\\partial \\omega} \\frac{\\partial p}{\\partial \\theta} - \\frac{\\partial p}{\\partial \\omega} \\frac{\\partial q}{\\partial \\theta} \\right)$$\nThe partial derivatives are computed holding the action-angle variables $(I, \\theta)$ constant:\n- $\\frac{\\partial q}{\\partial \\omega} = \\frac{\\partial}{\\partial \\omega} \\left(\\sqrt{\\frac{2I}{m}}\\omega^{-1/2}\\sin\\theta\\right) = \\sqrt{\\frac{2I}{m}}(-\\frac{1}{2}\\omega^{-3/2})\\sin\\theta = -\\frac{1}{2\\omega} \\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right) = -\\frac{q}{2\\omega}$\n- $\\frac{\\partial p}{\\partial \\omega} = \\frac{\\partial}{\\partial \\omega} \\left(\\sqrt{2Im}\\omega^{1/2}\\cos\\theta\\right) = \\sqrt{2Im}(\\frac{1}{2}\\omega^{-1/2})\\cos\\theta = \\frac{1}{2\\omega} \\left(\\sqrt{2Im\\omega}\\cos\\theta\\right) = \\frac{p}{2\\omega}$\n- $\\frac{\\partial q}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right) = \\sqrt{\\frac{2I}{m\\omega}}\\cos\\theta = \\frac{p}{m\\omega}$\n- $\\frac{\\partial p}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(\\sqrt{2Im\\omega}\\cos\\theta\\right) = -\\sqrt{2Im\\omega}\\sin\\theta = -m\\omega q$\n\nSubstituting these into the expression for the connection $A_\\omega$:\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\left(-\\frac{q}{2\\omega}\\right)(-m\\omega q) - \\left(\\frac{p}{2\\omega}\\right)\\left(\\frac{p}{m\\omega}\\right) \\right)$$\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\frac{m q^2}{2} - \\frac{p^2}{2m\\omega^2} \\right)$$\nTo evaluate the integral, we express $q$ and $p$ in terms of $(I, \\theta)$:\n$$ \\frac{m q^2}{2} = \\frac{m}{2} \\left( \\frac{2I}{m\\omega}\\sin^2\\theta \\right) = \\frac{I}{\\omega}\\sin^2\\theta $$\n$$ \\frac{p^2}{2m\\omega^2} = \\frac{1}{2m\\omega^2} (2Im\\omega\\cos^2\\theta) = \\frac{I}{\\omega}\\cos^2\\theta $$\nThe integrand becomes:\n$$ \\frac{I}{\\omega}\\sin^2\\theta - \\frac{I}{\\omega}\\cos^2\\theta = -\\frac{I}{\\omega}(\\cos^2\\theta - \\sin^2\\theta) = -\\frac{I}{\\omega}\\cos(2\\theta) $$\nThe connection is the average of this quantity over one period of $\\theta$:\n$$A_\\omega = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\left(-\\frac{I}{\\omega}\\cos(2\\theta)\\right) d\\theta = -\\frac{I}{2\\pi\\omega} \\left[ \\frac{\\sin(2\\theta)}{2} \\right]_0^{2\\pi} = 0$$\nSince the Hannay connection $A_\\omega$ is identically zero, the Hannay angle, which is the integral of this connection over any closed path, must also be zero:\n$$\\Delta\\theta_H = \\oint 0 \\cdot d\\omega = 0$$\nThis is a specific result for the one-dimensional harmonic oscillator, a linear system, and reflects the trivial curvature of the parameter space connection. Any non-zero value for the quantity $\\Delta\\theta - \\int_0^T \\omega(t) dt$ computed from a direct simulation is therefore not a true Hannay angle but a result of non-adiabatic effects that are neglected in the lowest-order geometric theory. The problem correctly identifies this numerical residual as a measure of the error in the adiabatic approximation.\n\n### Part 2: Numerical Algorithm Design\n\nThe algorithm computes the error of the adiabatic approximation by comparing the numerically calculated total angle change with the theoretical dynamical phase. The theoretical Hannay angle is $0$, so the error is simply the absolute value of the numerical residual.\n\nFor each test case, the following steps are executed:\n1.  **Initialization**: Define the physical parameters $m$, $\\omega_0$, $\\varepsilon$, $\\Omega$, and the initial amplitude $A$. Calculate the cycle period $T = 2\\pi/\\Omega$.\n2.  **Initial Conditions**: Set the initial position $q(0)=0$. Calculate the initial frequency $\\omega(0) = \\omega_0(1+\\varepsilon)$ and the initial momentum $p(0) = m\\omega(0)A$. These conditions correspond to an initial angle $\\theta(0)=0$.\n3.  **Hamilton's Equations**: Define the system of first-order ordinary differential equations (ODEs) for the state vector $\\mathbf{y}(t) = [q(t), p(t)]^T$:\n    $$\\frac{d\\mathbf{y}}{dt} = \\begin{pmatrix} \\dot{q} \\\\ \\dot{p} \\end{pmatrix} = \\begin{pmatrix} p/m \\\\ -m\\omega(t)^2 q \\end{pmatrix}, \\quad \\text{where} \\quad \\omega(t) = \\omega_0(1+\\varepsilon\\cos(\\Omega t))$$\n4.  **Numerical Integration**: Integrate the ODEs over the time interval $[0, T]$ using a high-precision adaptive step-size solver, specifically `scipy.integrate.solve_ivp`. The solution is evaluated on a fine, uniform time grid `t_eval` to ensure accuracy for subsequent calculations.\n5.  **Phase Calculation**:\n    a.  From the solution arrays $q(t_i)$ and $p(t_i)$ on the grid, compute the instantaneous frequency $\\omega(t_i)$ for each time step $t_i$.\n    b.  Compute the instantaneous angle $\\theta(t_i)$ using the robust two-argument arctangent function:\n        $$\\theta(t_i) = \\operatorname{atan2}\\!\\left(\\sqrt{m\\,\\omega(t_i)}\\,q(t_i),\\;\\frac{p(t_i)}{\\sqrt{m\\,\\omega(t_i)}}\\right)$$\n    c.  Use `numpy.unwrap` on the sequence $\\theta(t_i)$ to correct for $2\\pi$ jumps and obtain a continuous phase evolution.\n6.  **Total Angle Change**: Calculate the total change in the unwrapped angle, $\\Delta\\theta = \\theta_{\\text{unwrapped}}(T) - \\theta_{\\text{unwrapped}}(0)$.\n7.  **Dynamical Phase**: Numerically approximate the integral of the dynamical phase, $\\int_0^T \\omega(t) dt$, using the trapezoidal rule (`numpy.trapz`) on the same time grid `t_eval` and corresponding $\\omega(t_i)$ values. This maintains consistency with the ODE integration scheme.\n8.  **Error Calculation**: The numerical Hannay angle, or the residual beyond the dynamical phase, is $\\Delta\\theta_{\\text{num}} = \\Delta\\theta - \\int_0^T \\omega(t) dt$. The absolute error $E$ relative to the theoretical prediction of $0$ is then:\n    $$E = |\\Delta\\theta_{\\text{num}} - 0| = \\left|\\Delta\\theta - \\int_0^T \\omega(t) dt\\right|$$\n9.  **Output**: Collect the value of $E$ for each test case and format the final output as a comma-separated list in brackets.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the error of the adiabatic approximation for a time-dependent\n    harmonic oscillator by comparing the numerically integrated angle change\n    to the theoretical prediction of a zero Hannay angle.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # Each tuple: (omega_0, epsilon, Omega, A)\n    test_cases = [\n        (10.0, 0.2, 0.2, 0.05),   # Adiabatic regime\n        (10.0, 0.0, 0.5, 0.03),   # Boundary case (no modulation)\n        (10.0, 0.2, 5.0, 0.05),   # Non-adiabatic regime\n    ]\n\n    m = 1.0  # mass in kg\n    results = []\n    \n    # Use a large number of steps for high accuracy in integration and quadrature.\n    num_steps = 50000\n\n    for case in test_cases:\n        w0, eps, Omega, A = case\n\n        # Define the time-dependent angular frequency.\n        def omega(t):\n            return w0 * (1.0 + eps * np.cos(Omega * t))\n\n        # Hamilton's equations of motion.\n        def hamilton_eqs(t, y):\n            q, p = y\n            dq_dt = p / m\n            dp_dt = -m * omega(t)**2 * q\n            return [dq_dt, dp_dt]\n\n        # Set up integration time and initial conditions.\n        T = 2.0 * np.pi / Omega if Omega > 0 else 0 # Period of modulation.\n        t_span = [0, T]\n        \n        q0 = 0.0  # Initial position in m\n        omega_initial = omega(0)\n        p0 = m * omega_initial * A # Initial momentum in kg*m/s\n        y0 = [q0, p0]\n\n        # Use a fine time grid for accurate phase calculation and integration.\n        t_eval = np.linspace(t_span[0], t_span[1], num_steps)\n        \n        # Integrate the ODEs.\n        sol = solve_ivp(\n            hamilton_eqs, \n            t_span, \n            y0, \n            t_eval=t_eval, \n            method='RK45', \n            rtol=1e-12, \n            atol=1e-12\n        )\n        \n        q_sol = sol.y[0]\n        p_sol = sol.y[1]\n        t_sol = sol.t\n\n        # Handle the edge case of T=0\n        if T == 0:\n            results.append(0.0)\n            continue\n            \n        # Calculate instantaneous frequency and angle at each time step.\n        omega_t = omega(t_sol)\n        \n        # theta(t) = atan2(sqrt(m*omega)*q, p/sqrt(m*omega))\n        Y = np.sqrt(m * omega_t) * q_sol\n        X = p_sol / np.sqrt(m * omega_t)\n        theta_t = np.arctan2(Y, X)\n        \n        # Unwrap phase to get continuous angle evolution.\n        theta_unwrapped = np.unwrap(theta_t)\n        \n        # Total angle change over the cycle.\n        delta_theta = theta_unwrapped[-1] - theta_unwrapped[0]\n        \n        # Calculate the dynamical phase by numerical integration (trapezoidal rule).\n        dynamical_phase = np.trapz(omega_t, t_sol)\n        \n        # The numerical Hannay angle is the residual.\n        numerical_hannay_angle = delta_theta - dynamical_phase\n        \n        # The error is the absolute value of the residual, as the theoretical Hannay angle is 0.\n        error = abs(numerical_hannay_angle)\n        \n        results.append(error)\n\n    # Format and print the final output as a single line.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}