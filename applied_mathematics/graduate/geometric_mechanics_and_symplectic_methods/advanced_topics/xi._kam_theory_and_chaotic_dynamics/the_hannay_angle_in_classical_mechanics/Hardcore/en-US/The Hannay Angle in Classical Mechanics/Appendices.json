{
    "hands_on_practices": [
        {
            "introduction": "Before delving into complex calculations, it is essential to build a firm conceptual foundation. The distinction between the geometric Hannay angle and the more familiar dynamical phase lies at the heart of the topic. This practice  challenges you to identify the core properties that define a phase as 'geometric' by considering how it transforms under changes to the path in parameter space, such as altering the traversal speed or reversing direction.",
            "id": "3776766",
            "problem": "Consider a classical, completely integrable Hamiltonian system with $n$ degrees of freedom, written in action-angle variables $(I,\\theta)$ with Hamiltonian $H(I,\\lambda)$, where $\\lambda \\in \\mathcal{M}$ is a set of externally controlled parameters taking values on a smooth manifold. Suppose the parameters are varied slowly in time along a smooth closed loop $C: t \\mapsto \\lambda(t)$ for $t \\in [0,T]$, with $T$ sufficiently large that the actions $I$ remain adiabatic invariants to leading order. After one traversal of the loop, the angle variables undergo a net shift relative to their initial values. One often decomposes this net shift into a geometric contribution (the Hannay anholonomy) and a dynamical contribution (the time-accumulated frequency). \n\nWhich option states a correct criterion to distinguish the geometric Hannay anholonomy from the dynamical phase accumulation by using only the behavior under smooth time-rescalings $t \\mapsto \\alpha t$ with $\\alpha>0$ and smooth reparametrizations $t \\mapsto \\tau(t)$ of the same parameter loop (possibly including reversing the loop orientation by $t \\mapsto T-t$), without reference to any specific coordinate formula?\n\nA. The geometric Hannay anholonomy is exactly the part of the total angle shift that is invariant under all smooth, strictly increasing reparametrizations $t \\mapsto \\tau(t)$ of the same oriented loop $C$ in parameter space and independent of the total duration $T$; moreover, it changes sign if the loop orientation is reversed via $t \\mapsto T-t$. Conversely, the dynamical phase is the part that rescales proportionally under $t \\mapsto \\alpha t$ (hence depends on $T$) and is unchanged when the loop orientation is reversed by $t \\mapsto T-t$.\n\nB. The geometric Hannay anholonomy is precisely the part of the total angle shift that depends on the area enclosed by the loop in the $(I,\\theta)$ space and therefore also varies with the speed along the loop; conversely, the dynamical phase depends only on the instantaneous parameter values and is invariant under time-rescalings.\n\nC. The geometric Hannay anholonomy can always be removed by a suitable time-dependent canonical change of angle origin along the loop in parameter space, so that what remains is purely dynamical; therefore, any phase shift that persists under such a gauge choice is dynamical.\n\nD. If one traverses the same loop twice with two different speed profiles but with the same total duration $T$, then the difference of the two measured angle shifts is zero if and only if the shift is purely dynamical; therefore, equality of the shifts for different profiles identifies dynamical phase.\n\nE. The geometric Hannay anholonomy is the part of the total angle shift that is even under reversing the loop orientation, while the dynamical phase is the part that is odd under loop reversal; therefore, loop reversal isolates the dynamical phase.",
            "solution": "The user wants me to validate and solve a problem concerning the distinguishing properties of the Hannay angle (geometric phase) and the dynamical phase in a classical integrable system under adiabatic evolution.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **System:** A classical, completely integrable Hamiltonian system.\n*   **Degrees of Freedom:** $n$.\n*   **Coordinates:** Action-angle variables $(I, \\theta)$, where $I = (I_1, \\dots, I_n)$ and $\\theta = (\\theta_1, \\dots, \\theta_n)$.\n*   **Hamiltonian:** $H(I, \\lambda)$.\n*   **Parameters:** A set of externally controlled parameters $\\lambda$ on a smooth manifold $\\mathcal{M}$.\n*   **Process:** The parameters $\\lambda$ are varied slowly in time along a smooth closed loop $C: t \\mapsto \\lambda(t)$ for $t \\in [0, T]$.\n*   **Adiabatic Condition:** The duration $T$ is sufficiently large, ensuring the actions $I$ are adiabatic invariants to leading order.\n*   **Observation:** The angle variables $\\theta$ experience a net shift, $\\Delta\\theta$.\n*   **Decomposition:** This shift is decomposed into a geometric part (Hannay anholonomy) and a dynamical part.\n*   **Question:** The problem asks for a criterion to distinguish the geometric and dynamical contributions based solely on their behavior under specific transformations of the time parameterization of the loop $C$, without referring to coordinate-specific formulas. The transformations are:\n    1.  Time-rescaling: $t \\mapsto \\alpha t$ for $\\alpha > 0$.\n    2.  Smooth reparametrization: $t \\mapsto \\tau(t)$ for a smooth, strictly increasing function $\\tau$.\n    3.  Loop orientation reversal: $t \\mapsto T-t$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding:** The problem is firmly rooted in the well-established field of geometric mechanics, specifically addressing the concept of geometric phases in classical systems, known as Hannay's angle. The setup (integrable Hamiltonian system, action-angle variables, adiabatic parameter change) is the standard theoretical framework for this topic. The decomposition of the total phase into dynamical and geometric parts is a central result of the theory. All concepts are standard and scientifically sound.\n*   **Well-Posedness:** The question is well-posed. It asks for a conceptual distinction based on fundamental transformation properties, which is a standard method for characterizing physical quantities. The properties in question (behavior under reparametrization, scaling, and orientation reversal) are precisely the ones that reveal the geometric nature of the Hannay angle. A unique, correct answer exists within the theory.\n*   **Objectivity:** The language is formal, precise, and objective. There are no subjective or speculative elements.\n*   **Completeness and Consistency:** The problem statement is self-contained and provides all necessary information to answer the question conceptually. There are no contradictions.\n*   **Other Flaws:** The problem is not unrealistic, ill-posed, trivial, or unverifiable. It addresses a core conceptual point in advanced classical mechanics.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. A full solution will be derived.\n\n### Derivation and Solution\n\nThe total shift in the angle variables, $\\Delta\\theta$, after one cycle of the parameters along the loop $C$ is given by\n$$ \\Delta\\theta = \\int_0^T \\dot{\\theta}(t) dt $$\nHamilton's equations state that $\\dot{\\theta} = \\frac{\\partial H}{\\partial I} \\equiv \\omega(I, \\lambda(t))$, where $\\omega$ is the vector of frequencies. A detailed analysis of the adiabatic evolution of the system reveals that the total angle shift $\\Delta\\theta$ can be decomposed into two parts: a dynamical phase $\\Delta\\theta_{\\text{dyn}}$ and a geometric phase (Hannay's angle) $\\Delta\\theta_{\\text{geom}}$.\n$$ \\Delta\\theta = \\Delta\\theta_{\\text{dyn}} + \\Delta\\theta_{\\text{geom}} $$\n\n1.  **The Dynamical Phase ($\\Delta\\theta_{\\text{dyn}}$):** This part arises from the time accumulation of the instantaneous frequencies of the system.\n    $$ \\Delta\\theta_{\\text{dyn}} = \\int_0^T \\omega(I, \\lambda(t)) dt $$\n    Here, $I$ is the (approximately constant) action. This is an integral over the time interval $[0, T]$.\n\n2.  **The Geometric Phase ($\\Delta\\theta_{\\text{geom}}$):** This part, the Hannay anholonomy, is independent of the rate at which the loop is traversed. It is a purely geometric property of the loop $C$ in the parameter space $\\mathcal{M}$ and the family of invariant tori (defined by $I$) of the Hamiltonian. It can be expressed as a line integral of a connection one-form $A$ around the loop $C$:\n    $$ \\Delta\\theta_{\\text{geom}} = \\oint_C A $$\n    where $A = A(I, \\lambda)$ is the \"Hannay connection\". The crucial point is that this is a line integral in parameter space, which depends on the geometry of the curve $C$ but not its time-parametrization.\n\nWe now analyze the behavior of these two components under the specified transformations.\n\n*   **Smooth, Strictly Increasing Reparametrization ($t \\mapsto \\tau(s)$):**\n    This transformation changes the speed at which the loop $C$ is traversed but preserves its path and orientation.\n    *   $\\Delta\\theta_{\\text{geom}}$: As a line integral in parameter space, it is by definition **invariant** under any orientation-preserving reparametrization. It depends only on the path $C$, not how fast one moves along it.\n    *   $\\Delta\\theta_{\\text{dyn}}$: The integral $\\int \\omega(\\lambda(t)) dt$ explicitly depends on the time parametrization $t$. Changing the speed profile $\\dot{\\lambda}(t)$ will, in general, change the value of the integral, even if the total duration $T$ is kept fixed. Thus, the dynamical phase is **not invariant** under general reparametrizations. A direct consequence is that it depends on the total duration $T$.\n\n*   **Time-Rescaling ($t \\mapsto \\alpha t$, with $T \\mapsto \\alpha T$):**\n    This corresponds to traversing the same loop $C$ but taking a total time of $\\alpha T$. The new time variable is $t' = \\alpha t$.\n    *   $\\Delta\\theta_{\\text{geom}}$: Being independent of the parametrization, it is also independent of the total duration $T$. It remains **invariant**.\n    *   $\\Delta\\theta_{\\text{dyn}}$: The new integral is $\\int_0^{\\alpha T} \\omega(\\lambda(t'/\\alpha)) dt'$. Substituting $t = t'/\\alpha$ gives $dt = dt'/\\alpha$. The integral becomes $\\int_0^T \\omega(\\lambda(t)) (\\alpha dt) = \\alpha \\int_0^T \\omega(\\lambda(t)) dt = \\alpha \\Delta\\theta_{\\text{dyn}}$. The dynamical phase **scales linearly** with the duration $T$ (or the scaling factor $\\alpha$).\n\n*   **Loop Orientation Reversal ($t \\mapsto T-t$):**\n    This corresponds to traversing the loop $C$ in the opposite direction, denoted $C^{\\text{rev}}$.\n    *   $\\Delta\\theta_{\\text{geom}}$: A line integral reverses its sign when the path of integration is reversed: $\\oint_{C^{\\text{rev}}} A = - \\oint_C A$. Therefore, the geometric phase **changes sign**. It is an **odd** function of loop orientation.\n    *   $\\Delta\\theta_{\\text{dyn}}$: The integral for the reversed path is $\\int_0^T \\omega(\\lambda(T-t)) dt$. Performing a change of variables $s=T-t$, we get $ds = -dt$, and the integration limits from $t=0, t=T$ become $s=T, s=0$. The integral is $\\int_T^0 \\omega(\\lambda(s)) (-ds) = \\int_0^T \\omega(\\lambda(s)) ds = \\Delta\\theta_{\\text{dyn}}$. The dynamical phase is **invariant** under loop reversal. It is an **even** function of loop orientation.\n\n**Summary of Properties:**\n\n| Property                          | Geometric Phase ($\\Delta\\theta_{\\text{geom}}$) | Dynamical Phase ($\\Delta\\theta_{\\text{dyn}}$) |\n| --------------------------------- | --------------------------------------------- | ---------------------------------------------- |\n| Reparametrization                 | Invariant                                     | Changes                                        |\n| Duration $T$ (uniform scaling)    | Independent                                   | Proportional to $T$                            |\n| Loop Reversal ($C \\to C^{\\text{rev}}$) | Changes sign ($\\text{Odd}$)               | Invariant ($\\text{Even}$)                       |\n\n### Option-by-Option Analysis\n\n**A. The geometric Hannay anholonomy is exactly the part of the total angle shift that is invariant under all smooth, strictly increasing reparametrizations $t \\mapsto \\tau(t)$ of the same oriented loop $C$ in parameter space and independent of the total duration $T$; moreover, it changes sign if the loop orientation is reversed via $t \\mapsto T-t$. Conversely, the dynamical phase is the part that rescales proportionally under $t \\mapsto \\alpha t$ (hence depends on $T$) and is unchanged when the loop orientation is reversed by $t \\mapsto T-t$.**\n\nThis statement perfectly matches our derived properties for both the geometric and dynamical phases. It correctly identifies the geometric phase as being invariant under reparametrization (and thus independent of duration) and odd under loop reversal. It also correctly identifies the dynamical phase as scaling with duration and being even under loop reversal.\n**Verdict: Correct.**\n\n**B. The geometric Hannay anholonomy is precisely the part of the total angle shift that depends on the area enclosed by the loop in the $(I,\\theta)$ space and therefore also varies with the speed along the loop; conversely, the dynamical phase depends only on the instantaneous parameter values and is invariant under time-rescalings.**\n\nThis option contains multiple errors. The loop is in parameter space $\\mathcal{M}$, not the full phase space $(I, \\theta)$. The geometric phase, being geometric, is independent of the speed along the loop, not dependent on it. The dynamical phase is an integral over time, so it is not determined by \"instantaneous\" values alone, and it is not invariant under time-rescalings; it scales linearly with time.\n**Verdict: Incorrect.**\n\n**C. The geometric Hannay anholonomy can always be removed by a suitable time-dependent canonical change of angle origin along the loop in parameter space, so that what remains is purely dynamical; therefore, any phase shift that persists under such a gauge choice is dynamical.**\n\nThis is a misunderstanding of geometric phases and gauge theory. A non-zero Hannay angle implies a non-trivial geometry (a non-zero curvature of the Hannay connection). The effects of curvature cannot be \"gauged away\" globally. If they could, the anholonomy around any loop would be zero. A non-zero Hannay angle is precisely the part that *cannot* be removed by a local change of angle origin (a gauge transformation).\n**Verdict: Incorrect.**\n\n**D. If one traverses the same loop twice with two different speed profiles but with the same total duration $T$, then the difference of the two measured angle shifts is zero if and only if the shift is purely dynamical; therefore, equality of the shifts for different profiles identifies dynamical phase.**\n\nThe geometric phase is invariant under changes in speed profile. The dynamical phase is not. Let two traversals be indicated by subscripts $1$ and $2$. The total shifts are $\\Delta\\theta_1 = \\Delta\\theta_{\\text{geom}} + \\Delta\\theta_{\\text{dyn},1}$ and $\\Delta\\theta_2 = \\Delta\\theta_{\\text{geom}} + \\Delta\\theta_{\\text{dyn},2}$. The difference is $\\Delta\\theta_1 - \\Delta\\theta_2 = \\Delta\\theta_{\\text{dyn},1} - \\Delta\\theta_{\\text{dyn},2}$. This difference is generally non-zero. The statement claims this difference is zero if the shift is purely dynamical ($\\Delta\\theta_{\\text{geom}}=0$). But if the shift is purely dynamical, the difference is still $\\Delta\\theta_{\\text{dyn},1} - \\Delta\\theta_{\\text{dyn},2}$, which is not generally zero. The logic is flawed. In fact, if the total angle shift were found to be *independent* of the speed profile, it would imply the shift is purely geometric.\n**Verdict: Incorrect.**\n\n**E. The geometric Hannay anholonomy is the part of the total angle shift that is even under reversing the loop orientation, while the dynamical phase is the part that is odd under loop reversal; therefore, loop reversal isolates the dynamical phase.**\n\nThis option incorrectly swaps the parities. As derived above, the geometric phase (a line integral) is **odd** under loop reversal, meaning it changes sign. The dynamical phase (an accumulation over time) is **even** under loop reversal, meaning it is invariant. This option states the exact opposite.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The Foucault pendulum provides one of the most elegant and historically significant examples of a classical geometric phase. Its slow precession is a direct consequence of the Earth's rotation adiabatically transporting the pendulum's plane of oscillation. In this exercise , you will derive this famous precession, not by analyzing fictitious forces, but by framing it as a Hannay angle calculation, connecting abstract geometric mechanics to a tangible, observable phenomenon.",
            "id": "3776746",
            "problem": "Consider a small-amplitude, planar pendulum of length $\\ell$ under uniform gravitational acceleration $g$, installed at geographic latitude $\\lambda$ on a rotating Earth. Let the Earth's constant angular speed be $\\Omega$, and assume the adiabatic regime $\\Omega \\ll \\omega_{0}$, where $\\omega_{0} = \\sqrt{g/\\ell}$ is the small-oscillation angular frequency of the pendulum. Work in a local frame attached to the Earth at the pendulum, and ignore centrifugal corrections to $g$. Over one sidereal day, the local frame completes a slow cyclic change of orientation with period $T = \\frac{2\\pi}{\\Omega}$, while the pendulum executes fast oscillations at instantaneous frequency $\\omega_{0}$.\n\nUsing Hamiltonian mechanics and action–angle variables for the two-dimensional isotropic harmonic oscillator representation of the small-amplitude pendulum, analyze the adiabatic transport of the system over the cycle of duration $T$. Starting from the canonical Hamiltonian description with the Coriolis coupling to the Earth's rotation, and using the adiabatic invariance of actions, derive the evolution equations for appropriate angle variables. Then show that the total change in the relevant angle variables after the cycle can be decomposed into a sum of a dynamical contribution equal to the time integral of the instantaneous frequency and a geometric contribution (the Hannay angle). By explicitly subtracting the dynamical contribution $\\int_{0}^{T} \\omega_{0}\\,\\mathrm{d}t$ from the total accumulated change of the fast angle, isolate the geometric Hannay precession of the pendulum's plane.\n\nCompute the Hannay angle accumulated by the plane of oscillation after one full cycle of the Earth's rotation, expressed as a closed-form analytic expression in terms of $\\lambda$, and give your answer in radians. Your final answer must be a single analytic expression. No numerical evaluation is required.",
            "solution": "The user wants me to derive the Hannay angle for a Foucault pendulum.\n\n### Step 1: Problem Validation\n\n**1.1. Extraction of Givens:**\n- System: Small-amplitude, planar pendulum.\n- Parameters: Length $\\ell$, uniform gravitational acceleration $g$.\n- Location: Geographic latitude $\\lambda$.\n- Earth's rotation: Constant angular speed $\\Omega$.\n- Regime: Adiabatic, $\\Omega \\ll \\omega_{0}$, where $\\omega_{0} = \\sqrt{g/\\ell}$.\n- Frame of Reference: Local frame attached to the Earth, ignoring centrifugal corrections to $g$.\n- Process: Cyclic change of orientation of the local frame over one sidereal day, $T = \\frac{2\\pi}{\\Omega}$.\n- Dynamics: Fast pendulum oscillations at instantaneous frequency $\\omega_{0}$, slow precession.\n- Task:\n    - Use Hamiltonian mechanics and action-angle variables for a 2D isotropic harmonic oscillator.\n    - Start from the Hamiltonian with Coriolis coupling.\n    - Use adiabatic invariance of actions.\n    - Derive evolution equations for angle variables.\n    - Decompose the total angle change into dynamical and geometric parts.\n    - Isolate the Hannay angle, identified as the precession of the pendulum's plane, by subtracting the dynamical contribution $\\int_{0}^{T} \\omega_{0}\\,\\mathrm{d}t$ from the total change of a fast angle.\n    - Compute the final angle in terms of $\\lambda$.\n\n**1.2. Validation Using Extracted Givens:**\n- **Scientifically Grounded:** The problem describes the Foucault pendulum, a standard, verifiable phenomenon in classical mechanics. The use of geometric phase concepts like the Hannay angle to explain it is a well-established approach in advanced mechanics. The physical principles (Coriolis effect, pendulum motion) are sound.\n- **Well-Posed:** The problem provides a clear objective and all necessary parameters and simplifying assumptions (small amplitude, adiabatic regime). A unique, meaningful solution is expected.\n- **Objective:** The language is formal, precise, and free from subjective or biased statements.\n\n**1.3. Verdict:**\nThe problem is valid. It is a standard problem in geometric mechanics, though the phrasing regarding the decomposition of angles requires careful interpretation.\n\n### Step 2: Solution Derivation\n\nThe motion of the pendulum is analyzed in a local reference frame rotating with the Earth. Let the origin be the equilibrium point of the pendulum, with the $x$-axis pointing East, the $y$-axis pointing North, and the $z$-axis pointing vertically upward. For small-amplitude oscillations, the motion is confined to the $xy$-plane.\n\nThe angular velocity vector of the Earth in this local frame is $\\mathbf{\\Omega} = (0, \\Omega \\cos\\lambda, \\Omega \\sin\\lambda)$. The dominant term affecting the planar motion is the vertical component, $\\Omega_z = \\Omega \\sin\\lambda$. The equations of motion for the pendulum bob of mass $m$, including the Coriolis force, are:\n$$\n\\ddot{x} = -\\omega_{0}^{2} x + 2\\Omega_z \\dot{y}\n$$\n$$\n\\ddot{y} = -\\omega_{0}^{2} y - 2\\Omega_z \\dot{x}\n$$\nwhere $\\omega_{0} = \\sqrt{g/\\ell}$ is the natural frequency of the pendulum.\n\nTo solve this system, we introduce the complex coordinate $u(t) = x(t) + iy(t)$. The equations of motion combine into a single equation for $u$:\n$$\n\\ddot{u} + 2i\\Omega_z \\dot{u} + \\omega_{0}^{2} u = 0\n$$\nThis is a second-order linear ordinary differential equation with constant coefficients. We seek solutions of the form $u(t) \\propto \\exp(i\\omega t)$. Substituting this into the equation yields the characteristic equation for the frequencies $\\omega$:\n$$\n-\\omega^2 - 2\\Omega_z \\omega + \\omega_{0}^{2} = 0 \\quad \\implies \\quad \\omega^2 + 2\\Omega_z \\omega - \\omega_{0}^{2} = 0\n$$\nThe solutions for $\\omega$ are:\n$$\n\\omega = \\frac{-2\\Omega_z \\pm \\sqrt{4\\Omega_z^2 + 4\\omega_{0}^{2}}}{2} = -\\Omega_z \\pm \\sqrt{\\omega_{0}^{2} + \\Omega_z^2}\n$$\nIn the adiabatic regime $\\Omega \\ll \\omega_0$, we have $\\Omega_z \\ll \\omega_0$. We can approximate the square root: $\\sqrt{\\omega_{0}^{2} + \\Omega_z^2} \\approx \\omega_0$. The two normal mode frequencies are:\n$$\n\\omega_+ \\approx \\omega_0 - \\Omega_z\n$$\n$$\n\\omega_- \\approx -\\omega_0 - \\Omega_z\n$$\nThese frequencies correspond to right and left circularly polarized motions. The general solution is a superposition of these modes:\n$$\nu(t) = C_+ \\exp(i\\omega_+ t) + C_- \\exp(i\\omega_- t)\n$$\nwhere $C_+$ and $C_-$ are complex constants determined by initial conditions.\n\nA planar oscillation corresponds to a specific superposition of the two circular modes. For the oscillation to be linear (planar), the amplitudes of the two circular modes must be equal. Let's set $|C_+| = |C_-| = A$ and for simplicity of illustration, let their phases be such that at $t=0$ the oscillation is along the $x$-axis. This can be achieved by setting $C_+ = C_- = A$.\nThe solution becomes:\n$$\nu(t) = A (\\exp(i\\omega_+ t) + \\exp(i\\omega_- t))\n$$\n$$\nu(t) = A \\exp\\left(i\\frac{\\omega_+ + \\omega_-}{2}t\\right) \\left[ \\exp\\left(i\\frac{\\omega_+ - \\omega_-}{2}t\\right) + \\exp\\left(-i\\frac{\\omega_+ - \\omega_-}{2}t\\right) \\right]\n$$\n$$\nu(t) = 2A \\cos\\left(\\frac{\\omega_+ - \\omega_-}{2}t\\right) \\exp\\left(i\\frac{\\omega_+ + \\omega_-}{2}t\\right)\n$$\nLet's evaluate the frequency components:\nThe fast oscillation frequency is:\n$$\n\\omega_{fast} = \\frac{\\omega_+ - \\omega_-}{2} \\approx \\frac{(\\omega_0 - \\Omega_z) - (-\\omega_0 - \\Omega_z)}{2} = \\omega_0\n$$\nThe precession frequency of the plane is:\n$$\n\\omega_{plane} = \\frac{\\omega_+ + \\omega_-}{2} \\approx \\frac{(\\omega_0 - \\Omega_z) + (-\\omega_0 - \\Omega_z)}{2} = -\\Omega_z\n$$\nSubstituting these back into the expression for $u(t)$:\n$$\nu(t) = \\underbrace{2A \\cos(\\omega_0 t)}_{\\text{Real Amplitude}} \\cdot \\underbrace{\\exp(-i\\Omega_z t)}_{\\text{Rotating Phase}}\n$$\nThis expression describes a linear oscillation with amplitude $2A \\cos(\\omega_0 t)$ along a line that rotates in the complex plane with angular velocity $-\\Omega_z$. The angle of the plane of oscillation, $\\psi(t)$, with respect to the $x$-axis (East) is given by the phase of the complex exponential term:\n$$\n\\psi(t) = -\\Omega_z t = -(\\Omega \\sin\\lambda) t\n$$\nThe rate of precession of the pendulum's plane is $\\dot{\\psi} = -\\Omega \\sin\\lambda$. A negative sign indicates clockwise rotation in the Northern Hemisphere ($\\lambda>0$), which is consistent with observation.\n\nThe problem asks for the total Hannay angle accumulated after one full cycle of the Earth's rotation, which is a sidereal day of duration $T = \\frac{2\\pi}{\\Omega}$. This angle is the total change in the plane's orientation, $\\Delta\\psi$.\n$$\n\\Delta\\psi = \\int_{0}^{T} \\dot{\\psi}(t) \\,dt = \\int_{0}^{T} (-\\Omega \\sin\\lambda) \\,dt = -(\\Omega \\sin\\lambda) T\n$$\nSubstituting $T = \\frac{2\\pi}{\\Omega}$:\n$$\n\\Delta\\psi = -(\\Omega \\sin\\lambda) \\left(\\frac{2\\pi}{\\Omega}\\right) = -2\\pi \\sin\\lambda\n$$\nThis quantity is the geometric phase, or Hannay angle, associated with the adiabatic transport of the pendulum's oscillation plane around a circle of latitude. It depends only on the geometry of the path (the latitude $\\lambda$) and not on the dynamical details of the pendulum like its frequency or amplitude.\n\nThe problem's instruction about subtracting the dynamical phase $\\int_0^T \\omega_0 dt$ from the \"fast angle\" can be interpreted in the context of the normal modes. The phase accumulation of a normal mode, e.g., $\\Delta\\theta = \\omega_+ T = (\\omega_0 - \\Omega_z)T$, can be decomposed into a dynamical part $\\omega_0 T$ and a geometric part $-\\Omega_z T$. The precession of the physical plane of oscillation is directly given by this geometric part. The calculation above directly computes this precession angle.",
            "answer": "$$\\boxed{-2\\pi\\sin(\\lambda)}$$"
        },
        {
            "introduction": "Theoretical physics often operates in idealized limits, and the concept of adiabaticity is no exception. While the Hannay angle for a one-dimensional harmonic oscillator is theoretically zero, what happens in a real or simulated system where the parameter change is slow, but not infinitely so? This computational problem  bridges theory and practice by tasking you to compare the zero theoretical prediction with a direct numerical integration, using the resulting discrepancy to quantify the error inherent in the adiabatic approximation.",
            "id": "3776757",
            "problem": "Consider a one-degree-of-freedom integrable Hamiltonian system, the time-dependent harmonic oscillator, with Hamiltonian $$H(q,p,t)=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\,\\omega(t)^{2}q^{2},$$ where $q$ is position, $p$ is momentum, $m$ is mass, and $\\omega(t)$ is a slowly varying angular frequency that returns to its initial value after a cycle. Assume a cyclic parameter variation $\\omega(t)=\\omega_{0}\\left(1+\\varepsilon\\cos(\\Omega t)\\right)$, with fixed $\\omega_{0}>0$, amplitude $0\\leq \\varepsilon<1$ ensuring $\\omega(t)>0$, and slow modulation rate $\\Omega>0$. The system is integrable and admits action-angle variables $(I,\\theta)$ for each frozen value of the parameter, defined by the canonical transformation $$q=\\sqrt{\\frac{2I}{m\\,\\omega}}\\sin\\theta,\\qquad p=\\sqrt{2I\\,m\\,\\omega}\\cos\\theta.$$ In the adiabatic regime, the action $I$ is an adiabatic invariant and the angle $\\theta$ evolves primarily with the instantaneous frequency; the Hannay angle is the geometric contribution to the net change in $\\theta$ over one closed cycle in parameter space, beyond the dynamical part $\\int_{0}^{T}\\omega(t)\\,dt$, where $T=\\frac{2\\pi}{\\Omega}$ is the cycle period.\n\nYour tasks are:\n- Starting from the fundamental Hamiltonian framework and the definition of canonical action-angle variables, formulate the canonical perturbation theory needed to identify the Hannay angle for the one-degree-of-freedom harmonic oscillator under a cyclic, slowly varying frequency. Show that, due to the trivial curvature of the Hannay connection for this one-dimensional linear system, the Hannay angle predicted by canonical perturbation theory is zero for any closed loop of $\\omega(t)$ that returns to its initial value.\n- Design an algorithm that numerically integrates Hamilton’s equations over one modulation cycle, extracts the instantaneous angle $\\theta(t)$ using the frozen-parameter action-angle mapping, and computes the net numerical Hannay angle as the residual $$\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt,$$ where $\\Delta\\theta=\\theta(T)-\\theta(0)$ is computed with continuous phase unwrapping.\n- Estimate the error of the adiabatic approximation by comparing the numerical Hannay angle to the canonical perturbation prediction (which is zero), and report the absolute error.\n\nPhysical and numerical units must be explicitly respected: use $m$ in $\\mathrm{kg}$, $q$ in $\\mathrm{m}$, $p$ in $\\mathrm{kg} \\cdot \\mathrm{m/s}$, time $t$ in $\\mathrm{s}$, angular frequency $\\omega$ and $\\Omega$ in $\\mathrm{rad/s}$, and angles in $\\mathrm{radians}$. Express all angle-related outputs in $\\mathrm{radians}$.\n\nImplement a complete, runnable program that:\n- Integrates Hamilton’s equations $$\\dot{q}=\\frac{p}{m},\\qquad \\dot{p}=-m\\,\\omega(t)^{2}\\,q,$$ over one cycle $[0,T]$ with $T=\\frac{2\\pi}{\\Omega}$ for each test case.\n- Computes the instantaneous angle $$\\theta(t)=\\operatorname{atan2}\\!\\left(\\sqrt{m\\,\\omega(t)}\\,q(t),\\;\\frac{p(t)}{\\sqrt{m\\,\\omega(t)}}\\right),$$ and uses continuous unwrapping to obtain $\\Delta\\theta$.\n- Approximates the dynamical angle $\\int_{0}^{T}\\omega(t)\\,dt$ via numerical quadrature that is consistent with the integration grid.\n- Returns, for each test case, the absolute error $$E=\\left|\\left(\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt\\right)-0\\right|=\\left|\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt\\right|,$$ in $\\mathrm{radians}$.\n\nUse the following test suite, which covers a typical adiabatic case, a boundary case, and a non-adiabatic edge case. In each case, set $m=1$ $\\mathrm{kg}$, initial position $q(0)=0$ $\\mathrm{m}$, and choose initial momentum $p(0)=m\\,\\omega(0)\\,A$ with amplitude $A$ in $\\mathrm{m}$ so that the initial angle is $\\theta(0)\\approx 0$:\n- Test case $1$ (adiabatic regime): $\\omega_{0}=10$ $\\mathrm{rad/s}$, $\\varepsilon=0.2$, $\\Omega=0.2$ $\\mathrm{rad/s}$, $A=0.05$ $\\mathrm{m}$.\n- Test case $2$ (boundary case with no modulation): $\\omega_{0}=10$ $\\mathrm{rad/s}$, $\\varepsilon=0$, $\\Omega=0.5$ $\\mathrm{rad/s}$, $A=0.03$ $\\mathrm{m}$.\n- Test case $3$ (non-adiabatic regime): $\\omega_{0}=10$ $\\mathrm{rad/s}$, $\\varepsilon=0.2$, $\\Omega=5.0$ $\\mathrm{rad/s}$, $A=0.05$ $\\mathrm{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[r_1,r_2,r_3]`), where each $r_i$ is the absolute error $E$ in $\\mathrm{radians}$ for the corresponding test case, represented as a floating-point number.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of Hamiltonian mechanics and adiabatic theory, is well-posed with a complete and consistent set of definitions and parameters, and is formulated with objective and precise language.\n\nWe will first provide the theoretical derivation requested, followed by the design of the numerical algorithm.\n\n### Part 1: Theoretical Derivation of the Hannay Angle\n\nThe system is a one-degree-of-freedom time-dependent harmonic oscillator described by the Hamiltonian:\n$H(q,p,t) = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega(t)^2 q^2$\nwhere $\\omega(t)$ is a slowly varying parameter that undergoes a cyclic evolution, i.e., $\\omega(T) = \\omega(0)$ for some period $T$.\n\nFor any fixed value of the parameter $\\omega$, the system is integrable. We can introduce action-angle variables $(I, \\theta)$ via the canonical transformation provided:\n$$q = \\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta, \\qquad p = \\sqrt{2Im\\omega}\\cos\\theta$$\nSubstituting this into the Hamiltonian for a frozen $\\omega$ yields:\n$$H(I, \\theta) = \\frac{(\\sqrt{2Im\\omega}\\cos\\theta)^2}{2m} + \\frac{1}{2}m\\omega^2\\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right)^2$$\n$$H(I, \\theta) = \\frac{2Im\\omega\\cos^2\\theta}{2m} + \\frac{1}{2}m\\omega^2\\left(\\frac{2I}{m\\omega}\\sin^2\\theta\\right)$$\n$$H(I, \\theta) = I\\omega\\cos^2\\theta + I\\omega\\sin^2\\theta = I\\omega(\\cos^2\\theta + \\sin^2\\theta) = I\\omega$$\nAs required for action-angle variables, the new Hamiltonian depends only on the action $I$. The frequency of motion on the invariant torus is $\\frac{\\partial H}{\\partial I} = \\omega$. The dynamical part of the angle evolution over a cycle of duration $T$ is therefore $\\Delta\\theta_{\\text{dyn}} = \\int_0^T \\omega(t) dt$.\n\nThe Hannay angle, $\\Delta\\theta_H$, is the additional geometric phase acquired by the angle variable $\\theta$ due to the cyclic variation of the parameter $\\omega(t)$. For a system with one parameter $\\lambda$ (here, $\\lambda = \\omega$), the Hannay angle for a closed loop in parameter space is given by the integral of the Hannay connection one-form $A_\\omega$:\n$$\\Delta\\theta_H = \\oint A_\\omega d\\omega$$\nThe connection is defined by averaging over the fast motion on an invariant torus (a cycle in $\\theta$ from $0$ to $2\\pi$):\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\frac{\\partial q}{\\partial \\omega} \\frac{\\partial p}{\\partial \\theta} - \\frac{\\partial p}{\\partial \\omega} \\frac{\\partial q}{\\partial \\theta} \\right)$$\nThe partial derivatives are computed holding the action-angle variables $(I, \\theta)$ constant:\n- $\\frac{\\partial q}{\\partial \\omega} = \\frac{\\partial}{\\partial \\omega} \\left(\\sqrt{\\frac{2I}{m}}\\omega^{-1/2}\\sin\\theta\\right) = \\sqrt{\\frac{2I}{m}}(-\\frac{1}{2}\\omega^{-3/2})\\sin\\theta = -\\frac{1}{2\\omega} \\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right) = -\\frac{q}{2\\omega}$\n- $\\frac{\\partial p}{\\partial \\omega} = \\frac{\\partial}{\\partial \\omega} \\left(\\sqrt{2Im}\\omega^{1/2}\\cos\\theta\\right) = \\sqrt{2Im}(\\frac{1}{2}\\omega^{-1/2})\\cos\\theta = \\frac{1}{2\\omega} \\left(\\sqrt{2Im\\omega}\\cos\\theta\\right) = \\frac{p}{2\\omega}$\n- $\\frac{\\partial q}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right) = \\sqrt{\\frac{2I}{m\\omega}}\\cos\\theta = \\frac{p}{m\\omega}$\n- $\\frac{\\partial p}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(\\sqrt{2Im\\omega}\\cos\\theta\\right) = -\\sqrt{2Im\\omega}\\sin\\theta = -m\\omega q$\n\nSubstituting these into the expression for the connection $A_\\omega$:\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\left(-\\frac{q}{2\\omega}\\right)(-m\\omega q) - \\left(\\frac{p}{2\\omega}\\right)\\left(\\frac{p}{m\\omega}\\right) \\right)$$\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\frac{m q^2}{2} - \\frac{p^2}{2m\\omega^2} \\right)$$\nTo evaluate the integral, we express $q$ and $p$ in terms of $(I, \\theta)$:\n$$ \\frac{m q^2}{2} = \\frac{m}{2} \\left( \\frac{2I}{m\\omega}\\sin^2\\theta \\right) = \\frac{I}{\\omega}\\sin^2\\theta $$\n$$ \\frac{p^2}{2m\\omega^2} = \\frac{1}{2m\\omega^2} (2Im\\omega\\cos^2\\theta) = \\frac{I}{\\omega}\\cos^2\\theta $$\nThe integrand becomes:\n$$ \\frac{I}{\\omega}\\sin^2\\theta - \\frac{I}{\\omega}\\cos^2\\theta = -\\frac{I}{\\omega}(\\cos^2\\theta - \\sin^2\\theta) = -\\frac{I}{\\omega}\\cos(2\\theta) $$\nThe connection is the average of this quantity over one period of $\\theta$:\n$$A_\\omega = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\left(-\\frac{I}{\\omega}\\cos(2\\theta)\\right) d\\theta = -\\frac{I}{2\\pi\\omega} \\left[ \\frac{\\sin(2\\theta)}{2} \\right]_0^{2\\pi} = 0$$\nSince the Hannay connection $A_\\omega$ is identically zero, the Hannay angle, which is the integral of this connection over any closed path, must also be zero:\n$$\\Delta\\theta_H = \\oint 0 \\cdot d\\omega = 0$$\nThis is a specific result for the one-dimensional harmonic oscillator, a linear system, and reflects the trivial curvature of the parameter space connection. Any non-zero value for the quantity $\\Delta\\theta - \\int_0^T \\omega(t) dt$ computed from a direct simulation is therefore not a true Hannay angle but a result of non-adiabatic effects that are neglected in the lowest-order geometric theory. The problem correctly identifies this numerical residual as a measure of the error in the adiabatic approximation.\n\n### Part 2: Numerical Algorithm Design\n\nThe algorithm computes the error of the adiabatic approximation by comparing the numerically calculated total angle change with the theoretical dynamical phase. The theoretical Hannay angle is $0$, so the error is simply the absolute value of the numerical residual.\n\nFor each test case, the following steps are executed:\n1.  **Initialization**: Define the physical parameters $m$, $\\omega_0$, $\\varepsilon$, $\\Omega$, and the initial amplitude $A$. Calculate the cycle period $T = 2\\pi/\\Omega$.\n2.  **Initial Conditions**: Set the initial position $q(0)=0$. Calculate the initial frequency $\\omega(0) = \\omega_0(1+\\varepsilon)$ and the initial momentum $p(0) = m\\omega(0)A$. These conditions correspond to an initial angle $\\theta(0)=0$.\n3.  **Hamilton's Equations**: Define the system of first-order ordinary differential equations (ODEs) for the state vector $\\mathbf{y}(t) = [q(t), p(t)]^T$:\n    $$\\frac{d\\mathbf{y}}{dt} = \\begin{pmatrix} \\dot{q} \\\\ \\dot{p} \\end{pmatrix} = \\begin{pmatrix} p/m \\\\ -m\\omega(t)^2 q \\end{pmatrix}, \\quad \\text{where} \\quad \\omega(t) = \\omega_0(1+\\varepsilon\\cos(\\Omega t))$$\n4.  **Numerical Integration**: Integrate the ODEs over the time interval $[0, T]$ using a high-precision adaptive step-size solver, specifically `scipy.integrate.solve_ivp`. The solution is evaluated on a fine, uniform time grid `t_eval` to ensure accuracy for subsequent calculations.\n5.  **Phase Calculation**:\n    a.  From the solution arrays $q(t_i)$ and $p(t_i)$ on the grid, compute the instantaneous frequency $\\omega(t_i)$ for each time step $t_i$.\n    b.  Compute the instantaneous angle $\\theta(t_i)$ using the robust two-argument arctangent function:\n        $$\\theta(t_i) = \\operatorname{atan2}\\!\\left(\\sqrt{m\\,\\omega(t_i)}\\,q(t_i),\\;\\frac{p(t_i)}{\\sqrt{m\\,\\omega(t_i)}}\\right)$$\n    c.  Use `numpy.unwrap` on the sequence $\\theta(t_i)$ to correct for $2\\pi$ jumps and obtain a continuous phase evolution.\n6.  **Total Angle Change**: Calculate the total change in the unwrapped angle, $\\Delta\\theta = \\theta_{\\text{unwrapped}}(T) - \\theta_{\\text{unwrapped}}(0)$.\n7.  **Dynamical Phase**: Numerically approximate the integral of the dynamical phase, $\\int_0^T \\omega(t) dt$, using the trapezoidal rule (`numpy.trapz`) on the same time grid `t_eval` and corresponding $\\omega(t_i)$ values. This maintains consistency with the ODE integration scheme.\n8.  **Error Calculation**: The numerical Hannay angle, or the residual beyond the dynamical phase, is $\\Delta\\theta_{\\text{num}} = \\Delta\\theta - \\int_0^T \\omega(t) dt$. The absolute error $E$ relative to the theoretical prediction of $0$ is then:\n    $$E = |\\Delta\\theta_{\\text{num}} - 0| = \\left|\\Delta\\theta - \\int_0^T \\omega(t) dt\\right|$$\n9.  **Output**: Collect the value of $E$ for each test case and format the final output as a comma-separated list in brackets.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the error of the adiabatic approximation for a time-dependent\n    harmonic oscillator by comparing the numerically integrated angle change\n    to the theoretical prediction of a zero Hannay angle.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # Each tuple: (omega_0, epsilon, Omega, A)\n    test_cases = [\n        (10.0, 0.2, 0.2, 0.05),   # Adiabatic regime\n        (10.0, 0.0, 0.5, 0.03),   # Boundary case (no modulation)\n        (10.0, 0.2, 5.0, 0.05),   # Non-adiabatic regime\n    ]\n\n    m = 1.0  # mass in kg\n    results = []\n    \n    # Use a large number of steps for high accuracy in integration and quadrature.\n    num_steps = 50000\n\n    for case in test_cases:\n        w0, eps, Omega, A = case\n\n        # Define the time-dependent angular frequency.\n        def omega(t):\n            return w0 * (1.0 + eps * np.cos(Omega * t))\n\n        # Hamilton's equations of motion.\n        def hamilton_eqs(t, y):\n            q, p = y\n            dq_dt = p / m\n            dp_dt = -m * omega(t)**2 * q\n            return [dq_dt, dp_dt]\n\n        # Set up integration time and initial conditions.\n        T = 2.0 * np.pi / Omega if Omega > 0 else 0 # Period of modulation.\n        t_span = [0, T]\n        \n        q0 = 0.0  # Initial position in m\n        omega_initial = omega(0)\n        p0 = m * omega_initial * A # Initial momentum in kg*m/s\n        y0 = [q0, p0]\n\n        # Use a fine time grid for accurate phase calculation and integration.\n        t_eval = np.linspace(t_span[0], t_span[1], num_steps)\n        \n        # Integrate the ODEs.\n        sol = solve_ivp(\n            hamilton_eqs, \n            t_span, \n            y0, \n            t_eval=t_eval, \n            method='RK45', \n            rtol=1e-12, \n            atol=1e-12\n        )\n        \n        q_sol = sol.y[0]\n        p_sol = sol.y[1]\n        t_sol = sol.t\n\n        # Handle the edge case of T=0\n        if T == 0:\n            results.append(0.0)\n            continue\n            \n        # Calculate instantaneous frequency and angle at each time step.\n        omega_t = omega(t_sol)\n        \n        # theta(t) = atan2(sqrt(m*omega)*q, p/sqrt(m*omega))\n        Y = np.sqrt(m * omega_t) * q_sol\n        X = p_sol / np.sqrt(m * omega_t)\n        theta_t = np.arctan2(Y, X)\n        \n        # Unwrap phase to get continuous angle evolution.\n        theta_unwrapped = np.unwrap(theta_t)\n        \n        # Total angle change over the cycle.\n        delta_theta = theta_unwrapped[-1] - theta_unwrapped[0]\n        \n        # Calculate the dynamical phase by numerical integration (trapezoidal rule).\n        dynamical_phase = np.trapz(omega_t, t_sol)\n        \n        # The numerical Hannay angle is the residual.\n        numerical_hannay_angle = delta_theta - dynamical_phase\n        \n        # The error is the absolute value of the residual, as the theoretical Hannay angle is 0.\n        error = abs(numerical_hannay_angle)\n        \n        results.append(error)\n\n    # Format and print the final output as a single line.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}