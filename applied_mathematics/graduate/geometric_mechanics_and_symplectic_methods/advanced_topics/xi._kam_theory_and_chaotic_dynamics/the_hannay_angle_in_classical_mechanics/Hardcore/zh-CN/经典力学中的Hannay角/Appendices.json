{
    "hands_on_practices": [
        {
            "introduction": "在我们深入研究特定系统的计算之前，首先必须掌握区分几何相位与动力学相位的基本概念。这个练习旨在通过思想实验，探索在参数回路上改变时间进程所带来的影响，从而帮助你巩固对哈奈角的“几何”本质的理解。通过分析其在路径重参数化和方向反转下的变换特性，你将学会如何从根本上识别一个相位贡献是否源于几何学 。",
            "id": "3776766",
            "problem": "考虑一个具有 $n$ 个自由度的经典完全可积哈密顿系统，用作用量-角度变量 $(I,\\theta)$ 表示，其哈密顿量为 $H(I,\\lambda)$，其中 $\\lambda \\in \\mathcal{M}$ 是一组外部控制参数，其值取自一个光滑流形。假设参数随时间沿光滑闭合回路 $C: t \\mapsto \\lambda(t)$（$t \\in [0,T]$）缓慢变化，$T$ 足够大，以至于作用量 $I$ 在主导阶上是绝热不变量。在遍历回路一周后，角度变量相对于其初始值会产生一个净位移。人们通常将此净位移分解为一个几何贡献（Hannay 非完整性）和一个动力学贡献（随时间累积的频率）。\n\n哪个选项陈述了一个正确的标准，仅通过在光滑时间重标度 $t \\mapsto \\alpha t$（其中 $\\alpha>0$）和对同一参数回路进行光滑重参数化 $t \\mapsto \\tau(t)$（可能包括通过 $t \\mapsto T-t$ 反转回路方向）下的行为，而无需参考任何具体的坐标公式，来区分几何 Hannay 非完整性与动力学相位累积？\n\nA. 几何 Hannay 非完整性正是总角度位移中，在对同一有向回路 $C$ 进行所有光滑、严格递增的重参数化 $t \\mapsto \\tau(t)$ 下保持不变，且与总时长 $T$ 无关的那一部分；此外，如果通过 $t \\mapsto T-t$ 反转回路方向，它会改变符号。相反，动力学相位是在 $t \\mapsto \\alpha t$ 下按比例缩放（因此依赖于 $T$），并且在通过 $t \\mapsto T-t$ 反转回路方向时保持不变的那一部分。\n\nB. 几何 Hannay 非完整性正是总角度位移中依赖于 $(I,\\theta)$ 空间中回路所包围面积的那一部分，因此也随沿回路的速度而变化；相反，动力学相位仅依赖于瞬时参数值，并在时间重标度下保持不变。\n\nC. 几何 Hannay 非完整性总可以通过沿参数空间回路进行适当的、依赖于时间的、正则的角度原点变换来消除，从而使剩余部分纯粹是动力学的；因此，任何在这种规范选择下仍然存在的相移都是动力学的。\n\nD. 如果以两种不同的速度分布但相同的总时长 $T$ 遍历同一回路两次，那么两次测得的角度位移之差为零，当且仅当该位移是纯粹动力学的；因此，对于不同速度分布，位移的相等性可以识别出动力学相位。\n\nE. 几何 Hannay 非完整性是总角度位移中，在反转回路方向下为偶的那一部分，而动力学相位是在反转回路下为奇的那一部分；因此，回路反转可以分离出动力学相位。",
            "solution": "用户希望我验证并解决一个关于经典可积系统在绝热演化下，Hannay 角（几何相位）和动力学相位的区分特性的问题。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   **系统：** 一个经典完全可积哈密顿系统。\n*   **自由度：** $n$。\n*   **坐标：** 作用量-角度变量 $(I, \\theta)$，其中 $I = (I_1, \\dots, I_n)$ 且 $\\theta = (\\theta_1, \\dots, \\theta_n)$。\n*   **哈密顿量：** $H(I, \\lambda)$。\n*   **参数：** 一组在光滑流形 $\\mathcal{M}$ 上的外部控制参数 $\\lambda$。\n*   **过程：** 参数 $\\lambda$ 随时间沿光滑闭合回路 $C: t \\mapsto \\lambda(t)$（$t \\in [0, T]$）缓慢变化。\n*   **绝热条件：** 时长 $T$ 足够大，确保作用量 $I$ 在主导阶上是绝热不变量。\n*   **观测：** 角度变量 $\\theta$ 经历一个净位移 $\\Delta\\theta$。\n*   **分解：** 此位移被分解为一个几何部分（Hannay 非完整性）和一个动力学部分。\n*   **问题：** 题目要求提出一个标准，仅根据回路 $C$ 的时间参数化在特定变换下的行为，来区分几何贡献和动力学贡献，而无需参考具体的坐标公式。这些变换是：\n    1.  时间重标度：$t \\mapsto \\alpha t$，$\\alpha  0$。\n    2.  光滑重参数化：$t \\mapsto \\tau(t)$，$\\tau$ 是一个光滑严格递增函数。\n    3.  回路方向反转：$t \\mapsto T-t$。\n\n**第2步：使用提取的已知条件进行验证**\n\n*   **科学基础：** 该问题牢固地植根于成熟的几何力学领域，具体探讨了经典系统中的几何相位概念，即 Hannay 角。其设定（可积哈密顿系统、作用量-角度变量、绝热参数变化）是该主题的标准理论框架。将总相位分解为动力学部分和几何部分是该理论的核心结果。所有概念都是标准的、科学上合理的。\n*   **适定性：** 问题是适定的。它要求基于基本变换性质进行概念上的区分，这是表征物理量的标准方法。所讨论的性质（在重参数化、缩放和方向反转下的行为）正是揭示 Hannay 角几何本质的性质。理论中存在唯一的正确答案。\n*   **客观性：** 语言正式、精确且客观。没有主观或推测性元素。\n*   **完整性和一致性：** 问题陈述是自洽的，并提供了从概念上回答问题所需的所有信息。没有矛盾之处。\n*   **其他缺陷：** 该问题并非不切实际、不适定、琐碎或无法验证。它探讨了高等经典力学中的一个核心概念点。\n\n**第3步：结论与行动**\n\n问题陈述是**有效的**。将推导完整解法。\n\n### 推导与求解\n\n角度变量的总位移 $\\Delta\\theta$，在参数沿回路 $C$ 运动一个周期后，由下式给出\n$$ \\Delta\\theta = \\int_0^T \\dot{\\theta}(t) dt $$\n哈密顿方程表明 $\\dot{\\theta} = \\frac{\\partial H}{\\partial I} \\equiv \\omega(I, \\lambda(t))$，其中 $\\omega$ 是频率向量。对系统的绝热演化进行详细分析表明，总角度位移 $\\Delta\\theta$ 可以分解为两部分：动力学相位 $\\Delta\\theta_{\\text{dyn}}$ 和几何相位（Hannay 角）$\\Delta\\theta_{\\text{geom}}$。\n$$ \\Delta\\theta = \\Delta\\theta_{\\text{dyn}} + \\Delta\\theta_{\\text{geom}} $$\n\n1.  **动力学相位 ($\\Delta\\theta_{\\text{dyn}}$):** 这部分源于系统瞬时频率随时间的累积。\n    $$ \\Delta\\theta_{\\text{dyn}} = \\int_0^T \\omega(I, \\lambda(t)) dt $$\n    这里，$I$ 是（近似恒定的）作用量。这是一个在时间区间 $[0, T]$ 上的积分。\n\n2.  **几何相位 ($\\Delta\\theta_{\\text{geom}}$):** 这部分，即 Hannay 非完整性，与遍历回路的速率无关。它是参数空间 $\\mathcal{M}$ 中回路 $C$ 以及哈密顿量的不变环面族（由 $I$ 定义）的一个纯粹几何属性。它可以表示为联络1-形式 $A$ 沿回路 $C$ 的线积分：\n    $$ \\Delta\\theta_{\\text{geom}} = \\oint_C A $$\n    其中 $A = A(I, \\lambda)$ 是“Hannay 联络”。关键点在于，这是一个参数空间中的线积分，它依赖于曲线 $C$ 的几何形状，而不依赖于其时间参数化。\n\n我们现在分析这两个分量在指定变换下的行为。\n\n*   **光滑、严格递增的重参数化 ($t \\mapsto \\tau(s)$):**\n    此变换改变了遍历回路 $C$ 的速度，但保持其路径和方向不变。\n    *   $\\Delta\\theta_{\\text{geom}}$：作为一个参数空间中的线积分，根据定义，它在任何保持方向的重参数化下都是**不变的**。它只依赖于路径 $C$，而与沿路径移动的速度无关。\n    *   $\\Delta\\theta_{\\text{dyn}}$：积分 $\\int \\omega(\\lambda(t)) dt$ 显式地依赖于时间参数化 $t$。改变速度分布 $\\dot{\\lambda}(t)$ 通常会改变积分的值，即使总时长 $T$ 保持不变。因此，动力学相位在一般重参数化下是**不不变的**。一个直接的推论是它依赖于总时长 $T$。\n\n*   **时间重标度 ($t \\mapsto \\alpha t$，其中 $T \\mapsto \\alpha T$):**\n    这对应于遍历同一回路 $C$，但总耗时为 $\\alpha T$。新的时间变量是 $t' = \\alpha t$。\n    *   $\\Delta\\theta_{\\text{geom}}$：由于它与参数化无关，所以也与总时长 $T$ 无关。它保持**不变**。\n    *   $\\Delta\\theta_{\\text{dyn}}$：新的积分为 $\\int_0^{\\alpha T} \\omega(\\lambda(t'/\\alpha)) dt'$。代入 $t = t'/\\alpha$ 得到 $dt = dt'/\\alpha$。积变为 $\\int_0^T \\omega(\\lambda(t)) (\\alpha dt) = \\alpha \\int_0^T \\omega(\\lambda(t)) dt = \\alpha \\Delta\\theta_{\\text{dyn}}$。动力学相位随总时长 $T$（或缩放因子 $\\alpha$）**线性缩放**。\n\n*   **回路方向反转 ($t \\mapsto T-t$):**\n    这对应于沿相反方向遍历回路 $C$，记为 $C^{\\text{rev}}$。\n    *   $\\Delta\\theta_{\\text{geom}}$：当积分路径反向时，线积分会变号：$\\oint_{C^{\\text{rev}}} A = - \\oint_C A$。因此，几何相位**改变符号**。它是回路方向的**奇**函数。\n    *   $\\Delta\\theta_{\\text{dyn}}$：反向路径的积分为 $\\int_0^T \\omega(\\lambda(T-t)) dt$。进行变量代换 $s=T-t$，我们得到 $ds = -dt$，积分限从 $t=0, t=T$ 变为 $s=T, s=0$。积分为 $\\int_T^0 \\omega(\\lambda(s)) (-ds) = \\int_0^T \\omega(\\lambda(s)) ds = \\Delta\\theta_{\\text{dyn}}$。动力学相位在回路反转下是**不变的**。它是回路方向的**偶**函数。\n\n**性质总结：**\n\n| 性质 | 几何相位 ($\\Delta\\theta_{\\text{geom}}$) | 动力学相位 ($\\Delta\\theta_{\\text{dyn}}$) |\n| --------------------------------- | --------------------------------------------- | ---------------------------------------------- |\n| 重参数化 | 不变 | 改变 |\n| 时长 $T$（均匀缩放） | 无关 | 与 $T$ 成正比 |\n| 回路反转 ($C \\to C^{\\text{rev}}$) | 改变符号（奇） | 不变（偶） |\n\n### 逐项分析\n\n**A. 几何 Hannay 非完整性正是总角度位移中，在对同一有向回路 $C$ 进行所有光滑、严格递增的重参数化 $t \\mapsto \\tau(t)$ 下保持不变，且与总时长 $T$ 无关的那一部分；此外，如果通过 $t \\mapsto T-t$ 反转回路方向，它会改变符号。相反，动力学相位是在 $t \\mapsto \\alpha t$ 下按比例缩放（因此依赖于 $T$），并且在通过 $t \\mapsto T-t$ 反转回路方向时保持不变的那一部分。**\n\n该陈述与我们为几何相位和动力学相位推导出的性质完全匹配。它正确地指出几何相位在重参数化下不变（因此与时长无关），并且在回路反转下是奇函数。它也正确地指出动力学相位随时长缩放，并且在回路反转下是偶函数。\n**结论：正确。**\n\n**B. 几何 Hannay 非完整性正是总角度位移中依赖于 $(I,\\theta)$ 空间中回路所包围面积的那一部分，因此也随沿回路的速度而变化；相反，动力学相位仅依赖于瞬时参数值，并在时间重标度下保持不变。**\n\n这个选项包含多个错误。回路是在参数空间 $\\mathcal{M}$ 中，而不是在整个相空间 $(I, \\theta)$ 中。几何相位，因其几何性质，与沿回路的速度无关，而不是依赖于速度。动力学相位是一个时间积分，因此它不仅仅由“瞬时”值决定，并且它在时间重标度下不是不变的；它随时间线性缩放。\n**结论：不正确。**\n\n**C. 几何 Hannay 非完整性总可以通过沿参数空间回路进行适当的、依赖于时间的、正则的角度原点变换来消除，从而使剩余部分纯粹是动力学的；因此，任何在这种规范选择下仍然存在的相移都是动力学的。**\n\n这是对几何相位和规范理论的误解。一个非零的 Hannay 角意味着一个非平凡的几何结构（Hannay 联络的曲率非零）。曲率的效应无法被全局地“规范掉”。如果可以，那么围绕任何回路的非完整性都将为零。一个非零的 Hannay 角恰恰是*不能*通过局部的角度原点变换（一种规范变换）来消除的部分。\n**结论：不正确。**\n\n**D. 如果以两种不同的速度分布但相同的总时长 $T$ 遍历同一回路两次，那么两次测得的角度位移之差为零，当且仅当该位移是纯粹动力学的；因此，对于不同速度分布，位移的相等性可以识别出动力学相位。**\n\n几何相位在速度分布变化下是不变的。动力学相位则不是。让两次遍历由下标 $1$ 和 $2$ 表示。总位移是 $\\Delta\\theta_1 = \\Delta\\theta_{\\text{geom}} + \\Delta\\theta_{\\text{dyn},1}$ 和 $\\Delta\\theta_2 = \\Delta\\theta_{\\text{geom}} + \\Delta\\theta_{\\text{dyn},2}$。它们的差是 $\\Delta\\theta_1 - \\Delta\\theta_2 = \\Delta\\theta_{\\text{dyn},1} - \\Delta\\theta_{\\text{dyn},2}$。这个差通常不为零。该陈述声称，如果位移是纯粹动力学的（$\\Delta\\theta_{\\text{geom}}=0$），则此差为零。但如果位移是纯粹动力学的，差仍然是 $\\Delta\\theta_{\\text{dyn},1} - \\Delta\\theta_{\\text{dyn},2}$，这通常不为零。逻辑有缺陷。事实上，如果发现总角度位移*不依赖于*速度分布，那将意味着位移是纯粹几何的。\n**结论：不正确。**\n\n**E. 几何 Hannay 非完整性是总角度位移中，在反转回路方向下为偶的那一部分，而动力学相位是在反转回路下为奇的那一部分；因此，回路反转可以分离出动力学相位。**\n\n这个选项错误地交换了奇偶性。如上所述，几何相位（一个线积分）在回路反转下是**奇**的，意味着它会变号。动力学相位（一个随时间的累积）在回路反转下是**偶**的，意味着它是不变的。此选项陈述的正好相反。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "现在，让我们将理论应用于经典力学中最著名的几何相位实例之一：傅科摆。这个练习要求你推导傅科摆的摆动平面因地球自转而产生的进动，这正是哈奈角的一个宏观体现。通过解决这个问题，你将把抽象的几何概念与一个可观测的物理现象直接联系起来，从而深刻理解绝热过程如何在一个真实系统中产生纯粹的几何效应 。",
            "id": "3776746",
            "problem": "考虑一个长度为 $\\ell$ 的小振幅平面摆，在均匀引力加速度 $g$ 下，安装在地球上地理纬度为 $\\lambda$ 的位置。设地球的恒定角速度为 $\\Omega$，并假设处于绝热状态 $\\Omega \\ll \\omega_{0}$，其中 $\\omega_{0} = \\sqrt{g/\\ell}$ 是摆的小幅振荡角频率。在附着于地球上摆所在位置的局部坐标系中进行计算，并忽略对 $g$ 的离心修正。在一个恒星日内，局部坐标系完成一次缓慢的周期性方向变化，周期为 $T = \\frac{2\\pi}{\\Omega}$，而摆以瞬时频率 $\\omega_{0}$ 进行快速振荡。\n\n使用哈密顿力学和作用量-角度变量，对于小振幅摆的二维各向同性谐振子表示，分析系统在周期 $T$ 内的绝热输运。从包含与地球自转的科里奥利耦合的正则哈密顿描述出发，利用作用量的绝热不变量，推导合适角度变量的演化方程。然后证明，在一个周期之后，相关角度变量的总变化可以分解为一个动力学贡献（等于瞬时频率的时间积分）和一个几何贡献（哈奈角）之和。通过从快速角度的总累积变化中明确减去动力学贡献 $\\int_{0}^{T} \\omega_{0}\\,\\mathrm{d}t$，分离出摆平面的几何哈奈进动。\n\n计算地球自转一整圈后振荡平面累积的哈奈角，以包含 $\\lambda$ 的封闭形式解析表达式表示，并以弧度为单位给出答案。您的最终答案必须是单个解析表达式。不需要进行数值计算。",
            "solution": "用户希望我推导傅科摆的哈奈角。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n- 系统：小振幅平面摆。\n- 参数：长度 $\\ell$，均匀引力加速度 $g$。\n- 位置：地理纬度 $\\lambda$。\n- 地球自转：恒定角速度 $\\Omega$。\n- 状态：绝热，$\\Omega \\ll \\omega_{0}$，其中 $\\omega_{0} = \\sqrt{g/\\ell}$。\n- 参考系：附着于地球的局部坐标系，忽略对 $g$ 的离心修正。\n- 过程：局部坐标系在一个恒星日内方向的周期性变化，周期 $T = \\frac{2\\pi}{\\Omega}$。\n- 动力学：摆以瞬时频率 $\\omega_{0}$ 进行快速振荡，缓慢进动。\n- 任务：\n    - 使用哈密顿力学和作用量-角度变量处理二维各向同性谐振子。\n    - 从包含科里奥利耦合的哈密顿量出发。\n    - 使用作用量的绝热不变量。\n    - 推导角度变量的演化方程。\n    - 将总角度变化分解为动力学部分和几何部分。\n    - 通过从快速角度的总变化中减去动力学贡献 $\\int_{0}^{T} \\omega_{0}\\,\\mathrm{d}t$，分离出被识别为摆平面进动的哈奈角。\n    - 以 $\\lambda$ 计算最终角度。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题描述了傅科摆，这是经典力学中一个标准的、可验证的现象。使用像哈奈角这样的几何相位概念来解释它，是高等力学中一种公认的方法。其物理原理（科里奥利效应、摆的运动）是合理的。\n- **良态问题：** 该问题提供了一个明确的目标和所有必要的参数及简化假设（小振幅、绝热状态）。预期会有一个唯一的、有意义的解。\n- **客观性：** 语言正式、精确，没有主观或带有偏见的陈述。\n\n**1.3. 结论：**\n该问题是有效的。这是几何力学中的一个标准问题，尽管关于角度分解的措辞需要仔细解释。\n\n### 步骤 2：求解推导\n\n摆的运动在一个随地球旋转的局部参考系中进行分析。设原点为摆的平衡点，$x$ 轴指向东，$y$ 轴指向北，$z$ 轴竖直向上。对于小振幅振荡，运动被限制在 $xy$ 平面内。\n\n地球在该局部坐标系中的角速度矢量为 $\\mathbf{\\Omega} = (0, \\Omega \\cos\\lambda, \\Omega \\sin\\lambda)$。影响平面运动的主要项是垂直分量 $\\Omega_z = \\Omega \\sin\\lambda$。包括科里奥利力的质量为 $m$ 的摆球的运动方程为：\n$$\n\\ddot{x} = -\\omega_{0}^{2} x + 2\\Omega_z \\dot{y}\n$$\n$$\n\\ddot{y} = -\\omega_{0}^{2} y - 2\\Omega_z \\dot{x}\n$$\n其中 $\\omega_{0} = \\sqrt{g/\\ell}$ 是摆的固有频率。\n\n为了解这个方程组，我们引入复坐标 $u(t) = x(t) + iy(t)$。运动方程合并为关于 $u$ 的单个方程：\n$$\n\\ddot{u} + 2i\\Omega_z \\dot{u} + \\omega_{0}^{2} u = 0\n$$\n这是一个二阶线性常系数常微分方程。我们寻求形如 $u(t) \\propto \\exp(i\\omega t)$ 的解。将其代入方程，得到频率 $\\omega$ 的特征方程：\n$$\n-\\omega^2 - 2\\Omega_z \\omega + \\omega_{0}^{2} = 0 \\quad \\implies \\quad \\omega^2 + 2\\Omega_z \\omega - \\omega_{0}^{2} = 0\n$$\n$\\omega$ 的解为：\n$$\n\\omega = \\frac{-2\\Omega_z \\pm \\sqrt{4\\Omega_z^2 + 4\\omega_{0}^{2}}}{2} = -\\Omega_z \\pm \\sqrt{\\omega_{0}^{2} + \\Omega_z^2}\n$$\n在绝热状态 $\\Omega \\ll \\omega_0$ 下，我们有 $\\Omega_z \\ll \\omega_0$。我们可以近似平方根：$\\sqrt{\\omega_{0}^{2} + \\Omega_z^2} \\approx \\omega_0$。两个简正模频率为：\n$$\n\\omega_+ \\approx \\omega_0 - \\Omega_z\n$$\n$$\n\\omega_- \\approx -\\omega_0 - \\Omega_z\n$$\n这些频率对应于右旋和左旋圆偏振运动。通解是这些模式的叠加：\n$$\nu(t) = C_+ \\exp(i\\omega_+ t) + C_- \\exp(i\\omega_- t)\n$$\n其中 $C_+$ 和 $C_-$ 是由初始条件决定的复常数。\n\n平面振荡对应于两种圆周模式的特定叠加。为了使振荡是线性的（平面的），两种圆周模式的振幅必须相等。我们设 $|C_+| = |C_-| = A$，为简化说明，设它们的相位使得在 $t=0$ 时振荡沿 $x$ 轴进行。这可以通过设置 $C_+ = C_- = A$ 来实现。\n解变为：\n$$\nu(t) = A (\\exp(i\\omega_+ t) + \\exp(i\\omega_- t))\n$$\n$$\nu(t) = A \\exp\\left(i\\frac{\\omega_+ + \\omega_-}{2}t\\right) \\left[ \\exp\\left(i\\frac{\\omega_+ - \\omega_-}{2}t\\right) + \\exp\\left(-i\\frac{\\omega_+ - \\omega_-}{2}t\\right) \\right]\n$$\n$$\nu(t) = 2A \\cos\\left(\\frac{\\omega_+ - \\omega_-}{2}t\\right) \\exp\\left(i\\frac{\\omega_+ + \\omega_-}{2}t\\right)\n$$\n我们来计算频率分量：\n快速振荡频率是：\n$$\n\\omega_{fast} = \\frac{\\omega_+ - \\omega_-}{2} \\approx \\frac{(\\omega_0 - \\Omega_z) - (-\\omega_0 - \\Omega_z)}{2} = \\omega_0\n$$\n平面的进动频率是：\n$$\n\\omega_{plane} = \\frac{\\omega_+ + \\omega_-}{2} \\approx \\frac{(\\omega_0 - \\Omega_z) + (-\\omega_0 - \\Omega_z)}{2} = -\\Omega_z\n$$\n将这些代回到 $u(t)$ 的表达式中：\n$$\nu(t) = \\underbrace{2A \\cos(\\omega_0 t)}_{\\text{实振幅}} \\cdot \\underbrace{\\exp(-i\\Omega_z t)}_{\\text{旋转相位}}\n$$\n此表达式描述了一个振幅为 $2A \\cos(\\omega_0 t)$ 的线性振荡，该振荡沿着一条在复平面中以角速度 $-\\Omega_z$ 旋转的直线上进行。振荡平面 $\\psi(t)$ 相对于 $x$ 轴（东方）的角度由复指数项的相位给出：\n$$\n\\psi(t) = -\\Omega_z t = -(\\Omega \\sin\\lambda) t\n$$\n摆平面的进动速率是 $\\dot{\\psi} = -\\Omega \\sin\\lambda$。负号表示在北半球（$\\lambda0$）顺时针旋转，这与观测结果一致。\n\n问题要求的是地球自转一整圈（即一个持续时间为 $T = \\frac{2\\pi}{\\Omega}$ 的恒星日）后累积的总哈奈角。这个角是平面方向的总变化 $\\Delta\\psi$。\n$$\n\\Delta\\psi = \\int_{0}^{T} \\dot{\\psi}(t) \\,dt = \\int_{0}^{T} (-\\Omega \\sin\\lambda) \\,dt = -(\\Omega \\sin\\lambda) T\n$$\n代入 $T = \\frac{2\\pi}{\\Omega}$：\n$$\n\\Delta\\psi = -(\\Omega \\sin\\lambda) \\left(\\frac{2\\pi}{\\Omega}\\right) = -2\\pi \\sin\\lambda\n$$\n这个量就是几何相位，或称哈奈角，与摆的振荡平面绕纬度圈的绝热输运相关。它仅取决于路径的几何形状（纬度 $\\lambda$），而不取决于摆的动力学细节，如其频率或振幅。\n\n问题中关于从“快速角度”中减去动力学相位 $\\int_0^T \\omega_0 dt$ 的说明，可以在简正模的背景下解释。一个简正模的相位累积，例如 $\\Delta\\theta = \\omega_+ T = (\\omega_0 - \\Omega_z)T$，可以分解为一个动力学部分 $\\omega_0 T$ 和一个几何部分 $-\\Omega_z T$。物理振荡平面的进动直接由这个几何部分给出。上面的计算直接得出了这个进动角。",
            "answer": "$$\\boxed{-2\\pi\\sin\\lambda}$$"
        },
        {
            "introduction": "理论预测与计算现实之间有时存在差距，这个练习将带你探索这一边界。你首先需要从理论上证明，对于一个简单的一维谐振子，其哈奈角为零。然后，你将通过编写程序来数值模拟实际的动力学过程，揭示当完美的“绝热”条件在有限时间内无法满足时会发生什么。这项实践不仅能让你掌握数值验证的技能，还能让你直观地理解非绝热修正的来源和意义 。",
            "id": "3776757",
            "problem": "考虑一个单自由度的可积哈密顿系统，即时谐振子，其哈密顿量为 $$H(q,p,t)=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\,\\omega(t)^{2}q^{2},$$ 其中 $q$ 是位置，$p$ 是动量，$m$ 是质量，$\\omega(t)$ 是一个缓慢变化的角频率，在一个周期后返回其初始值。假设参数的周期性变化为 $$\\omega(t)=\\omega_{0}\\left(1+\\varepsilon\\cos(\\Omega t)\\right),$$ 其中 $\\omega_{0}0$ 为固定值，振幅 $0 \\le \\varepsilon  1$ 确保 $\\omega(t)0$，慢调制率为 $\\Omega0$。该系统是可积的，并且对于每个冻结的参数值，都存在作用量-角度变量 $(I,\\theta)$，由以下正则变换定义：$$q=\\sqrt{\\frac{2I}{m\\,\\omega}}\\sin\\theta,\\qquad p=\\sqrt{2I\\,m\\,\\omega}\\cos\\theta.$$ 在绝热区，作用量 $I$ 是一个绝热不变量，角度 $\\theta$ 主要以瞬时频率演化；Hannay 角是在参数空间中一个闭合循环内，$\\theta$ 的净变化中超出动力学部分 $\\int_{0}^{T}\\omega(t)\\,dt$ 的几何贡献，其中 $T=\\frac{2\\pi}{\\Omega}$ 是循环周期。\n\n你的任务是：\n- 从基本的哈密顿框架和正则作用量-角度变量的定义出发，构建所需的正则微扰理论，以确定在周期性、缓慢变化的频率下单自由度谐振子的 Hannay 角。证明由于此一维线性系统的 Hannay 联络曲率为平凡的，正则微扰理论预测的、对于任何返回其初始值的 $\\omega(t)$ 闭合回路，其 Hannay 角均为零。\n- 设计一个算法，该算法对一个调制周期内的哈密顿方程进行数值积分，使用冻结参数的作用量-角度映射提取瞬时角 $\\theta(t)$，并将数值 Hannay 角计算为残差 $$\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt,$$ 其中 $\\Delta\\theta=\\theta(T)-\\theta(0)$ 是通过连续相位展开计算的。\n- 通过将数值 Hannay 角与正则微扰预测（为零）进行比较，来估计绝热近似的误差，并报告绝对误差。\n\n物理和数值单位必须明确遵守：使用 $m$（单位 $\\mathrm{kg}$），$q$（单位 $\\mathrm{m}$），$p$（单位 $\\mathrm{kg}\\cdot\\mathrm{m/s}$），时间 $t$（单位 $\\mathrm{s}$），角频率 $\\omega$ 和 $\\Omega$（单位 $\\mathrm{rad/s}$），以及角度（单位 $\\mathrm{radians}$）。所有与角度相关的输出均以 $\\mathrm{radians}$ 表示。\n\n实现一个完整、可运行的程序，该程序：\n- 对于每个测试用例，在一个周期 $[0,T]$（其中 $T=\\frac{2\\pi}{\\Omega}$）上对哈密顿方程进行积分：$$\\dot{q}=\\frac{p}{m},\\qquad \\dot{p}=-m\\,\\omega(t)^{2}\\,q,$$\n- 计算瞬时角 $$\\theta(t)=\\operatorname{atan2}\\!\\left(\\sqrt{m\\,\\omega(t)}\\,q(t),\\;\\frac{p(t)}{\\sqrt{m\\,\\omega(t)}}\\right),$$ 并使用连续展开得到 $\\Delta\\theta$。\n- 通过与积分网格一致的数值积分方法，近似计算动力学角 $\\int_{0}^{T}\\omega(t)\\,dt$。\n- 对于每个测试用例，返回绝对误差 $$E=\\left|\\left(\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt\\right)-0\\right|=\\left|\\Delta\\theta-\\int_{0}^{T}\\omega(t)\\,dt\\right|,$$ 单位为 $\\mathrm{radians}$。\n\n使用以下测试套件，它涵盖了一个典型的绝热情况、一个边界情况和一个非绝热边缘情况。在每种情况下，设置 $m=1\\,\\mathrm{kg}$，初始位置 $q(0)=0\\,\\mathrm{m}$，并选择初始动量 $p(0)=m\\,\\omega(0)\\,A$（其中振幅 $A$ 的单位为 $\\mathrm{m}$），以使初始角 $\\theta(0)=0$：\n- 测试用例 1（绝热区）：$\\omega_{0}=10$ $\\mathrm{rad/s}$，$\\varepsilon=0.2$，$\\Omega=0.2$ $\\mathrm{rad/s}$，$A=0.05$ $\\mathrm{m}$。\n- 测试用例 2（无调制的边界情况）：$\\omega_{0}=10$ $\\mathrm{rad/s}$，$\\varepsilon=0$，$\\Omega=0.5$ $\\mathrm{rad/s}$，$A=0.03$ $\\mathrm{m}$。\n- 测试用例 3（非绝热区）：$\\omega_{0}=10$ $\\mathrm{rad/s}$，$\\varepsilon=0.2$，$\\Omega=5.0$ $\\mathrm{rad/s}$，$A=0.05$ $\\mathrm{m}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 `[r_{1},r_{2},r_{3}]`），其中每个 `r_{i}` 是相应测试用例的绝对误差 `E`（以 $\\mathrm{radians}$ 为单位），表示为浮点数。",
            "solution": "该问题是有效的。它在科学上基于哈密顿力学和绝热理论的原理，定义和参数完备且一致，问题阐述良好，并使用客观精确的语言进行表述。\n\n我们将首先提供所要求的理论推导，然后设计数值算法。\n\n### 第 1 部分：Hannay 角的理论推导\n\n该系统是一个单自由度的时谐振子，由哈密顿量描述：\n$$H(q,p,t) = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega(t)^2 q^2$$\n其中 $\\omega(t)$ 是一个缓慢变化的参数，经历一个周期性演化，即对于某个周期 $T$，有 $\\omega(T) = \\omega(0)$。\n\n对于参数 $\\omega$ 的任意固定值，该系统是可积的。我们可以通过所提供的正则变换引入作用量-角度变量 $(I, \\theta)$：\n$$q = \\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta, \\qquad p = \\sqrt{2Im\\omega}\\cos\\theta$$\n将此代入冻结 $\\omega$ 时的哈密顿量，可得：\n$$H(I, \\theta) = \\frac{(\\sqrt{2Im\\omega}\\cos\\theta)^2}{2m} + \\frac{1}{2}m\\omega^2\\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right)^2$$\n$$H(I, \\theta) = \\frac{2Im\\omega\\cos^2\\theta}{2m} + \\frac{1}{2}m\\omega^2\\left(\\frac{2I}{m\\omega}\\sin^2\\theta\\right)$$\n$$H(I, \\theta) = I\\omega\\cos^2\\theta + I\\omega\\sin^2\\theta = I\\omega(\\cos^2\\theta + \\sin^2\\theta) = I\\omega$$\n如作用量-角度变量所要求，新的哈密顿量仅依赖于作用量 $I$。在不变环面上的运动频率为 $\\frac{\\partial H}{\\partial I} = \\omega$。因此，在持续时间为 $T$ 的一个周期内，角度演化的动力学部分是 $\\Delta\\theta_{\\text{dyn}} = \\int_0^T \\omega(t) dt$。\n\nHannay 角 $\\Delta\\theta_H$ 是由于参数 $\\omega(t)$ 的周期性变化，角度变量 $\\theta$ 获得的额外几何相位。对于具有单个参数 $\\lambda$（此处 $\\lambda = \\omega$）的系统，参数空间中闭合回路的 Hannay 角由 Hannay 联络一形式 $A_\\omega$ 的积分给出：\n$$\\Delta\\theta_H = \\oint A_\\omega d\\omega$$\n该联络定义为在不变环面上的快运动（$\\theta$ 从 $0$ 到 $2\\pi$ 的一个周期）上进行平均：\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\frac{\\partial q}{\\partial \\omega} \\frac{\\partial p}{\\partial \\theta} - \\frac{\\partial p}{\\partial \\omega} \\frac{\\partial q}{\\partial \\theta} \\right)$$\n计算偏导数时，保持作用量-角度变量 $(I, \\theta)$ 不变：\n- $\\frac{\\partial q}{\\partial \\omega} = \\frac{\\partial}{\\partial \\omega} \\left(\\sqrt{\\frac{2I}{m}}\\omega^{-1/2}\\sin\\theta\\right) = \\sqrt{\\frac{2I}{m}}(-\\frac{1}{2}\\omega^{-3/2})\\sin\\theta = -\\frac{1}{2\\omega} \\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right) = -\\frac{q}{2\\omega}$\n- $\\frac{\\partial p}{\\partial \\omega} = \\frac{\\partial}{\\partial \\omega} \\left(\\sqrt{2Im}\\omega^{1/2}\\cos\\theta\\right) = \\sqrt{2Im}(\\frac{1}{2}\\omega^{-1/2})\\cos\\theta = \\frac{1}{2\\omega} \\left(\\sqrt{2Im\\omega}\\cos\\theta\\right) = \\frac{p}{2\\omega}$\n- $\\frac{\\partial q}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(\\sqrt{\\frac{2I}{m\\omega}}\\sin\\theta\\right) = \\sqrt{\\frac{2I}{m\\omega}}\\cos\\theta = \\frac{p}{m\\omega}$\n- $\\frac{\\partial p}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(\\sqrt{2Im\\omega}\\cos\\theta\\right) = -\\sqrt{2Im\\omega}\\sin\\theta = -m\\omega q$\n\n将这些代入联络 $A_\\omega$ 的表达式中：\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\left(-\\frac{q}{2\\omega}\\right)(-m\\omega q) - \\left(\\frac{p}{2\\omega}\\right)\\left(\\frac{p}{m\\omega}\\right) \\right)$$\n$$A_\\omega = \\frac{1}{2\\pi} \\oint_I d\\theta \\left( \\frac{m q^2}{2} - \\frac{p^2}{2m\\omega^2} \\right)$$\n为了计算该积分，我们用 $(I, \\theta)$ 表示 $q$ 和 $p$：\n$$ \\frac{m q^2}{2} = \\frac{m}{2} \\left( \\frac{2I}{m\\omega}\\sin^2\\theta \\right) = \\frac{I}{\\omega}\\sin^2\\theta $$\n$$ \\frac{p^2}{2m\\omega^2} = \\frac{1}{2m\\omega^2} (2Im\\omega\\cos^2\\theta) = \\frac{I}{\\omega}\\cos^2\\theta $$\n被积函数变为：\n$$ \\frac{I}{\\omega}\\sin^2\\theta - \\frac{I}{\\omega}\\cos^2\\theta = -\\frac{I}{\\omega}(\\cos^2\\theta - \\sin^2\\theta) = -\\frac{I}{\\omega}\\cos(2\\theta) $$\n该联络是此量在 $\\theta$ 的一个周期内的平均值：\n$$A_\\omega = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\left(-\\frac{I}{\\omega}\\cos(2\\theta)\\right) d\\theta = -\\frac{I}{2\\pi\\omega} \\left[ \\frac{\\sin(2\\theta)}{2} \\right]_0^{2\\pi} = 0$$\n由于 Hannay 联络 $A_\\omega$ 恒等于零，因此作为该联络在任何闭合路径上的积分的 Hannay 角也必定为零：\n$$\\Delta\\theta_H = \\oint 0 \\cdot d\\omega = 0$$\n这是一维谐振子（一个线性系统）的特定结果，反映了参数空间联络的平凡曲率。因此，通过直接模拟计算出的量 $\\Delta\\theta - \\int_0^T \\omega(t) dt$ 的任何非零值，都不是真正的 Hannay 角，而是最低阶几何理论中被忽略的非绝热效应的结果。问题正确地将此数值残差识别为绝热近似误差的度量。\n\n### 第 2 部分：数值算法设计\n\n该算法通过比较数值计算的总角度变化与理论动力学相位来计算绝热近似的误差。理论上的 Hannay 角为 $0$，因此误差就是数值残差的绝对值。\n\n对于每个测试用例，执行以下步骤：\n1.  **初始化**：定义物理参数 $m$、$\\omega_0$、$\\varepsilon$、$\\Omega$ 和初始振幅 $A$。计算循环周期 $T = 2\\pi/\\Omega$。\n2.  **初始条件**：设置初始位置 $q(0)=0$。计算初始频率 $\\omega(0) = \\omega_0(1+\\varepsilon)$ 和初始动量 $p(0) = m\\omega(0)A$。这些条件对应于初始角 $\\theta(0)=0$。\n3.  **哈密顿方程**：为状态向量 $\\mathbf{y}(t) = [q(t), p(t)]^T$ 定义一阶常微分方程（ODE）系统：\n    $$\\frac{d\\mathbf{y}}{dt} = \\begin{pmatrix} \\dot{q} \\\\ \\dot{p} \\end{pmatrix} = \\begin{pmatrix} p/m \\\\ -m\\omega(t)^2 q \\end{pmatrix}, \\quad \\text{其中} \\quad \\omega(t) = \\omega_0(1+\\varepsilon\\cos(\\Omega t))$$\n4.  **数值积分**：使用高精度自适应步长求解器（具体为 `scipy.integrate.solve_ivp`）在时间区间 $[0, T]$ 上对 ODE 进行积分。解在精细、均匀的时间网格 `t_eval` 上求值，以确保后续计算的准确性。\n5.  **相位计算**：\n    a.  根据网格上的解数组 $q(t_i)$ 和 $p(t_i)$，计算每个时间步 $t_i$ 的瞬时频率 $\\omega(t_i)$。\n    b.  使用稳健的双参数反正切函数计算瞬时角 $\\theta(t_i)$：\n        $$\\theta(t_i) = \\operatorname{atan2}\\!\\left(\\sqrt{m\\,\\omega(t_i)}\\,q(t_i),\\;\\frac{p(t_i)}{\\sqrt{m\\,\\omega(t_i)}}\\right)$$\n    c.  对序列 $\\theta(t_i)$ 使用 `numpy.unwrap` 来校正 $2\\pi$ 的跳变，以获得连续的相位演化。\n6.  **总角度变化**：计算展开后角度的总变化量 $\\Delta\\theta = \\theta_{\\text{unwrapped}}(T) - \\theta_{\\text{unwrapped}}(0)$。\n7.  **动力学相位**：使用梯形法则 (`numpy.trapz`) 在相同的时间网格 `t_eval` 和相应的 $\\omega(t_i)$ 值上数值逼近动力学相位的积分 $\\int_0^T \\omega(t) dt$。这与 ODE 积分方案保持一致。\n8.  **误差计算**：数值 Hannay 角，或动力学相位之外的残差，是 $\\Delta\\theta_{\\text{num}} = \\Delta\\theta - \\int_0^T \\omega(t) dt$。相对于理论预测值 $0$ 的绝对误差 $E$ 则为：\n    $$E = |\\Delta\\theta_{\\text{num}} - 0| = \\left|\\Delta\\theta - \\int_0^T \\omega(t) dt\\right|$$\n9.  **输出**：收集每个测试用例的 $E$ 值，并将最终输出格式化为方括号内的逗号分隔列表。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the error of the adiabatic approximation for a time-dependent\n    harmonic oscillator by comparing the numerically integrated angle change\n    to the theoretical prediction of a zero Hannay angle.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # Each tuple: (omega_0, epsilon, Omega, A)\n    test_cases = [\n        (10.0, 0.2, 0.2, 0.05),   # Adiabatic regime\n        (10.0, 0.0, 0.5, 0.03),   # Boundary case (no modulation)\n        (10.0, 0.2, 5.0, 0.05),   # Non-adiabatic regime\n    ]\n\n    m = 1.0  # mass in kg\n    results = []\n    \n    # Use a large number of steps for high accuracy in integration and quadrature.\n    num_steps = 50000\n\n    for case in test_cases:\n        w0, eps, Omega, A = case\n\n        # Define the time-dependent angular frequency.\n        def omega(t):\n            return w0 * (1.0 + eps * np.cos(Omega * t))\n\n        # Hamilton's equations of motion.\n        def hamilton_eqs(t, y):\n            q, p = y\n            dq_dt = p / m\n            dp_dt = -m * omega(t)**2 * q\n            return [dq_dt, dp_dt]\n\n        # Set up integration time and initial conditions.\n        T = 2.0 * np.pi / Omega if Omega > 0 else 0 # Period of modulation.\n        t_span = [0, T]\n        \n        q0 = 0.0  # Initial position in m\n        omega_initial = omega(0)\n        p0 = m * omega_initial * A # Initial momentum in kg*m/s\n        y0 = [q0, p0]\n\n        # Use a fine time grid for accurate phase calculation and integration.\n        t_eval = np.linspace(t_span[0], t_span[1], num_steps)\n        \n        # Integrate the ODEs.\n        sol = solve_ivp(\n            hamilton_eqs, \n            t_span, \n            y0, \n            t_eval=t_eval, \n            method='RK45', \n            rtol=1e-12, \n            atol=1e-12\n        )\n        \n        q_sol = sol.y[0]\n        p_sol = sol.y[1]\n        t_sol = sol.t\n\n        # Handle the edge case of T=0\n        if T == 0:\n            results.append(0.0)\n            continue\n            \n        # Calculate instantaneous frequency and angle at each time step.\n        omega_t = omega(t_sol)\n        \n        # theta(t) = atan2(sqrt(m*omega)*q, p/sqrt(m*omega))\n        Y = np.sqrt(m * omega_t) * q_sol\n        X = p_sol / np.sqrt(m * omega_t)\n        theta_t = np.arctan2(Y, X)\n        \n        # Unwrap phase to get continuous angle evolution.\n        theta_unwrapped = np.unwrap(theta_t)\n        \n        # Total angle change over the cycle.\n        delta_theta = theta_unwrapped[-1] - theta_unwrapped[0]\n        \n        # Calculate the dynamical phase by numerical integration (trapezoidal rule).\n        dynamical_phase = np.trapz(omega_t, t_sol)\n        \n        # The numerical Hannay angle is the residual.\n        numerical_hannay_angle = delta_theta - dynamical_phase\n        \n        # The error is the absolute value of the residual, as the theoretical Hannay angle is 0.\n        error = abs(numerical_hannay_angle)\n        \n        results.append(error)\n\n    # Format and print the final output as a single line.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}