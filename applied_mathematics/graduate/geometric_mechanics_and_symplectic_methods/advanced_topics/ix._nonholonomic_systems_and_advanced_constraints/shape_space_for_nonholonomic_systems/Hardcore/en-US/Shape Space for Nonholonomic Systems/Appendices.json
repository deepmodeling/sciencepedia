{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing any constrained system is to precisely characterize the constraints. In nonholonomic mechanics, these constraints act on velocities, defining a sub-bundle of the tangent bundle known as the constraint distribution. This exercise provides fundamental practice in translating analytical constraint equations, given as 1-forms, into this geometric structure and determining its rank, which specifies the dimension of allowed instantaneous motions. ",
            "id": "3766099",
            "problem": "Consider a nonholonomic locomotion system modeled on the configuration manifold $Q=\\mathrm{SE}(2)\\times \\mathbb{R}^{2}$, where $\\mathrm{SE}(2)$ denotes the Special Euclidean group in two dimensions ($\\mathrm{SE}(2)$). Use local coordinates $(x,y,\\theta,s_{1},s_{2})$ on $Q$, where $(x,y)\\in\\mathbb{R}^{2}$ are planar position coordinates, $\\theta\\in\\mathbb{R}$ is an orientation angle measured in radians, and $(s_{1},s_{2})\\in\\mathbb{R}^{2}$ are internal shape variables.\n\nSuppose the system is subject to the following idealized nonholonomic constraints given as Pfaffian 1-forms:\n$$\n\\omega^{1}=-\\sin(\\theta)\\,dx+\\cos(\\theta)\\,dy,\n\\qquad\n\\omega^{2}=d\\theta - s_{1}\\,ds_{1}- 2 s_{2}\\,ds_{2}.\n$$\nThese constraints define the constraint distribution\n$$\n\\mathcal{D}(q)=\\{v\\in T_{q}Q\\mid \\omega^{\\alpha}(v)=0 \\text{ for }\\alpha=1,2\\},\n$$\nwhich can be interpreted as the horizontal distribution of a nonholonomic connection over the shape space $M=\\mathbb{R}^{2}$ in the principal bundle $Q=\\mathrm{SE}(2)\\times M$.\n\nStarting from the fundamental definition that a constraint distribution is the common kernel of the constraint 1-forms, derive a coordinate realization of $\\mathcal{D}(q)$ as the nullspace of a coefficient matrix acting on velocity coordinates. Then, using first principles of linear algebra, verify the rank of the constraint 1-forms and deduce the rank of $\\mathcal{D}(q)$ at the specific configuration\n$$\nq^{\\ast}=(x^{\\ast},y^{\\ast},\\theta^{\\ast},s_{1}^{\\ast},s_{2}^{\\ast})=(0,1,\\tfrac{\\pi}{4},1,-1).\n$$\n\nYour final answer must be the rank of $\\mathcal{D}(q^{\\ast})$ expressed as a single integer with no units.",
            "solution": "The problem is well-posed and scientifically grounded within the field of geometric mechanics. We may proceed with the solution.\n\nThe configuration manifold of the system is $Q=\\mathrm{SE}(2)\\times \\mathbb{R}^{2}$, which is a 5-dimensional manifold. The local coordinates are given by $q = (x, y, \\theta, s_{1}, s_{2})$. A tangent vector $v \\in T_{q}Q$ at a point $q \\in Q$ can be represented in these coordinates by its velocity components, which we denote by the column vector $\\dot{q}$:\n$$\n\\dot{q} = \\begin{pmatrix} \\dot{x} \\\\ \\dot{y} \\\\ \\dot{\\theta} \\\\ \\dot{s}_{1} \\\\ \\dot{s}_{2} \\end{pmatrix} \\in \\mathbb{R}^{5}\n$$\nThe system is subject to two nonholonomic constraints, given by the Pfaffian 1-forms:\n$$\n\\begin{align*}\n\\omega^{1} &= -\\sin(\\theta)\\,dx+\\cos(\\theta)\\,dy \\\\\n\\omega^{2} &= d\\theta - s_{1}\\,ds_{1} - 2s_{2}\\,ds_{2}\n\\end{align*}\n$$\nThe constraint distribution $\\mathcal{D}(q)$ is defined as the set of all tangent vectors $v \\in T_{q}Q$ that are annihilated by both constraint forms. That is, $v \\in \\mathcal{D}(q)$ if and only if $\\omega^{1}(v)=0$ and $\\omega^{2}(v)=0$. Applying these 1-forms to a tangent vector with velocity components $\\dot{q}$ yields a system of two linear equations in these components:\n$$\n\\begin{align*}\n\\omega^{1}(v) = -\\sin(\\theta)\\dot{x} + \\cos(\\theta)\\dot{y} + 0\\cdot\\dot{\\theta} + 0\\cdot\\dot{s}_{1} + 0\\cdot\\dot{s}_{2} &= 0 \\\\\n\\omega^{2}(v) = 0\\cdot\\dot{x} + 0\\cdot\\dot{y} + 1\\cdot\\dot{\\theta} - s_{1}\\dot{s}_{1} - 2s_{2}\\dot{s}_{2} &= 0\n\\end{align*}\n$$\nThis system of equations can be written in matrix form as $A(q)\\dot{q}=0$, where $A(q)$ is the coefficient matrix derived from the coefficients of the 1-forms in the coordinate basis $\\{dx, dy, d\\theta, ds_{1}, ds_{2}\\}$. This provides the coordinate realization of $\\mathcal{D}(q)$ as the nullspace (or kernel) of $A(q)$:\n$$\nA(q) = \\begin{pmatrix}\n-\\sin(\\theta) & \\cos(\\theta) & 0 & 0 & 0 \\\\\n0 & 0 & 1 & -s_{1} & -2s_{2}\n\\end{pmatrix}\n$$\nThe distribution $\\mathcal{D}(q)$ is precisely the nullspace of this $2 \\times 5$ matrix: $\\mathcal{D}(q) = \\ker(A(q))$.\n\nThe next step is to determine the rank of the set of constraint 1-forms, which is equivalent to the rank of the matrix $A(q)$. The rank of a matrix is the number of linearly independent rows (or columns). The two row vectors of $A(q)$ are:\n$$\n\\begin{align*}\n\\mathbf{r}_1 &= \\begin{pmatrix} -\\sin(\\theta) & \\cos(\\theta) & 0 & 0 & 0 \\end{pmatrix} \\\\\n\\mathbf{r}_2 &= \\begin{pmatrix} 0 & 0 & 1 & -s_{1} & -2s_{2} \\end{pmatrix}\n\\end{align*}\n$$\nFor these two vectors to be linearly dependent, one must be a scalar multiple of the other. Let us assume $\\mathbf{r}_2 = c \\cdot \\mathbf{r}_1$ for some scalar $c \\in \\mathbb{R}$. Comparing the third components, we get $1 = c \\cdot 0$, which is a contradiction. Therefore, $\\mathbf{r}_2$ cannot be a multiple of $\\mathbf{r}_1$. Similarly, assuming $\\mathbf{r}_1 = c \\cdot \\mathbf{r}_2$ leads to contradictions as well, since $\\sin(\\theta)$ and $\\cos(\\theta)$ cannot both be zero, while the first two components of $\\mathbf{r}_2$ are both zero. Thus, the two rows are linearly independent for all $q \\in Q$.\nThis verifies that the rank of the set of constraint 1-forms, $\\mathrm{rank}(A(q))$, is $2$ for any configuration $q$, including the specific configuration $q^{\\ast}$.\n\nThe rank of the distribution $\\mathcal{D}(q)$ is its dimension as a vector subspace of the tangent space $T_q Q$. According to the rank-nullity theorem from linear algebra, for the linear map represented by $A(q):T_q Q \\rightarrow \\mathbb{R}^2$, we have:\n$$\n\\dim(T_q Q) = \\mathrm{rank}(A(q)) + \\mathrm{nullity}(A(q))\n$$\nHere, $\\dim(T_q Q) = \\dim(Q) = 5$, $\\mathrm{rank}(A(q))$ is the rank of the matrix $A(q)$, and $\\mathrm{nullity}(A(q))$ is the dimension of the nullspace, which is by definition the rank of the distribution $\\mathcal{D}(q)$.\n$$\n\\mathrm{rank}(\\mathcal{D}(q)) = \\dim(\\ker(A(q))) = \\mathrm{nullity}(A(q))\n$$\nRearranging the rank-nullity theorem, we get:\n$$\n\\mathrm{rank}(\\mathcal{D}(q)) = \\dim(Q) - \\mathrm{rank}(A(q))\n$$\nWe have already established that $\\mathrm{rank}(A(q)) = 2$ for all $q$. Therefore, the rank of the distribution is constant throughout the configuration space:\n$$\n\\mathrm{rank}(\\mathcal{D}(q)) = 5 - 2 = 3\n$$\nThis result is independent of the specific configuration. Thus, for the given point $q^{\\ast}=(0,1,\\tfrac{\\pi}{4},1,-1)$, the rank of the distribution $\\mathcal{D}(q^{\\ast})$ is also $3$.\n\nFor completeness, let us evaluate the matrix $A(q)$ at $q^{\\ast}$:\n$$\nq^{\\ast} = (x^{\\ast},y^{\\ast},\\theta^{\\ast},s_{1}^{\\ast},s_{2}^{\\ast}) = (0, 1, \\tfrac{\\pi}{4}, 1, -1)\n$$\nAt this point, $\\sin(\\theta^{\\ast}) = \\frac{\\sqrt{2}}{2}$ and $\\cos(\\theta^{\\ast}) = \\frac{\\sqrt{2}}{2}$. The matrix becomes:\n$$\nA(q^{\\ast}) = \\begin{pmatrix}\n-\\frac{\\sqrt{2}}{2} & \\frac{\\sqrt{2}}{2} & 0 & 0 & 0 \\\\\n0 & 0 & 1 & -1 & 2\n\\end{pmatrix}\n$$\nAs expected, the two rows are linearly independent, and the rank of this matrix is $2$. Applying the formula:\n$$\n\\mathrm{rank}(\\mathcal{D}(q^{\\ast})) = \\dim(Q) - \\mathrm{rank}(A(q^{\\ast})) = 5 - 2 = 3\n$$\nThe rank of the constraint distribution $\\mathcal{D}(q)$ at the specified configuration $q^{\\ast}$ is $3$.",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "For systems possessing symmetry, such as a robot moving in a plane, the constraints often acquire a deeper geometric meaning as a *mechanical connection*. This connection quantitatively links the motion of the system's internal \"shape\" variables to its overall \"group\" motion (e.g., position and orientation). This practice guides you through deriving this key object from the system's kinetic energy, revealing how fundamental geometric quantities like the locked inertia tensor and the momentum map arise from physical principles. ",
            "id": "3766143",
            "problem": "Consider a planar rigid body consisting of a uniform disk of moment of inertia $I_{b}$ about its fixed central pivot, to which is mounted a coaxial internal rotor of moment of inertia $I_{r}$ about the same axis. The configuration space is the product $Q = \\mathrm{SO}(2) \\times S^{1}$, where $\\mathrm{SO}(2)$ denotes the Special Orthogonal group (SO) of planar rotations describing the disk’s orientation, and $S^{1}$ describes the rotor’s relative spin angle. Let the group $G = \\mathrm{SO}(2)$ act on $Q$ by left multiplication on the disk orientation coordinate. Denote by $(\\theta, \\alpha)$ the coordinates on $Q$, where $\\theta$ is the disk orientation and $\\alpha$ is the rotor’s internal angle, both measured in radians. The absolute angular velocity of the disk is $\\omega = \\dot{\\theta}$, while the absolute angular velocity of the rotor is $\\omega_{r} = \\dot{\\theta} + \\dot{\\alpha}$ due to its mounting on the disk.\n\nThe kinetic energy induces a $G$-invariant Riemannian metric $g$ on $Q$. Using the standard identification of the Lie algebra $\\mathfrak{so}(2)$ with $\\mathbb{R}$, the locked inertia tensor $\\mathbb{I}(q): \\mathfrak{so}(2) \\to \\mathfrak{so}(2)^{*}$ at $q = (\\theta, \\alpha)$ is defined by the rule\n$$\\langle \\mathbb{I}(q)\\xi, \\eta \\rangle = g_{q}\\big(\\xi_{Q}(q), \\eta_{Q}(q)\\big), \\quad \\text{for all } \\xi, \\eta \\in \\mathfrak{so}(2),$$\nwhere $\\xi_{Q}$ is the infinitesimal generator associated to $\\xi$.\n\nSimilarly, the momentum map $J(q): T_{q}Q \\to \\mathfrak{so}(2)^{*}$ is defined by\n$$\\langle J(q)(v), \\xi \\rangle = g_{q}\\big(v, \\xi_{Q}(q)\\big), \\quad \\text{for all } \\xi \\in \\mathfrak{so}(2), \\ v \\in T_{q}Q.$$\n\nThe mechanical connection $A(q): T_{q}Q \\to \\mathfrak{so}(2)$ is defined implicitly by\n$$\\mathbb{I}(q)\\,A(q) = J(q).$$\n\nStarting from first principles of kinetic energy for rigid bodies, do the following:\n- Derive the $G$-invariant Riemannian metric $g$ on $Q$ induced by the kinetic energy of the disk-rotor system.\n- Compute the locked inertia tensor $\\mathbb{I}(q)$.\n- Compute the momentum map $J(q)$.\n- Use these to obtain an explicit coordinate expression for the mechanical connection $A(q)$ evaluated on a tangent vector $v = (\\dot{\\theta}, \\dot{\\alpha}) \\in T_{q}Q$.\n\nAngles must be treated in radians. Express your final answer as a single closed-form analytic expression for $A(q)(\\dot{\\theta}, \\dot{\\alpha})$ in terms of $I_{b}$, $I_{r}$, $\\dot{\\theta}$, and $\\dot{\\alpha}$.",
            "solution": "The problem requires the derivation of the mechanical connection for a planar rigid body system composed of a disk and a coaxial rotor. The derivation will proceed by first establishing the kinetic energy of the system, which in turn defines a Riemannian metric on the configuration space. Subsequently, the locked inertia tensor and the momentum map will be computed based on their geometric definitions. Finally, the mechanical connection will be determined from the relationship between these quantities.\n\nFirst, we determine the total kinetic energy $T$ of the system. The system's configuration is described by coordinates $(\\theta, \\alpha) \\in Q = \\mathrm{SO}(2) \\times S^1$. The absolute angular velocity of the disk is $\\omega = \\dot{\\theta}$, and the absolute angular velocity of the rotor is $\\omega_r = \\dot{\\theta} + \\dot{\\alpha}$. The moments of inertia for the disk and rotor about the pivot axis are $I_b$ and $I_r$, respectively.\n\nThe kinetic energy of the disk, $T_b$, is given by:\n$$ T_b = \\frac{1}{2} I_b \\omega^2 = \\frac{1}{2} I_b \\dot{\\theta}^2 $$\nThe kinetic energy of the rotor, $T_r$, is given by:\n$$ T_r = \\frac{1}{2} I_r \\omega_r^2 = \\frac{1}{2} I_r (\\dot{\\theta} + \\dot{\\alpha})^2 $$\nThe total kinetic energy $T$ is the sum $T = T_b + T_r$:\n$$ T = \\frac{1}{2} I_b \\dot{\\theta}^2 + \\frac{1}{2} I_r (\\dot{\\theta} + \\dot{\\alpha})^2 $$\nExpanding this expression yields:\n$$ T = \\frac{1}{2} I_b \\dot{\\theta}^2 + \\frac{1}{2} I_r (\\dot{\\theta}^2 + 2\\dot{\\theta}\\dot{\\alpha} + \\dot{\\alpha}^2) = \\frac{1}{2} (I_b + I_r)\\dot{\\theta}^2 + I_r \\dot{\\theta}\\dot{\\alpha} + \\frac{1}{2} I_r \\dot{\\alpha}^2 $$\n\n1.  **Derivation of the Riemannian metric $g$**\n\nThe kinetic energy induces a Riemannian metric $g$ on the configuration manifold $Q$ through the relation $T = \\frac{1}{2} g_q(v, v)$, where $q = (\\theta, \\alpha) \\in Q$ and $v = (\\dot{\\theta}, \\dot{\\alpha}) \\in T_qQ$. In the local coordinates $(\\theta, \\alpha)$, the metric $g$ can be represented by a matrix of its components $g_{ij}$ such that $T = \\frac{1}{2} \\sum_{i,j} g_{ij}\\dot{q}^i\\dot{q}^j$. By comparing this general form with our expression for $T$, we can directly identify the components of the metric tensor:\n$$ g_{\\theta\\theta} = I_b + I_r $$\n$$ g_{\\theta\\alpha} = g_{\\alpha\\theta} = I_r $$\n$$ g_{\\alpha\\alpha} = I_r $$\nTherefore, the matrix representation of the metric $g$ in the coordinate basis $\\{\\frac{\\partial}{\\partial\\theta}, \\frac{\\partial}{\\partial\\alpha}\\}$ is:\n$$ g = \\begin{pmatrix} I_b + I_r & I_r \\\\ I_r & I_r \\end{pmatrix} $$\nSince all components of $g$ are constants, the metric is independent of the configuration $q = (\\theta, \\alpha)$ and is thus invariant under the specified group action of $G = \\mathrm{SO}(2)$ on $\\theta$.\n\n2.  **Computation of the locked inertia tensor $\\mathbb{I}(q)$**\n\nThe Lie algebra of the group $G = \\mathrm{SO}(2)$ is $\\mathfrak{so}(2)$, which we identify with $\\mathbb{R}$. An element $\\xi \\in \\mathfrak{so}(2)$ is thus represented by a scalar $\\xi \\in \\mathbb{R}$. The group action on $Q$ is given by left translation on the first component: for a rotation by an angle $\\phi$ corresponding to an element of $\\mathrm{SO}(2)$, the action is $(\\theta, \\alpha) \\mapsto (\\theta + \\phi, \\alpha)$. The infinitesimal generator $\\xi_Q(q)$ for an element $\\xi \\in \\mathfrak{so}(2)$ is the vector field on $Q$ obtained by differentiating the action:\n$$ \\xi_Q(q) = \\frac{d}{dt}\\bigg|_{t=0} (\\theta + t\\xi, \\alpha) = (\\xi, 0) $$\nHere, $(\\xi, 0)$ is a tangent vector in $T_qQ$. The locked inertia tensor $\\mathbb{I}(q): \\mathfrak{so}(2) \\to \\mathfrak{so}(2)^*$ is defined by $\\langle \\mathbb{I}(q)\\xi, \\eta \\rangle = g_q(\\xi_Q(q), \\eta_Q(q))$ for all $\\xi, \\eta \\in \\mathfrak{so}(2)$. Using the identification $\\mathfrak{so}(2) \\cong \\mathbb{R}$, the pairing $\\langle \\cdot, \\cdot \\rangle$ becomes scalar multiplication.\nWe compute the inner product using the metric $g$:\n$$ g_q(\\xi_Q(q), \\eta_Q(q)) = g_q((\\xi, 0), (\\eta, 0)) = \\begin{pmatrix} \\xi & 0 \\end{pmatrix} \\begin{pmatrix} I_b + I_r & I_r \\\\ I_r & I_r \\end{pmatrix} \\begin{pmatrix} \\eta \\\\ 0 \\end{pmatrix} = (I_b + I_r)\\xi\\eta $$\nFrom the definition, we have $\\langle \\mathbb{I}(q)\\xi, \\eta \\rangle = (I_b + I_r)\\xi\\eta$. Since this must hold for all $\\eta$, we find that $\\mathbb{I}(q)\\xi = (I_b+I_r)\\xi$. As an operator on $\\mathfrak{so}(2) \\cong \\mathbb{R}$, $\\mathbb{I}(q)$ is multiplication by the scalar $(I_b + I_r)$. Thus, we identify the locked inertia tensor with this value:\n$$ \\mathbb{I}(q) = I_b + I_r $$\n\n3.  **Computation of the momentum map $J(q)$**\n\nThe momentum map $J(q): T_qQ \\to \\mathfrak{so}(2)^*$ is defined by $\\langle J(q)(v), \\xi \\rangle = g_q(v, \\xi_Q(q))$ for any $v \\in T_qQ$ and $\\xi \\in \\mathfrak{so}(2)$. Let $v = (\\dot{\\theta}, \\dot{\\alpha})$. We have $\\xi_Q(q) = (\\xi, 0)$.\nWe compute the inner product:\n$$ g_q(v, \\xi_Q(q)) = g_q((\\dot{\\theta}, \\dot{\\alpha}), (\\xi, 0)) = \\begin{pmatrix} \\dot{\\theta} & \\dot{\\alpha} \\end{pmatrix} \\begin{pmatrix} I_b + I_r & I_r \\\\ I_r & I_r \\end{pmatrix} \\begin{pmatrix} \\xi \\\\ 0 \\end{pmatrix} $$\n$$ = (\\dot{\\theta}(I_b+I_r) + \\dot{\\alpha}I_r)\\xi $$\nFrom the definition, we have $\\langle J(q)(v), \\xi \\rangle = ((I_b+I_r)\\dot{\\theta} + I_r\\dot{\\alpha})\\xi$. Since this holds for all $\\xi \\in \\mathfrak{so}(2)$, the momentum map $J(q)(v)$ is identified with the scalar value in $\\mathfrak{so}(2)^* \\cong \\mathbb{R}$:\n$$ J(q)(v) = (I_b + I_r)\\dot{\\theta} + I_r\\dot{\\alpha} $$\nThis value represents the total angular momentum of the system.\n\n4.  **Computation of the mechanical connection $A(q)$**\n\nThe mechanical connection $A(q): T_qQ \\to \\mathfrak{so}(2)$ is implicitly defined by the equation $\\mathbb{I}(q)A(q)(v) = J(q)(v)$. Since we are working with identifications to $\\mathbb{R}$, this is an algebraic equation for the scalar value of $A(q)(v)$. We substitute our expressions for $\\mathbb{I}(q)$ and $J(q)(v)$:\n$$ (I_b + I_r) A(q)(\\dot{\\theta}, \\dot{\\alpha}) = (I_b + I_r)\\dot{\\theta} + I_r\\dot{\\alpha} $$\nSolving for $A(q)(\\dot{\\theta}, \\dot{\\alpha})$ by dividing by the strictly positive locked inertia $\\mathbb{I}(q) = I_b + I_r$:\n$$ A(q)(\\dot{\\theta}, \\dot{\\alpha}) = \\frac{(I_b + I_r)\\dot{\\theta} + I_r\\dot{\\alpha}}{I_b + I_r} $$\nSimplifying the expression gives the final result for the mechanical connection:\n$$ A(q)(\\dot{\\theta}, \\dot{\\alpha}) = \\dot{\\theta} + \\frac{I_r}{I_b + I_r}\\dot{\\alpha} $$\nThis is the explicit coordinate expression for the mechanical connection evaluated on a tangent vector $v = (\\dot{\\theta}, \\dot{\\alpha})$.",
            "answer": "$$ \\boxed{\\dot{\\theta} + \\frac{I_r}{I_b + I_r}\\dot{\\alpha}} $$"
        },
        {
            "introduction": "The theoretical framework of connections finds its ultimate purpose in predicting and controlling locomotion. With a connection defined, one can integrate the kinematic reconstruction equation to determine the net displacement and reorientation resulting from a given sequence of shape changes. This computational exercise bridges theory and application by asking you to implement a numerical integrator on the Lie group $\\mathrm{SE}(2)$, allowing you to simulate the trajectory of a nonholonomic system and directly observe how cyclic shape changes can produce net motion. ",
            "id": "3766072",
            "problem": "Consider a nonholonomic mechanical system modeled on a trivial principal fiber bundle $Q = G \\times S$, where $G = \\mathrm{SE}(2)$ is the special Euclidean group of rigid motions in the plane and $S = \\mathbb{R}^2$ is the shape space. Let $g(t) \\in G$ denote the group configuration and $s(t) \\in S$ denote the shape trajectory. A kinematic reconstruction law expresses the body velocity as a function of shape velocity via a principal connection $A$, understood here as a Lie algebra-valued one-form on $S$ so that the body velocity is given by $g^{-1}\\dot{g} = \\xi(t) = A(s(t)) \\dot{s}(t)$, where $\\xi(t) \\in \\mathfrak{se}(2)$.\n\nIn this problem, you will work with a specific, analytically defined, shape-dependent connection with tunable curvature magnitude. Define the connection via its components $A_1(s)$ and $A_2(s)$ associated with the shape velocity components $\\dot{s}_1$ and $\\dot{s}_2$:\n$$\nA_1(s) = \\begin{bmatrix} \\kappa\\, s_2 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\qquad\nA_2(s) = \\begin{bmatrix} -\\kappa\\, s_1 \\\\ 0 \\\\ 0 \\end{bmatrix},\n$$\nso that the body twist is\n$$\n\\xi(t) = \\begin{bmatrix} \\omega(t) \\\\ v_x(t) \\\\ v_y(t) \\end{bmatrix}\n= A_1(s(t))\\, \\dot{s}_1(t) + A_2(s(t))\\, \\dot{s}_2(t)\n= \\begin{bmatrix} \\kappa\\left(s_2(t)\\, \\dot{s}_1(t) - s_1(t)\\, \\dot{s}_2(t)\\right) \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\nHere, $\\kappa \\in \\mathbb{R}$ is a scalar parameter controlling the curvature magnitude. The curvature two-form $F$ of this connection on shape space, computed as $F = \\partial_1 A_2 - \\partial_2 A_1 + [A_1, A_2]$, has constant magnitude proportional to $\\kappa$; specifically, its only nonzero component is the angular part $F_{12}^\\omega = -2\\kappa$, resulting in curvature magnitude $\\|F\\| = 2|\\kappa|$ under the Euclidean norm on the Lie algebra components.\n\nGiven a shape trajectory $s(t)$ and its derivative $\\dot{s}(t)$ on a fixed time interval $[0,T]$ with $T = 1$, define\n$$\ns_1(t) = \\cos\\left(2\\pi t\\right) + 0.3\\, \\cos\\left(6\\pi t\\right), \\qquad\ns_2(t) = \\sin\\left(4\\pi t\\right),\n$$\nand\n$$\n\\dot{s}_1(t) = -2\\pi\\, \\sin\\left(2\\pi t\\right) - 1.8\\pi\\, \\sin\\left(6\\pi t\\right), \\qquad\n\\dot{s}_2(t) = 4\\pi\\, \\cos\\left(4\\pi t\\right).\n$$\nYou must reconstruct the group trajectory $g(t)$ numerically from sampled shape velocities using a discretized connection and a Lie group integrator based on the matrix exponential. Specifically, discretize the interval $[0,T]$ into $N$ uniform steps of size $\\Delta t = T/N$, sample the shape and shape velocity at the left endpoints $t_k = k\\, \\Delta t$, compute the body twist $\\xi_k = \\xi(t_k)$, and update the group element using the first-order Lie group method\n$$\ng_{k+1} = g_k \\, \\exp\\left(\\Delta t\\, \\hat{\\xi}_k\\right),\n$$\nwhere $\\hat{\\xi}_k \\in \\mathfrak{se}(2)$ is the matrix representation of the body twist and $\\exp$ is the matrix exponential. In this specific connection, the translation components are zero, so the reconstruction reduces to planar rotations, but you must still implement the update on $G = \\mathrm{SE}(2)$ as homogeneous transformations. All internal angle computations must use radians.\n\nFor a reference solution $g_{\\mathrm{ref}}(T)$, use the same reconstruction method with a very fine discretization $N_{\\mathrm{ref}} = 50000$ to approximate the continuous-time solution. Define the error between a reconstructed terminal group element $g_N(T)$ and the reference as the Frobenius norm of the difference of their homogeneous transformation matrices,\n$$\n\\mathcal{E} = \\left\\| g_N(T) - g_{\\mathrm{ref}}(T) \\right\\|_F,\n$$\nwhich is dimensionless.\n\nYour task is to:\n- Implement the described reconstruction scheme.\n- For a set of parameter values $(\\kappa, N)$, compute the terminal errors $\\mathcal{E}$ against the reference solution.\n- Evaluate how the error converges as $N$ increases and how it scales with the curvature magnitude controlled by $\\kappa$.\n\nUse the following test suite:\n- Curvature parameters: $\\kappa \\in \\{0, 0.5, 1.0\\}$.\n- Time steps: $N \\in \\{50, 200, 800\\}$.\nCombine them in lexicographic order by $\\kappa$ and then by $N$, resulting in $9$ test cases:\n$$\n(\\kappa,N) \\in \\{(0,50),(0,200),(0,800),(0.5,50),(0.5,200),(0.5,800),(1.0,50),(1.0,200),(1.0,800)\\}.\n$$\n\nYour program should produce a single line of output containing the terminal errors for all test cases as a comma-separated list enclosed in square brackets (e.g., $[e_1,e_2,\\dots,e_9]$). Each $e_i$ must be a floating-point number. The program must be completely self-contained, require no input, and must not print any additional text beyond the specified output line.",
            "solution": "The problem is well-posed and scientifically grounded in the field of geometric mechanics and numerical integration on Lie groups. It provides a complete and consistent set of definitions, equations, and parameters to perform the requested numerical experiment. All data are explicit, and the task is a standard exercise in computational geometric control theory. Therefore, the problem is valid, and a solution will be provided.\n\nThe problem requires the numerical reconstruction of a trajectory on the special Euclidean group $\\mathrm{SE}(2)$ based on a prescribed path in a \"shape space\" $S = \\mathbb{R}^2$. The relationship between the shape velocity $\\dot{s}(t)$ and the body velocity $\\xi(t)$ is defined by a kinematic connection $A(s)$.\n\nFirst, we formalize the components of the system. The configuration space is $Q = G \\times S$, where the Lie group is $G = \\mathrm{SE}(2)$ and the shape space is $S = \\mathbb{R}^2$. An element $g \\in \\mathrm{SE}(2)$ is represented by a $3 \\times 3$ homogeneous transformation matrix:\n$$\ng = \\begin{bmatrix} R(\\theta) & p \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} \\cos\\theta & -\\sin\\theta & x \\\\ \\sin\\theta & \\cos\\theta & y \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\nwhere $R(\\theta) \\in \\mathrm{SO}(2)$ is a rotation matrix and $p \\in \\mathbb{R}^2$ is a translation vector.\n\nThe body velocity, or twist, $\\xi(t) = g(t)^{-1}\\dot{g}(t)$, lies in the Lie algebra $\\mathfrak{se}(2)$. A twist $\\xi = (\\omega, v_x, v_y)^T$ has the matrix representation $\\hat{\\xi} \\in \\mathfrak{se}(2)$:\n$$\n\\hat{\\xi} = \\begin{bmatrix} 0 & -\\omega & v_x \\\\ \\omega & 0 & v_y \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\nThe reconstruction law is given by $\\xi(t) = A(s(t))\\dot{s}(t)$. With the provided connection components $A_1(s)$ and $A_2(s)$, the twist is calculated as:\n$$\n\\xi(t) = A_1(s(t))\\dot{s}_1(t) + A_2(s(t))\\dot{s}_2(t) = \\begin{bmatrix} \\kappa\\, s_2(t) \\\\ 0 \\\\ 0 \\end{bmatrix} \\dot{s}_1(t) + \\begin{bmatrix} -\\kappa\\, s_1(t) \\\\ 0 \\\\ 0 \\end{bmatrix} \\dot{s}_2(t)\n$$\nThis simplifies to:\n$$\n\\xi(t) = \\begin{bmatrix} \\omega(t) \\\\ v_x(t) \\\\ v_y(t) \\end{bmatrix} = \\begin{bmatrix} \\kappa (s_2(t)\\dot{s}_1(t) - s_1(t)\\dot{s}_2(t)) \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\nFor this specific connection, the translational components of the body velocity are always zero ($v_x = v_y = 0$). The system's motion is purely rotational about its own origin. The corresponding Lie algebra matrix is:\n$$\n\\hat{\\xi}(t) = \\begin{bmatrix} 0 & -\\omega(t) & 0 \\\\ \\omega(t) & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\nwhere the angular velocity $\\omega(t)$ is determined by the shape trajectory $s(t) = (s_1(t), s_2(t))^T$ and its velocity $\\dot{s}(t) = (\\dot{s}_1(t), \\dot{s}_2(t))^T$ as defined in the problem.\n\nThe problem requires numerical integration using a first-order Lie group method. The time interval $[0, T]$ with $T=1$ is discretized into $N$ steps of size $\\Delta t = T/N = 1/N$. The group element $g_k$ at time $t_k = k \\Delta t$ is updated to $g_{k+1}$ using the rule:\n$$\ng_{k+1} = g_k \\exp(\\Delta t \\hat{\\xi}_k)\n$$\nwhere $\\hat{\\xi}_k$ is the matrix representation of the twist $\\xi(t_k)$ evaluated at the beginning of the time step. We assume the initial condition is the identity element, $g_0 = I$. The term $\\exp(\\Delta t \\hat{\\xi}_k)$ is the matrix exponential. For our purely rotational twist, let $\\Delta \\theta_k = \\omega(t_k)\\Delta t$. The matrix to be exponentiated is:\n$$\n\\Delta t \\hat{\\xi}_k = \\begin{bmatrix} 0 & -\\Delta \\theta_k & 0 \\\\ \\Delta \\theta_k & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\nThe exponential of this matrix can be computed analytically using the Rodrigues formula for $\\mathrm{SO}(2)$, which yields:\n$$\n\\exp(\\Delta t \\hat{\\xi}_k) = \\begin{bmatrix} \\cos(\\Delta \\theta_k) & -\\sin(\\Delta \\theta_k) & 0 \\\\ \\sin(\\Delta \\theta_k) & \\cos(\\Delta \\theta_k) & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\nThis matrix represents the incremental group motion over the time step $\\Delta t$. The trajectory is reconstructed by repeated right-multiplication of these incremental motions onto the current group configuration.\n\nThe overall algorithm is as follows:\n1.  Define a function `reconstruct_trajectory(kappa, N)` that implements the numerical integration. This function takes the curvature parameter $\\kappa$ and the number of steps $N$ as input.\n2.  Inside this function, set $T=1$, calculate $\\Delta t = T/N$, and generate an array of time points $t_k = k\\Delta t$ for $k = 0, 1, \\dots, N-1$.\n3.  Initialize the group element $g$ to the $3 \\times 3$ identity matrix.\n4.  Loop through each time step $k$:\n    a. Evaluate $s_1(t_k)$, $s_2(t_k)$, $\\dot{s}_1(t_k)$, and $\\dot{s}_2(t_k)$ using the provided functions.\n    b. Compute the angular velocity $\\omega_k = \\kappa (s_2(t_k)\\dot{s}_1(t_k) - s_1(t_k)\\dot{s}_2(t_k))$.\n    c. Calculate the incremental angle $\\Delta \\theta_k = \\omega_k \\Delta t$.\n    d. Construct the incremental transformation matrix $\\Delta g_k = \\exp(\\Delta t \\hat{\\xi}_k)$ as derived above.\n    e. Update the group element: $g \\leftarrow g @ \\Delta g_k$.\n5.  After the loop, return the final group element $g_N(T)$.\n6.  For each unique value of $\\kappa$ in the test suite ($\\kappa \\in \\{0, 0.5, 1.0\\}$), compute a high-fidelity reference solution $g_{\\mathrm{ref}}(T)$ using $N_{\\mathrm{ref}} = 50000$.\n7.  For each test case $(\\kappa, N)$, compute the approximate solution $g_N(T)$.\n8.  Calculate the error $\\mathcal{E} = \\|g_N(T) - g_{\\mathrm{ref}}(T)\\|_F$, where $\\|\\cdot\\|_F$ is the Frobenius norm.\n9.  Collect all $9$ error values in the specified order and format the output.\n\nFor the special case $\\kappa=0$, the angular velocity $\\omega(t)$ is identically zero for all $t$. Thus, $\\Delta \\theta_k = 0$, and the incremental transformation $\\exp(\\Delta t \\hat{\\xi}_k)$ is the identity matrix. The final group element $g_N(T)$ will be the identity matrix for any $N$. The error $\\mathcal{E}$ for $\\kappa=0$ should therefore be zero, up to floating-point precision errors.\n\nFor $\\kappa > 0$, the first-order Euler method will have a global error that is expected to be first order in $\\Delta t$, i.e., $\\mathcal{E} \\propto \\Delta t \\propto 1/N$. The magnitude of the error is also expected to scale with the curvature parameter $\\kappa$, as $\\kappa$ directly scales the quantity being integrated, $\\omega(t)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of reconstructing a Lie group trajectory and calculating numerical errors.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 50),\n        (0.0, 200),\n        (0.0, 800),\n        (0.5, 50),\n        (0.5, 200),\n        (0.5, 800),\n        (1.0, 50),\n        (1.0, 200),\n        (1.0, 800),\n    ]\n\n    N_ref = 50000\n    T = 1.0\n\n    # Define shape trajectory and its derivatives\n    def s1(t):\n        return np.cos(2 * np.pi * t) + 0.3 * np.cos(6 * np.pi * t)\n\n    def s2(t):\n        return np.sin(4 * np.pi * t)\n\n    def s1_dot(t):\n        return -2 * np.pi * np.sin(2 * np.pi * t) - 1.8 * np.pi * np.sin(6 * np.pi * t)\n\n    def s2_dot(t):\n        return 4 * np.pi * np.cos(4 * np.pi * t)\n\n    def reconstruct_trajectory(kappa, N):\n        \"\"\"\n        Numerically reconstructs the group trajectory g(t) on SE(2).\n\n        Args:\n            kappa (float): The curvature parameter.\n            N (int): The number of time steps.\n\n        Returns:\n            np.ndarray: The final 3x3 homogeneous transformation matrix g(T).\n        \"\"\"\n        dt = T / N\n        g = np.identity(3)\n        t_values = np.arange(N) * dt\n\n        # Vectorized evaluation for efficiency\n        s1_vals = s1(t_values)\n        s2_vals = s2(t_values)\n        s1_dot_vals = s1_dot(t_values)\n        s2_dot_vals = s2_dot(t_values)\n\n        omega_vals = kappa * (s2_vals * s1_dot_vals - s1_vals * s2_dot_vals)\n        delta_theta_vals = omega_vals * dt\n\n        cos_vals = np.cos(delta_theta_vals)\n        sin_vals = np.sin(delta_theta_vals)\n\n        for k in range(N):\n            delta_g = np.array([\n                [cos_vals[k], -sin_vals[k], 0],\n                [sin_vals[k],  cos_vals[k], 0],\n                [0,            0,           1]\n            ])\n            # Right multiplication for body-frame update\n            g = g @ delta_g\n        \n        return g\n\n    results = []\n    ref_solutions = {}\n\n    for kappa, N in test_cases:\n        # Compute and cache reference solution for each kappa\n        if kappa not in ref_solutions:\n            g_ref = reconstruct_trajectory(kappa, N_ref)\n            ref_solutions[kappa] = g_ref\n        \n        g_ref_T = ref_solutions[kappa]\n        \n        # Compute solution for the current test case N\n        g_N_T = reconstruct_trajectory(kappa, N)\n        \n        # Calculate the Frobenius norm error\n        error = np.linalg.norm(g_N_T - g_ref_T, 'fro')\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}