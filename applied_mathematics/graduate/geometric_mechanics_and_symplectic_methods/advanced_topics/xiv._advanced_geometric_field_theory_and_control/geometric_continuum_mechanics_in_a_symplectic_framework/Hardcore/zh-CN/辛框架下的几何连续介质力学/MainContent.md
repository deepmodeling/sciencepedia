## 引言
经典[连续介质力学](@entry_id:155125)，无论是描述流体的[欧拉方程](@entry_id:177914)还是固体的[弹性动力学](@entry_id:175818)，传统上都以[偏微分方程组](@entry_id:172573)的形式呈现。尽管这种方法在工程和物理学中取得了巨大成功，但它往往掩盖了不同物理系统背后共通的深层结构。本文旨在超越这一传统视角，将连续介质力学置于现代[微分几何](@entry_id:145818)的强大框架——特别是辛几何和李群理论——之中进行重构。这种几何方法不仅为经典理论提供了优雅的统一视角，更揭示了守恒律的起源，并为分析稳定性和开发先进的数值方法提供了系统性的工具。

本文旨在填补传统表述与几何方法之间的知识鸿沟，向读者展示如何从第一性原理出发，系统地构建连续介质的哈密顿理论。我们将探索这一框架的内在逻辑和强大威力，从理论基础到实际应用，逐层深入。

在第一章“原理和机制”中，我们将奠定理论基础，学习如何为连续介质构建无穷维哈密顿相空间，并理解其上的典范辛结构。核心内容将聚焦于对称性的作用，展示如何通过欧拉-庞加莱和李-[泊松约化](@entry_id:1129891)，将复杂的动力学系统简化，从而导出[理想流体](@entry_id:1126341)等系统的核心方程。

随后的第二章“应用与跨学科连接”将展示该理论的丰硕成果。我们将探讨该框架如何解释涡量和环量等经典守恒律，如何启发能够进行长期稳定模拟的[几何积分算法](@entry_id:138085)，以及它如何连接起等离子体物理、计算海洋学和材料科学等看似无关的领域。

最后，在第三章“动手实践”中，读者将有机会通过一系列精心设计的练习，亲手应用前两章学到的概念，加深对[质量守恒](@entry_id:204015)的几何推导、[辛结构](@entry_id:1132759)的构建以及协变[哈密顿表述](@entry_id:276227)等核心问题的理解。

现在，让我们从构建连续介质力学的几何基石开始，深入探索其基本原理与内在机制。

## 原理和机制

在引言中，我们概述了将经典连续介质力学重构为几何框架的目标。本章将深入探讨这一框架的基本原理和机制。我们将从为一般连续体构建哈密顿相空间开始，然后专门讨论那些具有对称性的系统，特别是[理想流体](@entry_id:1126341)。这些对称性允许进行一种称为“约化”的强大简化，从而揭示出熟悉的物理定律背后深刻的几何结构，并提供用于分析守恒律和稳定性的新工具。

### 连续介质的哈密顿相空间

在有限维经典力学中，系统的相空间是其位形空间$Q$的余切丛$T^*Q$。这是一个[辛流形](@entry_id:161608)，其上的几何结构决定了动力学。对于连续介质，我们遵循相同的路径，但位形空间$Q$和相空间$T^*Q$现在是[无穷维流形](@entry_id:159264)。

#### 位形空间与余切丛

[连续系统](@entry_id:178397)的**位形 (configuration)** 是描述其在空间中状态的场。因此，**位形空间 (configuration space)** $Q$ 是所有可能位形组成的[无穷维流形](@entry_id:159264)。

- 对于在参考流形$M$上取值为$\mathbb{R}^d$的场，[位形空间](@entry_id:149531)可以是索伯列夫希尔伯特流形$Q = H^s(M, \mathbb{R}^d)$，其中$s$是一个足够大的数，以确保场的必要[光滑性](@entry_id:634843) 。
- 对于弹性体，位形是参考体$X$到物理空间$M$中的一个嵌入。因此，位形空间是[嵌入空间](@entry_id:637157) $Q = \mathrm{Emb}(X, M)$ 。

系统的**相空间 (phase space)** 是位形空间的**[余切丛](@entry_id:185138) (cotangent bundle)** $P = T^*Q$。[余切丛](@entry_id:185138)中的一个点表示为一对$(q, p)$，其中$q \in Q$是系统的位形，而$p \in T_q^*Q$是与该位形共轭的**动量 (momentum)**。在场论中，$p$通常是一个**[动量密度](@entry_id:271360) (momentum density)**，它通过在空间上积分来作用于[切向量](@entry_id:265494)（位形的变化 $\delta q \in T_qQ$）。这种作用，即配对关系，定义为：
$$
\langle p, \delta q \rangle = \int_M p(x) \cdot \delta q(x) \, dV
$$
其中$dV$是$M$上的[体积元](@entry_id:267802)。

#### 典范[辛结构](@entry_id:1132759)

任何[余切丛](@entry_id:185138)$T^*Q$都天生具有一种称为**典范辛结构 (canonical symplectic structure)** 的几何结构。该结构由一个闭合的、非退化的[2-形式](@entry_id:188008)$\Omega$定义，它控制着哈密顿动力学。这个[辛形式](@entry_id:165896)本身是从一个更基本的对象——**[典范1-形式](@entry_id:1132867) (canonical 1-form)** 或**[重言1-形式](@entry_id:1132867) (tautological 1-form)** $\Theta$——导出的。

在点$(q,p) \in T^*Q$，[典范1-形式](@entry_id:1132867)$\Theta$作用于$T_{(q,p)}(T^*Q)$中的[切向量](@entry_id:265494)$(\delta q, \delta p)$，其定义为动量$p$作用于位形变化$\delta q$：
$$
\Theta_{(q,p)}(\delta q, \delta p) = \langle p, \delta q \rangle
$$
在场论的背景下，这表示为一个积分 ：
$$
\Theta_{(q,p)}(\delta q, \delta p) = \int_M p(x) \cdot \delta q(x) \, \mu(x)
$$
其中$\mu(x)$是[体积形式](@entry_id:203000)。

**典范辛[2-形式](@entry_id:188008) (canonical symplectic 2-form)** $\Omega$ 定义为$\Theta$的负[外微分](@entry_id:161900)，即$\Omega = -d\Theta$。对于$T_{(q,p)}(T^*Q)$中的两个[切向量](@entry_id:265494)$v_1 = (\delta q_1, \delta p_1)$和$v_2 = (\delta q_2, \delta p_2)$，[辛形式](@entry_id:165896)的作用可以通过计算$d\Theta$得出：
$$
\Omega_{(q,p)}(v_1, v_2) = \langle \delta p_2, \delta q_1 \rangle - \langle \delta p_1, \delta q_2 \rangle
$$
写成积分形式则为  ：
$$
\Omega_{(q,p)}(v_1, v_2) = \int_M \left( \delta q_1(x) \cdot \delta p_2(x) - \delta q_2(x) \cdot \delta p_1(x) \right) \, \mu(x)
$$
这个[2-形式](@entry_id:188008)具有两个关键性质：

1.  **[闭合性](@entry_id:1122501) (Closure)**：由于外微分的基本性质$d^2=0$，辛形式$\Omega$是自动闭合的：$d\Omega = -d(d\Theta) = -d^2\Theta = 0$。这个性质在[无穷维流形](@entry_id:159264)的适当微积分框架下依然成立。

2.  **非退化性 (Non-degeneracy)**：非退化性意味着，如果一个向量$v$与所有其他向量$w$的辛配对$\Omega(v, w)$都为零，那么$v$必定是[零向量](@entry_id:156189)。在无穷维中，这需要区分两种情况 ：
    *   **弱辛形式 (Weak Symplectic Form)**：映射$v \mapsto \Omega(v, \cdot)$是[单射](@entry_id:183792)的。如上所示的典范形式总是弱非退化的。
    *   **强[辛形式](@entry_id:165896) (Strong Symplectic Form)**：上述映射是一个从切空间到其连续[对偶空间](@entry_id:146945)的[拓扑同构](@entry_id:263643)。这在无穷维中是一个更强的条件。

    一个关键的函数分析结果是，$\Omega$是否为强形式取决于[位形空间](@entry_id:149531)$Q$的[模型空间](@entry_id:635763)$E$的性质。
    - 如果$Q$是一个巴拿赫流形（例如，基于[索伯列夫空间](@entry_id:141995)$H^s$），且其模型[巴拿赫空间](@entry_id:143833)$E$是**自反的 (reflexive)**（即[典范嵌入](@entry_id:267644)$E \to E^{**}$是一个同构），则[典范辛形式](@entry_id:180641)是强的。所有希尔伯特空间都是自反的，因此对于基于索伯列夫希尔伯特空间的[位形空间](@entry_id:149531)，我们得到一个强[辛结构](@entry_id:1132759)  。
    - 如果$Q$是一个弗雷歇流形（例如，[光滑嵌入](@entry_id:637480)空间$\mathrm{Emb}(B, \mathbb{R}^n)$，其模型是光滑函数空间$C^\infty$），那么即使在“驯顺”弗雷歇流形和便利微积分的现代框架下，典范形式通常也只是弱[辛形式](@entry_id:165896)。这是因为从[切空间](@entry_id:199137)到其[对偶空间](@entry_id:146945)的映射通常不是一个[拓扑同构](@entry_id:263643) 。

### 拉格朗日和[哈密顿表述](@entry_id:276227)

有了相空间及其辛结构，我们现在可以描述动力学。这可以通过拉格朗日或哈密顿两种等价的途径来实现。

#### 从拉格朗日量到哈密顿量：[勒让德变换](@entry_id:142214)

系统的动力学可以由一个**拉格朗日量 (Lagrangian)** $L$描述，它是总动能$T$和总势能$V$之差，$L=T-V$。对于[场论](@entry_id:155241)，我们通常使用**拉格朗日密度 (Lagrangian density)** $\mathcal{L}$，其在参考体积上的积分给出[总拉格朗日量](@entry_id:756063)。

以[超弹性](@entry_id:159356)体为例，其拉格朗日密度为 ：
$$
\mathcal{L}(\varphi, v, F) = \frac{1}{2} \rho_0 g(v, v) - W(F)
$$
其中第一项是动能密度（$\rho_0$是参考质量密度，$v$是速度场，$g$是空间中的[黎曼度量](@entry_id:754359)），第二项$W(F)$是依赖于[形变梯度](@entry_id:163749)$F$的**储存能量函数 (stored energy function)** 或[应变能密度](@entry_id:200085)。

从[拉格朗日表述](@entry_id:188652)到[哈密顿表述](@entry_id:276227)的转换通过**[勒让德变换](@entry_id:142214) (Legendre transform)** 实现。首先，我们定义共轭于速度$v$的[动量密度](@entry_id:271360)$P$：
$$
P = \frac{\partial \mathcal{L}}{\partial v}
$$
对于上述的拉格朗日密度，[动量密度](@entry_id:271360)为$P = \rho_0 v^\flat$，其中$^\flat$是通过度量$g$将向量$v$转换为[余向量](@entry_id:157727)（[1-形式](@entry_id:270392)）的[音乐同构](@entry_id:199976)。

然后，**哈密顿密度 (Hamiltonian density)** $\mathcal{H}$定义为：
$$
\mathcal{H}(P, F) = \langle P, v \rangle - \mathcal{L}(v, F)
$$
我们需要将上式中的$v$用$P$表示。从$P = \rho_0 v^\flat$可以解出$v = \frac{1}{\rho_0} P^\sharp$，其中$^\sharp$是逆[音乐同构](@entry_id:199976)。代入后，我们得到 ：
$$
\mathcal{H}(P, F) = \frac{1}{2\rho_0} g^{-1}(P, P) + W(F)
$$
这正是在物理上所期望的结果：哈密顿量是动能和势能之和，$\mathcal{H} = T + V$，但动能现在是动量$P$的函数。系统的总能量（[哈密顿量](@entry_id:144286)）在动力学演化过程中是守恒的。

#### 动量与应力：连接抽象与具体

在几何框架中，动量$p$是一个抽象的[余向量](@entry_id:157727)。对于具体的物理系统，它与我们熟悉的量（如应力）密切相关。它们之间的联系可以通过[虚功原理](@entry_id:1133834)或更形式化的[功共轭](@entry_id:194957)关系来建立。

对于弹性体，有两个重要的应力张量是在参考构形下定义的，它们自然地出现在[哈密顿表述](@entry_id:276227)中 ：

1.  **[第一皮奥拉-基尔霍夫应力](@entry_id:163971)张量 (First Piola-Kirchhoff stress tensor)** $P$：它将参考构形中的法向量$N$映射到当前构形中的真实牵[引力](@entry_id:189550)。它与柯西[应力张量](@entry_id:148973)$\sigma$（在当前构形中定义）的关系由下式给出：
    $$
    P = J \sigma F^{-T}
    $$
    其中$F$是[形变梯度](@entry_id:163749)，$J = \det F$是其雅可比行列式。$P$和[形变梯度](@entry_id:163749)的速率$\dot{F}$是[功共轭](@entry_id:194957)的，意味着内功率密度可以写作$P : \dot{F}$。

2.  **[第二皮奥拉-基尔霍夫应力](@entry_id:173163)张量 (Second Piola-Kirchhoff stress tensor)** $S$：这是一个完全在参考构形下定义的[对称张量](@entry_id:148092)。它与[第一皮奥拉-基尔霍夫应力](@entry_id:163971)张量$P$的关系是$P = FS$，或等价地，$S = F^{-1}P$。$S$与[格林-拉格朗日应变张量](@entry_id:187745)$E = \frac{1}{2}(F^T F - I)$的速率$\dot{E}$是[功共轭](@entry_id:194957)的，即内功率密度也可以写作$S : \dot{E}$。如果柯西应力$\sigma$是对称的，那么$S$也总是对称的，而$P$通常不是。

[功共轭](@entry_id:194957)关系$P : \dot{F} = S : \dot{E}$是典范[辛结构](@entry_id:1132759)在物理层面的体现。它确保了在不同坐标系（或变量）下计算的[虚功](@entry_id:176403)率保持不变，这正是辛几何中[典范变换](@entry_id:178165)的核心性质。

### 对称性与约化：欧拉-庞加莱和李-泊松框架

许多重要的连续介质系统，如[理想流体](@entry_id:1126341)，其位形空间$Q$本身就是一个李群$G$。这种额外的代数结构导致了深刻的简化，称为**约化 (reduction)**。

#### [李群](@entry_id:137659)位形空间和[欧拉-庞加莱约化](@entry_id:1124673)

理想流体可以被看作是其自身所在流形$M$的自微分同胚。因此，其[位形空间](@entry_id:149531)是[微分同胚群](@entry_id:1123671)$Q = \mathrm{Diff}(M)$。这是一个无穷维[李群](@entry_id:137659)。系统的运动路径是一条曲线$\varphi(t) \in \mathrm{Diff}(M)$，称为**拉格朗日流映射 (Lagrangian flow map)**。

在[李群](@entry_id:137659)$G$上，[切丛](@entry_id:161294)$TG$可以被平凡化。一个切向量$\dot{g} \in T_gG$可以通过左乘或右乘$g^{-1}$映射到李代数$\mathfrak{g} = T_eG$（$e$是群的单位元）中。对于流体，我们通常使用右平移将拉格朗日速度$\dot{\varphi}(t)$（固定[质点](@entry_id:186768)的时间导数）映射到李代数$\mathfrak{g} = \mathfrak{X}(M)$（$M$上的向量场空间）中。这个映射定义了**欧拉速度场 (Eulerian velocity field)** $u(t)$ ：
$$
u(t) = \dot{\varphi}(t) \circ \varphi(t)^{-1}
$$
如果拉格朗日量$L$在$G$的左作用（或右作用）下不变，那么它可以在[李代数](@entry_id:137954)$\mathfrak{g}$上定义一个**约化拉格朗日量 (reduced Lagrangian)** $\ell(u)$。例如，理想流体的动能$L(\varphi, \dot{\varphi}) = \frac{1}{2}\int_M g(\dot{\varphi}, \dot{\varphi}) dV$是右不变的（在粒子重标签下不变），其约化形式是关于欧拉速度$u$的动能$\ell(u) = \frac{1}{2}\int_M g(u, u) dV$。

庞加莱发现，对于不变的[拉格朗日量](@entry_id:174593)，群$G$上的[哈密顿原理](@entry_id:175601)可以被约化为李代数$\mathfrak{g}$上的一个变分原理，现在称为**欧拉-庞加莱 (Euler-Poincaré) 原理** 。其核心思想是，群$G$上的任意变分$\delta g$诱导了李代数$\mathfrak{g}$上一种特殊的**约束变分 (constrained variation)**。如果令$\eta = g^{-1}\delta g \in \mathfrak{g}$，则$u = g^{-1}\dot{g}$的变分为：
$$
\delta u = \frac{\partial \eta}{\partial t} + [u, \eta]
$$
其中$[\cdot, \cdot]$是李代数$\mathfrak{g}$上的李括号。将这个约束变分代入约化作用量$\int \ell(u) dt$的变分中，通过[分部积分](@entry_id:136350)和利用伴随与余[伴随算子](@entry_id:140236)，我们得到**[欧拉-庞加莱方程](@entry_id:1124672)** ：
$$
\frac{d}{dt} \frac{\delta \ell}{\delta u} = \mathrm{ad}^*_u \left( \frac{\delta \ell}{\delta u} \right)
$$
其中$\frac{\delta \ell}{\delta u}$是$\ell$关于$u$的泛函导数，它取值于[李代数的对偶](@entry_id:1124028)空间$\mathfrak{g}^*$。$\mathrm{ad}^*$是**余伴随表示 (coadjoint representation)**，其定义为$\langle \mathrm{ad}^*_u m, \eta \rangle = \langle m, [u, \eta] \rangle$。

#### 李-[泊松约化](@entry_id:1129891)

[欧拉-庞加莱方程](@entry_id:1124672)是拉格朗日方面的约化。在哈密顿方面，相应地存在**李-泊松 (Lie-Poisson) 约化**。$G$作用在$T^*G$上的辛对称性通过诺特定理产生一个守恒的动量映射。[辛约化](@entry_id:170200)理论表明，动力学可以从$T^*G$约化到[李代数的对偶](@entry_id:1124028)空间$\mathfrak{g}^*$上。

这个约化空间$\mathfrak{g}^*$不再是一个[辛流形](@entry_id:161608)，而是一个**泊松流形 (Poisson manifold)**。其上的**[李-泊松括号](@entry_id:159190) (Lie-Poisson bracket)** 对于任意两个泛函$F, H: \mathfrak{g}^* \to \mathbb{R}$定义为：
$$
\{F, H\}(m) = \left\langle m, \left[ \frac{\delta F}{\delta m}, \frac{\delta H}{\delta m} \right] \right\rangle
$$
其中$m \in \mathfrak{g}^*$是动量变量。系统的哈密顿动力学由这个括号给出：$\frac{dF}{dt} = \{F, H\}$。当我们将动量变量$m$本身代入时，其[运动方程](@entry_id:264286)为：
$$
\frac{dm}{dt} = - \mathrm{ad}^*_{\frac{\delta H}{\delta m}} m
$$
这正是[欧拉-庞加莱方程](@entry_id:1124672)的哈密顿形式，其中$u = \frac{\delta H}{\delta m}$。因此，欧拉-庞加莱和李-[泊松约化](@entry_id:1129891)是同一枚硬币的两面 。

### 几何结构的物理推论

这个几何框架不仅优雅，而且极其强大。它揭示了许多物理现象的深刻起源，并提供了分析它们的工具。

#### 理想流体作为[测地流](@entry_id:270369)

阿诺德 (V. Arnold) 的一个惊人发现是，理想不可压缩流体的运动可以被看作是其位形空间——保体积[微分同胚群](@entry_id:1123671)$\mathrm{Diff}_{\mathrm{vol}}(M)$——上的一个[测地流](@entry_id:270369)动 。

在这个群上，我们可以定义一个**右不变$L^2$度量**，它在单位元（李代数$\mathfrak{X}_{\mathrm{div}}(M)$）处由流体动能给出：
$$
\langle u, v \rangle = \int_M g(u, v) \, \mathrm{dvol}
$$
关于这个度量的[测地线方程](@entry_id:264349)，当写成[李代数](@entry_id:137954)中的[欧拉-庞加莱方程](@entry_id:1124672)形式时，与不[可压缩欧拉方程](@entry_id:747588)完全吻合。因此，流体质点的复杂轨迹，从几何上看，只是无限维[李群](@entry_id:137659)空间中最短的路径。

#### 涡量、环量和守恒律

流体动力学中的关键概念及其守恒律在几何框架中得到了优美的解释。

- **涡量 (Vorticity)**：在三维空间中，涡量$\boldsymbol{\omega} = \nabla \times u$。在微分形式的语言中，我们定义动量1-形式$m=u^\flat$和**涡量[2-形式](@entry_id:188008)** $\Omega = dm$。不[可压缩欧拉方程](@entry_id:747588)可以被转化为[涡量](@entry_id:142747)$\Omega$的[演化方程](@entry_id:268137) ：
  $$
  \frac{\partial \Omega}{\partial t} + \mathcal{L}_u \Omega = 0
  $$
  其中$\mathcal{L}_u$是沿速度场$u$的[李导数](@entry_id:171745)。这个方程意味着涡量2-形式被流体“冻结”并随之输运。这个演化过程正是动量在$\mathfrak{g}^*$上的**余伴随运动 (coadjoint motion)** 的体现。
  - 在二维情况下，$\Omega = \zeta \mu$（其中$\zeta$是标量涡量，$\mu$是面积形式），该方程约化为纯平流方程：$\partial_t\zeta + u\cdot\nabla\zeta=0$。
  - 在三维情况下，它对应于包含著名的**[涡旋拉伸](@entry_id:271418)项 (vortex stretching term)** 的向量涡量方程：$\partial_t\boldsymbol{\omega} + (u\cdot\nabla)\boldsymbol{\omega} = (\boldsymbol{\omega}\cdot\nabla)u$。

- **环量 (Circulation)**：[开尔文环量定理](@entry_id:139984)指出，沿闭合物质回路$c_t$的环量$\Gamma(t) = \oint_{c_t} u \cdot dx$是守恒的。在几何框架中，环量是动量1-形式$m$在物质回路上的积分。其守恒性是[欧拉-庞加莱方程](@entry_id:1124672)的直接推论 ：
  $$
  \frac{d\Gamma}{dt} = \frac{d}{dt} \oint_{c_t} m = \oint_{c_t} (\partial_t m + \mathcal{L}_u m) = \oint_{c_t} (-d\pi) = 0
  $$
  最后一步是因为一个恰当形式（如$-d\pi$）在闭回路上的积分为零。从更深层次看，[环量守恒](@entry_id:189127)是[诺特定理](@entry_id:145690)的体现，它源于[拉格朗日量](@entry_id:174593)在粒子重标签（即$\mathrm{Diff}(M)$的右作用）下的对称性。

#### [平衡态](@entry_id:270364)的[非线性稳定性](@entry_id:1128872)：能量-卡西米尔方法

[李-泊松括号](@entry_id:159190)通常是**退化 (degenerate)** 的，这意味着存在非平凡的函数，它们与所有其他函数都泊松交换。这些函数被称为**[卡西米尔不变量](@entry_id:181340) (Casimir invariants)** $C$，满足$\{C, F\} = 0$对于所有$F$成立。

卡西米尔不变量的存在意味着动力学被限制在$\mathfrak{g}^*$中的一些[超曲面](@entry_id:159491)上，这些曲面称为**余伴随轨道 (coadjoint orbits)** 或[辛叶](@entry_id:158259)。这一事实是**能量-卡西米尔方法 (Energy-Casimir method)** 的基础，这是一种用于证明非典范哈密顿系统[平衡态](@entry_id:270364)[非线性稳定性](@entry_id:1128872)的强大技术 。

该方法构建一个**能量-卡西米尔泛函** $\mathcal{L} = H + C$，其中$H$是系统的能量（[哈密顿量](@entry_id:144286)），$C$是卡西米尔不变量的一个适当组合。由于$H$和$C$都是[守恒量](@entry_id:161475)，$\mathcal{L}$也是[守恒量](@entry_id:161475)。方法步骤如下：
1.  找到一个[平衡态](@entry_id:270364)$\xi_0$。
2.  选择卡西米尔$C$，使得$\xi_0$是$\mathcal{L}$的一个[临界点](@entry_id:144653)，即$\delta\mathcal{L}(\xi_0) = 0$。
3.  计算$\mathcal{L}$在$\xi_0$处的二阶变分$\delta^2\mathcal{L}(\xi_0)$。

根据[李雅普诺夫稳定性理论](@entry_id:177166)，如果$\delta^2\mathcal{L}(\xi_0)$在动力学可及的扰动方向上是**定号的 (definite)**（正定或负定），那么[平衡态](@entry_id:270364)$\xi_0$就是[非线性](@entry_id:637147)稳定的。因为动力学被限制在[辛叶](@entry_id:158259)上，我们只需要在辛叶的切空间内检验定号性。一个处在它无法离开的“能量景观”的[局部极值](@entry_id:144991)点的[平衡态](@entry_id:270364)必然是稳定的。

#### 处理约束：[狄拉克括号](@entry_id:178441)和勒雷投影

最后，几何框架也为处理像不可压缩性$\nabla \cdot u = 0$这样的约束提供了系统的方法。一种方法是使用**[狄拉克括号](@entry_id:178441) (Dirac bracket)** 。

对于一个具有二类约束的[哈密顿系统](@entry_id:143533)，[狄拉克括号](@entry_id:178441)通过修改原始的泊松括号来构建一个新的括号，使得在新括号下，约束与所有[可观测量](@entry_id:267133)都交换。对于不可压缩流体，直接计算[狄拉克括号](@entry_id:178441)是复杂的，但其最终效果是等价于在李-泊松括号的公式中，将泛函导数$\delta F/\delta u$替换为其无散度部分。

这个投影操作由**勒雷投影算子 (Leray projector)** $\mathbb{P}$完成。在周期性区域上，其形式为：
$$
\mathbb{P} = I - \nabla \Delta^{-1} \nabla \cdot
$$
其中$\Delta^{-1}$是拉普拉斯算子的逆。因此，约束的动力学由一个约化的李-泊松括号生成，其中所有的变分都被投影到无散度的子空间上。这保证了如果初始速度场是无散的，那么它在整个演化过程中都将保持无散。这再次展示了哈密顿结构的灵活性和威力。