{
    "hands_on_practices": [
        {
            "introduction": "Before exploring the dynamics on a diffeomorphism group, we must first precisely define the space itself. For physical systems like ideal incompressible fluids, the configuration space is the group of volume-preserving diffeomorphisms, $\\mathrm{SDiff}(M)$, where constraints like impermeable boundaries translate into specific properties of the group and its Lie algebra of velocity fields. This foundational exercise  challenges you to select the correct mathematical description, a critical first step in applying the principles of geometric mechanics.",
            "id": "3738098",
            "problem": "Let $M$ be a compact, connected, oriented, smooth $n$-dimensional manifold with smooth boundary $\\partial M$, equipped with a smooth volume form $\\mu$ induced by a Riemannian metric. In geometric mechanics, the configuration space for an ideal incompressible fluid on $M$ is modeled by a subgroup of the diffeomorphism group, and the associated boundary conditions are encoded at the level of the Lie algebra via the boundary behavior of Eulerian velocities.\n\nStarting from the following first principles:\n- A smooth flow map $\\eta_t \\colon M \\to M$ evolves by $\\frac{d}{dt}\\eta_t = v_t \\circ \\eta_t$ with $\\eta_0 = \\mathrm{id}$ for a time-dependent velocity field $v_t$ on $M$.\n- Volume preservation for an incompressible fluid is $\\eta_t^{*}\\mu = \\mu$ for all $t$, equivalently $\\mathcal{L}_{v_t}\\mu = 0$, where $\\mathcal{L}$ denotes Lie derivative and $\\mathcal{L}_{v}\\mu = (\\mathrm{div}_{\\mu} v)\\,\\mu$ by definition of divergence with respect to $\\mu$.\n- Impermeability (no-flux) at the boundary is that particles initially on $\\partial M$ remain on $\\partial M$, i.e., $\\eta_t(\\partial M) \\subset \\partial M$ for all $t$, which is equivalent to the Eulerian velocity being tangent to the boundary, i.e., $v_t \\cdot n = 0$ along $\\partial M$, where $n$ is the outward unit normal to $\\partial M$.\n\nWhich option correctly defines the full diffeomorphism group $\\mathrm{Diff}(M)$ and the volume-preserving subgroup $\\mathrm{SDiff}(M)$ for the manifold with boundary, and correctly identifies the subgroup that encodes impermeable boundary conditions together with the corresponding Lie algebra boundary condition?\n\nA. $\\mathrm{Diff}(M)$ is the group of all smooth diffeomorphisms of $M$ (in the sense of manifolds with boundary), so any $\\varphi \\in \\mathrm{Diff}(M)$ restricts to a diffeomorphism $\\varphi|_{\\partial M} \\colon \\partial M \\to \\partial M$. The volume-preserving subgroup is $\\mathrm{SDiff}(M) = \\{\\varphi \\in \\mathrm{Diff}(M) \\mid \\varphi^{*}\\mu = \\mu\\}$. For an ideal incompressible fluid with impermeable boundary, the appropriate configuration space is the subgroup $\\mathrm{SDiff}_{\\partial}(M) := \\{\\varphi \\in \\mathrm{SDiff}(M) \\mid \\varphi(\\partial M) = \\partial M\\}$, and the Lie algebra at the identity is the space of smooth vector fields $v$ with $\\mathrm{div}_{\\mu} v = 0$ in $M$ and $v \\cdot n = 0$ on $\\partial M$.\n\nB. $\\mathrm{Diff}(M)$ is the group of all smooth diffeomorphisms of $M$ that fix the boundary pointwise, i.e., $\\varphi|_{\\partial M} = \\mathrm{id}$. The volume-preserving subgroup is $\\mathrm{SDiff}(M) = \\{\\varphi \\in \\mathrm{Diff}(M) \\mid \\varphi^{*}\\mu = \\mu\\}$. The appropriate configuration space for an ideal incompressible fluid with impermeable boundary is $\\mathrm{SDiff}(M)$ as just defined, and the Lie algebra consists of smooth vector fields $v$ with $\\mathrm{div}_{\\mu} v = 0$ and $v|_{\\partial M} = 0$.\n\nC. $\\mathrm{Diff}(M)$ is the group of all smooth orientation-preserving diffeomorphisms of $M$, and $\\mathrm{SDiff}(M)$ denotes the subgroup of orientation-preserving elements. The appropriate boundary subgroup is $\\{\\varphi \\in \\mathrm{SDiff}(M) \\mid \\varphi(\\partial M) = \\partial M\\}$, and the Lie algebra condition at the boundary is $v \\cdot n$ arbitrary, since only the orientation must be preserved.\n\nD. $\\mathrm{Diff}(M)$ is the group of all smooth diffeomorphisms of $M$ that may map $\\partial M$ into the interior. $\\mathrm{SDiff}(M)$ consists of those that scale the volume form $\\mu$ by a constant factor. The appropriate boundary subgroup allows $\\varphi(\\partial M)$ to move off $\\partial M$ as long as the Jacobian determinant is $1$ on $\\partial M$, and the Lie algebra allows $\\mathrm{div}_{\\mu} v = 0$ in the interior but may have a jump at $\\partial M$.\n\nSelect the single best option.",
            "solution": "The user has provided a problem in the field of geometric mechanics and requested a validation of the problem statement, followed by a full derivation and evaluation of the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   $M$: a compact, connected, oriented, smooth $n$-dimensional manifold with smooth boundary $\\partial M$.\n-   $\\mu$: a smooth volume form on $M$ induced by a Riemannian metric.\n-   Configuration space: subgroup of the diffeomorphism group.\n-   Boundary conditions: encoded in the Lie algebra.\n-   Flow map: $\\eta_t \\colon M \\to M$ evolves by $\\frac{d}{dt}\\eta_t = v_t \\circ \\eta_t$ with $\\eta_0 = \\mathrm{id}$, for a time-dependent velocity field $v_t$.\n-   Volume preservation (incompressibility): $\\eta_t^{*}\\mu = \\mu$ for all $t$.\n-   Equivalent infinitesimal condition for incompressibility: $\\mathcal{L}_{v_t}\\mu = 0$, where $\\mathcal{L}$ is the Lie derivative.\n-   Definition of divergence: $\\mathcal{L}_{v}\\mu = (\\mathrm{div}_{\\mu} v)\\,\\mu$.\n-   Impermeability (no-flux): $\\eta_t(\\partial M) \\subset \\partial M$ for all $t$.\n-   Equivalent infinitesimal condition for impermeability: $v_t \\cdot n = 0$ along $\\partial M$, where $n$ is the outward unit normal to $\\partial M$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically grounded, well-posed, and objective.\n-   **Scientific Grounding:** The problem describes the Arnold-Ebin-Marsden picture of ideal hydrodynamics, a cornerstone of modern geometric mechanics. All definitions and principles, such as the relationship between group-level properties ($\\eta_t^*\\mu = \\mu$) and Lie algebra properties ($\\mathcal{L}_v\\mu=0$), are standard and correct.\n-   **Well-Posedness:** The problem asks for the correct mathematical definitions of the configuration space and its Lie algebra based on stated physical principles. This is a well-defined conceptual question with a unique correct answer within the established mathematical framework.\n-   **Objectivity and Clarity:** The language is formal and precise. Terms like `diffeomorphism`, `Lie algebra`, `volume form`, `Lie derivative`, and `impermeability` have unambiguous meanings in this context. The givens are self-consistent and sufficient to determine the correct option.\n-   **Flaw Checklist:** The problem statement does not violate any of the specified criteria for invalidity. It is factually sound, formalizable, complete, realistic (within the ideal fluid model), and non-trivial.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. Proceeding to the solution.\n\n### Derivation and Option Analysis\n\nThe problem requires identifying the correct group-theoretic and Lie-algebraic formulation for an ideal incompressible fluid on a manifold $M$ with a boundary $\\partial M$, subject to an impermeability condition.\n\n1.  **The Diffeomorphism Group $\\mathrm{Diff}(M)$:** For a smooth manifold with boundary $M$, a map $\\varphi \\colon M \\to M$ is a diffeomorphism if it is a smooth bijection with a smooth inverse $\\varphi^{-1}$. A fundamental property of such maps is that they must map the boundary to the boundary. If a point $p \\in \\partial M$ were mapped to an interior point $q = \\varphi(p) \\in \\mathrm{int}(M)$, then the inverse map $\\varphi^{-1}$ would have to map an open neighborhood of $q$ (homeomorphic to $\\mathbb{R}^n$) to a neighborhood of $p$ (homeomorphic to a half-space $\\mathbb{R}^n_+$). Such a map cannot be smooth at $q$, which contradicts the definition of a diffeomorphism. Therefore, for any $\\varphi \\in \\mathrm{Diff}(M)$, it must be that $\\varphi(\\partial M) = \\partial M$. Its restriction to the boundary, $\\varphi|_{\\partial M} \\colon \\partial M \\to \\partial M$, is itself a diffeomorphism of the $(n-1)$-dimensional manifold $\\partial M$.\n\n2.  **The Volume-Preserving Subgroup $\\mathrm{SDiff}(M)$:** As stated in the problem, incompressibility implies that the flow map $\\eta_t$ must preserve the volume form $\\mu$. This means $\\eta_t^*\\mu = \\mu$. The group of all such diffeomorphisms is the special diffeomorphism group, or group of volume-preserving diffeomorphisms, correctly defined as $\\mathrm{SDiff}(M) = \\{\\varphi \\in \\mathrm{Diff}(M) \\mid \\varphi^{*}\\mu = \\mu\\}$.\n\n3.  **The Impermeability Condition:** The problem states the impermeability condition as $\\eta_t(\\partial M) \\subset \\partial M$ for all $t$. As established in point 1, any diffeomorphism $\\eta_t \\in \\mathrm{Diff}(M)$ automatically satisfies the stronger condition $\\eta_t(\\partial M) = \\partial M$. Therefore, the impermeability condition does not impose any further restriction on the group $\\mathrm{SDiff}(M)$. The appropriate configuration space for an ideal, incompressible fluid with an impermeable boundary is simply the group $\\mathrm{SDiff}(M)$.\n\n4.  **The Lie Algebra:** The Lie algebra of a diffeomorphism group is the space of smooth vector fields on the manifold. The conditions on the group elements translate to conditions on the generating vector fields.\n    -   The condition for belonging to $\\mathrm{SDiff}(M)$ is $\\varphi^*\\mu = \\mu$. The infinitesimal version of this, for a flow generated by a vector field $v$, is $\\mathcal{L}_v \\mu = 0$. Using the provided definition $\\mathcal{L}_{v}\\mu = (\\mathrm{div}_{\\mu} v)\\,\\mu$, this is equivalent to $\\mathrm{div}_{\\mu} v = 0$. This is the infinitesimal condition for incompressibility.\n    -   The condition that the flow preserves the boundary, $\\eta_t(\\partial M) = \\partial M$, translates to the infinitesimal condition that the generating vector field $v$ must be tangent to the boundary $\\partial M$ at every point on the boundary. That is, for any $p \\in \\partial M$, the vector $v(p)$ must lie in the tangent space $T_p(\\partial M)$. Given the Riemannian metric (which induces $\\mu$), we can decompose the tangent space at the boundary $T_p M = T_p(\\partial M) \\oplus \\mathrm{span}(n(p))$, where $n(p)$ is the outward unit normal vector. The condition $v(p) \\in T_p(\\partial M)$ is then equivalent to the statement that $v(p)$ is orthogonal to $n(p)$. This is commonly written as $g(v, n)|_{\\partial M} = 0$, or simply $v \\cdot n = 0$ on $\\partial M$. This is the infinitesimal impermeability condition.\n\nCombining these findings, the Lie algebra of the configuration space consists of smooth vector fields $v$ on $M$ such that $\\mathrm{div}_{\\mu} v = 0$ everywhere on $M$ and $v \\cdot n = 0$ on the boundary $\\partial M$.\n\n### Option-by-Option Analysis\n\n**A. $\\mathrm{Diff}(M)$ is the group of all smooth diffeomorphisms of $M$ (in the sense of manifolds with boundary), so any $\\varphi \\in \\mathrm{Diff}(M)$ restricts to a diffeomorphism $\\varphi|_{\\partial M} \\colon \\partial M \\to \\partial M$. The volume-preserving subgroup is $\\mathrm{SDiff}(M) = \\{\\varphi \\in \\mathrm{Diff}(M) \\mid \\varphi^{*}\\mu = \\mu\\}$. For an ideal incompressible fluid with impermeable boundary, the appropriate configuration space is the subgroup $\\mathrm{SDiff}_{\\partial}(M) := \\{\\varphi \\in \\mathrm{SDiff}(M) \\mid \\varphi(\\partial M) = \\partial M\\}$, and the Lie algebra at the identity is the space of smooth vector fields $v$ with $\\mathrm{div}_{\\mu} v = 0$ in $M$ and $v \\cdot n = 0$ on $\\partial M$.**\n\n-   The description of $\\mathrm{Diff}(M)$ is correct.\n-   The definition of $\\mathrm{SDiff}(M)$ is correct.\n-   The definition of the configuration space $\\mathrm{SDiff}_{\\partial}(M)$ is also correct, noting that the condition $\\varphi(\\partial M) = \\partial M$ is redundant for any $\\varphi \\in \\mathrm{Diff}(M)$, so $\\mathrm{SDiff}_{\\partial}(M)$ is identical to $\\mathrm{SDiff}(M)$. Its inclusion is not an error.\n-   The description of the Lie algebra, requiring both $\\mathrm{div}_{\\mu} v = 0$ and $v \\cdot n = 0$ on $\\partial M$, is correct.\n-   **Verdict:** Correct.\n\n**B. $\\mathrm{Diff}(M)$ is the group of all smooth diffeomorphisms of $M$ that fix the boundary pointwise, i.e., $\\varphi|_{\\partial M} = \\mathrm{id}$. The volume-preserving subgroup is $\\mathrm{SDiff}(M) = \\{\\varphi \\in \\mathrm{Diff}(M) \\mid \\varphi^{*}\\mu = \\mu\\}$. The appropriate configuration space for an ideal incompressible fluid with impermeable boundary is $\\mathrm{SDiff}(M)$ as just defined, and the Lie algebra consists of smooth vector fields $v$ with $\\mathrm{div}_{\\mu} v = 0$ and $v|_{\\partial M} = 0$.**\n\n-   This defines a much smaller group, often called the group of diffeomorphisms relative to the boundary. This is not the general group $\\mathrm{Diff}(M)$.\n-   The Lie algebra condition $v|_{\\partial M} = 0$ (the vector field vanishes on the boundary) is the infinitesimal generator for flows that fix the boundary pointwise. This corresponds to a no-slip boundary condition, which is physically different and mathematically stronger than the impermeability (no-flux) condition $v \\cdot n = 0$.\n-   **Verdict:** Incorrect.\n\n**C. $\\mathrm{Diff}(M)$ is the group of all smooth orientation-preserving diffeomorphisms of $M$, and $\\mathrm{SDiff}(M)$ denotes the subgroup of orientation-preserving elements. The appropriate boundary subgroup is $\\{\\varphi \\in \\mathrm{SDiff}(M) \\mid \\varphi(\\partial M) = \\partial M\\}$, and the Lie algebra condition at the boundary is $v \\cdot n$ arbitrary, since only the orientation must be preserved.**\n\n-   The definition of $\\mathrm{SDiff}(M)$ is imprecise. Volume-preservation ($\\varphi^*\\mu = \\mu$) is stronger than orientation-preservation (Jacobian determinant $ 0$).\n-   The statement that the Lie algebra condition is `$v \\cdot n$ arbitrary` is fundamentally incorrect. The impermeability hypothesis $\\eta_t(\\partial M) \\subset \\partial M$ directly implies $v \\cdot n = 0$. An arbitrary normal component would mean fluid flows through the boundary.\n-   **Verdict:** Incorrect.\n\n**D. $\\mathrm{Diff}(M)$ is the group of all smooth diffeomorphisms of $M$ that may map $\\partial M$ into the interior. $\\mathrm{SDiff}(M)$ consists of those that scale the volume form $\\mu$ by a constant factor. The appropriate boundary subgroup allows $\\varphi(\\partial M)$ to move off $\\partial M$ as long as the Jacobian determinant is $1$ on $\\partial M$, and the Lie algebra allows $\\mathrm{div}_{\\mu} v = 0$ in the interior but may have a jump at $\\partial M$.**\n\n-   The statement that diffeomorphisms may map $\\partial M$ into the interior is false for manifolds with boundary.\n-   The definition of $\\mathrm{SDiff}(M)$ is incorrect; it describes conformal transformations, not volume-preserving ones. Volume-preserving means the scaling factor is exactly $1$, not any constant.\n-   The remaining descriptions of the boundary subgroup and the Lie algebra are consequently flawed and inconsistent with the principles of fluid dynamics on manifolds with boundary. For instance, a smooth vector field $v$ would lead to a smooth divergence function $\\mathrm{div}_\\mu v$, which cannot have a `jump`.\n-   **Verdict:** Incorrect.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A powerful technique in this field is to represent continuous fields using a finite set of 'landmarks'. The dynamics of the full diffeomorphism group can then be projected onto the motion of these points. This practice  asks you to formalize this by defining the landmark momentum map and deriving its evolution under the Euler–Poincaré (EPDiff) equations, revealing the fundamental advection law that governs how landmarks are transported by the flow.",
            "id": "3738117",
            "problem": "Let $M$ be a smooth, oriented, finite-dimensional Riemannian manifold with volume form $\\mu$, and let $\\mathrm{Diff}(M)$ denote the group of smooth diffeomorphisms of $M$. Consider the configuration space of $N$ point landmarks $q=(q_{1},\\dots,q_{N})\\in M^{N}$, with the natural left action of $\\mathrm{Diff}(M)$ given by $\\Phi\\cdot(q_{1},\\dots,q_{N})=(\\Phi(q_{1}),\\dots,\\Phi(q_{N}))$. Let $T^{\\ast}M^{N}$ be the cotangent bundle with canonical symplectic structure, and write elements of $T^{\\ast}_{q}M^{N}$ as $p=(p_{1},\\dots,p_{N})$ with $p_{a}\\in T^{\\ast}_{q_{a}}M$. The cotangent lift of the $\\mathrm{Diff}(M)$-action induces an associated momentum map $J:T^{\\ast}M^{N}\\to\\mathfrak{X}(M)^{\\ast}$, where $\\mathfrak{X}(M)$ is the Lie algebra of smooth vector fields on $M$, defined by the canonical pairing\n$$\n\\langle J(q,p),\\xi\\rangle=\\sum_{a=1}^{N}p_{a}\\big(\\xi(q_{a})\\big),\\quad \\xi\\in\\mathfrak{X}(M).\n$$\nHere, $\\langle\\cdot,\\cdot\\rangle$ denotes the dual pairing and $p_{a}(\\xi(q_{a}))$ is the evaluation of the covector $p_{a}$ on the vector $\\xi(q_{a})$.\n\n1. Compute $J(q,p)$ as an explicit distribution-valued one-form on $M$ by identifying it in terms of Dirac measures. Recall the Dirac measure $\\delta_{x}$ at $x\\in M$ satisfies $\\int_{M}f\\,\\delta_{x}=f(x)$ for all test functions $f$.\n\n2. Consider geodesic motion on $\\mathrm{Diff}(M)$ with respect to a right-invariant metric induced by a symmetric, positive-definite, self-adjoint, elliptic operator $L:\\mathfrak{X}(M)\\to\\mathfrak{X}(M)$. The Euler–Poincaré equation on the diffeomorphism group (EPDiff) is given in Eulerian variables by the pair $m=L u$ and the evolution equation $\\partial_{t}m+\\operatorname{ad}^{\\ast}_{u}m=0$, where $u$ is the velocity vector field and $\\operatorname{ad}^{\\ast}_{u}$ is the coadjoint action on one-form densities, equivalently $\\operatorname{ad}^{\\ast}_{u}m=\\mathcal{L}_{u}m$, the Lie derivative along $u$. Let $\\phi_{t}:M\\to M$ denote the flow of $u$, defined by $\\partial_{t}\\phi_{t}=u\\circ\\phi_{t}$ with $\\phi_{0}=\\mathrm{id}_{M}$.\n\nStarting from the fundamental definitions above and without assuming any specific coordinate system, derive the advection law satisfied by the distributional momentum $m(t)$ arising from landmark initial data $m(0)=J\\big(q(0),p(0)\\big)$. Conclude with a single closed-form analytic expression for $m(t)$ in terms of the flow $\\phi_{t}$ and the initial landmark data $\\big(q_{a}(0),p_{a}(0)\\big)_{a=1}^{N}$.\n\nYour final answer must be a single expression or a pair of expressions. If you provide both the momentum map and the advected momentum, write them as a single row matrix. Do not include any equality sign in the final boxed answer.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the established principles of geometric mechanics, well-posed, and objective. It provides a complete and consistent setup for a standard derivation in the theory of the Euler-Poincaré equation on the diffeomorphism group (EPDiff).\n\nThe problem is divided into two parts. First, we are asked to represent the momentum map $J(q,p)$ as a distribution-valued one-form. Second, we must derive the time evolution of this momentum, $m(t)$, under the EPDiff dynamics.\n\nPart 1: The Momentum Map as a Distribution\n\nThe momentum map $J: T^{\\ast}M^{N} \\to \\mathfrak{X}(M)^{\\ast}$ is defined by its pairing with an arbitrary smooth vector field $\\xi \\in \\mathfrak{X}(M)$:\n$$\n\\langle J(q,p),\\xi\\rangle = \\sum_{a=1}^{N} p_{a}\\big(\\xi(q_{a})\\big)\n$$\nHere, $(q,p) = (q_1, \\dots, q_N, p_1, \\dots, p_N)$ with $q_a \\in M$ and $p_a \\in T_{q_a}^*M$. The space $\\mathfrak{X}(M)^*$ is the dual of the space of smooth vector fields, which can be identified with the space of distribution-valued one-forms on $M$.\n\nTo express $J(q,p)$ as an explicit distribution, we use the Dirac delta distribution. For a point $x_0 \\in M$, the Dirac distribution $\\delta_{x_0}$ is defined by its action on a test function $f: M \\to \\mathbb{R}$, which is $\\int_M f(x) \\delta_{x_0}(x) d\\mu(x) = f(x_0)$. We can extend this concept to covector-valued distributions. For a covector $p_0 \\in T_{x_0}^*M$, we define the object $p_0 \\delta_{x_0}$ as a distribution-valued one-form whose action on a vector field $\\xi \\in \\mathfrak{X}(M)$ is given by:\n$$\n\\langle p_0 \\delta_{x_0}, \\xi \\rangle := p_0(\\xi(x_0))\n$$\nThis is a well-defined linear functional on $\\mathfrak{X}(M)$.\n\nComparing this definition with the given formula for the momentum map, we can see that $\\langle J(q,p), \\xi \\rangle$ is a sum of such terms. Specifically,\n$$\n\\langle J(q,p), \\xi \\rangle = \\sum_{a=1}^{N} p_{a}\\big(\\xi(q_{a})\\big) = \\sum_{a=1}^{N} \\langle p_a \\delta_{q_a}, \\xi \\rangle = \\left\\langle \\sum_{a=1}^{N} p_a \\delta_{q_a}, \\xi \\right\\rangle\n$$\nSince this holds for any $\\xi \\in \\mathfrak{X}(M)$, we can identify the momentum map $J(q,p)$ with the following distribution-valued one-form:\n$$\nJ(q,p) = \\sum_{a=1}^{N} p_{a} \\delta_{q_{a}}\n$$\nThis expression represents the momentum as a sum of covectors $p_a$ located at the points $q_a$.\n\nPart 2: Advection of the Momentum\n\nThe dynamics are governed by the Euler-Poincaré (EPDiff) equation for the momentum $m(t) \\in \\mathfrak{X}(M)^*$:\n$$\n\\partial_{t}m + \\operatorname{ad}^{\\ast}_{u}m=0\n$$\nwhere $u$ is the velocity vector field related to $m$ by $m=Lu$, and the coadjoint action is given as the Lie derivative, $\\operatorname{ad}^{\\ast}_{u}m = \\mathcal{L}_{u}m$. The equation is therefore a transport equation:\n$$\n\\partial_{t}m(t) + \\mathcal{L}_{u(t)}m(t) = 0\n$$\nThe velocity field $u(t)$ generates a flow $\\phi_t: M \\to M$, which is a path in the diffeomorphism group $\\mathrm{Diff}(M)$, defined by $\\partial_{t}\\phi_{t} = u(t) \\circ \\phi_{t}$ with $\\phi_{0}=\\mathrm{id}_{M}$.\n\nTo solve this transport equation, we consider the pullback of $m(t)$ by the flow $\\phi_t$. Let $M(t) = \\phi_t^* m(t)$. The time derivative of $M(t)$ is given by the chain rule and the property $\\frac{d}{dt}\\phi_t^* = \\phi_t^* \\mathcal{L}_{u(t)}$:\n$$\n\\frac{d}{dt}M(t) = \\frac{d}{dt}(\\phi_t^* m(t)) = \\left(\\frac{d}{dt}\\phi_t^*\\right) m(t) + \\phi_t^* (\\partial_t m(t)) = \\phi_t^* (\\mathcal{L}_{u(t)} m(t)) + \\phi_t^* (\\partial_t m(t))\n$$\nFactoring out the pullback operator, we get:\n$$\n\\frac{d}{dt}M(t) = \\phi_t^* (\\partial_t m(t) + \\mathcal{L}_{u(t)} m(t))\n$$\nAccording to the EPDiff equation, the term in the parenthesis is zero. Thus, $\\frac{d}{dt}M(t) = 0$, which implies that $M(t)$ is constant in time. Therefore, $M(t) = M(0)$.\n$$\n\\phi_t^* m(t) = \\phi_0^* m(0)\n$$\nSince $\\phi_0 = \\mathrm{id}_M$, its pullback $\\phi_0^*$ is the identity operator, so $\\phi_t^* m(t) = m(0)$. To find $m(t)$, we apply the pushforward operator $(\\phi_t)_* = (\\phi_t^*)^{-1}$ to both sides:\n$$\nm(t) = (\\phi_t)_* m(0)\n$$\nThis shows that the momentum $m(t)$ is obtained by pushing forward the initial momentum $m(0)$ along the flow $\\phi_t$.\n\nThe initial condition is specified as $m(0) = J(q(0), p(0))$. Using our result from Part 1:\n$$\nm(0) = \\sum_{a=1}^{N} p_{a}(0) \\delta_{q_{a}(0)}\n$$\nWe apply the pushforward operator to this expression:\n$$\nm(t) = (\\phi_t)_* \\left( \\sum_{a=1}^{N} p_{a}(0) \\delta_{q_{a}(0)} \\right) = \\sum_{a=1}^{N} (\\phi_t)_* (p_{a}(0) \\delta_{q_{a}(0)})\n$$\nThe pushforward operator acts on both the location of the Dirac delta and the covector. The pushforward of a Dirac delta located at $q_a(0)$ is a Dirac delta located at the advected point:\n$$\n(\\phi_t)_* \\delta_{q_{a}(0)} = \\delta_{\\phi_t(q_a(0))}\n$$\nLet us define the evolved landmark positions as $q_a(t) = \\phi_t(q_a(0))$.\n\nTo determine how the covector $p_a(0) \\in T_{q_a(0)}^*M$ is transported, we examine the action of the pushforward on the entire covector-valued distribution. This is defined by its pairing with a test vector field $\\xi$. The pushforward $(\\phi_t)_*$ on $\\mathfrak{X}(M)^*$ is dual to the Adjoint action $\\text{Ad}_{\\phi_t^{-1}}$ on $\\mathfrak{X}(M)$.\n$$\n\\langle m(t), \\xi \\rangle = \\langle (\\phi_t)_* m(0), \\xi \\rangle = \\langle m(0), \\text{Ad}_{\\phi_t^{-1}} \\xi \\rangle\n$$\nThe adjoint action is $\\text{Ad}_{\\phi_t^{-1}}\\xi = (\\phi_t^{-1})_*(\\xi \\circ \\phi_t)$. Evaluating the pairing with the initial momentum:\n$$\n\\langle m(t), \\xi \\rangle = \\sum_{a=1}^N p_a(0) \\left( ((\\phi_t^{-1})_*(\\xi \\circ \\phi_t))(q_a(0)) \\right)\n$$\nThe argument of $p_a(0)$ is $(d\\phi_t^{-1})_{\\phi_t(q_a(0))} (\\xi(\\phi_t(q_a(0)))) = (d\\phi_t^{-1})_{q_a(t)} (\\xi(q_a(t)))$.\nThe map $\\phi_t^{-1}$ sends $q_a(t)$ to $q_a(0)$. Its pullback, $(\\phi_t^{-1})^*$, maps covectors from $T_{q_a(0)}^*M$ to $T_{q_a(t)}^*M$. Let us define the evolved momenta as $p_a(t) = (\\phi_t^{-1})^* p_a(0)$. By definition of pullback, for any vector $v \\in T_{q_a(t)}M$:\n$$\n\\langle p_a(t), v \\rangle = \\langle (\\phi_t^{-1})^* p_a(0), v \\rangle = \\langle p_a(0), (d\\phi_t^{-1})_{q_a(t)}(v) \\rangle\n$$\nSetting $v = \\xi(q_a(t))$, we get $\\langle p_a(t), \\xi(q_a(t)) \\rangle = \\langle p_a(0), (d\\phi_t^{-1})_{q_a(t)}(\\xi(q_a(t))) \\rangle$.\nThus, we can write:\n$$\n\\langle m(t), \\xi \\rangle = \\sum_{a=1}^N \\langle p_a(t), \\xi(q_a(t)) \\rangle\n$$\nThis implies that $m(t) = \\sum_{a=1}^N p_a(t) \\delta_{q_a(t)}$. Substituting the expressions for $q_a(t)$ and $p_a(t)$, we arrive at the final closed-form expression for the advected momentum:\n$$\nm(t) = \\sum_{a=1}^{N} \\big( (\\phi_t^{-1})^* p_a(0) \\big) \\delta_{\\phi_t(q_a(0))}\n$$\nThis expression encapsulates the advection law: the landmark positions $q_a$ are transported by the flow $\\phi_t$, while the landmark momenta $p_a$ are transported by the corresponding cotangent lift action.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sum_{a=1}^{N} p_{a} \\delta_{q_{a}}  \\sum_{a=1}^{N} ((\\phi_t^{-1})^* p_{a}(0)) \\delta_{\\phi_t(q_{a}(0))}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The abstract advection law for landmarks becomes a concrete computational model once we specify the metric, or inertia operator, on the diffeomorphism group. A common choice is a metric defined by a smoothing kernel, which induces interactions between the landmarks. This problem  guides you through the process of deriving the explicit Hamiltonian and equations of motion for a landmark system on the plane, showing how the geometry of $\\mathrm{Diff}(M)$ translates directly into a system of interacting particles.",
            "id": "3738094",
            "problem": "Consider the configuration space given by the diffeomorphism group of the plane $\\operatorname{Diff}(\\mathbb{R}^{2})$, equipped with a right-invariant Riemannian metric induced by a positive, self-adjoint, elliptic inertia operator $A$ acting on sufficiently smooth vector fields. The induced kinetic energy defines a Hamiltonian on the dual of the Lie algebra of vector fields, and the corresponding Euler–Poincaré equation on the diffeomorphism group (EPDiff) admits a singular momentum ansatz supported on a finite set of landmarks. Let the momentum be concentrated on $N \\geq 2$ landmarks as\n$$\nm(x,t) = \\sum_{i=1}^{N} p_{i}(t)\\,\\delta\\!\\left(x - q_{i}(t)\\right),\n$$\nwhere $q_{i}(t) \\in \\mathbb{R}^{2}$ are landmark positions and $p_{i}(t) \\in \\mathbb{R}^{2}$ are the corresponding conjugate momenta. Assume that the inverse of the inertia operator $A^{-1}$ is approximated by a scalar-valued Gaussian kernel\n$$\nK_{\\sigma}(x) = \\exp\\!\\left(-\\frac{\\|x\\|^{2}}{2\\sigma^{2}}\\right),\n$$\nwith scale parameter $\\sigma  0$, acting isotropically on vectors in $\\mathbb{R}^{2}$ so that the velocity field $u$ generated by $m$ is given by convolution $u = K_{\\sigma} * m$:\n$$\nu(x,t) = \\sum_{j=1}^{N} K_{\\sigma}\\!\\left(x - q_{j}(t)\\right) p_{j}(t).\n$$\nThe finite-dimensional reduced Hamiltonian on the cotangent bundle $T^{*}\\left(\\mathbb{R}^{2N}\\right)$ with canonical symplectic structure is\n$$\nH(q,p) = \\frac{1}{2} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\left(p_{i} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right),\n$$\nwhere $q = (q_{1},\\dots,q_{N})$ and $p = (p_{1},\\dots,p_{N})$.\n\nStarting from the canonical Hamiltonian framework and the above definitions, compute the closed-form expression for the interaction term $H_{\\mathrm{int}}(q,p)$ consisting only of the cross-landmark contributions (that is, the terms with $i \\neq j$), and then derive the landmark equations of motion for $\\dot{q}_{i}$ and $\\dot{p}_{i}$ in terms of $K_{\\sigma}$ and its gradient. Express your final result as analytic expressions in $q_{i}$, $p_{i}$, and $\\sigma$. No numerical approximation is required, and no units need to be specified. The final answer must be given as closed-form analytic expressions. If you present multiple expressions, write them as a single row matrix.",
            "solution": "The problem is valid. It presents a standard formulation from geometric mechanics, specifically concerning the finite-dimensional reduction of the Euler–Poincaré equation on the diffeomorphism group (EPDiff) to a system of interacting landmarks. The provided Hamiltonian is well-defined, and the task requires a standard, albeit non-trivial, derivation of Hamilton's equations of motion. All terms are clearly defined, and the problem is self-contained and scientifically sound.\n\nThe solution proceeds in two parts. First, we identify the interaction term of the Hamiltonian. Second, we derive the equations of motion for the landmark positions $q_i$ and momenta $p_i$ using the canonical Hamiltonian framework.\n\nThe phase space is the cotangent bundle $T^{*}\\left(\\mathbb{R}^{2N}\\right)$, which is a symplectic manifold with canonical coordinates $(q, p) = (q_1, \\dots, q_N, p_1, \\dots, p_N)$. The dynamics are governed by Hamilton's equations:\n$$\n\\dot{q}_{i} = \\frac{\\partial H}{\\partial p_{i}}, \\quad \\dot{p}_{i} = -\\frac{\\partial H}{\\partial q_{i}}\n$$\nwhere $\\frac{\\partial}{\\partial q_{i}}$ and $\\frac{\\partial}{\\partial p_{i}}$ denote vector gradients with respect to the vector variables $q_i \\in \\mathbb{R}^2$ and $p_i \\in \\mathbb{R}^2$.\n\nThe Hamiltonian is given by:\n$$\nH(q,p) = \\frac{1}{2} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\left(p_{i} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right)\n$$\nwith $K_{\\sigma}(x) = \\exp\\!\\left(-\\frac{\\|x\\|^{2}}{2\\sigma^{2}}\\right)$.\n\n**Part 1: The Interaction Hamiltonian $H_{\\mathrm{int}}(q,p)$**\n\nThe total Hamiltonian can be decomposed into self-interaction terms ($i=j$) and cross-interaction terms ($i \\neq j$).\nThe self-interaction part, $H_{\\mathrm{self}}$, is given by the sum over terms where $i=j$:\n$$\nH_{\\mathrm{self}}(q,p) = \\frac{1}{2} \\sum_{i=1}^{N} \\left(p_{i} \\cdot p_{i}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{i}\\right) = \\frac{1}{2} \\sum_{i=1}^{N} \\|p_{i}\\|^{2} K_{\\sigma}(0)\n$$\nSince $K_{\\sigma}(0) = \\exp(0) = 1$, the self-interaction energy is purely kinetic:\n$$\nH_{\\mathrm{self}}(q,p) = \\frac{1}{2} \\sum_{i=1}^{N} \\|p_{i}\\|^{2}\n$$\nThe interaction term, $H_{\\mathrm{int}}(q,p)$, consists of all terms where $i \\neq j$:\n$$\nH_{\\mathrm{int}}(q,p) = H(q,p) - H_{\\mathrm{self}}(q,p) = \\frac{1}{2} \\sum_{i=1, i \\neq j}^{N} \\sum_{j=1}^{N} \\left(p_{i} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right)\n$$\nSubstituting the expression for the kernel $K_{\\sigma}$, we obtain the closed-form expression for the interaction Hamiltonian:\n$$\nH_{\\mathrm{int}}(q,p) = \\frac{1}{2} \\sum_{i,j=1, i \\neq j}^{N} \\left(p_{i} \\cdot p_{j}\\right) \\exp\\!\\left(-\\frac{\\|q_{i} - q_{j}\\|^{2}}{2\\sigma^{2}}\\right)\n$$\nNote that because the summands are symmetric with respect to swapping indices $i$ and $j$, this can also be written as a sum over unique pairs, $H_{\\mathrm{int}}(q,p) = \\sum_{1 \\le i  j \\le N} \\left(p_{i} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right)$.\n\n**Part 2: Landmark Equations of Motion**\n\nWe now derive the equations for $\\dot{q}_i$ and $\\dot{p}_i$.\n\n**Equation for $\\dot{q}_{i}$:**\nWe compute the gradient of $H$ with respect to $p_i$:\n$$\n\\dot{q}_{i} = \\frac{\\partial H}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}} \\left[ \\frac{1}{2} \\sum_{k=1}^{N}\\sum_{j=1}^{N} \\left(p_{k} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{k} - q_{j}\\right) \\right]\n$$\nWe use the identity $\\frac{\\partial}{\\partial p_i}(p_k \\cdot p_j) = \\delta_{ik} p_j + \\delta_{ij} p_k$, where $\\delta_{ij}$ is the Kronecker delta.\n$$\n\\dot{q}_{i} = \\frac{1}{2} \\sum_{k=1}^{N}\\sum_{j=1}^{N} \\left( \\delta_{ik} p_{j} + \\delta_{ij} p_{k} \\right) K_{\\sigma}\\!\\left(q_{k} - q_{j}\\right)\n$$\nSplitting the sum into two parts:\n$$\n\\dot{q}_{i} = \\frac{1}{2} \\left[ \\sum_{j=1}^{N} p_{j} K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right) + \\sum_{k=1}^{N} p_{k} K_{\\sigma}\\!\\left(q_{k} - q_{i}\\right) \\right]\n$$\nSince $K_{\\sigma}(x)$ is an even function, $K_{\\sigma}(q_k - q_i) = K_{\\sigma}(-(q_i - q_k)) = K_{\\sigma}(q_i - q_k)$. The second sum is identical to the first (by relabeling the dummy index $k$ to $j$).\n$$\n\\dot{q}_{i} = \\frac{1}{2} \\left[ 2 \\sum_{j=1}^{N} p_{j} K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right) \\right] = \\sum_{j=1}^{N} K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right) p_{j}\n$$\nThis equation shows that the velocity of the $i$-th landmark is the superposition of influences from all landmarks (including itself), where each landmark $j$ contributes a velocity field $K_\\sigma(x-q_j)p_j$.\n\n**Equation for $\\dot{p}_{i}$:**\nNext, we compute the negative gradient of $H$ with respect to $q_i$:\n$$\n\\dot{p}_{i} = -\\frac{\\partial H}{\\partial q_{i}} = -\\frac{1}{2} \\sum_{k=1}^{N}\\sum_{j=1}^{N} \\left(p_{k} \\cdot p_{j}\\right) \\frac{\\partial}{\\partial q_{i}} K_{\\sigma}\\!\\left(q_{k} - q_{j}\\right)\n$$\nUsing the chain rule, $\\frac{\\partial}{\\partial q_{i}} f(q_k - q_j) = (\\delta_{ik} - \\delta_{ij}) (\\nabla f)(q_k - q_j)$, where $\\nabla f$ is the gradient of $f$ with respect to its argument.\n$$\n\\dot{p}_{i} = -\\frac{1}{2} \\sum_{k=1}^{N}\\sum_{j=1}^{N} \\left(p_{k} \\cdot p_{j}\\right) \\left(\\delta_{ik} - \\delta_{ij}\\right) \\nabla K_{\\sigma}\\!\\left(q_{k} - q_{j}\\right)\n$$\nSplitting the sum:\n$$\n\\dot{p}_{i} = -\\frac{1}{2} \\left[ \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\nabla K_{\\sigma}(q_{i} - q_{j}) - \\sum_{k=1}^{N} (p_{k} \\cdot p_{i}) \\nabla K_{\\sigma}(q_{k} - q_{i}) \\right]\n$$\nLet $g(x) = \\nabla K_{\\sigma}(x)$. Since $K_{\\sigma}(x)$ is an even function, its gradient $g(x)$ is an odd function, so $g(-x) = -g(x)$. The second sum can be rewritten by relabeling $k$ to $j$:\n$$\n\\sum_{j=1}^{N} (p_{j} \\cdot p_{i}) \\nabla K_{\\sigma}(q_{j} - q_{i}) = \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) g(q_{j} - q_{i}) = \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\left( -g(q_{i} - q_{j}) \\right) = -\\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) g(q_{i} - q_{j})\n$$\nSubstituting this back into the expression for $\\dot{p}_i$:\n$$\n\\dot{p}_{i} = -\\frac{1}{2} \\left[ \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\nabla K_{\\sigma}(q_{i} - q_{j}) - \\left(-\\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\nabla K_{\\sigma}(q_{i} - q_{j})\\right) \\right] = - \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\nabla K_{\\sigma}(q_{i}-q_{j})\n$$\nThe gradient of the kernel is $\\nabla K_{\\sigma}(x) = \\nabla \\exp\\!\\left(-\\frac{\\|x\\|^{2}}{2\\sigma^{2}}\\right) = -\\frac{x}{\\sigma^{2}} \\exp\\!\\left(-\\frac{\\|x\\|^{2}}{2\\sigma^{2}}\\right) = -\\frac{x}{\\sigma^{2}} K_{\\sigma}(x)$.\nSubstituting this into the equation for $\\dot{p}_i$:\n$$\n\\dot{p}_{i} = - \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\left(-\\frac{q_{i}-q_{j}}{\\sigma^{2}} K_{\\sigma}(q_{i}-q_{j})\\right) = \\frac{1}{\\sigma^{2}} \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) (q_{i}-q_{j}) K_{\\sigma}(q_{i}-q_{j})\n$$\nThe term for $j=i$ in the sum is zero because $q_i - q_i = 0$.\n\nCombining the results, the final analytic expressions for the interaction hamiltonian and the equations of motion are:\n$H_{\\mathrm{int}}(q,p) = \\frac{1}{2} \\sum_{i,j=1, i \\neq j}^{N} (p_i \\cdot p_j) \\exp\\!\\left(-\\frac{\\|q_i-q_j\\|^2}{2\\sigma^2}\\right)$\n$\\dot{q}_{i} = \\sum_{j=1}^{N} \\exp\\!\\left(-\\frac{\\|q_{i} - q_{j}\\|^{2}}{2\\sigma^{2}}\\right) p_j$\n$\\dot{p}_{i} = \\frac{1}{\\sigma^{2}} \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) (q_{i}-q_{j}) \\exp\\!\\left(-\\frac{\\|q_{i} - q_{j}\\|^{2}}{2\\sigma^{2}}\\right)$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} \\sum_{i,j=1, i \\neq j}^{N} (p_i \\cdot p_j) \\exp\\left(-\\frac{\\|q_i - q_j\\|^2}{2\\sigma^2}\\right)  \\sum_{j=1}^{N} \\exp\\left(-\\frac{\\|q_i - q_j\\|^2}{2\\sigma^2}\\right) p_j  \\frac{1}{\\sigma^2} \\sum_{j=1}^{N} (p_i \\cdot p_j) (q_i - q_j) \\exp\\left(-\\frac{\\|q_i-q_j\\|^2}{2\\sigma^2}\\right) \\end{pmatrix}}\n$$"
        }
    ]
}