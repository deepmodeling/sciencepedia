{
    "hands_on_practices": [
        {
            "introduction": "The bedrock of geometric optimal control is the Hamiltonian formalism. This first practice bridges the gap between the familiar Lagrangian description of mechanical systems and the Hamiltonian framework essential for applying the Pontryagin Maximum Principle. By deriving the Hamiltonian from a general Lagrangian on a Riemannian manifold , you will master the Legendre transform, a fundamental tool for converting questions about motion into questions about optimal control.",
            "id": "3743856",
            "problem": "Consider a smooth, connected, finite-dimensional configuration manifold $Q$ equipped with a Riemannian metric $g$, which assigns to each point $x \\in Q$ a positive-definite bilinear form $g_{x}: T_{x}Q \\times T_{x}Q \\to \\mathbb{R}$. Let $V: Q \\to \\mathbb{R}$ be a smooth potential function, and consider the mechanical Lagrangian $L: TQ \\to \\mathbb{R}$ given by $L(x,v) = \\frac{1}{2} g_{x}(v,v) - V(x)$ for $(x,v) \\in TQ$. Use the foundational definition of the fiber derivative of the Lagrangian with respect to the velocity, namely, for each fixed $x$, the derivative $d_{v}L(x,v) \\in T_{x}^{*}Q$ satisfies $d_{v}L(x,v)\\cdot \\delta v = \\frac{d}{d\\epsilon}\\big|_{\\epsilon=0} L(x,v + \\epsilon \\delta v)$ for all $\\delta v \\in T_{x}Q$. Also use the definition of the fiberwise Legendre transform from $TQ$ to $T^{*}Q$, which associates to $(x,v)$ the covector $p = d_{v}L(x,v) \\in T_{x}^{*}Q$, and defines the Hamiltonian $H: T^{*}Q \\to \\mathbb{R}$ by\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - L(x,v) \\right).\n$$\nStarting strictly from these base definitions and the positive-definiteness of $g_{x}$, derive the explicit expression of $p$ in terms of $g_{x}$ and $v$, and compute the Hamiltonian $H(x,p)$ entirely in terms of $x$, $p$, the dual metric $g_x^{-1}: T_{x}^{*}Q \\times T_{x}^{*}Q \\to \\mathbb{R}$, and $V(x)$. Your final answer must be a single analytic expression involving only $x$, $p$, $g_x^{-1}$, and $V(x)$, with no remaining dependence on $v$. No rounding is required and no physical units are involved. Express your final answer as a closed-form analytic expression.",
            "solution": "The problem statement is a well-posed and fundamental exercise in geometric mechanics. It asks for the derivation of the Hamiltonian $H$ for a mechanical system from the Lagrangian $L$ using the Legendre transformation. All definitions and conditions are standard, consistent, and mathematically sound. We shall proceed with the derivation.\n\nThe problem is divided into two parts: first, finding the relationship between the momentum $p$ and the velocity $v$, and second, using this relationship to compute the Hamiltonian $H(x,p)$.\n\n**Part 1: Derivation of the momentum $p$**\n\nWe are given the Lagrangian $L: TQ \\to \\mathbb{R}$ for a mechanical system on a configuration manifold $Q$ with a Riemannian metric $g$:\n$$\nL(x,v) = \\frac{1}{2} g_{x}(v,v) - V(x)\n$$\nwhere $(x,v) \\in TQ$. The momentum $p \\in T_{x}^{*}Q$ is defined as the fiber derivative of $L$ with respect to $v$. The definition provided is that for any variation $\\delta v \\in T_{x}Q$, the action of the covector $p = d_{v}L(x,v)$ on $\\delta v$ is given by:\n$$\np(\\delta v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} L(x,v + \\epsilon \\delta v)\n$$\nWe substitute the expression for $L$ into this definition. The potential $V(x)$ is independent of the velocity $v$, so it vanishes upon differentiation with respect to $v$.\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} g_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) - V(x)\n$$\nUsing the bilinearity of the metric $g_x$, we expand the quadratic term:\n$$\ng_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) = g_{x}(v,v) + g_{x}(v, \\epsilon \\delta v) + g_{x}(\\epsilon \\delta v, v) + g_{x}(\\epsilon \\delta v, \\epsilon \\delta v)\n$$\nSince $g_x$ is a symmetric bilinear form, $g_x(v, \\delta v) = g_x(\\delta v, v)$. The expression becomes:\n$$\ng_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) = g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v)\n$$\nSubstituting this back into the expression for $L$:\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} \\left( g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v) \\right) - V(x)\n$$\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} g_{x}(v,v) + \\epsilon g_{x}(v, \\delta v) + \\frac{1}{2} \\epsilon^{2} g_{x}(\\delta v, \\delta v) - V(x)\n$$\nNow, we differentiate with respect to $\\epsilon$:\n$$\n\\frac{d}{d\\epsilon} L(x,v + \\epsilon \\delta v) = g_{x}(v, \\delta v) + \\epsilon g_{x}(\\delta v, \\delta v)\n$$\nEvaluating this derivative at $\\epsilon=0$:\n$$\n\\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} L(x,v + \\epsilon \\delta v) = g_{x}(v, \\delta v)\n$$\nTherefore, the defining relation for the momentum $p$ is:\n$$\np(\\delta v) = g_{x}(v, \\delta v) \\quad \\text{for all } \\delta v \\in T_{x}Q\n$$\nThis equation provides the explicit relationship between the momentum covector $p \\in T_x^*Q$ and the velocity vector $v \\in T_xQ$. It states that the covector $p$ is the image of the vector $v$ under the musical isomorphism $v \\mapsto v^{\\flat} = g_{x}(v, \\cdot)$ induced by the metric.\n\n**Part 2: Computation of the Hamiltonian $H(x,p)$**\n\nThe Hamiltonian $H: T^{*}Q \\to \\mathbb{R}$ is defined by the Legendre transform of the Lagrangian:\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - L(x,v) \\right)\n$$\nWe substitute the expression for $L(x,v)$ into this definition:\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - \\left(\\frac{1}{2} g_{x}(v,v) - V(x)\\right) \\right)\n$$\nThe potential $V(x)$ does not depend on $v$, so it can be moved outside the supremum:\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - \\frac{1}{2} g_{x}(v,v) \\right) + V(x)\n$$\nLet the function to be maximized be $f(v) = p(v) - \\frac{1}{2} g_{x}(v,v)$. To find the velocity $v_{\\text{crit}}$ that maximizes this function, we must find the critical point where its derivative is zero. The derivative of $f(v)$ in an arbitrary direction $\\delta v \\in T_{x}Q$ is:\n$$\nd_{v}f(v) \\cdot \\delta v = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} f(v + \\epsilon\\delta v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\left( p(v + \\epsilon\\delta v) - \\frac{1}{2} g_{x}(v + \\epsilon\\delta v, v + \\epsilon\\delta v) \\right)\n$$\nUsing the linearity of $p$ and the expansion of the metric term from Part 1:\n$$\nd_{v}f(v) \\cdot \\delta v = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\left( p(v) + \\epsilon p(\\delta v) - \\frac{1}{2} \\left( g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v) \\right) \\right)\n$$\n$$\nd_{v}f(v) \\cdot \\delta v = p(\\delta v) - g_{x}(v, \\delta v)\n$$\nThe critical point $v_{\\text{crit}}$ is where this derivative vanishes for all directions $\\delta v$:\n$$\np(\\delta v) - g_{x}(v_{\\text{crit}}, \\delta v) = 0 \\quad \\text{for all } \\delta v \\in T_{x}Q\n$$\nThis implies that the covector $p$ is identical to the covector $g_{x}(v_{\\text{crit}}, \\cdot)$. This is precisely the relationship we derived in Part 1. Because the metric $g_x$ is positive-definite, the term $-\\frac{1}{2}g_x(v,v)$ is strictly concave, ensuring that this critical point corresponds to a unique global maximum.\n\nThe velocity $v_{\\text{crit}}$ is the vector that corresponds to the covector $p$ under the metric isomorphism. To express $v_{\\text{crit}}$ in terms of $p$, we use the inverse of this isomorphism, which is given by the dual metric $g_x^{-1}$ on the cotangent space $T_{x}^{*}Q$. The dual metric defines a map $p \\mapsto p^{\\sharp}$ from $T_{x}^{*}Q$ to $T_{x}Q$ such that $g_{x}(p^{\\sharp}, v) = p(v)$ for all $v \\in T_xQ$. Comparing this with our critical point condition $g_x(v_{\\text{crit}}, \\delta v) = p(\\delta v)$, we identify $v_{\\text{crit}} = p^{\\sharp}$.\n\nNow we substitute this specific velocity $v_{\\text{crit}}$ back into the expression for $H(x,p)$:\n$$\nH(x,p) = \\left( p(v_{\\text{crit}}) - \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) \\right) + V(x)\n$$\nFrom the condition $p(\\delta v) = g_{x}(v_{\\text{crit}}, \\delta v)$, we can set $\\delta v = v_{\\text{crit}}$ to obtain:\n$$\np(v_{\\text{crit}}) = g_{x}(v_{\\text{crit}}, v_{\\text{crit}})\n$$\nSubstituting this into the expression for $H(x,p)$:\n$$\nH(x,p) = g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) - \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) + V(x)\n$$\n$$\nH(x,p) = \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) + V(x)\n$$\nThe final step is to express the term $g_{x}(v_{\\text{crit}}, v_{\\text{crit}})$ entirely in terms of $p$ and the dual metric $g_{x}^{-1}$. The dual metric is defined as $g_x^{-1}(\\alpha, \\beta) = g_x(\\alpha^{\\sharp}, \\beta^{\\sharp})$ for any $\\alpha, \\beta \\in T_{x}^{*}Q$. Setting $\\alpha = \\beta = p$, we have:\n$$\ng_x^{-1}(p, p) = g_x(p^{\\sharp}, p^{\\sharp})\n$$\nSince we identified $v_{\\text{crit}} = p^{\\sharp}$, it follows that:\n$$\ng_x(v_{\\text{crit}}, v_{\\text{crit}}) = g_x^{-1}(p, p)\n$$\nSubstituting this final piece into our expression for the Hamiltonian gives the desired result:\n$$\nH(x,p) = \\frac{1}{2} g_{x}^{-1}(p,p) + V(x)\n$$\nThis expression for the Hamiltonian is formulated entirely in terms of the position $x$, the momentum $p$, the dual metric $g_{x}^{-1}$, and the potential $V(x)$, as required. The kinetic energy term $\\frac{1}{2}g_x(v,v)$ in the Lagrangian is transformed into the term $\\frac{1}{2}g_x^{-1}(p,p)$ in the Hamiltonian.",
            "answer": "$$\n\\boxed{\\frac{1}{2} g_{x}^{-1}(p,p) + V(x)}\n$$"
        },
        {
            "introduction": "We now apply these principles to a classic problem in geometric control: energy-optimal steering on the rotation group $SO(3)$. This scenario is central to applications in robotics and aerospace engineering, such as controlling satellite attitude. This practice  demonstrates the power of symmetry reduction, showing how the seemingly complex nonlinear dynamics on a Lie group can be solved elegantly by reducing the Pontryagin Maximum Principle to the corresponding Lie algebra, leading to a constant, intuitive control law.",
            "id": "3743884",
            "problem": "Consider the special orthogonal Lie group $SO(3)$ with the left-invariant control-affine dynamics given by $\\dot{R}(t)=R(t)\\,\\widehat{u(t)}$, where $R(t)\\in SO(3)$, $u(t)\\in \\mathbb{R}^{3}$, and the $\\widehat{\\cdot}$ map is the standard Lie algebra isomorphism $\\widehat{(\\cdot)}:\\mathbb{R}^{3}\\to \\mathfrak{so}(3)$ defined by $\\widehat{a}\\,b=a\\times b$ for all $a,b\\in \\mathbb{R}^{3}$. Let the cost functional be the energy\n$$\nJ[u]=\\frac{1}{2}\\int_{0}^{T}\\|u(t)\\|^{2}\\,\\mathrm{d}t,\n$$\nwhere the norm $\\|\\cdot\\|$ is induced by the Euclidean inner product on $\\mathbb{R}^{3}$, which in turn defines a bi-invariant Riemannian metric on $SO(3)$ via left translations. The boundary conditions are $R(0)=I$ and $R(T)=R_{f}$, where $R_{f}\\in SO(3)$ is fixed with principal rotation angle $\\theta\\in (0,\\pi]$ in radians. Assume $T>0$ is fixed.\n\nUsing first principles from the Pontryagin Maximum Principle for optimal control, its reduction to the Lie algebra via left trivialization, and the coadjoint action on $\\mathfrak{so}(3)^{*}$, derive the necessary conditions for optimality for this left-invariant problem. Then, specialize to the given bi-invariant metric and show that any energy-minimizing control must be constant in the body frame. Using only foundational identities for $SO(3)$ and its Lie algebra (in particular, that for a constant body velocity the state trajectory is a one-parameter subgroup and that the principal logarithm of $R_{f}$ exists with axis-angle vector $\\omega\\in \\mathbb{R}^{3}$ satisfying $R_{f}=\\exp(\\widehat{\\omega})$ and $\\|\\omega\\|=\\theta$), determine the minimal energy $J^{\\ast}$ needed to steer $R(0)=I$ to $R(T)=R_{f}$ in the fixed time $T$.\n\nGive your final answer as a single closed-form expression in terms of $\\theta$ and $T$, with $\\theta$ expressed in radians.",
            "solution": "The problem as stated constitutes a valid and well-posed optimal control problem in the context of geometric mechanics. We may therefore proceed with a formal derivation of the solution.\n\nThe problem is to find a control input $u(t) \\in \\mathbb{R}^3$ that minimizes the energy functional\n$$\nJ[u]=\\frac{1}{2}\\int_{0}^{T}\\|u(t)\\|^{2}\\,\\mathrm{d}t\n$$\nsubject to the left-invariant dynamics on the special orthogonal group $SO(3)$\n$$\n\\dot{R}(t)=R(t)\\,\\widehat{u(t)}\n$$\nwith boundary conditions $R(0)=I$ and $R(T)=R_f$. Here, $I$ is the $3 \\times 3$ identity matrix, and $R_f$ is a given final orientation. The notation $\\widehat{(\\cdot)}:\\mathbb{R}^{3}\\to \\mathfrak{so}(3)$ represents the standard Lie algebra isomorphism where $\\mathfrak{so}(3)$ is the Lie algebra of $SO(3)$ consisting of $3 \\times 3$ skew-symmetric matrices. The problem states that the norm $\\|\\cdot\\|$ on $\\mathbb{R}^3$ is Euclidean, which induces a bi-invariant Riemannian metric on $SO(3)$. This corresponds to an Ad-invariant inner product on the Lie algebra $\\mathfrak{so}(3)$.\n\nWe apply the Pontryagin Maximum Principle (PMP). The state is $R \\in SO(3)$. We introduce a costate (or adjoint variable) $P_R(t) \\in T_{R(t)}^*SO(3)$. The Hamiltonian for this system is given by:\n$$\nH(R, P_R, u) = \\langle P_R, \\dot{R} \\rangle - \\frac{1}{2}\\|u\\|^2 = \\langle P_R, R(t)\\,\\widehat{u(t)} \\rangle - \\frac{1}{2}\\|u\\|^2\n$$\nwhere $\\langle \\cdot, \\cdot \\rangle$ denotes the natural pairing between a cotangent space and its tangent space.\n\nDue to the left-invariant structure of the dynamics and cost, it is advantageous to perform a left trivialization. We define the body-fixed costate $\\lambda(t) \\in \\mathfrak{so}(3)^*$ by pulling the costate $P_R$ back to the identity element:\n$$\n\\lambda(t) = (L_{R(t)^{-1}})^* P_{R(t)}\n$$\nThis means that for any $\\xi \\in \\mathfrak{so}(3)$, we have $\\langle \\lambda(t), \\xi \\rangle = \\langle P_{R(t)}, (L_{R(t)})_*\\xi \\rangle = \\langle P_{R(t)}, R(t)\\xi \\rangle$.\nThe Hamiltonian can now be written in terms of this reduced costate:\n$$\nh(\\lambda, u) = \\langle \\lambda, \\widehat{u} \\rangle - \\frac{1}{2}\\|u\\|^2\n$$\nWe can identify the Lie algebra $\\mathfrak{so}(3)$ and its dual $\\mathfrak{so}(3)^*$ with $\\mathbb{R}^3$ via the given bi-invariant metric. The inner product on $\\mathfrak{so}(3)$ corresponding to the Euclidean dot product on $\\mathbb{R}^3$ is $\\langle \\widehat{a}, \\widehat{b} \\rangle = a \\cdot b$. Under this identification, the costate $\\lambda(t)$ is represented by a vector $p(t) \\in \\mathbb{R}^3$, and the pairing $\\langle \\lambda, \\widehat{u} \\rangle$ becomes the dot product $p \\cdot u$. The reduced Hamiltonian is then a function on $\\mathbb{R}^3 \\times \\mathbb{R}^3$:\n$$\nh(p, u) = p(t) \\cdot u(t) - \\frac{1}{2}\\|u(t)\\|^2\n$$\nAccording to the PMP, the optimal control $u^*(t)$ must maximize this Hamiltonian at almost every time $t \\in [0, T]$. The first-order necessary condition for maximality is:\n$$\n\\frac{\\partial h}{\\partial u} = p(t) - u(t) = 0 \\implies u^*(t) = p(t)\n$$\nThe dynamics of the reduced costate $p(t)$ are governed by the Lie-Poisson equation:\n$\\dot{p} = -\\text{ad}_{\\nabla_p h}^* p$.\nIn the context of $\\mathfrak{so}(3) \\cong \\mathbb{R}^3$, this equation takes the form $\\dot{p} = (\\nabla_p h) \\times p$. The gradient of the maximized Hamiltonian $H^*(p) = h(p, u^*(p))$ with respect to $p$ is $\\nabla_p H^* = u$. So, the equation is $\\dot{p} = u \\times p$.\nSubstituting the optimality condition $u(t) = p(t)$ into the costate dynamics, we obtain:\n$\\dot{p}(t) = p(t) \\times p(t) = 0$.\nThis implies that the body-fixed costate vector $p(t)$ must be constant. Let $p(t) = p_0$ for some constant vector $p_0 \\in \\mathbb{R}^3$. Since the optimal control is given by $u^*(t)=p(t)$, the optimal control in the body frame, $u^*(t)$, must also be a constant vector. Let us denote this constant control vector by $u_0$.\n\nWith the constant body-frame control $u_0$, the system dynamics become:\n$$\n\\dot{R}(t) = R(t)\\widehat{u_0}\n$$\nThis is a linear ordinary differential equation with a constant coefficient matrix (in the body frame). Given the initial condition $R(0)=I$, the solution is given by the matrix exponential, which describes a one-parameter subgroup of $SO(3)$:\n$$\nR(t) = \\exp(t\\widehat{u_0})\n$$\nThis trajectory represents a geodesic on $SO(3)$ with respect to the bi-invariant metric.\n\nTo determine the specific constant control $u_0$, we apply the terminal boundary condition at time $t=T$:\n$$\nR(T) = R_f = \\exp(T\\widehat{u_0})\n$$\nUsing the property of the hat map and matrix exponential, this can be written as:\n$$\nR_f = \\exp(\\widehat{Tu_0})\n$$\nThe problem provides that $R_f$ has a principal rotation angle $\\theta \\in (0, \\pi]$ and can be expressed as $R_f = \\exp(\\widehat{\\omega})$, where $\\omega \\in \\mathbb{R}^3$ is the axis-angle vector satisfying $\\|\\omega\\|=\\theta$. The condition $\\theta \\in (0, \\pi]$ ensures that the Lie logarithm is unique (specifically, the principal logarithm).\n\nBy comparing the two exponential representations of $R_f$, we have:\n$$\n\\exp(\\widehat{Tu_0}) = \\exp(\\widehat{\\omega})\n$$\nSince the exponential map $\\exp: \\mathfrak{so}(3) \\to SO(3)$ is injective on the open ball of radius $\\pi$ in $\\mathfrak{so}(3)$, and $\\|\\omega\\|=\\theta \\le \\pi$, we can equate the arguments:\n$$\n\\widehat{Tu_0} = \\widehat{\\omega}\n$$\nAs the hat map is an isomorphism, this implies:\n$$\nTu_0 = \\omega \\implies u_0 = \\frac{\\omega}{T}\n$$\nWe have now found the optimal control $u^*(t) = u_0 = \\frac{\\omega}{T}$. It is constant in the body frame and directs the rotation about the axis of the minimal-angle rotation from $I$ to $R_f$.\n\nFinally, we compute the minimal energy $J^*$ by substituting the optimal control into the cost functional:\n$$\nJ^* = \\frac{1}{2}\\int_{0}^{T}\\|u^*(t)\\|^{2}\\,\\mathrm{d}t = \\frac{1}{2}\\int_{0}^{T}\\left\\|\\frac{\\omega}{T}\\right\\|^{2}\\,\\mathrm{d}t\n$$\nSince the integrand is constant, the integral becomes:\n$$\nJ^* = \\frac{1}{2} \\left\\|\\frac{\\omega}{T}\\right\\|^{2} \\int_{0}^{T} \\mathrm{d}t = \\frac{1}{2} \\frac{\\|\\omega\\|^2}{T^2} T\n$$\nUsing the fact that $\\|\\omega\\|=\\theta$, we get:\n$$\nJ^* = \\frac{1}{2}\\frac{\\theta^2}{T^2}T = \\frac{\\theta^2}{2T}\n$$\nThis is the minimal energy required to steer the system from the identity rotation to the final rotation $R_f$ in time $T$.",
            "answer": "$$\\boxed{\\frac{\\theta^2}{2T}}$$"
        },
        {
            "introduction": "Optimal control theory contains beautiful subtleties, particularly when trajectories are constrained by the system's geometry. This final practice explores the fascinating phenomenon of abnormal extremals, which arise when the control vector fields fail to be 'bracket-generating' at certain points. By analyzing the famous Martinet distribution , you will uncover the geometric reasons for the failure of standard 'normal' extremals and learn how to characterize these singular, yet often optimal, paths.",
            "id": "3743880",
            "problem": "Consider the driftless, control-affine system on the three-dimensional manifold with coordinates $(x,y,z)$, defined by the distribution $\\mathcal{D}=\\operatorname{span}\\{X_{1},X_{2}\\}$ where\n$$\nX_{1}=\\frac{\\partial}{\\partial x}+\\frac{y^{2}}{2}\\,\\frac{\\partial}{\\partial z},\\qquad X_{2}=\\frac{\\partial}{\\partial y},\n$$\nand controls $u=(u_{1},u_{2})\\in \\mathbb{R}^{2}$ enter as $\\dot{q}=u_{1}X_{1}(q)+u_{2}X_{2}(q)$, with $q=(x,y,z)$. Consider the sub-Riemannian energy minimization problem with running Lagrangian $L(u)=\\frac{1}{2}(u_{1}^{2}+u_{2}^{2})$ and fixed endpoints $q(0)=(0,0,0)$ and $q(T)=(L,0,0)$, where $L>0$ is given and $T>0$ is free.\n\nStarting from the definitions of the Pontryagin Maximum Principle (PMP) and the geometric notions of the distribution $\\mathcal{D}$ and its derived flag (Lie brackets of vector fields), do the following:\n\n- Show that any minimizing curve connecting $(0,0,0)$ to $(L,0,0)$ must be confined to the singular set $\\{y=0\\}$ and is an abnormal extremal (that is, the cost multiplier vanishes in the PMP).\n\n- Derive the annihilator $\\operatorname{Ann}(\\mathcal{D})$ of the distribution $\\mathcal{D}$ along the singular set $\\{y=0\\}$ and use the PMP abnormality condition together with the Goh condition to determine the corresponding costate one-form $\\alpha(t)\\in \\operatorname{Ann}(\\mathcal{D}_{q(t)})$ along the abnormal minimizer, up to nonzero scaling.\n\n- Explain the geometric reason for the abnormality in terms of the failure of bracket-generating growth of the derived flag of $\\mathcal{D}$ along $\\{y=0\\}$ and the resulting loss of surjectivity of the endpoint map.\n\nYour final answer must be the single closed-form expression for the abnormal costate one-form $\\alpha(t)$ along the minimizer, expressed as a one-form in the coordinate basis $\\{dx,dy,dz\\}$, up to nonzero scaling. No numerical rounding is required and no units should be included in your final expression.",
            "solution": "We begin from fundamentals. The Pontryagin Maximum Principle (PMP) for an energy-minimization problem with Lagrangian $L(u)=\\frac{1}{2}(u_{1}^{2}+u_{2}^{2})$ and dynamics $\\dot{q}=u_{1}X_{1}(q)+u_{2}X_{2}(q)$ yields the existence of a nontrivial costate $p(t)\\in T^{*}_{q(t)}M$ and a multiplier $\\nu\\leq 0$ such that the Hamiltonian\n$$\nH(q,p,u,\\nu)=\\langle p,\\,u_{1}X_{1}(q)+u_{2}X_{2}(q)\\rangle-\\nu\\frac{1}{2}\\big(u_{1}^{2}+u_{2}^{2}\\big)\n$$\nis maximized with respect to $u$ almost everywhere, together with the adjoint dynamics $\\dot{p}=-\\frac{\\partial H}{\\partial q}$ and the nontriviality condition $(p,\\nu)\\neq (0,0)$. In the normal case, one has $\\nu<0$ and maximization yields $u_{i}=\\frac{1}{-\\nu}\\langle p,X_{i}\\rangle$. In the abnormal case, $\\nu=0$, and maximizing $H$ over unbounded controls forces $\\langle p,X_{i}\\rangle=0$ for all controlled directions $X_{i}$ (otherwise $H$ would be unbounded above). Therefore, abnormal extremals satisfy $p(t)\\in \\operatorname{Ann}(\\mathcal{D}_{q(t)})$ almost everywhere.\n\nWe now analyze the geometry of the given distribution. The vector fields are\n$$\nX_{1}=\\frac{\\partial}{\\partial x}+\\frac{y^{2}}{2}\\,\\frac{\\partial}{\\partial z},\\qquad X_{2}=\\frac{\\partial}{\\partial y}.\n$$\nCompute the Lie bracket to understand the derived flag:\n$$\n[X_{1},X_{2}]=\\Big[\\frac{\\partial}{\\partial x}+\\frac{y^{2}}{2}\\,\\frac{\\partial}{\\partial z},\\,\\frac{\\partial}{\\partial y}\\Big]\n=\\Big[\\frac{y^{2}}{2}\\,\\frac{\\partial}{\\partial z},\\,\\frac{\\partial}{\\partial y}\\Big]\n= -\\frac{\\partial}{\\partial y}\\Big(\\frac{y^{2}}{2}\\Big)\\,\\frac{\\partial}{\\partial z}\n= -y\\,\\frac{\\partial}{\\partial z}.\n$$\nThus, away from the singular set $\\{y=0\\}$, the derived flag $\\mathcal{D}^{2}=\\mathcal{D}+[\\mathcal{D},\\mathcal{D}]$ spans $\\frac{\\partial}{\\partial x},\\frac{\\partial}{\\partial y},\\frac{\\partial}{\\partial z}$ and is bracket-generating. However, along the singular set $\\{y=0\\}$, one has $[X_{1},X_{2}]=0$, so $\\mathcal{D}^{2}=\\mathcal{D}$ remains rank $2$ and fails to generate $\\frac{\\partial}{\\partial z}$. This is the defining feature of the Martinet-type singularity, and it implies that the endpoint map loses surjectivity there, which is precisely the geometric mechanism that allows abnormal extremals.\n\nWe next observe that the boundary conditions $q(0)=(0,0,0)$, $q(T)=(L,0,0)$ enforce $y(t)\\equiv 0$ and $z(t)\\equiv 0$ along any minimizing trajectory. To see this, note the dynamics,\n$$\n\\dot{x}=u_{1},\\qquad \\dot{y}=u_{2},\\qquad \\dot{z}=\\frac{y^{2}}{2}\\,u_{1}.\n$$\nA curve that connects $(0,0,0)$ to $(L,0,0)$ can be achieved by setting $u_{2}(t)=0$ for all $t$, so $y(t)=0$ for all $t$ and thus $\\dot{z}(t)=0$, yielding $z(t)\\equiv 0$. Among such curves, the energy $\\int_{0}^{T}\\frac{1}{2}u_{1}(t)^{2}\\,dt$ is minimized by taking $u_{1}$ constant in time (for fixed $T$), and in the free-time energy minimization, this reduces to straight motion in $x$ with $y=0$. Crucially, any normal extremal in this geometry that attempts to maximize $H$ with $\\nu<0$ would enforce controls $u_{i}\\propto \\langle p,X_{i}\\rangle$. At $y=0$, the field $X_{1}$ loses its $z$-component, and the derived flag does not recover $\\frac{\\partial}{\\partial z}$; the normal PMP equations generically push trajectories off the singular set to generate necessary directions via brackets. Since our endpoints lie entirely in $\\{y=0\\}$ with no $z$ displacement, any normal extremal leaving $\\{y=0\\}$ would incur unnecessary energy, whereas staying in $\\{y=0\\}$ forces the normal maximizer coefficients $\\langle p,X_{i}\\rangle$ into a contradiction (the maximized Hamiltonian would be ill-defined unless they vanish). Therefore, all minimizers for these endpoints are confined to $\\{y=0\\}$ and are abnormal.\n\nWe now compute the annihilator of $\\mathcal{D}$ along the singular set. A general one-form is $\\alpha=a\\,dx+b\\,dy+c\\,dz$. The annihilator condition requires $\\alpha(X_{1})=0$ and $\\alpha(X_{2})=0$. Compute\n$$\n\\alpha(X_{1})=a+c\\,\\frac{y^{2}}{2},\\qquad \\alpha(X_{2})=b.\n$$\nAlong the singular set $\\{y=0\\}$, these reduce to\n$$\n\\alpha(X_{1})=a,\\qquad \\alpha(X_{2})=b.\n$$\nThus, at $y=0$, the conditions $\\alpha(X_{1})=\\alpha(X_{2})=0$ imply $a=0$ and $b=0$, and $\\alpha=c\\,dz$. Therefore,\n$$\n\\operatorname{Ann}(\\mathcal{D})\\big|_{y=0}=\\operatorname{span}\\{dz\\}.\n$$\nFor abnormal extremals, PMP requires $p(t)\\in \\operatorname{Ann}(\\mathcal{D}_{q(t)})$ almost everywhere; hence, along the minimizer with $y(t)=0$, one has $p(t)=\\lambda(t)\\,dz$ for some scalar function $\\lambda(t)$ that is nonzero almost everywhere (by nontriviality). The Goh condition (a second-order necessary condition for optimality of abnormal extremals) further requires that the costate annihilates the first derived bracket along the abnormal extremal. Since $[X_{1},X_{2}]=-y\\,\\frac{\\partial}{\\partial z}$ vanishes on $y=0$, this condition is automatically satisfied. Equivalently, along $y=0$ the entire derived flag coincides with $\\mathcal{D}$, so any $\\alpha$ in $\\operatorname{Ann}(\\mathcal{D})$ already annihilates $\\mathcal{D}^{2}$.\n\nTherefore, the abnormal costate one-form along the minimizer is unique up to nonzero scaling and equals $dz$. Choosing the canonical representative with unit scaling gives\n$$\n\\alpha(t)=dz\\quad\\text{for all }t.\n$$\nGeometrically, the reason all minimizers are abnormal for these endpoints is that the distribution $\\mathcal{D}$ fails to be bracket-generating along the singular set $\\{y=0\\}$: the derived flag does not produce $\\frac{\\partial}{\\partial z}$ there, making the endpoint map singular and forcing the PMP maximization in the normal case to fail unless the costate annihilates $\\mathcal{D}$, i.e., the abnormal case. The minimizer remains in $\\{y=0\\}$, where $\\operatorname{Ann}(\\mathcal{D})$ is one-dimensional and spanned by $dz$, yielding the abnormal costate as above.\n\nThe required final expression for the abnormal costate one-form along the minimizer, up to nonzero scaling, is $dz$.",
            "answer": "$$\\boxed{dz}$$"
        }
    ]
}