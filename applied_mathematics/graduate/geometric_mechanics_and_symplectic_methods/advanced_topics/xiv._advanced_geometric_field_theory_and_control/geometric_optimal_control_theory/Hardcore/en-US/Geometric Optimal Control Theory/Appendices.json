{
    "hands_on_practices": [
        {
            "introduction": "The Pontryagin Maximum Principle is naturally formulated in the language of Hamiltonian mechanics. This first exercise provides essential practice in translating a system from the more familiar Lagrangian framework, based on configuration and velocity, to the Hamiltonian one, based on position and momentum. By deriving the Hamiltonian from a general mechanical Lagrangian, you will solidify your understanding of the Legendre transform, the critical bridge connecting these two perspectives .",
            "id": "3743856",
            "problem": "Consider a smooth, connected, finite-dimensional configuration manifold $Q$ equipped with a Riemannian metric $g$, which assigns to each point $x \\in Q$ a positive-definite bilinear form $g_{x}: T_{x}Q \\times T_{x}Q \\to \\mathbb{R}$. Let $V: Q \\to \\mathbb{R}$ be a smooth potential function, and consider the mechanical Lagrangian $L: TQ \\to \\mathbb{R}$ given by $L(x,v) = \\frac{1}{2} g_{x}(v,v) - V(x)$ for $(x,v) \\in TQ$. Use the foundational definition of the fiber derivative of the Lagrangian with respect to the velocity, namely, for each fixed $x$, the derivative $d_{v}L(x,v) \\in T_{x}^{*}Q$ satisfies $d_{v}L(x,v)\\cdot \\delta v = \\frac{d}{d\\epsilon}\\big|_{\\epsilon=0} L(x,v + \\epsilon \\delta v)$ for all $\\delta v \\in T_{x}Q$. Also use the definition of the fiberwise Legendre transform from $TQ$ to $T^{*}Q$, which associates to $(x,v)$ the covector $p = d_{v}L(x,v) \\in T_{x}^{*}Q$, and defines the Hamiltonian $H: T^{*}Q \\to \\mathbb{R}$ by\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - L(x,v) \\right).\n$$\nStarting strictly from these base definitions and the positive-definiteness of $g_{x}$, derive the explicit expression of $p$ in terms of $g_{x}$ and $v$, and compute the Hamiltonian $H(x,p)$ entirely in terms of $x$, $p$, the dual metric $g_{x}^{-1}: T_{x}^{*}Q \\times T_{x}^{*}Q \\to \\mathbb{R}$, and $V(x)$. Your final answer must be a single analytic expression involving only $x$, $p$, $g_{x}^{-1}$, and $V(x)$, with no remaining dependence on $v$. No rounding is required and no physical units are involved. Express your final answer as a closed-form analytic expression.",
            "solution": "The problem statement is a well-posed and fundamental exercise in geometric mechanics. It asks for the derivation of the Hamiltonian $H$ for a mechanical system from the Lagrangian $L$ using the Legendre transformation. All definitions and conditions are standard, consistent, and mathematically sound. We shall proceed with the derivation.\n\nThe problem is divided into two parts: first, finding the relationship between the momentum $p$ and the velocity $v$, and second, using this relationship to compute the Hamiltonian $H(x,p)$.\n\n**Part 1: Derivation of the momentum $p$**\n\nWe are given the Lagrangian $L: TQ \\to \\mathbb{R}$ for a mechanical system on a configuration manifold $Q$ with a Riemannian metric $g$:\n$$\nL(x,v) = \\frac{1}{2} g_{x}(v,v) - V(x)\n$$\nwhere $(x,v) \\in TQ$. The momentum $p \\in T_{x}^{*}Q$ is defined as the fiber derivative of $L$ with respect to $v$. The definition provided is that for any variation $\\delta v \\in T_{x}Q$, the action of the covector $p = d_{v}L(x,v)$ on $\\delta v$ is given by:\n$$\np(\\delta v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} L(x,v + \\epsilon \\delta v)\n$$\nWe substitute the expression for $L$ into this definition. The potential $V(x)$ is independent of the velocity $v$, so it vanishes upon differentiation with respect to $v$.\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} g_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) - V(x)\n$$\nUsing the bilinearity of the metric $g_{x}$, we expand the quadratic term:\n$$\ng_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) = g_{x}(v,v) + g_{x}(v, \\epsilon \\delta v) + g_{x}(\\epsilon \\delta v, v) + g_{x}(\\epsilon \\delta v, \\epsilon \\delta v)\n$$\nSince $g_x$ is a symmetric bilinear form, $g_x(v, \\delta v) = g_x(\\delta v, v)$. The expression becomes:\n$$\ng_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) = g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v)\n$$\nSubstituting this back into the expression for $L$:\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} \\left( g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v) \\right) - V(x)\n$$\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} g_{x}(v,v) + \\epsilon g_{x}(v, \\delta v) + \\frac{1}{2} \\epsilon^{2} g_{x}(\\delta v, \\delta v) - V(x)\n$$\nNow, we differentiate with respect to $\\epsilon$:\n$$\n\\frac{d}{d\\epsilon} L(x,v + \\epsilon \\delta v) = g_{x}(v, \\delta v) + \\epsilon g_{x}(\\delta v, \\delta v)\n$$\nEvaluating this derivative at $\\epsilon=0$:\n$$\n\\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} L(x,v + \\epsilon \\delta v) = g_{x}(v, \\delta v)\n$$\nTherefore, the defining relation for the momentum $p$ is:\n$$\np(\\delta v) = g_{x}(v, \\delta v) \\quad \\text{for all } \\delta v \\in T_{x}Q\n$$\nThis equation provides the explicit relationship between the momentum covector $p \\in T_x^*Q$ and the velocity vector $v \\in T_xQ$. It states that the covector $p$ is the image of the vector $v$ under the musical isomorphism $v \\mapsto v^{\\flat} = g_{x}(v, \\cdot)$ induced by the metric.\n\n**Part 2: Computation of the Hamiltonian $H(x,p)$**\n\nThe Hamiltonian $H: T^{*}Q \\to \\mathbb{R}$ is defined by the Legendre transform of the Lagrangian:\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - L(x,v) \\right)\n$$\nWe substitute the expression for $L(x,v)$ into this definition:\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - \\left(\\frac{1}{2} g_{x}(v,v) - V(x)\\right) \\right)\n$$\nThe potential $V(x)$ does not depend on $v$, so it can be moved outside the supremum:\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - \\frac{1}{2} g_{x}(v,v) \\right) + V(x)\n$$\nLet the function to be maximized be $f(v) = p(v) - \\frac{1}{2} g_{x}(v,v)$. To find the velocity $v_{\\text{crit}}$ that maximizes this function, we must find the critical point where its derivative is zero. The derivative of $f(v)$ in an arbitrary direction $\\delta v \\in T_{x}Q$ is:\n$$\nd_{v}f(v) \\cdot \\delta v = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} f(v + \\epsilon\\delta v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\left( p(v + \\epsilon\\delta v) - \\frac{1}{2} g_{x}(v + \\epsilon\\delta v, v + \\epsilon\\delta v) \\right)\n$$\nUsing the linearity of $p$ and the expansion of the metric term from Part 1:\n$$\nd_{v}f(v) \\cdot \\delta v = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\left( p(v) + \\epsilon p(\\delta v) - \\frac{1}{2} \\left( g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v) \\right) \\right)\n$$\n$$\nd_{v}f(v) \\cdot \\delta v = p(\\delta v) - g_{x}(v, \\delta v)\n$$\nThe critical point $v_{\\text{crit}}$ is where this derivative vanishes for all directions $\\delta v$:\n$$\np(\\delta v) - g_{x}(v_{\\text{crit}}, \\delta v) = 0 \\quad \\text{for all } \\delta v \\in T_{x}Q\n$$\nThis implies that the covector $p$ is identical to the covector $g_{x}(v_{\\text{crit}}, \\cdot)$. This is precisely the relationship we derived in Part 1. Because the metric $g_x$ is positive-definite, the term $-\\frac{1}{2}g_x(v,v)$ is strictly concave, ensuring that this critical point corresponds to a unique global maximum.\n\nThe velocity $v_{\\text{crit}}$ is the vector that corresponds to the covector $p$ under the metric isomorphism. To express $v_{\\text{crit}}$ in terms of $p$, we use the inverse of this isomorphism, which is given by the dual metric $g_{x}^{-1}$ on the cotangent space $T_{x}^{*}Q$. The dual metric defines a map $p \\mapsto p^{\\sharp}$ from $T_{x}^{*}Q$ to $T_{x}Q$ such that $g_{x}(p^{\\sharp}, v) = p(v)$ for all $v \\in T_xQ$. Comparing this with our critical point condition $g_x(v_{\\text{crit}}, \\delta v) = p(\\delta v)$, we identify $v_{\\text{crit}} = p^{\\sharp}$.\n\nNow we substitute this specific velocity $v_{\\text{crit}}$ back into the expression for $H(x,p)$:\n$$\nH(x,p) = \\left( p(v_{\\text{crit}}) - \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) \\right) + V(x)\n$$\nFrom the condition $p(\\delta v) = g_{x}(v_{\\text{crit}}, \\delta v)$, we can set $\\delta v = v_{\\text{crit}}$ to obtain:\n$$\np(v_{\\text{crit}}) = g_{x}(v_{\\text{crit}}, v_{\\text{crit}})\n$$\nSubstituting this into the expression for $H(x,p)$:\n$$\nH(x,p) = g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) - \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) + V(x)\n$$\n$$\nH(x,p) = \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) + V(x)\n$$\nThe final step is to express the term $g_{x}(v_{\\text{crit}}, v_{\\text{crit}})$ entirely in terms of $p$ and the dual metric $g_{x}^{-1}$. The dual metric is defined as $g_{x}^{-1}(\\alpha, \\beta) = g_{x}(\\alpha^{\\sharp}, \\beta^{\\sharp})$ for any $\\alpha, \\beta \\in T_{x}^{*}Q$. Setting $\\alpha = \\beta = p$, we have:\n$$\ng_{x}^{-1}(p, p) = g_{x}(p^{\\sharp}, p^{\\sharp})\n$$\nSince we identified $v_{\\text{crit}} = p^{\\sharp}$, it follows that:\n$$\ng_{x}(v_{\\text{crit}}, v_{\\text{crit}}) = g_{x}^{-1}(p, p)\n$$\nSubstituting this final piece into our expression for the Hamiltonian gives the desired result:\n$$\nH(x,p) = \\frac{1}{2} g_{x}^{-1}(p,p) + V(x)\n$$\nThis expression for the Hamiltonian is formulated entirely in terms of the position $x$, the momentum $p$, the dual metric $g_{x}^{-1}$, and the potential $V(x)$, as required. The kinetic energy term $\\frac{1}{2}g_x(v,v)$ in the Lagrangian is transformed into the term $\\frac{1}{2}g_x^{-1}(p,p)$ in the Hamiltonian.",
            "answer": "$$\n\\boxed{\\frac{1}{2} g_{x}^{-1}(p,p) + V(x)}\n$$"
        },
        {
            "introduction": "A primary question in control theory is whether a system has the capacity to reach desired states from a given starting point. This practice delves into the core geometric concept of controllability by tasking you with computing the accessibility distribution for a control system. You will see firsthand how the Lie brackets of the control vector fields can generate motion in directions not directly actuated, a fundamental principle underpinning nonlinear control theory .",
            "id": "3743840",
            "problem": "Consider the cotangent bundle $T^{\\ast}\\mathbb{R}^{2}$ with canonical coordinates $(q_{1},q_{2},p_{1},p_{2})$ and canonical symplectic form $\\omega = dq_{1}\\wedge dp_{1} + dq_{2}\\wedge dp_{2}$. Let $X_{H}$ denote the Hamiltonian vector field associated to a smooth function $H:T^{\\ast}\\mathbb{R}^{2}\\to\\mathbb{R}$, defined implicitly by the relation $i_{X_{H}}\\omega = dH$, where $i_{X_{H}}$ is interior contraction. Consider the driftless control-affine system on $T^{\\ast}\\mathbb{R}^{2}$ of the form $\\dot{z} = u_{1} g_{1}(z) + u_{2} g_{2}(z) + u_{3} g_{3}(z)$ with control vector fields given by the Hamiltonian vector fields\n$g_{1} = X_{h_{1}}$, $g_{2} = X_{h_{2}}$, $g_{3} = X_{h_{3}}$, where $h_{1}(q,p) = p_{1}$, $h_{2}(q,p) = q_{1}p_{2}$, and $h_{3}(q,p) = \\frac{1}{2}q_{2}^{2}$.\n\nUsing only fundamental definitions of symplectic geometry and Lie brackets of vector fields, compute the accessibility distribution $\\mathcal{D}$ generated by $\\{g_{1},g_{2},g_{3}\\}$ and all their iterated Lie brackets, and determine the rank of $\\mathcal{D}$ at the point $(q_{1},q_{2},p_{1},p_{2}) = (0,1,0,1)$. Express your final answer as a single integer equal to the rank of $\\mathcal{D}$ at that point.",
            "solution": "The problem requires the computation of the rank of the accessibility distribution $\\mathcal{D}$ for a given control system on the cotangent bundle $T^{\\ast}\\mathbb{R}^{2}$. The rank is to be determined at the specific point $z_0 = (q_{1},q_{2},p_{1},p_{2}) = (0,1,0,1)$. The accessibility distribution $\\mathcal{D}$ at a point is the subspace of the tangent space spanned by the control vector fields and all their iterated Lie brackets, evaluated at that point. The rank of $\\mathcal{D}$ is the dimension of this subspace.\n\nThe state space is the $4$-dimensional manifold $T^{\\ast}\\mathbb{R}^{2}$ with canonical coordinates $(q_{1},q_{2},p_{1},p_{2})$. The canonical symplectic form is given by $\\omega = dq_{1}\\wedge dp_{1} + dq_{2}\\wedge dp_{2}$.\n\nA Hamiltonian vector field $X_{H}$ corresponding to a smooth function $H(q,p)$ is defined by the relation $i_{X_{H}}\\omega = dH$. In the given canonical coordinates, this yields the explicit formula:\n$$X_{H} = \\sum_{i=1}^{2} \\left( \\frac{\\partial H}{\\partial p_{i}} \\frac{\\partial}{\\partial q_{i}} - \\frac{\\partial H}{\\partial q_{i}} \\frac{\\partial}{\\partial p_{i}} \\right)$$\n\nThe control vector fields are given as $g_{1} = X_{h_{1}}$, $g_{2} = X_{h_{2}}$, and $g_{3} = X_{h_{3}}$, where the Hamiltonian functions are:\n$h_{1}(q,p) = p_{1}$\n$h_{2}(q,p) = q_{1}p_{2}$\n$h_{3}(q,p) = \\frac{1}{2}q_{2}^{2}$\n\nThe accessibility distribution $\\mathcal{D}$ is the distribution spanned by the Lie algebra generated by $\\{g_1, g_2, g_3\\}$, i.e., $\\mathcal{D} = \\text{span}\\{g_1, g_2, g_3, [g_i, g_j], [g_i, [g_j, g_k]], \\dots \\}$. To find the rank at $z_0$, we will compute these vector fields, evaluate them at $z_0$, and determine the dimension of the vector space they span.\n\nFirst, we compute the explicit expressions for the vector fields $g_{1}$, $g_{2}$, and $g_{3}$.\n\nFor $g_{1} = X_{h_{1}}$ with $h_{1} = p_{1}$:\n$\\frac{\\partial h_{1}}{\\partial p_{1}} = 1$. All other partial derivatives are zero.\n$$g_{1} = \\frac{\\partial h_{1}}{\\partial p_{1}} \\frac{\\partial}{\\partial q_{1}} = \\frac{\\partial}{\\partial q_{1}}$$\nIn vector form with respect to the basis $(\\frac{\\partial}{\\partial q_{1}}, \\frac{\\partial}{\\partial q_{2}}, \\frac{\\partial}{\\partial p_{1}}, \\frac{\\partial}{\\partial p_{2}})$, this is $g_{1} \\equiv (1,0,0,0)^{T}$.\n\nFor $g_{2} = X_{h_{2}}$ with $h_{2} = q_{1}p_{2}$:\n$\\frac{\\partial h_{2}}{\\partial q_{1}} = p_{2}$ and $\\frac{\\partial h_{2}}{\\partial p_{2}} = q_{1}$.\n$$g_{2} = \\frac{\\partial h_{2}}{\\partial p_{2}} \\frac{\\partial}{\\partial q_{2}} - \\frac{\\partial h_{2}}{\\partial q_{1}} \\frac{\\partial}{\\partial p_{1}} = q_{1}\\frac{\\partial}{\\partial q_{2}} - p_{2}\\frac{\\partial}{\\partial p_{1}}$$\nIn vector form, $g_{2} \\equiv (0, q_{1}, -p_{2}, 0)^{T}$.\n\nFor $g_{3} = X_{h_{3}}$ with $h_{3} = \\frac{1}{2}q_{2}^{2}$:\n$\\frac{\\partial h_{3}}{\\partial q_{2}} = q_{2}$.\n$$g_{3} = -\\frac{\\partial h_{3}}{\\partial q_{2}} \\frac{\\partial}{\\partial p_{2}} = -q_{2}\\frac{\\partial}{\\partial p_{2}}$$\nIn vector form, $g_{3} \\equiv (0, 0, 0, -q_{2})^{T}$.\n\nNext, we evaluate these vector fields at the point $z_0 = (q_1,q_2,p_1,p_2) = (0,1,0,1)$:\n$v_{1} = g_{1}(z_0) = (1,0,0,0)^{T}$\n$v_{2} = g_{2}(z_0) = (0, 0, -1, 0)^{T}$\n$v_{3} = g_{3}(z_0) = (0, 0, 0, -1)^{T}$\n\nThese three vectors are clearly linearly independent. Thus, the rank of $\\mathcal{D}$ at $z_0$ is at least $3$. To check if the rank is $4$, we need to compute iterated Lie brackets.\n\nA fundamental property of Hamiltonian mechanics relates the Lie bracket of two Hamiltonian vector fields, $[X_f, X_g]$, to the Hamiltonian vector field of their Poisson bracket, $X_{\\{f,g\\}}$. The Poisson bracket is defined as:\n$$\\{f,g\\} = \\sum_{i=1}^{2} \\left( \\frac{\\partial f}{\\partial q_{i}} \\frac{\\partial g}{\\partial p_{i}} - \\frac{\\partial f}{\\partial p_{i}} \\frac{\\partial g}{\\partial q_{i}} \\right)$$\nThe relation is given by $[X_f, X_g] = -X_{\\{f,g\\}}$. We will use this to simplify the computation of Lie brackets.\n\nLet's compute the Lie bracket $[g_1, g_2] = [X_{h_1}, X_{h_2}]$. We first compute the Poisson bracket $\\{h_1, h_2\\}$:\n$$\\{h_{1}, h_{2}\\} = \\{p_{1}, q_{1}p_{2}\\} = \\frac{\\partial p_{1}}{\\partial q_{1}}\\frac{\\partial (q_{1}p_{2})}{\\partial p_{1}} - \\frac{\\partial p_{1}}{\\partial p_{1}}\\frac{\\partial (q_{1}p_{2})}{\\partial q_{1}} = (0)(0) - (1)(p_{2}) = -p_{2}$$\nSo, $[g_1, g_2] = -X_{\\{h_1, h_2\\}} = -X_{-p_2}$.\nLet $h_{12} = -p_2$. The Hamiltonian vector field $X_{h_{12}}$ is:\n$$X_{-p_2} = \\frac{\\partial(-p_2)}{\\partial p_2} \\frac{\\partial}{\\partial q_2} - \\frac{\\partial(-p_2)}{\\partial q_2} \\frac{\\partial}{\\partial p_2} = (-1)\\frac{\\partial}{\\partial q_2} - (0)\\frac{\\partial}{\\partial p_2} = -\\frac{\\partial}{\\partial q_2}$$\nTherefore, the Lie bracket is:\n$$[g_{1}, g_{2}] = -X_{-p_{2}} = -(-\\frac{\\partial}{\\partial q_{2}}) = \\frac{\\partial}{\\partial q_{2}}$$\nLet's call this new vector field $g_4 = [g_1, g_2]$. In vector form, $g_4 \\equiv (0,1,0,0)^T$. This vector field is constant.\n\nNow, we evaluate $g_4$ at $z_0$:\n$v_{4} = g_{4}(z_0) = (0,1,0,0)^{T}$\n\nWe now have a set of four vectors evaluated at $z_0$:\n$v_{1} = (1,0,0,0)^{T}$\n$v_{2} = (0,0,-1,0)^{T}$\n$v_{3} = (0,0,0,-1)^{T}$\n$v_{4} = (0,1,0,0)^{T}$\n\nTo determine the rank of the distribution at $z_0$, we check for the linear independence of these four vectors. We can form a matrix whose columns (or rows) are these vectors and compute its determinant:\n$$ M = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & -1 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\end{pmatrix} $$\nThe determinant can be computed by cofactor expansion along the first row:\n$$\\det(M) = 1 \\cdot \\det \\begin{pmatrix} 0 & 0 & 1 \\\\ -1 & 0 & 0 \\\\ 0 & -1 & 0 \\end{pmatrix} = 1 \\cdot \\left( 1 \\cdot \\det \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\right) = (-1)(-1) = 1$$\nSince the determinant is non-zero ($\\det(M)=1$), the four vectors $v_1, v_2, v_3, v_4$ are linearly independent. These four vectors belong to the tangent space $T_{z_0}(T^{\\ast}\\mathbb{R}^{2})$, which is a $4$-dimensional vector space. As we have found four linearly independent vectors spanning the distribution at this point, they must form a basis for the entire tangent space.\n\nTherefore, the rank of the accessibility distribution $\\mathcal{D}$ at the point $(0,1,0,1)$ is $4$. We do not need to compute further Lie brackets as the maximal possible rank has been achieved.",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "The true power of geometric methods shines when applied to systems evolving on non-Euclidean spaces, such as Lie groups. This exercise challenges you to find an energy-minimizing path on the rotation group $\\mathrm{SO}(3)$, a problem central to aerospace and robotics. By leveraging the system's left-invariant structure to reduce the Pontryagin Maximum Principle to the Lie algebra, you will discover that the optimal trajectory is a geodesic, providing a beautiful link between optimal control and differential geometry .",
            "id": "3743884",
            "problem": "Consider the special orthogonal Lie group $\\mathrm{SO}(3)$ with the left-invariant control-affine dynamics given by $\\dot{R}(t)=R(t)\\,\\widehat{u(t)}$, where $R(t)\\in \\mathrm{SO}(3)$, $u(t)\\in \\mathbb{R}^{3}$, and the $\\widehat{\\cdot}$ map is the standard Lie algebra isomorphism $\\widehat{(\\cdot)}:\\mathbb{R}^{3}\\to \\mathfrak{so}(3)$ defined by $\\widehat{a}\\,b=a\\times b$ for all $a,b\\in \\mathbb{R}^{3}$. Let the cost functional be the energy\n$$\nJ[u]=\\frac{1}{2}\\int_{0}^{T}\\|u(t)\\|^{2}\\,\\mathrm{d}t,\n$$\nwhere the norm $\\|\\cdot\\|$ is induced by the Euclidean inner product on $\\mathbb{R}^{3}$, which in turn defines a bi-invariant Riemannian metric on $\\mathrm{SO}(3)$ via left translations. The boundary conditions are $R(0)=I$ and $R(T)=R_{f}$, where $R_{f}\\in \\mathrm{SO}(3)$ is fixed with principal rotation angle $\\theta\\in (0,\\pi]$ in radians. Assume $T>0$ is fixed.\n\nUsing first principles from the Pontryagin Maximum Principle for optimal control, its reduction to the Lie algebra via left trivialization, and the coadjoint action on $\\mathfrak{so}(3)^{*}$, derive the necessary conditions for optimality for this left-invariant problem. Then, specialize to the given bi-invariant metric and show that any energy-minimizing control must be constant in the body frame. Using only foundational identities for $\\mathrm{SO}(3)$ and its Lie algebra (in particular, that for a constant body velocity the state trajectory is a one-parameter subgroup and that the principal logarithm of $R_{f}$ exists with axis-angle vector $\\omega\\in \\mathbb{R}^{3}$ satisfying $R_{f}=\\exp(\\widehat{\\omega})$ and $\\|\\omega\\|=\\theta$), determine the minimal energy $J^{\\ast}$ needed to steer $R(0)=I$ to $R(T)=R_{f}$ in the fixed time $T$.\n\nGive your final answer as a single closed-form expression in terms of $\\theta$ and $T$, with $\\theta$ expressed in radians.",
            "solution": "The problem as stated constitutes a valid and well-posed optimal control problem in the context of geometric mechanics. We may therefore proceed with a formal derivation of the solution.\n\nThe problem is to find a control input $u(t) \\in \\mathbb{R}^3$ that minimizes the energy functional\n$$\nJ[u]=\\frac{1}{2}\\int_{0}^{T}\\|u(t)\\|^{2}\\,\\mathrm{d}t\n$$\nsubject to the left-invariant dynamics on the special orthogonal group $\\mathrm{SO}(3)$\n$$\n\\dot{R}(t)=R(t)\\,\\widehat{u(t)}\n$$\nwith boundary conditions $R(0)=I$ and $R(T)=R_f$. Here, $I$ is the $3 \\times 3$ identity matrix, and $R_f$ is a given final orientation. The notation $\\widehat{(\\cdot)}:\\mathbb{R}^{3}\\to \\mathfrak{so}(3)$ represents the standard Lie algebra isomorphism where $\\mathfrak{so}(3)$ is the Lie algebra of $\\mathrm{SO}(3)$ consisting of $3 \\times 3$ skew-symmetric matrices. The problem states that the norm $\\|\\cdot\\|$ on $\\mathbb{R}^3$ is Euclidean, which induces a bi-invariant Riemannian metric on $\\mathrm{SO}(3)$. This corresponds to an Ad-invariant inner product on the Lie algebra $\\mathfrak{so}(3)$.\n\nWe apply the Pontryagin Maximum Principle (PMP). The state is $R \\in \\mathrm{SO}(3)$. We introduce a costate (or adjoint variable) $P_R(t) \\in T_{R(t)}^*\\mathrm{SO}(3)$. The Hamiltonian for this system is given by:\n$$\nH(R, P_R, u) = \\langle P_R, \\dot{R} \\rangle - \\frac{1}{2}\\|u\\|^2 = \\langle P_R, R(t)\\,\\widehat{u(t)} \\rangle - \\frac{1}{2}\\|u\\|^2\n$$\nwhere $\\langle \\cdot, \\cdot \\rangle$ denotes the natural pairing between a cotangent space and its tangent space.\n\nDue to the left-invariant structure of the dynamics and cost, it is advantageous to perform a left trivialization. We define the body-fixed costate $\\lambda(t) \\in \\mathfrak{so}(3)^*$ by pulling the costate $P_R$ back to the identity element:\n$$\n\\lambda(t) = (L_{R(t)^{-1}})^* P_{R(t)}\n$$\nThis means that for any $\\xi \\in \\mathfrak{so}(3)$, we have $\\langle \\lambda(t), \\xi \\rangle = \\langle P_{R(t)}, (L_{R(t)})_*\\xi \\rangle = \\langle P_{R(t)}, R(t)\\xi \\rangle$.\nThe Hamiltonian can now be written in terms of this reduced costate:\n$$\nh(\\lambda, u) = \\langle \\lambda, \\widehat{u} \\rangle - \\frac{1}{2}\\|u\\|^2\n$$\nWe can identify the Lie algebra $\\mathfrak{so}(3)$ and its dual $\\mathfrak{so}(3)^*$ with $\\mathbb{R}^3$ via the given bi-invariant metric. The inner product on $\\mathfrak{so}(3)$ corresponding to the Euclidean dot product on $\\mathbb{R}^3$ is $\\langle \\widehat{a}, \\widehat{b} \\rangle = a \\cdot b$. Under this identification, the costate $\\lambda(t)$ is represented by a vector $p(t) \\in \\mathbb{R}^3$, and the pairing $\\langle \\lambda, \\widehat{u} \\rangle$ becomes the dot product $p \\cdot u$. The reduced Hamiltonian is then a function on $\\mathbb{R}^3 \\times \\mathbb{R}^3$:\n$$\nh(p, u) = p(t) \\cdot u(t) - \\frac{1}{2}\\|u(t)\\|^2\n$$\nAccording to the PMP, the optimal control $u^*(t)$ must maximize this Hamiltonian at almost every time $t \\in [0, T]$. The first-order necessary condition for maximality is:\n$$\n\\frac{\\partial h}{\\partial u} = p(t) - u(t) = 0 \\implies u^*(t) = p(t)\n$$\nThe dynamics of the reduced costate $p(t)$ are governed by the Lie-Poisson equation:\n$$\n\\dot{p} = -\\text{ad}_{\\nabla_p h}^* p\n$$\nIn the context of $\\mathfrak{so}(3) \\cong \\mathbb{R}^3$, this equation takes the form $\\dot{p} = (\\nabla_p h) \\times p$. The gradient of the maximized Hamiltonian $H^*(p) = h(p, u^*(p))$ with respect to $p$ is $\\nabla_p H^* = u$. So, the equation is $\\dot{p} = u \\times p$.\nSubstituting the optimality condition $u(t) = p(t)$ into the costate dynamics, we obtain:\n$$\n\\dot{p}(t) = p(t) \\times p(t) = 0\n$$\nThis implies that the body-fixed costate vector $p(t)$ must be constant. Let $p(t) = p_0$ for some constant vector $p_0 \\in \\mathbb{R}^3$. Since the optimal control is given by $u^*(t)=p(t)$, the optimal control in the body frame, $u^*(t)$, must also be a constant vector. Let us denote this constant control vector by $u_0$.\n\nWith the constant body-frame control $u_0$, the system dynamics become:\n$$\n\\dot{R}(t) = R(t)\\widehat{u_0}\n$$\nThis is a linear ordinary differential equation with a constant coefficient matrix (in the body frame). Given the initial condition $R(0)=I$, the solution is given by the matrix exponential, which describes a one-parameter subgroup of $\\mathrm{SO}(3)$:\n$$\nR(t) = \\exp(t\\widehat{u_0})\n$$\nThis trajectory represents a geodesic on $\\mathrm{SO}(3)$ with respect to the bi-invariant metric.\n\nTo determine the specific constant control $u_0$, we apply the terminal boundary condition at time $t=T$:\n$$\nR(T) = R_f = \\exp(T\\widehat{u_0})\n$$\nUsing the property of the hat map and matrix exponential, this can be written as:\n$$\nR_f = \\exp(\\widehat{Tu_0})\n$$\nThe problem provides that $R_f$ has a principal rotation angle $\\theta \\in (0, \\pi]$ and can be expressed as $R_f = \\exp(\\widehat{\\omega})$, where $\\omega \\in \\mathbb{R}^3$ is the axis-angle vector satisfying $\\|\\omega\\|=\\theta$. The condition $\\theta \\in (0, \\pi]$ ensures that the Lie logarithm is unique (specifically, the principal logarithm).\n\nBy comparing the two exponential representations of $R_f$, we have:\n$$\n\\exp(\\widehat{Tu_0}) = \\exp(\\widehat{\\omega})\n$$\nSince the exponential map $\\exp: \\mathfrak{so}(3) \\to \\mathrm{SO}(3)$ is injective on the open ball of radius $\\pi$ in $\\mathfrak{so}(3)$, and $\\|\\omega\\|=\\theta \\le \\pi$, we can equate the arguments:\n$$\n\\widehat{Tu_0} = \\widehat{\\omega}\n$$\nAs the hat map is an isomorphism, this implies:\n$$\nTu_0 = \\omega \\implies u_0 = \\frac{\\omega}{T}\n$$\nWe have now found the optimal control $u^*(t) = u_0 = \\frac{\\omega}{T}$. It is constant in the body frame and directs the rotation about the axis of the minimal-angle rotation from $I$ to $R_f$.\n\nFinally, we compute the minimal energy $J^*$ by substituting the optimal control into the cost functional:\n$$\nJ^* = \\frac{1}{2}\\int_{0}^{T}\\|u^*(t)\\|^{2}\\,\\mathrm{d}t = \\frac{1}{2}\\int_{0}^{T}\\left\\|\\frac{\\omega}{T}\\right\\|^{2}\\,\\mathrm{d}t\n$$\nSince the integrand is constant, the integral becomes:\n$$\nJ^* = \\frac{1}{2} \\left\\|\\frac{\\omega}{T}\\right\\|^{2} \\int_{0}^{T} \\mathrm{d}t = \\frac{1}{2} \\frac{\\|\\omega\\|^2}{T^2} T\n$$\nUsing the fact that $\\|\\omega\\|=\\theta$, we get:\n$$\nJ^* = \\frac{1}{2}\\frac{\\theta^2}{T^2}T = \\frac{\\theta^2}{2T}\n$$\nThis is the minimal energy required to steer the system from the identity rotation to the final rotation $R_f$ in time $T$.",
            "answer": "$$\\boxed{\\frac{\\theta^2}{2T}}$$"
        }
    ]
}