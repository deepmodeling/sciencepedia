{
    "hands_on_practices": [
        {
            "introduction": "在应用最优控制的强大工具（如庞特里亚金极大值原理）之前，一个关键步骤是将系统从拉格朗日框架转换到哈密顿框架。本练习通过一个标准的力学系统，引导你实践这一核心变换——勒让德变换。掌握这个过程对于理解速度与动量之间的对偶关系以及建立哈密顿最优控制问题至关重要。",
            "id": "3743856",
            "problem": "考虑一个光滑、连通的有限维位形流形 $Q$，其上配备一个黎曼度量 $g$，该度量为每个点 $x \\in Q$ 指定一个正定双线性形式 $g_{x}: T_{x}Q \\times T_{x}Q \\to \\mathbb{R}$。设 $V: Q \\to \\mathbb{R}$ 是一个光滑势函数，并考虑力学拉格朗日量 $L: TQ \\to \\mathbb{R}$，其表达式为 $L(x,v) = \\frac{1}{2} g_{x}(v,v) - V(x)$，其中 $(x,v) \\in TQ$。使用拉格朗日量关于速度的纤维导数的基本定义，即，对于每个固定的 $x$，导数 $d_{v}L(x,v) \\in T_{x}^{*}Q$ 对所有 $\\delta v \\in T_{x}Q$ 满足 $d_{v}L(x,v)\\cdot \\delta v = \\frac{d}{d\\epsilon}\\big|_{\\epsilon=0} L(x,v + \\epsilon \\delta v)$。同时，使用从 $TQ$ 到 $T^{*}Q$ 的逐纤维勒让德变换的定义，该变换将 $(x,v)$ 与余向量 $p = d_{v}L(x,v) \\in T_{x}^{*}Q$ 相关联，并通过以下方式定义哈密顿量 $H: T^{*}Q \\to \\mathbb{R}$：\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - L(x,v) \\right).\n$$\n严格从这些基本定义和 $g_{x}$ 的正定性出发，推导 $p$ 关于 $g_{x}$ 和 $v$ 的显式表达式，并计算哈密顿量 $H(x,p)$，使其完全用 $x$、$p$、对偶度量 $g_{x}^{-1}: T_{x}^{*}Q \\times T_{x}^{*}Q \\to \\mathbb{R}$ 和 $V(x)$ 表示。您的最终答案必须是一个只包含 $x$、$p$、$g_{x}^{-1}$ 和 $V(x)$ 的单一解析表达式，且不依赖于 $v$。不需要四舍五入，也不涉及物理单位。请将您的最终答案表示为一个封闭形式的解析表达式。",
            "solution": "问题陈述是几何力学中一个适定且基础的练习。它要求使用勒让德变换，从拉格朗日量 $L$ 推导力学系统的哈密顿量 $H$。所有定义和条件都是标准的、一致的，并且在数学上是合理的。我们开始进行推导。\n\n问题分为两部分：首先，找到动量 $p$ 和速度 $v$ 之间的关系；其次，利用这个关系计算哈密顿量 $H(x,p)$。\n\n**第一部分：动量 $p$ 的推导**\n\n给定位于配备黎曼度量 $g$ 的位形流形 $Q$ 上的力学系统的拉格朗日量 $L: TQ \\to \\mathbb{R}$：\n$$\nL(x,v) = \\frac{1}{2} g_{x}(v,v) - V(x)\n$$\n其中 $(x,v) \\in TQ$。动量 $p \\in T_{x}^{*}Q$ 被定义为 $L$ 关于 $v$ 的纤维导数。所提供的定义是，对于任意变分 $\\delta v \\in T_{x}Q$，余向量 $p = d_{v}L(x,v)$ 在 $\\delta v$ 上的作用由下式给出：\n$$\np(\\delta v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} L(x,v + \\epsilon \\delta v)\n$$\n我们将 $L$ 的表达式代入此定义。势函数 $V(x)$ 与速度 $v$ 无关，所以在对 $v$ 求导时它会消失。\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} g_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) - V(x)\n$$\n利用度量 $g_{x}$ 的双线性性，我们展开二次项：\n$$\ng_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) = g_{x}(v,v) + g_{x}(v, \\epsilon \\delta v) + g_{x}(\\epsilon \\delta v, v) + g_{x}(\\epsilon \\delta v, \\epsilon \\delta v)\n$$\n由于 $g_x$ 是对称双线性形式，$g_x(v, \\delta v) = g_x(\\delta v, v)$。表达式变为：\n$$\ng_{x}(v + \\epsilon \\delta v, v + \\epsilon \\delta v) = g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v)\n$$\n将此代回 $L$ 的表达式中：\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} \\left( g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v) \\right) - V(x)\n$$\n$$\nL(x,v + \\epsilon \\delta v) = \\frac{1}{2} g_{x}(v,v) + \\epsilon g_{x}(v, \\delta v) + \\frac{1}{2} \\epsilon^{2} g_{x}(\\delta v, \\delta v) - V(x)\n$$\n现在，我们对 $\\epsilon$ 求导：\n$$\n\\frac{d}{d\\epsilon} L(x,v + \\epsilon \\delta v) = g_{x}(v, \\delta v) + \\epsilon g_{x}(\\delta v, \\delta v)\n$$\n在 $\\epsilon=0$ 处计算此导数：\n$$\n\\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} L(x,v + \\epsilon \\delta v) = g_{x}(v, \\delta v)\n$$\n因此，动量 $p$ 的定义关系为：\n$$\np(\\delta v) = g_{x}(v, \\delta v) \\quad \\text{for all } \\delta v \\in T_{x}Q\n$$\n该方程给出了动量余向量 $p \\in T_x^*Q$ 与速度向量 $v \\in T_xQ$ 之间的显式关系。它表明，余向量 $p$ 是向量 $v$ 在由度量诱导的音乐同构 $v \\mapsto v^{\\flat} = g_{x}(v, \\cdot)$ 下的像。\n\n**第二部分：哈密顿量 $H(x,p)$ 的计算**\n\n哈密顿量 $H: T^{*}Q \\to \\mathbb{R}$ 通过拉格朗日量的勒让德变换定义：\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - L(x,v) \\right)\n$$\n我们将 $L(x,v)$ 的表达式代入此定义：\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - \\left(\\frac{1}{2} g_{x}(v,v) - V(x)\\right) \\right)\n$$\n势函数 $V(x)$ 不依赖于 $v$，因此可以移到上确界符号之外：\n$$\nH(x,p) = \\sup_{v \\in T_{x}Q} \\left( p(v) - \\frac{1}{2} g_{x}(v,v) \\right) + V(x)\n$$\n设待最大化的函数为 $f(v) = p(v) - \\frac{1}{2} g_{x}(v,v)$。为了找到使该函数最大化的速度 $v_{\\text{crit}}$，我们必须找到其导数为零的临界点。$f(v)$ 在任意方向 $\\delta v \\in T_{x}Q$ 上的导数为：\n$$\nd_{v}f(v) \\cdot \\delta v = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} f(v + \\epsilon\\delta v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\left( p(v + \\epsilon\\delta v) - \\frac{1}{2} g_{x}(v + \\epsilon\\delta v, v + \\epsilon\\delta v) \\right)\n$$\n利用 $p$ 的线性性以及第一部分中度量项的展开式：\n$$\nd_{v}f(v) \\cdot \\delta v = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\left( p(v) + \\epsilon p(\\delta v) - \\frac{1}{2} \\left( g_{x}(v,v) + 2\\epsilon g_{x}(v, \\delta v) + \\epsilon^{2} g_{x}(\\delta v, \\delta v) \\right) \\right)\n$$\n$$\nd_{v}f(v) \\cdot \\delta v = p(\\delta v) - g_{x}(v, \\delta v)\n$$\n临界点 $v_{\\text{crit}}$ 处该导数对所有方向 $\\delta v$ 都为零：\n$$\np(\\delta v) - g_{x}(v_{\\text{crit}}, \\delta v) = 0 \\quad \\text{for all } \\delta v \\in T_{x}Q\n$$\n这意味着余向量 $p$ 与余向量 $g_{x}(v_{\\text{crit}}, \\cdot)$ 完全相同。这正是我们在第一部分中推导出的关系。因为度量 $g_x$ 是正定的，项 $-\\frac{1}{2}g_x(v,v)$ 是严格凹的，这确保了此临界点对应于唯一的全局最大值。\n\n速度 $v_{\\text{crit}}$ 是在度量同构下与余向量 $p$ 对应的向量。为了用 $p$ 表示 $v_{\\text{crit}}$，我们使用此同构的逆，它由余切空间 $T_{x}^{*}Q$ 上的对偶度量 $g_{x}^{-1}$ 给出。对偶度量定义了一个从 $T_{x}^{*}Q$ 到 $T_{x}Q$ 的映射 $p \\mapsto p^{\\sharp}$，使得对于所有 $v \\in T_xQ$ 都有 $g_{x}(p^{\\sharp}, v) = p(v)$。将此与我们的临界点条件 $g_x(v_{\\text{crit}}, \\delta v) = p(\\delta v)$ 进行比较，我们确定 $v_{\\text{crit}} = p^{\\sharp}$。\n\n现在我们将这个特定的速度 $v_{\\text{crit}}$ 代回 $H(x,p)$ 的表达式中：\n$$\nH(x,p) = \\left( p(v_{\\text{crit}}) - \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) \\right) + V(x)\n$$\n根据条件 $p(\\delta v) = g_{x}(v_{\\text{crit}}, \\delta v)$，我们可以令 $\\delta v = v_{\\text{crit}}$ 来得到：\n$$\np(v_{\\text{crit}}) = g_{x}(v_{\\text{crit}}, v_{\\text{crit}})\n$$\n将此代入 $H(x,p)$ 的表达式：\n$$\nH(x,p) = g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) - \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) + V(x)\n$$\n$$\nH(x,p) = \\frac{1}{2} g_{x}(v_{\\text{crit}}, v_{\\text{crit}}) + V(x)\n$$\n最后一步是用 $p$ 和对偶度量 $g_{x}^{-1}$ 完全表示项 $g_{x}(v_{\\text{crit}}, v_{\\text{crit}})$。对偶度量的定义为 $g_{x}^{-1}(\\alpha, \\beta) = g_{x}(\\alpha^{\\sharp}, \\beta^{\\sharp})$，适用于任何 $\\alpha, \\beta \\in T_{x}^{*}Q$。令 $\\alpha = \\beta = p$，我们有：\n$$\ng_{x}^{-1}(p, p) = g_{x}(p^{\\sharp}, p^{\\sharp})\n$$\n因为我们已经确定 $v_{\\text{crit}} = p^{\\sharp}$，所以可得：\n$$\ng_{x}(v_{\\text{crit}}, v_{\\text{crit}}) = g_{x}^{-1}(p, p)\n$$\n将这最后一部分代入我们的哈密顿量表达式中，得到所需的结果：\n$$\nH(x,p) = \\frac{1}{2} g_{x}^{-1}(p,p) + V(x)\n$$\n这个哈密顿量的表达式完全是用位置 $x$、动量 $p$、对偶度量 $g_{x}^{-1}$ 和势函数 $V(x)$ 来表述的，正如所要求的那样。拉格朗日量中的动能项 $\\frac{1}{2}g_x(v,v)$ 在哈密顿量中被转换为项 $\\frac{1}{2}g_x^{-1}(p,p)$。",
            "answer": "$$\n\\boxed{\\frac{1}{2} g_{x}^{-1}(p,p) + V(x)}\n$$"
        },
        {
            "introduction": "机器人、航天器和分子的运动通常是在非欧几里得空间（如李群）上进行的。本练习以特殊正交群 $SO(3)$ 上的姿态控制为例，展示了几何方法如何利用系统的对称性来简化最优控制问题。你将看到，通过将问题约化到李代数上，一个看似复杂的非线性控制问题如何优雅地转化为一个常数控制问题，其解对应于测地线。",
            "id": "3743884",
            "problem": "考虑特殊正交李群 $SO(3)$，其左不变控制仿射动力学由 $\\dot{R}(t)=R(t)\\,\\widehat{u(t)}$ 给出，其中 $R(t)\\in SO(3)$，$u(t)\\in \\mathbb{R}^{3}$，且 $\\widehat{\\cdot}$ 映射是标准的李代数同构 $\\widehat{(\\cdot)}:\\mathbb{R}^{3}\\to \\mathfrak{so}(3)$，其定义为对所有 $a,b\\in \\mathbb{R}^{3}$ 都有 $\\widehat{a}\\,b=a\\times b$。设代价泛函为能量\n$$\nJ[u]=\\frac{1}{2}\\int_{0}^{T}\\|u(t)\\|^{2}\\,\\mathrm{d}t,\n$$\n其中范数 $\\|\\cdot\\|$ 由 $\\mathbb{R}^{3}$ 上的欧几里得内积诱导，而该内积又通过左平移在 $SO(3)$ 上定义了一个双不变黎曼度量。边界条件为 $R(0)=I$ 和 $R(T)=R_{f}$，其中 $R_{f}\\in SO(3)$ 是一个固定的旋转，其主旋转角为 $\\theta\\in (0,\\pi]$ (以弧度为单位)。假设 $T>0$ 是固定的。\n\n使用最优控制中的庞特里亚金极大值原理的基本原理、通过左平凡化到李代数的约化以及在 $\\mathfrak{so}(3)^{*}$ 上的协伴随作用，推导这个左不变问题的最优性必要条件。然后，特化到给定的双不变度量，并证明任何能量最小化控制在体坐标系中必须是常数。仅使用 $SO(3)$ 及其李代数的基本恒等式（特别是，对于恒定的体速度，状态轨迹是一个单参数子群，以及 $R_{f}$ 的主对数存在，其轴-角向量为 $\\omega\\in \\mathbb{R}^{3}$ 且满足 $R_{f}=\\exp(\\widehat{\\omega})$ 和 $\\|\\omega\\|=\\theta$），确定在固定时间 $T$ 内将 $R(0)=I$ 驱动到 $R(T)=R_{f}$ 所需的最小能量 $J^{\\ast}$。\n\n你的最终答案应为一个关于 $\\theta$ 和 $T$ 的单一闭式表达式，其中 $\\theta$ 以弧度表示。",
            "solution": "所述问题在几何力学的背景下构成了一个有效且适定的最优控制问题。因此，我们可以继续进行解的形式推导。\n\n问题在于找到一个控制输入 $u(t) \\in \\mathbb{R}^3$，使其在满足特殊正交群 $SO(3)$ 上的左不变动力学\n$$\n\\dot{R}(t)=R(t)\\,\\widehat{u(t)}\n$$\n以及边界条件 $R(0)=I$ 和 $R(T)=R_f$ 的约束下，最小化能量泛函\n$$\nJ[u]=\\frac{1}{2}\\int_{0}^{T}\\|u(t)\\|^{2}\\,\\mathrm{d}t\n$$\n这里，$I$ 是 $3 \\times 3$ 单位矩阵，$R_f$ 是给定的最终姿态。记号 $\\widehat{(\\cdot)}:\\mathbb{R}^{3}\\to \\mathfrak{so}(3)$ 代表标准的李代数同构，其中 $\\mathfrak{so}(3)$ 是 $SO(3)$ 的李代数，由 $3 \\times 3$ 的斜对称矩阵组成。问题陈述了 $\\mathbb{R}^3$ 上的范数 $\\|\\cdot\\|$ 是欧几里得范数，它在 $SO(3)$ 上诱导了一个双不变黎曼度量。这对应于李代数 $\\mathfrak{so}(3)$ 上的一个 Ad-不变内积。\n\n我们应用庞特里亚金极大值原理 (PMP)。状态为 $R \\in SO(3)$。我们引入一个协态（或伴随变量）$P_R(t) \\in T_{R(t)}^*SO(3)$。该系统的哈密顿量由下式给出：\n$$\nH(R, P_R, u) = \\langle P_R, \\dot{R} \\rangle - \\frac{1}{2}\\|u\\|^2 = \\langle P_R, R(t)\\,\\widehat{u(t)} \\rangle - \\frac{1}{2}\\|u\\|^2\n$$\n其中 $\\langle \\cdot, \\cdot \\rangle$ 表示余切空间与其切空间之间的自然配对。\n\n由于动力学和代价函数具有左不变结构，进行左平凡化是有利的。我们通过将协态 $P_R$ 拉回到单位元来定义体固连协态 $\\lambda(t) \\in \\mathfrak{so}(3)^*$：\n$$\n\\lambda(t) = (L_{R(t)^{-1}})^* P_{R(t)}\n$$\n这意味着对于任意 $\\xi \\in \\mathfrak{so}(3)$，我们有 $\\langle \\lambda(t), \\xi \\rangle = \\langle P_{R(t)}, (L_{R(t)})_*\\xi \\rangle = \\langle P_{R(t)}, R(t)\\xi \\rangle$。\n现在，哈密顿量可以写成这个约化协态的形式：\n$$\nh(\\lambda, u) = \\langle \\lambda, \\widehat{u} \\rangle - \\frac{1}{2}\\|u\\|^2\n$$\n我们可以通过给定的双不变度量将李代数 $\\mathfrak{so}(3)$ 及其对偶空间 $\\mathfrak{so}(3)^*$ 与 $\\mathbb{R}^3$ 等同起来。与 $\\mathbb{R}^3$ 上的欧几里得点积相对应的 $\\mathfrak{so}(3)$ 上的内积是 $\\langle \\widehat{a}, \\widehat{b} \\rangle = a \\cdot b$。在此等同下，协态 $\\lambda(t)$ 由一个向量 $p(t) \\in \\mathbb{R}^3$ 表示，配对 $\\langle \\lambda, \\widehat{u} \\rangle$ 成为点积 $p \\cdot u$。约化哈密顿量则是一个在 $\\mathbb{R}^3 \\times \\mathbb{R}^3$ 上的函数：\n$$\nh(p, u) = p(t) \\cdot u(t) - \\frac{1}{2}\\|u(t)\\|^2\n$$\n根据 PMP，最优控制 $u^*(t)$ 必须在几乎所有时刻 $t \\in [0, T]$ 都使该哈密顿量最大化。极大化的一阶必要条件是：\n$$\n\\frac{\\partial h}{\\partial u} = p(t) - u(t) = 0 \\implies u^*(t) = p(t)\n$$\n约化协态 $p(t)$ 的动力学由李-泊松方程决定：\n$$\n\\dot{p} = -\\text{ad}_{\\nabla_p h}^* p\n$$\n在 $\\mathfrak{so}(3) \\cong \\mathbb{R}^3$ 的背景下，该方程的形式为 $\\dot{p} = (\\nabla_p h) \\times p$。最大化的哈密顿量 $H^*(p) = h(p, u^*(p))$ 关于 $p$ 的梯度是 $\\nabla_p H^* = u$。因此，方程为 $\\dot{p} = u \\times p$。\n将最优性条件 $u(t) = p(t)$ 代入协态动力学，我们得到：\n$$\n\\dot{p}(t) = p(t) \\times p(t) = 0\n$$\n这意味着体固连协态向量 $p(t)$ 必须是常数。设 $p(t) = p_0$，其中 $p_0 \\in \\mathbb{R}^3$ 是某个常向量。由于最优控制由 $u^*(t)=p(t)$ 给出，因此体坐标系中的最优控制 $u^*(t)$ 也必须是一个常向量。我们用 $u_0$ 表示这个常控制向量。\n\n在常数体坐标系控制 $u_0$ 下，系统动力学变为：\n$$\n\\dot{R}(t) = R(t)\\widehat{u_0}\n$$\n这是一个（在体坐标系中）具有常系数矩阵的线性常微分方程。给定初始条件 $R(0)=I$，其解由矩阵指数给出，该解描述了 $SO(3)$ 的一个单参数子群：\n$$\nR(t) = \\exp(t\\widehat{u_0})\n$$\n这条轨迹代表了 $SO(3)$ 上关于双不变度量的一条测地线。\n\n为了确定具体的常控制向量 $u_0$，我们应用在时刻 $t=T$ 的终端边界条件：\n$$\nR(T) = R_f = \\exp(T\\widehat{u_0})\n$$\n利用 hat 映射和矩阵指数的性质，这可以写成：\n$$\nR_f = \\exp(\\widehat{Tu_0})\n$$\n问题给出 $R_f$ 的主旋转角为 $\\theta \\in (0, \\pi]$，并且可以表示为 $R_f = \\exp(\\widehat{\\omega})$，其中 $\\omega \\in \\mathbb{R}^3$ 是满足 $\\|\\omega\\|=\\theta$ 的轴-角向量。条件 $\\theta \\in (0, \\pi]$ 确保了李对数是唯一的（具体来说，是主对数）。\n\n通过比较 $R_f$ 的两种指数表示，我们有：\n$$\n\\exp(\\widehat{Tu_0}) = \\exp(\\widehat{\\omega})\n$$\n由于指数映射 $\\exp: \\mathfrak{so}(3) \\to SO(3)$ 在 $\\mathfrak{so}(3)$ 中半径为 $\\pi$ 的开球上是单射的，并且 $\\|\\omega\\|=\\theta \\le \\pi$，我们可以令其参数相等：\n$$\n\\widehat{Tu_0} = \\widehat{\\omega}\n$$\n因为 hat 映射是一个同构，这意味着：\n$$\nTu_0 = \\omega \\implies u_0 = \\frac{\\omega}{T}\n$$\n现在我们找到了最优控制 $u^*(t) = u_0 = \\frac{\\omega}{T}$。它在体坐标系中是常数，并且引导旋转绕着从 $I$ 到 $R_f$ 的最小角度旋转的轴进行。\n\n最后，我们通过将最优控制代入代价泛函来计算最小能量 $J^*$：\n$$\nJ^* = \\frac{1}{2}\\int_{0}^{T}\\|u^*(t)\\|^{2}\\,\\mathrm{d}t = \\frac{1}{2}\\int_{0}^{T}\\left\\|\\frac{\\omega}{T}\\right\\|^{2}\\,\\mathrm{d}t\n$$\n由于被积函数是常数，积分变为：\n$$\nJ^* = \\frac{1}{2} \\left\\|\\frac{\\omega}{T}\\right\\|^{2} \\int_{0}^{T} \\mathrm{d}t = \\frac{1}{2} \\frac{\\|\\omega\\|^2}{T^2} T\n$$\n利用 $\\|\\omega\\|=\\theta$ 这一事实，我们得到：\n$$\nJ^* = \\frac{1}{2}\\frac{\\theta^2}{T^2}T = \\frac{\\theta^2}{2T}\n$$\n这就是在时间 $T$ 内将系统从单位旋转驱动到最终旋转 $R_f$ 所需的最小能量。",
            "answer": "$$\\boxed{\\frac{\\theta^2}{2T}}$$"
        },
        {
            "introduction": "在寻找连接两点的*最优*路径之前，我们必须首先确定是否存在*任何*可行的路径。本练习介绍了可达性的概念，这是对系统可控性的严格数学刻画。你将通过计算由控制向量场生成的李代数秩，来亲手确定系统在某一点是否是完全可控的，这是几何控制理论中的一个基本诊断工具。",
            "id": "3743840",
            "problem": "考虑余切丛 $T^{\\ast}\\mathbb{R}^{2}$，其具有典范坐标 $(q_{1},q_{2},p_{1},p_{2})$ 和典范辛形式 $\\omega = dq_{1}\\wedge dp_{1} + dq_{2}\\wedge dp_{2}$。令 $X_{H}$ 表示与光滑函数 $H:T^{\\ast}\\mathbb{R}^{2}\\to\\mathbb{R}$ 相关联的哈密顿向量场，由关系式 $i_{X_{H}}\\omega = dH$ 隐式定义，其中 $i_{X_{H}}$ 是内缩。考虑 $T^{\\ast}\\mathbb{R}^{2}$ 上的无漂移控制仿射系统，形式为 $\\dot{z} = u_{1} g_{1}(z) + u_{2} g_{2}(z) + u_{3} g_{3}(z)$，其控制向量场由哈密顿向量场给出：$g_{1} = X_{h_{1}}$, $g_{2} = X_{h_{2}}$, $g_{3} = X_{h_{3}}$，其中 $h_{1}(q,p) = p_{1}$，$h_{2}(q,p) = q_{1}p_{2}$，以及 $h_{3}(q,p) = \\frac{1}{2}q_{2}^{2}$。\n\n仅使用辛几何的基本定义和向量场的李括号，计算由 $\\{g_{1},g_{2},g_{3}\\}$ 及其所有迭代李括号生成的可达性分布 $\\mathcal{D}$，并确定 $\\mathcal{D}$ 在点 $(q_{1},q_{2},p_{1},p_{2}) = (0,1,0,1)$ 处的秩。将你的最终答案表示为等于 $\\mathcal{D}$ 在该点秩的单个整数。",
            "solution": "问题要求计算在余切丛 $T^{\\ast}\\mathbb{R}^{2}$ 上给定控制系统的可达性分布 $\\mathcal{D}$ 的秩。该秩需要在特定点 $z_0 = (q_{1},q_{2},p_{1},p_{2}) = (0,1,0,1)$ 处确定。在某一点的可达性分布 $\\mathcal{D}$ 是由控制向量场及其所有迭代李括号在该点求值后所张成的切空间的子空间。$\\mathcal{D}$ 的秩是该子空间的维数。\n\n状态空间是 4 维流形 $T^{\\ast}\\mathbb{R}^{2}$，其典范坐标为 $(q_{1},q_{2},p_{1},p_{2})$。典范辛形式由 $\\omega = dq_{1}\\wedge dp_{1} + dq_{2}\\wedge dp_{2}$ 给出。\n\n与光滑函数 $H(q,p)$ 对应的哈密顿向量场 $X_{H}$ 由关系式 $i_{X_{H}}\\omega = dH$ 定义。在给定的典范坐标中，这产生以下显式公式：\n$$X_{H} = \\sum_{i=1}^{2} \\left( \\frac{\\partial H}{\\partial p_{i}} \\frac{\\partial}{\\partial q_{i}} - \\frac{\\partial H}{\\partial q_{i}} \\frac{\\partial}{\\partial p_{i}} \\right)$$\n\n控制向量场由 $g_{1} = X_{h_{1}}$, $g_{2} = X_{h_{2}}$ 和 $g_{3} = X_{h_{3}}$ 给出，其中哈密顿函数为：\n$h_{1}(q,p) = p_{1}$\n$h_{2}(q,p) = q_{1}p_{2}$\n$h_{3}(q,p) = \\frac{1}{2}q_{2}^{2}$\n\n可达性分布 $\\mathcal{D}$ 是由 $\\{g_1, g_2, g_3\\}$ 生成的李代数所张成的分布，即 $\\mathcal{D} = \\text{span}\\{g_1, g_2, g_3, [g_i, g_j], [g_i, [g_j, g_k]], \\dots \\}$。为了求出在 $z_0$ 处的秩，我们将计算这些向量场，在 $z_0$ 处对它们求值，并确定它们所张成的向量空间的维数。\n\n首先，我们计算向量场 $g_{1}$、$g_{2}$ 和 $g_{3}$ 的显式表达式。\n\n对于 $g_{1} = X_{h_{1}}$，其中 $h_{1} = p_{1}$：\n$\\frac{\\partial h_{1}}{\\partial p_{1}} = 1$。所有其他偏导数均为零。\n$$g_{1} = \\frac{\\partial h_{1}}{\\partial p_{1}} \\frac{\\partial}{\\partial q_{1}} = \\frac{\\partial}{\\partial q_{1}}$$\n相对于基 $(\\frac{\\partial}{\\partial q_{1}}, \\frac{\\partial}{\\partial q_{2}}, \\frac{\\partial}{\\partial p_{1}}, \\frac{\\partial}{\\partial p_{2}})$，其向量形式为 $g_{1} \\equiv (1,0,0,0)^{T}$。\n\n对于 $g_{2} = X_{h_{2}}$，其中 $h_{2} = q_{1}p_{2}$：\n$\\frac{\\partial h_{2}}{\\partial q_{1}} = p_{2}$ 且 $\\frac{\\partial h_{2}}{\\partial p_{2}} = q_{1}$。\n$$g_{2} = \\frac{\\partial h_{2}}{\\partial p_{2}} \\frac{\\partial}{\\partial q_{2}} - \\frac{\\partial h_{2}}{\\partial q_{1}} \\frac{\\partial}{\\partial p_{1}} = q_{1}\\frac{\\partial}{\\partial q_{2}} - p_{2}\\frac{\\partial}{\\partial p_{1}}$$\n其向量形式为 $g_{2} \\equiv (0, q_{1}, -p_{2}, 0)^{T}$。\n\n对于 $g_{3} = X_{h_{3}}$，其中 $h_{3} = \\frac{1}{2}q_{2}^{2}$：\n$\\frac{\\partial h_{3}}{\\partial q_{2}} = q_{2}$。\n$$g_{3} = -\\frac{\\partial h_{3}}{\\partial q_{2}} \\frac{\\partial}{\\partial p_{2}} = -q_{2}\\frac{\\partial}{\\partial p_{2}}$$\n其向量形式为 $g_{3} \\equiv (0, 0, 0, -q_{2})^{T}$。\n\n接下来，我们在点 $z_0 = (q_1,q_2,p_1,p_2) = (0,1,0,1)$ 处对这些向量场求值：\n$v_{1} = g_{1}(z_0) = (1,0,0,0)^{T}$\n$v_{2} = g_{2}(z_0) = (0, 0, -1, 0)^{T}$\n$v_{3} = g_{3}(z_0) = (0, 0, 0, -1)^{T}$\n\n这三个向量显然是线性无关的。因此，$\\mathcal{D}$ 在 $z_0$ 处的秩至少为 $3$。要检查秩是否为 $4$，我们需要计算迭代李括号。\n\n哈密顿力学的一个基本性质将两个哈密顿向量场的李括号 $[X_f, X_g]$ 与它们的泊松括号的哈密顿向量场 $X_{\\{f,g\\}}$ 联系起来。泊松括号定义为：\n$$\\{f,g\\} = \\sum_{i=1}^{2} \\left( \\frac{\\partial f}{\\partial q_{i}} \\frac{\\partial g}{\\partial p_{i}} - \\frac{\\partial f}{\\partial p_{i}} \\frac{\\partial g}{\\partial q_{i}} \\right)$$\n该关系由 $[X_f, X_g] = -X_{\\{f,g\\}}$ 给出。我们将使用这个关系来简化李括号的计算。\n\n我们来计算李括号 $[g_1, g_2] = [X_{h_1}, X_{h_2}]$。我们首先计算泊松括号 $\\{h_1, h_2\\}$：\n$$\\{h_{1}, h_{2}\\} = \\{p_{1}, q_{1}p_{2}\\} = \\frac{\\partial p_{1}}{\\partial q_{1}}\\frac{\\partial (q_{1}p_{2})}{\\partial p_{1}} - \\frac{\\partial p_{1}}{\\partial p_{1}}\\frac{\\partial (q_{1}p_{2})}{\\partial q_{1}} = (0)(0) - (1)(p_{2}) = -p_{2}$$\n所以，$[g_1, g_2] = -X_{\\{h_1, h_2\\}} = -X_{-p_2}$。\n令 $h_{12} = -p_2$。哈密顿向量场 $X_{h_{12}}$ 為：\n$$X_{-p_2} = \\frac{\\partial(-p_2)}{\\partial p_2} \\frac{\\partial}{\\partial q_2} - \\frac{\\partial(-p_2)}{\\partial q_2} \\frac{\\partial}{\\partial p_2} = (-1)\\frac{\\partial}{\\partial q_2} - (0)\\frac{\\partial}{\\partial p_2} = -\\frac{\\partial}{\\partial q_2}$$\n因此，李括号是：\n$$[g_{1}, g_{2}] = -X_{-p_{2}} = -(-\\frac{\\partial}{\\partial q_{2}}) = \\frac{\\partial}{\\partial q_{2}}$$\n我们称这个新的向量场为 $g_4 = [g_1, g_2]$。其向量形式为 $g_4 \\equiv (0,1,0,0)^T$。这个向量场是常数。\n\n现在，我们在 $z_0$ 处对 $g_4$ 求值：\n$v_{4} = g_{4}(z_0) = (0,1,0,0)^{T}$\n\n我们现在有在 $z_0$ 处求值的一组四个向量：\n$v_{1} = (1,0,0,0)^{T}$\n$v_{2} = (0,0,-1,0)^{T}$\n$v_{3} = (0,0,0,-1)^{T}$\n$v_{4} = (0,1,0,0)^{T}$\n\n为了确定分布在 $z_0$ 处的秩，我们检查这四个向量的线性无关性。我们可以构成一个以这些向量为列（或行）的矩阵，并计算其行列式：\n$$ M = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & -1 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\end{pmatrix} $$\n行列式可以通过沿第一行进行余子式展开来计算：\n$$\\det(M) = 1 \\cdot \\det \\begin{pmatrix} 0 & 0 & 1 \\\\ -1 & 0 & 0 \\\\ 0 & -1 & 0 \\end{pmatrix} = 1 \\cdot \\left( 1 \\cdot \\det \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\right) = (-1)(-1) = 1$$\n由于行列式非零（$\\det(M)=1$），所以这四个向量 $v_1, v_2, v_3, v_4$ 是线性无关的。这四个向量属于切空间 $T_{z_0}(T^{\\ast}\\mathbb{R}^{2})$，这是一个 4 维向量空间。由于我们已经找到了四个线性无关的向量张成该点的分布，它们必定构成整个切空间的一个基。\n\n因此，可达性分布 $\\mathcal{D}$ 在点 $(0,1,0,1)$ 处的秩为 $4$。我们不需要计算更多的李括号，因为已经达到了可能的最大秩。",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}