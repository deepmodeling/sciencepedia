{
    "hands_on_practices": [
        {
            "introduction": "在具有对称性的力学系统中，机械联络并非一个抽象的数学构造，而是内禀于系统动能度量中的几何结构。本练习将引导你从第一性原理出发，为一个在欧几里得空间中运动的自由粒子推导出其机械联络。通过计算其曲率，我们将揭示在降维后的形状空间中是否存在类似磁场的“回转力”，从而深入理解重构动力学的几何起源。",
            "id": "3764117",
            "problem": "设 $Q=\\mathbb{R}^{3}\\setminus\\{0\\}$，并受二维特殊正交群 (SO(2)) 以绕 $z$ 轴旋转的方式作用。考虑由 $Q$ 上的标准欧几里得度规所导出的自由粒子动能度规。\n\n(a) 使用柱坐标将轨道空间 $Q/\\mathrm{SO}(2)$ 显式地辨识为 $\\mathbb{R}^{2}$ 的一个子集，并对其分层拓扑结构给出一个科学严谨的描述，需区分主分层与奇异分层。\n\n(b) 在商空间的正则（主）部分，将 $Q$ 视为一个以一维环面 ($S^1$) 为结构群的主圆丛。利用与动能度规相关的机械联络，从第一性原理出发，推导在笛卡尔坐标 $(x,y,z)$ 下 $Q$ 上的联络1-形式 $A$ 的显式表达式，并计算其曲率2-形式 $F$。\n\n你的最终答案必须是基底正则部分上曲率2-形式 $F$ 的显式解析表达式，用笛卡尔坐标或柱坐标变量表示。如果得到一个常数，请给出其精确值。无需四舍五入。",
            "solution": "用户希望我解决一个几何力学问题。\n\n这是我的计划：\n\n1.  **验证问题**：\n    *   **第1步：提取已知条件**：我将列出问题陈述中提供的所有定义和条件。\n        *   组态空间：$Q = \\mathbb{R}^3 \\setminus \\{0\\}$。\n        *   对称群：$G = \\mathrm{SO}(2)$，作用为绕 $z$ 轴的旋转。\n        *   度规：由 $Q$ 上的标准欧几里得度规导出的自由粒子动能度规。这只是限制在 $Q$ 上的 $\\mathbb{R}^3$ 的标准欧几里得度规张量。\n        *   任务 (a)：将轨道空间 $Q/\\mathrm{SO}(2)$ 辨识为 $\\mathbb{R}^2$ 的一个子集并描述其分层拓扑。\n        *   任务 (b)：在正则部分，将 $Q$ 视为一个主 $S^1$ 丛。推导机械联络1-形式 $A$ 并计算其曲率2-形式 $F$。\n    *   **第2步：验证**：我将根据我的验证标准进行检查。\n        *   **科学上成立**：是，这是几何力学中的一个标准问题，处理对称性约化。主丛、机械联络和曲率的概念在此背景下有明确的定义。\n        *   **良态的**：是，问题定义良好。空间、群作用和度规都已明确指定。任务是具体的，并导向唯一的解。\n        *   **客观的**：是，语言是精确和数学化的。\n        *   **完整性**：问题是自洽的。欧几里得度规是标准的，SO(2)作用是指定的。\n        *   **一致性**：无矛盾。\n        *   **可行性**：计算在该领域是标准的。\n        *   **无其他缺陷**：它不平凡，不是比喻性的，并且与指定的主题直接相关。\n\n2.  **解决问题**：如果问题有效，我将继续进行解答。\n\n    *   **部分 (a)：轨道空间与分层**\n        *   **SO(2) 的作用**：一个元素 $R_\\theta \\in \\mathrm{SO}(2)$ 作用于一个点 $(x, y, z) \\in Q$ 的方式是：\n            $$ (x, y, z) \\mapsto (x \\cos\\theta - y \\sin\\theta, x \\sin\\theta + y \\cos\\theta, z) $$\n        *   **不变量**：我需要找到在此作用下不变的函数。离 $z$ 轴的距离 $r = \\sqrt{x^2 + y^2}$ 和垂直坐标 $z$ 显然是不变的。\n        *   **轨道空间**：一个点 $(x, y, z)$ 的轨道是通过将其绕 $z$ 轴旋转得到的所有点的集合。每个轨道由点对 $(r, z)$ 唯一表征。因此，轨道空间 $Q/\\mathrm{SO}(2)$ 可以被辨识为 $(r, z)$ 的所有可能值的集合。\n        *   **坐标**：我们使用柱坐标 $(r, \\theta, z)$ 来表示 $Q$ 中的一个点。一个点 $q \\in Q$ 是 $(x, y, z) = (r \\cos\\theta, r \\sin\\theta, z)$。$\\mathrm{SO}(2)$ 的作用只改变 $\\theta$。\n        *   条件 $q \\in Q = \\mathbb{R}^3 \\setminus \\{0\\}$ 意味着 $(x, y, z) \\neq (0, 0, 0)$。在柱坐标中，这意味着我们不能同时有 $r=0$ 和 $z=0$。由于 $r \\ge 0$，这意味着 $(r,z) \\neq (0,0)$。\n        *   因此，不变量的空间是 $(r,z)$，其中 $r = \\sqrt{x^2+y^2} \\geq 0$ 且 $z \\in \\mathbb{R}$，不包括点 $(r,z)=(0,0)$。所以轨道空间是半平面 $\\{(r, z) \\in \\mathbb{R}^2 \\mid r \\ge 0\\}$ 去掉原点。这是闭合右半平面减去原点。\n        *   **分层**：轨道空间的拓扑根据迷向群进行分层。迷向群 $G_q = \\{g \\in G \\mid g \\cdot q = q\\}$。\n            *   如果 $r = \\sqrt{x^2+y^2} > 0$，点不在 $z$ 轴上。一个角度为 $\\theta$ 的旋转会移动该点，除非 $\\theta = 2\\pi k$（对于某个整数 $k$）。迷向群是平凡的，$G_q = \\{I\\}$。这些轨道称为**主轨道**。这些轨道的集合构成**主分层**。这对应于轨道空间中 $r > 0$ 的区域，即开右半平面。\n            *   如果 $r = \\sqrt{x^2+y^2} = 0$，点在 $z$ 轴上（但不是原点，因为 $q \\neq 0$，所以 $z \\neq 0$）。对于一个点 $(0,0,z)$ 且 $z \\neq 0$，任何绕 $z$ 轴的旋转都使其保持不变。所以迷向群是整个群，$G_q = \\mathrm{SO}(2)$。这些轨道由单个点组成。这些是**奇异轨道**。这些轨道的集合构成**奇异分层**。这对应于轨道空间中的正负 $z$ 轴，即集合 $\\{(r, z) \\mid r=0, z \\neq 0\\}$。\n        *   所以，轨道空间 $S = Q/\\mathrm{SO}(2)$ 是半平面 $\\{(r,z) \\in \\mathbb{R}^2 \\mid r \\geq 0, (r,z) \\neq (0,0)\\}$。\n            *   主分层（正则部分）：$S_{reg} = \\{(r,z) \\mid r>0\\}$。这是一个开流形。\n            *   奇异分层：$S_{sing} = \\{(r,z) \\mid r=0, z \\neq 0\\}$。这是 $S_{reg}$ 的边界减去点 $(0,0)$。\n\n    *   **部分 (b)：机械联络与曲率**\n        *   **设置**：我们在 $Q$ 的正则部分上工作，称之为 $Q_{reg} = \\{ (x,y,z) \\in \\mathbb{R}^3 \\mid x^2+y^2 > 0\\}$。这是一个在约化空间 $S_{reg} = \\{(r,z) \\mid r>0\\}$ 上的主 $\\mathrm{SO}(2) \\cong S^1$ 丛。\n        *   **度规**：动能度规是 $\\mathbb{R}^3$ 上的标准欧几里得度规。在笛卡尔坐标中，$g = dx \\otimes dx + dy \\otimes dy + dz \\otimes dz$。在向量表示法中，$\\langle v, w \\rangle_q = v \\cdot w$。\n        *   **李代数**：$\\mathrm{SO}(2)$ 的李代数是 $\\mathfrak{so}(2) \\cong \\mathbb{R}$。一个基元素是 $\\xi = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$。$Q$ 上对应的无穷小生成元向量场是 $\\xi_Q(q)$。\n            *   作用是 $\\Phi_g(q) = R_g q$。对于 $g=e^{t\\xi}$，向量场是 $\\xi_Q(q) = \\frac{d}{dt}|_{t=0} \\Phi_{e^{t\\xi}}(q)$。\n            *   让我们通过映射 $c \\mapsto c \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$ 将 $\\mathfrak{so}(2)$ 与 $\\mathbb{R}$ 等同。我们取基元素 $\\xi=1 \\in \\mathbb{R}$。对应的旋转矩阵是 $R_t = \\begin{pmatrix} \\cos t  -\\sin t \\\\ \\sin t  \\cos t \\end{pmatrix}$。\n            *   对 $(x,y,z)$ 的作用是 $(x\\cos t - y\\sin t, x\\sin t + y\\cos t, z)$。\n            *   无穷小生成元是 $\\xi_Q(x,y,z) = \\frac{d}{dt}|_{t=0} (x\\cos t - y\\sin t, x\\sin t + y\\cos t, z) = (-y, x, 0)$。\n            *   用向量表示法，$\\xi_Q = -y \\frac{\\partial}{\\partial x} + x \\frac{\\partial}{\\partial y}$。\n        *   **动量映射**：锁定惯性张量 $I(q) : \\mathfrak{g} \\to \\mathfrak{g}^*$ 由 $\\langle I(q)\\xi, \\eta \\rangle = \\langle \\xi_Q(q), \\eta_Q(q) \\rangle_q$ 定义。\n            *   通过我们的等同关系 $\\mathfrak{g} \\cong \\mathbb{R}$，$I(q)$ 只是一个数（对每个 $q$）。令 $\\xi=1$。\n            *   $I(q) = \\langle \\xi_Q(q), \\xi_Q(q) \\rangle_q = \\langle (-y, x, 0), (-y, x, 0) \\rangle = (-y)^2 + x^2 + 0^2 = x^2+y^2$。在柱坐标中，$I(q) = r^2$。\n        *   **机械联络**：机械联络1-形式 $A \\in \\Omega^1(Q, \\mathfrak{g})$ 由 $A_q(v_q) = I(q)^{-1} J(v_q)$ 定义，其中 $J$ 是动量映射。\n            *   动量映射 $J: TQ \\to \\mathfrak{g}^*$ 由 $\\langle J(v_q), \\xi \\rangle = \\langle v_q, \\xi_Q(q) \\rangle_q$ 定义。\n            *   设 $v_q = (v_x, v_y, v_z)$ 是在 $q=(x,y,z)$ 处的一个切向量。\n            *   $\\langle J(v_q), \\xi \\rangle = \\langle (v_x, v_y, v_z), (-y, x, 0) \\rangle = -y v_x + x v_y$。\n            *   将 $\\mathfrak{g}^* \\cong \\mathbb{R}$ 等同，我们得到 $J(v_q) = -y v_x + x v_y$。\n            *   现在，我们可以写出联络形式 $A$。对于 $v_q \\in T_q Q$，$A(v_q) = I(q)^{-1} J(v_q) = \\frac{-y v_x + x v_y}{x^2+y^2}$。\n            *   作为一个1-形式，我们可以将其写为 $A = \\frac{-y dx + x dy}{x^2+y^2}$。这是著名的“角”1-形式。在柱坐标中，$x=r\\cos\\theta, y=r\\sin\\theta$。\n                *   $dx = \\cos\\theta dr - r\\sin\\theta d\\theta$\n                *   $dy = \\sin\\theta dr + r\\cos\\theta d\\theta$\n                *   $-y dx + x dy = -(r\\sin\\theta)(\\cos\\theta dr - r\\sin\\theta d\\theta) + (r\\cos\\theta)(\\sin\\theta dr + r\\cos\\theta d\\theta)$\n                *   $= -r\\sin\\theta\\cos\\theta dr + r^2\\sin^2\\theta d\\theta + r\\cos\\theta\\sin\\theta dr + r^2\\cos^2\\theta d\\theta$\n                *   $= r^2(\\sin^2\\theta + \\cos^2\\theta) d\\theta = r^2 d\\theta$。\n                *   $x^2+y^2 = r^2$。\n                *   所以，$A = \\frac{r^2 d\\theta}{r^2} = d\\theta$。这很合理。垂直空间由 $\\frac{\\partial}{\\partial\\theta}$ 张成，水平空间由 $\\frac{\\partial}{\\partial r}, \\frac{\\partial}{\\partial z}$ 张成。联络 $A$ 在流的生成元（即 $\\frac{\\partial}{\\partial\\theta}$）上应为 $1$，在水平向量上应为 $0$。生成元是 $\\xi_Q = -y\\partial_x + x\\partial_y = \\partial_\\theta$。$A(\\partial_\\theta) = d\\theta(\\partial_\\theta) = 1$。$A(\\partial_r) = 0$，$A(\\partial_z)=0$。这是正确的。\n        *   **曲率2-形式**：曲率是 $F=dA$。等等，这是在总空间 $Q$ 上。问题要求的是在*基底*上的曲率2-形式 $F$。主丛上联络的曲率是一个基本2-形式，即它可以被看作是基空间上的一个2-形式。我们先计算 $dA$。\n            *   $A = \\frac{-y dx + x dy}{x^2+y^2}$。\n            *   $dA = d \\left( \\frac{-y}{x^2+y^2} \\right) \\wedge dx + d \\left( \\frac{x}{x^2+y^2} \\right) \\wedge dy$。\n            *   $d \\left( \\frac{-y}{x^2+y^2} \\right) = \\frac{\\partial}{\\partial x}\\left( \\frac{-y}{x^2+y^2} \\right) dx + \\frac{\\partial}{\\partial y}\\left( \\frac{-y}{x^2+y^2} \\right) dy$。\n                *   $\\frac{\\partial}{\\partial x}\\left( \\frac{-y}{x^2+y^2} \\right) = -y (-1)(x^2+y^2)^{-2}(2x) = \\frac{2xy}{(x^2+y^2)^2}$。\n                *   $\\frac{\\partial}{\\partial y}\\left( \\frac{-y}{x^2+y^2} \\right) = \\frac{-1(x^2+y^2) - (-y)(2y)}{(x^2+y^2)^2} = \\frac{-x^2-y^2+2y^2}{(x^2+y^2)^2} = \\frac{y^2-x^2}{(x^2+y^2)^2}$。\n            *   $d \\left( \\frac{x}{x^2+y^2} \\right) = \\frac{\\partial}{\\partial x}\\left( \\frac{x}{x^2+y^2} \\right) dx + \\frac{\\partial}{\\partial y}\\left( \\frac{x}{x^2+y^2} \\right) dy$。\n                *   $\\frac{\\partial}{\\partial x}\\left( \\frac{x}{x^2+y^2} \\right) = \\frac{1(x^2+y^2) - x(2x)}{(x^2+y^2)^2} = \\frac{y^2-x^2}{(x^2+y^2)^2}$。\n                *   $\\frac{\\partial}{\\partial y}\\left( \\frac{x}{x^2+y^2} \\right) = x (-1)(x^2+y^2)^{-2}(2y) = \\frac{-2xy}{(x^2+y^2)^2}$。\n            *   所以，$dA = \\left( \\frac{2xy}{(x^2+y^2)^2} dx + \\frac{y^2-x^2}{(x^2+y^2)^2} dy \\right) \\wedge dx + \\left( \\frac{y^2-x^2}{(x^2+y^2)^2} dx + \\frac{-2xy}{(x^2+y^2)^2} dy \\right) \\wedge dy$。\n            *   使用 $dx \\wedge dx = 0$ 和 $dy \\wedge dy = 0$，以及 $dy \\wedge dx = -dx \\wedge dy$：\n            *   $dA = \\frac{y^2-x^2}{(x^2+y^2)^2} dy \\wedge dx + \\frac{y^2-x^2}{(x^2+y^2)^2} dx \\wedge dy$。\n            *   这仍然得到零。我的错误在哪里？\n            *   1-形式 $\\omega = f dx + g dy$ 的外微分公式是 $d\\omega = (\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y}) dx \\wedge dy$。\n            *   这里 $f = \\frac{-y}{x^2+y^2}$ 且 $g = \\frac{x}{x^2+y^2}$。还有一个为零的 $dz$ 分量。我们写 $A = f(x,y) dx + g(x,y) dy + h(x,y,z) dz$。这里 $h=0$。\n            *   $dA = (\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y}) dx \\wedge dy + (\\frac{\\partial h}{\\partial x} - \\frac{\\partial f}{\\partial z}) dx \\wedge dz + (\\frac{\\partial h}{\\partial y} - \\frac{\\partial g}{\\partial z}) dy \\wedge dz$。\n            *   由于 $f$ 和 $g$ 不依赖于 $z$，并且 $h=0$，最后两项为零。\n            *   所以 $dA = (\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y}) dx \\wedge dy$。\n            *   $g = \\frac{x}{x^2+y^2}$。$\\frac{\\partial g}{\\partial x} = \\frac{1(x^2+y^2) - x(2x)}{(x^2+y^2)^2} = \\frac{y^2-x^2}{(x^2+y^2)^2}$。\n            *   $f = \\frac{-y}{x^2+y^2}$。$\\frac{\\partial f}{\\partial y} = \\frac{-1(x^2+y^2) - (-y)(2y)}{(x^2+y^2)^2} = \\frac{-x^2-y^2+2y^2}{(x^2+y^2)^2} = \\frac{y^2-x^2}{(x^2+y^2)^2}$。\n            *   $\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y} = \\frac{y^2-x^2}{(x^2+y^2)^2} - \\frac{y^2-x^2}{(x^2+y^2)^2} = 0$。\n            *   所以 $dA = 0$。这意味着联络是平坦的。\n\n我再读一遍联络和曲率的定义。\n联络1-形式 $A$ 是 $Q$ 上的一个取值于 $\\mathfrak{g}$ 的形式。其曲率是 $F=dA + \\frac{1}{2}[A,A]$。\n因为群是 $\\mathrm{SO}(2)$，是阿贝尔群，所以李括号为零。所以 $[A,A] = 0$。\n因此，$F = dA$。\n我的计算得出 $F=dA=0$。这是预期的答案吗？\n\n让我们从物理上思考一下。这个系统是 $\\mathbb{R}^3$ 中的一个自由粒子。组态空间是 $Q = \\mathbb{R}^3 \\setminus \\{0\\}$。对称性是绕 $z$ 轴的旋转。\n约化空间 $S = Q/G$ 的坐标是 $(r,z)$，其中 $r = \\sqrt{x^2+y^2}$。\n约化空间中的动力学由一个有效势，即“离心势”所支配。\n拉格朗日量是 $L = \\frac{1}{2}m(\\dot{x}^2+\\dot{y}^2+\\dot{z}^2)$。设 $m=1$。\n在柱坐标中，$L = \\frac{1}{2}(\\dot{r}^2 + r^2\\dot{\\theta}^2 + \\dot{z}^2)$。\n坐标 $\\theta$ 是循环坐标。对应的守恒动量是 $p_\\theta = \\frac{\\partial L}{\\partial \\dot{\\theta}} = r^2\\dot{\\theta}$。我们称这个动量为 $\\mu$。\n鲁斯函数是 $R = L - p_\\theta \\dot{\\theta} = L - \\mu \\dot{\\theta} = \\frac{1}{2}(\\dot{r}^2 + r^2\\dot{\\theta}^2 + \\dot{z}^2) - (r^2\\dot{\\theta})\\dot{\\theta} = \\frac{1}{2}(\\dot{r}^2 - r^2\\dot{\\theta}^2 + \\dot{z}^2)$。\n代入 $\\dot\\theta = \\mu/r^2$，我们得到动量水平集 $J=\\mu$ 上的约化拉格朗日量。\n$L_\\mu(\\dot{r}, \\dot{z}, r, z) = \\frac{1}{2}(\\dot{r}^2 + \\dot{z}^2) - \\frac{\\mu^2}{2r^2}$。\n项 $V_{eff} = \\frac{\\mu^2}{2r^2}$ 是有效势。\n机械联络的曲率与约化系统中的类磁力有关。\n具体来说，对于一个电荷为 $e$ 的粒子在矢量势为 $\\mathbf{A}$ 的磁场中运动，拉格朗日量中的相互作用项是 $e \\mathbf{A} \\cdot \\mathbf{v}$。磁场是 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$。曲率2-形式 $F$ 对应于这个磁场。\n在我们的情况下，约化拉格朗日量中没有任何形式为 $f(r,z)\\dot{r} + g(r,z)\\dot{z}$ 的关于速度 $(\\dot{r}, \\dot{z})$ 的线性项。这样的项会由一个“磁”势产生。没有这样的项表明曲率应为零。\n\n我来检查一下理论。基空间 $S$ 上的卡鲁扎-克莱因度规由原始度规的水平部分给出。联络 $A$ 的曲率在约化运动方程中表现为一个回转项或磁项。\n在 $q$ 处的水平空间是垂直空间关于度规的正交补。\n$T_q Q = \\mathrm{Ver}_q \\oplus \\mathrm{Hor}_q$。\n$\\mathrm{Ver}_q = \\mathrm{span}\\{\\xi_Q(q)\\}$。对我们来说，$\\xi_Q(q) = (-y, x, 0)$。\n一个向量 $v = (v_x, v_y, v_z)$ 是水平的，如果 $\\langle v, \\xi_Q(q) \\rangle_q = 0$。\n$\\langle (v_x, v_y, v_z), (-y, x, 0) \\rangle = -y v_x + x v_y = 0$。\n这是水平性的条件。\n联络 $A$ 的定义使其核为水平空间。\n$A_q(v_q) = I(q)^{-1} J(v_q)$。$J(v_q)$ 是动量映射的求值，它与 $\\langle v_q, \\xi_Q(q) \\rangle_q$ 成正比。\n所以 $\\ker A_q = \\{v_q \\mid \\langle v_q, \\xi_Q(q) \\rangle_q = 0\\}$，这正是水平空间。这是一致的。\n\n形式 $A = \\frac{x dy - y dx}{x^2+y^2}$ 在 $\\mathbb{R}^2 \\setminus \\{0\\}$ 的任何单连通子集上确实是闭的（$dA=0$），但不是恰当的。它在 $\\mathbb{R}^3 \\setminus \\{z\\text{-轴}\\}$ 上是恰当的，这是我们的正则空间 $Q_{reg}$。\n$A = d(\\arctan(y/x)) = d\\theta$。\n这意味着 $A$ 是一个平坦联络。等等，$d(d\\theta)=0$。\n如果一个联络的曲率为零，它就是平坦的。所以我的结果 $F=0$ 是正确的。\n我再仔细检查一下问题，“从第一性原理出发，推导联络1-形式 A 的显式表达式……并计算其曲率2-形式 F”。\n看来结果确实是 $F=0$。\n\n现在，我需要小心。问题是在 $Q = \\mathbb{R}^3 \\setminus \\{0\\}$ 中设定的。\n1-形式 $A = d\\theta$ 在 $Q$ 上不是全局定义的。$\\theta$ 不是一个全局函数。\n然而，$A = \\frac{x dy - y dx}{x^2+y^2}$ 是在 $Q_{reg} = \\mathbb{R}^3 \\setminus \\{z\\text{-轴}\\}$ 上的一个良定义的1-形式。\n在这个定义域上，$dA=0$。定义域 $Q_{reg}$ 不是单连通的。它同伦等价于一个圆 $S^1$。但这并不意味着 $A$ 必须不是恰当的。\n我们来检查一下 $A$ 在 $Q_{reg}$ 上是否是恰当的。是否存在一个在 $Q_{reg}$ 上的函数 $f$ 使得 $A=df$？\n是的，$f = \\theta = \\arctan(y/x)$ 就是这样一个函数，但它不是单值的。\n然而，如果我们限制在一个单连通子集上，比如说 $x>0$，那么 $f = \\arctan(y/x)$ 是一个良定义的光滑函数，并且 $A=df$。\n在整个 $Q_{reg}$ 上，$A$ 是闭的但不是恰当的。$A$ 绕着 $z$ 轴的一个闭环的积分是 $\\int_{S^1} d\\theta = 2\\pi \\neq 0$。\n所以 $A$ 在 $Q_{reg}$ 上不是恰当的。\n但它的外微分 $dA$ 在 $Q_{reg}$ 上处处为零。因此曲率 $F=dA$ 是零2-形式。\n\n我是否遗漏了什么微妙之处？\n这个问题是关于一个自由粒子。组态空间 $Q$ 是平坦的（它是欧几里得空间的一个子集）。对称群 $G$ 以等距方式作用。\n在主丛上带有联络 $A$ 的粒子运动的Wong方程是：\n1. 基流形中路径 $s(t)$ 的方程：$\\nabla_{\\dot{s}} \\dot{s} = k(\\mu, F(\\dot{s}, \\cdot))$。这描述了由于磁场 $F$ 引起的路径“偏转”。\n2. 动量 $\\mu$ 的方程：$\\dot{\\mu} = 0$。（因为群是阿贝尔群）。\n对我们的粒子来说，轨迹是 $\\mathbb{R}^3$ 中的直线。设 $q(t) = q_0 + v_0 t$。\n这个路径到基空间 $S$ 的投影是 $s(t) = \\pi(q(t))$。\n基空间上的坐标是 $(r,z)$。\n$r(t) = \\sqrt{(x_0+v_x t)^2 + (y_0+v_y t)^2}$\n$z(t) = z_0+v_z t$。\n$(r,z)$ 的运动方程可以从约化拉格朗日量 $L_{red} = \\frac{1}{2}(\\dot{r}^2+\\dot{z}^2) - V_{eff}(r)$ 得到，其中 $V_{eff} = \\frac{\\mu^2}{2r^2}$，$\\mu$ 是绕 $z$ 轴的守恒角动量。\n欧拉-拉格朗日方程是：\n$\\frac{d}{dt}(\\frac{\\partial L_{red}}{\\partial \\dot{r}}) - \\frac{\\partial L_{red}}{\\partial r} = 0 \\implies \\ddot{r} - \\frac{\\partial}{\\partial r}(-\\frac{\\mu^2}{2r^2}) = 0 \\implies \\ddot{r} = -\\frac{\\mu^2}{r^3}(-1) = \\frac{\\mu^2}{r^3}$。\n$\\frac{d}{dt}(\\frac{\\partial L_{red}}{\\partial \\dot{z}}) - \\frac{\\partial L_{red}}{\\partial z} = 0 \\implies \\ddot{z} = 0$。\n这些是在 $xy$ 平面受到中心力（离心力）作用并在 $z$ 方向自由运动的粒子的径向和垂直坐标的正确运动方程。\n在这些方程中没有回转/磁项（即在力表达式中依赖于 $\\dot{r}$ 或 $\\dot{z}$ 的项）。这证实了曲率形式必须为零。\n\n所以，结果 $F=0$ 看来是可靠的。我通过直接计算（$F=dA$）得到了它，并且它与约化系统的物理释义是一致的。\n\n现在，我将组织解答。\n第一部分 (a)：轨道空间。\n- 坐标、作用、不变量。\n- 将轨道空间 $Q/\\mathrm{SO}(2)$ 辨识为 $\\{(r,z) \\in \\mathbb{R}^2 \\mid r \\ge 0, (r,z) \\neq (0,0)\\}$。\n- 分层：\n    - $r>0$ 的点：迷向群是平凡的。主分层。这是半平面的内部。\n    - $r=0$ 的点（且 $z \\neq 0$）：迷向群是 $\\mathrm{SO}(2)$。奇异分层。这是半平面的边界（$z$ 轴），不包括原点。\n\n第二部分 (b)：联络和曲率。\n- 在正则部分 $Q_{reg} = \\{q \\in Q \\mid r>0\\}$ 上工作，即 $\\mathbb{R}^3 \\setminus \\{z\\text{-轴}\\}$。\n- 定义动能度规：$\\langle v, w \\rangle = v \\cdot w$。\n- 辨识李代数 $\\mathfrak{so}(2) \\cong \\mathbb{R}$。\n- 找到 $\\xi=1 \\in \\mathbb{R}$ 作用的无穷小生成元向量场。$\\xi_Q = -y \\partial_x + x \\partial_y$。\n- 计算锁定惯性张量 $I(q): \\mathfrak{so}(2) \\to \\mathfrak{so}(2)^*$。\n    - $I(q)(\\xi, \\eta) = \\langle \\xi_Q(q), \\eta_Q(q) \\rangle_q$。\n    - 对于 $\\xi=\\eta=1$，$I(q)(1,1) \\equiv I(q) = \\langle \\xi_Q, \\xi_Q \\rangle = \\|(-y,x,0)\\|^2 = x^2+y^2$。\n- 计算动量映射 $J: TQ \\to \\mathfrak{so}(2)^*$。\n    - $J(v_q)(\\xi) = \\langle v_q, \\xi_Q(q) \\rangle_q$。\n    - 对于 $v_q \\in T_qQ$ 和 $\\xi=1$，$J(v_q)(1) \\equiv J(v_q) = \\langle v_q, (-y,x,0) \\rangle$。\n    - 如果 $v_q$ 由微分算子 $v_x \\partial_x + v_y \\partial_y + v_z \\partial_z$ 表示，它的对偶是 $v_x dx + v_y dy + v_z dz$。等等，不，这很混乱。\n    - 设 $v_q = (v_x, v_y, v_z)$ 是一个向量。1-形式 $J(v_q)$ 在 $\\xi=1$ 上的值是 $-yv_x + xv_y$。\n    - 我们想把联络 $A$ 表示为1-形式。$A(v_q) = I(q)^{-1} J(v_q)$。\n    - 设 $v_q = \\frac{\\partial}{\\partial x}$。那么 $v_x=1, v_y=0, v_z=0$。$A(\\frac{\\partial}{\\partial x}) = \\frac{-y(1)+x(0)}{x^2+y^2} = \\frac{-y}{x^2+y^2}$。\n    - 设 $v_q = \\frac{\\partial}{\\partial y}$。那么 $v_x=0, v_y=1, v_z=0$。$A(\\frac{\\partial}{\\partial y}) = \\frac{-y(0)+x(1)}{x^2+y^2} = \\frac{x}{x^2+y^2}$。\n    - 设 $v_q = \\frac{\\partial}{\\partial z}$。那么 $v_x=0, v_y=0, v_z=1$。$A(\\frac{\\partial}{\\partial z}) = \\frac{-y(0)+x(0)}{x^2+y^2} = 0$。\n    - 所以1-形式是 $A = A(\\frac{\\partial}{\\partial x})dx + A(\\frac{\\partial}{\\partial y})dy + A(\\frac{\\partial}{\\partial z})dz = \\frac{-y}{x^2+y^2}dx + \\frac{x}{x^2+y^2}dy$。\n- 这证实了我对 $A$ 的表达式。\n- 计算曲率 $F = dA$（因为群是阿贝尔的）。\n- 使用公式 $d(f dx + g dy) = (\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y}) dx \\wedge dy$。\n    - $f = \\frac{-y}{x^2+y^2}$，$g = \\frac{x}{x^2+y^2}$。\n    - $\\frac{\\partial g}{\\partial x} = \\frac{(x^2+y^2) - x(2x)}{(x^2+y^2)^2} = \\frac{y^2-x^2}{(x^2+y^2)^2}$。\n    - $\\frac{\\partial f}{\\partial y} = \\frac{-(x^2+y^2) - (-y)(2y)}{(x^2+y^2)^2} = \\frac{y^2-x^2}{(x^2+y^2)^2}$。\n    - $\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y} = 0$。\n- 所以 $F=0$。\n\n问题要求“基底正则部分上曲率2-形式 F 的显式解析表达式”。\n曲率 $F=dA$ 是 $Q$ 上的一个2-形式。这是一个基本形式，意味着它是水平的（对于任何垂直向量场 $V$，有 $i_V F = 0$）并且是 $G$-不变的。因此，它是基空间 $S = Q/G$ 上唯一2-形式 $\\Omega$ 的拉回，使得 $F = \\pi^* \\Omega$。这个 $\\Omega$ 就是通常所说的基底上的曲率。\n由于在 $Q$ 上 $F=0$，它到基底 $S$ 的拉回也是 $\\Omega=0$。\n所以最终答案是零2-形式。怎么写？“0”。\n将数字“0”框起来似乎是合适的。\n\n我将按照我制定的推导过程，清晰地、一步一步地写出解答。我必须非常小心LaTeX格式。每一个数学实体都必须在LaTeX中。这是一个非常严格的要求。\n\n(a) 轨道空间与分层\n\n组态空间为 $Q = \\mathbb{R}^{3} \\setminus \\{(0,0,0)\\}$。群 $G = \\mathrm{SO}(2)$ 通过绕 $z$ 轴的旋转作用于点 $q=(x,y,z) \\in Q$。对应于旋转角度 $\\phi$ 的元素 $R_{\\phi} \\in \\mathrm{SO}(2)$ 的作用方式为：\n$$\n\\Phi(R_{\\phi}, (x,y,z)) = (x\\cos\\phi - y\\sin\\phi, x\\sin\\phi + y\\cos\\phi, z)\n$$\n为辨识轨道空间 $M = Q/G$，我们必须找到在此作用下不变的一组坐标。使用柱坐标 $(r, \\theta, z)$，其中 $x=r\\cos\\theta$，$y=r\\sin\\theta$，$z=z$，该作用只影响角度 $\\theta \\to \\theta+\\phi$。坐标 $r = \\sqrt{x^{2}+y^{2}}$（离 $z$ 轴的径向距离）和 $z$ 在此作用下是不变的。因此，一个轨道由 $r$ 和 $z$ 的值唯一确定。\n条件 $q \\in Q$ 意味着 $(x,y,z) \\neq (0,0,0)$，这在柱坐标中转化为条件 $r$ 和 $z$ 不得同时为零。由于 $r \\geq 0$，轨道空间 $M = Q/\\mathrm{SO}(2)$ 可被辨识为 $\\mathbb{R}^{2}$ 中满足 $r \\geq 0$ 且 $(r,z) \\neq (0,0)$ 的点对 $(r,z)$ 的集合。这是 $\\mathbb{R}^{2}$ 中移除了原点的闭右半平面。\n\n轨道空间的分层由轨道类型决定，轨道类型通过迷向子群 $G_{q} = \\{g \\in G \\mid \\Phi(g,q)=q\\}$ 进行分类。\n$1$. 对于不在 $z$ 轴上的点 $q=(x,y,z)$，我们有 $r = \\sqrt{x^{2}+y^{2}} > 0$。一个角度为 $\\phi$ 的旋转能固定 $q$ 当且仅当 $\\phi = 2\\pi k$（其中 $k \\in \\mathbb{Z}$ 为某个整数）。因此，迷向群 $G_{q}$ 是平凡子群 $\\{I\\}$。这些是主轨道，它们构成了轨道空间的**主分层**。这对应于 $r>0$ 的区域，即开右半平面 $\\{(r,z) \\in \\mathbb{R}^{2} \\mid r>0\\}$。\n$2$. 对于在 $z$ 轴上的点 $q=(x,y,z)$，我们有 $r=\\sqrt{x^{2}+y^{2}}=0$。由于 $q \\neq (0,0,0)$，我们有 $z \\neq 0$。任何绕 $z$ 轴的旋转都会使这样的点 $q=(0,0,z)$ 保持不变。因此，迷向群 $G_{q}$ 是整个群 $\\mathrm{SO}(2)$。这些是奇异轨道，它们构成了**奇异分层**。这对应于 $r=0$ 且 $z \\neq 0$ 的点集，即轨道空间中除去原点的正负 $z$ 轴：$\\{(0,z) \\in \\mathbb{R}^{2} \\mid z \\neq 0\\}$。\n\n(b) 机械联络与曲率\n\n我们在 $Q$ 的正则部分上工作，记为 $Q_{reg} = \\{q \\in Q \\mid \\sqrt{x^{2}+y^{2}} > 0\\}$，即 $\\mathbb{R}^{3}$ 减去 $z$ 轴。此空间是主分层 $M_{reg} = \\{(r,z) \\mid r>0\\}$ 上的一个主纤维丛，其结构群为 $G = \\mathrm{SO}(2) \\cong \\mathrm{S}^{1}$。\n\n动能度规是 $\\mathbb{R}^{3}$ 上的标准欧几里得度规，对于 $v, w \\in T_{q}Q \\cong \\mathbb{R}^{3}$，有 $\\langle v, w \\rangle_{q} = v \\cdot w$。$G$ 的李代数是 $\\mathfrak{g} = \\mathfrak{so}(2)$，它同构于 $\\mathbb{R}$。我们选择一个对应于 $1 \\in \\mathbb{R}$ 的基元素 $\\xi \\in \\mathfrak{g}$。对应于 $\\xi$ 的 $Q$ 上的无穷小生成元向量场是：\n$$\n\\xi_{Q}(q) = \\frac{d}{dt}\\bigg|_{t=0} \\Phi(R_{t}, q) = \\frac{d}{dt}\\bigg|_{t=0} (x\\cos t - y\\sin t, x\\sin t + y\\cos t, z) = (-y, x, 0)\n$$\n用偏导数表示，$\\xi_{Q} = -y\\frac{\\partial}{\\partial x} + x\\frac{\\partial}{\\partial y}$。\n\n锁定惯性张量 $I: Q \\to L(\\mathfrak{g}, \\mathfrak{g}^{*})$ 定义为 $\\langle I(q)\\eta, \\zeta\\rangle = \\langle \\eta_{Q}(q), \\zeta_{Q}(q) \\rangle_{q}$，其中 $\\eta, \\zeta \\in \\mathfrak{g}$。利用同构关系 $\\mathfrak{g} \\cong \\mathbb{R}$，$I(q)$ 是一个标量，其对于我们的基元素 $\\xi=1$ 的值为：\n$$\nI(q) = \\langle \\xi_{Q}(q), \\xi_{Q}(q) \\rangle_{q} = \\langle (-y,x,0), (-y,x,0) \\rangle = x^{2}+y^{2}\n$$\n动量映射 $J: TQ \\to \\mathfrak{g}^{*}$ 定义为 $\\langle J(v_{q}), \\eta \\rangle = \\langle v_{q}, \\eta_{Q}(q) \\rangle_{q}$，其中 $v_{q} \\in T_{q}Q$ 且 $\\eta \\in \\mathfrak{g}$。对于点 $q=(x,y,z)$ 处的切向量 $v_{q}=(v_{x}, v_{y}, v_{z})$，其在基 $\\xi=1$ 上的值为：\n$$\nJ(v_{q}) = \\langle v_{q}, \\xi_{Q}(q) \\rangle_{q} = \\langle (v_{x},v_{y},v_{z}), (-y,x,0) \\rangle = -yv_{x} + xv_{y}\n$$\n机械联络是在 $Q_{reg}$ 上的一个取值于 $\\mathfrak{g}$ 的1-形式 $A$，定义为 $A_{q}(v_{q}) = I(q)^{-1}J(v_{q})$。代入我们得到的 $I(q)$ 和 $J(v_{q})$ 的表达式：\n$$\nA_{q}(v_{q}) = \\frac{-yv_{x} + xv_{y}}{x^{2}+y^{2}}\n$$\n为了将 $A$ 写成笛卡尔坐标下的1-形式，我们在基向量 $\\frac{\\partial}{\\partial x}$、$\\frac{\\partial}{\\partial y}$ 和 $\\frac{\\partial}{\\partial z}$ 上对其求值：\n$A(\\frac{\\partial}{\\partial x}) = \\frac{-y}{x^{2}+y^{2}}$, $A(\\frac{\\partial}{\\partial y}) = \\frac{x}{x^{2}+y^{2}}$, 和 $A(\\frac{\\partial}{\\partial z}) = 0$。\n因此，联络1-形式为：\n$$\nA = \\frac{-y}{x^{2}+y^{2}} dx + \\frac{x}{x^{2}+y^{2}} dy\n$$\n联络 $A$ 的曲率2-形式 $F$ 由 $F = dA + \\frac{1}{2}[A,A]$ 给出。由于群 $\\mathrm{SO}(2)$ 是阿贝尔群，其李代数 $\\mathfrak{so}(2)$ 的李括号是平凡的，所以 $[A,A]=0$。因此，曲率就是联络的外微分，$F=dA$。我们使用平面上1-形式的公式 $d(\\omega) = d(f dx + g dy) = (\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y}) dx \\wedge dy$ 来计算它。这里，$A$ 没有 $dz$ 分量，且其分量不依赖于 $z$。\n设 $f(x,y) = \\frac{-y}{x^{2}+y^{2}}$ 且 $g(x,y) = \\frac{x}{x^{2}+y^{2}}$。\n我们计算偏导数：\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{x}{x^{2}+y^{2}}\\right) = \\frac{1 \\cdot (x^{2}+y^{2}) - x \\cdot (2x)}{(x^{2}+y^{2})^{2}} = \\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}}\n$$\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(\\frac{-y}{x^{2}+y^{2}}\\right) = \\frac{-1 \\cdot (x^{2}+y^{2}) - (-y) \\cdot (2y)}{(x^{2}+y^{2})^{2}} = \\frac{-x^{2}-y^{2}+2y^{2}}{(x^{2}+y^{2})^{2}} = \\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}}\n$$\n因此，$F=dA$ 中 $dx \\wedge dy$ 的系数为：\n$$\n\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y} = \\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}} - \\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}} = 0\n$$\n因此，$Q_{reg}$ 上的曲率2-形式为 $F=0$。由于 $F$ 是一个基本形式，它可以下降为基空间 $M_{reg}$ 上的一个2-形式。因为 $F$ 在总空间上恒为零，所以基空间上的对应形式也恒为零。这表明该联络是平坦的，这对于欧几里得空间中的自由粒子是预料之中的，因为在约化系统中没有内在的陀螺力或“磁”力。约化的唯一效应是出现了一个离心势能项。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "联络的抽象定义如何与物理学和工程中常见的“规范势”概念联系起来？本练习旨在搭建这一桥梁，展示如何将主丛上的联络 $1$-形式在局部平凡化中表达为底空间上的规范势。你将利用此表达式计算沿给定闭合路径的完整群（holonomy），这是重构问题的核心：根据底空间中的运动确定群变量的演化，即几何相位的累积。",
            "id": "3764100",
            "problem": "设 $Q \\to U$ 是一个以 $G$ 为结构群的主丛，其中 $U \\subset \\mathbb{R}^{2}$ 是一个开集，$G$ 是一个李群。固定一个局部平凡化 $Q|_{U} \\cong U \\times G$，其坐标为 $(x,g)$，其中 $x \\in U$ 且 $g \\in G$。一个主联络由一个 $\\mathfrak{g}$ 值 1-形式 $\\mathcal{A} \\in \\Omega^{1}(Q,\\mathfrak{g})$ 所指定，它满足两个基本性质：(i) 生成元的再生，即对所有 $\\xi \\in \\mathfrak{g}$，有 $\\mathcal{A}(\\xi_{Q})=\\xi$，其中 $\\xi_{Q}$ 是由 $\\xi$ 在右 $G$-作用下生成的基本向量场；(ii) 右等变性，即对所有 $h \\in G$，有 $R_{h}^{*}\\mathcal{A}=\\mathrm{Ad}_{h^{-1}}\\mathcal{A}$，其中 $R_{h}$ 表示在 $Q$ 上的右平移，$\\mathrm{Ad}$ 是伴随作用。\n\n任务1. 仅从这些定义以及 $G$ 上的右 Maurer–Cartan 形式是能够再生生成元并满足 Maurer–Cartan 结构方程的 $\\mathfrak{g}$ 值 1-形式 $\\theta^{R}_{g} := T_{g}R_{g^{-1}}$ 这一事实出发，推导该联络 1-形式在平凡化中的局部坐标表达式。证明存在一个唯一的局部 $\\mathfrak{g}$ 值 1-形式 $A(x) \\in \\Omega^{1}(U,\\mathfrak{g})$，使得 $\\mathcal{A}$ 可以在平凡化 $(x,g)$ 中写成一个来自 $G$ 的垂直分量和一个从 $U$ 拉回的水平分量之和。\n\n任务2. 现在特别考虑 $G=\\mathrm{U}(1)$，其李代数为 $\\mathfrak{u}(1)=\\mathrm{i}\\mathbb{R}$，并使用相同的局部平凡化 $Q|_{U}\\cong U \\times \\mathrm{U}(1)$。考虑底曲线 $x(t)=(R\\cos(\\omega t), R\\sin(\\omega t))$，其中 $t \\in [0,2\\pi/\\omega]$，且 $R>0$ 和 $\\omega>0$ 是固定的实常数。假设 $Q$ 上的动力学由一个水平提升条件重构，即速度 $(\\dot{x}(t),\\dot{g}(t))$ 对所有 $t$ 满足 $\\mathcal{A}(\\dot{x}(t),\\dot{g}(t))=0$。取 $U$ 上的局部规范势为\n$$\nA(x)=\\frac{\\mathrm{i}B}{2}\\left(-x_{2}\\,\\mathrm{d}x_{1}+x_{1}\\,\\mathrm{d}x_{2}\\right),\n$$\n其中 $B \\in \\mathbb{R}$ 是常数。使用任务1中得到的 $\\mathcal{A}$ 的表达式和水平条件，推导并求解 $g(t) \\in \\mathrm{U}(1)$ 的重构方程，其初始条件为 $g(0)=\\mathrm{e}$，其中 $\\mathrm{e}$ 表示 $\\mathrm{U}(1)$ 的单位元。\n\n给出 $g(2\\pi/\\omega)$ 的单个闭式解析表达式作为最终答案。不需要进行数值舍入，最终表达式中也不应包含物理单位。",
            "solution": "这个问题分为两部分。第一部分要求在给定的平凡化中推导主联络 1-形式的局部表达式。第二部分涉及将此结果应用于主丛 $U \\times \\mathrm{U}(1)$ 上的一个特定情况，以计算给定路径的和乐。\n\n### 任务1：联络 1-形式的局部表达式\n\n设 $Q \\to U$ 是一个以 $G$ 为结构群的主丛。我们给定了一个局部平凡化，它将丛的一部分 $Q|_U$ 等同于积流形 $U \\times G$。因此，$Q|_U$ 中的一个点由坐标 $(x, g)$ 表示，其中 $x \\in U$ 且 $g \\in G$。点 $(x,g)$ 处的切空间可以分解为 $T_{(x,g)}(U \\times G) \\cong T_x U \\oplus T_g G$。任何切向量 $V \\in T_{(x,g)}(U \\times G)$ 都可以写成一对 $V = (v_x, v_g)$，其中 $v_x \\in T_x U$ 是相对于积结构的“水平”分量，$v_g \\in T_g G$ 是“垂直”分量。\n\n主联络 $\\mathcal{A}$ 是 $Q$ 上的一个 $\\mathfrak{g}$ 值 1-形式。根据线性性，它对 $V = (v_x, v_g)$ 的作用是 $\\mathcal{A}_{(x,g)}(V) = \\mathcal{A}_{(x,g)}(v_x, 0) + \\mathcal{A}_{(x,g)}(0, v_g)$。我们分别分析这两项。\n\n1.  **对垂直向量的作用：** 一个纯垂直向量的形式为 $(0, v_g)$，其中 $v_g \\in T_g G$。根据联络的性质 (i)，对于任何 $\\xi \\in \\mathfrak{g}$，有 $\\mathcal{A}(\\xi_Q) = \\xi$，其中 $\\xi_Q$ 是由 $\\xi$ 生成的 $Q$ 上的基本向量场。在局部平凡化中，右作用 $R_h$ 作用于点 $(x,g)$ 得到 $(x, gh)$。在 $(x,g)$ 处的基本向量场 $\\xi_Q$ 是曲线 $t \\mapsto (x, g \\exp(t\\xi))$ 在 $t=0$ 处的切向量，即 $\\xi_Q(x,g) = (0, T_e R_g (\\xi))$。\n    应用性质 (i)，我们得到 $\\mathcal{A}_{(x,g)}(0, T_e R_g (\\xi)) = \\xi$。\n    任何切向量 $v_g \\in T_g G$ 都可以唯一地写成 $v_g = T_e R_g (\\eta)$ 的形式，其中 $\\eta \\in \\mathfrak{g}$。因此，对于一个一般的垂直向量 $(0, v_g)$，我们有 $\\mathcal{A}_{(x,g)}(0, v_g) = \\eta$。\n    我们现在将其与 $G$ 上的右 Maurer-Cartan 形式 $\\theta^R \\in \\Omega^1(G, \\mathfrak{g})$ 联系起来，其定义为 $\\theta^R_g(v_g) = T_g R_{g^{-1}}(v_g)$。对于 $v_g = T_e R_g (\\eta)$，我们有：\n    $$\n    \\theta^R_g(v_g) = T_g R_{g^{-1}}(T_e R_g (\\eta)) = T_e(R_{g^{-1}} \\circ R_g)(\\eta) = T_e(\\mathrm{id})(\\eta) = \\eta\n    $$\n    将此与我们关于联络作用的表达式进行比较，我们发现 $\\mathcal{A}_{(x,g)}(0, v_g) = \\theta^R_g(v_g)$。这对任何垂直向量都成立。\n\n2.  **对水平向量的作用：** 一个纯水平向量（在积结构的意义上）的形式为 $(v_x, 0)$。我们使用性质 (ii)，即联络的右等变性：$R_h^* \\mathcal{A} = \\mathrm{Ad}_{h^{-1}} \\mathcal{A}$。设 $p=(x,e)$ 是平凡化中对应于单位元 $e \\in G$ 的点。设 $h=g$。设 $W = (v_x, 0) \\in T_{(x,e)}(U \\times G)$。等变性质表明 $\\mathcal{A}_{p \\cdot h}(T_p R_h(W)) = \\mathrm{Ad}_{h^{-1}}(\\mathcal{A}_p(W))$。代入我们的选择：\n    $$\n    \\mathcal{A}_{(x,g)}(T_{(x,e)}R_g((v_x, 0))) = \\mathrm{Ad}_{g^{-1}}(\\mathcal{A}_{(x,e)}(v_x, 0))\n    $$\n    前推 $T_{(x,e)}R_g$ 的作用为 $T_{(x,e)}R_g(v_x, v_e) = (v_x, T_eR_g(v_e))$，所以 $T_{(x,e)}R_g((v_x, 0)) = (v_x, 0)$。方程变为：\n    $$\n    \\mathcal{A}_{(x,g)}(v_x, 0) = \\mathrm{Ad}_{g^{-1}}(\\mathcal{A}_{(x,e)}(v_x, 0))\n    $$\n    项 $\\mathcal{A}_{(x,e)}(v_x, 0)$ 对于每个 $x \\in U$ 是作用于 $v_x \\in T_x U$ 上的一个线性映射。它在底流形 $U$ 上定义了一个 $\\mathfrak{g}$ 值 1-形式，我们将其记为 $A \\in \\Omega^1(U, \\mathfrak{g})$。具体来说，我们通过 $A_x(v_x) := \\mathcal{A}_{(x,e)}(v_x, 0)$ 来定义 $A$。这个定义提供了所求的唯一的局部 1-形式 $A(x)$。联络在水平向量上的作用则为 $\\mathcal{A}_{(x,g)}(v_x, 0) = \\mathrm{Ad}_{g^{-1}}(A_x(v_x))$。\n\n结合这些结果，$\\mathcal{A}$ 在 $(x,g)$ 处对任意切向量 $V=(v_x, v_g)$ 的作用是：\n$$\n\\mathcal{A}_{(x,g)}(v_x, v_g) = \\mathcal{A}_{(x,g)}(v_x, 0) + \\mathcal{A}_{(x,g)}(0, v_g) = \\mathrm{Ad}_{g^{-1}}(A_x(v_x)) + \\theta^R_g(v_g)\n$$\n这可以用拉回更正式地表示。设 $\\pi_U: U \\times G \\to U$ 和 $\\pi_G: U \\times G \\to G$ 是典范投影。那么 $A_x(v_x) = (\\pi_U^* A)_{(x,g)}(v_x, v_g)$ 且 $\\theta^R_g(v_g) = (\\pi_G^* \\theta^R)_{(x,g)}(v_x, v_g)$。因此，完整的联络 1-形式是：\n$$\n\\mathcal{A} = \\mathrm{Ad}_{g^{-1}} \\pi_U^* A + \\pi_G^* \\theta^R\n$$\n第一项 $\\mathrm{Ad}_{g^{-1}} \\pi_U^* A$ 构成了从 $U$ 拉回的“水平分量”（并被伴随作用扭曲），而第二项 $\\pi_G^* \\theta^R$ 是来自 $G$ 的“垂直分量”。\n\n### 任务2：重构方程与和乐\n\n我们现在特别考虑 $G = \\mathrm{U}(1)$，即圆群。其元素形式为 $g = \\mathrm{e}^{\\mathrm{i}\\phi}$，其中 $\\phi \\in \\mathbb{R}$。其李代数为 $\\mathfrak{u}(1) = \\mathrm{i}\\mathbb{R}$。由于 $\\mathrm{U}(1)$ 是一个阿贝尔群，其伴随作用是平凡的：对任何 $\\xi \\in \\mathfrak{u}(1)$，都有 $\\mathrm{Ad}_{h^{-1}}(\\xi) = h^{-1}\\xi h = \\xi$。联络的局部表达式简化为：\n$$\n\\mathcal{A} = \\pi_U^* A + \\pi_G^* \\theta^R\n$$\n对于一条曲线 $g(t) \\in \\mathrm{U}(1)$，作用于其切向量 $\\dot{g}(t)$ 的 Maurer-Cartan 形式为 $\\theta^R_{g(t)}(\\dot{g}(t)) = \\dot{g}(t)g(t)^{-1}$。$Q$ 上的路径由 $q(t) = (x(t), g(t))$ 给出，其切向量为 $\\dot{q}(t) = (\\dot{x}(t), \\dot{g}(t))$。动力学由水平提升条件 $\\mathcal{A}(\\dot{q}(t)) = 0$ 所支配。应用 $\\mathcal{A}$ 的局部形式：\n$$\nA_{x(t)}(\\dot{x}(t)) + \\theta^R_{g(t)}(\\dot{g}(t)) = 0\n$$\n代入 Maurer-Cartan 形式的表达式，我们得到重构方程：\n$$\n\\dot{g}(t)g(t)^{-1} = -A_{x(t)}(\\dot{x}(t))\n$$\n这是一个关于 $g(t)$ 的一阶常微分方程。其在初始条件 $g(0)$ 下的解为：\n$$\ng(t) = \\exp\\left( -\\int_0^t A_{x(\\tau)}(\\dot{x}(\\tau)) \\, \\mathrm{d}\\tau \\right) g(0)\n$$\n给定 $g(0)=\\mathrm{e}=1$，解为 $g(t) = \\exp\\left( -\\int_C A \\right)$，其中积分是沿着路径 $x(\\tau)$ 从 $\\tau=0$ 到 $\\tau=t$ 进行的。\n\n我们必须计算积分 $\\int_0^{2\\pi/\\omega} A_{x(t)}(\\dot{x}(t)) \\, \\mathrm{d}t$。\n局部规范势为 $A(x) = \\frac{\\mathrm{i}B}{2}(-x_2 \\mathrm{d}x_1 + x_1 \\mathrm{d}x_2)$。\n底空间上的路径为 $x(t) = (x_1(t), x_2(t)) = (R\\cos(\\omega t), R\\sin(\\omega t))$。\n速度向量为 $\\dot{x}(t) = (\\dot{x}_1(t), \\dot{x}_2(t)) = (-R\\omega\\sin(\\omega t), R\\omega\\cos(\\omega t))$。\n被积函数 $A_{x(t)}(\\dot{x}(t))$ 为：\n\\begin{align*}\nA_{x(t)}(\\dot{x}(t)) = \\frac{\\mathrm{i}B}{2} \\left[ -x_2(t) \\dot{x}_1(t) + x_1(t) \\dot{x}_2(t) \\right] \\\\\n= \\frac{\\mathrm{i}B}{2} \\left[ -(R\\sin(\\omega t))(-R\\omega\\sin(\\omega t)) + (R\\cos(\\omega t))(R\\omega\\cos(\\omega t)) \\right] \\\\\n= \\frac{\\mathrm{i}B}{2} \\left[ R^2\\omega\\sin^2(\\omega t) + R^2\\omega\\cos^2(\\omega t) \\right] \\\\\n= \\frac{\\mathrm{i}B}{2} \\left[ R^2\\omega(\\sin^2(\\omega t) + \\cos^2(\\omega t)) \\right] \\\\\n= \\frac{\\mathrm{i}B R^2 \\omega}{2}\n\\end{align*}\n被积函数是一个常数。在区间 $t \\in [0, 2\\pi/\\omega]$ 上的积分可以直接计算：\n$$\n\\int_0^{2\\pi/\\omega} A_{x(t)}(\\dot{x}(t)) \\, \\mathrm{d}t = \\int_0^{2\\pi/\\omega} \\frac{\\mathrm{i}B R^2 \\omega}{2} \\, \\mathrm{d}t = \\frac{\\mathrm{i}B R^2 \\omega}{2} [t]_0^{2\\pi/\\omega} = \\frac{\\mathrm{i}B R^2 \\omega}{2} \\left(\\frac{2\\pi}{\\omega}\\right) = \\mathrm{i}\\pi B R^2\n$$\n最后，我们求出 $g(t)$ 在 $t = 2\\pi/\\omega$ 处的值：\n$$\ng(2\\pi/\\omega) = \\exp\\left( - \\int_0^{2\\pi/\\omega} A_{x(t)}(\\dot{x}(t)) \\, \\mathrm{d}t \\right) = \\exp(-\\mathrm{i}\\pi B R^2)\n$$\n这个量是联络 $A$ 沿着指定的闭合曲线的和乐。",
            "answer": "$$\\boxed{\\exp(-\\mathrm{i}\\pi B R^{2})}$$"
        },
        {
            "introduction": "理论的价值最终体现在其应用中，而将理论转化为代码是检验和深化理解的绝佳方式。本练习将引导你将重构原理应用于刚体姿态动力学这一经典问题，这是一个在航空航天、机器人学和物理学中无处不在的模型。通过编写数值程序，你将把抽象的公式转化为可执行的仿真，从而具体理解空间角动量 $h(t)$ 如何通过几何联络决定刚体姿态 $R(t)$ 的演化。",
            "id": "3764112",
            "problem": "您的任务是利用几何力学中通过联络1-形式进行重构的原理，重构特殊正交群 ($SO(3)$) 上刚体的姿态动力学，并通过与直接空间参考系积分的结果进行对比来验证。重构必须从基本定义开始：刚体姿态是一个旋转矩阵 $R(t) \\in SO(3)$，体角速度是一个矢量 $\\Omega(t) \\in \\mathbb{R}^3$，空间角动量是一个矢量 $h(t) \\in \\mathbb{R}^3$。惯性张量在体坐标系中是对角的，其主转动惯量集合在一个对角矩阵 $I = \\operatorname{diag}(I_1, I_2, I_3)$ 中，单位为千克米平方 ($\\mathrm{kg \\cdot m^2}$)。识别体参考系和空间参考系的联络1-形式是左不变 Maurer–Cartan 形式，它将切 $R(t)$-速度映射到体角速度。空间角动量通过动量映射与体角速度相关联，并且必须推导出重构方法，以利用识别体参考系和空间参考系的联络，仅从测量的 $h(t)$ 来表示 $R(t)$。直接空间参考系积分是由相同数据得到的空间角速度所生成的演化过程。\n\n您的程序必须：\n- 推导并实现一种重构方法，该方法在指定的时间间隔内，使用联络从 $h(t)$ 和 $I$ 以及初始姿态 $R(0)$ 生成 $R(t)$。使用由 $\\widehat{v} \\, w = v \\times w$ 定义的帽映射 $\\widehat{(\\cdot)}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$（其中 $\\mathfrak{so}(3)$ 是 $SO(3)$ 的李代数），并使用罗德里格斯公式计算 $\\exp(\\widehat{v})$。\n- 在空间参考系中实现第二种直接积分方法，使用由相同的 $h(t)$ 和 $I$ 以及相同的初始条件 $R(0)$ 在相同的时间间隔内所诱导的空间角速度。\n- 通过计算两个最终旋转矩阵之间的旋转失准角 $\\theta \\in \\mathbb{R}$ 来比较两种方法的最终姿态，使用标准公式 $\\theta = \\arccos\\left(\\frac{\\operatorname{trace}(R_{\\mathrm{dir}}(T)^\\top R_{\\mathrm{rec}}(T)) - 1}{2}\\right)$，其中 $T$ 是最终时间。最终角度以弧度表示。\n\n使用以下测试套件。在每种情况下，所有角度量必须以弧度表示，输入角动量单位为 $\\mathrm{kg \\cdot m^2 / s}$，惯性单位为 $\\mathrm{kg \\cdot m^2}$。时间步长 $dt$ 的单位为秒，最终时间 $T$ 的单位为秒。\n\n- 情况1（一般情况）：\n  - $I = \\operatorname{diag}(2.0, 1.5, 1.0)$。\n  - $R(0) = I_3$ （单位矩阵）。\n  - $h(t) = [0.3, 0.4, 0.5]$ （常数）。\n  - $T = 1.0$, $dt = 0.001$。\n- 情况2（零动量边界情况）：\n  - $I = \\operatorname{diag}(1.0, 1.2, 1.4)$。\n  - $R(0)$ 是绕 $y$ 轴旋转角度 $1.2$ 的旋转。\n  - $h(t) = [0.0, 0.0, 0.0]$ （常数零）。\n  - $T = 1.0$, $dt = 0.01$。\n- 情况3（轴对称惯性）：\n  - $I = \\operatorname{diag}(2.0, 2.0, 1.0)$。\n  - $R(0)$ 是绕 $x$ 轴旋转角度 $\\pi/2$ 的旋转。\n  - $h(t) = [0.0, 0.2, 0.0]$ （常数）。\n  - $T = 2.0$, $dt = 0.002$。\n- 情况4（时变动量边缘情况）：\n  - $I = \\operatorname{diag}(1.0, 1.5, 2.0)$。\n  - $R(0) = I_3$。\n  - $h(t) = 0.3 \\, [\\sin(0.5 t), \\cos(0.3 t), 0.2 \\sin(0.7 t + 0.1)]$。\n  - $T = 3.0$, $dt = 0.0015$。\n\n您的程序必须为每种情况计算最终失准角 $\\theta$，并生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[0.000001,0.000002,0.000003,0.000004]”）。每个条目必须是一个以弧度为单位的浮点数。程序必须是完全自包含的，不得读取任何外部输入，也不得访问外部资源。",
            "solution": "该问题要求根据给定的空间角动量历史重构刚体姿态动力学。这是几何力学中的一个经典问题。我们将首先验证问题陈述的有效性，然后推导两种等效的数值方法来传播姿态动力学，最后实现它们以验证其一致性。\n\n### 问题有效性验证\n该问题被认为是有效的。它在科学上是合理的、适定的、客观的且自包含的。它基于李群 ($SO(3)$) 上刚体力学的既定原理。所有必要的数据，包括初始条件 ($R(0)$)、系统参数（惯性张量 $I$）和驱动函数（空间角动量 $h(t)$），都已提供。任务是在李群上实现并比较两种标准的数值方案，这是计算几何力学中一个有意义且不平凡的练习。根据验证清单，不存在任何缺陷。\n\n### 理论推导\n\n**1. 运动学与动量**\n\n刚体的姿态由一个旋转矩阵 $R(t) \\in SO(3)$ 描述，该矩阵将矢量从体坐标系映射到空间（惯性）参考系。$SO(3)$ 群是行列式为 $+1$ 的 $3 \\times 3$ 正交矩阵群。其李代数 $\\mathfrak{so}(3)$ 由 $3 \\times 3$ 的斜对称矩阵组成。\n\n姿态的时间演化由运动学方程决定。在体参考系中，方程为\n$$ \\dot{R}(t) = R(t) \\widehat{\\Omega}(t) $$\n其中 $\\Omega(t) \\in \\mathbb{R}^3$ 是体角速度矢量，帽映射 $\\widehat{(\\cdot)}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ 由叉乘的矩阵表示定义，即 $\\widehat{v}w = v \\times w$。\n\n在空间参考系中，运动学方程为\n$$ \\dot{R}(t) = \\widehat{\\omega}(t) R(t) $$\n其中 $\\omega(t) \\in \\mathbb{R}^3$ 是空间角速度。两种速度通过 $\\omega(t) = R(t) \\Omega(t)$ 相关联。\n\n刚体的惯性由体参考系中的对角惯性张量 $I = \\operatorname{diag}(I_1, I_2, I_3)$ 给出。体参考系中的角动量为 $\\Pi(t) = I \\Omega(t)$。作为给定函数 $h(t)$ 提供的空间参考系中的角动量，通过姿态矩阵与体动量相关联：\n$$ h(t) = R(t) \\Pi(t) = R(t) I \\Omega(t) $$\n该表达式构成了我们重构的基础。\n\n**2. 方法1：从体参考系速度进行重构**\n\n第一种方法，称为“重构”，使用体参考系运动学方程 $\\dot{R} = R \\widehat{\\Omega}$ 来传播姿态。为此，我们必须从给定的空间动量 $h(t)$ 和当前姿态 $R(t)$ 确定体角速度 $\\Omega(t)$。通过对 $h(t)$ 的关系式求逆，并利用 $R(t) \\in SO(3)$ 时 $R(t)^{-1} = R(t)^\\top$ 的性质，我们找到联络：\n$$ \\Omega(t) = I^{-1} R(t)^\\top h(t) $$\n将此代入运动学方程，得到重构常微分方程 (ODE)：\n$$ \\dot{R}(t) = R(t) \\, \\widehat{I^{-1} R(t)^\\top h(t)} $$\n为了在保持 $R(t)$ 的 $SO(3)$ 结构的同时数值积分此 ODE，我们采用一个李群积分器。对于一个时间步长 $dt$，在时间 $t_{k+1} = t_k + dt$ 的姿态 $R_{k+1}$ 从姿态 $R_k = R(t_k)$ 更新如下：\n$$ R_{k+1} = R_k \\exp(\\widehat{\\Omega_k} dt) $$\n其中 $\\Omega_k = I^{-1} R_k^\\top h(t_k)$，而 $\\exp(\\cdot)$ 是从李代数 $\\mathfrak{so}(3)$ 到李群 $SO(3)$ 的矩阵指数映射。此更新规则对应于当前姿态被一个由体速度生成的增量旋转所右乘。\n\n**3. 方法2：在空间参考系中直接积分**\n\n第二种方法使用空间参考系运动学方程 $\\dot{R} = \\widehat{\\omega} R$。在这里，我们需要用 $h(t)$ 和 $R(t)$ 来表示空间角速度 $\\omega(t)$。利用关系式 $\\omega = R\\Omega$ 和上一节中 $\\Omega$ 的表达式：\n$$ \\omega(t) = R(t) \\Omega(t) = R(t) (I^{-1} R(t)^\\top h(t)) = (R(t) I^{-1} R(t)^\\top) h(t) $$\n项 $I_s^{-1}(t) \\equiv R(t) I^{-1} R(t)^\\top$ 表示在空间参考系中观察到的惯性张量的逆。得到的 ODE 是：\n$$ \\dot{R}(t) = \\widehat{(R(t) I^{-1} R(t)^\\top h(t))} \\, R(t) $$\n相应的李群积分步骤是：\n$$ R_{k+1} = \\exp(\\widehat{\\omega_k} dt) R_k $$\n其中 $\\omega_k = (R_k I^{-1} R_k^\\top) h(t_k)$。此更新规则对应于当前姿态被一个由空间速度生成的增量旋转所左乘。\n\n**4. 方法的等价性**\n\n在解析上，这两种方法是等价的。为了证明这一点，我们展示两个数值更新规则产生相同的结果。空间更新为 $R'_{k+1} = \\exp(\\widehat{\\omega_k} dt) R_k$。我们使用关联指数映射和李群伴随表示的恒等式：$\\exp(\\operatorname{Ad}_g(X)) = g \\exp(X) g^{-1}$。对于 $SO(3)$，其矩阵形式为 $\\exp(\\widehat{gv}) = R \\exp(\\widehat{v}) R^\\top$，其中 $g=R$ 是一个旋转矩阵。\n由于 $\\omega_k = R_k\\Omega_k$，我们有 $\\widehat{\\omega_k} dt = \\widehat{R_k \\Omega_k dt} = R_k \\widehat{\\Omega_k dt} R_k^\\top$。\n将此代入空间更新规则：\n$$ R'_{k+1} = \\exp(R_k \\widehat{\\Omega_k dt} R_k^\\top) R_k = (R_k \\exp(\\widehat{\\Omega_k dt}) R_k^\\top) R_k $$\n$$ R'_{k+1} = R_k \\exp(\\widehat{\\Omega_k dt}) (R_k^\\top R_k) = R_k \\exp(\\widehat{\\Omega_k dt}) I_3 = R_k \\exp(\\widehat{\\Omega_k dt}) $$\n这正是重构方法 $R_{k+1}$ 的更新规则。因此，$R'_{k+1} = R_{k+1}$。这两种方法在数学上是完全相同的，其数值输出的任何差异都将完全归因于浮点算术误差，预计这些误差会非常小。\n\n**5. 数值实现细节**\n\n- **$\\mathfrak{so}(3)$ 上的指数映射**：映射 $\\exp: \\mathfrak{so}(3) \\to SO(3)$ 使用罗德里格斯公式计算。对于一个旋转矢量 $v \\in \\mathbb{R}^3$，令 $\\theta = \\|v\\|$ 为旋转角，$u = v/\\theta$ 为旋转轴（当 $\\theta \\ne 0$ 时）。旋转矩阵由下式给出：\n  $$ \\exp(\\widehat{v}) = I_3 + \\sin(\\theta)\\widehat{u} + (1-\\cos(\\theta))\\widehat{u}^2 $$\n  对于 $\\theta = 0$ 的情况，$\\exp(\\widehat{\\mathbf{0}}) = I_3$。在实现中，使用一个小的容差来处理 $\\theta \\approx 0$ 的情况。\n\n- **失准角**：为了比较最终姿态 $R_{\\mathrm{rec}}(T)$ 和 $R_{\\mathrm{dir}}(T)$，我们计算相对旋转矩阵 $R_{\\mathrm{rel}} = R_{\\mathrm{dir}}(T)^\\top R_{\\mathrm{rec}}(T)$。此旋转的角度 $\\theta$ 从其迹中找到：$\\operatorname{trace}(R_{\\mathrm{rel}}) = 1 + 2\\cos(\\theta)$。这给出了问题中指定的公式：\n  $$ \\theta = \\arccos\\left(\\frac{\\operatorname{trace}(R_{\\mathrm{dir}}(T)^\\top R_{\\mathrm{rec}}(T)) - 1}{2}\\right) $$\n  为了避免由于浮点表示而在 `arccos` 中出现数值域错误，其参数必须被裁剪到有效范围 $[-1, 1]$ 内。",
            "answer": "```python\nimport numpy as np\n\ndef hat(v):\n    \"\"\"\n    Maps a vector in R^3 to its corresponding skew-symmetric matrix in so(3).\n    \"\"\"\n    return np.array([[0, -v[2], v[1]],\n                     [v[2], 0, -v[0]],\n                     [-v[1], v[0], 0]])\n\ndef rodrigues(v):\n    \"\"\"\n    Computes the matrix exponential exp(hat(v)) for v in R^3 using Rodrigues' formula.\n    This maps an element of the Lie algebra so(3) to the Lie group SO(3).\n    \"\"\"\n    theta = np.linalg.norm(v)\n    if theta < 1e-12:  # Use a small tolerance for floating point zero\n        return np.eye(3)\n    \n    u = v / theta\n    u_hat = hat(u)\n    u_hat_sq = u_hat @ u_hat\n    \n    return np.eye(3) + np.sin(theta) * u_hat + (1 - np.cos(theta)) * u_hat_sq\n\ndef solve_case(I_diag, R0, h_func, T, dt):\n    \"\"\"\n    Solves a single case by running both reconstruction and direct integration methods.\n    Returns the final misalignment angle between the two resulting attitudes.\n    \"\"\"\n    I = np.diag(I_diag)\n    I_inv = np.linalg.inv(I)\n    \n    # Initialize states for both methods\n    R_rec = R0.copy()\n    R_dir = R0.copy()\n    \n    num_steps = int(T / dt)\n    t = 0.0\n    \n    for _ in range(num_steps):\n        h = h_func(t)\n        \n        # Method 1: Reconstruction via connection\n        Omega = I_inv @ R_rec.T @ h\n        delta_R_rec = rodrigues(Omega * dt)\n        R_rec = R_rec @ delta_R_rec\n        \n        # Method 2: Direct spatial-frame integration\n        omega = (R_dir @ I_inv @ R_dir.T) @ h\n        delta_R_dir = rodrigues(omega * dt)\n        R_dir = delta_R_dir @ R_dir\n        \n        t += dt\n\n    # Compute final misalignment angle\n    R_misalign = R_dir.T @ R_rec\n    # The trace is related to the rotation angle by trace = 1 + 2*cos(theta)\n    trace = np.trace(R_misalign)\n    \n    # Clip argument to arccos to handle potential floating point inaccuracies\n    # pushing the value slightly outside [-1, 1]\n    arg = np.clip((trace - 1.0) / 2.0, -1.0, 1.0)\n    theta = np.arccos(arg)\n    \n    return theta\n\ndef solve():\n    \"\"\"\n    Main function to define and run all test cases, then print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general case)\n        {\n            \"I_diag\": [2.0, 1.5, 1.0],\n            \"R0\": np.eye(3),\n            \"h_func\": lambda t: np.array([0.3, 0.4, 0.5]),\n            \"T\": 1.0,\n            \"dt\": 0.001\n        },\n        # Case 2 (zero momentum boundary case)\n        {\n            \"I_diag\": [1.0, 1.2, 1.4],\n            \"R0\": rodrigues(np.array([0.0, 1.2, 0.0])), # Rotation by 1.2 rad about y-axis\n            \"h_func\": lambda t: np.array([0.0, 0.0, 0.0]),\n            \"T\": 1.0,\n            \"dt\": 0.01\n        },\n        # Case 3 (axis-symmetric inertia)\n        {\n            \"I_diag\": [2.0, 2.0, 1.0],\n            \"R0\": rodrigues(np.array([np.pi/2.0, 0.0, 0.0])), # Rotation by pi/2 rad about x-axis\n            \"h_func\": lambda t: np.array([0.0, 0.2, 0.0]),\n            \"T\": 2.0,\n            \"dt\": 0.002\n        },\n        # Case 4 (time-varying momentum edge case)\n        {\n            \"I_diag\": [1.0, 1.5, 2.0],\n            \"R0\": np.eye(3),\n            \"h_func\": lambda t: 0.3 * np.array([\n                np.sin(0.5 * t), \n                np.cos(0.3 * t), \n                0.2 * np.sin(0.7 * t + 0.1)\n            ]),\n            \"T\": 3.0,\n            \"dt\": 0.0015\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case[\"I_diag\"], case[\"R0\"], case[\"h_func\"], case[\"T\"], case[\"dt\"])\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}