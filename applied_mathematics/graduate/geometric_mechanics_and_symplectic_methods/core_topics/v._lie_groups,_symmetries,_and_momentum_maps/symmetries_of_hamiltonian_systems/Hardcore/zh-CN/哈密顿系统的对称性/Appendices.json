{
    "hands_on_practices": [
        {
            "introduction": "在哈密顿系统中，动量映射是将对称性与守恒量联系起来的核心概念。本练习旨在通过推导余切提升作用下的动量映射表达式，来掌握一项基本技能，这是几何力学中最为常见的情形。通过将其应用于平面旋转这一经典案例，我们将看到抽象的定义如何具体化为我们所熟悉的角动量守恒 。",
            "id": "3767919",
            "problem": "设 $Q$ 是一个光滑流形，设李群 $G$ 通过左作用 $\\Phi:G\\times Q\\to Q$ 光滑地作用于 $Q$，记作 $\\Phi(g,q)=g\\cdot q$。用 $\\pi:T^{*}Q\\to Q$ 表示余切丛投影，用 $\\theta$ 表示 $T^{*}Q$ 上的典范1-形式，其定义为 $\\theta_{\\alpha_{q}}(V_{\\alpha_{q}})=\\alpha_{q}(T_{\\alpha_{q}}\\pi\\cdot V_{\\alpha_{q}})$，其中 $\\alpha_{q}\\in T_{q}^{*}Q$ 且 $V_{\\alpha_{q}}\\in T_{\\alpha_{q}}(T^{*}Q)$。用 $\\omega=-\\mathrm{d}\\theta$ 表示典范辛形式。作用 $\\Phi$ 通过余切提升 $\\Phi^{T^{*}}:G\\times T^{*}Q\\to T^{*}Q$ 提升到余切丛，这是一个保持典范1-形式 $\\theta$ 不变的辛作用。对于 $\\xi\\in\\mathfrak{g}$，令 $\\xi_{Q}$ 表示 $Q$ 上的无穷小生成元，令 $\\xi_{T^{*}Q}$ 表示由余切提升作用在 $T^{*}Q$ 上诱导的无穷小生成元。\n\n从 $T^{*}Q$ 上的典范辛结构出发，对于一个辛 $G$-作用，动量映射 $J:T^{*}Q\\to\\mathfrak{g}^{*}$ 的定义是：对每个 $\\xi\\in\\mathfrak{g}$，函数 $\\langle J,\\xi\\rangle:T^{*}Q\\to\\mathbb{R}$ 满足恒等式 $\\iota_{\\xi_{T^{*}Q}}\\omega=\\mathrm{d}\\langle J,\\xi\\rangle$。利用这些数据，推导余切提升作用的动量映射表达式，并证明\n$$\n\\langle J(\\alpha_{q}),\\xi\\rangle=\\alpha_{q}(\\xi_{Q}(q))\\quad\\text{对于所有 }\\alpha_{q}\\in T_{q}^{*}Q\\text{ 和 }\\xi\\in\\mathfrak{g}.\n$$\n\n然后，将问题特殊化到 $Q=\\mathbb{R}^{2}$ 的情况，其中 $G=\\mathrm{SO}(2)$ 在 $Q$ 上有标准的旋转作用。通过标准配对将 $T^{*}\\mathbb{R}^{2}$ 等同于 $\\mathbb{R}^{2}\\times(\\mathbb{R}^{2})^{*}$，并将一个点写作 $(x,p)$，其中 $x=(x_{1},x_{2})$ 且 $p=(p_{1},p_{2})$。使用您的一般结果，确定与 $\\mathrm{SO}(2)$ 作用相关的标量动量映射 $J(x,p)$，并最终在点 $x=(2,-1)$ 和 $p=(3,4)$ 处计算 $J$ 的值。将 $J$ 在该点的值作为一个精确整数给出，无需四舍五入。",
            "solution": "该问题分为三个部分：首先，推导余切提升作用的动量映射的一般表达式；其次，将此结果特殊化到旋转群 $\\mathrm{SO}(2)$ 作用于 $\\mathbb{R}^{2}$ 的情况；第三，在给定点计算这个特定的动量映射。\n\n第一部分：动量映射的一般推导\n\n对于辛流形 $(M, \\omega)$ 上的辛 $G$-作用，动量映射 $J: T^{*}Q \\to \\mathfrak{g}^{*}$ 由关系式\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle = \\iota_{\\xi_M} \\omega\n$$\n定义，其中 $\\xi \\in \\mathfrak{g}$ 是 $G$ 的李代数的一个元素，$\\xi_M$ 是相应的无穷小生成元（$M$ 上的一个向量场），$\\langle \\cdot, \\cdot \\rangle$ 表示对偶李代数 $\\mathfrak{g}^{*}$ 和 $\\mathfrak{g}$ 之间的配对，$\\iota_X$ 是关于向量场 $X$ 的内积。\n\n在我们的情况下，流形是余切丛 $M = T^{*}Q$，辛形式是典范形式 $\\omega = -\\mathrm{d}\\theta$，其中 $\\theta$ 是 $T^{*}Q$ 上的典范1-形式。无穷小生成元记为 $\\xi_{T^{*}Q}$。动量映射分量 $\\langle J, \\xi \\rangle$ 的定义方程变为：\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle = \\iota_{\\xi_{T^{*}Q}} (-\\mathrm{d}\\theta) = -\\iota_{\\xi_{T^{*}Q}} \\mathrm{d}\\theta\n$$\n我们使用关于向量场 $X$ 的微分形式 $A$ 的李导数的Cartan魔术公式：$L_X A = \\mathrm{d}(\\iota_X A) + \\iota_X \\mathrm{d}A$。重新整理得到 $\\iota_X \\mathrm{d}A = L_X A - \\mathrm{d}(\\iota_X A)$。将此公式应用于 $X = \\xi_{T^{*}Q}$ 和 $A = \\theta$，我们得到：\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle = - (L_{\\xi_{T^{*}Q}}\\theta - \\mathrm{d}(\\iota_{\\xi_{T^{*}Q}}\\theta)) = \\mathrm{d}(\\iota_{\\xi_{T^{*}Q}}\\theta) - L_{\\xi_{T^{*}Q}}\\theta\n$$\n余切提升作用 $\\Phi^{T^{*}}$ 的一个基本性质是它保持典范1-形式 $\\theta$ 不变。也就是说，对于任何 $g \\in G$，有 $(\\Phi^{T^{*}}_g)^*\\theta = \\theta$。李导数 $L_{\\xi_{T^{*}Q}}\\theta$ 是这个陈述的无穷小版本。它定义为在时间 $t=0$ 时沿 $\\xi_{T^{*}Q}$ 的流的拉回的导数：\n$$\nL_{\\xi_{T^{*}Q}}\\theta = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\bigg|_{t=0} (\\Phi^{T^{*}}_{\\exp(t\\xi)})^*\\theta\n$$\n由于拉回是常数且等于 $\\theta$，其导数为零。因此，$L_{\\xi_{T^{*}Q}}\\theta = 0$。\n\n动量映射的定义方程简化为：\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle = \\mathrm{d}(\\iota_{\\xi_{T^{*}Q}}\\theta)\n$$\n这意味着 $\\langle J, \\xi \\rangle$ 和 $\\iota_{\\xi_{T^{*}Q}}\\theta$ 在 $T^{*}Q$ 的每个连通分支上最多相差一个常数函数。通常选择此常数为零，这对应于对动量映射进行归一化。因此，我们得到表达式：\n$$\n\\langle J, \\xi \\rangle = \\iota_{\\xi_{T^{*}Q}}\\theta\n$$\n我们现在在任意点 $\\alpha_q \\in T_q^{*}Q$ 处计算右侧。根据内积的定义，这是在点 $\\alpha_q$ 处，1-形式 $\\theta$ 作用于向量 $(\\xi_{T^{*}Q})(\\alpha_q)$ 的值：\n$$\n\\langle J(\\alpha_q), \\xi \\rangle = (\\iota_{\\xi_{T^{*}Q}}\\theta)(\\alpha_q) = \\theta_{\\alpha_q}((\\xi_{T^{*}Q})(\\alpha_q))\n$$\n典范1-形式 $\\theta$ 由其在切向量 $V_{\\alpha_q} \\in T_{\\alpha_q}(T^{*}Q)$ 上的作用定义：$\\theta_{\\alpha_q}(V_{\\alpha_q}) = \\alpha_q(T_{\\alpha_q}\\pi \\cdot V_{\\alpha_q})$，其中 $T_{\\alpha_q}\\pi$ 是余切丛投影 $\\pi: T^{*}Q \\to Q$ 的切映射。令 $V_{\\alpha_q} = (\\xi_{T^{*}Q})(\\alpha_q)$。则：\n$$\n\\langle J(\\alpha_q), \\xi \\rangle = \\alpha_q(T_{\\alpha_q}\\pi \\cdot (\\xi_{T^{*}Q})(\\alpha_q))\n$$\n向量 $T_{\\alpha_q}\\pi \\cdot (\\xi_{T^{*}Q})(\\alpha_q)$ 是 $T^{*}Q$ 上的无穷小生成元到底流形 $Q$ 上的投影。这个投影恰好是 $Q$ 上的无穷小生成元 $\\xi_Q$ 在点 $q = \\pi(\\alpha_q)$ 处的值。为了证明这一点，考虑 $T^{*}Q$ 中的一条曲线 $c(t) = \\Phi^{T^{*}}_{\\exp(t\\xi)}(\\alpha_q)$。它在 $t=0$ 处的切向量是 $(\\xi_{T^{*}Q})(\\alpha_q)$。这条曲线在 $Q$ 上的投影是 $\\pi(c(t)) = \\pi(\\Phi^{T^{*}}_{\\exp(t\\xi)}(\\alpha_q))$。由于提升与投影是可交换的，即 $\\pi \\circ \\Phi^{T^{*}}_g = \\Phi_g \\circ \\pi$，这变成 $(\\Phi_{\\exp(t\\xi)} \\circ \\pi)(\\alpha_q) = \\exp(t\\xi) \\cdot q$。这条投影曲线在 $t=0$ 处的切向量是 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\big|_{t=0} (\\exp(t\\xi) \\cdot q)$，根据定义，这就是无穷小生成元 $\\xi_Q(q)$。因此，$T_{\\alpha_q}\\pi \\cdot (\\xi_{T^{*}Q})(\\alpha_q) = \\xi_Q(q)$。\n\n将此结果代入我们的动量映射表达式，我们得到所需的一般公式：\n$$\n\\langle J(\\alpha_q), \\xi \\rangle = \\alpha_q(\\xi_Q(q))\n$$\n\n第二部分：特殊化到 $\\mathrm{SO}(2)$ 在 $\\mathbb{R}^{2}$ 上的作用\n\n我们给定 $Q = \\mathbb{R}^{2}$，其坐标为 $x = (x_1, x_2)$，以及 $G = \\mathrm{SO}(2)$，即平面上的旋转群。一个对应于旋转角度 $\\phi$ 的元素 $g(\\phi) \\in \\mathrm{SO}(2)$ 由以下矩阵给出：\n$$\ng(\\phi) = \\begin{pmatrix} \\cos\\phi  -\\sin\\phi \\\\ \\sin\\phi  \\cos\\phi \\end{pmatrix}\n$$\n在点 $x \\in \\mathbb{R}^2$ 上的作用是矩阵乘法：$g(\\phi) \\cdot x$。李代数 $\\mathfrak{so}(2)$是一维的，可以与 $\\mathbb{R}$ 等同。通过在 $\\phi=0$ 处对 $g(\\phi)$ 关于 $\\phi$ 求导，可以得到一个基向量 $\\xi \\in \\mathfrak{so}(2)$：\n$$\n\\xi = \\frac{\\mathrm{d}g}{\\mathrm{d}\\phi}\\bigg|_{\\phi=0} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}\n$$\n在 $Q=\\mathbb{R}^{2}$ 上的无穷小生成元 $\\xi_Q(x)$ 定义为 $\\xi_Q(x) = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\big|_{t=0} (\\exp(t\\xi)\\cdot x)$。对于矩阵李群，这简化为 $\\xi x$：\n$$\n\\xi_Q(x) = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} -x_2 \\\\ x_1 \\end{pmatrix}\n$$\n作为 $\\mathbb{R}^{2}$ 上的向量场，这是 $\\xi_Q(x) = -x_2 \\frac{\\partial}{\\partial x_1} + x_1 \\frac{\\partial}{\\partial x_2}$。\n\n$T^{*}Q = T^{*}\\mathbb{R}^{2}$ 中的一个点由 $(x, p)$ 给出，其中 $x \\in \\mathbb{R}^{2}$ 且 $p \\in (T_x\\mathbb{R}^{2})^{*} \\cong (\\mathbb{R}^{2})^{*}$。我们写作 $x=(x_1, x_2)$ 和 $p=(p_1, p_2)$。在此背景下，$\\alpha_q$ 对应于点 $q=x$ 处的余向量 $p$。配对 $\\alpha_q(\\xi_Q(q))$ 变为余向量 $p$ 和向量 $v = \\xi_Q(x)$ 之间的标准配对，即 $p(v) = p \\cdot v = p_1 v_1 + p_2 v_2$。\n\n由于 $\\mathfrak{so}(2)$ 是一维的，我们可以将 $\\mathfrak{so}(2)^*$ 与 $\\mathbb{R}$ 等同，动量映射 $J$ 成为 $T^{*}\\mathbb{R}^{2}$ 上的一个标量函数。使用我们的基元 $\\xi$，标量动量映射 $J(x, p)$ 由 $\\langle J(x,p), \\xi \\rangle$ 给出。我们应用一般公式：\n$$\nJ(x,p) = \\langle J(x,p), \\xi \\rangle = p(\\xi_Q(x)) = p \\cdot \\xi_Q(x)\n$$\n代入分量：\n$$\nJ(x,p) = (p_1, p_2) \\cdot (-x_2, x_1) = p_1(-x_2) + p_2(x_1) = x_1 p_2 - x_2 p_1\n$$\n这是与 $\\mathbb{R}^{2}$ 上标准 $\\mathrm{SO}(2)$ 作用相关的标量动量映射的表达式，它被认为是角动量的标准表达式。\n\n第三部分：在特定点求值\n\n我们被要求在点 $x=(2, -1)$ 和 $p=(3, 4)$ 处计算 $J(x,p)$。因此，我们有以下值：\n$x_1 = 2$\n$x_2 = -1$\n$p_1 = 3$\n$p_2 = 4$\n\n将这些值代入 $J(x,p)$ 的表达式中：\n$$\nJ = (2)(4) - (-1)(3) = 8 - (-3) = 8 + 3 = 11\n$$\n动量映射在指定点的值是 $11$。",
            "answer": "$$\n\\boxed{11}\n$$"
        },
        {
            "introduction": "一旦确定了动量映射，我们就可以利用其守恒性来简化系统的动力学，这一过程称为约化。本练习将强大的 Marsden–Weinstein 辛约化技术应用于一个经典的有心力问题，展示了如何构造约化相空间并推导支配简化动力学的有效哈密顿量。通过这个实践，你将亲身体会到如何通过分离对称性来揭示控制径向运动的有效势（包括离心势垒）。",
            "id": "3767945",
            "problem": "考虑平面上的以下简单力学系统。令 $Q$ 为穿孔平面，等同于 $\\mathbb{R}^{2} \\setminus \\{0\\}$，并令 $T^{*}Q$ 为其装备了典范辛形式的余切丛。位形变量为 $q \\in Q$，动量变量为 $p \\in T_{q}^{*}Q \\cong \\mathbb{R}^{2}$（通过欧几里得度量），哈密顿量为\n$$\nH(q,p) \\;=\\; \\frac{1}{2 m} \\, |p|^{2} \\;+\\; V\\big(|q|\\big),\n$$\n其中 $m>0$ 为常数质量，$V:(0,\\infty)\\to \\mathbb{R}$ 为光滑的中心势。二次特殊正交群 $\\mathrm{SO}(2)$ 通过旋转自由且恰当地作用于 $Q$ 上，并且该作用典范地提升为 $T^{*}Q$ 上的一个哈密顿作用。\n\n仅使用余切丛及其典范辛形式、李群的余切提升作用、哈密顿群作用的动量映射以及 Marsden–Weinstein 辛约化的基本定义，完成以下任务：\n\n- 识别与提升的 $\\mathrm{SO}(2)$-作用相关的动量映射 $J:T^{*}Q \\to \\mathfrak{so}(2)^{*}$，并论证 $H$ 在此作用下是不变的。\n- 对于一个固定的正则值 $\\mu \\in \\mathfrak{so}(2)^* \\cong \\mathbb{R}$ 且 $\\mu \\neq 0$，构造约化相空间 $J^{-1}(\\mu)/\\mathrm{SO}(2)$，并证明它可以利用轨道投影 $Q \\to Q/\\mathrm{SO}(2)$ 和一个适当的联络，被等同于形空间的余切丛 $T^{*}(Q/\\mathrm{SO}(2)) \\cong T^{*}\\big((0,\\infty)\\big)$。\n- 在典范变量下，推导该约化空间上的约化哈密顿动力学，并物理解释约化坐标及其共轭动量。\n\n您的最终答案必须是约化哈密顿量 $H_{\\mathrm{red}}(r,p_{r};\\mu)$ 的单一闭式解析表达式，用径向坐标 $r \\in (0,\\infty)$、其共轭动量 $p_{r}$、参数 $\\mu$、质量 $m$ 和势 $V(r)$ 表示。不要在最终答案中提供任何中间表达式。不需要数值近似，最终表达式不应附带任何物理单位。",
            "solution": "我们从余切丛和哈密顿群作用的标准结构开始。余切丛 $T^{*}Q$ 带有典范 1-形式 $\\theta_{\\mathrm{can}}$，其定义为 $\\theta_{\\mathrm{can}}(\\alpha_{q})(X_{\\alpha_{q}}) = \\alpha_{q}\\big(T\\pi(X_{\\alpha_{q}})\\big)$，其中 $\\pi:T^{*}Q \\to Q$ 是丛投影，典范辛形式为 $\\omega_{\\mathrm{can}} = -\\mathrm{d}\\theta_{\\mathrm{can}}$。李群 $G$ 通过微分同胚 $g \\cdot q$ 在 $Q$ 上的作用，通过以下方式提升为 $T^{*}Q$ 上的一个辛作用：\n$$\ng \\cdot \\alpha_{q} \\;=\\; \\big(T(g^{-1})\\big)^{*} \\alpha_{q},\n$$\n且相关的动量映射 $J:T^{*}Q \\to \\mathfrak{g}^{*}$ 由下式刻画：\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle \\;=\\; \\iota_{\\xi_{T^{*}Q}} \\,\\omega_{\\mathrm{can}}, \n\\quad \\text{对所有 } \\xi \\in \\mathfrak{g},\n$$\n其中 $\\xi_{Q}$ 是 $Q$ 上的基本向量场，$\\xi_{T^{*}Q}$ 是其余切提升。\n\n对于当前系统，$G=\\mathrm{SO}(2)$ 通过绕原点的旋转作用于 $Q=\\mathbb{R}^{2}\\setminus \\{0\\}$，该作用在 $Q$ 上是自由且恰当的。通过欧几里得度量将 $T_{q}^{*}Q$ 等同于 $\\mathbb{R}^{2}$，余切提升以相同的旋转作用于 $p$。$\\mathfrak{so}(2)$ 的生成元可以由 $Q$ 上的基本向量场对应的无穷小旋转表示：对于唯一的非零 $\\xi \\in \\mathfrak{so}(2)$，相应的 $\\xi_{Q}(q)$ 是 $q$ 的一个无穷小角度的逆时针旋转，即 $\\xi_{Q}(q)$ 与 $q$ 正交，且 $|\\xi_{Q}(q)|=|q|$。对于平面旋转，动量映射的标准计算得出\n$$\n\\langle J(q,p), \\xi \\rangle \\;=\\; q_{x}p_{y} \\,-\\, q_{y}p_{x},\n$$\n这表明 $J(q,p)$ 等同于绕原点的标量角动量。等价地，$J(q,p)$ 是 $(q,p)$ 的带符号面积形式配对，通常写作标量 $L_{z}$。因为哈密顿量 $H(q,p)=\\frac{1}{2 m}|p|^{2} + V(|q|)$ 仅依赖于 $|q|$ 和 $|p|$，所以它在旋转下是不变的，因此在余切提升的 $\\mathrm{SO}(2)$-作用下也是不变的。\n\n对于一个固定的正则值 $\\mu \\in \\mathfrak{so}(2)^{*}\\cong \\mathbb{R}$ 且 $\\mu \\neq 0$，考虑 Marsden–Weinstein 约化空间\n$$\nM_{\\mu} \\;=\\; J^{-1}(\\mu) \\big/ \\mathrm{SO}(2).\n$$\n由于 $\\mathrm{SO}(2)$ 是阿贝尔群，其余伴随作用是平凡的，$\\mu$ 的迷向子群是整个群，因此通过 $\\mathrm{SO}(2)$ 的商是良定义且光滑的。通过维数计算，$\\dim T^{*}Q=4$，$\\dim J^{-1}(\\mu)=3$，且 $\\dim M_{\\mu}=2$。基（或形）空间 $Q/\\mathrm{SO}(2)$ 通过投影 $Q \\to (0,\\infty)$，$q \\mapsto r=|q|$ 微分同胚于 $(0,\\infty)$。丛 $Q \\to (0,\\infty)$ 是一个主 $\\mathrm{SO}(2)$-丛，其纤维是方向构成的圆。与欧几里得动能相关的力学联络具有与群轨道正交的水平空间，这在极坐标中对应于沿圆坐标 $\\theta$ 的 1-形式 $A = \\mathrm{d}\\theta$。其曲率为 $\\mathrm{d}A = \\mathrm{d}^{2}\\theta = 0$，因此在约化时没有感应出磁项。对于由自由且恰当的作用进行的余切丛约化，当曲率为零时，一个标准结果是约化辛流形 $M_{\\mu}$ 辛同胚于装备了典范辛形式的 $T^{*}(Q/\\mathrm{SO}(2)) \\cong T^{*}\\big((0,\\infty)\\big)$。\n\n为了明确地进行此等同，将 $q$ 用极坐标写为 $(r,\\theta)$，其中 $r=|q|$ 且 $\\theta \\in \\mathbb{S}^{1}$，并将 $p$ 分解为其在 $q$ 点处标准正交标架 $\\{e_{r},e_{\\theta}\\}$ 上的分量：\n$$\np \\;=\\; p_{r} \\, e_{r} \\;+\\; p_{\\perp} \\, e_{\\theta}.\n$$\n绕原点的标量角动量为\n$$\n\\mu \\;=\\; \\langle J(q,p), \\xi \\rangle \\;=\\; q_{x}p_{y} - q_{y}p_{x} \\;=\\; r \\, p_{\\perp},\n$$\n因此沿着水平集 $J^{-1}(\\mu)$ 我们有 $p_{\\perp}=\\mu/r$。动能依赖于 $|p|^{2} = p_{r}^{2} + p_{\\perp}^{2}$，因此沿着 $J^{-1}(\\mu)$ 我们发现\n$$\n|p|^{2} \\;=\\; p_{r}^{2} \\;+\\; \\frac{\\mu^{2}}{r^{2}}.\n$$\n坐标 $(r,p_{r})$ 下降到商空间 $M_{\\mu}$，并提供了 $T^{*}\\big((0,\\infty)\\big)$ 上的典范余切丛坐标。因为曲率为零，约化辛形式是典范形式，所以约化哈密顿系统具有典范方程\n$$\n\\dot{r} \\;=\\; \\frac{\\partial H_{\\mathrm{red}}}{\\partial p_{r}}, \n\\qquad\n\\dot{p}_{r} \\;=\\; -\\frac{\\partial H_{\\mathrm{red}}}{\\partial r}.\n$$\n将限制在 $J^{-1}(\\mu)$ 上的 $|p|^{2}$ 表达式代入原始哈密顿量，得到形空间上的约化哈密顿量：\n$$\nH_{\\mathrm{red}}(r,p_{r};\\mu) \n\\;=\\; \\frac{1}{2 m} \\left( p_{r}^{2} \\;+\\; \\frac{\\mu^{2}}{r^{2}} \\right) \\;+\\; V(r)\n\\;=\\; \\frac{p_{r}^{2}}{2 m} \\;+\\; \\frac{\\mu^{2}}{2 m \\, r^{2}} \\;+\\; V(r).\n$$\n由此，约化方程为\n$$\n\\dot{r} \\;=\\; \\frac{p_{r}}{m}, \n\\qquad \n\\dot{p}_{r} \\;=\\; -V'(r) \\;+\\; \\frac{\\mu^{2}}{m \\, r^{3}}.\n$$\n物理上，$r$ 是到原点的径向距离，$p_{r}$ 是线动量的径向分量（与 $r$ 共轭），$\\mu$ 是守恒的角动量。$H_{\\mathrm{red}}$ 中的项 $\\frac{\\mu^{2}}{2 m r^{2}}$ 是离心势垒，它编码了通过对称性约化后角运动的效应。约化辛形式中没有磁项，这反映了欧几里得度量的平面旋转对称性所对应的力学联络的曲率为零。",
            "answer": "$$\\boxed{\\frac{p_{r}^{2}}{2 m} \\;+\\; \\frac{\\mu^{2}}{2 m \\, r^{2}} \\;+\\; V(r)}$$"
        },
        {
            "introduction": "约化在理论上的优势——降低系统维度——在数值模拟中具有深远的现实意义。本练习探讨了自由刚体这一 Lie–Poisson 约化的典范例子，并通过比较在约化空间上的积分器与在完整空间上的朴素积分器，突显了对称性感知的数值方法的优越稳定性与准确性。这个计算实践将让你量化地理解，尊重系统的几何结构如何能在长时间积分中更好地保持守恒量 。",
            "id": "3767954",
            "problem": "考虑一个自由刚体，其位形空间为特殊正交群 ($SO(3)$)，相空间为配备了典范辛形式的余切丛 $T^*SO(3)$。哈密顿量由一个对角惯性张量导出的动能给出。设体角动量为元素 $M \\in \\mathfrak{so}(3)^* \\cong \\mathbb{R}^{3}$，惯性算符为一个对角线性映射 $I: \\mathbb{R}^{3} \\to \\mathbb{R}^{3}$，其沿主轴的分量为 $I_{1}$、$I_{2}$、$I_{3}$。在约化空间 $\\mathfrak{so}(3)^*$ 上的相关哈密顿函数为 $H(M)$，其动力学由李-泊松流形上的哈密顿力学控制。位形动力学由一个旋转矩阵 $R \\in SO(3)$ 给出，满足运动学关系 $\\dot{R} = R \\widehat{\\Omega}$，其中 $\\Omega \\in \\mathbb{R}^{3}$ 是体角速度，$\\widehat{\\Omega} \\in \\mathfrak{so}(3)$ 是通过标准帽子映射与向量 $\\Omega$ 对应的斜对称矩阵。\n\n严格从哈密顿力学、李群对称性以及通过对称性约化余切丛的基本原理出发（不使用任何捷径公式），完成以下任务：\n\n- 推导自由刚体在 $\\mathfrak{so}(3)^*$ 上的约化运动方程，并找出此约化动力学的两个不变量，这两个不变量因对称性而被精确流所守恒：哈密顿量 $H(M)$ 和李-泊松结构的二次卡西米尔不变量 $C(M)$。\n- 解释对于 $T^*SO(3)$ 上的未约化描述，空间角动量 $L \\in \\mathbb{R}^{3}$ 如何在精确流中守恒，以及体角动量 $M$ 如何通过旋转矩阵 $R$ 与 $L$ 相关联。\n- 实现两个数值积分器：\n    1. 一个约化的四阶显式龙格-库塔 (RK4) 方法，仅根据 $\\mathfrak{so}(3)^*$ 上的约化动力学对方程进行步进。\n    2. 一个未约化的显式一阶方法，通过朴素前向欧拉更新 $R_{n+1} = R_{n} + \\Delta t \\, R_{n} \\,\\widehat{\\Omega}_{n}$ 来步进方向 $R$，其中 $\\Omega_{n}$ 由瞬时体角动量 $M_{n}$ 计算得出，而 $M_{n}$ 则通过守恒的空间角动量 $L$ 获得，即 $M_{n} = R_{n}^{\\top} L$。这种离散化不强制施加正交约束 $R^{\\top}R = I$，从而在离散层面上破坏了对称性。\n- 对两个积分器，通过计算 $H$ 和 $C$ 的相对误差来量化它们在最终时间 $T$ 相对于其初始值的漂移，相对误差定义为 $\\left|H_{\\text{final}} - H_{\\text{initial}}\\right| / H_{\\text{initial}}$ 和 $\\left|C_{\\text{final}} - C_{\\text{initial}}\\right| / C_{\\text{initial}}$。对于未约化的积分器，还需通过计算弗罗贝尼乌斯范数 $\\|R^{\\top}R - I\\|_{F}$ 来量化其在最后一步对正交约束的违反程度。\n- 所有量均为无量纲，角度以弧度为单位。\n\n使用以下参数值测试套件，其中每个元组列出了 $(I_{1}, I_{2}, I_{3})$、初始体角动量 $M(0)$、时间步长 $\\Delta t$ 和最终时间 $T$：\n\n- 测试 1: $(I_{1}, I_{2}, I_{3}) = (2.0, 2.0, 1.0)$, $M(0) = (0.5, 0.1, 1.0)$, $\\Delta t = 0.02$, $T = 5.0$.\n- 测试 2: $(I_{1}, I_{2}, I_{3}) = (1.0, 1.0, 1.0)$, $M(0) = (1.0, -0.7, 0.3)$, $\\Delta t = 0.05$, $T = 5.0$.\n- 测试 3: $(I_{1}, I_{2}, I_{3}) = (2.0, 2.0, 1.0)$, $M(0) = (0.5, 0.1, 1.0)$, $\\Delta t = 0.001$, $T = 5.0$.\n\n您的程序应生成单行输出，包含一个由方括号括起来的、逗号分隔的列表的列表。对于每个测试用例，按以下顺序输出包含五个浮点数的列表：$[\\text{drift}_{H}^{\\text{reduced}}, \\text{drift}_{H}^{\\text{unreduced}}, \\text{drift}_{C}^{\\text{reduced}}, \\text{drift}_{C}^{\\text{unreduced}}, \\|R^{\\top}R - I\\|_{F}]$。最终输出格式必须严格为：$[[r_{11},r_{12},r_{13},r_{14},r_{15}],[r_{21},r_{22},r_{23},r_{24},r_{25}],[r_{31},r_{32},r_{33},r_{34},r_{35}]]$，其中每个 $r_{ij}$ 是由您的程序计算出的浮点数。",
            "solution": "该问题要求从几何力学的角度对自由刚体动力学进行透彻分析，然后对一个约化空间积分器和一个朴素的未约化空间积分器进行数值比较。\n\n### 1. 理论阐述\n\n#### 1.1. 系统、对称性与约化\n自由刚体的方向由一个旋转矩阵 $R \\in SO(3)$ 描述，$SO(3)$ 是三维特殊正交群。其相空间是余切丛 $T^{*}SO(3)$。动力学由一个哈密顿量控制，对于自由刚体，该哈密顿量是其动能。动能很自然地用体角速度 $\\Omega \\in \\mathbb{R}^3 \\cong \\mathfrak{so}(3)$ 在体坐标系中表示。方向的时间导数 $\\dot{R} \\in T_R SO(3)$ 与 $\\Omega$ 之间的关系由运动学方程 $\\dot{R} = R \\widehat{\\Omega}$ 给出，其中 $\\widehat{\\cdot}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ 是将一个向量映射到其对应斜对称矩阵的“帽子映射”。\n\n哈密顿量为 $H = \\frac{1}{2} \\Omega \\cdot I \\Omega$，其中 $I$ 是在刚体主轴坐标系中的对角惯性张量，$I = \\text{diag}(I_1, I_2, I_3)$。体角动量 $M$ 定义为 $M = \\frac{\\partial H}{\\partial \\Omega} = I\\Omega$。用 $M$ 表示哈密顿量得到 $H(M) = \\frac{1}{2} M \\cdot (I^{-1}M)$。\n\n$T^{*}SO(3)$ 上的哈密顿系统具有左 $SO(3)$ 对称性，这对应于在不改变其动力学（动能与 $R$ 无关）的情况下在空间中重新定向刚体的自由度。这种对称性允许一个称为**辛约化**的过程。对称性作用将相空间 $T^{*}SO(3)$ 约化为李代数的对偶空间 $\\mathfrak{so}(3)^*$，我们通过点积将其等同于 $\\mathbb{R}^3$。这个约化空间上的变量是体角动量 $M$。\n\n#### 1.2. 约化动力学：李-泊松方程\n约化空间 $\\mathfrak{so}(3)^*$ 上的动力学不是由典范辛结构控制，而是由**李-泊松结构**控制。对于李代数 $\\mathfrak{so}(3)$，两个函数 $F, G: \\mathbb{R}^3 \\to \\mathbb{R}$ 的李-泊松括号由下式给出：\n$$\n\\{F, G\\}(M) = M \\cdot (\\nabla_M F \\times \\nabla_M G)\n$$\n任何可观测量 $F(M)$ 的演化由哈密顿方程 $\\dot{F} = \\{F, H\\}$ 给出。为了求出动量向量 $M$ 本身的运动方程，我们考虑其分量 $M_i$。\n$$\n\\dot{M}_i = \\{M_i, H\\}(M) = M \\cdot (\\nabla_M M_i \\times \\nabla_M H)\n$$\n因为 $\\nabla_M M_i = e_i$（第 $i$ 个标准基向量），这变成 $\\dot{M}_i = M \\cdot (e_i \\times \\nabla_M H)$。这是向量方程的第 $i$ 个分量：\n$$\n\\dot{M} = M \\times \\nabla_M H\n$$\n哈密顿量是 $H(M) = \\frac{1}{2} \\left( \\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3} \\right)$。其关于 $M$ 的梯度是：\n$$\n\\nabla_M H = \\left( \\frac{\\partial H}{\\partial M_1}, \\frac{\\partial H}{\\partial M_2}, \\frac{\\partial H}{\\partial M_3} \\right) = \\left( \\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3} \\right) = I^{-1}M\n$$\n这个向量恰好是体角速度 $\\Omega$。将此代入 $\\dot{M}$ 的方程，我们得到著名的**自由刚体欧拉方程**：\n$$\n\\dot{M} = M \\times (I^{-1}M) = M \\times \\Omega\n$$\n\n#### 1.3. 运动不变量\n约化动力学拥有两个独立的守恒量（运动积分）。\n\n1.  **哈密顿量 ($H$)**：哈密顿量总是被其生成的流所守恒，前提是它没有显式的时间依赖性。我们可以用李-泊松括号来验证这一点：\n    $$\n    \\dot{H} = \\{H, H\\} = M \\cdot (\\nabla_M H \\times \\nabla_M H) = 0\n    $$\n    因为任何向量与自身的叉积为零。\n\n2.  **卡西米尔不变量 ($C$)**：李-泊松流形可能拥有称为**卡西米尔不变量**的特殊函数，它们与流形上的所有其他函数泊松交换。对于一个函数 $C(M)$ 成为卡西米尔不变量，我们必须有 $\\{C, F\\}(M) = 0$ 对任何函数 $F(M)$ 成立。这要求 $M \\cdot (\\nabla_M C \\times \\nabla_M F) = 0$。为了对任意 $F$ 都成立，向量 $M \\times \\nabla_M C$ 必须为零，这意味着 $\\nabla_M C$ 必须与 $M$ 平行。最简单的非平凡选择是 $\\nabla_M C \\propto M$。积分这个关系式得到二次卡西米尔不变量 $C(M) = \\|M\\|^2 = M_1^2 + M_2^2 + M_3^2$。其守恒性由 $\\dot{C} = \\{C, H\\} = 0$ 保证。这个不变量对应于体角动量大小的平方。\n\n#### 1.4. 未约化动力学与空间角动量\n在 $T^{*}SO(3)$ 上的未约化描述中，上述 $SO(3)$ 对称性因**诺特定理**而产生一个深远的后果。该定理指出，这种连续对称性意味着存在一个守恒量，称为与对称性作用相关的动量映射。对于 $T^{*}SO(3)$ 上的左 $SO(3)$ 作用，这个守恒量是**空间角动量**，一个在实验室（空间）坐标系中保持恒定的向量 $L \\in \\mathbb{R}^3$。\n\n空间动量 $L$ 和体动量 $M$ 通过当前方向 $R \\in SO(3)$ 以伴随作用相关联：\n$$\nL = R M \\quad \\implies \\quad M(t) = R(t)^{-1} L = R(t)^T L\n$$\n由于 $L$ 是恒定的，体坐标系中的动量 $M(t)$ 随着刚体的旋转而随时间变化。整个系统的动力学可以看作是 $R(t)$ 在维持 $L$ 恒定性下的演化。\n\n### 2. 数值实现\n\n我们按照规定实现并比较两种数值积分器。\n\n#### 2.1. 积分器1：约化显式龙格-库塔 (RK4)\n该积分器在约化空间 $\\mathbb{R}^3$ 上操作。状态是向量 $M$。我们使用经典的四阶龙格-库塔格式数值求解常微分方程 $\\dot{M} = f(M) = M \\times (I^{-1}M)$。给定在时间 $t_n$ 的 $M_n$：\n$$\n\\begin{aligned}\nk_1 = \\Delta t \\cdot f(M_n) \\\\\nk_2 = \\Delta t \\cdot f(M_n + k_1/2) \\\\\nk_3 = \\Delta t \\cdot f(M_n + k_2/2) \\\\\nk_4 = \\Delta t \\cdot f(M_n + k_3) \\\\\nM_{n+1} = M_n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\n对于给定的步长 $\\Delta t$，此方法精度很高，但作为一个通用的常微分方程求解器，它本质上不保持卡西米尔不变量 $C(M)$。然而，漂移预计会非常小，其数量级与 $(\\Delta t)^4$ 成正比。\n\n#### 2.2. 积分器2：未约化朴素前向欧拉\n该积分器尝试求解未约化状态 $R \\in SO(3)$。我们做出标准假设，即模拟从体坐标系开始，因此 $R(0) = I_{3\\times3}$（$3 \\times 3$ 单位矩阵）。这使我们能够在开始时一次性计算出守恒的空间动量：$L = R(0)M(0) = I*M0 = M0$。\n\n积分循环在每一步 $n$ 中如下进行：\n1.  从恒定的 $L$ 和当前方向 $R_n$ 获取当前体动量：$M_n = R_n^T L$。\n2.  计算相应的体角速度：$\\Omega_n = I^{-1}M_n$。\n3.  使用由一阶前向欧拉方法离散化的运动学关系 $\\dot{R} = R\\widehat{\\Omega}$ 来更新方向：\n    $$\n    R_{n+1} = R_n + \\Delta t \\cdot (R_n \\widehat{\\Omega}_n)\n    $$\n这个更新是一个简单的矩阵加法。它不遵守 $R$ 必须属于 $SO(3)$ 的几何约束（即 $R^T R = I$ 和 $\\det(R)=1$）。这种在离散层面上的“对称性破缺”会引入误差，导致数值轨迹离开正确的位形流形，从而引起守恒量 $H$ 和 $C$ 的漂移以及对正交性的违反。\n\n#### 2.3. 误差量化\n对于每个积分器，我们计算最终时间 $T$ 时的状态。设初始动量为 $M_0$，最终动量为 $M_T$。初始不变量为 $H_0 = H(M_0)$ 和 $C_0 = C(M_0)$。最终不变量为 $H_T = H(M_T)$ 和 $C_T = C(M_T)$。\n相对漂移计算为 $\\frac{|H_T - H_0|}{|H_0|}$ 和 $\\frac{|C_T - C_0|}{|C_0|}$。对于未约化积分器，几何约束的违反程度通过最终时刻正交性条件残差的弗罗贝尼乌斯范数 $\\|R_T^T R_T - I\\|_{F}$ 来衡量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the rigid body dynamics problem using two different integrators\n    and computes the drift in conserved quantities.\n    \"\"\"\n    \n    # Test cases as specified in the problem statement.\n    # Each tuple: (I1, I2, I3), M(0), dt, T\n    test_cases = [\n        ((2.0, 2.0, 1.0), np.array([0.5, 0.1, 1.0]), 0.02, 5.0),\n        ((1.0, 1.0, 1.0), np.array([1.0, -0.7, 0.3]), 0.05, 5.0),\n        ((2.0, 2.0, 1.0), np.array([0.5, 0.1, 1.0]), 0.001, 5.0),\n    ]\n\n    # Helper function for the hat map\n    def hat(v):\n        \"\"\"Maps a vector in R^3 to a skew-symmetric matrix in so(3).\"\"\"\n        return np.array([\n            [0.0, -v[2], v[1]],\n            [v[2], 0.0, -v[0]],\n            [-v[1], v[0], 0.0]\n        ])\n\n    # Euler's equations for the rigid body: dM/dt = M x (I^-1 * M)\n    def f_M(M, inv_I):\n        \"\"\"The RHS of the reduced ODE for body angular momentum M.\"\"\"\n        omega = inv_I @ M\n        return np.cross(M, omega)\n\n    # Hamiltonian H(M) = 1/2 * M . (I^-1 * M)\n    def hamiltonian(M, inv_I):\n        return 0.5 * np.dot(M, inv_I @ M)\n\n    # Casimir C(M) = ||M||^2\n    def casimir(M):\n        return np.dot(M, M)\n\n    all_results = []\n\n    for case in test_cases:\n        I_diag, M0, dt, T = case\n        I = np.diag(I_diag)\n        inv_I = np.diag([1.0/i for i in I_diag])\n        \n        num_steps = int(round(T / dt))\n\n        # Initial values of conserved quantities\n        H0 = hamiltonian(M0, inv_I)\n        C0 = casimir(M0)\n\n        # --- 1. Reduced RK4 Integrator ---\n        M_red = M0.copy()\n        for _ in range(num_steps):\n            k1 = dt * f_M(M_red, inv_I)\n            k2 = dt * f_M(M_red + 0.5 * k1, inv_I)\n            k3 = dt * f_M(M_red + 0.5 * k2, inv_I)\n            k4 = dt * f_M(M_red + k3, inv_I)\n            M_red += (k1 + 2.0*k2 + 2.0*k3 + k4) / 6.0\n        \n        H_final_red = hamiltonian(M_red, inv_I)\n        C_final_red = casimir(M_red)\n        \n        drift_H_red = abs(H_final_red - H0) / abs(H0) if H0 != 0.0 else 0.0\n        drift_C_red = abs(C_final_red - C0) / abs(C0) if C0 != 0.0 else 0.0\n        \n        # --- 2. Unreduced Naive Euler Integrator ---\n        R_unred = np.identity(3)\n        L = M0.copy()  # Conserved spatial momentum, L = R(0)M(0) = I*M0 = M0\n\n        for _ in range(num_steps):\n            M_n = R_unred.T @ L\n            Omega_n = inv_I @ M_n\n            Omega_hat = hat(Omega_n)\n            R_unred += dt * (R_unred @ Omega_hat)\n            \n        M_final_unred = R_unred.T @ L\n        H_final_unred = hamiltonian(M_final_unred, inv_I)\n        C_final_unred = casimir(M_final_unred)\n\n        drift_H_unred = abs(H_final_unred - H0) / abs(H0) if H0 != 0.0 else 0.0\n        drift_C_unred = abs(C_final_unred - C0) / abs(C0) if C0 != 0.0 else 0.0\n        \n        ortho_error = np.linalg.norm(R_unred.T @ R_unred - np.identity(3), 'fro')\n\n        all_results.append([\n            drift_H_red, \n            drift_H_unred, \n            drift_C_red, \n            drift_C_unred, \n            ortho_error\n        ])\n\n    # Format the final output string\n    formatted_results = [\n        \"[\" + \",\".join(f\"{v:.15e}\" for v in res) + \"]\" \n        for res in all_results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}