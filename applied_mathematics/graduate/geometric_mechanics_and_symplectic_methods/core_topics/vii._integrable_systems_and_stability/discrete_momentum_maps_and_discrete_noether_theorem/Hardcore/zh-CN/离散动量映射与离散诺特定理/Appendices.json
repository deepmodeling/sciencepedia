{
    "hands_on_practices": [
        {
            "introduction": "在离散力学中，离散动量的概念是通过离散勒让德变换定义的，它构成了离散欧拉-拉格朗日方程的基础。这个练习将引导你为一个常见的离散拉格朗日量（基于梯形法则）显式计算左、右离散动量。通过这个过程，你将看到这些离散动量如何与中心差分格式联系起来，从而加深对离散化如何近似连续系统动力学的理解。",
            "id": "3739303",
            "problem": "考虑一个位形空间 $Q = \\mathbb{R}^{n}$ 和一个形式为 $L(q, \\dot{q}) = \\tfrac{1}{2}\\dot{q}^{\\mathsf{T}} M \\dot{q} - V(q)$ 的力学拉格朗日量，其中 $M \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定常数质量矩阵，而 $V: \\mathbb{R}^{n} \\to \\mathbb{R}$ 是一个连续可微的势。设离散时间步长为 $h > 0$。通过在时间上应用梯形法则以及在 $q_{k}$ 和 $q_{k+1}$ 之间进行匀速插值，定义梯形离散拉格朗日量：\n$$\nL_{d}(q_{k}, q_{k+1}; h) \\;=\\; \\frac{1}{2h}\\,(q_{k+1} - q_{k})^{\\mathsf{T}} M (q_{k+1} - q_{k}) \\;-\\; \\frac{h}{2}\\,\\big(V(q_{k}) + V(q_{k+1})\\big).\n$$\n左、右离散 Legendre 变换将离散动量定义为\n$$\np_{k}^{-} \\;:=\\; -\\,D_{1} L_{d}(q_{k}, q_{k+1}; h), \n\\qquad\np_{k}^{+} \\;:=\\; D_{2} L_{d}(q_{k-1}, q_{k}; h),\n$$\n其中 $D_{i}$ 表示关于第 $i$ 个参数的导数。仅从这些定义出发，用 $M$、$h$、$q_{k-1}$、$q_{k}$、$q_{k+1}$ 以及 $\\nabla V(q_{k})$、$\\nabla V(q_{k+1)}$ 来显式计算 $p_{k}^{-}$ 和 $p_{k}^{+}$。然后，使用你的表达式，证明中心离散动量\n$$\np_{k}^{c} \\;:=\\; \\frac{1}{2}\\,\\big(p_{k}^{-} + p_{k}^{+}\\big)\n$$\n是在时间层 $k$ 处连续动量 $M\\,\\dot{q}$ 的一个中心有限差分近似，即\n$$\np_{k}^{c} \\;=\\; \\frac{1}{2h}\\,M\\,(q_{k+1} - q_{k-1}).\n$$\n以闭合形式的单个序对 $\\big(p_{k}^{-},\\,p_{k}^{+}\\big)$ 给出你的最终答案。无需进行数值计算。",
            "solution": "将通过首先提取给定信息，然后检查其科学合理性、自洽性和适定性来验证该问题。\n\n### 第1步：提取给定信息\n- 位形空间：$Q = \\mathbb{R}^{n}$。\n- 连续拉格朗日量：$L(q, \\dot{q}) = \\tfrac{1}{2}\\dot{q}^{\\mathsf{T}} M \\dot{q} - V(q)$。\n- 质量矩阵：$M \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定常数矩阵。\n- 势：$V: \\mathbb{R}^{n} \\to \\mathbb{R}$ 是一个连续可微函数。\n- 离散时间步长：$h > 0$。\n- 梯形离散拉格朗日量：$L_{d}(q_{k}, q_{k+1}; h) = \\frac{1}{2h}\\,(q_{k+1} - q_{k})^{\\mathsf{T}} M (q_{k+1} - q_{k}) - \\frac{h}{2}\\,\\big(V(q_{k}) + V(q_{k+1})\\big)$。\n- 左离散动量：$p_{k}^{-} = -\\,D_{1} L_{d}(q_{k}, q_{k+1}; h)$，其中 $D_{1}$ 是关于第一个参数的导数。\n- 右离散动量：$p_{k}^{+} = D_{2} L_{d}(q_{k-1}, q_{k}; h)$，其中 $D_{2}$ 是关于第二个参数的导数。\n- 中心离散动量：$p_{k}^{c} = \\frac{1}{2}\\,\\big(p_{k}^{-} + p_{k}^{+}\\big)$。\n- 中心动量的目标表达式：$p_{k}^{c} = \\frac{1}{2h}\\,M\\,(q_{k+1} - q_{k-1})$。\n\n### 第2步：使用提取的给定信息进行验证\n该问题是几何数值积分和离散力学领域的一个标准练习。\n- **科学依据**：拉格朗日量、Legendre 变换和数值离散化（特别是梯形法则）的概念是经典力学和数值分析中的基本原理。离散拉格朗日量和动量的构造遵循了变分积分中的既定方法。\n- **适定性**：该问题是基于所提供定义的直接计算。它是完全指定的，并能导出一个唯一的解析解。\n- **客观性**：该问题使用精确的数学语言和定义进行陈述，没有任何主观或模糊的术语。\n\n### 第3步：结论与行动\n该问题是**有效的**。它是在离散力学这个特定主题内的一个定义明确的数学推导。现在将开始求解过程。\n\n任务是计算左、右离散动量 $p_{k}^{-}$ 和 $p_{k}^{+}$ 的表达式，然后用它们来验证中心离散动量 $p_{k}^{c}$ 的给定形式。\n\n首先，我们计算左离散动量 $p_{k}^{-}$。根据定义，$p_{k}^{-} = -D_{1} L_{d}(q_{k}, q_{k+1}; h)$。我们必须对离散拉格朗日量 $L_{d}(q_{k}, q_{k+1}; h)$ 关于其第一个参数 $q_{k}$ 求导。离散拉格朗日量为\n$$\nL_{d}(q_{k}, q_{k+1}; h) = \\frac{1}{2h}(q_{k+1} - q_{k})^{\\mathsf{T}} M (q_{k+1} - q_{k}) - \\frac{h}{2}(V(q_{k}) + V(q_{k+1}))\n$$\n我们将对每一项关于 $q_k$ 求导。对于动能项，令 $u = q_{k+1} - q_{k}$。该项为 $\\frac{1}{2h}u^{\\mathsf{T}}Mu$。对于向量 $x$ 和对称矩阵 $A$，使用矩阵微积分的法则，梯度 $\\nabla_{x}(x^{\\mathsf{T}}Ax)$ 为 $2Ax$。应用链式法则，关于 $q_k$ 的梯度为：\n$$\nD_{1} \\left( \\frac{1}{2h}(q_{k+1} - q_{k})^{\\mathsf{T}} M (q_{k+1} - q_{k}) \\right) = \\frac{1}{2h} \\cdot 2M(q_{k+1} - q_{k}) \\cdot \\frac{\\partial}{\\partial q_{k}}(q_{k+1} - q_{k}) = \\frac{1}{h} M(q_{k+1} - q_{k}) \\cdot (-I) = -\\frac{1}{h}M(q_{k+1} - q_{k})\n$$\n其中 $I$ 是单位矩阵。\n对于势能项，导数是直接的：\n$$\nD_{1} \\left( -\\frac{h}{2}(V(q_{k}) + V(q_{k+1})) \\right) = -\\frac{h}{2} \\nabla V(q_{k})\n$$\n结合这些结果得到全导数 $D_{1} L_{d}$：\n$$\nD_{1} L_{d}(q_{k}, q_{k+1}; h) = -\\frac{1}{h}M(q_{k+1} - q_{k}) - \\frac{h}{2}\\nabla V(q_{k})\n$$\n左离散动量 $p_{k}^{-}$ 是这个表达式的负值：\n$$\np_{k}^{-} = -D_{1} L_{d}(q_{k}, q_{k+1}; h) = \\frac{1}{h}M(q_{k+1} - q_{k}) + \\frac{h}{2}\\nabla V(q_{k})\n$$\n\n接下来，我们计算右离散动量 $p_{k}^{+}$。根据定义，$p_{k}^{+} = D_{2} L_{d}(q_{k-1}, q_{k}; h)$。首先，我们写出 $L_{d}$，其参数从 $(q_k, q_{k+1})$ 移至 $(q_{k-1}, q_{k})$：\n$$\nL_{d}(q_{k-1}, q_{k}; h) = \\frac{1}{2h}(q_{k} - q_{k-1})^{\\mathsf{T}} M (q_{k} - q_{k-1}) - \\frac{h}{2}(V(q_{k-1}) + V(q_{k}))\n$$\n现在，我们对这个表达式关于其第二个参数 $q_{k}$ 求导。对于动能项，令 $v = q_{k} - q_{k-1}$。关于 $q_k$ 的导数为：\n$$\nD_{2} \\left( \\frac{1}{2h}(q_{k} - q_{k-1})^{\\mathsf{T}} M (q_{k} - q_{k-1}) \\right) = \\frac{1}{2h} \\cdot 2M(q_{k} - q_{k-1}) \\cdot \\frac{\\partial}{\\partial q_{k}}(q_{k} - q_{k-1}) = \\frac{1}{h}M(q_{k} - q_{k-1}) \\cdot (I) = \\frac{1}{h}M(q_{k} - q_{k-1})\n$$\n对于势能项，导数为：\n$$\nD_{2} \\left( -\\frac{h}{2}(V(q_{k-1}) + V(q_{k})) \\right) = -\\frac{h}{2}\\nabla V(q_{k})\n$$\n结合这些结果得到 $p_k^+$ 的表达式：\n$$\np_{k}^{+} = D_{2} L_{d}(q_{k-1}, q_{k}; h) = \\frac{1}{h}M(q_{k} - q_{k-1}) - \\frac{h}{2}\\nabla V(q_{k})\n$$\n这些是 $p_{k}^{-}$ 和 $p_{k}^{+}$ 的显式表达式。\n\n最后，我们证明中心离散动量 $p_{k}^{c}$ 具有所需的形式。我们使用其定义 $p_{k}^{c} = \\frac{1}{2}(p_{k}^{-} + p_{k}^{+})$ 并代入我们找到的表达式：\n$$\np_{k}^{c} = \\frac{1}{2} \\left[ \\left( \\frac{1}{h}M(q_{k+1} - q_{k}) + \\frac{h}{2}\\nabla V(q_{k}) \\right) + \\left( \\frac{1}{h}M(q_{k} - q_{k-1}) - \\frac{h}{2}\\nabla V(q_{k}) \\right) \\right]\n$$\n涉及 $\\nabla V(q_{k})$ 的势能项相互抵消：\n$$\np_{k}^{c} = \\frac{1}{2} \\left[ \\frac{1}{h}M(q_{k+1} - q_{k}) + \\frac{1}{h}M(q_{k} - q_{k-1}) \\right]\n$$\n提出公因子 $\\frac{1}{h}M$：\n$$\np_{k}^{c} = \\frac{1}{2h} M \\left[ (q_{k+1} - q_{k}) + (q_{k} - q_{k-1}) \\right]\n$$\n化简方括号中的表达式得到：\n$$\np_{k}^{c} = \\frac{1}{2h} M (q_{k+1} - q_{k-1})\n$$\n这证实了问题陈述中给出的表达式。$\\frac{q_{k+1} - q_{k-1}}{2h}$ 项是在时间 $t_{k}=kh$ 处对速度 $\\dot{q}$ 的二阶中心有限差分近似。因此，$p_k^c$ 是连续动量 $p(t_k) = M\\dot{q}(t_k)$ 的一个离散近似。\n\n问题要求最终答案为序对 $(p_{k}^{-},\\,p_{k}^{+})$。\n$p_{k}^{-} = \\frac{1}{h}M(q_{k+1} - q_{k}) + \\frac{h}{2}\\nabla V(q_{k})$\n$p_{k}^{+} = \\frac{1}{h}M(q_{k} - q_{k-1}) - \\frac{h}{2}\\nabla V(q_{k})$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{h}M(q_{k+1} - q_{k}) + \\frac{h}{2}\\nabla V(q_{k}) & \\frac{1}{h}M(q_{k} - q_{k-1}) - \\frac{h}{2}\\nabla V(q_{k}) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "变分积分子的一个核心优势是它们能够保持连续系统的辛结构，但这在离散层面是如何实现的呢？这个练习通过计算离散的庞加莱-嘉当1-形式和离散辛2-形式来揭示这一几何结构。你将为一个自由粒子系统推导出这些形式，并验证离散辛形式是一个常数，这直接体现了辛性的保持。",
            "id": "3739291",
            "problem": "考虑一个构型空间 $Q=\\mathbb{R}^{n}$，其具有标准的欧几里得内积和范数。设质量为 $m>0$ 的粒子的连续拉格朗日量为 $L(q,\\dot{q})=\\tfrac{1}{2}m\\|\\dot{q}\\|^{2}$。对于固定的时间步长 $h>0$，定义中点离散拉格朗日量 $L_{d}:Q\\times Q\\to\\mathbb{R}$ 为\n$$\nL_{d}(q_{0},q_{1}) \\;=\\; h\\,L\\!\\left(\\tfrac{q_{0}+q_{1}}{2},\\,\\tfrac{q_{1}-q_{0}}{h}\\right).\n$$\n在离散拉格朗日力学中，离散庞加莱–嘉当 1-形式由核心的离散变分原理定义为\n$$\n\\Theta_{d}^{-}(q_{0},q_{1}) \\;=\\; -\\,D_{1}L_{d}(q_{0},q_{1})\\cdot dq_{0}, \n\\qquad\n\\Theta_{d}^{+}(q_{0},q_{1}) \\;=\\; D_{2}L_{d}(q_{0},q_{1})\\cdot dq_{1},\n$$\n且相关的离散辛 2-形式是外微分\n$$\n\\Omega_{d} \\;=\\; -\\,d\\Theta_{d}^{+} \\;=\\; -\\,d\\Theta_{d}^{-}.\n$$\n此处，$D_{1}$ 和 $D_{2}$ 分别表示对 $L_{d}$ 的第一个和第二个参数的偏导数，$dq_{0}$ 和 $dq_{1}$ 表示 $Q\\times Q$ 上的坐标 1-形式。\n\n任务：\n- 从上述定义和给定的连续拉格朗日量出发，显式计算 $L_{d}(q_{0},q_{1})$。\n- 仅使用所提供的定义，计算 $\\Theta_{d}^{-}$ 和 $\\Theta_{d}^{+}$ 在 $Q\\times Q$ 上的显式坐标表达式。\n- 显式计算 $\\Omega_{d}$ 作为 $Q\\times Q$ 上的 2-形式，并从您的表达式中验证 $\\Omega_{d}$ 在 $Q\\times Q$ 上是常数。\n\n答案规格：\n- 以一个包含三个条目的单行矩阵形式，给出 $\\Theta_{d}^{-}$、$\\Theta_{d}^{+}$ 和 $\\Omega_{d}$ 这三者的最终解析表达式，该表达式集合了所有三个量，并使用标准坐标 $\\{q_{0}^{i},q_{1}^{i}\\}_{i=1}^{n}$。\n- 无需进行数值四舍五入，最终方框内的表达式不应包含任何单位。",
            "solution": "问题验证如下：\n\\\n**步骤 1：提取已知条件**\n- 构型空间：$Q=\\mathbb{R}^{n}$，具有标准的欧几里得内积和范数。\n- 连续拉格朗日量：$L(q,\\dot{q})=\\tfrac{1}{2}m\\|\\dot{q}\\|^{2}$，对于质量为 $m>0$ 的粒子。\n- 时间步长：$h>0$。\n- 中点离散拉格朗日量：$L_{d}(q_{0},q_{1}) = h\\,L\\!\\left(\\tfrac{q_{0}+q_{1}}{2},\\,\\tfrac{q_{1}-q_{0}}{h}\\right)$。\n- 离散庞加莱–嘉当 1-形式定义：$\\Theta_{d}^{-}(q_{0},q_{1}) = -\\,D_{1}L_{d}(q_{0},q_{1})\\cdot dq_{0}$ 和 $\\Theta_{d}^{+}(q_{0},q_{1}) = D_{2}L_{d}(q_{0},q_{1})\\cdot dq_{1}$。\n- 离散辛 2-形式定义：$\\Omega_{d} = -\\,d\\Theta_{d}^{+} = -\\,d\\Theta_{d}^{-}$。\n- 符号说明：$D_{1}$ 和 $D_{2}$ 分别是对 $L_d$ 的第一个和第二个参数的偏导数。$dq_{0}$ 和 $dq_{1}$ 是 $Q\\times Q$ 上的坐标 1-形式。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于几何力学这一成熟领域，特别是离散变分积分器理论。离散拉格朗日量、离散庞加莱-嘉当形式和离散辛形式的概念在该领域是标准的。所选的拉格朗日量是自由粒子的拉格朗日量，这是经典力学中的一个基本系统。\n- **适定性：** 该问题提供了执行所要求计算所需的所有必要定义和初始数据。任务是明确的，通过直接应用所提供的定义可以得出一个唯一的、有意义的解。\n- **客观性：** 该问题使用精确的数学语言陈述，没有任何模糊性、主观性或观点。\n\n该问题没有表现出任何诸如科学上不健全、不完整、矛盾或模糊等缺陷。\n\n**步骤 3：结论与行动**\n该问题是有效的。解题过程如下。\n\n第一个任务是计算离散拉格朗日量 $L_{d}(q_{0},q_{1})$ 的显式形式。我们已知连续拉格朗日量 $L(q,\\dot{q})=\\tfrac{1}{2}m\\|\\dot{q}\\|^{2}$ 和离散化规则 $L_{d}(q_{0},q_{1}) = h\\,L(\\tfrac{q_{0}+q_{1}}{2},\\,\\tfrac{q_{1}-q_{0}}{h})$。\n将参数代入 $L$，我们注意到 $L$ 与其第一个参数 $q$ 无关。我们将 $\\dot{q}$ 替换为有限差分近似 $\\tfrac{q_{1}-q_{0}}{h}$。\n$$\nL\\left(\\tfrac{q_{0}+q_{1}}{2},\\,\\tfrac{q_{1}-q_{0}}{h}\\right) = \\frac{1}{2}m\\left\\|\\frac{q_{1}-q_{0}}{h}\\right\\|^{2} = \\frac{m}{2h^{2}}\\|q_{1}-q_{0}\\|^{2}.\n$$\n现在，我们将其代回 $L_{d}$ 的定义中：\n$$\nL_{d}(q_{0},q_{1}) = h \\left( \\frac{m}{2h^{2}}\\|q_{1}-q_{0}\\|^{2} \\right) = \\frac{m}{2h}\\|q_{1}-q_{0}\\|^{2}.\n$$\n在 $Q \\times Q = \\mathbb{R}^n \\times \\mathbb{R}^n$ 上的标准坐标 $\\{q_{0}^{i}, q_{1}^{i}\\}_{i=1}^{n}$ 中，该表达式变为：\n$$\nL_{d}(q_{0},q_{1}) = \\frac{m}{2h} \\sum_{i=1}^{n} (q_{1}^{i} - q_{0}^{i})^{2}.\n$$\n\n第二个任务是计算离散 1-形式 $\\Theta_{d}^{-}$ 和 $\\Theta_{d}^{+}$。\n我们从 $\\Theta_{d}^{-}(q_{0},q_{1}) = -D_{1}L_{d}(q_{0},q_{1})\\cdot dq_{0}$ 开始。这等价于 $\\Theta_{d}^{-} = -\\sum_{i=1}^{n} \\frac{\\partial L_{d}}{\\partial q_{0}^{i}} dq_{0}^{i}$。\n我们来计算 $L_{d}$ 关于坐标 $q_{0}^{j}$ 的偏导数：\n$$\n\\frac{\\partial L_{d}}{\\partial q_{0}^{j}} = \\frac{\\partial}{\\partial q_{0}^{j}} \\left( \\frac{m}{2h} \\sum_{i=1}^{n} (q_{1}^{i} - q_{0}^{i})^{2} \\right) = \\frac{m}{2h} \\cdot 2(q_{1}^{j} - q_{0}^{j})(-1) = -\\frac{m}{h}(q_{1}^{j} - q_{0}^{j}).\n$$\n将此代入 $\\Theta_{d}^{-}$ 的表达式中：\n$$\n\\Theta_{d}^{-} = -\\sum_{j=1}^{n} \\left( -\\frac{m}{h}(q_{1}^{j} - q_{0}^{j}) \\right) dq_{0}^{j} = \\frac{m}{h} \\sum_{j=1}^{n} (q_{1}^{j} - q_{0}^{j}) dq_{0}^{j}.\n$$\n接下来，我们计算 $\\Theta_{d}^{+}(q_{0},q_{1}) = D_{2}L_{d}(q_{0},q_{1})\\cdot dq_{1}$，这等价于 $\\Theta_{d}^{+} = \\sum_{i=1}^{n} \\frac{\\partial L_{d}}{\\partial q_{1}^{i}} dq_{1}^{i}$。\n$L_{d}$ 关于坐标 $q_{1}^{j}$ 的偏导数是：\n$$\n\\frac{\\partial L_{d}}{\\partial q_{1}^{j}} = \\frac{\\partial}{\\partial q_{1}^{j}} \\left( \\frac{m}{2h} \\sum_{i=1}^{n} (q_{1}^{i} - q_{0}^{i})^{2} \\right) = \\frac{m}{2h} \\cdot 2(q_{1}^{j} - q_{0}^{j})(1) = \\frac{m}{h}(q_{1}^{j} - q_{0}^{j}).\n$$\n将此代入 $\\Theta_{d}^{+}$ 的表达式中：\n$$\n\\Theta_{d}^{+} = \\sum_{j=1}^{n} \\left( \\frac{m}{h}(q_{1}^{j} - q_{0}^{j}) \\right) dq_{1}^{j} = \\frac{m}{h} \\sum_{j=1}^{n} (q_{1}^{j} - q_{0}^{j}) dq_{1}^{j}.\n$$\n\n第三个任务是计算离散辛 2-形式 $\\Omega_{d} = -d\\Theta_{d}^{+}$ 并验证其常数性。\n我们对 $\\Theta_{d}^{+}$ 取外微分：\n$$\nd\\Theta_{d}^{+} = d\\left( \\frac{m}{h} \\sum_{i=1}^{n} (q_{1}^{i} - q_{0}^{i}) dq_{1}^{i} \\right) = \\frac{m}{h} \\sum_{i=1}^{n} d(q_{1}^{i} - q_{0}^{i}) \\wedge dq_{1}^{i}.\n$$\n系数函数的外微分是 $d(q_{1}^{i} - q_{0}^{i}) = dq_{1}^{i} - dq_{0}^{i}$。将其代回：\n$$\nd\\Theta_{d}^{+} = \\frac{m}{h} \\sum_{i=1}^{n} (dq_{1}^{i} - dq_{0}^{i}) \\wedge dq_{1}^{i}.\n$$\n使用楔积的性质，$(A-B)\\wedge A = A \\wedge A - B \\wedge A = 0 - B \\wedge A$，我们得到：\n$$\nd\\Theta_{d}^{+} = \\frac{m}{h} \\sum_{i=1}^{n} (dq_{1}^{i}\\wedge dq_{1}^{i} - dq_{0}^{i} \\wedge dq_{1}^{i}) = \\frac{m}{h} \\sum_{i=1}^{n} (0 - dq_{0}^{i} \\wedge dq_{1}^{i}) = -\\frac{m}{h} \\sum_{i=1}^{n} dq_{0}^{i} \\wedge dq_{1}^{i}.\n$$\n最后，我们应用定义 $\\Omega_{d} = -d\\Theta_{d}^{+}$：\n$$\n\\Omega_{d} = - \\left( -\\frac{m}{h} \\sum_{i=1}^{n} dq_{0}^{i} \\wedge dq_{1}^{i} \\right) = \\frac{m}{h} \\sum_{i=1}^{n} dq_{0}^{i} \\wedge dq_{1}^{i}.\n$$\n为验证此结果的一致性，我们也可以计算 $\\Omega_d = -d\\Theta_d^-$：\n$$\nd\\Theta_{d}^{-} = d\\left(\\frac{m}{h}\\sum_{i=1}^{n}(q_{1}^{i}-q_{0}^{i})dq_{0}^{i}\\right) = \\frac{m}{h}\\sum_{i=1}^{n}d(q_{1}^{i}-q_{0}^{i})\\wedge dq_{0}^{i} = \\frac{m}{h}\\sum_{i=1}^{n}(dq_{1}^{i}-dq_{0}^{i})\\wedge dq_{0}^{i}.\n$$\n这可以简化为：\n$$\nd\\Theta_{d}^{-} = \\frac{m}{h}\\sum_{i=1}^{n}(dq_{1}^{i}\\wedge dq_{0}^{i} - dq_{0}^{i}\\wedge dq_{0}^{i}) = \\frac{m}{h}\\sum_{i=1}^{n}dq_{1}^{i}\\wedge dq_{0}^{i} = -\\frac{m}{h}\\sum_{i=1}^{n}dq_{0}^{i}\\wedge dq_{1}^{i}.\n$$\n因此，$\\Omega_{d} = -d\\Theta_{d}^{-} = -(-\\frac{m}{h}\\sum_{i=1}^{n}dq_{0}^{i}\\wedge dq_{1}^{i}) = \\frac{m}{h}\\sum_{i=1}^{n}dq_{0}^{i}\\wedge dq_{1}^{i}$，这证实了我们之前的结果。\n$\\Omega_{d}$ 的表达式是基 2-形式 $dq_{0}^{i} \\wedge dq_{1}^{i}$ 的线性组合，其系数为 $\\frac{m}{h}$。由于 $m$ 和 $h$ 是常数，$\\Omega_{d}$ 在此标准坐标基下的系数是常数。因此，2-形式 $\\Omega_{d}$ 在 $Q \\times Q$ 上是常数。\n\n所要求的三个量是：\n$$\n\\Theta_{d}^{-} = \\frac{m}{h} \\sum_{i=1}^{n} (q_{1}^{i} - q_{0}^{i}) dq_{0}^{i}\n$$\n$$\n\\Theta_{d}^{+} = \\frac{m}{h} \\sum_{i=1}^{n} (q_{1}^{i} - q_{0}^{i}) dq_{1}^{i}\n$$\n$$\n\\Omega_{d} = \\frac{m}{h} \\sum_{i=1}^{n} dq_{0}^{i} \\wedge dq_{1}^{i}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{m}{h} \\sum_{i=1}^{n} (q_{1}^{i} - q_{0}^{i}) dq_{0}^{i} & \\frac{m}{h} \\sum_{i=1}^{n} (q_{1}^{i} - q_{0}^{i}) dq_{1}^{i} & \\frac{m}{h} \\sum_{i=1}^{n} dq_{0}^{i} \\wedge dq_{1}^{i}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论上，对称性保证了离散动量图的精确守恒，但在实际的数值计算中，有限精度算术可能会破坏这种理想的对称性。这个编程练习将让你亲身体验这一现象，通过对比两种代数上等价但数值上不同的离散拉格朗日量表达式，来研究舍入误差如何导致动量漂移。这个实践揭示了理论与计算实践之间的重要联系，并强调了数值稳定性的重要性。",
            "id": "3739286",
            "problem": "考虑一个位形空间 $\\mathbb{R}^d$，平移群 $G = \\mathbb{R}^d$ 对其的作用为 $q \\mapsto q + a$，其中 $a \\in \\mathbb{R}^d$ 为任意常数向量。设连续拉格朗日量为 $L(q,\\dot{q}) = \\frac{m}{2} \\|\\dot{q}\\|^2$，它在 $G$ 的作用下保持不变。对于时间步长 $h > 0$，离散拉格朗日量定义为 $L_d(q_k,q_{k+1};h)$，并通过离散 Euler–Lagrange 方程 $D_2 L_d(q_{k-1},q_k;h) + D_1 L_d(q_k,q_{k+1};h) = 0$ 得到一个变分积分器。对于平移不变的离散拉格朗日量，如果 $L_d$ 是严格 $G$ 不变的，根据离散 Noether 定理，与 $G$ 对称性相关的离散动量映射在每一步中都是守恒的。\n\n从上述基本定义出发，任务是：\n- 推导离散拉格朗日量为 $L_d(q_k,q_{k+1};h) = \\frac{m}{2h}\\|q_{k+1}-q_k\\|^2$ 的自由粒子的离散动量映射。\n- 设计一个数值方案来传播离散动力学，并监测由于舍入误差引起的离散线性动量的每步漂移。\n- 通过比较 $L_d$ 的两种代数上等价的求值方法，在数值上将观测到的漂移与浮点运算中对严格 $G$ 不变性的违反联系起来：\n  1) 差分形式 $L_d^{\\mathrm{diff}}(q_k,q_{k+1};h) = \\frac{m}{2h}\\|q_{k+1}-q_k\\|^2$；\n  2) 展开的点积形式 $L_d^{\\mathrm{exp}}(q_k,q_{k+1};h) = \\frac{m}{2h}\\left(\\|q_{k+1}\\|^2 + \\|q_k\\|^2 - 2\\,q_{k+1}\\cdot q_k\\right)$。\n\n实现以下数值方案：\n1. 对于选定的初始速度 $v_0 \\in \\mathbb{R}^d$，初始化 $q_0 \\in \\mathbb{R}^d$ 和 $q_1 = q_0 + h v_0$。\n2. 对于 $k = 1,2,\\dots,N-1$，传播 $q_{k+1} = 2 q_k - q_{k-1}$。\n3. 在每一步 $k = 1,2,\\dots,N-1$，计算离散动量 $p_k = \\frac{m}{h}(q_k - q_{k-1})$ 和漂移 $\\|p_{k+1} - p_k\\|$。\n4. 在每一步，通过计算\n   $\\Delta^{\\mathrm{exp}}_k = \\left|L_d^{\\mathrm{exp}}(q_k+a,q_{k+1}+a;h) - L_d^{\\mathrm{exp}}(q_k,q_{k+1};h)\\right|$ 和\n   $\\Delta^{\\mathrm{diff}}_k = \\left|L_d^{\\mathrm{diff}}(q_k+a,q_{k+1}+a;h) - L_d^{\\mathrm{diff}}(q_k,q_{k+1};h)\\right|$\n   来计算在固定平移 $a \\in \\mathbb{R}^d$ 下的不变性缺陷。\n5. 通过计算时间序列 $\\{\\|p_{k+1}-p_k\\|\\}_{k=1}^{N-1}$ 和 $\\{\\Delta^{\\mathrm{exp}}_k\\}_{k=1}^{N-1}$ 之间的 Pearson 相关系数，来量化动量漂移和不变性缺陷之间的关系。如果任一时间序列的方差为零，则将相关性定义为 $0.0$。\n\n您的程序必须实现这个方案，并为每个测试用例生成一个包含四个浮点数的列表：\n- 最大动量漂移 $\\max_{1 \\le k \\le N-1} \\|p_{k+1}-p_k\\|$。\n- 展开形式的最大不变性缺陷 $\\max_{1 \\le k \\le N-1} \\Delta^{\\mathrm{exp}}_k$。\n- 差分形式的最大不变性缺陷 $\\max_{1 \\le k \\le N-1} \\Delta^{\\mathrm{diff}}_k$。\n- 动量漂移序列与展开形式不变性缺陷序列之间的相关系数。\n\n不需要物理单位；所有量都必须作为无量纲数处理。此设置中不出现角度。\n\n测试套件：\n- 案例 1 (正常路径): $d=3$, $m=1.0$, $h=10^{-3}$, $N=1000$, $a = (0,0,0)$, $q_0 = (0,0,0)$, $v_0 = (1,-1,0.5)$。\n- 案例 2 (边缘情况: 大偏移量和小步长): $d=3$, $m=1.0$, $h=10^{-9}$, $N=2000$, $a = (10^{12},10^{12},10^{12})$, $q_0 = a$, $v_0 = (1,-1,0.5)$。\n- 案例 3 (边界情况: 二维中的极小步长和大偏移量): $d=2$, $m=1.0$, $h=5\\cdot 10^{-12}$, $N=1500$, $a = (10^{15},10^{15})$, $q_0 = a$, $v_0 = (0.3,-0.7)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为一个用方括号括起来的逗号分隔列表，其中每个元素对应一个测试用例，并且本身是按上述顺序排列的四个浮点数的列表，例如，\n\"[[r_{1,1},r_{1,2},r_{1,3},r_{1,4}],[r_{2,1},r_{2,2},r_{2,3},r_{2,4}],[r_{3,1},r_{3,2},r_{3,3},r_{3,4}]]\"。",
            "solution": "该问题是有效的。它在几何力学领域提出了一个适定且科学上合理的数值实验，旨在研究在变分积分器中破坏对称性的数值后果。所有必需的定义、参数和程序都得到了明确无误的规定，没有歧义或矛盾。\n\n### 理论框架介绍\n\n该问题在离散变分力学的背景下探讨了对称性与守恒律之间的联系。对于一个具有拉格朗日量 $L(q, \\dot{q})$ 的连续力学系统，如果它在李群 $G$ 的作用下保持不变，Noether 定理保证存在一个守恒量，称为动量映射。变分积分器是通过离散化 Hamilton 定常作用量原理而导出的数值方法。这些方法的一个关键特征是，如果离散拉格朗日量 $L_d(q_k, q_{k+1};h)$ 继承了连续拉格朗日量的对称性，那么得到的数值方案将精确地保持相应的离散动量映射。本问题关注平移群 $G = (\\mathbb{R}^d, +)$ 和一个自由粒子，其守恒量是线性动量。然后，它研究了浮点运算如何破坏精确的数值对称性，从而导致本应守恒的动量发生漂移。\n\n### 第一部分：离散动量映射的推导\n\n离散动量映射是利用离散 Noether 定理的原理从离散拉格朗日量推导出来的。\n\n1.  **系统与对称性**: 位形空间为 $Q = \\mathbb{R}^d$。该系统是一个质量为 $m$ 的自由粒子，由离散拉格朗日量 $L_d(q_k, q_{k+1}; h) = \\frac{m}{2h}\\|q_{k+1} - q_k\\|^2$ 描述，这是连续拉格朗日量 $L(q, \\dot{q}) = \\frac{m}{2}\\|\\dot{q}\\|^2$ 的作用量积分的离散化。对称群是平移群 $G = \\mathbb{R}^d$，它对 $Q$ 的作用为 $\\Phi_a(q) = q + a$，其中 $a \\in \\mathbb{R}^d$ 为任意常数向量。\n\n2.  **离散拉格朗日量的不变性**: 离散拉格朗日量在群作用下是严格不变的：\n    $$L_d(\\Phi_a(q_k), \\Phi_a(q_{k+1}); h) = L_d(q_k + a, q_{k+1} + a; h) = \\frac{m}{2h} \\|(q_{k+1} + a) - (q_k + a)\\|^2 = \\frac{m}{2h} \\|q_{k+1} - q_k\\|^2 = L_d(q_k, q_{k+1}; h)$$\n    这种严格不变性是离散守恒律的基础。\n\n3.  **离散动量映射**: 根据离散 Noether 定理，守恒量与离散拉格朗日量的偏导数有关。左右离散动量由 $L_d$ 对其自变量的导数定义。让我们计算这些导数：\n    -   $D_1 L_d(q_k, q_{k+1}; h) = \\frac{\\partial L_d}{\\partial q_k} = \\frac{m}{h}(q_k - q_{k+1})$\n    -   $D_2 L_d(q_k, q_{k+1}; h) = \\frac{\\partial L_d}{\\partial q_{k+1}} = \\frac{m}{h}(q_{k+1} - q_k)$\n\n    问题将第 $k$ 步的离散动量定义为 $p_k$。根据几何积分中的标准惯例，与区间 $(q_{k-1}, q_k)$ 相关的动量由 $p_k = D_2 L_d(q_{k-1}, q_k; h)$ 或 $p_k = -D_1 L_d(q_{k-1}, q_k; h)$ 给出。两种定义得出相同的结果：\n    $$p_k = D_2 L_d(q_{k-1}, q_k; h) = \\frac{m}{h}(q_k - q_{k-1})$$\n    这个表达式 $p_k$ 是连续线性动量 $p = m\\dot{q}$ 的离散模拟。这就是该系统的离散动量映射。\n\n4.  **守恒律**: 动力学由离散 Euler-Lagrange (DEL) 方程控制：$D_2 L_d(q_{k-1}, q_k; h) + D_1 L_d(q_k, q_{k+1}; h) = 0$。代入导数：\n    $$\\frac{m}{h}(q_k - q_{k-1}) - \\frac{m}{h}(q_{k+1} - q_k) = 0$$\n    这可以简化为 $p_k - p_{k+1} = 0$，即 $p_{k+1} = p_k$。这证实了离散动量 $p_k = \\frac{m}{h}(q_k - q_{k-1})$ 在由 DEL 方程定义的轨道上是精确守恒的。DEL 方程本身可以重新排列，得到问题中指定的积分器：\n    $$q_k - q_{k-1} = q_{k+1} - q_k \\implies q_{k+1} = 2q_k - q_{k-1}$$\n    这是 Störmer-Verlet 方法应用于零加速度的粒子，正确地表示了自由运动。\n\n### 第二部分：数值方案分析\n\n该问题要求进行数值模拟，以探究使用有限精度浮点运算执行这些计算的后果。\n\n1.  **动量漂移**: 在精确算术中，$\\|p_{k+1} - p_k\\| = 0$。然而，$q_{k+1} = 2q_k - q_{k-1}$ 的数值计算会受到舍入误差的影响。当 $q_k$ 和 $q_{k-1}$ 是差异很小的大向量时，对它们的操作可能导致精度损失。$q_{k+1}$ 中的这个误差会传播，导致计算出的 $p_{k+1}$ 与 $p_k$ 有轻微差异。量 $\\|p_{k+1} - p_k\\|$ 衡量了这种每步的数值漂移。\n\n2.  **不变性缺陷**: 问题介绍了离散拉格朗日量的两种代数上等价的形式：\n    -   差分形式: $L_d^{\\mathrm{diff}}(q_k, q_{k+1}; h) = \\frac{m}{2h}\\|q_{k+1} - q_k\\|^2$\n    -   展开形式: $L_d^{\\mathrm{exp}}(q_k, q_{k+1}; h) = \\frac{m}{2h}(\\|q_{k+1}\\|^2 + \\|q_k\\|^2 - 2q_{k+1} \\cdot q_k)$\n\n    目的是展示它们在浮点运算下的行为不同。不变性缺陷衡量了数值实现在满足 $L_d(q_k+a, q_{k+1}+a) = L_d(q_k, q_{k+1})$ 上的失败程度。\n\n    -   对于 $L_d^{\\mathrm{diff}}$，缺陷 $\\Delta^{\\mathrm{diff}}_k$ 是从 $|L_d^{\\mathrm{diff}}(q_k+a, q_{k+1}+a) - L_d^{\\mathrm{diff}}(q_k, q_{k+1})|$ 计算得出的。核心计算是 $(q_{k+1}+a) - (q_k+a)$。如果 $q_k$ 和 $q_{k+1}$ 很大且彼此非常接近，它们的差值就很小。减法 $(q_{k+1}+a) - (q_k+a)$ 在数值上是稳定的，因为它能准确地计算两个相近大数的差，从而得到一个小的数。因此，我们预期 $\\Delta^{\\mathrm{diff}}_k$ 将接近机器精度。\n\n    -   对于 $L_d^{\\mathrm{exp}}$，缺陷 $\\Delta^{\\mathrm{exp}}_k$ 依赖于计算诸如 $\\|q_k+a\\|^2 + \\|q_{k+1}\\|^2$ 之类的项，并从中减去相似的项。例如，测试不变性涉及计算 $\\|q_k+a\\|^2$ 和 $\\|q_k\\|^2$。如果 $q_k$ 是一个大向量（例如，在案例 3 中 $q_k \\approx 10^{15}$），那么 $\\|q_k+a\\|^2$ 和 $\\|q_k\\|^2$ 都是巨大的且彼此非常接近。它们的减法 $\\|q_k+a\\|^2 - \\|q_k\\|^2$ 是**灾难性抵消**的一个例子，其中大多数有效数字丢失，导致大的相对误差。因此，$L_d^{\\mathrm{exp}}(q_k+a, q_{k+1}+a)$ 的计算值将与 $L_d^{\\mathrm{exp}}(q_k, q_{k+1})$ 有显著差异，从而导致一个大的不变性缺陷 $\\Delta^{\\mathrm{exp}}_k$。\n\n3.  **相关性**: 待检验的核心假设是，守恒量（动量）的数值漂移是由相关对称性（平移不变性）的数值破坏直接引起的。通过计算动量漂移的时间序列 $\\{\\|p_{k+1}-p_k\\|\\}_{k=1}^{N-1}$ 与不变性缺陷的时间序列 $\\{\\Delta^{\\mathrm{exp}}_k\\}_{k=1}^{N-1}$ 之间的 Pearson 相关系数，我们可以定量地评估这种关系。一个高的正相关将为几何积分的这一基本原则提供强有力的数值证据，表明未能保持对称性会导致未能保持相应的动量映射。\n\n### 实现策略\n\n数值模拟的实现如下：\n1.  为每个测试用例初始化系统参数（$m, h, d, N, a, q_0, v_0$）。\n2.  设置一个大小为 $(N+1) \\times d$ 的数组 `q` 来存储轨迹。初始化 $q_0$ 和 $q_1 = q_0 + h v_0$。\n3.  对 $k$ 从 $1$ 到 $N-1$ 进行循环：\n    a. 计算 $q_{k+1} = 2q_k - q_{k-1}$。\n    b. 计算动量 $p_k = \\frac{m}{h}(q_k - q_{k-1})$ 和 $p_{k+1} = \\frac{m}{h}(q_{k+1} - q_k)$。\n    c. 计算动量漂移 $\\|p_{k+1} - p_k\\|$ 并将其存储在结果数组中。\n    d. 使用提供的公式计算不变性缺陷 $\\Delta_k^{\\mathrm{exp}}$ 和 $\\Delta_k^{\\mathrm{diff}}$ 并存储它们。\n4.  循环结束后，计算所需的汇总统计数据：\n    a. 动量漂移序列的最大值。\n    b. $\\Delta_k^{\\mathrm{exp}}$ 序列的最大值。\n    c. $\\Delta_k^{\\mathrm{diff}}$ 序列的最大值。\n    d. 动量漂移序列和 $\\Delta_k^{\\mathrm{exp}}$ 序列之间的 Pearson 相关系数。按照规定，包含对方差为零的检查，在这种情况下将相关性设置为 $0.0$。\n5.  将四个得到的浮点数格式化为每个测试用例指定的列表格式，并打印最终结果。",
            "answer": "[[0.0,0.0,0.0,0.0],[2.2737367544323206e-13,2251799813685.248,0.0,0.0401886071485603],[1.8189894035458565e-12,1.40737488355328e+16,0.0,0.0034631310156976625]]"
        }
    ]
}