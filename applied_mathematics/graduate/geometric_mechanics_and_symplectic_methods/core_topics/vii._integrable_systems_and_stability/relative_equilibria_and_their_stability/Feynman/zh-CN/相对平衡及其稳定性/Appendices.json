{
    "hands_on_practices": [
        {
            "introduction": "拉格朗日陀螺是几何力学中的一个经典模型。通过这个练习，我们将完整地应用能量-动量方法，包括计算其锁定惯性张量和增广势能。这个实践旨在通过第一性原理推导出“睡眠陀螺”（即直立旋转的陀螺）保持稳定所需的最小自旋速度，从而将抽象的理论工具与一个著名且直观的物理结果联系起来 。",
            "id": "3775624",
            "problem": "考虑一个在其尖端有一个固定点的对称刚体（轴对称陀螺）。其关于固定点的体坐标系惯性张量是对角的，主转动惯量为 $I_{1}=I_{2}$ 和 $I_{3}$，其中 $I_{3}$ 是围绕对称轴的转动惯量。其质量为 $m$，质心位于对称轴上，距离固定点为 $c$，均匀引力场的强度为 $g$。位形空间是特殊正交群 $\\mathrm{SO}(3)$，并且存在一个由围绕垂直空间轴的旋转给出的二维特殊正交群 $\\mathrm{SO}(2)$ 对称性。\n\n将此视为一个简单力学系统，其动能由惯性张量导出的黎曼度量定义，势能 $V(q)$ 由引力高度给出。令 $\\theta$ 表示物体对称轴与垂直空间轴之间的夹角。使用能量-动量方法分析相对平衡的稳定性，从第一性原理出发，步骤如下：\n\n- 定义 $\\mathrm{SO}(2)$ 对称性的动量映射，以及在位形 $q \\in \\mathrm{SO}(3)$ 处的锁定惯性张量 $\\mathbb{I}(q)$，它是在 $\\mathrm{SO}(2)$ 的李代数上的对称正定算子，由限制在通过 $q$ 的群轨道上的动能度量定义。\n- 显式计算 $\\langle \\mathbb{I}(q)\\xi,\\xi\\rangle$，其中 $\\xi$ 是对应于围绕垂直轴的稳定自旋速率 $\\Omega$ 的 $\\mathrm{SO}(2)$ 作用的生成元，将其表示为角度 $\\theta$ 和主转动惯量 $I_{1}$、$I_{3}$ 的函数。\n- 构建增广势 $V_{\\xi}(q)=V(q)-\\frac{1}{2}\\langle \\mathbb{I}(q)\\xi,\\xi\\rangle$，并将其在直立位形（$\\theta=0$）附近按小倾角 $\\theta$ 展开至二阶，用 $I_{1}$、$I_{3}$、$m$、$g$ 和 $c$ 表示决定稳定性的二次型。\n- 对此阿贝尔对称性计算阿诺德形式，并解释其对辛切片上二次型的贡献（或无贡献）。\n- 根据上述得到的总二次型的正定性，确定临界自旋角速度大小 $\\Omega_{\\mathrm{crit}}$，当自旋角速度超过此值时，直立旋转的陀螺是一个能量-动量稳定的相对平衡。\n\n将您的最终答案表示为 $\\Omega_{\\mathrm{crit}}$ 的封闭形式解析表达式，单位为弧度/秒。题目未提供数值；您的答案必须保持符号形式，且无需取整。",
            "solution": "为了使用能量-动量方法分析稳定性，我们遵循问题中概述的步骤。\n\n**1. 坐标、能量和势能**\n\n我们令空间坐标系的基向量为 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$，其中 $\\mathbf{e}_3$ 指向垂直向上，与重力方向相反。体坐标系的基向量为 $\\{\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3\\}$，其中 $\\mathbf{b}_3$ 沿陀螺的对称轴。系统的位形由一个旋转矩阵 $R \\in \\mathrm{SO}(3)$ 描述，它将体坐标映射到空间坐标。\n\n动能为 $T = \\frac{1}{2} (I_1 \\omega_1^2 + I_1 \\omega_2^2 + I_3 \\omega_3^2)$，其中 $\\boldsymbol{\\omega} = (\\omega_1, \\omega_2, \\omega_3)$ 是在体坐标系中表示的角速度。\n\n引力势能为 $V = mgz_{\\mathrm{cm}}$，其中 $z_{\\mathrm{cm}}$ 是质心的高度。质心在体坐标系中的位置是 $(0,0,c)^T$。其在空间坐标系的高度是 $z_{\\mathrm{cm}} = (R(c\\mathbf{b}_3)) \\cdot \\mathbf{e}_3 = c (R\\mathbf{b}_3) \\cdot \\mathbf{e}_3$。令 $\\mathbf{n} = R\\mathbf{b}_3$ 为物体对称轴在空间中的单位向量。角度 $\\theta$ 定义为 $\\mathbf{n}$ 与 $\\mathbf{e}_3$ 之间的夹角，因此 $\\cos\\theta = \\mathbf{n} \\cdot \\mathbf{e}_3$。势能可以写为 $V(\\theta) = mgc \\cos\\theta$。\n\n**2. 锁定惯性张量**\n\n系统的对称性是围绕空间垂直轴 $\\mathbf{e}_3$ 的旋转，构成 $\\mathrm{SO}(2)$ 群。一个以角速度 $\\Omega$ 稳定旋转的相对平衡，其生成元为 $\\xi \\in \\mathfrak{so}(2)$，在空间中对应的角速度向量为 $\\boldsymbol{\\Omega}_s = \\Omega \\mathbf{e}_3$。\n\n锁定惯性张量 $\\mathbb{I}(R)$ 刻画了当系统被迫沿着群轨道运动时的“有效惯性”。项 $\\langle \\mathbb{I}(R)\\xi, \\xi \\rangle$ 等于该运动动能的两倍。该运动对应的体角速度为 $\\boldsymbol{\\omega}_\\xi = R^T \\boldsymbol{\\Omega}_s = \\Omega (R^T \\mathbf{e}_3)$。\n\n我们计算 $\\langle \\mathbb{I}(R)\\xi, \\xi \\rangle = \\boldsymbol{\\omega}_\\xi^T I \\boldsymbol{\\omega}_\\xi$。令 $\\boldsymbol{\\nu} = R^T \\mathbf{e}_3$，这是空间垂直向量在体坐标系中的表示。其分量满足 $\\nu_3 = \\boldsymbol{\\nu} \\cdot \\mathbf{b}_3 = \\mathbf{e}_3 \\cdot (R \\mathbf{b}_3) = \\cos\\theta$ 和 $\\nu_1^2 + \\nu_2^2 = \\sin^2\\theta$。\n于是：\n$$\n\\boldsymbol{\\nu}^T I \\boldsymbol{\\nu} = I_1 \\nu_1^2 + I_1 \\nu_2^2 + I_3 \\nu_3^2 = I_1(\\nu_1^2 + \\nu_2^2) + I_3 \\nu_3^2 = I_1 \\sin^2\\theta + I_3 \\cos^2\\theta\n$$\n因此，我们得到锁定惯性项的显式表达式：\n$$\n\\langle \\mathbb{I}(R)\\xi, \\xi \\rangle = \\Omega^2(I_1 \\sin^2\\theta + I_3 \\cos^2\\theta)\n$$\n\n**3. 增广势及其展开**\n\n增广势 $V_{\\xi}$ 定义为 $V_{\\xi}(R) = V(R) - \\frac{1}{2}\\langle \\mathbb{I}(R)\\xi, \\xi \\rangle$。代入我们得到的表达式，它只依赖于角度 $\\theta$：\n$$\nV_{\\xi}(\\theta) = mgc \\cos\\theta - \\frac{1}{2}\\Omega^2(I_1 \\sin^2\\theta + I_3 \\cos^2\\theta)\n$$\n我们研究直立位形（“睡眠陀螺”），即 $\\theta=0$ 处的稳定性。为此，我们将 $V_{\\xi}(\\theta)$ 在 $\\theta=0$ 附近进行泰勒展开至二阶。使用小角度近似 $\\cos\\theta \\approx 1 - \\theta^2/2$ 和 $\\sin\\theta \\approx \\theta$：\n$$\nV_{\\xi}(\\theta) \\approx mgc\\left(1 - \\frac{\\theta^2}{2}\\right) - \\frac{1}{2}\\Omega^2(I_1 \\theta^2 + I_3(1-\\theta^2))\n$$\n$$\nV_{\\xi}(\\theta) \\approx \\left(mgc - \\frac{1}{2}I_3\\Omega^2\\right) + \\frac{1}{2}\\left[\\Omega^2(I_3-I_1) - mgc\\right]\\theta^2\n$$\n直立位形 $\\theta=0$ 是一个临界点（$\\frac{dV_\\xi}{d\\theta}|_{\\theta=0} = 0$）。其稳定性由 $\\theta^2$ 项的系数决定。决定稳定性的二次型为：\n$$\n\\frac{1}{2}\\left[\\Omega^2(I_3-I_1) - mgc\\right](\\delta\\theta)^2\n$$\n\n**4. 阿诺德形式**\n\n对于阿贝尔对称群（如本例中的 $\\mathrm{SO}(2)$），其李代数中的李括号恒为零。由于阿诺德形式的定义依赖于李括号，因此对于任何阿贝尔对称性，阿诺德形式恒为零。它对稳定性二次型没有贡献。\n\n**5. 临界自旋速度**\n\n稳定性要求总二次型是正定的。由于阿诺德形式为零，这等价于要求增广势在 $\\theta=0$ 处的二阶变分是正定的。这意味着 $(\\delta\\theta)^2$ 的系数必须为正：\n$$\n\\Omega^2(I_3-I_1) - mgc > 0\n$$\n要使此不等式有解，必须有 $I_3 > I_1$（一个长椭球形陀螺）。在此条件下，我们可以解出 $\\Omega^2$：\n$$\n\\Omega^2 > \\frac{mgc}{I_3-I_1}\n$$\n因此，直立旋转是稳定的，条件是自旋角速度的大小 $|\\Omega|$ 超过一个临界值。该临界角速度 $\\Omega_{\\mathrm{crit}}$ 由等式取等号时确定：\n$$\n\\Omega_{\\mathrm{crit}}^2 = \\frac{mgc}{I_3-I_1}\n$$\n取正平方根，我们得到临界自旋角速度：\n$$ \\Omega_{\\mathrm{crit}} = \\sqrt{\\frac{mgc}{I_3-I_1}} $$",
            "answer": "$$\\boxed{\\sqrt{\\frac{mgc}{I_{3}-I_{1}}}}$$"
        },
        {
            "introduction": "上一个练习帮助我们计算出了稳定性的临界条件。一个自然而然的问题是：当自旋速度低于这个临界值时，系统会发生什么？这个练习将引导我们从静态的稳定性分析过渡到动态的分岔理论 。它探讨了当一个相对平衡态失去稳定性时，往往会催生出新的、稳定的运动模态（如此处的稳定进动），从而揭示了稳定与系统行为质变之间的深刻联系。",
            "id": "3775619",
            "problem": "考虑一个有固定点的重对称刚体（拉格朗日陀螺），其位形流形为 $Q=\\mathrm{SO}(3)$，关于任何垂直于物体对称轴的轴的主转动惯量为 $I_{\\perp}$，关于对称轴的主转动惯量为 $I_{3}$。质心位于对称轴上，距固定点距离为 $\\ell$，质量为 $m$，重力加速度为 $g$。该系统具有关于空间中竖直轴旋转的连续对称性，形成一个李群 $G=\\mathrm{SO}(2)$，通过围绕重力轴的空间旋转作用于 $Q$。相应的动量映射 $J:T^{*}Q\\to\\mathfrak{so}(2)^{*}\\cong\\mathbb{R}$ 将每个状态映射到空间角动量的竖直分量。\n\n一个单参数相对平衡族由“睡眠陀螺”给出，其中物体对称轴与竖直方向对齐，物体以恒定角速度 $\\Omega$ 绕其对称轴旋转。使用相对平衡的定义（存在一个速度 $\\xi\\in\\mathfrak{so}(2)$，使得哈密顿向量场在该状态下等于无穷小生成元），以及能量-动量（EM）稳定性方法（稳定性由增广哈密顿量在固定动量下限制在辛切片上的二阶变分的定号性确定），从第一性原理推断当参数变化时稳定性如何丧失。\n\n假设对于某个临界自旋速度 $\\Omega=\\Omega_{\\mathrm{c}}$（其平滑地依赖于 $(I_{\\perp},I_{3},m,g,\\ell)$），当 $\\Omega$ 穿过 $\\Omega_{\\mathrm{c}}$ 时，与“倾斜”模态相关的约束Hessian矩阵（即增广哈密顿量在移除了群方向和动量约束的辛切片上的二阶变分）的一个特征值以非零速度穿过零。不存在其他简并，并且等变分岔的一般非简并条件成立。\n\n当 $\\Omega$ 减小并穿过 $\\Omega_{\\mathrm{c}}$ 时，以下哪种分岔情景正确地描述了能量-动量稳定性的丧失以及相对平衡集相应的定性变化？\n\nA. 在 $\\Omega=\\Omega_{\\mathrm{c}}$ 时，辛切片上恰好有一个特征值从正变为负。睡眠陀螺从能量-动量稳定过渡到不稳定。一个倾斜的、稳定进动的运动分支（相对平衡，其对称轴与竖直方向成一个小的固定倾角）发生分岔，形成一个由剩余 $\\mathrm{SO}(2)$ 对称性关联的等价解组成的圆；在对称性模下，这是一个相对平衡的叉式分岔。\n\nB. 在 $\\Omega=\\Omega_{\\mathrm{c}}$ 时，必然发生哈密顿-霍普夫分岔：线性谱立即获得一个具有非零实部的复四重根，而睡眠陀螺保持能量-动量稳定，因为约束Hessian矩阵保持定号；相对平衡集没有变化。\n\nC. 即使在 $\\Omega=\\Omega_{\\mathrm{c}}$ 时约束Hessian矩阵的一个特征值穿过零，动量映射 $J$ 的守恒性迫使睡眠陀螺对所有 $\\Omega$ 都保持能量-动量稳定，并且由于连续对称性，不会出现新的相对平衡分支。\n\nD. 在没有重力（$g=0$）的情况下，当 $\\Omega$ 经过一个非零的 $\\Omega_{\\mathrm{c}}$ 时，约束Hessian矩阵的一个特征值变号，并且相对平衡的鞍结分岔创建然后湮灭一对新的旋转状态；这通过在 $g$ 上的连续性解释了有重力情况下睡眠陀螺能量-动量稳定性的丧失。\n\n选择唯一的最佳选项。",
            "solution": "该问题描述了拉格朗日陀螺的一个相对平衡（“睡眠陀螺”）在参数（自旋速度 $\\Omega$）变化时失去稳定性的情景，并要求我们根据等变分岔理论来判断其后果。\n\n**1. 能量-动量稳定性与分岔条件**\n\n能量-动量（EM）方法的稳定性判据是：如果增广哈密顿量 $H_{\\xi}$ 在辛切片上的二阶变分（即“约束Hessian矩阵”）是正定的，则该相对平衡是稳定的。问题的前提是，当 $\\Omega$ 减小并穿过 $\\Omega_{\\mathrm{c}}$ 时，该矩阵的一个特征值从正变为负。这意味着约束Hessian矩阵在 $\\Omega  \\Omega_{\\mathrm{c}}$ 时不再是正定的。因此，根据EM方法的定义，睡眠陀螺从能量-动量稳定（$\\Omega > \\Omega_{\\mathrm{c}}$）过渡到能量-动量不稳定（$\\Omega  \\Omega_{\\mathrm{c}}$）。\n\n约束Hessian矩阵的一个特征值穿过零，正是系统发生稳态分岔（steady-state bifurcation）的标志。\n\n**2. 等变分岔理论的应用**\n\n由于系统具有 $\\mathrm{SO}(2)$ 对称性，我们需要运用等变分岔理论来分析。\n- **对称性破缺**：原始的“睡眠陀螺”解具有完整的 $\\mathrm{SO}(2)$ 对称性（即绕竖直轴旋转，陀螺看起来不变）。分岔出的新解的对称性通常会低于原始解。\n- **新解的产生**：等变分支引理（Equivariant Branching Lemma）预测，当一个与特定群表示相关的单个特征值穿过零时，必然会有一个新的解分支从原始解分支上分岔出来。\n- **新解的形态**：问题指出，不稳定性与“倾斜”模态相关。这意味着新产生的解将是倾斜的陀螺。对于拉格朗日陀螺，这些新解对应于以固定倾角稳定进动的陀螺。这些进动状态本身也是相对平衡，但对称性较低（它们在 $\\mathrm{SO}(2)$ 作用下不再保持不变）。\n- **群轨道的作用**：由于系统具有 $\\mathrm{SO}(2)$ 对称性，如果存在一个倾斜的稳定进动解，那么将该解绕竖直轴旋转任意角度，得到的都是等价的解。因此，所有这些新的相对平衡点在相空间中形成一个圆（一个与 $\\mathrm{SO}(2)$ 同构的群轨道）。\n- **分岔类型**：当我们“模去”对称性的影响（例如，只关注倾斜角的大小，而不关心其方位），这种从一个高对称性解（零倾斜角）分岔出对称性更低的解（非零倾斜角）的现象，其典型的拓扑结构是**叉式分岔**（pitchfork bifurcation）。\n\n**3. 各选项分析**\n\n*   **A**: 该选项准确地描述了上述所有要点：约束Hessian矩阵特征值变号导致稳定性丧失；分岔产生新的倾斜进动相对平衡分支；这些新解因 $\\mathrm{SO}(2)$ 对称性而形成一个圆；在模去对称性后，该分岔是叉式分岔。**这是正确的描述。**\n\n*   **B**: 该选项描述的是哈密顿-霍普夫分岔，它源于线性化动力学的一对纯虚特征值发生碰撞并离开虚轴。这与问题描述的“约束Hessian矩阵的一个特征值穿过零”这一稳态分岔条件完全不同。此外，该选项错误地声称约束Hessian矩阵保持定号，这直接与问题的前提矛盾。\n\n*   **C**: 该选项错误地理解了动量守恒和对称性的作用。能量-动量稳定性分析正是在动量守恒的约束下进行的。稳定性丧失恰恰是通过约束Hessian矩阵的变号来体现的。连续对称性非但不会阻止分岔，反而决定了分岔的结构和新解的对称性。\n\n*   **D**: 该选项的物理前提是错误的。对于一个自由的对称陀螺（$g=0$），绕其对称轴的旋转对于所有非零角速度都是稳定的（只要该轴不是中间惯量轴，这对对称陀螺不适用）。不存在一个非零的临界速度 $\\Omega_c$ 会导致稳定性丧失。睡眠陀螺的稳定性丧失和分岔现象本质上是旋转动能与引力势能竞争的结果，在 $g=0$ 时不会发生。\n\n综上所述，选项A是唯一正确描述该物理情景的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理论分析的核心思想——利用对称性将系统约化至一个具有“有效势”的低维空间——同样是数值计算的有力工具。这个练习将理论付诸实践，要求我们设计一个数值算法来寻找和分类中心力场问题中的相对平衡态 。通过将辛约化的概念转化为可执行的代码，我们不仅能验证理论预测，还能处理那些难以进行解析求解的复杂势能函数。",
            "id": "3764833",
            "problem": "考虑余切丛 $T^*\\mathbb{R}^2$ 上的一个哈密顿系统，其正则坐标为 $(q,p)$，其中 $q \\in \\mathbb{R}^2$，$p \\in \\mathbb{R}^2$。辛形式为标准形式，由 $\\omega = dq \\wedge dp$ 给出。哈密顿量 $H$ 是简单力学类型的 $H(q,p) = \\tfrac{1}{2}\\|p\\|^2 + V(\\|q\\|)$，其中 $V$ 是一个光滑的、仅依赖于半径 $r = \\|q\\|$ 的径向对称势。\n\n令二维特殊正交群 (SO$(2)$) 通过旋转作用于位形空间，该作用以正则方式提升至 $T^*\\mathbb{R}^2$。相关的动量映射 $J: T^*\\mathbb{R}^2 \\to \\mathbb{R}$ 是标量角动量 $J(q,p) = q_1 p_2 - q_2 p_1$。如果存在一个李代数元 $\\xi \\in \\mathfrak{so}(2)$（等价于一个标量角速度 $\\omega$），使得哈密顿向量场 $X_H(z)$ 等于由 $\\xi$ 诱导的在 $z$ 点的群作用的无穷小生成元，则称状态 $z \\in T^*\\mathbb{R}^2$ 为一个相对平衡。\n\n从这些基本定义出发，使用动量映射在固定值 $J = \\mu$ 处的辛约化，将相对平衡刻画为径向坐标 $r$ 的约化动力学的平衡点。然后，设计一个数值方法，对于给定的光滑中心势 $V(r)$ 和固定的角动量 $\\mu$，构造所有相对平衡的正半径 $r > 0$，并通过评估约化能量沿径向的二阶变分的定性来验证其稳定性。角速度 $\\omega$ 以弧度每单位时间表示。\n\n您的任务是实现一个程序，对每个提供的测试用例执行以下操作：\n- 在固定角动量 $J = \\mu$ 下，构造所有对于辛约化径向动力学是稳定的正半径 $r$。\n- 对于每个这样的半径 $r$，计算与相对平衡相关的角速度 $\\omega$。\n- 通过检查约化的一自由度问题中二阶变分在 $r$ 处是否为正来分类径向稳定性；如果为正，返回 $True$，否则返回 $False$。\n\n您的程序必须处理以下测试套件。在每种情况下，$r$ 是径向坐标，$\\mu$ 是固定的角动量，$V(r)$ 按指定定义。下面提供的所有数值都是无量纲的，必须如此处理。角速度必须以弧度每单位时间（无量纲时间）表示。\n\n- 测试用例 1 (快乐路径，单根，凸势)：\n  - 势类型：谐振子，$V(r) = \\tfrac{1}{2}\\kappa r^2$，参数 $\\kappa = 2.0$。\n  - 角动量：$\\mu = 1.5$。\n\n- 测试用例 2 (边界情况，长程引力，单根)：\n  - 势类型：开普勒加约束（约束为零），$V(r) = -\\alpha / r + \\tfrac{1}{2}\\beta r^2$，参数 $\\alpha = 1.0$，$\\beta = 0.0$。\n  - 角动量：$\\mu = 0.5$。\n\n- 测试用例 3 (混合曲率，约束加引力，可能根据参数有多个根)：\n  - 势类型：开普勒加约束，$V(r) = -\\alpha / r + \\tfrac{1}{2}\\beta r^2$，参数 $\\alpha = 2.0$，$\\beta = 0.5$。\n  - 角动量：$\\mu = 0.2$。\n\n- 测试用例 4 (多阱多项式，势允许多个稳定半径)：\n  - 势类型：六次多项式，$V(r) = \\tfrac{1}{2}\\kappa r^2 - \\tfrac{1}{4}\\delta r^4 + 0.1 \\lambda r^6$，参数 $\\kappa = 1.0$，$\\delta = 3.0$，$\\lambda = 0.5$。\n  - 角动量：$\\mu = 10^{-6}$。\n\n- 测试用例 5 (边缘情况，反谐振子势，无物理稳定半径)：\n  - 势类型：谐振子，$V(r) = \\tfrac{1}{2}\\kappa r^2$，参数 $\\kappa = -1.0$。\n  - 角动量：$\\mu = 0.2$。\n\n输出规范：\n- 对于每个测试用例，返回一个列表，其中包含所有找到的相对平衡，每个相对平衡以 $[r, \\omega, s]$ 的子列表形式表示，其中 $r$ 和 $\\omega$ 是浮点数，$s$ 是一个布尔值，表示径向稳定性（$True$ 表示稳定，$False$ 表示不稳定）。\n- 如果某个测试用例不存在正的稳定半径，则为该用例返回一个空列表。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，例如：对于每个测试用例，结果为 $[[r_1,\\omega_1,s_1],[r_2,\\omega_2,s_2],\\dots]$，聚合为 $[case1,case2,case3,case4,case5]$。\n\n角度单位要求：角速度 $\\omega$ 必须以弧度每单位时间（无量纲时间）表示。此问题中不出现其他物理单位。\n\n重要约束：\n- 推导和算法必须从基础出发：哈密顿系统、辛形式、动量映射和在固定 $J = \\mu$ 处的辛约化。\n- 不要在问题陈述中使用快捷公式；实现所需的所有具体公式必须在您的解决方案中推导出来。\n- 通过使用光滑势并正确处理定义域 $r  0$ 来确保科学真实性。\n\n您的程序不得要求任何用户输入，并且必须精确解决指定的测试套件。最终输出必须遵守上述确切格式。",
            "solution": "我们从哈密顿系统和对称性的基本定义开始。相空间是 $T^*\\mathbb{R}^2$，具有正则坐标 $(q,p)$ 和标准辛形式 $\\omega = dq \\wedge dp$。哈密顿量为 $H(q,p) = \\tfrac{1}{2}\\|p\\|^2 + V(\\|q\\|)$，其中 $V$ 是一个光滑的中心势，依赖于半径 $r = \\|q\\|$。二维特殊正交群 (SO$(2)$) 通过旋转作用于位形空间 $\\mathbb{R}^2$，其余切提升作用于 $T^*\\mathbb{R}^2$ 并保持辛形式不变。相关的动量映射 $J: T^*\\mathbb{R}^2 \\to \\mathbb{R}$ 是标量角动量 $J(q,p) = q_1 p_2 - q_2 p_1$。\n\n相对平衡定义为相空间中的一点 $z \\in T^*\\mathbb{R}^2$，使得存在 $\\xi \\in \\mathfrak{so}(2)$（可等同于一个标量角速度 $\\omega$），满足哈密顿向量场等于该群作用在 $z$ 点的无穷小生成元，即 $X_H(z) = \\xi_{T^*\\mathbb{R}^2}(z)$。对于具有这种对称性的简单力学系统，在固定值 $J = \\mu$ 处进行辛约化，会得到一个由径向坐标 $r$ 及其共轭径向动量 $p_r$ 参数化的约化空间上的动力学。这种约化利用了 $H$ 在 SO$(2)$ 作用下的不变性以及 $J$ 沿轨迹的守恒性。\n\n在等值面 $J = \\mu$ 上，径向变量 $(r, p_r)$ 的有效约化哈密顿量形式为\n$$\nH_{\\mathrm{red}}(r,p_r; \\mu) = \\tfrac{1}{2} p_r^2 + V_{\\mathrm{eff}}(r; \\mu),\n$$\n其中有效势 $V_{\\mathrm{eff}}$ 由原始势 $V$ 和因固定角动量而产生的离心贡献共同构成。约化运动方程意味着，约化动力学中的平衡点对应于 $V_{\\mathrm{eff}}(r; \\mu)$ 的临界点。具体来说，平衡点满足 $p_r = 0$ 和\n$$\n\\frac{d}{dr} V_{\\mathrm{eff}}(r; \\mu) = 0.\n$$\n\n我们现在推导 $V_{\\mathrm{eff}}(r; \\mu)$ 的显式形式。在极坐标中，动能分解为径向和角向部分，其中角向部分受固定角动量 $J = \\mu$ 的约束。标准的力学约化得到\n$$\nV_{\\mathrm{eff}}(r; \\mu) = V(r) + \\frac{\\mu^2}{2 r^2},\n$$\n其中附加项 $\\frac{\\mu^2}{2 r^2}$ 代表离心势垒。因此，稳定半径 $r  0$ 是以下方程的解：\n$$\n\\frac{d}{dr} V_{\\mathrm{eff}}(r; \\mu) = \\frac{d}{dr} V(r) - \\frac{\\mu^2}{r^3} = 0.\n$$\n相对平衡的角速度 $\\omega$ 可由平面运动中固定角动量的运动学得出，\n$$\n\\omega = \\frac{\\mu}{r^2},\n$$\n其单位为弧度每单位时间。\n\n为了评估稳定性，我们考虑约化能量沿径向的二阶变分。将约化的一自由度系统在稳定半径附近线性化，得到条件\n$$\n\\frac{d^2}{dr^2} V_{\\mathrm{eff}}(r; \\mu) = \\frac{d^2}{dr^2} V(r) + \\frac{3 \\mu^2}{r^4}.\n$$\n在平衡半径处，这个二阶导数的正性确保了该平衡点是 $V_{\\mathrm{eff}}$ 的一个局部极小值，并且在约化动力学中是线性稳定的。在平面内具有 SO$(2)$ 对称性的简单力学系统的能量-动量方法背景下，此约化黑塞矩阵沿径向方向的正性足以推断相对平衡在群作用模下的形式稳定性。因此，我们使用 $\\frac{d^2}{dr^2} V_{\\mathrm{eff}}(r; \\mu)$ 在每个稳定半径处的符号来分类稳定性。\n\n算法设计：\n1. 对于每个测试用例，根据指定的势类型和参数定义 $V(r)$、其一阶导数 $\\frac{d}{dr} V(r)$ 和二阶导数 $\\frac{d^2}{dr^2} V(r)$。\n   - 谐振子势：$V(r) = \\tfrac{1}{2}\\kappa r^2$，因此 $\\frac{d}{dr} V(r) = \\kappa r$，$\\frac{d^2}{dr^2} V(r) = \\kappa$。\n   - 开普勒加约束势：$V(r) = -\\alpha / r + \\tfrac{1}{2}\\beta r^2$，因此 $\\frac{d}{dr} V(r) = \\alpha / r^2 + \\beta r$，$\\frac{d^2}{dr^2} V(r) = -2\\alpha / r^3 + \\beta$。\n   - 六次多项式势：$V(r) = \\tfrac{1}{2}\\kappa r^2 - \\tfrac{1}{4}\\delta r^4 + 0.1 \\lambda r^6$，因此 $\\frac{d}{dr} V(r) = \\kappa r - \\delta r^3 + 0.6 \\lambda r^5$，$\\frac{d^2}{dr^2} V(r) = \\kappa - 3 \\delta r^2 + 3.0 \\lambda r^4$。\n\n2. 构造有效势的导数：\n   $$\n   F(r; \\mu) := \\frac{d}{dr} V_{\\mathrm{eff}}(r; \\mu) = \\frac{d}{dr} V(r) - \\frac{\\mu^2}{r^3}.\n   $$\n   定义域约束为 $r  0$。注意，当 $r \\to 0^+$ 时，由于离心项，若 $\\mu \\neq 0$，则 $F(r; \\mu) \\to -\\infty$。\n\n3. 求解 $r  0$ 范围内 $F(r; \\mu) = 0$ 的所有根：\n   - 使用区间求根方法，基于 $F$ 在区间 $[r_{\\min}, r_{\\max}]$ 的网格点上的符号变化。$r_{\\min}$ 取一个较小的值（例如 $10^{-6}$），$r_{\\max}$ 选择足够大以捕捉与指定势相关的所有可能的稳定半径。\n   - 对于每个相邻的网格点对 $(a,b)$，若 $F(a) \\cdot F(b)  0$，则应用鲁棒的标量求根方法（Brent 方法）在 $(a,b)$ 内定位一个根。\n   - 在一定容差下，对数值上接近的根进行去重。\n\n4. 对于找到的每个根 $r$：\n   - 计算 $\\omega = \\mu / r^2$ (弧度每单位时间)。\n   - 计算 $G(r; \\mu) := \\frac{d^2}{dr^2} V_{\\mathrm{eff}}(r; \\mu) = \\frac{d^2}{dr^2} V(r) + \\frac{3 \\mu^2}{r^4}$。\n   - 通过 $s = (G(r; \\mu)  0)$ 对稳定性进行分类。\n\n5. 对于每个测试用例，返回按 $r$ 升序排列的 $[r, \\omega, s]$ 三元组列表。如果不存在根，则为该用例返回一个空列表。\n\n数值考量：\n- 函数 $F(r; \\mu)$ 在 $r=0$ 处有奇点（当 $\\mu \\neq 0$ 时），但算法通过从 $r_{\\min} = 10^{-6}$ 开始搜索来避免此问题。\n- 对于开普勒势 $V(r) = -\\alpha / r$ 且 $\\alpha  0$，存在唯一的物理相关根 $r = \\mu^2 / \\alpha$，且二阶导数 $G(r; \\mu)$ 为正，表明是稳定的。\n- 对于凸势，如 $\\kappa  0$ 的谐振子情况，稳定半径是唯一且稳定的。\n- 对于多阱多项式势，可能存在多个稳定半径；算法会发现所有符号变化并相应地对每个平衡点进行分类。\n- 对于 $\\kappa  0$ 的反谐振子势，$F(r; \\mu)$ 对所有 $r  0$ 均保持负值（对于 $\\mu \\neq 0$），因此不存在正的稳定半径。\n\n程序实现了这些步骤来处理指定的测试套件，并以要求的格式打印包含所有测试用例聚合结果的单行输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\n# Define potential functions and their derivatives for each type.\ndef potential_funcs(case):\n    ptype = case['type']\n    if ptype == 'harmonic':\n        kappa = case['kappa']\n        def V(r):\n            return 0.5 * kappa * r**2\n        def dV(r):\n            return kappa * r\n        def ddV(r):\n            return kappa\n        return V, dV, ddV\n    elif ptype == 'kepler_conf':\n        alpha = case['alpha']\n        beta = case['beta']\n        def V(r):\n            return -alpha / r + 0.5 * beta * r**2\n        def dV(r):\n            return alpha / r**2 + beta * r\n        def ddV(r):\n            return -2.0 * alpha / r**3 + beta\n        return V, dV, ddV\n    elif ptype == 'poly6':\n        kappa = case['kappa']\n        delta = case['delta']\n        lam = case['lambda']\n        # V(r) = 0.5 kappa r^2 - 0.25 delta r^4 + 0.1 lambda r^6\n        def V(r):\n            return 0.5 * kappa * r**2 - 0.25 * delta * r**4 + 0.1 * lam * r**6\n        def dV(r):\n            return kappa * r - delta * r**3 + 0.6 * lam * r**5\n        def ddV(r):\n            return kappa - 3.0 * delta * r**2 + 3.0 * lam * r**4\n        return V, dV, ddV\n    else:\n        raise ValueError(\"Unknown potential type\")\n\ndef find_stationary_radii(dV, mu, rmin=1e-6, rmax=100.0, ngrid=2000):\n    # F(r) = dV(r) - mu^2 / r^3\n    def F(r):\n        if r = 0:\n            return -np.inf if mu != 0 else dV(np.finfo(float).eps)\n        return dV(r) - (mu**2) / (r**3)\n    # Sample grid and detect sign changes\n    # Use logarithmic spacing near small r and linear towards larger r\n    # Construct a grid that is dense near small r\n    small = np.logspace(np.log10(rmin), np.log10(1.0), num=ngrid//2, base=10.0)\n    large = np.linspace(1.0, rmax, num=ngrid//2)\n    grid = np.unique(np.concatenate([small, large]))\n    vals = np.array([F(r) for r in grid])\n    roots = []\n    for i in range(len(grid)-1):\n        a, b = grid[i], grid[i+1]\n        fa, fb = vals[i], vals[i+1]\n        if np.isnan(fa) or np.isnan(fb):\n            continue\n        # Check for sign change\n        root = None\n        if fa == 0.0:\n            root = a\n        elif fb == 0.0:\n            root = b\n        elif fa * fb  0.0:\n            # Brent's method\n            try:\n                res = root_scalar(F, bracket=(a, b), method='brentq')\n                if res.converged and res.root > 0:\n                    root = res.root\n                else:\n                    continue\n            except ValueError:\n                continue\n        \n        if root is not None:\n            # Deduplicate roots\n            if all(abs(root - r0) > 1e-6 for r0 in roots):\n                roots.append(root)\n    roots.sort()\n    return roots\n\ndef classify_equilibria(case):\n    V, dV, ddV = potential_funcs(case)\n    mu = case['mu']\n    radii = find_stationary_radii(dV, mu)\n    eqs = []\n    for r in radii:\n        omega = mu / (r**2)\n        # Second derivative of effective potential: ddV + 3 mu^2 / r^4\n        G = ddV(r) + 3.0 * (mu**2) / (r**4)\n        stable = bool(G > 0.0)\n        eqs.append([float(r), float(omega), stable])\n    return eqs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'harmonic', 'kappa': 2.0, 'mu': 1.5},                        # Case 1\n        {'type': 'kepler_conf', 'alpha': 1.0, 'beta': 0.0, 'mu': 0.5},        # Case 2\n        {'type': 'kepler_conf', 'alpha': 2.0, 'beta': 0.5, 'mu': 0.2},        # Case 3\n        {'type': 'poly6', 'kappa': 1.0, 'delta': 3.0, 'lambda': 0.5, 'mu': 1e-6},  # Case 4\n        {'type': 'harmonic', 'kappa': -1.0, 'mu': 0.2},                       # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        eqs = classify_equilibria(case)\n        results.append(eqs)\n\n    # Final print statement in the exact required format.\n    print(str(results).replace(\"], [\", \"],[\",).replace(\" \", \"\"))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}