{
    "hands_on_practices": [
        {
            "introduction": "刘维尔-阿诺德定理的核心在于找到一组“互相对合”（in involution）的运动积分。这个练习将带你实践最基本也是最关键的一步：计算泊松括号 。通过显式计算两个哈密顿量 $H$ 和 $K$ 的泊松括号，你将能够判断它们是否对合，从而确定它们产生的哈密顿流是否交换，这是判断系统可积性的基石。",
            "id": "3779752",
            "problem": "考虑辛向量空间 $(\\mathbb{R}^{4},\\omega)$，其坐标为 $(q_{1},q_{2},p_{1},p_{2})$，标准辛形式为 $\\omega=\\sum_{i=1}^{2}dq_{i}\\wedge dp_{i}$。定义两个哈密顿函数 $H$ 和 $K$ 如下：\n$$\nH(q_{1},q_{2},p_{1},p_{2})=\\frac{1}{2}\\left(p_{1}^{2}+p_{2}^{2}\\right)+q_{1}p_{2}-q_{2}p_{1}+\\frac{1}{2}\\left(q_{1}^{2}-q_{2}^{2}\\right),\n$$\n$$\nK(q_{1},q_{2},p_{1},p_{2})=q_{1}p_{1}+2q_{2}p_{2}+p_{1}p_{2}+q_{1}q_{2}.\n$$\n从辛几何和哈密顿力学的基本定义出发，显式计算与 $\\omega$ 相关联的泊松括号 $\\{H,K\\}$。然后，在刘维尔-阿诺德定理的背景下，利用您的计算结果判断由 $H$ 和 $K$ 生成的哈密顿流在 $(\\mathbb{R}^{4},\\omega)$上是否交换。将您的最终答案仅表示为 $\\{H,K\\}$ 的闭式解析表达式。",
            "solution": "所述问题是有效的。这是一个在哈密顿力学标准框架内定义明确的问题，提供了所有必要的定义和函数，没有内部矛盾、科学不准确性或含糊之处。\n\n问题的核心是在辛向量空间 $(\\mathbb{R}^{4}, \\omega)$ 上计算两个函数 $H$ 和 $K$ 的泊松括号。坐标给定为 $(q_{1}, q_{2}, p_{1}, p_{2})$，标准辛形式为 $\\omega = \\sum_{i=1}^{2} dq_{i} \\wedge dp_{i}$。\n\n对于具有正则坐标 $(q_{i}, p_{i})$ 的一般 $2n$ 维相空间，两个光滑函数 $F(q,p)$ 和 $G(q,p)$ 的泊松括号定义为：\n$$\n\\{F, G\\} = \\sum_{i=1}^{n} \\left( \\frac{\\partial F}{\\partial q_{i}} \\frac{\\partial G}{\\partial p_{i}} - \\frac{\\partial F}{\\partial p_{i}} \\frac{\\partial G}{\\partial q_{i}} \\right)\n$$\n在此问题中，$n=2$，因此表达式展开为：\n$$\n\\{H, K\\} = \\left( \\frac{\\partial H}{\\partial q_{1}} \\frac{\\partial K}{\\partial p_{1}} - \\frac{\\partial H}{\\partial p_{1}} \\frac{\\partial K}{\\partial q_{1}} \\right) + \\left( \\frac{\\partial H}{\\partial q_{2}} \\frac{\\partial K}{\\partial p_{2}} - \\frac{\\partial H}{\\partial p_{2}} \\frac{\\partial K}{\\partial q_{2}} \\right)\n$$\n为了计算这个括号，我们必须首先求出给定的哈密顿函数 $H$ 和 $K$ 的偏导数。\n\n函数 $H$ 为：\n$$\nH(q_{1},q_{2},p_{1},p_{2})=\\frac{1}{2}\\left(p_{1}^{2}+p_{2}^{2}\\right)+q_{1}p_{2}-q_{2}p_{1}+\\frac{1}{2}\\left(q_{1}^{2}-q_{2}^{2}\\right)\n$$\n其关于正则坐标的偏导数是：\n$$\n\\frac{\\partial H}{\\partial q_{1}} = q_{1}+p_{2}\n$$\n$$\n\\frac{\\partial H}{\\partial q_{2}} = -p_{1}-q_{2}\n$$\n$$\n\\frac{\\partial H}{\\partial p_{1}} = p_{1}-q_{2}\n$$\n$$\n\\frac{\\partial H}{\\partial p_{2}} = p_{2}+q_{1}\n$$\n\n函数 $K$ 为：\n$$\nK(q_{1},q_{2},p_{1},p_{2})=q_{1}p_{1}+2q_{2}p_{2}+p_{1}p_{2}+q_{1}q_{2}\n$$\n其偏导数是：\n$$\n\\frac{\\partial K}{\\partial q_{1}} = p_{1}+q_{2}\n$$\n$$\n\\frac{\\partial K}{\\partial q_{2}} = 2p_{2}+q_{1}\n$$\n$$\n\\frac{\\partial K}{\\partial p_{1}} = q_{1}+p_{2}\n$$\n$$\n\\frac{\\partial K}{\\partial p_{2}} = 2q_{2}+p_{1}\n$$\n\n接下来，我们将这些导数代入泊松括号公式。我们将分别计算 $i=1$ 和 $i=2$ 项的贡献。\n\n对于 $i=1$ 项：\n$$\n\\frac{\\partial H}{\\partial q_{1}}\\frac{\\partial K}{\\partial p_{1}} - \\frac{\\partial H}{\\partial p_{1}}\\frac{\\partial K}{\\partial q_{1}} = (q_{1}+p_{2})(q_{1}+p_{2}) - (p_{1}-q_{2})(p_{1}+q_{2})\n$$\n$$\n= (q_{1}+p_{2})^{2} - (p_{1}^{2}-q_{2}^{2}) = q_{1}^{2} + 2q_{1}p_{2} + p_{2}^{2} - p_{1}^{2} + q_{2}^{2}\n$$\n\n对于 $i=2$ 项：\n$$\n\\frac{\\partial H}{\\partial q_{2}}\\frac{\\partial K}{\\partial p_{2}} - \\frac{\\partial H}{\\partial p_{2}}\\frac{\\partial K}{\\partial q_{2}} = (-p_{1}-q_{2})(2q_{2}+p_{1}) - (p_{2}+q_{1})(2p_{2}+q_{1})\n$$\n$$\n= -(p_{1}+q_{2})(p_{1}+2q_{2}) - (q_{1}+p_{2})(q_{1}+2p_{2})\n$$\n展开这些乘积得到：\n$$\n= -(p_{1}^{2} + 3p_{1}q_{2} + 2q_{2}^{2}) - (q_{1}^{2} + 3q_{1}p_{2} + 2p_{2}^{2})\n$$\n$$\n= -p_{1}^{2} - 3p_{1}q_{2} - 2q_{2}^{2} - q_{1}^{2} - 3q_{1}p_{2} - 2p_{2}^{2}\n$$\n\n现在，我们将 $i=1$ 和 $i=2$ 的结果相加，以求得总的泊松括号 $\\{H,K\\}$：\n$$\n\\{H,K\\} = (q_{1}^{2} + 2q_{1}p_{2} + p_{2}^{2} - p_{1}^{2} + q_{2}^{2}) + (-p_{1}^{2} - 3p_{1}q_{2} - 2q_{2}^{2} - q_{1}^{2} - 3q_{1}p_{2} - 2p_{2}^{2})\n$$\n我们合并同类项以简化表达式：\n$$\n\\{H,K\\} = (q_{1}^{2} - q_{1}^{2}) + (q_{2}^{2} - 2q_{2}^{2}) + (-p_{1}^{2} - p_{1}^{2}) + (p_{2}^{2} - 2p_{2}^{2}) + (2q_{1}p_{2} - 3q_{1}p_{2}) - 3p_{1}q_{2}\n$$\n进行最后的简化：\n$$\n\\{H,K\\} = (0) + (-q_{2}^{2}) + (-2p_{1}^{2}) + (-p_{2}^{2}) + (-q_{1}p_{2}) - 3p_{1}q_{2}\n$$\n按照惯例，我们对各项进行排序，得到泊松括号的最终解析表达式：\n$$\n\\{H,K\\} = -2p_{1}^{2} - p_{2}^{2} - q_{2}^{2} - 3p_{1}q_{2} - q_{1}p_{2}\n$$\n\n关于哈密顿流的可交换性，我们回顾一个基本结论：由两个哈密顿量 $H$ 和 $K$ 生成的流是交换的，当且仅当 $H$ 和 $K$ 泊松交换，即 $\\{H,K\\}=c$，其中 $c$ 是一个常数。在涉及可积系统的刘维尔-阿诺德定理的背景下，要求更为严格：哈密顿量必须处于对合状态，即它们的泊松括号恒为零，$\\{H,K\\}=0$。\n\n由于我们计算出的泊松括号\n$$\n\\{H,K\\} = -2p_{1}^{2} - p_{2}^{2} - q_{2}^{2} - 3p_{1}q_{2} - q_{1}p_{2}\n$$\n是相空间上的一个非常数函数，并且不恒为零，我们得出结论：函数 $H$ 和 $K$ 不处于对合状态。因此，它们生成的哈密顿流不交换。\n\n问题要求给出 $\\{H,K\\}$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{-2p_{1}^{2} - p_{2}^{2} - q_{2}^{2} - 3p_{1}q_{2} - q_{1}p_{2}}\n$$"
        },
        {
            "introduction": "一旦系统的可积性得到确认，刘维尔-阿诺德定理便保证了作用量-角度变量的存在，它们能极大地简化动力学分析。这个练习将引导你为一个经典的二维谐振子系统完整地构建这些特殊坐标 。你将亲手推导作用量和角度变量，并验证它们之间的正则关系，从而深入理解哈密顿流在不变环面上的线性化过程。",
            "id": "3779727",
            "problem": "考虑相空间 $\\mathbb{R}^{4}$ 上的二维谐振子，其正则坐标为 $(q_{1},q_{2},p_{1},p_{2})$，正则辛形式为 $\\omega_{\\mathrm{can}}=\\mathrm{d}q_{1}\\wedge\\mathrm{d}p_{1}+\\mathrm{d}q_{2}\\wedge\\mathrm{d}p_{2}$。其哈密顿量为\n$$\nH(q,p)=\\frac{1}{2}\\left(p_{1}^{2}+\\omega_{1}^{2}q_{1}^{2}\\right)+\\frac{1}{2}\\left(p_{2}^{2}+\\omega_{2}^{2}q_{2}^{2}\\right),\n$$\n其中 $\\omega_{1}0$ 和 $\\omega_{2}0$ 是两个不同的实频率。从哈密顿力学的基本原理以及 Liouville-Arnold 定理所提供的作用量-角度变量的定义出发，完成以下任务：\n\n1. 通过找出两个独立的、光滑的、全局定义且互相对易的运动积分，证明该系统是完全可积的，并解释 Liouville-Arnold 定理如何应用于该系统的正则能量级。\n\n2. 使用作用量变量定义为沿闭合能量曲线的围道积分，\n$$\nJ_{i}=\\frac{1}{2\\pi}\\oint_{\\gamma_{i}}p_{i}\\,\\mathrm{d}q_{i},\n$$\n推导出作用量 $J_{1}$ 和 $J_{2}$ 关于 $(q_{i},p_{i},\\omega_{i})$ (对于 $i=1,2$) 的显式公式。\n\n3. 构造在 $\\mathbb{R}^{4}\\setminus\\{(q,p):q_{i}=0,\\;p_{i}=0\\text{ for both }i\\}$ 上定义的显式角度变量 $\\theta_{1}(q,p)$ 和 $\\theta_{2}(q,p)$，并通过验证泊松括号关系\n$$\n\\{\\theta_{i},J_{j}\\}=\\delta_{ij},\n$$\n来证明它们与作用量是正则共轭的。其中 $i,j\\in\\{1,2\\}$，泊松括号定义为\n$$\n\\{f,g\\}=\\sum_{k=1}^{2}\\left(\\frac{\\partial f}{\\partial q_{k}}\\frac{\\partial g}{\\partial p_{k}}-\\frac{\\partial f}{\\partial p_{k}}\\frac{\\partial g}{\\partial q_{k}}\\right).\n$$\n\n4. 证明哈密顿流使角度变量分别以速率 $\\omega_{1}$ 和 $\\omega_{2}$ 随时间线性演化，并解释为什么这些角度变量是 $2\\pi$ 周期的。\n\n将最终答案表示为两个角度变量 $\\theta_{1}(q,p)$ 和 $\\theta_{2}(q,p)$ 的显式解析表达式，以弧度为单位，写成一个单行矩阵。不需要数值近似。",
            "solution": "所述问题是哈密顿力学中一个有效且适定的练习。它具有科学依据、内容自洽且客观。我们着手进行解答。\n\n该系统是一个二维谐振子，其哈密顿量定义在具有坐标 $(q_{1},q_{2},p_{1},p_{2})$ 的相空间 $\\mathbb{R}^{4}$ 上。哈密顿量由下式给出：\n$$\nH(q,p)=\\frac{1}{2}\\left(p_{1}^{2}+\\omega_{1}^{2}q_{1}^{2}\\right)+\\frac{1}{2}\\left(p_{2}^{2}+\\omega_{2}^{2}q_{2}^{2}\\right)\n$$\n该哈密顿量是可分离的，意味着它可以写成若干函数的和，每个函数都依赖于一组不相交的正则变量。令 $H_{1}(q_{1},p_{1}) = \\frac{1}{2}(p_{1}^{2}+\\omega_{1}^{2}q_{1}^{2})$ 且 $H_{2}(q_{2},p_{2}) = \\frac{1}{2}(p_{2}^{2}+\\omega_{2}^{2}q_{2}^{2})$。则 $H = H_{1} + H_{2}$。\n\n**1. 完全可积性与 Liouville-Arnold 定理**\n\n一个具有 $n$ 个自由度的哈密顿系统是完全可积的，如果它拥有 $n$ 个独立的、光滑的且互相对易（即对所有 $i,j$ 都有 $\\{F_{i}, F_{j}\\} = 0$）的运动积分 $F_{1}, \\dots, F_{n}$。对我们的系统，$n=2$。\n\n我们提出将 $F_{1} = H_{1}$ 和 $F_{2} = H_{2}$ 作为两个运动积分。\n首先，我们验证它们是运动积分，即它们在 $H$ 的流下是守恒的。这意味着 $\\{H_{1}, H\\}=0$ 且 $\\{H_{2}, H\\}=0$。\n泊松括号定义为 $\\{f,g\\}=\\sum_{k=1}^{2}\\left(\\frac{\\partial f}{\\partial q_{k}}\\frac{\\partial g}{\\partial p_{k}}-\\frac{\\partial f}{\\partial p_{k}}\\frac{\\partial g}{\\partial q_{k}}\\right)$。\n我们来计算 $\\{H_{1}, H\\} = \\{H_{1}, H_{1} + H_{2}\\} = \\{H_{1}, H_{1}\\} + \\{H_{1}, H_{2}\\}$。\n括号 $\\{H_1, H_1\\}$ 平凡地为 $0$。\n对于 $\\{H_{1}, H_{2}\\}$：\n$$\n\\{H_{1}, H_{2}\\} = \\frac{\\partial H_{1}}{\\partial q_{1}}\\frac{\\partial H_{2}}{\\partial p_{1}} - \\frac{\\partial H_{1}}{\\partial p_{1}}\\frac{\\partial H_{2}}{\\partial q_{1}} + \\frac{\\partial H_{1}}{\\partial q_{2}}\\frac{\\partial H_{2}}{\\partial p_{2}} - \\frac{\\partial H_{1}}{\\partial p_{2}}\\frac{\\partial H_{2}}{\\partial q_{2}}\n$$\n由于 $H_{1}$ 只依赖于 $(q_{1}, p_{1})$ 且 $H_{2}$ 只依赖于 $(q_{2}, p_{2})$，因此 $H_{1}$ 对 $q_{2}, p_{2}$ 的所有偏导数均为零，而 $H_{2}$ 对 $q_{1}, p_{1}$ 的所有偏导数也均为零。因此，求和中的每一项都为零，且 $\\{H_{1}, H_{2}\\} = 0$。\n由此得出 $\\{H_{1}, H\\} = 0$。类似的计算表明 $\\{H_{2}, H\\} = \\{H_{2}, H_{1} + H_{2}\\} = \\{H_{2}, H_{1}\\} + \\{H_{2}, H_{2}\\} = -\\{H_{1}, H_{2}\\} + 0 = 0$。\n所以，$H_{1}$ 和 $H_{2}$ 确实是运动积分。它们是 $\\mathbb{R}^{4}$ 上的光滑、全局定义的函数。\n\n接下来，我们检查独立性。它们的梯度（微分形式）为 $\\mathrm{d}H_{1} = \\omega_{1}^{2}q_{1}\\mathrm{d}q_{1} + p_{1}\\mathrm{d}p_{1}$ 和 $\\mathrm{d}H_{2} = \\omega_{2}^{2}q_{2}\\mathrm{d}q_{2} + p_{2}\\mathrm{d}p_{2}$。这些 1-形式在任何地方都是线性无关的，除非其中一个或两个为零，这种情况只发生在子空间 $(q_{1}, p_{1}) = (0,0)$ 或 $(q_{2}, p_{2}) = (0,0)$ 上。因此，它们几乎处处独立。\n\n因为我们找到了 $n=2$ 个互相对易的独立运动积分 $(H_{1}, H_{2})$，所以该系统是完全可积的。\n\nLiouville-Arnold 定理适用于这些积分的正则水平集。对于常数 $E_{1}0$ 和 $E_{2}0$，水平集 $M_{E_{1},E_{2}} = \\{(q,p)\\in\\mathbb{R}^{4} | H_{1}=E_{1}, H_{2}=E_{2}\\}$ 是一个紧致流形。方程 $H_{i}=E_{i}$ 在 $(q_{i}, p_{i})$ 相平面中拓扑地定义了一个圆。水平集 $M_{E_{1},E_{2}}$ 是这两个圆的笛卡尔积 $S^{1} \\times S^{1}$，即一个 2-维环面 $\\mathbb{T}^{2}$。该定理断言，存在一个到作用量-角度坐标 $(J_{1}, J_{2}, \\theta_{1}, \\theta_{2})$ 的正则变换，使得在这些坐标下表示的哈密顿量只依赖于作用量，$H=H(J_{1}, J_{2})$，并且哈密顿流在环面上是线性的。\n\n**2. 作用量变量的推导**\n\n作用量变量由 $J_{i} = \\frac{1}{2\\pi}\\oint_{\\gamma_{i}}p_{i}\\,\\mathrm{d}q_{i}$ 定义。积分路径 $\\gamma_{i}$ 是由 $H_{i} = E_{i} = \\text{常数}$ 在 $(q_{i}, p_{i})$ 平面中定义的闭合曲线。\n方程 $H_{i}=\\frac{1}{2}(p_{i}^{2}+\\omega_{i}^{2}q_{i}^{2})=E_{i}$ 可以写作：\n$$\n\\frac{q_{i}^{2}}{(\\sqrt{2E_{i}}/\\omega_{i})^{2}} + \\frac{p_{i}^{2}}{(\\sqrt{2E_{i}})^{2}} = 1\n$$\n这是 $(q_{i}, p_{i})$ 平面中一个椭圆的方程，其半轴为 $a = \\frac{\\sqrt{2E_{i}}}{\\omega_{i}}$ 和 $b = \\sqrt{2E_{i}}$。\n积分 $\\oint_{\\gamma_{i}}p_{i}\\,\\mathrm{d}q_{i}$ 代表此椭圆所围成的面积。椭圆的面积是 $\\pi a b$。\n面积 $= \\pi \\left(\\frac{\\sqrt{2E_{i}}}{\\omega_{i}}\\right) (\\sqrt{2E_{i}}) = \\frac{2\\pi E_{i}}{\\omega_{i}}$。\n将此代入作用量变量的定义中：\n$$\nJ_{i} = \\frac{1}{2\\pi} \\left(\\frac{2\\pi E_{i}}{\\omega_{i}}\\right) = \\frac{E_{i}}{\\omega_{i}}\n$$\n由于 $E_{i}$ 是函数 $H_{i}$ 的值，我们可以将作用量变量表示为相空间上的一个函数：\n$$\nJ_{i}(q_{i}, p_{i}) = \\frac{H_{i}}{\\omega_{i}} = \\frac{1}{2\\omega_{i}}(p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2})\n$$\n所以我们有 $J_{1} = \\frac{1}{2\\omega_{1}}(p_{1}^{2} + \\omega_{1}^{2}q_{1}^{2})$ 和 $J_{2} = \\frac{1}{2\\omega_{2}}(p_{2}^{2} + \\omega_{2}^{2}q_{2}^{2})$。\n\n**3. 角度变量的构造与正则共轭性**\n\n我们寻找与 $J_{1}$ 和 $J_{2}$ 正则共轭的角度变量 $\\theta_{1}$ 和 $\\theta_{2}$。找到它们的一个标准方法是提出一个能将哈密顿量化为所需形式的正则变换。考虑对每个子系统的变换：\n$$\nq_{i} = \\sqrt{\\frac{2J_{i}}{\\omega_{i}}}\\sin\\theta_{i}, \\quad p_{i} = \\sqrt{2J_{i}\\omega_{i}}\\cos\\theta_{i}\n$$\n将这些代入 $H_{i}$ 得到 $H_{i} = \\frac{1}{2}\\left( (2J_{i}\\omega_{i}\\cos^{2}\\theta_{i}) + \\omega_{i}^{2}\\left(\\frac{2J_{i}}{\\omega_{i}}\\sin^{2}\\theta_{i}\\right) \\right) = J_{i}\\omega_{i}(\\cos^{2}\\theta_{i} + \\sin^{2}\\theta_{i}) = J_{i}\\omega_{i}$。这证实了 $H_{i}$ 只依赖于 $J_{i}$。\n\n为了找到用 $(q_i, p_i)$ 表示的 $\\theta_i$，我们对变换求逆：\n$$\n\\sin\\theta_{i} = \\frac{q_{i}}{\\sqrt{2J_{i}/\\omega_{i}}} = \\frac{q_{i}\\sqrt{\\omega_{i}}}{\\sqrt{2J_{i}\\omega_{i}}}, \\quad \\cos\\theta_{i} = \\frac{p_{i}}{\\sqrt{2J_{i}\\omega_{i}}}\n$$\n取其比值可得：\n$$\n\\tan\\theta_{i} = \\frac{\\sin\\theta_{i}}{\\cos\\theta_{i}} = \\frac{q_{i}\\sqrt{\\omega_{i}}}{p_{i}}\n$$\n这意味着角度变量 $\\theta_{i}$ 由下式给出：\n$$\n\\theta_{i}(q_{i}, p_{i}) = \\arctan\\left(\\frac{\\omega_{i} q_{i}}{p_{i}}\\right)\n$$\n此处意指使用双参数反正切函数，以正确确定 $(p_{i}, \\omega_{i}q_{i})$ 平面所有四个象限中的角度，从而使其在 $\\mathbb{R}^2 \\setminus \\{(0,0)\\}$ 上是良定义的。\n\n为验证 $(\\theta_i, J_j)$ 是正则坐标，我们必须证明 $\\{\\theta_{i}, J_{j}\\} = \\delta_{ij}$。\n由于 $\\theta_{i}$ 只依赖于 $(q_{i},p_{i})$ 且 $J_{j}$ 只依赖于 $(q_{j},p_{j})$，对于 $i \\neq j$，泊松括号 $\\{\\theta_{i}, J_{j}\\}$ 平凡地为 0。\n我们需要计算 $\\{\\theta_{i}, J_{i}\\}$：\n我们有 $J_{i} = \\frac{1}{2\\omega_{i}}(p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2})$ 的偏导数：\n$\\frac{\\partial J_{i}}{\\partial q_{i}} = \\omega_{i} q_{i}$\n$\\frac{\\partial J_{i}}{\\partial p_{i}} = \\frac{p_{i}}{\\omega_{i}}$\n以及 $\\theta_{i} = \\arctan(\\omega_{i}q_{i}/p_{i})$ 的偏导数：\n$\\frac{\\partial \\theta_{i}}{\\partial q_{i}} = \\frac{1}{1 + (\\omega_{i}q_{i}/p_{i})^{2}} \\cdot \\frac{\\omega_{i}}{p_{i}} = \\frac{p_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} \\cdot \\frac{\\omega_{i}}{p_{i}} = \\frac{\\omega_{i} p_{i}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}$\n$\\frac{\\partial \\theta_{i}}{\\partial p_{i}} = \\frac{1}{1 + (\\omega_{i}q_{i}/p_{i})^{2}} \\cdot \\left(-\\frac{\\omega_{i}q_{i}}{p_{i}^{2}}\\right) = \\frac{p_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} \\cdot \\left(-\\frac{\\omega_{i}q_{i}}{p_{i}^{2}}\\right) = \\frac{-\\omega_{i} q_{i}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}$\n现在计算泊松括号：\n$$\n\\{\\theta_{i}, J_{i}\\} = \\frac{\\partial \\theta_{i}}{\\partial q_{i}}\\frac{\\partial J_{i}}{\\partial p_{i}} - \\frac{\\partial \\theta_{i}}{\\partial p_{i}}\\frac{\\partial J_{i}}{\\partial q_{i}}\n$$\n$$\n\\{\\theta_{i}, J_{i}\\} = \\left(\\frac{\\omega_{i} p_{i}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}\\right)\\left(\\frac{p_{i}}{\\omega_{i}}\\right) - \\left(\\frac{-\\omega_{i} q_{i}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}\\right)(\\omega_{i} q_{i})\n$$\n$$\n\\{\\theta_{i}, J_{i}\\} = \\frac{p_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} + \\frac{\\omega_{i}^{2} q_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} = \\frac{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} = 1\n$$\n因此，我们证实了 $\\{\\theta_{i}, J_{j}\\} = \\delta_{ij}$。\n\n**4. 哈密顿流与角度变量的周期性**\n\n在作用量-角度坐标下，哈密顿量为 $H = H_{1} + H_{2} = \\omega_{1}J_{1} + \\omega_{2}J_{2}$。\n角度变量的运动方程由哈密顿方程给出：\n$$\n\\dot{\\theta}_{i} = \\{\\theta_{i}, H\\} = \\{\\theta_{i}, \\omega_1 J_1 + \\omega_2 J_2\\} = \\omega_1 \\{\\theta_i, J_1\\} + \\omega_2 \\{\\theta_i, J_2\\}\n$$\n使用正则关系 $\\{\\theta_{i}, J_{j}\\} = \\delta_{ij}$：\n对于 $i=1$：$\\dot{\\theta}_{1} = \\omega_{1}\\{\\theta_{1}, J_{1}\\} + \\omega_{2}\\{\\theta_{1}, J_{2}\\} = \\omega_{1}(1) + \\omega_{2}(0) = \\omega_{1}$。\n对于 $i=2$：$\\dot{\\theta}_{2} = \\omega_{1}\\{\\theta_{2}, J_{1}\\} + \\omega_{2}\\{\\theta_{2}, J_{2}\\} = \\omega_{1}(0) + \\omega_{2}(1) = \\omega_{2}$。\n这表明角度变量随时间线性演化：$\\theta_{i}(t) = \\omega_{i}t + \\theta_{i}(0)$。角度变量的频率就是振子的频率。\n\n角度变量 $\\theta_{i}$ 是 $2\\pi$ 周期的，这有两个基本原因。\n首先，从 Liouville-Arnold 定理的角度来看，角度变量是不变环面 $\\mathbb{T}^{2}$ 上的坐标。一个环面在拓扑上是圆的乘积，即 $\\mathbb{T}^{2} = S^{1} \\times S^{1}$。圆上的坐标天然是周期的。按照惯例，这个周期取为 $2\\pi$。\n其次，我们可以从原始坐标看出这一点。每个子系统 $(q_{i}, p_{i})$ 的运动由 $H_{i}$ 的哈密顿方程所支配：\n$\\dot{q}_{i} = \\{q_{i}, H_{i}\\} = \\partial H_{i}/\\partial p_{i} = p_{i}$\n$\\dot{p}_{i} = \\{p_{i}, H_{i}\\} = -\\partial H_{i}/\\partial q_{i} = -\\omega_{i}^{2}q_{i}$\n这给出了简谐振子的运动方程：$\\ddot{q}_{i} + \\omega_{i}^{2}q_{i} = 0$。其解是周期的，周期为 $T_{i} = 2\\pi/\\omega_{i}$。在一个周期内，相点 $(q_{i}(t), p_{i}(t))$ 描绘出一条完整的椭圆并回到其起始点。在这段时间 $T_{i}$ 内，相应的角度变量 $\\theta_{i}(t) = \\omega_{i}t + \\theta_{i}(0)$ 变化了 $\\Delta\\theta_{i} = \\omega_{i}T_{i} = \\omega_{i}(2\\pi/\\omega_{i}) = 2\\pi$。由于当 $\\theta_{i}$ 变化了 $2\\pi$ 后子系统的物理状态是相同的，因此角度变量是一个 $2\\pi$ 周期的坐标。\n\n因此，角度变量的显式解析表达式为：\n$\\theta_{1}(q,p) = \\arctan\\left(\\frac{\\omega_{1} q_{1}}{p_{1}}\\right)$\n$\\theta_{2}(q,p) = \\arctan\\left(\\frac{\\omega_{2} q_{2}}{p_{2}}\\right)$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\arctan\\left(\\frac{\\omega_{1} q_{1}}{p_{1}}\\right)  \\arctan\\left(\\frac{\\omega_{2} q_{2}}{p_{2}}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "作用量-角度变量的威力远不止于处理简单的二次型哈密顿系统。本练习将挑战一个更复杂的非线性系统：单摆 。你将为单摆的振动模式计算作用量，这个过程会自然地引出椭圆积分，这是研究真实世界可积系统时经常遇到的数学工具，展现了该理论框架的深刻性与实用性。",
            "id": "3779755",
            "problem": "考虑圆余切丛 $T^{\\ast}S^{1}$ 上的一个哈密顿系统，其正则坐标为 $(\\theta,p)$。该系统描述了一个长度为 $l$、质量为 $m$ 的简单平面摆在大小为 $g$ 的均匀引力场中的运动，其哈密顿量为\n$$\nH(\\theta,p)=\\frac{p^{2}}{2 m l^{2}}+m g l\\bigl(1-\\cos\\theta\\bigr).\n$$\n关注振荡区，即在满足 $0\\mathcal{E}2 m g l$ 的固定能级 $\\mathcal{E}$ 上。在此区域中，能级集是一个紧致的一维不变环面，根据 Liouville–Arnold 定理，存在适应于此不变环面的作用量-角变量 $(I,\\alpha)$。\n\n从以下基本定义出发\n- 作用量 $I(\\mathcal{E})$ 定义为能量为 $\\mathcal{E}$ 的闭合轨道上的归一化辛面积，\n$$\nI(\\mathcal{E})=\\frac{1}{2\\pi}\\oint_{\\gamma_{\\mathcal{E}}} p\\, d\\theta,\n$$\n- 角变量通过第一类生成函数 $W(\\theta,I)$ 定义为 $\\alpha(\\theta;I)=\\frac{\\partial W}{\\partial I}(\\theta,I)$，其中 $W(\\theta,I)=\\int_{0}^{\\theta} p(\\theta';I)\\, d\\theta'$，\n推导作用量 $I(\\mathcal{E})$ 的一个闭合形式的显式表达式。您的推导必须从这些定义和哈密顿方程出发，并且在科学上是自洽的。您可以通过关系式 $\\mathcal{E}=2 m g l\\, k^{2}$ 引入振幅参数 $k\\in(0,1)$，并可以用标准的第一类和第二类完全椭圆积分来表示您的最终结果，\n$$\n\\mathrm{K}(k)=\\int_{0}^{\\pi/2}\\frac{d\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}},\\qquad\n\\mathrm{E}(k)=\\int_{0}^{\\pi/2}\\sqrt{1-k^{2}\\sin^{2}\\varphi}\\, d\\varphi.\n$$\n如果愿意，您也可以使用不完全椭圆积分来表示振荡轨道上相应的正则角变量 $\\alpha$，并证明它以由轨道周期决定的频率随时间均匀演进，但您必须报告的唯一最终答案是 $I(\\mathcal{E})$ 以 $m$、$l$、$g$ 和完全椭圆积分表示的显式解析表达式。\n\n请以单个闭合形式的解析表达式提供您的最终答案。不要进行任何数值计算或四舍五入。",
            "solution": "该系统有一个自由度并且是可积的。在振荡区中，对于固定的能量 $\\mathcal{E}\\in(0,2 m g l)$，转折点 $\\pm\\theta_{0}$ 满足\n$$\n\\mathcal{E}=m g l\\bigl(1-\\cos\\theta_{0}\\bigr)=2 m g l\\,\\sin^{2}\\!\\left(\\frac{\\theta_{0}}{2}\\right).\n$$\n引入模 $k\\in(0,1)$，由下式定义\n$$\nk=\\sin\\!\\left(\\frac{\\theta_{0}}{2}\\right),\\qquad \\text{则有}\\quad \\mathcal{E}=2 m g l\\, k^{2}.\n$$\n在能级 $H=\\mathcal{E}$ 上，动量由下式确定\n$$\n\\frac{p^{2}}{2 m l^{2}}=\\mathcal{E}-m g l\\bigl(1-\\cos\\theta\\bigr)=m g l\\bigl(\\cos\\theta-\\cos\\theta_{0}\\bigr).\n$$\n使用 $\\cos\\theta-\\cos\\theta_{0}=2\\bigl(\\sin^{2}(\\theta_{0}/2)-\\sin^{2}(\\theta/2)\\bigr)=2\\bigl(k^{2}-\\sin^{2}(\\theta/2)\\bigr)$，我们得到\n$$\np(\\theta;\\mathcal{E})=\\pm\\sqrt{2 m l^{2}\\cdot 2 m g l\\bigl(k^{2}-\\sin^{2}(\\theta/2)\\bigr)}=2 m l\\sqrt{g l}\\,\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}.\n$$\n根据定义，作用量为\n$$\nI(\\mathcal{E})=\\frac{1}{2\\pi}\\oint_{\\gamma_{\\mathcal{E}}} p\\, d\\theta=\\frac{2}{\\pi}\\int_{0}^{\\theta_{0}} p(\\theta;\\mathcal{E})\\, d\\theta=\\frac{4 m l\\sqrt{g l}}{\\pi}\\int_{0}^{\\theta_{0}}\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}\\, d\\theta,\n$$\n其中我们利用对称性将闭路积分写为从 $0$ 到 $\\theta_{0}$ 积分的四倍，再除以 $2\\pi$。\n\n为了计算该积分，使用换元法 $\\sin(\\theta/2)=k\\sin\\varphi$，其中 $\\varphi\\in[0,\\pi/2]$。则 $d\\theta=\\dfrac{2 k\\cos\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi$ 并且\n$$\n\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}=k\\sqrt{1-\\sin^{2}\\varphi}=k\\cos\\varphi.\n$$\n因此\n$$\n\\int_{0}^{\\theta_{0}}\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}\\, d\\theta\n=\\int_{0}^{\\pi/2} k\\cos\\varphi\\cdot \\frac{2 k\\cos\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi\n=2 k^{2}\\int_{0}^{\\pi/2}\\frac{\\cos^{2}\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi.\n$$\n分解 $\\cos^{2}\\varphi=1-\\sin^{2}\\varphi$ 并使用标准的完全椭圆积分：\n$$\n\\mathrm{K}(k)=\\int_{0}^{\\pi/2}\\frac{d\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}},\\qquad\n\\int_{0}^{\\pi/2}\\sqrt{1-k^{2}\\sin^{2}\\varphi}\\, d\\varphi=\\mathrm{E}(k).\n$$\n一个标准的恒等式可从下式得出\n$$\n\\int_{0}^{\\pi/2}\\frac{1-k^{2}\\sin^{2}\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi=\\mathrm{E}(k)\n\\quad\\Longrightarrow\\quad\nk^{2}\\int_{0}^{\\pi/2}\\frac{\\sin^{2}\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi=\\mathrm{K}(k)-\\mathrm{E}(k).\n$$\n因此，\n$$\n\\int_{0}^{\\pi/2}\\frac{\\cos^{2}\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi\n=\\mathrm{K}(k)-\\frac{\\mathrm{K}(k)-\\mathrm{E}(k)}{k^{2}}\n=\\frac{\\mathrm{E}(k)-(1-k^{2})\\,\\mathrm{K}(k)}{k^{2}}.\n$$\n代回后，我们发现\n$$\n\\int_{0}^{\\theta_{0}}\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}\\, d\\theta\n=2\\bigl[\\mathrm{E}(k)-(1-k^{2})\\,\\mathrm{K}(k)\\bigr].\n$$\n因此，作用量为\n$$\nI(\\mathcal{E})=\\frac{4 m l\\sqrt{g l}}{\\pi}\\cdot 2\\bigl[\\mathrm{E}(k)-(1-k^{2})\\,\\mathrm{K}(k)\\bigr]\n=\\frac{8 m l\\sqrt{g l}}{\\pi}\\,\\Bigl[\\mathrm{E}(k)-(1-k^{2})\\,\\mathrm{K}(k)\\Bigr],\n$$\n其中 $k=\\sqrt{\\mathcal{E}/(2 m g l)}$。\n\n为完整起见，我们指出一个相容的角变量及其均匀演进。哈密顿方程给出 $\\dot{\\theta}=\\partial H/\\partial p=p/(m l^{2})=2\\sqrt{g/l}\\,\\sqrt{k^{2}-\\sin^{2}(\\theta/2)}$。因此\n$$\n\\frac{d t}{d\\theta}=\\frac{1}{\\dot{\\theta}}=\\frac{1}{2}\\sqrt{\\frac{l}{g}}\\,\\frac{1}{\\sqrt{k^{2}-\\sin^{2}(\\theta/2)}}.\n$$\n四分之一周期是\n$$\n\\frac{T(\\mathcal{E})}{4}=\\int_{0}^{\\theta_{0}}\\frac{dt}{d\\theta}\\, d\\theta=\\sqrt{\\frac{l}{g}}\\int_{0}^{\\pi/2}\\frac{d\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}=\\sqrt{\\frac{l}{g}}\\,\\mathrm{K}(k),\n$$\n所以全周期为 $T(\\mathcal{E})=4\\sqrt{l/g}\\,\\mathrm{K}(k)$，频率为 $\\omega(\\mathcal{E})=2\\pi/T(\\mathcal{E})=\\pi\\bigl(2\\sqrt{l/g}\\,\\mathrm{K}(k)\\bigr)^{-1}$。沿递增分支的一个方便的正则角变量是\n$$\n\\alpha(\\theta;\\mathcal{E})=\\frac{\\pi}{\\mathrm{K}(k)}\\,\\mathrm{F}\\!\\left(\\arcsin\\!\\left(\\frac{\\sin(\\theta/2)}{k}\\right)\\!,\\,k\\right)\\quad\\text{mod }2\\pi,\n$$\n其中 $\\mathrm{F}(\\cdot,k)$ 是第一类不完全椭圆积分；那么沿轨道有 $\\dot{\\alpha}=\\omega(\\mathcal{E})$，这与 Liouville–Arnold 定理一致。所要求的最终量是上面给出的闭合形式的作用量 $I(\\mathcal{E})$。",
            "answer": "$$\\boxed{\\frac{8 m l \\sqrt{g l}}{\\pi}\\left[\\mathrm{E}\\!\\left(\\sqrt{\\frac{\\mathcal{E}}{2 m g l}}\\right)-\\left(1-\\frac{\\mathcal{E}}{2 m g l}\\right)\\mathrm{K}\\!\\left(\\sqrt{\\frac{\\mathcal{E}}{2 m g l}}\\right)\\right]}$$"
        }
    ]
}