{
    "hands_on_practices": [
        {
            "introduction": "简谐振子是理解作用量变量的经典入门范例。该练习将引导您计算单自由度系统的作用量变量 $I(E)$，直观地展示其与相空间中等能级曲线所围面积的直接关系。这项基本计算为掌握刘维尔-阿诺德定理的几何核心提供了坚实的基础。",
            "id": "3779732",
            "problem": "考虑余切丛 $T^{\\ast}\\mathbb{R}$ 上的一个单自由度哈密顿系统，其正则坐标为 $(q,p)$，正则辛形式为 $\\omega=\\mathrm{d}q\\wedge\\mathrm{d}p$。设 $H(q,p)$ 是一个光滑的哈密顿量，使得对于每个固定的能量 $E>0$，能级 $\\{(q,p)\\mid H(q,p)=E\\}$ 是一条紧致、正则、连通的曲线，且哈密顿流会周期性地遍历该曲线。Liouville-Arnold 定理断言，在每个这样的不变环面（在单自由度情形下，不变环面是一个圆）的邻域中存在作用量-角坐标。相关的作​​用量 $I(E)$ 由以下积分定义：\n$$\nI(E)=\\frac{1}{2\\pi}\\oint_{\\gamma_{E}} p\\,\\mathrm{d}q,\n$$\n其中 $\\gamma_{E}$ 表示能量为 $E$ 的周期轨道，积分是沿哈密顿流诱导的定向在一个完整周期上进行的。从哈密顿动力学、正则辛形式和能级正则性的定义出发，仔细论证在该单自由度设置下，$I(E)$ 是良定的且仅依赖于 $E$。然后，对于谐振子哈密顿量\n$$\nH(q,p)=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega^{2}q^{2},\n$$\n（其中参数 $m>0$ 和 $\\omega>0$），计算作用量 $I(E)$，结果表示为关于 $E$、$m$ 和 $\\omega$ 的闭式解析表达式。你的最终答案必须是单个解析表达式。不需要四舍五入，最终表达式中不应包含单位。",
            "solution": "这个问题是良置的且科学上合理，它建立在哈密顿力学的标准框架内。问题要求对作用量的性质进行论证，并对谐振子进行具体计算。\n\n任务的第一部分是论证定义为\n$$\nI(E) = \\frac{1}{2\\pi}\\oint_{\\gamma_{E}} p\\,\\mathrm{d}q,\n$$\n的作用量是良定的，并且只依赖于能量 $E$。\n\n该积分是一形式 $\\theta = p\\,\\mathrm{d}q$ 在路径 $\\gamma_E$ 上的线积分。路径 $\\gamma_E$ 是哈密顿量的水平集，即 $\\{(q,p) \\in T^{\\ast}\\mathbb{R} \\mid H(q,p)=E\\}$。问题陈述断言，对于给定的 $E > 0$，该水平集是一条紧致、正则且连通的曲线。在二维相空间 $(q,p)$ 中，这意味着 $\\gamma_E$ 是一条简单闭合曲线。积分是在一个完整周期上进行的，意味着我们恰好绕这条闭合曲线积分一次。积分的定向被指定为由哈密顿流诱导的定向。由于积分路径是一条良定的闭合曲线，线积分 $\\oint_{\\gamma_{E}} p\\,\\mathrm{d}q$ 是良定的。\n\n为证明 $I(E)$ 仅依赖于 $E$，我们观察到积分路径 $\\gamma_E$ 完全由能量值 $E$ 定义。由于线积分的值仅取决于被积的一形式（$p\\,\\mathrm{d}q$）和积分路径（$\\gamma_E$），且该一形式是固定的，所以积分值是路径的函数。因为路径由 $E$ 决定，所以积分值，也即 $I(E)$，必然是只关于 $E$ 的函数。\n\n可以使用斯托克斯定理（或其二维特例格林公式）提供一个更几何的论证。该定理指出，一形式 $\\theta = p\\,\\mathrm{d}q$ 沿闭合路径 $\\gamma_E$ 的线积分等于其外微分 $\\mathrm{d}\\theta = \\mathrm{d}p \\wedge \\mathrm{d}q$ 在路径所包围区域 $D_E$ 上的面积分。标准惯例中，路径积分沿逆时针（CCW）方向，面积元为 $\\mathrm{d}A = \\mathrm{d}q \\wedge \\mathrm{d}p$。于是有：\n$$ \\oint_{\\gamma_E, \\text{CCW}} p\\,\\mathrm{d}q = \\iint_{D_E} \\mathrm{d}p \\wedge \\mathrm{d}q = \\iint_{D_E} -(\\mathrm{d}q \\wedge \\mathrm{d}p) = -\\text{Area}(D_E) $$\n作用量的定义要求积分路径 $\\gamma_E$ 是哈密顿流指定的物理轨道。对于谐振子，哈密顿方程 $\\dot{q} = \\partial H / \\partial p = p/m$ 和 $\\dot{p} = - \\partial H / \\partial q = -m\\omega^2q$ 产生的流是顺时针（CW）方向的。因此，沿物理轨道的积分等于该区域的几何面积：\n$$ \\oint_{\\gamma_E, \\text{flow}} p\\,\\mathrm{d}q = \\oint_{\\gamma_E, \\text{CW}} p\\,\\mathrm{d}q = - \\oint_{\\gamma_E, \\text{CCW}} p\\,\\mathrm{d}q = -(-\\text{Area}(D_E)) = \\text{Area}(D_E) $$\n由于由 $H(q,p) \\le E$ 定义的区域 $D_E$ 的面积显然只依赖于 $E$，所以 $I(E) = \\frac{1}{2\\pi}\\text{Area}(D_E)$ 是一个良定的、只关于 $E$ 的函数。\n\n任务的第二部分是计算谐振子哈密顿量的 $I(E)$：\n$$\nH(q,p) = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2.\n$$\n能级曲线 $\\gamma_E$ 由方程 $H(q,p) = E$ 给出，其中 $E > 0$：\n$$\n\\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2 = E.\n$$\n这个方程可以改写成椭圆的标准形式 $\\frac{x^2}{a^2} + \\frac{y^2}{b^2} = 1$：\n$$\n\\frac{q^2}{2E / (m\\omega^2)} + \\frac{p^2}{2mE} = 1.\n$$\n这是 $(q,p)$ 相平面中一个以原点为中心的椭圆。其半轴为：\n$$\na_q = \\sqrt{\\frac{2E}{m\\omega^2}} = \\frac{\\sqrt{2E}}{\\omega\\sqrt{m}}\n$$\n$$\na_p = \\sqrt{2mE}.\n$$\n如前所述，积分 $\\oint_{\\gamma_E} p\\,\\mathrm{d}q$ 等于椭圆 $\\gamma_E$ 所包围的区域 $D_E$ 的面积。半轴为 $a_q$ 和 $a_p$ 的椭圆面积由 $\\pi a_q a_p$ 给出。\n计算此面积：\n$$\n\\text{Area}(D_E) = \\pi \\left(\\frac{\\sqrt{2E}}{\\omega\\sqrt{m}}\\right) (\\sqrt{2mE}) = \\pi \\frac{\\sqrt{2E}\\sqrt{2mE}}{\\omega\\sqrt{m}} = \\pi \\frac{\\sqrt{4mE^2}}{\\omega\\sqrt{m}} = \\pi \\frac{2E\\sqrt{m}}{\\omega\\sqrt{m}} = \\frac{2\\pi E}{\\omega}.\n$$\n作用量 $I(E)$ 定义为此面积除以 $2\\pi$：\n$$\nI(E) = \\frac{1}{2\\pi} \\text{Area}(D_E) = \\frac{1}{2\\pi} \\left( \\frac{2\\pi E}{\\omega} \\right).\n$$\n$$\nI(E) = \\frac{E}{\\omega}.\n$$\n此表达式给出了谐振子的作用量，它是能量 $E$ 和系统参数 $\\omega$ 的函数。参数 $m$ 在作用量的最终表达式中被消掉了。这是一个特征性结果；作用量 $I$ 通过周期运动的频率 $\\omega$ 与能量 $E$ 相关联，而对于谐振子来说，频率与振幅无关。\n我们可以用作用量来表示能量：$E = I\\omega$。这是量子化背景下的一个基础性结果，在量子化中，将 $I$ 提升为算符后，其本征值是量子化的，从而导致量子化的能级。",
            "answer": "$$\n\\boxed{\\frac{E}{\\omega}}\n$$"
        },
        {
            "introduction": "在单维情况的基础上，我们现在探索一个具有多自由度的系统：二维谐振子。这个实践至关重要，因为它展示了刘维尔-阿诺德定理所概述的完整过程，从证明可积性到显式构造作用量变量 $J_i$ 及其共轭角变量 $\\theta_i$。完成此练习后，您将为不变环面构建出一套完整的作用量-角变量坐标系。",
            "id": "3779727",
            "problem": "考虑相空间 $\\mathbb{R}^{4}$ 上的二维谐振子，其具有正则坐标 $(q_{1},q_{2},p_{1},p_{2})$ 和正则辛形式 $\\omega_{\\mathrm{can}}=\\mathrm{d}q_{1}\\wedge\\mathrm{d}p_{1}+\\mathrm{d}q_{2}\\wedge\\mathrm{d}p_{2}$。其哈密顿量为\n$$\nH(q,p)=\\frac{1}{2}\\left(p_{1}^{2}+\\omega_{1}^{2}q_{1}^{2}\\right)+\\frac{1}{2}\\left(p_{2}^{2}+\\omega_{2}^{2}q_{2}^{2}\\right),\n$$\n其中 $\\omega_{1}>0$ 和 $\\omega_{2}>0$ 是两个不相等的实频率。从哈密顿力学的第一性原理以及由 Liouville-Arnold 定理提供的作用量-角度变量的定义出发，完成以下任务：\n\n1. 通过找出两个独立的、光滑的、全局定义的且对合的运动积分，证明该系统是完全可积的，并解释 Liouville-Arnold 定理如何应用于该系统的正则能量能级。\n\n2. 使用作用量变量定义为闭合能量曲线上的围道积分，\n$$\nJ_{i}=\\frac{1}{2\\pi}\\oint_{\\gamma_{i}}p_{i}\\,\\mathrm{d}q_{i},\n$$\n推导出作用量 $J_{1}$ 和 $J_{2}$ 关于 $(q_{i},p_{i},\\omega_{i})$（对于 $i=1,2$）的显式公式。\n\n3. 构造定义在 $\\mathbb{R}^{4}\\setminus\\{(q,p):q_{i}=0,\\;p_{i}=0\\text{ for both }i\\}$ 上的显式角度变量 $\\theta_{1}(q,p)$ 和 $\\theta_{2}(q,p)$，并通过验证泊松括号关系\n$$\n\\{\\theta_{i},J_{j}\\}=\\delta_{ij},\n$$\n来证明它们与作用量是正则共轭的（对于 $i,j\\in\\{1,2\\}$），其中泊松括号定义为\n$$\n\\{f,g\\}=\\sum_{k=1}^{2}\\left(\\frac{\\partial f}{\\partial q_{k}}\\frac{\\partial g}{\\partial p_{k}}-\\frac{\\partial f}{\\partial p_{k}}\\frac{\\partial g}{\\partial q_{k}}\\right).\n$$\n\n4. 证明哈密顿流使角度变量随时间线性演化，其变化率分别为 $\\omega_{1}$ 和 $\\omega_{2}$，并解释为什么这些角度变量是 $2\\pi$ 周期的。\n\n将最终答案表示为两个角度变量 $\\theta_{1}(q,p)$ 和 $\\theta_{2}(q,p)$ 的显式解析表达式（以弧度为单位），写成一个单行矩阵。不需要数值近似。",
            "solution": "所述问题是哈密顿力学中一个有效且适定的练习。它具有科学依据、自洽且客观。我们开始解答。\n\n该系统是一个二维谐振子，其哈密顿量定义在具有坐标 $(q_{1},q_{2},p_{1},p_{2})$ 的相空间 $\\mathbb{R}^{4}$ 上。哈密顿量由下式给出：\n$$\nH(q,p)=\\frac{1}{2}\\left(p_{1}^{2}+\\omega_{1}^{2}q_{1}^{2}\\right)+\\frac{1}{2}\\left(p_{2}^{2}+\\omega_{2}^{2}q_{2}^{2}\\right)\n$$\n该哈密顿量是可分离的，意味着它可以写成若干函数的和，每个函数都依赖于一组不相交的正则变量。令 $H_{1}(q_{1},p_{1}) = \\frac{1}{2}(p_{1}^{2}+\\omega_{1}^{2}q_{1}^{2})$ 和 $H_{2}(q_{2},p_{2}) = \\frac{1}{2}(p_{2}^{2}+\\omega_{2}^{2}q_{2}^{2})$。则 $H = H_{1} + H_{2}$。\n\n**1. 完全可积性与 Liouville-Arnold 定理**\n\n一个具有 $n$ 个自由度的哈密顿系统是完全可积的，如果它拥有 $n$ 个独立的、光滑的且相互对合的运动积分 $F_{1}, \\dots, F_{n}$，即对所有 $i,j$ 都有 $\\{F_{i}, F_{j}\\} = 0$。对于我们的系统，$n=2$。\n\n我们提出 $F_{1} = H_{1}$ 和 $F_{2} = H_{2}$ 作为两个运动积分。\n首先，我们验证它们是运动积分，即它们在哈密顿量 $H$ 的流下是守恒的。这意味着 $\\{H_{1}, H\\}=0$ 且 $\\{H_{2}, H\\}=0$。\n泊松括号定义为 $\\{f,g\\}=\\sum_{k=1}^{2}\\left(\\frac{\\partial f}{\\partial q_{k}}\\frac{\\partial g}{\\partial p_{k}}-\\frac{\\partial f}{\\partial p_{k}}\\frac{\\partial g}{\\partial q_{k}}\\right)$。\n我们来计算 $\\{H_{1}, H\\} = \\{H_{1}, H_{1} + H_{2}\\} = \\{H_{1}, H_{1}\\} + \\{H_{1}, H_{2}\\}$。\n括号 $\\{H_1, H_1\\}$ 显然为 $0$。\n对于 $\\{H_{1}, H_{2}\\}$：\n$$\n\\{H_{1}, H_{2}\\} = \\frac{\\partial H_{1}}{\\partial q_{1}}\\frac{\\partial H_{2}}{\\partial p_{1}} - \\frac{\\partial H_{1}}{\\partial p_{1}}\\frac{\\partial H_{2}}{\\partial q_{1}} + \\frac{\\partial H_{1}}{\\partial q_{2}}\\frac{\\partial H_{2}}{\\partial p_{2}} - \\frac{\\partial H_{1}}{\\partial p_{2}}\\frac{\\partial H_{2}}{\\partial q_{2}}\n$$\n由于 $H_{1}$ 只依赖于 $(q_{1}, p_{1})$，$H_{2}$ 只依赖于 $(q_{2}, p_{2})$，因此 $H_{1}$ 对 $q_{2}, p_{2}$ 的所有偏导数都为零，而 $H_{2}$ 对 $q_{1}, p_{1}$ 的所有偏导数也都为零。因此，求和中的每一项都为零，所以 $\\{H_{1}, H_{2}\\} = 0$。\n由此可得 $\\{H_{1}, H\\} = 0$。类似的计算表明 $\\{H_{2}, H\\} = \\{H_{2}, H_{1} + H_{2}\\} = \\{H_{2}, H_{1}\\} + \\{H_{2}, H_{2}\\} = -\\{H_{1}, H_{2}\\} + 0 = 0$。\n所以，$H_{1}$ 和 $H_{2}$ 确实是运动积分。它们是 $\\mathbb{R}^{4}$ 上光滑的、全局定义的函数。\n\n接下来，我们检验独立性。它们的梯度是 $\\mathrm{d}H_{1} = \\omega_{1}^{2}q_{1}\\mathrm{d}q_{1} + p_{1}\\mathrm{d}p_{1}$ 和 $\\mathrm{d}H_{2} = \\omega_{2}^{2}q_{2}\\mathrm{d}q_{2} + p_{2}\\mathrm{d}p_{2}$。这些 1-形式在任何地方都是线性无关的，除非其中一个或两个为零，这种情况只发生在子空间 $(q_{1}, p_{1}) = (0,0)$ 或 $(q_{2}, p_{2}) = (0,0)$ 上。因此，它们几乎处处独立。\n\n因为我们找到了 $n=2$ 个相互对合的独立运动积分 $(H_{1}, H_{2})$，所以该系统是完全可积的。\n\nLiouville-Arnold 定理适用于这些积分的正则能级集。对于常数 $E_{1}>0$ 和 $E_{2}>0$，能级集 $M_{E_{1},E_{2}} = \\{(q,p)\\in\\mathbb{R}^{4} | H_{1}=E_{1}, H_{2}=E_{2}\\}$ 是一个紧致流形。方程 $H_{i}=E_{i}$ 在 $(q_{i}, p_{i})$ 相平面中定义了一个（拓扑意义上的）圆。能级集 $M_{E_{1},E_{2}}$ 是这两个圆的笛卡尔积，即 $S^{1} \\times S^{1}$，这是一个 2-维环面 $\\mathbb{T}^{2}$。该定理断言，存在一个到作用量-角度坐标 $(J_{1}, J_{2}, \\theta_{1}, \\theta_{2})$ 的正则变换，使得用这些坐标表示的哈密顿量只依赖于作用量，即 $H=H(J_{1}, J_{2})$，并且哈密顿流在环面上是线性的。\n\n**2. 作用量变量的推导**\n\n作用量变量定义为 $J_{i} = \\frac{1}{2\\pi}\\oint_{\\gamma_{i}}p_{i}\\,\\mathrm{d}q_{i}$。积分路径 $\\gamma_{i}$ 是由 $H_{i} = E_{i} = \\text{常数}$ 定义的 $(q_{i}, p_{i})$ 平面中的闭合曲线。\n方程 $H_{i}=\\frac{1}{2}(p_{i}^{2}+\\omega_{i}^{2}q_{i}^{2})=E_{i}$ 可以写成：\n$$\n\\frac{q_{i}^{2}}{(\\sqrt{2E_{i}}/\\omega_{i})^{2}} + \\frac{p_{i}^{2}}{(\\sqrt{2E_{i}})^{2}} = 1\n$$\n这是 $(q_{i}, p_{i})$ 平面中一个椭圆的方程，其半轴分别为 $a = \\frac{\\sqrt{2E_{i}}}{\\omega_{i}}$ 和 $b = \\sqrt{2E_{i}}$。\n积分 $\\oint_{\\gamma_{i}}p_{i}\\,\\mathrm{d}q_{i}$ 表示该椭圆所包围的面积。椭圆的面积是 $\\pi a b$。\n面积 $= \\pi \\left(\\frac{\\sqrt{2E_{i}}}{\\omega_{i}}\\right) (\\sqrt{2E_{i}}) = \\frac{2\\pi E_{i}}{\\omega_{i}}$。\n将此代入作用量变量的定义中：\n$$\nJ_{i} = \\frac{1}{2\\pi} \\left(\\frac{2\\pi E_{i}}{\\omega_{i}}\\right) = \\frac{E_{i}}{\\omega_{i}}\n$$\n由于 $E_{i}$ 是函数 $H_{i}$ 的值，我们可以将作用量变量表示为相空间上的一个函数：\n$$\nJ_{i}(q_{i}, p_{i}) = \\frac{H_{i}}{\\omega_{i}} = \\frac{1}{2\\omega_{i}}(p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2})\n$$\n因此我们有 $J_{1} = \\frac{1}{2\\omega_{1}}(p_{1}^{2} + \\omega_{1}^{2}q_{1}^{2})$ 和 $J_{2} = \\frac{1}{2\\omega_{2}}(p_{2}^{2} + \\omega_{2}^{2}q_{2}^{2})$。\n\n**3. 角度变量的构造与正则共轭性**\n\n我们寻求与 $J_{1}$ 和 $J_{2}$ 正则共轭的角度变量 $\\theta_{1}$ 和 $\\theta_{2}$。找到它们的一个标准方法是提出一个能将哈密顿量化为所需形式的正则变换。考虑对每个子系统的变换：\n$$\nq_{i} = \\sqrt{\\frac{2J_{i}}{\\omega_{i}}}\\sin\\theta_{i}, \\quad p_{i} = \\sqrt{2J_{i}\\omega_{i}}\\cos\\theta_{i}\n$$\n将这些代入 $H_{i}$ 中得到 $H_{i} = \\frac{1}{2}\\left( (2J_{i}\\omega_{i}\\cos^{2}\\theta_{i}) + \\omega_{i}^{2}\\left(\\frac{2J_{i}}{\\omega_{i}}\\sin^{2}\\theta_{i}\\right) \\right) = J_{i}\\omega_{i}(\\cos^{2}\\theta_{i} + \\sin^{2}\\theta_{i}) = J_{i}\\omega_{i}$。这证实了 $H_{i}$ 仅依赖于 $J_{i}$。\n\n为了用 $(q_i, p_i)$ 表示 $\\theta_i$，我们对变换求逆：\n$$\n\\sin\\theta_{i} = \\frac{q_{i}}{\\sqrt{2J_{i}/\\omega_{i}}} = \\frac{q_{i}\\sqrt{\\omega_{i}}}{\\sqrt{2J_{i}\\omega_{i}}}, \\quad \\cos\\theta_{i} = \\frac{p_{i}}{\\sqrt{2J_{i}\\omega_{i}}}\n$$\n两式相除得到：\n$$\n\\tan\\theta_{i} = \\frac{\\sin\\theta_{i}}{\\cos\\theta_{i}} = \\frac{q_{i}\\sqrt{\\omega_{i}}}{p_{i}}\n$$\n这意味着角度变量 $\\theta_{i}$ 由下式给出：\n$$\n\\theta_{i}(q_{i}, p_{i}) = \\arctan\\left(\\frac{\\omega_{i} q_{i}}{p_{i}}\\right)\n$$\n此处暗含使用双参数反正切函数，以正确确定 $(p_{i}, \\omega_{i}q_{i})$ 平面所有四个象限中的角度，使其在 $\\mathbb{R}^2 \\setminus \\{(0,0)\\}$ 上有良好定义。\n\n为了验证 $(\\theta_i, J_j)$ 是正则坐标，我们必须证明 $\\{\\theta_{i}, J_{j}\\} = \\delta_{ij}$。\n由于 $\\theta_{i}$ 只依赖于 $(q_{i},p_{i})$，$J_{j}$ 只依赖于 $(q_{j},p_{j})$，对于 $i \\neq j$，泊松括号 $\\{\\theta_{i}, J_{j}\\}$ 显然为 $0$。\n我们需要计算 $\\{\\theta_{i}, J_{i}\\}$：\n我们有 $J_{i} = \\frac{1}{2\\omega_{i}}(p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2})$ 的偏导数：\n$\\frac{\\partial J_{i}}{\\partial q_{i}} = \\omega_{i} q_{i}$\n$\\frac{\\partial J_{i}}{\\partial p_{i}} = \\frac{p_{i}}{\\omega_{i}}$\n以及 $\\theta_{i} = \\arctan(\\omega_{i}q_{i}/p_{i})$ 的偏导数：\n$\\frac{\\partial \\theta_{i}}{\\partial q_{i}} = \\frac{1}{1 + (\\omega_{i}q_{i}/p_{i})^{2}} \\cdot \\frac{\\omega_{i}}{p_{i}} = \\frac{p_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} \\cdot \\frac{\\omega_{i}}{p_{i}} = \\frac{\\omega_{i} p_{i}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}$\n$\\frac{\\partial \\theta_{i}}{\\partial p_{i}} = \\frac{1}{1 + (\\omega_{i}q_{i}/p_{i})^{2}} \\cdot \\left(-\\frac{\\omega_{i}q_{i}}{p_{i}^{2}}\\right) = \\frac{p_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} \\cdot \\left(-\\frac{\\omega_{i}q_{i}}{p_{i}^{2}}\\right) = \\frac{-\\omega_{i} q_{i}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}$\n现在计算泊松括号：\n$$\n\\{\\theta_{i}, J_{i}\\} = \\frac{\\partial \\theta_{i}}{\\partial q_{i}}\\frac{\\partial J_{i}}{\\partial p_{i}} - \\frac{\\partial \\theta_{i}}{\\partial p_{i}}\\frac{\\partial J_{i}}{\\partial q_{i}}\n$$\n$$\n\\{\\theta_{i}, J_{i}\\} = \\left(\\frac{\\omega_{i} p_{i}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}\\right)\\left(\\frac{p_{i}}{\\omega_{i}}\\right) - \\left(\\frac{-\\omega_{i} q_{i}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}\\right)(\\omega_{i} q_{i})\n$$\n$$\n\\{\\theta_{i}, J_{i}\\} = \\frac{p_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} + \\frac{\\omega_{i}^{2} q_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} = \\frac{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}}{p_{i}^{2} + \\omega_{i}^{2}q_{i}^{2}} = 1\n$$\n因此，我们已经证实了 $\\{\\theta_{i}, J_{j}\\} = \\delta_{ij}$。\n\n**4. 哈密顿流与角度变量的周期性**\n\n在作用量-角度坐标下，哈密顿量为 $H = H_{1} + H_{2} = \\omega_{1}J_{1} + \\omega_{2}J_{2}$。\n角度变量的运动方程由哈密顿方程给出：\n$$\n\\dot{\\theta}_{i} = \\{\\theta_{i}, H\\} = \\{\\theta_{i}, \\omega_1 J_1 + \\omega_2 J_2\\} = \\omega_1 \\{\\theta_i, J_1\\} + \\omega_2 \\{\\theta_i, J_2\\}\n$$\n使用正则关系 $\\{\\theta_{i}, J_{j}\\} = \\delta_{ij}$：\n对于 $i=1$：$\\dot{\\theta}_{1} = \\omega_{1}\\{\\theta_{1}, J_{1}\\} + \\omega_{2}\\{\\theta_{1}, J_{2}\\} = \\omega_{1}(1) + \\omega_{2}(0) = \\omega_{1}$。\n对于 $i=2$：$\\dot{\\theta}_{2} = \\omega_{1}\\{\\theta_{2}, J_{1}\\} + \\omega_{2}\\{\\theta_{2}, J_{2}\\} = \\omega_{1}(0) + \\omega_{2}(1) = \\omega_{2}$。\n这表明角度变量随时间线性演化：$\\theta_{i}(t) = \\omega_{i}t + \\theta_{i}(0)$。角度变量的频率就是谐振子的频率。\n\n角度变量 $\\theta_{i}$ 是 $2\\pi$ 周期的，这有两个基本原因。\n首先，从 Liouville-Arnold 定理的角度看，角度变量是不变环面 $\\mathbb{T}^{2}$ 上的坐标。环面在拓扑上是圆的乘积，$\\mathbb{T}^{2} = S^{1} \\times S^{1}$。圆上的坐标天然具有周期性。按照惯例，这个周期取为 $2\\pi$。\n其次，我们可以从原始坐标看出这一点。每个子系统 $(q_{i}, p_{i})$ 的运动由 $H_{i}$ 的哈密顿方程决定：\n$\\dot{q}_{i} = \\{q_{i}, H_{i}\\} = \\partial H_{i}/\\partial p_{i} = p_{i}$\n$\\dot{p}_{i} = \\{p_{i}, H_{i}\\} = -\\partial H_{i}/\\partial q_{i} = -\\omega_{i}^{2}q_{i}$\n这给出了简谐振子的运动方程：$\\ddot{q}_{i} + \\omega_{i}^{2}q_{i} = 0$。其解是周期的，周期为 $T_{i} = 2\\pi/\\omega_{i}$。在一个周期内，相点 $(q_{i}(t), p_{i}(t))$ 描绘出一个完整的椭圆并回到其起点。在这段时间 $T_{i}$ 内，相应的角度变量 $\\theta_{i}(t) = \\omega_{i}t + \\theta_{i}(0)$ 变化了 $\\Delta\\theta_{i} = \\omega_{i}T_{i} = \\omega_{i}(2\\pi/\\omega_{i}) = 2\\pi$。由于当 $\\theta_{i}$ 变化 $2\\pi$ 后，子系统的物理状态是相同的，所以角度变量是一个 $2\\pi$ 周期的坐标。\n\n因此，角度变量的显式解析表达式为：\n$\\theta_{1}(q,p) = \\arctan\\left(\\frac{\\omega_{1} q_{1}}{p_{1}}\\right)$\n$\\theta_{2}(q,p) = \\arctan\\left(\\frac{\\omega_{2} q_{2}}{p_{2}}\\right)$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\arctan\\left(\\frac{\\omega_{1} q_{1}}{p_{1}}\\right)  \\arctan\\left(\\frac{\\omega_{2} q_{2}}{p_{2}}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "为了展示这些方法在线性系统之外的威力，我们转向单摆这一非线性动力学的经典例子。本问题聚焦于摆动（libration）状态，并要求计算其作用量变量，这将涉及到椭圆积分的使用。这项实践表明，作用量-角变量的概念如何推广到运动周期依赖于能量的、更复杂的、具有物理意义的系统中。",
            "id": "3779755",
            "problem": "考虑位于圆的余切丛 $T^{\\ast}S^{1}$ 上的一个哈密顿系统，其正则坐标为 $(\\theta,p)$。该系统描述了一个在大小为 $g$ 的匀强引力场中，长度为 $l$、质量为 $m$ 的单平面摆，其哈密顿量为\n$$\nH(\\theta,p)=\\frac{p^{2}}{2 m l^{2}}+m g l\\bigl(1-\\cos\\theta\\bigr).\n$$\n重点关注振荡区域，即固定能量水平 $\\mathcal{E}$ 满足 $0\\mathcal{E}2 m g l$ 的情况。在此区域，能量等位集是一个紧致的一维不变环面，根据 Liouville–Arnold 定理，存在适应于此不变环面的作用量-角坐标 $(I,\\alpha)$。\n\n从以下基本定义出发\n- 作用量，定义为能量为 $\\mathcal{E}$ 的闭合轨道上的归一化辛面积，\n$$\nI(\\mathcal{E})=\\frac{1}{2\\pi}\\oint_{\\gamma_{\\mathcal{E}}} p\\, d\\theta,\n$$\n- 以及角变量，通过第一类生成函数 $W(\\theta,I)$ 定义为 $\\alpha(\\theta;I)=\\frac{\\partial W}{\\partial I}(\\theta,I)$，其中 $W(\\theta,I)=\\int_{0}^{\\theta} p(\\theta';I)\\, d\\theta'$，\n推导作用量 $I(\\mathcal{E})$ 的一个闭合形式的显式表达式。您的推导必须从这些定义和哈密顿方程出发，并且在科学上必须是自洽的。您可以通过关系式 $\\mathcal{E}=2 m g l\\, k^{2}$ 引入振幅参数 $k\\in(0,1)$，并且可以用标准的第一类和第二类完全椭圆积分来表示您的最终结果，\n$$\n\\mathrm{K}(k)=\\int_{0}^{\\pi/2}\\frac{d\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}},\\qquad\n\\mathrm{E}(k)=\\int_{0}^{\\pi/2}\\sqrt{1-k^{2}\\sin^{2}\\varphi}\\, d\\varphi.\n$$\n如果您愿意，您也可以使用不完全椭圆积分来表示振荡轨道上相应的正则角变量 $\\alpha$，并论证它随时间以由轨道周期决定的频率均匀前进，但您唯一需要作为最终答案报告的量是 $I(\\mathcal{E})$ 关于 $m$、$l$、$g$ 和完全椭圆积分的显式解析表达式。\n\n请以单个闭合形式的解析表达式提供您的最终答案。不要进行任何数值计算或四舍五入。",
            "solution": "该系统有一个自由度并且是可积的。对于振荡区中的一个固定能量 $\\mathcal{E}\\in(0,2 m g l)$，转折点 $\\pm\\theta_{0}$ 满足\n$$\n\\mathcal{E}=m g l\\bigl(1-\\cos\\theta_{0}\\bigr)=2 m g l\\,\\sin^{2}\\!\\left(\\frac{\\theta_{0}}{2}\\right).\n$$\n通过以下方式引入模 $k\\in(0,1)$\n$$\nk=\\sin\\!\\left(\\frac{\\theta_{0}}{2}\\right),\\qquad \\text{因此}\\quad \\mathcal{E}=2 m g l\\, k^{2}.\n$$\n在能量面 $H=\\mathcal{E}$ 上，动量由下式确定\n$$\n\\frac{p^{2}}{2 m l^{2}}=\\mathcal{E}-m g l\\bigl(1-\\cos\\theta\\bigr)=m g l\\bigl(\\cos\\theta-\\cos\\theta_{0}\\bigr).\n$$\n使用 $\\cos\\theta-\\cos\\theta_{0}=2\\bigl(\\sin^{2}(\\theta_{0}/2)-\\sin^{2}(\\theta/2)\\bigr)=2\\bigl(k^{2}-\\sin^{2}(\\theta/2)\\bigr)$，我们得到\n$$\np(\\theta;\\mathcal{E})=\\pm\\sqrt{2 m l^{2}\\cdot 2 m g l\\bigl(k^{2}-\\sin^{2}(\\theta/2)\\bigr)}=2 m l\\sqrt{g l}\\,\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}.\n$$\n根据定义，作用量为\n$$\nI(\\mathcal{E})=\\frac{1}{2\\pi}\\oint_{\\gamma_{\\mathcal{E}}} p\\, d\\theta=\\frac{2}{\\pi}\\int_{0}^{\\theta_{0}} p(\\theta;\\mathcal{E})\\, d\\theta=\\frac{4 m l\\sqrt{g l}}{\\pi}\\int_{0}^{\\theta_{0}}\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}\\, d\\theta,\n$$\n此处我们利用对称性，将闭路积分表示为从 $0$ 到 $\\theta_{0}$ 积分的四倍，然后除以 $2\\pi$。\n\n为了计算该积分，使用换元法，令 $\\sin(\\theta/2)=k\\sin\\varphi$，其中 $\\varphi\\in[0,\\pi/2]$。则有 $d\\theta=\\dfrac{2 k\\cos\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi$ 并且\n$$\n\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}=k\\sqrt{1-\\sin^{2}\\varphi}=k\\cos\\varphi.\n$$\n因此\n$$\n\\int_{0}^{\\theta_{0}}\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}\\, d\\theta\n=\\int_{0}^{\\pi/2} k\\cos\\varphi\\cdot \\frac{2 k\\cos\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi\n=2 k^{2}\\int_{0}^{\\pi/2}\\frac{\\cos^{2}\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi.\n$$\n分解 $\\cos^{2}\\varphi=1-\\sin^{2}\\varphi$ 并使用标准的完全椭圆积分：\n$$\n\\int_{0}^{\\pi/2}\\frac{d\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}=\\mathrm{K}(k),\\qquad\n\\int_{0}^{\\pi/2}\\sqrt{1-k^{2}\\sin^{2}\\varphi}\\, d\\varphi=\\mathrm{E}(k).\n$$\n一个标准的恒等式可由下式导出：\n$$\n\\int_{0}^{\\pi/2}\\frac{1-k^{2}\\sin^{2}\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi=\\mathrm{E}(k)\n\\quad\\Longrightarrow\\quad\nk^{2}\\int_{0}^{\\pi/2}\\frac{\\sin^{2}\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi=\\mathrm{K}(k)-\\mathrm{E}(k).\n$$\n因此，\n$$\n\\int_{0}^{\\pi/2}\\frac{\\cos^{2}\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}\\, d\\varphi\n=\\mathrm{K}(k)-\\frac{\\mathrm{K}(k)-\\mathrm{E}(k)}{k^{2}}\n=\\frac{\\mathrm{E}(k)-(1-k^{2})\\,\\mathrm{K}(k)}{k^{2}}.\n$$\n代回后，我们得到\n$$\n\\int_{0}^{\\theta_{0}}\\sqrt{k^{2}-\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)}\\, d\\theta\n=2\\bigl[\\mathrm{E}(k)-(1-k^{2})\\,\\mathrm{K}(k)\\bigr].\n$$\n于是，作用量为\n$$\nI(\\mathcal{E})=\\frac{4 m l\\sqrt{g l}}{\\pi}\\cdot 2\\bigl[\\mathrm{E}(k)-(1-k^{2})\\,\\mathrm{K}(k)\\bigr]\n=\\frac{8 m l\\sqrt{g l}}{\\pi}\\,\\Bigl[\\mathrm{E}(k)-(1-k^{2})\\,\\mathrm{K}(k)\\Bigr],\n$$\n其中 $k=\\sqrt{\\mathcal{E}/(2 m g l)}$。\n\n为完整起见，我们给出一个相容的角变量及其均匀前进特性。哈密顿方程给出 $\\dot{\\theta}=\\partial H/\\partial p=p/(m l^{2})=2\\sqrt{g/l}\\,\\sqrt{k^{2}-\\sin^{2}(\\theta/2)}$。因此\n$$\n\\frac{d t}{d\\theta}=\\frac{1}{\\dot{\\theta}}=\\frac{1}{2}\\sqrt{\\frac{l}{g}}\\,\\frac{1}{\\sqrt{k^{2}-\\sin^{2}(\\theta/2)}}.\n$$\n四分之一周期为\n$$\n\\frac{T(\\mathcal{E})}{4}=\\int_{0}^{\\theta_{0}}\\frac{dt}{d\\theta}\\, d\\theta=\\sqrt{\\frac{l}{g}}\\int_{0}^{\\pi/2}\\frac{d\\varphi}{\\sqrt{1-k^{2}\\sin^{2}\\varphi}}=\\sqrt{\\frac{l}{g}}\\,\\mathrm{K}(k),\n$$\n所以完整周期为 $T(\\mathcal{E})=4\\sqrt{l/g}\\,\\mathrm{K}(k)$，频率为 $\\omega(\\mathcal{E})=2\\pi/T(\\mathcal{E})=\\pi\\bigl(2\\sqrt{l/g}\\,\\mathrm{K}(k)\\bigr)^{-1}$。在递增分支上一个方便的正则角变量是\n$$\n\\alpha(\\theta;\\mathcal{E})=\\frac{\\pi}{\\mathrm{K}(k)}\\,\\mathrm{F}\\!\\left(\\arcsin\\!\\left(\\frac{\\sin(\\theta/2)}{k}\\right)\\!,\\,k\\right)\\quad\\text{mod }2\\pi,\n$$\n其中 $\\mathrm{F}(\\cdot,k)$ 是第一类不完全椭圆积分；那么沿着轨道有 $\\dot{\\alpha}=\\omega(\\mathcal{E})$，这与 Liouville–Arnold 定理一致。所要求的最终量是上面给出的闭合形式的作用量 $I(\\mathcal{E})$。",
            "answer": "$$\\boxed{\\frac{8 m l \\sqrt{g l}}{\\pi}\\left[\\mathrm{E}\\!\\left(\\sqrt{\\frac{\\mathcal{E}}{2 m g l}}\\right)-\\left(1-\\frac{\\mathcal{E}}{2 m g l}\\right)\\mathrm{K}\\!\\left(\\sqrt{\\frac{\\mathcal{E}}{2 m g l}}\\right)\\right]}$$"
        }
    ]
}