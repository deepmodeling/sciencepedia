{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的物理系统之前，通过一个简化的数学模型来掌握约束稳定性的核心思想是至关重要的。这个练习旨在阐明一个关键概念：即使一个系统在整个空间中是不稳定的（由不定的黑塞矩阵反映），当其运动被限制在一个特定的子流形（辛叶）上时，它也可能变得稳定。通过分析一个简单的二次能量函数在球面上的行为，我们将揭示约束条件是如何从根本上改变稳定性特征的 。",
            "id": "3729726",
            "problem": "考虑函数 $E : \\mathbb{R}^{3} \\to \\mathbb{R}$，$E(x,y,z) = x^{2} - y^{2} + z^{2}$，将其视为泊松流形上的能量泛函，其中二次不变量 $C(x,y,z) = x^{2} + y^{2} + z^{2}$ 的水平集被解释为伴随轨道（辛叶）。这个设置在弗拉基米尔·伊戈尔维奇·阿诺德的非线性稳定性定理的意义下模拟了能量-卡西米尔方法，其中稳定性由辛叶上的约束最小化来刻画，而不是由环境空间中的无约束性质来刻画。\n\n施加约束 $C(x,y,z) = r^{2}$（对于固定的 $r > 0$），因此约束流形是半径为 $r$ 的球面 $S^{2}$。令 $p = (0, r, 0) \\in S^{2}$。你的任务是：\n\n1. 使用拉格朗日乘子法处理约束极值问题，证明 $p$ 是 $E$ 在流形 $C = r^{2}$ 上的一个约束临界点，并确定乘子 $\\lambda \\in \\mathbb{R}$ 使得 $\\nabla E(p) = \\lambda \\nabla C(p)$。\n\n2. 计算无约束的海森矩阵 $\\mathrm{Hess}\\,E(p)$ 并确定其定性。\n\n3. 按如下方式计算在 $p$ 点的约束海森矩阵：构造增广拉格朗日函数 $L = E - \\lambda C$，计算 $\\mathrm{Hess}\\,L(p)$，然后将此双线性形式限制在切空间 $T_{p}S^{2} = \\{\\xi \\in \\mathbb{R}^{3} \\mid \\nabla C(p) \\cdot \\xi = 0\\}$ 上。确定该限制形式的特征值。\n\n4. 将步骤 3 中得到的最小正特征值作为你的最终答案。将答案表示为精确的实数，无需四舍五入。\n\n这个问题阐明了在 Arnold 框架中约束对于稳定性的必要性：尽管无约束的海森矩阵是不定的，但在辛叶上的约束海森矩阵是正定的，从而得到非线性稳定性。",
            "solution": "我们从约束临界点、拉格朗日乘子、海森矩阵和切空间的标准定义开始。光滑函数 $E$ 在光滑约束 $C$ 的水平集上的约束临界点，其特征在于存在一个实数 $\\lambda$ 使得 $\\nabla E(p) = \\lambda \\nabla C(p)$。约束极值的二阶变分是通过将双线性形式 $\\mathrm{Hess}\\,(E - \\lambda C)$ 限制在约束流形于临界点处的切空间上得到的。\n\n步骤 $1$：证明 $p$ 是一个约束临界点并求出 $\\lambda$。\n\n计算梯度：\n$$\n\\nabla E(x,y,z) = \\big(2x,\\,-2y,\\,2z\\big), \\quad \\nabla C(x,y,z) = \\big(2x,\\,2y,\\,2z\\big).\n$$\n在点 $p = (0,r,0)$ 处，我们有\n$$\n\\nabla E(p) = \\big(0,\\,-2r,\\,0\\big), \\quad \\nabla C(p) = \\big(0,\\,2r,\\,0\\big).\n$$\n我们寻找 $\\lambda \\in \\mathbb{R}$ 使得 $\\nabla E(p) = \\lambda \\nabla C(p)$，即\n$$\n\\big(0,\\,-2r,\\,0\\big) = \\lambda \\big(0,\\,2r,\\,0\\big).\n$$\n当 $\\lambda = -1$ 时，该式成立。因此，$p$ 是一个约束临界点，其乘子为 $\\lambda = -1$。\n\n步骤 $2$：计算 $\\mathrm{Hess}\\,E(p)$ 并确定其定性。\n\n$E$ 的海森矩阵是常数（与 $(x,y,z)$ 无关），由下式给出\n$$\n\\mathrm{Hess}\\,E = \n\\begin{pmatrix}\n2  & 0 & 0 \\\\\n0 & -2 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}.\n$$\n其特征值为 $2$、$-2$ 和 $2$，因此它在环境空间 $\\mathbb{R}^{3}$ 中是不定的。\n\n步骤 $3$：通过将 $\\mathrm{Hess}\\,(E - \\lambda C)$ 限制在 $T_{p}S^{2}$ 上来计算约束海森矩阵，并求其特征值。\n\n首先计算约束 $C$ 的海森矩阵。由于 $C(x,y,z) = x^{2}+y^{2}+z^{2}$，我们有\n$$\n\\mathrm{Hess}\\,C = 2 I_{3} = \n\\begin{pmatrix}\n2  & 0 & 0 \\\\\n0 & 2 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}.\n$$\n构造增广拉格朗日函数\n$$\nL = E - \\lambda C = E - (-1) C = E + C,\n$$\n所以\n$$\n\\mathrm{Hess}\\,L = \\mathrm{Hess}\\,E - \\lambda \\,\\mathrm{Hess}\\,C = \\mathrm{Hess}\\,E + \\mathrm{Hess}\\,C = \n\\begin{pmatrix}\n2  & 0 & 0 \\\\\n0 & -2 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n2  & 0 & 0 \\\\\n0 & 2 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4  & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 4\n\\end{pmatrix}.\n$$\n\n接下来确定切空间 $T_{p}S^{2}$。根据定义，\n$$\nT_{p}S^{2} = \\big\\{ \\xi \\in \\mathbb{R}^{3} \\,\\big|\\, \\nabla C(p) \\cdot \\xi = 0 \\big\\}.\n$$\n我们有 $\\nabla C(p) = (0,\\,2r,\\,0)$，因此条件是\n$$\n(0,\\,2r,\\,0) \\cdot (\\xi_{x}, \\xi_{y}, \\xi_{z}) = 2r\\,\\xi_{y} = 0 \\quad \\Rightarrow \\quad \\xi_{y} = 0.\n$$\n因此\n$$\nT_{p}S^{2} = \\big\\{ (\\xi_{x},\\,0,\\,\\xi_{z}) \\in \\mathbb{R}^{3} \\big\\}.\n$$\n\n将 $\\mathrm{Hess}\\,L$ 限制在该切空间上。对于 $\\xi = (\\xi_{x},\\,0,\\,\\xi_{z})$，二次型为\n$$\nQ(\\xi) = \\xi^{\\top} \\,\\mathrm{Hess}\\,L\\, \\xi = \n\\begin{pmatrix}\n\\xi_{x} & 0 & \\xi_{z}\n\\end{pmatrix}\n\\begin{pmatrix}\n4  & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 4\n\\end{pmatrix}\n\\begin{pmatrix}\n\\xi_{x} \\\\ 0 \\\\ \\xi_{z}\n\\end{pmatrix}\n= 4 \\xi_{x}^{2} + 4 \\xi_{z}^{2}.\n$$\n因此，关于 $T_{p}S^{2}$ 的基 $\\{(1,0,0),(0,0,1)\\}$，限制后的双线性形式由 $2 \\times 2$ 矩阵表示\n$$\n\\begin{pmatrix}\n4  & 0 \\\\\n0 & 4\n\\end{pmatrix}.\n$$\n其特征值为 $4$ 和 $4$，这表明约束海森矩阵在 $T_{p}S^{2}$ 上是正定的。\n\n步骤 $4$：最小正特征值。\n\n根据上述计算，约束海森矩阵的最小正特征值为 $4$。\n\n这展示了 Arnold 的非线性稳定性定理中的关键机制：尽管能量 $E$ 的无约束海森矩阵在环境空间 $\\mathbb{R}^{3}$ 中是不定的，但在辛叶 $C = r^{2}$ 上的约束二阶变分是正定的，从而在适当的约束下建立了非线性稳定性。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "现在，我们将应用能量-Casimir方法来分析几何力学中的一个经典范例：自由刚体。这个练习要求我们确定刚体围绕其中间惯性主轴旋转的稳定性，这是一个非平凡且具有深刻物理洞察力的问题。通过计算能量-Casimir函数的二阶变分并在相应的余伴轨道（一个球面）的切空间上确定其符号，我们将直接应用阿诺德非线性稳定性定理的判据 。",
            "id": "3729747",
            "problem": "考虑特殊正交群(SO(3))的李代数的对偶空间上的约化自由刚体，该模型建立在具有坐标 $M = (M_{1}, M_{2}, M_{3})$ 的向量空间 $\\mathbb{R}^{3}$ 上。$\\mathbb{R}^{3}$ 上的函数 $F, G$ 的李-泊松括号定义为 $\\{F,G\\}(M) = - M \\cdot (\\nabla F(M) \\times \\nabla G(M))$，余伴随轨道是赋有 Kirillov–Kostant–Souriau 辛结构的球面 $|M| = \\text{常数}$。哈密顿量为\n$$\nH(M) = \\frac{1}{2}\\left(\\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}}\\right),\n$$\n其中 $I_{1}, I_{2}, I_{3} > 0$ 是不同的主转动惯量，其大小顺序为 $I_{1}  I_{2}  I_{3}$。函数\n$$\nC(M) = |M|^{2} = M_{1}^{2} + M_{2}^{2} + M_{3}^{2}\n$$\n是一个卡西米尔不变量（李-泊松动力学的一个运动常数）。令 $M_{0} = \\mu\\, e_{2} = (0, \\mu, 0)$，其中 $\\mu \\neq 0$ 为某个固定值，这对应于绕与 $I_{2}$ 相关的轴的转动。\n\n从一阶和二阶变分以及标准欧几里得梯度和海森矩阵的定义出发，确定标量 $\\lambda$，使得 $M_{0}$ 是约束泛函 $F(M) = H(M) - \\lambda\\, C(M)$ 的一个临界点。显式计算二阶变分 $D^{2}F(M_{0})$ 作为一种对称双线性形式，并确定其在约束子空间 $T_{M_{0}}\\mathcal{O}$ 上的符号差，其中 $\\mathcal{O}$ 是通过 $M_{0}$ 的余伴随轨道（等价地，球面 $|M| = |M_{0}|$)，因此 $T_{M_{0}}\\mathcal{O} = \\{ \\delta M \\in \\mathbb{R}^{3} \\,:\\, \\delta M \\cdot M_{0} = 0 \\}$。\n\n将符号差表示为有序对 $(n_{+}, n_{-})$，其中 $n_{+}$ 是 $D^{2}F(M_{0})$ 限制在 $T_{M_{0}}\\mathcal{O}$ 上的正方向数，$n_{-}$ 是负方向数。你的最终答案必须仅为该有序对。",
            "solution": "我们从 $\\mathbb{R}^{3}$ 上光滑函数的欧几里得梯度和海森矩阵的定义开始。对于哈密顿量\n$$\nH(M) = \\frac{1}{2}\\left(\\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}}\\right),\n$$\n其梯度和海森矩阵为\n$$\n\\nabla H(M) = \\left(\\frac{M_{1}}{I_{1}}, \\frac{M_{2}}{I_{2}}, \\frac{M_{3}}{I_{3}}\\right), \\quad D^{2}H(M) = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}}, \\frac{1}{I_{2}}, \\frac{1}{I_{3}}\\right).\n$$\n对于卡西米尔不变量\n$$\nC(M) = M_{1}^{2} + M_{2}^{2} + M_{3}^{2},\n$$\n我们有\n$$\n\\nabla C(M) = \\left(2 M_{1}, 2 M_{2}, 2 M_{3}\\right), \\quad D^{2}C(M) = 2\\, I_{3 \\times 3},\n$$\n其中 $I_{3 \\times 3}$ 是 $3 \\times 3$ 单位矩阵。\n\n定义约束泛函\n$$\nF(M) = H(M) - \\lambda\\, C(M).\n$$\n其梯度和海森矩阵为\n$$\n\\nabla F(M) = \\nabla H(M) - \\lambda\\, \\nabla C(M), \\quad D^{2}F(M) = D^{2}H(M) - \\lambda\\, D^{2}C(M).\n$$\n计算在 $M_{0} = (0, \\mu, 0)$ 处的一阶变分：\n$$\n\\nabla F(M_{0}) = \\left(0, \\frac{\\mu}{I_{2}}, 0\\right) - \\lambda\\, \\left(0, 2\\mu, 0\\right) = \\left(0, \\mu\\left(\\frac{1}{I_{2}} - 2\\lambda\\right), 0\\right).\n$$\n临界点条件 $\\nabla F(M_{0}) = 0$ 得出\n$$\n\\lambda = \\frac{1}{2 I_{2}}.\n$$\n\n接下来计算在 $M_{0}$ 处的二阶变分：\n$$\nD^{2}F(M_{0}) = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}}, \\frac{1}{I_{2}}, \\frac{1}{I_{3}}\\right) - \\frac{1}{2 I_{2}} \\cdot 2\\, I_{3 \\times 3} = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}} - \\frac{1}{I_{2}}, 0, \\frac{1}{I_{3}} - \\frac{1}{I_{2}}\\right).\n$$\n约束子空间是通过 $M_{0}$ 的余伴随轨道的切空间，即球面 $|M| = |M_{0}|$。其在 $M_{0}$ 处的切空间为\n$$\nT_{M_{0}}\\mathcal{O} = \\left\\{ \\delta M \\in \\mathbb{R}^{3} \\;:\\; \\delta M \\cdot M_{0} = 0 \\right\\} = \\left\\{ (\\delta M_{1}, \\delta M_{2}, \\delta M_{3}) \\;:\\; \\mu\\, \\delta M_{2} = 0 \\right\\}.\n$$\n由于 $\\mu \\neq 0$，约束条件为 $\\delta M_{2} = 0$，因此 $T_{M_{0}}\\mathcal{O}$ 由坐标方向 $e_{1}$ 和 $e_{3}$ 张成。\n\n将 $D^{2}F(M_{0})$ 限制到 $T_{M_{0}}\\mathcal{O}$ 上，得到对角形式，其对角元为\n$$\n\\lambda_{1} = \\frac{1}{I_{1}} - \\frac{1}{I_{2}}, \\quad \\lambda_{3} = \\frac{1}{I_{3}} - \\frac{1}{I_{2}}.\n$$\n根据大小顺序 $I_{1}  I_{2}  I_{3}$，我们有\n$$\n\\frac{1}{I_{1}} - \\frac{1}{I_{2}} = \\frac{I_{2} - I_{1}}{I_{1} I_{2}}  0, \\quad \\frac{1}{I_{3}} - \\frac{1}{I_{2}} = \\frac{I_{2} - I_{3}}{I_{2} I_{3}}  0.\n$$\n因此，限制后的二阶变分是不定的，有一个正方向和一个负方向。$T_{M_{0}}\\mathcal{O}$ 上的符号差为\n$$\n(n_{+}, n_{-}) = (1, 1).\n$$",
            "answer": "$$\\boxed{(1, 1)}$$"
        },
        {
            "introduction": "理论分析的最终检验和扩展往往需要借助计算工具。这个练习将指导你将能量-Casimir方法的分析步骤转化为一个稳健的数值算法，用于测试自由刚体平衡点的非线性稳定性。通过编写代码来自动确定不同转动情况下的约束黑塞矩阵的定性，你将不仅能验证理论预测，还能深入理解该方法在实际应用中的具体实现 。",
            "id": "3729741",
            "problem": "将自由刚体视为一个典范的李-泊松哈密顿系统。设位形群为特殊正交群 $\\mathrm{SO}(3)$，状态变量为物体角动量 $\\mathbf{M} \\in \\mathbb{R}^3 \\cong \\mathfrak{so}(3)^*$. 哈密顿量由 $H(\\mathbf{M}) = \\tfrac{1}{2} \\mathbf{M}^{\\top} \\mathbb{I}^{-1} \\mathbf{M}$ 给出，其中 $\\mathbb{I} = \\mathrm{diag}(I_1, I_2, I_3)$ 是对角惯性矩阵，其主转动惯量 $I_1, I_2, I_3$ 严格为正。李-泊松动力学保持卡西米尔量 $C(\\mathbf{M}) = \\tfrac{1}{2} \\|\\mathbf{M}\\|^2$ 不变，且余伴随轨道是 $C$ 值恒定的球面。Arnold 的非线性稳定性定理指出，如果增广能量的二次变分在一个穿过余伴随轨道的合适切片上的限制是定的（正定或负定），则该平衡点是非线性稳定的。\n\n从基本定义出发：\n- 哈密顿量 $H(\\mathbf{M}) = \\tfrac{1}{2} \\mathbf{M}^{\\top} \\mathbb{I}^{-1} \\mathbf{M}$,\n- 卡西米尔量 $C(\\mathbf{M}) = \\tfrac{1}{2} \\|\\mathbf{M}\\|^2$,\n- 能量-卡西米尔方法（ECM）：考虑增广函数 $F_\\lambda(\\mathbf{M}) = H(\\mathbf{M}) - \\lambda C(\\mathbf{M})$，其中 $\\lambda \\in \\mathbb{R}$ 的选择需满足在平衡点 $\\mathbf{M}_e$ 处 $\\nabla F_\\lambda(\\mathbf{M}_e) = \\mathbf{0}$,\n\n你的任务是实现一个数值方法，用于检验在与余伴随轨道于 $\\mathbf{M}_e$ 处相切的切片上，$F_\\lambda$ 的约化二次型的定性。具体来说：\n\n1. 考虑平衡点 $\\mathbf{M}_e$ 与某一主轴对齐的情况：$\\mathbf{M}_e = m \\mathbf{e}_k$，其中 $\\mathbf{e}_k$ 是 $\\mathbb{R}^3$ 的第 $k$ 个标准基向量，$m \\in \\mathbb{R}$，且 $k \\in \\{0,1,2\\}$ 分别对应于与 $I_1, I_2, I_3$ 相关的轴。根据驻定性条件 $\\nabla H(\\mathbf{M}_e) = \\lambda \\nabla C(\\mathbf{M}_e)$ 确定拉格朗日乘子 $\\lambda$。\n\n2. 计算 $F_\\lambda$ 在 $\\mathbf{M}_e$ 处的海森矩阵，记为 $\\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e)$。不要使用任何已知的简化公式；从 $H$ 和 $C$ 的定义推导 $\\mathrm{Hess}\\, F_\\lambda$。\n\n3. 将切片定义为余伴随轨道在 $\\mathbf{M}_e$ 处的切空间，即与 $\\mathbf{M}_e$ 正交的子空间：$\\mathcal{S} = \\{\\delta \\mathbf{M} \\in \\mathbb{R}^3 \\mid \\mathbf{M}_e^{\\top} \\delta \\mathbf{M} = 0\\}$。为 $\\mathcal{S}$ 构建一个标准正交基 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$，不要使用任何特殊情况下的简化。利用此基，计算约化二次型 $Q$，其形式为一个对称 $2 \\times 2$ 矩阵 $Q = [q_{ij}]$，其中元素为 $q_{ij} = \\mathbf{v}_i^{\\top} \\big(\\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e)\\big) \\mathbf{v}_j$。\n\n4. 计算 $Q$ 的特征值，并通过检验其符号来确定定性类型：\n   - 若两个特征值均为严格正数，则为正定。\n   - 若两个特征值均为严格负数，则为负定。\n   - 若至少一个特征值在数值上为零（在指定容差范围内），且另一个非零但符号不相反，则为半定。\n   - 若特征值符号相反，则为不定。\n\n5. 实现一个鲁棒的数值分类方法，该方法使用一个容差阈值 $t  0$ 来判断一个值是否应被视为零（你必须选择一个合理的 $t$）。将每个测试用例的定性类型报告为一个整数代码：\n   - $1$ 代表正定，\n   - $-1$ 代表负定，\n   - $2$ 代表半定，\n   - $0$ 代表不定。\n\n你的程序必须使用以下参数值测试套件：\n- 情况 A（绕最小惯量轴的普适稳定情况）：$I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 0$.\n- 情况 B（绕最大惯量轴的普适稳定情况）：$I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 2$.\n- 情况 C（绕中间惯量轴的普适不稳定情况）：$I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 1$.\n- 情况 D（边界半定情况）：$I_1 = 1.0$, $I_2 = 1.0$, $I_3 = 2.0$, $k = 0$.\n\n你的程序必须生成单行输出，其中包含这四种情况的分类结果，格式为方括号内由逗号分隔的列表，没有空格，并按 A、B、C、D 的顺序排列。例如，如果分类结果是 $a$、$b$、$c$、$d$，则输出格式必须为 $[a,b,c,d]$。此问题不涉及物理单位，也不出现角度，因此无需指定单位。程序必须是完整的，并且无需用户输入即可运行。",
            "solution": "该问题要求实现能量-卡西米尔方法，以检验自由刚体平衡点的非线性稳定性。稳定性由增广哈密顿量的二次变分在特定子空间上的限制的定性决定。我们将遵循指定的步骤推导必要的数学量，然后实现一个数值测试。\n\n设状态为角动量向量 $\\mathbf{M} = (M_1, M_2, M_3)^\\top \\in \\mathbb{R}^3$。惯性矩阵为 $\\mathbb{I} = \\mathrm{diag}(I_1, I_2, I_3)$，其中 $I_1, I_2, I_3  0$。\n\n哈密顿量由 $H(\\mathbf{M}) = \\frac{1}{2} \\mathbf{M}^\\top \\mathbb{I}^{-1} \\mathbf{M} = \\frac{1}{2}\\left(\\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3}\\right)$ 给出。\n卡西米尔函数为 $C(\\mathbf{M}) = \\frac{1}{2} \\|\\mathbf{M}\\|^2 = \\frac{1}{2} \\mathbf{M}^\\top \\mathbf{M} = \\frac{1}{2}(M_1^2 + M_2^2 + M_3^2)$。\n\n增广函数为 $F_\\lambda(\\mathbf{M}) = H(\\mathbf{M}) - \\lambda C(\\mathbf{M})$，其中 $\\lambda$ 是一个拉格朗日乘子。\n\n**步骤1：确定拉格朗日乘子 $\\lambda$**\n\n平衡点，记为 $\\mathbf{M}_e$，是 $F_\\lambda$ 在某个 $\\lambda$ 值下的驻点。驻定性条件是 $\\nabla F_\\lambda(\\mathbf{M}_e) = \\mathbf{0}$。\n我们来计算 $H$ 和 $C$ 的梯度：\n$$ \\nabla H(\\mathbf{M}) = \\begin{pmatrix} \\partial H / \\partial M_1 \\\\ \\partial H / \\partial M_2 \\\\ \\partial H / \\partial M_3 \\end{pmatrix} = \\begin{pmatrix} M_1/I_1 \\\\ M_2/I_2 \\\\ M_3/I_3 \\end{pmatrix} = \\mathbb{I}^{-1} \\mathbf{M} $$\n$$ \\nabla C(\\mathbf{M}) = \\begin{pmatrix} \\partial C / \\partial M_1 \\\\ \\partial C / \\partial M_2 \\\\ \\partial C / \\partial M_3 \\end{pmatrix} = \\begin{pmatrix} M_1 \\\\ M_2 \\\\ M_3 \\end{pmatrix} = \\mathbf{M} $$\n驻定性条件为 $\\nabla H(\\mathbf{M}_e) - \\lambda \\nabla C(\\mathbf{M}_e) = \\mathbf{0}$，这等价于 $\\mathbb{I}^{-1} \\mathbf{M}_e = \\lambda \\mathbf{M}_e$。\n这是一个关于矩阵 $\\mathbb{I}^{-1}$ 的特征值问题。\n\n我们考虑形式为 $\\mathbf{M}_e = m \\mathbf{e}_k$ 的平衡点，其中 $m \\neq 0$，$\\mathbf{e}_k$ 是第 $k$ 个标准基向量（$k \\in \\{0, 1, 2\\}$ 对应于轴 1, 2, 3）。设 $I_{k+1}$ 是绕此轴的转动惯量。\n将 $\\mathbf{M}_e$ 代入条件中：\n$$ \\mathbb{I}^{-1} (m \\mathbf{e}_k) = \\lambda (m \\mathbf{e}_k) $$\n由于 $m \\neq 0$，我们可以两边除以 $m$：\n$$ \\mathbb{I}^{-1} \\mathbf{e}_k = \\lambda \\mathbf{e}_k $$\n向量 $\\mathbf{e}_k$ 是对角矩阵 $\\mathbb{I}^{-1} = \\mathrm{diag}(1/I_1, 1/I_2, 1/I_3)$ 的一个特征向量。对应的特征值是第 $k$ 个对角元素。对 $k$ 使用从0开始的索引，该特征值为 $1/I_{k+1}$。\n因此，拉格朗日乘子为 $\\lambda = 1/I_{k+1}$。\n\n**步骤2：计算 $F_\\lambda$ 的海森矩阵**\n\n标量函数 $f(\\mathbf{M})$ 的海森矩阵是二阶偏导数矩阵，其元素为 $[\\mathrm{Hess}\\, f]_{ij} = \\frac{\\partial^2 f}{\\partial M_i \\partial M_j}$。\n函数 $F_\\lambda(\\mathbf{M})$ 可以写成二次型：\n$$ F_\\lambda(\\mathbf{M}) = \\frac{1}{2} \\mathbf{M}^\\top (\\mathbb{I}^{-1} - \\lambda \\mathbf{I}) \\mathbf{M} $$\n其中 $\\mathbf{I}$ 是 $3 \\times 3$ 单位矩阵。\n对于对称矩阵 $A$，二次型 $\\frac{1}{2}\\mathbf{x}^\\top A \\mathbf{x}$ 的海森矩阵就是 $A$。\n因此，$F_\\lambda$ 的海森矩阵是一个常数矩阵（不依赖于 $\\mathbf{M}$）：\n$$ \\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e) = \\mathbb{I}^{-1} - \\lambda \\mathbf{I} = \\mathrm{diag}\\left(\\frac{1}{I_1}, \\frac{1}{I_2}, \\frac{1}{I_3}\\right) - \\frac{1}{I_{k+1}}\\mathbf{I} $$\n我们将此矩阵记为 $\\mathbf{H}_F$。\n\n**步骤3：构造标准正交基和约化二次型**\n\n稳定性分析在与余伴随轨道于 $\\mathbf{M}_e$ 处相切的切片 $\\mathcal{S}$ 上进行。余伴随轨道是 $\\|\\mathbf{M}\\|$ 恒定的球面，因此在 $\\mathbf{M}_e$ 处的切空间是与 $\\mathbf{M}_e$ 正交的平面。\n$$ \\mathcal{S} = \\{\\delta \\mathbf{M} \\in \\mathbb{R}^3 \\mid \\mathbf{M}_e^\\top \\delta \\mathbf{M} = 0\\} $$\n对于 $\\mathbf{M}_e = m \\mathbf{e}_k$，这就是与 $\\mathbf{e}_k$ 正交的平面。我们需要为这个平面构造一个通用的标准正交基 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$。\n一个通用的数值步骤如下：\n1.  定义平面的单位法向量：$\\hat{\\mathbf{n}} = \\mathbf{M}_e / \\|\\mathbf{M}_e\\| = \\mathbf{e}_k$。\n2.  选择一个不与 $\\hat{\\mathbf{n}}$ 平行的任意向量 $\\mathbf{d}$。一个数值上鲁棒的选择是挑选一个与 $\\hat{\\mathbf{n}}$ “最正交”的标准基向量。例如，如果 $\\hat{\\mathbf{n}}=\\mathbf{e}_0$，我们可以选择 $\\mathbf{d}=\\mathbf{e}_1$。\n3.  第一个基向量 $\\mathbf{v}_1$ 通过计算叉积并单位化得到：$\\mathbf{v}_1 = \\frac{\\hat{\\mathbf{n}} \\times \\mathbf{d}}{\\|\\hat{\\mathbf{n}} \\times \\mathbf{d}\\|}$。该向量保证位于平面 $\\mathcal{S}$ 内。\n4.  第二个基向量 $\\mathbf{v}_2$ 通过另一次叉积得到：$\\mathbf{v}_2 = \\hat{\\mathbf{n}} \\times \\mathbf{v}_1$。由于 $\\hat{\\mathbf{n}}$ 和 $\\mathbf{v}_1$ 是标准正交的，$\\mathbf{v}_2$ 自动成为单位向量，并构成了平面 $\\mathcal{S}$ 的标准正交基 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$。\n\n设 $V = [\\mathbf{v}_1 | \\mathbf{v}_2]$ 是一个 $3 \\times 2$ 矩阵，其列为基向量。代表 $F_\\lambda$ 在切片 $\\mathcal{S}$ 上二次变分的约化二次型由 $2 \\times 2$ 矩阵 $Q$ 给出：\n$$ Q = V^\\top \\mathbf{H}_F V $$\n$Q$ 的元素为 $q_{ij} = \\mathbf{v}_i^\\top \\mathbf{H}_F \\mathbf{v}_j$。\n\n**步骤4和5：特征值分析与分类**\n\n该二次型在切片上的定性由矩阵 $Q$ 的性质决定。由于 $Q$ 是一个实对称矩阵，我们可以根据其两个特征值 $\\mu_1$ 和 $\\mu_2$ 的符号来确定其定性。\n使用一个数值容差 $t  0$ 将特征值分类为正、负或零。\n-   如果 $\\mu_1  t$ 且 $\\mu_2  t$，则 $Q$ 是**正定**的（代码 $1$）。\n-   如果 $\\mu_1  -t$ 且 $\\mu_2  -t$，则 $Q$ 是**负定**的（代码 $-1$）。\n-   如果 $(\\mu_1  t \\text{ and } \\mu_2  -t)$ 或 $(\\mu_1  -t \\text{ and } \\mu_2  t)$，则 $Q$ 是**不定**的（代码 $0$）。\n-   在所有其他情况下，至少有一个特征值在数值上为零（即其绝对值 $\\le t$）。根据问题的定义，这些情况被分类为**半定**（代码 $2$）。这包括一个特征值为零而另一个非零，或两者都为零的情况。\n\nArnold 定理意味着，如果约化二次型 $Q$ 是定的（正定或负定），则平衡点是非线性稳定的。如果是不定的，则平衡点是不稳定的。\n下面的实现为给定的测试用例数值地执行了这些步骤。```python\nimport numpy as np\n\ndef classify_definiteness(mu1, mu2, tol):\n    \"\"\"\n    Classifies the definiteness of a 2x2 symmetric matrix based on its eigenvalues.\n\n    Args:\n        mu1 (float): First eigenvalue.\n        mu2 (float): Second eigenvalue.\n        tol (float): Tolerance for treating a value as zero.\n\n    Returns:\n        int: Classification code (1, -1, 0, 2).\n    \"\"\"\n    is_pos1 = mu1 > tol\n    is_pos2 = mu2 > tol\n    is_neg1 = mu1  -tol\n    is_neg2 = mu2  -tol\n\n    # Indefinite: eigenvalues have opposite signs.\n    if (is_pos1 and is_neg2) or (is_neg1 and is_pos2):\n        return 0\n\n    # Positive definite: both eigenvalues are strictly positive.\n    if is_pos1 and is_pos2:\n        return 1\n\n    # Negative definite: both eigenvalues are strictly negative.\n    if is_neg1 and is_neg2:\n        return -1\n\n    # Semidefinite: all other cases, where at least one eigenvalue is\n    # numerically zero and they do not have opposite signs.\n    return 2\n\ndef analyze_stability(I_diag_vals, k_axis, m_magnitude, tolerance):\n    \"\"\"\n    Performs stability analysis for a given rigid body equilibrium.\n\n    Args:\n        I_diag_vals (tuple): Principal moments of inertia (I1, I2, I3).\n        k_axis (int): Index of the equilibrium axis (0, 1, or 2).\n        m_magnitude (float): Magnitude of the angular momentum.\n        tolerance (float): Numerical tolerance for zero checks.\n\n    Returns:\n        int: The definiteness classification code.\n    \"\"\"\n    # Step 0: Setup inertia tensors\n    I_diag = np.array(I_diag_vals, dtype=float)\n    I_inv = np.diag(1.0 / I_diag)\n\n    # Step 1: Determine the Lagrange multiplier lambda\n    # Equilibrium M_e = m * e_k, where e_k is the standard basis vector.\n    # The moment of inertia for this principal axis is I_diag[k_axis].\n    lambda_val = 1.0 / I_diag[k_axis]\n\n    # Define the equilibrium angular momentum vector M_e\n    M_e = np.zeros(3)\n    M_e[k_axis] = m_magnitude\n\n    # Step 2: Compute the Hessian of the augmented function F_lambda\n    # Hess(F_lambda) = I^-1 - lambda * Identity\n    hess_F = I_inv - lambda_val * np.identity(3)\n\n    # Step 3: Construct an orthonormal basis for the slice S\n    # The slice S is the plane orthogonal to M_e. Its normal is n_hat.\n    n_hat = np.zeros(3)\n    n_hat[k_axis] = 1.0 # Normalization is trivial since M_e is along an axis\n\n    # Construct a robust orthonormal basis {v1, v2} for the slice\n    # Pick a dummy vector not parallel to n_hat.\n    dummy_vec = np.array([1.0, 0.0, 0.0])\n    if abs(np.dot(n_hat, dummy_vec)) > 1.0 - tolerance:\n        # If n_hat is parallel to [1,0,0], use [0,1,0] instead.\n        dummy_vec = np.array([0.0, 1.0, 0.0])\n\n    # v1 is orthogonal to n_hat (and in the slice)\n    v1_unnormalized = np.cross(n_hat, dummy_vec)\n    v1 = v1_unnormalized / np.linalg.norm(v1_unnormalized)\n\n    # v2 is orthogonal to both n_hat and v1, completing the basis for the slice\n    v2 = np.cross(n_hat, v1)\n    \n    # Form the basis matrix V from the column vectors v1, v2\n    V = np.column_stack((v1, v2))\n\n    # Step 4: Compute the reduced quadratic form Q\n    # Q = V^T * Hess(F_lambda) * V\n    Q_matrix = V.T @ hess_F @ V\n\n    # Step 5: Compute eigenvalues of Q and classify definiteness\n    # Use eigvalsh as Q is symmetric by construction.\n    eigenvalues = np.linalg.eigvalsh(Q_matrix)\n    mu1, mu2 = eigenvalues[0], eigenvalues[1]\n    \n    return classify_definiteness(mu1, mu2, tolerance)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # The magnitude of momentum m is arbitrary (let m=1.0) as it does not affect\n    # the definiteness of the Hessian for this quadratic system.\n    m_magnitude = 1.0\n    # A reasonable tolerance for floating-point zero checks.\n    tolerance = 1e-9\n\n    test_cases = [\n        # Case A: Stable rotation about the smallest inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 0},\n        # Case B: Stable rotation about the largest inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 2},\n        # Case C: Unstable rotation about the middle inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 1},\n        # Case D: Semidefinite (degenerate) case\n        {'I_vals': (1.0, 1.0, 2.0), 'k': 0},\n    ]\n\n    results = []\n    for case in test_cases:\n        result_code = analyze_stability(\n            case['I_vals'],\n            case['k'],\n            m_magnitude,\n            tolerance\n        )\n        results.append(result_code)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```",
            "answer": "$$\\boxed{[-1,1,0,2]}$$"
        }
    ]
}