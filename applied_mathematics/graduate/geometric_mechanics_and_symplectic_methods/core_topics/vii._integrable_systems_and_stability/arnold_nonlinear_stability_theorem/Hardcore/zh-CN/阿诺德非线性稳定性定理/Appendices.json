{
    "hands_on_practices": [
        {
            "introduction": "应用能量-卡西米尔方法的第一步是识别系统的相对平衡点。这个练习  将引导您把这些平衡态视为一个增广能量泛函的约束临界点，从而找出自由刚体的这些平衡态。您将使用拉格朗日乘子法来确定定义稳定旋转的具体条件。",
            "id": "3729734",
            "problem": "考虑在特殊正交李代数 $\\mathfrak{so}(3)^{\\ast}$ 的对偶空间上的自由刚体的哈密顿表述。设惯性张量在体坐标系中是对角的，具有不同的主转动惯量 $I_{1}$、$I_{2}$、$I_{3}$，满足 $I_{i} \\in \\mathbb{R}_{>0}$，其中 $i \\in \\{1,2,3\\}$。体角动量为 $M = (M_{1},M_{2},M_{3}) \\in \\mathfrak{so}(3)^{\\ast} \\cong \\mathbb{R}^{3}$。哈密顿量是动能\n$$\nH(M) = \\frac{1}{2} \\left( \\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}} \\right).\n$$\n$\\mathfrak{so}(3)^{\\ast}$ 的余伴随轨道是角动量大小恒定的球面。考虑球面叶\n$$\nS_{m} = \\{\\, M \\in \\mathbb{R}^{3} \\mid C(M) = m^{2} \\,\\}, \\quad \\text{其中} \\quad C(M) = |M|^{2} = M_{1}^{2} + M_{2}^{2} + M_{3}^{2},\n$$\n且 $m \\in \\mathbb{R}_{>0}$ 是固定的。定义增广泛函\n$$\nF_{\\lambda}(M) = H(M) + \\lambda\\, C(M),\n$$\n其中 $\\lambda \\in \\mathbb{R}$ 是一个拉格朗日乘子。\n\n从光滑子流形上约束临界点的第一性原理（拉格朗日乘子法）和上述定义出发，完成以下任务：\n\n-   用 $M_{1}$、$M_{2}$、$M_{3}$、$I_{1}$、$I_{2}$、$I_{3}$ 和 $\\lambda$ 计算 $F_{\\lambda}(M)$ 的显式表达式。\n-   确定 $\\lambda$ 的值，使得绕第三主轴的稳定转动\n$$\nM^{\\ast} = m\\, e_{3} = (0,0,m),\n$$\n是 $F_{\\lambda}$ 在限制于球面 $S_{m}$ 上的临界点。\n\n你的最终答案必须是所求 $\\lambda$ 的单个闭式解析表达式。你不需要在最终答案中报告 $F_{\\lambda}$。不需要进行数值代入。",
            "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   **系统**：在 $\\mathfrak{so}(3)^{\\ast}$ 上的哈密顿表述下的自由刚体。\n-   **惯性张量**：对角张量，具有不同的主转动惯量 $I_{1}$、$I_{2}$、$I_{3}$，满足 $I_{i} \\in \\mathbb{R}_{>0}$，其中 $i \\in \\{1,2,3\\}$。\n-   **角动量**：$M = (M_{1},M_{2},M_{3}) \\in \\mathfrak{so}(3)^{\\ast} \\cong \\mathbb{R}^{3}$。\n-   **哈密顿量**：$H(M) = \\frac{1}{2} \\left( \\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}} \\right)$。\n-   **余伴随轨道（卡西米尔函数水平集）**：球面叶 $S_{m} = \\{\\, M \\in \\mathbb{R}^{3} \\mid C(M) = m^{2} \\,\\}$。\n-   **卡西米尔函数**：$C(M) = |M|^{2} = M_{1}^{2} + M_{2}^{2} + M_{3}^{2}$，其中 $m \\in \\mathbb{R}_{>0}$ 是固定的。\n-   **增广泛函**：$F_{\\lambda}(M) = H(M) + \\lambda\\, C(M)$，其中 $\\lambda \\in \\mathbb{R}$。\n-   **关注点**：绕第三主轴的稳定转动，$M^{\\ast} = m\\, e_{3} = (0,0,m)$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学严谨性且提法恰当。\n-   **科学依据**：该问题描述了自由刚体的哈密顿力学，这是经典力学和几何力学中的一个典型课题。哈密顿量、$\\mathfrak{so}(3)$ 的余伴随轨道（即球面）以及增广泛函（能量-卡西米尔泛函）的使用都是 Arnold 稳定性方法的标准元素。整个设置完全符合已建立的物理和数学原理。\n-   **提法恰当性**：该问题是自洽的。所有必要的函数（$H$、$C$）和变量都有明确定义。任务是找到一个特定的参数 $\\lambda$，使其满足一个明确的数学条件（使一个特定点成为临界点）。这会导出一个唯一的解。\n-   **客观性**：该问题以精确、无歧义的数学语言陈述，不含任何主观或非形式化内容。\n\n未发现任何缺陷。该问题是应用能量-卡西米尔方法进行稳定性分析的一个标准练习。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供解答。\n\n目标是找到参数 $\\lambda$ 的值，使得特定构型 $M^{\\ast} = (0,0,m)$ 是哈密顿量 $H(M)$ 在限制于球面 $S_m$ 上的临界点。拉格朗日乘子法指出，这个条件等价于找到 $\\lambda$ 使得 $M^{\\ast}$ 是增广泛函 $F_{\\lambda}(M) = H(M) + \\lambda C(M)$ 的无约束临界点。如果函数在该点的梯度为零，则该点是一个无约束临界点。\n\n首先，我们通过代入 $H(M)$ 和 $C(M)$ 的定义，写出增广泛函 $F_{\\lambda}(M)$ 的显式表达式：\n$$\nF_{\\lambda}(M) = \\frac{1}{2} \\left( \\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}} \\right) + \\lambda (M_{1}^{2} + M_{2}^{2} + M_{3}^{2})\n$$\n我们可以按 $M$ 的分量重新组合各项：\n$$\nF_{\\lambda}(M) = \\left(\\frac{1}{2I_{1}} + \\lambda\\right)M_{1}^{2} + \\left(\\frac{1}{2I_{2}} + \\lambda\\right)M_{2}^{2} + \\left(\\frac{1}{2I_{3}} + \\lambda\\right)M_{3}^{2}\n$$\n$M^{\\ast}$ 是 $F_{\\lambda}(M)$ 的临界点的条件是 $F_{\\lambda}$ 在 $M^{\\ast}$ 处的梯度必须为零向量：\n$$\n\\nabla F_{\\lambda}(M^{\\ast}) = 0\n$$\n$F_{\\lambda}(M)$ 关于 $M=(M_1, M_2, M_3)$ 的梯度由偏导数向量给出：\n$$\n\\nabla F_{\\lambda}(M) = \\left( \\frac{\\partial F_{\\lambda}}{\\partial M_{1}}, \\frac{\\partial F_{\\lambda}}{\\partial M_{2}}, \\frac{\\partial F_{\\lambda}}{\\partial M_{3}} \\right)\n$$\n我们计算梯度的每个分量：\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{1}} = 2 \\left(\\frac{1}{2I_{1}} + \\lambda\\right) M_{1} = \\left(\\frac{1}{I_{1}} + 2\\lambda\\right) M_{1}\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{2}} = 2 \\left(\\frac{1}{2I_{2}} + \\lambda\\right) M_{2} = \\left(\\frac{1}{I_{2}} + 2\\lambda\\right) M_{2}\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{3}} = 2 \\left(\\frac{1}{2I_{3}} + \\lambda\\right) M_{3} = \\left(\\frac{1}{I_{3}} + 2\\lambda\\right) M_{3}\n$$\n现在，我们在关注的特定点 $M^{\\ast} = (0,0,m)$ 处计算该梯度：\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{1}}\\bigg|_{M=M^{\\ast}} = \\left(\\frac{1}{I_{1}} + 2\\lambda\\right) (0) = 0\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{2}}\\bigg|_{M=M^{\\ast}} = \\left(\\frac{1}{I_{2}} + 2\\lambda\\right) (0) = 0\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{3}}\\bigg|_{M=M^{\\ast}} = \\left(\\frac{1}{I_{3}} + 2\\lambda\\right) (m)\n$$\n为使梯度向量在 $M^{\\ast}$ 处为零，其所有分量都必须为零。前两个分量恒为零。第三个分量给出以下方程：\n$$\nm \\left(\\frac{1}{I_{3}} + 2\\lambda\\right) = 0\n$$\n根据问题陈述，$m \\in \\mathbb{R}_{>0}$，这意味着 $m \\neq 0$。因此，要使乘积为零，另一个因子必须为零：\n$$\n\\frac{1}{I_{3}} + 2\\lambda = 0\n$$\n解此方程求 $\\lambda$，我们得到：\n$$\n2\\lambda = -\\frac{1}{I_{3}}\n$$\n$$\n\\lambda = -\\frac{1}{2I_{3}}\n$$\n这就是使得绕第三主轴的稳定转动成为该约束系统临界点所需的拉格朗日乘子 $\\lambda$ 的值。",
            "answer": "$$\n\\boxed{-\\frac{1}{2I_{3}}}\n$$"
        },
        {
            "introduction": "一旦确定了平衡点，就必须判断其稳定性。这个练习  将带您进入阿诺德定理的核心，通过分析能量-卡西米尔泛函的二阶变分来进行稳定性分析。通过计算约束下的黑塞矩阵的符号差，您将直接判断绕中间主轴旋转的平衡点是稳定还是不稳定的。",
            "id": "3729747",
            "problem": "考虑特殊正交群 (SO(3)) 的李代数的对偶上的约化自由刚体，该刚体在具有坐标 $M = (M_{1}, M_{2}, M_{3})$ 的向量空间 $\\mathbb{R}^{3}$ 上建模。$\\mathbb{R}^{3}$ 上的函数 $F, G$ 的李-泊松括号定义为 $\\{F,G\\}(M) = - M \\cdot (\\nabla F(M) \\times \\nabla G(M))$，余伴随轨道是赋有 Kirillov–Kostant–Souriau 辛结构的球面 $|M| = \\text{常数}$。哈密顿量为\n$$\nH(M) = \\frac{1}{2}\\left(\\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}}\\right),\n$$\n其中 $I_{1}, I_{2}, I_{3} > 0$ 是互不相同的主转动惯量，其排序为 $I_{1}  I_{2}  I_{3}$。函数\n$$\nC(M) = |M|^{2} = M_{1}^{2} + M_{2}^{2} + M_{3}^{2}\n$$\n是一个卡西米尔不变量（李-泊松动力学的一个运动常数）。设 $M_{0} = \\mu\\, e_{2} = (0, \\mu, 0)$，其中 $\\mu \\neq 0$ 为某个固定值，这对应于绕与 $I_{2}$ 相关的轴的定常转动。\n\n从一阶和二阶变分以及标准欧几里得梯度和黑塞矩阵的定义出发，确定标量 $\\lambda$，使得 $M_{0}$ 是约束泛函 $F(M) = H(M) - \\lambda\\, C(M)$ 的一个临界点。显式计算作为对称双线性形式的二阶变分 $D^{2}F(M_{0})$，并确定其限制在约束子空间 $T_{M_{0}}\\mathcal{O}$ 上的符号差，其中 $\\mathcal{O}$ 是通过 $M_{0}$ 的余伴随轨道（等价于球面 $|M| = |M_{0}|$)，因此 $T_{M_{0}}\\mathcal{O} = \\{ \\delta M \\in \\mathbb{R}^{3} \\,:\\, \\delta M \\cdot M_{0} = 0 \\}$。\n\n以有序对 $(n_{+}, n_{-})$ 的形式给出符号差，其中 $n_{+}$ 是 $D^{2}F(M_{0})$ 限制在 $T_{M_{0}}\\mathcal{O}$ 上的正方向数量，$n_{-}$ 是负方向数量。你的最终答案必须仅为这个有序对。",
            "solution": "我们从 $\\mathbb{R}^{3}$ 上光滑函数的欧几里得梯度和黑塞矩阵的定义开始。对于哈密顿量\n$$\nH(M) = \\frac{1}{2}\\left(\\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}}\\right),\n$$\n其梯度和黑塞矩阵为\n$$\n\\nabla H(M) = \\left(\\frac{M_{1}}{I_{1}}, \\frac{M_{2}}{I_{2}}, \\frac{M_{3}}{I_{3}}\\right), \\quad D^{2}H(M) = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}}, \\frac{1}{I_{2}}, \\frac{1}{I_{3}}\\right).\n$$\n对于卡西米尔不变量\n$$\nC(M) = M_{1}^{2} + M_{2}^{2} + M_{3}^{2},\n$$\n我们有\n$$\n\\nabla C(M) = \\left(2 M_{1}, 2 M_{2}, 2 M_{3}\\right), \\quad D^{2}C(M) = 2\\, I_{3 \\times 3},\n$$\n其中 $I_{3 \\times 3}$ 是 $3 \\times 3$ 单位矩阵。\n\n定义约束泛函\n$$\nF(M) = H(M) - \\lambda\\, C(M).\n$$\n其梯度和黑塞矩阵为\n$$\n\\nabla F(M) = \\nabla H(M) - \\lambda\\, \\nabla C(M), \\quad D^{2}F(M) = D^{2}H(M) - \\lambda\\, D^{2}C(M).\n$$\n计算在 $M_{0} = (0, \\mu, 0)$ 处的一阶变分：\n$$\n\\nabla F(M_{0}) = \\left(0, \\frac{\\mu}{I_{2}}, 0\\right) - \\lambda\\, \\left(0, 2\\mu, 0\\right) = \\left(0, \\mu\\left(\\frac{1}{I_{2}} - 2\\lambda\\right), 0\\right).\n$$\n临界点条件 $\\nabla F(M_{0}) = 0$ 得出\n$$\n\\lambda = \\frac{1}{2 I_{2}}.\n$$\n\n接下来计算在 $M_{0}$ 处的二阶变分：\n$$\nD^{2}F(M_{0}) = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}}, \\frac{1}{I_{2}}, \\frac{1}{I_{3}}\\right) - \\frac{1}{2 I_{2}} \\cdot 2\\, I_{3 \\times 3} = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}} - \\frac{1}{I_{2}}, 0, \\frac{1}{I_{3}} - \\frac{1}{I_{2}}\\right).\n$$\n约束子空间是通过 $M_{0}$ 的余伴随轨道的切空间，该轨道即球面 $|M| = |M_{0}|$。其在 $M_{0}$ 处的切空间为\n$$\nT_{M_{0}}\\mathcal{O} = \\left\\{ \\delta M \\in \\mathbb{R}^{3} \\;:\\; \\delta M \\cdot M_{0} = 0 \\right\\} = \\left\\{ (\\delta M_{1}, \\delta M_{2}, \\delta M_{3}) \\;:\\; \\mu\\, \\delta M_{2} = 0 \\right\\}.\n$$\n由于 $\\mu \\neq 0$，约束为 $\\delta M_{2} = 0$，所以 $T_{M_{0}}\\mathcal{O}$ 由坐标方向 $e_{1}$ 和 $e_{3}$ 张成。\n\n将 $D^{2}F(M_{0})$ 限制在 $T_{M_{0}}\\mathcal{O}$ 上，得出对角元为如下的对角形式\n$$\n\\lambda_{1} = \\frac{1}{I_{1}} - \\frac{1}{I_{2}}, \\quad \\lambda_{3} = \\frac{1}{I_{3}} - \\frac{1}{I_{2}}.\n$$\n使用排序 $I_{1}  I_{2}  I_{3}$，我们有\n$$\n\\frac{1}{I_{1}} - \\frac{1}{I_{2}} = \\frac{I_{2} - I_{1}}{I_{1} I_{2}}  0, \\quad \\frac{1}{I_{3}} - \\frac{1}{I_{2}} = \\frac{I_{2} - I_{3}}{I_{2} I_{3}}  0.\n$$\n因此，限制后的二阶变分是不定的，有一个正方向和一个负方向。在 $T_{M_{0}}\\mathcal{O}$ 上的符号差是\n$$\n(n_{+}, n_{-}) = (1, 1).\n$$",
            "answer": "$$\\boxed{(1, 1)}$$"
        },
        {
            "introduction": "虽然解析方法能提供深刻的洞察，但数值工具对于实际应用和探索复杂系统至关重要。这个动手编程练习  要求您以算法方式实现能量-卡西米尔稳定性测试。通过将识别平衡点和测试二阶变分定性的解析步骤转化为代码，您将构建一个强大的工具来对刚体主轴旋转的稳定性进行分类。",
            "id": "3729741",
            "problem": "考虑自由刚体作为一个典型的李-泊松哈密顿系统。设位形群为特殊正交群 $\\mathrm{SO}(3)$，状态变量为物体角动量 $\\mathbf{M} \\in \\mathbb{R}^3 \\cong \\mathfrak{so}(3)^* $。哈密顿量由 $H(\\mathbf{M}) = \\tfrac{1}{2} \\mathbf{M}^{\\top} \\mathbb{I}^{-1} \\mathbf{M}$ 给出，其中 $\\mathbb{I} = \\mathrm{diag}(I_1, I_2, I_3)$ 是对角惯性矩阵，其主转动惯量 $I_1, I_2, I_3$ 严格为正。李-泊松动力学保持卡西米尔函数 $C(\\mathbf{M}) = \\tfrac{1}{2} \\|\\mathbf{M}\\|^2$ 不变，且余伴随轨道是常数 $C$ 的球面。Arnold 的非线性稳定性定理指出，如果增广能量在穿过余伴随轨道的合适切片上的二次变分是定号的，则该平衡点是非线性稳定的。\n\n从以下基本定义出发：\n- 哈密顿量 $H(\\mathbf{M}) = \\tfrac{1}{2} \\mathbf{M}^{\\top} \\mathbb{I}^{-1} \\mathbf{M}$，\n- 卡西米尔函数 $C(\\mathbf{M}) = \\tfrac{1}{2} \\|\\mathbf{M}\\|^2$，\n- 能量-卡西米尔方法 (ECM)：考虑增广函数 $F_\\lambda(\\mathbf{M}) = H(\\mathbf{M}) - \\lambda C(\\mathbf{M})$，其中 $\\lambda \\in \\mathbb{R}$ 的选择使得在平衡点 $\\mathbf{M}_e$ 处有 $\\nabla F_\\lambda(\\mathbf{M}_e) = \\mathbf{0}$，\n\n你的任务是实现一种数值方法，以检验 $F_\\lambda$ 的约化二次型在与余伴随轨道于 $\\mathbf{M}_e$ 点相切的切片上的定号性。具体而言：\n\n1. 考虑平衡点 $\\mathbf{M}_e$ 与主轴对齐的情况：$\\mathbf{M}_e = m \\mathbf{e}_k$，其中 $\\mathbf{e}_k$ 是 $\\mathbb{R}^3$ 的第 $k$ 个标准基向量，$m \\in \\mathbb{R}$，且 $k \\in \\{0,1,2\\}$ 分别对应与 $I_1, I_2, I_3$ 相关的轴。根据平稳性条件 $\\nabla H(\\mathbf{M}_e) = \\lambda \\nabla C(\\mathbf{M}_e)$ 确定拉格朗日乘子 $\\lambda$。\n\n2. 计算 $F_\\lambda$ 在 $\\mathbf{M}_e$ 处的海森矩阵，记为 $\\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e)$。不要使用任何已知的快捷公式进行简化；从 $H$ 和 $C$ 的定义推导出 $\\mathrm{Hess}\\, F_\\lambda$。\n\n3. 将切片定义为余伴随轨道在 $\\mathbf{M}_e$ 处的切空间，即与 $\\mathbf{M}_e$ 正交的子空间：$\\mathcal{S} = \\{\\delta \\mathbf{M} \\in \\mathbb{R}^3 \\mid \\mathbf{M}_e^{\\top} \\delta \\mathbf{M} = 0\\}$。为 $\\mathcal{S}$ 构建一个标准正交基 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$，不使用任何特殊情况的简化。利用此基，计算约化二次型 $Q$ 为对称 $2 \\times 2$ 矩阵 $Q = [q_{ij}]$，其元素为 $q_{ij} = \\mathbf{v}_i^{\\top} \\big(\\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e)\\big) \\mathbf{v}_j$。\n\n4. 计算 $Q$ 的特征值，并通过检验其符号来确定定号性类型：\n   - 如果两个特征值都严格为正，则为正定。\n   - 如果两个特征值都严格为负，则为负定。\n   - 如果至少一个特征值在数值上为零（在指定容差范围内），而另一个非零但符号不相反，则为半定。\n   - 如果特征值符号相反，则为不定。\n\n5. 实现一种带有容差阈值 $t  0$ 的稳健数值分类方法，用于判断一个值何时可被视为零（你必须选择一个合理的 $t$）。将每个测试用例的定号性类型报告为一个整数代码：\n   - $1$ 代表正定，\n   - $-1$ 代表负定，\n   - $2$ 代表半定，\n   - $0$ 代表不定。\n\n你的程序必须使用以下参数值的测试套件：\n- 案例 A（绕最小惯量轴的通用稳定情况）：$I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 0$。\n- 案例 B（绕最大惯量轴的通用稳定情况）：$I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 2$。\n- 案例 C（绕中间惯量轴的通用不稳定情况）：$I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 1$。\n- 案例 D（边界半定情况）：$I_1 = 1.0$, $I_2 = 1.0$, $I_3 = 2.0$, $k = 0$。\n\n你的程序必须生成单行输出，其中包含这四个案例的分类结果，以逗号分隔的列表形式包含在方括号内，无空格，并按 A、B、C、D 的顺序排列。例如，如果分类结果为 $a$、$b$、$c$、$d$，则输出格式必须为 $[a,b,c,d]$。此问题不涉及物理单位，也未出现角度，因此无需指定单位。程序必须是完整的，并且无需用户输入即可运行。",
            "solution": "该问题要求实现能量-卡西米尔方法，以检验自由刚体平衡点的非线性稳定性。稳定性由增广哈密顿量在特定子空间上的二次变分的定号性决定。我们将遵循指定的步骤推导必要的数学量，然后实现一个数值测试。\n\n设状态为角动量向量 $\\mathbf{M} = (M_1, M_2, M_3)^\\top \\in \\mathbb{R}^3$。惯性矩阵为 $\\mathbb{I} = \\mathrm{diag}(I_1, I_2, I_3)$，其中 $I_1, I_2, I_3  0$。\n\n哈密顿量由 $H(\\mathbf{M}) = \\frac{1}{2} \\mathbf{M}^\\top \\mathbb{I}^{-1} \\mathbf{M} = \\frac{1}{2}\\left(\\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3}\\right)$ 给出。\n卡西米尔函数为 $C(\\mathbf{M}) = \\frac{1}{2} \\|\\mathbf{M}\\|^2 = \\frac{1}{2} \\mathbf{M}^\\top \\mathbf{M} = \\frac{1}{2}(M_1^2 + M_2^2 + M_3^2)$。\n\n增广函数为 $F_\\lambda(\\mathbf{M}) = H(\\mathbf{M}) - \\lambda C(\\mathbf{M})$，其中 $\\lambda$ 是一个拉格朗日乘子。\n\n**步骤 1：确定拉格朗日乘子 $\\lambda$**\n\n平衡点（记为 $\\mathbf{M}_e$）是 $F_\\lambda$ 对于某个 $\\lambda$ 的平稳点。平稳性条件为 $\\nabla F_\\lambda(\\mathbf{M}_e) = \\mathbf{0}$。\n我们来计算 $H$ 和 $C$ 的梯度：\n$$ \\nabla H(\\mathbf{M}) = \\begin{pmatrix} \\partial H / \\partial M_1 \\\\ \\partial H / \\partial M_2 \\\\ \\partial H / \\partial M_3 \\end{pmatrix} = \\begin{pmatrix} M_1/I_1 \\\\ M_2/I_2 \\\\ M_3/I_3 \\end{pmatrix} = \\mathbb{I}^{-1} \\mathbf{M} $$\n$$ \\nabla C(\\mathbf{M}) = \\begin{pmatrix} \\partial C / \\partial M_1 \\\\ \\partial C / \\partial M_2 \\\\ \\partial C / \\partial M_3 \\end{pmatrix} = \\begin{pmatrix} M_1 \\\\ M_2 \\\\ M_3 \\end{pmatrix} = \\mathbf{M} $$\n平稳性条件为 $\\nabla H(\\mathbf{M}_e) - \\lambda \\nabla C(\\mathbf{M}_e) = \\mathbf{0}$，可化为 $\\mathbb{I}^{-1} \\mathbf{M}_e = \\lambda \\mathbf{M}_e$。这是一个关于矩阵 $\\mathbb{I}^{-1}$ 的特征值问题。\n\n我们考虑形式为 $\\mathbf{M}_e = m \\mathbf{e}_k$ 的平衡点，其中 $m \\neq 0$，$\\mathbf{e}_k$ 是第 $k$ 个标准基向量（$k \\in \\{0, 1, 2\\}$ 对应轴 1、2、3）。设 $I_{k+1}$ 是绕该轴的转动惯量。\n将 $\\mathbf{M}_e$ 代入条件中：\n$$ \\mathbb{I}^{-1} (m \\mathbf{e}_k) = \\lambda (m \\mathbf{e}_k) $$\n由于 $m \\neq 0$，我们可以除以 $m$：\n$$ \\mathbb{I}^{-1} \\mathbf{e}_k = \\lambda \\mathbf{e}_k $$\n向量 $\\mathbf{e}_k$ 是对角矩阵 $\\mathbb{I}^{-1} = \\mathrm{diag}(1/I_1, 1/I_2, 1/I_3)$ 的一个特征向量。对应的特征值是第 $k$ 个对角元素。对 $k$ 使用从 0 开始的索引，该值为 $1/I_{k+1}$。\n因此，拉格朗日乘子为 $\\lambda = 1/I_{k+1}$。\n\n**步骤 2：计算 $F_\\lambda$ 的海森矩阵**\n\n标量函数 $f(\\mathbf{M})$ 的海森矩阵是二阶偏导数矩阵，$[\\mathrm{Hess}\\, f]_{ij} = \\frac{\\partial^2 f}{\\partial M_i \\partial M_j}$。\n函数 $F_\\lambda(\\mathbf{M})$ 可以写成一个二次型：\n$$ F_\\lambda(\\mathbf{M}) = \\frac{1}{2} \\mathbf{M}^\\top (\\mathbb{I}^{-1} - \\lambda \\mathbf{I}) \\mathbf{M} $$\n其中 $\\mathbf{I}$ 是 $3 \\times 3$ 单位矩阵。\n二次型 $\\frac{1}{2}\\mathbf{x}^\\top A \\mathbf{x}$（对于对称矩阵 $A$）的海森矩阵就是 $A$。\n因此，$F_\\lambda$ 的海森矩阵是常数（不依赖于 $\\mathbf{M}$）：\n$$ \\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e) = \\mathbb{I}^{-1} - \\lambda \\mathbf{I} = \\mathrm{diag}\\left(\\frac{1}{I_1}, \\frac{1}{I_2}, \\frac{1}{I_3}\\right) - \\frac{1}{I_{k+1}}\\mathbf{I} $$\n我们用 $\\mathbf{H}_F$ 表示这个矩阵。\n\n**步骤 3：构造标准正交基和约化二次型**\n\n稳定性分析是在与余伴随轨道在 $\\mathbf{M}_e$ 处相切的切片 $\\mathcal{S}$ 上进行的。余伴随轨道是常数 $\\|\\mathbf{M}\\|$ 的球面，因此在 $\\mathbf{M}_e$ 处的切空间是与 $\\mathbf{M}_e$ 正交的平面。\n$$ \\mathcal{S} = \\{\\delta \\mathbf{M} \\in \\mathbb{R}^3 \\mid \\mathbf{M}_e^\\top \\delta \\mathbf{M} = 0\\} $$\n对于 $\\mathbf{M}_e = m \\mathbf{e}_k$，这就是与 $\\mathbf{e}_k$ 正交的平面。我们需要为这个平面构造一个通用的标准正交基 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$。\n一个通用的数值步骤如下：\n1.  定义平面的单位法向量：$\\hat{\\mathbf{n}} = \\mathbf{M}_e / \\|\\mathbf{M}_e\\| = \\mathbf{e}_k$。\n2.  选择一个不与 $\\hat{\\mathbf{n}}$ 平行的任意向量 $\\mathbf{d}$。一个数值上稳健的选择是选取与 $\\hat{\\mathbf{n}}$ “最正交”的标准基向量。例如，如果 $\\hat{\\mathbf{n}}=\\mathbf{e}_0$，我们可以选择 $\\mathbf{d}=\\mathbf{e}_1$。\n3.  第一个基向量 $\\mathbf{v}_1$ 通过计算叉积并归一化得到：$\\mathbf{v}_1 = \\frac{\\hat{\\mathbf{n}} \\times \\mathbf{d}}{\\|\\hat{\\mathbf{n}} \\times \\mathbf{d}\\|}$。该向量保证在平面 $\\mathcal{S}$ 内。\n4.  第二个基向量 $\\mathbf{v}_2$ 通过另一次叉积得到：$\\mathbf{v}_2 = \\hat{\\mathbf{n}} \\times \\mathbf{v}_1$。由于 $\\hat{\\mathbf{n}}$ 和 $\\mathbf{v}_1$ 是标准正交的，$\\mathbf{v}_2$ 自动成为单位向量，并构成了平面 $\\mathcal{S}$ 的标准正交基 $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$。\n\n设 $V = [\\mathbf{v}_1 | \\mathbf{v}_2]$ 是一个 $3 \\times 2$ 矩阵，其列为基向量。代表 $F_\\lambda$ 在切片 $\\mathcal{S}$ 上二次变分的约化二次型由 $2 \\times 2$ 矩阵 $Q$ 给出：\n$$ Q = V^\\top \\mathbf{H}_F V $$\n$Q$ 的元素为 $q_{ij} = \\mathbf{v}_i^\\top \\mathbf{H}_F \\mathbf{v}_j$。\n\n**步骤 4 和 5：特征值分析与分类**\n\n切片上二次型的定号性由矩阵 $Q$ 的性质决定。由于 $Q$ 是一个实对称矩阵，我们可以根据其两个特征值 $\\mu_1$ 和 $\\mu_2$ 的符号来确定其定号性。\n使用一个数值容差 $t  0$ 来将特征值分类为正、负或零。\n-   如果 $\\mu_1  t$ 且 $\\mu_2  t$，则 $Q$ 是**正定**（代码 $1$）。\n-   如果 $\\mu_1  -t$ 且 $\\mu_2  -t$，则 $Q$ 是**负定**（代码 $-1$）。\n-   如果 $(\\mu_1  t \\text{ 且 } \\mu_2  -t)$ 或 $(\\mu_1  -t \\text{ 且 } \\mu_2  t)$，则 $Q$ 是**不定**（代码 $0$）。\n-   在所有其他情况下，至少有一个特征值在数值上为零（即其绝对值 $\\le t$）。根据问题的定义，这些情况被分类为**半定**（代码 $2$）。这包括一个特征值为零而另一个非零，或两者都为零的情况。\n\nArnold 定理意味着，如果约化二次型 $Q$ 是定号的（正定或负定），则平衡点是非线性稳定的。如果是不定的，则平衡点是不稳定的。\n下面的实现为给定的测试用例数值化地执行了这些步骤。",
            "answer": "```python\nimport numpy as np\n\ndef classify_definiteness(mu1, mu2, tol):\n    \"\"\"\n    Classifies the definiteness of a 2x2 symmetric matrix based on its eigenvalues.\n\n    Args:\n        mu1 (float): First eigenvalue.\n        mu2 (float): Second eigenvalue.\n        tol (float): Tolerance for treating a value as zero.\n\n    Returns:\n        int: Classification code (1, -1, 0, 2).\n    \"\"\"\n    is_pos1 = mu1  tol\n    is_pos2 = mu2  tol\n    is_neg1 = mu1  -tol\n    is_neg2 = mu2  -tol\n\n    # Indefinite: eigenvalues have opposite signs.\n    if (is_pos1 and is_neg2) or (is_neg1 and is_pos2):\n        return 0\n\n    # Positive definite: both eigenvalues are strictly positive.\n    if is_pos1 and is_pos2:\n        return 1\n\n    # Negative definite: both eigenvalues are strictly negative.\n    if is_neg1 and is_neg2:\n        return -1\n\n    # Semidefinite: all other cases, where at least one eigenvalue is\n    # numerically zero and they do not have opposite signs.\n    return 2\n\ndef analyze_stability(I_diag_vals, k_axis, m_magnitude, tolerance):\n    \"\"\"\n    Performs stability analysis for a given rigid body equilibrium.\n\n    Args:\n        I_diag_vals (tuple): Principal moments of inertia (I1, I2, I3).\n        k_axis (int): Index of the equilibrium axis (0, 1, or 2).\n        m_magnitude (float): Magnitude of the angular momentum.\n        tolerance (float): Numerical tolerance for zero checks.\n\n    Returns:\n        int: The definiteness classification code.\n    \"\"\"\n    # Step 0: Setup inertia tensors\n    I_diag = np.array(I_diag_vals, dtype=float)\n    I_inv = np.diag(1.0 / I_diag)\n\n    # Step 1: Determine the Lagrange multiplier lambda\n    # Equilibrium M_e = m * e_k, where e_k is the standard basis vector.\n    # The moment of inertia for this principal axis is I_diag[k_axis].\n    lambda_val = 1.0 / I_diag[k_axis]\n\n    # Define the equilibrium angular momentum vector M_e\n    M_e = np.zeros(3)\n    M_e[k_axis] = m_magnitude\n\n    # Step 2: Compute the Hessian of the augmented function F_lambda\n    # Hess(F_lambda) = I^-1 - lambda * Identity\n    hess_F = I_inv - lambda_val * np.identity(3)\n\n    # Step 3: Construct an orthonormal basis for the slice S\n    # The slice S is the plane orthogonal to M_e. Its normal is n_hat.\n    n_hat = np.zeros(3)\n    n_hat[k_axis] = 1.0 # Normalization is trivial since M_e is along an axis\n\n    # Construct a robust orthonormal basis {v1, v2} for the slice\n    # Pick a dummy vector not parallel to n_hat.\n    dummy_vec = np.array([1.0, 0.0, 0.0])\n    if abs(np.dot(n_hat, dummy_vec))  1.0 - tolerance:\n        # If n_hat is parallel to [1,0,0], use [0,1,0] instead.\n        dummy_vec = np.array([0.0, 1.0, 0.0])\n\n    # v1 is orthogonal to n_hat (and in the slice)\n    v1_unnormalized = np.cross(n_hat, dummy_vec)\n    v1 = v1_unnormalized / np.linalg.norm(v1_unnormalized)\n\n    # v2 is orthogonal to both n_hat and v1, completing the basis for the slice\n    v2 = np.cross(n_hat, v1)\n    \n    # Form the basis matrix V from the column vectors v1, v2\n    V = np.column_stack((v1, v2))\n\n    # Step 4: Compute the reduced quadratic form Q\n    # Q = V^T * Hess(F_lambda) * V\n    Q_matrix = V.T @ hess_F @ V\n\n    # Step 5: Compute eigenvalues of Q and classify definiteness\n    # Use eigvalsh as Q is symmetric by construction.\n    eigenvalues = np.linalg.eigvalsh(Q_matrix)\n    mu1, mu2 = eigenvalues[0], eigenvalues[1]\n    \n    return classify_definiteness(mu1, mu2, tolerance)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # The magnitude of momentum m is arbitrary (let m=1.0) as it does not affect\n    # the definiteness of the Hessian for this quadratic system.\n    m_magnitude = 1.0\n    # A reasonable tolerance for floating-point zero checks.\n    tolerance = 1e-9\n\n    test_cases = [\n        # Case A: Stable rotation about the smallest inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 0},\n        # Case B: Stable rotation about the largest inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 2},\n        # Case C: Unstable rotation about the middle inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 1},\n        # Case D: Semidefinite (degenerate) case\n        {'I_vals': (1.0, 1.0, 2.0), 'k': 0},\n    ]\n\n    results = []\n    for case in test_cases:\n        result_code = analyze_stability(\n            case['I_vals'],\n            case['k'],\n            m_magnitude,\n            tolerance\n        )\n        results.append(result_code)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}