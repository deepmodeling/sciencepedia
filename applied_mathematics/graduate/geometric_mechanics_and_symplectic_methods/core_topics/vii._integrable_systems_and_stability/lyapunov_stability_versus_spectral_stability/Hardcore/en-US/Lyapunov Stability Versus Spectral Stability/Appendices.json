{
    "hands_on_practices": [
        {
            "introduction": "The relationship between the stability of a linear system and its nonlinear counterpart is subtle. This first exercise provides a canonical counterexample where a spectrally stable linearization gives a misleading picture of the true dynamics. By analyzing a simple non-Hamiltonian system, you will prove from first principles that trajectories can escape to infinity, demonstrating that spectral stability is not, in general, sufficient for Lyapunov stability .",
            "id": "3755022",
            "problem": "Let $\\left(\\mathbb{R}^{2},\\omega\\right)$ be the standard symplectic plane with canonical symplectic form $\\omega = dq \\wedge dp$ and canonical symplectic matrix $J = \\begin{pmatrix}0  1 \\\\ -1  0 \\end{pmatrix}$. Consider the smooth autonomous ordinary differential equation (ODE)\n$$\n\\dot{x} = f(x), \\quad x = \\begin{pmatrix}q \\\\ p\\end{pmatrix}, \\quad f(x) = J x + \\left(q^{2} + p^{2}\\right) x,\n$$\nwith the equilibrium point $x_{e} = 0$. This system is the sum of the linear Hamiltonian rotation generated by the quadratic Hamiltonian $H_{2}(q,p) = \\tfrac{1}{2}\\left(q^{2} + p^{2}\\right)$ and a nonlinear radial cubic term that is not Hamiltonian with respect to $\\omega$.\n\nStarting from the core definitions of Lyapunov stability and spectral stability, and without relying on any specialized theorems, proceed as follows:\n\n1. Compute the Jacobian $D f(0)$ and its eigenvalues to verify that the linearization is spectrally stable at $x_{e} = 0$ (all eigenvalues lie on the imaginary axis).\n2. Using only first principles and fundamental definitions, derive an exact scalar evolution equation for the radius $r(t) = \\sqrt{q(t)^{2} + p(t)^{2}}$ along trajectories.\n3. For initial data $x(0)$ with $|x(0)| = r_{0} \\in (0,\\epsilon)$, determine the exact first exit time $T_{\\epsilon}(r_{0})$ at which the solution satisfies $|x(T_{\\epsilon}(r_{0}))| = \\epsilon$. Express $T_{\\epsilon}(r_{0})$ as a closed-form analytic expression in terms of $r_{0}$ and $\\epsilon$.\n4. Briefly explain how your calculation provides a counterexample demonstrating that spectral stability of the linearization does not suffice to establish Lyapunov stability of the nonlinear system.\n\nYour final answer must be the single closed-form analytic expression for the first exit time $T_{\\epsilon}(r_{0})$. No numerical approximation or rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It presents a standard, albeit important, example from the theory of dynamical systems concerning the relationship between the stability of a linearized system and the stability of the full nonlinear system. The premises are mathematically sound, and the tasks are clearly defined and solvable. Therefore, the problem is valid. We proceed with the solution.\n\nThe system is defined by the ordinary differential equation on $\\mathbb{R}^{2}$:\n$$\n\\dot{x} = f(x), \\quad \\text{where} \\quad x = \\begin{pmatrix}q \\\\ p\\end{pmatrix} \\quad \\text{and} \\quad f(x) = J x + \\left(q^{2} + p^{2}\\right) x\n$$\nwith $J = \\begin{pmatrix}0  1 \\\\ -1  0 \\end{pmatrix}$. The equilibrium point is $x_{e} = (0,0)^T$.\n\n1. Computation of the Jacobian and spectral stability analysis.\n\nThe vector field $f(x)$ can be written in component form as:\n$$\nf(q,p) = \\begin{pmatrix} p + q(q^2+p^2) \\\\ -q + p(q^2+p^2) \\end{pmatrix} = \\begin{pmatrix} f_1(q,p) \\\\ f_2(q,p) \\end{pmatrix}\n$$\nThe Jacobian matrix of $f$ at a generic point $x=(q,p)^T$ is given by $D f(x)$:\n$$\nD f(q,p) = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial q}  \\frac{\\partial f_1}{\\partial p} \\\\ \\frac{\\partial f_2}{\\partial q}  \\frac{\\partial f_2}{\\partial p} \\end{pmatrix}\n$$\nWe compute the partial derivatives:\n$$\n\\frac{\\partial f_1}{\\partial q} = \\frac{\\partial}{\\partial q} \\left(p + q^3 + qp^2\\right) = 3q^2 + p^2\n$$\n$$\n\\frac{\\partial f_1}{\\partial p} = \\frac{\\partial}{\\partial p} \\left(p + q^3 + qp^2\\right) = 1 + 2qp\n$$\n$$\n\\frac{\\partial f_2}{\\partial q} = \\frac{\\partial}{\\partial q} \\left(-q + q^2p + p^3\\right) = -1 + 2qp\n$$\n$$\n\\frac{\\partial f_2}{\\partial p} = \\frac{\\partial}{\\partial p} \\left(-q + q^2p + p^3\\right) = q^2 + 3p^2\n$$\nEvaluating the Jacobian at the equilibrium point $x_e = (0,0)^T$:\n$$\nD f(0,0) = \\begin{pmatrix} 3(0)^2 + (0)^2  1 + 2(0)(0) \\\\ -1 + 2(0)(0)  (0)^2 + 3(0)^2 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} = J\n$$\nThe eigenvalues $\\lambda$ of the Jacobian $D f(0)$ are found by solving the characteristic equation $\\det(J - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} -\\lambda  1 \\\\ -1  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (1)(-1) = \\lambda^2 + 1 = 0\n$$\nThe eigenvalues are $\\lambda_{1,2} = \\pm i$. Since the real parts of both eigenvalues are zero, $\\operatorname{Re}(\\lambda_1) = \\operatorname{Re}(\\lambda_2) = 0$, all eigenvalues lie on the imaginary axis. By definition, this means the linearization of the system at the equilibrium point $x_e=0$ is spectrally stable.\n\n2. Derivation of the evolution equation for the radius $r(t)$.\n\nThe radius is defined as $r(t) = \\sqrt{q(t)^2 + p(t)^2}$. It is computationally simpler to first find the evolution equation for $r(t)^2$:\n$$\n\\frac{d}{dt} \\left(r^2\\right) = \\frac{d}{dt} \\left(q^2 + p^2\\right) = 2q\\dot{q} + 2p\\dot{p}\n$$\nThe system's dynamics are given by $\\dot{q} = p + q(q^2+p^2)$ and $\\dot{p} = -q + p(q^2+p^2)$. Substituting these into the expression for the derivative of $r^2$:\n$$\n\\frac{d}{dt} \\left(r^2\\right) = 2q\\left(p + q(q^2+p^2)\\right) + 2p\\left(-q + p(q^2+p^2)\\right)\n$$\n$$\n= 2qp + 2q^2(q^2+p^2) - 2qp + 2p^2(q^2+p^2)\n$$\nThe $2qp$ terms cancel, leaving:\n$$\n\\frac{d}{dt} \\left(r^2\\right) = 2q^2(q^2+p^2) + 2p^2(q^2+p^2) = 2(q^2+p^2)(q^2+p^2) = 2(r^2)^2 = 2r^4\n$$\nNow, we relate this back to the derivative of $r$. Using the chain rule, $\\frac{d}{dt}(r^2) = 2r \\frac{dr}{dt}$. Equating the two expressions for the derivative of $r^2$:\n$$\n2r \\frac{dr}{dt} = 2r^4\n$$\nFor trajectories where $r \\neq 0$, we can divide by $2r$ to obtain the scalar evolution equation for the radius:\n$$\n\\frac{dr}{dt} = r^3\n$$\n\n3. Calculation of the first exit time $T_{\\epsilon}(r_0)$.\n\nWe need to solve the first-order nonlinear ODE $\\frac{dr}{dt} = r^3$ with the initial condition $r(0) = r_0$. We seek the time $T_{\\epsilon}(r_0)$ at which $r(T_{\\epsilon}(r_0)) = \\epsilon$, for an initial radius $r_0 \\in (0, \\epsilon)$. The equation is separable:\n$$\nr^{-3} dr = dt\n$$\nWe integrate both sides from the initial state $(t,r)=(0,r_0)$ to the final state $(t,r)=(T_{\\epsilon}(r_0), \\epsilon)$:\n$$\n\\int_{r_0}^{\\epsilon} r^{-3} dr = \\int_{0}^{T_{\\epsilon}(r_0)} dt\n$$\nThe left-hand side integral is:\n$$\n\\int_{r_0}^{\\epsilon} r^{-3} dr = \\left[ \\frac{r^{-2}}{-2} \\right]_{r_0}^{\\epsilon} = -\\frac{1}{2} \\left[ \\frac{1}{r^2} \\right]_{r_0}^{\\epsilon} = -\\frac{1}{2} \\left( \\frac{1}{\\epsilon^2} - \\frac{1}{r_0^2} \\right) = \\frac{1}{2} \\left( \\frac{1}{r_0^2} - \\frac{1}{\\epsilon^2} \\right)\n$$\nThe right-hand side integral is:\n$$\n\\int_{0}^{T_{\\epsilon}(r_0)} dt = \\left[ t \\right]_{0}^{T_{\\epsilon}(r_0)} = T_{\\epsilon}(r_0)\n$$\nEquating the results, we find the closed-form expression for the first exit time:\n$$\nT_{\\epsilon}(r_0) = \\frac{1}{2} \\left( \\frac{1}{r_0^2} - \\frac{1}{\\epsilon^2} \\right)\n$$\n\n4. Explanation of the counterexample.\n\nAn equilibrium point $x_e$ is Lyapunov stable if for every $\\epsilon  0$, there exists a $\\delta  0$ such that if a trajectory starts within a $\\delta$-neighborhood of $x_e$ (i.e., $\\|x(0) - x_e\\|  \\delta$), it remains within an $\\epsilon$-neighborhood of $x_e$ for all future time (i.e., $\\|x(t) - x_e\\|  \\epsilon$ for all $t \\ge 0$). For our problem, $x_e=0$ and we use the Euclidean norm $r = \\|x\\|$.\n\nOur analysis in part $1$ showed that the linearization at $x_e=0$ is spectrally stable, as its eigenvalues $\\pm i$ have zero real part.\n\nHowever, our result from part $3$ shows that for any initial condition $x(0)$ with norm $r_0 = \\|x(0)\\|  0$, no matter how small, the trajectory will reach any larger radius $\\epsilon  r_0$ in the finite time $T_{\\epsilon}(r_0)$.\n\nTo show this contradicts Lyapunov stability, let's pick an arbitrary $\\epsilon  0$. The definition would require us to find a $\\delta  0$ (where we can assume $\\delta  \\epsilon$) such that any trajectory starting with $r_0  \\delta$ will satisfy $r(t)  \\epsilon$ for all $t \\ge 0$. But our formula for $T_{\\epsilon}(r_0)$ shows this is false. For any choice of $\\delta  0$, we can pick an initial condition with radius $r_0$ such that $0  r_0  \\delta$. This trajectory will escape the $\\epsilon$-ball at the finite time $T_{\\epsilon}(r_0) = \\frac{1}{2}(\\frac{1}{r_0^2} - \\frac{1}{\\epsilon^2})  0$.\n\nTherefore, no such $\\delta$ exists for any given $\\epsilon  0$. The equilibrium point $x_e=0$ is not Lyapunov stable; it is unstable. This problem serves as a canonical counterexample demonstrating that spectral stability of the linearization is insufficient to guarantee Lyapunov stability for the full nonlinear system. The nonlinear terms, even if they are of higher order, can be destabilizing.",
            "answer": "$$ \\boxed{\\frac{1}{2} \\left(\\frac{1}{r_{0}^{2}} - \\frac{1}{\\epsilon^{2}}\\right)} $$"
        },
        {
            "introduction": "In contrast to general dynamical systems, the symplectic structure of Hamiltonian mechanics provides powerful constraints that link linear and nonlinear behavior. This practice focuses on a Hamiltonian system where the energy function has a strict local minimum at an equilibrium. You will use the conserved Hamiltonian itself as a coercive Lyapunov function to rigorously prove that spectral stability, in this context, does guarantee nonlinear Lyapunov stability, illustrating the stabilizing effect of a conserved, definite energy .",
            "id": "3755030",
            "problem": "Consider the canonical Hamiltonian system on $\\mathbb{R}^{4}$ with coordinates $(q_{1},q_{2},p_{1},p_{2})$ and canonical symplectic form $\\omega = dq_{1} \\wedge dp_{1} + dq_{2} \\wedge dp_{2}$. Let the Hamiltonian $H:\\mathbb{R}^{4} \\to \\mathbb{R}$ be defined by\n$$\nH(q_{1},q_{2},p_{1},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + p_{2}^{2}\\right) + \\frac{1}{2}\\left(\\omega_{1}^{2} q_{1}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right) + \\alpha\\, q_{1}^{4} + \\beta\\, q_{2}^{4} + \\gamma\\, q_{1}^{2} q_{2}^{2},\n$$\nwhere $\\omega_{1}0$, $\\omega_{2}0$, and $\\alpha,\\beta,\\gamma \\geq 0$. The dynamics are given by the Hamiltonian vector field defined via $\\iota_{X_{H}} \\omega = dH$, equivalently by the system of ordinary differential equations (ODEs)\n$$\n\\dot{q}_{1} = \\frac{\\partial H}{\\partial p_{1}},\\quad \\dot{q}_{2} = \\frac{\\partial H}{\\partial p_{2}},\\quad \\dot{p}_{1} = -\\frac{\\partial H}{\\partial q_{1}},\\quad \\dot{p}_{2} = -\\frac{\\partial H}{\\partial q_{2}}.\n$$\nIn particular,\n$$\n\\dot{q}_{1} = p_{1},\\quad \\dot{q}_{2} = p_{2},\\quad \\dot{p}_{1} = -\\omega_{1}^{2} q_{1} - 4\\alpha\\, q_{1}^{3} - 2\\gamma\\, q_{1} q_{2}^{2},\\quad \\dot{p}_{2} = -\\omega_{2}^{2} q_{2} - 4\\beta\\, q_{2}^{3} - 2\\gamma\\, q_{2} q_{1}^{2}.\n$$\nThe equilibrium at the origin $(q_{1},q_{2},p_{1},p_{2}) = (0,0,0,0)$ is of interest.\n\nStarting from the foundational definitions of symplectic geometry and stability for dynamical systems, and without invoking any pre-packaged theorems, do the following:\n\n- Derive the linearization of the above system at the origin and determine its spectrum, explaining the notion of spectral stability and whether the origin is spectrally stable.\n- Construct a Lyapunov function $V$ for this system based on fundamental geometric mechanics principles, ensuring that $V$ is coercive (i.e., $V(x) \\to +\\infty$ as $\\|x\\|\\to\\infty$). Justify why coercivity holds from first principles.\n- Prove that along trajectories of the system, the time derivative $\\dot{V}$ is nonpositive and, in fact, vanishes identically. Then, using a comparison argument with a scalar differential equation and the boundedness of level sets of $V$, show that the origin is Lyapunov stable in the nonlinear sense.\n- Clearly articulate the relationship between spectral stability and Lyapunov stability in this Hamiltonian setting, explaining why spectral stability alone does not imply nonlinear stability but how the symplectic structure together with a coercive energy does.\n\nYour final answer must be the single closed-form analytic expression of the Lyapunov function $V(q_{1},q_{2},p_{1},p_{2})$ that you constructed. No numerical rounding is required. Do not include units in your final answer.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, objective, and complete. It presents a standard, yet conceptually rich, problem in the field of geometric mechanics and stability theory. All provided information is consistent and sufficient to proceed with a rigorous analysis.\n\nThe problem requires a four-part analysis of the stability of the origin for a given Hamiltonian system. We will address each part in sequence, starting from fundamental principles as requested.\n\nFirst, we analyze the spectral stability of the origin by linearizing the system of ordinary differential equations (ODEs). Let the state vector be $x = (q_{1}, q_{2}, p_{1}, p_{2})^{\\top} \\in \\mathbb{R}^{4}$. The dynamics are given by $\\dot{x} = F(x)$, where the vector field $F$ is\n$$\nF(q_{1}, q_{2}, p_{1}, p_{2}) = \\begin{pmatrix} p_{1} \\\\ p_{2} \\\\ -\\omega_{1}^{2} q_{1} - 4\\alpha\\, q_{1}^{3} - 2\\gamma\\, q_{1} q_{2}^{2} \\\\ -\\omega_{2}^{2} q_{2} - 4\\beta\\, q_{2}^{3} - 2\\gamma\\, q_{2} q_{1}^{2} \\end{pmatrix}.\n$$\nThe linearization of the system at the equilibrium point $x_{e} = (0,0,0,0)$ is given by the linear system $\\dot{\\xi} = A \\xi$, where $A$ is the Jacobian matrix $DF(x_{e})$. The Jacobian matrix is\n$$\nA = \\begin{pmatrix}\n\\frac{\\partial \\dot{q}_{1}}{\\partial q_{1}}  \\frac{\\partial \\dot{q}_{1}}{\\partial q_{2}}  \\frac{\\partial \\dot{q}_{1}}{\\partial p_{1}}  \\frac{\\partial \\dot{q}_{1}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{q}_{2}}{\\partial q_{1}}  \\frac{\\partial \\dot{q}_{2}}{\\partial q_{2}}  \\frac{\\partial \\dot{q}_{2}}{\\partial p_{1}}  \\frac{\\partial \\dot{q}_{2}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{p}_{1}}{\\partial q_{1}}  \\frac{\\partial \\dot{p}_{1}}{\\partial q_{2}}  \\frac{\\partial \\dot{p}_{1}}{\\partial p_{1}}  \\frac{\\partial \\dot{p}_{1}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{p}_{2}}{\\partial q_{1}}  \\frac{\\partial \\dot{p}_{2}}{\\partial q_{2}}  \\frac{\\partial \\dot{p}_{2}}{\\partial p_{1}}  \\frac{\\partial \\dot{p}_{2}}{\\partial p_{2}}\n\\end{pmatrix}.\n$$\nCalculating the partial derivatives and evaluating them at the origin $(0,0,0,0)$ yields:\n$$\nA = \\begin{pmatrix}\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-\\omega_{1}^{2}  0  0  0 \\\\\n0  -\\omega_{2}^{2}  0  0\n\\end{pmatrix}.\n$$\nThe spectrum of the linearized system is the set of eigenvalues $\\lambda$ of $A$, determined by solving the characteristic equation $\\det(A - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix}\n-\\lambda  0  1  0 \\\\\n0  -\\lambda  0  1 \\\\\n-\\omega_{1}^{2}  0  -\\lambda  0 \\\\\n0  -\\omega_{2}^{2}  0  -\\lambda\n\\end{pmatrix} = 0.\n$$\nDue to the block structure of the matrix, the determinant simplifies to the product of the determinants of two $2 \\times 2$ blocks:\n$$\n\\det \\begin{pmatrix} -\\lambda  1 \\\\ -\\omega_{1}^{2}  -\\lambda \\end{pmatrix} \\cdot \\det \\begin{pmatrix} -\\lambda  1 \\\\ -\\omega_{2}^{2}  -\\lambda \\end{pmatrix} = (\\lambda^{2} + \\omega_{1}^{2})(\\lambda^{2} + \\omega_{2}^{2}) = 0.\n$$\nThis equation gives $\\lambda^{2} = -\\omega_{1}^{2}$ and $\\lambda^{2} = -\\omega_{2}^{2}$. Since $\\omega_{1}  0$ and $\\omega_{2}  0$, the eigenvalues are purely imaginary: $\\lambda_{1,2} = \\pm i\\omega_{1}$ and $\\lambda_{3,4} = \\pm i\\omega_{2}$. The spectrum is $\\{\\pm i\\omega_{1}, \\pm i\\omega_{2}\\}$.\nSpectral stability of an equilibrium point requires that all eigenvalues of the linearized system have non-positive real parts. Here, the real parts of all eigenvalues are zero. Thus, the origin is spectrally stable. It is not, however, asymptotically stable at the linear level, as none of the eigenvalues have negative real parts.\n\nSecond, we construct a Lyapunov function. For a conservative Hamiltonian system, the Hamiltonian $H$ itself is a conserved quantity along trajectories, making it a natural candidate for a Lyapunov function. We define $V(q_{1},q_{2},p_{1},p_{2}) = H(q_{1},q_{2},p_{1},p_{2})$.\n$$\nV(q_{1},q_{2},p_{1},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + p_{2}^{2}\\right) + \\frac{1}{2}\\left(\\omega_{1}^{2} q_{1}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right) + \\alpha\\, q_{1}^{4} + \\beta\\, q_{2}^{4} + \\gamma\\, q_{1}^{2} q_{2}^{2}.\n$$\nTo be a valid Lyapunov function for proving stability of the origin, $V$ must be positive definite in a neighborhood of the origin. We observe that $V(0,0,0,0) = 0$. For any other point $(q_{1},q_{2},p_{1},p_{2}) \\neq (0,0,0,0)$, we analyze the terms. Since $\\omega_{1}0$, $\\omega_{2}0$, $\\alpha\\geq 0$, $\\beta\\geq 0$, and $\\gamma\\geq 0$, every term in the expression for $V$ is non-negative. A sum of non-negative terms is zero if and only if each term is zero. This requires $p_{1}=p_{2}=0$, $\\omega_{1}^{2} q_{1}^{2} = 0$, and $\\omega_{2}^{2} q_{2}^{2} = 0$. As $\\omega_{1,2} \\neq 0$, this implies $q_{1}=q_{2}=0$. Thus, $V(x)  0$ for all $x \\neq 0$, so $V$ is positive definite on all of $\\mathbb{R}^4$.\nNext, we show that $V$ is coercive, meaning $V(x) \\to +\\infty$ as the norm $\\|x\\| \\to +\\infty$, where $\\|x\\|^{2} = q_{1}^{2} + q_{2}^{2} + p_{1}^{2} + p_{2}^{2}$. We can establish a lower bound for $V$. Let $c_{\\min} = \\min\\{1, \\omega_{1}^{2}, \\omega_{2}^{2}\\}$. Since $\\omega_{1,2}0$, $c_{\\min}0$. The quadratic part of $V$ is bounded below as:\n$$\n\\frac{1}{2}(p_{1}^{2} + p_{2}^{2}) + \\frac{1}{2}(\\omega_{1}^{2} q_{1}^{2} + \\omega_{2}^{2} q_{2}^{2}) \\geq \\frac{1}{2} c_{\\min} (p_{1}^{2} + p_{2}^{2} + q_{1}^{2} + q_{2}^{2}) = \\frac{1}{2} c_{\\min} \\|x\\|^{2}.\n$$\nSince the quartic terms are non-negative ($\\alpha, \\beta, \\gamma \\geq 0$), we have\n$$\nV(x) \\geq \\frac{1}{2} c_{\\min} \\|x\\|^{2}.\n$$\nAs $\\|x\\| \\to +\\infty$, the lower bound $\\frac{1}{2} c_{\\min} \\|x\\|^{2} \\to +\\infty$. By the comparison principle, $V(x) \\to +\\infty$. Thus, $V$ is coercive. This coercivity implies that for any constant $C \\geq 0$, the level set $\\{x \\in \\mathbb{R}^{4} \\mid V(x) \\leq C\\}$ is a bounded set. Since $V$ is a continuous function, these level sets are also closed, hence they are compact.\n\nThird, we prove Lyapunov stability. We compute the time derivative of $V$ along the trajectories of the system. Using the chain rule, and the fact that $V=H$:\n$$\n\\dot{V} = \\frac{d H}{d t} = \\sum_{i=1}^{2} \\left( \\frac{\\partial H}{\\partial q_{i}} \\dot{q}_{i} + \\frac{\\partial H}{\\partial p_{i}} \\dot{p}_{i} \\right).\n$$\nSubstituting Hamilton's equations, $\\dot{q}_{i} = \\partial H/\\partial p_{i}$ and $\\dot{p}_{i} = -\\partial H/\\partial q_{i}$:\n$$\n\\dot{V} = \\sum_{i=1}^{2} \\left( \\frac{\\partial H}{\\partial q_{i}} \\frac{\\partial H}{\\partial p_{i}} - \\frac{\\partial H}{\\partial p_{i}} \\frac{\\partial H}{\\partial q_{i}} \\right) = \\sum_{i=1}^{2} 0 = 0.\n$$\nThis confirms that $V=H$ is a constant of motion, which is a fundamental property of autonomous Hamiltonian systems. Thus, its time derivative is not just non-positive, but identically zero. To prove Lyapunov stability for the origin, we must show that for any $\\epsilon  0$, there exists a $\\delta  0$ such that if $\\|x(0)\\|  \\delta$, then $\\|x(t)\\|  \\epsilon$ for all $t  0$.\nLet $\\epsilon  0$ be given. Since $V$ is coercive, the ball $B_{\\epsilon}(0) = \\{x \\mid \\|x\\|  \\epsilon\\}$ has a boundary sphere $S_{\\epsilon} = \\{x \\mid \\|x\\| = \\epsilon\\}$ which is compact. $V$ is continuous and positive definite, so it attains a minimum value $C_{\\epsilon} = \\min_{\\|x\\|=\\epsilon} V(x)$ on $S_{\\epsilon}$, and $C_{\\epsilon}  0$. Consider the level set $\\mathcal{L}_{C_{\\epsilon}} = \\{x \\mid V(x)  C_{\\epsilon}\\}$. This is an open set containing the origin. Since $V$ is continuous and $V(0)=0$, there exists a $\\delta  0$ such that the ball $B_{\\delta}(0) = \\{x \\mid \\|x\\|  \\delta\\}$ is contained in $\\mathcal{L}_{C_{\\epsilon}}$. Now, choose an initial condition $x(0)$ such that $\\|x(0)\\|  \\delta$. Then $V(x(0))  C_{\\epsilon}$.\nThe scalar differential equation for $y(t) = V(x(t))$ is $\\dot{y} = 0$, implying $y(t)=y(0)$ for all $t$. Thus, $V(x(t)) = V(x(0))  C_{\\epsilon}$ for all $t  0$. This means the entire trajectory $x(t)$ must remain within the set $\\mathcal{L}_{C_{\\epsilon}}$. By construction, this set is a subset of the ball $B_{\\epsilon}(0)$ (as any point on or outside its boundary would have $V(x) \\geq C_{\\epsilon}$). Therefore, $\\|x(t)\\|  \\epsilon$ for all $t0$. This completes the proof of Lyapunov stability.\n\nFinally, we articulate the relationship between spectral and Lyapunov stability in this context. Spectral stability provides information about the local behavior of a system based on its linearization. For general dynamical systems, spectral stability with purely imaginary eigenvalues (a center in the linear approximation) is a borderline case that is insufficient to guarantee stability of the full nonlinear system. Nonlinear terms can be either stabilizing or destabilizing. For example, adding a term like $(q^2+p^2)p$ to $\\dot{q}$ in a simple harmonic oscillator can create an unstable spiral.\nHowever, for Hamiltonian systems, the symplectic structure imposes a crucial constraint: the conservation of energy, $\\dot{H} = 0$. This single fact fundamentally alters the stability analysis. If the Hamiltonian $H$ has a strict local minimum at an equilibrium point, as it does in this problem (due to $\\omega_{i}0$ and non-negative coefficients for the quartic terms), then the equilibrium is Lyapunov stable. The proof is precisely the one given above: the conserved energy $H$ serves as a Lyapunov function. Trajectories are confined to the level surfaces of $H$. Since the origin is a strict minimum, nearby trajectories lie on level surfaces that are topologically spheres enclosing the origin. The coercivity of $H$ guarantees these surfaces are bounded, trapping the trajectory in a small neighborhood. In summary, spectral stability indicates that the quadratic part of the Hamiltonian is positive definite, making the origin a minimum of the linearized energy. The symplectic structure ensures the full nonlinear energy is conserved, and the positive definiteness of $H$ near the origin ensures this conserved quantity acts as a \"potential well\" that traps trajectories, thereby guaranteeing Lyapunov stability.\n\nThe constructed Lyapunov function is the Hamiltonian $H$.",
            "answer": "$$\n\\boxed{V(q_{1},q_{2},p_{1},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + p_{2}^{2}\\right) + \\frac{1}{2}\\left(\\omega_{1}^{2} q_{1}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right) + \\alpha\\, q_{1}^{4} + \\beta\\, q_{2}^{4} + \\gamma\\, q_{1}^{2} q_{2}^{2}}\n$$"
        },
        {
            "introduction": "Our final exercise explores a more nuanced borderline case within Hamiltonian mechanics. Here, the quadratic part of the Hamiltonian is only positive semidefinite, leading to zero eigenvalues in the linearization and creating \"flat directions\" where linear analysis is inconclusive. This problem challenges you to analyze such a degenerate equilibrium, highlighting that even in Hamiltonian systems, a deeper look at the higher-order terms of the potential is sometimes necessary to determine nonlinear stability .",
            "id": "3755033",
            "problem": "Consider the Hamiltonian system on the cotangent bundle $T^{*}\\mathbb{R}^{2}$ with canonical coordinates $(q_{1},q_{2},p_{1},p_{2})$ and the standard symplectic form. Let the Hamiltonian be\n$$\nH(q_{1},q_{2},p_{1},p_{2}) \\;=\\; \\frac{1}{2}p_{1}^{2} \\;+\\; \\frac{1}{2}p_{2}^{2} \\;+\\; \\frac{1}{2}\\omega^{2} q_{1}^{2} \\;+\\; \\alpha q_{2}^{4},\n$$\nwhere $\\omega0$ and $\\alpha0$ are fixed parameters. The origin $z_{0}=(q_{1},q_{2},p_{1},p_{2})=(0,0,0,0)$ is an equilibrium.\n\nUsing only fundamental definitions from Hamiltonian mechanics and symplectic linear algebra, perform the following:\n\n- Determine the second variation $D^{2}H(z_{0})$ and assess whether it is positive semidefinite at $z_{0}$.\n- Linearize the Hamiltonian vector field around $z_{0}$ and compute the spectrum of the linearized operator (the set of eigenvalues), expressed in terms of $\\omega$.\n\nYour final answer must be the complete list of eigenvalues of the linearized operator at $z_{0}$, written as a single row matrix. No rounding is required, and no units should be included in the final answer.",
            "solution": "The problem statement is critically examined and found to be valid. It is scientifically grounded in Hamiltonian mechanics, well-posed with all necessary information provided, and framed using objective, formal language. It represents a standard problem in the stability analysis of equilibrium points in a dynamical system.\n\nWe proceed with the solution. The system is described by the state vector $z = (q_{1}, q_{2}, p_{1}, p_{2})^{T}$ in the phase space $T^{*}\\mathbb{R}^{2}$. The Hamiltonian is given by:\n$$\nH(q_{1},q_{2},p_{1},p_{2}) = \\frac{1}{2}p_{1}^{2} + \\frac{1}{2}p_{2}^{2} + \\frac{1}{2}\\omega^{2} q_{1}^{2} + \\alpha q_{2}^{4}\n$$\nwith parameters $\\omega  0$ and $\\alpha  0$. The equilibrium point is $z_{0}=(0,0,0,0)$.\n\nFirst, we confirm that $z_{0}$ is an equilibrium point by computing the gradient of the Hamiltonian, $DH(z)$, and evaluating it at $z_{0}$. The components of the gradient are the partial derivatives of $H$:\n$$\n\\frac{\\partial H}{\\partial q_{1}} = \\omega^{2} q_{1}\n$$\n$$\n\\frac{\\partial H}{\\partial q_{2}} = 4\\alpha q_{2}^{3}\n$$\n$$\n\\frac{\\partial H}{\\partial p_{1}} = p_{1}\n$$\n$$\n\\frac{\\partial H}{\\partial p_{2}} = p_{2}\n$$\nEvaluating at $z_{0}=(0,0,0,0)$, we find that all partial derivatives are zero. Thus, $DH(z_{0}) = (0,0,0,0)$, which confirms that $z_{0}$ is a critical point of $H$ and therefore an equilibrium point of the Hamiltonian dynamics.\n\nNext, we address the first task: determining the second variation $D^{2}H(z_{0})$ and its definiteness. The second variation is represented by the Hessian matrix of $H$, which contains all second partial derivatives. We compute the non-zero second derivatives:\n$$\n\\frac{\\partial^{2} H}{\\partial q_{1}^{2}} = \\omega^{2}\n$$\n$$\n\\frac{\\partial^{2} H}{\\partial q_{2}^{2}} = 12\\alpha q_{2}^{2}\n$$\n$$\n\\frac{\\partial^{2} H}{\\partial p_{1}^{2}} = 1\n$$\n$$\n\\frac{\\partial^{2} H}{\\partial p_{2}^{2}} = 1\n$$\nAll mixed partial derivatives are zero. We evaluate these at the equilibrium point $z_{0}=(0,0,0,0)$:\n$$\n\\left.\\frac{\\partial^{2} H}{\\partial q_{1}^{2}}\\right|_{z_{0}} = \\omega^{2}\n$$\n$$\n\\left.\\frac{\\partial^{2} H}{\\partial q_{2}^{2}}\\right|_{z_{0}} = 12\\alpha(0)^{2} = 0\n$$\n$$\n\\left.\\frac{\\partial^{2} H}{\\partial p_{1}^{2}}\\right|_{z_{0}} = 1\n$$\n$$\n\\left.\\frac{\\partial^{2} H}{\\partial p_{2}^{2}}\\right|_{z_{0}} = 1\n$$\nThe Hessian matrix $D^{2}H(z_{0})$ arranged in the order of variables $(q_{1}, q_{2}, p_{1}, p_{2})$ is therefore a diagonal matrix:\n$$\nD^{2}H(z_{0}) = \n\\begin{pmatrix}\n\\omega^{2}  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\nTo assess definiteness, we examine the eigenvalues of this matrix. As it is diagonal, the eigenvalues are simply the diagonal entries: $\\{\\omega^{2}, 0, 1, 1\\}$. Since $\\omega  0$ is given, $\\omega^{2}  0$. All eigenvalues are non-negative. A symmetric matrix with all non-negative eigenvalues is positive semidefinite. Due to the presence of a zero eigenvalue, it is not positive definite.\n\nNow, we address the second task: linearizing the Hamiltonian vector field and finding its spectrum. Hamilton's equations are given by $\\dot{z} = J DH(z)^{T}$, where $J$ is the standard symplectic matrix. For coordinates ordered as $(q_{1}, q_{2}, p_{1}, p_{2})$, the matrix $J$ is:\n$$\nJ = \\begin{pmatrix} 0_{2}  I_{2} \\\\ -I_{2}  0_{2} \\end{pmatrix} = \\begin{pmatrix} 0  0  1  0 \\\\ 0  0  0  1 \\\\ -1  0  0  0 \\\\ 0  -1  0  0 \\end{pmatrix}\n$$\nwhere $I_{2}$ and $0_{2}$ are the $2 \\times 2$ identity and zero matrices, respectively.\nThe nonlinear equations of motion are:\n$$\n\\dot{q}_{1} = \\frac{\\partial H}{\\partial p_{1}} = p_{1}\n$$\n$$\n\\dot{q}_{2} = \\frac{\\partial H}{\\partial p_{2}} = p_{2}\n$$\n$$\n\\dot{p}_{1} = -\\frac{\\partial H}{\\partial q_{1}} = -\\omega^{2} q_{1}\n$$\n$$\n\\dot{p}_{2} = -\\frac{\\partial H}{\\partial q_{2}} = -4\\alpha q_{2}^{3}\n$$\nThe Hamiltonian vector field is $X_{H}(z) = (p_{1}, p_{2}, -\\omega^{2}q_{1}, -4\\alpha q_{2}^{3})^{T}$. The linearized system at the equilibrium $z_{0}$ is given by $\\delta\\dot{z} = A \\delta z$, where $A$ is the Jacobian matrix of $X_{H}$ evaluated at $z_{0}$.\n$$\nA = DX_{H}(z_{0}) = \\left.\\begin{pmatrix}\n\\frac{\\partial \\dot{q}_{1}}{\\partial q_{1}}  \\frac{\\partial \\dot{q}_{1}}{\\partial q_{2}}  \\frac{\\partial \\dot{q}_{1}}{\\partial p_{1}}  \\frac{\\partial \\dot{q}_{1}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{q}_{2}}{\\partial q_{1}}  \\frac{\\partial \\dot{q}_{2}}{\\partial q_{2}}  \\frac{\\partial \\dot{q}_{2}}{\\partial p_{1}}  \\frac{\\partial \\dot{q}_{2}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{p}_{1}}{\\partial q_{1}}  \\frac{\\partial \\dot{p}_{1}}{\\partial q_{2}}  \\frac{\\partial \\dot{p}_{1}}{\\partial p_{1}}  \\frac{\\partial \\dot{p}_{1}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{p}_{2}}{\\partial q_{1}}  \\frac{\\partial \\dot{p}_{2}}{\\partial q_{2}}  \\frac{\\partial \\dot{p}_{2}}{\\partial p_{1}}  \\frac{\\partial \\dot{p}_{2}}{\\partial p_{2}}\n\\end{pmatrix}\\right|_{z=z_{0}} = \\left.\\begin{pmatrix}\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-\\omega^{2}  0  0  0 \\\\\n0  -12\\alpha q_{2}^{2}  0  0\n\\end{pmatrix}\\right|_{z=z_{0}}\n$$\nSubstituting $q_{2}=0$ from $z_{0}$:\n$$\nA = \\begin{pmatrix}\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-\\omega^{2}  0  0  0 \\\\\n0  0  0  0\n\\end{pmatrix}\n$$\nNote that this matrix is precisely $A = J D^{2}H(z_{0})$.\n\nTo find the spectrum of the linearized operator, we compute the eigenvalues of $A$ by solving the characteristic equation $\\det(A - \\lambda I) = 0$, where $I$ is the $4 \\times 4$ identity matrix.\n$$\n\\det(A - \\lambda I) = \\det\\begin{pmatrix}\n-\\lambda  0  1  0 \\\\\n0  -\\lambda  0  1 \\\\\n-\\omega^{2}  0  -\\lambda  0 \\\\\n0  0  0  -\\lambda\n\\end{pmatrix}\n$$\nWe expand the determinant along the fourth row:\n$$\n(-\\lambda) \\det\\begin{pmatrix}\n-\\lambda  0  1 \\\\\n0  -\\lambda  0 \\\\\n-\\omega^{2}  0  -\\lambda\n\\end{pmatrix}\n$$\nNext, we expand the $3 \\times 3$ determinant along the second row:\n$$\n(-\\lambda) \\left( (-\\lambda) \\det\\begin{pmatrix}\n-\\lambda  1 \\\\\n-\\omega^{2}  -\\lambda\n\\end{pmatrix} \\right) = \\lambda^{2} \\left( (-\\lambda)(-\\lambda) - (1)(-\\omega^{2}) \\right) = \\lambda^{2}(\\lambda^{2} + \\omega^{2})\n$$\nThe characteristic equation is $\\lambda^{2}(\\lambda^{2} + \\omega^{2}) = 0$. The roots of this equation are:\n1.  $\\lambda^{2} = 0$, which gives $\\lambda=0$ with algebraic multiplicity $2$.\n2.  $\\lambda^{2} + \\omega^{2} = 0$, which gives $\\lambda^{2} = -\\omega^{2}$, so $\\lambda = \\pm i\\omega$.\n\nThe complete set of eigenvalues (the spectrum) of the linearized operator at $z_{0}$ is $\\{0, 0, i\\omega, -i\\omega\\}$. The presence of purely imaginary eigenvalues $(\\pm i\\omega)$ corresponds to the oscillatory motion of the $(q_{1},p_{1})$ subsystem (a harmonic oscillator), and the repeated zero eigenvalues correspond to the degenerate nature of the equilibrium in the $(q_{2},p_{2})$ direction.",
            "answer": "$$\n\\boxed{\\pmatrix{0  0  i\\omega  -i\\omega}}\n$$"
        }
    ]
}