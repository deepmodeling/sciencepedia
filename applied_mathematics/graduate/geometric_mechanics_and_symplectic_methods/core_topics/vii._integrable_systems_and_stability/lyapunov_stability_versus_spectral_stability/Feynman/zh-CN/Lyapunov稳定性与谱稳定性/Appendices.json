{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解谱稳定性和李雅普诺夫稳定性之间的区别，最好的方法莫过于研究一个反例。这个练习构建了一个简单的二维系统，其线性化分析表明系统是稳定的，但其完整的非线性动力学行为却明确地展示了不稳定性。通过这个练习，你将亲手揭示非线性项在决定系统最终命运中的关键作用。",
            "id": "3755022",
            "problem": "设 $\\left(\\mathbb{R}^{2},\\omega\\right)$ 是标准辛平面，其典范辛形式为 $\\omega = dq \\wedge dp$，典范辛矩阵为 $J = \\begin{pmatrix}0  1 \\\\ -1  0 \\end{pmatrix}$。考虑光滑自治常微分方程 (ODE)\n$$\n\\dot{x} = f(x), \\quad x = \\begin{pmatrix}q \\\\ p\\end{pmatrix}, \\quad f(x) = J x + \\left(q^{2} + p^{2}\\right) x,\n$$\n其平衡点为 $x_{e} = 0$。该系统是由二次哈密顿量 $H_{2}(q,p) = \\tfrac{1}{2}\\left(q^{2} + p^{2}\\right)$ 生成的线性哈密顿旋转与一个相对于 $\\omega$ 非哈密顿的非线性径向三次项之和。\n\n从 Lyapunov 稳定性和谱稳定性的核心定义出发，不依赖任何专门定理，按以下步骤进行：\n\n1. 计算雅可比矩阵 $D f(0)$ 及其特征值，以验证在 $x_{e} = 0$ 处的线性化系统是谱稳定的（所有特征值都位于虚轴上）。\n2. 仅使用第一性原理和基本定义，推导沿轨道半径 $r(t) = \\sqrt{q(t)^{2} + p(t)^{2}}$ 的精确标量演化方程。\n3. 对于初始数据 $x(0)$ 满足 $|x(0)| = r_{0} \\in (0,\\epsilon)$，确定解满足 $|x(T_{\\epsilon}(r_{0}))| = \\epsilon$ 的首次出射时间 $T_{\\epsilon}(r_{0})$。将 $T_{\\epsilon}(r_{0})$ 表示为 $r_{0}$ 和 $\\epsilon$ 的闭式解析表达式。\n4. 简要说明你的计算如何提供一个反例，证明线性化系统的谱稳定性不足以确立非线性系统的 Lyapunov 稳定性。\n\n你的最终答案必须是首次出射时间 $T_{\\epsilon}(r_{0})$ 的单一闭式解析表达式。不需要数值近似或四舍五入。",
            "solution": "所述问题具有科学依据、适定、客观且自洽。它展示了动力系统理论中一个标准且重要的例子，该例子涉及线性化系统的稳定性与完整非线性系统稳定性之间的关系。其前提在数学上是合理的，任务定义清晰且可解。因此，该问题是有效的。我们开始求解。\n\n该系统由 $\\mathbb{R}^{2}$ 上的常微分方程定义：\n$$\n\\dot{x} = f(x), \\quad \\text{其中} \\quad x = \\begin{pmatrix}q \\\\ p\\end{pmatrix} \\quad \\text{且} \\quad f(x) = J x + \\left(q^{2} + p^{2}\\right) x\n$$\n其平衡点为 $x_{e} = (0,0)^T$。\n\n1. 雅可比矩阵计算与谱稳定性分析。\n\n向量场 $f(x)$ 的分量形式可以写为：\n$$\nf(q,p) = \\begin{pmatrix} p + q(q^2+p^2) \\\\ -q + p(q^2+p^2) \\end{pmatrix} = \\begin{pmatrix} f_1(q,p) \\\\ f_2(q,p) \\end{pmatrix}\n$$\n在一般点 $x=(q,p)^T$ 处 $f$ 的雅可比矩阵由 $D f(x)$ 给出：\n$$\nD f(q,p) = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial q}  \\frac{\\partial f_1}{\\partial p} \\\\ \\frac{\\partial f_2}{\\partial q}  \\frac{\\partial f_2}{\\partial p} \\end{pmatrix}\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial f_1}{\\partial q} = \\frac{\\partial}{\\partial q} \\left(p + q^3 + qp^2\\right) = 3q^2 + p^2\n$$\n$$\n\\frac{\\partial f_1}{\\partial p} = \\frac{\\partial}{\\partial p} \\left(p + q^3 + qp^2\\right) = 1 + 2qp\n$$\n$$\n\\frac{\\partial f_2}{\\partial q} = \\frac{\\partial}{\\partial q} \\left(-q + q^2p + p^3\\right) = -1 + 2qp\n$$\n$$\n\\frac{\\partial f_2}{\\partial p} = \\frac{\\partial}{\\partial p} \\left(-q + q^2p + p^3\\right) = q^2 + 3p^2\n$$\n在平衡点 $x_e = (0,0)^T$ 处计算雅可比矩阵：\n$$\nD f(0,0) = \\begin{pmatrix} 3(0)^2 + (0)^2  1 + 2(0)(0) \\\\ -1 + 2(0)(0)  (0)^2 + 3(0)^2 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} = J\n$$\n雅可比矩阵 $D f(0)$ 的特征值 $\\lambda$ 通过求解特征方程 $\\det(J - \\lambda I) = 0$ 得到：\n$$\n\\det\\begin{pmatrix} -\\lambda  1 \\\\ -1  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (1)(-1) = \\lambda^2 + 1 = 0\n$$\n特征值为 $\\lambda_{1,2} = \\pm i$。由于两个特征值的实部均为零，即 $\\operatorname{Re}(\\lambda_1) = \\operatorname{Re}(\\lambda_2) = 0$，所有特征值都位于虚轴上。根据定义，这意味着系统在平衡点 $x_e=0$ 处的线性化是谱稳定的。\n\n2. 半径 $r(t)$ 演化方程的推导。\n\n半径定义为 $r(t) = \\sqrt{q(t)^2 + p(t)^2}$。首先寻找 $r(t)^2$ 的演化方程在计算上更简单：\n$$\n\\frac{d}{dt} \\left(r^2\\right) = \\frac{d}{dt} \\left(q^2 + p^2\\right) = 2q\\dot{q} + 2p\\dot{p}\n$$\n系统的动力学由 $\\dot{q} = p + q(q^2+p^2)$ 和 $\\dot{p} = -q + p(q^2+p^2)$ 给出。将它们代入 $r^2$ 的导数表达式中：\n$$\n\\frac{d}{dt} \\left(r^2\\right) = 2q\\left(p + q(q^2+p^2)\\right) + 2p\\left(-q + p(q^2+p^2)\\right)\n$$\n$$\n= 2qp + 2q^2(q^2+p^2) - 2qp + 2p^2(q^2+p^2)\n$$\n$2qp$ 项相互抵消，剩下：\n$$\n\\frac{d}{dt} \\left(r^2\\right) = 2q^2(q^2+p^2) + 2p^2(q^2+p^2) = 2(q^2+p^2)(q^2+p^2) = 2(r^2)^2 = 2r^4\n$$\n现在，我们将其与 $r$ 的导数联系起来。使用链式法则，$\\frac{d}{dt}(r^2) = 2r \\frac{dr}{dt}$。令两个关于 $r^2$ 导数的表达式相等：\n$$\n2r \\frac{dr}{dt} = 2r^4\n$$\n对于 $r \\neq 0$ 的轨道，我们可以除以 $2r$ 得到半径的标量演化方程：\n$$\n\\frac{dr}{dt} = r^3\n$$\n\n3. 首次出射时间 $T_{\\epsilon}(r_0)$ 的计算。\n\n我们需要求解一阶非线性常微分方程 $\\frac{dr}{dt} = r^3$，其初始条件为 $r(0) = r_0$。我们寻求当初始半径 $r_0 \\in (0, \\epsilon)$ 时，使得 $r(T_{\\epsilon}(r_0)) = \\epsilon$ 的时间 $T_{\\epsilon}(r_0)$。该方程是可分离的：\n$$\nr^{-3} dr = dt\n$$\n我们对两边从初始状态 $(t,r)=(0,r_0)$ 到最终状态 $(t,r)=(T_{\\epsilon}(r_0), \\epsilon)$ 进行积分：\n$$\n\\int_{r_0}^{\\epsilon} r^{-3} dr = \\int_{0}^{T_{\\epsilon}(r_0)} dt\n$$\n左侧积分为：\n$$\n\\int_{r_0}^{\\epsilon} r^{-3} dr = \\left[ \\frac{r^{-2}}{-2} \\right]_{r_0}^{\\epsilon} = -\\frac{1}{2} \\left[ \\frac{1}{r^2} \\right]_{r_0}^{\\epsilon} = -\\frac{1}{2} \\left( \\frac{1}{\\epsilon^2} - \\frac{1}{r_0^2} \\right) = \\frac{1}{2} \\left( \\frac{1}{r_0^2} - \\frac{1}{\\epsilon^2} \\right)\n$$\n右侧积分为：\n$$\n\\int_{0}^{T_{\\epsilon}(r_0)} dt = \\left[ t \\right]_{0}^{T_{\\epsilon}(r_0)} = T_{\\epsilon}(r_0)\n$$\n令结果相等，我们得到首次出射时间的闭式表达式：\n$$\nT_{\\epsilon}(r_0) = \\frac{1}{2} \\left( \\frac{1}{r_0^2} - \\frac{1}{\\epsilon^2} \\right)\n$$\n\n4. 关于反例的说明。\n\n如果对于每一个 $\\epsilon > 0$，都存在一个 $\\delta > 0$，使得如果一条轨道从 $x_e$ 的一个 $\\delta$-邻域内开始（即 $\\|x(0) - x_e\\|  \\delta$），它将在所有未来时间内都保持在 $x_e$ 的一个 $\\epsilon$-邻域内（即对于所有 $t \\ge 0$ 都有 $\\|x(t) - x_e\\|  \\epsilon$），则平衡点 $x_e$ 是 Lyapunov 稳定的。对于我们的问题，$x_e=0$，我们使用欧几里得范数 $r = \\|x\\|$。\n\n我们在第 1 部分的分析表明，在 $x_e=0$ 处的线性化系统是谱稳定的，因为其特征值 $\\pm i$ 的实部为零。\n\n然而，我们从第 3 部分得到的结果表明，对于任何范数 $r_0 = \\|x(0)\\| > 0$（无论多小）的初始条件 $x(0)$，轨道都将在有限时间 $T_{\\epsilon}(r_0)$ 内达到任何更大的半径 $\\epsilon > r_0$。\n\n为了说明这与 Lyapunov 稳定性相矛盾，我们任取一个 $\\epsilon > 0$。根据定义，我们需要找到一个 $\\delta > 0$（可以假设 $\\delta  \\epsilon$），使得任何从 $r_0  \\delta$ 开始的轨道都满足对所有 $t \\ge 0$ 有 $r(t)  \\epsilon$。但我们关于 $T_{\\epsilon}(r_0)$ 的公式表明这是错误的。对于任何选定的 $\\delta > 0$，我们可以选择一个初始条件，其半径 $r_0$ 满足 $0  r_0  \\delta$。这条轨道将在有限时间 $T_{\\epsilon}(r_0) = \\frac{1}{2}(\\frac{1}{r_0^2} - \\frac{1}{\\epsilon^2}) > 0$ 时逃离 $\\epsilon$-球。\n\n因此，对于任何给定的 $\\epsilon > 0$，都不存在这样的 $\\delta$。平衡点 $x_e=0$ 不是 Lyapunov 稳定的；它是不稳定的。该问题是一个典范反例，证明了线性化系统的谱稳定性不足以保证完整非线性系统的 Lyapunov 稳定性。非线性项，即使它们是高阶的，也可能起到去稳定的作用。",
            "answer": "$$ \\boxed{\\frac{1}{2} \\left(\\frac{1}{r_{0}^{2}} - \\frac{1}{\\epsilon^{2}}\\right)} $$"
        },
        {
            "introduction": "在认识到非线性项可能导致不稳定性之后，我们现在转向具有特殊结构的哈密顿系统。这个练习将引导你证明，对于一个平衡点是其能量最小值的哈密顿系统，守恒的哈密顿量本身可以作为一个李雅普诺夫函数。这种能量“势阱”有效地束缚了系统的轨迹，从而确保了非线性意义下的李雅普诺夫稳定性，这完美地解释了为何哈密顿系统中的谱稳定性往往能“升级”为真正的稳定性。",
            "id": "3755030",
            "problem": "考虑 $\\mathbb{R}^{4}$ 上的正则哈密顿系统，其坐标为 $(q_{1},q_{2},p_{1},p_{2})$，正则辛形式为 $\\omega = dq_{1} \\wedge dp_{1} + dq_{2} \\wedge dp_{2}$。设哈密顿量 $H:\\mathbb{R}^{4} \\to \\mathbb{R}$ 定义为\n$$\nH(q_{1},q_{2},p_{1},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + p_{2}^{2}\\right) + \\frac{1}{2}\\left(\\omega_{1}^{2} q_{1}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right) + \\alpha\\, q_{1}^{4} + \\beta\\, q_{2}^{4} + \\gamma\\, q_{1}^{2} q_{2}^{2},\n$$\n其中 $\\omega_{1}0$，$\\omega_{2}0$，且 $\\alpha,\\beta,\\gamma \\geq 0$。其动力学由通过 $\\iota_{X_{H}} \\omega = dH$ 定义的哈密顿向量场给出，等价地由以下常微分方程（ODE）组给出\n$$\n\\dot{q}_{1} = \\frac{\\partial H}{\\partial p_{1}},\\quad \\dot{q}_{2} = \\frac{\\partial H}{\\partial p_{2}},\\quad \\dot{p}_{1} = -\\frac{\\partial H}{\\partial q_{1}},\\quad \\dot{p}_{2} = -\\frac{\\partial H}{\\partial q_{2}}.\n$$\n具体来说，\n$$\n\\dot{q}_{1} = p_{1},\\quad \\dot{q}_{2} = p_{2},\\quad \\dot{p}_{1} = -\\omega_{1}^{2} q_{1} - 4\\alpha\\, q_{1}^{3} - 2\\gamma\\, q_{1} q_{2}^{2},\\quad \\dot{p}_{2} = -\\omega_{2}^{2} q_{2} - 4\\beta\\, q_{2}^{3} - 2\\gamma\\, q_{2} q_{1}^{2}.\n$$\n我们关注位于原点 $(q_{1},q_{2},p_{1},p_{2}) = (0,0,0,0)$ 的平衡点。\n\n从辛几何和动力系统稳定性的基本定义出发，不引用任何现成的定理，完成以下任务：\n\n- 推导上述系统在原点处的线性化并确定其谱，解释谱稳定性的概念并判断原点是否是谱稳定的。\n- 基于基本几何力学原理，为该系统构造一个李雅普诺夫函数 $V$，确保 $V$ 是强制的（即，当 $\\|x\\|\\to\\infty$ 时，$V(x) \\to +\\infty$）。从第一性原理证明强制性为何成立。\n- 证明沿着系统的轨迹，时间导数 $\\dot{V}$ 是非正的，且实际上恒为零。然后，利用与一个标量微分方程的比较论证以及 $V$ 的水平集的有界性，证明原点在非线性意义下是李雅普诺夫稳定的。\n- 在此哈密顿背景下，清晰阐述谱稳定性与李雅普诺夫稳定性之间的关系，解释为何仅有谱稳定性并不意味着非线性稳定性，但辛结构与强制的能量却能确保非线性稳定性。\n\n你的最终答案必须是你所构造的李雅普诺夫函数 $V(q_{1},q_{2},p_{1},p_{2})$ 的单一闭式解析表达式。不需要进行数值取整。最终答案中不要包含单位。",
            "solution": "问题陈述已经过验证，并被认为是具有科学依据、适定、客观且完整的。它提出了一个在几何力学和稳定性理论领域标准的、但概念丰富的问题。所有提供的信息都是一致且充分的，足以进行严谨的分析。\n\n该问题要求对给定哈密顿系统原点的稳定性进行四部分分析。我们将按照要求，从基本原理出发，依次处理每个部分。\n\n首先，我们通过对常微分方程（ODE）组进行线性化来分析原点的谱稳定性。设状态向量为 $x = (q_{1}, q_{2}, p_{1}, p_{2})^{\\top} \\in \\mathbb{R}^{4}$。动力学由 $\\dot{x} = F(x)$ 给出，其中向量场 $F$ 为\n$$\nF(q_{1}, q_{2}, p_{1}, p_{2}) = \\begin{pmatrix} p_{1} \\\\ p_{2} \\\\ -\\omega_{1}^{2} q_{1} - 4\\alpha\\, q_{1}^{3} - 2\\gamma\\, q_{1} q_{2}^{2} \\\\ -\\omega_{2}^{2} q_{2} - 4\\beta\\, q_{2}^{3} - 2\\gamma\\, q_{2} q_{1}^{2} \\end{pmatrix}.\n$$\n系统在平衡点 $x_{e} = (0,0,0,0)$ 处的线性化由线性系统 $\\dot{\\xi} = A \\xi$ 给出，其中 $A$ 是雅可比矩阵 $DF(x_{e})$。雅可比矩阵为\n$$\nA = \\begin{pmatrix}\n\\frac{\\partial \\dot{q}_{1}}{\\partial q_{1}}  \\frac{\\partial \\dot{q}_{1}}{\\partial q_{2}}  \\frac{\\partial \\dot{q}_{1}}{\\partial p_{1}}  \\frac{\\partial \\dot{q}_{1}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{q}_{2}}{\\partial q_{1}}  \\frac{\\partial \\dot{q}_{2}}{\\partial q_{2}}  \\frac{\\partial \\dot{q}_{2}}{\\partial p_{1}}  \\frac{\\partial \\dot{q}_{2}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{p}_{1}}{\\partial q_{1}}  \\frac{\\partial \\dot{p}_{1}}{\\partial q_{2}}  \\frac{\\partial \\dot{p}_{1}}{\\partial p_{1}}  \\frac{\\partial \\dot{p}_{1}}{\\partial p_{2}} \\\\\n\\frac{\\partial \\dot{p}_{2}}{\\partial q_{1}}  \\frac{\\partial \\dot{p}_{2}}{\\partial q_{2}}  \\frac{\\partial \\dot{p}_{2}}{\\partial p_{1}}  \\frac{\\partial \\dot{p}_{2}}{\\partial p_{2}}\n\\end{pmatrix}.\n$$\n计算偏导数并在原点 $(0,0,0,0)$ 处求值，得到：\n$$\nA = \\begin{pmatrix}\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-\\omega_{1}^{2}  0  0  0 \\\\\n0  -\\omega_{2}^{2}  0  0\n\\end{pmatrix}.\n$$\n线性化系统的谱是 $A$ 的特征值 $\\lambda$ 的集合，通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来确定。\n$$\n\\det \\begin{pmatrix}\n-\\lambda  0  1  0 \\\\\n0  -\\lambda  0  1 \\\\\n-\\omega_{1}^{2}  0  -\\lambda  0 \\\\\n0  -\\omega_{2}^{2}  0  -\\lambda\n\\end{pmatrix} = 0.\n$$\n由于矩阵的块结构，其行列式简化为两个 $2 \\times 2$ 子块的行列式之积：\n$$\n\\det \\begin{pmatrix} -\\lambda  1 \\\\ -\\omega_{1}^{2}  -\\lambda \\end{pmatrix} \\cdot \\det \\begin{pmatrix} -\\lambda  1 \\\\ -\\omega_{2}^{2}  -\\lambda \\end{pmatrix} = (\\lambda^{2} + \\omega_{1}^{2})(\\lambda^{2} + \\omega_{2}^{2}) = 0.\n$$\n该方程给出 $\\lambda^{2} = -\\omega_{1}^{2}$ 和 $\\lambda^{2} = -\\omega_{2}^{2}$。由于 $\\omega_{1} > 0$ 且 $\\omega_{2} > 0$，特征值为纯虚数：$\\lambda_{1,2} = \\pm i\\omega_{1}$ 和 $\\lambda_{3,4} = \\pm i\\omega_{2}$。谱为 $\\{\\pm i\\omega_{1}, \\pm i\\omega_{2}\\}$。\n平衡点的谱稳定性要求线性化系统的所有特征值都具有非正实部。在这里，所有特征值的实部均为零。因此，原点是谱稳定的。然而，它在线性层面上不是渐近稳定的，因为没有特征值具有负实部。\n\n第二，我们构造一个李雅普诺夫函数。对于保守哈密顿系统，哈密顿量 $H$ 本身是沿轨迹的守恒量，这使其成为李雅普诺夫函数的自然候选者。我们定义 $V(q_{1},q_{2},p_{1},p_{2}) = H(q_{1},q_{2},p_{1},p_{2})$。\n$$\nV(q_{1},q_{2},p_{1},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + p_{2}^{2}\\right) + \\frac{1}{2}\\left(\\omega_{1}^{2} q_{1}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right) + \\alpha\\, q_{1}^{4} + \\beta\\, q_{2}^{4} + \\gamma\\, q_{1}^{2} q_{2}^{2}.\n$$\n要成为一个用于证明原点稳定性的有效李雅普诺夫函数，$V$ 必须在原点的一个邻域内是正定的。我们观察到 $V(0,0,0,0) = 0$。对于任何其他点 $(q_{1},q_{2},p_{1},p_{2}) \\neq (0,0,0,0)$，我们分析各项。由于 $\\omega_{1}0$，$\\omega_{2}0$，$\\alpha\\geq 0$，$\\beta\\geq 0$ 且 $\\gamma\\geq 0$， $V$ 表达式中的每一项都是非负的。一组非负项的和为零，当且仅当每一项都为零。这要求 $p_{1}=p_{2}=0$，$\\omega_{1}^{2} q_{1}^{2} = 0$ 以及 $\\omega_{2}^{2} q_{2}^{2} = 0$。因为 $\\omega_{1,2} \\neq 0$，这意味着 $q_{1}=q_{2}=0$。因此，对于所有 $x \\neq 0$，$V(x) > 0$，所以 $V$ 在整个 $\\mathbb{R}^4$ 上是正定的。\n接下来，我们证明 $V$ 是强制的，意味着当范数 $\\|x\\| \\to +\\infty$ 时，$V(x) \\to +\\infty$，其中 $\\|x\\|^{2} = q_{1}^{2} + q_{2}^{2} + p_{1}^{2} + p_{2}^{2}$。我们可以为 $V$ 建立一个下界。设 $c_{\\min} = \\min\\{1, \\omega_{1}^{2}, \\omega_{2}^{2}\\}$。由于 $\\omega_{1,2}0$，$c_{\\min}0$。$V$ 的二次部分有如下下界：\n$$\n\\frac{1}{2}(p_{1}^{2} + p_{2}^{2}) + \\frac{1}{2}(\\omega_{1}^{2} q_{1}^{2} + \\omega_{2}^{2} q_{2}^{2}) \\geq \\frac{1}{2} c_{\\min} (p_{1}^{2} + p_{2}^{2} + q_{1}^{2} + q_{2}^{2}) = \\frac{1}{2} c_{\\min} \\|x\\|^{2}.\n$$\n由于四次项是非负的（$\\alpha, \\beta, \\gamma \\geq 0$），我们有\n$$\nV(x) \\geq \\frac{1}{2} c_{\\min} \\|x\\|^{2}.\n$$\n当 $\\|x\\| \\to +\\infty$ 时，下界 $\\frac{1}{2} c_{\\min} \\|x\\|^{2} \\to +\\infty$。根据比较原理，$V(x) \\to +\\infty$。因此，$V$ 是强制的。这种强制性意味着对于任何常数 $C \\geq 0$，水平集 $\\{x \\in \\mathbb{R}^{4} \\mid V(x) \\leq C\\}$ 是一个有界集。由于 $V$ 是一个连续函数，这些水平集也是闭集，因此它们是紧集。\n\n第三，我们证明李雅普诺夫稳定性。我们计算 $V$ 沿着系统轨迹的时间导数。利用链式法则以及 $V=H$ 的事实：\n$$\n\\dot{V} = \\frac{d H}{d t} = \\sum_{i=1}^{2} \\left( \\frac{\\partial H}{\\partial q_{i}} \\dot{q}_{i} + \\frac{\\partial H}{\\partial p_{i}} \\dot{p}_{i} \\right).\n$$\n代入哈密顿方程 $\\dot{q}_{i} = \\partial H/\\partial p_{i}$ 和 $\\dot{p}_{i} = -\\partial H/\\partial q_{i}$：\n$$\n\\dot{V} = \\sum_{i=1}^{2} \\left( \\frac{\\partial H}{\\partial q_{i}} \\frac{\\partial H}{\\partial p_{i}} - \\frac{\\partial H}{\\partial p_{i}} \\frac{\\partial H}{\\partial q_{i}} \\right) = \\sum_{i=1}^{2} 0 = 0.\n$$\n这证实了 $V=H$ 是一个运动常数，这是自治哈密顿系统的一个基本性质。因此，其时间导数不仅是非正的，而且是恒为零的。为了证明原点的李雅普诺夫稳定性，我们必须证明对于任何 $\\epsilon > 0$，存在一个 $\\delta > 0$，使得如果 $\\|x(0)\\|  \\delta$，那么对于所有 $t > 0$ 都有 $\\|x(t)\\|  \\epsilon$。\n给定 $\\epsilon > 0$。由于 $V$ 是强制的，球 $B_{\\epsilon}(0) = \\{x \\mid \\|x\\| \\le \\epsilon\\}$ 的边界球面 $S_{\\epsilon} = \\{x \\mid \\|x\\| = \\epsilon\\}$ 是紧集。$V$ 是连续且正定的，因此它在 $S_{\\epsilon}$ 上达到一个最小值 $C_{\\epsilon} = \\min_{\\|x\\|=\\epsilon} V(x)$，且 $C_{\\epsilon} > 0$。考虑开集 $\\mathcal{L}_{C_{\\epsilon}} = \\{x \\mid V(x)  C_{\\epsilon}\\}$。这是一个包含原点的开集。由于 $V$ 是连续的且 $V(0)=0$，存在一个 $\\delta > 0$ 使得球 $B_{\\delta}(0) = \\{x \\mid \\|x\\|  \\delta\\}$ 被包含在 $\\mathcal{L}_{C_{\\epsilon}}$ 中。现在，选择一个初始条件 $x(0)$ 使得 $\\|x(0)\\|  \\delta$。那么 $V(x(0))  C_{\\epsilon}$。\n对于 $y(t) = V(x(t))$ 的标量微分方程是 $\\dot{y} = 0$，这意味着对所有 $t$ 都有 $y(t)=y(0)$。因此，对所有 $t > 0$ 都有 $V(x(t)) = V(x(0))  C_{\\epsilon}$。这意味着整个轨迹 $x(t)$ 必须保持在集合 $\\{x \\mid V(x)  C_{\\epsilon}\\}$ 内。根据构造，该集合是球 $B_{\\epsilon}(0)$ 的一个子集（因为任何在其边界上或边界外的点都将满足 $V(x) \\geq C_{\\epsilon}$）。因此，对所有 $t>0$ 都有 $\\|x(t)\\|  \\epsilon$。这就完成了李雅普诺夫稳定性的证明。\n\n最后，我们阐述在此背景下谱稳定性与李雅普诺夫稳定性之间的关系。谱稳定性提供了关于系统基于其线性化的局部行为的信息。对于一般的动力系统，具有纯虚数特征值（在线性近似中是一个中心点）的谱稳定性是一种临界情况，不足以保证完整非线性系统的稳定性。非线性项既可以是起稳定作用的，也可以是起失稳作用的。例如，在一个简谐振子中，在 $\\dot{q}$ 中加入一个类似 $(q^2+p^2)p$ 的项可以产生一个不稳定的螺线。\n然而，对于哈密顿系统，辛结构施加了一个关键约束：能量守恒，即 $\\dot{H} = 0$。这一个事实从根本上改变了稳定性分析。如果哈密顿量 $H$ 在一个平衡点处有严格的局部极小值，就像本问题中的情况一样（由于 $\\omega_{i}0$ 以及四次项的系数非负），那么该平衡点就是李雅普诺夫稳定的。证明过程恰如上文所述：守恒的能量 $H$ 可作为李雅普诺夫函数。轨迹被限制在 $H$ 的等能面上。由于原点是一个严格的极小值点，附近的轨迹位于拓扑上是包围原点的球面的等能面上。$H$ 的强制性保证了这些等能面是有界的，从而将轨迹限制在一个小邻域内。总而言之，谱稳定性表明哈密顿量的二次部分是正定的，使原点成为线性化能量的极小值点。辛结构确保了完整的非线性能量是守恒的，而 $H$ 在原点附近的正定性确保了这个守恒量充当了一个捕获轨迹的“势阱”，从而保证了李雅普诺夫稳定性。\n\n所构造的李雅普诺夫函数是哈密顿量 $H$。",
            "answer": "$$\n\\boxed{V(q_{1},q_{2},p_{1},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + p_{2}^{2}\\right) + \\frac{1}{2}\\left(\\omega_{1}^{2} q_{1}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right) + \\alpha\\, q_{1}^{4} + \\beta\\, q_{2}^{4} + \\gamma\\, q_{1}^{2} q_{2}^{2}}\n$$"
        },
        {
            "introduction": "理论上的稳定性概念在实际应用中具有深远的影响，尤其是在数值模拟领域。这个最后的实践将展示，当我们尝试用一个不尊重其内在几何结构的数值方法去模拟一个稳定的哈密顿系统时，会发生什么。通过对比一个非辛数值积分器和一个辛积分器，你将亲眼见证谱稳定性和能量守恒等抽象性质如何直接决定一个数值算法的成败。",
            "id": "3755008",
            "problem": "考虑平面上的线性哈密顿系统，其正则坐标为 $q$ 和 $p$，哈密顿量为 $H(q,p) = \\tfrac{1}{2}\\big(p^2 + \\omega^2 q^2\\big)$，正则辛结构由标准辛矩阵 $J = \\begin{pmatrix}0  1 \\\\ -1  0\\end{pmatrix}$ 给出。其运动方程可以写成一阶常微分方程 (ODE) $x'(t) = M x(t)$ 的形式，其中 $x = \\begin{pmatrix}q \\\\ p\\end{pmatrix}$，常系数矩阵为 $M = \\begin{pmatrix}0  1 \\\\ -\\omega^2  0\\end{pmatrix}$。对于此哈密顿系统，精确的时间-$h$ 流映射为 $\\exp(h M)$，该映射是辛的且谱稳定的，即对于任意实数 $h$，所有特征值的模均为1。\n\n您的任务是通过计算证明，一个非辛单步法可以对这个谱稳定的哈密顿系统表现出伪谱不稳定性，并且这种不稳定性在数值上表现为能量增长形式的李雅普诺夫稳定性的丧失。为此目的：\n\n- 为线性系统 $x'(t) = M x(t)$ 实现两个单步积分器：\n  1. 一种非辛前向法，由该ODE的一阶显式离散化定义。\n  2. 一种辛方法，由应用于该线性系统的隐式中点 Runge–Kutta 格式定义。\n\n- 对于任意给定的步长 $h$，每种单步法都会导出一个 $2 \\times 2$ 的放大矩阵 $A(h)$，它将状态 $x_n$ 映射到 $x_{n+1}$。对于每种方法和下面的测试套件中的每个参数集：\n  1. 计算谱半径 $\\rho(A)$，其定义为矩阵 $A$ 特征值的最大模。\n  2. 从初始条件 $x_0 = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$ 开始，计算 $x_N = A^N x_0$，然后计算相对能量变化 $\\Delta_{\\mathrm{rel}} = \\frac{H(x_N) - H(x_0)}{H(x_0)}$，其中 $H(x) = \\tfrac{1}{2}\\big(p^2 + \\omega^2 q^2\\big)$。\n  3. 报告非辛前向法和辛式隐式中点法的 $\\rho(A)$ 和 $\\Delta_{\\mathrm{rel}}$。\n\n- 使用以下参数三元组 $(\\omega, h, N)$ 的测试套件，其选择覆盖了典型情况、中度不稳定性、更高频率、边界情况以及大步长情况：\n  1. $(\\omega, h, N) = (1.0, 0.05, 500)$\n  2. $(\\omega, h, N) = (1.0, 0.5, 40)$\n  3. $(\\omega, h, N) = (2.0, 0.2, 100)$\n  4. $(\\omega, h, N) = (3.0, 0.0, 100)$\n  5. $(\\omega, h, N) = (1.0, 2.0, 5)$\n\n- 对于每个测试用例，您的程序应按 $[\\rho_{\\mathrm{forward}}, \\rho_{\\mathrm{midpoint}}, \\Delta_{\\mathrm{rel,forward}}, \\Delta_{\\mathrm{rel,midpoint}}]$ 的顺序生成一个包含四个数字的列表，其中每个数字都是四舍五入到六位小数的浮点值。\n\n- 最终输出格式：您的程序应生成单行输出，其中包含所有测试用例的结果，形式为这些四元素列表的逗号分隔列表，不含嵌入空格，并用方括号括起来。例如：\"[[r1,r2,r3,r4],[r1,r2,r3,r4],...]\"。\n\n不涉及物理单位，如果出现角度，应以弧度为单位。所有数学实体必须用 LaTeX 书写。您的实现必须是自包含的，不接受任何输入，并且仅依赖于标准库和指定的数值库。每个测试用例的答案必须是如上所述的浮点数列表。",
            "solution": "所述问题在科学上是合理的、适定的，并包含唯一解所需的所有信息。它涉及数值分析和几何力学中的一个基本主题：应用于哈密顿系统的辛积分器和非辛积分器在稳定性和守恒性方面的差异。所选系统是简谐振子，这是该领域的经典模型。指定的任务在计算上是可行的，所要求的输出是明确定义的。因此，我将进行完整的解答。\n\n该问题要求分析用于线性哈密顿系统的两种数值单步法，该系统由常微分方程 (ODE) $x'(t) = M x(t)$ 描述，其中 $x(t) = \\begin{pmatrix} q(t) \\\\ p(t) \\end{pmatrix}$ 且 $M = \\begin{pmatrix} 0  1 \\\\ -\\omega^2  0 \\end{pmatrix}$。步长为 $h$ 的单步法通过序列 $x_{n+1} = A(h) x_n$ 来近似解，其中 $A(h)$ 是 $2 \\times 2$ 的放大矩阵。我们将为每种方法推导该矩阵并分析其性质。\n\n该系统的哈密顿量为 $H(q,p) = \\frac{1}{2}(p^2 + \\omega^2 q^2)$。对于初始条件 $x_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，初始能量为 $H(x_0) = \\frac{1}{2}(0^2 + \\omega^2 \\cdot 1^2) = \\frac{1}{2}\\omega^2$。经过 $N$ 步后，状态为 $x_N = A^N x_0 = \\begin{pmatrix} q_N \\\\ p_N \\end{pmatrix}$，能量为 $H(x_N) = \\frac{1}{2}(p_N^2 + \\omega^2 q_N^2)$。因此，相对能量变化为\n$$\n\\Delta_{\\mathrm{rel}} = \\frac{H(x_N) - H(x_0)}{H(x_0)} = \\frac{\\frac{1}{2}(p_N^2 + \\omega^2 q_N^2) - \\frac{1}{2}\\omega^2}{\\frac{1}{2}\\omega^2} = \\frac{p_N^2 + \\omega^2 q_N^2}{\\omega^2} - 1\n$$\n此公式在 $\\omega \\neq 0$ 时有效，对于所有可能发生非零能量变化的测试用例，该条件都成立。\n\n**1. 非辛前向法（显式欧拉法）**\n\n对于 ODE $x' = f(x)$，显式欧拉法为 $x_{n+1} = x_n + h f(x_n)$。对于我们的线性系统，$f(x) = Mx$，因此迭代为：\n$$\nx_{n+1} = x_n + h M x_n = (I + hM) x_n\n$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。因此，放大矩阵为：\n$$\nA_{\\mathrm{forward}} = I + hM = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + h \\begin{pmatrix} 0  1 \\\\ -\\omega^2  0 \\end{pmatrix} = \\begin{pmatrix} 1  h \\\\ -h\\omega^2  1 \\end{pmatrix}\n$$\n为求谱半径 $\\rho(A_{\\mathrm{forward}})$，我们从特征方程 $\\det(A_{\\mathrm{forward}} - \\lambda I) = 0$ 计算特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix} 1-\\lambda  h \\\\ -h\\omega^2  1-\\lambda \\end{pmatrix} = (1-\\lambda)^2 + h^2\\omega^2 = 0\n$$\n特征值为 $\\lambda = 1 \\pm i h \\omega$。这些特征值的模为：\n$$\n|\\lambda| = \\sqrt{1^2 + (h\\omega)^2} = \\sqrt{1 + h^2\\omega^2}\n$$\n谱半径是最大模，所以 $\\rho(A_{\\mathrm{forward}}) = \\sqrt{1 + h^2\\omega^2}$。对于任意实数 $h0$ 和 $\\omega \\neq 0$，我们有 $\\rho(A_{\\mathrm{forward}})  1$。这表明该方法是谱不稳定的；数值解的幅值将在每一步增长，这对应于非物理的能量增加。这证明了伪数值不稳定性。\n\n**2. 辛式隐式中点法**\n\n对于 ODE $x' = f(x)$，隐式中点法由下式给出：\n$$\nx_{n+1} = x_n + h f\\left(\\frac{x_n + x_{n+1}}{2}\\right)\n$$\n对于我们的线性系统，这变为：\n$$\nx_{n+1} = x_n + h M \\left(\\frac{x_n + x_{n+1}}{2}\\right)\n$$\n我们求解 $x_{n+1}$：\n$$\nx_{n+1} - \\frac{h}{2} M x_{n+1} = x_n + \\frac{h}{2} M x_n\n$$\n$$\n\\left(I - \\frac{h}{2} M\\right) x_{n+1} = \\left(I + \\frac{h}{2} M\\right) x_n\n$$\n因此，放大矩阵 $A_{\\mathrm{midpoint}}$ 为：\n$$\nA_{\\mathrm{midpoint}} = \\left(I - \\frac{h}{2} M\\right)^{-1} \\left(I + \\frac{h}{2} M\\right)\n$$\n这种形式被称为矩阵 $\\frac{h}{2}M$ 的 Cayley 变换。Cayley 变换的一个关键性质是它将斜埃尔米特矩阵映射到幺正矩阵，并且在实矩阵的背景下，它将李群的李代数中的矩阵映射到李群本身。在这里，$M$ 属于辛群的李代数 $\\mathfrak{sp}(2, \\mathbb{R})$，因为 $(JM)$ 是对称的，其中 $J = \\begin{pmatrix}01\\\\-10\\end{pmatrix}$：\n$$\nJM = \\begin{pmatrix}01\\\\-10\\end{pmatrix} \\begin{pmatrix}01\\\\-\\omega^20\\end{pmatrix} = \\begin{pmatrix}-\\omega^20\\\\0-1\\end{pmatrix}\n$$\n由于 $(JM)^T = JM$，因此 $M \\in \\mathfrak{sp}(2, \\mathbb{R})$。因此，Cayley 变换 $A_{\\mathrm{midpoint}}$ 是一个辛矩阵，即 $A_{\\mathrm{midpoint}}^T J A_{\\mathrm{midpoint}} = J$。辛映射的特征值以倒数对 $(\\lambda, 1/\\lambda)$ 的形式出现，或位于单位圆上。对于此系统，$A_{\\mathrm{midpoint}}$ 的特征值位于单位圆上。\n\n我们也可以直接计算它们。$A_{\\mathrm{midpoint}}$ 的特征值 $\\mu$ 与 $\\frac{h}{2}M$ 的特征值 $\\nu$ 通过映射 $\\mu = \\frac{1+\\nu}{1-\\nu}$ 相关联。$M$ 的特征值是 $\\pm i\\omega$，所以 $\\frac{h}{2}M$ 的特征值是 $\\nu = \\pm i \\frac{h\\omega}{2}$。$A_{\\mathrm{midpoint}}$ 的特征值是：\n$$\n\\mu = \\frac{1 \\pm i \\frac{h\\omega}{2}}{1 \\mp i \\frac{h\\omega}{2}}\n$$\n这些特征值的模为：\n$$\n|\\mu| = \\frac{\\left|1 \\pm i \\frac{h\\omega}{2}\\right|}{\\left|1 \\mp i \\frac{h\\omega}{2}\\right|} = \\frac{\\sqrt{1^2 + (h\\omega/2)^2}}{\\sqrt{1^2 + (h\\omega/2)^2}} = 1\n$$\n因此，对于所有实数 $h$ 和 $\\omega$，谱半径 $\\rho(A_{\\mathrm{midpoint}}) = 1$。该方法是谱稳定的，正确反映了底层物理系统的性质。对于二次哈密顿量，这也意味着数值方法能精确守恒能量，因此我们预期 $\\Delta_{\\mathrm{rel,midpoint}}$ 在浮点精度误差范围内为零。\n\n下面的计算实现将为指定的测试用例计算这些量，展示前向方法的能量增长（$\\Delta_{\\mathrm{rel,forward}}  0$）和谱不稳定性（$\\rho_{\\mathrm{forward}}  1$），与辛式中点法的能量守恒（$\\Delta_{\\mathrm{rel,midpoint}} \\approx 0$）和谱稳定性（$\\rho_{\\mathrm{midpoint}} = 1$）形成对比。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing non-symplectic and symplectic integrators\n    for a simple Hamiltonian system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.05, 500),\n        (1.0, 0.5, 40),\n        (2.0, 0.2, 100),\n        (3.0, 0.0, 100),\n        (1.0, 2.0, 5),\n    ]\n\n    results = []\n    # Initial condition x0 = [q0, p0]^T\n    x0 = np.array([1.0, 0.0])\n    # 2x2 Identity matrix\n    I = np.identity(2)\n\n    for case in test_cases:\n        omega, h, N = case\n\n        # Handle the edge case h=0. Both methods become the identity map.\n        if h == 0.0:\n            results.append([1.0, 1.0, 0.0, 0.0])\n            continue\n        \n        # Define the system matrix M\n        M = np.array([[0.0, 1.0], [-omega**2, 0.0]])\n\n        # Initial energy H(x0) = 0.5 * (p0^2 + omega^2 * q0^2)\n        # For x0 = [1, 0], H(x0) = 0.5 * omega^2\n        H0 = 0.5 * omega**2\n\n        # 1. Non-symplectic forward method\n        # Amplification matrix A_fwd = I + h*M\n        A_fwd = I + h * M\n        \n        # Compute spectral radius of A_fwd\n        eigvals_fwd = np.linalg.eigvals(A_fwd)\n        rho_fwd = np.max(np.abs(eigvals_fwd))\n        \n        # Compute final state xN and relative energy change\n        # xN = A^N * x0\n        xN_fwd = np.linalg.matrix_power(A_fwd, N) @ x0\n        qN_fwd, pN_fwd = xN_fwd\n        # HN = 0.5 * (pN^2 + omega^2 * qN^2)\n        HN_fwd = 0.5 * (pN_fwd**2 + (omega * qN_fwd)**2)\n        # Relative energy change: (HN - H0) / H0\n        delta_rel_fwd = (HN_fwd - H0) / H0\n\n        # 2. Symplectic implicit midpoint method\n        # Amplification matrix A_mid = inv(I - 0.5*h*M) @ (I + 0.5*h*M)\n        try:\n            inv_term = np.linalg.inv(I - 0.5 * h * M)\n        except np.linalg.LinAlgError:\n            # This should not happen for the given system and parameters\n            # as det(I - kM) = 1 + k^2*omega^2 > 0\n            A_mid = np.full((2,2), np.nan) # Mark as invalid if inversion fails\n        else:\n            A_mid = inv_term @ (I + 0.5 * h * M)\n\n        # Compute spectral radius of A_mid\n        eigvals_mid = np.linalg.eigvals(A_mid)\n        rho_mid = np.max(np.abs(eigvals_mid))\n        \n        # Compute final state xN and relative energy change\n        xN_mid = np.linalg.matrix_power(A_mid, N) @ x0\n        qN_mid, pN_mid = xN_mid\n        HN_mid = 0.5 * (pN_mid**2 + (omega * qN_mid)**2)\n        delta_rel_mid = (HN_mid - H0) / H0\n\n        # Collect and round results to six decimal places\n        case_results = [\n            round(rho_fwd, 6),\n            round(rho_mid, 6),\n            round(delta_rel_fwd, 6),\n            round(delta_rel_mid, 6)\n        ]\n        results.append(case_results)\n\n    # Format the final output string as specified\n    # The format is a list of lists, comma-separated, with no spaces.\n    # Example: [[r1,r2,r3,r4],[r1,r2,r3,r4],...]\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in results]) + \"]\"\n\n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}