{
    "hands_on_practices": [
        {
            "introduction": "多维谐振子是完全可积系统的原型。本练习从第一性原理出发，为该系统推导作用量-角度变量。掌握这一过程至关重要，因为它揭示了系统的潜在环面结构，并将动力学简化为线性流动，这是几何力学中的一项基本技能。",
            "id": "3750346",
            "problem": "考虑在$\\mathbb{R}^{2n}$上的自治哈密顿系统，其标准辛形式为 $\\omega_{\\mathrm{std}} = \\sum_{i=1}^{n} \\mathrm{d}q_{i} \\wedge \\mathrm{d}p_{i}$，哈密顿量为\n$$\nH(q,p) \\;=\\; \\sum_{i=1}^{n} \\left( \\frac{1}{2} \\, p_{i}^{2} \\;+\\; \\frac{1}{2} \\, \\omega_{i}^{2} \\, q_{i}^{2} \\right),\n$$\n其中 $q = (q_{1},\\dots,q_{n}) \\in \\mathbb{R}^{n}$，$p = (p_{1},\\dots,p_{n}) \\in \\mathbb{R}^{n}$，并且每个 $\\omega_{i} \\in \\mathbb{R}_{>0}$ 是一个固定的正常数。从辛几何和哈密顿力学的基本定义出发，完成以下任务：\n\n- 将与此可积系统相关的不变拉格朗日环面推导为适当定义的作用量变量的水平集。通过沿不变环面的独立基本圈对典范1-形式进行线积分，明确地确定 $n$ 个作用量变量 $(I_{1},\\dots,I_{n})$。\n- 构造到作用量-角度坐标 $(I,\\theta) = \\big( (I_{1},\\dots,I_{n}),(\\theta_{1},\\dots,\\theta_{n}) \\big)$ 的典范变换，并为每个 $i \\in \\{1,\\dots,n\\}$ 提供用 $(I_{i},\\theta_{i})$ 表示 $(q_{i},p_{i})$ 的显式公式。\n- 使用作用量-角度变量下的哈密顿方程，确定每个不变环面上的频率向量 $\\Omega(I) = \\left( \\dot{\\theta}_{1},\\dots,\\dot{\\theta}_{n} \\right)$，并描述其对作用量变量的依赖关系。\n\n你的推理必须从第一性原理出发：辛形式的定义、典范1-形式、哈密顿方程，以及通过作用量积分和典范变换定义的作用量-角度变量。不得在没有论证的情况下引用现成公式。\n\n答案规格：\n- 以哈密顿量纯粹用作用量变量表示的单一闭式解析表达式的形式提供你最终的加框答案，即 $H(I_{1},\\dots,I_{n})$。无需单位。",
            "solution": "问题是分析 $n$ 个非耦合谐振子的哈密顿系统，找到其不变环面，构造作用量-角度坐标，并确定由此产生的动力学。我们将从所提供的基本定义出发。\n\n相空间为 $\\mathbb{R}^{2n}$，坐标为 $(q,p) = (q_1, \\dots, q_n, p_1, \\dots, p_n)$。\n给定的辛形式为 $\\omega_{\\mathrm{std}} = \\sum_{i=1}^{n} \\mathrm{d}q_{i} \\wedge \\mathrm{d}p_{i}$。\n哈密顿量为 $H(q,p) = \\sum_{i=1}^{n} H_i(q_i, p_i)$，其中 $H_i(q_i, p_i) = \\frac{1}{2} p_i^2 + \\frac{1}{2} \\omega_i^2 q_i^2$。\n\n首先，我们来推导该系统的哈密顿方程。对于给定的标准辛形式，标准的哈密顿方程为：\n$$\n\\dot{q}_i = \\frac{\\partial H}{\\partial p_i} \\quad \\text{和} \\quad \\dot{p}_i = -\\frac{\\partial H}{\\partial q_i}\n$$\n对于我们特定的哈密顿量，这些方程变为：\n$$\n\\dot{q}_i = p_i \\quad \\text{和} \\quad \\dot{p}_i = -\\omega_i^2 q_i\n$$\n对第一个方程关于时间求导得到 $\\ddot{q}_i = \\dot{p}_i = -\\omega_i^2 q_i$，这是谐振子的标准方程 $\\ddot{q}_i + \\omega_i^2 q_i = 0$。\n\n哈密顿量是 $n$ 个函数之和，$H = \\sum_{i=1}^n H_i(q_i, p_i)$，其中每个 $H_i$ 仅依赖于坐标对 $(q_i, p_i)$。该系统是可分离的。每对 $(q_i, p_i)$ 的动力学都与其他对无关。各个哈密顿量 $H_i$ 本身就是运动常数，因为 $\\{H_i, H\\} = \\{H_i, \\sum_j H_j\\} = \\sum_j \\{H_i, H_j\\} = 0$，这是由于当 $i \\neq j$ 时 $\\{H_i, H_j\\}=0$（变量不相交）且 $\\{H_i, H_i\\}=0$。这 $n$ 个函数 $H_1, \\dots, H_n$ 是 Liouville-Arnold 可积性所要求的对合的独立运动积分。\n\n对于每个子系统 $i$，运动被约束在水平集 $H_i(q_i, p_i) = E_i$ 上，其中 $E_i > 0$ 是一个恒定的能量。方程 $\\frac{1}{2} p_i^2 + \\frac{1}{2} \\omega_i^2 q_i^2 = E_i$ 描述了 $(q_i, p_i)$ 相平面中的一个椭圆。整个系统的运动被约束在这 $n$ 个椭圆的乘积上。拓扑上，每个椭圆都是一个圆 ($S^1$)。因此，集体运动积分 $(H_1, \\dots, H_n)$ 的水平集是一个 $n$ 维环面 $T^n = S^1 \\times \\dots \\times S^1$。这些就是系统的不变拉格朗日环面。\n\n作用量变量 $(I_1, \\dots, I_n)$ 是通过在不变环面的一组基本圈上对典范1-形式 $\\alpha = \\sum_i p_i \\mathrm{d}q_i$ 进行积分来定义的。由于环面是一个乘积，我们可以选择圈 $\\gamma_i$ 作为每个 $(q_i, p_i)$ 平面中的单个椭圆。作用量 $I_i$ 定义为：\n$$\nI_i = \\frac{1}{2\\pi} \\oint_{\\gamma_i} p_i \\, \\mathrm{d}q_i\n$$\n其中 $\\gamma_i$ 是由 $H_i(q_i, p_i) = E_i$ 定义的曲线。积分 $\\oint p_i \\, \\mathrm{d}q_i$ 表示椭圆所围成的面积。椭圆的方程是 $\\frac{q_i^2}{a^2} + \\frac{p_i^2}{b^2} = 1$，其中半轴为 $a = \\sqrt{2E_i / \\omega_i^2}$ 和 $b = \\sqrt{2E_i}$。椭圆的面积是 $\\pi a b$。\n$$\n\\text{面积} = \\pi \\left(\\frac{\\sqrt{2E_i}}{\\omega_i}\\right) (\\sqrt{2E_i}) = \\frac{2\\pi E_i}{\\omega_i}\n$$\n因此，作用量变量 $I_i$ 是：\n$$\nI_i = \\frac{1}{2\\pi} \\left( \\frac{2\\pi E_i}{\\omega_i} \\right) = \\frac{E_i}{\\omega_i}\n$$\n这给了我们每个振子的能量与其相应作用量之间的关系：$E_i = I_i \\omega_i$。\n\n现在我们构造到作用量-角度坐标 $(I_i, \\theta_i)$ 的典范变换。目标是找到新的坐标，使得哈密顿量只依赖于作用量 $I_i$。基于椭圆运动，我们为每个 $i \\in \\{1, \\dots, n\\}$ 提出以下变换：\n$$\nq_i(I_i, \\theta_i) = \\sqrt{\\frac{2I_i}{\\omega_i}} \\sin \\theta_i\n$$\n$$\np_i(I_i, \\theta_i) = \\sqrt{2I_i \\omega_i} \\cos \\theta_i\n$$\n为了验证这是一个典范变换，我们检查它是否保持辛形式的结构。我们计算微分：\n$$\n\\mathrm{d}q_i = \\frac{\\partial q_i}{\\partial I_i} \\mathrm{d}I_i + \\frac{\\partial q_i}{\\partial \\theta_i} \\mathrm{d}\\theta_i = \\frac{1}{\\sqrt{2I_i \\omega_i}} \\sin \\theta_i \\, \\mathrm{d}I_i + \\sqrt{\\frac{2I_i}{\\omega_i}} \\cos \\theta_i \\, \\mathrm{d}\\theta_i\n$$\n$$\n\\mathrm{d}p_i = \\frac{\\partial p_i}{\\partial I_i} \\mathrm{d}I_i + \\frac{\\partial p_i}{\\partial \\theta_i} \\mathrm{d}\\theta_i = \\sqrt{\\frac{\\omega_i}{2I_i}} \\cos \\theta_i \\, \\mathrm{d}I_i - \\sqrt{2I_i \\omega_i} \\sin \\theta_i \\, \\mathrm{d}\\theta_i\n$$\n现在我们计算楔积 $\\mathrm{d}q_i \\wedge \\mathrm{d}p_i$：\n\\begin{align*}\n\\mathrm{d}q_i \\wedge \\mathrm{d}p_i = \\left( \\frac{\\partial q_i}{\\partial I_i} \\frac{\\partial p_i}{\\partial \\theta_i} - \\frac{\\partial q_i}{\\partial \\theta_i} \\frac{\\partial p_i}{\\partial I_i} \\right) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n= \\left( (\\frac{1}{\\sqrt{2I_i \\omega_i}} \\sin \\theta_i)(-\\sqrt{2I_i \\omega_i} \\sin \\theta_i) - (\\sqrt{\\frac{2I_i}{\\omega_i}} \\cos \\theta_i)(\\sqrt{\\frac{\\omega_i}{2I_i}} \\cos \\theta_i) \\right) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n= (-\\sin^2 \\theta_i - \\cos^2 \\theta_i) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n= -1 \\cdot \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i = \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i\n\\end{align*}\n对所有 $i$ 求和，辛形式变为 $\\omega' = \\sum_{i=1}^n \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i$。这正是标准的辛形式，其中作用量 $I_i$ 扮演动量坐标的角色，角度 $\\theta_i$ 扮演位置坐标的角色。因此，对于变换后的哈密顿量 $K(I, \\theta)$，哈密顿方程具有标准形式：\n$$\n\\dot{I}_i = -\\frac{\\partial K}{\\partial \\theta_i} \\quad \\text{和} \\quad \\dot{\\theta}_i = \\frac{\\partial K}{\\partial I_i}\n$$\n用作用量-角度坐标表示的哈密顿量，记作 $K(I, \\theta)$，是通过将变换代入 $H(q,p)$ 得到的：\n$$\nK(I, \\theta) = \\sum_{i=1}^n \\left( \\frac{1}{2} (\\sqrt{2I_i \\omega_i} \\cos \\theta_i)^2 + \\frac{1}{2} \\omega_i^2 (\\sqrt{\\frac{2I_i}{\\omega_i}} \\sin \\theta_i)^2 \\right)\n$$\n$$\nK(I, \\theta) = \\sum_{i=1}^n \\left( \\frac{1}{2} (2I_i \\omega_i \\cos^2 \\theta_i) + \\frac{1}{2} \\omega_i^2 (\\frac{2I_i}{\\omega_i} \\sin^2 \\theta_i) \\right)\n$$\n$$\nK(I, \\theta) = \\sum_{i=1}^n ( I_i \\omega_i \\cos^2 \\theta_i + I_i \\omega_i \\sin^2 \\theta_i ) = \\sum_{i=1}^n I_i \\omega_i\n$$\n正如所要求的那样，变换后的哈密顿量 $K$ 仅依赖于作用量变量 $I_i$。我们将其记为 $H(I_1, \\dots, I_n)$。\n\n最后，我们使用新坐标下的哈密顿方程来确定频率向量 $\\Omega(I) = (\\dot{\\theta}_1, \\dots, \\dot{\\theta}_n)$：\n$$\n\\dot{I}_i = -\\frac{\\partial K}{\\partial \\theta_i} = -\\frac{\\partial}{\\partial \\theta_i} \\left( \\sum_{j=1}^n I_j \\omega_j \\right) = 0\n$$\n这证实了作用量 $I_i$ 确实是运动常数。\n$$\n\\dot{\\theta}_i = \\frac{\\partial K}{\\partial I_i} = \\frac{\\partial}{\\partial I_i} \\left( \\sum_{j=1}^n I_j \\omega_j \\right) = \\omega_i\n$$\n每个角度变量的频率是一个常数，$\\dot{\\theta}_i = \\omega_i$。不变环面上的运动是线性流。频率向量是 $\\Omega(I) = (\\omega_1, \\dots, \\omega_n)$。这个结果表明，对于谐振子，不变环面上的运动频率与作用量 $I_i$ 无关（即与振荡的振幅或能量无关）。\n以作用量变量表示的哈密顿量的最终表达式是变换后的哈密顿量 $K(I)$。\n$$ H(I_1, \\dots, I_n) = \\sum_{i=1}^n I_i \\omega_i $$",
            "answer": "$$\\boxed{\\sum_{i=1}^{n} I_{i} \\omega_{i}}$$"
        },
        {
            "introduction": "当一个可积系统受到微扰时，并非其所有的不变环面都能继续存在。KAM理论告诉我们，环面的存续取决于其频率向量的“无理性”程度，这一性质通过丢番图条件来精确描述。本练习提供了一个具体的计算，通过分析一个近共振系统的频率比，来检验这一关键的算术条件。",
            "id": "3750316",
            "problem": "考虑一个由两个解耦的线性振子组成的两自由度可积哈密顿系统，其正则坐标为 $(q_{1},p_{1},q_{2},p_{2})$，哈密顿量为\n$$\nH(q_{1},p_{1},q_{2},p_{2}) \\;=\\; \\frac{1}{2}\\left(p_{1}^{2} + \\omega_{1}^{2} q_{1}^{2}\\right) \\;+\\; \\frac{1}{2}\\left(p_{2}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right),\n$$\n其中 $\\omega_{1}$ 和 $\\omega_{2}$ 为正常数。在每个谐振子的作用量-角变量 $(I_{1},\\theta_{1},I_{2},\\theta_{2})$ 下，由固定的作用量 $(I_{1},I_{2})$ 所给出的不变环面支持一个准周期流，其恒定频率由频率向量给出\n$$\n\\boldsymbol{\\omega} \\;=\\; \\left(\\omega_{1},\\,\\omega_{2}\\right).\n$$\n如果存在不全为零的整数 $m_{1},m_{2}$，使得 $m_{1}\\omega_{1} + m_{2}\\omega_{2} = 0$，则称该环面为共振环面。否则称为非共振环面。在 Kolmogorov-Arnold-Moser (KAM) 理论的背景下，如果对于指数 $\\tau \\geq 1$ 和常数 $\\gamma > 0$，一个非共振环面满足以下条件，则称其为丢番图环面\n$$\n|m_{1}\\omega_{1} + m_{2}\\omega_{2}| \\;\\geq\\; \\gamma \\,\\left(|m_{1}|+|m_{2}|\\right)^{-\\tau}\n\\quad\\text{对所有}\\quad (m_{1},m_{2}) \\in \\mathbb{Z}^{2}\\setminus\\{(0,0)\\}.\n$$\n\n假设系统通过第二个振子中的一个小失谐参数 $\\delta$ 靠近 $(3:2)$ 共振，具体为\n$$\n\\omega_{1} \\;=\\; 1,\n\\qquad\n\\omega_{2} \\;=\\; \\frac{3}{2} \\;+\\; \\delta,\n\\qquad\n\\delta \\;=\\; \\phi^{-4},\n\\qquad\n\\phi \\;=\\; \\frac{1+\\sqrt{5}}{2}.\n$$\n计算此不变环面的精确频率比 $r = \\omega_{2}/\\omega_{1}$。然后，从上述共振和丢番图条件的定义出发，利用关于谐振子在作用量-角变量下的第一性原理以及二次无理数的熟知性质，评估在指定的参数值下，该环面是共振的还是丢番图的。\n\n将最终答案表示为 $r$ 的精确闭式解析表达式。无需四舍五入。无需单位。",
            "solution": "该问题要求分析一个两自由度哈密顿系统中的不变环面。任务是计算在特定参数选择下的频率比 $r = \\omega_{2}/\\omega_{1}$，然后根据所提供的定义，判断相应的环面是共振的还是丢番图的。\n\n首先，我们根据问题陈述建立背景。该系统由哈密顿量描述：\n$$\nH(q_{1},p_{1},q_{2},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + \\omega_{1}^{2} q_{1}^{2}\\right) + \\frac{1}{2}\\left(p_{2}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right)\n$$\n这代表了两个解耦的谐振子。在作用量-角变量 $(I_k, \\theta_k)$ 中，单个振子 $k$ 的哈密顿量是 $H_k = \\omega_k I_k$。总哈密顿量是 $H(I_1, I_2) = H_1 + H_2 = \\omega_1 I_1 + \\omega_2 I_2$。角变量的哈密顿方程为 $\\dot{\\theta}_k = \\frac{\\partial H}{\\partial I_k} = \\omega_k$，这证实了在不变环面（$I_1, I_2$ 固定）上的运动以恒定频率向量 $\\boldsymbol{\\omega} = (\\omega_1, \\omega_2)$ 发生。\n\n问题给出了具体的参数值：\n$$\n\\omega_{1} = 1\n$$\n$$\n\\omega_{2} = \\frac{3}{2} + \\delta, \\quad \\text{其中} \\quad \\delta = \\phi^{-4}\n$$\n常数 $\\phi$ 是黄金比例，$\\phi = \\frac{1+\\sqrt{5}}{2}$。\n\n我们的第一个任务是计算精确的频率比 $r = \\omega_{2}/\\omega_{1}$。给定 $\\omega_1=1$，这个比率就是 $r = \\omega_2$。\n$$\nr = \\frac{\\omega_{2}}{\\omega_{1}} = \\frac{\\frac{3}{2} + \\phi^{-4}}{1} = \\frac{3}{2} + \\phi^{-4}\n$$\n为了求出 $r$ 的精确值，我们必须计算 $\\phi^{-4}$。黄金比例 $\\phi$ 满足特征二次方程 $x^2 - x - 1 = 0$，这意味着 $\\phi^2 = \\phi + 1$。由此，我们也可以推导出 $\\phi^{-1} = \\phi - 1$。我们可以递归地计算 $\\phi^{-4}$：\n$$\n\\phi^{-2} = (\\phi^{-1})^{2} = (\\phi - 1)^2 = \\phi^2 - 2\\phi + 1 = (\\phi+1) - 2\\phi + 1 = 2 - \\phi\n$$\n$$\n\\phi^{-4} = (\\phi^{-2})^{2} = (2 - \\phi)^2 = 4 - 4\\phi + \\phi^2 = 4 - 4\\phi + (\\phi+1) = 5 - 3\\phi\n$$\n现在，我们代入 $\\phi$ 的数值：\n$$\n\\phi^{-4} = 5 - 3\\left(\\frac{1+\\sqrt{5}}{2}\\right) = 5 - \\frac{3}{2} - \\frac{3\\sqrt{5}}{2} = \\frac{10 - 3 - 3\\sqrt{5}}{2} = \\frac{7 - 3\\sqrt{5}}{2}\n$$\n我们现在可以计算频率比 $r$：\n$$\nr = \\frac{3}{2} + \\phi^{-4} = \\frac{3}{2} + \\frac{7 - 3\\sqrt{5}}{2} = \\frac{3 + 7 - 3\\sqrt{5}}{2} = \\frac{10 - 3\\sqrt{5}}{2}\n$$\n\n接下来，我们评估该环面是共振的还是丢番图的。\n\n如果存在整数 $(m_1, m_2) \\in \\mathbb{Z}^2 \\setminus \\{(0,0)\\}$ 使得 $m_1 \\omega_1 + m_2 \\omega_2 = 0$，则环面是共振的。当 $\\omega_1=1$ 和 $\\omega_2=r$ 时，此条件变为 $m_1 + m_2 r = 0$。如果 $m_2 \\neq 0$，则意味着 $r = -m_1/m_2$，即 $r$ 必须是一个有理数。如果 $m_2=0$，那么 $m_1$ 也必须是 $0$，这种情况被排除。我们计算出的比值为 $r = \\frac{10 - 3\\sqrt{5}}{2} = 5 - \\frac{3}{2}\\sqrt{5}$。由于 $\\sqrt{5}$ 是一个无理数，所以 $r$ 也是一个无理数。具体来说，它是一个有理数 ($5$) 和一个无理数 ($\\sqrt{5}$) 在有理系数 ($-3/2$) 下的线性组合，其结果是一个无理数。因为 $r$ 是无理数，它不能表示为两个整数之比。因此，对于任何非零整数对 $(m_1, m_2)$，共振条件 $m_1 + m_2 r = 0$ 都不满足。该环面是非共振的。\n\n现在，我们检查该环面是否为丢番图的。一个非共振环面是丢番图的，如果对于某些常数 $\\tau \\ge 1$ 和 $\\gamma > 0$，以下不等式对所有 $(m_1, m_2) \\in \\mathbb{Z}^2 \\setminus \\{(0,0)\\}$ 都成立：\n$$\n|m_{1}\\omega_{1} + m_{2}\\omega_{2}| \\ge \\gamma (|m_{1}|+|m_{2}|)^{-\\tau}\n$$\n代入 $\\omega_1 = 1$ 和 $\\omega_2 = r$，得到：\n$$\n|m_1 + m_2 r| \\ge \\gamma (|m_1|+|m_2|)^{-\\tau}\n$$\n数 $r = \\frac{10 - 3\\sqrt{5}}{2}$ 是一个二次无理数，因为它是某个整系数二次方程的根。让我们找出这个方程：\n$$\nx = \\frac{10 - 3\\sqrt{5}}{2} \\\\\n2x = 10 - 3\\sqrt{5} \\\\\n2x - 10 = -3\\sqrt{5} \\\\\n(2x - 10)^2 = (-3\\sqrt{5})^2 \\\\\n4x^2 - 40x + 100 = 45 \\\\\n4x^2 - 40x + 55 = 0\n$$\n设 $P(x) = 4x^2 - 40x + 55$。我们已经证明了 $P(r) = 0$。\n丢番图逼近理论中的一个基石性结果是，二次无理数可被有理数“坏逼近”。这个性质直接导致它们满足丢番图条件。我们可以从第一性原理证明这一点。\n\n对于任何整数 $m_1, m_2$ 且 $m_2 \\neq 0$，让我们在有理数 $-m_1/m_2$ 处计算多项式 $P$ 的值：\n$$\nP(-m_1/m_2) = 4\\left(\\frac{-m_1}{m_2}\\right)^2 - 40\\left(\\frac{-m_1}{m_2}\\right) + 55 = \\frac{4m_1^2 + 40m_1m_2 + 55m_2^2}{m_2^2}\n$$\n分子 $N = 4m_1^2 + 40m_1m_2 + 55m_2^2$ 是一个整数。此外，$N \\neq 0$，因为如果 $N=0$，那么 $-m_1/m_2$ 将是 $P(x)=0$ 的一个有理根，但 $P(x)$ 的根是无理数。因此，由于 $N$ 是一个非零整数，我们必有 $|N| \\ge 1$。这意味着：\n$$\n|P(-m_1/m_2)| \\ge \\frac{1}{m_2^2}\n$$\n根据中值定理，对于任何 $-m_1/m_2$，在 $r$ 和 $-m_1/m_2$ 之间存在一个 $\\xi$，使得：\n$$\nP(-m_1/m_2) - P(r) = P'(\\xi) \\left(-\\frac{m_1}{m_2} - r\\right)\n$$\n由于 $P(r)=0$，我们有 $|P(-m_1/m_2)| = |P'(\\xi)| \\left|r + \\frac{m_1}{m_2}\\right|$。结合这些结果：\n$$\n\\left|r + \\frac{m_1}{m_2}\\right| = \\frac{|P(-m_1/m_2)|}{|P'(\\xi)|} \\ge \\frac{1}{m_2^2 |P'(\\xi)|}\n$$\n乘以 $|m_2|$ 得到丢番图条件中表达式的一个下界：\n$$\n|m_1 + m_2 r| = |m_2|\\left|r + \\frac{m_1}{m_2}\\right| \\ge \\frac{1}{|m_2| |P'(\\xi)|}\n$$\n导数是 $P'(x) = 8x-40$。相关的逼近 $-m_1/m_2$ 是那些接近 $r$ 的值。如果我们考虑 $r$ 周围的一个有界区间，比如 $[r-1, r+1]$，那么对于此区间内的 $\\xi$，导数 $P'(\\xi)$ 是有界的，即 $|P'(\\xi)| \\le M$ 对于某个常数 $M>0$ 成立。对于此区间外的逼近，有 $|r+m_1/m_2| > 1$，这给出 $|m_1+m_2r| > |m_2|$，这是一个很差的逼近，丢番图条件很容易满足。因此，我们专注于好的逼近，有 $|m_1 + m_2 r| \\ge \\frac{1}{M|m_2|}$。\n\n让我们在丢番图条件中设置 $\\tau=1$。我们需要证明 $|m_1 + m_2 r| \\ge \\gamma (|m_1|+|m_2|)^{-1}$。这等价于证明乘积 $(|m_1| + |m_2|)|m_1 + m_2 r|$ 有一个正常数 $\\gamma$ 作为下界。\n从我们的推导中，我们得到 $(|m_1| + |m_2|)|m_1 + m_2 r| \\ge \\frac{|m_1|+|m_2|}{M|m_2|} = \\frac{1}{M}\\left(\\left|\\frac{m_1}{m_2}\\right|+1\\right)$。\n对于好的有理逼近，$-m_1/m_2$ 接近 $r$，因此 $|-m_1/m_2|$ 接近 $|r|$。因此，项 $|\\frac{m_1}{m_2}|+1$ 的下界为一个接近 $|r|+1$ 的值。因此，我们可以找到一个常数 $\\gamma > 0$ 使得该不等式成立。这证实了向量 $(1,r)$ 是指数为 $\\tau=1$ 的丢番图向量。由于条件 $\\tau \\ge 1$ 得到满足，该环面是丢番图的。\n\n总之，频率比为 $r = \\frac{10-3\\sqrt{5}}{2}$。这是一个无理数，所以环面是非共振的。它是一个二次无理数，这意味着它可被坏逼近，并满足丢番图条件。",
            "answer": "$$\\boxed{\\frac{10 - 3\\sqrt{5}}{2}}$$"
        },
        {
            "introduction": "尽管KAM理论证明了不变环面的存在性，但在实际问题中寻找它们通常需要依赖数值方法。本练习将指导您实现一个简化的KAM算法，用于数值构造一个扭转映射的不变环。通过这个实践，您将直观地理解“小分母问题”在计算中的体现，以及丢番图条件如何决定算法的收敛性，从而为理论概念提供一个强大的计算视角。",
            "id": "3750404",
            "problem": "为柱面上的一个辛扭转映射实现单步数值柯尔莫哥洛夫–阿诺德–莫泽 (KAM) 迭代，并评估旋转数满足丢番图条件时的收敛性。考虑柱面上由变换 $F_{\\varepsilon} : (\\theta, r) \\mapsto (\\theta', r')$ 定义的保面积扭转映射\n$$\n\\theta' = \\theta + r + \\varepsilon \\sin \\theta,\\quad r' = r + \\varepsilon \\sin \\theta,\n$$\n其中坐标 $\\theta$ 是圆上的一个角度，单位为弧度，$r$ 是扭转（类作用量）坐标，$\\varepsilon$ 是一个控制微扰振幅的微小实参数。对于可积情形 $\\varepsilon = 0$，该映射允许由嵌入 $K_0(\\varphi) = (\\theta(\\varphi), r(\\varphi)) = (\\varphi, \\omega)$ 参数化的不变圆，其中 $\\omega$ 是任意常数旋转数（以弧度为单位）。对于小的 $\\varepsilon \\neq 0$，寻找形式为 $K(\\varphi) = (\\varphi + u(\\varphi), \\omega + v(\\varphi))$ 的不变圆参数化，其中 $u$ 和 $v$ 是定义在角度 $\\varphi \\in [0,2\\pi)$ 上、周期为 $2\\pi$ 的实值函数。\n\n表示 $F_{\\varepsilon}(K(\\varphi)) = K(\\varphi + \\omega)$ 的不变性方程分解为两个标量函数方程\n$$\nu(\\varphi + \\omega) - u(\\varphi) - v(\\varphi) - \\varepsilon \\sin\\!\\big(\\varphi + u(\\varphi)\\big) = 0,\n$$\n$$\nv(\\varphi + \\omega) - v(\\varphi) - \\varepsilon \\sin\\!\\big(\\varphi + u(\\varphi)\\big) = 0.\n$$\n定义作用于 $2\\pi$ 周期函数 $\\phi(\\varphi)$ 的上同调算子 $L_{\\omega}$ 为 $L_{\\omega}\\phi(\\varphi) = \\phi(\\varphi + \\omega) - \\phi(\\varphi)$。一个数值KAM步骤包括在当前近似解 $(u,v)$ 处对不变性误差进行线性化，并使用圆环 $\\mathbb{T}$ 上的截断傅里叶表示，求解两个形如 $L_{\\omega}\\phi = g$ 的线性上同调方程以获得修正量。\n\n您的任务是实现以下过程：\n- 在区间 $[0,2\\pi)$ 的 $M$ 个点的均匀网格上表示 $u(\\varphi)$ 和 $v(\\varphi)$，并使用快速傅里叶变换 (FFT) 在傅里叶空间中求解 $L_{\\omega}\\phi = g$，将谐波截断至指数大小最多为 $K$。\n- 在每次迭代中，计算不变性误差\n$$\nE_1(\\varphi) = u(\\varphi + \\omega) - u(\\varphi) - v(\\varphi) - \\varepsilon \\sin\\!\\big(\\varphi + u(\\varphi)\\big),\n$$\n$$\nE_2(\\varphi) = v(\\varphi + \\omega) - v(\\varphi) - \\varepsilon \\sin\\!\\big(\\varphi + u(\\varphi)\\big),\n$$\n并应用一个拟牛顿 KAM 步骤：\n1. 求解 $L_{\\omega}\\delta v = -E_2$ 以获得 $\\delta v$，使用截断傅里叶级数。\n2. 求解 $L_{\\omega}\\delta u = -E_1 + \\delta v$ 以获得 $\\delta u$，使用截断傅里叶级数。\n3. 更新 $u \\leftarrow u + \\alpha \\,\\delta u$ 和 $v \\leftarrow v + \\alpha \\,\\delta v$，其中 $0  \\alpha \\leq 1$ 是一个松弛因子。\n- 全程使用弧度制表示角度。\n- 在每次迭代中，使用网格上的上确界范数来度量 $|E_1|$ 和 $|E_2|$ 的最大值。\n- 如果最终的上确界范数小于指定的容差，并且上确界范数序列在一个小的数值浮动范围内非增，则声明收敛。\n\n评估旋转数 $\\omega$ 为丢番图数与近共振数时的收敛行为。如果存在常数 $\\gamma  0$ 和 $\\tau \\geq 1$，使得对于所有整数 $k \\neq 0$ 和 $m$ 满足\n$$\n|k\\,\\omega - 2\\pi m| \\geq \\frac{\\gamma}{|k|^{\\tau}},\n$$\n则称旋转数 $\\omega$（以弧度为单位）满足丢番图条件。对于某些小的 $|k|$，近共振的 $\\omega$ 违反了这样的下界。\n\n实现一个完整的、可运行的程序，该程序执行 KAM 迭代并为以下测试套件输出收敛结果。在每种情况下，角度都以弧度为单位，最终答案必须是一个布尔值列表，指示 KAM 步骤是否收敛。\n\n测试套件 (每个元组为 $(\\omega, \\varepsilon, K, M, \\text{max\\_iter}, \\text{tol}, \\alpha)$)：\n- 情况 1 (丢番图数，小微扰): $\\omega = 2\\pi\\left(\\frac{\\sqrt{5}-1}{2}\\right)$, $\\varepsilon = 0.05$, $K = 16$, $M = 2048$, $\\text{max\\_iter} = 25$, $\\text{tol} = 10^{-8}$, $\\alpha = 0.5$.\n- 情况 2 (近共振，在 $k=2$ 处有小分母): $\\omega = \\pi + 10^{-10}$, $\\varepsilon = 0.05$, $K = 32$, $M = 2048$, $\\text{max\\_iter} = 25$, $\\text{tol} = 10^{-6}$, $\\alpha = 0.5$.\n- 情况 3 (丢番图数，大微扰): $\\omega = 2\\pi\\left(\\frac{\\sqrt{5}-1}{2}\\right)$, $\\varepsilon = 0.9$, $K = 32$, $M = 2048$, $\\text{max\\_iter} = 25$, $\\text{tol} = 10^{-6}$, $\\alpha = 0.5$.\n- 情况 4 (可积边界): $\\omega = 2\\pi\\left(\\frac{\\sqrt{5}-1}{2}\\right)$, $\\varepsilon = 0.0$, $K = 16$, $M = 512$, $\\text{max\\_iter} = 5$, $\\text{tol} = 10^{-12}$, $\\alpha = 0.5$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$，其中每个 $\\text{resulti}$ 是一个布尔值，表示相应情况是否收敛。",
            "solution": "用户希望为柱面上的一个辛扭转映射实现单步数值柯尔莫哥洛夫–阿诺德–莫泽 (KAM) 迭代。\n\n这是我解决此问题的计划：\n1.  **验证问题陈述**：我将首先严格检查问题的科学合理性、一致性和完整性。\n2.  **构思解决方案**：如果问题有效，我将详细阐述其数学和数值方法。这包括：\n    *   问题的设定：映射、不变圆和不变性方程。\n    *   求解函数方程的拟牛顿迭代方案。\n    *   求解核心线性部分——上同调方程的数值方法，采用截断傅里叶级数方法。我将解释如何使用快速傅里叶变换 (FFT) 以及如何处理由丢番图条件产生的小分母。\n3.  **实现算法**：我将编写一个 Python 程序来实现该迭代方案。该程序将被构造成能够处理指定的测试用例，并以要求的格式生成输出。\n\n### 步骤 1：问题验证\n\n我将首先验证所提供的问题陈述。\n\n*   **提取给定信息**：\n    *   **映射** $F_{\\varepsilon} : (\\theta, r) \\mapsto (\\theta', r')$：\n        $$\n        \\theta' = \\theta + r + \\varepsilon \\sin \\theta, \\quad r' = r + \\varepsilon \\sin \\theta\n        $$\n    *   **不变圆参数化**：$K(\\varphi) = (\\varphi + u(\\varphi), \\omega + v(\\varphi))$，对于固定的旋转数 $\\omega$。\n    *   **不变性条件**：$F_{\\varepsilon}(K(\\varphi)) = K(\\varphi + \\omega)$。\n    *   **函数方程**：\n        $$\n        u(\\varphi + \\omega) - u(\\varphi) - v(\\varphi) - \\varepsilon \\sin(\\varphi + u(\\varphi)) = 0\n        $$\n        $$\n        v(\\varphi + \\omega) - v(\\varphi) - \\varepsilon \\sin(\\varphi + u(\\varphi)) = 0\n        $$\n    *   **上同调算子**：$L_{\\omega}\\phi(\\varphi) = \\phi(\\varphi + \\omega) - \\phi(\\varphi)$。\n    *   **误差函数**：\n        $$\n        E_1(\\varphi) = u(\\varphi + \\omega) - u(\\varphi) - v(\\varphi) - \\varepsilon \\sin(\\varphi + u(\\varphi))\n        $$\n        $$\n        E_2(\\varphi) = v(\\varphi + \\omega) - v(\\varphi) - \\varepsilon \\sin(\\varphi + u(\\varphi))\n        $$\n    *   **拟牛顿迭代**：从当前近似解 $(u,v)$ 出发：\n        1.  求解 $L_{\\omega}\\delta v = -E_2$ 以获得修正量 $\\delta v$。\n        2.  求解 $L_{\\omega}\\delta u = -E_1 + \\delta v$ 以获得修正量 $\\delta u$。\n        3.  更新 $u \\leftarrow u + \\alpha \\delta u$ 和 $v \\leftarrow v + \\alpha \\delta v$。\n    *   **数值离散化**：函数在 $M$ 个点的网格上表示；上同调方程的解通过FFT找到，并截断至谐波指数 $|k| \\leq K$。\n    *   **收敛准则**：如果误差的上确界范数 $\\max(\\|E_1\\|_{\\infty}, \\|E_2\\|_{\\infty})$ 低于容差 `tol`，则迭代停止。误差序列必须非增（在数值松弛范围内）。\n    *   **测试用例**：\n        1.  $(\\omega, \\varepsilon, K, M, \\text{max\\_iter}, \\text{tol}, \\alpha) = (2\\pi(\\frac{\\sqrt{5}-1}{2}), 0.05, 16, 2048, 25, 10^{-8}, 0.5)$\n        2.  $(\\omega, \\varepsilon, K, M, \\text{max\\_iter}, \\text{tol}, \\alpha) = (\\pi + 10^{-10}, 0.05, 32, 2048, 25, 10^{-6}, 0.5)$\n        3.  $(\\omega, \\varepsilon, K, M, \\text{max\\_iter}, \\text{tol}, \\alpha) = (2\\pi(\\frac{\\sqrt{5}-1}{2}), 0.9, 32, 2048, 25, 10^{-6}, 0.5)$\n        4.  $(\\omega, \\varepsilon, K, M, \\text{max\\_iter}, \\text{tol}, \\alpha) = (2\\pi(\\frac{\\sqrt{5}-1}{2}), 0.0, 16, 512, 5, 10^{-12}, 0.5)$\n\n*   **验证结论**：\n    *   **科学依据**：该问题在哈密顿动力学和KAM理论领域有坚实的理论基础。该映射是 Chirikov 标准映射的一种形式，是混沌动力学的范例。寻找不变环面、推导函数方程以及使用拟牛顿法求解它们都是标准技术。丢番图条件是 KAM 理论的核心。该问题在科学上是合理的。\n    *   **适定性**：该问题是适定的。对于足够小的微扰 $\\varepsilon  0$ 和一个丢番图旋转数 $\\omega$，KAM 理论保证了唯一解的存在。该数值方案旨在寻找此解。问题隐含地假设了初始猜测为 $(u,v) = (0,0)$，这是对应于未扰动环面的标准起点。\n    *   **客观性**：问题以精确、客观的数学语言陈述。\n    *   问题没有科学缺陷，是可形式化的，并且是完整的（在标准零初始猜测的假设下）。参数在计算上是可行的。该问题是将数值方法应用于动力系统核心问题的非平凡应用。\n\n*   **操作**：问题是**有效的**。我将继续进行求解。\n\n### 步骤 2：方案构思与实现\n\n目标是为给定的扭转映射 $F_{\\varepsilon}$ 找到一个不变圆。一个具有旋转数 $\\omega$ 的不变圆是一条曲线 $K$，使得如果一个点在 $K$ 上，应用映射 $F_{\\varepsilon}$ 等效于沿该曲线前进一个角度 $\\omega$。我们寻求该曲线的一个参数化形式 $K(\\varphi) = (\\theta(\\varphi), r(\\varphi)) = (\\varphi + u(\\varphi), \\omega + v(\\varphi))$，其中 $u$ 和 $v$ 是 $2\\pi$ 周期函数。迭代过程的初始猜测是未受扰动的圆，对应于 $u(\\varphi)=0$ 和 $v(\\varphi)=0$。\n\n不变性条件 $F_{\\varepsilon}(K(\\varphi)) = K(\\varphi + \\omega)$ 导出了关于 $u$ 和 $v$ 的函数方程组：\n$$\nu(\\varphi + \\omega) - u(\\varphi) - v(\\varphi) = \\varepsilon \\sin(\\varphi + u(\\varphi))\n$$\n$$\nv(\\varphi + \\omega) - v(\\varphi) = \\varepsilon \\sin(\\varphi + u(\\varphi))\n$$\n我们定义上同调算子 $L_{\\omega}$ 作用于周期函数 $\\phi$ 为 $L_{\\omega}\\phi(\\varphi) = \\phi(\\varphi + \\omega) - \\phi(\\varphi)$。该系统可以写成：\n$$\nL_{\\omega}u - v = \\varepsilon \\sin(\\varphi + u)\n$$\n$$\nL_{\\omega}v = \\varepsilon \\sin(\\varphi + u)\n$$\n问题指定了一个拟牛顿迭代方案来求解这个非线性系统。给定当前近似 $(u_n, v_n)$，我们计算误差：\n$$\nE_{1,n} = L_{\\omega}u_n - v_n - \\varepsilon \\sin(\\varphi + u_n)\n$$\n$$\nE_{2,n} = L_{\\omega}v_n - \\varepsilon \\sin(\\varphi + u_n)\n$$\n修正量 $(\\delta u_n, \\delta v_n)$ 通过求解系统的简化（拟牛顿）线性化来找到，这将修正量的方程解耦：\n1.  $L_{\\omega}\\delta v_n = -E_{2,n}$\n2.  $L_{\\omega}\\delta u_n = -E_{1,n} + \\delta v_n$\n然后新的近似是 $u_{n+1} = u_n + \\alpha \\delta u_n$ 和 $v_{n+1} = v_n + \\alpha \\delta v_n$，其中 $\\alpha \\in (0, 1]$ 是一个松弛因子，用于改善算法的阻尼。\n\n数值方法的核心是求解上同调方程 $L_{\\omega}\\phi = g$。我们使用傅里叶级数方法。圆上的函数 $f(\\varphi)$ 由其傅里叶系数 $\\hat{f}_k$ 表示。算子 $L_{\\omega}$ 在傅里叶基下是对角化的：\n$$\n\\widehat{(L_{\\omega}\\phi)}_k = \\widehat{\\phi(\\varphi+\\omega)}_k - \\widehat{\\phi(\\varphi)}_k = (e^{ik\\omega} - 1)\\hat{\\phi}_k\n$$\n因此，为了求解 $L_{\\omega}\\phi = g$，我们可以求解 $\\phi$ 的傅里叶系数：\n$$\n\\hat{\\phi}_k = \\frac{\\hat{g}_k}{e^{ik\\omega} - 1} \\quad \\text{对于 } k \\neq 0\n$$\n对于 $k=0$，分母为零。这意味着要存在周期解 $\\phi$，右侧的 $g$ 必须具有零均值，即 $\\hat{g}_0 = 0$。在我们的数值方案中，我们通过将 $g$ 投影到零均值函数空间来强制满足此条件，即在求解前设置 $\\hat{g}_0=0$。解的均值 $\\hat{\\phi}_0$ 是不确定的；我们选择其为零。\n\n分母的模 $|e^{ik\\omega} - 1|$ 对解的稳定性至关重要。这就是 KAM 理论中的“小分母问题”。如果 $\\omega$ 是一个丢番图数，例如 $2\\pi$ 乘以黄金分割比，则存在一个下界 $|e^{ik\\omega} - 1| \\ge C/|k|^{\\tau+1}$，其中 $C, \\tau$ 是常数。这防止分母变得病态地小，并确保了级数在小 $\\varepsilon$ 时的收敛性。如果 $\\omega$ 接近共振，即对于某些小整数 $k, m$ 有 $k\\omega \\approx 2\\pi m$，相应的分母会非常小，导致大的修正量，并可能导致迭代方案发散。该算法截断傅里叶级数，仅考虑模 $|k| \\le K$，这通过忽略先验的高频效应和对大 $k$ 的分母来使问题正则化。\n\n数值实现过程如下：\n1.  在 $[0, 2\\pi)$ 上的 $M$ 个点的均匀网格上，将 $u$ 和 $v$ 初始化为零向量。\n2.  开始迭代循环。\n3.  在循环内部，通过在傅里叶空间中进行相移来计算 $u(\\varphi+\\omega)$ 和 $v(\\varphi+\\omega)$。这是通过对函数进行FFT，将第 $k$ 个系数乘以 $e^{ik\\omega}$，然后进行逆FFT来完成的。\n4.  在网格上计算误差函数 $E_1$ 和 $E_2$。\n5.  计算误差的上确界范数，并检查收敛或发散。\n6.  使用一个辅助函数求解修正量 $\\delta v$ 和 $\\delta u$，该函数实现了基于FFT的 $L_{\\omega}\\phi = g$ 求解方法，包括在 $|k| \\le K$ 处截断和处理 $k=0$ 模式。\n7.  使用修正量和松弛因子 $\\alpha$ 更新 $u$ 和 $v$。\n8.  在达到最大迭代次数后，对误差进行最终检查以确定结果。\n\n此过程应用于每个测试用例，以评估在不同丢番图性质和微扰强度条件下的收敛行为。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef kam_solver(omega, epsilon, K, M, max_iter, tol, alpha):\n    \"\"\"\n    Performs KAM iterations to find an invariant circle for a twist map.\n\n    Args:\n        omega (float): The rotation number of the torus.\n        epsilon (float): The perturbation strength.\n        K (int): The Fourier truncation mode number.\n        M (int): The number of grid points for discretization.\n        max_iter (int): The maximum number of iterations.\n        tol (float): The convergence tolerance for the sup-norm of the error.\n        alpha (float): The relaxation factor for the updates.\n\n    Returns:\n        bool: True if the method converged, False otherwise.\n    \"\"\"\n    # 1. Setup: Grid, wavenumbers, initial guess\n    phi_grid = np.linspace(0, 2 * np.pi, M, endpoint=False)\n    # Integer wavenumbers k for FFT, such that f(phi) = sum f_hat[k] exp(1j*k*phi)\n    k_vec = np.fft.fftfreq(M) * M\n\n    u = np.zeros(M)\n    v = np.zeros(M)\n\n    error_history = []\n\n    def shift(f, omega_shift, k_vector):\n        \"\"\"\n        Computes f(phi + omega_shift) using a phase shift in Fourier space.\n        \"\"\"\n        f_hat = np.fft.fft(f)\n        f_shifted_hat = f_hat * np.exp(1j * k_vector * omega_shift)\n        return np.real(np.fft.ifft(f_shifted_hat))\n\n    def solve_cohomological(g, omega_solve, k_vector, K_trunc):\n        \"\"\"\n        Solves the cohomological equation L_omega * phi = g for a zero-mean phi.\n        The equation is solved in Fourier space with truncation at |k| = K_trunc.\n        \"\"\"\n        g_hat = np.fft.fft(g)\n        phi_hat = np.zeros_like(g_hat)\n\n        # Create a mask for modes to include: |k| = K_trunc and k != 0\n        k_mask = (np.abs(k_vector) = K_trunc)  (k_vector != 0)\n        \n        # Denominator exp(i*k*omega) - 1\n        denom = np.exp(1j * k_vector[k_mask] * omega_solve) - 1.0\n        \n        # Solve for phi_hat_k = g_hat_k / denom for the selected modes.\n        # This implicitly sets phi_hat_0 = 0, enforcing a zero-mean solution.\n        phi_hat[k_mask] = g_hat[k_mask] / denom\n        \n        return np.real(np.fft.ifft(phi_hat))\n\n    # 2. Iteration Loop\n    for i in range(max_iter):\n        # Calculate error functions E1, E2\n        u_shifted = shift(u, omega, k_vec)\n        v_shifted = shift(v, omega, k_vec)\n\n        pert_term = epsilon * np.sin(phi_grid + u)\n\n        E1 = u_shifted - u - v - pert_term\n        E2 = v_shifted - v - pert_term\n\n        # Check for convergence/divergence\n        current_error = np.maximum(np.max(np.abs(E1)), np.max(np.abs(E2)))\n        error_history.append(current_error)\n\n        # Divergence check: error must be non-increasing\n        # A small slack is added to account for floating point noise\n        if i > 0 and current_error > error_history[-2] + 1e-12:\n            return False\n\n        # Convergence check\n        if current_error  tol:\n            return True\n\n        # 3. Quasi-Newton Step\n        g2 = -E2\n        delta_v = solve_cohomological(g2, omega, k_vec, K)\n        \n        g1 = -E1 + delta_v\n        delta_u = solve_cohomological(g1, omega, k_vec, K)\n\n        # 4. Update u and v\n        u += alpha * delta_u\n        v += alpha * delta_v\n        \n    # Check convergence after the last iteration\n    return error_history[-1]  tol\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print a single line of output.\n    \"\"\"\n    # Test suite: (omega, epsilon, K, M, max_iter, tol, alpha)\n    test_cases = [\n        # Case 1 (Diophantine, small perturbation): Converges\n        (2 * np.pi * (np.sqrt(5) - 1) / 2, 0.05, 16, 2048, 25, 1e-8, 0.5),\n        # Case 2 (near-resonant): Diverges due to small denominators\n        (np.pi + 1e-10, 0.05, 32, 2048, 25, 1e-6, 0.5),\n        # Case 3 (Diophantine, large perturbation): Diverges, outside convergence radius\n        (2 * np.pi * (np.sqrt(5) - 1) / 2, 0.9, 32, 2048, 25, 1e-6, 0.5),\n        # Case 4 (integrable boundary): Converges trivially on first step\n        (2 * np.pi * (np.sqrt(5) - 1) / 2, 0.0, 16, 512, 5, 1e-12, 0.5),\n    ]\n\n    results = []\n    for params in test_cases:\n        converged = kam_solver(*params)\n        results.append(converged)\n\n    # Format output as a list of booleans in lowercase\n    result_str = [str(r).lower() for r in results]\n    print(f\"[{','.join(result_str)}]\")\n\nsolve()\n```"
        }
    ]
}