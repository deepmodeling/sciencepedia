{
    "hands_on_practices": [
        {
            "introduction": "The study of invariant tori begins with understanding them in their purest form: within completely integrable systems. This exercise  provides a foundational walkthrough of this concept using the n-dimensional harmonic oscillator, the canonical model of integrable dynamics. By explicitly deriving the action-angle variables from first principles, you will see how the phase space is foliated by tori and how the dynamics simplifies to a linear flow, providing a concrete anchor for the more abstract concepts to follow.",
            "id": "3750346",
            "problem": "Consider the autonomous Hamiltonian system on $\\mathbb{R}^{2n}$ with the standard symplectic form $\\omega_{\\mathrm{std}} = \\sum_{i=1}^{n} \\mathrm{d}p_{i} \\wedge \\mathrm{d}q_{i}$ and Hamiltonian\n$$\nH(q,p) \\;=\\; \\sum_{i=1}^{n} \\left( \\frac{1}{2} \\, p_{i}^{2} \\;+\\; \\frac{1}{2} \\, \\omega_{i}^{2} \\, q_{i}^{2} \\right),\n$$\nwhere $q = (q_{1},\\dots,q_{n}) \\in \\mathbb{R}^{n}$, $p = (p_{1},\\dots,p_{n}) \\in \\mathbb{R}^{n}$, and each $\\omega_{i} \\in \\mathbb{R}_{>0}$ is a fixed positive constant. Starting from the fundamental definitions of symplectic geometry and Hamiltonian mechanics, do the following:\n\n- Derive the invariant Lagrangian tori associated with this integrable system as level sets of appropriately defined action variables. Explicitly identify the $n$ action variables $(I_{1},\\dots,I_{n})$ via the line integrals of the canonical one-form along the independent fundamental cycles of the invariant tori.\n- Construct a canonical transformation to action-angle coordinates $(I,\\theta) = \\big( (I_{1},\\dots,I_{n}),(\\theta_{1},\\dots,\\theta_{n}) \\big)$ and provide explicit formulas for $(q_{i},p_{i})$ in terms of $(I_{i},\\theta_{i})$ for each $i \\in \\{1,\\dots,n\\}$.\n- Using Hamilton’s equations in action-angle variables, determine the frequency vector $\\Omega(I) = \\left( \\dot{\\theta}_{1},\\dots,\\dot{\\theta}_{n} \\right)$ on each invariant torus and describe its dependence on the actions.\n\nYour reasoning must start from first principles: the definition of the symplectic form, the canonical one-form, Hamilton’s equations, and the definition of action-angle variables via action integrals and canonical transformations. Do not invoke pre-packaged formulas without justification.\n\nAnswer specification:\n- Provide your final boxed answer as a single closed-form analytic expression for the Hamiltonian expressed purely in terms of the action variables, namely $H(I_{1},\\dots,I_{n})$. No units are required.",
            "solution": "The problem is to analyze the Hamiltonian system of $n$ uncoupled harmonic oscillators, find its invariant tori, construct the action-angle coordinates, and determine the resulting dynamics. We will proceed from the fundamental definitions provided.\n\nThe phase space is $\\mathbb{R}^{2n}$ with coordinates $(q,p) = (q_1, \\dots, q_n, p_1, \\dots, p_n)$.\nThe given symplectic form is the standard one, $\\omega_{\\mathrm{std}} = \\sum_{i=1}^{n} \\mathrm{d}p_{i} \\wedge \\mathrm{d}q_{i}$.\nThe Hamiltonian is $H(q,p) = \\sum_{i=1}^{n} H_i(q_i, p_i)$, where $H_i(q_i, p_i) = \\frac{1}{2} p_i^2 + \\frac{1}{2} \\omega_i^2 q_i^2$.\n\nFirst, let us derive Hamilton's equations for this system. A Hamiltonian vector field $X_H$ is defined by the relation $i_{X_H} \\omega_{\\mathrm{std}} = -\\mathrm{d}H$. Let $X_H = \\sum_{j=1}^n (\\dot{q}_j \\frac{\\partial}{\\partial q_j} + \\dot{p}_j \\frac{\\partial}{\\partial p_j})$. The interior product is:\n$$\ni_{X_H} \\omega_{\\mathrm{std}} = \\sum_{i=1}^n \\left( (\\mathrm{d}p_i \\wedge \\mathrm{d}q_i)(X_H, \\cdot) \\right) = \\sum_{i=1}^n (\\dot{p}_i \\mathrm{d}q_i - \\dot{q}_i \\mathrm{d}p_i)\n$$\nThe right-hand side is $-\\mathrm{d}H = -\\sum_{i=1}^n (\\frac{\\partial H}{\\partial q_i} \\mathrm{d}q_i + \\frac{\\partial H}{\\partial p_i} \\mathrm{d}p_i)$.\nEquating the coefficients of the basis one-forms $\\mathrm{d}q_i$ and $\\mathrm{d}p_i$, we obtain the standard Hamilton's equations:\n$$\n\\dot{q}_i = \\frac{\\partial H}{\\partial p_i} \\quad \\text{and} \\quad \\dot{p}_i = -\\frac{\\partial H}{\\partial q_i}\n$$\nFor our specific Hamiltonian, these equations become:\n$$\n\\dot{q}_i = p_i \\quad \\text{and} \\quad \\dot{p}_i = -\\omega_i^2 q_i\n$$\nDifferentiating the first equation with respect to time gives $\\ddot{q}_i = \\dot{p}_i = -\\omega_i^2 q_i$, which is the standard equation for a harmonic oscillator, $\\ddot{q}_i + \\omega_i^2 q_i = 0$.\n\nThe Hamiltonian is a sum of $n$ functions, $H = \\sum_{i=1}^n H_i(q_i, p_i)$, where each $H_i$ only depends on the pair of coordinates $(q_i, p_i)$. This system is separable. The dynamics of each $(q_i, p_i)$ pair are independent of the others. The individual Hamiltonians $H_i$ are themselves constants of motion, since $\\{H_i, H\\} = \\{H_i, \\sum_j H_j\\} = \\sum_j \\{H_i, H_j\\} = 0$ as $\\{H_i, H_j\\}=0$ for $i \\neq j$ (disjoint variables) and $\\{H_i, H_i\\}=0$. These $n$ functions $H_1, \\dots, H_n$ are the independent integrals of motion in involution required for Liouville-Arnold integrability.\n\nFor each subsystem $i$, the motion is constrained to a level set $H_i(q_i, p_i) = E_i$, where $E_i > 0$ is a constant energy. The equation $\\frac{1}{2} p_i^2 + \\frac{1}{2} \\omega_i^2 q_i^2 = E_i$ describes an ellipse in the $(q_i, p_i)$ phase plane. The motion for the full system is constrained to the product of these $n$ ellipses. Topologically, each ellipse is a circle ($S^1$). Thus, the level set of the collective integrals of motion $(H_1, \\dots, H_n)$ is an $n$-dimensional torus $T^n = S^1 \\times \\dots \\times S^1$. These are the invariant Lagrangian tori of the system.\n\nThe action variables $(I_1, \\dots, I_n)$ are defined by integrating the canonical one-form $\\alpha = \\sum_i p_i \\mathrm{d}q_i$ over a basis of fundamental cycles on the invariant torus. Since the torus is a product, we can choose the cycles $\\gamma_i$ to be the individual ellipses in each $(q_i, p_i)$ plane. The action $I_i$ is defined as:\n$$\nI_i = \\frac{1}{2\\pi} \\oint_{\\gamma_i} p_i \\, \\mathrm{d}q_i\n$$\nwhere $\\gamma_i$ is the curve defined by $H_i(q_i, p_i) = E_i$. The integral $\\oint p_i \\, \\mathrm{d}q_i$ represents the area enclosed by the ellipse. The equation of the ellipse is $\\frac{q_i^2}{a^2} + \\frac{p_i^2}{b^2} = 1$, where the semi-axes are $a = \\sqrt{2E_i / \\omega_i^2}$ and $b = \\sqrt{2E_i}$. The area of the ellipse is $\\pi a b$.\n$$\n\\text{Area} = \\pi \\left(\\frac{\\sqrt{2E_i}}{\\omega_i}\\right) (\\sqrt{2E_i}) = \\frac{2\\pi E_i}{\\omega_i}\n$$\nTherefore, the action variable $I_i$ is:\n$$\nI_i = \\frac{1}{2\\pi} \\left( \\frac{2\\pi E_i}{\\omega_i} \\right) = \\frac{E_i}{\\omega_i}\n$$\nThis gives us a relationship between the energy of each oscillator and its corresponding action: $E_i = I_i \\omega_i$.\n\nNow we construct the canonical transformation to action-angle coordinates $(I_i, \\theta_i)$. The goal is to find new coordinates such that the Hamiltonian only depends on the actions $I_i$. Based on the elliptic motion, we propose the following transformation for each $i \\in \\{1, \\dots, n\\}$:\n$$\nq_i(I_i, \\theta_i) = \\sqrt{\\frac{2I_i}{\\omega_i}} \\sin \\theta_i\n$$\n$$\np_i(I_i, \\theta_i) = \\sqrt{2I_i \\omega_i} \\cos \\theta_i\n$$\nTo verify that this is a canonical transformation, we check if it preserves the structure of the symplectic form. We compute the differentials:\n$$\n\\mathrm{d}q_i = \\frac{\\partial q_i}{\\partial I_i} \\mathrm{d}I_i + \\frac{\\partial q_i}{\\partial \\theta_i} \\mathrm{d}\\theta_i = \\frac{1}{\\sqrt{2I_i \\omega_i}} \\sin \\theta_i \\, \\mathrm{d}I_i + \\sqrt{\\frac{2I_i}{\\omega_i}} \\cos \\theta_i \\, \\mathrm{d}\\theta_i\n$$\n$$\n\\mathrm{d}p_i = \\frac{\\partial p_i}{\\partial I_i} \\mathrm{d}I_i + \\frac{\\partial p_i}{\\partial \\theta_i} \\mathrm{d}\\theta_i = \\sqrt{\\frac{\\omega_i}{2I_i}} \\cos \\theta_i \\, \\mathrm{d}I_i - \\sqrt{2I_i \\omega_i} \\sin \\theta_i \\, \\mathrm{d}\\theta_i\n$$\nNow we compute the wedge product $\\mathrm{d}p_i \\wedge \\mathrm{d}q_i$:\n\\begin{align*}\n\\mathrm{d}p_i \\wedge \\mathrm{d}q_i &= \\left( \\frac{\\partial p_i}{\\partial I_i} \\frac{\\partial q_i}{\\partial \\theta_i} - \\frac{\\partial p_i}{\\partial \\theta_i} \\frac{\\partial q_i}{\\partial I_i} \\right) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n&= \\left( (\\sqrt{\\frac{\\omega_i}{2I_i}} \\cos \\theta_i)(\\sqrt{\\frac{2I_i}{\\omega_i}} \\cos \\theta_i) - (-\\sqrt{2I_i \\omega_i} \\sin \\theta_i)(\\frac{1}{\\sqrt{2I_i \\omega_i}} \\sin \\theta_i) \\right) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n&= (\\cos^2 \\theta_i + \\sin^2 \\theta_i) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n&= 1 \\cdot \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i = \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i\n\\end{align*}\nSumming over all $i$, the symplectic form becomes $\\omega' = \\sum_{i=1}^n \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i$. This confirms the transformation is canonical (a symplectomorphism) and preserves the form. Hamilton's equations for the new coordinates $(I, \\theta)$ and the transformed Hamiltonian $K(I, \\theta)$ are:\n$$\n\\dot{\\theta}_i = \\frac{\\partial K}{\\partial I_i} \\quad \\text{and} \\quad \\dot{I}_i = -\\frac{\\partial K}{\\partial \\theta_i}\n$$\nThe Hamiltonian expressed in action-angle coordinates, denoted $K(I, \\theta)$, is found by substituting the transformation into $H(q,p)$:\n$$\nK(I, \\theta) = \\sum_{i=1}^n \\left( \\frac{1}{2} (\\sqrt{2I_i \\omega_i} \\cos \\theta_i)^2 + \\frac{1}{2} \\omega_i^2 (\\sqrt{\\frac{2I_i}{\\omega_i}} \\sin \\theta_i)^2 \\right)\n$$\n$$\nK(I, \\theta) = \\sum_{i=1}^n \\left( \\frac{1}{2} (2I_i \\omega_i \\cos^2 \\theta_i) + \\frac{1}{2} \\omega_i^2 (\\frac{2I_i}{\\omega_i} \\sin^2 \\theta_i) \\right)\n$$\n$$\nK(I, \\theta) = \\sum_{i=1}^n ( I_i \\omega_i \\cos^2 \\theta_i + I_i \\omega_i \\sin^2 \\theta_i ) = \\sum_{i=1}^n I_i \\omega_i\n$$\nAs required, the transformed Hamiltonian $K$ depends only on the action variables $I_i$. We denote this as $H(I_1, \\dots, I_n)$.\n\nFinally, we determine the frequency vector $\\Omega(I) = (\\dot{\\theta}_1, \\dots, \\dot{\\theta}_n)$ using Hamilton's equations in the new coordinates:\n$$\n\\dot{I}_i = -\\frac{\\partial K}{\\partial \\theta_i} = -\\frac{\\partial}{\\partial \\theta_i} \\left( \\sum_{j=1}^n I_j \\omega_j \\right) = 0\n$$\nThis confirms that the actions $I_i$ are indeed constants of motion.\n$$\n\\dot{\\theta}_i = \\frac{\\partial K}{\\partial I_i} = \\frac{\\partial}{\\partial I_i} \\left( \\sum_{j=1}^n I_j \\omega_j \\right) = \\omega_i\n$$\nThe frequency of each angle variable is a constant, $\\dot{\\theta}_i = \\omega_i$. The motion on the invariant torus is a linear flow. The frequency vector is $\\Omega(I) = (\\omega_1, \\dots, \\omega_n)$. This result shows that for the harmonic oscillator, the frequencies of motion on the invariant tori are independent of the actions $I_i$ (i.e., independent of the amplitudes or energies of the oscillations).\nThe final expression for the Hamiltonian in terms of the action variables is the transformed Hamiltonian $K(I)$.\n$$ H(I_1, \\dots, I_n) = \\sum_{i=1}^n I_i \\omega_i $$",
            "answer": "$$\\boxed{\\sum_{i=1}^{n} I_{i} \\omega_{i}}$$"
        },
        {
            "introduction": "While integrable systems provide a clean picture, most real-world systems are 'near-integrable,' containing small perturbations. The celebrated Kolmogorov-Arnold-Moser (KAM) theory addresses whether invariant tori survive such changes, with the answer hinging on the arithmetic properties of the system's frequencies. This practice  challenges you to analyze the crucial distinction between resonant and non-resonant (specifically, Diophantine) tori, which determines their fate under perturbation.",
            "id": "3750316",
            "problem": "Consider a two-degree-of-freedom integrable Hamiltonian system composed of two decoupled linear oscillators with canonical coordinates $(q_{1},p_{1},q_{2},p_{2})$ and Hamiltonian\n$$\nH(q_{1},p_{1},q_{2},p_{2}) \\;=\\; \\frac{1}{2}\\left(p_{1}^{2} + \\omega_{1}^{2} q_{1}^{2}\\right) \\;+\\; \\frac{1}{2}\\left(p_{2}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right),\n$$\nwhere $\\omega_{1}$ and $\\omega_{2}$ are positive parameters. In action-angle variables $(I_{1},\\theta_{1},I_{2},\\theta_{2})$ for each harmonic oscillator, the invariant torus given by fixed actions $(I_{1},I_{2})$ supports quasi-periodic flow with constant frequencies given by the frequency vector\n$$\n\\boldsymbol{\\omega} \\;=\\; \\left(\\omega_{1},\\,\\omega_{2}\\right).\n$$\nA torus is called resonant if there exist integers $m_{1},m_{2}$, not both zero, such that $m_{1}\\omega_{1} + m_{2}\\omega_{2} = 0$. Otherwise it is nonresonant. In the context of Kolmogorov-Arnold-Moser (KAM) theory, a nonresonant torus is called Diophantine with exponent $\\tau \\geq 1$ and constant $\\gamma > 0$ if\n$$\n|m_{1}\\omega_{1} + m_{2}\\omega_{2}| \\;\\geq\\; \\gamma \\,\\left(|m_{1}|+|m_{2}|\\right)^{-\\tau}\n\\quad\\text{for all}\\quad (m_{1},m_{2}) \\in \\mathbb{Z}^{2}\\setminus\\{(0,0)\\}.\n$$\n\nAssume the system is near the $(3:2)$ resonance through a small detuning parameter $\\delta$ in the second oscillator, specifically\n$$\n\\omega_{1} \\;=\\; 1,\n\\qquad\n\\omega_{2} \\;=\\; \\frac{3}{2} \\;+\\; \\delta,\n\\qquad\n\\delta \\;=\\; \\phi^{-4},\n\\qquad\n\\phi \\;=\\; \\frac{1+\\sqrt{5}}{2}.\n$$\nCompute the exact frequency ratio $r = \\omega_{2}/\\omega_{1}$ for this invariant torus. Then, starting from the definitions of resonance and the Diophantine condition above, use first principles about harmonic oscillators in action-angle variables and well-known properties of quadratic irrational numbers to assess whether this torus is resonant or Diophantine for the specified parameter values.\n\nExpress the final answer as an exact closed-form analytic expression for $r$. No rounding is required. No units are required.",
            "solution": "The problem requires the analysis of an invariant torus in a two-degree-of-freedom Hamiltonian system. The tasks are to compute the frequency ratio $r = \\omega_{2}/\\omega_{1}$ for a specific choice of parameters and then to determine whether the corresponding torus is resonant or Diophantine based on the provided definitions.\n\nFirst, we establish the context from the problem statement. The system is described by the Hamiltonian\n$$\nH(q_{1},p_{1},q_{2},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + \\omega_{1}^{2} q_{1}^{2}\\right) + \\frac{1}{2}\\left(p_{2}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right)\n$$\nThis represents two uncoupled harmonic oscillators. In action-angle variables $(I_k, \\theta_k)$, the Hamiltonian for a single oscillator $k$ is $H_k = \\omega_k I_k$. The total Hamiltonian is $H(I_1, I_2) = H_1 + H_2 = \\omega_1 I_1 + \\omega_2 I_2$. Hamilton's equations for the angles are $\\dot{\\theta}_k = \\frac{\\partial H}{\\partial I_k} = \\omega_k$, confirming that the motion on an invariant torus (fixed $I_1, I_2$) occurs with the constant frequency vector $\\boldsymbol{\\omega} = (\\omega_1, \\omega_2)$.\n\nThe problem provides the specific parameter values:\n$$\n\\omega_{1} = 1\n$$\n$$\n\\omega_{2} = \\frac{3}{2} + \\delta, \\quad \\text{where} \\quad \\delta = \\phi^{-4}\n$$\nThe constant $\\phi$ is the golden ratio, $\\phi = \\frac{1+\\sqrt{5}}{2}$.\n\nOur first task is to compute the exact frequency ratio $r = \\omega_{2}/\\omega_{1}$. Given $\\omega_1=1$, this ratio is simply $r = \\omega_2$.\n$$\nr = \\frac{\\omega_{2}}{\\omega_{1}} = \\frac{\\frac{3}{2} + \\phi^{-4}}{1} = \\frac{3}{2} + \\phi^{-4}\n$$\nTo find the exact value of $r$, we must compute $\\phi^{-4}$. The golden ratio $\\phi$ satisfies the characteristic quadratic equation $x^2 - x - 1 = 0$, which implies $\\phi^2 = \\phi + 1$. From this, we can also derive $\\phi^{-1} = \\phi - 1$. We can compute $\\phi^{-4}$ recursively:\n$$\n\\phi^{-2} = (\\phi^{-1})^{2} = (\\phi - 1)^2 = \\phi^2 - 2\\phi + 1 = (\\phi+1) - 2\\phi + 1 = 2 - \\phi\n$$\n$$\n\\phi^{-4} = (\\phi^{-2})^{2} = (2 - \\phi)^2 = 4 - 4\\phi + \\phi^2 = 4 - 4\\phi + (\\phi+1) = 5 - 3\\phi\n$$\nNow, we substitute the numerical value of $\\phi$:\n$$\n\\phi^{-4} = 5 - 3\\left(\\frac{1+\\sqrt{5}}{2}\\right) = 5 - \\frac{3}{2} - \\frac{3\\sqrt{5}}{2} = \\frac{10 - 3 - 3\\sqrt{5}}{2} = \\frac{7 - 3\\sqrt{5}}{2}\n$$\nWe can now calculate the frequency ratio $r$:\n$$\nr = \\frac{3}{2} + \\phi^{-4} = \\frac{3}{2} + \\frac{7 - 3\\sqrt{5}}{2} = \\frac{3 + 7 - 3\\sqrt{5}}{2} = \\frac{10 - 3\\sqrt{5}}{2}\n$$\n\nNext, we assess whether the torus is resonant or Diophantine.\n\nA torus is resonant if there exist integers $(m_1, m_2) \\in \\mathbb{Z}^2 \\setminus \\{(0,0)\\}$ such that $m_1 \\omega_1 + m_2 \\omega_2 = 0$. With $\\omega_1=1$ and $\\omega_2=r$, this condition becomes $m_1 + m_2 r = 0$. If $m_2 \\neq 0$, this implies $r = -m_1/m_2$, meaning $r$ must be a rational number. If $m_2=0$, then $m_1$ must also be $0$, which is excluded. Our calculated value for the ratio is $r = \\frac{10 - 3\\sqrt{5}}{2} = 5 - \\frac{3}{2}\\sqrt{5}$. Since $\\sqrt{5}$ is an irrational number, $r$ is an irrational number. Specifically, it is a linear combination of a rational number ($5$) and an irrational number ($\\sqrt{5}$) with a rational coefficient ($-3/2$), which results in an irrational number. Because $r$ is irrational, it cannot be expressed as a ratio of two integers. Therefore, the resonance condition $m_1 + m_2 r = 0$ is not satisfied for any non-zero integer pair $(m_1, m_2)$. The torus is nonresonant.\n\nNow, we check if the torus is Diophantine. A nonresonant torus is Diophantine if for some constants $\\tau \\ge 1$ and $\\gamma > 0$, the following inequality holds for all $(m_1, m_2) \\in \\mathbb{Z}^2 \\setminus \\{(0,0)\\}$:\n$$\n|m_{1}\\omega_{1} + m_{2}\\omega_{2}| \\ge \\gamma (|m_{1}|+|m_{2}|)^{-\\tau}\n$$\nSubstituting $\\omega_1 = 1$ and $\\omega_2 = r$, this is:\n$$\n|m_1 + m_2 r| \\ge \\gamma (|m_1|+|m_2|)^{-\\tau}\n$$\nThe number $r = \\frac{10 - 3\\sqrt{5}}{2}$ is a quadratic irrational number because it is a root of a quadratic equation with integer coefficients. Let us find this equation:\n$$\nx = \\frac{10 - 3\\sqrt{5}}{2} \\\\\n2x = 10 - 3\\sqrt{5} \\\\\n2x - 10 = -3\\sqrt{5} \\\\\n(2x - 10)^2 = (-3\\sqrt{5})^2 \\\\\n4x^2 - 40x + 100 = 45 \\\\\n4x^2 - 40x + 55 = 0\n$$\nLet $P(x) = 4x^2 - 40x + 55$. We have shown that $P(r) = 0$.\nA cornerstone result in the theory of Diophantine approximation is that quadratic irrational numbers are \"badly approximable\" by rationals. This property directly leads to them satisfying a Diophantine condition. We can demonstrate this from first principles.\n\nFor any integers $m_1, m_2$ with $m_2 \\neq 0$, let us evaluate the polynomial $P$ at the rational number $-m_1/m_2$:\n$$\nP(-m_1/m_2) = 4\\left(\\frac{-m_1}{m_2}\\right)^2 - 40\\left(\\frac{-m_1}{m_2}\\right) + 55 = \\frac{4m_1^2 + 40m_1m_2 + 55m_2^2}{m_2^2}\n$$\nThe numerator, $N = 4m_1^2 + 40m_1m_2 + 55m_2^2$, is an integer. Furthermore, $N \\neq 0$ because if it were, $-m_1/m_2$ would be a rational root of $P(x)=0$, but the roots of $P(x)$ are irrational. Thus, as $N$ is a non-zero integer, we must have $|N| \\ge 1$. This implies:\n$$\n|P(-m_1/m_2)| \\ge \\frac{1}{m_2^2}\n$$\nBy the Mean Value Theorem, for any $-m_1/m_2$, there exists a $\\xi$ between $r$ and $-m_1/m_2$ such that:\n$$\nP(-m_1/m_2) - P(r) = P'(\\xi) \\left(-\\frac{m_1}{m_2} - r\\right)\n$$\nSince $P(r)=0$, we have $|P(-m_1/m_2)| = |P'(\\xi)| \\left|r + \\frac{m_1}{m_2}\\right|$. Combining these results:\n$$\n\\left|r + \\frac{m_1}{m_2}\\right| = \\frac{|P(-m_1/m_2)|}{|P'(\\xi)|} \\ge \\frac{1}{m_2^2 |P'(\\xi)|}\n$$\nMultiplying by $|m_2|$ gives a lower bound for the expression in the Diophantine condition:\n$$\n|m_1 + m_2 r| = |m_2|\\left|r + \\frac{m_1}{m_2}\\right| \\ge \\frac{1}{|m_2| |P'(\\xi)|}\n$$\nThe derivative is $P'(x) = 8x-40$. The relevant approximations $-m_1/m_2$ are those close to $r$. If we consider a bounded interval around $r$, say $[r-1, r+1]$, the derivative $P'(\\xi)$ for $\\xi$ in this interval is bounded, i.e., $|P'(\\xi)| \\le M$ for some constant $M>0$. For approximations outside this interval, $|r+m_1/m_2| > 1$, which gives $|m_1+m_2r| > |m_2|$, a very poor approximation for which the Diophantine condition is easily satisfied. So focusing on good approximations, we have $|m_1 + m_2 r| \\ge \\frac{1}{M|m_2|}$.\n\nLet's set $\\tau=1$ in the Diophantine condition. We need to show that $|m_1 + m_2 r| \\ge \\gamma (|m_1|+|m_2|)^{-1}$. This is equivalent to showing that the product $(|m_1| + |m_2|)|m_1 + m_2 r|$ is bounded below by a positive constant $\\gamma$.\nFrom our derivation, we have $(|m_1| + |m_2|)|m_1 + m_2 r| \\ge \\frac{|m_1|+|m_2|}{M|m_2|} = \\frac{1}{M}\\left(\\left|\\frac{m_1}{m_2}\\right|+1\\right)$.\nFor good rational approximations, $-m_1/m_2$ is close to $r$, so $|-m_1/m_2|$ is close to $|r|$. The term $|\\frac{m_1}{m_2}|+1$ is therefore bounded below by a value close to $|r|+1$. Thus, we can find a constant $\\gamma > 0$ such that the inequality holds. This confirms that the vector $(1,r)$ is Diophantine with exponent $\\tau = 1$. Since the condition $\\tau \\ge 1$ is satisfied, the torus is Diophantine.\n\nIn summary, the frequency ratio is $r = \\frac{10-3\\sqrt{5}}{2}$. This is an irrational number, so the torus is nonresonant. It is a quadratic irrational, which implies it is badly approximable and satisfies the Diophantine condition.",
            "answer": "$$\\boxed{\\frac{10 - 3\\sqrt{5}}{2}}$$"
        },
        {
            "introduction": "The analytical proofs of KAM theory are famously complex, but its core ideas can be powerfully illustrated through computation. The search for a surviving invariant torus can be framed as an iterative numerical scheme, akin to Newton's method for functions, that converges rapidly for well-behaved frequencies but fails near resonances. This coding exercise  puts you in the driver's seat, asking you to implement a step of this KAM algorithm and observe firsthand how the Diophantine condition on a torus's frequency directly translates into the stability and convergence of the numerical solution.",
            "id": "3750404",
            "problem": "Implement a single numerical Kolmogorov–Arnold–Moser (KAM) step for a symplectic twist map on the cylinder and assess convergence for rotation numbers satisfying a Diophantine condition. Consider the area-preserving twist map on the cylinder defined by the transformation $F_{\\varepsilon} : (\\theta, r) \\mapsto (\\theta', r')$ with\n$$\n\\theta' = \\theta + r + \\varepsilon \\sin \\theta,\\quad r' = r + \\varepsilon \\sin \\theta,\n$$\nwhere the coordinate $\\theta$ is an angle on the circle with unit of radians, $r$ is the twist (action-like) coordinate, and $\\varepsilon$ is a small real parameter controlling the perturbation amplitude. For the integrable case $\\varepsilon = 0$, the map admits invariant circles parameterized by embeddings $K_0(\\varphi) = (\\theta(\\varphi), r(\\varphi)) = (\\varphi, \\omega)$ for any constant rotation number $\\omega$ (in radians). For small $\\varepsilon \\neq 0$, search for an invariant circle parameterization of the form $K(\\varphi) = (\\varphi + u(\\varphi), \\omega + v(\\varphi))$, where $u$ and $v$ are real-valued functions on the angle $\\varphi \\in [0,2\\pi)$ with period $2\\pi$.\n\nThe invariance equation expressing that $F_{\\varepsilon}(K(\\varphi)) = K(\\varphi + \\omega)$ decomposes into two scalar functional equations\n$$\nu(\\varphi + \\omega) - u(\\varphi) - v(\\varphi) - \\varepsilon \\sin\\!\\big(\\varphi + u(\\varphi)\\big) = 0,\n$$\n$$\nv(\\varphi + \\omega) - v(\\varphi) - \\varepsilon \\sin\\!\\big(\\varphi + u(\\varphi)\\big) = 0.\n$$\nDefine the cohomological operator $L_{\\omega}$ acting on a $2\\pi$-periodic function $\\phi(\\varphi)$ by $L_{\\omega}\\phi(\\varphi) = \\phi(\\varphi + \\omega) - \\phi(\\varphi)$. A numerical KAM step consists of linearizing the invariance error at a current approximation $(u,v)$ and solving two linear cohomological equations of the form $L_{\\omega}\\phi = g$ for corrections, using a truncated Fourier representation on the circle $\\mathbb{T}$.\n\nYour task is to implement the following procedure:\n- Represent $u(\\varphi)$ and $v(\\varphi)$ on a uniform grid of $M$ points in the interval $[0,2\\pi)$ and work with Fast Fourier Transform (FFT) to solve $L_{\\omega}\\phi = g$ in Fourier space, truncating to harmonics with index magnitude at most $K$.\n- At each iteration, compute the invariance errors\n$$\nE_1(\\varphi) = u(\\varphi + \\omega) - u(\\varphi) - v(\\varphi) - \\varepsilon \\sin\\!\\big(\\varphi + u(\\varphi)\\big),\n$$\n$$\nE_2(\\varphi) = v(\\varphi + \\omega) - v(\\varphi) - \\varepsilon \\sin\\!\\big(\\varphi + u(\\varphi)\\big),\n$$\nand apply a quasi-Newton KAM step:\n1. Solve $L_{\\omega}\\delta v = -E_2$ for $\\delta v$ using truncated Fourier series.\n2. Solve $L_{\\omega}\\delta u = -E_1 + \\delta v$ for $\\delta u$ using truncated Fourier series.\n3. Update $u \\leftarrow u + \\alpha \\,\\delta u$ and $v \\leftarrow v + \\alpha \\,\\delta v$, where $0 < \\alpha \\leq 1$ is a relaxation factor.\n- Use angles in radians throughout.\n- Use the sup norm on the grid to measure the maximum of $|E_1|$ and $|E_2|$ at each iteration. Declare convergence if the final sup norm is less than a specified tolerance and the sequence of sup norms is nonincreasing up to a small numerical slack.\n\nAssess convergence behavior for rotation numbers $\\omega$ that are Diophantine versus near-resonant. A rotation number $\\omega$ (in radians) is said to satisfy a Diophantine condition if there exist constants $\\gamma > 0$ and $\\tau \\geq 1$ such that for all integers $k \\neq 0$ and $m$,\n$$\n|k\\,\\omega - 2\\pi m| \\geq \\frac{\\gamma}{|k|^{\\tau}}.\n$$\nNear-resonant $\\omega$ violate such lower bounds for some small $|k|$.\n\nImplement a complete, runnable program that performs the KAM iterations and outputs the convergence results for the following test suite. In each case, angles are in radians, and the final answer must be a list of booleans indicating whether the KAM step converged.\n\nTest suite (each tuple is $(\\omega, \\varepsilon, K, M, \\text{max\\_iter}, \\text{tol}, \\alpha)$):\n- Case 1 (Diophantine, small perturbation): $\\omega = 2\\pi\\left(\\frac{\\sqrt{5}-1}{2}\\right)$, $\\varepsilon = 0.05$, $K = 16$, $M = 2048$, $\\text{max\\_iter} = 25$, $\\text{tol} = 10^{-8}$, $\\alpha = 0.5$.\n- Case 2 (near-resonant, small denominator at $k=2$): $\\omega = \\pi + 10^{-10}$, $\\varepsilon = 0.05$, $K = 32$, $M = 2048$, $\\text{max\\_iter} = 25$, $\\text{tol} = 10^{-6}$, $\\alpha = 0.5$.\n- Case 3 (Diophantine, large perturbation): $\\omega = 2\\pi\\left(\\frac{\\sqrt{5}-1}{2}\\right)$, $\\varepsilon = 0.9$, $K = 32$, $M = 2048$, $\\text{max\\_iter} = 25$, $\\text{tol} = 10^{-6}$, $\\alpha = 0.5$.\n- Case 4 (integrable boundary): $\\omega = 2\\pi\\left(\\frac{\\sqrt{5}-1}{2}\\right)$, $\\varepsilon = 0.0$, $K = 16$, $M = 512$, $\\text{max\\_iter} = 5$, $\\text{tol} = 10^{-12}$, $\\alpha = 0.5$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$, where each $\\text{resulti}$ is a boolean indicating convergence for the corresponding case.",
            "solution": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef kam_solver(omega, epsilon, K, M, max_iter, tol, alpha):\n    \"\"\"\n    Performs KAM iterations to find an invariant circle for a twist map.\n\n    Args:\n        omega (float): The rotation number of the torus.\n        epsilon (float): The perturbation strength.\n        K (int): The Fourier truncation mode number.\n        M (int): The number of grid points for discretization.\n        max_iter (int): The maximum number of iterations.\n        tol (float): The convergence tolerance for the sup-norm of the error.\n        alpha (float): The relaxation factor for the updates.\n\n    Returns:\n        bool: True if the method converged, False otherwise.\n    \"\"\"\n    # 1. Setup: Grid, wavenumbers, initial guess\n    phi_grid = np.linspace(0, 2 * np.pi, M, endpoint=False)\n    # Integer wavenumbers k for FFT, such that f(phi) = sum f_hat[k] exp(1j*k*phi)\n    k_vec = np.fft.fftfreq(M) * M\n\n    u = np.zeros(M)\n    v = np.zeros(M)\n\n    error_history = []\n\n    def shift(f, omega_shift, k_vector):\n        \"\"\"\n        Computes f(phi + omega_shift) using a phase shift in Fourier space.\n        \"\"\"\n        f_hat = np.fft.fft(f)\n        f_shifted_hat = f_hat * np.exp(1j * k_vector * omega_shift)\n        return np.real(np.fft.ifft(f_shifted_hat))\n\n    def solve_cohomological(g, omega_solve, k_vector, K_trunc):\n        \"\"\"\n        Solves the cohomological equation L_omega * phi = g for a zero-mean phi.\n        The equation is solved in Fourier space with truncation at |k| <= K_trunc.\n        \"\"\"\n        g_hat = np.fft.fft(g)\n        phi_hat = np.zeros_like(g_hat)\n\n        # Create a mask for modes to include: |k| <= K and k != 0\n        k_mask = (np.abs(k_vector) <= K_trunc) & (k_vector != 0)\n        \n        # Denominator exp(i*k*omega) - 1\n        denom = np.exp(1j * k_vector[k_mask] * omega_solve) - 1.0\n        \n        # Solve for phi_hat_k = g_hat_k / denom for the selected modes.\n        # This implicitly sets phi_hat_0 = 0, enforcing a zero-mean solution.\n        phi_hat[k_mask] = g_hat[k_mask] / denom\n        \n        return np.real(np.fft.ifft(phi_hat))\n\n    # 2. Iteration Loop\n    for i in range(max_iter):\n        # Calculate error functions E1, E2\n        u_shifted = shift(u, omega, k_vec)\n        v_shifted = shift(v, omega, k_vec)\n\n        pert_term = epsilon * np.sin(phi_grid + u)\n\n        E1 = u_shifted - u - v - pert_term\n        E2 = v_shifted - v - pert_term\n\n        # Check for convergence/divergence\n        current_error = np.maximum(np.max(np.abs(E1)), np.max(np.abs(E2)))\n        error_history.append(current_error)\n\n        # Divergence check: error must be non-increasing\n        # A small slack is added to account for floating point noise\n        if i > 0 and current_error > error_history[-2] + 1e-12:\n            return False\n\n        # Convergence check\n        if current_error < tol:\n            return True\n\n        # 3. Quasi-Newton Step\n        g2 = -E2\n        delta_v = solve_cohomological(g2, omega, k_vec, K)\n        \n        g1 = -E1 + delta_v\n        delta_u = solve_cohomological(g1, omega, k_vec, K)\n\n        # 4. Update u and v\n        u += alpha * delta_u\n        v += alpha * delta_v\n        \n    # Check convergence after the last iteration\n    return error_history[-1] < tol\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print a single line of output.\n    \"\"\"\n    # Test suite: (omega, epsilon, K, M, max_iter, tol, alpha)\n    test_cases = [\n        # Case 1 (Diophantine, small perturbation): Converges\n        (2 * np.pi * (np.sqrt(5) - 1) / 2, 0.05, 16, 2048, 25, 1e-8, 0.5),\n        # Case 2 (near-resonant): Diverges due to small denominators\n        (np.pi + 1e-10, 0.05, 32, 2048, 25, 1e-6, 0.5),\n        # Case 3 (Diophantine, large perturbation): Diverges, outside convergence radius\n        (2 * np.pi * (np.sqrt(5) - 1) / 2, 0.9, 32, 2048, 25, 1e-6, 0.5),\n        # Case 4 (integrable boundary): Converges trivially on first step\n        (2 * np.pi * (np.sqrt(5) - 1) / 2, 0.0, 16, 512, 5, 1e-12, 0.5),\n    ]\n\n    results = []\n    for params in test_cases:\n        converged = kam_solver(*params)\n        results.append(converged)\n\n    # Format output as a list of booleans\n    result_str = [str(r).lower() for r in results]\n    print(f\"[{','.join(result_str)}]\")\n\nsolve()\n```",
            "answer": "[true,false,false,true]"
        }
    ]
}