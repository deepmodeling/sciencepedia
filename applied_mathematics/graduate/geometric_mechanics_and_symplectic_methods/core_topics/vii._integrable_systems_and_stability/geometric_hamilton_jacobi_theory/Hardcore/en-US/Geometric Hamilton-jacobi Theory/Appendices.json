{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone application of geometric Hamilton-Jacobi theory is its ability to \"solve\" completely integrable systems by transforming them into a simpler set of coordinates known as action-angle variables. In these new coordinates, the dynamics become remarkably straightforward: the action variables are constants of motion, and the angle variables evolve linearly with time. This exercise  provides a concrete opportunity to master this powerful technique by applying it to the two-dimensional isotropic harmonic oscillator, a fundamental model in classical mechanics. By explicitly constructing the generating function and deriving the action-angle variables, you will gain hands-on experience with the separation of variables method and see how it reveals the underlying torus structure of the motion.",
            "id": "3743339",
            "problem": "Consider the two-dimensional isotropic harmonic oscillator on the cotangent bundle $T^{\\ast}\\mathbb{R}^{2}$ with canonical coordinates $(q_{1},q_{2},p_{1},p_{2})$. The phase space carries the canonical symplectic form $\\omega_{\\mathrm{can}}=\\mathrm{d}q_{1}\\wedge \\mathrm{d}p_{1}+\\mathrm{d}q_{2}\\wedge \\mathrm{d}p_{2}$, and the Hamiltonian is\n$$\nH(q_{1},q_{2},p_{1},p_{2})=\\frac{1}{2m}\\left(p_{1}^{2}+p_{2}^{2}\\right)+\\frac{1}{2}m\\omega^{2}\\left(q_{1}^{2}+q_{2}^{2}\\right),\n$$\nwhere $m>0$ and $\\omega>0$ are constants. Using geometric Hamilton-Jacobi theory, construct a type-I generating function $S(q_{1},q_{2};J_{1},J_{2})$ with parameters $J_{1},J_{2}$ (to be identified as action variables) satisfying the Hamilton-Jacobi equation $H\\!\\left(q_{1},q_{2},\\frac{\\partial S}{\\partial q_{1}},\\frac{\\partial S}{\\partial q_{2}}\\right)=K(J_{1},J_{2})$ for some function $K$ depending only on $(J_{1},J_{2})$, and thereby obtain a canonical transformation to action-angle variables $(J_{1},J_{2},\\theta_{1},\\theta_{2})$. Derive explicit formulas for the action variables $J_{1},J_{2}$ and the angle variables $\\theta_{1},\\theta_{2}$ in terms of $(q_{1},q_{2},p_{1},p_{2})$, and show directly from the transformed Hamiltonian $K(J_{1},J_{2})$ that the angle variables evolve linearly in time.\n\nYour final answer must be given as a single row matrix containing the expressions $(J_{1},J_{2},\\theta_{1}(t),\\theta_{2}(t))$, where $\\theta_{i}(t)$ is the time evolution of the angle variable with initial value determined by the initial condition $(q_{i}(0),p_{i}(0))$. No numerical approximation is required; present all expressions in exact symbolic form. No units are required in the final answer.",
            "solution": "The problem is first validated.\nThe givens are:\n- Phase space: The cotangent bundle $T^{\\ast}\\mathbb{R}^{2}$ with canonical coordinates $(q_{1},q_{2},p_{1},p_{2})$.\n- Symplectic form: $\\omega_{\\mathrm{can}}=\\mathrm{d}q_{1}\\wedge \\mathrm{d}p_{1}+\\mathrm{d}q_{2}\\wedge \\mathrm{d}p_{2}$.\n- Hamiltonian: $H(q_{1},q_{2},p_{1},p_{2})=\\frac{1}{2m}\\left(p_{1}^{2}+p_{2}^{2}\\right)+\\frac{1}{2}m\\omega^{2}\\left(q_{1}^{2}+q_{2}^{2}\\right)$.\n- Constants: $m>0$, $\\omega>0$.\n\nThe problem is scientifically grounded, as the two-dimensional isotropic harmonic oscillator is a fundamental, well-understood model in classical mechanics. It is well-posed, as it concerns a completely integrable system for which action-angle variables are known to exist. The problem is stated objectively and provides all necessary information for a unique solution. It is a standard problem in geometric mechanics and is directly related to the topic of geometric Hamilton-Jacobi theory. Therefore, the problem is valid.\n\nWe begin by writing the Hamilton-Jacobi equation (HJE) for a type-I generating function $S(q_1, q_2)$. The new momenta are the action variables $J_1, J_2$, and the new Hamiltonian $K(J_1, J_2)$ is equal to the total energy $E_c$. The HJE is obtained by substituting $p_k = \\frac{\\partial S}{\\partial q_k}$ into the Hamiltonian, $H(q_k, \\frac{\\partial S}{\\partial q_k}) = K(J_1, J_2)$.\n$$\n\\frac{1}{2m}\\left[\\left(\\frac{\\partial S}{\\partial q_{1}}\\right)^{2}+\\left(\\frac{\\partial S}{\\partial q_{2}}\\right)^{2}\\right]+\\frac{1}{2}m\\omega^{2}\\left(q_{1}^{2}+q_{2}^{2}\\right)=K\n$$\nThe Hamiltonian is additively separable in the Cartesian coordinates $(q_1, q_2)$. We can therefore seek a separated solution for $S$ of the form $S(q_1, q_2) = S_1(q_1) + S_2(q_2)$. Substituting this into the HJE yields:\n$$\n\\left[\\frac{1}{2m}\\left(\\frac{\\mathrm{d} S_{1}}{\\mathrm{d} q_{1}}\\right)^{2}+\\frac{1}{2}m\\omega^{2}q_{1}^{2}\\right]+\\left[\\frac{1}{2m}\\left(\\frac{\\mathrm{d} S_{2}}{\\mathrm{d} q_{2}}\\right)^{2}+\\frac{1}{2}m\\omega^{2}q_{2}^{2}\\right]=K\n$$\nSince the first bracketed term depends only on $q_1$ and the second only on $q_2$, they must each be equal to a constant for their sum to be a constant $K$. Let these separation constants be $E_1$ and $E_2$.\n$$\n\\frac{1}{2m}\\left(\\frac{\\mathrm{d} S_{1}}{\\mathrm{d} q_{1}}\\right)^{2}+\\frac{1}{2}m\\omega^{2}q_{1}^{2} = E_1\n$$\n$$\n\\frac{1}{2m}\\left(\\frac{\\mathrm{d} S_{2}}{\\mathrm{d} q_{2}}\\right)^{2}+\\frac{1}{2}m\\omega^{2}q_{2}^{2} = E_2\n$$\nwith $E_1 + E_2 = K$. These are the Hamilton-Jacobi equations for two independent one-dimensional harmonic oscillators with energies $E_1$ and $E_2$. The function $S(q_1, q_2)$ is parameterized by these constants, so we write $S(q_1, q_2; E_1, E_2)$. The problem asks for a generating function $S(q_1, q_2; J_1, J_2)$, where $J_1, J_2$ are the action variables. The action variables are defined by the phase-space integrals $J_k = \\frac{1}{2\\pi}\\oint p_k\\,\\mathrm{d}q_k$, where the integral is taken over one cycle of the motion.\nFrom the separated equations, we have $p_k = \\frac{\\mathrm{d} S_k}{\\mathrm{d} q_k} = \\sqrt{2mE_k - m^2\\omega^2q_k^2}$.\nThe action variable $J_k$ is then:\n$$\nJ_k = \\frac{1}{2\\pi}\\oint \\sqrt{2mE_k - m^2\\omega^2q_k^2}\\,\\mathrm{d}q_k\n$$\nThe integral is over the closed path in the $(q_k, p_k)$ phase plane defined by the constant energy $E_k$. The turning points of the motion are where $p_k=0$, which gives $q_{k, \\text{max}} = \\pm \\frac{\\sqrt{2mE_k}}{m\\omega}$.\nTo evaluate the integral, we can perform a substitution $q_k = \\frac{\\sqrt{2mE_k}}{m\\omega}\\sin\\phi$, so $\\mathrm{d}q_k = \\frac{\\sqrt{2mE_k}}{m\\omega}\\cos\\phi\\,\\mathrm{d}\\phi$.\n$$\nJ_k = \\frac{1}{2\\pi}\\int_0^{2\\pi} \\sqrt{2mE_k - m^2\\omega^2\\left(\\frac{2mE_k}{m^2\\omega^2}\\sin^2\\phi\\right)}\\left(\\frac{\\sqrt{2mE_k}}{m\\omega}\\cos\\phi\\right)\\,\\mathrm{d}\\phi\n$$\n$$\nJ_k = \\frac{1}{2\\pi}\\int_0^{2\\pi} \\sqrt{2mE_k(1-\\sin^2\\phi)}\\left(\\frac{\\sqrt{2mE_k}}{m\\omega}\\cos\\phi\\right)\\,\\mathrm{d}\\phi = \\frac{1}{2\\pi}\\int_0^{2\\pi} (\\sqrt{2mE_k}\\cos\\phi)\\left(\\frac{\\sqrt{2mE_k}}{m\\omega}\\cos\\phi\\right)\\,\\mathrm{d}\\phi\n$$\n$$\nJ_k = \\frac{2mE_k}{2\\pi m\\omega}\\int_0^{2\\pi} \\cos^2\\phi\\,\\mathrm{d}\\phi = \\frac{E_k}{\\pi\\omega}\\int_0^{2\\pi} \\frac{1+\\cos(2\\phi)}{2}\\,\\mathrm{d}\\phi = \\frac{E_k}{\\pi\\omega}\\left[\\frac{\\phi}{2}+\\frac{\\sin(2\\phi)}{4}\\right]_0^{2\\pi} = \\frac{E_k}{\\pi\\omega}(\\pi) = \\frac{E_k}{\\omega}\n$$\nThus, we have the relationship $E_k = J_k\\omega$. The separation constants $E_k$ are directly proportional to the action variables $J_k$. We can now express the transformed Hamiltonian $K$ in terms of the actions:\n$$\nK(J_1, J_2) = E_1+E_2 = J_1\\omega + J_2\\omega = \\omega(J_1+J_2)\n$$\nThe action variables $J_k$ are constants of motion. Their explicit expressions in terms of the original coordinates $(q_k, p_k)$ are obtained by recalling that $E_k$ is the energy of the $k$-th oscillator:\n$$\nE_k = \\frac{1}{2m}p_k^2 + \\frac{1}{2}m\\omega^2q_k^2\n$$\nTherefore, the action variables are:\n$$\nJ_1 = \\frac{E_1}{\\omega} = \\frac{1}{2m\\omega}p_1^2 + \\frac{m\\omega}{2}q_1^2\n$$\n$$\nJ_2 = \\frac{E_2}{\\omega} = \\frac{1}{2m\\omega}p_2^2 + \\frac{m\\omega}{2}q_2^2\n$$\nThe generating function is $S(q_1,q_2;J_1,J_2) = S_1(q_1;J_1) + S_2(q_2;J_2)$, where $S_k(q_k;J_k) = \\int \\sqrt{2mJ_k\\omega - m^2\\omega^2q_k^2}\\,\\mathrm{d}q_k$.\nThe angle variables $\\theta_k$ are the new coordinates conjugate to the momenta $J_k$. For a type-I generating function, they are given by $\\theta_k = \\frac{\\partial S}{\\partial J_k}$.\n$$\n\\theta_k = \\frac{\\partial S_k(q_k; J_k)}{\\partial J_k} = \\frac{\\partial}{\\partial J_k}\\int p_k(q_k, J_k)\\,\\mathrm{d}q_k = \\int \\frac{\\partial p_k}{\\partial J_k}\\,\\mathrm{d}q_k\n$$\nFrom $p_k^2 = 2mJ_k\\omega - m^2\\omega^2q_k^2$, we differentiate with respect to $J_k$: $2p_k\\frac{\\partial p_k}{\\partial J_k} = 2m\\omega$, which gives $\\frac{\\partial p_k}{\\partial J_k} = \\frac{m\\omega}{p_k}$.\nSubstituting this into the integral for $\\theta_k$:\n$$\n\\theta_k = \\int \\frac{m\\omega}{p_k}\\,\\mathrm{d}q_k = \\int \\frac{m\\omega}{\\sqrt{2mJ_k\\omega - m^2\\omega^2q_k^2}}\\,\\mathrm{d}q_k\n$$\n$$\n\\theta_k = \\int \\frac{\\mathrm{d}q_k}{\\sqrt{\\frac{2J_k}{m\\omega} - q_k^2}} = \\arcsin\\left(\\frac{q_k}{\\sqrt{2J_k/m\\omega}}\\right) + \\delta_k\n$$\nwhere $\\delta_k$ is a constant of integration, which we set to zero. To express $\\theta_k$ in terms of $(q_k, p_k)$, we can use a trigonometric identity. Let $\\alpha = \\theta_k$. Then $\\sin\\alpha = q_k\\sqrt{\\frac{m\\omega}{2J_k}}$.\nThen $\\cos\\alpha = \\sqrt{1-\\sin^2\\alpha} = \\sqrt{1 - \\frac{m\\omega q_k^2}{2J_k}} = \\sqrt{\\frac{2J_k - m\\omega q_k^2}{2J_k}} = \\sqrt{\\frac{p_k^2/(m\\omega)}{2J_k}} = \\frac{p_k}{\\sqrt{2m\\omega J_k}}$.\nSo, $\\tan\\theta_k = \\frac{\\sin\\alpha}{\\cos\\alpha} = \\frac{q_k\\sqrt{m\\omega/2J_k}}{p_k/\\sqrt{2m\\omega J_k}} = \\frac{m\\omega q_k}{p_k}$.\nThe angle variables are thus given by:\n$$\n\\theta_1 = \\arctan\\left(\\frac{m\\omega q_1}{p_1}\\right)\n$$\n$$\n\\theta_2 = \\arctan\\left(\\frac{m\\omega q_2}{p_2}\\right)\n$$\nThe quadrant for $\\theta_k$ is determined by the signs of $q_k$ and $p_k$.\n\nFinally, we show the linear time evolution of the angle variables. In the new action-angle coordinates $(J_1, J_2, \\theta_1, \\theta_2)$, Hamilton's equations are $\\dot{J}_k = -\\frac{\\partial K}{\\partial \\theta_k}$ and $\\dot{\\theta}_k = \\frac{\\partial K}{\\partial J_k}$.\nUsing the transformed Hamiltonian $K(J_1, J_2) = \\omega(J_1+J_2)$:\n$$\n\\dot{J}_k = -\\frac{\\partial}{\\partial \\theta_k}\\left[\\omega(J_1+J_2)\\right] = 0\n$$\nThis confirms that the action variables are constants of motion. For the angle variables:\n$$\n\\dot{\\theta}_1 = \\frac{\\partial}{\\partial J_1}\\left[\\omega(J_1+J_2)\\right] = \\omega\n$$\n$$\n\\dot{\\theta}_2 = \\frac{\\partial}{\\partial J_2}\\left[\\omega(J_1+J_2)\\right] = \\omega\n$$\nBoth angle variables evolve with the same constant frequency $\\omega$. Integrating with respect to time $t$ gives their linear evolution:\n$$\n\\theta_k(t) = \\omega t + \\theta_k(0)\n$$\nThe initial value $\\theta_k(0)$ is determined by the initial conditions $(q_k(0), p_k(0))$:\n$$\n\\theta_k(0) = \\arctan\\left(\\frac{m\\omega q_k(0)}{p_k(0)}\\right)\n$$\nThus, the time-dependent angle variables are:\n$$\n\\theta_1(t) = \\omega t + \\arctan\\left(\\frac{m\\omega q_1(0)}{p_1(0)}\\right)\n$$\n$$\n\\theta_2(t) = \\omega t + \\arctan\\left(\\frac{m\\omega q_2(0)}{p_2(0)}\\right)\n$$\n\nThe final answer requires the expressions for $(J_1, J_2, \\theta_1(t), \\theta_2(t))$. The expressions for $J_k$ are in terms of the instantaneous variables $(q_k, p_k)$, which is standard as they are conserved quantities.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{p_1^2}{2m\\omega} + \\frac{m\\omega q_1^2}{2} & \\frac{p_2^2}{2m\\omega} + \\frac{m\\omega q_2^2}{2} & \\omega t + \\arctan\\left(\\frac{m\\omega q_1(0)}{p_1(0)}\\right) & \\omega t + \\arctan\\left(\\frac{m\\omega q_2(0)}{p_2(0)}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond transforming coordinates, generating functions provide a powerful way to represent symplectic maps, including the time-evolution maps (flows) generated by a Hamiltonian. This practice  explores this connection in the context of near-identity transformations, which are central to perturbation theory and the construction of symplectic numerical integrators. You will compute the generating function for a short-time Hamiltonian flow using the Poincaré lemma and verify how these generating functions compose, providing a second-order approximation to the composed flow. This exercise illuminates the deep relationship between Hamiltonian dynamics and the geometry of generating functions.",
            "id": "3743329",
            "problem": "Consider the cotangent bundle $T^{\\ast}\\mathbb{R}$ with global coordinates $(q,p)$, the canonical one-form $\\theta = p\\,dq$, and the canonical symplectic form $\\omega = d\\theta$. Let $H_{j}(q,p) = \\frac{1}{2}a_{j}q^{2} + b_{j}qp + \\frac{1}{2}c_{j}p^{2}$, with $a_{j}, b_{j}, c_{j} \\in \\mathbb{R}$ fixed constants, for $j=1,2$. Let $\\Phi_{j}^{\\varepsilon}$ denote the time-$\\varepsilon$ Hamiltonian flow of $H_{j}$, so that $(q',p') = \\Phi_{j}^{\\varepsilon}(q,p)$ solves Hamilton's equations to first order in $\\varepsilon$:\n$$\n\\dot{q} = \\frac{\\partial H_{j}}{\\partial p}, \\quad \\dot{p} = -\\frac{\\partial H_{j}}{\\partial q}.\n$$\nWe will work consistently up to and including terms of order $\\varepsilon^{2}$ (i.e., discard all terms $O(\\varepsilon^{3})$ and higher). Define the near-identity symplectomorphisms $F_{j} := \\Phi_{j}^{\\varepsilon}$ for $j=1,2$, and their composition $F_{12} := F_{2} \\circ F_{1}$. Because each $F_{j}$ is symplectic, the one-form $F_{j}^{\\ast}\\theta - \\theta$ is closed. Use the Poincaré lemma to define $S_{j}$ (unique up to an additive constant) so that $dS_{j} = F_{j}^{\\ast}\\theta - \\theta$. Fix the additive constants by the normalization $S_{j}(0,0)=0$.\n\n(a) Starting from Hamilton's equations and the definitions above, compute $F_{j}(q,p)$ to first order in $\\varepsilon$, then compute the closed one-form $F_{j}^{\\ast}\\theta - \\theta$ to first nontrivial order in $\\varepsilon$, and determine $S_{j}(q,p)$ such that $dS_{j} = F_{j}^{\\ast}\\theta - \\theta$ under the normalization $S_{j}(0,0)=0$.\n\n(b) Using only the properties of the pullback and exterior derivative, show that\n$$\nF_{12}^{\\ast}\\theta - \\theta = F_{1}^{\\ast}(F_{2}^{\\ast}\\theta - \\theta) + \\big(F_{1}^{\\ast}\\theta - \\theta\\big),\n$$\nand hence, to second order in $\\varepsilon$, one can take\n$$\nS_{12} = S_{1} + S_{2} \\circ F_{1}\n$$\nwith the same normalization at $(0,0)$. Compute explicitly $S_{12}(q,p)$ to second order in $\\varepsilon$ as a polynomial in $q$ and $p$ with coefficients depending on $a_{1},b_{1},c_{1},a_{2},b_{2},c_{2}$, and verify by direct differentiation that $dS_{12} = F_{12}^{\\ast}\\theta - \\theta$ up to and including terms of order $\\varepsilon^{2}$.\n\nYour final answer must be the single closed-form analytic expression you obtain for $S_{12}(q,p)$ truncated at order $\\varepsilon^{2}$ (i.e., without any $O(\\varepsilon^{3})$ remainder term). No rounding is required.",
            "solution": "This problem involves computing generating functions for composed Hamiltonian flows up to second order. We follow the steps outlined.\n\n**(a) Computation of $S_j(q,p)$**\n\nFirst, we write Hamilton's equations for $H_j = \\frac{1}{2}a_{j}q^{2} + b_{j}qp + \\frac{1}{2}c_{j}p^{2}$:\n$$ \\dot{q} = \\frac{\\partial H_{j}}{\\partial p} = b_j q + c_j p $$\n$$ \\dot{p} = -\\frac{\\partial H_{j}}{\\partial q} = -a_j q - b_j p $$\nThe time-$\\varepsilon$ flow $F_j(q,p) = (q', p')$ can be approximated by a Taylor expansion around $\\varepsilon=0$:\n$$ q' = q + \\varepsilon \\dot{q} + O(\\varepsilon^2) = q + \\varepsilon(b_j q + c_j p) + O(\\varepsilon^2) $$\n$$ p' = p + \\varepsilon \\dot{p} + O(\\varepsilon^2) = p - \\varepsilon(a_j q + b_j p) + O(\\varepsilon^2) $$\nNow we compute the pullback of the canonical 1-form $\\theta = p\\,dq$:\n$$ F_j^*\\theta = p'dq' = \\left(p - \\varepsilon(a_j q + b_j p)\\right) d\\left(q + \\varepsilon(b_j q + c_j p)\\right) + O(\\varepsilon^2) $$\n$$ F_j^*\\theta = \\left(p - \\varepsilon(a_j q + b_j p)\\right) \\left(dq + \\varepsilon(b_j dq + c_j dp)\\right) + O(\\varepsilon^2) $$\nExpanding and keeping terms up to order $\\varepsilon$:\n$$ F_j^*\\theta = p\\,dq + \\varepsilon p(b_j dq + c_j dp) - \\varepsilon(a_j q + b_j p)dq + O(\\varepsilon^2) $$\n$$ F_j^*\\theta = p\\,dq + \\varepsilon (p b_j dq + p c_j dp - a_j q dq - p b_j dq) + O(\\varepsilon^2) $$\n$$ F_j^*\\theta = p\\,dq + \\varepsilon (-a_j q dq + c_j p dp) + O(\\varepsilon^2) $$\nThe problem defines $S_j$ via $dS_j = F_j^*\\theta - \\theta$. The first non-trivial terms are of order $\\varepsilon$:\n$$ dS_j = \\varepsilon (-a_j q dq + c_j p dp) $$\nThis is an exact 1-form. We can integrate to find $S_j$:\n$$ S_j(q,p) = \\int \\varepsilon (-a_j q dq + c_j p dp) = \\varepsilon \\left(-\\frac{1}{2} a_j q^2 + \\frac{1}{2} c_j p^2\\right) + C $$\nThe normalization condition $S_j(0,0)=0$ implies the integration constant $C=0$. Thus, to first order in $\\varepsilon$:\n$$ S_j(q,p) = \\varepsilon \\left(-\\frac{1}{2} a_j q^2 + \\frac{1}{2} c_j p^2\\right) $$\n\n**(b) Computation of $S_{12}(q,p)$**\n\nThe composition is $F_{12} = F_2 \\circ F_1$. The identity for the pullback is\n$$ F_{12}^*\\theta - \\theta = (F_2 \\circ F_1)^*\\theta - \\theta = F_1^*(F_2^*\\theta) - \\theta = F_1^*(F_2^*\\theta - \\theta) + F_1^*\\theta - \\theta $$\nUsing $dS_j = F_j^*\\theta - \\theta$, this becomes:\n$$ dS_{12} = F_1^*(dS_2) + dS_1 = d(S_2 \\circ F_1) + dS_1 = d(S_1 + S_2 \\circ F_1) $$\nTherefore, up to a constant, $S_{12} = S_1 + S_2 \\circ F_1$. The normalization $S_{12}(0,0)=0$ is satisfied if $S_1(0,0)=0$ and $S_2(F_1(0,0))=0$. Since $F_1(0,0)=(0,0)$, this reduces to $S_2(0,0)=0$.\n\nTo compute $S_{12}$ to order $\\varepsilon^2$, we need to evaluate $S_2 \\circ F_1$. The function $S_2$ is already of order $\\varepsilon$, so to obtain the $\\varepsilon^2$ term, we must use the first-order approximation for the flow $F_1(q,p) = (q_1, p_1)$:\n$$ q_1 = q + \\varepsilon(b_1 q + c_1 p) + O(\\varepsilon^2) $$\n$$ p_1 = p - \\varepsilon(a_1 q + b_1 p) + O(\\varepsilon^2) $$\nNow we substitute this into the expression for $S_2$:\n$$ S_2 \\circ F_1 = S_2(q_1, p_1) = \\varepsilon \\left(-\\frac{1}{2} a_2 q_1^2 + \\frac{1}{2} c_2 p_1^2\\right) $$\nWe expand the squares, keeping terms that will result in up to $\\varepsilon^2$ overall:\n$$ q_1^2 = \\left(q + \\varepsilon(b_1 q + c_1 p)\\right)^2 + O(\\varepsilon^2) = q^2 + 2\\varepsilon(b_1 q^2 + c_1 qp) + O(\\varepsilon^2) $$\n$$ p_1^2 = \\left(p - \\varepsilon(a_1 q + b_1 p)\\right)^2 + O(\\varepsilon^2) = p^2 - 2\\varepsilon(a_1 qp + b_1 p^2) + O(\\varepsilon^2) $$\nSubstitute these back into $S_2 \\circ F_1$:\n$$ S_2 \\circ F_1 = \\varepsilon \\left[ -\\frac{1}{2}a_2 \\left(q^2 + 2\\varepsilon(b_1 q^2 + c_1 qp)\\right) + \\frac{1}{2}c_2 \\left(p^2 - 2\\varepsilon(a_1 qp + b_1 p^2)\\right) \\right] + O(\\varepsilon^3) $$\n$$ S_2 \\circ F_1 = \\varepsilon\\left(-\\frac{1}{2}a_2 q^2 + \\frac{1}{2}c_2 p^2\\right) + \\varepsilon^2 \\left[ -a_2(b_1 q^2 + c_1 qp) - c_2(a_1 qp + b_1 p^2) \\right] + O(\\varepsilon^3) $$\nThe first term is just $S_2(q,p)$. So,\n$$ S_2 \\circ F_1 = S_2(q,p) + \\varepsilon^2 \\left( -a_2 b_1 q^2 - (a_1 c_2 + a_2 c_1)qp - b_1 c_2 p^2 \\right) + O(\\varepsilon^3) $$\nFinally, we assemble $S_{12}$:\n$$ S_{12}(q,p) = S_1(q,p) + S_2 \\circ F_1(q,p) $$\n$$ S_{12}(q,p) = S_1(q,p) + S_2(q,p) + \\varepsilon^2 \\left( -a_2 b_1 q^2 - (a_1 c_2 + a_2 c_1)qp - b_1 c_2 p^2 \\right) + O(\\varepsilon^3) $$\nSubstituting the expressions for $S_1$ and $S_2$:\n$$ S_{12}(q,p) = \\varepsilon\\left(-\\frac{1}{2}a_1 q^2 + \\frac{1}{2}c_1 p^2\\right) + \\varepsilon\\left(-\\frac{1}{2}a_2 q^2 + \\frac{1}{2}c_2 p^2\\right) + \\varepsilon^2 \\left( \\dots \\right) + O(\\varepsilon^3) $$\nCombining the order $\\varepsilon$ terms and truncating at $\\varepsilon^2$:\n$$ S_{12}(q,p) = \\varepsilon \\left( -\\frac{1}{2}(a_1+a_2)q^2 + \\frac{1}{2}(c_1+c_2)p^2 \\right) + \\varepsilon^2 \\left( -a_2 b_1 q^2 - (a_1 c_2 + a_2 c_1)qp - b_1 c_2 p^2 \\right) $$\nThis is the desired expression for the generating function of the composed map $F_{12}$.",
            "answer": "$$\n\\boxed{\\varepsilon \\left( -\\frac{1}{2}(a_{1}+a_{2})q^{2} + \\frac{1}{2}(c_{1}+c_{2})p^{2} \\right) + \\varepsilon^{2} \\left( -a_{2} b_{1} q^{2} - (a_{1} c_{2} + a_{2} c_{1})qp - b_{1} c_{2} p^{2} \\right)}\n$$"
        },
        {
            "introduction": "The power of the geometric Hamilton-Jacobi framework truly shines when extended beyond standard unconstrained systems. Nonholonomic systems, such as a rolling disk or a knife-edge, are subject to velocity-dependent constraints that break the standard symplectic structure, rendering the classical Hamilton-Jacobi equation inapplicable. This exercise  guides you through the process of adapting the theory to this challenging context. By working with the concrete example of a knife-edge, you will construct a solution to the *nonholonomic* Hamilton-Jacobi equations, which are defined on a constrained momentum submanifold, providing a crucial insight into the geometric mechanics of constrained motion.",
            "id": "3743327",
            "problem": "Consider the knife-edge model of a rigid body moving in the plane with configuration manifold $Q=\\mathbb{R}^{2}\\times S^{1}$, endowed with standard coordinates $(x,y,\\theta)$, where $(x,y)$ denotes the contact point in the plane and $\\theta$ is the body orientation. The kinetic energy is defined by a mechanical Riemannian metric $g$ of the form $g=m\\,(dx^{2}+dy^{2})+I\\,d\\theta^{2}$, where $m>0$ is the mass and $I>0$ is the planar moment of inertia about the contact. The nonholonomic constraint that forbids lateral slip is the linear velocity constraint\n$$\n-\\sin\\theta\\,\\dot{x}+\\cos\\theta\\,\\dot{y}=0,\n$$\nwhich defines a rank-$2$ distribution $\\mathcal{D}\\subset TQ$.\n\nLet $b:TQ\\to T^{*}Q$ be the musical isomorphism induced by $g$, and let $\\mathcal{M}=b(\\mathcal{D})\\subset T^{*}Q$ denote the nonholonomic momentum submanifold. The (mechanical) Hamiltonian is \n$$\nH(q,p)=\\tfrac{1}{2m}\\left(p_{x}^{2}+p_{y}^{2}\\right)+\\tfrac{1}{2I}\\,p_{\\theta}^{2}.\n$$\nA geometric Hamilton–Jacobi (HJ) solution for the nonholonomic system is a one-form $\\alpha\\in\\Gamma(\\mathcal{M})$ satisfying the two conditions:\n(i) the energy is constant along the constraint directions, $d\\!\\left(H\\circ\\alpha\\right)\\big|_{\\mathcal{D}}=0$, and \n(ii) $\\alpha$ is closed along the distribution, $d\\alpha(v,w)=0$ for all $v,w\\in\\mathcal{D}$.\n\nWorking from first principles and using coordinates adapted to $\\mathcal{D}$, explicitly construct such a nonholonomic HJ solution for the knife-edge. Your construction must be intrinsic and geometrically justified, starting from the metric $g$, the constraint distribution $\\mathcal{D}$, and the definition of $\\mathcal{M}$. Impose a fixed positive energy level $E>0$ and choose any solution that respects the constraint and yields $H\\circ\\alpha=E$, while also satisfying $d\\alpha\\big|_{\\mathcal{D}}=0$. Express your final answer as a single closed-form analytic expression for $\\alpha$ in the canonical coordinates $(x,y,\\theta)$, with parameters $m$ and $E$.\n\nThe final answer must be a single symbolic mathematical expression. No numerical rounding is required. No physical units should be included with the final expression.",
            "solution": "The problem is a valid and well-posed question in geometric mechanics, specifically concerning the application of Hamilton-Jacobi theory to a nonholonomic system. All provided definitions and conditions are standard and scientifically sound. I will proceed with a full solution.\n\nThe problem asks for the construction of a nonholonomic Hamilton-Jacobi (HJ) solution for the knife-edge model. This solution is a one-form $\\alpha$ on the configuration manifold $Q = \\mathbb{R}^{2} \\times S^{1}$ that must satisfy three conditions:\n1.  $\\alpha$ must be a section of the nonholonomic momentum submanifold, i.e., $\\alpha \\in \\Gamma(\\mathcal{M})$.\n2.  The Hamiltonian evaluated on $\\alpha$ must be a constant energy $E > 0$, i.e., $H \\circ \\alpha = E$. This implies the first condition from the problem statement, $d(H \\circ \\alpha)|_{\\mathcal{D}} = d(E)|_{\\mathcal{D}} = 0$, is automatically satisfied.\n3.  $\\alpha$ must be closed along the constraint distribution, i.e., $d\\alpha(v,w) = 0$ for all vector fields $v,w \\in \\Gamma(\\mathcal{D})$.\n\nLet's construct such an $\\alpha$ step-by-step.\n\nFirst, we characterize the constraint distribution $\\mathcal{D}$ and the associated momentum submanifold $\\mathcal{M}$.\nThe nonholonomic constraint is given by the equation $-\\sin\\theta\\,\\dot{x}+\\cos\\theta\\,\\dot{y}=0$. This defines a rank-$2$ distribution $\\mathcal{D} \\subset TQ$. A vector field $v = v^x \\frac{\\partial}{\\partial x} + v^y \\frac{\\partial}{\\partial y} + v^\\theta \\frac{\\partial}{\\partial \\theta}$ belongs to $\\mathcal{D}$ if its components satisfy $-\\sin\\theta\\,v^x+\\cos\\theta\\,v^y=0$.\nA convenient basis for $\\mathcal{D}$ is given by the vector fields:\n$$\nX_1 = \\cos\\theta \\frac{\\partial}{\\partial x} + \\sin\\theta \\frac{\\partial}{\\partial y} \\quad (\\text{forward motion})\n$$\n$$\nX_2 = \\frac{\\partial}{\\partial \\theta} \\quad (\\text{rotation})\n$$\nAny vector in $\\mathcal{D}_q$ can be written as a linear combination of $X_1(q)$ and $X_2(q)$.\n\nThe nonholonomic momentum submanifold $\\mathcal{M}$ is the image of $\\mathcal{D}$ under the musical isomorphism $b: TQ \\to T^*Q$ induced by the metric $g=m\\,(dx^{2}+dy^{2})+I\\,d\\theta^{2}$. A covector $p = p_x dx + p_y dy + p_\\theta d\\theta$ belongs to $\\mathcal{M}_q$ if its corresponding vector $v = b^{-1}(p)$ belongs to $\\mathcal{D}_q$. The inverse map $b^{-1}$ is given by the inverse metric $g^{-1}$:\n$$\nv = b^{-1}(p) = \\frac{p_x}{m} \\frac{\\partial}{\\partial x} + \\frac{p_y}{m} \\frac{\\partial}{\\partial y} + \\frac{p_\\theta}{I} \\frac{\\partial}{\\partial \\theta}\n$$\nApplying the constraint condition to the components of $v$:\n$$\n-\\sin\\theta \\left(\\frac{p_x}{m}\\right) + \\cos\\theta \\left(\\frac{p_y}{m}\\right) = 0 \\implies -p_x \\sin\\theta + p_y \\cos\\theta = 0\n$$\nThis is the equation defining $\\mathcal{M}$ as a submanifold of $T^*Q$.\n\nA one-form $\\alpha = p_x dx + p_y dy + p_\\theta d\\theta$ that is a section of $\\mathcal{M}$ must satisfy the above constraint on its components at every point $(x,y,\\theta) \\in Q$. The condition $-p_x \\sin\\theta + p_y \\cos\\theta = 0$ means that the momentum vector $(p_x, p_y)$ must be parallel to the direction vector $(\\cos\\theta, \\sin\\theta)$. Thus, we can write the components of $\\alpha$ in terms of two unknown functions $f(x,y,\\theta)$ and $g(x,y,\\theta)$:\n$$\np_x = f(x,y,\\theta) \\cos\\theta \\qquad p_y = f(x,y,\\theta) \\sin\\theta \\qquad p_\\theta = g(x,y,\\theta)\n$$\nSo, the general form of $\\alpha \\in \\Gamma(\\mathcal{M})$ is:\n$$\n\\alpha = f(\\cos\\theta dx + \\sin\\theta dy) + g d\\theta\n$$\n\nNext, we apply the constant energy condition $H \\circ \\alpha = E$. The Hamiltonian is $H = \\frac{1}{2m}(p_x^2+p_y^2) + \\frac{1}{2I}p_\\theta^2$. Substituting the components of $\\alpha$:\n$$\n\\frac{1}{2m}\\left((f \\cos\\theta)^2 + (f \\sin\\theta)^2\\right) + \\frac{1}{2I} g^2 = E\n$$\n$$\n\\frac{1}{2m} f^2 (\\cos^2\\theta + \\sin^2\\theta) + \\frac{g^2}{2I} = E\n$$\n$$\n\\frac{f^2}{2m} + \\frac{g^2}{2I} = E\n$$\nThis algebraic equation relates the functions $f$ and $g$.\n\nFinally, we apply the closure condition $d\\alpha(v,w) = 0$ for all $v,w \\in \\Gamma(\\mathcal{D})$. It is sufficient to check this on the basis fields $\\{X_1, X_2\\}$. We use Cartan's formula: $d\\alpha(X_1, X_2) = X_1(\\alpha(X_2)) - X_2(\\alpha(X_1)) - \\alpha([X_1,X_2])$. First, we compute the Lie bracket:\n$$[X_1, X_2] = \\left[\\cos\\theta \\frac{\\partial}{\\partial x} + \\sin\\theta \\frac{\\partial}{\\partial y}, \\frac{\\partial}{\\partial \\theta}\\right] = -\\sin\\theta \\frac{\\partial}{\\partial x} + \\cos\\theta \\frac{\\partial}{\\partial y} =: X_3$$\nNext, we evaluate $\\alpha$ on the basis fields:\n$$ \\alpha(X_1) = f(\\cos\\theta dx + \\sin\\theta dy)(X_1) + g d\\theta(X_1) = f(\\cos^2\\theta + \\sin^2\\theta) + 0 = f $$\n$$ \\alpha(X_2) = f(\\cos\\theta dx + \\sin\\theta dy)(X_2) + g d\\theta(X_2) = 0 + g = g $$\n$$ \\alpha(X_3) = f(\\cos\\theta dx + \\sin\\theta dy)(X_3) + g d\\theta(X_3) = f(-\\sin\\theta\\cos\\theta + \\cos\\theta\\sin\\theta) + 0 = 0 $$\nNow, substituting into Cartan's formula:\n$$ d\\alpha(X_1, X_2) = X_1(g) - X_2(f) - \\alpha(X_3) $$\n$$ d\\alpha(X_1, X_2) = \\left(\\cos\\theta \\frac{\\partial}{\\partial x} + \\sin\\theta \\frac{\\partial}{\\partial y}\\right)g - \\frac{\\partial}{\\partial \\theta}f - 0 $$\n$$ d\\alpha(X_1, X_2) = \\frac{\\partial g}{\\partial x}\\cos\\theta + \\frac{\\partial g}{\\partial y}\\sin\\theta - \\frac{\\partial f}{\\partial \\theta} $$\nSo, the closure condition becomes the partial differential equation:\n$$\n\\frac{\\partial g}{\\partial x}\\cos\\theta + \\frac{\\partial g}{\\partial y}\\sin\\theta - \\frac{\\partial f}{\\partial \\theta} = 0\n$$\n\nWe need to find functions $f$ and $g$ that simultaneously satisfy the algebraic energy equation and the differential closure equation. The problem asks for *any* such solution, and the required format of the final answer (depending only on $m$ and $E$) suggests we seek a solution where the dependence on $I$ is eliminated. This can be achieved by setting the term involving $I$ in the energy equation to zero. Let's try the simple ansatz:\n$$\ng(x,y,\\theta) = 0\n$$\nWith this choice, the algebraic equation becomes:\n$$\n\\frac{f^2}{2m} = E \\implies f^2 = 2mE \\implies f = \\pm \\sqrt{2mE}\n$$\nLet's choose the positive root, $f(x,y,\\theta) = \\sqrt{2mE}$. Since $m$ and $E$ are positive constants, $f$ is a positive constant.\nNow we check if this choice satisfies the PDE. Since $f$ is constant and $g$ is zero:\n$$\n\\frac{\\partial f}{\\partial \\theta} = 0, \\quad \\frac{\\partial g}{\\partial x} = 0, \\quad \\frac{\\partial g}{\\partial y} = 0\n$$\nSubstituting into the PDE gives:\n$$\n(0)\\cos\\theta + (0)\\sin\\theta - 0 = 0\n$$\nThe equation is satisfied. Therefore, the choice $f=\\sqrt{2mE}$ and $g=0$ provides a valid solution.\nSubstituting these functions back into the general form for $\\alpha$:\n$$\n\\alpha = \\sqrt{2mE}(\\cos\\theta dx + \\sin\\theta dy)\n$$\nThis one-form represents a state of pure translational motion with constant kinetic energy $E$, corresponding to movement in a straight line with speed $v = \\sqrt{2E/m}$. This is the simplest non-trivial Hamilton-Jacobi solution for the given system.",
            "answer": "$$\n\\boxed{\\sqrt{2mE}(\\cos\\theta dx + \\sin\\theta dy)}\n$$"
        }
    ]
}