{
    "hands_on_practices": [
        {
            "introduction": "The power of variational integrators lies in their systematic construction, beginning with a discrete approximation of the action. This first exercise will guide you through the fundamental process of building a discrete Lagrangian for a simple mechanical system using standard numerical approximation techniques. By applying the discrete principle of stationary action, you will derive the equations of motion and prove that the resulting numerical map inherently preserves the symplectic structure of the phase space, a hallmark of geometric integration. ",
            "id": "3758398",
            "problem": "Consider a mechanical system with configuration manifold $Q = \\mathbb{R}$, mass parameter $m > 0$, and smooth potential function $V: \\mathbb{R} \\rightarrow \\mathbb{R}$. The continuous Lagrangian is $L(q,\\dot{q}) = \\tfrac{1}{2} m \\dot{q}^{2} - V(q)$. Let $t_{k}$ denote discrete times with fixed step $h > 0$ and sample values $q_{k} \\in \\mathbb{R}$. Starting from the principle of stationary action and the standard definition of a discrete action sum, construct a discrete Lagrangian $L_{d}(q_{k}, q_{k+1}, h)$ by approximating the action on $[t_{k}, t_{k+1}]$ under the following modeling assumptions:\n- Assume $q(t)$ is the unique linear interpolant joining $(t_{k}, q_{k})$ and $(t_{k+1}, q_{k+1})$.\n- Approximate the integral of the potential energy on $[t_{k}, t_{k+1}]$ using the trapezoidal rule.\nDefine the discrete action $S_{d} = \\sum_{k=0}^{N-1} L_{d}(q_{k}, q_{k+1}, h)$ and derive the Discrete Euler-Lagrange (DEL) equations by requiring stationarity of $S_{d}$ with respect to variations of $\\{q_{k}\\}_{k=1}^{N-1}$ with fixed endpoints. Then, introduce the discrete Legendre transforms $p_{k}^{-} := - D_{1} L_{d}(q_{k}, q_{k+1}, h)$ and $p_{k}^{+} := D_{2} L_{d}(q_{k-1}, q_{k}, h)$, and enforce the momentum matching $p_{k}^{-} = p_{k}^{+}$ to obtain the one-step update map $(q_{k}, p_{k}) \\mapsto (q_{k+1}, p_{k+1})$. Prove that this map is symplectic in the sense that it preserves the canonical symplectic form on $T^{*}\\mathbb{R}$.\n\nFinally, specialize to the harmonic oscillator with $V(q) = \\tfrac{1}{2} k q^{2}$, where $k > 0$, and write the resulting one-step map explicitly as closed-form expressions for $q_{k+1}$ and $p_{k+1}$ in terms of $q_{k}$, $p_{k}$, $m$, $k$, and $h$. Your final answer must be a single analytical expression consisting of the two update formulas concatenated as a row matrix. No rounding is required and no units should be included in the final answer.",
            "solution": "The problem statement is a valid exercise in the field of geometric mechanics, specifically concerning the construction of variational integrators. It is scientifically grounded in the principles of stationary action from analytical mechanics and uses standard numerical approximation techniques. The problem is well-posed, with a clear and unambiguous set of instructions that lead to a unique solution. All terms are formally defined, and the task proceeds logically from general principles to a specific application. Therefore, we proceed with the solution.\n\nThe solution is structured in four parts as requested by the problem statement:\n1.  Construction of the discrete Lagrangian $L_d$.\n2.  Derivation of the Discrete Euler-Lagrange (DEL) equations.\n3.  Definition of the one-step map and proof of its symplecticity.\n4.  Specialization to the harmonic oscillator to find the explicit map.\n\n_Part 1: Construction of the Discrete Lagrangian_\n\nThe continuous action on the time interval $[t_k, t_{k+1}]$ is given by the integral of the Lagrangian:\n$$S_{k, k+1} = \\int_{t_k}^{t_{k+1}} L(q(t), \\dot{q}(t)) dt = \\int_{t_k}^{t_{k+1}} \\left( \\frac{1}{2} m \\dot{q}(t)^2 - V(q(t)) \\right) dt$$\nThe discrete Lagrangian $L_d(q_k, q_{k+1}, h)$ is an approximation of this integral. Let $h = t_{k+1} - t_k$.\n\nFirst, we address the kinetic energy term. The problem assumes that $q(t)$ is a linear interpolant between $(t_k, q_k)$ and $(t_{k+1}, q_{k+1})$. On the interval $[t_k, t_{k+1}]$, the velocity $\\dot{q}(t)$ is therefore constant:\n$$\\dot{q}(t) = \\frac{q_{k+1} - q_k}{t_{k+1} - t_k} = \\frac{q_{k+1} - q_k}{h}$$\nThe integral of the kinetic energy is then exact:\n$$\\int_{t_k}^{t_{k+1}} \\frac{1}{2} m \\dot{q}^2 dt = \\frac{1}{2} m \\left(\\frac{q_{k+1} - q_k}{h}\\right)^2 \\int_{t_k}^{t_{k+1}} dt = \\frac{m}{2h^2} (q_{k+1} - q_k)^2 \\cdot h = \\frac{m}{2h} (q_{k+1} - q_k)^2$$\n\nNext, we address the potential energy term. The integral is approximated using the trapezoidal rule as specified:\n$$\\int_{t_k}^{t_{k+1}} V(q(t)) dt \\approx \\frac{h}{2} (V(q(t_k)) + V(q(t_{k+1}))) = \\frac{h}{2} (V(q_k) + V(q_{k+1}))$$\n\nCombining these two results, the discrete Lagrangian $L_d(q_k, q_{k+1}, h)$ is constructed as:\n$$L_d(q_k, q_{k+1}, h) = \\frac{m}{2h} (q_{k+1} - q_k)^2 - \\frac{h}{2} (V(q_k) + V(q_{k+1}))$$\n\n_Part 2: Derivation of the Discrete Euler-Lagrange (DEL) Equations_\n\nThe discrete action $S_d$ is the sum of the discrete Lagrangians over a sequence of points $\\{q_k\\}_{k=0}^N$:\n$$S_d = \\sum_{k=0}^{N-1} L_d(q_k, q_{k+1}, h)$$\nThe principle of stationary action requires that the variation of $S_d$ with respect to an interior point $q_j$ (for $j \\in \\{1, \\dots, N-1\\}$) is zero, holding the endpoints $q_0$ and $q_N$ fixed. The point $q_j$ appears in two terms of the sum: $L_d(q_{j-1}, q_j, h)$ and $L_d(q_j, q_{j+1}, h)$.\nThe stationarity condition is $\\frac{\\partial S_d}{\\partial q_j} = 0$:\n$$\\frac{\\partial S_d}{\\partial q_j} = \\frac{\\partial}{\\partial q_j} \\left[ L_d(q_{j-1}, q_j, h) + L_d(q_j, q_{j+1}, h) \\right] = 0$$\nUsing $D_1$ and $D_2$ to denote partial derivatives with respect to the first and second arguments of $L_d$ respectively, this becomes:\n$$D_2 L_d(q_{j-1}, q_j, h) + D_1 L_d(q_j, q_{j+1}, h) = 0$$\nThis is the general form of the Discrete Euler-Lagrange (DEL) equation.\n\n_Part 3: Symplectic One-Step Map_\n\nThe discrete Legendre transforms are defined as:\n$$p_k^- := -D_1 L_d(q_k, q_{k+1}, h)$$\n$$p_k^+ := D_2 L_d(q_{k-1}, q_k, h)$$\nWith these definitions, the DEL equation, $D_2 L_d(q_{k-1}, q_k, h) + D_1 L_d(q_k, q_{k+1}, h) = 0$, is equivalent to the momentum matching condition $p_k^+ = p_k^-$.\n\nThe one-step update map $\\Phi_h: (q_k, p_k) \\mapsto (q_{k+1}, p_{k+1})$ is defined by identifying the momentum $p_k$ with $p_k^-$ and then defining $p_{k+1}$ as $p_{k+1}^+$. This leads to the following system of equations that defines the map implicitly:\n$$p_k = -D_1 L_d(q_k, q_{k+1}, h)$$\n$$p_{k+1} = D_2 L_d(q_k, q_{k+1}, h)$$\nTo prove that this map is symplectic, we must show that it preserves the canonical symplectic $2$-form $\\omega = dq \\wedge dp$. In our discrete context, this means we must show that $dq_{k+1} \\wedge dp_{k+1} = dq_k \\wedge dp_k$.\n\nWe view $p_k$ and $p_{k+1}$ as functions of the independent coordinates $q_k$ and $q_{k+1}$. Taking the exterior derivative of the two defining equations gives:\n$$dp_k = -\\frac{\\partial}{\\partial q_k}(D_1 L_d) dq_k - \\frac{\\partial}{\\partial q_{k+1}}(D_1 L_d) dq_{k+1} = -D_{11} L_d dq_k - D_{12} L_d dq_{k+1}$$\n$$dp_{k+1} = \\frac{\\partial}{\\partial q_k}(D_2 L_d) dq_k + \\frac{\\partial}{\\partial q_{k+1}}(D_2 L_d) dq_{k+1} = D_{21} L_d dq_k + D_{22} L_d dq_{k+1}$$\nNow we compute the wedge products:\n$$dq_k \\wedge dp_k = dq_k \\wedge (-D_{11} L_d dq_k - D_{12} L_d dq_{k+1}) = -D_{12} L_d (dq_k \\wedge dq_{k+1})$$\n$$dq_{k+1} \\wedge dp_{k+1} = dq_{k+1} \\wedge (D_{21} L_d dq_k + D_{22} L_d dq_{k+1}) = D_{21} L_d (dq_{k+1} \\wedge dq_k) = -D_{21} L_d (dq_k \\wedge dq_{k+1})$$\nSince $V$ is smooth, $L_d$ is at least a $C^2$ function of its arguments. By Clairaut's theorem on the equality of mixed partials, $D_{12} L_d = D_{21} L_d$. Therefore, we have proven that:\n$$dq_k \\wedge dp_k = dq_{k+1} \\wedge dp_{k+1}$$\nThis confirms that the one-step map derived from any non-degenerate discrete Lagrangian of this form is symplectic. The non-degeneracy condition $D_{12}L_d \\neq 0$ is required to ensure the map is well-defined. For our $L_d$, $D_1 L_d(q_k, q_{k+1}, h) = -\\frac{m}{h}(q_{k+1}-q_k) - \\frac{h}{2}V'(q_k)$, so $D_{12}L_d = -\\frac{m}{h}$, which is non-zero as $m > 0$ and $h > 0$.\n\n_Part 4: Specialization to the Harmonic Oscillator_\n\nFor the simple harmonic oscillator, the potential is $V(q) = \\frac{1}{2} k q^2$, where $k > 0$. The derivative is $V'(q) = kq$.\nThe specific discrete Lagrangian is:\n$$L_d(q_k, q_{k+1}, h) = \\frac{m}{2h} (q_{k+1} - q_k)^2 - \\frac{h}{2} \\left(\\frac{1}{2}k q_k^2 + \\frac{1}{2}k q_{k+1}^2\\right) = \\frac{m}{2h}(q_{k+1} - q_k)^2 - \\frac{kh}{4}(q_k^2 + q_{k+1}^2)$$\nWe compute the partial derivatives $D_1L_d$ and $D_2L_d$:\n$$D_1 L_d = \\frac{m}{h}(q_k - q_{k+1}) - \\frac{kh}{2}q_k$$\n$$D_2 L_d = \\frac{m}{h}(q_{k+1} - q_k) - \\frac{kh}{2}q_{k+1}$$\nThe one-step map is defined by the system:\n$$p_k = -D_1 L_d = \\frac{m}{h}(q_{k+1} - q_k) + \\frac{kh}{2}q_k$$\n$$p_{k+1} = D_2 L_d = \\frac{m}{h}(q_{k+1} - q_k) - \\frac{kh}{2}q_{k+1}$$\nWe must solve this linear system for $q_{k+1}$ and $p_{k+1}$ as functions of $q_k$ and $p_k$.\nFrom the first equation, we solve for $q_{k+1}$:\n$$p_k - q_k\\left(\\frac{kh}{2} - \\frac{m}{h}\\right) = \\frac{m}{h}q_{k+1}$$\n$$q_{k+1} = \\frac{h}{m} p_k - q_k\\left(\\frac{kh^2}{2m} - 1\\right) = q_k\\left(1 - \\frac{kh^2}{2m}\\right) + \\frac{h}{m} p_k$$\nThis is the update rule for the position $q_{k+1}$.\nTo find $p_{k+1}$, we can subtract the second equation from the first:\n$$p_k - p_{k+1} = \\left(\\frac{kh}{2}q_k\\right) - \\left(-\\frac{kh}{2}q_{k+1}\\right) = \\frac{kh}{2}(q_k + q_{k+1})$$\n$$p_{k+1} = p_k - \\frac{kh}{2}(q_k + q_{k+1})$$\nNow, we substitute the expression found for $q_{k+1}$:\n$$p_{k+1} = p_k - \\frac{kh}{2}\\left[q_k + \\left(q_k\\left(1 - \\frac{kh^2}{2m}\\right) + \\frac{h}{m} p_k\\right)\\right]$$\n$$p_{k+1} = p_k - \\frac{kh}{2}\\left[q_k\\left(1 + 1 - \\frac{kh^2}{2m}\\right) + \\frac{h}{m} p_k\\right]$$\n$$p_{k+1} = p_k - \\frac{kh}{2}\\left[q_k\\left(2 - \\frac{kh^2}{2m}\\right) + \\frac{h}{m} p_k\\right]$$\n$$p_{k+1} = p_k - q_k kh\\left(1 - \\frac{kh^2}{4m}\\right) - p_k \\frac{kh^2}{2m}$$\n$$p_{k+1} = p_k\\left(1 - \\frac{kh^2}{2m}\\right) - kh\\left(1 - \\frac{kh^2}{4m}\\right)q_k$$\nThis is the update rule for the momentum $p_{k+1}$.\n\nThe resulting one-step map is given by the two expressions:\n$$q_{k+1} = q_k\\left(1 - \\frac{kh^2}{2m}\\right) + \\frac{h}{m}p_k$$\n$$p_{k+1} = p_k\\left(1 - \\frac{kh^2}{2m}\\right) - kh\\left(1 - \\frac{kh^2}{4m}\\right)q_k$$\nThese are the closed-form expressions for the update map.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nq_k\\left(1 - \\frac{kh^2}{2m}\\right) + \\frac{h}{m}p_k & p_k\\left(1 - \\frac{kh^2}{2m}\\right) - kh\\left(1 - \\frac{kh^2}{4m}\\right)q_k\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Real-world systems, from robotic arms to rotating rigid bodies, often have configurations that live on non-Euclidean spaces like Lie groups. This exercise challenges you to compare two common strategies for enforcing such constraints: a principled, constrained variational approach versus a more ad-hoc post-step projection method. Your analysis will reveal the profound consequences of these choices on the preservation of fundamental geometric properties like symplecticity and momentum maps, highlighting why a fully variational treatment is crucial for physically faithful simulations. ",
            "id": "3783920",
            "problem": "Consider a mechanical system with configuration manifold a finite-dimensional matrix Lie group $G \\subset \\mathbb{R}^{m \\times m}$ and a left-invariant Lagrangian $L: TG \\to \\mathbb{R}$ that depends on the left-trivialized velocity $\\xi \\in \\mathfrak{g}$. Let $h>0$ be a fixed time step. A discrete Lagrangian is a smooth function $L_{d}: G \\times G \\to \\mathbb{R}$ that approximates the exact discrete Lagrangian and is assumed to be left-invariant under the diagonal left action of $G$. Two strategies are used to enforce $g_{k} \\in G$ in a time-stepping scheme:\n\nStrategy I (constrained variational enforcement on $G$): The update $(g_{k-1}, g_{k}) \\mapsto (g_{k}, g_{k+1})$ is obtained by stationarity of the discrete action sum $\\sum_{k} L_{d}(g_{k}, g_{k+1})$ under variations that respect $g_{k} \\in G$, for example by using a retraction $\\tau: \\mathfrak{g} \\to G$ to parameterize increments or by imposing the constraint $g \\in G$ via Lagrange multipliers in the discrete variational principle. This produces a Lie Group Variational Integrator (LGVI).\n\nStrategy II (post-step projection onto $G$): A provisional update $\\tilde{g}_{k+1} \\in \\mathbb{R}^{m \\times m}$ is produced by an unconstrained step that does not enforce the condition $g \\in G$ (for example, by applying a variational method formulated in the ambient space and ignoring the manifold constraint), followed by a smooth projection $\\Pi: \\mathbb{R}^{m \\times m} \\to G$, yielding $\\hat{g}_{k+1} = \\Pi(\\tilde{g}_{k+1}) \\in G$. Suppose $\\Pi$ is the nearest-point projection with respect to a fixed inner product on $\\mathbb{R}^{m \\times m}$, and velocities or momenta are adjusted by minimal modification consistent with the projection.\n\nStarting from the discrete variational principle and its standard consequences in geometric mechanics, reason about the preservation of the symplectic structure and the conservation of momentum maps associated with left-invariance for each strategy. Then answer the following multiple-choice question. Which of the following statements are correct?\n\nA. Under Strategy I, the time-$h$ map is symplectic on $T^{*}G$ and exactly preserves the discrete momentum map associated with left-invariance; under Strategy II with a nearest-point post-step projection, both symplecticity and momentum conservation are generally lost.\n\nB. Both Strategy I and Strategy II produce symplectic maps provided the projection $\\Pi$ is orthogonal with respect to a bi-invariant metric on $G$, and when $L_{d}$ is left-invariant, both methods exactly preserve the corresponding momentum map.\n\nC. Strategy I preserves symplecticity but only approximates momentum conservation; Strategy II, if $\\Pi$ is equivariant under the left action, preserves the left momentum map exactly.\n\nD. A post-step projection method can be symplectic and momentum-preserving when the projection step arises as the stationarity condition of a discrete constrained variational principle on $G$ (so that the overall scheme remains variational); a generic nearest-point post-step projection that is not variational lacks these properties.\n\nSelect all that apply.",
            "solution": "The problem statement asks for an analysis of two different numerical integration strategies for a mechanical system on a Lie group $G$, based on the principles of geometric mechanics. We must assess their properties regarding symplecticity and conservation of momentum maps.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Configuration Manifold:** A finite-dimensional matrix Lie group $G \\subset \\mathbb{R}^{m \\times m}$.\n-   **Lie Algebra:** $\\mathfrak{g} = T_eG$.\n-   **Lagrangian:** A left-invariant Lagrangian $L: TG \\to \\mathbb{R}$, depending on the left-trivialized velocity $\\xi \\in \\mathfrak{g}$.\n-   **Time Step:** $h > 0$.\n-   **Discrete Lagrangian:** A smooth function $L_d: G \\times G \\to \\mathbb{R}$, which is left-invariant under the diagonal action: $L_d(a g_k, a g_{k+1}) = L_d(g_k, g_{k+1})$ for any $a \\in G$.\n-   **Strategy I (LGVI):** An update is derived from the stationarity of the discrete action $\\sum_k L_d(g_k, g_{k+1})$ with variations constrained to the manifold $G$.\n-   **Strategy II (Projection):** An unconstrained update in the ambient space $\\mathbb{R}^{m \\times m}$ yields $\\tilde{g}_{k+1}$, which is then projected onto the manifold: $\\hat{g}_{k+1} = \\Pi(\\tilde{g}_{k+1})$, where $\\Pi$ is a nearest-point projection.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined and scientifically grounded within the field of geometric numerical integration and mechanics on Lie groups.\n-   **Scientifically Grounded:** The concepts of Lie group variational integrators (LGVI), projection methods, symplecticity, and momentum maps are standard and rigorously defined in geometric mechanics.\n-   **Well-Posed:** The problem sets up two distinct, standard numerical approaches and asks for a comparison of their fundamental geometric properties. The question is precise and has a definite answer based on established theory.\n-   **Objective:** The problem is formulated in the objective language of mathematics and theoretical mechanics.\n-   **Completeness:** The information provided is sufficient to deduce the properties in question. The left-invariance of $L_d$ is the crucial symmetry, and the definitions of the two strategies are clear enough to distinguish their variational nature.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. We may proceed to the solution.\n\n### Derivation and Analysis\n\nThe core principles of discrete variational mechanics are as follows:\n1.  **Discrete Euler-Lagrange (DEL) Equations:** For a discrete Lagrangian $L_d(g_k, g_{k+1})$, the dynamics are governed by the stationarity of the action sum $S_d = \\sum_k L_d(g_k, g_{k+1})$. This yields the DEL equations for each free variation $\\delta g_k$:\n    $$ D_1 L_d(g_k, g_{k+1}) + D_2 L_d(g_{k-1}, g_k) = 0 $$\n    where $D_1$ and $D_2$ denote the derivatives with respect to the first and second arguments, respectively.\n2.  **Symplecticity:** A numerical integrator derived from such a variational principle is inherently symplectic. The discrete Legendre transforms define momenta as $p_k = -D_1 L_d(g_k, g_{k+1})$ and $p_{k+1} = D_2 L_d(g_k, g_{k+1})$. The resulting one-step map $\\Phi_h: (g_k, p_k) \\mapsto (g_{k+1}, p_{k+1})$ preserves the canonical symplectic 2-form on the cotangent bundle $T^*G$.\n3.  **Discrete Noether's Theorem:** If the discrete Lagrangian $L_d$ is invariant under the action of a Lie group $H$, then the integrator exactly conserves an associated discrete momentum map $J_d: T^*G \\to \\mathfrak{h}^*$, where $\\mathfrak{h}$ is the Lie algebra of $H$.\n\n#### Analysis of Strategy I (Lie Group Variational Integrator)\nStrategy I is, by its very definition, a discrete variational principle on the manifold $G$. The update equations are precisely the DEL equations restricted to $G$.\n-   **Symplecticity:** As a direct consequence of its variational formulation (Principle 2), the resulting integrator map is symplectic on the cotangent bundle $T^*G$.\n-   **Momentum Conservation:** The problem states that $L_d$ is left-invariant under the diagonal action of $G$. By the discrete Noether's theorem (Principle 3), the corresponding momentum map associated with this left symmetry is exactly conserved by the integrator.\n\nThus, Strategy I yields a symplectic and momentum-preserving integrator.\n\n#### Analysis of Strategy II (Post-step Projection)\nStrategy II is a splitting method, composing an unconstrained update with a projection.\n1.  **Unconstrained Step:** A variational integrator is applied in the ambient Euclidean space $\\mathbb{R}^{m \\times m}$, producing $\\tilde{g}_{k+1}$. This step, considered in isolation, defines a symplectic map on $T^*(\\mathbb{R}^{m \\times m})$.\n2.  **Projection Step:** The configuration $\\tilde{g}_{k+1}$ and its corresponding momentum are non-canonically mapped to a state on $T^*G$. The map is $\\hat{g}_{k+1} = \\Pi(\\tilde{g}_{k+1})$. The projection $\\Pi$ onto the manifold $G$ is generally not a canonical transformation.\n-   **Symplecticity:** The overall map is a composition of a symplectic map (the unconstrained step) and a non-symplectic map (the projection and momentum adjustment). Such a composition is, in general, not symplectic. The projection step typically introduces numerical dissipation or artifacts that violate the preservation of the symplectic form.\n-   **Momentum Conservation:** The left-invariance of the original problem is a property of the group $G$. An unconstrained integrator on $\\mathbb{R}^{m \\times m}$ does not see this symmetry. The projection step $\\Pi$, defined as a nearest-point projection with respect to a fixed inner product on $\\mathbb{R}^{m \\times m}$, is not, in general, equivariant with respect to the left action of $G$. That is, $\\Pi(a g) \\neq a \\Pi(g)$ for a generic $a \\in G$ and $g \\in \\mathbb{R}^{m \\times m}$. Because the algorithm step (the projection) does not respect the symmetry of the system, the corresponding momentum map will not be conserved.\n\nThus, Strategy II generally fails to be either symplectic or momentum-preserving.\n\n### Option-by-Option Analysis\n\n**A. Under Strategy I, the time-$h$ map is symplectic on $T^{*}G$ and exactly preserves the discrete momentum map associated with left-invariance; under Strategy II with a nearest-point post-step projection, both symplecticity and momentum conservation are generally lost.**\nThis statement is a direct and accurate summary of our analysis. Strategy I is a variational integrator on the Lie group, so it inherits the geometric properties of symplecticity and, due to the symmetry of $L_d$, exact momentum conservation. Strategy II involves a non-canonical projection step that generally breaks both properties.\n**Verdict: Correct.**\n\n**B. Both Strategy I and Strategy II produce symplectic maps provided the projection $\\Pi$ is orthogonal with respect to a bi-invariant metric on $G$, and when $L_d$ is left-invariant, both methods exactly preserve the corresponding momentum map.**\nThis statement is incorrect. Strategy II is not symplectic, regardless of the nature of the projection. A projection, by its nature, is not a full-fledged canonical transformation. Furthermore, even if $\\Pi$ were equivariant (which is a different condition than being orthogonal with respect to a bi-invariant metric), which could lead to momentum preservation, this would not salvage symplecticity. The claim that *both* methods are symplectic and momentum-preserving is false.\n**Verdict: Incorrect.**\n\n**C. Strategy I preserves symplecticity but only approximates momentum conservation; Strategy II, if $\\Pi$ is equivariant under the left action, preserves the left momentum map exactly.**\nThe first part of this statement is fundamentally flawed. A key result of discrete mechanics (Noether's theorem) is that a symmetry of the discrete Lagrangian leads to *exact* conservation of the corresponding discrete momentum map. Strategy I does not merely approximate momentum conservation; it conserves it exactly.\n**Verdict: Incorrect.**\n\n**D. A post-step projection method can be symplectic and momentum-preserving when the projection step arises as the stationarity condition of a discrete constrained variational principle on $G$ (so that the overall scheme remains variational); a generic nearest-point post-step projection that is not variational lacks these properties.**\nThis statement provides a deeper insight into the distinction. It correctly identifies the *variational origin* as the crucial feature for structure preservation.\n- The first clause describes methods like SHAKE or RATTLE, where constraints are enforced via Lagrange multipliers within a single variational principle. While these can be viewed as involving a \"projection\" in a loose sense (forcing the solution onto the constraint manifold), their mathematical structure is that of a constrained variational problem. They are, in essence, a form of Strategy I. As such, they are symplectic and momentum-preserving.\n- The second clause correctly describes Strategy II as a \"generic nearest-point post-step projection that is not variational\" and correctly states that it lacks these geometric properties.\nThe statement correctly distinguishes between methods that are truly variational (and thus structure-preserving) and those that are not.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "A key challenge in numerical simulation is adapting the time step to capture complex dynamics efficiently without sacrificing the long-term stability guaranteed by geometric structure. This problem explores an elegant solution within the variational framework: treating time itself as a configuration variable. By applying the principle of stationary action to an extended configuration-time space, you will discover how to derive variable-step integrators that are symplectic in an extended phase space and naturally include an equation for discrete energy conservation. ",
            "id": "3738672",
            "problem": "Consider an autonomous mechanical system on a configuration manifold $Q$ with continuous Lagrangian $L(q,\\dot{q})$ and Hamilton's variational principle $\\delta \\int_{t_0}^{t_1} L(q,\\dot{q}) \\,\\mathrm{d}t = 0$. To construct a variable-step Variational Integrator (VI), treat time as an additional configuration variable, i.e., work on the extended configuration-time manifold $Q \\times \\mathbb{R}$ and define $t_k \\in \\mathbb{R}$ with $h_k = t_{k+1} - t_k$. A Discrete Lagrangian (DL) is a function $L_d(q_k,q_{k+1},h_k)$ that approximates the action over the interval $[t_k,t_{k+1}]$, and the discrete action is $S_d = \\sum_{k} L_d(q_k,q_{k+1},h_k)$.\n\nYou intend to adapt the step sizes $h_k$ to control local error without sacrificing symplecticity. The adaptation should be decided together with the state update from a principled base, not added as an external afterthought. Starting from the fundamental variational principle on $Q \\times \\mathbb{R}$, and using only definitions and standard facts from geometric mechanics, derive the stationarity conditions with respect to $q_k$ and $t_k$ and explain how they encode both the Discrete Euler-Lagrange (DEL) equations and a discrete energy relation. Then, select the option that correctly describes a construction of a variable-step VI that maintains symplecticity while controlling local error, stating precisely what quantities are varied, what equations must be solved at each step, and why the resulting update is symplectic in the extended phase space.\n\nWhich option is correct?\n\nA. Construct $L_d(q_k,q_{k+1},h_k)$ from a consistent quadrature of $\\int_{t_k}^{t_{k+1}} L(q,\\dot{q}) \\,\\mathrm{d}t$, and form the augmented discrete action $S_d^\\mathrm{aug} = \\sum_k \\big( L_d(q_k,q_{k+1},h_k) + \\lambda_k \\, g(q_k,q_{k+1},h_k) \\big)$, where $g(q_k,q_{k+1},h_k) = 0$ encodes a chosen local error target and $\\lambda_k$ is a Lagrange multiplier. Impose stationarity with respect to $q_k$, $t_k$ (equivalently $h_k$), and $\\lambda_k$, to obtain the DEL equations, a discrete energy relation, and the error-control constraint simultaneously. This yields a constrained variational update on $Q \\times \\mathbb{R}$ whose discrete flow is symplectic on the extended phase space (with conjugate momentum to time equal to the discrete energy), by the same reasoning that proves symplecticity of constrained variational integrators.\n\nB. Use a fixed-step DL $L_d(q_k,q_{k+1},h)$ and, at each step, adjust $h_k$ externally until a heuristic local error estimate falls below a tolerance, then compute $q_{k+1}$ by solving the DEL equations with that $h_k$. Since the DEL equations hold at each step, the update is symplectic and the adaptation does not affect the preservation of the symplectic form.\n\nC. Advance with any DL and then rescale the momenta as $p_{k+1} \\leftarrow \\alpha \\, p_{k+1}$ to enforce $H(q_{k+1},p_{k+1}) = H(q_k,p_k)$, where $H$ is the Hamiltonian and $\\alpha$ is chosen to achieve energy conservation. This projection maintains symplecticity while providing error control through exact energy conservation.\n\nD. Introduce a reparametrization by a fictitious time $s$ with a monitor function $\\rho(q,p)$ and set $\\mathrm{d}t/\\mathrm{d}s = \\rho(q,p)$. Discretize the reparametrized Lagrangian $L^\\star(q,\\dot{q}/\\rho) \\, \\rho$ with a standard VI in $s$ and update $\\rho$ between steps using a running local error estimator. Symplecticity in the original variables $(q,p)$ is guaranteed regardless of how $\\rho$ is updated, because reparametrization preserves the variational structure.",
            "solution": "The problem asks for the derivation of the equations for a variable-step variational integrator from a fundamental variational principle on an extended configuration-time manifold, and to identify the correct description of such a method among the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   System: Autonomous mechanical system.\n-   Configuration manifold: $Q$.\n-   Continuous Lagrangian: $L(q, \\dot{q})$.\n-   Variational Principle: $\\delta \\int_{t_0}^{t_1} L(q,\\dot{q}) \\,\\mathrm{d}t = 0$.\n-   Extended configuration-time manifold: $Q \\times \\mathbb{R}$.\n-   Discrete time steps: $t_k \\in \\mathbb{R}$, with step size $h_k = t_{k+1} - t_k$.\n-   Discrete Lagrangian (DL): A function $L_d(q_k, q_{k+1}, h_k)$ that approximates the action integral $\\int_{t_k}^{t_{k+1}} L(q,\\dot{q}) \\,\\mathrm{d}t$.\n-   Discrete Action: $S_d = \\sum_{k} L_d(q_k, q_{k+1}, h_k)$.\n-   Task: Derive stationarity conditions with respect to $q_k$ and $t_k$. Explain how they yield the Discrete Euler-Lagrange (DEL) equations and a discrete energy relation. Select the option that correctly describes a symplectic, adaptive-step VI.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically sound, well-posed, and objective. It is based on established principles of geometric mechanics and the theory of variational integrators. The idea of treating time as a configuration variable to derive variable-step methods is a standard and advanced topic in this field. The problem is self-contained and free from contradictions or ambiguities. It poses a non-trivial question requiring a firm grasp of variational principles.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. We may proceed with the solution.\n\n### Derivation from First Principles\n\nThe core of the method is to apply Hamilton's principle of stationary action to the discrete action sum on the extended configuration-time manifold. The discrete path is given by the sequence of points $\\{(q_k, t_k)\\}_{k=0}^N$. The discrete action is a function of this entire sequence:\n$$\nS_d( \\{q_k\\}_{k=0}^N, \\{t_k\\}_{k=0}^N ) = \\sum_{k=0}^{N-1} L_d(q_k, q_{k+1}, t_{k+1} - t_k)\n$$\nThe variational principle requires that the action is stationary with respect to variations of the interior points of the path. That is, $\\delta S_d = 0$ for variations $\\delta q_k$ and $\\delta t_k$ where $k \\in \\{1, \\dots, N-1\\}$, assuming fixed endpoints: $\\delta q_0 = \\delta q_N = 0$ and $\\delta t_0 = \\delta t_N = 0$.\n\nLet's compute the variation of the action:\n$$\n\\delta S_d = \\delta \\sum_{k=0}^{N-1} L_d(q_k, q_{k+1}, t_{k+1} - t_k) = \\sum_{k=0}^{N-1} \\delta L_d(q_k, q_{k+1}, t_{k+1} - t_k)\n$$\nUsing the chain rule, and denoting $h_k = t_{k+1} - t_k$:\n$$\n\\delta S_d = \\sum_{k=0}^{N-1} \\left( D_1 L_d(k) \\cdot \\delta q_k + D_2 L_d(k) \\cdot \\delta q_{k+1} + D_3 L_d(k) (\\delta t_{k+1} - \\delta t_k) \\right)\n$$\nwhere $D_i L_d(k)$ denotes the partial derivative of $L_d(q_k, q_{k+1}, h_k)$ with respect to its $i$-th argument.\n\nWe re-index the summation to collect terms multiplying $\\delta q_k$ and $\\delta t_k$.\nFor the variations $\\delta q_k$:\n$$\n\\sum_{k=0}^{N-1} D_1 L_d(k) \\cdot \\delta q_k + \\sum_{k=0}^{N-1} D_2 L_d(k) \\cdot \\delta q_{k+1}\n$$\nChanging the index of the second sum from $k$ to $j-1$ (so $j = k+1$), we get $\\sum_{j=1}^{N} D_2 L_d(j-1) \\cdot \\delta q_j$. Combining terms for $k=1, \\dots, N-1$ (since $\\delta q_0=\\delta q_N=0$):\n$$\n\\sum_{k=1}^{N-1} \\left( D_1 L_d(k) + D_2 L_d(k-1) \\right) \\cdot \\delta q_k\n$$\nSetting the coefficient of each independent variation $\\delta q_k$ to zero gives the **Discrete Euler-Lagrange (DEL) equations**:\n$$\nD_1 L_d(q_k, q_{k+1}, h_k) + D_2 L_d(q_{k-1}, q_k, h_{k-1}) = 0 \\quad \\text{for } k=1, \\dots, N-1\n$$\n\nFor the variations $\\delta t_k$:\n$$\n\\sum_{k=0}^{N-1} D_3 L_d(k) (\\delta t_{k+1} - \\delta t_k) = \\sum_{k=0}^{N-1} D_3 L_d(k) \\delta t_{k+1} - \\sum_{k=0}^{N-1} D_3 L_d(k) \\delta t_k\n$$\nRe-indexing the first sum ($j=k+1$) gives $\\sum_{j=1}^{N} D_3 L_d(j-1) \\delta t_j$. Combining terms for $k=1, \\dots, N-1$ (since $\\delta t_0=\\delta t_N=0$):\n$$\n\\sum_{k=1}^{N-1} \\left( D_3 L_d(k-1) - D_3 L_d(k) \\right) \\delta t_k\n$$\nSetting the coefficient of each independent variation $\\delta t_k$ to zero yields:\n$$\nD_3 L_d(q_{k-1}, q_k, h_{k-1}) - D_3 L_d(q_k, q_{k+1}, h_k) = 0\n$$\nThis can be rewritten as a conservation law. Let's define the discrete energy as $E_{d,k} = -D_3 L_d(q_k, q_{k+1}, h_k) = -\\frac{\\partial L_d}{\\partial h_k}(q_k, q_{k+1}, h_k)$. The equation then becomes $E_{d,k-1} = E_{d,k}$. This is the **discrete energy relation**, which expresses the conservation of the discrete quantity $E_d$ along the numerical trajectory. This $E_d$ is the discrete analogue of the system's energy (Hamiltonian), which arises as the conserved quantity associated with time-translation invariance (Noether's theorem).\n\nThe update map from step $k-1$ to step $k$ is determined by the system of equations for the unknowns $q_{k+1}$ and $h_k$:\n1.  $D_1 L_d(q_k, q_{k+1}, h_k) + D_2 L_d(q_{k-1}, q_k, h_{k-1}) = 0$\n2.  $-D_3 L_d(q_k, q_{k+1}, h_k) = E_{d,k-1}$\n\nThis system must be solved simultaneously for $q_{k+1}$ and $h_k$. However, this only guarantees energy conservation; it does not explicitly control local error to a target tolerance.\n\n### Option-by-Option Analysis\n\n**A. Construct $L_d(q_k,q_{k+1},h_k)$ from a consistent quadrature of $\\int_{t_k}^{t_{k+1}} L(q,\\dot{q}) \\,\\mathrm{d}t$, and form the augmented discrete action $S_d^\\mathrm{aug} = \\sum_k \\big( L_d(q_k,q_{k+1},h_k) + \\lambda_k \\, g(q_k,q_{k+1},h_k) \\big)$, where $g(q_k,q_{k+1},h_k) = 0$ encodes a chosen local error target and $\\lambda_k$ is a Lagrange multiplier. Impose stationarity with respect to $q_k$, $t_k$ (equivalently $h_k$), and $\\lambda_k$, to obtain the DEL equations, a discrete energy relation, and the error-control constraint simultaneously. This yields a constrained variational update on $Q \\times \\mathbb{R}$ whose discrete flow is symplectic on the extended phase space (with conjugate momentum to time equal to the discrete energy), by the same reasoning that proves symplecticity of constrained variational integrators.**\n\nThis option describes a highly principled approach. By incorporating the error-control condition $g=0$ into the variational principle via a Lagrange multiplier $\\lambda_k$, the entire set of update equations for $q_{k+1}$, $t_{k+1}$ (or $h_k$), and $\\lambda_k$ is derived from a single stationarity condition $\\delta S_d^\\mathrm{aug}=0$. This is the framework of constrained variational integrators (like RATTLE). It is known that such integrators produce a flow that is symplectic, albeit on the constrained submanifold of the phase space. Here, the \"phase space\" is the extended one, $T^*(Q \\times \\mathbb{R})$, with coordinates $(q,p,t,E)$. The \"constraint\" $g=0$ serves to determine the step size $h_k$ such that a local error measure is met. The statement that this is symplectic by the same reasoning as other constrained VIs is correct. The statement that the conjugate momentum to time is the discrete energy is also correct, as shown in our derivation ($E_d = -D_3 L_d$). This is the most sophisticated and geometrically correct method among the choices.\n\nVerdict: **Correct**.\n\n**B. Use a fixed-step DL $L_d(q_k,q_{k+1},h)$ and, at each step, adjust $h_k$ externally until a heuristic local error estimate falls below a tolerance, then compute $q_{k+1}$ by solving the DEL equations with that $h_k$. Since the DEL equations hold at each step, the update is symplectic and the adaptation does not affect the preservation of the symplectic form.**\n\nThis option describes an *ad hoc* procedure where the step size selection is an external process, an \"afterthought.\" While the map $(q_k, p_k) \\mapsto (q_{k+1}, p_{k+1})$ for a *fixed* $h_k$ is symplectic, the overall algorithm, which includes the non-variational step of choosing $h_k$, is not derived from a single variational principle. Such methods generally fail to preserve the geometric structures (like the symplectic form in the extended phase space or the discrete energy) that are the hallmark of variational integrators. The claim that \"the adaptation does not affect the preservation of the symplectic form\" is false; the composition of the state-dependent step-selection map and the symplectic update map is not, in general, symplectic. This approach violates the problem's requirement that the adaptation be decided \"from a principled base, not added as an external afterthought.\"\n\nVerdict: **Incorrect**.\n\n**C. Advance with any DL and then rescale the momenta as $p_{k+1} \\leftarrow \\alpha \\, p_{k+1}$ to enforce $H(q_{k+1},p_{k+1}) = H(q_k,p_k)$, where $H$ is the Hamiltonian and $\\alpha$ is chosen to achieve energy conservation. This projection maintains symplecticity while providing error control through exact energy conservation.**\n\nThis describes a projection method. The first step is a standard VI update, which is symplectic. The second step is a projection $p_{k+1} \\mapsto \\alpha p_{k+1}$ onto an energy level set. This projection, unless $\\alpha=1$ (i.e., no change), is generally not a symplectic map. It fails to preserve the canonical two-form $\\mathrm{d}q \\wedge \\mathrm{d}p$. Therefore, the overall one-step map is not symplectic. The claim that this method \"maintains symplecticity\" is false. While it can enforce exact energy conservation, it does so at the cost of sacrificing symplecticity.\n\nVerdict: **Incorrect**.\n\n**D. Introduce a reparametrization by a fictitious time $s$ with a monitor function $\\rho(q,p)$ and set $\\mathrm{d}t/\\mathrm{d}s = \\rho(q,p)$. Discretize the reparametrized Lagrangian $L^\\star(q,\\dot{q}/\\rho) \\, \\rho$ with a standard VI in $s$ and update $\\rho$ between steps using a running local error estimator. Symplecticity in the original variables $(q,p)$ is guaranteed regardless of how $\\rho$ is updated, because reparametrization preserves the variational structure.**\n\nThis method, known as time reparametrization, is a valid approach in principle. However, it has two major flaws as described. First, the monitor function $\\rho$ is stated to depend on momentum, $\\rho(q,p)$. A Lagrangian $L$ is a function on the tangent bundle $TQ$, i.e., $L(q, \\dot{q})$, not the phase space $T^*Q$. Introducing momentum dependence directly into a Lagrangian is non-standard and complicates the variational framework. Second, and more critically, it suggests updating $\\rho$ \"between steps\" using an error estimator. This is another form of *ad hoc* external adjustment, similar to Option B. The claim that \"Symplecticity ... is guaranteed regardless of how $\\rho$ is updated\" is false. If $\\rho$ is updated in a non-variational way, the geometric structure is lost. For the method to be symplectic, the dynamics of $\\rho$ itself must be part of the variational principle.\n\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}