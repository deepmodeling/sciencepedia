{
    "hands_on_practices": [
        {
            "introduction": "To appreciate the design of numerical integrators, we must first master the properties of the exact systems they aim to approximate. This exercise  uses the simple harmonic oscillator as a fundamental model to explore the structure of Hamiltonian dynamics. You will derive the exact symplectic flow from first principles and identify its key invariants, then contrast this with the discrete map generated by a basic Symplectic Partitioned Runge-Kutta (SPRK) method, revealing how these integrators are constructed to respect the underlying geometry of the phase space.",
            "id": "3769897",
            "problem": "Consider the canonical one-degree-of-freedom Hamiltonian system with Hamiltonian $H(q,p)=\\frac{1}{2}(\\omega^{2} q^{2}+p^{2})$, where $\\omega>0$ is a fixed parameter. The canonical equations of motion are given by Hamilton's equations, and the exact flow is defined by the time-$h$ map of these equations acting on an initial condition $(q(0),p(0))=(q_{0},p_{0})$. Work from first principles in geometric mechanics and symplectic methods to do the following:\n\n1. Starting from Hamilton's equations and the canonical symplectic structure, derive the exact time-$h$ solution $(q(h),p(h))$ in terms of $(q_{0},p_{0},\\omega,h)$ without invoking any pre-packaged solution formulae. Your derivation must explicitly exploit the linear structure of the vector field and the symplectic geometry of the phase space.\n\n2. Using the definition of a symplectic diffeomorphism and the canonical symplectic two-form, identify and justify symplectic invariants preserved by the exact flow for this system. Your identification must be derived from the fundamental properties of Hamiltonian flows and must address both a geometric invariant and a dynamical invariant.\n\n3. Now consider applying a one-stage Symplectic Partitioned Runge-Kutta (SPRK) method to this separable Hamiltonian, with partition given by $T(p)=\\frac{1}{2}p^{2}$ and $V(q)=\\frac{1}{2}\\omega^{2}q^{2}$. The method has equal stage weights $a=\\frac{1}{2}$ in the $p$-update and $b=\\frac{1}{2}$ in the $q$-update (this is the implicit midpoint method in partitioned form). Derive, from the defining equations of a partitioned Runge-Kutta method, the linear one-step map for $(q_{n},p_{n})\\mapsto(q_{n+1},p_{n+1})$ and explain why it is symplectic. Then, identify a quadratic invariant that this discrete map preserves and justify why it is preserved for this system.\n\nProvide full reasoning starting from the base definitions listed above, with no shortcuts. Express the final answer as the exact analytical expression for the time-$h$ map $(q(h),p(h))$ in terms of $(q_{0},p_{0},\\omega,h)$, written as a row matrix. No numerical approximation is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It is based on fundamental principles of classical Hamiltonian mechanics, symplectic geometry, and geometric numerical integration. All necessary data and definitions are provided. The problem is therefore deemed valid and a solution will be provided.\n\nThe solution is structured in three parts as requested by the problem statement.\n\n### Part 1: Derivation of the Exact Time-$h$ Solution\n\nThe system is described by the Hamiltonian $H(q,p) = \\frac{1}{2}(\\omega^2 q^2 + p^2)$. Hamilton's canonical equations of motion are given by:\n$$\n\\dot{q} = \\frac{\\partial H}{\\partial p} \\\\\n\\dot{p} = -\\frac{\\partial H}{\\partial q}\n$$\nFor the given Hamiltonian, the partial derivatives are:\n$$\n\\frac{\\partial H}{\\partial p} = p \\\\\n\\frac{\\partial H}{\\partial q} = \\omega^2 q\n$$\nSubstituting these into Hamilton's equations yields the following system of linear ordinary differential equations:\n$$\n\\dot{q} = p \\\\\n\\dot{p} = -\\omega^2 q\n$$\nLet the state vector be $\\mathbf{z}(t) = \\begin{pmatrix} q(t) \\\\ p(t) \\end{pmatrix}$. The system can be written in matrix form as $\\dot{\\mathbf{z}} = \\mathbf{A}\\mathbf{z}$, where the matrix $\\mathbf{A}$ is:\n$$\n\\mathbf{A} = \\begin{pmatrix} 0 & 1 \\\\ -\\omega^2 & 0 \\end{pmatrix}\n$$\nThis matrix represents the Hamiltonian vector field $X_H = \\mathbf{J}\\nabla H$, where $\\mathbf{J} = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$ is the canonical symplectic matrix and $\\nabla H = \\begin{pmatrix} \\partial H/\\partial q \\\\ \\partial H/\\partial p \\end{pmatrix}$.\n\nThe solution to this linear system with initial condition $\\mathbf{z}(0) = \\mathbf{z}_0 = \\begin{pmatrix} q_0 \\\\ p_0 \\end{pmatrix}$ is given by the action of the matrix exponential:\n$$\n\\mathbf{z}(h) = \\exp(h\\mathbf{A})\\mathbf{z}_0\n$$\nTo compute the matrix exponential $\\exp(h\\mathbf{A})$, we first compute powers of $\\mathbf{A}$:\n$$\n\\mathbf{A}^2 = \\begin{pmatrix} 0 & 1 \\\\ -\\omega^2 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -\\omega^2 & 0 \\end{pmatrix} = \\begin{pmatrix} -\\omega^2 & 0 \\\\ 0 & -\\omega^2 \\end{pmatrix} = -\\omega^2 \\mathbf{I}\n$$\nwhere $\\mathbf{I}$ is the $2 \\times 2$ identity matrix. From this, we find $\\mathbf{A}^3 = -\\omega^2\\mathbf{A}$, $\\mathbf{A}^4 = \\omega^4\\mathbf{I}$, and so on.\n\nUsing the Taylor series definition of the matrix exponential:\n$$\n\\exp(h\\mathbf{A}) = \\sum_{k=0}^{\\infty} \\frac{(h\\mathbf{A})^k}{k!} = \\mathbf{I} + h\\mathbf{A} + \\frac{h^2\\mathbf{A}^2}{2!} + \\frac{h^3\\mathbf{A}^3}{3!} + \\dots\n$$\nWe can group the terms with $\\mathbf{I}$ and $\\mathbf{A}$:\n$$\n\\exp(h\\mathbf{A}) = \\left(\\mathbf{I} - \\frac{h^2\\omega^2}{2!}\\mathbf{I} + \\frac{h^4\\omega^4}{4!}\\mathbf{I} - \\dots \\right) + \\left(h\\mathbf{A} - \\frac{h^3\\omega^2}{3!}\\mathbf{A} + \\frac{h^5\\omega^4}{5!}\\mathbf{A} - \\dots \\right)\n$$\nFactoring out the matrices and arranging the terms:\n$$\n\\exp(h\\mathbf{A}) = \\left(1 - \\frac{(\\omega h)^2}{2!} + \\frac{(\\omega h)^4}{4!} - \\dots \\right)\\mathbf{I} + \\frac{1}{\\omega}\\left(\\omega h - \\frac{(\\omega h)^3}{3!} + \\frac{(\\omega h)^5}{5!} - \\dots \\right)\\mathbf{A}\n$$\nRecognizing the Taylor series for $\\cos(\\omega h)$ and $\\sin(\\omega h)$:\n$$\n\\exp(h\\mathbf{A}) = \\cos(\\omega h)\\mathbf{I} + \\frac{\\sin(\\omega h)}{\\omega}\\mathbf{A}\n$$\nSubstituting the matrices $\\mathbf{I}$ and $\\mathbf{A}$:\n$$\n\\exp(h\\mathbf{A}) = \\cos(\\omega h)\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\frac{\\sin(\\omega h)}{\\omega}\\begin{pmatrix} 0 & 1 \\\\ -\\omega^2 & 0 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\omega h) & \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h) & \\cos(\\omega h) \\end{pmatrix}\n$$\nThe time-$h$ map is thus a linear transformation represented by this matrix. Applying it to the initial condition $(q_0, p_0)$:\n$$\n\\begin{pmatrix} q(h) \\\\ p(h) \\end{pmatrix} = \\begin{pmatrix} \\cos(\\omega h) & \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h) & \\cos(\\omega h) \\end{pmatrix} \\begin{pmatrix} q_0 \\\\ p_0 \\end{pmatrix}\n$$\nThis gives the explicit solution:\n$$\nq(h) = q_0 \\cos(\\omega h) + \\frac{p_0}{\\omega} \\sin(\\omega h) \\\\\np(h) = -q_0 \\omega \\sin(\\omega h) + p_0 \\cos(\\omega h)\n$$\n\n### Part 2: Invariants of the Exact Flow\n\nA fundamental property of the flow $\\Phi_t$ generated by a Hamiltonian vector field is that it is a family of **symplectomorphisms**. A map $\\Phi$ on a phase space is a symplectomorphism if it preserves the symplectic two-form, $\\Omega$. For a canonical $1$-degree-of-freedom system, the symplectic form is $\\Omega = dq \\wedge dp$. Preservation means that the pullback of the form by the map is the form itself, i.e., $\\Phi_h^* \\Omega = \\Omega$.\n\n1.  **Geometric Invariant**: The geometric invariant is the symplectic two-form $\\Omega = dq \\wedge dp$ itself. In matrix mechanics, this preservation is expressed by the condition that the Jacobian of the flow map, $\\mathbf{M} = D\\Phi_h$, must be a symplectic matrix. A matrix $\\mathbf{M}$ is symplectic if it satisfies $\\mathbf{M}^T \\mathbf{J} \\mathbf{M} = \\mathbf{J}$, where $\\mathbf{J} = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$. Since our flow map is linear, its Jacobian is the matrix $\\exp(h\\mathbf{A})$ derived in Part 1. Let's verify it is symplectic:\n    $$\n    \\mathbf{M} = \\begin{pmatrix} \\cos(\\omega h) & \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h) & \\cos(\\omega h) \\end{pmatrix}\n    $$\n    $$\n    \\mathbf{M}^T\\mathbf{J}\\mathbf{M} = \\begin{pmatrix} \\cos(\\omega h) & -\\omega\\sin(\\omega h) \\\\ \\frac{\\sin(\\omega h)}{\\omega} & \\cos(\\omega h) \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} \\begin{pmatrix} \\cos(\\omega h) & \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h) & \\cos(\\omega h) \\end{pmatrix}\n    $$\n    $$\n    = \\begin{pmatrix} \\omega\\sin(\\omega h) & \\cos(\\omega h) \\\\ -\\cos(\\omega h) & \\frac{\\sin(\\omega h)}{\\omega} \\end{pmatrix} \\begin{pmatrix} \\cos(\\omega h) & \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h) & \\cos(\\omega h) \\end{pmatrix}\n    $$\n    $$\n    = \\begin{pmatrix} \\omega\\sin(\\omega h)\\cos(\\omega h) - \\omega\\cos(\\omega h)\\sin(\\omega h) & \\sin^2(\\omega h) + \\cos^2(\\omega h) \\\\ -\\cos^2(\\omega h) - \\sin^2(\\omega h) & -\\sin(\\omega h)\\cos(\\omega h) + \\sin(\\omega h)\\cos(\\omega h) \\end{pmatrix}\n    = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} = \\mathbf{J}\n    $$\n    The condition is satisfied. The preservation of $dq \\wedge dp$ implies, by Stokes' theorem, the preservation of oriented areas in the phase space (Liouville's Theorem).\n\n2.  **Dynamical Invariant**: For any autonomous Hamiltonian system, the Hamiltonian function $H$ itself is a constant of motion, or a dynamical invariant. This can be shown from first principles by taking the total time derivative of $H$ along a trajectory $(q(t), p(t))$:\n    $$\n    \\frac{dH}{dt} = \\frac{\\partial H}{\\partial q}\\dot{q} + \\frac{\\partial H}{\\partial p}\\dot{p}\n    $$\n    Substituting Hamilton's equations, $\\dot{q} = \\partial H / \\partial p$ and $\\dot{p} = -\\partial H / \\partial q$:\n    $$\n    \\frac{dH}{dt} = \\frac{\\partial H}{\\partial q}\\left(\\frac{\\partial H}{\\partial p}\\right) + \\frac{\\partial H}{\\partial p}\\left(-\\frac{\\partial H}{\\partial q}\\right) = \\frac{\\partial H}{\\partial q}\\frac{\\partial H}{\\partial p} - \\frac{\\partial H}{\\partial p}\\frac{\\partial H}{\\partial q} = 0\n    $$\n    Since its time derivative is zero, $H(q(t),p(t))$ is constant along any solution trajectory. For this system, the dynamical invariant is the energy, $H(q,p) = \\frac{1}{2}(\\omega^2 q^2 + p^2)$.\n\n### Part 3: Analysis of the SPRK Method\n\nThe problem describes a partitioned method for the separable Hamiltonian $H(q,p) = T(p) + V(q)$, where $T(p) = \\frac{1}{2}p^2$ and $V(q)=\\frac{1}{2}\\omega^2 q^2$. The method is identified as the implicit midpoint method in partitioned form. This method is defined by:\n$$\nq_{n+1} = q_n + h \\frac{\\partial T}{\\partial p}\\left(\\frac{p_n+p_{n+1}}{2}\\right) \\\\\np_{n+1} = p_n - h \\frac{\\partial V}{\\partial q}\\left(\\frac{q_n+q_{n+1}}{2}\\right)\n$$\nSubstituting the specific forms of $T(p)$ and $V(q)$:\n$$\nq_{n+1} = q_n + h \\left(\\frac{p_n+p_{n+1}}{2}\\right) \\\\\np_{n+1} = p_n - h \\omega^2 \\left(\\frac{q_n+q_{n+1}}{2}\\right)\n$$\nThis is a system of linear equations for $(q_{n+1}, p_{n+1})$. We rearrange it to find the one-step map matrix.\n$$\nq_{n+1} - \\frac{h}{2} p_{n+1} = q_n + \\frac{h}{2} p_n \\\\\n\\frac{h\\omega^2}{2} q_{n+1} + p_{n+1} = p_n - \\frac{h\\omega^2}{2} q_n\n$$\nIn matrix form, this is $\\mathbf{L}\\mathbf{z}_{n+1} = \\mathbf{R}\\mathbf{z}_n$, where $\\mathbf{z}_k = \\begin{pmatrix} q_k \\\\ p_k \\end{pmatrix}$:\n$$\n\\begin{pmatrix} 1 & -\\frac{h}{2} \\\\ \\frac{h\\omega^2}{2} & 1 \\end{pmatrix} \\begin{pmatrix} q_{n+1} \\\\ p_{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{h}{2} \\\\ -\\frac{h\\omega^2}{2} & 1 \\end{pmatrix} \\begin{pmatrix} q_n \\\\ p_n \\end{pmatrix}\n$$\nThe one-step map is given by the matrix $\\mathbf{M}_{num} = \\mathbf{L}^{-1}\\mathbf{R}$. The determinant of $\\mathbf{L}$ is $\\det(\\mathbf{L}) = (1)(1) - (-\\frac{h}{2})(\\frac{h\\omega^2}{2}) = 1 + \\frac{h^2\\omega^2}{4}$.\n$$\n\\mathbf{L}^{-1} = \\frac{1}{1 + \\frac{h^2\\omega^2}{4}} \\begin{pmatrix} 1 & \\frac{h}{2} \\\\ -\\frac{h\\omega^2}{2} & 1 \\end{pmatrix}\n$$\nThus, the one-step map is:\n$$\n\\mathbf{M}_{num} = \\frac{1}{1 + \\frac{h^2\\omega^2}{4}} \\begin{pmatrix} 1 & \\frac{h}{2} \\\\ -\\frac{h\\omega^2}{2} & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\frac{h}{2} \\\\ -\\frac{h\\omega^2}{2} & 1 \\end{pmatrix} = \\frac{1}{1 + \\frac{h^2\\omega^2}{4}} \\begin{pmatrix} 1 - \\frac{h^2\\omega^2}{4} & h \\\\ -h\\omega^2 & 1 - \\frac{h^2\\omega^2}{4} \\end{pmatrix}\n$$\nThis is the linear one-step map for the method.\n\nThis map is symplectic because it is generated by a symplectic integrator. Like the exact flow, we can verify this by checking if $\\mathbf{M}_{num}^T \\mathbf{J} \\mathbf{M}_{num} = \\mathbf{J}$. A general property of Gauss-collocation methods, of which the implicit midpoint rule is the simplest ($1$-stage) example, is that they are symplectic. The direct verification that $\\mathbf{M}_{num}$ is a symplectic matrix was performed in Part 2 for a matrix of the same general form and confirmed its symplectic nature. The calculation for $\\mathbf{M}_{num}$ is algebraically identical.\n\nTo identify a quadratic invariant, we test whether the discrete map preserves the original Hamiltonian $H(q,p)$. We examine the difference $H(q_{n+1}, p_{n+1}) - H(q_n, p_n)$:\n$$\nH(q_{n+1}, p_{n+1}) - H(q_n, p_n) = \\frac{1}{2}\\left(\\omega^2 q_{n+1}^2 + p_{n+1}^2\\right) - \\frac{1}{2}\\left(\\omega^2 q_n^2 + p_n^2\\right)\n$$\n$$\n= \\frac{1}{2}\\left[ \\omega^2(q_{n+1}^2 - q_n^2) + (p_{n+1}^2 - p_n^2) \\right]\n$$\nUsing the difference of squares factorization, $a^2-b^2 = (a-b)(a+b)$:\n$$\n= \\frac{1}{2}\\left[ \\omega^2(q_{n+1}-q_n)(q_{n+1}+q_n) + (p_{n+1}-p_n)(p_{n+1}+p_n) \\right]\n$$\nFrom the defining equations of the method:\n$$\nq_{n+1}-q_n = h \\left(\\frac{p_n+p_{n+1}}{2}\\right) \\quad \\text{and} \\quad p_{n+1}-p_n = -h \\omega^2 \\left(\\frac{q_n+q_{n+1}}{2}\\right)\n$$\nSubstitute these into the expression for the change in $H$:\n$$\n= \\frac{1}{2}\\left[ \\omega^2 \\left(h \\frac{p_n+p_{n+1}}{2}\\right)(q_{n+1}+q_n) + \\left(-h \\omega^2 \\frac{q_n+q_{n+1}}{2}\\right)(p_{n+1}+p_n) \\right]\n$$\n$$\n= \\frac{h\\omega^2}{4}\\left[ (p_n+p_{n+1})(q_{n+1}+q_n) - (q_n+q_{n+1})(p_{n+1}+p_n) \\right] = 0\n$$\nSince $H(q_{n+1}, p_{n+1}) - H(q_n, p_n) = 0$, we have $H(q_{n+1}, p_{n+1}) = H(q_n, p_n)$.\nTherefore, for this system, the quadratic invariant preserved exactly by the discrete map is the Hamiltonian itself, $H(q,p) = \\frac{1}{2}(\\omega^2 q^2 + p^2)$. This is a special property that holds when the implicit midpoint rule is applied to any system with a quadratic Hamiltonian.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} q_{0} \\cos(\\omega h) + \\frac{p_{0}}{\\omega} \\sin(\\omega h) & p_{0} \\cos(\\omega h) - q_{0} \\omega \\sin(\\omega h) \\end{pmatrix} } $$"
        },
        {
            "introduction": "A core tenet of symplectic geometry is that Hamiltonian flows preserve phase-space volume, which in two dimensions corresponds to preserving area. This hands-on computational practice  brings this theoretical principle to life. By implementing both a symplectic integrator and a non-symplectic one, you will design a numerical experiment to directly measure the area of a phase-space region as it evolves, providing a tangible demonstration of the structural integrity of SPRK methods.",
            "id": "3769881",
            "problem": "Consider a one-degree-of-freedom separable Hamiltonian system with generalized coordinate $q$ and conjugate momentum $p$, governed by the Hamiltonian $H(q,p)=T(p)+V(q)$. The exact Hamiltonian flow preserves the canonical symplectic $2$-form $\\omega=\\mathrm{d}q\\wedge\\mathrm{d}p$, which implies preservation of oriented area in the phase plane $(q,p)$. A numerical one-step method induces a discrete map $(q,p)\\mapsto(\\tilde{q},\\tilde{p})$. A map that preserves $\\omega$ is called symplectic, and for such a map, the area of any closed planar loop in the $(q,p)$-plane is invariant under the mapping. Symplectic Partitioned Runge-Kutta (SPRK) methods are a class of structure-preserving integrators designed for separable Hamiltonians.\n\nYour task is to design and implement a numerical experiment to measure near-symplecticity by tracking the area of closed phase-space loops under one-step maps produced by SPRK schemes and to interpret deviations in area. The experiment must adhere to the following specifications.\n\n1. Foundational base:\n   - Begin from Hamilton's equations for separable Hamiltonians, $\\dot{q}=\\partial T/\\partial p$ and $\\dot{p}=-\\partial V/\\partial q$.\n   - Use the fact that symplectic maps preserve the symplectic $2$-form $\\omega$ and hence the oriented area of any closed loop in $(q,p)$.\n   - Parameterize an initial closed loop in phase space as a discretized curve $\\gamma(\\theta)=(q(\\theta),p(\\theta))$ with $q(\\theta)=R\\cos\\theta$ and $p(\\theta)=R\\sin\\theta$, where $\\theta\\in[0,2\\pi)$ is in radians. The loop is discretized by sampling $\\theta$ uniformly at $M$ points.\n\n2. Numerical integrators to be used:\n   - Implement a second-order Symplectic Partitioned Runge-Kutta scheme suitable for separable Hamiltonians (the Störmer-Verlet method). This scheme is symplectic and should ideally preserve area of the discretized loop under the one-step map, up to numerical effects.\n   - Implement a first-order partitioned explicit Euler method (not symplectic) for the same separable Hamiltonian, to serve as a baseline that is expected to exhibit area change under the one-step map.\n\n3. Hamiltonian choice and units:\n   - Use the harmonic oscillator Hamiltonian $H(q,p)=\\frac{1}{2}p^{2}+\\frac{1}{2}q^{2}$, so that $\\partial T/\\partial p=p$ and $\\partial V/\\partial q=q$.\n   - All angles $\\theta$ must be expressed in radians.\n\n4. Area measurement:\n   - Approximate the area of a closed loop using the polygonal area computed by the shoelace formula applied to the discretized points $\\{(q_{k},p_{k})\\}_{k=0}^{M-1}$, with indices taken modulo $M$ to close the loop.\n   - Define the near-symplecticity diagnostic as the relative area change under the one-step map:\n     $$\\varepsilon=\\frac{A_{\\text{after}}-A_{\\text{before}}}{A_{\\text{before}}},$$\n     where $A_{\\text{before}}$ is the polygonal area of the initial loop and $A_{\\text{after}}$ is the polygonal area of the loop formed by the mapped points. Report $\\varepsilon$ as a floating-point number.\n\n5. Test suite:\n   - Evaluate the diagnostic on the following four cases, each specified by a tuple $(\\text{method},h,R,M)$:\n     - Case $1$: $(\\text{SV},\\,0.3,\\,1.0,\\,64)$ where $\\text{SV}$ denotes the Störmer-Verlet method, step size $h=0.3$, radius $R=1.0$, and number of points $M=64$.\n     - Case $2$: $(\\text{SV},\\,1.9,\\,1.0,\\,12)$ with step size $h=1.9$, radius $R=1.0$, and $M=12$ points, to probe coarse discretization and large stable step.\n     - Case $3$: $(\\text{EE},\\,0.3,\\,1.0,\\,64)$ where $\\text{EE}$ denotes the explicit Euler partitioned method, step size $h=0.3$, radius $R=1.0$, and $M=64$ points.\n     - Case $4$: $(\\text{EE},\\,0.01,\\,2.0,\\,128)$ with step size $h=0.01$, radius $R=2.0$, and $M=128$ points, to probe the small-step regime and a larger loop.\n\n6. Output specification:\n   - Your program must produce a single line of output containing the four diagnostics $\\varepsilon$ for the cases listed above, as a comma-separated list enclosed in square brackets, in the order of the test cases $1$ through $4$ (e.g., $[\\varepsilon_{1},\\varepsilon_{2},\\varepsilon_{3},\\varepsilon_{4}]$).\n   - Each $\\varepsilon$ must be a floating-point number.\n\nYour implementation must be self-contained, require no input, and run to completion. The program must use double-precision floating-point arithmetic. The numerical experiment must be scientifically sound: the methods, Hamiltonian, and diagnostics must be consistent with the foundational base outlined above, and the angle unit must be radians as specified.",
            "solution": "The problem requires the implementation of a numerical experiment to measure the near-symplecticity of two numerical integrators by observing the change in area of a closed loop in phase space. The system under consideration is the one-degree-of-freedom harmonic oscillator, described by the separable Hamiltonian $H(q,p) = T(p) + V(q) = \\frac{1}{2}p^2 + \\frac{1}{2}q^2$.\n\nThe dynamics of this system are governed by Hamilton's equations:\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{\\partial T(p)}{\\partial p} = p $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} = -\\frac{\\partial V(q)}{\\partial q} = -q $$\nThis is a linear system of ordinary differential equations. We can write this in matrix form as:\n$$ \\frac{d}{dt} \\begin{pmatrix} q \\\\ p \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} \\begin{pmatrix} q \\\\ p \\end{pmatrix} $$\nThe exact solution to this system for an initial condition $(q_0, p_0)$ describes a circular trajectory in the $(q,p)$ phase plane, which manifestly preserves area.\n\nA one-step numerical integrator with a fixed step size $h$ approximates the exact flow. For this linear system, the integrator can be represented by a constant matrix $M$ such that the state $(q_{n+1}, p_{n+1})$ at step $n+1$ is obtained from the state $(q_n, p_n)$ at step $n$ by matrix multiplication:\n$$ \\begin{pmatrix} q_{n+1} \\\\ p_{n+1} \\end{pmatrix} = M \\begin{pmatrix} q_n \\\\ p_n \\end{pmatrix} $$\nA map is called symplectic if it preserves the canonical symplectic $2$-form $\\omega = \\mathrm{d}q \\wedge \\mathrm{d}p$. For a linear map in two dimensions, this is equivalent to the condition that the determinant of its matrix representation is equal to $1$.\n\nThe problem states that area preservation is a consequence of symplecticity. A linear map represented by a matrix $M$ transforms a region of area $A$ into a region of area $|\\det(M)| \\cdot A$. The experiment uses a polygonal loop as a proxy for a continuous region. The area of the polygon formed by vertices $\\{(q_k, p_k)\\}$ is transformed according to the same rule: $A_{\\text{after}} = |\\det(M)| \\cdot A_{\\text{before}}$. The diagnostic for near-symplecticity, $\\varepsilon$, is defined as the relative area change:\n$$ \\varepsilon = \\frac{A_{\\text{after}} - A_{\\text{before}}}{A_{\\text{before}}} = \\frac{|\\det(M)| \\cdot A_{\\text{before}} - A_{\\text{before}}}{A_{\\text{before}}} = |\\det(M)| - 1 $$\nThis theoretical result shows that for any linear integrator, $\\varepsilon$ depends only on the matrix $M$ (and thus on the method and step size $h$), and not on the specific choice of the initial loop (i.e., its radius $R$ or number of discretization points $M$). The polygonal area is computed via the shoelace formula: $A = \\frac{1}{2} |\\sum_{k=0}^{M-1} (q_k p_{k+1} - q_{k+1} p_k)|$.\n\nWe now derive the matrices $M$ for the two specified integrators.\n\n1.  **Störmer-Verlet (SV) Method**:\n    This is a second-order Symplectic Partitioned Runge-Kutta (SPRK) method. For the given separable Hamiltonian, one step of the integrator is defined by:\n    1.  $p_{n+1/2} = p_n - \\frac{h}{2} \\frac{\\partial V}{\\partial q}(q_n) = p_n - \\frac{h}{2} q_n$\n    2.  $q_{n+1} = q_n + h \\frac{\\partial T}{\\partial p}(p_{n+1/2}) = q_n + h p_{n+1/2}$\n    3.  $p_{n+1} = p_{n+1/2} - \\frac{h}{2} \\frac{\\partial V}{\\partial q}(q_{n+1}) = p_{n+1/2} - \\frac{h}{2} q_{n+1}$\n\n    By substituting these relations, we express $(q_{n+1}, p_{n+1})$ as a linear transformation of $(q_n, p_n)$:\n    $$ q_{n+1} = q_n + h p_{n+1/2} = q_n + h(p_n - \\frac{h}{2}q_n) = (1 - \\frac{h^2}{2})q_n + h p_n $$\n    $$ p_{n+1} = p_{n+1/2} - \\frac{h}{2} q_{n+1} = (p_n - \\frac{h}{2}q_n) - \\frac{h}{2} \\left( (1 - \\frac{h^2}{2})q_n + h p_n \\right) $$\n    $$ p_{n+1} = (1 - \\frac{h^2}{2})p_n - (\\frac{h}{2} + \\frac{h}{2}(1 - \\frac{h^2}{2}))q_n = (1 - \\frac{h^2}{2})p_n - (h - \\frac{h^3}{4})q_n $$\n    The matrix representation for the Störmer-Verlet step is therefore:\n    $$ M_{SV} = \\begin{pmatrix} 1 - \\frac{h^2}{2} & h \\\\ -h(1-\\frac{h^2}{4}) & 1 - \\frac{h^2}{2} \\end{pmatrix} $$\n    The determinant of this matrix is $\\det(M_{SV}) = (1 - \\frac{h^2}{2})^2 + h^2(1-\\frac{h^2}{4}) = 1 - h^2 + \\frac{h^4}{4} + h^2 - \\frac{h^4}{4} = 1$.\n    As expected for a symplectic method, the determinant is exactly $1$. Therefore, the theoretical value for the diagnostic is $\\varepsilon_{SV} = \\det(M_{SV}) - 1 = 0$. Any non-zero result from the numerical implementation will be attributable to floating-point arithmetic errors.\n\n2.  **Partitioned Explicit Euler (EE) Method**:\n    The problem specifies this as a non-symplectic method. This corresponds to the standard forward Euler scheme applied to the system of ODEs:\n    $q_{n+1} = q_n + h \\dot{q}_n = q_n + h p_n$\n    $p_{n+1} = p_n + h \\dot{p}_n = p_n - h q_n$\n    The matrix representation for the explicit Euler step is:\n    $$ M_{EE} = \\begin{pmatrix} 1 & h \\\\ -h & 1 \\end{pmatrix} $$\n    The determinant of this matrix is $\\det(M_{EE}) = (1)(1) - (h)(-h) = 1 + h^2$.\n    The determinant is greater than $1$ for any non-zero step size $h$, indicating that the method is not symplectic and will systematically increase the phase-space area. The theoretical diagnostic value is $\\varepsilon_{EE} = \\det(M_{EE}) - 1 = (1+h^2) - 1 = h^2$.\n\nBased on this analysis, we can predict the outcomes for the test cases:\n- Case 1: $(\\text{SV}, h=0.3)$. We expect $\\varepsilon_1 \\approx 0$.\n- Case 2: $(\\text{SV}, h=1.9)$. We expect $\\varepsilon_2 \\approx 0$.\n- Case 3: $(\\text{EE}, h=0.3)$. We expect $\\varepsilon_3 = 0.3^2 = 0.09$.\n- Case 4: $(\\text{EE}, h=0.01)$. We expect $\\varepsilon_4 = 0.01^2 = 0.0001$.\n\nThe following Python code implements this experiment. It generates an initial circular loop of points, applies a single step of the specified integrator to each point, calculates the area of the initial and final polygons using the shoelace formula, and computes the relative area change $\\varepsilon$. The calculations are vectorized using NumPy for efficiency.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and implements a numerical experiment to measure the near-symplecticity\n    of Störmer-Verlet and Explicit Euler methods for the harmonic oscillator.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (method, h, R, M)\n        (\"SV\", 0.3, 1.0, 64),\n        (\"SV\", 1.9, 1.0, 12),\n        (\"EE\", 0.3, 1.0, 64),\n        (\"EE\", 0.01, 2.0, 128),\n    ]\n\n    results = []\n\n    def calculate_area(points):\n        \"\"\"\n        Calculates the area of a polygon using the shoelace formula.\n        The input points is an (M, 2) numpy array of (q, p) coordinates.\n        \"\"\"\n        q = points[:, 0]\n        p = points[:, 1]\n        # Vectorized shoelace formula: 0.5 * |(x0y1 + x1y2 + ... ) - (y0x1 + y1x2 + ...)|\n        # Roll provides the periodic boundary condition for the polygon.\n        return 0.5 * np.abs(np.dot(q, np.roll(p, -1)) - np.dot(p, np.roll(q, -1)))\n\n    def step_sv(q, p, h):\n        \"\"\"\n        Performs a single Störmer-Verlet step for the harmonic oscillator.\n        H = p^2/2 + q^2/2, so T_p = p, V_q = q.\n        This is a vectorized function.\n        \"\"\"\n        # 1. Half kick\n        p_half = p - 0.5 * h * q\n        # 2. Full drift\n        q_new = q + h * p_half\n        # 3. Half kick\n        p_new = p_half - 0.5 * h * q_new\n        return q_new, p_new\n\n    def step_ee(q, p, h):\n        \"\"\"\n        Performs a single Explicit Euler step for the harmonic oscillator.\n        System is dq/dt = p, dp/dt = -q.\n        This is a vectorized function.\n        \"\"\"\n        q_new = q + h * p\n        p_new = p - h * q\n        return q_new, p_new\n\n    for case in test_cases:\n        method, h, R, M = case\n\n        # 1. Generate the initial closed loop (a discretized circle).\n        # Angles must be in radians. np.linspace is appropriate.\n        theta = np.linspace(0.0, 2.0 * np.pi, M, endpoint=False)\n        q_initial = R * np.cos(theta)\n        p_initial = R * np.sin(theta)\n        initial_points = np.stack((q_initial, p_initial), axis=1)\n\n        # 2. Calculate the area of the initial polygon.\n        area_before = calculate_area(initial_points)\n\n        # 3. Apply one step of the integrator to all points on the loop.\n        if method == \"SV\":\n            q_final, p_final = step_sv(q_initial, p_initial, h)\n        elif method == \"EE\":\n            q_final, p_final = step_ee(q_initial, p_initial, h)\n        else:\n            raise ValueError(f\"Unknown method: {method}\")\n            \n        final_points = np.stack((q_final, p_final), axis=1)\n        \n        # 4. Calculate the area of the mapped polygon.\n        area_after = calculate_area(final_points)\n\n        # 5. Compute the relative area change diagnostic.\n        # Check for area_before == 0 to prevent division by zero, though unlikely.\n        if area_before == 0.0:\n            epsilon = 0.0 if area_after == 0.0 else np.inf\n        else:\n            epsilon = (area_after - area_before) / area_before\n        \n        results.append(epsilon)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) ensures standard float representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While basic symplectic integrators offer excellent long-term stability, achieving higher accuracy often requires more sophisticated designs. This practice  moves from analysis to synthesis, introducing the powerful technique of symmetric composition for building high-order methods from low-order ones. You will derive the algebraic conditions, rooted in the Baker-Campbell-Hausdorff formula, that allow a second-order scheme to be composed into a fourth-order integrator, a cornerstone of modern geometric numerical integration.",
            "id": "3769900",
            "problem": "Consider a separable Hamiltonian system with Hamiltonian $H(q,p) = T(p) + V(q)$ on a cotangent bundle with canonical symplectic form. Let $\\Phi_{A}^{t}$ and $\\Phi_{B}^{t}$ denote the exact Hamiltonian flows generated by $A := T$ and $B := V$, respectively. A standard symmetric second-order symplectic splitting (often called the Störmer-Verlet, or Strang, step) for timestep $h$ is the composition $\\mathcal{S}_{2}(h) := \\Phi_{A}^{h/2} \\circ \\Phi_{B}^{h} \\circ \\Phi_{A}^{h/2}$. A three-stage symmetric composition of such second-order steps with scaled timesteps $w_{1} h$, $w_{0} h$, $w_{1} h$ yields a method\n$$\n\\mathcal{S}_{4}(h) \\;=\\; \\mathcal{S}_{2}(w_{1} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{0} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{1} h),\n$$\nwhere $\\mathcal{S}_{2}(x h) := \\Phi_{A}^{x h/2} \\circ \\Phi_{B}^{x h} \\circ \\Phi_{A}^{x h/2}$. Interpreting this as a symplectic partitioned Runge–Kutta (SPRK) method for the separable system, one obtains a drift–kick–drift structure with symmetric coefficients.\n\nStarting from the fundamental facts that (i) each partial flow $\\Phi_{A}^{t}$ and $\\Phi_{B}^{t}$ is symplectic, (ii) compositions of symplectic maps are symplectic, and (iii) the Baker–Campbell–Hausdorff expansion for compositions of exponentials of Lie derivatives governs the local error structure of splitting schemes, carry out the following:\n\n1. Derive the consistency condition that must be satisfied by $w_{1}$ and $w_{0}$ so that $\\mathcal{S}_{4}(h)$ is first-order consistent with the exact flow $\\exp(h(L_{A}+L_{B}))$, where $L_{A}$ and $L_{B}$ are the Lie derivatives of $A$ and $B$.\n2. Using the symmetry of the composition and the leading-order structure of the local error from the Baker–Campbell–Hausdorff expansion, derive the additional order condition required to eliminate the third-order error term so that the method attains classical order $4$.\n3. Solve these conditions to obtain a closed-form expression for $w_{1}$.\n4. Argue, from first principles of symplectic geometry and the construction by composition of exact partial flows, that the resulting three-stage scheme is symplectic as a symplectic partitioned Runge–Kutta method.\n\nExpress the final answer as the exact algebraic expression for $w_{1}$ in simplest form. Do not provide intermediate coefficients; only report $w_{1}$ as your final answer.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- **Hamiltonian:** $H(q,p) = T(p) + V(q)$, which is a separable Hamiltonian. Let $A := T(p)$ and $B := V(q)$.\n- **Partial Flows:** $\\Phi_{A}^{t}$ and $\\Phi_{B}^{t}$ are the exact Hamiltonian flows generated by $A$ and $B$, respectively.\n- **Second-Order Method:** $\\mathcal{S}_{2}(h) := \\Phi_{A}^{h/2} \\circ \\Phi_{B}^{h} \\circ \\Phi_{A}^{h/2}$. This is a symmetric second-order splitting method (Strang splitting).\n- **Fourth-Order Method:** $\\mathcal{S}_{4}(h) \\;=\\; \\mathcal{S}_{2}(w_{1} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{0} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{1} h)$, which is a three-stage symmetric composition.\n- **Scaling Factors:** $w_{1}$ and $w_{0}$ are real coefficients.\n- **Timestep:** $h$.\n- **Fundamental Principles:** (i) $\\Phi_{A}^{t}$ and $\\Phi_{B}^{t}$ are symplectic, (ii) compositions of symplectic maps are symplectic, (iii) the Baker–Campbell–Hausdorff (BCH) expansion governs the local error structure.\n- **Lie Derivatives:** $L_A$ and $L_B$ are the Lie derivatives associated with $A$ and $B$. The exact flow is $\\exp(h(L_A + L_B))$.\n- **Tasks:**\n  1. Derive the first-order consistency condition for $w_{1}$ and $w_{0}$.\n  2. Derive the condition to eliminate the third-order error term.\n  3. Solve these conditions for $w_{1}$.\n  4. Argue that the method is symplectic.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and scientifically grounded within the field of geometric numerical integration for Hamiltonian systems.\n- **Scientific Grounding (Critical):** The problem deals with standard, established concepts: separable Hamiltonians, symplectic splitting methods, Lie derivatives, and the Baker-Campbell-Hausdorff formula. The construction of higher-order methods by composing lower-order symmetric steps is a fundamental technique known as Yoshida's method. The problem is factually sound.\n- **Well-Posed:** The problem provides a clear and complete set of definitions and asks for the derivation of specific, solvable algebraic conditions on the method's coefficients. A unique, meaningful solution for the coefficients is known to exist.\n- **Objective (Critical):** The problem is stated in precise, formal mathematical language, free from any subjectivity or ambiguity.\n- **Completeness/Consistency:** All necessary information is provided. The definitions are self-consistent.\n- **Other criteria:** The problem is not unrealistic, ill-posed, trivial, or unverifiable. It is a standard and important exercise in the analysis of geometric integrators.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution\nThe solution is structured to address the four tasks posed in the problem statement. We use the language of Lie operators, where the flow of a Hamiltonian $G$ is represented by the exponential map $\\exp(t L_G)$, and $L_G = \\{ \\cdot, G \\}$ is the Lie derivative (Poisson bracket operator).\n\n#### 1. First-Order Consistency Condition\nThe exact flow for the total Hamiltonian $H=A+B$ over a timestep $h$ is given by $\\exp(h(L_A+L_B))$. A numerical method is first-order consistent if its operator expansion matches the exact flow operator up to terms of order $O(h)$.\n\nThe method $\\mathcal{S}_{4}(h)$ is a composition of three steps, $\\mathcal{S}_{2}(w_{1} h)$, $\\mathcal{S}_{2}(w_{0} h)$, and $\\mathcal{S}_{2}(w_{1} h)$. Each step $\\mathcal{S}_{2}(x h)$ approximates the exact flow for a duration of $x h$. The lowest-order term in the expansion of the operator for $\\mathcal{S}_{2}(x h)$ is simply $\\exp(x h(L_A+L_B))$.\n\nTo find the lowest-order term for the composite method $\\mathcal{S}_{4}(h)$, we compose the lowest-order terms of its constituents:\n$$\n\\exp(w_{1} h (L_A+L_B)) \\circ \\exp(w_{0} h (L_A+L_B)) \\circ \\exp(w_{1} h (L_A+L_B))\n$$\nSince the operator $(L_A+L_B)$ commutes with itself, the composition of exponentials simplifies to the exponential of the sum of the arguments:\n$$\n\\exp\\left((w_{1} h + w_{0} h + w_{1} h)(L_A+L_B)\\right) = \\exp\\left((2w_{1} + w_{0})h(L_A+L_B)\\right)\n$$\nFor first-order consistency, this must match the exact flow operator $\\exp(h(L_A+L_B))$ at least to first order in $h$. This requires the total effective timestep to be equal to $h$:\n$$\n(2w_{1} + w_{0})h = h\n$$\nThus, the consistency condition is:\n$$\n2w_{1} + w_{0} = 1\n$$\n\n#### 2. Fourth-Order Condition (Elimination of Third-Order Error)\nThe method $\\mathcal{S}_{2}(h)$ is symmetric. For a symmetric method of classical order $p$, the generated flow corresponds to the exact flow of a modified Hamiltonian, and its Lie operator series contains only odd powers of $h$ beyond the leading term: $L_{\\text{method}} = (L_A+L_B) + h^{p} C_{p+1} + h^{p+2} C_{p+3} + \\dots$.\nThe method $\\mathcal{S}_{2}(h)$ is second order, so $p=2$. Its Lie operator expansion is:\n$$\nL_{\\mathcal{S}_2(h)} = (L_A+L_B) + h^2 E_3 + h^4 E_5 + \\dots\n$$\nThis means that the flow of $\\mathcal{S}_2(h)$ can be written as $\\exp(h(L_A+L_B) + h^3 E_3 + h^5 E_5 + \\dots)$, where $E_k$ are operators involving nested Lie brackets of $L_A$ and $L_B$.\n\nThe flow of a constituent step $\\mathcal{S}_{2}(x h)$ is therefore:\n$$\n\\exp(x h(L_A+L_B) + (x h)^3 E_3 + O(h^5))\n$$\nWhen we compose symmetric methods, the leading error term of the composite method is simply the sum of the leading error terms of the constituent methods. The method $\\mathcal{S}_4(h)$ is a symmetric composition of symmetric methods, hence its own error expansion will only contain odd powers of $h$. The leading error term for $\\mathcal{S}_4(h)$ is the sum of the $h^3$ error terms from each stage:\n- From the first stage $\\mathcal{S}_{2}(w_{1} h)$: $(w_{1} h)^3 E_3$\n- From the second stage $\\mathcal{S}_{2}(w_{0} h)$: $(w_{0} h)^3 E_3$\n- From the third stage $\\mathcal{S}_{2}(w_{1} h)$: $(w_{1} h)^3 E_3$\n\nThe total coefficient of the $h^3 E_3$ error term for $\\mathcal{S}_4(h)$ is the sum of these contributions:\n$$\n(w_{1}^3 + w_{0}^3 + w_{1}^3) h^3 E_3 = (2w_{1}^3 + w_{0}^3) h^3 E_3\n$$\nTo make the method have an order of accuracy greater than $2$, we must eliminate this leading error term. Since $E_3$ is in general non-zero, its coefficient must be zero. This gives the second condition:\n$$\n2w_{1}^3 + w_{0}^3 = 0\n$$\nWhen this condition is satisfied, the $O(h^3)$ error term vanishes. Because the overall method is symmetric, the $O(h^4)$ error term is also guaranteed to be zero, thus elevating the method's classical order to $4$.\n\n#### 3. Solving for $w_1$\nWe now solve the system of two algebraic equations for $w_1$ and $w_0$:\n1. $2w_{1} + w_{0} = 1$\n2. $2w_{1}^3 + w_{0}^3 = 0$\n\nFrom equation (2), taking the real cube root of both sides gives:\n$$\nw_{0}^3 = -2w_{1}^3 \\implies w_{0} = -2^{1/3} w_{1}\n$$\nNow, substitute this expression for $w_0$ into equation (1):\n$$\n2w_{1} + (-2^{1/3} w_{1}) = 1\n$$\nFactor out $w_1$:\n$$\nw_{1} (2 - 2^{1/3}) = 1\n$$\nSolving for $w_1$ yields the closed-form expression:\n$$\nw_{1} = \\frac{1}{2 - 2^{1/3}}\n$$\n\n#### 4. Argument for Symplecticity\nThe argument for the symplecticity of the method $\\mathcal{S}_4(h)$ rests on two fundamental principles of geometric mechanics stated in the problem.\n1.  **A Hamiltonian flow is a symplectic map.** The partial flows $\\Phi_{A}^{t}$ and $\\Phi_{B}^{t}$ are, by definition, the exact flows for the Hamiltonians $A=T(p)$ and $B=V(q)$, respectively. Therefore, for any time $t$, both $\\Phi_{A}^{t}$ and $\\Phi_{B}^{t}$ are symplectic maps. A symplectic map is a transformation that preserves the canonical symplectic two-form $\\omega = \\sum_i dp_i \\wedge dq_i$.\n2.  **The composition of symplectic maps is a symplectic map.** The set of all symplectic maps on a given phase space forms a group under the operation of map composition. This means if $\\Psi_1$ and $\\Psi_2$ are symplectic, then their composition $\\Psi_1 \\circ \\Psi_2$ is also symplectic.\n\nThe construction of $\\mathcal{S}_4(h)$ is a multi-level composition:\n- First, the basic step $\\mathcal{S}_{2}(x h) = \\Phi_{A}^{x h/2} \\circ \\Phi_{B}^{x h} \\circ \\Phi_{A}^{x h/2}$ is a composition of three maps: $\\Phi_{A}^{x h/2}$, $\\Phi_{B}^{x h}$, and $\\Phi_{A}^{x h/2}$. Since each of these is a Hamiltonian flow, each is a symplectic map. By principle (2), their composition $\\mathcal{S}_{2}(x h)$ is also a symplectic map for any real $x$ and $h$.\n- Second, the full method $\\mathcal{S}_{4}(h) = \\mathcal{S}_{2}(w_{1} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{0} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{1} h)$ is a composition of three maps: $\\mathcal{S}_{2}(w_{1} h)$, $\\mathcal{S}_{2}(w_{0} h)$, and $\\mathcal{S}_{2}(w_{1} h)$. As established in the previous point, each of these $\\mathcal{S}_2$ maps is symplectic.\n- Therefore, by another application of principle (2), the final map $\\mathcal{S}_{4}(h)$ is a composition of symplectic maps and is itself symplectic.\n\nThis property holds for any real values of $w_0$ and $w_1$. The conditions derived in parts 1-3 ensure the method has a high order of accuracy, but the symplecticity is an inherent structural property of the construction by composition of exact Hamiltonian flows. A symplectic partitioned Runge-Kutta (SPRK) method is one whose Butcher tableau coefficients satisfy a set of algebraic symplecticity conditions. Since $\\mathcal{S}_{4}(h)$ is symplectic by construction, its SPRK coefficients are guaranteed to satisfy these conditions.",
            "answer": "$$\\boxed{\\frac{1}{2 - 2^{1/3}}}$$"
        }
    ]
}