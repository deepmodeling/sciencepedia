{
    "hands_on_practices": [
        {
            "introduction": "The Kohn-Sham effective potential is the centerpiece of DFT calculations, but it is composed of several distinct energy terms. This first exercise provides concrete practice in calculating two fundamental components for a helium atom, starting from a given electron density . By deriving the external potential from the nucleus and the classical electrostatic Hartree potential from the electron cloud, you will build a tangible understanding of how the KS potential is constructed in practice.",
            "id": "1407884",
            "problem": "In the context of Kohn-Sham Density Functional Theory (DFT), the effective potential experienced by an electron in a many-electron system is constructed from several components. This problem concerns two of these components for a simplified model of a neutral helium atom.\n\nConsider an isolated, neutral helium atom with its nucleus (charge $+2e$) fixed at the origin. In this model, the total electron density $n(r)$ for the two electrons is approximated by the spherically symmetric function:\n$$n(r) = \\frac{2\\zeta^3}{\\pi} \\exp(-2\\zeta r)$$\nwhere $r$ is the radial distance from the nucleus, $\\zeta$ is a positive constant with units of inverse length, $e$ is the elementary charge, and $\\pi$ is the mathematical constant.\n\nThe effective Kohn-Sham potential, $v_{eff}(\\mathbf{r})$, includes the external potential, $v_{ext}(\\mathbf{r})$, and the Hartree potential, $v_H(\\mathbf{r})$.\nThe external potential, $v_{ext}(\\mathbf{r})$, represents the electrostatic potential energy of an electron due to its interaction with the atomic nucleus.\nThe Hartree potential, $v_H(\\mathbf{r})$, describes the classical electrostatic potential energy of an electron due to its repulsion from the total electron density distribution. It is given by the expression:\n$$v_H(\\mathbf{r}) = \\frac{e^2}{4\\pi\\epsilon_0} \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d^3\\mathbf{r}'$$\nwhere $\\epsilon_0$ is the vacuum permittivity.\n\nDue to the spherical symmetry of the problem, both potentials will only depend on the radial distance $r$. Your task is to determine the explicit mathematical expressions for the external potential, $v_{ext}(r)$, and the Hartree potential, $v_H(r)$.\n\nPresent your two answers for $v_{ext}(r)$ and $v_H(r)$, in that order, as analytic expressions in terms of $r$, $\\zeta$, $e$, and $\\epsilon_0$.",
            "solution": "The external Kohn–Sham potential is the electrostatic potential energy of an electron due to the nucleus of charge $+2e$ at the origin. The electrostatic potential created by the nucleus is $\\phi_{\\text{nuc}}(r) = \\frac{1}{4\\pi\\epsilon_{0}} \\frac{2e}{r}$. The potential energy of an electron of charge $-e$ in this potential is\n$$\nv_{ext}(r) = (-e)\\,\\phi_{\\text{nuc}}(r) = -\\frac{2 e^{2}}{4\\pi\\epsilon_{0}\\,r}.\n$$\n\nFor the Hartree potential, start from the given expression\n$$\nv_{H}(\\mathbf{r}) = \\frac{e^{2}}{4\\pi\\epsilon_{0}} \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}'.\n$$\nWith spherical symmetry, this reduces to a radial integral using the standard identity\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 4\\pi\\left[\\frac{1}{r}\\int_{0}^{r} r'^{2} n(r')\\,dr' + \\int_{r}^{\\infty} r' n(r')\\,dr'\\right].\n$$\nInsert $n(r') = A \\exp(-a r')$ with $A = \\frac{2\\zeta^{3}}{\\pi}$ and $a = 2\\zeta$. Define\n$$\nI_{1}(r) = \\int_{0}^{r} r'^{2} \\exp(-a r')\\,dr', \\qquad I_{2}(r) = \\int_{r}^{\\infty} r' \\exp(-a r')\\,dr'.\n$$\nEvaluating these integrals,\n$$\nI_{1}(r) = \\left[\\exp(-a r')\\left(-\\frac{r'^{2}}{a} - \\frac{2 r'}{a^{2}} - \\frac{2}{a^{3}}\\right)\\right]_{0}^{r} = \\frac{2}{a^{3}} - \\exp(-a r)\\left(\\frac{r^{2}}{a} + \\frac{2 r}{a^{2}} + \\frac{2}{a^{3}}\\right),\n$$\n$$\nI_{2}(r) = \\left[\\exp(-a r')\\left(-\\frac{r'}{a} - \\frac{1}{a^{2}}\\right)\\right]_{r}^{\\infty} = \\exp(-a r)\\left(\\frac{r}{a} + \\frac{1}{a^{2}}\\right).\n$$\nTherefore,\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 4\\pi A\\left[\\frac{1}{r} I_{1}(r) + I_{2}(r)\\right].\n$$\nWith $4\\pi A = 8\\zeta^{3}$ and $a = 2\\zeta$, simplify\n$$\n\\frac{1}{r} I_{1}(r) + I_{2}(r) = \\frac{2}{a^{3} r} - \\exp(-a r)\\left(\\frac{1}{a^{2}} + \\frac{2}{a^{3} r}\\right),\n$$\nso\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 8\\zeta^{3}\\left[\\frac{2}{a^{3} r} - \\exp(-a r)\\left(\\frac{1}{a^{2}} + \\frac{2}{a^{3} r}\\right)\\right].\n$$\nSubstituting $a=2\\zeta$ yields\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = -2\\zeta\\,\\exp(-2\\zeta r) + \\frac{2\\left(1 - \\exp(-2\\zeta r)\\right)}{r}.\n$$\nHence,\n$$\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[-2\\zeta\\,\\exp(-2\\zeta r) + \\frac{2\\left(1 - \\exp(-2\\zeta r)\\right)}{r}\\right].\n$$\nAn equivalent compact form is\n$$\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\,\\frac{2}{r}\\left[1 - \\left(1 + \\zeta r\\right)\\exp(-2\\zeta r)\\right].\n$$\nBoth forms are algebraically identical.\n\nThus, the required analytic expressions are\n$$\nv_{ext}(r) = -\\frac{2 e^{2}}{4\\pi\\epsilon_{0}\\,r}, \\qquad\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[-2\\zeta\\,\\exp(-2\\zeta r) + \\frac{2\\left(1 - \\exp(-2\\zeta r)\\right)}{r}\\right].\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{2 e^{2}}{4\\pi\\epsilon_{0}\\,r}  \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[-2\\zeta\\,\\exp(-2\\zeta r) + \\frac{2\\left(1 - \\exp(-2\\zeta r)\\right)}{r}\\right]\\end{pmatrix}}$$"
        },
        {
            "introduction": "After building the potential components, we now explore their deeper relationships through a crucial thought experiment . This practice reveals a fundamental property of the exact exchange-correlation functional: its role in correcting for the spurious self-interaction introduced by the Hartree term. By considering a one-electron system, you will derive the exact condition that prevents an electron from unphysically interacting with itself, a concept central to the development of accurate density functionals.",
            "id": "1407873",
            "problem": "The Kohn-Sham formulation of Density Functional Theory (DFT) provides a powerful method for approximating the electronic structure of many-electron systems. It achieves this by mapping the complex interacting system onto a fictitious system of non-interacting electrons that generate the same ground-state electron density, $n(\\mathbf{r})$.\n\nThe total ground-state energy in the Kohn-Sham formalism, for a given electron density $n(\\mathbf{r})$, is expressed by the energy functional:\n$$E_{KS}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\nHere, $T_s[n]$ is the kinetic energy of the non-interacting reference system, $E_{ext}[n] = \\int v_{ext}(\\mathbf{r}) n(\\mathbf{r}) d\\mathbf{r}$ is the energy due to the external potential $v_{ext}(\\mathbf{r})$ (typically the electron-nucleus attraction), $J[n]$ is the classical Coulomb repulsion energy (Hartree energy) of the electron density with itself, and $E_{xc}[n]$ is the exchange-correlation energy, which contains all the remaining quantum mechanical effects.\n\nThe one-electron Kohn-Sham equations are solved using an effective potential $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r})$, where the Hartree potential $v_H(\\mathbf{r})$ and the exchange-correlation potential $v_{xc}(\\mathbf{r})$ are the functional derivatives of $J[n]$ and $E_{xc}[n]$ with respect to the density $n(\\mathbf{r})$, respectively.\n\nA fundamental principle of DFT is that for the exact exchange-correlation functional, the total energy $E_{KS}[n]$ evaluated at the true ground-state density must equal the true ground-state energy of the system.\n\nConsider a simple one-electron system (e.g., a hydrogen atom or a hydrogen-like ion). For such a system, the time-independent Schrödinger equation can be solved exactly, and there is no electron-electron interaction. If the Kohn-Sham DFT formalism is to be exact for this system, what specific relationship must hold between the exchange-correlation potential, $v_{xc}(\\mathbf{r})$, and the Hartree potential, $v_{H}(\\mathbf{r})$?\n\nA) $v_{xc}(\\mathbf{r}) = v_{H}(\\mathbf{r})$\n\nB) $v_{xc}(\\mathbf{r}) = -v_{H}(\\mathbf{r})$\n\nC) $v_{xc}(\\mathbf{r}) = 0$\n\nD) $v_{xc}(\\mathbf{r}) = -v_{ext}(\\mathbf{r})$\n\nE) The relationship cannot be determined without choosing a specific approximation for the exchange-correlation functional.",
            "solution": "The goal is to determine the relationship between the exchange-correlation potential $v_{xc}(\\mathbf{r})$ and the Hartree potential $v_H(\\mathbf{r})$ for a one-electron system, under the condition that the Kohn-Sham Density Functional Theory (DFT) formalism yields the exact ground-state energy.\n\nStep 1: Write down the exact ground-state energy of a one-electron system.\nFor a system with only one electron, the time-independent Schrödinger equation is:\n$$ \\left( -\\frac{\\hbar^2}{2m_e}\\nabla^2 + v_{ext}(\\mathbf{r}) \\right) \\psi(\\mathbf{r}) = E_{true} \\psi(\\mathbf{r}) $$\nThe true ground-state energy, $E_{true}$, is the expectation value of the Hamiltonian, which consists of only the kinetic energy operator $\\hat{T}$ and the external potential energy operator $\\hat{V}_{ext}$. There are no electron-electron interaction terms.\n$$E_{true} = \\langle \\psi | \\hat{T} + \\hat{V}_{ext} | \\psi \\rangle$$\n\nStep 2: Write down the Kohn-Sham energy functional.\nAs given in the problem statement, the Kohn-Sham energy functional is:\n$$E_{KS}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\n\nStep 3: Apply the condition that DFT must be exact.\nThe problem states that for the exact functional, the energy from the Kohn-Sham expression must equal the true energy of the system when evaluated at the true ground-state electron density $n(\\mathbf{r}) = |\\psi(\\mathbf{r})|^2$.\n$$E_{KS}[n] = E_{true}$$\n\nStep 4: Analyze the terms of the Kohn-Sham functional for a one-electron system.\n- **Kinetic Energy:** The Kohn-Sham kinetic energy, $T_s[n]$, is defined as the kinetic energy of a system of non-interacting electrons. Since a one-electron system has no other electrons to interact with, it is inherently a \"non-interacting\" system. Therefore, its true kinetic energy is identical to the Kohn-Sham non-interacting kinetic energy: $T_{true} = T_s[n]$.\n- **External Potential Energy:** The interaction with the external potential (the nucleus) is the same in both the true system and the Kohn-Sham description: $V_{ext, true} = E_{ext}[n]$.\n\nStep 5: Equate the energy expressions and simplify.\nThe true energy of the system is $E_{true} = T_{true} + V_{ext, true}$. Using the equivalences from Step 4, we can write this as $E_{true} = T_s[n] + E_{ext}[n]$.\nNow, we set this equal to the full Kohn-Sham energy expression:\n$$T_s[n] + E_{ext}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\nSubtracting $T_s[n] + E_{ext}[n]$ from both sides reveals a crucial constraint on the remaining terms:\n$$0 = J[n] + E_{xc}[n]$$\nThis means that for a one-electron system, the exact exchange-correlation energy must be precisely the negative of the Hartree energy:\n$$E_{xc}[n] = -J[n]$$\nThis is an exact condition. The Hartree energy $J[n]$ represents the spurious self-interaction of the electron's charge density with itself, which is not present in the true quantum mechanical description of a single electron. The exchange-correlation energy $E_{xc}[n]$ must therefore exactly cancel this non-physical self-interaction term.\n\nStep 6: Relate the energy functionals to their corresponding potentials.\nThe Hartree potential $v_H(\\mathbf{r})$ and the exchange-correlation potential $v_{xc}(\\mathbf{r})$ are defined as the functional derivatives of their respective energy functionals with respect to the electron density $n(\\mathbf{r})$:\n$$v_H(\\mathbf{r}) = \\frac{\\delta J[n]}{\\delta n(\\mathbf{r})}$$\n$$v_{xc}(\\mathbf{r}) = \\frac{\\delta E_{xc}[n]}{\\delta n(\\mathbf{r})}$$\nTaking the functional derivative of the relationship $E_{xc}[n] = -J[n]$ with respect to $n(\\mathbf{r})$ gives:\n$$\\frac{\\delta E_{xc}[n]}{\\delta n(\\mathbf{r})} = -\\frac{\\delta J[n]}{\\delta n(\\mathbf{r})}$$\nSubstituting the definitions of the potentials, we arrive at the final relationship:\n$$v_{xc}(\\mathbf{r}) = -v_H(\\mathbf{r})$$\n\nThis result shows that for a one-electron system, the exchange-correlation potential must exactly cancel the Hartree potential (the self-interaction potential). This ensures that the total Kohn-Sham effective potential, $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r})$, simplifies to $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r})$. Consequently, the Kohn-Sham equation for a one-electron system becomes mathematically identical to the Schrödinger equation, correctly yielding the exact energy and wavefunction.\n\nBased on this derivation, the correct option is B.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Real-world calculations rely on approximate exchange-correlation functionals, many of which fail to properly correct for self-interaction. This advanced practice uses a powerful model to quantify the practical consequences of these failures, such as the delocalization error seen in stretched molecules . By analyzing how deviations from exact DFT principles lead to specific errors in energy, you will gain insight into the key challenges of modern functional development and the behavior of DFT in difficult chemical situations.",
            "id": "2815502",
            "problem": "Consider a two-site, one-orbital-per-site dissociation-limit model for a stretched diatomic, intended to capture the essential self-interaction and delocalization features of Kohn-Sham density functional theory (Kohn-Sham DFT). You will build a quantitative diagnostic for many-electron self-interaction error by comparing a simplified exact reference (consistent with ensemble density functional theory) to a toy approximate functional that violates the exact flat-plane conditions. Work in atomic units (Hartree), so all energies must be reported in Hartree.\n\nFundamental base and modeling assumptions:\n- The Hohenberg-Kohn theorems and ensemble density functional theory imply exact piecewise linearity of the ground-state energy with respect to the total electron number and constancy of the energy for ensembles of degenerate spin states. In this dissociation-limit model, each site supports at most one electron.\n- For an isolated site with a single electron, the exact site energy is linear in the occupation: if the total on-site occupation is $n \\in [0,1]$, the exact site contribution is $-I \\, n$, where $I$ is the first ionization energy of the corresponding atom. For hydrogen in atomic units, $I \\approx 0.5$.\n- Site asymmetry is modeled by an energy bias $\\Delta$ (in Hartree) so that the one-electron energy on site $A$ is $-I_{A} = -(I + \\Delta/2)$ and on site $B$ is $-I_{B} = -(I - \\Delta/2)$. Positive $\\Delta$ makes site $A$ more favorable.\n- Many-electron self-interaction and delocalization errors of a typical approximate density functional are modeled by two scalar error coefficients:\n  1. A charge-curvature coefficient $c$ (in Hartree) multiplying $n(1-n)$ per site, which vanishes at integer occupations and is maximized at $n = 1/2$. Negative $c$ induces convex deviation below the straight line between integers, favoring delocalized fractional charge.\n  2. A spin-curvature coefficient $s$ (in Hartree) multiplying $n_{\\uparrow} n_{\\downarrow}$ per site, which is zero for pure-spin densities and maximized at equal-spin mixtures. Positive $s$ penalizes fractional spin ensembles, creating an erroneous energy maximum at half-and-half spin mixture.\n- In the dissociation limit, noninteracting kinetic contributions are negligible for localized orbitals, and Hartree plus exact exchange cancel self-interaction exactly for one electron per site in the exact reference. We therefore ignore kinetic and explicit electron-electron terms beyond the above model corrections.\n\nDefinitions and tasks:\n- Let the on-site spin occupations be $n_{A\\uparrow}$, $n_{A\\downarrow}$ and $n_{B\\uparrow}$, $n_{B\\downarrow}$. For each site $i \\in \\{A,B\\}$, the total occupation is $n_i = n_{i\\uparrow} + n_{i\\downarrow}$, with $0 \\le n_i \\le 1$ in the dissociation limit.\n- The exact site energy model is $E_{\\text{exact},i} = -I_i \\, n_i$ and the total exact energy is $E_{\\text{exact}} = \\sum_i E_{\\text{exact},i}$.\n- The toy approximate site energy is $E_{\\text{approx},i} = -I_i \\, n_i + c \\, n_i (1 - n_i) + s \\, n_{i\\uparrow} n_{i\\downarrow}$ and the total approximate energy is $E_{\\text{approx}} = \\sum_i E_{\\text{approx},i}$.\n\nYour program must, for each parameter set $(I, c, s, \\Delta)$ provided in the test suite, compute two diagnostics in Hartree:\n1. Fractional-charge delocalization error for stretched $H_2^+$ (one electron in total):\n   - Model the one-electron system with total occupation $n_A + n_B = 1$. To isolate fractional charge effects, assume spin-pure densities at each site, so $n_{i\\downarrow} = 0$ and $n_{i\\uparrow} = n_i$ for both $i \\in \\{A,B\\}$.\n   - Let $\\alpha \\in [0,1]$ denote the fraction of the electron on site $A$ so that $n_A = \\alpha$ and $n_B = 1 - \\alpha$.\n   - The exact minimum energy is the lower of the two site linear energies at integer localization. The approximate minimum energy is obtained by minimizing the approximate total energy over $\\alpha \\in [0,1]$.\n   - Define the delocalization error as $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$ in Hartree. Negative $\\Delta E_{\\text{charge}}$ indicates spurious lowering (delocalization error).\n2. Fractional-spin error for stretched $H_2$ (two electrons in total):\n   - Enforce one electron per site in the dissociation limit, $n_A = n_B = 1$.\n   - Consider the ensemble with half-and-half spin mixing on each site but with opposite local polarizations to produce total $S_z = 0$: on site $A$, take $n_{A\\uparrow} = 1/2$ and $n_{A\\downarrow} = 1/2$, while on site $B$, take $n_{B\\uparrow} = 1/2$ and $n_{B\\downarrow} = 1/2$.\n   - The exact energy is independent of fractional spin and equals the sum of linear site energies at $n_A = n_B = 1$. The approximate energy includes the spin-curvature terms.\n   - Define the fractional-spin error as $\\Delta E_{\\text{spin}} = E_{\\text{approx}}(\\text{half-and-half spin}) - E_{\\text{exact}}$ in Hartree. Positive $\\Delta E_{\\text{spin}}$ indicates an erroneous energy elevation at fractional spin.\n\nAngle units are not involved. All outputs are energies in Hartree. Round each reported float to six decimal places.\n\nTest suite:\n- Case 1 (symmetric, clear delocalization and spin errors): $I = 0.5$, $c = -0.20$, $s = 0.30$, $\\Delta = 0.0$.\n- Case 2 (mild asymmetry): $I = 0.5$, $c = -0.10$, $s = 0.20$, $\\Delta = 0.15$.\n- Case 3 (no charge curvature): $I = 0.5$, $c = 0.0$, $s = 0.25$, $\\Delta = 0.0$.\n- Case 4 (strong charge curvature, strong asymmetry, no spin curvature): $I = 0.5$, $c = -0.50$, $s = 0.0$, $\\Delta = 0.60$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for the test cases as a comma-separated list enclosed in square brackets. Each element of this list corresponds to one test case and must itself be a two-element list in the order $[\\Delta E_{\\text{charge}}, \\Delta E_{\\text{spin}}]$. For example, the printed line must look like: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]], where each $x_i$ and $y_i$ is a float in Hartree rounded to six decimal places.",
            "solution": "The problem statement is scientifically well-posed, complete, and contains no contradictions. It describes a valid and common toy model used in theoretical chemistry to analyze and understand self-interaction errors in density functional theory. We will therefore proceed with the derivation of the two requested error diagnostics.\n\nFirst, we analyze the fractional-charge delocalization error, $\\Delta E_{\\text{charge}}$, for the one-electron system, which serves as a model for stretched $H_2^+$. The total number of electrons is $1$. The electron's distribution is described by a parameter $\\alpha$, where site $A$ has occupation $n_A = \\alpha$ and site $B$ has occupation $n_B = 1-\\alpha$, with $\\alpha \\in [0,1]$. The site ionization energies are defined as $I_A = I + \\Delta/2$ and $I_B = I - \\Delta/2$.\n\nThe total exact energy is a linear function of $\\alpha$:\n$$E_{\\text{exact}}(\\alpha) = -I_A n_A - I_B n_B = -(I + \\Delta/2)\\alpha - (I - \\Delta/2)(1-\\alpha) = -I - \\Delta\\alpha + \\Delta/2$$\nThe minimum of a linear function on the closed interval $[0,1]$ must occur at an endpoint. The minimal exact energy is therefore:\n$$E_{\\text{exact}}^{\\min} = \\min(E_{\\text{exact}}(0), E_{\\text{exact}}(1)) = \\min(-I_B, -I_A) = \\min(-(I-\\Delta/2), -(I+\\Delta/2)) = -(I + |\\Delta|/2)$$\n\nFor this one-electron system, the problem specifies spin-pure densities ($n_{i\\downarrow}=0$), so the approximate energy on site $i$ is $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i)$, as the spin-curvature term $s \\, n_{i\\uparrow}n_{i\\downarrow}$ is zero. The total approximate energy is the sum over both sites:\n$$E_{\\text{approx}}(\\alpha) = \\left[-I_A \\alpha + c\\alpha(1-\\alpha)\\right] + \\left[-I_B(1-\\alpha) + c(1-\\alpha)\\alpha\\right]$$\n$$E_{\\text{approx}}(\\alpha) = E_{\\text{exact}}(\\alpha) + 2c\\alpha(1-\\alpha) = -2c\\alpha^2 + (2c-\\Delta)\\alpha - I + \\Delta/2$$\nThis is a quadratic function of $\\alpha$. To find its minimum, $E_{\\text{approx}}^{\\min}$, on the interval $\\alpha \\in [0,1]$, we analyze its derivative with respect to $\\alpha$:\n$$\\frac{dE_{\\text{approx}}}{d\\alpha} = -4c\\alpha + 2c - \\Delta$$\nSetting the derivative to zero yields the extremum at $\\alpha_{ext} = \\frac{2c-\\Delta}{4c} = \\frac{1}{2} - \\frac{\\Delta}{4c}$, for $c \\neq 0$. The nature of this extremum depends on the second derivative, $\\frac{d^2E_{\\text{approx}}}{d\\alpha^2} = -4c$.\n\n- If $c \\geq 0$, the function is concave or linear. The minimum on $[0,1]$ must be at an endpoint, $\\alpha=0$ or $\\alpha=1$. At these integer occupations, the $c \\cdot n_i(1-n_i)$ terms are zero, so $E_{\\text{approx}}^{\\min} = E_{\\text{exact}}^{\\min}$. Thus, for $c \\geq 0$, the delocalization error is $\\Delta E_{\\text{charge}} = 0$.\n- If $c  0$, the function is convex, and $\\alpha_{ext}$ corresponds to a minimum. The minimum value on the interval $[0,1]$ is found by evaluating $E_{\\text{approx}}(\\alpha)$ at $\\alpha^* = \\max(0, \\min(1, \\alpha_{ext}))$. Let this minimum value be $E_{\\text{approx}}^{\\min}$.\n\nThe delocalization error is then calculated as $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$.\n\nSecond, we analyze the fractional-spin error, $\\Delta E_{\\text{spin}}$, for the two-electron system ($H_2$ model). The problem specifies a total occupation of one electron per site, $n_A = 1$ and $n_B = 1$. The state under consideration is a non-polarized spin ensemble defined by local occupations $n_{A\\uparrow}=n_{A\\downarrow}=1/2$ and $n_{B\\uparrow}=n_{B\\downarrow}=1/2$.\n\nThe exact energy is independent of the spin distribution for a fixed integer occupation. It is given by the sum of the linear site energies:\n$$E_{\\text{exact}} = -I_A n_A - I_B n_B = -I_A(1) - I_B(1) = -(I + \\Delta/2) - (I - \\Delta/2) = -2I$$\n\nThe approximate energy is calculated using the full site energy expression, $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i) + s \\, n_{i\\uparrow}n_{i\\downarrow}$.\nFor each site $i \\in \\{A, B\\}$, since $n_i=1$, the charge-curvature term $c \\, n_i(1-n_i)$ is zero. The spin-curvature term for each site is $s \\, n_{i\\uparrow}n_{i\\downarrow} = s(1/2)(1/2) = s/4$.\nThe total approximate energy is:\n$$E_{\\text{approx}} = \\sum_{i \\in \\{A,B\\}} \\left(-I_i(1) + c(1)(0) + s/4 \\right) = (-I_A + s/4) + (-I_B + s/4) = -2I + s/2$$\n\nThe fractional-spin error is the difference between the approximate and exact energies for this state:\n$$\\Delta E_{\\text{spin}} = E_{\\text{approx}} - E_{\\text{exact}} = (-2I + s/2) - (-2I) = s/2$$\nThis error is determined solely by the spin-curvature parameter $s$, as designed by the model.\n\nThese derived formulae are implemented below to compute the diagnostics for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates delocalization and fractional-spin errors for a two-site model\n    of a diatomic molecule in the dissociation limit, based on concepts from\n    Kohn-Sham DFT.\n    \"\"\"\n    test_cases = [\n        # (I, c, s, Delta)\n        # Case 1: symmetric, clear delocalization and spin errors\n        (0.5, -0.20, 0.30, 0.0),\n        # Case 2: mild asymmetry\n        (0.5, -0.10, 0.20, 0.15),\n        # Case 3: no charge curvature\n        (0.5, 0.0, 0.25, 0.0),\n        # Case 4: strong charge curvature, strong asymmetry, no spin curvature\n        (0.5, -0.50, 0.0, 0.60),\n    ]\n\n    all_results = []\n    \n    for I, c, s, delta in test_cases:\n        # --- Part 1: Fractional-charge delocalization error (Delta E_charge) ---\n\n        # The exact minimum energy for the one-electron system is determined by\n        # the electron localizing on the more favorable site.\n        E_exact_min = -(I + abs(delta) / 2.0)\n        \n        delta_E_charge = 0.0\n        if c  0:\n            # For c  0, the approximate energy function is convex and may have a\n            # minimum at a fractional charge distribution.\n            # The vertex of the quadratic E_approx(alpha) is at:\n            alpha_ext = 0.5 - delta / (4.0 * c)\n            \n            # The minimum on the interval [0, 1] is at alpha_ext if it falls\n            # within the interval, otherwise it's at the boundary.\n            alpha_star = np.clip(alpha_ext, 0.0, 1.0)\n            \n            # The total approximate energy is E_approx = E_exact + correction.\n            # E_exact(alpha) = -I - delta*alpha + delta/2\n            E_exact_at_alpha_star = -I - delta * alpha_star + delta / 2.0\n            correction_term = 2.0 * c * alpha_star * (1.0 - alpha_star)\n            E_approx_min = E_exact_at_alpha_star + correction_term\n            \n            delta_E_charge = E_approx_min - E_exact_min\n        \n        # --- Part 2: Fractional-spin error (Delta E_spin) ---\n        \n        # This error is calculated for a two-electron system (one per site)\n        # with a half-and-half spin mixture on each site.\n        # The error evaluates to s/2.\n        delta_E_spin = s / 2.0\n        \n        all_results.append([delta_E_charge, delta_E_spin])\n\n    # --- Final Output Formatting ---\n    # The output must be a single line, formatted as a list of lists of floats,\n    # with each float rounded to six decimal places.\n    # Ex: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\n    \n    formatted_pairs = []\n    for res_pair in all_results:\n        # The :.6f format specifier handles both rounding and padding with zeros.\n        formatted_pairs.append(f\"[{res_pair[0]:.6f},{res_pair[1]:.6f}]\")\n    \n    final_output = f\"[{','.join(formatted_pairs)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}