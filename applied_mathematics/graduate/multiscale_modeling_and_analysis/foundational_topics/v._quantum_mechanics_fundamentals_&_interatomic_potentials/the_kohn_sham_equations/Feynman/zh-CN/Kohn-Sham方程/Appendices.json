{
    "hands_on_practices": [
        {
            "introduction": "在深入研究密度泛函理论的近似方法之前，理解科恩-沈（Kohn-Sham）形式主义的精确性质至关重要。这个练习通过探索最简单的单电子系统，揭示了对交换相关泛函的一个基本要求。 这个思想实验迫使我们直面“自相互作用”的概念，并展示了精确泛函必须如何表现，才能使科恩-沈理论在这个简单极限下与薛定谔方程等价。",
            "id": "1407873",
            "problem": "密度泛函理论（DFT）的Kohn-Sham方法为近似计算多电子体系的电子结构提供了一种强有力的方法。它通过将复杂的相互作用体系映射到一个产生相同基态电子密度 $n(\\mathbf{r})$ 的虚拟无相互作用电子体系来实现这一点。\n\n在Kohn-Sham形式中，对于给定的电子密度 $n(\\mathbf{r})$，总基态能量由能量泛函表示：\n$$E_{KS}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\n在此， $T_s[n]$ 是无相互作用参考体系的动能， $E_{ext}[n] = \\int v_{ext}(\\mathbf{r}) n(\\mathbf{r}) d\\mathbf{r}$ 是由外势 $v_{ext}(\\mathbf{r})$（通常是电子-原子核吸引）引起的能量， $J[n]$ 是电子密度与其自身的经典库仑排斥能（哈特里能量），而 $E_{xc}[n]$ 是交换相关能，它包含了所有剩余的量子力学效应。\n\n单电子Kohn-Sham方程通过有效势 $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r})$ 求解，其中哈特里势 $v_H(\\mathbf{r})$ 和交换相关势 $v_{xc}(\\mathbf{r})$ 分别是 $J[n]$ 和 $E_{xc}[n]$ 对密度 $n(\\mathbf{r})$ 的泛函导数。\n\nDFT的一个基本原理是，对于精确的交换相关泛函，在真实基态密度下计算的总能量 $E_{KS}[n]$ 必须等于体系的真实基态能量。\n\n考虑一个简单的单电子体系（例如氢原子或类氢离子）。对于这样的体系，定态薛定谔方程可以精确求解，并且没有电子-电子相互作用。如果Kohn-Sham DFT形式对于该体系是精确的，那么交换相关势 $v_{xc}(\\mathbf{r})$ 和哈特里势 $v_{H}(\\mathbf{r})$ 之間必须满足什么特定的关系？\n\nA) $v_{xc}(\\mathbf{r}) = v_{H}(\\mathbf{r})$\n\nB) $v_{xc}(\\mathbf{r}) = -v_{H}(\\mathbf{r})$\n\nC) $v_{xc}(\\mathbf{r}) = 0$\n\nD) $v_{xc}(\\mathbf{r}) = -v_{ext}(\\mathbf{r})$\n\nE) 在不选择交换相关泛函的具体近似的情况下，无法确定该关系。",
            "solution": "目标是确定在Kohn-Sham密度泛函理论（DFT）形式能够得到精确基态能量的条件下，单电子体系中交换相关势 $v_{xc}(\\mathbf{r})$ 和哈特里势 $v_H(\\mathbf{r})$ 之间的关系。\n\n步骤 1：写下单电子体系的精确基态能量。\n对于只有一个电子的体系，定态薛定谔方程为：\n$$ \\left( -\\frac{\\hbar^2}{2m_e}\\nabla^2 + v_{ext}(\\mathbf{r}) \\right) \\psi(\\mathbf{r}) = E_{true} \\psi(\\mathbf{r}) $$\n真实基态能量 $E_{true}$ 是哈密顿量的期望值，该哈密顿量仅由动能算符 $\\hat{T}$ 和外势能算符 $\\hat{V}_{ext}$ 组成。没有电子-电子相互作用项。\n$$E_{true} = \\langle \\psi | \\hat{T} + \\hat{V}_{ext} | \\psi \\rangle$$\n\n步骤 2：写下Kohn-Sham能量泛函。\n如问题陈述中所给，Kohn-Sham能量泛函为：\n$$E_{KS}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\n\n步骤 3：应用DFT必须精确的条件。\n问题陈述指出，对于精确的泛函，在真实基态电子密度 $n(\\mathbf{r}) = |\\psi(\\mathbf{r})|^2$ 下计算的Kohn-Sham表达式的能量必须等于体系的真实能量。\n$$E_{KS}[n] = E_{true}$$\n\n步骤 4：分析单电子体系的Kohn-Sham泛函的各项。\n- **动能：** Kohn-Sham动能 $T_s[n]$ 定义为一个无相互作用电子体系的动能。由于单电子体系没有其他电子与之相互作用，它本质上就是一个“无相互作用”体系。因此，其真实动能与Kohn-Sham无相互作用动能相同：$T_{true} = T_s[n]$。\n- **外势能：** 与外势（原子核）的相互作用在真实体系和Kohn-Sham描述中是相同的：$V_{ext, true} = E_{ext}[n]$。\n\n步骤 5：使能量表达式相等并简化。\n体系的真实能量是 $E_{true} = T_{true} + V_{ext, true}$。使用步骤 4 中的等价关系，我们可以将其写为 $E_{true} = T_s[n] + E_{ext}[n]$。\n现在，我们将其与完整的Kohn-Sham能量表达式相等：\n$$T_s[n] + E_{ext}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\n从两边减去 $T_s[n] + E_{ext}[n]$ 揭示了对其余各项的一个关键约束：\n$$0 = J[n] + E_{xc}[n]$$\n这意味着对于单电子体系，精确的交换相关能必须恰好是哈特里能量的负值：\n$$E_{xc}[n] = -J[n]$$\n这是一个精确条件。哈特里能量 $J[n]$ 代表了电子电荷密度与其自身的虚假自相互作用，这在单个电子的真实量子力学描述中是不存在的。因此，交换相关能 $E_{xc}[n]$ 必须精确地抵消这个非物理的自相互作用项。\n\n步骤 6：将能量泛函与其对应的势联系起来。\n哈特里势 $v_H(\\mathbf{r})$ 和交换相关势 $v_{xc}(\\mathbf{r})$ 定义为它们各自的能量泛函对电子密度 $n(\\mathbf{r})$ 的泛函导数：\n$$v_H(\\mathbf{r}) = \\frac{\\delta J[n]}{\\delta n(\\mathbf{r})}$$\n$$v_{xc}(\\mathbf{r}) = \\frac{\\delta E_{xc}[n]}{\\delta n(\\mathbf{r})}$$\n对关系式 $E_{xc}[n] = -J[n]$ 关于 $n(\\mathbf{r})$ 取泛函导数，得到：\n$$\\frac{\\delta E_{xc}[n]}{\\delta n(\\mathbf{r})} = -\\frac{\\delta J[n]}{\\delta n(\\mathbf{r})}$$\n代入势的定义，我们得到最终关系：\n$$v_{xc}(\\mathbf{r}) = -v_H(\\mathbf{r})$$\n\n这个结果表明，对于单电子体系，交换相关势必须精确地抵消哈特里势（自相互作用势）。这确保了总的Kohn-Sham有效势 $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r})$ 简化为 $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r})$。因此，单电子体系的Kohn-Sham方程在数学上变得与薛定谔方程完全相同，从而正确地得出精确的能量和波函数。\n\n基于此推导，正确选项是 B。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在研究了单电子系统中的精确条件后，我们的实践转向一个简单的多电子原子——氦。 在这里，我们从抽象的原则转向具体的计算，推导科恩-沈有效势的两个关键组成部分：来自原子核的外势 $v_{ext}(\\mathbf{r})$ 和经典的电子-电子排斥（哈特里）势 $v_H(\\mathbf{r})$。这项练习提供了从给定的电子密度构建势函数所需的积分计算的实践经验。",
            "id": "1407884",
            "problem": "在科恩-沈密度泛函理论 (DFT) 的框架下，一个多电子体系中电子所感受到的有效势由几个组分构成。本题涉及一个中性氦原子的简化模型中的其中两个组分。\n\n考虑一个孤立的中性氦原子，其原子核（电荷为 $+2e$）固定在原点。在此模型中，两个电子的总电子密度 $n(r)$ 由以下球对称函数近似：\n$$n(r) = \\frac{2\\zeta^3}{\\pi} \\exp(-2\\zeta r)$$\n其中 $r$ 是与原子核的径向距离，$\\zeta$ 是一个量纲为长度倒数的正常数，$e$ 是元电荷，$\\pi$ 是数学常数。\n\n有效科恩-沈势 $v_{eff}(\\mathbf{r})$ 包括外势 $v_{ext}(\\mathbf{r})$ 和哈特里势 $v_H(\\mathbf{r})$。\n外势 $v_{ext}(\\mathbf{r})$ 代表电子因与原子核相互作用而产生的静电势能。\n哈特里势 $v_H(\\mathbf{r})$ 描述了电子因受到总电子密度分布的排斥而产生的经典静电势能。它由以下表达式给出：\n$$v_H(\\mathbf{r}) = \\frac{e^2}{4\\pi\\epsilon_0} \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d^3\\mathbf{r}'$$\n其中 $\\epsilon_0$ 是真空介电常数。\n\n由于问题的球对称性，这两个势都将只依赖于径向距离 $r$。你的任务是确定外势 $v_{ext}(r)$ 和哈特里势 $v_H(r)$ 的显式数学表达式。\n\n请按顺序给出 $v_{ext}(r)$ 和 $v_H(r)$ 的答案，表示为 $r$、$\\zeta$、$e$ 和 $\\epsilon_0$ 的解析表达式。",
            "solution": "外势 $v_{ext}(r)$ 是电子因位于原点的电荷为 $+2e$ 的原子核而产生的静电势能。原子核产生的静电势为 $\\phi_{\\text{nuc}}(r) = \\frac{1}{4\\pi\\epsilon_{0}} \\frac{2e}{r}$。电荷为 $-e$ 的电子在此势中的势能为\n$$\nv_{ext}(r) = (-e)\\,\\phi_{\\text{nuc}}(r) = -\\frac{2 e^{2}}{4\\pi\\epsilon_{0}\\,r}.\n$$\n\n对于哈特里势，从给定的表达式开始\n$$\nv_{H}(\\mathbf{r}) = \\frac{e^{2}}{4\\pi\\epsilon_{0}} \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}'.\n$$\n利用球对称性，使用标准恒等式可将其简化为径向积分\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 4\\pi\\left[\\frac{1}{r}\\int_{0}^{r} r'^{2} n(r')\\,dr' + \\int_{r}^{\\infty} r' n(r')\\,dr'\\right].\n$$\n代入 $n(r') = A \\exp(-a r')$，其中 $A = \\frac{2\\zeta^{3}}{\\pi}$ 且 $a = 2\\zeta$。定义\n$$\nI_{1}(r) = \\int_{0}^{r} r'^{2} \\exp(-a r')\\,dr', \\qquad I_{2}(r) = \\int_{r}^{\\infty} r' \\exp(-a r')\\,dr'.\n$$\n计算这些积分，\n$$\nI_{1}(r) = \\left[\\exp(-a r')\\left(-\\frac{r'^{2}}{a} - \\frac{2 r'}{a^{2}} - \\frac{2}{a^{3}}\\right)\\right]_{0}^{r} = \\frac{2}{a^{3}} - \\exp(-a r)\\left(\\frac{r^{2}}{a} + \\frac{2 r}{a^{2}} + \\frac{2}{a^{3}}\\right),\n$$\n$$\nI_{2}(r) = \\left[\\exp(-a r')\\left(-\\frac{r'}{a} - \\frac{1}{a^{2}}\\right)\\right]_{r}^{\\infty} = \\exp(-a r)\\left(\\frac{r}{a} + \\frac{1}{a^{2}}\\right).\n$$\n因此，\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 4\\pi A\\left[\\frac{1}{r} I_{1}(r) + I_{2}(r)\\right].\n$$\n使用 $4\\pi A = 8\\zeta^{3}$ 和 $a = 2\\zeta$，化简\n$$\n\\frac{1}{r} I_{1}(r) + I_{2}(r) = \\frac{2}{a^{3} r} - \\exp(-a r)\\left(\\frac{1}{a^{2}} + \\frac{2}{a^{3} r}\\right),\n$$\n所以\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 8\\zeta^{3}\\left[\\frac{2}{a^{3} r} - \\exp(-a r)\\left(\\frac{1}{a^{2}} + \\frac{2}{a^{3} r}\\right)\\right].\n$$\n代入 $a=2\\zeta$ 得到\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = \\frac{2}{r} - e^{-2\\zeta r} \\left(2\\zeta + \\frac{2}{r}\\right) = -2\\zeta\\,\\exp(-2\\zeta r) + \\frac{2\\left(1 - \\exp(-2\\zeta r)\\right)}{r}.\n$$\n因此，\n$$\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[-2\\zeta\\,\\exp(-2\\zeta r) + \\frac{2\\left(1 - \\exp(-2\\zeta r)\\right)}{r}\\right].\n$$\n一个等价的紧凑形式是\n$$\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\,\\frac{2}{r}\\left[1 - \\left(1 + \\zeta r\\right)\\exp(-2\\zeta r)\\right].\n$$\n两种形式在代数上是等同的。\n\n因此，所需的解析表达式为\n$$\nv_{ext}(r) = -\\frac{2 e^{2}}{4\\pi\\epsilon_{0}\\,r}, \\qquad\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[-2\\zeta\\,\\exp(-2\\zeta r) + \\frac{2\\left(1 - \\exp(-2\\zeta r)\\right)}{r}\\right].\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{2 e^{2}}{4\\pi\\epsilon_{0}\\,r}  \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[-2\\zeta\\,\\exp(-2\\zeta r) + \\frac{2\\left(1 - \\exp(-2\\zeta r)\\right)}{r}\\right]\\end{pmatrix}}$$"
        },
        {
            "introduction": "本练习在前一个练习引入的自相互作用误差概念的基础上，引入一个模型来量化常见近似密度泛函的失效之处。 它探讨了将这些近似应用于拉伸分子时出现的两个关键问题——离域误差（与分数电荷有关）和静态相关误差（与分数自旋有关）。这项高级实践有助于深入理解精确密度泛函理论的“平面条件”以及违反这些条件如何导致重大的定性误差，这是现代泛函发展的核心课题。",
            "id": "2815502",
            "problem": "考虑一个用于拉伸双原子分子的双位点、每位点单轨道解离极限模型，该模型旨在捕捉科恩-沈密度泛函理论（Kohn-Sham DFT）中自相互作用和离域的基本特征。您将通过比较一个简化的精确参考（与系综密度泛函理论一致）和一个违反精确平直平面条件的玩具近似泛函，来为多电子自相互作用误差建立一个定量诊断工具。在原子单位（哈特里）下进行计算，因此所有能量都必须以哈特里为单位报告。\n\n基本和建模假设：\n- 霍亨伯格-科恩定理和系综密度泛函理论意味着基态能量随总电子数的变化呈精确的分段线性，并且对于简并自旋态的系综，能量是恒定的。在此解离极限模型中，每个位点最多容纳一个电子。\n- 对于一个带单个电子的孤立位点，精确的位点能量随占据数呈线性关系：如果位点上的总占据数为 $n \\in [0,1]$，则精确的位点贡献为 $-I \\, n$，其中 $I$ 是相应原子的第一电离能。对于原子单位下的氢， $I \\approx 0.5$。\n- 位点不对称性通过能量偏置 $\\Delta$（单位为哈特里）进行建模，因此位点 $A$ 上的单电子能量为 $-I_{A} = -(I + \\Delta/2)$，位点 $B$ 上的单电子能量为 $-I_{B} = -(I - \\Delta/2)$。正的 $\\Delta$ 使位点 $A$ 更有利。\n- 典型近似密度泛函的多电子自相互作用和离域误差由两个标量误差系数建模：\n  1. 一个电荷曲率系数 $c$（单位为哈特里），每个位点乘以 $n(1-n)$，该项在整数占据数时为零，在 $n = 1/2$ 时达到最大值。负的 $c$ 会导致在整数点之间的直线下方出现凸性偏差，从而有利于离域的分数电荷。\n  2. 一个自旋曲率系数 $s$（单位为哈特里），每个位点乘以 $n_{\\uparrow} n_{\\downarrow}$，该项对于纯自旋密度为零，在等量自旋混合时达到最大值。正的 $s$ 会对分数自旋系综施加惩罚，在自旋各占一半的混合态处产生一个错误的能量最大值。\n- 在解离极限下，对于定域轨道，无相互作用的动能贡献可以忽略不计，并且在精确参考中，对于每位点一个电子的情况，哈特里项和精确交换项会精确抵消自相互作用。因此，我们忽略上述模型校正之外的动能项和显式的电子-电子项。\n\n定义和任务：\n- 令位点上的自旋占据数为 $n_{A\\uparrow}$、$n_{A\\downarrow}$ 以及 $n_{B\\uparrow}$、$n_{B\\downarrow}$。对于每个位点 $i \\in \\{A,B\\}$，总占据数为 $n_i = n_{i\\uparrow} + n_{i\\downarrow}$，在解离极限下有 $0 \\le n_i \\le 1$。\n- 精确位点能量模型为 $E_{\\text{exact},i} = -I_i \\, n_i$，总精确能量为 $E_{\\text{exact}} = \\sum_i E_{\\text{exact},i}$。\n- 玩具近似位点能量为 $E_{\\text{approx},i} = -I_i \\, n_i + c \\, n_i (1 - n_i) + s \\, n_{i\\uparrow} n_{i\\downarrow}$，总近似能量为 $E_{\\text{approx}} = \\sum_i E_{\\text{approx},i}$。\n\n您的程序必须针对测试套件中提供的每组参数 $(I, c, s, \\Delta)$，计算两个以哈特里为单位的诊断量：\n1. 拉伸的 $H_2^+$（总共一个电子）的分数电荷离域误差：\n   - 用总占据数 $n_A + n_B = 1$ 来建模单电子系统。为分离分数电荷效应，假设每个位点都是纯自旋密度，即对于 $i \\in \\{A,B\\}$，都有 $n_{i\\downarrow} = 0$ 和 $n_{i\\uparrow} = n_i$。\n   - 令 $\\alpha \\in [0,1]$ 表示位点 $A$ 上的电子分数，因此 $n_A = \\alpha$ 且 $n_B = 1 - \\alpha$。\n   - 精确的最低能量是整数定域时两个位点线性能量中较低的那个。近似的最低能量通过在 $\\alpha \\in [0,1]$ 上最小化总近似能量得到。\n   - 定义离域误差为 $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$（单位为哈特里）。负的 $\\Delta E_{\\text{charge}}$ 表示虚假的能量降低（离域误差）。\n2. 拉伸的 $H_2$（总共两个电子）的分数自旋误差：\n   - 在解离极限下，强制每个位点有一个电子，即 $n_A = n_B = 1$。\n   - 考虑一个在每个位点上都有自旋各占一半混合的系综，但其局域极化相反以产生总 $S_z = 0$：在位点 $A$ 上，取 $n_{A\\uparrow} = 1/2$ 和 $n_{A\\downarrow} = 1/2$，而在位点 $B$ 上，取 $n_{B\\uparrow} = 1/2$ 和 $n_{B\\downarrow} = 1/2$。\n   - 精确能量与分数自旋无关，等于 $n_A = n_B = 1$ 时线性位点能量的总和。近似能量包括自旋曲率项。\n   - 定义分数自旋误差为 $\\Delta E_{\\text{spin}} = E_{\\text{approx}}(\\text{自旋各半混合}) - E_{\\text{exact}}$（单位为哈特里）。正的 $\\Delta E_{\\text{spin}}$ 表示在分数自旋处存在错误的能量升高。\n\n不涉及角度单位。所有输出均为以哈特里为单位的能量。将报告的每个浮点数四舍五入到六位小数。\n\n测试套件：\n- 情况1（对称，具有明显的离域和自旋误差）：$I = 0.5$, $c = -0.20$, $s = 0.30$, $\\Delta = 0.0$。\n- 情况2（轻度不对称）：$I = 0.5$, $c = -0.10$, $s = 0.20$, $\\Delta = 0.15$。\n- 情况3（无电荷曲率）：$I = 0.5$, $c = 0.0$, $s = 0.25$, $\\Delta = 0.0$。\n- 情况4（强电荷曲率，强不对称性，无自旋曲率）：$I = 0.5$, $c = -0.50$, $s = 0.0$, $\\Delta = 0.60$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含测试用例的结果，格式为方括号括起来的逗号分隔列表。此列表的每个元素对应一个测试用例，并且本身必须是 $[\\Delta E_{\\text{charge}}, \\Delta E_{\\text{spin}}]$ 顺序的双元素列表。例如，打印的行必须类似于：[[x1,y1],[x2,y2],[x3,y3],[x4,y4]]，其中每个 $x_i$ 和 $y_i$ 是以哈特里为单位、四舍五入到六位小数的浮点数。",
            "solution": "问题陈述在科学上是适定的、完整的，并且不包含任何矛盾。它描述了一个在理论化学中用于分析和理解密度泛函理论中自相互作用误差的有效且常见的玩具模型。因此，我们将着手推导所要求的两个误差诊断量。\n\n首先，我们分析单电子系统的分数电荷离域误差 $\\Delta E_{\\text{charge}}$，该系统作为拉伸 $H_2^+$ 的模型。总电子数为 $1$。电子的分布由参数 $\\alpha$ 描述，其中位点 $A$ 的占据数为 $n_A = \\alpha$，位点 $B$ 的占据数为 $n_B = 1-\\alpha$，且 $\\alpha \\in [0,1]$。位点电离能定义为 $I_A = I + \\Delta/2$ 和 $I_B = I - \\Delta/2$。\n\n总精确能量是 $\\alpha$ 的一个线性函数：\n$$E_{\\text{exact}}(\\alpha) = -I_A n_A - I_B n_B = -(I + \\Delta/2)\\alpha - (I - \\Delta/2)(1-\\alpha) = -I - \\Delta\\alpha + \\Delta/2$$\n线性函数在闭区间 $[0,1]$ 上的最小值必定出现在端点处。因此，最小精确能量为：\n$$E_{\\text{exact}}^{\\min} = \\min(E_{\\text{exact}}(0), E_{\\text{exact}}(1)) = \\min(-I_B, -I_A) = \\min(-(I-\\Delta/2), -(I+\\Delta/2)) = -(I + |\\Delta|/2)$$\n\n对于这个单电子系统，问题指定了纯自旋密度（$n_{i\\downarrow}=0$），因此位点 $i$ 上的近似能量为 $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i)$，因为自旋曲率项 $s \\, n_{i\\uparrow}n_{i\\downarrow}$ 为零。总近似能量是两个位点的总和：\n$$E_{\\text{approx}}(\\alpha) = \\left[-I_A \\alpha + c\\alpha(1-\\alpha)\\right] + \\left[-I_B(1-\\alpha) + c(1-\\alpha)\\alpha\\right]$$\n$$E_{\\text{approx}}(\\alpha) = E_{\\text{exact}}(\\alpha) + 2c\\alpha(1-\\alpha) = -2c\\alpha^2 + (2c-\\Delta)\\alpha - I + \\Delta/2$$\n这是 $\\alpha$ 的一个二次函数。为了在区间 $\\alpha \\in [0,1]$ 上找到其最小值 $E_{\\text{approx}}^{\\min}$，我们分析它对 $\\alpha$ 的导数：\n$$\\frac{dE_{\\text{approx}}}{d\\alpha} = -4c\\alpha + 2c - \\Delta$$\n令导数为零可得极值点在 $\\alpha_{ext} = \\frac{2c-\\Delta}{4c} = \\frac{1}{2} - \\frac{\\Delta}{4c}$ 处（对于 $c \\neq 0$）。该极值的性质取决于二阶导数 $\\frac{d^2E_{\\text{approx}}}{d\\alpha^2} = -4c$。\n\n- 如果 $c \\geq 0$，函数是凹的或线性的。在 $[0,1]$ 上的最小值必定在端点 $\\alpha=0$ 或 $\\alpha=1$ 处。在这些整数占据数下，$c \\cdot n_i(1-n_i)$ 项为零，所以 $E_{\\text{approx}}^{\\min} = E_{\\text{exact}}^{\\min}$。因此，对于 $c \\geq 0$，离域误差 $\\Delta E_{\\text{charge}} = 0$。\n- 如果 $c  0$，函数是凸的，$\\alpha_{ext}$ 对应一个最小值。区间 $[0,1]$ 上的最小值通过计算在 $\\alpha^* = \\max(0, \\min(1, \\alpha_{ext}))$ 处的 $E_{\\text{approx}}(\\alpha)$ 得到。设这个最小值为 $E_{\\text{approx}}^{\\min}$。\n\n然后，离域误差计算为 $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$。\n\n第二，我们分析双电子系统（$H_2$ 模型）的分数自旋误差 $\\Delta E_{\\text{spin}}$。问题指定每个位点的总占据数为一个电子，即 $n_A = 1$ 和 $n_B = 1$。所考虑的状态是一个非极化自旋系综，由局域占据数 $n_{A\\uparrow}=n_{A\\downarrow}=1/2$ 和 $n_{B\\uparrow}=n_{B\\downarrow}=1/2$ 定义。\n\n对于固定的整数占据数，精确能量与自旋分布无关。它由线性位点能量的总和给出：\n$$E_{\\text{exact}} = -I_A n_A - I_B n_B = -I_A(1) - I_B(1) = -(I + \\Delta/2) - (I - \\Delta/2) = -2I$$\n\n近似能量使用完整的位点能量表达式 $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i) + s \\, n_{i\\uparrow}n_{i\\downarrow}$ 进行计算。对于每个位点 $i \\in \\{A, B\\}$，由于 $n_i=1$，电荷曲率项 $c \\, n_i(1-n_i)$ 为零。每个位点的自旋曲率项为 $s \\, n_{i\\uparrow}n_{i\\downarrow} = s(1/2)(1/2) = s/4$。总近似能量为：\n$$E_{\\text{approx}} = \\sum_{i \\in \\{A,B\\}} \\left(-I_i(1) + c(1)(0) + s/4 \\right) = (-I_A + s/4) + (-I_B + s/4) = -2I + s/2$$\n\n该状态的分数自旋误差是近似能量与精确能量之差：\n$$\\Delta E_{\\text{spin}} = E_{\\text{approx}} - E_{\\text{exact}} = (-2I + s/2) - (-2I) = s/2$$ 正如模型所设计的，此误差仅由自旋曲率参数 $s$ 决定。\n\n下面将实现这些推导出的公式，以计算每个测试用例的诊断量。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates delocalization and fractional-spin errors for a two-site model\n    of a diatomic molecule in the dissociation limit, based on concepts from\n    Kohn-Sham DFT.\n    \"\"\"\n    test_cases = [\n        # (I, c, s, Delta)\n        # Case 1: symmetric, clear delocalization and spin errors\n        (0.5, -0.20, 0.30, 0.0),\n        # Case 2: mild asymmetry\n        (0.5, -0.10, 0.20, 0.15),\n        # Case 3: no charge curvature\n        (0.5, 0.0, 0.25, 0.0),\n        # Case 4: strong charge curvature, strong asymmetry, no spin curvature\n        (0.5, -0.50, 0.0, 0.60),\n    ]\n\n    all_results = []\n    \n    for I, c, s, delta in test_cases:\n        # --- Part 1: Fractional-charge delocalization error (Delta E_charge) ---\n\n        # The exact minimum energy for the one-electron system is determined by\n        # the electron localizing on the more favorable site.\n        E_exact_min = -(I + abs(delta) / 2.0)\n        \n        delta_E_charge = 0.0\n        if c  0:\n            # For c  0, the approximate energy function is convex and may have a\n            # minimum at a fractional charge distribution.\n            # The vertex of the quadratic E_approx(alpha) is at:\n            alpha_ext = 0.5 - delta / (4.0 * c)\n            \n            # The minimum on the interval [0, 1] is at alpha_ext if it falls\n            # within the interval, otherwise it's at the boundary.\n            alpha_star = np.clip(alpha_ext, 0.0, 1.0)\n            \n            # The total approximate energy is E_approx = E_exact + correction.\n            # E_exact(alpha) = -I - delta*alpha + delta/2\n            E_exact_at_alpha_star = -I - delta * alpha_star + delta / 2.0\n            correction_term = 2.0 * c * alpha_star * (1.0 - alpha_star)\n            E_approx_min = E_exact_at_alpha_star + correction_term\n            \n            delta_E_charge = E_approx_min - E_exact_min\n        \n        # --- Part 2: Fractional-spin error (Delta E_spin) ---\n        \n        # This error is calculated for a two-electron system (one per site)\n        # with a half-and-half spin mixture on each site.\n        # The error evaluates to s/2.\n        delta_E_spin = s / 2.0\n        \n        all_results.append([delta_E_charge, delta_E_spin])\n\n    # --- Final Output Formatting ---\n    # The output must be a single line, formatted as a list of lists of floats,\n    # with each float rounded to six decimal places.\n    # Ex: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\n    \n    formatted_pairs = []\n    for res_pair in all_results:\n        # The :.6f format specifier handles both rounding and padding with zeros.\n        formatted_pairs.append(f\"[{res_pair[0]:.6f},{res_pair[1]:.6f}]\")\n    \n    final_output = f\"[{','.join(formatted_pairs)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}