## 引言
在计算化学和材料科学领域，分子的几何结构是决定其[物理化学](@entry_id:145220)性质和反应活性的根本。然而，如何从量子力学第一性原理出发，精确预测原子在三维空间中的稳定排布，是一个核心的挑战。使用量子力学（QM）方法的[几何优化](@entry_id:151817)正是解决这一问题的关键技术，它将抽象的薛定谔方程与可观测的分子结构和能量联系起来，为我们探索微观世界提供了强大的计算工具。本文旨在系统性地剖析QM几何优化的理论基础、核心算法与广泛应用。

本文分为三个核心章节，旨在为读者构建一个从理论到实践的完整知识框架。在“原理与机制”一章中，我们将深入探讨[势能面](@entry_id:143655)、原子间作用力以及Hessian矩阵等基本概念，并解析导航这一复杂“地形”的现代[优化算法](@entry_id:147840)。接下来，“应用与跨学科交叉”一章将展示这些工具如何在化学[反应机理](@entry_id:149504)探索、新[材料设计](@entry_id:160450)、生物大分子模拟等前沿研究中发挥关键作用。最后，“动手实践”部分提供了一系列精心设计的问题，旨在加深读者对关键算法和实际挑战的理解。通过这一结构化的学习路径，读者将掌握QM[几何优化](@entry_id:151817)的精髓，并了解如何应用它来解决真实的科学问题。

## 原理与机制

几何优化是量子力学（QM）计算的核心任务之一，其目标是在[势能面](@entry_id:143655)上定位原子核的稳定构型。这一过程遵循一系列明确的物理原理，并依赖于高效的数值算法。本章将深入探讨控制几何优化的基本原理和关键机制，从[势能面](@entry_id:143655)的概念到用于导航该表面的先进算法。

### [势能面](@entry_id:143655)：优化的理论基础

在量子力学计算中，分子[几何优化](@entry_id:151817)的基础是**玻恩-奥本海默（Born-Oppenheimer, BO）近似**。该近似源于原子核质量（$M_{\alpha}$）远大于电子质量（$m_e$）这一物理事实。由于质量差异悬殊，可以认为原子核的运动相对于电子而言非常缓慢。因此，在任何给定的原子核构型 $\mathbf{R}$ 下，电子都能够瞬时地调整到它们的量子基态（或某个激发态）。

这种思想分离了电子和原子核的运动。对于一个固定的原子核构型 $\mathbf{R}$，我们可以求解电子的定态薛定谔方程：
$$
\hat{H}_e(\mathbf{r};\mathbf{R})\,\psi_k(\mathbf{r};\mathbf{R}) = \epsilon_k(\mathbf{R})\,\psi_k(\mathbf{r};\mathbf{R})
$$
其中，$\mathbf{r}$ 代表所有电子的坐标，$\hat{H}_e$ 是电子哈密顿算符，它包括电子[动能算符](@entry_id:265633) $\hat{T}_e$、电子-电子[库仑排斥](@entry_id:181876)算符 $\hat{V}_{ee}$ 以及电子-原子核库仑吸引算符 $\hat{V}_{eN}$。重要的是，$\hat{H}_e$ 将原子核坐标 $\mathbf{R}$ 视为参数。求解该方程会得到一系列电子本征态 $\psi_k$ 和相应的电子[能量本征值](@entry_id:144381) $\epsilon_k(\mathbf{R})$。

**玻恩-奥本海默[势能面](@entry_id:143655) (Potential Energy Surface, PES)** $E_k(\mathbf{R})$ 被定义为特定电子态 $k$ 的电子能量与原子核-原子核之间的[库仑排斥](@entry_id:181876)能 $V_{NN}(\mathbf{R})$ 之和：
$$
E_k(\mathbf{R}) = \epsilon_k(\mathbf{R}) + V_{NN}(\mathbf{R})
$$
对于大多数化学应用，我们最关心的是电子基态，因此几何优化通常在基态[势能面](@entry_id:143655) $E(\mathbf{R}) \equiv E_0(\mathbf{R})$ 上进行。

至关重要的是要认识到，$E(\mathbf{R})$ 并不包含原子核[动能算符](@entry_id:265633) $\hat{T}_N$。它是一个仅依赖于原子核位置 $\mathbf{R}$ 的标量函数，为原子核的运动提供了一个有效的势能场。[几何优化](@entry_id:151817)过程的本质，就是在忽略[非绝热耦合](@entry_id:198018)（即不同电子态之间的跃迁）的假设下，将原子核视为在单个、平滑的[势能面](@entry_id:143655)上移动的经典粒子，并寻找该[势能面](@entry_id:143655)上的特定点 。在零温下，这个过程简化为寻找势能 $E(\mathbf{R})$ 的[驻点](@entry_id:136617)。

### [驻点](@entry_id:136617)的识别与表征

在[势能面](@entry_id:143655)上，具有特殊物理意义的点是[驻点](@entry_id:136617)，即能量对所有核坐标的一阶导数（梯度）为零的点。这些点可以是能量极小点（稳定构型）、[一阶鞍点](@entry_id:165164)（过渡态）或更高阶的鞍点。

#### 力：[势能面](@entry_id:143655)的梯度

在物理上，势能 $E(\mathbf{R})$ 在原子核 $I$ 坐标 $\mathbf{R}_I$ 上的负梯度被定义为作用在该原子核上的**力** $\mathbf{F}_I$：
$$
\mathbf{F}_I = -\nabla_{\mathbf{R}_I} E(\mathbf{R})
$$
因此，寻找驻点的任务等同于寻找所有原子核上的[合力](@entry_id:163825)都为零的几何构型。当 $\nabla_{\mathbf{R}} E(\mathbf{R}^*) = \mathbf{0}$ 时，$\mathbf{R}^*$ 便是一个[驻点](@entry_id:136617)。

#### 曲率与稳定性：Hessian 矩阵

仅仅知道梯度为零不足以确定一个[驻点](@entry_id:136617)的性质。为此，我们必须考察[势能面](@entry_id:143655)在驻点附近的局部曲率，这由能量对核坐标的[二阶偏导数](@entry_id:635213)矩阵——**Hessian 矩阵**——来描述：
$$
H_{ij}(\mathbf{R}^*) = \frac{\partial^2 E}{\partial R_i \partial R_j}\bigg|_{\mathbf{R}^*}
$$
在[驻点](@entry_id:136617) $\mathbf{R}^*$ 附近，能量的二阶泰勒展开近似为：
$$
E(\mathbf{R}^* + \boldsymbol{\delta}) \approx E(\mathbf{R}^*) + \frac{1}{2}\,\boldsymbol{\delta}^\top \mathbf{H}(\mathbf{R}^*)\,\boldsymbol{\delta}
$$
其中 $\boldsymbol{\delta}$ 是一个微小的位移。这个二次型表达式的性质完全由 Hessian 矩阵 $\mathbf{H}$ 的本征值谱决定 。

对于一个孤立的[非线性分子](@entry_id:175085)，由于其能量在刚性平移和转动下不变，Hessian 矩阵必然有 6 个零本征值（[线性分子](@entry_id:166760)则为 5 个）。其余的 $3N-6$（或 $3N-5$）个本征值对应于分子的内部振动模式，它们的符号决定了驻点的性质：
*   **局部极小点 (Local Minimum)**：所有 $3N-6$ 个内部模式的本征值均为正。这意味着沿任何内部坐标方向的微小位移都会导致能量升高。这是稳定分子构型（反应物、产物、中间体）的特征。
*   **[一阶鞍点](@entry_id:165164) (First-Order Saddle Point)**：恰好有一个内部模式的本征值为负，其余均为正。这个负本征值对应的方向是唯一的[虚频](@entry_id:1124926)振动模式，代表了[反应路径](@entry_id:163735)。[一阶鞍点](@entry_id:165164)在物理上对应于化学反应的**过渡态**。
*   **高阶鞍点 (Higher-Order Saddle Point)**：有多个负本征值。这些点在化学中通常不具有直接的物理意义。

负本征值的数量被称为**摩尔斯指数（Morse Index）**。因此，局部极小点的摩尔斯指数为 0，过渡态的摩尔斯指数为 1。

为了具体说明这些原理，我们可以考察一个简化的[双原子分子](@entry_id:148655)模型，其势能由一个[解析函数](@entry_id:139584)给出，例如 $E(R) = A \exp(-bR) - \frac{C}{R}$，其中 $R$ 是核间距 。平衡键长 $R^*$ 是能量极小点，满足驻点条件 $\frac{dE}{dR} = 0$ 和稳定性条件 $\frac{d^2E}{dR^2} > 0$。通过求解这些方程，我们可以精确地确定稳定构型的几何参数和其稳定性（由曲率的正负号决定）。

值得注意的是，通过坐标变换，例如从[笛卡尔坐标](@entry_id:167698)变换到[质量加权坐标](@entry_id:164904)，Hessian 矩阵会发生相应的变换。根据[西尔维斯特惯性定律](@entry_id:148289)（Sylvester's law of inertia），只要[坐标变换](@entry_id:172727)是非奇异的，Hessian 矩阵的正、负、零本征值的数量（即惯性指数）保持不变。这意味着驻点的分类（极小点、鞍点等）是坐标系选择无关的物理属性 。此外，在约束条件下进行优化时，一个在全空间中的鞍点可能在受限的子空间中表现为极小点，前提是[不稳定模式](@entry_id:263056)方向位于可行子空间之外 。

### 计算力：[几何优化](@entry_id:151817)的核心引擎

既然优化算法依赖于力来确定搜索方向，那么准确而高效地计算力就变得至关重要。主要有两种方法：数值梯度和[解析梯度](@entry_id:1120999)。

#### 数值梯度 vs. [解析梯度](@entry_id:1120999)

**数值梯度**通过有限差分法[近似计算](@entry_id:1121073)。例如，使用[中心差分公式](@entry_id:139451)计算某一坐标分量上的力，需要进行两次能量计算：
$$
F_i = -\frac{\partial E}{\partial R_i} \approx -\frac{E(\mathbf{R} + h\mathbf{e}_i) - E(\mathbf{R} - h\mathbf{e}_i)}{2h}
$$
其中 $h$ 是一个很小的步长。这种方法的概念简单，易于实现。然而，其计算成本极高。对于一个包含 $N_{\text{atom}}$ 个原子的体系，计算完整的[梯度向量](@entry_id:141180)需要大约 $2 \times 3N_{\text{atom}}$ 次独立的能量计算 。此外，其精度受到[截断误差](@entry_id:140949)（与 $h^2$ 成正比）和[舍入误差](@entry_id:162651)（与 $\epsilon/h$ 成正比，其中 $\epsilon$ 是能量计算的有效精度）的权衡限制。选择过小或过大的 $h$ 都会降低梯度精度 。

**[解析梯度](@entry_id:1120999)**则是通过对能量表达式进行直接的数学[微分](@entry_id:158422)得到的。对于像 [Hartree-Fock](@entry_id:142303) (HF) 或密度泛函理论 (DFT) 这样的[自洽场](@entry_id:136549)（SCF）方法，计算[解析梯度](@entry_id:1120999)需要求解一套[线性响应](@entry_id:146180)方程，即所谓的耦合微扰 Hartree-Fock/Kohn-Sham (CPHF/CPKS) 方程。尽管推导复杂，但现代算法（如 Z-向量方法）使得计算整个[梯度向量](@entry_id:141180)的成本仅为单点能量计算成本的一个小的常数倍。其计算标度通常与 SCF 能量计算相同，约为 $\mathcal{O}(n_{\text{bf}}^3)$ 到 $\mathcal{O}(n_{\text{bf}}^4)$，其中 $n_{\text{bf}}$ 是基函数数量。对于中到大型体系，[解析梯度](@entry_id:1120999)在效率上远超数值梯度 。

#### [解析梯度](@entry_id:1120999)的理论：Hellmann-Feynman 力与 Pulay 力

[解析梯度](@entry_id:1120999)的理论涉及两个关键概念：**海尔曼-费曼（Hellmann-Feynman）力**和**普莱（Pulay）力**。

海尔曼-费曼定理指出，如果[波函数](@entry_id:201714) $|\psi_{\mathbf{R}}\rangle$ 是[哈密顿算符](@entry_id:144286) $\hat{H}(\mathbf{R})$ 的**[精确本征态](@entry_id:138620)**，那么能量对核坐标的导数就等于哈密顿算符导数的[期望值](@entry_id:150961)：
$$
\frac{dE}{d\mathbf{R}_I} = \left\langle \psi_{\mathbf{R}} \middle| \frac{\partial\hat{H}}{\partial\mathbf{R}_I} \middle| \psi_{\mathbf{R}} \right\rangle
$$
这一项被称为海尔曼-费曼力 。

然而，在实际的量子[化学计算](@entry_id:155220)中，我们通常使用有限的、以原子为中心的基组（如[高斯基组](@entry_id:198430)），通过[变分法](@entry_id:166033)得到的[波函数](@entry_id:201714)（如 HF 或 KS [波函数](@entry_id:201714)）并非[哈密顿算符](@entry_id:144286)的[精确本征态](@entry_id:138620)。更重要的是，这些基函数的位置是随着原子核一起移动的，即基函数本身也依赖于核坐标 $\mathbf{R}$。

在这种情况下，能量对核坐标的[全导数](@entry_id:137587)需要应用[链式法则](@entry_id:190743)。除了海尔曼-费曼项外，还会出现一个额外的贡献，它源于基函数对核坐标的显式依赖性。这个额外的项被称为**[普莱力](@entry_id:167194)**或基组力 。
$$
\frac{dE}{d\mathbf{R}_I} = \underbrace{\left\langle \psi_{\mathbf{R}} \middle| \frac{\partial\hat{H}}{\partial\mathbf{R}_I} \middle| \psi_{\mathbf{R}} \right\rangle}_{\text{Hellmann-Feynman Force}} + \underbrace{\text{Terms from } \frac{\partial \psi_{\mathbf{R}}}{\partial \mathbf{R}_I}}_{\text{Pulay Force}}
$$
只有当基组是完备的或与核坐标无关时（例如，[平面波基组](@entry_id:178287)），[普莱力](@entry_id:167194)才会消失。现代量子化学程序中的[解析梯度](@entry_id:1120999)计算会自动包含[普莱力](@entry_id:167194)，从而得到总的、正确的力。有趣的是，数值梯度方法通过计算总能量的差值，也自动地、隐式地包含了[普莱力](@entry_id:167194)的贡献 。

#### 不完全 SCF 收敛的影响

实际计算中，SCF 迭代过程总是在满足某个有限的收敛阈值 $\epsilon_{\text{SCF}}$ 时终止，这意味着电子态并非完全处于变分[稳定点](@entry_id:136617)。这种不完全的收敛会引入所谓的**非变分力（non-variational force）**或[梯度噪声](@entry_id:165895)。当电子态未完全收敛时，能量对轨道系数的导数不为零。根据链式法则，这会导致一个与 SCF 残差成正比的虚假力项被加到总的核间力上 。

这个虚假力是非保守的，意味着它破坏了[势能面](@entry_id:143655)的平滑性，给[优化算法](@entry_id:147840)带来了“噪声”。当优化接近收敛点时，真实的梯度很小，这种噪声的影响就变得尤为突出，可能导致优化过程振荡甚至失败。

一个有效的解决方案是采用**自适应 SCF 收敛标准**。其核心思想是将 SCF 收敛阈值与几何优化的进程耦合起来。例如，可以要求 SCF 阈值 $\epsilon_{\text{SCF}}$ 小于当前梯度范数 $\lVert \mathbf{g}_{\mathbf{R}} \rVert$ 的一个特定比例，或者随着信任域半径 $\Delta$ 的减小而收紧。这样，在优化的初始阶段，当梯度很大时，可以使用一个较松的 SCF 阈值以节省计算时间；而当优化接近收敛时，梯度变小，SCF 阈值也随之自动收紧，以确保力的精度足够高，从而实现[稳定收敛](@entry_id:199422)  。

### 导航[势能面](@entry_id:143655)的算法

拥有了计算力的工具后，我们需要算法来利用这些信息在[势能面](@entry_id:143655)上移动，以找到目标驻点。

#### 坐标系的选择：[笛卡尔坐标](@entry_id:167698) vs. [内坐标](@entry_id:169764)

优化的第一步是选择描述分子几何的坐标系。最直接的选择是**[笛卡尔坐标](@entry_id:167698)** $\mathbf{R} \in \mathbb{R}^{3N}$。它简单、完备，但包含了 $3N-6$ 个内部自由度和 6 个外部（平移和转动）自由度。如前所述，外部自由度对应于 Hessian 矩阵的零本征值，这会给许多[优化算法](@entry_id:147840)带来麻烦。

另一种选择是**[内坐标](@entry_id:169764) (Internal Coordinates)** $\mathbf{q}$，它们由[键长](@entry_id:144592)、键角和[二面角](@entry_id:185221)等描述分子内部几何的参数构成。[内坐标](@entry_id:169764)的主要优点是它们天生与分子的整体平移和转动无关。在由 $3N-6$ 个独立的[内坐标](@entry_id:169764)构成的空间中进行优化，可以自动消除外部自由度带来的问题，通常能显著提高优化效率 。

[笛卡尔坐标](@entry_id:167698)的微小位移 $\mathrm{d}\mathbf{R}$ 和[内坐标](@entry_id:169764)的微小变化 $\mathrm{d}\mathbf{q}$ 之间的关系由 **Wilson B-矩阵**（即[雅可比矩阵](@entry_id:178326) $B=\partial \mathbf{q}/\partial \mathbf{R}$）给出：$\mathrm{d}\mathbf{q}=B\,\mathrm{d}\mathbf{R}$。由于[内坐标](@entry_id:169764)对[刚体运动](@entry_id:144691)不敏感，任何代表[刚体](@entry_id:1131033)平移或转动的位移 $\mathrm{d}\mathbf{R}_{\text{rigid}}$ 必然位于 B-[矩阵的零空间](@entry_id:152429)中，即 $B\,\mathrm{d}\mathbf{R}_{\text{rigid}} = \mathbf{0}$ 。然而，为复杂分子（特别是环状或多环体系）构建一套完备且非冗余的[内坐标](@entry_id:169764)本身就是一个非平凡的挑战。

#### [优化算法](@entry_id:147840)：[线搜索](@entry_id:141607)与信任域方法

现代[几何优化](@entry_id:151817)器通常属于两大类：[线搜索方法](@entry_id:172705)和信任域方法。

**[线搜索方法](@entry_id:172705) (Line-Search Methods)** 将每一步的优化分解为两个子问题：首先确定一个搜索方向 $\mathbf{p}_k$，然后沿此方向进行[一维搜索](@entry_id:172782)，找到一个合适的步长 $\alpha_k$，使得 $E(\mathbf{R}_k + \alpha \mathbf{p}_k)$ 充分下降。更新规则为 $\mathbf{R}_{k+1} = \mathbf{R}_k + \alpha_k \mathbf{p}_k$。最简单的方向选择是[最速下降](@entry_id:141858)方向 $\mathbf{p}_k = -\mathbf{g}_k$。虽然直观，但[线搜索方法](@entry_id:172705)在狭窄弯曲的势能谷中可能会表现出“之”字形振荡，收敛缓慢 。

**信任域方法 (Trust-Region Methods)** 则采取了不同的策略。在每一步，它首先构建一个当前点 $\mathbf{R}_k$ 附近的能量的局部二次模型 $m_k(\mathbf{s})$：
$$
m_{k}(\mathbf{s})=E(\mathbf{R}_{k})+\mathbf{g}_{k}^{\top}\mathbf{s}+\tfrac{1}{2}\mathbf{s}^{\top}\mathbf{B}_{k}\mathbf{s}
$$
其中 $\mathbf{g}_k$ 是梯度，$\mathbf{B}_k$ 是对 Hessian 矩阵的近似。然后，它在以当前点为中心、半径为 $\Delta_k$ 的“信任域”球内求解这个模型的极小值问题：$\min_{\|\mathbf{s}\| \le \Delta_k} m_k(\mathbf{s})$，得到步长 $\mathbf{s}_k$。

信任域方法的关键优势在于其鲁棒性。信任域半径 $\Delta_k$ 的存在，保证了即使 Hessian 近似 $\mathbf{B}_k$ 是病态的或不定的（例如，在鞍点附近有[负曲率](@entry_id:159335)），二次子问题也总是有良定义的解。算法会根据模型预测的能量下降与实际能量下降的比率来动态调整信任域半径 $\Delta_k$，使其能够自适应地处理高度弯曲或复杂的[势能面](@entry_id:143655)。这种方法可以同时[优化步长](@entry_id:752988)的方向和大小，从而比[线搜索方法](@entry_id:172705)更有效地处理复杂地形  。

#### 加速收敛：[预处理](@entry_id:141204)

对于大型或复杂体系，Hessian 矩阵的本征值谱可能跨越多个数量级，既包含对应于硬振动模式（如[键伸缩](@entry_id:172690)）的大本征值，也包含对应于[软模式](@entry_id:137007)（如分子扭转或集体运动）的小本征值。这导致 Hessian 矩阵的**条件数** $\kappa(H) = \lambda_{\text{max}}/\lambda_{\text{min}}$ 非常大，即矩阵是“病态的”。这会严重减慢梯度类[优化算法](@entry_id:147840)的收敛速度。

**预处理 (Preconditioning)** 是一种解决此问题的强大技术。其思想是引入一个对称正定的**预处理器**矩阵 $M$，它在某种程度上近似于真实的 Hessian 矩阵 $H$。然后，将原始的[最速下降](@entry_id:141858)步长 $-\mathbf{g}_k$ 替换为预处理后的步长 $-M^{-1}\mathbf{g}_k$。

从理论上讲，预处理后的优化算法的收敛速率由[预处理](@entry_id:141204)后 Hessian 矩阵 $M^{-1}H$ 的[条件数](@entry_id:145150) $\kappa(M^{-1}H)$ 决定。一个好的[预处理器](@entry_id:753679) $M$ 应该使得 $M \approx H$，从而 $M^{-1}H \approx I$（[单位矩阵](@entry_id:156724)）。这样，$\kappa(M^{-1}H)$ 接近于 1，其本征值谱被“聚集”在一起，[收敛速度](@entry_id:636873)将大大加快 。值得注意的是，选择 $M=H$ 并取步长为 1，就恢复了牛顿法，对于二次[势能面](@entry_id:143655)可以一步收敛 。

在实践中，构建和求逆精确的 Hessian 矩阵成本高昂。因此，人们发展了各种近似的[预处理器](@entry_id:753679)。例如，在[多尺度系统](@entry_id:1128345)中，可以使用能够捕捉体系长波振动模式的[粗粒化](@entry_id:141933)弹性模型来构建[预处理器](@entry_id:753679)，这在处理大型生物分子或材料的[几何优化](@entry_id:151817)时尤其有效 。

### 实践考量：何时停止优化？

最后，一个实际问题是：我们如何判断优化过程已经充分收敛？这需要一套明确的**[收敛判据](@entry_id:158093)**。由于优化算法的目标是找到梯度为零的点，最自然的判据是基于力的大小。常用的判据包括 ：

*   **最大力 (Maximum Force)**: $\max_i \|\mathbf{F}_i\|$
*   **[均方根](@entry_id:263605)力 (RMS Force)**: $\sqrt{\frac{1}{N}\sum_{i=1}^{N} \|\mathbf{F}_i\|^2}$
*   **最大位移 (Maximum Displacement)**: $\max_i \|\delta \mathbf{R}_i\|$
*   **[均方根位移](@entry_id:137352) (RMS Displacement)**: $\sqrt{\frac{1}{N}\sum_{i=1}^{N} \|\delta \mathbf{R}_i\|^2}$
*   **能量变化 (Energy Change)**: $|E_{k+1} - E_k|$

这些判据的阈值选择取决于计算的目的。
*   **“松散”优化 (Loose Optimization)**：适用于[高通量筛选](@entry_id:271166)或初步探索。力的阈值可以设置得相对较大，例如与经典力场（如 [QM/MM](@entry_id:1126245) 中的 MM 部分）的典型不确定性相当（例如 $0.05$ eV/Å）。此时，追求比[力场](@entry_id:147325)精度高得多的 QM 部分收敛是没有意义的。
*   **“严格”优化 (Tight Optimization)**：适用于需要精确结构和进行后续属性计算（如[振动频率分析](@entry_id:170781)）的场合。此时，力的阈值需要设置得非常小，接近 QM 方法本身固有的数值噪声水平（例如 $0.001$ eV/Å）。

这些不同的判据之间应该是自洽的。基于简谐近似（$g \approx k |\delta R|$ 和 $\Delta E \approx g^2/(2k)$），可以估算出一套相互匹配的阈值。例如，对于一个给定的力阈值 $g_{\text{tol}}$ 和一个典型的曲率 $k$，相应的位移和能量阈值应该在 $\delta R_{\text{tol}} \approx g_{\text{tol}}/k$ 和 $\Delta E_{\text{tol}} \approx g_{\text{tol}}^2/(2k)$ 的量级上 。

最后，必须强调，将收敛阈值设定在远低于计算方法数值噪声的水平是毫无意义且不切实际的。这样做只会让优化器“追逐噪声”，导致其无法收敛或收敛到一个由数值波动决定的任意点 。一个好的收敛标准应该既能保证结果的物理意义，又能反映计算方法的内在精度限制。