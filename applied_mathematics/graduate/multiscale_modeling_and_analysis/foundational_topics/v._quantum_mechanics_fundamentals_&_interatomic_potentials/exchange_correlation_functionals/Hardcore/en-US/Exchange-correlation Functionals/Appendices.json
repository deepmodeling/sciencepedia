{
    "hands_on_practices": [
        {
            "introduction": "The Local Density Approximation (LDA) serves as the foundational rung on the \"Jacob's Ladder\" of exchange-correlation functionals. This exercise solidifies your understanding of LDA by exploring its behavior in the idealized system for which it is exact: the uniform electron gas. By analyzing how the total exchange energy scales with electron density, you will gain fundamental insight into the local nature of this approximation. ",
            "id": "1367149",
            "problem": "In the framework of Density Functional Theory (DFT), the total exchange energy, $E_x$, of an electronic system can be approximated by integrating an exchange energy density, $\\epsilon_x(\\mathbf{r})$, over all space. A foundational and widely used approximation is the Local Density Approximation (LDA), which proposes that the exchange energy density at a point $\\mathbf{r}$ is determined solely by the electron density, $n(\\mathbf{r})$, at that same point. For a system of interacting electrons, the LDA exchange energy density is given by the expression $\\epsilon_x^{LDA}(\\mathbf{r}) = C_x n(\\mathbf{r})^{4/3}$, where $C_x$ is a universal negative constant.\n\nConsider a simple model system: a uniform electron gas containing $N_1$ electrons freely moving within a fixed three-dimensional volume $V$. In such a system, the electron density is constant, $n(\\mathbf{r}) = n_0$, everywhere inside the volume and zero outside. The total LDA exchange energy for this initial system is $E_{x,1}$.\n\nNow, imagine we double the number of electrons in the box, so the new number of electrons is $N_2 = 2N_1$, while keeping the volume $V$ constant. The electron gas remains uniform. Let the new total LDA exchange energy be $E_{x,2}$.\n\nCalculate the ratio of the new exchange energy to the original exchange energy, $E_{x,2} / E_{x,1}$. Report your answer as a numerical value rounded to three significant figures.",
            "solution": "The LDA exchange energy is defined by integrating the exchange energy density over space:\n$$\nE_{x}=\\int \\epsilon_{x}^{LDA}(\\mathbf{r})\\,d^{3}r=\\int C_{x}\\,n(\\mathbf{r})^{4/3}\\,d^{3}r.\n$$\nFor a uniform electron gas of density $n(\\mathbf{r})=n_{0}$ inside the volume $V$ and zero outside, the integral reduces to\n$$\nE_{x,1}=C_{x}\\,n_{0}^{4/3}\\,V.\n$$\nUsing particle number conservation $N_{1}=n_{0}V$, we can also write\n$$\nE_{x,1}=C_{x}\\left(\\frac{N_{1}}{V}\\right)^{4/3}V=C_{x}\\,N_{1}^{4/3}\\,V^{-1/3}.\n$$\nAfter doubling the number of electrons at fixed volume, $N_{2}=2N_{1}$, the new density is $n_{0}^{\\prime}=N_{2}/V=2n_{0}$. The new exchange energy is\n$$\nE_{x,2}=C_{x}\\,(n_{0}^{\\prime})^{4/3}\\,V=C_{x}\\,(2n_{0})^{4/3}\\,V=2^{4/3}\\,C_{x}\\,n_{0}^{4/3}\\,V=2^{4/3}\\,E_{x,1}.\n$$\nEquivalently, in terms of $N_{1}$ and $V$,\n$$\nE_{x,2}=C_{x}\\left(\\frac{N_{2}}{V}\\right)^{4/3}V=C_{x}\\,(2N_{1})^{4/3}\\,V^{-1/3}.\n$$\nTherefore, the ratio is\n$$\n\\frac{E_{x,2}}{E_{x,1}}=\\frac{C_{x}\\,(2N_{1})^{4/3}\\,V^{-1/3}}{C_{x}\\,N_{1}^{4/3}\\,V^{-1/3}}=2^{4/3}.\n$$\nEvaluating numerically and rounding to three significant figures gives $2^{4/3}\\approx 2.52$.",
            "answer": "$$\\boxed{2.52}$$"
        },
        {
            "introduction": "A crucial test for any exchange-correlation functional is its ability to be \"self-interaction free,\" meaning an electron should not interact with itself. This exercise tackles this fundamental concept by quantifying the self-interaction error (SIE) of the Local Spin Density (LSD) approximation for the hydrogen atom. Calculating the sum of the fictitious Hartree self-repulsion and the approximate exchange energy will give you a concrete understanding of one of the most significant shortcomings of local functionals. ",
            "id": "47685",
            "problem": "In the framework of Density Functional Theory (DFT), the exact exchange-correlation functional ensures that for a one-electron system, the exchange energy, $E_x[n]$, perfectly cancels the fictitious Hartree self-interaction energy, $E_H[n]$. Approximate functionals, however, fail to satisfy this condition, leading to a non-zero self-interaction error (SIE). The SIE for a one-electron system is defined as the sum of the Hartree energy and the approximate exchange energy, i.e., $SIE = E_H[n] + E_x^{\\text{approx}}[n]$.\n\nConsider a hydrogen atom in its 1s ground state. The electron density $n(\\mathbf{r})$ is given by the square of the 1s orbital wavefunction. All calculations are to be performed in atomic units, where the reduced Planck constant $\\hbar$, the electron mass $m_e$, the elementary charge $e$, and the Coulomb force constant $1/(4\\pi\\epsilon_0)$ are all equal to unity. In these units, the Bohr radius is $a_0=1$.\n\nThe electron density for the 1s state is spherically symmetric and is given by:\n$$n(r) = \\frac{1}{\\pi} e^{-2r}$$\nwhere $r=|\\mathbf{r}|$ is the distance from the nucleus.\n\nThe Hartree energy is the classical electrostatic self-repulsion energy of the electron density:\n$$E_H[n] = \\frac{1}{2} \\iint \\frac{n(\\mathbf{r}) n(\\mathbf{r'})}{|\\mathbf{r} - \\mathbf{r'}|} d^3\\mathbf{r} d^3\\mathbf{r'}$$\n\nFor a single-electron system like hydrogen, the electron gas is fully spin-polarized. We will use the Local Spin Density (LSD) approximation for the exchange energy. For a system with only spin-up electrons of density $n_\\uparrow(\\mathbf{r}) = n(\\mathbf{r})$, the LSD exchange energy is given by:\n$$E_x^{\\text{LSD}}[n] = \\int C_x^{\\text{pol}} [n(\\mathbf{r})]^{4/3} d^3\\mathbf{r}$$\nwhere the prefactor is $C_x^{\\text{pol}} = -\\frac{3}{4} \\left(\\frac{6}{\\pi}\\right)^{1/3}$.\n\nDerive the self-interaction error, $SIE = E_H[n] + E_x^{\\text{LSD}}[n]$, for the hydrogen atom in its 1s ground state. Express your answer as a single, closed-form analytic expression.",
            "solution": "1. Relevant equations  \nHartree energy:  \n$$E_H[n]=\\frac{1}{2}\\iint\\frac{n(\\mathbf r)n(\\mathbf r')}{|\\mathbf r-\\mathbf r'|}d^3r\\,d^3r'\\,. $$  \nLSD exchange energy (fully spin‐polarized):  \n$$E_x^{\\mathrm{LSD}}[n]=\\int C_x^{\\mathrm{pol}}\\,[n(r)]^{4/3}d^3r\\,,\\quad C_x^{\\mathrm{pol}}=-\\frac{3}{4}\\Bigl(\\frac{6}{\\pi}\\Bigr)^{1/3}\\,. $$  \nDensity of H 1s:  \n$$n(r)=\\frac{1}{\\pi} e^{-2r}\\,,\\quad\\int n(r)d^3r=1\\,. $$\n\n2. Hartree energy  \nUsing spherical coordinates and the identity  \n$$\\iint\\frac{f(r)f(r')}{|\\mathbf r-\\mathbf r'|}d^3r\\,d^3r'\n=16\\pi^2\\int_0^\\infty\\!\\!\\int_0^\\infty\\frac{f(r)r^2\\,f(r')r'^2}{\\max(r,r')}dr\\,dr'\\,, $$  \nset $f(r)=n(r)=\\pi^{-1}e^{-2r}$. One finds after splitting the $rr'$ and $rr'$ regions and performing the radial integrals  \n$$E_H=\\frac{1}{2}\\cdot16\\pi^2\\frac{1}{\\pi^2}\\int_0^\\infty\\!\\!\\int_0^\\infty\\frac{e^{-2(r+r')}r^2r'^2}{\\max(r,r')}dr\\,dr'\n=\\frac{1}{2}\\cdot\\frac{5}{8}=\\frac{5}{16}\\,. $$\n\n3. LSD exchange energy  \n$$E_x^{\\mathrm{LSD}}\n=C_x^{\\mathrm{pol}}\\int_0^\\infty4\\pi r^2\\Bigl(\\frac{1}{\\pi} e^{-2r}\\Bigr)^{4/3}dr\n=C_x^{\\mathrm{pol}}\\,4\\pi\\pi^{-4/3}\\int_0^\\infty r^2e^{-\\frac{8}{3}r}dr\\,. $$  \nSince $\\displaystyle\\int_0^\\infty r^2e^{-\\beta r}dr=\\frac{2}{\\beta^3}$ with $\\beta=8/3$,  \n$$\\int_0^\\infty r^2e^{-\\frac{8}{3}r}dr=\\frac{2}{(8/3)^3}=\\frac{27}{256}\\,. $$  \nThus  \n$$E_x^{\\mathrm{LSD}}\n=-\\frac{3}{4}\\Bigl(\\frac{6}{\\pi}\\Bigr)^{1/3}4\\pi\\pi^{-4/3}\\frac{27}{256}\n=-\\frac{81}{256}\\Bigl(\\frac{6}{\\pi^2}\\Bigr)^{1/3}\\,. $$\n\n4. Self‐interaction error  \n$$SIE=E_H+E_x^{\\mathrm{LSD}}\n=\\frac{5}{16}-\\frac{81}{256}\\Bigl(\\frac{6}{\\pi^2}\\Bigr)^{1/3}\\,. $$",
            "answer": "$$\\boxed{\\frac{5}{16}-\\frac{81}{256}\\Bigl(\\frac{6}{\\pi^2}\\Bigr)^{1/3}}$$"
        },
        {
            "introduction": "Advanced functionals must satisfy rigorous theoretical constraints to be considered physically meaningful. This hands-on computational exercise challenges you to verify one such constraint, the Lieb–Oxford bound, for the popular Perdew–Burke–Ernzerhof (PBE) GGA functional. By writing code to evaluate the functional for a diverse set of electron densities and comparing it to the theoretical bound, you will gain practical experience in the numerical testing and validation of DFT functionals. ",
            "id": "3756447",
            "problem": "Consider the task of verifying that a candidate exchange-correlation energy functional from Density Functional Theory (DFT) satisfies the Lieb–Oxford bound in a multiscale modeling context by computing, for representative electron densities, the dimensionless quantity $$q[n] = \\frac{-E_{\\mathrm{xc}}[n]}{\\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r}},$$ where $E_{\\mathrm{xc}}[n]$ is the exchange-correlation energy functional evaluated for a density $n(\\mathbf{r})$. The Lieb–Oxford bound states that there exists a universal constant $\\lambda$ such that $$E_{\\mathrm{xc}}[n] \\ge -\\lambda \\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r}.$$ Computing $q[n]$ for a suite of representative densities and identifying the largest value among them provides an empirical upper bound estimate that can be compared to the known theoretical bound constant, thereby serving as a verification procedure.\n\nAdopt the following scientifically well-tested candidate functional: a generalized gradient approximation with Perdew–Burke–Ernzerhof (PBE)-type exchange and zero correlation, i.e., $$E_{\\mathrm{xc}}[n] = E_{\\mathrm{x}}[n], \\quad E_{\\mathrm{c}}[n] = 0.$$ The exchange energy is defined by $$E_{\\mathrm{x}}[n] = \\int e_{\\mathrm{x}}^{\\mathrm{LDA}}(n) F_{\\mathrm{x}}(s)\\, d\\mathbf{r},$$ where the local density approximation (LDA) exchange energy density is $$e_{\\mathrm{x}}^{\\mathrm{LDA}}(n) = -C_{\\mathrm{x}}\\, n^{4/3}, \\quad C_{\\mathrm{x}} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3},$$ and the PBE exchange enhancement factor is $$F_{\\mathrm{x}}(s) = 1 + \\kappa - \\frac{\\kappa}{1 + \\mu s^2/\\kappa},$$ with constants $\\kappa = 0.804$ and $\\mu = 0.21951$. The reduced gradient $s$ is defined by $$s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\, k_{\\mathrm{F}}(\\mathbf{r})\\, n(\\mathbf{r})}, \\quad k_{\\mathrm{F}}(\\mathbf{r}) = \\left(3\\pi^2 n(\\mathbf{r})\\right)^{1/3}.$$\n\nDiscretize the cubic domain of side length $L$ in atomic units (bohr) into a uniform grid with $N$ points along each axis, and enforce periodic boundary conditions. Use central finite differences consistent with periodicity to approximate spatial derivatives, and a Riemann sum to approximate integrals with the volume element $\\Delta V = (L/N)^3$. To ensure numerical stability in regions where $n(\\mathbf{r})$ is small, define a regularized density for the reduced gradient calculation by $$n_{\\mathrm{reg}}(\\mathbf{r}) = \\max\\left(n(\\mathbf{r}), n_{\\min}\\right),$$ with $n_{\\min} = 10^{-12}$ in bohr$^{-3}$. Use $n(\\mathbf{r})$ (not $n_{\\mathrm{reg}}(\\mathbf{r})$) inside $e_{\\mathrm{x}}^{\\mathrm{LDA}}(n)$ and the denominator integral.\n\nWork in three-dimensional space on a cube of side length $L=10$ bohr with $N=64$. Construct the following representative electron densities $n(\\mathbf{r})$ (all densities are in bohr$^{-3}$, and distances are in bohr):\n\n1. Uniform density: $$n(\\mathbf{r}) = n_0,$$ with $n_0 = 0.01$.\n2. Smooth sinusoidal modulation with non-negativity enforced: $$n(\\mathbf{r}) = n_0\\, \\max\\left(0, 1 + \\alpha \\sin\\left(\\frac{2\\pi x}{\\lambda}\\right)\\sin\\left(\\frac{2\\pi y}{\\lambda}\\right)\\sin\\left(\\frac{2\\pi z}{\\lambda}\\right)\\right),$$ with $n_0 = 0.01$, $\\alpha = 0.5$, and $\\lambda = L/2$.\n3. Single Gaussian centered at the domain center $\\mathbf{r}_0 = (L/2, L/2, L/2)$: $$n(\\mathbf{r}) = A \\exp\\left(-\\frac{\\|\\mathbf{r} - \\mathbf{r}_0\\|^2}{2\\sigma^2}\\right),$$ with $A = 1.0$ and $\\sigma = 0.5$.\n4. Double Gaussian along the $x$-axis centered at $\\mathbf{r}_{\\pm} = (L/2 \\pm d/2, L/2, L/2)$: $$n(\\mathbf{r}) = A \\left[\\exp\\left(-\\frac{\\|\\mathbf{r} - \\mathbf{r}_{+}\\|^2}{2\\sigma^2}\\right) + \\exp\\left(-\\frac{\\|\\mathbf{r} - \\mathbf{r}_{-}\\|^2}{2\\sigma^2}\\right)\\right],$$ with $A = 0.8$, $\\sigma = 0.8$, and $d = 3.0$.\n5. Highly localized (spiky) Gaussian at the center $\\mathbf{r}_0 = (L/2, L/2, L/2)$: $$n(\\mathbf{r}) = A \\exp\\left(-\\frac{\\|\\mathbf{r} - \\mathbf{r}_0\\|^2}{2\\sigma^2}\\right),$$ with $A = 5.0$ and $\\sigma = 0.2$.\n\nFor each density, compute $q[n]$ as defined above. Also compute $$q_{\\max} = \\max\\left\\{q[n_1], q[n_2], q[n_3], q[n_4], q[n_5]\\right\\},$$ which serves as the empirical estimate of the Lieb–Oxford constant for this candidate functional over the given test suite.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5,result6]\"). The six outputs must be the five values $q[n_i]$ for $i \\in \\{1,2,3,4,5\\}$, followed by $q_{\\max}$. No physical units are required in the output because $q[n]$ is dimensionless.\n\nUse the following test suite parameter values exactly:\n- $L = 10$ bohr, $N = 64$.\n- $n_{\\min} = 10^{-12}$ bohr$^{-3}$.\n- Uniform: $n_0 = 0.01$.\n- Sinusoidal: $n_0 = 0.01$, $\\alpha = 0.5$, $\\lambda = L/2$.\n- Single Gaussian: $A = 1.0$, $\\sigma = 0.5$.\n- Double Gaussian: $A = 0.8$, $\\sigma = 0.8$, $d = 3.0$.\n- Spiky Gaussian: $A = 5.0$, $\\sigma = 0.2$.\n\nThe program must use periodic boundary conditions and central finite differences for computing gradients, and it must implement the candidate functional as specified above. The numerical integrals must be computed via uniform-grid Riemann sums over the cubic domain. The final output must be a single line of the form \"[q1,q2,q3,q4,q5,qmax]\".",
            "solution": "The problem statement is a valid, well-posed, and scientifically grounded computational task within the field of Density Functional Theory (DFT). It requires the numerical verification of the Lieb–Oxford bound for a specified exchange-correlation functional by computing a dimensionless quantity, $q[n]$, for a suite of five representative electron densities. All necessary physical constants, mathematical definitions, functional forms, and numerical parameters are provided, and no contradictions or ambiguities are present.\n\nThe solution proceeds by first establishing a discrete numerical framework and then implementing the algorithmic steps to compute $q[n]$ for each specified density.\n\nThe quantity to be computed for each electron density $n(\\mathbf{r})$ is given by:\n$$q[n] = \\frac{-E_{\\mathrm{xc}}[n]}{\\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r}}$$\nThe exchange-correlation functional, $E_{\\mathrm{xc}}[n]$, is a Perdew–Burke–Ernzerhof (PBE)-type exchange-only functional, meaning the correlation energy is zero ($E_{\\mathrm{c}}[n]=0$) and the exchange energy is:\n$$E_{\\mathrm{x}}[n] = \\int e_{\\mathrm{x}}^{\\mathrm{LDA}}(n) F_{\\mathrm{x}}(s)\\, d\\mathbf{r}$$\nwhere $e_{\\mathrm{x}}^{\\mathrm{LDA}}(n) = -C_{\\mathrm{x}} n^{4/3}$ is the Local Density Approximation (LDA) exchange energy density, with $C_{\\mathrm{x}} = \\frac{3}{4}(\\frac{3}{\\pi})^{1/3}$, and $F_{\\mathrm{x}}(s)$ is the PBE exchange enhancement factor.\n\nThe computational methodology is as follows:\n\n**1. Discretization and Grid Setup**\nThe problem is solved in a three-dimensional cubic domain of side length $L=10$ bohr, subject to periodic boundary conditions. This continuous domain is discretized into a uniform grid of $N^3$ points, with $N=64$. The grid spacing along each Cartesian axis is $h = L/N$. The coordinates of a grid point $(i, j, k)$, where $i, j, k \\in \\{0, 1, \\dots, N-1\\}$, are given by $(x_i, y_j, z_k) = (ih, jh, kh)$. The differential volume element for numerical integration is approximated by the volume of a single grid cell, $\\Delta V = h^3 = (L/N)^3$. All numerical integrations are performed as Riemann sums over the grid points, e.g., $\\int f(\\mathbf{r}) d\\mathbf{r} \\approx \\sum_{i,j,k} f(\\mathbf{r}_{ijk}) \\Delta V$.\n\n**2. Numerical Gradient Calculation**\nThe gradient of the electron density, $\\nabla n(\\mathbf{r})$, is required to compute the reduced gradient $s$. It is approximated at each grid point using a second-order central finite difference scheme that respects the periodic boundary conditions. For the component of the gradient along the $x$-axis at grid point $\\mathbf{r}_{ijk}$, the approximation is:\n$$\\frac{\\partial n}{\\partial x}\\bigg|_{\\mathbf{r}_{ijk}} \\approx \\frac{n_{i+1, j, k} - n_{i-1, j, k}}{2h}$$\nwhere the indices $i+1$ and $i-1$ are evaluated modulo $N$. Analogous expressions are used for the $y$ and $z$ components. The magnitude of the gradient is then $|\\nabla n| = \\sqrt{(\\frac{\\partial n}{\\partial x})^2 + (\\frac{\\partial n}{\\partial y})^2 + (\\frac{\\partial n}{\\partial z})^2}$.\n\n**3. Calculation of the Reduced Gradient $s(\\mathbf{r})$**\nThe reduced density gradient, $s(\\mathbf{r})$, is defined as:\n$$s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\, k_{\\mathrm{F}}(\\mathbf{r})\\, n(\\mathbf{r})}, \\quad \\text{where} \\quad k_{\\mathrm{F}}(\\mathbf{r}) = \\left(3\\pi^2 n(\\mathbf{r})\\right)^{1/3}$$\nThis can be written as $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2(3\\pi^2)^{1/3} n(\\mathbf{r})^{4/3}}$. To ensure numerical stability in regions of vanishing density, a regularized density $n_{\\mathrm{reg}}(\\mathbf{r}) = \\max(n(\\mathbf{r}), n_{\\min})$ with $n_{\\min}=10^{-12}$ is used for the terms in the denominator of $s$. The gradient $|\\nabla n(\\mathbf{r})|$ is computed using the non-regularized density $n(\\mathbf{r})$, as specified. Thus, the computed quantity is:\n$$s(\\mathbf{r}) \\approx \\frac{|\\nabla n(\\mathbf{r})|}{2(3\\pi^2)^{1/3} n_{\\mathrm{reg}}(\\mathbf{r})^{4/3}}$$\n\n**4. Computation of the Exchange Energy $E_{\\mathrm{x}}[n]$**\nWith $s(\\mathbf{r})$ computed at each grid point, the PBE enhancement factor is calculated using its definition:\n$$F_{\\mathrm{x}}(s) = 1 + \\kappa - \\frac{\\kappa}{1 + \\mu s^2/\\kappa}$$\nwith the given constants $\\kappa = 0.804$ and $\\mu = 0.21951$. The exchange energy integrand is then $e_{\\mathrm{x}}(\\mathbf{r}) = -C_{\\mathrm{x}} n(\\mathbf{r})^{4/3} F_{\\mathrm{x}}(s(\\mathbf{r}))$. The total exchange energy is found by summing this quantity over the grid and multiplying by $\\Delta V$:\n$$E_{\\mathrm{x}}[n] \\approx \\Delta V \\sum_{i,j,k} \\left(-C_{\\mathrm{x}} n(\\mathbf{r}_{ijk})^{4/3} F_{\\mathrm{x}}(s(\\mathbf{r}_{ijk}))\\right)$$\n\n**5. Computation of $q[n]$**\nThe denominator of the expression for $q[n]$ is the integral $I_{\\mathrm{den}}[n] = \\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r}$. This is also computed via a Riemann sum:\n$$I_{\\mathrm{den}}[n] \\approx \\Delta V \\sum_{i,j,k} n(\\mathbf{r}_{ijk})^{4/3}$$\nThe value of $q[n]$ for a given density is then $q[n] = -E_{\\mathrm{x}}[n] / I_{\\mathrm{den}}[n]$.\n\n**6. Evaluation for Test Densities and Final Result**\nThis entire procedure is applied to each of the five specified electron density functions: (1) Uniform, (2) Sinusoidal, (3) Single Gaussian, (4) Double Gaussian, and (5) Spiky Gaussian. This yields five values: $q[n_1], \\dots, q[n_5]$. The final required output quantity, $q_{\\max}$, is the maximum value in this set.\nFor the uniform density case, $n(\\mathbf{r})=n_0$, we expect $\\nabla n = \\mathbf{0}$, which implies $s=0$ and $F_{\\mathrm{x}}(0)=1$. The expression for $q[n_0]$ simplifies to $q[n_0] = C_{\\mathrm{x}}$, providing an analytical check for the implementation.\nThe complete set of results is then formatted into a single list $[q[n_1], q[n_2], q[n_3], q[n_4], q[n_5], q_{\\max}]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Lieb-Oxford bound violation parameter q[n] for a PBE\n    exchange-only functional over a suite of five test electron densities.\n    \"\"\"\n    # Global parameters from the problem statement\n    L = 10.0  # bohr\n    N = 64\n    n_min = 1e-12  # bohr^-3\n\n    # PBE functional constants\n    kappa = 0.804\n    mu = 0.21951\n    \n    # Derived physical and numerical constants\n    h = L / N\n    delta_V = h**3\n    Cx = (3.0 / 4.0) * (3.0 / np.pi)**(1.0 / 3.0)\n    s_denom_const = 2.0 * (3.0 * np.pi**2)**(1.0 / 3.0)\n\n    # Setup the 3D grid\n    grid_1d = np.linspace(0, L, N, endpoint=False)\n    X, Y, Z = np.meshgrid(grid_1d, grid_1d, grid_1d, indexing='ij')\n\n    def compute_q(n):\n        \"\"\"\n        Calculates q[n] for a given electron density array 'n'.\n        \"\"\"\n        # Step 1: Compute the gradient of the density using central differences\n        # with periodic boundary conditions.\n        grad_x = (np.roll(n, -1, axis=0) - np.roll(n, 1, axis=0)) / (2.0 * h)\n        grad_y = (np.roll(n, -1, axis=1) - np.roll(n, 1, axis=1)) / (2.0 * h)\n        grad_z = (np.roll(n, -1, axis=2) - np.roll(n, 1, axis=2)) / (2.0 * h)\n        grad_mag = np.sqrt(grad_x**2 + grad_y**2 + grad_z**2)\n\n        # Step 2: Compute the reduced gradient 's'.\n        # Regularize density for the denominator to avoid numerical instability.\n        n_reg = np.maximum(n, n_min)\n        s_denom = s_denom_const * n_reg**(4.0 / 3.0)\n        s = grad_mag / s_denom\n\n        # Step 3: Compute the PBE enhancement factor 'Fx'.\n        Fx = 1.0 + kappa - kappa / (1.0 + mu * s**2 / kappa)\n\n        # Step 4: Compute the total exchange energy 'Ex' via Riemann sum.\n        # Note: 'n' (not n_reg) is used here as specified.\n        integrand_Ex = -Cx * n**(4.0 / 3.0) * Fx\n        Ex = np.sum(integrand_Ex) * delta_V\n\n        # Step 5: Compute the denominator integral 'Iden' via Riemann sum.\n        integrand_Iden = n**(4.0 / 3.0)\n        Iden = np.sum(integrand_Iden) * delta_V\n\n        # Step 6: Compute q[n]. Handle case of zero integral to avoid division by zero.\n        if Iden == 0.0:\n            return 0.0\n        q_val = -Ex / Iden\n        return q_val\n\n    results = []\n\n    # Case 1: Uniform density\n    n0_uni = 0.01\n    n1 = np.full((N, N, N), n0_uni)\n    results.append(compute_q(n1))\n\n    # Case 2: Smooth sinusoidal modulation\n    n0_sin = 0.01\n    alpha = 0.5\n    lambda_val = L / 2.0\n    factor = 2.0 * np.pi / lambda_val\n    term = 1.0 + alpha * (np.sin(factor * X) * np.sin(factor * Y) * np.sin(factor * Z))\n    n2 = n0_sin * np.maximum(0.0, term)\n    results.append(compute_q(n2))\n\n    # Case 3: Single Gaussian\n    A_sg = 1.0\n    sigma_sg = 0.5\n    r0_sg = L / 2.0\n    r_sq = (X - r0_sg)**2 + (Y - r0_sg)**2 + (Z - r0_sg)**2\n    n3 = A_sg * np.exp(-r_sq / (2.0 * sigma_sg**2))\n    results.append(compute_q(n3))\n\n    # Case 4: Double Gaussian\n    A_dg = 0.8\n    sigma_dg = 0.8\n    d_dg = 3.0\n    center = L / 2.0\n    offset = d_dg / 2.0\n    r_plus_sq = (X - (center + offset))**2 + (Y - center)**2 + (Z - center)**2\n    r_minus_sq = (X - (center - offset))**2 + (Y - center)**2 + (Z - center)**2\n    n4 = A_dg * (np.exp(-r_plus_sq / (2.0 * sigma_dg**2)) + np.exp(-r_minus_sq / (2.0 * sigma_dg**2)))\n    results.append(compute_q(n4))\n\n    # Case 5: Highly localized (spiky) Gaussian\n    A_spiky = 5.0\n    sigma_spiky = 0.2\n    r0_spiky = L / 2.0\n    r_sq_spiky = (X - r0_spiky)**2 + (Y - r0_spiky)**2 + (Z - r0_spiky)**2\n    n5 = A_spiky * np.exp(-r_sq_spiky / (2.0 * sigma_spiky**2))\n    results.append(compute_q(n5))\n\n    # Final result: list of q values and the maximum q\n    q_max = max(results)\n    results.append(q_max)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}