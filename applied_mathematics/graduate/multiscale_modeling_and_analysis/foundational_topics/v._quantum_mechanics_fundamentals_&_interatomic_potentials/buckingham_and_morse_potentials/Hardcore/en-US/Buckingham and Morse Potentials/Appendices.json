{
    "hands_on_practices": [
        {
            "introduction": "The ultimate goal of many interatomic potentials is to predict macroscopic material properties from first principles. This exercise provides a foundational example of this process, bridging the gap between a microscopic pair interaction, $V(r)$, and the bulk cohesive energy of a crystal. By applying the Buckingham potential to a simple cubic lattice with lattice parameter $a$, you will practice summing pairwise interactions to determine how strongly a solid is held together. This calculation, while using a simplified nearest-neighbor model, illustrates the core logic used in more complex solid-state energy calculations. ",
            "id": "3738534",
            "problem": "Consider a crystalline solid arranged in a simple cubic (SC) lattice with lattice parameter $a$ and coordination number (number of nearest neighbors) $z=6$. Assume the interatomic interactions are pairwise additive and described by the Buckingham potential, a widely used empirical form for short-range repulsion and dispersion attraction in ionic and molecular solids. The Buckingham potential between two atoms separated by a distance $r$ is\n$$V(r)=A\\exp(-Br)-\\frac{C}{r^{6}},$$\nwhere $A$, $B$, and $C$ are positive material-dependent constants. Assume all atoms are identical and the lattice is infinite, so surface effects can be neglected. Use the nearest-neighbor approximation, in which only interactions with the $z=6$ nearest neighbors at separation $r=a$ are retained.\n\nStarting from the principle of pairwise additivity of potential energy in many-body systems and the definition that the potential energy per atom is one half of the sum over pair interactions with all other atoms (to avoid double counting), derive the cohesive energy per atom $E_{\\mathrm{coh}}(a)$ as a function of $A$, $B$, $C$, and $a$ for this SC lattice under the nearest-neighbor approximation. Clearly state the mathematical steps and physical reasoning that lead from the fundamental assumptions to the final expression.\n\nExpress the final energy per atom in joules. The parameters should be used consistently with $A$ in joules, $B$ in inverse meters ($m^{-1}$), $a$ in meters, and $C$ in joule$\\cdot$meter$^{6}$. The required final answer is a single closed-form analytic expression for $E_{\\mathrm{coh}}(a)$ in terms of $A$, $B$, $C$, and $a$.",
            "solution": "The problem statement is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **Lattice Structure:** Simple cubic (SC)\n- **Lattice Parameter:** $a$\n- **Coordination Number:** $z=6$ (number of nearest neighbors)\n- **Interaction Model:** Pairwise additive interatomic interactions.\n- **Potential Energy Function:** The Buckingham potential, $V(r)=A\\exp(-Br) - C/r^{6}$.\n- **Potential Parameters:** $A$, $B$, and $C$ are positive constants. The units are specified as $A$ in joules (J), $B$ in inverse meters (m⁻¹), $a$ in meters (m), and $C$ in joule$\\cdot$meter$^{6}$ (J$\\cdot$m$^6$).\n- **System Assumptions:** All atoms are identical, and the lattice is infinite (neglecting surface effects).\n- **Approximation:** Nearest-neighbor approximation, where only interactions with the $z=6$ nearest neighbors at separation $r=a$ are considered.\n- **Definition:** The potential energy per atom is one half of the sum of pair interactions with all other atoms.\n- **Objective:** Derive the cohesive energy per atom, $E_{\\mathrm{coh}}(a)$, as a function of $A$, $B$, $C$, and $a$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Groundedness:** The problem is firmly grounded in condensed matter physics and materials science. The simple cubic lattice, Buckingham potential, pairwise additivity, and nearest-neighbor approximation are standard, well-established concepts and models for describing the cohesive properties of crystalline solids.\n- **Well-Posedness:** The problem is well-posed. It provides all necessary information—the lattice geometry, the interaction potential, a simplifying approximation, and a clear definition of the quantity to be derived—to arrive at a unique analytical solution.\n- **Objectivity:** The problem is stated in precise, objective, and unambiguous language.\n- **Conclusion:** The problem is free of scientific inaccuracies, contradictions, and ambiguities. It is a standard and valid problem in introductory solid-state physics.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full, reasoned solution will be provided.\n\n### Derivation of the Cohesive Energy per Atom\n\nThe total potential energy, $U_{\\text{total}}$, of a crystal containing $N$ atoms is given by the sum of the potential energies of all unique pairs of atoms. Assuming pairwise additivity, this can be written as:\n$$U_{\\text{total}} = \\sum_{i<j} V(r_{ij})$$\nwhere $V(r_{ij})$ is the potential energy between atom $i$ and atom $j$, separated by a distance $r_{ij}$.\n\nAn equivalent way to write this sum is to sum over each atom $i$ and its interactions with all other atoms $j \\neq i$. This procedure counts each pair interaction twice (once for the pair $(i,j)$ and once for $(j,i)$). Therefore, a factor of $1/2$ is required to correct for this double counting:\n$$U_{\\text{total}} = \\frac{1}{2} \\sum_{i=1}^{N} \\sum_{j \\neq i} V(r_{ij})$$\nThe cohesive energy per atom, $E_{\\mathrm{coh}}$, is the total potential energy divided by the number of atoms $N$:\n$$E_{\\mathrm{coh}} = \\frac{U_{\\text{total}}}{N} = \\frac{1}{2N} \\sum_{i=1}^{N} \\sum_{j \\neq i} V(r_{ij})$$\nThe problem states that the crystal lattice is infinite and all atoms are identical. This implies that every atom in the lattice is in an equivalent environment. Consequently, the sum of interaction energies of a single atom with all other atoms is the same for every atom in the crystal. Let us select a reference atom, say atom $k$, and calculate its interaction energy with all other atoms:\n$$U_{k} = \\sum_{j \\neq k} V(r_{kj})$$\nDue to the perfect periodicity of the lattice, $U_{k}$ is independent of the choice of $k$. Therefore, the total sum in the expression for $E_{\\mathrm{coh}}$ simplifies to:\n$$\\sum_{i=1}^{N} \\sum_{j \\neq i} V(r_{ij}) = \\sum_{i=1}^{N} U_{i} = N U_{k}$$\nSubstituting this into the expression for $E_{\\mathrm{coh}}$ yields:\n$$E_{\\mathrm{coh}} = \\frac{1}{2N} (N U_{k}) = \\frac{1}{2} U_{k} = \\frac{1}{2} \\sum_{j \\neq k} V(r_{kj})$$\nThis expression matches the definition provided in the problem statement.\n\nWe now apply the nearest-neighbor approximation. In this approximation, we only consider the interactions between the reference atom $k$ and its closest neighbors. For a simple cubic (SC) lattice, each atom has a coordination number of $z=6$. The nearest neighbors are located at a distance equal to the lattice parameter, $a$. Therefore, the distances $r_{kj}$ for all nearest neighbors are equal to $a$.\n\nThe sum over all neighbors $j \\neq k$ is thus approximated by a sum over only the $z=6$ nearest neighbors:\n$$\\sum_{j \\neq k} V(r_{kj}) \\approx \\sum_{j=1}^{z} V(a)$$\nSince the interaction potential $V(a)$ is the same for all $z$ nearest neighbors, this sum becomes:\n$$\\sum_{j=1}^{z} V(a) = z V(a)$$\nSubstituting this approximation into the expression for the cohesive energy per atom gives:\n$$E_{\\mathrm{coh}}(a) = \\frac{1}{2} z V(a)$$\nThe problem provides $z=6$ for the SC lattice and the Buckingham potential:\n$$V(r) = A\\exp(-Br) - \\frac{C}{r^{6}}$$\nWe evaluate this potential at the nearest-neighbor distance $r=a$:\n$$V(a) = A\\exp(-Ba) - \\frac{C}{a^{6}}$$\nFinally, we substitute $z=6$ and the expression for $V(a)$ into the equation for $E_{\\mathrm{coh}}(a)$:\n$$E_{\\mathrm{coh}}(a) = \\frac{1}{2} (6) \\left( A\\exp(-Ba) - \\frac{C}{a^{6}} \\right)$$\nSimplifying this expression gives the final result for the cohesive energy per atom under the nearest-neighbor approximation for an SC lattice:\n$$E_{\\mathrm{coh}}(a) = 3 \\left( A\\exp(-Ba) - \\frac{C}{a^{6}} \\right)$$\nThe units are consistent, as $A$ is in joules and $C/a^6$ is in (J$\\cdot$m$^6$)/m$^6$ = J, so $E_{\\mathrm{coh}}(a)$ is in joules.",
            "answer": "$$\\boxed{3 \\left( A\\exp(-Ba) - \\frac{C}{a^{6}} \\right)}$$"
        },
        {
            "introduction": "While static properties are important, much of materials science involves understanding how materials respond to changes in temperature, $T$. This practice explores thermal expansion, a phenomenon fundamentally rooted in the anharmonicity—or asymmetry—of the interatomic potential well. You will use the Morse potential within a statistical mechanics framework to simulate and measure how the average bond length, $\\langle r \\rangle$, increases with temperature. By comparing the result to a purely harmonic (symmetric) approximation, this exercise provides a concrete demonstration of why anharmonicity is essential for modeling realistic thermal behavior. ",
            "id": "3738556",
            "problem": "Consider a one-dimensional chain whose nearest-neighbor interaction is modeled at the bond level by an anharmonic Morse potential. To couple the microscopic bond-scale model to a mesoscopic long-wavelength elastic response, add a weak harmonic confining term that represents coarse-grained elastic constraints of the chain. The objective is to measure thermal expansion from first principles using the classical canonical ensemble and to compare the measured expansion against a harmonic prediction, thereby quantifying the role of anharmonicity. You must implement a complete and runnable program that carries out the required numerical evaluation.\n\nAssumptions and definitions:\n- Let $r$ denote the bond length (a nonnegative scalar, $r \\ge 0$), and let $r_e$ denote the equilibrium bond length at zero temperature.\n- The Morse potential is defined as $V_M(r) = D_e \\left(1 - e^{-a (r - r_e)}\\right)^2$, where $D_e$ is the well depth (in electronvolts), $a$ is the range parameter (in inverse angstrom), and $r_e$ is the equilibrium bond length (in angstrom).\n- The long-wavelength elastic constraint is modeled by $V_C(r) = \\frac{1}{2} K (r - r_e)^2$, where $K$ is an effective stiffness (in electronvolt per square angstrom).\n- The total potential is $V(r) = V_M(r) + V_C(r)$.\n- The harmonic reference prediction uses a purely quadratic potential $V_H(r) = \\frac{1}{2} k_{\\text{eff}} (r - r_e)^2$, where $k_{\\text{eff}}$ is the effective curvature at the minimum of $V(r)$ obtained by the second derivative of $V_M(r)$ at $r_e$ plus $K$. For the Morse contribution, the second derivative at $r = r_e$ is $2 D_e a^2$, so $k_{\\text{eff}} = 2 D_e a^2 + K$.\n\nClassical canonical ensemble:\n- For a system with coordinate $r$ and temperature $T$, the canonical probability density over bond lengths is proportional to $e^{-\\beta V(r)}$ with $\\beta = 1/(k_B T)$, where $k_B$ is the Boltzmann constant.\n- The normalization (partition function for the coordinate) is $Z(T) = \\int_{0}^{\\infty} e^{-\\beta V(r)} \\, dr$.\n- The thermal average bond length is $\\langle r \\rangle (T) = \\frac{1}{Z(T)} \\int_{0}^{\\infty} r \\, e^{-\\beta V(r)} \\, dr$.\n- Analogously, the harmonic reference average bond length is $\\langle r \\rangle_H (T) = \\frac{\\int_{0}^{\\infty} r \\, e^{-\\beta V_H(r)} \\, dr}{\\int_{0}^{\\infty} e^{-\\beta V_H(r)} \\, dr}$, evaluated on the physical domain $r \\ge 0$.\n\nThermal expansion:\n- Define the thermal expansion coefficient as $\\alpha(T) = \\frac{1}{\\langle r \\rangle (T)} \\frac{d \\langle r \\rangle (T)}{dT}$.\n- In your program, estimate $\\frac{d \\langle r \\rangle (T)}{dT}$ by a central finite difference with a small temperature increment $\\Delta T$: $\\frac{d \\langle r \\rangle}{dT} \\approx \\frac{\\langle r \\rangle (T + \\Delta T) - \\langle r \\rangle (T - \\Delta T)}{2 \\Delta T}$.\n\nUnits:\n- Lengths must be expressed in angstrom ($\\text{\\AA}$).\n- Temperatures must be expressed in kelvin ($\\text{K}$).\n- Energies must be expressed in electronvolt ($\\text{eV}$).\n- Stiffness must be expressed in electronvolt per square angstrom ($\\text{eV}/\\text{\\AA}^2$).\n- The Boltzmann constant must be used in electronvolt per kelvin ($\\text{eV}/\\text{K}$).\n\nFundamental base for derivation:\n- Use the definition of the canonical ensemble, the Morse potential, and Taylor expansion to obtain the harmonic curvature.\n- Do not invoke any shortcut formulas beyond these foundations. All quantities must be obtained either by first principles definitions or numeric evaluation of the corresponding integrals.\n\nTask:\n- Implement numerical integration over $r \\in [0, \\infty)$ to obtain $\\langle r \\rangle (T)$ for the anharmonic case $V(r)$ and $\\langle r \\rangle_H (T)$ for the harmonic reference $V_H(r)$.\n- Use the central finite difference to estimate $\\alpha(T)$ for the anharmonic case.\n\nTest suite:\nFor each test case, compute and return the following three quantities:\n1. The shift of the average bond length from equilibrium for the anharmonic potential, $\\Delta r_{\\text{anh}}(T) = \\langle r \\rangle (T) - r_e$, in $\\text{\\AA}$.\n2. The shift of the average bond length from equilibrium for the harmonic reference, $\\Delta r_{\\text{harm}}(T) = \\langle r \\rangle_H (T) - r_e$, in $\\text{\\AA}$.\n3. The thermal expansion coefficient for the anharmonic potential, $\\alpha(T)$, in $\\text{K}^{-1}$.\n\nUse the following test suite, which is designed to probe different regimes:\n- Test case 1 (general case): $D_e = 0.5 \\, \\text{eV}$, $a = 2.0 \\, \\text{\\AA}^{-1}$, $r_e = 1.2 \\, \\text{\\AA}$, $K = 0.05 \\, \\text{eV}/\\text{\\AA}^2$, $T = 300 \\, \\text{K}$, $\\Delta T = 5 \\, \\text{K}$.\n- Test case 2 (low temperature boundary): $D_e = 1.0 \\, \\text{eV}$, $a = 2.5 \\, \\text{\\AA}^{-1}$, $r_e = 1.0 \\, \\text{\\AA}$, $K = 0.05 \\, \\text{eV}/\\text{\\AA}^2$, $T = 10 \\, \\text{K}$, $\\Delta T = 1 \\, \\text{K}$.\n- Test case 3 (high temperature edge): $D_e = 0.3 \\, \\text{eV}$, $a = 1.5 \\, \\text{\\AA}^{-1}$, $r_e = 1.5 \\, \\text{\\AA}$, $K = 0.02 \\, \\text{eV}/\\text{\\AA}^2$, $T = 1500 \\, \\text{K}$, $\\Delta T = 10 \\, \\text{K}$.\n- Test case 4 (strong confining stiffness): $D_e = 0.5 \\, \\text{eV}$, $a = 2.0 \\, \\text{\\AA}^{-1}$, $r_e = 1.0 \\, \\text{\\AA}$, $K = 0.5 \\, \\text{eV}/\\text{\\AA}^2$, $T = 500 \\, \\text{K}$, $\\Delta T = 5 \\, \\text{K}$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- Each test case must contribute a sublist of three floating-point numbers in the order $[\\Delta r_{\\text{anh}}(T), \\Delta r_{\\text{harm}}(T), \\alpha(T)]$.\n- For example, the output should look like: $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$ where the numerical values are in the units specified above.",
            "solution": "The problem requires the calculation of thermal expansion properties for a one-dimensional chain model. The model incorporates anharmonicity through a Morse potential and mesoscopic elastic effects through a harmonic confining potential. The analysis is performed within the framework of the classical canonical ensemble and compared against a purely harmonic reference model.\n\nThe foundation of this analysis rests on the principles of classical statistical mechanics and numerical methods for evaluating the resulting expressions. The step-by-step derivation and computational strategy are as follows.\n\n**1. Potential Energy Functions**\n\nThe total potential energy $V(r)$ of a single bond of length $r$ is the sum of the Morse potential $V_M(r)$ and a harmonic confining potential $V_C(r)$.\n\nThe Morse potential is given by:\n$$V_M(r) = D_e \\left(1 - e^{-a (r - r_e)}\\right)^2$$\nwhere $D_e$ is the dissociation energy (well depth), $a$ is related to the width of the potential well, and $r_e$ is the equilibrium bond length at zero temperature. This potential is intrinsically anharmonic, being stiffer for compression ($r < r_e$) and softer for extension ($r > r_e$).\n\nThe harmonic confining potential is:\n$$V_C(r) = \\frac{1}{2} K (r - r_e)^2$$\nwhere $K$ is an effective stiffness constant representing long-wavelength elastic constraints.\n\nThe total potential for the anharmonic system is:\n$$V(r) = V_M(r) + V_C(r) = D_e \\left(1 - e^{-a (r - r_e)}\\right)^2 + \\frac{1}{2} K (r - r_e)^2$$\n\n**2. Harmonic Reference Potential**\n\nFor comparison, a harmonic reference potential $V_H(r)$ is defined. This potential is a quadratic approximation to the total potential $V(r)$ around the equilibrium position $r_e$. Its curvature (effective spring constant), $k_{\\text{eff}}$, is determined by the second derivative of $V(r)$ evaluated at $r = r_e$.\n\nFirst, we find the second derivative of the Morse potential, $V_M''(r)$:\n$$V_M'(r) = \\frac{d}{dr} \\left[ D_e \\left(1 - 2e^{-a(r-r_e)} + e^{-2a(r-r_e)}\\right) \\right] = D_e \\left( 2ae^{-a(r-r_e)} - 2ae^{-2a(r-r_e)} \\right)$$\n$$V_M''(r) = \\frac{d}{dr} V_M'(r) = D_e \\left( -2a^2e^{-a(r-r_e)} + 4a^2e^{-2a(r-r_e)} \\right)$$\nEvaluating at $r = r_e$:\n$$V_M''(r_e) = D_e \\left( -2a^2e^{0} + 4a^2e^{0} \\right) = 2 D_e a^2$$\n\nThe second derivative of the confining potential is simply $V_C''(r) = K$.\nThe total effective spring constant is the sum of these curvatures:\n$$k_{\\text{eff}} = V''(r_e) = V_M''(r_e) + V_C''(r_e) = 2 D_e a^2 + K$$\n\nThe harmonic reference potential is centered at $r_e$ with this stiffness:\n$$V_H(r) = \\frac{1}{2} k_{\\text{eff}} (r - r_e)^2$$\n\n**3. Classical Statistical Mechanics Averages**\n\nIn the classical canonical ensemble at a temperature $T$, the probability density for the bond length $r$ is proportional to the Boltzmann factor $e^{-\\beta V(r)}$, where $\\beta = 1/(k_B T)$ and $k_B$ is the Boltzmann constant. The physical domain for the bond length is $r \\ge 0$.\n\nThe thermal average of the bond length, $\\langle r \\rangle(T)$, is given by the expectation value of $r$ over this probability distribution:\n$$\\langle r \\rangle(T) = \\frac{\\int_{0}^{\\infty} r \\, e^{-\\beta V(r)} \\, dr}{\\int_{0}^{\\infty} e^{-\\beta V(r)} \\, dr}$$\nThe denominator is the partition function for the coordinate $r$. These integrals must be evaluated numerically as they do not have a general closed-form solution for the anharmonic potential $V(r)$.\n\nTo find the average bond length for the harmonic reference, $\\langle r \\rangle_H(T)$, we replace $V(r)$ with $V_H(r)$ in the above expression:\n$$\\langle r \\rangle_H(T) = \\frac{\\int_{0}^{\\infty} r \\, e^{-\\beta V_H(r)} \\, dr}{\\int_{0}^{\\infty} e^{-\\beta V_H(r)} \\, dr}$$\nAlthough an analytical solution exists for this integral in terms of the error function (as it corresponds to a truncated normal distribution), the problem specifies implementing numerical integration for consistency.\n\n**4. Calculation of Target Quantities**\n\nThe problem asks for three quantities to be computed for each test case:\n\n1.  **Anharmonic Bond Length Shift**: $\\Delta r_{\\text{anh}}(T) = \\langle r \\rangle(T) - r_e$.\n    This is calculated by first numerically evaluating $\\langle r \\rangle(T)$ using the total potential $V(r)$ and then subtracting $r_e$. This shift is the primary measure of thermal expansion due to the potential's asymmetry.\n\n2.  **Harmonic Bond Length Shift**: $\\Delta r_{\\text{harm}}(T) = \\langle r \\rangle_H(T) - r_e$.\n    This is calculated by numerically evaluating $\\langle r \\rangle_H(T)$ using the harmonic potential $V_H(r)$. Since $V_H(r)$ is symmetric about $r_e$, any non-zero shift is solely due to the truncation of the integration domain at $r=0$. This effect is generally very small for the given parameters where $r_e$ is sufficiently far from $0$.\n\n3.  **Anharmonic Thermal Expansion Coefficient**: $\\alpha(T) = \\frac{1}{\\langle r \\rangle(T)} \\frac{d\\langle r \\rangle(T)}{dT}$.\n    The derivative is estimated using a central finite difference approximation:\n    $$\\frac{d\\langle r \\rangle}{dT} \\approx \\frac{\\langle r \\rangle(T + \\Delta T) - \\langle r \\rangle(T - \\Delta T)}{2 \\Delta T}$$\n    This requires computing the average bond length $\\langle r \\rangle$ for the anharmonic potential $V(r)$ at three temperatures: $T$, $T + \\Delta T$, and $T - \\Delta T$.\n\n**5. Numerical Implementation**\n\nThe computational procedure for each test case is as follows:\n- Set the physical parameters $D_e, a, r_e, K, T, \\Delta T$ and the value of $k_B$ in the correct units ($\\text{eV}/\\text{K}$).\n- Define Python functions for the potentials $V(r)$ and $V_H(r)$. For $V_H(r)$, first compute $k_{\\text{eff}} = 2 D_e a^2 + K$.\n- Create a reusable function to compute $\\langle r \\rangle$ for a given potential function and temperature. This function will use a numerical quadrature routine (`scipy.integrate.quad`) to evaluate the two required integrals (numerator and denominator) over the domain $[0, \\infty)$.\n- For the anharmonic case, call this function to compute $\\langle r \\rangle(T)$, $\\langle r \\rangle(T + \\Delta T)$, and $\\langle r \\rangle(T - \\Delta T)$.\n- Use these values to calculate $\\Delta r_{\\text{anh}}(T)$ and $\\alpha(T)$.\n- For the harmonic case, call the function to compute $\\langle r \\rangle_H(T)$ and from it, $\\Delta r_{\\text{harm}}(T)$.\n- Collect the three resulting floating-point numbers, $[\\Delta r_{\\text{anh}}(T), \\Delta r_{\\text{harm}}(T), \\alpha(T)]$, for the final output.\nThis process is repeated for all specified test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate, special\n\ndef solve():\n    \"\"\"\n    Computes thermal expansion properties for a 1D chain model.\n\n    This function iterates through a set of test cases, each defining the parameters\n    for a Morse potential plus a harmonic confining term. For each case, it calculates:\n    1. The shift in average bond length for the full anharmonic potential.\n    2. The shift in average bond length for a harmonic reference potential.\n    3. The thermal expansion coefficient for the anharmonic potential.\n\n    The calculations are based on the classical canonical ensemble, with averages\n    computed via numerical integration of the Boltzmann-weighted quantities.\n    \"\"\"\n    \n    # Boltzmann constant in eV/K\n    KB_EV_K = 8.617333262145e-5\n\n    test_cases = [\n        # (De, a, re, K, T, dT)\n        # De in eV, a in 1/Angstrom, re in Angstrom, K in eV/Angstrom^2, T in K, dT in K\n        (0.5, 2.0, 1.2, 0.05, 300, 5),\n        (1.0, 2.5, 1.0, 0.05, 10, 1),\n        (0.3, 1.5, 1.5, 0.02, 1500, 10),\n        (0.5, 2.0, 1.0, 0.5, 500, 5),\n    ]\n\n    results = []\n    \n    def calculate_avg_r(potential_func, temp, params):\n        \"\"\"\n        Calculates the thermal average bond length <r> for a given potential.\n        \n        Args:\n            potential_func: A function V(r, params) that returns the potential energy.\n            temp: Temperature in Kelvin.\n            params: A dictionary of parameters for the potential function.\n            \n        Returns:\n            The average bond length <r> in Angstrom.\n        \"\"\"\n        if temp <= 0:\n            # At T=0, the average position is exactly the potential minimum.\n            # For V_H, it's r_e. For V, it's also effectively r_e as defined.\n            return params['re']\n\n        beta = 1.0 / (KB_EV_K * temp)\n\n        # Integrand for the numerator: r * exp(-beta * V(r))\n        numerator_integrand = lambda r: r * np.exp(-beta * potential_func(r, params))\n        \n        # Integrand for the denominator (partition function Z): exp(-beta * V(r))\n        denominator_integrand = lambda r: np.exp(-beta * potential_func(r, params))\n        \n        # Numerical integration from 0 to infinity\n        numerator_val, _ = integrate.quad(numerator_integrand, 0, np.inf)\n        denominator_val, _ = integrate.quad(denominator_integrand, 0, np.inf)\n        \n        if denominator_val == 0:\n            return params['re'] # Avoid division by zero; implies delta function at re\n\n        return numerator_val / denominator_val\n\n    # Potential function definitions\n    def v_anharmonic(r, p):\n        morse = p['De'] * (1 - np.exp(-p['a'] * (r - p['re'])))**2\n        confine = 0.5 * p['K'] * (r - p['re'])**2\n        return morse + confine\n        \n    def v_harmonic(r, p):\n        k_eff = 2 * p['De'] * p['a']**2 + p['K']\n        return 0.5 * k_eff * (r - p['re'])**2\n\n    for case in test_cases:\n        De, a, re, K, T, dT = case\n        \n        params = {'De': De, 'a': a, 're': re, 'K': K}\n\n        # 1. Anharmonic shift\n        r_avg_anh_T = calculate_avg_r(v_anharmonic, T, params)\n        delta_r_anh = r_avg_anh_T - re\n        \n        # 2. Harmonic shift\n        r_avg_harm_T = calculate_avg_r(v_harmonic, T, params)\n        delta_r_harm = r_avg_harm_T - re\n        \n        # 3. Thermal expansion coefficient\n        T_plus = T + dT\n        T_minus = T - dT\n        \n        r_avg_anh_T_plus = calculate_avg_r(v_anharmonic, T_plus, params)\n        r_avg_anh_T_minus = calculate_avg_r(v_anharmonic, T_minus, params)\n        \n        dr_dT = (r_avg_anh_T_plus - r_avg_anh_T_minus) / (2 * dT)\n        \n        if r_avg_anh_T == 0:\n            alpha = 0.0 # Avoid division by zero\n        else:\n            alpha = dr_dT / r_avg_anh_T\n        \n        results.append([delta_r_anh, delta_r_harm, alpha])\n\n    # Format the output string precisely as requested\n    output_str = \"[\" + \",\".join([f\"[{x:.8e},{y:.8e},{z:.8e}]\" for x, y, z in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The mathematical form of a potential has profound consequences for its use in numerical simulations. This exercise addresses a critical practical issue known as the 'Buckingham catastrophe'—the unphysical divergence of the potential $U(r)$ to negative infinity as the interatomic distance $r \\to 0$. You will analyze the short-range asymptotic behavior of both the Buckingham and Morse potentials to understand why one is inherently more stable. The practice culminates in developing a regularized potential, $U_{\\mathrm{reg}}(r)$, by applying a damping function, a common and essential technique for creating robust force fields. ",
            "id": "3738646",
            "problem": "Consider two widely used pairwise interaction models for atoms: the Buckingham potential and the Morse potential. The Buckingham potential is given by $U_{\\mathrm{B}}(r) = A \\exp(-Br) - C r^{-6}$, where $A$, $B$, and $C$ are positive constants, and $r$ is the interatomic separation. The Morse potential is given by $U_{\\mathrm{M}}(r) = D_{e} \\left[ \\exp\\!\\left(- 2 a (r - r_{e})\\right) - 2 \\exp\\!\\left(- a (r - r_{e})\\right) \\right]$, where $D_{e}$, $a$, and $r_{e}$ are positive constants. In all cases, the corresponding pairwise force is defined by the fundamental relation $F(r) = - \\frac{d U}{d r}$.\n\nTasks:\n1. Starting from the given definitions and the force law $F(r) = - dU/dr$, determine the leading-order asymptotic behavior of $U(r)$ and $F(r)$ as $r \\to 0$ for both $U_{\\mathrm{B}}(r)$ and $U_{\\mathrm{M}}(r)$. Assess whether each potential requires short-range regularization for stable numerical implementation in multiscale modeling and analysis when integrating equations of motion.\n2. Construct a regularized form $U_{\\mathrm{reg}}(r)$ for the Buckingham potential that eliminates any $r \\to 0$ singularity in both $U(r)$ and $F(r)$ while preserving the original large-$r$ dispersion behavior $- C r^{-6}$. To achieve this, multiply the dispersion term by a damping function $f_{6}(x)$ that satisfies $f_{6}(x) \\sim x^{7} / 7!$ as $x \\to 0$ and $f_{6}(x) \\to 1$ as $x \\to \\infty$, with $x = b r$ and $b > 0$ a tunable short-range parameter. Derive the explicit closed-form analytic expression for $U_{\\mathrm{reg}}(r)$ in terms of $A$, $B$, $C$, $b$, and $r$.\n\nAnswer form: Provide your final answer as a single closed-form analytic expression for $U_{\\mathrm{reg}}(r)$. No units are required. No rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on standard potential energy functions used in computational physics and chemistry, and the tasks involve standard mathematical analysis (asymptotics, differentiation) and model construction (regularization). The problem provides a clear prescription for the construction of the regularized potential, implying a standard functional form for the damping function that is readily identifiable from the provided constraints. Therefore, the problem is valid and a solution will be provided.\n\nThe problem consists of two tasks. First, we analyze the short-range behavior of the Buckingham and Morse potentials and the corresponding forces. Second, we construct a regularized version of the Buckingham potential to cure its short-range singularity.\n\n**Part 1: Asymptotic Analysis and Need for Regularization**\n\nThe force $F(r)$ is related to the potential $U(r)$ by $F(r) = - \\frac{dU}{dr}$.\n\n**Buckingham Potential:**\nThe Buckingham potential is given by $U_{\\mathrm{B}}(r) = A \\exp(-Br) - C r^{-6}$, with $A, B, C > 0$.\n\nLet's examine the behavior as the interatomic separation $r$ approaches $0$.\nAs $r \\to 0$:\nThe repulsive term $A \\exp(-Br)$ approaches a finite limit:\n$$ \\lim_{r \\to 0} A \\exp(-Br) = A \\exp(0) = A $$\nThe attractive dispersion term $-C r^{-6}$ diverges to $-\\infty$:\n$$ \\lim_{r \\to 0} -C r^{-6} = -\\infty $$\nThe dominant behavior of the potential is therefore determined by the dispersion term. The asymptotic behavior of the potential is:\n$$ U_{\\mathrm{B}}(r) \\sim -C r^{-6} \\quad \\text{as } r \\to 0 $$\nThis unphysical behavior, where the potential energy drops to $-\\infty$ as atoms approach each other, is known as the \"Buckingham catastrophe\".\n\nNext, we derive the force $F_{\\mathrm{B}}(r)$:\n$$ F_{\\mathrm{B}}(r) = - \\frac{d}{dr} \\left( A \\exp(-Br) - C r^{-6} \\right) = - \\left( A (-B) \\exp(-Br) - C(-6)r^{-7} \\right) $$\n$$ F_{\\mathrm{B}}(r) = AB \\exp(-Br) - 6 C r^{-7} $$\nNow, we examine the behavior of the force as $r \\to 0$:\nThe term derived from the repulsion, $AB \\exp(-Br)$, approaches a finite limit $AB$.\nThe term derived from attraction, $-6 C r^{-7}$, diverges to $-\\infty$.\nThus, the asymptotic behavior of the force is:\n$$ F_{\\mathrm{B}}(r) \\sim -6 C r^{-7} \\quad \\text{as } r \\to 0 $$\nThe force also diverges to $-\\infty$, implying an infinitely strong attractive force at zero separation. In numerical simulations (e.g., molecular dynamics), this would cause atoms to collapse onto each other, leading to instability. Therefore, the Buckingham potential requires short-range regularization for stable numerical implementation.\n\n**Morse Potential:**\nThe Morse potential is given by $U_{\\mathrm{M}}(r) = D_{e} \\left[ \\exp(-2a(r-r_e)) - 2\\exp(-a(r-r_e)) \\right]$, with $D_e, a, r_e > 0$.\n\nLet's examine the behavior as $r \\to 0$:\n$$ \\lim_{r \\to 0} U_{\\mathrm{M}}(r) = D_{e} \\left[ \\exp(-2a(0-r_e)) - 2\\exp(-a(0-r_e)) \\right] = D_{e} \\left[ \\exp(2ar_e) - 2\\exp(ar_e) \\right] $$\nSince $D_e$, $a$, and $r_e$ are positive constants, this limit is a finite (though typically large and positive) value. The potential does not diverge.\n\nNext, we derive the force $F_{\\mathrm{M}}(r)$:\n$$ F_{\\mathrm{M}}(r) = - \\frac{d}{dr} \\left( D_{e} \\left[ \\exp(-2a(r-r_e)) - 2\\exp(-a(r-r_e)) \\right] \\right) $$\n$$ F_{\\mathrm{M}}(r) = -D_{e} \\left[ -2a \\exp(-2a(r-r_e)) - 2(-a)\\exp(-a(r-r_e)) \\right] $$\n$$ F_{\\mathrm{M}}(r) = 2aD_{e} \\left[ \\exp(-2a(r-r_e)) - \\exp(-a(r-r_e)) \\right] $$\nNow, we examine the behavior of the force as $r \\to 0$:\n$$ \\lim_{r \\to 0} F_{\\mathrm{M}}(r) = 2aD_{e} \\left[ \\exp(2ar_e) - \\exp(ar_e) \\right] $$\nThis limit is also a finite, large, positive value, representing a strong but not singular repulsive force at short distances.\nSince both the potential and the force approach finite values as $r \\to 0$, the Morse potential is well-behaved at short range and does not require regularization for numerical stability.\n\n**Part 2: Construction of a Regularized Buckingham Potential**\n\nThe task is to construct a regularized potential $U_{\\mathrm{reg}}(r)$ by modifying the singular dispersion term, $-C r^{-6}$, of the Buckingham potential. The modification consists of multiplying this term by a damping function $f_6(br)$, where $x=br$. The damping function must satisfy the asymptotic conditions:\n1. $f_6(x) \\sim x^7 / 7!$ as $x \\to 0$\n2. $f_6(x) \\to 1$ as $x \\to \\infty$\n\nThe second condition ensures that the regularized potential recovers the original Buckingham form at large distances, preserving the correct long-range physics. The first condition is designed to cancel the $r^{-6}$ singularity and make the potential and force finite at $r=0$.\n\nA standard family of damping functions used for this purpose is the Tang-Toennies form, which is related to the regularized lower incomplete gamma function:\n$$ f_n(x) = 1 - \\exp(-x) \\sum_{k=0}^{n} \\frac{x^k}{k!} $$\nLet us verify if this functional form with an appropriate choice of $n$ satisfies the given conditions.\nAs $x \\to \\infty$, the term $\\exp(-x)$ decays to zero faster than any polynomial in $x$ grows. Therefore, $\\exp(-x) \\sum_{k=0}^{n} \\frac{x^k}{k!} \\to 0$, which means $f_n(x) \\to 1$. This satisfies the second condition for any $n$.\n\nFor the behavior as $x \\to 0$, we consider the Taylor series expansion of $\\exp(x) = \\sum_{k=0}^{\\infty} \\frac{x^k}{k!}$. We can write $\\sum_{k=0}^{n} \\frac{x^k}{k!} = \\exp(x) - \\sum_{k=n+1}^{\\infty} \\frac{x^k}{k!}$.\nSubstituting this into the expression for $f_n(x)$:\n$$ f_n(x) = 1 - \\exp(-x) \\left( \\exp(x) - \\sum_{k=n+1}^{\\infty} \\frac{x^k}{k!} \\right) = 1 - \\left( 1 - \\exp(-x) \\sum_{k=n+1}^{\\infty} \\frac{x^k}{k!} \\right) = \\exp(-x) \\sum_{k=n+1}^{\\infty} \\frac{x^k}{k!} $$\n$$ f_n(x) = \\exp(-x) \\left( \\frac{x^{n+1}}{(n+1)!} + \\frac{x^{n+2}}{(n+2)!} + \\dots \\right) $$\nAs $x \\to 0$, $\\exp(-x) \\to 1$. The leading-order term is:\n$$ f_n(x) \\sim \\frac{x^{n+1}}{(n+1)!} $$\nThe problem specifies the damping function as $f_6(x)$ and requires the asymptotic behavior $f_6(x) \\sim x^7/7!$. This matches our derived behavior for $n=6$. Thus, the correct damping function is:\n$$ f_6(x) = 1 - \\exp(-x) \\sum_{k=0}^{6} \\frac{x^k}{k!} $$\nThe regularized Buckingham potential, $U_{\\mathrm{reg}}(r)$, is formed by replacing the $-C r^{-6}$ term with $-C r^{-6} f_6(br)$:\n$$ U_{\\mathrm{reg}}(r) = A \\exp(-Br) - C r^{-6} f_6(br) $$\nSubstituting the explicit form of $f_6(br)$ with $x=br$:\n$$ U_{\\mathrm{reg}}(r) = A \\exp(-Br) - C r^{-6} \\left( 1 - \\exp(-br) \\sum_{k=0}^{6} \\frac{(br)^k}{k!} \\right) $$\nLet's confirm the regularization. As $r \\to 0$, $br \\to 0$, and we use $f_6(br) \\sim (br)^7/7!$.\nThe modified attractive term becomes:\n$$ -C r^{-6} f_6(br) \\sim -C r^{-6} \\frac{(br)^7}{7!} = -C \\frac{b^7 r^7}{7! r^6} = -\\frac{C b^7}{7!} r $$\nSo, $\\lim_{r \\to 0} -C r^{-6} f_6(br) = 0$.\nThe entire potential at $r \\to 0$ becomes:\n$$ \\lim_{r \\to 0} U_{\\mathrm{reg}}(r) = \\lim_{r \\to 0} A \\exp(-Br) - \\lim_{r \\to 0} \\frac{C b^7}{7!} r = A - 0 = A $$\nThe potential is now finite at the origin, successfully removing the singularity.\n\nThe final, explicit, closed-form analytic expression for the regularized potential is obtained by writing out the summation.\n$$ U_{\\mathrm{reg}}(r) = A \\exp(-Br) - C r^{-6} \\left( 1 - \\exp(-br) \\left[ \\frac{(br)^0}{0!} + \\frac{(br)^1}{1!} + \\frac{(br)^2}{2!} + \\frac{(br)^3}{3!} + \\frac{(br)^4}{4!} + \\frac{(br)^5}{5!} + \\frac{(br)^6}{6!} \\right] \\right) $$\nUsing the compact summation notation provides the most elegant and standard representation.\n$$ U_{\\mathrm{reg}}(r) = A \\exp(-Br) - C r^{-6} \\left( 1 - \\exp(-br) \\sum_{k=0}^{6} \\frac{(br)^k}{k!} \\right) $$",
            "answer": "$$ \\boxed{A \\exp(-Br) - C r^{-6} \\left( 1 - \\exp(-br) \\sum_{k=0}^{6} \\frac{(br)^k}{k!} \\right)} $$"
        }
    ]
}