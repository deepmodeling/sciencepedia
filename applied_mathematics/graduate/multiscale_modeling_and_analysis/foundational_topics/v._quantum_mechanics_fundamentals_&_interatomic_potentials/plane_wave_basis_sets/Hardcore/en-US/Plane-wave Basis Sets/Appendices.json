{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of a plane-wave calculation is the basis set, which is defined by a single parameter: the kinetic energy cutoff, $E_{\\mathrm{cut}}$. This exercise provides direct, hands-on practice in translating this abstract concept into a concrete computational task. You will generate the precise set of reciprocal lattice vectors, or G-vectors, that constitute the basis for a given simulation cell and energy cutoff, a fundamental first step in any plane-wave simulation .",
            "id": "3833123",
            "problem": "Consider an orthorhombic periodic simulation cell with side lengths $(L_x,L_y,L_z)$, where the plane-wave basis is indexed by reciprocal lattice vectors $\\mathbf{G} = \\left(G_x,G_y,G_z\\right)$ associated with integer triplets $(n_x,n_y,n_z)\\in\\mathbb{Z}^3$ via the reciprocal-space definition $G_i = \\frac{2\\pi n_i}{L_i}$ for each Cartesian direction $i\\in\\{x,y,z\\}$. Under Born–von Karman periodic boundary conditions, plane waves $\\exp\\left(i\\,\\mathbf{G}\\cdot \\mathbf{r}\\right)$ are eigenfunctions of the kinetic-energy operator $-\\frac{\\hbar^2}{2m}\\nabla^2$ for a free electron of mass $m$, with eigenvalues depending on $|\\mathbf{G}|^2$, where $\\hbar$ is the reduced Planck constant. The kinetic energy increases monotonically with $|\\mathbf{G}|^2$ and defines a natural ordering of basis functions by increasing kinetic energy.\n\nTask: For each specified test case, generate the complete set of integer triplets $(n_x,n_y,n_z)$ such that the corresponding plane-wave kinetic energy at the $\\Gamma$-point (i.e., with the crystal wavevector $\\mathbf{k}=\\mathbf{0}$) does not exceed a given energy cutoff $E_{\\mathrm{cut}}$. Then order the triplets by increasing kinetic energy; for triplets having exactly equal kinetic energy, break ties by lexicographic ordering of $(n_x,n_y,n_z)$ in ascending order. Count how many triplets satisfy the cutoff, and list them in the specified order.\n\nFundamental base for the derivation and implementation consists of the following well-tested facts:\n- The reciprocal vector components satisfy $G_i=\\frac{2\\pi n_i}{L_i}$ for each $i\\in\\{x,y,z\\}$ and $(n_x,n_y,n_z)\\in\\mathbb{Z}^3$.\n- The kinetic-energy operator for a free electron is $-\\frac{\\hbar^2}{2m}\\nabla^2$.\n- Plane waves are eigenfunctions of the Laplacian and their kinetic energy depends on $|\\mathbf{G}|^2$.\n- The ordering by increasing kinetic energy is equivalent to ordering by increasing $|\\mathbf{G}|^2$.\n\nUnits and constants:\n- Use the International System of Units (SI). Cell lengths must be in meters (m), energy cutoffs in Joules (J).\n- Use the electron rest mass $m = 9.1093837015\\times 10^{-31}$ kg and the reduced Planck constant $\\hbar = 1.054571817\\times 10^{-34}$ J·s.\n\nNumerical inclusivity and robustness:\n- A plane wave is included if its computed kinetic energy is less than or equal to $E_{\\mathrm{cut}}$. To avoid floating-point under-inclusion at equality, implement the comparison as $E \\le E_{\\mathrm{cut}}\\,(1+\\delta_{\\mathrm{rel}}) + \\delta_{\\mathrm{abs}}$, with $\\delta_{\\mathrm{rel}}=10^{-12}$ and $\\delta_{\\mathrm{abs}}=10^{-32}$ J.\n\nYour program must, for each test case, return:\n- The integer count of included triplets.\n- The ordered list of all included triplets as a list of lists $[n_x,n_y,n_z]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is of the form $[\\,\\text{count},\\,\\text{ordered\\_triplets}\\,]$.\n\nTest suite (each tuple is $(L_x,L_y,L_z,E_{\\mathrm{cut}})$, with $L$ in meters and $E_{\\mathrm{cut}}$ in Joules):\n- Case A (general isotropic cell): $(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,3.0\\times 10^{-19}\\right)$.\n- Case B (boundary cutoff at zero): $(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,0\\right)$.\n- Case C (anisotropic cell): $(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{-19}\\right)$.\n- Case D (degenerate shell inclusion at equality): $(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,4.820\\times 10^{-19}\\right)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example: $[[\\text{count}_A,\\text{list}_A],[\\text{count}_B,\\text{list}_B],[\\text{count}_C,\\text{list}_C],[\\text{count}_D,\\text{list}_D]]$.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of quantum mechanics as applied to periodic systems, a cornerstone of computational materials science. The problem is well-posed, providing all necessary physical constants, mathematical definitions, and numerical tolerances to determine a unique, verifiable solution. The language is objective and the requirements are unambiguous.\n\nThe primary objective is to identify the set of plane-wave basis functions, indexed by integer triplets $(n_x, n_y, n_z)$, that satisfy a given kinetic energy cutoff, $E_{\\mathrm{cut}}$. The basis functions are considered at the $\\Gamma$-point of the Brillouin zone, corresponding to a crystal wavevector $\\mathbf{k}=\\mathbf{0}$.\n\nFirst, we establish the relationship between the kinetic energy of a plane wave and its corresponding integer triplet. The time-independent Schrödinger equation for a free electron of mass $m$ is governed by the kinetic-energy operator $\\hat{T} = -\\frac{\\hbar^2}{2m}\\nabla^2$. The plane waves, given as $\\psi_{\\mathbf{G}}(\\mathbf{r}) \\propto \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r})$, are eigenfunctions of this operator. Here, $\\mathbf{G}$ is a reciprocal lattice vector. Applying the operator yields:\n$$\n\\hat{T} \\psi_{\\mathbf{G}}(\\mathbf{r}) = -\\frac{\\hbar^2}{2m}\\nabla^2 \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r}) = -\\frac{\\hbar^2}{2m}(i\\mathbf{G})\\cdot(i\\mathbf{G}) \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r}) = \\frac{\\hbar^2|\\mathbf{G}|^2}{2m} \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r})\n$$\nThe kinetic energy eigenvalue $E_{\\mathbf{G}}$ is therefore:\n$$\nE_{\\mathbf{G}} = \\frac{\\hbar^2|\\mathbf{G}|^2}{2m}\n$$\nFor an orthorhombic simulation cell with side lengths $(L_x, L_y, L_z)$, the components of the reciprocal lattice vector $\\mathbf{G} = (G_x, G_y, G_z)$ are defined in terms of the integer triplet $(n_x, n_y, n_z) \\in \\mathbb{Z}^3$ as $G_i = \\frac{2\\pi n_i}{L_i}$ for $i \\in \\{x, y, z\\}$. The squared magnitude $|\\mathbf{G}|^2$ is:\n$$\n|\\mathbf{G}|^2 = G_x^2 + G_y^2 + G_z^2 = \\left(\\frac{2\\pi n_x}{L_x}\\right)^2 + \\left(\\frac{2\\pi n_y}{L_y}\\right)^2 + \\left(\\frac{2\\pi n_z}{L_z}\\right)^2 = 4\\pi^2 \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right)\n$$\nSubstituting this into the energy eigenvalue expression gives the kinetic energy $E_{n_x,n_y,n_z}$ for a specific triplet:\n$$\nE_{n_x,n_y,n_z} = \\frac{\\hbar^2}{2m} \\left[ 4\\pi^2 \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right) \\right] = \\frac{2\\pi^2\\hbar^2}{m} \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right)\n$$\nThe task is to find all integer triplets $(n_x, n_y, n_z)$ such that $E_{n_x,n_y,n_z} \\le E_{\\mathrm{cut}}$. To handle floating-point precision at the boundary, this condition is implemented using a tolerance:\n$$\nE_{n_x,n_y,n_z} \\le E_{\\mathrm{cut,eff}} \\quad \\text{where} \\quad E_{\\mathrm{cut,eff}} = E_{\\mathrm{cut}}(1 + \\delta_{\\mathrm{rel}}) + \\delta_{\\mathrm{abs}}\n$$\nwith $\\delta_{\\mathrm{rel}}=10^{-12}$ and $\\delta_{\\mathrm{abs}}=10^{-32}$ J.\n\nThe algorithmic procedure to solve the problem for each test case is as follows:\n$1$. **Initialization**: For a given test case $(L_x, L_y, L_z, E_{\\mathrm{cut}})$, the effective energy cutoff $E_{\\mathrm{cut,eff}}$ is computed. The constant prefactor $C_{\\text{factor}} = \\frac{2\\pi^2\\hbar^2}{m}$ is also calculated. The condition for including a triplet becomes:\n$$\n\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2} \\le \\frac{E_{\\mathrm{cut,eff}}}{C_{\\text{factor}}}\n$$\nThis inequality describes an ellipsoid in $(n_x, n_y, n_z)$ space, which bounds the search for valid integer triplets.\n\n$2$. **Ellipsoidal Search**: An efficient search is conducted by iterating through nested loops whose bounds are dynamically constrained by the ellipsoidal condition. This avoids searching a much larger rectangular volume.\n- The maximum possible value for $|n_x|$ is found by setting $n_y=0$ and $n_z=0$: $n_{x,\\max} = \\lfloor L_x \\sqrt{E_{\\mathrm{cut,eff}} / C_{\\text{factor}}} \\rfloor$. We iterate $n_x$ from $-n_{x,\\max}$ to $n_{x,\\max}$.\n- For each $n_x$, the maximum possible value for $|n_y|$ is found by setting $n_z=0$: $n_{y,\\max}(n_x) = \\lfloor L_y \\sqrt{E_{\\mathrm{cut,eff}}/C_{\\text{factor}} - n_x^2/L_x^2} \\rfloor$. We iterate $n_y$ from $-n_{y,\\max}(n_x)$ to $n_{y,\\max}(n_x)$.\n- For each pair $(n_x, n_y)$, the maximum possible value for $|n_z|$ is: $n_{z,\\max}(n_x, n_y) = \\lfloor L_z \\sqrt{E_{\\mathrm{cut,eff}}/C_{\\text{factor}} - n_x^2/L_x^2 - n_y^2/L_y^2} \\rfloor$. We iterate $n_z$ from $-n_{z,\\max}(n_x, n_y)$ to $n_{z,\\max}(n_x, n_y)$.\nEvery triplet $(n_x, n_y, n_z)$ generated by this procedure is guaranteed to satisfy the energy cutoff condition. These valid triplets are collected.\n\n$3$. **Sorting**: The collected triplets must be sorted according to the specified criteria.\n- **Primary key**: The exact kinetic energy $E_{n_x,n_y,n_z}$ (calculated without the tolerance factors), in ascending order.\n- **Secondary key**: For triplets with degenerate (identical) energies, a tie is broken by sorting them in ascending lexicographical order of $(n_x, n_y, n_z)$.\nThis is achieved by creating a list of tuples of the form $(E_{n_x,n_y,n_z}, n_x, n_y, n_z)$ for each valid triplet and then performing a standard sort on this list.\n\n$4$. **Finalization**: After sorting, the ordered list of triplets is extracted. The final result for the test case consists of the total count of the valid triplets and the ordered list of these triplets. This process is repeated for all test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plane-wave basis set problem for a suite of test cases.\n    For each case, it finds all integer triplets (nx, ny, nz) whose\n    corresponding kinetic energy is below a cutoff, then sorts them\n    by energy and lexicographically.\n    \"\"\"\n\n    # --- Constants and Tolerances ---\n    # Electron rest mass in kg\n    m_e = 9.1093837015e-31\n    # Reduced Planck constant in J·s\n    hbar = 1.054571817e-34\n    # Relative and absolute tolerances for energy comparison\n    delta_rel = 1e-12\n    delta_abs = 1e-32\n\n    # --- Test Suite ---\n    # Each tuple is (Lx, Ly, Lz, E_cut) in SI units (m, J)\n    test_cases = [\n        # Case A (general isotropic cell)\n        (1.0e-9, 1.0e-9, 1.0e-9, 3.0e-19),\n        # Case B (boundary cutoff at zero)\n        (1.0e-9, 1.0e-9, 1.0e-9, 0.0),\n        # Case C (anisotropic cell)\n        (1.0e-9, 2.0e-9, 3.0e-9, 1.0e-19),\n        # Case D (degenerate shell inclusion at equality)\n        (1.0e-9, 1.0e-9, 1.0e-9, 4.820e-19),\n    ]\n\n    # List to store final results for all test cases\n    all_results = []\n\n    # --- Main Logic ---\n    # Pre-calculate the constant factor in the energy equation\n    C_factor = (2 * (np.pi**2) * (hbar**2)) / m_e\n\n    for case in test_cases:\n        Lx, Ly, Lz, E_cut = case\n\n        # Apply numerical tolerance to the energy cutoff\n        E_cut_eff = E_cut * (1 + delta_rel) + delta_abs\n        \n        # A list to store tuples of (energy, nx, ny, nz) for sorting\n        found_triplets_with_energy = []\n        \n        # Handle the E_cut_eff < 0 case explicitly to avoid sqrt of negative\n        if E_cut_eff < 0:\n            all_results.append([0, []])\n            continue\n            \n        # Determine the search range for nx (outermost loop)\n        # We use a try-except block for sqrt(negative) arising from float precision\n        try:\n            nx_max = int(np.floor(Lx * np.sqrt(E_cut_eff / C_factor)))\n        except (ValueError, RuntimeWarning):\n            nx_max = 0\n\n        # Efficiently search the ellipsoid of valid (nx, ny, nz) triplets\n        for nx in range(-nx_max, nx_max + 1):\n            E_rem_y = E_cut_eff - C_factor * ((nx / Lx)**2)\n            if E_rem_y < 0:\n                continue\n            \n            try:\n                ny_max = int(np.floor(Ly * np.sqrt(E_rem_y / C_factor)))\n            except (ValueError, RuntimeWarning):\n                ny_max = 0\n\n            for ny in range(-ny_max, ny_max + 1):\n                E_rem_z = E_cut_eff - C_factor * (((nx / Lx)**2) + ((ny / Ly)**2))\n                if E_rem_z < 0:\n                    continue\n\n                try:\n                    nz_max = int(np.floor(Lz * np.sqrt(E_rem_z / C_factor)))\n                except (ValueError, RuntimeWarning):\n                    nz_max = 0\n                \n                for nz in range(-nz_max, nz_max + 1):\n                    # For a valid triplet, calculate its precise energy for sorting\n                    energy = C_factor * (((nx / Lx)**2) + ((ny / Ly)**2) + ((nz / Lz)**2))\n                    # The search guarantees energy <= E_cut_eff. No re-check needed.\n                    found_triplets_with_energy.append((energy, nx, ny, nz))\n        \n        # Sort the results: primary key is energy, secondary is lexicographical (nx,ny,nz)\n        found_triplets_with_energy.sort(key=lambda item: (item[0], item[1], item[2], item[3]))\n        \n        # Extract the sorted triplets, discarding the energy values\n        sorted_triplets = [[t[1], t[2], t[3]] for t in found_triplets_with_energy]\n        \n        # Get the count of found triplets\n        count = len(sorted_triplets)\n        \n        # Append the result for the current case to the main results list\n        all_results.append([count, sorted_triplets])\n\n    # Format the final output string exactly as required, removing all spaces from the string representation\n    # of the list of lists.\n    final_output = str(all_results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Efficient plane-wave calculations rely on Fast Fourier Transforms (FFTs) to switch between reciprocal space, where the kinetic energy is diagonal, and real space, where the local potential is diagonal. However, representing the charge density—a product of two wavefunctions—on a real-space grid requires careful consideration to avoid numerical artifacts. This problem delves into the Nyquist-Shannon sampling theorem to determine the minimum grid density needed to represent the charge density accurately without aliasing, a crucial step for ensuring the fidelity of a simulation .",
            "id": "3833072",
            "problem": "Consider an orthorhombic periodic simulation cell with real-space edge lengths $L_x$, $L_y$, and $L_z$, and a plane-wave basis set for electronic wavefunctions truncated at a kinetic energy cutoff $E_{\\mathrm{cut}}$ (in Hartree atomic units). The charge density is formed from products of the wavefunctions and evaluated on a three-dimensional Fast Fourier Transform (FFT) grid of dimensions $(N_x,N_y,N_z)$. Using only fundamental definitions of Fourier transforms, the Nyquist-Shannon sampling theorem, and the kinetic energy of a plane wave in atomic units, determine whether aliasing (wrap-around) errors will occur in forming the charge density, and compute the minimal integer grid dimensions that avoid such errors along each Cartesian axis.\n\nAssume the following:\n- The kinetic energy of a plane wave with wavevector $\\mathbf{G}$ is $E_{\\mathrm{kin}}(\\mathbf{G}) = \\frac{1}{2}|\\mathbf{G}|^{2}$ in Hartree atomic units.\n- The wavefunction plane-wave basis includes all $\\mathbf{G}$ with $|\\mathbf{G}| \\leq G_{\\mathrm{cut}}$ implied by $E_{\\mathrm{cut}}$.\n- The orthorhombic cell has edge lengths $L_x = 8$ bohr, $L_y = 10$ bohr, and $L_z = 12$ bohr.\n- The FFT grid dimensions are $(N_x,N_y,N_z) = (36,48,64)$.\n\nYour task:\n1. Derive from first principles a criterion that guarantees the absence of aliasing when sampling the charge density on the FFT grid, expressed as a condition relating $(N_x,N_y,N_z)$, $(L_x,L_y,L_z)$, and $E_{\\mathrm{cut}}$.\n2. Using $E_{\\mathrm{cut}} = 30$ Hartree, evaluate whether aliasing will occur with the given $(N_x,N_y,N_z)$.\n3. Compute the minimal integer triple $(N_x',N_y',N_z')$ that avoids aliasing along each axis under these conditions.\n\nExpress your final answer as a single row matrix containing the triple $(N_x',N_y',N_z')$. No rounding instruction is required beyond choosing the smallest integers that satisfy the derived criterion. Do not include any units in your final answer.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard problem in computational materials science. Therefore, the problem is deemed valid and a full solution can be constructed.\n\nThe solution is developed in three parts as requested: first, a derivation of the general criterion for avoiding aliasing; second, an evaluation of the given setup against this criterion; and third, the calculation of the minimal grid dimensions required.\n\n### 1. Derivation of the Aliasing Criterion\n\nLet the orthorhombic simulation cell be defined by real-space lattice vectors of lengths $L_x$, $L_y$, and $L_z$ along the Cartesian axes. The corresponding primitive reciprocal lattice vectors are $\\mathbf{b}_1 = (2\\pi/L_x, 0, 0)$, $\\mathbf{b}_2 = (0, 2\\pi/L_y, 0)$, and $\\mathbf{b}_3 = (0, 0, 2\\pi/L_z)$. Any reciprocal lattice vector $\\mathbf{G}$ is an integer linear combination of these primitive vectors: $\\mathbf{G} = n_x \\mathbf{b}_1 + n_y \\mathbf{b}_2 + n_z \\mathbf{b}_3$, where $n_x, n_y, n_z$ are integers.\n\nAn electronic wavefunction $\\psi(\\mathbf{r})$ within the cell is expanded in a plane-wave basis set:\n$$ \\psi(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}} $$\nThe basis set is truncated by a kinetic energy cutoff $E_{\\mathrm{cut}}$, such that only plane waves with a kinetic energy less than or equal to $E_{\\mathrm{cut}}$ are included. The kinetic energy of a plane wave with wavevector $\\mathbf{G}$ is given as $E_{\\mathrm{kin}}(\\mathbf{G}) = \\frac{1}{2}|\\mathbf{G}|^2$ in Hartree atomic units. This imposes a condition on the magnitude of the included wavevectors:\n$$ \\frac{1}{2}|\\mathbf{G}|^2 \\leq E_{\\mathrm{cut}} \\implies |\\mathbf{G}| \\leq \\sqrt{2E_{\\mathrm{cut}}} \\equiv G_{\\mathrm{cut}} $$\nThus, the sum for the wavefunction is restricted to all $\\mathbf{G}$ vectors lying within a sphere of radius $G_{\\mathrm{cut}}$ in reciprocal space.\n\nThe charge density $\\rho(\\mathbf{r})$ is constructed from products of wavefunctions. For a single orbital, the density is $\\rho_{\\psi}(\\mathbf{r}) = \\psi^*(\\mathbf{r})\\psi(\\mathbf{r})$.\n$$ \\rho(\\mathbf{r}) = \\left( \\sum_{\\mathbf{G'}} c_{\\mathbf{G'}}^{*} e^{-i\\mathbf{G'}\\cdot\\mathbf{r}} \\right) \\left( \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}} \\right) = \\sum_{\\mathbf{G}, \\mathbf{G'}} c_{\\mathbf{G}} c_{\\mathbf{G'}}^{*} e^{i(\\mathbf{G}-\\mathbf{G'})\\cdot\\mathbf{r}} $$\nThis expression is a Fourier series for the charge density. Let $\\mathbf{K} = \\mathbf{G} - \\mathbf{G'}$. The density can be written as:\n$$ \\rho(\\mathbf{r}) = \\sum_{\\mathbf{K}} \\rho_{\\mathbf{K}} e^{i\\mathbf{K}\\cdot\\mathbf{r}} $$\nwhere $\\rho_{\\mathbf{K}}$ are the Fourier coefficients of the density. A non-zero coefficient $\\rho_{\\mathbf{K}}$ exists only if $\\mathbf{K}$ can be expressed as a difference $\\mathbf{G} - \\mathbf{G'}$ where both $|\\mathbf{G}| \\leq G_{\\mathrm{cut}}$ and $|\\mathbf{G'}| \\leq G_{\\mathrm{cut}}$.\n\nUsing the triangle inequality, we can find the maximum magnitude of a wavevector $\\mathbf{K}$ in the density expansion:\n$$ |\\mathbf{K}| = |\\mathbf{G} - \\mathbf{G'}| \\leq |\\mathbf{G}| + |-\\mathbf{G'}| = |\\mathbf{G}| + |\\mathbf{G'}| \\leq G_{\\mathrm{cut}} + G_{\\mathrm{cut}} = 2G_{\\mathrm{cut}} $$\nThis means that all Fourier components of the charge density are contained within a sphere of radius $2G_{\\mathrm{cut}}$ in reciprocal space.\n\nThe charge density is evaluated on a discrete Fast Fourier Transform (FFT) grid of dimensions $(N_x, N_y, N_z)$. For the $x$-dimension, this grid consists of $N_x$ points with a spacing of $\\Delta x = L_x/N_x$. According to the Nyquist-Shannon sampling theorem, to represent a signal without aliasing (wrap-around error), the sampling frequency must be at least twice the highest frequency present in the signal. In terms of wavevectors, the magnitude of the highest wavevector component must be less than or equal to the Nyquist wavevector of the grid.\n\nFor a real-space grid with spacing $\\Delta x = L_x/N_x$, the corresponding FFT in reciprocal space can represent wavevector components up to a maximum (the Nyquist limit) of:\n$$ k_{x, \\mathrm{Nyquist}} = \\frac{\\pi}{\\Delta x} = \\frac{\\pi N_x}{L_x} $$\nTo avoid aliasing, the maximum wavevector component of the density, $K_{x, \\mathrm{max}}$, must satisfy $|K_{x, \\mathrm{max}}| \\leq k_{x, \\mathrm{Nyquist}}$. The maximum possible $x$-component of a vector $\\mathbf{K}$ within the sphere $|\\mathbf{K}| \\leq 2G_{\\mathrm{cut}}$ is $2G_{\\mathrm{cut}}$. Therefore, the condition to prevent aliasing along the $x$-axis is:\n$$ 2G_{\\mathrm{cut}} \\leq \\frac{\\pi N_x}{L_x} $$\nRearranging for $N_x$ and substituting $G_{\\mathrm{cut}} = \\sqrt{2E_{\\mathrm{cut}}}$, we obtain the general criterion for each Cartesian axis $i \\in \\{x, y, z\\}$:\n$$ N_i \\ge \\frac{2L_i G_{\\mathrm{cut}}}{\\pi} = \\frac{2L_i \\sqrt{2E_{\\mathrm{cut}}}}{\\pi} $$\nThis condition guarantees that the FFT grid is fine enough to represent the charge density without aliasing errors.\n\n### 2. Evaluation of Aliasing for the Given Parameters\n\nWe are given:\n- $E_{\\mathrm{cut}} = 30$ Hartree\n- $L_x = 8$ bohr, $L_y = 10$ bohr, $L_z = 12$ bohr\n- FFT grid $(N_x, N_y, N_z) = (36, 48, 64)$\n\nFirst, we compute the cutoff wavevector $G_{\\mathrm{cut}}$:\n$$ G_{\\mathrm{cut}} = \\sqrt{2E_{\\mathrm{cut}}} = \\sqrt{2 \\times 30} = \\sqrt{60} \\text{ bohr}^{-1} $$\nNow we calculate the minimum required grid points ($N'_{i}$) for each axis using the derived criterion and check if the given $N_i$ are sufficient.\nMinimum for $x$-axis:\n$$ N_x' = \\frac{2 L_x \\sqrt{60}}{\\pi} = \\frac{2 \\times 8 \\times \\sqrt{60}}{\\pi} = \\frac{16\\sqrt{60}}{\\pi} \\approx 39.45 $$\nThe given grid has $N_x = 36$. Since $36 < 39.45$, the grid is insufficient, and aliasing will occur along the $x$-axis.\n\nMinimum for $y$-axis:\n$$ N_y' = \\frac{2 L_y \\sqrt{60}}{\\pi} = \\frac{2 \\times 10 \\times \\sqrt{60}}{\\pi} = \\frac{20\\sqrt{60}}{\\pi} \\approx 49.31 $$\nThe given grid has $N_y = 48$. Since $48 < 49.31$, the grid is insufficient, and aliasing will also occur along the $y$-axis.\n\nMinimum for $z$-axis:\n$$ N_z' = \\frac{2 L_z \\sqrt{60}}{\\pi} = \\frac{2 \\times 12 \\times \\sqrt{60}}{\\pi} = \\frac{24\\sqrt{60}}{\\pi} \\approx 59.17 $$\nThe given grid has $N_z = 64$. Since $64 > 59.17$, the grid is sufficient along the $z$-axis.\n\nBecause the FFT grid dimensions are insufficient along the $x$ and $y$ axes, aliasing errors will contaminate the calculation of the charge density.\n\n### 3. Computation of Minimal Grid Dimensions\n\nTo avoid aliasing, the number of grid points along each axis must be an integer greater than or equal to the minimum values calculated above. We find the minimal integer dimensions $(N_x', N_y', N_z')$ by taking the ceiling of each required value.\n\nMinimal $N_x'$:\n$$ N_x' = \\lceil \\frac{16\\sqrt{60}}{\\pi} \\rceil = \\lceil 39.45 \\rceil = 40 $$\nMinimal $N_y'$:\n$$ N_y' = \\lceil \\frac{20\\sqrt{60}}{\\pi} \\rceil = \\lceil 49.31 \\rceil = 50 $$\nMinimal $N_z'$:\n$$ N_z' = \\lceil \\frac{24\\sqrt{60}}{\\pi} \\rceil = \\lceil 59.17 \\rceil = 60 $$\nTherefore, the minimal integer grid dimensions that avoid aliasing errors under the given conditions are $(40, 50, 60)$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 40 & 50 & 60 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Plane-wave methods are intrinsically designed for periodic systems, but they are often used to simulate isolated objects like atoms or molecules by placing them in a large, periodically-repeated box known as a supercell. The validity of this \"supercell approximation\" depends critically on the size of the box and the mitigation of spurious interactions between the object and its periodic images. This thought experiment challenges you to identify the physical and numerical errors that arise when this approximation breaks down, fostering a deeper understanding of the method's limitations .",
            "id": "2460238",
            "problem": "You are asked to compute ground-state properties of an isolated neutral atom using a plane-wave basis under periodic boundary conditions. The setup is as follows: place a single neutral atom with nuclear charge $+Ze$ and $Z$ electrons in a cubic supercell of edge length $L$, employ a norm-conserving pseudopotential for the ionic potential, expand the Kohn–Sham orbitals in plane waves up to a kinetic-energy cutoff $E_{\\mathrm{cut}}$, use the $\\Gamma$ point (i.e., $\\mathbf{k}=\\mathbf{0}$) for Brillouin-zone sampling, and evaluate electrostatics with the Ewald summation method. Suppose $L$ is made very small while keeping $E_{\\mathrm{cut}}$ fixed. Which of the following statements correctly describe what goes wrong in this calculation? Select all that apply.\n\nA. The calculation ceases to represent an isolated atom and instead describes a periodic crystal of atoms; overlap between periodic images produces bonding/antibonding splitting and band dispersion, so Kohn–Sham eigenvalues and the total energy acquire a strong and unphysical dependence on $L$.\n\nB. Decreasing $L$ at fixed $E_{\\mathrm{cut}}$ makes the plane-wave basis overcomplete, leading to linear dependence and numerical instabilities.\n\nC. Even for a neutral atom, the Ewald-summed Hartree energy diverges unless one introduces a compensating uniform background charge density.\n\nD. In a small supercell the arbitrary constant offset of the electrostatic potential becomes physically meaningful and corrupts the total energy.\n\nE. Even if the atom is neutral, interactions between periodic images introduce finite-size errors; for nonzero multipole moments these can decay algebraically with $L$ (e.g., as $L^{-3}$ for dipoles), while for a spherically symmetric closed-shell atom the dominant error arises from exchange/overlap with images and decays exponentially with $L$.",
            "solution": "The problem statement describes a standard computational setup in quantum chemistry and condensed matter physics: the use of a plane-wave basis set and periodic boundary conditions to simulate an isolated system (a neutral atom) within a supercell. The validity of this approach, known as the supercell approximation, hinges on the supercell being large enough to render interactions between the system and its periodic images negligible. The question asks to identify the failure modes of this method in the limit where the supercell dimension $L$ becomes very small.\n\nThe problem is scientifically well-posed and grounded in the established principles of plane-wave density functional theory calculations. All terms used are standard in the field, and the scenario described is a common context for discussing finite-size errors. The setup is self-contained and free of contradictions. Therefore, we may proceed with the solution.\n\nThe core of the problem lies in the breakdown of the supercell approximation. We will analyze the consequences of making $L$ small on the physical model, the basis set, and the electrostatic calculations.\n\nThe basis functions are plane waves of the form $\\psi_{\\mathbf{G}}(\\mathbf{r}) = \\frac{1}{\\sqrt{V}} e^{i\\mathbf{G}\\cdot\\mathbf{r}}$, where $V=L^3$ is the volume of the supercell. The reciprocal lattice vectors $\\mathbf{G}$ are defined by $\\mathbf{G} = n_x \\mathbf{b}_1 + n_y \\mathbf{b}_2 + n_z \\mathbf{b}_3$, where for a cubic cell of side $L$, $\\mathbf{b}_1 = \\frac{2\\pi}{L}(1,0,0)$, $\\mathbf{b}_2 = \\frac{2\\pi}{L}(0,1,0)$, and $\\mathbf{b}_3 = \\frac{2\\pi}{L}(0,0,1)$, with $n_x, n_y, n_z$ being integers. The basis set is truncated by a kinetic energy cutoff $E_{\\mathrm{cut}}$, including all plane waves for which $\\frac{\\hbar^2 |\\mathbf{G}|^2}{2m_e} \\leq E_{\\mathrm{cut}}$.\n\nWe now evaluate each option.\n\n**A. The calculation ceases to represent an isolated atom and instead describes a periodic crystal of atoms; overlap between periodic images produces bonding/antibonding splitting and band dispersion, so Kohn–Sham eigenvalues and the total energy acquire a strong and unphysical dependence on $L$.**\n\nThis statement correctly identifies the primary conceptual failure. The periodic boundary conditions impose that the system is not a single atom in vacuum, but an infinite, periodic array of atoms on a lattice with lattice constant $L$.\n1.  **Physical Model:** For a large $L$, the distance between the atom and its images is large, and their interaction is negligible. The model is a good approximation of an isolated atom. As $L$ becomes small, the distance between neighboring atoms becomes comparable to the extent of the atomic orbitals. The system being simulated is no longer an isolated atom but a dense, crystalline solid.\n2.  **Electronic Structure:** In an isolated atom, electron states are discrete energy levels. In a solid, inter-atomic orbital overlap causes these levels to broaden into energy bands. This is a direct consequence of Bloch's theorem. Even though we are only sampling at the $\\Gamma$ point ($\\mathbf{k}=\\mathbf{0}$), the energy of the state at this single point, $E(\\mathbf{k}=\\mathbf{0})$, is affected by the interaction with neighboring cells. The total energy of the system will include the spurious interaction energy between these artificially close-packed atoms.\n3.  **Dependence on $L$:** Both the Kohn–Sham eigenvalues and the total energy will show a strong dependence on $L$ as it becomes small. This dependence is an artifact of the unphysical interactions, not a property of the isolated atom we intend to study.\nThus, this statement is a correct and fundamental description of what goes wrong.\n**Verdict: Correct**\n\n**B. Decreasing $L$ at fixed $E_{\\mathrm{cut}}$ makes the plane-wave basis overcomplete, leading to linear dependence and numerical instabilities.**\n\nThe number of plane waves, $N_{\\mathrm{PW}}$, in the basis is determined by the number of reciprocal lattice vectors $\\mathbf{G}$ that satisfy $\\frac{\\hbar^2 |\\mathbf{G}|^2}{2m_e} \\leq E_{\\mathrm{cut}}$. Substituting $|\\mathbf{G}|^2 = (\\frac{2\\pi}{L})^2 (n_x^2 + n_y^2 + n_z^2)$, the condition becomes $(n_x^2 + n_y^2 + n_z^2) \\leq \\frac{2m_e E_{\\mathrm{cut}}}{\\hbar^2} (\\frac{L}{2\\pi})^2$. The number of integer points $(n_x, n_y, n_z)$ within a sphere of radius $R \\propto L \\sqrt{E_{\\mathrm{cut}}}$ is approximately the volume of that sphere, so $N_{\\mathrm{PW}} \\propto (L \\sqrt{E_{\\mathrm{cut}}})^3 \\propto L^3 E_{\\mathrm{cut}}^{3/2}$.\nFor a fixed $E_{\\mathrm{cut}}$, as $L$ decreases, the number of plane waves $N_{\\mathrm{PW}}$ *decreases*. The basis set becomes sparser and less capable of representing the sharp features of the atomic orbitals, particularly near the nucleus. This is a problem of an *incomplete* or *insufficient* basis set, not an *overcomplete* one. An overcomplete basis, which can cause numerical issues, would arise from having a very large number of basis functions, which is the opposite of what happens here.\n**Verdict: Incorrect**\n\n**C. Even for a neutral atom, the Ewald-summed Hartree energy diverges unless one introduces a compensating uniform background charge density.**\n\nThis statement confuses the treatment of neutral and charged systems. The long-range Coulomb interaction in a periodic system is handled by the Ewald summation method.\n1.  **Neutral System:** The problem specifies a neutral atom, meaning the supercell has zero net charge ($Q_{\\mathrm{cell}}=0$). For a neutral unit cell, the Ewald sum for the total electrostatic energy is well-defined and convergent. There is no divergence.\n2.  **Charged System:** A divergence in the electrostatic energy and potential does occur if the unit cell is charged ($Q_{\\mathrm{cell}} \\neq 0$). In this case, a standard remedy is to add a uniform background charge density $-\\frac{Q_{\\mathrm{cell}}}{V}$ to neutralize the cell, perform the Ewald summation, and then apply correction terms to remove the artifacts introduced by this background charge.\nSince the problem deals with a neutral atom, this issue does not arise.\n**Verdict: Incorrect**\n\n**D. In a small supercell the arbitrary constant offset of the electrostatic potential becomes physically meaningful and corrupts the total energy.**\n\nIn any periodic calculation, the average value of the electrostatic potential is not uniquely determined; one can add any constant $V_0$ to the potential throughout space without changing the physical electric fields $\\mathbf{E} = -\\nabla V$. The change in total energy upon such a shift is $\\Delta E = \\int_V \\rho_{\\mathrm{total}}(\\mathbf{r}) V_0 d^3\\mathbf{r} = V_0 Q_{\\mathrm{total}}$, where $Q_{\\mathrm{total}}$ is the total charge in the unit cell.\nFor a neutral system, $Q_{\\mathrm{total}} = 0$, so $\\Delta E = 0$. The total energy is invariant to this offset. The offset is indeed arbitrary and does not affect the total energy or any energy differences. The issue of aligning the potential offset becomes important only when comparing total energies of *charged* systems (e.g., a charged defect in different supercells or with different charge states). For a neutral system, this is not a concern, regardless of the size of $L$.\n**Verdict: Incorrect**\n\n**E. Even if the atom is neutral, interactions between periodic images introduce finite-size errors; for nonzero multipole moments these can decay algebraically with $L$ (e.g., as $L^{-3}$ for dipoles), while for a spherically symmetric closed-shell atom the dominant error arises from exchange/overlap with images and decays exponentially with $L$.**\n\nThis statement provides a more detailed and quantitative analysis of the finite-size errors mentioned in option A. These errors have two main components:\n1.  **Electrostatic Error:** This is the classical electrostatic interaction between the charge distribution in the central cell and all its periodic images. This interaction can be expressed as a multipole expansion. If the charge distribution in the unit cell has a net dipole moment $\\mathbf{p}$, the leading error term in the energy is the dipole-dipole interaction, which scales as $L^{-3}$. If $\\mathbf{p}=0$ but the quadrupole moment $\\mathbf{Q}$ is non-zero, the leading error scales as $L^{-5}$, and so on. For a general non-spherically symmetric atom or an atom placed off-center in the cell, such multipole moments will exist. This algebraic decay is correct.\n2.  **Wave Function Overlap Error:** This quantum mechanical effect arises from the direct overlap of the Kohn–Sham orbitals of an atom with those of its images. This leads to the band formation described in A. Since atomic wave functions decay exponentially with distance from the nucleus ($\\psi(r) \\sim e^{-\\alpha r}$), the overlap integrals between atoms separated by a distance $L$ also decay exponentially with $L$. Consequently, the energy error from this effect scales as $\\sim e^{-\\beta L}$.\nFor a special case of a spherically symmetric atom (e.g., a noble gas atom) centered in the cubic cell, all multipole moments are zero by symmetry. In this case, the slow-decaying algebraic electrostatic errors vanish, and the dominant remaining error is the exponentially decaying overlap error.\nThis statement accurately describes the different sources of finite-size error and their scaling with $L$.\n**Verdict: Correct**\n\nBoth statements A and E are correct descriptions of the problems that arise when $L$ is too small. Statement A provides a qualitative physical picture, while statement E provides a more quantitative breakdown of the associated energy errors. Both accurately describe what goes wrong.",
            "answer": "$$\\boxed{AE}$$"
        }
    ]
}