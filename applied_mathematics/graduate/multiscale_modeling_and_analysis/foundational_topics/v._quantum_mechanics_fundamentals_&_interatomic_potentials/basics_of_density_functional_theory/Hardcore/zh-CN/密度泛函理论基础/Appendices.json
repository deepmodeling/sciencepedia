{
    "hands_on_practices": [
        {
            "introduction": "在实际的计算研究中，选择合适的理论方法是至关重要的第一步，这往往需要在计算精度和计算成本之间做出权衡。此练习提供了一个具体的模型，用于比较两种密度泛函理论（DFT）方法——Kohn-Sham DFT (KS-DFT) 和无轨道 DFT (OF-DFT) 的计算标度行为。通过这个动手计算，你将能够量化地理解这两种方法的计算成本如何随系统尺寸变化，并估算出在何种系统规模下，计算成本较低的 OF-DFT 方法开始显现其优势。",
            "id": "3735981",
            "problem": "考虑一个在密度泛函理论（DFT）框架下建模的三维周期性金属系统。根据Hohenberg–Kohn定理，基态能量是电子密度 $n(\\mathbf{r})$ 的一个泛函，并且变分原理指出基态密度使该能量泛函最小化。两种广泛使用的方法是Kohn–Sham DFT (KS-DFT) 和无轨道DFT (OF-DFT)。Kohn–Sham DFT (KS-DFT) 引入无相互作用的轨道来表示动能，需要在自洽场（SCF）迭代的每一步求解一个单粒子有效薛定谔方程。无轨道DFT (OF-DFT) 将动能处理为 $n(\\mathbf{r})$ 的显式泛函并直接最小化能量，这通常避免了特征值求解，并使用基于梯度的优化方法和快速傅里叶变换（FFT）加速的非局域核。\n\n假设采用以原子为中心的局域基组，每个原子有 $s$ 个基函数，因此基函数的总数为 $M = s N$，其中 $N$ 是原子数。在每次SCF迭代中：\n- 对于KS-DFT，假设主要的计算步骤是稠密厄米矩阵的对角化，其操作计数尺度关系为 $\\mathcal{O}(M^{3})$，每次迭代的经验墙上时钟时间模型为 $T_{\\mathrm{KS}}^{\\mathrm{iter}}(M) = \\alpha M^{3}$。\n- 对于OF-DFT，假设主要的成本是成本为 $\\mathcal{O}(M \\ln M)$ 的FFT加速的非局域动能泛函求值和成本为 $\\mathcal{O}(M)$ 的局域项，每次迭代的经验墙上时钟时间模型为 $T_{\\mathrm{OF}}^{\\mathrm{iter}}(M) = \\beta M \\ln M + \\gamma M$。\n\n假设在固定的硬件/软件堆栈上，经验测量的常数如下：\n- $s = 50$,\n- $I_{\\mathrm{KS}} = 15$ 次KS-DFT的SCF迭代,\n- $I_{\\mathrm{OF}} = 3000$ 次OF-DFT的基于梯度的迭代,\n- $\\alpha = 2.0 \\times 10^{-11}$ s,\n- $\\beta = 2.0 \\times 10^{-4}$ s,\n- $\\gamma = 1.0 \\times 10^{-5}$ s.\n\n设总墙上时钟时间分别为 $T_{\\mathrm{KS}}(N) = I_{\\mathrm{KS}} \\alpha (sN)^{3}$ 和 $T_{\\mathrm{OF}}(N) = I_{\\mathrm{OF}} [\\beta (sN) \\ln(sN) + \\gamma (sN)]$，两者都以秒为单位测量。仅使用这些假设和上述基本尺度关系事实，确定由方程 $T_{\\mathrm{KS}}(N^{*}) = T_{\\mathrm{OF}}(N^{*})$ 的解定义的交叉系统尺寸 $N^{*}$（作为原子的实数）。将您的答案四舍五入到四位有效数字。将 $N^{*}$ 表示为纯原子数（无量纲）。",
            "solution": "### 步骤1：提取给定信息\n题目提供了以下数据、定义和模型方程：\n- 系统：一个三维周期性金属系统。\n- 每个原子的基函数数量：$s = 50$。\n- 基函数总数：$M = s N$，其中 $N$ 是原子数。\n- Kohn–Sham DFT (KS-DFT) 每次迭代的墙上时钟时间：$T_{\\mathrm{KS}}^{\\mathrm{iter}}(M) = \\alpha M^{3}$。\n- 无轨道DFT (OF-DFT) 每次迭代的墙上时钟时间：$T_{\\mathrm{OF}}^{\\mathrm{iter}}(M) = \\beta M \\ln M + \\gamma M$。\n- KS-DFT 的 SCF 迭代次数：$I_{\\mathrm{KS}} = 15$。\n- OF-DFT 的基于梯度的迭代次数：$I_{\\mathrm{OF}} = 3000$。\n- KS-DFT 的经验常数：$\\alpha = 2.0 \\times 10^{-11}$ s。\n- OF-DFT 的经验常数：$\\beta = 2.0 \\times 10^{-4}$ s, $\\gamma = 1.0 \\times 10^{-5}$ s。\n- KS-DFT 的总墙上时钟时间：$T_{\\mathrm{KS}}(N) = I_{\\mathrm{KS}} \\alpha (sN)^{3}$。\n- OF-DFT 的总墙上时钟时间：$T_{\\mathrm{OF}}(N) = I_{\\mathrm{OF}} [\\beta (sN) \\ln(sN) + \\gamma (sN)]$。\n- 交叉系统尺寸 $N^{*}$ 由方程 $T_{\\mathrm{KS}}(N^{*}) = T_{\\mathrm{OF}}(N^{*})$ 的解定义。\n- $N^{*}$ 的最终答案应四舍五入到四位有效数字。\n\n### 步骤2：使用提取的给定信息进行验证\n根据指定标准对问题进行验证。\n- **科学基础**：该问题在计算材料科学领域，特别是密度泛函理论方面，有充分的科学依据。所描述的尺度定律，即KS-DFT中稠密矩阵对角化的 $\\mathcal{O}(M^3)$ 和OF-DFT中FFT加速操作的 $\\mathcal{O}(M \\ln M)$，是这些方法计算复杂度的标准且正确的表示。比较总运行时间以找到交叉点的前提是计算科学中一种常见且有效的分析方法。\n- **适定性**：该问题要求解一个特定的、明确定义的方程 $T_{\\mathrm{KS}}(N) = T_{\\mathrm{OF}}(N)$。构建此方程所需的所有函数和常数都已明确提供。对于 $N > 0$，这些函数是连续且单调递增的，确保了交叉点 $N^*$ 存在唯一的正解。\n- **客观性**：该问题以客观、定量的语言陈述。计算成本模型以显式的数学公式给出，并且所有参数都被赋予了精确的数值。没有主觀或定性的陈述。\n- **完整性和一致性**：该问题是自洽的。它提供了所有必要的数据（$s, I_{\\mathrm{KS}}, I_{\\mathrm{OF}}, \\alpha, \\beta, \\gamma$）以及 $T_{\\mathrm{KS}}(N)$ 和 $T_{\\mathrm{OF}}(N)$ 的方程。所提供的信息中没有矛盾之处。\n- **现实性**：所选的常数和迭代次数的值，虽然可能为了便于求解而进行了简化，但其数量级是合理的，反映了KS-DFT（迭代次数少但成本高）和OF-DFT（迭代次数多但成本低）之间的现实权衡。\n\n该问题不存在所列出的任何缺陷（例如，科学上不健全、不可形式化、不完整等）。\n\n### 步骤3：结论与行动\n该问题是 **有效的**。将推导解答。\n\n### 解答推导\n交叉系统尺寸 $N^{*}$ 可通过求解方程 $T_{\\mathrm{KS}}(N^{*}) = T_{\\mathrm{OF}}(N^{*})$ 找到。为简单起见，我们将求解 $N$，然后将解表示为 $N^*$。\n\n方程为：\n$$\nI_{\\mathrm{KS}} \\alpha (sN)^{3} = I_{\\mathrm{OF}} [\\beta (sN) \\ln(sN) + \\gamma (sN)]\n$$\n\n让我们将给定的数值代入方程中。\n- $I_{\\mathrm{KS}} = 15$\n- $\\alpha = 2.0 \\times 10^{-11}$\n- $s = 50$\n- $I_{\\mathrm{OF}} = 3000$\n- $\\beta = 2.0 \\times 10^{-4}$\n- $\\gamma = 1.0 \\times 10^{-5}$\n\n方程变为：\n$$\n(15) (2.0 \\times 10^{-11}) (50N)^{3} = (3000) [(2.0 \\times 10^{-4}) (50N) \\ln(50N) + (1.0 \\times 10^{-5}) (50N)]\n$$\n\n让我们简化两边的系数。\n对于左侧（LHS）：\n$$\nI_{\\mathrm{KS}} \\alpha s^3 = (15) (2.0 \\times 10^{-11}) (50)^3 = (3.0 \\times 10^{-10}) (125000) = 3.75 \\times 10^{-5}\n$$\n所以LHS为 $(3.75 \\times 10^{-5}) N^3$。\n\n对于右侧（RHS），让我们提出公因式 $(sN)$：\n$$\nI_{\\mathrm{OF}} (sN)[\\beta \\ln(sN) + \\gamma]\n$$\n让我们简化括号内各项的系数：\n$$\nI_{\\mathrm{OF}} \\beta s = (3000)(2.0 \\times 10^{-4})(50) = 30\n$$\n$$\nI_{\\mathrm{OF}} \\gamma s = (3000)(1.0 \\times 10^{-5})(50) = 1.5\n$$\n所以RHS为 $(30) N \\ln(50N) + (1.5) N$。\n\n需要求解的完整方程是：\n$$\n(3.75 \\times 10^{-5}) N^3 = 30 N \\ln(50N) + 1.5 N\n$$\n\n由于我们寻找的是非平凡的系统尺寸，我们假设 $N > 0$，可以用 $N$ 除以整个方程：\n$$\n(3.75 \\times 10^{-5}) N^2 = 30 \\ln(50N) + 1.5\n$$\n\n这是一个超越方程，没有简单的解析解。我们必须数值求解。让我们定义一个函数 $f(N)$ 并找到它的根：\n$$\nf(N) = (3.75 \\times 10^{-5}) N^2 - 30 \\ln(50N) - 1.5\n$$\n\n我们将通过测试 $N$ 的值来搜索根 $N^*$，使得 $f(N^*) = 0$。\n我们来测试 $N = 3000$：\n$$\nf(3000) = (3.75 \\times 10^{-5}) (3000)^2 - 30 \\ln(50 \\times 3000) - 1.5\n$$\n$$\nf(3000) = (3.75 \\times 10^{-5}) (9 \\times 10^6) - 30 \\ln(150000) - 1.5\n$$\n$$\nf(3000) \\approx 337.5 - 30(11.9184) - 1.5 = 337.5 - 357.552 - 1.5 = -21.552\n$$\n值为负，这意味着 $N=3000$ 太小了。\n\n我们来测试 $N = 3100$：\n$$\nf(3100) = (3.75 \\times 10^{-5}) (3100)^2 - 30 \\ln(50 \\times 3100) - 1.5\n$$\n$$\nf(3100) = (3.75 \\times 10^{-5}) (9.61 \\times 10^6) - 30 \\ln(155000) - 1.5\n$$\n$$\nf(3100) \\approx 360.375 - 30(11.9512) - 1.5 = 360.375 - 358.536 - 1.5 = 0.339\n$$\n值为正。因此，根 $N^*$ 位于区间 $(3000, 3100)$ 内。\n\n为了精确搜索，我们来测试此区间内的值。\n我们来测试 $N = 3098$：\n$$\nf(3098) = (3.75 \\times 10^{-5}) (3098)^2 - 30 \\ln(50 \\times 3098) - 1.5\n$$\n$$\nf(3098) = (3.75 \\times 10^{-5}) (9597604) - 30 \\ln(154900) - 1.5\n$$\n$$\nf(3098) \\approx 359.91015 - 30(11.950503) - 1.5 = 359.91015 - 358.51509 - 1.5 = -0.10494\n$$\n我们来测试 $N = 3099$：\n$$\nf(3099) = (3.75 \\times 10^{-5}) (3099)^2 - 30 \\ln(50 \\times 3099) - 1.5\n$$\n$$\nf(3099) = (3.75 \\times 10^{-5}) (9603801) - 30 \\ln(154950) - 1.5\n$$\n$$\nf(3099) \\approx 360.14254 - 30(11.950826) - 1.5 = 360.14254 - 358.52478 - 1.5 = 0.11776\n$$\n由于 $f(3098)  0$ 且 $f(3099) > 0$，根 $N^*$ 位于区间 $(3098, 3099)$ 内。通过线性插值，根比 $3099$ 更接近 $3098$。\n更精确的数值解（例如，使用牛顿-拉弗森法或求解器）得出 $N^* \\approx 3098.471$。\n\n问题要求答案四舍五入到四位有效数字。\n数字 $3098.471...$ 的前四位有效数字是 $3, 0, 9, 8$。第五位有效数字是 $4$，小于 $5$，因此我们向下舍入。\n交叉系统尺寸 $N^*$，四舍五入到四位有效数字后是 $3098$。",
            "answer": "$$\n\\boxed{3098}\n$$"
        },
        {
            "introduction": "虽然密度泛函理论在原则上是精确的，但其核心的交换关联泛函在实践中必须采用近似形式。一个深刻理解这些近似局限性的方法是检验它们是否满足已知的物理定理。本练习将引导你运用维里定理——一个联系系统动能和势能的精确关系——来分析一个近似泛函的表现。通过为一个模型系统推导和计算维里定理的偏差，你将亲身体会到像局域密度近似（LDA）这样的常用近似是如何违背精确物理条件的，从而更深入地理解泛函本身所引入的误差。",
            "id": "3735956",
            "problem": "考虑一个原子单位（哈特里能量单位，玻尔长度单位）下的单电子类氢体系，其中核电荷为 $Z$ 的原子核在空间中固定（Born–Oppenheimer 近似）。设电子密度被约束在归一化的、球对称的 Slater 族 $n_{\\kappa}(\\mathbf{r}) = \\frac{\\kappa^{3}}{\\pi} \\exp(-2 \\kappa r)$ 内，其中 $\\kappa  0$ 是一个变分参数，且 $r = |\\mathbf{r}|$。在密度泛函理论（DFT）的 Kohn–Sham 表述中，取无相互作用（Kohn–Sham）动能为 Weizsäcker 泛函 $T_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\mathbf{r})|^{2}}{n(\\mathbf{r})} \\, d^{3}\\mathbf{r}$，外部核-电子库仑能量为 $E_{\\mathrm{ext}}[n] = \\int n(\\mathbf{r}) \\, v_{\\mathrm{ext}}(\\mathbf{r}) \\, d^{3}\\mathbf{r}$，其中外势为 $v_{\\mathrm{ext}}(\\mathbf{r}) = - \\frac{Z}{r}$，并使用局域密度近似（LDA）交换泛函 $E_{x}^{\\mathrm{LDA}}[n] = - A \\int n(\\mathbf{r})^{4/3} \\, d^{3}\\mathbf{r}$，其中 $A = \\frac{3}{4} \\left( \\frac{3}{\\pi} \\right)^{1/3}$。忽略 Hartree 和相关贡献（对于单电子，不存在电子-电子相互作用，我们故意忽略相关作用）。\n\n从第一性原理出发，按以下步骤进行：\n\n1. 利用 $v_{\\mathrm{ext}}(\\mathbf{r})$ 的齐次性和动能的定义，为库仑势中的束缚定态推导维里定理，以证明对于精确解存在精确的物理维里关系 $2 T + V_{\\mathrm{ext}} = 0$。\n\n2. 使用均匀坐标标度变换 $n_{\\gamma}(\\mathbf{r}) = \\gamma^{3} n(\\gamma \\mathbf{r})$ 和泛函齐次性，为任何满足 $F[n_{\\gamma}] = \\gamma^{p} F[n]$ 的泛函 $F[n]$ 推导一个广义维里关系。将此应用于交换贡献，并证明连接 $E_{x}[n]$ 和交换势 $v_{x}(\\mathbf{r}) = \\delta E_{x}[n] / \\delta n(\\mathbf{r})$ 的交换维里恒等式。\n\n3. 对于给定的 $n_{\\kappa}$，显式计算 $T_{W}[n_{\\kappa}]$、$E_{\\mathrm{ext}}[n_{\\kappa}]$ 和 $E_{x}^{\\mathrm{LDA}}[n_{\\kappa}]$（都表示为 $\\kappa$ 和 $Z$ 的函数）。然后，通过对 $\\kappa$ 求总的近似 Kohn–Sham 能量 $E(\\kappa) = T_{W}[n_{\\kappa}] + E_{\\mathrm{ext}}[n_{\\kappa}] + E_{x}^{\\mathrm{LDA}}[n_{\\kappa}]$ 的最小值，来获得最优的 $\\kappa^{\\ast}$。\n\n4. 在此变分最优值处定义物理维里偏差，\n$$\\delta_{\\mathrm{phys}} \\equiv 2 T_{W}[n_{\\kappa^{\\ast}}] + E_{\\mathrm{ext}}[n_{\\kappa^{\\ast}}],$$\n该偏差衡量当密度由最小化近似泛函确定时，与精确库仑维里关系的偏离程度。用 $Z$、$\\pi$ 和数值常数以闭合形式表示 $\\delta_{\\mathrm{phys}}$，并证明其与 $E_{x}^{\\mathrm{LDA}}[n_{\\kappa^{\\ast}}]$ 的关系。\n\n提供 $\\delta_{\\mathrm{phys}}$ 以哈特里为单位的最终表达式。请给出精确的闭合形式答案，不要四舍五入。最终答案必须是单一的解析表达式。",
            "solution": "### 问题验证\n\n**第 1 步：提取已知条件**\n\n- **体系**：单电子类氢体系，采用原子单位。\n- **近似**：Born–Oppenheimer 近似（核电荷为 $Z$ 的原子核固定）。\n- **试探密度族**：$n_{\\kappa}(\\mathbf{r}) = \\frac{\\kappa^{3}}{\\pi} \\exp(-2 \\kappa r)$，其中 $\\kappa  0$ 是一个变分参数，且 $r = |\\mathbf{r}|$。该密度是归一化的。\n- **动能泛函**：Weizsäcker 泛函，$T_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\mathbf{r})|^{2}}{n(\\mathbf{r})} \\, d^{3}\\mathbf{r}$。\n- **外势能泛函**：$E_{\\mathrm{ext}}[n] = \\int n(\\mathbf{r}) \\, v_{\\mathrm{ext}}(\\mathbf{r}) \\, d^{3}\\mathbf{r}$，外势为 $v_{\\mathrm{ext}}(\\mathbf{r}) = - \\frac{Z}{r}$。\n- **交换能泛函**：局域密度近似（LDA），$E_{x}^{\\mathrm{LDA}}[n] = - A \\int n(\\mathbf{r})^{4/3} \\, d^{3}\\mathbf{r}$，常数 $A = \\frac{3}{4} \\left( \\frac{3}{\\pi} \\right)^{1/3}$。\n- **忽略项**：Hartree 和相关能贡献被忽略。\n- **任务要求 1**：推导精确的物理维里关系 $2 T + V_{\\mathrm{ext}} = 0$。\n- **任务要求 2**：使用均匀坐标标度变换 $n_{\\gamma}(\\mathbf{r}) = \\gamma^{3} n(\\gamma \\mathbf{r})$ 为齐次泛函 $F[n_{\\gamma}] = \\gamma^{p} F[n]$ 推导一个广义维里关系，并将其应用于交换泛函。\n- **任务要求 3**：计算 $T_{W}[n_{\\kappa}]$、$E_{\\mathrm{ext}}[n_{\\kappa}]$ 和 $E_{x}^{\\mathrm{LDA}}[n_{\\kappa}]$，并通过最小化总能量找到最优参数 $\\kappa^{\\ast}$。\n- **任务要求 4**：计算物理维里偏差 $\\delta_{\\mathrm{phys}} \\equiv 2 T_{W}[n_{\\kappa^{\\ast}}] + E_{\\mathrm{ext}}[n_{\\kappa^{\\ast}}]$，展示其与交换能的关系，并提供其闭合形式表达式。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n该问题是密度泛函理论（DFT）在一个简单、可解析处理的体系上的应用的明确练习。\n- **科学上合理（关键）**：该问题坚实地基于量子力学和 DFT 的基本原理。所提供的泛函（$T_W$、$E_{\\mathrm{ext}}$、$E_x^{\\mathrm{LDA}}$）是该领域的标准泛函。对单电子体系使用近似交换泛函，虽然在物理上不正确（因为它引入了自相互作用），但是一个标准的教学工具，用以说明此类近似的后果。\n- **良态的**：问题以充分且一致的信息进行了规定。变分过程定义清晰，导向唯一的最优参数和可计算的维里偏差。\n- **客观的（关键）**：问题以精确的数学语言陈述，没有任何主观性或模糊性。\n- **其他检查**：在一个理论物理问题的背景下，该问题不是不可形式化、不完整、矛盾或不切实际的。它是一个需要概念理解和代数操作的实质性问题，而不是一个平凡或同义反复的问题。\n\n**第 3 步：结论与行动**\n\n问题有效。将提供完整解答。\n\n### 解答\n\n解答过程按顺序处理问题的四个部分。所有计算均在原子单位下进行。\n\n**1. 精确物理维里定理的推导**\n\n对于具有哈密顿算符 $\\hat{H} = \\hat{T} + \\hat{V}_{\\mathrm{ext}}$ 的体系的任何定态波函数 $\\psi(\\mathbf{r})$，其总能量为 $E = \\langle \\psi | \\hat{H} | \\psi \\rangle$。考虑一个标度变换后的波函数 $\\psi_{\\lambda}(\\mathbf{r}) = \\lambda^{3/2} \\psi(\\lambda \\mathbf{r})$，它保持归一化。此标度变换态的能量期望值为 $E(\\lambda) = \\langle \\psi_{\\lambda} | \\hat{T} + \\hat{V}_{\\mathrm{ext}} | \\psi_{\\lambda} \\rangle$。\n\n动能算符为 $\\hat{T} = -\\frac{1}{2}\\nabla^2$。其期望值的标度变换关系为：\n$$T(\\lambda) = \\langle \\psi_{\\lambda} | -\\frac{1}{2}\\nabla^2 | \\psi_{\\lambda} \\rangle = \\lambda^2 \\langle \\psi | -\\frac{1}{2}\\nabla^2 | \\psi \\rangle = \\lambda^2 T$$\n外势是库仑势 $v_{\\mathrm{ext}}(\\mathbf{r}) = -Z/r$，它是一个 -1 次齐次函数，即 $v_{\\mathrm{ext}}(\\lambda\\mathbf{r}) = \\lambda^{-1}v_{\\mathrm{ext}}(\\mathbf{r})$。其期望值的标度变换关系为：\n$$V_{\\mathrm{ext}}(\\lambda) = \\langle \\psi_{\\lambda} | v_{\\mathrm{ext}}(\\mathbf{r}) | \\psi_{\\lambda} \\rangle = \\int \\lambda^3 |\\psi(\\lambda\\mathbf{r})|^2 v_{\\mathrm{ext}}(\\mathbf{r}) d^3\\mathbf{r}$$\n使用换元 $\\mathbf{u} = \\lambda\\mathbf{r}$，这变为：\n$$V_{\\mathrm{ext}}(\\lambda) = \\int |\\psi(\\mathbf{u})|^2 v_{\\mathrm{ext}}(\\mathbf{u}/\\lambda) d^3\\mathbf{u} = \\int |\\psi(\\mathbf{u})|^2 \\lambda v_{\\mathrm{ext}}(\\mathbf{u}) d^3\\mathbf{u} = \\lambda V_{\\mathrm{ext}}$$\n能量作为标度参数的函数为 $E(\\lambda) = \\lambda^2 T + \\lambda V_{\\mathrm{ext}}$。对于一个真正的定态，能量必须在 $\\lambda=1$ 时对此变分是驻定的。\n$$\\frac{dE(\\lambda)}{d\\lambda}\\bigg|_{\\lambda=1} = [2\\lambda T + V_{\\mathrm{ext}}]_{\\lambda=1} = 2T + V_{\\mathrm{ext}} = 0$$\n这就是库仑势中束缚态的维里定理。\n\n**2. 齐次泛函的广义维里关系**\n\n给定一个在均匀坐标标度变换下为 $p$ 次齐次的泛函 $F[n]$，即 $F[n_\\gamma] = \\gamma^p F[n]$，其中 $n_\\gamma(\\mathbf{r}) = \\gamma^3 n(\\gamma\\mathbf{r})$。我们对此恒等式关于 $\\gamma$ 在 $\\gamma=1$ 处求导。\n\n左边（LHS）：$\\frac{d}{d\\gamma} F[n_\\gamma] \\bigg|_{\\gamma=1} = \\frac{d}{d\\gamma} (\\gamma^p F[n]) \\bigg|_{\\gamma=1} = p \\gamma^{p-1} F[n] \\bigg|_{\\gamma=1} = pF[n]$。\n\n右边（RHS）：使用泛函微分的链式法则：\n$$\\frac{d}{d\\gamma} F[n_\\gamma] = \\int \\frac{\\delta F[n_\\gamma]}{\\delta n_\\gamma(\\mathbf{r})} \\frac{\\partial n_\\gamma(\\mathbf{r})}{\\partial \\gamma} d^3\\mathbf{r}$$\n标度变换后密度的导数为 $\\frac{\\partial n_\\gamma(\\mathbf{r})}{\\partial \\gamma} = 3\\gamma^2 n(\\gamma\\mathbf{r}) + \\gamma^3 \\nabla n(\\gamma\\mathbf{r}) \\cdot \\mathbf{r}$。\n在 $\\gamma=1$ 处，此式为 $\\frac{\\partial n_\\gamma(\\mathbf{r})}{\\partial \\gamma}\\bigg|_{\\gamma=1} = 3n(\\mathbf{r}) + \\mathbf{r} \\cdot \\nabla n(\\mathbf{r})$。令 $v_F(\\mathbf{r}) = \\delta F[n]/\\delta n(\\mathbf{r})$。则在 $\\gamma=1$ 处：\n$$\\frac{d}{d\\gamma} F[n_\\gamma] \\bigg|_{\\gamma=1} = \\int v_F(\\mathbf{r}) [3n(\\mathbf{r}) + \\mathbf{r} \\cdot \\nabla n(\\mathbf{r})] d^3\\mathbf{r}$$\n令左右两边相等，得到广义恒等式：$pF[n] = \\int v_F(\\mathbf{r}) [3n(\\mathbf{r}) + \\mathbf{r} \\cdot \\nabla n(\\mathbf{r})] d^3\\mathbf{r}$。\n\n对于 LDA 交换泛函 $E_x^{\\mathrm{LDA}}[n] = -A \\int n^{4/3} d^3\\mathbf{r}$：\n$$E_x^{\\mathrm{LDA}}[n_\\gamma] = -A \\int (\\gamma^3 n(\\gamma\\mathbf{r}))^{4/3} d^3\\mathbf{r} = -A \\gamma^4 \\int n(\\gamma\\mathbf{r})^{4/3} d^3\\mathbf{r}$$\n换元 $\\mathbf{u} = \\gamma\\mathbf{r}$，$d^3\\mathbf{r} = \\gamma^{-3}d^3\\mathbf{u}$：\n$$E_x^{\\mathrm{LDA}}[n_\\gamma] = -A \\gamma^4 \\gamma^{-3} \\int n(\\mathbf{u})^{4/3} d^3\\mathbf{u} = \\gamma E_x^{\\mathrm{LDA}}[n]$$\n因此，LDA 交换泛函是 1 次齐次的（$p=1$）。对应的交换势为 $v_x(\\mathbf{r}) = \\frac{\\delta E_x^{\\mathrm{LDA}}[n]}{\\delta n(\\mathbf{r})} = -\\frac{4}{3} A n(\\mathbf{r})^{1/3}$。交换的维里恒等式为：\n$$E_x^{\\mathrm{LDA}}[n] = \\int v_x(\\mathbf{r}) [3n(\\mathbf{r}) + \\mathbf{r} \\cdot \\nabla n(\\mathbf{r})] d^3\\mathbf{r}$$\n\n**3. 能量分量的显式计算与优化**\n\n我们计算试探密度 $n_{\\kappa}(\\mathbf{r}) = \\frac{\\kappa^3}{\\pi} \\exp(-2\\kappa r)$ 的能量分量。\n\n- **动能 $T_W[n_\\kappa]$**：\n$\\nabla n_\\kappa = \\frac{d n_\\kappa}{dr}\\hat{\\mathbf{r}} = \\frac{\\kappa^3}{\\pi}(-2\\kappa)\\exp(-2\\kappa r)\\hat{\\mathbf{r}} = -2\\kappa n_\\kappa(\\mathbf{r})\\hat{\\mathbf{r}}$。\n$|\\nabla n_\\kappa|^2 = 4\\kappa^2 n_\\kappa(\\mathbf{r})^2$。\n被积函数是 $\\frac{|\\nabla n_\\kappa|^2}{n_\\kappa} = 4\\kappa^2 n_\\kappa(\\mathbf{r})$。\n$$T_W[n_\\kappa] = \\frac{1}{8} \\int 4\\kappa^2 n_\\kappa(\\mathbf{r}) d^3\\mathbf{r} = \\frac{\\kappa^2}{2} \\int n_\\kappa(\\mathbf{r}) d^3\\mathbf{r} = \\frac{1}{2}\\kappa^2$$\n因为密度归一化为 1。\n\n- **外势能 $E_{\\mathrm{ext}}[n_\\kappa]$**：\n$$E_{\\mathrm{ext}}[n_\\kappa] = \\int n_\\kappa(\\mathbf{r}) \\left(-\\frac{Z}{r}\\right) d^3\\mathbf{r} = \\int_0^\\infty \\frac{\\kappa^3}{\\pi}\\exp(-2\\kappa r) \\left(-\\frac{Z}{r}\\right) 4\\pi r^2 dr$$\n$$E_{\\mathrm{ext}}[n_\\kappa] = -4Z\\kappa^3 \\int_0^\\infty r \\exp(-2\\kappa r) dr$$\n使用标准积分 $\\int_0^\\infty x^n \\exp(-ax)dx = n!/a^{n+1}$，其中 $n=1$，$a=2\\kappa$，积分计算结果为 $1/(2\\kappa)^2 = 1/(4\\kappa^2)$。\n$$E_{\\mathrm{ext}}[n_\\kappa] = -4Z\\kappa^3 \\left(\\frac{1}{4\\kappa^2}\\right) = -Z\\kappa$$\n\n- **交换能 $E_x^{\\mathrm{LDA}}[n_\\kappa]$**：\n$$E_x^{\\mathrm{LDA}}[n_\\kappa] = -A \\int n_\\kappa(\\mathbf{r})^{4/3} d^3\\mathbf{r} = -A \\int_0^\\infty \\left(\\frac{\\kappa^3}{\\pi} \\exp(-2\\kappa r)\\right)^{4/3} 4\\pi r^2 dr$$\n$$E_x^{\\mathrm{LDA}}[n_\\kappa] = -A \\frac{\\kappa^4}{\\pi^{4/3}} 4\\pi \\int_0^\\infty r^2 \\exp\\left(-\\frac{8\\kappa}{3}r\\right) dr$$\n该积分中 $n=2$，$a=8\\kappa/3$，结果为 $2!/(8\\kappa/3)^3 = 2 \\cdot 27/(512\\kappa^3) = 27/(256\\kappa^3)$。\n$$E_x^{\\mathrm{LDA}}[n_\\kappa] = -A \\cdot 4\\pi^{-1/3}\\kappa^4 \\cdot \\frac{27}{256\\kappa^3} = -A \\frac{108}{256}\\pi^{-1/3}\\kappa = -A \\frac{27}{64\\pi^{1/3}}\\kappa$$\n\n- **总能量与最小化**：\n总能量泛函为 $E(\\kappa) = T_W[n_\\kappa] + E_{\\mathrm{ext}}[n_\\kappa] + E_x^{\\mathrm{LDA}}[n_\\kappa]$。\n$$E(\\kappa) = \\frac{1}{2}\\kappa^2 - Z\\kappa - A \\frac{27}{64\\pi^{1/3}}\\kappa = \\frac{1}{2}\\kappa^2 - \\left(Z + A \\frac{27}{64\\pi^{1/3}}\\right)\\kappa$$\n为找到最优参数 $\\kappa^\\ast$，我们通过将其导数设为零来最小化 $E(\\kappa)$：\n$$\\frac{dE}{d\\kappa} = \\kappa - \\left(Z + A \\frac{27}{64\\pi^{1/3}}\\right) = 0$$\n$$\\kappa^\\ast = Z + A \\frac{27}{64\\pi^{1/3}}$$\n\n**4. 物理维里偏差**\n\n在变分最优处的物理维里偏差定义为 $\\delta_{\\mathrm{phys}} = 2 T_{W}[n_{\\kappa^{\\ast}}] + E_{\\mathrm{ext}}[n_{\\kappa^{\\ast}}]$。\n代入在 $\\kappa=\\kappa^\\ast$ 处计算的 $T_W$ 和 $E_{\\mathrm{ext}}$ 的表达式：\n$$\\delta_{\\mathrm{phys}} = 2 \\left(\\frac{1}{2}(\\kappa^\\ast)^2\\right) + (-Z\\kappa^\\ast) = (\\kappa^\\ast)^2 - Z\\kappa^\\ast = \\kappa^\\ast(\\kappa^\\ast - Z)$$\n从最小化结果可知，$\\kappa^\\ast - Z = A \\frac{27}{64\\pi^{1/3}}$。\n将此代入 $\\delta_{\\mathrm{phys}}$ 的表达式：\n$$\\delta_{\\mathrm{phys}} = \\kappa^\\ast \\left( A \\frac{27}{64\\pi^{1/3}} \\right)$$\n现在我们考察其与交换能的关系。在最优值处的交换能是：\n$$E_x^{\\mathrm{LDA}}[n_{\\kappa^\\ast}] = -A \\frac{27}{64\\pi^{1/3}}\\kappa^\\ast$$\n比较这两个表达式，我们发现一个直接的关系：\n$$\\delta_{\\mathrm{phys}} = -E_x^{\\mathrm{LDA}}[n_{\\kappa^\\ast}]$$\n这个结果也可以从近似泛函的维里定理得出。由于 $\\kappa$ 是一个标度参数，最小化条件 $\\frac{dE}{d\\kappa}|_{\\kappa^\\ast}=0$ 意味着总的近似泛函的维里定理必须成立：$2T_W[n_{\\kappa^\\ast}] + E_{\\mathrm{ext}}[n_{\\kappa^\\ast}] + E_x^{\\mathrm{LDA}}[n_{\\kappa^\\ast}] = 0$。重新整理立即得到 $\\delta_{\\mathrm{phys}} = -E_x^{\\mathrm{LDA}}[n_{\\kappa^\\ast}]$。\n\n为了获得 $\\delta_{\\mathrm{phys}}$ 的最终闭合形式表达式，我们代入常数的显式形式。\n设系数为 $C_x = A \\frac{27}{64\\pi^{1/3}}$。其中 $A = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$：\n$$C_x = \\frac{3}{4} \\frac{3^{1/3}}{\\pi^{1/3}} \\frac{27}{64\\pi^{1/3}} = \\frac{3 \\cdot 3^{1/3} \\cdot 3^3}{4 \\cdot 64 \\cdot \\pi^{2/3}} = \\frac{3^{4+1/3}}{256\\pi^{2/3}} = \\frac{3^{13/3}}{256\\pi^{2/3}}$$\n则 $\\kappa^\\ast = Z + C_x$，偏差为：\n$$\\delta_{\\mathrm{phys}} = -E_x^{\\mathrm{LDA}}[n_{\\kappa^\\ast}] = C_x \\kappa^\\ast = C_x (Z + C_x)$$\n代入 $C_x$ 的表达式：\n$$\\delta_{\\mathrm{phys}} = \\frac{3^{13/3}}{256\\pi^{2/3}} \\left( Z + \\frac{3^{13/3}}{256\\pi^{2/3}} \\right)$$\n这就是物理维里偏差的最终表达式，以哈特里原子单位表示。",
            "answer": "$$\n\\boxed{\n\\frac{3^{13/3}}{256\\pi^{2/3}} \\left( Z + \\frac{3^{13/3}}{256\\pi^{2/3}} \\right)\n}\n$$"
        },
        {
            "introduction": "任何 DFT 计算的核心都是求解 Kohn-Sham 方程的自洽场（Self-Consistent Field, SCF）迭代过程。这个过程的目标是找到一个电子密度，该密度产生的有效势又能反过来再现其自身。本练习深入探讨了实现这一目标的数值算法，解释了为何简单的迭代方法往往不稳定或收敛缓慢，并介绍了现代 DFT 软件中广泛用于加速收敛的精密技术，如 Pulay 混合法。完成这个练习将帮助你揭开 DFT 计算引擎的神秘面纱，理解其背后强大的数值优化原理。",
            "id": "3735985",
            "problem": "考虑一个在零温下，由密度泛函理论 (DFT) 描述的自旋非极化电子体系。Hohenberg–Kohn 定理断言，存在一个基态电子密度 $n(\\mathbf{r})$ 的普适能量泛函 $E[n]$，并且基态密度 $n^{\\star}(\\mathbf{r})$ 在约束条件 $\\int n(\\mathbf{r})\\,d\\mathbf{r} = N$ 下使 $E[n]$ 最小化。Kohn–Sham 构建引入了一个在等效单粒子势 $v_{s}[n](\\mathbf{r}) = v_{\\mathrm{ext}}(\\mathbf{r}) + v_{H}[n](\\mathbf{r}) + v_{\\mathrm{xc}}[n](\\mathbf{r})$ 中的无相互作用参考体系，其中 $v_{\\mathrm{ext}}$ 是外势，$v_{H}[n]$ 是 Hartree 势，$v_{\\mathrm{xc}}[n]$ 是由交换相关能量泛函 $E_{\\mathrm{xc}}[n]$ 推导出的交换相关势。Kohn–Sham 轨道 $\\{\\varphi_{i}(\\mathbf{r})\\}$ 满足\n$$\\left(-\\frac{1}{2}\\nabla^{2} + v_{s}[n](\\mathbf{r})\\right)\\varphi_{i}(\\mathbf{r}) = \\varepsilon_{i}\\,\\varphi_{i}(\\mathbf{r}),$$ \n且输出密度为\n$$n_{\\mathrm{out}}(\\mathbf{r}) = \\sum_{i=1}^{N} |\\varphi_{i}(\\mathbf{r})|^{2}。$$\n\n将 Kohn–Sham 映射 $\\mathcal{F}[n]$ 定义为这样一个操作：给定一个尝试密度 $n(\\mathbf{r})$，构建 $v_{s}[n]$，求解单粒子方程，并返回输出密度。在自洽场 (SCF) 迭代中，我们寻求一个满足 $n^{\\star} = \\mathcal{F}[n^{\\star}]$ 的不动点 $n^{\\star}$。\n\n你的任务是：\n(1) 从上述变分原理和 Kohn–Sham 构建出发（不假设 $E_{\\mathrm{xc}}[n]$ 的任何特定近似），形式化地推导不动点迭代 $n^{(k+1)} = \\mathcal{F}[n^{(k)}]$ 并定义残差 $r^{(k)}(\\mathbf{r}) = \\mathcal{F}[n^{(k)}](\\mathbf{r}) - n^{(k)}(\\mathbf{r})$。解释密度混合方案如何能被解释为基于残差的更新。\n(2) 通过引入误差 $e^{(k)}(\\mathbf{r}) = n^{(k)}(\\mathbf{r}) - n^{\\star}(\\mathbf{r})$ 和 Fréchet 导数 $\\mathcal{F}'[n^{\\star}]$，在不动点 $n^{\\star}$ 附近对 Kohn–Sham 映射进行线性化。对于带有标量混合参数 $\\alpha \\in \\mathbb{R}$ 的线性混合更新 $n^{(k+1)} = n^{(k)} + \\alpha\\,r^{(k)}$，推导相应的线性化误差传播和用 $\\mathcal{F}'[n^{\\star}]$ 的特征值表示的局域收敛条件。\n(3) 考虑 Pulay 混合，也称为迭代子空间直接求逆 (DIIS)。假设从最近的 $m+1$ 次迭代值中，用满足约束 $\\sum_{i=0}^{m} c_{i} = 1$ 的系数 $\\{c_{i}\\}$ 构成一个混合密度 $n_{\\mathrm{mix}}^{(k)} = \\sum_{i=0}^{m} c_{i}\\,n^{(k-i)}$。通过在密度空间上关于内积 $\\langle \\cdot, \\cdot \\rangle$ 进行残差最小化，推导确定 $\\{c_{i}\\}$ 的正规方程，该过程通过最小化 $\\left\\|\\sum_{i=0}^{m} c_{i}\\,r^{(k-i)}\\right\\|$ 并服从归一化约束。明确说明这些方程中出现的是哪些矩阵元。\n\n下列陈述中，哪些是正确的？\n\nA. Kohn–Sham 映射 $\\mathcal{F}[n]$ 是通过计算 $v_{s}[n] = v_{\\mathrm{ext}} + v_{H}[n] + v_{\\mathrm{xc}}[n]$，求解单粒子 Kohn–Sham 方程得到轨道 $\\{\\varphi_{i}\\}$，并由占据轨道构成输出密度而得到的；不动点迭代 $n^{(k+1)} = \\mathcal{F}[n^{(k)}]$ 通过此映射将尝试密度弛豫至自洽。\n\nB. 在 $n^{\\star}$ 附近线性化后，线性混合更新 $n^{(k+1)} = n^{(k)} + \\alpha\\,r^{(k)}$ 产生误差传播 $e^{(k+1)} \\approx \\left[(1 - \\alpha)\\,I + \\alpha\\,\\mathcal{F}'[n^{\\star}]\\right] e^{(k)}$，因此局域收敛要求对于 $\\mathcal{F}'[n^{\\star}]$ 的每一个特征值 $\\lambda$，都必须有 $|(1 - \\alpha) + \\alpha\\,\\lambda|  1$。\n\nC. 在 Pulay 混合中，系数 $\\{c_{i}\\}$ 是通过在 $\\sum_{i=0}^{m} c_{i} = 1$ 的约束下最小化混合残差的范数 $\\left\\|\\sum_{i=0}^{m} c_{i}\\,r^{(k-i)}\\right\\|$ 得到的，这导出了线性系统 $\\sum_{j=0}^{m} B_{ij}\\,c_{j} = \\mu$（其中 $i = 0,\\dots,m$），$B_{ij} = \\langle r^{(k-i)}, r^{(k-j)}\\rangle$，并使用一个拉格朗日乘子 $\\mu$ 来实施归一化约束。\n\nD. 线性混合等价于使用精确的雅可比矩阵应用牛顿法来求解 $r(n) = 0$，因此在 $n^{\\star}$ 附近能实现二次收敛。\n\nE. 因为 Pulay 混合在每一步都最小化残差范数，所以它保证了对于任何内积选择和任何体系，Kohn–Sham 总能量 $E[n^{(k)}]$ 都会随 $k$ 单调递减。",
            "solution": "问题陈述是对 Kohn-Sham 密度泛函理论 (DFT) 中的自洽场 (SCF) 过程及其常用收敛加速数值方案的标准而准确的描述。给出的定义和任务在科学上基于量子力学和数值分析的既定原理，是适定的、客观的、自洽的。因此，该问题是有效的。\n\n我们接下来处理问题陈述中列出的三个任务，这将为评估所给选项提供必要的框架。\n\n### 任务 1：SCF 迭代、残差和混合方案\n\n电子体系的基态是通过最小化总能量泛函 $E[n]$ 得到的，该最小化过程相对于电子密度 $n(\\mathbf{r})$ 进行，并受到密度积分等于总电子数 $N$ 的约束。Kohn-Sham (KS) 构建通过引入一个虚构的无相互作用体系来实现这一点，该体系能够再现真实的相互作用体系的基态密度。这个辅助体系由单粒子 KS 方程所描述：\n$$\n\\left(-\\frac{1}{2}\\nabla^{2} + v_{s}[n](\\mathbf{r})\\right)\\varphi_{i}(\\mathbf{r}) = \\varepsilon_{i}\\,\\varphi_{i}(\\mathbf{r})\n$$\n关键点在于，等效势 $v_{s}[n]$ 本身依赖于密度 $n$。这个自洽性要求自然地导向了迭代解法。\n\n从第 $k$ 次迭代的初始尝试密度 $n^{(k)}(\\mathbf{r})$ 开始，执行以下步骤：\n1.  构建 KS 势：$v_{s}[n^{(k)}](\\mathbf{r}) = v_{\\mathrm{ext}}(\\mathbf{r}) + v_{H}[n^{(k)}](\\mathbf{r}) + v_{\\mathrm{xc}}[n^{(k)}](\\mathbf{r})$。\n2.  求解此势对应的 KS 方程，以获得一组新的轨道 $\\{\\varphi_i\\}$。\n3.  从这些轨道构建输出密度：$n_{\\mathrm{out}}^{(k)}(\\mathbf{r}) = \\sum_{i=1}^{N} |\\varphi_{i}(\\mathbf{r})|^{2}$。\n\n这一系列操作构成了 Kohn-Sham 映射 $\\mathcal{F}$，它接收一个输入密度 $n^{(k)}$ 并产生一个输出密度 $n_{\\mathrm{out}}^{(k)}$：\n$$\nn_{\\mathrm{out}}^{(k)} = \\mathcal{F}[n^{(k)}]\n$$\n目标是找到此映射的一个不动点 $n^{\\star}$，使得 $n^{\\star} = \\mathcal{F}[n^{\\star}]$。最简单的迭代方法，称为简单迭代或 Picard 迭代，是将一次迭代的输出密度用作下一次迭代的输入：\n$$\nn^{(k+1)} = \\mathcal{F}[n^{(k)}]\n$$\n这就是形式化的不动点迭代。\n\n在第 $k$ 次迭代的残差，记为 $r^{(k)}(\\mathbf{r})$，定义为输出密度与输入密度之差：\n$$\nr^{(k)}(\\mathbf{r}) = \\mathcal{F}[n^{(k)}](\\mathbf{r}) - n^{(k)}(\\mathbf{r})\n$$\n收敛时，$n^{(k)} \\to n^{\\star}$，因此 $r^{(k)}(\\mathbf{r}) \\to 0$。\n\n简单迭代通常收敛很差或发散。密度混合方案是生成下一次尝试密度 $n^{(k+1)}$ 的改进方法。它们可以被解释为基于残差的更新，因为它们使用残差 $r^{(k)}$ 来指导从 $n^{(k)}$ 到 $n^{(k+1)}$ 的更新，旨在得到一个更接近不动点的更好猜测。例如，线性混合方案通过 $n^{(k+1)} = n^{(k)} + \\alpha r^{(k)}$ 来更新密度，其中 $\\alpha$ 是一个混合参数。这种方法取当前猜测值，并加上一部分由残差指示的修正量。更先进的方法使用历史残差来构建更复杂的更新。\n\n### 任务 2：线性混合的线性化\n\n线性混合更新由下式给出：\n$$\nn^{(k+1)} = n^{(k)} + \\alpha\\,r^{(k)} = n^{(k)} + \\alpha(\\mathcal{F}[n^{(k)}] - n^{(k)})\n$$\n这可以重写为：\n$$\nn^{(k+1)} = (1 - \\alpha) n^{(k)} + \\alpha \\mathcal{F}[n^{(k)}]\n$$\n为了分析局域收敛性，我们研究在不动点 $n^{\\star}$ 附近的误差 $e^{(k)} = n^{(k)} - n^{\\star}$ 的行为。我们将 $n^{(k)} = n^{\\star} + e^{(k)}$ 代入更新方程。左边变为 $n^{(k+1)} = n^{\\star} + e^{(k+1)}$。对于右边，我们使用 Fréchet 导数 $\\mathcal{F}'[n^{\\star}]$ 在 $n^{\\star}$ 附近对映射 $\\mathcal{F}$ 进行线性化：\n$$\n\\mathcal{F}[n^{(k)}] = \\mathcal{F}[n^{\\star} + e^{(k)}] \\approx \\mathcal{F}[n^{\\star}] + \\mathcal{F}'[n^{\\star}] e^{(k)}\n$$\n由于 $n^{\\star}$ 是一个不动点，所以 $\\mathcal{F}[n^{\\star}] = n^{\\star}$。因此，$\\mathcal{F}[n^{(k)}] \\approx n^{\\star} + \\mathcal{F}'[n^{\\star}] e^{(k)}$。\n将这些代入更新规则中：\n$$\nn^{\\star} + e^{(k+1)} \\approx (1 - \\alpha)(n^{\\star} + e^{(k)}) + \\alpha(n^{\\star} + \\mathcal{F}'[n^{\\star}] e^{(k)})\n$$\n$$\nn^{\\star} + e^{(k+1)} \\approx [(1 - \\alpha) + \\alpha]n^{\\star} + (1 - \\alpha)e^{(k)} + \\alpha\\mathcal{F}'[n^{\\star}] e^{(k)}\n$$\n$$\ne^{(k+1)} \\approx \\left[(1 - \\alpha)I + \\alpha\\mathcal{F}'[n^{\\star}]\\right] e^{(k)}\n$$\n这就是线性化的误差传播方程。迭代算子是 $M = (1 - \\alpha)I + \\alpha\\mathcal{F}'[n^{\\star}]$。为了使迭代局域收敛（即误差 $e^{(k)}$ 趋于零），$M$ 的谱半径必须小于 1。$M$ 的特征值（我们称之为 $\\mu$）与 Fréchet 导数 $\\mathcal{F}'[n^{\\star}]$ 的特征值（我们称之为 $\\lambda$）相关。如果 $x$ 是 $\\mathcal{F}'[n^{\\star}]$ 的一个特征向量，其特征值为 $\\lambda$，那么 $Mx = (1 - \\alpha)x + \\alpha\\lambda x = ((1 - \\alpha) + \\alpha\\lambda)x$。所以，$\\mu = (1 - \\alpha) + \\alpha\\lambda$。局域收敛条件是，对于 $\\mathcal{F}'[n^{\\star}]$ 的每一个特征值 $\\lambda$，$M$ 对应的特征值的模必须小于 1：\n$$\n|(1 - \\alpha) + \\alpha\\lambda|  1\n$$\n\n### 任务 3：Pulay 混合 (DIIS)\n\nPulay 混合，或 DIIS（迭代子空间直接求逆），旨在找到先前迭代值的最优线性组合，以最小化相应的残差。我们求解系数 $\\{c_i\\}$（其中 $i=0, \\dots, m$），它们是以下约束最小化问题的解：\n$$\n\\min_{\\{c_i\\}} \\left\\| \\sum_{i=0}^{m} c_{i}\\,r^{(k-i)} \\right\\|^2 \\quad \\text{ subject to } \\quad \\sum_{i=0}^{m} c_{i} = 1\n$$\n我们使用拉格朗日乘子法。目标函数是：\n$$\nL(\\{c_i\\}, \\mu) = \\left\\langle \\sum_{i=0}^{m} c_{i}\\,r^{(k-i)}, \\sum_{j=0}^{m} c_{j}\\,r^{(k-j)} \\right\\rangle - 2\\mu \\left( \\left(\\sum_{i=0}^{m} c_{i}\\right) - 1 \\right)\n$$\n其中 $2\\mu$ 是拉格朗日乘子。目标函数可以写成 $L = \\sum_{i,j=0}^m c_i c_j \\langle r^{(k-i)}, r^{(k-j)} \\rangle - 2\\mu(\\sum_i c_i - 1)$。\n令 $B_{ij} = \\langle r^{(k-i)}, r^{(k-j)} \\rangle$ 为残差的格拉姆矩阵的矩阵元。\n$$\nL = \\sum_{i=0}^{m}\\sum_{j=0}^{m} c_i c_j B_{ij} - 2\\mu \\left( \\left(\\sum_{i=0}^{m} c_{i}\\right) - 1 \\right)\n$$\n为了找到最小值，我们将关于每个系数 $c_l$ 的偏导数设为零：\n$$\n\\frac{\\partial L}{\\partial c_l} = \\sum_{j=0}^{m} 2 c_j B_{lj} - 2\\mu = 0 \\quad \\text{for } l = 0, \\dots, m\n$$\n这可以简化为以下线性方程组，称为正规方程：\n$$\n\\sum_{j=0}^{m} B_{lj} c_j = \\mu \\quad \\text{for } l = 0, \\dots, m\n$$\n这 $m+1$ 个方程，连同约束条件 $\\sum_{j=0}^{m} c_j = 1$，构成了一个包含 $m+2$ 个方程的线性系统，用于求解 $m+1$ 个系数 $\\{c_j\\}$ 和拉格朗日乘子 $\\mu$。出现的矩阵元是最近 $m+1$ 次迭代的残差向量的内积，$B_{ij} = \\langle r^{(k-i)}, r^{(k-j)} \\rangle$。\n\n---\n\n### 选项评估\n\n**A. Kohn–Sham 映射 $\\mathcal{F}[n]$ 是通过计算 $v_{s}[n] = v_{\\mathrm{ext}} + v_{H}[n] + v_{\\mathrm{xc}}[n]$，求解单粒子 Kohn–Sham 方程得到轨道 $\\{\\varphi_{i}\\}$，并由占据轨道构成输出密度而得到的；不动点迭代 $n^{(k+1)} = \\mathcal{F}[n^{(k)}]$ 通过此映射将尝试密度弛豫至自洽。**\n这个陈述是对 Kohn-Sham 映射的定义以及在任务 1 中推导的简单不动点迭代方案的正确而精确的总结。\n**结论：正确。**\n\n**B. 在 $n^{\\star}$ 附近线性化后，线性混合更新 $n^{(k+1)} = n^{(k)} + \\alpha\\,r^{(k)}$ 产生误差传播 $e^{(k+1)} \\approx \\left[(1 - \\alpha)\\,I + \\alpha\\,\\mathcal{F}'[n^{\\star}]\\right] e^{(k)}$，因此局域收敛要求对于 $\\mathcal{F}'[n^{\\star}]$ 的每一个特征值 $\\lambda$，都必须有 $|(1 - \\alpha) + \\alpha\\,\\lambda|  1$。**\n这个陈述与我们在任务 2 中的推导完全一致。误差传播公式和局域收敛的特征值条件是从线性混合更新规则的线性化中正确推导出来的。\n**结论：正确。**\n\n**C. 在 Pulay 混合中，系数 $\\{c_{i}\\}$ 是通过在 $\\sum_{i=0}^{m} c_{i} = 1$ 的约束下最小化混合残差的范数 $\\left\\|\\sum_{i=0}^{m} c_{i}\\,r^{(k-i)}\\right\\|$ 得到的，这导出了线性系统 $\\sum_{j=0}^{m} B_{ij}\\,c_{j} = \\mu$（其中 $i = 0,\\dots,m$），$B_{ij} = \\langle r^{(k-i)}, r^{(k-j)}\\rangle$，并使用一个拉格朗日乘子 $\\mu$ 来实施归一化约束。**\n这个陈述准确地将 DIIS 过程描述为一个约束优化问题，并正确地指出了其结果——正规方程以及所涉及矩阵元的定义，正如任务 3 中所推导的那样。\n**结论：正确。**\n\n**D. 线性混合等价于使用精确的雅可比矩阵应用牛顿法来求解 $r(n) = 0$，因此在 $n^{\\star}$ 附近能实现二次收敛。**\n这个陈述是错误的。求解 $r(n) = \\mathcal{F}[n] - n = 0$ 的牛顿法应该是 $n^{(k+1)} = n^{(k)} - [r'(n^{(k)})]^{-1}r(n^{(k)})$，其中雅可比矩阵是 $r'(n) = \\mathcal{F}'[n] - I$。线性混合，$n^{(k+1)} = n^{(k)} + \\alpha r(n^{(k)})$，对应于一种拟牛顿法，其中对逆雅可比矩阵做了一个非常粗略的近似，即 $[r'(n)]^{-1} \\approx -\\alpha I$。它不等同于牛顿法。此外，线性混合表现出线性收敛性，而不是牛顿法特有的二次收敛性。\n**结论：错误。**\n\n**E. 因为 Pulay 混合在每一步都最小化残差范数，所以它保证了对于任何内积选择和任何体系，Kohn–Sham 总能量 $E[n^{(k)}]$ 都会随 $k$ 单调递减。**\n这个陈述是错误的。Pulay 混合 (DIIS) 是一种旨在通过最小化残差向量 $r(n) = \\mathcal{F}[n] - n$ 的范数来加速收敛到不动点 $n^{\\star}$ 的算法。它不是一个能量最小化算法。迭代值 $n^{(k)}$ 在密度空间中的路径不一定对应于能量 $E[n]$ 下降的路径。在实践中，使用 DIIS 的 SCF 循环期间，总能量通常会振荡，甚至在收敛前可能会增加。要保证能量单调递减，需要一个旨在直接最小化能量泛函的算法，而 DIIS 不是这样的算法。\n**结论：错误。**",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}