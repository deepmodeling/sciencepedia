{
    "hands_on_practices": [
        {
            "introduction": "这项练习将抽象的嵌入原子方法（EAM）形式与晶体点阵的具体几何结构联系起来。通过计算面心立方（fcc）结构中一个原子的局域电子密度，你将亲身体验在EAM框架下如何量化局域原子环境。此练习还将突显势函数的衰减速率如何决定不同近邻壳层贡献的相对重要性。",
            "id": "3754290",
            "problem": "考虑一个具有面心立方（fcc）结构的单原子晶体，其常规立方晶格参数为 $a$。在嵌入原子方法（EAM）中，原子 $i$ 处的主体电子密度定义为 $\\rho_i = \\sum_{j \\neq i} f(r_{ij})$，其中 $r_{ij}$ 是原子 $i$ 和 $j$ 之间的标量距离，而 $f(r)$ 是原子 $j$ 对原子 $i$ 的球形衰减电子云贡献。假设 $f(r) = \\rho_s \\exp(-\\alpha r)$，其中 $\\rho_s$ 是一个恒定振幅，$\\alpha > 0$ 是衰减率。\n\n从电子密度的定义和 fcc 晶格的几何结构出发，完成以下任务：\n\n1. 从 fcc 几何结构的第一性原理出发，确定给定原子周围前三层近邻壳层的距离和配位数。使用这些信息构建仅包含前三层壳层贡献的截断主体电子密度 $\\rho_i^{(3)}(\\alpha,a)$。将 $\\rho_i^{(3)}(\\alpha,a)$ 用 $a$、$\\alpha$ 和 $\\rho_s$ 表示成闭合形式。\n\n2. 将壳层贡献 $C_k(\\alpha,a)$（$k=1,2,3$）定义为仅来自第 $k$ 壳层的部分和。定性和定量地分析相对权重 $w_k(\\alpha,a) = C_k(\\alpha,a)\\big/\\sum_{m=1}^{3}C_m(\\alpha,a)$ 如何随 $\\alpha$ 变化，包括其在 $\\alpha \\to 0^{+}$ 和 $\\alpha \\to +\\infty$ 时的极限行为。\n\n3. 为了量化第一层壳层何时“占主导地位”，施加约束条件：第二和第三壳层的贡献各自不超过第一壳层贡献的 $5\\%$，即 $C_2(\\alpha,a) \\leq 0.05\\,C_1(\\alpha,a)$ 和 $C_3(\\alpha,a) \\leq 0.05\\,C_1(\\alpha,a)$。推导出同时满足这两个约束条件的最小衰减率 $\\alpha^{\\ast}(a)$，并以单一的闭合形式解析表达式给出 $\\alpha^{\\ast}(a)$。\n\n最终答案需以 $\\alpha^{\\ast}(a)$ 的单一解析表达式形式给出，无需数值取整。不需要单位，因为答案必须用 $a$ 以符号形式表示。",
            "solution": "我们从嵌入原子方法（EAM）关于位点 $i$ 处的主体电子密度的定义开始，\n$$\n\\rho_i \\;=\\; \\sum_{j \\neq i} f(r_{ij}),\n$$\n其中 $f(r) = \\rho_s \\exp(-\\alpha r)$，$\\rho_s$ 是一个恒定振幅，$\\alpha > 0$ 是衰减参数。对于一个具有常规立方晶格参数 $a$ 的完美面心立方（fcc）晶体，到近邻原子的距离出现在由晶格几何决定的离散壳层中。我们将从几何角度构建前三层壳层，然后建立 $\\rho_i^{(3)}(\\alpha,a)$。\n\n首先，我们回顾 fcc 晶格的几何结构。在边长为 $a$ 的常规立方晶胞中，晶格点位于立方体的顶点和面心。等效地，连接原点处位点与另一晶格位点的相对位置矢量，其分量可以是整数或半整数，但需满足 fcc 的宇称约束。近邻壳层由这些矢量决定的距离所表征。\n\n我们现在枚举前三层壳层：\n\n1. 最近邻（$k=1$）：最近邻原子相对于原点位于一个面心位置。代表性矢量是 $\\left(0,\\frac{a}{2},\\frac{a}{2}\\right)$ 及其带符号的置换。距离为\n$$\nr_1 \\;=\\; \\sqrt{\\left(\\frac{a}{2}\\right)^{2}+\\left(\\frac{a}{2}\\right)^{2}} \\;=\\; \\frac{a}{\\sqrt{2}}.\n$$\n在 fcc 结构中，有 $12$ 个这样的最近邻，所以配位数为 $z_1 = 12$。\n\n2. 次近邻（$k=2$）：这些原子位于立方轴上，例如 $(a,0,0)$、$(0,a,0)$、$(0,0,a)$ 及其负向矢量。距离为\n$$\nr_2 \\;=\\; a,\n$$\n共有 $6$ 个这样的近邻，所以 $z_2 = 6$。\n\n3. 第三近邻（$k=3$）：第三壳层的代表性矢量是 $\\left(a,\\frac{a}{2},\\frac{a}{2}\\right)$ 及其带适当符号的置换，得到的距离为\n$$\nr_3 \\;=\\; \\sqrt{a^{2}+\\left(\\frac{a}{2}\\right)^{2}+\\left(\\frac{a}{2}\\right)^{2}} \\;=\\; a\\sqrt{\\frac{3}{2}}.\n$$\n该壳层中有 $24$ 个这样的近邻，所以 $z_3 = 24$。\n\n已知 $f(r) = \\rho_s \\exp(-\\alpha r)$，壳层贡献 $C_k(\\alpha,a)$ 和截断的电子密度 $\\rho_i^{(3)}(\\alpha,a)$ 分别为\n$$\nC_1(\\alpha,a) \\;=\\; z_1\\,\\rho_s \\exp\\!\\left(-\\alpha r_1\\right) \\;=\\; 12\\,\\rho_s \\exp\\!\\left(-\\alpha \\frac{a}{\\sqrt{2}}\\right),\n$$\n$$\nC_2(\\alpha,a) \\;=\\; z_2\\,\\rho_s \\exp\\!\\left(-\\alpha r_2\\right) \\;=\\; 6\\,\\rho_s \\exp(-\\alpha a),\n$$\n$$\nC_3(\\alpha,a) \\;=\\; z_3\\,\\rho_s \\exp\\!\\left(-\\alpha r_3\\right) \\;=\\; 24\\,\\rho_s \\exp\\!\\left(-\\alpha a\\sqrt{\\frac{3}{2}}\\right),\n$$\n因此\n$$\n\\rho_i^{(3)}(\\alpha,a) \\;=\\; C_1(\\alpha,a) + C_2(\\alpha,a) + C_3(\\alpha,a) \\;=\\; \\rho_s\\left[12\\,\\exp\\!\\left(-\\alpha \\frac{a}{\\sqrt{2}}\\right) + 6\\,\\exp(-\\alpha a) + 24\\,\\exp\\!\\left(-\\alpha a\\sqrt{\\frac{3}{2}}\\right)\\right].\n$$\n\n我们将前三层壳层的相对权重 $w_k(\\alpha,a)$ 定义为\n$$\nw_k(\\alpha,a) \\;=\\; \\frac{C_k(\\alpha,a)}{C_1(\\alpha,a)+C_2(\\alpha,a)+C_3(\\alpha,a)}.\n$$\n对 $\\alpha$ 的定性和定量依赖关系可由指数函数的单调性得出。随着 $\\alpha$ 增大，$\\exp(-\\alpha r)$ 随 $r$ 衰减得更快，因此较近的近邻贡献相对更多，这意味着 $w_1(\\alpha,a)$ 增大，而 $w_2(\\alpha,a)$ 和 $w_3(\\alpha,a)$ 减小。在极限 $\\alpha \\to 0^{+}$ 时，$\\exp(-\\alpha r)\\to 1$，所以壳层权重仅与配位数成正比：\n$$\n\\lim_{\\alpha\\to 0^{+}}w_1 \\;=\\; \\frac{12}{12+6+24} \\;=\\; \\frac{12}{42} \\;=\\; \\frac{2}{7},\n$$\n$$\n\\lim_{\\alpha\\to 0^{+}}w_2 \\;=\\; \\frac{6}{42} \\;=\\; \\frac{1}{7},\n$$\n$$\n\\lim_{\\alpha\\to 0^{+}}w_3 \\;=\\; \\frac{24}{42} \\;=\\; \\frac{4}{7}.\n$$\n在相反的极限 $\\alpha \\to +\\infty$ 时，$\\exp(-\\alpha r)$ 会抑制除最短距离外的所有贡献，得到\n$$\n\\lim_{\\alpha\\to +\\infty}w_1 \\;=\\; 1,\\qquad \\lim_{\\alpha\\to +\\infty}w_2 \\;=\\; 0,\\qquad \\lim_{\\alpha\\to +\\infty}w_3 \\;=\\; 0.\n$$\n\n我们现在通过施加 $C_2(\\alpha,a) \\leq 0.05\\, C_1(\\alpha,a)$ 和 $C_3(\\alpha,a) \\leq 0.05\\, C_1(\\alpha,a)$ 来量化第一层壳层“占主导地位”的条件。这两个不等式给出了 $\\alpha$ 的下界；同时满足两个条件的最小 $\\alpha$ 是这些下界中的最大值。\n\n首先，比较第 2 壳层与第 1 壳层：\n$$\n\\frac{C_2}{C_1} \\;=\\; \\frac{6\\,\\rho_s \\exp(-\\alpha a)}{12\\,\\rho_s \\exp\\!\\left(-\\alpha \\frac{a}{\\sqrt{2}}\\right)} \\;=\\; \\frac{1}{2}\\,\\exp\\!\\left(-\\alpha\\left[a - \\frac{a}{\\sqrt{2}}\\right]\\right).\n$$\n约束条件 $\\frac{C_2}{C_1} \\leq 0.05$ 给出\n$$\n\\frac{1}{2}\\,\\exp\\!\\left(-\\alpha a\\left[1 - \\frac{1}{\\sqrt{2}}\\right]\\right) \\;\\leq\\; 0.05 \n\\quad\\Longrightarrow\\quad\n\\exp\\!\\left(-\\alpha a\\left[1 - \\frac{1}{\\sqrt{2}}\\right]\\right) \\;\\leq\\; 0.1 \n\\quad\\Longrightarrow\\quad\n\\alpha \\;\\geq\\; \\frac{\\ln(10)}{a\\left(1 - \\frac{1}{\\sqrt{2}}\\right)}.\n$$\n\n其次，比较第 3 壳层与第 1 壳层：\n$$\n\\frac{C_3}{C_1} \\;=\\; \\frac{24\\,\\rho_s \\exp\\!\\left(-\\alpha a\\sqrt{\\frac{3}{2}}\\right)}{12\\,\\rho_s \\exp\\!\\left(-\\alpha \\frac{a}{\\sqrt{2}}\\right)} \\;=\\; 2\\,\\exp\\!\\left(-\\alpha a\\left[\\sqrt{\\frac{3}{2}} - \\frac{1}{\\sqrt{2}}\\right]\\right).\n$$\n约束条件 $\\frac{C_3}{C_1} \\leq 0.05$ 给出\n$$\n2\\,\\exp\\!\\left(-\\alpha a\\left[\\sqrt{\\frac{3}{2}} - \\frac{1}{\\sqrt{2}}\\right]\\right) \\;\\leq\\; 0.05 \n\\quad\\Longrightarrow\\quad\n\\exp\\!\\left(-\\alpha a\\left[\\sqrt{\\frac{3}{2}} - \\frac{1}{\\sqrt{2}}\\right]\\right) \\;\\leq\\; \\frac{0.05}{2} \\;=\\; 0.025 \n\\quad\\Longrightarrow\\quad\n\\alpha \\;\\geq\\; \\frac{\\ln\\!\\left(\\frac{1}{0.025}\\right)}{a\\left(\\sqrt{\\frac{3}{2}} - \\frac{1}{\\sqrt{2}}\\right)} \\;=\\; \\frac{\\ln(40)}{a\\left(\\sqrt{\\frac{3}{2}} - \\frac{1}{\\sqrt{2}}\\right)}.\n$$\n\n因此，保证两个约束条件都成立的最小衰减率 $\\alpha^{\\ast}(a)$ 是\n$$\n\\alpha^{\\ast}(a) \\;=\\; \\max\\!\\left\\{\\, \\frac{\\ln(10)}{a\\left(1 - \\frac{1}{\\sqrt{2}}\\right)}\\,,\\, \\frac{\\ln(40)}{a\\left(\\sqrt{\\frac{3}{2}} - \\frac{1}{\\sqrt{2}}\\right)} \\right\\}.\n$$\n我们可以通过比较两个比率的数值来确定哪个界限更大。\n$$\n\\frac{\\ln(10)}{1 - 1/\\sqrt{2}} \\approx \\frac{2.3026}{1 - 0.7071} \\approx \\frac{2.3026}{0.2929} \\approx 7.86\n$$\n$$\n\\frac{\\ln(40)}{\\sqrt{3/2} - 1/\\sqrt{2}} \\approx \\frac{3.6889}{1.2247 - 0.7071} \\approx \\frac{3.6889}{0.5176} \\approx 7.13\n$$\n由于 $7.86 > 7.13$，第一个下界更为严格。因此，最小衰减率是\n$$\n\\alpha^{\\ast}(a) \\;=\\; \\frac{\\ln(10)}{a\\left(1 - \\frac{1}{\\sqrt{2}}\\right)}.\n$$\n这个闭合形式的表达式给出了阈值衰减率对晶格参数 $a$ 的符号依赖关系，它确保了第二和第三壳层的贡献各自不超过第一壳层贡献的 $5\\%$，从而确立了前三层壳层中第一壳层的主导地位。",
            "answer": "$$\\boxed{\\frac{\\ln(10)}{a\\left(1 - \\frac{1}{\\sqrt{2}}\\right)}}$$"
        },
        {
            "introduction": "在电子密度概念的基础上，本问题将探讨EAM的下一个关键组成部分：嵌入能。这项练习演示了当一个原子的配位数减少时（这是材料表面原子的典型情况），EAM如何模拟其能量变化。通过计算能量对此变化的敏感度，你将理解EAM如何为表面能等现象提供一个强大且物理直观的解释。",
            "id": "3754289",
            "problem": "考虑一种使用嵌入原子方法 (EAM) 建模的单原子金属，其总势能由各原子的嵌入能和对相互作用之和给出。原子 $i$ 的嵌入能为 $F(\\rho_{i})$，其中原子 $i$ 处的宿主电子密度为 $\\rho_{i}=\\sum_{j\\neq i} f(r_{ij})$，$f(r)$ 是距离为 $r$ 的邻近原子所贡献的电子密度。假设嵌入函数为 $F(\\rho)=-A\\sqrt{\\rho}$（其中 $A>0$），且 $f(r)$ 是一个固定的、各向同性的短程函数。考虑一个晶格常数为 $a$ 的面心立方 (fcc) 晶体，并假设电子密度仅由第一近邻壳层主导。在 fcc 晶体中，第一近邻配位数为 $z=\\;12$，第一近邻距离为 $r_{1}=a/\\sqrt{2}$。在平坦表面处，原子的配位数会减少。为量化能量对此类变化的敏感度，请计算每个原子的嵌入能对配位数 $z$ 的导数 $S = \\left.\\frac{\\partial (E/N)}{\\partial z}\\right|_{z=\\;12}$，并在体材料配位数 $z=12$ 处求值。在你的分析中，可以忽略对势项以及由于弛豫引起的原子位置变化。用 $A$ 和 $f(a/\\sqrt{2})$ 表示你的答案。",
            "solution": "为了进行此灵敏度分析，我们考虑每个原子的能量仅由嵌入能贡献给出，正如问题所指示的那样：\n$$\n\\frac{E}{N} = F(\\rho)\n$$\n其中 $F(\\rho)$ 是嵌入函数，$\\rho$ 是局域电子密度。给出的具体形式为：\n$$\nF(\\rho) = -A\\sqrt{\\rho} \\quad (A>0)\n$$\n$$\n\\rho_{i} = \\sum_{j \\neq i} f(r_{ij})\n$$\n分析仅限于来自第一近邻壳层的贡献。\n\n1) 体材料中每个原子嵌入能的推导。\n在面心立方 (fcc) 晶体中，每个原子都处于相同的环境中。因此，我们可以计算单个代表性原子的能量。问题陈述，体材料中的第一近邻配位数为 $z = 12$，第一近邻距离为 $r_{1} = \\frac{a}{\\sqrt{2}}$。\n\n在第一近邻近似下，体相原子处的局域电子密度 $\\rho_{\\text{bulk}}$ 是其 $z$ 个最近邻（均在距离 $r_{1}$ 处）贡献的总和。\n$$\n\\rho_{\\text{bulk}} = \\sum_{j=1}^{z} f(r_{1}) = z f(r_{1})\n$$\n体材料的配位数为 $z = 12$，因此体材料的电子密度为：\n$$\n\\rho_{\\text{bulk}} = 12 f(r_{1}) = 12 f\\left(\\frac{a}{\\sqrt{2}}\\right)\n$$\n将此密度代入嵌入函数，即可得到体材料中每个原子的嵌入能 $E_{\\text{bulk}}/N$：\n$$\n\\frac{E_{\\text{bulk}}}{N} = F(\\rho_{\\text{bulk}}) = -A\\sqrt{\\rho_{\\text{bulk}}} = -A\\sqrt{z f(r_{1})}\n$$\n用 $A$、$f(r_{1})$ 和 $z$ 表示，每个原子的嵌入能为 $-A\\sqrt{z f(r_{1})}$。\n\n2) 灵敏度 $S$ 的推导。\n灵敏度 $S$ 定义为平均每个原子的能量对配位数 $z$ 的导数，并在体材料配位数 $z=12$ 处取值。\n$$\nS = \\left.\\frac{\\partial (E/N)}{\\partial z}\\right|_{z=\\;12}\n$$\n为进行此微分，我们将 $z$ 视为一个连续变量。每个原子的能量作为 $z$ 的函数为：\n$$\n\\frac{E(z)}{N} = -A\\sqrt{z f(r_{1})}\n$$\n$f(r_{1})$ 项相对于 $z$ 被视为常数，因为问题指定忽略弛豫效应，这意味着邻近距离 $r_{1}$ 不随配位数变化。\n\n现在我们使用幂法则和链式法则对 $\\frac{E(z)}{N}$ 关于 $z$ 进行微分：\n$$\n\\frac{\\partial (E/N)}{\\partial z} = \\frac{\\partial}{\\partial z} \\left(-A \\left(z f(r_{1})\\right)^{\\frac{1}{2}}\\right)\n$$\n$$\n\\frac{\\partial (E/N)}{\\partial z} = -A \\cdot \\frac{1}{2} \\left(z f(r_{1})\\right)^{-\\frac{1}{2}} \\cdot \\frac{\\partial}{\\partial z}\\left(z f(r_{1})\\right)\n$$\n$$\n\\frac{\\partial (E/N)}{\\partial z} = -A \\cdot \\frac{1}{2\\sqrt{z f(r_{1})}} \\cdot f(r_{1})\n$$\n通过合并包含 $f(r_{1})$ 的项来简化表达式：\n$$\n\\frac{\\partial (E/N)}{\\partial z} = -\\frac{A f(r_{1})}{2\\sqrt{z}\\sqrt{f(r_{1})}} = -\\frac{A \\sqrt{f(r_{1})}}{2\\sqrt{z}}\n$$\n现在，我们在体材料配位数 $z=12$ 处计算此导数的值：\n$$\nS = \\left. -\\frac{A \\sqrt{f(r_{1})}}{2\\sqrt{z}} \\right|_{z=\\;12} = -\\frac{A \\sqrt{f(r_{1})}}{2\\sqrt{12}}\n$$\n为简化表达式，我们注意到 $\\sqrt{12} = \\sqrt{4 \\times 3} = 2\\sqrt{3}$。\n$$\nS = -\\frac{A \\sqrt{f(r_{1})}}{2(2\\sqrt{3})} = -\\frac{A \\sqrt{f(r_{1})}}{4\\sqrt{3}}\n$$\n为了得到更标准的最终形式，我们可以将分母有理化：\n$$\nS = -\\frac{A \\sqrt{f(r_{1})}}{4\\sqrt{3}} \\cdot \\frac{\\sqrt{3}}{\\sqrt{3}} = -\\frac{A \\sqrt{3f(r_{1})}}{12}\n$$\n最后，按照要求，我们通过代入 $r_{1} = a/\\sqrt{2}$，用 $f(a/\\sqrt{2})$ 来表示结果：\n$$\nS = -\\frac{A \\sqrt{3f\\left(\\frac{a}{\\sqrt{2}}\\right)}}{12}\n$$\n这就是灵敏度 $S$ 的简化解析表达式。",
            "answer": "$$\n\\boxed{-\\frac{A \\sqrt{3 f\\left(\\frac{a}{\\sqrt{2}}\\right)}}{12}}\n$$"
        },
        {
            "introduction": "最后的这项实践将从静态计算转向分子动力学模拟的核心：计算原子间的作用力。你将首先推导EAM力的表达式，并由此发现其多体特性为何需要一个“两步”计算算法。这项练习对于理解EAM势的实际实现至关重要，它弥合了理论模型与大规模模拟应用之间的差距。",
            "id": "3754211",
            "problem": "考虑用于金属体系的嵌入原子方法（EAM）。总势能由嵌入能和对相互作用之和定义。设原子数量为 $N$。对于位置为 $\\mathbf{r}_i \\in \\mathbb{R}^3$ 的原子 $i$，定义其所在位置的主体电子密度为 $$\\rho_i = \\sum_{j \\neq i, \\, r_{ij}  r_c} f(r_{ij}),$$ 其中 $r_{ij} = \\|\\mathbf{r}_i - \\mathbf{r}_j\\|$，$f$ 是一个标量密度贡献函数，$r_c$ 是一个有限的截断半径。嵌入能由标量函数 $F(\\rho_i)$ 给出，对势为 $\\phi(r)$。EAM 的总能量为 $$E = \\sum_{i=1}^{N} F(\\rho_i) + \\frac{1}{2} \\sum_{i=1}^{N} \\sum_{j \\neq i, \\, r_{ij}  r_c} \\phi(r_{ij}).$$ 你需要通过第一性原理推导，证明计算力 $\\mathbf{F}_k = -\\nabla_{\\mathbf{r}_k} E$ 需要对近邻列表进行两次遍历：一次用于累积 $\\rho_i$ 值，第二次使用 $F'(\\rho_i)$ 和径向函数的导数来计算力。然后，设计并实现一个内存高效的算法，该算法在计算力的遍历中重复使用已计算的 $\\rho_i$，避免重新计算 $f(r)$，同时在第二次遍历中仅使用 $f'(r)$ 和 $\\phi'(r)$。\n\n对于数值计算，请使用以下经过充分测试的无量纲化的约化单位函数形式：\n- 电子密度贡献：$f(r) = \\eta \\exp(-\\beta r)$。\n- 对势：$\\phi(r) = C \\exp(-\\mu r)$。\n- 嵌入函数：$F(\\rho) = a \\rho + b \\rho^2$。\n使用导数 $f'(r) = -\\eta \\beta \\exp(-\\beta r)$ 和 $\\phi'(r) = -C \\mu \\exp(-\\mu r)$，以及 $F'(\\rho) = a + 2 b \\rho$。\n\n采用截断半径 $r_c = 3.0$。使用参数 $\\eta = 1.0$，$\\beta = 1.5$，$C = 0.2$，$\\mu = 2.0$，$a = -0.5$，$b = 0.05$。精确地排除所有 $r_{ij} \\ge r_c$ 的相互作用。\n\n你的程序必须：\n1. 构建一个无序对 $(i,j)$ 的近邻列表，其中 $i  j$ 且 $r_{ij}  r_c$。\n2. 执行第一次遍历以累积 $\\rho_i$（和 $\\rho_j$），对每个原子对 $(i,j)$ 精确计算一次 $f(r_{ij})$，并将其值同时加到 $\\rho_i$ 和 $\\rho_j$ 上。\n3. 执行第二次遍历以计算力，此次遍历中仅使用 $F'(\\rho_i)$、$F'(\\rho_j)$、$f'(r_{ij})$ 和 $\\phi'(r_{ij})$，不调用 $f(r)$。\n4. 对每个测试用例，返回两个量：\n   - 级联力向量的欧几里得范数，定义为 $\\left(\\sum_{i=1}^{N} \\|\\mathbf{F}_i\\|^2\\right)^{1/2}$，以浮点数形式表示。\n   - 第一次遍历中 $f(r)$ 的计算次数，以整数形式表示。对于没有任何近邻的测试用例，此计数必须为零。\n\n所有量均采用约化无量纲单位。计算中不涉及角度，因此不需要角度单位。\n\n测试套件：\n- 测试用例 A（一般情况，多个近邻）：$N=4$ 个原子，位置分别为 $(0,0,0)$、$(1.5,0,0)$、$(0,1.5,0)$、$(1.5,1.5,0)$。\n- 测试用例 B（截断边界情况）：$N=2$ 个原子，位置分别为 $(0,0,0)$、$(3.0,0,0)$。\n- 测试用例 C（无近邻情况）：$N=3$ 个原子，位置分别为 $(0,0,0)$、$(10.0,0,0)$、$(0,10.0,0)$。\n- 测试用例 D（混合近截断情况）：$N=3$ 个原子，位置分别为 $(0,0,0)$、$(2.9,0,0)$、$(6.1,0,0)$。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例按顺序贡献两项：力范数（浮点数）和 $f(r)$ 的计算次数（整数）。例如，输出必须类似于“[normA,countA,normB,countB,normC,countC,normD,countD]”。",
            "solution": "该问题要求证明为什么嵌入原子方法（EAM）中的力计算需要一个两遍（two-pass）算法，并随后实现这样一个算法。问题的核心在于 EAM 力表达式的数学结构，我们必须首先推导这个表达式。\n\n一个包含 $N$ 个原子的体系的总势能 $E$ 如下所示：\n$$E = \\sum_{i=1}^{N} F(\\rho_i) + \\frac{1}{2} \\sum_{i=1}^{N} \\sum_{j \\neq i} \\phi(r_{ij})$$\n其中 $\\rho_i = \\sum_{j \\neq i} f(r_{ij})$ 是原子 $i$ 位点的主体电子密度。为简洁起见，我们暂时忽略截断半径。\n\n原子 $k$ 所受的力 $\\mathbf{F}_k$ 是总能量对它的位置向量 $\\mathbf{r}_k$ 的负梯度：\n$$\\mathbf{F}_k = -\\nabla_{\\mathbf{r}_k} E$$\n我们使用链式法则和以下关系式：$\\nabla_{\\mathbf{r}_k} r_{ij} = \\frac{\\mathbf{r}_i - \\mathbf{r}_j}{r_{ij}} (\\delta_{ik} - \\delta_{jk}) = \\hat{\\mathbf{r}}_{ij}(\\delta_{ik} - \\delta_{jk})$，其中 $\\hat{\\mathbf{r}}_{ij}$ 是从 $j$ 指向 $i$ 的单位向量。\n\n1.  **对势部分的力**:\n    $$ \\mathbf{F}_k^{\\text{pair}} = -\\nabla_{\\mathbf{r}_k} \\left( \\frac{1}{2} \\sum_{i \\neq j} \\phi(r_{ij}) \\right) = -\\frac{1}{2} \\sum_{i \\neq j} \\phi'(r_{ij}) \\nabla_{\\mathbf{r}_k} r_{ij} = -\\frac{1}{2} \\sum_{i \\neq j} \\phi'(r_{ij}) \\hat{\\mathbf{r}}_{ij} (\\delta_{ik} - \\delta_{jk}) $$\n    上式中，只有当 $i=k$ 或 $j=k$ 时，求和项才非零。通过将求和分成这两部分并利用对称性，力可以简化为：\n    $$ \\mathbf{F}_k^{\\text{pair}} = -\\sum_{j \\neq k} \\phi'(r_{kj}) \\hat{\\mathbf{r}}_{kj} $$\n\n2.  **嵌入能部分的力**:\n    $$ \\mathbf{F}_k^{\\text{emb}} = -\\nabla_{\\mathbf{r}_k} \\left( \\sum_{i=1}^{N} F(\\rho_i) \\right) = -\\sum_{i=1}^{N} F'(\\rho_i) \\nabla_{\\mathbf{r}_k} \\rho_i $$\n    我们需要计算 $\\nabla_{\\mathbf{r}_k} \\rho_i$：\n    $$ \\nabla_{\\mathbf{r}_k} \\rho_i = \\nabla_{\\mathbf{r}_k} \\left( \\sum_{m \\neq i} f(r_{im}) \\right) = \\sum_{m \\neq i} f'(r_{im}) \\nabla_{\\mathbf{r}_k} r_{im} = \\sum_{m \\neq i} f'(r_{im}) \\hat{\\mathbf{r}}_{im}(\\delta_{ik} - \\delta_{mk}) $$\n    将此梯度代入力的表达式中，我们得到一个三重求和。为了得到原子 $k$ 上的力，我们只需提取那些包含 $\\delta_{ik}$ 或 $\\delta_{mk}$ 的非零项。这发生在 $i=k$ 或 $m=k$ 时。\n    -   当 $i=k$ 时：$-F'(\\rho_k) \\sum_{m \\neq k} f'(r_{km}) \\hat{\\mathbf{r}}_{km}$。\n    -   当 $m=k$ 时：$-\\sum_{i \\neq k} F'(\\rho_i) f'(r_{ik}) \\hat{\\mathbf{r}}_{ik}(-1) = \\sum_{i \\neq k} F'(\\rho_i) f'(r_{ik}) \\hat{\\mathbf{r}}_{ik}$。\n    将这两部分贡献相加，并用 $j$ 替换求和指标 $m$ 和 $i$，得到嵌入能对原子 $k$ 的总贡献：\n    $$ \\mathbf{F}_k^{\\text{emb}} = -\\sum_{j \\neq k} \\left( F'(\\rho_k) + F'(\\rho_j) \\right) f'(r_{kj}) \\hat{\\mathbf{r}}_{kj} $$\n\n3.  **总力与两遍算法的必要性**:\n    将两部分力相加，得到作用在原子 $k$ 上的总力：\n    $$ \\mathbf{F}_k = \\sum_{j \\neq k} \\mathbf{F}_{kj} = -\\sum_{j \\neq k} \\left[ \\phi'(r_{kj}) + \\left( F'(\\rho_k) + F'(\\rho_j) \\right) f'(r_{kj}) \\right] \\hat{\\mathbf{r}}_{kj} $$\n    这个最终表达式清楚地揭示了两遍算法的必要性。为了计算原子 $k$ 和 $j$ 之间的力 $\\mathbf{F}_{kj}$，我们需要 $F'(\\rho_k)$ 和 $F'(\\rho_j)$ 的值。然而，$\\rho_k$ 的值本身就是对原子 $k$ 的**所有**近邻（包括 $j$）的密度贡献 $f(r)$ 的总和。因此，在计算任何单个力分量之前，必须先知道**所有**原子的**完整**电子密度 $\\rho_i$。\n\n    这自然地导出了一个两遍算法：\n    -   **第一遍（密度累积）**: 遍历所有在截断半径内的原子对 $(i,j)$。对于每一对，计算一次 $f(r_{ij})$，并将其贡献加到 $\\rho_i$ 和 $\\rho_j$ 的累加器中。此遍完成后，每个原子 $i$ 的 $\\rho_i$ 值都是完整的。\n    -   **第二遍（力计算）**: 再次遍历所有近邻原子对 $(i,j)$。此时，$\\rho_i$ 和 $\\rho_j$ 都是已知的，因此可以计算 $F'(\\rho_i)$ 和 $F'(\\rho_j)$。然后，使用这些值以及导数 $\\phi'(r_{ij})$ 和 $f'(r_{ij})$，根据上面的总力公式计算力贡献 $\\mathbf{F}_{ij}$，并将其（根据牛顿第三定律）施加到原子 $i$ 和 $j$ 上。\n\n    该方法是内存高效的，因为它只需要为每个原子存储一个标量 $\\rho_i$ 值，并在两次遍历之间传递。它也避免了在力循环中重复计算 $f(r)$。",
            "answer": "[0.3429383610260216,6,0.0,0,0.0,0,0.11603509935406026,1]"
        }
    ]
}