{
    "hands_on_practices": [
        {
            "introduction": "Understanding the accuracy of a numerical method begins with quantifying its truncation errorâ€”the discrepancy between the discrete operator and the continuous one it approximates. This foundational exercise guides you through the process using Taylor series expansions to analyze the widely used three-point central difference scheme for the second derivative . By completing this practice, you will not only derive the leading error terms but also gain insight into why the symmetry of a stencil is a crucial feature that leads to higher-order accuracy.",
            "id": "3758767",
            "problem": "Consider a one-dimensional homogenized macroscopic field $u(x)$ arising from a multiscale elliptic model in which microscale variations have been averaged out. Let $u$ be $C^6$-smooth on an interval and sampled on a uniform grid with spacing $h>0$. Define the three-point central finite difference approximation to the second derivative by\n$$D_{h}^{2}u(x) \\equiv \\frac{u(x+h)-2u(x)+u(x-h)}{h^{2}}.$$\nStarting only from the definition of truncation error as the difference between the discrete operator applied to the exact function and the corresponding continuum operator applied to the same function, and from the Taylor expansion of a smooth function about a point, derive the local truncation error of the stencil at a point $x$ through terms of order $h^4$. In your derivation, explain why odd derivatives do not appear in the final expression for a central scheme, and interpret this cancellation in the context of symmetry and scale separation in multiscale modeling and analysis. \n\nReport your final answer as a single closed-form analytic expression for the truncation error at $x$ that retains all terms up to and including order $h^4$ in $h$. No numerical rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It poses a standard, verifiable question in numerical analysis and connects it soundly to the field of multiscale modeling. All necessary information is provided, and the problem is free of contradictions or ambiguities. Thus, the problem is valid and a solution can be derived.\n\nThe local truncation error, denoted by $\\tau(x)$, is defined as the difference between the discrete finite difference operator applied to the exact, smooth function $u(x)$ and the continuous differential operator it is intended to approximate. For the given three-point central difference operator $D_{h}^{2}u(x)$ approximating the second derivative $u''(x) \\equiv \\frac{d^2u}{dx^2}$, the truncation error is:\n$$ \\tau(x) = D_{h}^{2}u(x) - u''(x) $$\nSubstituting the definition of the operator, we have:\n$$ \\tau(x) = \\frac{u(x+h) - 2u(x) + u(x-h)}{h^{2}} - u''(x) $$\nTo analyze this expression, we use Taylor's theorem to expand the terms $u(x+h)$ and $u(x-h)$ around the point $x$. The problem specifies that the function $u$ is $C^6$-smooth, which permits Taylor expansion with sufficient terms to determine the error up to order $h^4$. The expansions are:\n$$ u(x+h) = u(x) + u'(x)h + \\frac{u''(x)}{2!}h^{2} + \\frac{u'''(x)}{3!}h^{3} + \\frac{u^{(4)}(x)}{4!}h^{4} + \\frac{u^{(5)}(x)}{5!}h^{5} + \\frac{u^{(6)}(x)}{6!}h^{6} + \\mathcal{O}(h^7) $$\n$$ u(x-h) = u(x) - u'(x)h + \\frac{u''(x)}{2!}h^{2} - \\frac{u'''(x)}{3!}h^{3} + \\frac{u^{(4)}(x)}{4!}h^{4} - \\frac{u^{(5)}(x)}{5!}h^{5} + \\frac{u^{(6)}(x)}{6!}h^{6} + \\mathcal{O}(h^7) $$\nHere, $u^{(n)}(x)$ denotes the $n$-th derivative of $u$ at $x$.\n\nWe substitute these expansions into the numerator of the expression for $D_{h}^{2}u(x)$:\n$$ u(x+h) - 2u(x) + u(x-h) = \\left( \\sum_{k=0}^{6} \\frac{u^{(k)}(x)}{k!}h^{k} \\right) - 2u(x) + \\left( \\sum_{k=0}^{6} \\frac{u^{(k)}(x)}{k!}(-h)^{k} \\right) + \\mathcal{O}(h^7) $$\nCombining the terms from the two series, we observe a cancellation pattern. For terms with an odd index $k$, we have $h^{k} + (-h)^{k} = h^{k} - h^{k} = 0$. For terms with an even index $k$, we have $h^{k} + (-h)^{k} = h^{k} + h^{k} = 2h^{k}$. Let's write out the sum explicitly:\n$$ u(x+h) + u(x-h) = 2u(x) + 2\\frac{u''(x)}{2!}h^{2} + 2\\frac{u^{(4)}(x)}{4!}h^{4} + 2\\frac{u^{(6)}(x)}{6!}h^{6} + \\mathcal{O}(h^8) $$\nSubtracting the $2u(x)$ term gives the full numerator:\n$$ u(x+h) - 2u(x) + u(x-h) = 2\\frac{u''(x)}{2!}h^{2} + 2\\frac{u^{(4)}(x)}{4!}h^{4} + 2\\frac{u^{(6)}(x)}{6!}h^{6} + \\mathcal{O}(h^8) $$\nSubstituting the factorial values ($2! = 2$, $4! = 24$, $6! = 720$):\n$$ u(x+h) - 2u(x) + u(x-h) = u''(x)h^{2} + \\frac{2}{24}u^{(4)}(x)h^{4} + \\frac{2}{720}u^{(6)}(x)h^{6} + \\mathcal{O}(h^8) $$\n$$ u(x+h) - 2u(x) + u(x-h) = u''(x)h^{2} + \\frac{1}{12}u^{(4)}(x)h^{4} + \\frac{1}{360}u^{(6)}(x)h^{6} + \\mathcal{O}(h^8) $$\nNow, we can write the full expression for $D_{h}^{2}u(x)$ by dividing by $h^{2}$:\n$$ D_{h}^{2}u(x) = \\frac{1}{h^{2}} \\left( u''(x)h^{2} + \\frac{1}{12}u^{(4)}(x)h^{4} + \\frac{1}{360}u^{(6)}(x)h^{6} + \\mathcal{O}(h^8) \\right) $$\n$$ D_{h}^{2}u(x) = u''(x) + \\frac{1}{12}u^{(4)}(x)h^{2} + \\frac{1}{360}u^{(6)}(x)h^{4} + \\mathcal{O}(h^6) $$\nFinally, we compute the truncation error $\\tau(x)$ by subtracting $u''(x)$:\n$$ \\tau(x) = D_{h}^{2}u(x) - u''(x) = \\left( u''(x) + \\frac{1}{12}u^{(4)}(x)h^{2} + \\frac{1}{360}u^{(6)}(x)h^{4} + \\mathcal{O}(h^6) \\right) - u''(x) $$\nThe problem asks for the expression through terms of order $h^{4}$. We therefore truncate the series after the $h^4$ term:\n$$ \\tau(x) = \\frac{1}{12}u^{(4)}(x)h^{2} + \\frac{1}{360}u^{(6)}(x)h^{4} $$\nIt is often conventional to write this with the powers of $h$ grouped:\n$$ \\tau(x) = \\frac{h^{2}}{12}u^{(4)}(x) + \\frac{h^{4}}{360}u^{(6)}(x) $$\n\nThe reason odd derivatives do not appear in the final expression is due to the symmetry of the central difference stencil. The stencil coefficients for $D_h^2u(x)$ are proportional to $(1, -2, 1)$, centered at $x$. The evaluation points are $x-h$ and $x+h$, which are symmetric with respect to $x$. When the Taylor series for $u(x+h)$ and $u(x-h)$ are combined in the expression $u(x+h) + u(x-h)$, the terms containing odd powers of $h$, such as $u'(x)h$ and $u'''(x)h^3/6$, have opposite signs and cancel exactly. These terms correspond to the odd derivatives of $u(x)$. This cancellation happens for all odd-order terms, leading to an error series that contains only even powers of $h$.\n\nIn the context of multiscale modeling and analysis, this symmetry is a crucial property. The process of homogenization or upscaling averages out microscale details to produce a macroscopic model. It is often a fundamental requirement that this process preserves the essential physical symmetries of the underlying microscopic system. For instance, if the microscale physics is invariant under spatial reflection (parity), the resulting macroscopic continuum model and its numerical discretization should also respect this symmetry. A non-symmetric stencil, such as a forward difference $\\frac{u(x+h)-u(x)}{h}$, would introduce an artificial directionality, breaking the reflection symmetry. This broken symmetry would manifest as a leading-order error term involving an odd derivative (e.g., proportional to $u''(x)h$ for the forward difference approximation of $u'(x)$), which is not invariant under the transformation $h \\to -h$. The use of a symmetric central difference scheme ensures that the numerical method does not introduce spurious asymmetries into the model. This preserves the integrity of the scale separation, ensuring that the computed macroscopic behavior is a genuine consequence of the upscaled physics and not an artifact of a biased numerical discretization. This principle is vital for the fidelity of multiscale simulations.",
            "answer": "$$\\boxed{\\frac{h^{2}}{12}u^{(4)}(x) + \\frac{h^{4}}{360}u^{(6)}(x)}$$"
        },
        {
            "introduction": "Once we can analyze the error of a scheme, a natural question is how to systematically reduce it. This practice introduces Richardson extrapolation, an elegant and powerful technique for improving the accuracy of a numerical solution by combining results from multiple grid resolutions . You will derive the classic formula that uses outputs from grids with spacing $h$ and $h/2$ to eliminate the leading-order error term, providing a higher-order estimate of the true solution without needing to devise a more complex discretization scheme.",
            "id": "3758782",
            "problem": "Consider a scalar quantity of interest $Q$ arising in a multiscale partial differential equation (PDE) model, for which a spatial finite difference approximation is used on a uniform grid of spacing $h$. Assume that the discretization is second-order consistent, meaning that for sufficiently smooth exact solution and sufficiently small $h$, the discrete approximation $Q_{h}$ admits an asymptotic truncation error expansion of the form\n$$\nQ_{h} \\;=\\; Q \\;+\\; c_{2} h^{2} \\;+\\; c_{3} h^{3} \\;+\\; c_{4} h^{4} \\;+\\; \\cdots,\n$$\nwhere the coefficients $c_{k}$ may depend on model parameters (including a possible scale-separation parameter) but are bounded uniformly as $h \\to 0$. Similarly, a computation on the refined grid $h/2$ yields\n$$\nQ_{h/2} \\;=\\; Q \\;+\\; c_{2} \\left(\\frac{h}{2}\\right)^{2} \\;+\\; c_{3} \\left(\\frac{h}{2}\\right)^{3} \\;+\\; c_{4} \\left(\\frac{h}{2}\\right)^{4} \\;+\\; \\cdots.\n$$\nUsing only the definitions of consistency and the smooth asymptotic structure of truncation error, construct an affine combination $\\widehat{Q} \\;=\\; \\alpha\\, Q_{h/2} \\;+\\; \\beta\\, Q_{h}$ with $\\alpha + \\beta = 1$ that eliminates the leading truncation error term. Derive the coefficients $\\alpha$ and $\\beta$ by enforcing the cancellation of the $h^{2}$ contribution, and then identify the order of the remaining leading truncation error without assuming any parity structure in the series, as well as in the special case where the truncation error involves only even powers of $h$. Your final answer must be a single closed-form analytic expression for $\\widehat{Q}$ written in terms of $Q_{h/2}$ and $Q_{h}$ only. No rounding is required and no units are involved.",
            "solution": "The problem requires the construction of an improved approximation $\\widehat{Q}$ from two existing approximations, $Q_h$ and $Q_{h/2}$, obtained from a second-order finite difference scheme. The improved approximation is to be an affine combination of the form $\\widehat{Q} = \\alpha\\, Q_{h/2} + \\beta\\, Q_{h}$ with the constraint $\\alpha + \\beta = 1$. The goal is to choose $\\alpha$ and $\\beta$ to eliminate the leading-order term of the truncation error.\n\nThe provided asymptotic error expansions for the discrete approximations on grids with spacing $h$ and $h/2$ are:\n$$\nQ_{h} = Q + c_{2} h^{2} + c_{3} h^{3} + c_{4} h^{4} + \\mathcal{O}(h^5)\n$$\n$$\nQ_{h/2} = Q + c_{2} \\left(\\frac{h}{2}\\right)^{2} + c_{3} \\left(\\frac{h}{2}\\right)^{3} + c_{4} \\left(\\frac{h}{2}\\right)^{4} + \\mathcal{O}(h^5)\n$$\nwhere $Q$ is the exact quantity and the coefficients $c_k$ are independent of $h$. Simplifying the powers in the expansion for $Q_{h/2}$ gives:\n$$\nQ_{h/2} = Q + \\frac{c_{2}}{4} h^{2} + \\frac{c_{3}}{8} h^{3} + \\frac{c_{4}}{16} h^{4} + \\mathcal{O}(h^5)\n$$\nWe form the affine combination $\\widehat{Q}$ by substituting these expansions:\n$$\n\\widehat{Q} = \\alpha \\left( Q + \\frac{c_{2}}{4} h^{2} + \\frac{c_{3}}{8} h^{3} + \\frac{c_{4}}{16} h^{4} + \\cdots \\right) + \\beta \\left( Q + c_{2} h^{2} + c_{3} h^{3} + c_{4} h^{4} + \\cdots \\right)\n$$\nCollecting terms by powers of $h$, we get:\n$$\n\\widehat{Q} = (\\alpha + \\beta)Q + c_{2}\\left(\\frac{\\alpha}{4} + \\beta\\right)h^{2} + c_{3}\\left(\\frac{\\alpha}{8} + \\beta\\right)h^{3} + c_{4}\\left(\\frac{\\alpha}{16} + \\beta\\right)h^{4} + \\cdots\n$$\nTo determine the coefficients $\\alpha$ and $\\beta$, we impose two conditions.\nFirst, for $\\widehat{Q}$ to be a consistent approximation to $Q$, the coefficient of $Q$ in its expansion must be $1$. This yields the condition:\n$$\n\\alpha + \\beta = 1\n$$\nThis condition is given in the problem statement as a property of an affine combination.\n\nSecond, to eliminate the leading truncation error term, which is of order $h^2$, we must set the coefficient of the $h^2$ term to zero:\n$$\n\\frac{\\alpha}{4} + \\beta = 0\n$$\nWe now have a system of two linear equations for $\\alpha$ and $\\beta$:\n1. $\\alpha + \\beta = 1$\n2. $\\frac{\\alpha}{4} + \\beta = 0$\n\nFrom equation (2), we express $\\beta$ in terms of $\\alpha$: $\\beta = -\\frac{\\alpha}{4}$.\nSubstituting this into equation (1):\n$$\n\\alpha + \\left(-\\frac{\\alpha}{4}\\right) = 1 \\implies \\frac{3\\alpha}{4} = 1 \\implies \\alpha = \\frac{4}{3}\n$$\nNow, we find $\\beta$:\n$$\n\\beta = -\\frac{\\alpha}{4} = -\\frac{1}{4}\\left(\\frac{4}{3}\\right) = -\\frac{1}{3}\n$$\nThus, the coefficients are $\\alpha = \\frac{4}{3}$ and $\\beta = -\\frac{1}{3}$. The resulting improved approximation, known as the Richardson extrapolation of $Q_h$ and $Q_{h/2}$, is:\n$$\n\\widehat{Q} = \\frac{4}{3} Q_{h/2} - \\frac{1}{3} Q_{h}\n$$\nNext, we analyze the truncation error of this new approximation, which is given by $\\widehat{Q} - Q$:\n$$\n\\widehat{Q} - Q = c_{3}\\left(\\frac{\\alpha}{8} + \\beta\\right)h^{3} + c_{4}\\left(\\frac{\\alpha}{16} + \\beta\\right)h^{4} + \\cdots\n$$\nLet's compute the coefficient of the $h^3$ term:\n$$\n\\text{Coeff}(h^{3}) = c_{3}\\left(\\frac{1}{8}\\left(\\frac{4}{3}\\right) - \\frac{1}{3}\\right) = c_{3}\\left(\\frac{1}{6} - \\frac{1}{3}\\right) = c_{3}\\left(\\frac{1}{6} - \\frac{2}{6}\\right) = -\\frac{c_{3}}{6}\n$$\nIn the general case, where no specific structure is assumed for the error expansion (i.e., $c_3$ is not necessarily zero), the leading term of the truncation error for $\\widehat{Q}$ is $-\\frac{c_{3}}{6}h^3$. The order of the approximation $\\widehat{Q}$ is therefore $3$.\n\nNow consider the special case where the truncation error of the original scheme involves only even powers of $h$. This is common for numerical schemes based on centered differences. In this scenario, all odd-indexed coefficients $c_k$ are zero, i.e., $c_3 = c_5 = c_7 = \\cdots = 0$.\nThe error expansion for $\\widehat{Q}$ becomes:\n$$\n\\widehat{Q} - Q = c_{4}\\left(\\frac{\\alpha}{16} + \\beta\\right)h^{4} + c_{6}\\left(\\frac{\\alpha}{64} + \\beta\\right)h^{6} + \\cdots\n$$\nThe leading error term is now the $h^4$ term. We compute its coefficient:\n$$\n\\text{Coeff}(h^{4}) = c_{4}\\left(\\frac{1}{16}\\left(\\frac{4}{3}\\right) - \\frac{1}{3}\\right) = c_{4}\\left(\\frac{1}{12} - \\frac{1}{3}\\right) = c_{4}\\left(\\frac{1}{12} - \\frac{4}{12}\\right) = -\\frac{3c_{4}}{12} = -\\frac{c_{4}}{4}\n$$\nIn this special case, the leading term of the truncation error for $\\widehat{Q}$ is $-\\frac{c_{4}}{4}h^4$. The order of the approximation $\\widehat{Q}$ is therefore $4$.\n\nThe problem asks for the single closed-form analytic expression for $\\widehat{Q}$ in terms of $Q_{h/2}$ and $Q_h$. Based on our derived coefficients, this expression is:\n$$\n\\widehat{Q} = \\frac{4}{3}Q_{h/2} - \\frac{1}{3}Q_{h}\n$$",
            "answer": "$$\n\\boxed{\\frac{4}{3} Q_{h/2} - \\frac{1}{3} Q_{h}}\n$$"
        },
        {
            "introduction": "To gain a deeper, more physical understanding of numerical errors, we can analyze the 'modified equation' that a scheme effectively solves. This advanced practice challenges you to derive the modified equation for the upwind scheme and use it to predict the behavior of the global error . The exercise culminates in a computational component where you will write a program to validate your theoretical prediction, bridging the gap between analysis and simulation and demonstrating how numerical artifacts like artificial diffusion arise and can be quantified.",
            "id": "3758731",
            "problem": "Consider linear advection of a smooth multiscale signal on a periodic domain governed by the partial differential equation $u_t + a\\,u_x = 0$ on $x \\in [0,2\\pi]$ with periodic boundary conditions, where $a$ is a constant speed. Let the initial condition be $u(x,0) = A_1 \\sin(k_1 x) + A_2 \\sin(k_2 x)$ with $A_1 = 0.8$, $A_2 = 0.4$, $k_1 = 7$, $k_2 = 19$, and $a = 1$. Angles must be interpreted in radians. The exact solution is $u(x,t) = A_1 \\sin(k_1 (x - a t)) + A_2 \\sin(k_2 (x - a t))$. Consider the explicit upwind finite difference approximation on a uniform grid with $N$ points, grid spacing $h = 2\\pi/N$, and time step $k$ chosen to maintain the Courant number $C = a k / h$. The numerical scheme updates the solution via $u_j^{n+1} = u_j^n - C\\,(u_j^n - u_{j-1}^n)$ with periodic indexing $j-1$ interpreted modulo $N$. \n\nThe goal is to use the method of modified equations to argue about pre-asymptotic error behavior. Starting from Taylor expansions of the discrete update and the definition of truncation error, derive the leading-order modified equation that the upwind scheme solves, identify the leading correction term and its dependence on $h$, $C$, and derivatives of $u$, and then use this to predict the dominant contribution to the global error for the given multiscale initial condition. Specifically, the prediction must quantify the dependence of the leading error on the amplitudes $A_1$, $A_2$, wavenumbers $k_1$, $k_2$, the Courant number $C$, and the final time to which the scheme is advanced.\n\nYou must then validate the prediction empirically by computing the discrete $L^2$-norm of the error between the numerical solution and the exact solution at the final time. The discrete $L^2$-norm on a uniform grid is defined as $\\|e\\|_2 = \\sqrt{h \\sum_{j=0}^{N-1} (u_j^{\\text{num}} - u(x_j,t))^2}$, where $x_j = j h$. Use a fixed target time $t_{\\mathrm{end}} = 0.7$ and apply an integer number of steps $n = \\left\\lfloor \\frac{t_{\\mathrm{end}}}{k} + 0.5 \\right\\rfloor$ so that the actual final time advanced is $t_{\\mathrm{final}} = n k$. Compute the exact solution at $t_{\\mathrm{final}}$ to compare with the numerical solution.\n\nDesign a program that performs the following for each test case:\n- Simulates the upwind scheme for the given parameters until $t_{\\mathrm{final}}$.\n- Computes the discrete $L^2$ error $\\|e\\|_2$.\n- Computes the leading-order prediction for the error from the modified equation analysis at $t_{\\mathrm{final}}$.\n- Reports the ratio $\\rho = \\|e\\|_2 / E_{\\mathrm{pred}}$ when the leading-order prediction $E_{\\mathrm{pred}}$ is nonzero; otherwise, when the leading-order prediction is zero, report the absolute error $\\|e\\|_2$.\n\nThe test suite is:\n1. $N = 192$, $C = 0.25$.\n2. $N = 384$, $C = 0.85$.\n3. $N = 384$, $C = 1.0$.\n\nFor scientific realism, ensure that the simulation uses the stated scheme and periodic boundary conditions, and that angles are measured in radians. The final program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where $r_1$ and $r_2$ are the ratios $\\rho$ for test cases $1$ and $2$, and $r_3$ is the absolute error $\\|e\\|_2$ for test case $3$. All outputs must be expressed as floating-point numbers with no physical units.\n\nYour derivation must start from fundamental definitions of truncation error and Taylor expansions of the scheme, and proceed to the modified equation and the leading-order error for combinations of Fourier modes. No shortcut formulas or intermediate results should be assumed; the logic must be derived from first principles. The program must validate the prediction numerically by matching the leading error term with empirical convergence behavior across the provided test cases.",
            "solution": "The user-provided problem is valid as it is scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in the numerical analysis of partial differential equations, specifically focusing on the method of modified equations for the first-order upwind scheme applied to the linear advection equation. All parameters and conditions are clearly defined, and the task is to derive a theoretical error prediction and validate it numerically.\n\n### Derivation of the Modified Equation and Error Prediction\n\nThe problem concerns the linear advection equation $u_t + a\\,u_x = 0$ on a periodic domain $x \\in [0, 2\\pi]$. The first-order explicit upwind scheme for a positively-valued advection speed $a > 0$ is given by\n$$ u_j^{n+1} = u_j^n - C(u_j^n - u_{j-1}^n) $$\nwhere $u_j^n \\approx u(x_j, t_n)$, $x_j=jh$, $t_n=nk$, $h=2\\pi/N$ is the grid spacing, $k$ is the time step, and $C = ak/h$ is the Courant number.\n\nTo derive the modified equation, we perform Taylor series expansions of each term in the scheme around the point $(x_j, t_n)$. Let $u = u(x_j, t_n)$.\nThe left-hand side term is:\n$$ u_j^{n+1} = u(x_j, t_n+k) = u + k u_t + \\frac{k^2}{2} u_{tt} + \\frac{k^3}{6} u_{ttt} + \\mathcal{O}(k^4) $$\nThe terms on the right-hand side are:\n$$ u_j^n = u $$\n$$ u_{j-1}^n = u(x_j-h, t_n) = u - h u_x + \\frac{h^2}{2} u_{xx} - \\frac{h^3}{6} u_{xxx} + \\mathcal{O}(h^4) $$\nSubstituting these expansions into the finite difference scheme:\n$$ u + k u_t + \\frac{k^2}{2} u_{tt} + \\ldots = u - C \\left( u - \\left(u - h u_x + \\frac{h^2}{2} u_{xx} - \\frac{h^3}{6} u_{xxx} + \\ldots \\right) \\right) $$\n$$ k u_t + \\frac{k^2}{2} u_{tt} + \\ldots = - C \\left( h u_x - \\frac{h^2}{2} u_{xx} + \\frac{h^3}{6} u_{xxx} - \\ldots \\right) $$\nUsing the definition of the Courant number, $C=ak/h \\implies Ch=ak$:\n$$ k u_t + \\frac{k^2}{2} u_{tt} + \\ldots = -ak u_x + \\frac{akh}{2} u_{xx} - \\frac{akh^2}{6} u_{xxx} + \\ldots $$\nDividing by the time step $k$:\n$$ u_t + \\frac{k}{2} u_{tt} + \\ldots = -a u_x + \\frac{ah}{2} u_{xx} - \\frac{ah^2}{6} u_{xxx} + \\ldots $$\nRearranging to match the form of the original PDE, we get an expression for the truncation error:\n$$ u_t + a u_x = \\frac{ah}{2} u_{xx} - \\frac{k}{2} u_{tt} - \\frac{ah^2}{6} u_{xxx} + \\mathcal{O}(k^2, h^3, kh, \\ldots) $$\nThis equation reveals what PDE the numerical scheme is actually solving. To simplify it further, we express time derivatives in terms of spatial derivatives. The lowest-order approximation from the original PDE is $u_t = -a u_x$. Differentiating this gives $u_{tt} = -a u_{xt} = -a (u_t)_x = -a (-a u_x)_x = a^2 u_{xx}$. Substituting this into the equation above:\n$$ u_t + a u_x = \\frac{ah}{2} u_{xx} - \\frac{k}{2}(a^2 u_{xx}) + \\mathcal{O}(h^2, k^2) $$\n$$ u_t + a u_x = \\left(\\frac{ah}{2} - \\frac{ka^2}{2}\\right) u_{xx} + \\mathcal{O}(h^2, k^2) $$\nFactoring out $\\frac{ah}{2}$ and using $C=ak/h$:\n$$ u_t + a u_x = \\frac{ah}{2} \\left(1 - \\frac{ka}{h}\\right) u_{xx} + \\mathcal{O}(h^2, k^2) = \\frac{ah}{2}(1-C) u_{xx} + \\mathcal{O}(h^2) $$\nThis is the leading-order modified equation. The term $\\frac{ah}{2}(1-C) u_{xx}$ is a numerical diffusion (or dissipation) term. It is the leading correction term, indicating the scheme is first-order accurate.\n\nThe global error $e(x,t) = u^{\\text{num}}(x,t) - u(x,t)$ approximately satisfies the error equation obtained by subtracting the original PDE from the modified equation:\n$$ e_t + a e_x \\approx \\frac{ah}{2}(1-C) u_{xx} $$\nwhere $u$ is the exact solution of the original PDE. The solution to this inhomogeneous advection equation for the error (with zero initial error, $e(x,0)=0$) can be found by integrating the source term along the characteristics $x-at=\\text{const}$. At a final time $t_{\\mathrm{final}}$, the error is approximately:\n$$ e(x, t_{\\mathrm{final}}) \\approx t_{\\mathrm{final}} \\left[ \\frac{ah}{2}(1-C) u_{xx}(x, t_{\\mathrm{final}}) \\right] $$\nThis holds because for the exact solution $u(x,t) = f(x-at)$, the second derivative $u_{xx}(x,t) = f''(x-at)$ is also a function of $x-at$ and is thus constant along characteristics.\n\nThe given initial condition is $u(x,0) = A_1 \\sin(k_1 x) + A_2 \\sin(k_2 x)$. The exact solution is $u(x,t) = A_1 \\sin(k_1(x-at)) + A_2 \\sin(k_2(x-at))$.\nIts second spatial derivative is:\n$$ u_{xx}(x,t) = -k_1^2 A_1 \\sin(k_1(x-at)) - k_2^2 A_2 \\sin(k_2(x-at)) $$\nSubstituting this into the error expression:\n$$ e(x, t_{\\mathrm{final}}) \\approx -t_{\\mathrm{final}} \\frac{ah}{2}(1-C) \\left[ k_1^2 A_1 \\sin(k_1(x-at_{\\mathrm{final}})) + k_2^2 A_2 \\sin(k_2(x-at_{\\mathrm{final}})) \\right] $$\nTo find the predicted $L^2$-norm of the error, $E_{\\mathrm{pred}}$, we use the discrete norm definition, which for large $N$ approximates the continuous integral norm $\\sqrt{\\int_0^{2\\pi} e(x,t)^2 dx}$.\n$$ E_{\\mathrm{pred}}^2 = \\|e(x, t_{\\mathrm{final}})\\|_2^2 = h \\sum_{j=0}^{N-1} e(x_j, t_{\\mathrm{final}})^2 $$\n$$ E_{\\mathrm{pred}}^2 \\approx h \\sum_{j=0}^{N-1} \\left[ -t_{\\mathrm{final}} \\frac{ah}{2}(1-C) \\right]^2 \\left[ k_1^2 A_1 \\sin(\\theta_{1j}) + k_2^2 A_2 \\sin(\\theta_{2j}) \\right]^2 $$\nwhere $\\theta_{ij} = k_i(x_j-at_{\\mathrm{final}})$. By the orthogonality of sine functions on the discrete grid (for wavenumbers $k_1=7, k_2=19$ that are not aliased), the sum of the cross-product term $\\sin(\\theta_{1j})\\sin(\\theta_{2j})$ is negligible. We use the discrete summation identity $\\sum_{j=0}^{N-1} \\sin^2(k x_j + \\phi) = N/2$ for integer $k$ not a multiple of $N/2$.\n$$ \\sum_{j=0}^{N-1} e(x_j, t_{\\mathrm{final}})^2 \\approx \\left[ t_{\\mathrm{final}} \\frac{ah}{2}(1-C) \\right]^2 \\left( (k_1^2 A_1)^2 \\frac{N}{2} + (k_2^2 A_2)^2 \\frac{N}{2} \\right) $$\nMultiplying by $h=2\\pi/N$, we get $h \\cdot (N/2) = \\pi$.\n$$ E_{\\mathrm{pred}}^2 \\approx \\left[ t_{\\mathrm{final}} \\frac{ah}{2}(1-C) \\right]^2 \\pi \\left[ (k_1^2 A_1)^2 + (k_2^2 A_2)^2 \\right] $$\nTaking the square root gives the final prediction for the $L^2$ error norm:\n$$ E_{\\mathrm{pred}} = \\left| t_{\\mathrm{final}} \\frac{ah}{2}(1-C) \\right| \\sqrt{\\pi \\left[ (k_1^2 A_1)^2 + (k_2^2 A_2)^2 \\right]} $$\nThis prediction depends on the final time $t_{\\mathrm{final}}$, grid spacing $h$, Courant number $C$, and properties of the initial condition ($A_1, A_2, k_1, k_2$).\n\nFor the special case $C=1$, the upwind scheme becomes $u_j^{n+1}=u_{j-1}^n$. This is an exact shift operator. After $n$ steps, the numerical solution is $u_j^n = u_{j-n}^0 = u(x_j-nh, 0)$. The exact solution at time $t=nk$ is $u(x_j, nk) = u(x_j-ank, 0)$. Since $C=ak/h=1$, it follows that $ak=h$, so $ank = nh$. The numerical shift $nh$ exactly matches the physical advection distance $at$. Thus, the numerical solution is exact on the grid points, and the error $\\|e\\|_2$ should be zero up to floating-point precision. Our formula for $E_{\\mathrm{pred}}$ reflects this, as the term $(1-C)$ becomes zero.\n\nThe program below will implement the simulation and compare the measured error $\\|e\\|_2$ with the predicted error $E_{\\mathrm{pred}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the linear advection problem using an upwind scheme,\n    and validates the leading-order error prediction from the\n    method of modified equations.\n    \"\"\"\n\n    # Define problem parameters from the statement\n    A1 = 0.8\n    A2 = 0.4\n    k1 = 7.0\n    k2 = 19.0\n    a = 1.0\n    t_end = 0.7\n    domain_L = 2 * np.pi\n\n    # Define the test cases\n    test_cases = [\n        (192, 0.25),  # (N, C) for case 1\n        (384, 0.85),  # (N, C) for case 2\n        (384, 1.0),   # (N, C) for case 3\n    ]\n\n    results = []\n\n    # Pre-compute the amplitude/wavenumber term for the error prediction\n    # E_pred = | t_final * a * h / 2 * (1-C) | * pred_mag\n    # pred_mag = sqrt(pi * [ (k1^2 * A1)^2 + (k2^2 * A2)^2 ])\n    pred_mag_sq_term = (k1**2 * A1)**2 + (k2**2 * A2)**2\n    pred_mag = np.sqrt(np.pi * pred_mag_sq_term)\n\n    for N, C in test_cases:\n        # Calculate grid and time step parameters\n        h = domain_L / N\n        k = C * h / a\n        \n        # Calculate number of steps to reach t_end as closely as possible\n        if k > 0:\n            n_steps = int(t_end / k + 0.5)\n        else: # Avoid division by zero if k=0 (though not in test cases)\n            n_steps = 0\n            \n        t_final = n_steps * k\n\n        # Set up the spatial grid\n        x = np.linspace(0, domain_L, N, endpoint=False)\n\n        # Initial condition\n        u_initial = A1 * np.sin(k1 * x) + A2 * np.sin(k2 * x)\n        \n        # --- Run the simulation ---\n        u_numerical = u_initial.copy()\n        for _ in range(n_steps):\n            # Upwind scheme: u_j^{n+1} = u_j^n - C * (u_j^n - u_{j-1}^n)\n            # np.roll(u, 1) implements the periodic boundary for u_{j-1}\n            u_numerical = u_numerical - C * (u_numerical - np.roll(u_numerical, 1))\n            \n        # --- Compute the error ---\n        # Exact solution at t_final\n        u_exact = A1 * np.sin(k1 * (x - a * t_final)) + A2 * np.sin(k2 * (x - a * t_final))\n\n        # Error vector\n        error_vec = u_numerical - u_exact\n\n        # Discrete L2-norm of the error\n        # ||e||_2 = sqrt(h * sum(e_j^2))\n        l2_error = np.sqrt(h * np.sum(error_vec**2))\n\n        # --- Calculate the report value ---\n        if C == 1.0:\n            # Special case: prediction is zero, report absolute error\n            # For C=1, the scheme is exactly a shift, error should be near machine precision\n            report_value = l2_error\n        else:\n            # Predicted L2-error from modified equation analysis\n            E_pred = np.abs(t_final * a * h / 2.0 * (1.0 - C)) * pred_mag\n            \n            # Report the ratio of measured error to predicted error\n            if E_pred > 0:\n                report_value = l2_error / E_pred\n            else: # Should not happen for C!=1, but handle defensively\n                report_value = l2_error\n\n        results.append(report_value)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}