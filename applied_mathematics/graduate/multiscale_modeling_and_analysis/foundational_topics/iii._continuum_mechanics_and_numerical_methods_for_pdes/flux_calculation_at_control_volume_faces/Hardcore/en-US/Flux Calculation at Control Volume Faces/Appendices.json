{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering numerical flux calculations is to understand the fundamental consequences of how we approximate values at control volume faces. This exercise explores the two most basic approaches for linear advection: a simple averaging (central differencing) and an upwind-biased choice (donor-cell upwinding). By deriving the leading-order errors and analyzing the stability of these schemes, you will gain direct insight into the ubiquitous numerical artifacts of dispersion and diffusion, and see how the choice of reconstruction profoundly impacts the stability and quality of a simulation .",
            "id": "3759508",
            "problem": "Consider one-dimensional linear advection of a passive scalar $\\phi(x,t)$ with constant positive velocity $a>0$, governed by the conservation law $\\partial_t \\phi + \\partial_x (a \\phi) = 0$. On a uniform Cartesian grid with cell centers at $x_i$ and faces at $x_{i\\pm \\frac{1}{2}}$, with cell size $\\Delta x$, adopt a finite-volume formulation in which the semi-discrete evolution of the cell-average $\\phi_i(t)$ is determined by the net convective flux through the cell faces. Assume the face value $\\phi_{i+\\frac{1}{2}}$ is reconstructed from neighboring cell-centered values by either a second-order centered interpolation or a first-order donor-cell upwind interpolation (appropriate for $a>0$). \n\nTasks:\n- Starting from the integral conservation law and the definition of face flux $F_{i+\\frac{1}{2}} = a\\,\\phi_{i+\\frac{1}{2}}$, derive the semi-discrete convective operator for each reconstruction and, using Taylor expansion about $x_i$, obtain the leading-order term in the modified equation (i.e., the leading truncation error term added to $a\\,\\partial_x \\phi$ by the spatial discretization of the flux divergence) for each method on the uniform grid.\n- Using explicit forward Euler time integration applied to each semi-discrete spatial discretization, perform a von Neumann Fourier stability analysis to derive the amplification factor $G(\\kappa)$ as a function of the nondimensional wavenumber $\\kappa$ and the Courant–Friedrichs–Lewy (CFL) number $C = a\\,\\Delta t / \\Delta x$. Determine the maximum value $C_{\\max}$ such that $|G(\\kappa)| \\leq 1$ for all $\\kappa \\in [0,\\pi]$ for each method.\n\nProvide the final answer as a single row matrix containing, in order: the leading-order truncation error term for the second-order centered reconstruction, the leading-order truncation error term for the first-order upwind reconstruction (for $a>0$), the maximum stable CFL number for the second-order centered method with forward Euler, and the maximum stable CFL number for the first-order upwind method with forward Euler. No rounding is required, and do not include units in your final answer.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It presents a standard task in the numerical analysis of partial differential equations. We will proceed with the derivation.\n\nThe governing one-dimensional linear advection equation is given by the conservation law:\n$$ \\partial_t \\phi + \\partial_x (a \\phi) = 0 $$\nwhere the velocity $a$ is a positive constant ($a>0$). For a finite-volume formulation, we integrate this equation over a control volume (cell) $i$, which extends from face $x_{i-\\frac{1}{2}}$ to $x_{i+\\frac{1}{2}}$. The cell width is $\\Delta x = x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}$.\n$$ \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\partial_t \\phi \\,dx + \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\partial_x (a \\phi) \\,dx = 0 $$\nDefining the cell-average value as $\\phi_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\phi(x,t) \\,dx$, the equation becomes:\n$$ \\frac{d}{dt}(\\Delta x \\phi_i) + [a \\phi]_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} = 0 $$\n$$ \\frac{d\\phi_i}{dt} = - \\frac{1}{\\Delta x} \\left( a\\phi(x_{i+\\frac{1}{2}}, t) - a\\phi(x_{i-\\frac{1}{2}}, t) \\right) $$\nThe finite volume method approximates the exact face values $\\phi(x_{i\\pm\\frac{1}{2}}, t)$ using reconstructed values from the neighboring cell-averages $\\phi_j(t)$. The numerical flux at the face $x_{i+\\frac{1}{2}}$ is defined as $F_{i+\\frac{1}{2}} = a\\,\\phi_{i+\\frac{1}{2}}$, where $\\phi_{i+\\frac{1}{2}}$ is the reconstructed value. The semi-discrete finite volume scheme is:\n$$ \\frac{d\\phi_i}{dt} = - \\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x} $$\nThe term on the right-hand side is the semi-discrete convective operator. The term inside the parentheses, $F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}$, represents the net flux out of cell $i$. The operator $\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x}$ is a numerical approximation to the exact flux divergence, $a\\,\\partial_x \\phi$.\n\nPart 1: Truncation Error Analysis\n\nWe find the leading-order truncation error by substituting Taylor series expansions of the cell-average values into the expression for the numerical flux divergence, $\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x}$, and comparing it to the exact term $a\\,\\partial_x\\phi$. We use the following expansions around $x_i$:\n$$ \\phi_{i\\pm1} = \\phi(x_i \\pm \\Delta x) = \\phi_i \\pm \\Delta x (\\partial_x \\phi)_i + \\frac{(\\Delta x)^2}{2} (\\partial_x^2 \\phi)_i \\pm \\frac{(\\Delta x)^3}{6} (\\partial_x^3 \\phi)_i + \\mathcal{O}((\\Delta x)^4) $$\n\nSecond-Order Centered Reconstruction:\nThe face value is the average of the two adjacent cell-centered values: $\\phi_{i+\\frac{1}{2}} = \\frac{\\phi_i + \\phi_{i+1}}{2}$.\nThe numerical flux is $F_{i+\\frac{1}{2}} = a \\frac{\\phi_i + \\phi_{i+1}}{2}$.\nThe numerical flux divergence for cell $i$ is:\n$$ \\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x} = \\frac{a}{\\Delta x} \\left( \\frac{\\phi_i + \\phi_{i+1}}{2} - \\frac{\\phi_{i-1} + \\phi_i}{2} \\right) = \\frac{a}{2\\Delta x}(\\phi_{i+1} - \\phi_{i-1}) $$\nSubstituting the Taylor series for $\\phi_{i+1}$ and $\\phi_{i-1}$:\n$$ \\phi_{i+1} - \\phi_{i-1} = \\left(\\phi_i + \\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i + \\frac{(\\Delta x)^3}{6} \\partial_x^3 \\phi_i\\right) - \\left(\\phi_i - \\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i - \\frac{(\\Delta x)^3}{6} \\partial_x^3 \\phi_i\\right) + \\mathcal{O}((\\Delta x)^5) $$\n$$ \\phi_{i+1} - \\phi_{i-1} = 2\\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^3}{3} \\partial_x^3 \\phi_i + \\mathcal{O}((\\Delta x)^5) $$\nThe numerical flux divergence is then:\n$$ \\frac{a}{2\\Delta x} \\left( 2\\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^3}{3} \\partial_x^3 \\phi_i + \\dots \\right) = a\\,\\partial_x \\phi_i + \\frac{a(\\Delta x)^2}{6} \\partial_x^3 \\phi_i + \\dots $$\nThe exact term is $a\\,\\partial_x \\phi$. The leading-order term added by the discretization is the leading error term, which is a dispersive term:\n$$ \\text{Error Term (Centered)} = \\frac{a(\\Delta x)^2}{6} \\partial_x^3 \\phi $$\n\nFirst-Order Donor-Cell Upwind Reconstruction:\nFor $a>0$, the flow is from left to right, so the upwind or \"donor\" cell for the face $x_{i+\\frac{1}{2}}$ is cell $i$. The reconstruction is $\\phi_{i+\\frac{1}{2}} = \\phi_i$.\nThe numerical flux is $F_{i+\\frac{1}{2}} = a\\,\\phi_i$.\nThe numerical flux divergence for cell $i$ is:\n$$ \\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x} = \\frac{a\\phi_i - a\\phi_{i-1}}{\\Delta x} $$\nSubstituting the Taylor series for $\\phi_{i-1}$:\n$$ \\phi_{i-1} = \\phi_i - \\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i + \\mathcal{O}((\\Delta x)^3) $$\nThe numerical flux divergence is then:\n$$ \\frac{a}{\\Delta x} \\left( \\phi_i - \\left( \\phi_i - \\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i + \\dots \\right) \\right) = \\frac{a}{\\Delta x} \\left( \\Delta x \\partial_x \\phi_i - \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i + \\dots \\right) $$\n$$ = a\\,\\partial_x \\phi_i - \\frac{a\\Delta x}{2} \\partial_x^2 \\phi_i + \\dots $$\nThe leading-order term added to $a\\,\\partial_x \\phi$ is the leading error term, which is a diffusive term:\n$$ \\text{Error Term (Upwind)} = - \\frac{a\\Delta x}{2} \\partial_x^2 \\phi $$\n\nPart 2: Von Neumann Stability Analysis\n\nWe analyze the stability of the fully discrete schemes obtained by applying explicit forward Euler time integration. The CFL number is $C = a\\,\\Delta t/\\Delta x$. We seek a solution of the form $\\phi_j^n = G^n(\\kappa) \\exp(Ij\\kappa)$, where $I$ is the imaginary unit, $n$ is the time level index, $j$ is the spatial index, and $\\kappa = k \\Delta x$ is the dimensionless wavenumber. The scheme is stable if the amplification factor $G(\\kappa)$ satisfies $|G(\\kappa)| \\leq 1$ for all $\\kappa \\in [0, \\pi]$.\n\nSecond-Order Centered Scheme with Forward Euler:\nThe fully discrete equation is:\n$$ \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = - \\frac{a}{2\\Delta x}(\\phi_{i+1}^n - \\phi_{i-1}^n) $$\n$$ \\phi_i^{n+1} = \\phi_i^n - \\frac{a\\Delta t}{2\\Delta x}(\\phi_{i+1}^n - \\phi_{i-1}^n) = \\phi_i^n - \\frac{C}{2}(\\phi_{i+1}^n - \\phi_{i-1}^n) $$\nSubstituting the Fourier mode:\n$$ G^{n+1}\\exp(Ii\\kappa) = G^n\\exp(Ii\\kappa) - \\frac{C}{2} \\left( G^n\\exp(I(i+1)\\kappa) - G^n\\exp(I(i-1)\\kappa) \\right) $$\nDividing by $G^n\\exp(Ii\\kappa)$:\n$$ G(\\kappa) = 1 - \\frac{C}{2}(\\exp(I\\kappa) - \\exp(-I\\kappa)) = 1 - \\frac{C}{2}(2I \\sin(\\kappa)) = 1 - IC\\sin(\\kappa) $$\nThe magnitude squared of the amplification factor is:\n$$ |G(\\kappa)|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2 = 1^2 + (-C\\sin(\\kappa))^2 = 1 + C^2\\sin^2(\\kappa) $$\nThe stability condition $|G(\\kappa)|^2 \\leq 1$ requires $1 + C^2\\sin^2(\\kappa) \\leq 1$, which implies $C^2\\sin^2(\\kappa) \\leq 0$. Since both $C^2$ and $\\sin^2(\\kappa)$ are non-negative, this is only possible if $C\\sin(\\kappa) = 0$. For any wavenumber $\\kappa$ other than integer multiples of $\\pi$, this requires $C=0$. Thus, the scheme is unconditionally unstable for any non-zero time step.\n$$ C_{\\max} = 0 $$\n\nFirst-Order Upwind Scheme with Forward Euler:\nThe fully discrete equation is:\n$$ \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = - \\frac{a}{\\Delta x}(\\phi_i^n - \\phi_{i-1}^n) $$\n$$ \\phi_i^{n+1} = \\phi_i^n - \\frac{a\\Delta t}{\\Delta x}(\\phi_i^n - \\phi_{i-1}^n) = \\phi_i^n - C(\\phi_i^n - \\phi_{i-1}^n) $$\nSubstituting the Fourier mode:\n$$ G^{n+1}\\exp(Ii\\kappa) = G^n\\exp(Ii\\kappa) - C \\left( G^n\\exp(Ii\\kappa) - G^n\\exp(I(i-1)\\kappa) \\right) $$\nDividing by $G^n\\exp(Ii\\kappa)$:\n$$ G(\\kappa) = 1 - C(1 - \\exp(-I\\kappa)) = 1 - C(1 - (\\cos(\\kappa) - I\\sin(\\kappa))) $$\n$$ G(\\kappa) = (1 - C + C\\cos(\\kappa)) + I(C\\sin(\\kappa)) $$\nThe magnitude squared is:\n$$ |G(\\kappa)|^2 = (1 - C + C\\cos(\\kappa))^2 + (C\\sin(\\kappa))^2 $$\n$$ |G(\\kappa)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos(\\kappa) + C^2\\cos^2(\\kappa) + C^2\\sin^2(\\kappa) $$\n$$ |G(\\kappa)|^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos(\\kappa) = 1 - 2C(1-C)(1-\\cos(\\kappa)) $$\nUsing the identity $1 - \\cos(\\kappa) = 2\\sin^2(\\kappa/2)$:\n$$ |G(\\kappa)|^2 = 1 - 4C(1-C)\\sin^2(\\kappa/2) $$\nThe stability condition $|G(\\kappa)|^2 \\leq 1$ requires:\n$$ 1 - 4C(1-C)\\sin^2(\\kappa/2) \\leq 1 \\implies -4C(1-C)\\sin^2(\\kappa/2) \\leq 0 \\implies C(1-C)\\sin^2(\\kappa/2) \\geq 0 $$\nSince $C \\geq 0$ and $\\sin^2(\\kappa/2) \\geq 0$, stability requires $C(1-C) \\geq 0$. This inequality holds for $0 \\leq C \\leq 1$. Additionally, we must have $|G(\\kappa)|^2 \\ge 0$. The minimum value of $|G(\\kappa)|^2$ occurs when $\\sin^2(\\kappa/2)$ is maximum ($1$), which gives $1 - 4C(1-C)$. The maximum value of $4C(1-C)$ on $[0,1]$ is $1$ (at $C=1/2$), so $|G(\\kappa)|^2 \\ge 1-1=0$. Both conditions are satisfied. Thus, the scheme is conditionally stable. The maximum stable CFL number is:\n$$ C_{\\max} = 1 $$\n\nThe four requested quantities are:\n1. Leading truncation error for centered scheme: $\\frac{a(\\Delta x)^2}{6} \\partial_x^3 \\phi$\n2. Leading truncation error for upwind scheme: $- \\frac{a\\Delta x}{2} \\partial_x^2 \\phi$\n3. $C_{\\max}$ for centered scheme with forward Euler: $0$\n4. $C_{\\max}$ for upwind scheme with forward Euler: $1$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{a(\\Delta x)^2}{6} \\partial_x^3 \\phi  - \\frac{a\\Delta x}{2} \\partial_x^2 \\phi  0  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Building upon the foundational concepts of accuracy and stability, this practice moves toward a more sophisticated and practical approach used in modern computational codes. The Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) provides a pathway to achieving higher-order accuracy while preventing the spurious oscillations that plague simple high-order schemes. In this problem, you will implement the core of the MUSCL methodology: constructing a limited linear data reconstruction within a cell and using it to compute a physically bounded and more accurate face flux .",
            "id": "3759523",
            "problem": "Consider a scalar advection problem on a two-dimensional uniform Cartesian mesh, where a control volume indexed by $i$ has center at $\\mathbf{x}_i = (0,0)$ and edge-centered face locations at $\\mathbf{x}_e = (0.5,0)$ (east face), $\\mathbf{x}_w = (-0.5,0)$ (west face), $\\mathbf{x}_n = (0,0.5)$ (north face), and $\\mathbf{x}_s = (0,-0.5)$ (south face). The grid spacing is $\\Delta x = 1$ and $\\Delta y = 1$. Neighboring cell centers are at $\\mathbf{x}_E = (1,0)$, $\\mathbf{x}_W = (-1,0)$, $\\mathbf{x}_N = (0,1)$, and $\\mathbf{x}_S = (0,-1)$. The scalar field has cell-centered values $\\phi_i = 2.0$, $\\phi_E = 2.6$, $\\phi_W = 1.4$, $\\phi_N = 2.2$, and $\\phi_S = 1.8$. Assume a constant advective velocity with east-face normal component $(\\mathbf{u}\\cdot\\mathbf{n}_e) = u_n = 1.3$ and east-face area $A_e = \\Delta y = 1$. Treat the density as unity, so that the east-face advective flux is $F_e = u_n\\,\\phi_e\\,A_e$.\n\nStarting from the integral conservation form for a transported scalar and the finite volume paradigm in which face fluxes are computed from face values reconstructed from cell-centered data, derive a linear, bounded reconstruction consistent with the Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL), anchored at the cell center and expressed in terms of a slope vector. Enforce the boundedness requirement that no new extrema are introduced at faces by constructing the slope through a limiter that compares one-sided differences along coordinate directions and returns a slope consistent with monotonicity. Apply this construction to compute the limited slope vector for cell $i$ from the given neighbor values and grid spacings, then evaluate the reconstructed scalar at the east-face center $\\mathbf{x}_e$, and finally compute the east-face convective flux $F_e$.\n\nReport the final flux $F_e$ as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the convective flux on the east face of a control volume using the Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL). This involves a multi-step process: determining a limited slope for the scalar field within the control volume, reconstructing the scalar value at the face center, and then using this value to compute the flux.\n\nThe foundation of the finite volume method is the integral form of the conservation law for a scalar quantity $\\phi$ over a control volume $V_i$:\n$$\n\\frac{d}{dt} \\int_{V_i} \\phi \\, dV + \\oint_{\\partial V_i} (\\mathbf{u}\\phi) \\cdot \\mathbf{n} \\, dA = \\int_{V_i} S_\\phi \\, dV\n$$\nFor a steady-state advection problem without sources, this simplifies to the statement that the net flux across the control volume boundary $\\partial V_i$ is zero. The flux through a single face $f$ is $F_f = \\int_{A_f} (\\rho \\mathbf{u}\\phi) \\cdot \\mathbf{n} \\, dA$. In the finite volume approximation, this is approximated as $F_f \\approx (\\rho_f \\mathbf{u}_f \\cdot \\mathbf{n}_f A_f) \\phi_f$. Given that density $\\rho$ is unity, the east-face flux is $F_e = (\\mathbf{u} \\cdot \\mathbf{n}_e) A_e \\phi_e = u_n A_e \\phi_e$. The key challenge is to determine the face value $\\phi_e$.\n\nThe MUSCL scheme provides a second-order accurate spatial discretization by reconstructing the scalar field linearly within each control volume. The reconstructed value of $\\phi$ at any point $\\mathbf{x}$ inside or on the boundary of cell $i$ is given by:\n$$\n\\phi(\\mathbf{x}) = \\phi_i + \\nabla\\phi_i \\cdot (\\mathbf{x} - \\mathbf{x}_i)\n$$\nwhere $\\phi_i$ is the cell-centered value in cell $i$, $\\mathbf{x}_i$ is the cell center, and $\\nabla\\phi_i$ is the limited gradient (or slope) of the scalar field in cell $i$.\n\nThe slope $\\nabla\\phi_i = \\left( \\frac{\\partial\\phi}{\\partial x}\\bigg|_i, \\frac{\\partial\\phi}{\\partial y}\\bigg|_i \\right)$ must be \"limited\" to satisfy the boundedness principle, which prevents the reconstruction from creating new local maxima or minima. This is achieved by using a slope limiter. The problem specifies constructing the slope by comparing one-sided differences.\n\nLet's compute the slope for cell $i$. The neighboring cell-centered values are given as $\\phi_i = 2.0$, $\\phi_E = 2.6$, $\\phi_W = 1.4$, $\\phi_N = 2.2$, and $\\phi_S = 1.8$. The grid spacing is uniform with $\\Delta x = 1$ and $\\Delta y = 1$.\n\nFirst, we calculate the one-sided slopes in the $x$-direction for cell $i$:\nThe backward slope (using cell $W$):\n$$\ns_{x, \\text{bwd}} = \\frac{\\phi_i - \\phi_W}{\\mathbf{x}_i_x - \\mathbf{x}_W_x} = \\frac{2.0 - 1.4}{0 - (-1)} = \\frac{0.6}{1} = 0.6\n$$\nThe forward slope (using cell $E$):\n$$\ns_{x, \\text{fwd}} = \\frac{\\phi_E - \\phi_i}{\\mathbf{x}_E_x - \\mathbf{x}_i_x} = \\frac{2.6 - 2.0}{1 - 0} = \\frac{0.6}{1} = 0.6\n$$\nSince both one-sided slopes have the same sign ($s_{x, \\text{bwd}} \\cdot s_{x, \\text{fwd}} > 0$), the profile is monotonic in this region. When the one-sided slopes are identical, any standard symmetric slope limiter (e.g., minmod, van Leer, superbee) will return this value as the limited slope. Thus, the $x$-component of the limited gradient is:\n$$\n\\frac{\\partial\\phi}{\\partial x}\\bigg|_i = 0.6\n$$\n\nNext, we calculate the one-sided slopes in the $y$-direction for cell $i$:\nThe backward slope (using cell $S$):\n$$\ns_{y, \\text{bwd}} = \\frac{\\phi_i - \\phi_S}{\\mathbf{x}_i_y - \\mathbf{x}_S_y} = \\frac{2.0 - 1.8}{0 - (-1)} = \\frac{0.2}{1} = 0.2\n$$\nThe forward slope (using cell $N$):\n$$\ns_{y, \\text{fwd}} = \\frac{\\phi_N - \\phi_i}{\\mathbf{x}_N_y - \\mathbf{x}_i_y} = \\frac{2.2 - 2.0}{1 - 0} = \\frac{0.2}{1} = 0.2\n$$\nAgain, the one-sided slopes are identical and positive. The $y$-component of the limited gradient is:\n$$\n\\frac{\\partial\\phi}{\\partial y}\\bigg|_i = 0.2\n$$\nThe limited slope vector for cell $i$ is therefore $\\nabla\\phi_i = (0.6, 0.2)$.\n\nThe next step is to evaluate the reconstructed scalar value at the east-face center, $\\mathbf{x}_e = (0.5, 0)$. The velocity component normal to the east face is given as $u_n = 1.3$, which is positive. This indicates that the flow is from cell $i$ to cell $E$. For an upwind scheme like MUSCL, the face value $\\phi_e$ is determined by the reconstruction in the upwind cell, which is cell $i$.\nUsing the linear reconstruction formula with $\\mathbf{x}_i = (0,0)$:\n$$\n\\phi_e = \\phi(\\mathbf{x}_e) = \\phi_i + \\nabla\\phi_i \\cdot (\\mathbf{x}_e - \\mathbf{x}_i)\n$$\n$$\n\\phi_e = 2.0 + (0.6, 0.2) \\cdot ((0.5, 0) - (0,0))\n$$\n$$\n\\phi_e = 2.0 + (0.6 \\times 0.5) + (0.2 \\times 0) = 2.0 + 0.3 = 2.3\n$$\nThis reconstructed value $\\phi_e = 2.3$ is between the neighboring cell values $\\phi_i = 2.0$ and $\\phi_E = 2.6$, confirming that the boundedness criterion is satisfied.\n\nFinally, we compute the east-face convective flux $F_e$ using the provided formula and data: $F_e = u_n \\phi_e A_e$.\nThe given values are $u_n = 1.3$ and $A_e = \\Delta y = 1$:\n$$\nF_e = 1.3 \\times 2.3 \\times 1 = 2.99\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nF_e = 2.990\n$$",
            "answer": "$$\\boxed{2.990}$$"
        },
        {
            "introduction": "For many physical systems, particularly in fluid dynamics, the governing equations are hyperbolic and admit discontinuous solutions like shock waves. At the interface between two different states, a simple reconstruction is insufficient; we need a physically-grounded model for how these states interact. This exercise introduces the Harten–Lax–van Leer (HLL) approximate Riemann solver, a robust and widely-used method for computing the interface flux by modeling the local wave structure. Deriving the HLL flux will illuminate how upwinding is generalized from simple scalar advection to complex nonlinear systems, providing a crucial tool for shock-capturing schemes in multiscale analysis .",
            "id": "3759519",
            "problem": "Consider a hyperbolic system of conservation laws in $d$ spatial dimensions, written in conservation form as $\\partial_t U + \\nabla \\cdot F(U) = 0$, where $U \\in \\mathbb{R}^m$ is the vector of conserved variables and $F(U) \\in \\mathbb{R}^{m \\times d}$ is the flux tensor. In a finite-volume discretization for multiscale modeling and analysis, the flux across a control volume face with unit normal $\\boldsymbol{n}$ is computed from a local one-dimensional Riemann problem posed in the normal direction. Let $f_n(U) := F(U)\\,\\boldsymbol{\\cdot}\\,\\boldsymbol{n} \\in \\mathbb{R}^m$ denote the face-normal flux vector and assume a discontinuity at the face with left and right states $U_L$ and $U_R$, respectively. The Harten–Lax–van Leer (HLL) approximate Riemann solver models the solution by a two-wave structure with minimal and maximal signal speeds $s_L$ and $s_R$ along the normal direction, which bound a single intermediate constant state.\n\nStarting from the integral conservation law over a space–time control volume aligned with the face normal and from the Rankine–Hugoniot jump condition across each wave, construct the HLL numerical flux at the face in terms of $U_L$, $U_R$, $f_n(U_L)$, $f_n(U_R)$, $s_L$, and $s_R$. In particular, derive the closed-form analytic expression for the intermediate face-normal flux state $f_n^{*}$ that arises between the two bounding waves in the HLL model. Express your final answer as a single analytic expression.",
            "solution": "The problem statement is parsed and determined to be valid. It is a well-posed problem in the field of numerical analysis for partial differential equations, specifically concerning the derivation of the Harten–Lax–van Leer (HLL) numerical flux. The problem is scientifically grounded, self-contained, and objective. We may therefore proceed with a formal derivation.\n\nThe problem considers a system of conservation laws in $d$ dimensions, $\\partial_t U + \\nabla \\cdot F(U) = 0$. In a finite-volume context, the flux across a cell face is determined by solving a one-dimensional Riemann problem in the direction normal to the face, $\\boldsymbol{n}$. Let $x$ be the spatial coordinate along $\\boldsymbol{n}$. The local one-dimensional conservation law is given by:\n$$\n\\partial_t U + \\partial_x f_n(U) = 0\n$$\nwhere $f_n(U) = F(U) \\cdot \\boldsymbol{n}$ is the normal flux vector. The initial condition for this Riemann problem is a discontinuity at $x=0$, separating a left state $U_L$ from a right state $U_R$.\n\nThe HLL approximate Riemann solver models the solution of this problem with a simplified wave structure. It assumes the solution consists of three constant states: the original left state $U_L$, an intermediate state $U^*$, and the original right state $U_R$. These states are separated by two waves propagating away from the initial discontinuity at $x=0$ with the minimal and maximal signal speeds, $s_L$ and $s_R$ respectively, where $s_L  s_R$. The solution structure is:\n$$\nU(x, t) =\n\\begin{cases}\nU_L  \\text{if } x/t  s_L \\\\\nU^*  \\text{if } s_L  x/t  s_R \\\\\nU_R  \\text{if } x/t  s_R\n\\end{cases}\n$$\nThe problem requires the derivation of the intermediate face-normal flux state, which we denote as $f_n^* \\equiv f_n(U^*)$. This can be accomplished by applying the Rankine–Hugoniot jump conditions across each of the two waves. The Rankine–Hugoniot condition for a discontinuity moving with speed $s$ is $s \\Delta U = \\Delta f_n$, where $\\Delta(\\cdot)$ represents the jump in a quantity across the discontinuity (right state minus left state).\n\nApplying this condition to the left-moving wave with speed $s_L$, the jump is from state $U_L$ to state $U^*$. Thus, we have:\n$$\ns_L (U^* - U_L) = f_n(U^*) - f_n(U_L)\n$$\nUsing our definition $f_n^* = f_n(U^*)$, this becomes:\n$$\ns_L (U^* - U_L) = f_n^* - f_n(U_L) \\quad (1)\n$$\n\nApplying the condition to the right-moving wave with speed $s_R$, the jump is from state $U^*$ to state $U_R$. This gives:\n$$\ns_R (U_R - U^*) = f_n(U_R) - f_n(U^*)\n$$\nwhich can be written as:\n$$\ns_R (U_R - U^*) = f_n(U_R) - f_n^* \\quad (2)\n$$\n\nEquations $(1)$ and $(2)$ form a system of two linear vector equations for the two unknown vectors, $U^*$ and $f_n^*$. Our goal is to solve for $f_n^*$. We can do this by first rearranging both equations to isolate the term involving $U^*$ and then eliminating $U^*$.\n\nFrom equation $(1)$:\n$$\ns_L U^* - f_n^* = s_L U_L - f_n(U_L)\n$$\nFrom equation $(2)$:\n$$\n-s_R U^* + f_n^* = f_n(U_R) - s_R U_R \\implies s_R U^* - f_n^* = s_R U_R - f_n(U_R)\n$$\nWe now have the system:\n$$\n\\begin{cases}\ns_L U^* - f_n^* = s_L U_L - f_n(U_L)  (1') \\\\\ns_R U^* - f_n^* = s_R U_R - f_n(U_R)  (2')\n\\end{cases}\n$$\nTo eliminate $U^*$, we can multiply equation $(1')$ by $s_R$ and equation $(2')$ by $s_L$:\n$$\n\\begin{cases}\ns_R s_L U^* - s_R f_n^* = s_R (s_L U_L - f_n(U_L)) \\\\\ns_L s_R U^* - s_L f_n^* = s_L (s_R U_R - f_n(U_R))\n\\end{cases}\n$$\nSubtracting the second new equation from the first eliminates the $s_L s_R U^*$ term:\n$$\n(-s_R f_n^*) - (-s_L f_n^*) = s_R (s_L U_L - f_n(U_L)) - s_L (s_R U_R - f_n(U_R))\n$$\n$$\n(s_L - s_R) f_n^* = s_R s_L U_L - s_R f_n(U_L) - s_L s_R U_R + s_L f_n(U_R)\n$$\nGroup the terms on the right-hand side:\n$$\n(s_L - s_R) f_n^* = (s_L f_n(U_R) - s_R f_n(U_L)) - s_L s_R (U_R - U_L)\n$$\nFinally, we solve for $f_n^*$ by dividing by $(s_L - s_R)$, assuming $s_L \\neq s_R$:\n$$\nf_n^* = \\frac{s_L f_n(U_R) - s_R f_n(U_L) - s_L s_R (U_R - U_L)}{s_L - s_R}\n$$\nTo obtain a more conventional form, we can multiply the numerator and denominator by $-1$:\n$$\nf_n^* = \\frac{-(s_L f_n(U_R) - s_R f_n(U_L) - s_L s_R (U_R - U_L))}{-(s_L - s_R)} = \\frac{s_R f_n(U_L) - s_L f_n(U_R) + s_L s_R (U_R - U_L)}{s_R - s_L}\n$$\nThis is the closed-form analytic expression for the intermediate face-normal flux state $f_n^*$ in the HLL approximate Riemann solver, constructed from the initial states $U_L$ and $U_R$, their corresponding normal fluxes $f_n(U_L)$ and $f_n(U_R)$, and the signal speeds $s_L$ and $s_R$. This flux $f_n^*$ is used as the numerical flux at the interface for the common case where $s_L \\le 0 \\le s_R$.",
            "answer": "$$\n\\boxed{\\frac{s_R f_n(U_L) - s_L f_n(U_R) + s_L s_R (U_R - U_L)}{s_R - s_L}}\n$$"
        }
    ]
}