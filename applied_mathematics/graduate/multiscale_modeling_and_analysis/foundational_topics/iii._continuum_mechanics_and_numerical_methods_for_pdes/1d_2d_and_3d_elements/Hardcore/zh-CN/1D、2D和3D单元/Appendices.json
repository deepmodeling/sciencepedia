{
    "hands_on_practices": [
        {
            "introduction": "在建立任何有限元模型时，首要步骤是确定问题的规模。这涉及到计算系统的总自由度（DOFs），并考虑边界条件如何减少待解未知量的数量。这项基础练习  将引导您完成这一过程，通过一个简单的悬臂梁模型，巩固您对网格组装、节点自由度以及基本边界条件如何约束系统并确保解的唯一性的理解。",
            "id": "3728934",
            "problem": "一个具有三维微观结构的细长、线性弹性、非均质悬臂微梁，在结构尺度上采用一维 (1D) Timoshenko 梁理想化模型在有限元法 (FEM) 框架内进行建模。该模型与一个多尺度框架一致，其中横截面的剪切和弯曲刚度代表了均质化的子尺度行为。该梁位于平面内，Timoshenko 梁的每个节点都带有节点自由度 (DOF) 集合 $\\{u_{x},u_{y},\\theta_{z}\\}$，其中 $u_{x}$ 是轴向平移，$u_{y}$ 是横向平移，$\\theta_{z}$ 是绕平面外轴线的转动。该梁被离散为 4 个串联的等长 Timoshenko 梁单元，每个单元有 2 个节点，并按照标准的有限元方法进行组装，使得相邻单元共享的节点被识别为单个全局节点。左端完全夹紧，在最左侧的全局节点上施加本质 (Dirichlet) 边界条件 $u_{x}=0$、$u_{y}=0$ 和 $\\theta_{z}=0$，其他地方没有其他运动学约束。\n\n从组装网格中的节点共享、每节点自由度以及作为消除未知量的约束的本质边界条件等基本定义出发，确定：(i) 施加任何边界条件之前的全局总自由度数，以及 (ii) 在左端施加夹紧边界条件后的最终无约束全局自由度数。仅将第 (ii) 部分的数量作为您的最终答案，以一个不带单位的整数形式报告。在您的推理中，请从约束的节点自由度和在平面设置中消除刚体运动的角度，证明边界条件如何减少自由度数。",
            "solution": "首先将验证问题陈述的科学合理性、完整性和客观性。\n\n### 步骤 1：提取已知条件\n- **模型**：三维 ($3$D) 微梁的一维 ($1$D) Timoshenko 梁理想化模型。\n- **框架**：多尺度建模；横截面属性是均质化的。\n- **离散化**：4 个串联的等长、2 节点 Timoshenko 梁单元。\n- **每节点自由度 (DOF)**：$\\{u_{x}, u_{y}, \\theta_{z}\\}$，分别对应轴向平移、横向平移和平面外转动。每节点的自由度数为 3。\n- **组装**：标准的有限元法 (FEM) 组装，相邻单元共享的节点被识别为单个全局节点。\n- **边界条件**：左端完全夹紧，在最左侧的全局节点上施加 $u_{x}=0$、$u_{y}=0$ 和 $\\theta_{z}=0$。\n- **约束**：未施加其他运动学约束。\n- **任务**：确定 (i) 施加边界条件前的全局总自由度数，以及 (ii) 施加边界条件后的最终无约束全局自由度数。最终答案应为第 (ii) 部分的结果。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是有限元法在结构力学问题（悬臂梁）中的标准应用。所使用的术语——Timoshenko 梁、自由度、本质边界条件、FEM 组装——在计算力学领域是标准的且有精确定义。该设置是计算全局系统矩阵大小的经典教科书练习。问题是自洽的，提供了所有必要的数据，并且不包含内部矛盾或科学上错误的假设。它是适定的和客观的。\n\n### 步骤 3：结论与行动\n问题有效。将制定一个合理的解决方案。\n\n求解过程首先确定组装的、无约束系统中的总自由度数，然后减去由本质边界条件约束的自由度数。\n\n**第 (i) 部分：施加边界条件前的全局总自由度数**\n\n必须确定网格中全局节点的总数。该梁被离散为 $N_{el} = 4$ 个串联的单元。对于线性单元链，唯一全局节点的数量 $N_{nodes}$ 由下式给出：\n$$N_{nodes} = N_{el} + 1$$\n代入给定的单元数量：\n$$N_{nodes} = 4 + 1 = 5$$\n这 5 个全局节点定义了整个梁模型的几何形状和位移场。\n\n问题陈述，每个节点带有 $N_{dof/node} = 3$ 个自由度：$\\{u_{x}, u_{y}, \\theta_{z}\\}$。\n\n无约束全局系统中的总自由度数 $N_{total}$ 是全局节点数与每节点自由度数的乘积：\n$$N_{total} = N_{nodes} \\times N_{dof/node}$$\n代入计算值和给定值：\n$$N_{total} = 5 \\times 3 = 15$$\n因此，在施加任何边界条件之前，该系统由 15 个独立的运动学变量描述。\n\n**第 (ii) 部分：施加边界条件后的最终无约束全局自由度数**\n\n问题指明梁的左端是完全夹紧的。在有限元法的背景下，“夹紧”或“固定”支座施加了本质 (Dirichlet) 边界条件，这些条件预先指定了节点自由度的值。对于最左侧的全局节点（我们将其表示为节点 1），条件是：\n- $u_{x,1} = 0$\n- $u_{y,1} = 0$\n- $\\theta_{z,1} = 0$\n\n这些方程中的每一个都固定了一个全局自由度的值，将其从待求解的未知数集合中移除。因此，被约束的自由度数 $N_{constrained}$ 等于所施加的本质边界条件的数量。\n$$N_{constrained} = 3$$\n\n最终的无约束（或“自由”）全局自由度数 $N_{free}$ 是总自由度数减去被约束的自由度数：\n$$N_{free} = N_{total} - N_{constrained}$$\n$$N_{free} = 15 - 3 = 12$$\n\n这个最终数字 $N_{free} = 12$ 代表了为求解未知节点位移和转动而必须求解的简化线性方程组的大小。对于静态问题，这将是分区和凝聚后全局刚度矩阵的维数。\n\n按照要求，提供关于刚体运动的额外论证。在平面中的一个无约束物体拥有 3 种刚体运动模式：沿 x 轴的平移、沿 y 轴的平移以及绕 z 轴的转动。一个可解的静态或动态结构问题要求通过足够的边界条件来抑制这些刚体运动。指定的夹紧条件通过固定单个节点上的三个自由度 $\\{u_{x}, u_{y}, \\theta_{z}\\}$，直接约束了两个正交方向上的平移和平面内的转动。这组 3 个约束是完全消除所有 3 种可能的刚体运动所需的最小条件，从而使结构在运动学上稳定。因此，系统自由度减少 3 正好对应于从解空间中移除了不确定的刚体模式，从而确保了梁的弹性变形有一个唯一的解。",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "有限元方法的核心在于单元刚度矩阵的计算，它将单个单元的节点力与节点位移联系起来。这项练习  将带您深入刚度矩阵的“内部”，通过推导其一个具体分量，来揭示材料本构关系（$C$ 矩阵）、单元几何变形（$B$ 矩阵）以及等参映射和高斯积分在其中扮演的关键角色。通过完成这个练习，您将能清晰地看到物理原理是如何被转化为可计算的数值形式的。",
            "id": "3728961",
            "problem": "考虑一个来自有限元法 (FEM) 的处于平面应力状态下的单个二维双线性等参四边形有限元。该单元在物理坐标系中占据一个矩形区域，其角节点位于 $(0,0)$、$(L_x,0)$、$(L_x,L_y)$ 和 $(0,L_y)$，其中 $L_x>0$ 且 $L_y>0$。材料是均匀、各向同性且线弹性的，在平面应力条件下，其杨氏模量为 $E>0$，泊松比为 $\\nu \\in (-1,0.5)$，单元厚度为 $t>0$。令 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 表示自然坐标，并采用标准的双线性形函数\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\n假设采用通常的等参映射 $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i$ 和 $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i$，对于此矩形单元，该映射是仿射的，且具有一个常数雅可比矩阵。在平面应力下，使用本构关系 $\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}$，其中\n$$\n\\mathbf{C} = \\frac{E}{1-\\nu^2}\n\\begin{pmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{pmatrix},\n$$\n应变向量采用工程形式 $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx},\\,\\varepsilon_{yy},\\,\\gamma_{xy})^{\\mathsf{T}}$。令 $\\mathbf{B}(\\xi,\\eta)$ 表示该单元的应变-位移矩阵。考虑与节点1的x方向位移自由度相对应的标量刚度项 $k_{11}$，其定义为单元刚度矩阵的 $(1,1)$ 分量\n$$\nk_{11} = \\int_{\\Omega_e} \\left[ \\mathbf{B}(\\mathbf{x})^{\\mathsf{T}} \\mathbf{C}\\, \\mathbf{B}(\\mathbf{x}) \\right]_{(u_1,u_1)}\\, d\\Omega,\n$$\n其中下标 $(u_1,u_1)$ 表示与节点1的x方向位移自身相互作用相关的标量项。\n\n仅从上述定义和小应变线弹性运动学出发，执行以下操作：\n- 推导与节点1的x方向位移相关的 $\\mathbf{B}$ 矩阵的应变-位移列向量，并用 $L_x$、$L_y$、$\\xi$ 和 $\\eta$ 表示。\n- 在每个方向上使用两点高斯求积（即，使用 $2\\times 2$ 个高斯点，其坐标为 $\\xi,\\eta = \\pm 1/\\sqrt{3}$ 且权重为单位权重），通过等参映射来计算 $k_{11}$，并证明对于此仿射映射，该数值积分能得到精确值。\n- 通过在 $[-1,1]\\times[-1,1]$ 上进行解析积分来精确计算同一积分，并通过确定被积函数的多项式次数来证明其与高斯求积结果相等。\n\n将您的最终答案表示为关于 $k_{11}$ 的单个闭式符号表达式，用 $E$、$\\nu$、$t$、$L_x$ 和 $L_y$ 表示。仅报告符号表达式，不包括单位。无需进行数值四舍五入。",
            "solution": "用户提供了一个来自固体力学领域有限元法 (FEM) 的问题。任务是计算一个处于平面应力条件下的双线性四边形单元的特定单元刚度矩阵项 $k_{11}$。该问题需要多步推导，包括使用数值积分和解析积分，并证明它们的等价性。\n\n### 第 1 步：问题验证\n\n**1.1. 提取已知条件：**\n- **单元类型**：单个二维 ($2$D) 双线性等参四边形有限元。\n- **物理坐标**：角节点位于 $(x_1, y_1)=(0,0)$、$(x_2, y_2)=(L_x,0)$、$(x_3, y_3)=(L_x,L_y)$ 和 $(x_4, y_4)=(0,L_y)$，其中 $L_x > 0$ 且 $L_y > 0$。\n- **自然坐标**：$(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$。\n- **形函数**：\n  - $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n  - $N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n  - $N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n  - $N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n- **材料属性**：均匀、各向同性、线弹性的材料，其杨氏模量 $E > 0$，泊松比 $\\nu \\in (-1, 0.5)$，厚度 $t > 0$。\n- **本构关系**：平面应力条件，$\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}$，应变向量为 $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^{\\mathsf{T}}$，本构矩阵为\n$$\n\\mathbf{C} = \\frac{E}{1-\\nu^2}\n\\begin{pmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{pmatrix}\n$$\n- **刚度矩阵项**：单元刚度矩阵 $\\mathbf{K}_e$ 的 $(1,1)$ 分量，记作 $k_{11}$，由下式给出\n$$\nk_{11} = \\int_{\\Omega_e} \\left[ \\mathbf{B}(\\mathbf{x})^{\\mathsf{T}} \\mathbf{C}\\, \\mathbf{B}(\\mathbf{x}) \\right]_{(u_1,u_1)}\\, d\\Omega\n$$\n其中积分在单元域 $\\Omega_e$ 上进行。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学上成立**：该问题完全在标准的、公认的线弹性理论和有限元法框架内进行表述。所有给定的方程（形函数、本构矩阵、刚度积分）都是教科书中的定义。\n- **适定性**：该问题提供了唯一确定 $k_{11}$ 值所需的所有数据和关系。指示清晰，能导出一个唯一的、确定的结果。\n- **客观性**：该问题使用正式、无歧义的数学和工程语言陈述。\n- **完整性**：问题设置是完整的。几何形状、材料模型、运动学假设（等参映射）以及要计算的具体量都已明确定义。\n- **结论**：问题是有效的。这是一个计算力学中的标准练习，尽管细节较多。\n\n### 第 2 步：推导与求解\n\n求解过程将首先推导应变-位移矩阵 $\\mathbf{B}$，然后使用高斯求积和解析积分计算刚度项 $k_{11}$，最后确认两者的等价性。\n\n**2.1. 等参映射与雅可比矩阵**\n\n等参映射将物理坐标 $(x,y)$ 与自然坐标 $(\\xi,\\eta)$ 联系起来：\n$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$ 和 $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$。\n代入节点坐标：\n$x(\\xi,\\eta) = N_2(\\xi,\\eta) L_x + N_3(\\xi,\\eta) L_x = \\frac{L_x}{4}[(1+\\xi)(1-\\eta) + (1+\\xi)(1+\\eta)] = \\frac{L_x}{4}(1+\\xi)(2) = \\frac{L_x}{2}(1+\\xi)$。\n$y(\\xi,\\eta) = N_3(\\xi,\\eta) L_y + N_4(\\xi,\\eta) L_y = \\frac{L_y}{4}[(1+\\xi)(1+\\eta) + (1-\\xi)(1+\\eta)] = \\frac{L_y}{4}(1+\\eta)(2) = \\frac{L_y}{2}(1+\\eta)$。\n这是一个仿射映射。该变换的雅可比矩阵 $\\mathbf{J}$ 为：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L_x}{2}  0 \\\\ 0  \\frac{L_y}{2} \\end{pmatrix}\n$$\n雅可比矩阵是常数，这大大简化了计算。其行列式为 $\\det(\\mathbf{J}) = \\frac{L_x L_y}{4}$。逆雅可比矩阵为：\n$$\n\\mathbf{J}^{-1} = \\begin{pmatrix} \\frac{2}{L_x}  0 \\\\ 0  \\frac{2}{L_y} \\end{pmatrix}\n$$\n\n**2.2. 对应于 $u_1$ 的应变-位移矩阵列向量**\n\n应变向量 $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^{\\mathsf{T}}$ 通过 $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}$ 与节点位移向量 $\\mathbf{d}$ 相关联。矩阵 $\\mathbf{B}$ 由每个节点 $i$ 的块矩阵 $\\mathbf{B}_i$ 组成：$\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]$。节点 $i$ 的块矩阵为：\n$$\n\\mathbf{B}_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\n我们需要 $\\mathbf{B}_1$ 的第一列，它与自由度 $u_1$ 相关。我们将此列向量称为 $\\mathbf{b}_{u_1}$：\n$$\n\\mathbf{b}_{u_1} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix}\n$$\n为了求得关于物理坐标的导数，我们使用链式法则：\n$$\n\\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_1}{\\partial \\xi} \\\\ \\frac{\\partial N_1}{\\partial \\eta} \\end{pmatrix}\n$$\n首先，我们计算 $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$ 的导数：\n$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$ 且 $\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$。\n现在，应用逆雅可比矩阵：\n$$\n\\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{L_x}  0 \\\\ 0  \\frac{2}{L_y} \\end{pmatrix} \\begin{pmatrix} -\\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1-\\xi) \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2L_x}(1-\\eta) \\\\ -\\frac{1}{2L_y}(1-\\xi) \\end{pmatrix}\n$$\n因此，所需的应变-位移矩阵列向量为：\n$$\n\\mathbf{b}_{u_1}(\\xi,\\eta) = \\begin{pmatrix} -\\frac{1}{2L_x}(1-\\eta) \\\\ 0 \\\\ -\\frac{1}{2L_y}(1-\\xi) \\end{pmatrix}\n$$\n\n**2.3. $k_{11}$ 的计算**\n\n刚度系数 $k_{11}$ 由被积矩阵 $\\mathbf{B}^{\\mathsf{T}} \\mathbf{C} \\mathbf{B}$ 的 $(1,1)$ 分量的积分给出。该分量为 $\\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1}$。积分在单元体积上进行：\n$$\nk_{11} = \\int_{\\Omega_e} \\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1} \\, d\\Omega = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{b}_{u_1}^{\\mathsf{T}}(\\xi,\\eta) \\mathbf{C} \\mathbf{b}_{u_1}(\\xi,\\eta) \\, t \\det(\\mathbf{J}) \\, d\\xi d\\eta\n$$\n我们首先计算二次型 $\\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1}$：\n$$\n\\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1} = \\begin{pmatrix} -\\frac{1-\\eta}{2L_x}  0  -\\frac{1-\\xi}{2L_y} \\end{pmatrix} \\frac{E}{1-\\nu^2} \\begin{pmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{pmatrix} \\begin{pmatrix} -\\frac{1-\\eta}{2L_x} \\\\ 0 \\\\ -\\frac{1-\\xi}{2L_y} \\end{pmatrix}\n$$\n$$\n= \\frac{E}{1-\\nu^2} \\left[ \\left(-\\frac{1-\\eta}{2L_x}\\right)^2 \\cdot 1 + \\left(-\\frac{1-\\xi}{2L_y}\\right)^2 \\cdot \\frac{1-\\nu}{2} \\right] = \\frac{E}{1-\\nu^2} \\left[ \\frac{(1-\\eta)^2}{4L_x^2} + \\frac{(1-\\xi)^2(1-\\nu)}{8L_y^2} \\right]\n$$\n现在，令 $I(\\xi, \\eta)$ 为刚度系数的完整被积函数：\n$$\nI(\\xi, \\eta) = \\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1} \\cdot t \\det(\\mathbf{J}) = \\frac{E t}{1-\\nu^2} \\left[ \\frac{(1-\\eta)^2}{4L_x^2} + \\frac{(1-\\xi)^2(1-\\nu)}{8L_y^2} \\right] \\frac{L_x L_y}{4}\n$$\n$$\nI(\\xi, \\eta) = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\left[ \\frac{(1-\\eta)^2}{4L_x^2} + \\frac{(1-\\xi)^2(1-\\nu)}{8L_y^2} \\right]\n$$\n\n**2.4. 通过高斯求积进行计算**\n\n我们使用一个 $2 \\times 2$ 的高斯求积法则。积分点为 $(\\xi_i, \\eta_j) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$，所有权重均为 $w_i w_j = 1$。\n$$\nk_{11} \\approx \\sum_{i=1}^{2} \\sum_{j=1}^{2} w_i w_j I(\\xi_i, \\eta_j) = I(-\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}) + I(\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}) + I(-\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}}) + I(\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}})\n$$\n让我们计算多项式项在高斯点上的和：\n对于任意函数 $f(\\zeta) = (1-c\\zeta)^2$，在高斯点 $\\zeta_k = \\pm 1/\\sqrt{3}$ 上的和为：\n$\\sum_{k=1}^2 f(\\zeta_k) = (1 - c(-1/\\sqrt{3}))^2 + (1 - c(1/\\sqrt{3}))^2 = (1+c/\\sqrt{3})^2 + (1-c/\\sqrt{3})^2 = (1+2c/\\sqrt{3}+c^2/3) + (1-2c/\\sqrt{3}+c^2/3) = 2 + 2c^2/3$。\n对于我们的项，我们有 $c=1$ 时的 $(1-\\eta)^2$ 和 $c=1$ 时的 $(1-\\xi)^2$。\n和 $\\sum_{j=1}^{2} (1-\\eta_j)^2 = 2 + 2/3 = 8/3$。\n和 $\\sum_{i=1}^{2} (1-\\xi_i)^2 = 2 + 2/3 = 8/3$。\n令 $K = \\frac{E t L_x L_y}{4(1-\\nu^2)}$。求积和为：\n$$\nk_{11} = \\sum_{j=1}^{2} \\sum_{i=1}^{2} K \\left[ \\frac{(1-\\eta_j)^2}{4L_x^2} + \\frac{(1-\\xi_i)^2(1-\\nu)}{8L_y^2} \\right]\n$$\n$$\n= K \\left[ \\frac{2}{4L_x^2} \\sum_{j=1}^{2} (1-\\eta_j)^2 + \\frac{2(1-\\nu)}{8L_y^2} \\sum_{i=1}^{2} (1-\\xi_i)^2 \\right] = K \\left[ \\frac{1}{2L_x^2} \\left(\\frac{8}{3}\\right) + \\frac{1-\\nu}{4L_y^2} \\left(\\frac{8}{3}\\right) \\right]\n$$\n$$\n= K \\left[ \\frac{4}{3L_x^2} + \\frac{2(1-\\nu)}{3L_y^2} \\right] = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\left[ \\frac{4}{3L_x^2} + \\frac{2(1-\\nu)}{3L_y^2} \\right]\n$$\n$$\n= \\frac{E t}{12(1-\\nu^2)} \\left[ \\frac{4L_x L_y}{L_x^2} + \\frac{2(1-\\nu)L_x L_y}{L_y^2} \\right] = \\frac{E t}{6(1-\\nu^2)} \\left[ \\frac{2L_y}{L_x} + \\frac{(1-\\nu)L_x}{L_y} \\right]\n$$\n\n**2.5. 通过解析积分进行计算**\n\n我们现在通过解析方式计算该积分：\n$$\nk_{11} = \\int_{-1}^{1}\\int_{-1}^{1} I(\\xi, \\eta) \\, d\\xi d\\eta = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\int_{-1}^{1}\\int_{-1}^{1} \\left[ \\frac{(1-\\eta)^2}{4L_x^2} + \\frac{(1-\\xi)^2(1-\\nu)}{8L_y^2} \\right] d\\xi d\\eta\n$$\n我们分别对每一项进行积分。我们需要积分 $\\int_{-1}^{1} (1-z)^2 dz$：\n$$\n\\int_{-1}^{1} (1-2z+z^2) dz = \\left[ z - z^2 + \\frac{z^3}{3} \\right]_{-1}^{1} = \\left(1-1+\\frac{1}{3}\\right) - \\left(-1-1-\\frac{1}{3}\\right) = \\frac{1}{3} - (-\\frac{7}{3}) = \\frac{8}{3}\n$$\n现在计算二重积分：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} (1-\\eta)^2 d\\xi d\\eta = \\left( \\int_{-1}^{1} d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta)^2 d\\eta \\right) = 2 \\cdot \\frac{8}{3} = \\frac{16}{3}\n$$\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} (1-\\xi)^2 d\\xi d\\eta = \\left( \\int_{-1}^{1} d\\eta \\right) \\left( \\int_{-1}^{1} (1-\\xi)^2 d\\xi \\right) = 2 \\cdot \\frac{8}{3} = \\frac{16}{3}\n$$\n将这些结果代回 $k_{11}$ 的表达式中：\n$$\nk_{11} = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\left[ \\frac{1}{4L_x^2}\\left(\\frac{16}{3}\\right) + \\frac{1-\\nu}{8L_y^2}\\left(\\frac{16}{3}\\right) \\right] = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\left[ \\frac{4}{3L_x^2} + \\frac{2(1-\\nu)}{3L_y^2} \\right]\n$$\n这与通过高斯求积计算得到的表达式相同，化简后为：\n$$\nk_{11} = \\frac{E t}{6(1-\\nu^2)} \\left[ \\frac{2L_y}{L_x} + \\frac{(1-\\nu)L_x}{L_y} \\right]\n$$\n\n**2.6. 求积与解析积分的等价性**\n\n被积函数 $I(\\xi, \\eta)$ 是一个关于 $\\xi$ 和 $\\eta$ 的多项式。具体来说，它是一个关于 $\\eta$ 的二次多项式（次数为 2）和一个关于 $\\xi$ 的二次多项式（次数为 2）的和。一维的 2 点高斯求积法则能精确积分最高次数为 $2n-1 = 2(2)-1 = 3$ 的多项式。因此，一个 $2 \\times 2$ 的高斯乘积法则能精确积分任何形式为 $P(\\xi, \\eta) = \\sum_{i=0}^3 \\sum_{j=0}^3 a_{ij} \\xi^i \\eta^j$ 的多项式。由于我们的被积函数在每个变量上的次数都是 2，它属于能被 $2 \\times 2$ 高斯法则精确积分的多项式类别。这是单元具有常数雅可比矩阵的直接结果，常数雅可比矩阵确保了被积函数是一个多项式，而不是一个更复杂的有理函数。因此，数值积分得到的结果与解析积分的结果完全相同。",
            "answer": "$$\\boxed{\\frac{E t}{6(1-\\nu^2)} \\left( \\frac{2L_y}{L_x} + \\frac{(1-\\nu)L_x}{L_y} \\right)}$$"
        },
        {
            "introduction": "理论上完美的单元在实际工程应用中很少见，单元的几何形状（即网格质量）对分析结果的准确性和稳定性至关重要。这项计算实践  旨在通过一个具体的编程任务，让您亲手探究单元扭曲如何影响刚度矩阵的数值健康状况。您将通过计算不同扭曲程度下单元刚度矩阵的条件数，直观地理解为何保持良好的网格质量是获得可靠有限元分析结果的先决条件。",
            "id": "3728939",
            "problem": "考虑二维标量扩散问题，其由偏微分方程 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 定义，定义域为 $\\Omega \\subset \\mathbb{R}^2$，并在部分边界上施加齐次狄利克雷边界条件。使用标准伽辽金有限元法，采用等参格式的双线性四边形单元（也称为 $Q_4$ 单元）。假设标量扩散系数为常数 $\\kappa = 1$。\n\n你需要分析单个 $Q_4$ 单元的几何畸变如何影响其刚度矩阵的条件数。从扩散问题的能量原理出发，该原理指出，弱形式源于在容许变分下泛函 $E(u) = \\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla u \\, d\\Omega - \\int_{\\Omega} fv \\, d\\Omega$ 的驻点。使用定义在具有自然坐标 $(\\xi,\\eta) \\in [-1, 1] \\times [-1, 1]$ 的参考正方形单元上的双线性形函数，推导出离散形式，并通过等参插值映射到物理单元。单个单元的刚度矩阵由积分 $K_{ij} = \\int_{\\Omega_e} \\kappa \\, \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega$ 给出，其中 $N_i$ 是双线性形函数。使用具有 $2\\times 2$ 个点的张量积高斯求积法对该积分进行数值计算，并利用等参映射的雅可比矩阵，通过链式法则计算梯度。\n\n为避免与形函数的单位分解相关的已知零空间（这会使单元级刚度矩阵奇异），通过消除节点1对应的自由度来施加齐次狄利克雷边界条件。也就是说，通过移除与节点1相关的行和列来构成降阶刚度矩阵。\n\n通过固定三个节点，并将右上角节点水平移动一个扭斜参数 $d$，来定义一系列逐渐扭斜的四边形单元。具体而言，设置节点坐标为：\n- $x_1 = 0$, $y_1 = 0$,\n- $x_2 = 1$, $y_2 = 0$,\n- $x_3 = 1 + d$, $y_3 = 1$,\n- $x_4 = 0$, $y_4 = 1$。\n对于每个给定的 $d$，通过在参考正方形上进行 $2\\times 2$ 高斯求积计算降阶单元刚度矩阵 $K_{\\text{red}}$，然后计算其谱条件数，定义为 $\\kappa_2(K_{\\text{red}}) = \\|K_{\\text{red}}\\|_2 \\cdot \\|K_{\\text{red}}^{-1}\\|_2$。如果在任何求积点上映射无效（即，雅可比行列式 $\\det J$ 为非正值或小于表示接近退化的小容差），则将刚度矩阵视为奇异矩阵，并返回条件数为 $\\infty$。\n\n您的程序必须为每个测试用例实现以下步骤：\n- 通过在参考单元上使用双线性形函数和到具有指定节点坐标的物理单元的等参映射进行数值求积，构建 $K$。\n- 在节点1处应用齐次狄利克雷边界条件，通过移除相应的行和列以获得 $K_{\\text{red}}$。\n- 计算谱条件数 $\\kappa_2(K_{\\text{red}})$；如果基于雅可比行列式检查，矩阵是奇异的或映射是无效的，则该案例输出 $\\infty$。\n\n使用以下扭斜参数测试套件：\n- $d = 0.0$ (基准正方形单元),\n- $d = 0.3$ (中度扭斜),\n- $d = 0.6$ (高度扭斜),\n- $d = 0.9$ (非常高的扭斜),\n- $d = -0.8$ (接近退化但仍为凸的负向扭斜)。\n\n在此设置中，所有计算都是严格无量纲的。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是对应 $d$ 值的条件数，四舍五入到六位小数。如果某个案例根据雅可比行列式准则被判定为奇异或无效，请打印编程语言为浮点值生成的字面量“无穷大”来代替数字（例如 $[\\infty, \\dots]$）。",
            "solution": "用户提供的问题要求分析二维标量扩散问题的几何畸变对有限元刚度矩阵条件数的影响。该问题是适定的、科学上合理的，并为唯一解提供了所有必要的数据。我们将进行完整的推导和实现。\n\n该分析基于扩散方程 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 的弱形式，使用等参双线性四边形（$Q_4$）单元的伽辽金有限元法进行离散。\n\n### 1. 弱形式与伽辽金离散化\n\n控制偏微分方程是能量泛函的驻点：\n$$\nE(u) = \\frac{1}{2} \\int_{\\Omega} \\kappa (\\nabla u \\cdot \\nabla u) \\, d\\Omega - \\int_{\\Omega} f u \\, d\\Omega\n$$\n弱形式通过对 $E(u)$ 关于检验函数 $v$ 取一阶变分并令其为零得到：\n$$\n\\delta E = \\int_{\\Omega} \\kappa (\\nabla u \\cdot \\nabla v) \\, d\\Omega - \\int_{\\Omega} f v \\, d\\Omega = 0\n$$\n在伽辽金方法中，我们通过基函数 $N_i(x,y)$ 的线性组合来逼近域上的解 $u(x,y)$：\n$$\nu(x,y) \\approx u_h(x,y) = \\sum_{j=1}^{n} u_j N_j(x,y)\n$$\n其中 $u_j$ 是未知系数（节点值），$n$ 是单元中的节点数。检验函数 $v$ 选自与基函数相同的空间，即 $v = N_i(x,y)$。将此代入单个单元域 $\\Omega_e$ 的弱形式，得到单元级方程组：\n$$\n\\sum_{j=1}^{n} \\left( \\int_{\\Omega_e} \\kappa \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega \\right) u_j = \\int_{\\Omega_e} f N_i \\, d\\Omega\n$$\n其形式为 $K^e \\mathbf{u} = \\mathbf{f}^e$，其中单元刚度矩阵 $K^e$ 的各项为：\n$$\nK_{ij}^e = \\int_{\\Omega_e} \\kappa \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega\n$$\n对于此问题，扩散系数 $\\kappa$ 是设置为1的常数。\n\n### 2. 等参双线性单元\n\n我们使用一个 $Q_4$ 单元，它是一个有四个节点的四边形。该格式是等参的，意味着使用相同的基函数来插值几何形状和解场。\n\n**参考单元：**\n计算在自然坐标系 $(\\xi, \\eta)$ 中定义的参考正方形单元上进行，其中 $\\xi, \\eta \\in [-1, 1]$。四个节点位于 $(\\pm 1, \\pm 1)$。双线性形函数为：\n\\begin{align*}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{align*}\n\n**坐标映射：**\n单元内任意点的物理坐标 $(x,y)$ 通过节点坐标 $(x_i, y_i)$ 从自然坐标 $(\\xi, \\eta)$ 映射而来：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} x_i N_i(\\xi, \\eta) \\quad \\text{和} \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} y_i N_i(\\xi, \\eta)\n$$\n\n**梯度变换：**\n为了计算刚度矩阵，我们需要形函数关于物理坐标 $(x,y)$ 的梯度。这些梯度通过使用链式法则从关于自然坐标 $(\\xi, \\eta)$ 的梯度中获得：\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = J \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix}\n$$\n其中 $J$ 是变换的雅可比矩阵。反转此关系可得到物理梯度：\n$$\n\\nabla_{x,y} N_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} = J^{-1} \\nabla_{\\xi, \\eta} N_i\n$$\n\n### 3. 刚度矩阵计算与数值求积\n\n刚度矩阵的积分必须转换到参考坐标系。微分面积元变换为 $d\\Omega = dx\\,dy = \\det(J) \\, d\\xi\\, d\\eta$。刚度矩阵的项变为：\n$$\nK_{ij}^e = \\int_{-1}^{1} \\int_{-1}^{1} \\kappa \\left( \\nabla_{x,y} N_i \\cdot \\nabla_{x,y} N_j \\right) \\det(J) \\, d\\xi \\, d\\eta\n$$\n点积可以写成 $(\\nabla_{x,y} N_i)^T (\\nabla_{x,y} N_j)$。对于畸变的单元，该积分通常过于复杂，难以解析计算，因此使用数值求积进行近似。问题指定了 $2 \\times 2$ 的张量积高斯求积方案。该积分近似为在特定高斯点 $(\\xi_k, \\eta_k)$ 处被积函数的加权和：\n$$\nK_{ij}^e \\approx \\sum_{k=1}^{4} w_k \\kappa \\left[ (\\nabla_{x,y} N_i)^T (\\nabla_{x,y} N_j) \\det(J) \\right]_{(\\xi_k, \\eta_k)}\n$$\n对于 $2 \\times 2$ 方案，四个高斯点是 $(\\pm a, \\pm a)$，其中 $a=1/\\sqrt{3}$，所有权重 $w_k$ 都等于 $1$。\n\n映射的几何有效性取决于雅可比行列式 $\\det(J)$ 的符号。如果单元内任何一点的 $\\det(J) \\le 0$，则映射是退化的或方向反转的，导致单元无效。我们在每个高斯点检查此条件。\n\n### 4. 边界条件、矩阵降阶和条件数\n\n对于扩散问题，单元刚度矩阵 $K^e$ 总是奇异的，因为它有一个对应于常数势的零空间（即，如果 $\\mathbf{c}$ 是全一向量，则 $K^e \\mathbf{c} = 0$）。为了获得一个可解的系统，必须施加边界条件。问题规定在节点1处施加齐次狄利克雷条件 ($u_1 = 0$)。这是通过消除 $4 \\times 4$ 矩阵 $K^e$ 的第一行和第一列来形成一个 $3 \\times 3$ 的降阶刚度矩阵 $K_{\\text{red}}$ 来实现的。\n\n对于一个非退化的单元， $K_{\\text{red}}$ 是对称正定的，因此是可逆的。该矩阵的条件数是其对扰动敏感性的度量。我们使用谱条件数 $\\kappa_2(A)$，定义为：\n$$\n\\kappa_2(K_{\\text{red}}) = \\|K_{\\text{red}}\\|_2 \\cdot \\|K_{\\text{red}}^{-1}\\|_2 = \\frac{\\sigma_{\\max}(K_{\\text{red}})}{\\sigma_{\\min}(K_{\\text{red}})}\n$$\n其中 $\\sigma$ 表示矩阵的奇异值。对于对称正定矩阵，这是最大特征值与最小特征值的比率。高条件数表明单元形状不良，这可能在完整的有限元模拟中导致较大的数值误差。\n\n对于每个扭斜参数 $d$ 的算法如下：\n1.  根据 $d$ 定义物理节点坐标。\n2.  初始化一个 $4 \\times 4$ 的单元刚度矩阵 $K^e$ 为零矩阵。\n3.  遍历四个 $2 \\times 2$ 高斯点 $(\\xi_k, \\eta_k)$：\n    a.  在当前高斯点计算形函数的导数 $\\nabla_{\\xi, \\eta} N_i$。\n    b.  计算雅可比矩阵 $J$ 及其行列式 $\\det(J)$。\n    c.  如果 $\\det(J)$ 为非正值（或低于一个小的容差），将单元标记为无效并终止对此 $d$ 的计算。\n    d.  计算物理梯度 $\\nabla_{x,y} N_i = J^{-1} \\nabla_{\\xi, \\eta} N_i$。\n    e.  计算该点对刚度矩阵的贡献并将其加到 $K^e$ 中。\n4.  如果单元有效，通过从 $K^e$ 中移除第一行和第一列来形成 $3 \\times 3$ 的降阶矩阵 $K_{\\text{red}}$。\n5.  计算并存储谱条件数 $\\kappa_2(K_{\\text{red}})$。如果单元被标记为无效，则存储 $\\infty$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_condition_number(d: float) -> float:\n    \"\"\"\n    Computes the spectral condition number of the reduced stiffness matrix\n    for a single bilinear quadrilateral element with a given skew parameter d.\n\n    Args:\n        d: The horizontal skew parameter for the top-right node.\n\n    Returns:\n        The spectral condition number, or numpy.inf if the element mapping is invalid.\n    \"\"\"\n    # 1. Define nodal coordinates for the physical element\n    nodes = np.array([\n        [0.0, 0.0],          # Node 1\n        [1.0, 0.0],          # Node 2\n        [1.0 + d, 1.0],      # Node 3\n        [0.0, 1.0]           # Node 4\n    ])\n\n    # 2. Define 2x2 Gaussian quadrature points and weights\n    a = 1.0 / np.sqrt(3.0)\n    gauss_points = [(-a, -a), (a, -a), (a, a), (-a, a)]\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    # 3. Initialize the 4x4 element stiffness matrix\n    K_e = np.zeros((4, 4))\n    kappa = 1.0  # Constant scalar conductivity\n\n    # 4. Loop over Gauss points to assemble the stiffness matrix\n    for i in range(len(gauss_points)):\n        xi, eta = gauss_points[i]\n        weight = gauss_weights[i]\n\n        # Derivatives of bilinear shape functions w.r.t. natural coordinates (xi, eta)\n        # dN/dxi at the current Gauss point\n        dN_dxi = 0.25 * np.array([-(1.0 - eta), (1.0 - eta), (1.0 + eta), -(1.0 + eta)])\n        # dN/deta at the current Gauss point\n        dN_deta = 0.25 * np.array([-(1.0 - xi), -(1.0 + xi), (1.0 + xi), (1.0 - xi)])\n\n        # Matrix of shape function gradients in reference coordinates (4x2)\n        grad_N_ref = np.vstack((dN_dxi, dN_deta)).T\n\n        # Jacobian matrix of the isoparametric mapping\n        # J = grad_N_ref^T * nodes  ( (2x4) @ (4x2) -> (2x2) )\n        J = grad_N_ref.T @ nodes\n\n        # Determinant of the Jacobian\n        detJ = np.linalg.det(J)\n\n        # Check for invalid mapping (non-positive or near-zero determinant)\n        if detJ <= 1e-12:\n            return np.inf\n\n        # Inverse of the Jacobian\n        invJ = np.linalg.inv(J)\n\n        # Gradients of shape functions in physical coordinates (x, y)\n        # grad_N_phys = grad_N_ref * J^-1  ( (4x2) @ (2x2) -> (4x2) )\n        grad_N_phys = grad_N_ref @ invJ\n\n        # Add contribution to the stiffness matrix\n        # The term (grad_N_phys @ grad_N_phys.T) is a 4x4 matrix\n        # where the (i, j) entry is (nabla N_i) . (nabla N_j)\n        K_e += kappa * (grad_N_phys @ grad_N_phys.T) * detJ * weight\n    \n    # 5. Apply homogeneous Dirichlet BC at node 1 by creating the reduced matrix\n    K_red = K_e[1:, 1:]\n\n    # 6. Compute and return the spectral condition number (p=2) of the reduced matrix\n    cond_num = np.linalg.cond(K_red, p=2)\n\n    return cond_num\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for the specified test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0,   # Baseline square element\n        0.3,   # Moderate skew\n        0.6,   # High skew\n        0.9,   # Very high skew\n        -0.8   # Negative skew near degeneracy\n    ]\n\n    results = []\n    for d in test_cases:\n        result = compute_condition_number(d)\n        results.append(result)\n\n    # Format the results for printing\n    results_str = []\n    for r in results:\n        if r == np.inf:\n            results_str.append(\"inf\")\n        else:\n            # Round to six decimal places\n            results_str.append(f\"{r:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}