{
    "hands_on_practices": [
        {
            "introduction": "The Finite Volume Method is built upon the integral form of conservation laws, where the Gauss-Divergence theorem plays a pivotal role. This theorem provides the crucial link between physical processes within a control volume, such as sources or sinks, and the transport of quantities across its boundaries. This first practice  allows you to perform a hands-on verification of this equivalence, reinforcing the mathematical foundation of FVM by directly calculating and comparing the volume integral of a divergence to the net flux across the surface of a simple cubic cell.",
            "id": "3763219",
            "problem": "Consider a single hexahedral control volume used in the Finite Volume Method (FVM) for Computational Fluid Dynamics (CFD), embedded in a Cartesian mesh for multiscale modeling. The control volume is a cube centered at the origin with side length $2h$, bounded by the planes $x=\\pm h$, $y=\\pm h$, and $z=\\pm h$. Let the vector field be $\\boldsymbol{a}(\\boldsymbol{x})=(x,y,z)$, representing a linear field defined over the entire domain. Assume nondimensional variables so that no unit conversion is required.\n\nStarting from the integral conservation statement and Gauss’s theorem (also known as the divergence theorem), compute the net outflow across the control volume boundary, $\\displaystyle \\int_{\\partial V} \\boldsymbol{a}\\cdot \\boldsymbol{n}\\,dS$, by explicitly evaluating the surface integrals over all faces of the cube using the outward unit normals. Separately, compute the volume integral of the divergence, $\\displaystyle \\int_{V} \\nabla\\cdot\\boldsymbol{a}\\,dV$, by first evaluating $\\nabla\\cdot\\boldsymbol{a}$ from first principles and then integrating over the volume. Verify that the two results agree, consistent with the foundations of the FVM.\n\nProvide the common value of these two integrals as a single closed-form expression in terms of $h$. Express your final answer without units and do not round.",
            "solution": "The problem statement is a valid exercise in vector calculus, specifically demonstrating the divergence theorem for a given vector field and control volume. All given information is self-contained, consistent, and scientifically grounded. The task is well-posed and objective. We will proceed with the two required calculations.\n\nThe problem asks to verify the divergence theorem, which states that for a vector field $\\boldsymbol{a}$ and a volume $V$ enclosed by a surface $\\partial V$, the following equality holds:\n$$ \\int_{\\partial V} \\boldsymbol{a}\\cdot \\boldsymbol{n}\\,dS = \\int_{V} (\\nabla\\cdot\\boldsymbol{a})\\,dV $$\nHere, $\\boldsymbol{n}$ is the outward-pointing unit normal vector to the surface element $dS$.\n\nThe control volume $V$ is a cube centered at the origin, defined by $-h \\le x \\le h$, $-h \\le y \\le h$, and $-h \\le z \\le h$. Its total volume is $(2h)^3 = 8h^3$. The vector field is given by $\\boldsymbol{a}(\\boldsymbol{x}) = (x, y, z)$.\n\n**Part 1: Computation of the Surface Integral (Net Outflow)**\n\nThe surface integral $\\int_{\\partial V} \\boldsymbol{a}\\cdot \\boldsymbol{n}\\,dS$ must be computed over the six faces of the cube. We evaluate the integral on each face and sum the results.\n\n1.  **Right Face:** The face is defined by $x=h$, $-h \\le y \\le h$, $-h \\le z \\le h$. The outward unit normal is $\\boldsymbol{n} = (1, 0, 0)$.\n    The dot product is $\\boldsymbol{a} \\cdot \\boldsymbol{n} = (x, y, z) \\cdot (1, 0, 0) = x$. On this face, $x=h$, so $\\boldsymbol{a} \\cdot \\boldsymbol{n} = h$.\n    The surface integral over this face is:\n    $$ \\int_{\\text{right}} \\boldsymbol{a} \\cdot \\boldsymbol{n} \\,dS = \\int_{-h}^{h} \\int_{-h}^{h} h \\,dy\\,dz = h \\left(\\int_{-h}^{h} dy\\right) \\left(\\int_{-h}^{h} dz\\right) = h(2h)(2h) = 4h^3 $$\n\n2.  **Left Face:** The face is defined by $x=-h$, $-h \\le y \\le h$, $-h \\le z \\le h$. The outward unit normal is $\\boldsymbol{n} = (-1, 0, 0)$.\n    The dot product is $\\boldsymbol{a} \\cdot \\boldsymbol{n} = (x, y, z) \\cdot (-1, 0, 0) = -x$. On this face, $x=-h$, so $\\boldsymbol{a} \\cdot \\boldsymbol{n} = -(-h) = h$.\n    The surface integral over this face is:\n    $$ \\int_{\\text{left}} \\boldsymbol{a} \\cdot \\boldsymbol{n} \\,dS = \\int_{-h}^{h} \\int_{-h}^{h} h \\,dy\\,dz = h(2h)(2h) = 4h^3 $$\n\n3.  **Top Face:** The face is defined by $y=h$, $-h \\le x \\le h$, $-h \\le z \\le h$. The outward unit normal is $\\boldsymbol{n} = (0, 1, 0)$.\n    The dot product is $\\boldsymbol{a} \\cdot \\boldsymbol{n} = (x, y, z) \\cdot (0, 1, 0) = y$. On this face, $y=h$, so $\\boldsymbol{a} \\cdot \\boldsymbol{n} = h$.\n    The surface integral over this face is:\n    $$ \\int_{\\text{top}} \\boldsymbol{a} \\cdot \\boldsymbol{n} \\,dS = \\int_{-h}^{h} \\int_{-h}^{h} h \\,dx\\,dz = h(2h)(2h) = 4h^3 $$\n\n4.  **Bottom Face:** The face is defined by $y=-h$, $-h \\le x \\le h$, $-h \\le z \\le h$. The outward unit normal is $\\boldsymbol{n} = (0, -1, 0)$.\n    The dot product is $\\boldsymbol{a} \\cdot \\boldsymbol{n} = (x, y, z) \\cdot (0, -1, 0) = -y$. On this face, $y=-h$, so $\\boldsymbol{a} \\cdot \\boldsymbol{n} = -(-h) = h$.\n    The surface integral over this face is:\n    $$ \\int_{\\text{bottom}} \\boldsymbol{a} \\cdot \\boldsymbol{n} \\,dS = \\int_{-h}^{h} \\int_{-h}^{h} h \\,dx\\,dz = h(2h)(2h) = 4h^3 $$\n\n5.  **Front Face:** The face is defined by $z=h$, $-h \\le x \\le h$, $-h \\le y \\le h$. The outward unit normal is $\\boldsymbol{n} = (0, 0, 1)$.\n    The dot product is $\\boldsymbol{a} \\cdot \\boldsymbol{n} = (x, y, z) \\cdot (0, 0, 1) = z$. On this face, $z=h$, so $\\boldsymbol{a} \\cdot \\boldsymbol{n} = h$.\n    The surface integral over this face is:\n    $$ \\int_{\\text{front}} \\boldsymbol{a} \\cdot \\boldsymbol{n} \\,dS = \\int_{-h}^{h} \\int_{-h}^{h} h \\,dx\\,dy = h(2h)(2h) = 4h^3 $$\n\n6.  **Back Face:** The face is defined by $z=-h$, $-h \\le x \\le h$, $-h \\le y \\le h$. The outward unit normal is $\\boldsymbol{n} = (0, 0, -1)$.\n    The dot product is $\\boldsymbol{a} \\cdot \\boldsymbol{n} = (x, y, z) \\cdot (0, 0, -1) = -z$. On this face, $z=-h$, so $\\boldsymbol{a} \\cdot \\boldsymbol{n} = -(-h) = h$.\n    The surface integral over this face is:\n    $$ \\int_{\\text{back}} \\boldsymbol{a} \\cdot \\boldsymbol{n} \\,dS = \\int_{-h}^{h} \\int_{-h}^{h} h \\,dx\\,dy = h(2h)(2h) = 4h^3 $$\n\nThe total net outflow is the sum of the integrals over all six faces:\n$$ \\int_{\\partial V} \\boldsymbol{a}\\cdot \\boldsymbol{n}\\,dS = 4h^3 + 4h^3 + 4h^3 + 4h^3 + 4h^3 + 4h^3 = 6 \\times (4h^3) = 24h^3 $$\n\n**Part 2: Computation of the Volume Integral**\n\nFirst, we compute the divergence of the vector field $\\boldsymbol{a} = (x, y, z)$.\n$$ \\nabla \\cdot \\boldsymbol{a} = \\frac{\\partial}{\\partial x}(x) + \\frac{\\partial}{\\partial y}(y) + \\frac{\\partial}{\\partial z}(z) = 1 + 1 + 1 = 3 $$\nThe divergence is a constant value of $3$.\n\nNext, we integrate this divergence over the volume $V$ of the cube. The limits of integration are from $-h$ to $h$ for each coordinate.\n$$ \\int_V (\\nabla \\cdot \\boldsymbol{a}) \\,dV = \\int_{-h}^{h} \\int_{-h}^{h} \\int_{-h}^{h} 3 \\,dx\\,dy\\,dz $$\nSince the integrand is constant, we can factor it out of the integral:\n$$ 3 \\int_{-h}^{h} \\int_{-h}^{h} \\int_{-h}^{h} \\,dx\\,dy\\,dz = 3 \\times (\\text{Volume of } V) $$\nThe volume of the cube with side length $2h$ is $(2h)^3 = 8h^3$.\nTherefore, the volume integral is:\n$$ \\int_V (\\nabla \\cdot \\boldsymbol{a}) \\,dV = 3 \\times (8h^3) = 24h^3 $$\n\n**Verification**\n\nThe surface integral yielded a result of $24h^3$, and the volume integral also yielded a result of $24h^3$. The two results are identical, which verifies the divergence theorem for this specific case. This consistency is a cornerstone of the Finite Volume Method, which transforms a volume integral of a divergence (representing a source or sink term) into a sum of fluxes across the bounding surfaces of a control volume.\n\nThe common value of the two integrals is $24h^3$.",
            "answer": "$$\\boxed{24h^{3}}$$"
        },
        {
            "introduction": "Correctly implementing boundary conditions is a critical task in any CFD simulation. For cell-centered finite volume schemes, this often requires creative techniques to enforce conditions at faces, where values are not explicitly stored. This exercise  introduces the powerful 'ghost cell' method for handling Neumann boundary conditions, where a derivative is prescribed. You will derive the value in this fictitious external cell that correctly imposes the desired physical gradient, a fundamental skill for practical FVM code development.",
            "id": "3763221",
            "problem": "Consider a scalar field $u$ governed by a diffusion-dominated transport process in the Finite Volume Method (FVM) for computational fluid dynamics (CFD), where $u$ is stored at cell centers. At a planar boundary face $\\Gamma$, the outward unit normal is $\\mathbf{n}$, and the Neumann boundary condition prescribes the normal derivative $\\partial_{\\mathbf{n}} u = g$ at $\\Gamma$. To close the discrete system at the boundary, a ghost control volume $G$ is introduced outside the domain along $\\mathbf{n}$, and the interior boundary-adjacent control volume $P$ lies inside the domain. Let the distance from the center of $P$ to the boundary face along $\\mathbf{n}$ be $d_P$, and the distance from the boundary face to the center of the ghost control volume $G$ along $\\mathbf{n}$ be $d_G$. Assume the scalar field varies linearly along the local normal line passing through $P$, $\\Gamma$, and $G$.\n\nStarting from the fundamental definition of the normal derivative and using a second-order central difference approximation along $\\mathbf{n}$ across the midpoint between $P$ and $G$, derive the ghost cell value $u_G$ required to enforce $\\partial_{\\mathbf{n}} u = g$ at the boundary face under the linear extrapolation assumption for cell-centered unknowns. Then compute $u_G$ for the following data:\n- Interior cell-centered value $u_P = 1.35$ (dimensionless).\n- Outward normal distance $d_P = 7.5 \\times 10^{-3}$ m.\n- Outward normal distance $d_G = 1.0 \\times 10^{-2}$ m.\n- Prescribed normal derivative at the boundary $g = -25$ m$^{-1}$.\n\nExpress the final ghost-cell value of $u$ as a dimensionless number. Round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the value of a scalar field $u$ in a ghost control volume, denoted $u_G$, which is necessary to enforce a Neumann boundary condition in a cell-centered Finite Volume Method (FVM) scheme. Following the derivation, a numerical value for $u_G$ must be calculated based on the provided data.\n\nFirst, we must validate the problem statement.\n\n**Step 1: Extract Givens**\n- Scalar field: $u$\n- Boundary condition at face $\\Gamma$: $\\partial_{\\mathbf{n}} u = g$, where $\\mathbf{n}$ is the outward unit normal.\n- Interior cell-centered value: $u_P$\n- Ghost cell-centered value: $u_G$\n- Distance from interior cell center $P$ to boundary face $\\Gamma$ along $\\mathbf{n}$: $d_P$\n- Distance from boundary face $\\Gamma$ to ghost cell center $G$ along $\\mathbf{n}$: $d_G$\n- Assumption: The scalar field $u$ varies linearly along the local normal line passing through the centers of $P$ and $G$.\n- Numerical Data:\n    - $u_P = 1.35$ (dimensionless)\n    - $d_P = 7.5 \\times 10^{-3}$ m\n    - $d_G = 1.0 \\times 10^{-2}$ m\n    - $g = -25$ m$^{-1}$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a standard and well-established technique for implementing Neumann boundary conditions in cell-centered FVM for CFD. The use of ghost cells and linear extrapolation from the interior to the ghost cell is a common and valid numerical method. The problem is well-posed, providing all necessary assumptions and data for a unique solution. The given data are dimensionally consistent. The term $g(d_P + d_G)$ has units of $[L^{-1}][L] = [1]$, which is dimensionless, matching the dimensionless nature of $u_P$ and the required $u_G$. The problem is objective and free of any unsound or ambiguous premises.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be provided.\n\n**Derivation of the Ghost Cell Value $u_G$**\n\nLet us define a local coordinate system along the outward normal direction $\\mathbf{n}$, with the origin $x=0$ located at the boundary face $\\Gamma$. In this coordinate system, the center of the interior control volume $P$ is located at $x_P = -d_P$, and the center of the ghost control volume $G$ is at $x_G = d_G$. The value of the scalar at these cell centers are $u(x_P) = u_P$ and $u(x_G) = u_G$.\n\nThe problem states that the scalar field $u$ is assumed to vary linearly along this normal line. A linear function can be written as:\n$$u(x) = ax + b$$\nwhere $a$ is the slope and $b$ is the value of $u$ at the origin, i.e., at the boundary face $\\Gamma$. So, $b = u_{\\Gamma}$.\n\nThe derivative of $u$ with respect to $x$ is constant for a linear profile:\n$$\\frac{du}{dx} = a$$\nThe problem specifies a Neumann boundary condition at the face $\\Gamma$ ($x=0$), which prescribes the normal derivative:\n$$\\left. \\frac{\\partial u}{\\partial n} \\right|_{\\Gamma} = \\left. \\frac{du}{dx} \\right|_{x=0} = g$$\nTherefore, the slope of our linear profile is $a = g$. The linear profile is now given by:\n$$u(x) = gx + u_{\\Gamma}$$\n\nTo find the unknown boundary face value $u_{\\Gamma}$, we use the known value $u_P$ at the location $x_P = -d_P$:\n$$u_P = u(x_P) = u(-d_P) = g(-d_P) + u_{\\Gamma} = -gd_P + u_{\\Gamma}$$\nRearranging this equation to solve for $u_{\\Gamma}$ gives:\n$$u_{\\Gamma} = u_P + gd_P$$\nThis expression provides an approximation for the value of the scalar field at the boundary face.\n\nNow, we use the same linear profile to determine the value at the ghost cell center, $u_G$, located at $x_G = d_G$:\n$$u_G = u(x_G) = u(d_G) = gd_G + u_{\\Gamma}$$\nSubstituting the expression for $u_{\\Gamma}$ into this equation yields:\n$$u_G = gd_G + (u_P + gd_P)$$\n$$u_G = u_P + g(d_P + d_G)$$\nThis is the general formula for the ghost cell value $u_G$ under the assumption of a linear profile, used to enforce the Neumann condition $\\partial_n u = g$. This result is equivalent to using a second-order central difference approximation for the derivative, $\\frac{u_G - u_P}{d_G - (-d_P)} = \\frac{u_G - u_P}{d_P + d_G}$, and setting it equal to the constant derivative $g$.\n\n**Numerical Calculation**\n\nWe are given the following values:\n- $u_P = 1.35$\n- $d_P = 7.5 \\times 10^{-3}$ m\n- $d_G = 1.0 \\times 10^{-2}$ m\n- $g = -25$ m$^{-1}$\n\nFirst, calculate the total distance between the cell centers $P$ and $G$:\n$$d_P + d_G = (7.5 \\times 10^{-3}) \\, \\text{m} + (1.0 \\times 10^{-2}) \\, \\text{m} = 0.0075 \\, \\text{m} + 0.01 \\, \\text{m} = 0.0175 \\, \\text{m}$$\n\nNext, substitute the values into the derived formula for $u_G$:\n$$u_G = u_P + g(d_P + d_G)$$\n$$u_G = 1.35 + (-25 \\, \\text{m}^{-1}) \\times (0.0175 \\, \\text{m})$$\nThe product $g(d_P + d_G)$ is:\n$$(-25) \\times 0.0175 = -0.4375$$\nThis term is dimensionless, as expected.\n\nNow, compute the final value for $u_G$:\n$$u_G = 1.35 + (-0.4375) = 1.35 - 0.4375 = 0.9125$$\n\nThe problem requires the answer to be rounded to four significant figures. The calculated value $0.9125$ already has exactly four significant figures, so no further rounding is necessary.",
            "answer": "$$\\boxed{0.9125}$$"
        },
        {
            "introduction": "A numerical scheme rarely behaves exactly like the differential equation it approximates. The process of discretization introduces truncation errors that can fundamentally alter the solution's character. In this practice , you will use modified equation analysis—a cornerstone technique in numerical analysis—to probe the true behavior of the first-order upwind scheme. Your derivation will reveal the scheme's leading error term, which manifests as an artificial viscosity, providing a deep insight into why this simple scheme is both stable and numerically diffusive.",
            "id": "3763257",
            "problem": "Consider the linear advection equation for a sufficiently smooth scalar field $u(x,t)$ with constant transport speed $a \\in \\mathbb{R}$,\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\nposed on a uniform one-dimensional grid with cell centers at $x_{i}$ and cell width $\\Delta x$. Using the finite volume method (FVM) for computational fluid dynamics (CFD), define the cell average $u_{i}(t)$ over cell $i$ and discretize the fluxes with the first-order upwind (Godunov) numerical flux. This yields the semi-discrete scheme\n$$\n\\frac{d u_{i}}{d t} = -\\frac{1}{\\Delta x}\\Big(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\Big),\n$$\nwhere $F_{i+\\frac{1}{2}}$ is the upwind numerical flux across the interface at $x_{i+\\frac{1}{2}}$.\n\nStarting only from conservation, the definition of cell averages, and Taylor expansions about $x_{i}$ for smooth $u$, derive the modified equation up to terms of order $\\mathcal{O}(\\Delta x^{2})$ that the semi-discrete first-order upwind scheme approximates. The modified equation should have the structure\n$$\nu_{t} + a\\,u_{x} = \\nu_{\\text{num}}\\,u_{xx} + \\mathcal{O}(\\Delta x^{2}),\n$$\nwhere $\\nu_{\\text{num}}$ is the artificial viscosity coefficient induced by the spatial discretization. Provide your final answer as the closed-form symbolic expression for $\\nu_{\\text{num}}$ in terms of $a$ and $\\Delta x$. Express your answer symbolically; no rounding is required and no units are to be reported.",
            "solution": "The problem requires the derivation of the modified equation for the first-order upwind finite volume method (FVM) applied to the linear advection equation, $u_t + a u_x = 0$. The goal is to determine the coefficient of the leading-order error term, which manifests as an artificial viscosity, $\\nu_{\\text{num}}$. The derivation will proceed by expressing the FVM semi-discrete scheme in terms of continuous derivatives using Taylor series expansions.\n\nFirst, let us formalize the components of the problem. The FVM is based on the integral form of the conservation law. Integrating the PDE $u_t + (au)_x = 0$ over a control volume (cell) $i$, which spans from $x_{i-1/2}$ to $x_{i+1/2}$, we have:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} u_t \\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} (au)_x \\,dx = 0\n$$\nSince the grid is stationary, the time derivative can be moved outside the integral. Using the fundamental theorem of calculus on the second term, we obtain:\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} u \\,dx + \\Big[ au \\Big]_{x_{i-1/2}}^{x_{i+1/2}} = 0\n$$\nThe cell average, $u_i(t)$, is defined as $u_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\,dx$, where $\\Delta x = x_{i+1/2} - x_{i-1/2}$ is the constant cell width. Let $f(u) = au$ be the physical flux. The equation becomes:\n$$\n\\frac{d}{dt} (\\Delta x \\, u_i) + f(u(x_{i+1/2},t)) - f(u(x_{i-1/2},t)) = 0\n$$\nDividing by $\\Delta x$ and replacing the exact fluxes at the interfaces with a numerical flux function $F$, we arrive at the semi-discrete FVM scheme:\n$$\n\\frac{du_i}{dt} = -\\frac{1}{\\Delta x} \\Big( F_{i+1/2} - F_{i-1/2} \\Big)\n$$\nFor the first-order upwind (or Godunov) scheme, the numerical flux $F_{i+1/2} = F(u_L, u_R)$ depends on the sign of the advection speed $a$. The state at the interface is taken from the upwind cell.\nIf $a > 0$, information flows from left to right, so we use the state from cell $i$. The flux is $F_{i+1/2} = f(u_i) = a u_i$.\nIf $a < 0$, information flows from right to left, so we use the state from cell $i+1$. The flux is $F_{i+1/2} = f(u_{i+1}) = a u_{i+1}$.\nThis can be written compactly as:\n$$\nF_{i+1/2} = \\frac{a}{2}(u_i + u_{i+1}) - \\frac{|a|}{2}(u_{i+1} - u_i)\n$$\nTo find the modified equation, we relate the discrete cell averages $u_i$ to the continuous function $u(x,t)$ and its derivatives at the cell center $x_i$. We expand $u(x,t)$ in a Taylor series around $x=x_i$:\n$$\nu(x,t) = u(x_i,t) + (x-x_i) u_x(x_i,t) + \\frac{(x-x_i)^2}{2} u_{xx}(x_i,t) + \\mathcal{O}(\\Delta x^3)\n$$\nWe integrate this expansion over cell $i$ to find the relationship between the cell average $u_i$ and the point value $u(x_i,t)$. Let $u(x_i,t)$ and its derivatives at $x_i$ be denoted by $u, u_x, u_{xx}$, etc. for brevity. Let $\\xi = x-x_i$.\n$$\nu_i = \\frac{1}{\\Delta x} \\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} u(x,t) \\,dx = \\frac{1}{\\Delta x} \\int_{-\\Delta x/2}^{\\Delta x/2} \\left( u + \\xi u_x + \\frac{\\xi^2}{2} u_{xx} + \\frac{\\xi^3}{6} u_{xxx} + \\dots \\right) d\\xi\n$$\n$$\nu_i = \\frac{1}{\\Delta x} \\left[ u\\xi + \\frac{\\xi^2}{2} u_x + \\frac{\\xi^3}{6} u_{xx} + \\dots \\right]_{-\\Delta x/2}^{\\Delta x/2} = \\frac{1}{\\Delta x} \\left( u\\Delta x + 0 + \\frac{u_{xx}}{6}\\frac{2\\Delta x^3}{8} + 0 + \\dots \\right)\n$$\n$$\nu_i = u + \\frac{\\Delta x^2}{24} u_{xx} + \\mathcal{O}(\\Delta x^4)\n$$\nThe left-hand side (LHS) of the semi-discrete scheme is the time derivative of this expression:\n$$\n\\frac{du_i}{dt} = \\frac{d}{dt} \\left( u + \\frac{\\Delta x^2}{24} u_{xx} + \\mathcal{O}(\\Delta x^4) \\right) = u_t + \\frac{\\Delta x^2}{24} u_{xxt} + \\mathcal{O}(\\Delta x^4)\n$$\nNow we analyze the right-hand side (RHS), considering the two cases for the sign of $a$.\n\nCase 1: $a > 0$.\nThe scheme is $\\frac{du_i}{dt} = -\\frac{a}{\\Delta x}(u_i - u_{i-1})$.\nWe need to express $u_{i-1}$, the average over cell $[x_{i-1/2}, x_{i-3/2}] = [x_i - \\Delta x/2, x_i - 3\\Delta x/2]$, in terms of derivatives at $x_i$.\n$$\nu_{i-1} = \\frac{1}{\\Delta x} \\int_{x_i-3\\Delta x/2}^{x_i-\\Delta x/2} u(x,t) \\,dx = \\frac{1}{\\Delta x} \\int_{-3\\Delta x/2}^{-\\Delta x/2} \\left( u + \\xi u_x + \\frac{\\xi^2}{2} u_{xx} + \\dots \\right) d\\xi\n$$\n$$\nu_{i-1} = \\frac{1}{\\Delta x} \\left[ u\\xi + \\frac{\\xi^2}{2} u_x + \\frac{\\xi^3}{6} u_{xx} + \\dots \\right]_{-3\\Delta x/2}^{-\\Delta x/2}\n$$\n$u_{i-1} = \\frac{1}{\\Delta x} \\left( u \\Delta x + \\frac{u_x}{2}\\left(\\frac{\\Delta x^2}{4} - \\frac{9\\Delta x^2}{4}\\right) + \\frac{u_{xx}}{6}\\left(-\\frac{\\Delta x^3}{8} - (-\\frac{27\\Delta x^3}{8})\\right) + \\dots \\right)$\n$u_{i-1} = u - u_x \\Delta x + \\frac{13}{24} u_{xx} \\Delta x^2 + \\mathcal{O}(\\Delta x^3)$.\nNow, we compute the difference $u_i - u_{i-1}$:\n$$\nu_i - u_{i-1} = \\left( u + \\frac{\\Delta x^2}{24} u_{xx} \\right) - \\left( u - u_x \\Delta x + \\frac{13}{24} u_{xx} \\Delta x^2 \\right) + \\mathcal{O}(\\Delta x^3)\n$$\n$$\nu_i - u_{i-1} = u_x \\Delta x - \\frac{12}{24} u_{xx} \\Delta x^2 + \\mathcal{O}(\\Delta x^3) = u_x \\Delta x - \\frac{1}{2} u_{xx} \\Delta x^2 + \\mathcal{O}(\\Delta x^3)\n$$\nThe RHS of the scheme for $a>0$ is:\n$$\nRHS = -\\frac{a}{\\Delta x} \\left( u_x \\Delta x - \\frac{1}{2} u_{xx} \\Delta x^2 + \\mathcal{O}(\\Delta x^3) \\right) = -a u_x + \\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta x^2)\n$$\nEquating LHS and RHS:\n$$\nu_t + \\frac{\\Delta x^2}{24} u_{xxt} + \\dots = -a u_x + \\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta x^2)\n$$\nRearranging gives:\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta x^2}{24} u_{xxt} + \\mathcal{O}(\\Delta x^3)\n$$\nThe term $\\frac{\\Delta x^2}{24} u_{xxt}$ is of order $\\mathcal{O}(\\Delta x^2)$ and can be grouped with higher-order terms. The problem asks for the modified equation up to terms of order $\\mathcal{O}(\\Delta x^2)$, which means we identify the leading-order error term. The leading-order term is the one proportional to $\\Delta x$.\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta x^2)\n$$\nComparing this to the target form $u_t + a u_x = \\nu_{\\text{num}} u_{xx} + \\mathcal{O}(\\Delta x^2)$, we find that for $a > 0$, $\\nu_{\\text{num}} = \\frac{a \\Delta x}{2}$.\n\nCase 2: $a < 0$.\nThe scheme is $\\frac{du_i}{dt} = -\\frac{a}{\\Delta x}(u_{i+1} - u_i)$.\nA similar expansion for $u_{i+1}$ (the average over $[x_i + \\Delta x/2, x_i + 3\\Delta x/2]$) gives:\n$u_{i+1} = u + u_x \\Delta x + \\frac{13}{24} u_{xx} \\Delta x^2 + \\mathcal{O}(\\Delta x^3)$.\nThe difference is:\n$$\nu_{i+1} - u_i = \\left( u + u_x \\Delta x + \\frac{13}{24} u_{xx} \\Delta x^2 \\right) - \\left( u + \\frac{\\Delta x^2}{24} u_{xx} \\right) + \\mathcal{O}(\\Delta x^3)\n$$\n$$\nu_{i+1} - u_i = u_x \\Delta x + \\frac{12}{24} u_{xx} \\Delta x^2 + \\mathcal{O}(\\Delta x^3) = u_x \\Delta x + \\frac{1}{2} u_{xx} \\Delta x^2 + \\mathcal{O}(\\Delta x^3)\n$$\nThe RHS of the scheme for $a < 0$ is:\n$$\nRHS = -\\frac{a}{\\Delta x} \\left( u_x \\Delta x + \\frac{1}{2} u_{xx} \\Delta x^2 + \\mathcal{O}(\\Delta x^3) \\right) = -a u_x - \\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta x^2)\n$$\nEquating with the LHS gives:\n$$\nu_t + a u_x = -\\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta x^2)\n$$\nFor $a < 0$, we find $\\nu_{\\text{num}} = -\\frac{a \\Delta x}{2}$.\n\nCombining both cases:\nFor $a > 0$, $\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} = \\frac{|a| \\Delta x}{2}$.\nFor $a < 0$, $\\nu_{\\text{num}} = -\\frac{a \\Delta x}{2} = \\frac{|a| \\Delta x}{2}$.\nThus, the general expression for the artificial viscosity coefficient, valid for any non-zero $a \\in \\mathbb{R}$, is:\n$$\n\\nu_{\\text{num}} = \\frac{|a| \\Delta x}{2}\n$$\nThis term, a second-order spatial derivative with a positive coefficient (since $|a| \\ge 0$ and $\\Delta x > 0$), represents numerical diffusion or viscosity, which is characteristic of the first-order upwind scheme. It is this dissipative term that stabilizes the numerical solution but also introduces a loss of accuracy by smearing sharp gradients.",
            "answer": "$$\n\\boxed{\\frac{|a|\\Delta x}{2}}\n$$"
        }
    ]
}