{
    "hands_on_practices": [
        {
            "introduction": "评估数值格式的一个主要标准是其精度，而局部截断误差是进行此分析的核心工具。第一个练习  提供了一项基础训练：为均匀网格上的标准单元中心有限体积格式推导截断误差。掌握这种基于泰勒（Taylor）展开的技术，对于理解离散算子如何逼近其连续算子至关重要。",
            "id": "3741695",
            "problem": "考虑单位正方形域 $[0,1] \\times [0,1]$ 上的常系数扩散算子 $\\mathcal{L}u = \\partial_{xx}u + \\partial_{yy}u$。设定义一个间距为 $h$ 的均匀笛卡尔网格，其单元中心位于 $(x_i,y_j) = \\left(\\left(i-\\frac{1}{2}\\right)h,\\left(j-\\frac{1}{2}\\right)h\\right)$，其中 $i,j$ 为整数，$h = \\frac{1}{N}$ 且 $N \\in \\mathbb{N}$。考虑 $\\mathcal{L}$ 的标准二阶单元中心有限体积离散化，该方法对面心梯度使用中心差分，并在每个单元上保持守恒通量平衡：分别用 $F_{x,i+\\frac{1}{2},j}$ 和 $F_{y,i,j+\\frac{1}{2}}$ 表示通过单元 $(i,j)$ 右侧和顶部面的离散扩散通量，\n$$\nF_{x,i+\\frac{1}{2},j} \\equiv -\\frac{u_{i+1,j}-u_{i,j}}{h}, \n\\quad \nF_{x,i-\\frac{1}{2},j} \\equiv -\\frac{u_{i,j}-u_{i-1,j}}{h},\n$$\n$$\nF_{y,i,j+\\frac{1}{2}} \\equiv -\\frac{u_{i,j+1}-u_{i,j}}{h}, \n\\quad \nF_{y,i,j-\\frac{1}{2}} \\equiv -\\frac{u_{i,j}-u_{i,j-1}}{h},\n$$\n且离散散度定义为\n$$\n\\mathcal{L}_h u_{i,j} \\equiv -\\frac{F_{x,i+\\frac{1}{2},j}-F_{x,i-\\frac{1}{2},j}}{h} - \\frac{F_{y,i,j+\\frac{1}{2}}-F_{y,i,j-\\frac{1}{2}}}{h}.\n$$\n此处，$u_{i,j}$ 表示在单元中心 $(x_i,y_j)$ 处采样的精确函数 $u$。对于光滑函数 $u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$，定义单元 $(i,j)$ 处的局部截断误差为\n$$\n\\tau_{i,j}(h) \\equiv \\mathcal{L}_h u(x_i,y_j) - \\mathcal{L}u(x_i,y_j).\n$$\n从散度定理和关于 $(x_i,y_j)$ 的泰勒级数展开出发，推导当 $h$ 足够小时 $\\tau_{i,j}(h)$ 的主阶项，并证明 $\\tau_{i,j}(h)$ 表现出 $\\mathcal{O}(h^2)$ 的行为。请用 $h$, $x_i$, $y_j$ 和 $\\pi$ 将 $\\tau_{i,j}(h)$ 的主阶项表示为单一闭式解析表达式。无需四舍五入，不涉及物理单位。你的最终答案必须仅为主阶项（即省略高阶余项）。",
            "solution": "该问题旨在为拉普拉斯算子的单元中心有限体积离散化推导局部截断误差的主阶项。\n\n首先，我们验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **连续算子：** $\\mathcal{L}u = \\partial_{xx}u + \\partial_{yy}u$。\n- **区域：** $[0,1] \\times [0,1]$。\n- **网格：** 均匀笛卡尔网格，间距 $h = 1/N$。单元中心位于 $(x_i,y_j) = \\left(\\left(i-\\frac{1}{2}\\right)h,\\left(j-\\frac{1}{2}\\right)h\\right)$。\n- **离散通量：**\n  $F_{x,i+\\frac{1}{2},j} \\equiv -\\frac{u_{i+1,j}-u_{i,j}}{h}$, $F_{x,i-\\frac{1}{2},j} \\equiv -\\frac{u_{i,j}-u_{i-1,j}}{h}$。\n  $F_{y,i,j+\\frac{1}{2}} \\equiv -\\frac{u_{i,j+1}-u_{i,j}}{h}$, $F_{y,i,j-\\frac{1}{2}} \\equiv -\\frac{u_{i,j}-u_{i,j-1}}{h}$。\n- **离散算子：** $\\mathcal{L}_h u_{i,j} \\equiv -\\frac{F_{x,i+\\frac{1}{2},j}-F_{x,i-\\frac{1}{2},j}}{h} - \\frac{F_{y,i,j+\\frac{1}{2}}-F_{y,i,j-\\frac{1}{2}}}{h}$。\n- **函数：** $u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$，其中 $u_{i,j} = u(x_i, y_j)$。\n- **局部截断误差：** $\\tau_{i,j}(h) \\equiv \\mathcal{L}_h u(x_i,y_j) - \\mathcal{L}u(x_i,y_j)$。\n- **目标：** 推导 $\\tau_{i,j}(h)$ 的主阶项并证明其为 $\\mathcal{O}(h^2)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。这是一个偏微分方程数值分析中的标准练习，具体是推导有限体积格式的局部截断误差。所有定义都是标准且自洽的。该问题是可形式化且在数学上是合理的。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n问题是**有效的**。我们开始求解。\n\n问题要求从散度定理出发进行推导。有限体积法是通过在控制体（一个单元 $\\Omega_{i,j}$）上对偏微分方程 $\\nabla \\cdot (\\nabla u) = f$ 进行积分，并应用散度定理：$\\oint_{\\partial\\Omega_{i,j}} \\nabla u \\cdot \\mathbf{n} \\, dS = \\int_{\\Omega_{i,j}} f \\, dV$ 推导出来的。离散算子 $\\mathcal{L}_h$ 是对这些积分项进行近似的结果。让我们首先通过代入给定的通量定义，将离散算子写成其显式模板形式：\n$$\n\\mathcal{L}_h u_{i,j} = -\\frac{1}{h} \\left( \\left(-\\frac{u_{i+1,j}-u_{i,j}}{h}\\right) - \\left(-\\frac{u_{i,j}-u_{i-1,j}}{h}\\right) \\right) - \\frac{1}{h} \\left( \\left(-\\frac{u_{i,j+1}-u_{i,j}}{h}\\right) - \\left(-\\frac{u_{i,j}-u_{i,j-1}}{h}\\right) \\right)\n$$\n简化表达式，我们得到：\n$$\n\\mathcal{L}_h u_{i,j} = \\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^2} + \\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^2}\n$$\n这就是笛卡尔网格上拉普拉斯算子的众所周知的五点模板近似。\n\n局部截断误差定义为 $\\tau_{i,j}(h) \\equiv \\mathcal{L}_h u(x_i,y_j) - \\mathcal{L}u(x_i,y_j)$。为分析此式，我们对 $\\mathcal{L}_h u_{i,j}$ 中的各项在单元中心 $(x_i, y_j)$ 附近进行泰勒级数展开。我们用 $u$, $\\partial_x u$, $\\partial_{xx} u$ 等符号表示在 $(x_i, y_j)$ 处求值的 $u$ 及其偏导数。\n\n在相邻单元中心处 $u$ 的展开式为：\n$$\nu(x_i \\pm h, y_j) = u(x_i, y_j) \\pm h \\partial_x u + \\frac{h^2}{2!} \\partial_{xx} u \\pm \\frac{h^3}{3!} \\partial_{xxx} u + \\frac{h^4}{4!} \\partial_{xxxx} u + \\mathcal{O}(h^5)\n$$\n$$\nu(x_i, y_j \\pm h) = u(x_i, y_j) \\pm h \\partial_y u + \\frac{h^2}{2!} \\partial_{yy} u \\pm \\frac{h^3}{3!} \\partial_{yyy} u + \\frac{h^4}{4!} \\partial_{yyyy} u + \\mathcal{O}(h^5)\n$$\n让我们分析离散算子的第一项，它对应于关于 $x$ 的二阶导数：\n$$\n\\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^2} = \\frac{1}{h^2} \\left[ \\left(u+h\\partial_x u+\\frac{h^2}{2}\\partial_{xx}u+\\frac{h^3}{6}\\partial_{xxx}u+\\frac{h^4}{24}\\partial_{xxxx}u\\right) - 2u + \\left(u-h\\partial_x u+\\frac{h^2}{2}\\partial_{xx}u-\\frac{h^3}{6}\\partial_{xxx}u+\\frac{h^4}{24}\\partial_{xxxx}u\\right) + \\mathcal{O}(h^6) \\right]\n$$\n$h$ 的奇次幂项相互抵消：\n$$\n= \\frac{1}{h^2} \\left[ (2u + h^2\\partial_{xx}u + \\frac{h^4}{12}\\partial_{xxxx}u) - 2u + \\mathcal{O}(h^6) \\right] = \\frac{1}{h^2} \\left[ h^2\\partial_{xx}u + \\frac{h^4}{12}\\partial_{xxxx}u + \\mathcal{O}(h^6) \\right]\n$$\n$$\n= \\partial_{xx}u + \\frac{h^2}{12}\\partial_{xxxx}u + \\mathcal{O}(h^4)\n$$\n根据对称性，相同的分析也适用于 $y$ 方向：\n$$\n\\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^2} = \\partial_{yy}u + \\frac{h^2}{12}\\partial_{yyyy}u + \\mathcal{O}(h^4)\n$$\n将这些代回到 $\\mathcal{L}_h u_{i,j}$ 的表达式中：\n$$\n\\mathcal{L}_h u_{i,j} = \\left( \\partial_{xx}u + \\frac{h^2}{12}\\partial_{xxxx}u \\right) + \\left( \\partial_{yy}u + \\frac{h^2}{12}\\partial_{yyyy}u \\right) + \\mathcal{O}(h^4)\n$$\n合并各项：\n$$\n\\mathcal{L}_h u_{i,j} = (\\partial_{xx}u + \\partial_{yy}u) + \\frac{h^2}{12}(\\partial_{xxxx}u + \\partial_{yyyy}u) + \\mathcal{O}(h^4)\n$$\n注意到 $\\mathcal{L}u = \\partial_{xx}u + \\partial_{yy}u$，我们可以写出：\n$$\n\\mathcal{L}_h u_{i,j} = \\mathcal{L}u + \\frac{h^2}{12}(\\partial_{xxxx}u + \\partial_{yyyy}u) + \\mathcal{O}(h^4)\n$$\n现在，我们计算局部截断误差 $\\tau_{i,j}(h)$：\n$$\n\\tau_{i,j}(h) = \\mathcal{L}_h u_{i,j} - \\mathcal{L}u_{i,j} = \\frac{h^2}{12}(\\partial_{xxxx}u + \\partial_{yyyy}u) + \\mathcal{O}(h^4)\n$$\n这证明了局部截断误差是 $\\mathcal{O}(h^2)$ 阶的。主阶项是在 $(x_i, y_j)$ 处求值的 $\\frac{h^2}{12}(\\partial_{xxxx}u + \\partial_{yyyy}u)$。\n\n为求得该项的具体表达式，我们必须计算给定函数 $u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$ 的四阶偏导数。\n关于 $x$ 的导数是：\n$$\n\\partial_x u = \\pi \\cos(\\pi x)\\sin(\\pi y)\n$$\n$$\n\\partial_{xx} u = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\n$$\n$$\n\\partial_{xxx} u = -\\pi^3 \\cos(\\pi x)\\sin(\\pi y)\n$$\n$$\n\\partial_{xxxx} u = \\pi^4 \\sin(\\pi x)\\sin(\\pi y)\n$$\n根据对称性，关于 $y$ 的四阶偏导数是：\n$$\n\\partial_{yyyy} u = \\pi^4 \\sin(\\pi x)\\sin(\\pi y)\n$$\n现在，我们将这些导数代入截断误差的主阶项：\n$$\n\\text{Leading term of } \\tau_{i,j}(h) = \\frac{h^2}{12} \\left[ \\pi^4 \\sin(\\pi x_i)\\sin(\\pi y_j) + \\pi^4 \\sin(\\pi x_i)\\sin(\\pi y_j) \\right]\n$$\n$$\n= \\frac{h^2}{12} \\left[ 2\\pi^4 \\sin(\\pi x_i)\\sin(\\pi y_j) \\right]\n$$\n$$\n= \\frac{h^2\\pi^4}{6} \\sin(\\pi x_i)\\sin(\\pi y_j)\n$$\n这就是局部截断误差主阶项的最终解析表达式。",
            "answer": "$$\n\\boxed{\\frac{h^2\\pi^4}{6} \\sin(\\pi x_i)\\sin(\\pi y_j)}\n$$"
        },
        {
            "introduction": "超越局部精度，我们必须考虑离散系统的全局属性，尤其是在处理带有诺伊曼（Neumann）边界条件的泊松（Poisson）方程等守恒律问题时。这个练习  探讨了算子零空间和解存在性所需的相容性条件等关键概念。你将研究如何通过约束平均值来获得唯一解，并在此过程中辨析单元中心和顶点中心格式之间的关键差异，尤其是在非均匀网格上，离散测度的选择至关重要。",
            "id": "3741661",
            "problem": "考虑在连通有界域 $\\Omega \\subset \\mathbb{R}^d$ 上的泊松方程，其标量传导系数 $k(\\mathbf{x})>0$ 为严格正值，并带有齐次诺伊曼边界条件，\n$$\n-\\nabla \\cdot \\left( k(\\mathbf{x}) \\nabla u(\\mathbf{x}) \\right) = f(\\mathbf{x}) \\quad \\text{in } \\Omega, \n\\qquad \\mathbf{n} \\cdot k(\\mathbf{x}) \\nabla u(\\mathbf{x}) = 0 \\quad \\text{on } \\partial \\Omega,\n$$\n其中 $\\mathbf{n}$ 表示边界 $\\partial \\Omega$ 上的外单位法向量。众所周知，仅当相容性条件 $\\int_{\\Omega} f(\\mathbf{x}) \\, d\\mathbf{x} = 0$ 成立时，该连续问题才有解，且其解在相差一个加性常数的意义下是唯一的。\n\n现在考虑在 $\\Omega$ 的一个一般的（可能非均匀的）网格剖分上的一个守恒的、以单元为中心的有限体积离散化，该剖分将 $\\Omega$ 分为控制体 $\\{V_i\\}_{i=1}^N$，其单元中心为 $\\{\\mathbf{x}_i\\}_{i=1}^N$。每个控制体中的半离散平衡强制要求通过其所有面的扩散通量之和等于在该单元上积分的源项，\n$$\n\\sum_{F \\subset \\partial V_i} \\Phi_{iF}(u) \\;=\\; \\int_{V_i} f(\\mathbf{x}) \\, d\\mathbf{x},\n$$\n其中齐次诺伊曼条件通过在边界面上设置零法向通量来实现。假设通量 $\\Phi_{iF}(u)$ 是根据相容的两点逼近计算的，这些逼近是守恒的，并产生一个对称半正定全局算子 $A \\in \\mathbb{R}^{N \\times N}$，使得离散系统表示为\n$$\nA \\, \\mathbf{u} \\;=\\; \\mathbf{b}, \\quad \\text{其中 } \\mathbf{u} = (u_1,\\dots,u_N)^{\\top}, \\quad b_i = \\int_{V_i} f(\\mathbf{x}) \\, d\\mathbf{x}.\n$$\n在多尺度建模与分析中，非均匀的控制体体积 $|V_i|$ 很常见。单元中心场 $u$ 在 $\\Omega$ 上的离散平均值定义为体积加权平均值，$\\bar{u} := \\left( \\sum_{i=1}^N |V_i| u_i \\right) \\Big/ \\left( \\sum_{i=1}^N |V_i| \\right)$。\n\n下列哪些陈述是正确的？选择所有适用项。\n\nA. 对于连通网格上的、带有齐次诺伊曼边界条件的单元中心有限体积算子，其零空间是一维的，并由常向量 $\\mathbf{1} = (1,\\dots,1)^{\\top}$ 张成。为了将 $u$ 的平均值固定为给定值 $\\bar{u}$，一个有效的全局约束是\n$$\n\\sum_{i=1}^N |V_i| \\, u_i \\;=\\; \\bar{u} \\sum_{i=1}^N |V_i|.\n$$\n\nB. 带有齐次诺伊曼边界条件的单元中心算子的零空间由所有离散谐波模式（包括非常数模式）组成。为了固定平均值，施加对任意单元的点约束 $u_{i_0} = \\bar{u}$ 就足够了（而且更可取）。\n\nC. 在均匀网格上，带有齐次诺伊曼边界条件的单元中心算子的零空间由常数张成。固定平均值的正确方法是 $\\sum_{i=1}^N u_i = \\bar{u} \\, N$，并且这种无权约束对于非均匀网格也仍然是正确的。\n\nD. 在一个以顶点为中心的（有限元或基于顶点的有限体积）离散化中，对于齐次诺伊曼边界条件，其零空间也由常数张成。适当的固定平均值的约束使用顶点求积或质量矩阵权重（而不是单元体积），即，强制执行 $\\sum_{j=1}^{M} w_j \\, u_j = \\bar{u} \\sum_{j=1}^{M} w_j$，其中权重 $w_j$ 来自离散 $L^2$ 内积。\n\nE. 对于带有齐次诺伊曼边界条件的单元中心系统的可解性而言，与 $\\int_{\\Omega} f(\\mathbf{x}) \\, d\\mathbf{x} = 0$ 对应的离散相容性条件不是必需的；当边界通量为零时，算子 $A$ 的零空间为空。\n\nF. 在单元中心格式中，一种保结构地施加平均值约束的方法是用一个拉格朗日乘子来增广系统，\n$$\n\\begin{pmatrix}\nA  & \\mathbf{c} \\\\\n\\mathbf{c}^\\top & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\ \\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{b} \\\\ \\bar{u} \\sum_{i=1}^N |V_i|\n\\end{pmatrix},\n\\qquad \\text{其中 } \\mathbf{c}_i = |V_i|,\n$$\n这能保持守恒性，并得到具有给定体积加权平均值的唯一解 $\\mathbf{u}$。",
            "solution": "问题陈述是对带有齐次诺伊曼边界条件的泊松方程的单元中心有限体积离散化的有效描述。该设置在数值分析方面有科学依据，（作为一个概念评估任务）是适定的、客观的且内部一致的。我们可以进行分析。\n\n离散系统由 $A \\mathbf{u} = \\mathbf{b}$ 给出，其中 $A$ 是一个对称半正定算子，它由代表域 $\\Omega$ 的连通网格上的守恒两点通量逼近导出。\n\n首先，我们分析算子 $A$ 的性质。系统的第 $i$ 个方程是 $(A\\mathbf{u})_i = \\sum_{F \\subset \\partial V_i} \\Phi_{iF}(u) = b_i$。让我们将所有这些方程对所有控制体 $i=1, \\dots, N$ 求和：\n$$ \\sum_{i=1}^N (A\\mathbf{u})_i = \\sum_{i=1}^N \\sum_{F \\subset \\partial V_i} \\Phi_{iF}(u) $$\n由于通量的守恒性质，对于由单元 $V_i$ 和 $V_j$ 共享的任何内部面 $F$，流出 $V_i$ 的通量是流出 $V_j$ 通量的负值，即 $\\Phi_{iF} = -\\Phi_{jF}$。因此，当对所有控制体求和时，所有内部面上的通量两两抵消。唯一剩下的通量是那些位于域边界 $\\partial\\Omega$ 上的面上的通量。\n$$ \\sum_{i=1}^N (A\\mathbf{u})_i = \\sum_{F \\subset \\partial\\Omega} \\Phi_{boundary, F}(u) $$\n问题陈述中说明，齐次诺伊曼边界条件通过在边界面上设置零法向通量来实现。这意味着对于所有边界面 $F$，都有 $\\Phi_{boundary, F}(u) = 0$。因此，\n$$ \\sum_{i=1}^N (A\\mathbf{u})_i = 0 $$\n这个方程对任何向量 $\\mathbf{u}$ 都成立。这可以用向量表示法写为 $\\mathbf{1}^\\top (A\\mathbf{u}) = 0$，其中 $\\mathbf{1} = (1, \\dots, 1)^{\\top}$ 是全1向量。因为这对所有 $\\mathbf{u}$ 都成立，所以它意味着 $\\mathbf{1}^\\top A = \\mathbf{0}^\\top$。鉴于 $A$ 是对称的（$A=A^\\top$），我们可以取转置得到 $A^\\top \\mathbf{1} = A \\mathbf{1} = \\mathbf{0}$。这证明了常向量 $\\mathbf{1}$ 在 $A$ 的零空间中。对于连通网格上的离散化，得到的图拉普拉斯矩阵 $A$ 有一个一维的零空间，由这个常向量张成。因此，$\\text{null}(A) = \\text{span}(\\mathbf{1})$。\n\n要使线性系统 $A\\mathbf{u} = \\mathbf{b}$ 有解，右端向量 $\\mathbf{b}$ 必须与 $A^\\top$ 的零空间正交。由于 $A$ 是对称的，这意味着 $\\mathbf{b}$ 必须与 $\\text{null}(A) = \\text{span}(\\mathbf{1})$ 正交。该条件是 $\\mathbf{1}^\\top \\mathbf{b} = 0$。让我们展开它：\n$$ \\mathbf{1}^\\top \\mathbf{b} = \\sum_{i=1}^N b_i = \\sum_{i=1}^N \\int_{V_i} f(\\mathbf{x}) \\, d\\mathbf{x} = \\int_{\\Omega} f(\\mathbf{x}) \\, d\\mathbf{x} $$\n因此，可解性的离散相容性条件是 $\\int_{\\Omega} f(\\mathbf{x}) \\, d\\mathbf{x} = 0$，这与连续情形下的条件相同。\n\n如果这个条件成立，解 $\\mathbf{u}_p$ 存在，但它不是唯一的。对于任何标量 $c \\in \\mathbb{R}$，形如 $\\mathbf{u} = \\mathbf{u}_p + c \\mathbf{1}$ 的任何向量也是一个解，因为 $A(\\mathbf{u}_p + c \\mathbf{1}) = A \\mathbf{u}_p + c (A \\mathbf{1}) = \\mathbf{b} + \\mathbf{0} = \\mathbf{b}$。为了获得唯一解，需要一个附加约束。一个常见且有物理意义的约束是固定解的平均值。问题将离散平均值定义为体积加权平均值：\n$$ \\bar{u} := \\frac{\\sum_{i=1}^N |V_i| u_i}{\\sum_{i=1}^N |V_i|} $$\n将此平均值设置为一个给定值 $\\bar{u}_{prescribed}$，得到约束 $\\sum_{i=1}^N |V_i| u_i = \\bar{u}_{prescribed} \\sum_{i=1}^N |V_i|$。这个约束与零空间无关，因为分量为 $v_i = |V_i|$ 的约束向量 $\\mathbf{v}$ 不与零向量 $\\mathbf{1}$ 正交（因为 $\\mathbf{v}^\\top\\mathbf{1} = \\sum |V_i| = |\\Omega| > 0$）。\n\n现在，我们评估每个选项。\n\n**A. 对于连通网格上的、带有齐次诺伊曼边界条件的单元中心有限体积算子，其零空间是一维的，并由常向量 $\\mathbf{1} = (1,\\dots,1)^{\\top}$ 张成。为了将 $u$ 的平均值固定为给定值 $\\bar{u}$，一个有效的全局约束是 $\\sum_{i=1}^N |V_i| \\, u_i \\;=\\; \\bar{u} \\sum_{i=1}^N |V_i|$。**\n此陈述与我们的分析完全一致。零空间性质是连通图上离散拉普拉斯算子的一个标准结果。该约束方程是问题中给出的体积加权平均定义的直接代数表述。这是在一般（非均匀）网格上指定平均值的正确方法。\n**结论：正确。**\n\n**B. 带有齐次诺伊曼边界条件的单元中心算子的零空间由所有离散谐波模式（包括非常数模式）组成。为了固定平均值，施加对任意单元的点约束 $u_{i_0} = \\bar{u}$ 就足够了（而且更可取）。**\n第一部分不正确。零空间对应于特征值 $0$，并且对于连通网格，它仅由常向量张成。其他谐波模式是对应于非零特征值的特征向量，不在零空间中。第二部分也是错误的。虽然施加点约束 $u_{i_0} = c$（对于某个常数 $c$）确实能得到唯一解，但设置 $u_{i_0} = \\bar{u}$ 通常不会导致解的体积加权平均值为 $\\bar{u}$。它只是固定了一个单元中的值。\n**结论：不正确。**\n\n**C. 在均匀网格上，带有齐次诺伊曼边界条件的单元中心算子的零空间由常数张成。固定平均值的正确方法是 $\\sum_{i=1}^N u_i = \\bar{u} \\, N$，并且这种无权约束对于非均匀网格也仍然是正确的。**\n在均匀网格上，所有单元体积 $|V_i|$ 都相同，我们称之为 $|V_i| = V_{cell}$。体积加权平均简化为算术平均：$\\bar{u} = (\\sum V_{cell} u_i) / (\\sum V_{cell}) = (\\sum u_i) / N$。因此，对于均匀网格，约束 $\\sum u_i = \\bar{u} N$ 是正确的。然而，该陈述声称这种无权约束对于非均匀网格也是正确的。这是错误的。在非均匀网格上，离散平均值必须按单元体积 $|V_i|$ 进行加权，才能成为连续积分平均值的一致逼近。在这种情况下，无权和不是 $\\int_\\Omega u \\, d\\mathbf{x}$ 的适当离散模拟。\n**结论：不正确。**\n\n**D. 在一个以顶点为中心的（有限元或基于顶点的有限体积）离散化中，对于齐次诺伊曼边界条件，其零空间也由常数张成。适当的固定平均值的约束使用顶点求积或质量矩阵权重（而不是单元体积），即，强制执行 $\\sum_{j=1}^{M} w_j \\, u_j = \\bar{u} \\sum_{j=1}^{M} w_j$，其中权重 $w_j$ 来自离散 $L^2$ 内积。**\n该陈述正确地将概念转换到以顶点为中心的格式中。对于连通网格，这类格式也会产生一个对称半正定的刚度矩阵，其零空间由节点值的常向量张成。对于基于节点的函数 $u_h = \\sum u_j \\phi_j$，积分 $\\int_\\Omega u_h(\\mathbf{x}) d\\mathbf{x}$ 的离散逼近是 $\\sum u_j \\int \\phi_j d\\mathbf{x}$。权重 $w_j = \\int \\phi_j d\\mathbf{x}$ 是一致质量矩阵的行和，代表每个节点的适当加权。这些权重与单元中心格式中使用的对偶网格的单元体积 $|V_i|$ 是不同的。所提出的约束是为以顶点为中心的方法定义和固定平均值的正确方法。\n**结论：正确。**\n\n**E. 对于带有齐次诺伊曼边界条件的单元中心系统的可解性而言，与 $\\int_{\\Omega} f(\\mathbf{x}) \\, d\\mathbf{x} = 0$ 对应的离散相容性条件不是必需的；当边界通量为零时，算子 $A$ 的零空间为空。**\n该陈述在两点上是根本错误的。如前所述，离散相容性条件 $\\sum b_i = 0$ 是奇异系统 $A\\mathbf{u} = \\mathbf{b}$ 有解的必要条件。此外，算子 $A$ 有一个由常向量 $\\mathbf{1}$ 张成的非空零空间，这是齐次诺伊曼（零通量）边界条件的直接结果，该条件确保了行/列和为零。\n**结论：不正确。**\n\n**F. 在单元中心格式中，一种保结构地施加平均值约束的方法是用一个拉格朗日乘子来增广系统，\n$$\n\\begin{pmatrix}\nA  & \\mathbf{c} \\\\\n\\mathbf{c}^\\top & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\ \\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{b} \\\\ \\bar{u} \\sum_{i=1}^N |V_i|\n\\end{pmatrix},\n\\qquad \\text{其中 } \\mathbf{c}_i = |V_i|,\n$$\n这能保持守恒性，并得到具有给定体积加权平均值的唯一解 $\\mathbf{u}$。**\n这描述了用线性约束求解奇异系统的标准鞍点提法。系统的第二行 $\\mathbf{c}^\\top \\mathbf{u} = \\bar{u} \\sum |V_i|$ 明确地施加了所需的体积加权平均约束。如果约束向量 $\\mathbf{c}$ 不在 $A$ 的值域中，并且不与 $A^\\top$ 的零空间正交，则增广矩阵是非奇异的。这里 $\\mathbf{c}$ 的分量为 $|V_i|>0$，所以 $\\mathbf{1}^\\top \\mathbf{c} = \\sum |V_i| = |\\Omega| \\neq 0$，这意味着 $\\mathbf{c}$ 不与 $A$ 的零空间正交。这确保了增广系统有唯一解 $(\\mathbf{u}, \\lambda)^{\\top}$。该方法是稳健的，因为它即使在原始相容性条件 $\\mathbf{1}^\\top \\mathbf{b}=0$ 不满足的情况下，也能通过隐式修改源项找到解。因此，这是一种非常有效和常用的方法。\n**结论：正确。**",
            "answer": "$$\\boxed{ADF}$$"
        },
        {
            "introduction": "数值格式的真正威力与挑战常常在复杂的非结构几何上显现。最后一个练习  深入探讨了单纯形网格上离散方法的几何稳健性。通过分析一个非德洛内（non-Delaunay）三角剖分，你将发现常用于单元中心有限体积法的外心对偶网格如何导致非物理的负系数，并从概念上探索为何使用重心对偶的顶点中心格式能够自然地避免这些问题，从而确保更稳定可靠的离散化。",
            "id": "3741676",
            "problem": "考虑一个平面单纯复形网格，其中两个三角形共享一条内部边。设公共边的长度为 $L=1$，两个三角形中该边所对的角分别为 $\\alpha=120^{\\circ}$ 和 $\\beta=100^{\\circ}$。在离散外微分（DEC，Discrete Exterior Calculus）中——一个在多尺度建模与分析中广泛使用的离散微分几何框架——与内部边相关联的原始1-形式上的离散霍奇星算子的分量，被定义为对偶边段的带符号长度与原始边长度之比。外心对偶通过连接两个相邻三角形的外心来构造此对偶边段，并使用到公共边的带符号垂直距离。相比之下，以顶点为中心的方案采用基于质心或重心的对偶来定义围绕顶点的控制体，即使在非德劳内三角剖分上也能确保度量系数为正。\n\n从以下基本欧几里得几何事实出发：\n- 边长为 $a$、其内对角为 $\\theta$ 的三角形，其外接圆半径 $R$ 为 $R=\\dfrac{a}{2\\sin\\theta}$。\n- 从外心到边长为 $a$ 的边的距离（沿该边的垂线测量）等于 $R\\cos\\theta$。\n\n根据这些事实和第一性原理，推导与该边相邻的单个三角形对带符号对偶长度的贡献表达式，然后通过将两个贡献之和除以 $L$ 来获得该边的离散霍奇星算子分量。对给定数据，数值计算此霍奇星算子分量，并判断其是否为负，从而证明在外心对偶下非德劳内三角剖分可能出现的不一致性。最后，从概念上解释以顶点为中心的方案如何修改控制体构造以避免负体积并确保度量系数为正，同时参考基于质心的对偶及其与三角形高的关系。\n\n将离散霍奇星算子分量的最终数值答案四舍五入至四位有效数字。最终结果无需物理单位。",
            "solution": "所述问题是有效的。它在科学上植根于离散微分几何和数值分析领域，特别涉及单纯复形网格上离散化的性质。其前提事实正确，术语标准，问题适定，并包含足够的信息以获得唯一解。它提供了一个典型例子，用以说明在非德劳内网格上使用外心对偶构造时可能出现的一个已知问题。\n\n我们将按要求进行推导和分析。\n\n问题要求解与平面三角剖分内部边相关联的离散霍奇星算子的分量。该分量我们记为 $\\star_{e}$，其值为对偶边段的带符号长度 $|e^*|_{\\text{signed}}$ 与原始边长度 $|e|$ 之比。共享的原始边长度为 $|e|=L=1$。它与两个三角形相邻，这两个三角形中该边所对的角分别为 $\\alpha = 120^{\\circ}$ 和 $\\beta = 100^{\\circ}$。\n\n首先，我们推导单个三角形对带符号对偶长度的贡献表达式。考虑一个边长为 $L$ 且对角为 $\\theta$ 的三角形。外心对偶是利用三角形的外心来构造的。对带符号对偶长度的贡献是外心到共享边的带符号垂直距离。\n\n假设共享边位于x轴上，其顶点为 $(-\\frac{L}{2}, 0)$ 和 $(\\frac{L}{2}, 0)$。三角形的第三个顶点位于 $y>0$ 平面。根据对称性，外心必须位于该边的垂直平分线（即y轴）上。设外心为 $C=(0, y_c)$。外接圆半径 $R$ 是从 $C$ 到任意顶点的距离。利用顶点 $(\\frac{L}{2}, 0)$，我们有：\n$$R^2 = \\left(\\frac{L}{2} - 0\\right)^2 + (0 - y_c)^2 = \\frac{L^2}{4} + y_c^2$$\n问题给出了外接圆半径用边长 $L$ 和对角 $\\theta$ 表示的公式：$R = \\dfrac{L}{2\\sin\\theta}$。将此代入 $R^2$ 的方程中：\n$$\\left(\\frac{L}{2\\sin\\theta}\\right)^2 = \\frac{L^2}{4} + y_c^2$$\n$$\\frac{L^2}{4\\sin^2\\theta} = \\frac{L^2}{4} + y_c^2$$\n解出 $y_c^2$：\n$$y_c^2 = \\frac{L^2}{4\\sin^2\\theta} - \\frac{L^2}{4} = \\frac{L^2}{4}\\left(\\frac{1}{\\sin^2\\theta} - 1\\right) = \\frac{L^2}{4}\\left(\\frac{1-\\sin^2\\theta}{\\sin^2\\theta}\\right) = \\frac{L^2}{4}\\frac{\\cos^2\\theta}{\\sin^2\\theta} = \\frac{L^2}{4}\\cot^2\\theta$$\n这得到 $y_c = \\pm \\frac{L}{2}\\cot\\theta$。$y_c$ 的符号取决于外心是否与第三个顶点位于该边的同一侧。如果三角形是锐角三角形（$\\theta < 90^{\\circ}$），外心在三角形内部，因此 $y_c > 0$。此时 $\\cot\\theta > 0$，所以我们必须选择正号。如果三角形是钝角三角形（$\\theta > 90^{\\circ}$），外心在三角形外部，位于最长边（即长度为 $L$ 的边）的另一侧。因此，$y_c$ 的符号将与第三个顶点的y坐标相反，即 $y_c < 0$。此时 $\\cot\\theta < 0$，所以我们在公式 $y_c = \\frac{L}{2}\\cot\\theta$ 中必须再次选择正号才能得到一个负值。因此，从外心到该边的带符号垂直距离可以正确地由以下公式给出：\n$$d(\\theta) = \\frac{L}{2}\\cot\\theta$$\n这是单个三角形对带符号对偶长度的贡献。该表达式与所提供的事实——无符号距离为 $R|\\cos\\theta|$——是一致的，因为 $|d(\\theta)| = |\\frac{L}{2}\\cot\\theta| = |\\frac{L}{2\\sin\\theta}\\cos\\theta| = |R\\cos\\theta|$。\n\n共享原始边的对偶边的总带符号长度是两个相邻三角形（其对角分别为 $\\alpha$ 和 $\\beta$）贡献的总和。\n$$|e^*|_{\\text{signed}} = d(\\alpha) + d(\\beta) = \\frac{L}{2}\\cot\\alpha + \\frac{L}{2}\\cot\\beta = \\frac{L}{2}(\\cot\\alpha + \\cot\\beta)$$\n离散霍奇星算子分量是此带符号对偶长度除以原始边长 $L$：\n$$\\star_{e} = \\frac{|e^*|_{\\text{signed}}}{L} = \\frac{\\frac{L}{2}(\\cot\\alpha + \\cot\\beta)}{L} = \\frac{1}{2}(\\cot\\alpha + \\cot\\beta)$$\n现在，我们用给定数据 $L=1$，$\\alpha=120^{\\circ}$ 和 $\\beta=100^{\\circ}$ 来计算这个表达式。余切值为：\n$$\\cot(120^{\\circ}) = \\cot(180^{\\circ} - 60^{\\circ}) = -\\cot(60^{\\circ}) = -\\frac{1}{\\sqrt{3}}$$\n$$\\cot(100^{\\circ}) = \\cot(90^{\\circ} + 10^{\\circ}) = -\\tan(10^{\\circ})$$\n数值上，\n$$\\cot(120^{\\circ}) \\approx -0.57735$$\n$$\\cot(100^{\\circ}) \\approx -0.17633$$\n将这些值代入 $\\star_{e}$ 的表达式中：\n$$\\star_{e} \\approx \\frac{1}{2}(-0.57735 - 0.17633) = \\frac{1}{2}(-0.75368) = -0.37684$$\n四舍五入到四位有效数字，霍奇星算子分量为 $-0.3768$。\n\n这个值是负的。三角剖分为德劳内的条件是，对于任何内部边，两个相邻三角形的对角之和小于或等于 $180^{\\circ}$。在本例中，$\\alpha + \\beta = 120^{\\circ} + 100^{\\circ} = 220^{\\circ} > 180^{\\circ}$。这证实了该边是非德劳内的。负的霍奇星系数是外心对偶公式中这种几何构型的直接后果。在许多应用中（如热扩散），负系数是非物理的，因为它可能违反极值原理并导致数值不稳定性。\n\n以顶点为中心的方案通过修改对偶网格及其相关控制体的构造来避免此问题。这些方案不是围绕原始面元（三角形）定义对偶单元，而是围绕原始顶点定义控制体。一种常见且鲁棒的方法是重心对偶。在此构造中：\n1.  在每个原始三角形的重心（质心）处放置一个对偶顶点。\n2.  一条对偶边连接相邻三角形的重心，并穿过共享的原始边。然而，对于以顶点为中心的控制体，其边界的构造方式不同。\n3.  围绕原始顶点 $v_i$ 的控制体 $V_i$ 是由多个多边形（每个多边形位于与 $v_i$ 相邻的一个三角形内）的并集形成的。在具有顶点 $v_i, v_j, v_k$ 的三角形 $T$ 内部，$V_i$ 的部分是由顶点 $v_i$、边 $v_iv_j$ 的中点、$T$ 的重心以及边 $v_iv_k$ 的中点所构成的四边形。\n\n关键区别在于三角形内对偶点的选择。三角形的重心是其顶点坐标的平均值，因此*总是*位于三角形内部，无论该三角形是锐角、直角还是钝角。相比之下，外心位于钝角三角形的外部。\n\n由于重心对偶构造使用的点（重心、中点）保证位于原始单元的内部或边界上，因此生成的控制体总是良态的、包围其定义顶点的星形多边形。相邻控制体之间的界面（例如，$V_i$ 和 $V_j$ 之间）由完全位于原始三角形内的线段组成。因此，从这种构造中导出的几何因子，例如这些界面线段的长度，总是正的。这确保了所得到的离散算子（例如，拉普拉斯算子的刚度矩阵）具有正的非对角元（或根据符号约定为负，但根本上对应于物理上正确的耦合）。此性质通常与M-矩阵性质相关，它保证了离散极值原理的满足，并带来了即使在非德劳内或质量差的网格上也能保持鲁棒和稳定的数值方案。提及三角形的高指向了其他构造方法，如垂心对偶，该方法也可使用但有其自身的限制（例如，要求锐角三角剖分）以确保正性；而重心对偶则具有更普遍的鲁棒性。",
            "answer": "$$\n\\boxed{-0.3768}\n$$"
        }
    ]
}