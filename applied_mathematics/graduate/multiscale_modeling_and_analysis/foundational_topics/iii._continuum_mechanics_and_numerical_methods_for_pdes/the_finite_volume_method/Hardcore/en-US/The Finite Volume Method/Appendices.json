{
    "hands_on_practices": [
        {
            "introduction": "The first step in applying the Finite Volume Method (FVM) is translating a continuous partial differential equation into a discrete algebraic system that a computer can solve. This foundational exercise guides you through this crucial process for a one-dimensional diffusion-reaction problem. By integrating the governing equation over control volumes and approximating the fluxes, you will construct the coefficient matrix $[A]$ for the resulting system of linear equations, a core skill for any computational practitioner. ",
            "id": "1749401",
            "problem": "Consider the one-dimensional, steady-state transport of a chemical species in a narrow, quiescent fluid channel of length $L$. The concentration of the species, denoted by $\\phi(x)$, is governed by the diffusion equation:\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) + S = 0\n$$\nwhere $\\Gamma$ is the constant diffusion coefficient. The species undergoes a first-order chemical reaction, leading to a source/sink term $S$ that is a linear function of the local concentration:\n$$\nS = S_C + S_P \\phi\n$$\nHere, $S_C$ and $S_P$ are constant coefficients.\n\nThe channel extends from $x=0$ to $x=L$. The concentrations at the boundaries are held constant at known values: $\\phi(0) = \\phi_A$ and $\\phi(L) = \\phi_B$.\n\nTo solve for the concentration profile, the domain is discretized into a uniform grid with five equally-spaced nodes: $x_0, x_1, x_2, x_3, x_4$, where $x_0=0$ and $x_4=L$. The concentrations at the three internal nodes, $\\phi(x_1) \\equiv \\phi_1$, $\\phi(x_2) \\equiv \\phi_2$, and $\\phi(x_3) \\equiv \\phi_3$, are unknown.\n\nApplying a central-differencing-based finite volume method to the governing equation at each internal node results in a system of three linear algebraic equations for the three unknown concentrations. This system can be written in matrix form as $[A][\\Phi] = [b]$, where $[\\Phi]$ is the column vector of unknown concentrations, $[\\Phi] = \\begin{pmatrix} \\phi_1  \\phi_2  \\phi_3 \\end{pmatrix}^T$.\n\nDetermine the $3 \\times 3$ coefficient matrix $[A]$. Your answer should be expressed in terms of $\\Gamma$, $L$, and $S_P$.",
            "solution": "The governing equation with constant diffusion coefficient is\n$$\n\\Gamma \\frac{d^{2}\\phi}{dx^{2}} + S_C + S_P \\phi = 0.\n$$\nDiscretize the domain into five equally spaced nodes with spacing $h = \\frac{L}{4}$. Using a finite volume method on a control volume of width $h$ around an internal node $i \\in \\{1,2,3\\}$, integrate the equation over the control volume and approximate face gradients by central differences:\n$$\n\\Gamma \\left[\\left.\\frac{d\\phi}{dx}\\right|_{e} - \\left.\\frac{d\\phi}{dx}\\right|_{w}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\nwith\n$$\n\\left.\\frac{d\\phi}{dx}\\right|_{e} \\approx \\frac{\\phi_{i+1} - \\phi_i}{h}, \\qquad \\left.\\frac{d\\phi}{dx}\\right|_{w} \\approx \\frac{\\phi_i - \\phi_{i-1}}{h}.\n$$\nSubstituting these into the balance gives\n$$\n\\Gamma \\left[\\frac{\\phi_{i+1} - \\phi_i}{h} - \\frac{\\phi_i - \\phi_{i-1}}{h}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\nwhich simplifies to\n$$\n\\frac{\\Gamma}{h}\\phi_{i-1} + \\left(-\\frac{2\\Gamma}{h} + S_P h\\right)\\phi_i + \\frac{\\Gamma}{h}\\phi_{i+1} = - S_C h.\n$$\nRearranging into the standard linear-system form $[A][\\Phi]=[b]$, move neighbor terms to the left-hand side and the constant source and boundary contributions to the right-hand side. The finite-volume coefficients for any internal node are\n$$\na_W = \\frac{\\Gamma}{h}, \\qquad a_E = \\frac{\\Gamma}{h}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h.\n$$\nFor the $3 \\times 3$ matrix acting on $[\\Phi] = (\\phi_1,\\phi_2,\\phi_3)^{T}$, the rows correspond to nodes $i=1,2,3$. For $i=1$, the west neighbor is the boundary node $\\phi_0=\\phi_A$ (moved to the right-hand side), so only $\\phi_1$ and $\\phi_2$ appear on the left. For $i=2$, both neighbors are unknowns. For $i=3$, the east neighbor is the boundary node $\\phi_4=\\phi_B$ (moved to the right-hand side). Substituting $h=\\frac{L}{4}$ gives\n$$\na_W = a_E = \\frac{\\Gamma}{h} = \\frac{4\\Gamma}{L}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h = \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}.\n$$\nTherefore, the coefficient matrix is\n$$\n[A] =\n\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_P L}{4}  -\\frac{4\\Gamma}{L}  0 \\\\\n-\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}  -\\frac{4\\Gamma}{L} \\\\\n0  -\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}  -\\frac{4\\Gamma}{L}  0 \\\\\n-\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}  -\\frac{4\\Gamma}{L} \\\\\n0  -\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "While discretization provides a path to a solution, not all schemes are created equal. This practice explores a classic pitfall in computational fluid dynamics: the failure of central differencing for convection-dominated flows. By analyzing the 1D convection-diffusion equation at a high Péclet number, you will uncover how a seemingly intuitive scheme can generate non-physical oscillations, providing deep insight into the critical concepts of numerical stability and the need for specialized upwind schemes. ",
            "id": "3818511",
            "problem": "Consider the one-dimensional steady convection–diffusion equation with constant material properties on the interval $[0,L]$,\n$$\\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho u \\frac{d\\phi}{dx} = 0,$$\nsubject to Dirichlet boundary conditions $\\phi(0) = 1$ and $\\phi(L) = 0$, where $\\Gamma$ is the diffusion coefficient, $\\rho$ is the density, and $u > 0$ is the uniform velocity. Assume a uniform mesh of control volumes of width $\\Delta x$ and constant cross-sectional area $A$. Let $D = \\Gamma A / \\Delta x$ denote the diffusive conductance and $F = \\rho u A$ denote the convective mass flux. The dimensionless Péclet number is defined as $\\mathrm{Pe} = F / D$.\n\nUsing the Finite Volume Method (FVM), discretize the equation on the interior control volumes by enforcing conservation of diffusive and convective fluxes through the west and east faces. For the diffusive flux, use the standard two-point approximation. For the convective flux, use central interpolation for face values. Derive the homogeneous linear recurrence relation governing interior cell values $\\phi_i$ on the uniform grid and analyze its characteristic factors. Then, provide a concrete counterexample corresponding to a high Péclet number case by evaluating the nontrivial characteristic factor for $\\mathrm{Pe} = 4$.\n\nReport the value of this characteristic factor as a pure number. No rounding is required.",
            "solution": "The governing steady one-dimensional convection–diffusion equation with constant coefficients is\n$$\\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho u \\frac{d\\phi}{dx} = 0.$$\nIn the Finite Volume Method (FVM), we integrate this equation over a control volume centered at index $i$ with faces located at $x_{w}$ and $x_{e}$, apply the divergence theorem, and enforce that the net flux through the faces is zero in steady state. This is equivalent to `net diffusive flux out` - `net convective flux out` = 0.\nOn a uniform mesh with spacing $\\Delta x$, the standard two-point approximation for the net diffusive flux out of the volume is\n$$\\Big[-\\Gamma A \\frac{d\\phi}{dx}\\Big]_{w}^{e} \\approx -\\Gamma A \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} - \\Big(-\\Gamma A \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x}\\Big) = \\Gamma A \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{\\Delta x} = D(\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}),$$\nwhere $D = \\Gamma A/\\Delta x$ is the diffusive conductance. The net convective flux out of the volume is $[\\rho u A \\phi]_w^e = F\\phi_e - F\\phi_w$. Using central interpolation for face values,\n$$\\phi_w \\approx \\frac{\\phi_{i-1} + \\phi_i}{2}, \\qquad \\phi_e \\approx \\frac{\\phi_i + \\phi_{i+1}}{2},$$\nthis term becomes\n$$F\\left(\\frac{\\phi_i + \\phi_{i+1}}{2} - \\frac{\\phi_{i-1} + \\phi_i}{2}\\right) = \\frac{F}{2}(\\phi_{i+1} - \\phi_{i-1}).$$\nImposing the flux balance for the interior control volume $i$ yields\n$$D(\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}) - \\frac{F}{2}(\\phi_{i+1} - \\phi_{i-1}) = 0.$$\nRearranging, we obtain the homogeneous linear recurrence relation\n$$(D + \\frac{F}{2})\\phi_{i-1} - 2D\\,\\phi_i + (D - \\frac{F}{2})\\phi_{i+1} = 0.$$\nIt is convenient to solve for $\\phi_{i+1}$ in terms of $\\phi_i$ and $\\phi_{i-1}$:\n$$(D - \\frac{F}{2})\\phi_{i+1} = 2D\\,\\phi_i - (D + \\frac{F}{2})\\phi_{i-1},$$\n$$\\phi_{i+1} = \\frac{2D}{D - \\frac{F}{2}}\\,\\phi_i - \\frac{D + \\frac{F}{2}}{D - \\frac{F}{2}}\\,\\phi_{i-1}.$$\nIntroduce the dimensionless parameter\n$$r = \\frac{F}{2D} = \\frac{\\mathrm{Pe}}{2},$$\nto write\n$$\\phi_{i+1} = \\frac{2}{1 - r}\\,\\phi_i - \\frac{1 + r}{1 - r}\\,\\phi_{i-1}.$$\nAssuming a mode of the form $\\phi_i = z^i$, the characteristic equation is\n$$z^2 - \\frac{2}{1 - r}z + \\frac{1 + r}{1 - r} = 0.$$\nThe discriminant is\n$$\\Delta = \\left(\\frac{2}{1 - r}\\right)^2 - 4\\frac{1 + r}{1 - r} = \\frac{4}{(1 - r)^2} - \\frac{4(1 + r)}{1 - r} = \\frac{4 - 4(1 - r^2)}{(1 - r)^2} = \\frac{4r^2}{(1 - r)^2},$$\nso the two characteristic factors are\n$$z = \\frac{\\frac{2}{1 - r} \\pm \\frac{2r}{1 - r}}{2} = \\frac{1 \\pm r}{1 - r}.$$\nThus,\n$$z_1 = \\frac{1 + r}{1 - r}, \\qquad z_2 = 1.$$\nThe factor $z_2 = 1$ corresponds to the neutral mode, while $z_1$ is the nontrivial mode governed by the interplay of convection and diffusion under the chosen central interpolation. For high Péclet numbers, $r = \\mathrm{Pe}/2 > 1$, the denominator $1 - r$ is negative and $z_1$ becomes negative, signaling nonphysical oscillations (sign-alternating behavior) in the discrete solution.\n\nTo provide a concrete counterexample, set $\\mathrm{Pe} = 4$, which implies $r = \\mathrm{Pe}/2 = 2$. Then\n$$z_1 = \\frac{1 + r}{1 - r} = \\frac{1 + 2}{1 - 2} = \\frac{3}{-1} = -3.$$\nThis negative characteristic factor demonstrates the non-monotone nature of the central flux discretization at high Péclet number and explains the emergence of nonphysical oscillations in the discrete solution.",
            "answer": "$$\\boxed{-3}$$"
        },
        {
            "introduction": "To tackle real-world engineering problems with complex geometries, FVM must be applied on unstructured meshes where simple flux approximations are no longer valid. This advanced exercise introduces a robust and widely used technique: least-squares gradient reconstruction. You will derive the normal equations for this method and analyze their conditioning, revealing the fundamental link between mesh quality, numerical stability, and the accuracy of the gradient calculation on irregular grids. ",
            "id": "3818526",
            "problem": "Consider a scalar field $\\phi(\\boldsymbol{x})$ defined on a two-dimensional domain discretized by a cell-centered Finite Volume Method (FVM). Let cell $i$ have geometric center at $\\boldsymbol{x}_i \\in \\mathbb{R}^{2}$ and a set of neighboring cells indexed by $\\mathcal{N}(i)$ with centers $\\boldsymbol{x}_j$, and denote $\\boldsymbol{r}_{ij} = \\boldsymbol{x}_j - \\boldsymbol{x}_i$. Assume that the available discrete data are the cell-centered values $\\phi_j$ for $j \\in \\{i\\} \\cup \\mathcal{N}(i)$, and that local smoothness permits a first-order Taylor expansion of $\\phi$ about $\\boldsymbol{x}_i$. \n\nStarting from the Taylor expansion as a fundamental base, construct a least-squares gradient reconstruction $\\nabla \\phi_i$ at cell $i$ using neighboring cell values. Specifically, define a Weighted Least Squares (WLS) objective that penalizes the mismatch between the linearized differences $\\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij}$ and the observed differences $\\phi_j - \\phi_i$, with diagonal weights $w_{ij}  0$. Derive the normal equations for the minimizer and express $\\nabla \\phi_i$ explicitly in terms of $\\{\\boldsymbol{r}_{ij}\\}$, $\\{\\phi_j - \\phi_i\\}$, and $\\{w_{ij}\\}$.\n\nThen, analyze the conditioning of the resulting normal equations on irregular meshes by considering the $2$-norm condition number of the symmetric positive definite normal matrix. For a specific irregular configuration in two dimensions with equal weights $w_{ij} = 1$, let the neighbor offsets be\n$\\boldsymbol{r}_{i1} = (1, 0)$, $\\boldsymbol{r}_{i2} = (-1, 0)$, and $\\boldsymbol{r}_{i3} = (0, 0.2)$. Compute the $2$-norm condition number of the normal matrix for this configuration, defined as the ratio of its largest to smallest eigenvalue. Express the final answer as a single real number. No rounding is required, and no units should be used in your final answer.",
            "solution": "The goal is to reconstruct the gradient $\\nabla \\phi_i$ in a cell-centered Finite Volume Method (FVM) using neighboring cell values under the assumption of local smoothness. The fundamental starting point is the first-order Taylor expansion of $\\phi$ about $\\boldsymbol{x}_i$:\n$$\n\\phi(\\boldsymbol{x}_j) \\approx \\phi(\\boldsymbol{x}_i) + \\nabla \\phi(\\boldsymbol{x}_i) \\cdot (\\boldsymbol{x}_j - \\boldsymbol{x}_i) = \\phi_i + \\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij},\n$$\nwhere $\\phi_i$ denotes $\\phi(\\boldsymbol{x}_i)$, and similarly for $\\phi_j$. Rearranging yields the linear surrogate for the neighbor differences:\n$$\n\\phi_j - \\phi_i \\approx \\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij}.\n$$\n\nTo construct a Weighted Least Squares (WLS) estimator, define the residual for each neighbor $j \\in \\mathcal{N}(i)$ as\n$$\n\\varepsilon_{ij}(\\nabla \\phi_i) = \\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij} - (\\phi_j - \\phi_i).\n$$\nLet $w_{ij} > 0$ be prescribed diagonal weights, which may encode geometric or multiscale considerations (for example, face areas, distances, or local anisotropy). The WLS objective is\n$$\nJ(\\nabla \\phi_i) = \\sum_{j \\in \\mathcal{N}(i)} w_{ij} \\left( \\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij} - (\\phi_j - \\phi_i) \\right)^{2}.\n$$\nIntroduce the matrix-vector notation. In two dimensions, write the unknown gradient as a column vector\n$$\n\\boldsymbol{g}_i = \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\nabla \\phi_i.\n$$\nDefine the design matrix $A \\in \\mathbb{R}^{m \\times 2}$ (with $m = |\\mathcal{N}(i)|$) whose $j$-th row is $\\boldsymbol{r}_{ij}^{\\top}$:\n$$\nA = \\begin{pmatrix} \\boldsymbol{r}_{i1}^{\\top} \\\\ \\boldsymbol{r}_{i2}^{\\top} \\\\ \\vdots \\\\ \\boldsymbol{r}_{im}^{\\top} \\end{pmatrix}.\n$$\nDefine the data difference vector $b \\in \\mathbb{R}^{m}$ whose $j$-th entry is $\\phi_j - \\phi_i$:\n$$\nb = \\begin{pmatrix} \\phi_1 - \\phi_i \\\\ \\phi_2 - \\phi_i \\\\ \\vdots \\\\ \\phi_m - \\phi_i \\end{pmatrix}.\n$$\nLet $W \\in \\mathbb{R}^{m \\times m}$ be a diagonal matrix with $W_{jj} = w_{ij}$. The objective can be written as\n$$\nJ(\\boldsymbol{g}_i) = \\left\\| W^{1/2} (A \\boldsymbol{g}_i - b) \\right\\|_{2}^{2}.\n$$\nThe normal equations for the minimizer are obtained by setting the gradient of $J$ with respect to $\\boldsymbol{g}_i$ to zero:\n$$\n\\nabla_{\\boldsymbol{g}_i} J = 2 A^{\\top} W (A \\boldsymbol{g}_i - b) = \\boldsymbol{0}.\n$$\nHence the normal equations are\n$$\nA^{\\top} W A \\, \\boldsymbol{g}_i = A^{\\top} W b.\n$$\nAssuming $A$ has full column rank (i.e., the neighbor offsets $\\{\\boldsymbol{r}_{ij}\\}$ span $\\mathbb{R}^{2}$) and $W$ is positive diagonal, the symmetric matrix $A^{\\top} W A$ is positive definite and invertible. The explicit WLS gradient reconstruction is then\n$$\n\\boldsymbol{g}_i = (A^{\\top} W A)^{-1} A^{\\top} W b.\n$$\n\nTo analyze conditioning, note that the conditioning of the normal equations is governed by the symmetric positive definite matrix\n$$\nM := A^{\\top} W A = \\sum_{j \\in \\mathcal{N}(i)} w_{ij} \\, \\boldsymbol{r}_{ij} \\boldsymbol{r}_{ij}^{\\top}.\n$$\nIn two dimensions, write $\\boldsymbol{r}_{ij} = (x_j, y_j)$ for brevity. Then\n$$\nM = \\begin{pmatrix}\n\\sum_{j} w_{ij} x_j^{2}  \\sum_{j} w_{ij} x_j y_j \\\\\n\\sum_{j} w_{ij} x_j y_j  \\sum_{j} w_{ij} y_j^{2}\n\\end{pmatrix} = \\begin{pmatrix}\nS_{xx}  S_{xy} \\\\\nS_{xy}  S_{yy}\n\\end{pmatrix}.\n$$\nThe $2$-norm condition number of $M$ is\n$$\n\\kappa_{2}(M) = \\frac{\\lambda_{\\max}(M)}{\\lambda_{\\min}(M)},\n$$\nwhere $\\lambda_{\\max}(M)$ and $\\lambda_{\\min}(M)$ are the largest and smallest eigenvalues of $M$. For $2 \\times 2$ symmetric matrices, the eigenvalues can be expressed in terms of the trace and determinant:\n$$\n\\lambda_{\\pm} = \\frac{\\operatorname{tr}(M) \\pm \\sqrt{\\operatorname{tr}(M)^{2} - 4 \\det(M)}}{2}.\n$$\nMesh irregularity and anisotropy manifest themselves in the distribution of neighbor offsets $\\boldsymbol{r}_{ij}$. If the offsets cluster along a line or have highly unbalanced magnitudes in orthogonal directions, then one of $S_{xx}$ or $S_{yy}$ (or an appropriate rotated variant when $S_{xy} \\neq 0$) becomes small, which drives $\\lambda_{\\min}(M)$ toward zero and inflates $\\kappa_{2}(M)$, leading to poor conditioning of the normal equations and sensitivity in the gradient reconstruction.\n\nWe now compute $\\kappa_{2}(M)$ for the specified irregular configuration with equal weights $w_{ij} = 1$ and neighbor offsets\n$$\n\\boldsymbol{r}_{i1} = (1, 0), \\quad \\boldsymbol{r}_{i2} = (-1, 0), \\quad \\boldsymbol{r}_{i3} = (0, 0.2).\n$$\nCompute the sums:\n$$\nS_{xx} = 1^{2} + (-1)^{2} + 0^{2} = 2, \\quad S_{yy} = 0^{2} + 0^{2} + (0.2)^{2} = 0.04, \\quad S_{xy} = (1)(0) + (-1)(0) + (0)(0.2) = 0.\n$$\nThus\n$$\nM = \\begin{pmatrix} 2  0 \\\\ 0  0.04 \\end{pmatrix}.\n$$\nSince $M$ is diagonal, its eigenvalues are the diagonal entries:\n$$\n\\lambda_{\\max}(M) = 2, \\quad \\lambda_{\\min}(M) = 0.04.\n$$\nTherefore, the $2$-norm condition number is\n$$\n\\kappa_{2}(M) = \\frac{2}{0.04} = 50.\n$$\nThis large value reflects the pronounced anisotropy in the neighbor offsets, with strong sampling along the $x$-direction and weak sampling along the $y$-direction, which is typical of irregular meshes exhibiting poor directional coverage and yields an ill-conditioned normal system for the gradient reconstruction.",
            "answer": "$$\\boxed{50}$$"
        }
    ]
}