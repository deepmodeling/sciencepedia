{
    "hands_on_practices": [
        {
            "introduction": "分析有限差分格式的第一步是评估其相容性——即离散算子在多大程度上逼近其对应的连续算子。本练习超越了典型的泰勒级数展开，要求您为一个常用的二阶导数模板推导精确的局部截断误差 (Local Truncation Error, LTE)。通过运用基本的三角恒等式，您将对一个谐波函数的逼近误差获得更深刻的分析性理解，而无需假设步长$h$很小。",
            "id": "3817950",
            "problem": "考虑一个一维标量场 $u(x)$，它在多尺度模型中代表宏观尺度上的单个已解析谐波模式。该场在步长为 $h  0$ 的均匀网格 $x_{j} = x_{0} + j h$ 上进行采样，并使用有限差分法 (FDM) 中的中心差分算子来近似其二阶导数，\n$$\nD^{2}u(x_{i}) \\equiv \\frac{u_{i+1} - 2 u_{i} + u_{i-1}}{h^{2}},\n$$\n其中 $u_{j} = u(x_{j})$。在一致性分析的背景下，局部截断误差 (LTE) 定义为作用于精确场的离散算子与在同一点上求值的相应连续算子之差，即\n$$\nT_{i}(h) \\equiv D^{2}u(x_{i}) - \\frac{d^{2}u}{dx^{2}}(x_{i}).\n$$\n从该定义出发，仅使用三角函数的基本恒等式和精确微分，推导当 $u(x) = \\sin(x)$ 时 $T_{i}(h)$ 的闭式解析表达式，且不假设 $h$ 是小量。最终答案必须明确表示为 $x_{i}$ 和 $h$ 的函数。不需要进行数值近似或四舍五入，也不涉及物理单位。最终答案必须是单一的解析表达式。",
            "solution": "问题陈述需要进行验证。\n\n### 步骤 1：提取已知条件\n- **网格：** 由 $x_{j} = x_{0} + j h$ 定义的均匀网格，步长为 $h  0$。\n- **场和记法：** 一维标量场 $u(x)$，其离散采样值为 $u_{j} = u(x_{j})$。\n- **有限差分算子：** 二阶中心差分算子由 $D^{2}u(x_{i}) \\equiv \\frac{u_{i+1} - 2 u_{i} + u_{i-1}}{h^{2}}$ 给出。\n- **局部截断误差 (LTE) 定义：** LTE 定义为 $T_{i}(h) \\equiv D^{2}u(x_{i}) - \\frac{d^{2}u}{dx^{2}}(x_{i})$。\n- **特定场：** 需对函数 $u(x) = \\sin(x)$ 进行分析。\n- **目标：** 推导 $T_{i}(h)$ 的闭式解析表达式，作为 $x_{i}$ 和 $h$ 的显式函数。\n- **约束：** 推导过程必须仅使用基本三角恒等式和精确微分，且不假设 $h$ 是小量。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学和数学上是合理的。它提出了一个数值分析领域的标准且定义明確的练习，具体涉及有限差分法的一致性分析。所有术语都得到了精确定义，所需任务明确无误。该问题是自洽的，没有矛盾、伪科学或主观论断。避免使用小 $h$ 近似（即泰勒级数展开）的约束，使得该问题成为一个使用精确恒等式进行解析操作的严格检验，这是一项有效且具有指导意义的任务。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将进行求解推导。\n\n推导过程如下。我们从局部截断误差 $T_{i}(h)$ 的定义开始：\n$$\nT_{i}(h) = D^{2}u(x_{i}) - \\frac{d^{2}u}{dx^{2}}(x_{i})\n$$\n问题指定函数为 $u(x) = \\sin(x)$。我们将针对此特定函数计算 LTE 定义中的每一项。\n\n首先，我们计算涉及离散算子 $D^{2}u(x_{i})$ 的项。根据定义：\n$$\nD^{2}u(x_{i}) = \\frac{u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})}{h^{2}}\n$$\n代入 $u(x) = \\sin(x)$ 并使用网格定义 $x_j = x_0 + jh$：\n$u(x_i) = \\sin(x_i)$\n$u(x_{i+1}) = u(x_i + h) = \\sin(x_i + h)$\n$u(x_{i-1}) = u(x_i - h) = \\sin(x_i - h)$\n\n离散算子的表达式变为：\n$$\nD^{2}u(x_{i}) = \\frac{\\sin(x_i + h) - 2\\sin(x_i) + \\sin(x_i - h)}{h^{2}}\n$$\n我们可以通过组合第一项和第三项，并应用和差化积三角恒等式 $\\sin(A) + \\sin(B) = 2\\sin\\left(\\frac{A+B}{2}\\right)\\cos\\left(\\frac{A-B}{2}\\right)$ 来化简分子。令 $A = x_i + h$ 且 $B = x_i - h$。\n$$\n\\sin(x_i + h) + \\sin(x_i - h) = 2\\sin\\left(\\frac{(x_i+h)+(x_i-h)}{2}\\right)\\cos\\left(\\frac{(x_i+h)-(x_i-h)}{2}\\right)\n$$\n$$\n= 2\\sin\\left(\\frac{2x_i}{2}\\right)\\cos\\left(\\frac{2h}{2}\\right) = 2\\sin(x_i)\\cos(h)\n$$\n将此结果代回 $D^{2}u(x_i)$ 的分子中：\n$$\n\\sin(x_i + h) - 2\\sin(x_i) + \\sin(x_i - h) = \\left[ \\sin(x_i + h) + \\sin(x_i - h) \\right] - 2\\sin(x_i)\n$$\n$$\n= 2\\sin(x_i)\\cos(h) - 2\\sin(x_i) = 2\\sin(x_i)\\left( \\cos(h) - 1 \\right)\n$$\n为了进一步化简，我们使用余弦的半角公式，可写作 $\\cos(h) - 1 = -2\\sin^{2}\\left(\\frac{h}{2}\\right)$。此恒等式由 $\\cos(2\\theta) = 1 - 2\\sin^{2}(\\theta)$ 在 $\\theta = h/2$ 时导出。\n分子变为：\n$$\n2\\sin(x_i) \\left( -2\\sin^{2}\\left(\\frac{h}{2}\\right) \\right) = -4\\sin(x_i)\\sin^{2}\\left(\\frac{h}{2}\\right)\n$$\n因此，离散算子项为：\n$$\nD^{2}u(x_{i}) = \\frac{-4\\sin(x_i)\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} = \\left( \\frac{-4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\right) \\sin(x_i)\n$$\n接下来，我们计算连续算子项 $\\frac{d^{2}u}{dx^{2}}(x_{i})$。我们对 $u(x) = \\sin(x)$ 进行精确微分：\n一阶导数: $\\frac{du}{dx} = \\frac{d}{dx}(\\sin(x)) = \\cos(x)$\n二阶导数: $\\frac{d^{2}u}{dx^{2}} = \\frac{d}{dx}(\\cos(x)) = -\\sin(x)$\n在点 $x_i$ 处求值：\n$$\n\\frac{d^{2}u}{dx^{2}}(x_{i}) = -\\sin(x_i)\n$$\n最后，我们将离散和连续的结果都代回 LTE 的定义中：\n$$\nT_{i}(h) = D^{2}u(x_{i}) - \\frac{d^{2}u}{dx^{2}}(x_{i}) = \\left( \\frac{-4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\sin(x_i) \\right) - \\left( -\\sin(x_i) \\right)\n$$\n$$\nT_{i}(h) = \\sin(x_i) - \\frac{4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\sin(x_i)\n$$\n提取公因式 $\\sin(x_i)$，我们得到局部截断误差的最终闭式解析表达式：\n$$\nT_{i}(h) = \\sin(x_i) \\left( 1 - \\frac{4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\right)\n$$\n该表达式仅为 $x_i$ 和 $h$ 的函数，并且是在没有任何小 $h$ 近似的情况下推导出来的，满足了问题的所有要求。",
            "answer": "$$\n\\boxed{\\sin(x_i) \\left( 1 - \\frac{4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\right)}\n$$"
        },
        {
            "introduction": "有限差分法的基石之一是其将连续微分算子转化为离散矩阵表示的能力。这种强大的技术将复杂的微分方程问题转变为可解的线性代数问题。在此练习中，您将离散化一个典型的一维特征值问题，将微分方程 $-\\frac{d^2 u}{dx^2} = \\lambda u$ 转化为 $A\\mathbf{u} = \\lambda \\mathbf{u}$ 形式的矩阵特征值问题，这是数值求解特征值和特征函数的关键一步。",
            "id": "2141791",
            "problem": "考虑定义在区间 $[0, \\pi]$ 上的函数 $u(x)$ 的一维特征值问题：\n$$\n- \\frac{d^2 u}{dx^2} = \\lambda u(x)\n$$\n边界条件为 $u(0) = 0$ 和 $u(\\pi) = 0$。这个连续问题可以使用有限差分法近似为一个离散矩阵特征值问题。\n\n您的任务是使用均匀网格对区域 $[0, \\pi]$ 进行离散化。该网格应包含两个边界点和 $N=3$ 个内部点，总共形成5个网格点和4个等长子区间。设网格点表示为 $x_j = j h$，其中 $j=0, 1, 2, 3, 4$，$h$ 为步长。函数在网格点 $x_j$ 处的值表示为 $u_j = u(x_j)$。\n\n使用二阶中心差分公式在每个内部网格点近似二阶导数 $u''(x)$：\n$$\n\\frac{d^2 u}{dx^2} \\bigg|_{x=x_j} \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}\n$$\n通过应用此近似，将原始微分方程转换为关于未知内部值 $\\mathbf{u} = [u_1, u_2, u_3]^T$ 的线性方程组。该方程组可以写成矩阵特征值问题 $A\\mathbf{u} = \\lambda \\mathbf{u}$ 的形式。\n\n确定矩阵 $A$，并计算其最小特征值，结果四舍五入至四位有效数字。",
            "solution": "我们将区间 $[0,\\pi]$ 离散化，设 $N=3$ 个内部点，边界点为 $x_{0}=0$ 和 $x_{4}=\\pi$。均匀步长为 $h=\\pi/4$，网格点为 $x_{j}=jh$，其中 $j=0,1,2,3,4$。设 $u_{j}=u(x_{j})$，其中 $u_{0}=0$ 且 $u_{4}=0$。\n\n用中心差分近似 $u''(x_{j})$，\n$$\n\\frac{d^{2}u}{dx^{2}}\\bigg|_{x=x_{j}} \\approx \\frac{u_{j+1}-2u_{j}+u_{j-1}}{h^{2}},\n$$\n微分方程 $-u''=\\lambda u$ 在内部节点 $j=1,2,3$ 处变为\n$$\n-\\frac{u_{j+1}-2u_{j}+u_{j-1}}{h^{2}}=\\lambda u_{j},\n$$\n或等价地，\n$$\n\\frac{-u_{j-1}+2u_{j}-u_{j+1}}{h^{2}}=\\lambda u_{j}.\n$$\n对于 $\\mathbf{u}=[u_{1},u_{2},u_{3}]^{T}$，其矩阵形式为特征值问题 $A\\mathbf{u}=\\lambda \\mathbf{u}$，其中\n$$\nA=\\frac{1}{h^{2}}\\begin{pmatrix}\n2   -1  0\\\\\n-1  2   -1\\\\\n0   -1  2\n\\end{pmatrix}, \\quad h=\\frac{\\pi}{4}.\n$$\n\n$3\\times 3$ 的三对角Toeplitz矩阵 $T=\\begin{pmatrix}\n2   -1  0\\\\\n-1  2   -1\\\\\n0   -1  2\n\\end{pmatrix}$ 的特征值为\n$$\n\\mu_{k}=2-2\\cos\\!\\left(\\frac{k\\pi}{N+1}\\right), \\quad k=1,2,3,\n$$\n这是通过检验离散正弦模式 $v^{(k)}_{j}=\\sin\\!\\left(\\frac{kj\\pi}{N+1}\\right)$ 得到的，该模式满足 $Tv^{(k)}=\\mu_{k}v^{(k)}$ 以及在 $j=0$ 和 $j=N+1$ 处的齐次Dirichlet边界条件。\n\n因此，$A$ 的特征值为\n$$\n\\lambda_{k}=\\frac{1}{h^{2}}\\mu_{k}=\\frac{1}{h^{2}}\\left[2-2\\cos\\!\\left(\\frac{k\\pi}{4}\\right)\\right], \\quad k=1,2,3.\n$$\n当 $h=\\pi/4$ 时，可得 $1/h^{2}=16/\\pi^{2}$。最小特征值对应于 $k=1$：\n$$\n\\lambda_{\\min}=\\lambda_{1}=\\frac{16}{\\pi^{2}}\\left(2-2\\cos\\!\\left(\\frac{\\pi}{4}\\right)\\right)=\\frac{16}{\\pi^{2}}\\left(2-\\sqrt{2}\\right).\n$$\n数值上，将结果四舍五入到四位有效数字，\n$$\n\\lambda_{\\min}\\approx 0.9496.\n$$",
            "answer": "$$\\boxed{0.9496}$$"
        },
        {
            "introduction": "对于由守恒律主导的问题，数值格式本身能够守恒相关的物理量至关重要。否则可能导致非物理性的结果，尤其是在包含非均匀介质的多尺度模型中。本练习通过一个引人注目的例子展示了这一原则，揭示了一个看似合理但非守恒的有限差分格式，如何在一个含不连续系数的简单守恒律问题中，产生一个伪（不正确的）稳态解。",
            "id": "3817953",
            "problem": "考虑区间 $[0,1]$ 上的稳态一维守恒律 $\\frac{d}{dx}\\big(k(x)\\,f(u(x))\\big)=0$，其中 $f(u)=u^{2}$，非均匀系数 $k(x)$ 是分段常数：当 $0 \\leq x  \\frac{1}{2}$ 时，$k(x)=1$；当 $\\frac{1}{2}  x \\leq 1$ 时，$k(x)=2$。施加狄利克雷边界条件 $u(0)=1$ 和 $u(1)=\\frac{1}{\\sqrt{2}}$。精确连续稳态解必须满足通量守恒。现在构造一个间距为 $h=\\frac{1}{3}$ 的均匀网格，网格点为 $x_{i}=ih$，$i=0,1,2,3$，因此 $x_{0}=0$，$x_{1}=\\frac{1}{3}$，$x_{2}=\\frac{2}{3}$ 和 $x_{3}=1$。在此网格上，考虑在内部节点 $i=1,2$ 处的以下非守恒有限差分法（FDM）离散格式：\n$$R^{\\mathrm{nc}}_{i} \\equiv \\frac{k(x_{i})\\big(f(u_{i+1})-f(u_{i-1})\\big)}{2h}=0,$$\n其中 $u_{i}$ 是 $u(x_{i})$ 的近似值，$k(x_{i})$ 是在网格点上取值的点态系数。使用给定的边界值 $u_{0}=1$ 和 $u_{3}=\\frac{1}{\\sqrt{2}}$。计算此非守恒格式预测的、相对于精确连续稳态值的、在左侧内部网格点处的绝对误差\n$$E=\\left|u_{1}-u\\left(\\tfrac{1}{3}\\right)\\right|,$$\n。将最终答案表示为单个无单位的闭式表达式。无需四舍五入。",
            "solution": "该问题被认为是有效的，因为它在偏微分方程数值分析领域具有科学依据，是适定、客观且自洽的。求得唯一解所需的所有数据和定义均已提供。我们开始求解，求解过程包括三个主要部分：1. 确定精确连续解；2. 求解有限差分格式以获得数值解；3. 计算所要求的绝对误差。\n\n### 第一部分：精确连续解\n给定的稳态一维守恒律为\n$$ \\frac{d}{dx}\\big(k(x)\\,f(u(x))\\big) = 0 $$\n定义域为 $x \\in [0, 1]$。该方程意味着通量 $J(x) = k(x)f(u(x))$ 在整个定义域上必须是常数。\n$$ k(x)f(u(x)) = C $$\n其中 $C$ 是一个积分常数。给定通量函数 $f(u) = u^2$。因此，方程变为\n$$ k(x)u(x)^2 = C $$\n我们可以利用 $x=0$ 处的边界条件 $u(0)=1$ 来确定常数 $C$。在该点，系数 $k(x)$ 为 $k(0)=1$（因为 $0  \\frac{1}{2}$）。\n$$ C = k(0)u(0)^2 = 1 \\cdot (1)^2 = 1 $$\n因此，通量在整个定义域上是常数，其值为 $1$：\n$$ k(x)u(x)^2 = 1 $$\n现在我们可以在由分段常数系数 $k(x)$ 定义的两个子域中求出精确解 $u(x)$。\n\n对于区间 $0 \\leq x  \\frac{1}{2}$，我们有 $k(x)=1$。守恒律给出：\n$$ 1 \\cdot u(x)^2 = 1 \\implies u(x)^2 = 1 $$\n由于边界条件 $u(0)=1$ 是正的，我们取正根，得到该区间上的解为 $u(x)=1$。\n\n对于区间 $\\frac{1}{2}  x \\leq 1$，我们有 $k(x)=2$。守恒律给出：\n$$ 2 \\cdot u(x)^2 = 1 \\implies u(x)^2 = \\frac{1}{2} $$\n另一端的边界条件是 $u(1) = \\frac{1}{\\sqrt{2}}$，是正的。因此，我们必须取正根，得到该区间上的解为 $u(x)=\\frac{1}{\\sqrt{2}}$。\n\n精确连续稳态解 $u(x)$ 是一个分段函数：\n$$\nu(x) = \\begin{cases}\n1  \\text{if } 0 \\leq x  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  \\text{if } \\frac{1}{2}  x \\leq 1\n\\end{cases}\n$$\n问题要求计算网格点 $x_1 = \\frac{1}{3}$ 处的误差。由于 $0 \\leq \\frac{1}{3}  \\frac{1}{2}$，该点的精确值为\n$$ u\\left(\\frac{1}{3}\\right) = 1 $$\n\n### 第二部分：FDM 格式的数值解\n问题定义了一个间距为 $h=\\frac{1}{3}$ 的均匀网格，网格点为 $x_i = ih$，$i=0,1,2,3$。这给出了网格点 $x_0=0$，$x_1=\\frac{1}{3}$，$x_2=\\frac{2}{3}$ 和 $x_3=1$。边界值已给出：$u_0 = u(0) = 1$ 和 $u_3 = u(1) = \\frac{1}{\\sqrt{2}}$。\n\n指定的非守恒 FDM 离散格式应用于内部节点 $i=1,2$：\n$$ R^{\\mathrm{nc}}_{i} \\equiv \\frac{k(x_{i})\\big(f(u_{i+1})-f(u_{i-1})\\big)}{2h}=0 $$\n代入 $f(u)=u^2$，我们得到：\n$$ \\frac{k(x_{i})(u_{i+1}^2 - u_{i-1}^2)}{2h} = 0 $$\n由于 $h \\neq 0$ 且 $k(x)$ 在网格上严格为正，这在每个内部节点处简化为 $u_{i+1}^2 = u_{i-1}^2$。\n\n让我们写出 $i=1$ 和 $i=2$ 的方程：\n对于 $i=1$（在节点 $x_1 = \\frac{1}{3}$ 处）：\n系数为 $k(x_1) = k(\\frac{1}{3})$。由于 $\\frac{1}{3}  \\frac{1}{2}$，我们有 $k(\\frac{1}{3})=1$。该格式给出：\n$$ \\frac{1 \\cdot (u_2^2 - u_0^2)}{2h} = 0 \\implies u_2^2 = u_0^2 $$\n使用边界值 $u_0=1$，我们得到 $u_2^2 = 1^2 = 1$。\n\n对于 $i=2$（在节点 $x_2 = \\frac{2}{3}$ 处）：\n系数为 $k(x_2) = k(\\frac{2}{3})$。由于 $\\frac{2}{3} > \\frac{1}{2}$，我们有 $k(\\frac{2}{3})=2$。该格式给出：\n$$ \\frac{2 \\cdot (u_3^2 - u_1^2)}{2h} = 0 \\implies u_3^2 = u_1^2 $$\n使用边界值 $u_3=\\frac{1}{\\sqrt{2}}$，我们得到 $u_1^2 = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{1}{2}$。\n\n我们得到了一个关于两个未知数 $u_1$ 和 $u_2$ 的方程组：\n$$\n\\begin{cases}\nu_2^2 = 1 \\\\\nu_1^2 = \\frac{1}{2}\n\\end{cases}\n$$\n问题要求左侧内部网格点的数值解，即 $u_1$。从第二个方程，我们得到 $u_1 = \\pm\\frac{1}{\\sqrt{2}}$。鉴于边界条件是正的，通常假设数值解也保持为正。因此，我们选择正根：\n$$ u_1 = \\frac{1}{\\sqrt{2}} $$\n\n这个结果凸显了非守恒格式的失败。在 $x_1=\\frac{1}{3}$ 处的数值解 $u_1$ 取了定义域右侧部分的值，而精确解是 $1$。该格式未能正确处理系数 $k(x)$ 的间断性。\n\n### 第三部分：绝对误差计算\n左侧内部网格点 $x_1 = \\frac{1}{3}$ 处的绝对误差定义为 $E = |u_1 - u(\\frac{1}{3})|$。\n使用前几部分推导出的值：\n- 数值解为 $u_1 = \\frac{1}{\\sqrt{2}}$。\n- 精确解为 $u(\\frac{1}{3}) = 1$。\n\n因此，绝对误差为：\n$$ E = \\left| \\frac{1}{\\sqrt{2}} - 1 \\right| $$\n由于 $1 > \\frac{1}{\\sqrt{2}}$，绝对值内的表达式为负。计算绝对值得到：\n$$ E = 1 - \\frac{1}{\\sqrt{2}} $$\n这就是误差的最终闭式表达式。",
            "answer": "$$\\boxed{1-\\frac{1}{\\sqrt{2}}}$$"
        }
    ]
}