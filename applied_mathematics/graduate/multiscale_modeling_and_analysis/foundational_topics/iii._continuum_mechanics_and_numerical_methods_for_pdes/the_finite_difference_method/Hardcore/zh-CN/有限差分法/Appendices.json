{
    "hands_on_practices": [
        {
            "introduction": "有限差分法的核心思想之一是将连续的微分算子转化为离散的代数运算。这个练习将引导您完成这一基本转换过程，将一个一维的常微分方程特征值问题转化为一个矩阵特征值问题。通过亲手构建近似微分算子的矩阵，您将深入理解连续问题与离散系统之间的桥梁，这是利用计算方法求解微分方程的基石。",
            "id": "2141791",
            "problem": "考虑定义在区间 $[0, \\pi]$ 上的函数 $u(x)$ 的一维特征值问题：\n$$\n- \\frac{d^2 u}{dx^2} = \\lambda u(x)\n$$\n边界条件为 $u(0) = 0$ 和 $u(\\pi) = 0$。这个连续问题可以使用有限差分法近似为一个离散矩阵特征值问题。\n\n你的任务是使用均匀网格对区域 $[0, \\pi]$ 进行离散化。网格应包含两个边界点和 $N=3$ 个内部点，总共形成 5 个网格点和 4 个等长的子区间。设网格点为 $x_j = j h$，$j=0, 1, 2, 3, 4$，其中 $h$ 是步长。网格点 $x_j$ 处的函数值记为 $u_j = u(x_j)$。\n\n使用二阶中心差分公式来近似每个内部网格点处的二阶导数 $u''(x)$：\n$$\n\\frac{d^2 u}{dx^2} \\bigg|_{x=x_j} \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}\n$$\n通过应用此近似，将原始微分方程转换为关于未知内部值 $\\mathbf{u} = [u_1, u_2, u_3]^T$ 的线性方程组。该系统可以写成矩阵特征值问题 $A\\mathbf{u} = \\lambda \\mathbf{u}$ 的形式。\n\n确定矩阵 $A$ 并计算其最小特征值。报告这个最小特征值，保留四位有效数字。",
            "solution": "我们将区间 $[0,\\pi]$ 离散化，有 $N=3$ 个内部点以及位于 $x_{0}=0$ 和 $x_{4}=\\pi$ 的边界点。均匀步长为 $h=\\pi/4$，网格点为 $x_{j}=jh$，$j=0,1,2,3,4$。设 $u_{j}=u(x_{j})$，其中 $u_{0}=0$ 且 $u_{4}=0$。\n\n用中心差分近似 $u''(x_{j})$，\n$$\n\\frac{d^{2}u}{dx^{2}}\\bigg|_{x=x_{j}} \\approx \\frac{u_{j+1}-2u_{j}+u_{j-1}}{h^{2}},\n$$\n微分方程 $-u''=\\lambda u$ 在内部节点 $j=1,2,3$ 处变为\n$$\n-\\frac{u_{j+1}-2u_{j}+u_{j-1}}{h^{2}}=\\lambda u_{j},\n$$\n或者等价地，\n$$\n\\frac{-u_{j-1}+2u_{j}-u_{j+1}}{h^{2}}=\\lambda u_{j}.\n$$\n对于 $\\mathbf{u}=[u_{1},u_{2},u_{3}]^{T}$，其矩阵形式为特征值问题 $A\\mathbf{u}=\\lambda \\mathbf{u}$，其中\n$$\nA=\\frac{1}{h^{2}}\\begin{pmatrix}\n2  -1  0\\\\\n-1  2  -1\\\\\n0  -1  2\n\\end{pmatrix}, \\quad h=\\frac{\\pi}{4}.\n$$\n\n$3\\times 3$ 的三对角 Toeplitz 矩阵 $T=\\begin{pmatrix}\n2  -1  0\\\\\n-1  2  -1\\\\\n0  -1  2\n\\end{pmatrix}$ 的特征值为\n$$\n\\mu_{k}=2-2\\cos\\!\\left(\\frac{k\\pi}{N+1}\\right), \\quad k=1,2,3,\n$$\n这是通过测试离散正弦模 $v^{(k)}_{j}=\\sin\\!\\left(\\frac{kj\\pi}{N+1}\\right)$ 得到的，这些模在 $j=0$ 和 $j=N+1$ 处满足齐次 Dirichlet 边界条件，并且满足 $Tv^{(k)}=\\mu_{k}v^{(k)}$。\n\n因此，矩阵 $A$ 的特征值为\n$$\n\\lambda_{k}=\\frac{1}{h^{2}}\\mu_{k}=\\frac{1}{h^{2}}\\left[2-2\\cos\\!\\left(\\frac{k\\pi}{4}\\right)\\right], \\quad k=1,2,3.\n$$\n当 $h=\\pi/4$ 时，我们有 $1/h^{2}=16/\\pi^{2}$。最小的特征值对应于 $k=1$：\n$$\n\\lambda_{\\min}=\\lambda_{1}=\\frac{16}{\\pi^{2}}\\left(2-2\\cos\\!\\left(\\frac{\\pi}{4}\\right)\\right)=\\frac{16}{\\pi^{2}}\\left(2-\\sqrt{2}\\right).\n$$\n数值上，保留四位有效数字，\n$$\n\\lambda_{\\min}\\approx 0.9496.\n$$",
            "answer": "$$\\boxed{0.9496}$$"
        },
        {
            "introduction": "在求解含时演化问题（如热传导方程）时，空间步长和时间步长的选择并非随意的，它们共同决定了数值解的成败。本练习将带您探索前向时间中心空间（FTCS）格式的数值稳定性概念，您将使用一组特意违反稳定性条件的参数进行计算。通过观察计算中出现的非物理行为（例如负温度），您将直观地理解为何稳定性分析对于获得有意义的数值解至关重要。",
            "id": "2141740",
            "problem": "考虑一根长度为 $L=1.0$ m、热扩散系数为 $\\alpha = 1.0 \\text{ m}^2/\\text{s}$ 的细长均匀杆中的一维热流。杆中的温度分布 $u(x, t)$ 由热方程 $u_t = \\alpha u_{xx}$ 控制。杆的两端，即 $x=0$ 和 $x=L$ 处，保持在 $0$ K 的恒定温度。\n\n使用数值模拟来模拟一个实验。杆被离散化为一系列网格点 $x_j = j \\Delta x$，其中空间步长为 $\\Delta x=0.2$ m。在时间 $t=0$ 时，杆上各处的初始温度均为 $0$ K，除了一个局部热源在单个网格点 $x=0.4$ m 处瞬时将温度设置为 $100$ K。模拟以 $\\Delta t=0.024$ s 的时间步长向前推进。\n\n未来时间步的温度是根据当前时间步的温度，使用以下显式有限差分近似计算的：\n$$u(x, t+\\Delta t) \\approx u(x, t) + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\left[ u(x+\\Delta x, t) - 2u(x, t) + u(x-\\Delta x, t) \\right]$$\n\n使用此格式，计算在位置 $x=0.2$ m、时间 $t=3\\Delta t$ 时的温度。答案以开尔文为单位，并四舍五入到三位有效数字。",
            "solution": "我们在点 $x_{j}=j\\Delta x$ 处对杆进行离散化，其中 $\\Delta x=0.2$，因此 $j=0,1,2,3,4,5$ 对应于 $x=0,0.2,0.4,0.6,0.8,1.0$。狄利克雷边界条件规定，对于所有的 $n$，都有 $u_{0}^{n}=0$ 和 $u_{5}^{n}=0$。内部节点的显式格式为\n$$\nu_{j}^{n+1}=u_{j}^{n}+r\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\n其中 $r=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$。已知 $\\alpha=1$，$\\Delta t=0.024$，以及 $\\Delta x=0.2$，我们得到\n$$\nr=\\frac{1\\times 0.024}{(0.2)^{2}}=\\frac{0.024}{0.04}=0.6.\n$$\n初始条件为，除了 $u_{2}^{0}=100$ 外，对所有的 $j$ 都有 $u_{j}^{0}=0$。\n\n时间步 $n=0\\to 1$：\n$$\n\\begin{aligned}\nu_{1}^{1}=u_{1}^{0}+r(u_{2}^{0}-2u_{1}^{0}+u_{0}^{0})=0+0.6(100-0+0)=60,\\\\\nu_{2}^{1}=100+0.6(0-200+0)=100-120=-20,\\\\\nu_{3}^{1}=0+0.6(0-0+100)=60,\\\\\nu_{4}^{1}=0+0.6(0-0+0)=0.\n\\end{aligned}\n$$\n\n时间步 $n=1\\to 2$：\n$$\n\\begin{aligned}\nu_{1}^{2}=60+0.6\\left((-20)-2\\cdot 60+0\\right)=60+0.6(-140)=-24,\\\\\nu_{2}^{2}=-20+0.6\\left(60-2(-20)+60\\right)=-20+0.6(160)=76,\\\\\nu_{3}^{2}=60+0.6\\left(0-2\\cdot 60+(-20)\\right)=60+0.6(-140)=-24,\\\\\nu_{4}^{2}=0+0.6\\left(0-0+60\\right)=36.\n\\end{aligned}\n$$\n\n目标节点 $j=1$ 的时间步 $n=2\\to 3$：\n$$\nu_{1}^{3}=u_{1}^{2}+r(u_{2}^{2}-2u_{1}^{2}+u_{0}^{2})=-24+0.6(76-2(-24)+0)=-24+0.6(124)=50.4.\n$$\n\n因此，在 $x=0.2$ m 和 $t=3\\Delta t$ 处，温度为 $50.4$ K，保留三位有效数字后为 $50.4$。",
            "answer": "$$\\boxed{50.4}$$"
        },
        {
            "introduction": "对于源自物理守恒律的方程，离散格式的选择具有深远的影响，一个看似合理的格式如果不能在离散层面保持守恒性，可能会导致完全错误的物理结果。本练习通过一个具体的反例，揭示了一个“非守恒”有限差分格式在求解变系数守恒律问题时的根本缺陷。这个问题有力地证明了，即使是数值上一致的格式，如果不能正确地保持物理通量的守恒，尤其是在处理非均匀介质时，也会产生错误的稳态解，这是多尺度建模和分析中的一个关键教训。",
            "id": "3817953",
            "problem": "考虑区间 $[0,1]$ 上的稳态一维守恒律 $\\frac{d}{dx}\\big(k(x)\\,f(u(x))\\big)=0$，其中 $f(u)=u^{2}$，非均匀系数 $k(x)$ 为分段常数：当 $0 \\leq x  \\frac{1}{2}$ 时，$k(x)=1$；当 $\\frac{1}{2}  x \\leq 1$ 时，$k(x)=2$。施加狄利克雷边界条件 $u(0)=1$ 和 $u(1)=\\frac{1}{\\sqrt{2}}$。精确连续稳态解必须满足通量守恒。现在，构建一个步长为 $h=\\frac{1}{3}$ 的均匀网格，网格点为 $x_{i}=ih$（其中 $i=0,1,2,3$），因此 $x_{0}=0$，$x_{1}=\\frac{1}{3}$，$x_{2}=\\frac{2}{3}$，$x_{3}=1$。在此网格上，考虑内部节点 $i=1,2$ 处的以下非守恒有限差分法 (FDM) 离散格式：\n$$R^{\\mathrm{nc}}_{i} \\equiv \\frac{k(x_{i})\\big(f(u_{i+1})-f(u_{i-1})\\big)}{2h}=0,$$\n其中 $u_{i}$ 是 $u(x_{i})$ 的近似值，$k(x_{i})$ 是在网格点上取值的点值系数。使用给定的边界值 $u_{0}=1$ 和 $u_{3}=\\frac{1}{\\sqrt{2}}$。计算左侧内部网格点处的绝对误差，\n$$E=\\left|u_{1}-u\\left(\\tfrac{1}{3}\\right)\\right|,$$\n这是该非守恒格式相对于精确连续稳态值预测的误差。将最终答案表示为单个无单位的闭式表达式。无需四舍五入。",
            "solution": "该问题被认为是有效的，因为它在偏微分方程数值分析领域具有科学依据，是适定的、客观且自洽的。求得唯一解所需的所有数据和定义均已提供。我们按以下三个主要部分进行求解：1. 确定精确连续解；2. 求解有限差分格式以获得数值解；3. 计算所要求的绝对误差。\n\n### 第一部分：精确连续解\n给定的稳态一维守恒律为\n$$ \\frac{d}{dx}\\big(k(x)\\,f(u(x))\\big) = 0 $$\n其中定义域为 $x \\in [0, 1]$。该方程意味着通量 $J(x) = k(x)f(u(x))$ 在整个域上必须为常数。\n$$ k(x)f(u(x)) = C $$\n其中 $C$ 是一个积分常数。给定通量函数 $f(u) = u^2$。因此，方程变为\n$$ k(x)u(x)^2 = C $$\n我们可以利用 $x=0$ 处的边界条件 $u(0)=1$ 来确定常数 $C$。在该点，系数 $k(x)$ 为 $k(0)=1$（因为 $0  \\frac{1}{2}$）。\n$$ C = k(0)u(0)^2 = 1 \\cdot (1)^2 = 1 $$\n因此，通量在整个域上是值为 $1$ 的常数：\n$$ k(x)u(x)^2 = 1 $$\n现在，我们可以在由分段常数系数 $k(x)$ 定义的两个子域中求出精确解 $u(x)$。\n\n对于区间 $0 \\leq x  \\frac{1}{2}$，我们有 $k(x)=1$。守恒律给出：\n$$ 1 \\cdot u(x)^2 = 1 \\implies u(x)^2 = 1 $$\n由于边界条件 $u(0)=1$ 是正的，我们取正根，得到该区间上的解为 $u(x)=1$。\n\n对于区间 $\\frac{1}{2}  x \\leq 1$，我们有 $k(x)=2$。守恒律给出：\n$$ 2 \\cdot u(x)^2 = 1 \\implies u(x)^2 = \\frac{1}{2} $$\n另一端的边界条件是 $u(1) = \\frac{1}{\\sqrt{2}}$，是正的。因此，我们必须取正根，得到该区间上的解为 $u(x)=\\frac{1}{\\sqrt{2}}$。\n\n精确连续稳态解 $u(x)$ 是一个分段函数：\n$$\nu(x) = \\begin{cases}\n1  \\text{若 } 0 \\leq x  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  \\text{若 } \\frac{1}{2}  x \\leq 1\n\\end{cases}\n$$\n问题要求计算网格点 $x_1 = \\frac{1}{3}$ 处的误差。由于 $0 \\leq \\frac{1}{3}  \\frac{1}{2}$，该点的精确值为\n$$ u\\left(\\frac{1}{3}\\right) = 1 $$\n\n### 第二部分：FDM 格式的数值解\n问题定义了一个步长为 $h=\\frac{1}{3}$ 的均匀网格，网格点为 $x_i = ih$（其中 $i=0,1,2,3$）。这给出了网格点 $x_0=0$，$x_1=\\frac{1}{3}$，$x_2=\\frac{2}{3}$ 和 $x_3=1$。边界值已给定：$u_0 = u(0) = 1$ 和 $u_3 = u(1) = \\frac{1}{\\sqrt{2}}$。\n\n指定的非守恒 FDM 离散格式应用于内部节点 $i=1,2$：\n$$ R^{\\mathrm{nc}}_{i} \\equiv \\frac{k(x_{i})\\big(f(u_{i+1})-f(u_{i-1})\\big)}{2h}=0 $$\n代入 $f(u)=u^2$，我们得到：\n$$ \\frac{k(x_{i})(u_{i+1}^2 - u_{i-1}^2)}{2h} = 0 $$\n由于 $h \\neq 0$ 且 $k(x)$ 在网格上严格为正，这在每个内部节点处简化为 $u_{i+1}^2 = u_{i-1}^2$。\n\n让我们写出 $i=1$ 和 $i=2$ 的方程：\n对于 $i=1$（在节点 $x_1 = \\frac{1}{3}$ 处）：\n系数为 $k(x_1) = k(\\frac{1}{3})$。由于 $\\frac{1}{3}  \\frac{1}{2}$，我们有 $k(\\frac{1}{3})=1$。该格式给出：\n$$ \\frac{1 \\cdot (u_2^2 - u_0^2)}{2h} = 0 \\implies u_2^2 = u_0^2 $$\n使用边界值 $u_0=1$，我们得到 $u_2^2 = 1^2 = 1$。\n\n对于 $i=2$（在节点 $x_2 = \\frac{2}{3}$ 处）：\n系数为 $k(x_2) = k(\\frac{2}{3})$。由于 $\\frac{2}{3} > \\frac{1}{2}$，我们有 $k(\\frac{2}{3})=2$。该格式给出：\n$$ \\frac{2 \\cdot (u_3^2 - u_1^2)}{2h} = 0 \\implies u_3^2 = u_1^2 $$\n使用边界值 $u_3=\\frac{1}{\\sqrt{2}}$，我们得到 $u_1^2 = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{1}{2}$。\n\n我们得到了关于两个未知数 $u_1$ 和 $u_2$ 的方程组：\n$$\n\\begin{cases}\nu_2^2 = 1 \\\\\nu_1^2 = \\frac{1}{2}\n\\end{cases}\n$$\n问题要求的是左侧内部网格点处的数值解 $u_1$。从第二个方程，我们得到 $u_1 = \\pm\\frac{1}{\\sqrt{2}}$。鉴于边界条件是正的，按照惯例假设数值解也保持为正。因此，我们选择正根：\n$$ u_1 = \\frac{1}{\\sqrt{2}} $$\n\n这个结果凸显了非守恒格式的失败之处。在 $x_1=\\frac{1}{3}$ 处的数值 $u_1$ 取了来自域右侧部分的值，而精确解是 $1$。该格式没有正确处理系数 $k(x)$ 的不连续性。\n\n### 第三部分：绝对误差计算\n左侧内部网格点 $x_1 = \\frac{1}{3}$ 处的绝对误差定义为 $E = |u_1 - u(\\frac{1}{3})|$。\n使用前面部分推导出的值：\n- 数值解为 $u_1 = \\frac{1}{\\sqrt{2}}$。\n- 精确解为 $u(\\frac{1}{3}) = 1$。\n\n因此，绝对误差为：\n$$ E = \\left| \\frac{1}{\\sqrt{2}} - 1 \\right| $$\n由于 $1 > \\frac{1}{\\sqrt{2}}$，绝对值内的表达式为负。计算绝对值得到：\n$$ E = 1 - \\frac{1}{\\sqrt{2}} $$\n这就是误差的最终闭式表达式。",
            "answer": "$$\\boxed{1-\\frac{1}{\\sqrt{2}}}$$"
        }
    ]
}