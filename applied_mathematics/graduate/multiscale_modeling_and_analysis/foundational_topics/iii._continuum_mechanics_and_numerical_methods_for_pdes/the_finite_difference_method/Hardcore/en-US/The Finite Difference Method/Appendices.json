{
    "hands_on_practices": [
        {
            "introduction": "The first step in validating a numerical scheme is to ensure it faithfully represents the differential equation as the grid spacing becomes infinitesimally small, a property known as consistency. We quantify this by calculating the Local Truncation Error (LTE), which measures the residual left when the exact solution is plugged into the discrete equations. This practice  offers a rigorous analytical workout by having you calculate the exact LTE for a sinusoidal function without relying on Taylor expansions, revealing how the discrete operator's response differs from the continuous one.",
            "id": "3817950",
            "problem": "Consider a one-dimensional scalar field $u(x)$ that represents a single resolved harmonic mode at the macroscale in a multiscale model. The field is sampled on a uniform grid $x_{j} = x_{0} + j h$ with step size $h  0$, and a second derivative is approximated using the central difference operator from the Finite Difference Method (FDM),\n$$\nD^{2}u(x_{i}) \\equiv \\frac{u_{i+1} - 2 u_{i} + u_{i-1}}{h^{2}},\n$$\nwhere $u_{j} = u(x_{j})$. In the context of consistency analysis, the Local Truncation Error (LTE) is defined by the difference between the discrete operator applied to the exact field and the corresponding continuum operator evaluated at the same point, namely\n$$\nT_{i}(h) \\equiv D^{2}u(x_{i}) - \\frac{d^{2}u}{dx^{2}}(x_{i}).\n$$\nStarting from this definition and using only fundamental identities for trigonometric functions and exact differentiation, derive a closed-form analytic expression for $T_{i}(h)$ when $u(x) = \\sin(x)$, without assuming that $h$ is small. Express your final answer explicitly as a function of $x_{i}$ and $h$. No numerical approximation or rounding is required, and no physical units are involved. Your final answer must be a single analytical expression.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Grid:** A uniform grid defined by $x_{j} = x_{0} + j h$ with step size $h  0$.\n- **Field and Notation:** A one-dimensional scalar field $u(x)$, with discrete samples $u_{j} = u(x_{j})$.\n- **Finite Difference Operator:** The second-order central difference operator is given by $D^{2}u(x_{i}) \\equiv \\frac{u_{i+1} - 2 u_{i} + u_{i-1}}{h^{2}}$.\n- **Local Truncation Error (LTE) Definition:** The LTE is defined as $T_{i}(h) \\equiv D^{2}u(x_{i}) - \\frac{d^{2}u}{dx^{2}}(x_{i})$.\n- **Specific Field:** The analysis is to be performed for the function $u(x) = \\sin(x)$.\n- **Objective:** Derive a closed-form analytic expression for $T_{i}(h)$ as an explicit function of $x_{i}$ and $h$.\n- **Constraints:** The derivation must use only fundamental trigonometric identities and exact differentiation, without making the assumption that $h$ is small.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It poses a standard, well-defined exercise in numerical analysis, specifically in the consistency analysis of finite difference methods. All terms are precisely defined, and the required task is unambiguous. The problem is self-contained and free of contradictions, pseudoscience, or subjective claims. The constraint to avoid small-$h$ approximations (i.e., Taylor series expansions) makes the problem a rigorous test of analytical manipulation using exact identities, which is a valid and instructive task.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be derived.\n\nThe derivation proceeds as follows. We begin with the definition of the Local Truncation Error, $T_{i}(h)$:\n$$\nT_{i}(h) = D^{2}u(x_{i}) - \\frac{d^{2}u}{dx^{2}}(x_{i})\n$$\nThe problem specifies the function $u(x) = \\sin(x)$. We will evaluate each term in the LTE definition for this specific function.\n\nFirst, let us evaluate the term involving the discrete operator, $D^{2}u(x_{i})$. By definition:\n$$\nD^{2}u(x_{i}) = \\frac{u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})}{h^{2}}\n$$\nSubstituting $u(x) = \\sin(x)$ and using the grid definition $x_j = x_0 + jh$:\n$u(x_i) = \\sin(x_i)$\n$u(x_{i+1}) = u(x_i + h) = \\sin(x_i + h)$\n$u(x_{i-1}) = u(x_i - h) = \\sin(x_i - h)$\n\nThe expression for the discrete operator becomes:\n$$\nD^{2}u(x_{i}) = \\frac{\\sin(x_i + h) - 2\\sin(x_i) + \\sin(x_i - h)}{h^{2}}\n$$\nWe can simplify the numerator by grouping the first and third terms and applying the sum-to-product trigonometric identity, $\\sin(A) + \\sin(B) = 2\\sin\\left(\\frac{A+B}{2}\\right)\\cos\\left(\\frac{A-B}{2}\\right)$. Let $A = x_i + h$ and $B = x_i - h$.\n$$\n\\sin(x_i + h) + \\sin(x_i - h) = 2\\sin\\left(\\frac{(x_i+h)+(x_i-h)}{2}\\right)\\cos\\left(\\frac{(x_i+h)-(x_i-h)}{2}\\right)\n$$\n$$\n= 2\\sin\\left(\\frac{2x_i}{2}\\right)\\cos\\left(\\frac{2h}{2}\\right) = 2\\sin(x_i)\\cos(h)\n$$\nSubstituting this result back into the numerator of $D^{2}u(x_i)$:\n$$\n\\sin(x_i + h) - 2\\sin(x_i) + \\sin(x_i - h) = \\left[ \\sin(x_i + h) + \\sin(x_i - h) \\right] - 2\\sin(x_i)\n$$\n$$\n= 2\\sin(x_i)\\cos(h) - 2\\sin(x_i) = 2\\sin(x_i)\\left( \\cos(h) - 1 \\right)\n$$\nTo simplify further, we use the half-angle identity for cosine, which can be written as $\\cos(h) - 1 = -2\\sin^{2}\\left(\\frac{h}{2}\\right)$. This identity is derived from $\\cos(2\\theta) = 1 - 2\\sin^{2}(\\theta)$ by setting $\\theta = h/2$.\nThe numerator becomes:\n$$\n2\\sin(x_i) \\left( -2\\sin^{2}\\left(\\frac{h}{2}\\right) \\right) = -4\\sin(x_i)\\sin^{2}\\left(\\frac{h}{2}\\right)\n$$\nTherefore, the discrete operator term is:\n$$\nD^{2}u(x_{i}) = \\frac{-4\\sin(x_i)\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} = \\left( \\frac{-4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\right) \\sin(x_i)\n$$\nNext, we evaluate the continuous operator term, $\\frac{d^{2}u}{dx^{2}}(x_{i})$. We perform exact differentiation on $u(x) = \\sin(x)$:\nFirst derivative: $\\frac{du}{dx} = \\frac{d}{dx}(\\sin(x)) = \\cos(x)$\nSecond derivative: $\\frac{d^{2}u}{dx^{2}} = \\frac{d}{dx}(\\cos(x)) = -\\sin(x)$\nEvaluating at the point $x_i$:\n$$\n\\frac{d^{2}u}{dx^{2}}(x_{i}) = -\\sin(x_i)\n$$\nFinally, we substitute both the discrete and continuous results back into the definition of the LTE:\n$$\nT_{i}(h) = D^{2}u(x_{i}) - \\frac{d^{2}u}{dx^{2}}(x_{i}) = \\left( \\frac{-4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\sin(x_i) \\right) - \\left( -\\sin(x_i) \\right)\n$$\n$$\nT_{i}(h) = \\sin(x_i) - \\frac{4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\sin(x_i)\n$$\nFactoring out the common term $\\sin(x_i)$, we arrive at the final closed-form analytic expression for the Local Truncation Error:\n$$\nT_{i}(h) = \\sin(x_i) \\left( 1 - \\frac{4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\right)\n$$\nThis expression is a function of $x_i$ and $h$ only, and was derived without any small-$h$ approximations, fulfilling all requirements of the problem.",
            "answer": "$$\n\\boxed{\\sin(x_i) \\left( 1 - \\frac{4\\sin^{2}\\left(\\frac{h}{2}\\right)}{h^{2}} \\right)}\n$$"
        },
        {
            "introduction": "A consistent scheme is not guaranteed to work; it must also be stable, meaning that small errors do not grow uncontrollably and corrupt the solution. For explicit time-dependent problems, stability often imposes a constraint linking the time step $\\Delta t$ and the spatial step $\\Delta x$. The Forward-Time Centered-Space (FTCS) scheme for the heat equation $u_t = \\alpha u_{xx}$ is a classic example, only stable when the dimensionless ratio $r = \\alpha \\Delta t / (\\Delta x)^2$ satisfies $r \\le 0.5$. This exercise  provides a firsthand look at the consequences of violating this condition, as you will directly observe the non-physical oscillations that characterize numerical instability.",
            "id": "2141740",
            "problem": "Consider the one-dimensional heat flow through a thin, uniform rod of length $L=1.0$ m, with a thermal diffusivity of $\\alpha = 1.0 \\text{ m}^2/\\text{s}$. The temperature distribution $u(x, t)$ in the rod is governed by the heat equation $u_t = \\alpha u_{xx}$. The ends of the rod, at $x=0$ and $x=L$, are held at a constant temperature of $0$ K.\n\nAn experiment is modeled using a numerical simulation. The rod is discretized into a grid of points $x_j = j \\Delta x$, where the spatial step is $\\Delta x=0.2$ m. At time $t=0$, the rod has an initial temperature of $0$ K everywhere, except for a localized heat source that instantaneously sets the temperature to $100$ K at the single grid point $x=0.4$ m. The simulation proceeds forward in time using a time step of $\\Delta t=0.024$ s.\n\nThe temperature at a future time step is calculated from the temperatures at the current time step using the following explicit finite difference approximation:\n$$u(x, t+\\Delta t) \\approx u(x, t) + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\left[ u(x+\\Delta x, t) - 2u(x, t) + u(x-\\Delta x, t) \\right]$$\n\nUsing this scheme, calculate the temperature at the position $x=0.2$ m at time $t=3\\Delta t$. Express your answer in Kelvin, rounded to three significant figures.",
            "solution": "We discretize the rod at points $x_{j}=j\\Delta x$ with $\\Delta x=0.2$, so $j=0,1,2,3,4,5$ correspond to $x=0,0.2,0.4,0.6,0.8,1.0$. Dirichlet boundary conditions impose $u_{0}^{n}=0$ and $u_{5}^{n}=0$ for all $n$. The explicit scheme for interior nodes is\n$$\nu_{j}^{n+1}=u_{j}^{n}+r\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\nwhere $r=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$. With $\\alpha=1$, $\\Delta t=0.024$, and $\\Delta x=0.2$, we have\n$$\nr=\\frac{1\\times 0.024}{(0.2)^{2}}=\\frac{0.024}{0.04}=0.6.\n$$\nThe initial condition is $u_{j}^{0}=0$ for all $j$ except $u_{2}^{0}=100$.\n\nTime step $n=0\\to 1$:\n$$\n\\begin{aligned}\nu_{1}^{1}=u_{1}^{0}+r(u_{2}^{0}-2u_{1}^{0}+u_{0}^{0})=0+0.6(100-0+0)=60,\\\\\nu_{2}^{1}=100+0.6(0-200+0)=100-120=-20,\\\\\nu_{3}^{1}=0+0.6(0-0+100)=60,\\\\\nu_{4}^{1}=0+0.6(0-0+0)=0.\n\\end{aligned}\n$$\n\nTime step $n=1\\to 2$:\n$$\n\\begin{aligned}\nu_{1}^{2}=60+0.6\\left((-20)-2\\cdot 60+0\\right)=60+0.6(-140)=-24,\\\\\nu_{2}^{2}=-20+0.6\\left(60-2(-20)+60\\right)=-20+0.6(160)=76,\\\\\nu_{3}^{2}=60+0.6\\left(0-2\\cdot 60+(-20)\\right)=60+0.6(-140)=-24,\\\\\nu_{4}^{2}=0+0.6\\left(0-0+60\\right)=36.\n\\end{aligned}\n$$\n\nTime step $n=2\\to 3$ for the target node $j=1$:\n$$\nu_{1}^{3}=u_{1}^{2}+r(u_{2}^{2}-2u_{1}^{2}+u_{0}^{2})=-24+0.6(76-2(-24)+0)=-24+0.6(124)=50.4.\n$$\n\nThus, at $x=0.2$ m and $t=3\\Delta t$, the temperature is $50.4$ K, which to three significant figures is $50.4$.",
            "answer": "$$\\boxed{50.4}$$"
        },
        {
            "introduction": "Many physical laws are expressed as conservation laws, which state that a quantity like mass or energy is conserved within any volume unless there is a flux across its boundary. For a numerical method to be physically meaningful, it is often crucial for it to preserve this property at the discrete level. This problem  presents a compelling counterexample demonstrating the failure of a nonconservative finite difference scheme, where you will find that it produces a steady state that incorrectly violates the underlying conservation principle.",
            "id": "3817953",
            "problem": "Consider the stationary one-dimensional conservation law on the interval $[0,1]$ given by $\\frac{d}{dx}\\big(k(x)\\,f(u(x))\\big)=0$, where $f(u)=u^{2}$ and the heterogeneous coefficient $k(x)$ is piecewise constant: $k(x)=1$ for $0 \\leq x  \\frac{1}{2}$ and $k(x)=2$ for $\\frac{1}{2}  x \\leq 1$. Impose Dirichlet boundary conditions $u(0)=1$ and $u(1)=\\frac{1}{\\sqrt{2}}$. The exact continuous steady state must satisfy conservation of flux. Now construct a uniform grid with spacing $h=\\frac{1}{3}$ and grid points $x_{i}=ih$ for $i=0,1,2,3$, so that $x_{0}=0$, $x_{1}=\\frac{1}{3}$, $x_{2}=\\frac{2}{3}$, and $x_{3}=1$. On this grid, consider the following nonconservative Finite Difference Method (FDM) discretization at interior nodes $i=1,2$:\n$$R^{\\mathrm{nc}}_{i} \\equiv \\frac{k(x_{i})\\big(f(u_{i+1})-f(u_{i-1})\\big)}{2h}=0,$$\nwhere $u_{i}$ approximates $u(x_{i})$, and $k(x_{i})$ is the pointwise coefficient evaluated at the grid points. Use the given boundary values $u_{0}=1$ and $u_{3}=\\frac{1}{\\sqrt{2}}$. Compute the absolute error at the left interior grid point,\n$E=\\left|u_{1}-u\\left(\\tfrac{1}{3}\\right)\\right|,$\npredicted by this nonconservative scheme relative to the exact continuous steady-state value. Express your final answer as a single closed-form expression with no units. No rounding is required.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the field of numerical analysis for partial differential equations, is well-posed, objective, and self-contained. All necessary data and definitions for finding a unique solution are provided. We proceed with the solution, which consists of three main parts: 1. Determining the exact continuous solution, 2. Solving the finite difference scheme for the numerical solution, and 3. Computing the requested absolute error.\n\n### Part 1: Exact Continuous Solution\nThe given stationary one-dimensional conservation law is\n$$ \\frac{d}{dx}\\big(k(x)\\,f(u(x))\\big) = 0 $$\nwhere the domain is $x \\in [0, 1]$. This equation implies that the flux, $J(x) = k(x)f(u(x))$, must be constant throughout the domain.\n$$ k(x)f(u(x)) = C $$\nwhere $C$ is a constant of integration. We are given the flux function $f(u) = u^2$. So, the equation becomes\n$$ k(x)u(x)^2 = C $$\nWe can determine the constant $C$ using the boundary condition at $x=0$, where $u(0)=1$. The coefficient $k(x)$ at this point is $k(0)=1$ (since $0  \\frac{1}{2}$).\n$$ C = k(0)u(0)^2 = 1 \\cdot (1)^2 = 1 $$\nThus, the flux is constant with a value of $1$ across the entire domain:\n$$ k(x)u(x)^2 = 1 $$\nWe can now find the exact solution $u(x)$ in the two subdomains defined by the piecewise constant coefficient $k(x)$.\n\nFor the interval $0 \\leq x  \\frac{1}{2}$, we have $k(x)=1$. The conservation law gives:\n$$ 1 \\cdot u(x)^2 = 1 \\implies u(x)^2 = 1 $$\nSince the boundary condition $u(0)=1$ is positive, we take the positive root, yielding $u(x)=1$ for this interval.\n\nFor the interval $\\frac{1}{2}  x \\leq 1$, we have $k(x)=2$. The conservation law gives:\n$$ 2 \\cdot u(x)^2 = 1 \\implies u(x)^2 = \\frac{1}{2} $$\nThe boundary condition at the other end is $u(1) = \\frac{1}{\\sqrt{2}}$, which is positive. Therefore, we must take the positive root, yielding $u(x)=\\frac{1}{\\sqrt{2}}$ for this interval.\n\nThe exact continuous steady-state solution $u(x)$ is a piecewise function:\n$$\nu(x) = \\begin{cases}\n1  \\text{if } 0 \\leq x  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  \\text{if } \\frac{1}{2}  x \\leq 1\n\\end{cases}\n$$\nThe problem requires computing the error at the grid point $x_1 = \\frac{1}{3}$. Since $0 \\leq \\frac{1}{3}  \\frac{1}{2}$, the exact value at this point is\n$$ u\\left(\\frac{1}{3}\\right) = 1 $$\n\n### Part 2: Numerical Solution from the FDM Scheme\nThe problem defines a uniform grid with spacing $h=\\frac{1}{3}$ and points $x_i = ih$ for $i=0,1,2,3$. This gives the grid points $x_0=0$, $x_1=\\frac{1}{3}$, $x_2=\\frac{2}{3}$, and $x_3=1$. The values at the boundaries are given: $u_0 = u(0) = 1$ and $u_3 = u(1) = \\frac{1}{\\sqrt{2}}$.\n\nThe specified nonconservative FDM discretization is applied at the interior nodes $i=1,2$:\n$$ R^{\\mathrm{nc}}_{i} \\equiv \\frac{k(x_{i})\\big(f(u_{i+1})-f(u_{i-1})\\big)}{2h}=0 $$\nSubstituting $f(u)=u^2$, we get:\n$$ \\frac{k(x_{i})(u_{i+1}^2 - u_{i-1}^2)}{2h} = 0 $$\nSince $h \\neq 0$ and $k(x)$ is strictly positive on the grid, this simplifies to $u_{i+1}^2 = u_{i-1}^2$ at each interior node.\n\nLet's write out the equations for $i=1$ and $i=2$:\nFor $i=1$ (at node $x_1 = \\frac{1}{3}$):\nThe coefficient is $k(x_1) = k(\\frac{1}{3})$. Since $\\frac{1}{3}  \\frac{1}{2}$, we have $k(\\frac{1}{3})=1$. The scheme gives:\n$$ \\frac{1 \\cdot (u_2^2 - u_0^2)}{2h} = 0 \\implies u_2^2 = u_0^2 $$\nUsing the boundary value $u_0=1$, we get $u_2^2 = 1^2 = 1$.\n\nFor $i=2$ (at node $x_2 = \\frac{2}{3}$):\nThe coefficient is $k(x_2) = k(\\frac{2}{3})$. Since $\\frac{2}{3}  \\frac{1}{2}$, we have $k(\\frac{2}{3})=2$. The scheme gives:\n$$ \\frac{2 \\cdot (u_3^2 - u_1^2)}{2h} = 0 \\implies u_3^2 = u_1^2 $$\nUsing the boundary value $u_3=\\frac{1}{\\sqrt{2}}$, we get $u_1^2 = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{1}{2}$.\n\nWe have a system of two equations for the two unknowns, $u_1$ and $u_2$:\n$$\n\\begin{cases}\nu_2^2 = 1 \\\\\nu_1^2 = \\frac{1}{2}\n\\end{cases}\n$$\nThe problem asks for the numerical solution at the left interior grid point, which is $u_1$. From the second equation, we find $u_1 = \\pm\\frac{1}{\\sqrt{2}}$. Given that the boundary conditions are positive, it is conventional to assume the numerical solution also remains positive. Thus, we select the positive root:\n$$ u_1 = \\frac{1}{\\sqrt{2}} $$\n\nThis result highlights the failure of the nonconservative scheme. The numerical value $u_1$ at $x_1=\\frac{1}{3}$ takes the value from the right part of the domain, while the exact solution is $1$. The scheme does not correctly handle the discontinuity in the coefficient $k(x)$.\n\n### Part 3: Absolute Error Calculation\nThe absolute error at the left interior grid point $x_1 = \\frac{1}{3}$ is defined as $E = |u_1 - u(\\frac{1}{3})|$.\nUsing the values derived in the previous parts:\n- The numerical solution is $u_1 = \\frac{1}{\\sqrt{2}}$.\n- The exact solution is $u(\\frac{1}{3}) = 1$.\n\nThe absolute error is therefore:\n$$ E = \\left| \\frac{1}{\\sqrt{2}} - 1 \\right| $$\nSince $1  \\frac{1}{\\sqrt{2}}$, the expression inside the absolute value is negative. Evaluating the absolute value gives:\n$$ E = 1 - \\frac{1}{\\sqrt{2}} $$\nThis is the final closed-form expression for the error.",
            "answer": "$$\\boxed{1-\\frac{1}{\\sqrt{2}}}$$"
        }
    ]
}