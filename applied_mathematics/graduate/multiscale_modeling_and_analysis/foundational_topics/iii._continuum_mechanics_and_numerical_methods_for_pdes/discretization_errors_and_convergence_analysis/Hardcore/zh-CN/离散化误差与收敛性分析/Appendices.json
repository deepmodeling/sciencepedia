{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨了在使用显式数值格式求解瞬态问题时所面临的基本权衡。通过分析经典的热方程，我们将推导出为保证稳定性，时间步长$ \\Delta t $与空间网格尺寸$ h $之间必须满足的严格关系，即$ \\Delta t \\le C h^2 $。同时，我们还将探讨这一限制如何直接影响在给定计算预算内所能达到的最终精度。",
            "id": "3750560",
            "problem": "考虑有界区间上的具有齐次狄利克雷边界条件的一维热方程，\n$$\nu_{t} = \\kappa\\,u_{xx}, \\quad x \\in (0,L), \\quad t \\in (0,T], \\qquad u(0,t)=u(L,t)=0,\\qquad u(x,0)=u_{0}(x)\n$$\n其中 $\\kappa>0$，$L>0$，$T>0$。用间距为 $h$ 的均匀网格对 $(0,L)$ 进行离散，并用标准的二阶中心差分来近似 $u_{xx}$。使用时间步长为 $\\Delta t$ 的前向（显式）欧拉方法在时间上推进。用 $u_{i}^{n}$ 表示在网格点 $x_{i}=i h$ 和时间 $t_{n}=n\\,\\Delta t$ 处的数值解。\n\na) 从离散拉普拉斯算子的傅里叶模态的线性常系数常微分方程模型和标量测试问题 $y'=\\lambda y$ 的前向欧拉稳定性条件出发，使用 von Neumann 分析推导以 $h$ 和 $\\kappa$ 表示的最大稳定时间步长。证明存在一个常数 $C>0$，使得该格式仅在以下条件下稳定\n$$\n\\Delta t \\le C\\,h^{2},\n$$\n并确定在此设置下的精确常数 $C$。\n\nb) 假设精确解 $u$ 足够光滑，使得在时间 $T$ 时，$L^{2}(0,L)$ 范数下的全局误差满足渐近界\n$$\n\\|u(\\cdot,T)-u_{h}^{N}\\|_{L^{2}(0,L)} \\approx C_{s}\\,h^{2} + C_{t}\\,\\Delta t,\n$$\n对于小的 $h$ 和 $\\Delta t$，其中 $C_{s}>0$ 和 $C_{t}>0$ 依赖于 $u$ 的导数和 $T$，但不依赖于 $h$ 或 $\\Delta t$，且 $N=T/\\Delta t$。\n\n假设计算预算由自由度更新的总次数来衡量，\n$$\nB = \\gamma \\,\\frac{T}{\\Delta t}\\,\\frac{L}{h}\n$$\n其中已知常数 $\\gamma>0$ 代表与问题无关的每次更新的成本。为了在预算约束下最大化精度，您决定在(a)部分中找到的显式稳定性阈值下运行，即，对于给定的 $h$，您选择满足稳定性的最大 $\\Delta t$ 值。\n\n在这些假设下，在预算约束和稳定性阈值选择的条件下对 $h$ 进行优化，以获得在时间 $T$ 时可达到的渐近最小 $L^{2}(0,L)$ 全局误差，该误差是 $B$, $\\kappa$, $L$, $T$, $C_{s}$, $C_{t}$ 和 $\\gamma$ 的函数。将您的最终答案表示为关于这些参数的单个封闭形式的解析表达式。最终表达式中不要包含单位。",
            "solution": "用户提供了一个关于一维热方程数值解的两部分问题。第一部分要求对前向时间中心空间（FTCS）格式进行 von Neumann 稳定性分析，以确定限制稳定性的时间步长。第二部分涉及一个优化问题，即在第一部分推导出的稳定性极限下选择时间步长的约束下，为给定的计算预算找到可实现的最小全局误差。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n- **控制方程：** 对于 $x \\in (0,L)$ 和 $t \\in (0,T]$，$u_{t} = \\kappa\\,u_{xx}$。\n- **参数：** $\\kappa > 0$, $L > 0$, $T > 0$。\n- **边界条件：** $u(0,t)=u(L,t)=0$。\n- **初始条件：** $u(x,0)=u_{0}(x)$。\n- **数值格式：**\n    - 空间离散：间距为 $h$ 的均匀网格（$x_i=ih$），对 $u_{xx}$ 使用二阶中心差分。\n    - 时间离散：时间步长为 $\\Delta t$ 的前向欧拉法（$t_n=n\\Delta t$）。\n- **数值解记法：** $u_{i}^{n} \\approx u(x_i, t_n)$。\n- **(a)部分目标：** 推导稳定性条件 $\\Delta t \\le C\\,h^{2}$ 并找到精确常数 $C$。\n- **(b)部分假设：**\n    - **全局误差形式：** $\\|u(\\cdot,T)-u_{h}^{N}\\|_{L^{2}(0,L)} \\approx C_{s}\\,h^{2} + C_{t}\\,\\Delta t$，其中 $N=T/\\Delta t$。常数 $C_s > 0, C_t > 0$ 不依赖于 $h, \\Delta t$。\n    - **计算预算：** $B = \\gamma \\,\\frac{T}{\\Delta t}\\,\\frac{L}{h}$，其中 $\\gamma > 0$ 是一个常数。\n    - **运行条件：** 该格式在(a)部分的稳定性阈值下运行，即对于给定的 $h$，$\\Delta t$ 被设置为其最大稳定值。\n- **(b)部分目标：** 将渐近最小的 $L^{2}(0,L)$ 全局误差表示为 $B$, $\\kappa$, $L$, $T$, $C_{s}$, $C_{t}$ 和 $\\gamma$ 的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n\n根据验证标准对问题进行评估。\n- **科学性：** 该问题是数值分析中的一个经典练习，涉及热方程的FTCS格式的稳定性和收敛性。所有概念（von Neumann 分析、误差界、计算预算）都是标准且成熟的。该问题在科学上是有效的。\n- **适定性：** (a)部分要求进行标准推导，其结果唯一且众所周知。(b)部分是一个约束优化问题。约束和目标函数定义清晰，并且在稳定性阈值下运行的指令消除了任何歧义，从而得到唯一解。该问题是适定的。\n- **客观性：** 问题使用精确、无歧义的数学语言陈述。它是客观的。\n- **完整性和一致性：** 提供了所有必要的参数和关系。没有缺失数据或内部矛盾。\n\n**步骤3：结论和行动**\n\n该问题是有效的。这是一个结构良好的数值分析问题，测试了对稳定性、准确性和计算成本的理解。将提供完整的解决方案。\n\n### (a)部分：稳定性分析\n\n热方程 $u_t = \\kappa u_{xx}$ 的FTCS离散格式为：\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} = \\kappa \\frac{u_{i-1}^{n} - 2u_{i}^{n} + u_{i+1}^{n}}{h^2}\n$$\n问题建议使用基于傅里叶模态的常微分方程（ODE）的模态分析。首先，我们在空间上进行半离散化，得到关于网格点值 $u_i(t)$ 的常微分方程组：\n$$\n\\frac{d u_i}{d t} = \\kappa \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\n在 von Neumann 分析中，我们考虑单个傅里叶模态的演化，$u_i(t) = v_k(t) e^{\\mathrm{i} k x_i}$，其中 $x_i = ih$，$k$ 是波数，$v_k(t)$ 是该模态随时间变化的振幅。将其代入半离散方程得到：\n$$\n\\frac{d v_k}{d t} e^{\\mathrm{i} k i h} = \\kappa v_k(t) \\frac{e^{\\mathrm{i} k (i-1) h} - 2e^{\\mathrm{i} k i h} + e^{\\mathrm{i} k (i+1) h}}{h^2}\n$$\n两边同除以 $e^{\\mathrm{i} k i h}$，我们得到关于振幅 $v_k(t)$ 的常微分方程：\n$$\n\\frac{d v_k}{d t} = \\kappa v_k(t) \\frac{e^{-\\mathrm{i} k h} - 2 + e^{\\mathrm{i} k h}}{h^2} = \\kappa v_k(t) \\frac{2\\cos(kh) - 2}{h^2}\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，上式可简化为：\n$$\n\\frac{d v_k}{d t} = - \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right) v_k(t)\n$$\n这是一个形式为 $\\frac{dy}{dt} = \\lambda y$ 的标量线性常微分方程，其中波数为 $k$ 的模态的特征值 $\\lambda_k$ 为：\n$$\n\\lambda_k = -\\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)\n$$\n对该常微分方程应用前向欧拉法，得到模态振幅的时间步进规则：\n$$\nv_k^{n+1} = v_k^n + \\Delta t (\\lambda_k v_k^n) = \\left(1 + \\Delta t \\lambda_k\\right) v_k^n\n$$\n一个时间步的放大因子为 $G(k) = 1 + \\Delta t \\lambda_k$。为保证稳定性，对于所有可能的波数，放大因子的模都不能超过1，即 $|G(k)| \\le 1$。\n$$\n\\left|1 - \\frac{4\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)\\right| \\le 1\n$$\n由于 $\\kappa, \\Delta t, h^2$ 均为正数，项 $\\frac{4\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)$ 是非负的。令此项为 $P$。条件为 $|1-P| \\le 1$，等价于 $-1 \\le 1-P \\le 1$。\n右侧不等式 $1-P \\le 1$ 意味着 $-P \\le 0$，这总是成立的。\n左侧不等式 $-1 \\le 1-P$ 意味着 $P \\le 2$。\n$$\n\\frac{4\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\le 2\n$$\n解出 $\\Delta t$ 得到：\n$$\n\\Delta t \\le \\frac{2 h^2}{4\\kappa \\sin^2\\left(\\frac{kh}{2}\\right)} = \\frac{h^2}{2\\kappa \\sin^2\\left(\\frac{kh}{2}\\right)}\n$$\n这个条件必须对网格能表示的所有波数 $k$ 都成立。最严格的约束（即 $\\Delta t$ 的最小上界）发生在分母最小时，这对应于项 $\\sin^2\\left(\\frac{kh}{2}\\right)$ 取最大值。$\\sin^2\\left(\\frac{kh}{2}\\right)$ 的最大值为1。这对应于网格可以解析的最高频率模态，此时 $kh = \\pi$。\n代入这个最大值，得到稳定性的必要条件：\n$$\n\\Delta t \\le \\frac{h^2}{2\\kappa}\n$$\n这与形式 $\\Delta t \\le C\\,h^{2}$ 相符，其中精确常数 $C$ 被确定为：\n$$\nC = \\frac{1}{2\\kappa}\n$$\n\n### (b)部分：预算约束下的误差优化\n\n我们的任务是在固定的计算预算 $B$ 和在稳定性阈值下运行的选择下，最小化由 $E \\approx C_{s}\\,h^{2} + C_{t}\\,\\Delta t$ 给出的全局误差。\n\n相关关系如下：\n1.  误差： $E = C_{s}\\,h^{2} + C_{t}\\,\\Delta t$\n2.  预算： $B = \\gamma \\,\\frac{T L}{h \\Delta t}$\n3.  稳定性阈值： $\\Delta t = C h^2 = \\frac{1}{2\\kappa} h^2$（使用(a)部分的结果）\n\n问题是找到最小误差 $E$ 作为预算 $B$ 和其他系统参数的函数。我们可以通过将 $h$ 和 $\\Delta t$ 表示为 $B$ 的函数，然后将它们代入误差公式来实现这一点。\n\n首先，将稳定性条件(3)代入预算方程(2)，以将空间步长 $h$ 与预算 $B$ 联系起来：\n$$\nB = \\gamma \\frac{T L}{h \\left(\\frac{1}{2\\kappa} h^2\\right)} = \\frac{2\\kappa\\gamma T L}{h^3}\n$$\n由此，我们可以解出 $h^3$：\n$$\nh^3 = \\frac{2\\kappa\\gamma T L}{B}\n$$\n误差表达式依赖于 $h^2$。我们通过将 $h^3$ 的表达式取 $2/3$ 次方来找到 $h^2$：\n$$\nh^2 = \\left(h^3\\right)^{2/3} = \\left(\\frac{2\\kappa\\gamma T L}{B}\\right)^{2/3}\n$$\n接下来，通过将稳定性条件(3)代入误差公式(1)，我们将误差 $E$ 完全用 $h$ 来表示：\n$$\nE = C_s h^2 + C_t \\left(\\frac{1}{2\\kappa} h^2\\right) = \\left(C_s + \\frac{C_t}{2\\kappa}\\right) h^2\n$$\n最后，我们将以预算 $B$ 表示的 $h^2$ 的表达式代入这个新的误差表达式，以找到该预算下可达到的最小误差：\n$$\nE = \\left(C_s + \\frac{C_t}{2\\kappa}\\right) \\left(\\frac{2\\kappa\\gamma T L}{B}\\right)^{2/3}\n$$\n这就是在指定的操作条件下，作为预算 $B$ 和给定参数的函数的最小全局误差。",
            "answer": "$$\n\\boxed{\\left(C_{s} + \\frac{C_{t}}{2\\kappa}\\right) \\left(\\frac{2\\kappa\\gamma TL}{B}\\right)^{2/3}}\n$$"
        },
        {
            "introduction": "在基本误差概念的基础上，本问题深入探讨了有限元误差分析中更为精细的方面。我们将看到，用于衡量误差的范数的选择至关重要，不同的范数会导致不同的收敛速度。本练习通过一个具体例子，演示了著名的Aubin-Nitsche对偶论证，它解释了为何$L^2$范数下的误差收敛速度会快于能量范数（$H^1$范数）下的误差。",
            "id": "3750597",
            "problem": "考虑单位区间上的一个一维齐次狄利克雷边界值问题：寻找一个函数 $u$ 使得在 $(0,1)$ 内有 $-u'' = f$，且 $u(0) = u(1) = 0$，其中右端项 $f$ 的选取使得精确解为\n$$\nu(x) = \\sin(\\pi x) + \\frac{1}{10}\\sin(10\\pi x).\n$$\n该精确解包含一个粗尺度分量 $\\sin(\\pi x)$ 和一个细尺度分量 $\\sin(10\\pi x)$，这是多尺度行为的典型代表。令 $V$ 为在端点处为零的平方可积函数（其一阶导数也平方可积）所构成的 Sobolev 空间，并令 $a(\\cdot,\\cdot)$ 为与该问题弱形式相关联的对称双线性形式。令 $V_h \\subset V$ 为在步长为 $h$ 的均匀网格上且在端点处为零的连续分片线性函数所构成的协调子空间，并令 $u_h \\in V_h$ 表示通过标准有限元法 (FEM) 获得的 Galerkin 近似解。\n\n从变分形式以及 $V$ 和 $L^2(0,1)$ 上范数的定义出发，使用协调分片线性元的插值理论以及双线性形式的矫顽性和有界性，建立当 $h \\to 0$ 时，有限元法误差在 $H^1(0,1)$ 范数和 $L^2(0,1)$ 范数下的渐近收敛率。为给定的 $u$ 显式地构造论证过程，并证明推导收敛率所需的任何正则性要求。您的推导应清楚地表明，在此示例中，为什么 $L^2(0,1)$ 误差比 $H^1(0,1)$ 误差收敛得更快。\n\n精确指数 $p_{H^1}$ 和 $p_{L^2}$ 分别为何值，使得对于足够小的 $h$，误差的主阶行为满足\n$$\n\\|u - u_h\\|_{H^1(0,1)} = \\mathcal{O}(h^{p_{H^1}}) \\quad \\text{和} \\quad \\|u - u_h\\|_{L^2(0,1)} = \\mathcal{O}(h^{p_{L^2}})\n$$?\n请以一个包含 $(p_{H^1}, p_{L^2})$ 的行矩阵形式提供您的最终答案。",
            "solution": "该问题要求推导特定一维边界值问题的有限元近似的渐近收敛率。我们将首先验证问题设定，然后基于标准的有限元理论进行推导。\n\n问题陈述如下：\n$$\n-u'' = f \\quad \\text{在 } (0,1) \\text{ 内}\n$$\n$$\nu(0) = u(1) = 0\n$$\n精确解由 $u(x) = \\sin(\\pi x) + \\frac{1}{10}\\sin(10\\pi x)$ 给出。由此，我们可以确定源函数 $f(x)$：\n$$\nu'(x) = \\pi\\cos(\\pi x) + \\pi\\cos(10\\pi x)\n$$\n$$\nu''(x) = -\\pi^2\\sin(\\pi x) - 100\\pi^2\\sin(10\\pi x)\n$$\n因此，$f(x) = -u''(x) = \\pi^2\\sin(\\pi x) + 100\\pi^2\\sin(10\\pi x)$。函数 $u(x)$ 及其任意阶导数在 $[0,1]$ 上都是连续的，因此也是平方可积的。这意味着 $u \\in C^\\infty([0,1])$，进而对于任意整数 $k \\ge 0$ 都有 $u \\in H^k(0,1)$。这种高正则性对于后续分析至关重要。\n\n弱形式是通过将偏微分方程乘以一个测试函数 $v \\in V = H_0^1(0,1)$ 并在定义域 $(0,1)$ 上积分得到的。空间 $H_0^1(0,1)$ 是一个 Sobolev 空间，其中的函数属于 $L^2(0,1)$，其弱一阶导数也属于 $L^2(0,1)$，并且满足齐次狄利克雷边界条件。\n$$\n-\\int_0^1 u''(x)v(x) dx = \\int_0^1 f(x)v(x) dx\n$$\n对左端项进行分部积分可得：\n$$\n\\int_0^1 u'(x)v'(x) dx - [u'(x)v(x)]_0^1 = \\int_0^1 f(x)v(x) dx\n$$\n由于 $v \\in H_0^1(0,1)$，所以 $v(0)=v(1)=0$，边界项消失。这就给出了弱形式：寻找 $u \\in V$ 使得\n$$\na(u,v) = L(v) \\quad \\forall v \\in V\n$$\n其中双线性形式为 $a(u,v) = \\int_0^1 u'(x)v'(x) dx$，线性泛函为 $L(v) = \\int_0^1 f(x)v(x) dx$。\n\n有限元法在一个有限维子空间 $V_h \\subset V$ 中寻找近似解 $u_h$。在这里，$V_h$ 是定义在步长为 $h$ 的均匀网格上的连续分片线性函数空间，且满足 $u_h(0) = u_h(1) = 0$。Galerkin 问题是：寻找 $u_h \\in V_h$ 使得\n$$\na(u_h, v_h) = L(v_h) \\quad \\forall v_h \\in V_h\n$$\n从弱形式（使用测试函数 $v_h \\in V_h \\subset V$ 进行评估）中减去 Galerkin 问题，我们得到误差 $e = u - u_h$ 的 Galerkin 正交性：\n$$\na(u - u_h, v_h) = a(u, v_h) - a(u_h, v_h) = L(v_h) - L(v_h) = 0 \\quad \\forall v_h \\in V_h\n$$\n\n**$H^1(0,1)$ 范数误差分析**\n\n$H^1$ 范数下的误差分析依赖于 Céa 引理。双线性形式 $a(v,v) = \\int_0^1 (v'(x))^2 dx = \\|v'\\|_{L^2}^2$。在空间 $V=H_0^1(0,1)$ 上，Poincaré 不等式表明存在一个常数 $C_P$ 使得 $\\|v\\|_{L^2} \\le C_P \\|v'\\|_{L^2}$。这意味着 $H^1$ 范数 $\\|v\\|_{H^1} = (\\|v\\|_{L^2}^2 + \\|v'\\|_{L^2}^2)^{1/2}$ 与由 $a(\\cdot,\\cdot)$ 导出的半范数（即 $\\|v'\\|_{L^2}$）等价。因此，双线性形式 $a(\\cdot,\\cdot)$ 在 $V$ 上是矫顽的。它也是有界的，因为 $|a(u,v)| = |\\int_0^1 u'v' dx| \\le \\|u'\\|_{L^2}\\|v'\\|_{L^2} \\le \\|u\\|_{H^1}\\|v\\|_{H^1}$。\n\nCéa 引理指出，对于一个矫顽且有界的双线性形式，Galerkin 近似在能量范数下是准最优的。对于我们的问题，这可以转化为 $H^1$ 范数：\n$$\n\\|u - u_h\\|_{H^1} \\le C \\inf_{v_h \\in V_h} \\|u - v_h\\|_{H^1}\n$$\n其中 $C$ 是一个与 $h$ 和 $u$ 无关的常数。右边的项是 $u$ 在子空间 $V_h$ 中的最佳逼近误差。这个误差可以通过一个特定的 $v_h$（即 $u$ 的节点插值，记为 $\\Pi_h u$）的误差来界定。\n$$\n\\inf_{v_h \\in V_h} \\|u - v_h\\|_{H^1} \\le \\|u - \\Pi_h u\\|_{H^1}\n$$\n对于协调的分片线性 ($P_1$) 有限元，标准的插值理论给出了以下估计，前提是解 $u$ 具有足够的正则性（具体来说，$u \\in H^2(0,1)$）：\n$$\n\\|u - \\Pi_h u\\|_{H^1(0,1)} \\le C_I h \\|u\\|_{H^2(0,1)}\n$$\n如前所述，我们的精确解 $u(x) = \\sin(\\pi x) + \\frac{1}{10}\\sin(10\\pi x)$ 属于 $C^\\infty([0,1])$，因此它必然属于 $H^2(0,1)$。所以，该条件得到满足。结合这些不等式，我们得到误差的 $H^1$ 范数的最终估计：\n$$\n\\|u - u_h\\|_{H^1(0,1)} \\le C \\cdot C_I h \\|u\\|_{H^2(0,1)}\n$$\n由于对于给定问题 $\\|u\\|_{H^2(0,1)}$ 是一个固定的常数，误差的行为如下：\n$$\n\\|u - u_h\\|_{H^1(0,1)} = \\mathcal{O}(h^1)\n$$\n这确定了在 $H^1$ 范数下的收敛率指数为 $p_{H^1} = 1$。\n\n**$L^2(0,1)$ 范数误差分析**\n\n为了获得 $L^2$ 范数下的收敛率，我们采用 Aubin-Nitsche 对偶论证。令误差为 $e = u - u_h$。我们希望估计 $\\|e\\|_{L^2}$。我们引入一个辅助（对偶）问题：寻找 $\\phi \\in V = H_0^1(0,1)$ 使得\n$$\n-\\phi'' = e \\quad \\text{在 } (0,1) \\text{ 内}\n$$\n边界条件为 $\\phi(0) = \\phi(1) = 0$。该对偶问题的弱形式为：寻找 $\\phi \\in V$ 使得\n$$\na(v, \\phi) = \\int_0^1 v' \\phi' dx = \\int_0^1 e v dx = (e, v)_{L^2} \\quad \\forall v \\in V\n$$\n对于一维问题（或更一般地，对于凸区域上的问题），这个椭圆型偏微分方程表现出完全正则性。这意味着对于一个 $L^2(0,1)$ 中的右端项，解属于 $H^2(0,1)$，并且存在一个常数 $C_R$ 使得：\n$$\n\\|\\phi\\|_{H^2(0,1)} \\le C_R \\|e\\|_{L^2(0,1)}\n$$\n现在，我们在对偶弱形式中令 $v=e$，来表示误差的 $L^2$ 范数的平方：\n$$\n\\|e\\|_{L^2}^2 = (e,e)_{L^2} = a(e, \\phi)\n$$\n利用 Galerkin 正交性，对于任何 $v_h \\in V_h$，有 $a(e, v_h) = a(u-u_h, v_h) = 0$。我们可以减去这个零项：\n$$\n\\|e\\|_{L^2}^2 = a(e, \\phi - v_h) \\quad \\forall v_h \\in V_h\n$$\n利用双线性形式的有界性（导数上的 Cauchy-Schwarz 不等式）：\n$$\n\\|e\\|_{L^2}^2 = \\int_0^1 e'(\\phi - v_h)' dx \\le \\|e'\\|_{L^2} \\|\\phi' - v_h'\\|_{L^2} \\le \\|e\\|_{H^1} \\|\\phi - v_h\\|_{H^1}\n$$\n这个不等式对任何 $v_h \\in V_h$ 都成立。我们做出一个巧妙的选择，$v_h = \\Pi_h \\phi$，即对偶解 $\\phi$ 的分片线性插值。\n$$\n\\|e\\|_{L^2}^2 \\le \\|e\\|_{H^1} \\|\\phi - \\Pi_h \\phi\\|_{H^1}\n$$\n我们对 $\\|\\phi - \\Pi_h \\phi\\|_{H^1}$ 应用插值误差估计。由于椭圆正则性保证了 $\\phi \\in H^2(0,1)$，我们有：\n$$\n\\|\\phi - \\Pi_h \\phi\\|_{H^1} \\le C_I h \\|\\phi\\|_{H^2}\n$$\n将此式代入 $\\|e\\|_{L^2}^2$ 的不等式中：\n$$\n\\|e\\|_{L^2}^2 \\le \\|e\\|_{H^1} (C_I h \\|\\phi\\|_{H^2})\n$$\n现在，代入椭圆正则性估计 $\\|\\phi\\|_{H^2} \\le C_R \\|e\\|_{L^2}$：\n$$\n\\|e\\|_{L^2}^2 \\le \\|e\\|_{H^1} (C_I h C_R \\|e\\|_{L^2})\n$$\n假设 $\\|e\\|_{L^2} \\neq 0$，我们可以两边同除以 $\\|e\\|_{L^2}$：\n$$\n\\|e\\|_{L^2} \\le (C_I C_R) h \\|e\\|_{H^1}\n$$\n最后，我们代入 $H^1$ 误差分析的结果，$\\|e\\|_{H^1} = \\|u-u_h\\|_{H^1} = \\mathcal{O}(h)$：\n$$\n\\|u - u_h\\|_{L^2} \\le (\\text{常数} \\cdot h) \\cdot \\mathcal{O}(h) = \\mathcal{O}(h^2)\n$$\n这确定了在 $L^2$ 范数下的收敛率，指数为 $p_{L^2} = 2$。\n\n在 $L^2$ 范数下更快的收敛是对偶论证的直接结果。其核心思想是，误差的 $L^2$ 范数可以与误差的 $H^1$ 范数乘以对偶解的插值误差关联起来。这个插值误差引入了一个额外的因子 $h$，从而导致收敛阶比 $H^1$ 收敛率高一阶。这关键地依赖于对偶问题的 $H^2$ 正则性，对于这个具体问题，该性质是成立的。\n\n所推导出的收敛率 $p_{H^1}=1$ 和 $p_{L^2}=2$ 是当解足够正则时（如本例所示），二阶椭圆问题的连续分片线性有限元近似的标准最优收敛率。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本实践从理论收敛率转向有限元分析中一个常见的实际陷阱——“沙漏”现象。我们将研究一个看似合理的选择（减缩积分）如何引入非物理的零能变形模式，从而破坏解的完整性。本练习将引导你构造这样一个模式，并分析一种用于恢复方法稳定性与可靠性的稳定化技术。",
            "id": "3750617",
            "problem": "考虑一个边长为 $L$、常数厚度为 $t$ 的方形域上的单个等参双线性四边形单元（通常表示为 $Q_1$）的平面应变线性弹性问题。材料是均质的，拉梅参数为 $\\lambda$ 和 $\\mu$。位移场通过有限元法 (FEM) 进行近似，使用母单元正方形 $[-1,1] \\times [-1,1]$ 上的标准双线性形函数 $N_i(\\xi,\\eta)$，并通过 $x = \\frac{L}{2} \\xi$ 和 $y = \\frac{L}{2} \\eta$ 映射到物理坐标。线性弹性的弱形式得到单元刚度矩阵为 $K_e = \\int_{\\Omega_e} B^{\\top} D B \\, d\\Omega$，其中 $B$ 是应变-位移矩阵，$D$ 是用 $\\lambda$ 和 $\\mu$ 表示的平面应变弹性矩阵。\n\n在减缩积分下，单元刚度通过在中心 $(\\xi,\\eta)=(0,0)$ 处的单个高斯点近似为 $K_e^{\\mathrm{RI}} = B(0,0)^{\\top} D B(0,0) \\, A$，其中 $A = L^2$ 是单元面积。众所周知，这种欠积分会引入伪零能模式（沙漏模式）。\n\n1. 显式构造一个包含八个分量的节点位移模式 $d = [u_1^x, u_1^y, u_2^x, u_2^y, u_3^x, u_3^y, u_4^x, u_4^y]^{\\top}$，该模式在 $K_e^{\\mathrm{RI}}$ 下产生零应变能，并在 $B(0,0)$ 的层面上验证它是一个零能模式。仅使用双线性形函数及其在 $(0,0)$ 处导数的基本定义，以及上述等参映射。\n\n2. 为了消除沙漏模式，考虑在单元层面添加以下稳定化能：\n$$\nE_s(d) = \\alpha \\, t \\, \\frac{1}{L^2} \\left( \\left(u_1^x - u_2^x + u_3^x - u_4^x\\right)^2 + \\left(u_1^y - u_4^y + u_3^y - u_2^y\\right)^2 \\right),\n$$\n其中 $\\alpha>0$ 是一个稳定化参数，其单位的选择使得 $E_s$ 具有能量的单位。通过 $E_s(d) = \\frac{1}{2} d^{\\top} K_s d$ 定义相应的稳定化刚度为 $K_s$。\n\n以闭式形式计算稳定化刚度 $K_e^{\\mathrm{RI}} + K_s$ 在由第1部分中构造的两个伪模式所张成的沙漏子空间上的最小正特征值。将最终答案表示为关于 $\\alpha$、$t$ 和 $L$ 的符号解析表达式。\n\n最后，从基本原理出发，简要解释为什么减缩积分会产生您所构造的伪模式，以及上述稳定化方法或选择性积分方法如何通过改变离散算子使得沙漏子空间获得正刚度来解决这个问题。\n\n您的最终答案必须是单个闭式解析表达式。不需要四舍五入，最终表达式内不应包含单位。",
            "solution": "所提出的问题是有效的，因为它科学地基于连续介质力学和有限元法 (FEM) 的原理，是适定的、客观的和自洽的。它代表了计算力学中一个典型问题，涉及减缩积分单元中“沙漏”这一数值伪影及其稳定化。我们开始进行解答。\n\n该问题分三部分解决：第一，构造一个伪零能（沙漏）模式；第二，计算稳定化刚度矩阵在沙漏子空间上的特征值；第三，提供概念性解释。\n\n**第1部分：构造零能沙漏模式**\n\n单元内的位移场 $\\{u^x, u^y\\}$ 由节点位移 $d = [u_1^x, u_1^y, u_2^x, u_2^y, u_3^x, u_3^y, u_4^x, u_4^y]^{\\top}$ 通过双线性形函数 $N_i(\\xi, \\eta)$ 插值得到：\n$$\nu^x(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) u_i^x \\quad , \\quad u^y(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) u_i^y\n$$\n假设母单元 $[-1,1] \\times [-1,1]$ 的标准逆时针节点编号为：节点1在 $( -1, -1)$，节点2在 $(1, -1)$，节点3在 $(1, 1)$，节点4在 $(-1, 1)$。形函数为：\n$N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n\n从母坐标 $(\\xi, \\eta)$ 到物理坐标 $(x, y)$ 的映射由 $x = \\frac{L}{2} \\xi$ 和 $y = \\frac{L}{2} \\eta$ 给出。此变换的雅可比矩阵是常数：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L}{2}  0 \\\\ 0  \\frac{L}{2} \\end{pmatrix}\n$$\n逆雅可比矩阵为 $J^{-1} = \\begin{pmatrix} \\frac{2}{L}  0 \\\\ 0  \\frac{2}{L} \\end{pmatrix}$。形函数对物理坐标的导数通过链式法则求得：$\\left( \\frac{\\partial N_i}{\\partial x}, \\frac{\\partial N_i}{\\partial y} \\right)^\\top = J^{-1} \\left( \\frac{\\partial N_i}{\\partial \\xi}, \\frac{\\partial N_i}{\\partial \\eta} \\right)^\\top$。\n\n应变-位移矩阵 $B$ 通过 $\\varepsilon = B d$ 将应变向量 $\\varepsilon = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\top}$ 与节点位移向量 $d$ 联系起来。减缩积分在单元中心 $(\\xi, \\eta) = (0,0)$ 处计算 $B$。我们需要 $N_i$ 在该点的导数：\n$$\n\\left. \\frac{\\partial N_1}{\\partial \\xi} \\right|_{(0,0)} = -\\frac{1}{4}, \\quad \\left. \\frac{\\partial N_1}{\\partial \\eta} \\right|_{(0,0)} = -\\frac{1}{4}\n$$\n$$\n\\left. \\frac{\\partial N_2}{\\partial \\xi} \\right|_{(0,0)} = \\frac{1}{4}, \\quad \\left. \\frac{\\partial N_2}{\\partial \\eta} \\right|_{(0,0)} = -\\frac{1}{4}\n$$\n$$\n\\left. \\frac{\\partial N_3}{\\partial \\xi} \\right|_{(0,0)} = \\frac{1}{4}, \\quad \\left. \\frac{\\partial N_3}{\\partial \\eta} \\right|_{(0,0)} = \\frac{1}{4}\n$$\n$$\n\\left. \\frac{\\partial N_4}{\\partial \\xi} \\right|_{(0,0)} = -\\frac{1}{4}, \\quad \\left. \\frac{\\partial N_4}{\\partial \\eta} \\right|_{(0,0)} = \\frac{1}{4}\n$$\n中心点应变向量的分量为：\n$$\n\\varepsilon_{xx}(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial x}(0,0) u_i^x = \\frac{2}{L} \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial \\xi}(0,0) u_i^x = \\frac{1}{2L}(-u_1^x + u_2^x + u_3^x - u_4^x)\n$$\n$$\n\\varepsilon_{yy}(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial y}(0,0) u_i^y = \\frac{2}{L} \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial \\eta}(0,0) u_i^y = \\frac{1}{2L}(-u_1^y - u_2^y + u_3^y + u_4^y)\n$$\n$$\n\\gamma_{xy}(0,0) = \\sum_{i=1}^4 \\left( \\frac{\\partial N_i}{\\partial y}(0,0) u_i^x + \\frac{\\partial N_i}{\\partial x}(0,0) u_i^y \\right) = \\frac{1}{2L}[(-u_1^x - u_2^x + u_3^x + u_4^x) + (-u_1^y + u_2^y + u_3^y - u_4^y)]\n$$\n零能模式是一个非刚体位移向量 $d$，它导致在积分点处的应变为零，即 $\\varepsilon(0,0) = B(0,0)d=0$。这要求上述所有三个应变分量都为零。\n\n已知的典型沙漏模式与在节点上采样的常数场和线性场正交。让我们构造一个位移模式 $d^h$，其x方向位移与母单元上的 $\\xi\\eta$ 成正比，y方向位移为零。对于比例因子为1和节点1、2、3、4，$u^x \\propto \\xi\\eta$ 的节点值为 $[1, -1, 1, -1]^\\top$。因此我们测试节点位移向量：\n$$\nd = [1, 0, -1, 0, 1, 0, -1, 0]^{\\top}\n$$\n验证这是一个零能模式：\n$$\n\\varepsilon_{xx}(0,0) \\propto -u_1^x + u_2^x + u_3^x - u_4^x = -1 + (-1) + 1 - (-1) = 0\n$$\n$$\n\\varepsilon_{yy}(0,0) \\propto -u_1^y - u_2^y + u_3^y + u_4^y = 0 \\text{ (因为所有 } u_i^y=0)\n$$\n$$\n\\gamma_{xy}(0,0) \\propto (-u_1^x - u_2^x + u_3^x + u_4^x) + (-u_1^y + u_2^y + u_3^y - u_4^y) = (-1 - (-1) + 1 + (-1)) + 0 = 0\n$$\n中心点的所有三个应变分量都为零。这是一个非刚体运动，因此是一个伪零能模式。可以类似地为y方向位移构造第二个正交的沙漏模式：$[0, 1, 0, -1, 0, 1, 0, -1]^\\top$。问题要求构造一个这样的模式，我们已经构造出来了。\n\n**第2部分：稳定化刚度矩阵的特征值**\n\n沙漏子空间 $S$ 由上述识别的两个模式张成。我们定义这个子空间的基向量：\n$$\nv_1 = [1, 0, -1, 0, 1, 0, -1, 0]^{\\top}\n$$\n$$\nv_2 = [0, 1, 0, -1, 0, 1, 0, -1]^{\\top}\n$$\n这些向量是正交的，$v_1^{\\top} v_2 = 0$，其模方为 $\\|v_1\\|^2 = v_1^{\\top}v_1 = 4$ 和 $\\|v_2\\|^2 = v_2^{\\top}v_2 = 4$。\n\n稳定化刚度矩阵是 $K_{stab} = K_e^{\\mathrm{RI}} + K_s$。我们关心其限制在子空间 $S$ 上的特征值。对于任何向量 $d \\in S$，$d$ 位于 $K_e^{\\mathrm{RI}}$ 的零空间中，这意味着 $K_e^{\\mathrm{RI}}d = 0$。因此，子空间 $S$ 上的特征值问题简化为：\n$$\nK_s d = \\lambda d \\quad \\text{for } d \\in S\n$$\n稳定化能由 $E_s(d) = \\frac{1}{2} d^{\\top} K_s d$ 给出。问题提供了 $E_s(d)$ 的表达式：\n$$\nE_s(d) = \\alpha \\, t \\, \\frac{1}{L^2} \\left( \\left(u_1^x - u_2^x + u_3^x - u_4^x\\right)^2 + \\left(u_1^y - u_4^y + u_3^y - u_2^y\\right)^2 \\right)\n$$\n$u_1^y - u_4^y + u_3^y - u_2^y$ 项是 $u_1^y - u_2^y + u_3^y - u_4^y$ 的重新排序。这两个分量可以写成与我们基向量的内积：\n$$\nu_1^x - u_2^x + u_3^x - u_4^x = v_1^{\\top} d\n$$\n$$\nu_1^y - u_2^y + u_3^y - u_4^y = v_2^{\\top} d\n$$\n因此，稳定化能为：\n$$\nE_s(d) = \\frac{\\alpha t}{L^2} \\left( (v_1^{\\top} d)^2 + (v_2^{\\top} d)^2 \\right)\n$$\n根据定义 $E_s(d) = \\frac{1}{2} d^{\\top} K_s d$，我们可以确定稳定化刚度矩阵 $K_s$：\n$$\n\\frac{1}{2} d^{\\top} K_s d = \\frac{\\alpha t}{L^2} \\left( d^{\\top}v_1 v_1^{\\top}d + d^{\\top}v_2 v_2^{\\top}d \\right) = d^{\\top} \\left[ \\frac{\\alpha t}{L^2} (v_1 v_1^{\\top} + v_2 v_2^{\\top}) \\right] d\n$$\n我们必须注意因子 $1/2$。问题提供的 $E_s$ 没有这个因子，所以 $K_s$ 必须从 $d^\\top K_s d = 2 E_s$ 推导得出：\n$$\nd^\\top K_s d=2E_s \\implies K_s = \\frac{2\\alpha t}{L^2} (v_1 v_1^{\\top} + v_2 v_2^{\\top})\n$$\n让我们找出 $K_s$ 对基向量 $v_1$ 和 $v_2$ 的作用。\n$$\nK_s v_1 = \\frac{2\\alpha t}{L^2} (v_1 v_1^{\\top} + v_2 v_2^{\\top}) v_1 = \\frac{2\\alpha t}{L^2} (v_1(v_1^{\\top}v_1) + v_2(v_2^{\\top}v_1))\n$$\n使用 $v_1^{\\top}v_1 = 4$ 和 $v_2^{\\top}v_1 = 0$：\n$$\nK_s v_1 = \\frac{2\\alpha t}{L^2} (v_1 \\cdot 4 + v_2 \\cdot 0) = \\frac{8\\alpha t}{L^2} v_1\n$$\n这表明 $v_1$ 是 $K_s$ 的一个特征向量，其特征值为 $\\lambda_1 = \\frac{8\\alpha t}{L^2}$。\n类似地，对于 $v_2$：\n$$\nK_s v_2 = \\frac{2\\alpha t}{L^2} (v_1 v_1^{\\top} + v_2 v_2^{\\top}) v_2 = \\frac{2\\alpha t}{L^2} (v_1(v_1^{\\top}v_2) + v_2(v_2^{\\top}v_2))\n$$\n使用 $v_1^{\\top}v_2 = 0$ 和 $v_2^{\\top}v_2 = 4$：\n$$\nK_s v_2 = \\frac{2\\alpha t}{L^2} (v_1 \\cdot 0 + v_2 \\cdot 4) = \\frac{8\\alpha t}{L^2} v_2\n$$\n这表明 $v_2$ 是 $K_s$ 的一个特征向量，其特征值为 $\\lambda_2 = \\frac{8\\alpha t}{L^2}$。\n由于子空间 $S$ 的两个基向量都是具有相同特征值的特征向量，因此 $S$ 中的任何向量 $d$ 也是具有该特征值的特征向量。沙漏子空间是 $K_s$ 的一个二维特征空间，对应于单一特征值 $\\frac{8\\alpha t}{L^2}$。因为 $\\alpha > 0$，所以该特征值为正。因此，这是 $K_s$ 限制在 $S$ 上的最小（也是唯一）正特征值。\n\n**第3部分：概念性解释**\n\n减缩积分之所以会导致伪零能模式，是因为它无法准确地感知某些变形模式。单元的应变能是应变能密度在单元体积上的积分。除非是刚体运动，否则非零变形应产生正应变能。数值积分将此积分近似为在少数几个高斯点上计算的被积函数的加权和。对于减缩积分（例如，双线性四边形单元的单点积分），零能量的条件从要求处处应变为零放宽到仅要求在该单点处应变为零。沙漏模式是特殊的变形模式，例如第1部分中构造的模式，其对应的应变场在单元域内非零，但恰好在用于积分的中心点处为零。数值积分方案对这些模式是“盲目”的，赋予它们零应变能，这使得全局刚度矩阵在考虑边界条件后是奇异的，并允许解中出现不受控制的、物理上无意义的振荡。\n\n稳定化方法纠正了这一缺陷。问题中描述的方法是一种沙漏控制形式。其工作原理是在单元的势能中增加一个罚能量项 $E_s$。该项经过精心构造，对于所有良好行为的变形模式（刚体运动和常应变状态）为零，但对于伪沙漏模式为正。这是通过创建一个离散算子（例如 $v_1^{\\top} d$）来实现的，该算子测量节点位移中沙漏模式的大小。增加的能量项产生一个附加的刚度矩阵 $K_s$，它在沙漏子空间上是正定的，但在“好”模式的子空间上为零。当加到原始的秩亏减缩积分刚度矩阵 $K_e^{\\mathrm{RI}}$ 上时，组合矩阵 $K_e^{\\mathrm{RI}} + K_s$ 对所有非刚体模式都变为正定，从而恢复了单元的稳定性并消除了伪解。\n\n选择性积分是另一种方法。它涉及对畸变能表达式中的不同项使用不同的求积规则。通常，导致体积“锁定”的项采用减缩积分，而控制剪切变形（与沙漏有关）的项则采用完全积分。这选择性地只加强必要的变形模式以抑制沙漏，而不会重新引入锁定，提供了一种无需任意稳定化参数 $\\alpha$ 的优雅解决方案。",
            "answer": "$$\n\\boxed{\\frac{8 \\alpha t}{L^2}}\n$$"
        }
    ]
}