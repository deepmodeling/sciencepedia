{
    "hands_on_practices": [
        {
            "introduction": "从基本原理出发构建形函数是有限元方法的基石。本练习将引导您使用基本的克罗内克-德尔塔性质，推导一维二次形函数。掌握这个简单案例的推导过程，将为您处理更复杂的高维单元打下坚实的基础 ()。",
            "id": "3753697",
            "problem": "在多尺度建模与分析中的多尺度有限元法（MsFEM）的背景下，考虑参考区间 $\\xi \\in [-1,1]$ 上的一个一维等参单元，其三个节点位于 $\\xi_{-1}=-1$、$\\xi_{0}=0$ 和 $\\xi_{1}=1$。宏观尺度近似使用的单元形函数是关于参考坐标 $\\xi$ 的次数至多为 $2$ 的多项式，并且必须满足用于尺度桥接和分片检验的以下基本要求：节点上的克罗内克-德尔塔插值性质、单位分解性，以及当节点值从任意线性场中采样时，能够在单元上再生该线性场。\n\n请仅使用这些原理和拉格朗日插值的标准定义，推导与节点 $\\xi_{-1}=-1$、$\\xi_{0}=0$ 和 $\\xi_{1}=1$ 相关联的二次形函数 $N_{-1}(\\xi)$、$N_{0}(\\xi)$ 和 $N_{1}(\\xi)$ 的显式表达式。您的推导必须从克罗内克-德尔塔条件 $N_{i}(\\xi_{j})=\\delta_{ij}$ 出发，其中 $\\delta_{ij}$ 表示克罗内克-德尔塔，并为每个 $N_{i}(\\xi)$ 给出以 $\\xi$ 为变量的多项式闭式表达式。\n\n请将最终答案表示为一个单行矩阵，其中包含用 $\\xi$ 表示的三个形函数。无需四舍五入。无需单位。",
            "solution": "该问题陈述经评估有效。这是一个适定的、具有科学依据的问题，源于有限元分析领域，而有限元分析是多尺度建模的核心组成部分。该问题为推导所需的形函数提供了所有必要信息，且不含任何矛盾或歧义。\n\n目标是为一个定义在参考域 $\\xi \\in [-1, 1]$ 上的一维三节点单元推导二次形函数 $N_i(\\xi)$。节点位于 $\\xi_{-1} = -1$、$\\xi_0 = 0$ 和 $\\xi_1 = 1$。要求形函数是次数至多为 $2$ 的多项式，并且必须满足在节点处的克罗内克-德尔塔性质，即 $N_i(\\xi_j) = \\delta_{ij}$，其中克罗内克-德尔塔 $\\delta_{ij}$ 定义为：如果 $i=j$，则 $\\delta_{ij} = 1$；如果 $i \\neq j$，则 $\\delta_{ij}=0$。\n\n构造满足克罗内克-德尔塔性质的多项式形函数，最直接和系统的方法是使用拉格朗日插值多项式的一般公式。对于一组 $n+1$ 个节点 $\\{\\xi_k\\}_{k=0}^n$，与节点 $\\xi_i$ 相关联的拉格朗日基多项式 $N_i(\\xi)$ 由下式给出：\n$$\nN_i(\\xi) = \\prod_{j \\neq i} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}\n$$\n根据其构造，该公式得出一个次数为 $n$ 的多项式，它在 $\\xi = \\xi_i$ 处的值为 $1$，在所有其他节点 $\\xi_j$（其中 $j \\neq i$）处的值为 $0$，从而满足条件 $N_i(\\xi_j) = \\delta_{ij}$。\n\n在此问题中，我们有三个节点（$\\xi_{-1} = -1$、$\\xi_0 = 0$、$\\xi_1 = 1$），因此形函数将是二次多项式（$n=2$）。我们应用拉格朗日公式来推导每一个形函数。\n\n$N_{-1}(\\xi)$ 的推导：\n节点 $\\xi_{-1} = -1$ 的形函数在 $\\xi_0 = 0$ 和 $\\xi_1 = 1$ 处必须为零。乘积的索引为 $j=0, 1$。\n$$\nN_{-1}(\\xi) = \\frac{\\xi - \\xi_0}{\\xi_{-1} - \\xi_0} \\cdot \\frac{\\xi - \\xi_1}{\\xi_{-1} - \\xi_1}\n$$\n代入节点坐标值：\n$$\nN_{-1}(\\xi) = \\frac{\\xi - 0}{-1 - 0} \\cdot \\frac{\\xi - 1}{-1 - 1} = \\left(\\frac{\\xi}{-1}\\right) \\cdot \\left(\\frac{\\xi - 1}{-2}\\right) = \\frac{\\xi(\\xi - 1)}{2}\n$$\n可以展开为 $N_{-1}(\\xi) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi$，这是一个二次多项式。\n\n$N_0(\\xi)$ 的推导：\n节点 $\\xi_0 = 0$ 的形函数在 $\\xi_{-1} = -1$ 和 $\\xi_1 = 1$ 处必须为零。乘积的索引为 $j=-1, 1$。\n$$\nN_0(\\xi) = \\frac{\\xi - \\xi_{-1}}{\\xi_0 - \\xi_{-1}} \\cdot \\frac{\\xi - \\xi_1}{\\xi_0 - \\xi_1}\n$$\n代入节点坐标值：\n$$\nN_0(\\xi) = \\frac{\\xi - (-1)}{0 - (-1)} \\cdot \\frac{\\xi - 1}{0 - 1} = \\left(\\frac{\\xi + 1}{1}\\right) \\cdot \\left(\\frac{\\xi - 1}{-1}\\right) = -(\\xi + 1)(\\xi - 1) = -(\\xi^2 - 1) = 1 - \\xi^2\n$$\n这也是一个二次多项式。\n\n$N_1(\\xi)$ 的推导：\n节点 $\\xi_1 = 1$ 的形函数在 $\\xi_{-1} = -1$ 和 $\\xi_0 = 0$ 处必须为零。乘积的索引为 $j=-1, 0$。\n$$\nN_1(\\xi) = \\frac{\\xi - \\xi_{-1}}{\\xi_1 - \\xi_{-1}} \\cdot \\frac{\\xi - \\xi_0}{\\xi_1 - \\xi_0}\n$$\n代入节点坐标值：\n$$\nN_1(\\xi) = \\frac{\\xi - (-1)}{1 - (-1)} \\cdot \\frac{\\xi - 0}{1 - 0} = \\left(\\frac{\\xi + 1}{2}\\right) \\cdot \\left(\\frac{\\xi}{1}\\right) = \\frac{\\xi(\\xi + 1)}{2}\n$$\n可以展开为 $N_1(\\xi) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi$，这是一个二次多项式。\n\n推导出的形函数为：\n$N_{-1}(\\xi) = \\frac{1}{2}\\xi(\\xi - 1)$\n$N_0(\\xi) = 1 - \\xi^2$\n$N_1(\\xi) = \\frac{1}{2}\\xi(\\xi + 1)$\n\n作为验证，这些函数也满足单位分解性，这是问题陈述中提到的另一个基本要求。在单元上的任何位置，形函数之和必须等于 $1$：\n$$\n\\sum_{i} N_i(\\xi) = N_{-1}(\\xi) + N_0(\\xi) + N_1(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1 - \\xi^2) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right)\n$$\n$$\n\\sum_{i} N_i(\\xi) = \\left(\\frac{1}{2} - 1 + \\frac{1}{2}\\right)\\xi^2 + \\left(-\\frac{1}{2} + \\frac{1}{2}\\right)\\xi + 1 = 0 \\cdot \\xi^2 + 0 \\cdot \\xi + 1 = 1\n$$\n单位分解性得到满足。对于拉格朗日多项式，其线性再生性质也通过构造得到满足。因此，基于克罗内克-德尔塔性质通过拉格朗日插值公式进行的推导是完整且正确的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}\\xi(\\xi - 1) & 1 - \\xi^2 & \\frac{1}{2}\\xi(\\xi + 1) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "与矩形单元相比，三角形单元需要一种不同的处理方法，通常使用重心（或面积）坐标来实现优雅的公式化。本练习将形函数的推导概念扩展到二维的6节点二次三角形单元。通过在重心坐标系下进行操作，您将学习如何系统地在非矩形域上构建高阶插值 ()。",
            "id": "2635668",
            "problem": "考虑平面上的一个非退化三角形。定义与其三个顶点相关联的重心坐标（也称面积坐标）$\\{L_{1},L_{2},L_{3}\\}$，这些坐标在三角形内处处满足 $L_{1}+L_{2}+L_{3}=1$，并在顶点1、顶点2和顶点3处取节点值分别为 $(L_{1},L_{2},L_{3})=(1,0,0)$、$(0,1,0)$ 和 $(0,0,1)$。该三角形上的一个六节点二次拉格朗日有限元有三个额外的边中点节点，分别位于边 $(2,3)$、$(3,1)$ 和 $(1,2)$ 的中点，其重心坐标分别为 $(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$(\\tfrac{1}{2},0,\\tfrac{1}{2})$ 和 $(\\tfrac{1}{2},\\tfrac{1}{2},0)$。设节点编号为：顶点为 $1,2,3$，与顶点 $1,2,3$ 相对的边中点分别为 $4,5,6$（即节点 $4$ 在边 $(2,3)$ 上，节点 $5$ 在边 $(3,1)$ 上，节点 $6$ 在边 $(1,2)$ 上）。\n\n仅从重心坐标的定义性质和单纯形上二次拉格朗日形函数的节点插值（克罗内克-δ）性质出发，显式地构造六个二次形函数 $\\{N_{i}(L_{1},L_{2},L_{3})\\}_{i=1}^{6}$，并用 $L_{1},L_{2},L_{3}$ 表示。然后，通过直接求值来验证，在每个边中点节点处，对应的形函数取值为 $1$，而所有其他形函数均为零。\n\n将您的最终答案表示为关于 $L_{1},L_{2},L_{3}$ 的有序行向量 $\\big(N_{1},N_{2},N_{3},N_{4},N_{5},N_{6}\\big)$。无需数值舍入。不涉及单位。",
            "solution": "问题陈述经评估有效。它以有限元分析理论为科学基础，提出了一个包含所有必要数据的适定数学任务，并以客观、明确的语言表述。我们将进行推导。\n\n目标是为六节点三角形单元构造六个二次形函数 $N_i(L_1, L_2, L_3)$。这些函数必须在单元的六个节点上满足克罗内克-δ性质，即 $N_i(\\text{节点 } j) = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克-δ。这些节点由其重心坐标定义：\n- 顶点 1: $(1, 0, 0)$\n- 顶点 2: $(0, 1, 0)$\n- 顶点 3: $(0, 0, 1)$\n- 边中点 4 (顶点1的对边): $(0, \\tfrac{1}{2}, \\tfrac{1}{2})$\n- 边中点 5 (顶点2的对边): $(\\tfrac{1}{2}, 0, \\tfrac{1}{2})$\n- 边中点 6 (顶点3的对边): $(\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$\n\n形函数必须是关于重心坐标的二次多项式。在单纯形上构造拉格朗日插值多项式的一般方法是，构造在适当节点处为零的线性函数的乘积。\n\n首先，我们构造顶点节点 $N_1$、$N_2$ 和 $N_3$ 的形函数。\n\n考虑与顶点1关联的形函数 $N_1$。它在节点1处必须等于 $1$，而在节点2、3、4、5和6处必须等于 $0$。\n节点2、3和4位于由 $L_1 = 0$ 定义的直线上。\n节点5和6位于由 $L_1 = \\tfrac{1}{2}$ 定义的直线上。这条线穿过 $(\\tfrac{1}{2}, 0, \\tfrac{1}{2})$ 和 $(\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$。\n因此，函数 $N_1$ 必须在直线 $L_1=0$ 和 $L_1=\\tfrac{1}{2}$ 上为零。满足此条件的二次多项式形式为 $C \\cdot L_1 \\cdot (L_1 - \\tfrac{1}{2})$。\n我们写作 $N_1 = C \\cdot L_1 (L_1 - \\tfrac{1}{2})$。\n为了确定常数 $C$，我们使用条件 $N_1(1,0,0) = 1$。\n$N_1(1,0,0) = C \\cdot 1 \\cdot (1 - \\tfrac{1}{2}) = \\tfrac{1}{2} C$。\n令 $\\tfrac{1}{2} C = 1$ 得 $C = 2$。\n因此，节点1的形函数为：\n$N_1 = 2 L_1 (L_1 - \\tfrac{1}{2}) = L_1(2L_1 - 1)$。\n利用基本性质 $L_1+L_2+L_3=1$，我们也可以将其表示为 $N_1 = L_1(L_1 - L_2 - L_3)$。\n\n根据对称性，其他两个顶点节点2和3的形函数为：\n$N_2 = L_2(2L_2 - 1)$\n$N_3 = L_3(2L_3 - 1)$\n\n接下来，我们构造边中点节点 $N_4$、$N_5$ 和 $N_6$ 的形函数。\n\n考虑与边中点节点4关联的形函数 $N_4$。它在节点4处必须等于 $1$，而在所有其他节点处必须等于 $0$。\n节点4的坐标为 $(0, \\tfrac{1}{2}, \\tfrac{1}{2})$。\n$N_4$ 必须为零的节点是1、2、3、5、6。\n节点1、5、3位于直线 $L_2=0$ 上。\n节点1、6、2位于直线 $L_3=0$ 上。\n这两个线性函数的乘积 $L_2 L_3$ 是一个二次多项式，它在除节点4外的所有节点上都为零。\n所以，我们可以提出 $N_4$ 的形式为 $N_4 = C \\cdot L_2 L_3$。\n为了确定常数 $C$，我们使用条件 $N_4(0, \\tfrac{1}{2}, \\tfrac{1}{2}) = 1$。\n$N_4(0, \\tfrac{1}{2}, \\tfrac{1}{2}) = C \\cdot (\\tfrac{1}{2}) \\cdot (\\tfrac{1}{2}) = \\tfrac{1}{4} C$。\n令 $\\tfrac{1}{4} C = 1$ 得 $C = 4$。\n因此，节点4的形函数为：\n$N_4 = 4L_2 L_3$。\n\n根据对称性，其他两个边中点节点5和6的形函数为：\n$N_5 = 4L_3 L_1$ (在 $L_3=0$ 和 $L_1=0$ 上为零)\n$N_6 = 4L_1 L_2$ (在 $L_1=0$ 和 $L_2=0$ 上为零)\n\n六个二次形函数的完整集合是：\n$N_1 = L_1(2L_1-1)$\n$N_2 = L_2(2L_2-1)$\n$N_3 = L_3(2L_3-1)$\n$N_4 = 4L_2L_3$\n$N_5 = 4L_1L_3$\n$N_6 = 4L_1L_2$\n\n按照要求，我们现在验证在边中点节点处的插值性质。\n\n在节点4处验证，坐标为 $(L_1, L_2, L_3) = (0, \\tfrac{1}{2}, \\tfrac{1}{2})$：\n$N_1 = 0 \\cdot (2 \\cdot 0 - 1) = 0$\n$N_2 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_3 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_4 = 4 \\cdot \\tfrac{1}{2} \\cdot \\tfrac{1}{2} = 1$\n$N_5 = 4 \\cdot 0 \\cdot \\tfrac{1}{2} = 0$\n$N_6 = 4 \\cdot 0 \\cdot \\tfrac{1}{2} = 0$\n该性质对节点4成立。\n\n在节点5处验证，坐标为 $(L_1, L_2, L_3) = (\\tfrac{1}{2}, 0, \\tfrac{1}{2})$：\n$N_1 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_2 = 0 \\cdot (2 \\cdot 0 - 1) = 0$\n$N_3 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_4 = 4 \\cdot 0 \\cdot \\tfrac{1}{2} = 0$\n$N_5 = 4 \\cdot \\tfrac{1}{2} \\cdot \\tfrac{1}{2} = 1$\n$N_6 = 4 \\cdot \\tfrac{1}{2} \\cdot 0 = 0$\n该性质对节点5成立。\n\n在节点6处验证，坐标为 $(L_1, L_2, L_3) = (\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$:\n$N_1 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_2 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_3 = 0 \\cdot (2 \\cdot 0 - 1) = 0$\n$N_4 = 4 \\cdot \\tfrac{1}{2} \\cdot 0 = 0$\n$N_5 = 4 \\cdot 0 \\cdot \\tfrac{1}{2} = 0$\n$N_6 = 4 \\cdot \\tfrac{1}{2} \\cdot \\tfrac{1}{2} = 1$\n该性质对节点6成立。\n\n验证完成。推导出的函数是正确的。作为严谨性的最后检查，我们可以验证单位分解性质，$\\sum_{i=1}^{6} N_i = 1$：\n$\\sum N_i = (2L_1^2 - L_1) + (2L_2^2 - L_2) + (2L_3^2 - L_3) + 4L_1L_2 + 4L_2L_3 + 4L_1L_3$\n$= 2(L_1^2 + L_2^2 + L_3^2 + 2L_1L_2 + 2L_2L_3 + 2L_1L_3) - (L_1+L_2+L_3)$\n$= 2(L_1+L_2+L_3)^2 - (L_1+L_2+L_3)$\n使用恒等式 $L_1+L_2+L_3=1$，我们得到：\n$\\sum N_i = 2(1)^2 - 1 = 1$。\n单位分解性质得到满足，证实了形函数的正确性。这六个形函数的有序向量即为所求结果。",
            "answer": "$$\\boxed{\\begin{pmatrix} L_1(2L_1-1) & L_2(2L_2-1) & L_3(2L_3-1) & 4L_2 L_3 & 4L_1 L_3 & 4L_1 L_2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "等参映射功能强大，但其性质会随着单元的扭曲而退化，从而影响求解精度。本练习探讨了使用非平行四边形四边形单元的后果，特别是检验了线性完备性的损失和雅可比行列式的行为。这种分析对于理解网格质量和避免有限元模拟中的常见陷阱至关重要 ()。",
            "id": "3753715",
            "problem": "考虑一个单一的等参双线性四边形单元，其参考坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，物理角节点为 $\\boldsymbol{X}_i=(x_i,y_i)$（$i=1,2,3,4$），从$(-1,-1)$的像点开始逆时针排序。设双线性形函数为 $N_1(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$，$N_2(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$，$N_3(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$，以及 $N_4(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$。等参映射为 $\\boldsymbol{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,\\boldsymbol{X}_i$。给定一个物理线性场 $f(x,y)=a\\,x+b\\,y+c$，其中 $a$、$b$ 和 $c$ 为常数，并定义其节点采样值 $f_i=f(x_i,y_i)$（$i=1,2,3,4$）。考虑 $Q_1$ 插值 $u_h(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,f_i$。\n\n仅从上述定义出发，不使用任何特定于单元的快捷公式，完成以下操作：\n\n1. 将 $u_h(\\xi,\\eta)$ 展开为 $\\xi$ 和 $\\eta$ 的多项式，并以闭合形式确定混合项 $\\xi\\,\\eta$ 的系数，该系数用 $a$、$b$ 和节点坐标 $\\{(x_i,y_i)\\}_{i=1}^{4}$ 表示。将此系数表示为单个解析表达式。\n2. 使用第1部分的结果和仿射映射的基本性质，解释在 $\\{\\boldsymbol{X}_i\\}_{i=1}^{4}$ 上的何种几何条件下，插值 $u_h$ 表示物理坐标 $(x,y)$ 的线性函数，并从几何上解释这个条件。\n3. 令 $\\boldsymbol{J}(\\xi,\\eta)=\\begin{pmatrix}\\partial x/\\partial \\xi & \\partial x/\\partial \\eta\\\\ \\partial y/\\partial \\xi & \\partial y/\\partial \\eta\\end{pmatrix}$ 表示等参映射的雅可比矩阵，并令 $\\det \\boldsymbol{J}(\\xi,\\eta)$ 表示其行列式。推导 $\\det \\boldsymbol{J}(\\xi,\\eta)$ 对 $\\xi$ 和 $\\eta$ 的依赖关系，并用此证明两个标量网格质量度量，如果在适当的采样点上强制施加正下界，则能保证在单元内任何地方都有 $\\det \\boldsymbol{J}(\\xi,\\eta)>0$。提供这些度量的明确公式（用节点坐标和边向量表示），并仅使用凸域上线性函数的基本性质来证明其充分性。\n\n你提供的最终答案必须仅为第1部分中混合项 $\\xi\\,\\eta$ 的系数，表示为单个闭合形式的解析表达式。不要包含任何单位。不需要进行数值舍入。",
            "solution": "该问题陈述是等参有限元理论中的一个标准练习，具有科学依据、问题明确、客观且内部一致。因此，它被认为是有效的，并将在下面提供解答。\n\n解答将按顺序处理问题的三个部分，从给定的定义开始。\n\n### 第1部分：混合项 $\\xi\\eta$ 的系数\n\n$Q_1$ 插值 $u_h(\\xi,\\eta)$ 定义为：\n$$\nu_h(\\xi,\\eta) = \\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,f_i\n$$\n形函数 $N_i(\\xi,\\eta)$ 和节点值 $f_i$ 是给定的。我们展开这个求和式：\n$$\nu_h(\\xi,\\eta) = N_1(\\xi,\\eta)f_1 + N_2(\\xi,\\eta)f_2 + N_3(\\xi,\\eta)f_3 + N_4(\\xi,\\eta)f_4\n$$\n代入双线性形函数 $N_i$ 的表达式：\n$$\nu_h(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)f_1 + \\frac{1}{4}(1+\\xi)(1-\\eta)f_2 + \\frac{1}{4}(1+\\xi)(1+\\eta)f_3 + \\frac{1}{4}(1-\\xi)(1+\\eta)f_4\n$$\n为了找到 $\\xi\\eta$ 项的系数，我们展开每个乘积并收集包含 $\\xi\\eta$ 的项：\n\\begin{itemize}\n    \\item 来自第一项：$\\frac{1}{4}(1-\\xi-\\eta+\\xi\\eta)f_1$，$\\xi\\eta$ 的贡献是 $\\frac{1}{4}f_1\\xi\\eta$。\n    \\item 来自第二项：$\\frac{1}{4}(1+\\xi-\\eta-\\xi\\eta)f_2$，$\\xi\\eta$ 的贡献是 $-\\frac{1}{4}f_2\\xi\\eta$。\n    \\item 来自第三项：$\\frac{1}{4}(1+\\xi+\\eta+\\xi\\eta)f_3$，$\\xi\\eta$ 的贡献是 $\\frac{1}{4}f_3\\xi\\eta$。\n    \\item 来自第四项：$\\frac{1}{4}(1-\\xi+\\eta-\\xi\\eta)f_4$，$\\xi\\eta$ 的贡献是 $-\\frac{1}{4}f_4\\xi\\eta$。\n\\end{itemize}\n将这些贡献相加，$\\xi\\eta$ 项的总系数（我们记为 $C_{\\xi\\eta}$）是：\n$$\nC_{\\xi\\eta} = \\frac{1}{4}(f_1 - f_2 + f_3 - f_4)\n$$\n问题要求将此系数用常数 $a$、$b$ 和节点坐标 $(x_i, y_i)$ 表示。节点采样值由 $f_i = f(x_i,y_i) = a\\,x_i+b\\,y_i+c$ 定义。将这些代入 $C_{\\xi\\eta}$ 的表达式中：\n$$\nC_{\\xi\\eta} = \\frac{1}{4} \\left[ (a\\,x_1+b\\,y_1+c) - (a\\,x_2+b\\,y_2+c) + (a\\,x_3+b\\,y_3+c) - (a\\,x_4+b\\,y_4+c) \\right]\n$$\n常数 $c$ 项相互抵消：$(c-c+c-c)=0$。我们可以按系数 $a$ 和 $b$ 对剩余项进行分组：\n$$\nC_{\\xi\\eta} = \\frac{1}{4} \\left[ a(x_1 - x_2 + x_3 - x_4) + b(y_1 - y_2 + y_3 - y_4) \\right]\n$$\n这就是 $\\xi\\eta$ 项系数的最终表达式。\n\n### 第2部分：线性的几何条件\n\n如果插值场在用 $(x,y)$ 表示时具有 $A\\,x+B\\,y+C$ 的形式（其中 $A, B, C$ 是常数），则插值 $u_h$ 表示物理坐标 $(x,y)$ 的一个线性函数。\n\n根据等参方法的构造，线性函数的插值在单元内的所有点上都能再现函数的值，即 $u_h(\\xi(\\boldsymbol{x}),\\eta(\\boldsymbol{x})) = f(x,y) = a\\,x+b\\,y+c$。这个恒等式对任何四边形都成立，意味着在物理点 $\\boldsymbol{x}$ 处的插值与原始线性函数 $f$ 在该点的值完全相同。因此，根据定义，$u_h$ *就是*线性函数 $f(x,y)$。\n\n然而，问题隐含地询问在什么条件下插值的*函数形式*会适当地退化。让我们分析一下映射。插值是 $(\\xi, \\eta)$ 的双线性多项式：$u_h(\\xi, \\eta) = c_0 + c_\\xi\\xi + c_\\eta\\eta + C_{\\xi\\eta}\\xi\\eta$。物理坐标也由双线性映射给出：$\\boldsymbol{x}(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) \\boldsymbol{X}_i$。为了使 $u_h$ 成为 $(x,y)$ 的线性函数，我们需要这两种表示之间具有相容性。\n\n仿射映射 $\\boldsymbol{x} = \\boldsymbol{A} \\boldsymbol{\\xi} + \\boldsymbol{d}$ 保持线性；也就是说，$\\boldsymbol{\\xi}$ 的线性函数会成为 $\\boldsymbol{x}$ 的线性函数。如果等参映射 $\\boldsymbol{x}(\\xi,\\eta)$ 是仿射的，其逆映射 $\\boldsymbol{\\xi}(\\boldsymbol{x})$ 也是仿射的。\n让我们像展开 $u_h$ 一样展开等参映射 $\\boldsymbol{x}(\\xi,\\eta)$：\n$$\n\\boldsymbol{x}(\\xi,\\eta) = \\frac{1}{4} \\left[ (\\boldsymbol{X}_1+\\boldsymbol{X}_2+\\boldsymbol{X}_3+\\boldsymbol{X}_4) + (-\\boldsymbol{X}_1+\\boldsymbol{X}_2+\\boldsymbol{X}_3-\\boldsymbol{X}_4)\\xi + (-\\boldsymbol{X}_1-\\boldsymbol{X}_2+\\boldsymbol{X}_3+\\boldsymbol{X}_4)\\eta + (\\boldsymbol{X}_1-\\boldsymbol{X}_2+\\boldsymbol{X}_3-\\boldsymbol{X}_4)\\xi\\eta \\right]\n$$\n为使此映射为仿射映射，非线性项 $\\xi\\eta$ 的系数必须为零。这给出了几何条件：\n$$\n\\boldsymbol{X}_1 - \\boldsymbol{X}_2 + \\boldsymbol{X}_3 - \\boldsymbol{X}_4 = \\boldsymbol{0}\n$$\n这个矢量方程可以重新排列为 $\\boldsymbol{X}_1 + \\boldsymbol{X}_3 = \\boldsymbol{X}_2 + \\boldsymbol{X}_4$。两边除以2得到：\n$$\n\\frac{\\boldsymbol{X}_1+\\boldsymbol{X}_3}{2} = \\frac{\\boldsymbol{X}_2+\\boldsymbol{X}_4}{2}\n$$\n这个方程表明，连接节点1和3的对角线的中点必须与连接节点2和4的对角线的中点重合。**这是平行四边形的定义性几何属性。**\n\n如果单元是平行四边形，此条件成立。因此，$u_h$ 中 $\\xi\\eta$ 项的系数 $C_{\\xi\\eta}$ 变为：\n$$\nC_{\\xi\\eta} = \\frac{1}{4} \\left[ a(x_1 - x_2 + x_3 - x_4) + b(y_1 - y_2 + y_3 - y_4) \\right] = \\frac{1}{4} \\left[ a(0) + b(0) \\right] = 0\n$$\n由于 $C_{\\xi\\eta}=0$，插值 $u_h(\\xi, \\eta)$ 在 $(\\xi, \\eta)$ 中变为线性的。由于对于平行四边形，从物理坐标到参考坐标的映射 $\\boldsymbol{\\xi}(\\boldsymbol{x})$ 是仿射的，将 $\\xi(x,y)$ 和 $\\eta(x,y)$ 代入 $(\\xi, \\eta)$ 的线性函数中，会得到一个在 $(x,y)$ 中也是线性的函数。因此，要使*任何*线性场的插值 $u_h$ 成为 $(x,y)$ 的线性函数，四边形单元必须是平行四边形。\n\n### 第3部分：雅可比行列式和网格质量度量\n\n等参映射的雅可比矩阵是 $\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix} \\partial\\boldsymbol{x}/\\partial\\xi & \\partial\\boldsymbol{x}/\\partial\\eta \\end{pmatrix}$。其列是切向量。\n$$\n\\frac{\\partial\\boldsymbol{x}}{\\partial\\xi} = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial\\xi} \\boldsymbol{X}_i \\quad \\text{和} \\quad \\frac{\\partial\\boldsymbol{x}}{\\partial\\eta} = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial\\eta} \\boldsymbol{X}_i\n$$\n形函数的导数是 $\\xi$ 或 $\\eta$ 的线性函数。例如，$\\frac{\\partial N_1}{\\partial\\xi} = -\\frac{1}{4}(1-\\eta)$ 和 $\\frac{\\partial N_1}{\\partial\\eta} = -\\frac{1}{4}(1-\\xi)$。因此，切向量 $\\partial\\boldsymbol{x}/\\partial\\xi$ 和 $\\partial\\boldsymbol{x}/\\partial\\eta$ 分别是 $\\eta$ 和 $\\xi$ 的线性函数。\n让我们组合切向量：\n$$\n\\frac{\\partial\\boldsymbol{x}}{\\partial\\xi} = \\frac{1}{4} [ (\\boldsymbol{X}_2-\\boldsymbol{X}_1)(1-\\eta) + (\\boldsymbol{X}_3-\\boldsymbol{X}_4)(1+\\eta) ]\n$$\n$$\n\\frac{\\partial\\boldsymbol{x}}{\\partial\\eta} = \\frac{1}{4} [ (\\boldsymbol{X}_4-\\boldsymbol{X}_1)(1-\\xi) + (\\boldsymbol{X}_3-\\boldsymbol{X}_2)(1+\\xi) ]\n$$\n行列式 $\\det\\boldsymbol{J}(\\xi,\\eta) = \\det(\\partial\\boldsymbol{x}/\\partial\\xi, \\partial\\boldsymbol{x}/\\partial\\eta)$ 是 $\\xi$ 和 $\\eta$ 的多项式。利用行列式的双线性性质展开，可以发现不会产生像 $\\xi^2$、$\\eta^2$、$\\xi^2\\eta$ 这样的交叉项。最高阶项是 $\\xi\\eta$，但经计算其系数为零。最终的表达式是 $\\xi$ 和 $\\eta$ 的线性函数：\n$$\n\\det\\boldsymbol{J}(\\xi,\\eta) = J_0 + J_\\xi \\xi + J_\\eta \\eta\n$$\n其中 $J_0, J_\\xi, J_\\eta$ 是依赖于节点坐标的常数。定义在凸域（如参考正方形 $[-1,1]\\times[-1,1]$）上的线性函数，在域的顶点处取得其最小值和最大值。在这种情况下，顶点是四个角点 $(\\xi, \\eta) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$。\n\n因此，保证在单元内任何地方 $\\det\\boldsymbol{J}(\\xi,\\eta)>0$ 的一个充分条件是，确保 $\\det\\boldsymbol{J}(\\xi,\\eta)$ 在这四个角点处为正。这引出了以下建议的度量。\n\n**度量1：最小角点雅可比值 ($J_{min}$)**\n该度量是在参考单元的四个角点处计算的雅可比行列式的最小值。\n$$\nJ_{min} = \\min \\{ \\det\\boldsymbol{J}(-1,-1), \\det\\boldsymbol{J}(1,-1), \\det\\boldsymbol{J}(1,1), \\det\\boldsymbol{J}(-1,1) \\}\n$$\n让我们提供显式公式。令 $\\boldsymbol{E}_{ij} = \\boldsymbol{X}_j - \\boldsymbol{X}_i$ 为从节点 $i$ 到节点 $j$ 的边向量。角点处的雅可比行列式为：\n\\begin{itemize}\n    \\item $\\det\\boldsymbol{J}(-1,-1) = \\det(\\frac{1}{2}\\boldsymbol{E}_{12}, \\frac{1}{2}\\boldsymbol{E}_{14}) = \\frac{1}{4}\\det(\\boldsymbol{E}_{12}, \\boldsymbol{E}_{14})$。这是由节点 $1$、$2$ 和 $4$ 构成的三角形的有符号面积的一半。\n    \\item $\\det\\boldsymbol{J}(1,-1) = \\det(\\frac{1}{2}\\boldsymbol{E}_{12}, \\frac{1}{2}\\boldsymbol{E}_{23}) = \\frac{1}{4}\\det(\\boldsymbol{E}_{12}, \\boldsymbol{E}_{23})$。\n    \\item $\\det\\boldsymbol{J}(1,1) = \\det(\\frac{1}{2}\\boldsymbol{E}_{43}, \\frac{1}{2}\\boldsymbol{E}_{23}) = \\frac{1}{4}\\det(\\boldsymbol{E}_{43}, \\boldsymbol{E}_{23})$。\n    \\item $\\det\\boldsymbol{J}(-1,1) = \\det(\\frac{1}{2}\\boldsymbol{E}_{43}, \\frac{1}{2}\\boldsymbol{E}_{14}) = \\frac{1}{4}\\det(\\boldsymbol{E}_{43}, \\boldsymbol{E}_{14})$。\n\\end{itemize}\n对于某个小的正数 $\\epsilon$，强制执行条件 $J_{min} > \\epsilon > 0$ 可保证在单元内任何地方都有 $\\det\\boldsymbol{J}(\\xi,\\eta) > 0$。\n\n**度量2：中心雅可比值 ($J_{center}$)**\n该度量是在参考单元中心 $(\\xi,\\eta) = (0,0)$ 处计算的雅可比行列式。\n$$\nJ_{center} = \\det\\boldsymbol{J}(0,0)\n$$\n中心处的切向量是：\n$$\n\\frac{\\partial\\boldsymbol{x}}{\\partial\\xi}(0,0) = \\frac{1}{2}(\\frac{\\boldsymbol{X}_2+\\boldsymbol{X}_3}{2} - \\frac{\\boldsymbol{X}_1+\\boldsymbol{X}_4}{2}) \\quad \\text{和} \\quad \\frac{\\partial\\boldsymbol{x}}{\\partial\\eta}(0,0) = \\frac{1}{2}(\\frac{\\boldsymbol{X}_3+\\boldsymbol{X}_4}{2} - \\frac{\\boldsymbol{X}_1+\\boldsymbol{X}_2}{2})\n$$\n这些向量连接了四边形对边的中点。$J_{center}$ 是这两个向量的行列式。强制执行 $J_{center} > \\delta > 0$ 是一个有效单元的必要但不充分条件，因为它不能防止边界附近的折叠。\n\n**证明：**\n问题要求两个度量，当强制执行时能保证正性。单一的度量 $J_{min} > \\epsilon$ 本身在数学上是充分的。然而，在实践中，网格生成算法通常依赖于多个标准。一种常见的做法是同时监控单元中心的雅可比值（作为平均单元尺寸和方向的度量）和一种扭曲度量。对 $J_{center}$ 和 $J_{min}$ 都强制施加正下界的组合构成了一套有效且实用的两个度量。如果强制执行 $J_{min} > \\epsilon_1 > 0$，那么 $J_{center}$ 也必定为正。因此，条件对 $\\{J_{min} > \\epsilon_1 > 0, J_{center} > \\epsilon_2 > 0\\}$ 是一个保证有效映射的稳健集合，其中第一个条件是更强且充分的。这些度量都在明确定义的采样点（角点和中心）进行计算。",
            "answer": "$$ \\boxed{\\frac{1}{4} \\left[ a(x_1 - x_2 + x_3 - x_4) + b(y_1 - y_2 + y_3 - y_4) \\right]} $$"
        }
    ]
}