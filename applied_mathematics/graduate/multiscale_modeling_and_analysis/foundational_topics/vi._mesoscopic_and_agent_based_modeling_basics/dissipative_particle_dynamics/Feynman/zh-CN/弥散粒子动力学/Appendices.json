{
    "hands_on_practices": [
        {
            "introduction": "在耗散粒子动力学 (DPD) 中，耗散力和随机力共同构成了恒温器，但耗散系数 $ \\gamma $ 的大小也直接影响流体的输运性质。通过计算无量纲的施密特数 (Schmidt number)，本练习将引导您探索 $ \\gamma $、运动黏度 $ \\nu $ 和自扩散系数 $ D $ 之间的基本关系。这项实践有助于您从量化角度理解 DPD 如何调控动量输运与质量输运之间的耦合关系 。",
            "id": "3803308",
            "problem": "您正在分析一种简单流体在 DPD 约化单位下的耗散粒子动力学 (DPD) 数据，其中保守力是软排斥力，耗散力和随机力以动量守恒对的形式作用，并且涨落-耗散平衡成立。运动方程基于牛顿第二定律，粒子 $i$ 和 $j$ 之间的对力可以分解为保守部分、耗散部分和随机部分。耗散力的形式为粘性阻力，其大小取决于摩擦系数，而随机力则提供与目标温度一致的热化。根据线性响应理论，剪切粘度可以通过平衡态应力自相关的 Green-Kubo 时间积分得到，而自扩散系数则通过爱因斯坦关系从均方位移的长时间极限得出。运动粘度是剪切粘度除以质量密度。\n\n从以下基本依据出发：\n- 牛顿第二定律，$m \\, d^2 \\mathbf{r}/dt^2 = \\sum \\mathbf{F}$，其中耗散力和随机力成对且动量守恒。\n- 剪切粘度的 Green-Kubo 关系，$$\\eta = \\frac{V}{k_B T} \\int_0^{\\infty} \\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle \\, dt,$$ 以及运动粘度的关系，$$\\nu = \\eta/\\rho.$$\n- $d$ 维空间中自扩散的爱因斯坦关系，$$D = \\lim_{t \\to \\infty} \\frac{1}{2 d t} \\left\\langle \\left\\| \\mathbf{r}_i(t) - \\mathbf{r}_i(0) \\right\\|^2 \\right\\rangle.$$\n\n给定一个小型测试参数集，对应 DPD 耗散摩擦系数 $\\gamma$ 的不同值。对于每种情况，已充分收敛的独立模拟得出了 DPD 约化单位下的运动粘度 $\\nu$ 和自扩散系数 $D$ 的估计值。所有值均为严格正值。使用的数据如下：\n\n- 情况 A：$\\gamma = 0.5$, $\\nu = 0.25$, $D = 0.6$。\n- 情况 B：$\\gamma = 2.0$, $\\nu = 0.8$, $D = 0.25$。\n- 情况 C：$\\gamma = 4.5$, $\\nu = 1.5$, $D = 0.12$。\n- 情况 D：$\\gamma = 10.0$, $\\nu = 3.0$, $D = 0.05$。\n- 情况 E：$\\gamma = 20.0$, $\\nu = 6.2$, $D = 0.02$。\n- 情况 F (边缘情况)：$\\gamma = 35.0$, $\\nu = 12.0$, $D = 0.004$。\n\n任务：\n- 对于每种情况，计算运动粘度与自扩散系数的无量纲比率，根据定义，该比率即为施密特数。将每个计算值报告为四舍五入到 $6$ 位小数的浮点数。因为所有量都是 DPD 约化单位，所以施密特数是无量纲的，在输出中无需物理单位。\n- 此外，确定一个布尔标志，如果计算出的施密特数序列按照所列 $\\gamma$ 值排序时是严格递增的，则该标志为 $True$，否则为 $False$。\n\n科学要求：\n- 在算法设计的推理中，从上述基本依据出发，论证为何在 DPD 中增加 $\\gamma$ 通常会导致运动粘度增大和自扩散减小，从而导致施密特数增大，并解释这对流体中动量-质量输运耦合的意义。\n\n最终输出格式：\n- 您的程序必须生成单行输出，包含一个 Python 风格的列表，其中前 $6$ 个条目是按顺序计算出的情况 A 到 F 的施密特数，每个数值都四舍五入到 $6$ 位小数，最后是一个布尔条目，指示该序列是否关于 $\\gamma$ 严格递增。例如，要求的格式类似于 $[x_1,x_2,x_3,x_4,x_5,x_6,True]$，其中每个 $x_i$ 是一个四舍五入到 $6$ 位小数的浮点数。\n\n不提供也不需要外部输入。程序必须使用上面列出的数据进行计算，并打印最终行。\n\n注意：所有量都是无量纲的 DPD 约化单位，因此不需要单位转换，最终的施密特数是无单位的。",
            "solution": "问题陈述经评估在科学上是合理的、提法得当、客观且完整的。它基于统计力学和计算物理（特别是耗散粒子动力学，DPD）的既定原理。给定的条件对于所要求的计算是充分且一致的。不存在逻辑矛盾、事实错误或含糊不清之处。因此，可以构建一个合理的解决方案。\n\n问题的核心是为几个 DPD 流体模拟计算施密特数 $Sc$，并分析 $Sc$ 作为 DPD 摩擦系数 $\\gamma$ 的函数的趋势。施密特数是一个无量纲量，定义为运动粘度 $\\nu$ 与质量自扩散系数 $D$ 的比值。\n$$Sc = \\frac{\\nu}{D}$$\n运动粘度 $\\nu$ 是剪切粘度 $\\eta$ 与质量密度 $\\rho$ 的比值，即 $\\nu = \\eta / \\rho$。因此，施密特数代表动量扩散率（$\\nu$）与质量扩散率（$D$）的比值。\n\n首先，我们处理科学要求，以论证观察到的趋势。在 DPD 中，粒子 $i$ 因粒子 $j$ 而受到的总力是三种对力的总和：一个保守力 $\\mathbf{F}^C_{ij}$、一个耗散力 $\\mathbf{F}^D_{ij}$ 和一个随机力 $\\mathbf{F}^R_{ij}$。产生粘性的耗散力由以下公式给出：\n$$\\mathbf{F}^D_{ij} = -\\gamma w_D(r_{ij}) (\\hat{\\mathbf{r}}_{ij} \\cdot \\mathbf{v}_{ij}) \\hat{\\mathbf{r}}_{ij}$$\n其中 $\\gamma$ 是摩擦系数，$w_D(r_{ij})$ 是一个依赖于粒子间距离 $r_{ij}$ 的权重函数，$\\hat{\\mathbf{r}}_{ij}$ 是粒子间的单位矢量，$\\mathbf{v}_{ij}$ 是它们的相对速度。\n\n自扩散系数 $D$ 量化了粒子因热运动而扩散的速率。这一过程在 $d=3$ 维空间中由爱因斯坦关系描述：\n$$D = \\lim_{t \\to \\infty} \\frac{1}{6 t} \\left\\langle \\left\\| \\mathbf{r}_i(t) - \\mathbf{r}_i(0) \\right\\|^2 \\right\\rangle$$\n耗散力 $\\mathbf{F}^D_{ij}$ 起到阻力作用，抵抗粒子的相对运动。更大的 $\\gamma$ 值意味着粒子相对于其局部环境的速度受到更强的阻尼。这种增加的摩擦直接阻碍了单个粒子的随机热运动，减少了它们随时间的均方位移。因此，更大的 $\\gamma$ 会导致更小的自扩散系数 $D$。\n\n剪切粘度 $\\eta$ 衡量流体对流动的内部阻力，这对应于动量输运的效率。根据 Green-Kubo 关系，粘度与应力-应力自相关函数的时间积分相关：\n$$\\eta = \\frac{V}{k_B T} \\int_0^{\\infty} \\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle \\, dt$$\n应力张量分量 $\\sigma_{xy}$ 包含来自粒子间力的贡献。耗散力 $\\mathbf{F}^D_{ij}$ 是粒子间动量交换的主要机制。更大的摩擦系数 $\\gamma$ 会增强这种动量交换，导致流体内部的应力更强和/或衰减得更慢。这会增加时间积分的值，从而导致更高的剪切粘度 $\\eta$。由于运动粘度为 $\\nu = \\eta/\\rho$ 并且在这些模拟中密度 $\\rho$ 是恒定的，$\\eta$ 的增加直接导致 $\\nu$ 的增加。\n\n总而言之，增加 $\\gamma$ 会：\n1.  增加对单个粒子的阻力，从而**减小**自扩散系数 $D$。\n2.  增强整个流体的动量输运，从而**增大**运动粘度 $\\nu$。\n\n对施密特数 $Sc = \\nu/D$ 的综合效应是，分子（$\\nu$）增大而分母（$D$）减小。这导致施密特数随着 $\\gamma$ 的增加而强劲、单调地增长。从物理上讲，这表示随着 $\\gamma$ 的增加，与质量输运相比，动量输运变得越来越有效。粒子的运动与流体的集体流动（流体动力学行为）耦合得更紧密，而更少地表现为独立的随机行走者。\n\n解决该问题的算法步骤如下：\n1.  存储情况 A 到 F 的给定数据。每种情况都提供了 $\\gamma$、$\\nu$ 和 $D$ 的值。\n2.  创建一个空列表以存储计算出的施密特数。\n3.  按指定顺序（A 到 F）遍历每种情况。\n4.  在每次迭代中，使用公式 $Sc = \\nu / D$ 计算施密特数。\n5.  将计算出的 $Sc$ 值四舍五入到 $6$ 位小数，并将其附加到列表中。\n6.  处理完所有情况后，确定存储的施密特数序列是否严格递增。这可以通过检查序列中所有相邻对是否满足 $Sc_i  Sc_{i+1}$ 来验证。结果是一个布尔值（$True$ 或 $False$）。\n7.  将此布尔值附加到施密特数列表的末尾。\n8.  按要求格式化并打印最终列表。\n\n将此算法应用于给定数据：\n- 情况 A：$\\gamma = 0.5$, $\\nu = 0.25$, $D = 0.6$。$Sc_A = 0.25 / 0.6 \\approx 0.416667$。\n- 情况 B：$\\gamma = 2.0$, $\\nu = 0.8$, $D = 0.25$。$Sc_B = 0.8 / 0.25 = 3.2$。\n- 情况 C：$\\gamma = 4.5$, $\\nu = 1.5$, $D = 0.12$。$Sc_C = 1.5 / 0.12 = 12.5$。\n- 情况 D：$\\gamma = 10.0$, $\\nu = 3.0$, $D = 0.05$。$Sc_D = 3.0 / 0.05 = 60.0$。\n- 情况 E：$\\gamma = 20.0$, $\\nu = 6.2$, $D = 0.02$。$Sc_E = 6.2 / 0.02 = 310.0$。\n- 情况 F：$\\gamma = 35.0$, $\\nu = 12.0$, $D = 0.004$。$Sc_F = 12.0 / 0.004 = 3000.0$。\n\n得到的施密特数序列约为 $[0.416667, 3.2, 12.5, 60.0, 310.0, 3000.0]$。\n为检查严格单调性：\n- $0.416667  3.2$ ($True$)\n- $3.2  12.5$ ($True$)\n- $12.5  60.0$ ($True$)\n- $60.0  310.0$ ($True$)\n- $310.0  3000.0$ ($True$)\n由于所有比较结果都为真，该序列是严格递增的。布尔标志为 $True$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Schmidt number for given DPD simulation data and checks for\n    strict monotonicity of the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains (gamma, nu, D) for a case.\n    test_cases = [\n        (0.5, 0.25, 0.6),   # Case A\n        (2.0, 0.8, 0.25),  # Case B\n        (4.5, 1.5, 0.12),  # Case C\n        (10.0, 3.0, 0.05), # Case D\n        (20.0, 6.2, 0.02), # Case E\n        (35.0, 12.0, 0.004) # Case F\n    ]\n\n    schmidt_numbers = []\n    for case in test_cases:\n        # gamma is not used in the calculation, but is part of the problem definition.\n        _gamma, nu, D = case\n\n        # The Schmidt number is the ratio of kinematic viscosity to self-diffusion coefficient.\n        # All values are dimensionless reduced DPD units.\n        sc = nu / D\n\n        # Round the result to 6 decimal places as required.\n        schmidt_numbers.append(round(sc, 6))\n\n    # Check if the sequence of Schmidt numbers is strictly increasing.\n    # The problem implies the cases are ordered by increasing gamma.\n    is_strictly_increasing = all(\n        schmidt_numbers[i]  schmidt_numbers[i+1] for i in range(len(schmidt_numbers) - 1)\n    )\n\n    # Combine the computed numbers and the boolean flag into a single list for output.\n    final_result = schmidt_numbers + [is_strictly_increasing]\n\n    # Final print statement in the exact required format.\n    # Use repr() on the boolean to get 'True'/'False' capitalization correctly.\n    print(f\"[{','.join(map(str, schmidt_numbers))},{repr(is_strictly_increasing)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "粗粒化建模的一个核心任务是确保模型能够复现正确的宏观物理行为，例如流体的可压缩性。在 DPD 中，保守力参数 $ a $ 主要决定了系统的状态方程和热力学响应。本练习将指导您推导 DPD 相互作用参数 $ a $ 与等温压缩系数 $ \\kappa_T $ 之间的解析关系，并利用该关系校准 $ a $ 以匹配目标实验值，这是模型参数化中的一项关键技能 。",
            "id": "3803360",
            "problem": "使用耗散粒子动力学 (DPD) 模拟一种单组分流体，其中每个粗粒化珠子代表一小组分子。系统维持在恒定温度 $T$ 和数密度 $\\rho$ 下，珠子间的保守相互作用由一个振幅 $a_{ij}$ 表征，在单组分情况下该振幅简化为单个参数 $a$。等温压缩率的热力学定义为 $\\kappa_{T} = \\frac{1}{\\rho} \\left( \\frac{\\partial \\rho}{\\partial p} \\right)_{T}$。在标准 DPD 设置下，采用线性权重函数并将截断半径 $r_{c}$ 选为单位长度，根据经过充分检验的维里分析可知，对于该模型和映射，状态方程近似为 $\\rho$ 的二次函数。\n\n假设使用以下经过校准且常用的 DPD 设置：\n- 数密度 $\\rho = 3.0$（DPD 约化单位）。\n- 热能 $k_{B} T = 1.0$（DPD 约化单位）。\n- 状态方程前置因子 $\\alpha = 0.101$（对于标准线性保守权重函数）。\n- 初始保守振幅猜测值 $a_{0} = 25.0$。\n\n给定的目标等温压缩率（经过物理到 DPD 的映射后）为 $\\kappa_{T}^{\\mathrm{target}} = 0.00720$（DPD 压力的倒数单位）。\n\n从 $\\kappa_{T}$ 的热力学定义和基本力学平衡出发，使用 DPD 状态方程近似，推导出 $\\kappa_{T}$ 关于 $\\rho$、$k_{B} T$、$a$ 和 $\\alpha$ 的表达式。然后：\n- 在初始猜测值 $a = a_{0}$ 处计算 $\\kappa_{T}$。\n- 确定校准后的保守振幅 $a$，使得等温压缩率等于 $\\kappa_{T}^{\\mathrm{target}}$。\n\n将您最终的 $a$ 值四舍五入到四位有效数字。以 DPD 约化单位表示最终的保守振幅 $a$（其中 $r_{c} = 1$ 且 $k_{B} T = 1$）。您计算的任何中间压缩率值都应以 DPD 压力的倒数单位报告。",
            "solution": "该问题要求推导标准耗散粒子动力学 (DPD) 流体的等温压缩率 $\\kappa_{T}$，并随后校准保守相互作用参数 $a$。\n\n验证问题陈述是强制性的第一步。\n\n### 步骤1：提取已知条件\n提供的明确数据如下：\n- 等温压缩率的热力学定义：$\\kappa_{T} = \\frac{1}{\\rho} \\left( \\frac{\\partial \\rho}{\\partial p} \\right)_{T}$\n- DPD 状态方程近似：$p \\approx \\rho k_{B} T + \\alpha a \\rho^2$\n- 数密度：$\\rho = 3.0$\n- 热能：$k_{B} T = 1.0$\n- 状态方程前置因子：$\\alpha = 0.101$\n- 初始保守振幅猜测值：$a_{0} = 25.0$\n- 目标等温压缩率：$\\kappa_{T}^{\\mathrm{target}} = 0.00720$\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及成熟的 DPD 模拟方法及其标准状态方程，该状态方程将微观相互作用参数与宏观热力学性质联系起来。校准模型参数以匹配目标物理性质是粗粒化建模中一个核心且实用的过程。所有提供的参数都与 DPD 模拟中使用的典型值一致。该问题提法恰当、客观，并包含足够的信息以获得唯一解。\n\n### 步骤3：结论与行动\n该问题被认定为有效。将提供完整解答。\n\n任务的第一部分是从等温压缩率 $\\kappa_{T}$ 的热力学定义出发，推导其表达式。其定义为：\n$$\n\\kappa_{T} = \\frac{1}{\\rho} \\left( \\frac{\\partial \\rho}{\\partial p} \\right)_{T}\n$$\n计算该偏导数的倒数更为方便。使用偏导数的恒等式 $(\\frac{\\partial y}{\\partial x})_z = 1 / (\\frac{\\partial x}{\\partial y})_z$，我们可以写出：\n$$\n\\left( \\frac{\\partial \\rho}{\\partial p} \\right)_{T} = \\frac{1}{\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_{T}}\n$$\n将此代入 $\\kappa_{T}$ 的定义中得到：\n$$\n\\kappa_{T} = \\frac{1}{\\rho \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_{T}}\n$$\n问题提供了 DPD 状态方程，它将压力 $p$ 与数密度 $\\rho$ 联系起来：\n$$\np(\\rho, T) = \\rho k_{B} T + \\alpha a \\rho^2\n$$\n在这里，$a$ 是保守相互作用参数，$\\alpha$ 是一个前置因子，其值取决于 DPD 保守力权重函数的形式。现在，我们计算在恒定温度 $T$ 下，$p$ 对 $\\rho$ 的偏导数：\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_{T} = \\frac{\\partial}{\\partial \\rho} \\left( \\rho k_{B} T + \\alpha a \\rho^2 \\right) = k_{B} T + 2 \\alpha a \\rho\n$$\n将此导数代回 $\\kappa_{T}$ 的表达式中，我们得到所需的关系式：\n$$\n\\kappa_{T} = \\frac{1}{\\rho \\left( k_{B} T + 2 \\alpha a \\rho \\right)} = \\frac{1}{\\rho k_{B} T + 2 \\alpha a \\rho^2}\n$$\n这个表达式将宏观的等温压缩率 $\\kappa_{T}$ 与 DPD 模型的微观参数 ($a$) 和状态变量 ($\\rho, T$) 联系起来。\n\n任务的第二部分是针对保守振幅的初始猜测值 $a = a_{0} = 25.0$ 计算 $\\kappa_{T}$。我们将给定值代入推导出的公式中：\n- $\\rho = 3.0$\n- $k_{B} T = 1.0$\n- $\\alpha = 0.101$\n- $a = a_{0} = 25.0$\n\n$$\n\\kappa_{T}(a_{0}) = \\frac{1}{(3.0)(1.0) + 2(0.101)(25.0)(3.0)^2}\n$$\n$$\n\\kappa_{T}(a_{0}) = \\frac{1}{3.0 + 2(0.101)(25.0)(9.0)}\n$$\n$$\n\\kappa_{T}(a_{0}) = \\frac{1}{3.0 + 45.45} = \\frac{1}{48.45}\n$$\n计算数值：\n$$\n\\kappa_{T}(a_{0}) \\approx 0.02063983\n$$\n这是对应于初始猜测值 $a_0$ 的等温压缩率。\n\n任务的最后一部分是确定能够复现目标等温压缩率 $\\kappa_{T}^{\\mathrm{target}} = 0.00720$ 的校准后保守振幅 $a$ 的值。我们将推导出的 $\\kappa_{T}$ 表达式设为目标值，然后求解 $a$：\n$$\n\\kappa_{T}^{\\mathrm{target}} = \\frac{1}{\\rho k_{B} T + 2 \\alpha a \\rho^2}\n$$\n重新整理方程以求解 $a$：\n$$\n\\rho k_{B} T + 2 \\alpha a \\rho^2 = \\frac{1}{\\kappa_{T}^{\\mathrm{target}}}\n$$\n$$\n2 \\alpha a \\rho^2 = \\frac{1}{\\kappa_{T}^{\\mathrm{target}}} - \\rho k_{B} T\n$$\n$$\na = \\frac{1}{2 \\alpha \\rho^2} \\left( \\frac{1}{\\kappa_{T}^{\\mathrm{target}}} - \\rho k_{B} T \\right)\n$$\n现在，将已知值代入此方程：\n- $\\rho = 3.0$\n- $k_{B} T = 1.0$\n- $\\alpha = 0.101$\n- $\\kappa_{T}^{\\mathrm{target}} = 0.00720$\n\n$$\na = \\frac{1}{2(0.101)(3.0)^2} \\left( \\frac{1}{0.00720} - (3.0)(1.0) \\right)\n$$\n$$\na = \\frac{1}{2(0.101)(9.0)} \\left( \\frac{1}{0.00720} - 3.0 \\right)\n$$\n$$\na = \\frac{1}{1.818} \\left( \\frac{1}{0.00720} - 3.0 \\right)\n$$\n首先，计算括号内的项：\n$$\n\\frac{1}{0.00720} - 3.0 \\approx 138.888... - 3.0 = 135.888...\n$$\n现在，完成对 $a$ 的计算：\n$$\na = \\frac{135.888...}{1.818} \\approx 74.7464246...\n$$\n问题要求将最终的 $a$ 值四舍五入到四位有效数字。\n$$\na \\approx 74.75\n$$\n这就是匹配目标等温压缩率所需的校准后保守振幅。",
            "answer": "$$\n\\boxed{74.75}\n$$"
        },
        {
            "introduction": "实际的多尺度建模问题通常要求我们采用系统化的方法，同时确定多个关键的 DPD 参数（如粗粒化长度尺度 $ r_c $、耗散系数 $ \\gamma $ 和保守力强度 $ a' $），以匹配一组宏观目标属性。这个综合性练习将引导您完成一个完整的多尺度参数化工作流程。您将整合斯托克斯-爱因斯坦关系、状态方程匹配等多个核心概念，为一个高分子溶液系统地构建 DPD 模型，从而将对单个参数作用的理解提升为整体模型设计的能力 。",
            "id": "3803317",
            "problem": "要求您为耗散粒子动力学 (DPD) 构建一个基于第一原理的多尺度映射工作流，该工作流需选择一个粗粒化长度尺度、一个耗散相互作用强度和一个保守相互作用强度，以重现聚合物溶液的特定宏观性质。教育背景是高等研究生水平的多尺度材料模拟，解决方案必须基于第一性原理和经过充分检验的公式，并从基本物理定律和定义中明确推导，而非使用简化公式。\n\nDPD 模型将粒子视为在 Newton 定律下演化的粗粒化珠子。一个质量为 $m$、位置为 $\\mathbf{r}$、速度为 $\\mathbf{v}$ 的珠子遵循 $m \\,\\mathrm{d}\\mathbf{v}/\\mathrm{d}t = \\sum \\mathbf{F}_{ij}$，其中 $\\mathbf{F}_{ij}$ 分解为保守力、耗散力和随机力。耗散粒子动力学恒温器满足涨落-耗散关系 $\\sigma^{2} = 2 \\gamma k_{\\mathrm{B}} T$，该关系将温度 $T$ 下的随机力振幅 $\\sigma$ 和耗散系数 $\\gamma$ 联系起来，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。对于一个单组分 DPD 流体，其珠子数密度为 $\\rho$，保守力振幅 $a$ 按 $k_{\\mathrm{B}}T/r_{c}$ 进行缩放（记为 $a = a' \\, k_{\\mathrm{B}}T/r_{c}$，其中 $a'$ 是无量纲的），一个广泛使用的平均场状态方程是 $p = (k_{\\mathrm{B}} T / r_{c}^{3}) \\left(\\rho + \\alpha a' \\rho^{2}\\right)$，其中 $\\alpha$ 是一个无量纲常数，通过在随机相近似下对保守力的 DPD 权重函数进行积分得到。等温压缩率定义为 $\\kappa_{T} = -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial p}\\right)_{T} = \\frac{1}{n}\\left(\\frac{\\partial n}{\\partial p}\\right)_{T}$，其中 $V$ 是体积，$n$ 是数密度。稀疏示踪剂在粘性流体中的自扩散系数 $D$ 受斯托克斯-爱因斯坦关系 $D = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta d_{\\mathrm{h}}}$ 的约束，其中 $\\eta$ 是动力粘度，$d_{\\mathrm{h}}$ 是流体力学直径；在粗粒化映射中，设 $d_{\\mathrm{h}} = \\chi r_{c}$，其中 $\\chi$ 是一个由粗粒化分辨率和聚合物拓扑结构决定的无量纲流体力学因子。为了将宏观粘度 $\\eta$ 与 DPD 参数联系起来，使用一个校准原理：对于处于相同热力学状态的参考流体，耗散机制对粘度有主导且单调的贡献，因此在领头阶上 $\\eta \\propto \\gamma$，并且可以通过对一个已知的对 $(\\gamma_{\\mathrm{ref}}, \\eta_{\\mathrm{ref}})$ 进行校准来获得比例常数。所有需要的模型常数和校准值都在下面提供。\n\n您的程序必须为每个测试用例实现以下工作流：\n- 使用目标扩散系数 $D_{\\mathrm{target}}$、目标粘度 $\\eta_{\\mathrm{target}}$ 和流体力学因子 $\\chi$，通过斯托克斯-爱因斯坦约束选择 DPD 长度尺度 $r_{c}$。\n- 使用提供的参考对 $(\\gamma_{\\mathrm{ref}}, \\eta_{\\mathrm{ref}})$，通过粘度与 $\\gamma$ 之间的线性校准关系选择耗散系数 $\\gamma$。\n- 通过状态方程和 $\\kappa_{T}$ 的定义强制满足目标等温压缩率 $\\kappa_{T,\\mathrm{target}}$，从而选择保守强度 $a'$。如果计算出的 $a'$ 非正，则违反了在给定平均场映射下稳定单组分 DPD 流体所需的排斥性保守相互作用要求；在这种情况下，该测试用例的设计失败。\n\n对于每个测试用例，根据所选参数计算预测的宏观性质，并检查以下所有不等式是否同时成立：\n- $\\left|\\eta_{\\mathrm{pred}} - \\eta_{\\mathrm{target}}\\right| / \\eta_{\\mathrm{target}} \\leq \\tau_{\\eta}$,\n- $\\left|D_{\\mathrm{pred}} - D_{\\mathrm{target}}\\right| / D_{\\mathrm{target}} \\leq \\tau_{D}$,\n- $\\left|\\kappa_{T,\\mathrm{pred}} - \\kappa_{T,\\mathrm{target}}\\right| / \\kappa_{T,\\mathrm{target}} \\leq \\tau_{\\kappa}$,\n其中 $\\tau_{\\eta}$、$\\tau_{D}$ 和 $\\tau_{\\kappa}$ 分别是为粘度、扩散和压缩率指定的容差。如果 $a' \\leq 0$，无论上述数值比较结果如何，您都必须将该情况视为失败。每个测试用例的最终结果是一个布尔值，表示工作流是否成功。\n\n在您的程序中使用以下常数和校准值：\n- 温度 $T = 300\\,\\mathrm{K}$（在代码中写作 $T = 300$），\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$，\n- DPD 珠子数密度 $\\rho = 3$（单位为珠子数每 $r_{c}^{3}$），\n- 保守状态方程系数 $\\alpha = 0.101$，\n- 流体力学因子 $\\chi = 1.0$，\n- 粘度校准对 $(\\gamma_{\\mathrm{ref}}, \\eta_{\\mathrm{ref}}) = (4.5, 1.0 \\times 10^{-3}\\,\\mathrm{Pa \\cdot s})$；您必须根据此参考计算校准常数 $C_{v}$ 为 $C_{v} = \\eta_{\\mathrm{ref}} / \\gamma_{\\mathrm{ref}}$。\n\n物理单位和答案格式要求：\n- 粘度以 $\\mathrm{Pa \\cdot s}$ 表示，扩散系数以 $\\mathrm{m^{2}/s}$ 表示，等温压缩率以 $\\mathrm{Pa^{-1}}$ 表示。不涉及角度。任何分数误差都必须作为小数处理（例如，百分之五为 $0.05$）。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[result_{1},result_{2},result_{3}]$，无空格）。每个 $result_{i}$ 都必须是布尔值。\n\n测试套件：\n- 案例 1（正常路径）：$\\eta_{\\mathrm{target}} = 1.5 \\times 10^{-3}$， $D_{\\mathrm{target}} = 2.0 \\times 10^{-10}$， $\\kappa_{T,\\mathrm{target}} = 4.5 \\times 10^{-10}$，容差 $(\\tau_{\\eta}, \\tau_{D}, \\tau_{\\kappa}) = (0.05, 0.05, 0.05)$。\n- 案例 2（边界：小 $r_c$ 与硬流体）：$\\eta_{\\mathrm{target}} = 1.0 \\times 10^{-3}$， $D_{\\mathrm{target}} = 1.0 \\times 10^{-9}$， $\\kappa_{T,\\mathrm{target}} = 1.0 \\times 10^{-10}$，容差 $(\\tau_{\\eta}, \\tau_{D}, \\tau_{\\kappa}) = (0.02, 0.02, 0.02)$。\n- 案例 3（边缘：非物理的大压缩率，需要吸引性的 $a'$）：$\\eta_{\\mathrm{target}} = 1.0 \\times 10^{-3}$， $D_{\\mathrm{target}} = 1.0 \\times 10^{-10}$， $\\kappa_{T,\\mathrm{target}} = 1.0 \\times 10^{-5}$，容差 $(\\tau_{\\eta}, \\tau_{D}, \\tau_{\\kappa}) = (0.10, 0.10, 0.10)$。如果 $a' \\leq 0$，您必须返回失败。\n- 案例 4（高粘度，慢扩散）：$\\eta_{\\mathrm{target}} = 1.0 \\times 10^{-1}$， $D_{\\mathrm{target}} = 1.0 \\times 10^{-12}$， $\\kappa_{T,\\mathrm{target}} = 4.5 \\times 10^{-10}$，容差 $(\\tau_{\\eta}, \\tau_{D}, \\tau_{\\kappa}) = (0.05, 0.05, 0.05)$。\n\n您的程序必须实现上述工作流，将其应用于测试套件，并以精确格式 $[b_{1},b_{2},b_{3},b_{4}]$ 打印单行结果，其中布尔值 $b_{i}$ 表示每个案例的成功或失败。",
            "solution": "该问题要求为耗散粒子动力学 (DPD) 设计并实现一个多尺度映射工作流。目标是确定一组 DPD 参数——粗粒化长度尺度 $r_c$、耗散系数 $\\gamma$ 和无量纲保守相互作用强度 $a'$——以重现给定的宏观性质集合：动力粘度 $\\eta_{\\mathrm{target}}$、自扩散系数 $D_{\\mathrm{target}}$ 和等温压缩率 $\\kappa_{T, \\mathrm{target}}$。解决方案必须从提供的基本原理和方程推导得出。\n\n该问题经检验在科学上是合理的、适定的和客观的。它基于 DPD 模拟的既定原理，包括 Groot-Warren 状态方程、斯托克斯-爱因斯坦扩散关系以及涨落-耗散定理。所有必要的常数和一个清晰的、顺序的工作流都已提供。因此，我们可以继续进行推导和实现。\n\n该工作流包括参数选择的三个主要步骤，然后是一个验证步骤，在该步骤中将预测的性质与目标进行核对。\n\n**1. 参数选择公式的推导**\n\n**步骤 A：粗粒化长度尺度 ($r_c$) 的选择**\n\n长度尺度 $r_c$ 是通过斯托克斯-爱因斯坦关系将宏观扩散和粘度联系起来确定的。该关系式为：\n$$D = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta d_{\\mathrm{h}}}$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\eta$ 是动力粘度，$d_{\\mathrm{h}}$ 是扩散粒子的流体力学直径。在这个粗粒化模型中，流体力学直径通过一个无量纲因子 $\\chi$ 与 DPD 长度尺度 $r_c$ 相关联：\n$$d_{\\mathrm{h}} = \\chi r_{c}$$\n将 $d_{\\mathrm{h}}$ 的表达式代入斯托克斯-爱因斯坦方程得到：\n$$D = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta \\chi r_{c}}$$\n为了找到适合我们系统的 $r_c$，我们要求此关系对目标性质 $D_{\\mathrm{target}}$ 和 $\\eta_{\\mathrm{target}}$ 成立。重新整理方程以求解 $r_c$，得到我们所选长度尺度的公式，我们称之为 $r_{c, \\mathrm{sel}}$：\n$$r_{c, \\mathrm{sel}} = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta_{\\mathrm{target}} D_{\\mathrm{target}} \\chi}$$\n\n**步骤 B：耗散系数 ($\\gamma$) 的选择**\n\n耗散系数 $\\gamma$ 与宏观粘度 $\\eta$ 相关联。问题陈述了一个线性校准原理，$\\eta \\propto \\gamma$，我们可以写成：\n$$\\eta = C_v \\gamma$$\n其中 $C_v$ 是一个比例常数。这个常数由一个已知的参考流体确定，为此提供了一对值 $(\\gamma_{\\mathrm{ref}}, \\eta_{\\mathrm{ref}})$。我们可以计算 $C_v$ 为：\n$$C_v = \\frac{\\eta_{\\mathrm{ref}}}{\\gamma_{\\mathrm{ref}}}$$\n为了达到目标粘度 $\\eta_{\\mathrm{target}}$，我们必须选择一个相应的 $\\gamma$，我们称之为 $\\gamma_{\\mathrm{sel}}$。根据校准关系，我们有：\n$$\\eta_{\\mathrm{target}} = C_v \\gamma_{\\mathrm{sel}}$$\n求解 $\\gamma_{\\mathrm{sel}}$ 得：\n$$\\gamma_{\\mathrm{sel}} = \\frac{\\eta_{\\mathrm{target}}}{C_v} = \\eta_{\\mathrm{target}} \\left(\\frac{\\gamma_{\\mathrm{ref}}}{\\eta_{\\mathrm{ref}}}\\right)$$\n\n**步骤 C：保守相互作用强度 ($a'$) 的选择**\n\n保守相互作用强度 $a'$ 是通过匹配目标等温压缩率 $\\kappa_{T, \\mathrm{target}}$ 来确定的。等温压缩率定义为：\n$$\\kappa_{T} = \\frac{1}{n}\\left(\\frac{\\partial n}{\\partial p}\\right)_{T}$$\n其中 $n$ 是物理单位下的数密度（例如，粒子数/$\\mathrm{m^3}$），$p$ 是压力。DPD 状态方程 (EOS) 是用无量纲数密度 $\\rho$（粒子数/$r_c^3$）给出的：\n$$p = \\frac{k_{\\mathrm{B}} T}{r_{c}^{3}} \\left(\\rho + \\alpha a' \\rho^{2}\\right)$$\n物理数密度 $n$ 和 DPD 密度 $\\rho$ 的关系是 $n = \\rho / r_c^3$。为了使用 $\\kappa_T$ 的定义，我们必须将 $p$ 表示为 $n$ 的函数。将 $\\rho = n r_c^3$ 代入 EOS：\n$$p = \\frac{k_{\\mathrm{B}} T}{r_{c}^{3}} \\left( n r_c^3 + \\alpha a' (n r_c^3)^2 \\right) = k_{\\mathrm{B}} T \\left( n + \\alpha a' r_c^3 n^2 \\right)$$\n为了求 $\\left(\\frac{\\partial n}{\\partial p}\\right)_{T}$，我们首先计算其逆 $\\left(\\frac{\\partial p}{\\partial n}\\right)_{T}$：\n$$\\left(\\frac{\\partial p}{\\partial n}\\right)_{T} = \\frac{\\partial}{\\partial n} \\left[ k_{\\mathrm{B}} T \\left( n + \\alpha a' r_c^3 n^2 \\right) \\right] = k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' r_c^3 n \\right)$$\n将此代入 $\\kappa_T$ 的定义中：\n$$\\kappa_{T} = \\frac{1}{n} \\left[ k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' r_c^3 n \\right) \\right]^{-1} = \\frac{1}{n k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' r_c^3 n \\right)}$$\n最后，我们可以通过代入 $n = \\rho / r_c^3$ 将 $\\kappa_T$ 表示为 DPD 密度 $\\rho$ 的函数：\n$$\\kappa_{T} = \\frac{r_c^3}{\\rho} \\frac{1}{k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' r_c^3 (\\rho/r_c^3) \\right)} = \\frac{r_c^3}{\\rho k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' \\rho \\right)}$$\n我们使用这个方程来找到产生 $\\kappa_{T, \\mathrm{target}}$ 的 $a'$ 值，记为 $a'_{\\mathrm{sel}}$，并使用先前确定的长度尺度 $r_{c, \\mathrm{sel}}$。\n$$\\kappa_{T, \\mathrm{target}} = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a'_{\\mathrm{sel}} \\rho \\right)}$$\n重新整理以求解 $a'_{\\mathrm{sel}}$：\n$$1 + 2 \\alpha a'_{\\mathrm{sel}} \\rho = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}}$$\n$$2 \\alpha a'_{\\mathrm{sel}} \\rho = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}} - 1$$\n$$a'_{\\mathrm{sel}} = \\frac{1}{2 \\alpha \\rho} \\left( \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}} - 1 \\right)$$\n\n对于此模型中稳定的单组分流体，一个关键的物理约束是保守相互作用必须是排斥性的，这对应于 $a' > 0$。如果计算出的 $a'_{\\mathrm{sel}} \\leq 0$，则参数化失败。如果目标流体过于可压缩，以至于在此平均场框架内需要非物理的吸引力，就会发生这种情况。\n\n**2. 所选参数的验证**\n\n一旦确定了参数集 $(r_{c, \\mathrm{sel}}, \\gamma_{\\mathrm{sel}}, a'_{\\mathrm{sel}})$，工作流要求预测由此参数集产生的宏观性质，并将其与目标进行比较。\n\n预测的粘度 $\\eta_{\\mathrm{pred}}$ 由 $\\gamma_{\\mathrm{sel}}$ 计算得出：\n$$\\eta_{\\mathrm{pred}} = C_v \\gamma_{\\mathrm{sel}} = C_v \\left(\\frac{\\eta_{\\mathrm{target}}}{C_v}\\right) = \\eta_{\\mathrm{target}}$$\n预测的扩散系数 $D_{\\mathrm{pred}}$ 由 $r_{c, \\mathrm{sel}}$ 和 $\\eta_{\\mathrm{pred}}$ 计算得出：\n$$D_{\\mathrm{pred}} = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta_{\\mathrm{pred}} \\chi r_{c, \\mathrm{sel}}} = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta_{\\mathrm{target}} \\chi \\left(\\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta_{\\mathrm{target}} D_{\\mathrm{target}} \\chi}\\right)} = D_{\\mathrm{target}}$$\n预测的等温压缩率 $\\kappa_{T, \\mathrm{pred}}$ 由 $r_{c, \\mathrm{sel}}$ 和 $a'_{\\mathrm{sel}}$ 计算得出：\n$$\\kappa_{T, \\mathrm{pred}} = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a'_{\\mathrm{sel}} \\rho \\right)}$$\n代入 $a'_{\\mathrm{sel}}$ 的表达式，我们发现括号中的项变为 $1 + 2 \\alpha a'_{\\mathrm{sel}} \\rho = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}}$。这导致：\n$$\\kappa_{T, \\mathrm{pred}} = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\left( \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}} \\right)} = \\kappa_{T, \\mathrm{target}}$$\n\n通过一种反演性质-参数关系的构造方法，预测的性质与目标性质完全匹配。因此，对于任何非负容差 $\\tau_{\\eta}$、$\\tau_{D}$ 和 $\\tau_{\\kappa}$，相对误差检查将总是被满足（除非出现浮点不精确性）。决定给定目标集工作流成功或失败的唯一条件是物理要求 $a'_{\\mathrm{sel}} > 0$。\n\n最终的算法如下：\n1.  对于每个测试用例，使用推导出的公式计算 $r_{c, \\mathrm{sel}}$、$\\gamma_{\\mathrm{sel}}$ 和 $a'_{\\mathrm{sel}}$。\n2.  如果 $a'_{\\mathrm{sel}} \\leq 0$，则设计失败。\n3.  如果 $a'_{\\mathrm{sel}} > 0$，则设计成功，因为参数化保证了目标性质得到满足。\n程序将实现此逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a multiscale mapping workflow for Dissipative Particle Dynamics (DPD)\n    to determine if a set of parameters can reproduce target macroscopic properties.\n    \"\"\"\n    \n    # Define physical and model constants\n    T = 300.0  # Temperature in Kelvin\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n    rho = 3.0  # Dimensionless DPD bead number density (beads / r_c^3)\n    alpha = 0.101  # Dimensionless coefficient for the conservative EOS\n    chi = 1.0  # Dimensionless hydrodynamic factor\n    \n    # Viscosity calibration reference values\n    gamma_ref = 4.5\n    eta_ref = 1.0e-3  # Pa.s\n    \n    # Viscosity calibration constant\n    C_v = eta_ref / gamma_ref # Pa.s\n    \n    # Pre-calculate k_B * T for efficiency\n    k_B_T = k_B * T\n\n    # Test suite provided in the problem statement\n    test_cases = [\n        # Case 1: Happy path\n        {'eta_target': 1.5e-3, 'D_target': 2.0e-10, 'kappa_T_target': 4.5e-10, 'tolerances': (0.05, 0.05, 0.05)},\n        # Case 2: Boundary case (stiff fluid)\n        {'eta_target': 1.0e-3, 'D_target': 1.0e-9, 'kappa_T_target': 1.0e-10, 'tolerances': (0.02, 0.02, 0.02)},\n        # Case 3: Edge case (unphysically large compressibility)\n        {'eta_target': 1.0e-3, 'D_target': 1.0e-10, 'kappa_T_target': 1.0e-5, 'tolerances': (0.10, 0.10, 0.10)},\n        # Case 4: High viscosity, slow diffusion\n        {'eta_target': 1.0e-1, 'D_target': 1.0e-12, 'kappa_T_target': 4.5e-10, 'tolerances': (0.05, 0.05, 0.05)},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        eta_target = case['eta_target']\n        D_target = case['D_target']\n        kappa_T_target = case['kappa_T_target']\n        tau_eta, tau_D, tau_kappa = case['tolerances']\n\n        # --- Step 1: Select DPD length scale r_c ---\n        # From Stokes-Einstein: r_c = k_B*T / (6 * pi * eta * D * chi)\n        r_c_sel = k_B_T / (6.0 * np.pi * eta_target * D_target * chi)\n\n        # --- Step 2: Select dissipative coefficient gamma ---\n        # From linear calibration: gamma = eta / C_v\n        gamma_sel = eta_target / C_v\n\n        # --- Step 3: Select conservative strength a' ---\n        # From compressibility: a' = (1 / (2*alpha*rho)) * (r_c^3 / (rho*k_B*T*kappa_T) - 1)\n        term_in_paren = (r_c_sel**3) / (rho * k_B_T * kappa_T_target)\n        a_prime_sel = (1.0 / (2.0 * alpha * rho)) * (term_in_paren - 1.0)\n        \n        # --- Validation Step ---\n        # The primary failure condition is a non-repulsive conservative force (a' = 0).\n        if a_prime_sel = 0:\n            results.append(False)\n            continue\n\n        # If a' > 0, we proceed to compute predicted properties and check against tolerances.\n        # As derived in the solution, the parameterization is invertible, so the predicted\n        # properties will match the targets perfectly, barring floating-point errors.\n        # The tolerance checks are thus formally required but are expected to pass.\n\n        # Predict viscosity\n        eta_pred = C_v * gamma_sel\n        \n        # Predict diffusion coefficient\n        D_pred = k_B_T / (6.0 * np.pi * eta_pred * chi * r_c_sel)\n        \n        # Predict isothermal compressibility\n        kappa_T_pred = (r_c_sel**3) / (rho * k_B_T * (1.0 + 2.0 * alpha * a_prime_sel * rho))\n        \n        # Check if all properties are within their respective tolerances\n        err_eta = np.abs(eta_pred - eta_target) / eta_target\n        err_D = np.abs(D_pred - D_target) / D_target\n        err_kappa_T = np.abs(kappa_T_pred - kappa_T_target) / kappa_T_target\n        \n        success = (err_eta = tau_eta) and (err_D = tau_D) and (err_kappa_T = tau_kappa)\n        \n        results.append(success)\n\n    # Format the final output string as required\n    output_str = f\"[{','.join(map(str, results))}]\"\n    output_str_lower = output_str.replace(\"True\", \"true\").replace(\"False\", \"false\")\n    print(output_str_lower)\n\nsolve()\n```"
        }
    ]
}