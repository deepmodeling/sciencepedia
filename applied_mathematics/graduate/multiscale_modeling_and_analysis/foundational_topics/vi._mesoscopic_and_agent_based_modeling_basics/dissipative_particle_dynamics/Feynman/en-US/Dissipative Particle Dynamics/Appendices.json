{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of any coarse-grained modeling is ensuring that the simplified model reproduces key macroscopic properties of the system it represents. This practice focuses on one of the most fundamental calibration tasks in Dissipative Particle Dynamics (DPD): tuning the conservative interaction parameter, $a$, to match the isothermal compressibility, $\\kappa_T$, of a target fluid. By working through the DPD equation of state, you will gain hands-on experience in connecting a microscopic model parameter to a crucial macroscopic thermodynamic property, a critical skill for developing physically meaningful simulations .",
            "id": "3803360",
            "problem": "A single-component fluid is simulated using Dissipative Particle Dynamics (DPD), where each coarse-grained bead represents a small cluster of molecules. The system is maintained at fixed temperature $T$ and number density $\\rho$, and the conservative interaction between beads is characterized by an amplitude $a_{ij}$ that reduces to a single parameter $a$ in the one-component case. The isothermal compressibility is defined thermodynamically as $\\kappa_{T} = \\frac{1}{\\rho} \\left( \\frac{\\partial \\rho}{\\partial p} \\right)_{T}$. Under standard DPD settings with a linear weight function and cutoff $r_{c}$ chosen as the unit length, it is known from well-tested virial analyses that the equation of state is approximately quadratic in $\\rho$ for this model and mapping.\n\nAssume the following calibrated and commonly used DPD settings:\n- Number density $\\rho = 3.0$ (in DPD reduced units).\n- Thermal energy $k_{B} T = 1.0$ (in DPD reduced units).\n- Equation-of-state prefactor $\\alpha = 0.101$ (for the standard linear conservative weight function).\n- Initial conservative amplitude guess $a_{0} = 25.0$.\n\nA target isothermal compressibility (after physical-to-DPD mapping) is given as $\\kappa_{T}^{\\mathrm{target}} = 0.00720$ (in reciprocal DPD pressure units).\n\nStarting from the thermodynamic definition of $\\kappa_{T}$ and fundamental mechanical balance, derive the expression of $\\kappa_{T}$ in terms of $\\rho$, $k_{B} T$, $a$, and $\\alpha$ using the DPD equation-of-state approximation. Then:\n- Evaluate $\\kappa_{T}$ at the initial guess $a = a_{0}$.\n- Determine the calibrated conservative amplitude $a$ such that the isothermal compressibility equals $\\kappa_{T}^{\\mathrm{target}}$.\n\nRound your final value of $a$ to four significant figures. Express the final conservative amplitude $a$ in DPD reduced units (with $r_{c} = 1$ and $k_{B} T = 1$). Any intermediate compressibility you compute should be reported in reciprocal DPD pressure units.",
            "solution": "The problem requires the derivation of the isothermal compressibility, $\\kappa_{T}$, for a standard Dissipative Particle Dynamics (DPD) fluid and the subsequent calibration of the conservative interaction parameter, $a$.\n\nThe validation of the problem statement is the mandatory first step.\n\n### Step 1: Extract Givens\nThe explicit data provided are:\n- Thermodynamic definition of isothermal compressibility: $\\kappa_{T} = \\frac{1}{\\rho} \\left( \\frac{\\partial \\rho}{\\partial p} \\right)_{T}$\n- DPD equation-of-state approximation: $p \\approx \\rho k_{B} T + \\alpha a \\rho^2$\n- Number density: $\\rho = 3.0$\n- Thermal energy: $k_{B} T = 1.0$\n- Equation-of-state prefactor: $\\alpha = 0.101$\n- Initial conservative amplitude guess: $a_{0} = 25.0$\n- Target isothermal compressibility: $\\kappa_{T}^{\\mathrm{target}} = 0.00720$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with the well-established DPD simulation method and its standard equation of state, which relates microscopic interaction parameters to a macroscopic thermodynamic property. The task of calibrating a model parameter to match a target physical property is a central and practical procedure in coarse-grained modeling. All provided parameters are consistent with typical values used in DPD simulations. The problem is well-posed, objective, and contains sufficient information for a unique solution.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\nThe first part of the task is to derive an expression for the isothermal compressibility, $\\kappa_{T}$, starting from its thermodynamic definition. The definition is given as:\n$$\n\\kappa_{T} = \\frac{1}{\\rho} \\left( \\frac{\\partial \\rho}{\\partial p} \\right)_{T}\n$$\nIt is more convenient to compute the inverse of the partial derivative. Using the identity for partial derivatives, $(\\frac{\\partial y}{\\partial x})_z = 1 / (\\frac{\\partial x}{\\partial y})_z$, we can write:\n$$\n\\left( \\frac{\\partial \\rho}{\\partial p} \\right)_{T} = \\frac{1}{\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_{T}}\n$$\nSubstituting this into the definition of $\\kappa_{T}$ yields:\n$$\n\\kappa_{T} = \\frac{1}{\\rho \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_{T}}\n$$\nThe problem supplies the DPD equation of state, which relates pressure $p$ to number density $\\rho$:\n$$\np(\\rho, T) = \\rho k_{B} T + \\alpha a \\rho^2\n$$\nHere, $a$ is the conservative interaction parameter, and $\\alpha$ is a prefactor that depends on the form of the DPD conservative force weight function. Now, we compute the partial derivative of $p$ with respect to $\\rho$ at constant temperature $T$:\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_{T} = \\frac{\\partial}{\\partial \\rho} \\left( \\rho k_{B} T + \\alpha a \\rho^2 \\right) = k_{B} T + 2 \\alpha a \\rho\n$$\nSubstituting this derivative back into the expression for $\\kappa_{T}$, we obtain the desired relationship:\n$$\n\\kappa_{T} = \\frac{1}{\\rho \\left( k_{B} T + 2 \\alpha a \\rho \\right)} = \\frac{1}{\\rho k_{B} T + 2 \\alpha a \\rho^2}\n$$\nThis expression connects the macroscopic isothermal compressibility $\\kappa_{T}$ to the microscopic parameters of the DPD model ($a$) and the state variables ($\\rho, T$).\n\nThe second part of the task is to evaluate $\\kappa_{T}$ for the initial guess of the conservative amplitude, $a = a_{0} = 25.0$. We substitute the given values into the derived formula:\n- $\\rho = 3.0$\n- $k_{B} T = 1.0$\n- $\\alpha = 0.101$\n- $a = a_{0} = 25.0$\n\n$$\n\\kappa_{T}(a_{0}) = \\frac{1}{(3.0)(1.0) + 2(0.101)(25.0)(3.0)^2}\n$$\n$$\n\\kappa_{T}(a_{0}) = \\frac{1}{3.0 + 2(0.101)(25.0)(9.0)}\n$$\n$$\n\\kappa_{T}(a_{0}) = \\frac{1}{3.0 + 45.45} = \\frac{1}{48.45}\n$$\nCalculating the numerical value:\n$$\n\\kappa_{T}(a_{0}) \\approx 0.02063983\n$$\nThis is the isothermal compressibility corresponding to the initial guess $a_0$.\n\nThe final part of the task is to determine the calibrated value of the conservative amplitude, $a$, that reproduces the target isothermal compressibility, $\\kappa_{T}^{\\mathrm{target}} = 0.00720$. We set our derived expression for $\\kappa_{T}$ equal to the target value and solve for $a$:\n$$\n\\kappa_{T}^{\\mathrm{target}} = \\frac{1}{\\rho k_{B} T + 2 \\alpha a \\rho^2}\n$$\nRearranging the equation to solve for $a$:\n$$\n\\rho k_{B} T + 2 \\alpha a \\rho^2 = \\frac{1}{\\kappa_{T}^{\\mathrm{target}}}\n$$\n$$\n2 \\alpha a \\rho^2 = \\frac{1}{\\kappa_{T}^{\\mathrm{target}}} - \\rho k_{B} T\n$$\n$$\na = \\frac{1}{2 \\alpha \\rho^2} \\left( \\frac{1}{\\kappa_{T}^{\\mathrm{target}}} - \\rho k_{B} T \\right)\n$$\nNow, substitute the known values into this equation:\n- $\\rho = 3.0$\n- $k_{B} T = 1.0$\n- $\\alpha = 0.101$\n- $\\kappa_{T}^{\\mathrm{target}} = 0.00720$\n\n$$\na = \\frac{1}{2(0.101)(3.0)^2} \\left( \\frac{1}{0.00720} - (3.0)(1.0) \\right)\n$$\n$$\na = \\frac{1}{2(0.101)(9.0)} \\left( \\frac{1}{0.00720} - 3.0 \\right)\n$$\n$$\na = \\frac{1}{1.818} \\left( \\frac{1}{0.00720} - 3.0 \\right)\n$$\nFirst, evaluate the term in the parenthesis:\n$$\n\\frac{1}{0.00720} - 3.0 \\approx 138.888... - 3.0 = 135.888...\n$$\nNow, complete the calculation for $a$:\n$$\na = \\frac{135.888...}{1.818} \\approx 74.7464246...\n$$\nThe problem asks for the final value of $a$ to be rounded to four significant figures.\n$$\na \\approx 74.75\n$$\nThis is the calibrated conservative amplitude required to match the target isothermal compressibility.",
            "answer": "$$\n\\boxed{74.75}\n$$"
        },
        {
            "introduction": "The dissipative and random forces in DPD do more than just maintain temperature; they are crucial for correctly modeling the transport of momentum and mass, which governs hydrodynamic behavior. In this exercise, you will investigate how the dissipative friction coefficient, $\\gamma$, directly controls the fluid's kinematic viscosity, $\\nu$, and the self-diffusion coefficient, $D$. By calculating the dimensionless Schmidt number, $Sc = \\nu/D$, you will explore how DPD allows for the tuning of momentum versus mass transport, a key feature for simulating complex fluids like polymer solutions and colloidal suspensions .",
            "id": "3803308",
            "problem": "You are analyzing Dissipative Particle Dynamics (DPD) data for a simple fluid in reduced DPD units, where the conservative force is soft-repulsive, the dissipative and random forces act in momentum-conserving pairs, and the fluctuation–dissipation balance holds. The equations of motion are based on Newton’s Second Law, and the pairwise force between particles $i$ and $j$ can be decomposed into a conservative part, a dissipative part, and a random part. The dissipative force has the form of a viscous drag that depends on a friction coefficient, while the random force provides thermalization consistent with a target temperature. From linear response theory, the shear viscosity can be obtained by a Green–Kubo time integral of the equilibrium stress autocorrelation, and the self-diffusion coefficient follows from the long-time limit of the mean-squared displacement via the Einstein relation. The kinematic viscosity is the shear viscosity divided by the mass density.\n\nStarting from these fundamental bases:\n- Newton’s Second Law, $m \\, d^2 \\mathbf{r}/dt^2 = \\sum \\mathbf{F}$, with pairwise momentum-conserving dissipative and random forces.\n- The Green–Kubo relation for shear viscosity, $$\\eta = \\frac{V}{k_B T} \\int_0^{\\infty} \\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle \\, dt,$$ and kinematic viscosity, $$\\nu = \\eta/\\rho.$$\n- The Einstein relation for self-diffusion in $d$ spatial dimensions, $$D = \\lim_{t \\to \\infty} \\frac{1}{2 d t} \\left\\langle \\left\\| \\mathbf{r}_i(t) - \\mathbf{r}_i(0) \\right\\|^2 \\right\\rangle.$$\n\nYou are given a small test suite of parameter sets corresponding to different values of the DPD dissipative friction coefficient $\\gamma$. For each case, an independent, sufficiently converged simulation has produced estimates of the kinematic viscosity $\\nu$ and the self-diffusion coefficient $D$ in reduced DPD units. All values are strictly positive. The data to use are:\n\n- Case A: $\\gamma = 0.5$, $\\nu = 0.25$, $D = 0.6$.\n- Case B: $\\gamma = 2.0$, $\\nu = 0.8$, $D = 0.25$.\n- Case C: $\\gamma = 4.5$, $\\nu = 1.5$, $D = 0.12$.\n- Case D: $\\gamma = 10.0$, $\\nu = 3.0$, $D = 0.05$.\n- Case E: $\\gamma = 20.0$, $\\nu = 6.2$, $D = 0.02$.\n- Case F (edge case): $\\gamma = 35.0$, $\\nu = 12.0$, $D = 0.004$.\n\nTasks:\n- For each case, compute the dimensionless ratio of kinematic viscosity to self-diffusion coefficient, which by definition is the Schmidt number. Report each computed value as a floating-point number rounded to $6$ decimal places. Because all quantities are in reduced DPD units, the Schmidt number is dimensionless and requires no physical unit in the output.\n- Additionally, determine a boolean flag that is $True$ if the sequence of computed Schmidt numbers is strictly increasing when ordered by the listed $\\gamma$ values, and $False$ otherwise.\n\nScientific requirement:\n- Justify, in your reasoning for algorithm design, starting from the above fundamental bases, why increasing $\\gamma$ typically leads to larger kinematic viscosity and smaller self-diffusion in DPD, and therefore to a larger Schmidt number, and explain the implication for momentum–mass transport coupling in the fluid.\n\nFinal output format:\n- Your program must produce a single line containing a Python-style list where the first $6$ entries are the computed Schmidt numbers for Cases A through F in that order, each rounded to $6$ decimal places, followed by a final boolean entry indicating whether the sequence is strictly increasing with respect to $\\gamma$. For example, the required format is like $[x_1,x_2,x_3,x_4,x_5,x_6,True]$ where each $x_i$ is a float rounded to $6$ decimals.\n\nNo external input is provided or required. The program must compute using the data exactly as listed above and print the final line.\n\nNote: All quantities are dimensionless reduced DPD units, so no unit conversion is required and the final Schmidt numbers are unitless.",
            "solution": "The problem statement is evaluated to be scientifically sound, well-posed, objective, and complete. It is grounded in the established principles of statistical mechanics and computational physics, specifically Dissipative Particle Dynamics (DPD). The givens are sufficient and consistent for the requested calculations. No logical contradictions, factual errors, or ambiguities are present. Therefore, a reasoned solution can be constructed.\n\nThe core of the problem is to compute the Schmidt number, $Sc$, for several DPD fluid simulations and to analyze the trend of $Sc$ as a function of the DPD friction coefficient, $\\gamma$. The Schmidt number is a dimensionless quantity defined as the ratio of kinematic viscosity, $\\nu$, to the mass self-diffusion coefficient, $D$.\n$$Sc = \\frac{\\nu}{D}$$\nThe kinematic viscosity, $\\nu$, is the ratio of shear viscosity, $\\eta$, to mass density, $\\rho$, i.e., $\\nu = \\eta / \\rho$. Thus, the Schmidt number represents the ratio of momentum diffusivity ($\\nu$) to mass diffusivity ($D$).\n\nFirst, we address the scientific requirement to justify the observed trends. In DPD, the total force on a particle $i$ due to a particle $j$ is a sum of three pairwise forces: a conservative force $\\mathbf{F}^C_{ij}$, a dissipative force $\\mathbf{F}^D_{ij}$, and a random force $\\mathbf{F}^R_{ij}$. The dissipative force, which gives rise to viscosity, is given by:\n$$\\mathbf{F}^D_{ij} = -\\gamma w_D(r_{ij}) (\\hat{\\mathbf{r}}_{ij} \\cdot \\mathbf{v}_{ij}) \\hat{\\mathbf{r}}_{ij}$$\nwhere $\\gamma$ is the friction coefficient, $w_D(r_{ij})$ is a weight function that depends on the inter-particle distance $r_{ij}$, $\\hat{\\mathbf{r}}_{ij}$ is the unit vector between the particles, and $\\mathbf{v}_{ij}$ is their relative velocity.\n\nThe self-diffusion coefficient, $D$, quantifies the rate at which particles spread due to thermal motion. This process is described by the Einstein relation in $d=3$ dimensions:\n$$D = \\lim_{t \\to \\infty} \\frac{1}{6 t} \\left\\langle \\left\\| \\mathbf{r}_i(t) - \\mathbf{r}_i(0) \\right\\|^2 \\right\\rangle$$\nThe dissipative force $\\mathbf{F}^D_{ij}$ acts as a drag, opposing the relative motion of particles. A larger value of $\\gamma$ implies a stronger damping of particle velocities relative to their local environment. This increased friction directly hinders the random thermal motion of individual particles, reducing their mean-squared displacement over time. Consequently, a larger $\\gamma$ leads to a smaller self-diffusion coefficient $D$.\n\nThe shear viscosity, $\\eta$, measures the fluid's internal resistance to flow, which corresponds to the efficiency of momentum transport. According to the Green–Kubo relation, viscosity is related to the time integral of the stress-stress autocorrelation function:\n$$\\eta = \\frac{V}{k_B T} \\int_0^{\\infty} \\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle \\, dt$$\nThe stress tensor component $\\sigma_{xy}$ contains contributions from inter-particle forces. The dissipative force $\\mathbf{F}^D_{ij}$ is a primary mechanism for momentum exchange between particles. A larger friction coefficient $\\gamma$ enhances this momentum exchange, causing stresses within the fluid to be stronger and/or decay more slowly. This increases the value of the time integral, resulting in a higher shear viscosity $\\eta$. Since the kinematic viscosity is $\\nu = \\eta/\\rho$ and the density $\\rho$ is constant for these simulations, an increase in $\\eta$ directly leads to an increase in $\\nu$.\n\nIn summary, increasing $\\gamma$:\n1.  Increases the drag on individual particles, **decreasing** the self-diffusion coefficient $D$.\n2.  Enhances momentum transport throughout the fluid, **increasing** the kinematic viscosity $\\nu$.\n\nThe combined effect on the Schmidt number, $Sc = \\nu/D$, is that both the numerator ($\\nu$) increases and the denominator ($D$) decreases. This leads to a strong, monotonic increase in the Schmidt number with increasing $\\gamma$. Physically, this signifies that as $\\gamma$ increases, momentum transport becomes progressively more efficient compared to mass transport. The particle's motion becomes more strongly coupled to the collective flow of the fluid (hydrodynamic behavior) and less like an independent random walker.\n\nThe algorithmic approach to solve the problem is as follows:\n1.  Store the given data for Cases A through F. Each case provides values for $\\gamma$, $\\nu$, and $D$.\n2.  Create an empty list to store the computed Schmidt numbers.\n3.  Iterate through each case in the specified order (A to F).\n4.  In each iteration, calculate the Schmidt number using the formula $Sc = \\nu / D$.\n5.  Round the calculated $Sc$ value to $6$ decimal places and append it to the list.\n6.  After processing all cases, determine if the sequence of stored Schmidt numbers is strictly increasing. This can be verified by checking if $Sc_i  Sc_{i+1}$ for all adjacent pairs in the sequence. The result is a boolean value ($True$ or $False$).\n7.  Append this boolean value to the end of the list of Schmidt numbers.\n8.  Format and print the final list as required.\n\nApplying this algorithm to the given data:\n- Case A: $\\gamma = 0.5$, $\\nu = 0.25$, $D = 0.6$. $Sc_A = 0.25 / 0.6 \\approx 0.416667$.\n- Case B: $\\gamma = 2.0$, $\\nu = 0.8$, $D = 0.25$. $Sc_B = 0.8 / 0.25 = 3.2$.\n- Case C: $\\gamma = 4.5$, $\\nu = 1.5$, $D = 0.12$. $Sc_C = 1.5 / 0.12 = 12.5$.\n- Case D: $\\gamma = 10.0$, $\\nu = 3.0$, $D = 0.05$. $Sc_D = 3.0 / 0.05 = 60.0$.\n- Case E: $\\gamma = 20.0$, $\\nu = 6.2$, $D = 0.02$. $Sc_E = 6.2 / 0.02 = 310.0$.\n- Case F: $\\gamma = 35.0$, $\\nu = 12.0$, $D = 0.004$. $Sc_F = 12.0 / 0.004 = 3000.0$.\n\nThe resulting sequence of Schmidt numbers is approximately $[0.416667, 3.2, 12.5, 60.0, 310.0, 3000.0]$.\nTo check for strict monotonicity:\n- $0.416667  3.2$ ($True$)\n- $3.2  12.5$ ($True$)\n- $12.5  60.0$ ($True$)\n- $60.0  310.0$ ($True$)\n- $310.0  3000.0$ ($True$)\nSince all comparisons are true, the sequence is strictly increasing. The boolean flag is $True$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Schmidt number for given DPD simulation data and checks for\n    strict monotonicity of the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains (gamma, nu, D) for a case.\n    test_cases = [\n        (0.5, 0.25, 0.6),   # Case A\n        (2.0, 0.8, 0.25),  # Case B\n        (4.5, 1.5, 0.12),  # Case C\n        (10.0, 3.0, 0.05), # Case D\n        (20.0, 6.2, 0.02), # Case E\n        (35.0, 12.0, 0.004) # Case F\n    ]\n\n    schmidt_numbers = []\n    for case in test_cases:\n        # gamma is not used in the calculation, but is part of the problem definition.\n        _gamma, nu, D = case\n\n        # The Schmidt number is the ratio of kinematic viscosity to self-diffusion coefficient.\n        # All values are dimensionless reduced DPD units.\n        sc = nu / D\n\n        # Round the result to 6 decimal places as required.\n        schmidt_numbers.append(round(sc, 6))\n\n    # Check if the sequence of Schmidt numbers is strictly increasing.\n    # The problem implies the cases are ordered by increasing gamma.\n    is_strictly_increasing = all(\n        schmidt_numbers[i]  schmidt_numbers[i+1] for i in range(len(schmidt_numbers) - 1)\n    )\n\n    # Combine the computed numbers and the boolean flag into a single list for output.\n    final_result = schmidt_numbers + [is_strictly_increasing]\n\n    # Final print statement in the exact required format.\n    # Use repr() on the boolean to get 'True'/'False' capitalization correctly.\n    print(f\"[{','.join(map(str, schmidt_numbers))},{repr(is_strictly_increasing)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building a robust coarse-grained model often requires matching multiple physical properties simultaneously. This capstone practice integrates the principles of the previous exercises into a complete, top-down parameterization workflow, a task central to modern multiscale simulation. Starting from target values for viscosity, diffusion, and compressibility, you will systematically determine the DPD length scale $r_c$, dissipative coefficient $\\gamma$, and conservative strength $a'$. This exercise demonstrates how to construct a self-consistent DPD model for a specific material, highlighting the interdependencies between parameters and the physical constraints that guide a successful multiscale mapping .",
            "id": "3803317",
            "problem": "You are asked to construct a principled multiscale mapping workflow for Dissipative Particle Dynamics (DPD) that selects a coarse-graining length scale, a dissipative interaction strength, and a conservative interaction strength to reproduce specified macroscopic properties of a polymer solution. The educational context is multiscale materials simulation at the advanced graduate level, and the solution must be grounded in first principles and well-tested formulas, explicitly derived from base physical laws and definitions rather than shortcut formulas.\n\nThe DPD model treats particles as coarse-grained beads evolving under Newton’s laws. A bead of mass $m$ at position $\\mathbf{r}$ and velocity $\\mathbf{v}$ obeys $m \\,\\mathrm{d}\\mathbf{v}/\\mathrm{d}t = \\sum \\mathbf{F}_{ij}$ where $\\mathbf{F}_{ij}$ decomposes into conservative, dissipative, and random forces. The Dissipative Particle Dynamics thermostat satisfies the fluctuation–dissipation relation $\\sigma^{2} = 2 \\gamma k_{\\mathrm{B}} T$ linking the random force amplitude $\\sigma$ and dissipative coefficient $\\gamma$ at temperature $T$, with $k_{\\mathrm{B}}$ the Boltzmann constant. For a single-component DPD fluid with bead number density $\\rho$ and a conservative force amplitude $a$ scaled by $k_{\\mathrm{B}}T/r_{c}$ (write $a = a' \\, k_{\\mathrm{B}}T/r_{c}$ where $a'$ is dimensionless), a widely used mean-field equation of state is $p = (k_{\\mathrm{B}} T / r_{c}^{3}) \\left(\\rho + \\alpha a' \\rho^{2}\\right)$ where $\\alpha$ is a dimensionless constant obtained by integrating the DPD weight function for the conservative force under the random phase approximation. The isothermal compressibility is defined by $\\kappa_{T} = -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial p}\\right)_{T} = \\frac{1}{n}\\left(\\frac{\\partial n}{\\partial p}\\right)_{T}$ where $V$ is volume and $n$ is number density. A dilute tracer’s self-diffusion coefficient $D$ in a viscous fluid is constrained by the Stokes–Einstein relation $D = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta d_{\\mathrm{h}}}$ where $\\eta$ is dynamic viscosity and $d_{\\mathrm{h}}$ the hydrodynamic diameter; in a coarse-grained mapping set $d_{\\mathrm{h}} = \\chi r_{c}$, with $\\chi$ a dimensionless hydrodynamic factor determined by coarse-graining resolution and polymer topology. To link the macroscopic viscosity $\\eta$ to DPD parameters, use a calibration principle: for a reference fluid at the same thermodynamic state, the dissipative mechanism provides a dominant and monotonic contribution to viscosity, so to leading order $\\eta \\propto \\gamma$, and a proportionality constant can be obtained by calibrating against one known pair $(\\gamma_{\\mathrm{ref}}, \\eta_{\\mathrm{ref}})$. All model constants and calibration values required are provided below.\n\nYour program must implement the following workflow for each test case:\n- Select the DPD length scale $r_{c}$ using the Stokes–Einstein constraint with the target diffusion $D_{\\mathrm{target}}$, target viscosity $\\eta_{\\mathrm{target}}$, and hydrodynamic factor $\\chi$.\n- Select the dissipative coefficient $\\gamma$ using the linear calibration relation between viscosity and $\\gamma$ with the provided reference pair $(\\gamma_{\\mathrm{ref}}, \\eta_{\\mathrm{ref}})$.\n- Select the conservative strength $a'$ by enforcing the isothermal compressibility target $\\kappa_{T,\\mathrm{target}}$ through the equation of state and the definition of $\\kappa_{T}$. If the computed $a'$ is nonpositive, this violates the repulsive conservative interaction requirement for a stable single-component DPD fluid under the given mean-field mapping; in that case, the design fails for the test case.\n\nFor each test case, compute the predicted macroscopic properties from the selected parameters and check whether all the following inequalities hold simultaneously:\n- $\\left|\\eta_{\\mathrm{pred}} - \\eta_{\\mathrm{target}}\\right| / \\eta_{\\mathrm{target}} \\leq \\tau_{\\eta}$,\n- $\\left|D_{\\mathrm{pred}} - D_{\\mathrm{target}}\\right| / D_{\\mathrm{target}} \\leq \\tau_{D}$,\n- $\\left|\\kappa_{T,\\mathrm{pred}} - \\kappa_{T,\\mathrm{target}}\\right| / \\kappa_{T,\\mathrm{target}} \\leq \\tau_{\\kappa}$,\nwhere $\\tau_{\\eta}$, $\\tau_{D}$, and $\\tau_{\\kappa}$ are the specified tolerances for viscosity, diffusion, and compressibility, respectively. If $a' \\leq 0$, you must treat the case as a failure regardless of the numerical comparisons above. The final result for each test case is a boolean indicating whether the workflow succeeds.\n\nUse the following constants and calibration values in your program:\n- Temperature $T = 300\\,\\mathrm{K}$ (write $T = 300$ in the code),\n- Boltzmann constant $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$,\n- DPD bead number density $\\rho = 3$ (in units of beads per $r_{c}^{3}$),\n- Conservative EOS coefficient $\\alpha = 0.101$,\n- Hydrodynamic factor $\\chi = 1.0$,\n- Viscosity calibration pair $(\\gamma_{\\mathrm{ref}}, \\eta_{\\mathrm{ref}}) = (4.5, 1.0 \\times 10^{-3}\\,\\mathrm{Pa \\cdot s})$; you must compute the calibration constant $C_{v}$ from this reference as $C_{v} = \\eta_{\\mathrm{ref}} / \\gamma_{\\mathrm{ref}}$.\n\nPhysical units and answer formatting requirements:\n- Express viscosity in $\\mathrm{Pa \\cdot s}$, diffusion in $\\mathrm{m^{2}/s}$, and isothermal compressibility in $\\mathrm{Pa^{-1}}$. Angles are not involved. Any fractional errors must be handled as decimals (e.g., $0.05$ for five percent).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_{1},result_{2},result_{3}]$ with no spaces). Each $result_{i}$ must be a boolean.\n\nTest suite:\n- Case $1$ (happy path): $\\eta_{\\mathrm{target}} = 1.5 \\times 10^{-3}$, $D_{\\mathrm{target}} = 2.0 \\times 10^{-10}$, $\\kappa_{T,\\mathrm{target}} = 4.5 \\times 10^{-10}$, tolerances $(\\tau_{\\eta}, \\tau_{D}, \\tau_{\\kappa}) = (0.05, 0.05, 0.05)$.\n- Case $2$ (boundary: small $r_{c}$ with stiff fluid): $\\eta_{\\mathrm{target}} = 1.0 \\times 10^{-3}$, $D_{\\mathrm{target}} = 1.0 \\times 10^{-9}$, $\\kappa_{T,\\mathrm{target}} = 1.0 \\times 10^{-10}$, tolerances $(\\tau_{\\eta}, \\tau_{D}, \\tau_{\\kappa}) = (0.02, 0.02, 0.02)$.\n- Case $3$ (edge: unphysically large compressibility requiring attractive $a'$): $\\eta_{\\mathrm{target}} = 1.0 \\times 10^{-3}$, $D_{\\mathrm{target}} = 1.0 \\times 10^{-10}$, $\\kappa_{T,\\mathrm{target}} = 1.0 \\times 10^{-5}$, tolerances $(\\tau_{\\eta}, \\tau_{D}, \\tau_{\\kappa}) = (0.10, 0.10, 0.10)$. If $a' \\leq 0$, you must return failure.\n- Case $4$ (high-viscosity, slow diffusion): $\\eta_{\\mathrm{target}} = 1.0 \\times 10^{-1}$, $D_{\\mathrm{target}} = 1.0 \\times 10^{-12}$, $\\kappa_{T,\\mathrm{target}} = 4.5 \\times 10^{-10}$, tolerances $(\\tau_{\\eta}, \\tau_{D}, \\tau_{\\kappa}) = (0.05, 0.05, 0.05)$.\n\nYour program must implement the workflow above, apply it to the test suite, and print a single line in the exact format $[b_{1},b_{2},b_{3},b_{4}]$ with booleans $b_{i}$ indicating success or failure for each case.",
            "solution": "The problem requires the formulation and implementation of a multiscale mapping workflow for Dissipative Particle Dynamics (DPD). The objective is to determine a set of DPD parameters—the coarse-graining length scale $r_c$, the dissipative coefficient $\\gamma$, and the dimensionless conservative interaction strength $a'$—that reproduce a given set of target macroscopic properties: dynamic viscosity $\\eta_{\\mathrm{target}}$, self-diffusion coefficient $D_{\\mathrm{target}}$, and isothermal compressibility $\\kappa_{T, \\mathrm{target}}$. The solution must be derived from the fundamental principles and equations provided.\n\nThe problem is validated as scientifically sound, well-posed, and objective. It is based on established principles of DPD simulations, including the Groot-Warren equation of state, the Stokes-Einstein relation for diffusion, and the fluctuation-dissipation theorem. All necessary constants and a clear, sequential workflow are provided. We can therefore proceed with the derivation and implementation.\n\nThe workflow consists of three main steps for parameter selection, followed by a validation step where the predicted properties are checked against the targets.\n\n**1. Derivation of the Parameter Selection Formulas**\n\n**Step A: Selection of the Coarse-Graining Length Scale ($r_c$)**\n\nThe length scale $r_c$ is determined by relating the macroscopic diffusion and viscosity via the Stokes-Einstein relation. The relation is given as:\n$$D = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta d_{\\mathrm{h}}}$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, $\\eta$ is the dynamic viscosity, and $d_{\\mathrm{h}}$ is the hydrodynamic diameter of the diffusing particle. In this coarse-grained model, the hydrodynamic diameter is related to the DPD length scale $r_c$ by a dimensionless factor $\\chi$:\n$$d_{\\mathrm{h}} = \\chi r_{c}$$\nSubstituting the expression for $d_{\\mathrm{h}}$ into the Stokes-Einstein equation gives:\n$$D = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta \\chi r_{c}}$$\nTo find the appropriate $r_c$ for our system, we require that this relation holds for the target properties, $D_{\\mathrm{target}}$ and $\\eta_{\\mathrm{target}}$. Rearranging the equation to solve for $r_c$ yields the formula for our selected length scale, which we will call $r_{c, \\mathrm{sel}}$:\n$$r_{c, \\mathrm{sel}} = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta_{\\mathrm{target}} D_{\\mathrm{target}} \\chi}$$\n\n**Step B: Selection of the Dissipative Coefficient ($\\gamma$)**\n\nThe dissipative coefficient $\\gamma$ is linked to the macroscopic viscosity $\\eta$. The problem states a linear calibration principle, $\\eta \\propto \\gamma$, which we can write as:\n$$\\eta = C_v \\gamma$$\nwhere $C_v$ is a proportionality constant. This constant is determined from a known reference fluid, for which a pair of values $(\\gamma_{\\mathrm{ref}}, \\eta_{\\mathrm{ref}})$ is provided. We can compute $C_v$ as:\n$$C_v = \\frac{\\eta_{\\mathrm{ref}}}{\\gamma_{\\mathrm{ref}}}$$\nTo achieve the target viscosity $\\eta_{\\mathrm{target}}$, we must select a corresponding $\\gamma$, which we will call $\\gamma_{\\mathrm{sel}}$. From the calibration relation, we have:\n$$\\eta_{\\mathrm{target}} = C_v \\gamma_{\\mathrm{sel}}$$\nSolving for $\\gamma_{\\mathrm{sel}}$ gives:\n$$\\gamma_{\\mathrm{sel}} = \\frac{\\eta_{\\mathrm{target}}}{C_v} = \\eta_{\\mathrm{target}} \\left(\\frac{\\gamma_{\\mathrm{ref}}}{\\eta_{\\mathrm{ref}}}\\right)$$\n\n**Step C: Selection of the Conservative Interaction Strength ($a'$)**\n\nThe conservative interaction strength $a'$ is determined by matching the target isothermal compressibility, $\\kappa_{T, \\mathrm{target}}$. The isothermal compressibility is defined as:\n$$\\kappa_{T} = \\frac{1}{n}\\left(\\frac{\\partial n}{\\partial p}\\right)_{T}$$\nwhere $n$ is the number density in physical units (e.g., particles per $\\mathrm{m^3}$) and $p$ is the pressure. The DPD equation of state (EOS) is given in terms of the dimensionless number density $\\rho$ (particles per $r_c^3$):\n$$p = \\frac{k_{\\mathrm{B}} T}{r_{c}^{3}} \\left(\\rho + \\alpha a' \\rho^{2}\\right)$$\nThe physical number density $n$ and the DPD density $\\rho$ are related by $n = \\rho / r_c^3$. To use the definition of $\\kappa_T$, we must express $p$ as a function of $n$. Substituting $\\rho = n r_c^3$ into the EOS:\n$$p = \\frac{k_{\\mathrm{B}} T}{r_{c}^{3}} \\left( n r_c^3 + \\alpha a' (n r_c^3)^2 \\right) = k_{\\mathrm{B}} T \\left( n + \\alpha a' r_c^3 n^2 \\right)$$\nTo find $\\left(\\frac{\\partial n}{\\partial p}\\right)_{T}$, we first compute its inverse, $\\left(\\frac{\\partial p}{\\partial n}\\right)_{T}$:\n$$\\left(\\frac{\\partial p}{\\partial n}\\right)_{T} = \\frac{\\partial}{\\partial n} \\left[ k_{\\mathrm{B}} T \\left( n + \\alpha a' r_c^3 n^2 \\right) \\right] = k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' r_c^3 n \\right)$$\nSubstituting this into the definition of $\\kappa_T$:\n$$\\kappa_{T} = \\frac{1}{n} \\left[ k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' r_c^3 n \\right) \\right]^{-1} = \\frac{1}{n k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' r_c^3 n \\right)}$$\nFinally, we can express $\\kappa_T$ in terms of the DPD density $\\rho$ by substituting $n = \\rho / r_c^3$:\n$$\\kappa_{T} = \\frac{r_c^3}{\\rho} \\frac{1}{k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' r_c^3 (\\rho/r_c^3) \\right)} = \\frac{r_c^3}{\\rho k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a' \\rho \\right)}$$\nWe use this equation to find the value of $a'$, denoted $a'_{\\mathrm{sel}}$, that yields $\\kappa_{T, \\mathrm{target}}$ with the previously determined length scale $r_{c, \\mathrm{sel}}$.\n$$\\kappa_{T, \\mathrm{target}} = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a'_{\\mathrm{sel}} \\rho \\right)}$$\nRearranging to solve for $a'_{\\mathrm{sel}}$:\n$$1 + 2 \\alpha a'_{\\mathrm{sel}} \\rho = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}}$$\n$$2 \\alpha a'_{\\mathrm{sel}} \\rho = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}} - 1$$\n$$a'_{\\mathrm{sel}} = \\frac{1}{2 \\alpha \\rho} \\left( \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}} - 1 \\right)$$\n\nA critical physical constraint for a stable single-component fluid in this model is that the conservative interactions must be repulsive, which corresponds to $a'  0$. If the calculated $a'_{\\mathrm{sel}} \\leq 0$, the parameterization fails. This occurs if the target fluid is too compressible, requiring an unphysical attractive force within this mean-field framework.\n\n**2. Validation of the Selected Parameters**\n\nOnce the parameter set $(r_{c, \\mathrm{sel}}, \\gamma_{\\mathrm{sel}}, a'_{\\mathrm{sel}})$ is determined, the workflow requires predicting the macroscopic properties that result from this set and comparing them to the targets.\n\nThe predicted viscosity, $\\eta_{\\mathrm{pred}}$, is calculated from $\\gamma_{\\mathrm{sel}}$:\n$$\\eta_{\\mathrm{pred}} = C_v \\gamma_{\\mathrm{sel}} = C_v \\left(\\frac{\\eta_{\\mathrm{target}}}{C_v}\\right) = \\eta_{\\mathrm{target}}$$\nThe predicted diffusion coefficient, $D_{\\mathrm{pred}}$, is calculated from $r_{c, \\mathrm{sel}}$ and $\\eta_{\\mathrm{pred}}$:\n$$D_{\\mathrm{pred}} = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta_{\\mathrm{pred}} \\chi r_{c, \\mathrm{sel}}} = \\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta_{\\mathrm{target}} \\chi \\left(\\frac{k_{\\mathrm{B}} T}{6 \\pi \\eta_{\\mathrm{target}} D_{\\mathrm{target}} \\chi}\\right)} = D_{\\mathrm{target}}$$\nThe predicted isothermal compressibility, $\\kappa_{T, \\mathrm{pred}}$, is calculated from $r_{c, \\mathrm{sel}}$ and $a'_{\\mathrm{sel}}$:\n$$\\kappa_{T, \\mathrm{pred}} = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\left( 1 + 2 \\alpha a'_{\\mathrm{sel}} \\rho \\right)}$$\nSubstituting the expression for $a'_{\\mathrm{sel}}$, we find that the term in the parenthesis becomes $1 + 2 \\alpha a'_{\\mathrm{sel}} \\rho = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}}$. This leads to:\n$$\\kappa_{T, \\mathrm{pred}} = \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\left( \\frac{r_{c, \\mathrm{sel}}^3}{\\rho k_{\\mathrm{B}} T \\kappa_{T, \\mathrm{target}}} \\right)} = \\kappa_{T, \\mathrm{target}}$$\n\nBy a construction that inverts the property-parameter relations, the predicted properties exactly match the target properties. Consequently, the relative error checks will always be satisfied for any non-negative tolerances $\\tau_{\\eta}$, $\\tau_{D}$, and $\\tau_{\\kappa}$ (barring floating-point inaccuracies). The sole condition determining the success or failure of the workflow for a given set of targets is the physical requirement that $a'_{\\mathrm{sel}}  0$.\n\nThe final algorithm is as follows:\n1.  For each test case, calculate $r_{c, \\mathrm{sel}}$, $\\gamma_{\\mathrm{sel}}$, and $a'_{\\mathrm{sel}}$ using the derived formulas.\n2.  If $a'_{\\mathrm{sel}} \\leq 0$, the design fails.\n3.  If $a'_{\\mathrm{sel}}  0$, the design succeeds because the parameterization guarantees the target properties are met.\nThe program will implement this logic.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a multiscale mapping workflow for Dissipative Particle Dynamics (DPD)\n    to determine if a set of parameters can reproduce target macroscopic properties.\n    \"\"\"\n    \n    # Define physical and model constants\n    T = 300.0  # Temperature in Kelvin\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n    rho = 3.0  # Dimensionless DPD bead number density (beads / r_c^3)\n    alpha = 0.101  # Dimensionless coefficient for the conservative EOS\n    chi = 1.0  # Dimensionless hydrodynamic factor\n    \n    # Viscosity calibration reference values\n    gamma_ref = 4.5\n    eta_ref = 1.0e-3  # Pa.s\n    \n    # Viscosity calibration constant\n    C_v = eta_ref / gamma_ref # Pa.s\n    \n    # Pre-calculate k_B * T for efficiency\n    k_B_T = k_B * T\n\n    # Test suite provided in the problem statement\n    test_cases = [\n        # Case 1: Happy path\n        {'eta_target': 1.5e-3, 'D_target': 2.0e-10, 'kappa_T_target': 4.5e-10, 'tolerances': (0.05, 0.05, 0.05)},\n        # Case 2: Boundary case (stiff fluid)\n        {'eta_target': 1.0e-3, 'D_target': 1.0e-9, 'kappa_T_target': 1.0e-10, 'tolerances': (0.02, 0.02, 0.02)},\n        # Case 3: Edge case (unphysically large compressibility)\n        {'eta_target': 1.0e-3, 'D_target': 1.0e-10, 'kappa_T_target': 1.0e-5, 'tolerances': (0.10, 0.10, 0.10)},\n        # Case 4: High viscosity, slow diffusion\n        {'eta_target': 1.0e-1, 'D_target': 1.0e-12, 'kappa_T_target': 4.5e-10, 'tolerances': (0.05, 0.05, 0.05)},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        eta_target = case['eta_target']\n        D_target = case['D_target']\n        kappa_T_target = case['kappa_T_target']\n        tau_eta, tau_D, tau_kappa = case['tolerances']\n\n        # --- Step 1: Select DPD length scale r_c ---\n        # From Stokes-Einstein: r_c = k_B*T / (6 * pi * eta * D * chi)\n        r_c_sel = k_B_T / (6.0 * np.pi * eta_target * D_target * chi)\n\n        # --- Step 2: Select dissipative coefficient gamma ---\n        # From linear calibration: gamma = eta / C_v\n        gamma_sel = eta_target / C_v\n\n        # --- Step 3: Select conservative strength a' ---\n        # From compressibility: a' = (1 / (2*alpha*rho)) * (r_c^3 / (rho*k_B*T*kappa_T) - 1)\n        term_in_paren = (r_c_sel**3) / (rho * k_B_T * kappa_T_target)\n        a_prime_sel = (1.0 / (2.0 * alpha * rho)) * (term_in_paren - 1.0)\n        \n        # --- Validation Step ---\n        # The primary failure condition is a non-repulsive conservative force (a' = 0).\n        if a_prime_sel = 0:\n            results.append(False)\n            continue\n\n        # If a' > 0, we proceed to compute predicted properties and check against tolerances.\n        # As derived in the solution, the parameterization is invertible, so the predicted\n        # properties will match the targets perfectly, barring floating-point errors.\n        # The tolerance checks are thus formally required but are expected to pass.\n\n        # Predict viscosity\n        eta_pred = C_v * gamma_sel\n        \n        # Predict diffusion coefficient\n        D_pred = k_B_T / (6.0 * np.pi * eta_pred * chi * r_c_sel)\n        \n        # Predict isothermal compressibility\n        kappa_T_pred = (r_c_sel**3) / (rho * k_B_T * (1.0 + 2.0 * alpha * a_prime_sel * rho))\n        \n        # Check if all properties are within their respective tolerances\n        err_eta = np.abs(eta_pred - eta_target) / eta_target\n        err_D = np.abs(D_pred - D_target) / D_target\n        err_kappa_T = np.abs(kappa_T_pred - kappa_T_target) / kappa_T_target\n        \n        success = (err_eta = tau_eta) and (err_D = tau_D) and (err_kappa_T = tau_kappa)\n        \n        results.append(success)\n\n    # Format the final output as a Python-style list of booleans.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}