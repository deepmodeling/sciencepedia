## 应用与跨学科联系

在前面的章节中，我们已经系统地阐述了[光滑粒子流体动力学](@entry_id:637248)（SPH）方法的核心原理与数值机制，包括核函数插值、粒子近似以及控制方程的离散化。理论的价值最终体现在其应用之中。本章的使命是超越基础理论，探索SPH如何在广泛的科学与工程问题中展现其强大的生命力与适应性。我们将不再重复介绍核心概念，而是聚焦于展示这些原理在多样化、真实世界及跨学科背景下的应用、扩展与融合。

通过一系列精心设计的应用案例，我们将揭示SPH不仅是一种强大的[计算流体动力学](@entry_id:142614)（CFD）工具，更是一种通用的、基于粒子的拉格朗日方法，能够用于求解各种[偏微分](@entry_id:194612)方程。从天体物理学中的[星系碰撞](@entry_id:158614)到地球科学中的[海啸传播](@entry_id:203810)，从工程领域的[非牛顿流体](@entry_id:154737)到计算机图形学中的图像处理，SPH的适应性彰显了其作为一种数值框架的深刻潜力。本章旨在引导读者深入理解SPH在解决实际问题中的效用，并激发将其应用于新领域的创造性思维。

### [计算流体动力学](@entry_id:142614)中的前沿主题

SPH最初作为一种[流体动力学模拟](@entry_id:142279)方法而诞生，其在该领域的应用已极为成熟和深入。本节将探讨SPH在处理复杂流体现象时的一些高级应用，展示其如何处理界面、非牛顿效应和[湍流](@entry_id:151300)等挑战性问题。

#### 表面张力与多相流

在许多物理和工程问题中，[流体界面](@entry_id:197635)的行为至关重要，例如液滴的形成、气泡的运动以及多相流的分离。[SPH方法](@entry_id:755216)基于其拉格朗日和无网格的特性，能够非常自然地捕捉和追踪[大变形](@entry_id:167243)的自由表面和[流体界面](@entry_id:197635)。表面张力效应源于界面上的分子间作用力，宏观上表现为一种使界面面积最小化的趋势。在SPH中，这可以通过引入一种作用于界面粒子上的力来模拟。

这种力的计算通常依赖于对界面曲率 $\kappa$ 的精确估计。一种常见的方法是利用一个平滑的颜色函数或指示函数 $C$ 来区分不同相态的流体。该函数的梯度方向即为界面的[法向量](@entry_id:264185) $\mathbf{n} = \nabla C / |\nabla C|$，而曲率则可以通过法向量的散度来近似，即 $\kappa \approx \nabla \cdot \mathbf{n}$。一旦获得曲率，表面张力就可以通过杨-拉普拉斯方程 $\Delta p = \sigma \kappa$ 转化为界面上的压力跳跃，或者直接表示为一个体力项。例如，对于一个半径为 $R$ 的球形液滴，其内部与外部的理论压力差为 $\Delta p = 2\sigma / R$。在SPH模拟中，通过计算粒子邻域内的颜色函数梯度和散度，可以数值地重现这一压力差。然而，这种计算的精度严重依赖于粒子分辨率。为了在给定的误差容限 $\varepsilon_{\mathrm{t}}$ 内准确模拟表面张力，需要足够的粒子来解析界面曲率。分辨率标准通常将期望[误差分解](@entry_id:636944)为与核[函数平滑](@entry_id:201048)相关的系统偏差项（bias）和与邻居粒子数相关的采样噪声项（noise），从而推导出达到目标精度所需的最小粒子数。这突显了在进行涉及界面的高精度SPH模拟时，进行细致的分辨率分析是何等重要。

#### [非牛顿流变学](@entry_id:752584)

[牛顿流体](@entry_id:263796)模型假设剪切应力与[剪切应变率](@entry_id:276945)成线性关系，其比例系数即为粘度。然而，自然界与工业生产中充满了[非牛顿流体](@entry_id:154737)，如熔岩、[聚合物熔体](@entry_id:192068)、血液和泥浆，其[表观粘度](@entry_id:260802)会随局部流动条件（如剪切率）而变化。[SPH方法](@entry_id:755216)的粒子化和局部性使其成为模拟这类复杂流变行为的理想工具。

在SPH框架中，每个粒子都可以携带其局部的流变属性。要实现这一点，首先需要在每个粒子位置 $a$ 处计算[速度梯度张量](@entry_id:270928) $\nabla \mathbf{v}_a$。这可以通过对邻近粒子 $b$ 的速度差进行[核函数](@entry_id:145324)梯度加权求和来实现：
$$
\nabla \mathbf{v}_a \approx \sum_{b} \frac{m_b}{\rho_b} \left( \mathbf{v}_b - \mathbf{v}_a \right) \otimes \nabla_a W(\mathbf{r}_{ab}, h)
$$
其中 $\otimes$ 表示[外积](@entry_id:147029)。速度梯度[张量的对称部分](@entry_id:182434)即为应变率张量 $\dot{\gamma} = \frac{1}{2} ( \nabla \mathbf{v} + (\nabla \mathbf{v})^{\mathsf{T}} )$。其大小，通常由张量的第二不变量定义，即 $\dot{\gamma}_{\mathrm{mag}} = \sqrt{ 2 \dot{\gamma} : \dot{\gamma} }$，它量化了局部的[剪切变形](@entry_id:170920)速率。对于一个[幂律流体](@entry_id:151453)，其[动力粘度](@entry_id:268228) $\mu$ 就可以表示为剪切率大小的函数，例如 $\mu = K ( \dot{\gamma}_{\mathrm{mag}} + \dot{\gamma}_{0} )^{n - 1}$，其中 $K$ 是稠度系数，$n$ 是幂律指数，$\dot{\gamma}_{0}$ 是为避免奇异性而引入的正则化项。通过在每个时间步为每个粒子计算其局部的 $\dot{\gamma}_{\mathrm{mag}}$ 并更新其粘度 $\mu$，SPH模拟便能动态地捕捉流体的[剪切致稠](@entry_id:260777)（$n  1$）或剪切致稀（$n  1$）等非牛顿特性。

#### [湍流模拟](@entry_id:1133511)

[湍流](@entry_id:151300)是[流体动力](@entry_id:750449)学中一个长期存在的挑战，其特点是跨越多个尺度且高度无序的涡结构。[直接数值模拟](@entry_id:149543)（DNS）[湍流](@entry_id:151300)需要极高的分辨率来解析所有尺度，计算成本巨大。[大涡模拟](@entry_id:153702)（Large Eddy Simulation, LES）是一种更经济的替代方案，其核心思想是直接求解大尺度上的[涡流](@entry_id:275449)运动，而对小尺度的、更具普适性的亚格子尺度（Subgrid-Scale, SGS）涡流的影响进行模化。

SPH可以作为LES的数值框架。通过[Boussinesq假设](@entry_id:272519)，亚格子[应力张量](@entry_id:148973)的作用可以被模型化为一个额外的“[湍流](@entry_id:151300)粘度”或“涡粘度” $\nu_t$。[Smagorinsky模型](@entry_id:276289)是最经典的[SGS模型](@entry_id:754720)之一，它通过量纲分析得出 $\nu_t$ 应与当地的[特征长度尺度](@entry_id:266383)和[特征时间尺度](@entry_id:276738)的倒数相关。在LES中，[特征长度尺度](@entry_id:266383)是滤波宽度 $\Delta$，特征时间尺度的倒数则由解析尺度应变率张量的大小 $|\mathbf{S}|$ 来表示。因此，涡粘度模型可以写作：
$$
\nu_t = (C_s \Delta)^2 |\mathbf{S}|
$$
其中 $C_s$ 是Smagorinsky常数。在SPH中，核[函数平滑](@entry_id:201048)本身就是一种滤波操作，因此很自然地可以将滤波宽度 $\Delta$ 与SPH的平滑长度 $h$ 联系起来，即 $\Delta \sim h$。解析尺度的应变率张量 $\mathbf{S}$ 及其大小 $|\mathbf{S}| = \sqrt{2\mathbf{S}:\mathbf{S}}$ 可以在每个粒子位置利用前述的[速度梯度](@entry_id:261686)SPH估计式来计算。这样，SPH-LES模型就能在每个粒子上动态计算其局部的[湍流](@entry_id:151300)粘度，从而耗散掉亚格子尺度的能量，并对大尺度流动产生正确的影响。

#### 基准测试与验证

任何数值方法的可靠性都必须通过严格的[验证和确认](@entry_id:170361)（Verification and Validation, VV）来建立。为此，研究界已经开发了一套标准的基准测试问题，例如[泰勒-格林涡](@entry_id:755822)（Taylor-Green vortex）、[顶盖驱动方腔流](@entry_id:751266)（lid-driven cavity）和[溃坝问题](@entry_id:1123362)（dam-break）。

为了进行有意义的跨问题、跨分辨率比较，必须建立一套数学上合理且可复现的误差度量和验证协议。首先，SPH粒子数据必须通过一致的重构方法（例如，在固定的欧拉网格上进行核函数加权求和）转换成连续场，以便与参考解进行逐点比较。其次，[误差范数](@entry_id:176398)（如相对$L^2$范数）需要通过参考解的相应范数进行归一化，以得到无量纲的相对误差。对于涉及自由表面的问题，如溃坝，误差度量应基于可观测的物理量，如特定位置处自由面高度的时间序列或[波前](@entry_id:197956)位置随时间的变化，并进行适当的无量纲化处理。最后，为了评估收敛性，需要在对数-对数图上绘制误差与粒子初始间距 $\Delta x$ 的关系，并拟合其斜率来确定[收敛阶](@entry_id:146394)。在进行收敛性研究时，必须严格控制数值参数，例如保持平滑长度与粒子间距之比 $h/\Delta x$、[Courant数](@entry_id:143767) $Co$ 和Mach数 $Ma$ 恒定，以确保[空间分辨率](@entry_id:904633)是唯一变化的参数。一套严谨的验证协议是推动[SPH方法](@entry_id:755216)发展和建立其在科学与工程应用中信誉的基石。

### 地球物理与环境流动

SPH的拉格朗日特性和处理复杂几何及自由表面的能力，使其在模拟地球物理与环境流动现象方面具有独特的优势，这些现象往往涉及[大变形](@entry_id:167243)、多相相互作用和不规则的边界。

#### 海岸与海洋工程

在海岸与海洋工程领域，对波浪动力学，特别是极端事件如海啸和碎波的准确预测至关重要。SPH能够直接追踪流体质点，非常适合模拟这类剧烈的[自由表面流](@entry_id:265322)动。

例如，对于由海底地震引发的海啸，其生成过程可以被模型化为浅水方程。在SPH框架下，流体域被离散为携带水深 $h$ 和平均速度 $u$ 的粒子。海底的突然抬升被处理为变化的底床高程 $z_b(x,t)$，它直接影响重力项和水深。通过在SPH[动量方程](@entry_id:197225)中包含一个由底床坡度 $\partial z_b / \partial x$ 产生的体力项，可以模拟海底变形对水体的作用，从而生成初始波形。随后，这些粒子根据SPH形式的浅水方程进行演化，自然地捕捉波浪的传播、变形和最终的爬高。为了处理有限计算域带来的边界反射问题，通常在边界附近设置“[海绵层](@entry_id:1132208)”（sponge layer），通过引入一个与速度和水深扰动成正比的阻尼项来耗散[波能](@entry_id:164626)。

对于近岸区域的[碎波](@entry_id:268639)，其过程高度[非线性](@entry_id:637147)且涉及能量的剧烈耗散。SPH中的人工粘度项，最初是为捕捉激波而设计的，恰好可以用来模拟[碎波](@entry_id:268639)导致的能量损失。然而，标准的SPH人工粘度参数（如 $\alpha$ 和 $\beta$）通常是为[可压缩气体动力学](@entry_id:169361)调整的，需要针对海岸波浪进行校准。一种更物理的方法是通过量纲分析，将粘度参数与描述波浪状态的[无量纲数](@entry_id:260863)（如波陡 $\epsilon = kH$ 和雷诺数 $\mathrm{Re}$）联系起来。通过建立一个依赖于波陡的目标粒子雷诺数 $\mathrm{Re}_{h,\mathrm{target}}(\epsilon)$，可以反解出所需的总[有效粘度](@entry_id:204056)。然后，根据流动状态（例如，通过物理雷诺数和波陡判断），可以将所需的粘度增量分配给线性的 $\alpha$ 项（模拟剪切耗散）和[非线性](@entry_id:637147)的 $\beta$ 项（模拟类激波耗散）。这种基于物理标度的校准方法，使得SPH模型在模拟[波浪破碎](@entry_id:268639)这类复杂现象时更具预测性和鲁棒性。

#### [泥沙输运](@entry_id:1131379)与[地貌学](@entry_id:182022)

河流、海岸和海底的形态演化是由流体流动与可移动沉积物（如沙、砾石）之间的相互作用驱动的。模拟这类过程需要一个能够处理流固[两相流](@entry_id:153752)的模型。SPH为耦合流体和颗粒相提供了一个灵活的框架。

在一个两相SPH模型中，流体和颗粒物（泥沙）可以被表示为两组不同的SPH粒子，它们具有各自的物理属性（如密度 $\rho_f$, $\rho_s$）。两相之间的耦合主要通过相间阻力（drag）和[浮力](@entry_id:154088)来实现。根据牛顿第三定律，流体对颗粒施加的阻力等于颗粒对流体施加的反作用力。在SPH中，作用于一个颗粒粒子 $k$ 上的阻力可以表示为 $\mathbf{F}_{D,k} \propto \beta (\langle \mathbf{v}_f \rangle_k - \mathbf{v}_k)$，其中 $\beta$ 是相间[阻力系数](@entry_id:276893)，$\mathbf{v}_k$ 是颗粒自身的速度，而 $\langle \mathbf{v}_f \rangle_k$ 是通过[SPH核函数](@entry_id:1132126)插值得到的、在颗粒 $k$ 位置处的局部流体速度。[浮力](@entry_id:154088)则通过将颗粒的重力与周围流体压力梯度施加的力相结合而自然产生。在静水或近静水条件下，这等效于颗粒的重量减去它所排开流体的重量。

利用这样的两相模型，可以计算出流体在河床或海床上施加的[床面剪切应力](@entry_id:262541) $\tau_b$。该应力等于界面层内流体对颗粒施加的总切向阻力。进一步，可以计算无量纲的[希尔兹参数](@entry_id:1131566)（Shields parameter） $\Theta = \tau_{b} / ((\rho_{s}-\rho_{f}) g d)$，其中 $d$ 是颗粒直径。[希尔兹参数](@entry_id:1131566)是判断沉积物是否开始运动（起动）的关键指标，因此，两相SPH模型为研究[沉积物输运](@entry_id:1131379)和地貌演化提供了直接的物理联系。

#### 冰冻圈动力学（[冰川学](@entry_id:1125653)）

冰川和冰盖的流动虽然缓慢，但对其在气候变化下的行为进行建模至关重要。冰可以被视为一种[粘塑性流体](@entry_id:271743)，其流动由重力驱动。[SPH方法](@entry_id:755216)也被应用于模拟[冰川动力学](@entry_id:1125652)，特别是像冰山崩解（calving）这样的剧烈过程。

冰山崩解是冰川末端由于应力超过冰的强度而发生的断裂。一种建模方法是将SPH与经典的[固体力学](@entry_id:164042)理论相结合。例如，可以将悬浮在水中的冰川末端近似为一根受[浮力](@entry_id:154088)作用的[悬臂梁](@entry_id:174096)（[Euler-Bernoulli梁](@entry_id:749104)）。SPH的作用在于提供一种稳健的方法来计算分布在冰体上的净垂直力。对于离散化的冰川粒子，每个粒子都受到向下的重力和向上的[浮力](@entry_id:154088)（取决于其 submerged fraction）。这些离散的粒子[力场](@entry_id:147325)可以通过[SPH核函数](@entry_id:1132126)进行平滑，以获得一个连续的、空间变化的力密度分布。然后，将这个平滑后的力沿冰川长度积分，就可以得到在冰川接地线（即梁的固定端）处的总[弯矩](@entry_id:202968) $M$。根据[梁理论](@entry_id:176426)，最大弯曲应力为 $\sigma_{\max} = |M|c/I$，其中 $c$ 是到中性轴的距离，$I$ 是[截面](@entry_id:154995)的二阶矩。将这个计算出的应力与冰的[抗拉强度](@entry_id:901383)（可由冯·米塞斯准则从剪切屈服应力 $\tau_y$ 导出，即 $\sigma_y = \sqrt{3}\tau_y$）进行比较，就可以预测崩解事件是否可能发生。这种混合方法巧妙地利用SPH进行[力场](@entry_id:147325)平滑，同时利用成熟的[结构力学](@entry_id:276699)理论进行[失效分析](@entry_id:266723)，展示了SPH作为一种通用数值工具的灵活性。

### 天体物理学与高能现象

天体物理学是[SPH方法](@entry_id:755216)诞生和发展的摇篮。由于天体物理系统常常涉及无边界、[自引力](@entry_id:271015)、[大变形](@entry_id:167243)和激波等现象，无网格的拉格朗日[SPH方法](@entry_id:755216)在此具有天然的优势。

#### [自引力流体](@entry_id:754668)与[恒星形成](@entry_id:159940)

恒星和[行星系统形成](@entry_id:158484)于巨大的[自引力](@entry_id:271015)气体云的[引力坍缩](@entry_id:161275)。模拟这一过程对数值方法提出了严峻的挑战，既要准确计算长程的[引力](@entry_id:189550)，又要处理流体动力学中的激波和不稳定性。

在SPH中，[引力](@entry_id:189550)通常通过对所有粒子对之间的[牛顿引力](@entry_id:159796)进行直接求和来计算，并通过[引力软化](@entry_id:146273)（softening）来避免奇异性。一个关键的数值挑战是所谓的“[配对不稳定性](@entry_id:158107)”（pairing instability）。这种非物理的粒子聚集现象源于标准[样条](@entry_id:143749)[核函数](@entry_id:145324)（如三次或五次[样条](@entry_id:143749)核）的傅里叶变换在某些高波数下为负值。在粒子排布非常规则（例如高邻居数 $N_{\mathrm{ngb}}$）的情况下，这会导致近距离粒子对之间产生虚假的吸[引力](@entry_id:189550)。为了克服这个问题，研究者开发了具有严格非负傅里叶[变换的核](@entry_id:149509)函数，如[Wendland核](@entry_id:756700)函数族。这些核函数通过数学构造保证了在任何粒子构型下都不会出现[配对不稳定性](@entry_id:158107)，从而显著提高了模拟的保真度。

另一个核心问题是正确解析物理的[引力不稳定性](@entry_id:160721)，即[金斯不稳定性](@entry_id:160141)（Jeans instability）。为了避免人工碎片化（artificial fragmentation），即由于[数值误差](@entry_id:635587)导致的非物理解体，SPH模拟必须满足一个分辨率准则。[金斯质量](@entry_id:161883) $M_J$ 是能够克服内部压力支撑而发生[引力坍缩](@entry_id:161275)的最小质量。SPH的[分辨率极限](@entry_id:200378)由邻居粒子的总质量 $N_{\mathrm{ngb}}m$ 给出。一个被广泛接受的准则是，[金斯质量](@entry_id:161883)必须被至少两倍的SPH分辨率质量所解析，即 $M_J \ge 2 N_{\mathrm{ngb}} m$。此外，[引力](@entry_id:189550)计算的[软化长度](@entry_id:755011) $\epsilon$ 和[流体动力](@entry_id:750449)学计算的平滑长度 $h$ 必须协调一致。通常取 $\epsilon \approx h$ 可以确保[引力](@entry_id:189550)和压力梯度在相似的尺度上作用，从而避免因[尺度不匹配](@entry_id:1131268)而引入的人工效应。

#### 巨行星撞击与[行星科学](@entry_id:158926)

行星形成晚期的巨行星撞击事件（例如形成月球的撞击）是塑造我们太阳系的关键过程。这些事件涉及超高速碰撞，产生强烈的激波，并将物质加热到极端状态。SPH是模拟这类高[马赫数](@entry_id:274014)、能量主导的动力学过程的标准工具。

这些模拟基于[可压缩欧拉方程](@entry_id:747588)。由于碰撞速度远[超材料](@entry_id:276826)的声速，必须在SPH动量方程中引入人工粘度（artificial viscosity）项 $\Pi_{ij}$。这一项在数学上类似于一个额外的压力项，其作用是在激波处产生[熵增](@entry_id:138799)，将动能转化为内能，并防止粒子发生非物理的穿透。一个标准的、被广泛采用的形式是Monaghan型人工粘度，它包含一个与声速成正比的线性项（由参数 $\alpha$ 控制）和一个与[相对速度](@entry_id:178060)平方成正比的二次项（由参数 $\beta$ 控制）：
$$
\Pi_{ij} = \frac{-\alpha \bar{c}_{ij} \mu_{ij} + \beta \mu_{ij}^2}{\bar{\rho}_{ij}}
$$
其中 $\bar{c}_{ij}$ 和 $\bar{\rho}_{ij}$ 是粒子对的平均声速和密度，而 $\mu_{ij}$ 是一个依赖于粒子间相对速度和位置的项。这个[粘性力](@entry_id:263294)被设计为仅在粒子相互接近时（$\mathbf{v}_{ij} \cdot \mathbf{r}_{ij}  0$）才起作用，并且是伽利略不变的。为了保证总能量守恒，人工粘度所做的功必须以热量的形式加入到内能方程中。正确的SPH能量方程包含了压力功和[粘性加热](@entry_id:161646)两项：
$$
\frac{d u_i}{dt} = \sum_j m_j \left( \frac{p_i}{\rho_i^2} + \frac{1}{2}\Pi_{ij} \right) \mathbf{v}_{ij} \cdot \nabla_i W_{ij}
$$
这套包含对称压力梯度、人工粘度以及相应能量[演化方程](@entry_id:268137)的SPH体系，构成了现代天体物理碰撞模拟的基石。

### 从物理到其他学科：作为通用框架的SPH

SPH的核心思想——通过核函数对离散粒子携带的物理量进行平滑插值——具有极大的普适性。这种思想已经超越了其在流体和天体物理学中的起源，被应用于众多其他领域，展示了SPH作为一种通用数值和建模框架的强大潜力。

#### [固体力学](@entry_id:164042)与断裂

尽管名字中含有“[流体动力](@entry_id:750449)学”，SPH同样可以被修改用于模拟固体的[弹塑性](@entry_id:193198)变形和断裂。与[流体模拟](@entry_id:138114)不同，固体模拟通常在拉格朗日参考构型（Lagrangian reference configuration）中进行，其中梯度等算子是针对材料的初始未变形位置 $\mathbf{X}$ 计算的。[位移梯度张量](@entry_id:748571) $\nabla \mathbf{u}$ 可以通过对邻近粒子的位移差进行SPH插值来计算。为了确保在一阶上精确（尤其是在边界附近），需要使用修正的梯度算子，例如通过求解一个[局部线性](@entry_id:266981)系统或使用矩量矩阵 $\mathbf{L}_i$ 进行修正：
$$
\nabla \mathbf{u}_i \approx \left( \sum_j V_j (\mathbf{u}_j - \mathbf{u}_i) \otimes \nabla_i W_{ij} \right) \mathbf{L}_i^{-1}
$$
其中 $V_j$ 是粒子体积。一旦获得[位移梯度](@entry_id:165352)，就可以计算应变张量 $\boldsymbol{\varepsilon} = \frac{1}{2}(\nabla \mathbf{u} + \nabla \mathbf{u}^{\mathsf{T}})$，并通过[本构关系](@entry_id:186508)（如胡克定律）计算应力张量。

SPH的粒子特性使其特别适合模拟断裂。断裂可以被模型化为粒子间“键”的断开。一个简单的断裂准则可以是：当某个粒子上的应变或应力分量超过材料的临界强度阈值时，该粒子与其邻居之间的相互作用（即力计算）就被终止。例如，可以定义当任一粒子对 $\{i,j\}$ 中某个粒子的最大[主应变](@entry_id:197797)或特定应变分量（如 $|\varepsilon_{i,xx}|$）超过临界值 $\varepsilon_{\mathrm{crit}}$ 时，它们之间的键就断裂。这种方法能够自然地模拟裂纹的萌生和扩展，而无需像有限元方法（FEM）那样进行复杂的网格重构。

#### 与其他方法的耦合（混合模型）

在许多复杂系统中，不同组分可能适用不同的物理模型或数值方法。SPH可以作为[多物理场](@entry_id:164478)或多尺度模拟中的一个组成部分，与其他方法进行耦合。一个典型的例子是流体-结构相互作用（FSI），尤其是当结构是离散的或数量较少时。

例如，在模拟水流与大块岩石的相互作用时，将水体用SPH（连续介质）模拟，而将岩石用离散元方法（Discrete Element Method, DEM）模拟是一种高效的策略。DEM将每个岩石视为一个独立的[刚体](@entry_id:1131033)或柔性体，其运动由牛顿第二定律积分得到。两者之间的耦合通过相间作用力实现。在每个时间步，SPH流场在每个岩石（DEM粒子）的位置处提供一个背景流速，这通过对周围SPH水分子的速度进行核函数加权平均得到。然后，根据这个局部流速和岩石自身的速度，可以计算出流体对岩石施加的拖曳力（例如，使用线性斯托克斯拖曳力模型）。根据[牛顿第三定律](@entry_id:166652)，这个力的[反作用](@entry_id:203910)力必须被施加回流体上。这个[反作用](@entry_id:203910)力可以按照[核函数](@entry_id:145324)权重分配给岩石周围的SPH水分子，从而保证整个系统的[动量守恒](@entry_id:149964)。这种SPH-DEM混合方法结合了SPH处理复杂流体自由表面的优势和DEM高效模拟离散物体动力学的优势。

#### 集体行为与[基于主体的建模](@entry_id:146624)

SPH的哲学——“每个个体根据其邻域的平滑平均信息来更新自身状态”——与生物学和社会科学中许多集体行为的模型不谋而合。这使得SPH框架可以被“借用”来模拟从鸟群、鱼群到人群的集体动态。

在这些所谓的“[基于主体的模型](@entry_id:199978)”（Agent-Based Models, ABM）中，每个“粒子”不再是流[体元](@entry_id:267802)，而是一个自主的个体（agent），如一条鱼或一个行人。其“动力学方程”不再是[牛顿定律](@entry_id:163541)，而是描述行为规则的经验或启发式方程。例如，一个经典的鱼群模型规则是速度对齐：每条鱼试图将其速度调整为它邻居的平均速度。这可以完美地用SPH的插值公式来表达：
$$
\mathbf{v}_i^{\,\mathrm{new}} = \frac{\sum_{j} W(r_{ij}, h)\,\mathbf{v}_j}{\sum_{j} W(r_{ij}, h)}
$$
这里，[核函数](@entry_id:145324) $W$ 定义了“感知范围”和影响权重。通过这种方式，简单的局部对齐规则可以在宏观上涌现出复杂的、有序的[集体运动](@entry_id:747472)。

类似地，在人群动力学中，个体的运动决策受到周围人群密度的影响。高密度会产生一种“不适感”，驱使人们寻找密度较低的区域。这种心理压力可以被类比为物理学中的压力。我们可以定义一个依赖于SPH密度 $\rho_i = \sum_j m_j W_{ij}$ 的“不适压力” $P_i$。然后，利用标准的SPH压力梯度项来计算一个“社会力”，该力会推动粒子从高密度区域向低密度区域移动。这种方法将复杂的社会心理现象简化为易于计算的、基于局部密度的排斥力，为模拟紧急疏散等场景提供了一种计算上可行的方法。

#### [图像处理](@entry_id:276975)与[计算机图形学](@entry_id:148077)

SPH的数学本质是一种离散的卷积运算。这个事实使其与信号处理和[图像处理](@entry_id:276975)领域建立了深刻的联系。一个2D灰度图像可以被看作是在一个规则的像素网格[上采样](@entry_id:275608)得到的[标量场](@entry_id:151443)。将每个像素视为一个携带其灰度值 $A_i$ 的SPH粒子，我们就可以应用SPH算子来进行各种[图像处理](@entry_id:276975)操作。

例如，对图像进行平滑或模糊处理，等效于对灰度场进行低通滤波。这可以直接通过SPH的插值（或“0阶”）公式来实现。计算每个像素（粒子）的平滑后灰度值 $A_i^{\mathrm{sm}}$：
$$
A_i^{\mathrm{sm}} = \sum_{j} m_j\,\frac{A_j}{\rho_j}\,W(\mathbf{r}_{ij}, h)
$$
这里，$h$ 的大小决定了模糊的程度，类似于滤波器的带宽。这本质上是用[SPH核函数](@entry_id:1132126)替换了传统[图像处理](@entry_id:276975)中的高斯核或其他模糊核。

更有趣的是，图像的边缘检测等价于[计算图](@entry_id:636350)像灰度场的梯度。梯度较大的区域对应于图像中强度变化剧烈的边缘。SPH的梯度算子可以被直接用来计算这个[梯度场](@entry_id:264143)。例如，使用反对称形式的[梯度算子](@entry_id:1125719)，在每个像素 $i$ 处计算其灰度梯度 $\nabla A_i$：
$$
\nabla A_i = \sum_{j} m_j\,\frac{A_j - A_i}{\rho_j}\,\nabla W(\mathbf{r}_{ij}, h)
$$
然后，[梯度向量](@entry_id:141180)的模值 $|\nabla A_i|$ 就可以用来生成一幅边缘强度图。这个例子清晰地表明，SPH的数学工具箱，如图所示的插值和梯度算子，是解决[偏微分](@entry_id:194612)方程的通用工具，其应用远远超出了流体力学的范畴。