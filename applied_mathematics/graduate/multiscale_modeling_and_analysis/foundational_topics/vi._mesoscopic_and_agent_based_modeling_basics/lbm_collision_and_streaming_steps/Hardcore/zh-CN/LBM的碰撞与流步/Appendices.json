{
    "hands_on_practices": [
        {
            "introduction": "格子玻尔兹曼方法（LBM）的核心在于碰撞步，它模拟了粒子布居函数向局部平衡态的弛豫过程。这个平衡态布居函数 $f_i^{eq}$ 是连接介观粒子世界和宏观流体世界的桥梁，其构造必须精确地恢复目标宏观方程。本练习将指导您从基本守恒矩约束出发，推导并计算D2Q9模型下的平衡态布居函数，这是理解LBM与流体动力学关联的基石 。",
            "id": "3774257",
            "problem": "在格子单位下，考虑一个格子玻尔兹曼方法（LBM）中的二维九速（D2Q9）格子模型，其中粒子流速度为 $c=1$，格子声速满足 $c_{s}^{2} = 1/3$。在单松弛时间 Bhatnagar-Gross-Krook (BGK) 动力学模型中，碰撞步将单粒子分布函数弛豫到一个平衡态，该平衡态在低马赫数区域下，当对一个合适的离散速度集取矩时，必须能够恢复流体动力学场和各向同性应力张量。从流体速度的二阶展开的连续 Maxwell-Boltzmann 平衡分布出发，并利用离散平衡态能够得到与 $c_{s}^{2}$ 一致的精确密度、动量和各向同性二阶矩的约束条件，推导 D2Q9 格子上的离散平衡分布函数 $f_{i}^{eq}$。\n\nD2Q9 离散速度为\n$$\n\\mathbf{e}_{0} = (0,0),\\quad\n\\mathbf{e}_{1} = (1,0),\\quad\n\\mathbf{e}_{2} = (0,1),\\quad\n\\mathbf{e}_{3} = (-1,0),\\quad\n\\mathbf{e}_{4} = (0,-1),\\quad\n\\mathbf{e}_{5} = (1,1),\\quad\n\\mathbf{e}_{6} = (-1,1),\\quad\n\\mathbf{e}_{7} = (-1,-1),\\quad\n\\mathbf{e}_{8} = (1,-1),\n$$\n相应的 Gauss-Hermite 求积权重为\n$$\nw_{0} = \\frac{4}{9},\\quad w_{1} = w_{2} = w_{3} = w_{4} = \\frac{1}{9},\\quad w_{5} = w_{6} = w_{7} = w_{8} = \\frac{1}{36}.\n$$\n\n使用您推导的公式，对密度 $\\rho = 1.2$ 和速度 $\\mathbf{u} = (0.08,-0.03)$ 的情况，数值计算平衡分布函数。验证零阶矩和一阶矩约束，并检查所有九个方向的正定性条件。最后，报告在所有 $i \\in \\{0,\\dots,8\\}$ 中 $f_{i}^{eq}$ 的最小值，作为您以格子单位表示的唯一最终结果。将您的最终答案四舍五入至六位有效数字。",
            "solution": "该问题被验证为具有科学依据、提法恰当且完整。这是格子玻尔兹曼方法（LBM）领域的一个标准问题，并提供了所有必要的数据和条件。\n\n主要目标是为二维九速（D2Q9）格子模型推导离散平衡分布函数 $f_{i}^{eq}$。推导基于对分布函数的矩施加约束。$f_{i}^{eq}$ 的标准速度二阶精度展开可以写成通用的多项式形式。然而，根据问题约束的要求，最直接的方法是通过确保它能恢复正确的流体动力学矩来确定 $f_{i}^{eq}$ 的形式：即密度、动量和动量通量张量。\n\n离散平衡分布函数 $f_{i}^{eq}$ 的矩所满足的约束条件是：\n1. 零阶矩（质量守恒）：$\\sum_{i=0}^{8} f_{i}^{eq} = \\rho$\n2. 一阶矩（动量守恒）：$\\sum_{i=0}^{8} f_{i}^{eq} \\mathbf{e}_{i} = \\rho \\mathbf{u}$\n3. 二阶矩（动量通量）：$\\sum_{i=0}^{8} f_{i}^{eq} \\mathbf{e}_{i} \\mathbf{e}_{i} = \\mathbf{\\Pi}^{eq} = \\rho c_{s}^{2} \\mathbf{I} + \\rho \\mathbf{u} \\mathbf{u}$\n此处，$\\rho$ 是流体密度，$\\mathbf{u}$ 是流体速度，$\\mathbf{e}_i$ 是离散格子速度，$c_s$ 是声速，$\\mathbf{I}$ 是单位张量。\n\n我们寻求一个关于 $\\rho$、$\\mathbf{u}$ 和 $\\mathbf{e}_i$ 的 $f_i^{eq}$ 表达式。与 Maxwell-Boltzmann 分布的二阶展开一致的标准方法是假设以下形式：\n$$f_{i}^{eq} = w_i \\rho \\left[ A + B(\\mathbf{e}_i \\cdot \\mathbf{u}) + C(\\mathbf{e}_i \\cdot \\mathbf{u})^2 + D u^2 \\right]$$\n其中 $w_i$ 是格子权重，$A$, $B$, $C$, $D$ 是待由矩约束确定的常数。为进行此推导，我们使用 D2Q9 格子的以下已知性质，其中 $\\alpha, \\beta, \\gamma, \\delta$ 是笛卡尔坐标索引：\n$$\n\\sum_{i} w_i = 1 \\\\\n\\sum_{i} w_i e_{i\\alpha} = 0 \\\\\n\\sum_{i} w_i e_{i\\alpha} e_{i\\beta} = c_s^2 \\delta_{\\alpha\\beta} \\\\\n\\sum_{i} w_i e_{i\\alpha} e_{i\\beta} e_{i\\gamma} = 0 \\\\\n\\sum_{i} w_i e_{i\\alpha} e_{i\\beta} e_{i\\gamma} e_{i\\delta} = c_s^4 (\\delta_{\\alpha\\beta}\\delta_{\\gamma\\delta} + \\delta_{\\alpha\\gamma}\\delta_{\\beta\\delta} + \\delta_{\\alpha\\delta}\\delta_{\\beta\\gamma})\n$$\n问题指定了 $c_s^2 = 1/3$。\n\n应用零阶矩约束：\n$$ \\sum_{i} f_{i}^{eq} = \\rho \\sum_{i} w_i \\left[ A + B e_{i\\alpha} u_{\\alpha} + C e_{i\\alpha}e_{i\\beta} u_{\\alpha} u_{\\beta} + D u_{\\gamma} u_{\\gamma} \\right] $$\n$$ \\rho = \\rho \\left[ A \\sum w_i + B u_{\\alpha} \\sum w_i e_{i\\alpha} + C u_{\\alpha} u_{\\beta} \\sum w_i e_{i\\alpha}e_{i\\beta} + D u^2 \\sum w_i \\right] $$\n$$ \\rho = \\rho \\left[ A(1) + B u_{\\alpha}(0) + C u_{\\alpha} u_{\\beta}(c_s^2 \\delta_{\\alpha\\beta}) + D u^2(1) \\right] $$\n$$ 1 = A + C c_s^2 u^2 + D u^2 $$\n为使此式对任意 $\\mathbf{u}$ 成立，必须有 $A=1$ 和 $C c_s^2 + D = 0$。\n\n应用一阶矩约束：\n$$ \\sum_{i} f_{i}^{eq} e_{i\\gamma} = \\rho \\sum_{i} w_i e_{i\\gamma} \\left[ A + B e_{i\\alpha} u_{\\alpha} + \\dots \\right] $$\n$$ \\rho u_{\\gamma} = \\rho \\left[ A \\sum w_i e_{i\\gamma} + B u_{\\alpha} \\sum w_i e_{i\\gamma}e_{i\\alpha} + \\dots \\right] $$\n$$ \\rho u_{\\gamma} = \\rho \\left[ A(0) + B u_{\\alpha} (c_s^2 \\delta_{\\gamma\\alpha}) + \\dots \\right] $$\n$$ \\rho u_{\\gamma} = \\rho B c_s^2 u_{\\gamma} \\implies B = \\frac{1}{c_s^2} $$\n\n应用二阶矩约束：\n$$ \\sum_{i} f_{i}^{eq} e_{i\\gamma} e_{i\\delta} = \\rho \\sum_{i} w_i e_{i\\gamma} e_{i\\delta} \\left[ A + B e_{i\\alpha} u_{\\alpha} + C e_{i\\alpha}e_{i\\beta} u_{\\alpha} u_{\\beta} + D u^2 \\right] $$\n$$ \\rho c_s^2 \\delta_{\\gamma\\delta} + \\rho u_{\\gamma} u_{\\delta} = \\rho \\left[ A c_s^2 \\delta_{\\gamma\\delta} + C u_{\\alpha} u_{\\beta} \\sum w_i e_{i\\gamma}e_{i\\delta}e_{i\\alpha}e_{i\\beta} + D u^2 c_s^2 \\delta_{\\gamma\\delta} \\right] $$\n使用四阶矩性质：\n$$ \\sum w_i e_{i\\gamma}e_{i\\delta}e_{i\\alpha}e_{i\\beta} = c_s^4(\\delta_{\\gamma\\delta}\\delta_{\\alpha\\beta} + \\delta_{\\gamma\\alpha}\\delta_{\\delta\\beta} + \\delta_{\\gamma\\beta}\\delta_{\\delta\\alpha}) $$\n该项变为 $C u_{\\alpha} u_{\\beta} c_s^4 (\\delta_{\\gamma\\delta}\\delta_{\\alpha\\beta} + \\delta_{\\gamma\\alpha}\\delta_{\\delta\\beta} + \\delta_{\\gamma\\beta}\\delta_{\\delta\\alpha}) = C c_s^4 (u^2 \\delta_{\\gamma\\delta} + 2 u_{\\gamma} u_{\\delta})$。\n代回：\n$$ c_s^2 \\delta_{\\gamma\\delta} + u_{\\gamma} u_{\\delta} = (A c_s^2 + D u^2 c_s^2) \\delta_{\\gamma\\delta} + C c_s^4 (u^2 \\delta_{\\gamma\\delta} + 2 u_{\\gamma} u_{\\delta}) $$\n$$ c_s^2 \\delta_{\\gamma\\delta} + u_{\\gamma} u_{\\delta} = (A c_s^2 + (D c_s^2 + C c_s^4)u^2) \\delta_{\\gamma\\delta} + (2 C c_s^4) u_{\\gamma} u_{\\delta} $$\n令 $u_{\\gamma}u_{\\delta}$ 的系数相等：\n$$ 1 = 2 C c_s^4 \\implies C = \\frac{1}{2c_s^4} $$\n从 $C c_s^2 + D = 0$，我们得到 $D = -C c_s^2 = -\\frac{1}{2c_s^2}$。\n将常数代回 $f_i^{eq}$ 的假设形式中：\n$$ f_{i}^{eq} = w_i \\rho \\left[ 1 + \\frac{\\mathbf{e}_i \\cdot \\mathbf{u}}{c_s^2} + \\frac{(\\mathbf{e}_i \\cdot \\mathbf{u})^2}{2c_s^4} - \\frac{u^2}{2c_s^2} \\right] $$\n这就是所求的离散平衡分布函数。当 $c_s^2 = 1/3$ 时：\n$$ f_{i}^{eq} = w_i \\rho \\left[ 1 + 3(\\mathbf{e}_i \\cdot \\mathbf{u}) + \\frac{9}{2}(\\mathbf{e}_i \\cdot \\mathbf{u})^2 - \\frac{3}{2}u^2 \\right] $$\n\n现在，我们针对给定的数值进行计算：$\\rho = 1.2$ 和 $\\mathbf{u} = (0.08, -0.03)$。\n首先，计算 $u^2 = |\\mathbf{u}|^2 = (0.08)^2 + (-0.03)^2 = 0.0064 + 0.0009 = 0.0073$。\n方括号中的项是 $S_i = 1 + 3(\\mathbf{e}_i \\cdot \\mathbf{u}) + 4.5(\\mathbf{e}_i \\cdot \\mathbf{u})^2 - 1.5(0.0073) = 0.98905 + 3(\\mathbf{e}_i \\cdot \\mathbf{u}) + 4.5(\\mathbf{e}_i \\cdot \\mathbf{u})^2$。\n\n我们计算每个方向 $i$ 的 $\\mathbf{e}_i \\cdot \\mathbf{u}$：\n$\\mathbf{e}_0 \\cdot \\mathbf{u} = 0.0$\n$\\mathbf{e}_1 \\cdot \\mathbf{u} = 0.08$\n$\\mathbf{e}_2 \\cdot \\mathbf{u} = -0.03$\n$\\mathbf{e}_3 \\cdot \\mathbf{u} = -0.08$\n$\\mathbf{e}_4 \\cdot \\mathbf{u} = 0.03$\n$\\mathbf{e}_5 \\cdot \\mathbf{u} = 0.08 - 0.03 = 0.05$\n$\\mathbf{e}_6 \\cdot \\mathbf{u} = -0.08 - 0.03 = -0.11$\n$\\mathbf{e}_7 \\cdot \\mathbf{u} = -0.08 + 0.03 = -0.05$\n$\\mathbf{e}_8 \\cdot \\mathbf{u} = 0.08 + 0.03 = 0.11$\n\n现在计算每个 $i$ 的 $f_i^{eq} = w_i \\rho S_i = 1.2 w_i S_i$：\n$i=0$: $\\mathbf{e}_0 \\cdot \\mathbf{u}=0$。$S_0 = 0.98905$。$f_0^{eq} = \\frac{4}{9} (1.2)(0.98905) \\approx 0.52749333$\n$i=1$: $\\mathbf{e}_1 \\cdot \\mathbf{u}=0.08$。$S_1 = 0.98905 + 3(0.08) + 4.5(0.08)^2 = 1.25785$。$f_1^{eq} = \\frac{1}{9}(1.2)(1.25785) \\approx 0.16771333$\n$i=2$: $\\mathbf{e}_2 \\cdot \\mathbf{u}=-0.03$。$S_2 = 0.98905 + 3(-0.03) + 4.5(-0.03)^2 = 0.9031$。$f_2^{eq} = \\frac{1}{9}(1.2)(0.9031) \\approx 0.12041333$\n$i=3$: $\\mathbf{e}_3 \\cdot \\mathbf{u}=-0.08$。$S_3 = 0.98905 + 3(-0.08) + 4.5(-0.08)^2 = 0.77785$。$f_3^{eq} = \\frac{1}{9}(1.2)(0.77785) \\approx 0.10371333$\n$i=4$: $\\mathbf{e}_4 \\cdot \\mathbf{u}=0.03$。$S_4 = 0.98905 + 3(0.03) + 4.5(0.03)^2 = 1.0831$。$f_4^{eq} = \\frac{1}{9}(1.2)(1.0831) \\approx 0.14441333$\n$i=5$: $\\mathbf{e}_5 \\cdot \\mathbf{u}=0.05$。$S_5 = 0.98905 + 3(0.05) + 4.5(0.05)^2 = 1.1503$。$f_5^{eq} = \\frac{1}{36}(1.2)(1.1503) \\approx 0.03834333$\n$i=6$: $\\mathbf{e}_6 \\cdot \\mathbf{u}=-0.11$。$S_6 = 0.98905 + 3(-0.11) + 4.5(-0.11)^2 = 0.7135$。$f_6^{eq} = \\frac{1}{36}(1.2)(0.7135) \\approx 0.02378333$\n$i=7$: $\\mathbf{e}_7 \\cdot \\mathbf{u}=-0.05$。$S_7 = 0.98905 + 3(-0.05) + 4.5(-0.05)^2 = 0.8503$。$f_7^{eq} = \\frac{1}{36}(1.2)(0.8503) \\approx 0.02834333$\n$i=8$: $\\mathbf{e}_8 \\cdot \\mathbf{u}=0.11$。$S_8 = 0.98905 + 3(0.11) + 4.5(0.11)^2 = 1.3735$。$f_8^{eq} = \\frac{1}{36}(1.2)(1.3735) \\approx 0.04578333$\n\n约束验证：\n零阶矩：$\\sum_i f_i^{eq} \\approx 0.527493 + 0.167713 + 0.120413 + 0.103713 + 0.144413 + 0.038343 + 0.023783 + 0.028343 + 0.045783 = 1.200000$。这与 $\\rho$ 相匹配。\n一阶矩（x-分量）：$\\sum_i f_i^{eq} e_{ix} = f_1 - f_3 + f_5 - f_6 - f_7 + f_8 \\approx 0.167713 - 0.103713 + 0.038343 - 0.023783 - 0.028343 + 0.045783 = 0.096$。这与 $\\rho u_x = 1.2 \\times 0.08 = 0.096$ 相匹配。\n一阶矩（y-分量）：$\\sum_i f_i^{eq} e_{iy} = f_2 - f_4 + f_5 + f_6 - f_7 - f_8 \\approx 0.120413 - 0.144413 + 0.038343 + 0.023783 - 0.028343 - 0.045783 = -0.036$。这与 $\\rho u_y = 1.2 \\times -0.03 = -0.036$ 相匹配。\n正定性条件：所有计算出的 $f_i^{eq}$ 值均为正。\n\n在计算出的平衡分布函数中，最小值为 $i=6$ 时的情况：\n$f_6^{eq} \\approx 0.02378333...$\n四舍五入到六位有效数字，该值为 $0.0237833$。",
            "answer": "$$\\boxed{0.0237833}$$"
        },
        {
            "introduction": "LBM算法的动力学演化由“碰撞”和“迁移”两个交替的步骤驱动。理解这两个步骤如何协同工作，对于掌握该方法的机理至关重要。本练习通过一个简单的初始条件，要求您手动执行一个完整的LBM时间步，从而直观地体验粒子布居在格子间弛豫和传播的过程，并验证该过程中的质量守恒 。",
            "id": "3774222",
            "problem": "考虑在二维九速(D2Q9)模型上，使用Bhatnagar-Gross-Krook (BGK)碰撞模型的格子玻尔兹曼方法(LBM)。离散粒子速度定义为 $\\,\\mathbf{e}_0=(0,0)$、$\\,\\mathbf{e}_1=(1,0)$、$\\,\\mathbf{e}_2=(0,1)$、$\\,\\mathbf{e}_3=(-1,0)$、$\\,\\mathbf{e}_4=(0,-1)$、$\\,\\mathbf{e}_5=(1,1)$、$\\,\\mathbf{e}_6=(-1,1)$、$\\,\\mathbf{e}_7=(-1,-1)$、$\\,\\mathbf{e}_8=(1,-1)$，格子速度设为1。离散权重为 $\\,w_0=\\frac{4}{9}$、$\\,w_1=w_2=w_3=w_4=\\frac{1}{9}$ 和 $\\,w_5=w_6=w_7=w_8=\\frac{1}{36}$，格子声速满足 $\\,c_s^2=\\frac{1}{3}$。BGK弛豫时间为 $\\,\\tau=\\frac{3}{2}$，平衡分布函数由标准的二阶展开式给出\n$$\nf_i^{\\mathrm{eq}}(\\rho,\\mathbf{u})=w_i\\,\\rho\\left[1+\\frac{\\mathbf{e}_i\\cdot\\mathbf{u}}{c_s^2}+\\frac{(\\mathbf{e}_i\\cdot\\mathbf{u})^2}{2\\,c_s^4}-\\frac{\\mathbf{u}\\cdot\\mathbf{u}}{2\\,c_s^2}\\right].\n$$\n在时间 $\\,t$，假设只有位置为 $\\,\\mathbf{x}=\\mathbf{0}$ 的中心节点具有非零分布，具体规定为\n$$\nf_0=\\frac{1}{3},\\quad f_1=f_2=f_3=f_4=\\frac{1}{6},\\quad f_5=f_6=f_7=f_8=\\frac{1}{12},\n$$\n并且 $\\,3\\times 3$ 模型中的所有其他节点均为零。使用带BGK碰撞的离散玻尔兹曼方程，\n$$\nf_i^{\\star}(\\mathbf{x},t)=f_i(\\mathbf{x},t)-\\frac{1}{\\tau}\\left[f_i(\\mathbf{x},t)-f_i^{\\mathrm{eq}}(\\rho(\\mathbf{x},t),\\mathbf{u}(\\mathbf{x},t))\\right],\n$$\n以及精确迁移步，\n$$\nf_i(\\mathbf{x}+\\mathbf{e}_i,t+\\Delta t)=f_i^{\\star}(\\mathbf{x},t),\n$$\n从给定的中心节点状态开始，执行一次碰撞和迁移步骤。计算到达 $\\,3\\times 3$ 模型中每个相邻节点的迁移后分布。\n\n将模型上的标量守恒缺陷定义为\n$$\nD=\\sum_{j=1}^{9}\\rho_{\\mathrm{after}}(\\mathbf{x}_j,t+\\Delta t)-\\sum_{j=1}^{9}\\rho_{\\mathrm{before}}(\\mathbf{x}_j,t),\n$$\n其中求和遍及以 $\\,\\mathbf{0}$ 为中心的 $\\,3\\times 3$ 模型，且 $\\,\\rho(\\mathbf{x},t)=\\sum_{i=0}^{8} f_i(\\mathbf{x},t)$ 是局部密度。根据以上步骤显式计算 $\\,D$。将最终答案表示为一个精确实数，无需四舍五入，不带单位。",
            "solution": "该问题在科学上是合理的、适定的，并且是LBM中的一个标准教学练习。下面是详细的求解步骤。\n\n**步骤 1：计算初始宏观量**\n在时刻 $t$，只有原点 $\\mathbf{x}=\\mathbf{0}$ 处有非零分布。我们首先计算该点的宏观密度和速度。\n- **密度** $\\rho(\\mathbf{0}, t)$:\n$$ \\rho = \\sum_{i=0}^{8} f_i = f_0 + 4 \\times f_1 + 4 \\times f_5 = \\frac{1}{3} + 4 \\left(\\frac{1}{6}\\right) + 4 \\left(\\frac{1}{12}\\right) = \\frac{1}{3} + \\frac{2}{3} + \\frac{1}{3} = \\frac{4}{3} $$\n- **动量** $\\rho\\mathbf{u}(\\mathbf{0}, t)$:\n$$ \\rho\\mathbf{u} = \\sum_{i=0}^{8} f_i \\mathbf{e}_i $$\n由于给定的分布函数 $f_i$ 对于相反的速度方向（例如，$f_1=f_3$, $f_2=f_4$, $f_5=f_7$, $f_6=f_8$）是对称的，动量的所有分量都相互抵消。例如，x-分量为：\n$$ (\\rho u)_x = \\sum_i f_i e_{ix} = f_1(1) + f_3(-1) + f_5(1) + f_6(-1) + f_7(-1) + f_8(1) = (f_1-f_3) + (f_5-f_6-f_7+f_8) = 0 $$\n因此，$\\mathbf{u}(\\mathbf{0}, t) = \\mathbf{0}$。\n初始时刻模型中的总质量为 $\\sum \\rho_{\\mathrm{before}} = \\rho(\\mathbf{0}, t) + \\sum_{\\mathbf{x}_j \\neq \\mathbf{0}} \\rho(\\mathbf{x}_j, t) = \\frac{4}{3} + 0 = \\frac{4}{3}$。\n\n**步骤 2：计算平衡分布函数**\n使用 $\\rho=4/3$ 和 $\\mathbf{u}=\\mathbf{0}$，平衡分布函数 $f_i^{\\mathrm{eq}}$ 简化为 $f_i^{\\mathrm{eq}} = w_i \\rho$。\n- $f_0^{\\mathrm{eq}} = w_0 \\rho = \\frac{4}{9} \\times \\frac{4}{3} = \\frac{16}{27}$\n- $f_{1,2,3,4}^{\\mathrm{eq}} = w_1 \\rho = \\frac{1}{9} \\times \\frac{4}{3} = \\frac{4}{27}$\n- $f_{5,6,7,8}^{\\mathrm{eq}} = w_5 \\rho = \\frac{1}{36} \\times \\frac{4}{3} = \\frac{4}{108} = \\frac{1}{27}$\n\n**步骤 3：计算碰撞后分布函数**\n使用BGK方程 $f_i^{\\star} = f_i - \\frac{1}{\\tau}(f_i - f_i^{\\mathrm{eq}})$，其中 $\\tau = 3/2$，所以 $1/\\tau = 2/3$。\n- $f_0^{\\star} = f_0 - \\frac{2}{3}(f_0 - f_0^{\\mathrm{eq}}) = \\frac{1}{3} - \\frac{2}{3}\\left(\\frac{1}{3} - \\frac{16}{27}\\right) = \\frac{1}{3} - \\frac{2}{3}\\left(\\frac{9-16}{27}\\right) = \\frac{1}{3} - \\frac{2}{3}\\left(-\\frac{7}{27}\\right) = \\frac{1}{3} + \\frac{14}{81} = \\frac{27+14}{81} = \\frac{41}{81}$\n- $f_{1-4}^{\\star} = f_1 - \\frac{2}{3}(f_1 - f_1^{\\mathrm{eq}}) = \\frac{1}{6} - \\frac{2}{3}\\left(\\frac{1}{6} - \\frac{4}{27}\\right) = \\frac{1}{6} - \\frac{2}{3}\\left(\\frac{9-8}{54}\\right) = \\frac{1}{6} - \\frac{2}{162} = \\frac{27-2}{162} = \\frac{25}{162}$\n- $f_{5-8}^{\\star} = f_5 - \\frac{2}{3}(f_5 - f_5^{\\mathrm{eq}}) = \\frac{1}{12} - \\frac{2}{3}\\left(\\frac{1}{12} - \\frac{1}{27}\\right) = \\frac{1}{12} - \\frac{2}{3}\\left(\\frac{9-4}{108}\\right) = \\frac{1}{12} - \\frac{10}{324} = \\frac{27-10}{324} = \\frac{17}{324}$\n\n**步骤 4：执行迁移步骤并计算迁移后的总质量**\n迁移步骤将碰撞后的分布函数 $f_i^{\\star}(\\mathbf{0}, t)$ 移动到相邻节点，即 $f_i(\\mathbf{x}+\\mathbf{e}_i, t+1) = f_i^{\\star}(\\mathbf{x}, t)$。\n这意味着在 $t+1$ 时刻，位于节点 $\\mathbf{x}_j=\\mathbf{e}_j$ 的新密度 $\\rho(\\mathbf{x}_j, t+1)$ 是所有从原点迁移到该节点的分布函数的总和。在本例中，到达节点 $\\mathbf{x}_j$ 的唯一非零分布函数是 $f_j^{\\star}(\\mathbf{0}, t)$。因此，新密度为：\n- $\\rho(\\mathbf{e}_0, t+1) = \\rho(\\mathbf{0}, t+1) = f_0^{\\star}(\\mathbf{0}, t) = \\frac{41}{81}$\n- $\\rho(\\mathbf{e}_{1,2,3,4}, t+1) = f_{1,2,3,4}^{\\star}(\\mathbf{0}, t) = \\frac{25}{162}$\n- $\\rho(\\mathbf{e}_{5,6,7,8}, t+1) = f_{5,6,7,8}^{\\star}(\\mathbf{0}, t) = \\frac{17}{324}$\n模型在迁移后（“after”）的总质量为所有节点密度的总和：\n$$ \\sum \\rho_{\\mathrm{after}} = \\rho(\\mathbf{e}_0, t+1) + \\sum_{j=1}^{4}\\rho(\\mathbf{e}_j, t+1) + \\sum_{j=5}^{8}\\rho(\\mathbf{e}_j, t+1) $$\n这等价于对所有碰撞后的分布函数求和：\n$$ \\sum \\rho_{\\mathrm{after}} = \\sum_{i=0}^{8} f_i^{\\star} = f_0^{\\star} + 4 \\times f_1^{\\star} + 4 \\times f_5^{\\star} = \\frac{41}{81} + 4 \\left(\\frac{25}{162}\\right) + 4 \\left(\\frac{17}{324}\\right) $$\n$$ = \\frac{41}{81} + \\frac{100}{162} + \\frac{68}{324} = \\frac{164}{324} + \\frac{200}{324} + \\frac{68}{324} = \\frac{164+200+68}{324} = \\frac{432}{324} $$\n将分子分母同时除以108，我们得到：\n$$ \\sum \\rho_{\\mathrm{after}} = \\frac{4 \\times 108}{3 \\times 108} = \\frac{4}{3} $$\n\n**步骤 5：计算质量守恒缺陷**\n质量守恒缺陷 $D$ 是迁移后总质量与初始总质量之差。\n$$ D = \\sum \\rho_{\\mathrm{after}} - \\sum \\rho_{\\mathrm{before}} = \\frac{4}{3} - \\frac{4}{3} = 0 $$\n这表明LBM的碰撞-迁移步骤是精确质量守恒的。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "LBM算法虽然简洁，但并非无条件稳定；弛豫时间 $\\tau$ 的选择对避免数值发散至关重要。通过线性稳定性分析，我们可以确定LBM参数的有效范围，这是评估和设计可靠模拟的关键一步。本练习将引导您通过傅里叶分析，推导BGK-LBM格式的稳定性条件，揭示其数值特性，并探讨高波数下各向异性的来源 。",
            "id": "3774251",
            "problem": "考虑用于等温流体的单弛豫时间 Bhatnagar–Gross–Krook (BGK) 格子玻尔兹曼方法 (LBM)，该方法在二维九速 (D2Q9) 格子上离散化。离散速度为 $\\,\\mathbf{c}_{0} = (0,0)\\,$、$\\,\\mathbf{c}_{1,2,3,4} = (\\pm 1,0)$ 和 $(0,\\pm 1)\\,$，以及 $\\,\\mathbf{c}_{5,6,7,8} = (\\pm 1,\\pm 1)\\,$，采用格子单位，其中 $\\,\\Delta x = 1\\,$ 和 $\\,\\Delta t = 1\\,$。求积权重为 $\\,w_{0} = \\frac{4}{9}\\,$、$\\,w_{1,2,3,4} = \\frac{1}{9}\\,$ 和 $\\,w_{5,6,7,8} = \\frac{1}{36}\\,$，格子声速满足 $\\,c_{s}^{2} = \\frac{1}{3}\\,$。粒子布居 $\\,f_{i}(\\mathbf{x},t)\\,$ 的 BGK 碰撞-迁移更新为\n$$\nf_{i}(\\mathbf{x}+\\mathbf{c}_{i}\\Delta t, t+\\Delta t) \\;=\\; f_{i}(\\mathbf{x},t) \\;-\\; \\omega \\Big(f_{i}(\\mathbf{x},t)-f_{i}^{\\mathrm{eq}}(\\rho(\\mathbf{x},t),\\mathbf{u}(\\mathbf{x},t))\\Big),\n$$\n其中 $\\,\\omega = \\Delta t/\\tau\\,$，$\\,\\tau\\,$ 是弛豫时间，$\\,f_{i}^{\\mathrm{eq}}(\\rho,\\mathbf{u})\\,$ 是与质量和动量守恒一致的标准二阶等温平衡态：\n$$\nf_{i}^{\\mathrm{eq}}(\\rho,\\mathbf{u}) \\;=\\; w_{i}\\,\\rho \\left( 1 + \\frac{\\mathbf{c}_{i}\\cdot\\mathbf{u}}{c_{s}^{2}} + \\frac{(\\mathbf{c}_{i}\\cdot\\mathbf{u})^{2}}{2\\,c_{s}^{4}} - \\frac{\\mathbf{u}\\cdot\\mathbf{u}}{2\\,c_{s}^{2}} \\right).\n$$\n\n围绕空间均匀的静止状态（$\\,\\rho(\\mathbf{x},t) = \\rho_{0}\\,$ 和 $\\,\\mathbf{u}(\\mathbf{x},t) = \\mathbf{0}\\,$）对该格式进行线性化。令 $\\,\\widehat{f}_{i}(\\mathbf{k},t)\\,$ 表示微扰的空间傅里叶变换。通过 $\\,\\widehat{\\mathbf{f}}(t+\\Delta t) = \\mathcal{M}(\\mathbf{k})\\,\\widehat{\\mathbf{f}}(t)\\,$ 定义单步放大算子 $\\,\\mathcal{M}(\\mathbf{k})\\,$，其中 $\\,\\widehat{\\mathbf{f}} = (\\widehat{f}_{0},\\ldots,\\widehat{f}_{8})^{\\top}\\,$，并令 $\\,G(\\mathbf{k})\\,$ 表示 $\\,\\mathcal{M}(\\mathbf{k})\\,$ 的一个通用特征值。仅从碰撞-迁移的定义和守恒要求出发，推导弛豫时间 $\\,\\tau\\,$ 需满足的条件，使得对所有波数 $\\,\\mathbf{k}\\,$，都有 $\\,|G(\\mathbf{k})| \\le 1\\,$。\n\n此外，分析小 $\\,|\\mathbf{k}|\\,$ 时剪切（横向）微扰的主阶阻尼，并利用有效扩散算子的离散傅里叶符号，解释当 $\\,|\\mathbf{k}|\\,$ 趋近于格子奈奎斯特极限时，格子各向异性如何体现在阻尼率对 $\\,\\mathbf{k}\\,$ 方向的依赖关系中。您的讨论应指明傅里叶符号中的哪些项在低 $\\,|\\mathbf{k}|\\,$ 时编码了各向同性，哪些项在较高 $\\,|\\mathbf{k}|\\,$ 时产生各向异性。\n\n作答要求：\n- 根据谱条件 $\\,|G(\\mathbf{k})| \\le 1\\,$ 确定 $\\,\\tau\\,$ 的允许范围，然后报告最小允许值 $\\,\\tau_{\\min}\\,$。\n- 以格子时间单位表示 $\\,\\tau_{\\min}\\,$。\n- 无需四舍五入。",
            "solution": "所述问题在科学上是合理的、适定的、客观的，并包含了解决该问题所需的所有必要信息。它代表了对格子玻尔兹曼方法的一次标准稳定性和一致性分析。因此，我们可以进行完整解答。\n\n该问题要求进行两项主要分析：首先，进行线性稳定性分析以确定弛豫时间 $\\tau$ 的允许范围；其次，分析剪切波阻尼的各向异性。\n\n第一部分：线性稳定性分析\n\n单弛豫时间格子玻尔兹曼方程如下：\n$$\nf_{i}(\\mathbf{x}+\\mathbf{c}_{i}\\Delta t, t+\\Delta t) = f_{i}(\\mathbf{x},t) - \\frac{\\Delta t}{\\tau} \\left(f_{i}(\\mathbf{x},t)-f_{i}^{\\mathrm{eq}}(\\rho(\\mathbf{x},t),\\mathbf{u}(\\mathbf{x},t))\\right)\n$$\n在问题中，给定 $\\Delta t=1$，因此弛豫参数为 $\\omega = 1/\\tau$。方程变为：\n$$\nf_{i}(\\mathbf{x}+\\mathbf{c}_{i}, t+1) = f_{i}(\\mathbf{x},t) - \\omega \\left(f_{i}(\\mathbf{x},t)-f_{i}^{\\mathrm{eq}}(\\rho,\\mathbf{u})\\right)\n$$\n我们围绕静止状态 $\\rho = \\rho_{0}$ 和 $\\mathbf{u} = \\mathbf{0}$ 对此方程进行线性化。平衡态为 $f_i^{\\mathrm{eq}}(\\rho_0, \\mathbf{0}) = w_i \\rho_0$。令微扰为 $\\delta f_i(\\mathbf{x},t) = f_i(\\mathbf{x},t) - w_i \\rho_0$。宏观微扰为 $\\delta\\rho = \\sum_i \\delta f_i$ 和 $\\rho_0 \\delta\\mathbf{u} = \\sum_i \\mathbf{c}_i \\delta f_i$。\n\n微扰的线性化玻尔兹曼方程为：\n$$\n\\delta f_i(\\mathbf{x}+\\mathbf{c}_i, t+1) = \\delta f_i(\\mathbf{x},t) - \\omega (\\delta f_i(\\mathbf{x},t) - \\delta f_i^{\\mathrm{eq}}(\\mathbf{x},t))\n$$\n其中 $\\delta f_i^{\\mathrm{eq}}$ 是平衡分布的微扰。对 $f_i^{\\mathrm{eq}}$ 在小的 $\\delta\\rho$ 和 $\\delta\\mathbf{u}$ 处进行泰勒展开：\n$$\n\\delta f_i^{\\mathrm{eq}} = f_i^{\\mathrm{eq}}(\\rho_0+\\delta\\rho, \\delta\\mathbf{u}) - f_i^{\\mathrm{eq}}(\\rho_0, \\mathbf{0}) \\approx \\frac{\\partial f_i^{\\mathrm{eq}}}{\\partial\\rho}\\bigg|_{\\rho_0, \\mathbf{0}} \\delta\\rho + \\nabla_{\\mathbf{u}}f_i^{\\mathrm{eq}}\\bigg|_{\\rho_0, \\mathbf{0}} \\cdot \\delta\\mathbf{u}\n$$\n导数为：\n$$\n\\frac{\\partial f_i^{\\mathrm{eq}}}{\\partial\\rho} = w_i \\left( 1 + \\frac{\\mathbf{c}_{i}\\cdot\\mathbf{u}}{c_{s}^{2}} + \\frac{(\\mathbf{c}_{i}\\cdot\\mathbf{u})^{2}}{2c_{s}^{4}} - \\frac{\\mathbf{u}\\cdot\\mathbf{u}}{2c_{s}^{2}} \\right) \\quad \\xrightarrow{(\\rho_0,\\mathbf{0})} \\quad w_i\n$$\n$$\n\\nabla_{\\mathbf{u}}f_i^{\\mathrm{eq}} = w_i \\rho \\left( \\frac{\\mathbf{c}_i}{c_s^2} + \\frac{\\mathbf{c}_i(\\mathbf{c}_i\\cdot\\mathbf{u})}{c_s^4} - \\frac{\\mathbf{u}}{c_s^2} \\right) \\quad \\xrightarrow{(\\rho_0,\\mathbf{0})} \\quad \\frac{w_i\\rho_0}{c_s^2}\\mathbf{c}_i\n$$\n因此，线性化的平衡态为：\n$$\n\\delta f_i^{\\mathrm{eq}} = w_i \\delta\\rho + \\frac{w_i \\rho_0}{c_s^2} \\mathbf{c}_i \\cdot \\delta\\mathbf{u} = w_i \\sum_j \\delta f_j + \\frac{w_i}{c_s^2} \\mathbf{c}_i \\cdot \\sum_j \\mathbf{c}_j \\delta f_j\n$$\n我们可以将其写为 $\\delta f_i^{\\mathrm{eq}} = \\sum_j L_{ij} \\delta f_j$，其中 $L_{ij} = w_i(1 + (\\mathbf{c}_i \\cdot \\mathbf{c}_j)/c_s^2)$ 是线性化碰撞算子在流体动力学子空间上的投影。\n\n我们现在对线性化的 LBE 应用空间傅里叶变换 $\\delta f_i(\\mathbf{x},t) = \\widehat{\\delta f_i}(\\mathbf{k},t)\\exp(i\\mathbf{k}\\cdot\\mathbf{x})$：\n$$\n\\widehat{\\delta f_i}(\\mathbf{k}, t+1)\\exp(i\\mathbf{k}\\cdot\\mathbf{c}_i) = \\widehat{\\delta f_i}(\\mathbf{k},t) - \\omega (\\widehat{\\delta f_i}(\\mathbf{k},t) - \\widehat{\\delta f_i^{\\mathrm{eq}}}(\\mathbf{k},t))\n$$\n将其表示为向量形式 $\\widehat{\\mathbf{f}}(t) = (\\widehat{\\delta f_0}(t), \\ldots, \\widehat{\\delta f_8}(t))^\\top$，我们得到 $\\widehat{\\mathbf{f}}(t+1) = \\mathcal{M}(\\mathbf{k}) \\widehat{\\mathbf{f}}(t)$，其中 $\\mathcal{M}(\\mathbf{k})$ 是放大矩阵。其分量为：\n$$\n\\mathcal{M}_{ij}(\\mathbf{k}) = \\exp(-i\\mathbf{k}\\cdot\\mathbf{c}_i) \\left( (1-\\omega)\\delta_{ij} + \\omega L_{ij} \\right)\n$$\n稳定性条件是，对所有波矢 $\\mathbf{k}$，$\\mathcal{M}(\\mathbf{k})$ 的所有特征值 $G(\\mathbf{k})$ 都必须满足 $|G(\\mathbf{k})| \\le 1$。\n该矩阵可以写为 $\\mathcal{M} = \\mathbf{S} \\mathbf{C}$，其中 $\\mathbf{S}$ 是由迁移因子 $S_{ii} = \\exp(-i\\mathbf{k}\\cdot\\mathbf{c}_i)$ 构成的对角矩阵，而 $\\mathbf{C} = (1-\\omega)\\mathbf{I} + \\omega \\mathbf{L}$ 是碰撞矩阵。$\\mathbf{C}$ 的特征值对于3个流体动力学模式是1，对于6个动理学模式是 $1-\\omega$。\n特征值分析表明，有两个独立的模式集：\n1. 动理学模式：这些模式不受碰撞不变量的约束。它们的特征值是 $G_k = (1-\\omega)\\exp(-i\\mathbf{k}\\cdot\\mathbf{c}_i)$。为了保证稳定性，我们需要 $|G_k| \\le 1$，这得到 $|1-\\omega| \\le 1$。这意味着 $-1 \\le 1-\\omega \\le 1$，即 $0 \\le \\omega \\le 2$。由于 $\\tau$ 必须为正，我们有 $\\omega > 0$。所以，$0  \\omega \\le 2$。\n2. 流体动力学模式：这些是与守恒量相关的模式。它们的稳定性分析更为复杂，通常在布里渊区的边界处（奈奎斯特极限）给出最严格的约束。对D2Q9模型，最坏的情况发生在 $\\mathbf{k}=(\\pi, \\pi)$。分析表明，流体动力学模式的稳定性也要求 $0  \\omega \\le 2$。\n\n综合这些分析，为了保证 BGK 格式的线性稳定性，弛豫频率必须满足 $0  \\omega \\le 2$。\n由于 $\\omega = \\Delta t/\\tau = 1/\\tau$，这意味着 $1/\\tau \\le 2$，即 $\\tau \\ge 1/2$。\n因此，弛豫时间的最小允许值为 $\\tau_{\\min} = 1/2$（以格子时间单位计，因为 $\\Delta t=1$）。\n\n第二部分：剪切波阻尼与各向异性\n\n流体动力学模式的阻尼与输运系数有关。对于剪切（横向）波，阻尼由运动粘度 $\\nu$ 控制。对 LBE 进行 Chapman-Enskog 展开表明，对于小波数 $|\\mathbf{k}|$，该格式再现了不可压缩的 Navier-Stokes 方程，剪切模式的主阶阻尼率为 $\\Gamma(\\mathbf{k}) = -\\nu |\\mathbf{k}|^2$。BGK 模型的运动粘度由下式给出：\n$$\n\\nu = c_s^2 \\left( \\tau - \\frac{\\Delta t}{2} \\right) = \\frac{1}{3} \\left( \\frac{1}{\\omega} - \\frac{1}{2} \\right)\n$$\n- **各向同性来源**：主阶阻尼是各向同性的，这意味着它只依赖于 $|\\mathbf{k}|$ 的大小，而与其方向无关。在傅里叶空间中，有效扩散算子的符号在主阶上是 $-\\nu(k_x^2+k_y^2)$，这是旋转不变的。在低 $|\\mathbf{k}|$ 时的这种各向同性是 D2Q9 格子性质的结果，特别是其四阶矩张量 $T_{\\alpha\\beta\\gamma\\delta}^{(4)} = \\sum_i w_i c_{i\\alpha}c_{i\\beta}c_{i\\gamma}c_{i\\delta}$ 是各向同性的这一事实，它能够正确地恢复纳维-斯托克斯方程中的各向同性粘性项。傅里叶符号中编码各向同性的项是 $k_x^2+k_y^2=|\\mathbf{k}|^2$。\n\n- **各向异性来源**：各向异性出现在波数的更高阶项中，即当 $|\\mathbf{k}|$ 趋近奈奎斯特极限时。这是一种格子人为效应，源于迁移步 $f_i(\\mathbf{x},t) \\to f_i(\\mathbf{x}-\\mathbf{c}_i\\Delta t, t)$ 的离散性。在傅里叶空间中，这一步对应于乘以相位因子 $\\exp(-i\\mathbf{k}\\cdot\\mathbf{c}_i\\Delta t)$。剪切模式的有效扩散算子的完整傅里叶符号 $\\hat{\\mathcal{D}}_{\\text{eff}}(\\mathbf{k})$ 不是 $|\\mathbf{k}|^2$ 的简单函数。相反，它以一种尊重方形格子的离散 $C_{4v}$ 对称性，但不尊重完全 $O(2)$ 旋转对称性的方式，依赖于 $\\mathbf{k}$ 的方向。\n要看是哪些项产生了各向异性，可以将 $\\hat{\\mathcal{D}}_{\\text{eff}}(\\mathbf{k})$ 按 $\\mathbf{k}$ 的幂次进行高阶泰勒展开：\n$$\n\\hat{\\mathcal{D}}_{\\text{eff}}(\\mathbf{k}) = -\\nu |\\mathbf{k}|^2 + \\left[ C_1 |\\mathbf{k}|^4 + C_2 (k_x^4+k_y^4-\\alpha |\\mathbf{k}|^4) \\right] + O(|\\mathbf{k}|^6)\n$$\n$|\\mathbf{k}|^4$ 项是各向同性的。产生各向异性的项是那些不能被写成 $|\\mathbf{k}|$ 的函数的项，例如 $k_x^4+k_y^4$。对于一个固定的 $|\\mathbf{k}|=k$，当 $\\mathbf{k}=(k,0)$ 时 $k_x^4+k_y^4$ 等于 $k^4$，但当 $\\mathbf{k}=(k/\\sqrt{2}, k/\\sqrt{2})$ 时它等于 $k^4/2$。这个破坏了完全旋转对称性的项之所以出现，是因为 D2Q9 格子的六阶矩张量 $T^{(6)}$ 不是各向同性的。\n\n总而言之，四阶矩张量的各向同性确保了在低波数下的各向同性阻尼，而六阶（及更高阶）矩张量的各向异性，与离散迁移算子相结合，在较高波数下引入了与方向相关的阻尼项，从而导致格子各向异性。\n\n$\\tau$ 的最小允许值为 $\\tau_{\\min} = 1/2$。",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        }
    ]
}