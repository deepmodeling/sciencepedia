{
    "hands_on_practices": [
        {
            "introduction": "The Lattice Boltzmann Method (LBM) provides a powerful mesoscopic framework, but its ultimate value lies in its ability to accurately reproduce macroscopic fluid dynamics. A critical step in bridging these scales is to establish a clear relationship between the model's microscopic parameters and the physical properties of the fluid it represents. This practice guides you through the foundational Chapman-Enskog expansion, a multiscale analysis technique used to derive the link between the LBM's relaxation time, $\\tau$, and the fluid's kinematic viscosity, $\\nu$. By completing this derivation , you will not only obtain the essential formula for setting up physically meaningful simulations but also uncover the fundamental stability constraint, $\\tau \\gt 0.5$, that governs the BGK collision operator.",
            "id": "3971752",
            "problem": "Consider the single-relaxation-time Bhatnagar–Gross–Krook (BGK) Lattice Boltzmann Method (LBM) applied to incompressible flow on the three-dimensional, nineteen-velocity discrete set $D3Q19$ used in aerospace Computational Fluid Dynamics (CFD). The discrete velocities are constructed so that streaming advances populations by one lattice spacing per time step along each discrete direction, and the second-order isotropy of the equilibrium ensures a lattice sound speed squared $c_{s}^{2}$ consistent with the $D3Q19$ quadrature. You are given a physical kinematic viscosity $ \\nu_{phys} $ (with units of $L^{2}/T$), a lattice spacing $ \\Delta x $ (with units of $L$), and a time step $ \\Delta t $ (with units of $T$). \n\nStarting from the kinetic transport equation with a BGK collision operator, the definition of macroscopic moments, and the Newtonian constitutive relation for viscous stress, perform a Chapman–Enskog expansion to recover the Navier–Stokes equations in the hydrodynamic limit for the $D3Q19$ lattice. From this derivation, obtain the analytic expression for the relaxation time $ \\tau $ required for the discrete model to reproduce the target physical viscosity $ \\nu_{phys} $ on the given lattice characterized by $ \\Delta x $ and $ \\Delta t $. Use the $D3Q19$ value $ c_{s}^{2} = 1/3 $. Present your final answer as a single closed-form expression for $ \\tau $.\n\nAdditionally, based on the same derivation, identify the leading numerical constraints on $ \\tau $, $ \\Delta x $, and $ \\Delta t $ that ensure the method remains dissipative and accurate in the low-Mach-number limit. Your commentary on constraints must be supported by the scaling that emerges from the hydrodynamic limit, but the final reported answer must remain the single expression for $ \\tau $. No numerical substitution is required. Express the final answer without units.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard, non-trivial derivation in the field of computational fluid dynamics, specifically concerning the Lattice Boltzmann Method (LBM). All premises are factually correct and all required information is provided.\n\nThe objective is to derive the relationship between the single relaxation time $\\tau$ of the Bhatnagar–Gross–Krook (BGK) model and the physical kinematic viscosity $\\nu_{phys}$ for a $D3Q19$ lattice. This is achieved by recovering the macroscopic Navier–Stokes equations from the discrete lattice Boltzmann equation via a Chapman–Enskog expansion.\n\nWe begin with the discrete lattice Boltzmann equation (LBE) with the BGK collision operator. For clarity, we will first perform the derivation in lattice units, where the lattice spacing $\\Delta x = 1$ and the time step $\\Delta t = 1$. The discrete particle velocities are then denoted by $\\mathbf{e}_i$, and the speed of light on the lattice is $c=1$. The LBE is:\n$$ f_i(\\mathbf{x} + \\mathbf{e}_i, t+1) - f_i(\\mathbf{x}, t) = -\\frac{1}{\\tau} [f_i(\\mathbf{x}, t) - f_i^{eq}(\\mathbf{x}, t)] $$\nwhere $f_i$ is the particle distribution function along the $i$-th direction, $\\mathbf{x}$ and $t$ are lattice coordinates and time, and $\\tau$ is the dimensionless relaxation time. The equilibrium distribution function, $f_i^{eq}$, for low-Mach-number flows is a second-order expansion in the macroscopic velocity $\\mathbf{u}$:\n$$ f_i^{eq} = w_i \\rho \\left( 1 + \\frac{\\mathbf{e}_i \\cdot \\mathbf{u}}{c_s^2} + \\frac{(\\mathbf{e}_i \\cdot \\mathbf{u})^2}{2c_s^4} - \\frac{\\mathbf{u}^2}{2c_s^2} \\right) $$\nHere, $w_i$ are the $D3Q19$ lattice weights, $\\rho$ is the macroscopic density, and $c_s$ is the lattice speed of sound, given as $c_s^2 = 1/3$. The macroscopic density and momentum are moments of the distribution functions:\n$$ \\rho = \\sum_i f_i = \\sum_i f_i^{eq} $$\n$$ \\rho \\mathbf{u} = \\sum_i f_i \\mathbf{e}_i = \\sum_i f_i^{eq} $$\nThe BGK collision operator conserves mass and momentum, which implies $\\sum_i (f_i - f_i^{eq}) = 0$ and $\\sum_i \\mathbf{e}_i (f_i - f_i^{eq}) = 0$.\n\nTo recover the macroscopic equations, we perform a Chapman–Enskog expansion. We introduce a small parameter $\\epsilon$ (proportional to the Knudsen and Mach numbers) and assume that the distribution function and the time and space derivatives can be expanded in multiple scales:\n- $f_i = f_i^{(0)} + \\epsilon f_i^{(1)} + \\epsilon^2 f_i^{(2)} + \\mathcal{O}(\\epsilon^3)$\n- $\\partial_t = \\epsilon \\partial_{t_1} + \\epsilon^2 \\partial_{t_2}$\n- $\\nabla = \\epsilon \\nabla_1$\n\nWe first Taylor-expand the discrete LBE in the time step (which is $1$ in lattice units):\n$$ (\\partial_t + \\mathbf{e}_i \\cdot \\nabla)f_i + \\frac{1}{2}(\\partial_t + \\mathbf{e}_i \\cdot \\nabla)^2 f_i + \\mathcal{O}(\\Delta t^3) = -\\frac{1}{\\tau}(f_i - f_i^{eq}) $$\nBy convention of the Chapman-Enskog procedure, we enforce that the macroscopic variables are fully captured by the equilibrium distribution, meaning $f_i^{(0)} = f_i^{eq}$ and the non-equilibrium parts have zero contribution to mass and momentum: $\\sum_i f_i^{(k)}=0$ and $\\sum_i \\mathbf{e}_i f_i^{(k)}=0$ for $k \\ge 1$.\n\nSubstituting the multi-scale expansions into the Taylor-expanded LBE and collecting terms by powers of $\\epsilon$:\n\nOrder $\\epsilon^1$:\n$$ (\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1) f_i^{(0)} = -\\frac{1}{\\tau} f_i^{(1)} $$\nThis gives an expression for the first-order non-equilibrium distribution:\n$$ f_i^{(1)} = -\\tau (\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha}) f_i^{(0)} $$\n\nOrder $\\epsilon^2$:\n$$ \\partial_{t_2} f_i^{(0)} + (\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1) f_i^{(1)} + \\frac{1}{2}(\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1)^2 f_i^{(0)} = -\\frac{1}{\\tau} f_i^{(2)} $$\nSubstituting the expression for $f_i^{(1)}$ into the second term:\n$$ \\partial_{t_2} f_i^{(0)} - \\tau (\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1)^2 f_i^{(0)} + \\frac{1}{2}(\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1)^2 f_i^{(0)} = -\\frac{1}{\\tau} f_i^{(2)} $$\nThis simplifies to:\n$$ \\partial_{t_2} f_i^{(0)} - \\left(\\tau - \\frac{1}{2}\\right) (\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha})^2 f_i^{(0)} = -\\frac{1}{\\tau} f_i^{(2)} $$\nNow, we take moments of these scaled equations to find the macroscopic governing equations. Taking moments of the $\\mathcal{O}(\\epsilon^1)$ equation yields the compressible Euler equations (mass and momentum conservation at the first time scale). The momentum equation at this scale is:\n$$ \\partial_{t_1}(\\rho u_\\beta) + \\partial_{1\\alpha} \\Pi_{\\alpha\\beta}^{(0)} = 0 $$\nwhere $\\Pi_{\\alpha\\beta}^{(0)} = \\sum_i e_{i\\alpha}e_{i\\beta} f_i^{(0)} = \\rho u_\\alpha u_\\beta + p \\delta_{\\alpha\\beta}$ is the equilibrium momentum flux tensor, and pressure $p = \\rho c_s^2$.\n\nTo find the viscous term, we take the first moment (multiply by $e_{i\\beta}$ and sum over $i$) of the $\\mathcal{O}(\\epsilon^2)$ equation. The term $\\sum_i e_{i\\beta} f_i^{(2)}$ on the right-hand side is zero due to the conservation constraint.\n$$ \\sum_i e_{i\\beta} \\left[ \\partial_{t_2} f_i^{(0)} - \\left(\\tau - \\frac{1}{2}\\right) (\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha})^2 f_i^{(0)} \\right] = 0 $$\n$$ \\partial_{t_2}(\\rho u_\\beta) - \\left(\\tau - \\frac{1}{2}\\right) \\sum_i e_{i\\beta} (\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha})^2 f_i^{(0)} = 0 $$\nThe second term contains the viscous contribution. In the low-Mach-number limit, time derivatives are of higher order in Mach number than spatial derivatives, so we approximate $(\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha})^2 \\approx (e_{i\\alpha} \\partial_{1\\alpha})^2$. The term becomes:\n$$ \\partial_{1\\gamma} \\partial_{1\\delta} \\sum_i e_{i\\beta} e_{i\\gamma} e_{i\\delta} f_i^{(0)} $$\nThis is a derivative of the third-order moment of the equilibrium distribution. For low Mach numbers, $\\sum_i e_{i\\beta} e_{i\\gamma} e_{i\\delta} f_i^{(0)} \\approx \\rho c_s^2 (u_\\beta \\delta_{\\gamma\\delta} + u_\\gamma \\delta_{\\beta\\delta} + u_\\delta \\delta_{\\beta\\gamma})$.\nApplying the derivatives and assuming an incompressible fluid ($\\nabla \\cdot \\mathbf{u} = 0$), this term evaluates to $\\rho c_s^2 \\nabla_1^2 u_\\beta$. The momentum equation at the $\\mathcal{O}(\\epsilon^2)$ scale is then:\n$$ \\partial_{t_2}(\\rho u_\\beta) = \\left(\\tau - \\frac{1}{2}\\right) \\rho c_s^2 \\nabla_1^2 u_\\beta $$\nCombining the momentum equations from scales $\\epsilon^1$ and $\\epsilon^2$ and reverting to physical-scale derivatives ($\\partial_t, \\nabla$):\n$$ \\partial_t(\\rho u_\\beta) + \\partial_\\alpha(\\rho u_\\alpha u_\\beta) = -\\partial_\\beta p + \\rho c_s^2 \\left(\\tau - \\frac{1}{2}\\right) \\nabla^2 u_\\beta $$\nThis is the incompressible Navier–Stokes equation:\n$$ \\rho(\\partial_t u_\\beta + u_\\alpha \\partial_\\alpha u_\\beta) = -\\partial_\\beta p + \\mu \\nabla^2 u_\\beta $$\nwhere $\\mu$ is the dynamic viscosity. Dividing by $\\rho$ gives the equation in terms of kinematic viscosity $\\nu = \\mu/\\rho$:\n$$ \\partial_t u_\\beta + u_\\alpha \\partial_\\alpha u_\\beta = -\\frac{1}{\\rho}\\partial_\\beta p + \\nu \\nabla^2 u_\\beta $$\nBy comparing the viscous terms, we identify the kinematic viscosity in lattice units:\n$$ \\nu_{latt} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right) $$\nThis expression relates the dimensionless parameters of the lattice simulation. To find the physical viscosity $\\nu_{phys}$, we must introduce the physical lattice spacing $\\Delta x$ and time step $\\Delta t$. Kinematic viscosity has units of $[L^2/T]$. The conversion factor from lattice units to physical units is:\n$$ \\nu_{phys} = \\nu_{latt} \\frac{\\Delta x^2}{\\Delta t} $$\nSubstituting the expression for $\\nu_{latt}$ and the given value $c_s^2 = 1/3$:\n$$ \\nu_{phys} = \\frac{1}{3} \\left(\\tau - \\frac{1}{2}\\right) \\frac{\\Delta x^2}{\\Delta t} $$\nSolving this equation for the relaxation time $\\tau$ yields the desired expression:\n$$ 3 \\frac{\\nu_{phys} \\Delta t}{\\Delta x^2} = \\tau - \\frac{1}{2} $$\n$$ \\tau = 3 \\frac{\\nu_{phys} \\Delta t}{\\Delta x^2} + \\frac{1}{2} $$\n\nBased on this derivation, we can identify two critical constraints.\nFirst, for the method to be physically dissipative and numerically stable, the lattice viscosity must be positive, $\\nu_{latt} > 0$. Since $c_s^2 > 0$, this implies a fundamental constraint on the relaxation time:\n$$ \\tau > \\frac{1}{2} $$\nSecond, the Chapman-Enskog expansion is valid only in the hydrodynamic limit, where the mean free path is much smaller than characteristic flow lengths. In LBM, the mean free path is proportional to $\\nu_{latt} \\propto (\\tau - 1/2)$. A large value of $\\tau$ implies a departure from this limit, leading to inaccuracies. Therefore, $\\tau$ must be kept on the order of unity, e.g., $\\tau < 2$. This imposes a constraint on the choice of grid parameters:\n$$ \\frac{\\nu_{phys} \\Delta t}{\\Delta x^2} = \\frac{1}{3}\\left(\\tau - \\frac{1}{2}\\right) = \\mathcal{O}(1) $$\nThis is the diffusive scaling of LBM, which requires that as the grid is refined ($\\Delta x \\to 0$), the time step must be decreased quadratically ($\\Delta t \\propto \\Delta x^2$) to maintain a constant $\\tau$. This must be balanced with the advective scaling constraint, $\\Delta t \\propto \\Delta x$, required to keep the Mach number low and control compressibility errors.",
            "answer": "$$\\boxed{\\tau = 3 \\frac{\\nu_{phys} \\Delta t}{\\Delta x^2} + \\frac{1}{2}}$$"
        },
        {
            "introduction": "The accuracy and fidelity of an LBM simulation are deeply influenced by the choice of the discrete velocity set, or \"lattice.\" While the Navier-Stokes equations are isotropic, meaning fluid properties are independent of direction, their discrete LBM approximations can introduce directional-dependent errors. This exercise delves into the crucial concept of numerical dispersion—an artifact where the propagation speed of waves varies with their direction and wavelength relative to the computational grid. By deriving and comparing the acoustic wave dispersion relations for the D2Q5 and D2Q9 lattices , you will gain a quantitative understanding of isotropy and see precisely why the higher-order moments of the D2Q9 model make it a superior and standard choice for two-dimensional simulations.",
            "id": "3971726",
            "problem": "Consider the Lattice Boltzmann Method (LBM) in the context of Computational Fluid Dynamics (CFD) for isothermal flow on a two-dimensional, uniform square lattice of spacing $h$. Focus on the hydrodynamic limit where small-amplitude compressible perturbations evolve according to the linear acoustic wave equation. Assume the lattice speed is $c = h/\\Delta t$ and the macroscopic isothermal sound speed is $c_{s}$, determined by the discrete velocity set and its weights through the second-moment isotropy. Neglect viscous damping and any non-hydrodynamic mode contamination.\n\nAnalyze two discrete velocity sets:\n- The $D2Q5$ model with velocities $\\boldsymbol{c}_{0} = (0,0)$, $\\boldsymbol{c}_{1,3} = (\\pm c, 0)$, and $\\boldsymbol{c}_{2,4} = (0, \\pm c)$, and weights $w_{0} = 1/3$, $w_{1,2,3,4} = 1/6$.\n- The $D2Q9$ model with velocities $\\boldsymbol{c}_{0} = (0,0)$, $\\boldsymbol{c}_{1,3} = (\\pm c, 0)$, $\\boldsymbol{c}_{2,4} = (0, \\pm c)$, and $\\boldsymbol{c}_{5,6,7,8} = (\\pm c, \\pm c)$, and weights $w_{0} = 4/9$, $w_{1,2,3,4} = 1/9$, $w_{5,6,7,8} = 1/36$.\n\nStarting from the hydrodynamic limit of the Lattice Boltzmann equation and the linear acoustic wave equation, derive the discrete spatial operator symbol induced by each velocity set and obtain the plane wave dispersion relation. For a plane wave of the form $\\rho(\\boldsymbol{x}, t) = \\hat{\\rho}\\,\\exp\\!\\left(i(\\boldsymbol{k}\\cdot\\boldsymbol{x} - \\omega t)\\right)$ with wavevector $\\boldsymbol{k}$, define the principal direction as $\\boldsymbol{k}_{\\parallel} = (\\kappa, 0)$ and the diagonal direction as $\\boldsymbol{k}_{\\diag} = (\\kappa/\\sqrt{2}, \\kappa/\\sqrt{2})$, where $\\kappa = |\\boldsymbol{k}|$. In the small-wavenumber limit, expand the phase speed $v_{\\text{ph}} = \\omega/|\\boldsymbol{k}|$ for each direction and model up to and including terms of order $(\\kappa h)^{2}$.\n\nEvaluate the effect of the velocity set choice on numerical dispersion by computing the leading-order difference\n$$\\Delta \\equiv \\frac{v_{\\text{ph}}^{\\parallel} - v_{\\text{ph}}^{\\diag}}{c_{s}}\\Bigg|_{D2Q5} \\;-\\; \\frac{v_{\\text{ph}}^{\\parallel} - v_{\\text{ph}}^{\\diag}}{c_{s}}\\Bigg|_{D2Q9}$$\nas an explicit closed-form analytic expression in terms of $\\kappa$ and $h$, retaining terms up to order $(\\kappa h)^{2}$ and discarding higher-order contributions. Provide the final expression for $\\Delta$. No rounding is required, and no physical units should be included in the final expression.",
            "solution": "The user wants to evaluate the difference in numerical dispersion between the D2Q5 and D2Q9 Lattice Boltzmann Method (LBM) models for acoustic waves.\n\n### Step 1: Problem Validation\n\nThe problem is a standard theoretical analysis in the field of computational fluid dynamics, specifically concerning the numerical properties of the Lattice Boltzmann Method.\n\n*   **Extraction of Givens:**\n    *   System: Isothermal LBM, 2D uniform square lattice, spacing $h$.\n    *   Lattice speed: $c = h/\\Delta t$.\n    *   Macroscopic isothermal sound speed: $c_{s}$.\n    *   Limit: Linear acoustics, no viscous damping, no non-hydrodynamic modes.\n    *   D2Q5 model: Velocities $\\boldsymbol{c}_{0} = (0,0)$, $\\boldsymbol{c}_{1,3} = (\\pm c, 0)$, $\\boldsymbol{c}_{2,4} = (0, \\pm c)$; weights $w_{0} = 1/3$, $w_{1,2,3,4} = 1/6$.\n    *   D2Q9 model: Velocities $\\boldsymbol{c}_{0} = (0,0)$, $\\boldsymbol{c}_{1,3} = (\\pm c, 0)$, $\\boldsymbol{c}_{2,4} = (0, \\pm c)$, $\\boldsymbol{c}_{5,6,7,8} = (\\pm c, \\pm c)$; weights $w_{0} = 4/9$, $w_{1,2,3,4} = 1/9$, $w_{5,6,7,8} = 1/36$.\n    *   Analysis form: Plane wave $\\rho(\\boldsymbol{x}, t) = \\hat{\\rho}\\,\\exp(i(\\boldsymbol{k}\\cdot\\boldsymbol{x} - \\omega t))$.\n    *   Wave directions: Principal $\\boldsymbol{k}_{\\parallel} = (\\kappa, 0)$, Diagonal $\\boldsymbol{k}_{\\diag} = (\\kappa/\\sqrt{2}, \\kappa/\\sqrt{2})$, with $\\kappa = |\\boldsymbol{k}|$.\n    *   Task: Expand phase speed $v_{\\text{ph}} = \\omega/|\\boldsymbol{k}|$ up to order $(\\kappa h)^{2}$.\n    *   Target quantity: $\\Delta \\equiv \\frac{v_{\\text{ph}}^{\\parallel} - v_{\\text{ph}}^{\\diag}}{c_{s}}\\Bigg|_{D2Q5} \\;-\\; \\frac{v_{\\text{ph}}^{\\parallel} - v_{\\text{ph}}^{\\diag}}{c_{s}}\\Bigg|_{D2Q9}$.\n\n*   **Validation Verdict:**\n    *   The problem is scientifically grounded, well-posed, and objective. It is a standard analysis of the LBM's numerical properties, rooted in established first-principles of Chapman-Enskog expansion and Fourier analysis. No flaws are detected.\n    *   The problem is deemed **valid**.\n\n### Step 2: Theoretical Framework for LBM Dispersion\n\nThe macroscopic behavior of the LBM can be derived through a Chapman-Enskog expansion. In the hydrodynamic limit for small-amplitude perturbations (linear acoustics) and with the single-relaxation-time BGK collision operator, this expansion yields a modified wave equation. The condition of neglecting viscous damping sets the relaxation time $\\tau$ to $\\tau=1/2$. The leading-order error terms in the resulting wave equation are responsible for numerical dispersion.\n\nThe plane wave ansatz $\\rho \\propto \\exp(i(\\boldsymbol{k}\\cdot\\boldsymbol{x} - \\omega t))$ is substituted into this effective wave equation, which yields the dispersion relation $\\omega = \\omega(\\boldsymbol{k})$. For small wavenumbers $\\kappa=|\\boldsymbol{k}|$, the phase speed $v_{\\text{ph}} = \\omega/\\kappa$ can be expanded. A known result from this analysis (see, e.g., Lallemand & Luo, PRE 68, 036706, 2003) for the phase speed up to the second order in $(\\kappa h)$ is:\n$$v_{\\text{ph}}(\\boldsymbol{k}) \\approx c_s \\left( 1 + \\mathcal{G}(\\hat{\\boldsymbol{k}}) (\\kappa h)^2 \\right)$$\nwhere $\\hat{\\boldsymbol{k}} = \\boldsymbol{k}/\\kappa$ is the unit wavevector and $\\mathcal{G}(\\hat{\\boldsymbol{k}})$ is the leading-order dispersion coefficient, which is given by:\n$$\\mathcal{G}(\\hat{\\boldsymbol{k}}) = \\frac{c_s^2}{24 c^2} \\left( \\frac{\\sum_i w_i (\\boldsymbol{c}_i \\cdot \\hat{\\boldsymbol{k}})^4}{c_s^4} - 6 \\right)$$\nWe will use this formula to analyze the two given LBM models.\n\n### Step 3: Isothermal Sound Speed Calculation\n\nThe isothermal sound speed $c_s$ is fixed by the second-rank moment of the velocity set for isotropy: $\\sum_i w_i c_{i\\alpha} c_{i\\beta} = c_s^2 \\delta_{\\alpha\\beta}$. Taking the trace ($\\alpha=\\beta$ and summing) gives $\\sum_i w_i |\\boldsymbol{c}_i|^2 = D c_s^2$, where $D=2$ for two dimensions. We compute $c_s^2 = \\sum_i w_i c_{ix}^2$.\n\n*   **D2Q5 Model:**\n    $c_{s,D2Q5}^2 = w_1 c^2 + w_3 (-c)^2 + w_5(0) + \\dots = \\frac{1}{6}c^2 + \\frac{1}{6}c^2 = \\frac{2}{6}c^2 = \\frac{1}{3}c^2$.\n*   **D2Q9 Model:**\n    $c_{s,D2Q9}^2 = (w_1+w_3)c^2 + (w_5+w_6+w_7+w_8)c^2 = (2 \\cdot \\frac{1}{9})c^2 + (4 \\cdot \\frac{1}{36})c^2 = \\frac{2}{9}c^2 + \\frac{1}{9}c^2 = \\frac{3}{9}c^2 = \\frac{1}{3}c^2$.\n\nBoth models share the same sound speed, $c_s^2 = c^2/3$. The dispersion coefficient simplifies to:\n$$\\mathcal{G}(\\hat{\\boldsymbol{k}}) = \\frac{(c^2/3)}{24 c^2} \\left( \\frac{\\sum_i w_i (\\boldsymbol{c}_i \\cdot \\hat{\\boldsymbol{k}})^4}{(c^2/3)^2} - 6 \\right) = \\frac{1}{72} \\left( \\frac{9 \\sum_i w_i (\\boldsymbol{c}_i \\cdot \\hat{\\boldsymbol{k}})^4}{c^4} - 6 \\right) = \\frac{1}{12} \\left( \\frac{3 \\sum_i w_i (\\boldsymbol{c}_i \\cdot \\hat{\\boldsymbol{k}})^4}{2c^4} - 1 \\right)$$\n\n### Step 4: Fourth-Order Moment Anisotropy Analysis\n\nWe must compute the fourth-order moment projection $M_4(\\hat{\\boldsymbol{k}}) = \\sum_i w_i (\\boldsymbol{c}_i \\cdot \\hat{\\boldsymbol{k}})^4$ for each model and wave direction.\n\n**D2Q5 Model:**\n*   Principal direction, $\\hat{\\boldsymbol{k}}_{\\parallel} = (1,0)$:\n    $M_4^\\parallel(D2Q5) = w_1(c)^4 + w_3(-c)^4 = (\\frac{1}{6} + \\frac{1}{6})c^4 = \\frac{1}{3}c^4$.\n*   Diagonal direction, $\\hat{\\boldsymbol{k}}_{\\diag} = (1/\\sqrt{2}, 1/\\sqrt{2})$:\n    $M_4^\\diag(D2Q5) = w_1(\\frac{c}{\\sqrt{2}})^4 + w_3(-\\frac{c}{\\sqrt{2}})^4 + w_2(\\frac{c}{\\sqrt{2}})^4 + w_4(-\\frac{c}{\\sqrt{2}})^4 = 4 \\cdot \\frac{1}{6} \\cdot \\frac{c^4}{4} = \\frac{1}{6}c^4$.\n\n**D2Q9 Model:**\n*   Principal direction, $\\hat{\\boldsymbol{k}}_{\\parallel} = (1,0)$:\n    On-axis velocities: $w_1(c)^4 + w_3(-c)^4 = 2 \\cdot \\frac{1}{9}c^4 = \\frac{2}{9}c^4$.\n    Diagonal velocities: $(w_5+w_6+w_7+w_8)(c)^4 = 4 \\cdot \\frac{1}{36}c^4 = \\frac{1}{9}c^4$.\n    $M_4^\\parallel(D2Q9) = \\frac{2}{9}c^4 + \\frac{1}{9}c^4 = \\frac{1}{3}c^4$.\n*   Diagonal direction, $\\hat{\\boldsymbol{k}}_{\\diag} = (1/\\sqrt{2}, 1/\\sqrt{2})$:\n    On-axis velocities: $(w_1+w_2+w_3+w_4)(\\frac{c}{\\sqrt{2}})^4 = 4 \\cdot \\frac{1}{9} \\cdot \\frac{c^4}{4} = \\frac{1}{9}c^4$.\n    Diagonal velocities: $w_5(c\\sqrt{2})^4 + w_7(-c\\sqrt{2})^4 = 2 \\cdot \\frac{1}{36} \\cdot (4c^4) = \\frac{2}{9}c^4$. (Velocities $\\boldsymbol{c}_6, \\boldsymbol{c}_8$ are orthogonal to $\\boldsymbol{k}_{\\diag}$).\n    $M_4^\\diag(D2Q9) = \\frac{1}{9}c^4 + \\frac{2}{9}c^4 = \\frac{1}{3}c^4$.\n\n### Step 5: Phase Speed Computation\n\nNow we compute the dispersion coefficient $\\mathcal{G}$ for each case.\n\n**D2Q5 Model:**\n*   $M_4^\\parallel = c^4/3 \\implies \\mathcal{G}_{\\parallel,D2Q5} = \\frac{1}{12} \\left( \\frac{3(c^4/3)}{2c^4} - 1 \\right) = \\frac{1}{12} \\left(\\frac{1}{2} - 1\\right) = -\\frac{1}{24}$.\n    $v_{\\text{ph},D2Q5}^{\\parallel} = c_s \\left(1 - \\frac{1}{24}(\\kappa h)^2\\right)$.\n*   $M_4^\\diag = c^4/6 \\implies \\mathcal{G}_{\\diag,D2Q5} = \\frac{1}{12} \\left( \\frac{3(c^4/6)}{2c^4} - 1 \\right) = \\frac{1}{12} \\left(\\frac{1}{4} - 1\\right) = -\\frac{3}{48} = -\\frac{1}{16}$.\n    $v_{\\text{ph},D2Q5}^{\\diag} = c_s \\left(1 - \\frac{1}{16}(\\kappa h)^2\\right)$.\n\n**D2Q9 Model:**\n*   $M_4^\\parallel = c^4/3 \\implies \\mathcal{G}_{\\parallel,D2Q9} = -\\frac{1}{24}$.\n    $v_{\\text{ph},D2Q9}^{\\parallel} = c_s \\left(1 - \\frac{1}{24}(\\kappa h)^2\\right)$.\n*   $M_4^\\diag = c^4/3 \\implies \\mathcal{G}_{\\diag,D2Q9} = -\\frac{1}{24}$.\n    $v_{\\text{ph},D2Q9}^{\\diag} = c_s \\left(1 - \\frac{1}{24}(\\kappa h)^2\\right)$.\nThe D2Q9 model is isotropic at this order of expansion, as expected.\n\n### Step 6: Final Calculation of $\\Delta$\n\nWe now assemble the final quantity $\\Delta$.\nFirst, we compute the normalized phase speed difference for each model.\n\n*   **For D2Q5:**\n    $$\\frac{v_{\\text{ph}}^{\\parallel} - v_{\\text{ph}}^{\\diag}}{c_{s}}\\Bigg|_{D2Q5} = \\left(1 - \\frac{1}{24}(\\kappa h)^2\\right) - \\left(1 - \\frac{1}{16}(\\kappa h)^2\\right) = \\left(\\frac{1}{16} - \\frac{1}{24}\\right)(\\kappa h)^2 = \\left(\\frac{3 - 2}{48}\\right)(\\kappa h)^2 = \\frac{1}{48}(\\kappa h)^2$$\n\n*   **For D2Q9:**\n    $$\\frac{v_{\\text{ph}}^{\\parallel} - v_{\\text{ph}}^{\\diag}}{c_{s}}\\Bigg|_{D2Q9} = \\left(1 - \\frac{1}{24}(\\kappa h)^2\\right) - \\left(1 - \\frac{1}{24}(\\kappa h)^2\\right) = 0$$\n\nFinally, we compute $\\Delta$:\n$$\\Delta = \\frac{v_{\\text{ph}}^{\\parallel} - v_{\\text{ph}}^{\\diag}}{c_{s}}\\Bigg|_{D2Q5} \\;-\\; \\frac{v_{\\text{ph}}^{\\parallel} - v_{\\text{ph}}^{\\diag}}{c_{s}}\\Bigg|_{D2Q9} = \\frac{1}{48}(\\kappa h)^2 - 0$$\n$$\\Delta = \\frac{(\\kappa h)^2}{48}$$\nThis result quantifies the superior isotropy of the D2Q9 model over the D2Q5 model for the propagation of acoustic waves.",
            "answer": "$$\\boxed{\\frac{(\\kappa h)^2}{48}}$$"
        },
        {
            "introduction": "Moving from theory to practice, this capstone project challenges you to build a complete LBM simulator and use it to investigate a subtle but important numerical artifact: the violation of Galilean invariance. In continuum physics, the governing equations are unchanged by a shift to a uniformly moving reference frame; however, the discrete nature of the LBM introduces velocity-dependent errors. In this problem , you will implement a 2D Couette flow simulation, including the widely used Zou-He velocity boundary conditions. By superposing different background velocities on the flow and measuring the resulting deviation in shear stress, you will gain invaluable hands-on experience in LBM coding, post-processing, and the critical analysis of a simulation's faithfulness to the underlying physics.",
            "id": "3971766",
            "problem": "You are to evaluate Galilean invariance error in a two-dimensional Couette flow using the Lattice Boltzmann Method (LBM) within Computational Fluid Dynamics (CFD). The goal is to quantify how the computed shear stress deviates when a uniform background translation velocity is superposed on the Couette flow. The derivation and implementation must be based on first principles of the discrete Boltzmann equation and a single-relaxation-time Bhatnagar–Gross–Krook (BGK) collision operator.\n\nStart from the following fundamental base: the discrete-velocity Boltzmann equation in the Lattice Boltzmann Method (LBM) with BGK relaxation, where populations $f_i$ evolve on a uniform Cartesian lattice with discrete velocities $\\mathbf{c}_i$ and quadrature weights $w_i$. Use the standard two-dimensional nine-velocity model (D2Q9), where the discrete velocities are $\\mathbf{c}_0=(0,0)$, $\\mathbf{c}_1=(1,0)$, $\\mathbf{c}_2=(0,1)$, $\\mathbf{c}_3=(-1,0)$, $\\mathbf{c}_4=(0,-1)$, $\\mathbf{c}_5=(1,1)$, $\\mathbf{c}_6=(-1,1)$, $\\mathbf{c}_7=(-1,-1)$, $\\mathbf{c}_8=(1,-1)$ and weights $w_0=\\frac{4}{9}$, $w_{1,2,3,4}=\\frac{1}{9}$, $w_{5,6,7,8}=\\frac{1}{36}$. The isothermal lattice speed of sound is $c_s^2=\\frac{1}{3}$. The equilibrium distribution $f_i^{\\mathrm{eq}}$ is the second-order Hermite expansion consistent with the discretization, and the relaxation time $\\tau$ relates to the kinematic viscosity through $\\nu=c_s^2(\\tau-\\frac{1}{2})$. Macroscopic density $\\rho$ and velocity $\\mathbf{u}$ are recovered by zeroth and first moments of $f_i$, respectively.\n\nSet up a two-dimensional channel of height $N_y$ nodes and length $N_x$ nodes, with periodic boundary conditions in the streamwise direction and velocity boundary conditions at the two horizontal walls ($y=0$ and $y=N_y-1$). Implement standard Zou–He velocity boundary conditions to impose wall velocities. Configure a Couette flow where the bottom wall moves with velocity $\\mathbf{u}_\\mathrm{bottom}=(U_0,0)$ and the top wall moves with velocity $\\mathbf{u}_\\mathrm{top}=(U_0+U_\\mathrm{rel},0)$, where $U_0$ is a uniform background translation and $U_\\mathrm{rel}$ is the relative plate velocity generating shear. Initialize the fluid uniformly with density $\\rho_0=1$ and velocity $\\mathbf{u}=(U_0,0)$.\n\nBy Galilean invariance in the continuum Navier–Stokes equations, for a Newtonian fluid in Couette flow, the shear stress should depend only on the relative velocity $U_\\mathrm{rel}$ and the channel height, and should not change when a uniform background velocity $U_0$ is superposed. In lattice Boltzmann, discretization and truncation errors can introduce Galilean invariance violations that manifest as deviations in the computed shear stress when $U_0\\neq 0$. After the simulation reaches steady state, estimate the shear stress $\\tau_{xy}$ as $\\tau_{xy}=\\bar{\\rho}\\,\\nu\\,\\frac{du_x}{dy}$, where $\\bar{\\rho}$ is the domain-average density, $\\nu$ is the kinematic viscosity, and $\\frac{du_x}{dy}$ is the slope of the mean streamwise velocity profile across the channel. Compute $\\frac{du_x}{dy}$ by a least-squares linear fit of the streamwise velocity averaged in the periodic direction, using interior nodes to avoid direct boundary effects.\n\nImplement the full simulation in lattice units with $\\Delta x=1$ and $\\Delta t=1$, using the D2Q9 model and single-relaxation-time BGK collision, periodic boundary conditions in $x$, and Zou–He velocity boundary conditions at $y=0$ and $y=N_y-1$. Use $N_x=64$, $N_y=17$, $\\tau=0.8$, $U_\\mathrm{rel}=0.1$, and run for $T=1500$ time steps. Express all quantities in dimensionless lattice units; no physical unit conversion is required.\n\nDesign a test suite of four cases with background velocities $U_0\\in\\{0.0, 0.1, -0.1, 0.3\\}$. For each case, run the simulation and compute the steady-state shear stress $\\tau_{xy}(U_0)$. Use the baseline case at $U_0=0.0$ to define a normalized absolute deviation as $\\epsilon(U_0)=\\left|\\tau_{xy}(U_0)-\\tau_{xy}(0.0)\\right|/\\left|\\tau_{xy}(0.0)\\right|$, which is a dimensionless decimal fraction. The expected result type for each test case is a float.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). The sequence must correspond to $U_0=0.0$, $U_0=0.1$, $U_0=-0.1$, and $U_0=0.3$ in that order. No additional text should be printed.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the well-established principles of the Lattice Boltzmann Method (LBM) for computational fluid dynamics, specifically using the Bhatnagar–Gross–Krook (BGK) approximation. The setup describes a standard numerical experiment to investigate a known, non-trivial artifact of the LBM—the lack of perfect Galilean invariance. The problem is well-posed, providing all necessary parameters, initial conditions, boundary conditions, and a clear, objective procedure for computing the desired quantities. The parameters chosen are reasonable for a stable and meaningful numerical simulation.\n\nThe objective is to quantify the Galilean invariance error in a two-dimensional LBM simulation of Couette flow. In continuum mechanics, the Navier-Stokes equations are Galilean invariant, meaning the physics of the flow, including shear stress, are independent of the constant velocity of the reference frame. Superposing a uniform translational velocity $\\mathbf{U}_0$ onto a flow should not alter the internal stresses. However, the discrete nature of the LBM introduces truncation errors that break this invariance, particularly at non-negligible Mach numbers. This error manifests as a dependency of computed quantities, such as shear stress, on the background velocity $U_0$.\n\nWe will simulate a two-dimensional Couette flow in a channel of height $N_y$ and length $N_x$. The fluid is confined between two parallel plates. The bottom plate at $y=0$ moves with velocity $\\mathbf{u}_\\mathrm{bottom}=(U_0,0)$, and the top plate at $y=N_y-1$ moves with velocity $\\mathbf{u}_\\mathrm{top}=(U_0+U_\\mathrm{rel},0)$. All quantities are expressed in dimensionless lattice units, where the lattice spacing $\\Delta x = 1$ and the time step $\\Delta t = 1$.\n\nThe simulation is governed by the discrete-velocity Boltzmann equation with the single-relaxation-time BGK collision operator:\n$$\nf_i(\\mathbf{x}+\\mathbf{c}_i \\Delta t, t+\\Delta t) - f_i(\\mathbf{x}, t) = -\\frac{1}{\\tau} \\left( f_i(\\mathbf{x}, t) - f_i^{\\mathrm{eq}}(\\mathbf{x}, t) \\right)\n$$\nwhere $f_i(\\mathbf{x}, t)$ is the particle distribution function for the discrete velocity $\\mathbf{c}_i$ at lattice site $\\mathbf{x}$ and time $t$. $\\tau$ is the relaxation time, which controls the fluid's viscosity. The LBM algorithm proceeds in two main steps:\n\n1.  **Collision Step**: At each lattice node, the distribution functions $f_i$ relax towards a local equilibrium distribution $f_i^{\\mathrm{eq}}$.\n    $$\n    f_i^*(\\mathbf{x}, t) = f_i(\\mathbf{x}, t) - \\frac{1}{\\tau} \\left( f_i(\\mathbf{x}, t) - f_i^{\\mathrm{eq}}(\\rho, \\mathbf{u}) \\right)\n    $$\n    where $f_i^*$ are the post-collision distribution functions. The macroscopic density $\\rho$ and velocity $\\mathbf{u}$ are computed from the moments of the distribution functions:\n    $$\n    \\rho = \\sum_{i=0}^{8} f_i \\quad \\text{and} \\quad \\rho\\mathbf{u} = \\sum_{i=0}^{8} f_i \\mathbf{c}_i\n    $$\n\n2.  **Streaming Step**: The post-collision populations $f_i^*$ move to adjacent lattice nodes according to their discrete velocities:\n    $$\n    f_i(\\mathbf{x}+\\mathbf{c}_i, t+1) = f_i^*(\\mathbf{x}, t)\n    $$\n    (with $\\Delta x=1, \\Delta t=1$).\n\nThe simulation uses the standard D2Q9 lattice model, for which the discrete velocities $\\mathbf{c}_i$ and weights $w_i$ are given. The equilibrium distribution function $f_i^{\\mathrm{eq}}$ is a second-order polynomial expansion of the Maxwell-Boltzmann distribution in velocity, given by:\n$$\nf_i^{\\mathrm{eq}} = w_i \\rho \\left( 1 + \\frac{\\mathbf{c}_i \\cdot \\mathbf{u}}{c_s^2} + \\frac{(\\mathbf{c}_i \\cdot \\mathbf{u})^2}{2c_s^4} - \\frac{\\mathbf{u} \\cdot \\mathbf{u}}{2c_s^2} \\right)\n$$\nwhere $c_s=1/\\sqrt{3}$ is the lattice speed of sound. The kinematic viscosity $\\nu$ is related to the relaxation time by $\\nu = c_s^2(\\tau - 0.5)$.\n\nThe simulation domain is a grid of size $N_x=64$ by $N_y=17$. Boundary conditions are periodic in the streamwise ($x$) direction. In the transverse ($y$) direction, Zou-He velocity boundary conditions are applied at the walls ($y=0$ and $y=N_y-1$). For a wall node with a specified velocity $\\mathbf{u}_w=(u_{wx}, u_{wy}=0)$, the unknown incoming populations are reconstructed after the streaming step. For the bottom wall ($y=0$), the unknowns are $f_2, f_5, f_6$. They are determined as follows:\nFirst, the wall density $\\rho_w$ is calculated from the known, post-stream populations at the wall node:\n$$\n\\rho_w = f_0 + f_1 + f_3 + 2(f_4 + f_7 + f_8)\n$$\nThen, the unknown populations are computed using $\\rho_w$ and the known wall velocity $u_{wx}$:\n$$\nf_2 = f_4\n$$\n$$\nf_5 = f_7 - \\frac{1}{2}(f_1-f_3) + \\frac{1}{2}\\rho_w u_{wx}\n$$\n$$\nf_6 = f_8 + \\frac{1}{2}(f_1-f_3) - \\frac{1}{2}\\rho_w u_{wx}\n$$\nA symmetric set of relations is used for the top wall ($y=N_y-1$).\n\nThe simulation is initialized with a uniform density $\\rho_0=1$ and velocity $\\mathbf{u}_{init}=(U_0, 0)$. It is run for $T=1500$ time steps to allow the flow to reach a steady state.\n\nAfter reaching steady state, the shear stress $\\tau_{xy}$ is computed. First, the streamwise velocity $u_x$ is averaged along the periodic $x$-direction to obtain a mean velocity profile $\\bar{u}_x(y)$. A linear least-squares regression is performed on this profile over the interior nodes ($y \\in [1, N_y-2]$) to find the velocity gradient $du_x/dy$. The shear stress is then calculated using the domain-averaged density $\\bar{\\rho}$ and the kinematic viscosity $\\nu$:\n$$\n\\tau_{xy} = \\bar{\\rho} \\, \\nu \\, \\frac{du_x}{dy}\n$$\nThis procedure is repeated for each background velocity $U_0 \\in \\{0.0, 0.1, -0.1, 0.3\\}$. The case $U_0=0.0$ serves as the baseline, providing the reference shear stress $\\tau_{xy}(0.0)$. The Galilean invariance error is quantified as the normalized absolute deviation:\n$$\n\\epsilon(U_0)=\\frac{\\left|\\tau_{xy}(U_0)-\\tau_{xy}(0.0)\\right|}{\\left|\\tau_{xy}(0.0)\\right|}\n$$\nThe value of $\\epsilon(U_0)$ will be calculated for each of the four specified values of $U_0$. By definition, $\\epsilon(0.0) = 0$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Simulates 2D Couette flow using LBM to evaluate Galilean invariance error.\n    \"\"\"\n    \n    # Simulation Parameters\n    NX = 64\n    NY = 17\n    TAU = 0.8\n    U_REL = 0.1\n    T_STEPS = 1500\n    RHO0 = 1.0\n    \n    # D2Q9 model parameters\n    C = np.array([[0, 0], [1, 0], [0, 1], [-1, 0], [0, -1], \n                  [1, 1], [-1, 1], [-1, -1], [1, -1]])\n    W = np.array([4/9, 1/9, 1/9, 1/9, 1/9, 1/36, 1/36, 1/36, 1/36])\n    CS2 = 1/3\n    NU = CS2 * (TAU - 0.5)\n\n    test_cases_U0 = [0.0, 0.1, -0.1, 0.3]\n    tau_xy_results = {}\n\n    def equilibrium_dist(rho, ux, uy):\n        \"\"\"Calculates the equilibrium distribution function.\"\"\"\n        feq = np.zeros((NY, NX, 9))\n        u_dot_u = ux**2 + uy**2\n        for i in range(9):\n            c_dot_u = C[i, 0] * ux + C[i, 1] * uy\n            term1 = c_dot_u / CS2\n            term2 = (c_dot_u**2) / (2 * CS2**2)\n            term3 = u_dot_u / (2 * CS2)\n            feq[:, :, i] = W[i] * rho * (1 + term1 + term2 - term3)\n        return feq\n\n    for u0 in test_cases_U0:\n        # Flow Parameters for the current case\n        u_bottom = u0\n        u_top = u0 + U_REL\n        \n        # Initialization\n        ux_init = np.full((NY, NX), u0)\n        uy_init = np.zeros((NY, NX))\n        rho_init = np.full((NY, NX), RHO0)\n        f = equilibrium_dist(rho_init, ux_init, uy_init)\n\n        # Main simulation loop\n        for t in range(T_STEPS):\n            # Collision\n            rho = np.sum(f, axis=2)\n            ux = np.einsum('ijk,k->ij', f, C[:, 0]) / rho\n            uy = np.einsum('ijk,k->ij', f, C[:, 1]) / rho\n            \n            feq = equilibrium_dist(rho, ux, uy)\n            f = f - (1/TAU) * (f - feq)\n\n            # Streaming\n            for i in range(9):\n                f[:, :, i] = np.roll(f[:, :, i], C[i, 0], axis=1)\n                f[:, :, i] = np.roll(f[:, :, i], C[i, 1], axis=0)\n\n            # Boundary Conditions (Zou-He)\n            # Bottom wall (y=0)\n            rho_w_bottom = f[0, :, 0] + f[0, :, 1] + f[0, :, 3] + 2 * (f[0, :, 4] + f[0, :, 7] + f[0, :, 8])\n            f[0, :, 2] = f[0, :, 4]  # Since u_y = 0\n            f[0, :, 5] = f[0, :, 7] - 0.5 * (f[0, :, 1] - f[0, :, 3]) + 0.5 * rho_w_bottom * u_bottom\n            f[0, :, 6] = f[0, :, 8] + 0.5 * (f[0, :, 1] - f[0, :, 3]) - 0.5 * rho_w_bottom * u_bottom\n\n            # Top wall (y=NY-1)\n            rho_w_top = f[-1, :, 0] + f[-1, :, 1] + f[-1, :, 3] + 2 * (f[-1, :, 2] + f[-1, :, 5] + f[-1, :, 6])\n            f[-1, :, 4] = f[-1, :, 2]  # Since u_y = 0\n            f[-1, :, 7] = f[-1, :, 5] + 0.5 * (f[-1, :, 1] - f[-1, :, 3]) - 0.5 * rho_w_top * u_top\n            f[-1, :, 8] = f[-1, :, 6] - 0.5 * (f[-1, :, 1] - f[-1, :, 3]) + 0.5 * rho_w_top * u_top\n\n        # Post-processing to calculate shear stress\n        rho_final = np.sum(f, axis=2)\n        ux_final = np.einsum('ijk,k->ij', f, C[:, 0]) / rho_final\n        \n        rho_avg = np.mean(rho_final)\n        ux_profile = np.mean(ux_final, axis=1)\n\n        # Linear fit on interior nodes\n        y_interior = np.arange(1, NY - 1)\n        ux_interior = ux_profile[1:-1]\n        \n        # scipy.stats.linregress(x, y)\n        lin_fit = linregress(y_interior, ux_interior)\n        du_dy = lin_fit.slope\n        \n        tau_xy = rho_avg * NU * du_dy\n        tau_xy_results[u0] = tau_xy\n\n    # Calculate normalized deviation\n    tau_xy_base = tau_xy_results[0.0]\n    deviations = []\n    for u0 in test_cases_U0:\n        current_tau_xy = tau_xy_results[u0]\n        if tau_xy_base == 0:\n            deviation = 0.0 if current_tau_xy == 0.0 else float('inf')\n        else:\n            deviation = abs(current_tau_xy - tau_xy_base) / abs(tau_xy_base)\n        deviations.append(deviation)\n    \n    print(f\"[{','.join(map(str, deviations))}]\")\n\nsolve()\n\n```"
        }
    ]
}