{
    "hands_on_practices": [
        {
            "introduction": "任何成功的动力学模型的关键考验在于其能否准确再现宏观输运定律。本练习将引导您通过Chapman-Enskog展开，从Bhatnagar-Gross-Krook（BGK）算子中推导出傅里叶热传导定律。这个过程不仅揭示了微观弛豫时间 $\\tau$ 与宏观热导率 $k$ 之间的直接联系，还为理解气体动力学如何与连续介质力学相衔接提供了坚实的数学基础 。",
            "id": "3737230",
            "problem": "考虑一个稀薄的单原子理想气体，在动力学层面由带有 Bhatnagar-Gross-Krook (BGK) 碰撞算子的玻尔兹曼方程描述。BGK 模型通过将分布函数 $f(\\mathbf{x},\\mathbf{v},t)$ 以单一弛豫时间 $\\tau$ 弛豫到局域麦克斯韦分布 $f_M(\\mathbf{x},\\mathbf{v},t)$ 来近似碰撞积分，具体如下\n$$\n\\partial_t f + \\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f \\;=\\; -\\frac{1}{\\tau}\\big(f - f_M\\big).\n$$\n假设一个稳态、弱非等温、静态（$\\mathbf{u}(\\mathbf{x})=\\mathbf{0}$），无体力，且场在空间上缓慢变化。局域麦克斯韦分布为\n$$\nf_M(\\mathbf{x},\\mathbf{v}) \\;=\\; n(\\mathbf{x})\\left(\\frac{m}{2\\pi k_B T(\\mathbf{x})}\\right)^{3/2}\\exp\\!\\left(-\\frac{m|\\mathbf{v}|^2}{2 k_B T(\\mathbf{x})}\\right),\n$$\n其中 $n(\\mathbf{x})$ 是数密度，$T(\\mathbf{x})$ 是温度，$m$ 是粒子质量，$k_B$ 是玻尔兹曼常数。理想气体定律在局域成立：$p(\\mathbf{x}) = n(\\mathbf{x}) k_B T(\\mathbf{x})$。热通量定义为\n$$\n\\mathbf{q}(\\mathbf{x}) \\;=\\; \\int_{\\mathbb{R}^3} \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, f(\\mathbf{x},\\mathbf{v})\\, d\\mathbf{v}.\n$$\n使用关于 $f_M$ 的一阶 Chapman–Enskog 展开，并假设压力恒定（因此 $\\nabla p = \\mathbf{0}$ 而 $\\nabla T \\neq \\mathbf{0}$），推导傅里葉定律 $\\mathbf{q} = -k\\,\\nabla T$ 并计算 BGK 模型所隐含的热导率 $k$。请将你的最终 $k$ 值仅用压力 $p$、弛豫时间 $\\tau$ 和单原子理想气体的定压比热 $c_p$（每单位质量）表示。\n\n热导率的国际单位制单位是 $\\mathrm{W\\,m^{-1}\\,K^{-1}}$，但你必须将最终答案表示为一个无单位的闭式符号表达式。",
            "solution": "该问题要求使用 Bhatnagar-Gross-Krook (BGK) 动力学模型，为稀薄的单原子理想气体推导热传导的傅里葉定律并计算热导率 $k$。$k$ 的最终表达式必须用压力 $p$、弛豫时间 $\\tau$ 和每单位质量的定压比热 $c_p$ 来表示。\n\n我们从给定的 BGK 方程开始：\n$$\n\\partial_t f + \\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f = -\\frac{1}{\\tau}\\big(f - f_M\\big)\n$$\n问题指明了系统处于稳态（$\\partial_t f = 0$）、静态（$\\mathbf{u}(\\mathbf{x}) = \\mathbf{0}$）和弱非均匀状态。在这些条件下，BGK 方程简化为：\n$$\n\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f = -\\frac{1}{\\tau}\\big(f - f_M\\big)\n$$\n这可以重新排列以表达分布函数 $f$：\n$$\nf = f_M - \\tau (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f)\n$$\nChapman-Enskog 展开过程假设系统接近局域平衡，这意味着分布函数 $f$ 只是对局域麦克斯韦分布 $f_M$ 的一个小的微扰。该展开是按一个小参数（克努森数）的幂次进行的，该参数与弛豫时间 $\\tau$ 和空间梯度成正比。对于一阶近似，我们可以在右侧的梯度项中用 $f$ 的零阶近似 $f_M$ 来代替 $f$。这得到对分布函数的一阶修正 $f_1 = f - f_M$：\n$$\nf_1(\\mathbf{x}, \\mathbf{v}) \\approx -\\tau (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f_M)\n$$\n因此，一阶分布函数为 $f \\approx f_M + f_1 = f_M - \\tau (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f_M)$。\n\n为了继续，我们必须计算局域麦克斯韦分布的空间梯度 $\\nabla_{\\mathbf{x}} f_M$。局域麦克斯韦分布由下式给出：\n$$\nf_M(\\mathbf{x},\\mathbf{v}) = n(\\mathbf{x})\\left(\\frac{m}{2\\pi k_B T(\\mathbf{x})}\\right)^{3/2}\\exp\\left(-\\frac{m|\\mathbf{v}|^2}{2 k_B T(\\mathbf{x})}\\right)\n$$\n计算其对数 $\\ln(f_M)$ 的梯度会很方便：\n$$\n\\ln(f_M) = \\ln(n) - \\frac{3}{2}\\ln(T) - \\frac{m|\\mathbf{v}|^2}{2k_B T} + \\text{constant}\n$$\n取空间梯度 $\\nabla_{\\mathbf{x}}$，得到：\n$$\n\\frac{\\nabla_{\\mathbf{x}} f_M}{f_M} = \\frac{\\nabla_{\\mathbf{x}} n}{n} - \\frac{3}{2}\\frac{\\nabla_{\\mathbf{x}} T}{T} - \\frac{m|\\mathbf{v}|^2}{2k_B}\\nabla_{\\mathbf{x}}\\left(\\frac{1}{T}\\right) = \\frac{\\nabla_{\\mathbf{x}} n}{n} - \\frac{3}{2}\\frac{\\nabla_{\\mathbf{x}} T}{T} + \\frac{m|\\mathbf{v}|^2}{2k_B T^2}\\nabla_{\\mathbf{x}} T\n$$\n所以，\n$$\n\\nabla_{\\mathbf{x}} f_M = f_M \\left[ \\frac{\\nabla_{\\mathbf{x}} n}{n} + \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T^2} - \\frac{3}{2T}\\right)\\nabla_{\\mathbf{x}} T \\right]\n$$\n问题陈述压力 $p = n k_B T$ 是恒定的，所以 $\\nabla_{\\mathbf{x}} p = \\mathbf{0}$。应用乘积法则：\n$$\n\\nabla_{\\mathbf{x}} p = k_B(T \\nabla_{\\mathbf{x}} n + n \\nabla_{\\mathbf{x}} T) = \\mathbf{0}\n$$\n这给出了密度梯度和温度梯度之间的关系：$T \\nabla_{\\mathbf{x}} n = -n \\nabla_{\\mathbf{x}} T$，可以写成 $\\frac{\\nabla_{\\mathbf{x}} n}{n} = -\\frac{\\nabla_{\\mathbf{x}} T}{T}$。将此代入 $\\nabla_{\\mathbf{x}} f_M$ 的表达式中：\n$$\n\\nabla_{\\mathbf{x}} f_M = f_M \\left[ -\\frac{\\nabla_{\\mathbf{x}} T}{T} + \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T^2} - \\frac{3}{2T}\\right)\\nabla_{\\mathbf{x}} T \\right] = f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T^2} - \\frac{5}{2T}\\right)\\nabla_{\\mathbf{x}} T\n$$\n现在我们可以写出一阶修正 $f_1$：\n$$\nf_1 = -\\tau (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f_M) = -\\tau f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) \\frac{1}{T} (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} T)\n$$\n热通量矢量 $\\mathbf{q}$ 定义为分布函数相对于特异速度（在此情况下，由于 $\\mathbf{u}=\\mathbf{0}$，特异速度就是 $\\mathbf{v}$）的三阶矩：\n$$\n\\mathbf{q}(\\mathbf{x}) = \\int_{\\mathbb{R}^3} \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, f(\\mathbf{x},\\mathbf{v})\\, d\\mathbf{v} = \\int \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, (f_M + f_1)\\, d\\mathbf{v}\n$$\n涉及 $f_M$ 的积分为零，因为 $f_M$ 是 $\\mathbf{v}$ 的偶函数，而被积函数的其余部分包含一个因子 $\\mathbf{v}$，使得整个被积函数为奇函数。奇函数在对称域 $\\mathbb{R}^3$ 上的积分为零。因此，热通量完全由一阶修正 $f_1$ 决定：\n$$\n\\mathbf{q} = \\int \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, f_1\\, d\\mathbf{v} = -\\frac{\\tau}{T} \\int \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} T) \\, d\\mathbf{v}\n$$\n这个表达式的形式为 $\\mathbf{q} = -\\mathbf{K} \\cdot \\nabla_{\\mathbf{x}} T$，其中 $\\mathbf{K}$ 是热导率张量。项 $(\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} T)$ 可以写成 $(\\mathbf{v} \\otimes \\mathbf{v}) \\cdot \\nabla_{\\mathbf{x}} T$。积分可以写为：\n$$\n\\mathbf{q} = -\\left[ \\frac{\\tau}{T} \\int \\frac{1}{2} m |\\mathbf{v}|^2 f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) (\\mathbf{v} \\otimes \\mathbf{v}) \\, d\\mathbf{v} \\right] \\cdot \\nabla_{\\mathbf{x}} T\n$$\n由于被积函数在 $\\mathbf{v}$ 中是各向同性的，张量积分简化为：$\\int (\\dots) (\\mathbf{v} \\otimes \\mathbf{v}) \\, d\\mathbf{v} = \\frac{1}{3} \\mathbf{I} \\int (\\dots) |\\mathbf{v}|^2 \\, d\\mathbf{v}$。因此，电导率张量是对角的，$\\mathbf{K} = k \\mathbf{I}$，我们恢复了傅里葉定律 $\\mathbf{q} = -k\\,\\nabla_{\\mathbf{x}} T$，其中标量热导率 $k$ 由下式给出：\n$$\nk = \\frac{\\tau}{3T} \\int \\frac{1}{2} m |\\mathbf{v}|^4 f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) d\\mathbf{v}\n$$\n为了计算这个积分，我们可以用麦克斯韦分布的矩来表示它，矩的定义为 $\\langle A \\rangle = \\frac{1}{n} \\int A f_M d\\mathbf{v}$：\n$$\nk = \\frac{n\\tau}{3T} \\left\\langle \\frac{1}{2} m |\\mathbf{v}|^4 \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) \\right\\rangle = \\frac{nm\\tau}{6T} \\left\\langle |\\mathbf{v}|^4 \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) \\right\\rangle\n$$\n$$\nk = \\frac{nm\\tau}{6T} \\left[ \\frac{m}{2k_B T} \\langle |\\mathbf{v}|^6 \\rangle - \\frac{5}{2} \\langle |\\mathbf{v}|^4 \\rangle \\right]\n$$\n麦克斯韦分布的速度大小矩的通用公式是 $\\langle |\\mathbf{v}|^{2j} \\rangle = (2j+1)!! \\left(\\frac{k_B T}{m}\\right)^j$，其中 $(2j+1)!! = (2j+1)(2j-1)\\dots 1$。\n对于 $j=2$，我们需要 $\\langle |\\mathbf{v}|^4 \\rangle$：\n$$\n\\langle |\\mathbf{v}|^4 \\rangle = (5)!! \\left(\\frac{k_B T}{m}\\right)^2 = (5 \\cdot 3 \\cdot 1) \\left(\\frac{k_B T}{m}\\right)^2 = 15 \\left(\\frac{k_B T}{m}\\right)^2\n$$\n对于 $j=3$，我们需要 $\\langle |\\mathbf{v}|^6 \\rangle$：\n$$\n\\langle |\\mathbf{v}|^6 \\rangle = (7)!! \\left(\\frac{k_B T}{m}\\right)^3 = (7 \\cdot 5 \\cdot 3 \\cdot 1) \\left(\\frac{k_B T}{m}\\right)^3 = 105 \\left(\\frac{k_B T}{m}\\right)^3\n$$\n将这些矩代入 $k$ 的表达式中：\n$$\nk = \\frac{nm\\tau}{6T} \\left[ \\frac{m}{2k_B T} \\left(105 \\frac{k_B^3 T^3}{m^3}\\right) - \\frac{5}{2} \\left(15 \\frac{k_B^2 T^2}{m^2}\\right) \\right]\n$$\n$$\nk = \\frac{nm\\tau}{6T} \\left[ \\frac{105}{2} \\frac{k_B^2 T^2}{m^2} - \\frac{75}{2} \\frac{k_B^2 T^2}{m^2} \\right] = \\frac{nm\\tau}{6T} \\left[ \\frac{30}{2} \\frac{k_B^2 T^2}{m^2} \\right]\n$$\n$$\nk = \\frac{nm\\tau}{6T} \\left(15 \\frac{k_B^2 T^2}{m^2}\\right) = \\frac{15}{6} \\frac{n \\tau k_B^2 T}{m} = \\frac{5}{2} \\frac{n k_B^2 T \\tau}{m}\n$$\n最后一步是用 $p$、$\\tau$ 和 $c_p$ 来表示这个结果。使用理想气体定律 $p = n k_B T$，我们可以写出：\n$$\nk = \\frac{5}{2} \\frac{(n k_B T) k_B \\tau}{m} = \\frac{5}{2} \\frac{p k_B \\tau}{m}\n$$\n对于单原子理想气体，每个粒子的内能是 $\\frac{3}{2} k_B T$。每单位质量的内能是 $e = \\frac{3}{2} \\frac{k_B T}{m}$。每单位质量的定容比热是 $c_v = (\\partial e / \\partial T)_V = \\frac{3}{2}\\frac{k_B}{m}$。对于理想气体，每单位质量比热的迈耶关系是 $c_p - c_v = R_s$，其中 $R_s = k_B/m$ 是比气体常数。\n因此，每单位质量的定压比热是：\n$$\nc_p = c_v + \\frac{k_B}{m} = \\frac{3}{2}\\frac{k_B}{m} + \\frac{k_B}{m} = \\frac{5}{2}\\frac{k_B}{m}\n$$\n将这个 $c_p$ 的表达式代入我们得到的 $k$ 的结果中：\n$$\nk = p \\tau \\left(\\frac{5}{2}\\frac{k_B}{m}\\right) = p \\tau c_p\n$$\n这是在给定假设下，BGK模型所隐含的热导率的最终表达式。",
            "answer": "$$\n\\boxed{p \\tau c_{p}}\n$$"
        },
        {
            "introduction": "格子玻尔兹曼方法（LBM）是一种强大的计算流体力学工具，它建立在离散化的BGK动力学方程之上。为了确保模拟的物理真实性，离散速度集及其权重必须能够精确地再现连续麦克斯韦-玻尔兹曼分布的矩。本练习将指导您完成矩匹配这一基本过程，以构建一个能够保证宏观各向同性的二维九速（D2Q9）模型 。",
            "id": "3737196",
            "problem": "考虑一个二维等温动力学模型，该模型使用Bhatnagar-Gross-Krook (BGK) 碰撞算子，其中碰撞项使分布函数弛豫到一个局部平衡态，该平衡态由速度空间中的麦克斯韦-玻尔兹曼(Maxwell-Boltzmann)密度表征。在多尺度建模中，离散速度求积必须能够再现麦克斯韦-玻尔兹曼平衡态的连续速度矩，以保证正确恢复流体动力学极限。你的任务是构建一个最小的、对称的离散速度集以及相关的权重，使其能在速度空间中再现高达四阶的各向同性。\n\n采用一个由二维空间中三个对称等效壳层组成的离散速度集：一个速度为 $(0,0)$ 的静止向量，四个轴向向量 $(\\pm 1,0)$ 和 $(0,\\pm 1)$，以及四个对角向量 $(\\pm 1,\\pm 1)$。设与这三个壳层相关的权重分别为 $w_{0}$、$w_{1}$ 和 $w_{2}$。假设格点速度以无量纲格点单位给出，单位格点速度为1，并令 $c_{s}^{2}$ 表示由该求积产生的格点声速的平方。\n\n从第一性原理出发，要求离散求积能够再现速度空间中一个二维、零均值、各向同性高斯分布的零阶、二阶和四阶中心矩，该高斯分布在每个分量上的方差均为 $c_{s}^{2}$。仅使用各向同性的基本性质和可从独立分量的因式分解中推导出的标准高斯矩关系，来为权重和 $c_{s}^{2}$ 建立必要的矩匹配条件。精确求解 $w_{0}$、$w_{1}$、$w_{2}$ 和 $c_{s}^{2}$，并验证所得的离散矩在克罗内克-δ (Kronecker-delta) 构造的意义上，能生成一个各向同性的二阶张量和一个各向同性的四阶张量。\n\n将你的最终答案以包含 $(w_{0}, w_{1}, w_{2}, c_{s}^{2})$ 的 $1 \\times 4$ 行矩阵形式给出。无需四舍五入；给出精确值。",
            "solution": "该问题要求为二维动力学模型构建一个离散速度求积，该求积能够正确再现平衡分布的矩，直至四阶。这是确保所得数值格式（如格子玻尔兹曼模型）在宏观极限下能恢复正确流体动力学方程的基本步骤。\n\n首先，我们定义离散速度集及相关权重。该集合包含 $N=9$ 个速度，根据对称性和速率划分为三个壳层。设离散速度向量记为 $\\vec{c}_i$，其中 $i=0, \\dots, 8$。\n- 壳层 0：一个静止粒子，$\\vec{c}_0 = (0, 0)$，权重为 $w_0$。\n- 壳层 1：四个速率为 $1$ 的“轴向”粒子，$\\vec{c}_i \\in \\{(\\pm 1, 0), (0, \\pm 1)\\}$，每个粒子的权重为 $w_1$。\n- 壳层 2：四个速率为 $\\sqrt{2}$ 的“对角”粒子，$\\vec{c}_i \\in \\{(\\pm 1, \\pm 1)\\}$，每个粒子的权重为 $w_2$。\n\n分布函数的离散矩通过对离散速度集进行加权求和来计算。对于一个秩为 $k$ 的一般张量矩，其表达式为：\n$$\nM_{\\alpha_1 \\alpha_2 \\dots \\alpha_k} = \\sum_{i=0}^{8} w_i c_{i, \\alpha_1} c_{i, \\alpha_2} \\dots c_{i, \\alpha_k}\n$$\n其中 $\\alpha_j \\in \\{x, y\\}$。\n\n接下来，我们定义目标平衡分布的连续矩，该分布是一个在每个速度分量上都具有方差 $c_s^2$ 的二维、零均值、各向同性高斯分布（麦克斯韦-玻尔兹曼分布）。归一化概率密度函数为：\n$$\ng(\\vec{\\xi}) = \\frac{1}{2\\pi c_s^2} \\exp\\left(-\\frac{\\xi_x^2 + \\xi_y^2}{2 c_s^2}\\right)\n$$\n其中 $\\vec{\\xi} = (\\xi_x, \\xi_y)$ 是连续速度向量。连续矩由以下积分给出：\n$$\n\\langle \\xi_{\\alpha_1} \\xi_{\\alpha_2} \\dots \\xi_{\\alpha_k} \\rangle = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\xi_{\\alpha_1} \\xi_{\\alpha_2} \\dots \\xi_{\\alpha_k} g(\\vec{\\xi}) \\,d\\xi_x \\,d\\xi_y\n$$\n\n现在我们必须将离散矩和连续矩相等（直至四阶），以求解四个未知数：$w_0, w_1, w_2$ 和 $c_s^2$。\n\n**零阶矩（归一化）：**\n零阶矩对应于总概率，必须为 $1$。\n- 离散情况：$\\sum_{i=0}^{8} w_i = w_0 \\cdot 1 + w_1 \\cdot 4 + w_2 \\cdot 4 = w_0 + 4w_1 + 4w_2$。\n- 连续情况：$\\int g(\\vec{\\xi}) \\,d\\vec{\\xi} = 1$。\n- 方程 (1)：$w_0 + 4w_1 + 4w_2 = 1$。\n\n对于离散集（因其对称性）和连续高斯分布（因其偶性），所有奇数阶矩均为零，因此它们自动满足。\n\n**二阶矩（动量通量的各向同性）：**\n二阶矩张量为 $M_{ab} = \\sum_i w_i c_{i,a} c_{i,b}$。\n- 离散分量：\n  - $M_{xx} = \\sum_i w_i c_{i,x}^2 = w_1(1^2) + w_1(-1)^2 + w_2(1^2) + w_2(-1)^2 + w_2(1^2) + w_2(-1)^2 = 2w_1 + 4w_2$。\n  - 根据对称性，$M_{yy} = 2w_1 + 4w_2$。\n  - $M_{xy} = \\sum_i w_i c_{i,x} c_{i,y} = w_2(1)(1) + w_2(1)(-1) + w_2(-1)(1) + w_2(-1)(-1) = 0$。\n- 连续分量：指定高斯分布的二阶矩由其协方差矩阵给出。由于各分量独立且方差为 $c_s^2$，我们有 $\\langle \\xi_a \\xi_b \\rangle = c_s^2 \\delta_{ab}$，其中 $\\delta_{ab}$ 是克罗内克-δ (Kronecker delta)。\n  - $\\langle \\xi_x^2 \\rangle = c_s^2$。\n  - $\\langle \\xi_y^2 \\rangle = c_s^2$。\n  - $\\langle \\xi_x \\xi_y \\rangle = 0$。\n- 令非平凡分量相等，得到方程 (2)：$2w_1 + 4w_2 = c_s^2$。\n\n**四阶矩（四阶张量的各向同性）：**\n四阶矩张量为 $M_{abcd} = \\sum_i w_i c_{i,a} c_{i,b} c_{i,c} c_{i,d}$。\n- 离散分量：我们只需计算唯一的非零分量。\n  - $M_{xxxx} = \\sum_i w_i c_{i,x}^4 = w_1(1^4) + w_1(-1)^4 + w_2(1^4) + w_2(-1)^4 + w_2(1^4) + w_2(-1)^4 = 2w_1 + 4w_2$。\n  - $M_{xxyy} = \\sum_i w_i c_{i,x}^2 c_{i,y}^2 = w_2(1^2)(1^2) + w_2(1^2)(-1)^2 + w_2(-1)^2(1^2) + w_2(-1)^2(-1)^2 = 4w_2$。\n- 连续分量：对于零均值多元高斯分布，四阶中心矩由伊塞利斯 (Isserlis) 定理（或威克 (Wick) 定理）给出：$\\langle \\xi_a \\xi_b \\xi_c \\xi_d \\rangle = \\langle \\xi_a \\xi_b \\rangle \\langle \\xi_c \\xi_d \\rangle + \\langle \\xi_a \\xi_c \\rangle \\langle \\xi_b \\xi_d \\rangle + \\langle \\xi_a \\xi_d \\rangle \\langle \\xi_b \\xi_c \\rangle$。\n  - $\\langle \\xi_x^4 \\rangle = \\langle \\xi_x \\xi_x \\rangle \\langle \\xi_x \\xi_x \\rangle \\times 3 = 3(c_s^2)^2 = 3c_s^4$。\n  - $\\langle \\xi_x^2 \\xi_y^2 \\rangle = \\langle \\xi_x^2 \\rangle \\langle \\xi_y^2 \\rangle + 2\\langle \\xi_x \\xi_y \\rangle^2 = (c_s^2)(c_s^2) + 2(0)^2 = c_s^4$。\n- 令各分量相等，得到另外两个方程：\n  - 方程 (3)：$2w_1 + 4w_2 = 3c_s^4$。\n  - 方程 (4)：$4w_2 = c_s^4$。\n\n现在我们得到了一个包含四个未知数的四方程系统：\n1. $w_0 + 4w_1 + 4w_2 = 1$\n2. $2w_1 + 4w_2 = c_s^2$\n3. $2w_1 + 4w_2 = 3c_s^4$\n4. $4w_2 = c_s^4$\n\n由 (2) 和 (3) 式，我们令左侧相等：\n$c_s^2 = 3c_s^4$\n由于具有物理意义的温度要求 $c_s^2 > 0$，我们可以除以 $c_s^2$：\n$1 = 3c_s^2 \\implies c_s^2 = \\frac{1}{3}$。\n\n现在我们可以通过回代求解权重。\n将 $c_s^2=1/3$ 代入 (4) 式：\n$4w_2 = c_s^4 = (c_s^2)^2 = \\left(\\frac{1}{3}\\right)^2 = \\frac{1}{9}$\n$w_2 = \\frac{1}{36}$。\n\n将 $w_2=1/36$ 和 $c_s^2=1/3$ 代入 (2) 式：\n$2w_1 + 4\\left(\\frac{1}{36}\\right) = \\frac{1}{3}$\n$2w_1 + \\frac{1}{9} = \\frac{1}{3}$\n$2w_1 = \\frac{3}{9} - \\frac{1}{9} = \\frac{2}{9}$\n$w_1 = \\frac{1}{9}$。\n\n最后，将 $w_1=1/9$ 和 $w_2=1/36$ 代入 (1) 式：\n$w_0 + 4\\left(\\frac{1}{9}\\right) + 4\\left(\\frac{1}{36}\\right) = 1$\n$w_0 + \\frac{4}{9} + \\frac{1}{9} = 1$\n$w_0 + \\frac{5}{9} = 1$\n$w_0 = 1 - \\frac{5}{9} = \\frac{4}{9}$。\n\n解为：$w_0 = 4/9$, $w_1 = 1/9$, $w_2 = 1/36$, and $c_s^2=1/3$。\n\n为完成任务，我们验证所得离散矩张量的各向同性。\n- **二阶张量：**\n$M_{ab} = \\sum_i w_i c_{i,a} c_{i,b}$。我们发现 $M_{xx}=M_{yy}=2w_1+4w_2 = 2(1/9)+4(1/36)=2/9+1/9=3/9=1/3$，并且 $M_{xy}=0$。\n因此，$M_{ab} = \\frac{1}{3}\\delta_{ab} = c_s^2 \\delta_{ab}$。这是各向同性二阶张量的一般形式，因此条件得到满足。\n\n- **四阶张量：**\n$M_{abcd} = \\sum_i w_i c_{i,a} c_{i,b} c_{i,c} c_{i,d}$。我们需要证明这与从高斯分布推导出的各向同性张量的形式相匹配，即 $\\langle \\xi_a \\xi_b \\xi_c \\xi_d \\rangle = c_s^4(\\delta_{ab}\\delta_{cd} + \\delta_{ac}\\delta_{bd} + \\delta_{ad}\\delta_{bc})$。\n使用我们推导出的值，$c_s^4 = (1/3)^2 = 1/9$。所以我们需要证明 $M_{abcd} = \\frac{1}{9}(\\delta_{ab}\\delta_{cd} + \\delta_{ac}\\delta_{bd} + \\delta_{ad}\\delta_{bc})$。\n我们来检查一下 $M_{abcd}$ 的唯一非零分量：\n  - $M_{xxxx} = 2w_1 + 4w_2 = 1/3$。各向同性形式给出 $c_s^4(\\delta_{xx}\\delta_{xx} + \\delta_{xx}\\delta_{xx} + \\delta_{xx}\\delta_{xx}) = c_s^4(1+1+1) = 3c_s^4 = 3(1/9) = 1/3$。这相匹配。\n  - $M_{xxyy} = 4w_2 = 4(1/36) = 1/9$。各向同性形式给出 $c_s^4(\\delta_{xx}\\delta_{yy} + \\delta_{xy}\\delta_ {xy} + \\delta_{xy}\\delta_{yx}) = c_s^4(1 \\cdot 1 + 0 + 0) = c_s^4 = 1/9$。这相匹配。\n  - $M_{xyxy} = \\sum_i w_i c_{i,x} c_{i,y} c_{i,x} c_{i,y} = \\sum_i w_i c_{i,x}^2 c_{i,y}^2 = M_{xxyy} = 1/9$。各向同性形式给出 $c_s^4(\\delta_{xy}\\delta_{xy} + \\delta_{xx}\\delta_{yy} + \\delta_{xy}\\delta_{yx}) = c_s^4(0 + 1 \\cdot 1 + 0) = c_s^4 = 1/9$。这相匹配。\n所有其他分量都可以通过对称性证明是匹配的。四阶矩张量确实在所要求的意义上是各向同性的。\n\n权重和格点声速平方的最终值为 $(w_0, w_1, w_2, c_s^2) = (4/9, 1/9, 1/36, 1/3)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{9} & \\frac{1}{9} & \\frac{1}{36} & \\frac{1}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在构建了离散的格子玻尔兹曼模型之后，一个至关重要的实际问题便是保证其数值稳定性。弛豫参数 $\\omega$（与弛豫时间 $\\tau$ 和时间步长 $\\Delta t$ 相关）的选择并非任意，不当的取值会导致模拟结果出现非物理振荡甚至发散。本练习运用傅里叶-冯·诺依曼分析方法，推导LBGK格式保持稳定的必要条件，从而确定 $\\omega$ 的允许范围 。",
            "id": "3737247",
            "problem": "考虑一种用于格子玻尔兹曼方法 (LBM) 的单弛豫时间格子Bhatnagar-Gross-Krook (LBGK) 格式，该格式源自 Bhatnagar-Gross-Krook (BGK) 碰撞算子。BGK 算子通过以下方式作用于粒子分布函数 $f(\\boldsymbol{x},\\boldsymbol{\\xi},t)$：\n$$\n\\mathcal{Q}(f) \\;=\\; -\\frac{1}{\\tau}\\,\\big(f - f^{\\mathrm{eq}}\\big),\n$$\n其中 $\\tau$ 是弛豫时间，$f^{\\mathrm{eq}}$ 是与守恒矩相符的局部麦克斯韦平衡态。在时间步长为 $\\Delta t$ 的标准流-撞离散化中，碰撞参数定义为 $\\omega = \\Delta t/\\tau$。假设一个具有离散速度 $\\{\\boldsymbol{c}_i\\}$、权重 $\\{w_i\\}$ 的规则格子，以及一个精确保持质量和动量矩的平衡态，以确保碰撞步骤使守恒矩保持不变。\n\n在具有恒定质量密度和零宏观速度的空间均匀平衡态附近对 LBGK 动力学进行线性化，考虑周期性边界条件，并对小扰动进行傅里叶-冯诺依曼分析。将迁移算子视为傅里叶模式空间上的酉算子，并将动力学分离为由线性化碰撞算子诱导的守恒和非守恒子空间。仅使用以下基本性质：(i) 守恒矩在碰撞中不变，以及 (ii) 非守恒矩以 BGK 算子决定的速率向平衡态弛豫，推导出非守恒模式的单步放大因子（用 $\\omega$ 表示），并在波数上一致地施加非扩张条件（谱半径不超过1），以避免因过弛豫引起的数值不稳定性。\n\n报告可保证线性化 LBGK 更新对所有傅里叶模式都具有非扩张性的最大允许弛豫参数 $\\omega$。你的最终答案必须是一个实数。不需要四舍五入，最终答案中也不应包含单位。",
            "solution": "问题要求解出在单弛豫时间格子Bhatnagar-Gross-Krook (LBGK) 格式中，能确保数值稳定性的弛豫参数 $\\omega$ 的最大允许值。稳定性需要通过对一个均匀、零速度平衡态附近的动力学进行线性化，并使用傅里叶-冯诺依曼分析来评估。\n\nLBGK 格式包含一个碰撞步和一个迁移步。对于一组离散的布居数 $\\{f_i(\\boldsymbol{x},t)\\}$，从时间 $t$ 到 $t+\\Delta t$ 的演化由下式给出：\n$$\nf_i(\\boldsymbol{x}+\\boldsymbol{c}_i \\Delta t, t+\\Delta t) = f_i(\\boldsymbol{x},t) - \\frac{1}{\\tau} \\Delta t \\left(f_i(\\boldsymbol{x},t) - f_i^{\\mathrm{eq}}(\\boldsymbol{x},t)\\right)\n$$\n引入碰撞参数 $\\omega = \\Delta t/\\tau$，该方程变为：\n$$\nf_i(\\boldsymbol{x}+\\boldsymbol{c}_i \\Delta t, t+\\Delta t) = f_i(\\boldsymbol{x},t) - \\omega \\left(f_i(\\boldsymbol{x},t) - f_i^{\\mathrm.eq}}(\\boldsymbol{x},t)\\right) = (1-\\omega)f_i(\\boldsymbol{x},t) + \\omega f_i^{\\mathrm{eq}}(\\boldsymbol{x},t)\n$$\n我们围绕一个恒定的平衡态 $f_i^{\\mathrm{eq},0}$ 对此方程进行线性化，该平衡态对应于恒定的密度 $\\rho_0$ 和零宏观速度 $\\boldsymbol{u}=\\boldsymbol{0}$。令 $f_i = f_i^{\\mathrm{eq},0} + \\delta f_i$。局部平衡分布 $f_i^{\\mathrm{eq}}$ 是局部宏观矩（例如密度 $\\rho$ 和动量 $\\boldsymbol{j}$）的函数，而这些宏观矩本身又是布居数 $f_i$ 的线性函数。因此，平衡分布中的扰动 $\\delta f_i^{\\mathrm{eq}} = f_i^{\\mathrm{eq}} - f_i^{\\mathrm{eq},0}$ 是布居数扰动 $\\delta f_j$ 的线性函数。这可以写成向量形式 $|\\delta f^{\\mathrm{eq}}\\rangle = \\mathbf{M} |\\delta f\\rangle$，其中 $\\mathbf{M}$ 是线性化的平衡投影矩阵。\n\n扰动 $|\\delta f\\rangle$ 的线性化 LBGK 方程为：\n$$\n|\\delta f(\\boldsymbol{x}+\\boldsymbol{c}\\Delta t, t+\\Delta t)\\rangle = (1-\\omega) |\\delta f(\\boldsymbol{x},t)\\rangle + \\omega |\\delta f^{\\mathrm{eq}}(\\boldsymbol{x},t)\\rangle = \\left((1-\\omega)\\mathbf{I} + \\omega\\mathbf{M}\\right) |\\delta f(\\boldsymbol{x},t)\\rangle\n$$\n令 $\\mathbf{L} = (1-\\omega)\\mathbf{I} + \\omega\\mathbf{M}$ 为线性化碰撞算子。方程为 $|\\delta f(\\boldsymbol{x}+\\boldsymbol{c}\\Delta t, t+\\Delta t)\\rangle = \\mathbf{L} |\\delta f(\\boldsymbol{x},t)\\rangle$。\n\n对于傅里叶-冯诺依曼分析，我们考虑单个傅里叶模式 $|\\delta f(\\boldsymbol{x},t)\\rangle = |\\widehat{\\delta f}_{\\boldsymbol{k}}(t)\\rangle e^{i\\boldsymbol{k}\\cdot\\boldsymbol{x}}$。将此代入线性化方程中，得到：\n$$\n|\\widehat{\\delta f}_{\\boldsymbol{k}}(t+\\Delta t)\\rangle e^{i\\boldsymbol{k}\\cdot(\\boldsymbol{x}+\\boldsymbol{c}\\Delta t)} = \\mathbf{L} |\\widehat{\\delta f}_{\\boldsymbol{k}}(t)\\rangle e^{i\\boldsymbol{k}\\cdot\\boldsymbol{x}}\n$$\n提出因子 $e^{i\\boldsymbol{k}\\cdot\\boldsymbol{x}}$ 并将与迁移相关的相位因子移到右侧，我们得到单步放大方程：\n$$\n|\\widehat{\\delta f}_{\\boldsymbol{k}}(t+\\Delta t)\\rangle = \\mathbf{S}(\\boldsymbol{k}) \\mathbf{L} |\\widehat{\\delta f}_{\\boldsymbol{k}}(t)\\rangle\n$$\n这里，$\\mathbf{S}(\\boldsymbol{k})$ 是傅里叶空间中的对角迁移矩阵，其元素为 $(\\mathbf{S}(\\boldsymbol{k}))_{ij} = \\delta_{ij} e^{-i\\boldsymbol{k}\\cdot\\boldsymbol{c}_i\\Delta t}$。问题指出迁移算子是酉算子，这与该形式一致，因为 $|e^{-i\\boldsymbol{k}\\cdot\\boldsymbol{c}_i\\Delta t}|=1$，使得 $\\mathbf{S}(\\boldsymbol{k})$ 成为一个酉矩阵。单步放大矩阵为 $\\mathbf{G}(\\boldsymbol{k}) = \\mathbf{S}(\\boldsymbol{k})\\mathbf{L}$。\n\n问题要求施加非扩张条件，这意味着对于任何波数 $\\boldsymbol{k}$，放大矩阵的谱半径 $\\rho(\\mathbf{G}(\\boldsymbol{k}))$ 都不能超过1。即，对于所有 $\\boldsymbol{k}$，$\\rho(\\mathbf{G}(\\boldsymbol{k})) \\le 1$。\n\n为确定 $\\mathbf{L}$ 的性质，我们遵循问题的指导，将动力学分离为守恒和非守恒子空间。\n1.  **守恒子空间**：BGK 碰撞算子的构造是为了守恒质量和动量。这意味着，如果 $|\\psi_c\\rangle$ 是布居数空间中对应于一个守恒量（一个“守恒模式”）的向量，则碰撞步不会改变其宏观值。对于线性化算子，这意味着守恒模式是 $\\mathbf{L}$ 的特征向量，特征值为 $1$。\n    $$ \\mathbf{L} |\\psi_c\\to = 1 \\cdot |\\psi_c\\to $$\n    这是因为对于一个守恒模式，扰动在该模式下已经处于“平衡”状态，所以 $\\mathbf{M}|\\psi_c\\rangle = |\\psi_c\\rangle$，这给出 $\\mathbf{L}|\\psi_c\\rangle = ((1-\\omega)\\mathbf{I} + \\omega\\mathbf{M})|\\psi_c\\rangle = (1-\\omega)|\\psi_c\\rangle + \\omega|\\psi_c\\rangle = |\\psi_c\\rangle$。\n\n2.  **非守恒子空间**：问题指出，非守恒矩以 BGK 算子决定的速率向平衡态弛豫。BGK 算子是 $\\mathcal{Q}(f) = -(f-f^{\\mathrm{eq}})/\\tau$。非守恒子空间中的一个模式 $|\\psi_{nc}\\rangle$ 代表了非守恒矩偏离平衡态的情况。该偏离的控制方程为 $\\frac{d}{dt}|\\psi_{nc}\\rangle = -\\frac{1}{\\tau}|\\psi_{nc}\\rangle$。对此方程进行一阶显式时间离散化，得到：\n    $$ |\\psi_{nc}(t+\\Delta t)\\rangle = |\\psi_{nc}(t)\\rangle - \\frac{\\Delta t}{\\tau}|\\psi_{nc}(t)\\rangle = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)|\\psi_{nc}(t)\\rangle = (1-\\omega)|\\psi_{nc}(t)\\rangle $$\n    这恰好是碰撞步对非守恒模式的作用。因此，非守恒子空间中的向量是 $\\mathbf{L}$ 的特征向量，其特征值为 $(1-\\omega)$。这就是非守恒模式的单步放大因子。\n\n因此，线性化碰撞算子 $\\mathbf{L}$ 的特征值为 1（对于守恒模式）和 $1-\\omega$（对于非守恒模式）。\n\n稳定性条件 $\\rho(\\mathbf{G}(\\boldsymbol{k})) \\le 1$ 必须对所有波数 $\\boldsymbol{k}$ 成立。此一致稳定性的一个必要条件是，系统在长波极限下（即 $\\boldsymbol{k}=\\boldsymbol{0}$）必须是稳定的。\n对于 $\\boldsymbol{k}=\\boldsymbol{0}$，迁移矩阵变成单位矩阵，$\\mathbf{S}(\\boldsymbol{0})=\\mathbf{I}$，因为 $e^{-i\\boldsymbol{0}\\cdot\\boldsymbol{c}_i\\Delta t} = 1$。\n此模式的放大矩阵为 $\\mathbf{G}(\\boldsymbol{0}) = \\mathbf{S}(\\boldsymbol{0})\\mathbf{L} = \\mathbf{I}\\mathbf{L} = \\mathbf{L}$。\n因此，$\\boldsymbol{k}=\\boldsymbol{0}$ 时的稳定性条件为 $\\rho(\\mathbf{L}) \\le 1$。\n\n$\\mathbf{L}$ 的谱半径是其特征值绝对值的最大值：\n$$\n\\rho(\\mathbf{L}) = \\max\\left\\{|1|, |1-\\omega|\\right\\}\n$$\n为了使 $\\rho(\\mathbf{L}) \\le 1$，我们必须有：\n$$\n\\max\\left\\{1, |1-\\omega|\\right\\} \\le 1\n$$\n这等价于条件 $|1-\\omega| \\le 1$。这个不等式可以分解为两部分：\n1.  $1-\\omega \\le 1 \\implies -\\omega \\le 0 \\implies \\omega \\ge 0$。\n2.  $1-\\omega \\ge -1 \\implies 2 \\ge \\omega \\implies \\omega \\le 2$。\n\n综合这些，稳定性的必要条件是 $0 \\le \\omega \\le 2$。\n如果 $\\omega > 2$，则 $|1-\\omega| > 1$，这意味着 $\\rho(\\mathbf{L}) > 1$。该格式对于 $\\boldsymbol{k}=\\boldsymbol{0}$ 模式是不稳定的，因此非扩张条件被违反。因此，任何大于 2 的 $\\omega$ 值都是不允许的。\n\n保证非扩张性的弛豫参数 $\\omega$ 的最大允许值是此有效范围的上界。",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}