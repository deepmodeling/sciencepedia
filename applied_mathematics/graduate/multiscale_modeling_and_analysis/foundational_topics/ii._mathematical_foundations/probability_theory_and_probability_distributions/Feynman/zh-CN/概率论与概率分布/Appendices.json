{
    "hands_on_practices": [
        {
            "introduction": "在多尺度建模中，估算罕见事件的概率至关重要，例如在可靠性分析或相变研究中。切尔诺夫界（Chernoff bound）通过优化矩母函数提供了一个强大的指数型界。这个练习将指导你从第一性原理出发，推导并应用这一基本技巧，从而加深对大偏差理论的理解。",
            "id": "3797860",
            "problem": "考虑一个多尺度可靠性模型，其中当足够多的微观层面组件失效时，会发生宏观层面的失效。设 $\\{X_{i}\\}_{i=1}^{N}$ 为独立同分布 (i.i.d.) 的伯努利随机变量，其参数为 $p \\in (0,1)$，表示 $N$ 个统计上均匀的微观域中的微观层面失效指标。宏观层面失效计数为 $S = \\sum_{i=1}^{N} X_{i}$。要求您仅从第一性原理出发，使用指数矩方法，为宏观尺度超出事件的概率设定一个界限，然后优化该界限。\n\n仅从矩生成函数 (MGF) 的定义 $\\mathbb{E}[\\exp(\\lambda X)]$ 和马尔可夫不等式出发，通过在 $\\lambda  0$ 上优化 MGF 倾斜参数 $\\lambda$，推导出以下形式的最紧指数上界：\n$$\n\\mathbb{P}(S \\geq a) \\leq \\inf_{\\lambda  0} \\exp\\big(-\\lambda a\\big) \\,\\mathbb{E}\\big[\\exp(\\lambda S)\\big]\n$$\n将您的推导具体应用于独立同分布的伯努利情况，并以闭式形式表示优化后的界。\n\n然后，在以下用于多尺度建模的科学现实设定中，对此界进行数值评估：\n- 微观域数量：$N = 5000$。\n- 微观层面失效概率：$p = 0.003$。\n- 超出阈值：$a = 30$。\n\n将最终的数值界限四舍五入到四位有效数字，并以无单位小数表示（不要使用百分号）。",
            "solution": "该问题要求推导概率 $\\mathbb{P}(S \\geq a)$ 的最紧指数上界，其中 $S$ 是 $N$ 个独立同分布 (i.i.d.) 的伯努利随机变量之和，$S = \\sum_{i=1}^{N} X_{i}$，且 $X_i \\sim \\text{Bernoulli}(p)$。推导必须从第一性原理出发，即马尔可夫不等式和矩生成函数 (MGF) 的定义。\n\n首先，我们陈述马尔可夫不等式。对于任何非负随机变量 $Y$ 和任何常数 $c  0$，不等式为：\n$$\n\\mathbb{P}(Y \\geq c) \\leq \\frac{\\mathbb{E}[Y]}{c}\n$$\n我们关注的事件是 $\\{S \\geq a\\}$。对于任何参数 $\\lambda  0$，此事件等价于事件 $\\{\\lambda S \\geq \\lambda a\\}$，由于指数函数是严格递增的，这又等价于 $\\{\\exp(\\lambda S) \\geq \\exp(\\lambda a)\\}$。\n\n让我们定义一个新的非负随机变量 $Y = \\exp(\\lambda S)$。我们可以将马尔可夫不等式应用于 $Y$，常数 $c = \\exp(\\lambda a)$：\n$$\n\\mathbb{P}(\\exp(\\lambda S) \\geq \\exp(\\lambda a)) \\leq \\frac{\\mathbb{E}[\\exp(\\lambda S)]}{\\exp(\\lambda a)}\n$$\n重写此不等式，我们得到 $\\mathbb{P}(S \\geq a)$ 的一个上界：\n$$\n\\mathbb{P}(S \\geq a) \\leq \\exp(-\\lambda a) \\mathbb{E}[\\exp(\\lambda S)]\n$$\n这个不等式对任何 $\\lambda  0$ 的选择都成立。为了获得这种形式下最紧的界，我们必须对右侧关于 $\\lambda$ 进行最小化。这就引出了切诺夫界：\n$$\n\\mathbb{P}(S \\geq a) \\leq \\inf_{\\lambda  0} \\left( \\exp(-\\lambda a) \\mathbb{E}[\\exp(\\lambda S)] \\right)\n$$\n项 $\\mathbb{E}[\\exp(\\lambda S)]$ 是随机变量 $S$ 的矩生成函数 (MGF)，记为 $M_S(\\lambda)$。由于 $S = \\sum_{i=1}^{N} X_{i}$ 且 $X_i$ 是独立同分布的，和的 MGF 是各个 MGF 的乘积：\n$$\nM_S(\\lambda) = \\mathbb{E}\\left[\\exp\\left(\\lambda \\sum_{i=1}^{N} X_i\\right)\\right] = \\mathbb{E}\\left[\\prod_{i=1}^{N} \\exp(\\lambda X_i)\\right] = \\prod_{i=1}^{N} \\mathbb{E}[\\exp(\\lambda X_i)] = \\left(M_X(\\lambda)\\right)^N\n$$\n其中 $M_X(\\lambda)$ 是单个伯努利随机变量 $X \\sim \\text{Bernoulli}(p)$ 的 MGF。我们根据其定义计算 $M_X(\\lambda)$：\n$$\nM_X(\\lambda) = \\mathbb{E}[\\exp(\\lambda X)] = \\mathbb{P}(X=0)\\exp(\\lambda \\cdot 0) + \\mathbb{P}(X=1)\\exp(\\lambda \\cdot 1) = (1-p) \\cdot 1 + p \\cdot \\exp(\\lambda) = 1 - p + p\\exp(\\lambda)\n$$\n因此，$S$ 的 MGF 为：\n$$\nM_S(\\lambda) = (1 - p + p\\exp(\\lambda))^N\n$$\n将此代回界的表达式中，我们需要找到：\n$$\n\\inf_{\\lambda  0} \\exp(-\\lambda a) (1 - p + p\\exp(\\lambda))^N\n$$\n为了找到下确界，我们最小化函数 $g(\\lambda) = \\exp(-\\lambda a) (1 - p + p\\exp(\\lambda))^N$。最小化其自然对数 $h(\\lambda) = \\ln(g(\\lambda))$ 更为容易：\n$$\nh(\\lambda) = -\\lambda a + N \\ln(1 - p + p\\exp(\\lambda))\n$$\n我们通过将关于 $\\lambda$ 的一阶导数设为零来找到临界点：\n$$\n\\frac{dh}{d\\lambda} = -a + N \\frac{p\\exp(\\lambda)}{1 - p + p\\exp(\\lambda)} = 0\n$$\n解出 $\\exp(\\lambda)$：\n$$\na = N \\frac{p\\exp(\\lambda)}{1 - p + p\\exp(\\lambda)} \\implies a(1 - p + p\\exp(\\lambda)) = Np\\exp(\\lambda)\n$$\n$$\na(1-p) = \\exp(\\lambda)(Np - ap) = p\\exp(\\lambda)(N-a)\n$$\n这给出了 $\\exp(\\lambda)$ 的最优值：\n$$\n\\exp(\\lambda^*) = \\frac{a(1-p)}{p(N-a)}\n$$\n因此，最优参数为 $\\lambda^* = \\ln\\left(\\frac{a(1-p)}{p(N-a)}\\right)$。为了使 $\\lambda^*$ 为正，我们需要其参数大于 $1$，这意味着 $a(1-p)  p(N-a) \\iff a  Np$。这意味着超出阈值 $a$ 必须大于 $S$ 的均值，这正是大偏差界有意义的范围。$h(\\lambda)$ 的二阶导数为 $h''(\\lambda) = N \\frac{p(1-p)\\exp(\\lambda)}{(1-p+p\\exp(\\lambda))^2}  0$（对于 $p \\in (0,1)$），这证实了 $\\lambda^*$ 对应一个最小值。\n\n现在，我们将 $\\exp(\\lambda^*)$ 代回界的表达式 $g(\\lambda)$ 中。该界为 $g(\\lambda^*) = (\\exp(\\lambda^*))^{-a} (1 - p + p\\exp(\\lambda^*))^N$。\n第一项是：\n$$\n(\\exp(\\lambda^*))^{-a} = \\left(\\frac{a(1-p)}{p(N-a)}\\right)^{-a} = \\left(\\frac{p(N-a)}{a(1-p)}\\right)^a\n$$\n第二项是：\n$$\n(1 - p + p\\exp(\\lambda^*))^N = \\left(1 - p + p\\frac{a(1-p)}{p(N-a)}\\right)^N = \\left(1 - p + \\frac{a(1-p)}{N-a}\\right)^N = \\left(\\frac{(1-p)(N-a) + a(1-p)}{N-a}\\right)^N = \\left(\\frac{N(1-p)}{N-a}\\right)^N\n$$\n结合这些项，优化后的界是：\n$$\n\\mathbb{P}(S \\geq a) \\leq \\left(\\frac{p(N-a)}{a(1-p)}\\right)^a \\left(\\frac{N(1-p)}{N-a}\\right)^N = \\frac{p^a (N-a)^a}{a^a (1-p)^a} \\frac{N^N (1-p)^N}{(N-a)^N} = \\left(\\frac{Np}{a}\\right)^a \\left(\\frac{N(1-p)}{N-a}\\right)^{N-a}\n$$\n这就是优化后的切诺夫界的闭式表达式。该表达式等价于 $\\exp(-N D_{KL}(a/N \\| p))$，其中 $D_{KL}(q \\| p)$ 是参数为 $q=a/N$ 和 $p$ 的两个伯努利分布之间的 Kullback-Leibler 散度。\n\n现在，我们为给定的数值计算这个界：\n- $N = 5000$\n- $p = 0.003$\n- $a = 30$\n\n首先，我们计算闭式表达式所需的组成部分：\n- 平均失效次数：$\\mathbb{E}[S] = Np = 5000 \\times 0.003 = 15$。条件 $a  Np$ 得到满足（$30  15$）。\n- $N-a = 5000 - 30 = 4970$。\n- $1-p = 1 - 0.003 = 0.997$。\n\n该界由以下公式给出：\n$$\nB = \\left(\\frac{15}{30}\\right)^{30} \\left(\\frac{5000 \\times 0.997}{4970}\\right)^{4970} = (0.5)^{30} \\left(\\frac{4985}{4970}\\right)^{4970}\n$$\n为了计算这个值，使用对数在数值上更稳定：\n$$\n\\ln(B) = 30 \\ln(0.5) + 4970 \\ln\\left(\\frac{4985}{4970}\\right)\n$$\n使用计算器获得高精度值：\n$$\n\\ln(0.5) \\approx -0.69314718\n$$\n$$\n\\ln\\left(\\frac{4985}{4970}\\right) = \\ln(1.00301810865...) \\approx 0.0030135800\n$$\n代入这些值：\n$$\n\\ln(B) \\approx 30 \\times (-0.69314718) + 4970 \\times (0.0030135800)\n$$\n$$\n\\ln(B) \\approx -20.7944154 + 14.9774926\n$$\n$$\n\\ln(B) \\approx -5.8169228\n$$\n界 $B$ 则是这个值的指数：\n$$\nB = \\exp(-5.8169228) \\approx 0.00297687\n$$\n将最终的数值界限四舍五入到四位有效数字，我们得到 $0.002977$。",
            "answer": "$$\n\\boxed{0.002977}\n$$"
        },
        {
            "introduction": "与指数衰减的轻尾分布不同，许多物理和复杂系统表现出由幂律主导的特性，即所谓的“重尾”现象，此时极端事件发生的可能性远高于预期。本练习旨在介绍正则变差（regular variation）这一严谨的数学框架，它是分析此类分布并确定其关键参数——尾指数（tail index）的核心工具。",
            "id": "3797810",
            "problem": "考虑一族用于总量波动的多尺度建模的重尾随机变量，其中跨尺度的大偏差由幂律衰减主导，并受到慢变修正的调制。在此背景下，我们通常研究生存函数尾部，定义为 $x \\mapsto \\mathbb{P}(X  x)$，及其在伸缩变换下的标度行为。\n\n(a) 对于一个实值随机变量 $X$ 的分布函数 $F$，请给出一个在无穷远处正则变化尾的数学精确定义。该定义需用生存函数 $x \\mapsto \\overline{F}(x) = 1 - F(x)$ 及其通过慢变函数的表示来表达。\n\n(b) 考虑以下当 $x \\geq \\exp(\\exp(1))$ 时的帕累托型生存函数尾部：\n$$\n\\overline{F}(x) \\;=\\; x^{-7/3} \\, (\\ln x)^{\\delta} \\, (\\ln\\!\\ln x)^{\\eta} \\left(1 + \\frac{1}{\\ln x}\\right),\n$$\n其中 $\\delta \\in \\mathbb{R}$ 和 $\\eta \\in \\mathbb{R}$ 是固定常数。利用渐近等价论证和 Karamata 的正则变化特征定理，确定与此生存函数相关的尾指数 $\\alpha$，该指数由主导尾部尺度变换的幂律指数定义。\n\n你的最终答案必须是一个实数（无需单位）。无需四舍五入，请给出精确值。",
            "solution": "### (a)部分：正则变化尾的定义\n\n对于某个 $a0$，如果一个函数 $L: [a, \\infty) \\to (0, \\infty)$ 对任意常数 $t  0$ 都满足以下条件，则称该函数**在无穷远处慢变化**：\n$$\n\\lim_{x \\to \\infty} \\frac{L(tx)}{L(x)} = 1\n$$\n如果一个函数 $g: [a, \\infty) \\to (0, \\infty)$ 对任意常数 $t  0$ 都满足以下条件，则称该函数**在无穷远处以指数** $\\rho \\in \\mathbb{R}$ **正则变化**：\n$$\n\\lim_{x \\to \\infty} \\frac{g(tx)}{g(x)} = t^{\\rho}\n$$\n根据 Karamata 特征定理，一个函数 $g$ 以指数 $\\rho$ 正则变化，当且仅当它可以表示为 $g(x) = x^{\\rho} L(x)$ 的形式，其中 $L(x)$ 是一个慢变函数。\n\n如果一个具有分布函数 $F$ 的实值随机变量 $X$ 的生存函数 $\\overline{F}(x) = \\mathbb{P}(X  x)$ 是一个在无穷远处以某个指数 $-\\alpha$（其中 $\\alpha  0$）正则变化的函数，则称该随机变量具有**在无穷远处的正则变化尾**。常数 $\\alpha$ 被称为该分布的**尾指数**。\n\n因此，数学上精确的定义是：如果分布函数 $F$ 的生存函数可以写成以下形式，则称其具有尾指数为 $\\alpha  0$ 的正则变化尾：\n$$\n\\overline{F}(x) = x^{-\\alpha} L(x)\n$$\n其中 $L(x)$ 是一个在无穷远处慢变化的函数。\n\n### (b)部分：确定尾指数 $\\alpha$\n\n给定当 $x \\geq \\exp(\\exp(1))$ 时的生存函数：\n$$\n\\overline{F}(x) = x^{-7/3} (\\ln x)^{\\delta} (\\ln\\ln x)^{\\eta} \\left(1 + \\frac{1}{\\ln x}\\right)\n$$\n我们的目标是确定尾指数 $\\alpha$。为此，我们必须将 $\\overline{F}(x)$ 表示为标准形式 $\\overline{F}(x) = x^{-\\alpha} L(x)$，其中 $L(x)$ 是一个慢变函数。\n\n通过直接观察，我们可以将给定函数分解如下：\n$$\n\\overline{F}(x) = x^{-7/3} \\cdot \\left[ (\\ln x)^{\\delta} (\\ln\\ln x)^{\\eta} \\left(1 + \\frac{1}{\\ln x}\\right) \\right]\n$$\n这表明尾指数 $\\alpha$ 可能为 $7/3$。为证实这一点，我们必须严格验证方括号中的项是一个慢变函数。我们定义：\n$$\nL(x) = (\\ln x)^{\\delta} (\\ln\\ln x)^{\\eta} \\left(1 + \\frac{1}{\\ln x}\\right)\n$$\n我们依赖于慢变函数的以下既定性质：\n$1$. 如果 $L_1(x)$ 和 $L_2(x)$ 是慢变函数，那么它们的乘积 $L_1(x)L_2(x)$ 也是慢变函数。\n$2$. 对于任意实数 $p$，如果 $L(x)$ 是慢变函数，那么 $(L(x))^p$ 也是慢变函数。\n$3$. 任何当 $x \\to \\infty$ 时收敛到一个正常数的函数都是慢变函数。\n$4$. 函数 $\\ln x$ 是慢变函数。\n\n让我们分析 $L(x)$ 的各个组成部分：\n- **组成部分1**：考虑函数 $f_1(x) = \\ln x$。为证明其为慢变函数，我们对任意 $t0$ 计算极限：\n  $$\n  \\lim_{x \\to \\infty} \\frac{\\ln(tx)}{\\ln x} = \\lim_{x \\to \\infty} \\frac{\\ln t + \\ln x}{\\ln x} = \\lim_{x \\to \\infty} \\left( \\frac{\\ln t}{\\ln x} + 1 \\right) = 0 + 1 = 1\n  $$\n  由于 $\\ln x$ 是慢变函数，根据性质2，函数 $L_1(x) = (\\ln x)^{\\delta}$ 对任意 $\\delta \\in \\mathbb{R}$ 也都是慢变函数。\n\n- **组成部分2**：考虑函数 $f_2(x) = \\ln(\\ln x)$。为证明其为慢变函数，我们对任意 $t0$ 计算极限：\n  $$\n  \\lim_{x \\to \\infty} \\frac{\\ln(\\ln(tx))}{\\ln(\\ln x)} = \\lim_{x \\to \\infty} \\frac{\\ln(\\ln t + \\ln x)}{\\ln(\\ln x)} = \\lim_{x \\to \\infty} \\frac{\\ln\\left(\\ln x \\left(1 + \\frac{\\ln t}{\\ln x}\\right)\\right)}{\\ln(\\ln x)}\n  $$\n  $$\n  = \\lim_{x \\to \\infty} \\frac{\\ln(\\ln x) + \\ln\\left(1 + \\frac{\\ln t}{\\ln x}\\right)}{\\ln(\\ln x)} = \\lim_{x \\to \\infty} \\left(1 + \\frac{\\ln\\left(1 + \\frac{\\ln t}{\\ln x}\\right)}{\\ln(\\ln x)}\\right)\n  $$\n  当 $x \\to \\infty$ 时, $\\ln x \\to \\infty$, 所以 $\\frac{\\ln t}{\\ln x} \\to 0$。这意味着 $\\ln\\left(1 + \\frac{\\ln t}{\\ln x}\\right) \\to \\ln(1) = 0$。分母 $\\ln(\\ln x) \\to \\infty$。因此，该分数趋于 $0$，总极限为 $1$。由于 $\\ln(\\ln x)$ 是慢变函数，根据性质2，函数 $L_2(x) = (\\ln(\\ln x))^{\\eta}$ 对任意 $\\eta \\in \\mathbb{R}$ 也都是慢变函数。\n\n- **组成部分3**：考虑函数 $L_3(x) = 1 + \\frac{1}{\\ln x}$。我们计算其当 $x \\to \\infty$ 时的极限：\n  $$\n  \\lim_{x \\to \\infty} \\left(1 + \\frac{1}{\\ln x}\\right) = 1+0 = 1\n  $$\n  由于该函数收敛到一个正常数($1$)，根据性质3，它是慢变函数。\n\n由于 $L(x)$ 是三个慢变函数 $L_1(x) L_2(x) L_3(x)$ 的乘积，根据性质1，它本身也是一个慢变函数。\n\n我们已成功将生存函数表示为 $\\overline{F}(x) = x^{-\\alpha} L(x)$ 的形式，其中 $L(x)$ 是一个慢变函数。通过比较\n$$\n\\overline{F}(x) = x^{-7/3} L(x)\n$$\n与一般形式 $\\overline{F}(x) = x^{-\\alpha} L(x)$，我们可以直接确定尾指数 $\\alpha$。\n\n尾指数为 $\\alpha = 7/3$。",
            "answer": "$$\\boxed{\\frac{7}{3}}$$"
        },
        {
            "introduction": "掌握了分布的特性后，一个核心的实践问题是如何有效地从中抽样，尤其是在高维或复杂能量景观的情况下。本练习将理论与计算相结合，通过比较可逆与不可逆朗之万（Langevin）动力学两种马尔可夫链蒙特卡洛（MCMC）算法，探索算法设计对采样效率的影响。你将通过推导和计算遍历均值的渐近方差，来量化和理解不同抽样策略的性能。",
            "id": "3797867",
            "problem": "考虑$\\mathbb{R}^d$上的一个目标概率分布，其密度正比于$\\exp\\!\\left(-U(x)\\right)$，其中$U(x) = \\tfrac{1}{2} x^\\top x$。我们考虑两种基于朗之万动力学的马尔可夫链蒙特卡洛（MCMC）算法：一种可逆方案和一种不可逆方案。可逆方案是未经调整的朗之万算法（Unadjusted Langevin Algorithm, ULA）。不可逆方案通过一个恒定的斜对称矩阵来增强漂移项。设$h \\in (0,2)$为一个时间步长，设$J \\in \\mathbb{R}^{d \\times d}$为一个斜对称矩阵（即$J^\\top = -J$），并设$\\{\\xi_k\\}_{k \\geq 0}$为$\\mathbb{R}^d$中独立同分布的标准正态向量。定义更新\n$$\nX^{\\mathrm{rev}}_{k+1} = X^{\\mathrm{rev}}_{k} - h \\, X^{\\mathrm{rev}}_{k} + \\sqrt{2 h} \\, \\xi_k,\n\\qquad\nX^{\\mathrm{nonrev}}_{k+1} = X^{\\mathrm{nonrev}}_{k} - h \\, \\left(I + J\\right) X^{\\mathrm{nonrev}}_{k} + \\sqrt{2 h} \\, \\xi_k,\n$$\n其中$I$是$\\mathbb{R}^{d \\times d}$中的单位矩阵。两者各自在$\\mathbb{R}^d$上定义了一个线性的、时齐的、高斯的马尔可夫链，当线性更新映射的谱半径严格小于$1$时，该链是稳定的。对于每个链，将线性映射记为$B \\in \\mathbb{R}^{d \\times d}$，从而$X_{k+1} = B X_k + \\epsilon_k$，其中$\\epsilon_k$是均值为零、协方差为$Q = 2 h I$的高斯噪声，且$B^{\\mathrm{rev}} = I - h I$，$B^{\\mathrm{nonrev}} = I - h (I + J)$。\n\n设$f(x) = a^\\top x$为某个$a \\in \\mathbb{R}^d$的固定线性泛函。定义遍历均值$\\overline{f}_n = \\tfrac{1}{n} \\sum_{k=0}^{n-1} f(X_k)$。在几何遍历马尔可夫链和具有有限方差的中心化可观测量$f$的标准条件下，马尔可夫链的中心极限定理（CLT）指出，$\\sqrt{n}\\left(\\overline{f}_n - \\pi(f)\\right)$在分布上收敛到一个均值为零、渐近方差为$\\sigma^2$的正态随机变量，其中$\\pi(f)$表示$f$在平稳分布下的期望。根据定义，遍历均值的渐近方差$\\sigma^2$由$f(X_k)$的滞后自协方差级数表征：\n$$\n\\sigma^2 = \\operatorname{Var}_\\pi\\!\\left(f(X_0)\\right) + 2 \\sum_{k=1}^{\\infty} \\operatorname{Cov}_\\pi\\!\\left(f(X_0), f(X_k)\\right),\n$$\n假设该级数绝对收敛。\n\n任务：\n- 从上述定义和线性高斯结构$X_{k+1} = B X_k + \\epsilon_k$（其中$\\epsilon_k$独立于$X_k$）出发，推导平稳协方差$\\Sigma \\in \\mathbb{R}^{d \\times d}$作为离散李雅普诺夫方程$\\,\\Sigma = B \\Sigma B^\\top + Q\\,$的解，以及平稳状态下的滞后$k$阶互协方差$\\Gamma_k = \\mathbb{E}\\!\\left[X_0 X_k^\\top\\right]$。\n- 仅使用线性系统的基本性质和谱半径严格小于$1$的矩阵几何级数，推导遍历均值$\\overline{f}_n$的渐近方差$\\sigma^2$关于$B$、$Q$和$a$的闭式表达式，不得引入任何快捷公式。\n- 实现一个程序，给定$d$、$h$、$J$和$a$，通过求解离散李雅普诺夫方程并通过绝对收敛所保证的矩阵求逆恒等式对隐含级数求和，计算可逆和不可逆两种方案的渐近方差$\\sigma^2$。\n\n要求与规格：\n- 对于每种情况，计算可逆方案和不可逆方案的渐近方差$\\sigma^2$。不涉及物理单位；数值答案必须是实数（浮点数）。\n- 对每个测试用例，使用所提供的$a$对应的线性可观测量$f(x) = a^\\top x$。\n- 斜对称矩阵$J$必须构造成块对角形式，其$2 \\times 2$块的形式为$\\begin{pmatrix} 0  -\\alpha \\\\ \\alpha  0 \\end{pmatrix}$，使用指定的不可逆强度$\\alpha \\in \\mathbb{R}$；如果$d$大于$2$，则重复该块直到填满维度，如果$d$为奇数，则最后一个元素为$0$。\n- 确保在每种情况下$B$的谱半径都严格小于$1$，从而使得离散李雅普诺夫方程有唯一的对称正定解$\\Sigma$，并且推导中的几何级数绝对收敛。\n- 为以下测试套件提供结果，该套件涵盖了一般情况、边界稳定性情况、高维情况和小步长机制：\n    1. $d = 2$, $h = 0.3$, $\\alpha = 0.8$, $a = (1.0, 0.0)$。\n    2. $d = 2$, $h = 1.9$, $\\alpha = 0.0$, $a = (1.0, 0.0)$。\n    3. $d = 4$, $h = 0.2$, $\\alpha = 2.0$, $a = \\tfrac{1}{\\sqrt{2}}(1.0, 1.0, 0.0, 0.0)$。\n    4. $d = 2$, $h = 0.05$, $\\alpha = 1.5$, $a = (0.0, 1.0)$。\n- 对于每个测试用例，输出两个浮点数：可逆链的渐近方差和不可逆链的渐近方差，按此顺序排列。将所有结果汇总到一行，格式为方括号内的逗号分隔列表，顺序为$[\\sigma^2_{\\mathrm{rev},1}, \\sigma^2_{\\mathrm{nonrev},1}, \\sigma^2_{\\mathrm{rev},2}, \\sigma^2_{\\mathrm{nonrev},2}, \\sigma^2_{\\mathrm{rev},3}, \\sigma^2_{\\mathrm{nonrev},3}, \\sigma^2_{\\mathrm{rev},4}, \\sigma^2_{\\mathrm{nonrev},4}]$。\n- 输出中的每个浮点数必须四舍五入到八位小数。你的程序必须产生与指定格式完全匹配的一行输出。",
            "solution": "MCMC更新在$\\mathbb{R}^d$上定义了一个线性的、时齐的高斯马尔可夫链，形式如下：\n$$\nX_{k+1} = B X_k + \\epsilon_k\n$$\n其中$\\epsilon_k \\sim \\mathcal{N}(0, Q)$是独立同分布的高斯噪声向量，独立于$X_k$。噪声协方差为$Q = 2hI$。问题指出链是稳定的，这意味着更新矩阵$B$的谱半径（记为$\\rho(B)$）严格小于$1$。\n\n在此稳定性条件下，该马尔可夫链是几何遍历的，并拥有一个唯一的平稳分布。由于过程是线性的且噪声是高斯的，平稳分布也是高斯分布，记为$\\mathcal{N}(\\mu, \\Sigma)$。\n\n平稳均值$\\mu$必须是均值动力学的固定点：\n$$\n\\mu = \\mathbb{E}[X_{k+1}] = \\mathbb{E}[B X_k + \\epsilon_k] = B \\mathbb{E}[X_k] + \\mathbb{E}[\\epsilon_k] = B\\mu + 0\n$$\n这给出了方程$(I-B)\\mu = 0$。由于$\\rho(B)  1$，矩阵$I-B$是可逆的，这意味着唯一解是$\\mu=0$。这与目标分布$\\mathcal{N}(0, I)$的均值为零是一致的。因此，可观测量$f(x) = a^\\top x$在平稳分布$\\pi$下的期望为$\\pi(f) = \\mathbb{E}_\\pi[a^\\top x] = a^\\top \\mu = 0$。\n\n平稳协方差矩阵$\\Sigma$是通过在平稳假设$\\operatorname{Cov}(X_k) = \\operatorname{Cov}(X_{k+1}) = \\Sigma$下考虑$X_{k+1}$的协方差来推导的。\n$$\n\\Sigma = \\operatorname{Cov}(X_{k+1}) = \\operatorname{Cov}(B X_k + \\epsilon_k)\n$$\n由于$X_k$和$\\epsilon_k$是独立的，协方差相加：\n$$\n\\Sigma = \\operatorname{Cov}(B X_k) + \\operatorname{Cov}(\\epsilon_k) = B \\operatorname{Cov}(X_k) B^\\top + Q = B \\Sigma B^\\top + Q\n$$\n这就得到了关于平稳协方差$\\Sigma$的离散时间李雅普诺夫方程：\n$$\n\\Sigma = B \\Sigma B^\\top + Q\n$$\n条件$\\rho(B)  1$保证了该方程有唯一的对称正定解$\\Sigma$，该解可以表示为收敛级数$\\Sigma = \\sum_{j=0}^{\\infty} B^j Q (B^\\top)^j$。\n\n接下来，我们推导平稳状态下的滞后$k$阶互协方差矩阵$\\Gamma_k = \\operatorname{Cov}(X_0, X_k)$。由于均值为零，$\\Gamma_k = \\mathbb{E}[X_0 X_k^\\top]$。\n对于$k \\ge 1$，我们可以写出$X_k = B X_{k-1} + \\epsilon_{k-1}$。\n$$\n\\Gamma_k = \\mathbb{E}[X_0 X_k^\\top] = \\mathbb{E}[X_0 (B X_{k-1} + \\epsilon_{k-1})^\\top] = \\mathbb{E}[X_0 X_{k-1}^\\top B^\\top] + \\mathbb{E}[X_0 \\epsilon_{k-1}^\\top]\n$$\n由于$X_0$依赖于$t  0$时刻的噪声，而$\\epsilon_{k-1}$是非负时刻的噪声，所以它们是独立的。因此，$\\mathbb{E}[X_0 \\epsilon_{k-1}^\\top] = \\mathbb{E}[X_0]\\mathbb{E}[\\epsilon_{k-1}]^\\top = 0$。这导出了递推关系：\n$$\n\\Gamma_k = \\mathbb{E}[X_0 X_{k-1}^\\top] B^\\top = \\Gamma_{k-1} B^\\top\n$$\n从$\\Gamma_0 = \\mathbb{E}[X_0 X_0^\\top] = \\Sigma$开始，我们可以展开递推关系得到：\n$$\n\\Gamma_k = \\Sigma (B^\\top)^k \\quad \\text{对于 } k \\ge 0\n$$\n\n对于标量过程$Y_k = f(X_k) = a^\\top X_k$，其遍历均值$\\overline{f}_n = \\tfrac{1}{n} \\sum_{k=0}^{n-1} f(X_k)$的渐近方差由所有自协方差之和给出：\n$$\n\\sigma^2 = \\sum_{k=-\\infty}^{\\infty} \\operatorname{Cov}_\\pi(Y_0, Y_k) = \\operatorname{Var}_\\pi(Y_0) + 2 \\sum_{k=1}^{\\infty} \\operatorname{Cov}_\\pi(Y_0, Y_k)\n$$\n方差项为：\n$$\n\\operatorname{Var}_\\pi(Y_0) = \\operatorname{Var}_\\pi(a^\\top X_0) = a^\\top \\operatorname{Cov}_\\pi(X_0) a = a^\\top \\Sigma a\n$$\n对于$k \\ge 1$的自协方差项为：\n$$\n\\operatorname{Cov}_\\pi(Y_0, Y_k) = \\operatorname{Cov}_\\pi(a^\\top X_0, a^\\top X_k) = a^\\top \\operatorname{Cov}_\\pi(X_0, X_k) a = a^\\top \\Gamma_k a = a^\\top \\Sigma (B^\\top)^k a\n$$\n将这些代入$\\sigma^2$的公式中：\n$$\n\\sigma^2 = a^\\top \\Sigma a + 2 \\sum_{k=1}^{\\infty} a^\\top \\Sigma (B^\\top)^k a\n$$\n我们可以提出向量$a$和$a^\\top$：\n$$\n\\sigma^2 = a^\\top \\left( \\Sigma + 2 \\sum_{k=1}^{\\infty} \\Sigma (B^\\top)^k \\right) a = a^\\top \\left( \\Sigma + 2 \\Sigma \\left(\\sum_{k=1}^{\\infty} (B^\\top)^k\\right) \\right) a\n$$\n该和是一个矩阵几何级数。由于$\\rho(B)  1$，我们也有$\\rho(B^\\top)  1$，并且级数$\\sum_{k=0}^{\\infty} M^k$收敛于$(I-M)^{-1}$。因此，从$k=1$开始的和为：\n$$\n\\sum_{k=1}^{\\infty} (B^\\top)^k = \\left( \\sum_{k=0}^{\\infty} (B^\\top)^k \\right) - (B^\\top)^0 = (I - B^\\top)^{-1} - I\n$$\n将此结果代回$\\sigma^2$的表达式中：\n$$\n\\sigma^2 = a^\\top \\left( \\Sigma + 2 \\Sigma \\left( (I - B^\\top)^{-1} - I \\right) \\right) a\n$$\n$$\n\\sigma^2 = a^\\top \\left( \\Sigma + 2 \\Sigma (I - B^\\top)^{-1} - 2\\Sigma \\right) a\n$$\n这可以简化为渐近方差的最终闭式表达式：\n$$\n\\sigma^2 = a^\\top \\left( 2 \\Sigma (I-B^\\top)^{-1} - \\Sigma \\right) a\n$$\n只要稳定性条件$\\rho(B)  1$成立，此表达式对可逆和不可逆方案均有效。实现过程将通过首先构建相应的矩阵$B^{\\mathrm{rev}}$和$B^{\\mathrm{nonrev}}$，然后分别为它们求解离散李雅普诺夫方程得到$\\Sigma^{\\mathrm{rev}}$和$\\Sigma^{\\mathrm{nonrev}}$，最后应用推导出的公式来计算两种方案的$\\sigma^2$。\n\n对于可逆情况（$B = (1-h)I$），我们可以得到一个简单的解析公式：\n$$\n\\sigma^2_{\\mathrm{rev}} = \\frac{2}{h} a^\\top a\n$$\n这个解析结果可以用来验证可逆情况下的数值实现。",
            "answer": "[6.66666667,3.65653401,1.05263158,1.05263158,10.00000000,3.38461538,40.00000000,12.60721477]"
        }
    ]
}