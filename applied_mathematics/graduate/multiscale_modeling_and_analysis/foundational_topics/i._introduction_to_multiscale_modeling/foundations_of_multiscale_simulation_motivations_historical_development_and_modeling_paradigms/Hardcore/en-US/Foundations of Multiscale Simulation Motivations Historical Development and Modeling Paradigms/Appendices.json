{
    "hands_on_practices": [
        {
            "introduction": "Multiscale phenomena are defined by the coexistence of important processes at vastly different length and time scales. This exercise reveals the fundamental computational challenge that arises from this separation. By analyzing the simple diffusion equation, you will use dimensional analysis to demonstrate how a separation in length scales creates a computationally prohibitive separation in time scales, motivating the need for specialized multiscale algorithms. ",
            "id": "3761869",
            "problem": "A conserved scalar concentration field $u(\\mathbf{x}, t)$ undergoes diffusion in a homogeneous medium characterized by a constant molecular diffusivity $D$. The evolution of $u$ is governed by the diffusion partial differential equation (PDE)\n$$\n\\frac{\\partial u}{\\partial t} = D \\nabla^2 u,\n$$\nwhere $\\mathbf{x} \\in \\mathbb{R}^3$ and $t \\ge 0$. In multiscale modeling and analysis, the same physical process may need to be resolved at a microscopic length scale $L_{\\mathrm{micro}}$ and a macroscopic length scale $L_{\\mathrm{macro}}$, with $L_{\\mathrm{macro}} \\gg L_{\\mathrm{micro}}$, using a single underlying diffusivity $D$. \n\nStarting from the diffusion PDE and using only fundamental dimensional and scaling arguments, determine the characteristic diffusive time scale associated with a generic length scale $L$. Then, define the dimensionless ratio \n$$\nS \\equiv \\frac{t_{\\mathrm{macro}}}{t_{\\mathrm{micro}}},\n$$\nwhere $t_{\\mathrm{micro}}$ and $t_{\\mathrm{macro}}$ are the characteristic diffusive times at $L_{\\mathrm{micro}}$ and $L_{\\mathrm{macro}}$, respectively. State the condition, in terms of $S$, under which a time integrator that must resolve the fastest diffusive dynamics would necessarily require disparate time steps between micro and macro models in a multiscale simulation.\n\nFinally, evaluate $S$ numerically for \n- $L_{\\mathrm{micro}} = 1.0 \\times 10^{-7}\\ \\mathrm{m}$, \n- $L_{\\mathrm{macro}} = 1.0 \\times 10^{-2}\\ \\mathrm{m}$,\n- $D = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$.\n\nReport your final answer as the numerical value of $S$ rounded to three significant figures. The ratio $S$ is dimensionless; do not include units in your final answer.",
            "solution": "The first step is to determine the characteristic diffusive time scale, $t$, associated with a generic length scale, $L$, using the provided partial differential equation (PDE). The diffusion equation is given by\n$$\n\\frac{\\partial u}{\\partial t} = D \\nabla^2 u\n$$\nWe perform a dimensional analysis on this equation. Let $[X]$ denote the physical dimensions of a quantity $X$. We use $T$ for time and $L$ for length. The dimension of the concentration field, $[u]$, is not needed as it will cancel.\n\nThe left-hand side term, $\\frac{\\partial u}{\\partial t}$, represents a rate of change of concentration with time. Its dimensions are\n$$\n\\left[\\frac{\\partial u}{\\partial t}\\right] = \\frac{[u]}{[t]} = \\frac{[u]}{T}\n$$\nThe Laplacian operator, $\\nabla^2$, involves second spatial derivatives, e.g., $\\frac{\\partial^2}{\\partial x^2}$. Its dimensions are $L^{-2}$. Thus, the dimensions of the right-hand side term are\n$$\n[D \\nabla^2 u] = [D] [\\nabla^2] [u] = [D] \\frac{[u]}{L^2}\n$$\nFor the PDE to be dimensionally consistent, the dimensions of both sides must be equal:\n$$\n\\frac{[u]}{T} = [D] \\frac{[u]}{L^2}\n$$\nThe dimension $[u]$ cancels, leaving a relationship between the dimensions of diffusivity, length, and time:\n$$\n\\frac{1}{T} = \\frac{[D]}{L^2} \\implies [D] = \\frac{L^2}{T}\n$$\nThis confirms that the units of diffusivity are length squared per unit time (e.g., $\\mathrm{m}^2/\\mathrm{s}$), consistent with the given value.\n\nTo find the characteristic time scale, $t_{\\mathrm{char}}$, that governs diffusion over a characteristic length scale, $L_{\\mathrm{char}}$, we rearrange this dimensional relationship to solve for a quantity with the dimension of time. From $[D] = L^2/T$, it is clear that a time scale can be constructed as:\n$$\nt_{\\mathrm{char}} \\propto \\frac{L_{\\mathrm{char}}^2}{D}\n$$\nFor scaling arguments, we can take the proportionality constant to be $1$. Therefore, the characteristic diffusive time scale associated with a length scale $L$ is given by\n$$\nt = \\frac{L^2}{D}\n$$\nNow, we apply this relationship to the microscopic and macroscopic scales defined in the problem. The characteristic times are:\n$$\nt_{\\mathrm{micro}} = \\frac{L_{\\mathrm{micro}}^2}{D}\n$$\n$$\nt_{\\mathrm{macro}} = \\frac{L_{\\mathrm{macro}}^2}{D}\n$$\nThe problem defines the dimensionless ratio $S$ as\n$$\nS \\equiv \\frac{t_{\\mathrm{macro}}}{t_{\\mathrm{micro}}}\n$$\nSubstituting the expressions for $t_{\\mathrm{micro}}$ and $t_{\\mathrm{macro}}$ yields\n$$\nS = \\frac{\\left(\\frac{L_{\\mathrm{macro}}^2}{D}\\right)}{\\left(\\frac{L_{\\mathrm{micro}}^2}{D}\\right)} = \\left(\\frac{L_{\\mathrm{macro}}}{L_{\\mathrm{micro}}}\\right)^2\n$$\nNotice that the diffusivity $D$ cancels out, meaning the ratio of time scales depends only on the ratio of length scales.\n\nThe problem asks for the condition under which a time integrator would require disparate time steps. A multiscale simulation must be able to capture phenomena at all relevant scales. For numerical stability and accuracy, especially with explicit time integration schemes, the time step $\\Delta t$ must be small enough to resolve the fastest dynamics in the system. The fastest dynamics occur over the shortest length scales, and thus are associated with the shortest characteristic time, $t_{\\mathrm{micro}}$. The CFL (Courant-Friedrichs-Lewy) condition for the diffusion equation requires $\\Delta t \\propto (\\Delta x)^2/D$, where $\\Delta x$ is the grid spacing. In our context, $\\Delta x$ corresponds to $L_{\\mathrm{micro}}$, so we must have $\\Delta t \\lesssim t_{\\mathrm{micro}}$.\n\nTo simulate the system long enough to observe the evolution at the macroscale, the total simulation time must be on the order of $t_{\\mathrm{macro}}$. The total number of time steps, $N$, required would be\n$$\nN \\approx \\frac{t_{\\mathrm{macro}}}{\\Delta t} \\gtrsim \\frac{t_{\\mathrm{macro}}}{t_{\\mathrm{micro}}} = S\n$$\nThe problem of disparate time steps arises when the required time step $\\Delta t$ is vastly smaller than the overall time scale of interest, $t_{\\mathrm{macro}}$. This situation corresponds to the number of required steps $N$ being very large, which makes the simulation computationally prohibitive. This occurs when $t_{\\mathrm{macro}} \\gg t_{\\mathrm{micro}}$. The condition, expressed in terms of $S$, is therefore\n$$\nS \\gg 1\n$$\nThis condition signifies a \"stiff\" problem, where an extreme separation of time scales exists, making standard explicit integration methods inefficient.\n\nFinally, we evaluate $S$ numerically using the provided values:\n- $L_{\\mathrm{micro}} = 1.0 \\times 10^{-7}\\ \\mathrm{m}$\n- $L_{\\mathrm{macro}} = 1.0 \\times 10^{-2}\\ \\mathrm{m}$\n\nSubstituting these values into the expression for $S$:\n$$\nS = \\left(\\frac{1.0 \\times 10^{-2}}{1.0 \\times 10^{-7}}\\right)^2\n$$\nFirst, we evaluate the ratio of the length scales:\n$$\n\\frac{L_{\\mathrm{macro}}}{L_{\\mathrm{micro}}} = \\frac{1.0 \\times 10^{-2}}{1.0 \\times 10^{-7}} = 1.0 \\times 10^{-2 - (-7)} = 1.0 \\times 10^5\n$$\nNow, we square this ratio:\n$$\nS = (1.0 \\times 10^5)^2 = (1.0)^2 \\times (10^5)^2 = 1.0 \\times 10^{10}\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\nS = 1.00 \\times 10^{10}\n$$\nThis extremely large value of $S$ confirms that the system is exceptionally stiff, and a multiscale simulation would indeed face a severe challenge due to the vast disparity in time scales. An explicit time integrator would require on the order of $10^{10}$ steps to resolve the microscale dynamics while simulating up to the macroscale characteristic time. This motivates the development of specialized multiscale modeling paradigms.",
            "answer": "$$\\boxed{1.00 \\times 10^{10}}$$"
        },
        {
            "introduction": "One of the principal goals of multiscale modeling is to derive effective macroscopic laws that encapsulate complex microscale physics. This practice guides you through a cornerstone technique: periodic homogenization. You will implement a numerical solver for a microscale \"cell problem\" to compute an effective diffusion coefficient, providing a hands-on experience in how macroscopic model parameters can be systematically derived from underlying fine-scale details. ",
            "id": "3761830",
            "problem": "Consider a periodic porous medium modeled at the microscale by a unit cell $Y = [0,1]^2$ with dimensionless coordinates $y = (y_x,y_y)$. Diffusion occurs in the void phase with a spatially varying, dimensionless diffusion coefficient $D(y) > 0$, while linear reaction in the void introduces a dimensionless rate $\\lambda \\ge 0$ (arising from scaling the physical reaction rate by a reference time-scale and micro-length; this non-dimensionalization ensures unit consistency). The macroscopic effective diffusion along the $x$-direction is defined via a two-scale homogenization procedure grounded in Fick's law and conservation with reaction. In particular, letting $J$ denote the flux and $u$ the concentration, the microscale laws are: Fick's law $J(y) = -D(y)\\nabla u(y)$ and the steady conservation with linear reaction $-\\nabla \\cdot J(y) + \\lambda u(y) = 0$. A classical two-scale asymptotic expansion with $u(x,y) \\approx U(x) + \\chi_x(y)\\,\\partial_x U(x)$, where $U(x)$ is the macroscopic concentration and $\\chi_x(y)$ is a zero-mean, $Y$-periodic corrector, yields the cell problem for the $x$-direction corrector $\\chi_x(y)$:\n$$\n\\nabla \\cdot \\left( D(y)\\,\\nabla \\chi_x(y) \\right) - \\lambda\\,\\chi_x(y) = -\\frac{\\partial D(y)}{\\partial y_x}\n\\quad \\text{in } Y,\n$$\nwith $Y$-periodicity and the zero-mean constraint $\\int_Y \\chi_x(y)\\,dy = 0$ (the latter is enforced to ensure uniqueness when $\\lambda = 0$). The effective diffusion coefficient along $x$ is then given by\n$$\nD_{\\text{eff}}^{(x)} = D_0 \\,\\overline{D}_{\\text{eff}}^{(x)}, \\quad\n\\overline{D}_{\\text{eff}}^{(x)} = \\frac{1}{|Y|}\\int_Y D(y)\\left(1 + \\frac{\\partial \\chi_x(y)}{\\partial y_x}\\right) dy,\n$$\nwhere $D_0$ is a physical reference diffusion coefficient with unit meters squared per second ($\\mathrm{m^2/s}$), and $\\overline{D}_{\\text{eff}}^{(x)}$ is dimensionless. The above derivation is grounded in well-tested continuum laws (Fick's law and mass conservation) and the modeling paradigm of periodic homogenization for multiscale simulation, which historically developed from rigorous mathematical homogenization and physical mixture theories to provide macroscale laws via microscale solutions.\n\nYour task is to implement a numerical solver for the cell problem and compute $D_{\\text{eff}}^{(x)}$ by flux averaging. Use a finite-volume or finite-difference discretization on a uniform grid, enforce periodic boundary conditions in both $y_x$ and $y_y$, and discretize the operator in conservative form. Specifically:\n- Discretize the operator $\\nabla \\cdot ( D(y)\\,\\nabla \\chi_x )$ using interface diffusion coefficients constructed by arithmetic averaging at cell faces.\n- Discretize $\\partial D/\\partial y_x$ using a central difference that is consistent with the periodic grid.\n- For $\\lambda = 0$, enforce a gauge condition by fixing one grid value of $\\chi_x$ to zero to remove the null space associated with the Laplacian on a periodic domain.\n\nOnce $\\chi_x$ is computed, evaluate $\\partial \\chi_x/\\partial y_x$ by central differences and compute $\\overline{D}_{\\text{eff}}^{(x)}$ by averaging $D(y)\\left(1 + \\partial \\chi_x/\\partial y_x\\right)$ over the grid. Finally multiply by $D_0$ to obtain $D_{\\text{eff}}^{(x)}$ in $\\mathrm{m^2/s}$.\n\nAdopt the following dimensionless microscale fields:\n$$\nD(y_x,y_y) = 1 + a \\,\\sin(2\\pi y_x)\\,\\cos(2\\pi y_y),\n$$\nwith amplitude $a \\in [0,0.5)$ to ensure positivity, and constant $\\lambda \\ge 0$. The physical diffusion field is $D_{\\text{phys}}(y) = D_0\\,D(y)$ but only $D_0$ enters the scaling from $\\overline{D}_{\\text{eff}}^{(x)}$ to $D_{\\text{eff}}^{(x)}$.\n\nImplement the solver and compute $D_{\\text{eff}}^{(x)}$ for the following test suite of parameter sets $(N_x,N_y,D_0,a,\\lambda)$, where $N_x \\times N_y$ is the grid resolution:\n1. $(64,64,1.5\\times 10^{-9},0.30,1.0)$\n2. $(64,64,1.5\\times 10^{-9},0.30,0.0)$\n3. $(96,48,2.0\\times 10^{-9},0.45,5.0)$\n4. $(80,80,0.8\\times 10^{-9},0.10,50.0)$\n\nOutput requirements:\n- Express each $D_{\\text{eff}}^{(x)}$ in $\\mathrm{m^2/s}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be a float. Use scientific notation with six significant digits for each entry.\n\nProvide a complete, runnable program that constructs the periodic operator, solves the linear system for $\\chi_x$, computes the effective diffusion via flux averaging, and prints the four results in the specified format. The program must not read any input.",
            "solution": "### Numerical Solution Algorithm\n\nThe solution approach is to discretize the cell problem on a uniform grid and solve the resulting linear system for the corrector $\\chi_x$. The effective coefficient $D_{\\text{eff}}^{(x)}$ is then computed by numerical integration.\n\n**1. Discretization of the Domain and Fields**\nThe unit cell $Y=[0,1]^2$ is discretized into an $N_x \\times N_y$ grid of cell-centered points $(y_{x,i}, y_{y,j})$ for $i=0,\\dots,N_x-1$ and $j=0,\\dots,N_y-1$. The step sizes are $h_x=1/N_x$ and $h_y=1/N_y$. The scalar fields $\\chi_x(y)$ and $D(y)$ are represented by their values at these grid points, denoted $\\chi_{i,j}$ and $D_{i,j}$.\n\n**2. Discretization of the PDE**\nA conservative finite-difference scheme (equivalent to a cell-centered finite-volume method) is used. The operator $\\nabla \\cdot (D \\nabla \\chi_x)$ at a grid node $(i,j)$ is discretized using a five-point stencil that accounts for periodic boundary conditions. The discretized equation for node $(i,j)$, which has linear index $k = j \\cdot N_x + i$, is:\n$$\n\\frac{D_{i+1/2,j}\\frac{\\chi_{i+1,j}-\\chi_{i,j}}{h_x} - D_{i-1/2,j}\\frac{\\chi_{i,j}-\\chi_{i-1,j}}{h_x}}{h_x} + \\frac{D_{i,j+1/2}\\frac{\\chi_{i,j+1}-\\chi_{i,j}}{h_y} - D_{i,j-1/2}\\frac{\\chi_{i,j}-\\chi_{i,j-1}}{h_y}}{h_y} - \\lambda \\chi_{i,j} = f_{i,j}\n$$\n- The interface diffusion coefficients are computed by arithmetic mean, e.g., $D_{i+1/2,j} = (D_{i,j} + D_{i+1,j})/2$.\n- The source term $f_{i,j}$ is a central-difference approximation of $-\\partial D/\\partial y_x$ at node $(i,j)$: $f_{i,j} = - (D_{i+1,j} - D_{i-1,j})/(2h_x)$.\n- All indices are handled with modulo arithmetic to enforce periodicity (e.g., $i+1$ becomes $(i+1) \\pmod{N_x}$).\n\nThis discretization leads to a large, sparse, linear system of equations $A\\boldsymbol{\\chi} = \\boldsymbol{f}$, where $\\boldsymbol{\\chi}$ and $\\boldsymbol{f}$ are vectors of the flattened grid values $\\chi_{i,j}$ and $f_{i,j}$.\n\n**3. Solving the Linear System**\n- For $\\lambda > 0$, the matrix $A$ is non-singular, and the system is solved directly using a sparse linear solver.\n- For $\\lambda=0$, the matrix $A$ is singular. A unique solution is obtained by applying a gauge condition. We fix $\\chi_{0,0}=0$. This is implemented by modifying the linear system: the first row of matrix $A$ is replaced with zeros except for a $1$ on the diagonal, and the first element of vector $\\boldsymbol{f}$ is set to zero. To maintain consistency, all entries in the first column of $A$ (dependencies on $\\chi_{0,0}$ in other equations) are also set to zero.\n\n**4. Computing the Effective Diffusion**\nOnce the corrector field $\\boldsymbol{\\chi}$ is found, it is reshaped into an $N_y \\times N_x$ grid.\n- The gradient $\\partial\\chi_x/\\partial y_x$ is computed at each grid point using a central difference with periodic boundary conditions: $(\\partial\\chi_x/\\partial y_x)_{i,j} \\approx (\\chi_{i+1,j} - \\chi_{i-1,j})/(2h_x)$.\n- The dimensionless effective coefficient $\\overline{D}_{\\text{eff}}^{(x)}$ is calculated by averaging the integrand over all grid points:\n$$ \\overline{D}_{\\text{eff}}^{(x)} \\approx \\frac{1}{N_x N_y} \\sum_{j=0}^{N_y-1} \\sum_{i=0}^{N_x-1} D_{i,j}\\left(1 + \\left(\\frac{\\partial\\chi_x}{\\partial y_x}\\right)_{i,j}\\right) $$\n- The final result is obtained by scaling with the physical reference coefficient: $D_{\\text{eff}}^{(x)} = D_0 \\overline{D}_{\\text{eff}}^{(x)}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse import linalg\n\ndef solve():\n    \"\"\"\n    Main function to solve the cell problem for all test cases and print results.\n    \"\"\"\n\n    def solve_cell_problem(params):\n        \"\"\"\n        Solves the periodic cell problem for a single set of parameters.\n\n        Args:\n            params (tuple): A tuple containing (Nx, Ny, D0, a, lambda).\n\n        Returns:\n            float: The computed effective diffusion coefficient D_eff^(x).\n        \"\"\"\n        Nx, Ny, D0, a, lam = params\n    \n        # 1. Grid setup\n        # Use a cell-centered grid where each point is at the center of a cell.\n        hx = 1.0 / Nx\n        hy = 1.0 / Ny\n        yx = np.arange(Nx) * hx + 0.5 * hx\n        yy = np.arange(Ny) * hy + 0.5 * hy\n        yx_grid, yy_grid = np.meshgrid(yx, yy)\n        N = Nx * Ny\n\n        # 2. Define D(y) field and the RHS vector f\n        D_grid = 1.0 + a * np.sin(2 * np.pi * yx_grid) * np.cos(2 * np.pi * yy_grid)\n        \n        # Discretize the source term f = -dD/dy_x using central differences.\n        # np.roll handles periodic boundaries automatically.\n        dD_dyx_grid = (np.roll(D_grid, -1, axis=1) - np.roll(D_grid, 1, axis=1)) / (2 * hx)\n        f = -dD_dyx_grid.flatten()\n        \n        # 3. Construct the sparse matrix A for the linear system A*chi = f\n        # We build the matrix in Coordinate (COO) format.\n        data = []\n        row_indices = []\n        col_indices = []\n\n        hx2 = hx**2\n        hy2 = hy**2\n\n        for j in range(Ny):  # y-index\n            for i in range(Nx):  # x-index\n                k = j * Nx + i  # Linear index for the current row\n                \n                # Neighbor indices (i,j) with periodic wrapping\n                ip1 = (i + 1) % Nx\n                im1 = (i - 1 + Nx) % Nx\n                jp1 = (j + 1) % Ny\n                jm1 = (j - 1 + Ny) % Ny\n\n                # Values of D at the current cell and its immediate neighbors\n                D_center = D_grid[j, i]\n                D_east = D_grid[j, ip1]\n                D_west = D_grid[j, im1]\n                D_north = D_grid[jp1, i]\n                D_south = D_grid[jm1, i]\n\n                # Coefficients for the 5-point stencil (conservative finite difference)\n                # Interface diffusion from arithmetic averaging, e.g., (D_center + D_east)/2\n                c_E = (D_center + D_east) / (2.0 * hx2)\n                c_W = (D_center + D_west) / (2.0 * hx2)\n                c_N = (D_center + D_north) / (2.0 * hy2)\n                c_S = (D_center + D_south) / (2.0 * hy2)\n                \n                c_C = -(c_E + c_W + c_N + c_S) - lam\n\n                # Append stencil coefficients and their locations to the COO lists\n                # East neighbor\n                row_indices.append(k); col_indices.append(j * Nx + ip1); data.append(c_E)\n                # West neighbor\n                row_indices.append(k); col_indices.append(j * Nx + im1); data.append(c_W)\n                # North neighbor\n                row_indices.append(k); col_indices.append(jp1 * Nx + i); data.append(c_N)\n                # South neighbor\n                row_indices.append(k); col_indices.append(jm1 * Nx + i); data.append(c_S)\n                # Center (diagonal term)\n                row_indices.append(k); col_indices.append(k); data.append(c_C)\n                \n        # Create a Compressed Sparse Row (CSR) matrix, efficient for solvers.\n        A = sparse.csr_matrix((data, (row_indices, col_indices)), shape=(N, N))\n\n        # 4. Handle singularity for lambda = 0 by enforcing a gauge condition\n        if lam == 0.0:\n            # Fix chi(0,0) = 0. This corresponds to the first element (k=0) of the flattened vector.\n            # Convert to CSC format for efficient column modification.\n            A = A.tocsc()\n            A[:, 0] = 0.0  # Zero out column 0 (dependencies on chi_0 from other equations).\n            A = A.tocsr()    # Convert back to CSR for row modification and solving.\n            A[0, :] = 0.0  # Zero out row 0 (the old equation for chi_0).\n            A[0, 0] = 1.0  # Set diagonal to 1 for the new equation: 1*chi_0 = 0.\n            f[0] = 0.0     # Set RHS to 0 for this equation.\n\n        # 5. Solve the linear system A*chi = f\n        chi_flat = linalg.spsolve(A, f)\n        \n        # 6. Compute the effective diffusion coefficient D_eff^(x)\n        # Reshape the solution vector back to a 2D grid.\n        chi = chi_flat.reshape((Ny, Nx))\n        \n        # Calculate d(chi)/dy_x via central differences with periodic boundaries.\n        dchi_dyx = (np.roll(chi, -1, axis=1) - np.roll(chi, 1, axis=1)) / (2 * hx)\n        \n        # Calculate the integrand D * (1 + dchi/dyx).\n        integrand = D_grid * (1.0 + dchi_dyx)\n        \n        # Approximate the integral over Y by averaging over all grid cells. |Y|=1.\n        D_eff_bar = np.mean(integrand)\n        \n        # Scale by the physical reference coefficient to get the final dimensional result.\n        D_eff_x = D0 * D_eff_bar\n        \n        return D_eff_x\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (64, 64, 1.5e-9, 0.30, 1.0),\n        (64, 64, 1.5e-9, 0.30, 0.0),\n        (96, 48, 2.0e-9, 0.45, 5.0),\n        (80, 80, 0.8e-9, 0.10, 50.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_cell_problem(case)\n        results.append(result)\n\n    # Format the final output according to problem specifications.\n    # Each result is a string in scientific notation with six significant digits.\n    formatted_results = [f\"{res:.5e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "An alternative to deriving explicit coarse-grained equations is to simulate the macroscopic behavior on-the-fly using a fine-scale model as a computational experiment. This exercise introduces the \"equation-free\" paradigm through a technique called coarse projective integration. You will analytically derive a simple projective integrator and determine its stability, providing insight into how short bursts of a microscopic simulation can be used to take large steps at the macroscopic level. ",
            "id": "3761842",
            "problem": "In the spirit of early equation-free multiscale computation, consider a coarse projective integration procedure designed to evolve a coarse observable $x(t)$ using only short bursts of a microscopic simulator. Historically, the coarse projective integration methodology was introduced to accelerate simulation by estimating coarse time derivatives from short micro-scale bursts and then projecting forward over a larger macro-scale time step. In this problem you will start from fundamental definitions to derive a coarse projective integration update for a linear test problem and to obtain an explicit stability condition that relates the micro-burst duration to the macro step size.\n\nAssume the following setup.\n\n- The coarse observable $x(t)$ is governed at the coarse level by a linear ordinary differential equation $x'(t) = \\lambda x(t)$, where $\\lambda \\in \\mathbb{C}$ with $\\operatorname{Re}(\\lambda) < 0$. The true coarse dynamics are unknown to the algorithm; they are used here only as a test equation to analyze stability.\n- The microscopic simulator, when initialized consistently with a coarse value $x(t_n) = x_n$, reproduces the coarse evolution exactly for this test problem, so that the coarse observable produced by a micro-burst of duration $\\tau$ equals $x_n \\exp(\\lambda \\tau)$.\n- A single coarse time step is performed as follows: starting from $t_n$, run a short micro-burst of duration $\\tau_b > 0$ and measure the coarse observable at two times, $t_n + \\tau_b - \\delta$ and $t_n + \\tau_b$, with $0 < \\delta \\le \\tau_b$. Use these two measurements to estimate the coarse time derivative at the end of the micro-burst via a finite-difference quotient. Then project forward from $t_n + \\tau_b$ to $t_{n+1} = t_n + H$ using a forward Euler-type projective step of length $H - \\tau_b > 0$ applied to the estimated derivative.\n- You may assume that $x(t_n + \\tau_b - \\delta)$ and $x(t_n + \\tau_b)$ are obtained without statistical noise and that the microscopic simulator is exact on the coarse variable for the linear test problem.\n\nTasks.\n\n1. Using only the definition of a finite-difference quotient and the assumed behavior of the microscopic simulator on the linear test equation, derive the estimated coarse derivative at time $t_n + \\tau_b$ in terms of $x_n$, $\\lambda$, $\\tau_b$, and $\\delta$.\n\n2. Using the forward Euler projective step to advance from $t_n + \\tau_b$ to $t_{n+1} = t_n + H$, derive the one-step coarse update $x_{n+1}$ in terms of $x_n$, $\\lambda$, $H$, $\\tau_b$, and $\\delta$. Then write the corresponding scalar amplification factor $G(\\lambda; H, \\tau_b, \\delta)$ defined by $x_{n+1} = G(\\lambda; H, \\tau_b, \\delta)\\, x_n$.\n\n3. Specialize to the case $\\delta = \\tau_b$ (that is, estimate the coarse derivative using the entire micro-burst) and simplify $G(\\lambda; H, \\tau_b, \\tau_b)$ as much as possible.\n\n4. For real $\\lambda < 0$, impose the linear absolute stability requirement that the magnitude of the amplification factor is at most one. Determine, in closed form, the largest macro step size $H_{\\max}(\\lambda, \\tau_b)$ as a function of $\\lambda$ and $\\tau_b$ such that the stability condition is satisfied for the specialized case $\\delta = \\tau_b$.\n\nExpress your final answer for $H_{\\max}(\\lambda, \\tau_b)$ as a single closed-form analytic expression. No rounding is required. Express the macro step size in the same time units as $\\tau_b$.",
            "solution": "We proceed from the definitions and the assumed behavior of the microscopic simulator on the linear test equation.\n\nFor the linear test equation $x'(t) = \\lambda x(t)$, the exact solution is $x(t) = x(t_n) \\exp(\\lambda (t - t_n))$ when initialized at time $t_n$ with $x(t_n) = x_n$. By assumption, the microscopic simulator reproduces this coarse evolution exactly.\n\n1. Estimation of the coarse derivative at the end of the micro-burst.\n\nWe run a micro-burst of duration $\\tau_b$, and we record two coarse values:\n$$\nx^{+} \\equiv x(t_n + \\tau_b) = x_n \\exp(\\lambda \\tau_b),\n$$\n$$\nx^{-} \\equiv x(t_n + \\tau_b - \\delta) = x_n \\exp(\\lambda (\\tau_b - \\delta)).\n$$\nA finite-difference quotient estimating the derivative at time $t_n + \\tau_b$ is\n$$\n\\widehat{x}'(t_n + \\tau_b) = \\frac{x^{+} - x^{-}}{\\delta} = \\frac{x_n \\exp(\\lambda \\tau_b) - x_n \\exp(\\lambda (\\tau_b - \\delta))}{\\delta}.\n$$\nFactoring out $x_n \\exp(\\lambda (\\tau_b - \\delta))$ yields\n$$\n\\widehat{x}'(t_n + \\tau_b) = x_n \\exp(\\lambda (\\tau_b - \\delta)) \\frac{\\exp(\\lambda \\delta) - 1}{\\delta}.\n$$\n\n2. Projective forward Euler update and amplification factor.\n\nWe project from time $t_n + \\tau_b$ to $t_{n+1} = t_n + H$ using a forward Euler-type step with step size $H - \\tau_b$ applied to the estimated derivative:\n$$\nx_{n+1} = x^{+} + (H - \\tau_b)\\, \\widehat{x}'(t_n + \\tau_b).\n$$\nSubstituting $x^{+}$ and $\\widehat{x}'(t_n + \\tau_b)$,\n$$\nx_{n+1} = x_n \\exp(\\lambda \\tau_b) + (H - \\tau_b)\\, x_n \\exp(\\lambda (\\tau_b - \\delta)) \\frac{\\exp(\\lambda \\delta) - 1}{\\delta}.\n$$\nFactor $x_n$ to identify the amplification factor $G(\\lambda; H, \\tau_b, \\delta)$ defined by $x_{n+1} = G(\\lambda; H, \\tau_b, \\delta)\\, x_n$:\n$$\nG(\\lambda; H, \\tau_b, \\delta) = \\exp(\\lambda \\tau_b) + \\frac{H - \\tau_b}{\\delta} \\left[\\exp(\\lambda \\tau_b) - \\exp(\\lambda (\\tau_b - \\delta))\\right].\n$$\nEquivalently, introducing $\\rho \\equiv \\exp(\\lambda \\tau_b)$, we can write\n$$\nG(\\lambda; H, \\tau_b, \\delta) = \\rho + \\frac{H - \\tau_b}{\\delta} \\left[\\rho - \\rho \\exp(-\\lambda \\delta)\\right] = \\rho \\left[1 + \\frac{H - \\tau_b}{\\delta}\\left(1 - \\exp(-\\lambda \\delta)\\right)\\right].\n$$\n\n3. Specialization to $\\delta = \\tau_b$ and simplification.\n\nSet $\\delta = \\tau_b$. Then\n$$\nG(\\lambda; H, \\tau_b, \\tau_b) = \\exp(\\lambda \\tau_b) + \\frac{H - \\tau_b}{\\tau_b} \\left[\\exp(\\lambda \\tau_b) - 1\\right].\n$$\nLet $\\rho = \\exp(\\lambda \\tau_b)$. Then\n$$\nG(\\lambda; H, \\tau_b, \\tau_b) = \\rho + \\left(\\frac{H}{\\tau_b} - 1\\right)(\\rho - 1) = 1 + \\frac{H}{\\tau_b}(\\rho - 1).\n$$\nThus, in the specialized case, the amplification factor simplifies to\n$$\nG(\\lambda; H, \\tau_b, \\tau_b) = 1 + \\frac{H}{\\tau_b}\\left(\\exp(\\lambda \\tau_b) - 1\\right).\n$$\nThis expression reveals that the method behaves like a forward Euler step with an effective coarse growth rate equal to the secant slope $(\\exp(\\lambda \\tau_b) - 1)/\\tau_b$.\n\n4. Absolute stability for real $\\lambda < 0$ and the largest stable $H$.\n\nAssume $\\lambda \\in \\mathbb{R}$ and $\\lambda < 0$. Then $\\rho = \\exp(\\lambda \\tau_b) \\in (0,1)$ and $\\rho - 1 \\in (-1,0)$. The absolute stability requirement for a one-step method on the linear test equation is\n$$\n|G(\\lambda; H, \\tau_b, \\tau_b)| \\le 1.\n$$\nUsing the simplified form,\n$$\nG = 1 + \\frac{H}{\\tau_b}(\\rho - 1).\n$$\nSince $\\rho - 1 < 0$ and $H \\ge 0$, $G$ is a decreasing affine function of $H$. The most restrictive bound corresponds to the lower limit $G \\ge -1$; the upper bound $G \\le 1$ is automatically satisfied for $H \\ge 0$ because $G(0) = 1$ and $G$ decreases as $H$ increases. Therefore impose\n$$\n1 + \\frac{H}{\\tau_b}(\\rho - 1) \\ge -1.\n$$\nSolving for $H$,\n$$\n\\frac{H}{\\tau_b}(\\rho - 1) \\ge -2 \\quad \\Longrightarrow \\quad H \\le \\frac{2 \\tau_b}{1 - \\rho}.\n$$\nSince $\\rho = \\exp(\\lambda \\tau_b)$ and $1 - \\rho > 0$ for $\\lambda < 0$, the largest macro step size ensuring $|G| \\le 1$ is\n$$\nH_{\\max}(\\lambda, \\tau_b) = \\frac{2 \\tau_b}{1 - \\exp(\\lambda \\tau_b)}.\n$$\nThis provides the requested explicit relation between the micro-burst duration and the allowable macro step size for linear absolute stability in the specialized case $\\delta = \\tau_b$.",
            "answer": "$$\\boxed{\\frac{2\\,\\tau_b}{1-\\exp(\\lambda\\,\\tau_b)}}$$"
        }
    ]
}