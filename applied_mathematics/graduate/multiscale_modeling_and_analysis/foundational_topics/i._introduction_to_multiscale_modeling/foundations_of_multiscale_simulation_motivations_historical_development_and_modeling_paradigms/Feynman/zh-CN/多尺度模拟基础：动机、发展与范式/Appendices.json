{
    "hands_on_practices": [
        {
            "introduction": "扩散方程是输运现象的基石，描述了从热传导到分子输运的各种过程。本练习将使用基本的量纲分析——一种物理学家的必备工具——来揭示扩散时间尺度如何依赖于观测的长度尺度。通过分别计算微观和宏观尺度下的这一时间，你将定量地理解尺度分离所带来的巨大计算挑战，而这正是多尺度建模需求的根本动机。",
            "id": "3761869",
            "problem": "一个守恒的标量浓度场 $u(\\mathbf{x}, t)$ 在均匀介质中进行扩散，其特征为恒定的分子扩散系数 $D$。$u$ 的演化由扩散偏微分方程（PDE）控制\n$$\n\\frac{\\partial u}{\\partial t} = D \\nabla^2 u,\n$$\n其中 $\\mathbf{x} \\in \\mathbb{R}^3$ 且 $t \\ge 0$。在多尺度建模和分析中，同一个物理过程可能需要使用单一的底层扩散系数 $D$，在微观长度尺度 $L_{\\mathrm{micro}}$ 和宏观长度尺度 $L_{\\mathrm{macro}}$（其中 $L_{\\mathrm{macro}} \\gg L_{\\mathrm{micro}}$）上进行解析。\n\n从扩散偏微分方程出发，仅使用基本的量纲和标度分析，确定与通用长度尺度 $L$ 相关的特征扩散时间尺度。然后，定义无量纲比率\n$$\nS \\equiv \\frac{t_{\\mathrm{macro}}}{t_{\\mathrm{micro}}},\n$$\n其中 $t_{\\mathrm{micro}}$ 和 $t_{\\mathrm{macro}}$ 分别是 $L_{\\mathrm{micro}}$ 和 $L_{\\mathrm{macro}}$ 处的特征扩散时间。请用 $S$ 表述一个条件，在该条件下，一个必须解析最快扩散动力学的时间积分器，在多尺度模拟中必然需要在微观和宏观模型之间使用差异巨大的时间步长。\n\n最后，对以下数值计算 $S$ 的值：\n- $L_{\\mathrm{micro}} = 1.0 \\times 10^{-7}\\ \\mathrm{m}$，\n- $L_{\\mathrm{macro}} = 1.0 \\times 10^{-2}\\ \\mathrm{m}$，\n- $D = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$。\n\n将你的最终答案报告为 $S$ 的数值，四舍五入到三位有效数字。比率 $S$ 是无量纲的；最终答案中不要包含单位。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n- 守恒标量浓度场: $u(\\mathbf{x}, t)$\n- 具有恒定分子扩散系数的均匀介质: $D$\n- 控制偏微分方程: $\\frac{\\partial u}{\\partial t} = D \\nabla^2 u$\n- 空间域和时间: $\\mathbf{x} \\in \\mathbb{R}^3$, $t \\ge 0$\n- 微观长度尺度: $L_{\\mathrm{micro}}$\n- 宏观长度尺度: $L_{\\mathrm{macro}}$\n- 尺度分离: $L_{\\mathrm{macro}} \\gg L_{\\mathrm{micro}}$\n- 无量纲比率定义: $S \\equiv \\frac{t_{\\mathrm{macro}}}{t_{\\mathrm{micro}}}$\n- $t_{\\mathrm{micro}}$: $L_{\\mathrm{micro}}$ 处的特征扩散时间\n- $t_{\\mathrm{macro}}$: $L_{\\mathrm{macro}}$ 处的特征扩散时间\n- $L_{\\mathrm{micro}}$ 的数值: $1.0 \\times 10^{-7}\\ \\mathrm{m}$\n- $L_{\\mathrm{macro}}$ 的数值: $1.0 \\times 10^{-2}\\ \\mathrm{m}$\n- $D$ 的数值: $1.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学依据**：该问题基于经典的扩散方程，这是质量传递和输运现象中一个基础且公认的原理。特征尺度和量纲分析的概念是物理学和工程学中的标准工具。\n- **定义明确**：问题陈述清晰。它要求基于量纲分析进行推导，对时间尺度分离进行分析，并进行数值计算，所有这些都是定义明确的任务，可导向唯一解。\n- **客观性**：问题陈述精确、定量，且无主观或模糊的语言。\n- **完整性和一致性**：提供了所有必要的数据和定义。给定的数值对于分子在纳米到毫米尺度上的扩散过程是物理上合理的。例如，扩散系数 $D \\approx 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$ 是小分子在水溶液中的典型值。长度尺度与微观（如细胞结构）和宏观（如组织或小型设备）现象一致。不存在矛盾。\n\n### 步骤3：结论和行动\n该问题具有科学合理性、定义明确、客观且完整。因此，判定为 **有效**。将提供完整解答。\n\n第一步是利用所给的偏微分方程（PDE）确定与通用长度尺度 $L$ 相关的特征扩散时间尺度 $t$。扩散方程为\n$$\n\\frac{\\partial u}{\\partial t} = D \\nabla^2 u\n$$\n我们对该方程进行量纲分析。令 $[X]$ 表示量 $X$ 的物理量纲。我们用 $T$ 表示时间，用 $L$ 表示长度。浓度场 $[u]$ 的量纲不需要，因为它会被消掉。\n\n左手边项 $\\frac{\\partial u}{\\partial t}$ 表示浓度随时间的变化率。其量纲为\n$$\n\\left[\\frac{\\partial u}{\\partial t}\\right] = \\frac{[u]}{[t]} = \\frac{[u]}{T}\n$$\n拉普拉斯算子 $\\nabla^2$ 涉及二阶空间导数，例如 $\\frac{\\partial^2}{\\partial x^2}$。其量纲为 $L^{-2}$。因此，右手边项的量纲为\n$$\n[D \\nabla^2 u] = [D] [\\nabla^2] [u] = [D] \\frac{[u]}{L^2}\n$$\n为使偏微分方程在量纲上一致，两边的量纲必须相等：\n$$\n\\frac{[u]}{T} = [D] \\frac{[u]}{L^2}\n$$\n量纲 $[u]$ 消掉，留下扩散系数、长度和时间的量纲之间的关系：\n$$\n\\frac{1}{T} = \\frac{[D]}{L^2} \\implies [D] = \\frac{L^2}{T}\n$$\n这证实了扩散系数的单位是长度的平方除以单位时间（例如 $\\mathrm{m}^2/\\mathrm{s}$），与所给数值一致。\n\n为了找到控制在特征长度尺度 $L_{\\mathrm{char}}$ 上的扩散的特征时间尺度 $t_{\\mathrm{char}}$，我们重排这个量纲关系式，以求解具有时间量纲的量。从 $[D] = L^2/T$ 可以清楚地看出，可以构造一个时间尺度为：\n$$\nt_{\\mathrm{char}} \\propto \\frac{L_{\\mathrm{char}}^2}{D}\n$$\n对于标度分析，我们可以将比例常数取为1。因此，与长度尺度 $L$ 相关的特征扩散时间尺度由下式给出\n$$\nt = \\frac{L^2}{D}\n$$\n现在，我们将此关系应用于问题中定义的微观和宏观尺度。特征时间为：\n$$\nt_{\\mathrm{micro}} = \\frac{L_{\\mathrm{micro}}^2}{D}\n$$\n$$\nt_{\\mathrm{macro}} = \\frac{L_{\\mathrm{macro}}^2}{D}\n$$\n问题将无量纲比率 $S$ 定义为\n$$\nS \\equiv \\frac{t_{\\mathrm{macro}}}{t_{\\mathrm{micro}}}\n$$\n代入 $t_{\\mathrm{micro}}$ 和 $t_{\\mathrm{macro}}$ 的表达式得到\n$$\nS = \\frac{\\left(\\frac{L_{\\mathrm{macro}}^2}{D}\\right)}{\\left(\\frac{L_{\\mathrm{micro}}^2}{D}\\right)} = \\left(\\frac{L_{\\mathrm{macro}}}{L_{\\mathrm{micro}}}\\right)^2\n$$\n注意到扩散系数 $D$ 被消掉了，这意味着时间尺度的比率仅取决于长度尺度的比率。\n\n问题要求找出在此条件下时间积分器需要使用差异巨大的时间步长的条件。多尺度模拟必须能够捕捉所有相关尺度上的现象。为了数值稳定性和准确性，特别是对于显式时间积分格式，时间步长 $\\Delta t$ 必须足够小，以解析系统中最快的动力学。最快的动力学发生在最短的长度尺度上，因此与最短的特征时间 $t_{\\mathrm{micro}}$ 相关。扩散方程的 CFL (Courant-Friedrichs-Lewy) 条件要求 $\\Delta t \\propto (\\Delta x)^2/D$，其中 $\\Delta x$ 是网格间距。在我们的情境中，$\\Delta x$ 对应于 $L_{\\mathrm{micro}}$，因此我们必须有 $\\Delta t \\lesssim t_{\\mathrm{micro}}$。\n\n为了模拟系统足够长的时间以观察宏观尺度上的演化，总模拟时间必须在 $t_{\\mathrm{macro}}$ 的量级。所需的总时间步数 $N$ 将是\n$$\nN \\approx \\frac{t_{\\mathrm{macro}}}{\\Delta t} \\gtrsim \\frac{t_{\\mathrm{macro}}}{t_{\\mathrm{micro}}} = S\n$$\n当所需的时间步长 $\\Delta t$ 远小于我们感兴趣的整体时间尺度 $t_{\\mathrm{macro}}$ 时，就会出现时间步长差异巨大的问题。这种情况对应于所需的步数 $N$ 非常大，这使得模拟在计算上变得不可行。这在 $t_{\\mathrm{macro}} \\gg t_{\\mathrm{micro}}$ 时发生。因此，用 $S$ 表示的条件是\n$$\nS \\gg 1\n$$\n这个条件意味着一个“刚性”问题，其中存在极端的时间尺度分离，使得标准的显式积分方法效率低下。\n\n最后，我们使用所给的数值来计算 $S$：\n- $L_{\\mathrm{micro}} = 1.0 \\times 10^{-7}\\ \\mathrm{m}$\n- $L_{\\mathrm{macro}} = 1.0 \\times 10^{-2}\\ \\mathrm{m}$\n\n将这些值代入 $S$ 的表达式中：\n$$\nS = \\left(\\frac{1.0 \\times 10^{-2}}{1.0 \\times 10^{-7}}\\right)^2\n$$\n首先，我们计算长度尺度的比率：\n$$\n\\frac{L_{\\mathrm{macro}}}{L_{\\mathrm{micro}}} = \\frac{1.0 \\times 10^{-2}}{1.0 \\times 10^{-7}} = 1.0 \\times 10^{-2 - (-7)} = 1.0 \\times 10^5\n$$\n现在，我们将这个比率平方：\n$$\nS = (1.0 \\times 10^5)^2 = (1.0)^2 \\times (10^5)^2 = 1.0 \\times 10^{10}\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nS = 1.00 \\times 10^{10}\n$$\n$S$ 的这个极大值证实了系统是异常刚性的，由于时间尺度的巨大差异，多尺度模拟确实会面临严峻的挑战。一个显式时间积分器需要大约 $10^{10}$ 个步长来解析微观尺度的动力学，同时模拟到宏观尺度的特征时间。这推动了专门的多尺度建模范式的发展。",
            "answer": "$$\\boxed{1.00 \\times 10^{10}}$$"
        },
        {
            "introduction": "尽管巨大的长度尺度分离通常预示着需要多尺度方法，但当多种物理过程相互竞争时，情况会变得更加微妙。本练习超越了简单的尺度比率，进入了无量纲数的领域，这些数可以量化对流与扩散、或材料弛豫与过程时间尺度等竞争效应的相对重要性。你将推导出关键的无量纲数——佩克莱特数 (Péclet number)、德博拉数 (Deborah number) 和克努森数 (Knudsen number)——并用它们构建一个判据，以判断何时简单的单尺度模型是不充分的，从而为多尺度描述提供有力依据。",
            "id": "3761823",
            "problem": "在稳定的平面剪切作用下，一种输运被动标量的稀粘弹性流体被驱动通过高度为 $L$ 的纳米狭缝。该流动足够简单，速度梯度的大小可以估计为特征剪切速率 $\\dot{\\gamma} \\sim U/L$，其中 $U$ 是特征速度。标量浓度 $c(x,t)$ 在质量守恒和平流-扩散作用下演化，而流体的微观结构表现出单一的弛豫时间 $\\tau$。流体的微观相关长度，记为 $\\ell_{\\mathrm{mic}}$，相对于狭缝高度是不可忽略的。假设平流-扩散方程和具有单一弛豫时间的线性粘弹性本构定律描述了主阶单尺度模型，并且稀薄化效应之类的修正是通过有限的 $\\ell_{\\mathrm{mic}}$ 以广义克努森数的形式出现的。\n\n从第一性原理出发——即平流-扩散的物种守恒、无量纲化特征尺度的定义，以及微观结构弛豫和微观相关尺度的确定——进行无量纲化，以揭示控制该问题的不同时间和长度尺度。利用这些尺度来确定三个独立的无量纲数群，它们控制着单尺度模型中被忽略的物理效应的量级：\n(i) 与有限微观相关长度相关的广义克努森数；\n(ii) 与有限微观结构记忆相关的德博拉数；\n(iii) 与相对于平流的有限扩散输运相关的逆佩克莱数。\n\n从渐近误差的角度论证，每个被忽略的效应都贡献一个一阶修正，其振幅与相应的无量纲数群成正比，并将单尺度模型不适用性的保守标量指标 $M$ 定义为这三个一阶振幅量值的总和。然后，对于纳米狭缝流场景，参数为\n$L = 3.0 \\times 10^{-7}\\ \\mathrm{m}$，$U = 1.0 \\times 10^{-2}\\ \\mathrm{m/s}$，$D = 5.0 \\times 10^{-10}\\ \\mathrm{m^2/s}$，$\\tau = 4.0 \\times 10^{-4}\\ \\mathrm{s}$，以及 $\\ell_{\\mathrm{mic}} = 5.0 \\times 10^{-9}\\ \\mathrm{m}$，计算 $M$。将最终结果表示为单个无量纲实数。无需舍入说明；如果可得，请提供精确值。",
            "solution": "我们从被动标量浓度 $c(x,t)$ 的平流-扩散方程开始：\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot (c\\,\\mathbf{u}) = \\nabla \\cdot (D\\,\\nabla c),\n$$\n其中 $D$ 是分子扩散系数，$\\mathbf{u}$ 是流速。特征尺度选择为 $x \\sim L$，$t \\sim T$，$|\\mathbf{u}| \\sim U$ 和 $c \\sim c_{0}$，其中 $L$ 是狭缝高度，$U$ 是特征速度。定义无量纲变量 $\\hat{x} = x/L$，$\\hat{t} = t/T$，$\\hat{\\mathbf{u}} = \\mathbf{u}/U$ 和 $\\hat{c} = c/c_{0}$，平流-扩散方程变为\n$$\n\\frac{L}{U}\\frac{\\partial \\hat{c}}{\\partial \\hat{t}} + \\nabla_{\\hat{x}} \\cdot (\\hat{c}\\,\\hat{\\mathbf{u}}) = \\frac{D}{U L}\\,\\nabla_{\\hat{x}} \\cdot \\left(\\nabla_{\\hat{x}} \\hat{c}\\right),\n$$\n在除以 $U/L$ 后。选择平流时间尺度 $T_{\\mathrm{adv}} = L/U$，时间导数项的系数变为1，我们得到\n$$\n\\frac{\\partial \\hat{c}}{\\partial \\hat{t}} + \\nabla_{\\hat{x}} \\cdot (\\hat{c}\\,\\hat{\\mathbf{u}}) = \\frac{1}{\\mathrm{Pe}}\\,\\nabla_{\\hat{x}} \\cdot \\left(\\nabla_{\\hat{x}} \\hat{c}\\right),\n$$\n其中佩克莱数是\n$$\n\\mathrm{Pe} = \\frac{U L}{D}.\n$$\n当 $\\mathrm{Pe} \\gg 1$ 时，单尺度平流主导模型在主阶上忽略了扩散；一阶修正的振幅与 $\\mathrm{Pe}^{-1}$ 成比例。\n\n接下来，对于粘弹性记忆，线性粘弹性本构方程（例如麦克斯韦模型）引入了微观结构弛豫时间 $\\tau$。相关的无量纲数群是通过比较 $\\tau$ 和特征形变时间尺度形成的。在简单剪切中，剪切速率的尺度为 $\\dot{\\gamma} \\sim U/L$，因此观察或形变时间尺度为 $T_{\\mathrm{flow}} \\sim 1/\\dot{\\gamma} \\sim L/U$。因此，德博拉数为\n$$\n\\mathrm{De} = \\frac{\\tau}{T_{\\mathrm{flow}}} = \\tau\\,\\frac{U}{L}.\n$$\n当 $\\mathrm{De}$ 不小时，单尺度（瞬时）本构近似忽略了记忆效应，一阶修正的振幅与 $\\mathrm{De}$ 成比例。\n\n对于有限的微观相关长度，通过比较微观长度 $\\ell_{\\mathrm{mic}}$ 和宏观狭缝高度 $L$ 来定义广义克努森数：\n$$\n\\mathrm{Kn} = \\frac{\\ell_{\\mathrm{mic}}}{L}.\n$$\n在动力学理论中，Chapman–Enskog 展开表明连续介质闭合关系会获得与 $\\mathrm{Kn}$ 成正比的修正项；通过类比，在具有有限相关长度的复杂流体中，宏观尺度上主导的稀薄化效应之类的修正与 $\\mathrm{Kn}$ 成比例。\n\n综合这些，单尺度模型忽略了三个一阶效应，它们的振幅分别与 $\\mathrm{Kn}$、$\\mathrm{De}$ 和 $\\mathrm{Pe}^{-1}$ 成正比。单尺度模型不适用性的保守标量指标 $M$ 可以定义为这些振幅的 $L^{1}$ 范数（和）：\n$$\nM = \\mathrm{Kn} + \\mathrm{De} + \\mathrm{Pe}^{-1}.\n$$\n我们现在根据给定的参数计算 $\\mathrm{Kn}$、$\\mathrm{De}$ 和 $\\mathrm{Pe}^{-1}$：\n- 广义克努森数：\n$$\n\\mathrm{Kn} = \\frac{\\ell_{\\mathrm{mic}}}{L} = \\frac{5.0 \\times 10^{-9}}{3.0 \\times 10^{-7}} = \\frac{5}{3} \\times 10^{-2} = \\frac{1}{60}.\n$$\n- 德博拉数：\n$$\n\\mathrm{De} = \\tau\\,\\frac{U}{L} = \\left(4.0 \\times 10^{-4}\\right)\\,\\frac{1.0 \\times 10^{-2}}{3.0 \\times 10^{-7}} = \\left(4.0 \\times 10^{-4}\\right)\\,\\left(\\frac{1.0 \\times 10^{-2}}{3.0 \\times 10^{-7}}\\right).\n$$\n计算速度-长度比：\n$$\n\\frac{U}{L} = \\frac{1.0 \\times 10^{-2}}{3.0 \\times 10^{-7}} = \\frac{1}{3} \\times 10^{5} = \\frac{10^{5}}{3}.\n$$\n因此，\n$$\n\\mathrm{De} = \\left(4.0 \\times 10^{-4}\\right)\\,\\left(\\frac{10^{5}}{3}\\right) = \\frac{40}{3}.\n$$\n- 逆佩克莱数：\n$$\n\\mathrm{Pe}^{-1} = \\frac{D}{U L} = \\frac{5.0 \\times 10^{-10}}{\\left(1.0 \\times 10^{-2}\\right)\\,\\left(3.0 \\times 10^{-7}\\right)} = \\frac{5.0 \\times 10^{-10}}{3.0 \\times 10^{-9}} = \\frac{5}{3} \\times 10^{-1} = \\frac{1}{6}.\n$$\n\n求和，\n$$\nM = \\mathrm{Kn} + \\mathrm{De} + \\mathrm{Pe}^{-1} = \\frac{1}{60} + \\frac{40}{3} + \\frac{1}{6}.\n$$\n通分到分母为 $60$：\n$$\n\\frac{1}{60} + \\frac{40}{3} + \\frac{1}{6} = \\frac{1}{60} + \\frac{800}{60} + \\frac{10}{60} = \\frac{811}{60}.\n$$\n因此，精确的无量纲指标是\n$$\nM = \\frac{811}{60}.\n$$",
            "answer": "$$\\boxed{\\frac{811}{60}}$$"
        },
        {
            "introduction": "在确定了为何以及何时需要多尺度模型之后，我们现在转向如何构建它们。本练习介绍周期性均匀化方法，这是一个强大的数学框架，用于从详细的微观结构信息中推导宏观有效性质。你将实现一个微观“元胞问题”的数值求解器，以计算复杂多孔介质的有效扩散系数。这个亲手实践的编程练习提供了一个自下而上（bottom-up）多尺度范式的具体例子，弥合了微观复杂性与宏观行为之间的鸿沟。",
            "id": "3761830",
            "problem": "考虑一个周期性多孔介质，其在微观尺度上由一个单位晶胞 $Y = [0,1]^2$ 建模，使用无量纲坐标 $y = (y_x,y_y)$。扩散发生在孔隙相中，其扩散系数 $D(y)  0$ 是空间变化的无量纲量，而孔隙中的线性反应引入了一个无量纲速率 $\\lambda \\ge 0$（这是通过将物理反应速率由参考时间尺度和微观长度进行缩放得出的；此无量纲化确保了单位的一致性）。沿 $x$ 方向的宏观有效扩散是通过基于菲克定律和带反应的守恒定律的双尺度均匀化程序定义的。具体而言，令 $J$ 表示通量，$u$ 表示浓度，微观尺度定律为：菲克定律 $J(y) = -D(y)\\nabla u(y)$ 和稳态带线性反应的守恒定律 $-\\nabla \\cdot J(y) + \\lambda u(y) = 0$。一个经典的双尺度渐近展开 $u(x,y) \\approx U(x) + \\chi_x(y)\\,\\partial_x U(x)$，其中 $U(x)$ 是宏观浓度，$\\chi_x(y)$ 是一个零均值、$Y$-周期的修正子，可导出用于 $x$ 方向修正子 $\\chi_x(y)$ 的晶胞问题：\n$$\n\\nabla \\cdot \\left( D(y)\\,\\nabla \\chi_x(y) \\right) - \\lambda\\,\\chi_x(y) = -\\frac{\\partial D(y)}{\\partial y_x}\n\\quad \\text{在 } Y \\text{ 中},\n$$\n具有 $Y$-周期性和零均值约束 $\\int_Y \\chi_x(y)\\,dy = 0$（后者用于确保在 $\\lambda = 0$ 时的唯一性）。则沿 $x$ 方向的有效扩散系数由下式给出：\n$$\nD_{\\text{eff}}^{(x)} = D_0 \\,\\overline{D}_{\\text{eff}}^{(x)}, \\quad\n\\overline{D}_{\\text{eff}}^{(x)} = \\frac{1}{|Y|}\\int_Y D(y)\\left(1 + \\frac{\\partial \\chi_x(y)}{\\partial y_x}\\right) dy,\n$$\n其中 $D_0$ 是一个物理参考扩散系数，单位为米²/秒（$\\mathrm{m^2/s}$），而 $\\overline{D}_{\\text{eff}}^{(x)}$ 是无量纲的。上述推导基于经过充分检验的连续介质定律（菲克定律和质量守恒）以及用于多尺度模拟的周期性均匀化建模范式，该范式在历史上从严格的数学均匀化和物理混合物理论发展而来，通过微观尺度的解来提供宏观尺度的定律。\n\n您的任务是实现一个用于晶胞问题的数值求解器，并通过通量平均计算 $D_{\\text{eff}}^{(x)}$。在均匀网格上使用有限体积或有限差分离散化方法，在 $y_x$ 和 $y_y$ 方向上强制施加周期性边界条件，并以守恒形式离散化算子。具体来说：\n- 使用在晶胞面上通过算术平均构建的界面扩散系数来离散化算子 $\\nabla \\cdot ( D(y)\\,\\nabla \\chi_x )$。\n- 使用与周期性网格一致的中心差分来离散化 $\\partial D/\\partial y_x$。\n- 对于 $\\lambda = 0$ 的情况，通过将 $\\chi_x$ 的一个网格值固定为零来强制施加规范条件，以消除与周期域上的拉普拉斯算子相关的零空间。\n\n计算出 $\\chi_x$ 后，通过中心差分计算 $\\partial \\chi_x/\\partial y_x$，并通过在网格上平均 $D(y)\\left(1 + \\partial \\chi_x/\\partial y_x\\right)$ 来计算 $\\overline{D}_{\\text{eff}}^{(x)}$。最后乘以 $D_0$ 以获得单位为 $\\mathrm{m^2/s}$ 的 $D_{\\text{eff}}^{(x)}$。\n\n采用以下无量纲微观尺度场：\n$$\nD(y_x,y_y) = 1 + a \\,\\sin(2\\pi y_x)\\,\\cos(2\\pi y_y),\n$$\n其中振幅 $a \\in [0,0.5)$ 以确保正性，且 $\\lambda \\ge 0$ 为常数。物理扩散场为 $D_{\\text{phys}}(y) = D_0\\,D(y)$，但只有 $D_0$ 进入从 $\\overline{D}_{\\text{eff}}^{(x)}$到 $D_{\\text{eff}}^{(x)}$ 的缩放中。\n\n实现求解器并为以下参数集 $(N_x,N_y,D_0,a,\\lambda)$ 的测试套件计算 $D_{\\text{eff}}^{(x)}$，其中 $N_x \\times N_y$ 是网格分辨率：\n1. $(64,64,1.5\\times 10^{-9},0.30,1.0)$\n2. $(64,64,1.5\\times 10^{-9},0.30,0.0)$\n3. $(96,48,2.0\\times 10^{-9},0.45,5.0)$\n4. $(80,80,0.8\\times 10^{-9},0.10,50.0)$\n\n输出要求：\n- 以 $\\mathrm{m^2/s}$ 为单位表示每个 $D_{\\text{eff}}^{(x)}$。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3,result4]\"）。每个结果必须是浮点数。对每个条目使用具有六位有效数字的科学记数法。\n\n提供一个完整的、可运行的程序，该程序构建周期性算子，求解 $\\chi_x$ 的线性系统，通过通量平均计算有效扩散，并按指定格式打印四个结果。程序不得读取任何输入。",
            "solution": "用户希望通过数值求解从双尺度均匀化理论推导出的晶胞问题，来计算周期性多孔介质的有效扩散系数 $D_{\\text{eff}}^{(x)}$。\n\n### 问题验证\n根据指定标准对问题陈述进行验证。\n\n#### 第1步：提取给定信息\n- **控制偏微分方程（晶胞问题）**：$Y$-周期修正函数 $\\chi_x(y)$ 的方程由下式给出\n$$ \\nabla \\cdot \\left( D(y)\\,\\nabla \\chi_x(y) \\right) - \\lambda\\,\\chi_x(y) = -\\frac{\\partial D(y)}{\\partial y_x} \\quad \\text{在 } Y = [0,1]^2 \\text{ 中} $$\n- **边界条件**：$\\chi_x(y)$ 在 $y_x$ 和 $y_y$ 方向上都是 $Y$-周期的。\n- **唯一性约束（对于 $\\lambda=0$）**：$\\int_Y \\chi_x(y)\\,dy = 0$。\n- **有效扩散公式**：有效扩散系数为\n$$ D_{\\text{eff}}^{(x)} = D_0 \\,\\overline{D}_{\\text{eff}}^{(x)}, \\quad \\text{其中} \\quad \\overline{D}_{\\text{eff}}^{(x)} = \\frac{1}{|Y|}\\int_Y D(y)\\left(1 + \\frac{\\partial \\chi_x(y)}{\\partial y_x}\\right) dy $$\n- **微观尺度扩散场**：无量纲系数 $D(y)$ 由下式给出\n$$ D(y_x,y_y) = 1 + a \\,\\sin(2\\pi y_x)\\,\\cos(2\\pi y_y) $$\n其中 $a \\in [0,0.5)$ 且 $\\lambda \\ge 0$。\n- **物理缩放因子**：$D_0$ 是一个参考扩散系数，单位为 $\\mathrm{m^2/s}$。\n- **数值离散化要求**：\n    1. 均匀网格 ($N_x \\times N_y$)。\n    2. 有限体积法或守恒有限差分格式。\n    3. 周期性边界条件。\n    4. 界面扩散系数采用算术平均。\n    5. 源项 $\\partial D/\\partial y_x$ 采用中心差分。\n    6. 最终计算中的梯度项 $\\partial \\chi_x/\\partial y_x$ 采用中心差分。\n    7. 对于 $\\lambda=0$，通过将 $\\chi_x$ 的一个网格值固定为零来施加规范条件。\n- **测试用例**：提供了一个包含四个参数集 $(N_x,N_y,D_0,a,\\lambda)$ 的列表：\n    1. $(64,64,1.5\\times 10^{-9},0.30,1.0)$\n    2. $(64,64,1.5\\times 10^{-9},0.30,0.0)$\n    3. $(96,48,2.0\\times 10^{-9},0.45,5.0)$\n    4. $(80,80,0.8\\times 10^{-9},0.10,50.0)$\n- **输出格式**：单行文本：一个用方括号括起来的逗号分隔的四个结果列表，每个结果采用六位有效数字的科学记数法格式。\n\n#### 第2步：使用提取的给定信息进行验证\n- **科学基础**：该问题基于周期性均匀化理论，这是一种多尺度分析中用于从微观物理推导宏观性质的标准且严谨的方法。控制偏微分方程是一个经典的椭圆型偏微分方程（亥姆霍兹型方程）。所有方面在科学上都是合理的。\n- **适定性**：晶胞问题是一个适定的线性椭圆型偏微分方程。对于 $\\lambda  0$，算子在周期函数空间上是可逆的，保证了唯一解。对于 $\\lambda = 0$，算子是奇异的，具有一维零空间（常数函数）。问题正确地指出了这个问题，并提供了一个标准的数值补救措施（通过将一个节点值设为零来进行规范固定），这与右侧项与零空间正交的事实（即 $\\int_Y -\\frac{\\partial D}{\\partial y_x} dy=0$）相结合，确保了离散化系统存在唯一解。$D_{\\text{eff}}^{(x)}$ 的计算仅依赖于 $\\chi_x$ 的导数，使其对规范选择的常数不敏感。\n- **客观性与完整性**：问题使用精确、形式化的数学语言陈述。所有必要的方程、参数、边界条件和数值程序都已明确定义，使得问题自洽且无歧义。\n- **可行性与一致性**：参数在物理上是合理的，条件 $a \\in [0,0.5)$ 正确地确保了 $D(y)$ 保持严格为正，这是偏微分方程的椭圆性所要求的。指定的网格分辨率对于现代科学计算库是可管理的。\n\n#### 第3步：结论与行动\n问题有效。将遵循指定的数值方法开发一个解决方案。\n\n### 数值求解算法\n\n求解方法是在均匀网格上离散化晶胞问题，并求解得到的线性系统以获得修正子 $\\chi_x$。然后通过数值积分计算有效系数 $D_{\\text{eff}}^{(x)}$。\n\n**1. 区域和场的离散化**\n单位晶胞 $Y=[0,1]^2$ 被离散化为 $N_x \\times N_y$ 的网格，网格点为单元中心点 $(y_{x,i}, y_{y,j})$，其中 $i=0,\\dots,N_x-1$ 且 $j=0,\\dots,N_y-1$。步长为 $h_x=1/N_x$ 和 $h_y=1/N_y$。标量场 $\\chi_x(y)$ 和 $D(y)$ 由它们在这些网格点上的值表示，记为 $\\chi_{i,j}$ 和 $D_{i,j}$。\n\n**2. 偏微分方程的离散化**\n使用守恒有限差分格式（等价于单元中心有限体积法）。在网格节点 $(i,j)$ 处的算子 $\\nabla \\cdot (D \\nabla \\chi_x)$ 使用考虑了周期性边界条件的五点格式进行离散化。节点 $(i,j)$（其线性索引为 $k = j \\cdot N_x + i$）的离散方程为：\n$$\n\\frac{D_{i+1/2,j}\\frac{\\chi_{i+1,j}-\\chi_{i,j}}{h_x} - D_{i-1/2,j}\\frac{\\chi_{i,j}-\\chi_{i-1,j}}{h_x}}{h_x} + \\frac{D_{i,j+1/2}\\frac{\\chi_{i,j+1}-\\chi_{i,j}}{h_y} - D_{i,j-1/2}\\frac{\\chi_{i,j}-\\chi_{i,j-1}}{h_y}}{h_y} - \\lambda \\chi_{i,j} = f_{i,j}\n$$\n- 界面扩散系数通过算术平均计算，例如 $D_{i+1/2,j} = (D_{i,j} + D_{i+1,j})/2$。\n- 源项 $f_{i,j}$ 是 $-\\partial D/\\partial y_x$ 在节点 $(i,j)$ 处的中心差分近似：$f_{i,j} = - (D_{i+1,j} - D_{i-1,j})/(2h_x)$。\n- 所有索引都使用模运算处理以强制周期性（例如，$i+1$ 变为 $(i+1) \\pmod{N_x}$）。\n\n这种离散化产生一个大型稀疏线性方程组 $A\\boldsymbol{\\chi} = \\boldsymbol{f}$，其中 $\\boldsymbol{\\chi}$ 和 $\\boldsymbol{f}$ 是展开的网格值 $\\chi_{i,j}$ 和 $f_{i,j}$ 的向量。\n\n**3. 求解线性系统**\n- 对于 $\\lambda  0$，矩阵 $A$ 是非奇异的，系统使用稀疏线性求解器直接求解。\n- 对于 $\\lambda=0$，矩阵 $A$ 是奇异的。通过应用规范条件获得唯一解。我们固定 $\\chi_{0,0}=0$。这是通过修改线性系统来实现的：矩阵 $A$ 的第一行被替换为零，除了对角线上的一个 $1$，向量 $\\boldsymbol{f}$ 的第一个元素被设置为零。为保持一致性，$A$ 的第一列中的所有条目（其他方程中对 $\\chi_{0,0}$ 的依赖项）也被设置为零。\n\n**4. 计算有效扩散**\n一旦找到修正子场 $\\boldsymbol{\\chi}$，它将被重塑为一个 $N_y \\times N_x$ 的网格。\n- 使用带周期性边界条件的中心差分在每个网格点计算梯度 $\\partial\\chi_x/\\partial y_x$：$(\\partial\\chi_x/\\partial y_x)_{i,j} \\approx (\\chi_{i+1,j} - \\chi_{i-1,j})/(2h_x)$。\n- 无量纲有效系数 $\\overline{D}_{\\text{eff}}^{(x)}$ 通过在所有网格点上对被积函数进行平均来计算：\n$$ \\overline{D}_{\\text{eff}}^{(x)} \\approx \\frac{1}{N_x N_y} \\sum_{j=0}^{N_y-1} \\sum_{i=0}^{N_x-1} D_{i,j}\\left(1 + \\left(\\frac{\\partial\\chi_x}{\\partial y_x}\\right)_{i,j}\\right) $$\n- 最终结果通过与物理参考系数缩放得到：$D_{\\text{eff}}^{(x)} = D_0 \\overline{D}_{\\text{eff}}^{(x)}$。\n\n整个过程在 Python 脚本中实现，使用 NumPy 进行数组操作，使用 SciPy 进行稀疏矩阵构建和求解。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse import linalg\n\ndef solve():\n    \"\"\"\n    Main function to solve the cell problem for all test cases and print results.\n    \"\"\"\n\n    def solve_cell_problem(params):\n        \"\"\"\n        Solves the periodic cell problem for a single set of parameters.\n\n        Args:\n            params (tuple): A tuple containing (Nx, Ny, D0, a, lambda).\n\n        Returns:\n            float: The computed effective diffusion coefficient D_eff^(x).\n        \"\"\"\n        Nx, Ny, D0, a, lam = params\n    \n        # 1. Grid setup\n        # Use a cell-centered grid where each point is at the center of a cell.\n        hx = 1.0 / Nx\n        hy = 1.0 / Ny\n        yx = np.arange(Nx) * hx + 0.5 * hx\n        yy = np.arange(Ny) * hy + 0.5 * hy\n        yx_grid, yy_grid = np.meshgrid(yx, yy)\n        N = Nx * Ny\n\n        # 2. Define D(y) field and the RHS vector f\n        D_grid = 1.0 + a * np.sin(2 * np.pi * yx_grid) * np.cos(2 * np.pi * yy_grid)\n        \n        # Discretize the source term f = -dD/dy_x using central differences.\n        # np.roll handles periodic boundaries automatically.\n        dD_dyx_grid = (np.roll(D_grid, -1, axis=1) - np.roll(D_grid, 1, axis=1)) / (2 * hx)\n        f = -dD_dyx_grid.flatten()\n        \n        # 3. Construct the sparse matrix A for the linear system A*chi = f\n        # We build the matrix in Coordinate (COO) format.\n        data = []\n        row_indices = []\n        col_indices = []\n\n        hx2 = hx**2\n        hy2 = hy**2\n\n        for j in range(Ny):  # y-index\n            for i in range(Nx):  # x-index\n                k = j * Nx + i  # Linear index for the current row\n                \n                # Neighbor indices (i,j) with periodic wrapping\n                ip1 = (i + 1) % Nx\n                im1 = (i - 1 + Nx) % Nx\n                jp1 = (j + 1) % Ny\n                jm1 = (j - 1 + Ny) % Ny\n\n                # Values of D at the current cell and its immediate neighbors\n                D_center = D_grid[j, i]\n                D_east = D_grid[j, ip1]\n                D_west = D_grid[j, im1]\n                D_north = D_grid[jp1, i]\n                D_south = D_grid[jm1, i]\n\n                # Coefficients for the 5-point stencil (conservative finite difference)\n                # Interface diffusion from arithmetic averaging, e.g., (D_center + D_east)/2\n                c_E = (D_center + D_east) / (2.0 * hx2)\n                c_W = (D_center + D_west) / (2.0 * hx2)\n                c_N = (D_center + D_north) / (2.0 * hy2)\n                c_S = (D_center + D_south) / (2.0 * hy2)\n                \n                c_C = -(c_E + c_W + c_N + c_S) - lam\n\n                # Append stencil coefficients and their locations to the COO lists\n                # East neighbor\n                row_indices.append(k); col_indices.append(j * Nx + ip1); data.append(c_E)\n                # West neighbor\n                row_indices.append(k); col_indices.append(j * Nx + im1); data.append(c_W)\n                # North neighbor\n                row_indices.append(k); col_indices.append(jp1 * Nx + i); data.append(c_N)\n                # South neighbor\n                row_indices.append(k); col_indices.append(jm1 * Nx + i); data.append(c_S)\n                # Center (diagonal term)\n                row_indices.append(k); col_indices.append(k); data.append(c_C)\n                \n        # Create a Compressed Sparse Row (CSR) matrix, efficient for solvers.\n        A = sparse.csr_matrix((data, (row_indices, col_indices)), shape=(N, N))\n\n        # 4. Handle singularity for lambda = 0 by enforcing a gauge condition\n        if lam == 0.0:\n            # Fix chi(0,0) = 0. This corresponds to the first element (k=0) of the flattened vector.\n            # Convert to CSC format for efficient column modification.\n            A = A.tocsc()\n            A[:, 0] = 0.0  # Zero out column 0 (dependencies on chi_0 from other equations).\n            A = A.tocsr()    # Convert back to CSR for row modification and solving.\n            A[0, :] = 0.0  # Zero out row 0 (the old equation for chi_0).\n            A[0, 0] = 1.0  # Set diagonal to 1 for the new equation: 1*chi_0 = 0.\n            f[0] = 0.0     # Set RHS to 0 for this equation.\n\n        # 5. Solve the linear system A*chi = f\n        chi_flat = linalg.spsolve(A, f)\n        \n        # 6. Compute the effective diffusion coefficient D_eff^(x)\n        # Reshape the solution vector back to a 2D grid.\n        chi = chi_flat.reshape((Ny, Nx))\n        \n        # Calculate d(chi)/dy_x via central differences with periodic boundaries.\n        dchi_dyx = (np.roll(chi, -1, axis=1) - np.roll(chi, 1, axis=1)) / (2 * hx)\n        \n        # Calculate the integrand D * (1 + dchi/dyx).\n        integrand = D_grid * (1.0 + dchi_dyx)\n        \n        # Approximate the integral over Y by averaging over all grid cells. |Y|=1.\n        D_eff_bar = np.mean(integrand)\n        \n        # Scale by the physical reference coefficient to get the final dimensional result.\n        D_eff_x = D0 * D_eff_bar\n        \n        return D_eff_x\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (64, 64, 1.5e-9, 0.30, 1.0),\n        (64, 64, 1.5e-9, 0.30, 0.0),\n        (96, 48, 2.0e-9, 0.45, 5.0),\n        (80, 80, 0.8e-9, 0.10, 50.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_cell_problem(case)\n        results.append(result)\n\n    # Format the final output according to problem specifications.\n    # Each result is a string in scientific notation with six significant digits.\n    formatted_results = [f\"{res:.5e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}