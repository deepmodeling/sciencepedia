{
    "hands_on_practices": [
        {
            "introduction": "While Coulomb's law is fundamental, it describes interactions in a vacuum. This first exercise explores how this interaction is modified when charges are embedded in a material medium, a crucial concept in condensed matter physics and biology. You will apply the Clausius–Mossotti relation to connect the microscopic polarizability of a material to its macroscopic dielectric constant, $\\epsilon_{r}$, and quantify the resulting screening of the electric field . This practice provides a concrete calculation linking microscopic properties to a macroscopic phenomenon, a cornerstone of multiscale analysis.",
            "id": "3753383",
            "problem": "A point charge of magnitude $q$ is embedded at the origin of an infinite, homogeneous, isotropic, linear dielectric. The material’s microscopic response is characterized by a molecular polarizability $\\alpha$ and a number density $N$, which can be connected to the macroscopic relative permittivity $\\epsilon_{r}$ via the Clausius–Mossotti (CM) relation. Starting from Maxwell’s equations in electrostatics and standard constitutive relations, derive the macroscopic electric field magnitude $E(r)$ at a distance $r$ from the charge. Then, quantify the reduction in the field magnitude relative to vacuum using the ratio $E_{\\text{dielectric}}(r)/E_{\\text{vacuum}}(r)$. \n\nUse the following data:\n- Free-space permittivity $\\epsilon_{0} = 8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F}\\,\\text{m}^{-1}$.\n- Charge $q = 1.00 \\times 10^{-9}\\ \\text{C}$.\n- Observation distance $r = 1.00 \\times 10^{-2}\\ \\text{m}$.\n- Molecular polarizability $\\alpha = 4.56 \\times 10^{-40}\\ \\text{C}\\,\\text{m}^{2}\\,\\text{V}^{-1}$.\n- Number density $N = 2.50 \\times 10^{28}\\ \\text{m}^{-3}$.\n\nAssumptions:\n- The medium is linear, homogeneous, and isotropic, and there are no additional free charges or boundaries present.\n- The Clausius–Mossotti relation holds in the form $\\displaystyle \\frac{\\epsilon_{r} - 1}{\\epsilon_{r} + 2} = \\frac{N \\alpha}{3 \\epsilon_{0}}$.\n\nTasks:\n1. Starting from the divergence form of Maxwell’s equations for electrostatics and the constitutive relation for a linear dielectric, derive the spherical-symmetry expression for the macroscopic field $E(r)$ in the dielectric.\n2. Use the Clausius–Mossotti relation to compute $\\epsilon_{r}$ from $\\alpha$, $N$, and $\\epsilon_{0}$, and hence evaluate the reduction factor $\\displaystyle \\frac{E_{\\text{dielectric}}(r)}{E_{\\text{vacuum}}(r)}$.\n3. Evaluate numerically the magnitudes $E_{\\text{vacuum}}(r)$ and $E_{\\text{dielectric}}(r)$ and express these in $\\text{kV}\\,\\text{m}^{-1}$.\n\nAnswer specification:\n- As your final answer, report only the reduction factor $\\displaystyle \\frac{E_{\\text{dielectric}}(r)}{E_{\\text{vacuum}}(r)}$ as a decimal number rounded to four significant figures.\n- If you compute $E$ magnitudes, express them in $\\text{kV}\\,\\text{m}^{-1}$, but do not include them in the final reported answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- Point charge at the origin: $q = 1.00 \\times 10^{-9}\\ \\text{C}$.\n- Medium: infinite, homogeneous, isotropic, linear dielectric.\n- Microscopic properties: molecular polarizability $\\alpha = 4.56 \\times 10^{-40}\\ \\text{C}\\,\\text{m}^{2}\\,\\text{V}^{-1}$, number density $N = 2.50 \\times 10^{28}\\ \\text{m}^{-3}$.\n- Fundamental constant: free-space permittivity $\\epsilon_{0} = 8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F}\\,\\text{m}^{-1}$.\n- Observation distance: $r = 1.00 \\times 10^{-2}\\ \\text{m}$.\n- Constitutive relation: Clausius–Mossotti (CM) relation $\\displaystyle \\frac{\\epsilon_{r} - 1}{\\epsilon_{r} + 2} = \\frac{N \\alpha}{3 \\epsilon_{0}}$.\n- Assumptions: The medium is linear, homogeneous, and isotropic, with no additional free charges or boundaries.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity:\n- **Scientifically Grounded**: The problem is based on fundamental principles of electrostatics, specifically Maxwell's equations and the behavior of dielectric materials. The Clausius-Mossotti relation is a standard and well-established model in this context. All aspects are firmly grounded in physics.\n- **Well-Posed**: The problem is well-posed. The givens are sufficient to determine a unique solution for the requested quantities. The tasks are clearly specified and lead to a unique numerical answer.\n- **Objective**: The language is precise and quantitative, free from subjective or ambiguous statements.\n- **Completeness and Consistency**: The problem provides all necessary data and a consistent physical model. The units of the provided quantities ($\\alpha$, $N$, $\\epsilon_0$) are consistent, leading to a dimensionless value for the term $\\frac{N\\alpha}{3\\epsilon_0}$.\n- **Realism**: The values for polarizability and number density are physically plausible for a solid or liquid dielectric.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a standard exercise in electromagnetism that tests the connection between microscopic and macroscopic descriptions of dielectrics. The solution process may proceed.\n\n### Solution Derivation\n\n**1. Macroscopic Electric Field in the Dielectric**\n\nThe analysis begins with Maxwell's first equation for electrostatics (Gauss's law for the electric displacement field $\\mathbf{D}$), which relates $\\mathbf{D}$ to the free charge density $\\rho_{\\text{free}}$:\n$$ \\nabla \\cdot \\mathbf{D} = \\rho_{\\text{free}} $$\nFor a single point charge $q$ located at the origin, the free charge density is given by $\\rho_{\\text{free}}(\\mathbf{r}) = q \\delta(\\mathbf{r})$, where $\\delta(\\mathbf{r})$ is the three-dimensional Dirac delta function.\n\nIn its integral form, Gauss's law states that the flux of $\\mathbf{D}$ through a closed surface $\\mathcal{S}$ is equal to the total free charge enclosed, $Q_{\\text{free, enc}}$:\n$$ \\oint_{\\mathcal{S}} \\mathbf{D} \\cdot d\\mathbf{A} = Q_{\\text{free, enc}} $$\nDue to the spherical symmetry of the problem, the electric displacement field must be purely radial, i.e., $\\mathbf{D}(\\mathbf{r}) = D(r) \\hat{\\mathbf{r}}$. We choose a spherical Gaussian surface $\\mathcal{S}$ of radius $r$ centered at the origin. The enclosed free charge is $Q_{\\text{free, enc}} = q$. The integral simplifies to:\n$$ D(r) \\cdot (4 \\pi r^2) = q $$\nSolving for the magnitude $D(r)$ gives:\n$$ D(r) = \\frac{q}{4 \\pi r^2} $$\nFor a linear, isotropic, and homogeneous (LIH) dielectric, the electric field $\\mathbf{E}$ is related to the electric displacement $\\mathbf{D}$ by the constitutive relation:\n$$ \\mathbf{D} = \\epsilon \\mathbf{E} = \\epsilon_r \\epsilon_0 \\mathbf{E} $$\nwhere $\\epsilon$ is the permittivity of the material and $\\epsilon_r$ is the relative permittivity (or dielectric constant).\n\nSubstituting the expression for $\\mathbf{D}(r)$ allows us to find the macroscopic electric field $\\mathbf{E}_{\\text{dielectric}}(r)$:\n$$ \\mathbf{E}_{\\text{dielectric}}(r) = \\frac{\\mathbf{D}(r)}{\\epsilon_r \\epsilon_0} = \\frac{1}{\\epsilon_r \\epsilon_0} \\frac{q}{4 \\pi r^2} \\hat{\\mathbf{r}} $$\nThe magnitude of this field is:\n$$ E_{\\text{dielectric}}(r) = \\frac{q}{4 \\pi \\epsilon_r \\epsilon_0 r^2} $$\n\n**2. Reduction Factor**\n\nThe electric field from the same charge $q$ in a vacuum is given by Coulomb's law:\n$$ E_{\\text{vacuum}}(r) = \\frac{q}{4 \\pi \\epsilon_0 r^2} $$\nThe reduction factor is the ratio of the field magnitude in the dielectric to the field magnitude in vacuum:\n$$ \\frac{E_{\\text{dielectric}}(r)}{E_{\\text{vacuum}}(r)} = \\frac{q / (4 \\pi \\epsilon_r \\epsilon_0 r^2)}{q / (4 \\pi \\epsilon_0 r^2)} = \\frac{1}{\\epsilon_r} $$\nThus, the reduction factor is simply the reciprocal of the relative permittivity.\n\n**3. Calculation of Relative Permittivity $\\epsilon_r$**\n\nTo find the reduction factor, we must first compute $\\epsilon_r$ using the given Clausius-Mossotti relation:\n$$ \\frac{\\epsilon_r - 1}{\\epsilon_r + 2} = \\frac{N \\alpha}{3 \\epsilon_0} $$\nLet's define a dimensionless quantity $X = \\frac{N \\alpha}{3 \\epsilon_0}$. We calculate its value using the provided data:\n- $N = 2.50 \\times 10^{28}\\ \\text{m}^{-3}$\n- $\\alpha = 4.56 \\times 10^{-40}\\ \\text{C}\\,\\text{m}^{2}\\,\\text{V}^{-1}$ (Note: $\\text{C V}^{-1} = \\text{F}$, so the unit is $\\text{F}\\,\\text{m}^2$)\n- $\\epsilon_0 = 8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F}\\,\\text{m}^{-1}$\n\nFirst, the numerator:\n$$ N \\alpha = (2.50 \\times 10^{28}\\ \\text{m}^{-3}) \\times (4.56 \\times 10^{-40}\\ \\text{F m}^2) = 1.14 \\times 10^{-11}\\ \\text{F m}^{-1} $$\nNext, the denominator:\n$$ 3 \\epsilon_0 = 3 \\times (8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F m}^{-1}) \\approx 2.656256 \\times 10^{-11}\\ \\text{F m}^{-1} $$\nNow, the value of $X$ is:\n$$ X = \\frac{1.14 \\times 10^{-11}}{2.656256... \\times 10^{-11}} \\approx 0.4291708 $$\nNow we rearrange the Clausius-Mossotti relation to solve for $\\epsilon_r$:\n$$ \\frac{\\epsilon_r - 1}{\\epsilon_r + 2} = X $$\n$$ \\epsilon_r - 1 = X (\\epsilon_r + 2) $$\n$$ \\epsilon_r - 1 = X \\epsilon_r + 2X $$\n$$ \\epsilon_r - X \\epsilon_r = 1 + 2X $$\n$$ \\epsilon_r (1 - X) = 1 + 2X $$\n$$ \\epsilon_r = \\frac{1 + 2X}{1 - X} $$\nSubstituting the numerical value for $X$:\n$$ \\epsilon_r = \\frac{1 + 2(0.4291708)}{1 - 0.4291708} = \\frac{1 + 0.8583416}{0.5708292} = \\frac{1.8583416}{0.5708292} \\approx 3.25553 $$\nThe reduction factor is $1/\\epsilon_r$:\n$$ \\frac{E_{\\text{dielectric}}(r)}{E_{\\text{vacuum}}(r)} = \\frac{1}{\\epsilon_r} \\approx \\frac{1}{3.25553} \\approx 0.307168 $$\nRounding to four significant figures as requested, the reduction factor is $0.3072$.\n\n**4. Numerical Evaluation of Electric Fields (Supplementary)**\n\nAs per the prompt, we also evaluate the field magnitudes.\n$$ E_{\\text{vacuum}}(r) = \\frac{q}{4 \\pi \\epsilon_0 r^2} = \\frac{1.00 \\times 10^{-9}\\ \\text{C}}{4\\pi(8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F m}^{-1})(1.00 \\times 10^{-2}\\ \\text{m})^2} $$\n$$ E_{\\text{vacuum}}(r) \\approx 89875.5\\ \\text{V m}^{-1} = 89.9\\ \\text{kV m}^{-1} $$\nThe field in the dielectric is:\n$$ E_{\\text{dielectric}}(r) = \\frac{E_{\\text{vacuum}}(r)}{\\epsilon_r} \\approx \\frac{89875.5\\ \\text{V m}^{-1}}{3.25553} \\approx 27607.7\\ \\text{V m}^{-1} = 27.6\\ \\text{kV m}^{-1} $$\nThese numerical values confirm the physics: the dielectric material, through polarization, creates an opposing internal field that reduces the net macroscopic field from its vacuum value. The final answer required is only the reduction factor.",
            "answer": "$$\\boxed{0.3072}$$"
        },
        {
            "introduction": "The classical Coulomb potential, with its $1/r$ dependence, presents a singularity at $r=0$, leading to an unphysical infinite self-energy for a point charge. This exercise introduces regularization, a powerful mathematical technique used in theoretical and computational physics to tame such divergences . By analyzing a \"smoothed\" potential, you will calculate its finite value at the origin, its finite total energy, and its asymptotic behavior, gaining insight into how multiscale models can bridge different length scales by modifying fundamental laws in a controlled way.",
            "id": "3753379",
            "problem": "Consider a point charge of magnitude $q$ located at the origin in vacuum with permittivity $\\varepsilon_{0}$. In standard electrostatics, the potential due to a point charge is determined by a kernel proportional to $1/r$, where $r$ is the radial coordinate. To model microscale smoothing while maintaining far-field consistency, consider the regularized kernel $1/\\sqrt{r^{2}+a^{2}}$ with a fixed smoothing length $a0$. Define the electrostatic potential $\\phi(\\mathbf{r})$ by convolving this kernel with the charge density $\\rho(\\mathbf{r})$, and define the electric field $\\mathbf{E}(\\mathbf{r})$ as the negative gradient of the potential. The electrostatic energy in vacuum is obtained by integrating the energy density given by $(\\varepsilon_{0}/2)|\\mathbf{E}(\\mathbf{r})|^{2}$ over all space.\n\nStarting from the fundamental definitions\n- the potential generated by a charge distribution $\\rho(\\mathbf{r})$ as\n$$\n\\phi(\\mathbf{r})=\\frac{1}{4\\pi\\varepsilon_{0}}\\int_{\\mathbb{R}^{3}}\\frac{\\rho(\\mathbf{r}')}{\\sqrt{|\\mathbf{r}-\\mathbf{r}'|^{2}+a^{2}}}\\,\\mathrm{d}^{3}\\mathbf{r}'\\!,\n$$\n- the electric field as $\\mathbf{E}(\\mathbf{r})=-\\nabla \\phi(\\mathbf{r})$,\n- and the total electrostatic energy as\n$$\nU=\\int_{\\mathbb{R}^{3}}\\frac{\\varepsilon_{0}}{2}\\,|\\mathbf{E}(\\mathbf{r})|^{2}\\,\\mathrm{d}^{3}\\mathbf{r},\n$$\nwith the point-charge density $\\rho(\\mathbf{r})=q\\,\\delta^{(3)}(\\mathbf{r})$ where $\\delta^{(3)}(\\cdot)$ denotes the three-dimensional Dirac delta distribution, carry out a multiscale analysis of the regularized model and compute the following quantities exactly in terms of $q$, $\\varepsilon_{0}$, and $a$:\n\n1. The finite near-field potential value $\\phi(0)$.\n2. The total electrostatic energy $U$ stored in the field generated by the regularized point charge.\n3. The leading-order far-field correction coefficient $C$ defined by the asymptotic difference between the regularized potential and the Coulomb potential,\n$$\n\\Delta\\phi(r)=\\phi(r)-\\frac{q}{4\\pi\\varepsilon_{0}\\,r}=\\frac{C}{r^{3}}+o\\!\\left(\\frac{1}{r^{3}}\\right)\\quad\\text{as}\\quad r\\to\\infty,\n$$\nwhere $r=|\\mathbf{r}|$.\n\nReport $\\phi(0)$ in volts, $U$ in joules, and $C$ in volt·meter$^{3}$, but do not include units in your final boxed answer. No numerical approximation is required; provide exact closed-form expressions. Your final answer must be a single row of three expressions using the LaTeX $\\mathrm{pmatrix}$ environment.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- Charge distribution: $\\rho(\\mathbf{r}) = q\\,\\delta^{(3)}(\\mathbf{r})$, where $q$ is the charge magnitude and $\\delta^{(3)}(\\cdot)$ is the three-dimensional Dirac delta distribution.\n- Location of charge: The origin, $\\mathbf{r}=\\mathbf{0}$.\n- Medium: Vacuum with permittivity $\\varepsilon_{0}$.\n- Regularized potential definition: $$\\phi(\\mathbf{r})=\\frac{1}{4\\pi\\varepsilon_{0}}\\int_{\\mathbb{R}^{3}}\\frac{\\rho(\\mathbf{r}')}{\\sqrt{|\\mathbf{r}-\\mathbf{r}'|^{2}+a^{2}}}\\,\\mathrm{d}^{3}\\mathbf{r}'$$ where $a0$ is a fixed smoothing length.\n- Electric field definition: $\\mathbf{E}(\\mathbf{r})=-\\nabla \\phi(\\mathbf{r})$.\n- Total electrostatic energy definition: $$U=\\int_{\\mathbb{R}^{3}}\\frac{\\varepsilon_{0}}{2}\\,|\\mathbf{E}(\\mathbf{r})|^{2}\\,\\mathrm{d}^{3}\\mathbf{r}$$\n- Asymptotic difference definition: $$\\Delta\\phi(r)=\\phi(r)-\\frac{q}{4\\pi\\varepsilon_{0}\\,r}=\\frac{C}{r^{3}}+o\\!\\left(\\frac{1}{r^{3}}\\right)\\quad\\text{as}\\quad r\\to\\infty$$ where $r=|\\mathbf{r}|$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a regularized model of the electrostatic potential. Such regularizations are common and necessary in classical and quantum field theories, as well as in numerical simulations (e.g., particle-in-cell methods) to remove unphysical singularities associated with point charges. The model is a well-established theoretical construct used to study properties of fields while avoiding divergences. It does not violate fundamental principles but rather modifies them in a controlled manner for analysis.\n- **Well-Posed**: All necessary functions, constants, and relationships are explicitly defined. The tasks are to compute specific, well-defined quantities ($\\phi(0)$, $U$, $C$) based on the provided framework. The regularization parameter $a0$ ensures that the quantities to be calculated are finite.\n- **Objective**: The problem is stated in precise mathematical language, free from ambiguity or subjective content.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a self-contained, scientifically grounded, and well-posed problem in theoretical physics. I will now proceed with the solution.\n\n---\n\nThe solution requires the computation of three distinct quantities based on the provided regularized model of electrostatics.\n\n**1. Calculation of the near-field potential $\\phi(0)$**\n\nThe electrostatic potential $\\phi(\\mathbf{r})$ is defined by the convolution of the charge density $\\rho(\\mathbf{r}')$ with the regularized kernel.\n$$\n\\phi(\\mathbf{r})=\\frac{1}{4\\pi\\varepsilon_{0}}\\int_{\\mathbb{R}^{3}}\\frac{\\rho(\\mathbf{r}')}{\\sqrt{|\\mathbf{r}-\\mathbf{r}'|^{2}+a^{2}}}\\,\\mathrm{d}^{3}\\mathbf{r}'\n$$\nSubstituting the point-charge density $\\rho(\\mathbf{r}')=q\\,\\delta^{(3)}(\\mathbf{r}')$ into this expression gives:\n$$\n\\phi(\\mathbf{r})=\\frac{1}{4\\pi\\varepsilon_{0}}\\int_{\\mathbb{R}^{3}}\\frac{q\\,\\delta^{(3)}(\\mathbf{r}')}{\\sqrt{|\\mathbf{r}-\\mathbf{r}'|^{2}+a^{2}}}\\,\\mathrm{d}^{3}\\mathbf{r}'\n$$\nBy applying the sifting property of the Dirac delta distribution, which states $\\int f(\\mathbf{x}')\\delta^{(3)}(\\mathbf{x}')\\mathrm{d}^3\\mathbf{x}' = f(\\mathbf{0})$, we evaluate the integral by setting $\\mathbf{r}' = \\mathbf{0}$:\n$$\n\\phi(\\mathbf{r}) = \\frac{q}{4\\pi\\varepsilon_{0}} \\frac{1}{\\sqrt{|\\mathbf{r}-\\mathbf{0}|^{2}+a^{2}}} = \\frac{q}{4\\pi\\varepsilon_{0}\\sqrt{r^{2}+a^{2}}}\n$$\nwhere $r = |\\mathbf{r}|$ is the radial distance from the origin.\n\nTo find the potential at the origin, we set $\\mathbf{r}=\\mathbf{0}$, which corresponds to $r=0$:\n$$\n\\phi(0) = \\frac{q}{4\\pi\\varepsilon_{0}\\sqrt{0^{2}+a^{2}}} = \\frac{q}{4\\pi\\varepsilon_{0}a}\n$$\nThe regularization eliminates the infinite self-potential of a classical point charge, yielding a finite value at the origin.\n\n**2. Calculation of the total electrostatic energy $U$**\n\nThe total energy $U$ is given by the integral of the energy density over all space:\n$$\nU=\\int_{\\mathbb{R}^{3}}\\frac{\\varepsilon_{0}}{2}\\,|\\mathbf{E}(\\mathbf{r})|^{2}\\,\\mathrm{d}^{3}\\mathbf{r}\n$$\nFirst, we must determine the electric field $\\mathbf{E}(\\mathbf{r})$ by taking the negative gradient of the potential $\\phi(\\mathbf{r})$. Since $\\phi$ is radially symmetric, the gradient in spherical coordinates is $\\nabla\\phi = \\frac{\\partial\\phi}{\\partial r}\\hat{\\mathbf{r}}$.\n$$\n\\frac{\\partial\\phi}{\\partial r} = \\frac{\\partial}{\\partial r}\\left(\\frac{q}{4\\pi\\varepsilon_{0}}(r^{2}+a^{2})^{-1/2}\\right) = \\frac{q}{4\\pi\\varepsilon_{0}}\\left(-\\frac{1}{2}\\right)(r^{2}+a^{2})^{-3/2}(2r) = -\\frac{qr}{4\\pi\\varepsilon_{0}(r^{2}+a^{2})^{3/2}}\n$$\nThus, the electric field is:\n$$\n\\mathbf{E}(\\mathbf{r}) = -\\nabla\\phi = \\frac{qr}{4\\pi\\varepsilon_{0}(r^{2}+a^{2})^{3/2}}\\hat{\\mathbf{r}}\n$$\nThe magnitude squared of the electric field is:\n$$\n|\\mathbf{E}(\\mathbf{r})|^{2} = \\left(\\frac{qr}{4\\pi\\varepsilon_{0}(r^{2}+a^{2})^{3/2}}\\right)^{2} = \\frac{q^{2}r^{2}}{(4\\pi\\varepsilon_{0})^{2}(r^{2}+a^{2})^{3}}\n$$\nNow, we substitute this into the energy integral. We use spherical coordinates for the volume element, $\\mathrm{d}^{3}\\mathbf{r} = r^{2}\\sin\\theta\\,\\mathrm{d}r\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$. Since the integrand depends only on $r$, the angular integration yields a factor of $4\\pi$.\n$$\nU = \\frac{\\varepsilon_{0}}{2} \\int_{0}^{2\\pi}\\int_{0}^{\\pi}\\int_{0}^{\\infty} \\frac{q^{2}r^{2}}{(4\\pi\\varepsilon_{0})^{2}(r^{2}+a^{2})^{3}} r^{2}\\sin\\theta\\,\\mathrm{d}r\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi\n$$\n$$\nU = \\frac{\\varepsilon_{0}}{2} \\frac{q^{2}}{16\\pi^{2}\\varepsilon_{0}^{2}} (4\\pi) \\int_{0}^{\\infty} \\frac{r^{4}}{(r^{2}+a^{2})^{3}}\\,\\mathrm{d}r = \\frac{q^{2}}{8\\pi\\varepsilon_{0}} \\int_{0}^{\\infty} \\frac{r^{4}}{(r^{2}+a^{2})^{3}}\\,\\mathrm{d}r\n$$\nTo evaluate the remaining integral, $I = \\int_{0}^{\\infty} \\frac{r^{4}}{(r^{2}+a^{2})^{3}}\\,\\mathrm{d}r$, we perform a trigonometric substitution $r = a\\tan\\psi$, which implies $\\mathrm{d}r = a\\sec^{2}\\psi\\,\\mathrm{d}\\psi$. The limits of integration change from $r\\in[0, \\infty)$ to $\\psi\\in[0, \\pi/2)$.\n$$\nI = \\int_{0}^{\\pi/2} \\frac{(a\\tan\\psi)^{4}}{(a^{2}\\tan^{2}\\psi+a^{2})^{3}} (a\\sec^{2}\\psi)\\,\\mathrm{d}\\psi = \\int_{0}^{\\pi/2} \\frac{a^{4}\\tan^{4}\\psi}{(a^{2}\\sec^{2}\\psi)^{3}} (a\\sec^{2}\\psi)\\,\\mathrm{d}\\psi\n$$\n$$\nI = \\int_{0}^{\\pi/2} \\frac{a^{5}\\tan^{4}\\psi\\sec^{2}\\psi}{a^{6}\\sec^{6}\\psi}\\,\\mathrm{d}\\psi = \\frac{1}{a} \\int_{0}^{\\pi/2} \\frac{\\tan^{4}\\psi}{\\sec^{4}\\psi}\\,\\mathrm{d}\\psi = \\frac{1}{a} \\int_{0}^{\\pi/2} \\frac{\\sin^{4}\\psi/\\cos^{4}\\psi}{1/\\cos^{4}\\psi}\\,\\mathrm{d}\\psi = \\frac{1}{a} \\int_{0}^{\\pi/2} \\sin^{4}\\psi\\,\\mathrm{d}\\psi\n$$\nThis is a standard Wallis integral:\n$$\n\\int_{0}^{\\pi/2} \\sin^{4}\\psi\\,\\mathrm{d}\\psi = \\frac{4-1}{4} \\cdot \\frac{4-3}{4-2} \\cdot \\frac{\\pi}{2} = \\frac{3}{4} \\cdot \\frac{1}{2} \\cdot \\frac{\\pi}{2} = \\frac{3\\pi}{16}\n$$\nTherefore, $I = \\frac{1}{a}\\frac{3\\pi}{16}$. Substituting this back into the expression for $U$:\n$$\nU = \\frac{q^{2}}{8\\pi\\varepsilon_{0}} \\left(\\frac{3\\pi}{16a}\\right) = \\frac{3q^{2}}{128\\varepsilon_{0}a}\n$$\nThis finite self-energy is a direct consequence of the regularization.\n\n**3. Calculation of the far-field correction coefficient $C$**\n\nWe are asked to find the coefficient $C$ in the asymptotic expansion of the potential difference:\n$$\n\\Delta\\phi(r)=\\phi(r)-\\phi_{\\text{Coulomb}}(r)=\\frac{C}{r^{3}}+o\\!\\left(\\frac{1}{r^{3}}\\right)\n$$\nwhere $\\phi_{\\text{Coulomb}}(r) = \\frac{q}{4\\pi\\varepsilon_{0}r}$. We start with our expression for $\\phi(r)$ and expand it for large $r$:\n$$\n\\phi(r) = \\frac{q}{4\\pi\\varepsilon_{0}\\sqrt{r^{2}+a^{2}}} = \\frac{q}{4\\pi\\varepsilon_{0}r\\sqrt{1+a^{2}/r^{2}}} = \\frac{q}{4\\pi\\varepsilon_{0}r}\\left(1+\\frac{a^{2}}{r^{2}}\\right)^{-1/2}\n$$\nUsing the generalized binomial series $(1+x)^{\\alpha} = 1 + \\alpha x + \\frac{\\alpha(\\alpha-1)}{2!}x^{2} + \\dots$ with $x=a^{2}/r^{2}$ and $\\alpha=-1/2$:\n$$\n\\left(1+\\frac{a^{2}}{r^{2}}\\right)^{-1/2} = 1 + \\left(-\\frac{1}{2}\\right)\\frac{a^{2}}{r^{2}} + \\frac{(-1/2)(-3/2)}{2}\\left(\\frac{a^{2}}{r^{2}}\\right)^{2} + O\\left(\\frac{1}{r^{6}}\\right)\n$$\n$$\n= 1 - \\frac{a^{2}}{2r^{2}} + \\frac{3a^{4}}{8r^{4}} + O\\left(\\frac{1}{r^{6}}\\right)\n$$\nSubstituting this series back into the expression for $\\phi(r)$:\n$$\n\\phi(r) = \\frac{q}{4\\pi\\varepsilon_{0}r}\\left(1 - \\frac{a^{2}}{2r^{2}} + O\\left(\\frac{1}{r^{4}}\\right)\\right) = \\frac{q}{4\\pi\\varepsilon_{0}r} - \\frac{qa^{2}}{8\\pi\\varepsilon_{0}r^{3}} + O\\left(\\frac{1}{r^{5}}\\right)\n$$\nThe potential difference is then:\n$$\n\\Delta\\phi(r) = \\left(\\frac{q}{4\\pi\\varepsilon_{0}r} - \\frac{qa^{2}}{8\\pi\\varepsilon_{0}r^{3}} + \\dots\\right) - \\frac{q}{4\\pi\\varepsilon_{0}r} = -\\frac{qa^{2}}{8\\pi\\varepsilon_{0}r^{3}} + O\\left(\\frac{1}{r^{5}}\\right)\n$$\nBy comparing this with the specified form $\\Delta\\phi(r) = C/r^{3} + o(1/r^{3})$, we can identify the coefficient $C$:\n$$\nC = -\\frac{qa^{2}}{8\\pi\\varepsilon_{0}}\n$$\nThe leading-order correction to the Coulomb potential in the far-field is of dipole-like character (in terms of radial decay, not angular dependence) and its strength depends on the smoothing length $a$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{q}{4\\pi\\varepsilon_{0}a}  \\frac{3q^{2}}{128\\varepsilon_{0}a}  -\\frac{qa^{2}}{8\\pi\\varepsilon_{0}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The ultimate test of a physical model often lies in its computational implementation. This hands-on coding problem addresses the practical challenges of translating physical laws into robust numerical algorithms. You are tasked with writing a program to verify that a simulation of interacting point charges respects Newton's third law, $\\mathbf{F}_{ij} = -\\mathbf{F}_{ji}$, which is a statement of action-reaction symmetry essential for momentum conservation . This exercise will guide you in developing diagnostics to quantify numerical errors and identify ill-posed conditions, highlighting the critical role of verification in computational science.",
            "id": "3753397",
            "problem": "You will write a complete, runnable program that performs numerical symmetry tests on pairwise electrostatic forces to assess whether the computed forces are consistent with Newton’s third law within specified tolerances. The program must compute forces between point charges in three-dimensional space under the Superposition Principle, and it must produce diagnostics that quantify and localize potential violations of Newton’s third law arising from numerical computation and ill-posed geometries.\n\nFundamental base and definitions to use: The interaction between point charges is given by Coulomb’s law, which states that the force on charge $q_i$ due to charge $q_j$ is proportional to the product $q_i q_j$ and directed along the line connecting them, with magnitude inversely proportional to the square of the distance between them. Newton’s third law states action equals reaction, meaning the force exerted by $q_i$ on $q_j$ is equal in magnitude and opposite in direction to the force exerted by $q_j$ on $q_i$. The Superposition Principle states the total force on a charge is the vector sum of the forces from all other charges. Use the International System of Units (SI), with distances in meters and forces in newtons.\n\nYour program must implement the following steps for each test case:\n\n- Compute all unordered pairwise interactions between charges. For each unordered pair $\\{i,j\\}$, compute the vector displacement $\\mathbf{r}_{ij} = \\mathbf{x}_j - \\mathbf{x}_i$ and its Euclidean norm $r_{ij} = \\|\\mathbf{r}_{ij}\\|_2$. If $r_{ij} = 0$, classify this pair as an ill-posed singularity. For such pairs, do not compute forces and mark them as a violation event.\n- For each valid pair with $r_{ij} \\neq 0$, compute the pairwise forces $\\mathbf{F}_{ij}$ and $\\mathbf{F}_{ji}$ using Coulomb’s law and the Superposition Principle, where the Coulomb constant $k$ is $k = \\frac{1}{4\\pi\\varepsilon_0}$ with $\\varepsilon_0 = 8.8541878128\\times 10^{-12}$ farads per meter. Use vector normalization and inverse-square scaling in SI units to produce forces in newtons.\n- For each valid pair, compute the action-reaction residual vector $\\mathbf{M}_{ij} = \\mathbf{F}_{ij} + \\mathbf{F}_{ji}$, and the relative symmetry mismatch $m_{ij} = \\frac{\\|\\mathbf{M}_{ij}\\|_2}{\\|\\mathbf{F}_{ij}\\|_2 + \\|\\mathbf{F}_{ji}\\|_2}$, which is unitless.\n- Aggregate diagnostics:\n    1. The maximum relative mismatch over valid pairs, denoted $m_{\\max}$.\n    2. The total net force over all particles $\\mathbf{F}_{\\mathrm{tot}} = \\sum_i \\mathbf{F}_i$ and its Euclidean norm $G = \\|\\mathbf{F}_{\\mathrm{tot}}\\|_2$, expressed in newtons.\n    3. The separation condition number $K = \\frac{\\max\\{r_{ij}: r_{ij}  0\\}}{\\min\\{r_{ij}: r_{ij}  0\\}}$; if no valid nonzero distances exist, define $K$ to be $+\\infty$.\n    4. The count of violating pairs $V$, defined as the number of unordered pairs that either have $r_{ij}=0$ or have $m_{ij}$ exceeding the specified pair tolerance.\n- Determine a pass/fail boolean $P$ per test case under the criterion: a test passes if and only if no pairs have $r_{ij} = 0$, $m_{\\max} \\leq \\tau_{\\mathrm{pair}}$, and $G \\leq \\tau_{\\mathrm{global}}$, where $\\tau_{\\mathrm{pair}}$ and $\\tau_{\\mathrm{global}}$ are the specified tolerances.\n\nAll computations must be performed in SI units, with distances in meters and forces expressed in newtons. The final outputs must show $G$ in newtons.\n\nTest suite to implement and evaluate:\n\n- Test case $1$ (happy path, moderate separations and mixed charges):\n    - Positions (in meters): $\\left[[0,0,0],[0.01,0,0],[0,0.02,0]\\right]$.\n    - Charges (in coulombs): $\\left[1\\times 10^{-6},-2\\times 10^{-6},5\\times 10^{-7}\\right]$.\n    - Pair tolerance $\\tau_{\\mathrm{pair}} = 1\\times 10^{-12}$.\n    - Global tolerance $\\tau_{\\mathrm{global}} = 1\\times 10^{-12}$.\n- Test case $2$ (boundary singularity: two coincident charges):\n    - Positions (in meters): $\\left[[0,0,0],[0,0,0],[0,0,0.03]\\right]$.\n    - Charges (in coulombs): $\\left[1\\times 10^{-9},-1\\times 10^{-9},2\\times 10^{-9}\\right]$.\n    - Pair tolerance $\\tau_{\\mathrm{pair}} = 1\\times 10^{-12}$.\n    - Global tolerance $\\tau_{\\mathrm{global}} = 1\\times 10^{-12}$.\n- Test case $3$ (zero-charge edge case):\n    - Positions (in meters): $\\left[[0,0,0],[0.01,0,0],[0,0,0.03]\\right]$.\n    - Charges (in coulombs): $\\left[0,1\\times 10^{-6},-1\\times 10^{-6}\\right]$.\n    - Pair tolerance $\\tau_{\\mathrm{pair}} = 1\\times 10^{-12}$.\n    - Global tolerance $\\tau_{\\mathrm{global}} = 1\\times 10^{-12}$.\n- Test case $4$ (multiscale geometry and charge magnitudes):\n    - Positions (in meters): $\\left[[0,0,0],[0.001,0.002,0],[0.1,0,0],[0,0.05,0.05],[0.03,0.04,0]\\right]$.\n    - Charges (in coulombs): $\\left[1\\times 10^{-6},-3\\times 10^{-6},2\\times 10^{-9},-7\\times 10^{-9},5\\times 10^{-7}\\right]$.\n    - Pair tolerance $\\tau_{\\mathrm{pair}} = 1\\times 10^{-12}$.\n    - Global tolerance $\\tau_{\\mathrm{global}} = 1\\times 10^{-12}$.\n\nFinal output specification:\n\n- For each test case, produce the ordered list $\\left[P, m_{\\max}, G, V, K\\right]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list. For example: $\\left[\\left[\\text{True},0.0,0.0,0,1.0\\right],\\left[\\text{False},\\dots\\right],\\dots\\right]$.\n- Express $G$ in newtons, as a decimal number. The pass/fail entries must be boolean values, and counts must be integers. All other entries must be floating-point numbers.",
            "solution": "We design a principled numerical test rooted in the Superposition Principle, Coulomb’s law, and Newton’s third law, along with diagnostics that quantify deviations that can arise from numerical floating-point computations or ill-posed geometries.\n\nStart from the Superposition Principle: for a set of point charges $\\{q_i\\}$ at positions $\\{\\mathbf{x}_i\\}$, the total force on charge $q_i$ is $\\mathbf{F}_i = \\sum_{j\\neq i} \\mathbf{F}_{ij}$, where $\\mathbf{F}_{ij}$ is the force exerted by charge $q_j$ on charge $q_i$. Coulomb’s law for point charges provides the pairwise force. Let the displacement vector be $\\mathbf{r}_{ij} = \\mathbf{x}_j - \\mathbf{x}_i$ with magnitude $r_{ij} = \\|\\mathbf{r}_{ij}\\|_2$. The unit vector pointing from $q_i$ to $q_j$ is $\\hat{\\mathbf{r}}_{ij} = \\frac{\\mathbf{r}_{ij}}{r_{ij}}$. The Coulomb constant is $k=\\frac{1}{4\\pi \\varepsilon_0}$, with vacuum permittivity $\\varepsilon_0 = 8.8541878128\\times 10^{-12}$ farads per meter. In SI units, the force is\n$$\n\\mathbf{F}_{ij} = k\\, \\frac{q_i q_j}{r_{ij}^2}\\, \\hat{\\mathbf{r}}_{ij}.\n$$\nBy Newton’s third law, we must have $\\mathbf{F}_{ji} = -\\mathbf{F}_{ij}$ for each pair $\\{i,j\\}$ with $r_{ij} \\neq 0$. In exact arithmetic and under the idealized point-charge model, this is guaranteed by the symmetry of Coulomb’s law and the construction of $\\hat{\\mathbf{r}}_{ij}$ versus $\\hat{\\mathbf{r}}_{ji}$. Numerically, floating-point rounding and extreme scale disparities can lead to tiny residual violations.\n\nTo test the symmetry, define for each unordered pair the residual vector\n$$\n\\mathbf{M}_{ij} = \\mathbf{F}_{ij} + \\mathbf{F}_{ji},\n$$\nand the relative mismatch\n$$\nm_{ij} = \\frac{\\|\\mathbf{M}_{ij}\\|_2}{\\|\\mathbf{F}_{ij}\\|_2 + \\|\\mathbf{F}_{ji}\\|_2}.\n$$\nThe numerator captures the net failure of action-reaction symmetry for the pair modeled numerically, while the denominator sets the scale to render the metric unitless and interpretable across magnitudes. If $r_{ij}=0$, the model is singular; such pairs are marked as violations and excluded from force computations. The Superposition Principle yields the net force per particle\n$$\n\\mathbf{F}_i = \\sum_{j\\neq i} \\mathbf{F}_{ij}, \\quad \\mathbf{F}_{\\mathrm{tot}} = \\sum_i \\mathbf{F}_i.\n$$\nIdeally, $\\mathbf{F}_{\\mathrm{tot}}=\\mathbf{0}$ due to Newton’s third law summing over all pairs, but numerically we quantify the residual via the norm\n$$\nG = \\|\\mathbf{F}_{\\mathrm{tot}}\\|_2,\n$$\nwhich is expressed in newtons.\n\nTo quantify geometric multiscale sensitivity, define the separation condition number\n$$\nK = \\frac{\\max\\{r_{ij}: r_{ij}  0\\}}{\\min\\{r_{ij}: r_{ij}  0\\}},\n$$\nwhich measures the spread in pair separations. Larger $K$ can amplify floating-point sensitivity when summing across scales. If no valid nonzero separations exist, define $K=+\\infty$.\n\nDiagnostics and pass/fail criteria:\n- Compute $m_{\\max} = \\max\\{m_{ij}\\}$ over valid pairs with $r_{ij}0$.\n- Count violating pairs $V$ as the number of unordered pairs with either $r_{ij}=0$ or $m_{ij}  \\tau_{\\mathrm{pair}}$.\n- The test passes if and only if no singular pairs are present (i.e., no $r_{ij}=0$), $m_{\\max} \\leq \\tau_{\\mathrm{pair}}$, and $G \\leq \\tau_{\\mathrm{global}}$.\n\nAlgorithmic design:\n- Iterate over unordered pairs $(i,j)$ with $ij$.\n- For each pair, compute $\\mathbf{r}_{ij}$, $r_{ij}$, and handle the $r_{ij}=0$ singular case by marking a violation and skipping force contribution.\n- Otherwise, compute $\\hat{\\mathbf{r}}_{ij}$, then $\\mathbf{F}_{ij}$ and $\\mathbf{F}_{ji}$ via Coulomb’s law in SI units using the given $k$. Compute $\\mathbf{M}_{ij}$, $m_{ij}$, and accumulate $\\mathbf{F}_i$ and $\\mathbf{F}_j$ for superposition.\n- After processing all pairs, compute $\\mathbf{F}_{\\mathrm{tot}}$ and $G$, compute $m_{\\max}$, $V$, and $K$.\n- Compose the result list $\\left[P, m_{\\max}, G, V, K\\right]$ for each test case.\n\nUnits and outputs:\n- Distances are in meters, charges in coulombs, and forces in newtons. The scalar $G$ must be output in newtons.\n- The final printed line aggregates all test case result lists in a single bracketed, comma-separated list.\n\nThis principled procedure ties directly to Coulomb’s law and Newton’s third law, quantifies numerical symmetry, and provides actionable diagnostics for violations that can emerge from ill-posed configurations (such as coincident charges) or multiscale geometries with large $K$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef coulomb_constant():\n    # Vacuum permittivity (epsilon_0) in F/m\n    epsilon_0 = 8.8541878128e-12\n    # Coulomb constant k = 1/(4*pi*epsilon_0)\n    return 1.0 / (4.0 * np.pi * epsilon_0)\n\ndef pairwise_symmetry_tests(positions, charges, tol_pair, tol_global):\n    \"\"\"\n    Perform numerical symmetry tests for Coulomb forces and return diagnostics.\n    positions: (N,3) array in meters\n    charges: (N,) array in coulombs\n    tol_pair: relative tolerance for pair symmetry\n    tol_global: absolute tolerance for global net force norm (in newtons)\n    Returns: [P, m_max, G, V, K]\n    \"\"\"\n    k = coulomb_constant()\n    positions = np.asarray(positions, dtype=float)\n    charges = np.asarray(charges, dtype=float)\n    N = positions.shape[0]\n\n    # Accumulate forces on each particle\n    forces = np.zeros((N, 3), dtype=float)\n\n    # Collect diagnostics\n    rel_mismatches = []\n    distances = []\n    violating_pairs_count = 0\n    has_singular_pair = False\n\n    # Iterate over unordered pairs\n    for i in range(N):\n        for j in range(i + 1, N):\n            r_vec = positions[j] - positions[i]\n            r = np.linalg.norm(r_vec)\n            if r == 0.0:\n                # Singular pair: mark violation and skip force computation\n                violating_pairs_count += 1\n                has_singular_pair = True\n                continue\n            # Record nonzero separation for condition number\n            distances.append(r)\n            # Unit vector\n            r_hat = r_vec / r\n            # Pair forces (SI units)\n            fij = k * charges[i] * charges[j] / (r * r) * r_hat\n            fji = -fij  # Using Newton's third law symmetry\n            # Action-reaction residual and relative mismatch\n            m_vec = fij + fji\n            denom = np.linalg.norm(fij) + np.linalg.norm(fji)\n            # Protect against zero denominators (e.g., zero charges)\n            if denom == 0.0:\n                rel = 0.0\n            else:\n                rel = np.linalg.norm(m_vec) / denom\n            rel_mismatches.append(rel)\n            # Count if exceeds pair tolerance\n            if rel  tol_pair:\n                violating_pairs_count += 1\n            # Superposition accumulation\n            forces[i] += fij\n            forces[j] += fji\n\n    # Global diagnostics\n    F_tot = np.sum(forces, axis=0)\n    G = float(np.linalg.norm(F_tot))  # net force norm in newtons\n\n    # Maximum relative mismatch\n    if rel_mismatches:\n        m_max = float(np.max(rel_mismatches))\n    else:\n        m_max = 0.0\n\n    # Separation condition number\n    if distances:\n        K = float(np.max(distances) / np.min(distances))\n    else:\n        K = float('inf')\n\n    # Pass criterion\n    P = (not has_singular_pair) and (m_max = tol_pair) and (G = tol_global)\n\n    return [P, m_max, G, int(violating_pairs_count), K]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1: happy path\n        (\n            np.array([[0.0, 0.0, 0.0],\n                      [0.01, 0.0, 0.0],\n                      [0.0, 0.02, 0.0]], dtype=float),\n            np.array([1e-6, -2e-6, 5e-7], dtype=float),\n            1e-12,  # pair tolerance\n            1e-12   # global tolerance in newtons\n        ),\n        # Test case 2: singular pair (coincident charges)\n        (\n            np.array([[0.0, 0.0, 0.0],\n                      [0.0, 0.0, 0.0],\n                      [0.0, 0.0, 0.03]], dtype=float),\n            np.array([1e-9, -1e-9, 2e-9], dtype=float),\n            1e-12,\n            1e-12\n        ),\n        # Test case 3: zero-charge edge case\n        (\n            np.array([[0.0, 0.0, 0.0],\n                      [0.01, 0.0, 0.0],\n                      [0.0, 0.0, 0.03]], dtype=float),\n            np.array([0.0, 1e-6, -1e-6], dtype=float),\n            1e-12,\n            1e-12\n        ),\n        # Test case 4: multiscale geometry and charges\n        (\n            np.array([[0.0, 0.0, 0.0],\n                      [0.001, 0.002, 0.0],\n                      [0.1, 0.0, 0.0],\n                      [0.0, 0.05, 0.05],\n                      [0.03, 0.04, 0.0]], dtype=float),\n            np.array([1e-6, -3e-6, 2e-9, -7e-9, 5e-7], dtype=float),\n            1e-12,\n            1e-12\n        )\n    ]\n\n    results = []\n    for positions, charges, tol_pair, tol_global in test_cases:\n        result = pairwise_symmetry_tests(positions, charges, tol_pair, tol_global)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n    def format_item(item):\n        if isinstance(item, bool):\n            return \"True\" if item else \"False\"\n        elif isinstance(item, (int, np.integer)):\n            return str(int(item))\n        elif isinstance(item, float):\n            # Use repr-like formatting to preserve inf and small magnitudes\n            return str(item)\n        elif isinstance(item, list):\n            return \"[\" + \",\".join(format_item(x) for x in item) + \"]\"\n        else:\n            # Fallback for numpy types\n            if isinstance(item, np.bool_):\n                return \"True\" if bool(item) else \"False\"\n            elif isinstance(item, np.floating):\n                return str(float(item))\n            elif isinstance(item, np.integer):\n                return str(int(item))\n            else:\n                return str(item)\n\n    print(\"[\" + \",\".join(format_item(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}