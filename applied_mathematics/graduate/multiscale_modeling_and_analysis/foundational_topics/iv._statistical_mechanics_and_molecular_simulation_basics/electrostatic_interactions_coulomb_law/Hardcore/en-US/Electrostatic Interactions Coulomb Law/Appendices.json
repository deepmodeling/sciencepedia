{
    "hands_on_practices": [
        {
            "introduction": "Coulomb's law in a vacuum provides an essential baseline, but real physical and biological systems are embedded in complex media. This exercise bridges the gap between microscopic material properties, such as molecular polarizability, and the macroscopic, observable phenomenon of dielectric screening. By working through this problem, you will see how the effective, screened interaction is derived directly from Maxwell's equations, a foundational skill in condensed matter and biophysical modeling. ",
            "id": "3753383",
            "problem": "A point charge of magnitude $q$ is embedded at the origin of an infinite, homogeneous, isotropic, linear dielectric. The material’s microscopic response is characterized by a molecular polarizability $\\alpha$ and a number density $N$, which can be connected to the macroscopic relative permittivity $\\epsilon_{r}$ via the Clausius–Mossotti (CM) relation. Starting from Maxwell’s equations in electrostatics and standard constitutive relations, derive the macroscopic electric field magnitude $E(r)$ at a distance $r$ from the charge. Then, quantify the reduction in the field magnitude relative to vacuum using the ratio $E_{\\text{dielectric}}(r)/E_{\\text{vacuum}}(r)$. \n\nUse the following data:\n- Free-space permittivity $\\epsilon_{0} = 8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F}\\,\\text{m}^{-1}$.\n- Charge $q = 1.00 \\times 10^{-9}\\ \\text{C}$.\n- Observation distance $r = 1.00 \\times 10^{-2}\\ \\text{m}$.\n- Molecular polarizability $\\alpha = 4.56 \\times 10^{-40}\\ \\text{C}\\,\\text{m}^{2}\\,\\text{V}^{-1}$.\n- Number density $N = 2.50 \\times 10^{28}\\ \\text{m}^{-3}$.\n\nAssumptions:\n- The medium is linear, homogeneous, and isotropic, and there are no additional free charges or boundaries present.\n- The Clausius–Mossotti relation holds in the form $\\displaystyle \\frac{\\epsilon_{r} - 1}{\\epsilon_{r} + 2} = \\frac{N \\alpha}{3 \\epsilon_{0}}$.\n\nTasks:\n1. Starting from the divergence form of Maxwell’s equations for electrostatics and the constitutive relation for a linear dielectric, derive the spherical-symmetry expression for the macroscopic field $E(r)$ in the dielectric.\n2. Use the Clausius–Mossotti relation to compute $\\epsilon_{r}$ from $\\alpha$, $N$, and $\\epsilon_{0}$, and hence evaluate the reduction factor $\\displaystyle \\frac{E_{\\text{dielectric}}(r)}{E_{\\text{vacuum}}(r)}$.\n3. Evaluate numerically the magnitudes $E_{\\text{vacuum}}(r)$ and $E_{\\text{dielectric}}(r)$ and express these in $\\text{kV}\\,\\text{m}^{-1}$.\n\nAnswer specification:\n- As your final answer, report only the reduction factor $\\displaystyle \\frac{E_{\\text{dielectric}}(r)}{E_{\\text{vacuum}}(r)}$ as a decimal number rounded to four significant figures.\n- If you compute $E$ magnitudes, express them in $\\text{kV}\\,\\text{m}^{-1}$, but do not include them in the final reported answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- Point charge at the origin: $q = 1.00 \\times 10^{-9}\\ \\text{C}$.\n- Medium: infinite, homogeneous, isotropic, linear dielectric.\n- Microscopic properties: molecular polarizability $\\alpha = 4.56 \\times 10^{-40}\\ \\text{C}\\,\\text{m}^{2}\\,\\text{V}^{-1}$, number density $N = 2.50 \\times 10^{28}\\ \\text{m}^{-3}$.\n- Fundamental constant: free-space permittivity $\\epsilon_{0} = 8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F}\\,\\text{m}^{-1}$.\n- Observation distance: $r = 1.00 \\times 10^{-2}\\ \\text{m}$.\n- Constitutive relation: Clausius–Mossotti (CM) relation $\\displaystyle \\frac{\\epsilon_{r} - 1}{\\epsilon_{r} + 2} = \\frac{N \\alpha}{3 \\epsilon_{0}}$.\n- Assumptions: The medium is linear, homogeneous, and isotropic, with no additional free charges or boundaries.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity:\n- **Scientifically Grounded**: The problem is based on fundamental principles of electrostatics, specifically Maxwell's equations and the behavior of dielectric materials. The Clausius-Mossotti relation is a standard and well-established model in this context. All aspects are firmly grounded in physics.\n- **Well-Posed**: The problem is well-posed. The givens are sufficient to determine a unique solution for the requested quantities. The tasks are clearly specified and lead to a unique numerical answer.\n- **Objective**: The language is precise and quantitative, free from subjective or ambiguous statements.\n- **Completeness and Consistency**: The problem provides all necessary data and a consistent physical model. The units of the provided quantities ($\\alpha$, $N$, $\\epsilon_0$) are consistent, leading to a dimensionless value for the term $\\frac{N\\alpha}{3\\epsilon_0}$.\n- **Realism**: The values for polarizability and number density are physically plausible for a solid or liquid dielectric.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a standard exercise in electromagnetism that tests the connection between microscopic and macroscopic descriptions of dielectrics. The solution process may proceed.\n\n### Solution Derivation\n\n**1. Macroscopic Electric Field in the Dielectric**\n\nThe analysis begins with Maxwell's first equation for electrostatics (Gauss's law for the electric displacement field $\\mathbf{D}$), which relates $\\mathbf{D}$ to the free charge density $\\rho_{\\text{free}}$:\n$$ \\nabla \\cdot \\mathbf{D} = \\rho_{\\text{free}} $$\nFor a single point charge $q$ located at the origin, the free charge density is given by $\\rho_{\\text{free}}(\\mathbf{r}) = q \\delta(\\mathbf{r})$, where $\\delta(\\mathbf{r})$ is the three-dimensional Dirac delta function.\n\nIn its integral form, Gauss's law states that the flux of $\\mathbf{D}$ through a closed surface $\\mathcal{S}$ is equal to the total free charge enclosed, $Q_{\\text{free, enc}}$:\n$$ \\oint_{\\mathcal{S}} \\mathbf{D} \\cdot d\\mathbf{A} = Q_{\\text{free, enc}} $$\nDue to the spherical symmetry of the problem, the electric displacement field must be purely radial, i.e., $\\mathbf{D}(\\mathbf{r}) = D(r) \\hat{\\mathbf{r}}$. We choose a spherical Gaussian surface $\\mathcal{S}$ of radius $r$ centered at the origin. The enclosed free charge is $Q_{\\text{free, enc}} = q$. The integral simplifies to:\n$$ D(r) \\cdot (4 \\pi r^2) = q $$\nSolving for the magnitude $D(r)$ gives:\n$$ D(r) = \\frac{q}{4 \\pi r^2} $$\nFor a linear, isotropic, and homogeneous (LIH) dielectric, the electric field $\\mathbf{E}$ is related to the electric displacement $\\mathbf{D}$ by the constitutive relation:\n$$ \\mathbf{D} = \\epsilon \\mathbf{E} = \\epsilon_r \\epsilon_0 \\mathbf{E} $$\nwhere $\\epsilon$ is the permittivity of the material and $\\epsilon_r$ is the relative permittivity (or dielectric constant).\n\nSubstituting the expression for $\\mathbf{D}(r)$ allows us to find the macroscopic electric field $\\mathbf{E}_{\\text{dielectric}}(r)$:\n$$ \\mathbf{E}_{\\text{dielectric}}(r) = \\frac{\\mathbf{D}(r)}{\\epsilon_r \\epsilon_0} = \\frac{1}{\\epsilon_r \\epsilon_0} \\frac{q}{4 \\pi r^2} \\hat{\\mathbf{r}} $$\nThe magnitude of this field is:\n$$ E_{\\text{dielectric}}(r) = \\frac{q}{4 \\pi \\epsilon_r \\epsilon_0 r^2} $$\n\n**2. Reduction Factor**\n\nThe electric field from the same charge $q$ in a vacuum is given by Coulomb's law:\n$$ E_{\\text{vacuum}}(r) = \\frac{q}{4 \\pi \\epsilon_0 r^2} $$\nThe reduction factor is the ratio of the field magnitude in the dielectric to the field magnitude in vacuum:\n$$ \\frac{E_{\\text{dielectric}}(r)}{E_{\\text{vacuum}}(r)} = \\frac{q / (4 \\pi \\epsilon_r \\epsilon_0 r^2)}{q / (4 \\pi \\epsilon_0 r^2)} = \\frac{1}{\\epsilon_r} $$\nThus, the reduction factor is simply the reciprocal of the relative permittivity.\n\n**3. Calculation of Relative Permittivity $\\epsilon_r$**\n\nTo find the reduction factor, we must first compute $\\epsilon_r$ using the given Clausius-Mossotti relation:\n$$ \\frac{\\epsilon_r - 1}{\\epsilon_r + 2} = \\frac{N \\alpha}{3 \\epsilon_0} $$\nLet's define a dimensionless quantity $X = \\frac{N \\alpha}{3 \\epsilon_0}$. We calculate its value using the provided data:\n- $N = 2.50 \\times 10^{28}\\ \\text{m}^{-3}$\n- $\\alpha = 4.56 \\times 10^{-40}\\ \\text{C}\\,\\text{m}^{2}\\,\\text{V}^{-1}$ (Note: $\\text{C V}^{-1} = \\text{F}$, so the unit is $\\text{F}\\,\\text{m}^2$)\n- $\\epsilon_0 = 8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F}\\,\\text{m}^{-1}$\n\nFirst, the numerator:\n$$ N \\alpha = (2.50 \\times 10^{28}\\ \\text{m}^{-3}) \\times (4.56 \\times 10^{-40}\\ \\text{F m}^2) = 1.14 \\times 10^{-11}\\ \\text{F m}^{-1} $$\nNext, the denominator:\n$$ 3 \\epsilon_0 = 3 \\times (8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F m}^{-1}) \\approx 2.656256 \\times 10^{-11}\\ \\text{F m}^{-1} $$\nNow, the value of $X$ is:\n$$ X = \\frac{1.14 \\times 10^{-11}}{2.656256... \\times 10^{-11}} \\approx 0.4291708 $$\nNow we rearrange the Clausius-Mossotti relation to solve for $\\epsilon_r$:\n$$ \\frac{\\epsilon_r - 1}{\\epsilon_r + 2} = X $$\n$$ \\epsilon_r - 1 = X (\\epsilon_r + 2) $$\n$$ \\epsilon_r - 1 = X \\epsilon_r + 2X $$\n$$ \\epsilon_r - X \\epsilon_r = 1 + 2X $$\n$$ \\epsilon_r (1 - X) = 1 + 2X $$\n$$ \\epsilon_r = \\frac{1 + 2X}{1 - X} $$\nSubstituting the numerical value for $X$:\n$$ \\epsilon_r = \\frac{1 + 2(0.4291708)}{1 - 0.4291708} = \\frac{1 + 0.8583416}{0.5708292} = \\frac{1.8583416}{0.5708292} \\approx 3.25553 $$\nThe reduction factor is $1/\\epsilon_r$:\n$$ \\frac{E_{\\text{dielectric}}(r)}{E_{\\text{vacuum}}(r)} = \\frac{1}{\\epsilon_r} \\approx \\frac{1}{3.25553} \\approx 0.307168 $$\nRounding to four significant figures as requested, the reduction factor is $0.3072$.\n\n**4. Numerical Evaluation of Electric Fields (Supplementary)**\n\nAs per the prompt, we also evaluate the field magnitudes.\n$$ E_{\\text{vacuum}}(r) = \\frac{q}{4 \\pi \\epsilon_0 r^2} = \\frac{1.00 \\times 10^{-9}\\ \\text{C}}{4\\pi(8.854\\,187\\,817 \\times 10^{-12}\\ \\text{F m}^{-1})(1.00 \\times 10^{-2}\\ \\text{m})^2} $$\n$$ E_{\\text{vacuum}}(r) \\approx 89875.5\\ \\text{V m}^{-1} = 89.9\\ \\text{kV m}^{-1} $$\nThe field in the dielectric is:\n$$ E_{\\text{dielectric}}(r) = \\frac{E_{\\text{vacuum}}(r)}{\\epsilon_r} \\approx \\frac{89875.5\\ \\text{V m}^{-1}}{3.25553} \\approx 27607.7\\ \\text{V m}^{-1} = 27.6\\ \\text{kV m}^{-1} $$\nThese numerical values confirm the physics: the dielectric material, through polarization, creates an opposing internal field that reduces the net macroscopic field from its vacuum value. The final answer required is only the reduction factor.",
            "answer": "$$\\boxed{0.3072}$$"
        },
        {
            "introduction": "In many-particle systems like molecules or colloidal suspensions, calculating every pairwise interaction is computationally prohibitive. This practice develops the essential skill of coarse-graining, a cornerstone of multiscale modeling, by using the multipole expansion to approximate long-range forces. By deriving the interaction energy between two distinct charge clusters up to the dipole-dipole term, you will gain direct experience in systematically simplifying complex interactions, a technique crucial for connecting atomistic detail to mesoscopic behavior. ",
            "id": "3753430",
            "problem": "Consider two finite clusters of point charges in vacuum, denoted $C_1$ and $C_2$. Cluster $C_1$ contains $n_1$ point charges $q_{1i}$ located at positions $\\mathbf{R}_1 + \\mathbf{r}_{1i}$ for $i = 1, \\dots, n_1$, and cluster $C_2$ contains $n_2$ point charges $q_{2j}$ located at positions $\\mathbf{R}_2 + \\mathbf{r}_{2j}$ for $j = 1, \\dots, n_2$. Assume the intra-cluster radii satisfy $\\max_i |\\mathbf{r}_{1i}| \\le a_1$ and $\\max_j |\\mathbf{r}_{2j}| \\le a_2$, and that the separation $L = |\\mathbf{R}_2 - \\mathbf{R}_1|$ obeys $a_1 \\ll L$ and $a_2 \\ll L$. Define the unit vector $\\hat{\\mathbf{n}} = (\\mathbf{R}_2 - \\mathbf{R}_1)/L$ pointing from the center of $C_1$ to the center of $C_2$. Let $k = \\frac{1}{4\\pi \\epsilon_0}$ denote Coulomb’s constant, where $\\epsilon_0$ is the vacuum permittivity.\n\nThe configuration is to be assembled quasi-statically from infinity by bringing each charge from infinity to its final location in the presence of the charges that have already been placed. Use Coulomb’s law and the superposition principle for electrostatic potentials to derive a closed-form analytic expression for the total work $W$ required to assemble the entire configuration.\n\nYour derivation must:\n- Begin from fundamental definitions and laws appropriate to electrostatics, without invoking any target or shortcut energy formulas that are not directly derived from first principles.\n- Separate the total work into the sum of exact intra-cluster pairwise contributions within $C_1$ and within $C_2$, plus the inter-cluster interaction contribution between $C_1$ and $C_2$.\n- For the inter-cluster interaction, use a multiscale expansion justified by $a_1, a_2 \\ll L$ and retain, in a systematic truncation, all terms that arise from the monopole and dipole moments of the clusters through order $L^{-3}$. Explicitly neglect any terms involving quadrupole and higher multipoles, consistent with a coarse-grained description in which those higher moments are unresolved.\n\nIntroduce the total charges $Q_1 = \\sum_{i=1}^{n_1} q_{1i}$ and $Q_2 = \\sum_{j=1}^{n_2} q_{2j}$, and the dipole moments about the cluster centers $\\mathbf{p}_1 = \\sum_{i=1}^{n_1} q_{1i}\\,\\mathbf{r}_{1i}$ and $\\mathbf{p}_2 = \\sum_{j=1}^{n_2} q_{2j}\\,\\mathbf{r}_{2j}$.\n\nProvide your final answer for $W$ as a single closed-form analytic expression in terms of $k$, $Q_1$, $Q_2$, $\\mathbf{p}_1$, $\\mathbf{p}_2$, $\\hat{\\mathbf{n}}$, $L$, and the intra-cluster charges and positions $\\{q_{1i}, \\mathbf{r}_{1i}\\}$ and $\\{q_{2j}, \\mathbf{r}_{2j}\\}$. Do not assume either cluster is neutral. Express the exact intra-cluster contributions using Euclidean distances between point charges. The final answer must be a single analytic expression. No numerical evaluation or rounding is required, and no units should be included inside the final boxed expression.",
            "solution": "The problem is validated as follows.\n\n### Step 1: Extract Givens\n- Two finite clusters of point charges, $C_1$ and $C_2$, in vacuum.\n- Cluster $C_1$: $n_1$ point charges $q_{1i}$ at positions $\\mathbf{R}_1 + \\mathbf{r}_{1i}$ for $i = 1, \\dots, n_1$.\n- Cluster $C_2$: $n_2$ point charges $q_{2j}$ at positions $\\mathbf{R}_2 + \\mathbf{r}_{2j}$ for $j = 1, \\dots, n_2$.\n- Intra-cluster radii: $\\max_i |\\mathbf{r}_{1i}| \\le a_1$ and $\\max_j |\\mathbf{r}_{2j}| \\le a_2$.\n- Separation: $L = |\\mathbf{R}_2 - \\mathbf{R}_1|$.\n- Condition: $a_1 \\ll L$ and $a_2 \\ll L$.\n- Unit vector: $\\hat{\\mathbf{n}} = (\\mathbf{R}_2 - \\mathbf{R}_1)/L$.\n- Coulomb’s constant: $k = \\frac{1}{4\\pi \\epsilon_0}$.\n- Task: Derive the total work $W$ required to assemble the configuration.\n- Methodological constraints:\n    1.  Start from fundamental definitions and laws.\n    2.  Separate total work into exact intra-cluster ($W_{11}$, $W_{22}$) and inter-cluster ($W_{12}$) contributions.\n    3.  For $W_{12}$, use a multiscale expansion justified by $a_1, a_2 \\ll L$.\n    4.  Retain terms from monopole and dipole moments through order $L^{-3}$.\n    5.  Explicitly neglect quadrupole and higher multipole terms.\n- Definitions:\n    - Total charge of $C_1$: $Q_1 = \\sum_{i=1}^{n_1} q_{1i}$.\n    - Total charge of $C_2$: $Q_2 = \\sum_{j=1}^{n_2} q_{2j}$.\n    - Dipole moment of $C_1$: $\\mathbf{p}_1 = \\sum_{i=1}^{n_1} q_{1i}\\,\\mathbf{r}_{1i}$.\n    - Dipole moment of $C_2$: $\\mathbf{p}_2 = \\sum_{j=1}^{n_2} q_{2j}\\,\\mathbf{r}_{2j}$.\n- Final answer requirements: A single closed-form analytic expression for $W$ in terms of $k$, $Q_1$, $Q_2$, $\\mathbf{p}_1$, $\\mathbf{p}_2$, $\\hat{\\mathbf{n}}$, $L$, and the intra-cluster charges and positions $\\{q_{1i}, \\mathbf{r}_{1i}\\}$ and $\\{q_{2j}, \\mathbf{r}_{2j}\\}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in classical electrostatics, specifically concerning the potential energy of a charge distribution and its approximation using a multipole expansion.\n- **Scientifically Grounded:** The problem is based on Coulomb's law and the superposition principle, which are foundational to electrostatics. The concept of a multipole expansion is a standard, mathematically rigorous technique. All premises are factually and scientifically sound.\n- **Well-Posed:** The problem provides all necessary data and constraints to arrive at a unique analytical expression. The objective is clearly stated, and the path to the solution is constrained in a well-defined manner (e.g., truncation order, exclusion of higher multipoles).\n- **Objective:** The language is formal, precise, and devoid of any subjective or ambiguous terminology.\n- **Completeness and Consistency:** The problem is self-contained. The condition $a_1, a_2 \\ll L$ provides the physical justification for the requested multiscale expansion. The instruction to neglect quadrupole moments is a specific and consistent constraint on the level of approximation required.\n- **Realism and Feasibility:** The physical setup is a valid idealization for modeling interactions between separated molecules or atomic clusters. The parameter values are not specified, so no inconsistency can arise there.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and self-consistent. It is a valid problem in physics that can be solved as stated. I will proceed with the derivation.\n\n### Derivation\n\nThe total work $W$ required to quasi-statically assemble a configuration of point charges from infinity is equal to the total electrostatic potential energy $U$ of the final configuration. For a system of discrete charges, this energy is the sum of the potential energies of all unique pairs of charges. The system consists of $n_1$ charges in cluster $C_1$ and $n_2$ charges in cluster $C_2$. The total work $W$ can be partitioned into three components:\n$1$. The work to assemble cluster $C_1$ in isolation, $W_{11}$.\n$2$. The work to assemble cluster $C_2$ in isolation, $W_{22}$.\n$3$. The work to bring the two fully-formed clusters from infinite separation to their final positions, which is the inter-cluster interaction energy $W_{12}$.\nThus, the total work is:\n$$\nW = W_{11} + W_{22} + W_{12}\n$$\n\n**Intra-cluster Work (Self-Energy)**\n\nThe work to assemble cluster $C_1$ is the sum of potential energies for every pair of charges within it. The position of charge $q_{1i}$ is $\\mathbf{R}_1 + \\mathbf{r}_{1i}$ and that of $q_{1k}$ is $\\mathbf{R}_1 + \\mathbf{r}_{1k}$. The distance between them is $|(\\mathbf{R}_1 + \\mathbf{r}_{1i}) - (\\mathbf{R}_1 + \\mathbf{r}_{1k})| = |\\mathbf{r}_{1i} - \\mathbf{r}_{1k}|$. As required by the problem, this is an exact expression based on the Euclidean distances between charges relative to their cluster center.\n$$\nW_{11} = \\frac{1}{2} \\sum_{i=1}^{n_1} \\sum_{k=1, k \\ne i}^{n_1} k \\frac{q_{1i} q_{1k}}{|\\mathbf{r}_{1i} - \\mathbf{r}_{1k}|}\n$$\nThe factor of $\\frac{1}{2}$ corrects for double-counting each pair in the sum.\n\nSimilarly, the work to assemble cluster $C_2$ is:\n$$\nW_{22} = \\frac{1}{2} \\sum_{j=1}^{n_2} \\sum_{l=1, l \\ne j}^{n_2} k \\frac{q_{2j} q_{2l}}{|\\mathbf{r}_{2j} - \\mathbf{r}_{2l}|}\n$$\n\n**Inter-cluster Work (Interaction Energy)**\n\nThe inter-cluster work $W_{12}$ is the sum of potential energies for all pairs consisting of one charge from $C_1$ and one from $C_2$.\n$$\nW_{12} = \\sum_{i=1}^{n_1} \\sum_{j=1}^{n_2} k \\frac{q_{1i} q_{2j}}{|\\left(\\mathbf{R}_1 + \\mathbf{r}_{1i}\\right) - \\left(\\mathbf{R}_2 + \\mathbf{r}_{2j}\\right)|}\n$$\nLet $\\mathbf{L} = \\mathbf{R}_2 - \\mathbf{R}_1$, which has magnitude $L$ and direction $\\hat{\\mathbf{n}}$. The vector in the denominator is $\\mathbf{R}_1 - \\mathbf{R}_2 + \\mathbf{r}_{1i} - \\mathbf{r}_{2j} = -\\mathbf{L} + (\\mathbf{r}_{1i} - \\mathbf{r}_{2j})$. The magnitude is $|\\mathbf{L} - (\\mathbf{r}_{1i} - \\mathbf{r}_{2j})|$.\nWe are given that $|\\mathbf{r}_{1i}| \\ll L$ and $|\\mathbf{r}_{2j}| \\ll L$, which implies the vector $\\mathbf{d}_{ij} = \\mathbf{r}_{1i} - \\mathbf{r}_{2j}$ has a magnitude much smaller than $L$. This justifies a multiscale expansion of the inverse distance:\n$$\n\\frac{1}{|\\mathbf{L} - \\mathbf{d}_{ij}|} = \\frac{1}{\\sqrt{(\\mathbf{L} - \\mathbf{d}_{ij}) \\cdot (\\mathbf{L} - \\mathbf{d}_{ij})}} = \\frac{1}{\\sqrt{L^2 - 2\\mathbf{L} \\cdot \\mathbf{d}_{ij} + |\\mathbf{d}_{ij}|^2}}\n$$\nFactoring out $L$, we get:\n$$\n\\frac{1}{L} \\left(1 - \\frac{2\\mathbf{L} \\cdot \\mathbf{d}_{ij}}{L^2} + \\frac{|\\mathbf{d}_{ij}|^2}{L^2}\\right)^{-1/2}\n$$\nUsing the Taylor expansion $(1+x)^{-1/2} \\approx 1 - \\frac{1}{2}x + \\frac{3}{8}x^2 - \\dots$ with $x = - \\frac{2\\hat{\\mathbf{n}} \\cdot \\mathbf{d}_{ij}}{L} + \\frac{|\\mathbf{d}_{ij}|^2}{L^2}$, we expand up to the order necessary to obtain terms of order $L^{-3}$ in the final energy $W_{12}$.\nThe expansion is:\n$$\n\\frac{1}{|\\mathbf{L} - \\mathbf{d}_{ij}|} \\approx \\frac{1}{L} \\left( 1 - \\frac{1}{2}\\left(-\\frac{2\\hat{\\mathbf{n}} \\cdot \\mathbf{d}_{ij}}{L}\\right) + \\left[ -\\frac{1}{2}\\frac{|\\mathbf{d}_{ij}|^2}{L^2} + \\frac{3}{8}\\left(-\\frac{2\\hat{\\mathbf{n}} \\cdot \\mathbf{d}_{ij}}{L}\\right)^2 \\right] \\right)\n$$\n$$\n\\approx \\frac{1}{L} \\left( 1 + \\frac{\\hat{\\mathbf{n}} \\cdot \\mathbf{d}_{ij}}{L} + \\frac{3(\\hat{\\mathbf{n}} \\cdot \\mathbf{d}_{ij})^2 - |\\mathbf{d}_{ij}|^2}{2L^2} \\right)\n$$\n$$\n\\approx \\frac{1}{L} + \\frac{\\hat{\\mathbf{n}} \\cdot (\\mathbf{r}_{1i} - \\mathbf{r}_{2j})}{L^2} + \\frac{3(\\hat{\\mathbf{n}} \\cdot (\\mathbf{r}_{1i} - \\mathbf{r}_{2j}))^2 - |\\mathbf{r}_{1i} - \\mathbf{r}_{2j}|^2}{2L^3}\n$$\nWe substitute this expansion into the expression for $W_{12}$ and group terms by powers of $L^{-1}$.\n\nTerm 1 (order $L^{-1}$): Monopole-Monopole interaction.\n$$\nW_{12}^{(0)} = \\sum_{i,j} k q_{1i} q_{2j} \\left(\\frac{1}{L}\\right) = \\frac{k}{L} \\left(\\sum_i q_{1i}\\right) \\left(\\sum_j q_{2j}\\right) = k \\frac{Q_1 Q_2}{L}\n$$\n\nTerm 2 (order $L^{-2}$): Monopole-Dipole interactions.\n$$\nW_{12}^{(1)} = \\sum_{i,j} k q_{1i} q_{2j} \\frac{\\hat{\\mathbf{n}} \\cdot (\\mathbf{r}_{1i} - \\mathbf{r}_{2j})}{L^2} = \\frac{k}{L^2} \\left[ \\left(\\sum_j q_{2j}\\right) \\left(\\sum_i q_{1i} (\\hat{\\mathbf{n}} \\cdot \\mathbf{r}_{1i})\\right) - \\left(\\sum_i q_{1i}\\right) \\left(\\sum_j q_{2j} (\\hat{\\mathbf{n}} \\cdot \\mathbf{r}_{2j})\\right) \\right]\n$$\nUsing the definitions of total charge ($Q_1, Q_2$) and dipole moments ($\\mathbf{p}_1, \\mathbf{p}_2$):\n$$\nW_{12}^{(1)} = \\frac{k}{L^2} \\left[ Q_2 (\\hat{\\mathbf{n}} \\cdot \\mathbf{p}_1) - Q_1 (\\hat{\\mathbf{n}} \\cdot \\mathbf{p}_2) \\right]\n$$\n\nTerm 3 (order $L^{-3}$): This term includes dipole-dipole and monopole-quadrupole interactions.\n$$\nW_{12}^{(2, full)} = \\sum_{i,j} k q_{1i} q_{2j} \\frac{3(\\hat{\\mathbf{n}} \\cdot (\\mathbf{r}_{1i} - \\mathbf{r}_{2j}))^2 - |\\mathbf{r}_{1i} - \\mathbf{r}_{2j}|^2}{2L^3}\n$$\nExpanding the numerator and summing over $i$ and $j$ isolates terms that depend on different combinations of multipole moments. The term that depends only on the dipole moments of both clusters is the dipole-dipole interaction term, which arises from the cross-term $-2(\\hat{\\mathbf{n}} \\cdot \\mathbf{r}_{1i})(\\hat{\\mathbf{n}} \\cdot \\mathbf{r}_{2j})$ and $-2\\mathbf{r}_{1i}\\cdot\\mathbf{r}_{2j}$. The sum over these cross-terms yields:\n$$\n\\frac{k}{L^3} \\left[ (\\sum_i q_{1i} \\mathbf{r}_{1i}) \\cdot (\\sum_j q_{2j} \\mathbf{r}_{2j}) - 3 (\\hat{\\mathbf{n}} \\cdot \\sum_i q_{1i} \\mathbf{r}_{1i}) (\\hat{\\mathbf{n}} \\cdot \\sum_j q_{2j} \\mathbf{r}_{2j}) \\right] = \\frac{k}{L^3} \\left[ \\mathbf{p}_1 \\cdot \\mathbf{p}_2 - 3(\\mathbf{p}_1 \\cdot \\hat{\\mathbf{n}})(\\mathbf{p}_2 \\cdot \\hat{\\mathbf{n}}) \\right]\n$$\nThe remaining parts of $W_{12}^{(2, full)}$ contain terms like $Q_2 \\sum_i q_{1i} (3(\\hat{\\mathbf{n}} \\cdot \\mathbf{r}_{1i})^2 - |\\mathbf{r}_{1i}|^2)$, which represent the interaction of a monopole with a quadrupole moment. The problem explicitly instructs to \"neglect any terms involving quadrupole and higher multipoles\". Therefore, we must truncate the $L^{-3}$ term, retaining only the dipole-dipole contribution.\n\nThe truncated inter-cluster work, accurate to the specified order and constraints, is:\n$$\nW_{12} \\approx W_{12}^{(0)} + W_{12}^{(1)} + W_{12}^{(2, \\text{dipole-dipole})}\n$$\n$$\nW_{12} \\approx k \\frac{Q_1 Q_2}{L} + \\frac{k}{L^2} \\left(Q_2(\\mathbf{p}_1 \\cdot \\hat{\\mathbf{n}}) - Q_1(\\mathbf{p}_2 \\cdot \\hat{\\mathbf{n}})\\right) + \\frac{k}{L^3} \\left[\\mathbf{p}_1 \\cdot \\mathbf{p}_2 - 3(\\mathbf{p}_1 \\cdot \\hat{\\mathbf{n}})(\\mathbf{p}_2 \\cdot \\hat{\\mathbf{n}})\\right]\n$$\n\n**Total Work**\n\nCombining the intra-cluster and inter-cluster contributions gives the total work $W$. This single expression includes the exact intra-cluster terms and the coarse-grained, truncated inter-cluster interaction energy.\n$$\nW = \\frac{k}{2} \\sum_{i=1}^{n_1} \\sum_{k=1, k \\ne i}^{n_1} \\frac{q_{1i} q_{1k}}{|\\mathbf{r}_{1i} - \\mathbf{r}_{1k}|} + \\frac{k}{2} \\sum_{j=1}^{n_2} \\sum_{l=1, l \\ne j}^{n_2} \\frac{q_{2j} q_{2l}}{|\\mathbf{r}_{2j} - \\mathbf{r}_{2l}|} + k \\frac{Q_1 Q_2}{L} + \\frac{k}{L^2} \\left(Q_2(\\mathbf{p}_1 \\cdot \\hat{\\mathbf{n}}) - Q_1(\\mathbf{p}_2 \\cdot \\hat{\\mathbf{n}})\\right) + \\frac{k}{L^3} \\left[\\mathbf{p}_1 \\cdot \\mathbf{p}_2 - 3(\\mathbf{p}_1 \\cdot \\hat{\\mathbf{n}})(\\mathbf{p}_2 \\cdot \\hat{\\mathbf{n}})\\right]\n$$",
            "answer": "$$\n\\boxed{\n\\frac{k}{2} \\sum_{i=1}^{n_1} \\sum_{k=1, k \\ne i}^{n_1} \\frac{q_{1i} q_{1k}}{|\\mathbf{r}_{1i} - \\mathbf{r}_{1k}|} + \\frac{k}{2} \\sum_{j=1}^{n_2} \\sum_{l=1, l \\ne j}^{n_2} \\frac{q_{2j} q_{2l}}{|\\mathbf{r}_{2j} - \\mathbf{r}_{2l}|} + k \\frac{Q_1 Q_2}{L} + \\frac{k}{L^2}(Q_2(\\mathbf{p}_1 \\cdot \\hat{\\mathbf{n}}) - Q_1(\\mathbf{p}_2 \\cdot \\hat{\\mathbf{n}})) + \\frac{k}{L^3}(\\mathbf{p}_1 \\cdot \\mathbf{p}_2 - 3(\\mathbf{p}_1 \\cdot \\hat{\\mathbf{n}})(\\mathbf{p}_2 \\cdot \\hat{\\mathbf{n}}))\n}\n$$"
        },
        {
            "introduction": "Translating physical laws into reliable computer code requires rigorous verification, as numerical artifacts can subtly violate fundamental principles. This computational exercise addresses this challenge by focusing on Newton's third law, which dictates that for any pair of interacting particles, $\\mathbf{F}_{ij} = -\\mathbf{F}_{ji}$. You will design and implement a numerical test to verify this action-reaction symmetry, learning how to create diagnostics that detect inconsistencies arising from floating-point errors or ill-posed geometries, a critical skill for developing robust simulation software. ",
            "id": "3753397",
            "problem": "You will write a complete, runnable program that performs numerical symmetry tests on pairwise electrostatic forces to assess whether the computed forces are consistent with Newton’s third law within specified tolerances. The program must compute forces between point charges in three-dimensional space under the Superposition Principle, and it must produce diagnostics that quantify and localize potential violations of Newton’s third law arising from numerical computation and ill-posed geometries.\n\nFundamental base and definitions to use: The interaction between point charges is given by Coulomb’s law, which states that the force on charge $q_i$ due to charge $q_j$ is proportional to the product $q_i q_j$ and directed along the line connecting them, with magnitude inversely proportional to the square of the distance between them. Newton’s third law states action equals reaction, meaning the force exerted by $q_i$ on $q_j$ is equal in magnitude and opposite in direction to the force exerted by $q_j$ on $q_i$. The Superposition Principle states the total force on a charge is the vector sum of the forces from all other charges. Use the International System of Units (SI), with distances in meters and forces in newtons.\n\nYour program must implement the following steps for each test case:\n\n- Compute all unordered pairwise interactions between charges. For each unordered pair $\\{i,j\\}$, compute the vector displacement $\\mathbf{r}_{ij} = \\mathbf{x}_j - \\mathbf{x}_i$ and its Euclidean norm $r_{ij} = \\|\\mathbf{r}_{ij}\\|_2$. If $r_{ij} = 0$, classify this pair as an ill-posed singularity. For such pairs, do not compute forces and mark them as a violation event.\n- For each valid pair with $r_{ij} \\neq 0$, compute the pairwise forces $\\mathbf{F}_{ij}$ and $\\mathbf{F}_{ji}$ using Coulomb’s law and the Superposition Principle, where the Coulomb constant $k$ is $k = \\frac{1}{4\\pi\\varepsilon_0}$ with $\\varepsilon_0 = 8.8541878128\\times 10^{-12}$ farads per meter. Use vector normalization and inverse-square scaling in SI units to produce forces in newtons.\n- For each valid pair, compute the action-reaction residual vector $\\mathbf{M}_{ij} = \\mathbf{F}_{ij} + \\mathbf{F}_{ji}$, and the relative symmetry mismatch $m_{ij} = \\frac{\\|\\mathbf{M}_{ij}\\|_2}{\\|\\mathbf{F}_{ij}\\|_2 + \\|\\mathbf{F}_{ji}\\|_2}$, which is unitless.\n- Aggregate diagnostics:\n    1. The maximum relative mismatch over valid pairs, denoted $m_{\\max}$.\n    2. The total net force over all particles $\\mathbf{F}_{\\mathrm{tot}} = \\sum_i \\mathbf{F}_i$ and its Euclidean norm $G = \\|\\mathbf{F}_{\\mathrm{tot}}\\|_2$, expressed in newtons.\n    3. The separation condition number $K = \\frac{\\max\\{r_{ij}: r_{ij} > 0\\}}{\\min\\{r_{ij}: r_{ij} > 0\\}}$; if no valid nonzero distances exist, define $K$ to be $+\\infty$.\n    4. The count of violating pairs $V$, defined as the number of unordered pairs that either have $r_{ij}=0$ or have $m_{ij}$ exceeding the specified pair tolerance.\n- Determine a pass/fail boolean $P$ per test case under the criterion: a test passes if and only if no pairs have $r_{ij} = 0$, $m_{\\max} \\leq \\tau_{\\mathrm{pair}}$, and $G \\leq \\tau_{\\mathrm{global}}$, where $\\tau_{\\mathrm{pair}}$ and $\\tau_{\\mathrm{global}}$ are the specified tolerances.\n\nAll computations must be performed in SI units, with distances in meters and forces expressed in newtons. The final outputs must show $G$ in newtons.\n\nTest suite to implement and evaluate:\n\n- Test case $1$ (happy path, moderate separations and mixed charges):\n    - Positions (in meters): $\\left[[0,0,0],[0.01,0,0],[0,0.02,0]\\right]$.\n    - Charges (in coulombs): $\\left[1\\times 10^{-6},-2\\times 10^{-6},5\\times 10^{-7}\\right]$.\n    - Pair tolerance $\\tau_{\\mathrm{pair}} = 1\\times 10^{-12}$.\n    - Global tolerance $\\tau_{\\mathrm{global}} = 1\\times 10^{-12}$.\n- Test case $2$ (boundary singularity: two coincident charges):\n    - Positions (in meters): $\\left[[0,0,0],[0,0,0],[0,0,0.03]\\right]$.\n    - Charges (in coulombs): $\\left[1\\times 10^{-9},-1\\times 10^{-9},2\\times 10^{-9}\\right]$.\n    - Pair tolerance $\\tau_{\\mathrm{pair}} = 1\\times 10^{-12}$.\n    - Global tolerance $\\tau_{\\mathrm{global}} = 1\\times 10^{-12}$.\n- Test case $3$ (zero-charge edge case):\n    - Positions (in meters): $\\left[[0,0,0],[0.01,0,0],[0,0,0.03]\\right]$.\n    - Charges (in coulombs): $\\left[0,1\\times 10^{-6},-1\\times 10^{-6}\\right]$.\n    - Pair tolerance $\\tau_{\\mathrm{pair}} = 1\\times 10^{-12}$.\n    - Global tolerance $\\tau_{\\mathrm{global}} = 1\\times 10^{-12}$.\n- Test case $4$ (multiscale geometry and charge magnitudes):\n    - Positions (in meters): $\\left[[0,0,0],[0.001,0.002,0],[0.1,0,0],[0,0.05,0.05],[0.03,0.04,0]\\right]$.\n    - Charges (in coulombs): $\\left[1\\times 10^{-6},-3\\times 10^{-6},2\\times 10^{-9},-7\\times 10^{-9},5\\times 10^{-7}\\right]$.\n    - Pair tolerance $\\tau_{\\mathrm{pair}} = 1\\times 10^{-12}$.\n    - Global tolerance $\\tau_{\\mathrm{global}} = 1\\times 10^{-12}$.\n\nFinal output specification:\n\n- For each test case, produce the ordered list $\\left[P, m_{\\max}, G, V, K\\right]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list. For example: $\\left[\\left[\\text{True},0.0,0.0,0,1.0\\right],\\left[\\text{False},\\dots\\right],\\dots\\right]$.\n- Express $G$ in newtons, as a decimal number. The pass/fail entries must be boolean values, and counts must be integers. All other entries must be floating-point numbers.",
            "solution": "We design a principled numerical test rooted in the Superposition Principle, Coulomb’s law, and Newton’s third law, along with diagnostics that quantify deviations that can arise from numerical floating-point computations or ill-posed geometries.\n\nStart from the Superposition Principle: for a set of point charges $\\{q_i\\}$ at positions $\\{\\mathbf{x}_i\\}$, the total force on charge $q_i$ is $\\mathbf{F}_i = \\sum_{j\\neq i} \\mathbf{F}_{ij}$, where $\\mathbf{F}_{ij}$ is the force exerted by charge $q_j$ on charge $q_i$. Coulomb’s law for point charges provides the pairwise force. Let the displacement vector be $\\mathbf{r}_{ij} = \\mathbf{x}_j - \\mathbf{x}_i$ with magnitude $r_{ij} = \\|\\mathbf{r}_{ij}\\|_2$. The unit vector pointing from $q_i$ to $q_j$ is $\\hat{\\mathbf{r}}_{ij} = \\frac{\\mathbf{r}_{ij}}{r_{ij}}$. The Coulomb constant is $k=\\frac{1}{4\\pi \\varepsilon_0}$, with vacuum permittivity $\\varepsilon_0 = 8.8541878128\\times 10^{-12}$ farads per meter. In SI units, the force is\n$$\n\\mathbf{F}_{ij} = k\\, \\frac{q_i q_j}{r_{ij}^2}\\, \\hat{\\mathbf{r}}_{ij}.\n$$\nBy Newton’s third law, we must have $\\mathbf{F}_{ji} = -\\mathbf{F}_{ij}$ for each pair $\\{i,j\\}$ with $r_{ij} \\neq 0$. In exact arithmetic and under the idealized point-charge model, this is guaranteed by the symmetry of Coulomb’s law and the construction of $\\hat{\\mathbf{r}}_{ij}$ versus $\\hat{\\mathbf{r}}_{ji}$. Numerically, floating-point rounding and extreme scale disparities can lead to tiny residual violations.\n\nTo test the symmetry, define for each unordered pair the residual vector\n$$\n\\mathbf{M}_{ij} = \\mathbf{F}_{ij} + \\mathbf{F}_{ji},\n$$\nand the relative mismatch\n$$\nm_{ij} = \\frac{\\|\\mathbf{M}_{ij}\\|_2}{\\|\\mathbf{F}_{ij}\\|_2 + \\|\\mathbf{F}_{ji}\\|_2}.\n$$\nThe numerator captures the net failure of action-reaction symmetry for the pair modeled numerically, while the denominator sets the scale to render the metric unitless and interpretable across magnitudes. If $r_{ij}=0$, the model is singular; such pairs are marked as violations and excluded from force computations. The Superposition Principle yields the net force per particle\n$$\n\\mathbf{F}_i = \\sum_{j\\neq i} \\mathbf{F}_{ij}, \\quad \\mathbf{F}_{\\mathrm{tot}} = \\sum_i \\mathbf{F}_i.\n$$\nIdeally, $\\mathbf{F}_{\\mathrm{tot}}=\\mathbf{0}$ due to Newton’s third law summing over all pairs, but numerically we quantify the residual via the norm\n$$\nG = \\|\\mathbf{F}_{\\mathrm{tot}}\\|_2,\n$$\nwhich is expressed in newtons.\n\nTo quantify geometric multiscale sensitivity, define the separation condition number\n$$\nK = \\frac{\\max\\{r_{ij}: r_{ij} > 0\\}}{\\min\\{r_{ij}: r_{ij} > 0\\}},\n$$\nwhich measures the spread in pair separations. Larger $K$ can amplify floating-point sensitivity when summing across scales. If no valid nonzero separations exist, define $K=+\\infty$.\n\nDiagnostics and pass/fail criteria:\n- Compute $m_{\\max} = \\max\\{m_{ij}\\}$ over valid pairs with $r_{ij}>0$.\n- Count violating pairs $V$ as the number of unordered pairs with either $r_{ij}=0$ or $m_{ij} > \\tau_{\\mathrm{pair}}$.\n- The test passes if and only if no singular pairs are present (i.e., no $r_{ij}=0$), $m_{\\max} \\leq \\tau_{\\mathrm{pair}}$, and $G \\leq \\tau_{\\mathrm{global}}$.\n\nAlgorithmic design:\n- Iterate over unordered pairs $(i,j)$ with $i<j$.\n- For each pair, compute $\\mathbf{r}_{ij}$, $r_{ij}$, and handle the $r_{ij}=0$ singular case by marking a violation and skipping force contribution.\n- Otherwise, compute $\\hat{\\mathbf{r}}_{ij}$, then $\\mathbf{F}_{ij}$ and $\\mathbf{F}_{ji}$ via Coulomb’s law in SI units using the given $k$. Compute $\\mathbf{M}_{ij}$, $m_{ij}$, and accumulate $\\mathbf{F}_i$ and $\\mathbf{F}_j$ for superposition.\n- After processing all pairs, compute $\\mathbf{F}_{\\mathrm{tot}}$ and $G$, compute $m_{\\max}$, $V$, and $K$.\n- Compose the result list $\\left[P, m_{\\max}, G, V, K\\right]$ for each test case.\n\nUnits and outputs:\n- Distances are in meters, charges in coulombs, and forces in newtons. The scalar $G$ must be output in newtons.\n- The final printed line aggregates all test case result lists in a single bracketed, comma-separated list.\n\nThis principled procedure ties directly to Coulomb’s law and Newton’s third law, quantifies numerical symmetry, and provides actionable diagnostics for violations that can emerge from ill-posed configurations (such as coincident charges) or multiscale geometries with large $K$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef coulomb_constant():\n    # Vacuum permittivity (epsilon_0) in F/m\n    epsilon_0 = 8.8541878128e-12\n    # Coulomb constant k = 1/(4*pi*epsilon_0)\n    return 1.0 / (4.0 * np.pi * epsilon_0)\n\ndef pairwise_symmetry_tests(positions, charges, tol_pair, tol_global):\n    \"\"\"\n    Perform numerical symmetry tests for Coulomb forces and return diagnostics.\n    positions: (N,3) array in meters\n    charges: (N,) array in coulombs\n    tol_pair: relative tolerance for pair symmetry\n    tol_global: absolute tolerance for global net force norm (in newtons)\n    Returns: [P, m_max, G, V, K]\n    \"\"\"\n    k = coulomb_constant()\n    positions = np.asarray(positions, dtype=float)\n    charges = np.asarray(charges, dtype=float)\n    N = positions.shape[0]\n\n    # Accumulate forces on each particle\n    forces = np.zeros((N, 3), dtype=float)\n\n    # Collect diagnostics\n    rel_mismatches = []\n    distances = []\n    violating_pairs_count = 0\n    has_singular_pair = False\n\n    # Iterate over unordered pairs\n    for i in range(N):\n        for j in range(i + 1, N):\n            # Vector from particle j to particle i\n            r_vec_ij = positions[i] - positions[j]\n            r = np.linalg.norm(r_vec_ij)\n\n            if r == 0.0:\n                # Singular pair: mark violation and skip force computation\n                violating_pairs_count += 1\n                has_singular_pair = True\n                continue\n            \n            # Record nonzero separation for condition number\n            distances.append(r)\n            \n            # Common terms for the force pair\n            force_mag = k * charges[i] * charges[j] / (r * r)\n            r_hat_ij = r_vec_ij / r # Unit vector from j to i\n\n            # F_ij: Force ON particle i BY particle j\n            f_ij = force_mag * r_hat_ij\n\n            # F_ji: Force ON particle j BY particle i\n            # Computed independently for verification. Direction is from i to j.\n            r_vec_ji = positions[j] - positions[i]\n            r_ji = np.linalg.norm(r_vec_ji)\n            r_hat_ji = r_vec_ji / r_ji\n            f_ji = k * charges[j] * charges[i] / (r_ji * r_ji) * r_hat_ji\n\n            # Action-reaction residual and relative mismatch\n            m_vec = f_ij + f_ji\n            denom = np.linalg.norm(f_ij) + np.linalg.norm(f_ji)\n            \n            # Protect against zero denominators (e.g., zero charges)\n            if denom == 0.0:\n                rel = 0.0\n            else:\n                rel = np.linalg.norm(m_vec) / denom\n            \n            rel_mismatches.append(rel)\n            \n            # Count if exceeds pair tolerance\n            if rel > tol_pair:\n                violating_pairs_count += 1\n            \n            # Superposition accumulation\n            forces[i] += f_ij\n            forces[j] += f_ji\n\n    # Global diagnostics\n    F_tot = np.sum(forces, axis=0)\n    G = float(np.linalg.norm(F_tot))  # net force norm in newtons\n\n    # Maximum relative mismatch\n    if rel_mismatches:\n        m_max = float(np.max(rel_mismatches))\n    else:\n        m_max = 0.0\n\n    # Separation condition number\n    if distances:\n        K = float(np.max(distances) / np.min(distances))\n    else:\n        K = float('inf')\n\n    # Pass criterion\n    P = (not has_singular_pair) and (m_max = tol_pair) and (G = tol_global)\n\n    return [P, m_max, G, int(violating_pairs_count), K]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1: happy path\n        (\n            np.array([[0.0, 0.0, 0.0],\n                      [0.01, 0.0, 0.0],\n                      [0.0, 0.02, 0.0]], dtype=float),\n            np.array([1e-6, -2e-6, 5e-7], dtype=float),\n            1e-12,  # pair tolerance\n            1e-12   # global tolerance in newtons\n        ),\n        # Test case 2: singular pair (coincident charges)\n        (\n            np.array([[0.0, 0.0, 0.0],\n                      [0.0, 0.0, 0.0],\n                      [0.0, 0.0, 0.03]], dtype=float),\n            np.array([1e-9, -1e-9, 2e-9], dtype=float),\n            1e-12,\n            1e-12\n        ),\n        # Test case 3: zero-charge edge case\n        (\n            np.array([[0.0, 0.0, 0.0],\n                      [0.01, 0.0, 0.0],\n                      [0.0, 0.0, 0.03]], dtype=float),\n            np.array([0.0, 1e-6, -1e-6], dtype=float),\n            1e-12,\n            1e-12\n        ),\n        # Test case 4: multiscale geometry and charges\n        (\n            np.array([[0.0, 0.0, 0.0],\n                      [0.001, 0.002, 0.0],\n                      [0.1, 0.0, 0.0],\n                      [0.0, 0.05, 0.05],\n                      [0.03, 0.04, 0.0]], dtype=float),\n            np.array([1e-6, -3e-6, 2e-9, -7e-9, 5e-7], dtype=float),\n            1e-12,\n            1e-12\n        )\n    ]\n\n    results = []\n    for positions, charges, tol_pair, tol_global in test_cases:\n        result = pairwise_symmetry_tests(positions, charges, tol_pair, tol_global)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n    def format_item(item):\n        if isinstance(item, bool):\n            return \"True\" if item else \"False\"\n        elif isinstance(item, (int, np.integer)):\n            return str(int(item))\n        elif isinstance(item, float):\n            # Use repr-like formatting to preserve inf and small magnitudes\n            return str(item)\n        elif isinstance(item, list):\n            return \"[\" + \",\".join(format_item(x) for x in item) + \"]\"\n        else:\n            # Fallback for numpy types\n            if isinstance(item, np.bool_):\n                return \"True\" if bool(item) else \"False\"\n            elif isinstance(item, np.floating):\n                return str(float(item))\n            elif isinstance(item, np.integer):\n                return str(int(item))\n            else:\n                return str(item)\n\n    print(\"[\" + \",\".join(format_item(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}