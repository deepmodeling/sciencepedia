{
    "hands_on_practices": [
        {
            "introduction": "在多尺度建模中，我们经常遇到包含多个物理效应的复杂微分方程。通过无量纲化，我们可以简化这些方程，揭示控制系统行为的关键无量纲参数。本练习将通过对一个包含线性和二次阻尼的振子进行无量纲化，帮助您掌握识别特征尺度和分析不同物理项（例如线性和二次摩擦）相对重要性的技能，这是多尺度分析的基础。",
            "id": "3743119",
            "problem": "一个质量为 $m$ 的单自由度质点沿直线运动，受到刚度系数为 $k$ 的线性弹簧、系数为 $\\gamma$ 的线性粘性摩擦力、系数为 $\\beta$ 的二次（与速率相关）摩擦力以及振幅为 $F_0$、角频率为 $\\omega$ 的谐波外力的作用。其运动方程为\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+\\beta\\,\\dot{x}(t)\\,|\\dot{x}(t)|+k\\,x(t)=F_0\\cos(\\omega t),\n$$\n其中所有参数 $m$、$\\gamma$、$\\beta$、$k$、$F_0$ 和 $\\omega$ 均为严格正数。\n\n从牛顿第二定律和给定的力模型出发，进行无量纲化，以阐明惯性、线性和二次摩擦、弹性以及外力的相对作用。为此，通过基本平衡关系来选择特征尺度：使用静态弹性响应来设定位移尺度 $X_s$，使用无阻尼小振荡周期来设定时间尺度 $T_s$。然后通过 $x=X_s u$ 和 $t=T_s \\tau$ 引入无量纲变量 $u(\\tau)$ 和 $\\tau$，并写出由此得到的无量纲方程。指出并命名出现的无量纲阻尼强度和频率比。\n\n使用无量纲方程，确定线性摩擦项主导二次摩擦项以及反之亦然的区间。将这些区间表示为关于无量纲速度的不等式，然后将阈值转换回物理速度尺度。最后，给出线性和二次摩擦贡献的量值相等时的临界物理速度 $v_c$。仅用 $\\gamma$ 和 $\\beta$ 表示 $v_c$。\n\n报告 $v_c$ 作为你的最终答案。最终答案必须是单一的、无单位的闭式解析表达式。",
            "solution": "在尝试求解之前，首先对问题陈述进行严格的验证程序。\n\n### 第1步：提取已知条件\n质量为 $m$ 的质点的运动方程给出如下：\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+\\beta\\,\\dot{x}(t)\\,|\\dot{x}(t)|+k\\,x(t)=F_0\\cos(\\omega t)\n$$\n参数 $m$、$\\gamma$、$\\beta$、$k$、$F_0$ 和 $\\omega$ 均为严格正常数。\n任务要求基于特定的特征尺度选择进行无量纲化：\n1.  一个由静态弹性响应决定的特征位移尺度 $X_s$。\n2.  一个由无阻尼小振荡周期决定的特征时间尺度 $T_s$。\n\n无量纲变量定义为 $x = X_s u$ 和 $t = T_s \\tau$。\n最终目标是：\n1.  推导无量纲运动方程。\n2.  指出并命名无量纲参数。\n3.  确定线性和二次摩擦项量值相等时的临界物理速度 $v_c$，并用 $\\gamma$ 和 $\\beta$ 表示。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据：** 所提供的微分方程是经典力学中用于描述受迫阻尼振子的一个标准且成熟的模型。它包含了线性（斯托克斯）阻力和二次（牛顿）阻力，这两种阻力是在不同流态下流体摩擦的物理真实模型。该设置在根本上是合理的。\n- **良定的：** 问题提供了清晰的指令和明确定义的方程。它要求进行特定的推导（无量纲化、参数识别、临界速度计算），这些推导会导出一个唯一且有意义的结果。\n- **客观性：** 问题陈述使用了精确的数学和物理术语，没有任何主观或模糊的语言。\n- **完整性和一致性：** 所有必要的参数都已定义，并且它们的性质（严格为正）也已指明。选择特征尺度的指令是明确且无矛盾的。该方程是自洽的。\n- **其他缺陷：** 该问题是量纲分析中的一个标准练习，与经典运动方程的分析直接相关。它不是无关紧要的、比喻性的或病态的。\n\n### 第3步：结论与行动\n该问题被认为是有效的，因为它在科学上是合理的、良定的且内部一致。将提供完整的解答。\n\n### 求解推导\n根据问题陈述的要求，求解过程分为两部分：首先，对运动方程进行无量纲化；其次，分析摩擦项以求出临界速度。\n\n**第1部分：无量纲化**\n\n第一步是确定特征尺度 $X_s$ 和 $T_s$。\n1.  特征位移 $X_s$ 由静态弹性响应设定。这对应于时间导数为零（$\\dot{x} = 0$, $\\ddot{x} = 0$）且外力保持在其最大振幅 $F_0$ 的情况。运动方程简化为弹簧力与外力之间的静态平衡：\n    $$ k x_{static} = F_0 $$\n    由此，我们定义特征位移尺度：\n    $$ X_s = \\frac{F_0}{k} $$\n2.  特征时间 $T_s$ 从无阻尼自由振荡情况导出。设 $\\gamma=0$、$\\beta=0$ 和 $F_0=0$，运动方程变为：\n    $$ m \\ddot{x} + k x = 0 $$\n    这是简谐振子的方程，其固有角频率 $\\omega_n$ 由下式给出：\n    $$ \\omega_n = \\sqrt{\\frac{k}{m}} $$\n    此振荡的周期为 $T_n = 2\\pi/\\omega_n$。在此类问题中，特征时间尺度的标准选择是固有角频率的倒数，它与周期成正比。我们选择：\n    $$ T_s = \\frac{1}{\\omega_n} = \\sqrt{\\frac{m}{k}} $$\n\n接下来，我们引入由以下关系式定义的无量纲变量 $\\tau$ 和 $u(\\tau)$：\n$$ t = T_s \\tau \\quad \\text{和} \\quad x(t) = X_s u(\\tau) $$\n现在我们必须用 $u(\\tau)$ 对 $\\tau$ 的导数来表示 $x(t)$ 的时间导数。使用链式法则：\n$$ \\dot{x}(t) = \\frac{dx}{dt} = \\frac{d}{dt}(X_s u(\\tau)) = X_s \\frac{du}{d\\tau} \\frac{d\\tau}{dt} = X_s \\frac{du}{d\\tau} \\frac{1}{T_s} = \\frac{X_s}{T_s} \\frac{du}{d\\tau} $$\n$$ \\ddot{x}(t) = \\frac{d\\dot{x}}{dt} = \\frac{d}{dt}\\left(\\frac{X_s}{T_s} \\frac{du}{d\\tau}\\right) = \\frac{X_s}{T_s} \\frac{d^2u}{d\\tau^2} \\frac{d\\tau}{dt} = \\frac{X_s}{T_s^2} \\frac{d^2u}{d\\tau^2} $$\n将这些表达式以及 $x$ 和 $t$ 的定义代入原始运动方程：\n$$ m\\left(\\frac{X_s}{T_s^2} \\frac{d^2u}{d\\tau^2}\\right) + \\gamma\\left(\\frac{X_s}{T_s} \\frac{du}{d\\tau}\\right) + \\beta\\left(\\frac{X_s}{T_s} \\frac{du}{d\\tau}\\right)\\left|\\frac{X_s}{T_s} \\frac{du}{d\\tau}\\right| + k(X_s u) = F_0\\cos(\\omega T_s \\tau) $$\n现在，我们代入 $X_s$ 和 $T_s$ 的表达式：\n$$ m\\left(\\frac{F_0/k}{m/k}\\right)\\frac{d^2u}{d\\tau^2} + \\gamma\\left(\\frac{F_0/k}{\\sqrt{m/k}}\\right)\\frac{du}{d\\tau} + \\beta\\left(\\frac{F_0/k}{\\sqrt{m/k}}\\right)^2 \\frac{du}{d\\tau}\\left|\\frac{du}{d\\tau}\\right| + k\\left(\\frac{F_0}{k}\\right)u = F_0\\cos\\left(\\omega \\sqrt{\\frac{m}{k}} \\tau\\right) $$\n简化每一项的系数：\n- 惯性项：$m\\left(\\frac{F_0/k}{m/k}\\right) = m \\frac{F_0}{m} = F_0$。\n- 线性摩擦项：$\\gamma\\left(\\frac{F_0/k}{\\sqrt{m/k}}\\right) = \\gamma \\frac{F_0}{\\sqrt{mk}}$。\n- 二次摩擦项：$\\beta\\left(\\frac{F_0}{\\sqrt{mk}}\\right)^2 = \\beta \\frac{F_0^2}{mk}$。\n- 弹性项：$k\\left(\\frac{F_0}{k}\\right) = F_0$。\n\n方程变为：\n$$ F_0\\frac{d^2u}{d\\tau^2} + \\frac{\\gamma F_0}{\\sqrt{mk}}\\frac{du}{d\\tau} + \\frac{\\beta F_0^2}{mk} \\frac{du}{d\\tau}\\left|\\frac{du}{d\\tau}\\right| + F_0 u = F_0\\cos\\left(\\omega \\sqrt{\\frac{m}{k}} \\tau\\right) $$\n由于 $F_0 > 0$，我们可以将整个方程除以 $F_0$：\n$$ \\frac{d^2u}{d\\tau^2} + \\frac{\\gamma}{\\sqrt{mk}}\\frac{du}{d\\tau} + \\frac{\\beta F_0}{mk} \\frac{du}{d\\tau}\\left|\\frac{du}{d\\tau}\\right| + u = \\cos\\left(\\left(\\omega \\sqrt{\\frac{m}{k}}\\right) \\tau\\right) $$\n这就是所求的无量纲方程。我们现在识别并命名无量纲数组：\n- 线性阻尼系数为 $\\zeta_1 = \\frac{\\gamma}{\\sqrt{mk}}$。我们将其命名为**无量纲线性阻尼强度**。该参数是标准阻尼比 $\\zeta = \\frac{\\gamma}{2\\sqrt{mk}}$ 的两倍。\n- 二次阻尼系数为 $\\zeta_2 = \\frac{\\beta F_0}{mk}$。我们将其命名为**无量纲二次阻尼强度**。\n- 驱动项中的无量纲频率为 $\\Omega = \\omega\\sqrt{\\frac{m}{k}} = \\frac{\\omega}{\\omega_n}$。我们将其命名为**频率比**。\n\n最终的无量纲方程为：\n$$ \\frac{d^2u}{d\\tau^2} + \\zeta_1 \\frac{du}{d\\tau} + \\zeta_2 \\frac{du}{d\\tau}\\left|\\frac{du}{d\\tau}\\right| + u = \\cos(\\Omega \\tau) $$\n\n**第2部分：临界速度**\n\n问题要求比较线性和二次摩擦项，以找到它们的主导区间以及二者量值相等时的临界速度 $v_c$。\n物理摩擦力为 $f_{friction} = \\gamma\\dot{x} + \\beta\\dot{x}|\\dot{x}|$。\n线性摩擦项的量值为 $|\\gamma\\dot{x}| = \\gamma|\\dot{x}|$。\n二次摩擦项的量值为 $|\\beta\\dot{x}|\\dot{x}|| = \\beta|\\dot{x}|^2$。\n\n临界速度 $v_c$ 是这两个量值相等时的速率 $|\\dot{x}|$：\n$$ \\gamma v_c = \\beta v_c^2 $$\n假设 $v_c \\neq 0$，我们可以除以 $v_c$：\n$$ \\gamma = \\beta v_c $$\n解出 $v_c$ 得：\n$$ v_c = \\frac{\\gamma}{\\beta} $$\n\n为了使用问题所要求的正式程序来确认此结果，我们对无量纲方程进行相同的比较。无量纲的线性和二次摩擦项分别为 $\\zeta_1 \\frac{du}{d\\tau}$ 和 $\\zeta_2 \\frac{du}{d\\tau}|\\frac{du}{d\\tau}|$。\n线性摩擦占主导地位的区间由以下不等式给出：\n$$ \\left|\\zeta_1 \\frac{du}{d\\tau}\\right| > \\left|\\zeta_2 \\frac{du}{d\\tau}\\left|\\frac{du}{d\\tau}\\right|\\right| \\implies \\zeta_1 \\left|\\frac{du}{d\\tau}\\right| > \\zeta_2 \\left(\\frac{du}{d\\tau}\\right)^2 $$\n对于非零的无量纲速度，这可以简化为 $\\left|\\frac{du}{d\\tau}\\right|  \\frac{\\zeta_1}{\\zeta_2}$。\n相反，当 $\\left|\\frac{du}{d\\tau}\\right| > \\frac{\\zeta_1}{\\zeta_2}$ 时，二次摩擦占主导地位。\n\n这些区间之间的阈值出现在临界无量纲速度 $|\\frac{du}{d\\tau}|_c$ 处，此时二者量值相等：\n$$ \\zeta_1 \\left|\\frac{du}{d\\tau}\\right|_c = \\zeta_2 \\left(\\left|\\frac{du}{d\\tau}\\right|_c\\right)^2 \\implies \\left|\\frac{du}{d\\tau}\\right|_c = \\frac{\\zeta_1}{\\zeta_2} $$\n我们现在将此无量纲速度转换回物理速度。关系式为 $\\dot{x} = \\frac{X_s}{T_s}\\frac{du}{d\\tau}$。因此，临界物理速度 $v_c$ 为：\n$$ v_c = \\left|\\frac{X_s}{T_s}\\right| \\left|\\frac{du}{d\\tau}\\right|_c = \\frac{X_s}{T_s} \\frac{\\zeta_1}{\\zeta_2} $$\n代入 $X_s$、$T_s$、$\\zeta_1$ 和 $\\zeta_2$ 的表达式：\n$$ v_c = \\left(\\frac{F_0/k}{\\sqrt{m/k}}\\right) \\left(\\frac{\\gamma/\\sqrt{mk}}{\\beta F_0/mk}\\right) $$\n让我们逐步简化这个表达式：\n$$ v_c = \\left(\\frac{F_0}{\\sqrt{mk}}\\right) \\left(\\frac{\\gamma}{\\sqrt{mk}} \\cdot \\frac{mk}{\\beta F_0}\\right) $$\n$$ v_c = \\left(\\frac{F_0}{\\sqrt{mk}}\\right) \\left(\\frac{\\gamma \\sqrt{mk}}{\\beta F_0}\\right) $$\n$\\sqrt{mk}$ 和 $F_0$ 项相互抵消：\n$$ v_c = \\frac{\\gamma}{\\beta} $$\n这证实了从对物理力项的直接分析中获得的结果。该结果仅取决于系数 $\\gamma$ 和 $\\beta$，符合要求。\n当物理速度 $|\\dot{x}|  v_c$ 时，线性摩擦项占主导；当 $|\\dot{x}| > v_c$ 时，二次摩擦项占主导。",
            "answer": "$$\n\\boxed{\\frac{\\gamma}{\\beta}}\n$$"
        },
        {
            "introduction": "建立物理模型后，我们常常需要求解其运动方程，其中许多是非线性的。本练习提供了一个具体实例：一个在重力作用下、经历二次方空气阻力而下落的粒子。通过解决这个经典的非线性常微分方程，您将获得求解此类问题的直接经验，并深入理解终端速度等重要物理概念。",
            "id": "3743136",
            "problem": "一个质量为 $m$ 的密实球形颗粒在一个大小为 $g$ 的匀强引力场中，于流体内垂直沉降。在一个通过均质化小尺度流体动力学相互作用得到的粗粒化单颗粒模型中，流体对颗粒施加的二次阻力为 $\\mathbf{F}_{\\mathrm{drag}}=-\\beta \\lvert \\mathbf{v}\\rvert \\mathbf{v}$，其中 $\\beta>0$ 是一个有效阻力系数，$\\mathbf{v}$ 是颗粒的速度。忽略浮力以及任何附加质量力或历史力。选定垂直坐标轴，以向下为正方向。颗粒在时间 $t=0$ 时从静止状态释放。\n\n仅从牛顿第二定律和给定的阻力定律出发，并利用初始条件 $v(0)=0$，完成以下任务：\n- 推导在长时间后达到的终端速度 $v_{\\mathrm{t}}$。\n- 对于一个指定的分数 $0  \\eta  1$，推导当速率首次等于 $\\eta\\,v_{\\mathrm{t}}$ 时的时间 $t_{\\eta}$ 的闭式表达式。\n\n用 $m$、$g$、$\\beta$ 和 $\\eta$ 的符号形式表达你的最终答案。不要代入数值。由于答案是符号形式，不需要指明单位。你的最终答案必须仅包含所要求的两个表达式，并一起呈现。",
            "solution": "该问题陈述已经过验证，被认为是有效的。它在科学上以经典力学为基础，问题设定良好，信息充分，目标明确，且表述客观。该问题是一个求解模拟物理系统的一阶非线性常微分方程的标准练习。\n\n我们首先对颗粒应用牛顿第二定律。运动是沿着垂直轴的一维运动，该轴定义为向下为正。设 $v(t)$ 为颗粒在时间 $t$ 的速率。速度矢量为 $\\mathbf{v} = v(t) \\hat{k}$，其中 $\\hat{k}$ 是指向下方的单位矢量。\n\n有两个力作用在颗粒上：\n$1$. 重力 $\\mathbf{F}_g$ 向下作用。其大小为 $mg$，因此 $\\mathbf{F}_g = mg \\hat{k}$。\n$2$. 二次阻力 $\\mathbf{F}_{\\mathrm{drag}}$ 与运动方向相反。由于颗粒向下运动 ($v \\geq 0$)，所以 $\\mathbf{v} = v \\hat{k}$ 且 $|\\mathbf{v}| = v$。阻力由 $\\mathbf{F}_{\\mathrm{drag}} = -\\beta |\\mathbf{v}| \\mathbf{v} = -\\beta v (v \\hat{k}) = -\\beta v^2 \\hat{k}$ 给出。此力向上作用。\n\n牛顿第二定律指出，合力等于质量乘以加速度，即 $\\sum \\mathbf{F} = m \\mathbf{a}$。在垂直方向上，这给出：\n$$mg - \\beta v^2 = m a = m \\frac{dv}{dt}$$\n这是颗粒速率的运动微分方程。初始条件是颗粒从静止释放，因此 $v(0) = 0$。\n\n首先，我们推导终端速度 $v_{\\mathrm{t}}$。终端速度是颗粒在长时间后达到的恒定速度，此时加速度为零 ($\\frac{dv}{dt} = 0$)。在这一点上，作用在颗粒上的合力为零。将运动方程的左侧设为零：\n$$mg - \\beta v_{\\mathrm{t}}^2 = 0$$\n求解 $v_{\\mathrm{t}}$：\n$$\\beta v_{\\mathrm{t}}^2 = mg$$\n$$v_{\\mathrm{t}}^2 = \\frac{mg}{\\beta}$$\n由于速率是非负的，我们取正平方根：\n$$v_{\\mathrm{t}} = \\sqrt{\\frac{mg}{\\beta}}$$\n\n接下来，我们推导当速率 $v$ 等于终端速度的一小部分 $\\eta$ 时的时间 $t_{\\eta}$，即 $v(t_{\\eta}) = \\eta v_{\\mathrm{t}}$。为此，我们必须求解关于 $v(t)$ 的微分方程。\n$$m \\frac{dv}{dt} = mg - \\beta v^2$$\n我们可以将 $mg = \\beta v_{\\mathrm{t}}^2$ 代入方程：\n$$m \\frac{dv}{dt} = \\beta v_{\\mathrm{t}}^2 - \\beta v^2 = \\beta(v_{\\mathrm{t}}^2 - v^2)$$\n这是一个可分离变量的微分方程。我们整理各项以进行积分：\n$$\\frac{m}{\\beta(v_{\\mathrm{t}}^2 - v^2)} dv = dt$$\n我们对两边从初始状态（$t=0$, $v=0$）积分到时间 $t_{\\eta}$ 时的状态（此时 $v = \\eta v_{\\mathrm{t}}$）：\n$$\\int_0^{t_{\\eta}} dt' = \\int_0^{\\eta v_{\\mathrm{t}}} \\frac{m}{\\beta(v_{\\mathrm{t}}^2 - v^2)} dv$$\n$$t_{\\eta} = \\frac{m}{\\beta} \\int_0^{\\eta v_{\\mathrm{t}}} \\frac{1}{v_{\\mathrm{t}}^2 - v^2} dv$$\n该积分为标准形式。对于常数 $a$，$\\int \\frac{dx}{a^2 - x^2} = \\frac{1}{a}\\arctanh\\left(\\frac{x}{a}\\right) + C$。这里，$a = v_{\\mathrm{t}}$。\n$$t_{\\eta} = \\frac{m}{\\beta} \\left[ \\frac{1}{v_{\\mathrm{t}}} \\arctanh\\left(\\frac{v}{v_{\\mathrm{t}}}\\right) \\right]_0^{\\eta v_{\\mathrm{t}}}$$\n在积分上下限处计算表达式的值：\n$$t_{\\eta} = \\frac{m}{\\beta v_{\\mathrm{t}}} \\left( \\arctanh\\left(\\frac{\\eta v_{\\mathrm{t}}}{v_{\\mathrm{t}}}\\right) - \\arctanh\\left(\\frac{0}{v_{\\mathrm{t}}}\\right) \\right)$$\n由于 $\\arctanh(0)=0$，上式简化为：\n$$t_{\\eta} = \\frac{m}{\\beta v_{\\mathrm{t}}} \\arctanh(\\eta)$$\n现在，我们将 $v_{\\mathrm{t}} = \\sqrt{\\frac{mg}{\\beta}}$ 的表达式代入此方程，以用给定的参数 $m$、$g$、$\\beta$ 和 $\\eta$ 来表示 $t_{\\eta}$。\n$$t_{\\eta} = \\frac{m}{\\beta \\sqrt{\\frac{mg}{\\beta}}} \\arctanh(\\eta) = \\frac{m}{\\sqrt{\\beta^2 \\frac{mg}{\\beta}}} \\arctanh(\\eta) = \\frac{m}{\\sqrt{mg\\beta}} \\arctanh(\\eta)$$\n通过将质量 $m$ 移到平方根内，可以进一步简化此表达式：\n$$t_{\\eta} = \\frac{\\sqrt{m^2}}{\\sqrt{mg\\beta}} \\arctanh(\\eta) = \\sqrt{\\frac{m^2}{mg\\beta}} \\arctanh(\\eta) = \\sqrt{\\frac{m}{g\\beta}} \\arctanh(\\eta)$$\n问题要求 $0  \\eta  1$，这是 $\\arctanh$ 函数的有效定义域，因此解是良定义的。\n\n所要求的两个表达式是终端速度 $v_{\\mathrm{t}}$ 和时间 $t_{\\eta}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\sqrt{\\frac{mg}{\\beta}} \\\\ \\sqrt{\\frac{m}{g\\beta}} \\arctanh(\\eta) \\end{pmatrix}}$$"
        },
        {
            "introduction": "在现实世界中，绝大多数运动方程都无法求得解析解，必须依赖数值方法。本练习通过比较三种基本的数值积分算法（显式欧拉法、隐式中点法和速度Verlet算法）在一个简谐振子上的表现，来探索计算物理学的核心问题。通过这个编码实践，您将深刻理解为何选择合适的积分器（如辛算法）对于保证模拟的长期稳定性和物理真实性至关重要，这是计算建模中的一个核心课题。",
            "id": "3743141",
            "problem": "考虑一个一维谐振子，其运动由牛顿第二定律决定，质量为 $m$，线性弹簧常数为 $k$，且无外力作用。其运动方程为 $m\\,\\dfrac{d^2 x}{dt^2} + k\\,x = 0$。通过设置 $m = 1$ 和 $k = 1$，完全在无量纲单位下进行计算，因此角频率为 $\\omega = \\sqrt{k/m} = 1$。使用初始条件 $x(0) = 1$ 和 $v(0) = \\dfrac{dx}{dt}(0) = 0$。哈密顿量（总能量）为 $H(x,v) = \\dfrac{1}{2} v^2 + \\dfrac{1}{2} x^2$。\n\n任务：仅从基本定律和定义（牛顿第二定律和 $v = \\dfrac{dx}{dt}$）出发，推导并实现该系统的三种时间积分方法：\n- 显式欧拉法，用于一阶形式 $\\dfrac{d}{dt}\\begin{bmatrix}x\\\\v\\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ -1  0\\end{bmatrix} \\begin{bmatrix}x\\\\v\\end{bmatrix}$。\n- 隐式中点法，用于相同的一阶形式。\n- 速度Verlet算法，用于二阶形式 $\\dfrac{d^2 x}{dt^2} = -x$。\n\n对于每种方法，通过计算单个轨迹的以下两个诊断指标来量化其长期能量行为：\n- 通过对 $H(t) - H(0)$ 与 $t$ 在模拟时间区间内进行最小二乘线性回归，得到的最佳拟合线性斜率 $s$（以无量纲单位/单位时间表示）。\n- 时间平均绝对相对能量误差 $\\overline{r} = \\dfrac{1}{N+1}\\sum_{n=0}^{N} \\left|\\dfrac{H(t_n) - H(0)}{H(0)}\\right|$，其中 $t_n = n\\,\\Delta t$ 且 $N = \\left\\lfloor T/\\Delta t \\right\\rfloor$。\n\n你的程序必须：\n- 直接根据牛顿第二定律和所述数值方法所隐含的定义来实现每个积分器，不使用任何外部数值常微分方程（Ordinary Differential Equation (ODE)）求解器。\n- 对于给定的配对 $(\\Delta t, T)$，模拟至 $t_N = N\\,\\Delta t$，其中 $N = \\left\\lfloor T/\\Delta t \\right\\rfloor$，并为三种方法中的每一种计算在 $\\{t_n\\}_{n=0}^{N}$ 上的 $s$ 和 $\\overline{r}$。\n- 全程使用无量纲单位；不需要物理单位。\n- 使用标准线性模型 $H(t) - H(0) \\approx s\\,t + b$ 进行最小二乘回归，并通过无偏求和公式计算斜率 $s$。\n\n测试套件：\n为以下参数集 $(\\Delta t, T)$ 提供结果：\n1. $\\Delta t = 0.2$, $T = 200$。\n2. $\\Delta t = 0.9$, $T = 200$。\n3. $\\Delta t = 1.9$, $T = 50$。\n4. $\\Delta t = 0.01$, $T = 100$。\n\n对于每个参数集，按以下固定顺序输出一个包含六个浮点数的列表：\n$[s_{\\text{Euler}}, \\overline{r}_{\\text{Euler}}, s_{\\text{Mid}}, \\overline{r}_{\\text{Mid}}, s_{\\text{Verlet}}, \\overline{r}_{\\text{Verlet}}]$,\n其中 $s_{\\text{Euler}}$ 和 $\\overline{r}_{\\text{Euler}}$ 对应显式欧拉法，$s_{\\text{Mid}}$ 和 $\\overline{r}_{\\text{Mid}}$ 对应隐式中点法，$s_{\\text{Verlet}}$ 和 $\\overline{r}_{\\text{Verlet}}$ 对应速度Verlet算法。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个顶级列表，内含四个案例的结果，每个结果都是按上述顺序排列的列表，所有浮点数四舍五入到六位有效数字，并根据需要以标准或科学记数法打印。例如：$[[\\dots],[\\dots],[\\dots],[\\dots]]$。\n- 不应打印任何额外文本。\n\n科学真实性和推导约束：\n- 从 $m\\,\\dfrac{d^2 x}{dt^2} + k\\,x = 0$ 开始，其中 $m = 1$, $k = 1$, 且 $v = \\dfrac{dx}{dt}$。\n- 将显式欧拉更新推导为 $(x,v)$ 一阶系统的前向欧拉离散化。\n- 将隐式中点更新推导为应用于一阶系统的中点法则，通过对相应的 $2 \\times 2$ 线性系统求逆在每一步精确求解。\n- 通过将速度半步交错在位置全步周围，为二阶方程推导速度Verlet更新。\n- 确保在适用的情况下遵守数值稳定性考虑。注意，显式欧拉法对于此振荡器是不稳定的，会表现出能量增长，而隐式中点法和速度Verlet算法是保辛的，应表现出质上不同的长期能量行为。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[[result_case1],[result_case2],[result_case3],[result_case4]]”）。",
            "solution": "用户提供了一个有效的问题陈述。\n\n### **问题验证**\n\n**步骤1：提取给定信息**\n- **运动方程**：一维谐振子由牛顿第二定律描述，$m\\,\\dfrac{d^2 x}{dt^2} + k\\,x = 0$。\n- **无量纲单位**：质量 $m=1$ 和弹簧常数 $k=1$。这意味着角频率 $\\omega = \\sqrt{k/m} = 1$。运动方程简化为 $\\dfrac{d^2 x}{dt^2} + x = 0$。\n- **初始条件**：$x(0) = 1$ 和 $v(0) = \\dfrac{dx}{dt}(0) = 0$。\n- **哈密顿量**：总能量为 $H(x,v) = \\dfrac{1}{2} v^2 + \\dfrac{1}{2} x^2$。\n- **任务**：\n    1.  从基本定律推导并实现三种时间积分方法：\n        - 显式欧拉法，用于一阶形式：$\\dfrac{d}{dt}\\begin{bmatrix}x\\\\v\\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ -1  0\\end{bmatrix} \\begin{bmatrix}x\\\\v\\end{bmatrix}$。\n        - 隐式中点法，用于相同的一阶形式。\n        - 速度Verlet算法，用于二阶形式：$\\dfrac{d^2 x}{dt^2} = -x$。\n    2.  使用从单个轨迹计算的两个诊断指标量化长期能量行为，时间步长为 $\\Delta t$，总时间为 $T$。步数为 $N = \\left\\lfloor T/\\Delta t \\right\\rfloor$，时间点为 $t_n = n\\,\\Delta t$，$n \\in \\{0, 1, \\dots, N\\}$。\n        - **能量漂移斜率 $s$**：通过对 $H(t) - H(0)$ 与 $t$ 进行最小二乘回归得到的最佳拟合线性斜率。模型为 $H(t) - H(0) \\approx s\\,t + b$。\n        - **平均相对能量误差 $\\overline{r}$**：$\\overline{r} = \\dfrac{1}{N+1}\\sum_{n=0}^{N} \\left|\\dfrac{H(t_n) - H(0)}{H(0)}\\right|$。\n- **实现约束**：\n    - 直接实现积分器（不使用外部ODE库）。\n    - 使用无量纲单位。\n    - 使用无偏求和公式进行最小二乘回归。\n- **测试套件**：\n    - 案例1：$(\\Delta t, T) = (0.2, 200)$\n    - 案例2：$(\\Delta t, T) = (0.9, 200)$\n    - 案例3：$(\\Delta t, T) = (1.9, 50)$\n    - 案例4：$(\\Delta t, T) = (0.01, 100)$\n- **输出格式**：对于每个案例，一个包含六个浮点数的列表：$[s_{\\text{Euler}}, \\overline{r}_{\\text{Euler}}, s_{\\text{Mid}}, \\overline{r}_{\\text{Mid}}, s_{\\text{Verlet}}, \\overline{r}_{\\text{Verlet}}]$。最终输出是这四个列表的列表。浮点数应四舍五入到六位有效数字。\n\n**步骤2：使用提取的给定信息进行验证**\n- **科学基础**：该问题基于经典力学（牛顿第二定律、谐振子）和数值分析（时间积分方案）的基本原理。所用的方法和诊断指标是计算物理学中的标准方法。它是科学上合理的。\n- **良构问题**：问题定义清晰，包含了所有必要的方程、初始条件、参数和要求的输出。可以计算出唯一且有意义的解。\n- **客观性**：语言精确、量化，没有偏见或主观陈述。\n- 该问题没有任何无效性缺陷。这是一个定义明确的、计算科学中的标准问题。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将提供一个解决方案。\n\n### **解法推导与算法设计**\n\n该问题要求对一个简谐振子的运动方程进行数值积分，并分析三种不同数值方案的长期能量守恒特性。\n\n**1. 系统公式化**\n控制性的二阶常微分方程 (ODE) 是 $\\dfrac{d^2 x}{dt^2} = -x$，初始条件为 $x(0)=1$ 和 $v(0)=0$。这可以表示为一个包含两个一阶ODE的系统。设状态向量为 $\\mathbf{y}(t) = \\begin{bmatrix} x(t) \\\\ v(t) \\end{bmatrix}$。由于 $v = \\dfrac{dx}{dt}$ 且 $\\dfrac{dv}{dt} = \\dfrac{d^2 x}{dt^2} = -x$，该系统为：\n$$ \\frac{d\\mathbf{y}}{dt} = \\begin{bmatrix} \\dot{x} \\\\ \\dot{v} \\end{bmatrix} = \\begin{bmatrix} v \\\\ -x \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix} \\begin{bmatrix} x \\\\ v \\end{bmatrix} $$\n这是一个形式为 $\\dot{\\mathbf{y}} = \\mathbf{A}\\mathbf{y}$ 的线性系统，其中 $\\mathbf{A} = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$。初始状态为 $\\mathbf{y}_0 = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n系统的总能量（哈密顿量）是 $H(x, v) = \\frac{1}{2}v^2 + \\frac{1}{2}x^2$。初始能量是 $H_0 = H(1, 0) = \\frac{1}{2}(0)^2 + \\frac{1}{2}(1)^2 = 0.5$。对于精确解，能量是一个守恒量。\n\n**2. 数值积分器的推导**\n我们用 $(x_n, v_n)$ 或 $\\mathbf{y}_n$ 表示在时间 $t_n = n\\Delta t$ 的状态。\n\n**2.1. 显式（前向）欧拉法**\n前向欧拉法在时间 $t_n$ 处近似导数 $\\dot{\\mathbf{y}}$，并外推以求得 $\\mathbf{y}_{n+1}$：\n$$ \\mathbf{y}_{n+1} = \\mathbf{y}_n + \\Delta t \\, \\dot{\\mathbf{y}}_n = \\mathbf{y}_n + \\Delta t \\, \\mathbf{A}\\mathbf{y}_n = (\\mathbf{I} + \\Delta t \\, \\mathbf{A})\\mathbf{y}_n $$\n其中 $\\mathbf{I}$ 是单位矩阵。分量形式的更新规则是：\n$$ x_{n+1} = x_n + \\Delta t \\, v_n $$\n$$ v_{n+1} = v_n - \\Delta t \\, x_n $$\n众所周知，这种方法对于振荡系统是不稳定的，因为数值能量会系统性地增加。\n\n**2.2. 隐式中点法**\n隐式中点法是一种单步方法，它使用起始状态和结束状态的平均值，在时间间隔的中点评估导数：\n$$ \\mathbf{y}_{n+1} = \\mathbf{y}_n + \\Delta t \\, f\\left(t_n + \\frac{\\Delta t}{2}, \\frac{\\mathbf{y}_n + \\mathbf{y}_{n+1}}{2}\\right) $$\n对于我们的线性系统，$f(\\cdot, \\mathbf{y}) = \\mathbf{A}\\mathbf{y}$，这变为：\n$$ \\mathbf{y}_{n+1} = \\mathbf{y}_n + \\Delta t \\, \\mathbf{A}\\left(\\frac{\\mathbf{y}_n + \\mathbf{y}_{n+1}}{2}\\right) $$\n这是一个关于 $\\mathbf{y}_{n+1}$ 的隐式方程。我们必须解出它：\n$$ \\mathbf{y}_{n+1} - \\frac{\\Delta t}{2}\\mathbf{A}\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{\\Delta t}{2}\\mathbf{A}\\mathbf{y}_n $$\n$$ \\left(\\mathbf{I} - \\frac{\\Delta t}{2}\\mathbf{A}\\right)\\mathbf{y}_{n+1} = \\left(\\mathbf{I} + \\frac{\\Delta t}{2}\\mathbf{A}\\right)\\mathbf{y}_n $$\n$$ \\mathbf{y}_{n+1} = \\left(\\mathbf{I} - \\frac{\\Delta t}{2}\\mathbf{A}\\right)^{-1}\\left(\\mathbf{I} + \\frac{\\Delta t}{2}\\mathbf{A}\\right)\\mathbf{y}_n $$\n让我们计算更新矩阵。需要求逆的矩阵是 $\\mathbf{I} - \\frac{\\Delta t}{2}\\mathbf{A} = \\begin{bmatrix} 1  -\\Delta t/2 \\\\ \\Delta t/2  1 \\end{bmatrix}$。其行列式为 $1 + (\\Delta t/2)^2$，其逆矩阵为 $\\frac{1}{1+(\\Delta t/2)^2}\\begin{bmatrix} 1  \\Delta t/2 \\\\ -\\Delta t/2  1 \\end{bmatrix}$。\n因此，更新矩阵是：\n$$ \\mathbf{M} = \\frac{1}{1 + (\\frac{\\Delta t}{2})^2} \\begin{bmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}  1 \\end{bmatrix} \\begin{bmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}  1 \\end{bmatrix} = \\frac{1}{1 + (\\frac{\\Delta t}{2})^2} \\begin{bmatrix} 1 - (\\frac{\\Delta t}{2})^2  \\Delta t \\\\ -\\Delta t  1 - (\\frac{\\Delta t}{2})^2 \\end{bmatrix} $$\n这为 $\\mathbf{y}_{n+1} = \\mathbf{M}\\mathbf{y}_n$ 提供了显式更新规则。此方法是保辛的，并将表现出优异的长期能量守恒性，误差有界。\n\n**2.3. 速度Verlet法**\n速度Verlet算法是为形式为 $\\ddot{x} = a(x, t)$ 的二阶ODE设计的，对于我们的系统是 $\\ddot{x} = a(x) = -x$。一种常见的形式是：\n1. 更新位置：$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2} a(x_n) (\\Delta t)^2$。\n2. 计算新位置的加速度：$a(x_{n+1})$。\n3. 更新速度：$v_{n+1} = v_n + \\frac{1}{2} [a(x_n) + a(x_{n+1})] \\Delta t$。\n代入 $a(x) = -x$：\n$$ x_{n+1} = x_n + v_n \\Delta t - \\frac{1}{2} x_n (\\Delta t)^2 $$\n$$ v_{n+1} = v_n - \\frac{1}{2} (x_n + x_{n+1}) \\Delta t $$\n与隐式中点法一样，速度Verlet法也是一种保辛积分器，在 $|\\Delta t|  2$ 时稳定，并能守恒一个与真实哈密顿量接近的“影子哈密顿量”，从而在长时间内能量误差有界。\n\n**3. 诊断量**\n对于每个在 $t \\in [0, T]$ 上有 $N = \\lfloor T/\\Delta t \\rfloor$ 步的模拟，我们计算两个诊断量。\n\n**3.1. 平均相对能量误差 ($\\overline{r}$)**\n这是相对能量与初始能量 $H_0$ 偏差的幅值的时均值：\n$$ \\overline{r} = \\frac{1}{N+1} \\sum_{n=0}^{N} \\left| \\frac{H_n - H_0}{H_0} \\right| $$\n其中 $H_n = H(x_n, v_n)$。在 $n=0$ 时，该项为零。\n\n**3.2. 能量漂移斜率 ($s$)**\n这量化了能量误差中的任何系统性趋势。我们对能量误差 $\\Delta H_n = H_n - H_0$ 与时间 $t_n$ 进行线性最小二乘拟合。对于数据点 $(t_n, y_n)$，其中 $y_n = \\Delta H_n$，最佳拟合线 $y=st+b$ 的斜率 $s$ 由以下公式给出：\n$$ s = \\frac{(N+1) \\sum_{n=0}^{N} t_n y_n - (\\sum_{n=0}^{N} t_n) (\\sum_{n=0}^{N} y_n)}{(N+1) \\sum_{n=0}^{N} t_n^2 - (\\sum_{n=0}^{N} t_n)^2} $$\n涉及时间的和可以用解析方法计算：\n$$ \\sum_{n=0}^{N} t_n = \\Delta t \\sum_{n=0}^{N} n = \\Delta t \\frac{N(N+1)}{2} $$\n$$ \\sum_{n=0}^{N} t_n^2 = (\\Delta t)^2 \\sum_{n=0}^{N} n^2 = (\\Delta t)^2 \\frac{N(N+1)(2N+1)}{6} $$\n和 $\\sum y_n$ 和 $\\sum t_n y_n$ 在模拟循环中累积。注意，由于 $y_0 = \\Delta H_0 = 0$ 且 $t_0 y_0 = 0$，这些和可以从 $n=1$ 到 $N$ 累积。\n\n**4. 算法规划**\n程序将按以下结构组织：\n1.  定义指定的测试案例 $(\\Delta t, T)$。\n2.  为每个积分器的步骤创建函数：`euler_step`、`midpoint_step` 和 `verlet_step`，实现推导出的更新规则。\n3.  创建一个通用函数 `compute_diagnostics`，它接受一个步进函数、$\\Delta t$、$T$ 和初始条件作为输入。此函数将：\n    a. 初始化状态 $(x_0, v_0) = (1, 0)$ 和初始能量 $H_0$。\n    b. 初始化计算 $s$ 和 $\\overline{r}$ 所需的和的累加器。\n    c. 从 $n=1$ 到 $N=\\lfloor T/\\Delta t \\rfloor$ 循环，在每次迭代中应用提供的步进函数。\n    d. 在循环内部，计算当前能量 $H_n$ 并更新诊断累加器。\n    e. 循环结束后，使用上述公式计算 $s$ 和 $\\overline{r}$ 的最终值。\n    f. 返回配对 $(s, \\overline{r})$。\n4.  主函数 `solve` 将遍历测试案例。对于每个案例，它将为三个积分器步进函数中的每一个调用 `compute_diagnostics`。\n5.  每个案例的结果（一个包含六个浮点数的列表）将被收集。\n6.  最后，所有案例的结果将按照指定格式化为单个字符串：一个列表的列表，每个数字格式化为六位有效数字。该字符串将是唯一的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and analyzes three numerical integrators for the\n    simple harmonic oscillator, as per the problem description.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.2, 200.0),\n        (0.9, 200.0),\n        (1.9, 50.0),\n        (0.01, 100.0),\n    ]\n\n    all_results = []\n    for dt, T in test_cases:\n        case_results = []\n        x0, v0 = 1.0, 0.0\n\n        # Run for Explicit Euler\n        s_euler, r_euler = compute_diagnostics(euler_step, dt, T, x0, v0)\n        case_results.extend([s_euler, r_euler])\n\n        # Run for Implicit Midpoint\n        s_mid, r_mid = compute_diagnostics(midpoint_step, dt, T, x0, v0)\n        case_results.extend([s_mid, r_mid])\n\n        # Run for Velocity Verlet\n        s_verlet, r_verlet = compute_diagnostics(verlet_step, dt, T, x0, v0)\n        case_results.extend([s_verlet, r_verlet])\n\n        all_results.append(case_results)\n\n    # Format the final output string as per requirements.\n    formatted_cases = []\n    for case_result in all_results:\n        formatted_numbers = [f\"{num:.6g}\" for num in case_result]\n        formatted_cases.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    print(final_output)\n\ndef euler_step(x, v, dt):\n    \"\"\"\n    Performs one step of the Explicit Euler method.\n    x_n+1 = x_n + dt * v_n\n    v_n+1 = v_n - dt * x_n\n    \"\"\"\n    x_new = x + dt * v\n    v_new = v - dt * x\n    return x_new, v_new\n\ndef midpoint_step(x, v, dt):\n    \"\"\"\n    Performs one step of the Implicit Midpoint method.\n    Solved explicitly for the linear system.\n    \"\"\"\n    dt_half = dt / 2.0\n    factor = 1.0 / (1.0 + dt_half**2)\n    cos_theta_like = 1.0 - dt_half**2\n    sin_theta_like = dt\n    \n    x_new = factor * (cos_theta_like * x + sin_theta_like * v)\n    v_new = factor * (-sin_theta_like * x + cos_theta_like * v)\n    return x_new, v_new\n\ndef verlet_step(x, v, dt):\n    \"\"\"\n    Performs one step of the Velocity Verlet method.\n    x_n+1 = x_n + v_n*dt + 0.5*a_n*dt^2\n    v_n+1 = v_n + 0.5*(a_n + a_n+1)*dt\n    \"\"\"\n    a = -x\n    x_new = x + v * dt + 0.5 * a * dt**2\n    a_new = -x_new\n    v_new = v + 0.5 * (a + a_new) * dt\n    return x_new, v_new\n\ndef compute_diagnostics(step_function, dt, T, x0, v0):\n    \"\"\"\n    Runs a simulation using the provided step_function and computes\n    the energy drift slope 's' and average relative energy error 'r_bar'.\n    \"\"\"\n    # np.floor is equivalent to standard floor, but int() truncates towards zero.\n    # For positive T/dt, they are the same.\n    N = int(T / dt)\n    num_points = N + 1\n    \n    x, v = x0, v0\n    H0 = 0.5 * v0**2 + 0.5 * x0**2\n    \n    # Initialize accumulators for diagnostics\n    # The sums are over n=0 to N. The terms for n=0 are all 0.\n    sum_rel_err = 0.0\n    sum_y = 0.0  # y = H - H0\n    sum_ty = 0.0 # t * y\n\n    for n in range(1, N + 1):\n        x, v = step_function(x, v, dt)\n        t = n * dt\n        H = 0.5 * v**2 + 0.5 * x**2\n        y = H - H0\n        \n        if H0 != 0:\n            sum_rel_err += abs(y / H0)\n        \n        sum_y += y\n        sum_ty += t * y\n\n    # Calculate average relative error r_bar\n    avg_rel_err = sum_rel_err / num_points\n\n    # Calculate least-squares slope s\n    # sum_t and sum_t2 are over n=0 to N\n    sum_t = dt * N * num_points / 2.0\n    sum_t2 = dt**2 * N * num_points * (2 * N + 1) / 6.0\n    \n    # Denominator of the slope formula\n    denom = num_points * sum_t2 - sum_t**2\n    \n    slope = 0.0\n    if abs(denom)  1e-12: # Avoid division by zero\n        # Numerator of the slope formula\n        numer = num_points * sum_ty - sum_t * sum_y\n        slope = numer / denom\n        \n    return slope, avg_rel_err\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}