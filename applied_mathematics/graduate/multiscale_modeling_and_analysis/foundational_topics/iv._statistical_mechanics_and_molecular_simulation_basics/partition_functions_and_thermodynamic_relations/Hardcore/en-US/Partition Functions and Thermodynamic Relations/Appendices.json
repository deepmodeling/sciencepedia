{
    "hands_on_practices": [
        {
            "introduction": "This first practice returns to the fundamental definition of the canonical partition function, $Z$. By considering a generic quantum system with a discrete energy spectrum, we will explicitly construct $Z$ by summing over the Boltzmann factors for all accessible microstates. This exercise clarifies the crucial role of energy level degeneracies and bridges the conceptual gap between the microcanonical counting of states and the canonical ensemble's statistical weighting .",
            "id": "3792672",
            "problem": "Consider a finite quantum system with Hamiltonian $\\hat{H}$ acting on a finite-dimensional Hilbert space. The spectrum of $\\hat{H}$ consists of a finite set of distinct energy values $\\{E_i\\}_{i=1}^{M}$, where each $E_i$ has a finite degeneracy $g_i \\in \\mathbb{N}$ counting the number of orthonormal eigenstates with energy $E_i$. Let $\\beta$ denote the inverse temperature in the canonical ensemble. In a multiscale modeling perspective, one may regard the set of microstates at fixed energy as a fine-scale manifold that is coarse-grained into a single macrostate labeled by $E_i$, with the multiplicity of microstates captured by the degeneracy $g_i$.\n\nStarting from the microcanonical counting interpretation and the canonical ensemble definition, carry out the following tasks without assuming any pre-specified formula relating the density of states to the partition function:\n\n- Represent the microcanonical density of states $\\Omega(E)$ as a generalized function that counts the number of microstates at energy $E$, expressed in terms of Dirac delta distributions supported at the discrete energies $\\{E_i\\}$, and explain explicitly how the degeneracy factors $\\{g_i\\}$ enter this representation.\n\n- Using the canonical ensemble definition, derive an explicit expression for the canonical partition function $Z(\\beta)$ purely in terms of the set of distinct energies $\\{E_i\\}$ and their degeneracies $\\{g_i\\}$, with no remaining integrals.\n\nProvide your final answer as a single closed-form analytical expression for $Z(\\beta)$ in terms of $\\{E_i\\}$, $\\{g_i\\}$, and $\\beta$ only. Do not include units. If you introduce any additional notation, define it clearly. The final answer must be a single expression.",
            "solution": "The problem asks for two related derivations concerning a finite quantum system described within the framework of statistical mechanics. The system has a discrete set of energy eigenvalues $\\{E_i\\}_{i=1}^{M}$ with corresponding finite degeneracies $\\{g_i\\}_{i=1}^{M}$. We are tasked with representing the microcanonical density of states $\\Omega(E)$ and deriving the canonical partition function $Z(\\beta)$.\n\nFirst, we address the representation of the microcanonical density of states, $\\Omega(E)$. The function $\\Omega(E)$ quantifies the number of microstates per unit energy interval at energy $E$. For a quantum system with a discrete energy spectrum, there are no available states between the allowed energy eigenvalues $E_i$. The states only exist precisely at these discrete energy values. The number of states at a specific energy $E_i$ is given by its degeneracy, $g_i$.\n\nTo represent this structure mathematically, we employ the Dirac delta distribution, $\\delta(x)$. The Dirac delta is a generalized function with the property that $\\delta(x-a) = 0$ for all $x \\neq a$, and its integral over any domain containing $a$ is unity, i.e., $\\int f(x) \\delta(x-a) dx = f(a)$ for a function $f(x)$ continuous at $x=a$. A weighted delta function, $c \\cdot \\delta(x-a)$, represents a \"point mass\" of magnitude $c$ located at $x=a$.\n\nIn our context, the energy $E$ is the variable. For each allowed energy level $E_i$, there is a \"concentration\" of $g_i$ states. We can represent this concentration using a Dirac delta function centered at $E_i$ and weighted by the degeneracy $g_i$. The contribution to the density of states from the energy level $E_i$ is thus $g_i \\delta(E - E_i)$. Since the total density of states is the sum of contributions from all possible energy levels, we must sum over all distinct energy eigenvalues $E_i$. This gives the representation of the microcanonical density of states as a sum of generalized functions:\n$$\n\\Omega(E) = \\sum_{i=1}^{M} g_i \\delta(E - E_i)\n$$\nThis expression correctly captures the discrete nature of the spectrum. The number of states $N(E_a, E_b)$ in an arbitrary energy interval $[E_a, E_b]$ is given by the integral of $\\Omega(E)$ over that interval. If the interval $[E_a, E_b]$ contains a single energy level $E_k$, then $\\int_{E_a}^{E_b} \\Omega(E) dE = \\int_{E_a}^{E_b} \\sum_{i=1}^{M} g_i \\delta(E - E_i) dE = g_k$, which is the correct count of states.\n\nNext, we derive the canonical partition function $Z(\\beta)$. The canonical partition function is defined by summing the Boltzmann factor, $\\exp(-\\beta E_s)$, over all accessible microstates $s$ of the system. Let the set of all microstates be denoted by $\\mathcal{S}$. The energy of a microstate $s$ is $E_s$. The definition is:\n$$\nZ(\\beta) = \\sum_{s \\in \\mathcal{S}} \\exp(-\\beta E_s)\n$$\nThe problem states that the system has a finite set of distinct energy values $\\{E_i\\}_{i=1}^{M}$, and for each such value $E_i$, there are $g_i$ orthonormal eigenstates. These $g_i$ states are the microstates that share the same energy $E_i$. We can partition the total set of microstates $\\mathcal{S}$ into $M$ disjoint subsets, where the $i$-th subset, $\\mathcal{S}_i$, contains all the microstates with energy $E_i$. The size of the set $\\mathcal{S}_i$ is the degeneracy $g_i$.\n\nWith this partitioning, the sum over all states can be rewritten as a sum over the energy levels, followed by a sum over the degenerate states within each level:\n$$\nZ(\\beta) = \\sum_{i=1}^{M} \\sum_{s \\in \\mathcal{S}_i} \\exp(-\\beta E_s)\n$$\nFor any microstate $s$ in the subset $\\mathcal{S}_i$, its energy $E_s$ is, by definition, equal to $E_i$. Therefore, the Boltzmann factor $\\exp(-\\beta E_s)$ is constant for all states within the inner sum and is equal to $\\exp(-\\beta E_i)$. We can factor this term out of the inner summation:\n$$\nZ(\\beta) = \\sum_{i=1}^{M} \\left( \\exp(-\\beta E_i) \\sum_{s \\in \\mathcal{S}_i} 1 \\right)\n$$\nThe remaining inner sum, $\\sum_{s \\in \\mathcal{S}_i} 1$, simply counts the number of states in the subset $\\mathcal{S}_i$. This number is the degeneracy of the energy level $E_i$, which is $g_i$.\n$$\n\\sum_{s \\in \\mathcal{S}_i} 1 = g_i\n$$\nSubstituting this result back into the expression for $Z(\\beta)$, we obtain the final form of the canonical partition function for this system:\n$$\nZ(\\beta) = \\sum_{i=1}^{M} g_i \\exp(-\\beta E_i)\n$$\nThis expression gives the partition function purely in terms of the fundamental properties of the system's energy spectrum: the distinct energy values $\\{E_i\\}$ and their corresponding degeneracies $\\{g_i\\}$. This derivation starts from the first principles of the canonical ensemble and does not assume any prior integral relationships.",
            "answer": "$$\n\\boxed{\\sum_{i=1}^{M} g_i \\exp(-\\beta E_i)}\n$$"
        },
        {
            "introduction": "From abstract principles, we now turn to a concrete application in molecular thermodynamics. This practice investigates how a microscopic detail rooted in quantum mechanics—the symmetry of a molecule—translates into measurable macroscopic effects on entropy and chemical equilibrium. By analyzing the rotational partition function for a homonuclear diatomic molecule, you will quantify the error introduced by ignoring symmetry, a critical consideration in computational chemistry and catalysis modeling .",
            "id": "3891065",
            "problem": "A computational catalysis group is building an ideal-gas thermochemistry module to feed a microkinetic model. The module evaluates molecular canonical partition functions by factorizing the internal degrees of freedom into translation, rotation, and vibration under the rigid-rotor and harmonic-oscillator approximations. Consider the rotational contribution for a rigid rotor and the principle of indistinguishability: orientations connected by proper rotations that map a molecule onto itself represent the same microstate and must not be overcounted.\n\nStart from the canonical definition of the partition function and Helmholtz free energy, $Q=\\sum_{\\alpha}\\exp(-\\beta E_{\\alpha})$, $A=-k_{\\mathrm{B}}T\\ln Q$, with Boltzmann constant $k_{\\mathrm{B}}$, inverse temperature $\\beta=1/(k_{\\mathrm{B}}T)$, and temperature $T$. Use the thermodynamic definitions of entropy and equilibrium constant, $S=-(\\partial A/\\partial T)_{V}$ and $K^{\\circ}=\\exp(-\\Delta G^{\\circ}/(RT))$, where $\\Delta G^{\\circ}$ is the standard-state Gibbs free energy change, $G=A+pV$, $p$ is pressure, $V$ is volume, and $R$ is the ideal gas constant. Work in the ideal-gas limit and assume that the rigid-rotor description is valid in the high-temperature regime where many rotational states are populated. Neglect nuclear spin statistics beyond the rotational symmetry consideration.\n\nYou are asked to identify the quantitative role of the rotational symmetry number $\\sigma$ in the single-molecule rotational partition function $q_{\\mathrm{rot}}$ and to demonstrate how omitting $\\sigma$ biases the computed molar entropy and a standard-state equilibrium constant.\n\nFocus on a homonuclear diatomic molecule and the dissociation equilibrium\n$$\n\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)\n$$\nat $T=1000\\,\\mathrm{K}$ and $p^{\\circ}=1\\,\\mathrm{bar}$. For $\\mathrm{N}_{2}$, take the rotational symmetry number to be $\\sigma=2$, and note that atomic $\\mathrm{N}$ has no rotational degree of freedom. To isolate the symmetry effect, compare two otherwise identical models that differ only by whether the rotational symmetry division is included in $q_{\\mathrm{rot}}$ (the “correct” model) or omitted (the “omitted-$\\sigma$” model). Assume all non-rotational contributions are identical between these two models so that any difference in $S$ and $K^{\\circ}$ arises solely from rotational symmetry counting.\n\nWhich option correctly states both (i) the bias in the molar rotational entropy for $\\mathrm{N}_{2}$ introduced by omitting $\\sigma$ (magnitude and sign), and (ii) the resulting multiplicative bias factor in the predicted standard-state equilibrium constant for the dissociation reaction, $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}$, under these conditions?\n\nA. Omitting $\\sigma$ overcounts rotational microstates, inflating the molar rotational entropy by $+R\\ln\\sigma$; for $\\mathrm{N}_{2}$, $+R\\ln 2\\approx 5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. For $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$ this makes $K^{\\circ}$ smaller by a factor of $2$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=1/2$.\n\nB. Omitting $\\sigma$ undercounts rotational microstates, reducing the molar rotational entropy by $-R\\ln\\sigma$; for $\\mathrm{N}_{2}$, $-R\\ln 2\\approx -5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. For $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$ this makes $K^{\\circ}$ larger by a factor of $2$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=2$.\n\nC. Omitting $\\sigma$ changes the molar rotational entropy by $+\\tfrac{1}{2}R\\ln\\sigma$; for $\\mathrm{N}_{2}$, $+\\tfrac{1}{2}R\\ln 2\\approx 2.88\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. The bias in $K^{\\circ}$ is $\\sqrt{2}$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=\\sqrt{2}$.\n\nD. Omitting $\\sigma$ affects only the entropy, increasing it by $+R\\ln\\sigma$; the equilibrium constant is unchanged for $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=1$.\n\nE. At high temperature, omitting $\\sigma$ leaves the molar rotational entropy unchanged, but it doubles the equilibrium constant for $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=2$.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded, well-posed, and objective, providing sufficient information to derive a unique solution without internal contradictions.\n\nThe task is to determine the quantitative error introduced in the molar entropy of $\\mathrm{N}_{2}$ and the equilibrium constant $K^{\\circ}$ of its dissociation by omitting the rotational symmetry number, $\\sigma$.\n\nLet us begin by a rigorous derivation based on the first principles provided.\n\n**1. Effect on the Rotational Partition Function and Molar Entropy**\n\nThe single-molecule partition function, $q$, factorizes into contributions from different degrees of freedom. We are concerned with the rotational contribution, $q_{\\mathrm{rot}}$. For a linear rigid rotor like $\\mathrm{N}_{2}$ in the high-temperature limit, the classical rotational partition function is proportional to the temperature $T$. To account for the indistinguishability of orientations for a symmetric molecule, this classical result must be divided by the rotational symmetry number, $\\sigma$.\n\nThe correct single-molecule rotational partition function for $\\mathrm{N}_{2}$ is:\n$$\nq_{\\mathrm{rot, correct}} = \\frac{q'_{\\mathrm{rot}}}{\\sigma}\n$$\nwhere $q'_{\\mathrm{rot}}$ is the rotational partition function without the symmetry correction, and for $\\mathrm{N}_{2}$, $\\sigma=2$. The \"omitted-$\\sigma$\" model uses:\n$$\nq_{\\mathrm{rot, omitted}} = q'_{\\mathrm{rot}}\n$$\nTherefore, the relationship between the two is:\n$$\nq_{\\mathrm{rot, omitted}} = \\sigma \\cdot q_{\\mathrm{rot, correct}}\n$$\nThe Helmholtz free energy $A$ is related to the canonical partition function $Q$ by $A = -k_{\\mathrm{B}}T\\ln Q$. For $1$ mole of an ideal gas ($N=N_A$ particles), the molar Helmholtz energy $A_{\\text{m}}$ is related to the single-molecule partition function $q$ by $A_{\\text{m}} = -RT\\ln(q/N_A) - RT$ after using Stirling's approximation. Separating the rotational contribution, the molar rotational Helmholtz energy is:\n$$\nA_{\\mathrm{m, rot}} = -RT \\ln q_{\\mathrm{rot}}\n$$\nThe molar entropy $S_{\\text{m}}$ is given by the thermodynamic relation $S_{\\text{m}} = -(\\partial A_{\\text{m}} / \\partial T)_{V}$. The molar rotational entropy is thus:\n$$\nS_{\\mathrm{m, rot}} = -\\frac{\\partial A_{\\mathrm{m, rot}}}{\\partial T} = -\\frac{\\partial}{\\partial T}(-RT \\ln q_{\\mathrm{rot}}) = R \\ln q_{\\mathrm{rot}} + RT \\frac{\\partial \\ln q_{\\mathrm{rot}}}{\\partial T}\n$$\nIn the high-temperature limit for a linear rotor, $q'_{\\mathrm{rot}} = 8\\pi^2 I k_B T / h^2$, which means $q_{\\mathrm{rot}}$ is directly proportional to $T$. Let $q_{\\mathrm{rot}} = C \\cdot T$, where $C$ is a constant. Then $\\ln q_{\\mathrm{rot}} = \\ln C + \\ln T$. The derivative is $\\partial (\\ln q_{\\mathrm{rot}}) / \\partial T = 1/T$.\nSubstituting this back, we get:\n$$\nS_{\\mathrm{m, rot}} = R \\ln q_{\\mathrm{rot}} + RT\\left(\\frac{1}{T}\\right) = R(\\ln q_{\\mathrm{rot}} + 1)\n$$\nWe can now calculate the bias in molar rotational entropy, $\\Delta S_{\\mathrm{m, rot}}$, which is the value from the \"omitted-$\\sigma$\" model minus the value from the \"correct\" model:\n$$\n\\Delta S_{\\mathrm{m, rot}} = S_{\\mathrm{m, rot, omitted}} - S_{\\mathrm{m, rot, correct}} = R(\\ln q_{\\mathrm{rot, omitted}} + 1) - R(\\ln q_{\\mathrm{rot, correct}} + 1)\n$$\n$$\n\\Delta S_{\\mathrm{m, rot}} = R(\\ln q_{\\mathrm{rot, omitted}} - \\ln q_{\\mathrm{rot, correct}}) = R \\ln\\left(\\frac{q_{\\mathrm{rot, omitted}}}{q_{\\mathrm{rot, correct}}}\\right)\n$$\nUsing the relationship $q_{\\mathrm{rot, omitted}} = \\sigma \\cdot q_{\\mathrm{rot, correct}}$, we find:\n$$\n\\Delta S_{\\mathrm{m, rot}} = R \\ln \\sigma\n$$\nThis result shows that omitting the symmetry number $\\sigma$ leads to an overestimation of the molar entropy. For $\\mathrm{N}_{2}$, $\\sigma=2$. The bias is:\n$$\n\\Delta S_{\\mathrm{m, rot}} = R \\ln 2 \\approx (8.3145\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (0.6931) \\approx +5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\n$$\nOmitting $\\sigma$ inflates the count of accessible rotational microstates, thereby artificially increasing the calculated entropy.\n\n**2. Effect on the Standard-State Equilibrium Constant**\n\nThe standard-state equilibrium constant $K^{\\circ}$ is given by $K^{\\circ} = \\exp(-\\Delta G^{\\circ}/(RT))$, where $\\Delta G^{\\circ}$ is the standard-state Gibbs free energy change for the reaction. For the reaction $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$, this is:\n$$\n\\Delta G^{\\circ} = 2G^{\\circ}_{\\mathrm{m,N}} - G^{\\circ}_{\\mathrm{m,N}_{2}}\n$$\nThe Gibbs free energy is defined as $G = A + pV = U - TS + pV$. For an ideal gas, $G_{\\text{m}} = U_{\\text{m}} - TS_{\\text{m}} + RT = H_{\\text{m}} - TS_{\\text{m}}$.\nThe \"omitted-$\\sigma$\" model introduces a bias in $G^{\\circ}_{\\mathrm{m}}$ solely through the entropy term. The enthalpy $H_{\\text{m}}$ is unaffected by $\\sigma$, because the rotational internal energy $U_{\\mathrm{m, rot}} = RT^2 \\frac{\\partial \\ln q_{\\mathrm{rot}}}{\\partial T} = RT$, which is independent of $\\sigma$. All other contributions are assumed identical.\nThe bias in the standard molar Gibbs free energy of a species $j$, $\\delta(G^{\\circ}_{\\mathrm{m},j})$, is:\n$$\n\\delta(G^{\\circ}_{\\mathrm{m},j}) = G^{\\circ}_{\\mathrm{m},j, \\text{omitted}} - G^{\\circ}_{\\mathrm{m},j, \\text{correct}} = (H^{\\circ}_{\\mathrm{m},j} - T S^{\\circ}_{\\mathrm{m},j, \\text{omitted}}) - (H^{\\circ}_{\\mathrm{m},j} - T S^{\\circ}_{\\mathrm{m},j, \\text{correct}})\n$$\n$$\n\\delta(G^{\\circ}_{\\mathrm{m},j}) = -T (S^{\\circ}_{\\mathrm{m},j, \\text{omitted}} - S^{\\circ}_{\\mathrm{m},j, \\text{correct}}) = -T \\Delta S^{\\circ}_{\\mathrm{m},j}\n$$\nFor $\\mathrm{N}_{2}$, we found $\\Delta S^{\\circ}_{\\mathrm{m,N}_{2}} = R \\ln \\sigma$. Therefore:\n$$\n\\delta(G^{\\circ}_{\\mathrm{m,N}_{2}}) = -T(R \\ln \\sigma)\n$$\nFor atomic nitrogen ($\\mathrm{N}$), there are no rotational degrees of freedom, so $\\sigma$ is not defined or is effectively $1$. In either case, the rotational partition function is unaffected, and thus $\\Delta S^{\\circ}_{\\mathrm{m,N}} = 0$ and $\\delta(G^{\\circ}_{\\mathrm{m,N}}) = 0$.\n\nNow, we find the bias in the Gibbs free energy change for the reaction, $\\delta(\\Delta G^{\\circ})$:\n$$\n\\delta(\\Delta G^{\\circ}) = \\Delta G^{\\circ}_{\\text{omitted}} - \\Delta G^{\\circ}_{\\text{correct}} = (2\\delta(G^{\\circ}_{\\mathrm{m,N}})) - (\\delta(G^{\\circ}_{\\mathrm{m,N}_{2}}))\n$$\n$$\n\\delta(\\Delta G^{\\circ}) = 2(0) - (-T R \\ln \\sigma) = +RT \\ln \\sigma\n$$\nThe ratio of the biased to the correct equilibrium constant is:\n$$\n\\frac{K^{\\circ}_{\\text{omitted-}\\sigma}}{K^{\\circ}_{\\text{correct}}} = \\frac{\\exp(-\\Delta G^{\\circ}_{\\text{omitted}}/(RT))}{\\exp(-\\Delta G^{\\circ}_{\\text{correct}}/(RT))} = \\exp\\left(-\\frac{\\Delta G^{\\circ}_{\\text{omitted}} - \\Delta G^{\\circ}_{\\text{correct}}}{RT}\\right) = \\exp\\left(-\\frac{\\delta(\\Delta G^{\\circ})}{RT}\\right)\n$$\nSubstituting the expression for $\\delta(\\Delta G^{\\circ})$:\n$$\n\\frac{K^{\\circ}_{\\text{omitted-}\\sigma}}{K^{\\circ}_{\\text{correct}}} = \\exp\\left(-\\frac{RT \\ln \\sigma}{RT}\\right) = \\exp(-\\ln \\sigma) = \\frac{1}{\\sigma}\n$$\nFor the dissociation of $\\mathrm{N}_{2}$ where $\\sigma=2$, the multiplicative bias factor is $1/2$. Omitting $\\sigma$ for the reactant $\\mathrm{N}_{2}$ inflates its entropy, which makes its Gibbs free energy more negative (more stable). This shifts the equilibrium towards the reactant, thereby decreasing the equilibrium constant for dissociation.\n\n**Summary of Results:**\n-   Bias in molar rotational entropy for $\\mathrm{N}_{2}$: $\\Delta S_{\\mathrm{m, rot}} = +R \\ln 2 \\approx +5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n-   Multiplicative bias in the equilibrium constant: $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}} = 1/2$.\n\n**Evaluation of Options:**\n\n**A.** Omitting $\\sigma$ overcounts rotational microstates, inflating the molar rotational entropy by $+R\\ln\\sigma$; for $\\mathrm{N}_{2}$, $+R\\ln 2\\approx 5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. For $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$ this makes $K^{\\circ}$ smaller by a factor of $2$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=1/2$.\n-   **Justification**: This statement perfectly matches our derived results for both the entropy bias ($+R\\ln 2$) and the equilibrium constant bias factor ($1/2$).\n-   **Verdict**: **Correct**.\n\n**B.** Omitting $\\sigma$ undercounts rotational microstates, reducing the molar rotational entropy by $-R\\ln\\sigma$; for $\\mathrm{N}_{2}$, $-R\\ln 2\\approx -5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. For $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$ this makes $K^{\\circ}$ larger by a factor of $2$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=2$.\n-   **Justification**: This is incorrect. Omitting the division by $\\sigma$ is an overcount, not an undercount, so the entropy bias is positive. Consequently, the equilibrium constant ratio is $1/\\sigma = 1/2$, not $2$.\n-   **Verdict**: **Incorrect**.\n\n**C.** Omitting $\\sigma$ changes the molar rotational entropy by $+\\tfrac{1}{2}R\\ln\\sigma$; for $\\mathrm{N}_{2}$, $+\\tfrac{1}{2}R\\ln 2\\approx 2.88\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. The bias in $K^{\\circ}$ is $\\sqrt{2}$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=\\sqrt{2}$.\n-   **Justification**: This is incorrect. The factor in the entropy bias is $R$, not $\\tfrac{1}{2}R$. The bias factor for $K^{\\circ}$ is $1/\\sigma$, not $1/\\sqrt{\\sigma}$.\n-   **Verdict**: **Incorrect**.\n\n**D.** Omitting $\\sigma$ affects only the entropy, increasing it by $+R\\ln\\sigma$; the equilibrium constant is unchanged for $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=1$.\n-   **Justification**: This is incorrect. While the entropy-bias part is correct, it is a contradiction to claim the equilibrium constant is unchanged. The equilibrium constant depends on the Gibbs free energy, which in turn depends on entropy ($G=H-TS$). A change in entropy must propagate to a change in $K^{\\circ}$.\n-   **Verdict**: **Incorrect**.\n\n**E.** At high temperature, omitting $\\sigma$ leaves the molar rotational entropy unchanged, but it doubles the equilibrium constant for $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$, i.e., $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=2$.\n-   **Justification**: This is incorrect. The entropy bias $R\\ln\\sigma$ is a non-zero constant in the high-temperature regime. The equilibrium constant ratio is $1/2$, not $2$.\n-   **Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "This final practice introduces a powerful technique for solving lattice models in statistical mechanics: the transfer matrix method. Applying this method to the one-dimensional Ising model, you will not only calculate the partition function exactly but also delve into its deeper mathematical structure. The exercise culminates in a numerical exploration of the Lee-Yang theorem, which connects the zeros of the partition function in the complex plane to the physics of phase transitions .",
            "id": "3792667",
            "problem": "Consider the one-dimensional Ising model with periodic boundary conditions (PBC) on a ring of $N$ spins, with ferromagnetic nearest-neighbor coupling and an external magnetic field. The spin variables are $\\sigma_i \\in \\{-1,+1\\}$ for $i \\in \\{1,\\dots,N\\}$. The Hamiltonian is\n$$\nH(\\{\\sigma\\};J,h) \\;=\\; -J \\sum_{i=1}^{N} \\sigma_i \\sigma_{i+1} \\;-\\; h \\sum_{i=1}^{N} \\sigma_i,\n$$\nwith $\\sigma_{N+1} \\equiv \\sigma_1$, and the Boltzmann weight at inverse temperature $\\beta$ is $\\exp(-\\beta H) = \\exp\\!\\left(\\beta J \\sum_{i=1}^{N} \\sigma_i \\sigma_{i+1} + \\beta h \\sum_{i=1}^{N} \\sigma_i\\right)$. Assume $J>0$ (ferromagnetic). All quantities in this problem are dimensionless.\n\nYour tasks are:\n1) Starting from the definition of the partition function $Z(\\beta,h) = \\sum_{\\{\\sigma\\}} \\exp(-\\beta H)$ and the nearest-neighbor structure of the model, derive an expression for $Z(\\beta,h)$ in terms of the Transfer Matrix (TM). Concretely, construct a $2 \\times 2$ TM whose entries are single-bond Boltzmann weights with the magnetic field split evenly across adjacent bonds so that the product of matrix elements around the ring reproduces the correct total Boltzmann factor. Show that $Z(\\beta,h)$ can be computed as the trace of the $N$-th power of this matrix, that is $Z(\\beta,h) = \\mathrm{Tr}\\, T^N$, and specify how to evaluate this trace efficiently using the eigenvalues of $T$ without giving an explicit closed form for those eigenvalues.\n\n2) To investigate Lee-Yang zeros, define the activity variable $y = e^{-2 \\beta h}$. Prove that the partition function can be written in the form\n$$\nZ(\\beta,h) \\;=\\; e^{\\beta h N} \\sum_{k=0}^{N} a_k(\\beta,J)\\, y^k,\n$$\nby grouping configurations by their total magnetization $M = \\sum_{i=1}^{N} \\sigma_i$ and using the identity $e^{\\beta h M} = e^{\\beta h N} \\, y^{(N-M)/2}$. Provide a formula for the coefficients $a_k(\\beta,J)$ as a sum over configurations with fixed magnetization that depends only on the interaction term $\\sum_{i=1}^{N} \\sigma_i \\sigma_{i+1}$. Explain why the Lee-Yang zeros in the $y$-plane are exactly the zeros of the degree-$N$ polynomial $P_N(y) = \\sum_{k=0}^{N} a_k(\\beta,J)\\, y^k$, since the prefactor $e^{\\beta h N}$ is nonzero.\n\n3) Design an algorithm that:\n- Computes $Z(\\beta,h)$ via the TM method for given $N$, $\\beta$, $J$, and real $h$.\n- Computes the polynomial coefficients $a_k(\\beta,J)$ by direct enumeration of all $2^N$ spin configurations and grouping by $k = (N-M)/2$, where $M$ is the magnetization. Then finds all roots of $P_N(y)$ in the complex $y$-plane.\n- Reports the maximum absolute deviation of the root moduli from unity, $\\max_j \\big|\\,|y_j| - 1\\,\\big|$, as a numerical diagnostic of the Lee-Yang Circle Theorem in the ferromagnetic case.\n\nImplementation requirements:\n- Use the fundamental laws and definitions above only. Do not use pre-derived shortcut formulas for $Z(\\beta,h)$.\n- Your program must implement the TM computation for $Z(\\beta,h)$ and the enumeration-based computation for $P_N(y)$’s coefficients, then determine the complex roots of $P_N(y)$ and evaluate the maximum deviation of their magnitudes from $1$.\n\nTest suite:\nImplement your program to run the following four test cases. For each case, compute:\n- The value of $Z(\\beta,h)$ for the specified real $h$ using the TM method.\n- The maximum absolute deviation $\\Delta = \\max_j \\big|\\,|y_j| - 1\\,\\big|$ of the Lee-Yang zeros $y_j$ of $P_N(y)$ from the unit circle, computed from enumeration-based coefficients.\n\nProvide results for the following parameter sets $(N,\\beta,J,h)$:\n- Case A (boundary-size check): $(N,\\beta,J,h) = (2,\\, 0.5,\\, 1.0,\\, 0.2)$.\n- Case B (even $N$, moderate coupling): $(N,\\beta,J,h) = (4,\\, 0.5,\\, 1.0,\\, 0.2)$.\n- Case C (odd $N$, stronger coupling): $(N,\\beta,J,h) = (5,\\, 0.9,\\, 1.0,\\, -0.1)$.\n- Case D (larger even $N$, non-unit coupling, zero field): $(N,\\beta,J,h) = (8,\\, 1.2,\\, 0.7,\\, 0.0)$.\n\nFinal output specification:\n- For each case, produce a pair $[Z,\\Delta]$, where $Z$ is the TM-computed partition function value for the specified real $h$, and $\\Delta$ is the maximum absolute deviation of the Lee-Yang zero magnitudes from $1$ for that case’s $(N,\\beta,J)$.\n- Your program should produce a single line of output containing the four case results as a comma-separated list of these bracketed pairs, with no spaces, enclosed in square brackets. For example: \"[[Z_A,Delta_A],[Z_B,Delta_B],[Z_C,Delta_C],[Z_D,Delta_D]]\".",
            "solution": "The problem statement has been validated and is deemed sound. It is a well-posed, scientifically grounded problem from statistical mechanics that requests both theoretical derivations and their numerical implementation. No inconsistencies, ambiguities, or factual errors were found.\n\n### 1. Transfer Matrix Formulation for the Partition Function\n\nThe partition function, $Z(\\beta,h)$, for the one-dimensional Ising model on a ring of $N$ spins $\\{\\sigma_i\\}$ with periodic boundary conditions is defined as a sum over all $2^N$ spin configurations:\n$$\nZ(\\beta,h) = \\sum_{\\{\\sigma\\}} \\exp(-\\beta H)\n$$\nwhere $\\beta$ is the inverse temperature, $H$ is the Hamiltonian, and $\\{\\sigma\\}$ denotes the set of all spins $\\{\\sigma_1, \\sigma_2, \\dots, \\sigma_N\\}$. The Hamiltonian with nearest-neighbor ferromagnetic coupling $J>0$ and external magnetic field $h$ is given by:\n$$\nH(\\{\\sigma\\};J,h) = -J \\sum_{i=1}^{N} \\sigma_i \\sigma_{i+1} - h \\sum_{i=1}^{N} \\sigma_i\n$$\nThe periodic boundary condition implies $\\sigma_{N+1} \\equiv \\sigma_1$.\n\nThe Boltzmann factor, $\\exp(-\\beta H)$, can be written as:\n$$\n\\exp(-\\beta H) = \\exp\\left(\\beta J \\sum_{i=1}^{N} \\sigma_i \\sigma_{i+1} + \\beta h \\sum_{i=1}^{N} \\sigma_i\\right)\n$$\nTo construct the Transfer Matrix (TM), we express the total Boltzmann weight as a product of factors, each depending only on adjacent spins. Following the problem's instruction to split the magnetic field term evenly across adjacent bonds, we rewrite the total field-dependent term. The sum $\\sum_{i=1}^{N} \\sigma_i$ can be expressed due to periodic boundary conditions as $\\frac{1}{2}\\sum_{i=1}^{N}(\\sigma_i + \\sigma_{i+1})$. Thus, the term in the exponential becomes:\n$$\n\\sum_{i=1}^{N} \\left(\\beta J \\sigma_i \\sigma_{i+1} + \\frac{\\beta h}{2}(\\sigma_i + \\sigma_{i+1})\\right)\n$$\nThe partition function can then be written as a sum over a product:\n$$\nZ(\\beta,h) = \\sum_{\\sigma_1=\\pm 1}\\dots\\sum_{\\sigma_N=\\pm 1} \\prod_{i=1}^{N} \\exp\\left(\\beta J \\sigma_i \\sigma_{i+1} + \\frac{\\beta h}{2}(\\sigma_i + \\sigma_{i+1})\\right)\n$$\nWe define the elements of a $2 \\times 2$ Transfer Matrix $T$ as the contribution from a single bond between spin $\\sigma_i$ and $\\sigma_{i+1}$:\n$$\nT_{\\sigma_i, \\sigma_{i+1}} = \\exp\\left(\\beta J \\sigma_i \\sigma_{i+1} + \\frac{\\beta h}{2}(\\sigma_i + \\sigma_{i+1})\\right)\n$$\nThe indices of $T$ correspond to the spin states $\\sigma \\in \\{+1, -1\\}$. The matrix elements are:\n$T_{+1,+1} = \\exp(\\beta J(1)(1) + \\frac{\\beta h}{2}(1+1)) = \\exp(\\beta J + \\beta h)$\n$T_{+1,-1} = \\exp(\\beta J(1)(-1) + \\frac{\\beta h}{2}(1-1)) = \\exp(-\\beta J)$\n$T_{-1,+1} = \\exp(\\beta J(-1)(1) + \\frac{\\beta h}{2}(-1+1)) = \\exp(-\\beta J)$\n$T_{-1,-1} = \\exp(\\beta J(-1)(-1) + \\frac{\\beta h}{2}(-1-1)) = \\exp(\\beta J - \\beta h)$\n\nSo, the Transfer Matrix $T$ is:\n$$\nT = \\begin{pmatrix} e^{\\beta(J+h)} & e^{-\\beta J} \\\\ e^{-\\beta J} & e^{\\beta(J-h)} \\end{pmatrix}\n$$\nThe partition function sums over all intermediate spins, which corresponds to matrix multiplication:\n$$\nZ = \\sum_{\\sigma_1}\\dots\\sum_{\\sigma_N} T_{\\sigma_1, \\sigma_2} T_{\\sigma_2, \\sigma_3} \\dots T_{\\sigma_{N-1}, \\sigma_N} T_{\\sigma_N, \\sigma_1}\n$$\nPerforming the sums from $\\sigma_N$ down to $\\sigma_2$:\n$$\nZ = \\sum_{\\sigma_1} \\left( \\sum_{\\sigma_2} \\dots \\sum_{\\sigma_N} T_{\\sigma_1,\\sigma_2} \\dots T_{\\sigma_N,\\sigma_1} \\right) = \\sum_{\\sigma_1} (T^N)_{\\sigma_1, \\sigma_1}\n$$\nThis final sum is the definition of the trace of the matrix $T^N$:\n$$\nZ(\\beta,h) = \\mathrm{Tr}(T^N)\n$$\nTo evaluate this trace efficiently, we use the eigenvalues of $T$. Since $T$ is a real symmetric matrix, it is diagonalizable with real eigenvalues, let them be $\\lambda_1$ and $\\lambda_2$. The trace is invariant under cyclic permutations, so $\\mathrm{Tr}(T^N) = \\mathrm{Tr}(P D^N P^{-1}) = \\mathrm{Tr}(D^N)$, where $D$ is the diagonal matrix of eigenvalues.\n$$\nZ(\\beta,h) = \\lambda_1^N + \\lambda_2^N\n$$\nThis formula allows for efficient computation of $Z$ for large $N$ by first finding the two eigenvalues of the $2 \\times 2$ matrix $T$ and then raising them to the $N$-th power.\n\n### 2. Lee-Yang Zeros and the Polynomial Representation\n\nTo study the Lee-Yang zeros, we rewrite the partition function in terms of the activity $y = e^{-2 \\beta h}$.\nWe start by grouping configurations by their total magnetization, $M = \\sum_{i=1}^{N} \\sigma_i$.\n$$\nZ(\\beta,h) = \\sum_{\\{\\sigma\\}} \\exp\\left(\\beta J \\sum_{i=1}^N \\sigma_i \\sigma_{i+1}\\right) \\exp(\\beta h M)\n$$\n$$\nZ(\\beta,h) = \\sum_{M} \\left( \\sum_{\\{\\sigma\\}|\\sum \\sigma_i = M} \\exp\\left(\\beta J \\sum_{i=1}^N \\sigma_i \\sigma_{i+1}\\right) \\right) e^{\\beta h M}\n$$\nUsing the identity $e^{\\beta h M} = e^{\\beta h N} (e^{-2 \\beta h})^{(N-M)/2} = e^{\\beta h N} y^{(N-M)/2}$, we substitute this into the expression for $Z$:\n$$\nZ(\\beta,h) = e^{\\beta h N} \\sum_{M} y^{(N-M)/2} \\left( \\sum_{\\{\\sigma\\}|\\sum \\sigma_i = M} \\exp\\left(\\beta J \\sum_{i=1}^N \\sigma_i \\sigma_{i+1}\\right) \\right)\n$$\nLet's analyze the exponent of $y$. Let $N_+$ be the number of up spins ($+1$) and $N_-$ be the number of down spins ($-1$). Then $N=N_+ + N_-$ and $M=N_+ - N_-$. It follows that $N-M = (N_+ + N_-) - (N_+ - N_-) = 2N_-$. So, the exponent is $(N-M)/2 = N_-$. Let us define an integer variable $k = N_-$, which is the number of down spins. $k$ can range from $0$ to $N$. The sum over all possible magnetizations $M$ is equivalent to a sum over all possible values of $k$.\n\nWe define the coefficients $a_k(\\beta,J)$ as the sum of Boltzmann weights of the interaction term over all configurations with a fixed number of down spins, $k$:\n$$\na_k(\\beta,J) = \\sum_{\\{\\sigma\\} | N_-(\\{\\sigma\\})=k} \\exp\\left(\\beta J \\sum_{i=1}^N \\sigma_i \\sigma_{i+1}\\right)\n$$\nSubstituting this definition, the partition function takes the polynomial form:\n$$\nZ(\\beta,h) = e^{\\beta h N} \\sum_{k=0}^{N} a_k(\\beta,J)\\, y^k\n$$\nThe Lee-Yang zeros are the values in the complex plane for which the partition function vanishes, $Z(\\beta,h)=0$. In terms of the activity $y$, this corresponds to finding the complex roots of $Z$. The equation is:\n$$\ne^{\\beta h N} \\sum_{k=0}^{N} a_k(\\beta,J)\\, y^k = 0\n$$\nSince the exponential function $e^z$ is never zero for any finite complex argument $z = \\beta h N$, the condition $Z=0$ is equivalent to the polynomial part being zero:\n$$\nP_N(y) = \\sum_{k=0}^{N} a_k(\\beta,J)\\, y^k = 0\n$$\nTherefore, the Lee-Yang zeros in the $y$-plane are precisely the complex roots of this degree-$N$ polynomial whose coefficients $a_k$ depend only on $\\beta$ and $J$. The Lee-Yang Circle Theorem states that for ferromagnetic systems ($J>0$), all these roots lie on the unit circle, i.e., $|y_j|=1$.\n\n### 3. Algorithm Design\n\nThe numerical implementation involves two distinct calculations as required.\n\n**Part A: Computation of $Z(\\beta,h)$ via the Transfer Matrix**\nFor each parameter set $(N, \\beta, J, h)$:\n1.  Construct the $2 \\times 2$ transfer matrix $T$ using the given parameters:\n    $$\n    T = \\begin{pmatrix} e^{\\beta(J+h)} & e^{-\\beta J} \\\\ e^{-\\beta J} & e^{\\beta(J-h)} \\end{pmatrix}\n    $$\n2.  Numerically compute the two eigenvalues, $\\lambda_1$ and $\\lambda_2$, of this real symmetric matrix $T$.\n3.  Calculate the partition function as $Z = \\lambda_1^N + \\lambda_2^N$.\n\n**Part B: Computation of Lee-Yang Zeros and Deviation $\\Delta$**\nFor each parameter set $(N, \\beta, J, h)$:\n1.  Initialize an array of coefficients $a_k$ of size $N+1$ to zero.\n2.  Generate all $2^N$ spin configurations $\\{\\sigma_1, \\dots, \\sigma_N\\}$. An efficient method is to iterate an integer from $0$ to $2^N-1$ and use its binary representation to define the spin states (e.g., bit $0 \\to$ spin $-1$, bit $1 \\to$ spin $+1$).\n3.  For each configuration:\n    a. Count the number of down spins to find the index $k = N_-$.\n    b. Calculate the interaction energy term, $E_{int} = \\sum_{i=1}^{N} \\sigma_i \\sigma_{i+1}$, enforcing the periodic boundary condition $\\sigma_{N+1} = \\sigma_1$.\n    c. Add the corresponding Boltzmann weight to the coefficient: $a_k \\leftarrow a_k + \\exp(\\beta J E_{int})$.\n4.  Once all configurations are processed, the array of coefficients for the polynomial $P_N(y)$ is complete.\n5.  Use a numerical root-finding algorithm to find all $N$ complex roots, $\\{y_j\\}$, of the polynomial $P_N(y) = \\sum_{k=0}^{N} a_k y^k$.\n6.  For each root $y_j$, compute the absolute value of its modulus, $|y_j|$.\n7.  Calculate the maximum absolute deviation of these moduli from unity:\n    $$\n    \\Delta = \\max_j \\big|\\,|y_j| - 1\\,\\big|\n    $$\nThis value $\\Delta$ serves as a numerical verification of the Lee-Yang Circle Theorem. For a ferromagnetic system, $\\Delta$ is expected to be close to machine precision zero.\nThe final output for each test case is the pair $[Z, \\Delta]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D Ising model problem for the given test cases.\n\n    For each case, it computes:\n    1. The partition function Z using the Transfer Matrix (TM) method.\n    2. The maximum absolute deviation Delta of Lee-Yang zero moduli from 1,\n       calculated from the roots of a polynomial whose coefficients are\n       found by enumerating all spin configurations.\n    \"\"\"\n    \n    # Test cases: (N, beta, J, h)\n    test_cases = [\n        (2, 0.5, 1.0, 0.2),   # Case A\n        (4, 0.5, 1.0, 0.2),   # Case B\n        (5, 0.9, 1.0, -0.1),  # Case C\n        (8, 1.2, 0.7, 0.0),   # Case D\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, beta, J, h = case\n        \n        # --- Task 1: Compute Z via Transfer Matrix method ---\n        # The Transfer Matrix T is given by:\n        # T = [[exp(beta*(J+h)), exp(-beta*J)],\n        #      [exp(-beta*J),   exp(beta*(J-h))]]\n        \n        T_11 = np.exp(beta * (J + h))\n        T_12 = np.exp(-beta * J)\n        T_22 = np.exp(beta * (J - h))\n        \n        # Matrix is real and symmetric\n        T = np.array([[T_11, T_12], [T_12, T_22]])\n        \n        # Eigenvalues of T. Use eigvalsh for Hermitian (or real symmetric) matrices.\n        eigenvalues = np.linalg.eigvalsh(T)\n        \n        # Z = lambda_1^N + lambda_2^N\n        Z = np.sum(eigenvalues**N)\n        \n        # --- Task 2: Compute polynomial coefficients and Lee-Yang zeros ---\n        # The coefficients a_k of the polynomial P_N(y) are computed by\n        # direct enumeration of all 2^N spin configurations.\n        \n        # a_coeffs[k] will store the coefficient a_k\n        a_coeffs = np.zeros(N + 1, dtype=np.float64)\n        \n        # Iterate through all 2^N configurations using an integer counter\n        for i in range(2**N):\n            spins = np.zeros(N, dtype=int)\n            num_down_spins = 0\n            \n            # Generate spin configuration from the binary representation of i\n            # Map bit 0 -> spin -1, bit 1 -> spin +1\n            for j in range(N):\n                if (i >> j)  1:\n                    spins[j] = 1\n                else:\n                    spins[j] = -1\n                    num_down_spins += 1\n            \n            # The index k for coefficient a_k is the number of down spins\n            k = num_down_spins\n\n            # Calculate the interaction term sum(sigma_i * sigma_{i+1})\n            # np.roll provides an easy way to handle periodic boundary conditions\n            interaction_energy_term = np.sum(spins * np.roll(spins, -1))\n            \n            # Add the Boltzmann factor to the corresponding coefficient\n            a_coeffs[k] += np.exp(beta * J * interaction_energy_term)\n\n        # The polynomial is P_N(y) = sum_{k=0 to N} a_k * y^k.\n        # np.roots expects coefficients in order of decreasing powers,\n        # so we reverse the a_coeffs array.\n        poly_roots = np.roots(a_coeffs[::-1])\n        \n        # --- Task 3: Calculate the maximum deviation of root moduli from 1 ---\n        # For ferromagnetic systems (J>0), Lee-Yang theorem states the roots\n        # lie on the unit circle in the complex y-plane.\n        \n        moduli = np.abs(poly_roots)\n        deviations = np.abs(moduli - 1)\n        Delta = np.max(deviations)\n        \n        results.append(f\"[{Z},{Delta}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}