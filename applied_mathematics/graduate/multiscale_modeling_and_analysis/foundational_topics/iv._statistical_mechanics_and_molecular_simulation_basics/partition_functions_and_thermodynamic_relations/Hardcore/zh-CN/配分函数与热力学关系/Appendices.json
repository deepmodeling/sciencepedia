{
    "hands_on_practices": [
        {
            "introduction": "配分函数是连接微观量子态和宏观热力学性质的桥梁。为了打下坚实的基础，我们的第一个实践从最基本的定义出发，阐明对于一个具有离散能谱的系统，如何通过对微观状态进行计数来构建其配分函数。这项练习将微正则系综中基于能量的态密度 $\\Omega(E)$ 与正则系综中的配分函数 $Z(\\beta)$ 直接联系起来，并突显了能级简并度在统计求和中的关键作用 。",
            "id": "3792672",
            "problem": "考虑一个有限量子系统，其哈密顿量 $\\hat{H}$ 作用于一个有限维希尔伯特空间。$\\hat{H}$ 的能谱由一组有限的、离散的能量值 $\\{E_i\\}_{i=1}^{M}$ 构成，其中每个 $E_i$ 都具有有限的简并度 $g_i \\in \\mathbb{N}$，该简并度计算了能量为 $E_i$ 的正交归一的本征态的数量。令 $\\beta$ 表示正则系综中的逆温度。从多尺度建模的角度来看，可以将固定能量下的微观态集合视为一个细尺度流形，该流形被粗粒化为一个由 $E_i$ 标记的单一宏观态，其中微观态的多重性由简并度 $g_i$ 所表征。\n\n从微正则系综的计数诠释和正则系综的定义出发，完成以下任务，不要假设任何预先指定的、关联态密度与配分函数关系的公式：\n\n- 将微正则态密度 $\\Omega(E)$ 表示为一个广义函数，该函数计算能量为 $E$ 时的微观态数量，用支撑在离散能量 $\\{E_i\\}$ 上的狄拉克δ分布来表示，并明确解释简并度因子 $\\{g_i\\}$ 如何进入此表达式。\n\n- 使用正则系综的定义，推导正则配分函数 $Z(\\beta)$ 的一个显式表达式，该表达式只用离散能量集合 $\\{E_i\\}$ 及其简并度 $\\{g_i\\}$ 表示，且不含任何积分。\n\n请仅用 $\\{E_i\\}$、$\\{g_i\\}$ 和 $\\beta$ 给出一个 $Z(\\beta)$ 的单封闭形式解析表达式作为最终答案。不要包含单位。如果引入任何额外的符号，请明确定义。最终答案必须是单个表达式。",
            "solution": "该问题要求对一个在统计力学框架下描述的有限量子系统进行两个相关的推导。该系统有一组离散的能量本征值 $\\{E_i\\}_{i=1}^{M}$，以及相应的有限简并度 $\\{g_i\\}_{i=1}^{M}$。我们的任务是表示微正则态密度 $\\Omega(E)$ 并推导正则配分函数 $Z(\\beta)$。\n\n首先，我们解决微正则态密度 $\\Omega(E)$ 的表示问题。函数 $\\Omega(E)$ 量化了能量 $E$ 处单位能量间隔内的微观态数量。对于具有离散能谱的量子系统，在允许的能量本征值 $E_i$ 之间不存在任何可用的量子态。这些量子态只精确地存在于这些离散的能量值上。在特定能量 $E_i$ 处的量子态数目由其简并度 $g_i$ 给出。\n\n为了在数学上表示这种结构，我们使用狄拉克δ分布 $\\delta(x)$。狄拉克δ函数是一个广义函数，其性质为：对于所有 $x \\neq a$，有 $\\delta(x-a) = 0$；并且对于在 $x=a$ 处连续的函数 $f(x)$，其积分满足 $\\int f(x) \\delta(x-a) dx = f(a)$。一个加权的δ函数 $c \\cdot \\delta(x-a)$ 表示一个位于 $x=a$ 处、大小为 $c$ 的“点质量”。\n\n在我们的情境中，能量 $E$ 是变量。对于每个允许的能级 $E_i$，存在一个由 $g_i$ 个态构成的“集中”。我们可以用一个以 $E_i$ 为中心、权重为简并度 $g_i$ 的狄拉克δ函数来表示这种集中。因此，能级 $E_i$ 对态密度的贡献是 $g_i \\delta(E - E_i)$。由于总态密度是所有可能能级贡献的总和，我们必须对所有离散的能量本征值 $E_i$ 进行求和。这给出了微正则态密度作为广义函数之和的表示：\n$$\n\\Omega(E) = \\sum_{i=1}^{M} g_i \\delta(E - E_i)\n$$\n这个表达式正确地捕捉了能谱的离散性质。在任意能量区间 $[E_a, E_b]$ 内的量子态数目 $N(E_a, E_b)$ 由 $\\Omega(E)$ 在该区间上的积分给出。如果区间 $[E_a, E_b]$ 只包含一个能级 $E_k$，那么 $\\int_{E_a}^{E_b} \\Omega(E) dE = \\int_{E_a}^{E_b} \\sum_{i=1}^{M} g_i \\delta(E - E_i) dE = g_k$，这是正确的量子态计数。\n\n接下来，我们推导正则配分函数 $Z(\\beta)$。正则配分函数的定义是对系统的所有可及微观态 $s$ 的玻尔兹曼因子 $\\exp(-\\beta E_s)$ 进行求和。令所有微观态的集合表示为 $\\mathcal{S}$。一个微观态 $s$ 的能量是 $E_s$。其定义为：\n$$\nZ(\\beta) = \\sum_{s \\in \\mathcal{S}} \\exp(-\\beta E_s)\n$$\n问题指出，该系统有一组有限的、离散的能量值 $\\{E_i\\}_{i=1}^{M}$，并且对于每个能量值 $E_i$，都有 $g_i$ 个正交归一的本征态。这 $g_i$ 个态是共享相同能量 $E_i$ 的微观态。我们可以将总微观态集合 $\\mathcal{S}$ 划分为 $M$ 个不相交的子集，其中第 $i$ 个子集 $\\mathcal{S}_i$ 包含所有能量为 $E_i$ 的微观态。集合 $\\mathcal{S}_i$ 的大小就是简并度 $g_i$。\n\n通过这种划分，对所有态的求和可以重写为先对能级求和，再对每个能级内的简并态求和：\n$$\nZ(\\beta) = \\sum_{i=1}^{M} \\sum_{s \\in \\mathcal{S}_i} \\exp(-\\beta E_s)\n$$\n对于子集 $\\mathcal{S}_i$ 中的任何微观态 $s$，其能量 $E_s$ 根据定义等于 $E_i$。因此，对于内部求和中的所有态，玻尔兹曼因子 $\\exp(-\\beta E_s)$ 是一个常数，等于 $\\exp(-\\beta E_i)$。我们可以将此项从内部求和中提出来：\n$$\nZ(\\beta) = \\sum_{i=1}^{M} \\left( \\exp(-\\beta E_i) \\sum_{s \\in \\mathcal{S}_i} 1 \\right)\n$$\n剩下的内部求和 $\\sum_{s \\in \\mathcal{S}_i} 1$ 只是计算子集 $\\mathcal{S}_i$ 中的态的数量。这个数量就是能级 $E_i$ 的简并度，即 $g_i$。\n$$\n\\sum_{s \\in \\mathcal{S}_i} 1 = g_i\n$$\n将此结果代回到 $Z(\\beta)$ 的表达式中，我们得到该系统正则配分函数的最终形式：\n$$\nZ(\\beta) = \\sum_{i=1}^{M} g_i \\exp(-\\beta E_i)\n$$\n此表达式完全用系统能谱的基本性质——即离散的能量值 $\\{E_i\\}$ 及其对应的简并度 $\\{g_i\\}$——来给出配分函数。此推导从正则系综的第一性原理出发，没有假设任何先前的积分关系。",
            "answer": "$$\n\\boxed{\\sum_{i=1}^{M} g_i \\exp(-\\beta E_i)}\n$$"
        },
        {
            "introduction": "在掌握了基本定义之后，我们将配分函数的概念应用于具体的分子体系。这项实践探讨了分子的微观对称性——一种特殊形式的简并——如何对熵和化学平衡常数等宏观热力学性质产生直接且可量化的影响。这个例子是计算化学中的一个重要课题，它表明了精确的状态计数不仅是理论上的严谨要求，更是获得准确预测的实践必需 。",
            "id": "3891065",
            "problem": "一个计算催化小组正在构建一个理想气体热化学模块，用于为微观动力学模型提供数据。该模块通过在刚性转子和简谐振子近似下，将内部分子自由度分解为平动、转动和振动来计算分子的正则配分函数。考虑刚性转子的转动贡献和不可区分性原理：通过正常旋转将分子映射到其自身而连接的取向代表相同的微观状态，决不能被重复计数。\n\n从配分函数和亥姆霍兹自由能的正则定义出发，$Q=\\sum_{\\alpha}\\exp(-\\beta E_{\\alpha})$，$A=-k_{\\mathrm{B}}T\\ln Q$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\beta=1/(k_{\\mathrm{B}}T)$ 是逆温度，$T$ 是温度。使用熵和平衡常数的热力学定义，$S=-(\\partial A/\\partial T)_{V}$ 和 $K^{\\circ}=\\exp(-\\Delta G^{\\circ}/(RT))$，其中 $\\Delta G^{\\circ}$ 是标准态吉布斯自由能变化，$G=A+pV$，$p$ 是压力，$V$ 是体积，$R$ 是理想气体常数。在理想气体极限下进行计算，并假设刚性转子描述在许多转动态被布居的高温区是有效的。在转动对称性考虑之外，忽略核自旋统计。\n\n你需要确定转动对称数 $\\sigma$ 在单分子转动配分函数 $q_{\\mathrm{rot}}$ 中的定量作用，并证明省略 $\\sigma$ 会如何对计算出的摩尔熵和标准态平衡常数产生偏差。\n\n关注一个同核双原子分子及其解离平衡\n$$\n\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)\n$$\n在 $T=1000\\,\\mathrm{K}$ 和 $p^{\\circ}=1\\,\\mathrm{bar}$ 的条件下。对于 $\\mathrm{N}_{2}$，取其转动对称数为 $\\sigma=2$，并注意原子 $\\mathrm{N}$ 没有转动自由度。为了分离对称性效应，比较两个其他方面完全相同但仅在 $q_{\\mathrm{rot}}$ 中是否包含转动对称性除法（“正确”模型）或省略它（“省略-$\\sigma$”模型）方面有所不同的模型。假设这两个模型之间所有非转动贡献都相同，因此 $S$ 和 $K^{\\circ}$ 的任何差异都仅由转动对称性计数引起。\n\n在这些条件下，哪个选项正确地陈述了 (i) 因省略 $\\sigma$ 而引入的 $\\mathrm{N}_{2}$ 摩尔转动熵的偏差（大小和符号），以及 (ii) 在预测的解离反应标准态平衡常数中由此产生的乘法偏差因子 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}$？\n\nA. 省略 $\\sigma$ 会重复计算转动微观状态，使摩尔转动熵增加 $+R\\ln\\sigma$；对于 $\\mathrm{N}_{2}$，$+R\\ln 2\\approx 5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。对于 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$，这会使 $K^{\\circ}$ 减小为原来的 $1/2$，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=1/2$。\n\nB. 省略 $\\sigma$ 会漏算转动微观状态，使摩尔转动熵减少 $-R\\ln\\sigma$；对于 $\\mathrm{N}_{2}$，$-R\\ln 2\\approx -5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。对于 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$，这会使 $K^{\\circ}$ 增大为原来的 $2$ 倍，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=2$。\n\nC. 省略 $\\sigma$ 会使摩尔转动熵改变 $+\\tfrac{1}{2}R\\ln\\sigma$；对于 $\\mathrm{N}_{2}$，$+\\tfrac{1}{2}R\\ln 2\\approx 2.88\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。$K^{\\circ}$ 的偏差为 $\\sqrt{2}$，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=\\sqrt{2}$。\n\nD. 省略 $\\sigma$ 只影响熵，使其增加 $+R\\ln\\sigma$；对于 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$，平衡常数不变，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=1$。\n\nE. 在高温下，省略 $\\sigma$ 不会改变摩尔转动熵，但会使 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$ 的平衡常数加倍，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=2$。",
            "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据，问题提出得当且客观，提供了足够的信息来推导出唯一的解，且没有内部矛盾。\n\n任务是确定因省略转动对称数 $\\sigma$ 而在 $\\mathrm{N}_{2}$ 的摩尔熵及其解离平衡常数 $K^{\\circ}$ 中引入的定量误差。\n\n让我们从所提供的第一性原理出发进行严格的推导。\n\n**1. 对转动配分函数和摩尔熵的影响**\n\n单分子配分函数 $q$ 可分解为来自不同自由度的贡献。我们关心的是转动贡献 $q_{\\mathrm{rot}}$。对于像 $\\mathrm{N}_{2}$ 这样的线性刚性转子，在高温极限下，经典转动配分函数与温度 $T$ 成正比。为了考虑对称分子的取向不可区分性，这个经典结果必须除以转动对称数 $\\sigma$。\n\n$\\mathrm{N}_{2}$ 的正确单分子转动配分函数是：\n$$\nq_{\\mathrm{rot, correct}} = \\frac{q'_{\\mathrm{rot}}}{\\sigma}\n$$\n其中 $q'_{\\mathrm{rot}}$ 是没有对称性校正的转动配分函数，对于 $\\mathrm{N}_{2}$，$\\sigma=2$。“省略-$\\sigma$”模型使用：\n$$\nq_{\\mathrm{rot, omitted}} = q'_{\\mathrm{rot}}\n$$\n因此，两者之间的关系是：\n$$\nq_{\\mathrm{rot, omitted}} = \\sigma \\cdot q_{\\mathrm{rot, correct}}\n$$\n亥姆霍兹自由能 $A$ 通过 $A = -k_{\\mathrm{B}}T\\ln Q$ 与正则配分函数 $Q$ 相关联。对于 $1$ 摩尔理想气体（$N=N_A$ 个粒子），在使用斯特林近似后，摩尔亥姆霍兹能量 $A_{\\text{m}}$ 通过 $A_{\\text{m}} = -RT\\ln(q/N_A) - RT$ 与单分子配分函数 $q$ 相关联。分离出转动贡献，摩尔转动亥姆霍兹能量为：\n$$\nA_{\\mathrm{m, rot}} = -RT \\ln q_{\\mathrm{rot}}\n$$\n摩尔熵 $S_{\\text{m}}$ 由热力学关系 $S_{\\text{m}} = -(\\partial A_{\\text{m}} / \\partial T)_{V}$ 给出。因此，摩尔转动熵为：\n$$\nS_{\\mathrm{m, rot}} = -\\frac{\\partial A_{\\mathrm{m, rot}}}{\\partial T} = -\\frac{\\partial}{\\partial T}(-RT \\ln q_{\\mathrm{rot}}) = R \\ln q_{\\mathrm{rot}} + RT \\frac{\\partial \\ln q_{\\mathrm{rot}}}{\\partial T}\n$$\n在线性转子的高温极限下，$q'_{\\mathrm{rot}} = 8\\pi^2 I k_B T / h^2$，这意味着 $q_{\\mathrm{rot}}$ 与 $T$ 成正比。设 $q_{\\mathrm{rot}} = C \\cdot T$，其中 $C$ 是一个常数。那么 $\\ln q_{\\mathrm{rot}} = \\ln C + \\ln T$。其导数为 $\\partial (\\ln q_{\\mathrm{rot}}) / \\partial T = 1/T$。\n将此代回，我们得到：\n$$\nS_{\\mathrm{m, rot}} = R \\ln q_{\\mathrm{rot}} + RT\\left(\\frac{1}{T}\\right) = R(\\ln q_{\\mathrm{rot}} + 1)\n$$\n我们现在可以计算摩尔转动熵的偏差 $\\Delta S_{\\mathrm{m, rot}}$，即“省略-$\\sigma$”模型的值减去“正确”模型的值：\n$$\n\\Delta S_{\\mathrm{m, rot}} = S_{\\mathrm{m, rot, omitted}} - S_{\\mathrm{m, rot, correct}} = R(\\ln q_{\\mathrm{rot, omitted}} + 1) - R(\\ln q_{\\mathrm{rot, correct}} + 1)\n$$\n$$\n\\Delta S_{\\mathrm{m, rot}} = R(\\ln q_{\\mathrm{rot, omitted}} - \\ln q_{\\mathrm{rot, correct}}) = R \\ln\\left(\\frac{q_{\\mathrm{rot, omitted}}}{q_{\\mathrm{rot, correct}}}\\right)\n$$\n使用关系 $q_{\\mathrm{rot, omitted}} = \\sigma \\cdot q_{\\mathrm{rot, correct}}$，我们发现：\n$$\n\\Delta S_{\\mathrm{m, rot}} = R \\ln \\sigma\n$$\n这个结果表明，省略对称数 $\\sigma$ 会导致对摩尔熵的高估。对于 $\\mathrm{N}_{2}$，$\\sigma=2$。偏差为：\n$$\n\\Delta S_{\\mathrm{m, rot}} = R \\ln 2 \\approx (8.3145\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (0.6931) \\approx +5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\n$$\n省略 $\\sigma$ 会夸大可及的转动微观状态数，从而人为地增加了计算出的熵。\n\n**2. 对标准态平衡常数的影响**\n\n标准态平衡常数 $K^{\\circ}$ 由 $K^{\\circ} = \\exp(-\\Delta G^{\\circ}/(RT))$ 给出，其中 $\\Delta G^{\\circ}$ 是反应的标准态吉布斯自由能变化。对于反应 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$，这个值为：\n$$\n\\Delta G^{\\circ} = 2G^{\\circ}_{\\mathrm{m,N}} - G^{\\circ}_{\\mathrm{m,N}_{2}}\n$$\n吉布斯自由能定义为 $G = A + pV = U - TS + pV$。对于理想气体，$G_{\\text{m}} = U_{\\text{m}} - TS_{\\text{m}} + RT = H_{\\text{m}} - TS_{\\text{m}}$。\n“省略-$\\sigma$”模型仅通过熵项在 $G^{\\circ}_{\\mathrm{m}}$ 中引入偏差。焓 $H_{\\text{m}}$ 不受 $\\sigma$ 的影响，因为转动内能 $U_{\\mathrm{m, rot}} = RT^2 \\frac{\\partial \\ln q_{\\mathrm{rot}}}{\\partial T} = RT$，它与 $\\sigma$ 无关。所有其他贡献均假设相同。\n物种 $j$ 的标准摩尔吉布斯自由能的偏差 $\\delta(G^{\\circ}_{\\mathrm{m},j})$ 为：\n$$\n\\delta(G^{\\circ}_{\\mathrm{m},j}) = G^{\\circ}_{\\mathrm{m},j, \\text{omitted}} - G^{\\circ}_{\\mathrm{m},j, \\text{correct}} = (H^{\\circ}_{\\mathrm{m},j} - T S^{\\circ}_{\\mathrm{m},j, \\text{omitted}}) - (H^{\\circ}_{\\mathrm{m},j} - T S^{\\circ}_{\\mathrm{m},j, \\text{correct}})\n$$\n$$\n\\delta(G^{\\circ}_{\\mathrm{m},j}) = -T (S^{\\circ}_{\\mathrm{m},j, \\text{omitted}} - S^{\\circ}_{\\mathrm{m},j, \\text{correct}}) = -T \\Delta S^{\\circ}_{\\mathrm{m},j}\n$$\n对于 $\\mathrm{N}_{2}$，我们发现 $\\Delta S^{\\circ}_{\\mathrm{m,N}_{2}} = R \\ln \\sigma$。因此：\n$$\n\\delta(G^{\\circ}_{\\mathrm{m,N}_{2}}) = -T(R \\ln \\sigma)\n$$\n对于氮原子 ($\\mathrm{N}$)，没有转动自由度，因此 $\\sigma$ 没有定义或实际上为 $1$。无论哪种情况，转动配分函数都不受影响，因此 $\\Delta S^{\\circ}_{\\mathrm{m,N}} = 0$ 且 $\\delta(G^{\\circ}_{\\mathrm{m,N}}) = 0$。\n\n现在，我们求出反应的吉布斯自由能变化的偏差 $\\delta(\\Delta G^{\\circ})$：\n$$\n\\delta(\\Delta G^{\\circ}) = \\Delta G^{\\circ}_{\\text{omitted}} - \\Delta G^{\\circ}_{\\text{correct}} = (2\\delta(G^{\\circ}_{\\mathrm{m,N}})) - (\\delta(G^{\\circ}_{\\mathrm{m,N}_{2}}))\n$$\n$$\n\\delta(\\Delta G^{\\circ}) = 2(0) - (-T R \\ln \\sigma) = +RT \\ln \\sigma\n$$\n有偏差的平衡常数与正确平衡常数的比值为：\n$$\n\\frac{K^{\\circ}_{\\text{omitted-}\\sigma}}{K^{\\circ}_{\\text{correct}}} = \\frac{\\exp(-\\Delta G^{\\circ}_{\\text{omitted}}/(RT))}{\\exp(-\\Delta G^{\\circ}_{\\text{correct}}/(RT))} = \\exp\\left(-\\frac{\\Delta G^{\\circ}_{\\text{omitted}} - \\Delta G^{\\circ}_{\\text{correct}}}{RT}\\right) = \\exp\\left(-\\frac{\\delta(\\Delta G^{\\circ})}{RT}\\right)\n$$\n代入 $\\delta(\\Delta G^{\\circ})$ 的表达式：\n$$\n\\frac{K^{\\circ}_{\\text{omitted-}\\sigma}}{K^{\\circ}_{\\text{correct}}} = \\exp\\left(-\\frac{RT \\ln \\sigma}{RT}\\right) = \\exp(-\\ln \\sigma) = \\frac{1}{\\sigma}\n$$\n对于 $\\mathrm{N}_{2}$ 的解离，其中 $\\sigma=2$，乘法偏差因子为 $1/2$。省略反应物 $\\mathrm{N}_{2}$ 的 $\\sigma$ 会增加其熵，使其吉布斯自由能更负（更稳定）。这将使平衡向反应物方向移动，从而减小解离反应的平衡常数。\n\n**结果总结：**\n-   $\\mathrm{N}_{2}$ 的摩尔转动熵偏差：$\\Delta S_{\\mathrm{m, rot}} = +R \\ln 2 \\approx +5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n-   平衡常数中的乘法偏差：$K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}} = 1/2$。\n\n**选项评估：**\n\n**A.** 省略 $\\sigma$ 会重复计算转动微观状态，使摩尔转动熵增加 $+R\\ln\\sigma$；对于 $\\mathrm{N}_{2}$，$+R\\ln 2\\approx 5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。对于 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$，这会使 $K^{\\circ}$ 减小为原来的 $1/2$，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=1/2$。\n-   **理由**：该陈述与我们推导出的熵偏差 ($+R\\ln 2$) 和平衡常数偏差因子 ($1/2$) 的结果完全匹配。\n-   **结论**：**正确**。\n\n**B.** 省略 $\\sigma$ 会漏算转动微观状态，使摩尔转动熵减少 $-R\\ln\\sigma$；对于 $\\mathrm{N}_{2}$，$-R\\ln 2\\approx -5.76\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。对于 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$，这会使 $K^{\\circ}$ 增大为原来的 $2$ 倍，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=2$。\n-   **理由**：这是不正确的。省略除以 $\\sigma$ 是重复计数，而不是漏算，因此熵偏差为正。因此，平衡常数比率为 $1/\\sigma = 1/2$，而不是 $2$。\n-   **结论**：**不正确**。\n\n**C.** 省略 $\\sigma$ 会使摩尔转动熵改变 $+\\tfrac{1}{2}R\\ln\\sigma$；对于 $\\mathrm{N}_{2}$，$+\\tfrac{1}{2}R\\ln 2\\approx 2.88\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。$K^{\\circ}$ 的偏差为 $\\sqrt{2}$，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=\\sqrt{2}$。\n-   **理由**：这是不正确的。熵偏差中的因子是 $R$，而不是 $\\tfrac{1}{2}R$。$K^{\\circ}$ 的偏差因子是 $1/\\sigma$，而不是 $1/\\sqrt{\\sigma}$。\n-   **结论**：**不正确**。\n\n**D.** 省略 $\\sigma$ 只影响熵，使其增加 $+R\\ln\\sigma$；对于 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$，平衡常数不变，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=1$。\n-   **理由**：这是不正确的。虽然关于熵偏差的部分是正确的，但声称平衡常数不变是矛盾的。平衡常数取决于吉布斯自由能，而吉布斯自由能又取决于熵 ($G=H-TS$)。熵的变化必然会传递到 $K^{\\circ}$ 的变化。\n-   **结论**：**不正确**。\n\n**E.** 在高温下，省略 $\\sigma$ 不会改变摩尔转动熵，但会使 $\\mathrm{N}_{2}(g)\\rightleftharpoons 2\\,\\mathrm{N}(g)$ 的平衡常数加倍，即 $K^{\\circ}_{\\text{omitted-}\\sigma}/K^{\\circ}_{\\text{correct}}=2$。\n-   **理由**：这是不正确的。在高温区，熵偏差 $R\\ln\\sigma$ 是一个非零常数。平衡常数比率为 $1/2$，而不是 $2$。\n-   **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "最后，我们从解析计算过渡到一个完整的计算问题，将微观作用力与宏观行为联系起来。这项练习演示了如何直接从分子间相互作用势计算第二维里系数 $B_2(T)$，这是描述真实气体状态方程的关键参数。它是多尺度建模的一个经典范例，通过配分函数理论和数值积分，成功地将原子尺度（Lennard-Jones势）与宏观尺度（热力学性质）连接起来 。",
            "id": "3792638",
            "problem": "考虑一种稀薄经典气体，其由全同粒子组成，通过在原子尺度上具有代表性的对可加各向同性势相互作用，其宏观压缩因子由维里展开确定。在多尺度建模与分析中，通过将第二维里系数与从正则配分函数构建的位形积分相关联，从而架起从微观相互作用势到宏观物态方程的桥梁。从正则配分函数和维里展开出发，推导将第二维里系数 $B_2(T)$ 与各向同性系统的微观对相互作用联系起来的积分表达式，然后实现一个数值积分方法来对 Lennard-Jones (LJ) 势计算该积分。Lennard-Jones (LJ) 势定义为 $u(r)=4\\,\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^{6}\\right]$，其中 $\\epsilon$ 是能量尺度，$\\sigma$ 是长度尺度。\n\n您必须从以下基本依据出发：\n- N 个经典粒子的正则配分函数及其通过统计平均与热力学可观测量的关系。\n- 稀薄气体压缩因子 $Z$ 的维里展开，其中第二维里系数用位形积分量化了对理想气体行为的主导修正。\n- 由对势和 Boltzmann 权重定义的 Mayer 函数，及其在将三维各向同性相互作用的 $B_2(T)$ 表示为关于相对距离的积分中的作用。\n\n在推导出积分表达式后，使用约化温度 $T^* = k_B T / \\epsilon$ 和约化距离 $r^* = r / \\sigma$ 对您的公式进行无量纲化，其中 $k_B$ 是 Boltzmann 常数。实现一个适用于 $r^* \\in [0,\\infty)$ 上反常积分的稳健数值积分方案，并用它来计算约化第二维里系数 $B_2^*(T^*) = B_2(T) / \\sigma^3$。通过估算 $B_2^*(T_B^*) = 0$ 时的约化 Boyle 温度 $T_B^*$，来分析 $B_2^*(T^*)$ 随温度的符号变化。\n\n物理和数值单位：所有 $B_2^*(T^*)$ 的值均以 $\\sigma^3$ 为单位报告（即，$B_2(T)$ 除以 $\\sigma^3$ 是无量纲的）。本问题不涉及角度。所有温度均使用上文定义的约化温度 $T^*$ 表示。将所有报告的浮点数四舍五入到 6 位小数。\n\n测试集和输出规范：\n- 使用以下约化温度 $T^*$ 测试集：$\\{\\,0.5,\\,1.0,\\,3.0,\\,3.5,\\,10.0\\,\\}$。\n- 对于测试集中的每个 $T^*$，通过您的数值积分方法计算 $B_2^*(T^*)$。\n- 通过在一个足够大的 $T^*$ 区间上对 $B_2^*(T^*)$ 进行区间划定和二分法来估算约化 Boyle 温度 $T_B^*$，返回一个四舍五入到 6 位小数的浮点数。\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，条目按 $[B_2^*(0.5),B_2^*(1.0),B_2^*(3.0),B_2^*(3.5),B_2^*(10.0),T_B^*]$ 的顺序列出。\n\n通过在 $r^*=0$ 附近和 $r^*\\to\\infty$ 时对被积函数进行数值上稳定的处理，并提供一个有原则的区间划定策略来定位 $B_2^*(T^*)$ 的符号变化，以确保科学真实性。",
            "solution": "该问题要求从统计力学的基本原理出发，推导第二维里系数 $B_2(T)$ 的积分表达式，并随后对 Lennard-Jones 势进行数值计算。\n\n出发点是温度为 $T$、体积为 $V$ 的系统中 $N$ 个全同、经典、无相互作用粒子的正则配分函数 $Q_N$：\n$$Q_N = \\frac{1}{N! h^{3N}} \\int e^{-\\beta H(\\mathbf{p}^N, \\mathbf{r}^N)} d\\mathbf{p}^N d\\mathbf{r}^N$$\n其中 $\\beta = 1 / (k_B T)$，$h$ 是 Planck 常数，$H(\\mathbf{p}^N, \\mathbf{r}^N)$ 是经典哈密顿量。哈密顿量是动能 $K(\\mathbf{p}^N)$ 和势能 $U(\\mathbf{r}^N)$ 的和。动量积分可以独立进行，得到热 de Broglie 波长 $\\Lambda = h / \\sqrt{2\\pi m k_B T}$。配分函数变为：\n$$Q_N = \\frac{1}{N! \\Lambda^{3N}} Z_N$$\n其中 $Z_N$ 是位形积分：\n$$Z_N = \\int_V \\dots \\int_V e^{-\\beta U(\\mathbf{r}^N)} d\\mathbf{r}^N$$\n对于对可加势，$U(\\mathbf{r}^N) = \\sum_{1 \\le i  j \\le N} u(r_{ij})$，其中 $u(r_{ij})$ 是粒子 $i$ 和 $j$ 之间的对势，两者相距 $r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j|$。\n\n压强 $P$ 从 Helmholtz 自由能 $A = -k_B T \\ln Q_N$ 得到，即 $P = -(\\partial A / \\partial V)_{T,N} = k_B T (\\partial \\ln Q_N / \\partial V)_{T,N}$。由于只有 $Z_N$ 依赖于体积，这可以简化为 $P = k_B T (\\partial \\ln Z_N / \\partial V)_{T,N}$。压缩因子定义为 $Z = PV/(Nk_B T)$。维里展开将 $Z$ 表示为数密度 $\\rho = N/V$ 的幂级数：\n$$Z = 1 + B_2(T) \\rho + B_3(T) \\rho^2 + \\dots$$\n为了求得 $B_2(T)$，我们使用 $Z_N$ 的集团展开。我们引入 Mayer 函数 $f_{ij} = e^{-\\beta u(r_{ij})} - 1$。$Z_N$ 的被积函数可以写为：\n$$e^{-\\beta U(\\mathbf{r}^N)} = \\prod_{1 \\le i  j \\le N} e^{-\\beta u(r_{ij})} = \\prod_{1 \\le i  j \\le N} (1 + f_{ij})$$\n对于稀薄气体，我们展开此乘积并保留主导项：\n$$Z_N = \\int_V \\dots \\int_V \\left(1 + \\sum_{1 \\le i  j \\le N} f_{ij} + \\dots\\right) d\\mathbf{r}^N$$\n第一项给出 $\\int d\\mathbf{r}^N = V^N$。第二项包含 $\\binom{N}{2}$ 个相同积分的和。我们考虑含有 $f_{12}$ 的项：\n$$\\int_V \\dots \\int_V f_{12} d\\mathbf{r}_1 \\dots d\\mathbf{r}_N = V^{N-2} \\int_V \\int_V f(r_{12}) d\\mathbf{r}_1 d\\mathbf{r}_2$$\n变换到质心坐标和相对坐标（$\\mathbf{R} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2, \\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$），对 $\\mathbf{r}_1, \\mathbf{r}_2$ 的积分变为 $V \\int_V f(r) d\\mathbf{r}$。因此：\n$$Z_N \\approx V^N + \\binom{N}{2} V^{N-1} \\int f(r) d\\mathbf{r}$$\n取对数，并在 $x$ 很小时使用 $\\ln(1+x) \\approx x$，以及在 $N$ 很大时使用 $N(N-1) \\approx N^2$：\n$$\\ln Z_N \\approx \\ln(V^N) + \\ln\\left(1 + \\frac{N(N-1)}{2V} \\int f(r) d\\mathbf{r}\\right) \\approx N \\ln V + \\frac{N^2}{2V} \\int f(r) d\\mathbf{r}$$\n于是压强为：\n$$P = k_B T \\frac{\\partial}{\\partial V} \\left(N \\ln V + \\frac{N^2}{2V} \\int f(r) d\\mathbf{r}\\right) = k_B T \\left(\\frac{N}{V} - \\frac{N^2}{2V^2} \\int f(r) d\\mathbf{r}\\right)$$\n重新整理得到压缩因子：\n$$Z = \\frac{PV}{Nk_B T} = 1 - \\frac{N}{2V} \\int f(r) d\\mathbf{r} = 1 + \\left(-\\frac{1}{2}\\int f(r) d\\mathbf{r}\\right)\\rho$$\n将此与维里展开式比较，我们识别出第二维里系数：\n$$B_2(T) = -\\frac{1}{2} \\int (e^{-\\beta u(r)} - 1) d\\mathbf{r}$$\n对于各向同性势，我们在球坐标中积分，$d\\mathbf{r} = 4\\pi r^2 dr$：\n$$B_2(T) = -\\frac{1}{2} \\int_0^\\infty (e^{-\\beta u(r)} - 1) 4\\pi r^2 dr = -2\\pi \\int_0^\\infty (e^{-u(r)/(k_B T)} - 1) r^2 dr$$\n这就是连接对势与第二维里系数的通用积分表达式。\n\n接下来，我们对该表达式进行无量纲化。Lennard-Jones 势为 $u(r) = 4\\epsilon [(\\sigma/r)^{12} - (\\sigma/r)^6]$。我们使用约化距离 $r^* = r/\\sigma$ 和约化温度 $T^* = k_B T / \\epsilon$。约化势为 $u^*(r^*) = u(r)/\\epsilon = 4[(r^*)^{-12} - (r^*)^{-6}]$。指数的自变量变为 $\\beta u(r) = u(r)/(k_B T) = (u(r)/\\epsilon) / (k_B T/\\epsilon) = u^*(r^*)/T^*$。代入 $r = \\sigma r^*$ 和 $dr = \\sigma dr^*$：\n$$B_2(T) = -2\\pi \\int_0^\\infty (e^{-u^*(r^*)/T^*} - 1) (\\sigma r^*)^2 (\\sigma dr^*) = -2\\pi \\sigma^3 \\int_0^\\infty (e^{-u^*(r^*)/T^*} - 1) (r^*)^2 dr^*$$\n约化第二维里系数为 $B_2^*(T^*) = B_2(T) / \\sigma^3$：\n$$B_2^*(T^*) = -2\\pi \\int_0^\\infty \\left(e^{-4[(r^*)^{-12} - (r^*)^{-6}]/T^*} - 1\\right) (r^*)^2 dr^*$$\n这是需要进行数值计算的最终表达式。该积分为反常积分，上限为 $r^*=\\infty$。被积函数在极限处表现良好。当 $r^* \\to 0$ 时，$u^*(r^*) \\to +\\infty$，因此 $e^{-u^*/T^*} \\to 0$，被积函数趋近于 $-(r^*)^2$，即为 $0$。当 $r^* \\to \\infty$ 时，$u^*(r^*) \\to 0$，且 $e^{-u^*/T^*} - 1 \\approx -u^*/T^* \\approx 4(r^*)^{-6}/T^*$。被积函数趋近于 $4(r^*)^{-4}/T^*$，其衰减速度足以使积分收敛。我们将使用一个数值积分程序 `scipy.integrate.quad`，它适用于此类反常积分。\n\nBoyle 温度 $T_B$ 是第二维里系数为零时的温度，即 $B_2(T_B) = 0$。这对应于长程吸引力和短程排斥力的效应相互抵消的温度。在约化单位下，我们寻找使 $B_2^*(T_B^*) = 0$ 的约化 Boyle 温度 $T_B^*$。在低温下，LJ 势的吸引势阱占主导地位，使得 $B_2^*(T^*)$ 为负。在高温下，排斥核心占主导地位，使得 $B_2^*(T^*)$ 为正。因此，必定存在一个根。我们将通过首先确定一个温度区间 $[T_a^*, T_b^*]$ 来找到这个根，在该区间内 $B_2^*(T_a^*)$ 和 $B_2^*(T_b^*)$ 符号相反。测试集中的值 $T^*=3.0$ 和 $T^*=3.5$ 可以作为一个很好的区间。然后，我们采用求根算法 `scipy.optimize.root_scalar` 的 `brentq` 方法（一种结合了二分法、割线法和逆二次插值的稳健方法）来在此区间内找到 $T_B^*$。\n\n该实现将包含一个定义被积函数的函数，一个使用数值积分计算给定 $T^*$ 的 $B_2^*(T^*)$ 的函数，以及一个计算测试集的 $B_2^*$ 并找到 $T_B^*$ 的主程序。所有浮点结果将按要求四舍五入到 6 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Derives, calculates, and analyzes the second virial coefficient for a Lennard-Jones fluid.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases_t_star = [0.5, 1.0, 3.0, 3.5, 10.0]\n\n    def lj_potential_reduced(r_star: float) -> float:\n        \"\"\"\n        Calculates the reduced Lennard-Jones potential u*(r*) = u(r)/epsilon.\n        \n        Args:\n            r_star (float): The reduced distance r* = r/sigma.\n        \n        Returns:\n            float: The reduced potential energy.\n        \"\"\"\n        if r_star == 0:\n            return np.inf\n        # Using r_star_6 to avoid recomputing the power\n        r_star_6 = r_star**-6\n        return 4.0 * (r_star_6**2 - r_star_6)\n\n    def b2_star_integrand(r_star: float, t_star: float) -> float:\n        \"\"\"\n        Calculates the integrand for the reduced second virial coefficient B2*.\n        \n        Args:\n            r_star (float): The reduced distance r* = r/sigma.\n            t_star (float): The reduced temperature T* = k_B*T/epsilon.\n        \n        Returns:\n            float: The value of the integrand at r_star.\n        \"\"\"\n        u_star = lj_potential_reduced(r_star)\n        \n        # np.exp handles the u_star -> inf case correctly, returning 0.\n        mayer_f = np.exp(-u_star / t_star) - 1.0\n        \n        return mayer_f * r_star**2\n\n    def calculate_b2_star(t_star: float) -> float:\n        \"\"\"\n        Calculates the reduced second virial coefficient B2* for a given reduced temperature T*.\n        \n        Args:\n            t_star (float): The reduced temperature T*.\n        \n        Returns:\n            float: The reduced second virial coefficient B2*(T*).\n        \"\"\"\n        # The integral is computed from 0 to infinity.\n        integral, _ = integrate.quad(b2_star_integrand, 0, np.inf, args=(t_star,))\n        \n        return -2.0 * np.pi * integral\n\n    results = []\n    # Calculate B2* for each test case temperature\n    for t_star_val in test_cases_t_star:\n        b2_star_val = calculate_b2_star(t_star_val)\n        results.append(round(b2_star_val, 6))\n\n    # Estimate the reduced Boyle Temperature T_B*\n    # We need to find the root of the function B2*(T*) = 0.\n    # From the test cases, B2*(3.0) will be negative and B2*(3.5) will be positive,\n    # so [3.0, 3.5] is a valid bracket.\n    try:\n        # The function for the root-finder is calculate_b2_star itself.\n        boyle_temp_result = optimize.root_scalar(\n            calculate_b2_star, \n            bracket=[3.0, 3.5], \n            method='brentq'\n        )\n        if boyle_temp_result.converged:\n            t_b_star = round(boyle_temp_result.root, 6)\n        else:\n            # Fallback in case of convergence failure, though unlikely for this problem.\n            t_b_star = \"NaN\" \n            \n    except ValueError:\n        # This will be raised if the initial bracket is not valid (i.e. f(a)*f(b) >= 0).\n        t_b_star = \"Error: Invalid Bracket\"\n\n    results.append(t_b_star)\n\n    # Format the final output string exactly as specified.\n    # Convert each numeric result to a string with 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" if isinstance(res, (float, np.floating)) else str(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}