{
    "hands_on_practices": [
        {
            "introduction": "This practice focuses on the Lennard-Jones potential, a cornerstone for modeling nonbonded van der Waals interactions. By deriving the potential minimum's location and depth, you will gain a deeper intuition for the physical meaning of the $\\sigma$ and $\\epsilon$ parameters. This exercise  will also familiarize you with combining rules, a standard method for estimating interaction parameters between different atom types.",
            "id": "3743459",
            "problem": "In classical nonbonded interactions used by Assisted Model Building with Energy Refinement (AMBER) and Chemistry at Harvard Macromolecular Mechanics (CHARMM) force fields, the cross Lennard–Jones (LJ) parameters for a pair of unlike atoms are obtained from like-atom parameters via standard combining rules. Consider two atom types, $i$ and $j$, whose like-atom Lennard–Jones parameters are given in the $\\sigma$–$\\epsilon$ convention: atom $i$ has $\\sigma_i = 3.07\\ \\text{\\AA}$ and $\\epsilon_i = 0.8786\\ \\text{kJ mol}^{-1}$, while atom $j$ has $\\sigma_j = 3.55\\ \\text{\\AA}$ and $\\epsilon_j = 0.2929\\ \\text{kJ mol}^{-1}$. Assume the Lorentz–Berthelot combining rules for cross interactions and the standard $12$–$6$ Lennard–Jones potential between unlike atoms,\n$$\nU_{ij}(r) = 4\\,\\epsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6}\\right].\n$$\n  \n(a) Using only the stated assumptions and definitions, determine symbolically the location $r_m$ of the potential energy minimum and the corresponding potential energy value $U_{ij}(r_m)$ in terms of $\\sigma_{ij}$ and $\\epsilon_{ij}$.  \n\n(b) Compute $\\sigma_{ij}$ and $\\epsilon_{ij}$ from the given like-atom parameters, and then evaluate $U_{ij}(r_m)$ numerically. Express the final energy in $\\text{kJ mol}^{-1}$ and round your final answer to four significant figures.\n\nYour final reported result must be a single real-valued number equal to the Lennard–Jones potential energy at the minimum, $U_{ij}(r_m)$, in the requested units and precision.",
            "solution": "The problem requires a two-part analysis of the Lennard-Jones (LJ) interaction between two unlike atoms, $i$ and $j$, within the framework of classical molecular mechanics force fields. First, we must symbolically determine the position ($r_m$) and depth ($U_{ij}(r_m)$) of the potential energy minimum. Second, we must compute the numerical value of this minimum energy using the given parameters and Lorentz-Berthelot combining rules.\n\nThe Lennard-Jones potential for the interaction between atoms $i$ and $j$ is given by:\n$$ U_{ij}(r) = 4\\,\\epsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6}\\right] $$\nwhere $r$ is the distance between the atoms, $\\sigma_{ij}$ is the finite distance at which the inter-particle potential is zero, and $\\epsilon_{ij}$ is the depth of the potential well.\n\n**Part (a): Symbolic Determination of the Potential Minimum**\n\nTo find the location of the potential energy minimum, $r_m$, we must find the value of $r$ for which the first derivative of the potential energy function with respect to $r$ is zero.\n$$ \\frac{dU_{ij}}{dr} = 0 $$\nLet's first write the potential in a form that is easier to differentiate:\n$$ U_{ij}(r) = 4\\,\\epsilon_{ij}\\left(\\sigma_{ij}^{12}r^{-12} - \\sigma_{ij}^{6}r^{-6}\\right) $$\nNow, we compute the derivative:\n$$ \\frac{dU_{ij}}{dr} = 4\\,\\epsilon_{ij}\\left(\\sigma_{ij}^{12}(-12)r^{-13} - \\sigma_{ij}^{6}(-6)r^{-7}\\right) $$\n$$ \\frac{dU_{ij}}{dr} = 4\\,\\epsilon_{ij}\\left(-12\\,\\sigma_{ij}^{12}r^{-13} + 6\\,\\sigma_{ij}^{6}r^{-7}\\right) $$\nSetting the derivative to zero at $r = r_m$:\n$$ 4\\,\\epsilon_{ij}\\left(-12\\,\\sigma_{ij}^{12}r_m^{-13} + 6\\,\\sigma_{ij}^{6}r_m^{-7}\\right) = 0 $$\nSince $\\epsilon_{ij}$ is a non-zero physical parameter, we can divide by $4\\,\\epsilon_{ij}$:\n$$ -12\\,\\sigma_{ij}^{12}r_m^{-13} + 6\\,\\sigma_{ij}^{6}r_m^{-7} = 0 $$\n$$ 6\\,\\sigma_{ij}^{6}r_m^{-7} = 12\\,\\sigma_{ij}^{12}r_m^{-13} $$\nDividing both sides by $6\\,\\sigma_{ij}^{6}$ and multiplying by $r_m^{13}$:\n$$ r_m^6 = 2\\,\\sigma_{ij}^{6} $$\nSolving for $r_m$:\n$$ r_m = (2)^{1/6} \\sigma_{ij} $$\nThis is the symbolic expression for the location of the potential energy minimum.\n\nNext, we find the potential energy at this minimum, $U_{ij}(r_m)$, by substituting $r_m$ back into the original potential function:\n$$ U_{ij}(r_m) = 4\\,\\epsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r_m}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_m}\\right)^{6}\\right] $$\nFrom our expression for $r_m$, we can find the ratio $\\sigma_{ij}/r_m$:\n$$ \\frac{\\sigma_{ij}}{r_m} = \\frac{\\sigma_{ij}}{(2)^{1/6} \\sigma_{ij}} = \\frac{1}{2^{1/6}} = 2^{-1/6} $$\nNow substitute this ratio into the potential energy expression:\n$$ \\left(\\frac{\\sigma_{ij}}{r_m}\\right)^{12} = \\left(2^{-1/6}\\right)^{12} = 2^{-2} = \\frac{1}{4} $$\n$$ \\left(\\frac{\\sigma_{ij}}{r_m}\\right)^{6} = \\left(2^{-1/6}\\right)^{6} = 2^{-1} = \\frac{1}{2} $$\nPlugging these values back into the equation for $U_{ij}(r_m)$:\n$$ U_{ij}(r_m) = 4\\,\\epsilon_{ij}\\left[\\frac{1}{4} - \\frac{1}{2}\\right] = 4\\,\\epsilon_{ij}\\left[-\\frac{1}{4}\\right] = -\\epsilon_{ij} $$\nThus, the potential energy at the minimum is exactly the negative of the well-depth parameter, $U_{ij}(r_m) = -\\epsilon_{ij}$.\n\n**Part (b): Numerical Calculation**\n\nThe problem specifies the use of Lorentz-Berthelot combining rules to determine the cross-interaction parameters $\\sigma_{ij}$ and $\\epsilon_{ij}$ from the like-atom parameters.\nThe like-atom parameters are given as:\n$\\sigma_i = 3.07\\ \\text{\\AA}$ and $\\epsilon_i = 0.8786\\ \\text{kJ mol}^{-1}$\n$\\sigma_j = 3.55\\ \\text{\\AA}$ and $\\epsilon_j = 0.2929\\ \\text{kJ mol}^{-1}$\n\nThe Lorentz-Berthelot combining rules are:\n1.  Arithmetic mean for the size parameter (Lorentz rule):\n    $$ \\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2} $$\n2.  Geometric mean for the energy parameter (Berthelot rule):\n    $$ \\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j} $$\n\nWe only need to calculate $\\epsilon_{ij}$ to find the final answer, as established in Part (a).\n$$ \\epsilon_{ij} = \\sqrt{(0.8786) \\cdot (0.2929)} $$\nThe units will be $\\sqrt{(\\text{kJ mol}^{-1}) \\cdot (\\text{kJ mol}^{-1})} = \\text{kJ mol}^{-1}$.\n$$ \\epsilon_{ij} = \\sqrt{0.25731394} \\approx 0.50726101\\ \\text{kJ mol}^{-1} $$\nFrom Part (a), the potential energy at the minimum is $U_{ij}(r_m) = -\\epsilon_{ij}$.\n$$ U_{ij}(r_m) \\approx -0.50726101\\ \\text{kJ mol}^{-1} $$\nThe problem requires the final answer to be rounded to four significant figures. The first four significant figures of the magnitude are $5, 0, 7, 2$. The fifth digit is $6$, so we round up the last significant digit.\n$$ U_{ij}(r_m) \\approx -0.5073\\ \\text{kJ mol}^{-1} $$\nThis is the final numerical result for the potential energy at the minimum distance between the two atoms.",
            "answer": "$$\\boxed{-0.5073}$$"
        },
        {
            "introduction": "Building on the understanding of individual energy terms, this next practice challenges you to assemble the complete potential energy for a small peptide fragment. This comprehensive calculation  integrates all standard components of a classical force field, from bonded terms to scaled nonbonded interactions. Completing this exercise provides a concrete understanding of how these distinct mathematical functions synergize to describe a molecule's energetic landscape.",
            "id": "3743451",
            "problem": "Consider a four-atom backbone fragment of a peptide, labeled as atom $1$ (amide nitrogen), atom $2$ (alpha carbon), atom $3$ (carbonyl carbon), and atom $4$ (carbonyl oxygen). Using the classical biomolecular force field framework as in Assisted Model Building with Energy Refinement (AMBER) and Chemistry at Harvard Macromolecular Mechanics (CHARMM), the total potential energy $U(\\mathbf{r})$ is constructed from bonded and nonbonded contributions evaluated on internal coordinates and interatomic distances. The following parameters and geometry are specified:\n\n- Bonds:\n  - Between $1$-$2$: $k_{b,12} = 1000\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$, $r_{0,12} = 0.145\\ \\mathrm{nm}$, observed $r_{12} = 0.147\\ \\mathrm{nm}$.\n  - Between $2$-$3$: $k_{b,23} = 1500\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$, $r_{0,23} = 0.153\\ \\mathrm{nm}$, observed $r_{23} = 0.152\\ \\mathrm{nm}$.\n  - Between $3$-$4$: $k_{b,34} = 2000\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$, $r_{0,34} = 0.123\\ \\mathrm{nm}$, observed $r_{34} = 0.124\\ \\mathrm{nm}$.\n- Angles:\n  - For $1$-$2$-$3$: $k_{\\theta,123} = 400\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{rad}^{-2}$, $\\theta_{0,123} = 1.94\\ \\mathrm{rad}$, observed $\\theta_{123} = 1.92\\ \\mathrm{rad}$.\n  - For $2$-$3$-$4$: $k_{\\theta,234} = 500\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{rad}^{-2}$, $\\theta_{0,234} = 2.11\\ \\mathrm{rad}$, observed $\\theta_{234} = 2.14\\ \\mathrm{rad}$.\n- Proper dihedral $1$-$2$-$3$-$4$:\n  - Single cosine term with amplitude $V_1 = 2.0\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, periodicity $n = 1$, phase $\\delta = \\pi$, observed dihedral $\\varphi = 3.00\\ \\mathrm{rad}$.\n- Nonbonded parameters:\n  - Partial charges (in units of the elementary charge $e$): $q_1 = -0.35$, $q_2 = +0.10$, $q_3 = +0.50$, $q_4 = -0.55$.\n  - Lennard–Jones parameters $(\\epsilon_i, \\sigma_i)$:\n    - Atom $1$ (nitrogen): $\\epsilon_1 = 0.20\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\sigma_1 = 0.325\\ \\mathrm{nm}$.\n    - Atom $2$ (alpha carbon): $\\epsilon_2 = 0.12\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\sigma_2 = 0.340\\ \\mathrm{nm}$.\n    - Atom $3$ (carbonyl carbon): $\\epsilon_3 = 0.12\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\sigma_3 = 0.350\\ \\mathrm{nm}$.\n    - Atom $4$ (oxygen): $\\epsilon_4 = 0.60\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\sigma_4 = 0.296\\ \\mathrm{nm}$.\n  - Lorentz–Berthelot mixing rules for unlike pairs $i$-$j$: $\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}$, $\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$.\n  - Electrostatics in vacuum with Coulomb constant $k_e = 138.935456\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}\\,e^{-2}$.\n  - Exclusions: $1$-$2$, $2$-$3$, and $3$-$4$ pairs are excluded from nonbonded interactions; $1$-$3$ and $2$-$4$ are also excluded (being $1$-$3$ pairs). The $1$-$4$ pair is included with scaling: scale the Lennard–Jones energy by $s_{\\mathrm{LJ}} = \\frac{1}{2}$ and the electrostatic energy by $s_{\\mathrm{elec}} = \\frac{1}{1.2}$. The $1$-$4$ separation is $r_{14} = 0.290\\ \\mathrm{nm}$.\n\nUsing the standard classical representation of bonded harmonic terms, cosine torsions, and pairwise nonbonded Lennard–Jones plus Coulomb interactions consistent with AMBER/CHARMM conventions, compute the total potential energy $U(\\mathbf{r})$ for this geometry. In your calculation, verify the consistency of physical units across all terms to justify that each contributes in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. Express the final energy in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. All necessary parameters and geometric data are provided to compute the total potential energy of the specified four-atom system using a standard classical force field model.\n\nThe total potential energy, $U_{total}$, is the sum of bonded and nonbonded energy contributions:\n$$U_{total} = U_{bond} + U_{angle} + U_{dihedral} + U_{nonbonded}$$\nEach term will be calculated separately, and the consistency of units will be verified throughout. The final energy will be expressed in units of $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\n1. Bond Stretching Energy ($U_{bond}$)\nThe bond stretching potential is given by a harmonic function for each of the three bonds ($1$-$2$, $2$-$3$, and $3$-$4$):\n$$U_{bond} = \\sum_{i \\in \\text{bonds}} k_{b,i} (r_i - r_{0,i})^2$$\nThe units for this term are consistent: $[\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}] \\times (\\mathrm{nm})^2 = \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n- For bond $1$-$2$: $U_{b,12} = k_{b,12}(r_{12} - r_{0,12})^2 = (1000\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}) \\times (0.147\\ \\mathrm{nm} - 0.145\\ \\mathrm{nm})^2 = 1000 \\times (0.002)^2 = 0.004\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n- For bond $2$-$3$: $U_{b,23} = k_{b,23}(r_{23} - r_{0,23})^2 = (1500\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}) \\times (0.152\\ \\mathrm{nm} - 0.153\\ \\mathrm{nm})^2 = 1500 \\times (-0.001)^2 = 0.0015\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n- For bond $3$-$4$: $U_{b,34} = k_{b,34}(r_{34} - r_{0,34})^2 = (2000\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}) \\times (0.124\\ \\mathrm{nm} - 0.123\\ \\mathrm{nm})^2 = 2000 \\times (0.001)^2 = 0.002\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\nThe total bond energy is the sum of these contributions:\n$$U_{bond} = 0.004 + 0.0015 + 0.002 = 0.0075\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n\n2. Angle Bending Energy ($U_{angle}$)\nThe angle bending potential is also represented by a harmonic function for the two angles ($1$-$2$-$3$ and $2$-$3$-$4$):\n$$U_{angle} = \\sum_{j \\in \\text{angles}} k_{\\theta,j} (\\theta_j - \\theta_{0,j})^2$$\nThe units are consistent: $[\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{rad}^{-2}] \\times (\\mathrm{rad})^2 = \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n- For angle $1$-$2$-$3$: $U_{\\theta,123} = k_{\\theta,123}(\\theta_{123} - \\theta_{0,123})^2 = (400\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{rad}^{-2}) \\times (1.92\\ \\mathrm{rad} - 1.94\\ \\mathrm{rad})^2 = 400 \\times (-0.02)^2 = 0.16\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n- For angle $2$-$3$-$4$: $U_{\\theta,234} = k_{\\theta,234}(\\theta_{234} - \\theta_{0,234})^2 = (500\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{rad}^{-2}) \\times (2.14\\ \\mathrm{rad} - 2.11\\ \\mathrm{rad})^2 = 500 \\times (0.03)^2 = 0.45\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\nThe total angle energy is the sum:\n$$U_{angle} = 0.16 + 0.45 = 0.61\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n\n3. Dihedral Torsion Energy ($U_{dihedral}$)\nThe torsional potential for the proper dihedral angle $1$-$2$-$3$-$4$ is given by a single cosine term:\n$$U_{dihedral} = V_n (1 + \\cos(n\\varphi - \\delta))$$\nGiven parameters are the amplitude $V_1 = 2.0\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, periodicity $n = 1$, phase $\\delta = \\pi$, and observed angle $\\varphi = 3.00\\ \\mathrm{rad}$. The amplitude $V_1$ is interpreted as the prefactor of the expression, consistent with the CHARMM functional form. The units are inherently in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ as the cosine term is dimensionless.\n$$U_{dihedral} = 2.0 \\times (1 + \\cos(1 \\times 3.00 - \\pi))$$\nUsing the trigonometric identity $\\cos(x - \\pi) = -\\cos(x)$:\n$$U_{dihedral} = 2.0 \\times (1 - \\cos(3.00))$$\nWith the calculator in radian mode, $\\cos(3.00) \\approx -0.989992$:\n$$U_{dihedral} = 2.0 \\times (1 - (-0.989992)) = 2.0 \\times 1.989992 = 3.979984\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n\n4. Nonbonded Energy ($U_{nonbonded}$)\nNonbonded interactions are excluded for $1$-$2$, $1$-$3$, $2$-$3$, $2$-$4$, and $3$-$4$ pairs. Only the $1$-$4$ interaction is calculated, with specific scaling factors.\n$$U_{nonbonded} = U_{nonbonded, 1-4} = s_{\\mathrm{LJ}} U_{LJ,14} + s_{\\mathrm{elec}} U_{elec,14}$$\n- Electrostatic Interaction ($U_{elec,14}$):\n  The Coulomb potential is $U_{elec,ij} = k_e \\frac{q_i q_j}{r_{ij}}$. The units are $[\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}\\,e^{-2}] \\times \\frac{e^2}{\\mathrm{nm}} = \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n  For the $1$-$4$ pair: $q_1 = -0.35\\ e$, $q_4 = -0.55\\ e$, $r_{14} = 0.290\\ \\mathrm{nm}$, and $k_e = 138.935456\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}\\,e^{-2}$.\n  $$U_{elec,14} = 138.935456 \\times \\frac{(-0.35) \\times (-0.55)}{0.290} = 138.935456 \\times \\frac{0.1925}{0.290} \\approx 92.23560\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n- Lennard-Jones Interaction ($U_{LJ,14}$):\n  The LJ potential is $U_{LJ,ij} = 4\\epsilon_{ij} \\left[ \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^6 \\right]$. The parameter $\\epsilon_{ij}$ has units of $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and the remaining terms are dimensionless, ensuring correct final units. First, we apply the Lorentz-Berthelot mixing rules to find parameters for the $1$-$4$ pair:\n  $$\\sigma_{14} = \\frac{\\sigma_1 + \\sigma_4}{2} = \\frac{0.325\\ \\mathrm{nm} + 0.296\\ \\mathrm{nm}}{2} = 0.3105\\ \\mathrm{nm}$$\n  $$\\epsilon_{14} = \\sqrt{\\epsilon_1 \\epsilon_4} = \\sqrt{(0.20\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}) \\times (0.60\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1})} = \\sqrt{0.12}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n  The distance ratio is $\\frac{\\sigma_{14}}{r_{14}} = \\frac{0.3105}{0.290} \\approx 1.07069$.\n  $$U_{LJ,14} = 4\\sqrt{0.12} \\left[ \\left(\\frac{0.3105}{0.290}\\right)^{12} - \\left(\\frac{0.3105}{0.290}\\right)^6 \\right] \\approx 4(0.34641) [ (1.07069)^{12} - (1.07069)^6 ]$$\n  $$U_{LJ,14} \\approx 1.38564 \\times [2.26003 - 1.50334] = 1.38564 \\times 0.75669 \\approx 1.04855\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n- Scaled Nonbonded Energy:\n  Using the scaling factors $s_{\\mathrm{LJ}} = \\frac{1}{2}$ and $s_{\\mathrm{elec}} = \\frac{1}{1.2}$:\n  $$U_{nonbonded} = \\left(\\frac{1}{2} \\times 1.04855\\right) + \\left(\\frac{1}{1.2} \\times 92.23560\\right)$$\n  $$U_{nonbonded} \\approx 0.52428 + 76.86300 = 77.38728\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n\n5. Total Potential Energy ($U_{total}$)\nThe total potential energy is the sum of all calculated components:\n$$U_{total} = U_{bond} + U_{angle} + U_{dihedral} + U_{nonbonded}$$\n$$U_{total} = 0.0075 + 0.61 + 3.979984 + 77.38728 = 81.984764\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\nRounding the result to four significant figures as requested:\n$$U_{total} \\approx 81.98\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$",
            "answer": "$$\\boxed{81.98}$$"
        },
        {
            "introduction": "The final practice shifts our perspective from using force field parameters to deriving them. Here, you will tackle the crucial task of parameterizing a torsional potential by fitting it to reference quantum mechanics data, a common workflow in force field development . This computational exercise illuminates how the abstract parameters of the model are connected to the underlying quantum reality, giving you firsthand experience with the art and science of force field parameterization.",
            "id": "3743443",
            "problem": "You are given the task of parameterizing a single-term dihedral torsion potential for a one-dimensional quantum mechanics (QM) dihedral scan about a bond in a model compound, consistent with force fields such as Assisted Model Building with Energy Refinement (AMBER) and Chemistry at HARvard Macromolecular Mechanics (CHARMM). The purpose is to infer the parameters that best reproduce QM energy differences across sampled dihedral angles. The torsional potential to be fitted follows the widely used Fourier form that maps dihedral angle periodicity to rotational barriers. Your solution must derive its algorithm from first principles and core definitions, starting from Newtonian mechanics and well-established classical force field practices, not from any task-specific shortcut.\n\nThe torsional contribution to the potential energy as a function of dihedral angle is modeled as a single Fourier term\n$$\nE_{\\text{tors}}(\\phi) = C + \\frac{V}{2}\\left[1 + \\cos\\left(n\\,\\phi - \\delta\\right)\\right],\n$$\nwhere $C$ is a constant offset, $V \\ge 0$ is the barrier height parameter, $n \\in \\mathbb{Z}^{+}$ is the periodicity, $\\delta \\in [0,2\\pi)$ is the phase shift, and $\\phi$ is the dihedral angle. In AMBER and CHARMM, energies are expressed in kilojoules per mole and angles are typically specified in degrees. The QM energies provided are relative energies (each dataset is shifted so that the minimum is at zero), expressed in kilojoules per mole, and the dihedral angles are in degrees.\n\nYour program must implement the following tasks:\n- For each test case, treat the QM energies $E^{\\text{QM}}_i$ at angles $\\phi_i$ as data to be reproduced by a model of the form above with a single Fourier term. Assume the set of candidate periodicities is $S = \\{1,2,3,4,6\\}$.\n- For each $n \\in S$, fit $C$, $V$, and $\\delta$ by least squares to minimize the sum of squared residuals between $E^{\\text{QM}}_i$ and $E_{\\text{tors}}(\\phi_i)$ over all sampled angles. Angles must be converted to radians when evaluating trigonometric functions. The phase $\\delta$ must be reported in degrees in $[0,360)$, and the fitted $V$ must satisfy $V \\ge 0$ by construction. If the fitted $V$ is numerically negligible (use a threshold $V  10^{-8}$), report $\\delta = 0$ by convention.\n- For each $n$, compute the root-mean-square error\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{M} \\sum_{i=1}^{M} \\left(E^{\\text{QM}}_i - E_{\\text{tors}}(\\phi_i)\\right)^2},\n$$\nand the coefficient of determination\n$$\nR^2 = 1 - \\frac{\\sum_{i=1}^{M} \\left(E^{\\text{QM}}_i - E_{\\text{tors}}(\\phi_i)\\right)^2}{\\sum_{i=1}^{M} \\left(E^{\\text{QM}}_i - \\bar{E}^{\\text{QM}}\\right)^2},\n$$\nwhere $M$ is the number of sampled angles and $\\bar{E}^{\\text{QM}}$ is the mean of the QM energies.\n- Select the periodicity $n^{\\ast} \\in S$ that minimizes $\\mathrm{RMSE}$; in the event of an exact tie in $\\mathrm{RMSE}$ within numerical precision, choose the smallest $n$ among those tied. Report the tuple $\\left[n^{\\ast}, V^{\\ast}, \\delta^{\\ast}, \\mathrm{RMSE}^{\\ast}, R^{2\\ast}\\right]$ for each test case.\n\nAngle units: All angles $\\phi$ and the fitted phase $\\delta$ must be handled internally in radians for evaluation of trigonometric functions, but the output phase $\\delta^{\\ast}$ must be expressed in degrees in $[0,360)$. Energy units: All energies must be treated and reported in kilojoules per mole. The outputs for $\\mathrm{RMSE}$ and $V$ must be in kilojoules per mole. Your program must round $V^{\\ast}$, $\\delta^{\\ast}$, $\\mathrm{RMSE}^{\\ast}$, and $R^{2\\ast}$ to $6$ decimal places in the final report.\n\nTest suite to implement inside your program:\n- Test case $1$ (happy path, single periodicity): Angles $\\phi_i$ on a uniform grid $\\{0^{\\circ},15^{\\circ},30^{\\circ},\\dots,345^{\\circ}\\}$, $M=24$. Generate synthetic QM energies using $V = 12.0\\ \\mathrm{kJ/mol}$, $n = 3$, $\\delta = 0^{\\circ}$, and $C = 5.0\\ \\mathrm{kJ/mol}$ via $E(\\phi) = C + \\frac{V}{2}\\left[1+\\cos(n\\phi-\\delta)\\right]$, then shift to relative energies $E^{\\text{QM}}(\\phi) = E(\\phi) - \\min_{\\phi} E(\\phi)$.\n- Test case $2$ (phase shift edge case): Angles $\\phi_i$ on a uniform grid $\\{0^{\\circ},30^{\\circ},60^{\\circ},\\dots,330^{\\circ}\\}$, $M=12$. Use $V = 6.0\\ \\mathrm{kJ/mol}$, $n = 2$, $\\delta = 180^{\\circ}$, and $C = 2.0\\ \\mathrm{kJ/mol}$; construct $E^{\\text{QM}}$ as above and shift to relative energies.\n- Test case $3$ (nearly flat surface): Angles $\\phi_i$ on a uniform grid $\\{0^{\\circ},30^{\\circ},60^{\\circ},\\dots,330^{\\circ}\\}$, $M=12$. Use $V = 0.05\\ \\mathrm{kJ/mol}$, $n = 1$, $\\delta = 45^{\\circ}$, and $C = 0.0\\ \\mathrm{kJ/mol}$; construct $E^{\\text{QM}}$ as above and shift to relative energies.\n- Test case $4$ (model mismatch, multi-term QM): Angles $\\phi_i$ on a uniform grid $\\{0^{\\circ},15^{\\circ},30^{\\circ},\\dots,345^{\\circ}\\}$, $M=24$. Generate $E(\\phi) = C + \\frac{V_1}{2}\\left[1+\\cos(n_1\\phi-\\delta_1)\\right] + \\frac{V_2}{2}\\left[1+\\cos(n_2\\phi-\\delta_2)\\right]$ with $V_1 = 8.0\\ \\mathrm{kJ/mol}$, $n_1 = 3$, $\\delta_1 = 0^{\\circ}$, $V_2 = 2.0\\ \\mathrm{kJ/mol}$, $n_2 = 1$, $\\delta_2 = 60^{\\circ}$, $C = 1.0\\ \\mathrm{kJ/mol}$; shift to relative energies $E^{\\text{QM}}(\\phi) = E(\\phi) - \\min_{\\phi} E(\\phi)$.\n\nFinal output format: Your program should produce a single line of output containing the results for the four test cases as a comma-separated list of lists in the order of the test cases. For each test case, output the list $\\left[n^{\\ast},V^{\\ast},\\delta^{\\ast},\\mathrm{RMSE}^{\\ast},R^{2\\ast}\\right]$ with $n^{\\ast}$ as an integer and the other values as decimal numbers rounded to $6$ places. The complete output must look like\n$$\n\\bigl[\\,[n_1,V_1,\\delta_1,\\mathrm{RMSE}_1,R^2_1],[n_2,V_2,\\delta_2,\\mathrm{RMSE}_2,R^2_2],[n_3,V_3,\\delta_3,\\mathrm{RMSE}_3,R^2_3],[n_4,V_4,\\delta_4,\\mathrm{RMSE}_4,R^2_4]\\,\\bigr].\n$$",
            "solution": "The problem requires the parameterization of a single-term dihedral torsional potential by fitting it to quantum mechanics (QM) energy data. This is a standard procedure in the development of classical force fields for molecular simulations. The core of the task is a non-linear regression problem, which can be elegantly transformed into a linear least-squares problem. The solution proceeds by first deriving the method from fundamental principles and then applying it to the specified test cases.\n\nThe torsional potential energy, $E_{\\text{tors}}$, is given as a function of the dihedral angle $\\phi$:\n$$\nE_{\\text{tors}}(\\phi) = C + \\frac{V}{2}\\left[1 + \\cos\\left(n\\,\\phi - \\delta\\right)\\right]\n$$\nHere, $V \\ge 0$ is the torsional barrier height, $n \\in \\mathbb{Z}^{+}$ is the periodicity, $\\delta \\in [0, 2\\pi)$ is the phase shift, and $C$ is a constant energy offset. The objective is to determine the parameters $\\{C, V, \\delta\\}$ for a given periodicity $n$ that best reproduce a set of $M$ QM-derived energies $\\{E^{\\text{QM}}_i\\}$ at corresponding angles $\\{\\phi_i\\}$. The criterion for the \"best fit\" is the minimization of the sum of squared residuals (SSR), $\\chi^2$:\n$$\n\\chi^2(C, V, \\delta) = \\sum_{i=1}^{M} \\left(E^{\\text{QM}}_i - E_{\\text{tors}}(\\phi_i)\\right)^2\n$$\nDirect minimization of $\\chi^2$ is complicated due to the non-linear dependence on the phase shift $\\delta$. However, the model can be linearized by a change of variables. Using the trigonometric identity $\\cos(a-b) = \\cos(a)\\cos(b) + \\sin(a)\\sin(b)$, we can rewrite the potential as:\n$$\nE_{\\text{tors}}(\\phi) = C + \\frac{V}{2} + \\frac{V}{2} \\cos(n\\phi - \\delta) = C + \\frac{V}{2} + \\frac{V}{2}\\left[\\cos(n\\phi)\\cos(\\delta) + \\sin(n\\phi)\\sin(\\delta)\\right]\n$$\nWe introduce a new set of linear parameters:\n$$\nC' = C + \\frac{V}{2}\n$$\n$$\nA = \\frac{V}{2}\\cos(\\delta)\n$$\n$$\nB = \\frac{V}{2}\\sin(\\delta)\n$$\nSubstituting these into the energy expression yields a model that is linear in the parameters $C'$, $A$, and $B$:\n$$\nE_{\\text{tors}}(\\phi_i) = C' + A\\cos(n\\phi_i) + B\\sin(n\\phi_i)\n$$\nThe problem is now transformed into a standard linear least-squares regression. We seek to find the parameter vector $\\mathbf{p} = [C', A, B]^T$ that minimizes the sum of squared residuals. Let $\\mathbf{y}$ be the vector of observed QM energies, $E^{\\text{QM}}_i$, and let $\\mathbf{X}$ be the design matrix whose $i$-th row is $[1, \\cos(n\\phi_i), \\sin(n\\phi_i)]$. The system is described by $\\mathbf{y} \\approx \\mathbf{Xp}$. The solution that minimizes the Euclidean norm $||\\mathbf{y} - \\mathbf{Xp}||^2$ is given by the normal equations:\n$$\n(\\mathbf{X}^T\\mathbf{X})\\mathbf{p} = \\mathbf{X}^T\\mathbf{y}\n$$\nThis is a $3 \\times 3$ system of linear equations that can be solved for $\\mathbf{p}$ to obtain the optimal values of $C'$, $A$, and $B$.\n\nOnce the linear parameters $A$ and $B$ are determined, the original non-linear parameters $V$ and $\\delta$ can be recovered. From their definitions:\n$$\nA^2 + B^2 = \\left(\\frac{V}{2}\\right)^2 \\cos^2(\\delta) + \\left(\\frac{V}{2}\\right)^2 \\sin^2(\\delta) = \\left(\\frac{V}{2}\\right)^2 (\\cos^2(\\delta) + \\sin^2(\\delta)) = \\left(\\frac{V}{2}\\right)^2\n$$\nThe barrier height $V$ is therefore:\n$$\nV = 2\\sqrt{A^2 + B^2}\n$$\nThis formulation naturally satisfies the constraint $V \\ge 0$ by taking the principal square root. The phase shift $\\delta$ is determined from the ratio of $B$ to $A$:\n$$\n\\frac{B}{A} = \\frac{(V/2)\\sin(\\delta)}{(V/2)\\cos(\\delta)} = \\tan(\\delta)\n$$\nTo resolve the quadrant ambiguity inherent in the arctangent function, the two-argument arctangent, $\\mathrm{atan2}(B, A)$, is employed. This function returns the angle in radians within the interval $(-\\pi, \\pi]$. The result is then converted to degrees and normalized to the specified range $[0, 360)$. Per the problem specification, if the fitted barrier height $V$ is numerically negligible ($V  10^{-8}$), the phase $\\delta$ is set to $0$ by convention.\n\nThe overall algorithm for each test case proceeds as follows:\n1.  For each candidate periodicity $n$ in the set $S = \\{1, 2, 3, 4, 6\\}$:\n    a. The provided angles $\\phi_i$ are converted from degrees to radians for use in trigonometric functions.\n    b. The design matrix $\\mathbf{X}$ and the observation vector $\\mathbf{y} = [E^{\\text{QM}}_i]$ are constructed.\n    c. The normal equations are solved for the parameter vector $\\mathbf{p} = [C', A, B]^T$.\n    d. The parameters $V$ and $\\delta$ are calculated from $A$ and $B$.\n    e. The fitted energies, $E_{\\text{tors},i} = C' + A\\cos(n\\phi_i) + B\\sin(n\\phi_i)$, are calculated.\n    f. The goodness-of-fit metrics are computed. The sum of squared residuals is $SSR = \\sum_{i=1}^{M} (E^{\\text{QM}}_i - E_{\\text{tors},i})^2$, and the total sum of squares is $SST = \\sum_{i=1}^{M} (E^{\\text{QM}}_i - \\bar{E}^{\\text{QM}})^2$.\n    g. The root-mean-square error (RMSE) is calculated as $\\mathrm{RMSE} = \\sqrt{SSR/M}$.\n    h. The coefficient of determination is calculated as $R^2 = 1 - SSR/SST$.\n2.  The set of results $\\{[n, V, \\delta, \\mathrm{RMSE}, R^2]\\}$ for all $n \\in S$ is collected.\n3.  The optimal periodicity $n^{\\ast}$ is selected as the one corresponding to the minimum RMSE. In the case of a tie in RMSE, the smallest $n$ is chosen.\n4.  The final result for the test case, $[n^{\\ast}, V^{\\ast}, \\delta^{\\ast}, \\mathrm{RMSE}^{\\ast}, R^{2\\ast}]$, is reported with the required numerical precision.\n\nThis systematic procedure ensures a robust and objective parameterization of the torsional potential, grounded in the established principles of linear algebra and regression analysis as applied to problems in physical chemistry.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the dihedral fitting problem for all test cases.\n    \"\"\"\n\n    def create_test_cases():\n        \"\"\"Generates the data for the four test cases specified in the problem.\"\"\"\n        cases = []\n\n        # Test Case 1\n        angles_deg1 = np.arange(0, 360, 15)\n        V1, n1, delta_deg1, C1 = 12.0, 3, 0.0, 5.0\n        angles_rad1 = np.deg2rad(angles_deg1)\n        delta_rad1 = np.deg2rad(delta_deg1)\n        E1 = C1 + (V1 / 2) * (1 + np.cos(n1 * angles_rad1 - delta_rad1))\n        Eqm1 = E1 - np.min(E1)\n        cases.append((angles_deg1, Eqm1))\n\n        # Test Case 2\n        angles_deg2 = np.arange(0, 360, 30)\n        V2, n2, delta_deg2, C2 = 6.0, 2, 180.0, 2.0\n        angles_rad2 = np.deg2rad(angles_deg2)\n        delta_rad2 = np.deg2rad(delta_deg2)\n        E2 = C2 + (V2 / 2) * (1 + np.cos(n2 * angles_rad2 - delta_rad2))\n        Eqm2 = E2 - np.min(E2)\n        cases.append((angles_deg2, Eqm2))\n\n        # Test Case 3\n        angles_deg3 = np.arange(0, 360, 30)\n        V3, n3, delta_deg3, C3 = 0.05, 1, 45.0, 0.0\n        angles_rad3 = np.deg2rad(angles_deg3)\n        delta_rad3 = np.deg2rad(delta_deg3)\n        E3 = C3 + (V3 / 2) * (1 + np.cos(n3 * angles_rad3 - delta_rad3))\n        Eqm3 = E3 - np.min(E3)\n        cases.append((angles_deg3, Eqm3))\n\n        # Test Case 4\n        angles_deg4 = np.arange(0, 360, 15)\n        V1_4, n1_4, d1_4 = 8.0, 3, 0.0\n        V2_4, n2_4, d2_4 = 2.0, 1, 60.0\n        C4 = 1.0\n        angles_rad4 = np.deg2rad(angles_deg4)\n        d1_rad4 = np.deg2rad(d1_4)\n        d2_rad4 = np.deg2rad(d2_4)\n        E4 = C4 + (V1_4 / 2) * (1 + np.cos(n1_4 * angles_rad4 - d1_rad4)) \\\n             + (V2_4 / 2) * (1 + np.cos(n2_4 * angles_rad4 - d2_rad4))\n        Eqm4 = E4 - np.min(E4)\n        cases.append((angles_deg4, Eqm4))\n\n        return cases\n\n    def fit_and_select_best_model(angles_deg, energies_qm):\n        \"\"\"\n        Fits the torsional model for multiple periodicities and selects the best one.\n        \"\"\"\n        candidate_n = [1, 2, 3, 4, 6]\n        num_angles = len(angles_deg)\n        phi_rad = np.deg2rad(angles_deg)\n        y_qm = energies_qm\n\n        results_by_n = []\n\n        for n in candidate_n:\n            # Construct the design matrix X for linear least-squares\n            X = np.ones((num_angles, 3))\n            X[:, 1] = np.cos(n * phi_rad)\n            X[:, 2] = np.sin(n * phi_rad)\n\n            # Solve the normal equations (X.T @ X) @ p = X.T @ y\n            # p = [C', A, B]\n            try:\n                p = np.linalg.solve(X.T @ X, X.T @ y_qm)\n            except np.linalg.LinAlgError:\n                # Fallback for singular matrix, though unlikely with given data\n                # A fit with V=0 is a reasonable default.\n                p = np.array([np.mean(y_qm), 0.0, 0.0])\n\n            A, B = p[1], p[2]\n\n            # Recover original parameters V and delta\n            V = 2.0 * np.sqrt(A**2 + B**2)\n            \n            if V  1e-8:\n                # Convention for numerically negligible barrier height\n                delta_deg = 0.0\n            else:\n                delta_rad = np.arctan2(B, A)\n                delta_deg = np.rad2deg(delta_rad)\n                # Normalize delta to [0, 360)\n                if delta_deg  0:\n                    delta_deg += 360.0\n            \n            # Calculate goodness-of-fit metrics\n            y_pred = X @ p\n            SSR = np.sum((y_qm - y_pred)**2)\n            RMSE = np.sqrt(SSR / num_angles)\n\n            SST = np.sum((y_qm - np.mean(y_qm))**2)\n            # Avoid division by zero if all QM energies are identical\n            if SST  1e-12:\n                R2 = 1.0 if SSR  1e-12 else -np.inf\n            else:\n                R2 = 1.0 - SSR / SST\n\n            results_by_n.append([n, V, delta_deg, RMSE, R2])\n\n        # Select the best model based on minimum RMSE, with n as a tie-breaker\n        results_by_n.sort(key=lambda x: (x[3], x[0]))\n        \n        return results_by_n[0]\n\n    test_cases = create_test_cases()\n    final_results = []\n    \n    for angles, energies in test_cases:\n        best_fit = fit_and_select_best_model(angles, energies)\n        n_star, V_star, delta_star, RMSE_star, R2_star = best_fit\n        \n        # Round final numerical results to 6 decimal places\n        final_results.append([\n            n_star,\n            round(V_star, 6),\n            round(delta_star, 6),\n            round(RMSE_star, 6),\n            round(R2_star, 6)\n        ])\n    \n    # Format the final output string as specified\n    results_str = [\n        f\"[{r[0]},{r[1]:.6f},{r[2]:.6f},{r[3]:.6f},{r[4]:.6f}]\"\n        for r in final_results\n    ]\n    print(f\"[{','.join(results_str)}]\")\n\n\nsolve()\n```"
        }
    ]
}