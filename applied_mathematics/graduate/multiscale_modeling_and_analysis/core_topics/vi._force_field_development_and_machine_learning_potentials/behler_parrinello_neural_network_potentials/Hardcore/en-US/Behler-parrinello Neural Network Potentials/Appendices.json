{
    "hands_on_practices": [
        {
            "introduction": "A core principle for modeling systems of identical atoms is that the total energy must be invariant, regardless of how we arbitrarily label them. This property, known as permutation invariance, is fundamental to the design of Behler-Parrinello potentials. This exercise provides a concrete counterexample to demonstrate how a naive, non-invariant descriptor leads to unphysical, ordering-dependent energies, thereby motivating the use of sophisticated, permutation-invariant symmetry functions. ",
            "id": "3736707",
            "problem": "Consider three identical atoms of the same chemical species placed along a one-dimensional line at positions $x_1=-1\\,\\mathrm{\\AA}$, $x_2=0\\,\\mathrm{\\AA}$, and $x_3=1\\,\\mathrm{\\AA}$. In a physically correct model, the total energy of a system of identical atoms must be invariant under permutation of atom labels. Behler-Parrinello neural network potentials rely on atom-centered symmetry functions that are invariant under permutations, rotations, and translations to ensure this property. In this problem, you will demonstrate with a concrete counterexample how violating permutation invariance in the descriptor construction leads to non-physical ordering-dependent energies.\n\nDefine a non-permutation-invariant per-atom descriptor by fixing a global atom index order and, for each atom $i$, forming the vector $s_i=(r_{i1},r_{i2},r_{i3})$, where $r_{ij}=|x_i-x_j|$. Define the total energy as the sum of identical linear per-atom contributions $f(s_i)=\\mathbf{w}\\cdot s_i$, with $\\mathbf{w}=(\\alpha_1,\\alpha_2,\\alpha_3)$ and $\\alpha_k$ having units $\\mathrm{eV/\\AA}$. Use the specific weight values $\\alpha_1=0.10\\,\\mathrm{eV/\\AA}$, $\\alpha_2=-0.04\\,\\mathrm{eV/\\AA}$, and $\\alpha_3=0.07\\,\\mathrm{eV/\\AA}$.\n\nCompute the total energy $E$ for the original labeling $\\{1,2,3\\}$, then swap the labels of atoms $2$ and $3$ (while keeping their positions fixed) and compute the new total energy $E'$. Report the energy difference $E-E'$ to demonstrate the ordering dependence introduced by the non-permutation-invariant descriptor. Express the final energy difference in electronvolts (eV). Provide the exact value; no rounding is necessary.",
            "solution": "The problem requires a demonstration of the physical necessity for permutation invariance in atomistic potential energy functions, a cornerstone of models like Behler-Parrinello neural network potentials. We are tasked with analyzing a system of $3$ identical atoms described by an intentionally flawed, non-permutation-invariant descriptor, and calculating the resulting energy difference upon a permutation of atomic labels.\n\nFirst, we establish the initial state of the system. The $3$ atoms are assigned labels $\\{1, 2, 3\\}$ and are located at fixed one-dimensional positions $x_1 = -1$, $x_2 = 0$, and $x_3 = 1$. All positions are given in units of angstroms ($\\mathrm{\\AA}$).\n\nThe descriptor for each atom $i$ is defined as the ordered vector $s_i=(r_{i1}, r_{i2}, r_{i3})$, where $r_{ij}=|x_i-x_j|$ is the scalar distance between atom $i$ and atom $j$. We begin by computing all pairwise distances $r_{ij}$ for the initial labeling:\n$$r_{11} = |x_1 - x_1| = |-1 - (-1)| = 0$$\n$$r_{12} = |x_1 - x_2| = |-1 - 0| = 1$$\n$$r_{13} = |x_1 - x_3| = |-1 - 1| = 2$$\nBy the symmetry of the distance metric, $r_{ji}=r_{ij}$, which gives the remaining distances:\n$$r_{21} = 1, \\quad r_{22} = 0, \\quad r_{23} = |0 - 1| = 1$$\n$$r_{31} = 2, \\quad r_{32} = 1, \\quad r_{33} = 0$$\n\nUsing these distances, we construct the descriptor vector for each atom based on the fixed global ordering $(1, 2, 3)$:\n$$s_1 = (r_{11}, r_{12}, r_{13}) = (0, 1, 2)$$\n$$s_2 = (r_{21}, r_{22}, r_{23}) = (1, 0, 1)$$\n$$s_3 = (r_{31}, r_{32}, r_{33}) = (2, 1, 0)$$\n\nThe total energy $E$ is the sum of per-atom contributions $f(s_i) = \\mathbf{w} \\cdot s_i$, where the weight vector is $\\mathbf{w}=(\\alpha_1, \\alpha_2, \\alpha_3)$. The total energy is $E = \\sum_{i=1}^{3} f(s_i)$. We calculate the individual atomic energy contributions:\n$$f(s_1) = \\mathbf{w} \\cdot s_1 = \\alpha_1(0) + \\alpha_2(1) + \\alpha_3(2) = \\alpha_2 + 2\\alpha_3$$\n$$f(s_2) = \\mathbf{w} \\cdot s_2 = \\alpha_1(1) + \\alpha_2(0) + \\alpha_3(1) = \\alpha_1 + \\alpha_3$$\n$$f(s_3) = \\mathbf{w} \\cdot s_3 = \\alpha_1(2) + \\alpha_2(1) + \\alpha_3(0) = 2\\alpha_1 + \\alpha_2$$\n\nSumming these contributions yields the total energy $E$ for the original labeling:\n$$E = f(s_1) + f(s_2) + f(s_3) = (\\alpha_2 + 2\\alpha_3) + (\\alpha_1 + \\alpha_3) + (2\\alpha_1 + \\alpha_2) = 3\\alpha_1 + 2\\alpha_2 + 3\\alpha_3$$\n\nNext, we permute the labels of atoms $2$ and $3$, while their physical positions remain unchanged. The physical configuration is identical, but the new labeling assigns positions as follows:\n$$x'_1 = -1 \\quad (\\text{label } 1 \\text{ is unchanged})$$\n$$x'_2 = 1 \\quad (\\text{label } 2 \\text{ is now at the position previously of atom } 3)$$\n$$x'_3 = 0 \\quad (\\text{label } 3 \\text{ is now at the position previously of atom } 2)$$\n\nWe must re-evaluate the descriptors based on this new labeling. The pairwise distances $r'_{ij}=|x'_i-x'_j|$ are:\n$$r'_{11} = 0, \\quad r'_{12} = |x'_1 - x'_2| = |-1 - 1| = 2, \\quad r'_{13} = |x'_1 - x'_3| = |-1 - 0| = 1$$\n$$r'_{21} = 2, \\quad r'_{22} = 0, \\quad r'_{23} = |x'_2 - x'_3| = |1 - 0| = 1$$\n$$r'_{31} = 1, \\quad r'_{32} = 1, \\quad r'_{33} = 0$$\n\nThe new descriptor vectors $s'_i$ are:\n$$s'_1 = (r'_{11}, r'_{12}, r'_{13}) = (0, 2, 1)$$\n$$s'_2 = (r'_{21}, r'_{22}, r'_{23}) = (2, 0, 1)$$\n$$s'_3 = (r'_{31}, r'_{32}, r'_{33}) = (1, 1, 0)$$\n\nThe new per-atom energy contributions are:\n$$f(s'_1) = \\mathbf{w} \\cdot s'_1 = \\alpha_1(0) + \\alpha_2(2) + \\alpha_3(1) = 2\\alpha_2 + \\alpha_3$$\n$$f(s'_2) = \\mathbf{w} \\cdot s'_2 = \\alpha_1(2) + \\alpha_2(0) + \\alpha_3(1) = 2\\alpha_1 + \\alpha_3$$\n$$f(s'_3) = \\mathbf{w} \\cdot s'_3 = \\alpha_1(1) + \\alpha_2(1) + \\alpha_3(0) = \\alpha_1 + \\alpha_2$$\n\nThe new total energy $E'$ is the sum of these contributions:\n$$E' = f(s'_1) + f(s'_2) + f(s'_3) = (2\\alpha_2 + \\alpha_3) + (2\\alpha_1 + \\alpha_3) + (\\alpha_1 + \\alpha_2) = 3\\alpha_1 + 3\\alpha_2 + 2\\alpha_3$$\n\nThe problem asks for the energy difference $E - E'$. This difference quantifies the violation of permutation invariance:\n$$E - E' = (3\\alpha_1 + 2\\alpha_2 + 3\\alpha_3) - (3\\alpha_1 + 3\\alpha_2 + 2\\alpha_3)$$\n$$E - E' = (3\\alpha_1 - 3\\alpha_1) + (2\\alpha_2 - 3\\alpha_2) + (3\\alpha_3 - 2\\alpha_3)$$\n$$E - E' = -\\alpha_2 + \\alpha_3$$\n\nA non-zero difference confirms that the total energy depends on the arbitrary labeling of identical atoms, a non-physical artifact. A physically correct potential must be invariant with respect to the exchange of identical particles, meaning $E-E'$ must be zero for any permutation.\n\nFinally, we substitute the specified numerical values for the weights: $\\alpha_2=-0.04\\,\\mathrm{eV/\\AA}$ and $\\alpha_3=0.07\\,\\mathrm{eV/\\AA}$. The distances are in $\\mathrm{\\AA}$, so the resulting energy difference is in $\\mathrm{eV}$.\n$$E - E' = \\alpha_3 - \\alpha_2 = 0.07 - (-0.04) = 0.07 + 0.04 = 0.11$$\nThe value is exact.",
            "answer": "$$\\boxed{0.11}$$"
        },
        {
            "introduction": "Once the necessity of permutation invariance is established, the next challenge is to construct a descriptor that is not only invariant but also unique for distinct local environments. A descriptor that assigns the same \"fingerprint\" to physically different atomic arrangements will inevitably lead to an inaccurate potential energy surface. This practice illustrates a critical limitation of purely radial descriptors, showing how they fail to distinguish between two different coordination geometries and thus highlighting the essential role of angular symmetry functions in creating a complete representation of the local chemical environment. ",
            "id": "3736681",
            "problem": "Consider the Behler–Parrinello (BP) neural network potential framework, where the total energy is decomposed into a sum of local atomic energies, each of which is modeled as a function of atom-centered symmetry functions (descriptors) that depend on the local environment. In a simplified model, let the local descriptor of a central atom be restricted to the two-body radial BP symmetry functions only, defined as\n$$\nG_{2}^{(\\mu)}(i) \\;=\\; \\sum_{j \\neq i} \\exp\\!\\big(-\\eta_{\\mu}\\,(r_{ij}-R_{s,\\mu})^{2}\\big)\\, f_{c}(r_{ij}),\n$$\nwhere $r_{ij}$ is the distance between the central atom $i$ and neighbor $j$, $\\eta_{\\mu} > 0$ and $R_{s,\\mu} \\geq 0$ are tunable parameters, and $f_{c}(r)$ is a smooth cutoff function,\n$$\nf_{c}(r) \\;=\\; \\begin{cases}\n\\frac{1}{2}\\Big(\\cos\\!\\big(\\frac{\\pi r}{R_{c}}\\big) + 1\\Big), & r \\leq R_{c}, \\\\ [4pt]\n0, & r > R_{c},\n\\end{cases}\n$$\nwith cutoff radius $R_{c} > 0$. Assume all neighbors are of the same chemical species as the central atom and that $R_{c} = 6.0$ in angstrom units.\n\nConstruct the following two distinct local geometries of the central atom at the origin, each with exactly four neighbors at distance $2.0$ angstroms from the origin:\n- Geometry $\\mathcal{A}$: neighbors at positions $(2.0,0,0)$, $(-2.0,0,0)$, $(0,2.0,0)$, $(0,-2.0,0)$ (a square-planar arrangement).\n- Geometry $\\mathcal{B}$: neighbors at positions $\\frac{2.0}{\\sqrt{3}}(1,1,1)$, $\\frac{2.0}{\\sqrt{3}}(1,-1,-1)$, $\\frac{2.0}{\\sqrt{3}}(-1,1,-1)$, $\\frac{2.0}{\\sqrt{3}}(-1,-1,1)$ (a regular tetrahedral arrangement scaled to radius $2.0$).\n\nUse the following two radial functions to define a two-component descriptor vector for the central atom,\n$$\n\\boldsymbol{G}(i) \\;=\\; \\big(G_{2}^{(1)}(i),\\, G_{2}^{(2)}(i)\\big),\n$$\nwith parameters\n$$\n\\eta_{1} = 1.0,\\quad R_{s,1} = 2.0,\\qquad \\eta_{2} = 1.0,\\quad R_{s,2} = 3.0,\\qquad R_{c} = 6.0,\n$$\nwhere all numerical values are in angstrom-based units and inverse-square angstroms as appropriate to render the exponent dimensionless.\n\nStarting from the given definitions, compute the Euclidean norm of the difference between the descriptor vectors of geometries $\\mathcal{A}$ and $\\mathcal{B}$ for the central atom,\n$$\nD \\;=\\; \\big\\|\\boldsymbol{G}_{\\mathcal{A}}(i) - \\boldsymbol{G}_{\\mathcal{B}}(i)\\big\\|_{2}.\n$$\nExpress the final distance as a pure number (unitless). No rounding requirement applies if you obtain an exact value; if your result is non-exact, round your answer to four significant figures. This calculation serves as a counterexample illustrating that a limited descriptor set can map distinct local geometries to nearly identical feature vectors, potentially leading to error-prone predictions.",
            "solution": "The Behler–Parrinello (BP) neural network potential represents the total energy as a sum of local contributions, each depending on atom-centered symmetry functions designed to be invariant under translation, rotation, and permutation of identical atoms. In this problem, we restrict attention to the radial two-body symmetry functions,\n$$\nG_{2}^{(\\mu)}(i) \\;=\\; \\sum_{j \\neq i} \\exp\\!\\big(-\\eta_{\\mu}\\,(r_{ij}-R_{s,\\mu})^{2}\\big)\\, f_{c}(r_{ij}),\n$$\nwith cutoff\n$$\nf_{c}(r) \\;=\\; \\frac{1}{2}\\Big(\\cos\\!\\big(\\frac{\\pi r}{R_{c}}\\big) + 1\\Big), \\quad \\text{for } r \\leq R_{c},\n$$\nand $f_{c}(r) = 0$ otherwise. By construction, $G_{2}^{(\\mu)}(i)$ depends only on pairwise distances $\\{r_{ij}\\}$ within the cutoff and is blind to angular arrangements among neighbors. Therefore, any two local geometries that share exactly the same multiset of neighbor distances will yield identical values of every $G_{2}^{(\\mu)}(i)$, independent of how neighbors are oriented relative to one another.\n\nWe are given two distinct geometries of four neighbors around the origin: geometry $\\mathcal{A}$ (square-planar arrangement in the $x$-$y$ plane) and geometry $\\mathcal{B}$ (regular tetrahedral arrangement). The positions are chosen so that in both geometries each neighbor lies at distance $r_{ij} = 2.0$ from the origin. This can be verified explicitly:\n- In geometry $\\mathcal{A}$, the positions $(\\pm 2.0, 0, 0)$ and $(0, \\pm 2.0, 0)$ have Euclidean norm $\\sqrt{(2.0)^{2} + 0 + 0} = 2.0$.\n- In geometry $\\mathcal{B}$, each position is of the form $\\frac{2.0}{\\sqrt{3}}(x, y, z)$ with $(x, y, z) \\in \\{(1,1,1), (1,-1,-1), (-1,1,-1), (-1,-1,1)\\}$. The Euclidean norm is\n$$\n\\left\\|\\frac{2.0}{\\sqrt{3}}(x, y, z)\\right\\| \\;=\\; \\frac{2.0}{\\sqrt{3}} \\sqrt{x^{2} + y^{2} + z^{2}} \\;=\\; \\frac{2.0}{\\sqrt{3}} \\sqrt{3} \\;=\\; 2.0.\n$$\n\nBecause $R_{c} = 6.0$ and every neighbor lies within the cutoff ($2.0 \\leq 6.0$), we can compute the cutoff value at $r = 2.0$,\n$$\nf_{c}(2.0) \\;=\\; \\frac{1}{2}\\Big(\\cos\\!\\big(\\frac{\\pi \\cdot 2.0}{6.0}\\big) + 1\\Big) \\;=\\; \\frac{1}{2}\\Big(\\cos\\!\\big(\\frac{\\pi}{3}\\big) + 1\\Big) \\;=\\; \\frac{1}{2}\\Big(\\frac{1}{2} + 1\\Big) \\;=\\; \\frac{3}{4}.\n$$\n\nWe now evaluate the two radial symmetry functions for any geometry that has four neighbors at $r_{ij} = 2.0$:\n1. For $\\mu = 1$, the parameters are $\\eta_{1} = 1.0$ and $R_{s,1} = 2.0$. Thus,\n$$\nG_{2}^{(1)}(i) \\;=\\; \\sum_{j=1}^{4} \\exp\\!\\big(-1.0\\,(2.0 - 2.0)^{2}\\big)\\, f_{c}(2.0)\n\\;=\\; \\sum_{j=1}^{4} \\exp(0)\\, \\frac{3}{4}\n\\;=\\; 4 \\cdot 1 \\cdot \\frac{3}{4}\n\\;=\\; 3.\n$$\n\n2. For $\\mu = 2$, the parameters are $\\eta_{2} = 1.0$ and $R_{s,2} = 3.0$. Thus,\n$$\nG_{2}^{(2)}(i) \\;=\\; \\sum_{j=1}^{4} \\exp\\!\\big(-1.0\\,(2.0 - 3.0)^{2}\\big)\\, f_{c}(2.0)\n\\;=\\; \\sum_{j=1}^{4} \\exp(-1)\\, \\frac{3}{4}\n\\;=\\; 4 \\cdot \\exp(-1) \\cdot \\frac{3}{4}\n\\;=\\; 3\\,\\exp(-1).\n$$\n\nThese expressions depend only on the distances and not on the angular arrangement. Therefore, for both geometries $\\mathcal{A}$ and $\\mathcal{B}$, the descriptor vectors are identical:\n$$\n\\boldsymbol{G}_{\\mathcal{A}}(i) \\;=\\; \\big(3,\\; 3\\,\\exp(-1)\\big),\\qquad\n\\boldsymbol{G}_{\\mathcal{B}}(i) \\;=\\; \\big(3,\\; 3\\,\\exp(-1)\\big).\n$$\n\nThe Euclidean norm of the difference is\n$$\nD \\;=\\; \\big\\|\\boldsymbol{G}_{\\mathcal{A}}(i) - \\boldsymbol{G}_{\\mathcal{B}}(i)\\big\\|_{2}\n\\;=\\; \\sqrt{\\big(3 - 3\\big)^{2} + \\big(3\\,\\exp(-1) - 3\\,\\exp(-1)\\big)^{2}}\n\\;=\\; \\sqrt{0^{2} + 0^{2}}\n\\;=\\; 0.\n$$\n\nThis explicit calculation constructs a counterexample: two physically distinct local geometries (square-planar versus tetrahedral) that produce identical radial BP descriptor vectors when the descriptor set is limited to two-body radial functions. As a consequence, a neural network model relying only on such limited descriptors cannot distinguish these environments and may yield error-prone predictions for properties that do depend on angular information.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Behler-Parrinello potentials are most powerful when applied to condensed-phase systems, which are typically modeled using periodic boundary conditions (PBC) to simulate an infinite material. Within this framework, calculating the distance between two atoms requires finding the shortest separation among all their periodic images, a procedure known as the minimum image convention (MIC). This exercise connects the abstract definition of symmetry functions to their practical implementation, guiding you through the correct application of the MIC and the subsequent calculation of a radial symmetry function value in a periodic system. ",
            "id": "3736655",
            "problem": "A system of atoms is simulated under periodic boundary conditions in a simple cubic cell. In such a setting, the displacement between two atoms must be mapped to the nearest periodic image to ensure that computed distances reflect the shortest interatomic separation consistent with translational invariance. Starting from the definition of periodic boundary conditions as equivalence under lattice translations and the geometric requirement that interatomic distances be computed between nearest images, derive a minimum-image mapping for an orthorhombic cell that transforms a raw displacement vector into its nearest-image counterpart in each Cartesian component. Then, explain how the resulting neighbor set determined by a spherical cutoff influences the inputs to Behler-Parrinello neural network (BPNN) potentials via their symmetry functions.\n\nAfter you derive the minimum-image mapping and the neighbor selection rule, apply them to the following concrete case to compute a Behler-Parrinello radial symmetry function for a reference atom. Consider a cubic box of edge length $L = 10\\,\\mathrm{\\AA}$ with five other atoms and a reference atom located at the following positions (all coordinates are given in $\\mathrm{\\AA}$):\n- Reference atom $i$: $\\boldsymbol{r}_i = (1.0,\\,1.0,\\,1.0)$,\n- Atom $1$: $\\boldsymbol{r}_1 = (9.2,\\,1.1,\\,1.0)$,\n- Atom $2$: $\\boldsymbol{r}_2 = (1.0,\\,8.9,\\,9.8)$,\n- Atom $3$: $\\boldsymbol{r}_3 = (5.0,\\,5.0,\\,5.0)$,\n- Atom $4$: $\\boldsymbol{r}_4 = (3.0,\\,9.8,\\,1.0)$,\n- Atom $5$: $\\boldsymbol{r}_5 = (9.8,\\,9.8,\\,9.8)$.\n\nUsing the minimum image convention, determine the set of neighbors of atom $i$ within the spherical cutoff radius $R_c = 6.0\\,\\mathrm{\\AA}$ and compute the corresponding nearest-image distances $R_{ij}$ for each neighbor $j$. Then evaluate the Behler-Parrinello radial symmetry function\n$$\nG_i^{(2)} \\;=\\; \\sum_{j \\neq i} \\exp\\!\\big(-\\eta\\,[R_{ij} - R_s]^{2}\\big)\\,f_c(R_{ij}) \\,,\n$$\nwith the cosine cutoff\n$$\nf_c(R) \\;=\\; \\begin{cases}\n\\dfrac{1}{2}\\,\\big[\\cos\\!\\big(\\pi R / R_c\\big) + 1\\big] , & R \\le R_c, \\\\ [6pt]\n0, & R > R_c,\n\\end{cases}\n$$\nusing parameters $\\eta = 1.0\\,\\mathrm{\\AA}^{-2}$ and $R_s = 2.0\\,\\mathrm{\\AA}$. Report $G_i^{(2)}$ as a dimensionless scalar and round your answer to four significant figures.",
            "solution": "The problem is approached in two stages. First, a general derivation of the minimum-image mapping is provided, followed by an explanation of its role in the context of Behler-Parrinello neural network (BPNN) potentials. Second, this framework is applied to the specific numerical case provided to compute the radial symmetry function $G_i^{(2)}$.\n\n### Part 1: Derivation and Conceptual Explanation\n\n#### Minimum Image Convention (MIC)\n\nIn a simulation employing periodic boundary conditions (PBC), the simulation cell is replicated infinitely in all spatial dimensions, forming a lattice. For an orthorhombic cell, the lattice vectors are orthogonal: $\\boldsymbol{L}_x = (L_x, 0, 0)$, $\\boldsymbol{L}_y = (0, L_y, 0)$, and $\\boldsymbol{L}_z = (0, 0, L_z)$. An atom at position $\\boldsymbol{r}$ has periodic images at all positions $\\boldsymbol{r}' = \\boldsymbol{r} + n_x\\boldsymbol{L}_x + n_y\\boldsymbol{L}_y + n_z\\boldsymbol{L}_z$, where $n_x, n_y, n_z$ are any integers.\n\nThe interaction between two atoms, $i$ at $\\boldsymbol{r}_i$ and $j$ at $\\boldsymbol{r}_j$, is calculated based on the shortest distance between atom $i$ and any of the periodic images of atom $j$. This is the minimum image convention. The raw displacement vector is $\\Delta\\boldsymbol{r}_{ij} = \\boldsymbol{r}_j - \\boldsymbol{r}_i = (\\Delta x, \\Delta y, \\Delta z)$. The displacement vector from atom $i$ to a periodic image of atom $j$ is given by $\\Delta\\boldsymbol{r}_{ij} - n_x\\boldsymbol{L}_x - n_y\\boldsymbol{L}_y - n_z\\boldsymbol{L}_z$. The objective is to find the integers $(n_x, n_y, n_z)$ that minimize the magnitude of this vector.\n\nThe squared magnitude is given by:\n$$d^2(n_x, n_y, n_z) = |\\Delta\\boldsymbol{r}_{ij} - n_x\\boldsymbol{L}_x - n_y\\boldsymbol{L}_y - n_z\\boldsymbol{L}_z|^2 = (\\Delta x - n_x L_x)^2 + (\\Delta y - n_y L_y)^2 + (\\Delta z - n_z L_z)^2$$\nSince the Cartesian components are orthogonal and independent, we can minimize each term separately. To minimize $(\\Delta x - n_x L_x)^2$, we must choose the integer $n_x$ that makes $n_x L_x$ closest to $\\Delta x$. This is achieved by choosing $n_x$ to be the nearest integer to the ratio $\\Delta x / L_x$. We denote this as $n_x = \\text{round}(\\Delta x / L_x)$.\n\nThe minimum-image displacement vector, $\\Delta\\boldsymbol{r}'_{ij} = (\\Delta x', \\Delta y', \\Delta z')$, is therefore obtained by applying this mapping to each component:\n$$ \\Delta x' = \\Delta x - L_x \\cdot \\text{round}\\left(\\frac{\\Delta x}{L_x}\\right) $$\n$$ \\Delta y' = \\Delta y - L_y \\cdot \\text{round}\\left(\\frac{\\Delta y}{L_y}\\right) $$\n$$ \\Delta z' = \\Delta z - L_z \\cdot \\text{round}\\left(\\frac{\\Delta z}{L_z}\\right) $$\nThis transformation ensures that each component of the resulting vector lies in the interval $[-L_\\alpha/2, L_\\alpha/2]$. The nearest-image distance is then $R_{ij} = \\sqrt{(\\Delta x')^2 + (\\Delta y')^2 + (\\Delta z')^2}$.\n\n#### Influence on Behler-Parrinello Neural Network Potentials\n\nBPNN potentials describe the potential energy of a system as a sum of atomic energy contributions, $E = \\sum_i E_i$. Each atomic energy $E_i$ is determined by the local chemical environment of atom $i$, which is fed to a dedicated neural network for that element.\n\nTo ensure that the energy is invariant to translation, rotation, and permutation of identical atoms, the local environment is not described by raw Cartesian coordinates. Instead, it is encoded into a vector of \"symmetry functions\" $\\{G_i\\}$. These functions are constructed from the relative positions of neighboring atoms.\n\nThe first crucial step in calculating these symmetry functions is to determine the set of neighbors for atom $i$. This is done by identifying all atoms $j$ whose nearest-image distance $R_{ij}$ (calculated using the MIC) is less than a predefined cutoff radius $R_c$. Atoms with $R_{ij} \\ge R_c$ are excluded.\n\nThe set of nearest-image distances $\\{R_{ij}\\}$ and angles $\\{\\theta_{ijk}\\}$ for all neighbors within the cutoff sphere forms the direct input for the symmetry functions. For example, the radial symmetry function $G_i^{(2)}$ given in the problem is a sum over all neighbors $j$ within the cutoff.\n\nTherefore, the MIC and the choice of $R_c$ are fundamental. They define the \"neighbor list\" and the geometric information that the BPNN uses to \"see\" the local environment. An incorrect application of PBC, or neglecting the MIC, would result in distances that do not reflect the true periodic nature of the system, leading to unphysical boundary effects and a failure to learn a meaningful and translationally invariant potential energy surface.\n\n### Part 2: Specific Calculation\n\nWe are given a cubic simulation box with side length $L = 10.0\\,\\mathrm{\\AA}$. The half-length of the box is $L/2 = 5.0\\,\\mathrm{\\AA}$. The cutoff radius is $R_c = 6.0\\,\\mathrm{\\AA}$. The reference atom is $i$ at $\\boldsymbol{r}_i = (1.0, 1.0, 1.0)$. The symmetry function parameters are $\\eta = 1.0\\,\\mathrm{\\AA}^{-2}$ and $R_s = 2.0\\,\\mathrm{\\AA}$.\n\nWe will now calculate the nearest-image distance $R_{ij}$ for each atom $j \\in \\{1, 2, 3, 4, 5\\}$ and determine if it is a neighbor of atom $i$.\n\n**Atom 1:** $\\boldsymbol{r}_1 = (9.2, 1.1, 1.0)$\n- Raw displacement: $\\Delta\\boldsymbol{r}_{i1} = \\boldsymbol{r}_1 - \\boldsymbol{r}_i = (9.2-1.0, 1.1-1.0, 1.0-1.0) = (8.2, 0.1, 0.0)$.\n- Apply MIC: $\\Delta x = 8.2 > 5.0$, so $\\Delta x' = 8.2 - 10.0 = -1.8$. Other components are unchanged.\n- Nearest-image vector: $\\Delta\\boldsymbol{r}'_{i1} = (-1.8, 0.1, 0.0)$.\n- Nearest-image distance: $R_{i1} = \\sqrt{(-1.8)^2 + (0.1)^2 + (0.0)^2} = \\sqrt{3.24 + 0.01} = \\sqrt{3.25} \\approx 1.8028\\,\\mathrm{\\AA}$.\n- Since $R_{i1} < R_c = 6.0\\,\\mathrm{\\AA}$, atom $1$ is a neighbor.\n\n**Atom 2:** $\\boldsymbol{r}_2 = (1.0, 8.9, 9.8)$\n- Raw displacement: $\\Delta\\boldsymbol{r}_{i2} = \\boldsymbol{r}_2 - \\boldsymbol{r}_i = (1.0-1.0, 8.9-1.0, 9.8-1.0) = (0.0, 7.9, 8.8)$.\n- Apply MIC: $\\Delta y = 7.9 > 5.0 \\Rightarrow \\Delta y' = 7.9 - 10.0 = -2.1$. $\\Delta z = 8.8 > 5.0 \\Rightarrow \\Delta z' = 8.8 - 10.0 = -1.2$.\n- Nearest-image vector: $\\Delta\\boldsymbol{r}'_{i2} = (0.0, -2.1, -1.2)$.\n- Nearest-image distance: $R_{i2} = \\sqrt{(0.0)^2 + (-2.1)^2 + (-1.2)^2} = \\sqrt{4.41 + 1.44} = \\sqrt{5.85} \\approx 2.4187\\,\\mathrm{\\AA}$.\n- Since $R_{i2} < R_c = 6.0\\,\\mathrm{\\AA}$, atom $2$ is a neighbor.\n\n**Atom 3:** $\\boldsymbol{r}_3 = (5.0, 5.0, 5.0)$\n- Raw displacement: $\\Delta\\boldsymbol{r}_{i3} = \\boldsymbol{r}_3 - \\boldsymbol{r}_i = (5.0-1.0, 5.0-1.0, 5.0-1.0) = (4.0, 4.0, 4.0)$.\n- Apply MIC: All components have magnitude $\\le 5.0$. No correction is needed.\n- Nearest-image vector: $\\Delta\\boldsymbol{r}'_{i3} = (4.0, 4.0, 4.0)$.\n- Nearest-image distance: $R_{i3} = \\sqrt{4.0^2 + 4.0^2 + 4.0^2} = \\sqrt{16+16+16} = \\sqrt{48} \\approx 6.9282\\,\\mathrm{\\AA}$.\n- Since $R_{i3} > R_c = 6.0\\,\\mathrm{\\AA}$, atom $3$ is not a neighbor.\n\n**Atom 4:** $\\boldsymbol{r}_4 = (3.0, 9.8, 1.0)$\n- Raw displacement: $\\Delta\\boldsymbol{r}_{i4} = \\boldsymbol{r}_4 - \\boldsymbol{r}_i = (3.0-1.0, 9.8-1.0, 1.0-1.0) = (2.0, 8.8, 0.0)$.\n- Apply MIC: $\\Delta y = 8.8 > 5.0 \\Rightarrow \\Delta y' = 8.8 - 10.0 = -1.2$.\n- Nearest-image vector: $\\Delta\\boldsymbol{r}'_{i4} = (2.0, -1.2, 0.0)$.\n- Nearest-image distance: $R_{i4} = \\sqrt{2.0^2 + (-1.2)^2 + (0.0)^2} = \\sqrt{4.0 + 1.44} = \\sqrt{5.44} \\approx 2.3324\\,\\mathrm{\\AA}$.\n- Since $R_{i4} < R_c = 6.0\\,\\mathrm{\\AA}$, atom $4$ is a neighbor.\n\n**Atom 5:** $\\boldsymbol{r}_5 = (9.8, 9.8, 9.8)$\n- Raw displacement: $\\Delta\\boldsymbol{r}_{i5} = \\boldsymbol{r}_5 - \\boldsymbol{r}_i = (9.8-1.0, 9.8-1.0, 9.8-1.0) = (8.8, 8.8, 8.8)$.\n- Apply MIC: All components are $> 5.0$. $\\Delta x' = 8.8-10.0 = -1.2$, $\\Delta y' = 8.8-10.0 = -1.2$, $\\Delta z' = 8.8-10.0 = -1.2$.\n- Nearest-image vector: $\\Delta\\boldsymbol{r}'_{i5} = (-1.2, -1.2, -1.2)$.\n- Nearest-image distance: $R_{i5} = \\sqrt{(-1.2)^2 + (-1.2)^2 + (-1.2)^2} = \\sqrt{1.44 \\times 3} = \\sqrt{4.32} \\approx 2.0785\\,\\mathrm{\\AA}$.\n- Since $R_{i5} < R_c = 6.0\\,\\mathrm{\\AA}$, atom $5$ is a neighbor.\n\nThe neighbors of atom $i$ are atoms $1$, $2$, $4$, and $5$. We now compute the contribution of each neighbor to $G_i^{(2)} = \\sum_{j \\neq i} \\exp(-\\eta[R_{ij} - R_s]^{2})\\,f_c(R_{ij})$.\n\nLet $T_j$ be the term for neighbor $j$: $T_j = \\exp(-(R_{ij} - 2.0)^2) \\cdot \\frac{1}{2} [\\cos(\\pi R_{ij} / 6.0) + 1]$.\n\n- **Term for atom 1 ($R_{i1} \\approx 1.8028\\,\\mathrm{\\AA}$):**\n  $T_1 = \\exp(-(1.8028 - 2.0)^2) \\times 0.5 \\times [\\cos(\\pi \\cdot 1.8028 / 6.0) + 1] \\approx \\exp(-0.03889) \\times 0.5 \\times [\\cos(0.9439) + 1] \\approx 0.96185 \\times 0.5 \\times [0.58797 + 1] \\approx 0.76371$.\n\n- **Term for atom 2 ($R_{i2} \\approx 2.4187\\,\\mathrm{\\AA}$):**\n  $T_2 = \\exp(-(2.4187 - 2.0)^2) \\times 0.5 \\times [\\cos(\\pi \\cdot 2.4187 / 6.0) + 1] \\approx \\exp(-0.1753) \\times 0.5 \\times [\\cos(1.2664) + 1] \\approx 0.83921 \\times 0.5 \\times [0.29938 + 1] \\approx 0.54523$.\n\n- **Term for atom 4 ($R_{i4} \\approx 2.3324\\,\\mathrm{\\AA}$):**\n  $T_4 = \\exp(-(2.3324 - 2.0)^2) \\times 0.5 \\times [\\cos(\\pi \\cdot 2.3324 / 6.0) + 1] \\approx \\exp(-0.1105) \\times 0.5 \\times [\\cos(1.2212) + 1] \\approx 0.89540 \\times 0.5 \\times [0.34247 + 1] \\approx 0.60098$.\n\n- **Term for atom 5 ($R_{i5} \\approx 2.0785\\,\\mathrm{\\AA}$):**\n  $T_5 = \\exp(-(2.0785 - 2.0)^2) \\times 0.5 \\times [\\cos(\\pi \\cdot 2.0785 / 6.0) + 1] \\approx \\exp(-0.00616) \\times 0.5 \\times [\\cos(1.0883) + 1] \\approx 0.99386 \\times 0.5 \\times [0.46363 + 1] \\approx 0.72738$.\n\nFinally, we sum the contributions:\n$G_i^{(2)} = T_1 + T_2 + T_4 + T_5 \\approx 0.76371 + 0.54523 + 0.60098 + 0.72738 = 2.6373$.\n\nRounding to four significant figures, the result is $2.637$.",
            "answer": "$$\\boxed{2.637}$$"
        }
    ]
}