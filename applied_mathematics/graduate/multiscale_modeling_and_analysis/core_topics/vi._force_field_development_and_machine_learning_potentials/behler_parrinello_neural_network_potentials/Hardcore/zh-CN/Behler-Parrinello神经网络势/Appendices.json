{
    "hands_on_practices": [
        {
            "introduction": "物理学的一个基本原则是全同粒子是不可区分的，这意味着交换任意两个相同类型原子的标签，系统的总能量必须保持不变。本练习将通过一个具体反例，展示一个非置换不变的描述符如何导致依赖于原子任意标记的、非物理的能量结果。通过这个练习，你将深刻理解为何Behler-Parrinello势函数必须依赖于精心设计的、具有置换不变性的对称函数 。",
            "id": "3736707",
            "problem": "考虑三个相同化学物种的相同原子，沿着一维直线放置在位置 $x_1=-1\\,\\mathrm{\\AA}$、$x_2=0\\,\\mathrm{\\AA}$ 和 $x_3=1\\,\\mathrm{\\AA}$。在物理上正确的模型中，相同原子系统的总能量必须在原子标签的排列下保持不变。Behler-Parrinello 神经网络势依赖于以原子为中心的、在排列、旋转和平移下不变的对称函数来确保这一性质。在本问题中，你将通过一个具体的反例来证明，在描述符构建中违反排列不变性如何导致与排序相关的非物理能量。\n\n通过固定全局原子索引顺序，并对每个原子 $i$ 形成向量 $s_i=(r_{i1},r_{i2},r_{i3})$（其中 $r_{ij}=|x_i-x_j|$），来定义一个非排列不变的单原子描述符。将总能量定义为相同的线性单原子贡献之和 $f(s_i)=\\mathbf{w}\\cdot s_i$，其中 $\\mathbf{w}=(\\alpha_1,\\alpha_2,\\alpha_3)$，且 $\\alpha_k$ 的单位为 $\\mathrm{eV/\\AA}$。使用具体的权重值 $\\alpha_1=0.10\\,\\mathrm{eV/\\AA}$、$\\alpha_2=-0.04\\,\\mathrm{eV/\\AA}$ 和 $\\alpha_3=0.07\\,\\mathrm{eV/\\AA}$。\n\n计算原始标签 $\\{1,2,3\\}$ 的总能量 $E$，然后交换原子 $2$ 和 $3$ 的标签（同时保持它们的位置不变），并计算新的总能量 $E'$。报告能量差 $E-E'$，以证明由非排列不变描述符引入的排序依赖性。以电子伏特（eV）为单位表示最终的能量差。提供精确值，无需四舍五入。",
            "solution": "本问题要求证明原子势能函数中排列不变性的物理必要性，这是像 Behler-Parrinello 神经网络势这类模型的基石。我们的任务是分析一个由3个相同原子组成的系统，该系统由一个故意设计有缺陷的、非排列不变的描述符来描述，并计算原子标签排列后产生的能量差。\n\n首先，我们确定系统的初始状态。这3个原子被赋予标签 $\\{1, 2, 3\\}$，并位于固定的一维位置 $x_1 = -1$、$x_2 = 0$ 和 $x_3 = 1$。所有位置的单位均为埃（$\\mathrm{\\AA}$）。\n\n每个原子 $i$ 的描述符被定义为有序向量 $s_i=(r_{i1}, r_{i2}, r_{i3})$，其中 $r_{ij}=|x_i-x_j|$ 是原子 $i$ 和原子 $j$ 之间的标量距离。我们首先为初始标签计算所有配对距离 $r_{ij}$：\n$$r_{11} = |x_1 - x_1| = |-1 - (-1)| = 0$$\n$$r_{12} = |x_1 - x_2| = |-1 - 0| = 1$$\n$$r_{13} = |x_1 - x_3| = |-1 - 1| = 2$$\n根据距离度量的对称性，$r_{ji}=r_{ij}$，这给出了剩余的距离：\n$$r_{21} = 1, \\quad r_{22} = 0, \\quad r_{23} = |0 - 1| = 1$$\n$$r_{31} = 2, \\quad r_{32} = 1, \\quad r_{33} = 0$$\n\n使用这些距离，我们根据固定的全局顺序 $(1, 2, 3)$ 构建每个原子的描述符向量：\n$$s_1 = (r_{11}, r_{12}, r_{13}) = (0, 1, 2)$$\n$$s_2 = (r_{21}, r_{22}, r_{23}) = (1, 0, 1)$$\n$$s_3 = (r_{31}, r_{32}, r_{33}) = (2, 1, 0)$$\n\n总能量 $E$ 是单原子贡献 $f(s_i) = \\mathbf{w} \\cdot s_i$ 的总和，其中权重向量为 $\\mathbf{w}=(\\alpha_1, \\alpha_2, \\alpha_3)$。总能量为 $E = \\sum_{i=1}^{3} f(s_i)$。我们计算各个原子的能量贡献：\n$$f(s_1) = \\mathbf{w} \\cdot s_1 = \\alpha_1(0) + \\alpha_2(1) + \\alpha_3(2) = \\alpha_2 + 2\\alpha_3$$\n$$f(s_2) = \\mathbf{w} \\cdot s_2 = \\alpha_1(1) + \\alpha_2(0) + \\alpha_3(1) = \\alpha_1 + \\alpha_3$$\n$$f(s_3) = \\mathbf{w} \\cdot s_3 = \\alpha_1(2) + \\alpha_2(1) + \\alpha_3(0) = 2\\alpha_1 + \\alpha_2$$\n\n将这些贡献相加，得到原始标签的总能量 $E$：\n$$E = f(s_1) + f(s_2) + f(s_3) = (\\alpha_2 + 2\\alpha_3) + (\\alpha_1 + \\alpha_3) + (2\\alpha_1 + \\alpha_2) = 3\\alpha_1 + 2\\alpha_2 + 3\\alpha_3$$\n\n接下来，我们交换原子 $2$ 和 $3$ 的标签，而它们的物理位置保持不变。物理构型是相同的，但新的标签分配的位置如下：\n$$x'_1 = -1 \\quad (\\text{标签 } 1 \\text{ 不变})$$\n$$x'_2 = 1 \\quad (\\text{标签 } 2 \\text{ 现在位于原子 } 3 \\text{ 先前的位置})$$\n$$x'_3 = 0 \\quad (\\text{标签 } 3 \\text{ 现在位于原子 } 2 \\text{ 先前的位置})$$\n\n我们必须根据这个新标签重新评估描述符。配对距离 $r'_{ij}=|x'_i-x'_j|$ 为：\n$$r'_{11} = 0, \\quad r'_{12} = |x'_1 - x'_2| = |-1 - 1| = 2, \\quad r'_{13} = |x'_1 - x'_3| = |-1 - 0| = 1$$\n$$r'_{21} = 2, \\quad r'_{22} = 0, \\quad r'_{23} = |x'_2 - x'_3| = |1 - 0| = 1$$\n$$r'_{31} = 1, \\quad r'_{32} = 1, \\quad r'_{33} = 0$$\n\n新的描述符向量 $s'_i$ 为：\n$$s'_1 = (r'_{11}, r'_{12}, r'_{13}) = (0, 2, 1)$$\n$$s'_2 = (r'_{21}, r'_{22}, r'_{23}) = (2, 0, 1)$$\n$$s'_3 = (r'_{31}, r'_{32}, r'_{33}) = (1, 1, 0)$$\n\n新的单原子能量贡献为：\n$$f(s'_1) = \\mathbf{w} \\cdot s'_1 = \\alpha_1(0) + \\alpha_2(2) + \\alpha_3(1) = 2\\alpha_2 + \\alpha_3$$\n$$f(s'_2) = \\mathbf{w} \\cdot s'_2 = \\alpha_1(2) + \\alpha_2(0) + \\alpha_3(1) = 2\\alpha_1 + \\alpha_3$$\n$$f(s'_3) = \\mathbf{w} \\cdot s'_3 = \\alpha_1(1) + \\alpha_2(1) + \\alpha_3(0) = \\alpha_1 + \\alpha_2$$\n\n新的总能量 $E'$ 是这些贡献的总和：\n$$E' = f(s'_1) + f(s'_2) + f(s'_3) = (2\\alpha_2 + \\alpha_3) + (2\\alpha_1 + \\alpha_3) + (\\alpha_1 + \\alpha_2) = 3\\alpha_1 + 3\\alpha_2 + 2\\alpha_3$$\n\n问题要求计算能量差 $E - E'$。这个差值量化了对排列不变性的违反程度：\n$$E - E' = (3\\alpha_1 + 2\\alpha_2 + 3\\alpha_3) - (3\\alpha_1 + 3\\alpha_2 + 2\\alpha_3)$$\n$$E - E' = (3\\alpha_1 - 3\\alpha_1) + (2\\alpha_2 - 3\\alpha_2) + (3\\alpha_3 - 2\\alpha_3)$$\n$$E - E' = -\\alpha_2 + \\alpha_3$$\n\n一个非零的差值证实了总能量依赖于相同原子的任意标签，这是一个非物理的人为结果。一个物理上正确的势能必须在相同粒子的交换下保持不变，这意味着对于任何排列，$E-E'$ 都必须为零。\n\n最后，我们代入指定的权重数值：$\\alpha_2=-0.04\\,\\mathrm{eV/\\AA}$ 和 $\\alpha_3=0.07\\,\\mathrm{eV/\\AA}$。距离单位为 $\\mathrm{\\AA}$，因此得到的能量差单位为 $\\mathrm{eV}$。\n$$E - E' = \\alpha_3 - \\alpha_2 = 0.07 - (-0.04) = 0.07 + 0.04 = 0.11$$\n该值为精确值。",
            "answer": "$$\\boxed{0.11}$$"
        },
        {
            "introduction": "在建立了对称函数不变性的重要性之后，我们转向其在实际计算中的应用。大多数材料模拟采用周期性边界条件来近似无限大的块状体系，这要求我们采用特殊的方法来处理跨越边界的相互作用。本练习将让你亲手实践最小镜像约定（Minimum Image Convention），它是在周期性体系中正确计算原子间距离和描述符的关键技术 。",
            "id": "3736655",
            "problem": "一个原子系统在简单立方晶胞中，在周期性边界条件下进行模拟。在这种设置中，两个原子间的位移必须映射到最近的周期性映像，以确保计算出的距离反映了与平移不变性一致的最短原子间距。从周期性边界条件的定义（即在晶格平移下的等价性）以及原子间距离必须在最近映像之间计算的几何要求出发，推导出一个适用于正交晶胞的最近映像映射。该映射将原始位移矢量在每个笛卡尔分量上转换为其最近映像对应部分。然后，解释由球形截断确定的邻居集合如何通过其对称函数影响 Behler-Parrinello 神经网络 (BPNN) 势的输入。\n\n在推导出最近映像映射和邻居选择规则后，将它们应用于以下具体案例，为一个参考原子计算 Behler-Parrinello 径向对称函数。考虑一个边长为 $L = 10\\,\\mathrm{\\AA}$ 的立方盒子，其中包含一个参考原子和另外五个原子，它们的位置如下（所有坐标单位均为 $\\mathrm{\\AA}$）：\n- 参考原子 $i$：$\\boldsymbol{r}_i = (1.0,\\,1.0,\\,1.0)$，\n- 原子 $1$：$\\boldsymbol{r}_1 = (9.2,\\,1.1,\\,1.0)$，\n- 原子 $2$：$\\boldsymbol{r}_2 = (1.0,\\,8.9,\\,9.8)$，\n- 原子 $3$：$\\boldsymbol{r}_3 = (5.0,\\,5.0,\\,5.0)$，\n- 原子 $4$：$\\boldsymbol{r}_4 = (3.0,\\,9.8,\\,1.0)$，\n- 原子 $5$：$\\boldsymbol{r}_5 = (9.8,\\,9.8,\\,9.8)$。\n\n使用最近映像约定，确定在球形截断半径 $R_c = 6.0\\,\\mathrm{\\AA}$ 内的原子 $i$ 的邻居集合，并为每个邻居 $j$ 计算相应的最近映像距离 $R_{ij}$。然后评估 Behler-Parrinello 径向对称函数\n$$\nG_i^{(2)} \\;=\\; \\sum_{j \\neq i} \\exp\\!\\big(-\\eta\\,[R_{ij} - R_s]^{2}\\big)\\,f_c(R_{ij}) \\,,\n$$\n使用余弦截断函数\n$$\nf_c(R) = \\begin{cases} \\frac{1}{2}\\left[\\cos\\left(\\frac{\\pi R}{R_c}\\right) + 1\\right],  R \\le R_c \\\\ 0,  R > R_c \\end{cases}\n$$\n并采用参数 $\\eta = 1.0\\,\\mathrm{\\AA}^{-2}$ 和 $R_s = 2.0\\,\\mathrm{\\AA}$。将 $G_i^{(2)}$ 报告为一个无量纲标量，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题分两个阶段解决。首先，给出最近映像映射的一般推导，然后解释其在 Behler-Parrinello 神经网络 (BPNN) 势背景下的作用。其次，将此框架应用于所提供的具体数值案例，以计算径向对称函数 $G_i^{(2)}$。\n\n### 第一部分：推导与概念解释\n\n#### 最近映像约定 (MIC)\n\n在使用周期性边界条件 (PBC) 的模拟中，模拟晶胞在所有空间维度上无限复制，形成一个晶格。对于正交晶胞，晶格矢量是正交的：$\\boldsymbol{L}_x = (L_x, 0, 0)$，$\\boldsymbol{L}_y = (0, L_y, 0)$，以及 $\\boldsymbol{L}_z = (0, 0, L_z)$。位于位置 $\\boldsymbol{r}$ 的原子在所有位置 $\\boldsymbol{r}' = \\boldsymbol{r} + n_x\\boldsymbol{L}_x + n_y\\boldsymbol{L}_y + n_z\\boldsymbol{L}_z$ 处都有周期性映像，其中 $n_x, n_y, n_z$ 是任意整数。\n\n两个原子（$i$ 在 $\\boldsymbol{r}_i$，$j$ 在 $\\boldsymbol{r}_j$）之间的相互作用是基于原子 $i$ 与原子 $j$ 的所有周期性映像之间的最短距离来计算的。这就是最近映像约定。原始位移矢量是 $\\Delta\\boldsymbol{r}_{ij} = \\boldsymbol{r}_j - \\boldsymbol{r}_i = (\\Delta x, \\Delta y, \\Delta z)$。从原子 $i$ 到原子 $j$ 的一个周期性映像的位移矢量由 $\\Delta\\boldsymbol{r}_{ij} - n_x\\boldsymbol{L}_x - n_y\\boldsymbol{L}_y - n_z\\boldsymbol{L}_z$ 给出。目标是找到使该矢量模最小化的整数 $(n_x, n_y, n_z)$。\n\n模的平方由下式给出：\n$$d^2(n_x, n_y, n_z) = |\\Delta\\boldsymbol{r}_{ij} - n_x\\boldsymbol{L}_x - n_y\\boldsymbol{L}_y - n_z\\boldsymbol{L}_z|^2 = (\\Delta x - n_x L_x)^2 + (\\Delta y - n_y L_y)^2 + (\\Delta z - n_z L_z)^2$$\n由于笛卡尔分量是正交且独立的，我们可以分别最小化每一项。为了最小化 $(\\Delta x - n_x L_x)^2$，我们必须选择使 $n_x L_x$ 最接近 $\\Delta x$ 的整数 $n_x$。这通过选择 $n_x$ 为比值 $\\Delta x / L_x$ 的最近整数来实现。我们将其表示为 $n_x = \\text{round}(\\Delta x / L_x)$。\n\n因此，最近映像位移矢量 $\\Delta\\boldsymbol{r}'_{ij} = (\\Delta x', \\Delta y', \\Delta z')$ 是通过将此映射应用于每个分量得到的：\n$$ \\Delta x' = \\Delta x - L_x \\cdot \\text{round}\\left(\\frac{\\Delta x}{L_x}\\right) $$\n$$ \\Delta y' = \\Delta y - L_y \\cdot \\text{round}\\left(\\frac{\\Delta y}{L_y}\\right) $$\n$$ \\Delta z' = \\Delta z - L_z \\cdot \\text{round}\\left(\\frac{\\Delta z}{L_z}\\right) $$\n该变换确保所得矢量的每个分量都位于区间 $[-L_\\alpha/2, L_\\alpha/2]$ 内。最近映像距离则为 $R_{ij} = \\sqrt{(\\Delta x')^2 + (\\Delta y')^2 + (\\Delta z')^2}$。\n\n#### 对 Behler-Parrinello 神经网络势的影响\n\nBPNN 势将系统的势能描述为原子能量贡献的总和，$E = \\sum_i E_i$。每个原子能量 $E_i$ 由原子 $i$ 的局部化学环境决定，该环境被输入到针对该元素专用的神经网络中。\n\n为确保能量对于平移、旋转和相同原子的置换是不变的，局部环境不是用原始笛卡尔坐标来描述的。相反，它被编码成一个“对称函数”的矢量 $\\{G_i\\}$。这些函数是由邻近原子的相对位置构建的。\n\n计算这些对称函数的第一个关键步骤是确定原子 $i$ 的邻居集合。这是通过识别所有其最近映像距离 $R_{ij}$（使用 MIC 计算）小于预定义截断半径 $R_c$ 的原子 $j$ 来完成的。$R_{ij} \\ge R_c$ 的原子被排除在外。\n\n对于截断球内的所有邻居，其最近映像距离集合 $\\{R_{ij}\\}$ 和角度集合 $\\{\\theta_{ijk}\\}$ 构成了对称函数的直接输入。例如，问题中给出的径向对称函数 $G_i^{(2)}$ 是对截断半径内所有邻居 $j$ 的总和。\n\n因此，MIC 和 $R_c$ 的选择是基础性的。它们定义了“邻居列表”和 BPNN 用来“看到”局部环境的几何信息。错误应用 PBC 或忽略 MIC 将导致距离不能反映系统的真实周期性，从而产生不真实的边界效应，并导致无法学习到有意义且具有平移不变性的势能面。\n\n### 第二部分：具体计算\n\n我们给定一个边长为 $L = 10.0\\,\\mathrm{\\AA}$ 的立方模拟盒子。盒子的半长为 $L/2 = 5.0\\,\\mathrm{\\AA}$。截断半径为 $R_c = 6.0\\,\\mathrm{\\AA}$。参考原子是位于 $\\boldsymbol{r}_i = (1.0, 1.0, 1.0)$ 的原子 $i$。对称函数参数为 $\\eta = 1.0\\,\\mathrm{\\AA}^{-2}$ 和 $R_s = 2.0\\,\\mathrm{\\AA}$。\n\n我们现在将为每个原子 $j \\in \\{1, 2, 3, 4, 5\\}$ 计算最近映像距离 $R_{ij}$，并确定它是否是原子 $i$ 的邻居。\n\n**原子 1：** $\\boldsymbol{r}_1 = (9.2, 1.1, 1.0)$\n- 原始位移：$\\Delta\\boldsymbol{r}_{i1} = \\boldsymbol{r}_1 - \\boldsymbol{r}_i = (9.2-1.0, 1.1-1.0, 1.0-1.0) = (8.2, 0.1, 0.0)$。\n- 应用 MIC：$\\Delta x = 8.2  5.0$，所以 $\\Delta x' = 8.2 - 10.0 = -1.8$。其他分量不变。\n- 最近映像矢量：$\\Delta\\boldsymbol{r}'_{i1} = (-1.8, 0.1, 0.0)$。\n- 最近映像距离：$R_{i1} = \\sqrt{(-1.8)^2 + (0.1)^2 + (0.0)^2} = \\sqrt{3.24 + 0.01} = \\sqrt{3.25} \\approx 1.8028\\,\\mathrm{\\AA}$。\n- 由于 $R_{i1}  R_c = 6.0\\,\\mathrm{\\AA}$，原子 1 是一个邻居。\n\n**原子 2：** $\\boldsymbol{r}_2 = (1.0, 8.9, 9.8)$\n- 原始位移：$\\Delta\\boldsymbol{r}_{i2} = \\boldsymbol{r}_2 - \\boldsymbol{r}_i = (1.0-1.0, 8.9-1.0, 9.8-1.0) = (0.0, 7.9, 8.8)$。\n- 应用 MIC：$\\Delta y = 7.9  5.0 \\Rightarrow \\Delta y' = 7.9 - 10.0 = -2.1$。$\\Delta z = 8.8  5.0 \\Rightarrow \\Delta z' = 8.8 - 10.0 = -1.2$。\n- 最近映像矢量：$\\Delta\\boldsymbol{r}'_{i2} = (0.0, -2.1, -1.2)$。\n- 最近映像距离：$R_{i2} = \\sqrt{(0.0)^2 + (-2.1)^2 + (-1.2)^2} = \\sqrt{4.41 + 1.44} = \\sqrt{5.85} \\approx 2.4187\\,\\mathrm{\\AA}$。\n- 由于 $R_{i2}  R_c = 6.0\\,\\mathrm{\\AA}$，原子 2 是一个邻居。\n\n**原子 3：** $\\boldsymbol{r}_3 = (5.0, 5.0, 5.0)$\n- 原始位移：$\\Delta\\boldsymbol{r}_{i3} = \\boldsymbol{r}_3 - \\boldsymbol{r}_i = (5.0-1.0, 5.0-1.0, 5.0-1.0) = (4.0, 4.0, 4.0)$。\n- 应用 MIC：所有分量的绝对值都 $\\le 5.0$。无需修正。\n- 最近映像矢量：$\\Delta\\boldsymbol{r}'_{i3} = (4.0, 4.0, 4.0)$。\n- 最近映像距离：$R_{i3} = \\sqrt{4.0^2 + 4.0^2 + 4.0^2} = \\sqrt{16+16+16} = \\sqrt{48} \\approx 6.9282\\,\\mathrm{\\AA}$。\n- 由于 $R_{i3}  R_c = 6.0\\,\\mathrm{\\AA}$，原子 3 不是一个邻居。\n\n**原子 4：** $\\boldsymbol{r}_4 = (3.0, 9.8, 1.0)$\n- 原始位移：$\\Delta\\boldsymbol{r}_{i4} = \\boldsymbol{r}_4 - \\boldsymbol{r}_i = (3.0-1.0, 9.8-1.0, 1.0-1.0) = (2.0, 8.8, 0.0)$。\n- 应用 MIC：$\\Delta y = 8.8  5.0 \\Rightarrow \\Delta y' = 8.8 - 10.0 = -1.2$。\n- 最近映像矢量：$\\Delta\\boldsymbol{r}'_{i4} = (2.0, -1.2, 0.0)$。\n- 最近映像距离：$R_{i4} = \\sqrt{2.0^2 + (-1.2)^2 + (0.0)^2} = \\sqrt{4.0 + 1.44} = \\sqrt{5.44} \\approx 2.3324\\,\\mathrm{\\AA}$。\n- 由于 $R_{i4}  R_c = 6.0\\,\\mathrm{\\AA}$，原子 4 是一个邻居。\n\n**原子 5：** $\\boldsymbol{r}_5 = (9.8, 9.8, 9.8)$\n- 原始位移：$\\Delta\\boldsymbol{r}_{i5} = \\boldsymbol{r}_5 - \\boldsymbol{r}_i = (9.8-1.0, 9.8-1.0, 9.8-1.0) = (8.8, 8.8, 8.8)$。\n- 应用 MIC：所有分量都 $ 5.0$。$\\Delta x' = 8.8-10.0 = -1.2$，$\\Delta y' = 8.8-10.0 = -1.2$，$\\Delta z' = 8.8-10.0 = -1.2$。\n- 最近映像矢量：$\\Delta\\boldsymbol{r}'_{i5} = (-1.2, -1.2, -1.2)$。\n- 最近映像距离：$R_{i5} = \\sqrt{(-1.2)^2 + (-1.2)^2 + (-1.2)^2} = \\sqrt{1.44 \\times 3} = \\sqrt{4.32} \\approx 2.0785\\,\\mathrm{\\AA}$。\n- 由于 $R_{i5}  R_c = 6.0\\,\\mathrm{\\AA}$，原子 5 是一个邻居。\n\n原子 $i$ 的邻居是原子 1、2、4 和 5。我们现在计算每个邻居对 $G_i^{(2)} = \\sum_{j \\neq i} \\exp(-\\eta[R_{ij} - R_s]^{2})\\,f_c(R_{ij})$ 的贡献。\n\n设 $T_j$ 是邻居 $j$ 的项：$T_j = \\exp(-(R_{ij} - 2.0)^2) \\cdot \\frac{1}{2} [\\cos(\\pi R_{ij} / 6.0) + 1]$。\n\n- **原子 1 的项 ($R_{i1} \\approx 1.8028\\,\\mathrm{\\AA}$):**\n  $T_1 = \\exp(-(1.8028 - 2.0)^2) \\times 0.5 \\times [\\cos(\\pi \\cdot 1.8028 / 6.0) + 1] \\approx \\exp(-0.03889) \\times 0.5 \\times [\\cos(0.9439) + 1] \\approx 0.96185 \\times 0.5 \\times [0.58797 + 1] \\approx 0.76371$。\n\n- **原子 2 的项 ($R_{i2} \\approx 2.4187\\,\\mathrm{\\AA}$):**\n  $T_2 = \\exp(-(2.4187 - 2.0)^2) \\times 0.5 \\times [\\cos(\\pi \\cdot 2.4187 / 6.0) + 1] \\approx \\exp(-0.1753) \\times 0.5 \\times [\\cos(1.2664) + 1] \\approx 0.83921 \\times 0.5 \\times [0.29938 + 1] \\approx 0.54523$。\n\n- **原子 4 的项 ($R_{i4} \\approx 2.3324\\,\\mathrm{\\AA}$):**\n  $T_4 = \\exp(-(2.3324 - 2.0)^2) \\times 0.5 \\times [\\cos(\\pi \\cdot 2.3324 / 6.0) + 1] \\approx \\exp(-0.1105) \\times 0.5 \\times [\\cos(1.2212) + 1] \\approx 0.89540 \\times 0.5 \\times [0.34247 + 1] \\approx 0.60098$。\n\n- **原子 5 的项 ($R_{i5} \\approx 2.0785\\,\\mathrm{\\AA}$):**\n  $T_5 = \\exp(-(2.0785 - 2.0)^2) \\times 0.5 \\times [\\cos(\\pi \\cdot 2.0785 / 6.0) + 1] \\approx \\exp(-0.00616) \\times 0.5 \\times [\\cos(1.0883) + 1] \\approx 0.99386 \\times 0.5 \\times [0.46363 + 1] \\approx 0.72738$。\n\n最后，我们对这些贡献求和：\n$G_i^{(2)} = T_1 + T_2 + T_4 + T_5 \\approx 0.76371 + 0.54523 + 0.60098 + 0.72738 = 2.6373$。\n\n四舍五入到四位有效数字，结果是 $2.637$。",
            "answer": "$$\\boxed{2.637}$$"
        },
        {
            "introduction": "最后一个练习关注一个对于分子动力学模拟至关重要但又很精微的细节。Behler-Parrinello势函数通过截断半径来定义局部原子环境，但截断方式的选择对模型的物理真实性有重要影响。本练习通过对比光滑与非光滑截断函数，揭示了为何在截断边界处确保力的连续性对于能量守恒和模拟的稳定性是必不可少的 。",
            "id": "3736738",
            "problem": "考虑一个在 Behler–Parrinello (BP) 神经网络势中，原子 $i$ 和 $j$ 之间的单个原子间距 $r$。在 BP 势中，通过将径向项乘以一个在有限截断半径 $r_{c}$ 处为零的截断函数 $f_{c}(r)$ 来实现局域性。假设存在一个形式为 $E(r) = \\phi(r)\\,f_{c}(r)$ 的标量能量贡献，其中 $\\phi(r)$ 在 $r_{c}$ 的邻域内是二次连续可微的，并且在 $r_{c}$ 处是有限的。保守径向力由基本关系式 $F(r) = -\\frac{dE}{dr}$ 定义。请分析对于以下两种截断函数的选择，$F(r)$ 在 $r=r_{c}$ 处的连续性：\n\n1. 光滑的余弦截断函数，\n$$\nf_{c}^{\\mathrm{cos}}(r) =\n\\begin{cases}\n\\frac{1}{2}\\left(\\cos\\left(\\frac{\\pi r}{r_{c}}\\right)+1\\right),  0 \\le r \\le r_{c} \\\\\n0,  r > r_{c}\n\\end{cases}\n$$\n以及\n\n2. 连续但非光滑的线性截断函数，\n$$\nf_{c}^{\\mathrm{lin}}(r) =\n\\begin{cases}\n1 - r/r_{c},  0 \\le r \\le r_{c} \\\\\n0,  r > r_{c}\n\\end{cases}\n$$\n\n从 $F(r) = -\\frac{d}{dr}\\big(\\phi(r)\\,f_{c}(r)\\big)$ 和标准微分法则出发，计算力在 $r=r_{c}$ 处的跳变幅度，其定义为\n$$\nJ \\equiv \\lim_{\\varepsilon \\to 0^{+}} \\left|F(r_{c}-\\varepsilon) - F(r_{c}+\\varepsilon)\\right|.\n$$\n将您的最终答案以行向量的形式返回，其中第一个元素等于 $f_{c}^{\\mathrm{cos}}$ 的跳变幅度，第二个元素等于 $f_{c}^{\\mathrm{lin}}$ 的跳变幅度。无需进行数值计算；请用 $\\phi(r_{c})$ 和 $r_{c}$ 以闭合形式表示您的答案。",
            "solution": "该问题要求计算保守径向力 $F(r)$ 在截断半径 $r=r_c$ 处的跳变幅度。能量贡献由 $E(r) = \\phi(r)\\,f_c(r)$ 给出，力定义为 $F(r) = -\\frac{dE}{dr}$。跳变幅度 $J$ 定义为 $J \\equiv \\lim_{\\varepsilon \\to 0^{+}} \\left|F(r_{c}-\\varepsilon) - F(r_{c}+\\varepsilon)\\right|$。\n\n首先，我们将微分的乘法法则应用于能量表达式，推导出力 $F(r)$ 的通用表达式：\n$$\nF(r) = -\\frac{d}{dr}\\left[\\phi(r)\\,f_c(r)\\right] = -\\left[\\frac{d\\phi(r)}{dr}f_c(r) + \\phi(r)\\frac{df_c(r)}{dr}\\right] = -\\left[\\phi'(r)f_c(r) + \\phi(r)f_c'(r)\\right]\n$$\n问题中说明 $\\phi(r)$ 是二次连续可微的，这确保了 $\\phi(r)$ 及其一阶导数 $\\phi'(r)$ 在 $r=r_c$ 处是连续且有限的。\n\n跳变幅度定义为 $J = \\lim_{\\varepsilon \\to 0^{+}} \\left|F(r_{c}-\\varepsilon) - F(r_{c}+\\varepsilon)\\right|$。由于绝对值函数是连续的，极限可以移到绝对值符号内部：\n$$\nJ = \\left|\\lim_{\\varepsilon \\to 0^{+}} F(r_{c}-\\varepsilon) - \\lim_{\\varepsilon \\to 0^{+}} F(r_{c}+\\varepsilon)\\right| = \\left|F(r_c^{-}) - F(r_c^{+})\\right|\n$$\n其中 $F(r_c^{-})$ 和 $F(r_c^{+})$ 分别是当 $r \\to r_c$ 时力的左极限和右极限。\n\n对于给定的两个截断函数，当距离 $r  r_c$ 时，函数值为 $f_c(r) = 0$。因此，对于 $r  r_c$ 其导数也为 $f_c'(r) = 0$。\n当 $r  r_c$ 时，能量为 $E(r) = \\phi(r) \\cdot 0 = 0$。\n当 $r  r_c$ 时，力为 $F(r) = -\\frac{d}{dr}(0) = 0$。\n因此，在 $r_c$ 处的力的右极限为：\n$$\nF(r_c^{+}) = \\lim_{\\varepsilon \\to 0^{+}} F(r_c+\\varepsilon) = 0\n$$\n跳变幅度简化为 $J = |F(r_c^{-}) - 0| = |F(r_c^{-})|$。我们需要计算力的左极限：\n$$\nF(r_c^{-}) = \\lim_{r \\to r_c^{-}} -\\left[\\phi'(r)f_c(r) + \\phi(r)f_c'(r)\\right]\n$$\n考虑到 $\\phi(r)$ 和 $\\phi'(r)$ 的连续性，上式变为：\n$$\nF(r_c^{-}) = -\\left[\\phi'(r_c)\\left(\\lim_{r \\to r_c^{-}} f_c(r)\\right) + \\phi(r_c)\\left(\\lim_{r \\to r_c^{-}} f_c'(r)\\right)\\right]\n$$\n我们现在分析 $f_c(r)$ 的两种情况。\n\n情况1：光滑的余弦截断函数 $f_c^{\\mathrm{cos}}(r)$\n对于 $0 \\le r \\le r_c$，该函数为 $f_c^{\\mathrm{cos}}(r) = \\frac{1}{2}\\left(\\cos\\left(\\frac{\\pi r}{r_c}\\right)+1\\right)$。\n首先，我们计算当 $r \\to r_c^{-}$ 时函数的极限：\n$$\n\\lim_{r \\to r_c^{-}} f_c^{\\mathrm{cos}}(r) = \\frac{1}{2}\\left(\\cos\\left(\\frac{\\pi r_c}{r_c}\\right)+1\\right) = \\frac{1}{2}\\left(\\cos(\\pi)+1\\right) = \\frac{1}{2}(-1+1) = 0\n$$\n接下来，我们求出当 $0  r  r_c$ 时的导数，并计算其在 $r \\to r_c^{-}$ 时的极限：\n$$\n\\frac{d}{dr}f_c^{\\mathrm{cos}}(r) = \\frac{1}{2}\\left(-\\sin\\left(\\frac{\\pi r}{r_c}\\right)\\right)\\cdot \\frac{\\pi}{r_c} = -\\frac{\\pi}{2r_c}\\sin\\left(\\frac{\\pi r}{r_c}\\right)\n$$\n$$\n\\lim_{r \\to r_c^{-}} \\frac{d}{dr}f_c^{\\mathrm{cos}}(r) = -\\frac{\\pi}{2r_c}\\sin\\left(\\frac{\\pi r_c}{r_c}\\right) = -\\frac{\\pi}{2r_c}\\sin(\\pi) = 0\n$$\n将这些极限代入 $F(r_c^{-})$ 的表达式中：\n$$\nF(r_c^{-}) = -\\left[\\phi'(r_c) \\cdot 0 + \\phi(r_c) \\cdot 0\\right] = 0\n$$\n由于 $F(r_c^{-}) = 0$ 且 $F(r_c^{+}) = 0$，力在 $r=r_c$ 处是连续的。余弦截断的跳变幅度 $J_{\\mathrm{cos}}$ 为：\n$$\nJ_{\\mathrm{cos}} = |0| = 0\n$$\n\n情况2：连续但非光滑的线性截断函数 $f_c^{\\mathrm{lin}}(r)$\n对于 $0 \\le r \\le r_c$，该函数为 $f_c^{\\mathrm{lin}}(r) = 1 - \\frac{r}{r_c}$。\n首先，我们计算当 $r \\to r_c^{-}$ 时函数的极限：\n$$\n\\lim_{r \\to r_c^{-}} f_c^{\\mathrm{lin}}(r) = 1 - \\frac{r_c}{r_c} = 1 - 1 = 0\n$$\n接下来，我们求出当 $0  r  r_c$ 时的导数，并计算其在 $r \\to r_c^{-}$ 时的极限：\n$$\n\\frac{d}{dr}f_c^{\\mathrm{lin}}(r) = \\frac{d}{dr}\\left(1 - \\frac{r}{r_c}\\right) = -\\frac{1}{r_c}\n$$\n$$\n\\lim_{r \\to r_c^{-}} \\frac{d}{dr}f_c^{\\mathrm{lin}}(r) = -\\frac{1}{r_c}\n$$\n将这些极限代入 $F(r_c^{-})$ 的表达式中：\n$$\nF(r_c^{-}) = -\\left[\\phi'(r_c) \\cdot 0 + \\phi(r_c) \\cdot \\left(-\\frac{1}{r_c}\\right)\\right] = -\\left(-\\frac{\\phi(r_c)}{r_c}\\right) = \\frac{\\phi(r_c)}{r_c}\n$$\n力在 $r=r_c$ 处是不连续的，因为 $F(r_c^{-}) = \\frac{\\phi(r_c)}{r_c}$ 而 $F(r_c^{+}) = 0$。线性截断的跳变幅度 $J_{\\mathrm{lin}}$ 为：\n$$\nJ_{\\mathrm{lin}} = \\left|\\frac{\\phi(r_c)}{r_c}\\right|\n$$\n由于 $r_c$ 是半径，所以 $r_c  0$。该表达式可以写为 $\\frac{|\\phi(r_c)|}{r_c}$，因为 $\\phi(r_c)$ 的符号未指定。\n\n最终答案是一个包含跳变幅度 $[J_{\\mathrm{cos}}, J_{\\mathrm{lin}}]$ 的行向量。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0  \\frac{|\\phi(r_c)|}{r_c} \\end{pmatrix} } $$"
        }
    ]
}