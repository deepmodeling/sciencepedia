{
    "hands_on_practices": [
        {
            "introduction": "构建光谱邻域分析势(SNAP)的第一步是唯一地表示局部原子环境。这个练习  提供了一个应用SNAP立体投影的具体实践，该投影将邻近原子位置从三维空间映射到一个四维超球面。通过为一个简单的四面体构型执行此计算，您将直接理解这种映射的工作原理，以及缩放参数 $r_0$ 的选择如何影响对近邻和远邻的表示。",
            "id": "3808203",
            "problem": "考虑局域原子环境的谱邻域分析势 (SNAP) 表示方法。在 SNAP 中，中心原子 $i$ 的每个邻原子都通过一个由正常数尺度参数 $r_{0}$ 控制的球极投影，从三维欧几里得坐标映射到三维球面上的一个点。\n\n令超球坐标表示为 $\\Omega=(\\alpha,\\theta,\\phi)$，其中 $\\alpha \\in [0,\\pi)$ 是与径向距离 $r$ 相关的球极投影角，$(\\theta,\\phi)$ 是单位球面上的常规极角和方位角。\n\n假设中心原子 $i$ 有三个邻原子，位于以原点为中心的正四面体的三个顶点上，其单位方向向量为\n- $\\mathbf{v}_{1}=\\frac{1}{\\sqrt{3}}(1,1,1)$,\n- $\\mathbf{v}_{2}=\\frac{1}{\\sqrt{3}}(1,-1,-1)$,\n- $\\mathbf{v}_{3}=\\frac{1}{\\sqrt{3}}(-1,1,-1)$.\n\n相应的球面角由 $\\theta=\\arccos(z/r)$ 和 $\\phi=\\arctan2(y,x)$ 定义，使用标准约定，其中 $\\phi \\in [0,2\\pi)$。\n\n设邻原子距离为 $r_{1}=r_{2}=2.2$ 和 $r_{3}=3.6$，单位为埃。假设一个急剧截断函数 $f_{c}(r)$，当 $r  R_{c}=4.5$ 埃时其值为1，否则为0，所有邻原子权重为 $w_j=1$，且球极投影由关系式 $\\tan(\\alpha/2) = r/r_0$ 给出。\n任务是：首先，为 $r_0=2.0$ 的情况计算邻居密度 $\\rho_{i}(\\Omega)$ 的显式表达式。其次，定义一个由映射诱导的局域尺度 $w(r; r_0) = \\frac{d\\alpha}{dr}$，并考虑近邻与远邻比 $W(r_0) = \\frac{w(r_{\\text{near}}; r_0)}{w(r_{\\text{far}}; r_0)}$，其中 $r_{\\text{near}} = 2.2$ 和 $r_{\\text{far}} = 3.6$。计算标量 $Q = \\frac{W(r_0=2.0)}{W(r_0=4.0)}$ 并将结果四舍五入到四位有效数字。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **模型**：谱邻域分析势 (SNAP)。\n- **映射**：从三维欧几里得坐标到三维球面的球极投影。\n- **超球坐标**：$\\Omega = (\\alpha, \\theta, \\phi)$。\n- **球极投影角公式**：$\\tan(\\alpha/2) = r/r_0$，其中 $\\alpha \\in [0, \\pi)$ 且 $r_0  0$。\n- **邻原子方向向量**：\n  - $\\mathbf{v}_{1} = \\frac{1}{\\sqrt{3}}(1, 1, 1)$\n  - $\\mathbf{v}_{2} = \\frac{1}{\\sqrt{3}}(1, -1, -1)$\n  - $\\mathbf{v}_{3} = \\frac{1}{\\sqrt{3}}(-1, 1, -1)$\n- **邻原子距离**：$r_{1} = 2.2$，$r_{2} = 2.2$，$r_{3} = 3.6$。\n- **球面角定义**：$\\theta = \\arccos(z/r)$, $\\phi = \\arctan2(y, x)$，其中 $\\phi \\in [0, 2\\pi)$。\n- **截断函数**：当 $r  R_{c}$ 时 $f_{c}(r) = 1$，当 $r \\ge R_{c}$ 时 $f_{c}(r) = 0$。\n- **截断半径**：$R_{c} = 4.5$。\n- **邻原子权重**：对所有邻原子 $w_{j} = 1$。\n- **第一部分要求**：计算当 $r_{0}=2.0$ 时的邻居密度 $\\rho_{i}(\\Omega)$。\n- **第二部分定义**：\n  - 映射诱导的局域尺度：$w(r; r_{0}) = \\frac{d\\alpha}{dr}$。\n  - 近邻与远邻比：$W(r_{0}) = \\frac{w(r_{\\text{near}}; r_{0})}{w(r_{\\text{far}}; r_{0})}$。\n  - 给定距离：$r_{\\text{near}} = 2.2$, $r_{\\text{far}} = 3.6$。\n- **第二部分要求**：计算 $Q = \\frac{W(r_{0}=2.0)}{W(r_{0}=4.0)}$ 并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性。\n1.  **科学基础**：该问题基于 SNAP 原子间势的既定数学框架，这是计算材料科学中的一种标准方法。所有定义和方程均与该主题的科学文献一致。\n2.  **适定性**：该问题提供了计算所要求数量所需的所有必要数据和关系。对于第一部分，邻居密度由指定的邻原子位置和权重完全确定。对于第二部分，数量 $Q$ 是从一个所有参数都已指定的适定函数中导出的。存在唯一解。\n3.  **客观性**：该问题以精确的数学语言陈述，没有歧义或主观论断。\n4.  **一致性**：给定的条件是自洽的。邻原子距离 $r_1=2.2$、$r_2=2.2$ 和 $r_3=3.6$ 均小于截断半径 $R_c=4.5$，因此所有邻原子都包含在计算中，这是一个一致的设置。\n\n### 步骤 3：结论和行动\n该问题被判定为**有效**，因为它具有科学基础、适定性、客观性且内部一致。将提供完整解答。\n\n### 解答\n\n**第一部分：邻居密度 $\\rho_{i}(\\Omega)$ 的计算**\n\n中心原子 $i$ 的 SNAP 邻居密度 $\\rho_{i}(\\Omega)$ 定义为其邻原子 $j$ 的总和：\n$$\n\\rho_{i}(\\Omega) = \\sum_{j} w_{j} f_{c}(r_{j}) \\delta(\\Omega - \\Omega_{j})\n$$\n其中 $\\Omega = (\\alpha, \\theta, \\phi)$ 是三维球面上的一个点，$\\Omega_{j} = (\\alpha_{j}, \\theta_{j}, \\phi_{j})$ 是邻原子 $j$ 的超球坐标，$w_j$ 是邻居类型权重，$f_c(r_j)$ 是截断函数，$\\delta(\\cdot)$ 是三维球面上的狄拉克δ函数。\n\n问题陈述所有邻原子的权重 $w_{j} = 1$。截断半径为 $R_{c} = 4.5$。邻原子距离为 $r_{1} = 2.2$，$r_{2} = 2.2$ 和 $r_{3} = 3.6$。由于所有 $r_j  R_c$，所以对于所有三个邻原子，截断函数 $f_{c}(r_j) = 1$。因此，密度表达式简化为：\n$$\n\\rho_{i}(\\Omega) = \\sum_{j=1}^{3} \\delta(\\Omega - \\Omega_{j})\n$$\n我们需要为每个邻原子计算当 $r_{0}=2.0$ 时的超球坐标 $\\Omega_{j} = (\\alpha_{j}, \\theta_{j}, \\phi_{j})$。\n\n首先，我们使用关系式 $\\tan(\\alpha_j/2) = r_j / r_0$ 计算每个邻原子的球极投影角 $\\alpha_j$。\n\n对于邻原子 $j=1$ 和 $j=2$，有 $r_{1}=r_{2}=2.2$。\n$$\n\\tan(\\alpha_{1,2}/2) = \\frac{2.2}{2.0} = 1.1 \\implies \\alpha_{1,2} = 2 \\arctan(1.1)\n$$\n对于邻原子 $j=3$，有 $r_{3}=3.6$。\n$$\n\\tan(\\alpha_{3}/2) = \\frac{3.6}{2.0} = 1.8 \\implies \\alpha_{3} = 2 \\arctan(1.8)\n$$\n\n接下来，我们从单位方向向量 $\\mathbf{v}_j = (\\hat{x}_j, \\hat{y}_j, \\hat{z}_j)$ 计算球面角 $(\\theta_j, \\phi_j)$。定义为 $\\theta_j = \\arccos(\\hat{z}_j)$ 和 $\\phi_j = \\arctan2(\\hat{y}_j, \\hat{x}_j)$。\n\n对于邻原子 $j=1$：$\\mathbf{v}_{1} = \\frac{1}{\\sqrt{3}}(1, 1, 1)$。\n- $\\hat{z}_1 = \\frac{1}{\\sqrt{3}} \\implies \\theta_1 = \\arccos\\left(\\frac{1}{\\sqrt{3}}\\right)$。\n- $\\hat{y}_1 = \\frac{1}{\\sqrt{3}}, \\hat{x}_1 = \\frac{1}{\\sqrt{3}} \\implies \\phi_1 = \\arctan2(1, 1) = \\frac{\\pi}{4}$。\n\n对于邻原子 $j=2$：$\\mathbf{v}_{2} = \\frac{1}{\\sqrt{3}}(1, -1, -1)$。\n- $\\hat{z}_2 = -\\frac{1}{\\sqrt{3}} \\implies \\theta_2 = \\arccos\\left(-\\frac{1}{\\sqrt{3}}\\right)$。\n- $\\hat{y}_2 = -\\frac{1}{\\sqrt{3}}, \\hat{x}_2 = \\frac{1}{\\sqrt{3}} \\implies \\phi_2 = \\arctan2(-1, 1) = -\\frac{\\pi}{4}$。由于 $\\phi \\in [0, 2\\pi)$，我们取 $\\phi_2 = 2\\pi - \\frac{\\pi}{4} = \\frac{7\\pi}{4}$。\n\n对于邻原子 $j=3$：$\\mathbf{v}_{3} = \\frac{1}{\\sqrt{3}}(-1, 1, -1)$。\n- $\\hat{z}_3 = -\\frac{1}{\\sqrt{3}} \\implies \\theta_3 = \\arccos\\left(-\\frac{1}{\\sqrt{3}}\\right)$。\n- $\\hat{y}_3 = \\frac{1}{\\sqrt{3}}, \\hat{x}_3 = -\\frac{1}{\\sqrt{3}} \\implies \\phi_3 = \\arctan2(1, -1) = \\pi - \\frac{\\pi}{4} = \\frac{3\\pi}{4}$。\n\n邻原子坐标为：\n- $\\Omega_{1} = \\left(2 \\arctan(1.1), \\arccos\\left(\\frac{1}{\\sqrt{3}}\\right), \\frac{\\pi}{4}\\right)$\n- $\\Omega_{2} = \\left(2 \\arctan(1.1), \\arccos\\left(-\\frac{1}{\\sqrt{3}}\\right), \\frac{7\\pi}{4}\\right)$\n- $\\Omega_{3} = \\left(2 \\arctan(1.8), \\arccos\\left(-\\frac{1}{\\sqrt{3}}\\right), \\frac{3\\pi}{4}\\right)$\n\n因此，邻居密度为：\n$$\n\\rho_{i}(\\Omega) = \\delta(\\Omega - \\Omega_1) + \\delta(\\Omega - \\Omega_2) + \\delta(\\Omega - \\Omega_3)\n$$\n其中坐标 $\\Omega_1, \\Omega_2, \\Omega_3$ 如上所述。\n\n**第二部分：标量 $Q$ 的计算**\n\n标量 $Q$ 定义为 $Q=\\frac{W(r_{0}=2.0)}{W(r_{0}=4.0)}$，其中 $W(r_{0})=\\frac{w(r_{\\text{near}};r_{0})}{w(r_{\\text{far}};r_{0})}$ 且 $w(r;r_{0})=\\frac{d\\alpha}{dr}$。\n\n首先，我们推导 $w(r; r_{0})$ 的显式表达式。从 $\\tan(\\alpha/2) = r/r_{0}$ 开始，我们对 $r$ 求导：\n$$\n\\frac{d}{dr} \\left( \\tan\\left(\\frac{\\alpha}{2}\\right) \\right) = \\frac{d}{dr} \\left( \\frac{r}{r_0} \\right)\n$$\n$$\n\\sec^2\\left(\\frac{\\alpha}{2}\\right) \\cdot \\frac{1}{2} \\frac{d\\alpha}{dr} = \\frac{1}{r_0}\n$$\n求解 $\\frac{d\\alpha}{dr}$：\n$$\n\\frac{d\\alpha}{dr} = \\frac{2}{r_0 \\sec^2(\\alpha/2)}\n$$\n使用恒等式 $\\sec^2(x) = 1 + \\tan^2(x)$ 并代入 $\\tan(\\alpha/2) = r/r_0$：\n$$\nw(r; r_0) = \\frac{d\\alpha}{dr} = \\frac{2}{r_0 \\left(1 + \\tan^2(\\alpha/2)\\right)} = \\frac{2}{r_0 \\left(1 + (r/r_0)^2\\right)} = \\frac{2}{r_0 \\left(\\frac{r_0^2 + r^2}{r_0^2}\\right)} = \\frac{2r_0}{r^2 + r_0^2}\n$$\n现在，我们可以写出近邻与远邻比 $W(r_0)$ 的表达式：\n$$\nW(r_{0}) = \\frac{w(r_{\\text{near}}; r_{0})}{w(r_{\\text{far}}; r_{0})} = \\frac{2r_0 / (r_{\\text{near}}^2 + r_0^2)}{2r_0 / (r_{\\text{far}}^2 + r_0^2)} = \\frac{r_{\\text{far}}^2 + r_0^2}{r_{\\text{near}}^2 + r_0^2}\n$$\n给定 $r_{\\text{near}} = 2.2$ 和 $r_{\\text{far}} = 3.6$。所以，$r_{\\text{near}}^2 = (2.2)^2 = 4.84$ 且 $r_{\\text{far}}^2 = (3.6)^2 = 12.96$。\n表达式变为：\n$$\nW(r_0) = \\frac{12.96 + r_0^2}{4.84 + r_0^2}\n$$\n接下来，我们计算 $W(r_0)$ 在两个指定的 $r_0$ 值下的结果。\n\n对于 $r_0=2.0$：$r_0^2 = 4.0$。\n$$\nW(r_0=2.0) = \\frac{12.96 + 4.0}{4.84 + 4.0} = \\frac{16.96}{8.84}\n$$\n对于 $r_0=4.0$：$r_0^2 = 16.0$。\n$$\nW(r_0=4.0) = \\frac{12.96 + 16.0}{4.84 + 16.0} = \\frac{28.96}{20.84}\n$$\n最后，我们计算所要求的比率 $Q$：\n$$\nQ = \\frac{W(r_{0}=2.0)}{W(r_{0}=4.0)} = \\frac{16.96 / 8.84}{28.96 / 20.84} = \\frac{16.96}{8.84} \\times \\frac{20.84}{28.96}\n$$\n$$\nQ = \\frac{16.96 \\times 20.84}{8.84 \\times 28.96} = \\frac{353.4304}{255.9904} \\approx 1.380650005...\n$$\n将此结果四舍五入到四位有效数字，我们得到 $1.381$。",
            "answer": "$$\n\\boxed{1.381}\n$$"
        },
        {
            "introduction": "在定义了邻域密度之后，下一个关键步骤是提取对原子系统旋转不变的特征。这个练习  侧重于计算一个简单的双谱分量，它是由球谐函数系数构成的旋转不变量。通过分析一个对称的三原子构型，您将学习双谱如何量化局部环境的角各向异性，这是区分不同材料相的关键属性。",
            "id": "3808216",
            "problem": "考虑一个由谱邻域分析势 (SNAP) 中使用的角邻域密度构建的旋转不变量描述符。设中心原子位于原点，其邻域环境由单位球面上的角邻域密度表示，\n$$\n\\rho(\\hat{\\mathbf{r}}) = \\sum_{i=1}^{N} w_{i} \\,\\delta\\!\\left(\\hat{\\mathbf{r}} - \\hat{\\mathbf{r}}_{i}\\right),\n$$\n其中 $\\hat{\\mathbf{r}}$ 是球面上的单位向量，$\\hat{\\mathbf{r}}_{i}$ 表示邻原子 $i$ 的方向，而 $w_{i}$ 是一个有限的正权重。球谐投影系数定义为\n$$\nu_{l m} \\equiv \\int_{S^{2}} Y_{l m}^{*}(\\hat{\\mathbf{r}})\\,\\rho(\\hat{\\mathbf{r}})\\,d\\Omega = \\sum_{i=1}^{N} w_{i}\\,Y_{l m}^{*}(\\hat{\\mathbf{r}}_{i}),\n$$\n其中 $Y_{l m}$ 是正交归一球谐函数。特别地，对于 $l=1$，\n$$\nY_{1,0}(\\theta,\\phi) = \\sqrt{\\frac{3}{4\\pi}}\\,\\cos\\theta,\\qquad\nY_{1,\\pm 1}(\\theta,\\phi) = \\mp \\sqrt{\\frac{3}{8\\pi}}\\,\\sin\\theta\\,\\exp(\\pm i\\phi).\n$$\n一个通过将两个 $l=1$ 通道耦合到总角动量 $l=0$ 而构建的最低阶旋转不变量可以表示为一个仅依赖于集合 $\\{u_{1 m}\\}_{m=-1}^{1}$ 的标量；将这个类双谱标量记为 $B_{1\\,1\\,0}$。从上述定义以及 $l=0$ 耦合消除了方向依赖性这一事实出发，推导 $B_{1\\,1\\,0}$ 关于 $\\{u_{1 m}\\}$ 的显式表达式，并针对以下对称三原子构型计算其值：两个相同的邻原子，具有相等的权重 $w0$，位于 $+z$ 和 $-z$ 轴上共同的距离 $r_{0}$ 处，即在 $(\\theta,\\phi)=(0,0)$ 和 $(\\pi,0)$。你可以忽略径向结构，只考虑在单位球面上的角投影。将你的最终答案表示为一个无量纲数。\n\n然后，通过考虑一个将位于 $(\\pi,0)$ 的邻原子倾斜到 $(\\pi-\\varepsilon,0)$ (其中 $0  \\varepsilon \\ll 1$) 的微扰，简要解释 $B_{1\\,1\\,0}$ 如何响应角各向异性。确定 $B_{1\\,1\\,0}$ 随 $\\varepsilon$ 变化的领头阶标度，并讨论该标度背后的物理原因。对于主计算值，无需四舍五入。",
            "solution": "首先验证该问题是自洽的、有科学依据且定义明确的。提取并分析给定的条件。所有定义，包括角邻域密度 $\\rho(\\hat{\\mathbf{r}})$、球谐投影系数 $u_{l m}$ 以及 $Y_{1m}$ 的具体形式，都是多体原子势和角动量理论领域的标准定义。所描述的构型是一个简单且具有物理意义的设置（一个线性三原子分子）。任务清晰，可以使用既定原理解决。因此，该问题被认为是有效的。\n\n第一个任务是推导旋转不变量 $B_{1\\,1\\,0}$ 关于系数 $\\{u_{1 m}\\}$ 的显式表达式。通过将两个秩为 $l=1$ 的张量耦合到总角动量 $L=0$ 形成的旋转不变量与它们的标量积成正比。对于类双谱量 $B_{1\\,1\\,0}$，这涉及到系数集 $\\{u_{1m}\\}$ 的自耦合。最简单和最基本的此类不变量是系数模平方的和，它代表了其球张量分量为 $u_{1m}$ 的向量的模平方。因此我们定义 $B_{1\\,1\\,0}$ 为：\n$$\nB_{1\\,1\\,0} \\equiv \\sum_{m=-1}^{1} |u_{1m}|^2\n$$\n性质 $u_{l,-m} = (-1)^{-m} (u_{lm})^*$ 保证了这个量是实数。这是 SNAP 中功率谱的一个特例，对于给定的 $l$，功率谱为 $\\sum_{m=-l}^{l} |u_{lm}|^2$。\n\n第二个任务是计算特定对称构型下的 $B_{1\\,1\\,0}$。该系统由一个位于原点的中心原子和两个邻原子（索引为 $i=1,2$）组成，它们具有相等的权重 $w  0$。它们在单位球面上的位置由 $(\\theta_1, \\phi_1) = (0, 0)$ 和 $(\\theta_2, \\phi_2) = (\\pi, 0)$ 给出。\n\n系数 $u_{1m}$ 根据其定义计算：\n$$\nu_{1m} = \\sum_{i=1}^{2} w_{i} Y_{1m}^*(\\hat{\\mathbf{r}}_i) = w \\left( Y_{1m}^*(\\theta_1, \\phi_1) + Y_{1m}^*(\\theta_2, \\phi_2) \\right)\n$$\n我们需要计算两个位置处的球谐函数 $Y_{1m}$。\n对于位于 $(\\theta,\\phi)=(0,0)$ 的邻原子 1：\n$\\cos(0)=1$, $\\sin(0)=0$.\n$Y_{1,0}(0,0) = \\sqrt{\\frac{3}{4\\pi}} \\cos(0) = \\sqrt{\\frac{3}{4\\pi}}$.\n$Y_{1,\\pm 1}(0,0) = \\mp \\sqrt{\\frac{3}{8\\pi}} \\sin(0) \\exp(\\pm i \\cdot 0) = 0$.\n\n对于位于 $(\\theta,\\phi)=(\\pi,0)$ 的邻原子 2：\n$\\cos(\\pi)=-1$, $\\sin(\\pi)=0$.\n$Y_{1,0}(\\pi,0) = \\sqrt{\\frac{3}{4\\pi}} \\cos(\\pi) = -\\sqrt{\\frac{3}{4\\pi}}$.\n$Y_{1,\\pm 1}(\\pi,0) = \\mp \\sqrt{\\frac{3}{8\\pi}} \\sin(\\pi) \\exp(\\pm i \\cdot 0) = 0$.\n\n由于所有这些值都是实数，所以 $Y_{1m}^* = Y_{1m}$。我们现在可以计算系数 $u_{1m}$：\n对于 $m=0$：\n$u_{1,0} = w \\left( Y_{1,0}(0,0) + Y_{1,0}(\\pi,0) \\right) = w \\left( \\sqrt{\\frac{3}{4\\pi}} - \\sqrt{\\frac{3}{4\\pi}} \\right) = 0$.\n对于 $m=+1$：\n$u_{1,1} = w \\left( Y_{1,1}(0,0) + Y_{1,1}(\\pi,0) \\right) = w \\left( 0 + 0 \\right) = 0$.\n对于 $m=-1$：\n$u_{1,-1} = w \\left( Y_{1,-1}(0,0) + Y_{1,-1}(\\pi,0) \\right) = w \\left( 0 + 0 \\right) = 0$.\n\n对于这个中心对称构型，所有系数 $u_{1m}$ 均为零。因此，该不变量的值为：\n$$\nB_{1\\,1\\,0} = |u_{1,-1}|^2 + |u_{1,0}|^2 + |u_{1,1}|^2 = 0^2 + 0^2 + 0^2 = 0\n$$\n物理上，系数 $u_{1m}$ 是邻域密度分布偶极矩的一种度量。对于中心对称的排列，净偶极矩为零，因此其所有分量 $u_{1m}$ 必须为零。\n\n第三个任务是分析 $B_{1\\,1\\,0}$ 对小微扰的响应。位于 $(\\pi,0)$ 的邻原子被移动到 $(\\pi-\\varepsilon, 0)$，其中角度 $0  \\varepsilon \\ll 1$ 很小。我们重新计算 $u_{1m}$ 系数到 $\\varepsilon$ 的领头阶。\n来自位于 $(0,0)$ 的邻原子 1 的贡献不变。对于位于 $(\\theta, \\phi) = (\\pi-\\varepsilon, 0)$ 的邻原子 2，我们对 $\\varepsilon \\ll 1$ 使用泰勒级数展开：\n$\\cos(\\pi-\\varepsilon) = -\\cos(\\varepsilon) \\approx -(1 - \\frac{\\varepsilon^2}{2}) = -1 + \\frac{\\varepsilon^2}{2}$.\n$\\sin(\\pi-\\varepsilon) = \\sin(\\varepsilon) \\approx \\varepsilon$.\n邻原子 2 的 $Y_{1m}$ 值现在是：\n$Y_{1,0}(\\pi-\\varepsilon,0) = \\sqrt{\\frac{3}{4\\pi}}\\cos(\\pi-\\varepsilon) \\approx \\sqrt{\\frac{3}{4\\pi}}(-1 + \\frac{\\varepsilon^2}{2})$.\n$Y_{1,\\pm 1}(\\pi-\\varepsilon,0) = \\mp \\sqrt{\\frac{3}{8\\pi}}\\sin(\\pi-\\varepsilon) \\approx \\mp \\sqrt{\\frac{3}{8\\pi}}\\varepsilon$.\n同样，这些值是实数，所以 $Y_{1m}^* = Y_{1m}$。新的系数 $u_{1m}'$ 是：\n$u_{1,0}' = w(Y_{1,0}(0,0) + Y_{1,0}(\\pi-\\varepsilon,0)) \\approx w \\left( \\sqrt{\\frac{3}{4\\pi}} + \\sqrt{\\frac{3}{4\\pi}}(-1+\\frac{\\varepsilon^2}{2}) \\right) = w\\sqrt{\\frac{3}{4\\pi}}\\frac{\\varepsilon^2}{2}$.\n$u_{1,1}' = w(Y_{1,1}(0,0) + Y_{1,1}(\\pi-\\varepsilon,0)) \\approx w \\left( 0 - \\sqrt{\\frac{3}{8\\pi}}\\varepsilon \\right) = -w\\sqrt{\\frac{3}{8\\pi}}\\varepsilon$.\n$u_{1,-1}' = w(Y_{1,-1}(0,0) + Y_{1,-1}(\\pi-\\varepsilon,0)) \\approx w \\left( 0 + \\sqrt{\\frac{3}{8\\pi}}\\varepsilon \\right) = w\\sqrt{\\frac{3}{8\\pi}}\\varepsilon$.\n\n受扰动的不变量 $B_{1\\,1\\,0}'$ 是：\n$$\nB_{1\\,1\\,0}' = |u_{1,-1}'|^2 + |u_{1,0}'|^2 + |u_{1,1}'|^2\n$$\n$$\nB_{1\\,1\\,0}' \\approx \\left(w\\sqrt{\\frac{3}{8\\pi}}\\varepsilon\\right)^2 + \\left(w\\sqrt{\\frac{3}{4\\pi}}\\frac{\\varepsilon^2}{2}\\right)^2 + \\left(-w\\sqrt{\\frac{3}{8\\pi}}\\varepsilon\\right)^2\n$$\n$$\nB_{1\\,1\\,0}' \\approx w^2\\frac{3}{8\\pi}\\varepsilon^2 + w^2\\frac{3}{16\\pi}\\frac{\\varepsilon^4}{4} + w^2\\frac{3}{8\\pi}\\varepsilon^2\n$$\n到 $\\varepsilon$ 的领头阶：\n$$\nB_{1\\,1\\,0}' \\approx 2 \\left( w^2\\frac{3}{8\\pi}\\varepsilon^2 \\right) = \\frac{3w^2}{4\\pi}\\varepsilon^2\n$$\n$B_{1\\,1\\,0}$ 随 $\\varepsilon$ 变化的领头阶标度是 $\\varepsilon^2$。\n\n这种二次标度关系的物理原因是 $B_{1\\,1\\,0}$ 是各向异性的一种度量。$\\varepsilon=0$ 的未扰动构型是完美对称的（相对于偶极矩是各向同性的），此时 $B_{1\\,1\\,0}$ 处于其绝对最小值 0。对于任何在 $x_0$ 处有极小值的光滑函数 $f(x)$，其在 $x_0$ 附近的泰勒展开为 $f(x) \\approx f(x_0) + \\frac{1}{2}f''(x_0)(x-x_0)^2$。由于 $B_{1\\,1\\,0}(\\varepsilon=0)=0$，任何对此对称点的小偏离 $\\varepsilon$ 都必然导致 $B_{1\\,1\\,0}$ 产生一个与 $\\varepsilon^2$ 成正比的变化。在这种情况下，完美中心对称性的破坏在邻域分布中产生了一个与 $\\varepsilon$ 线性相关的非零偶极矩。不变量 $B_{1\\,1\\,0}$ 与该偶极矩的模平方成正比，因此它必须随 $\\varepsilon$ 呈二次标度关系。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "SNAP模型的预测能力最终取决于对不同双谱分量贡献进行加权的线性系数。这最后一个实践  模拟了使用已知能量和力的训练数据来拟合这些系数的真实过程。通过为一个合成数据集实现正则化线性回归，您将探索训练原子间势的实际方面，并理解超参数在平衡模型准确性和稳健性方面的作用。",
            "id": "3808204",
            "problem": "在光谱邻近分析势 (Spectral Neighbor Analysis Potential, SNAP) 中，晶体的势能被建模为由超球面谐波的双谱构建的、描述局域邻近密度的旋转不变描述符的线性函数。在线性 SNAP 设置中，一个构型的总能量表示为固定维度描述符向量的线性形式。力通过能量的负梯度获得，在线性模型中，这会产生作用于描述符导数的、与能量具有相同系数的线性形式。在实践中，系数估计被表述为一个基于能量和力组合数据集的正则化回归问题。\n\n从以下基本基础出发：\n- 能量和力的线性测量模型：对于每个构型，能量建模为 $E = \\mathbf{x}_{E}^{\\top}\\mathbf{w} + \\varepsilon_{E}$，每个力分量建模为 $F = \\mathbf{x}_{F}^{\\top}\\mathbf{w} + \\varepsilon_{F}$，其中 $\\mathbf{x}_{E}$ 和 $\\mathbf{x}_{F}$ 分别是描述符和描述符导数特征向量，$\\mathbf{w}$ 是未知系数，$\\varepsilon_{E}$ 和 $\\varepsilon_{F}$ 是零均值随机误差。\n- 一个凸二次损失函数，它通过力加权超参数 $\\gamma \\ge 0$ 来平衡能量和力的残差，并包含强度为 $\\lambda \\ge 0$ 的 $\\ell_{2}$正则化以控制系数的大小。\n\n您的任务是为一个小的类 SNAP 合成数据集计算正则化路径，并报告预测误差和系数范数如何随超参数变化。\n\n数据生成协议（必须严格遵守以确保可复现性）：\n- 使用固定的随机种子 $s = 2025$。\n- 设特征维度为 $p = 7$。\n- 设总构型数为 $n_{E,\\text{total}} = 12$，分为用于训练的 $n_{E,\\text{train}} = 8$ 和用于验证的 $n_{E,\\text{val}} = 4$。\n- 每个构型包含 $3$ 个力分量（例如笛卡尔分量），因此总力样本数为 $n_{F,\\text{total}} = 36$，分为用于训练的 $n_{F,\\text{train}} = 24$ 和用于验证的 $n_{F,\\text{val}} = 12$。\n- 将真实的系数向量固定为\n$$\n\\mathbf{w}_{\\text{true}} = \\begin{bmatrix}0.8 \\\\ -0.5 \\\\ 0.3 \\\\ 0.0 \\\\ 0.2 \\\\ -0.1 \\\\ 0.05\\end{bmatrix}.\n$$\n- 从均值为 $0$、标准差为 $1$ 的正态分布中抽取独立的元素，生成能量特征矩阵 $\\mathbf{X}_{E} \\in \\mathbb{R}^{12 \\times 7}$，并将其分为 $\\mathbf{X}_{E,\\text{train}} \\in \\mathbb{R}^{8 \\times 7}$（前 $8$ 行）和 $\\mathbf{X}_{E,\\text{val}} \\in \\mathbb{R}^{4 \\times 7}$（后 $4$ 行）。\n- 从均值为 $0$、标准差为 $0.4$ 的正态分布中抽取独立的元素，生成力特征矩阵 $\\mathbf{X}_{F} \\in \\mathbb{R}^{36 \\times 7}$，并将其分为 $\\mathbf{X}_{F,\\text{train}} \\in \\mathbb{R}^{24 \\times 7}$（前 $24$ 行）和 $\\mathbf{X}_{F,\\text{val}} \\in \\mathbb{R}^{12 \\times 7}$（后 $12$ 行）。\n- 使用独立高斯噪声生成响应：$\\mathbf{y}_{E} = \\mathbf{X}_{E}\\mathbf{w}_{\\text{true}} + \\boldsymbol{\\varepsilon}_{E}$，其中 $\\varepsilon_{E,i} \\sim \\mathcal{N}(0, \\sigma_{E}^{2})$，$\\sigma_{E} = 0.01$ 电子伏特 (eV)；以及 $\\mathbf{y}_{F} = \\mathbf{X}_{F}\\mathbf{w}_{\\text{true}} + \\boldsymbol{\\varepsilon}_{F}$，其中 $\\varepsilon_{F,j} \\sim \\mathcal{N}(0, \\sigma_{F}^{2})$，$\\sigma_{F} = 0.02$ 电子伏特每埃 (eV/Å)。将这些响应按照与特征划分一致的方式分为训练集和验证集，即 $\\mathbf{y}_{E,\\text{train}}$、$\\mathbf{y}_{E,\\text{val}}$、$\\mathbf{y}_{F,\\text{train}}$ 和 $\\mathbf{y}_{F,\\text{val}}$。\n\n对于下面测试套件中给定的每一对超参数 $(\\lambda, \\gamma)$，通过最小化以下关于 $\\mathbf{w} \\in \\mathbb{R}^{p}$ 的目标函数来估计 $\\mathbf{w}$：\n$$\n\\mathcal{L}(\\mathbf{w}) = \\left\\|\\mathbf{X}_{E,\\text{train}}\\mathbf{w} - \\mathbf{y}_{E,\\text{train}}\\right\\|_{2}^{2} + \\gamma^{2}\\left\\|\\mathbf{X}_{F,\\text{train}}\\mathbf{w} - \\mathbf{y}_{F,\\text{train}}\\right\\|_{2}^{2} + \\lambda \\left\\|\\mathbf{w}\\right\\|_{2}^{2}.\n$$\n根据最小化器 $\\hat{\\mathbf{w}}(\\lambda,\\gamma)$，在验证集上计算：\n- 能量的均方根误差 (RMSE)，定义为\n$$\n\\mathrm{RMSE}_{E} = \\sqrt{\\frac{1}{n_{E,\\text{val}}}\\left\\|\\mathbf{X}_{E,\\text{val}}\\hat{\\mathbf{w}} - \\mathbf{y}_{E,\\text{val}}\\right\\|_{2}^{2}},\n$$\n以电子伏特 (eV) 为单位报告。\n- 力的均方根误差，定义为\n$$\n\\mathrm{RMSE}_{F} = \\sqrt{\\frac{1}{n_{F,\\text{val}}}\\left\\|\\mathbf{X}_{F,\\text{val}}\\hat{\\mathbf{w}} - \\mathbf{y}_{F,\\text{val}}\\right\\|_{2}^{2}},\n$$\n以电子伏特每埃 (eV/Å) 为单位报告。\n- 系数的 $\\ell_{2}$-范数 $\\left\\|\\hat{\\mathbf{w}}\\right\\|_{2}$，在给定归一化下是无量纲的。\n\n待评估的超参数测试套件：\n- $(\\lambda, \\gamma) = (0.0, 1.0)$\n- $(\\lambda, \\gamma) = (0.0001, 1.0)$\n- $(\\lambda, \\gamma) = (0.01, 1.0)$\n- $(\\lambda, \\gamma) = (1.0, 1.0)$\n- $(\\lambda, \\gamma) = (0.01, 0.0)$\n- $(\\lambda, \\gamma) = (0.01, 5.0)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应上面列出的一个测试用例，并且本身是按 $[\\mathrm{RMSE}_{E}, \\mathrm{RMSE}_{F}, \\|\\hat{\\mathbf{w}}\\|_{2}]$ 顺序排列的三个浮点数列表。例如，整体形状必须是\n$$\n\\left[\\left[r_{1,E}, r_{1,F}, n_{1}\\right], \\left[r_{2,E}, r_{2,F}, n_{2}\\right], \\dots \\right].\n$$\n所有能量误差必须以电子伏特 (eV) 表示，所有力误差必须以电子伏特每埃 (eV/Å) 表示，系数范数是无量纲的。本任务不涉及角度。不应打印任何其他文本。",
            "solution": "所述问题在计算材料科学领域构成了一个有效且适定的任务，特别涉及线性光谱邻近分析势 (SNAP) 的参数化。这是正则化线性回归的一个标准应用，通常称为岭回归或 Tikhonov 正则化。该问题为生成合成数据集以及训练和评估模型提供了一套完整且一致的指令。所有参数都已明确定义，目标明确无误。因此，我们将着手提供一个完整的解决方案。\n\n问题的核心是找到一个系数向量 $\\mathbf{w} \\in \\mathbb{R}^{p}$，以最小化一个凸二次目标函数 $\\mathcal{L}(\\mathbf{w})$。该函数表示在拟合训练数据（能量和力）与控制模型复杂度（系数的大小）之间的一种权衡。\n\n目标函数由下式给出：\n$$\n\\mathcal{L}(\\mathbf{w}) = \\left\\|\\mathbf{X}_{E,\\text{train}}\\mathbf{w} - \\mathbf{y}_{E,\\text{train}}\\right\\|_{2}^{2} + \\gamma^{2}\\left\\|\\mathbf{X}_{F,\\text{train}}\\mathbf{w} - \\mathbf{y}_{F,\\text{train}}\\right\\|_{2}^{2} + \\lambda \\left\\|\\mathbf{w}\\right\\|_{2}^{2}\n$$\n此处，$\\mathbf{X}_{E,\\text{train}} \\in \\mathbb{R}^{n_{E,\\text{train}} \\times p}$ 和 $\\mathbf{X}_{F,\\text{train}} \\in \\mathbb{R}^{n_{F,\\text{train}} \\times p}$ 分别是训练能量和力的特征矩阵。向量 $\\mathbf{y}_{E,\\text{train}} \\in \\mathbb{R}^{n_{E,\\text{train}}}$ 和 $\\mathbf{y}_{F,\\text{train}} \\in \\mathbb{R}^{n_{F,\\text{train}}}$ 是对应的目标值。超参数是力权重 $\\gamma \\ge 0$ 和正则化强度 $\\lambda \\ge 0$。特征空间的维度是 $p=7$。\n\n为了找到最小化 $\\mathcal{L}(\\mathbf{w})$ 的最优系数向量 $\\hat{\\mathbf{w}}$，我们必须找到目标函数相对于 $\\mathbf{w}$ 的梯度为零的点。首先，我们展开平方欧几里得范数：\n$$\n\\mathcal{L}(\\mathbf{w}) = (\\mathbf{X}_{E,\\text{train}}\\mathbf{w} - \\mathbf{y}_{E,\\text{train}})^{\\top}(\\mathbf{X}_{E,\\text{train}}\\mathbf{w} - \\mathbf{y}_{E,\\text{train}}) + \\gamma^{2}(\\mathbf{X}_{F,\\text{train}}\\mathbf{w} - \\mathbf{y}_{F,\\text{train}})^{\\top}(\\mathbf{X}_{F,\\text{train}}\\mathbf{w} - \\mathbf{y}_{F,\\text{train}}) + \\lambda \\mathbf{w}^{\\top}\\mathbf{w}\n$$\n展开这些项得到：\n$$\n\\mathcal{L}(\\mathbf{w}) = (\\mathbf{w}^{\\top}\\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{X}_{E,\\text{train}}\\mathbf{w} - 2\\mathbf{y}_{E,\\text{train}}^{\\top}\\mathbf{X}_{E,\\text{train}}\\mathbf{w} + \\mathbf{y}_{E,\\text{train}}^{\\top}\\mathbf{y}_{E,\\text{train}}) + \\gamma^{2}(\\mathbf{w}^{\\top}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{X}_{F,\\text{train}}\\mathbf{w} - 2\\mathbf{y}_{F,\\text{train}}^{\\top}\\mathbf{X}_{F,\\text{train}}\\mathbf{w} + \\mathbf{y}_{F,\\text{train}}^{\\top}\\mathbf{y}_{F,\\text{train}}) + \\lambda \\mathbf{w}^{\\top}\\mathbf{w}\n$$\n现在，我们计算梯度 $\\nabla_{\\mathbf{w}} \\mathcal{L}(\\mathbf{w})$。使用标准矩阵微积分恒等式 $\\nabla_{\\mathbf{x}}(\\mathbf{x}^{\\top}\\mathbf{A}\\mathbf{x}) = 2\\mathbf{A}\\mathbf{x}$（对于对称矩阵 $\\mathbf{A}$）和 $\\nabla_{\\mathbf{x}}(\\mathbf{b}^{\\top}\\mathbf{x}) = \\mathbf{b}$，我们得到：\n$$\n\\nabla_{\\mathbf{w}} \\mathcal{L}(\\mathbf{w}) = 2\\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{X}_{E,\\text{train}}\\mathbf{w} - 2\\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{y}_{E,\\text{train}} + \\gamma^{2}(2\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{X}_{F,\\text{train}}\\mathbf{w} - 2\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{y}_{F,\\text{train}}) + 2\\lambda\\mathbf{w}\n$$\n将梯度设为零向量，$\\nabla_{\\mathbf{w}} \\mathcal{L}(\\hat{\\mathbf{w}}) = \\mathbf{0}$，得到：\n$$\n2\\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{X}_{E,\\text{train}}\\hat{\\mathbf{w}} - 2\\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{y}_{E,\\text{train}} + 2\\gamma^{2}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{X}_{F,\\text{train}}\\hat{\\mathbf{w}} - 2\\gamma^{2}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{y}_{F,\\text{train}} + 2\\lambda\\hat{\\mathbf{w}} = \\mathbf{0}\n$$\n除以 $2$ 并重新整理各项以分离 $\\hat{\\mathbf{w}}$：\n$$\n(\\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{X}_{E,\\text{train}} + \\gamma^{2}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{X}_{F,\\text{train}} + \\lambda\\mathbf{I})\\hat{\\mathbf{w}} = \\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{y}_{E,\\text{train}} + \\gamma^{2}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{y}_{F,\\text{train}}\n$$\n这是一个形如 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 的线性方程组，其中：\n- $\\mathbf{A} = \\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{X}_{E,\\text{train}} + \\gamma^{2}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{X}_{F,\\text{train}} + \\lambda\\mathbf{I}$ 是一个 $p \\times p$ 矩阵。\n- $\\mathbf{x} = \\hat{\\mathbf{w}}$ 是 $p \\times 1$ 的未知系数向量。\n- $\\mathbf{b} = \\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{y}_{E,\\text{train}} + \\gamma^{2}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{y}_{F,\\text{train}}$ 是一个 $p \\times 1$ 向量。\n由于 $\\mathbf{X}^{\\top}\\mathbf{X}$ 总是半正定的，且当 $\\lambda  0$ 时 $\\lambda\\mathbf{I}$ 是正定的，因此矩阵 $\\mathbf{A}$ 保证是正定的，从而可逆。即使当 $\\lambda = 0$ 时，考虑到特征是从连续分布中抽取的，并且数据点总数（$n_{E,\\text{train}} + n_{F,\\text{train}} = 8 + 24 = 32$）大于特征数量（$p=7$），来自能量和力的组合数据也确保了 $\\mathbf{A}$ 以概率 $1$ 是可逆的。\n\n因此，通过求解这个线性系统可以找到解 $\\hat{\\mathbf{w}}$。\n\n算法步骤如下：\n1.  **生成数据**：根据指定的协议创建矩阵 $\\mathbf{X}_E$、$\\mathbf{X}_F$ 和向量 $\\mathbf{y}_E$、$\\mathbf{y}_F$。这包括使用固定的随机种子 $s=2025$ 来确保可复现性。\n    -   特征维度为 $p=7$。\n    -   真实系数向量为 $\\mathbf{w}_{\\text{true}} = [0.8, -0.5, 0.3, 0.0, 0.2, -0.1, 0.05]^{\\top}$。\n    -   能量特征 $\\mathbf{X}_E \\in \\mathbb{R}^{12 \\times 7}$ 从 $\\mathcal{N}(0, 1^2)$ 中抽取。\n    -   力特征 $\\mathbf{X}_F \\in \\mathbb{R}^{36 \\times 7}$ 从 $\\mathcal{N}(0, 0.4^2)$ 中抽取。\n    -   能量响应为 $\\mathbf{y}_{E} = \\mathbf{X}_{E}\\mathbf{w}_{\\text{true}} + \\boldsymbol{\\varepsilon}_{E}$，噪声 $\\varepsilon_{E,i} \\sim \\mathcal{N}(0, 0.01^2)$。\n    -   力响应为 $\\mathbf{y}_{F} = \\mathbf{X}_{F}\\mathbf{w}_{\\text{true}} + \\boldsymbol{\\varepsilon}_{F}$，噪声 $\\varepsilon_{F,j} \\sim \\mathcal{N}(0, 0.02^2)$。\n    -   按规定将数据分为训练集（$\\mathbf{X}_{E,\\text{train}}$, $\\mathbf{y}_{E,\\text{train}}$, $\\mathbf{X}_{F,\\text{train}}$, $\\mathbf{y}_{F,\\text{train}}$）和验证集（$\\mathbf{X}_{E,\\text{val}}$, $\\mathbf{y}_{E,\\text{val}}$, $\\mathbf{X}_{F,\\text{val}}$, $\\mathbf{y}_{F,\\text{val}}$）。\n\n2.  **遍历超参数**：对于测试套件中的每一对 $(\\lambda, \\gamma)$：\n    a. 构建矩阵 $\\mathbf{A} = \\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{X}_{E,\\text{train}} + \\gamma^{2}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{X}_{F,\\text{train}} + \\lambda\\mathbf{I}_{p \\times p}$ 和向量 $\\mathbf{b} = \\mathbf{X}_{E,\\text{train}}^{\\top}\\mathbf{y}_{E,\\text{train}} + \\gamma^{2}\\mathbf{X}_{F,\\text{train}}^{\\top}\\mathbf{y}_{F,\\text{train}}$。\n    b. 求解线性系统 $\\mathbf{A}\\hat{\\mathbf{w}} = \\mathbf{b}$ 以得到 $\\hat{\\mathbf{w}}(\\lambda,\\gamma)$。这在数值上比计算 $\\mathbf{A}$ 的逆矩阵更稳定。\n\n3.  **评估性能**：使用获得的 $\\hat{\\mathbf{w}}$ 在验证数据上进行评估：\n    a. 计算能量预测值 $\\hat{\\mathbf{y}}_{E,\\text{val}} = \\mathbf{X}_{E,\\text{val}}\\hat{\\mathbf{w}}$。\n    b. 计算能量均方根误差：$\\mathrm{RMSE}_{E} = \\sqrt{\\frac{1}{n_{E,\\text{val}}}\\left\\|\\hat{\\mathbf{y}}_{E,\\text{val}} - \\mathbf{y}_{E,\\text{val}}\\right\\|_{2}^{2}}$。验证能量的数量为 $n_{E,\\text{val}} = 4$。\n    c. 计算力预测值 $\\hat{\\mathbf{y}}_{F,\\text{val}} = \\mathbf{X}_{F,\\text{val}}\\hat{\\mathbf{w}}$。\n    d. 计算力均方根误差：$\\mathrm{RMSE}_{F} = \\sqrt{\\frac{1}{n_{F,\\text{val}}}\\left\\|\\hat{\\mathbf{y}}_{F,\\text{val}} - \\mathbf{y}_{F,\\text{val}}\\right\\|_{2}^{2}}$。验证力的数量为 $n_{F,\\text{val}} = 12$。\n    e. 计算系数范数 $\\|\\hat{\\mathbf{w}}\\|_{2}$。\n\n4.  **报告结果**：为每对超参数收集三元组 $[\\mathrm{RMSE}_{E}, \\mathrm{RMSE}_{F}, \\|\\hat{\\mathbf{w}}\\|_{2}]$ 并按规定格式化。\n\n此过程将在提供的 Python 环境中实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the regularized linear regression problem for a synthetic SNAP-like dataset.\n    \"\"\"\n    # 1. Data Generation Protocol\n    s = 2025\n    rng = np.random.default_rng(s)\n\n    p = 7\n    n_E_total = 12\n    n_E_train = 8\n    n_E_val = 4\n    n_F_total = 36\n    n_F_train = 24\n    n_F_val = 12\n    \n    sigma_E = 0.01\n    sigma_F = 0.02\n\n    w_true = np.array([0.8, -0.5, 0.3, 0.0, 0.2, -0.1, 0.05])\n\n    # Generate feature matrices\n    X_E = rng.normal(loc=0.0, scale=1.0, size=(n_E_total, p))\n    X_F = rng.normal(loc=0.0, scale=0.4, size=(n_F_total, p))\n\n    # Split feature matrices\n    X_E_train = X_E[:n_E_train, :]\n    X_E_val = X_E[n_E_train:, :]\n    X_F_train = X_F[:n_F_train, :]\n    X_F_val = X_F[n_F_train:, :]\n\n    # Generate responses (energies and forces) with noise\n    eps_E = rng.normal(loc=0.0, scale=sigma_E, size=n_E_total)\n    eps_F = rng.normal(loc=0.0, scale=sigma_F, size=n_F_total)\n    \n    y_E = X_E @ w_true + eps_E\n    y_F = X_F @ w_true + eps_F\n\n    # Split responses\n    y_E_train = y_E[:n_E_train]\n    y_E_val = y_E[n_E_train:]\n    y_F_train = y_F[:n_F_train]\n    y_F_val = y_F[n_F_train:]\n\n    # Test suite of hyperparameters\n    test_cases = [\n        (0.0, 1.0),\n        (0.0001, 1.0),\n        (0.01, 1.0),\n        (1.0, 1.0),\n        (0.01, 0.0),\n        (0.01, 5.0)\n    ]\n\n    results = []\n    \n    # 2. Iterate Over Hyperparameters and Solve\n    for lambda_val, gamma_val in test_cases:\n        # Construct the components of the normal equations\n        # LHS = X_E.T @ X_E + gamma^2 * X_F.T @ X_F + lambda * I\n        # RHS = X_E.T @ y_E + gamma^2 * X_F.T @ y_F\n        \n        A_E = X_E_train.T @ X_E_train\n        A_F = X_F_train.T @ X_F_train\n        b_E = X_E_train.T @ y_E_train\n        b_F = X_F_train.T @ y_F_train\n\n        LHS = A_E + (gamma_val**2) * A_F + lambda_val * np.identity(p)\n        RHS = b_E + (gamma_val**2) * b_F\n\n        # Solve for the estimated coefficients w_hat\n        w_hat = np.linalg.solve(LHS, RHS)\n\n        # 3. Evaluate Performance on Validation Set\n        \n        # RMSE for energies\n        y_E_pred = X_E_val @ w_hat\n        rmse_E = np.sqrt(np.mean((y_E_pred - y_E_val)**2))\n\n        # RMSE for forces\n        y_F_pred = X_F_val @ w_hat\n        rmse_F = np.sqrt(np.mean((y_F_pred - y_F_val)**2))\n        \n        # L2-norm of coefficients\n        w_norm = np.linalg.norm(w_hat)\n        \n        results.append([rmse_E, rmse_F, w_norm])\n\n    # 4. Format and Print Final Output\n    formatted_results = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}