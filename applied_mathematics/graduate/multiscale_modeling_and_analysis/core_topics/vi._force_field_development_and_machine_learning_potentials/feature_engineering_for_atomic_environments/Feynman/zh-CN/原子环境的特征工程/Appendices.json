{
    "hands_on_practices": [
        {
            "introduction": "表征原子环境的第一步是识别其近邻原子并量化它们之间的距离。本练习将引导你完成创建简单径向描述符的基本过程，其中融合了周期性边界条件和平滑截断函数等计算材料科学中的核心技术。通过这个实践，你将掌握从原子坐标出发，构建能够捕捉局部环境特征的原子指纹的基础技能。",
            "id": "3757519",
            "problem": "考虑一个在三维空间中具有周期性边界条件（PBC）的简单立方布拉菲晶格。原胞晶格矢量为 $\\mathbf{a}_1=(3.0\\,\\mathrm{\\AA},0,0)$、$\\mathbf{a}_2=(0,3.0\\,\\mathrm{\\AA},0)$ 和 $\\mathbf{a}_3=(0,0,3.0\\,\\mathrm{\\AA})$。在单个单胞内，有五个原子，其笛卡尔坐标（单位为 $\\mathrm{\\AA}$）分别为：原子 $i$ 位于 $(0,0,0)$，其他四个原子位于 $(1.0,0,0)$、$(0,1.2,0)$、$(0,0,1.8)$ 和 $(2.5,0,0)$。距离是使用欧几里得范数和周期性边界条件下的最小镜像约定来计算的。\n\n您的任务是为原子 $i$ 构建一个标量径向指纹，该指纹能捕捉其在半径 $r_c = 2.0\\,\\mathrm{\\AA}$ 的球形邻域内的局域原子环境。该指纹必须包含一个光滑的截断和一个局域化的径向加权。\n\n从适用于多尺度建模与分析的基本原理出发：\n\n1. 使用周期性边界条件（PBC）和最小镜像约定，确定原子 $i$ 的邻居列表，方法是识别哪些原子（如果需要，包括其周期性镜像）位于原子 $i$ 的 $r_c$ 距离之内。报告对指纹有贡献的每个不同的原子间距 $r_{ij}$。\n2. 推导一个定义在 $[0,r_c]$ 上的光滑余弦截断函数 $f_c(r)$，该函数非负，满足 $f_c(0)=1$、$f_c(r_c)=0$，并且在两个端点的一阶导数均为零，即 $f_c'(0)=0$ 和 $f_c'(r_c)=0$。角度必须以弧度处理。\n3. 使用以 $R_s=1.0\\,\\mathrm{\\AA}$ 为中心、宽度参数 $\\eta=4.0\\,\\mathrm{\\AA}^{-2}$ 的高斯径向基，构建原子 $i$ 的标量径向指纹 $G_i(R_s;\\eta)$。该指纹是对截断半径内所有邻居的求和，其中每个邻居的贡献是高斯径向权重与在其与原子 $i$ 的最小镜像距离处计算的截断值的乘积。\n\n将最终指纹值 $G_i(R_s;\\eta)$ 表示为由 $\\exp(\\cdot)$、$\\pi$ 和根式组成的单个闭式解析表达式；不要提供小数近似值。最终答案必须是无量纲的，并以一个表达式呈现。三角函数中的角度必须是弧度。",
            "solution": "首先，将根据指定的科学合理性、适定性和客观性标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取给定信息**\n- **晶格与周期性**：具有三维周期性边界条件（PBC）的简单立方布拉菲晶格。\n- **晶格矢量**：$\\mathbf{a}_1=(3.0\\,\\mathrm{\\AA},0,0)$、$\\mathbf{a}_2=(0,3.0\\,\\mathrm{\\AA},0)$、$\\mathbf{a}_3=(0,0,3.0\\,\\mathrm{\\AA})$。这定义了一个边长为 $L=3.0\\,\\mathrm{\\AA}$ 的立方晶胞。\n- **原子坐标**：一个中心原子 $i$ 位于 $\\mathbf{r}_i=(0,0,0)\\,\\mathrm{\\AA}$。单胞内其他四个原子位于位置 $\\mathbf{r}_j$：$(1.0,0,0)\\,\\mathrm{\\AA}$、$(0,1.2,0)\\,\\mathrm{\\AA}$、$(0,0,1.8)\\,\\mathrm{\\AA}$ 和 $(2.5,0,0)\\,\\mathrm{\\AA}$。\n- **距离计算**：采用最小镜像约定（MIC）的欧几里得范数。\n- **截断半径**：$r_c = 2.0\\,\\mathrm{\\AA}$。\n- **任务1**：确定邻居列表，并报告 $r_c$ 范围内邻居的独特原子间距 $r_{ij}$。\n- **任务2**：推导一个在 $[0, r_c]$ 上的光滑余弦截断函数 $f_c(r)$，使得 $f_c(r) \\ge 0$、$f_c(0)=1$、$f_c(r_c)=0$、$f_c'(0)=0$ 和 $f_c'(r_c)=0$。\n- **任务3**：计算标量径向指纹 $G_i(R_s;\\eta)$，定义为 $G_i = \\sum_{j} \\exp(-\\eta(r_{ij}-R_s)^2) f_c(r_{ij})$，对截断半径内的邻居求和。\n- **指纹参数**：高斯中心 $R_s=1.0\\,\\mathrm{\\AA}$；宽度参数 $\\eta=4.0\\,\\mathrm{\\AA}^{-2}$。\n- **最终答案格式**：单个闭式解析表达式，无量纲。\n\n**第2步：使用提取的给定信息进行验证**\n- **科学基础**：该问题牢固地植根于计算材料科学和凝聚态物理学。原子环境描述符或指纹，如此处所述（这是一种Behler-Parrinello对称函数的形式），是开发机器学习原子间势的基石。PBC、MIC和光滑截断函数的概念是标准且根本上合理的。\n- **适定性**：问题提供了所有必要的数据（原子位置、晶格参数、截断半径、函数参数）和清晰的定义，以唯一地确定结果。结构逻辑清晰，导向一个单一、可计算的答案。\n- **客观性**：问题使用精确、定量和无偏见的语言陈述。没有主观或模糊的术语。\n- **一致性与可行性**：所提供的值对于模型原子系统是一致且物理上合理的。将MIC应用于给定的坐标和晶格矢量是一个标准的、明确的过程。不存在矛盾或不可行的条件。\n\n**第3步：结论与行动**\n问题是有效的。这是一个适定的、科学上合理的练习，用于应用多尺度建模的基本概念。现在将进行求解过程。\n\n### 求解推导\n\n求解过程按照问题陈述中概述的三个部分进行。\n\n**第1部分：邻居列表和原子间距**\n中心原子 $i$ 位于原点 $\\mathbf{r}_i = (0,0,0)$。模拟晶胞是由正交晶格矢量定义的立方体，边长 $L = 3.0\\,\\mathrm{\\AA}$。到任何其他原子 $j$（位于位置 $\\mathbf{r}_j$）的距离必须使用最小镜像约定计算。位移矢量为 $\\mathbf{d}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i = \\mathbf{r}_j$。最小镜像位移矢量 $\\mathbf{d}_{ij}^{\\text{mic}}$ 的分量为 $d_k^{\\text{mic}} = d_k - L \\cdot \\text{nint}(d_k / L)$，其中 $k \\in \\{x,y,z\\}$，$\\text{nint}(\\cdot)$ 是最近整数函数。距离则为 $r_{ij} = ||\\mathbf{d}_{ij}^{\\text{mic}}||$。\n\n- **位于 $(1.0, 0, 0)\\,\\mathrm{\\AA}$ 的原子**：\n  - 位移为 $\\mathbf{d} = (1.0, 0, 0)$。\n  - $d_x^{\\text{mic}} = 1.0 - 3.0 \\cdot \\text{nint}(1.0/3.0) = 1.0 - 3.0 \\cdot 0 = 1.0$。\n  - 最小镜像距离为 $r_{ij} = \\sqrt{1.0^2} = 1.0\\,\\mathrm{\\AA}$。由于 $1.0  r_c = 2.0$，这是一个邻居。\n\n- **位于 $(0, 1.2, 0)\\,\\mathrm{\\AA}$ 的原子**：\n  - 位移为 $\\mathbf{d} = (0, 1.2, 0)$。\n  - $d_y^{\\text{mic}} = 1.2 - 3.0 \\cdot \\text{nint}(1.2/3.0) = 1.2 - 3.0 \\cdot 0 = 1.2$。\n  - 最小镜像距离为 $r_{ij} = \\sqrt{1.2^2} = 1.2\\,\\mathrm{\\AA}$。由于 $1.2  r_c$，这是一个邻居。\n\n- **位于 $(0, 0, 1.8)\\,\\mathrm{\\AA}$ 的原子**：\n  - 位移为 $\\mathbf{d} = (0, 0, 1.8)$。\n  - $d_z^{\\text{mic}} = 1.8 - 3.0 \\cdot \\text{nint}(1.8/3.0) = 1.8 - 3.0 \\cdot 1 = -1.2$。\n  - 最小镜像距离为 $r_{ij} = \\sqrt{(-1.2)^2} = 1.2\\,\\mathrm{\\AA}$。由于 $1.2  r_c$，这是一个邻居。\n\n- **位于 $(2.5, 0, 0)\\,\\mathrm{\\AA}$ 的原子**：\n  - 位移为 $\\mathbf{d} = (2.5, 0, 0)$。\n  - $d_x^{\\text{mic}} = 2.5 - 3.0 \\cdot \\text{nint}(2.5/3.0) = 2.5 - 3.0 \\cdot 1 = -0.5$。\n  - 最小镜像距离为 $r_{ij} = \\sqrt{(-0.5)^2} = 0.5\\,\\mathrm{\\AA}$。由于 $0.5  r_c$，这是一个邻居。\n\n所有四个原子（或它们最近的周期性镜像）都在截断半径 $r_c = 2.0\\,\\mathrm{\\AA}$ 内。对指纹有贡献的原子间距列表为 $\\{0.5, 1.0, 1.2, 1.2\\}\\,\\mathrm{\\AA}$。不同的距离是 $0.5\\,\\mathrm{\\AA}$、$1.0\\,\\mathrm{\\AA}$ 和 $1.2\\,\\mathrm{\\AA}$。\n\n**第2部分：截断函数的推导**\n我们需要一个在 $[0, r_c]$ 上的光滑函数 $f_c(r)$，满足边界条件 $f_c(0)=1$、$f_c(r_c)=0$、$f_c'(0)=0$ 和 $f_c'(r_c)=0$。一个满足这些要求的标准函数是基于余弦变换的。对于 $r \\in [0, r_c]$，我们定义：\n$$ f_c(r) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi r}{r_c}\\right) + 1 \\right) $$\n对于 $r > r_c$，$f_c(r) = 0$。让我们用 $r_c = 2.0\\,\\mathrm{\\AA}$ 来验证这些条件：\n- $f_c(0) = \\frac{1}{2} (\\cos(0) + 1) = \\frac{1}{2}(1+1) = 1$。\n- $f_c(r_c) = f_c(2.0) = \\frac{1}{2} (\\cos(\\pi) + 1) = \\frac{1}{2}(-1+1) = 0$。\n- 一阶导数为 $f_c'(r) = \\frac{d}{dr} \\left[ \\frac{1}{2} \\cos\\left(\\frac{\\pi r}{r_c}\\right) + \\frac{1}{2} \\right] = -\\frac{\\pi}{2r_c} \\sin\\left(\\frac{\\pi r}{r_c}\\right)$。\n- $f_c'(0) = -\\frac{\\pi}{2r_c} \\sin(0) = 0$。\n- $f_c'(r_c) = -\\frac{\\pi}{2r_c} \\sin(\\pi) = 0$。\n该函数在其定义域上也是非负的。因此，这个函数是应使用的正确截断函数。对于本问题，当 $r \\in [0, 2.0]$ 时，$f_c(r) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi r}{2}\\right) + 1 \\right)$。\n\n**第3部分：径向指纹的计算**\n径向指纹 $G_i$ 是截断半径内所有邻居 $j$ 的贡献之和：\n$$ G_i = \\sum_{j, r_{ij}  r_c} \\exp(-\\eta(r_{ij}-R_s)^2) f_c(r_{ij}) $$\n我们使用参数 $R_s = 1.0\\,\\mathrm{\\AA}$、$\\eta = 4.0\\,\\mathrm{\\AA}^{-2}$ 和四个邻居距离 $\\{0.5, 1.0, 1.2, 1.2\\}\\,\\mathrm{\\AA}$。\n\n- **距离为 $r=0.5\\,\\mathrm{\\AA}$ 的邻居的贡献**：\n  - 高斯权重：$\\exp(-4.0(0.5-1.0)^2) = \\exp(-4.0(-0.5)^2) = \\exp(-1)$。\n  - 截断值：$f_c(0.5) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 0.5}{2}) + 1) = \\frac{1}{2}(\\cos(\\frac{\\pi}{4}) + 1) = \\frac{1}{2}(\\frac{\\sqrt{2}}{2} + 1) = \\frac{2+\\sqrt{2}}{4}$。\n  - 贡献：$\\exp(-1) \\frac{2+\\sqrt{2}}{4}$。\n\n- **距离为 $r=1.0\\,\\mathrm{\\AA}$ 的邻居的贡献**：\n  - 高斯权重：$\\exp(-4.0(1.0-1.0)^2) = \\exp(0) = 1$。\n  - 截断值：$f_c(1.0) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 1.0}{2}) + 1) = \\frac{1}{2}(\\cos(\\frac{\\pi}{2}) + 1) = \\frac{1}{2}(0+1) = \\frac{1}{2}$。\n  - 贡献：$1 \\cdot \\frac{1}{2} = \\frac{1}{2}$。\n\n- **两个距离为 $r=1.2\\,\\mathrm{\\AA}$ 的邻居的贡献**：\n  - 单个邻居的高斯权重：$\\exp(-4.0(1.2-1.0)^2) = \\exp(-4.0(0.2)^2) = \\exp(-4.0 \\cdot 0.04) = \\exp(-0.16) = \\exp(-\\frac{4}{25})$。\n  - 截断值：$f_c(1.2) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 1.2}{2}) + 1) = \\frac{1}{2}(\\cos(0.6\\pi) + 1) = \\frac{1}{2}(\\cos(\\frac{3\\pi}{5}) + 1)$。\n  - $\\cos(\\frac{3\\pi}{5})$ 的精确值为 $\\frac{1-\\sqrt{5}}{4}$。\n  - 截断值：$f_c(1.2) = \\frac{1}{2}(\\frac{1-\\sqrt{5}}{4} + 1) = \\frac{1}{2}(\\frac{1-\\sqrt{5}+4}{4}) = \\frac{5-\\sqrt{5}}{8}$。\n  - 这两个相同邻居的总贡献：$2 \\cdot \\exp(-\\frac{4}{25}) \\cdot \\frac{5-\\sqrt{5}}{8} = \\exp(-\\frac{4}{25}) \\frac{5-\\sqrt{5}}{4}$。\n\n总指纹值 $G_i$ 是这些贡献的总和：\n$$ G_i = \\exp(-1) \\frac{2+\\sqrt{2}}{4} + \\frac{1}{2} + \\exp(-\\frac{4}{25}) \\frac{5-\\sqrt{5}}{4} $$\n为了将其表示为单个表达式，我们找到一个公分母：\n$$ G_i = \\frac{\\exp(-1)(2+\\sqrt{2}) + 2 + \\exp(-\\frac{4}{25})(5-\\sqrt{5})}{4} $$\n$$ G_i = \\frac{1}{4} \\left( \\exp(-1)(2+\\sqrt{2}) + 2 + \\exp\\left(-\\frac{4}{25}\\right)(5-\\sqrt{5}) \\right) $$\n这是指纹的最终闭式解析表达式。",
            "answer": "$$ \\boxed{\\frac{1}{4} \\left( \\exp(-1)(2+\\sqrt{2}) + 2 + \\exp\\left(-\\frac{4}{25}\\right)(5-\\sqrt{5}) \\right)} $$"
        },
        {
            "introduction": "任何原子环境描述符的一个关键要求是在旋转和平移下的不变性，这确保了特征向量仅依赖于内部几何结构，而非系统在空间中的朝向或位置。本练习旨在检验这一原理，但并非通过繁琐的数值计算，而是通过第一性原理推导来揭示基于距离的描述符所固有的对称性。这个思想实验将深化你对描述符设计背后物理约束的理解。",
            "id": "3757496",
            "problem": "考虑一个以原子为中心的环境描述符，该描述符是利用径向二体信息，通过对有限径向中心集进行高斯展宽而构建的。设有一个索引为 $0$ 的中心原子和一个邻居集 $\\mathcal{N} = \\{1,2,3\\}$。对于一个构型 $\\mathcal{C}$，其原子位置为 $\\{\\mathbf{r}_j\\}_{j=0}^{3} \\subset \\mathbb{R}^3$，其 $K$ 维描述符向量 $\\mathbf{g}(\\mathcal{C}) \\in \\mathbb{R}^K$ 的分量定义如下\n$$\ng_k(\\mathcal{C}) \\equiv \\sum_{j \\in \\mathcal{N}} \\exp\\!\\left(-\\frac{\\left(\\|\\mathbf{r}_j - \\mathbf{r}_0\\| - \\mu_k\\right)^2}{2\\sigma^2}\\right), \\quad k = 1,\\dots,K,\n$$\n其中 $\\mu_k$ 是预设的径向中心，$\\sigma  0$ 是预设的宽度。该描述符应在刚性运动下保持不变。给定两个构型 $\\mathcal{C}_A$ 和 $\\mathcal{C}_B$，它们通过刚性旋转和平移相关联：\n$$\n\\mathbf{r}_j^{(B)} = \\mathbf{R}\\,\\mathbf{r}_j^{(A)} + \\mathbf{t}, \\quad j = 0,1,2,3,\n$$\n其中\n$$\n\\mathbf{R} = \\begin{pmatrix} 0  -1  0 \\\\ 1  \\phantom{-}0  0 \\\\ 0  \\phantom{-}0  1 \\end{pmatrix}, \\quad \\mathbf{t} = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0.5 \\end{pmatrix}.\n$$\n构型 $\\mathcal{C}_A$ 的原子坐标（单位为埃）如下：\n$$\n\\mathbf{r}_0^{(A)} = \\begin{pmatrix} 0.3 \\\\ -0.1 \\\\ 0.2 \\end{pmatrix}, \\quad\n\\mathbf{r}_1^{(A)} = \\begin{pmatrix} 1.3 \\\\ -0.1 \\\\ 0.2 \\end{pmatrix}, \\quad\n\\mathbf{r}_2^{(A)} = \\begin{pmatrix} 0.3 \\\\ 0.4 \\\\ 0.2 \\end{pmatrix}, \\quad\n\\mathbf{r}_3^{(A)} = \\begin{pmatrix} 0.3 \\\\ -0.1 \\\\ -0.6 \\end{pmatrix}.\n$$\n使用描述符参数 $K = 3$，$\\sigma = 0.1$ 和\n$$\n\\mu_1 = 0.5, \\quad \\mu_2 = 0.8, \\quad \\mu_3 = 1.0.\n$$\n仅从 $\\mathbb{R}^3$ 中刚性旋转和平移的定义以及欧几里得范数出发，通过显式计算差值的欧几里得范数，判断该描述符是否对构型 $\\mathcal{C}_A$ 和 $\\mathcal{C}_B$ 产生相同的特征向量\n$$\nD \\equiv \\left\\|\\mathbf{g}(\\mathcal{C}_A) - \\mathbf{g}(\\mathcal{C}_B)\\right\\|_2.\n$$\n请给出 $D$ 的值。如果需要近似，则四舍五入到四位有效数字；然而，如果可以从第一性原理推导出精确值，请给出精确值。最终答案必须是一个不带单位的实数。",
            "solution": "经评估，用户提供的问题是有效的。该问题具有科学依据、适定且客观。所涉及的量和变换在计算材料科学和物理学领域是标准的。所有必要数据均已提供，且无内部矛盾。因此，我们可以着手求解。\n\n问题要求计算量 $D \\equiv \\left\\|\\mathbf{g}(\\mathcal{C}_A) - \\mathbf{g}(\\mathcal{C}_B)\\right\\|_2$，其中 $\\mathbf{g}(\\mathcal{C})$ 是构型 $\\mathcal{C}$ 的以原子为中心的环境描述符。构型 $\\mathcal{C}_A$ 和 $\\mathcal{C}_B$ 通过刚性运动相关联。该问题的结构旨在检验此描述符的旋转和平移不变性这一基本性质。我们将从第一性原理出发证明此不变性。\n\n描述符向量 $\\mathbf{g}(\\mathcal{C})$ 的分量 $g_k(\\mathcal{C})$（其中 $k=1, \\dots, K$）定义为：\n$$\ng_k(\\mathcal{C}) = \\sum_{j \\in \\mathcal{N}} \\exp\\!\\left(-\\frac{\\left(\\|\\mathbf{r}_j - \\mathbf{r}_0\\| - \\mu_k\\right)^2}{2\\sigma^2}\\right)\n$$\n此处，$\\mathbf{r}_0$ 是中心原子的位置，$\\{\\mathbf{r}_j\\}_{j \\in \\mathcal{N}}$ 是其邻居原子的位置。该定义表明，描述符 $\\mathbf{g}(\\mathcal{C})$ 完全由中心原子与其邻居原子之间的一组标量距离 $\\{ \\|\\mathbf{r}_j - \\mathbf{r}_0\\| \\}_{j \\in \\mathcal{N}}$ 决定。\n\n两个构型 $\\mathcal{C}_A$ 和 $\\mathcal{C}_B$ 通过刚性运动相关联，因此对于任意原子 $j$：\n$$\n\\mathbf{r}_j^{(B)} = \\mathbf{R}\\,\\mathbf{r}_j^{(A)} + \\mathbf{t}\n$$\n其中 $\\mathbf{R}$ 是一个旋转矩阵，$\\mathbf{t}$ 是一个平移向量。\n\n我们的第一步是分析这种变换对原子间距离的影响。我们考虑两个原子之间的矢量差，例如中心原子 $0$ 和一个邻居原子 $j$：\n$$\n\\mathbf{r}_j^{(B)} - \\mathbf{r}_0^{(B)} = (\\mathbf{R}\\,\\mathbf{r}_j^{(A)} + \\mathbf{t}) - (\\mathbf{R}\\,\\mathbf{r}_0^{(A)} + \\mathbf{t}) = \\mathbf{R}\\,\\mathbf{r}_j^{(A)} - \\mathbf{R}\\,\\mathbf{r}_0^{(A)} = \\mathbf{R}(\\mathbf{r}_j^{(A)} - \\mathbf{r}_0^{(A)})\n$$\n这表明平移向量 $\\mathbf{t}$ 不影响原子间的相对位置矢量。\n\n接下来，我们计算该矢量的范数。一个向量 $\\mathbf{v}$ 的欧几里得范数定义为 $\\|\\mathbf{v}\\| = \\sqrt{\\mathbf{v}^T\\mathbf{v}}$。因此，在构型 $\\mathcal{C}_B$ 中距离矢量的范数平方为：\n$$\n\\left\\|\\mathbf{r}_j^{(B)} - \\mathbf{r}_0^{(B)}\\right\\|^2 = \\left\\|\\mathbf{R}(\\mathbf{r}_j^{(A)} - \\mathbf{r}_0^{(A)})\\right\\|^2\n$$\n令 $\\mathbf{d}_j^{(A)} = \\mathbf{r}_j^{(A)} - \\mathbf{r}_0^{(A)}$。那么，\n$$\n\\left\\|\\mathbf{R}\\,\\mathbf{d}_j^{(A)}\\right\\|^2 = \\left(\\mathbf{R}\\,\\mathbf{d}_j^{(A)}\\right)^T \\left(\\mathbf{R}\\,\\mathbf{d}_j^{(A)}\\right) = \\left(\\mathbf{d}_j^{(A)}\\right)^T \\mathbf{R}^T \\mathbf{R}\\, \\mathbf{d}_j^{(A)}\n$$\n根据定义，旋转矩阵 $\\mathbf{R}$ 是一个正交矩阵，这意味着它保持内积不变。这可以用性质 $\\mathbf{R}^T\\mathbf{R} = \\mathbf{I}$ 来表示，其中 $\\mathbf{I}$ 是单位矩阵。给定的矩阵 $\\mathbf{R}$ 满足此条件：\n$$\n\\mathbf{R}^T\\mathbf{R} = \\begin{pmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} (0)(0) + (1)(1) + (0)(0)  (0)(-1) + (1)(0) + (0)(0)  (0)(0) + (1)(0) + (0)(1) \\\\ (-1)(0) + (0)(1) + (0)(0)  (-1)(-1) + (0)(0) + (0)(0)  (-1)(0) + (0)(0) + (0)(1) \\\\ (0)(0) + (0)(1) + (1)(0)  (0)(-1) + (0)(0) + (1)(0)  (0)(0) + (0)(0) + (1)(1) \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\mathbf{I}\n$$\n将 $\\mathbf{R}^T\\mathbf{R} = \\mathbf{I}$ 代入范数平方的表达式中：\n$$\n\\left\\|\\mathbf{R}\\,\\mathbf{d}_j^{(A)}\\right\\|^2 = \\left(\\mathbf{d}_j^{(A)}\\right)^T \\mathbf{I}\\, \\mathbf{d}_j^{(A)} = \\left(\\mathbf{d}_j^{(A)}\\right)^T \\mathbf{d}_j^{(A)} = \\left\\|\\mathbf{d}_j^{(A)}\\right\\|^2\n$$\n由于范数是非负的，我们可以对两边取平方根：\n$$\n\\left\\|\\mathbf{r}_j^{(B)} - \\mathbf{r}_0^{(B)}\\right\\| = \\left\\|\\mathbf{r}_j^{(A)} - \\mathbf{r}_0^{(A)}\\right\\|\n$$\n这个结果从第一性原理证明了原子间距离在刚性运动下是不变的。\n\n现在，我们可以评估每种构型的描述符分量。对于任何 $k \\in \\{1, 2, 3\\}$：\n$$\ng_k(\\mathcal{C}_A) = \\sum_{j \\in \\mathcal{N}} \\exp\\!\\left(-\\frac{\\left(\\|\\mathbf{r}_j^{(A)} - \\mathbf{r}_0^{(A)}\\| - \\mu_k\\right)^2}{2\\sigma^2}\\right)\n$$\n$$\ng_k(\\mathcal{C}_B) = \\sum_{j \\in \\mathcal{N}} \\exp\\!\\left(-\\frac{\\left(\\|\\mathbf{r}_j^{(B)} - \\mathbf{r}_0^{(B)}\\| - \\mu_k\\right)^2}{2\\sigma^2}\\right)\n$$\n正如我们刚刚证明的，对于每个 $j \\in \\mathcal{N}$ 都有 $\\|\\mathbf{r}_j^{(A)} - \\mathbf{r}_0^{(A)}\\| = \\|\\mathbf{r}_j^{(B)} - \\mathbf{r}_0^{(B)}\\|$，因此对于两种构型，指数函数的自变量以及随后的求和都是相同的。\n因此，对于每个分量 $k$：\n$$\ng_k(\\mathcal{C}_A) = g_k(\\mathcal{C}_B)\n$$\n这意味着描述符向量本身是相同的：\n$$\n\\mathbf{g}(\\mathcal{C}_A) = \\mathbf{g}(\\mathcal{C}_B)\n$$\n因此，差向量是零向量：\n$$\n\\mathbf{g}(\\mathcal{C}_A) - \\mathbf{g}(\\mathcal{C}_B) = \\mathbf{0}\n$$\n量 $D$ 是这个差向量的欧几里得范数：\n$$\nD = \\|\\mathbf{g}(\\mathcal{C}_A) - \\mathbf{g}(\\mathcal{C}_B)\\|_2 = \\|\\mathbf{0}\\|_2 = 0\n$$\n$D$ 的值恰好是 $0$。这个结果是描述符定义的直接推论，其构造使其在刚性运动下保持不变。得出这个结论并不需要原子坐标 $\\{\\mathbf{r}_j^{(A)}\\}$、描述符中心 $\\{\\mu_k\\}$ 和宽度 $\\sigma$ 的具体数值，该结论对任何此类参数都成立。这是一个概念性问题，从第一性原理的推导得出了精确的答案。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在构建并验证了一个简单的描述符后，我们必须批判性地评估其表达能力。本练习揭示了仅基于二体（成对）距离的描述符的一个根本局限性：它们可能无法区分几何上不同的结构。通过比较两个产生相同距离直方图但结构迥异的原子构型，我们将揭示为何需要包含如键角等高阶信息来创建唯一且鲁棒的原子指纹。",
            "id": "3757533",
            "problem": "在多尺度建模和分析中，原子环境的一个常用描述符是径向分布函数 (RDF)，它通常通过成对距离直方图来近似，该直方图统计有多少原子间距落入预设的区间内。考虑一个基于成对距离直方图的描述符的以下情境。设区间边界由以下半开区间指定\n$$\\mathcal{B}_{1} = [1.5, 2.5),\\quad \\mathcal{B}_{2} = [2.5, 3.5),\\quad \\mathcal{B}_{3} = [3.5, 4.5),\\quad \\mathcal{B}_{4} = [4.5, 5.5).$$\n给定两个原子环境，每个环境包含位于三维欧几里得空间中的四个原子，其笛卡尔坐标以埃（angstrom）为单位给出。第一个环境是\n$$\\mathcal{E}_{A} = \\{ \\mathbf{a}_{0}, \\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3} \\},\\quad \\mathbf{a}_{0} = (0, 0, 0),\\ \\mathbf{a}_{1} = (2, 0, 0),\\ \\mathbf{a}_{2} = (0, 3, 0),\\ \\mathbf{a}_{3} = (0, 0, 4).$$\n第二个环境是\n$$\\mathcal{E}_{B} = \\{ \\mathbf{b}_{0}, \\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3} \\},\\quad \\mathbf{b}_{0} = (0, 0, 0),\\ \\mathbf{b}_{1} = (2, 0, 0),\\ \\mathbf{b}_{2} = (0, 0, 3),$$\n并且 $$\\mathbf{b}_{3} = (x, y, z)$$ 的选择使其满足以下距离条件\n$$\\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\| = 4.9,\\quad \\|\\mathbf{b}_{3} - \\mathbf{b}_{1}\\| = 4.0,\\quad \\|\\mathbf{b}_{3} - \\mathbf{b}_{2}\\| = 3.7,$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数。假设 $\\mathbf{b}_{3}$ 的笛卡尔坐标满足 $x = \\frac{24.01 + 4 - 16}{4}$ 和 $z = \\frac{24.01 + 9 - 13.69}{6}$，且 $y$ 的选择能够精确满足上述三个距离约束。\n\n任务：\n1. 仅使用欧几里得距离的定义和直方图区间 $\\mathcal{B}_{1}, \\mathcal{B}_{2}, \\mathcal{B}_{3}, \\mathcal{B}_{4}$，计算 $\\mathcal{E}_{A}$ 和 $\\mathcal{E}_{B}$ 的成对距离，并统计每个区间中的计数。证明这两个环境共享完全相同的成对距离直方图。\n2. 从顶点为 $\\mathbf{p}_{0}, \\mathbf{p}_{1}, \\mathbf{p}_{2}, \\mathbf{p}_{3}$ 的四面体体积的几何定义出发，\n$$V = \\frac{1}{6}\\left|(\\mathbf{p}_{1} - \\mathbf{p}_{0}) \\cdot \\left((\\mathbf{p}_{2} - \\mathbf{p}_{0}) \\times (\\mathbf{p}_{3} - \\mathbf{p}_{0})\\right)\\right|,$$\n分别推导由 $\\mathcal{E}_{A}$ 和 $\\mathcal{E}_{B}$ 决定的四面体体积 $V_{A}$ 和 $V_{B}$。\n3. 利用基本定义以及第1和第2部分的结果，解释为什么成对距离直方图不是原子环境的唯一描述符。您的解释应提及分箱（binning）和直方图的无标签特性所导致的信息损失。\n4. 计算量\n$$\\Delta V = V_{A} - V_{B},$$\n并提供其数值。将您的答案四舍五入到四位有效数字。以立方埃为单位表示最终答案。\n\n您的最终答案必须是一个等于 $\\Delta V$ 的实数，并按要求进行四舍五入。请勿在最终的方框答案中包含单位。",
            "solution": "问题陈述已经过严格验证，被认为是科学上合理、定义明确、客观且内部一致的。为获得唯一解所需的所有数据和定义均已提供。该问题是计算材料科学领域的一个有效练习，特别关注原子环境描述符的性质。因此，我们可以着手求解。\n\n该问题需要通过多步分析，比较两个四原子环境 $\\mathcal{E}_{A}$ 和 $\\mathcal{E}_{B}$，以证明成对距离直方图作为结构描述符的非唯一性。\n\n**任务1：成对距离直方图**\n\n首先，我们计算每个环境的所有成对距离集合。对于一个包含4个原子的系统，存在 $\\binom{4}{2} = 6$ 个唯一的成对距离。\n\n对于环境 $\\mathcal{E}_{A} = \\{ \\mathbf{a}_{0}, \\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3} \\}$，其坐标以埃为单位为 $\\mathbf{a}_{0} = (0, 0, 0)$, $\\mathbf{a}_{1} = (2, 0, 0)$, $\\mathbf{a}_{2} = (0, 3, 0)$ 和 $\\mathbf{a}_{3} = (0, 0, 4)$：\n成对距离 $d_{ij} = \\|\\mathbf{a}_j - \\mathbf{a}_i\\|$ 为：\n$d_{01} = \\|\\mathbf{a}_{1} - \\mathbf{a}_{0}\\| = \\|(2, 0, 0)\\| = \\sqrt{2^2} = 2$.\n$d_{02} = \\|\\mathbf{a}_{2} - \\mathbf{a}_{0}\\| = \\|(0, 3, 0)\\| = \\sqrt{3^2} = 3$.\n$d_{03} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{0}\\| = \\|(0, 0, 4)\\| = \\sqrt{4^2} = 4$.\n$d_{12} = \\|\\mathbf{a}_{2} - \\mathbf{a}_{1}\\| = \\|(-2, 3, 0)\\| = \\sqrt{(-2)^2 + 3^2 + 0^2} = \\sqrt{4 + 9} = \\sqrt{13}$.\n$d_{13} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{1}\\| = \\|(-2, 0, 4)\\| = \\sqrt{(-2)^2 + 0^2 + 4^2} = \\sqrt{4 + 16} = \\sqrt{20}$.\n$d_{23} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{2}\\| = \\|(0, -3, 4)\\| = \\sqrt{0^2 + (-3)^2 + 4^2} = \\sqrt{9 + 16} = \\sqrt{25} = 5$.\n\n$\\mathcal{E}_{A}$ 的距离集合为 $\\{2, 3, 4, \\sqrt{13}, \\sqrt{20}, 5\\}$。其数值近似为 $\\{2.0, 3.0, 4.0, 3.606, 4.472, 5.0\\}$。\n使用给定的区间 $\\mathcal{B}_{1} = [1.5, 2.5)$, $\\mathcal{B}_{2} = [2.5, 3.5)$, $\\mathcal{B}_{3} = [3.5, 4.5)$, $\\mathcal{B}_{4} = [4.5, 5.5)$:\n- $d_{01}=2.0 \\in \\mathcal{B}_{1}$\n- $d_{02}=3.0 \\in \\mathcal{B}_{2}$\n- $d_{12} \\approx 3.606 \\in \\mathcal{B}_{3}$\n- $d_{03}=4.0 \\in \\mathcal{B}_{3}$\n- $d_{13} \\approx 4.472 \\in \\mathcal{B}_{3}$\n- $d_{23}=5.0 \\in \\mathcal{B}_{4}$\n$\\mathcal{E}_{A}$ 的直方图，记为 $H_A$，是各区间 $(\\mathcal{B}_{1}, \\mathcal{B}_{2}, \\mathcal{B}_{3}, \\mathcal{B}_{4})$ 中的计数向量，即 $(1, 1, 3, 1)$。\n\n对于环境 $\\mathcal{E}_{B} = \\{ \\mathbf{b}_{0}, \\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3} \\}$，其坐标为 $\\mathbf{b}_{0} = (0, 0, 0)$, $\\mathbf{b}_{1} = (2, 0, 0)$, $\\mathbf{b}_{2} = (0, 0, 3)$，而 $\\mathbf{b}_{3}$ 由距离约束定义：\n固定距离为：\n$d_{01} = \\|\\mathbf{b}_{1} - \\mathbf{b}_{0}\\| = \\|(2, 0, 0)\\| = 2$.\n$d_{02} = \\|\\mathbf{b}_{2} - \\mathbf{b}_{0}\\| = \\|(0, 0, 3)\\| = 3$.\n$d_{12} = \\|\\mathbf{b}_{2} - \\mathbf{b}_{1}\\| = \\|(-2, 0, 3)\\| = \\sqrt{(-2)^2 + 0^2 + 3^2} = \\sqrt{4+9} = \\sqrt{13}$.\n涉及 $\\mathbf{b}_3$ 的其余距离在问题陈述中已明确给出：\n$d_{03} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\| = 4.9$.\n$d_{13} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{1}\\| = 4.0$.\n$d_{23} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{2}\\| = 3.7$.\n\n$\\mathcal{E}_{B}$ 的距离集合为 $\\{2, 3, \\sqrt{13}, 4.9, 4.0, 3.7\\}$。其数值近似为 $\\{2.0, 3.0, 3.606, 4.9, 4.0, 3.7\\}$。\n使用相同的区间：\n- $d_{01}=2.0 \\in \\mathcal{B}_{1}$\n- $d_{02}=3.0 \\in \\mathcal{B}_{2}$\n- $d_{12} \\approx 3.606 \\in \\mathcal{B}_{3}$\n- $d_{23}=3.7 \\in \\mathcal{B}_{3}$\n- $d_{13}=4.0 \\in \\mathcal{B}_{3}$\n- $d_{03}=4.9 \\in \\mathcal{B}_{4}$\n$\\mathcal{E}_{B}$ 的直方图，记为 $H_B$，是计数向量 $(1, 1, 3, 1)$。\n\n因此，我们证明了 $H_A = H_B = (1, 1, 3, 1)$。这两个环境共享完全相同的成对距离直方图。\n\n**任务2：四面体体积**\n\n顶点为 $\\mathbf{p}_{0}, \\mathbf{p}_{1}, \\mathbf{p}_{2}, \\mathbf{p}_{3}$ 的四面体体积由以下公式给出：\n$$V = \\frac{1}{6}\\left|(\\mathbf{p}_{1} - \\mathbf{p}_{0}) \\cdot \\left((\\mathbf{p}_{2} - \\mathbf{p}_{0}) \\times (\\mathbf{p}_{3} - \\mathbf{p}_{0})\\right)\\right|$$\n这等同于从一个公共顶点出发的三个边向量所构成的矩阵行列式绝对值的 $\\frac{1}{6}$。\n\n对于环境 $\\mathcal{E}_{A}$，我们选择 $\\mathbf{p}_{0} = \\mathbf{a}_{0} = (0, 0, 0)$。边向量为：\n$\\mathbf{v}_{1} = \\mathbf{a}_{1} - \\mathbf{a}_{0} = (2, 0, 0)$\n$\\mathbf{v}_{2} = \\mathbf{a}_{2} - \\mathbf{a}_{0} = (0, 3, 0)$\n$\\mathbf{v}_{3} = \\mathbf{a}_{3} - \\mathbf{a}_{0} = (0, 0, 4)$\n体积 $V_{A}$ 为：\n$$V_{A} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  4 \\end{pmatrix} \\right| = \\frac{1}{6} |2(3 \\cdot 4 - 0 \\cdot 0)| = \\frac{1}{6} |24| = 4$$\n因此，$V_{A} = 4$ 立方埃。\n\n对于环境 $\\mathcal{E}_{B}$，我们首先确定 $\\mathbf{b}_{3}$ 的坐标 $(x,y,z)$。问题提供了以下公式：\n$x = \\frac{24.01 + 4 - 16}{4} = \\frac{12.01}{4} = 3.0025$.\n$z = \\frac{24.01 + 9 - 13.69}{6} = \\frac{19.32}{6} = 3.22$.\n为了求 $y$，我们使用约束条件 $\\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\|^2 = 4.9^2$：\n$x^2 + y^2 + z^2 = 24.01$\n$y^2 = 24.01 - x^2 - z^2 = 24.01 - (3.0025)^2 - (3.22)^2$\n$y^2 = 24.01 - 9.01500625 - 10.3684 = 4.62659375$.\n$y$ 存在实数解：$y = \\pm \\sqrt{4.62659375}$。体积的计算取决于 $|y|$，因此符号无关紧要。我们选择 $\\mathbf{p}_{0} = \\mathbf{b}_{0} = (0, 0, 0)$。边向量为：\n$\\mathbf{u}_{1} = \\mathbf{b}_{1} - \\mathbf{b}_{0} = (2, 0, 0)$\n$\\mathbf{u}_{2} = \\mathbf{b}_{2} - \\mathbf{b}_{0} = (0, 0, 3)$\n$\\mathbf{u}_{3} = \\mathbf{b}_{3} - \\mathbf{b}_{0} = (x, y, z) = (3.0025, y, 3.22)$\n体积 $V_{B}$ 为：\n$$V_{B} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2  0  0 \\\\ 0  0  3 \\\\ x  y  z \\end{pmatrix} \\right| = \\frac{1}{6} |2(0 \\cdot z - 3 \\cdot y)| = \\frac{1}{6} |-6y| = |y|$$\n代入 $|y|$ 的值：\n$V_{B} = \\sqrt{4.62659375} \\approx 2.1509518$ 立方埃。\n\n**任务3：非唯一性解释**\n\n成对距离直方图不是原子环境的唯一描述符。这根本上是因为它代表了对完整几何信息的一种有损压缩。我们的计算提供了一个具体的例子。\n1.  这两个环境 $\\mathcal{E}_{A}$ 和 $\\mathcal{E}_{B}$ 在结构上是不同的。一个明确的证明是它们的四面体体积不同：$V_{A} = 4$ 和 $V_{B} \\approx 2.15$。由于体积是一个几何不变量，不同的体积意味着不同的几何结构。\n2.  尽管它们的结构不同，我们已经证明它们的成对距离直方图是相同的：$H_A = H_B = (1, 1, 3, 1)$。\n3.  结论是不可避免的：既然两个不同的结构映射到同一个描述符，那么这个描述符就不是唯一的。\n\n这种非唯一性源于两个主要的信息损失来源：\n-   **分箱（Binning）：** 直方图用宽泛范围内的计数取代了精确的距离值。例如，在区间 $\\mathcal{B}_{3}$ 中，$\\mathcal{E}_{A}$ 的距离为 $\\{4, \\sqrt{13}, \\sqrt{20}\\}$，而 $\\mathcal{E}_{B}$ 的距离为 $\\{\\sqrt{13}, 3.7, 4.0\\}$。分箱操作掩盖了其底层距离集合不同的事实。\n-   **投影到二体信息：** 直方图是一种二体（2-body）描述符，因为它只考虑原子对。它丢弃了所有更高阶的相关性，例如化学键之间的角度或结构内的二面角。四面体的体积是一个四体（4-body）属性，取决于所有四个原子的精确三维排列。直方图对这类信息是“盲目”的，而这些信息对于唯一定义几何结构至关重要。\n\n**任务4：计算 $\\Delta V$**\n\n我们被要求计算 $\\Delta V = V_{A} - V_{B}$ 并四舍五入到四位有效数字。\n$V_{A} = 4$.\n$V_{B} = \\sqrt{4.62659375}$.\n$\\Delta V = 4 - \\sqrt{4.62659375}$.\n$\\Delta V \\approx 4 - 2.150951825...$\n$\\Delta V \\approx 1.849048174...$\n\n四舍五入到四位有效数字得到 $1.849$。",
            "answer": "$$\\boxed{1.849}$$"
        }
    ]
}