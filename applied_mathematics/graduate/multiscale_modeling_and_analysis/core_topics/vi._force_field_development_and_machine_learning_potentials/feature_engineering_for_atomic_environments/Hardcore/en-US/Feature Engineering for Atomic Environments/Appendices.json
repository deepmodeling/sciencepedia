{
    "hands_on_practices": [
        {
            "introduction": "Constructing effective features from raw atomic coordinates is the first step in building machine-learned models of materials. This first practice introduces a fundamental building block: a radial descriptor that quantifies the local atomic environment. You will apply core techniques from molecular simulation, including periodic boundary conditions and smooth cutoff functions, to translate a hypothetical atomic configuration into a numerical feature, providing a concrete foundation for more complex descriptors. ",
            "id": "3757519",
            "problem": "Consider a simple cubic Bravais lattice with Periodic Boundary Conditions (PBC) in three dimensions. The primitive lattice vectors are $\\mathbf{a}_1=(3.0\\,\\mathrm{\\AA},0,0)$, $\\mathbf{a}_2=(0,3.0\\,\\mathrm{\\AA},0)$, and $\\mathbf{a}_3=(0,0,3.0\\,\\mathrm{\\AA})$. Within a single unit cell, there are five atoms with Cartesian coordinates (in $\\mathrm{\\AA}$): atom $i$ at $(0,0,0)$, and four other atoms at $(1.0,0,0)$, $(0,1.2,0)$, $(0,0,1.8)$, and $(2.5,0,0)$. Distances are computed using the Euclidean norm with the minimum image convention under PBC.\n\nYou are tasked with constructing a scalar radial fingerprint for atom $i$ that captures its local atomic environment within a spherical neighborhood of radius $r_c = 2.0\\,\\mathrm{\\AA}$. The fingerprint must incorporate both a smooth cutoff and a localized radial weighting.\n\nStarting from fundamental principles appropriate to multiscale modeling and analysis:\n\n1. Using PBC and the minimum image convention, determine the neighbor list of atom $i$ by identifying which atoms (including their periodic images, if needed) lie within distance $r_c$ of atom $i$. Report each distinct interatomic distance $r_{ij}$ that contributes to the fingerprint.\n2. Derive a smooth cosine cutoff function $f_c(r)$ defined on $[0,r_c]$ that is non-negative, satisfies $f_c(0)=1$, $f_c(r_c)=0$, and has vanishing first derivative at both endpoints, $f_c'(0)=0$ and $f_c'(r_c)=0$. Angles must be treated in radians.\n3. Using a Gaussian radial basis centered at $R_s=1.0\\,\\mathrm{\\AA}$ with width parameter $\\eta=4.0\\,\\mathrm{\\AA}^{-2}$, construct the scalar radial fingerprint $G_i(R_s;\\eta)$ for atom $i$ as a sum over neighbors inside the cutoff radius, where each neighbor contributes the product of the Gaussian radial weight and the cutoff value evaluated at its minimum-image distance from atom $i$.\n\nExpress the final fingerprint value $G_i(R_s;\\eta)$ as a single closed-form analytic expression in terms of $\\exp(\\cdot)$, $\\pi$, and radicals; do not provide a decimal approximation. The final answer must be unitless and presented as one expression. Angles in trigonometric functions must be in radians.",
            "solution": "The problem will first be validated against the specified criteria of scientific soundness, well-posedness, and objectivity.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Lattice and Periodicity**: Simple cubic Bravais lattice with Periodic Boundary Conditions (PBC) in three dimensions.\n- **Lattice Vectors**: $\\mathbf{a}_1=(3.0\\,\\mathrm{\\AA},0,0)$, $\\mathbf{a}_2=(0,3.0\\,\\mathrm{\\AA},0)$, $\\mathbf{a}_3=(0,0,3.0\\,\\mathrm{\\AA})$. This defines a cubic cell of side length $L=3.0\\,\\mathrm{\\AA}$.\n- **Atomic Coordinates**: A central atom $i$ at $\\mathbf{r}_i=(0,0,0)\\,\\mathrm{\\AA}$. Four other atoms within the unit cell at positions $\\mathbf{r}_j$: $(1.0,0,0)\\,\\mathrm{\\AA}$, $(0,1.2,0)\\,\\mathrm{\\AA}$, $(0,0,1.8)\\,\\mathrm{\\AA}$, and $(2.5,0,0)\\,\\mathrm{\\AA}$.\n- **Distance Calculation**: Euclidean norm with the minimum image convention (MIC).\n- **Cutoff Radius**: $r_c = 2.0\\,\\mathrm{\\AA}$.\n- **Task 1**: Determine the neighbor list and report the distinct interatomic distances $r_{ij}$ for neighbors within $r_c$.\n- **Task 2**: Derive a smooth cosine cutoff function $f_c(r)$ on $[0,r_c]$ such that $f_c(r) \\ge 0$, $f_c(0)=1$, $f_c(r_c)=0$, $f_c'(0)=0$, and $f_c'(r_c)=0$.\n- **Task 3**: Calculate the scalar radial fingerprint $G_i(R_s;\\eta)$ defined as $G_i = \\sum_{j} \\exp(-\\eta(r_{ij}-R_s)^2) f_c(r_{ij})$ over neighbors within the cutoff.\n- **Fingerprint Parameters**: Gaussian center $R_s=1.0\\,\\mathrm{\\AA}$; width parameter $\\eta=4.0\\,\\mathrm{\\AA}^{-2}$.\n- **Final Answer Format**: A single closed-form analytic expression, unitless.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is firmly grounded in computational materials science and condensed matter physics. Atomic environment descriptors, or fingerprints, like the one described (which is a form of a Behler-Parrinello symmetry function), are a cornerstone of developing machine-learned interatomic potentials. The concepts of PBC, MIC, and smooth cutoff functions are standard and fundamentally sound.\n- **Well-Posedness**: The problem provides all necessary data (atomic positions, lattice parameter, cutoff radius, function parameters) and clear definitions to uniquely determine the result. The structure is logical and leads to a single, computable answer.\n- **Objectivity**: The problem is stated using precise, quantitative, and unbiased language. There are no subjective or ambiguous terms.\n- **Consistency and Feasibility**: The provided values are consistent and physically plausible for a model atomic system. The application of the MIC to the given coordinates and lattice vectors is a standard, unambiguous procedure. No contradictions or infeasible conditions are present.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-posed, scientifically sound exercise in applying fundamental concepts of multiscale modeling. The solution process will now proceed.\n\n### Solution Derivation\n\nThe solution is developed in three parts as outlined in the problem statement.\n\n**Part 1: Neighbor List and Interatomic Distances**\nThe central atom $i$ is at the origin $\\mathbf{r}_i = (0,0,0)$. The simulation cell is a cube defined by the orthogonal lattice vectors, with side length $L = 3.0\\,\\mathrm{\\AA}$. The distance to any other atom $j$ at position $\\mathbf{r}_j$ must be calculated using the minimum image convention. The displacement vector is $\\mathbf{d}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i = \\mathbf{r}_j$. The minimum image displacement vector $\\mathbf{d}_{ij}^{\\text{mic}}$ has components $d_k^{\\text{mic}} = d_k - L \\cdot \\text{nint}(d_k / L)$, where $k \\in \\{x,y,z\\}$ and $\\text{nint}(\\cdot)$ is the nearest integer function. The distance is then $r_{ij} = ||\\mathbf{d}_{ij}^{\\text{mic}}||$.\n\n- **Atom at $(1.0, 0, 0)\\,\\mathrm{\\AA}$**:\n  - The displacement is $\\mathbf{d} = (1.0, 0, 0)$.\n  - $d_x^{\\text{mic}} = 1.0 - 3.0 \\cdot \\text{nint}(1.0/3.0) = 1.0 - 3.0 \\cdot 0 = 1.0$.\n  - The minimum image distance is $r_{ij} = \\sqrt{1.0^2} = 1.0\\,\\mathrm{\\AA}$. Since $1.0  r_c = 2.0$, this is a neighbor.\n\n- **Atom at $(0, 1.2, 0)\\,\\mathrm{\\AA}$**:\n  - The displacement is $\\mathbf{d} = (0, 1.2, 0)$.\n  - $d_y^{\\text{mic}} = 1.2 - 3.0 \\cdot \\text{nint}(1.2/3.0) = 1.2 - 3.0 \\cdot 0 = 1.2$.\n  - The minimum image distance is $r_{ij} = \\sqrt{1.2^2} = 1.2\\,\\mathrm{\\AA}$. Since $1.2  r_c$, this is a neighbor.\n\n- **Atom at $(0, 0, 1.8)\\,\\mathrm{\\AA}$**:\n  - The displacement is $\\mathbf{d} = (0, 0, 1.8)$.\n  - $d_z^{\\text{mic}} = 1.8 - 3.0 \\cdot \\text{nint}(1.8/3.0) = 1.8 - 3.0 \\cdot 1 = -1.2$.\n  - The minimum image distance is $r_{ij} = \\sqrt{(-1.2)^2} = 1.2\\,\\mathrm{\\AA}$. Since $1.2  r_c$, this is a neighbor.\n\n- **Atom at $(2.5, 0, 0)\\,\\mathrm{\\AA}$**:\n  - The displacement is $\\mathbf{d} = (2.5, 0, 0)$.\n  - $d_x^{\\text{mic}} = 2.5 - 3.0 \\cdot \\text{nint}(2.5/3.0) = 2.5 - 3.0 \\cdot 1 = -0.5$.\n  - The minimum image distance is $r_{ij} = \\sqrt{(-0.5)^2} = 0.5\\,\\mathrm{\\AA}$. Since $0.5  r_c$, this is a neighbor.\n\nAll four atoms (or their closest periodic images) are within the cutoff radius $r_c = 2.0\\,\\mathrm{\\AA}$. The list of interatomic distances contributing to the fingerprint is $\\{0.5, 1.0, 1.2, 1.2\\}\\,\\mathrm{\\AA}$. The distinct distances are $0.5\\,\\mathrm{\\AA}$, $1.0\\,\\mathrm{\\AA}$, and $1.2\\,\\mathrm{\\AA}$.\n\n**Part 2: Derivation of the Cutoff Function**\nWe need a smooth function $f_c(r)$ on $[0, r_c]$ satisfying the boundary conditions $f_c(0)=1$, $f_c(r_c)=0$, $f_c'(0)=0$, and $f_c'(r_c)=0$. A standard function satisfying these requirements is based on a cosine transformation. For $r \\in [0, r_c]$, we define:\n$$ f_c(r) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi r}{r_c}\\right) + 1 \\right) $$\nFor $r > r_c$, $f_c(r) = 0$. Let's verify the conditions with $r_c = 2.0\\,\\mathrm{\\AA}$:\n- $f_c(0) = \\frac{1}{2} (\\cos(0) + 1) = \\frac{1}{2}(1+1) = 1$.\n- $f_c(r_c) = f_c(2.0) = \\frac{1}{2} (\\cos(\\pi) + 1) = \\frac{1}{2}(-1+1) = 0$.\n- The first derivative is $f_c'(r) = \\frac{d}{dr} \\left[ \\frac{1}{2} \\cos\\left(\\frac{\\pi r}{r_c}\\right) + \\frac{1}{2} \\right] = -\\frac{\\pi}{2r_c} \\sin\\left(\\frac{\\pi r}{r_c}\\right)$.\n- $f_c'(0) = -\\frac{\\pi}{2r_c} \\sin(0) = 0$.\n- $f_c'(r_c) = -\\frac{\\pi}{2r_c} \\sin(\\pi) = 0$.\nThe function is also non-negative on its domain. This function is therefore the correct cutoff function to use. For this problem, $f_c(r) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi r}{2}\\right) + 1 \\right)$ for $r \\in [0, 2.0]$.\n\n**Part 3: Calculation of the Radial Fingerprint**\nThe radial fingerprint $G_i$ is the sum of contributions from all neighbors $j$ within the cutoff radius:\n$$ G_i = \\sum_{j, r_{ij}  r_c} \\exp(-\\eta(r_{ij}-R_s)^2) f_c(r_{ij}) $$\nWe use the parameters $R_s = 1.0\\,\\mathrm{\\AA}$, $\\eta = 4.0\\,\\mathrm{\\AA}^{-2}$, and the four neighbor distances $\\{0.5, 1.0, 1.2, 1.2\\}\\,\\mathrm{\\AA}$.\n\n- **Contribution from neighbor at $r=0.5\\,\\mathrm{\\AA}$**:\n  - Gaussian weight: $\\exp(-4.0(0.5-1.0)^2) = \\exp(-4.0(-0.5)^2) = \\exp(-1)$.\n  - Cutoff value: $f_c(0.5) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 0.5}{2}) + 1) = \\frac{1}{2}(\\cos(\\frac{\\pi}{4}) + 1) = \\frac{1}{2}(\\frac{\\sqrt{2}}{2} + 1) = \\frac{2+\\sqrt{2}}{4}$.\n  - Contribution: $\\exp(-1) \\frac{2+\\sqrt{2}}{4}$.\n\n- **Contribution from neighbor at $r=1.0\\,\\mathrm{\\AA}$**:\n  - Gaussian weight: $\\exp(-4.0(1.0-1.0)^2) = \\exp(0) = 1$.\n  - Cutoff value: $f_c(1.0) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 1.0}{2}) + 1) = \\frac{1}{2}(\\cos(\\frac{\\pi}{2}) + 1) = \\frac{1}{2}(0+1) = \\frac{1}{2}$.\n  - Contribution: $1 \\cdot \\frac{1}{2} = \\frac{1}{2}$.\n\n- **Contribution from two neighbors at $r=1.2\\,\\mathrm{\\AA}$**:\n  - Gaussian weight for one neighbor: $\\exp(-4.0(1.2-1.0)^2) = \\exp(-4.0(0.2)^2) = \\exp(-4.0 \\cdot 0.04) = \\exp(-0.16) = \\exp(-\\frac{4}{25})$.\n  - Cutoff value: $f_c(1.2) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 1.2}{2}) + 1) = \\frac{1}{2}(\\cos(0.6\\pi) + 1) = \\frac{1}{2}(\\cos(\\frac{3\\pi}{5}) + 1)$.\n  - The exact value of $\\cos(\\frac{3\\pi}{5})$ is $\\frac{1-\\sqrt{5}}{4}$.\n  - Cutoff value: $f_c(1.2) = \\frac{1}{2}(\\frac{1-\\sqrt{5}}{4} + 1) = \\frac{1}{2}(\\frac{1-\\sqrt{5}+4}{4}) = \\frac{5-\\sqrt{5}}{8}$.\n  - Total contribution from these two identical neighbors: $2 \\cdot \\exp(-\\frac{4}{25}) \\cdot \\frac{5-\\sqrt{5}}{8} = \\exp(-\\frac{4}{25}) \\frac{5-\\sqrt{5}}{4}$.\n\nThe total fingerprint value $G_i$ is the sum of these contributions:\n$$ G_i = \\exp(-1) \\frac{2+\\sqrt{2}}{4} + \\frac{1}{2} + \\exp(-\\frac{4}{25}) \\frac{5-\\sqrt{5}}{4} $$\nTo express this as a single expression, we find a common denominator:\n$$ G_i = \\frac{\\exp(-1)(2+\\sqrt{2}) + 2 + \\exp(-\\frac{4}{25})(5-\\sqrt{5})}{4} $$\n$$ G_i = \\frac{1}{4} \\left( \\exp(-1)(2+\\sqrt{2}) + 2 + \\exp\\left(-\\frac{4}{25}\\right)(5-\\sqrt{5}) \\right) $$\nThis is the final, closed-form analytic expression for the fingerprint.",
            "answer": "$$ \\boxed{\\frac{1}{4} \\left( \\exp(-1)(2+\\sqrt{2}) + 2 + \\exp\\left(-\\frac{4}{25}\\right)(5-\\sqrt{5}) \\right)} $$"
        },
        {
            "introduction": "The choice of functions used to build descriptors has profound physical consequences. In our first exercise, we employed a smooth cutoff function; here, we will investigate why this choice is critical by analyzing the alternativeâ€”a sharp, discontinuous cutoff. This practice connects the mathematical differentiability of a descriptor to the physical forces it implies, demonstrating how an un-smooth feature can lead to unphysical, impulsive force artifacts that would corrupt a molecular dynamics simulation. ",
            "id": "3757502",
            "problem": "In atomistic feature engineering for interatomic potentials, a common radial descriptor for the environment of a central atom depends on neighbor separations and employs a cutoff to localize contributions. Consider a single pairwise separation $r$ contributing to a scalar descriptor via $s(r) = g(r)\\,c(r)$, where $g(r)$ is a smooth function of class $C^{1}$ on $(0,\\infty)$ and $c(r)$ is a discontinuous indicator cutoff given by the Heaviside step function $c(r) = H(r_{c}-r)$ with a finite cutoff radius $r_{c} > 0$. Suppose a simple learning objective penalizes the descriptor magnitude through the pairwise energy\n$$\nE(r) = \\frac{\\kappa}{2}\\,s(r)^{2},\n$$\nwith stiffness $\\kappa > 0$, so that by the work-energy principle and the definition of mechanical force, the radial force obeys $F_{r}(r) = -\\frac{dE}{dr}$. Using only fundamental relations, namely $F_{r}(r) = -\\frac{dE}{dr}$ and the distributional identity $\\frac{d}{dx}H(x) = \\delta(x)$ for the Dirac delta distribution $\\delta(x)$, derive the distribution-valued expression for $F_{r}(r)$ and then compute the jump discontinuity in the classical part of the radial force at the cutoff $r = r_{c}$, defined as\n$$\n\\Delta F_{r} \\equiv \\lim_{\\epsilon \\to 0^{+}} \\Big(F_{r}(r_{c}-\\epsilon) - F_{r}(r_{c}+\\epsilon)\\Big),\n$$\nwhere the limits are understood in the classical sense, i.e., ignoring the singular $\\delta$-distribution term at $r = r_{c}$. Express your final answer for $\\Delta F_{r}$ in closed form in terms of $\\kappa$, $g(r_{c})$, and $g'(r_{c})$. No numerical evaluation is required, and no units should be included in the final answer. The final answer must be a single analytic expression.",
            "solution": "The problem requires the derivation of the radial force $F_{r}(r)$ from a given pairwise energy $E(r)$ and the subsequent calculation of the jump discontinuity in its classical part at the cutoff radius $r_{c}$.\n\nThe pairwise energy is given by\n$$\nE(r) = \\frac{\\kappa}{2}\\,s(r)^{2}\n$$\nwhere $\\kappa > 0$ is a stiffness constant and $s(r)$ is a scalar descriptor. The descriptor is defined as the product of a smooth function $g(r)$ of class $C^{1}$ and a discontinuous indicator cutoff function $c(r) = H(r_{c}-r)$, where $H$ is the Heaviside step function and $r_c > 0$ is the cutoff radius.\nSubstituting the expression for $s(r)$ into the energy equation, we get:\n$$\nE(r) = \\frac{\\kappa}{2}\\,\\Big(g(r)\\,H(r_{c}-r)\\Big)^{2} = \\frac{\\kappa}{2}\\,g(r)^{2}\\,H(r_{c}-r)^{2}\n$$\nThe Heaviside step function is idempotent with respect to multiplication, meaning $H(x)^{n} = H(x)$ for any integer $n \\ge 1$, because its value is either $0$ or $1$. Therefore, $H(r_{c}-r)^{2} = H(r_{c}-r)$. The energy expression simplifies to:\n$$\nE(r) = \\frac{\\kappa}{2}\\,g(r)^{2}\\,H(r_{c}-r)\n$$\nThe radial force $F_{r}(r)$ is defined as the negative gradient of the potential energy:\n$$\nF_{r}(r) = -\\frac{dE}{dr} = -\\frac{d}{dr}\\left(\\frac{\\kappa}{2}\\,g(r)^{2}\\,H(r_{c}-r)\\right)\n$$\nTo perform the differentiation, we must use the product rule for distributional derivatives, as we are differentiating a product of a smooth function, $g(r)^2$, and a distribution, $H(r_c-r)$. The product rule states that $(uv)' = u'v + uv'$, where derivatives are taken in the distributional sense. Let $u(r) = g(r)^{2}$ and $v(r) = H(r_{c}-r)$.\n\nFirst, we find the derivatives of $u(r)$ and $v(r)$. Since $g(r)$ is of class $C^{1}$, its derivative $g'(r)$ is continuous. The derivative of $u(r) = g(r)^{2}$ is found using the chain rule:\n$$\n\\frac{du}{dr} = \\frac{d}{dr}\\left(g(r)^{2}\\right) = 2\\,g(r)\\,g'(r)\n$$\nNext, we find the derivative of $v(r) = H(r_{c}-r)$. Using the given identity $\\frac{d}{dx}H(x) = \\delta(x)$ and the chain rule, with an argument of $x = r_{c}-r$, we have $\\frac{dx}{dr} = -1$.\n$$\n\\frac{dv}{dr} = \\frac{d}{dr}H(r_{c}-r) = \\frac{dH(r_{c}-r)}{d(r_{c}-r)} \\frac{d(r_{c}-r)}{dr} = \\delta(r_{c}-r) \\cdot (-1) = -\\delta(r_c-r)\n$$\nSince the Dirac delta distribution is an even function, $\\delta(x) = \\delta(-x)$, we have $\\delta(r_{c}-r) = \\delta(r-r_{c})$. So,\n$$\n\\frac{dv}{dr} = -\\delta(r-r_{c})\n$$\nApplying the product rule to find $\\frac{dE}{dr}$:\n$$\n\\frac{dE}{dr} = \\frac{\\kappa}{2} \\left[ \\left(\\frac{d}{dr}g(r)^{2}\\right) H(r_{c}-r) + g(r)^{2} \\left(\\frac{d}{dr}H(r_{c}-r)\\right) \\right]\n$$\n$$\n\\frac{dE}{dr} = \\frac{\\kappa}{2} \\left[ 2\\,g(r)\\,g'(r)\\,H(r_{c}-r) - g(r)^{2}\\,\\delta(r-r_{c}) \\right]\n$$\nThe force is $F_{r}(r) = - \\frac{dE}{dr}$:\n$$\nF_{r}(r) = -\\kappa\\,g(r)\\,g'(r)\\,H(r_{c}-r) + \\frac{\\kappa}{2}\\,g(r)^{2}\\,\\delta(r-r_{c})\n$$\nUsing the sifting property of the delta distribution, which states that $f(x)\\delta(x-a) = f(a)\\delta(x-a)$ for a function $f(x)$ continuous at $x=a$, we replace $g(r)^{2}$ with $g(r_{c})^{2}$ in the term containing the delta distribution:\n$$\nF_{r}(r) = -\\kappa\\,g(r)\\,g'(r)\\,H(r_{c}-r) + \\frac{\\kappa}{2}\\,g(r_{c})^{2}\\,\\delta(r-r_{c})\n$$\nThis is the complete distribution-valued expression for the force.\n\nThe problem asks for the jump discontinuity in the classical part of the force at $r=r_c$. The classical part, which we denote $F_{r, \\text{cl}}(r)$, is the part of the expression that does not contain the singular $\\delta$-distribution:\n$$\nF_{r, \\text{cl}}(r) = -\\kappa\\,g(r)\\,g'(r)\\,H(r_{c}-r)\n$$\nThe jump discontinuity is defined as $\\Delta F_{r} \\equiv \\lim_{\\epsilon \\to 0^{+}} \\Big(F_{r, \\text{cl}}(r_{c}-\\epsilon) - F_{r, \\text{cl}}(r_{c}+\\epsilon)\\Big)$.\n\nWe evaluate the two limits separately.\nFirst, for the limit from below ($r \\to r_{c}^{-}$):\nLet $r = r_{c}-\\epsilon$ where $\\epsilon > 0$. As $\\epsilon \\to 0^{+}$, $r \\to r_{c}^{-}$.\nThe argument of the Heaviside function is $r_{c}-r = r_{c}-(r_{c}-\\epsilon) = \\epsilon > 0$. Thus, $H(r_{c}-r) = 1$.\n$$\n\\lim_{\\epsilon \\to 0^{+}} F_{r, \\text{cl}}(r_{c}-\\epsilon) = \\lim_{\\epsilon \\to 0^{+}} \\Big(-\\kappa\\,g(r_{c}-\\epsilon)\\,g'(r_{c}-\\epsilon) \\cdot 1\\Big)\n$$\nSince $g(r)$ is of class $C^{1}$, both $g(r)$ and $g'(r)$ are continuous. Therefore, the limit is:\n$$\n-\\kappa\\,g(r_{c})\\,g'(r_{c})\n$$\nSecond, for the limit from above ($r \\to r_{c}^{+}$):\nLet $r = r_{c}+\\epsilon$ where $\\epsilon > 0$. As $\\epsilon \\to 0^{+}$, $r \\to r_{c}^{+}$.\nThe argument of the Heaviside function is $r_{c}-r = r_{c}-(r_{c}+\\epsilon) = -\\epsilon  0$. Thus, $H(r_{c}-r) = 0$.\n$$\n\\lim_{\\epsilon \\to 0^{+}} F_{r, \\text{cl}}(r_{c}+\\epsilon) = \\lim_{\\epsilon \\to 0^{+}} \\Big(-\\kappa\\,g(r_{c}+\\epsilon)\\,g'(r_{c}+\\epsilon) \\cdot 0\\Big) = 0\n$$\nFinally, we compute the jump $\\Delta F_{r}$ by subtracting the second limit from the first:\n$$\n\\Delta F_{r} = \\Big(-\\kappa\\,g(r_{c})\\,g'(r_{c})\\Big) - (0) = -\\kappa\\,g(r_{c})\\,g'(r_{c})\n$$\nThis is the closed-form expression for the jump discontinuity in the classical part of the radial force at the cutoff.",
            "answer": "$$\n\\boxed{-\\kappa\\,g(r_{c})\\,g'(r_{c})}\n$$"
        },
        {
            "introduction": "A powerful descriptor must not only satisfy physical constraints like smoothness but also be discriminative enough to distinguish different atomic structures. This final practice explores this challenge by questioning the sufficiency of descriptors based solely on pairwise distances. You will analyze two distinct atomic configurations and discover, through direct calculation, that they can produce identical two-body feature histograms, exposing a fundamental limitation of radial descriptors and motivating the need for features that capture angular, three-body information. ",
            "id": "3757533",
            "problem": "In multiscale modeling and analysis, a common descriptor for an atomic environment is the radial distribution function (RDF), often approximated by a pairwise distance histogram that counts how many interatomic separations fall into prescribed bins. Consider the following context for a descriptor based on a pairwise distance histogram. Let the bin edges be specified by the half-open intervals\n$$\\mathcal{B}_{1} = [1.5, 2.5),\\quad \\mathcal{B}_{2} = [2.5, 3.5),\\quad \\mathcal{B}_{3} = [3.5, 4.5),\\quad \\mathcal{B}_{4} = [4.5, 5.5).$$\nYou are given two atomic environments, each consisting of four atoms in three-dimensional Euclidean space, described by their Cartesian coordinates in angstroms. The first environment is\n$$\\mathcal{E}_{A} = \\{ \\mathbf{a}_{0}, \\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3} \\},\\quad \\mathbf{a}_{0} = (0, 0, 0),\\ \\mathbf{a}_{1} = (2, 0, 0),\\ \\mathbf{a}_{2} = (0, 3, 0),\\ \\mathbf{a}_{3} = (0, 0, 4).$$\nThe second environment is\n$$\\mathcal{E}_{B} = \\{ \\mathbf{b}_{0}, \\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3} \\},\\quad \\mathbf{b}_{0} = (0, 0, 0),\\ \\mathbf{b}_{1} = (2, 0, 0),\\ \\mathbf{b}_{2} = (0, 0, 3),$$\nand $\\mathbf{b}_{3} = (x, y, z)$ is chosen such that the distances satisfy\n$\\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\| = 4.9$, $\\|\\mathbf{b}_{3} - \\mathbf{b}_{1}\\| = 4.0$, and $\\|\\mathbf{b}_{3} - \\mathbf{b}_{2}\\| = 3.7,$\nwith $\\|\\cdot\\|$ denoting the Euclidean norm. Assume that $\\mathbf{b}_{3}$ has Cartesian coordinates with $x = \\frac{24.01 + 4 - 16}{4}$ and $z = \\frac{24.01 + 9 - 13.69}{6}$, and that $y$ is chosen to satisfy the above three distance constraints exactly.\n\nTasks:\n1. Using only the definition of the Euclidean distance and the histogram bins $\\mathcal{B}_{1}, \\mathcal{B}_{2}, \\mathcal{B}_{3}, \\mathcal{B}_{4}$, compute the pairwise distances for $\\mathcal{E}_{A}$ and $\\mathcal{E}_{B}$ and tally the counts in each bin. Demonstrate that the two environments share an identical pairwise distance histogram.\n2. Starting from the geometric definition of the volume of a tetrahedron with vertices $\\mathbf{p}_{0}, \\mathbf{p}_{1}, \\mathbf{p}_{2}, \\mathbf{p}_{3}$,\n$$V = \\frac{1}{6}\\left|(\\mathbf{p}_{1} - \\mathbf{p}_{0}) \\cdot \\left((\\mathbf{p}_{2} - \\mathbf{p}_{0}) \\times (\\mathbf{p}_{3} - \\mathbf{p}_{0})\\right)\\right|,$$\nderive the volumes $V_{A}$ and $V_{B}$ of the tetrahedra determined by $\\mathcal{E}_{A}$ and $\\mathcal{E}_{B}$, respectively.\n3. Explain, using fundamental definitions and the results from parts 1 and 2, why the pairwise distance histogram is not a unique descriptor of the atomic environment. Your explanation should reference the loss of information introduced by binning and the unlabeled nature of the histogram.\n4. Compute the quantity\n$\\Delta V = V_{A} - V_{B},$\nand provide its numerical value. Round your answer to four significant figures. Express the final answer in cubic angstroms.\n\nYour final response must be a single real number that equals $\\Delta V$, rounded as specified. Do not include units in the final boxed answer.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and internally consistent. All necessary data and definitions for a unique solution are provided. The problem is a valid exercise in computational materials science, specifically concerning the properties of atomic environment descriptors. We may therefore proceed with the solution.\n\nThe problem requires a multi-step analysis comparing two four-atom environments, $\\mathcal{E}_{A}$ and $\\mathcal{E}_{B}$, to demonstrate the non-uniqueness of the pairwise distance histogram as a structural descriptor.\n\n**Task 1: Pairwise Distance Histograms**\n\nFirst, we compute the set of all pairwise distances for each environment. For a system of $4$ atoms, there are $\\binom{4}{2} = 6$ unique pairwise distances.\n\nFor environment $\\mathcal{E}_{A} = \\{ \\mathbf{a}_{0}, \\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3} \\}$, with coordinates $\\mathbf{a}_{0} = (0, 0, 0)$, $\\mathbf{a}_{1} = (2, 0, 0)$, $\\mathbf{a}_{2} = (0, 3, 0)$, and $\\mathbf{a}_{3} = (0, 0, 4)$ in angstroms:\nThe pairwise distances $d_{ij} = \\|\\mathbf{a}_j - \\mathbf{a}_i\\|$ are:\n$d_{01} = \\|\\mathbf{a}_{1} - \\mathbf{a}_{0}\\| = \\|(2, 0, 0)\\| = \\sqrt{2^2} = 2$.\n$d_{02} = \\|\\mathbf{a}_{2} - \\mathbf{a}_{0}\\| = \\|(0, 3, 0)\\| = \\sqrt{3^2} = 3$.\n$d_{03} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{0}\\| = \\|(0, 0, 4)\\| = \\sqrt{4^2} = 4$.\n$d_{12} = \\|\\mathbf{a}_{2} - \\mathbf{a}_{1}\\| = \\|(-2, 3, 0)\\| = \\sqrt{(-2)^2 + 3^2 + 0^2} = \\sqrt{4 + 9} = \\sqrt{13}$.\n$d_{13} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{1}\\| = \\|(-2, 0, 4)\\| = \\sqrt{(-2)^2 + 0^2 + 4^2} = \\sqrt{4 + 16} = \\sqrt{20}$.\n$d_{23} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{2}\\| = \\|(0, -3, 4)\\| = \\sqrt{0^2 + (-3)^2 + 4^2} = \\sqrt{9 + 16} = \\sqrt{25} = 5$.\n\nThe set of distances for $\\mathcal{E}_{A}$ is $\\{2, 3, 4, \\sqrt{13}, \\sqrt{20}, 5\\}$. Numerically, these are approximately $\\{2.0, 3.0, 4.0, 3.606, 4.472, 5.0\\}$.\nUsing the given bins $\\mathcal{B}_{1} = [1.5, 2.5)$, $\\mathcal{B}_{2} = [2.5, 3.5)$, $\\mathcal{B}_{3} = [3.5, 4.5)$, $\\mathcal{B}_{4} = [4.5, 5.5)$:\n- $d_{01}=2.0 \\in \\mathcal{B}_{1}$\n- $d_{02}=3.0 \\in \\mathcal{B}_{2}$\n- $d_{12} \\approx 3.606 \\in \\mathcal{B}_{3}$\n- $d_{03}=4.0 \\in \\mathcal{B}_{3}$\n- $d_{13} \\approx 4.472 \\in \\mathcal{B}_{3}$\n- $d_{23}=5.0 \\in \\mathcal{B}_{4}$\nThe histogram for $\\mathcal{E}_{A}$, denoted $H_A$, is the vector of counts in bins $(\\mathcal{B}_{1}, \\mathcal{B}_{2}, \\mathcal{B}_{3}, \\mathcal{B}_{4})$, which is $(1, 1, 3, 1)$.\n\nFor environment $\\mathcal{E}_{B} = \\{ \\mathbf{b}_{0}, \\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3} \\}$, with coordinates $\\mathbf{b}_{0} = (0, 0, 0)$, $\\mathbf{b}_{1} = (2, 0, 0)$, $\\mathbf{b}_{2} = (0, 0, 3)$, and $\\mathbf{b}_{3}$ defined by distance constraints:\nThe fixed distances are:\n$d_{01} = \\|\\mathbf{b}_{1} - \\mathbf{b}_{0}\\| = \\|(2, 0, 0)\\| = 2$.\n$d_{02} = \\|\\mathbf{b}_{2} - \\mathbf{b}_{0}\\| = \\|(0, 0, 3)\\| = 3$.\n$d_{12} = \\|\\mathbf{b}_{2} - \\mathbf{b}_{1}\\| = \\|(-2, 0, 3)\\| = \\sqrt{(-2)^2 + 0^2 + 3^2} = \\sqrt{4+9} = \\sqrt{13}$.\nThe remaining distances involving $\\mathbf{b}_3$ are given explicitly in the problem statement:\n$d_{03} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\| = 4.9$.\n$d_{13} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{1}\\| = 4.0$.\n$d_{23} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{2}\\| = 3.7$.\n\nThe set of distances for $\\mathcal{E}_{B}$ is $\\{2, 3, \\sqrt{13}, 4.9, 4.0, 3.7\\}$. Numerically, these are approximately $\\{2.0, 3.0, 3.606, 4.9, 4.0, 3.7\\}$.\nUsing the same bins:\n- $d_{01}=2.0 \\in \\mathcal{B}_{1}$\n- $d_{02}=3.0 \\in \\mathcal{B}_{2}$\n- $d_{12} \\approx 3.606 \\in \\mathcal{B}_{3}$\n- $d_{23}=3.7 \\in \\mathcal{B}_{3}$\n- $d_{13}=4.0 \\in \\mathcal{B}_{3}$\n- $d_{03}=4.9 \\in \\mathcal{B}_{4}$\nThe histogram for $\\mathcal{E}_{B}$, denoted $H_B$, is the vector of counts $(1, 1, 3, 1)$.\n\nThus, we have demonstrated that $H_A = H_B = (1, 1, 3, 1)$. The two environments share an identical pairwise distance histogram.\n\n**Task 2: Tetrahedral Volumes**\n\nThe volume of a tetrahedron with vertices $\\mathbf{p}_{0}, \\mathbf{p}_{1}, \\mathbf{p}_{2}, \\mathbf{p}_{3}$ is given by the formula:\n$$V = \\frac{1}{6}\\left|(\\mathbf{p}_{1} - \\mathbf{p}_{0}) \\cdot \\left((\\mathbf{p}_{2} - \\mathbf{p}_{0}) \\times (\\mathbf{p}_{3} - \\mathbf{p}_{0})\\right)\\right|$$\nThis is equivalent to $\\frac{1}{6}$ of the absolute value of the determinant of the matrix formed by the three edge vectors emanating from a common vertex.\n\nFor environment $\\mathcal{E}_{A}$, we choose $\\mathbf{p}_{0} = \\mathbf{a}_{0} = (0, 0, 0)$. The edge vectors are:\n$\\mathbf{v}_{1} = \\mathbf{a}_{1} - \\mathbf{a}_{0} = (2, 0, 0)$\n$\\mathbf{v}_{2} = \\mathbf{a}_{2} - \\mathbf{a}_{0} = (0, 3, 0)$\n$\\mathbf{v}_{3} = \\mathbf{a}_{3} - \\mathbf{a}_{0} = (0, 0, 4)$\nThe volume $V_{A}$ is:\n$$V_{A} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  4 \\end{pmatrix} \\right| = \\frac{1}{6} |2(3 \\cdot 4 - 0 \\cdot 0)| = \\frac{1}{6} |24| = 4$$\nSo, $V_{A} = 4$ cubic angstroms.\n\nFor environment $\\mathcal{E}_{B}$, we first determine the coordinates $(x,y,z)$ of $\\mathbf{b}_{3}$. The problem provides the formulas:\n$x = \\frac{24.01 + 4 - 16}{4} = \\frac{12.01}{4} = 3.0025$.\n$z = \\frac{24.01 + 9 - 13.69}{6} = \\frac{19.32}{6} = 3.22$.\nTo find $y$, we use the constraint $\\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\|^2 = 4.9^2$:\n$x^2 + y^2 + z^2 = 24.01$\n$y^2 = 24.01 - x^2 - z^2 = 24.01 - (3.0025)^2 - (3.22)^2$\n$y^2 = 24.01 - 9.01500625 - 10.3684 = 4.62659375$.\nA real solution for $y$ exists: $y = \\pm \\sqrt{4.62659375}$. The volume calculation depends on $|y|$, so the sign is immaterial. We choose $\\mathbf{p}_{0} = \\mathbf{b}_{0} = (0, 0, 0)$. The edge vectors are:\n$\\mathbf{u}_{1} = \\mathbf{b}_{1} - \\mathbf{b}_{0} = (2, 0, 0)$\n$\\mathbf{u}_{2} = \\mathbf{b}_{2} - \\mathbf{b}_{0} = (0, 0, 3)$\n$\\mathbf{u}_{3} = \\mathbf{b}_{3} - \\mathbf{b}_{0} = (x, y, z) = (3.0025, y, 3.22)$\nThe volume $V_{B}$ is:\n$$V_{B} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2  0  0 \\\\ 0  0  3 \\\\ x  y  z \\end{pmatrix} \\right| = \\frac{1}{6} |2(0 \\cdot z - 3 \\cdot y)| = \\frac{1}{6} |-6y| = |y|$$\nSubstituting the value of $|y|$:\n$V_{B} = \\sqrt{4.62659375} \\approx 2.1509518$ cubic angstroms.\n\n**Task 3: Explanation of Non-Uniqueness**\n\nThe pairwise distance histogram is not a unique descriptor of an atomic environment. This is fundamentally because it represents a lossy compression of the full geometric information. Our calculations provide a concrete example.\n1.  The two environments, $\\mathcal{E}_{A}$ and $\\mathcal{E}_{B}$, are structurally different. A definitive proof of this is that their tetrahedral volumes are different: $V_{A} = 4$ and $V_{B} \\approx 2.15$. Since volume is a geometric invariant, different volumes imply different geometries.\n2.  Despite their different structures, we have shown that their pairwise distance histograms are identical: $H_A = H_B = (1, 1, 3, 1)$.\n3.  The conclusion is inescapable: since two different structures map to the same descriptor, the descriptor is not unique.\n\nThis lack of uniqueness arises from two main sources of information loss:\n-   **Binning:** The histogram replaces precise distance values with counts within broad ranges. For example, in bin $\\mathcal{B}_{3}$, $\\mathcal{E}_{A}$ has distances $\\{4, \\sqrt{13}, \\sqrt{20}\\}$ whereas $\\mathcal{E}_{B}$ has distances $\\{\\sqrt{13}, 3.7, 4.0\\}$. The act of binning obscures the fact that the underlying sets of distances are different.\n-   **Projection to 2-Body Information:** The histogram is a 2-body descriptor, as it only considers pairs of atoms. It discards all higher-order correlations, such as the angles between bonds or the dihedral angles within the structure. The volume of a tetrahedron is a 4-body property that depends on the precise 3D arrangement of all four atoms. The histogram is blind to this type of information, which is essential for uniquely defining the geometry.\n\n**Task 4: Computation of $\\Delta V$**\n\nWe are asked to compute $\\Delta V = V_{A} - V_{B}$ and round to four significant figures.\n$V_{A} = 4$.\n$V_{B} = \\sqrt{4.62659375}$.\n$\\Delta V = 4 - \\sqrt{4.62659375}$.\n$\\Delta V \\approx 4 - 2.150951825...$\n$\\Delta V \\approx 1.849048174...$\n\nRounding to four significant figures gives $1.849$.",
            "answer": "$$\\boxed{1.849}$$"
        }
    ]
}