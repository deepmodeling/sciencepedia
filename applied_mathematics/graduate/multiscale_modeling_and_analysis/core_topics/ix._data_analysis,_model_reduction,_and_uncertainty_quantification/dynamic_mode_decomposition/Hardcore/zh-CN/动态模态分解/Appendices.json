{
    "hands_on_practices": [
        {
            "introduction": "动态模态分解（DMD）的核心产出是特征值和特征模态，它们揭示了系统的离散时间演化特性。然而，为了获得物理上有意义的洞见，例如一个模态是增长、衰减还是振荡，我们必须将这些离散时间特征值与潜在的连续时间动力学联系起来。这个练习将指导你完成这一基本转换，重点是从DMD特征值 $\\mu$ 计算出决定模态稳定性的连续时间增长率 。",
            "id": "860820",
            "problem": "动态模态分解 (Dynamic Mode Decomposition, DMD) 是一种用于分析复杂系统动力学的数据驱动方法。考虑一个时空系统，例如流体流动或反应扩散过程，其状态由场 $\\mathbf{u}(x, t)$ 描述。在离散且等间隔的时间点 $t_k = k \\Delta t$ 采集一系列系统状态的快照 $\\mathbf{v}_k = \\mathbf{u}(x, t_k)$。\n\nDMD 的核心假设是存在一个线性算子 $\\mathbf{A}$，它近似了状态从一个快照到下一个快照的演化，即 $\\mathbf{v}_{k+1} \\approx \\mathbf{A} \\mathbf{v}_k$。DMD 算法计算该算子 $\\mathbf{A}$ 的特征值 $\\mu$ 和相应的特征向量（DMD 模态）。\n\n这些离散时间特征值通过映射关系 $\\mu = e^{\\omega \\Delta t}$ 与一个潜在的连续时间线性算子 $\\mathbf{L}$（来自模型 $\\frac{d\\mathbf{v}}{dt} = \\mathbf{L}\\mathbf{v}$）的特征值 $\\omega$ 相关联。连续时间特征值的实部 $\\text{Re}(\\omega)$ 决定了相应模态的时间增长率或衰减率，而虚部 $\\text{Im}(\\omega)$ 决定了其振荡频率。\n\n一位研究人员将 DMD 应用于一个混沌系统的数据集，并识别出一个具有动态显著性的模态。与该模态相关的复特征值被确定为 $\\mu = a + i b$，其中 $a$ 和 $b$ 是给定的实常数。给定采样时间步长 $\\Delta t$，确定此连续时间模态的时间增长率。",
            "solution": "1. 离散到连续的映射关系为  \n$$\\mu = e^{\\omega \\,\\Delta t}\\,. $$\n\n2. 取复对数：  \n$$\\ln \\mu = \\omega\\,\\Delta t\\quad\\Longrightarrow\\quad \\omega = \\frac{1}{\\Delta t}\\,\\ln\\mu\\,. $$\n\n3. 将 $\\mu=a+ib$ 写成极坐标形式：  \n$$|\\mu|=\\sqrt{a^2+b^2},\\quad \\arg(\\mu)=\\tan^{-1}\\!\\frac{b}{a},$$  \n因此  \n$$\\ln\\mu = \\ln|\\mu| + i\\,\\arg(\\mu) = \\ln\\sqrt{a^2+b^2} + i\\,\\tan^{-1}\\!\\frac{b}{a}\\,. $$\n\n4. 时间增长率是 $\\omega$ 的实部：  \n$$\\Re(\\omega) = \\frac{1}{\\Delta t}\\,\\Re\\bigl(\\ln\\mu\\bigr)\n= \\frac{1}{\\Delta t}\\,\\ln\\sqrt{a^2+b^2}\n= \\frac{1}{2\\,\\Delta t}\\,\\ln\\bigl(a^2+b^2\\bigr)\\,. $$",
            "answer": "$$\\boxed{\\frac{1}{2\\,\\Delta t}\\,\\ln\\!\\bigl(a^2+b^2\\bigr)}$$"
        },
        {
            "introduction": "任何基于数据采样的方法都受到奈奎斯特-香农采样定理的约束，DMD也不例外。如果采样频率不足以捕捉系统的最快动态，就会发生一种称为“时间混叠”的现象，导致高频振荡被错误地识别为低频振荡。本练习通过一个简化的理想情景，让你亲手探究采样时间间隔 $\\Delta t$ 如何直接影响DMD的频率估计，并学会识别混叠现象 。",
            "id": "2387412",
            "problem": "给定一个由角频率为 $\\omega$（单位：$\\mathrm{rad/s}$）的单一空间固定振荡模式生成的无噪声复值快照序列族，该序列族以时间间隔 $\\Delta t$（单位：$\\mathrm{s}$）进行均匀时间采样。令时间 $t_k = k\\,\\Delta t$ 时的状态为 $x_k \\in \\mathbb{C}^n$，并假设 $x_k = \\alpha \\,\\phi \\, e^{\\mathrm{i}\\,\\omega\\, t_k}$，其中 $\\alpha \\in \\mathbb{C}$ 是一个非零复振幅，$\\phi \\in \\mathbb{C}^n$ 是一个非零空间模态向量，$\\mathrm{i}$ 是虚数单位。为了本任务的目的，取 $n=1$，$\\alpha = 1$ 和 $\\phi = [1]$，因此 $x_k = e^{\\mathrm{i}\\,\\omega\\,k\\,\\Delta t}$ 是一个标量。您必须估计使快照前进一个时间步的采样模式特征值 $\\lambda$，并由此推断出连续时间角频率的估计值。然后，您必须评估推断出的频率是否在给定的采样间隔 $\\Delta t$ 下指示了时间混叠。\n\n对于下述每个测试用例，通过在时间 $t_k = k\\,\\Delta t$ 生成 $M$ 个快照 $x_0, x_1, \\dots, x_{M-1}$ 来构建长度为 $M$ 的快照序列。定义快照矩阵 $X = [x_0,\\dots,x_{M-2}]$ 和 $Y = [x_1,\\dots,x_{M-1}]$。考虑一个（在最小二乘意义下）使快照前进一个时间步的最佳拟合线性算子 $A$，使得 $Y \\approx A\\,X$。令 $\\lambda$ 表示 $A$ 在 $X$ 的值域上的限制的唯一特征值。通过复对数的主值将 $\\lambda$ 映射到连续时间角频率估计值：如果对于某个实数 $\\sigma$ 和实数 $\\theta \\in (-\\pi,\\pi]$, 有 $\\lambda = e^{(\\sigma + \\mathrm{i}\\,\\theta)}$，则定义主角频率估计值 $\\widehat{\\omega}_{\\mathrm{pr}} = \\theta/\\Delta t$（单位：$\\mathrm{rad/s}$）。报告非负主值 $|\\widehat{\\omega}_{\\mathrm{pr}}|$。\n\n混叠评估：当真实角频率 $\\omega$ 位于可分辨主带 $(-\\pi/\\Delta t,\\ \\pi/\\Delta t]$ 之外时，会发生时间混叠。根据主估计值，如果报告的非负主估计值与真实 $\\omega$ 之间的绝对误差超过固定容差 $\\tau = 1.0$（单位：$\\mathrm{rad/s}$），即如果 $||\\widehat{\\omega}_{\\mathrm{pr}}| - \\omega|  \\tau$，则声明检测到混叠。\n\n您的程序必须为以下参数值测试套件生成结果，每个测试由三元组 $(\\omega,\\ \\Delta t,\\ M)$ 定义：\n\n- 测试 A（正常路径，低于 Nyquist 频率）：$(\\omega,\\ \\Delta t,\\ M) = (40.0,\\ 0.02,\\ 200)$。\n- 测试 B（高于 Nyquist 频率，明显混叠）：$(\\omega,\\ \\Delta t,\\ M) = (400.0,\\ 0.01,\\ 300)$。\n- 测试 C（Nyquist 边界情况）：$(\\omega,\\ \\Delta t,\\ M) = \\left(\\dfrac{\\pi}{0.01},\\ 0.01,\\ 200\\right)$。\n\n所有角度必须以弧度为单位，所有角频率必须以 $\\mathrm{rad/s}$ 为单位。时间必须以 $\\mathrm{s}$ 为单位。对于每个测试用例，输出一个双元素列表 $[\\ |\\widehat{\\omega}_{\\mathrm{pr}}|,\\ \\text{is\\_aliased}\\ ]$，其中 $|\\widehat{\\omega}_{\\mathrm{pr}}|$ 是一个四舍五入到六位小数的浮点数，$\\text{is\\_aliased}$ 是如上定义的布尔值。您的程序应生成单行输出，其中包含三个测试用例的结果，格式为由方括号括起来的逗号分隔列表，例如 $[[\\dots],[\\dots],[\\dots]]$。",
            "solution": "问题陈述经过严格验证。\n\n步骤 1：提取的已知条件。\n- 系统是单一、空间固定的振荡模式。\n- 在时间 $t_k = k\\,\\Delta t$ 的状态是 $x_k \\in \\mathbb{C}^n$。\n- 状态演化由 $x_k = \\alpha \\,\\phi \\, e^{\\mathrm{i}\\,\\omega\\, t_k}$ 描述，其中 $\\omega$ 是真实角频率，$\\Delta t$ 是时间步长，$\\alpha$ 是非零复振幅，$\\phi$ 是非零空间模态向量。\n- 对于此问题，参数简化为 $n=1$, $\\alpha=1$ 和 $\\phi=[1]$，得到标量快照序列 $x_k = e^{\\mathrm{i}\\,\\omega\\,k\\,\\Delta t}$。\n- 对于长度为 $M$ 的序列，快照矩阵定义为 $X = [x_0, \\dots, x_{M-2}]$ 和 $Y = [x_1, \\dots, x_{M-1}]$。\n- 目标是找到最佳拟合线性算子 $A$ 使得 $Y \\approx A\\,X$。\n- $\\lambda$ 定义为 $A$ 在 $X$ 的值域上的限制的唯一特征值。\n- 连续时间角频率估计值 $\\widehat{\\omega}_{\\mathrm{pr}}$ 是使用复对数的主值从 $\\lambda$ 导出的。如果 $\\lambda = e^{(\\sigma + \\mathrm{i}\\,\\theta)}$ 且 $\\theta \\in (-\\pi, \\pi]$，则 $\\widehat{\\omega}_{\\mathrm{pr}} = \\theta/\\Delta t$。要报告的值是 $|\\widehat{\\omega}_{\\mathrm{pr}}|$。\n- 如果估计频率与真实频率之间的绝对误差超过容差 $\\tau = 1.0 \\, \\mathrm{rad/s}$，即 $||\\widehat{\\omega}_{\\mathrm{pr}}| - \\omega|  \\tau$，则检测到时间混叠。\n- 提供的测试用例是：\n  1. $(\\omega, \\Delta t, M) = (40.0, 0.02, 200)$。\n  2. $(\\omega, \\Delta t, M) = (400.0, 0.01, 300)$。\n  3. $(\\omega, \\Delta t, M) = (\\pi/0.01, 0.01, 200)$。\n\n步骤 2：已知条件的验证。\n- **科学依据**：该问题是动态模式分解 (Dynamic Mode Decomposition, DMD) 的一个简化、无噪声应用。DMD 是计算工程和动力系统数据驱动分析中一种标准且成熟的方法。离散时间演化算子、特征值、混叠和 Nyquist 准则等概念是信号处理和数值分析中的基本原理。\n- **适定性**：该问题在数学上是明确的。对于单一的纯谐波模式，快照矩阵 $X$ 的秩为一，这导致一个唯一定义的 $1 \\times 1$ 算子 $A$ 和一个唯一的特征值 $\\lambda$。计算频率估计值和评估混叠的程序已明确定义。\n- **客观性**：该问题使用精确的数学语言陈述，没有主观性或歧义。\n\n步骤 3：结论与行动。\n该问题科学合理、适定且客观。它被判定为**有效**。将提供解决方案。\n\n目标是计算主角频率估计值 $|\\widehat{\\omega}_{\\mathrm{pr}}|$ 并确定给定单模系统是否存在混叠。该过程基于一个简化的动态模式分解 (DMD) 框架。\n\n首先，我们建立快照矩阵 $X$ 和 $Y$ 之间的关系。快照由标量序列 $x_k = e^{\\mathrm{i}\\,\\omega\\,k\\,\\Delta t}$ 给出，其中 $k = 0, 1, \\dots, M-1$。\n快照矩阵是 $1 \\times (M-1)$ 的行向量：\n$$ X = [x_0, x_1, \\dots, x_{M-2}] $$\n$$ Y = [x_1, x_2, \\dots, x_{M-1}] $$\n通过检查分量，我们看到第 $(k+1)$ 个快照与第 $k$ 个快照通过一个简单的复数乘法相关联：\n$$ x_{k+1} = e^{\\mathrm{i}\\,\\omega\\,(k+1)\\,\\Delta t} = e^{\\mathrm{i}\\,\\omega\\,k\\,\\Delta t} \\cdot e^{\\mathrm{i}\\,\\omega\\,\\Delta t} = x_k \\cdot e^{\\mathrm{i}\\,\\omega\\,\\Delta t} $$\n这意味着整个快照矩阵之间存在直接的线性关系：\n$$ Y = X \\cdot e^{\\mathrm{i}\\,\\omega\\,\\Delta t} $$\n问题要求找到最小化 Frobenius 范数 $||Y - AX||_F$ 的最佳拟合线性算子 $A$。对于这种标量情况 ($n=1$)，算子 $A$ 是一个 $1 \\times 1$ 矩阵，等效于一个标量。最小二乘解由 $A = Y X^{\\dagger}$ 给出，其中 $X^{\\dagger}$ 是 $X$ 的 Moore-Penrose 伪逆。\n鉴于 $Y = X \\cdot e^{\\mathrm{i}\\,\\omega\\,\\Delta t}$， $A$ 的表达式变为：\n$$ A = (X \\cdot e^{\\mathrm{i}\\,\\omega\\,\\Delta t}) X^{\\dagger} = e^{\\mathrm{i}\\,\\omega\\,\\Delta t} (X X^{\\dagger}) $$\n由于 $X$ 是一个非零行向量，矩阵 $X X^{\\dagger}$ 是 $X$ 值域上的单位映射（标量 $1$）。因此，算子 $A$ 精确地是复标量：\n$$ A = e^{\\mathrm{i}\\,\\omega\\,\\Delta t} $$\n$A$ 在 $X$ 值域上的限制的特征值 $\\lambda$ 就是标量 $A$ 本身。\n$$ \\lambda = e^{\\mathrm{i}\\,\\omega\\,\\Delta t} $$\n这个结果表明，对于一个无噪声的单模系统，DMD 算法可以恢复出精确的离散时间演化特征值。快照的数量 $M$（只要 $M1$）与这个理想计算无关。\n\n接下来，我们推断连续时间角频率。关系式由 $\\lambda = e^{\\Omega \\Delta t}$ 给出，其中 $\\Omega = \\sigma + \\mathrm{i}\\widehat{\\omega}$ 是连续时间特征值。为了恢复 $\\widehat{\\omega}$，我们使用复对数：\n$$ \\ln(\\lambda) = \\ln(|e^{\\mathrm{i}\\,\\omega\\,\\Delta t}|) + \\mathrm{i}\\,\\arg(e^{\\mathrm{i}\\,\\omega\\,\\Delta t}) = \\Omega \\Delta t $$\n问题指定使用辐角的主值 $\\theta = \\arg(\\lambda)$，它位于区间 $(-\\pi, \\pi]$ 内。\n$$ \\theta = \\mathrm{atan2}(\\mathrm{Im}(\\lambda), \\mathrm{Re}(\\lambda)) $$\n此操作将真实相角 $\\omega\\,\\Delta t$ 映射到其主值，这是时间混叠的根源。\n那么主角频率估计值 $\\widehat{\\omega}_{\\mathrm{pr}}$ 是：\n$$ \\widehat{\\omega}_{\\mathrm{pr}} = \\frac{\\theta}{\\Delta t} $$\n要报告的值是其非负对应值 $|\\widehat{\\omega}_{\\mathrm{pr}}|$。\n\n最后，我们评估混叠。可分辨的角频率带是 $(-\\pi/\\Delta t, \\pi/\\Delta t]$。如果真实频率 $\\omega$ 在此带之外，估计频率 $\\widehat{\\omega}_{\\mathrm{pr}}$ 将是真实频率的“混叠”。问题定义了一个基于数值容差 $\\tau=1.0$ 的检测条件：如果满足以下条件，则存在混叠\n$$ ||\\widehat{\\omega}_{\\mathrm{pr}}| - \\omega|  1.0 $$\n\n我们将此过程应用于每个测试用例。\n\n情况 A：$(\\omega, \\Delta t, M) = (40.0, 0.02, 200)$\nNyquist 角频率为 $\\omega_{Nyq} = \\pi/\\Delta t = \\pi/0.02 \\approx 157.08 \\, \\mathrm{rad/s}$。由于 $\\omega = 40.0  \\omega_{Nyq}$，我们预计不会发生混叠。\n1.  计算每步的真实相角：$\\omega\\,\\Delta t = 40.0 \\times 0.02 = 0.8 \\, \\mathrm{rad}$。\n2.  由于 $0.8 \\in (-\\pi, \\pi]$，主辐角为 $\\theta = 0.8$。\n3.  计算频率估计值：$\\widehat{\\omega}_{\\mathrm{pr}} = 0.8 / 0.02 = 40.0 \\, \\mathrm{rad/s}$。则 $|\\widehat{\\omega}_{\\mathrm{pr}}| = 40.0$。\n4.  检查混叠：$||\\widehat{\\omega}_{\\mathrm{pr}}| - \\omega| = |40.0 - 40.0| = 0.0$。由于 $0.0 \\le 1.0$，未检测到混叠。\n结果：$[40.000000, \\mathrm{False}]$\n\n情况 B：$(\\omega, \\Delta t, M) = (400.0, 0.01, 300)$\nNyquist 角频率为 $\\omega_{Nyq} = \\pi/\\Delta t = \\pi/0.01 \\approx 314.16 \\, \\mathrm{rad/s}$。由于 $\\omega = 400.0  \\omega_{Nyq}$，我们预计会发生混叠。\n1.  计算每步的真实相角：$\\omega\\,\\Delta t = 400.0 \\times 0.01 = 4.0 \\, \\mathrm{rad}$。\n2.  该角度在 $(-\\pi, \\pi]$ 之外。我们在此区间内找到等效角度：$\\theta = 4.0 - 2\\pi \\approx 4.0 - 6.283185 = -2.283185 \\, \\mathrm{rad}$。\n3.  计算频率估计值：$\\widehat{\\omega}_{\\mathrm{pr}} = -2.283185 / 0.01 = -228.3185 \\, \\mathrm{rad/s}$。则 $|\\widehat{\\omega}_{\\mathrm{pr}}| = 228.3185$。\n4.  检查混叠：$||\\widehat{\\omega}_{\\mathrm{pr}}| - \\omega| = |228.3185 - 400.0| = |-171.6815| = 171.6815$。由于 $171.6815  1.0$，检测到混叠。\n结果：$[228.318531, \\mathrm{True}]$\n\n情况 C：$(\\omega, \\Delta t, M) = (\\pi/0.01, 0.01, 200)$\n真实频率正好在 Nyquist 边界上：$\\omega = \\pi/0.01 \\approx 314.16 \\, \\mathrm{rad/s}$。\n1.  计算每步的真实相角：$\\omega\\,\\Delta t = (\\pi/0.01) \\times 0.01 = \\pi \\, \\mathrm{rad}$。\n2.  主辐角区间是 $(-\\pi, \\pi]$。由于 $\\pi$ 包含在此区间内，主辐角为 $\\theta = \\pi$。\n3.  计算频率估计值：$\\widehat{\\omega}_{\\mathrm{pr}} = \\pi / 0.01 = \\omega$。则 $|\\widehat{\\omega}_{\\mathrm{pr}}| = \\pi/0.01 \\approx 314.159265$。\n4.  检查混叠：$||\\widehat{\\omega}_{\\mathrm{pr}}| - \\omega| = |\\omega - \\omega| = 0.0$。由于 $0.0 \\le 1.0$，未检测到混叠。\n结果：$[314.159265, \\mathrm{False}]$",
            "answer": "```\n[[40.000000, False],[228.318531, True],[314.159265, False]]\n```"
        },
        {
            "introduction": "标准的DMD算法适用于自治（无外部输入）的动力系统。然而，在工程和物理学的许多应用中，我们感兴趣的是受外部驱动或控制的系统。带控制输入的动态模态分解（DMDc）正是为此而生，它将DMD框架扩展到可以同时辨识系统动态和控制输入影响的模型。这个练习将带你运用DMDc从状态和输入快照中估计系统矩阵，并将其与经典的系统辨识方法——特征系统实现算法（ERA）进行比较 。",
            "id": "3987561",
            "problem": "在航空航天计算流体力学 (CFD) 中一个受控流动的降阶模型中，假设使用单个主导的本征正交分解 (Proper Orthogonal Decomposition, POD) 坐标作为状态。这个标量降阶状态的演化被建模为一个离散时间、线性、时不变、控制仿射系统，\n$$\nx_{k+1} = A x_k + B u_k,\n$$\n其中 $x_k \\in \\mathbb{R}$ 是离散时间索引 $k$ 处的标量状态，$u_k \\in \\mathbb{R}$ 是标量控制输入，$A, B \\in \\mathbb{R}$ 是未知常数。您在均匀采样下观测到以下状态和输入快照：\n$$\nx_0 = 0,\\quad u_0 = 1,\\quad x_1 = 1, \\\\\nx_1 = 1,\\quad u_1 = 2,\\quad x_2 = \\frac{5}{2}, \\\\\nx_2 = \\frac{5}{2},\\quad u_2 = 0,\\quad x_3 = \\frac{5}{4}.\n$$\n从线性回归的最小二乘法第一性原理出发，使用基于伪逆的法方程对级联快照矩阵推导带控制的动态模态分解 (Dynamic Mode Decomposition with control, DMDc) 的 $A$ 和 $B$ 的估计量。然后，独立地，考虑在特征系统实现算法 (Eigensystem Realization Algorithm, ERA) 下通过短时脉冲响应实验进行输入输出辨识。对于一个单输入单输出、一阶、稳定且具有严格真有理动力学的系统，其脉冲响应马尔可夫参数由下式给出：\n$$\nh_1 = 1,\\quad h_2 = \\frac{1}{2}.\n$$\n使用与一阶模型一致的最小汉克尔 (Hankel) 构造，从这些马尔可夫参数中推导出 $A$ 的 ERA 估计。\n\n最后，计算从给定的状态-输入快照获得的 $A$ 的 DMDc 估计值与从马尔可夫参数获得的 $A$ 的 ERA 估计值之间的绝对差。将最终答案表示为一个实数。",
            "solution": "该问题要求使用两种不同的方法计算系统参数 $A$：带控制的动态模态分解 (DMDc) 和特征系统实现算法 (ERA)。最终答案是两种估计值之间的绝对差。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n问题提供了以下信息：\n- 系统模型是一个离散时间、线性、时不变、控制仿射系统：$x_{k+1} = A x_k + B u_k$，其中 $x_k, u_k, A, B \\in \\mathbb{R}$。\n- 用于 DMDc 的一组状态和输入快照：\n  - 对于 $k=0$：$x_0 = 0$，$u_0 = 1$，得到 $x_1 = 1$。\n  - 对于 $k=1$：$x_1 = 1$，$u_1 = 2$，得到 $x_2 = \\frac{5}{2}$。\n  - 对于 $k=2$：$x_2 = \\frac{5}{2}$，$u_2 = 0$，得到 $x_3 = \\frac{5}{4}$。\n- 用于 ERA 的一组脉冲响应马尔可夫参数，适用于单输入单输出 (SISO)、一阶、稳定且具有严格真有理动力学的系统：\n  - $h_1 = 1$\n  - $h_2 = \\frac{1}{2}$\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题具有科学依据，因为 DMDc 和 ERA 是系统辨识和控制理论中的标准、成熟的算法，尤其适用于航空航天 CFD 等领域的降阶建模。该问题是适定的，提供了足够的数据来确定未知参数。定义和数据是客观、精确的，没有矛盾或歧义。问题是自洽的，在数学上是合理的。\n\n**步骤 3：结论和行动**\n\n问题有效。我们将继续进行解答。\n\n### 第 1 部分：$A$ 的 DMDc 估计\n\n控制方程为 $x_{k+1} = A x_k + B u_k$。这可以写成一系列快照的矩阵形式。DMDc 的核心原理是找到一个线性算子，该算子能够最好地将一个时间步的系统状态和控制输入映射到下一个时间步的状态。\n我们可以将我们快照序列的关系写成：\n$$\nx_{k+1} = \\begin{pmatrix} A  B \\end{pmatrix} \\begin{pmatrix} x_k \\\\ u_k \\end{pmatrix}\n$$\n让我们定义快照矩阵。状态快照被排列成两个矩阵，$X$ 和 $X'$，其中 $X'$ 是 $X$ 的时间平移版本。\n$$\nX = \\begin{pmatrix} x_0  x_1  x_2 \\end{pmatrix} = \\begin{pmatrix} 0  1  \\frac{5}{2} \\end{pmatrix}\n$$\n$$\nX' = \\begin{pmatrix} x_1  x_2  x_3 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{5}{2}  \\frac{5}{4} \\end{pmatrix}\n$$\n控制输入快照被排列在一个矩阵 $U$ 中：\n$$\nU = \\begin{pmatrix} u_0  u_1  u_2 \\end{pmatrix} = \\begin{pmatrix} 1  2  0 \\end{pmatrix}\n$$\nDMDc 公式旨在找到系统矩阵 $G = \\begin{pmatrix} A  B \\end{pmatrix}$，以最小化近似 $X' \\approx G \\Omega$ 中的最小二乘误差，其中 $\\Omega$ 是状态和输入的级联矩阵：\n$$\n\\Omega = \\begin{pmatrix} X \\\\ U \\end{pmatrix} = \\begin{pmatrix} 0  1  \\frac{5}{2} \\\\ 1  2  0 \\end{pmatrix}\n$$\n线性回归问题是找到使 $\\|X' - G \\Omega\\|_F^2$ 最小化的 $G$。解由法方程给出，即 $G = X' \\Omega^+$，其中 $\\Omega^+$ 是 $\\Omega$ 的摩尔-彭若斯 (Moore-Penrose) 伪逆。对于一个列数多于行数（“胖”矩阵）的矩阵 $\\Omega$，其伪逆计算为 $\\Omega^+ = \\Omega^T (\\Omega \\Omega^T)^{-1}$。\n\n首先，我们计算乘积 $\\Omega \\Omega^T$：\n$$\n\\Omega \\Omega^T = \\begin{pmatrix} 0  1  \\frac{5}{2} \\\\ 1  2  0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  2 \\\\ \\frac{5}{2}  0 \\end{pmatrix} = \\begin{pmatrix} (0)(0) + (1)(1) + (\\frac{5}{2})(\\frac{5}{2})  (0)(1) + (1)(2) + (\\frac{5}{2})(0) \\\\ (1)(0) + (2)(1) + (0)(\\frac{5}{2})  (1)(1) + (2)(2) + (0)(0) \\end{pmatrix}\n$$\n$$\n\\Omega \\Omega^T = \\begin{pmatrix} 1 + \\frac{25}{4}  2 \\\\ 2  1 + 4 \\end{pmatrix} = \\begin{pmatrix} \\frac{29}{4}  2 \\\\ 2  5 \\end{pmatrix}\n$$\n接下来，我们计算这个矩阵的逆。行列式为 $\\det(\\Omega \\Omega^T) = (\\frac{29}{4})(5) - (2)(2) = \\frac{145}{4} - 4 = \\frac{129}{4}$。\n逆矩阵是：\n$$\n(\\Omega \\Omega^T)^{-1} = \\frac{1}{\\frac{129}{4}} \\begin{pmatrix} 5  -2 \\\\ -2  \\frac{29}{4} \\end{pmatrix} = \\frac{4}{129} \\begin{pmatrix} 5  -2 \\\\ -2  \\frac{29}{4} \\end{pmatrix} = \\begin{pmatrix} \\frac{20}{129}  -\\frac{8}{129} \\\\ -\\frac{8}{129}  \\frac{29}{129} \\end{pmatrix}\n$$\n现在我们可以计算估计矩阵 $G = \\begin{pmatrix} A  B \\end{pmatrix} = X' \\Omega^T (\\Omega \\Omega^T)^{-1}$：\n$$\nG = \\begin{pmatrix} 1  \\frac{5}{2}  \\frac{5}{4} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  2 \\\\ \\frac{5}{2}  0 \\end{pmatrix} \\begin{pmatrix} \\frac{20}{129}  -\\frac{8}{129} \\\\ -\\frac{8}{129}  \\frac{29}{129} \\end{pmatrix}\n$$\n让我们先计算 $X' \\Omega^T$：\n$$\nX' \\Omega^T = \\begin{pmatrix} 1  \\frac{5}{2}  \\frac{5}{4} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  2 \\\\ \\frac{5}{2}  0 \\end{pmatrix} = \\begin{pmatrix} (1)(0) + (\\frac{5}{2})(1) + (\\frac{5}{4})(\\frac{5}{2})  (1)(1) + (\\frac{5}{2})(2) + (\\frac{5}{4})(0) \\end{pmatrix}\n$$\n$$\nX' \\Omega^T = \\begin{pmatrix} \\frac{5}{2} + \\frac{25}{8}  1 + 5 \\end{pmatrix} = \\begin{pmatrix} \\frac{20+25}{8}  6 \\end{pmatrix} = \\begin{pmatrix} \\frac{45}{8}  6 \\end{pmatrix}\n$$\n现在，我们乘以 $(\\Omega \\Omega^T)^{-1}$：\n$$\nG = \\begin{pmatrix} A  B \\end{pmatrix} = \\begin{pmatrix} \\frac{45}{8}  6 \\end{pmatrix} \\begin{pmatrix} \\frac{20}{129}  -\\frac{8}{129} \\\\ -\\frac{8}{129}  \\frac{29}{129} \\end{pmatrix}\n$$\n第一个元素是 $A$ 的估计值：\n$$\nA_{\\text{DMDc}} = \\left(\\frac{45}{8}\\right) \\left(\\frac{20}{129}\\right) + (6) \\left(-\\frac{8}{129}\\right) = \\frac{900}{1032} - \\frac{48}{129} = \\frac{900}{1032} - \\frac{384}{1032}\n$$\n$$\nA_{\\text{DMDc}} = \\frac{900 - 384}{1032} = \\frac{516}{1032} = \\frac{1}{2}\n$$\n因此，$A$ 的 DMDc 估计值为 $A_{\\text{DMDc}} = \\frac{1}{2}$。\n\n### 第 2 部分：$A$ 的 ERA 估计\n\n特征系统实现算法 (ERA) 从系统的脉冲响应（由马尔可夫参数序列 $h_k$ 给出）构造状态空间模型。对于具有状态空间表示 $(A, B, C, D)$ 的离散时间 LTI 系统，假设系统是严格真有理的 ($D=0$)，马尔可夫参数由 $h_k = C A^{k-1} B$ 给出（对于 $k \\geq 1$）。\n\n对于一阶 SISO 系统，矩阵 $A$、$B$ 和 $C$ 都是标量。给定的马尔可夫参数是：\n$$\nh_1 = C B = 1\n$$\n$$\nh_2 = C A^{2-1} B = C A B = \\frac{1}{2}\n$$\n为了找到 $A$，我们可以取 $h_2$ 与 $h_1$ 的比值：\n$$\n\\frac{h_2}{h_1} = \\frac{CAB}{CB}\n$$\n假设是最小实现，$C \\neq 0$ 且 $B \\neq 0$，所以我们可以消去这些项：\n$$\nA_{\\text{ERA}} = \\frac{h_2}{h_1} = \\frac{1/2}{1} = \\frac{1}{2}\n$$\n这个结果与使用最小汉克尔 (Hankel) 矩阵构造的正式 ERA 过程是一致的。对于一阶系统，我们可以构成最小的 $1 \\times 1$ 汉克尔矩阵：\n$H(0) = \\begin{pmatrix} h_1 \\end{pmatrix} = \\begin{pmatrix} 1 \\end{pmatrix}$\n$H(1) = \\begin{pmatrix} h_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\end{pmatrix}$\n系统矩阵 $A$ 的 ERA 公式是 $A = (U_r \\Sigma_r^{1/2})^{+} H(1) (\\Sigma_r^{1/2} V_r^T)^{+}$，其中 $H(0)$ 的 SVD 是 $U \\Sigma V^T$，下标 $r$ 表示截断到秩 $r=1$。对于一个 $1 \\times 1$ 矩阵，SVD 是平凡的：$U_1=\\begin{pmatrix} 1 \\end{pmatrix}$，$\\Sigma_1=\\begin{pmatrix} 1 \\end{pmatrix}$，$V_1=\\begin{pmatrix} 1 \\end{pmatrix}$。该公式简化为 $A = H(0)^{-1} H(1)$，但在 ERA 中使用的一个更稳定的变体是 $A = \\Sigma_1^{-1/2} U_1^T H(1) V_1 \\Sigma_1^{-1/2}$。\n$$\nA_{\\text{ERA}} = \\begin{pmatrix} 1 \\end{pmatrix}^{-1/2} \\begin{pmatrix} 1 \\end{pmatrix}^T \\begin{pmatrix} \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix}^{-1/2} = \\begin{pmatrix} 1 \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\end{pmatrix}\n$$\n因此，$A$ 的 ERA 估计值为 $A_{\\text{ERA}} = \\frac{1}{2}$。\n\n### 最终计算\n\n问题要求计算 $A$ 的 DMDc 估计值和 $A$ 的 ERA 估计值之间的绝对差。\n$$\n|A_{\\text{DMDc}} - A_{\\text{ERA}}| = \\left|\\frac{1}{2} - \\frac{1}{2}\\right| = 0\n$$\n这两种方法应用于代表相同底层系统的两个不同数据集，得出了参数 $A$ 的相同估计值。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}