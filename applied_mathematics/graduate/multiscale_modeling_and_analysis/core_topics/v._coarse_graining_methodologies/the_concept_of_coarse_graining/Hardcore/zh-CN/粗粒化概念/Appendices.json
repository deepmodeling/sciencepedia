{
    "hands_on_practices": [
        {
            "introduction": "在粗粒化中，一个核心任务是在简化系统的同时保留其本质的物理特性。一个关键的区别在于，严谨的粗粒化方法不同于任意的“平滑”操作，它必须守恒像总质量这样的基本物理量。这项练习将通过一个具体的例子，动手展示这一重要原则，阐明为何一个简单的卷积滤波可能会违反质量守恒，而一个构造恰当的粗粒化算子则能保证其守恒性 。",
            "id": "3817257",
            "problem": "考虑一个标量密度场 $\\rho \\in L^{1}(\\mathbb{R})$，其总质量 $M = \\int_{\\mathbb{R}} \\rho(x)\\,dx$ 有限。定义一个平滑算子 $S_{G}$，通过与一个滤波器 $G \\in L^{1}(\\mathbb{R})$ 进行卷积得到，$S_{G}[\\rho] = G * \\rho$，其中卷积由 $(G * \\rho)(x) = \\int_{\\mathbb{R}} G(x-y)\\,\\rho(y)\\,dy$ 给出。\n\n1) 取显式的（非归一化的）高斯滤波器 $G_{\\varepsilon}(x) = \\exp\\!\\big(-\\frac{x^{2}}{2\\varepsilon^{2}}\\big)$，其中 $\\varepsilon0$。证明 $S_{G_{\\varepsilon}}$ 通常不保持总质量，并计算由下式定义的放大因子 $R(\\varepsilon)$\n$$\nR(\\varepsilon) \\equiv \\frac{\\int_{\\mathbb{R}} (G_{\\varepsilon} * \\rho)(x)\\,dx}{\\int_{\\mathbb{R}} \\rho(x)\\,dx}.\n$$\n将你对 $R(\\varepsilon)$ 的最终答案表示为一个闭式解析表达式。\n\n2) 定义一个粗粒化（coarse-graining (CG)）算子 $\\Pi_{\\Delta}$（对于 $\\Delta0$），通过将 $\\mathbb{R}$ 分割成不相交的区间 $I_{k} = [k\\Delta,(k+1)\\Delta)$（对于 $k \\in \\mathbb{Z}$），并设置\n$$\n\\Pi_{\\Delta}[\\rho](x) \\equiv \\frac{1}{\\Delta}\\int_{I_{k}} \\rho(y)\\,dy \\quad \\text{for } x \\in I_{k}.\n$$\n证明 $\\Pi_{\\Delta}$ 保持总质量，即\n$$\n\\int_{\\mathbb{R}} \\Pi_{\\Delta}[\\rho](x)\\,dx = \\int_{\\mathbb{R}} \\rho(x)\\,dx.\n$$\n\n报告 $R(\\varepsilon)$ 作为你的最终答案。",
            "solution": "问题陈述经评估有效。它在科学上基于实分析和泛函分析的数学原理，特别是关于卷积算子和函数空间（如 $L^1(\\mathbb{R})$）的原理，这些是信号处理、统计力学和多尺度建模的基础。该问题是适定的，所有术语都有明确定义，并提供了足够的信息来推导所要求的量和证明。它没有歧义、主观性和事实错误。\n\n我们按顺序解决问题的两个部分。\n\n**第一部分：平滑算子 $S_{G_{\\varepsilon}}$ 的分析**\n\n第一部分要求我们分析平滑算子 $S_{G_{\\varepsilon}}[\\rho] = G_{\\varepsilon} * \\rho$ 对密度场 $\\rho(x)$ 总质量的影响。滤波器是非归一化的高斯函数 $G_{\\varepsilon}(x) = \\exp\\left(-\\frac{x^{2}}{2\\varepsilon^{2}}\\right)$。平滑场的总质量由积分 $\\int_{\\mathbb{R}} (G_{\\varepsilon} * \\rho)(x)\\,dx$ 给出。\n\n我们首先代入卷积的定义：\n$$\n\\int_{\\mathbb{R}} (G_{\\varepsilon} * \\rho)(x)\\,dx = \\int_{\\mathbb{R}} \\left( \\int_{\\mathbb{R}} G_{\\varepsilon}(x-y)\\,\\rho(y)\\,dy \\right) dx\n$$\n函数 $\\rho(x)$ 和 $G_{\\varepsilon}(x)$ 都在 $L^{1}(\\mathbb{R})$ 中。由于两个函数也都是非负的，我们可以应用 Tonelli 定理（或适用于非负函数的 Fubini 定理）来交换积分顺序：\n$$\n\\int_{\\mathbb{R}} \\int_{\\mathbb{R}} G_{\\varepsilon}(x-y)\\,\\rho(y)\\,dx\\,dy = \\int_{\\mathbb{R}} \\rho(y) \\left( \\int_{\\mathbb{R}} G_{\\varepsilon}(x-y)\\,dx \\right) dy\n$$\n让我们计算内层积分 $\\int_{\\mathbb{R}} G_{\\varepsilon}(x-y)\\,dx$。我们通过设置 $u = x-y$ 来进行变量替换，这意味着 $du = dx$。当 $x$ 遍历 $\\mathbb{R}$ 时，$u$ 也遍历 $\\mathbb{R}$。积分变为：\n$$\n\\int_{\\mathbb{R}} G_{\\varepsilon}(x-y)\\,dx = \\int_{\\mathbb{R}} G_{\\varepsilon}(u)\\,du = \\int_{\\mathbb{R}} \\exp\\left(-\\frac{u^{2}}{2\\varepsilon^{2}}\\right) du\n$$\n这是一个标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\,dx = \\sqrt{\\frac{\\pi}{a}}$。在我们的例子中，参数 $a$ 是 $\\frac{1}{2\\varepsilon^{2}}$。因此，积分的值是：\n$$\n\\int_{\\mathbb{R}} \\exp\\left(-\\frac{u^{2}}{2\\varepsilon^{2}}\\right) du = \\sqrt{\\frac{\\pi}{1/(2\\varepsilon^{2})}} = \\sqrt{2\\pi\\varepsilon^{2}} = |\\varepsilon|\\sqrt{2\\pi}\n$$\n由于问题陈述 $\\varepsilon  0$，我们有 $|\\varepsilon|=\\varepsilon$。因此，滤波器的积分是 $\\varepsilon\\sqrt{2\\pi}$。\n\n将此常数值代回到平滑场的总质量表达式中：\n$$\n\\int_{\\mathbb{R}} (G_{\\varepsilon} * \\rho)(x)\\,dx = \\int_{\\mathbb{R}} \\rho(y) \\left( \\varepsilon\\sqrt{2\\pi} \\right) dy = \\varepsilon\\sqrt{2\\pi} \\int_{\\mathbb{R}} \\rho(y)\\,dy\n$$\n当且仅当乘法因子为 $1$ 时，即 $\\varepsilon\\sqrt{2\\pi} = 1$，总质量才得以保持。这只对特定值 $\\varepsilon = \\frac{1}{\\sqrt{2\\pi}}$ 成立。对于任何其他 $\\varepsilon  0$ 的值，总质量都会改变。因此，算子 $S_{G_{\\varepsilon}}$ 通常不保持总质量。\n\n放大因子 $R(\\varepsilon)$ 定义为新的总质量与原始总质量之比：\n$$\nR(\\varepsilon) = \\frac{\\int_{\\mathbb{R}} (G_{\\varepsilon} * \\rho)(x)\\,dx}{\\int_{\\mathbb{R}} \\rho(x)\\,dx} = \\frac{\\varepsilon\\sqrt{2\\pi} \\int_{\\mathbb{R}} \\rho(x)\\,dx}{\\int_{\\mathbb{R}} \\rho(x)\\,dx}\n$$\n假设总质量 $M = \\int_{\\mathbb{R}} \\rho(x)\\,dx$ 非零（否则 $\\rho=0$ 几乎处处成立，问题是平凡的），我们可以从分子和分母中消去这一项，得到放大因子的闭式表达式：\n$$\nR(\\varepsilon) = \\varepsilon\\sqrt{2\\pi}\n$$\n\n**第二部分：粗粒化算子 $\\Pi_{\\Delta}$ 的分析**\n\n第二部分要求我们证明粗粒化算子 $\\Pi_{\\Delta}$ 保持总质量。该算子在不相交的区间 $I_{k} = [k\\Delta, (k+1)\\Delta)$（对于 $k \\in \\mathbb{Z}$）上定义为：\n$$\n\\Pi_{\\Delta}[\\rho](x) = \\frac{1}{\\Delta}\\int_{I_{k}} \\rho(y)\\,dy \\quad \\text{for } x \\in I_{k}\n$$\n我们需要证明 $\\int_{\\mathbb{R}} \\Pi_{\\Delta}[\\rho](x)\\,dx = \\int_{\\mathbb{R}} \\rho(x)\\,dx$。\n\n由于实数轴 $\\mathbb{R}$ 是区间 $I_k$ 的不相交并集（即 $\\mathbb{R} = \\bigcup_{k \\in \\mathbb{Z}} I_k$），我们可以将 $\\mathbb{R}$ 上的积分分解为这些区间上的积分之和：\n$$\n\\int_{\\mathbb{R}} \\Pi_{\\Delta}[\\rho](x)\\,dx = \\sum_{k \\in \\mathbb{Z}} \\int_{I_k} \\Pi_{\\Delta}[\\rho](x)\\,dx\n$$\n对于任何给定的区间 $I_k$，$\\Pi_{\\Delta}[\\rho](x)$ 的值对于所有 $x \\in I_k$ 都是常数。我们用 $c_k$ 表示这个常数值：\n$$\nc_k = \\frac{1}{\\Delta}\\int_{I_{k}} \\rho(y)\\,dy\n$$\n我们可以将这个常数因子从关于 $x$ 的积分中提出来：\n$$\n\\int_{I_k} \\Pi_{\\Delta}[\\rho](x)\\,dx = \\int_{I_k} c_k\\,dx = c_k \\int_{I_k} 1\\,dx\n$$\n积分 $\\int_{I_k} 1\\,dx$ 表示区间 $I_k$ 的长度，即 $(k+1)\\Delta - k\\Delta = \\Delta$。\n将其代回，我们得到：\n$$\n\\int_{I_k} \\Pi_{\\Delta}[\\rho](x)\\,dx = c_k \\cdot \\Delta = \\left( \\frac{1}{\\Delta}\\int_{I_{k}} \\rho(y)\\,dy \\right) \\Delta = \\int_{I_k} \\rho(y)\\,dy\n$$\n现在我们将此结果代入所有整数 $k$ 的求和中：\n$$\n\\int_{\\mathbb{R}} \\Pi_{\\Delta}[\\rho](x)\\,dx = \\sum_{k \\in \\mathbb{Z}} \\int_{I_k} \\rho(y)\\,dy\n$$\n由于区间 $\\{I_k\\}_{k \\in \\mathbb{Z}}$ 构成了 $\\mathbb{R}$ 的一个划分，这些区间上的积分之和等于 $\\mathbb{R}$ 上的积分：\n$$\n\\sum_{k \\in \\mathbb{Z}} \\int_{I_k} \\rho(y)\\,dy = \\int_{\\bigcup_{k \\in \\mathbb{Z}} I_k} \\rho(y)\\,dy = \\int_{\\mathbb{R}} \\rho(y)\\,dy\n$$\n因此，我们证明了算子 $\\Pi_{\\Delta}$ 保持总质量：\n$$\n\\int_{\\mathbb{R}} \\Pi_{\\Delta}[\\rho](x)\\,dx = \\int_{\\mathbb{R}} \\rho(x)\\,dx\n$$\n这展示了一般的平滑（卷积）操作与一个适当构造的粗粒化投影之间的关键区别：后者被设计用来守恒某些量，如此处的质量。\n\n所要求的最终答案是 $R(\\varepsilon)$ 的表达式。",
            "answer": "$$\\boxed{\\varepsilon\\sqrt{2\\pi}}$$"
        },
        {
            "introduction": "理解了粗粒化的基本原则后，一个实际的问题是如何构建一个粗粒化力场。这项练习介绍了一种强大的数据驱动技术——力匹配法（force matching），并指导你推导出从原子模拟数据中参数化模型的数学解。通过这个实践，你将掌握将高维微观力信息映射到低维粗粒化模型参数的核心数学框架 。",
            "id": "3817275",
            "problem": "考虑多尺度建模与分析中的一个粗粒化映射，其中粗粒化坐标表示为 $X \\in \\mathbb{R}^{d}$，原子坐标表示为 $x \\in \\mathbb{R}^{D}$。设 $\\Pi$ 是一个固定的线性投影算子，它将原子作用力映射到粗粒化作用力，因此对于任何原子状态 $x$，投影力为 $\\Pi F_{\\mathrm{atom}}(x) \\in \\mathbb{R}^{d}$。粗粒化力定义为粗粒化势的负梯度，$F_{\\mathrm{CG}}(X) = -\\nabla U_{\\mathrm{CG}}(X)$，其中粗粒化势假设为一组已知的连续可微基函数 $\\{\\psi_{k}(X)\\}_{k=1}^{p}$ 的线性组合：\n$$\nU_{\\mathrm{CG}}(X; \\theta) = \\sum_{k=1}^{p} \\theta_{k} \\psi_{k}(X),\n$$\n其参数向量为 $\\theta \\in \\mathbb{R}^{p}$。\n\n现提供一个包含 $T$ 个粗粒化构型和原子构型配对样本的数据集 $\\{(X_{t}, x_{t})\\}_{t=1}^{T}$，其中 $T \\geq p$。你需要通过最小化模型预测的粗粒化力与投影的原子作用力之间的平方差来进行力匹配。具体而言，对每个 $t$，定义一个 $d \\times p$ 矩阵 $B_{t}$，其第 $k$ 列为 $-\\nabla \\psi_{k}(X_{t})$，并定义 $y_{t} = \\Pi F_{\\mathrm{atom}}(x_{t}) \\in \\mathbb{R}^{d}$。考虑目标函数\n$$\nJ(\\theta) = \\sum_{t=1}^{T} \\left\\| F_{\\mathrm{CG}}(X_{t}; \\theta) - \\Pi F_{\\mathrm{atom}}(x_{t}) \\right\\|^{2} = \\sum_{t=1}^{T} \\left\\| B_{t} \\theta - y_{t} \\right\\|^{2},\n$$\n其中 $\\|\\cdot\\|$ 表示 $\\mathbb{R}^{d}$ 中的欧几里得范数。\n\n仅从上述定义和力是势的负梯度这一事实出发，在矩阵 $\\sum_{t=1}^{T} B_{t}^{\\top} B_{t}$ 可逆的假设下，推导出刻画 $J(\\theta)$ 最小值点的正规方程，并为最小化参数向量提供一个闭式解析表达式。将最终答案表示为关于 $\\{B_{t}\\}_{t=1}^{T}$ 和 $\\{y_{t}\\}_{t=1}^{T}$ 的单个解析表达式，用以表示最小值点 $\\theta^{\\star}$。无需进行数值计算。最终答案必须是无单位的单个解析表达式。",
            "solution": "题干需要经过验证。\n\n### 第1步：提取已知条件\n- 粗粒化坐标：$X \\in \\mathbb{R}^{d}$。\n- 原子坐标：$x \\in \\mathbb{R}^{D}$。\n- 线性投影算子：$\\Pi$。\n- 投影的原子作用力：$\\Pi F_{\\mathrm{atom}}(x) \\in \\mathbb{R}^{d}$。\n- 粗粒化力：$F_{\\mathrm{CG}}(X) = -\\nabla U_{\\mathrm{CG}}(X)$。\n- 粗粒化势：$U_{\\mathrm{CG}}(X; \\theta) = \\sum_{k=1}^{p} \\theta_{k} \\psi_{k}(X)$，其中 $\\{\\psi_{k}(X)\\}_{k=1}^{p}$ 是已知的连续可微基函数，$\\theta \\in \\mathbb{R}^{p}$ 是参数向量。\n- 数据集：$T$ 个配对样本 $\\{(X_{t}, x_{t})\\}_{t=1}^{T}$。\n- 条件：$T \\geq p$。\n- 矩阵 $B_{t}$：一个 $d \\times p$ 矩阵，对每个 $t$，其第 $k$ 列等于 $-\\nabla \\psi_{k}(X_{t})$。\n- 向量 $y_{t}$：$y_{t} = \\Pi F_{\\mathrm{atom}}(x_{t}) \\in \\mathbb{R}^{d}$。\n- 目标函数：$J(\\theta) = \\sum_{t=1}^{T} \\left\\| F_{\\mathrm{CG}}(X_{t}; \\theta) - \\Pi F_{\\mathrm{atom}}(x_{t}) \\right\\|^{2} = \\sum_{t=1}^{T} \\left\\| B_{t} \\theta - y_{t} \\right\\|^{2}$。\n- 假设：矩阵 $\\sum_{t=1}^{T} B_{t}^{\\top} B_{t}$ 可逆。\n- 任务：推导正规方程以及最小化参数向量 $\\theta^{\\star}$ 的闭式解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了力匹配，这是一种在多尺度建模中用于参数化粗粒化势的标准且成熟的方法。将其表述为线性最小二乘问题是一种典型方法。所有概念都是物理学、数学和计算科学的基础。该问题在科学上是合理的。\n2.  **适定性**：目标函数 $J(\\theta)$ 是一个平方和，因此它是关于 $\\theta$ 的凸二次函数。问题明确指出矩阵 $\\sum_{t=1}^{T} B_{t}^{\\top} B_{t}$ 是可逆的，这在线性最小二乘问题中是存在唯一最小值点的充要条件。该问题是适定的。\n3.  **客观性**：问题以精确、形式化的数学语言陈述，没有歧义或主观论断。\n4.  **不完整或矛盾的设置**：所有必要的定义、变量和条件均已提供。没有矛盾之处。设置是完整且一致的。\n5.  **不切实际或不可行**：该设置是该领域的标准理论问题。对于足够丰富的数据集，矩阵可逆性是一个合理的假设。不存在科学上不合理的条件。\n6.  **不适定或结构不良**：问题结构清晰，要求在优化和线性代数中进行标准推导。\n7.  **伪深刻、琐碎或同义反复**：该问题需要进行严谨、非平凡的数学推导，考察应用于统计拟合的多变量微积分和线性代数的基础知识。它不是琐碎的。\n\n### 第3步：结论与行动\n该问题有科学依据、适定且数学上连贯，因此是有效的。将推导解答。\n\n目标是找到使目标函数 $J(\\theta)$ 最小化的参数向量 $\\theta^{\\star}$。函数 $J(\\theta)$ 由下式给出：\n$$\nJ(\\theta) = \\sum_{t=1}^{T} \\left\\| B_{t} \\theta - y_{t} \\right\\|^{2}\n$$\n量 $\\|\\cdot\\|$ 表示欧几里得范数。向量 $v$ 的欧几里得范数的平方可以表示为内积 $v^{\\top}v$。因此，我们可以将目标函数重写为：\n$$\nJ(\\theta) = \\sum_{t=1}^{T} (B_{t} \\theta - y_{t})^{\\top} (B_{t} \\theta - y_{t})\n$$\n我们展开求和号内的项：\n$$\n(B_{t} \\theta - y_{t})^{\\top} (B_{t} \\theta - y_{t}) = (\\theta^{\\top} B_{t}^{\\top} - y_{t}^{\\top}) (B_{t} \\theta - y_{t}) = \\theta^{\\top} B_{t}^{\\top} B_{t} \\theta - \\theta^{\\top} B_{t}^{\\top} y_t - y_t^{\\top} B_t \\theta + y_t^{\\top} y_t\n$$\n由于 $\\theta^{\\top} B_{t}^{\\top} y_t$ 是一个标量（$1 \\times p$ 乘以 $p \\times d$ 乘以 $d \\times 1$ 得到 $1 \\times 1$），它等于其自身的转置：\n$$\n(\\theta^{\\top} B_{t}^{\\top} y_t)^{\\top} = y_t^{\\top} (B_t^{\\top})^{\\top} (\\theta^{\\top})^{\\top} = y_t^{\\top} B_t \\theta\n$$\n因此，中间两项是相同的。表达式变为：\n$$\n\\theta^{\\top} B_t^{\\top} B_t \\theta - 2 y_t^{\\top} B_t \\theta + y_t^{\\top} y_t\n$$\n将此代回 $J(\\theta)$ 的表达式，并利用求和算子的线性性质：\n$$\nJ(\\theta) = \\sum_{t=1}^{T} (\\theta^{\\top} B_t^{\\top} B_t \\theta - 2 y_t^{\\top} B_t \\theta + y_t^{\\top} y_t)\n$$\n$$\nJ(\\theta) = \\theta^{\\top} \\left( \\sum_{t=1}^{T} B_t^{\\top} B_t \\right) \\theta - 2 \\left( \\sum_{t=1}^{T} y_t^{\\top} B_t \\right) \\theta + \\sum_{t=1}^{T} y_t^{\\top} y_t\n$$\n函数 $J(\\theta)$ 是关于 $\\theta$ 的二次型。由于矩阵 $\\sum_{t=1}^{T} B_t^{\\top} B_t$ 是半正定矩阵（$B_t^{\\top} B_t$）之和，并且已知是可逆的，所以它是正定的。因此，$J(\\theta)$ 有一个唯一的全局最小值。为了找到这个最小值，我们计算 $J(\\theta)$ 关于向量 $\\theta$ 的梯度，并将其设为零向量。\n我们使用标准矩阵微积分恒等式：$\\nabla_{v} (v^{\\top} A v) = (A + A^{\\top})v$ 和 $\\nabla_{v} (c^{\\top} v) = c$。\n设 $A = \\sum_{t=1}^{T} B_t^{\\top} B_t$。矩阵 $A$ 是对称的，因为 $(B_t^{\\top} B_t)^{\\top} = B_t^{\\top} (B_t^{\\top})^{\\top} = B_t^{\\top} B_t$，并且对称矩阵之和也是对称的。因此，对于对称矩阵 $A$，有 $\\nabla_{\\theta} (\\theta^{\\top} A \\theta) = 2A\\theta$。\n线性项的梯度为 $\\nabla_{\\theta} \\left( -2 \\left( \\sum_{t=1}^{T} y_t^{\\top} B_t \\right) \\theta \\right) = -2 \\left( \\sum_{t=1}^{T} y_t^{\\top} B_t \\right)^{\\top} = -2\\sum_{t=1}^{T} B_t^{\\top} y_t$。\n最后一项 $\\sum_{t=1}^{T} y_t^{\\top} y_t$ 相对于 $\\theta$ 是常数，因此其梯度为零。\n结合这些结果，$J(\\theta)$ 的梯度为：\n$$\n\\nabla_{\\theta} J(\\theta) = 2 \\left( \\sum_{t=1}^{T} B_t^{\\top} B_t \\right) \\theta - 2 \\sum_{t=1}^{T} B_t^{\\top} y_t\n$$\n为了找到最小化向量 $\\theta^{\\star}$，我们将梯度设为零向量：\n$$\n\\nabla_{\\theta} J(\\theta^{\\star}) = 2 \\left( \\sum_{t=1}^{T} B_t^{\\top} B_t \\right) \\theta^{\\star} - 2 \\sum_{t=1}^{T} B_t^{\\top} y_t = 0\n$$\n除以2并重新整理，得到**正规方程**：\n$$\n\\left( \\sum_{t=1}^{T} B_t^{\\top} B_t \\right) \\theta^{\\star} = \\sum_{t=1}^{T} B_t^{\\top} y_t\n$$\n题干假设矩阵 $\\sum_{t=1}^{T} B_t^{\\top} B_t$ 是可逆的。因此，我们可以通过用该矩阵的逆矩阵左乘等式两边来求解 $\\theta^{\\star}$：\n$$\n\\theta^{\\star} = \\left( \\sum_{t=1}^{T} B_t^{\\top} B_t \\right)^{-1} \\left( \\sum_{t=1}^{T} B_t^{\\top} y_t \\right)\n$$\n这就是最小化平方和目标函数的参数向量的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\left( \\sum_{t=1}^{T} B_t^{\\top} B_t \\right)^{-1} \\left( \\sum_{t=1}^{T} B_t^{\\top} y_t \\right)}\n$$"
        },
        {
            "introduction": "当一个粗粒化模型被构建出来后，我们必须对其进行验证，以确保其物理真实性。这项练习提供了一个系统性的框架，用于测试一个给定的模型是否遵循了基本的物理定律，例如动量守恒和涨落-耗散定理。这是一个至关重要的步骤，以确保模型的预测是可靠且有物理意义的，而不仅仅是数据的数学拟合 。",
            "id": "3817238",
            "problem": "给定一个已学习的粗粒化模型，旨在近似一个由 $N$ 个相互作用的自由度（珠子）组成的系统的动力学。该模型在粗粒化变量上是线性的，由一个耦合矩阵 $K \\in \\mathbb{R}^{N \\times N}$、一个摩擦矩阵 $\\Gamma \\in \\mathbb{R}^{N \\times N}$、一个离散时间噪声协方差矩阵 $\\Sigma \\in \\mathbb{R}^{N \\times N}$、一个时间步长 $\\Delta t \\in \\mathbb{R}$ 和一个温度 $T \\in \\mathbb{R}$ 指定。所有量都是无量纲的。该模型为\n$$ m_i \\dot{v}_i = \\sum_{j=1}^N K_{ij}(x_j - x_i) - \\sum_{j=1}^N \\Gamma_{ij} v_j + \\xi_i(t), $$\n其中 $x_i$ 和 $v_i$ 表示珠子 $i$ 的粗粒化位置和速度，$m_i$ 是其质量（对所有珠子均设为 $1$），$\\xi(t)$ 是一个零均值高斯噪声，在时间步长 $\\Delta t$ 内的离散时间协方差为 $\\Sigma$。由内部相互作用引起的粗粒化分力为\n$$ F_i(x) = \\sum_{j=1}^N K_{ij}(x_j - x_i). $$\n\n您的任务是测试已学习的粗粒化模型的内部一致性，通过检查已知不变量的保持情况，并将模型与基于物理的约束进行比较以识别违规之处，仅使用基于基本定律的第一性原理进行推理。具体来说，您必须检查以下几点：\n\n1. 已知不变量：内部力对总动量的守恒。在无摩擦、无噪声的极限下（即忽略 $-\\Gamma v$ 和 $\\xi$），总动量守恒要求对于任何构型 $x$，净内力为零：\n$$ \\sum_{i=1}^N F_i(x) = 0 \\quad \\text{for all } x \\in \\mathbb{R}^N. $$\n2. 基于物理的约束（牛顿第三定律）：成对的内力必须大小相等、方向相反：\n$$ K_{ij} = K_{ji} \\quad \\text{for all } i \\neq j. $$\n3. 基于物理的能量一致性：内力必须是保守且稳定的。通过以下方式定义与 $K$ 相关的类拉普拉斯矩阵 $L$\n$$ L_{ii} = \\sum_{j=1}^N K_{ij}, \\quad L_{ij} = -K_{ij} \\quad \\text{for } i \\neq j. $$\n能量一致性要求 $L$ 的对称部分，即 $L_{\\text{sym}} = \\frac{1}{2}(L + L^\\top)$，是半正定的，并具有一个对应于（接近）零特征值的平移模式。这确保了二次势能 $U(x) = \\tfrac{1}{2} x^\\top L_{\\text{sym}} x$ 的存在以及内部相互作用的稳定性。\n4. 基于物理的随机热力学一致性：涨落-耗散定理（FDT）断言，对于线性朗之万动力学，噪声协方差必须满足\n$$ \\Sigma = 2 k_B T \\, \\Gamma \\, \\Delta t, $$\n其中 $k_B$ 是玻尔兹曼常数。在无量纲单位中，取 $k_B = 1$。\n\n实现一个程序，对于每个提供的测试用例，返回一个布尔值列表，指示（1）-（4）中的每个检查是否通过。对等式和半正定性检查使用统一的数值容差 $\\tau = 10^{-8}$。具体来说：\n- 对于总动量守恒，通过检查 $K$ 的行和与列和在容差范围内是否逐元素相等，来验证对于所有 $x$ 都有 $\\sum_i F_i(x) = 0$。\n- 对于牛顿第三定律，在容差范围内验证 $K$ 的对称性。\n- 对于能量一致性，验证 $L_{\\text{sym}}$ 的所有特征值都大于或等于 $-\\tau$，并且至少有一个特征值在 $[-\\tau, \\tau]$ 范围内（平移模式）。\n- 对于FDT一致性，在容差范围内验证 $\\Sigma$ 等于 $2 T \\Gamma \\Delta t$。\n\n所有量都是无量纲的，因此输出中不需要物理单位。\n\n测试套件：\n提供一个程序来评估以下参数集。每个测试用例是一个元组 $(N, K, \\Gamma, \\Sigma, \\Delta t, T)$。\n\n- 案例 1（基线一致，无摩擦）：\n  - $N = 3$\n  - $K = \\begin{bmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{bmatrix}$\n  - $\\Gamma = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$\n  - $\\Sigma = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$\n  - $\\Delta t = 0.1$\n  - $T = 1.0$\n\n- 案例 2（非对称内力模型，无摩擦）：\n  - $N = 3$\n  - $K = \\begin{bmatrix} 0  1  0.5 \\\\ 0.2  0  1 \\\\ 1.5  0.8  0 \\end{bmatrix}$\n  - $\\Gamma = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$\n  - $\\Sigma = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$\n  - $\\Delta t = 0.1$\n  - $T = 1.0$\n\n- 案例 3（与摩擦一致的FDT）：\n  - $N = 3$\n  - $K = \\begin{bmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{bmatrix}$\n  - $\\Gamma = \\operatorname{diag}(0.1, 0.2, 0.3)$\n  - $\\Sigma = 2 T \\Gamma \\Delta t$ 其中 $T = 0.5$, $\\Delta t = 0.01$\n  - $\\Delta t = 0.01$\n  - $T = 0.5$\n\n- 案例 4（与摩擦不一致的FDT）：\n  - $N = 3$\n  - $K = \\begin{bmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{bmatrix}$\n  - $\\Gamma = \\operatorname{diag}(0.05, 0.05, 0.05)$\n  - $\\Sigma = 1.5 \\times 2 T \\Gamma \\Delta t$ 其中 $T = 1.0$, $\\Delta t = 0.02$\n  - $\\Delta t = 0.02$\n  - $T = 1.0$\n\n- 案例 5（边界情况 $N=1$）：\n  - $N = 1$\n  - $K = \\begin{bmatrix} 0 \\end{bmatrix}$\n  - $\\Gamma = \\begin{bmatrix} 0 \\end{bmatrix}$\n  - $\\Sigma = \\begin{bmatrix} 0 \\end{bmatrix}$\n  - $\\Delta t = 0.1$\n  - $T = 0.0$\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身是一个包含四个布尔值的列表，顺序为：[动量守恒, 牛顿第三定律, 能量一致性, FDT一致性]。例如：\n$$ [ [b_1,b_2,b_3,b_4], [b_1,b_2,b_3,b_4], \\dots ] $$",
            "solution": "问题陈述已经过严格验证，被认为是科学上可靠、定义明确且客观的。它提出了一个明确的任务，即根据基本物理原理验证粗粒化模型，并提供了所有必要的参数和标准。因此，我们可以继续进行求解。\n\n任务的核心是为一个由 $N$ 个珠子组成的系统的已学习粗粒化线性动力学模型实现四个不同的检查。这些检查验证了模型与动量守恒、牛顿第三定律、能量稳定性以及热力学一致性等原理的一致性。所有浮点数比较均使用统一的数值容差 $\\tau = 10^{-8}$。\n\n**1. 总动量守恒**\n\n第一个检查验证由耦合矩阵 $K$ 定义的内力是否保持系统总动量守恒。在一个封闭系统中，净内力必须为零，因为作用于一个粒子的任何内力都必须被作用于另一个粒子上的反作用力所平衡。\n\n系统上的总内力是每个珠子上力的总和：\n$$ F_{\\text{total}}(x) = \\sum_{i=1}^N F_i(x) = \\sum_{i=1}^N \\sum_{j=1}^N K_{ij} (x_j - x_i) $$\n为确保对于任意位置构型 $x \\in \\mathbb{R}^N$ 该和为零，展开式中每个 $x_k$ 的系数必须为零。让我们通过分离涉及 $x_j$ 和 $x_i$ 的项来重写这个和：\n$$ F_{\\text{total}}(x) = \\sum_{i=1}^N \\sum_{j=1}^N K_{ij} x_j - \\sum_{i=1}^N \\sum_{j=1}^N K_{ij} x_i $$\n通过交换第一项中的索引 $i$ 和 $j$，我们得到：\n$$ F_{\\text{total}}(x) = \\sum_{j=1}^N \\sum_{i=1}^N K_{ji} x_i - \\sum_{i=1}^N \\sum_{j=1}^N K_{ij} x_i = \\sum_{i=1}^N \\left( \\sum_{j=1}^N K_{ji} - \\sum_{j=1}^N K_{ij} \\right) x_i $$\n为了使该表达式对所有向量 $x$ 都等于零，每个 $x_i$ 的系数必须为零。这就得出了条件：\n$$ \\sum_{j=1}^N K_{ij} = \\sum_{j=1}^N K_{ji} \\quad \\text{for each } i = 1, \\dots, N $$\n这意味着对于每个索引 $i$，$K$ 的第 $i$ 行元素之和必须等于 $K$ 的第 $i$ 列元素之和。这个条件通过计算矩阵 $K$ 的行和与列和，并检查它们在容差 $\\tau$ 内是否逐元素相等来进行计算验证。\n\n**2. 牛顿第三定律（成对力的对称性）**\n\n牛顿第三定律指出，对于每一个作用力，都有一个大小相等、方向相反的反作用力。在珠子 $i$ 和 $j$ 之间的成对相互作用的背景下，$j$ 对 $i$ 施加的力必须是 $i$ 对 $j$ 施加的力的负值。\n\n珠子 $i$ 上的力包含一个项 $K_{ij}(x_j - x_i)$，它依赖于珠子 $j$ 的位置。这个项可以解释为由于与 $j$ 的相互作用而施加在 $i$ 上的力。类似地，珠子 $j$ 上的力包含一个项 $K_{ji}(x_i - x_j)$。为了使这两个力大小相等、方向相反，我们必须有：\n$$ K_{ij}(x_j - x_i) = - K_{ji}(x_i - x_j) = K_{ji}(x_j - x_i) $$\n这个等式必须对任何 $x_i \\neq x_j$ 都成立，这意味着：\n$$ K_{ij} = K_{ji} \\quad \\text{for all } i \\neq j $$\n假设对角元素 $K_{ii}$ 为零（这对于类似弹簧的相互作用是典型的，并且在测试用例中也可以看到），这个条件等价于要求整个矩阵 $K$ 是对称的，即 $K = K^\\top$。这通过检查 $K$ 与其转置 $K^\\top$ 之间所有元素的绝对差是否可以忽略不计来验证。\n\n**3. 能量一致性（稳定性）**\n\n内力应对应于一个物理上稳定的系统，这意味着与这些力相关的势能必须有下界。如果一个力 $F(x)$ 可以写成势能函数 $U(x)$ 的负梯度，即 $F(x) = -\\nabla U(x)$，那么这个力就是保守力。\n\n内力为 $F(x) = -Lx$，其中类拉普拉斯矩阵 $L$ 定义为 $L_{ii} = \\sum_{j=1}^N K_{ij}$ 且当 $i \\neq j$ 时 $L_{ij} = -K_{ij}$。一个力是保守的，当且仅当其雅可比矩阵是对称的。$F(x)=-Lx$ 的雅可比矩阵是 $-L$。因此，该力是保守的，当且仅当 $L$ 是一个对称矩阵。\n\n当 $L$ 不对称时，力是非保守的。然而，我们可以将 $L$ 分解为其对称和反对称部分：$L = L_{\\text{sym}} + L_{\\text{asym}}$，其中 $L_{\\text{sym}} = \\frac{1}{2}(L + L^\\top)$。力的保守部分是 $F_{\\text{cons}}(x) = -L_{\\text{sym}}x$，它可以从势能 $U(x) = \\frac{1}{2} x^\\top L_{\\text{sym}} x$ 推导出来。为了使系统稳定，这个势能必须有下界，这要求矩阵 $L_{\\text{sym}}$ 是半正定的。这意味着它的所有特征值都必须是非负的。\n\n此外，系统的势能应该对所有珠子位置的刚性平移（对所有 $i$，$x_i \\to x_i + c$）保持不变。这对应于向量 $\\mathbf{1} = (1, 1, \\dots, 1)^\\top$ 位于 $L_{\\text{sym}}$ 的零空间中，即 $L_{\\text{sym}}\\mathbf{1} = 0$。这意味着 $L_{\\text{sym}}$ 必须有一个为 $0$ 的特征值。\n\n因此，能量一致性的检查包括两个部分：\n1. 验证 $L_{\\text{sym}}$ 的所有特征值都是非负的（在容差 $\\tau$ 内，即 $\\lambda \\ge -\\tau$）。\n2. 验证至少有一个特征值为零（在容差 $\\tau$ 内，即 $|\\lambda| \\le \\tau$）。\n\n**4. 涨落-耗散定理（FDT）**\n\n涨落-耗散定理（FDT）是非平衡统计力学的基石。它在系统的耗散（由摩擦矩阵 $\\Gamma$ 表示）和热涨落（由噪声协方差 $\\Sigma$ 表示）之间建立了一个基本关系。对于一个处于温度 $T$ 的热平衡系统，撞击粒子的随机力必须平均上精确地平衡通过摩擦损失的能量。\n\n对于使用时间步长为 $\\Delta t$ 的欧拉-丸山格式离散化的线性朗之万系统，这种关系表现为：\n$$ \\Sigma = 2 k_B T \\Gamma_s \\Delta t $$\n其中 $\\Gamma_s = \\frac{1}{2}(\\Gamma + \\Gamma^\\top)$ 是摩擦矩阵的对称部分。然而，问题陈述提供了一个简化形式 $\\Sigma = 2 k_B T \\Gamma \\Delta t$，这隐含地假设了 $\\Gamma$ 是对称的。在我们的无量纲单位中，并设 $k_B = 1$，该条件变为：\n$$ \\Sigma = 2 T \\Gamma \\Delta t $$\n此检查的实现方式是计算右侧的矩阵，并将其与提供的 $\\Sigma$ 矩阵在指定的容差 $\\tau$ 内进行逐元素比较。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates a series of coarse-grained models against four physical consistency checks.\n    \"\"\"\n    tau = 1e-8\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, K, Gamma, Sigma, dt, T)\n    \n    # Case 1: baseline consistent, frictionless\n    K1 = np.array([[0, 1, 1], [1, 0, 1], [1, 1, 0]])\n    Gamma1 = np.zeros((3, 3))\n    Sigma1 = np.zeros((3, 3))\n    \n    # Case 2: non-symmetric internal model, frictionless\n    K2 = np.array([[0, 1, 0.5], [0.2, 0, 1], [1.5, 0.8, 0]])\n    Gamma2 = np.zeros((3, 3))\n    Sigma2 = np.zeros((3, 3))\n\n    # Case 3: consistent FDT with friction\n    K3 = np.array([[0, 1, 1], [1, 0, 1], [1, 1, 0]])\n    Gamma3 = np.diag([0.1, 0.2, 0.3])\n    T3, dt3 = 0.5, 0.01\n    Sigma3 = 2 * T3 * Gamma3 * dt3\n\n    # Case 4: violated FDT with friction\n    K4 = np.array([[0, 1, 1], [1, 0, 1], [1, 1, 0]])\n    Gamma4 = np.diag([0.05, 0.05, 0.05])\n    T4, dt4 = 1.0, 0.02\n    Sigma4 = 1.5 * (2 * T4 * Gamma4 * dt4)\n\n    # Case 5: boundary case N=1\n    K5 = np.array([[0]])\n    Gamma5 = np.array([[0]])\n    Sigma5 = np.array([[0]])\n\n    test_cases = [\n        (3, K1, Gamma1, Sigma1, 0.1, 1.0),\n        (3, K2, Gamma2, Sigma2, 0.1, 1.0),\n        (3, K3, Gamma3, Sigma3, dt3, T3),\n        (3, K4, Gamma4, Sigma4, dt4, T4),\n        (1, K5, Gamma5, Sigma5, 0.1, 0.0)\n    ]\n\n    all_results = []\n    for N, K, Gamma, Sigma, dt, T in test_cases:\n        case_results = []\n\n        # Check 1: Total momentum preservation\n        # sum(row_i of K) == sum(col_i of K) for all i\n        row_sums = K.sum(axis=1)\n        col_sums = K.sum(axis=0)\n        momentum_preserved = np.allclose(row_sums, col_sums, atol=tau, rtol=0)\n        case_results.append(momentum_preserved)\n\n        # Check 2: Newton's Third Law\n        # K is symmetric\n        newton_third_law = np.allclose(K, K.T, atol=tau, rtol=0)\n        case_results.append(newton_third_law)\n\n        # Check 3: Energetic consistency\n        if N > 0:\n            L = -K.copy()\n            np.fill_diagonal(L, K.sum(axis=1))\n            L_sym = 0.5 * (L + L.T)\n            \n            # Use eigvalsh for symmetric matrices\n            eigvals = np.linalg.eigvalsh(L_sym)\n            \n            # All eigenvalues must be >= -tau (positive semidefinite)\n            is_psd = np.all(eigvals >= -tau)\n            # At least one eigenvalue must be near zero for translation mode\n            has_zero_eig = np.any(np.abs(eigvals) = tau)\n            \n            energetic_consistency = is_psd and has_zero_eig\n        else: # N=0 case, vacuously true\n            energetic_consistency = True\n        case_results.append(energetic_consistency)\n\n        # Check 4: FDT consistency\n        # Sigma = 2 * T * Gamma * dt (with k_B = 1)\n        Sigma_fdt = 2 * T * Gamma * dt\n        fdt_consistency = np.allclose(Sigma, Sigma_fdt, atol=tau, rtol=0)\n        case_results.append(fdt_consistency)\n        \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list is, e.g., '[True, False]'\n    # Joining these with a comma produces the desired output format without spaces between list elements.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}