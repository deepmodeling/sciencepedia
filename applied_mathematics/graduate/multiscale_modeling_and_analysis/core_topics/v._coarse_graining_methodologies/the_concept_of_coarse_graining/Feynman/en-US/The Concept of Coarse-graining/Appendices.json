{
    "hands_on_practices": [
        {
            "introduction": "At its core, coarse-graining involves a systematic reduction in the number of degrees of freedom used to describe a system. This first exercise provides a hands-on look at this process in its most fundamental form: the coarse-graining of a probability distribution over a discrete state space. By applying the basic axioms of probability, you will derive the coarse-grained stationary distribution for a simple Markov chain, solidifying the idea that a coarse-grained model is essentially a new probability measure defined on a partitioned state space .",
            "id": "3817292",
            "problem": "A discrete-time finite-state Markov chain with state space $X=\\{1,2,3,4,5,6\\}$ has a known stationary distribution $\\pi$, where $\\pi$ is a probability measure on $X$ satisfying the stationarity condition $\\pi P=\\pi$ for some transition matrix $P$ and the normalization $\\sum_{x\\in X}\\pi(x)=1$. Consider the Coarse-Graining (CG) of this chain induced by the partition $\\mathcal{B}=\\{B_{1},B_{2},B_{3}\\}$ given by $B_{1}=\\{1,4\\}$, $B_{2}=\\{2,3\\}$, and $B_{3}=\\{5,6\\}$. Define the coarse-grained chainâ€™s macro-states as the blocks $B_{i}\\in\\mathcal{B}$, and let the coarse-grained stationary distribution $\\tilde{\\pi}$ be the distribution of blocks induced by $\\pi$.\n\nStarting only from the axioms of probability (in particular, finite additivity on disjoint events) and the definition of a stationary distribution as a probability measure on $X$, derive an expression for $\\tilde{\\pi}(B_{i})$ in terms of $\\pi$. Then, for the specific stationary distribution on micro-states\n$$\n\\pi=\\bigg(\\tfrac{1}{8},\\ \\tfrac{1}{6},\\ \\tfrac{5}{24},\\ \\tfrac{1}{12},\\ \\tfrac{1}{4},\\ \\tfrac{1}{6}\\bigg),\n$$\ncompute the coarse-grained stationary distribution $\\tilde{\\pi}$ over the blocks $B_{1},B_{2},B_{3}$ and verify that it is normalized by explicit calculation. Express your final answer as a single row vector using exact rational numbers, with no rounding and no units.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   **State Space**: A discrete-time finite-state Markov chain on the state space $X=\\{1,2,3,4,5,6\\}$.\n-   **Stationary Distribution**: A probability measure $\\pi$ on $X$ satisfying $\\pi P=\\pi$ for some transition matrix $P$ and the normalization condition $\\sum_{x\\in X}\\pi(x)=1$.\n-   **Coarse-Graining Partition**: $\\mathcal{B}=\\{B_{1},B_{2},B_{3}\\}$ where $B_{1}=\\{1,4\\}$, $B_{2}=\\{2,3\\}$, and $B_{3}=\\{5,6\\}$.\n-   **Macro-states**: The blocks $B_{i}$ of the partition $\\mathcal{B}$.\n-   **Coarse-Grained Distribution**: $\\tilde{\\pi}$, the distribution over the macro-states induced by $\\pi$.\n-   **Specific Stationary Distribution**: The vector of probabilities for the micro-states is given as $\\pi=\\left(\\frac{1}{8}, \\frac{1}{6}, \\frac{5}{24}, \\frac{1}{12}, \\frac{1}{4}, \\frac{1}{6}\\right)$.\n-   **Task**:\n    1.  Derive a general expression for $\\tilde{\\pi}(B_{i})$ in terms of $\\pi$ using the axioms of probability.\n    2.  Compute the specific coarse-grained distribution $\\tilde{\\pi}$ for the given $\\pi$.\n    3.  Verify that the computed $\\tilde{\\pi}$ is normalized.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is based on fundamental concepts of probability theory and the theory of Markov chains, specifically stationary distributions and coarse-graining. These are well-established and core topics in statistical mechanics, mathematics, and multiscale modeling. The problem is scientifically sound.\n-   **Well-Posedness**: The problem is mathematically well-defined. The state space $X$ is partitioned by the sets in $\\mathcal{B}$, as $B_{1} \\cup B_{2} \\cup B_{3} = \\{1,4\\} \\cup \\{2,3\\} \\cup \\{5,6\\} = \\{1,2,3,4,5,6\\} = X$, and the blocks are mutually disjoint ($B_i \\cap B_j = \\emptyset$ for $i \\neq j$). The given micro-state distribution $\\pi$ must be a valid probability distribution; its components must sum to $1$. Let us verify this:\n    $$\n    \\sum_{x \\in X} \\pi(x) = \\frac{1}{8} + \\frac{1}{6} + \\frac{5}{24} + \\frac{1}{12} + \\frac{1}{4} + \\frac{1}{6}\n    $$\n    Using a common denominator of $24$:\n    $$\n    \\frac{3}{24} + \\frac{4}{24} + \\frac{5}{24} + \\frac{2}{24} + \\frac{6}{24} + \\frac{4}{24} = \\frac{3+4+5+2+6+4}{24} = \\frac{24}{24} = 1\n    $$\n    Since the components sum to $1$, the given $\\pi$ is a valid stationary distribution. The problem is self-contained and well-posed.\n-   **Objectivity**: The problem is stated using precise mathematical language and is free from any subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe stationary distribution $\\pi$ is a probability measure on the finite sample space $X$. The probability of the system being in a specific micro-state $x \\in X$ is given by $\\pi(x)$. The \"events\" in this probability space are subsets of $X$.\n\nThe coarse-grained distribution $\\tilde{\\pi}$ on the macro-states $\\{B_1, B_2, B_3\\}$ is defined by the probability that the system's micro-state $x$ lies within a given macro-state $B_i$. Formally, for each $i \\in \\{1, 2, 3\\}$, $\\tilde{\\pi}(B_i)$ is the probability of the event $B_i \\subseteq X$.\n\nThe set $B_i$ is a union of its constituent elementary events, which are the singleton sets $\\{x\\}$ for each $x \\in B_i$. That is, $B_i = \\bigcup_{x \\in B_i} \\{x\\}$. The elementary events $\\{x\\}$ and $\\{x'\\}$ for distinct micro-states $x \\neq x'$ are, by definition, disjoint.\n\nAccording to the axioms of probability, specifically the axiom of finite additivity, the probability of a finite union of mutually disjoint events is the sum of their individual probabilities. Applying this axiom to the event $B_i$:\n$$\n\\tilde{\\pi}(B_i) = P(B_i) = P\\left(\\bigcup_{x \\in B_i} \\{x\\}\\right) = \\sum_{x \\in B_i} P(\\{x\\})\n$$\nThe probability measure on the micro-states is $\\pi$, so $P(\\{x\\}) = \\pi(x)$. Substituting this into the equation yields the desired general expression for the coarse-grained probability:\n$$\n\\tilde{\\pi}(B_i) = \\sum_{x \\in B_i} \\pi(x)\n$$\nThis expression demonstrates that the probability of a macro-state is the sum of the probabilities of all micro-states that constitute it.\n\n### Calculation of the Coarse-Grained Distribution\nWe are given the micro-state stationary distribution $\\pi$:\n-   $\\pi(1) = \\frac{1}{8}$\n-   $\\pi(2) = \\frac{1}{6}$\n-   $\\pi(3) = \\frac{5}{24}$\n-   $\\pi(4) = \\frac{1}{12}$\n-   $\\pi(5) = \\frac{1}{4}$\n-   $\\pi(6) = \\frac{1}{6}$\n\nAnd the partition blocks:\n-   $B_1 = \\{1, 4\\}$\n-   $B_2 = \\{2, 3\\}$\n-   $B_3 = \\{5, 6\\}$\n\nUsing the derived formula, we compute the probability for each macro-state:\n\nFor $B_1$:\n$$\n\\tilde{\\pi}(B_1) = \\pi(1) + \\pi(4) = \\frac{1}{8} + \\frac{1}{12} = \\frac{3}{24} + \\frac{2}{24} = \\frac{5}{24}\n$$\n\nFor $B_2$:\n$$\n\\tilde{\\pi}(B_2) = \\pi(2) + \\pi(3) = \\frac{1}{6} + \\frac{5}{24} = \\frac{4}{24} + \\frac{5}{24} = \\frac{9}{24} = \\frac{3}{8}\n$$\n\nFor $B_3$:\n$$\n\\tilde{\\pi}(B_3) = \\pi(5) + \\pi(6) = \\frac{1}{4} + \\frac{1}{6} = \\frac{6}{24} + \\frac{4}{24} = \\frac{10}{24} = \\frac{5}{12}\n$$\n\nThe coarse-grained stationary distribution is the row vector $\\tilde{\\pi} = (\\tilde{\\pi}(B_1), \\tilde{\\pi}(B_2), \\tilde{\\pi}(B_3)) = \\left(\\frac{5}{24}, \\frac{3}{8}, \\frac{5}{12}\\right)$.\n\n### Verification of Normalization\nTo verify that $\\tilde{\\pi}$ is a valid probability distribution, its components must sum to $1$:\n$$\n\\sum_{i=1}^{3} \\tilde{\\pi}(B_i) = \\tilde{\\pi}(B_1) + \\tilde{\\pi}(B_2) + \\tilde{\\pi}(B_3) = \\frac{5}{24} + \\frac{3}{8} + \\frac{5}{12}\n$$\nConverting to a common denominator of $24$:\n$$\n\\frac{5}{24} + \\frac{9}{24} + \\frac{10}{24} = \\frac{5+9+10}{24} = \\frac{24}{24} = 1\n$$\nThe coarse-grained distribution is indeed normalized.\n\nThe final answer is the row vector of these computed probabilities.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{24} & \\frac{3}{8} & \\frac{5}{12} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving from discrete states to continuous systems, this practice explores how coarse-graining techniques are applied to partial differential equations with rapidly varying coefficients. You will use a two-scale asymptotic expansion, a cornerstone of homogenization theory, to derive the effective 'coarse-grained' coefficient for a material with microscopic heterogeneities. This exercise demonstrates how to rigorously obtain macroscopic laws from an underlying microscopic description, a central goal of multiscale analysis .",
            "id": "3817253",
            "problem": "Consider the second-order linear elliptic partial differential equation (PDE) with rapidly oscillating, periodic coefficients,\n$$\n-\\nabla \\cdot \\big(a(\\tfrac{x}{\\varepsilon}) \\nabla u_{\\varepsilon}(x)\\big) = f(x) \\quad \\text{in } \\Omega \\subset \\mathbb{R}^{d},\n$$\nwith $\\varepsilon > 0$ small, where $a(y)$ is a scalar, $Y$-periodic function on the unit cell $Y = [0,1]^{d}$ that is bounded and uniformly elliptic, i.e., there exist constants $0 < a_{\\min} \\le a(y) \\le a_{\\max} < \\infty$. Assume appropriate boundary conditions ensure well-posedness. The goal is to perform coarse-graining (CG) by periodic homogenization to obtain an effective, homogenized equation with a constant coefficient tensor $a^{*}$ such that $-\\nabla \\cdot (a^{*} \\nabla u_{0}) = f$.\n\nTasks:\n1. Starting from a two-scale asymptotic expansion and conservation of flux, derive the cell problem that defines the corrector fields on the unit cell. Your derivation must start from first principles (operator separation into slow and fast variables and matching orders in $\\varepsilon$), and must clearly state the periodic boundary conditions and a normalization (e.g., zero mean) that fixes the gauge of the correctors. Then, derive the formula for the entries of the homogenized tensor $a^{*}$ in terms of solutions of the cell problems and averages over $Y$.\n2. Specialize to one spatial dimension ($d=1$). Consider a layered medium with piecewise constant coefficient\n$$\na(y) = \\begin{cases}\na_{1}, & y \\in [0,\\alpha),\\\\\na_{2}, & y \\in [\\alpha,1),\n\\end{cases}\n$$\nextended periodically to $\\mathbb{R}$. Compute the scalar effective coefficient $a^{*}$ explicitly in terms of $a_{1}$, $a_{2}$, and $\\alpha$ by solving the one-dimensional cell problem and enforcing periodicity and zero-mean normalization for the corrector.\n\n3. Using your explicit formula, evaluate $a^{*}$ for $a_{1} = 2$, $a_{2} = 10$, and $\\alpha = \\tfrac{3}{10}$. Assume all quantities are dimensionless. Express the final result as an exact rational number.",
            "solution": "The problem is valid as it is a well-posed, scientifically grounded problem from the field of multiscale analysis and homogenization theory.\n\nThe problem is addressed in three parts. First, we derive the general formula for the homogenized tensor $a^*$. Second, we specialize this result to a one-dimensional, layered medium. Third, we compute the numerical value for the specific parameters provided.\n\n**Part 1: Derivation of the Cell Problem and Homogenized Tensor**\n\nWe are given the elliptic partial differential equation with rapidly oscillating coefficients:\n$$\n-\\nabla \\cdot \\big(a(\\tfrac{x}{\\varepsilon}) \\nabla u_{\\varepsilon}(x)\\big) = f(x) \\quad \\text{in } \\Omega \\subset \\mathbb{R}^{d}\n$$\nwhere $y = \\frac{x}{\\varepsilon}$ is the fast variable, and $x$ is the slow variable. The coefficient $a(y)$ is a $Y$-periodic function on the unit cell $Y = [0,1]^d$.\n\nWe seek a solution using a two-scale asymptotic expansion in powers of $\\varepsilon$:\n$$\nu_{\\varepsilon}(x) = u_0(x, y) + \\varepsilon u_1(x, y) + \\varepsilon^2 u_2(x, y) + \\dots\n$$\nwhere each function $u_i(x,y)$ is assumed to be $Y$-periodic with respect to the fast variable $y$.\n\nThe gradient operator $\\nabla$ when applied to a function of both $x$ and $y$ transforms according to the chain rule:\n$$\n\\nabla = \\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y\n$$\nwhere $\\nabla_x$ is the gradient with respect to $x$ and $\\nabla_y$ is the gradient with respect to $y$.\n\nSubstituting the expansion for $u_{\\varepsilon}$ and the transformed gradient operator into the PDE, we get:\n$$\n-\\left(\\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y\\right) \\cdot \\left[ a(y) \\left(\\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y\\right) \\left( u_0(x,y) + \\varepsilon u_1(x,y) + \\dots \\right) \\right] = f(x)\n$$\nWe expand the expression and collect terms of the same order in $\\varepsilon$.\n\n**Order $\\varepsilon^{-2}$:**\n$$\n-\\nabla_y \\cdot (a(y) \\nabla_y u_0(x,y)) = 0\n$$\nThis is an elliptic PDE for $u_0$ in the variable $y$, with periodic boundary conditions on $Y$. Since $a(y) > a_{\\min} > 0$, the only periodic solutions to this equation are functions that are constant with respect to $y$. Therefore, $u_0$ must be a function of the slow variable $x$ only: $u_0(x,y) = u_0(x)$. This implies $\\nabla_y u_0 = 0$.\n\n**Order $\\varepsilon^{-1}$:**\nUsing $\\nabla_y u_0 = 0$, the terms of order $\\varepsilon^{-1}$ are:\n$$\n-\\nabla_y \\cdot (a(y) (\\nabla_x u_0(x) + \\nabla_y u_1(x,y))) - \\nabla_x \\cdot (a(y) \\nabla_y u_0(x)) = 0\n$$\nThe second term vanishes since $\\nabla_y u_0 = 0$. We are left with:\n$$\n-\\nabla_y \\cdot (a(y) \\nabla_y u_1(x,y)) = \\nabla_y \\cdot(a(y) \\nabla_x u_0(x))\n$$\nSince $\\nabla_x u_0(x)$ is independent of $y$, and the equation is linear, we can use separation of variables. We seek a solution for $u_1$ of the form:\n$$\nu_1(x,y) = \\sum_{k=1}^{d} \\chi_k(y) \\frac{\\partial u_0}{\\partial x_k}(x) + \\tilde{u}_1(x)\n$$\nwhere $\\chi_k(y)$ are $Y$-periodic functions called \"correctors\" and $\\tilde{u}_1(x)$ is an integration \"constant\" with respect to $y$. Substituting this ansatz into the $\\varepsilon^{-1}$ equation gives:\n$$\n-\\nabla_y \\cdot \\left( a(y) \\sum_{k=1}^d \\frac{\\partial u_0}{\\partial x_k} \\nabla_y \\chi_k(y) \\right) = \\nabla_y \\cdot \\left( a(y) \\sum_{k=1}^d \\frac{\\partial u_0}{\\partial x_k} e_k \\right)\n$$\nwhere $e_k$ is the $k$-th standard basis vector in $\\mathbb{R}^d$. We can factor out the derivatives $\\frac{\\partial u_0}{\\partial x_k}$:\n$$\n\\sum_{k=1}^d \\frac{\\partial u_0}{\\partial x_k} \\left[ -\\nabla_y \\cdot ( a(y) (\\nabla_y \\chi_k(y) + e_k) ) \\right] = 0\n$$\nSince this must hold for any smooth $u_0(x)$, the derivatives $\\frac{\\partial u_0}{\\partial x_k}$ can be considered arbitrary. Thus, the expression in the square brackets must be zero for each $k = 1, \\dots, d$. This yields the **cell problem**:\nFind $\\chi_k(y)$ for $k=1, \\dots, d$ such that:\n$$\n-\\nabla_y \\cdot ( a(y) (\\nabla_y \\chi_k(y) + e_k) ) = 0 \\quad \\text{in } Y\n$$\nThe corrector $\\chi_k(y)$ must be $Y$-periodic. This problem defines $\\chi_k$ up to an additive constant. To ensure a unique solution, we impose a normalization condition, typically a zero mean over the unit cell:\n$$\n\\int_Y \\chi_k(y) \\, dy = 0\n$$\n\n**Order $\\varepsilon^{0}$ and the Homogenized Equation:**\nThe terms of order $\\varepsilon^0$ are:\n$$\n-\\nabla_y \\cdot (a(y) \\nabla_y u_2) - \\nabla_y \\cdot (a(y) \\nabla_x u_1) - \\nabla_x \\cdot (a(y) (\\nabla_x u_0 + \\nabla_y u_1)) = f(x)\n$$\nTo obtain an equation solely for $u_0(x)$, we average this equation over the unit cell $Y$. We denote the average by $\\langle \\cdot \\rangle = \\int_Y \\cdot \\, dy$ (assuming $|Y|=1$). For any $Y$-periodic function $g(y)$, the divergence theorem implies $\\langle \\nabla_y \\cdot g \\rangle = \\int_Y \\nabla_y \\cdot g \\, dy = \\int_{\\partial Y} g \\cdot n \\, dS = 0$.\nAveraging the $\\varepsilon^0$ equation, the first two terms vanish:\n$$\n-\\langle \\nabla_x \\cdot ( a(y) (\\nabla_x u_0 + \\nabla_y u_1) ) \\rangle = \\langle f(x) \\rangle\n$$\nSince $f(x)$ and $\\nabla_x$ are independent of $y$, we have $\\langle f(x) \\rangle = f(x)$ and we can pull $\\nabla_x$ outside the integral:\n$$\n-\\nabla_x \\cdot \\langle a(y) (\\nabla_x u_0 + \\nabla_y u_1) \\rangle = f(x)\n$$\nWe substitute the form of $u_1$:\n$$\n\\nabla_y u_1 = \\sum_{k=1}^d \\nabla_y \\chi_k(y) \\frac{\\partial u_0}{\\partial x_k}\n$$\nThe averaged flux term becomes:\n$$\n\\langle a(y) (\\nabla_x u_0 + \\nabla_y u_1) \\rangle = \\left\\langle a(y) \\left( \\sum_{k=1}^d e_k \\frac{\\partial u_0}{\\partial x_k} + \\sum_{k=1}^d \\nabla_y \\chi_k \\frac{\\partial u_0}{\\partial x_k} \\right) \\right\\rangle = \\sum_{k=1}^d \\left\\langle a(y) (e_k + \\nabla_y \\chi_k) \\right\\rangle \\frac{\\partial u_0}{\\partial x_k}\n$$\nThis expression is a linear transformation of the gradient $\\nabla_x u_0$. We can write it as $a^* \\nabla_x u_0$, where $a^*$ is the homogenized tensor. The $j$-th component of this vector is $\\sum_{k=1}^d a_{jk}^* \\frac{\\partial u_0}{\\partial x_k}$. By comparing terms, we identify the entries of the homogenized tensor:\n$$\na_{jk}^* = \\langle a(y) (e_k + \\nabla_y \\chi_k)_j \\rangle = \\int_Y a(y) \\left( \\delta_{jk} + \\frac{\\partial \\chi_k}{\\partial y_j} \\right) \\, dy\n$$\nThe resulting homogenized equation is:\n$$\n-\\nabla \\cdot (a^* \\nabla u_0) = f(x)\n$$\nThis completes the first part of the problem.\n\n**Part 2: One-Dimensional Specialization**\n\nWe now consider the one-dimensional case ($d=1$). The unit cell is $Y = [0,1]$. The PDE is $-(a(x/\\varepsilon) u'_\\varepsilon(x))' = f(x)$. The coefficient is:\n$$\na(y) = \\begin{cases}\na_{1}, & y \\in [0,\\alpha),\\\\\na_{2}, & y \\in [\\alpha,1)\n\\end{cases}\n$$\nThere is only one corrector function, $\\chi_1(y)$, which we denote as $\\chi(y)$. The 1D cell problem is:\n$$\n-\\frac{d}{dy} \\left( a(y) \\left( \\frac{d\\chi}{dy} + 1 \\right) \\right) = 0\n$$\nThis implies that the flux term is constant:\n$$\na(y) \\left( \\frac{d\\chi}{dy} + 1 \\right) = C\n$$\nwhere $C$ is a constant. From this, we have:\n$$\n\\frac{d\\chi}{dy} = \\frac{C}{a(y)} - 1\n$$\nFor $\\chi(y)$ to be periodic on $[0,1]$, we must have $\\chi(1) = \\chi(0)$. Integrating $\\frac{d\\chi}{dy}$ over the unit cell must yield zero:\n$$\n\\int_0^1 \\frac{d\\chi}{dy} \\, dy = \\chi(1) - \\chi(0) = 0\n$$\nSo, we integrate the expression for $\\frac{d\\chi}{dy}$:\n$$\n\\int_0^1 \\left( \\frac{C}{a(y)} - 1 \\right) \\, dy = 0 \\implies C \\int_0^1 \\frac{1}{a(y)} \\, dy - 1 = 0\n$$\nThis gives the constant $C$ as:\n$$\nC = \\left( \\int_0^1 \\frac{1}{a(y)} \\, dy \\right)^{-1}\n$$\nThe scalar homogenized coefficient $a^*$ is given by the 1D version of the general formula:\n$$\na^* = \\int_0^1 a(y) \\left( 1 + \\frac{d\\chi}{dy} \\right) \\, dy\n$$\nSince $a(y)(1 + \\frac{d\\chi}{dy}) = C$, the integral becomes:\n$$\na^* = \\int_0^1 C \\, dy = C\n$$\nTherefore, $a^*$ is the harmonic average of $a(y)$ over the cell:\n$$\na^* = \\left( \\int_0^1 \\frac{1}{a(y)} \\, dy \\right)^{-1}\n$$\nNote that this result depends only on the periodicity of $\\chi$, not on the specific zero-mean normalization, which would only be needed to find the explicit form of $\\chi(y)$.\nWe compute the integral for the given piecewise constant $a(y)$:\n$$\n\\int_0^1 \\frac{1}{a(y)} \\, dy = \\int_0^\\alpha \\frac{1}{a_1} \\, dy + \\int_\\alpha^1 \\frac{1}{a_2} \\, dy = \\frac{\\alpha}{a_1} + \\frac{1-\\alpha}{a_2}\n$$\nThus, the explicit formula for the effective coefficient is:\n$$\na^* = \\left( \\frac{\\alpha}{a_1} + \\frac{1-\\alpha}{a_2} \\right)^{-1} = \\frac{a_1 a_2}{\\alpha a_2 + (1-\\alpha)a_1}\n$$\n\n**Part 3: Numerical Evaluation**\n\nWe are given the values $a_1 = 2$, $a_2 = 10$, and $\\alpha = \\frac{3}{10}$. Substituting these into the formula for $a^*$:\n$$\na^* = \\left( \\frac{\\frac{3}{10}}{2} + \\frac{1-\\frac{3}{10}}{10} \\right)^{-1}\n$$\n$$\na^* = \\left( \\frac{3}{20} + \\frac{\\frac{7}{10}}{10} \\right)^{-1} = \\left( \\frac{3}{20} + \\frac{7}{100} \\right)^{-1}\n$$\nTo add the fractions, we find a common denominator, which is $100$:\n$$\na^* = \\left( \\frac{3 \\times 5}{20 \\times 5} + \\frac{7}{100} \\right)^{-1} = \\left( \\frac{15}{100} + \\frac{7}{100} \\right)^{-1}\n$$\n$$\na^* = \\left( \\frac{15+7}{100} \\right)^{-1} = \\left( \\frac{22}{100} \\right)^{-1}\n$$\n$$\na^* = \\frac{100}{22} = \\frac{50}{11}\n$$\nThe value of the effective coefficient is $\\frac{50}{11}$.",
            "answer": "$$\n\\boxed{\\frac{50}{11}}\n$$"
        },
        {
            "introduction": "A coarse-grained model is only useful if it faithfully captures the essential physics of the underlying fine-grained system. This final practice shifts our focus from model construction to model validation, a critical step in the modeling pipeline. You will implement a series of checks to test whether a given linear coarse-grained model is consistent with fundamental physical principles, including conservation of momentum, Newton's third law, and the Fluctuation-Dissipation Theorem, thereby learning how to translate physical laws into computable criteria for model assessment .",
            "id": "3817238",
            "problem": "You are given a learned coarse-grained model intended to approximate the dynamics of a system of $N$ interacting degrees of freedom (beads). The model is linear in the coarse variables and is specified by a coupling matrix $K \\in \\mathbb{R}^{N \\times N}$, a friction matrix $\\Gamma \\in \\mathbb{R}^{N \\times N}$, a discrete-time noise covariance matrix $\\Sigma \\in \\mathbb{R}^{N \\times N}$, a time step $\\Delta t \\in \\mathbb{R}$, and a temperature $T \\in \\mathbb{R}$. All quantities are nondimensional. The model is\n$$ m_i \\dot{v}_i = \\sum_{j=1}^N K_{ij}(x_j - x_i) - \\sum_{j=1}^N \\Gamma_{ij} v_j + \\xi_i(t), $$\nwhere $x_i$ and $v_i$ denote the coarse position and velocity of bead $i$, $m_i$ its mass (set to $1$ for all beads), and $\\xi(t)$ is a zero-mean Gaussian noise with discrete-time covariance $\\Sigma$ over time step $\\Delta t$. The coarse-grained force component due to internal interactions is\n$$ F_i(x) = \\sum_{j=1}^N K_{ij}(x_j - x_i). $$\n\nYour task is to test the internal consistency of the learned coarse-grained model by checking preservation of known invariants and comparing the model against physics-informed constraints to identify violations, using only first-principles reasoning grounded in fundamental laws. Specifically, you must check the following:\n\n1. Known invariant: total momentum preservation by internal forces. In the frictionless, noiseless limit (i.e., ignoring $-\\Gamma v$ and $\\xi$), total momentum conservation requires the net internal force to vanish for any configuration $x$:\n$$ \\sum_{i=1}^N F_i(x) = 0 \\quad \\text{for all } x \\in \\mathbb{R}^N. $$\n2. Physics-informed constraint (Newton's Third Law): pairwise internal forces must be equal and opposite:\n$$ K_{ij} = K_{ji} \\quad \\text{for all } i \\neq j. $$\n3. Physics-informed energetic consistency: the internal force must be conservative and stable. Define the Laplacian-like matrix $L$ associated with $K$ by\n$$ L_{ii} = \\sum_{j=1}^N K_{ij}, \\quad L_{ij} = -K_{ij} \\quad \\text{for } i \\neq j. $$\nEnergetic consistency requires the symmetric part of $L$, given by $L_{\\text{sym}} = \\frac{1}{2}(L + L^\\top)$, to be positive semidefinite, with a translation mode corresponding to a (near) zero eigenvalue. This ensures the existence of a quadratic potential $U(x) = \\tfrac{1}{2} x^\\top L_{\\text{sym}} x$ and stability of internal interactions.\n4. Physics-informed stochastic thermodynamic consistency: the Fluctuation-Dissipation Theorem (FDT) asserts that for linear Langevin dynamics, the noise covariance must satisfy\n$$ \\Sigma = 2 k_B T \\, \\Gamma \\, \\Delta t, $$\nwhere $k_B$ is the Boltzmann constant. In nondimensional units, take $k_B = 1$.\n\nImplement a program that, for each provided test case, returns a list of booleans indicating whether each of the checks (1)-(4) passes, using a uniform numerical tolerance $\\tau = 10^{-8}$ for equality and semidefiniteness checks. Specifically:\n- For total momentum preservation, verify $\\sum_i F_i(x) = 0$ for all $x$ by checking equality of row sums and column sums of $K$ elementwise within tolerance.\n- For Newton's Third Law, verify symmetry of $K$ within tolerance.\n- For energetic consistency, verify that all eigenvalues of $L_{\\text{sym}}$ are greater than or equal to $-\\tau$, and that at least one eigenvalue is in $[-\\tau, \\tau]$ (translation mode).\n- For FDT consistency, verify that $\\Sigma$ equals $2 T \\Gamma \\Delta t$ within tolerance.\n\nAll quantities are nondimensional, so no physical units are required in the output.\n\nTest Suite:\nProvide a program that evaluates the following parameter sets. Each test case is a tuple $(N, K, \\Gamma, \\Sigma, \\Delta t, T)$.\n\n- Case 1 (baseline consistent, frictionless):\n  - $N = 3$\n  - $K = \\begin{bmatrix} 0 & 1 & 1 \\\\ 1 & 0 & 1 \\\\ 1 & 1 & 0 \\end{bmatrix}$\n  - $\\Gamma = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$\n  - $\\Sigma = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$\n  - $\\Delta t = 0.1$\n  - $T = 1.0$\n\n- Case 2 (non-symmetric internal model, frictionless):\n  - $N = 3$\n  - $K = \\begin{bmatrix} 0 & 1 & 0.5 \\\\ 0.2 & 0 & 1 \\\\ 1.5 & 0.8 & 0 \\end{bmatrix}$\n  - $\\Gamma = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$\n  - $\\Sigma = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$\n  - $\\Delta t = 0.1$\n  - $T = 1.0$\n\n- Case 3 (consistent FDT with friction):\n  - $N = 3$\n  - $K = \\begin{bmatrix} 0 & 1 & 1 \\\\ 1 & 0 & 1 \\\\ 1 & 1 & 0 \\end{bmatrix}$\n  - $\\Gamma = \\operatorname{diag}(0.1, 0.2, 0.3)$\n  - $\\Sigma = 2 T \\Gamma \\Delta t$ with $T = 0.5$, $\\Delta t = 0.01$\n  - $\\Delta t = 0.01$\n  - $T = 0.5$\n\n- Case 4 (violated FDT with friction):\n  - $N = 3$\n  - $K = \\begin{bmatrix} 0 & 1 & 1 \\\\ 1 & 0 & 1 \\\\ 1 & 1 & 0 \\end{bmatrix}$\n  - $\\Gamma = \\operatorname{diag}(0.05, 0.05, 0.05)$\n  - $\\Sigma = 1.5 \\times 2 T \\Gamma \\Delta t$ with $T = 1.0$, $\\Delta t = 0.02$\n  - $\\Delta t = 0.02$\n  - $T = 1.0$\n\n- Case 5 (boundary case $N=1$):\n  - $N = 1$\n  - $K = \\begin{bmatrix} 0 \\end{bmatrix}$\n  - $\\Gamma = \\begin{bmatrix} 0 \\end{bmatrix}$\n  - $\\Sigma = \\begin{bmatrix} 0 \\end{bmatrix}$\n  - $\\Delta t = 0.1$\n  - $T = 0.0$\n\nRequired Final Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of four booleans in the order: [momentum_preserved, newton_third_law, energetic_consistency, fdt_consistency]. For example:\n$$ [ [b_1,b_2,b_3,b_4], [b_1,b_2,b_3,b_4], \\dots ] $$",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and objective. It presents a clear task of validating a coarse-grained model against fundamental physical principles, with all necessary parameters and criteria provided. We may therefore proceed with the solution.\n\nThe core of the task is to implement four distinct checks on a learned coarse-grained linear dynamical model for a system of $N$ beads. These checks verify the model's consistency with principles of momentum conservation, Newton's third law, energetic stability, and thermodynamic consistency. A uniform numerical tolerance of $\\tau = 10^{-8}$ is used for all floating-point comparisons.\n\n**1. Total Momentum Preservation**\n\nThe first check verifies that the internal forces, as defined by the coupling matrix $K$, conserve total system momentum. In a closed system, the net internal force must be zero, as any internal force on one particle must be balanced by a reaction force on another.\n\nThe total internal force on the system is the sum of the forces on each bead:\n$$ F_{\\text{total}}(x) = \\sum_{i=1}^N F_i(x) = \\sum_{i=1}^N \\sum_{j=1}^N K_{ij} (x_j - x_i) $$\nTo ensure this sum is zero for any arbitrary configuration of positions $x \\in \\mathbb{R}^N$, the coefficient of each $x_k$ in the expanded sum must be zero. Let's rewrite the sum by separating terms involving $x_j$ and $x_i$:\n$$ F_{\\text{total}}(x) = \\sum_{i=1}^N \\sum_{j=1}^N K_{ij} x_j - \\sum_{i=1}^N \\sum_{j=1}^N K_{ij} x_i $$\nBy swapping the indices $i$ and $j$ in the first term, we get:\n$$ F_{\\text{total}}(x) = \\sum_{j=1}^N \\sum_{i=1}^N K_{ji} x_i - \\sum_{i=1}^N \\sum_{j=1}^N K_{ij} x_i = \\sum_{i=1}^N \\left( \\sum_{j=1}^N K_{ji} - \\sum_{j=1}^N K_{ij} \\right) x_i $$\nFor this expression to equal zero for all vectors $x$, the coefficient of each $x_i$ must be zero. This yields the condition:\n$$ \\sum_{j=1}^N K_{ij} = \\sum_{j=1}^N K_{ji} \\quad \\text{for each } i = 1, \\dots, N $$\nThis means that for each index $i$, the sum of the elements in the $i$-th row of $K$ must equal the sum of the elements in the $i$-th column of $K$. This condition is computationally verified by calculating the row sums and column sums of the matrix $K$ and checking for their element-wise equality within the tolerance $\\tau$.\n\n**2. Newton's Third Law (Pairwise Force Symmetry)**\n\nNewton's third law states that for every action, there is an equal and opposite reaction. In the context of pairwise interactions between beads $i$ and $j$, the force exerted by $j$ on $i$ must be the negative of the force exerted by $i$ on $j$.\n\nThe force on bead $i$ contains a term $K_{ij}(x_j - x_i)$ that depends on the position of bead $j$. This term can be interpreted as the force on $i$ due to its interaction with $j$. Similarly, the force on bead $j$ contains a term $K_{ji}(x_i - x_j)$. For these two forces to be equal and opposite, we must have:\n$$ K_{ij}(x_j - x_i) = - K_{ji}(x_i - x_j) = K_{ji}(x_j - x_i) $$\nThis equality must hold for any $x_i \\neq x_j$, which implies:\n$$ K_{ij} = K_{ji} \\quad \\text{for all } i \\neq j $$\nAssuming that diagonal elements $K_{ii}$ are zero (as is typical for spring-like interactions and as seen in the test cases), this condition is equivalent to requiring the entire matrix $K$ to be symmetric, i.e., $K = K^\\top$. This is verified by checking if the absolute difference between $K$ and its transpose $K^\\top$ is negligible for all elements.\n\n**3. Energetic Consistency (Stability)**\n\nThe internal forces should correspond to a physically stable system, meaning the potential energy associated with these forces must be bounded from below. A force $F(x)$ is conservative if it can be written as the negative gradient of a potential energy function $U(x)$, i.e., $F(x) = -\\nabla U(x)$.\n\nThe internal force is $F(x) = -Lx$, where $L$ is the Laplacian-like matrix defined by $L_{ii} = \\sum_{j=1}^N K_{ij}$ and $L_{ij} = -K_{ij}$ for $i \\neq j$. A force is conservative if and only if its Jacobian matrix is symmetric. The Jacobian of $F(x)=-Lx$ is $-L$. Thus, the force is conservative if and only if $L$ is a symmetric matrix.\n\nWhen $L$ is not symmetric, the force is non-conservative. However, we can decompose $L$ into its symmetric and anti-symmetric parts: $L = L_{\\text{sym}} + L_{\\text{asym}}$, where $L_{\\text{sym}} = \\frac{1}{2}(L + L^\\top)$. The conservative part of the force is $F_{\\text{cons}}(x) = -L_{\\text{sym}}x$, which is derivable from the potential $U(x) = \\frac{1}{2} x^\\top L_{\\text{sym}} x$. For the system to be stable, this potential energy must be bounded below, which requires the matrix $L_{\\text{sym}}$ to be positive semidefinite. This means all its eigenvalues must be non-negative.\n\nFurthermore, the potential energy of the system should be invariant to a rigid translation of all bead positions ($x_i \\to x_i + c$ for all $i$). This corresponds to the vector $\\mathbf{1} = (1, 1, \\dots, 1)^\\top$ being in the null space of $L_{\\text{sym}}$, i.e., $L_{\\text{sym}}\\mathbf{1} = 0$. This implies that $L_{\\text{sym}}$ must have an eigenvalue of $0$.\n\nThe check for energetic consistency thus involves two parts:\n1. Verifying that all eigenvalues of $L_{\\text{sym}}$ are non-negative (within tolerance $\\tau$, i.e., $\\lambda \\ge -\\tau$).\n2. Verifying that at least one eigenvalue is zero (within tolerance $\\tau$, i.e., $|\\lambda| \\le \\tau$).\n\n**4. Fluctuation-Dissipation Theorem (FDT)**\n\nThe Fluctuation-Dissipation Theorem (FDT) is a cornerstone of non-equilibrium statistical mechanics. It establishes a fundamental relationship between the dissipation in a system (represented by the friction matrix $\\Gamma$) and the thermal fluctuations (represented by the noise covariance $\\Sigma$). For a system in thermal equilibrium at temperature $T$, the random forces that buffet the particles must precisely balance the energy lost through friction, on average.\n\nFor a linear Langevin system discretized using an Euler-Maruyama scheme with time step $\\Delta t$, this relationship takes the form:\n$$ \\Sigma = 2 k_B T \\Gamma_s \\Delta t $$\nwhere $\\Gamma_s = \\frac{1}{2}(\\Gamma + \\Gamma^\\top)$ is the symmetric part of the friction matrix. However, the problem statement provides a simplified form $\\Sigma = 2 k_B T \\Gamma \\Delta t$, implicitly assuming $\\Gamma$ is symmetric. In our nondimensional units with $k_B = 1$, the condition becomes:\n$$ \\Sigma = 2 T \\Gamma \\Delta t $$\nThis check is implemented by computing the matrix on the right-hand side and comparing it element-wise to the provided $\\Sigma$ matrix within the specified tolerance $\\tau$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates a series of coarse-grained models against four physical consistency checks.\n    \"\"\"\n    tau = 1e-8\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, K, Gamma, Sigma, dt, T)\n    \n    # Case 1: baseline consistent, frictionless\n    K1 = np.array([[0, 1, 1], [1, 0, 1], [1, 1, 0]])\n    Gamma1 = np.zeros((3, 3))\n    Sigma1 = np.zeros((3, 3))\n    \n    # Case 2: non-symmetric internal model, frictionless\n    K2 = np.array([[0, 1, 0.5], [0.2, 0, 1], [1.5, 0.8, 0]])\n    Gamma2 = np.zeros((3, 3))\n    Sigma2 = np.zeros((3, 3))\n\n    # Case 3: consistent FDT with friction\n    K3 = np.array([[0, 1, 1], [1, 0, 1], [1, 1, 0]])\n    Gamma3 = np.diag([0.1, 0.2, 0.3])\n    T3, dt3 = 0.5, 0.01\n    Sigma3 = 2 * T3 * Gamma3 * dt3\n\n    # Case 4: violated FDT with friction\n    K4 = np.array([[0, 1, 1], [1, 0, 1], [1, 1, 0]])\n    Gamma4 = np.diag([0.05, 0.05, 0.05])\n    T4, dt4 = 1.0, 0.02\n    Sigma4 = 1.5 * (2 * T4 * Gamma4 * dt4)\n\n    # Case 5: boundary case N=1\n    K5 = np.array([[0]])\n    Gamma5 = np.array([[0]])\n    Sigma5 = np.array([[0]])\n\n    test_cases = [\n        (3, K1, Gamma1, Sigma1, 0.1, 1.0),\n        (3, K2, Gamma2, Sigma2, 0.1, 1.0),\n        (3, K3, Gamma3, Sigma3, dt3, T3),\n        (3, K4, Gamma4, Sigma4, dt4, T4),\n        (1, K5, Gamma5, Sigma5, 0.1, 0.0)\n    ]\n\n    all_results = []\n    for N, K, Gamma, Sigma, dt, T in test_cases:\n        case_results = []\n\n        # Check 1: Total momentum preservation\n        # sum(row_i of K) == sum(col_i of K) for all i\n        row_sums = K.sum(axis=1)\n        col_sums = K.sum(axis=0)\n        momentum_preserved = np.allclose(row_sums, col_sums, atol=tau, rtol=0)\n        case_results.append(momentum_preserved)\n\n        # Check 2: Newton's Third Law\n        # K is symmetric\n        newton_third_law = np.allclose(K, K.T, atol=tau, rtol=0)\n        case_results.append(newton_third_law)\n\n        # Check 3: Energetic consistency\n        if N > 0:\n            L = -K.copy()\n            np.fill_diagonal(L, K.sum(axis=1))\n            L_sym = 0.5 * (L + L.T)\n            \n            # Use eigvalsh for symmetric matrices\n            eigvals = np.linalg.eigvalsh(L_sym)\n            \n            # All eigenvalues must be >= -tau (positive semidefinite)\n            is_psd = np.all(eigvals >= -tau)\n            # At least one eigenvalue must be near zero for translation mode\n            has_zero_eig = np.any(np.abs(eigvals) = tau)\n            \n            energetic_consistency = is_psd and has_zero_eig\n        else: # N=0 case, vacuously true\n            energetic_consistency = True\n        case_results.append(energetic_consistency)\n\n        # Check 4: FDT consistency\n        # Sigma = 2 * T * Gamma * dt (with k_B = 1)\n        Sigma_fdt = 2 * T * Gamma * dt\n        fdt_consistency = np.allclose(Sigma, Sigma_fdt, atol=tau, rtol=0)\n        case_results.append(fdt_consistency)\n        \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list is, e.g., '[True, False]'\n    # Joining these with a comma produces the desired output format without spaces between list elements.\n    print(f\"[{','.join(str(r).replace(' ', '') for r in all_results)}]\")\n```"
        }
    ]
}