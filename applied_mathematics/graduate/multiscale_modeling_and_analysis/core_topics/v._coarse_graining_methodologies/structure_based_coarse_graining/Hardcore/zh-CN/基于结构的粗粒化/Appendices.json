{
    "hands_on_practices": [
        {
            "introduction": "这项练习为掌握迭代玻尔兹曼反演（IBI）方法提供了一个基础的切入点。通过从一个无相互作用的初始状态出发，推导第一次迭代后的势函数，你将揭示IBI方法与平均力势（PMF）之间的根本联系——这是统计力学中的一个基石概念 。本次实践旨在巩固IBI作为一种有效的基于结构的粗粒化策略的理论基础。",
            "id": "3810822",
            "problem": "考虑一个处于绝对温度 $T$ 和数密度 $\\rho$ 下的单原子Lennard–Jones流体，其原子模拟提供了一个径向平均的目标径向分布函数 $g_{\\mathrm{target}}(r)$，该函数对所有 $g_{\\mathrm{target}}(r)0$ 的距离 $r$ 均有定义。您的任务是对此流体进行基于结构的粗粒化，构建一个单点、对加和模型。该模型具有各向同性的有效对势 $u(r)$，并能在相同的 $T$ 和 $\\rho$ 条件下再现 $g_{\\mathrm{target}}(r)$。假设粗粒化相互作用具有平移不变性和对加和性，并考虑体积为 $V$、包含 $N$ 个粒子的正则系综。\n\n从零相互作用的初始猜测 $u_{0}(r)=0$ 开始，执行一步迭代玻尔兹曼反演（IBI）来构建更新后的势 $u_{1}(r)$。此过程仅使用基于物理的统计力学定义，并利用当 $u_{0}(r)=0$ 时，试验模拟为理想气体这一事实。推导 $u_{1}(r)$ 关于 $k_{B}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 的闭式表达式。\n\n最终答案需表示为单个解析表达式。不需要进行数值近似或舍入。在答案框内的最终表达式中不要包含物理单位；表达式必须是以 $k_{B}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 表示的符号形式。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：单原子Lennard–Jones流体。\n- **状态变量**：绝对温度 $T$ 和数密度 $\\rho$。\n- **目标函数**：一个径向平均的目标径向分布函数 $g_{\\mathrm{target}}(r)$，对所有 $g_{\\mathrm{target}}(r)0$ 的距离 $r$ 均有定义。\n- **粗粒化模型**：一个单点、对加和模型，具有各向同性的有效对势 $u(r)$。\n- **目标**：粗粒化模型必须在相同的 $T$ 和 $\\rho$ 条件下再现 $g_{\\mathrm{target}}(r)$。\n- **假设**：粗粒化相互作用具有平移不变性和对加和性。\n- **系综**：正则系综（体积 $V$ 中有 $N$ 个粒子）。\n- **方法**：一步迭代玻尔兹曼反演（IBI）。\n- **初始条件**：势的初始猜测为 $u_{0}(r)=0$。\n- **任务**：推导更新后的势 $u_{1}(r)$ 关于 $k_{B}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 的闭式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题陈述进行评估。\n\n- **科学依据**：该问题牢固地植根于统计力学和计算化学的原理。迭代玻尔兹曼反演（IBI）是一种标准且广泛使用的基于结构的粗粒化技术。径向分布函数（$g(r)$）、对势（$u(r)$）、理想气体和正则系综等概念是该领域的基础。\n- **良构性**：该问题是良构的。它提供了清晰的初始条件（$u_{0}(r)=0$）、要应用的特定算法（一步IBI）和一个明确定义的目标（$u_{1}(r)$ 的闭式表达式）。这种结构导向一个唯一且有意义的解。\n- **客观性**：问题陈述使用了精确、客观和标准的科学术语，没有主观或模糊的陈述。\n\n该问题没有表现出任何列出的无效性缺陷。它在科学上是合理的、可形式化的、完整的，并且直接关系到基于结构的粗粒化这一指定主题。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供解答。\n\n目标是找到从初始猜测 $u_{0}(r)=0$ 开始，经过一次迭代玻尔兹曼反演（IBI）方法后的有效对势 $u_{1}(r)$。\n\nIBI方法是一个迭代过程，旨在优化对势 $u(r)$ 以再现一个已知的目标径向分布函数 $g_{\\mathrm{target}}(r)$。该方法的核心是更新规则，它根据第 $i$ 次迭代产生的RDF $g_{i}(r)$ 与目标RDF $g_{\\mathrm{target}}(r)$ 之间的差异来修正势。标准的IBI更新方程是：\n$$u_{i+1}(r) = u_{i}(r) + k_{B} T \\ln\\left( \\frac{g_{i}(r)}{g_{\\mathrm{target}}(r)} \\right)$$\n其中 $u_{i+1}(r)$ 是下一次迭代的优化势，$u_{i}(r)$ 是当前势，$g_{i}(r)$ 是使用 $u_{i}(r)$ 进行模拟得到的RDF，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。此更新是基于将平均力势与对势相关联的近似推导出来的。\n\n我们被要求执行此迭代的第一步，即设置 $i=0$。更新方程变为：\n$$u_{1}(r) = u_{0}(r) + k_{B} T \\ln\\left( \\frac{g_{0}(r)}{g_{\\mathrm{target}}(r)} \\right)$$\n\n问题给出了势的初始猜测：\n$$u_{0}(r) = 0$$\n\n接下来，我们必须确定 $g_{0}(r)$，即由势 $u_{0}(r)=0$ 支配的系统的径向分布函数。一个相互作用势为零的粒子系统，根据定义，是理想气体。在理想气体中，粒子之间不相互作用，因此它们的位置是完全不相关的。\n\n径向分布函数 $g(r)$ 的定义是，$\\rho g(r)$ 给出了在距离一个任意选择的中心粒子 $r$ 处粒子的平均局部数密度，其中 $\\rho$ 是体数密度。对于理想气体，原点处存在一个粒子并不影响在任何其他位置找到另一个粒子的概率。因此，距离中心粒子任意距离 $r$ 处的局部密度就是体密度 $\\rho$。\n$$\\rho g_{0}(r) = \\rho$$\n这意味着对于理想气体，径向分布函数对所有距离 $r$ 都等于1：\n$$g_{0}(r) = 1$$\n\n现在，我们将 $u_{0}(r)$ 和 $g_{0}(r)$ 的表达式代入 $u_{1}(r)$ 的IBI更新方程中：\n$$u_{1}(r) = 0 + k_{B} T \\ln\\left( \\frac{1}{g_{\\mathrm{target}}(r)} \\right)$$\n\n利用对数的性质 $\\ln(1/x) = \\ln(1) - \\ln(x) = -\\ln(x)$，我们简化表达式：\n$$u_{1}(r) = k_{B} T \\left( \\ln(1) - \\ln(g_{\\mathrm{target}}(r)) \\right)$$\n$$u_{1}(r) = k_{B} T \\left( 0 - \\ln(g_{\\mathrm{target}}(r)) \\right)$$\n$$u_{1}(r) = -k_{B} T \\ln(g_{\\mathrm{target}}(r))$$\n\n这个结果是对应于目标RDF的平均力势 $W(r)$，因为 $W(r) = -k_{B}T \\ln(g(r))$。因此，从零势开始的IBI第一步，等效于用目标系统的平均力势来近似有效对势。问题陈述中指明 $g_{\\mathrm{target}}(r)  0$，这确保了对数函数是良定义的，且得到的势 $u_1(r)$ 是有限的。在粒子不能重叠的极小距离处，$g_{\\mathrm{target}}(r) \\to 0$，推导出的势 $u_1(r) \\to \\infty$，这正确地表示了强烈的空间排斥。",
            "answer": "$$\\boxed{-k_{B} T \\ln(g_{\\mathrm{target}}(r))}$$"
        },
        {
            "introduction": "本题将带你从理论走向实践，模拟一个将IBI更新法则应用于离散数值数据的真实场景。通过亲手计算，你将加深对迭代优化过程的理解 。此外，该练习还引入了一个实际操作中的关键挑战：如何处理采样为零的区域，这需要你仔细思考如何确保算法的稳定性和物理合理性。",
            "id": "3843094",
            "problem": "您正在对一种单组分流体进行粗粒化，以重现一个给定的径向分布函数（RDF）。在一个对相互作用的粗粒化模型中，RDF $g(r)$ 与平均力势（PMF）$W(r)$ 通过平衡Boltzmann关系 $g(r) = \\exp\\!\\big(-\\beta W(r)\\big)$ 相关联（$W(r)$ 可相差一个加性常数），其中 $\\beta = 1/(k_B T)$ 是逆热能，$k_B$ 是Boltzmann常数，$T$ 是绝对温度。在通过迭代Boltzmann反演（IBI）进行的基于结构的粗粒化方法中，目标是更新一个试验对势 $V_n(r)$，从而使模拟得到的RDF $g_n(r)$ 与从更高分辨率参考体系获得的目标 $g_{\\text{target}}(r)$ 相匹配。缩写IBI代表迭代Boltzmann反演（Iterative Boltzmann Inversion）。\n\n假设使用约化的Lennard-Jones单位，其中距离以特征长度的倍数度量，能量以特征能量的倍数度量，热能 $k_B T = 2.5$。您在均匀网格的区间中心 $r \\in \\{0.60, 0.70, 0.80, 0.90, 1.00\\}$ 上获得了以下离散化数据：\n- 在这些区间上的当前对势 $V_n(r)$ 为 $\\{10.0, 2.5, -0.3, 0.1, 0.2\\}$。\n- 当前模拟得到的RDF $g_n(r)$ 为 $\\{0.00, 0.40, 1.30, 1.10, 0.80\\}$。\n- 目标RDF $g_{\\text{target}}(r)$ 为 $\\{0.02, 0.50, 1.20, 0.95, 0.85\\}$。\n\n从 $g(r)$ 与PMF $W(r)$ 之间的基本关系出发，并基于一个对相互作用的粗粒化势 $V(r)$ 应追踪PMF以实现目标结构的建模假设，推导一个用 $V_n(r)$、$g_n(r)$、$g_{\\text{target}}(r)$ 和 $k_B T$ 表示的 $V_{n+1}(r)$ 的迭代更新公式。并根据物理学推理，论证每一项的符号和形式的合理性。\n\n然后，使用您推导的更新公式，计算当 $k_B T = 2.5$ 时，在 $r = 0.70$ 处的 $V_{n+1}(r)$ 的数值。将您的最终数值答案四舍五入到四位有效数字。能量以与上文所述相同的约化单位表示。\n\n最后，解释如何处理 $g_n(r) = 0$ 的区间（例如，所提供数据中 $r = 0.60$ 处），以使更新保持适定且在物理上合理。您的解释应基于 $g(r)$ 的统计力学意义。\n\n您的最终答案必须是一个实数值，对应于约化能量单位下的 $V_{n+1}(0.70)$，并按要求四舍五入到四位有效数字。请勿在最终的方框答案中包含任何单位。",
            "solution": "该问题陈述经评估具有科学依据、适定、客观且自洽。所需计算的所有必要数据均已提供。所涉及的概念，如径向分布函数 $g(r)$、平均力势 $W(r)$、Boltzmann反演和迭代方案，在统计力学和分子模拟领域是标准且成熟的。对于用约化单位描述的体系，这些数值在物理上是合理的。因此，该问题是有效的，其解答构建如下。\n\n基于结构的粗粒化的核心是找到一个能够重现目标径向分布函数 $g_{\\text{target}}(r)$ 的有效对势 $V(r)$。RDF $g(r)$ 和平均力势（PMF）$W(r)$ 之间的基本统计力学关系由下式给出：\n$$g(r) = \\exp\\left(-\\frac{W(r)}{k_B T}\\right)$$\n其中 $k_B$ 是Boltzmann常数，$T$ 是绝对温度。因此，通过反演这个关系可以从RDF得到PMF：\n$$W(r) = -k_B T \\ln(g(r))$$\n这个表达式的确定可相差一个任意加性常数，我们可以不失一般性地将其设为零，因为它只移动势能基线。\n\n像迭代Boltzmann反演（IBI）这类方法的基本假设是，有效对势 $V(r)$ 应该近似于PMF，即 $V(r) \\approx W(r)$。其动机源于Henderson唯一性定理，该定理在特定条件下保证，对于给定的 $g(r)$，能产生它的对势 $V(r)$ 是唯一的。然而，PMF $W(r)$ 隐含地包含了多体关联效应，而粗粒化模拟通常是使用纯粹的对势 $V(r)$ 进行的。因此，直接反演 $V(r) = -k_B T \\ln(g_{\\text{target}}(r))$ 通常无法重现 $g_{\\text{target}}(r)$，因为使用此 $V(r)$ 进行模拟所得到的PMF将不等于 $V(r)$。\n\nIBI通过迭代方式解决这个问题。在第 $n$ 次迭代中，我们有一个试验势 $V_n(r)$，它产生一个模拟的RDF $g_n(r)$ 和一个相应的PMF $W_n(r) = -k_B T \\ln(g_n(r))$。目标是获得目标RDF $g_{\\text{target}}(r)$，它对应一个目标PMF $W_{\\text{target}}(r) = -k_B T \\ln(g_{\\text{target}}(r))$。\n\nIBI更新提出了一个对势的修正量 $\\Delta V_n(r)$，该修正量基于当前结构与目标结构之间的不匹配。用于下一次迭代的势的更新 $V_{n+1}(r)$ 构建如下：\n$$V_{n+1}(r) = V_n(r) + \\Delta V_n(r)$$\n选择该修正项是为了补偿PMF之间的差异。其基本原理是，对势 $V(r)$ 与PMF $W(r)$ 之间的差异源于多体贡献，而这些贡献被假设在迭代之间变化缓慢。因此，我们用目标PMF与当前PMF之差来近似所需的势修正：\n$$\\Delta V_n(r) \\approx W_{\\text{target}}(r) - W_n(r)$$\n代入PMF的表达式：\n$$\\Delta V_n(r) = \\left(-k_B T \\ln(g_{\\text{target}}(r))\\right) - \\left(-k_B T \\ln(g_n(r))\\right)$$\n$$\\Delta V_n(r) = k_B T \\left(\\ln(g_n(r)) - \\ln(g_{\\text{target}}(r))\\right)$$\n使用对数的性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$\\Delta V_n(r) = k_B T \\ln\\left(\\frac{g_n(r)}{g_{\\text{target}}(r)}\\right)$$\n因此，势的完整更新规则是：\n$$V_{n+1}(r) = V_n(r) + k_B T \\ln\\left(\\frac{g_n(r)}{g_{\\text{target}}(r)}\\right)$$\n在实践中，为了提高数值稳定性，通常会引入一个阻尼因子 $\\alpha \\in (0, 1]$，$V_{n+1}(r) = V_n(r) + \\alpha k_B T \\ln(g_n(r)/g_{\\text{target}}(r))$，但本题暗示 $\\alpha=1$。\n\n该更新规则的物理学推理如下：\n1.  如果 $g_n(r)  g_{\\text{target}}(r)$，当前的RDF显示在距离 $r$ 处粒子对过度聚集。这意味着势 $V_n(r)$ 太具吸引性（或排斥性不足）。为了修正这一点，必须增加势（使其更具排斥性）。更新项的参数 $\\frac{g_n(r)}{g_{\\text{target}}(r)}  1$，使其对数为正，因此 $\\Delta V_n(r)  0$。这正确地增加了势。\n2.  如果 $g_n(r)  g_{\\text{target}}(r)$，当前的RDF显示在距离 $r$ 处粒子对聚集不足。这意味着 $V_n(r)$ 排斥性太强。必须减小势（使其更具吸引性）。参数 $\\frac{g_n(r)}{g_{\\text{target}}(r)}  1$，使其对数为负，因此 $\\Delta V_n(r)  0$。这正确地减小了势。\n3.  如果 $g_n(r) = g_{\\text{target}}(r)$，结构在此距离处是正确的，不需要更新。对数的参数为 $1$，使其对数为 $0$，因此 $\\Delta V_n(r) = 0$。势保持不变，这是所期望的行为。\n\n接下来，我们计算在 $r = 0.70$ 处 $V_{n+1}(r)$ 的数值。\n给定的数据是：\n- $k_B T = 2.5$\n- 在 $r = 0.70$ 处：\n  - $V_n(0.70) = 2.5$\n  - $g_n(0.70) = 0.40$\n  - $g_{\\text{target}}(0.70) = 0.50$\n\n使用推导出的更新公式：\n$$V_{n+1}(0.70) = V_n(0.70) + k_B T \\ln\\left(\\frac{g_n(0.70)}{g_{\\text{target}}(0.70)}\\right)$$\n代入数值：\n$$V_{n+1}(0.70) = 2.5 + 2.5 \\ln\\left(\\frac{0.40}{0.50}\\right)$$\n$$V_{n+1}(0.70) = 2.5 + 2.5 \\ln(0.8)$$\n$0.8$ 的自然对数约等于 $-0.22314355$。\n$$V_{n+1}(0.70) \\approx 2.5 + 2.5 \\times (-0.22314355)$$\n$$V_{n+1}(0.70) \\approx 2.5 - 0.55785888$$\n$$V_{n+1}(0.70) \\approx 1.94214112$$\n四舍五入到四位有效数字得到 $1.942$。\n\n最后，我们处理在 $r=0.60$ 处观察到的 $g_n(r) = 0$ 的特殊情况。\n$g(r)$ 的统计力学解释是，它与在分离距离 $r$ 处找到一对粒子的概率密度成正比。在有限时长的模拟中，$g_n(r)=0$ 的值意味着在该距离区间内没有观察到粒子对。这通常是由于强排斥势核（即排除体积）或对于高能构象的采样不足。\n如果我们在 $g_n(r) = 0$ 的地方直接应用IBI更新规则：\n$$V_{n+1}(r) = V_n(r) + k_B T \\ln\\left(\\frac{0}{g_{\\text{target}}(r)}\\right)$$\n$\\ln(0)$ 项是未定义的，趋近于 $-\\infty$。这将导致数值灾难性的更新，试图将 $V_{n+1}(r) \\to -\\infty$。这是有限采样的产物；一个零计数事件并不意味着一个不可能事件（零概率），而是一个未被观测到的低概率事件。由此产生的无限大的吸引修正是非物理的。\n\n为了处理这种情况，更新规则必须进行正则化。一个稳健的实现不应在 $g_n(r)=0$ 的区间使用直接公式。一个常见且物理上合理的过程是：\n1.  认识到当 $g_{\\text{target}}(r)  0$（这里，$g_{\\text{target}}(0.60) = 0.02$）时，$g_n(r)=0$ 表明当前的势 $V_n(r)$ 排斥性过强。\n2.  应用启发式修正，而不是使用对数公式。例如，可以对更新设置上限，或用一个合理的、有限的吸引修正来代替。一种这样的方法是从 $g_n(r)$ 非零且行为良好的相邻区域对势进行线性外推。\n3.  另一个简单有效的方法是给势施加一个较大但有限的吸引修正。例如，可以设置 $V_{n+1}(r) = V_n(r) - C$，其中 $C$ 是一个量级为几个 $k_B T$ 的常数。这会降低势垒，使得该区域在下一次模拟迭代中变得可及，从而可以采样到非零的 $g_{n+1}(r)$，之后便可使用标准的IBI更新。其目标是恰到好处地修正势，以便在下一步中填充该区间，从而避免数值奇异点。",
            "answer": "$$\\boxed{1.942}$$"
        },
        {
            "introduction": "这最后一个练习将你的角色从执行单一任务提升到为复杂分子体系设计完整的粗粒化方案。你需要评估并选择一个能够正确整合各项技术的综合工作流程，包括通过玻尔兹曼反演确定键合势、使用IBI优化非键合势，以及进行热力学压力校正 。这项总结性练习旨在检验你将多种技术融合成一个稳健且科学严谨的程序的能力，真实地反映了当前研究所面临的挑战。",
            "id": "3810845",
            "problem": "一个在温度 $T$ 和数密度 $\\rho$ 下的全原子分子模拟，通过一个映射 $M$ 被映射到一个粗粒化（CG）表示，该表示具有键合内坐标 $b$（键长）、$\\theta$（键角）和 $\\phi$（二面角），以及CG珠之间单一的各向同性非键位点-位点相互作用。令 $p^*(b)$、$p^*(\\theta)$、$p^*(\\phi)$ 为从映射轨迹得到的参考分子内分布，令 $g^*(r)$ 和 $P^*$ 为在相同状态点 $(T,\\rho)$ 下映射系统的目标径向分布函数（RDF）和压力。你的任务是设计一个基于结构的粗粒化工作流程，该流程结合了键合玻尔兹曼反演、非键迭代玻尔兹曼反演（IBI）和压力校正，并带有明确的停止准则。该设计必须从基本考虑出发，在数学上是合理的，包括平均力势的定义和对加相互作用的维里压力表达式。假设非键势存在有限的截断半径 $r_c$，并在需要时使用平滑且物理上合理的正则化。\n\n下面哪个选项给出了一个正确的、数学上合理的工作流程，包括与既定目标一致的显式更新公式和停止准则？\n\nA. 键合项和非键项的参数化如下。对于键、角和二面角，初始化\n$$\nU_b(b) \\leftarrow -k_B T \\ln p^*(b) + C_b,\\quad U_\\theta(\\theta) \\leftarrow -k_B T \\ln p^*(\\theta) + C_\\theta,\\quad U_\\phi(\\phi) \\leftarrow -k_B T \\ln p^*(\\phi) + C_\\phi,\n$$\n其中常数 $C_b$、$C_\\theta$、$C_\\phi$ 的选择要保证力不受影响，并确保在列表边界处的连续性。对于非键相互作用，初始化\n$$\nu_0(r) \\leftarrow -k_B T \\ln g^*(r)\\quad \\text{for } r \\le r_c,\n$$\n并进行平移，使得 $u_0(r_c)=0$ 且力是连续的。对 $n=0,1,2,\\dots$ 进行迭代：\n$$\nu_{n+1}(r) \\leftarrow u_n(r) + k_B T \\ln \\frac{g_n(r)}{g^*(r)} + \\delta u_n(r),\\quad r \\le r_c,\n$$\n其中 $g_n(r)$ 是使用当前势的CG模拟得到的RDF，而 $\\delta u_n(r)$ 是一个压力校正斜坡函数\n$$\n\\delta u_n(r) \\leftarrow \\alpha_n\\, w(r),\\quad w(r)=\\begin{cases}1 - r/r_c, 0\\le r \\le r_c,\\\\ 0, rr_c,\\end{cases}\n$$\n其振幅 $\\alpha_n$ 的选择是为了利用对相互作用的维里公式来减小压力误差，\n$$\nP_n = \\rho k_B T - \\frac{2\\pi \\rho^2}{3}\\int_0^{r_c} g_n(r)\\, r^3\\, u_n'(r)\\,dr,\n$$\n以及一个线性响应估计\n$$\n\\Delta P_n \\approx -\\frac{2\\pi \\rho^2}{3}\\,\\alpha_n \\int_0^{r_c} g_n(r)\\, r^3\\, w'(r)\\,dr,\n$$\n使得\n$$\n\\alpha_n \\leftarrow \\frac{P^* - P_n}{-\\frac{2\\pi \\rho^2}{3}\\int_0^{r_c} g_n(r)\\, r^3\\, w'(r)\\,dr}.\n$$\n当以下条件同时满足时停止：\n$$\nE_g \\equiv \\int_0^{r_c} w_g(r)\\, \\big[g_n(r)-g^*(r)\\big]^2 dr \\le \\varepsilon_g,\\quad |P_n - P^*| \\le \\varepsilon_P,\\quad \\|u_{n+1}-u_n\\|_\\infty \\le \\varepsilon_u,\n$$\n其中 $w_g(r)$ 是一个强调第一配位壳层的非负权重，$\\varepsilon_g$、$\\varepsilon_P$、$\\varepsilon_u$ 是预先设定的容差。此外，通过类似下面的散度来验证分子内的一致性\n$$\nD_b \\equiv \\int p_n(b)\\, \\ln\\frac{p_n(b)}{p^*(b)}\\,db \\le \\varepsilon_b\n$$\n（对 $\\theta$ 和 $\\phi$ 也类似）以确保键合分布保持一致。\n\nB. 通过仅匹配其平均值来初始化键合项，$U_b(b)$ 在 $\\langle b\\rangle^*$ 附近是谐波的，$U_\\theta(\\theta)$ 在 $\\langle \\theta\\rangle^*$ 附近是谐波的，$U_\\phi(\\phi)$ 在 $\\langle \\phi\\rangle^*$ 附近是谐波的。对于非键项，设置 $u_0(r)=0$（对于 $r\\le r_c$），然后通过以下方式迭代\n$$\nu_{n+1}(r) \\leftarrow u_n(r) - k_B T \\ln \\frac{g_n(r)}{g^*(r)},\\quad r \\le r_c,\n$$\n并通过向势中添加一个恒定的偏移量 $\\beta_n$ 来校正压力，\n$$\nu_{n+1}(r) \\leftarrow u_{n+1}(r) + \\beta_n,\\quad r \\le r_c,\n$$\n其中 $\\beta_n$ 的选择是为了使 $P_n$ 接近 $P^*$。当 $\\max_r |g_n(r)-g^*(r)| \\le \\varepsilon_g$ 时停止。\n\nC. 通过直接将总的映射多体平均力势 $W(\\mathbf{R})$ 反演为有效对势来初始化键合和非键势\n$$\nu_0(r) \\leftarrow \\frac{1}{N_\\text{pairs}}\\int \\delta(r-|\\mathbf{r}_i-\\mathbf{r}_j|)\\, W(\\mathbf{R})\\, d\\mathbf{R},\n$$\n此后保持 $u_n(r)$ 固定，因为即使在存在多体力的情况下，Henderson 定理也保证了给定 $g^*(r)$ 时 $u(r)$ 的唯一性。为了在不改变 $g(r)$ 的情况下调整压力，对势进行乘法缩放，$u_{n+1}(r)=\\lambda u_n(r)$，其中选择 $\\lambda$ 以匹配 $P^*$。当 $|P_n-P^*|\\le \\varepsilon_P$ 时停止。\n\nD. 仅使用相对熵最小化。将所有键合和非键势初始化为零，并根据从CG分布到映射的全原子分布的Kullback–Leibler散度的梯度进行更新，\n$$\nU \\leftarrow U - \\eta \\,\\nabla_U \\mathcal{S},\\quad \\mathcal{S} \\equiv \\int \\pi_U(\\mathbf{X}) \\ln\\frac{\\pi_U(\\mathbf{X})}{\\pi^*(\\mathbf{X})}\\,d\\mathbf{X},\n$$\n学习率为 $\\eta$。为了匹配压力，向目标函数添加一个惩罚项 $\\mu (P-P^*)^2$，但不修改 $u(r)$ 的更新规则。当目标函数的梯度范数低于 $\\varepsilon$ 时停止。",
            "solution": "用户要求设计一个基于结构的粗粒化工作流程。我将首先验证问题陈述，然后通过分析所提供的选项来详细解答。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **系统状态：** 温度 $T$，数密度 $\\rho$。\n*   **参考系统：** 一个通过映射 $M$ 映射到粗粒化（CG）表示的全原子分子模拟。\n*   **CG模型形式：** 势能函数由键长（$b$）、键角（$\\theta$）和二面角（$\\phi$）的键合项，以及一个单一的各向同性非键位点-位点相互作用势组成。\n*   **目标性质（来自映射的全原子轨迹）：**\n    *   分子内概率分布：$p^*(b)$、$p^*(\\theta)$、$p^*(\\phi)$。\n    *   径向分布函数（RDF）：$g^*(r)$。\n    *   系统压力：$P^*$。\n*   **任务目标：** 设计一个结合以下内容的工作流程：\n    1.  键合玻尔兹曼反演。\n    2.  非键迭代玻尔兹曼反演（IBI）。\n    3.  压力校正。\n*   **约束与论证：**\n    *   该工作流程必须从平均力势（PMF）的定义和维里压力表达式出发，在数学上是合理的。\n    *   假设非键势存在有限截断半径 $r_c$。\n    *   在需要时应使用平滑且物理上合理的正则化。\n*   **输出：** 确定哪个选项提供了正确的、数学上合理的工作流程，包括显式的更新公式和停止准则。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学基础：** 该问题牢固地植根于统计力学和计算化学的原理。玻尔兹曼反演、迭代玻尔兹曼反演（IBI）、平均力势、径向分布函数以及压力的维里定理都是多尺度建模领域中标准且成熟的概念。\n*   **良态问题：** 该问题是良态的。它要求确定一个正确的计算算法，以使用一类指定的方法来实现一组明确定义的目标（匹配目标结构和热力学性质）。在给定的选项中，预期会有一个唯一的答案。\n*   **客观性：** 问题陈述使用了精确的技术语言，没有主观或含糊的术语。\n\n问题陈述在科学上是合理的、良态的、客观的和完整的。它描述了计算材料科学和软物质物理学中一个标准且不简单的任务。没有发现任何缺陷。\n\n**步骤3：结论与行动**\n\n该问题是**有效的**。我将继续推导解决方案并评估每个选项。\n\n### 解决方案推导\n\n目标是构建一个能够再现参考高分辨率系统的结构和热力学性质的粗粒化势 $U_{CG}$。对于指定的模型，假定势的形式为：\n$$\nU_{CG} = \\sum_{\\text{bonds}} U_b(b) + \\sum_{\\text{angles}} U_\\theta(\\theta) + \\sum_{\\text{dihedrals}} U_\\phi(\\phi) + \\sum_{ij} u(r_{ij})\n$$\n工作流程需要合理地确定 $U_b$、$U_\\theta$、$U_\\phi$ 和 $u(r)$。\n\n**选项A分析：**\n1.  **键合势初始化：** $U_b(b) \\leftarrow -k_B T \\ln p^*(b) + C_b$ 等。这是直接玻尔兹曼反演，用于将参考分布 $p^*(b)$ 转换为其对应的PMF。这是确定键合势的标准且正确的方法。\n2.  **非键势初始化：** $u_0(r) \\leftarrow -k_B T \\ln g^*(r)$。这是使用目标RDF的PMF作为非键势的初始猜测，是IBI的标准第一步。\n3.  **迭代更新：** $u_{n+1}(r) \\leftarrow u_n(r) + k_B T \\ln \\frac{g_n(r)}{g^*(r)} + \\delta u_n(r)$。这一步包含两个部分：\n    *   $k_B T \\ln \\frac{g_n(r)}{g^*(r)}$：这是标准的IBI修正，旨在使 $g_n(r)$ 趋向于 $g^*(r)$。\n    *   $\\delta u_n(r)$：这是一个旨在校正压力的附加项。\n4.  **压力校正：** $\\delta u_n(r)$ 被设置为一个线性斜坡函数 $\\alpha_n w(r)$。其振幅 $\\alpha_n$ 是通过求解一个线性响应方程来确定的，该方程旨在将当前压力 $P_n$ 移动到目标压力 $P^*$。维里压力表达式和线性响应估计 $\\Delta P_n$ 都是正确的。将IBI和压力校正结合在一个迭代步骤中是一个先进但有效的方法。\n5.  **停止准则：** 准则同时考虑了RDF的收敛性（$E_g$）、压力的收敛性（$|P_n - P^*|$）和势本身的收敛性（$\\|u_{n+1}-u_n\\|_\\infty$）。此外，还包括了对键合分布的事后验证（$D_b$），以确保非键势的优化没有过度破坏分子内结构。这是一个全面且稳健的停止策略。\n\n**结论：** 选项A描述了一个系统化、数学上合理且在实践中常用的高级粗粒化工作流程。每个步骤都基于正确的统计力学原理。\n\n**选项B分析：**\n1.  **键合势初始化：** 使用谐波势匹配平均值。这是一种更粗糙的近似，不如直接玻尔兹曼反演准确。\n2.  **IBI更新：** $u_{n+1}(r) \\leftarrow u_n(r) - k_B T \\ln \\frac{g_n(r)}{g^*(r)}$。符号错误。应该是 `+`，而不是 `-`。负号会导致发散。\n3.  **压力校正：** $u_{n+1}(r) \\leftarrow u_{n+1}(r) + \\beta_n$。向势中添加一个常数偏移量不会改变力（$u'(r)$），因此根据维里表达式，它不会改变压力。这种校正方法是无效的。\n4.  **停止准则：** 仅检查RDF，忽略了压力和势的收敛。\n\n**结论：** 选项B包含多个根本性错误（IBI更新符号、压力校正方法），使其成为一个不正确的工作流程。\n\n**选项C分析：**\n1.  **初始化：** 试图通过对多体PMF $W(\\mathbf{R})$ 进行平均来获得一个对势 $u_0(r)$。这个过程没有坚实的理论基础，并且忽略了从多体到对势的投影是一个复杂反演问题这一事实。\n2.  **固定势：** 声称Henderson定理保证了唯一性，因此无需迭代。这是对该定理的误用。该定理保证解的唯一性，但它并不提供一个直接构造解的方法，特别是当PMF和对势不相等时。\n3.  **压力校正：** $u_{n+1}(r)=\\lambda u_n(r)$。对势进行乘法缩放会改变力，从而改变压力，但它也会显著改变RDF。因此，这种方法无法在不破坏已匹配结构的情况下独立校正压力。\n\n**结论：** 选项C基于对统计力学原理的误解，其提出的方法在物理上是不合理的。\n\n**选项D分析：**\n1.  **方法：** 该选项描述了相对熵最小化，而不是问题所要求的IBI和玻尔兹曼反演。尽管相对熵最小化是一种有效且相关的技术，但它不是所要求的答案。\n2.  **压力校正：** 作为一个惩罚项添加到目标函数中。这是一种有效的方法，但它属于变分方法框架，而不是IBI框架中常见的迭代校正方案。\n\n**结论：** 选项D描述了一个不同的、尽管是有效的粗粒化范式，因此它没有回答所提出的关于结合IBI和玻尔兹曼反演的问题。\n\n**最终比较：**\n选项A是唯一一个正确、详细且符合问题所有要求的选项。它正确地应用了玻尔兹曼反演、IBI和一种基于维里定理的有效压力校正方案，并提供了全面、稳健的停止准则。因此，它是正确的答案。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}