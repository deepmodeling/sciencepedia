{
    "hands_on_practices": [
        {
            "introduction": "Martini力场中的参数并非随意设定的数值，它们具有明确的物理意义。本练习将运用统计力学中的基石——能量均分定理，来揭示模型中的键合刚度常数$k_{b}$如何直接决定在特定温度下化学键的真实热涨落幅度。通过这项实践，你将能够直观地理解力场参数如何与分子的动态行为相关联，为更复杂的模拟分析奠定物理基础。",
            "id": "3820425",
            "problem": "在用于生物分子的 Martini 粗粒化（CG）力场中，珠子之间的键通过谐振子势进行建模。考虑两个 CG 珠子之间的一个单键，其谐振子键势由 $U_{b}=\\tfrac{1}{2}k_{b}(r-r_{0})^{2}$ 给出，其中 $k_{b}=1250\\ \\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$ 且 $r_{0}=0.47\\ \\mathrm{nm}$。假设该键合对处于温度 $T=300\\ \\mathrm{K}$ 的热浴中，并且键长偏差 $x=r-r_{0}$ 在正则系综中可以被视为一个二次自由度。使用能量均分定理和统计力学的基本原理，确定在温度 $T$ 下的均方根键长涨落 $\\sqrt{\\langle x^{2}\\rangle}$。使用玻尔兹曼常数 $k_{B}=8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。请以纳米（$\\mathrm{nm}$）为单位表示您的最终答案，并将结果四舍五入至四位有效数字。",
            "solution": "该问题陈述被评估为有效。它具有科学依据，问题提法明确，并且为获得唯一解所需的所有数据均已提供。该问题是将经典统计力学中的能量均分定理应用于谐振子势的一个标准实例，这也是 Martini 等分子力场中的一个常用模型。\n\n此问题的核心在于能量均分定理。该定理指出，对于一个在温度 $T$ 下处于热平衡状态的经典系统，哈密顿量中与每个二次项相关的平均能量等于 $\\frac{1}{2}k_{B}T$。\n\n问题定义了两个粗粒化珠子之间键的谐振子势：\n$$U_{b} = \\frac{1}{2}k_{b}(r-r_{0})^{2}$$\n其中 $k_{b}$ 是键力常数，$r_{0}$ 是平衡键长。与平衡键长的偏差由 $x = r - r_{0}$ 给出。将此定义代入势能表达式，我们得到：\n$$U_{b} = \\frac{1}{2}k_{b}x^{2}$$\n这个势能 $U_{b}$ 是坐标 $x$ 的二次函数。问题陈述 $x$ 可以被视为一个二次自由度。因此，我们可以对该自由度应用能量均分定理。\n\n储存在键中的平均势能 $\\langle U_{b} \\rangle$ 必须等于 $\\frac{1}{2}k_{B}T$。\n$$\\langle U_{b} \\rangle = \\left\\langle \\frac{1}{2}k_{b}x^{2} \\right\\rangle = \\frac{1}{2}k_{B}T$$\n问题将玻尔兹曼常数指定为 $k_{B}=8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。这个值及其单位对应于摩尔气体常数 $R$，它通过阿伏伽德罗常数 $N_{A}$ 与原子玻尔兹曼常数 $k_{B,atomic}$ 相关联（$R = N_{A} k_{B,atomic}$）。这与力常数 $k_{b}$ 的单位是一致的，后者也以每摩尔为基础给出（$\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$）。我们将使用所提供的符号 $k_{B}$ 及其值进行计算。\n\n应用能量均分定理，我们得到：\n$$\\frac{1}{2}k_{b}\\langle x^{2} \\rangle = \\frac{1}{2}k_{B}T$$\n两边的因子 $\\frac{1}{2}$ 可以消去，得到：\n$$k_{b}\\langle x^{2} \\rangle = k_{B}T$$\n我们需要求解的是均方根键长涨落，即 $\\sqrt{\\langle x^{2} \\rangle}$。我们可以通过解上述方程来求得 $\\langle x^{2} \\rangle$：\n$$\\langle x^{2} \\rangle = \\frac{k_{B}T}{k_{b}}$$\n对两边取平方根，即可得到所求的量：\n$$\\sqrt{\\langle x^{2} \\rangle} = \\sqrt{\\frac{k_{B}T}{k_{b}}}$$\n现在，我们代入给定的数值：\n$k_{B} = 8.314462618 \\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$\n$T = 300\\ \\mathrm{K}$\n$k_{b} = 1250\\ \\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$\n\n$$\\sqrt{\\langle x^{2} \\rangle} = \\sqrt{\\frac{(8.314462618 \\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}) \\times (300\\ \\mathrm{K})}{1250\\ \\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}}}$$\n首先，我们计算分子中的乘积：\n$$k_{B}T = (8.314462618 \\times 10^{-3}) \\times 300\\ \\mathrm{kJ\\,mol^{-1}} = 2.4943387854\\ \\mathrm{kJ\\,mol^{-1}}$$\n接下来，我们进行除法运算：\n$$\\langle x^{2} \\rangle = \\frac{2.4943387854\\ \\mathrm{kJ\\,mol^{-1}}}{1250\\ \\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}} = 0.001995471\\ \\mathrm{nm}^{2}$$\n最后，我们取平方根以求得均方根涨落：\n$$\\sqrt{\\langle x^{2} \\rangle} = \\sqrt{0.001995471}\\ \\mathrm{nm} \\approx 0.0446706956\\ \\mathrm{nm}$$\n问题要求答案四舍五入至四位有效数字。前四位有效数字是 $4$、$4$、$6$ 和 $7$。第五位有效数字是 $0$，所以我们不进行进位。\n$$\\sqrt{\\langle x^{2} \\rangle} \\approx 0.04467\\ \\mathrm{nm}$$",
            "answer": "$$\\boxed{0.04467}$$"
        },
        {
            "introduction": "Martini模型的强大之处在于其系统性的粗粒化策略，它将复杂的化学官能团映射为有限的几种粒子类型。本练习将让你亲手实践这一核心映射哲学。通过分析氨基酸侧链的物理化学性质——例如极性、疏水性以及在特定$\\mathrm{pH}$值下的电荷状态——你将学会如何将精细的化学结构准确地转换为其对应的Martini表示。这是构建任何生物分子粗粒化模型的关键第一步。",
            "id": "3820465",
            "problem": "在用于生物分子模拟的Martini粗粒化范式中，化学基团被映射到不同的珠子类型，这些珠子类型的非键相互作用被选择用来重现热力学可观测量，例如溶剂化吉布斯自由能以及在极性和非极性环境之间的分配。Martini中的珠子类别有非极性（$C$）、极性（$P$）和带电（$Q$），其中$Q$又细分为阳离子型（$Qd$）和阴离子型（$Qa$）。特定的珠子索引（例如，$C1$，$P1$）反映了非极性或极性的定性强度。在给定的酸度/碱度下，电离状态由酸碱平衡决定。对于单质子酸或碱，Henderson–Hasselbalch关系式将$\\mathrm{pH}$、$\\mathrm{p}K_a$和质子化分数联系起来：\n$$\nf_{\\mathrm{prot}} = \\frac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}} \\, .\n$$\n考虑在$\\mathrm{pH} = 7$时的三种氨基酸侧链：leucine（脂肪烃侧链）、serine（带有一个羟基的脂肪侧链）和lysine（以伯胺结尾的脂肪侧链，其侧链铵的$\\mathrm{p}K_a \\approx 10.5$）。使用物理化学第一性原理——氢键能力、水合或水到烷烃转移自由能的定性符号以及酸碱平衡——为每种氨基酸选择一致的Martini $2.2$侧链珠子类型映射和电荷分配。假设：\n- 具有不利水合作用（正的水溶剂化自由能）的脂肪烃基团被映射到非极性$C$珠子，且不带电荷（$q = 0$）。\n- 与水有显著氢键作用（负的水溶剂化自由能）的含羟基基团，如果在$\\mathrm{pH} = 7$时未电离，则被映射到极性$P$珠子，且不带电荷（$q = 0$）。\n- 在$\\mathrm{pH} = 7$时质子化的伯铵基团被映射到阳离子型$Qd$珠子，并带有电荷$q = +1$。\n\n哪个选项最恰当地将leucine、serine和lysine的侧链映射到Martini侧链珠子类型，并分配了在$\\mathrm{pH} = 7$时的电荷？\n\nA. Leucine $\\rightarrow C1$ (中性, $q = 0$); Serine $\\rightarrow P1$ (中性, $q = 0$); Lysine $\\rightarrow Qd$ (带电, $q = +1$).\n\nB. Leucine $\\rightarrow P3$ (中性, $q = 0$); Serine $\\rightarrow Qa$ (带电, $q = -1$); Lysine $\\rightarrow C1$ (中性, $q = 0$).\n\nC. Leucine $\\rightarrow C1$ (中性, $q = 0$); Serine $\\rightarrow P1$ (中性, $q = 0$); Lysine $\\rightarrow Qa$ (带电, $q = -1$).\n\nD. Leucine $\\rightarrow C1$ (中性, $q = 0$); Serine $\\rightarrow P1$ (中性, $q = 0$); Lysine $\\rightarrow P5$ (中性, $q = 0$).\n\nE. Leucine $\\rightarrow C5$ (中性, $q = 0$); Serine $\\rightarrow P1$ (中性, $q = 0$); Lysine $\\rightarrow Qd$ (带电, $q = +1$).",
            "solution": "问题陈述经评估在科学上是合理的、自洽的且表述清晰。所引用的原理——Martini力场的一般理念、指定氨基酸的物理化学性质以及Henderson–Hasselbalch关系式——都是标准的且陈述正确。所提供的假设清晰且足以得出一个唯一的解。\n\n任务是根据所提供的原理，确定在$\\mathrm{pH}$为$7$时，leucine、serine和lysine侧链最合适的Martini珠子类型和电荷分配。\n\n1.  **Leucine侧链分析**\n    -   **物理化学性质**：Leucine的侧链是一个异丁基，即$–CH_2CH(CH_3)_2$。这是一个纯粹的脂肪烃链。因此，它是非极性和疏水的，导致不利的（正的）水合吉布斯自由能。它没有可电离的基团。\n    -   **Martini映射**：根据问题的第一个假设，“具有不利水合作用的脂肪烃基团……被映射到非极性$C$珠子，且不带电荷（$q = 0$）”。因此，leucine侧链应由一个电荷为$q=0$的$C$型珠子表示。在最初的Martini参数化中，标准的非极性珠子$C1$被定义为“类似丁烷”。由于leucine的异丁基是丁基的异构体（两者都是$C_4H_9$），将其映射到$C1$珠子是一个非常合适的选择。\n\n2.  **Serine侧链分析**\n    -   **物理化学性质**：Serine的侧链是$–CH_2OH$。它包含一个末端羟基。该基团是极性的，能够与水既形成氢键（作为供体）也接受氢键（作为受体），从而导致有利的（负的）水合吉布斯自由能。羟基是一个非常弱的酸，其$\\mathrm{p}K_a$值通常在$13$到$16$的范围内。在$\\mathrm{pH} = 7$时，它将绝大多数处于其中性的、质子化的形式。\n    -   **Martini映射**：根据问题的第二个假设，“与水有显著氢键作用的含羟基基团……如果在$\\mathrm{pH} = 7$时未电离，则被映射到极性$P$珠子，且不带电荷（$q = 0$）”。由于serine侧链在$\\mathrm{pH} = 7$时是中性的，它应该由一个电荷为$q=0$的$P$型珠子表示。$P1$珠子类型通常用于表示像serine中的那种小的、中等极性的基团，因此这是一个合适的选择。\n\n3.  **Lysine侧链分析**\n    -   **物理化学性质**：Lysine的侧链是$–(CH_2)_4NH_2$。它由一个以伯胺结尾的四碳脂肪链组成。这个胺基是碱性的。它的共轭酸，即铵基$–(CH_2)_4NH_3^+$，其$\\mathrm{p}K_a \\approx 10.5$。我们必须确定它在$\\mathrm{pH} = 7$时的质子化状态。\n    -   **酸碱平衡**：使用提供的关于质子化分数$f_{\\mathrm{prot}}$的Henderson–Hasselbalch关系式：\n        $$\n        f_{\\mathrm{prot}} = \\frac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}}\n        $$\n        代入给定值$\\mathrm{pH} = 7$和$\\mathrm{p}K_a = 10.5$：\n        $$\n        f_{\\mathrm{prot}} = \\frac{1}{1 + 10^{7 - 10.5}} = \\frac{1}{1 + 10^{-3.5}}\n        $$\n        由于$10^{-3.5} \\approx 3.16 \\times 10^{-4}$，分母约等于$1.000316$。\n        $$\n        f_{\\mathrm{prot}} \\approx \\frac{1}{1.000316} \\approx 0.9997\n        $$\n        这个值非常接近$1$，表明在$\\mathrm{pH} = 7$时，超过$99.9\\%$的lysine侧链处于质子化的、带电的（$NH_3^+$）形式。因此，侧链的电荷为$q = +1$。\n    -   **Martini映射**：根据问题的第三个假设，“在$\\mathrm{pH} = 7$时质子化的伯铵基团被映射到阳离子型$Qd$珠子，并带有电荷$q = +1$”。因此，lysine侧链的功能特性最好由一个电荷为$q=+1$的$Qd$珠子来表示。\n\n**推导的映射总结：**\n-   Leucine: $C1$珠子, $q = 0$。\n-   Serine: $P1$珠子, $q = 0$。\n-   Lysine: $Qd$珠子, $q = +1$。\n\n现在，我们评估每个选项。\n\n**A. Leucine $\\rightarrow C1$ (中性, $q = 0$); Serine $\\rightarrow P1$ (中性, $q = 0$); Lysine $\\rightarrow Qd$ (带电, $q = +1$).**\n-   该选项与我们为所有三种氨基酸侧链推导出的映射完全匹配。\n-   **结论：正确。**\n\n**B. Leucine $\\rightarrow P3$ (中性, $q = 0$); Serine $\\rightarrow Qa$ (带电, $q = -1$); Lysine $\\rightarrow C1$ (中性, $q = 0$).**\n-   Leucine的映射不正确；其非极性侧链应为$C$类型，而不是极性$P$类型。\n-   Serine的映射不正确；其侧链在$\\mathrm{pH} = 7$时是中性的，而不是阴离子型（$Qa$, $q=-1$）。\n-   Lysine的映射不正确；其侧链在$\\mathrm{pH} = 7$时是阳离子型（$+1$），而不是中性和非极性。\n-   **结论：不正确。**\n\n**C. Leucine $\\rightarrow C1$ (中性, $q = 0$); Serine $\\rightarrow P1$ (中性, $q = 0$); Lysine $\\rightarrow Qa$ (带电, $q = -1$).**\n-   Leucine和serine的映射是正确的。\n-   Lysine的映射不正确。Lysine的侧链是碱性的，质子化后成为阳离子（$q=+1$）。$Qa$代表阴离子（$q=-1$），这对于像aspartate或glutamate这样的酸性残基是合适的。\n-   **结论：不正确。**\n\n**D. Leucine $\\rightarrow C1$ (中性, $q = 0$); Serine $\\rightarrow P1$ (中性, $q = 0$); Lysine $\\rightarrow P5$ (中性, $q = 0$).**\n-   Leucine和serine的映射是正确的。\n-   Lysine的映射不正确。根据计算，该侧链在$\\mathrm{pH} = 7$时带电（$q=+1$），应该是一个$Qd$珠子，而不是一个中性的极性$P5$珠子。\n-   **结论：不正确。**\n\n**E. Leucine $\\rightarrow C5$ (中性, $q = 0$); Serine $\\rightarrow P1$ (中性, $q = 0$); Lysine $\\rightarrow Qd$ (带电, $q = +1$).**\n-   Serine和lysine的映射是正确的。Leucine的珠子类别（$C$）和电荷（$q=0$）也是正确的。然而，可以评估珠子索引的选择（$C1$ vs. $C5$）是否合适。如前所述，$C1$珠子类型被定义为“类似丁烷”。Leucine的侧链是异丁基，是丁基的异构体。因此，从根本上说，$C1$是比$C5$更合适的选择，因为$C5$代表一个更强非极性的基团（例如，戊烷在十二烷中的分配）。虽然选项A和E都正确地确定了珠子类别和电荷，但根据Martini力场的基本定义，选项A为leucine珠子使用了更合适的索引。\n-   **结论：不正确。**\n\n基于此分析，选项A提供了最合适和最一致的映射。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然标准的Martini参数在多数情况下表现优异，但针对特定体系或性质，我们往往需要对其进行微调和优化。本练习将引导你完成一个顶层（top-down）参数化的高级实践，即利用实验数据（油水分配自由能）通过加权最小二乘法回归来优化关键的Lennard-Jones参数$\\epsilon$。这项练习揭示了粗粒化模型如何通过定量方法与真实世界的热力学性质相匹配，是力场开发中的一项核心技能。",
            "id": "3820490",
            "problem": "要求您实现一个与用于生物分子和多尺度建模的粗粒化Martini力场相一致的单参数自上而下精化流程。其目标是通过调整单个Lennard–Jones势阱深度尺度参数，来匹配一个同系列烷烃的实验辛醇-水转移自由能。请从以下有效基础开始。\n\n基本原理：\n- 油水分配自由能与分配系数的关系为 $ \\Delta G_{\\mathrm{ow}} = -k_{\\mathrm{B}} T \\ln K_{\\mathrm{ow}} $，其中 $ k_{\\mathrm{B}} $ 是玻尔兹曼常数，$ T $ 是绝对温度。\n- 在一个粗粒化模型中，Lennard–Jones (LJ) 能量尺度由单个参数 $ \\epsilon $ 控制，势能的LJ部分的哈密顿量可以写为 $ U_{\\mathrm{LJ}}(\\epsilon) = \\epsilon \\,\\Phi(\\mathbf{r}) $，其中 $ \\Phi(\\mathbf{r}) $ 编码了LJ相互作用的形状和接触模式。在线性响应理论和小参数变化的条件下，转移自由能近似为 $ \\epsilon $ 的一个仿射函数：$ \\Delta G_i(\\epsilon) \\approx a_i \\epsilon + b_i $，其中 $ a_i $ 是一个灵敏度系数，反映了化合物 $ i $ 的自由能对 $ \\epsilon $ 变化的响应，$ b_i $ 是一个在参考参数下捕获基线的偏移量。\n\n任务：\n- 对于一个给定的同系列，其油水转移自由能实验值为 $ y_i = \\Delta G_{\\mathrm{ow},i}^{\\mathrm{exp}} $ (单位 $\\mathrm{kJ/mol}$)，请精化单个参数 $ \\epsilon $，使得模型预测值 $ a_i \\epsilon + b_i $ 在回归意义上全局匹配 $ y_i $。使用加权最小二乘法，并可选择性地加入岭回归正则化，同时对参数强制施加物理上合理的边界 $ [\\epsilon_{\\min}, \\epsilon_{\\max}] $。\n\n数学规范：\n- 给定实验目标值 $ y_i $ (单位 $\\mathrm{kJ/mol}$)，灵敏度系数 $ a_i $ (无量纲)，偏移量 $ b_i $ (单位 $\\mathrm{kJ/mol}$)，非负权重 $ w_i $ (无量纲)，可选的非负正则化强度 $ \\lambda $ (无量纲)，以及一个先验值 $ \\epsilon_0 $ (单位 $\\mathrm{kJ/mol}$)，通过对 $ \\epsilon $ 的加权二次目标函数求最小化并进行边界投影，确定精化后的 $ \\epsilon^\\star $ 为其唯一最小化子：\n1. 在 $ \\epsilon \\in \\mathbb{R} $ 上最小化目标函数 $ J(\\epsilon) = \\sum_{i=1}^N w_i \\left( a_i \\epsilon + b_i - y_i \\right)^2 + \\lambda \\left( \\epsilon - \\epsilon_0 \\right)^2 $。\n2. 将最小化子投影到区间 $ [\\epsilon_{\\min}, \\epsilon_{\\max}] $ 上，以获得最终的精化参数 $ \\epsilon^\\star_{\\mathrm{bounded}} = \\min\\{\\epsilon_{\\max}, \\max\\{\\epsilon_{\\min}, \\epsilon^\\star\\}\\} $。\n- 报告每个 $ \\epsilon^\\star_{\\mathrm{bounded}} $ 的值，单位为 $\\mathrm{kJ/mol}$。\n\n测试套件：\n提供以下三个测试用例。对于所有用例，最终输出必须以 $\\mathrm{kJ/mol}$ 为单位，并四舍五入到六位小数。\n\n用例1 (一般同系列，非正则化)：\n- 化合物：戊烷 ($\\mathrm{C5}$)、己烷 ($\\mathrm{C6}$)、庚烷 ($\\mathrm{C7}$)、辛烷 ($\\mathrm{C8}$)、壬烷 ($\\mathrm{C9}$)。\n- 实验值 $ y_i $ (单位 $\\mathrm{kJ/mol}$): $ [-15.988,\\,-20.556,\\,-23.982,\\,-28.550,\\,-31.976] $。\n- 灵敏度 $ a_i $: $ [-4.0,\\,-5.0,\\,-5.5,\\,-6.2,\\,-6.8] $。\n- 偏移量 $ b_i $ (单位 $\\mathrm{kJ/mol}$): $ [0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0] $。\n- 权重 $ w_i $: $ [1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0] $。\n- 正则化 $ \\lambda = 0.0 $，先验值 $ \\epsilon_0 = 5.0\\,\\mathrm{kJ/mol} $ (当 $ \\lambda = 0 $ 时未使用)。\n- 边界 $ [\\epsilon_{\\min}, \\epsilon_{\\max}] = [3.0,\\,7.0]\\,\\mathrm{kJ/mol} $。\n\n用例2 (近简并斜率，为稳定性采用强正则化)：\n- 化合物：丙烷 ($\\mathrm{C3}$)、丁烷 ($\\mathrm{C4}$)、戊烷 ($\\mathrm{C5}$)。\n- 实验值 $ y_i $ (单位 $\\mathrm{kJ/mol}$): $ [-13.133,\\,-14.846,\\,-15.988] $。\n- 灵敏度 $ a_i $: $ [-0.10,\\,-0.12,\\,-0.14] $。\n- 偏移量 $ b_i $ (单位 $\\mathrm{kJ/mol}$): $ [0.0,\\,0.0,\\,0.0] $。\n- 权重 $ w_i $: $ [1.0,\\,1.0,\\,1.0] $。\n- 正则化 $ \\lambda = 10.0 $，先验值 $ \\epsilon_0 = 5.0\\,\\mathrm{kJ/mol} $。\n- 边界 $ [\\epsilon_{\\min}, \\epsilon_{\\max}] = [3.0,\\,7.0]\\,\\mathrm{kJ/mol} $。\n\n用例3 (异常值测量被降权，非正则化)：\n- 化合物：戊烷 ($\\mathrm{C5}$)、己烷 ($\\mathrm{C6}$)、庚烷 ($\\mathrm{C7}$)、辛烷 ($\\mathrm{C8}$, 异常值)、壬烷 ($\\mathrm{C9}$)。\n- 实验值 $ y_i $ (单位 $\\mathrm{kJ/mol}$): $ [-15.988,\\,-20.556,\\,-23.982,\\,-45.000,\\,-31.976] $。\n- 灵敏度 $ a_i $: $ [-4.0,\\,-5.0,\\,-5.5,\\,-6.2,\\,-6.8] $。\n- 偏移量 $ b_i $ (单位 $\\mathrm{kJ/mol}$): $ [0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0] $。\n- 权重 $ w_i $: $ [1.0,\\,1.0,\\,1.0,\\,0.1,\\,1.0] $。\n- 正则化 $ \\lambda = 0.0 $，先验值 $ \\epsilon_0 = 5.0\\,\\mathrm{kJ/mol} $。\n- 边界 $ [\\epsilon_{\\min}, \\epsilon_{\\max}] = [3.5,\\,6.0]\\,\\mathrm{kJ/mol} $。\n\n程序要求：\n- 您的程序必须使用上述规范计算每个用例的 $ \\epsilon^\\star_{\\mathrm{bounded}} $，其中 $ \\Delta G $ 和 $ \\epsilon $ 的单位为 $\\mathrm{kJ/mol}$。\n- 最终输出格式：生成单行输出，其中包含三个精化后的值，以逗号分隔的列表形式并用方括号括起来，四舍五入到六位小数，例如 $ [\\epsilon_1,\\epsilon_2,\\epsilon_3] $。\n\n无需用户输入；所有数据均按上述规定固定，且必须嵌入程序中。",
            "solution": "这个问题是有效的，因为它在科学上基于统计力学和计算化学的原理，作为一个凸优化问题是适定的，并且所有必要的参数都以一致的单位给出。\n\n任务是找到最优的Lennard-Jones势阱深度参数 $ \\epsilon $，以最小化一个加权的、正则化的最小二乘目标函数，然后将结果投影到一个指定的区间上。目标函数 $ J(\\epsilon) $ 由下式给出：\n$$ J(\\epsilon) = \\sum_{i=1}^N w_i \\left( a_i \\epsilon + b_i - y_i \\right)^2 + \\lambda \\left( \\epsilon - \\epsilon_0 \\right)^2 $$\n此处，$ y_i $ 是实验目标值，$ a_i \\epsilon + b_i $ 是模型预测值，$ w_i $ 是每个数据点的权重，而项 $ \\lambda \\left( \\epsilon - \\epsilon_0 \\right)^2 $ 代表 Tikhonov (岭) 正则化，它以强度 $ \\lambda $ 使解偏向先验值 $ \\epsilon_0 $。\n\n为了找到使 $ J(\\epsilon) $ 最小化的 $ \\epsilon $ 值，我们必须通过对 $ J(\\epsilon) $ 关于 $ \\epsilon $ 求导并令其为零来找到临界点。\n$$ \\frac{dJ}{d\\epsilon} = 0 $$\n对和的每一项使用求导的链式法则：\n$$ \\frac{d}{d\\epsilon} \\left[ \\sum_{i=1}^N w_i \\left( a_i \\epsilon + b_i - y_i \\right)^2 + \\lambda \\left( \\epsilon - \\epsilon_0 \\right)^2 \\right] = 0 $$\n$$ \\sum_{i=1}^N w_i \\cdot 2 \\left( a_i \\epsilon + b_i - y_i \\right) \\cdot \\frac{d}{d\\epsilon}(a_i \\epsilon + b_i - y_i) + \\lambda \\cdot 2 \\left( \\epsilon - \\epsilon_0 \\right) \\cdot \\frac{d}{d\\epsilon}(\\epsilon - \\epsilon_0) = 0 $$\n$$ \\sum_{i=1}^N 2 w_i \\left( a_i \\epsilon + b_i - y_i \\right) a_i + 2 \\lambda \\left( \\epsilon - \\epsilon_0 \\right) = 0 $$\n我们可以将整个方程除以 $ 2 $：\n$$ \\sum_{i=1}^N w_i a_i \\left( a_i \\epsilon + b_i - y_i \\right) + \\lambda \\left( \\epsilon - \\epsilon_0 \\right) = 0 $$\n现在，我们展开各项并重新整理方程以求解 $ \\epsilon $：\n$$ \\sum_{i=1}^N \\left( w_i a_i^2 \\epsilon + w_i a_i b_i - w_i a_i y_i \\right) + \\lambda \\epsilon - \\lambda \\epsilon_0 = 0 $$\n将所有包含 $ \\epsilon $ 的项分组到方程的一边：\n$$ \\left( \\sum_{i=1}^N w_i a_i^2 \\right) \\epsilon + \\lambda \\epsilon = \\sum_{i=1}^N \\left( w_i a_i y_i - w_i a_i b_i \\right) + \\lambda \\epsilon_0 $$\n提出因子 $ \\epsilon $：\n$$ \\epsilon \\left( \\sum_{i=1}^N w_i a_i^2 + \\lambda \\right) = \\sum_{i=1}^N w_i a_i (y_i - b_i) + \\lambda \\epsilon_0 $$\n$ J(\\epsilon) $ 中 $ \\epsilon^2 $ 项的系数是 $ \\sum w_i a_i^2 + \\lambda $。由于在所有测试用例中 $ w_i \\geq 0 $、$ \\lambda \\geq 0 $ 且至少有一个 $ w_i a_i^2 > 0 $，因此该系数严格为正，确保了 $ J(\\epsilon) $ 是一个具有唯一全局最小值的凸抛物线。\n\n通过分离 $ \\epsilon $，可以找到无约束最小化子，我们将其记为 $ \\epsilon^\\star $：\n$$ \\epsilon^\\star = \\frac{\\sum_{i=1}^N w_i a_i (y_i - b_i) + \\lambda \\epsilon_0}{\\sum_{i=1}^N w_i a_i^2 + \\lambda} $$\n该表达式给出了在没有边界约束的情况下最优参数的解析解。\n\n最后一步是施加物理边界 $ [\\epsilon_{\\min}, \\epsilon_{\\max}] $。这通过将 $ \\epsilon^\\star $ 投影到这个闭区间上来完成。因此，最终的精化参数 $ \\epsilon^\\star_{\\mathrm{bounded}} $ 由下式给出：\n$$ \\epsilon^\\star_{\\mathrm{bounded}} = \\min\\{\\epsilon_{\\max}, \\max\\{\\epsilon_{\\min}, \\epsilon^\\star\\}\\} $$\n这个操作确保了所得参数保持在物理上有意義的范围内。程序实现将为所提供的三个测试用例计算此值。",
            "answer": "```python\nimport numpy as np\n\ndef refine_epsilon(y, a, b, w, lam, eps0, eps_min, eps_max):\n    \"\"\"\n    Calculates the refined parameter epsilon based on weighted least squares\n    with ridge regularization and bound projection.\n\n    Args:\n        y (np.ndarray): Experimental targets in kJ/mol.\n        a (np.ndarray): Sensitivity coefficients (dimensionless).\n        b (np.ndarray): Offsets in kJ/mol.\n        w (np.ndarray): Nonnegative weights (dimensionless).\n        lam (float): Nonnegative regularization strength (dimensionless).\n        eps0 (float): Prior epsilon value in kJ/mol.\n        eps_min (float): Lower bound for epsilon in kJ/mol.\n        eps_max (float): Upper bound for epsilon in kJ/mol.\n\n    Returns:\n        float: The refined and bounded epsilon parameter.\n    \"\"\"\n    # Numerator of the expression for the unconstrained minimizer epsilon_star\n    # sum(w_i * a_i * (y_i - b_i)) + lambda * epsilon_0\n    numerator = np.sum(w * a * (y - b)) + lam * eps0\n\n    # Denominator of the expression for the unconstrained minimizer epsilon_star\n    # sum(w_i * a_i^2) + lambda\n    denominator = np.sum(w * a**2) + lam\n    \n    # The objective function is a convex quadratic, so the denominator will be > 0\n    # unless all a_i are zero and lambda is zero, which is not the case here.\n    if denominator == 0:\n        # This case is not expected based on the problem description but is a safe check.\n        # If the denominator is zero, the problem is ill-defined.\n        # We can return the prior or the midpoint of the bounds as a fallback.\n        eps_star = eps0\n    else:\n        eps_star = numerator / denominator\n\n    # Project the minimizer onto the interval [eps_min, eps_max]\n    eps_bounded = np.clip(eps_star, eps_min, eps_max)\n    \n    return eps_bounded\n\ndef solve():\n    \"\"\"\n    Solves the problem for the three specified test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: General homologous series, unregularized\n        {\n            \"y\": np.array([-15.988, -20.556, -23.982, -28.550, -31.976]),\n            \"a\": np.array([-4.0, -5.0, -5.5, -6.2, -6.8]),\n            \"b\": np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"w\": np.array([1.0, 1.0, 1.0, 1.0, 1.0]),\n            \"lam\": 0.0,\n            \"eps0\": 5.0,\n            \"eps_min\": 3.0,\n            \"eps_max\": 7.0\n        },\n        # Case 2: Near-degenerate slopes, strong regularization\n        {\n            \"y\": np.array([-13.133, -14.846, -15.988]),\n            \"a\": np.array([-0.10, -0.12, -0.14]),\n            \"b\": np.array([0.0, 0.0, 0.0]),\n            \"w\": np.array([1.0, 1.0, 1.0]),\n            \"lam\": 10.0,\n            \"eps0\": 5.0,\n            \"eps_min\": 3.0,\n            \"eps_max\": 7.0\n        },\n        # Case 3: Outlier measurement down-weighted, unregularized\n        {\n            \"y\": np.array([-15.988, -20.556, -23.982, -45.000, -31.976]),\n            \"a\": np.array([-4.0, -5.0, -5.5, -6.2, -6.8]),\n            \"b\": np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"w\": np.array([1.0, 1.0, 1.0, 0.1, 1.0]),\n            \"lam\": 0.0,\n            \"eps0\": 5.0,\n            \"eps_min\": 3.5,\n            \"eps_max\": 6.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = refine_epsilon(\n            case[\"y\"], case[\"a\"], case[\"b\"], case[\"w\"],\n            case[\"lam\"], case[\"eps0\"], case[\"eps_min\"], case[\"eps_max\"]\n        )\n        results.append(result)\n\n    # Format the results to six decimal places and print in the required format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}