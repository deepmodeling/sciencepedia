{
    "hands_on_practices": [
        {
            "introduction": "在深入探讨“持续”同调之前，我们必须首先掌握如何为静态对象计算“同调”。本练习将引导您运用链群和边界算子的基本定义，为两个基本形状计算贝蒂数 (Betti numbers)——一种用于计算连通分支和“洞”的拓扑不变量。这项基本技能对于揭示代数拓扑学如何量化形状的奥秘至关重要。",
            "id": "3794559",
            "problem": "考虑在多尺度建模中使用代数拓扑进行结构识别的任务。在拓扑数据分析（TDA）中使用的一个主要不变量是贝蒂数序列，它衡量了同调群的秩。在二元有限域 $\\mathbb{F}_{2}$ 上进行计算，因此加法是模 $2$ 的，并且所有定向都是无关紧要的。\n\n令 $\\mathcal{K}^{(1)}$ 表示由一个二维三角形的边界（一个 $2$-单纯形的 $1$-骨架）组成的单纯复形：它有顶点 $v_{0}, v_{1}, v_{2}$ 和边 $e_{01}, e_{12}, e_{20}$，但没有 $2$-单纯形。令 $\\mathcal{K}^{(2)}$ 表示与填充三角形对应的单纯复形：它具有与 $\\mathcal{K}^{(1)}$ 相同的顶点和边，以及一个单独的 $2$-单纯形 $s_{012}$。\n\n使用在 $\\mathbb{F}_{2}$ 上的单纯同调的基本定义，构建链群 $C_{k}(\\mathcal{K}; \\mathbb{F}_{2})$ 和边界算子 $\\partial_{k}: C_{k}(\\mathcal{K}; \\mathbb{F}_{2}) \\to C_{k-1}(\\mathcal{K}; \\mathbb{F}_{2})$。回想一下，第 $k$ 个贝蒂数定义为 $\\beta_{k}(\\mathcal{K}) = \\dim H_{k}(\\mathcal{K}; \\mathbb{F}_{2}) = \\dim \\ker \\partial_{k} - \\dim \\operatorname{im} \\partial_{k+1}$。\n\n通过在 $\\mathbb{F}_{2}$ 上进行显式的链计算，包括构建边界矩阵及其秩，计算 $\\mathcal{K}^{(1)}$ 和 $\\mathcal{K}^{(2)}$ 的贝蒂数 $\\beta_{0}, \\beta_{1}, \\beta_{2}$。将您的最终答案表示为一个包含六个条目的单行矩阵，顺序为 $(\\beta_{0}(\\mathcal{K}^{(1)}), \\beta_{1}(\\mathcal{K}^{(1)}), \\beta_{2}(\\mathcal{K}^{(1)}), \\beta_{0}(\\mathcal{K}^{(2)}), \\beta_{1}(\\mathcal{K}^{(2)}), \\beta_{2}(\\mathcal{K}^{(2)}))$。无需四舍五入。",
            "solution": "用户提供的问题已经过验证，并被确定为初等代数拓扑中一个适定且具有科学依据的问题。任务是计算两个指定的单纯复形在域 $\\mathbb{F}_2$ 上的贝蒂数。\n\n贝蒂数 $\\beta_k$ 是第 $k$ 个同调群 $H_k(\\mathcal{K}; \\mathbb{F}_2) = \\ker \\partial_k / \\operatorname{im} \\partial_{k+1}$ 的维数。维数由公式 $\\beta_k(\\mathcal{K}) = \\dim(\\ker \\partial_k) - \\dim(\\operatorname{im} \\partial_{k+1})$ 给出。我们对每个复形分别进行计算。所有计算都在域 $\\mathbb{F}_2$ 上进行。\n\n**第一部分：单纯复形 $\\mathcal{K}^{(1)}$（三角形边界）的分析**\n\n单纯复形 $\\mathcal{K}^{(1)}$ 由三个 $0$-单纯形（顶点）$\\{v_0, v_1, v_2\\}$ 和三个 $1$-单纯形（边）$\\{e_{01}, e_{12}, e_{20}\\}$ 组成。没有 $2$-单纯形。\n\n链群是 $\\mathbb{F}_2$ 上的向量空间：\n- $C_0(\\mathcal{K}^{(1)})$：$0$-链空间，基为 $\\{v_0, v_1, v_2\\}$。因此，$\\dim C_0 = 3$。\n- $C_1(\\mathcal{K}^{(1)})$：$1$-链空间，基为 $\\{e_{01}, e_{12}, e_{20}\\}$。因此，$\\dim C_1 = 3$。\n- $C_2(\\mathcal{K}^{(1)})$：$2$-链空间。由于没有 $2$-单纯形，$C_2(\\mathcal{K}^{(1)}) = \\{0\\}$ 且 $\\dim C_2 = 0$。\n- 对于 $k > 2$，$C_k(\\mathcal{K}^{(1)}) = \\{0\\}$。\n\n链复形为 $... \\to C_3 \\xrightarrow{\\partial_3} C_2 \\xrightarrow{\\partial_2} C_1 \\xrightarrow{\\partial_1} C_0 \\xrightarrow{\\partial_0} \\{0\\}$。对于 $\\mathcal{K}^{(1)}$，它变为 $... \\to \\{0\\} \\xrightarrow{\\partial_3} \\{0\\} \\xrightarrow{\\partial_2} C_1 \\xrightarrow{\\partial_1} C_0 \\xrightarrow{\\partial_0} \\{0\\}$。\n\n我们现在分析边界算子 $\\partial_k$ 及其矩阵。\n\n1.  **边界算子 $\\partial_2: C_2 \\to C_1$**：\n    由于 $C_2(\\mathcal{K}^{(1)}) = \\{0\\}$，$\\partial_2$ 是零映射。\n    - $\\ker \\partial_2 = C_2 = \\{0\\}$，所以 $\\dim(\\ker \\partial_2) = 0$。\n    - $\\operatorname{im} \\partial_2 = \\{0\\}$，所以 $\\dim(\\operatorname{im} \\partial_2) = 0$。\n\n2.  **边界算子 $\\partial_1: C_1 \\to C_0$**：\n    一个 $1$-单纯形（边）的边界是其端点顶点的和。在 $\\mathbb{F}_2$ 上计算，$\\partial_1(e_{ij}) = v_i + v_j$。\n    - $\\partial_1(e_{01}) = v_0 + v_1$\n    - $\\partial_1(e_{12}) = v_1 + v_2$\n    - $\\partial_1(e_{20}) = v_2 + v_0$\n    $\\partial_1$ 的矩阵表示，记为 $[\\partial_1]$，关于 $C_1$ 的基 $\\{e_{01}, e_{12}, e_{20}\\}$ 和 $C_0$ 的基 $\\{v_0, v_1, v_2\\}$ 为：\n    $$ [\\partial_1] = \\begin{pmatrix} 1  0  1 \\\\ 1  1  0 \\\\ 0  1  1 \\end{pmatrix} $$\n    为了求此矩阵在 $\\mathbb{F}_2$ 上的秩，我们进行列运算。前两列的和是 $(1, 0, 1)^T$，即第三列。因此，这些列是线性相关的。前两列是线性无关的。因此，秩为 $2$。\n    - $\\dim(\\operatorname{im} \\partial_1) = \\operatorname{rank}([\\partial_1]) = 2$。\n    - 根据秩-零度定理，$\\dim(\\ker \\partial_1) = \\dim(C_1) - \\dim(\\operatorname{im} \\partial_1) = 3 - 2 = 1$。核由闭链 $z = e_{01} + e_{12} + e_{20}$ 生成。\n\n3.  **边界算子 $\\partial_0: C_0 \\to C_{-1}$**：\n    边界算子 $\\partial_0$ 将所有 $0$-链映射到 $0$。上域 $C_{-1}$ 是平凡的，即 $\\{0\\}$。\n    - $\\ker \\partial_0 = C_0$，所以 $\\dim(\\ker \\partial_0) = 3$。\n\n现在我们计算 $\\mathcal{K}^{(1)}$ 的贝蒂数：\n- $\\beta_2(\\mathcal{K}^{(1)}) = \\dim(\\ker \\partial_2) - \\dim(\\operatorname{im} \\partial_3)$。由于 $C_3=\\{0\\}$，$\\partial_3$ 是零映射且 $\\dim(\\operatorname{im} \\partial_3) = 0$。\n  $\\beta_2(\\mathcal{K}^{(1)}) = 0 - 0 = 0$。\n- $\\beta_1(\\mathcal{K}^{(1)}) = \\dim(\\ker \\partial_1) - \\dim(\\operatorname{im} \\partial_2) = 1 - 0 = 1$。\n- $\\beta_0(\\mathcal{K}^{(1)}) = \\dim(\\ker \\partial_0) - \\dim(\\operatorname{im} \\partial_1) = 3 - 2 = 1$。\n\n$\\mathcal{K}^{(1)}$ 的贝蒂数为 $(\\beta_0, \\beta_1, \\beta_2) = (1, 1, 0)$。\n\n**第二部分：单纯复形 $\\mathcal{K}^{(2)}$（填充三角形）的分析**\n\n单纯复形 $\\mathcal{K}^{(2)}$ 具有与 $\\mathcal{K}^{(1)}$ 相同的顶点和边，外加一个单独的 $2$-单纯形 $s_{012}$。\n\n链群为：\n- $C_0(\\mathcal{K}^{(2)})$：与 $\\mathcal{K}^{(1)}$ 相同，$\\dim C_0 = 3$。\n- $C_1(\\mathcal{K}^{(2)})$：与 $\\mathcal{K}^{(1)}$ 相同，$\\dim C_1 = 3$。\n- $C_2(\\mathcal{K}^{(2)})$：$2$-链空间，基为 $\\{s_{012}\\}$。因此，$\\dim C_2 = 1$。\n- 对于 $k > 2$，$C_k(\\mathcal{K}^{(2)}) = \\{0\\}$。\n\n链复形为 $... \\to \\{0\\} \\xrightarrow{\\partial_3} C_2 \\xrightarrow{\\partial_2} C_1 \\xrightarrow{\\partial_1} C_0 \\xrightarrow{\\partial_0} \\{0\\}$。\n\n1.  **算子 $\\partial_1$ 和 $\\partial_0$**：\n    这些算子仅依赖于 $0$-和 $1$-单纯形，它们与 $\\mathcal{K}^{(1)}$ 中的相同。因此，计算保持不变。\n    - $\\dim(\\ker \\partial_1) = 1$。\n    - $\\dim(\\operatorname{im} \\partial_1) = 2$。\n    - $\\dim(\\ker \\partial_0) = 3$。\n\n2.  **边界算子 $\\partial_2: C_2 \\to C_1$**：\n    $2$-单纯形 $s_{012}$ 的边界是其三个边界 $1$-单纯形的和。在 $\\mathbb{F}_2$ 中：\n    $\\partial_2(s_{012}) = e_{01} + e_{12} + e_{20}$。\n    空间 $C_2$是一维的。单个基元素 $s_{012}$ 的像是 $\\partial_2(s_{012}) = e_{01} + e_{12} + e_{20}$，这是 $C_1$ 中的一个非零元素。\n    $\\partial_2$ 的矩阵表示，记为 $[\\partial_2]$，关于 $C_2$ 的基 $\\{s_{012}\\}$ 和 $C_1$ 的基 $\\{e_{01}, e_{12}, e_{20}\\}$ 是一个单列：\n    $$ [\\partial_2] = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} $$\n    - 由于 $\\partial_2(s_{012}) \\neq 0$，该映射是单射的。因此，$\\ker \\partial_2 = \\{0\\}$，且 $\\dim(\\ker \\partial_2) = 0$。\n    - 像 $\\operatorname{im} \\partial_2$ 是由向量 $e_{01} + e_{12} + e_{20}$ 生成的 $C_1$ 的子空间。\n    - $\\dim(\\operatorname{im} \\partial_2) = \\operatorname{rank}([\\partial_2]) = 1$。\n\n现在我们计算 $\\mathcal{K}^{(2)}$ 的贝蒂数：\n- $\\beta_2(\\mathcal{K}^{(2)}) = \\dim(\\ker \\partial_2) - \\dim(\\operatorname{im} \\partial_3)$。由于 $C_3=\\{0\\}$，$\\dim(\\operatorname{im} \\partial_3) = 0$。\n  $\\beta_2(\\mathcal{K}^{(2)}) = 0 - 0 = 0$。\n- $\\beta_1(\\mathcal{K}^{(2)}) = \\dim(\\ker \\partial_1) - \\dim(\\operatorname{im} \\partial_2)$。我们已经求得 $\\dim(\\ker \\partial_1) = 1$ 且 $\\dim(\\operatorname{im} \\partial_2) = 1$。\n  $\\beta_1(\\mathcal{K}^{(2)}) = 1 - 1 = 0$。\n- $\\beta_0(\\mathcal{K}^{(2)}) = \\dim(\\ker \\partial_0) - \\dim(\\operatorname{im} \\partial_1)$。我们已经求得 $\\dim(\\ker \\partial_0) = 3$ 且 $\\dim(\\operatorname{im} \\partial_1) = 2$。\n  $\\beta_0(\\mathcal{K}^{(2)}) = 3 - 2 = 1$。\n\n$\\mathcal{K}^{(2)}$ 的贝蒂数为 $(\\beta_0, \\beta_1, \\beta_2) = (1, 0, 0)$。\n\n**结论**\n\n所求的贝蒂数序列为 $(\\beta_{0}(\\mathcal{K}^{(1)}), \\beta_{1}(\\mathcal{K}^{(1)}), \\beta_{2}(\\mathcal{K}^{(1)}), \\beta_{0}(\\mathcal{K}^{(2)}), \\beta_{1}(\\mathcal{K}^{(2)}), \\beta_{2}(\\mathcal{K}^{(2)}))$。\n代入计算出的值，我们得到 $(1, 1, 0, 1, 0, 0)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  0  1  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "持续同调的关键优势之一是它能够与经典数据分析方法建立联系，并为其提供新的视角。本练习将通过探索零维持续同调 ($H_0$) 与单链接层次聚类 (Single-Linkage Hierarchical Clustering) 之间的深刻联系，来搭建拓扑学与机器学习之间的桥梁。通过编程实现这两种方法，您将通过计算验证它们实际上是同一概念的两个方面，从而具体地理解 $H_0$ 如何在不同尺度上追踪簇的合并过程。",
            "id": "3794580",
            "problem": "考虑一个有限集 $X = \\{x_1, x_2, \\dots, x_n\\}$，其配备一个对称距离矩阵 $D \\in \\mathbb{R}^{n \\times n}$，其中 $D_{ij} = d(x_i, x_j)$，$D_{ii} = 0$，且 $D_{ij} = D_{ji} \\ge 0$。对于一个固定的尺度参数 $\\epsilon \\in \\mathbb{R}_{\\ge 0}$，在尺度 $\\epsilon$ 下的 Vietoris–Rips 复形 (VR)，记为 $\\mathrm{VR}_\\epsilon(X)$，是一个抽象单纯复形，其顶点是 $X$ 中的元素，其单纯形是所有满足 $\\sigma$ 中任意两点之间的距离最大为 $\\epsilon$ 的有限子集 $\\sigma \\subseteq X$，即 $\\max_{x_i, x_j \\in \\sigma} D_{ij} \\le \\epsilon$。零阶同调群 $H_0(\\mathrm{VR}_\\epsilon(X))$ 在代数拓扑中由单纯复形上的链、闭链和边缘定义，它代数地捕捉了路径连通分支。\n\n单链接聚类 (Single-Linkage Clustering, SLC) 是一种在有限度量空间上进行的层次聚类方法，它迭代地合并两个簇间距离最小（两个簇中点之间两两距离的最小值）的簇。在阈值 $\\epsilon$ 处切割单链接树状图会得到一个 $X$ 的簇划分。\n\n持续同调 (Persistent homology, PH) 研究同调特征在不同尺度 $\\epsilon$ 下的演化。在零维情况下，这跟踪了随着 $\\epsilon$ 增加，连通分支的合并过程。在多尺度建模和分析中，验证在固定尺度下拓扑表征和基于聚类的表征之间的等价性，对于可靠的结构识别至关重要。\n\n任务：从上述核心定义出发，推导并实现一个算法，用于在给定有限集 $X$ 的距离矩阵 $D$ 的情况下，计算 $H_0(\\mathrm{VR}_\\epsilon(X))$ 的秩，并独立地计算单链接聚类在阈值 $\\epsilon$ 处切割树状图时产生的簇的数量。比较每个测试用例的两个输出。\n\n您的程序必须：\n- 不接受任何输入，并使用下述固定的测试套件。\n- 对于每个测试用例，如果 $D_{ij} \\le \\epsilon$ 且 $i \\neq j$，则在 $x_i$ 和 $x_j$ 之间包含一条无向边，以此构建基于 VR 的图，然后计算该图的路径连通分支数量，以确定 $H_0(\\mathrm{VR}_\\epsilon(X))$ 的秩。\n- 独立地使用给定的距离矩阵执行单链接聚类，并计算在阈值 $\\epsilon$ 处切割时簇的数量。\n- 为每个测试用例生成一个布尔值，指示这两个计数是否相等。\n\n测试套件：\n1. 矩阵 $D^{(1)} \\in \\mathbb{R}^{4 \\times 4}$ 和阈值 $\\epsilon^{(1)} = 0.2$, $\\epsilon^{(2)} = 0.12$, $\\epsilon^{(3)} = 0.0$:\n$$\nD^{(1)} =\n\\begin{bmatrix}\n0.0  0.15  0.9  0.85 \\\\\n0.15  0.0  0.88  0.86 \\\\\n0.9  0.88  0.0  0.12 \\\\\n0.85  0.86  0.12  0.0\n\\end{bmatrix}.\n$$\n使用 $(D^{(1)}, \\epsilon^{(1)})$、$(D^{(1)}, \\epsilon^{(2)})$ 和 $(D^{(1)}, \\epsilon^{(3)})$ 进行三个独立的测试用例。\n\n2. 矩阵 $D^{(2)} \\in \\mathbb{R}^{3 \\times 3}$ 和阈值 $\\epsilon^{(4)} = 0.5$:\n$$\nD^{(2)} =\n\\begin{bmatrix}\n0.0  0.5  1.0 \\\\\n0.5  0.0  0.5 \\\\\n1.0  0.5  0.0\n\\end{bmatrix}.\n$$\n\n3. 矩阵 $D^{(3)} \\in \\mathbb{R}^{6 \\times 6}$ 和阈值 $\\epsilon^{(5)} = 0.22$, $\\epsilon^{(6)} = 0.9$:\n$$\nD^{(3)} =\n\\begin{bmatrix}\n0.0  0.20  0.26  0.82  0.86  0.95 \\\\\n0.20  0.0  0.21  0.84  0.87  0.96 \\\\\n0.26  0.21  0.0  0.83  0.88  0.95 \\\\\n0.82  0.84  0.83  0.0  0.18  0.94 \\\\\n0.86  0.87  0.88  0.18  0.0  0.94 \\\\\n0.95  0.96  0.95  0.94  0.94  0.0\n\\end{bmatrix}.\n$$\n使用 $(D^{(3)}, \\epsilon^{(5)})$ 和 $(D^{(3)}, \\epsilon^{(6)})$ 进行两个独立的测试用例。\n\n输出规格：\n- 您的程序应产生一行输出，其中包含一个用方括号括起来的逗号分隔列表，每个条目都是一个布尔值（$True$ 或 $False$），表示对于相应的测试用例，$H_0(\\mathrm{VR}_\\epsilon(X))$ 的秩是否等于在阈值 $\\epsilon$ 下单链接聚类的簇数量。例如，输出可能看起来像 $[True,False,True]$。\n\n本问题中不出现物理单位、角度单位或百分比。所有计算都是纯数学的，输出如上所述为布尔值。",
            "solution": "该任务是在给定的尺度 $\\epsilon \\in \\mathbb{R}_{\\ge 0}$ 下，对一个有限度量空间 $(X, D)$，计算上验证多尺度数据分析中两个基本量之间的等价性：Vietoris-Rips 复形的零阶同调群的秩 $\\mathrm{rank}(H_0(\\mathrm{VR}_\\epsilon(X)))$，以及在阈值 $\\epsilon$ 下从单链接聚类 (SLC) 获得的簇的数量。集合 $X = \\{x_1, x_2, \\dots, x_n\\}$ 的两两距离由一个对称矩阵 $D \\in \\mathbb{R}^{n \\times n}$ 给出。我们将推导并实现两个独立的算法来计算这些量，并比较它们的结果。\n\n**1. $H_0(\\mathrm{VR}_\\epsilon(X))$ 的秩的计算**\n\n根据代数拓扑的定义，一个单纯复形 $K$ 的零阶同调群 $H_0(K)$ 捕捉了其路径连通分支。$H_0(K)$ 的秩，记为第 $0$ 个贝蒂数 $\\beta_0$，等于这些路径连通分支的数量。\n\n一个单纯复形的路径连通性完全由其 $1$-骨架决定，这个 $1$-骨架是由复形的顶点和边组成的图。对于 Vietoris-Rips 复形 $\\mathrm{VR}_\\epsilon(X)$，其顶点是 $X$ 中的点。如果集合 $\\{x_i, x_j\\}$ 是一个 $1$-单纯形，则在两个顶点 $x_i$ 和 $x_j$ 之间存在一条边，根据 $\\mathrm{VR}_\\epsilon(X)$ 的定义，这意味着距离 $d(x_i, x_j) \\le \\epsilon$。\n\n这引出了一个图 $G_\\epsilon = (V, E)$ 的构建，其中顶点集为 $V = X$，边集为 $E = \\{\\{x_i, x_j\\} \\subseteq X \\mid i \\neq j, D_{ij} \\le \\epsilon\\}$。因此，找到 $\\mathrm{rank}(H_0(\\mathrm{VR}_\\epsilon(X)))$ 的问题被简化为计算图 $G_\\epsilon$ 中连通分支的数量。\n\n该算法如下：\n1.  **图表示**：给定大小为 $n \\times n$ 的距离矩阵 $D$ 和尺度参数 $\\epsilon$，我们可以隐式地表示图 $G_\\epsilon$。顶点是整数 $\\{0, 1, \\dots, n-1\\}$。如果 $D_{ij} \\le \\epsilon$，则顶点 $i$ 和 $j$ 之间存在一条边。\n2.  **通过遍历计算分支数量**：我们可以使用图遍历算法（如深度优先搜索 (DFS) 或广度优先搜索 (BFS)）来找到连通分支的数量。\n    - 初始化一个大小为 $n$ 的布尔数组 `visited`，所有条目都设置为 `False`。\n    - 初始化一个分支计数器 `num_components` 为 $0$。\n    - 遍历每个顶点 $i$ (从 $0$ 到 $n-1$)：\n        - 如果顶点 $i$ 未被访问（即 `visited[i]` 为 `False`），这标志着一个新的连通分支的开始。\n        - 将 `num_components` 加一。\n        - 从顶点 $i$ 开始进行遍历（例如 DFS）。在此遍历期间，找到所有可通过 $G_\\epsilon$ 中的路径从 $i$ 到达的顶点，并将 `visited` 数组中相应的条目设置为 `True`，以标记它们为已访问。\n3.  **结果**：遍历所有顶点后，`num_components` 将保存 $G_\\epsilon$ 的总连通分支数，这等于 $\\mathrm{rank}(H_0(\\mathrm{VR}_\\epsilon(X)))$。\n\n**2. 单链接聚类簇数量的计算**\n\n单链接聚类 (SLC) 是一种层次化的凝聚式聚类方法。它从将每个点视为一个单例簇开始。然后，它迭代地合并两个簇间距离最小的簇 $(C_a, C_b)$，簇间距离定义为 $d(C_a, C_b) = \\min_{x_i \\in C_a, x_j \\in C_b} D_{ij}$。这个过程构建了一个树状图，它是一棵表示合并层次结构的树。\n\n在阈值 $\\epsilon$ 处切割树状图，将数据 $X$ 划分为一组不相交的簇。所有在距离大于 $\\epsilon$ 处发生的合并都将被忽略。两个点 $x_i$ 和 $x_j$ 在阈值 $\\epsilon$ 下属于同一个簇，当且仅当存在一个点路径 $x_i = p_0, p_1, \\dots, p_k = x_j$，使得路径中每一步的距离最多为 $\\epsilon$，即对于所有 $m \\in \\{1, \\dots, k\\}$，都有 $d(p_{m-1}, p_m) \\le \\epsilon$。\n\n这个条件与上一节中图 $G_\\epsilon$ 中路径连通性的定义完全相同。因此，在阈值 $\\epsilon$ 下的 SLC 簇正是 $G_\\epsilon$ 的连通分支。\n\n为了按要求独立地计算这个量，我们可以使用科学计算库中可用的标准层次聚类计算流程。\n1.  **输入格式化**：像 `SciPy` 这样的库中的标准层次聚类算法通常要求距离矩阵采用压缩的一维格式。这是一个包含 $D$ 上三角元素的向量，即 $D_{01}, D_{02}, \\dots, D_{0,n-1}, D_{12}, \\dots, D_{n-2,n-1}$。\n2.  **链接计算**：计算一个链接矩阵 $Z$。该矩阵编码了树状图。对于单链接聚类，这是通过一个重复寻找所有当前簇中最小距离对的算法来实现的。`scipy.cluster.hierarchy.linkage` 函数使用 `method='single'` 来执行此步骤。\n3.  **簇划分**：然后在阈值 $\\epsilon$ 处“切割”链接矩阵 $Z$。函数 `scipy.cluster.hierarchy.fcluster` 使用 `criterion='distance'` 和阈值 $t=\\epsilon$ 来执行此操作，为每个初始数据点分配一个整数簇标签。它将项目分组到簇中，使得同一平坦簇中项目之间的原始距离不大于 $\\epsilon$。\n4.  **簇计数**：簇的数量是上一步中分配的唯一标签的数量。\n\n比较这两个不同计算过程的结果，将在计算上确认已建立的理论等价性对于所提供的测试用例是成立的。对于每个有效的测试用例，布尔比较预计将得出 `True`。",
            "answer": "```python\nimport numpy as np\nfrom scipy.cluster.hierarchy import linkage, fcluster\nfrom scipy.spatial.distance import squareform\n\ndef compute_h0_rank(D: np.ndarray, epsilon: float) -> int:\n    \"\"\"\n    Computes the rank of the 0-th homology group of the Vietoris-Rips complex.\n    This is equivalent to counting the connected components of the graph where an\n    edge (i, j) exists if D[i, j] = epsilon.\n    \n    Args:\n        D (np.ndarray): A square, symmetric distance matrix.\n        epsilon (float): The scale parameter.\n\n    Returns:\n        int: The number of connected components (rank of H_0).\n    \"\"\"\n    n = D.shape[0]\n    if n == 0:\n        return 0\n    \n    visited = np.zeros(n, dtype=bool)\n    num_components = 0\n    \n    for i in range(n):\n        if not visited[i]:\n            num_components += 1\n            visited[i] = True\n            stack = [i]\n            while stack:\n                u = stack.pop()\n                for v in range(n):\n                    # Check for an edge and if the neighbor has not been visited\n                    if not visited[v] and D[u, v] = epsilon:\n                        visited[v] = True\n                        stack.append(v)\n    return num_components\n\ndef compute_slc_clusters(D: np.ndarray, epsilon: float) -> int:\n    \"\"\"\n    Computes the number of clusters from Single-Linkage Clustering at a given threshold.\n    \n    Args:\n        D (np.ndarray): A square, symmetric distance matrix.\n        epsilon (float): The threshold for cutting the dendrogram.\n\n    Returns:\n        int: The number of clusters.\n    \"\"\"\n    n = D.shape[0]\n    if n = 1:\n        return n\n    \n    # SciPy's linkage function requires a condensed distance matrix (1D array of upper triangle).\n    # squareform converts the square matrix D to this format.\n    condensed_D = squareform(D, checks=False)\n    \n    # Perform single-linkage clustering to get the linkage matrix (dendrogram).\n    Z = linkage(condensed_D, method='single')\n    \n    # Form flat clusters from the dendrogram by cutting at the distance threshold epsilon.\n    # The criterion 'distance' groups items into flat clusters so that the original\n    # distance between any two items in the same cluster is no more than the\n    # threshold `t`.\n    labels = fcluster(Z, t=epsilon, criterion='distance')\n    \n    # The number of clusters is the number of unique labels.\n    num_clusters = len(np.unique(labels))\n    \n    return num_clusters\n\ndef solve():\n    \"\"\"\n    Defines the test suite, runs the computations, and prints the results.\n    \"\"\"\n    D1 = np.array([\n        [0.0, 0.15, 0.9, 0.85],\n        [0.15, 0.0, 0.88, 0.86],\n        [0.9, 0.88, 0.0, 0.12],\n        [0.85, 0.86, 0.12, 0.0]\n    ])\n\n    D2 = np.array([\n        [0.0, 0.5, 1.0],\n        [0.5, 0.0, 0.5],\n        [1.0, 0.5, 0.0]\n    ])\n\n    D3 = np.array([\n        [0.0, 0.20, 0.26, 0.82, 0.86, 0.95],\n        [0.20, 0.0, 0.21, 0.84, 0.87, 0.96],\n        [0.26, 0.21, 0.0, 0.83, 0.88, 0.95],\n        [0.82, 0.84, 0.83, 0.0, 0.18, 0.94],\n        [0.86, 0.87, 0.88, 0.18, 0.0, 0.94],\n        [0.95, 0.96, 0.95, 0.94, 0.94, 0.0]\n    ])\n\n    test_cases = [\n        (D1, 0.2),    # Case 1\n        (D1, 0.12),   # Case 2\n        (D1, 0.0),    # Case 3\n        (D2, 0.5),    # Case 4\n        (D3, 0.22),   # Case 5\n        (D3, 0.9)     # Case 6\n    ]\n\n    results = []\n    for D, epsilon in test_cases:\n        h0_rank = compute_h0_rank(D, epsilon)\n        slc_count = compute_slc_clusters(D, epsilon)\n        # The problem asks to verify that these two are equal.\n        # The underlying mathematical theorem guarantees this.\n        results.append(h0_rank == slc_count)\n\n    # Format the output as a comma-separated list of booleans in brackets.\n    # The boolean values must be capitalized 'True' or 'False'.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "从理论计算转向现实世界的数据分析，需要我们在如何从点云构建单纯复形的问题上做出审慎的选择。本练习将您置于一个包含噪声数据和离群点的真实场景中，要求您在广受欢迎的 Vietoris-Rips 复形和几何上更忠实的 alpha 复形之间做出抉择。通过分析每种方法如何表达潜在的环状结构，您将学会在结构识别任务中，权衡计算便利性与几何准确性这两个关键因素。",
            "id": "3794602",
            "problem": "考虑在欧几里得空间中以多尺度建模的点采样平面结构。设 $S \\subset \\mathbb{R}^2$ 是一个点云，由采样一个闭环的四个点和一个离群点组成：$S = \\{(1,0),(0,1),(-1,0),(0,-1),(4,0)\\}$。假设测量噪声相对于环的曲率尺度较小，因此四个环点反映了单个一维特征的预期几何形状，而位于 $(4,0)$ 的离群点是反映罕见扰动的伪数据点。任务是选择一个在存在噪声和离群点的情况下仍能保持对底层环的几何保真度的滤子，并在指定的尺度参数下，计算结构识别所需的拓扑不变量。\n\n您必须从以下基本基础出发：\n- 维托里斯－里普斯复形是在一个度量空间上定义的，当一个 $k$-单纯形的所有顶点两两之间的距离都在一个阈值 $\\varepsilon$ 内时，该单纯形就包含在复形中。其同调为数据偏移（offset）的拓扑结构提供了一个组合近似。\n- 切赫复形被定义为以样本点为中心、半径为 $r$ 的闭球覆盖的神经，根据神经定理，它与这些球的并集同伦等价。在欧几里得空间中，包含关系 $\\mathrm{Cech}_r \\subset \\mathrm{Rips}_{2r} \\subset \\mathrm{Cech}_{2r}$ 成立。\n- Alpha复形是通过将沃罗诺伊单元与半径为 $r$ 的球相交得到的受限德劳内复形；等价地，在 $\\mathbb{R}^d$ 中，如果存在一个半径至多为 $r$ 的空球，其边界包含某个单纯形的顶点，则该单纯形属于尺度为 $r$ 的Alpha复形。在一般位置和采样假设下，Alpha复形与相应的切赫复形同伦等价，因此也与球的并集同伦等价，所以它能保留几何偏移，同时避免许多伪单纯形。\n\n基于这些基础，考虑对同一数据 $S$ 的以下两种尺度选择：\n- 半径 $r = 0.8$ 的Alpha复形。\n- 两两距离阈值 $\\varepsilon = 2.05$ 的维托里斯－里普斯复形。\n\n在存在噪声和离群点的情况下，哪个选项正确地论证了为保证几何保真度而选择Alpha复形而非维托里斯－里普斯复形，并正确地计算了在给定参数下两个复形的零阶和一阶贝蒂数 $\\beta_0$ 和 $\\beta_1$？\n\nA. 半径 $r=0.8$ 的Alpha复形得到 $\\beta_0=2$ 和 $\\beta_1=1$；阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形得到 $\\beta_0=2$ 和 $\\beta_1=0$。首选Alpha复形，因为它是德劳内三角剖分的一个子复形，实现了欧几里得球偏移的受限神经，因此它遵循球并集的几何形状，并且不会引入过早填充一维特征的大团；在此尺度下，离群点保持孤立。\n\nB. 半径 $r=0.8$ 的Alpha复形得到 $\\beta_0=1$ 和 $\\beta_1=1$，因为离群点的大沃罗诺伊单元通过一条长边连接；阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形得到 $\\beta_0=2$ 和 $\\beta_1=1$。首选Alpha复形，因为它在相同参数下总比维托里斯－里普斯复形有更少的 $k$-单纯形。\n\nC. 半径 $r=1.2$ 的Alpha复形得到 $\\beta_0=1$ 和 $\\beta_1=0$；阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形得到 $\\beta_0=2$ 和 $\\beta_1=0$。首选Alpha复形，因为它对所有点集和参数都等价于切赫复形，因此它总是与球并集的拓扑完全匹配。\n\nD. 半径 $r=0.8$ 的Alpha复形得到 $\\beta_0=2$ 和 $\\beta_1=1$；阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形得到 $\\beta_0=2$ 和 $\\beta_1=1$。首选Alpha复形，因为维托里斯－里普斯滤子相对于Gromov–Hausdorff扰动不稳定，而Alpha滤子则不同。",
            "solution": "在尝试任何解答之前，需对用户提供的问题陈述进行验证。\n\n### 第一步：提取已知条件\n- **点云**：一个集合 $S \\subset \\mathbb{R}^2$，包含五个点：$S = \\{(1,0), (0,1), (-1,0), (0,-1), (4,0)\\}$。\n- **预期结构**：点 $\\{(1,0), (0,1), (-1,0), (0,-1)\\}$ 被陈述为采样一个单一的一维闭环。点 $(4,0)$ 被描述为一个伪离群点。\n- **滤子定义**：提供了维托里斯－里普斯复形、切赫复形和Alpha复形的标准定义。\n- **复形参数**：需要构建和分析两个特定的单纯复形：\n    1.  半径 $r = 0.8$ 的Alpha复形。\n    2.  两两距离阈值 $\\varepsilon = 2.05$ 的维托里斯－里普斯复形。\n- **任务**：选择能更好地保持对底层环结构的几何保真度的滤子，并为两个指定的复形计算零阶（$\\beta_0$）和一阶（$\\beta_1$）贝蒂数。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题在拓扑数据分析（TDA）这一成熟的数学领域中有坚实的基础。维托里斯－里普斯复形和Alpha复形的定义是标准的，将其应用于点云是该领域的典型问题。\n- **适定性**：该问题是适定的。点集被明确定义，复形的参数已指定，需要计算的量（贝蒂数）在数学上是明确的。存在唯一且有意义的解。\n- **客观性**：问题陈述是客观的，并使用了计算几何和拓扑学中精确的标准术语。\n\n### 第三步：结论与行动\n问题陈述是**有效的**，因为它是科学合理的、适定的和客观的。没有发现任何缺陷。可以继续进行解答过程。\n\n### 解答推导\n\n我们将点表示为 $P_1 = (1,0)$、$P_2 = (0,1)$、$P_3 = (-1,0)$、$P_4 = (0,-1)$ 以及离群点 $P_5 = (4,0)$。我们将构建每个复形并计算其贝蒂数。\n\n**1. 阈值 $\\varepsilon = 2.05$ 的维托里斯－里普斯复形**\n\n维托里斯－里普斯复形 $VR(S, \\varepsilon)$ 包含一个 $k$-单纯形，条件是其所有 $k+1$ 个顶点两两之间的距离都在 $\\varepsilon$ 以内。此处，$\\varepsilon = 2.05$。\n\n- **顶点 (0-单纯形)**：$5$ 个点 $\\{P_1, P_2, P_3, P_4, P_5\\}$ 是复形的顶点。\n\n- **边 (1-单纯形)**：我们计算所有点之间的两两距离。\n    - 环点 $\\{P_1, P_2, P_3, P_4\\}$：\n        - $d(P_1, P_2) = \\sqrt{(1-0)^2 + (0-1)^2} = \\sqrt{2} \\approx 1.414  2.05$\n        - $d(P_2, P_3) = \\sqrt{(0-(-1))^2 + (1-0)^2} = \\sqrt{2} \\approx 1.414  2.05$\n        - $d(P_3, P_4) = \\sqrt{(-1-0)^2 + (0-(-1))^2} = \\sqrt{2} \\approx 1.414  2.05$\n        - $d(P_4, P_1) = \\sqrt{(0-1)^2 + (-1-0)^2} = \\sqrt{2} \\approx 1.414  2.05$\n        - $d(P_1, P_3) = \\sqrt{(1-(-1))^2 + (0-0)^2} = 2  2.05$\n        - $d(P_2, P_4) = \\sqrt{(0-0)^2 + (1-(-1))^2} = 2  2.05$\n    由于四个环点之间的所有两两距离都小于 $\\varepsilon = 2.05$，这四个点构成一个完全图 $K_4$。\n    - 离群点 $P_5$：\n        - $d(P_1, P_5) = \\sqrt{(1-4)^2 + (0-0)^2} = 3  2.05$\n        - $d(P_2, P_5) = \\sqrt{(0-4)^2 + (1-0)^2} = \\sqrt{17} \\approx 4.123  2.05$\n        - $d(P_3, P_5) = \\sqrt{(-1-4)^2 + (0-0)^2} = 5  2.05$\n        - $d(P_4, P_5) = \\sqrt{(0-4)^2 + (-1-0)^2} = \\sqrt{17} \\approx 4.123  2.05$\n    没有边连接 $P_5$ 和任何其他点。\n\n- **高维单纯形**：\n    由于 $\\{P_1, P_2, P_3, P_4\\}$ 构成一个 $K_4$，这些顶点上的所有可能的高维单纯形都包含在维托里斯－里普斯复形中。这包括所有四个2-单纯形（三角形）和单个3-单纯形（四面体）。一个实心四面体是一个可收缩空间。\n\n- **$VR(S, 2.05)$ 的同调**：\n    该复形由两个不相交的路径连通分支组成：\n    1. 一个构建在顶点 $\\{P_1, P_2, P_3, P_4\\}$ 上的可收缩分支。\n    2. 一个孤立的顶点分支 $\\{P_5\\}$。\n    - $\\beta_0$（零阶贝蒂数）是连通分支的数量，所以 $\\beta_0 = 2$。\n    - $\\beta_1$（一阶贝蒂数）是一维孔洞的数量。两个分支都没有一维孔洞。$K_4$ 是可收缩的（与一个点同伦等价），而一个孤立的顶点也是可收缩的。因此，$\\beta_1 = 0$。\n    维托里斯－里普斯复形的贝蒂数是 $(\\beta_0, \\beta_1) = (2, 0)$。\n\n**2. 半径 $r = 0.8$ 的Alpha复形**\n\nAlpha复形 $\\alpha(S, r)$ 是 $S$ 的德劳内三角剖分的一个子复形。如果德劳内三角剖分中的一个单纯形的最小空外接球的半径至多为 $r$，则该单纯形被包含在 $\\alpha(S, r)$ 中。\n\n- **德劳内三角剖分**：对于给定的点集，其凸包是由 $P_3, P_4, P_5, P_2$ 构成的四边形。点 $P_1$ 在内部。德劳内三角剖分将 $P_1$ 连接到凸包的所有顶点，形成三角形 $\\Delta(P_1, P_2, P_3)$、$\\Delta(P_1, P_3, P_4)$、$\\Delta(P_1, P_4, P_5)$ 和 $\\Delta(P_1, P_5, P_2)$。\n\n- **$\\alpha(S, 0.8)$ 中的单纯形**：我们检查哪些德劳内单纯形的外接圆半径 $R \\le r = 0.8$。\n    - **顶点 (0-单纯形)**：所有 $5$ 个点都包含在内。\n    - **边 (1-单纯形)**：一条边的外接圆半径是其长度的一半。\n        - 边 $(P_1, P_2), (P_2, P_3), (P_3, P_4), (P_4, P_1)$：长度均为 $L = \\sqrt{2}$。它们的外接圆半径为 $R = \\sqrt{2}/2 \\approx 0.707$。由于 $0.707 \\le 0.8$，这四条边被包含在Alpha复形中。\n        - 边 $(P_1, P_3)$：长度 $L=2$。外接圆半径 $R = 2/2 = 1$。由于 $1  0.8$，这条边不被包含。\n        - 边 $(P_1, P_5)$：长度 $L=3$。外接圆半径 $R = 3/2 = 1.5$。由于 $1.5  0.8$，这条边不被包含。\n        - 其他涉及 $P_5$ 的边甚至更长，因此也不被包含。\n    - **三角形 (2-单纯形)**：\n        - $\\Delta(P_1, P_2, P_3)$：顶点为 $(1,0), (0,1), (-1,0)$。它们位于以原点 $(0,0)$ 为中心、半径为 $R=1$ 的圆上。由于 $R=1  0.8$，这个三角形不被包含。\n        - 任何其他三角形的外接圆半径至少与其最长边的外接圆半径一样大。由于唯一被包含的边构成了环，因此不可能形成只涉及环点的2-单纯形。任何涉及 $P_5$ 的三角形（例如 $\\Delta(P_1, P_4, P_5)$）必然包含比环中任何边都长的边，所以它们的外接圆半径将大于 $1$，因此也大于 $0.8$。例如，$\\Delta(P_1,P_2,P_5)$ 的外接圆半径为 $\\sqrt{8.5}/2 \\approx 1.45  0.8$。该复形中不包含任何2-单纯形。\n\n- **$\\alpha(S, 0.8)$ 的同调**：\n    该复形由两个不相交的路径连通分支组成：\n    1. 由顶点 $\\{P_1, P_2, P_3, P_4\\}$ 和边 $(P_1, P_2)$, $(P_2, P_3)$, $(P_3, P_4)$, $(P_4, P_1)$ 构成的环图。\n    2. 孤立顶点 $\\{P_5\\}$。\n    - $\\beta_0$ 是连通分支的数量，所以 $\\beta_0 = 2$。\n    - $\\beta_1$ 是一维孔洞的数量。第一个分支是一个简单的闭环，定义了一个一维孔洞。第二个分支是一个点，没有孔洞。因此，$\\beta_1 = 1$。\n    Alpha复形的贝蒂数是 $(\\beta_0, \\beta_1) = (2, 1)$。\n\n**3. 比较与论证**\n\n- 半径 $r=0.8$ 的Alpha复形：$(\\beta_0, \\beta_1) = (2, 1)$。这正确地识别出一个环结构（$\\beta_1=1$）和一个离群点（$\\beta_0=2$个连通分支）。\n- 阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形：$(\\beta_0, \\beta_1) = (2, 0)$。这识别出离群点是一个独立的连通分支（$\\beta_0=2$），但未能识别出环结构（$\\beta_1=0$）。阈值 $\\varepsilon=2.05$ 大于环点的对角线距离（2），导致该复形包含了这四个点上的所有单纯形，形成一个可收缩的 $K_4$ 并过早地“填充”了孔洞。\n\n在这种情况下，Alpha复形在几何保真度方面更优。它的构造与德劳内三角剖分和外接圆半径相关，因此对点集的局部几何形状更为敏感。通过选择 $r=0.8$，我们选择了一个足够大的尺度来连接环上的相邻点（外接圆半径 $\\approx 0.707$），但又足够小以至于不会形成会填充孔洞的三角形（外接圆半径 $1$）。这展示了Alpha复形能够避免引入在维托里斯－里普斯复形中可能出现的大型、几何上虚假的单纯形。\n\n### 逐项分析\n\n**A. 半径 $r=0.8$ 的Alpha复形得到 $\\beta_0=2$ 和 $\\beta_1=1$；阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形得到 $\\beta_0=2$ 和 $\\beta_1=0$。首选Alpha复形，因为它是德劳内三角剖分的一个子复形，实现了欧几里得球偏移的受限神经，因此它遵循球并集的几何形状，并且不会引入过早填充一维特征的大团；在此尺度下，离群点保持孤立。**\n- **贝蒂数**：计算出的两个复形的贝蒂数 $(\\beta_0, \\beta_1)_{\\alpha} = (2,1)$ 和 $(\\beta_0, \\beta_1)_{VR} = (2,0)$ 与我们的推导完全一致。\n- **论证**：推理是合理的。Alpha复形与德劳内三角剖分和球并集拓扑（通过与切赫复形的同伦等价）的关系使其具有几何保真度。“不会引入过早填充一维特征的大团”这句话正确地指出了本例中维托里斯－里普斯复形的失败模式。离群点被正确地指出是孤立的。\n- **结论**：**正确**。\n\n**B. 半径 $r=0.8$ 的Alpha复形得到 $\\beta_0=1$ 和 $\\beta_1=1$，因为离群点的大沃罗诺伊单元通过一条长边连接；阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形得到 $\\beta_0=2$ 和 $\\beta_1=1$。**\n- **贝蒂数**：Alpha复形的贝蒂数 $\\beta_0=1$ 不正确；离群点是孤立的，所以 $\\beta_0=2$。VR复形的贝蒂数 $\\beta_1=1$ 不正确；该复形填充了孔洞，所以 $\\beta_1=0$。\n- **论证**：关于离群点在Alpha复形中连接的说法对于给定的尺度参数 $r=0.8$ 是错误的。\n- **结论**：**不正确**。\n\n**C. 半径 $r=1.2$ 的Alpha复形得到 $\\beta_0=1$ 和 $\\beta_1=0$；阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形得到 $\\beta_0=2$ 和 $\\beta_1=0$。首选Alpha复形，因为它对所有点集和参数都等价于切赫复形，因此它总是与球并集的拓扑完全匹配。**\n- **参数**：该选项错误地分析了半径为 $r=1.2$ 的Alpha复形，而不是指定的 $r=0.8$。\n- **贝蒂数**：即使对于 $r=1.2$，计算也是有缺陷的。在 $r=1.2$ 时，环点上的三角形将被包含（外接圆半径 $1  1.2$），从而填充孔洞（$\\beta_1=0$），但离群点仍然是孤立的（边的外接圆半径 $ > 1.2$），所以 $\\beta_0=2$，而不是 $\\beta_0=1$。\n- **论证**：关于Alpha复形对所有点集都“等价”于切赫复形的说法是错误的；它们在适当条件下是同伦等价的。\n- **结论**：**不正确**。\n\n**D. 半径 $r=0.8$ 的Alpha复形得到 $\\beta_0=2$ 和 $\\beta_1=1$；阈值 $\\varepsilon=2.05$ 的维托里斯－里普斯复形得到 $\\beta_0=2$ 和 $\\beta_1=1$。首选Alpha复形，因为维托里斯－里普斯滤子相对于Gromov–Hausdorff扰动不稳定，而Alpha滤子则不同。**\n- **贝蒂数**：Alpha复形的数值是正确的。然而，VR复形的 $\\beta_1=1$ 是不正确的。\n- **论证**：关于稳定性的说法是一种误述。维托里斯－里普斯滤子的持久性图谱对于Gromov-Hausdorff距离是已知的稳定的。虽然稳定性是TDA中的一个重要概念，但所给的陈述是不准确的，也不是在这个特定几何背景下偏好Alpha复形的主要原因。主要原因是几何保真度，如选项A中所解释。\n- **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}