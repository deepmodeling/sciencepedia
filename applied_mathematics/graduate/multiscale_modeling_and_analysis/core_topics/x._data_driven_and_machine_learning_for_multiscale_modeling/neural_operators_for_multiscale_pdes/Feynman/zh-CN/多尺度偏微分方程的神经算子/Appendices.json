{
    "hands_on_practices": [
        {
            "introduction": "此练习深入探讨了傅里叶神经算子（FNO）的一个关键实现细节。为了将这些模型应用于通常是实值的真实物理系统，我们必须确保我们的网络架构尊重这一属性。此实践  将指导您推导谱核权重必须满足的共轭对称约束，这是将实值输入映射到实值输出的必要条件，这对于构建参数高效且物理一致的模型至关重要。",
            "id": "3787660",
            "problem": "考虑一个应用于二维周期域的傅里叶神经算子（FNO），用于学习多尺度偏微分方程的解算子。设输入场和输出场均为实值，分别具有 $C_{\\text{in}}$ 个输入通道和 $C_{\\text{out}}$ 个输出通道。在谱卷积层中，学习到的复值核是一个张量 $R(\\mathbf{k}) \\in \\mathbb{C}^{C_{\\text{out}} \\times C_{\\text{in}}}$，由从截断的矩形集合中抽取的离散二维波数 $\\mathbf{k} = (k_{x}, k_{y})$ 索引\n$$\n\\mathcal{I} = \\{ (k_{x}, k_{y}) \\,:\\, k_{x} \\in \\{-K_{x}, -K_{x}+1, \\dots, K_{x}\\}, \\; k_{y} \\in \\{-K_{y}, -K_{y}+1, \\dots, K_{y}\\} \\},\n$$\n其中 $K_{x}$ 和 $K_{y}$ 是非负整数，指定了每个坐标上的谱截断。\n\n谱卷积的作用方式为 $\\widehat{y}(\\mathbf{k}) = R(\\mathbf{k}) \\,\\widehat{x}(\\mathbf{k})$，其中 $\\widehat{x}(\\mathbf{k})$ 和 $\\widehat{y}(\\mathbf{k})$ 分别是输入和输出的离散傅里叶变换（DFT）系数。利用实值场的DFT基本性质 $\\widehat{f}(-\\mathbf{k}) = \\overline{\\widehat{f}(\\mathbf{k})}$，推导 $R(\\mathbf{k})$ 必须满足的共轭对称约束，以确保对于所有实值输入，$\\widehat{y}(\\mathbf{k})$ 都对应一个实值输出场。然后，对于空间维度 $d=2$，通过定义一个代表性的半数模态集合 $\\mathcal{H} \\subset \\mathcal{I}$ 和实值参数张量，来构建 $R(\\mathbf{k})$ 的显式参数化，确保在整个 $\\mathcal{I}$ 上满足所需的共轭对称性 $R(-\\mathbf{k}) = \\overline{R(\\mathbf{k})}$，并包括对零模态的特殊处理。最后，计算在此参数化下指定 $R(\\mathbf{k})$ 所需的独立实数标量参数总数的闭式表达式，并用 $K_{x}$、$K_{y}$、$C_{\\text{in}}$ 和 $C_{\\text{out}}$ 表示。\n\n最终答案必须是单个解析表达式。无需四舍五入，不涉及单位。请以最简精确形式表示最终表达式。",
            "solution": "用户希望分析傅里叶神经算子（FNO）中谱卷积层的参数化。\n\n### 第1步：提取已知条件\n-   域是二维周期域。\n-   输入和输出场是实值的。\n-   输入通道数为 $C_{\\text{in}}$。\n-   输出通道数为 $C_{\\text{out}}$。\n-   学习到的复值核为 $R(\\mathbf{k}) \\in \\mathbb{C}^{C_{\\text{out}} \\times C_{\\text{in}}}$。\n-   波数 $\\mathbf{k} = (k_{x}, k_{y})$ 来自截断集合 $\\mathcal{I} = \\{ (k_{x}, k_{y}) \\,:\\, k_{x} \\in \\{-K_{x}, \\dots, K_{x}\\}, \\; k_{y} \\in \\{-K_{y}, \\dots, K_{y}\\} \\}$。\n-   谱卷积由 $\\widehat{y}(\\mathbf{k}) = R(\\mathbf{k}) \\,\\widehat{x}(\\mathbf{k})$ 给出。\n-   任何实值场 $f$ 的离散傅里叶变换（DFT）的性质是 $\\widehat{f}(-\\mathbf{k}) = \\overline{\\widehat{f}(\\mathbf{k})}$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于傅里叶分析的既定数学原理及其在现代机器学习模型中的应用，特别是傅里叶神经算子。实值函数的DFT性质是标准的。该设置在科学上是合理的。\n-   **适定性**：该问题要求推导约束、构建参数化和计算一个数值，所有这些都是基于给定条件的明确定义的数学任务。预期会有一个唯一且有意义的解。\n-   **客观性**：该问题以精确、客观的数学语言陈述。诸如“实值”、“复值核”以及波数集 $\\mathcal{I}$ 的定义等术语都是明确的。\n-   **自洽性与一致性**：所有必要的信息（定义、性质）都已提供。没有内部矛盾。\n-   **主题相关性**：该问题正处于*用于多尺度偏微分方程的神经算子*这一指定主题以及*多尺度建模与分析*领域的核心位置。\n\n### 第3步：结论与行动\n问题有效。我将继续进行求解。\n\n### 共轭对称约束的推导\n\n问题指出，输入场 $x$ 和输出场 $y$ 都是实值的。根据所提供的实值场的DFT性质，它们的傅里叶系数必须满足以下共轭对称条件：\n$$\n\\widehat{x}(-\\mathbf{k}) = \\overline{\\widehat{x}(\\mathbf{k})}\n$$\n$$\n\\widehat{y}(-\\mathbf{k}) = \\overline{\\widehat{y}(\\mathbf{k})}\n$$\n谱卷积层定义为 $\\widehat{y}(\\mathbf{k}) = R(\\mathbf{k}) \\,\\widehat{x}(\\mathbf{k})$。我们可以为波数 $-\\mathbf{k}$ 写出这个关系：\n$$\n\\widehat{y}(-\\mathbf{k}) = R(-\\mathbf{k}) \\,\\widehat{x}(-\\mathbf{k})\n$$\n现在，我们将 $\\widehat{x}$ 和 $\\widehat{y}$ 的对称性质代入此方程：\n$$\n\\overline{\\widehat{y}(\\mathbf{k})} = R(-\\mathbf{k}) \\,\\overline{\\widehat{x}(\\mathbf{k})}\n$$\n从该层的原始定义，我们可以对两边取复共轭：\n$$\n\\overline{\\widehat{y}(\\mathbf{k})} = \\overline{R(\\mathbf{k}) \\,\\widehat{x}(\\mathbf{k})} = \\overline{R(\\mathbf{k})} \\;\\overline{\\widehat{x}(\\mathbf{k})}\n$$\n通过令 $\\overline{\\widehat{y}(\\mathbf{k})}$ 的两个表达式相等，我们得到：\n$$\nR(-\\mathbf{k}) \\,\\overline{\\widehat{x}(\\mathbf{k})} = \\overline{R(\\mathbf{k})} \\;\\overline{\\widehat{x}(\\mathbf{k})}\n$$\n这个方程必须对任何实值输入场 $x$ 都成立，这意味着它必须对任何满足实值约束的傅里叶系数集 $\\widehat{x}(\\mathbf{k})$ 都成立。通常情况下，$\\overline{\\widehat{x}(\\mathbf{k})}$ 是一个非零向量，因此我们可以得出结论，矩阵本身必须相等：\n$$\nR(-\\mathbf{k}) = \\overline{R(\\mathbf{k})}\n$$\n这就是对核张量 $R(\\mathbf{k})$ 所要求的共轭对称约束。\n\n### 核的显式参数化\n\n为确保满足约束 $R(-\\mathbf{k}) = \\overline{R(\\mathbf{k})}$，我们只需要为具有代表性的“一半”波数定义参数。另一半的值则由对称性确定。所有波数的集合 $\\mathcal{I}$ 关于原点是对称的，即如果 $\\mathbf{k} \\in \\mathcal{I}$，那么 $-\\mathbf{k} \\in \\mathcal{I}$。我们将 $\\mathcal{I}$ 划分为三种类型的波数：零模态 $\\mathbf{k}=(0,0)$，非零模态对 $\\{\\mathbf{k}, -\\mathbf{k}\\}$，以及任何在边界上可能等于其负数的模态（这只发生在零模态上）。\n\n让我们如下定义一个代表性的半数模态集合 $\\mathcal{H}$：\n$$\n\\mathcal{H} = \\{ (k_{x}, k_{y}) \\in \\mathcal{I} \\,:\\, k_{y} > 0 \\} \\cup \\{ (k_{x}, k_{y}) \\in \\mathcal{I} \\,:\\, k_{y}=0, k_{x} \\ge 0 \\}\n$$\n这个集合为每对 $\\{\\mathbf{k}, -\\mathbf{k}\\}$（其中 $\\mathbf{k} \\neq (0,0)$）都恰好包含一个代表，并且也包括零模态 $\\mathbf{k}=(0,0)$。\n\n我们可以使用两个为 $\\mathbf{k} \\in \\mathcal{H}$ 定义的实值张量 $A(\\mathbf{k}), B(\\mathbf{k}) \\in \\mathbb{R}^{C_{\\text{out}} \\times C_{\\text{in}}}$ 来参数化复值核 $R(\\mathbf{k})$。构建方法如下：\n1.  对于任何 $\\mathbf{k} \\in \\mathcal{H}$：\n    -   如果 $\\mathbf{k}=(0,0)$，对称性约束为 $R(0,0) = \\overline{R(0,0)}$，这意味着 $R(0,0)$ 必须是一个实矩阵。因此，我们设置 $R(0,0) = A(0,0)$ 并强制其虚部为零。\n    -   如果 $\\mathbf{k} \\in \\mathcal{H}$ 且 $\\mathbf{k} \\neq (0,0)$，我们定义 $R(\\mathbf{k}) = A(\\mathbf{k}) + i B(\\mathbf{k})$。\n2.  对于任何 $\\mathbf{k} \\in \\mathcal{I} \\setminus \\mathcal{H}$：\n    -   根据 $\\mathcal{H}$ 的构造，我们知道 $-\\mathbf{k} \\in \\mathcal{H}$ 且 $-\\mathbf{k} \\neq (0,0)$。然后我们使用对称性约束来定义 $R(\\mathbf{k})$：\n    $$\n    R(\\mathbf{k}) = \\overline{R(-\\mathbf{k})} = \\overline{A(-\\mathbf{k}) + i B(-\\mathbf{k})} = A(-\\mathbf{k}) - i B(-\\mathbf{k})\n    $$\n这种构造从设计上保证了对于所有 $\\mathbf{k} \\in \\mathcal{I}$ 都满足 $R(-\\mathbf{k}) = \\overline{R(\\mathbf{k})}$。独立可学习的参数是实值张量 $A(\\mathbf{k})$（对于所有 $\\mathbf{k} \\in \\mathcal{H}$）和 $B(\\mathbf{k})$（对于所有 $\\mathbf{k} \\in \\mathcal{H} \\setminus \\{(0,0)\\}$）的元素。\n\n### 参数总数的计算\n\n我们需要计算在整个集合 $\\mathcal{I}$ 上指定核 $R(\\mathbf{k})$ 所需的独立实数标量参数的总数。这等同于计算我们构造中使用的实值张量 $A$ 和 $B$ 中的标量参数数量。\n\n设 $N = C_{\\text{in}} C_{\\text{out}}$ 为单个矩阵中的元素数量。\n$\\mathcal{I}$ 中波数的总数为 $|\\mathcal{I}| = (2K_{x}+1)(2K_{y}+1)$。\n\n我们可以通过考虑基于对称性的不同模态类型来计算参数数量：\n1.  **零模态 $\\mathbf{k}=(0,0)$**：核 $R(0,0)$ 必须是一个实矩阵。参数数量是这个实矩阵的元素数量，即 $C_{\\text{out}} \\times C_{\\text{in}} = N$。\n\n2.  **非零模态 $\\mathbf{k} \\neq (0,0)$**：这些模态可以被分组成对 $\\{\\mathbf{k}, -\\mathbf{k}\\}$。非零模态的总数是 $|\\mathcal{I}| - 1$。这样的对的数量是 $\\frac{|\\mathcal{I}|-1}{2}$。对于每一对，我们只需要存储一个代表的参数，比如 $\\mathbf{k} \\in \\mathcal{H}$。核 $R(\\mathbf{k})$ 是一个通用的复矩阵，其 $N$ 个元素中的每一个都需要 $2$ 个实数（实部和虚部）。因此，对于每一对，我们需要 $2N$ 个参数。$R(-\\mathbf{k})$ 的值则完全确定。\n    所有这些对的参数数量为：\n    $$\n    \\left( \\frac{|\\mathcal{I}|-1}{2} \\right) \\times (2N) = (|\\mathcal{I}|-1)N\n    $$\n\n独立实数标量参数的总数是零模态参数和所有非零模态对参数之和。\n$$\n\\text{总参数} = (\\text{k=0 的参数}) + (\\text{k}\\neq 0 \\text{ 的参数})\n$$\n$$\n\\text{总参数} = N + (|\\mathcal{I}|-1)N = N + |\\mathcal{I}|N - N = |\\mathcal{I}|N\n$$\n代入 $|\\mathcal{I}|$ 和 $N$ 的表达式：\n$$\n\\text{总参数} = ((2K_{x}+1)(2K_{y}+1)) \\times (C_{\\text{in}}C_{\\text{out}})\n$$\n因此，独立实参数的总数为：\n$$\nC_{\\text{in}}C_{\\text{out}}(2K_{x}+1)(2K_{y}+1)\n$$\n这个优雅的结果表明，参数的数量恰好等于为频率网格 $\\mathcal{I}$ 中的每个模态存储一个大小为 $C_{\\text{out}} \\times C_{\\text{in}}$ 的实矩阵所需的实参数数量。",
            "answer": "$$\n\\boxed{C_{\\text{in}}C_{\\text{out}}(2K_{x}+1)(2K_{y}+1)}\n$$"
        },
        {
            "introduction": "虽然标准的傅里叶神经算子是在周期性域上使用傅里叶基函数构建的，但许多现实世界中的偏微分方程是在具有非周期性边界条件的有界域上定义的。此练习演示了如何使神经算子框架适应这些重要的情形。此实践  要求您通过用与特定狄利克雷（Dirichlet）和诺伊曼（Neumann）边界条件兼容的特征函数基（正弦和余弦函数）替换标准傅里叶基，来推广 FNO 的概念。这项技能对于将神经算子应用于更广泛类别的物理问题至关重要。",
            "id": "3787628",
            "problem": "考虑矩形域 $\\Omega = (0,L_{x}) \\times (0,L_{y})$ 上的二阶线性椭圆偏微分方程 $-\\kappa \\Delta u + \\mu u = f$，其中 $\\kappa > 0$，$\\mu \\ge 0$，且 $f$ 是一个平方可积的强迫项。在垂直边界上施加齐次狄利克雷边界条件，在水平边界上施加齐次诺伊曼边界条件，即对所有 $y \\in [0,L_{y}]$，$u(0,y) = u(L_{x},y) = 0$；对所有 $x \\in [0,L_{x}]$，$\\partial_{y} u(x,0) = \\partial_{y} u(x,L_{y}) = 0$。利用 Sturm–Liouville 理论和分离变量法的原理，推导出一个与这些边界条件兼容的在 $\\Omega$ 上的标准正交本征函数基，并确定拉普拉斯算子的相应本征值。\n\n假设系数为常数，并利用 $u$ 和 $f$ 在此基中的正交展开来表示展开系数之间的谱关系。然后，通过将 $-\\kappa \\Delta + \\mu$ 的逆视为一个在此基中对角化的卷积型算子，推导出将模式 $(k,\\ell)$ 下 $f$ 的系数映射到同一模式下 $u$ 的系数的闭式谱乘子 $m_{k,\\ell}$。最后，对于 $L_{x} = 2$，$L_{y} = 3$，$\\kappa = 0.5$ 和 $\\mu = 0.2$，计算 $m_{2,1}$ 的数值。将最终的数值系数表示为一个无量纲数，并将您的答案四舍五入到四位有效数字。\n\n在您的推导中，请清楚地说明如何将谱乘子整合到一个傅里叶神经算子（FNO, Fourier Neural Operator）层中，通过将标准的周期性傅里叶基替换为与边界条件兼容的正弦/余弦变换基，而不使用任何快捷公式，并从正交本征函数展开的基本定义和性质出发。",
            "solution": "用户希望我解决以下问题陈述。\n\n**问题陈述：**\n\n考虑矩形域 $\\Omega = (0,L_{x}) \\times (0,L_{y})$ 上的二阶线性椭圆偏微分方程 $-\\kappa \\Delta u + \\mu u = f$，其中 $\\kappa > 0$，$\\mu \\ge 0$，且 $f$ 是一个平方可积的强迫项。在垂直边界上施加齐次狄利克雷边界条件，在水平边界上施加齐次诺伊曼边界条件，即对所有 $y \\in [0,L_{y}]$，$u(0,y) = u(L_{x},y) = 0$；对所有 $x \\in [0,L_{x}]$，$\\partial_{y} u(x,0) = \\partial_{y} u(x,L_{y}) = 0$。利用 Sturm–Liouville 理论和分离变量法的原理，推导出一个与这些边界条件兼容的在 $\\Omega$ 上的标准正交本征函数基，并确定拉普拉斯算子的相应本征值。\n\n假设系数为常数，并利用 $u$ 和 $f$ 在此基中的正交展开来表示展开系数之间的谱关系。然后，通过将 $-\\kappa \\Delta + \\mu$ 的逆视为一个在此基中对角化的卷积型算子，推导出将模式 $(k,\\ell)$ 下 $f$ 的系数映射到同一模式下 $u$ 的系数的闭式谱乘子 $m_{k,\\ell}$。最后，对于 $L_{x} = 2$，$L_{y} = 3$，$\\kappa = 0.5$ 和 $\\mu = 0.2$，计算 $m_{2,1}$ 的数值。将最终的数值系数表示为一个无量纲数，并将您的答案四舍五入到四位有效数字。\n\n在您的推导中，请清楚地说明如何将谱乘子整合到一个傅里叶神经算子（FNO, Fourier Neural Operator）层中，通过将标准的周期性傅里叶基替换为与边界条件兼容的正弦/余弦变换基，而不使用任何快捷公式，并从正交本征函数展开的基本定义和性质出发。\n\n### 第1步：问题验证\n\n**提取的已知条件：**\n- 偏微分方程：$-\\kappa \\Delta u + \\mu u = f$\n- 域：$\\Omega = (0,L_{x}) \\times (0,L_{y})$\n- 参数：$\\kappa > 0$, $\\mu \\ge 0$\n- 强迫项：$f \\in L^2(\\Omega)$\n- 边界条件：\n    - $u(0,y) = u(L_{x},y) = 0$ 对 $y \\in [0,L_{y}]$ （齐次狄利克雷）\n    - $\\partial_{y} u(x,0) = \\partial_{y} u(x,L_{y}) = 0$ 对 $x \\in [0,L_{x}]$ （齐次诺伊曼）\n- 用于最终计算的数值：$L_{x} = 2$， $L_{y} = 3$， $\\kappa = 0.5$， $\\mu = 0.2$。特定模式为 $(k,\\ell) = (2,1)$。\n\n**验证：**\n1.  **科学或事实上的不健全性**：问题在科学上是健全的。它描述了一个线性椭圆偏微分方程的标准边值问题（亥姆霍兹型方程），这是数学物理和工程学的基石。\n2.  **非形式化或不相关**：问题是高度形式化的，并且如明确所述，与多尺度偏微分方程的神经算子主题直接相关。\n3.  **不完整或矛盾的设置**：所有必要的数据，包括偏微分方程、域、参数和边界条件，都已提供且一致。\n4.  **不切实际或不可行**：物理和数学设置是标准的，完全可行。\n5.  **不适定或结构不良**：问题是适定的。对于给定的 $f \\in L^2(\\Omega)$，指定的椭圆边值问题具有唯一的弱解。问题的结构是合乎逻辑的，引导求解者从第一性原理到最终应用。\n6.  **伪深刻、琐碎或同义反复**：问题是实质性的，需要一个多步骤的推导，涉及分离变量法、Sturm-Liouville 理论、本征函数展开，以及在一个现代机器学习背景下的应用。\n7.  **超出科学可验证范围**：推导和结果完全可以通过标准的数学程序进行验证。\n\n**结论：**问题有效。\n\n### 第2步：求解推导\n\n按照要求，求解过程分为五个部分：（1）推导本征函数和本征值，（2）推导谱关系，（3）推导谱乘子，（4）计算特定数值，以及（5）解释与傅里叶神经算子的联系。\n\n**第1部分：拉普拉斯算子的本征函数和本征值**\n\n我们寻求负拉普拉斯算子 $-\\Delta$ 的本征函数 $\\phi(x,y)$ 和本征值 $\\lambda$，并满足给定的边界条件。本征值问题是：\n$$ -\\Delta \\phi = \\lambda \\phi \\quad \\text{on } \\Omega $$\n边界条件为：\n$$ \\phi(0,y) = \\phi(L_{x},y) = 0 $$\n$$ \\partial_{y} \\phi(x,0) = \\partial_{y} \\phi(x,L_{y}) = 0 $$\n我们使用分离变量法，假设解的形式为 $\\phi(x,y) = X(x)Y(y)$。将此代入本征值方程得到：\n$$ - (X''(x)Y(y) + X(x)Y''(y)) = \\lambda X(x)Y(y) $$\n除以 $X(x)Y(y)$ 可以分离变量：\n$$ -\\frac{X''(x)}{X(x)} - \\frac{Y''(y)}{Y(y)} = \\lambda $$\n令 $-\\frac{X''(x)}{X(x)} = \\lambda_{x}$ 和 $-\\frac{Y''(y)}{Y(y)} = \\lambda_{y}$，其中 $\\lambda = \\lambda_x + \\lambda_y$。这导致两个独立的一维 Sturm-Liouville 问题。\n\n**$X(x)$ 的问题：**\n常微分方程是 $X''(x) + \\lambda_x X(x) = 0$，在 $(0,L_x)$ 上。$\\phi$ 的边界条件意味着 $X(0)Y(y) = 0$ 和 $X(L_x)Y(y) = 0$。对于非平凡解（$Y(y) \\not\\equiv 0$），我们必须有 $X(0) = 0$ 和 $X(L_x) = 0$。\n对于 $\\lambda_x > 0$，通解为 $X(x) = A \\sin(\\sqrt{\\lambda_x} x) + B \\cos(\\sqrt{\\lambda_x} x)$。\n- $X(0)=0 \\implies B=0$。\n- $X(L_x)=0 \\implies A \\sin(\\sqrt{\\lambda_x} L_x) = 0$。\n对于非平凡解（$A \\neq 0$），我们必须有 $\\sqrt{\\lambda_x} L_x = k\\pi$，其中 $k$ 为整数。由于 $k=0$ 给出平凡解 $X(x)=0$，且负的 $k$ 值是多余的，所以我们有 $k = 1, 2, 3, \\ldots$。\n本征值为 $\\lambda_{x,k} = (\\frac{k\\pi}{L_x})^2$，其中 $k \\in \\{1, 2, 3, \\dots\\}$。\n相应的本征函数为 $X_k(x) = \\sin(\\frac{k\\pi x}{L_x})$。\n\n**$Y(y)$ 的问题：**\n常微分方程是 $Y''(y) + \\lambda_y Y(y) = 0$，在 $(0,L_y)$ 上。$\\phi$ 的边界条件意味着 $X(x)Y'(0)=0$ 和 $X(x)Y'(L_y)=0$。对于非平凡解（$X(x) \\not\\equiv 0$），我们必须有 $Y'(0) = 0$ 和 $Y'(L_y) = 0$。\n对于 $\\lambda_y > 0$，通解为 $Y(y) = C \\cos(\\sqrt{\\lambda_y} y) + D \\sin(\\sqrt{\\lambda_y} y)$。\n导数为 $Y'(y) = -C\\sqrt{\\lambda_y} \\sin(\\sqrt{\\lambda_y} y) + D\\sqrt{\\lambda_y} \\cos(\\sqrt{\\lambda_y} y)$。\n- $Y'(0)=0 \\implies D\\sqrt{\\lambda_y}=0 \\implies D=0$。\n- $Y'(L_y)=0 \\implies -C\\sqrt{\\lambda_y} \\sin(\\sqrt{\\lambda_y} L_y) = 0$。\n对于非平凡解（$C \\neq 0$），我们必须有 $\\sin(\\sqrt{\\lambda_y} L_y) = 0$，这意味着 $\\sqrt{\\lambda_y} L_y = \\ell\\pi$，其中 $\\ell$ 为整数。\n我们还必须考虑 $\\lambda_y=0$ 的情况。常微分方程变为 $Y''(y)=0$，通解为 $Y(y) = C_1 y + C_2$。导数为 $Y'(y) = C_1$。条件 $Y'(0)=0$ 和 $Y'(L_y)=0$ 都意味着 $C_1=0$。因此，$Y(y)=C_2$（一个常数）是对应于 $\\lambda_y=0$ 的有效本征函数。这种情况通过允许 $\\ell=0$ 自然地包含在通用公式中。\n本征值为 $\\lambda_{y,\\ell} = (\\frac{\\ell\\pi}{L_y})^2$，其中 $\\ell \\in \\{0, 1, 2, \\dots\\}$。\n相应的本征函数为 $Y_\\ell(y) = \\cos(\\frac{\\ell\\pi y}{L_y})$。\n\n**二维本征函数和本征值：**\n在 $\\Omega$ 上算子 $-\\Delta$ 的本征函数是 $X_k(x)Y_\\ell(y)$ 的乘积 $\\phi_{k,\\ell}(x,y)$：\n$$ \\phi_{k,\\ell}(x,y) = \\sin\\left(\\frac{k\\pi x}{L_x}\\right) \\cos\\left(\\frac{\\ell\\pi y}{L_y}\\right) $$\n对于整数索引 $k \\ge 1$ 和 $\\ell \\ge 0$。\n相应的本征值 $\\lambda_{k,\\ell}$ 是一维本征值的和：\n$$ \\lambda_{k,\\ell} = \\lambda_{x,k} + \\lambda_{y,\\ell} = \\left(\\frac{k\\pi}{L_x}\\right)^2 + \\left(\\frac{\\ell\\pi}{L_y}\\right)^2 $$\n\n**标准正交基：**\n为了创建一个标准正交基，我们用 $L^2$ 内积 $\\langle g, h \\rangle = \\int_0^{L_y} \\int_0^{L_x} g(x,y)h(x,y) \\,dx\\,dy$ 来归一化这些本征函数。\n$\\phi_{k,\\ell}$ 的范数平方是：\n$$ \\|\\phi_{k,\\ell}\\|^2 = \\left(\\int_0^{L_x} \\sin^2\\left(\\frac{k\\pi x}{L_x}\\right) dx\\right) \\left(\\int_0^{L_y} \\cos^2\\left(\\frac{\\ell\\pi y}{L_y}\\right) dy\\right) $$\n标准积分为 $\\int_0^L \\sin^2(\\frac{k\\pi x}{L}) dx = \\frac{L}{2}$（对于 $k \\ge 1$）和 $\\int_0^L \\cos^2(\\frac{\\ell\\pi y}{L}) dy = \\frac{L}{2}$（对于 $\\ell \\ge 1$）。对于 $\\ell=0$，$\\cos(0)=1$，所以 $\\int_0^{L_y} \\cos^2(0) dy = L_y$。\n- 对于 $\\ell \\ge 1$：$\\|\\phi_{k,\\ell}\\|^2 = (\\frac{L_x}{2})(\\frac{L_y}{2}) = \\frac{L_x L_y}{4}$。归一化常数为 $\\frac{2}{\\sqrt{L_x L_y}}$。\n- 对于 $\\ell = 0$：$\\|\\phi_{k,0}\\|^2 = (\\frac{L_x}{2})(L_y) = \\frac{L_x L_y}{2}$。归一化常数为 $\\sqrt{\\frac{2}{L_x L_y}}$。\n\n标准正交本征函数基，记为 $\\{\\psi_{k,\\ell}\\}$，是：\n$$ \\psi_{k,\\ell}(x,y) = \\begin{cases} \\sqrt{\\frac{2}{L_x L_y}} \\sin\\left(\\frac{k\\pi x}{L_x}\\right)  \\text{if } \\ell=0 \\\\ \\frac{2}{\\sqrt{L_x L_y}} \\sin\\left(\\frac{k\\pi x}{L_x}\\right) \\cos\\left(\\frac{\\ell\\pi y}{L_y}\\right)  \\text{if } \\ell \\ge 1 \\end{cases} $$\n对于 $k \\ge 1, \\ell \\ge 0$。\n\n**第2部分：谱关系**\n我们在标准正交基 $\\{\\psi_{k,\\ell}\\}$ 中展开解 $u(x,y)$ 和强迫项 $f(x,y)$：\n$$ u(x,y) = \\sum_{k=1}^{\\infty}\\sum_{\\ell=0}^{\\infty} \\hat{u}_{k,\\ell} \\psi_{k,\\ell}(x,y) $$\n$$ f(x,y) = \\sum_{k=1}^{\\infty}\\sum_{\\ell=0}^{\\infty} \\hat{f}_{k,\\ell} \\psi_{k,\\ell}(x,y) $$\n其中系数通过投影得到：$\\hat{u}_{k,\\ell} = \\langle u, \\psi_{k,\\ell} \\rangle$ 和 $\\hat{f}_{k,\\ell} = \\langle f, \\psi_{k,\\ell} \\rangle$。\n将这些展开式代入偏微分方程 $-\\kappa \\Delta u + \\mu u = f$：\n$$ -\\kappa \\Delta \\left(\\sum_{k,\\ell} \\hat{u}_{k,\\ell} \\psi_{k,\\ell}\\right) + \\mu \\left(\\sum_{k,\\ell} \\hat{u}_{k,\\ell} \\psi_{k,\\ell}\\right) = \\sum_{k,\\ell} \\hat{f}_{k,\\ell} \\psi_{k,\\ell} $$\n利用算子的线性和 $-\\Delta \\psi_{k,\\ell} = \\lambda_{k,\\ell} \\psi_{k,\\ell}$ 这一事实：\n$$ \\sum_{k,\\ell} \\left( \\kappa \\lambda_{k,\\ell} \\hat{u}_{k,\\ell} + \\mu \\hat{u}_{k,\\ell} \\right) \\psi_{k,\\ell} = \\sum_{k,\\ell} \\hat{f}_{k,\\ell} \\psi_{k,\\ell} $$\n根据基函数的正交性，我们可以将每个模式 $(k,\\ell)$ 的系数相等：\n$$ (\\kappa \\lambda_{k,\\ell} + \\mu) \\hat{u}_{k,\\ell} = \\hat{f}_{k,\\ell} $$\n这就是解和强迫项的展开系数之间的谱关系。\n\n**第3部分：谱乘子**\n谱乘子 $m_{k,\\ell}$ 定义为将输入 $f$ 的系数映射到输出 $u$ 的系数的因子，即 $\\hat{u}_{k,\\ell} = m_{k,\\ell} \\hat{f}_{k,\\ell}$。从上面的谱关系，我们可以直接确定 $m_{k,\\ell}$：\n$$ m_{k,\\ell} = \\frac{1}{\\kappa \\lambda_{k,\\ell} + \\mu} $$\n代入本征值 $\\lambda_{k,\\ell}$ 的表达式：\n$$ m_{k,\\ell} = \\frac{1}{\\kappa \\left[ \\left(\\frac{k\\pi}{L_x}\\right)^2 + \\left(\\frac{\\ell\\pi}{L_y}\\right)^2 \\right] + \\mu} $$\n\n**第4部分：数值计算**\n我们被要求计算 $m_{2,1}$，给定参数 $L_x = 2$, $L_y = 3$, $\\kappa = 0.5$, 和 $\\mu = 0.2$。模式是 $(k,\\ell) = (2,1)$。\n$$ m_{2,1} = \\frac{1}{(0.5) \\left[ \\left(\\frac{2\\pi}{2}\\right)^2 + \\left(\\frac{1\\pi}{3}\\right)^2 \\right] + 0.2} $$\n$$ m_{2,1} = \\frac{1}{0.5 \\left[ \\pi^2 + \\frac{\\pi^2}{9} \\right] + 0.2} $$\n$$ m_{2,1} = \\frac{1}{0.5 \\left[ \\frac{9\\pi^2 + \\pi^2}{9} \\right] + 0.2} $$\n$$ m_{2,1} = \\frac{1}{0.5 \\left( \\frac{10\\pi^2}{9} \\right) + 0.2} $$\n$$ m_{2,1} = \\frac{1}{\\frac{5\\pi^2}{9} + 0.2} $$\n现在，我们计算数值：\n$$ m_{2,1} = \\frac{1}{\\frac{5 \\times (9.8696044...)}{9} + 0.2} = \\frac{1}{5.4831135... + 0.2} = \\frac{1}{5.6831135...} \\approx 0.1759600... $$\n四舍五入到四位有效数字，我们得到 $0.1760$。\n\n**第5部分：与傅里叶神经算子 (FNO) 的联系**\n上述推导表明，对于偏微分方程 $-\\kappa\\Delta u + \\mu u = f$，解算子 $\\mathcal{G}: f \\mapsto u$ 在由本征函数 $\\{\\psi_{k,\\ell}\\}$ 定义的谱域中表现为简单的乘法。这意味着 $\\mathcal{G}$ 是一个卷积型算子，它被推导出的正弦-余弦函数基对角化。这个对角线上的值正是谱乘子 $m_{k,\\ell}$。\n\n傅里叶神经算子 (FNO) 是一种设计用来学习这类解算子的神经网络架构。标准的 FNO 在周期性边界条件下工作，其拉普拉斯算子的本征函数是复指数 $\\{e^{i \\mathbf{k} \\cdot \\mathbf{x}}\\}$。到这个谱基的转换和从这个谱基的转换是傅里叶变换，通过快速傅里叶变换 (FFT) 高效实现。\n\n为了将 FNO 架构应用于本问题中的非周期性边界条件，必须将标准傅里叶基替换为特定于问题的本征基。一个用于学习此问题算子的通用 FNO 层的过程如下：\n\n1.  **输入**：该层接收一个在网格上离散化的输入函数 $v(x,y)$。\n2.  **正变换**：不应用 FFT，而是应用一个将输入 $v$ 投影到推导出的本征基上的二维变换。这在实践中通过沿 $x$ 维执行离散正弦变换 (DST) 和沿 $y$ 维执行离散余弦变换 (DCT) 来实现。我们将这个组合变换表示为 $\\mathcal{T}$。此步骤计算谱系数 $\\hat{v}_{k,\\ell} = (\\mathcal{T}(v))_{k,\\ell}$。\n3.  **谱域乘法（学习核）**：在谱域中，与一组可学习的参数（权重）$R_{k,\\ell}$ 进行逐点乘法。这些参数是神经网络对真实谱乘子的近似。FNO 通常将级数截断到最大模式数 $(k_{\\max}, \\ell_{\\max})$。\n    $$ (\\widehat{K(v)})_{k,\\ell} = R_{k,\\ell} \\cdot \\hat{v}_{k,\\ell} \\quad \\text{for } 1 \\le k \\le k_{\\max}, \\, 0 \\le \\ell \\le \\ell_{\\max} $$\n    FNO 的核心思想是 $R_{k,\\ell}$ 可以通过反向传播来学习，使网络能够近似任何类似算子的响应，而不仅仅是具有此处推导的特定 $\\kappa$ 和 $\\mu$ 的算子。\n4.  **逆变换**：对修改后的系数应用逆变换 $\\mathcal{T}^{-1}$（由逆 DST 和逆 DCT 组成），将结果返回到物理域。\n    $$ K(v)(x,y) = \\mathcal{T}^{-1}\\left(R \\cdot \\hat{v}\\right)(x,y) $$\n5.  **局部路径和激活**：如同在标准残差网络中一样，添加输入的局部线性变换（例如，作为 $1 \\times 1$ 卷积实现的逐点线性层，$Wv$）并应用非线性激活函数 $\\sigma$。\n    $$ v_{\\text{out}}(x,y) = \\sigma(K(v)(x,y) + Wv(x,y)) $$\n\n通过选择能够对角化底层微分算子的变换 $\\mathcal{T}$，FNO 被提供了学习解算子的最有效表示。可学习的滤波器 $R_{k,\\ell}$ 只需要学习一个对角算子，这比在一个非最优基（例如对于这个非周期性问题使用标准傅里叶基）中学习一个完整的、稠密的算子要参数效率高得多，也更容易训练。",
            "answer": "$$ \\boxed{0.1760} $$"
        },
        {
            "introduction": "为多尺度问题训练深度神经算子可能因数值不稳定性等问题而充满挑战。本实践侧重于诊断和纠正此类不稳定性的关键技能。在此练习  中，您将分析一个以解的索博列夫范数（Sobolev norm）不受控制地增长为特征的不稳定训练场景。您将探索有原则的诊断方法和有效的架构修正，例如去混叠（dealiasing）和适当的归一化，这些对于开发稳健可靠的神经算子至关重要。",
            "id": "3787624",
            "problem": "考虑一个傅里叶神经算子（FNO）层，它作用于一个在$d$维环面$\\Omega = [0,2\\pi]^d$上的周期场，该场在一个包含$N^d$个点的均匀网格上被离散化。令$\\mathcal{F}$表示离散傅里叶变换，令$u^\\ell$表示第$\\ell$层的隐藏场。一个典型的FNO层可以写成$u^{\\ell+1} = \\sigma\\!\\left(\\mathcal{F}^{-1}\\!\\left(M^\\ell \\cdot \\mathcal{F}u^\\ell\\right) + S^\\ell u^\\ell + b^\\ell\\right)$，其中$M^\\ell$是一个学习到的复值谱乘子，其作用范围被限制在模式$\\{k \\in \\mathbb{Z}^d: |k| \\le k_{\\max}\\}$内，$S^\\ell$是一个在物理空间中学习到的局部线性算子，$b^\\ell$是一个偏置，$\\sigma$是一个逐点非线性函数。索博列夫空间$H^1(\\Omega)$的范数定义为$\\|u\\|_{H^1}^2 = \\int_\\Omega \\left(|u(x)|^2 + |\\nabla u(x)|^2\\right)\\,dx$，根据帕塞瓦尔恒等式，这等价于$\\|u\\|_{H^1}^2 = \\sum_{k \\in \\mathbb{Z}^d} \\left(1+|k|^2\\right)\\,|u_k|^2$，其中$u_k$是傅里叶系数。假设该网络被训练用于在一个在多个尺度上表现出显著能量的输入上，近似一个多尺度偏微分方程到解的算子$u_\\theta$。\n\n在实践中，物理空间中的逐点非线性$\\sigma$会产生高频内容，其傅里叶支撑集超出了谱截断范围$\\{|k|\\le k_{\\max}\\}$；因此，将其投影回截断谱可能会引起混叠。此外，激进的谱乘子和未归一化的残差路径可能导致$\\|u^\\ell\\|_{H^1}$的逐层增长，这与多尺度动力学的学习离散化中的不稳定性有关。你的任务是设计一个诊断测试，利用$\\|u^\\ell\\|_{H^1}$在各层间的增长行为来检测不稳定性，并提出一个修正性的架构修改，以一种与稳定多尺度建模相一致的方式直接解决混叠和/或归一化问题。\n\n假设你在一个代表性的验证集上观察到，逐层增长因子$r_\\ell = \\|u^{\\ell+1}\\|_{H^1}/\\|u^\\ell\\|_{H^1}$在一系列层中满足$r_\\ell \\approx 1.25$，并且在应用$\\sigma$后，高频带$B = \\{k: 2k_{\\max}/3  |k| \\le k_{\\max}\\}$中的$H^1$加权谱能量的比例超过$0.3$。从第一性原理出发，定义一个适用于FNO类别和多尺度偏微分方程设置的诊断和修正性修改。\n\n选择所有正确指定了基于$\\|u^\\ell\\|_{H^1}$增长的合理诊断和有效的修正性架构修改的选项。\n\nA. 诊断：在验证输入上计算$r_\\ell = \\|u^{\\ell+1}\\|_{H^1}/\\|u^\\ell\\|_{H^1}$，如果几何平均值$\\left(\\prod_{\\ell=0}^{L-1} r_\\ell\\right)^{1/L}$超过一个大于$1$的阈值，则标记为不稳定。修正：引入2/3规则去混叠，即在应用逐点非线性之前，在每个维度上对场进行零填充至大小$3N/2$，然后进行低通滤波并截断回$N$，并插入一个逐层索博列夫归一化，通过$\\alpha_\\ell$重缩放$u^{\\ell+1} \\leftarrow \\alpha_\\ell u^{\\ell+1}$，使得$\\|u^{\\ell+1}\\|_{H^1} \\le \\beta \\|u^\\ell\\|_{H^1}$对于预定的$\\beta \\approx 1$成立。\n\nB. 诊断：仅监控各层间的$L^2(\\Omega)$范数$\\|u^\\ell\\|_{L^2}$，如果$\\|u^\\ell\\|_{L^2}$单调增长，则标记为不稳定。修正：在每次非线性操作后，在物理空间应用批归一化，不对$M^\\ell$进行任何谱滤波或约束。\n\nC. 诊断：跟踪各层间的$\\max_{k} |u_k^\\ell|$，如果它增加，则标记为不稳定。修正：增加截断带宽$k_{\\max}$，同时保持非线性和层缩放不变。\n\nD. 诊断：对于每一层，通过在验证输入上使用幂迭代法，估计层映射关于$H^1$内积的弗雷歇导数的最大奇异值（谱半径）；如果该估计值超过$1$，则标记为不稳定。修正：对谱乘子和残差路径施加谱归一化，以将$H^1$中的整体利普希茨常数严格限制在$1$以下（例如，重缩放$M^\\ell$和$S^\\ell$，使得从$H^1$到$H^1$的诱导算子范数小于$1$），确保在$H^1$中逐层收缩。",
            "solution": "该问题要求为傅里叶神经算子（FNO）设计一个用于检测不稳定性的诊断测试和相应的修正性架构修改。这种不稳定性的特征是隐藏场的索博列夫$H^1$范数逐层增长，其潜在原因被确定为逐点非线性引起的混叠以及层更新中线性算子引起的放大。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **模型：** 作用于周期域$\\Omega = [0,2\\pi]^d$上的傅里叶神经算子（FNO）层。\n- **离散化：** 均匀网格，$N^d$个点。\n- **层更新规则：** $u^{\\ell+1} = \\sigma\\!\\left(\\mathcal{F}^{-1}\\!\\left(M^\\ell \\cdot \\mathcal{F}u^\\ell\\right) + S^\\ell u^\\ell + b^\\ell\\right)$。\n- **变量与算子：**\n    - $u^\\ell$：第$\\ell$层的隐藏场。\n    - $\\mathcal{F}$：离散傅里叶变换。\n    - $M^\\ell$：学习到的谱乘子，对模式$|k| \\le k_{\\max}$非零。\n    - $S^\\ell$：学习到的局部线性算子。\n    - $b^\\ell$：偏置项。\n    - $\\sigma$：逐点非线性函数。\n- **索博列夫$H^1$范数：** 定义为$\\|u\\|_{H^1}^2 = \\sum_{k \\in \\mathbb{Z}^d} \\left(1+|k|^2\\right)\\,|u_k|^2$，其中$u_k$是傅里叶系数。\n- **背景：** 近似一个多尺度偏微分方程解算子。\n- **观察到的现象：**\n    1. 逐层$H^1$范数增长因子$r_\\ell = \\|u^{\\ell+1}\\|_{H^1}/\\|u^\\ell\\|_{H^1} \\approx 1.25$。\n    2. 应用$\\sigma$后，高频带$B = \\{k: 2k_{\\max}/3  |k| \\le k_{\\max}\\}$中的$H^1$加权谱能量比例超过$0.3$。\n- **任务：** 基于这些观察和第一性原理，定义一个诊断和修正性修改。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述在科学上是合理的、良定的和客观的。\n- **科学基础：** 该问题植根于偏微分方程数值分析（伪谱法、稳定性、混叠）、泛函分析（索博列夫空间）和深度学习（神经算子、训练不稳定性）的既定原则。FNO架构、使用$H^1$范数处理偏微分方程解以及通过逐点乘法产生混叠的机制都是标准概念。\n- **良定性与一致性：** 问题是良定的。它提供了具体的定量观察（$r_\\ell \\approx 1.25$，能量集中），并要求评估所提出的诊断/修正对。所提供的信息内部一致：大于$1$的增长因子标志着不稳定性，特定高频带中的能量集中指向混叠，这是数值伪影和不稳定性的一个已知原因。\n- **客观性与清晰度：** 问题使用了来自数学和计算机科学的精确、标准的术语。没有模糊性或对主观说法的依赖。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。我将继续进行选项的推导和分析。\n\n### 推导与选项分析\n\n核心问题是不稳定性，其证据是$H^1$范数在各层间的指数级增长（$r_\\ell \\approx 1.25 > 1$）。这种增长会导致激活值和梯度爆炸，阻碍成功训练。一个有效的解决方案必须解决其根本原因：层算子的放大作用和混叠可能导致的误差累积。\n\n**选项 A 分析**\n- **诊断：** “在验证输入上计算$r_\\ell = \\|u^{\\ell+1}\\|_{H^1}/\\|u^\\ell\\|_{H^1}$，如果几何平均值$\\left(\\prod_{\\ell=0}^{L-1} r_\\ell\\right)^{1/L}$超过一个大于$1$的阈值，则标记为不稳定。”\n  该诊断直接测量了$H^1$范数的平均逐层增长。由于观察到的增长因子是$r_\\ell \\approx 1.25$，几何平均值将约为$1.25$，大于$1$，从而正确地将网络标记为不稳定。这是一种直接、经验性且合理的诊断方法。\n- **修正：** “引入2/3规则去混叠，即在应用逐点非线性之前，在每个维度上对场进行零填充至大小$3N/2$，然后进行低通滤波并截断回$N$，并插入一个逐层索博列夫归一化，通过$\\alpha_\\ell$重缩放$u^{\\ell+1} \\leftarrow \\alpha_\\ell u^{\\ell+1}$，使得$\\|u^{\\ell+1}\\|_{H^1} \\le \\beta \\|u^\\ell\\|_{H^1}$对于预定的$\\beta \\approx 1$成立。”\n  这个修正包含两个部分。\n  1.  **去混叠：** 物理空间中的逐点非线性$\\sigma(u)$对应于傅里叶空间中的卷积，这可以产生高达$k_{\\max}$倍数的频率。在频带$\\{k: 2k_{\\max}/3  |k| \\le k_{\\max}\\}$中观察到显著能量，强烈表明来自类二次相互作用的混叠是一个问题。所描述的程序是标准的**2/3规则**去混叠，这是伪谱法中一种经典且有效的技术，可以防止二次非线性造成的混叠污染。这直接且恰当地解决了混叠问题。\n  2.  **归一化：** 对层输出$u^{\\ell+1}$进行显式重缩放，以强制执行条件$\\|u^{\\ell+1}\\|_{H^1} \\le \\beta \\|u^\\ell\\|_{H^1}$（其中$\\beta \\approx 1$），直接抵消了观察到的范数爆炸。这种“强制”归一化通过防止逐层放大来保证稳定性。使用$\\beta \\approx 1$可以在不过度限制的情况下提供稳定性。\n  这种双管齐下的修正有效地解决了混叠和放大两个问题。\n- **结论：** 正确。该诊断是合理的，其修正性修改是成熟、有效的，并且直接针对问题陈述中描述的现象。\n\n**选项 B 分析**\n- **诊断：** “仅监控各层间的$L^2(\\Omega)$范数$\\|u^\\ell\\|_{L^2}$，如果$\\|u^\\ell\\|_{L^2}$单调增长，则标记为不稳定。”\n  $H^1$范数包含导数（在傅里叶域中有$|k|^2$权重），使其对高频不稳定性敏感。一个函数的$L^2$范数可以保持有界，而其$H^1$范数爆炸，这对应于解变得高度振荡且其导数爆炸。对于偏微分方程建模，控制导数对于稳定性和准确性至关重要。因此，仅监控$L^2$范数是一个不充分的诊断。\n- **修正：** “在每次非线性操作后，在物理空间应用批归一化，不对$M^\\ell$进行任何谱滤波或约束。”\n  标准批归一化在批次中逐点地对特征的均值和方差进行归一化。它并非设计用于控制像$H^1$这样涉及导数的函数空间范数。它对解决傅里叶域中的混叠问题毫无作用，也无法直接约束谱算子$M^\\ell$的放大特性。这是一种通用的启发式方法，而不是针对此问题特定不稳定机制的定向修复。\n- **结论：** 不正确。诊断和修正对于问题背景来说都不充分。\n\n**选项 C 分析**\n- **诊断：** “跟踪各层间的$\\max_{k} |u_k^\\ell|$，如果它增加，则标记为不稳定。”\n  解的整体稳定性和能量是由一个积分量（如范数，例如$\\|u\\|_{H^1}^2 = \\sum_k (1+|k|^2)|u_k|^2$）来捕捉的，而不是单个傅里叶系数的大小。能量可以分布在许多模式上，即使$\\max_k |u_k^\\ell|$不增加，也会导致范数增长。这个诊断不是衡量整体稳定性的可靠指标。\n- **修正：** “增加截断带宽$k_{\\max}$，同时保持非线性和层缩放不变。”\n  这个修正是被误导的。虽然增加$k_{\\max}$为表示非线性产生的高频内容提供了更多模式，但它没有解决放大的核心问题。不稳定的算子$M^\\ell$和$S^\\ell$现在将作用于更大数量的模式，可能会加剧不稳定性并增加计算成本。它未能解决放大的根本原因，即层的算子范数大于$1$。\n- **结论：** 不正确。诊断是一个较差的度量，而修正无效且可能有害。\n\n**选项 D 分析**\n- **诊断：** “对于每一层，通过在验证输入上使用幂迭代法，估计层映射关于$H^1$内积的弗雷歇导数的最大奇异值（谱半径）；如果该估计值超过$1$，则标记为不稳定。”\n  这是一个根本上合理且精密的诊断。层更新$u^{\\ell+1} = \\mathcal{G}(u^\\ell)$可以看作一个离散时间动力系统。其在点$u^\\ell$处的局部稳定性由其弗雷歇导数$\\mathcal{G}'(u^\\ell)$的算子范数（和谱半径）决定。在$H^1$空间中大于$1$的算子范数意味着该范数下扰动的局部放大，从而导致不稳定性。幂迭代法是估计最大奇异值的标准数值方法。这个诊断在理论上是严谨的。\n- **修正：** “对谱乘子和残差路径施加谱归一化，以将$H^1$中的整体利普希茨常数严格限制在$1$以下（例如，重缩放$M^\\ell$和$S^\\ell$，使得从$H^1$到$H^1$的诱导算子范数小于$1$），确保在$H^1$中逐层收缩。”\n  这个修正直接针对放大的原因。通过确保每一层在相关函数空间（$H^1$）中都是一个压缩映射，即其利普希茨常数小于$1$，整个网络的稳定性就得到了保证。压缩映射的复合仍是压缩映射，防止了任何指数增长的可能性。这是一种非常有原则且有效的方法来确保稳定性。虽然它没有显式地执行去混叠，但强制严格的$H^1$收缩会隐式地惩罚和抑制任何导致$H^1$范数失控增长的机制，包括混叠。所提出的方法以一种强有力的方式正确地解决了问题的“归一化”方面。\n- **结论：** 正确。该选项提供了一个理论上严谨的诊断和一个强有力的、有原则的修正措施，可以保证稳定性。\n\n选项A和D都为问题提供了有效且可行的解决方案。选项A是一个务实的、以工程为中心的解决方案，直接利用了提示中提供的具体数据。选项D是一个更抽象、基于数学原理的解决方案，基于算子理论。对于所述任务，两者都是正确的策略。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}