{
    "hands_on_practices": [
        {
            "introduction": "The fundamental idea of the Multiscale Finite Element Method (MsFEM) is to embed fine-scale information about the medium directly into the coarse-scale basis functions. This practice provides a direct, quantitative comparison between a standard Finite Element Method (FEM) basis and a multiscale basis by examining their effect on the stiffness matrix. By calculating and comparing the stiffness matrix entries, you will gain a concrete understanding of how MsFEM captures the effective, or 'upscaled,' properties of a heterogeneous material, a feature that standard linear elements miss .",
            "id": "3746099",
            "problem": "Consider the one-dimensional diffusion problem on the domain $\\Omega=(0,2)$ with a two-element coarse mesh, whose coarse nodes are $x_0=0$, $x_1=1$, and $x_2=2$. Let the diffusion coefficient $\\kappa(x)$ be piecewise constant, defined by\n$\\kappa(x)=1$ for $x\\in(0,\\frac{1}{2})\\cup(\\frac{3}{2},2)$ and $\\kappa(x)=100$ for $x\\in(\\frac{1}{2},1)\\cup(1,\\frac{3}{2})$. Assume all quantities are dimensionless.\n\nDefine the standard Finite Element Method (FEM) using the piecewise linear \"hat\" basis functions $\\{\\phi_0,\\phi_1,\\phi_2\\}$ on the coarse mesh. Define the Multiscale Finite Element Method (MsFEM) as follows: on each coarse element $\\Omega_e=(x_{e-1},x_e)$, construct local basis functions by solving the local homogeneous equation $-(\\kappa(x)\\,\\psi'(x))'=0$ on $\\Omega_e$ subject to Dirichlet boundary conditions that interpolate the coarse nodal values, and assemble the global multiscale basis functions $\\{\\Phi_0,\\Phi_1,\\Phi_2\\}$ by patching these local solutions in the standard way for a conforming method.\n\nFor each method, the global stiffness matrix has entries $K_{ij}=\\int_{\\Omega}\\kappa(x)\\,\\psi_i'(x)\\,\\psi_j'(x)\\,dx$, where $\\{\\psi_i\\}$ stands for the corresponding global basis $\\{\\phi_i\\}$ or $\\{\\Phi_i\\}$. Compute the assembled matrices for both methods and quantify the upscaling effect by computing the ratio\n$R=\\dfrac{K_{11}^{\\mathrm{MsFEM}}}{K_{11}^{\\mathrm{FEM}}}$,\nwhere $K_{11}$ is the middle diagonal entry associated with the interior node $x_1=1$.\n\nReport the single scalar ratio $R$ as a simplified exact expression. If you choose to approximate, round your answer to four significant figures.",
            "solution": "The user has requested the computation of a ratio of stiffness matrix entries from a standard Finite Element Method (FEM) and a Multiscale Finite Element Method (MsFEM) for a one-dimensional diffusion problem.\n\nFirst, the problem is validated.\n**Step 1: Extract Givens**\n- Domain: $\\Omega=(0,2)$.\n- Coarse mesh nodes: $x_0=0$, $x_1=1$, $x_2=2$.\n- Coarse elements: $\\Omega_1=(0,1)$, $\\Omega_2=(1,2)$.\n- Diffusion coefficient: $\\kappa(x)=1$ for $x\\in(0,\\frac{1}{2})\\cup(\\frac{3}{2},2)$ and $\\kappa(x)=100$ for $x\\in(\\frac{1}{2},1)\\cup(1,\\frac{3}{2})$.\n- Standard FEM basis: Piecewise linear \"hat\" functions $\\{\\phi_0, \\phi_1, \\phi_2\\}$ on the coarse mesh.\n- MsFEM basis construction: Local basis functions are solutions to $-(\\kappa(x)\\,\\psi'(x))'=0$ on each coarse element $\\Omega_e$ with Dirichlet boundary conditions that interpolate coarse nodal values.\n- Stiffness matrix definition: $K_{ij}=\\int_{\\Omega}\\kappa(x)\\,\\psi_i'(x)\\,\\psi_j'(x)\\,dx$.\n- Target quantity: The ratio $R=\\dfrac{K_{11}^{\\mathrm{MsFEM}}}{K_{11}^{\\mathrm{FEM}}}$.\n\n**Step 2: Validate Using Extracted Givens**\n- The problem is **scientifically grounded** as it pertains to the numerical analysis of partial differential equations, specifically the diffusion equation, using well-established methods like FEM and MsFEM.\n- The problem is **well-posed**. All necessary information (domain, mesh, coefficients, basis function definitions) is provided to uniquely determine the stiffness matrices and their ratio.\n- The problem is **objective**, stated using precise mathematical definitions without ambiguity or subjective claims.\n- The problem does not violate any of the invalidity criteria. It is a canonical example used to illustrate the principles of multiscale methods.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n**Part 1: Standard FEM Stiffness Matrix Entry $K_{11}^{\\mathrm{FEM}}$**\nThe basis function associated with the interior node $x_1=1$ is the standard piecewise linear \"hat\" function $\\phi_1(x)$, defined as:\n$$\n\\phi_1(x) =\n\\begin{cases}\nx  \\text{for } x \\in [0, 1] \\\\\n2-x  \\text{for } x \\in [1, 2] \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe derivative of $\\phi_1(x)$ is:\n$$\n\\phi_1'(x) =\n\\begin{cases}\n1  \\text{for } x \\in (0, 1) \\\\\n-1  \\text{for } x \\in (1, 2)\n\\end{cases}\n$$\nThe stiffness matrix entry $K_{11}^{\\mathrm{FEM}}$ is defined as $K_{11}^{\\mathrm{FEM}} = \\int_{\\Omega} \\kappa(x) (\\phi_1'(x))^2 \\, dx$. Since $(\\phi_1'(x))^2 = 1$ for all $x \\in (0, 2)$ where the derivative is defined, the integral becomes:\n$$\nK_{11}^{\\mathrm{FEM}} = \\int_{0}^{2} \\kappa(x) \\, dx\n$$\nWe compute this integral by splitting it according to the piecewise definition of $\\kappa(x)$:\n$$\nK_{11}^{\\mathrm{FEM}} = \\int_{0}^{1/2} 1 \\, dx + \\int_{1/2}^{1} 100 \\, dx + \\int_{1}^{3/2} 100 \\, dx + \\int_{3/2}^{2} 1 \\, dx\n$$\n$$\nK_{11}^{\\mathrm{FEM}} = 1 \\cdot \\left(\\frac{1}{2} - 0\\right) + 100 \\cdot \\left(1 - \\frac{1}{2}\\right) + 100 \\cdot \\left(\\frac{3}{2} - 1\\right) + 1 \\cdot \\left(2 - \\frac{3}{2}\\right)\n$$\n$$\nK_{11}^{\\mathrm{FEM}} = \\frac{1}{2} + 100 \\cdot \\frac{1}{2} + 100 \\cdot \\frac{1}{2} + \\frac{1}{2} = \\frac{1}{2} + 50 + 50 + \\frac{1}{2} = 101\n$$\n\n**Part 2: MsFEM Basis Function $\\Phi_1(x)$ and Stiffness Entry $K_{11}^{\\mathrm{MsFEM}}$**\nThe multiscale basis function $\\Phi_1(x)$ is constructed by patching together local solutions on each coarse element. It must satisfy the nodal values $\\Phi_1(0)=0$, $\\Phi_1(1)=1$, and $\\Phi_1(2)=0$.\n\nOn the first coarse element $\\Omega_1 = (0, 1)$, the local function $\\psi_1(x)$ solves $-(\\kappa(x)\\psi_1'(x))'=0$ with boundary conditions $\\psi_1(0)=0$ and $\\psi_1(1)=1$.\nIntegrating the differential equation once yields $\\kappa(x)\\psi_1'(x) = C_1$ for some constant $C_1$. Thus, $\\psi_1'(x) = \\frac{C_1}{\\kappa(x)}$.\nIntegrating again from $0$ to $x$: $\\psi_1(x) - \\psi_1(0) = \\int_0^x \\frac{C_1}{\\kappa(\\xi)} d\\xi$.\nUsing $\\psi_1(0)=0$, we have $\\psi_1(x) = C_1 \\int_0^x \\frac{1}{\\kappa(\\xi)} d\\xi$.\nApplying the other boundary condition, $\\psi_1(1)=1$:\n$$\n1 = C_1 \\int_0^1 \\frac{1}{\\kappa(x)} dx\n$$\nThe integral is the harmonic average length: $\\int_0^1 \\frac{1}{\\kappa(x)} dx = \\int_0^{1/2} \\frac{1}{1} dx + \\int_{1/2}^1 \\frac{1}{100} dx = \\frac{1}{2} + \\frac{1}{200} = \\frac{101}{200}$.\nSo, $1 = C_1 \\frac{101}{200}$, which implies $C_1 = \\frac{200}{101}$.\nThe derivative on $\\Omega_1$ is $\\Phi_1'(x) = \\psi_1'(x) = \\frac{200}{101 \\kappa(x)}$ for $x \\in (0, 1)$.\n\nOn the second coarse element $\\Omega_2 = (1, 2)$, the local function $\\psi_2(x)$ solves $-(\\kappa(x)\\psi_2'(x))'=0$ with boundary conditions $\\psi_2(1)=1$ and $\\psi_2(2)=0$.\nSimilarly, $\\kappa(x)\\psi_2'(x) = C_2$, so $\\psi_2'(x) = \\frac{C_2}{\\kappa(x)}$.\nIntegrating from $1$ to $x$: $\\psi_2(x) - \\psi_2(1) = \\int_1^x \\frac{C_2}{\\kappa(\\xi)} d\\xi$.\nUsing $\\psi_2(1)=1$, we have $\\psi_2(x) = 1 + C_2 \\int_1^x \\frac{1}{\\kappa(\\xi)} d\\xi$.\nApplying $\\psi_2(2)=0$: $0 = 1 + C_2 \\int_1^2 \\frac{1}{\\kappa(x)} dx$.\nThe integral is $\\int_1^2 \\frac{1}{\\kappa(x)} dx = \\int_1^{3/2} \\frac{1}{100} dx + \\int_{3/2}^2 \\frac{1}{1} dx = \\frac{1}{200} + \\frac{1}{2} = \\frac{101}{200}$.\nSo, $0 = 1 + C_2 \\frac{101}{200}$, which implies $C_2 = -\\frac{200}{101}$.\nThe derivative on $\\Omega_2$ is $\\Phi_1'(x) = \\psi_2'(x) = -\\frac{200}{101 \\kappa(x)}$ for $x \\in (1, 2)$.\n\nNow we compute the stiffness entry $K_{11}^{\\mathrm{MsFEM}}$:\n$$\nK_{11}^{\\mathrm{MsFEM}} = \\int_{0}^{2} \\kappa(x) (\\Phi_1'(x))^2 \\, dx = \\int_{0}^{1} \\kappa(x) (\\Phi_1'(x))^2 \\, dx + \\int_{1}^{2} \\kappa(x) (\\Phi_1'(x))^2 \\, dx\n$$\nFor the first integral on $\\Omega_1$:\n$$\n\\int_{0}^{1} \\kappa(x) \\left(\\frac{200}{101 \\kappa(x)}\\right)^2 dx = \\left(\\frac{200}{101}\\right)^2 \\int_{0}^{1} \\frac{1}{\\kappa(x)} dx = \\left(\\frac{200}{101}\\right)^2 \\left(\\frac{101}{200}\\right) = \\frac{200}{101}\n$$\nFor the second integral on $\\Omega_2$:\n$$\n\\int_{1}^{2} \\kappa(x) \\left(-\\frac{200}{101 \\kappa(x)}\\right)^2 dx = \\left(\\frac{200}{101}\\right)^2 \\int_{1}^{2} \\frac{1}{\\kappa(x)} dx = \\left(\\frac{200}{101}\\right)^2 \\left(\\frac{101}{200}\\right) = \\frac{200}{101}\n$$\nSumming the contributions:\n$$\nK_{11}^{\\mathrm{MsFEM}} = \\frac{200}{101} + \\frac{200}{101} = \\frac{400}{101}\n$$\n\n**Part 3: The Ratio R**\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{K_{11}^{\\mathrm{MsFEM}}}{K_{11}^{\\mathrm{FEM}}} = \\frac{400/101}{101} = \\frac{400}{101^2}\n$$\nCalculating $101^2$:\n$$\n101^2 = (100 + 1)^2 = 100^2 + 2 \\cdot 100 \\cdot 1 + 1^2 = 10000 + 200 + 1 = 10201\n$$\nSo, the exact ratio is:\n$$\nR = \\frac{400}{10201}\n$$\nThis fraction is irreducible as $400 = 2^4 \\cdot 5^2$ and $101$ is a prime number.",
            "answer": "$$\\boxed{\\frac{400}{10201}}$$"
        },
        {
            "introduction": "While the previous exercise demonstrated how multiscale basis functions alter the system matrix, this practice explores the ultimate consequence: improved accuracy. You will implement a comparison between the standard FEM and MsFEM for a high-contrast problem, a scenario where standard methods often perform poorly unless the mesh resolves all fine-scale features. By computing the exact solution and comparing the energy-norm error of both approximations, you will witness firsthand the superior ability of harmonically-weighted basis functions to capture complex solution behavior and reduce approximation errors .",
            "id": "3746076",
            "problem": "Consider the one-dimensional, second-order, linear elliptic boundary value problem\n$$\n-(\\kappa(x)\\,u'(x))' = f(x), \\quad x \\in (0,1), \\quad u(0)=0, \\quad u(1)=0,\n$$\nwhere the coefficient is piecewise constant with a high-contrast interface,\n$$\n\\kappa(x)=\\begin{cases}\n1,  x\\in(0,1/2),\\\\\n\\epsilon,  x\\in(1/2,1),\n\\end{cases}\n$$\nand the source term is constant, $f(x)=1$. The goal is to quantify the error of two coarse-scale approximations on a fixed coarse mesh that is not aligned with the interface:\n- A standard piecewise linear Finite Element Method (FEM) basis function, and\n- A Multiscale Finite Element Method (MsFEM) harmonic basis function constructed by local cell solves.\n\nUse the coarse mesh nodes $x_0=0$, $x_1=0.6$, and $x_2=1$, so the coarse elements are $(0,0.6)$ and $(0.6,1)$, while the coefficient interface is at $x_i=0.5$ inside the first coarse element. Let the single interior coarse degree of freedom be associated with the node $x_1=0.6$.\n\nDefine the standard FEM hat basis function $\\varphi(x)$ associated with $x_1$ by linear interpolation on each coarse element:\n$$\n\\varphi(x)=\\begin{cases}\n\\frac{x-0}{0.6-0},  x\\in[0,0.6],\\\\\n\\frac{1-x}{1-0.6},  x\\in[0.6,1],\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nso that $\\varphi(0)=0$, $\\varphi(0.6)=1$, and $\\varphi(1)=0$.\n\nDefine the MsFEM harmonic basis function $\\psi(x)$ associated with $x_1$ by solving, on each coarse element $K$,\n$$\n-(\\kappa(x)\\,\\psi_K'(x))'=0\\quad \\text{for }x\\in K,\n$$\nwith Dirichlet boundary conditions equal to the coarse nodal values at the endpoints of $K$. Specifically:\n- On $(0,0.6)$, impose $\\psi(0)=0$ and $\\psi(0.6)=1$, while enforcing continuity of $\\psi$ and of the flux $\\kappa(x)\\psi'(x)$ at $x=0.5$.\n- On $(0.6,1)$, impose $\\psi(0.6)=1$ and $\\psi(1)=0$.\n\nFor each basis $\\phi\\in\\{\\varphi,\\psi\\}$, form the one-dimensional Galerkin approximation space spanned by $\\phi$, so the coarse solution takes the form $u_h(x)=c\\,\\phi(x)$, where $c$ is determined by the single-degree-of-freedom Galerkin equation\n$$\na\\,c=b,\\quad a=\\int_0^1 \\kappa(x)\\,(\\phi'(x))^2\\,dx,\\quad b=\\int_0^1 f(x)\\,\\phi(x)\\,dx.\n$$\n\nCompute the exact solution $u(x)$ by solving the piecewise ordinary differential equation on $(0,1/2)$ and $(1/2,1)$ with continuity of $u$ and of the flux $\\kappa(x)u'(x)$ at $x=1/2$:\n- On $(0,1/2)$ with $\\kappa(x)=1$, solve $-u''(x)=1$.\n- On $(1/2,1)$ with $\\kappa(x)=\\epsilon$, solve $-\\epsilon\\,u''(x)=1$.\nApply the boundary conditions $u(0)=0$, $u(1)=0$, and impose $u(1/2^-)=u(1/2^+)$ together with $\\kappa(1/2^-)\\,u'(1/2^-)=\\kappa(1/2^+)\\,u'(1/2^+)$ to determine the integration constants.\n\nMeasure the energy-norm error of each approximation,\n$$\n\\mathcal{E}(\\phi;\\epsilon)=\\int_0^1 \\kappa(x)\\,\\big(u'(x)-u_h'(x)\\big)^2\\,dx,\n$$\nwhere $u_h'(x)=c\\,\\phi'(x)$.\n\nImplement the above construction and compute the energy-norm errors for the following test suite of contrast parameters:\n- $\\epsilon=1.0$ (no contrast),\n- $\\epsilon=10^{-2}$ (moderate contrast),\n- $\\epsilon=10^{-6}$ (high contrast).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n[\\mathcal{E}(\\varphi;1.0),\\ \\mathcal{E}(\\psi;1.0),\\ \\mathcal{E}(\\varphi;10^{-2}),\\ \\mathcal{E}(\\psi;10^{-2}),\\ \\mathcal{E}(\\varphi;10^{-6}),\\ \\mathcal{E}(\\psi;10^{-6})].\n$$\nAll quantities are dimensionless; no physical units are involved. Angles do not appear. Express all numerical outputs as plain decimal floats.",
            "solution": "The user has provided a well-posed problem from the field of numerical analysis for partial differential equations. The task is to compare the accuracy of a standard Finite Element Method (FEM) and a Multiscale Finite Element Method (MsFEM) for a one-dimensional elliptic problem with a high-contrast coefficient. The validation of the problem statement confirms its scientific soundness, consistency, and completeness.\n\nThe solution proceeds in four main steps:\n1.  Derive the analytical form of the exact solution $u(x)$.\n2.  Derive the analytical forms of the standard FEM basis function $\\varphi(x)$ and the MsFEM harmonic basis function $\\psi(x)$.\n3.  Compute the terms required for the Galerkin method and the energy error formula for both basis functions.\n4.  Calculate the numerical value of the energy error for each basis function and for each specified value of the contrast parameter $\\epsilon$.\n\n### Step 1: Exact Solution $u(x)$\nThe problem is $-(\\kappa(x)u'(x))' = 1$ on $(0,1)$ with $u(0)=u(1)=0$.\nThe coefficient is $\\kappa(x)=1$ for $x \\in (0, 1/2)$ and $\\kappa(x)=\\epsilon$ for $x \\in (1/2, 1)$.\n\nOn $(0, 1/2)$, the equation is $-u_1''(x)=1$. The general solution is $u_1(x) = -\\frac{1}{2}x^2 + A_1 x + B_1$. The boundary condition $u(0)=0$ implies $B_1=0$, so $u_1(x) = -\\frac{1}{2}x^2 + A_1 x$.\n\nOn $(1/2, 1)$, the equation is $-\\epsilon u_2''(x)=1$, or $u_2''(x)=-1/\\epsilon$. The general solution is $u_2(x) = -\\frac{1}{2\\epsilon}x^2 + A_2 x + B_2$. The boundary condition $u(1)=0$ implies $-\\frac{1}{2\\epsilon} + A_2 + B_2 = 0$, so $B_2 = \\frac{1}{2\\epsilon} - A_2$.\n\nAt the interface $x=1/2$, we enforce continuity of the solution, $u_1(1/2)=u_2(1/2)$, and continuity of the flux, $\\kappa(1/2^-)u_1'(1/2) = \\kappa(1/2^+)u_2'(1/2)$.\n-   $u_1'(x) = -x + A_1$ and $u_2'(x) = -x/\\epsilon + A_2$.\n-   Continuity of $u$: $-\\frac{1}{8} + \\frac{A_1}{2} = -\\frac{1}{8\\epsilon} + \\frac{A_2}{2} + (\\frac{1}{2\\epsilon} - A_2) = \\frac{3}{8\\epsilon} - \\frac{A_2}{2}$. This simplifies to $A_1+A_2 = \\frac{1}{4} + \\frac{3}{4\\epsilon}$.\n-   Continuity of flux: $1 \\cdot (-1/2 + A_1) = \\epsilon \\cdot (-1/(2\\epsilon) + A_2)$, which gives $-1/2 + A_1 = -1/2 + \\epsilon A_2$, so $A_1 = \\epsilon A_2$.\n\nSolving the system for $A_1$ and $A_2$:\n$(\\epsilon A_2) + A_2 = \\frac{1}{4} + \\frac{3}{4\\epsilon} \\implies A_2(1+\\epsilon) = \\frac{\\epsilon+3}{4\\epsilon}$.\nThis gives $A_2 = \\frac{3+\\epsilon}{4\\epsilon(1+\\epsilon)}$ and $A_1 = \\epsilon A_2 = \\frac{3+\\epsilon}{4(1+\\epsilon)}$.\n\nThe exact solution is:\n$$\nu(x) = \\begin{cases}\n-\\frac{1}{2}x^2 + \\frac{3+\\epsilon}{4(1+\\epsilon)} x  x \\in [0, 1/2] \\\\\n-\\frac{x^2-1}{2\\epsilon} + \\frac{3+\\epsilon}{4\\epsilon(1+\\epsilon)}(x-1)  x \\in (1/2, 1]\n\\end{cases}\n$$\nAnd its derivative is:\n$$\nu'(x) = \\begin{cases}\n-x + \\frac{3+\\epsilon}{4(1+\\epsilon)}  x \\in (0, 1/2) \\\\\n-\\frac{x}{\\epsilon} + \\frac{3+\\epsilon}{4\\epsilon(1+\\epsilon)}  x \\in (1/2, 1)\n\\end{cases}\n$$\n\n### Step 2: Basis Functions $\\varphi(x)$ and $\\psi(x)$\nThe standard linear basis function $\\varphi(x)$ is given. Its derivative is piecewise constant:\n$$\n\\varphi'(x) = \\begin{cases}\n1/0.6 = 5/3  x \\in (0, 0.6) \\\\\n-1/0.4 = -5/2  x \\in (0.6, 1)\n\\end{cases}\n$$\n\nThe MsFEM basis function $\\psi(x)$ is found by solving $-(\\kappa \\psi')'=0$ on coarse elements $K_1=(0,0.6)$ and $K_2=(0.6,1)$.\nOn $K_1=(0,0.6)$, with $\\psi(0)=0, \\psi(0.6)=1$:\n-   The solution is piecewise linear. Let $\\psi(x) = C_1 x + D_1$ on $(0,0.5)$ and $\\psi(x) = C_2 x + D_2$ on $(0.5,0.6)$.\n-   $\\psi(0)=0 \\implies D_1=0$.\n-   $\\psi(0.6)=1 \\implies 0.6 C_2 + D_2 = 1$.\n-   Continuity at $x=0.5$: $\\psi(0.5^-)=\\psi(0.5^+) \\implies 0.5 C_1 = 0.5 C_2 + D_2$.\n-   Flux continuity at $x=0.5$: $1 \\cdot C_1 = \\epsilon \\cdot C_2$.\n-   Solving this linear system gives $C_1 = \\frac{10\\epsilon}{1+5\\epsilon}$, $C_2 = \\frac{10}{1+5\\epsilon}$, and $D_2 = \\frac{5\\epsilon-5}{1+5\\epsilon}$.\n\nOn $K_2=(0.6,1)$, $\\kappa(x)=\\epsilon$ is constant. The harmonic function is just a linear interpolant: $\\psi(x) = \\frac{1-x}{1-0.6} = 2.5(1-x)$.\n\nThe derivative $\\psi'(x)$ is piecewise constant:\n$$\n\\psi'(x) = \\begin{cases}\nC_1 = \\frac{10\\epsilon}{1+5\\epsilon},  x \\in (0, 0.5) \\\\\nC_2 = \\frac{10}{1+5\\epsilon},  x \\in (0.5, 0.6) \\\\\nC_3 = -2.5,  x \\in (0.6, 1)\n\\end{cases}\n$$\n\n### Step 3: Energy Error Computation\nThe energy norm error is given by $\\mathcal{E}(\\phi;\\epsilon) = \\int_0^1 \\kappa(x) (u'(x)-u_h'(x))^2 dx$.\nFor a Galerkin method where $u_h = c\\,\\phi = (b/a)\\phi$, this simplifies to the \"best approximation\" formula:\n$$\n\\mathcal{E}(\\phi;\\epsilon) = \\underbrace{\\int_0^1 \\kappa(x) (u'(x))^2 dx}_{\\text{Energy of exact solution}} - \\underbrace{\\frac{\\left(\\int_0^1 \\phi(x) dx\\right)^2}{\\int_0^1 \\kappa(x) (\\phi'(x))^2 dx}}_{\\text{Energy of approximation}} = a(u,u) - \\frac{b^2}{a}\n$$\nThe first term, the energy of the exact solution, can be calculated as $a(u,u) = \\int_0^1 f(x)u(x)dx = \\int_0^1 u(x)dx$.\n$$\nE_{\\text{exact}} = \\int_0^1 u(x)dx = \\frac{\\epsilon^2+14\\epsilon+1}{96\\epsilon(1+\\epsilon)}\n$$\nWe now compute the stiffness $a$ and load $b$ terms for each basis.\n\n**For $\\phi = \\varphi$ (Standard FEM):**\n-   Stiffness $a_{\\text{fem}}$:\n    $a_{\\text{fem}} = \\int_0^{0.5} 1 \\cdot (5/3)^2 dx + \\int_{0.5}^{0.6} \\epsilon \\cdot (5/3)^2 dx + \\int_{0.6}^1 \\epsilon \\cdot (-5/2)^2 dx$\n    $a_{\\text{fem}} = \\frac{25}{9}(0.5) + \\epsilon \\frac{25}{9}(0.1) + \\epsilon \\frac{25}{4}(0.4) = \\frac{12.5}{9} + \\frac{2.5\\epsilon}{9} + 2.5\\epsilon = \\frac{25}{18}(1+2\\epsilon)$.\n-   Load $b_{\\text{fem}}$:\n    $b_{\\text{fem}} = \\int_0^1 \\varphi(x) dx = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times (1-0) \\times 1 = 0.5$.\n\n**For $\\phi = \\psi$ (MsFEM):**\n-   Stiffness $a_{\\text{ms}}$:\n    $a_{\\text{ms}} = \\int_0^{0.5} 1 \\cdot (\\psi')^2 dx + \\int_{0.5}^{0.6} \\epsilon \\cdot (\\psi')^2 dx + \\int_{0.6}^1 \\epsilon \\cdot (\\psi')^2 dx$\n    $a_{ms} = \\frac{1}{2} (\\frac{10\\epsilon}{1+5\\epsilon})^2 + \\frac{\\epsilon}{10} (\\frac{10}{1+5\\epsilon})^2 + \\frac{2\\epsilon}{5} (-2.5)^2 = \\frac{50\\epsilon^2 + 10\\epsilon}{(1+5\\epsilon)^2} + 2.5\\epsilon = \\frac{10\\epsilon(1+5\\epsilon)}{(1+5\\epsilon)^2} + 2.5\\epsilon = \\frac{10\\epsilon}{1+5\\epsilon} + 2.5\\epsilon$.\n-   Load $b_{\\text{ms}}$:\n    $b_{\\text{ms}} = \\int_0^{0.5} \\psi(x)dx + \\int_{0.5}^{0.6} \\psi(x)dx + \\int_{0.6}^1 \\psi(x)dx$\n    After integration of the piecewise linear functions:\n    $b_{\\text{ms}} = \\frac{1.75\\epsilon+0.05}{1+5\\epsilon} + 0.2 = \\frac{2.75\\epsilon+0.25}{1+5\\epsilon}$.\n\n### Step 4: Numerical Evaluation\nFor each $\\epsilon \\in \\{1.0, 10^{-2}, 10^{-6}\\}$, we compute $\\mathcal{E}(\\varphi;\\epsilon) = E_{\\text{exact}} - b_{\\text{fem}}^2/a_{\\text{fem}}$ and $\\mathcal{E}(\\psi;\\epsilon) = E_{\\text{exact}} - b_{\\text{ms}}^2/a_{\\text{ms}}$. The implementation below will perform these final calculations. For $\\epsilon=1$, $\\kappa(x)=1$ everywhere, the harmonic basis $\\psi(x)$ becomes identical to the linear basis $\\varphi(x)$, resulting in identical errors. As $\\epsilon$ decreases (contrast increases), the MsFEM basis better captures the solution behavior near the interface, leading to a significantly smaller error compared to the standard FEM.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the energy-norm error for standard FEM and MsFEM approximations\n    of a 1D elliptic problem with a high-contrast coefficient.\n    \"\"\"\n    \n    test_epsilons = [1.0, 1e-2, 1e-6]\n    results = []\n\n    for eps in test_epsilons:\n        # Step 1: Calculate the exact energy of the true solution u.\n        # E_exact = integral_0^1 kappa * (u')^2 dx = integral_0^1 f*u dx\n        # The analytical formula for integral_0^1 u(x) dx is derived in the solution text.\n        e_exact_num = eps**2 + 14 * eps + 1\n        e_exact_den = 96 * eps * (1 + eps)\n        e_exact = e_exact_num / e_exact_den\n\n        # Step 2: Calculate error for the standard FEM basis function phi.\n        # a_fem = integral_0^1 kappa * (phi')^2 dx\n        # b_fem = integral_0^1 f * phi dx, with f=1\n        a_fem = (25.0 / 18.0) * (1.0 + 2.0 * eps)\n        b_fem = 0.5\n        \n        # Energy of the FEM approximation\n        energy_fem_approx = b_fem**2 / a_fem\n        \n        # Energy norm of the error for FEM\n        error_fem = e_exact - energy_fem_approx\n        results.append(error_fem)\n        \n        # Step 3: Calculate error for the MsFEM basis function psi.\n        # a_ms = integral_0^1 kappa * (psi')^2 dx\n        # b_ms = integral_0^1 f * psi dx, with f=1\n        a_ms = (10.0 * eps) / (1.0 + 5.0 * eps) + 2.5 * eps\n        b_ms = (2.75 * eps + 0.25) / (1.0 + 5.0 * eps)\n        \n        # Energy of the MsFEM approximation\n        energy_msfem_approx = b_ms**2 / a_ms\n        \n        # Energy norm of the error for MsFEM\n        error_msfem = e_exact - energy_msfem_approx\n        results.append(error_msfem)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The basic MsFEM construction, while powerful, can suffer from 'resonance errors' due to the artificial Dirichlet boundary conditions imposed on local problems. This hands-on coding exercise introduces oversampling, a crucial technique designed to mitigate these errors and improve the accuracy of the basis functions, particularly in media with periodic heterogeneities. By comparing the energy, represented by the $H^1$-seminorm, of basis functions constructed with and without oversampling, you will quantify the impact of this technique and understand its importance in developing robust multiscale models .",
            "id": "3746089",
            "problem": "Consider the one-dimensional scalar elliptic operator with a periodic heterogeneous conductivity coefficient. Let the global computational domain be $[0,1]$, and let a coarse element $K = [x_L,x_R] \\subset [0,1]$ be fixed. The local multiscale nodal basis functions for the Multiscale Finite Element Method (MsFEM) are defined as follows. The non-oversampled left basis function $\\phi^L$ on $K$ solves the homogeneous local problem\n$$\n-\\frac{d}{dx}\\left(\\kappa(x)\\frac{d\\phi^L}{dx}(x)\\right) = 0 \\quad \\text{in } K,\n$$\nwith Dirichlet boundary conditions\n$$\n\\phi^L(x_L) = 1, \\quad \\phi^L(x_R) = 0.\n$$\nThe corresponding oversampled left basis function $\\phi_{\\text{os}}^L$ is defined by solving the same homogeneous local problem on the expanded interval $K^+ = [x_L - \\delta, x_R + \\delta] \\cap [0,1]$ with Dirichlet boundary conditions\n$$\n\\phi_{\\text{os}}^L(x_L - \\delta) = 1, \\quad \\phi_{\\text{os}}^L(x_R + \\delta) = 0,\n$$\nand then restricting $\\phi_{\\text{os}}^L$ to $K$. The $H^1$-seminorm on $K$ is\n$$\n\\left|\\phi\\right|_{H^1(K)} = \\left(\\int_{x_L}^{x_R}\\left|\\frac{d\\phi}{dx}(x)\\right|^2\\,dx\\right)^{1/2}.\n$$\nYou will design a numerical experiment with periodic $\\kappa(x)$ to compare $\\left|\\phi^L\\right|_{H^1(K)}$ and $\\left|\\phi_{\\text{os}}^L\\right|_{H^1(K)}$ and quantify their difference on $K$. Assume the following foundational facts: (i) the local basis satisfies the given boundary value problem; (ii) $\\kappa(x)$ is strictly positive and periodic on $[0,1]$; (iii) numerical quadrature (for example, the composite trapezoidal rule) can be used to approximate definite integrals on a uniform grid.\n\nYour program must, for each test case, construct the relevant quantities on a uniform fine grid with $N$ intervals (mesh size $h = 1/N$), set $\\delta = m h$ for a given integer $m \\ge 0$, and compute the difference\n$$\n\\Delta = \\left|\\phi^L\\right|_{H^1(K)} - \\left|\\phi_{\\text{os}}^L\\right|_{H^1(K)}\n$$\nfor the left basis functions only. No physical units are involved in this problem.\n\nUse the following four test cases, which together form the test suite and must be evaluated exactly as specified:\n\n- Test case $1$ (sinusoidal coefficient, moderate contrast, nonzero oversampling):\n  - Global domain: $[0,1]$\n  - Coarse element: $K = [0.4,\\,0.6]$\n  - Fine grid: $N = 5000$ (so $h = 1/5000$)\n  - Oversampling cells: $m = 100$ (so $\\delta = 100 h$)\n  - Period and parameters: $\\epsilon = 0.02$, $k_0 = 2.0$, $k_1 = 1.0$\n  - Conductivity: $\\kappa(x) = k_0 + k_1 \\sin\\!\\left(\\frac{2\\pi x}{\\epsilon}\\right)$\n\n- Test case $2$ (sinusoidal coefficient, identical to test case $1$ but zero oversampling):\n  - Global domain: $[0,1]$\n  - Coarse element: $K = [0.4,\\,0.6]$\n  - Fine grid: $N = 5000$\n  - Oversampling cells: $m = 0$ (so $\\delta = 0$)\n  - Period and parameters: $\\epsilon = 0.02$, $k_0 = 2.0$, $k_1 = 1.0$\n  - Conductivity: $\\kappa(x) = k_0 + k_1 \\sin\\!\\left(\\frac{2\\pi x}{\\epsilon}\\right)$\n\n- Test case $3$ (sinusoidal coefficient, high contrast, nonzero oversampling):\n  - Global domain: $[0,1]$\n  - Coarse element: $K = [0.25,\\,0.35]$\n  - Fine grid: $N = 10000$\n  - Oversampling cells: $m = 50$\n  - Period and parameters: $\\epsilon = 0.01$, $k_0 = 10.0$, $k_1 = 9.0$\n  - Conductivity: $\\kappa(x) = k_0 + k_1 \\sin\\!\\left(\\frac{2\\pi x}{\\epsilon}\\right)$\n\n- Test case $4$ (piecewise-constant periodic coefficient, strong contrast, nonzero oversampling):\n  - Global domain: $[0,1]$\n  - Coarse element: $K = [0.45,\\,0.55]$\n  - Fine grid: $N = 6000$\n  - Oversampling cells: $m = 60$\n  - Period and parameters: $\\epsilon = 0.05$, $k_{\\text{high}} = 10.0$, $k_{\\text{low}} = 1.0$\n  - Conductivity: $\\kappa(x) = k_{\\text{high}}$ for $x$ such that the fractional part of $x/\\epsilon$ lies in $[0,\\,0.5)$, and $\\kappa(x) = k_{\\text{low}}$ otherwise, repeated periodically on $[0,1]$\n\nFor each test case, compute $\\Delta$ as a floating-point number. Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, in the order of the test cases $1$ through $4$ (for example, $\\left[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4\\right]$). The final outputs must be real numbers. No other text should be printed by the program. The Multiscale Finite Element Method (MsFEM) acronym is defined here explicitly on its first appearance.",
            "solution": "The problem is valid. It presents a well-posed mathematical task grounded in the established theory of the Multiscale Finite Element Method (MsFEM). All required data and definitions are provided, and there are no scientific or logical contradictions. We will proceed with a full solution.\n\nThe core of the problem is to solve a one-dimensional, second-order, homogeneous ordinary differential equation (ODE) to find the MsFEM basis functions and then compute their respective $H^1$-seminorms over a specified coarse element $K = [x_L, x_R]$.\n\nFirst, we find the analytical solution to the local problem:\n$$\n-\\frac{d}{dx}\\left(\\kappa(x)\\frac{d\\phi}{dx}(x)\\right) = 0\n$$\nwhere $\\kappa(x)$ is a strictly positive, heterogeneous conductivity coefficient. Integrating this equation once with respect to $x$ yields:\n$$\n\\kappa(x)\\frac{d\\phi}{dx}(x) = -C_1\n$$\nwhere $C_1$ is a constant of integration. Since $\\kappa(x)  0$, we can rearrange and solve for the derivative of $\\phi$:\n$$\n\\frac{d\\phi}{dx}(x) = -\\frac{C_1}{\\kappa(x)}\n$$\nIntegrating again from a starting point $x_a$ to a variable point $x$ gives the general solution for $\\phi(x)$:\n$$\n\\phi(x) - \\phi(x_a) = \\int_{x_a}^{x} \\left(-\\frac{C_1}{\\kappa(t)}\\right) dt = -C_1 \\int_{x_a}^{x} \\frac{dt}{\\kappa(t)}\n$$\nThe constant $C_1$ is determined by applying the Dirichlet boundary conditions, which are specified on an interval $[x_a, x_b]$ as $\\phi(x_a) = y_a$ and $\\phi(x_b) = y_b$. Setting $x=x_b$, we get:\n$$\n\\phi(x_b) - \\phi(x_a) = y_b - y_a = -C_1 \\int_{x_a}^{x_b} \\frac{dt}{\\kappa(t)}\n$$\nSolving for $C_1$:\n$$\nC_1 = \\frac{y_a - y_b}{\\int_{x_a}^{x_b} \\frac{dt}{\\kappa(t)}}\n$$\n\nNow, we apply this general framework to the two specific basis functions required.\n\n**1. Non-Oversampled Left Basis Function, $\\phi^L(x)$**\nThis function is defined on the coarse element $K=[x_L, x_R]$ with boundary conditions $\\phi^L(x_L) = 1$ and $\\phi^L(x_R) = 0$. Here, $x_a=x_L$, $y_a=1$, and $x_b=x_R$, $y_b=0$. The constant $C_1^L$ is:\n$$\nC_1^L = \\frac{1 - 0}{\\int_{x_L}^{x_R} \\frac{dt}{\\kappa(t)}} = \\frac{1}{\\int_{x_L}^{x_R} \\frac{dt}{\\kappa(t)}}\n$$\nThe derivative of $\\phi^L(x)$ is therefore:\n$$\n\\frac{d\\phi^L}{dx}(x) = -\\frac{C_1^L}{\\kappa(x)} = - \\frac{1}{\\kappa(x) \\int_{x_L}^{x_R} \\frac{dt}{\\kappa(t)}}\n$$\n\n**2. Oversampled Left Basis Function, $\\phi_{\\text{os}}^L(x)$**\nThis function is defined on the oversampled domain $K^+ = [x_L - \\delta, x_R + \\delta] \\cap [0,1]$. Let the boundaries of this effective domain be $x_L' = \\max(x_L - \\delta, 0)$ and $x_R' = \\min(x_R + \\delta, 1)$. The boundary conditions are $\\phi_{\\text{os}}^L(x_L') = 1$ and $\\phi_{\\text{os}}^L(x_R') = 0$.\nThe corresponding constant $C_1^{\\text{os}}$ is:\n$$\nC_1^{\\text{os}} = \\frac{1 - 0}{\\int_{x_L'}^{x_R'} \\frac{dt}{\\kappa(t)}} = \\frac{1}{\\int_{x_L'}^{x_R'} \\frac{dt}{\\kappa(t)}}\n$$\nThe derivative of $\\phi_{\\text{os}}^L(x)$ on its domain of definition $K^+$ is:\n$$\n\\frac{d\\phi_{\\text{os}}^L}{dx}(x) = -\\frac{C_1^{\\text{os}}}{\\kappa(x)} = - \\frac{1}{\\kappa(x) \\int_{x_L'}^{x_R'} \\frac{dt}{\\kappa(t)}}\n$$\nFor the calculation, we restrict this function and its derivative to the original coarse element $K=[x_L, x_R]$.\n\n**Calculation of the $H^1$-Seminorms and their difference $\\Delta$**\nThe $H^1$-seminorm on $K$ is given by $|\\phi|_{H^1(K)} = \\left(\\int_{x_L}^{x_R}\\left|\\frac{d\\phi}{dx}(x)\\right|^2\\,dx\\right)^{1/2}$.\n\nFor the non-oversampled case, we square the derivative and integrate over $K$:\n$$\n\\left|\\phi^L\\right|_{H^1(K)}^2 = \\int_{x_L}^{x_R} \\left( - \\frac{1}{\\kappa(x) \\int_{x_L}^{x_R} \\frac{dt}{\\kappa(t)}} \\right)^2 dx = \\frac{\\int_{x_L}^{x_R} \\frac{dx}{\\kappa(x)^2}}{\\left(\\int_{x_L}^{x_R} \\frac{dt}{\\kappa(t)}\\right)^2}\n$$\nTaking the square root gives:\n$$\n\\left|\\phi^L\\right|_{H^1(K)} = \\frac{\\left(\\int_{x_L}^{x_R} \\frac{dx}{\\kappa(x)^2}\\right)^{1/2}}{\\int_{x_L}^{x_R} \\frac{dt}{\\kappa(t)}}\n$$\nFor the oversampled case, the procedure is identical, but the derivative is defined using the integral over the larger domain $K^+$. The seminorm is still computed over $K$:\n$$\n\\left|\\phi_{\\text{os}}^L\\right|_{H^1(K)}^2 = \\int_{x_L}^{x_R} \\left( - \\frac{1}{\\kappa(x) \\int_{x_L'}^{x_R'} \\frac{dt}{\\kappa(t)}} \\right)^2 dx = \\frac{\\int_{x_L}^{x_R} \\frac{dx}{\\kappa(x)^2}}{\\left(\\int_{x_L'}^{x_R'} \\frac{dt}{\\kappa(t)}\\right)^2}\n$$\nTaking the square root gives:\n$$\n\\left|\\phi_{\\text{os}}^L\\right|_{H^1(K)} = \\frac{\\left(\\int_{x_L}^{x_R} \\frac{dx}{\\kappa(x)^2}\\right)^{1/2}}{\\int_{x_L'}^{x_R'} \\frac{dt}{\\kappa(t)}}\n$$\nWe observe that the numerator term, let's call it $J = \\left(\\int_{x_L}^{x_R} \\frac{dx}{\\kappa(x)^2}\\right)^{1/2}$, is common to both expressions. The desired difference $\\Delta$ is then:\n$$\n\\Delta = \\left|\\phi^L\\right|_{H^1(K)} - \\left|\\phi_{\\text{os}}^L\\right|_{H^1(K)} = J \\left[ \\frac{1}{\\int_{x_L}^{x_R} \\frac{dt}{\\kappa(t)}} - \\frac{1}{\\int_{x_L'}^{x_R'} \\frac{dt}{\\kappa(t)}} \\right]\n$$\nFor test case 2, we have $m=0$, which implies $\\delta = 0$. Consequently, $x_L'=x_L$ and $x_R'=x_R$, causing the two terms in the bracket to be identical. Thus, $\\Delta = 0$ for this case, which is expected.\n\n**Numerical Implementation Strategy**\nThe problem is to be solved numerically. The strategy is as follows:\n1. For each test case, define the parameters $N$, $m$, $x_L$, $x_R$, and the parameters for $\\kappa(x)$.\n2. Construct a uniform fine grid for the domain $[0,1]$ with $N+1$ points: $x_i = i h$ for $i=0, \\dots, N$, where $h=1/N$.\n3. Evaluate the specified $\\kappa(x)$ at each grid point $x_i$ to generate an array of conductivity values.\n4. Calculate the oversampling amount $\\delta = m h$ and determine the boundaries of the oversampled interval, $x_L' = \\max(x_L - \\delta, 0)$ and $x_R' = \\min(x_R + \\delta, 1)$.\n5. Identify the grid indices corresponding to the interval boundaries $x_L, x_R, x_L'$, and $x_R'$.\n6. Using the composite trapezoidal rule, as implemented for instance by `numpy.trapz`, compute the necessary definite integrals: $\\int_{x_L}^{x_R} \\frac{dt}{\\kappa(t)}$, $\\int_{x_L'}^{x_R'} \\frac{dt}{\\kappa(t)}$, and $\\int_{x_L}^{x_R} \\frac{dx}{\\kappa(x)^2}$.\n7. Substitute these numerical values into the derived formula for $\\Delta$ to obtain the final result.\nThis procedure will be repeated for all four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference in H1-seminorm between standard and oversampled\n    MsFEM basis functions for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'K': (0.4, 0.6), 'N': 5000, 'm': 100, \n            'kappa_type': 'sin', 'params': {'eps': 0.02, 'k0': 2.0, 'k1': 1.0}\n        },\n        {\n            'K': (0.4, 0.6), 'N': 5000, 'm': 0, \n            'kappa_type': 'sin', 'params': {'eps': 0.02, 'k0': 2.0, 'k1': 1.0}\n        },\n        {\n            'K': (0.25, 0.35), 'N': 10000, 'm': 50, \n            'kappa_type': 'sin', 'params': {'eps': 0.01, 'k0': 10.0, 'k1': 9.0}\n        },\n        {\n            'K': (0.45, 0.55), 'N': 6000, 'm': 60, \n            'kappa_type': 'pw_const', 'params': {'eps': 0.05, 'k_high': 10.0, 'k_low': 1.0}\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for the current test case\n        xL, xR = case['K']\n        N = case['N']\n        m = case['m']\n        \n        # If there is no oversampling, the difference is zero by definition.\n        if m == 0:\n            results.append(0.0)\n            continue\n\n        # Set up the fine grid and oversampling parameters\n        h = 1.0 / N\n        delta = m * h\n        x_fine = np.linspace(0.0, 1.0, N + 1)\n        \n        # Evaluate the conductivity coefficient kappa(x) on the fine grid\n        if case['kappa_type'] == 'sin':\n            eps = case['params']['eps']\n            k0 = case['params']['k0']\n            k1 = case['params']['k1']\n            kappa_fine = k0 + k1 * np.sin(2.0 * np.pi * x_fine / eps)\n        elif case['kappa_type'] == 'pw_const':\n            eps = case['params']['eps']\n            k_high = case['params']['k_high']\n            k_low = case['params']['k_low']\n            # kappa is k_high if frac(x/eps) is in [0, 0.5), k_low otherwise\n            kappa_fine = np.where(np.mod(x_fine / eps, 1.0)  0.5, k_high, k_low)\n        \n        # Prepare integrands 1/kappa and 1/kappa^2\n        inv_kappa = 1.0 / kappa_fine\n        inv_kappa_sq = 1.0 / (kappa_fine**2)\n        \n        # Determine integration limits as indices on the fine grid\n        iL = int(round(xL * N))\n        iR = int(round(xR * N))\n        \n        # Effective boundaries of the oversampled domain, clipped to [0,1]\n        xL_os = max(xL - delta, 0.0)\n        xR_os = min(xR + delta, 1.0)\n        iL_os = int(round(xL_os * N))\n        iR_os = int(round(xR_os * N))\n        \n        # Compute the required definite integrals using the composite trapezoidal rule\n        \n        # Integral of 1/kappa(t) over the non-oversampled coarse element K\n        I1_K = np.trapz(inv_kappa[iL : iR + 1], x_fine[iL : iR + 1])\n        \n        # Integral of 1/kappa(t) over the oversampled coarse element K+\n        I1_K_os = np.trapz(inv_kappa[iL_os : iR_os + 1], x_fine[iL_os : iR_os + 1])\n        \n        # Integral of 1/kappa(x)^2 over the non-oversampled coarse element K\n        I2_K = np.trapz(inv_kappa_sq[iL : iR + 1], x_fine[iL : iR + 1])\n        \n        # Compute the final difference Delta using the derived formula\n        J = np.sqrt(I2_K)\n        delta_val = J * (1.0 / I1_K - 1.0 / I1_K_os)\n        \n        results.append(delta_val)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}