{
    "hands_on_practices": [
        {
            "introduction": "为了理解过采样技术的必要性，我们首先通过一个简单的练习来诊断其旨在解决的核心问题。当我们在粗网格单元上强加人工边界条件来计算多尺度基函数时，尤其是在材料界面附近，可能会引入非物理的边界层效应。这个练习  构建了一个一维场景，其中材料属性在单元边界处发生跳变，通过精确计算并比较理想基函数和过采样基函数的梯度，我们可以量化这种边界效应所导致的误差。",
            "id": "3790695",
            "problem": "考虑一个带间断系数的一维空间中的标量、二阶、线性椭圆模型问题。令物理域为 $D=(0,1)$，感兴趣的单元为 $K=\\left(0,\\frac{1}{2}\\right)$。对于给定的过采样宽度 $\\delta \\in \\left(0,\\frac{1}{2}\\right)$，定义过采样区域 $U_{K}=\\left(0,\\frac{1}{2}+\\delta\\right)$。令系数 $A(x)$ 为间断且分段常数的，由下式给出\n$$\nA(x)=\\begin{cases}\n1,  x \\in \\left(0,\\frac{1}{2}\\right),\\\\\n\\varepsilon,  x \\in \\left(\\frac{1}{2},\\frac{1}{2}+\\delta\\right),\n\\end{cases}\n$$\n其中 $\\varepsilon \\in (0,1)$ 是一个固定的对比度参数。在多尺度有限元方法 (MsFEM) 中，考虑定义在 $U_{K}$ 上的局部基函数，该函数由朴素狄利克雷边界条件定义\n$$\n-(A(x)\\,\\psi^{\\mathrm{os}\\,'}(x))' = 0 \\text{ on } U_{K}, \\quad \\psi^{\\mathrm{os}}(0)=1, \\quad \\psi^{\\mathrm{os}}\\!\\left(\\tfrac{1}{2}+\\delta\\right)=0,\n$$\n并将其在 $K$ 上的限制定义为 $\\psi^{\\mathrm{os}}|_{K}$。同时，定义在 $K$ 上的理想、非过采样的局部基\n$$\n-(A(x)\\,\\psi^{\\mathrm{id}\\,'}(x))' = 0 \\text{ on } K, \\quad \\psi^{\\mathrm{id}}(0)=1, \\quad \\psi^{\\mathrm{id}}\\!\\left(\\tfrac{1}{2}\\right)=0,\n$$\n在 $K$ 上有 $A(x)\\equiv 1$。在一维情况下，刚度贡献与 $K$ 上常数梯度的平方成比例，且限制过程直接使用 $\\psi^{\\mathrm{os}}|_{K}$。\n\n仅使用一维椭圆算子的基本性质以及在 $A$ 为常数的每个子区间内通量为常数的性质，计算比值的闭式表达式\n$$\nE(\\varepsilon,\\delta)\\equiv \\frac{\\psi^{\\mathrm{os}\\,'}(x)}{\\psi^{\\mathrm{id}\\,'}(x)} \\quad \\text{for any } x \\in K,\n$$\n该比值量化了未被限制操作移除的伪边界层影响。将最终答案表示为关于 $\\varepsilon$ 和 $\\delta$ 的简化解析表达式。不需要进行数值计算，也不涉及单位。",
            "solution": "目标是计算当 $x \\in K = \\left(0,\\frac{1}{2}\\right)$ 时，比值 $E(\\varepsilon,\\delta)\\equiv \\frac{\\psi^{\\mathrm{os}\\,'}(x)}{\\psi^{\\mathrm{id}\\,'}(x)}$。这需要求出在区间 $K$ 上梯度 $\\psi^{\\mathrm{id}\\,'}(x)$ 和 $\\psi^{\\mathrm{os}\\,'}(x)$ 的表达式。\n\n首先，我们求解在域 $K = \\left(0,\\frac{1}{2}\\right)$ 上的理想基函数 $\\psi^{\\mathrm{id}}(x)$。\n控制方程为\n$$\n-(A(x)\\,\\psi^{\\mathrm{id}\\,'}(x))' = 0 \\quad \\text{on } K.\n$$\n在区间 $K$ 上，系数指定为 $A(x)=1$。因此，方程简化为\n$$\n-\\psi^{\\mathrm{id}\\,''}(x) = 0.\n$$\n该方程的通解是 $x$ 的一个线性函数：\n$$\n\\psi^{\\mathrm{id}}(x) = c_1 x + c_2,\n$$\n其中 $c_1$ 和 $c_2$ 是积分常数。我们使用给定的边界条件 $\\psi^{\\mathrm{id}}(0)=1$ 和 $\\psi^{\\mathrm{id}}\\!\\left(\\frac{1}{2}\\right)=0$ 来确定这些常数。\n在 $x=0$ 处应用第一个边界条件：\n$$\n\\psi^{\\mathrm{id}}(0) = c_1(0) + c_2 = 1 \\implies c_2 = 1.\n$$\n在 $x=\\frac{1}{2}$ 处应用第二个边界条件：\n$$\n\\psi^{\\mathrm{id}}\\!\\left(\\frac{1}{2}\\right) = c_1\\left(\\frac{1}{2}\\right) + 1 = 0 \\implies \\frac{c_1}{2} = -1 \\implies c_1 = -2.\n$$\n所以，在 $K$ 上的理想基函数是 $\\psi^{\\mathrm{id}}(x) = -2x + 1$。在这个区间上，梯度是常数：\n$$\n\\psi^{\\mathrm{id}\\,'}(x) = -2 \\quad \\text{for } x \\in K.\n$$\n\n接下来，我们求解在过采样区域 $U_K = \\left(0, \\frac{1}{2}+\\delta\\right)$ 上的过采样基函数 $\\psi^{\\mathrm{os}}(x)$。\n控制方程为\n$$\n-(A(x)\\,\\psi^{\\mathrm{os}\\,'}(x))' = 0 \\quad \\text{on } U_K.\n$$\n这个方程意味着通量 $J(x) = -A(x)\\,\\psi^{\\mathrm{os}\\,'}(x)$ 在整个域 $U_K$ 上是恒定的。让我们将这个常数通量记为 $J_0$。\n$$\n-A(x)\\,\\psi^{\\mathrm{os}\\,'}(x) = J_0.\n$$\n这给出了梯度的表达式：\n$$\n\\psi^{\\mathrm{os}\\,'}(x) = -\\frac{J_0}{A(x)}.\n$$\n函数 $\\psi^{\\mathrm{os}}(x)$ 可以通过对其梯度从 $0$ 积分到 $x$ 来求得，并使用边界条件 $\\psi^{\\mathrm{os}}(0)=1$：\n$$\n\\psi^{\\mathrm{os}}(x) = \\psi^{\\mathrm{os}}(0) + \\int_0^x \\psi^{\\mathrm{os}\\,'}(s)\\,ds = 1 - \\int_0^x \\frac{J_0}{A(s)}\\,ds.\n$$\n为了求出常数 $J_0$，我们应用第二个边界条件 $\\psi^{\\mathrm{os}}\\!\\left(\\frac{1}{2}+\\delta\\right)=0$：\n$$\n\\psi^{\\mathrm{os}}\\!\\left(\\frac{1}{2}+\\delta\\right) = 1 - J_0 \\int_0^{\\frac{1}{2}+\\delta} \\frac{1}{A(s)}\\,ds = 0.\n$$\n由此可见，$J_0$ 是该域总阻力的倒数：\n$$\nJ_0 = \\left( \\int_0^{\\frac{1}{2}+\\delta} \\frac{1}{A(s)}\\,ds \\right)^{-1}.\n$$\n我们通过在间断点 $x=\\frac{1}{2}$ 处拆分积分来计算它：\n$$\n\\int_0^{\\frac{1}{2}+\\delta} \\frac{1}{A(s)}\\,ds = \\int_0^{\\frac{1}{2}} \\frac{1}{A(s)}\\,ds + \\int_{\\frac{1}{2}}^{\\frac{1}{2}+\\delta} \\frac{1}{A(s)}\\,ds.\n$$\n使用 $A(x)$ 的分段定义：当 $x \\in (0, \\frac{1}{2})$ 时 $A(x)=1$，当 $x \\in (\\frac{1}{2}, \\frac{1}{2}+\\delta)$ 时 $A(x)=\\varepsilon$：\n$$\n\\int_0^{\\frac{1}{2}+\\delta} \\frac{1}{A(s)}\\,ds = \\int_0^{\\frac{1}{2}} \\frac{1}{1}\\,ds + \\int_{\\frac{1}{2}}^{\\frac{1}{2}+\\delta} \\frac{1}{\\varepsilon}\\,ds = \\left[s\\right]_0^{\\frac{1}{2}} + \\frac{1}{\\varepsilon}\\left[s\\right]_{\\frac{1}{2}}^{\\frac{1}{2}+\\delta} = \\frac{1}{2} + \\frac{1}{\\varepsilon}\\left(\\left(\\frac{1}{2}+\\delta\\right)-\\frac{1}{2}\\right) = \\frac{1}{2} + \\frac{\\delta}{\\varepsilon}.\n$$\n合并各项得到总阻力为 $\\frac{\\varepsilon + 2\\delta}{2\\varepsilon}$。\n现在我们可以求出 $J_0$：\n$$\nJ_0 = \\left(\\frac{\\varepsilon + 2\\delta}{2\\varepsilon}\\right)^{-1} = \\frac{2\\varepsilon}{\\varepsilon + 2\\delta}.\n$$\n问题要求的是当 $x \\in K=\\left(0,\\frac{1}{2}\\right)$ 时的梯度 $\\psi^{\\mathrm{os}\\,'}(x)$。在这个区间内，$A(x)=1$。因此，梯度为：\n$$\n\\psi^{\\mathrm{os}\\,'}(x) = -\\frac{J_0}{A(x)} = -\\frac{J_0}{1} = -J_0 = -\\frac{2\\varepsilon}{\\varepsilon + 2\\delta}.\n$$\n\n最后，我们计算比值 $E(\\varepsilon, \\delta)$：\n$$\nE(\\varepsilon, \\delta) = \\frac{\\psi^{\\mathrm{os}\\,'}(x)}{\\psi^{\\mathrm{id}\\,'}(x)} \\quad \\text{for } x \\in K.\n$$\n由于两个梯度在 $K$ 上都是常数，我们可以代入它们推导出的值：\n$$\nE(\\varepsilon, \\delta) = \\frac{-\\frac{2\\varepsilon}{\\varepsilon + 2\\delta}}{-2} = \\frac{1}{2} \\cdot \\frac{2\\varepsilon}{\\varepsilon + 2\\delta} = \\frac{\\varepsilon}{\\varepsilon + 2\\delta}.\n$$\n为了保持标准的代数形式，我们将分母写为 $2\\delta + \\varepsilon$。\n$$\nE(\\varepsilon, \\delta) = \\frac{\\varepsilon}{2\\delta + \\varepsilon}.\n$$\n该表达式量化了由于在 $x=1/2$ 处的材料间断引起的边界层效应，导致多尺度基函数在单元 $K$ 上的梯度产生的误差，而这种误差未被朴素的过采样和限制过程完全捕捉和移除。",
            "answer": "$$\\boxed{\\frac{\\varepsilon}{2\\delta + \\varepsilon}}$$"
        },
        {
            "introduction": "认识到过采样的必要性之后，一个自然而然的问题是：“需要多大的过采样区域？”。过采样并非没有代价，它会增加计算成本。这个练习  引导我们探索一个核心的设计权衡：通过建立计算成本的多项式增长与边界层误差的指数衰减之间的关系，推导出最优的过采样半径。掌握这种权衡是设计高效多尺度方法的关键。",
            "id": "3790708",
            "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{2,3\\}$）上提出的标量二阶线性椭圆边值问题，\n$$\n-\\nabla \\cdot \\big(a\\big(\\tfrac{x}{\\varepsilon}\\big)\\nabla u(x)\\big) = f(x)\\quad \\text{in }\\Omega,\\qquad u=0\\quad \\text{on }\\partial\\Omega,\n$$\n其中 $\\varepsilon > 0$ 是一个小的微尺度参数，$a(y)$ 是一个一致椭圆、有界、可测的张量，满足 $\\lambda |\\xi|^{2} \\le \\xi^{\\top} a(y)\\,\\xi \\le \\Lambda |\\xi|^{2}$，对于某个 $0  \\lambda \\le \\Lambda  \\infty$ 和所有 $\\xi\\in\\mathbb{R}^{d}$，$y\\in\\mathbb{R}^{d}$。在多尺度有限元方法 (MsFEM) 中，令 $H0$ 表示粗网格尺寸，$\\delta \\ge H$ 表示用于在扩大的片区上构造局部基函数的过采样半径。在 MsFEM 过采样文献中，一个经过充分检验的事实是：\n- 构造所有局部过采样基函数的计算成本尺度为 $O\\big(H^{-d}(\\delta/H)^{d}\\big)$。\n- 全局能量范数离散误差可被界定为 $O\\big(H+\\exp(-c\\,\\delta/\\varepsilon)\\big)$，其中常数 $c0$ 与 $H$、$\\delta$ 和 $\\varepsilon$ 无关。\n\n假设您的目标是使总精度渐近地由粗网格贡献主导，因此要求边界层项不超过粗误差的固定比例，即 $\\exp(-c\\,\\delta/\\varepsilon)\\le K\\,H$，其中固定常数 $K\\in(0,1]$ 与 $H$、$\\delta$ 和 $\\varepsilon$ 无关。在满足此渐近精度要求的所有函数 $\\delta(H)$ 中，请利用成本关于 $\\delta$ 的单调性，提出一个能够渐近最小化所述计算成本尺度的 $\\delta(H)$ 选择。请以 $H$、$\\varepsilon$、$c$ 和 $K$ 的闭式解析表达式形式给出您对 $\\delta(H)$ 的最终答案。答案无需进行数值计算，也不涉及任何单位。",
            "solution": "出发点是在尺度 $\\varepsilon$ 上具有快速振荡系数的强制椭圆模型问题。在多尺度有限元方法 (MsFEM) 中，过采样在比粗单元更大的片区上构造局部基函数，以减轻边界效应。两个被广泛接受且经过充分检验的尺度关系主导了设计上的权衡：\n1. 在整个域上组装所有局部过采样基函数的计算成本尺度为\n$$\n\\mathcal{C}(H,\\delta)\\sim H^{-d}\\left(\\frac{\\delta}{H}\\right)^{d},\n$$\n因为有 $O(H^{-d})$ 个粗单元，并且每个过采样片区内的局部求解相对于单元体积 $O(H^{d})$ 而言，其体积尺度为 $O(\\delta^{d})$。\n2. 能量范数误差（或等效地，一个 $H^{1}$ 半范数界）尺度为\n$$\n\\mathcal{E}(H,\\delta)\\sim H+\\exp\\!\\left(-c\\,\\frac{\\delta}{\\varepsilon}\\right),\n$$\n其中第一项 $H$ 是粗离散误差，第二项反映了因过采样导致的边界层不匹配的指数衰减。\n\n设计目标是实现由粗网格贡献渐近主导的精度，这由对于固定 $K\\in(0,1]$ 的要求所阐明\n$$\n\\exp\\!\\left(-c\\,\\frac{\\delta}{\\varepsilon}\\right)\\le K\\,H,\n$$\n该约束确保了由过采样引起的边界层项不超过粗误差的一个固定比例，从而当 $H\\to 0$ 时有 $\\mathcal{E}(H,\\delta)\\sim H$。\n\n考虑到对于固定的 $H$，计算成本 $\\mathcal{C}(H,\\delta)$ 在 $\\delta$ 上是严格递增的（因为 $\\delta/H\\ge 1$ 且指数 $d0$），在不等式约束下的成本最小化选择，是在仍然满足该约束的最小 $\\delta$ 处达到，即通过强制该约束为等式来实现：\n$$\n\\exp\\!\\left(-c\\,\\frac{\\delta}{\\varepsilon}\\right)=K\\,H.\n$$\n对 $\\delta$ 求解可得\n$$\n-c\\,\\frac{\\delta}{\\varepsilon}=\\ln(K\\,H)\\quad\\Longrightarrow\\quad \\delta(H)=\\frac{\\varepsilon}{c}\\,\\ln\\!\\left(\\frac{1}{K\\,H}\\right).\n$$\n对于所有足够小的 $H$，该表达式为正，因为 $K\\,H\\in(0,1]$，因此 $\\ln\\!\\big(\\frac{1}{K\\,H}\\big)\\ge 0$。并且，对于小的 $H$，只要 $H$ 相对于 $\\varepsilon/c$ 不是指数级的小，它就渐近地满足 $\\delta(H)\\ge H$；更精确地说，如果需要，可以逐案检查 $\\delta(H)\\ge H$ 的要求，但过采样文献通常允许选择 $\\delta$ 为 $H$ 的倍数或更大，且推导出的 $\\delta(H)$ 随着 $H\\to 0$ 对数增长。\n\n将此选择代回误差尺度关系可得\n$$\n\\mathcal{E}\\big(H,\\delta(H)\\big)\\sim H+\\exp\\!\\left(-c\\,\\frac{(\\varepsilon/c)\\ln(1/(K\\,H))}{\\varepsilon}\\right)=H+\\exp\\!\\big(-\\ln(1/(K\\,H))\\big)=H+K\\,H\\sim H,\n$$\n这显示了预期的平衡。所产生的计算成本尺度为\n$$\n\\mathcal{C}\\big(H,\\delta(H)\\big)\\sim H^{-d}\\left(\\frac{\\delta(H)}{H}\\right)^{d}\n=H^{-d}\\left(\\frac{1}{H}\\cdot\\frac{\\varepsilon}{c}\\,\\ln\\!\\left(\\frac{1}{K\\,H}\\right)\\right)^{d}\n\\sim \\left(\\frac{\\varepsilon}{c}\\right)^{d} H^{-2d}\\left[\\ln\\!\\left(\\frac{1}{K\\,H}\\right)\\right]^{d},\n$$\n这明确了权衡关系：实现一个 $\\sim H$ 的误差会产生一个增长速度为 $H^{-2d}$（不计一个关于 $H$ 的对数因子）的计算成本。因为任何更大的 $\\delta$ 都会严格增加 $\\mathcal{C}(H,\\delta)$，同时误差仍由 $H$ 主导，所以提出的 $\\delta(H)$ 是最优的（在最小化所述精度约束下的成本的意义上）。\n\n因此，作为 $H$ 的函数的成本最小化过采样半径是\n$$\n\\delta(H)=\\frac{\\varepsilon}{c}\\,\\ln\\!\\left(\\frac{1}{K\\,H}\\right).\n$$",
            "answer": "$$\\boxed{\\frac{\\varepsilon}{c}\\,\\ln\\!\\left(\\frac{1}{K\\,H}\\right)}$$"
        },
        {
            "introduction": "过采样是一种强大的局部修正技术，但它并非万能。本练习旨在探索该方法的局限性。通过构建一个具有长程相关性的系数场——即介质的全局属性会影响局部行为——我们将通过一个思想实验  揭示，为什么像过采样这样的纯局部修正方法无法捕捉到这些非局部效应。理解这些局限性对于在实践中正确应用多尺度方法至关重要。",
            "id": "3790674",
            "problem": "考虑一维空间中的标量椭圆边值问题，\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big(a(x)\\,\\frac{\\mathrm{d}u(x)}{\\mathrm{d}x}\\Big)=f(x),\\qquad x\\in(0,1),\\qquad u(0)=0,\\quad u(1)=0,\n$$\n其中扩散系数 $a(x)0$ 严格为正。带过采样的多尺度有限元方法 (MsFEM) 通过在扩大的区域上求解局部齐次单元问题，并将其限制在粗尺度单元上，来构造粗尺度基函数。设单个粗尺度单元为 $K=[x_{0}-H/2,x_{0}+H/2]\\subset(0,1)$，长度为 $H$，其过采样区域为\n$$\nK_{r}=\\big[x_{0}-\\tfrac{H}{2}-r,\\;x_{0}+\\tfrac{H}{2}+r\\big]\\cap[0,1],\n$$\n其中 $r0$ 是过采样半径。在任意区间 $I\\subset[0,1]$ 上，齐次方程对应的基于通量的 MsFEM 基函数 $\\phi$ 满足\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big(a(x)\\,\\frac{\\mathrm{d}\\phi(x)}{\\mathrm{d}x}\\Big)=0,\\qquad \\phi(x_{L})=0,\\quad \\phi(x_{R})=1,\n$$\n对于区间 $I$ 的端点 $x_L  x_R$。假设基函数限制在单元 $K$ 上。构建一个系数场 $a(x)$，它在大部分区域为1，但在一个与 $K_r$ 不相交的区间 $I$（长度为 $w$）内取值为 $\\alpha \\ll 1$。推导局部建模误差 $E_{\\mathrm{mod}}(K) \\coloneqq \\int_{K}a(x)\\big((\\phi_r'(x))^{2}-(\\phi_{\\mathrm{glob}}'(x))^{2}\\big)\\,\\mathrm{d}x$ 的闭式表达式，其中 $\\phi_r$ 是在 $K_r$ 上计算的过采样基，而 $\\phi_{\\mathrm{glob}}$ 是在整个域 $[0,1]$ 上计算的“理想”全局参考基。并论证为什么仅增加过采样半径 $r$ 无法使此误差趋于零。",
            "solution": "核心任务是推导局部建模误差 $E_{\\mathrm{mod}}(K)$ 的表达式，并分析其对过采样半径 $r$ 的依赖性。建模误差定义为：\n$$\nE_{\\mathrm{mod}}(K) \\coloneqq\\int_{K}a(x)\\Big(\\big(\\phi_{r}'(x)\\big)^{2}-\\big(\\phi_{\\mathrm{glob}}'(x)\\big)^{2}\\Big)\\,\\mathrm{d}x\n$$\n这需要计算两个多尺度基函数的导数：过采样基 $\\phi_r$ 和全局参考基 $\\phi_{\\mathrm{glob}}$。两者都是在不同区间上齐次椭圆方程的解。\n\n我们首先找到在区间 $[x_L, x_R]$ 上求解齐次问题的基函数 $\\phi$ 的一般形式：\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big(a(x)\\,\\frac{\\mathrm{d}\\phi(x)}{\\mathrm{d}x}\\Big)=0,\\qquad \\phi(x_{L})=0,\\quad \\phi(x_{R})=1\n$$\n对该方程积分一次，得到 $a(x)\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = C_1$，其中 $C_1$ 为某个常数。这意味着 $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\frac{C_1}{a(x)}$。\n从 $x_L$ 到 $x$ 进行第二次积分，得到：\n$$\n\\phi(x) - \\phi(x_L) = C_1 \\int_{x_L}^{x} \\frac{1}{a(s)}\\,\\mathrm{d}s\n$$\n使用边界条件 $\\phi(x_L)=0$，我们得到 $\\phi(x) = C_1 \\int_{x_L}^{x} \\frac{1}{a(s)}\\,\\mathrm{d}s$。\n第二个边界条件 $\\phi(x_R)=1$ 决定了常数 $C_1$：\n$$\n1 = C_1 \\int_{x_L}^{x_R} \\frac{1}{a(s)}\\,\\mathrm{d}s \\implies C_1 = \\frac{1}{\\int_{x_L}^{x_R} \\frac{1}{a(s)}\\,\\mathrm{d}s}\n$$\n因此，基函数的导数由下式给出：\n$$\n\\phi'(x) = \\frac{C_1}{a(x)} = \\frac{1}{a(x)\\int_{x_L}^{x_R} \\frac{1}{a(s)}\\,\\mathrm{d}s}\n$$\n在子区间 $J \\subseteq [x_L, x_R]$ 上的局部能量贡献是：\n$$\n\\int_{J} a(x) (\\phi'(x))^2\\,\\mathrm{d}x = \\int_{J} a(x) \\left( \\frac{1}{a(x)\\int_{x_L}^{x_R} \\frac{1}{a(s)}\\,\\mathrm{d}s} \\right)^2 \\,\\mathrm{d}x = \\frac{1}{\\left(\\int_{x_L}^{x_R} \\frac{1}{a(s)}\\,\\mathrm{d}s\\right)^2} \\int_{J} \\frac{1}{a(x)}\\,\\mathrm{d}x\n$$\n\n我们将此通用公式应用于我们的两个具体情况。\n\n**1. 过采样基函数 $\\phi_r$**\n\n函数 $\\phi_r$ 定义在过采样区域 $K_r = [x_0 - \\frac{H}{2} - r, x_0 + \\frac{H}{2} + r] \\cap [0,1]$ 上。问题陈述意味着我们考虑的粗尺度单元 $K$ 及其区域 $K_r$ 不在定义域的边界上，因此我们可以假设 $K_r \\subset (0,1)$ 且其长度为 $H+2r$。边界条件施加在该区域的端点上。\n关键假设是 $K_r \\cap I = \\emptyset$。这意味着对于任何 $x \\in K_r$，扩散系数为 $a(x)=1$。\n在区域 $K_r$ 上 $a^{-1}$ 的积分是：\n$$\n\\int_{K_r} \\frac{1}{a(s)}\\,\\mathrm{d}s = \\int_{x_0 - H/2 - r}^{x_0 + H/2 + r} \\frac{1}{1}\\,\\mathrm{d}s = (x_0 + H/2 + r) - (x_0 - H/2 - r) = H+2r\n$$\n在粗尺度单元 $K$ 上 $\\phi_r$ 的能量是 $E_{\\mathrm{mod}}(K)$ 中的第一项。积分区间是 $K$。\n$$\nE_r(K) \\coloneqq \\int_{K} a(x) (\\phi_r'(x))^2\\,\\mathrm{d}x = \\frac{1}{\\left(\\int_{K_r} \\frac{1}{a(s)}\\,\\mathrm{d}s\\right)^2} \\int_{K} \\frac{1}{a(x)}\\,\\mathrm{d}x\n$$\n由于 $K \\subset K_r$，我们在 $K$ 上有 $a(x)=1$。因此，在 $K$ 上 $a(x)^{-1}$ 的积分是 $\\int_K 1\\,\\mathrm{d}x = H$。\n代入数值，我们发现：\n$$\nE_r(K) = \\frac{H}{(H+2r)^2}\n$$\n\n**2. 全局参考基函数 $\\phi_{\\mathrm{glob}}$**\n\n函数 $\\phi_{\\mathrm{glob}}$ 定义在整个定义域 $[0,1]$ 上。\n在 $[0,1]$ 上 $a^{-1}$ 的积分是：\n$$\n\\int_{0}^{1} \\frac{1}{a(s)}\\,\\mathrm{d}s = \\int_I \\frac{1}{a(s)}\\,\\mathrm{d}s + \\int_{[0,1]\\setminus I} \\frac{1}{a(s)}\\,\\mathrm{d}s\n$$\n给定在 $I$ （一个长度为 $w$ 的区间）上 $a(x)=\\alpha$，以及在 $[0,1]\\setminus I$ （一个测度为 $1-w$ 的集合）上 $a(x)=1$，我们有：\n$$\n\\int_{0}^{1} \\frac{1}{a(s)}\\,\\mathrm{d}s = \\int_I \\frac{1}{\\alpha}\\,\\mathrm{d}s + \\int_{[0,1]\\setminus I} 1\\,\\mathrm{d}s = \\frac{w}{\\alpha} + (1-w)\n$$\n在粗尺度单元 $K$ 上 $\\phi_{\\mathrm{glob}}$ 的能量是 $E_{\\mathrm{mod}}(K)$ 中的第二项。\n$$\nE_{\\mathrm{glob}}(K) \\coloneqq \\int_{K} a(x) (\\phi_{\\mathrm{glob}}'(x))^2\\,\\mathrm{d}x = \\frac{1}{\\left(\\int_{0}^{1} \\frac{1}{a(s)}\\,\\mathrm{d}s\\right)^2} \\int_{K} \\frac{1}{a(x)}\\,\\mathrm{d}x\n$$\n从初始设置中，我们知道 $K \\cap I = \\emptyset$，所以对于所有 $x \\in K$，$a(x)=1$。因此，$\\int_K a(x)^{-1}\\,\\mathrm{d}x = H$。\n代入数值，我们发现：\n$$\nE_{\\mathrm{glob}}(K) = \\frac{H}{\\left(1-w+\\frac{w}{\\alpha}\\right)^2}\n$$\n\n**3. 建模误差 $E_{\\mathrm{mod}}(K)$**\n\n结合这两个结果，建模误差是：\n$$\nE_{\\mathrm{mod}}(K) = E_r(K) - E_{\\mathrm{glob}}(K) = \\frac{H}{(H+2r)^2} - \\frac{H}{\\left(1-w+\\frac{w}{\\alpha}\\right)^2}\n$$\n提取公因子 $H$ 得到最终的闭式表达式：\n$$\nE_{\\mathrm{mod}}(K) = H \\left( \\frac{1}{(H+2r)^2} - \\frac{1}{\\left(1-w+\\frac{w}{\\alpha}\\right)^2} \\right)\n$$\n\n**过采样失效的论证**\n\n建模误差 $E_{\\mathrm{mod}}(K)$ 量化了过采样基函数 $\\phi_r$ 和全局参考基函数 $\\phi_{\\mathrm{glob}}$ 之间局部能量的差异。要使过采样有效，这个误差应该可以通过增加过采样半径 $r$ 来控制并趋于零。\n\n我们推导出的 $E_{\\mathrm{mod}}(K)$ 表达式包含两项：\n- 过采样基的局部能量，$E_r(K) = \\frac{H}{(H+2r)^2}$。这一项仅取决于局部几何形状（$H$、$r$）和在 $K_r$ 上扩散系数的局部值 $a(x)=1$。\n- 全局基的局部能量，$E_{\\mathrm{glob}}(K) = \\frac{H}{(1-w+w/\\alpha)^2}$。这一项取决于介质的全局属性，特别是远处嵌入物 $I$ 的参数 $w$ 和 $\\alpha$。\n\n从这个结构中可以明显看出过采样无法控制误差的原因。过采样基 $\\phi_r$ 是通过在 $K_r$ 上求解一个局部问题来计算的。根据问题的假设（$K_r \\cap I = \\emptyset$），这个局部问题没有任何关于嵌入物 $I$ 存在或性质的信息。在 $K_r$ 上的局部求解器实际上“看到”的是一个 $a(x) \\equiv 1$ 的均匀介质。因此，得到的能量项 $E_r(K)$ 完全独立于 $w$ 和 $\\alpha$。\n\n相反，全局参考基 $\\phi_{\\mathrm{glob}}$ 及其能量 $E_{\\mathrm{glob}}(K)$ 对由 $I$ 引入的“长程相关性”很敏感，这体现在 $(1-w+w/\\alpha)^2$ 这一项中。\n\n增加过采样半径 $r$（在“实用范围”内，即 $r$ 足够小以至于 $K_r$ 不会到达 $I$）只会改变 $E_r(K)$ 的值。当 $r \\to \\infty$ 时，它使 $E_r(K)$ 趋向于 $0$。然而，目标值 $E_{\\mathrm{glob}}(K)$ 是一个固定的非零常数（对于给定的 $a(x)$）。因此，误差 $E_{\\mathrm{mod}}(K)$ 收敛到 $-E_{\\mathrm{glob}}(K)$，而不是 $0$。\n\n因此，增加 $r$ 并不能使 $E_r(K)$ 更好地逼近 $E_{\\mathrm{glob}}(K)$。它只是将局部能量项驱向零，而误差本身渐近到一个非零值。这揭示了过采样的一个根本局限性：它无法纠正由位于过采样区域之外的介质的长程特征引起的建模误差。局部基仍然“意识不到”全局结构，而这种“无知”表现为不可约的建模误差。",
            "answer": "$$\n\\boxed{H \\left( \\frac{1}{(H+2r)^2} - \\frac{1}{\\left(1-w+\\frac{w}{\\alpha}\\right)^2} \\right)}\n$$"
        }
    ]
}