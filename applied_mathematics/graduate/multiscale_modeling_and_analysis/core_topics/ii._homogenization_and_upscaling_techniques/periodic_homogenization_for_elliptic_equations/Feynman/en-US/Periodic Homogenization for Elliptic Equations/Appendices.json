{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a foundational entry point into periodic homogenization by analyzing the simplest non-trivial case: a one-dimensional elliptic equation. By deriving the effective coefficient for a layered medium from first principles, you will see how the concept of flux conservation at the microscale leads to the famous harmonic mean formula for the homogenized coefficient. This practice is essential for building intuition about how microscopic structure dictates macroscopic behavior .",
            "id": "3794299",
            "problem": "Consider the one-dimensional periodic homogenization of a second-order linear elliptic partial differential equation (PDE) with rapidly oscillating coefficients. Let $a:\\mathbb{R}\\to(0,\\infty)$ be measurable, bounded, and $1$-periodic, and let $f\\in H^{-1}(0,L)$ be given. For $\\varepsilon>0$, consider the boundary value problem\n$$\n-\\frac{d}{dx}\\left(a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_{\\varepsilon}}{dx}(x)\\right)=f(x)\\quad\\text{in }(0,L),\\qquad u_{\\varepsilon}(0)=0,\\quad u_{\\varepsilon}(L)=0.\n$$\nStarting from the foundational notions of flux conservation for stationary elliptic operators and the periodic cell problem formulation used in homogenization theory, derive the effective (homogenized) scalar coefficient $a^{\\text{hom}}$ governing the limit equation\n$$\n-\\frac{d}{dx}\\left(a^{\\text{hom}}\\frac{du_{0}}{dx}(x)\\right)=f(x)\\quad\\text{in }(0,L),\\qquad u_{0}(0)=0,\\quad u_{0}(L)=0,\n$$\nwhere $u_{\\varepsilon}\\rightharpoonup u_{0}$ weakly in $H_{0}^{1}(0,L)$ as $\\varepsilon\\to 0$. Then, specialize to a layered microstructure with two phases per period: let $0<\\alpha<1$, $a_{1}>0$, and $a_{2}>0$, and define\n$$\na(y)=\\begin{cases}\na_{1}, & y\\in[0,\\alpha),\\\\\na_{2}, & y\\in[\\alpha,1),\n\\end{cases}\n$$\nextended periodically to $\\mathbb{R}$. Compute the homogenized coefficient $a^{\\text{hom}}$ explicitly as a closed-form analytic expression in terms of $\\alpha$, $a_{1}$, and $a_{2}$, and explain from first principles why the harmonic mean arises in $d=1$ layered media. Express your final answer as a single analytic expression. No rounding is required, and no physical units are needed.",
            "solution": "The problem as stated is a canonical example of one-dimensional periodic homogenization for a second-order elliptic operator. It is mathematically well-posed, scientifically grounded in the theory of multiscale analysis, and all necessary conditions and definitions are provided. The problem is valid.\n\nWe are tasked with deriving the homogenized coefficient $a^{\\text{hom}}$ for the equation\n$$-\\frac{d}{dx}\\left(a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_{\\varepsilon}}{dx}(x)\\right)=f(x)\\quad\\text{in }(0,L)$$\nwith Dirichlet boundary conditions $u_{\\varepsilon}(0)=u_{\\varepsilon}(L)=0$. The coefficient $a(y)$ is a $1$-periodic, measurable, and bounded function with $a(y) > c > 0$ for some constant $c$. The solution $u_\\varepsilon$ is known to converge weakly in $H^1_0(0,L)$ to $u_0$, which satisfies the homogenized equation:\n$$-\\frac{d}{dx}\\left(a^{\\text{hom}}\\frac{du_{0}}{dx}(x)\\right)=f(x)\\quad\\text{in }(0,L)$$\n\nThe derivation of $a^{\\text{hom}}$ can be approached from the standpoint of flux conservation and multiscale analysis. We introduce the flux $\\sigma_{\\varepsilon}(x) = -a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_{\\varepsilon}}{dx}(x)$. The PDE is then $\\frac{d\\sigma_{\\varepsilon}}{dx} = f(x)$. In the limit $\\varepsilon \\to 0$, the flux $\\sigma_{\\varepsilon}$ converges weakly to a homogenized flux $\\sigma_{0}(x)$, which is related to the macroscopic gradient $\\frac{du_{0}}{dx}$ by the effective law $\\sigma_{0}(x) = -a^{\\text{hom}}\\frac{du_{0}}{dx}(x)$.\n\nTo find $a^{\\text{hom}}$, we analyze the problem at two scales: the macroscopic scale, characterized by the variable $x$, and the microscopic scale, characterized by the fast variable $y = x/\\varepsilon$. The core idea of homogenization is that for small $\\varepsilon$, the behavior of the solution locally resembles that of a problem posed on a single periodic cell $Y=[0,1)$.\n\nLet us consider the flux. In the absence of a source term ($f=0$), the flux $\\sigma_{\\varepsilon}$ would be constant. With a source term $f$, the flux varies slowly on the macroscopic scale. On the microscopic scale, however, the flux must remain nearly constant. This is a consequence of the equation $\\frac{d}{dx}(\\dots) = f$. Let us write the gradient of the solution using the two-scale ansatz $u_{\\varepsilon}(x) \\approx u_0(x) + \\varepsilon u_1(x,y)$, where $u_1$ is $1$-periodic in $y$:\n$$\\frac{du_{\\varepsilon}}{dx} = \\frac{du_0}{dx} + \\frac{\\partial u_1}{\\partial y} + O(\\varepsilon)$$\nThe microscopic flux is therefore\n$$\\sigma_{\\varepsilon}(x) \\approx -a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)$$\nTo leading order, the PDE becomes an equation in the fast variable $y$:\n$$-\\frac{1}{\\varepsilon}\\frac{\\partial}{\\partial y}\\left(a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)\\right) \\approx 0$$\nThis implies that the quantity inside the derivative, the microscopic flux, is independent of $y$. Let us call this micro-flux $j(x)$.\n$$j(x) = -a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)$$\nThis is a statement of flux conservation across the microscopic layers. From this, we express the local gradient field:\n$$\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y) = -\\frac{j(x)}{a(y)}$$\nThe macroscopic gradient $\\frac{du_0}{dx}$ is, by definition, the average of the microscopic gradient field over the periodic cell $Y$. Averaging the above expression with respect to $y$ over $[0,1)$, we denote the average by $\\langle \\cdot \\rangle_y = \\int_0^1 (\\cdot) dy$.\n$$\\left\\langle \\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y) \\right\\rangle_y = \\left\\langle -\\frac{j(x)}{a(y)} \\right\\rangle_y$$\nSince $\\frac{du_0}{dx}$ and $j(x)$ do not depend on $y$, they can be treated as constants in the averaging process. The average of $\\frac{\\partial u_1}{\\partial y}$ vanishes due to the periodicity of $u_1$ in $y$: $\\langle \\frac{\\partial u_1}{\\partial y} \\rangle_y = \\int_0^1 \\frac{\\partial u_1}{\\partial y} dy = u_1(x,1) - u_1(x,0) = 0$.\nThe equation thus simplifies to:\n$$\\frac{du_0}{dx}(x) = -j(x) \\left\\langle \\frac{1}{a(y)} \\right\\rangle_y$$\nThe macroscopic flux $\\sigma_0(x)$ is the average of the microscopic flux $j(x,y)=j(x)$:\n$$\\sigma_0(x) = \\langle j(x) \\rangle_y = j(x)$$\nSubstituting $j(x) = \\sigma_0(x)$ into the previous equation gives:\n$$\\frac{du_0}{dx}(x) = -\\sigma_0(x) \\left\\langle \\frac{1}{a(y)} \\right\\rangle_y$$\nRearranging to find the macroscopic constitutive law $\\sigma_0(x) = -a^{\\text{hom}}\\frac{du_0}{dx}(x)$:\n$$\\sigma_0(x) = -\\frac{1}{\\left\\langle \\frac{1}{a(y)} \\right\\rangle_y} \\frac{du_0}{dx}(x)$$\nBy comparing this with the definition of the homogenized flux, we identify the homogenized coefficient:\n$$a^{\\text{hom}} = \\frac{1}{\\left\\langle \\frac{1}{a(y)} \\right\\rangle_y} = \\frac{1}{\\int_0^1 \\frac{1}{a(y)} dy}$$\nThis formula reveals that the effective coefficient is the harmonic mean of the microscopic coefficient over the periodic cell.\n\nThis result arises because in a one-dimensional medium, the layers of the material are arranged in series with respect to the direction of flux (current). If we think of $a(y)$ as conductivity, its reciprocal, $\\rho(y) = 1/a(y)$, is the resistivity. For components in series, the total resistance is the sum of the individual resistances. The effective resistivity $\\rho^{\\text{hom}}$ is therefore the average of the microscopic resistivities: $\\rho^{\\text{hom}} = \\langle \\rho(y) \\rangle_y = \\int_0^1 (1/a(y)) dy$. The effective conductivity is the reciprocal of the effective resistivity, $a^{\\text{hom}} = 1/\\rho^{\\text{hom}}$, leading directly to the harmonic mean formula.\n\nNow, we specialize to the given layered microstructure:\n$$\na(y)=\\begin{cases}\na_{1}, & y\\in[0,\\alpha)\\\\\na_{2}, & y\\in[\\alpha,1),\n\\end{cases}\n$$\nwhere $0<\\alpha<1$, $a_{1}>0$, and $a_{2}>0$. We compute the integral in the denominator of the formula for $a^{\\text{hom}}$:\n$$\\int_0^1 \\frac{1}{a(y)} dy = \\int_0^\\alpha \\frac{1}{a(y)} dy + \\int_\\alpha^1 \\frac{1}{a(y)} dy$$\nSubstituting the piecewise values of $a(y)$:\n$$\\int_0^1 \\frac{1}{a(y)} dy = \\int_0^\\alpha \\frac{1}{a_1} dy + \\int_\\alpha^1 \\frac{1}{a_2} dy$$\n$$= \\frac{1}{a_1} [y]_0^\\alpha + \\frac{1}{a_2} [y]_\\alpha^1$$\n$$= \\frac{\\alpha}{a_1} + \\frac{1-\\alpha}{a_2}$$\nThis expression is the average resistivity, being a weighted sum of the resistivities of the two phases, with weights equal to their volume fractions $\\alpha$ and $1-\\alpha$.\n\nFinally, the homogenized coefficient $a^{\\text{hom}}$ is the reciprocal of this average resistivity:\n$$a^{\\text{hom}} = \\frac{1}{\\frac{\\alpha}{a_1} + \\frac{1-\\alpha}{a_2}}$$\nTo obtain a single closed-form expression, we simplify the fraction:\n$$a^{\\text{hom}} = \\frac{1}{\\frac{\\alpha a_2 + (1-\\alpha)a_1}{a_1 a_2}} = \\frac{a_1 a_2}{(1-\\alpha)a_1 + \\alpha a_2}$$\nThis is the explicit analytical expression for the homogenized coefficient for the given two-phase layered medium.",
            "answer": "$$\\boxed{\\frac{a_1 a_2}{(1-\\alpha)a_1 + \\alpha a_2}}$$"
        },
        {
            "introduction": "Moving from one to two dimensions, this practice explores the crucial topic of how homogenization interacts with boundary conditions. You will derive the effective Neumann boundary data for a specific anisotropic medium and analyze the conditions under which a boundary layer is, or is not, required. This exercise highlights the principle that the entire boundary value problem, not just the differential operator, is subject to the homogenization process .",
            "id": "3794301",
            "problem": "Consider the periodic homogenization of a linear elliptic equation with Neumann boundary conditions in two spatial dimensions. Let $\\Omega = (0,1) \\times (0,1)$ and let the coefficient field be $\\mathbf{A}(y)$, with $y \\in Y = [0,1]^{2}$ the unit periodic cell, defined by\n$$\n\\mathbf{A}(y) = \\begin{pmatrix}\na(y_{1}) & 0 \\\\\n0 & 1\n\\end{pmatrix},\n\\qquad a(y_{1}) = 2 + \\sin(2\\pi y_{1}),\n$$\nextended to a $Y$–periodic function on $\\mathbb{R}^{2}$. Consider the family of solutions $u_{\\varepsilon}$ to\n$$\n-\\nabla \\cdot \\big(\\mathbf{A}(x/\\varepsilon)\\,\\nabla u_{\\varepsilon}\\big) = 0 \\quad \\text{in } \\Omega,\n$$\nwith a constant Neumann boundary condition on the right boundary segment $\\Gamma = \\{1\\} \\times (0,1)$,\n$$\n\\mathbf{A}(x/\\varepsilon)\\,\\nabla u_{\\varepsilon} \\cdot n = g_{0} \\quad \\text{on } \\Gamma,\n$$\nwhere $n = (1,0)$ is the outward unit normal and $g_{0}$ is a constant real number. Assume suitable boundary conditions are prescribed on $\\partial \\Omega \\setminus \\Gamma$ to ensure well-posedness.\n\nStarting from the fundamental definition of the homogenized matrix via the periodic cell problems, derive the homogenized tensor $\\mathbf{A}^{\\mathrm{hom}}$ for the given $\\mathbf{A}(y)$ and express the effective Neumann boundary data on $\\Gamma$ in terms of the homogenized flux and a constant macroscopic gradient $\\nabla u_{0} = (p,q)$ at the boundary for the homogenized limit $u_{0}$. Carefully justify each step from first principles: define the cell problems, argue the structure of the correctors, and evaluate any necessary averages. In your analysis, discuss whether a boundary layer arises for this Neumann problem with the given constant boundary data, and explain how this conclusion would be modified if the Neumann boundary datum were oscillatory of the form $g^{\\varepsilon}(x) = \\phi + \\psi\\,b(x/\\varepsilon)$ with $b$ a $Y$–periodic function of zero mean.\n\nYour final task is to provide the explicit expression, in closed form, for the effective Neumann boundary data on $\\Gamma$ as a function of $p$ only. The final answer must be a single analytic expression. No numerical rounding is required.",
            "solution": "The problem statement is a well-posed exercise in the field of periodic homogenization for elliptic partial differential equations. All provided data, definitions, and conditions are scientifically sound, mathematically consistent, and form a self-contained problem. The coefficient matrix $\\mathbf{A}(y)$ is symmetric and its eigenvalues, $a(y_1) = 2+\\sin(2\\pi y_1)$ and $1$, are strictly positive and bounded, ensuring uniform ellipticity. The problem is therefore valid for analysis.\n\nWe begin from first principles, using a two-scale asymptotic expansion for the solution $u_{\\varepsilon}(x)$. We posit that $u_{\\varepsilon}(x)$ can be expanded in powers of the small parameter $\\varepsilon > 0$ as:\n$$\nu_{\\varepsilon}(x) = u_{0}(x, y) + \\varepsilon u_{1}(x, y) + \\varepsilon^{2} u_{2}(x, y) + \\dots\n$$\nwhere $y = x/\\varepsilon$ is the fast variable, and each function $u_{i}(x,y)$ is periodic in $y$ with respect to the unit cell $Y = [0,1]^2$. The gradient operator transforms according to the chain rule: $\\nabla \\to \\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y$.\n\nSubstituting this expansion into the governing equation $-\\nabla \\cdot (\\mathbf{A}(x/\\varepsilon)\\,\\nabla u_{\\varepsilon}) = 0$ yields:\n$$\n-\\left(\\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y\\right) \\cdot \\left[ \\mathbf{A}(y) \\left(\\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y\\right) (u_{0} + \\varepsilon u_{1} + \\dots) \\right] = 0.\n$$\nWe expand this expression and collect terms of like powers in $\\varepsilon$.\n\n**Order $\\varepsilon^{-2}$:** The leading order term is:\n$$\n-\\nabla_y \\cdot (\\mathbf{A}(y) \\nabla_y u_{0}(x,y)) = 0.\n$$\nSince $\\mathbf{A}(y)$ is positive definite, this elliptic equation for $u_0$ with periodic boundary conditions in $y$ implies that $u_0$ must be constant with respect to $y$. Thus, $u_{0} = u_{0}(x)$.\n\n**Order $\\varepsilon^{-1}$:** Collecting the terms of order $\\varepsilon^{-1}$ gives:\n$$\n-\\nabla_y \\cdot (\\mathbf{A}(y) \\nabla_y u_{1}(x,y)) - \\nabla_y \\cdot (\\mathbf{A}(y) \\nabla_x u_{0}(x)) = 0.\n$$\nSince $u_0$ is independent of $y$, $\\nabla_x u_0$ is a function of $x$ only. The equation is linear, so we seek a solution for $u_1$ of the form:\n$$\nu_{1}(x,y) = \\sum_{k=1}^{2} \\chi_{k}(y) \\frac{\\partial u_{0}}{\\partial x_k}(x) + C(x),\n$$\nwhere $\\chi_k(y)$ are the \"corrector\" functions, which are $Y$-periodic and have zero mean over $Y$, and $C(x)$ is an integration constant with respect to $y$. Substituting this ansatz into the $\\varepsilon^{-1}$ equation and using the fact that this must hold for any macroscopic gradient $\\nabla_x u_0$, we obtain the cell problems for each corrector $\\chi_k(y)$, $k=1,2$:\n$$\n-\\nabla_y \\cdot (\\mathbf{A}(y) (\\nabla_y \\chi_{k}(y) + e_{k})) = 0 \\quad \\text{in } Y,\n$$\nwhere $e_k$ is the $k$-th standard basis vector in $\\mathbb{R}^2$ and $\\chi_k$ is $Y$-periodic.\n\nLet us solve these cell problems for the given matrix $\\mathbf{A}(y) = \\begin{pmatrix} a(y_1) & 0 \\\\ 0 & 1 \\end{pmatrix}$ with $a(y_1) = 2 + \\sin(2\\pi y_1)$.\n\nFor $k=1$, the cell problem is:\n$$\n-\\nabla_y \\cdot \\left( \\begin{pmatrix} a(y_1) & 0 \\\\ 0 & 1 \\end{pmatrix} \\left( \\begin{pmatrix} \\partial_{y_1} \\chi_1 \\\\ \\partial_{y_2} \\chi_1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right) \\right) = -\\frac{\\partial}{\\partial y_1}\\left(a(y_1)\\left(\\frac{\\partial \\chi_1}{\\partial y_1} + 1\\right)\\right) - \\frac{\\partial^2 \\chi_1}{\\partial y_2^2} = 0.\n$$\nGiven that the coefficient $a$ depends only on $y_1$, we seek a solution $\\chi_1$ that also depends only on $y_1$, i.e., $\\chi_1 = \\chi_1(y_1)$. The term $\\partial^2 \\chi_1 / \\partial y_2^2$ vanishes, and the equation simplifies to an ordinary differential equation:\n$$\n-\\frac{d}{dy_1}\\left(a(y_1)\\left(\\frac{d \\chi_1}{d y_1} + 1\\right)\\right) = 0.\n$$\nIntegrating with respect to $y_1$ yields $a(y_1)(d\\chi_1/dy_1 + 1) = C_1$ for some constant $C_1$. Thus, $d\\chi_1/dy_1 = C_1/a(y_1) - 1$. For $\\chi_1$ to be periodic in $y_1$, its derivative must have zero average over $[0,1]$.\n$$\n\\int_0^1 \\frac{d\\chi_1}{dy_1} dy_1 = \\chi_1(1) - \\chi_1(0) = 0.\n$$\nSo, $\\int_0^1 (C_1/a(y_1) - 1) dy_1 = 0$, which gives $C_1 \\int_0^1 \\frac{1}{a(y_1)} dy_1 - 1 = 0$.\nThe constant $C_1$ is the harmonic average of $a(y_1)$: $C_1 = \\left(\\int_0^1 \\frac{1}{a(y_1)} dy_1\\right)^{-1}$.\n\nFor $k=2$, the cell problem is:\n$$\n-\\nabla_y \\cdot \\left( \\begin{pmatrix} a(y_1) & 0 \\\\ 0 & 1 \\end{pmatrix} \\left( \\begin{pmatrix} \\partial_{y_1} \\chi_2 \\\\ \\partial_{y_2} \\chi_2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right) \\right) = -\\frac{\\partial}{\\partial y_1}\\left(a(y_1)\\frac{\\partial \\chi_2}{\\partial y_1}\\right) - \\frac{\\partial}{\\partial y_2}\\left(\\frac{\\partial \\chi_2}{\\partial y_2} + 1\\right) = 0.\n$$\nA trivial solution for this equation is $\\chi_2(y) = 0$. It is periodic and satisfies the equation since $-\\frac{\\partial}{\\partial y_2}(1) = 0$. Since the solution to the cell problem is unique up to an additive constant, we choose $\\chi_2(y) \\equiv 0$.\n\n**Order $\\varepsilon^{0}$ and the Homogenized Tensor:** Averaging the $\\varepsilon^0$ equation over the unit cell $Y$ and using the periodicity of $u_1$ and $u_2$ leads to the homogenized equation:\n$$\n-\\nabla_x \\cdot (\\mathbf{A}^{\\mathrm{hom}}\\nabla_x u_{0}) = 0.\n$$\nThe homogenized tensor $\\mathbf{A}^{\\mathrm{hom}}$ is defined by its components:\n$$\nA^{\\mathrm{hom}}_{ij} = \\int_Y \\left( \\mathbf{A}(y) (e_j + \\nabla_y \\chi_j(y)) \\right)_i dy = \\int_Y \\sum_{k=1}^2 A_{ik}(y) (\\delta_{kj} + \\partial_{y_k} \\chi_j(y)) dy.\n$$\nLet's compute the components:\n$A^{\\mathrm{hom}}_{11} = \\int_0^1\\int_0^1 A_{11}(y_1) (1 + \\partial_{y_1}\\chi_1(y_1)) dy_2 dy_1 = \\int_0^1 a(y_1) (1 + \\frac{d\\chi_1}{dy_1}) dy_1 = \\int_0^1 C_1 dy_1 = C_1$.\nWe calculate $C_1 = \\left(\\int_0^1 \\frac{dy_1}{2+\\sin(2\\pi y_1)}\\right)^{-1}$. Let $u=2\\pi y_1$. The integral becomes $\\frac{1}{2\\pi}\\int_0^{2\\pi} \\frac{du}{2+\\sin(u)}$. Using the standard formula $\\int_0^{2\\pi}\\frac{du}{\\alpha+\\beta\\sin u} = \\frac{2\\pi}{\\sqrt{\\alpha^2-\\beta^2}}$ for $\\alpha>|\\beta|$, with $\\alpha=2, \\beta=1$, we get $\\frac{2\\pi}{\\sqrt{4-1}} = \\frac{2\\pi}{\\sqrt{3}}$. Thus, the integral over $y_1$ is $\\frac{1}{2\\pi} \\frac{2\\pi}{\\sqrt{3}} = \\frac{1}{\\sqrt{3}}$.\nTherefore, $A^{\\mathrm{hom}}_{11} = C_1 = \\left(\\frac{1}{\\sqrt{3}}\\right)^{-1} = \\sqrt{3}$.\n\n$A^{\\mathrm{hom}}_{22} = \\int_Y A_{22}(y) (1 + \\partial_{y_2}\\chi_2(y)) dy = \\int_Y 1 \\cdot (1+0) dy = 1$.\n\n$A^{\\mathrm{hom}}_{12} = \\int_Y A_{11}(y) \\partial_{y_1}\\chi_2(y) dy = 0$ since $\\chi_2=0$.\n\n$A^{\\mathrm{hom}}_{21} = \\int_Y A_{22}(y) \\partial_{y_2}\\chi_1(y) dy = 0$ since $\\chi_1=\\chi_1(y_1)$.\n\nThe homogenized tensor is diagonal: $\\mathbf{A}^{\\mathrm{hom}} = \\begin{pmatrix} \\sqrt{3} & 0 \\\\ 0 & 1 \\end{pmatrix}$.\n\n**Boundary Condition Analysis:**\nThe Neumann condition on $\\Gamma = \\{1\\}\\times(0,1)$ is $\\mathbf{A}(x/\\varepsilon)\\nabla u_\\varepsilon \\cdot n = g_0$, with $n=(1,0)$. This is the normal component of the flux: $(\\mathbf{A}(y)\\nabla u_\\varepsilon)_1 = g_0$ at $x_1=1$.\nSubstitute the expansion: $(\\mathbf{A}(y)[\\nabla_x u_0 + \\nabla_y u_1 + \\dots])_1 = g_0$. The leading order term is:\n$$\n(\\mathbf{A}(y)(\\nabla_x u_0 + \\nabla_y u_1))_1 = (\\mathbf{A}(y) \\sum_{j=1}^2 (e_j + \\nabla_y \\chi_j) \\frac{\\partial u_0}{\\partial x_j})_1 = g_0.\n$$\nThe flux vector is $\\sigma_\\varepsilon = \\mathbf{A}(y)(\\nabla_x u_0 + \\nabla_y u_1)$. Its first component is:\n$$\n(\\sigma_\\varepsilon)_1 = A_{11}(y)(\\partial_{x_1}u_0 + \\partial_{y_1}u_1) = a(y_1)(\\partial_{x_1}u_0 + \\partial_{y_1}\\chi_1\\partial_{x_1}u_0 + \\partial_{y_1}\\chi_2\\partial_{x_2}u_0).\n$$\nSince $\\chi_2=0$, this simplifies to:\n$$\n(\\sigma_\\varepsilon)_1 = a(y_1)(1 + \\partial_{y_1}\\chi_1)\\partial_{x_1}u_0.\n$$\nFrom the cell problem for $\\chi_1$, we found $a(y_1)(1 + d\\chi_1/dy_1) = C_1 = A^{\\mathrm{hom}}_{11} = \\sqrt{3}$.\nSo, the leading order normal flux is $(\\sigma_\\varepsilon)_1 = A^{\\mathrm{hom}}_{11} \\partial_{x_1} u_0 = \\sqrt{3} \\partial_{x_1} u_0$.\nThis expression is independent of the fast variable $y$. The boundary condition on $\\Gamma$ can thus be satisfied at leading order by the two-scale expansion, provided we impose the effective (homogenized) Neumann condition on the limit solution $u_0$:\n$$\nA^{\\mathrm{hom}}_{11} \\frac{\\partial u_0}{\\partial x_1}\\Big|_{\\Gamma} = g_0 \\quad \\text{or} \\quad \\mathbf{A}^{\\mathrm{hom}}\\nabla u_0 \\cdot n \\Big|_{\\Gamma} = g_0.\n$$\nA boundary layer corrector is required when the standard expansion cannot satisfy the boundary condition due to microscopic oscillations that cannot be matched by the macroscopic solution. In this specific case, the normal component of the microscopic flux $a(y_1)(1+\\partial_{y_1}\\chi_1)$ is non-oscillatory. Consequently, **no boundary layer is needed** for constant Neumann data $g_0$.\n\n**Modification for Oscillatory Data:** If the Neumann data were $g^{\\varepsilon}(x) = \\phi + \\psi\\,b(x/\\varepsilon)$, where $b$ is $Y$-periodic with zero mean, the boundary condition at leading order would be:\n$$\n\\sqrt{3} \\frac{\\partial u_0}{\\partial x_1}\\Big|_{\\Gamma} = \\phi + \\psi\\,b(y).\n$$\nThe left side is a function of the macroscopic variable $x$ only, while the right side oscillates with the fast variable $y=x/\\varepsilon$. This equality cannot hold. This mismatch necessitates the introduction of a boundary layer corrector term in the asymptotic expansion, typically of the form $\\varepsilon \\theta(x, (1-x_1)/\\varepsilon, x_2/\\varepsilon)$, which decays away from the boundary. The effective boundary condition for $u_0$ is found by averaging the condition over a period in the fast variable. Since $\\langle b(y) \\rangle_Y=0$, the effective condition on $u_0$ becomes:\n$$\n\\sqrt{3} \\frac{\\partial u_0}{\\partial x_1}\\Big|_{\\Gamma} = \\langle \\phi + \\psi\\,b(y) \\rangle_Y = \\phi.\n$$\nThe oscillatory part $\\psi\\,b(y)$ is then captured by the boundary layer term.\n\n**Final Calculation:**\nThe problem asks for the explicit expression for the effective Neumann boundary data on $\\Gamma$ as a function of the macroscopic gradient component $p$. The macroscopic gradient at the boundary is given as $\\nabla u_0 = (p,q)$. The effective Neumann flux on $\\Gamma$ (with normal $n=(1,0)$) is the normal component of the homogenized flux vector $\\sigma_0 = \\mathbf{A}^{\\mathrm{hom}} \\nabla u_0$.\n$$\n\\sigma_0 \\cdot n = (\\mathbf{A}^{\\mathrm{hom}} \\nabla u_0) \\cdot n = \\left( \\begin{pmatrix} \\sqrt{3} & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} p \\\\ q \\end{pmatrix} \\right) \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n$$\n\\sigma_0 \\cdot n = \\begin{pmatrix} \\sqrt{3}p \\\\ q \\end{pmatrix} \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\sqrt{3}p.\n$$\nThis expression is the effective Neumann data as a function of $p$ only, as requested.",
            "answer": "$$\\boxed{\\sqrt{3}p}$$"
        },
        {
            "introduction": "This hands-on coding exercise bridges the gap between abstract theory and practical application, a vital skill in computational science. By implementing the unfolding operator for a perforated domain, you will numerically validate key theoretical properties and quantify errors arising from boundary effects. This practice offers a concrete feel for a powerful modern technique used in the numerical analysis of multiscale problems .",
            "id": "3794346",
            "problem": "Consider a bounded open domain $\\Omega \\subset \\mathbb{R}^2$ with $\\Omega = (0,1)^2$ and a periodic reference cell $Y = (0,1)^2$. Let $H \\subset Y$ be a hole modeled as a closed disk of radius $r \\in (0, \\frac{1}{2})$ centered at $c = (\\frac{1}{2}, \\frac{1}{2})$. Define the hole indicator by the characteristic function $\\chi(y) = \\mathbf{1}_{Y \\setminus H}(y)$, where $\\mathbf{1}_S$ denotes the characteristic function of a set $S$. For a periodic pattern of perforations with period $\\epsilon > 0$, define the perforated domain $\\Omega_\\epsilon = \\{ x \\in \\Omega : \\chi(\\{ \\frac{x}{\\epsilon} \\}) = 1 \\}$, where $\\{ \\cdot \\}$ denotes the componentwise fractional part modulo $1$, and its characteristic function $\\chi^\\epsilon(x) = \\chi\\!\\left(\\left\\{\\frac{x}{\\epsilon}\\right\\}\\right)\\mathbf{1}_{\\Omega}(x)$.\n\nThe Periodic Unfolding Method (PUM) maps functions defined on oscillatory domains to the fixed product space $\\Omega \\times Y$. For an integrable function $u^\\epsilon : \\Omega \\to \\mathbb{R}$, the unfolding operator $\\mathcal{T}_\\epsilon$ is defined by\n$$\n\\mathcal{T}_\\epsilon(u^\\epsilon)(x,y) =\n\\begin{cases}\nu^\\epsilon\\!\\left(\\epsilon\\left\\lfloor \\frac{x}{\\epsilon} \\right\\rfloor + \\epsilon y\\right), & \\text{if } \\epsilon\\left\\lfloor \\frac{x}{\\epsilon} \\right\\rfloor + \\epsilon y \\in \\Omega, \\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nwhere $\\lfloor \\cdot \\rfloor$ is the componentwise floor function mapping $\\mathbb{R}^2$ to $\\mathbb{Z}^2$. For perforated domains, the unfolded characteristic function $\\,\\mathcal{T}_\\epsilon(\\chi^\\epsilon)\\,$ satisfies\n$$\n\\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y) = \\chi(y)\\,\\mathbf{1}_{\\Omega_\\epsilon^Y}(x,y),\n$$\nwith $\\Omega_\\epsilon^Y = \\left\\{(x,y)\\in\\Omega\\times Y \\,:\\, \\epsilon\\left\\lfloor \\frac{x}{\\epsilon} \\right\\rfloor + \\epsilon y \\in \\Omega \\right\\}$, ensuring that holes are handled by the periodic mask $\\chi(y)$ and boundary effects are encoded by $\\mathbf{1}_{\\Omega_\\epsilon^Y}$.\n\nThe objective is to implement a program that:\n- Constructs $\\chi(y)$ on $Y$ for disk holes $H$ with radius $r$.\n- Implements the unfolded characteristic function for perforated domains via the unfolding operator $\\mathcal{T}_\\epsilon$.\n- Numerically validates the mass conservation property of the unfolding method for the characteristic function, which (in the ideal case without boundary remainder) reads\n$$\n\\int_{\\Omega_\\epsilon} \\chi^\\epsilon(x)\\,\\mathrm{d}x \\approx \\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x,\n$$\nand quantifies the discrepancy due to the boundary remainder set by computing the absolute difference\n$$\nE_{\\mathrm{mass}}(\\epsilon,r) = \\left| \\int_{\\Omega} \\chi^\\epsilon(x)\\,\\mathrm{d}x - \\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\right|.\n$$\n- Quantifies the convergence of the spatial average of $\\chi^\\epsilon$ toward the $Y$-average of $\\chi$ by computing the absolute difference\n$$\nE_{\\mathrm{frac}}(\\epsilon,r) = \\left| \\frac{1}{|\\Omega|}\\int_{\\Omega} \\chi^\\epsilon(x)\\,\\mathrm{d}x - \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y \\right|.\n$$\n\nUse a uniform Cartesian grid of size $N_\\Omega \\times N_\\Omega$ in $\\Omega$ and $N_Y \\times N_Y$ in $Y$, with $N_\\Omega = 1000$ and $N_Y = 1000$. Approximate integrals by simple Riemann sums using midpoints. Implement the unfolded integral on $\\Omega \\times Y$ by counting only the contribution of interior cells fully contained in $\\Omega$, i.e., those with cell origins $c = \\epsilon k$ satisfying $c_i \\in [0,1-\\epsilon]$ for each component $i$, which yields\n$$\n\\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x\n\\,\\approx\\,\n|\\Omega_{\\mathrm{int}}(\\epsilon)| \\cdot \\overline{\\chi}_Y,\n$$\nwhere $|\\Omega_{\\mathrm{int}}(\\epsilon)| = \\left( \\left\\lfloor \\frac{1-\\epsilon}{\\epsilon} \\right\\rfloor + 1 \\right)^2 \\epsilon^2$ is the area covered by interior cells and $\\overline{\\chi}_Y = \\frac{1}{|Y|}\\int_Y \\chi(y)\\,\\mathrm{d}y$ is the volume fraction of solid in $Y$.\n\nFor each test case $(\\epsilon,r)$, compute:\n- The mass discrepancy $E_{\\mathrm{mass}}(\\epsilon,r)$ as a float.\n- The volume fraction discrepancy $E_{\\mathrm{frac}}(\\epsilon,r)$ as a float.\n- The numerical estimate of $\\overline{\\chi}_Y$ as a float.\n\nYour program must implement the above and evaluate the following test suite:\n- Test $1$: $(\\epsilon,r) = (0.2,0.3)$.\n- Test $2$: $(\\epsilon,r) = (0.1,0.1)$.\n- Test $3$: $(\\epsilon,r) = (0.05,0.45)$.\n- Test $4$: $(\\epsilon,r) = (0.25,0.0)$.\n\nAll quantities are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of this list must itself be a comma-separated list of three floats corresponding to $[E_{\\mathrm{mass}},E_{\\mathrm{frac}},\\overline{\\chi}_Y]$ for the respective test case. For example, a valid output string has the form $[ [e_{1},f_{1},v_{1}], [e_{2},f_{2},v_{2}], [e_{3},f_{3},v_{3}], [e_{4},f_{4},v_{4}] ]$, but without any spaces in the printed output.",
            "solution": "The problem is valid. It presents a well-defined computational task within the mathematical field of periodic homogenization and numerical analysis. All terms are clearly defined, the parameters are provided, and the objectives are quantifiable and unambiguous. The problem is scientifically sound, self-contained, and formalizable.\n\nThe objective is to numerically investigate properties of the Periodic Unfolding Method (PUM) for a two-dimensional perforated domain. We are asked to compute two error metrics, $E_{\\mathrm{mass}}$ and $E_{\\mathrm{frac}}$, and the volume fraction of the solid material in the periodic cell, $\\overline{\\chi}_Y$, for a set of parameters $(\\epsilon, r)$.\n\nThe overall methodology involves the numerical approximation of several integrals using Riemann sums on uniform Cartesian grids.\n\n**Step 1: Domain and Grid Discretization**\n\nThe macroscopic domain is $\\Omega = (0,1)^2$ and the microscopic reference cell is $Y = (0,1)^2$. We discretize $\\Omega$ into a uniform grid of $N_\\Omega \\times N_\\Omega$ cells, where $N_\\Omega=1000$. Each cell has side length $h_\\Omega = 1/N_\\Omega$ and area $h_\\Omega^2$. We use cell midpoints for the Riemann sum: $x_{ij} = ((i+0.5)h_\\Omega, (j+0.5)h_\\Omega)$ for $i,j \\in \\{0, 1, \\dots, N_\\Omega-1\\}$.\n\nSimilarly, we discretize $Y$ into a $N_Y \\times N_Y$ grid, where $N_Y=1000$, with cell side length $h_Y = 1/N_Y$ and area $h_Y^2$. The midpoints are $y_{kl} = ((k+0.5)h_Y, (l+0.5)h_Y)$ for $k,l \\in \\{0, 1, \\dots, N_Y-1\\}$.\n\n**Step 2: Numerical Approximation of $\\overline{\\chi}_Y$**\n\nThe hole $H$ is a closed disk of radius $r$ centered at $c = (\\frac{1}{2}, \\frac{1}{2})$ within the cell $Y$. The characteristic function of the solid part of the cell is $\\chi(y) = \\mathbf{1}_{Y \\setminus H}(y)$, which is $1$ if $y \\notin H$ and $0$ if $y \\in H$. This condition translates to $\\chi(y) = 1$ if $\\|y - c\\|_2 > r$ and $\\chi(y) = 0$ if $\\|y - c\\|_2 \\le r$.\n\nThe volume fraction of the solid material in $Y$ is defined as $\\overline{\\chi}_Y = \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y$. Since $|Y|=1^2=1$, we have $\\overline{\\chi}_Y = \\int_{Y} \\chi(y)\\,\\mathrm{d}y$. We approximate this integral using a Riemann sum over the $Y$-grid:\n$$\n\\overline{\\chi}_Y \\approx \\sum_{k=0}^{N_Y-1} \\sum_{l=0}^{N_Y-1} \\chi(y_{kl}) h_Y^2 = \\frac{1}{N_Y^2} \\sum_{k=0}^{N_Y-1} \\sum_{l=0}^{N_Y-1} \\chi(y_{kl})\n$$\nwhere $\\chi(y_{kl}) = 1$ if $\\sqrt{( (k+0.5)h_Y - 0.5 )^2 + ( (l+0.5)h_Y - 0.5 )^2} > r$, and $0$ otherwise. This quantity is one of the three required outputs for each test case.\n\n**Step 3: Numerical Approximation of $\\int_{\\Omega} \\chi^\\epsilon(x) \\mathrm{d}x$**\n\nThe characteristic function of the perforated domain $\\Omega_\\epsilon$ is given by $\\chi^\\epsilon(x) = \\chi(\\{x/\\epsilon\\})$. The term $\\{x/\\epsilon\\}$ maps a point $x \\in \\Omega$ to its corresponding position in the reference cell $Y$. For a point $x=(x_1, x_2)$, this is $\\{x/\\epsilon\\} = (x_1/\\epsilon - \\lfloor x_1/\\epsilon \\rfloor, x_2/\\epsilon - \\lfloor x_2/\\epsilon \\rfloor)$.\n\nThe integral of $\\chi^\\epsilon$ over $\\Omega$ is approximated by a Riemann sum over the $\\Omega$-grid:\n$$\nI_\\Omega^\\epsilon := \\int_{\\Omega} \\chi^\\epsilon(x) \\mathrm{d}x \\approx \\sum_{i=0}^{N_\\Omega-1} \\sum_{j=0}^{N_\\Omega-1} \\chi^\\epsilon(x_{ij}) h_\\Omega^2 = \\frac{1}{N_\\Omega^2} \\sum_{i=0}^{N_\\Omega-1} \\sum_{j=0}^{N_\\Omega-1} \\chi(\\{(x_{ij})/\\epsilon\\})\n$$\nFor each grid point $x_{ij}$, we compute the microscopic coordinate $y'_{ij} = \\{x_{ij}/\\epsilon\\}$ and then evaluate $\\chi(y'_{ij})$ based on its distance from the center $c$.\n\n**Step 4: Computing the Discrepancy Quantities**\n\nThe problem requires the calculation of two discrepancies, $E_{\\mathrm{mass}}$ and $E_{\\mathrm{frac}}$.\n\nThe volume fraction discrepancy is defined as:\n$$\nE_{\\mathrm{frac}}(\\epsilon,r) = \\left| \\frac{1}{|\\Omega|}\\int_{\\Omega} \\chi^\\epsilon(x)\\,\\mathrm{d}x - \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y \\right|\n$$\nSince $|\\Omega|=1$ and $|Y|=1$, this simplifies to:\n$$\nE_{\\mathrm{frac}}(\\epsilon,r) = \\left| I_\\Omega^\\epsilon - \\overline{\\chi}_Y \\right|\n$$\nusing our numerical approximations for the integrals.\n\nThe mass discrepancy is defined as:\n$$\nE_{\\mathrm{mass}}(\\epsilon,r) = \\left| \\int_{\\Omega} \\chi^\\epsilon(x)\\,\\mathrm{d}x - \\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\right|\n$$\nThe problem specifies a particular numerical recipe for the second term, the integral of the unfolded function. It is to be approximated by considering only the contribution from interior cells of size $\\epsilon \\times \\epsilon$ that are fully contained within $\\Omega$. The area of this interior region is given by:\n$$\n|\\Omega_{\\mathrm{int}}(\\epsilon)| = \\left( \\left\\lfloor \\frac{1-\\epsilon}{\\epsilon} \\right\\rfloor + 1 \\right)^2 \\epsilon^2\n$$\nThe approximation for the unfolded integral is thus prescribed as:\n$$\nI_{\\text{unfold}} := \\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\approx |\\Omega_{\\mathrm{int}}(\\epsilon)| \\cdot \\overline{\\chi}_Y\n$$\nTherefore, the mass discrepancy is computed as:\n$$\nE_{\\mathrm{mass}}(\\epsilon,r) = \\left| I_\\Omega^\\epsilon - I_{\\text{unfold}} \\right| = \\left| I_\\Omega^\\epsilon - |\\Omega_{\\mathrm{int}}(\\epsilon)| \\cdot \\overline{\\chi}_Y \\right|\n$$\n\n**Algorithm Summary**\n\nFor each test case $(\\epsilon, r)$:\n1.  Define grid parameters $N_Y = 1000$ and $N_\\Omega = 1000$.\n2.  Construct a $2D$ grid of midpoints for the unit cell $Y$.\n3.  Compute the boolean mask for the hole $H$ on the $Y$-grid, and from this, the characteristic function array $\\chi_{kl}$.\n4.  Compute $\\overline{\\chi}_Y$ by taking the mean of the $\\chi_{kl}$ array. This is the third output value.\n5.  Construct a $2D$ grid of midpoints for the domain $\\Omega$.\n6.  For each point $x_{ij}$ on the $\\Omega$-grid, compute the microscopic coordinate $y'_{ij} = \\{x_{ij}/\\epsilon\\}$ and evaluate $\\chi(y'_{ij})$. This gives the array $\\chi^\\epsilon_{ij}$.\n7.  Compute the integral $I_\\Omega^\\epsilon$ by summing $\\chi^\\epsilon_{ij}$ and multiplying by the area element $h_\\Omega^2 = (1/N_\\Omega)^2$.\n8.  Calculate the area of interior cells $|\\Omega_{\\mathrm{int}}(\\epsilon)|$ using the given formula.\n9.  Compute the unfolded integral approximation $I_{\\text{unfold}} = |\\Omega_{\\mathrm{int}}(\\epsilon)| \\cdot \\overline{\\chi}_Y$.\n10. Compute $E_{\\mathrm{mass}} = |I_\\Omega^\\epsilon - I_{\\text{unfold}}|$. This is the first output value.\n11. Compute $E_{\\mathrm{frac}} = |I_\\Omega^\\epsilon - \\overline{\\chi}_Y|$. This is the second output value.\n12. Collate the three floating-point numbers $[E_{\\mathrm{mass}}, E_{\\mathrm{frac}}, \\overline{\\chi}_Y]$ for the current test case.\n13. After processing all test cases, format the results into the required string format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.2, 0.3),   # Test 1\n        (0.1, 0.1),   # Test 2\n        (0.05, 0.45), # Test 3\n        (0.25, 0.0),  # Test 4\n    ]\n\n    # Global numerical parameters\n    N_Omega = 1000\n    N_Y = 1000\n\n    results = []\n    for epsilon, r in test_cases:\n        result_triplet = compute_quantities(epsilon, r, N_Omega, N_Y)\n        results.append(result_triplet)\n\n    # Format the final output string exactly as specified.\n    # e.g., [[e1,f1,v1],[e2,f2,v2],...] with no spaces.\n    output_str = f\"[[{'],['.join([','.join(map(str, res)) for res in results])}]]\"\n    print(output_str)\n\ndef compute_quantities(epsilon, r, N_Omega, N_Y):\n    \"\"\"\n    Computes the three required quantities for a given (epsilon, r) pair.\n    \n    Args:\n        epsilon (float): The periodicity parameter.\n        r (float): The radius of the hole in the unit cell.\n        N_Omega (int): Grid size for the Omega domain.\n        N_Y (int): Grid size for the Y cell.\n\n    Returns:\n        list: A list of three floats [E_mass, E_frac, chi_bar_Y].\n    \"\"\"\n    # Step 1: Compute the numerical estimate of the volume fraction chi_bar_Y\n    h_Y = 1.0 / N_Y\n    y_coords = np.linspace(0.5 * h_Y, 1.0 - 0.5 * h_Y, N_Y)\n    yy1, yy2 = np.meshgrid(y_coords, y_coords, indexing='ij')\n\n    # Distance squared from the center of the cell Y\n    dist_sq_Y = (yy1 - 0.5)**2 + (yy2 - 0.5)**2\n    \n    # Characteristic function chi(y). It's 1 if outside the closed disk, 0 otherwise.\n    chi_Y = np.where(dist_sq_Y > r**2, 1.0, 0.0)\n    \n    # The integral of chi over Y (since |Y|=1) is approximated by the mean.\n    chi_bar_Y = np.mean(chi_Y)\n\n    # Step 2: Compute the numerical estimate of the integral of chi_epsilon over Omega\n    h_Omega = 1.0 / N_Omega\n    x_coords = np.linspace(0.5 * h_Omega, 1.0 - 0.5 * h_Omega, N_Omega)\n    xx1, xx2 = np.meshgrid(x_coords, x_coords, indexing='ij')\n\n    # Microscopic coordinates {x/epsilon}\n    y_prime_1 = (xx1 / epsilon) % 1.0\n    y_prime_2 = (xx2 / epsilon) % 1.0\n\n    # Distance squared from the center of the effective cell for each point in Omega\n    dist_sq_Omega = (y_prime_1 - 0.5)**2 + (y_prime_2 - 0.5)**2\n    \n    # Characteristic function chi_epsilon(x) = chi({x/epsilon})\n    chi_epsilon = np.where(dist_sq_Omega > r**2, 1.0, 0.0)\n    \n    # Riemann sum for the integral of chi_epsilon over Omega\n    integral_chi_epsilon = np.sum(chi_epsilon) * (h_Omega**2)\n\n    # Step 3: Compute the discrepancies\n    \n    # Area of interior cells\n    num_interior_cells_1d = np.floor((1.0 - epsilon) / epsilon) + 1.0\n    area_int = (num_interior_cells_1d**2) * (epsilon**2)\n    \n    # Prescribed approximation for the unfolded integral\n    integral_unfolded = area_int * chi_bar_Y\n    \n    # Mass discrepancy E_mass\n    E_mass = np.abs(integral_chi_epsilon - integral_unfolded)\n    \n    # Volume fraction discrepancy E_frac (since |Omega|=1)\n    E_frac = np.abs(integral_chi_epsilon - chi_bar_Y)\n\n    return [E_mass, E_frac, chi_bar_Y]\n\nsolve()\n```"
        }
    ]
}