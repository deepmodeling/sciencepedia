{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础但极具启发性的一维问题开始。这个练习旨在计算层状介质的有效电导率，这是一个在许多物理系统中都有直接类比的经典场景。通过推导有效系数，您将亲身体验为何在一维情况下，有效性质由调和平均给出，从而为更复杂的多维问题打下坚实的基础。",
            "id": "3794299",
            "problem": "考虑一个带有快速振荡系数的二阶线性椭圆型偏微分方程（PDE）的一维周期性均匀化问题。设 $a:\\mathbb{R}\\to(0,\\infty)$ 是一个可测、有界且周期为 1 的函数，并给定 $f\\in H^{-1}(0,L)$。对于 $\\varepsilon > 0$，考虑边值问题\n$$\n-\\frac{d}{dx}\\left(a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_\\varepsilon}{dx}(x)\\right)=f(x)\\quad\\text{in }(0,L),\\qquad u_\\varepsilon(0)=0,\\quad u_\\varepsilon(L)=0.\n$$\n从稳态椭圆算子的通量守恒基本概念和均匀化理论中使用的周期性元胞问题公式出发，推导控制极限方程的有效（均匀化）标量系数 $a^{\\text{hom}}$\n$$\n-\\frac{d}{dx}\\left(a^{\\text{hom}}\\frac{du_0}{dx}(x)\\right)=f(x)\\quad\\text{in }(0,L),\\qquad u_0(0)=0,\\quad u_0(L)=0,\n$$\n其中当 $\\varepsilon \\to 0$ 时，$u_\\varepsilon \\rightharpoonup u_0$ 在 $H_0^1(0,L)$ 中弱收敛于 $u_0$。然后，特化到一个每个周期具有两相的层状微观结构：设 $0  \\alpha  1$，$a_{1} > 0$ 且 $a_{2} > 0$，并定义\n$$\na(y)=\\begin{cases}\na_{1},  y\\in[0,\\alpha),\\\\\na_{2},  y\\in[\\alpha,1),\n\\end{cases}\n$$\n并将其周期性地延拓到 $\\mathbb{R}$。显式地计算均匀化系数 $a^{\\text{hom}}$，将其表示为 $\\alpha$、$a_{1}$ 和 $a_{2}$ 的封闭形式解析表达式，并从第一性原理出发解释为什么在一维（$d=1$）层状介质中会出现调和平均值。将最终答案表示为单个解析表达式。无需四舍五入，也无需物理单位。",
            "solution": "所述问题是二阶椭圆算子一维周期性均匀化的一个典型例子。它在数学上是适定的，科学上基于多尺度分析理论，并且提供了所有必要的条件和定义。该问题是有效的。\n\n我们的任务是推导方程的均匀化系数 $a^{\\text{hom}}$\n$$-\\frac{d}{dx}\\left(a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_\\varepsilon}{dx}(x)\\right)=f(x)\\quad\\text{in }(0,L)$$\n在狄利克雷边界条件 $u_\\varepsilon(0)=u_\\varepsilon(L)=0$ 下。系数 $a(y)$ 是一个周期为 1 的、可测且有界的函数，满足 $a(y) > c > 0$，其中 $c$ 为某个常数。已知解 $u_\\varepsilon$ 在 $H_0^1(0,L)$ 中弱收敛于 $u_0$，而 $u_0$ 满足均匀化方程：\n$$-\\frac{d}{dx}\\left(a^{\\text{hom}}\\frac{du_0}{dx}(x)\\right)=f(x)\\quad\\text{in }(0,L)$$\n\n$a^{\\text{hom}}$ 的推导可以从通量守恒和多尺度分析的角度进行。我们引入通量 $\\sigma_\\varepsilon(x) = -a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_\\varepsilon}{dx}(x)$。于是，偏微分方程变为 $\\frac{d\\sigma_\\varepsilon}{dx} = f(x)$。在极限 $\\varepsilon \\to 0$ 下，通量 $\\sigma_\\varepsilon$ 弱收敛于均匀化通量 $\\sigma_0(x)$，它通过有效定律 $\\sigma_0(x) = -a^{\\text{hom}}\\frac{du_0}{dx}(x)$ 与宏观梯度 $\\frac{du_0}{dx}$ 相关联。\n\n为了求得 $a^{\\text{hom}}$，我们在两个尺度上分析该问题：由变量 $x$ 表征的宏观尺度，以及由快变量 $y = x/\\varepsilon$ 表征的微观尺度。均匀化的核心思想是，对于小的 $\\varepsilon$，解的局部行为类似于在单个周期性元胞 $Y=[0,1)$ 上提出的问题的行为。\n\n让我们来考虑通量。在没有源项（$f=0$）的情况下，通量 $\\sigma_\\varepsilon$ 将是恒定的。有源项 $f$ 时，通量在宏观尺度上缓慢变化。然而，在微观尺度上，通量必须保持近似恒定。这是方程 $\\frac{d}{dx}(\\dots) = f$ 的一个推论。让我们使用双尺度 ansatz $u_\\varepsilon(x) \\approx u_0(x) + \\varepsilon u_1(x,y)$ 来表示解的梯度，其中 $u_1$ 在 $y$ 方向上是周期为 1 的：\n$$\\frac{du_\\varepsilon}{dx} = \\frac{du_0}{dx} + \\frac{\\partial u_1}{\\partial y} + O(\\varepsilon)$$\n因此，微观通量为\n$$\\sigma_\\varepsilon(x) \\approx -a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)$$\n在主导阶上，偏微分方程变成一个关于快变量 $y$ 的方程：\n$$-\\frac{1}{\\varepsilon}\\frac{\\partial}{\\partial y}\\left(a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)\\right) \\approx 0$$\n这意味着导数内的量，即微观通量，与 $y$ 无关。我们称这个微观通量为 $j(x)$。\n$$j(x) = -a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)$$\n这是跨越微观各层的通量守恒的表述。由此，我们表示出局部梯度场：\n$$\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y) = -\\frac{j(x)}{a(y)}$$\n根据定义，宏观梯度 $\\frac{du_0}{dx}$ 是微观梯度场在周期性元胞 $Y$ 上的平均值。我们将上述表达式在 $[0,1)$ 上对 $y$ 进行平均，记平均值为 $\\langle \\cdot \\rangle_y = \\int_0^1 (\\cdot) dy$。\n$$\\left\\langle \\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y) \\right\\rangle_y = \\left\\langle -\\frac{j(x)}{a(y)} \\right\\rangle_y$$\n由于 $\\frac{du_0}{dx}$ 和 $j(x)$ 不依赖于 $y$，它们在平均过程中可被视为常数。由于 $u_1$ 在 $y$ 方向上的周期性，$\\frac{\\partial u_1}{\\partial y}$ 的平均值为零：$\\langle \\frac{\\partial u_1}{\\partial y} \\rangle_y = \\int_0^1 \\frac{\\partial u_1}{\\partial y} dy = u_1(x,1) - u_1(x,0) = 0$。\n因此，方程简化为：\n$$\\frac{du_0}{dx}(x) = -j(x) \\left\\langle \\frac{1}{a(y)} \\right\\rangle_y$$\n宏观通量 $\\sigma_0(x)$ 是微观通量 $j(x,y)=j(x)$ 的平均值：\n$$\\sigma_0(x) = \\langle j(x) \\rangle_y = j(x)$$\n将 $j(x) = \\sigma_0(x)$ 代入前一个方程得到：\n$$\\frac{du_0}{dx}(x) = -\\sigma_0(x) \\left\\langle \\frac{1}{a(y)} \\right\\rangle_y$$\n整理得到宏观本构定律 $\\sigma_0(x) = -a^{\\text{hom}}\\frac{du_0}{dx}(x)$：\n$$\\sigma_0(x) = -\\frac{1}{\\left\\langle \\frac{1}{a(y)} \\right\\rangle_y} \\frac{du_0}{dx}(x)$$\n通过将其与均匀化通量的定义进行比较，我们确定了均匀化系数：\n$$a^{\\text{hom}} = \\frac{1}{\\left\\langle \\frac{1}{a(y)} \\right\\rangle_y} = \\frac{1}{\\int_0^1 \\frac{1}{a(y)} dy}$$\n这个公式表明，有效系数是微观系数在周期性元胞上的调和平均值。\n\n这个结果的出现是因为在一维介质中，材料层相对于通量（电流）方向是串联排列的。如果我们将 $a(y)$ 看作电导率，那么它的倒数 $\\rho(y) = 1/a(y)$ 就是电阻率。对于串联组件，总电阻是各个电阻之和。因此，有效电阻率 $\\rho^{\\text{hom}}$ 是微观电阻率的平均值：$\\rho^{\\text{hom}} = \\langle \\rho(y) \\rangle_y = \\int_0^1 (1/a(y)) dy$。有效电导率是有效电阻率的倒数，$a^{\\text{hom}} = 1/\\rho^{\\text{hom}}$，这直接导出了调和平均公式。\n\n现在，我们特化到给定的层状微观结构：\n$$\na(y)=\\begin{cases}\na_{1},  y\\in[0,\\alpha)\\\\\na_{2},  y\\in[\\alpha,1),\n\\end{cases}\n$$\n其中 $0  \\alpha  1$，$a_{1} > 0$ 且 $a_{2} > 0$。我们计算 $a^{\\text{hom}}$ 公式中分母的积分：\n$$\\int_0^1 \\frac{1}{a(y)} dy = \\int_0^\\alpha \\frac{1}{a(y)} dy + \\int_\\alpha^1 \\frac{1}{a(y)} dy$$\n代入 $a(y)$ 的分段值：\n$$\\int_0^1 \\frac{1}{a(y)} dy = \\int_0^\\alpha \\frac{1}{a_1} dy + \\int_\\alpha^1 \\frac{1}{a_2} dy$$\n$$= \\frac{1}{a_1} [y]_0^\\alpha + \\frac{1}{a_2} [y]_\\alpha^1$$\n$$= \\frac{\\alpha}{a_1} + \\frac{1-\\alpha}{a_2}$$\n这个表达式是平均电阻率，是两相电阻率的加权和，权重等于它们的体积分数 $\\alpha$ 和 $1-\\alpha$。\n\n最后，均匀化系数 $a^{\\text{hom}}$ 是该平均电阻率的倒数：\n$$a^{\\text{hom}} = \\frac{1}{\\frac{\\alpha}{a_1} + \\frac{1-\\alpha}{a_2}}$$\n为了得到单个封闭形式的表达式，我们简化该分数：\n$$a^{\\text{hom}} = \\frac{1}{\\frac{\\alpha a_2 + (1-\\alpha)a_1}{a_1 a_2}} = \\frac{a_1 a_2}{(1-\\alpha)a_1 + \\alpha a_2}$$\n这就是给定两相层状介质的均匀化系数的显式解析表达式。",
            "answer": "$$\\boxed{\\frac{a_1 a_2}{(1-\\alpha)a_1 + \\alpha a_2}}$$"
        },
        {
            "introduction": "在掌握了一维情形后，我们将挑战扩展到二维，并考虑一个更贴近实际应用的问题：边界条件的处理。这个练习要求您为一个具有特定微观结构的正交各向异性介质推导均质化张量和有效的诺伊曼边界条件。通过这个过程，您将理解均质化理论如何不仅能预测材料的体性质，还能确定在宏观尺度上等效的边界通量，并探讨边界层现象。",
            "id": "3794301",
            "problem": "考虑二维空间中带有诺伊曼（Neumann）边界条件的线性椭圆方程的周期性均匀化问题。令 $\\Omega = (0,1) \\times (0,1)$，系数场为 $\\mathbf{A}(y)$，其中 $y \\in Y = [0,1]^{2}$ 是单位周期元胞，定义为\n$$\n\\mathbf{A}(y) = \\begin{pmatrix}\na(y_{1})  0 \\\\\n0  1\n\\end{pmatrix},\n\\qquad a(y_{1}) = 2 + \\sin(2\\pi y_{1}),\n$$\n并将其延拓为 $\\mathbb{R}^{2}$ 上的一个 $Y$ 周期函数。考虑解族 $u_\\varepsilon$，其满足方程\n$$\n-\\nabla \\cdot \\big(\\mathbf{A}(x/\\varepsilon)\\,\\nabla u_\\varepsilon\\big) = 0 \\quad \\text{in } \\Omega,\n$$\n在右边界段 $\\Gamma = \\{1\\} \\times (0,1)$ 上具有常数诺伊曼边界条件，\n$$\n\\mathbf{A}(x/\\varepsilon)\\,\\nabla u_\\varepsilon \\cdot n = g_{0} \\quad \\text{on } \\Gamma,\n$$\n其中 $n = (1,0)$ 是单位外法向量，$g_{0}$ 是一个常实数。假设在 $\\partial \\Omega \\setminus \\Gamma$ 上给定适当的边界条件以确保问题的适定性。\n\n从通过周期性元胞问题得到的均匀化矩阵的基本定义出发，推导给定 $\\mathbf{A}(y)$ 的均匀化张量 $\\mathbf{A}^{\\mathrm{hom}}$，并对于均匀化极限 $u_0$，用均匀化通量和边界上的常数宏观梯度 $\\nabla u_0 = (p,q)$ 来表示 $\\Gamma$ 上的有效诺伊曼边界数据。从第一性原理出发，仔细论证每一步：定义元胞问题，论证修正项的结构，并计算所有必要的平均值。在你的分析中，讨论对于给定的常数边界数据，此诺伊曼问题是否会出现边界层，并解释如果诺伊曼边界数据是 $g^\\varepsilon(x) = \\phi + \\psi\\,b(x/\\varepsilon)$ 形式的振荡函数（其中 $b$ 是一个均值为零的 $Y$ 周期函数），这个结论将如何改变。\n\n你的最终任务是，以仅含 $p$ 的闭合形式，给出 $\\Gamma$ 上有效诺伊曼边界数据的显式表达式。最终答案必须是单一的解析表达式。不需要进行数值舍入。",
            "solution": "该问题陈述是椭圆偏微分方程周期性均匀化领域中一个适定的练习题。所有给定的数据、定义和条件在科学上都是合理的，在数学上是一致的，并构成一个自洽的问题。系数矩阵 $\\mathbf{A}(y)$ 是对称的，其特征值 $a(y_1) = 2+\\sin(2\\pi y_1)$ 和 $1$ 严格为正且有界，确保了一致椭圆性。因此，该问题适合进行分析。\n\n我们从第一性原理出发，对解 $u_\\varepsilon(x)$ 使用双尺度渐近展开。我们假设 $u_\\varepsilon(x)$ 可以按小参数 $\\varepsilon > 0$ 的幂次展开为：\n$$\nu_\\varepsilon(x) = u_0(x, y) + \\varepsilon u_1(x, y) + \\varepsilon^{2} u_2(x, y) + \\dots\n$$\n其中 $y = x/\\varepsilon$ 是快变量，每个函数 $u_{i}(x,y)$ 关于 $y$ 在单位元胞 $Y = [0,1]^2$ 上是周期的。梯度算子根据链式法则变换：$\\nabla \\to \\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y$。\n\n将此展开式代入控制方程 $-\\nabla \\cdot (\\mathbf{A}(x/\\varepsilon)\\,\\nabla u_\\varepsilon) = 0$ 中，得到：\n$$\n-\\left(\\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y\\right) \\cdot \\left[ \\mathbf{A}(y) \\left(\\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y\\right) (u_0 + \\varepsilon u_1 + \\dots) \\right] = 0.\n$$\n我们展开此表达式，并按 $\\varepsilon$ 的同次幂合并项。\n\n**$\\varepsilon^{-2}$ 阶：** 首项为：\n$$\n-\\nabla_y \\cdot (\\mathbf{A}(y) \\nabla_y u_0(x,y)) = 0.\n$$\n由于 $\\mathbf{A}(y)$ 是正定的，这个关于 $u_0$ 的带有周期性边界条件的椭圆方程（在变量 $y$ 上）意味着 $u_0$ 必须关于 $y$ 是常数。因此，$u_0 = u_0(x)$。\n\n**$\\varepsilon^{-1}$ 阶：** 合并 $\\varepsilon^{-1}$ 阶的项，得到：\n$$\n-\\nabla_y \\cdot (\\mathbf{A}(y) \\nabla_y u_1(x,y)) - \\nabla_y \\cdot (\\mathbf{A}(y) \\nabla_x u_0(x)) = 0.\n$$\n由于 $u_0$ 与 $y$ 无关，$\\nabla_x u_0$ 仅是 $x$ 的函数。该方程是线性的，因此我们寻求形如 $u_1$ 的解：\n$$\nu_1(x,y) = \\sum_{k=1}^{2} \\chi_{k}(y) \\frac{\\partial u_0}{\\partial x_k}(x) + C(x),\n$$\n其中 $\\chi_k(y)$ 是“修正”函数，它们是 $Y$ 周期的，并在 $Y$ 上的均值为零，$C(x)$ 是关于 $y$ 的积分常数。将此拟设代入 $\\varepsilon^{-1}$ 阶方程，并利用该式对任意宏观梯度 $\\nabla_x u_0$ 都必须成立的事实，我们得到每个修正项 $\\chi_k(y)$（$k=1,2$）的元胞问题：\n$$\n-\\nabla_y \\cdot (\\mathbf{A}(y) (\\nabla_y \\chi_{k}(y) + e_{k})) = 0 \\quad \\text{in } Y,\n$$\n其中 $e_k$ 是 $\\mathbb{R}^2$ 中的第 $k$ 个标准基向量，$\\chi_k$ 是 $Y$ 周期的。\n\n让我们对给定的矩阵 $\\mathbf{A}(y) = \\begin{pmatrix} a(y_1)  0 \\\\ 0  1 \\end{pmatrix}$（其中 $a(y_1) = 2 + \\sin(2\\pi y_1)$）求解这些元胞问题。\n\n对于 $k=1$，元胞问题为：\n$$\n-\\nabla_y \\cdot \\left( \\begin{pmatrix} a(y_1)  0 \\\\ 0  1 \\end{pmatrix} \\left( \\begin{pmatrix} \\partial_{y_1} \\chi_1 \\\\ \\partial_{y_2} \\chi_1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right) \\right) = -\\frac{\\partial}{\\partial y_1}\\left(a(y_1)\\left(\\frac{\\partial \\chi_1}{\\partial y_1} + 1\\right)\\right) - \\frac{\\partial^2 \\chi_1}{\\partial y_2^2} = 0.\n$$\n考虑到系数 $a$ 仅依赖于 $y_1$，我们寻求一个也只依赖于 $y_1$ 的解 $\\chi_1$，即 $\\chi_1 = \\chi_1(y_1)$。项 $\\partial^2 \\chi_1 / \\partial y_2^2$ 为零，方程简化为一个常微分方程：\n$$\n-\\frac{d}{dy_1}\\left(a(y_1)\\left(\\frac{d \\chi_1}{d y_1} + 1\\right)\\right) = 0.\n$$\n对 $y_1$ 积分得到 $a(y_1)(d\\chi_1/dy_1 + 1) = C_1$，其中 $C_1$ 为某个常数。因此，$d\\chi_1/dy_1 = C_1/a(y_1) - 1$。为了使 $\\chi_1$ 在 $y_1$ 上是周期的，其导数在 $[0,1]$ 上的平均值必须为零。\n$$\n\\int_0^1 \\frac{d\\chi_1}{dy_1} dy_1 = \\chi_1(1) - \\chi_1(0) = 0.\n$$\n所以，$\\int_0^1 (C_1/a(y_1) - 1) dy_1 = 0$，这给出 $C_1 \\int_0^1 \\frac{1}{a(y_1)} dy_1 - 1 = 0$。\n常数 $C_1$ 是 $a(y_1)$ 的调和平均值：$C_1 = \\left(\\int_0^1 \\frac{1}{a(y_1)} dy_1\\right)^{-1}$。\n\n对于 $k=2$，元胞问题为：\n$$\n-\\nabla_y \\cdot \\left( \\begin{pmatrix} a(y_1)  0 \\\\ 0  1 \\end{pmatrix} \\left( \\begin{pmatrix} \\partial_{y_1} \\chi_2 \\\\ \\partial_{y_2} \\chi_2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right) \\right) = -\\frac{\\partial}{\\partial y_1}\\left(a(y_1)\\frac{\\partial \\chi_2}{\\partial y_1}\\right) - \\frac{\\partial}{\\partial y_2}\\left(\\frac{\\partial \\chi_2}{\\partial y_2} + 1\\right) = 0.\n$$\n该方程的一个平凡解是 $\\chi_2(y) = 0$。它是周期的，并且满足方程，因为 $-\\frac{\\partial}{\\partial y_2}(1) = 0$。由于元胞问题的解在相差一个加性常数的意义下是唯一的，我们选择 $\\chi_2(y) \\equiv 0$。\n\n**$\\varepsilon^{0}$ 阶与均匀化张量：** 将 $\\varepsilon^0$ 阶方程在单位元胞 $Y$ 上取平均，并利用 $u_1$ 和 $u_2$ 的周期性，得到均匀化方程：\n$$\n-\\nabla_x \\cdot (\\mathbf{A}^{\\mathrm{hom}}\\nabla_x u_0) = 0.\n$$\n均匀化张量 $\\mathbf{A}^{\\mathrm{hom}}$ 由其分量定义：\n$$\nA^{\\mathrm{hom}}_{ij} = \\int_Y \\left( \\mathbf{A}(y) (e_j + \\nabla_y \\chi_j(y)) \\right)_i dy = \\int_Y \\sum_{k=1}^2 A_{ik}(y) (\\delta_{kj} + \\partial_{y_k} \\chi_j(y)) dy.\n$$\n我们来计算这些分量：\n$A^{\\mathrm{hom}}_{11} = \\int_0^1\\int_0^1 A_{11}(y_1) (1 + \\partial_{y_1}\\chi_1(y_1)) dy_2 dy_1 = \\int_0^1 a(y_1) (1 + \\frac{d\\chi_1}{dy_1}) dy_1 = \\int_0^1 C_1 dy_1 = C_1$。\n我们计算 $C_1 = \\left(\\int_0^1 \\frac{dy_1}{2+\\sin(2\\pi y_1)}\\right)^{-1}$。令 $u=2\\pi y_1$。积分变为 $\\frac{1}{2\\pi}\\int_0^{2\\pi} \\frac{du}{2+\\sin(u)}$。使用标准公式 $\\int_0^{2\\pi}\\frac{du}{\\alpha+\\beta\\sin u} = \\frac{2\\pi}{\\sqrt{\\alpha^2-\\beta^2}}$（对于 $\\alpha>|\\beta|$），其中 $\\alpha=2, \\beta=1$，我们得到 $\\frac{2\\pi}{\\sqrt{4-1}} = \\frac{2\\pi}{\\sqrt{3}}$。因此，关于 $y_1$ 的积分为 $\\frac{1}{2\\pi} \\frac{2\\pi}{\\sqrt{3}} = \\frac{1}{\\sqrt{3}}$。\n因此，$A^{\\mathrm{hom}}_{11} = C_1 = \\left(\\frac{1}{\\sqrt{3}}\\right)^{-1} = \\sqrt{3}$。\n\n$A^{\\mathrm{hom}}_{22} = \\int_Y A_{22}(y) (1 + \\partial_{y_2}\\chi_2(y)) dy = \\int_Y 1 \\cdot (1+0) dy = 1$。\n\n$A^{\\mathrm{hom}}_{12} = \\int_Y A_{11}(y) \\partial_{y_1}\\chi_2(y) dy = 0$ 因为 $\\chi_2=0$。\n\n$A^{\\mathrm{hom}}_{21} = \\int_Y A_{22}(y) \\partial_{y_2}\\chi_1(y) dy = 0$ 因为 $\\chi_1=\\chi_1(y_1)$。\n\n均匀化张量是对角的：$\\mathbf{A}^{\\mathrm{hom}} = \\begin{pmatrix} \\sqrt{3}  0 \\\\ 0  1 \\end{pmatrix}$。\n\n**边界条件分析：**\n在 $\\Gamma = \\{1\\}\\times(0,1)$ 上的诺伊曼条件是 $\\mathbf{A}(x/\\varepsilon)\\nabla u_\\varepsilon \\cdot n = g_0$，其中 $n=(1,0)$。这是通量的法向分量：在 $x_1=1$ 处有 $(\\mathbf{A}(y)\\nabla u_\\varepsilon)_1 = g_0$。\n代入展开式：$(\\mathbf{A}(y)[\\nabla_x u_0 + \\nabla_y u_1 + \\dots])_1 = g_0$。首阶项是：\n$$\n(\\mathbf{A}(y)(\\nabla_x u_0 + \\nabla_y u_1))_1 = (\\mathbf{A}(y) \\sum_{j=1}^2 (e_j + \\nabla_y \\chi_j) \\frac{\\partial u_0}{\\partial x_j})_1 = g_0.\n$$\n我们来计算括号中对于 $x \\in \\Gamma$ 的项。法向通量是：\n$$\n\\left(A_{11}(y)(e_1+\\nabla_y\\chi_1)\\partial_{x_1}u_0 + A_{11}(y)(e_2+\\nabla_y\\chi_2)\\partial_{x_2}u_0\\right)_1,\n$$\n这个写法不正确。我们来仔细地写一下。\n通量向量为 $\\sigma_\\varepsilon = \\mathbf{A}(y)(\\nabla_x u_0 + \\nabla_y u_1)$。其第一个分量是：\n$$\n(\\sigma_\\varepsilon)_1 = A_{11}(y)(\\partial_{x_1}u_0 + \\partial_{y_1}u_1) = a(y_1)(\\partial_{x_1}u_0 + \\partial_{y_1}\\chi_1\\partial_{x_1}u_0 + \\partial_{y_1}\\chi_2\\partial_{x_2}u_0).\n$$\n由于 $\\chi_2=0$，这可以简化为：\n$$\n(\\sigma_\\varepsilon)_1 = a(y_1)(1 + \\partial_{y_1}\\chi_1)\\partial_{x_1}u_0.\n$$\n从 $\\chi_1$ 的元胞问题中，我们得到 $a(y_1)(1 + d\\chi_1/dy_1) = C_1 = A^{\\mathrm{hom}}_{11} = \\sqrt{3}$。\n所以，首阶法向通量为 $(\\sigma_\\varepsilon)_1 = A^{\\mathrm{hom}}_{11} \\partial_{x_1} u_0 = \\sqrt{3} \\partial_{x_1} u_0$。\n这个表达式与快变量 $y$ 无关。因此，只要我们对极限解 $u_0$ 施加有效的（均匀化的）诺伊曼条件，$\\Gamma$ 上的边界条件就可以在首阶上被双尺度展开满足：\n$$\nA^{\\mathrm{hom}}_{11} \\frac{\\partial u_0}{\\partial x_1}\\Big|_{\\Gamma} = g_0 \\quad \\text{或} \\quad \\mathbf{A}^{\\mathrm{hom}}\\nabla u_0 \\cdot n \\Big|_{\\Gamma} = g_0.\n$$\n当标准展开由于微观振荡（宏观解无法匹配）而不能满足边界条件时，就需要一个边界层修正项。在这个具体案例中，微观通量的法向分量 $a(y_1)(1+\\partial_{y_1}\\chi_1)$ 是非振荡的。因此，对于常数诺伊曼数据 $g_0$，**不需要边界层**。\n\n**对振荡数据的修正：** 如果诺伊曼数据为 $g^\\varepsilon(x) = \\phi + \\psi\\,b(x/\\varepsilon)$，其中 $b$ 是均值为零的 $Y$ 周期函数，那么首阶边界条件将是：\n$$\n\\sqrt{3} \\frac{\\partial u_0}{\\partial x_1}\\Big|_{\\Gamma} = \\phi + \\psi\\,b(y).\n$$\n左边仅是宏观变量 $x$ 的函数，而右边随快变量 $y=x/\\varepsilon$ 振荡。这个等式不能成立。这种不匹配要求在渐近展开中引入一个边界层修正项，其形式通常为 $\\varepsilon \\theta(x, (1-x_1)/\\varepsilon, x_2/\\varepsilon)$，该项在远离边界时衰减。对于 $u_0$ 的有效边界条件，可以通过在快变量的一个周期上对条件进行平均来找到。由于 $\\langle b(y) \\rangle_Y=0$，$u_0$ 上的有效条件变为：\n$$\n\\sqrt{3} \\frac{\\partial u_0}{\\partial x_1}\\Big|_{\\Gamma} = \\langle \\phi + \\psi\\,b(y) \\rangle_Y = \\phi.\n$$\n振荡部分 $\\psi\\,b(y)$ 随后被边界层项捕捉。\n\n**最终计算：**\n问题要求给出 $\\Gamma$ 上有效诺伊曼边界数据的显式表达式，作为宏观梯度分量 $p$ 的函数。边界上的宏观梯度给定为 $\\nabla u_0 = (p,q)$。在 $\\Gamma$ 上的有效诺伊曼通量（法向量为 $n=(1,0)$）是均匀化通量向量 $\\sigma_0 = \\mathbf{A}^{\\mathrm{hom}} \\nabla u_0$ 的法向分量。\n$$\n\\sigma_0 \\cdot n = (\\mathbf{A}^{\\mathrm{hom}} \\nabla u_0) \\cdot n = \\left( \\begin{pmatrix} \\sqrt{3}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} p \\\\ q \\end{pmatrix} \\right) \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n$$\n\\sigma_0 \\cdot n = \\begin{pmatrix} \\sqrt{3}p \\\\ q \\end{pmatrix} \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\sqrt{3}p.\n$$\n这个表达式就是所要求的、仅作为 $p$ 的函数的有效诺伊曼数据。",
            "answer": "$$\\boxed{\\sqrt{3}p}$$"
        },
        {
            "introduction": "理论推导是理解均质化的基石，但将理论付诸实践的计算能力同样重要。这个练习将引导您从解析计算转向数值实现，通过编写程序来应用周期性展开法（Periodic Unfolding Method）。您将为一个带孔洞的周期性区域构建数值模型，并验证该方法的质量守恒性质，这对于处理具有复杂几何形状的微观结构问题是一种强大而现代的工具。",
            "id": "3794346",
            "problem": "考虑一个有界开区域 $\\Omega \\subset \\mathbb{R}^2$，其中 $\\Omega = (0,1)^2$，以及一个周期性参考单元 $Y = (0,1)^2$。设 $H \\subset Y$ 是一个孔洞，其模型为一个半径为 $r \\in (0, \\frac{1}{2})$、圆心在 $c = (\\frac{1}{2}, \\frac{1}{2})$ 的闭圆盘。通过特征函数 $\\chi(y) = \\mathbf{1}_{Y \\setminus H}(y)$ 定义孔洞指示函数，其中 $\\mathbf{1}_S$ 表示集合 $S$ 的特征函数。对于一个周期为 $\\epsilon > 0$ 的周期性穿孔图案，定义穿孔区域 $\\Omega_\\epsilon = \\{ x \\in \\Omega : \\chi(\\{\\frac{x}{\\epsilon}\\}) = 1 \\}$，其中 $\\{ \\cdot \\}$ 表示逐分量的模1小数部分，并定义其特征函数为 $\\chi^\\epsilon(x) = \\chi\\!\\left(\\left\\{\\frac{x}{\\epsilon}\\right\\}\\right)\\mathbf{1}_{\\Omega}(x)$。\n\n周期性展开方法 (Periodic Unfolding Method, PUM) 将定义在振荡区域上的函数映射到固定的乘积空间 $\\Omega \\times Y$。对于一个可积函数 $u^\\epsilon : \\Omega \\to \\mathbb{R}$，展开算子 $\\mathcal{T}_\\epsilon$ 定义为\n$$\n\\mathcal{T}_\\epsilon(u^\\epsilon)(x,y) =\n\\begin{cases}\nu^\\epsilon\\!\\left(\\epsilon\\left\\lfloor \\frac{x}{\\epsilon} \\right\\rfloor + \\epsilon y\\right),  \\text{若 } \\epsilon\\left\\lfloor \\frac{x}{\\epsilon} \\right\\rfloor + \\epsilon y \\in \\Omega, \\\\\n0,  \\text{否则},\n\\end{cases}\n$$\n其中 $\\lfloor \\cdot \\rfloor$ 是将 $\\mathbb{R}^2$ 映射到 $\\mathbb{Z}^2$ 的逐分量向下取整函数。对于穿孔区域，展开后的特征函数 $\\,\\mathcal{T}_\\epsilon(\\chi^\\epsilon)\\,$ 满足\n$$\n\\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y) = \\chi(y)\\,\\mathbf{1}_{\\Omega_\\epsilon^Y}(x,y),\n$$\n其中 $\\Omega_\\epsilon^Y = \\left\\{(x,y)\\in\\Omega\\times Y \\,:\\, \\epsilon\\left\\lfloor \\frac{x}{\\epsilon} \\right\\rfloor + \\epsilon y \\in \\Omega \\right\\}$，确保孔洞由周期性掩模 $\\chi(y)$ 处理，而边界效应则由 $\\mathbf{1}_{\\Omega_\\epsilon^Y}$ 编码。\n\n目标是实现一个程序，该程序能够：\n- 针对半径为 $r$ 的圆盘形孔洞 $H$，在 $Y$ 上构建 $\\chi(y)$。\n- 通过展开算子 $\\mathcal{T}_\\epsilon$ 实现穿孔区域的展开特征函数。\n- 数值验证展开方法对于特征函数的质量守恒性质，该性质（在没有边界余项的理想情况下）可表示为\n$$\n\\int_{\\Omega_\\epsilon} \\chi^\\epsilon(x)\\,\\mathrm{d}x \\approx \\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x,\n$$\n并通过计算绝对差来量化由边界余项集引起的差异\n$$\nE_{\\mathrm{mass}}(\\epsilon,r) = \\left| \\int_{\\Omega} \\chi^\\epsilon(x)\\,\\mathrm{d}x - \\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\right|.\n$$\n- 通过计算绝对差来量化 $\\chi^\\epsilon$ 的空间平均值向 $\\chi$ 的 $Y$-平均值的收敛性\n$$\nE_{\\mathrm{frac}}(\\epsilon,r) = \\left| \\frac{1}{|\\Omega|}\\int_{\\Omega} \\chi^\\epsilon(x)\\,\\mathrm{d}x - \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y \\right|.\n$$\n\n在 $\\Omega$ 中使用大小为 $N_\\Omega \\times N_\\Omega$ 的均匀笛卡尔网格，在 $Y$ 中使用大小为 $N_Y \\times N_Y$ 的均匀笛卡尔网格，其中 $N_\\Omega = 1000$ 且 $N_Y = 1000$。使用中点通过简单的黎曼和来近似积分。通过仅计算完全包含在 $\\Omega$ 内的内部单元的贡献来实现 $\\Omega \\times Y$ 上的展开积分，即单元原点 $c = \\epsilon k$ 满足每个分量 $i$ 都有 $c_i \\in [0,1-\\epsilon]$ 的那些单元，这得出\n$$\n\\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x\n\\,\\approx\\,\n|\\Omega_{\\mathrm{int}}(\\epsilon)| \\cdot \\overline{\\chi}_Y,\n$$\n其中 $|\\Omega_{\\mathrm{int}}(\\epsilon)| = \\left( \\left\\lfloor \\frac{1-\\epsilon}{\\epsilon} \\right\\rfloor + 1 \\right)^2 \\epsilon^2$ 是由内部单元覆盖的面积，而 $\\overline{\\chi}_Y = \\frac{1}{|Y|}\\int_Y \\chi(y)\\,\\mathrm{d}y$ 是 $Y$ 中固体部分的体积分数。\n\n对于每个测试用例 $(\\epsilon,r)$，计算：\n- 质量差异 $E_{\\mathrm{mass}}(\\epsilon,r)$，作为浮点数。\n- 体积分数差异 $E_{\\mathrm{frac}}(\\epsilon,r)$，作为浮点数。\n- $\\overline{\\chi}_Y$ 的数值估计，作为浮点数。\n\n您的程序必须实现以上内容，并评估以下测试套件：\n- 测试 1：$(\\epsilon,r) = (0.2,0.3)$。\n- 测试 2：$(\\epsilon,r) = (0.1,0.1)$。\n- 测试 3：$(\\epsilon,r) = (0.05,0.45)$。\n- 测试 4：$(\\epsilon,r) = (0.25,0.0)$。\n\n所有量均为无量纲。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。此列表的每个元素本身必须是一个包含三个浮点数的逗号分隔列表，对应于相应测试用例的 $[E_{\\mathrm{mass}},E_{\\mathrm{frac}},\\overline{\\chi}_Y]$。例如，一个有效的输出字符串形式为 $[ [e_{1},f_{1},v_{1}], [e_{2},f_{2},v_{2}], [e_{3},f_{3},v_{3}], [e_{4},f_{4},v_{4}] ]$，但在打印输出中不含任何空格。",
            "solution": "该问题是有效的。它在周期性均匀化和数值分析的数学领域内提出了一个定义明确的计算任务。所有术语都有清晰的定义，参数已提供，目标是可量化且明确的。该问题在科学上是合理的、自洽的，并且可以形式化。\n\n目标是数值研究周期性展开方法 (PUM) 应用于二维穿孔区域的性质。我们需要为一组参数 $(\\epsilon, r)$ 计算两个误差度量 $E_{\\mathrm{mass}}$ 和 $E_{\\mathrm{frac}}$，以及周期性单元中固体材料的体积分数 $\\overline{\\chi}_Y$。\n\n总体方法论涉及使用均匀笛卡尔网格上的黎曼和来对多个积分进行数值近似。\n\n**步骤 1：区域和网格离散化**\n\n宏观区域为 $\\Omega = (0,1)^2$，微观参考单元为 $Y = (0,1)^2$。我们将 $\\Omega$ 离散化为 $N_\\Omega \\times N_\\Omega$ 个单元的均匀网格，其中 $N_\\Omega=1000$。每个单元的边长为 $h_\\Omega = 1/N_\\Omega$，面积为 $h_\\Omega^2$。我们使用单元中点进行黎曼求和：$x_{ij} = ((i+0.5)h_\\Omega, (j+0.5)h_\\Omega)$，对于 $i,j \\in \\{0, 1, \\dots, N_\\Omega-1\\}$。\n\n类似地，我们将 $Y$ 离散化为 $N_Y \\times N_Y$ 的网格，其中 $N_Y=1000$，单元边长为 $h_Y = 1/N_Y$，面积为 $h_Y^2$。中点为 $y_{kl} = ((k+0.5)h_Y, (l+0.5)h_Y)$，对于 $k,l \\in \\{0, 1, \\dots, N_Y-1\\}$。\n\n**步骤 2：$\\overline{\\chi}_Y$ 的数值近似**\n\n孔洞 $H$ 是单元 $Y$ 内一个半径为 $r$、圆心在 $c = (\\frac{1}{2}, \\frac{1}{2})$ 的闭圆盘。单元实体部分的特征函数是 $\\chi(y) = \\mathbf{1}_{Y \\setminus H}(y)$，如果 $y \\notin H$ 则为 1，如果 $y \\in H$ 则为 0。此条件可转换为：如果 $\\|y - c\\|_2 > r$ 则 $\\chi(y) = 1$，如果 $\\|y - c\\|_2 \\le r$ 则 $\\chi(y) = 0$。\n\n$Y$ 中固体材料的体积分数定义为 $\\overline{\\chi}_Y = \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y$。由于 $|Y|=1^2=1$，我们有 $\\overline{\\chi}_Y = \\int_{Y} \\chi(y)\\,\\mathrm{d}y$。我们使用 $Y$-网格上的黎曼和来近似这个积分：\n$$\n\\overline{\\chi}_Y \\approx \\sum_{k=0}^{N_Y-1} \\sum_{l=0}^{N_Y-1} \\chi(y_{kl}) h_Y^2 = \\frac{1}{N_Y^2} \\sum_{k=0}^{N_Y-1} \\sum_{l=0}^{N_Y-1} \\chi(y_{kl})\n$$\n其中，如果 $\\sqrt{( (k+0.5)h_Y - 0.5 )^2 + ( (l+0.5)h_Y - 0.5 )^2} > r$，则 $\\chi(y_{kl}) = 1$，否则为 0。这个量是每个测试用例所需的三个输出之一。\n\n**步骤 3：$\\int_{\\Omega} \\chi^\\epsilon(x) \\mathrm{d}x$ 的数值近似**\n\n穿孔区域 $\\Omega_\\epsilon$ 的特征函数由 $\\chi^\\epsilon(x) = \\chi(\\{x/\\epsilon\\})$ 给出。项 $\\{x/\\epsilon\\}$ 将点 $x \\in \\Omega$ 映射到其在参考单元 $Y$ 中的对应位置。对于一个点 $x=(x_1, x_2)$，这等于 $\\{x/\\epsilon\\} = (x_1/\\epsilon - \\lfloor x_1/\\epsilon \\rfloor, x_2/\\epsilon - \\lfloor x_2/\\epsilon \\rfloor)$。\n\n$\\chi^\\epsilon$ 在 $\\Omega$ 上的积分通过 $\\Omega$-网格上的黎曼和来近似：\n$$\nI_\\Omega^\\epsilon := \\int_{\\Omega} \\chi^\\epsilon(x) \\mathrm{d}x \\approx \\sum_{i=0}^{N_\\Omega-1} \\sum_{j=0}^{N_\\Omega-1} \\chi^\\epsilon(x_{ij}) h_\\Omega^2 = \\frac{1}{N_\\Omega^2} \\sum_{i=0}^{N_\\Omega-1} \\sum_{j=0}^{N_\\Omega-1} \\chi(\\{(x_{ij})/\\epsilon\\})\n$$\n对于每个网格点 $x_{ij}$，我们计算其微观坐标 $y'_{ij} = \\{x_{ij}/\\epsilon\\}$，然后根据其与中心 $c$ 的距离来评估 $\\chi(y'_{ij})$。\n\n**步骤 4：计算差异量**\n\n问题要求计算两个差异量，$E_{\\mathrm{mass}}$ 和 $E_{\\mathrm{frac}}$。\n\n体积分数差异定义为：\n$$\nE_{\\mathrm{frac}}(\\epsilon,r) = \\left| \\frac{1}{|\\Omega|}\\int_{\\Omega} \\chi^\\epsilon(x)\\,\\mathrm{d}x - \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y \\right|\n$$\n由于 $|\\Omega|=1$ 且 $|Y|=1$，使用我们对积分的数值近似，这可以简化为：\n$$\nE_{\\mathrm{frac}}(\\epsilon,r) = \\left| I_\\Omega^\\epsilon - \\overline{\\chi}_Y \\right|\n$$\n\n质量差异定义为：\n$$\nE_{\\mathrm{mass}}(\\epsilon,r) = \\left| \\int_{\\Omega} \\chi^\\epsilon(x)\\,\\mathrm{d}x - \\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\right|\n$$\n问题为第二项，即展开函数的积分，指定了一个特定的数值计算方法。它将通过仅考虑完全包含在 $\\Omega$ 内的大小为 $\\epsilon \\times \\epsilon$ 的内部单元的贡献来近似。这个内部区域的面积由以下公式给出：\n$$\n|\\Omega_{\\mathrm{int}}(\\epsilon)| = \\left( \\left\\lfloor \\frac{1-\\epsilon}{\\epsilon} \\right\\rfloor + 1 \\right)^2 \\epsilon^2\n$$\n因此，展开积分的近似被规定为：\n$$\nI_{\\text{unfold}} := \\int_{\\Omega\\times Y} \\mathcal{T}_\\epsilon(\\chi^\\epsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\approx |\\Omega_{\\mathrm{int}}(\\epsilon)| \\cdot \\overline{\\chi}_Y\n$$\n因此，质量差异计算如下：\n$$\nE_{\\mathrm{mass}}(\\epsilon,r) = \\left| I_\\Omega^\\epsilon - I_{\\text{unfold}} \\right| = \\left| I_\\Omega^\\epsilon - |\\Omega_{\\mathrm{int}}(\\epsilon)| \\cdot \\overline{\\chi}_Y \\right|\n$$\n\n**算法摘要**\n\n对于每个测试用例 $(\\epsilon, r)$：\n1.  定义网格参数 $N_Y = 1000$ 和 $N_\\Omega = 1000$。\n2.  为单元 $Y$ 构建一个二维中点网格。\n3.  计算 $Y$-网格上孔洞 H 的布尔掩码，并由此得到特征函数数组 $\\chi_{kl}$。\n4.  通过取 $\\chi_{kl}$ 数组的平均值来计算 $\\overline{\\chi}_Y$。这是第三个输出值。\n5.  为区域 $\\Omega$ 构建一个二维中点网格。\n6.  对于 $\\Omega$-网格上的每个点 $x_{ij}$，计算微观坐标 $y'_{ij} = \\{x_{ij}/\\epsilon\\}$ 并评估 $\\chi(y'_{ij})$。这会得到数组 $\\chi^\\epsilon_{ij}$。\n7.  通过对 $\\chi^\\epsilon_{ij}$ 求和并乘以面积元 $h_\\Omega^2 = (1/N_\\Omega)^2$ 来计算积分 $I_\\Omega^\\epsilon$。\n8.  使用给定公式计算内部单元的面积 $|\\Omega_{\\mathrm{int}}(\\epsilon)|$。\n9.  计算展开积分的近似值 $I_{\\text{unfold}} = |\\Omega_{\\mathrm{int}}(\\epsilon)| \\cdot \\overline{\\chi}_Y$。\n10. 计算 $E_{\\mathrm{mass}} = |I_\\Omega^\\epsilon - I_{\\text{unfold}}|$。这是第一个输出值。\n11. 计算 $E_{\\mathrm{frac}} = |I_\\Omega^\\epsilon - \\overline{\\chi}_Y|$。这是第二个输出值。\n12. 整理当前测试用例的三个浮点数 $[E_{\\mathrm{mass}}, E_{\\mathrm{frac}}, \\overline{\\chi}_Y]$。\n13. 处理完所有测试用例后，将结果格式化为所需的字符串格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.2, 0.3),   # Test 1\n        (0.1, 0.1),   # Test 2\n        (0.05, 0.45), # Test 3\n        (0.25, 0.0),  # Test 4\n    ]\n\n    # Global numerical parameters\n    N_Omega = 1000\n    N_Y = 1000\n\n    results = []\n    for epsilon, r in test_cases:\n        result_triplet = compute_quantities(epsilon, r, N_Omega, N_Y)\n        results.append(result_triplet)\n\n    # Format the final output string exactly as specified.\n    # e.g., [[e1,f1,v1],[e2,f2,v2],...] with no spaces.\n    output_str = f\"[[{'],['.join([','.join(map(str, res)) for res in results])}]]\"\n    print(output_str)\n\ndef compute_quantities(epsilon, r, N_Omega, N_Y):\n    \"\"\"\n    Computes the three required quantities for a given (epsilon, r) pair.\n    \n    Args:\n        epsilon (float): The periodicity parameter.\n        r (float): The radius of the hole in the unit cell.\n        N_Omega (int): Grid size for the Omega domain.\n        N_Y (int): Grid size for the Y cell.\n\n    Returns:\n        list: A list of three floats [E_mass, E_frac, chi_bar_Y].\n    \"\"\"\n    # Step 1: Compute the numerical estimate of the volume fraction chi_bar_Y\n    h_Y = 1.0 / N_Y\n    y_coords = np.linspace(0.5 * h_Y, 1.0 - 0.5 * h_Y, N_Y)\n    yy1, yy2 = np.meshgrid(y_coords, y_coords, indexing='ij')\n\n    # Distance squared from the center of the cell Y\n    dist_sq_Y = (yy1 - 0.5)**2 + (yy2 - 0.5)**2\n    \n    # Characteristic function chi(y). It's 1 if outside the closed disk, 0 otherwise.\n    chi_Y = np.where(dist_sq_Y  r**2, 1.0, 0.0)\n    \n    # The integral of chi over Y (since |Y|=1) is approximated by the mean.\n    chi_bar_Y = np.mean(chi_Y)\n\n    # Step 2: Compute the numerical estimate of the integral of chi_epsilon over Omega\n    h_Omega = 1.0 / N_Omega\n    x_coords = np.linspace(0.5 * h_Omega, 1.0 - 0.5 * h_Omega, N_Omega)\n    xx1, xx2 = np.meshgrid(x_coords, x_coords, indexing='ij')\n\n    # Microscopic coordinates {x/epsilon}\n    y_prime_1 = (xx1 / epsilon) % 1.0\n    y_prime_2 = (xx2 / epsilon) % 1.0\n\n    # Distance squared from the center of the effective cell for each point in Omega\n    dist_sq_Omega = (y_prime_1 - 0.5)**2 + (y_prime_2 - 0.5)**2\n    \n    # Characteristic function chi_epsilon(x) = chi({x/epsilon})\n    chi_epsilon = np.where(dist_sq_Omega  r**2, 1.0, 0.0)\n    \n    # Riemann sum for the integral of chi_epsilon over Omega\n    integral_chi_epsilon = np.sum(chi_epsilon) * (h_Omega**2)\n\n    # Step 3: Compute the discrepancies\n    \n    # Area of interior cells\n    num_interior_cells_1d = np.floor((1.0 - epsilon) / epsilon) + 1.0\n    area_int = (num_interior_cells_1d**2) * (epsilon**2)\n    \n    # Prescribed approximation for the unfolded integral\n    integral_unfolded = area_int * chi_bar_Y\n    \n    # Mass discrepancy E_mass\n    E_mass = np.abs(integral_chi_epsilon - integral_unfolded)\n    \n    # Volume fraction discrepancy E_frac (since |Omega|=1)\n    E_frac = np.abs(integral_chi_epsilon - chi_bar_Y)\n\n    return [E_mass, E_frac, chi_bar_Y]\n\nsolve()\n```"
        }
    ]
}