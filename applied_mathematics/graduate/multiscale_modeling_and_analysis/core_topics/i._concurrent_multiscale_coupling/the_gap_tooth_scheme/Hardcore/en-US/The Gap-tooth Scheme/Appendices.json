{
    "hands_on_practices": [
        {
            "introduction": "A fundamental prerequisite for any explicit time-stepping scheme is numerical stability. In the context of the gap-tooth scheme, this requires a careful analysis of how the macro-level time step, $\\Delta t$, relates to the finest-scale dynamics resolved within the micro-solver patches. This first practice challenges you to derive a coarse-grained Courant-Friedrichs-Lewy (CFL) stability condition from first principles, connecting the macro time step to the patch size and the underlying physical diffusivity . Successfully completing this exercise is key to understanding how stability is maintained in a multiscale simulation without resolving every fine-scale detail across the entire domain.",
            "id": "3819099",
            "problem": "Consider the gap-tooth scheme for a one-dimensional ($1$D) diffusive process governed microscopically by the partial differential equation (PDE) $\\partial_{t} u = D \\,\\partial_{xx} u$, where $D$ is the constant diffusivity. The macroscopic solver advances a coarse variable $U$ (defined as the patch-averaged microscopic field) with a forward Euler macro-step of size $\\Delta t$, using a “slope” provided by a microscopic time integration over a short microscopic time $\\tau$ inside each patch of physical width $\\delta$. Within each patch, the microscopic solver imposes Dirichlet-type boundary conditions that are consistent with the coarse field and suppress spurious inter-patch transients; assume the microscopic spectrum within a patch is that of the Laplacian on an interval of length $\\delta$. The Courant-Friedrichs-Lewy (CFL) condition is a classical stability guideline for explicit time stepping in PDEs.\n\nStarting from first principles for diffusion and using appropriate spectral or energy arguments at the patch level, derive a coarse CFL-like stability requirement that constrains $\\Delta t$ in terms of $D$ and $\\delta$ so that the explicit coarse forward Euler update is linearly stable against the fastest coarse-resolvable diffusive mode supported by the patch closure. Assume that the coarse update faithfully represents diffusive decay rates for Fourier modes up to the highest wavenumber supported by the patch geometry.\n\nProvide the largest allowable macro time step $\\Delta t_{\\max}$ as a single closed-form analytic expression in terms of $D$ and $\\delta$. Express your final answer in seconds. No numerical values are provided; your derivation must rely only on the diffusion equation, standard properties of the Laplacian eigen-spectrum on an interval, and explicit Euler stability for linear decay. Do not invoke any shortcut formulas beyond these foundational elements. Your final answer must be a single expression, not an inequality or a sentence.",
            "solution": "The problem requires the derivation of a stability condition for the macro-time-step $\\Delta t$ of a gap-tooth scheme applied to a one-dimensional diffusion process, $\\partial_{t} u = D \\,\\partial_{xx} u$. The scheme uses a forward Euler update for the coarse variable $U$.\n\nThe forward Euler update for the coarse variable $U$ at a given time $t$ is of the form:\n$$ U(t + \\Delta t) = U(t) + \\Delta t \\cdot \\mathcal{F}(U(t)) $$\nwhere $\\mathcal{F}(U(t))$ represents the time derivative of $U$ estimated by the microscopic solver. Since the underlying process is linear, we can analyze the stability of this numerical scheme by considering its action on a single Fourier mode of the coarse field. Let the coarse spatial variable be $X$, with the coarse grid having a spacing equal to the patch width, $\\delta$. A Fourier mode on this coarse grid can be written as $U(X,t) = \\hat{U}(k, t) e^{i k X}$, where $k$ is the coarse wavenumber.\n\nFor a diffusive process, this mode is expected to decay exponentially in time as $\\hat{U}(k, t) = \\hat{U}(k, 0) e^{-\\lambda(k) t}$, where $\\lambda(k)$ is the decay rate associated with wavenumber $k$. The time derivative is thus $\\frac{d\\hat{U}}{dt} = -\\lambda(k) \\hat{U}$. The forward Euler update for the amplitude of this mode is:\n$$ \\hat{U}(k, t + \\Delta t) = \\hat{U}(k, t) - \\Delta t \\cdot \\lambda(k) \\hat{U}(k,t) = (1 - \\Delta t \\lambda(k)) \\hat{U}(k,t) $$\nThe amplification factor for this update is $g(k) = 1 - \\Delta t \\lambda(k)$. For linear stability, we require $|g(k)| \\leq 1$ for all relevant wavenumbers $k$. Since $\\lambda(k)$ represents a physical decay rate for a passive system, it must be non-negative, $\\lambda(k) \\ge 0$. The condition $|1 - \\Delta t \\lambda(k)| \\leq 1$ is therefore equivalent to:\n$$ -1 \\leq 1 - \\Delta t \\lambda(k) \\leq 1 $$\nThe upper bound, $1 - \\Delta t \\lambda(k) \\leq 1$, implies $-\\Delta t \\lambda(k) \\leq 0$, which is always satisfied for $\\Delta t  0$ and $\\lambda(k) \\ge 0$. The lower bound, $-1 \\leq 1 - \\Delta t \\lambda(k)$, yields the stability constraint:\n$$ \\Delta t \\lambda(k) \\leq 2 $$\nThis must hold true for all modes $k$ the scheme is designed to resolve. The most restrictive condition is imposed by the mode with the largest decay rate, $\\lambda_{\\max}$:\n$$ \\Delta t \\leq \\frac{2}{\\lambda_{\\max}} $$\nThe problem is to determine this $\\lambda_{\\max}$. We are given two crucial pieces of information.\nFirst, the problem states that \"The coarse update faithfully represents diffusive decay rates for Fourier modes up to the highest wavenumber supported by the patch geometry.\" For the continuous diffusion PDE, $\\partial_{t} u = D \\,\\partial_{xx} u$, a Fourier mode $e^{ikx}$ evolves with a decay rate $\\lambda(k) = D k^2$. The assumption of faithful representation means that the effective coarse-grained dynamics also have this dispersion relation, $\\lambda(k) = D k^2$.\n\nSecond, we must identify the \"fastest coarse-resolvable diffusive mode\". The coarse grid is composed of patches of width $\\delta$, which implies an effective grid spacing of $\\delta$. According to the Nyquist-Shannon sampling theorem, a grid with spacing $\\delta$ can resolve wavelengths down to a minimum of $2\\delta$. This corresponds to a maximum wavenumber (the Nyquist frequency) of:\n$$ k_{\\max} = \\frac{2\\pi}{2\\delta} = \\frac{\\pi}{\\delta} $$\nThis mode represents the most oscillatory pattern that can be supported by the coarse grid, where the values of $U$ alternate in sign from one patch to the next.\n\nCombining these facts, the maximum decay rate that the coarse forward Euler scheme must handle is the decay rate of the continuous PDE evaluated at the maximum resolvable wavenumber:\n$$ \\lambda_{\\max} = \\lambda(k_{\\max}) = D k_{\\max}^2 = D \\left(\\frac{\\pi}{\\delta}\\right)^2 = \\frac{D\\pi^2}{\\delta^2} $$\nSubstituting this expression for $\\lambda_{\\max}$ into the stability condition for the forward Euler step gives:\n$$ \\Delta t \\leq \\frac{2}{\\frac{D\\pi^2}{\\delta^2}} = \\frac{2\\delta^2}{D\\pi^2} $$\nThis result represents the coarse CFL-like stability requirement for the macro-time-step. The largest allowable time step, $\\Delta t_{\\max}$, is the upper limit of this inequality.\n\nWe can verify the consistency of this result with the statement that \"the microscopic spectrum within a patch is that of the Laplacian on an interval of length $\\delta$\". This implies Dirichlet boundary conditions are imposed on the patch-level problem. The eigenfunctions of the Laplacian operator $\\partial_{xx}$ on an interval of length $\\delta$ with Dirichlet boundary conditions are $\\phi_n(x) = \\sin(n\\pi x/\\delta)$, and the corresponding eigenvalues of $-\\partial_{xx}$ are $(n\\pi/\\delta)^2$ for $n=1, 2, 3, \\ldots$. The decay rates for the microscopic diffusion equation $\\partial_t u = D \\partial_{xx} u$ in the patch are $\\mu_n = D(n\\pi/\\delta)^2$. The slowest of these microscopic decay rates (the fundamental mode, $n=1$) is $\\mu_1 = D(\\pi/\\delta)^2$. The gap-tooth scheme is constructed such that the evolution of the coarse variable is governed by the slowest relaxation processes inside the patches that are consistent with the coarse data. The fastest coarse mode ($k_{\\max} = \\pi/\\delta$) excites a microscopic field profile closely resembling the fundamental eigenmode of the patch ($n=1$), confirming that the decay rate $\\lambda_{\\max}$ seen by the coarse solver is indeed $\\mu_1 = D(\\pi/\\delta)^2$.\n\nThus, the largest allowable macro time step is:\n$$ \\Delta t_{\\max} = \\frac{2\\delta^2}{D\\pi^2} $$\nThe units of this expression are $[\\text{length}]^2 / ([\\text{length}]^2 / [\\text{time}]) = [\\text{time}]$, which is consistent with the problem's request for an answer in seconds, assuming base SI units are used for $D$ and $\\delta$.",
            "answer": "$$\\boxed{\\frac{2\\delta^{2}}{D\\pi^{2}}}$$"
        },
        {
            "introduction": "Having established a stable time step, we now turn to another crucial component: the restriction operator, which maps rich microscale information back to the coarse grid. Unresolved micro-structures within a patch can introduce noise if not handled properly, and the choice of restriction method is critical to mitigating this. This exercise asks you to analyze and compare two common restriction techniques—pointwise sampling and volume averaging—by calculating their bias and variance in the presence of sub-patch oscillations . This analysis will provide concrete insight into how to design robust operators that filter out unwanted microscale noise.",
            "id": "3819081",
            "problem": "Consider a one-dimensional gap-tooth coarse time-stepper for a spatially smooth macroscopic field. Within a single tooth centered at location $X$ with width $h$, suppose the micro-solution exhibits subtooth oscillations of wavelength $O(\\epsilon)$ that can be modeled, to leading order over the tooth, by\n$$\nu_{\\epsilon}(x) = U + a \\cos\\left(\\frac{2\\pi}{\\epsilon}x + \\Theta\\right),\n$$\nwhere $U$ and $a$ are macroscopic quantities that are approximately constant over the tooth, $\\epsilon0$ satisfies $\\epsilon \\ll h$, and $\\Theta$ is an unknown micro-phase modeled as a random variable uniformly distributed on $[0,2\\pi)$ and independent across realizations. Define two restriction operators that map the micro-solution in the tooth to a coarse observable:\n- Pointwise restriction at the tooth center: $R_{\\mathrm{pt}} = u_{\\epsilon}(X)$.\n- Volume-averaged restriction over the tooth: $R_{\\mathrm{av}} = \\dfrac{1}{h}\\,\\displaystyle\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} u_{\\epsilon}(x)\\,dx$.\n\nUsing only the definitions of expectation and variance, and standard calculus identities, compute the bias and variance of each restriction relative to the macroscopic quantity $U$, by averaging over the micro-phase $\\Theta$. Explicitly, compute\n$$\nb_{\\mathrm{pt}} = \\mathbb{E}[R_{\\mathrm{pt}}] - U,\\quad b_{\\mathrm{av}} = \\mathbb{E}[R_{\\mathrm{av}}] - U,\\quad v_{\\mathrm{pt}} = \\mathrm{Var}(R_{\\mathrm{pt}}),\\quad v_{\\mathrm{av}} = \\mathrm{Var}(R_{\\mathrm{av}}),\n$$\nas functions of $a$, $h$, and $\\epsilon$.\n\nProvide your final result as a single row matrix in the order $\\bigl[b_{\\mathrm{pt}},\\, b_{\\mathrm{av}},\\, v_{\\mathrm{pt}},\\, v_{\\mathrm{av}}\\bigr]$. No numerical approximation or rounding is required, and no physical units are involved. Express trigonometric terms exactly; do not approximate for small $\\epsilon/h$ in the final answer.",
            "solution": "The core of the problem is to compute the expectation and variance of functions of a random variable $\\Theta$, which is uniformly distributed on the interval $[0, 2\\pi)$. The probability density function (PDF) for $\\Theta$ is $f(\\theta) = \\frac{1}{2\\pi}$ for $\\theta \\in [0, 2\\pi)$ and $f(\\theta) = 0$ otherwise. The expectation of any function $g(\\Theta)$ is given by\n$$\n\\mathbb{E}[g(\\Theta)] = \\int_{0}^{2\\pi} g(\\theta) f(\\theta) d\\theta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} g(\\theta) d\\theta.\n$$\nThe variance is given by $\\mathrm{Var}(g(\\Theta)) = \\mathbb{E}[g(\\Theta)^2] - (\\mathbb{E}[g(\\Theta)])^2$.\n\nWe will use two fundamental integral identities over a period of $2\\pi$:\nFor any integer $n \\neq 0$ and any constant phase $\\phi$,\n$$\n\\int_{0}^{2\\pi} \\cos(n\\theta + \\phi) d\\theta = 0\n$$\n$$\n\\int_{0}^{2\\pi} \\cos^2(\\theta + \\phi) d\\theta = \\int_{0}^{2\\pi} \\frac{1+\\cos(2(\\theta+\\phi))}{2} d\\theta = \\frac{1}{2} \\left[ \\theta \\right]_{0}^{2\\pi} + \\frac{1}{2}\\int_{0}^{2\\pi} \\cos(2\\theta+2\\phi) d\\theta = \\pi.\n$$\nFrom these, we derive the expectations:\n$\\mathbb{E}[\\cos(n\\Theta + \\phi)] = \\frac{1}{2\\pi} \\cdot 0 = 0$ for $n \\in \\mathbb{Z}, n \\neq 0$.\n$\\mathbb{E}[\\cos^2(\\Theta + \\phi)] = \\frac{1}{2\\pi} \\cdot \\pi = \\frac{1}{2}$.\n\n### Analysis of the Pointwise Restriction $R_{\\mathrm{pt}}$\n\nThe pointwise restriction is defined as $R_{\\mathrm{pt}} = u_{\\epsilon}(X)$. Substituting the expression for $u_{\\epsilon}(x)$:\n$$\nR_{\\mathrm{pt}} = U + a \\cos\\left(\\frac{2\\pi}{\\epsilon}X + \\Theta\\right)\n$$\nLet's define a constant phase $\\phi_X = \\frac{2\\pi}{\\epsilon}X$. Then, $R_{\\mathrm{pt}} = U + a \\cos(\\phi_X + \\Theta)$.\n\n**Bias $b_{\\mathrm{pt}}$:**\nThe bias is $b_{\\mathrm{pt}} = \\mathbb{E}[R_{\\mathrm{pt}}] - U$. We first compute the expectation of $R_{\\mathrm{pt}}$:\n$$\n\\mathbb{E}[R_{\\mathrm{pt}}] = \\mathbb{E}[U + a \\cos(\\phi_X + \\Theta)] = \\mathbb{E}[U] + a \\mathbb{E}[\\cos(\\phi_X + \\Theta)]\n$$\nSince $U$ and $a$ are constants with respect to the ensemble over $\\Theta$, and using the identity $\\mathbb{E}[\\cos(\\Theta+\\phi_X)]=0$, we get:\n$$\n\\mathbb{E}[R_{\\mathrm{pt}}] = U + a \\cdot 0 = U\n$$\nTherefore, the bias is:\n$$\nb_{\\mathrm{pt}} = U - U = 0\n$$\n\n**Variance $v_{\\mathrm{pt}}$:**\nThe variance is $v_{\\mathrm{pt}} = \\mathrm{Var}(R_{\\mathrm{pt}})$.\n$$\nv_{\\mathrm{pt}} = \\mathrm{Var}(U + a \\cos(\\phi_X + \\Theta))\n$$\nUsing the property $\\mathrm{Var}(C+kY) = k^2\\mathrm{Var}(Y)$ for constants $C$ and $k$, we have:\n$$\nv_{\\mathrm{pt}} = a^2 \\mathrm{Var}(\\cos(\\phi_X + \\Theta))\n$$\nThe variance of $\\cos(\\phi_X + \\Theta)$ is:\n$$\n\\mathrm{Var}(\\cos(\\phi_X + \\Theta)) = \\mathbb{E}[\\cos^2(\\phi_X + \\Theta)] - (\\mathbb{E}[\\cos(\\phi_X + \\Theta)])^2\n$$\nWe already found $\\mathbb{E}[\\cos(\\phi_X + \\Theta)] = 0$. Using the identity $\\mathbb{E}[\\cos^2(\\Theta+\\phi_X)]=\\frac{1}{2}$:\n$$\n\\mathrm{Var}(\\cos(\\phi_X + \\Theta)) = \\frac{1}{2} - 0^2 = \\frac{1}{2}\n$$\nSubstituting this back into the expression for $v_{\\mathrm{pt}}$:\n$$\nv_{\\mathrm{pt}} = a^2 \\cdot \\frac{1}{2} = \\frac{a^2}{2}\n$$\n\n### Analysis of the Volume-Averaged Restriction $R_{\\mathrm{av}}$\n\nThe volume-averaged restriction is defined as $R_{\\mathrm{av}} = \\frac{1}{h}\\,\\displaystyle\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} u_{\\epsilon}(x)\\,dx$.\n$$\nR_{\\mathrm{av}} = \\frac{1}{h}\\,\\displaystyle\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} \\left[ U + a \\cos\\left(\\frac{2\\pi}{\\epsilon}x + \\Theta\\right) \\right] \\,dx\n$$\nWe can split the integral:\n$$\nR_{\\mathrm{av}} = \\frac{1}{h} \\left( \\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} U \\,dx + a \\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} \\cos\\left(\\frac{2\\pi}{\\epsilon}x + \\Theta\\right) \\,dx \\right)\n$$\nThe first integral is $\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} U \\,dx = U \\cdot h$.\nFor the second integral, let $k = \\frac{2\\pi}{\\epsilon}$:\n$$\n\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} \\cos(kx + \\Theta) \\,dx = \\left[ \\frac{1}{k} \\sin(kx+\\Theta) \\right]_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} = \\frac{1}{k} \\left( \\sin\\left(k\\left(X+\\frac{h}{2}\\right) + \\Theta\\right) - \\sin\\left(k\\left(X-\\frac{h}{2}\\right) + \\Theta\\right) \\right)\n$$\nUsing the trigonometric identity $\\sin(A) - \\sin(B) = 2\\cos\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$, with $A = kX+\\frac{kh}{2}+\\Theta$ and $B = kX-\\frac{kh}{2}+\\Theta$, we get:\n$\\frac{A+B}{2} = kX+\\Theta$ and $\\frac{A-B}{2} = \\frac{kh}{2}$.\nThe integral becomes:\n$$\n\\frac{1}{k} \\left( 2 \\cos(kX+\\Theta) \\sin\\left(\\frac{kh}{2}\\right) \\right)\n$$\nSubstituting this back into the expression for $R_{\\mathrm{av}}$:\n$$\nR_{\\mathrm{av}} = \\frac{1}{h} \\left( Uh + a \\cdot \\frac{2}{k} \\cos(kX+\\Theta) \\sin\\left(\\frac{kh}{2}\\right) \\right) = U + a \\frac{2}{kh} \\sin\\left(\\frac{kh}{2}\\right) \\cos(kX+\\Theta)\n$$\nSubstituting $k = \\frac{2\\pi}{\\epsilon}$, the term $\\frac{kh}{2} = \\frac{2\\pi}{\\epsilon}\\frac{h}{2} = \\frac{\\pi h}{\\epsilon}$. The factor multiplying the cosine becomes:\n$$\na \\frac{2}{\\frac{2\\pi h}{\\epsilon}} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right) = a \\frac{\\epsilon}{\\pi h} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right)\n$$\nSo, we can write $R_{\\mathrm{av}}$ as:\n$$\nR_{\\mathrm{av}} = U + \\left(a \\frac{\\epsilon}{\\pi h} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right)\\right) \\cos\\left(\\frac{2\\pi}{\\epsilon}X + \\Theta\\right)\n$$\n\n**Bias $b_{\\mathrm{av}}$:**\nThe structure of $R_{\\mathrm{av}}$ is identical to $R_{\\mathrm{pt}}$, but with the amplitude $a$ replaced by a new constant amplitude $a' = a \\frac{\\epsilon}{\\pi h} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right)$.\n$$\n\\mathbb{E}[R_{\\mathrm{av}}] = \\mathbb{E}\\left[ U + a' \\cos(\\phi_X + \\Theta) \\right] = U + a' \\mathbb{E}[\\cos(\\phi_X+\\Theta)] = U + a' \\cdot 0 = U\n$$\nTherefore, the bias is:\n$$\nb_{\\mathrm{av}} = \\mathbb{E}[R_{\\mathrm{av}}] - U = U - U = 0\n$$\n\n**Variance $v_{\\mathrm{av}}$:**\nSimilarly, the variance follows the same calculation as for $v_{\\mathrm{pt}}$, with $a$ replaced by $a'$:\n$$\nv_{\\mathrm{av}} = \\mathrm{Var}(U + a' \\cos(\\phi_X + \\Theta)) = (a')^2 \\mathrm{Var}(\\cos(\\phi_X+\\Theta)) = (a')^2 \\cdot \\frac{1}{2}\n$$\nSubstituting the expression for $a'$:\n$$\nv_{\\mathrm{av}} = \\frac{1}{2} \\left( a \\frac{\\epsilon}{\\pi h} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right) \\right)^2 = \\frac{a^2 \\epsilon^2}{2 \\pi^2 h^2} \\sin^2\\left(\\frac{\\pi h}{\\epsilon}\\right)\n$$\n\nThe four requested quantities are:\n$b_{\\mathrm{pt}} = 0$\n$b_{\\mathrm{av}} = 0$\n$v_{\\mathrm{pt}} = \\frac{a^2}{2}$\n$v_{\\mathrm{av}} = \\frac{a^2 \\epsilon^2}{2 \\pi^2 h^2} \\sin^2\\left(\\frac{\\pi h}{\\epsilon}\\right)$\nWe compile these into the required final format.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  \\frac{a^2}{2}  \\frac{a^2 \\epsilon^2}{2 \\pi^2 h^2} \\sin^2\\left(\\frac{\\pi h}{\\epsilon}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Our final practice shifts from local patch analysis to a global, system-wide property: conservation. For many physical systems, quantities like mass, momentum, or energy must be conserved, and a trustworthy numerical scheme should honor these fundamental laws. This problem explores the consequences of imperfect communication between patches in a gap-tooth scheme applied to a conservation law . By analyzing how small mismatches in the flux at patch boundaries accumulate, you will derive an upper bound on the global error, or 'drift,' of the total conserved quantity, quantifying a crucial source of long-term simulation error.",
            "id": "3819129",
            "problem": "Consider a one-dimensional scalar conservation law on a periodic domain of length $L$,\n$$\n\\frac{\\partial u(x,t)}{\\partial t} + \\frac{\\partial q(u(x,t))}{\\partial x} = 0,\n$$\nwhere $q$ is a continuously differentiable flux function. A gap-tooth discretization is used with $N$ equally spaced microscale patches centered at points $\\{x_i\\}_{i=1}^{N}$, with spacing $H = L/N$ and patch width $\\ell$ satisfying $0  \\ell  H$. Within each patch, microscale dynamics evolve according to the conservation law and the patch average\n$$\nm_i(t) = \\int_{x_i - \\ell/2}^{x_i + \\ell/2} u(x,t)\\,\\mathrm{d}x\n$$\nis computed.\n\nAt the edges of each patch $i$, the microsolver is supplied boundary fluxes $F_i^{-}(t)$ at $x = x_i - \\ell/2$ and $F_i^{+}(t)$ at $x = x_i + \\ell/2$, intended to enforce interpatch flux continuity consistent with Periodic Boundary Conditions (PBC). Small violations of flux continuity at shared edges are present: for the interface between the right edge of patch $i$ and the left edge of patch $i+1$, define the mismatch\n$$\n\\delta_i(t) = F_i^{+}(t) - F_{i+1}^{-}(t),\n$$\nwith periodic indexing $i+1$ taken modulo $N$ so that the last patch connects to the first. Assume the boundary fluxes are applied in a manner consistent with conservation so that, for each patch $i$, the time evolution of $m_i(t)$ satisfies\n$$\n\\frac{\\mathrm{d} m_i(t)}{\\mathrm{d} t} = F_i^{-}(t) - F_i^{+}(t).\n$$\n\nDefine the total simulated mass over all patches\n$$\nM(t) = \\sum_{i=1}^{N} m_i(t).\n$$\nSuppose the PBC mismatch amplitude is uniformly bounded over a time interval $[0,T]$ by\n$$\n|\\delta_i(t)| \\le \\alpha \\quad \\text{for all } i \\in \\{1,\\dots,N\\},\\ t \\in [0,T],\n$$\nfor some constant $\\alpha  0$ quantifying the magnitude of the flux continuity violation at patch edges.\n\nStarting from the conservation law and the definitions above (without introducing any additional closure assumptions), derive an upper bound on the drift of the conserved quantity $M(t)$ over $[0,T]$, that is, an upper bound on $|M(T) - M(0)|$, expressed explicitly in terms of $N$, $\\alpha$, and $T$. Provide your final answer as a single closed-form analytic expression. No numerical rounding is required, and no units should be included in your final expression.",
            "solution": "The problem asks for an upper bound on the drift of the total simulated mass, $|M(T) - M(0)|$, over a time interval $[0, T]$. The total simulated mass over all $N$ patches is defined as:\n$$\nM(t) = \\sum_{i=1}^{N} m_i(t)\n$$\nwhere $m_i(t)$ is the mass in the $i$-th patch.\n\nTo find the change in $M(t)$ over time, we first compute its time derivative, $\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t}$. Differentiating the sum with respect to time $t$ yields:\n$$\n\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\sum_{i=1}^{N} m_i(t) = \\sum_{i=1}^{N} \\frac{\\mathrm{d}m_i(t)}{\\mathrm{d}t}\n$$\nThe problem statement provides the time evolution for the mass in each patch $i$ in terms of the boundary fluxes $F_i^{-}(t)$ and $F_i^{+}(t)$:\n$$\n\\frac{\\mathrm{d} m_i(t)}{\\mathrm{d} t} = F_i^{-}(t) - F_i^{+}(t)\n$$\nSubstituting this expression into the sum for $\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t}$:\n$$\n\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t} = \\sum_{i=1}^{N} \\left( F_i^{-}(t) - F_i^{+}(t) \\right)\n$$\nWe can split the sum into two parts:\n$$\n\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t} = \\sum_{i=1}^{N} F_i^{-}(t) - \\sum_{i=1}^{N} F_i^{+}(t)\n$$\nDue to the periodic boundary conditions, the left boundary of patch $i+1$ is physically identified with the right boundary of patch $i$. The flux continuity violation, or mismatch, at this interface is defined as $\\delta_i(t) = F_i^{+}(t) - F_{i+1}^{-}(t)$, with periodic indexing such that patch $N+1$ is identical to patch $1$.\n\nLet's rearrange the summation to reveal the contribution of these mismatches. We can re-index the first sum. Let $j=i$. We can rewrite the sum over $F_i^{-}$ by shifting the index. The sum can be written out to visualize the structure:\n$$\n\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t} = (F_1^{-} - F_1^{+}) + (F_2^{-} - F_2^{+}) + \\dots + (F_N^{-} - F_N^{+})\n$$\nRearranging the terms to group fluxes at the same interface:\n$$\n\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t} = (F_2^{-} - F_1^{+}) + (F_3^{-} - F_2^{+}) + \\dots + (F_N^{-} - F_{N-1}^{+}) + (F_1^{-} - F_N^{+})\n$$\nFrom the definition of the mismatch, $\\delta_i(t) = F_i^{+}(t) - F_{i+1}^{-}(t)$, we have $F_{i+1}^{-}(t) - F_i^{+}(t) = -\\delta_i(t)$.\nThe terms in the sum are:\n- $F_2^{-} - F_1^{+} = -\\delta_1(t)$\n- $F_3^{-} - F_2^{+} = -\\delta_2(t)$\n- ...\n- $F_N^{-} - F_{N-1}^{+} = -\\delta_{N-1}(t)$\n\nFor the last term, $(F_1^{-} - F_N^{+})$, we use the periodic indexing for the mismatch $\\delta_N(t)$:\n$$\n\\delta_N(t) = F_N^{+}(t) - F_{N+1}^{-}(t)\n$$\nSince patch $N+1$ is patch $1$, we have $F_{N+1}^{-}(t) = F_1^{-}(t)$. Therefore,\n$$\n\\delta_N(t) = F_N^{+}(t) - F_1^{-}(t)\n$$\nwhich implies $F_1^{-}(t) - F_N^{+}(t) = -\\delta_N(t)$.\nSubstituting these findings back into the expression for $\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t}$:\n$$\n\\frac{\\mathrm{d}M(t)}{\\mathrm{d}t} = \\sum_{i=1}^{N-1} (-\\delta_i(t)) - \\delta_N(t) = - \\sum_{i=1}^{N} \\delta_i(t)\n$$\nThe total drift in the conserved quantity $M(t)$ from time $t=0$ to $t=T$ is given by the integral of its time derivative:\n$$\nM(T) - M(0) = \\int_0^T \\frac{\\mathrm{d}M(t)}{\\mathrm{d}t} \\, \\mathrm{d}t = \\int_0^T \\left( - \\sum_{i=1}^{N} \\delta_i(t) \\right) \\mathrm{d}t\n$$\nWe need to find an upper bound for the magnitude of this drift, $|M(T) - M(0)|$:\n$$\n|M(T) - M(0)| = \\left| -\\int_0^T \\sum_{i=1}^{N} \\delta_i(t) \\, \\mathrm{d}t \\right| = \\left| \\int_0^T \\sum_{i=1}^{N} \\delta_i(t) \\, \\mathrm{d}t \\right|\n$$\nUsing the triangle inequality for integrals, which states that $|\\int f(x) \\mathrm{d}x| \\le \\int |f(x)| \\mathrm{d}x$ for a scalar function $f(x)$:\n$$\n|M(T) - M(0)| \\le \\int_0^T \\left| \\sum_{i=1}^{N} \\delta_i(t) \\right| \\, \\mathrm{d}t\n$$\nNext, we apply the triangle inequality for sums, $|\\sum_i a_i| \\le \\sum_i |a_i|$, to the term inside the integral:\n$$\n\\left| \\sum_{i=1}^{N} \\delta_i(t) \\right| \\le \\sum_{i=1}^{N} |\\delta_i(t)|\n$$\nThis gives us the inequality:\n$$\n|M(T) - M(0)| \\le \\int_0^T \\left( \\sum_{i=1}^{N} |\\delta_i(t)| \\right) \\, \\mathrm{d}t\n$$\nThe problem provides a uniform bound on the magnitude of the flux mismatch: $|\\delta_i(t)| \\le \\alpha$ for all $i \\in \\{1, \\dots, N\\}$ and $t \\in [0, T]$. We can use this to bound the sum:\n$$\n\\sum_{i=1}^{N} |\\delta_i(t)| \\le \\sum_{i=1}^{N} \\alpha = N\\alpha\n$$\nSubstituting this upper bound into the integral:\n$$\n|M(T) - M(0)| \\le \\int_0^T N\\alpha \\, \\mathrm{d}t\n$$\nThe integrand $N\\alpha$ is a constant with respect to time $t$. Therefore, the integral can be evaluated directly:\n$$\n|M(T) - M(0)| \\le N\\alpha \\int_0^T \\mathrm{d}t = N\\alpha [t]_0^T = N\\alpha (T - 0) = N\\alpha T\n$$\nThus, an upper bound on the drift of the total simulated mass over the interval $[0, T]$ is $N\\alpha T$. This expression is in terms of the specified parameters $N$, $\\alpha$, and $T$.",
            "answer": "$$\\boxed{N \\alpha T}$$"
        }
    ]
}