{
    "hands_on_practices": [
        {
            "introduction": "静电嵌入QM/MM方法的核心在于QM区域的电子密度会因MM环境产生的静电场而极化。此练习旨在量化这种效应，具体来说，我们将探讨MM原子点电荷模型的选择如何直接影响QM区域的偶极矩。通过比较两种不同电荷方案（真空拟合与环境拟合）下的结果，你将亲手计算并理解力场参数对QM/MM模拟中量子力学性质预测的敏感性。",
            "id": "3753075",
            "problem": "考虑一个量子力学/分子力学 (QM/MM) 中的静电嵌入场景，其中一个量子力学溶质被嵌入到由固定的经典分子力学点电荷产生的静电场中。假设溶质位于原点，其对外部均匀电场的电子响应在一阶上由各向同性分子极化率 $\\alpha$ 描述，单位为原子单位（玻尔半径的立方）。分子力学 (MM) 环境由位于位置 $\\mathbf{r}_1 = (3\\,a_0, 0, 0)$、$\\mathbf{r}_2 = (0, 4\\,a_0, 0)$ 和 $\\mathbf{r}_3 = (0, 0, 5\\,a_0)$ 的三个点电荷组成，其中 $a_0$ 是玻尔半径。给出了两种不同的 MM 电荷模型：\n- 真空拟合电荷：$q_1^{\\mathrm{vac}} = +0.40$, $q_2^{\\mathrm{vac}} = -0.25$, $q_3^{\\mathrm{vac}} = -0.15$。\n- 环境拟合电荷：$q_1^{\\mathrm{env}} = +0.45$, $q_2^{\\mathrm{env}} = -0.30$, $q_3^{\\mathrm{env}} = -0.15$。\n\n假设静电学采用原子单位（因此 $4\\pi\\epsilon_0 = 1$ 且基本电荷量为 $1$），并取溶质的各向同性极化率为 $\\alpha = 10\\,a_0^3$。将 MM 点电荷视为作用于量子溶质的外部场的固定源，在线性响应范围内，通过计算两种电荷组在原点产生的外部场的差异，并将其通过溶质的线性响应进行传播，来估算环境拟合和真空拟合嵌入之间的嵌入量子力学偶极矩差矢量 $\\Delta \\boldsymbol{\\mu}$。\n\n计算该偶极矩差的欧几里得范数 $|\\Delta \\boldsymbol{\\mu}|$，并以德拜（Debye）为单位表示最终答案。使用 1 原子单位偶极矩等于 $2.541746$ 德拜的换算关系。将最终答案四舍五入到四位有效数字。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于静电相互作用和线性响应理论在 QM/MM 建模中的应用原理。该问题是适定的，为得到唯一解提供了所有必要的数据和条件，没有任何内部矛盾或歧义。\n\n核心任务是计算一个量子力学 (QM) 溶质在两种由经典分子力学 (MM) 点电荷提供的不同静电环境下的诱导偶极矩之差。根据线性响应理论，诱导偶极矩 $\\boldsymbol{\\mu}_{\\mathrm{ind}}$ 通过分子极化率张量与外部电场 $\\mathbf{E}$ 相关。对于各向同性极化率 $\\alpha$，这种关系是标量关系：\n$$ \\boldsymbol{\\mu}_{\\mathrm{ind}} = \\alpha \\mathbf{E} $$\n所有计算都将在原子单位下进行，其中基本电荷 $e$、约化普朗克常数 $\\hbar$、电子质量 $m_e$ 以及库仑常数 $k_e = \\frac{1}{4\\pi\\epsilon_0}$ 均设为 $1$。长度单位是玻尔半径 $a_0$。\n\n问题要求计算由环境拟合电荷诱导的偶极矩 $\\boldsymbol{\\mu}_{\\mathrm{env}}$ 与由真空拟合电荷诱导的偶极矩 $\\boldsymbol{\\mu}_{\\mathrm{vac}}$ 之间的差矢量 $\\Delta \\boldsymbol{\\mu}$。\n$$ \\Delta \\boldsymbol{\\mu} = \\boldsymbol{\\mu}_{\\mathrm{env}} - \\boldsymbol{\\mu}_{\\mathrm{vac}} $$\n代入线性响应公式：\n$$ \\Delta \\boldsymbol{\\mu} = \\alpha \\mathbf{E}_{\\mathrm{env}} - \\alpha \\mathbf{E}_{\\mathrm{vac}} = \\alpha (\\mathbf{E}_{\\mathrm{env}} - \\mathbf{E}_{\\mathrm{vac}}) = \\alpha \\Delta \\mathbf{E} $$\n其中 $\\Delta \\mathbf{E}$ 是两种电荷分布在原点产生的电场之差。\n\n由位于位置 $\\mathbf{r}_i$ 的一组点电荷 $q_i$ 在原点（$\\mathbf{r} = \\mathbf{0}$）产生的电场 $\\mathbf{E}$ 由叠加原理给出：\n$$ \\mathbf{E} = \\sum_{i} \\frac{q_i (\\mathbf{0} - \\mathbf{r}_i)}{|\\mathbf{0} - \\mathbf{r}_i|^3} = - \\sum_{i} \\frac{q_i \\mathbf{r}_i}{|\\mathbf{r}_i|^3} $$\n因此，差分电场 $\\Delta \\mathbf{E}$ 为：\n$$ \\Delta \\mathbf{E} = \\mathbf{E}_{\\mathrm{env}} - \\mathbf{E}_{\\mathrm{vac}} = \\left( - \\sum_{i} \\frac{q_i^{\\mathrm{env}} \\mathbf{r}_i}{|\\mathbf{r}_i|^3} \\right) - \\left( - \\sum_{i} \\frac{q_i^{\\mathrm{vac}} \\mathbf{r}_i}{|\\mathbf{r}_i|^3} \\right) = - \\sum_{i} \\frac{(q_i^{\\mathrm{env}} - q_i^{\\mathrm{vac}})\\mathbf{r}_i}{|\\mathbf{r}_i|^3} $$\n令 $\\Delta q_i = q_i^{\\mathrm{env}} - q_i^{\\mathrm{vac}}$。差分电场的表达式变为：\n$$ \\Delta \\mathbf{E} = - \\sum_{i} \\frac{\\Delta q_i \\mathbf{r}_i}{|\\mathbf{r}_i|^3} $$\n首先，我们计算电荷的差值 $\\Delta q_i$：\n$$ \\Delta q_1 = q_1^{\\mathrm{env}} - q_1^{\\mathrm{vac}} = 0.45 - 0.40 = 0.05 $$\n$$ \\Delta q_2 = q_2^{\\mathrm{env}} - q_2^{\\mathrm{vac}} = -0.30 - (-0.25) = -0.05 $$\n$$ \\Delta q_3 = q_3^{\\mathrm{env}} - q_3^{\\mathrm{vac}} = -0.15 - (-0.15) = 0 $$\n电荷位置以 $a_0$ 为单位给出，在原子单位长度中为 1。\n$$ \\mathbf{r}_1 = (3, 0, 0) \\implies |\\mathbf{r}_1| = 3, |\\mathbf{r}_1|^3 = 27 $$\n$$ \\mathbf{r}_2 = (0, 4, 0) \\implies |\\mathbf{r}_2| = 4, |\\mathbf{r}_2|^3 = 64 $$\n$$ \\mathbf{r}_3 = (0, 0, 5) \\implies |\\mathbf{r}_3| = 5, |\\mathbf{r}_3|^3 = 125 $$\n现在，我们计算 $\\Delta \\mathbf{E}$ 的分量：\n$$ \\Delta \\mathbf{E} = - \\left( \\frac{\\Delta q_1 \\mathbf{r}_1}{|\\mathbf{r}_1|^3} + \\frac{\\Delta q_2 \\mathbf{r}_2}{|\\mathbf{r}_2|^3} + \\frac{\\Delta q_3 \\mathbf{r}_3}{|\\mathbf{r}_3|^3} \\right) $$\n$\\Delta q_3$ 的项为零。\n$$ \\Delta \\mathbf{E} = - \\left( \\frac{0.05 \\cdot (3, 0, 0)}{27} + \\frac{-0.05 \\cdot (0, 4, 0)}{64} \\right) $$\n$$ \\Delta \\mathbf{E} = - \\left( \\left(\\frac{0.15}{27}, 0, 0\\right) + \\left(0, \\frac{-0.20}{64}, 0\\right) \\right) = - \\left( \\frac{1}{180}, -\\frac{1}{320}, 0 \\right) $$\n$$ \\Delta \\mathbf{E} = \\left(-\\frac{1}{180}, \\frac{1}{320}, 0\\right) $$\n该电场的单位是原子单位（$E_h / (e a_0)$）。给定的极化率为 $\\alpha = 10\\,a_0^3$，在原子单位中即 $\\alpha = 10$。\n偶极矩差矢量为：\n$$ \\Delta \\boldsymbol{\\mu} = \\alpha \\Delta \\mathbf{E} = 10 \\cdot \\left(-\\frac{1}{180}, \\frac{1}{320}, 0\\right) = \\left(-\\frac{10}{180}, \\frac{10}{320}, 0\\right) = \\left(-\\frac{1}{18}, \\frac{1}{32}, 0\\right) $$\n这是以原子单位偶极矩（$e \\cdot a_0$）表示的。问题要求计算该矢量的欧几里得范数 $|\\Delta \\boldsymbol{\\mu}|$：\n$$ |\\Delta \\boldsymbol{\\mu}| = \\sqrt{ \\left(-\\frac{1}{18}\\right)^2 + \\left(\\frac{1}{32}\\right)^2 + 0^2 } = \\sqrt{ \\frac{1}{324} + \\frac{1}{1024} } $$\n$$ |\\Delta \\boldsymbol{\\mu}| = \\sqrt{ \\frac{1024 + 324}{324 \\times 1024} } = \\sqrt{ \\frac{1348}{331776} } \\approx \\sqrt{0.004062982} \\approx 0.06374152 \\text{ a.u.} $$\n最后，我们使用提供的换算因子将此值转换为德拜：$1$ 原子单位 $= 2.541746$ 德拜。\n$$ |\\Delta \\boldsymbol{\\mu}|_{\\mathrm{Debye}} = |\\Delta \\boldsymbol{\\mu}|_{\\mathrm{a.u.}} \\times 2.541746 $$\n$$ |\\Delta \\boldsymbol{\\mu}|_{\\mathrm{Debye}} \\approx 0.06374152 \\times 2.541746 \\approx 0.162013 $$\n将结果四舍五入到四位有效数字，得到 $0.1620$。",
            "answer": "$$\n\\boxed{0.1620}\n$$"
        },
        {
            "introduction": "虽然点电荷模型在QM/MM中极为方便，但当MM原子过于靠近QM区域时，其$1/r$势的奇异性会导致QM电子云的非物理性过度极化。这个实践练习将引导你直面这一被称为“电荷穿透”效应的伪影，通过对比点电荷与更真实的扩展高斯电荷分布产生的静电势，推导出一个最小排斥半径。这项练习不仅能加深你对模型局限性的理解，还提供了一种基于第一性原理来提高模拟稳定性和准确性的实用方法。",
            "id": "3753064",
            "problem": "在量子力学/分子力学 (QM/MM) 静电嵌入中，分子力学 (MM) 环境由固定的点电荷表示，这些点电荷会极化量子力学 (QM) 区域。当 MM 点电荷放置得离 QM 边界太近时，点电荷静电势会以 $1/r$ 的形式发散，而一个真实的、弥散的 MM 电荷分布的物理势由于电荷穿透效应，在短程是有限的。这种不匹配会导致边界附近 QM 密度的人为过度极化。为了基于电荷穿透的考虑，为 MM 点电荷形式化一个最小排斥半径，假设每个净电荷为 $q$ 的 MM 位点都有一个球对称的电子密度，该密度可以很好地由一个宽度参数为 $a$ 的归一化高斯函数近似：$\\rho(r) = \\dfrac{q}{\\pi^{3/2} a^3} \\exp(-r^2/a^2)$，其中 $r$ 是与 MM 位点的距离。设 QM 边界与这样一个 MM 位点的距离为 $R$，并设 $\\epsilon$ 为在 QM 边界处评估的点电荷势与弥散电荷势之间的相对误差的预设容差。使用基本静电学和电荷穿透的定义，推导最小排斥半径 $R_{\\mathrm{excl}}$ 的准则，使得在 QM 边界处的静电势相对误差不大于 $\\epsilon$。然后，对于一个宽度参数 $a = 0.30\\,\\mathrm{\\AA}$、容差 $\\epsilon = 0.05$ 的类氢 MM 位点，确定与您的准则一致的 $R_{\\mathrm{excl}}$ 的近似数值。选择一个选项，该选项正确地描述了过度极化的物理效应，提供了基于电荷穿透的 $R_{\\mathrm{excl}}$ 表达式，并给出了相应的数值估计。\n\nA. $R_{\\mathrm{excl}} = a\\, \\mathrm{erf}^{-1}(1 - \\epsilon)$；对于 $a = 0.30\\,\\mathrm{\\AA}$ 和 $\\epsilon = 0.05$，$R_{\\mathrm{excl}} \\approx 0.42\\,\\mathrm{\\AA}$。\n\nB. $R_{\\mathrm{excl}} = a\\, \\sqrt{2 \\ln(1/\\epsilon)}$；对于 $a = 0.30\\,\\mathrm{\\AA}$ 和 $\\epsilon = 0.05$，$R_{\\mathrm{excl}} \\approx 0.74\\,\\mathrm{\\AA}$。\n\nC. $R_{\\mathrm{excl}}$ 是通过线性响应限制 QM 区域中的感生极化能来设定的，即 $|U_{\\mathrm{pol}}| = \\dfrac{1}{2} \\alpha E^2 \\le u_{\\max}$，从而得出 $R_{\\mathrm{excl}} = \\left( \\dfrac{\\alpha q^2}{32 \\pi^2 \\epsilon_0^2 u_{\\max}} \\right)^{1/4}$；对于典型值，$R_{\\mathrm{excl}} \\approx 1.2\\,\\mathrm{\\AA}$。\n\nD. $R_{\\mathrm{excl}}$ 等于 MM 原子的范德华半径，与电荷穿透和 $\\epsilon$ 无关，因此对于氢，$R_{\\mathrm{excl}} \\approx 1.2\\,\\mathrm{\\AA}$。",
            "solution": "该问题陈述经评估是科学上合理、提问恰当、客观且自洽的。它提出了计算化学中的一个物理现实情景（QM/MM中的过度极化伪影），并要求基于基本静电学严格推导一个准则来缓解该问题。所有必要的数据和定义都已提供。因此，我们可以进行推导和分析。\n\n该问题要求在量子力学/分子力学 (QM/MM) 计算中，为分子力学 (MM) 点电荷确定一个排斥半径 $R_{\\mathrm{excl}}$。该半径由以下条件确定：在该距离上，点电荷的势与更真实的弥散电荷分布的势之间的相对误差不超过容差 $\\epsilon$。\n\n首先，我们必须定义在距离 MM 位点中心 $R$ 处的两种静电势。该 MM 位点的总电荷为 $q$。\n\n1.  **点电荷势 ($V_{\\mathrm{pc}}$):**\n    对于点电荷 $q$，距离 $R$ 处的静电势由库仑定律给出：\n    $$ V_{\\mathrm{pc}}(R) = \\frac{1}{4\\pi\\epsilon_0} \\frac{q}{R} $$\n    其中 $\\epsilon_0$ 是真空介电常数。\n\n2.  **弥散电荷势 ($V_{\\mathrm{sm}}$):**\n    问题提供了一个球对称、归一化的高斯电荷分布来表示 MM 位点的弥散电荷：\n    $$ \\rho(r) = \\frac{q}{\\pi^{3/2} a^3} \\exp(-r^2/a^2) $$\n    由球形高斯电荷分布产生的静电势是静电学中的一个标准结果。它可以通过对所有无穷小电荷元的贡献进行积分得到，或者先用高斯定律求出电场，然后再对电场进行积分。结果是：\n    $$ V_{\\mathrm{sm}}(R) = \\frac{1}{4\\pi\\epsilon_0} \\frac{q \\cdot \\mathrm{erf}(R/a)}{R} $$\n    其中 $\\mathrm{erf}(x)$ 是误差函数，定义为 $\\mathrm{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x e^{-t^2} dt$。与点电荷势不同，该势在大距离处正确地简化为点电荷势（因为当 $R \\to \\infty$ 时 $\\mathrm{erf}(R/a) \\to 1$），并且在原点（$R=0$）处保持有限。\n\n接下来，我们建立排斥半径 $R_{\\mathrm{excl}}$ 的准则。问题基于在边界距离 $R=R_{\\mathrm{excl}}$ 处点电荷势和弥散电荷势之间的相对误差来定义它。过度极化的产生是因为在短距离处，$V_{\\mathrm{pc}}$ 大于更符合物理实际的 $V_{\\mathrm{sm}}$。我们将相对误差定义为电势差除以点电荷势进行归一化：\n$$ \\text{Relative Error} = \\frac{V_{\\mathrm{pc}}(R) - V_{\\mathrm{sm}}(R)}{V_{\\mathrm{pc}}(R)} $$\n排斥半径 $R_{\\mathrm{excl}}$ 的条件是该误差等于预设的容差 $\\epsilon$：\n$$ \\epsilon = \\frac{V_{\\mathrm{pc}}(R_{\\mathrm{excl}}) - V_{\\mathrm{sm}}(R_{\\mathrm{excl}})}{V_{\\mathrm{pc}}(R_{\\mathrm{excl}})} $$\n代入电势的表达式：\n$$ \\epsilon = \\frac{\\frac{q}{4\\pi\\epsilon_0 R_{\\mathrm{excl}}} - \\frac{q \\cdot \\mathrm{erf}(R_{\\mathrm{excl}}/a)}{4\\pi\\epsilon_0 R_{\\mathrm{excl}}}}{\\frac{q}{4\\pi\\epsilon_0 R_{\\mathrm{excl}}}} $$\n公共因子 $\\frac{q}{4\\pi\\epsilon_0 R_{\\mathrm{excl}}}$ 被消去，得到一个简单的表达式：\n$$ \\epsilon = 1 - \\mathrm{erf}(R_{\\mathrm{excl}}/a) $$\n为了求出排斥半径 $R_{\\mathrm{excl}}$，我们解此方程求 $R_{\\mathrm{excl}}$：\n$$ \\mathrm{erf}(R_{\\mathrm{excl}}/a) = 1 - \\epsilon $$\n$$ \\frac{R_{\\mathrm{excl}}}{a} = \\mathrm{erf}^{-1}(1 - \\epsilon) $$\n$$ R_{\\mathrm{excl}} = a \\cdot \\mathrm{erf}^{-1}(1 - \\epsilon) $$\n这就是根据问题陈述推导出的最小排斥半径准则。\n\n最后，我们应用给定的数值：一个类氢 MM 位点，其高斯宽度参数 $a = 0.30\\,\\mathrm{\\AA}$，误差容差 $\\epsilon = 0.05$。\n$$ R_{\\mathrm{excl}} = (0.30\\,\\mathrm{\\AA}) \\cdot \\mathrm{erf}^{-1}(1 - 0.05) $$\n$$ R_{\\mathrm{excl}} = (0.30\\,\\mathrm{\\AA}) \\cdot \\mathrm{erf}^{-1}(0.95) $$\n我们需要找到 $x$ 的值使得 $\\mathrm{erf}(x) = 0.95$。使用标准数学库或反误差函数表，我们发现 $\\mathrm{erf}^{-1}(0.95) \\approx 1.3859$。\n$$ R_{\\mathrm{excl}} \\approx (0.30\\,\\mathrm{\\AA}) \\times 1.3859 \\approx 0.41577\\,\\mathrm{\\AA} $$\n四舍五入到与输入参数一致的两位有效数字，我们得到 $R_{\\mathrm{excl}} \\approx 0.42\\,\\mathrm{\\AA}$。\n\n现在，我们评估每个选项：\n\n**A. $R_{\\mathrm{excl}} = a\\, \\mathrm{erf}^{-1}(1 - \\epsilon)$; 对于 $a = 0.30\\,\\mathrm{\\AA}$ 和 $\\epsilon = 0.05$, $R_{\\mathrm{excl}} \\approx 0.42\\,\\mathrm{\\AA}$。**\n- **分析：** 此选项给出了从问题前提推导出的精确公式。点电荷势与弥散高斯势之间的相对误差确实是 $1 - \\mathrm{erf}(R/a)$。将其设为 $\\epsilon$ 并解出 $R$ 即可得到表达式 $R_{\\mathrm{excl}} = a\\, \\mathrm{erf}^{-1}(1 - \\epsilon)$。对于给定参数的数值计算结果 $R_{\\mathrm{excl}} \\approx (0.30\\,\\mathrm{\\AA}) \\cdot \\mathrm{erf}^{-1}(0.95) \\approx 0.42\\,\\mathrm{\\AA}$ 也是正确的。\n- **结论：** 正确。\n\n**B. $R_{\\mathrm{excl}} = a\\, \\sqrt{2 \\ln(1/\\epsilon)}$; 对于 $a = 0.30\\,\\mathrm{\\AA}$ 和 $\\epsilon = 0.05$, $R_{\\mathrm{excl}} \\approx 0.74\\,\\mathrm{\\AA}$。**\n- **分析：** 这个公式不是从基于电势相对误差的推导得出的。它可能源于某种近似或不同的物理准则。例如，它类似于一个基于电荷密度值本身的准则，但并不完全匹配。我们基于电势的推导是精确的，并导出了选项 A 中的表达式。虽然此公式的数值计算（$R_{\\mathrm{excl}} = 0.30 \\cdot \\sqrt{2\\ln(20)} \\approx 0.734\\,\\mathrm{\\AA}$，根据舍入约定和 $\\ln(20)$ 的精度，可舍入为 $0.73\\,\\mathrm{\\AA}$ 或 $0.74\\,\\mathrm{\\AA}$）在内部是一致的，但公式本身并不是对所提问题的正确回答。\n- **结论：** 不正确。\n\n**C. $R_{\\mathrm{excl}}$ 是通过线性响应限制 QM 区域中的感生极化能来设定的，即 $|U_{\\mathrm{pol}}| = \\dfrac{1}{2} \\alpha E^2 \\le u_{\\max}$，从而得出 $R_{\\mathrm{excl}} = \\left( \\dfrac{\\alpha q^2}{32 \\pi^2 \\epsilon_0^2 u_{\\max}} \\right)^{1/4}$；对于典型值，$R_{\\mathrm{excl}} \\approx 1.2\\,\\mathrm{\\AA}$。**\n- **分析：** 这个选项提出了一种物理上合理但不同的方法来确定排斥半径。它限制了 QM 区域的极化能，这是一种控制过度极化的方法。然而，问题陈述提供了一个非常具体的任务：使用参数 $a$ 和 $\\epsilon$，基于电荷穿透引起的电势相对误差来推导半径。该选项忽略了给定的任务，并引入了新的、未定义的参数，如极化率 $\\alpha$ 和最大能量 $u_{\\max}$。它解决的是一个不同的问题。\n- **结论：** 不正确。\n\n**D. $R_{\\mathrm{excl}}$ 等于 MM 原子的范德华半径，与电荷穿透和 $\\epsilon$ 无关，因此对于氢，$R_{\\mathrm{excl}} \\approx 1.2\\,\\mathrm{\\AA}$。**\n- **分析：** 这个选项提出了一种简单的启发式方法。在某些情况下，使用范德华半径是一种常见的做法，但这是一种临时的经验法则。它不是从问题所要求的第一性原理静电学论证中推导出来的。该准则明确要求依赖于电荷穿透（通过参数 $a$）和误差容差 $\\epsilon$，而此选项忽略了这两者。\n- **结论：** 不正确。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在分子动力学等模拟中，准确计算原子间相互作用力是驱动系统演化的关键。这个动手实践将带你从静电相互作用能过渡到力的计算，这是连接理论模型与动态模拟的核心环节。你将需要推导QM/MM静电相互作用下MM电荷所受作用力的解析表达式，并通过与数值差分结果对比来验证其正确性。这项任务是开发和验证模拟软件时的标准流程，对于培养严谨的计算科学研究能力至关重要。",
            "id": "3753098",
            "problem": "考虑一个原子单位制下的量子力学/分子力学 (QM/MM) 静电嵌入场景，其中一个最小的量子力学 (QM) 子系统由两个固定的原子核组成，它们位于位置 $R_A, R_B \\in \\mathbb{R}^3$。带有正电荷 $Z_A$ 和 $Z_B$。QM 电子密度被近似为一个归一化的、球对称的两个独立 $s$ 型高斯电荷分布之和，这两个分布的中心分别位于 $R_A$ 和 $R_B$，具有共同的指数 $\\alpha > 0$ 和权重 $w_A, w_B$，满足 $w_A + w_B = 1$ 且 $w_A, w_B \\ge 0$。一个单独的分子力学 (MM) 点电荷 $q$ 位于位置 $R_q \\in \\mathbb{R}^3$。所有量均以原子单位表示：距离以玻尔（Bohr）为单位，力以哈特里每玻尔（Hartree per Bohr）为单位。\n\n总 QM/MM 静电相互作用能 $E_{\\mathrm{int}}(R_q)$ 由 MM 电荷与 QM 原子核及 QM 电子密度之间的库仑相互作用组成。对于一个中心位于 $R_X$、指数为 $\\alpha$ 的球对称、归一化高斯电子密度，在距离 $r = \\lVert R_q - R_X \\rVert$ 处的静电势是一个经过充分检验的事实：\n$$\nV_{\\mathrm{G}}(r) = \\frac{\\operatorname{erf}(\\beta r)}{r}, \\quad \\beta = \\sqrt{\\alpha},\n$$\n其中 $\\operatorname{erf}$ 是高斯误差函数。利用库仑定律和上述势能，能量为：\n$$\nE_{\\mathrm{int}}(R_q) = q\\left(\\frac{Z_A}{\\lVert R_q - R_A \\rVert} + \\frac{Z_B}{\\lVert R_q - R_B \\rVert} - w_A V_{\\mathrm{G}}(\\lVert R_q - R_A \\rVert) - w_B V_{\\mathrm{G}}(\\lVert R_q - R_B \\rVert)\\right).\n$$\n\n您的任务是通过两种方法计算 MM 电荷 $q$ 上受到的力，并评估它们之间的差异：\n1. 使用步长 $h$ 沿每个笛卡尔坐标轴，通过能量的中心有限差分法计算数值力 $F_{\\mathrm{num}}(R_q)$：\n$$\nF_{\\mathrm{num},i}(R_q) = -\\frac{E_{\\mathrm{int}}(R_q + h\\, \\hat{e}_i) - E_{\\mathrm{int}}(R_q - h\\, \\hat{e}_i)}{2h}, \\quad i \\in \\{x,y,z\\},\n$$\n其中 $\\hat{e}_i$ 表示沿 $i$ 轴的单位向量。\n2. 使用向量微积分和链式法则，通过对原子核库仑项和高斯势相对于 $R_q$ 求导，推导并实现解析力 $F_{\\mathrm{ana}}(R_q) = -\\nabla_{R_q} E_{\\mathrm{int}}(R_q)$。\n\n最后，计算两个力之间误差向量的欧几里得范数：\n$$\n\\Delta = \\lVert F_{\\mathrm{num}}(R_q) - F_{\\mathrm{ana}}(R_q) \\rVert,\n$$\n并以哈特里每玻尔为单位报告 $\\Delta$。\n\n使用以下参数集测试套件，其设计旨在覆盖典型、远场、近场和对称情况。在所有情况下，距离单位为玻尔，力单位为哈特里每玻尔，$h$ 的单位为玻尔。\n\n- 测试用例 1 (靠近两个原子核的一般位置)：\n  - $R_A = (-0.7, 0.0, 0.0)$\n  - $R_B = (0.7, 0.0, 0.0)$\n  - $Z_A = 1$, $Z_B = 1$\n  - $q = 0.5$\n  - $\\alpha = 0.5$\n  - $w_A = 0.6$, $w_B = 0.4$\n  - $R_q = (0.3, 0.1, -0.2)$\n  - $h = 10^{-4}$\n\n- 测试用例 2 (远离两个原子核的远场)：\n  - $R_A = (-0.7, 0.0, 0.0)$\n  - $R_B = (0.7, 0.0, 0.0)$\n  - $Z_A = 1$, $Z_B = 1$\n  - $q = 0.5$\n  - $\\alpha = 0.5$\n  - $w_A = 0.6$, $w_B = 0.4$\n  - $R_q = (10.0, -9.0, 5.0)$\n  - $h = 10^{-4}$\n\n- 测试用例 3 (靠近一个原子核的近场)：\n  - $R_A = (-0.7, 0.0, 0.0)$\n  - $R_B = (0.7, 0.0, 0.0)$\n  - $Z_A = 1$, $Z_B = 1$\n  - $q = 0.5$\n  - $\\alpha = 0.5$\n  - $w_A = 0.6$, $w_B = 0.4$\n  - $R_q = (-0.65, 0.0, 0.0)$\n  - $h = 10^{-5}$\n\n- 测试用例 4 (位于中点、具有相等电子权重和负 MM 电荷的对称情况)：\n  - $R_A = (-1.2, 0.0, 0.0)$\n  - $R_B = (1.2, 0.0, 0.0)$\n  - $Z_A = 1$, $Z_B = 1$\n  - $q = -1.0$\n  - $\\alpha = 1.0$\n  - $w_A = 0.5$, $w_B = 0.5$\n  - $R_q = (0.0, 0.0, 0.0)$\n  - $h = 10^{-4}$\n\n您的程序应为每个测试用例计算 $\\Delta$，并生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。将每个 $\\Delta$ 值以哈特里每玻尔为单位表示，并四舍五入到八位小数。例如，输出格式必须是\n$$\n[\\delta_1,\\delta_2,\\delta_3,\\delta_4],\n$$\n其中每个 $\\delta_k$ 是一个小数点后有八位数字的十进制浮点数。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n该问题为一个量子力学/分子力学 (QM/MM) 静电嵌入模型提供了以下数据和定义：\n\n**QM 子系统：**\n-   两个固定原子核，位于位置 $\\mathbf{R}_A, \\mathbf{R}_B \\in \\mathbb{R}^3$。\n-   正原子核电荷 $Z_A, Z_B$。\n-   一个电子密度，模型化为两个分别以 $\\mathbf{R}_A$ 和 $\\mathbf{R}_B$ 为中心的、归一化的、球对称的 $s$ 型高斯电荷分布之和。\n-   共同的高斯指数 $\\alpha > 0$。\n-   高斯分布的权重 $w_A, w_B$，满足 $w_A + w_B = 1$ 且 $w_A, w_B \\ge 0$。\n\n**MM 子系统：**\n-   一个点电荷 $q$，位于位置 $\\mathbf{R}_q \\in \\mathbb{R}^3$。\n\n**物理和方程：**\n-   所有量均采用原子单位（距离单位为玻尔，力单位为哈特里每玻尔）。\n-   一个指数为 $\\alpha$ 的归一化、球对称高斯分布在其中心距离 $r$ 处的静电势：\n    $$V_{\\mathrm{G}}(r) = \\frac{\\operatorname{erf}(\\beta r)}{r}, \\quad \\beta = \\sqrt{\\alpha}$$\n-   总 QM/MM 静电相互作用能：\n    $$E_{\\mathrm{int}}(\\mathbf{R}_q) = q\\left(\\frac{Z_A}{\\lVert \\mathbf{R}_q - \\mathbf{R}_A \\rVert} + \\frac{Z_B}{\\lVert \\mathbf{R}_q - \\mathbf{R}_B \\rVert} - w_A V_{\\mathrm{G}}(\\lVert \\mathbf{R}_q - \\mathbf{R}_A \\rVert) - w_B V_{\\mathrm{G}}(\\lVert \\mathbf{R}_q - \\mathbf{R}_B \\rVert)\\right)$$\n-   MM 电荷上的数值力（中心有限差分）：\n    $$\\mathbf{F}_{\\mathrm{num},i}(\\mathbf{R}_q) = -\\frac{E_{\\mathrm{int}}(\\mathbf{R}_q + h\\, \\hat{\\mathbf{e}}_i) - E_{\\mathrm{int}}(\\mathbf{R}_q - h\\, \\hat{\\mathbf{e}}_i)}{2h}, \\quad i \\in \\{x,y,z\\}$$\n-   MM 电荷上的解析力：$\\mathbf{F}_{\\mathrm{ana}}(\\mathbf{R}_q) = -\\nabla_{\\mathbf{R}_q} E_{\\mathrm{int}}(\\mathbf{R}_q)$。\n-   待计算的误差：$\\Delta = \\lVert \\mathbf{F}_{\\mathrm{num}}(\\mathbf{R}_q) - \\mathbf{F}_{\\mathrm{ana}}(\\mathbf{R}_q) \\rVert$。\n\n**测试用例：**\n-   用例 1：$\\mathbf{R}_A = (-0.7, 0.0, 0.0)$, $\\mathbf{R}_B = (0.7, 0.0, 0.0)$, $Z_A = 1$, $Z_B = 1$, $q = 0.5$, $\\alpha = 0.5$, $w_A = 0.6$, $w_B = 0.4$, $\\mathbf{R}_q = (0.3, 0.1, -0.2)$, $h = 10^{-4}$。\n-   用例 2：$\\mathbf{R}_A = (-0.7, 0.0, 0.0)$, $\\mathbf{R}_B = (0.7, 0.0, 0.0)$, $Z_A = 1$, $Z_B = 1$, $q = 0.5$, $\\alpha = 0.5$, $w_A = 0.6$, $w_B = 0.4$, $\\mathbf{R}_q = (10.0, -9.0, 5.0)$, $h = 10^{-4}$。\n-   用例 3：$\\mathbf{R}_A = (-0.7, 0.0, 0.0)$, $\\mathbf{R}_B = (0.7, 0.0, 0.0)$, $Z_A = 1$, $Z_B = 1$, $q = 0.5$, $\\alpha = 0.5$, $w_A = 0.6$, $w_B = 0.4$, $\\mathbf{R}_q = (-0.65, 0.0, 0.0)$, $h = 10^{-5}$。\n-   用例 4：$\\mathbf{R}_A = (-1.2, 0.0, 0.0)$, $\\mathbf{R}_B = (1.2, 0.0, 0.0)$, $Z_A = 1$, $Z_B = 1$, $q = -1.0$, $\\alpha = 1.0$, $w_A = 0.5$, $w_B = 0.5$, $\\mathbf{R}_q = (0.0, 0.0, 0.0)$, $h = 10^{-4}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于 QM/MM 方法中一种称为静电嵌入的标准简化。使用高斯基函数表示电子密度是现代量子化学的基石。由高斯电荷分布产生的静电势公式是源于经典静电学的一个成熟结果。通过能量的负梯度计算力是物理学的基本原理。这些前提在科学上和数学上都是合理的。\n2.  **适定性：** 该问题提供了一个明确的目标：计算数值力与解析力之间的差异。所有必需的参数和方程都已指定。推导解析梯度和实现有限差分法的任务是定义明确的数学和计算过程，对于每个测试用例都能得出唯一的解。\n3.  **客观性：** 问题陈述以精确、无偏见且正式的科学语言编写。没有主观因素。\n4.  **完整性与一致性：** 每个测试用例都提供了所有必要的信息（几何结构、电荷、参数、常数）。给定数据中没有矛盾（例如，在所有情况下都满足 $w_A + w_B = 1$）。问题是自洽的。MM 电荷 $q$ 的位置从不与原子核位置重合，从而正确地避免了势能和力中的奇点。\n5.  **现实性与可行性：** 所选参数在原子单位制下分子模拟的典型范围内。该任务在计算上是可行的。\n6.  **其他缺陷：** 该问题并非微不足道，因为它需要正确应用向量微积分和细致的数值实现。它不是同义反复、不适定或无法验证的。\n\n### 步骤 3：结论与行动\n问题被判定为 **有效**。它在科学上合理、适定且完整。我将继续进行解答。\n\n## 解答\n\n目标是计算 MM 电荷 $q$ 上受到的数值力 $\\mathbf{F}_{\\mathrm{num}}$ 与解析力 $\\mathbf{F}_{\\mathrm{ana}}$ 之间的差异 $\\Delta$。\n\n### 1. 解析力 $\\mathbf{F}_{\\mathrm{ana}}$ 的推导\n\n位于位置 $\\mathbf{R}_q$ 的 MM 电荷所受的力由相互作用能相对于 $\\mathbf{R}_q$ 的负梯度给出：\n$$ \\mathbf{F}_{\\mathrm{ana}}(\\mathbf{R}_q) = -\\nabla_{\\mathbf{R}_q} E_{\\mathrm{int}}(\\mathbf{R}_q) $$\n相互作用能是来自两个 QM 中心 A 和 B 的贡献之和。让我们分析一个通用中心 $X \\in \\{A, B\\}$ 的贡献，其原子核电荷为 $Z_X$，电子密度权重为 $w_X$，位置为 $\\mathbf{R}_X$。设 $\\mathbf{r}_X = \\mathbf{R}_q - \\mathbf{R}_X$ 且 $r_X = \\lVert \\mathbf{r}_X \\rVert$。能量表达式可以按中心分组：\n$$ E_{\\mathrm{int}}(\\mathbf{R}_q) = q \\sum_{X \\in \\{A,B\\}} \\left( \\frac{Z_X}{r_X} - w_X V_{\\mathrm{G}}(r_X) \\right) $$\n其中 $V_{\\mathrm{G}}(r_X) = \\frac{\\operatorname{erf}(\\beta r_X)}{r_X}$ 且 $\\beta=\\sqrt{\\alpha}$。\n\n力是来自每个中心的力之和：$\\mathbf{F}_{\\mathrm{ana}} = \\sum_{X \\in \\{A,B\\}} \\mathbf{F}_X$。\n$$ \\mathbf{F}_X = -\\nabla_{\\mathbf{R}_q} \\left[ q \\left( \\frac{Z_X}{r_X} - w_X \\frac{\\operatorname{erf}(\\beta r_X)}{r_X} \\right) \\right] $$\n使用梯度的链式法则，$\\nabla_{\\mathbf{R}_q} f(r_X) = \\frac{df}{dr_X} \\nabla_{\\mathbf{R}_q} r_X = \\frac{df}{dr_X} \\frac{\\mathbf{r}_X}{r_X}$。\n\n让我们找出括号中两项关于 $r_X$ 的导数：\n1.  **原子核库仑项：**\n    $$ \\frac{d}{dr_X} \\left( \\frac{Z_X}{r_X} \\right) = -\\frac{Z_X}{r_X^2} $$\n2.  **电子高斯项：** 我们使用商法则和误差函数的导数 $\\frac{d}{du}\\operatorname{erf}(u) = \\frac{2}{\\sqrt{\\pi}}e^{-u^2}$。\n    $$ \\frac{d}{dr_X} \\left( w_X \\frac{\\operatorname{erf}(\\beta r_X)}{r_X} \\right) = w_X \\frac{r_X \\left(\\frac{2\\beta}{\\sqrt{\\pi}}e^{-\\beta^2 r_X^2}\\right) - \\operatorname{erf}(\\beta r_X) \\cdot 1}{r_X^2} = w_X \\left( \\frac{2\\beta}{\\sqrt{\\pi} r_X}e^{-\\beta^2 r_X^2} - \\frac{\\operatorname{erf}(\\beta r_X)}{r_X^2} \\right) $$\n\n结合这些结果，中心 $X$ 的能量项的梯度是：\n$$ \\nabla_{\\mathbf{R}_q} \\left[ \\dots \\right]_X = \\left[ -\\frac{Z_X}{r_X^2} - w_X \\left( \\frac{2\\beta}{\\sqrt{\\pi} r_X}e^{-\\beta^2 r_X^2} - \\frac{\\operatorname{erf}(\\beta r_X)}{r_X^2} \\right) \\right] \\frac{\\mathbf{r}_X}{r_X} $$\n力的贡献 $\\mathbf{F}_X = -q \\cdot (\\nabla_{\\mathbf{R}_q} [\\dots]_X)$ 为：\n$$ \\mathbf{F}_X = q \\left[ \\frac{Z_X}{r_X^2} + w_X \\left( \\frac{2\\beta}{\\sqrt{\\pi} r_X}e^{-\\beta^2 r_X^2} - \\frac{\\operatorname{erf}(\\beta r_X)}{r_X^2} \\right) \\right] \\frac{\\mathbf{r}_X}{r_X} $$\n重新整理得到一个更紧凑的表达式：\n$$ \\mathbf{F}_X = q \\frac{\\mathbf{r}_X}{r_X^3} \\left( Z_X - w_X \\operatorname{erf}(\\beta r_X) + w_X \\frac{2\\beta r_X}{\\sqrt{\\pi}} e^{-\\beta^2 r_X^2} \\right) $$\n总解析力是两个中心上的向量和：\n$$ \\mathbf{F}_{\\mathrm{ana}}(\\mathbf{R}_q) = q \\sum_{X \\in \\{A,B\\}} \\frac{\\mathbf{R}_q - \\mathbf{R}_X}{\\lVert \\mathbf{R}_q - \\mathbf{R}_X \\rVert^3} \\left( Z_X - w_X \\left[ \\operatorname{erf}(\\beta \\lVert \\mathbf{R}_q - \\mathbf{R}_X \\rVert) - \\frac{2\\beta \\lVert \\mathbf{R}_q - \\mathbf{R}_X \\rVert}{\\sqrt{\\pi}} e^{-\\beta^2 \\lVert \\mathbf{R}_q - \\mathbf{R}_X \\rVert^2} \\right] \\right) $$\n这就是要为解析力实现的最终表达式。\n\n### 2. 实现策略\n\n解决方案将使用 Python 的 `numpy` 和 `scipy` 库来实现。\n\n1.  **能量函数：** 将定义一个函数 `calculate_energy`，用于计算给定位置向量 $\\mathbf{R}_q$ 的 $E_{\\mathrm{int}}(\\mathbf{R}_q)$。它将接收所有系统参数作为参数。需要注意 $r \\to 0$ 的情况，此时势能 $V_G(r)$ 有一个有限的极限 $V_G(0) = 2\\beta/\\sqrt{\\pi}$。尽管给定的测试用例避免了 $r=0$ 的情况，但健壮的代码应该考虑到这一点。\n\n2.  **数值力：** 一个函数 `calculate_numerical_force` 将计算 $\\mathbf{F}_{\\mathrm{num}}(\\mathbf{R}_q)$。它将对每个笛卡尔轴 $i \\in \\{x,y,z\\}$，在位置 $\\mathbf{R}_q \\pm h\\hat{\\mathbf{e}}_i$ 调用 `calculate_energy` 函数，并应用中心差分公式。\n\n3.  **解析力：** 一个函数 `calculate_analytic_force` 将实现推导出的 $\\mathbf{F}_{\\mathrm{ana}}(\\mathbf{R}_q)$ 公式。它将计算来自中心 A 和 B 的力贡献并将它们相加。\n\n4.  **主循环：** 一个主循环将遍历提供的测试用例。对于每个用例，它将： a. 设置参数。 b. 调用函数计算 $\\mathbf{F}_{\\mathrm{num}}$ 和 $\\mathbf{F}_{\\mathrm{ana}}$。 c. 计算它们之间差值的欧几里得范数 $\\Delta = \\lVert \\mathbf{F}_{\\mathrm{num}} - \\mathbf{F}_{\\mathrm{ana}} \\rVert$。 d. 将结果格式化为八位小数并存储。\n\n5.  **输出：** 最后，将所有测试用例收集到的结果以指定的格式 `[d1,d2,d3,d4]` 打印出来。\n\n有限差分法会引入一个截断误差，预计其数量级为 $O(h^2)$。因此，计算出的差异 $\\Delta$ 将会很小但非零（除非在像测试用例 4 这样的特殊情况下，对称性可能导致精确的零力，从而使数值结果也为零）。",
            "answer": "$$[0.00000006,0.00000000,0.00000000,0.00000000]$$"
        }
    ]
}