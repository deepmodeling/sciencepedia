{
    "hands_on_practices": [
        {
            "introduction": "理论知识是基础，但真正的理解来自于实践。本节的第一个练习将指导您完成建立QM/MM模拟最基本也是最关键的一步：定义边界和构建连接原子。您将学习如何通过编程方式识别跨越QM和MM区域的化学键，并根据明确的物理化学原理来确定连接原子的位置和参数。这个练习  是掌握连接原子方法实际操作的起点。",
            "id": "3731032",
            "problem": "给定一个包含原子、笛卡尔坐标和共价键的分子图，考虑一个加和式的量子力学/分子力学 (QM/MM) 方案，其中共价键可能跨越所提出的 QM/MM 划分。在这种情况下，会引入一个连接原子来饱和量子力学侧的价态，同时保持沿断裂共价键的几何构型。\n\n从基本原理出发：\n- 一个分子系统被建模为一个图，其中节点代表原子，边代表共价键。将原子集划分为两个不相交的子集：量子力学区域 $\\mathcal{Q}$ 和分子力学区域 $\\mathcal{M}$，其中 $\\mathcal{Q} \\cup \\mathcal{M}$ 等于完整的原子集，且 $\\mathcal{Q} \\cap \\mathcal{M} = \\emptyset$。\n- 对于每个键 $(i,j)$，该键跨越 QM/MM 边界当且仅当 $i \\in \\mathcal{Q}$ 且 $j \\in \\mathcal{M}$，或者 $i \\in \\mathcal{M}$ 且 $j \\in \\mathcal{Q}$。\n- 连接原子的位置是沿着从量子力学原子到其分子力学配对原子的向量放置的，使用基于共价半径定义的目标键长的方向性缩放。设量子力学原子为 $q$，分子力学原子为 $m$。定义位置 $\\mathbf{r}_q$ 和 $\\mathbf{r}_m$（单位为埃）。定义原始键长 $d_{qm} = \\|\\mathbf{r}_m - \\mathbf{r}_q\\|$（单位为埃）。设 $X$ 是原子 $q$ 的元素，$H$ 是氢。定义元素 $E$ 的共价半径 $R_{\\mathrm{cov}}(E)$（单位为埃）。目标连接键长为 $d_{\\mathrm{ref}}(X\\text{-}H) = R_{\\mathrm{cov}}(X) + R_{\\mathrm{cov}}(H)$（单位为埃）。放置缩放因子为 $\\lambda = d_{\\mathrm{ref}}(X\\text{-}H)/d_{qm}$。连接原子的坐标为\n$$\n\\mathbf{r}_L = \\mathbf{r}_q + \\lambda (\\mathbf{r}_m - \\mathbf{r}_q)\n$$\n（单位为埃），使得连接键长 $d_{\\mathrm{link}} = d_{\\mathrm{ref}}(X\\text{-}H)$（单位为埃）。\n- 对于参数化，将连接键建模为谐振子。角频率 $\\omega$ 通过 $\\omega = 2\\pi c \\tilde{\\nu}$ 与光谱波数 $\\tilde{\\nu}$（单位为倒数厘米）相关联，其中 $c$ 是光速（单位为厘米/秒）。力常数 $k$ 为\n$$\nk = \\mu \\,\\omega^2\n$$\n（单位为牛顿/米），其中折合质量为\n$$\n\\mu = \\frac{m_X m_H}{m_X + m_H}\n$$\n，$m_X$ 和 $m_H$ 的单位为千克。原子质量单位换算为 $1\\ \\mathrm{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$。光速为 $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm/s}$。典型的 $X\\text{-}H$ 伸缩振动波数依赖于元素：对于 $X=\\mathrm{C}$，$\\tilde{\\nu} = 3000\\ \\mathrm{cm}^{-1}$；对于 $X=\\mathrm{N}$，$\\tilde{\\nu} = 3300\\ \\mathrm{cm}^{-1}$；对于 $X=\\mathrm{O}$，$\\tilde{\\nu} = 3600\\ \\mathrm{cm}^{-1}$；对于 $X=\\mathrm{Si}$，$\\tilde{\\nu} = 2100\\ \\mathrm{cm}^{-1}$。\n\n您的任务是实现一个算法，该算法能够：\n- 识别所有跨越 QM/MM 划分的共价键。\n- 对每个跨越键，使用上述方向性缩放规则，在量子力学侧构建一个单一的氢连接原子。\n- 通过计算每个连接原子键的键长 $d_{\\mathrm{link}}$（单位为埃）、折合质量 $\\mu$（单位为千克）以及使用适用于量子力学原子类型的波数计算谐振力常数 $k$（单位为牛顿/米），来参数化该键。\n- 对于每个跨越键，返回一个列表，其中包含按此确切顺序排列的以下量：$[x_L, y_L, z_L, d_{\\mathrm{link}}, k, \\mu, \\lambda]$，其中 $(x_L,y_L,z_L)$ 是连接原子的坐标（单位为埃），$d_{\\mathrm{link}}$ 的单位是埃， $k$ 的单位是 $\\mathrm{N}/\\mathrm{m}$，$\\mu$ 的单位是 $\\mathrm{kg}$，而 $\\lambda$ 是无量纲的。如果没有跨越键，则为该测试用例返回一个空列表。\n\n使用以下常数和元素属性：\n- 共价半径（单位：埃）：$R_{\\mathrm{cov}}(\\mathrm{H}) = 0.31$，$R_{\\mathrm{cov}}(\\mathrm{C}) = 0.76$，$R_{\\mathrm{cov}}(\\mathrm{N}) = 0.71$，$R_{\\mathrm{cov}}(\\mathrm{O}) = 0.66$，$R_{\\mathrm{cov}}(\\mathrm{Si}) = 1.11$。\n- 原子质量（单位：原子质量单位）：$m_{\\mathrm{H}} = 1.00784\\ \\mathrm{u}$，$m_{\\mathrm{C}} = 12.0107\\ \\mathrm{u}$，$m_{\\mathrm{N}} = 14.0067\\ \\mathrm{u}$，$m_{\\mathrm{O}} = 15.999\\ \\mathrm{u}$，$m_{\\mathrm{Si}} = 28.085\\ \\mathrm{u}$。\n- 波数（单位：倒数厘米）：$\\tilde{\\nu}_{\\mathrm{C}\\text{-}\\mathrm{H}} = 3000$，$\\tilde{\\nu}_{\\mathrm{N}\\text{-}\\mathrm{H}} = 3300$，$\\tilde{\\nu}_{\\mathrm{O}\\text{-}\\mathrm{H}} = 3600$，$\\tilde{\\nu}_{\\mathrm{Si}\\text{-}\\mathrm{H}} = 2100$。\n\n物理单位：\n- 坐标和距离必须以埃表示。\n- 力常数必须以 $\\mathrm{N}/\\mathrm{m}$ 表示。\n- 折合质量必须以 $\\mathrm{kg}$ 表示。\n\n测试套件：\n提供一个程序，使用以下六个测试用例（所有索引均为零基），并根据上述规则生成结果。\n\n- 测试用例 $1$（正常路径，碳-碳边界）：\n  - 位置（单位：埃）：$\\mathbf{r}_0 = (0.0, 0.0, 0.0)$，$\\mathbf{r}_1 = (1.54, 0.0, 0.0)$。\n  - 元素：$[\\mathrm{C}, \\mathrm{C}]$。\n  - 键：$\\{(0,1)\\}$。\n  - QM 集：$\\mathcal{Q} = \\{0\\}$，MM 集：$\\mathcal{M} = \\{1\\}$。\n\n- 测试用例 $2$（氮-碳边界）：\n  - 位置（单位：埃）：$\\mathbf{r}_0 = (0.0, 0.0, 0.0)$，$\\mathbf{r}_1 = (1.47, 0.0, 0.0)$。\n  - 元素：$[\\mathrm{N}, \\mathrm{C}]$。\n  - 键：$\\{(0,1)\\}$。\n  - QM 集：$\\mathcal{Q} = \\{0\\}$，MM 集：$\\mathcal{M} = \\{1\\}$。\n\n- 测试用例 $3$（氧-碳边界）：\n  - 位置（单位：埃）：$\\mathbf{r}_0 = (0.0, 0.0, 0.0)$，$\\mathbf{r}_1 = (1.43, 0.0, 0.0)$。\n  - 元素：$[\\mathrm{O}, \\mathrm{C}]$。\n  - 键：$\\{(0,1)\\}$。\n  - QM 集：$\\mathcal{Q} = \\{0\\}$，MM 集：$\\mathcal{M} = \\{1\\}$。\n\n- 测试用例 $4$（硅-碳边界）：\n  - 位置（单位：埃）：$\\mathbf{r}_0 = (0.0, 0.0, 0.0)$，$\\mathbf{r}_1 = (1.89, 0.0, 0.0)$。\n  - 元素：$[\\mathrm{Si}, \\mathrm{C}]$。\n  - 键：$\\{(0,1)\\}$。\n  - QM 集：$\\mathcal{Q} = \\{0\\}$，MM 集：$\\mathcal{M} = \\{1\\}$。\n\n- 测试用例 $5$（无跨越键）：\n  - 位置（单位：埃）：$\\mathbf{r}_0 = (0.0, 0.0, 0.0)$，$\\mathbf{r}_1 = (1.54, 0.0, 0.0)$。\n  - 元素：$[\\mathrm{C}, \\mathrm{C}]$。\n  - 键：$\\{(0,1)\\}$。\n  - QM 集：$\\mathcal{Q} = \\{0,1\\}$，MM 集：$\\mathcal{M} = \\emptyset$。\n\n- 测试用例 $6$（拉伸的碳-碳边界）：\n  - 位置（单位：埃）：$\\mathbf{r}_0 = (0.0, 0.0, 0.0)$，$\\mathbf{r}_1 = (3.0, 0.0, 0.0)$。\n  - 元素：$[\\mathrm{C}, \\mathrm{C}]$。\n  - 键：$\\{(0,1)\\}$。\n  - QM 集：$\\mathcal{Q} = \\{0\\}$，MM 集：$\\mathcal{M} = \\{1\\}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个条目。每个测试用例条目本身必须是一个连接原子条目的列表。每个连接原子条目必须是按规定格式排列的列表 $[x_L,y_L,z_L,d_{\\mathrm{link}},k,\\mu,\\lambda]$。例如，如果测试用例 $i$ 有一个跨越键，其条目将看起来像 $[[x_L,y_L,z_L,d_{\\mathrm{link}},k,\\mu,\\lambda]]$；如果没有跨越键，其条目将是 $[]$。",
            "solution": "该问题要求实现一种算法，用于在加和式量子力学/分子力学 (QM/MM) 模拟中放置和参数化连接原子。该过程基于计算化学中的既定方法。解决方案是遵循所提供的物理原理和数学定义来设计的。\n\n任务的核心是处理一系列分子系统，每个系统都由其原子组分、笛卡尔坐标、共价连接性以及划分为量子力学 ($\\mathcal{Q}$) 区域和分子力学 ($\\mathcal{M}$) 区域来定义。对于每个系统，我们必须识别跨越此划分的共价键，并为每个此类键引入一个氢连接原子并计算其属性。\n\n该算法按以下逻辑步骤构建：\n\n1.  **识别跨越键**：一个共价键连接两个原子，假设索引为 $i$ 和 $j$。如果一个原子属于 $\\mathcal{Q}$ 区域，而另一个原子属于 $\\mathcal{M}$ 区域，则该键被定义为“跨越键”。这由逻辑条件表示：$(i \\in \\mathcal{Q} \\land j \\in \\mathcal{M}) \\lor (j \\in \\mathcal{Q} \\land i \\in \\mathcal{M})$。对系统键列表中的每个键检查此条件。如果不满足，则该键完全位于一个区域内，不需要连接原子。\n\n2.  **连接原子的几何放置**：对于每个已识别的跨越键，引入一个氢连接原子 ($L$) 来饱和先前与 MM 原子 ($m$) 成键的 QM 原子 ($q$) 的自由价。连接原子的位置 $\\mathbf{r}_L$ 由方向性缩放规则确定。此规则将连接原子放置在从 QM 原子指向 MM 原子的向量 $\\mathbf{v}_{qm} = \\mathbf{r}_m - \\mathbf{r}_q$ 上。\n    关键原则是将 QM 原子 ($X$) 和连接原子 ($H$) 之间的新键长设置为一个标准参考值 $d_{\\mathrm{link}}$，该值与原始键的几何形状无关。此参考长度定义为两个原子的共价半径之和，$d_{\\mathrm{link}} = d_{\\mathrm{ref}}(X\\text{-}H) = R_{\\mathrm{cov}}(X) + R_{\\mathrm{cov}}(H)$。\n    原始键的长度为 $d_{qm} = \\|\\mathbf{r}_m - \\mathbf{r}_q\\|$。为实现所需的连接键长，向量 $\\mathbf{v}_{qm}$ 被一个因子 $\\lambda = d_{\\mathrm{link}} / d_{qm}$ 缩放。\n    连接原子的最终坐标由以下公式给出：\n    $$\n    \\mathbf{r}_L = \\mathbf{r}_q + \\lambda (\\mathbf{r}_m - \\mathbf{r}_q)\n    $$\n    其中所有坐标和距离的单位均为埃 ($\\mathrm{\\AA}$)。\n\n3.  **连接键的物理参数化**：新形成的 $X$-$H$ 连接键通常在 QM/MM 能量表达式的 MM 力场部分中被建模为简谐振子（尽管这里我们只计算参数）。这需要计算 $X$-$H$ 系统的折合质量 ($\\mu$) 和键伸缩的谐振力常数 ($k$)\n\n    a.  **折合质量 ($\\mu$)**：对于由 QM 原子 $X$ 和氢连接原子 $H$ 组成的双体系统，折合质量使用它们各自的原子质量 $m_X$ 和 $m_H$ 计算：\n        $$\n        \\mu = \\frac{m_X m_H}{m_X + m_H}\n        $$\n        所提供的原子质量单位为原子质量单位 ($\\mathrm{u}$)，为了在后续计算中保持一致性，必须使用换算因子 $1\\ \\mathrm{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$ 将其转换为千克 ($\\mathrm{kg}$)。\n\n    b.  **力常数 ($k$)**：力常数源自键的振动频率。在光谱学中，这通常以波数 $\\tilde{\\nu}$（单位为 $\\mathrm{cm}^{-1}$）给出，该值特定于键的类型（例如，C-H、N-H）。波数通过以下公式与角频率 $\\omega$ 相关：\n        $$\n        \\omega = 2\\pi c \\tilde{\\nu}\n        $$\n        其中 $c$ 是光速。使用单位为 $\\mathrm{cm/s}$ 的 $c$ 和单位为 $\\mathrm{cm}^{-1}$ 的 $\\tilde{\\nu}$，可以得到单位为 $\\mathrm{s}^{-1}$ 的 $\\omega$。谐振子的力常数 $k$ 则由以下公式给出：\n        $$\n        k = \\mu \\omega^2\n        $$\n        如果 $\\mu$ 的单位是 $\\mathrm{kg}$，$\\omega$ 的单位是 $\\mathrm{s}^{-1}$，则得到的力常数 $k$ 的单位将是 $\\mathrm{kg/s^2}$，这等同于牛顿/米 ($\\mathrm{N/m}$)。\n\n4.  **实现与数据聚合**：该算法被实现用于处理一套测试用例。对于每个用例，它遍历指定的键。如果一个键跨越 QM/MM 边界，算法会识别 QM 侧的原子 ($q$) 及其对应的元素 ($X$)，计算所需的七个量（$\\mathbf{r}_L = (x_L, y_L, z_L)$、$d_{\\mathrm{link}}$、$k$、$\\mu$ 和 $\\lambda$），并将它们存储在一个列表中。每个测试用例的最终输出是一个包含其所有跨越键结果的列表。如果一个测试用例没有跨越键，则返回一个空列表。所有计算都遵循所提供的物理常数和特定于元素的参数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the QM/MM link atom problem for a given set of test cases.\n    \"\"\"\n    # Define constants and element properties\n    U_TO_KG = 1.66053906660e-27  # kg/u\n    C_CMS = 2.99792458e10       # cm/s\n\n    COVALENT_RADII = {\n        'H': 0.31, 'C': 0.76, 'N': 0.71, 'O': 0.66, 'Si': 1.11\n    }\n    ATOMIC_MASSES = {\n        'H': 1.00784, 'C': 12.0107, 'N': 14.0067, 'O': 15.999, 'Si': 28.085\n    }\n    WAVENUMBERS = {\n        'C': 3000, 'N': 3300, 'O': 3600, 'Si': 2100\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1: C-C boundary\n        {\n            \"positions\": [(0.0, 0.0, 0.0), (1.54, 0.0, 0.0)],\n            \"elements\": ['C', 'C'],\n            \"bonds\": {(0, 1)},\n            \"qm_set\": {0},\n            \"mm_set\": {1}\n        },\n        # Test Case 2: N-C boundary\n        {\n            \"positions\": [(0.0, 0.0, 0.0), (1.47, 0.0, 0.0)],\n            \"elements\": ['N', 'C'],\n            \"bonds\": {(0, 1)},\n            \"qm_set\": {0},\n            \"mm_set\": {1}\n        },\n        # Test Case 3: O-C boundary\n        {\n            \"positions\": [(0.0, 0.0, 0.0), (1.43, 0.0, 0.0)],\n            \"elements\": ['O', 'C'],\n            \"bonds\": {(0, 1)},\n            \"qm_set\": {0},\n            \"mm_set\": {1}\n        },\n        # Test Case 4: Si-C boundary\n        {\n            \"positions\": [(0.0, 0.0, 0.0), (1.89, 0.0, 0.0)],\n            \"elements\": ['Si', 'C'],\n            \"bonds\": {(0, 1)},\n            \"qm_set\": {0},\n            \"mm_set\": {1}\n        },\n        # Test Case 5: No crossing bond\n        {\n            \"positions\": [(0.0, 0.0, 0.0), (1.54, 0.0, 0.0)],\n            \"elements\": ['C', 'C'],\n            \"bonds\": {(0, 1)},\n            \"qm_set\": {0, 1},\n            \"mm_set\": set()\n        },\n        # Test Case 6: Stretched C-C boundary\n        {\n            \"positions\": [(0.0, 0.0, 0.0), (3.0, 0.0, 0.0)],\n            \"elements\": ['C', 'C'],\n            \"bonds\": {(0, 1)},\n            \"qm_set\": {0},\n            \"mm_set\": {1}\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        case_results = []\n        positions = [np.array(p) for p in case[\"positions\"]]\n        elements = case[\"elements\"]\n        bonds = case[\"bonds\"]\n        qm_set = case[\"qm_set\"]\n        mm_set = case[\"mm_set\"]\n\n        for i, j in bonds:\n            is_crossing = (i in qm_set and j in mm_set) or \\\n                          (j in qm_set and i in mm_set)\n\n            if is_crossing:\n                if i in qm_set:\n                    q_idx, m_idx = i, j\n                else:\n                    q_idx, m_idx = j, i\n                \n                r_q = positions[q_idx]\n                r_m = positions[m_idx]\n                \n                # 1. Geometric Placement\n                d_qm = np.linalg.norm(r_m - r_q)\n                \n                X_element = elements[q_idx]\n                d_link = COVALENT_RADII[X_element] + COVALENT_RADII['H']\n                \n                # Avoid division by zero for coincident atoms\n                if d_qm == 0:\n                    lambda_scale = 0.0\n                else:\n                    lambda_scale = d_link / d_qm\n                \n                r_L = r_q + lambda_scale * (r_m - r_q)\n\n                # 2. Physical Parameterization\n                # Reduced Mass\n                m_X_u = ATOMIC_MASSES[X_element]\n                m_H_u = ATOMIC_MASSES['H']\n                mu_u = (m_X_u * m_H_u) / (m_X_u + m_H_u)\n                mu_kg = mu_u * U_TO_KG\n\n                # Force Constant\n                wavenumber = WAVENUMBERS[X_element] # in cm^-1\n                omega = 2 * math.pi * C_CMS * wavenumber # in s^-1\n                k_force = mu_kg * omega**2 # in N/m\n\n                # 3. Assemble results in specified order\n                link_atom_data = [\n                    r_L[0], r_L[1], r_L[2],  # x_L, y_L, z_L\n                    d_link,                  # d_link\n                    k_force,                 # k\n                    mu_kg,                   # mu\n                    lambda_scale             # lambda\n                ]\n                case_results.append(link_atom_data)\n\n        all_results.append(case_results)\n\n    # Format the final output string without extra spaces in lists\n    def format_list(item):\n        if isinstance(item, list):\n            return f\"[{','.join(format_list(x) for x in item)}]\"\n        return str(item)\n    \n    final_output_str = f\"[{','.join(format_list(res) for res in all_results)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "简单地切断化学键并添加连接原子会引入一些非物理性的“边界赝象”（boundary artifacts）。第二个练习将带您深入探究其中一个基本问题：边界处局部振动模式的扭曲。通过这个练习 ，您将从第一性原理出发，推导出一个校正方案，以恢复被切断化学键周围正确的物理行为。这不仅能加深您对连接原子法局限性的理解，还能让您掌握如何通过理论分析来弥补这些缺陷。",
            "id": "3731038",
            "problem": "考虑一个加和式的量子力学/分子力学 (QM/MM) 分区，其中一个共价键在边界处被切断。设量子力学 (QM) 区域包含质量为 $m_{A}$ 的原子 $A$，分子力学 (MM) 区域包含质量为 $m_{B}$ 的原子 $B$。原始的跨界键 $A$–$B$ 沿其键轴被一个势 $V_{AB} = \\frac{1}{2} k_{AB} (x_{B} - x_{A})^{2}$ 进行谐波建模，其中 $x_{A}$ 和 $x_{B}$ 是沿键轴的位移，$k_{AB}$ 是键力常数。在带有连接原子的加和式 QM/MM 方案中，键合项 $V_{AB}$ 从 MM 哈密顿量中移除，这会改变 MM 片段在边界附近的局域振动光谱。\n\n从经典小振动框架和耦合谐振子的简正模定义出发，完成以下任务：\n\n1. 当键 $V_{AB}$ 存在且系统与所有其他原子隔离时，推导原始 $A$–$B$ 伸缩模式的角频率 $ \\omega_{AB} $。\n2. 证明从 MM 片段中移除 $V_{AB}$ 会消除 MM 片段的质量加权 Hessian 矩阵中原子 $B$ 沿键轴方向的相应刚度贡献，从而改变该片段的局域振动光谱。\n3. 在 MM 侧提出一个形式为 $U_{\\mathrm{corr}} = \\frac{1}{2} k_{\\mathrm{corr}} x_{B}^{2}$ 的局域谐波校正，其中 $k_{\\mathrm{corr}}$ 是一个可调的弹簧常数，用于将原子 $B$ 沿键轴束缚在其平衡位置。推导 $k_{\\mathrm{corr}}$ 的表达式，使得校正后的 MM 片段在 $B$ 坐标上再现原始的 $A$–$B$ 伸缩角频率。\n4. 使用您推导的表达式，根据参数 $m_{A} = 1.994 \\times 10^{-26}$ kg，$m_{B} = 2.324 \\times 10^{-26}$ kg 和 $k_{AB} = 650$ N/m 计算 $k_{\\mathrm{corr}}$。将最终的校正弹簧常数以 N/m 表示，并将答案四舍五入到四位有效数字。\n\n您的最终答案必须是一个实数值。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **系统：** 一个加和式的量子力学/分子力学 (QM/MM) 分区。\n- **组分：** QM 区域中的原子 $A$，质量为 $m_{A}$；MM 区域中的原子 $B$，质量为 $m_{B}$。\n- **原始相互作用：** 一个共价键 $A$–$B$ 被切断。该键的势被谐波建模为 $V_{AB} = \\frac{1}{2} k_{AB} (x_{B} - x_{A})^{2}$，其中 $x_{A}$ 和 $x_{B}$ 是沿键轴相对于平衡位置的位移，$k_{AB}$ 是键力常数。\n- **QM/MM 方案：** 使用带有连接原子的加和式方案，其中项 $V_{AB}$ 从 MM 哈密顿量中移除。\n- **校正：** 在 MM 侧提出了一个局域谐波校正势 $U_{\\mathrm{corr}} = \\frac{1}{2} k_{\\mathrm{corr}} x_{B}^{2}$，用于将原子 $B$ 束缚在其平衡位置。\n- **目标：**\n    1. 推导原始孤立 $A$–$B$ 伸缩模式的角频率 $\\omega_{AB}$。\n    2. 证明移除 $V_{AB}$ 对 MM 片段的质量加权 Hessian 矩阵的影响。\n    3. 推导 $k_{\\mathrm{corr}}$ 的表达式，使得校正后的 MM 片段在 $B$ 坐标上再现原始的 $A$–$B$ 伸缩角频率。\n    4. 根据给定参数计算 $k_{\\mathrm{corr}}$：\n        - $m_{A} = 1.994 \\times 10^{-26}$ kg\n        - $m_{B} = 2.324 \\times 10^{-26}$ kg\n        - $k_{AB} = 650$ N/m\n- **最终答案要求：** $k_{\\mathrm{corr}}$ 的最终值应以 N/m 为单位，并四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于经典力学（谐振子、简正模）的基本原理及其在计算化学和物理学（QM/MM 建模）中一种成熟技术中的应用。连接原子方法及相关的边界伪影校正问题是多尺度建模领域的标准课题。物理模型和概念是合理的。\n- **适定性：** 该问题被构建为一系列逻辑上相互关联的任务，从第一性原理出发，最终得到一个数值答案。目标明确，并提供了足够的信息来推导出一个唯一的解。\n- **客观性：** 该问题使用精确、定量且无偏见的科学语言进行表述。\n- **完整性与一致性：** 该问题是自洽的。所有必要的变量、常数和物理场景都已定义。提供的数值对于原子质量和键伸缩力常数是物理上现实的，并且以一致的国际单位制（SI）单位给出。没有内部矛盾。\n\n**步骤 3：结论与行动**\n该问题被认为是**有效的**，因为它具有科学依据、适定、客观且自洽。可以继续求解过程。\n\n### 解答\n\n根据问题陈述的要求，解答将分四个部分呈现。\n\n**1. 原始角频率 $\\omega_{AB}$ 的推导**\n\n我们考虑由原子 $A$（质量为 $m_A$）和原子 $B$（质量为 $m_B$）组成的孤立双体系统，它们通过谐波势 $V_{AB} = \\frac{1}{2} k_{AB} (x_{B} - x_{A})^{2}$ 相互作用。沿键轴运动的拉格朗日量 $L$ 是动能 $T$ 减去势能 $V_{AB}$：\n$$L = T - V_{AB} = \\frac{1}{2} m_{A} \\dot{x}_{A}^{2} + \\frac{1}{2} m_{B} \\dot{x}_{B}^{2} - \\frac{1}{2} k_{AB} (x_{B} - x_{A})^{2}$$\n简谐振子的运动方程用相对坐标 $q = x_{B} - x_{A}$ 更容易求解。动能可以表示为质心速度和相对速度的函数。然而，对于内振动，我们关心的是由相对坐标 $q$ 描述的运动。这个相对坐标的运动方程由下式给出：\n$$\\mu \\ddot{q} = -k_{AB} q$$\n其中 $\\mu$ 是该双体系统的折合质量：\n$$\\mu = \\frac{m_{A} m_{B}}{m_{A} + m_{B}}$$\n这是简谐振子的标准方程，$\\ddot{q} + \\omega^{2} q = 0$。通过比较，$A$–$B$ 伸缩模式的角频率平方 $\\omega_{AB}^{2}$ 为：\n$$\\omega_{AB}^{2} = \\frac{k_{AB}}{\\mu} = k_{AB} \\left( \\frac{m_{A} + m_{B}}{m_{A} m_{B}} \\right) = k_{AB} \\left( \\frac{1}{m_{A}} + \\frac{1}{m_{B}} \\right)$$\n因此，角频率为：\n$$\\omega_{AB} = \\sqrt{\\frac{k_{AB}}{\\mu}} = \\sqrt{k_{AB} \\left(\\frac{1}{m_{A}} + \\frac{1}{m_{B}}\\right)}$$\n\n**2. 从 MM 哈密顿量中移除 $V_{AB}$ 的影响**\n\n分子系统的振动频率是通过对角化质量加权 Hessian 矩阵得到的。Hessian 矩阵 $\\mathbf{H}$ 是势能 $V$ 对原子笛卡尔坐标的二阶偏导数矩阵。对于沿 $x$ 轴的一维系统，元素 $H_{ij}$ 由 $H_{ij} = \\frac{\\partial^2 V}{\\partial x_i \\partial x_j}$ 给出。质量加权 Hessian 矩阵 $\\mathbf{H'}$ 的元素为 $H'_{ij} = \\frac{1}{\\sqrt{m_i m_j}} H_{ij}$。$\\mathbf{H'}$ 的本征值是简正模角频率的平方，即 $\\omega^2$。\n\nMM 片段的势 $V_{MM}$ 最初包括其所有内部相互作用以及跨界项 $V_{AB}$。Hessian 矩阵中对应于原子 $B$ 坐标 $x_B$ 的对角元素从 $V_{AB}$ 获得一个贡献：\n$$\\frac{\\partial^{2} V_{AB}}{\\partial x_{B}^{2}} = \\frac{\\partial^{2}}{\\partial x_{B}^{2}} \\left[ \\frac{1}{2} k_{AB} (x_{B} - x_{A})^{2} \\right] = \\frac{\\partial}{\\partial x_{B}} \\left[ k_{AB} (x_{B} - x_{A}) \\right] = k_{AB}$$\n当加和式 QM/MM 方案从 MM 力场中移除 $V_{AB}$ 项时，这个刚度贡献 $k_{AB}$ 会从原子 $B$ 的 Hessian 对角元素（即 $\\frac{\\partial^2 V_{MM}}{\\partial x_B^2}$）中减去。因此，质量加权 Hessian 矩阵中的相应元素 $\\frac{1}{m_B} \\frac{\\partial^2 V_{MM}}{\\partial x_B^2}$ 会减小。由于该矩阵的本征值决定了振动频率，移除此刚度项会改变本征值，从而改变 MM 片段的局域振动光谱。具体来说，它移除了作用在原子 $B$ 上的、源于其与原子 $A$ 成键的恢复力，这可能导致涉及原子 $B$ 的非物理的、软的振动模式。\n\n**3. 校正常数 $k_{\\mathrm{corr}}$ 的推导**\n\n目标是让校正后 MM 系统中原子 $B$ 的运动模拟其在原始未切割的 $A-B$ 伸缩模式中的运动。在以频率 $\\omega_{AB}$ 振荡的原始简正模中，$A-B$ 系统的质心是静止的。如果我们将质心置于原点，我们有以下条件：\n$$m_{A} x_{A} + m_{B} x_{B} = 0$$\n这暗示了两个原子位移之间的关系：\n$$x_{A} = -\\frac{m_{B}}{m_{A}} x_{B}$$\n现在，我们考察原始系统中原子 $B$ 的运动方程：\n$$m_{B} \\ddot{x}_{B} = F_{B} = -\\frac{\\partial V_{AB}}{\\partial x_{B}} = -k_{AB} (x_{B} - x_{A})$$\n将质心条件中的 $x_{A}$ 表达式代入，我们得到作用在 $B$ 上的有效力，作为其自身位移 $x_B$ 的函数：\n$$m_{B} \\ddot{x}_{B} = -k_{AB} \\left( x_{B} - \\left(-\\frac{m_{B}}{m_{A}} x_{B}\\right) \\right) = -k_{AB} \\left( 1 + \\frac{m_{B}}{m_{A}} \\right) x_{B}$$\n该方程描述了原子 $B$ 的简谐运动，其有效弹簧常数为 $k_{\\text{eff}} = k_{AB} \\left( 1 + \\frac{m_{B}}{m_{A}} \\right)$。\n\n在校正后的 MM 模型中，原子 $B$ 受到势 $U_{\\mathrm{corr}} = \\frac{1}{2} k_{\\mathrm{corr}} x_{B}^{2}$ 的作用。其运动方程为：\n$$m_{B} \\ddot{x}_{B} = -\\frac{\\partial U_{\\mathrm{corr}}}{\\partial x_{B}} = -k_{\\mathrm{corr}} x_{B}$$\n为了确保校正后的系统能够再现原始振动模式中原子 $B$ 的动力学，两种情况下的力必须相同。通过令两个运动方程的右侧相等，我们得到：\n$$-k_{\\mathrm{corr}} x_{B} = -k_{AB} \\left( 1 + \\frac{m_{B}}{m_{A}} \\right) x_{B}$$\n这得出了校正常数的表达式：\n$$k_{\\mathrm{corr}} = k_{AB} \\left( 1 + \\frac{m_{B}}{m_{A}} \\right)$$\n\n**4. $k_{\\mathrm{corr}}$ 的数值计算**\n\n给定以下数值：\n- $m_{A} = 1.994 \\times 10^{-26}$ kg\n- $m_{B} = 2.324 \\times 10^{-26}$ kg\n- $k_{AB} = 650$ N/m\n\n我们将这些值代入推导出的 $k_{\\mathrm{corr}}$ 表达式中：\n$$k_{\\mathrm{corr}} = 650 \\frac{\\text{N}}{\\text{m}} \\times \\left( 1 + \\frac{2.324 \\times 10^{-26} \\text{ kg}}{1.994 \\times 10^{-26} \\text{ kg}} \\right)$$\n$10^{-26}$ 因子被消去：\n$$k_{\\mathrm{corr}} = 650 \\times \\left( 1 + \\frac{2.324}{1.994} \\right)$$\n$$k_{\\mathrm{corr}} = 650 \\times (1 + 1.165496489...)$$\n$$k_{\\mathrm{corr}} = 650 \\times (2.165496489...)$$\n$$k_{\\mathrm{corr}} \\approx 1407.572718... \\text{ N/m}$$\n将结果四舍五入到四位有效数字，我们得到：\n$$k_{\\mathrm{corr}} = 1408 \\text{ N/m}$$",
            "answer": "$$\\boxed{1408}$$"
        },
        {
            "introduction": "在构建了QM/MM模型并应用了必要的校正之后，我们如何确定其可靠性？最后一个练习将向您介绍计算科学中的关键步骤：验证。您将学习如何建立一个正式的验证协议，将连接原子QM/MM计算的结果与更高精度的全QM计算基准进行比较。通过实施这个协议 ，您将使用标准的误差度量（能量和力）来量化模型的准确性，并根据明确的容忍度标准做出“接受”或“拒绝”的判断。这有助于培养严谨的科学态度和对计算结果质量的控制能力。",
            "id": "3731100",
            "problem": "您的任务是通过将计算量与一组边界切割的参考全量子力学（full-QM）值进行比较，为采用连接原子的加性量子力学/分子力学（QM/MM）方案构建一个验证协议。其目标是使用基于第一性原理的能量和力偏差，为每次切割形式化接受标准。您将实现一个程序，该程序根据定义的容差评估每次切割是否通过验证。\n\n基本原理和定义：\n- 来自量子力学（QM）的势能是一个标量可观测量，记为 $E$。原子上的力由势能相对于原子核坐标的负梯度给出，即 $\\mathbf{F}_i = -\\nabla_{\\mathbf{R}_i} E$，其中 $\\mathbf{R}_i \\in \\mathbb{R}^3$ 是原子 $i$ 的位置向量，$\\mathbf{F}_i \\in \\mathbb{R}^3$。\n- 在带有连接原子的加性量子力学/分子力学（QM/MM）方案下，您可以在固定几何构型下近似计算系统的总能量和力。为了验证，您需要将这些值与在相同几何构型和基组下进行的全量子力学（full-QM）计算进行比较。\n- 对于给定的切割 $k$，验证必须计算两个误差度量：\n  1. 能量偏差：$\\Delta E_k = \\left| E_k^{\\mathrm{QMMM}} - E_k^{\\mathrm{QM}} \\right|$。\n  2. 均方根力偏差：\n  $$\\mathrm{RMSF}_k = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left\\| \\mathbf{F}_{k,i}^{\\mathrm{QMMM}} - \\mathbf{F}_{k,i}^{\\mathrm{QM}} \\right\\|_2^2},$$\n  其中 $N$ 是比较力的原子数，$\\|\\cdot\\|_2$ 表示欧几里得范数。\n- 每次切割 $k$ 的接受标准：当且仅当 $\\Delta E_k \\le \\tau_E$ 和 $\\mathrm{RMSF}_k \\le \\tau_F$ 时，切割被接受，容差如下：\n  - 能量容差 $\\tau_E = 0.001$ 哈特里（Ha）。\n  - 力容差 $\\tau_F = 0.005$ 哈特里/玻尔（Ha/Bohr）。\n- 单位：所有能量必须以哈特里（Ha）为单位，所有力必须以哈特里/玻尔（Ha/Bohr）为单位。您的程序输出是无量纲的布尔值，因此没有单位，但数值输入和阈值遵循所提供的单位规范。\n\n测试套件：\n您将获得一组 $4$ 次切割（边界位置），以及在固定原子几何构型下（$N=3$ 个原子）相应的 full-QM 和连接原子 QM/MM 结果。对于所有切割 $k \\in \\{1,2,3,4\\}$，每个原子的 full-QM 力是相同且等于零的（几何构型处于或接近驻点）：\n\n- 所有切割的通用 full-QM 力：\n  - $\\mathbf{F}_{k,1}^{\\mathrm{QM}} = (0.0, 0.0, 0.0)$，\n  - $\\mathbf{F}_{k,2}^{\\mathrm{QM}} = (0.0, 0.0, 0.0)$，\n  - $\\mathbf{F}_{k,3}^{\\mathrm{QM}} = (0.0, 0.0, 0.0)$。\n\n对于每次切割 $k$，您将获得：\n- 以哈特里（Ha）为单位的 full-QM 能量 $E_k^{\\mathrm{QM}}$。\n- 以哈特里（Ha）为单位的连接原子 QM/MM 能量 $E_k^{\\mathrm{QMMM}}$。\n- 以哈特里/玻尔（Ha/Bohr）为单位的相同 $N=3$ 个原子上的连接原子 QM/MM 力。\n\n这些切割是：\n\n- 切割 1：\n  - $E_1^{\\mathrm{QM}} = -76.4200$, $E_1^{\\mathrm{QMMM}} = -76.4196$。\n  - $\\mathbf{F}_{1,1}^{\\mathrm{QMMM}} = (0.003, 0.000, 0.000)$，\n    $\\mathbf{F}_{1,2}^{\\mathrm{QMMM}} = (-0.003, 0.000, 0.000)$，\n    $\\mathbf{F}_{1,3}^{\\mathrm{QMMM}} = (0.000, 0.003, 0.000)$。\n\n- 切割 2：\n  - $E_2^{\\mathrm{QM}} = -76.4200$, $E_2^{\\mathrm{QMMM}} = -76.4190$。\n  - $\\mathbf{F}_{2,1}^{\\mathrm{QMMM}} = (0.005, 0.000, 0.000)$，\n    $\\mathbf{F}_{2,2}^{\\mathrm{QMMM}} = (0.000, 0.005, 0.000)$，\n    $\\mathbf{F}_{2,3}^{\\mathrm{QMMM}} = (0.000, 0.000, -0.005)$。\n\n- 切割 3：\n  - $E_3^{\\mathrm{QM}} = -76.4200$, $E_3^{\\mathrm{QMMM}} = -76.4188$。\n  - $\\mathbf{F}_{3,1}^{\\mathrm{QMMM}} = (0.003, 0.000, 0.000)$，\n    $\\mathbf{F}_{3,2}^{\\mathrm{QMMM}} = (0.000, -0.003, 0.000)$，\n    $\\mathbf{F}_{3,3}^{\\mathrm{QMMM}} = (0.000, 0.000, 0.003)$。\n\n- 切割 4：\n  - $E_4^{\\mathrm{QM}} = -76.4200$, $E_4^{\\mathrm{QMMM}} = -76.4198$。\n  - $\\mathbf{F}_{4,1}^{\\mathrm{QMMM}} = (0.006, 0.000, 0.000)$，\n    $\\mathbf{F}_{4,2}^{\\mathrm{QMMM}} = (0.000, -0.006, 0.000)$，\n    $\\mathbf{F}_{4,3}^{\\mathrm{QMMM}} = (0.000, 0.000, 0.006)$。\n\n您的任务：\n- 实现一个程序，对于每次切割 $k$，使用上述定义计算 $\\Delta E_k$ 和 $\\mathrm{RMSF}_k$，用给定的容差检查接受标准，并为每次切割返回一个指示是否接受的布尔值。\n- 最终输出格式：您的程序应生成一行输出，其中包含切割 1 到 4 的接受结果，形式为方括号内以逗号分隔的列表，例如 $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}]$。布尔值必须是编程语言的原生布尔格式，并按指定顺序排列。\n\n关于数值鲁棒性的说明：\n- 在将浮点量与容差进行比较时，评估 $\\Delta E_k \\le \\tau_E$ 和 $\\mathrm{RMSF}_k \\le \\tau_F$ 是否成立。为减轻接近相等时的浮点舍入误差，您可以将比较视为 $\\Delta E_k \\le \\tau_E + \\epsilon$ 和 $\\mathrm{RMSF}_k \\le \\tau_F + \\epsilon$，其中 $\\epsilon > 0$ 是一个小数，例如 $\\epsilon = 10^{-12}$（无量纲）。",
            "solution": "用户提供了一个问题陈述，在尝试解决方案之前需要对其进行验证。\n\n### 步骤1：提取给定信息\n\n问题陈述中提供了以下数据和定义：\n\n*   **可观测量与定义**：\n    *   量子力学（QM）的势能用 $E$ 表示。\n    *   原子 $i$ 上的力由势能的负梯度给出：$\\mathbf{F}_i = -\\nabla_{\\mathbf{R}_i} E$，其中 $\\mathbf{R}_i \\in \\mathbb{R}^3$ 是原子 $i$ 的位置。\n    *   切割 $k$ 的能量偏差为 $\\Delta E_k = \\left| E_k^{\\mathrm{QMMM}} - E_k^{\\mathrm{QM}} \\right|$。\n    *   切割 $k$ 的均方根力偏差为 $\\mathrm{RMSF}_k = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left\\| \\mathbf{F}_{k,i}^{\\mathrm{QMMM}} - \\mathbf{F}_{k,i}^{\\mathrm{QM}} \\right\\|_2^2}$。\n    *   用于力比较的原子数为 $N = 3$。\n\n*   **接受标准**：\n    *   当且仅当 $\\Delta E_k \\le \\tau_E$ 和 $\\mathrm{RMSF}_k \\le \\tau_F$ 时，切割 $k$ 被接受。\n    *   能量容差：$\\tau_E = 0.001$ 哈特里（Ha）。\n    *   力容差：$\\tau_F = 0.005$ 哈特里/玻尔（Ha/Bohr）。\n\n*   **测试套件数据（$N=3$ 个原子）**：\n    *   对于所有切割 $k \\in \\{1,2,3,4\\}$，通用的全量子力学力为：$\\mathbf{F}_{k,1}^{\\mathrm{QM}} = (0.0, 0.0, 0.0)$，$\\mathbf{F}_{k,2}^{\\mathrm{QM}} = (0.0, 0.0, 0.0)$，$\\mathbf{F}_{k,3}^{\\mathrm{QM}} = (0.0, 0.0, 0.0)$。\n    *   **切割 1**：\n        *   $E_1^{\\mathrm{QM}} = -76.4200$ Ha, $E_1^{\\mathrm{QMMM}} = -76.4196$ Ha。\n        *   $\\mathbf{F}_{1,1}^{\\mathrm{QMMM}} = (0.003, 0.000, 0.000)$ Ha/Bohr, $\\mathbf{F}_{1,2}^{\\mathrm{QMMM}} = (-0.003, 0.000, 0.000)$ Ha/Bohr, $\\mathbf{F}_{1,3}^{\\mathrm{QMMM}} = (0.000, 0.003, 0.000)$ Ha/Bohr。\n    *   **切割 2**：\n        *   $E_2^{\\mathrm{QM}} = -76.4200$ Ha, $E_2^{\\mathrm{QMMM}} = -76.4190$ Ha。\n        *   $\\mathbf{F}_{2,1}^{\\mathrm{QMMM}} = (0.005, 0.000, 0.000)$ Ha/Bohr, $\\mathbf{F}_{2,2}^{\\mathrm{QMMM}} = (0.000, 0.005, 0.000)$ Ha/Bohr, $\\mathbf{F}_{2,3}^{\\mathrm{QMMM}} = (0.000, 0.000, -0.005)$ Ha/Bohr。\n    *   **切割 3**：\n        *   $E_3^{\\mathrm{QM}} = -76.4200$ Ha, $E_3^{\\mathrm{QMMM}} = -76.4188$ Ha。\n        *   $\\mathbf{F}_{3,1}^{\\mathrm{QMMM}} = (0.003, 0.000, 0.000)$ Ha/Bohr, $\\mathbf{F}_{3,2}^{\\mathrm{QMMM}} = (0.000, -0.003, 0.000)$ Ha/Bohr, $\\mathbf{F}_{3,3}^{\\mathrm{QMMM}} = (0.000, 0.000, 0.003)$ Ha/Bohr。\n    *   **切割 4**：\n        *   $E_4^{\\mathrm{QM}} = -76.4200$ Ha, $E_4^{\\mathrm{QMMM}} = -76.4198$ Ha。\n        *   $\\mathbf{F}_{4,1}^{\\mathrm{QMMM}} = (0.006, 0.000, 0.000)$ Ha/Bohr, $\\mathbf{F}_{4,2}^{\\mathrm{QMMM}} = (0.000, -0.006, 0.000)$ Ha/Bohr, $\\mathbf{F}_{4,3}^{\\mathrm{QMMM}} = (0.000, 0.000, 0.006)$ Ha/Bohr。\n\n*   **数值鲁棒性**：比较应被视为小于或等于容差加上一个小的 epsilon，例如 $\\epsilon = 10^{-12}$。\n\n### 步骤2：使用提取的给定信息进行验证\n\n对问题进行严格验证。\n1.  **科学基础**：该问题设定在计算化学的既定框架内，特别是多尺度 QM/MM 建模。势能、力、连接原子以及对更高层次理论（full-QM）的验证等概念都是标准实践。使用原子单位（哈特里表示能量，哈特里/玻尔表示力）是恰当的。该问题在科学上是合理的。\n2.  **定义明确**：该问题定义明确。它提供了所有必要的数据、一组清晰的待执行计算以及明确的接受标准。存在唯一解且可直接计算。\n3.  **客观性**：该问题使用精确的数学语言陈述。它没有主观性和歧义。\n4.  **缺陷分析**：\n    *   不存在科学或事实上的不合理之处。\n    *   问题可直接形式化，并与其所述主题高度相关。\n    *   设置完整且自洽。\n    *   对于一个处于驻点的小分子系统，物理条件和数值是合理的。\n    *   结构清晰，问题不是病态的。\n    *   任务是定义原则的直接应用，这是科学问题解决的一种有效形式，不是琐碎或伪深刻的练习。\n    *   结果完全可以通过计算来验证。\n\n### 步骤3：结论与行动\n\n该问题有效。将提供一个解决方案。\n\n### 解决方案\n\n目标是通过比较四个不同 QM/MM 边界切割的计算能量和力与参考全量子力学计算结果，来实施一个验证协议。当且仅当一个切割的能量偏差和均方根力偏差都落在指定容差范围内时，该切割才被视为“接受”。\n\n接受标准由每个切割 $k$ 的两个度量定义：\n1.  绝对能量偏差：$\\Delta E_k = \\left| E_k^{\\mathrm{QMMM}} - E_k^{\\mathrm{QM}} \\right|$。这必须满足 $\\Delta E_k \\le \\tau_E$，其中容差 $\\tau_E = 0.001$ Ha。\n2.  均方根力偏差：\n    $$ \\mathrm{RMSF}_k = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left\\| \\mathbf{F}_{k,i}^{\\mathrm{QMMM}} - \\mathbf{F}_{k,i}^{\\mathrm{QM}} \\right\\|_2^2} $$\n    这必须满足 $\\mathrm{RMSF}_k \\le \\tau_F$，其中容差 $\\tau_F = 0.005$ Ha/Bohr。\n\n分析针对每个切割的 $N=3$ 个原子进行。参考的全量子力学力给定为对所有原子和所有切割 $\\mathbf{F}_{k,i}^{\\mathrm{QM}} = \\mathbf{0}$。这简化了 RMSF 的计算，因为力差 $\\mathbf{F}_{k,i}^{\\mathrm{QMMM}} - \\mathbf{F}_{k,i}^{\\mathrm{QM}}$ 变为简单的 $\\mathbf{F}_{k,i}^{\\mathrm{QMMM}}$。\n\n我们现在根据标准评估四个切割中的每一个。\n\n**切割 1：**\n*   能量数据：$E_1^{\\mathrm{QM}} = -76.4200$ Ha, $E_1^{\\mathrm{QMMM}} = -76.4196$ Ha。\n    *   $\\Delta E_1 = | -76.4196 - (-76.4200) | = 0.0004$ Ha。\n    *   比较：$0.0004 \\le 0.001$。能量标准得到满足。\n*   力数据（$k=1$）：$\\mathbf{F}_{1,1}^{\\mathrm{QMMM}} = (0.003, 0, 0)$, $\\mathbf{F}_{1,2}^{\\mathrm{QMMM}} = (-0.003, 0, 0)$, $\\mathbf{F}_{1,3}^{\\mathrm{QMMM}} = (0, 0.003, 0)$。所有单位均为 Ha/Bohr。\n    *   力向量的平方范数：\n        *   $\\|\\mathbf{F}_{1,1}^{\\mathrm{QMMM}}\\|_2^2 = (0.003)^2 + 0^2 + 0^2 = 0.000009$。\n        *   $\\|\\mathbf{F}_{1,2}^{\\mathrm{QMMM}}\\|_2^2 = (-0.003)^2 + 0^2 + 0^2 = 0.000009$。\n        *   $\\|\\mathbf{F}_{1,3}^{\\mathrm{QMMM}}\\|_2^2 = 0^2 + (0.003)^2 + 0^2 = 0.000009$。\n    *   $\\mathrm{RMSF}_1 = \\sqrt{\\frac{1}{3} (0.000009 + 0.000009 + 0.000009)} = \\sqrt{\\frac{0.000027}{3}} = \\sqrt{0.000009} = 0.003$ Ha/Bohr。\n    *   比较：$0.003 \\le 0.005$。力标准得到满足。\n*   **切割 1 的结论**：两个标准都得到满足。该切割被**接受**。\n\n**切割 2：**\n*   能量数据：$E_2^{\\mathrm{QM}} = -76.4200$ Ha, $E_2^{\\mathrm{QMMM}} = -76.4190$ Ha。\n    *   $\\Delta E_2 = | -76.4190 - (-76.4200) | = 0.0010$ Ha。\n    *   比较：$0.0010 \\le 0.001$。能量标准得到满足（等于容差）。\n*   力数据（$k=2$）：$\\mathbf{F}_{2,1}^{\\mathrm{QMMM}} = (0.005, 0, 0)$, $\\mathbf{F}_{2,2}^{\\mathrm{QMMM}} = (0, 0.005, 0)$, $\\mathbf{F}_{2,3}^{\\mathrm{QMMM}} = (0, 0, -0.005)$。\n    *   力向量的平方范数：\n        *   $\\|\\mathbf{F}_{2,1}^{\\mathrm{QMMM}}\\|_2^2 = (0.005)^2 = 0.000025$。\n        *   $\\|\\mathbf{F}_{2,2}^{\\mathrm{QMMM}}\\|_2^2 = (0.005)^2 = 0.000025$。\n        *   $\\|\\mathbf{F}_{2,3}^{\\mathrm{QMMM}}\\|_2^2 = (-0.005)^2 = 0.000025$。\n    *   $\\mathrm{RMSF}_2 = \\sqrt{\\frac{1}{3} (0.000025 + 0.000025 + 0.000025)} = \\sqrt{\\frac{0.000075}{3}} = \\sqrt{0.000025} = 0.005$ Ha/Bohr。\n    *   比较：$0.005 \\le 0.005$。力标准得到满足（等于容差）。\n*   **切割 2 的结论**：两个标准都得到满足。该切割被**接受**。\n\n**切割 3：**\n*   能量数据：$E_3^{\\mathrm{QM}} = -76.4200$ Ha, $E_3^{\\mathrm{QMMM}} = -76.4188$ Ha。\n    *   $\\Delta E_3 = | -76.4188 - (-76.4200) | = 0.0012$ Ha。\n    *   比较：$0.0012 > 0.001$。能量标准**未**得到满足。\n*   **切割 3 的结论**：由于一个标准未通过，整个切割被**拒绝**。无需评估力标准。\n\n**切割 4：**\n*   能量数据：$E_4^{\\mathrm{QM}} = -76.4200$ Ha, $E_4^{\\mathrm{QMMM}} = -76.4198$ Ha。\n    *   $\\Delta E_4 = | -76.4198 - (-76.4200) | = 0.0002$ Ha。\n    *   比较：$0.0002 \\le 0.001$。能量标准得到满足。\n*   力数据（$k=4$）：$\\mathbf{F}_{4,1}^{\\mathrm{QMMM}} = (0.006, 0, 0)$, $\\mathbf{F}_{4,2}^{\\mathrm{QMMM}} = (0, -0.006, 0)$, $\\mathbf{F}_{4,3}^{\\mathrm{QMMM}} = (0, 0, 0.006)$。\n    *   力向量的平方范数：\n        *   $\\|\\mathbf{F}_{4,1}^{\\mathrm{QMMM}}\\|_2^2 = (0.006)^2 = 0.000036$。\n        *   $\\|\\mathbf{F}_{4,2}^{\\mathrm{QMMM}}\\|_2^2 = (-0.006)^2 = 0.000036$。\n        *   $\\|\\mathbf{F}_{4,3}^{\\mathrm{QMMM}}\\|_2^2 = (0.006)^2 = 0.000036$。\n    *   $\\mathrm{RMSF}_4 = \\sqrt{\\frac{1}{3} (3 \\times 0.000036)} = \\sqrt{0.000036} = 0.006$ Ha/Bohr。\n    *   比较：$0.006 > 0.005$。力标准**未**得到满足。\n*   **切割 4 的结论**：由于力标准未通过，整个切割被**拒绝**。\n\n最终结果摘要：\n*   切割 1：接受 (True)\n*   切割 2：接受 (True)\n*   切割 3：拒绝 (False)\n*   切割 4：拒绝 (False)\n程序将形式化这些计算并生成最终的布尔值列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not needed for this problem.\n\ndef solve():\n    \"\"\"\n    Validates a set of QM/MM cuts against full-QM reference data based on\n    energy and force deviation criteria.\n    \"\"\"\n    # Define the acceptance criteria tolerances.\n    # Energy tolerance tau_E in Hartree (Ha).\n    tau_E = 0.001\n    # Force tolerance tau_F in Hartree per Bohr (Ha/Bohr).\n    tau_F = 0.005\n    \n    # Number of atoms for force comparison.\n    N_atoms = 3\n    \n    # Epsilon for robust floating-point comparisons, as suggested.\n    epsilon = 1e-12\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E_QM, E_QMMM, list_of_F_QMMM_vectors).\n    # Since F_QM is zero for all atoms in all cuts, it is not stored here\n    # but is accounted for in the calculation.\n    test_cases = [\n        # Cut 1\n        (-76.4200, -76.4196, [\n            np.array([0.003, 0.000, 0.000]),\n            np.array([-0.003, 0.000, 0.000]),\n            np.array([0.000, 0.003, 0.000])\n        ]),\n        # Cut 2\n        (-76.4200, -76.4190, [\n            np.array([0.005, 0.000, 0.000]),\n            np.array([0.000, 0.005, 0.000]),\n            np.array([0.000, 0.000, -0.005])\n        ]),\n        # Cut 3\n        (-76.4200, -76.4188, [\n            np.array([0.003, 0.000, 0.000]),\n            np.array([0.000, -0.003, 0.000]),\n            np.array([0.000, 0.000, 0.003])\n        ]),\n        # Cut 4\n        (-76.4200, -76.4198, [\n            np.array([0.006, 0.000, 0.000]),\n            np.array([0.000, -0.006, 0.000]),\n            np.array([0.000, 0.000, 0.006])\n        ])\n    ]\n\n    results = []\n    # Full-QM reference forces are zero vectors.\n    F_QM_ref = np.array([0.0, 0.0, 0.0])\n\n    for case in test_cases:\n        E_QM, E_QMMM, Fs_QMMM = case\n\n        # 1. Calculate energy deviation (Delta E)\n        delta_E = abs(E_QMMM - E_QM)\n\n        # 2. Calculate Root-Mean-Square Force deviation (RMSF)\n        # The sum of squared norms of force differences.\n        sum_sq_force_diff = 0.0\n        for F_QMMM_i in Fs_QMMM:\n            # Force difference is F_QMMM - F_QM. Since F_QM is zero, this is just F_QMMM.\n            force_diff = F_QMMM_i - F_QM_ref\n            # Add the squared Euclidean norm to the sum.\n            sum_sq_force_diff += np.linalg.norm(force_diff)**2\n        \n        rmsf = np.sqrt(sum_sq_force_diff / N_atoms)\n\n        # 3. Apply acceptance criteria\n        # Check if Delta E is within tolerance.\n        energy_accepted = delta_E = tau_E + epsilon\n        # Check if RMSF is within tolerance.\n        force_accepted = rmsf = tau_F + epsilon\n\n        # A cut is accepted if and only if both criteria are met.\n        cut_accepted = energy_accepted and force_accepted\n        results.append(cut_accepted)\n\n    # Final print statement in the exact required format: [True,False,True,True]\n    # The map(str, ...) converts Python booleans (True, False) to their string\n    # representations (\"True\", \"False\").\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}