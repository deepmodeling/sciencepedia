{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any energy-blending scheme like the Bridging Domain Method (BDM) is the partition of unity, where the weights of the different models must sum to one. This exercise  demonstrates why this is a critical requirement by asking you to quantify the energy error that arises when this rule is broken. By calculating the spurious energy generated from an improper normalization, you will gain a first-hand appreciation for how the partition of unity ensures the physical consistency of the coupled system.",
            "id": "3844843",
            "problem": "A uniform, prismatic, linear elastic bar of length $L$, cross-sectional area $A$, and Young’s modulus $E$ is subjected to a constant axial end load $F$ resulting in a uniform small strain along its length. In a multiscale coupling using the Bridging Domain Method (BDM), an atomistic description (A) and a continuum description (C) overlap over a subinterval (the bridging domain) of length $\\ell$, with $\\ell \\leq L$. In the bridging domain, the coupled energy is formed by blending the atomistic and continuum energies using spatially varying weights $w_{A}(x)$ and $w_{C}(x)$. In a consistent BDM formulation, the weights should satisfy $w_{A}(x)+w_{C}(x)=1$ for all $x$ in the overlap in order to avoid bias. Consider, instead, an improperly normalized pair satisfying $w_{A}(x)+w_{C}(x)=1+\\delta(x)$, where $\\delta(x)$ is a prescribed function on the overlap, and assume that the atomistic and continuum descriptions produce identical energy densities for this problem.\n\nStarting only from small-strain linear elasticity and the definition of strain energy density, derive an expression for the total energy error $\\Delta U$ caused by the improper normalization, defined as the difference between the BDM-blended total strain energy and the true single-model strain energy. Express your result in terms of $F$, $E$, $A$, and $\\delta(x)$, and specialize it to the case of a constant mis-normalization $\\delta(x)\\equiv \\delta$ over the overlap of length $\\ell$.\n\nThen, evaluate the specialized expression for the following data: $E=200\\times 10^{9}$ Pa, $A=1.0\\times 10^{-4}$ m$^{2}$, $\\ell=0.10$ m, $F=1.0\\times 10^{4}$ N, and $\\delta=0.050$. Round your final numerical answer to four significant figures. Express the final energy error in Joules.",
            "solution": "The problem requires the derivation of the total energy error introduced in a Bridging Domain Method (BDM) formulation due to an improper normalization of the blending weights. The physical system is a uniform linear elastic bar under constant axial tension. To solve this, we first establish the benchmark, which is the true strain energy of the bar. Then, we formulate the energy within the BDM-blended model and find the difference.\n\nFirst, let us define the state of the bar under the given load. The bar has a Young's modulus $E$, a cross-sectional area $A$, and is subjected to a constant axial force $F$. According to linear elasticity, the axial stress $\\sigma$ is uniform and given by:\n$$ \\sigma = \\frac{F}{A} $$\nThe axial strain $\\epsilon$ is also uniform and is related to the stress by Hooke's law:\n$$ \\epsilon = \\frac{\\sigma}{E} = \\frac{F}{EA} $$\nThe strain energy density $u$, which is the strain energy per unit volume, for a linear elastic material is:\n$$ u = \\frac{1}{2} \\sigma \\epsilon $$\nSubstituting the expressions for $\\sigma$ and $\\epsilon$, we obtain the strain energy density in terms of the given parameters:\n$$ u = \\frac{1}{2} \\left(\\frac{F}{A}\\right) \\left(\\frac{F}{EA}\\right) = \\frac{F^2}{2EA^2} $$\nSince the bar is uniform and the loading is constant, this energy density $u$ is constant throughout the entire volume of the bar. The total true strain energy $U_{true}$ is the integral of this density over the total volume $V = A L$.\n$$ U_{true} = \\int_V u \\, dV = u \\cdot V = \\left(\\frac{F^2}{2EA^2}\\right) (A L) = \\frac{F^2 L}{2EA} $$\nThis expression represents the correct, single-model strain energy of the system.\n\nNext, we formulate the total energy within the BDM framework with the specified improper normalization. The bar is divided into regions. A portion of the bar, of length $\\ell$, is the bridging domain where atomistic (A) and continuum (C) models are blended. The remainder of the bar, of length $L-\\ell$, is modeled using a single description (e.g., continuum).\n\nThe problem states that the atomistic and continuum descriptions produce identical energy densities for this problem. This means $u_A(x) = u_C(x) = u$, where $u$ is the constant energy density derived previously.\n\nOutside the bridging domain (a region of total length $L-\\ell$), the energy density is simply $u$. The energy stored in this part of the bar, $U_{out}$, is:\n$$ U_{out} = u \\cdot A (L-\\ell) $$\nInside the bridging domain (length $\\ell$), the energy density is blended using the weights $w_A(x)$ and $w_C(x)$. The blended energy density, $u_{BDM}(x)$, is:\n$$ u_{BDM}(x) = w_A(x) u_A(x) + w_C(x) u_C(x) = (w_A(x) + w_C(x)) u $$\nWe are given that the weights are improperly normalized, such that $w_A(x) + w_C(x) = 1 + \\delta(x)$. Thus, the energy density in the bridging domain is:\n$$ u_{BDM}(x) = (1 + \\delta(x)) u $$\nThe total energy stored in the bridging domain, $U_{bridge}$, is the integral of this blended energy density over the volume of the bridging domain. Let the bridging domain extend from $x=x_0$ to $x=x_0+\\ell$.\n$$ U_{bridge} = \\int_{x_0}^{x_0+\\ell} u_{BDM}(x) A \\, dx = \\int_{x_0}^{x_0+\\ell} (1 + \\delta(x)) u A \\, dx $$\nSince $u$ and $A$ are constants, we can write:\n$$ U_{bridge} = u A \\int_{x_0}^{x_0+\\ell} (1 + \\delta(x)) \\, dx = u A \\left( \\ell + \\int_{x_0}^{x_0+\\ell} \\delta(x) \\, dx \\right) $$\nThe total energy in the BDM model, $U_{BDM}$, is the sum of the energies from the regions inside and outside the bridging domain:\n$$ U_{BDM} = U_{out} + U_{bridge} = u A (L-\\ell) + u A \\left( \\ell + \\int_{x_0}^{x_0+\\ell} \\delta(x) \\, dx \\right) $$\n$$ U_{BDM} = u A \\left( L - \\ell + \\ell + \\int_{overlap} \\delta(x) \\, dx \\right) = u A \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) $$\nSubstituting the expression for $u = \\frac{F^2}{2EA^2}$:\n$$ U_{BDM} = \\frac{F^2}{2EA^2} A \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) = \\frac{F^2}{2EA} \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) $$\n\nThe total energy error $\\Delta U$ is defined as the difference between the BDM-blended energy and the true energy:\n$$ \\Delta U = U_{BDM} - U_{true} = \\frac{F^2}{2EA} \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) - \\frac{F^2 L}{2EA} $$\n$$ \\Delta U = \\frac{F^2 L}{2EA} + \\frac{F^2}{2EA} \\int_{overlap} \\delta(x) \\, dx - \\frac{F^2 L}{2EA} $$\nThis simplifies to the general expression for the energy error:\n$$ \\Delta U = \\frac{F^2}{2EA} \\int_{overlap} \\delta(x) \\, dx $$\n\nNow, we specialize this result to the case where the mis-normalization is a constant, $\\delta(x) \\equiv \\delta$, over the entire overlap region of length $\\ell$. The integral becomes:\n$$ \\int_{overlap} \\delta(x) \\, dx = \\int_{x_0}^{x_0+\\ell} \\delta \\, dx = \\delta \\int_{x_0}^{x_0+\\ell} dx = \\delta \\ell $$\nSubstituting this into the general error expression gives the specialized expression for the error:\n$$ \\Delta U = \\frac{F^2 \\delta \\ell}{2EA} $$\n\nFinally, we evaluate this expression using the provided numerical data:\n$E = 200 \\times 10^{9}$ Pa\n$A = 1.0 \\times 10^{-4}$ m$^2$\n$\\ell = 0.10$ m\n$F = 1.0 \\times 10^{4}$ N\n$\\delta = 0.050$\n\nWe substitute these values into the specialized error formula:\n$$ \\Delta U = \\frac{(1.0 \\times 10^{4} \\, \\text{N})^2 (0.050) (0.10 \\, \\text{m})}{2 (200 \\times 10^{9} \\, \\text{Pa}) (1.0 \\times 10^{-4} \\, \\text{m}^2)} $$\n$$ \\Delta U = \\frac{(1.0 \\times 10^{8} \\, \\text{N}^2) (0.0050 \\, \\text{m})}{2 (2.0 \\times 10^{11} \\, \\text{N/m}^2) (1.0 \\times 10^{-4} \\, \\text{m}^2)} $$\n$$ \\Delta U = \\frac{5.0 \\times 10^{5} \\, \\text{N}^2 \\cdot \\text{m}}{4.0 \\times 10^{7} \\, \\text{N}} = 1.25 \\times 10^{-2} \\, \\text{N} \\cdot \\text{m} $$\nSince $1$ Joule ($J$) is equal to $1$ Newton-meter ($N \\cdot m$), the energy error is:\n$$ \\Delta U = 0.0125 \\, \\text{J} $$\nRounding to four significant figures as requested, the final answer is $0.01250$ J.",
            "answer": "$$\\boxed{0.01250}$$"
        },
        {
            "introduction": "Once the partition of unity is established, the quality of a BDM coupling depends heavily on the smoothness of the blending functions. Abrupt changes in the weights can introduce non-physical \"ghost\" forces and wave reflections at the interface. This exercise  challenges you to construct an optimally smooth weighting function by solving a variational problem, providing insight into how BDM formulations are designed to ensure a seamless transition between the atomistic and continuum scales.",
            "id": "3844850",
            "problem": "Consider a one-dimensional overlap region $x \\in [0,L]$ used in the Bridging Domain Method (BDM), where the atomistic and continuum submodels are blended by partition-of-unity weights $w_{\\mathrm{A}}(x)$ and $w_{\\mathrm{C}}(x)$ satisfying $w_{\\mathrm{A}}(x) + w_{\\mathrm{C}}(x) = 1$ for all $x \\in [0,L]$. In the overlap, the atomistic contribution is dominant near $x=0$ and the continuum contribution is dominant near $x=L$, so $w_{\\mathrm{A}}(x)$ should monotonically decrease from $x=0$ to $x=L$ while $w_{\\mathrm{C}}(x)$ increases. The blended small-strain elastic energy per unit reference length is\n$$\n\\mathcal{E}[u] = \\int_{0}^{L} \\left( w_{\\mathrm{A}}(x)\\,\\Psi_{\\mathrm{A}}(\\varepsilon(u)) + w_{\\mathrm{C}}(x)\\,\\Psi_{\\mathrm{C}}(\\varepsilon(u)) \\right)\\,\\mathrm{d}x,\n$$\nwhere $\\varepsilon(u) = u'(x)$ is the one-dimensional strain and $\\Psi_{\\mathrm{A}}$ and $\\Psi_{\\mathrm{C}}$ are the atomistic and continuum energy densities, respectively. Assume a patch-test setting in which the submodels are consistent under small strain, i.e., $\\Psi_{\\mathrm{A}}(\\varepsilon) = \\Psi_{\\mathrm{C}}(\\varepsilon)$ for any constant strain.\n\nYou are to construct a twice continuously differentiable ($C^2$) weight $w_{\\mathrm{A}}(x)$ on $[0,L]$ that transitions from the atomistic model to the continuum model and satisfies the endpoint conditions\n$$\nw_{\\mathrm{A}}(0) = 1,\\quad w_{\\mathrm{A}}(L) = 0,\\quad w'_{\\mathrm{A}}(0) = 0,\\quad w'_{\\mathrm{A}}(L) = 0,\\quad w''_{\\mathrm{A}}(0) = 0,\\quad w''_{\\mathrm{A}}(L) = 0.\n$$\nThese conditions aim to eliminate spurious interface terms and suppress high-frequency reflections when coupling discrete atomistics to a continuum. Among all possible $C^2$ ramps (including trigonometric choices such as a cosine ramp and polynomial ramps), justify a specific choice by invoking the following two criteria derived from first principles:\n- Patch-test invariance under any linear displacement field $u(x) = \\alpha x + \\beta$ when $\\Psi_{\\mathrm{A}}=\\Psi_{\\mathrm{C}}$.\n- Smoothness optimality formulated as the minimizer of the functional\n$$\nJ[w] = \\int_{0}^{L} \\left| w^{(3)}(x) \\right|^{2} \\,\\mathrm{d}x\n$$\nsubject to the above endpoint constraints, which penalizes rapid variations in curvature and thereby reduces high-frequency artifacts.\n\nConstruct the explicit closed-form expression of such a weight $w_{\\mathrm{A}}(x)$ in terms of $x$ and $L$, and present this expression as your final answer. No numerical rounding is required. Express your final answer as a single analytic expression.",
            "solution": "The task is to find a function $w_{\\mathrm{A}}(x)$ that satisfies the given boundary conditions and minimizes a smoothness functional. For simplicity in the derivation, we will denote $w_{\\mathrm{A}}(x)$ as $w(x)$.\n\nFirst, we analyze the patch-test invariance criterion. For a linear displacement field $u(x) = \\alpha x + \\beta$, the strain is constant: $\\varepsilon(x) = u'(x) = \\alpha$. The problem states that the atomistic and continuum models are consistent, meaning $\\Psi_{\\mathrm{A}}(\\alpha) = \\Psi_{\\mathrm{C}}(\\alpha)$. Let us denote this common energy density as $\\Psi(\\alpha)$. The blended energy functional becomes:\n$$\n\\mathcal{E}[u] = \\int_{0}^{L} \\left( w_{\\mathrm{A}}(x)\\,\\Psi(\\alpha) + w_{\\mathrm{C}}(x)\\,\\Psi(\\alpha) \\right)\\,\\mathrm{d}x\n$$\nUsing the partition-of-unity property $w_{\\mathrm{A}}(x) + w_{\\mathrm{C}}(x) = 1$, we get:\n$$\n\\mathcal{E}[u] = \\int_{0}^{L} \\left( w_{\\mathrm{A}}(x) + w_{\\mathrm{C}}(x) \\right)\\,\\Psi(\\alpha)\\,\\mathrm{d}x = \\int_{0}^{L} \\Psi(\\alpha)\\,\\mathrm{d}x = L\\,\\Psi(\\alpha)\n$$\nThis is the correct energy for a uniform bar of length $L$ under a constant strain $\\alpha$. This result holds for any functions $w_{\\mathrm{A}}(x)$ and $w_{\\mathrm{C}}(x)$ that form a partition of unity. Therefore, this criterion is fundamental to the BDM formulation and does not impose any additional constraints on the specific functional form of $w(x)$ beyond what is already stated. The core task is to solve the variational problem defined by the second criterion.\n\nThe second criterion requires us to find a function $w(x)$ that minimizes the functional:\n$$\nJ[w] = \\int_{0}^{L} \\left( w^{(3)}(x) \\right)^{2} \\,\\mathrm{d}x\n$$\nsubject to the six boundary conditions:\n$$\nw(0) = 1, \\quad w(L) = 0 \\\\\nw'(0) = 0, \\quad w'(L) = 0 \\\\\nw''(0) = 0, \\quad w''(L) = 0\n$$\nThis is a standard problem in the calculus of variations. The Lagrangian is $F(x, w, w', w'', w^{(3)}) = (w^{(3)})^2$. The Euler-Lagrange equation for a functional depending on derivatives up to order $n$ is given by $\\sum_{k=0}^{n} (-1)^k \\frac{\\mathrm{d}^k}{\\mathrm{d}x^k} \\left( \\frac{\\partial F}{\\partial w^{(k)}} \\right) = 0$. In our case, $n=3$ and $F$ only depends on $w^{(3)}$. The equation simplifies to:\n$$\n(-1)^3 \\frac{\\mathrm{d}^3}{\\mathrm{d}x^3} \\left( \\frac{\\partial F}{\\partial w^{(3)}} \\right) = 0\n$$\nCalculating the partial derivative:\n$$\n\\frac{\\partial F}{\\partial w^{(3)}} = 2w^{(3)}(x)\n$$\nSubstituting this into the Euler-Lagrange equation yields:\n$$\n-\\frac{\\mathrm{d}^3}{\\mathrm{d}x^3} \\left( 2w^{(3)}(x) \\right) = -2w^{(6)}(x) = 0 \\implies w^{(6)}(x) = 0\n$$\nThe general solution to this sixth-order ordinary differential equation is a polynomial of degree five:\n$$\nw(x) = c_5 x^5 + c_4 x^4 + c_3 x^3 + c_2 x^2 + c_1 x + c_0\n$$\nThe six coefficients $c_0, c_1, c_2, c_3, c_4, c_5$ are determined by the six boundary conditions. First, we compute the first and second derivatives of $w(x)$:\n$$\nw'(x) = 5c_5 x^4 + 4c_4 x^3 + 3c_3 x^2 + 2c_2 x + c_1\n$$\n$$\nw''(x) = 20c_5 x^3 + 12c_4 x^2 + 6c_3 x + 2c_2\n$$\nApplying the boundary conditions at $x=0$:\n- $w(0) = 1 \\implies c_0 = 1$\n- $w'(0) = 0 \\implies c_1 = 0$\n- $w''(0) = 0 \\implies 2c_2 = 0 \\implies c_2 = 0$\n\nThus, the polynomial is of the form $w(x) = c_5 x^5 + c_4 x^4 + c_3 x^3 + 1$.\nNow, applying the boundary conditions at $x=L$:\n- $w(L) = 0 \\implies c_5 L^5 + c_4 L^4 + c_3 L^3 + 1 = 0$\n- $w'(L) = 0 \\implies 5c_5 L^4 + 4c_4 L^3 + 3c_3 L^2 = 0$\n- $w''(L) = 0 \\implies 20c_5 L^3 + 12c_4 L^2 + 6c_3 L = 0$\n\nAssuming $L \\neq 0$, we can simplify this system of three linear equations for the coefficients $c_3, c_4, c_5$:\n1. $c_5 L^5 + c_4 L^4 + c_3 L^3 = -1$\n2. $5c_5 L^2 + 4c_4 L + 3c_3 = 0$\n3. $10c_5 L^2 + 6c_4 L + 3c_3 = 0$\n\nSubtracting equation (2) from equation (3):\n$$\n(10-5)c_5 L^2 + (6-4)c_4 L + (3-3)c_3 = 0\n$$\n$$\n5c_5 L^2 + 2c_4 L = 0 \\implies 2c_4 = -5c_5 L \\implies c_4 = -\\frac{5}{2}c_5 L\n$$\nSubstitute this expression for $c_4$ into equation (2):\n$$\n5c_5 L^2 + 4\\left(-\\frac{5}{2}c_5 L\\right)L + 3c_3 = 0\n$$\n$$\n5c_5 L^2 - 10c_5 L^2 + 3c_3 = 0 \\implies -5c_5 L^2 + 3c_3 = 0 \\implies c_3 = \\frac{5}{3}c_5 L^2\n$$\nFinally, substitute the expressions for $c_3$ and $c_4$ into equation (1):\n$$\nc_5 L^5 + \\left(-\\frac{5}{2}c_5 L\\right) L^4 + \\left(\\frac{5}{3}c_5 L^2\\right) L^3 = -1\n$$\n$$\nc_5 L^5 - \\frac{5}{2}c_5 L^5 + \\frac{5}{3}c_5 L^5 = -1\n$$\n$$\nc_5 L^5 \\left(1 - \\frac{5}{2} + \\frac{5}{3}\\right) = -1\n$$\n$$\nc_5 L^5 \\left(\\frac{6 - 15 + 10}{6}\\right) = -1\n$$\n$$\nc_5 L^5 \\left(\\frac{1}{6}\\right) = -1 \\implies c_5 = -\\frac{6}{L^5}\n$$\nNow back-substitute to find $c_4$ and $c_3$:\n$$\nc_4 = -\\frac{5}{2} \\left(-\\frac{6}{L^5}\\right) L = \\frac{15}{L^4}\n$$\n$$\nc_3 = \\frac{5}{3} \\left(-\\frac{6}{L^5}\\right) L^2 = -\\frac{10}{L^3}\n$$\nThe determined coefficients are $c_0=1$, $c_1=0$, $c_2=0$, $c_3=-10/L^3$, $c_4=15/L^4$, and $c_5=-6/L^5$.\nSubstituting these into the polynomial form for $w(x)$ gives the solution for $w_{\\mathrm{A}}(x)$:\n$$\nw_{\\mathrm{A}}(x) = 1 - \\frac{10}{L^3}x^3 + \\frac{15}{L^4}x^4 - \\frac{6}{L^5}x^5\n$$\nThis can be written more compactly using the normalized coordinate $\\xi = x/L$:\n$$\nw_{\\mathrm{A}}(x) = 1 - 10\\left(\\frac{x}{L}\\right)^3 + 15\\left(\\frac{x}{L}\\right)^4 - 6\\left(\\frac{x}{L}\\right)^5\n$$\nAs a final check, we verify the monotonicity. The first derivative is:\n$$\nw'_{\\mathrm{A}}(x) = -\\frac{30}{L^3}x^2 + \\frac{60}{L^4}x^3 - \\frac{30}{L^5}x^4 = -\\frac{30x^2}{L^5}(L^2 - 2Lx + x^2) = -\\frac{30x^2(L-x)^2}{L^5}\n$$\nFor $x \\in (0,L)$ and $L>0$, we have $x^2 > 0$, $(L-x)^2 > 0$, and $L^5 > 0$. Thus, $w'_{\\mathrm{A}}(x) < 0$ for $x \\in (0,L)$. Since $w'_{\\mathrm{A}}(0)=0$ and $w'_{\\mathrm{A}}(L)=0$, the function $w_{\\mathrm{A}}(x)$ is monotonically decreasing on the interval $[0,L]$, satisfying the stated requirement.",
            "answer": "$$\n\\boxed{1 - \\frac{10x^3}{L^3} + \\frac{15x^4}{L^4} - \\frac{6x^5}{L^5}}\n$$"
        },
        {
            "introduction": "Theoretical understanding is best solidified through practical implementation. This comprehensive exercise  guides you through the process of building and verifying a one-dimensional BDM simulation from scratch. By implementing the energy formulation, solving the coupled system, and running a suite of tests including the crucial \"patch test,\" you will gain hands-on experience in the complete workflow of computational multiscale modeling, from theory to robust code.",
            "id": "3816106",
            "problem": "Consider a one-dimensional benchmark for the Bridging Domain Method (BDM). The BDM couples an atomistic model and a continuum model over an overlap (bridging) subdomain by blending their energies and enforcing consistency constraints. The objective is to implement a verification workflow including unit tests for weight properties, constraint enforcement, the patch test, and energy conservation, along with explicit acceptance criteria.\n\nThe physical setting is a bar occupying the interval $[0,L]$ with displacement field $u(x)$, where $x$ is the spatial coordinate and $L$ is the length. The atomistic model is defined on $[0,x_{\\mathrm{a,end}}]$ with nodes at positions $x^{\\mathrm{a}}_i$, and the continuum model is defined on $[x_{\\mathrm{c,start}},L]$ with nodes at positions $x^{\\mathrm{c}}_j$. The overlap (bridging) domain is $[x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}]$.\n\nFundamental base:\n- Linear elastic energy density for the continuum in one dimension is given by $\\psi_{\\mathrm{c}}(\\varepsilon)=\\frac{1}{2}EA\\,\\varepsilon^2$, where $E$ is Young’s modulus, $A$ is cross-sectional area, and $\\varepsilon=u'(x)$ is the strain. In discretized form with linear finite elements and uniform spacing $h_{\\mathrm{c}}$, the element energy reduces to $\\frac{1}{2}k_{\\mathrm{c}}(u_{j+1}-u_j)^2$, where $k_{\\mathrm{c}}=\\frac{EA}{h_{\\mathrm{c}}}$.\n- A nearest-neighbor atomistic chain with lattice spacing $h_{\\mathrm{a}}$ and harmonic interaction similarly yields bond energy $\\frac{1}{2}k_{\\mathrm{a}}(u_{i+1}-u_i)^2$, where $k_{\\mathrm{a}}=\\frac{EA}{h_{\\mathrm{a}}}$, ensuring consistent calibration with the continuum.\n- In the overlap domain, blending weights $w_{\\mathrm{a}}(x)\\in[0,1]$ and $w_{\\mathrm{c}}(x)=1-w_{\\mathrm{a}}(x)$ define the contribution of the atomistic and continuum energies. A smooth partition of unity is required so that $w_{\\mathrm{a}}(x)+w_{\\mathrm{c}}(x)=1$ for all $x$ in the overlap.\n- Consistency constraints are enforced weakly via a quadratic penalty with parameter $\\gamma>0$, penalizing the difference between the continuum displacement and the atomistic displacement interpolated to continuum nodes in the overlap.\n\nModel specification:\n- Let $L>0$, $x_{\\mathrm{c,start}}\\in(0,L)$, $x_{\\mathrm{a,end}}\\in(x_{\\mathrm{c,start}},L)$, $h_{\\mathrm{a}}>0$, $h_{\\mathrm{c}}>0$, and $\\varepsilon$ a prescribed uniform strain. Dirichlet boundary conditions are $u(0)=0$ and $u(L)=\\varepsilon L$.\n- Define atomistic nodes $x^{\\mathrm{a}}_i=i h_{\\mathrm{a}}$ for $i=0,1,\\dots,N_{\\mathrm{a}}-1$ such that $x^{\\mathrm{a}}_{N_{\\mathrm{a}}-1}=x_{\\mathrm{a,end}}$ (within rounding to the nearest multiple of $h_{\\mathrm{a}}$). Define continuum nodes $x^{\\mathrm{c}}_j=x_{\\mathrm{c,start}}+j h_{\\mathrm{c}}$ for $j=0,1,\\dots,N_{\\mathrm{c}}-1$ such that $x^{\\mathrm{c}}_{N_{\\mathrm{c}}-1}=L$ (within rounding to the nearest multiple of $h_{\\mathrm{c}}$).\n- The atomistic energy is $E_{\\mathrm{a}}=\\sum_{i=0}^{N_{\\mathrm{a}}-2}\\frac{1}{2}k_{\\mathrm{a}}\\,w_{\\mathrm{a}}(x^{\\mathrm{a}}_{i+\\frac{1}{2}})\\,(u^{\\mathrm{a}}_{i+1}-u^{\\mathrm{a}}_i)^2$ with $x^{\\mathrm{a}}_{i+\\frac{1}{2}}=\\frac{1}{2}(x^{\\mathrm{a}}_i+x^{\\mathrm{a}}_{i+1})$.\n- The continuum energy is $E_{\\mathrm{c}}=\\sum_{j=0}^{N_{\\mathrm{c}}-2}\\frac{1}{2}k_{\\mathrm{c}}\\,w_{\\mathrm{c}}(x^{\\mathrm{c}}_{j+\\frac{1}{2}})\\,(u^{\\mathrm{c}}_{j+1}-u^{\\mathrm{c}}_j)^2$ with $x^{\\mathrm{c}}_{j+\\frac{1}{2}}=\\frac{1}{2}(x^{\\mathrm{c}}_j+x^{\\mathrm{c}}_{j+1})$.\n- The penalty consistency term is $E_{\\mathrm{pen}}=\\sum_{x^{\\mathrm{c}}_j\\in[x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}]} \\frac{1}{2}\\gamma \\left(u^{\\mathrm{c}}_j - I_{\\mathrm{a}}[u^{\\mathrm{a}}](x^{\\mathrm{c}}_j)\\right)^2$, where $I_{\\mathrm{a}}[u^{\\mathrm{a}}]$ is the piecewise linear interpolation of $u^{\\mathrm{a}}$ to the continuum node positions in the overlap.\n- The total energy is $E_{\\mathrm{tot}}=E_{\\mathrm{a}}+E_{\\mathrm{c}}+E_{\\mathrm{pen}}$. Minimization of $E_{\\mathrm{tot}}$ under the Dirichlet boundary conditions yields the coupled equilibrium.\n\nWeight function specification:\n- Define the atomistic weight $w_{\\mathrm{a}}(x)$ as\n$$\nw_{\\mathrm{a}}(x)=\n\\begin{cases}\n1, & x\\le x_{\\mathrm{c,start}},\\\\\n\\frac{1}{2}\\left[1+\\cos\\left(\\pi\\,\\frac{x-x_{\\mathrm{c,start}}}{x_{\\mathrm{a,end}}-x_{\\mathrm{c,start}}}\\right)\\right], & x\\in(x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}),\\\\\n0, & x\\ge x_{\\mathrm{a,end}},\n\\end{cases}\n$$\nand $w_{\\mathrm{c}}(x)=1-w_{\\mathrm{a}}(x)$ in the overlap.\n\nVerification workflow and acceptance criteria:\n- Weights test: Verify $w_{\\mathrm{a}}(x)\\in[0,1]$ for all bond midpoints in the atomistic domain and $w_{\\mathrm{c}}(x)=1-w_{\\mathrm{a}}(x)$ for all bond midpoints in the overlap. Verify $w_{\\mathrm{a}}(x_{\\mathrm{c,start}})=1$ and $w_{\\mathrm{a}}(x_{\\mathrm{a,end}})=0$. Verify that $w_{\\mathrm{a}}(x)$ is nonincreasing on $[x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}]$. Acceptance requires all conditions to hold within a tolerance of $10^{-12}$.\n- Constraints test: Solve for the coupled equilibrium and evaluate $\\max_{x^{\\mathrm{c}}_j\\in[x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}]}\\left|u^{\\mathrm{c}}_j - I_{\\mathrm{a}}[u^{\\mathrm{a}}](x^{\\mathrm{c}}_j)\\right|$. Acceptance requires this maximum to be $\\le 10^{-6}$.\n- Patch test: The exact linear field is $u_{\\mathrm{lin}}(x)=\\varepsilon x$. After solving for the coupled equilibrium, evaluate the maximum nodal error over all atomistic and continuum nodes: $\\max\\left(\\max_i|u^{\\mathrm{a}}_i-u_{\\mathrm{lin}}(x^{\\mathrm{a}}_i)|,\\max_j|u^{\\mathrm{c}}_j-u_{\\mathrm{lin}}(x^{\\mathrm{c}}_j)|\\right)$. Acceptance requires this maximum to be $\\le 10^{-6}$.\n- Energy conservation test: Rigid-body translation invariance requires $E_{\\mathrm{tot}}(u+c)=E_{\\mathrm{tot}}(u)$ for any constant $c$. Using $c=0.123$, evaluate $\\left|E_{\\mathrm{tot}}(u_{\\mathrm{lin}}+c)-E_{\\mathrm{tot}}(u_{\\mathrm{lin}})\\right|$. Acceptance requires this absolute difference to be $\\le 10^{-10}$.\n\nAll quantities are dimensionless; no physical units are required.\n\nYour program must implement the assembly of the quadratic energy, enforce Dirichlet boundary conditions at $x=0$ and $x=L$ to $u(0)=0$ and $u(L)=\\varepsilon L$, solve for the equilibrium by minimizing $E_{\\mathrm{tot}}$, and run the four tests above.\n\nTest suite:\nProvide three parameter sets to exercise different regimes.\n- Case $1$ (happy path): $L=1.0$, $x_{\\mathrm{c,start}}=0.4$, $x_{\\mathrm{a,end}}=0.6$, $h_{\\mathrm{a}}=0.02$, $h_{\\mathrm{c}}=0.04$, $\\varepsilon=0.01$, $\\gamma=10^5$.\n- Case $2$ (minimal overlap): $L=1.0$, $x_{\\mathrm{c,start}}=0.5$, $x_{\\mathrm{a,end}}=0.54$, $h_{\\mathrm{a}}=0.02$, $h_{\\mathrm{c}}=0.04$, $\\varepsilon=0.02$, $\\gamma=10^6$.\n- Case $3$ (weak coupling edge): $L=1.0$, $x_{\\mathrm{c,start}}=0.4$, $x_{\\mathrm{a,end}}=0.6$, $h_{\\mathrm{a}}=0.02$, $h_{\\mathrm{c}}=0.04$, $\\varepsilon=0.01$, $\\gamma=1.0$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the four booleans in the order $[$weights\\_ok, constraints\\_ok, patch\\_ok, energy\\_ok$]$, concatenated across all cases into a single flat list. For example, the output format for three cases must be $[$b$_1$,b$_2$,b$_3$,b$_4$,b$_5$,b$_6$,b$_7$,b$_8$,b$_9$,b$_{10}$,$b_{11}$,$b_{12}]$ where $b_k\\in\\{$True, False$\\}$.",
            "solution": "The solution to this problem is an implementation of the verification workflow. The core of the one-dimensional Bridging Domain Method (BDM) is the minimization of a total energy functional, $E_{\\mathrm{tot}}$, which is the sum of the weighted atomistic energy $E_{\\mathrm{a}}$, weighted continuum energy $E_{\\mathrm{c}}$, and a penalty energy $E_{\\mathrm{pen}}$ enforcing consistency. Because all energy components are quadratic in the nodal displacements, the total energy is a quadratic function of the vector of all unknown displacements, $\\mathbf{u}$. Minimizing this energy is equivalent to solving a linear system of equations of the form $\\mathbf{K} \\mathbf{u} = \\mathbf{f}$, where $\\mathbf{K}$ is the global stiffness matrix (the Hessian of $E_{\\mathrm{tot}}$) and $\\mathbf{f}$ is the global force vector arising from the Dirichlet boundary conditions. The Python code below implements this procedure by assembling the system and solving for the displacements, then executes the four specified verification tests based on the problem's acceptance criteria.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_and_solve(L, xc_start, xa_end, ha, hc_target, eps, gamma):\n    \"\"\"\n    Builds and solves the BDM system for a given set of parameters.\n    \"\"\"\n    # 1. Setup Grids\n    # Atomistic grid\n    Na = int(round(xa_end / ha)) + 1\n    xa = np.linspace(0.0, (Na - 1) * ha, Na)\n    actual_xa_end = xa[-1]\n\n    # Continuum grid\n    num_intervals_c = int(round((L - xc_start) / hc_target))\n    Nc = num_intervals_c + 1\n    xc, hc_actual = np.linspace(xc_start, L, Nc, retstep=True)\n\n    # 2. Setup DoFs and BCs\n    n_dofs_a = Na - 1  # u_a[0] is fixed at 0\n    n_dofs_c = Nc - 1  # u_c[Nc-1] is fixed at eps*L\n    n_dofs = n_dofs_a + n_dofs_c\n\n    K = np.zeros((n_dofs, n_dofs))\n    f = np.zeros(n_dofs)\n\n    # Material constants (EA=1)\n    ka = 1.0 / ha\n    kc = 1.0 / hc_actual\n    \n    # Weight function\n    def w_a(x, xc_start_val, xa_end_val):\n        x = np.asarray(x)\n        w = np.zeros_like(x, dtype=float)\n        \n        # Atomistic region\n        w[x <= xc_start_val] = 1.0\n        # Blending region\n        mask = (x > xc_start_val) & (x < xa_end_val)\n        x_blend = x[mask]\n        w[mask] = 0.5 * (1.0 + np.cos(np.pi * (x_blend - xc_start_val) / (xa_end_val - xc_start_val)))\n        # Continuum region\n        w[x >= xa_end_val] = 0.0\n        return w\n\n    # 3. Assemble Stiffness Matrix K and Force Vector f\n    \n    # Atomistic contribution\n    for i in range(Na - 1): # loop over bonds\n        mid_point = (xa[i] + xa[i+1]) / 2.0\n        k_eff = ka * w_a(mid_point, xc_start, actual_xa_end)\n\n        dof1, dof2 = i - 1, i\n        \n        if i == 0: # u_a[0] is fixed\n            dof_u1 = 0\n            K[dof_u1, dof_u1] += k_eff\n        else:\n            indices = np.array([dof1, dof2])\n            K_loc = k_eff * np.array([[1, -1], [-1, 1]])\n            K[np.ix_(indices, indices)] += K_loc\n\n    # Continuum contribution\n    for j in range(Nc - 1): # loop over elements\n        mid_point = (xc[j] + xc[j+1]) / 2.0\n        w_c_val = 1.0 - w_a(mid_point, xc_start, actual_xa_end)\n        k_eff = kc * w_c_val\n        \n        dof1 = n_dofs_a + j\n        dof2 = n_dofs_a + j + 1\n        \n        if j == Nc - 2: # u_c[Nc-1] is fixed\n            dof_u_last_free = n_dofs_a + Nc - 2\n            u_L_val = eps * L\n            K[dof_u_last_free, dof_u_last_free] += k_eff\n            f[dof_u_last_free] += k_eff * u_L_val\n        else:\n            indices = np.array([dof1, dof2])\n            K_loc = k_eff * np.array([[1, -1], [-1, 1]])\n            K[np.ix_(indices, indices)] += K_loc\n\n    # Penalty contribution\n    for jc_idx, xc_node in enumerate(xc):\n        if xc_start <= xc_node <= actual_xa_end and jc_idx < Nc - 1: # Exclude last fixed node\n            dof_c = n_dofs_a + jc_idx\n            \n            # Find bracketing atomistic nodes\n            ia_idx = int(np.floor(xc_node / ha))\n            if ia_idx >= Na -1: # handle edge case if xc_node is exactly xa_end\n                ia_idx = Na - 2\n\n            alpha = (xc_node - xa[ia_idx]) / ha\n            \n            dofs = []\n            c_vec = []\n\n            # Contribution from u_a[ia_idx]\n            if ia_idx > 0:\n                dofs.append(ia_idx - 1)\n                c_vec.append(-(1 - alpha))\n            \n            # Contribution from u_a[ia_idx+1]\n            dofs.append(ia_idx)\n            c_vec.append(-alpha)\n            \n            # Contribution from u_c[jc_idx]\n            dofs.append(dof_c)\n            c_vec.append(1.0)\n            \n            c_vec = np.array(c_vec)\n            K_loc = gamma * np.outer(c_vec, c_vec)\n            K[np.ix_(dofs, dofs)] += K_loc\n\n    # 4. Solve system\n    u_sol = np.linalg.solve(K, f)\n\n    # 5. Reconstruct full displacement fields\n    u_a = np.zeros(Na)\n    u_a[1:] = u_sol[:n_dofs_a] # u_a[0] is 0\n    u_c = np.zeros(Nc)\n    u_c[:n_dofs_c] = u_sol[n_dofs_a:]\n    u_c[-1] = eps * L\n\n    return xa, u_a, xc, u_c, w_a, hc_actual, actual_xa_end\n\n\ndef run_tests(params):\n    L, xc_start, xa_end, ha, hc_target, eps, gamma = params\n    \n    xa, u_a, xc, u_c, w_a, hc_actual, actual_xa_end = build_and_solve(*params)\n    \n    Na = len(xa)\n    Nc = len(xc)\n    \n    # --- Test 1: Weights Test ---\n    weights_ok = True\n    tol_w = 1e-12\n    # Check values at bond midpoints\n    xa_mids = (xa[:-1] + xa[1:])/2.0\n    w_vals_a = w_a(xa_mids, xc_start, actual_xa_end)\n    if not (np.all(w_vals_a >= -tol_w) and np.all(w_vals_a <= 1.0 + tol_w)):\n        weights_ok = False\n        \n    xc_mids = (xc[:-1] + xc[1:])/2.0\n    w_vals_c = 1.0 - w_a(xc_mids, xc_start, actual_xa_end)\n    if not (np.all(w_vals_c >= -tol_w) and np.all(w_vals_c <= 1.0 + tol_w)):\n        weights_ok = False\n        \n    # Check endpoints\n    if not np.isclose(w_a(xc_start, xc_start, actual_xa_end), 1.0, atol=tol_w):\n        weights_ok = False\n    if not np.isclose(w_a(actual_xa_end, xc_start, actual_xa_end), 0.0, atol=tol_w):\n        weights_ok = False\n        \n    # Check non-increasing\n    test_points = np.linspace(xc_start, actual_xa_end, 1000)\n    w_test = w_a(test_points, xc_start, actual_xa_end)\n    if not np.all(np.diff(w_test) <= tol_w):\n        weights_ok = False\n\n    # --- Test 2: Constraints Test ---\n    max_diff = 0.0\n    for jc_idx, xc_node in enumerate(xc):\n        if xc_start <= xc_node <= actual_xa_end:\n            u_interp_a = np.interp(xc_node, xa, u_a)\n            diff = abs(u_c[jc_idx] - u_interp_a)\n            if diff > max_diff:\n                max_diff = diff\n    constraints_ok = (max_diff <= 1e-6)\n\n    # --- Test 3: Patch Test ---\n    u_lin_a = eps * xa\n    u_lin_c = eps * xc\n    err_a = np.max(np.abs(u_a - u_lin_a))\n    err_c = np.max(np.abs(u_c - u_lin_c))\n    patch_ok = (max(err_a, err_c) <= 1e-6)\n\n    # --- Test 4: Energy Conservation Test ---\n    def calculate_total_energy(disp_a, disp_c):\n        E_a = 0.0\n        ka = 1.0/ha\n        for i in range(Na - 1):\n            mid_p = (xa[i] + xa[i+1])/2.0\n            w_val = w_a(mid_p, xc_start, actual_xa_end)\n            E_a += 0.5 * ka * w_val * (disp_a[i+1] - disp_a[i])**2\n            \n        E_c = 0.0\n        kc = 1.0/hc_actual\n        for j in range(Nc - 1):\n            mid_p = (xc[j] + xc[j+1])/2.0\n            w_val = 1.0 - w_a(mid_p, xc_start, actual_xa_end)\n            E_c += 0.5 * kc * w_val * (disp_c[j+1] - disp_c[j])**2\n            \n        E_pen = 0.0\n        for jc_idx, xc_node in enumerate(xc):\n            if xc_start <= xc_node <= actual_xa_end:\n                u_interp_a = np.interp(xc_node, xa, disp_a)\n                E_pen += 0.5 * gamma * (disp_c[jc_idx] - u_interp_a)**2\n\n        return E_a + E_c + E_pen\n\n    c = 0.123\n    u_lin_a = eps * xa\n    u_lin_c = eps * xc\n    E_lin = calculate_total_energy(u_lin_a, u_lin_c)\n    E_lin_shifted = calculate_total_energy(u_lin_a + c, u_lin_c + c)\n    energy_ok = (abs(E_lin - E_lin_shifted) <= 1e-10)\n\n    return [weights_ok, constraints_ok, patch_ok, energy_ok]\n\ndef solve():\n    test_cases = [\n        # Case 1 (happy path)\n        (1.0, 0.4, 0.6, 0.02, 0.04, 0.01, 1e5),\n        # Case 2 (minimal overlap)\n        (1.0, 0.5, 0.54, 0.02, 0.04, 0.02, 1e6),\n        # Case 3 (weak coupling edge)\n        (1.0, 0.4, 0.6, 0.02, 0.04, 0.01, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = run_tests(case)\n        results.extend(case_results)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```",
            "answer": "[True,True,True,True,True,True,True,True,True,False,True,True]"
        }
    ]
}