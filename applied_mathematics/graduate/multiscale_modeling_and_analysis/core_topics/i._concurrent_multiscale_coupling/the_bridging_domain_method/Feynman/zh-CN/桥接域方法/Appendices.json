{
    "hands_on_practices": [
        {
            "introduction": "“单位分解”（Partition of unity）是桥接域方法（Bridging Domain Method）的基石，确保了能量在原子和连续介质模型之间无缝过渡。本练习旨在探讨当这一基本原则被违反时会发生什么。通过量化一个因权重函数不当归一化而产生的能量误差，您将具体理解为何 $w_{A}(x)+w_{C}(x)=1$ 这一条件对于确保能量守恒、防止模拟中出现人为的能量源或汇至关重要。",
            "id": "3844843",
            "problem": "一根长度为 $L$、横截面积为 $A$、杨氏模量为 $E$ 的均匀等截面线弹性杆，受到恒定的轴向端部载荷 $F$ 作用，导致其沿长度方向产生均匀的小应变。在使用桥接域方法 (BDM) 的多尺度耦合中，原子描述 (A) 和连续介质描述 (C) 在一个长度为 $\\ell$ 的子区间（桥接域）上重叠，其中 $\\ell \\leq L$。在桥接域中，耦合能量是通过使用空间变化的权重 $w_{A}(x)$ 和 $w_{C}(x)$ 混合原子能量和连续介质能量而形成的。在一个一致的 BDM 公式中，为避免偏差，权重应满足在重叠区域内的所有 $x$ 都有 $w_{A}(x)+w_{C}(x)=1$。现在考虑一对非恰当归一化的权重，满足 $w_{A}(x)+w_{C}(x)=1+\\delta(x)$，其中 $\\delta(x)$ 是重叠区域上的一个给定函数，并假设对于此问题，原子描述和连续介质描述产生相同的能量密度。\n\n仅从小应变线弹性理论和应变能密度的定义出发，推导由非恰当归一化引起的总能量误差 $\\Delta U$ 的表达式，该误差定义为 BDM 混合总应变能与真实单一模型应变能之差。用 $F$、$E$、$A$ 和 $\\delta(x)$ 表示你的结果，并将其特化到在长度为 $\\ell$ 的重叠区域上存在常数错误归一化 $\\delta(x)\\equiv \\delta$ 的情况。\n\n然后，使用以下数据计算该特化表达式的值：$E=200\\times 10^{9}$ Pa，$A=1.0\\times 10^{-4}$ m$^{2}$，$\\ell=0.10$ m，$F=1.0\\times 10^{4}$ N，以及 $\\delta=0.050$。将最终数值答案四舍五入至四位有效数字。以焦耳为单位表示最终的能量误差。",
            "solution": "该问题要求推导在桥接域方法 (BDM) 公式中由于混合权重非恰当归一化而引入的总能量误差。物理系统是一根在恒定轴向拉力下的均匀线弹性杆。为了解决这个问题，我们首先建立基准，即杆的真实应变能。然后，我们在 BDM 混合模型中建立能量公式，并求出其差值。\n\n首先，我们定义在给定载荷下杆的状态。该杆的杨氏模量为 $E$，横截面积为 $A$，并受到恒定的轴向力 $F$。根据线弹性理论，轴向应力 $\\sigma$ 是均匀的，由下式给出：\n$$ \\sigma = \\frac{F}{A} $$\n轴向应变 $\\epsilon$ 也是均匀的，并通过胡克定律与应力相关：\n$$ \\epsilon = \\frac{\\sigma}{E} = \\frac{F}{EA} $$\n对于线弹性材料，应变能密度 $u$（即单位体积的应变能）为：\n$$ u = \\frac{1}{2} \\sigma \\epsilon $$\n代入 $\\sigma$ 和 $\\epsilon$ 的表达式，我们得到用给定参数表示的应变能密度：\n$$ u = \\frac{1}{2} \\left(\\frac{F}{A}\\right) \\left(\\frac{F}{EA}\\right) = \\frac{F^2}{2EA^2} $$\n由于杆是均匀的且载荷是恒定的，该能量密度 $u$ 在杆的整个体积内是常数。总真实应变能 $U_{true}$ 是此密度在总体积 $V = A L$ 上的积分。\n$$ U_{true} = \\int_V u \\, dV = u \\cdot V = \\left(\\frac{F^2}{2EA^2}\\right) (A L) = \\frac{F^2 L}{2EA} $$\n该表达式代表了系统的正确、单一模型的应变能。\n\n接下来，我们在具有指定非恰当归一化的 BDM 框架内建立总能量公式。杆被划分为几个区域。杆的一部分，长度为 $\\ell$，是原子 (A) 模型和连续介质 (C) 模型混合的桥接域。杆的其余部分，长度为 $L-\\ell$，使用单一描述（例如，连续介质）进行建模。\n\n问题指出，对于此问题，原子描述和连续介质描述产生相同的能量密度。这意味着 $u_A(x) = u_C(x) = u$，其中 $u$ 是先前推导出的常数能量密度。\n\n在桥接域之外（总长度为 $L-\\ell$ 的区域），能量密度就是 $u$。储存在杆这部分的能量 $U_{out}$ 是：\n$$ U_{out} = u \\cdot A (L-\\ell) $$\n在桥接域内部（长度为 $\\ell$），能量密度通过权重 $w_A(x)$ 和 $w_C(x)$ 进行混合。混合能量密度 $u_{BDM}(x)$ 是：\n$$ u_{BDM}(x) = w_A(x) u_A(x) + w_C(x) u_C(x) = (w_A(x) + w_C(x)) u $$\n我们已知权重是非恰当归一化的，使得 $w_A(x) + w_C(x) = 1 + \\delta(x)$。因此，桥接域中的能量密度是：\n$$ u_{BDM}(x) = (1 + \\delta(x)) u $$\n储存在桥接域中的总能量 $U_{bridge}$ 是此混合能量密度在桥接域体积上的积分。设桥接域从 $x=x_0$ 延伸到 $x=x_0+\\ell$。\n$$ U_{bridge} = \\int_{x_0}^{x_0+\\ell} u_{BDM}(x) A \\, dx = \\int_{x_0}^{x_0+\\ell} (1 + \\delta(x)) u A \\, dx $$\n由于 $u$ 和 $A$ 是常数，我们可以写成：\n$$ U_{bridge} = u A \\int_{x_0}^{x_0+\\ell} (1 + \\delta(x)) \\, dx = u A \\left( \\ell + \\int_{x_0}^{x_0+\\ell} \\delta(x) \\, dx \\right) $$\nBDM 模型中的总能量 $U_{BDM}$ 是桥接域内部和外部区域能量的总和：\n$$ U_{BDM} = U_{out} + U_{bridge} = u A (L-\\ell) + u A \\left( \\ell + \\int_{x_0}^{x_0+\\ell} \\delta(x) \\, dx \\right) $$\n$$ U_{BDM} = u A \\left( L - \\ell + \\ell + \\int_{overlap} \\delta(x) \\, dx \\right) = u A \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) $$\n代入 $u = \\frac{F^2}{2EA^2}$ 的表达式：\n$$ U_{BDM} = \\frac{F^2}{2EA^2} A \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) = \\frac{F^2}{2EA} \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) $$\n\n总能量误差 $\\Delta U$ 定义为 BDM 混合能量与真实能量之差：\n$$ \\Delta U = U_{BDM} - U_{true} = \\frac{F^2}{2EA} \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) - \\frac{F^2 L}{2EA} $$\n$$ \\Delta U = \\frac{F^2 L}{2EA} + \\frac{F^2}{2EA} \\int_{overlap} \\delta(x) \\, dx - \\frac{F^2 L}{2EA} $$\n这可以简化为能量误差的一般表达式：\n$$ \\Delta U = \\frac{F^2}{2EA} \\int_{overlap} \\delta(x) \\, dx $$\n\n现在，我们将此结果特化到错误归一化为常数 $\\delta(x) \\equiv \\delta$ 的情况，该常数作用于长度为 $\\ell$ 的整个重叠区域。积分为：\n$$ \\int_{overlap} \\delta(x) \\, dx = \\int_{x_0}^{x_0+\\ell} \\delta \\, dx = \\delta \\int_{x_0}^{x_0+\\ell} dx = \\delta \\ell $$\n将此代入一般误差表达式，得到误差的特化表达式：\n$$ \\Delta U = \\frac{F^2 \\delta \\ell}{2EA} $$\n\n最后，我们使用提供的数值数据计算此表达式的值：\n$E = 200 \\times 10^{9}$ Pa\n$A = 1.0 \\times 10^{-4}$ m$^2$\n$\\ell = 0.10$ m\n$F = 1.0 \\times 10^{4}$ N\n$\\delta = 0.050$\n\n我们将这些值代入特化的误差公式中：\n$$ \\Delta U = \\frac{(1.0 \\times 10^{4} \\, \\text{N})^2 (0.050) (0.10 \\, \\text{m})}{2 (200 \\times 10^{9} \\, \\text{Pa}) (1.0 \\times 10^{-4} \\, \\text{m}^2)} $$\n$$ \\Delta U = \\frac{(1.0 \\times 10^{8} \\, \\text{N}^2) (0.0050 \\, \\text{m})}{2 (2.0 \\times 10^{11} \\, \\text{N/m}^2) (1.0 \\times 10^{-4} \\, \\text{m}^2)} $$\n$$ \\Delta U = \\frac{5.0 \\times 10^{5} \\, \\text{N}^2 \\cdot \\text{m}}{4.0 \\times 10^{7} \\, \\text{N}} = 1.25 \\times 10^{-2} \\, \\text{N} \\cdot \\text{m} $$\n由于 1 焦耳 (J) 等于 1 牛顿米 (N·m)，能量误差为：\n$$ \\Delta U = 0.0125 \\, \\text{J} $$\n按要求四舍五入到四位有效数字，最终答案是 $0.01250$ J。",
            "answer": "$$\\boxed{0.01250}$$"
        },
        {
            "introduction": "多尺度耦合中的一个主要挑战是在界面处出现不真实的“伪力”（ghost forces），尤其是在处理非局域相互作用时。本练习通过一个一维谐振子链模型，将桥接域方法与一种更简单的锐利界面耦合方法进行了直接比较。通过解析计算两种方法中作用在界面原子上的伪力，您将亲眼看到 BDM 的平滑混合方案如何有效减轻这些人为效应，从而实现更准确、更稳定的模拟。",
            "id": "3816097",
            "problem": "考虑一个一维无限谐振子原子链，原子由整数标签 $i \\in \\mathbb{Z}$ 索引，其平衡位置为 $x_i = i a$，其中 $a > 0$ 是晶格间距。每个原子通过线性弹簧与其最近邻和次近邻原子相互作用。最近邻弹簧刚度为 $k_1 > 0$，次近邻弹簧刚度为 $k_2 > 0$。原子位移场为 $u_i$，对于链的均匀变形，假设 $u_i = \\varepsilon x_i = \\varepsilon i a$，其中 $\\varepsilon$ 是一个常应变。\n\n总原子能量（每个键计算一次）由二次弹簧能量之和指定。在均匀应变下，由于对称性，内部原子受到的净力为零。我们关心的是在引入多尺度耦合的界面上产生的残余“伪力”。\n\n考虑两种耦合策略：\n\n- 锐利界面耦合：原子域取为 $\\{i \\leq 0\\}$，连续介质域取为 $\\{i \\geq 1\\}$。假设连续介质能量是离散能量的 Cauchy-Born 均匀化。在锐利界面策略中，只有当两个端点都位于原子域内时，才包含成对的原子相互作用。跨越界面的相互作用不包含在原子能量中，并且在界面上不施加来自连续介质的校正牵引力。\n\n- 桥接域方法：在连续介质一侧引入一个长度为 $L = m a$ 的重叠区域，其中整数 $m \\geq 1$。在重叠区域内，使用线性原子权重函数 $w(x)$ 对原子能量进行混合，使得当 $x \\leq 0$ 时 $w(x) = 1$，当 $0 \\leq x \\leq L$ 时 $w(x) = 1 - x/L$，当 $x \\geq L$ 时 $w(x) = 0$。连续介质能量与互补权重 $1 - w(x)$ 混合，因此在重叠区域中 $w(x) + (1 - w(x)) = 1$。假设采用以下建模约定：每个离散的对能量乘以在键中点处评估的原子权重，即，应用于连接原子 $i$ 和 $j$ 的键的权重为 $w\\!\\left(\\frac{x_i + x_j}{2}\\right)$。假设在重叠区域内运动学一致，即在均匀应变下，连续介质位移场等于原子位移场。\n\n将伪力定义为，当链条受到均匀应变 $u_i = \\varepsilon i a$ 时，在上述耦合下作用在界面原子 $i = 0$ 上的净残余力。仅使用线性弹簧的第一性原理和上述混合约定，推导在 $i=0$ 处伪力大小的显式表达式，针对以下情况：\n\n1. 上述的锐利界面耦合。\n2. 上述的使用线性权重 $w(x)$ 的桥接域方法。\n\n然后，计算伪力大小的比率 $R$（桥接域除以锐利界面），并将其表示为 $k_1$、$k_2$ 和 $m$ 的封闭形式函数。\n\n你的最终答案必须是 $R$ 的单个解析表达式，不带单位。不需要进行数值代入，也不需要四舍五入。",
            "solution": "连接原子 $i$ 和 $j$ 的线性弹簧中存储的势能由 $U_{ij} = \\frac{1}{2} k_{|i-j|} (\\Delta L)^2$ 给出，其中 $k_{|i-j|}$ 是弹簧刚度，$\\Delta L$ 是弹簧长度的变化量。原子 $i$ 和 $j$ 之间的初始距离是 $x_j - x_i$。变形后，它们的位置是 $x_i+u_i$ 和 $x_j+u_j$。新的距离是 $(x_j+u_j) - (x_i+u_i)$。因此，长度的变化量是 $\\Delta L = ((x_j+u_j) - (x_i+u_i)) - (x_j - x_i) = u_j - u_i$。键的能量是 $U_{ij} = \\frac{1}{2} k_{|i-j|} (u_j - u_i)^2$。\n\n原子 $j$ 施加在原子 $i$ 上的力是 $F_{i \\leftarrow j} = -\\frac{\\partial U_{ij}}{\\partial u_i} = -\\frac{\\partial}{\\partial u_i} \\left[ \\frac{1}{2} k_{|i-j|} (u_j - u_i)^2 \\right] = k_{|i-j|} (u_j - u_i)$。\n原子 $i$ 上的总力是其所有邻居施加的力之和。对于给定的具有最近邻（NN）和次近邻（NNN）相互作用的一维链，在完美无限晶格中，原子 $i$ 上的力为：\n$$F_i^{\\text{full}} = F_{i \\leftarrow i+1} + F_{i \\leftarrow i-1} + F_{i \\leftarrow i+2} + F_{i \\leftarrow i-2}$$\n$$F_i^{\\text{full}} = k_1(u_{i+1} - u_i) + k_1(u_{i-1} - u_i) + k_2(u_{i+2} - u_i) + k_2(u_{i-2} - u_i)$$\n在指定的均匀变形 $u_i = \\varepsilon i a$ 下，我们有：\n$u_{i+1} - u_i = \\varepsilon(i+1)a - \\varepsilon i a = \\varepsilon a$。\n$u_{i-1} - u_i = \\varepsilon(i-1)a - \\varepsilon i a = -\\varepsilon a$。\n$u_{i+2} - u_i = \\varepsilon(i+2)a - \\varepsilon i a = 2\\varepsilon a$。\n$u_{i-2} - u_i = \\varepsilon(i-2)a - \\varepsilon i a = -2\\varepsilon a$。\n将这些代入力的表达式中：\n$$F_i^{\\text{full}} = k_1(\\varepsilon a) + k_1(-\\varepsilon a) + k_2(2\\varepsilon a) + k_2(-2\\varepsilon a) = 0$$\n这证实了对于均匀应变，体材料中的任何原子上都没有净力。“伪力”是多尺度模型界面上由于跨界面的相互作用处理不一致而产生的非零残余力。我们现在将计算在界面原子 $i=0$ 处，针对两种指定的耦合方案的这种力。\n\n1.  **锐利界面耦合的伪力**\n\n在锐利界面模型中，原子域是 $\\{i \\leq 0\\}$，只有当两个原子都在此域中时才包含相互作用。我们计算界面原子 $i=0$ 上的净力。原子 $0$ 的邻居是 $-1$、$1$、$-2$ 和 $2$。\n-   键 $(0, -1)$：原子 $0$ 和 $-1$ 都在原子域中。力的贡献 $F_{0 \\leftarrow -1}$ 被包括在内。\n-   键 $(0, -2)$：原子 $0$ 和 $-2$ 都在原子域中。力的贡献 $F_{0 \\leftarrow -2}$ 被包括在内。\n-   键 $(0, 1)$：原子 $1$ 在连续介质域 $\\{i \\geq 1\\}$ 中。此键被切断。力的贡献 $F_{0 \\leftarrow 1}$ 缺失。\n-   键 $(0, 2)$：原子 $2$ 在连续介质域中。此键被切断。力的贡献 $F_{0 \\leftarrow 2}$ 缺失。\n\n原子 $0$ 上的净残余力，我们定义为伪力 $F_0^{\\text{sharp}}$，是所包含的力的贡献之和：\n$$F_0^{\\text{sharp}} = F_{0 \\leftarrow -1} + F_{0 \\leftarrow -2} = k_1(u_{-1} - u_0) + k_2(u_{-2} - u_0)$$\n代入均匀变形 $u_i = \\varepsilon i a$：\n$u_{-1} = -\\varepsilon a$, $u_0 = 0$, $u_{-2} = -2\\varepsilon a$。\n$$F_0^{\\text{sharp}} = k_1(-\\varepsilon a - 0) + k_2(-2\\varepsilon a - 0) = -k_1 \\varepsilon a - 2k_2 \\varepsilon a$$\n$$F_0^{\\text{sharp}} = -(k_1 + 2k_2) \\varepsilon a$$\n伪力的大小为 $|F_0^{\\text{sharp}}| = (k_1 + 2k_2) |\\varepsilon a|$，因为 $k_1 > 0$ 且 $k_2 > 0$。\n\n2.  **桥接域方法（BDM）的伪力**\n\n在 BDM 中，每个键 $(i,j)$ 的能量由 $w_{ij} = w\\left(\\frac{x_i + x_j}{2}\\right)$ 加权。总能量为 $E_{\\text{BDM}} = \\frac{1}{2} \\sum_{i,j; j>i} w_{ij} k_{|i-j|} (u_j - u_i)^2$。现在，从原子 $j$ 作用在原子 $i$ 上的力被加权：$F_{i \\leftarrow j} = w_{ij} k_{|i-j|} (u_j - u_i)$。\n原子 $0$ 上的总力是所有加权力的贡献之和：\n$$F_0^{\\text{BDM}} = F_{0 \\leftarrow 1} + F_{0 \\leftarrow -1} + F_{0 \\leftarrow 2} + F_{0 \\leftarrow -2}$$\n$$F_0^{\\text{BDM}} = w_{0,1} k_1 (u_1 - u_0) + w_{0,-1} k_1 (u_{-1} - u_0) + w_{0,2} k_2 (u_2 - u_0) + w_{0,-2} k_2 (u_{-2} - u_0)$$\n我们需要评估连接到原子 $0$ 的键的权重。中点是：\n-   键 $(0,1)$：$\\frac{x_0+x_1}{2} = \\frac{a}{2}$。\n-   键 $(0,-1)$：$\\frac{x_0+x_{-1}}{2} = \\frac{-a}{2}$。\n-   键 $(0,2)$：$\\frac{x_0+x_2}{2} = \\frac{2a}{2} = a$。\n-   键 $(0,-2)$：$\\frac{x_0+x_{-2}}{2} = \\frac{-2a}{2} = -a$。\n\n权重函数为：当 $x \\leq 0$ 时 $w(x) = 1$，当 $0 \\leq x \\leq L$ 时 $w(x) = 1 - x/L$，当 $x \\geq L$ 时 $w(x) = 0$，其中 $L = ma$ 且 $m \\geq 1$。\n-   $w_{0,1} = w(a/2) = 1 - \\frac{a/2}{L} = 1 - \\frac{a/2}{ma} = 1 - \\frac{1}{2m}$。\n-   $w_{0,-1} = w(-a/2) = 1$。\n-   $w_{0,2} = w(a) = 1 - \\frac{a}{L} = 1 - \\frac{a}{ma} = 1 - \\frac{1}{m}$。\n-   $w_{0,-2} = w(-a) = 1$。\n\n现在，将这些权重和位移代入力表达式中：\n$$F_0^{\\text{BDM}} = \\left(1 - \\frac{1}{2m}\\right) k_1 (\\varepsilon a) + (1) k_1 (-\\varepsilon a) + \\left(1 - \\frac{1}{m}\\right) k_2 (2\\varepsilon a) + (1) k_2 (-2\\varepsilon a)$$\n提出因子 $\\varepsilon a$：\n$$F_0^{\\text{BDM}} = \\varepsilon a \\left[ k_1\\left(1 - \\frac{1}{2m}\\right) - k_1 + 2k_2\\left(1 - \\frac{1}{m}\\right) - 2k_2 \\right]$$\n$$F_0^{\\text{BDM}} = \\varepsilon a \\left[ \\left(k_1 - \\frac{k_1}{2m}\\right) - k_1 + \\left(2k_2 - \\frac{2k_2}{m}\\right) - 2k_2 \\right]$$\n$$F_0^{\\text{BDM}} = \\varepsilon a \\left[ -\\frac{k_1}{2m} - \\frac{2k_2}{m} \\right]$$\n$$F_0^{\\text{BDM}} = -\\frac{\\varepsilon a}{2m} (k_1 + 4k_2)$$\n这个伪力的大小是 $|F_0^{\\text{BDM}}| = \\frac{|\\varepsilon a|}{2m} (k_1 + 4k_2)$。\n\n3.  **伪力大小之比**\n比率 $R$ 定义为 BDM 伪力的大小除以锐利界面伪力的大小。\n$$R = \\frac{|F_0^{\\text{BDM}}|}{|F_0^{\\text{sharp}}|}$$\n$$R = \\frac{\\frac{|\\varepsilon a|}{2m} (k_1 + 4k_2)}{(k_1 + 2k_2) |\\varepsilon a|}$$\n项 $|\\varepsilon a|$ 被消掉了。\n$$R = \\frac{k_1 + 4k_2}{2m(k_1 + 2k_2)}$$\n这就是比率 $R$ 作为 $k_1$、$k_2$ 和 $m$ 的函数的最终表达式。",
            "answer": "$$\\boxed{\\frac{k_1 + 4k_2}{2m(k_1 + 2k_2)}}$$"
        },
        {
            "introduction": "桥接域方法中混合函数的选择并非任意，它会显著影响模拟的质量，特别是在动态问题中抑制虚假的波反射。这个高级练习将带您深入探讨混合函数的设计，专注于根据平滑度准则推导出一个最优的函数形式。通过解决一个变分法问题来构建一个能最小化伪高频振荡的权重函数，您将深入理解用于设计高性能多尺度耦合方案的严谨数学基础。",
            "id": "3844850",
            "problem": "考虑在跨域桥接方法（BDM）中使用的一维重叠区域 $x \\in [0,L]$，其中原子子模型和连续介质子模型通过单位分解权函数 $w_{\\mathrm{A}}(x)$ 和 $w_{\\mathrm{C}}(x)$ 进行混合，这些权函数满足对于所有 $x \\in [0,L]$ 都有 $w_{\\mathrm{A}}(x) + w_{\\mathrm{C}}(x) = 1$。在重叠区中，原子贡献在 $x=0$ 附近占主导，而连续介质贡献在 $x=L$ 附近占主导，因此 $w_{\\mathrm{A}}(x)$ 应从 $x=0$ 到 $x=L$ 单调递减，而 $w_{\\mathrm{C}}(x)$ 则单调递增。单位参考长度上的混合小应变弹性能为\n$$\n\\mathcal{E}[u] = \\int_{0}^{L} \\left( w_{\\mathrm{A}}(x)\\,\\Psi_{\\mathrm{A}}(\\varepsilon(u)) + w_{\\mathrm{C}}(x)\\,\\Psi_{\\mathrm{C}}(\\varepsilon(u)) \\right)\\,\\mathrm{d}x,\n$$\n其中 $\\varepsilon(u) = u'(x)$ 是一维应变，$\\Psi_{\\mathrm{A}}$ 和 $\\Psi_{\\mathrm{C}}$ 分别是原子和连续介质的能量密度。假设在一个斑图测试（patch-test）设定中，子模型在小应变下是一致的，即对于任意恒定应变，$\\Psi_{\\mathrm{A}}(\\varepsilon) = \\Psi_{\\mathrm{C}}(\\varepsilon)$。\n\n你需要构建一个在 $[0,L]$ 上二次连续可微（$C^2$）的权函数 $w_{\\mathrm{A}}(x)$，该函数实现从原子模型到连续介质模型的过渡，并满足以下端点条件：\n$$\nw_{\\mathrm{A}}(0) = 1,\\quad w_{\\mathrm{A}}(L) = 0,\\quad w'_{\\mathrm{A}}(0) = 0,\\quad w'_{\\mathrm{A}}(L) = 0,\\quad w''_{\\mathrm{A}}(0) = 0,\\quad w''_{\\mathrm{A}}(L) = 0.\n$$\n这些条件旨在消除虚假的界面项，并在将离散的原子体系耦合到连续介质时抑制高频反射。在所有可能的 $C^2$ 斜坡函数（包括如余弦斜坡的三角函数选择和多项式斜坡）中，通过援引以下两个从第一性原理推导出的准则来证明一个特定选择的合理性：\n- 当 $\\Psi_{\\mathrm{A}}=\\Psi_{\\mathrm{C}}$ 时，在任意线性位移场 $u(x) = \\alpha x + \\beta$ 下的斑图测试不变性。\n- 光滑度最优性，表述为在上述端点约束条件下，泛函\n$$\nJ[w] = \\int_{0}^{L} \\left| w^{(3)}(x) \\right|^{2} \\,\\mathrm{d}x\n$$\n的最小化子，该泛函惩罚曲率的快速变化，从而减少高频伪影。\n\n构建这样一个权函数 $w_{\\mathrm{A}}(x)$ 关于 $x$ 和 $L$ 的显式闭合形式表达式，并将此表达式作为你的最终答案。不需要进行数值四舍五入。将你的最终答案表示为单个解析表达式。",
            "solution": "### 求解推导\n任务是找到一个函数 $w_{\\mathrm{A}}(x)$，它满足给定的边界条件并最小化一个光滑度泛函。为简化推导，我们将 $w_{\\mathrm{A}}(x)$ 记为 $w(x)$。\n\n首先，我们分析斑图测试不变性准则。对于线性位移场 $u(x) = \\alpha x + \\beta$，应变为常数：$\\varepsilon(x) = u'(x) = \\alpha$。问题陈述，原子模型和连续介质模型是一致的，意味着 $\\Psi_{\\mathrm{A}}(\\alpha) = \\Psi_{\\mathrm{C}}(\\alpha)$。我们将这个共同的能量密度记为 $\\Psi(\\alpha)$。混合能量泛函变为：\n$$\n\\mathcal{E}[u] = \\int_{0}^{L} \\left( w_{\\mathrm{A}}(x)\\,\\Psi(\\alpha) + w_{\\mathrm{C}}(x)\\,\\Psi(\\alpha) \\right)\\,\\mathrm{d}x\n$$\n利用单位分解性质 $w_{\\mathrm{A}}(x) + w_{\\mathrm{C}}(x) = 1$，我们得到：\n$$\n\\mathcal{E}[u] = \\int_{0}^{L} \\left( w_{\\mathrm{A}}(x) + w_{\\mathrm{C}}(x) \\right)\\,\\Psi(\\alpha)\\,\\mathrm{d}x = \\int_{0}^{L} \\Psi(\\alpha)\\,\\mathrm{d}x = L\\,\\Psi(\\alpha)\n$$\n对于长度为 $L$、承受恒定应变 $\\alpha$ 的均匀杆，这是正确的能量。此结果对任何构成单位分解的函数 $w_{\\mathrm{A}}(x)$ 和 $w_{\\mathrm{C}}(x)$ 都成立。因此，该准则是BDM公式的基础，除了已经陈述的条件外，它没有对 $w(x)$ 的具体函数形式施加任何额外约束。核心任务是解决由第二个准则定义的变分问题。\n\n第二个准则要求我们找到一个函数 $w(x)$，它能最小化泛函：\n$$\nJ[w] = \\int_{0}^{L} \\left( w^{(3)}(x) \\right)^{2} \\,\\mathrm{d}x\n$$\n并满足六个边界条件：\n$$\nw(0) = 1, \\quad w(L) = 0 \\\\\nw'(0) = 0, \\quad w'(L) = 0 \\\\\nw''(0) = 0, \\quad w''(L) = 0\n$$\n这是一个标准的变分法问题。拉格朗日量是 $F(x, w, w', w'', w^{(3)}) = (w^{(3)})^2$。对于一个依赖于最高 $n$ 阶导数的泛函，其欧拉-拉格朗日方程由 $\\sum_{k=0}^{n} (-1)^k \\frac{\\mathrm{d}^k}{\\mathrm{d}x^k} \\left( \\frac{\\partial F}{\\partial w^{(k)}} \\right) = 0$ 给出。在我们的情况下，$n=3$ 且 $F$ 只依赖于 $w^{(3)}$。方程简化为：\n$$\n(-1)^3 \\frac{\\mathrm{d}^3}{\\mathrm{d}x^3} \\left( \\frac{\\partial F}{\\partial w^{(3)}} \\right) = 0\n$$\n计算偏导数：\n$$\n\\frac{\\partial F}{\\partial w^{(3)}} = 2w^{(3)}(x)\n$$\n将其代入欧拉-拉格朗日方程，得到：\n$$\n-\\frac{\\mathrm{d}^3}{\\mathrm{d}x^3} \\left( 2w^{(3)}(x) \\right) = -2w^{(6)}(x) = 0 \\implies w^{(6)}(x) = 0\n$$\n这个六阶常微分方程的通解是一个五次多项式：\n$$\nw(x) = c_5 x^5 + c_4 x^4 + c_3 x^3 + c_2 x^2 + c_1 x + c_0\n$$\n六个系数 $c_0, c_1, c_2, c_3, c_4, c_5$ 由六个边界条件确定。首先，我们计算 $w(x)$ 的一阶和二阶导数：\n$$\nw'(x) = 5c_5 x^4 + 4c_4 x^3 + 3c_3 x^2 + 2c_2 x + c_1\n$$\n$$\nw''(x) = 20c_5 x^3 + 12c_4 x^2 + 6c_3 x + 2c_2\n$$\n应用 $x=0$ 处的边界条件：\n- $w(0) = 1 \\implies c_0 = 1$\n- $w'(0) = 0 \\implies c_1 = 0$\n- $w''(0) = 0 \\implies 2c_2 = 0 \\implies c_2 = 0$\n\n因此，多项式的形式为 $w(x) = c_5 x^5 + c_4 x^4 + c_3 x^3 + 1$。\n现在，应用 $x=L$ 处的边界条件：\n- $w(L) = 0 \\implies c_5 L^5 + c_4 L^4 + c_3 L^3 + 1 = 0$\n- $w'(L) = 0 \\implies 5c_5 L^4 + 4c_4 L^3 + 3c_3 L^2 = 0$\n- $w''(L) = 0 \\implies 20c_5 L^3 + 12c_4 L^2 + 6c_3 L = 0$\n\n假设 $L \\neq 0$，我们可以简化这个关于系数 $c_3, c_4, c_5$ 的包含三个线性方程的方程组：\n1. $c_5 L^5 + c_4 L^4 + c_3 L^3 = -1$\n2. $5c_5 L^2 + 4c_4 L + 3c_3 = 0$\n3. $10c_5 L^2 + 6c_4 L + 3c_3 = 0$\n\n方程(3)减去方程(2)：\n$$\n(10-5)c_5 L^2 + (6-4)c_4 L + (3-3)c_3 = 0\n$$\n$$\n5c_5 L^2 + 2c_4 L = 0 \\implies 2c_4 = -5c_5 L \\implies c_4 = -\\frac{5}{2}c_5 L\n$$\n将 $c_4$ 的这个表达式代入方程(2)：\n$$\n5c_5 L^2 + 4\\left(-\\frac{5}{2}c_5 L\\right)L + 3c_3 = 0\n$$\n$$\n5c_5 L^2 - 10c_5 L^2 + 3c_3 = 0 \\implies -5c_5 L^2 + 3c_3 = 0 \\implies c_3 = \\frac{5}{3}c_5 L^2\n$$\n最后，将 $c_3$ 和 $c_4$ 的表达式代入方程(1)：\n$$\nc_5 L^5 + \\left(-\\frac{5}{2}c_5 L\\right) L^4 + \\left(\\frac{5}{3}c_5 L^2\\right) L^3 = -1\n$$\n$$\nc_5 L^5 - \\frac{5}{2}c_5 L^5 + \\frac{5}{3}c_5 L^5 = -1\n$$\n$$\nc_5 L^5 \\left(1 - \\frac{5}{2} + \\frac{5}{3}\\right) = -1\n$$\n$$\nc_5 L^5 \\left(\\frac{6 - 15 + 10}{6}\\right) = -1\n$$\n$$\nc_5 L^5 \\left(\\frac{1}{6}\\right) = -1 \\implies c_5 = -\\frac{6}{L^5}\n$$\n现在反向代入以求得 $c_4$ 和 $c_3$：\n$$\nc_4 = -\\frac{5}{2} \\left(-\\frac{6}{L^5}\\right) L = \\frac{15}{L^4}\n$$\n$$\nc_3 = \\frac{5}{3} \\left(-\\frac{6}{L^5}\\right) L^2 = -\\frac{10}{L^3}\n$$\n确定的系数为 $c_0=1$、$c_1=0$、$c_2=0$、$c_3=-10/L^3$、$c_4=15/L^4$ 和 $c_5=-6/L^5$。\n将这些系数代入 $w(x)$ 的多项式形式，得到 $w_{\\mathrm{A}}(x)$ 的解：\n$$\nw_{\\mathrm{A}}(x) = 1 - \\frac{10}{L^3}x^3 + \\frac{15}{L^4}x^4 - \\frac{6}{L^5}x^5\n$$\n使用归一化坐标 $\\xi = x/L$，可以更紧凑地写成：\n$$\nw_{\\mathrm{A}}(x) = 1 - 10\\left(\\frac{x}{L}\\right)^3 + 15\\left(\\frac{x}{L}\\right)^4 - 6\\left(\\frac{x}{L}\\right)^5\n$$\n作为最终检查，我们验证其单调性。一阶导数为：\n$$\nw'_{\\mathrm{A}}(x) = -\\frac{30}{L^3}x^2 + \\frac{60}{L^4}x^3 - \\frac{30}{L^5}x^4 = -\\frac{30x^2}{L^5}(L^2 - 2Lx + x^2) = -\\frac{30x^2(L-x)^2}{L^5}\n$$\n对于 $x \\in (0,L)$ 和 $L>0$，我们有 $x^2 > 0$、$(L-x)^2 > 0$ 以及 $L^5 > 0$。因此，对于 $x \\in (0,L)$，$w'_{\\mathrm{A}}(x) < 0$。由于 $w'_{\\mathrm{A}}(0)=0$ 和 $w'_{\\mathrm{A}}(L)=0$，函数 $w_{\\mathrm{A}}(x)$ 在区间 $[0,L]$ 上是单调递减的，满足所述要求。",
            "answer": "$$\n\\boxed{1 - \\frac{10x^3}{L^3} + \\frac{15x^4}{L^4} - \\frac{6x^5}{L^5}}\n$$"
        }
    ]
}