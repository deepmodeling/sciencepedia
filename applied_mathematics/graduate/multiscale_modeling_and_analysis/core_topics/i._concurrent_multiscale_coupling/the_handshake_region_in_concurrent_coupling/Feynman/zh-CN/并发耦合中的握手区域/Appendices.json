{
    "hands_on_practices": [
        {
            "introduction": "为了避免在模型交界处产生伪反射和虚假力，我们不使用尖锐的边界，而是采用一个“握手”区域来混合不同尺度的模型。本练习的核心是创建实现这种混合的数学工具——单位分解函数——以保证过渡的平滑性，即至少达到 $C^1$ 连续。这是构建任何稳健耦合方案的基础性第一步。",
            "id": "3819449",
            "problem": "在原子子模型和连续介质子模型的并发多尺度耦合中，相互作用通过一个有限的“握手”重叠区域进行混合，以避免虚假的界面伪影。考虑一个一维杆，其空间坐标 $x$ 以米为单位，其中重叠（握手）区域是区间 $[0,L]$，$L>0$。构建一对权重函数 $w_{\\mathrm{A}}(x)$ 和 $w_{\\mathrm{C}}(x)$，它们定义了一个用于混合的 $C^1$ 单位分解，并满足以下要求：\n- $w_{\\mathrm{A}}(x)$ 和 $w_{\\mathrm{C}}(x)$ 是 $\\mathbb{R}$ 上的非负 $C^1$ 函数，且对于所有 $x\\in\\mathbb{R}$，都有 $w_{\\mathrm{A}}(x)+w_{\\mathrm{C}}(x)=1$，\n- 对于 $x\\leq 0$，$w_{\\mathrm{A}}(x)=1$ 且 $w_{\\mathrm{C}}(x)=0$，\n- 对于 $x\\geq L$，$w_{\\mathrm{A}}(x)=0$ 且 $w_{\\mathrm{C}}(x)=1$，\n- 在 $x\\in(0,L)$ 区间内，$w_{\\mathrm{A}}(x)$ 从 $1$ 平滑减小到 $0$，$w_{\\mathrm{C}}(x)$ 从 $0$ 平滑增加到 $1$，并且在端点 $x=0$ 和 $x=L$ 处的一阶导数为零。\n\n仅使用微积分的基本定义和单位分解的定义，用一个在 $[0,L]$ 上满足 $s(0)=0$、$s(L)=1$、$s'(0)=0$ 和 $s'(L)=0$ 的平滑“升余弦”斜坡函数 $s(x)$ 来定义 $w_{\\mathrm{A}}(x)$ 和 $w_{\\mathrm{C}}(x)$。证明所得的函数对在 $\\mathbb{R}$ 上是 $C^1$ 的，并且是一个有效的单位分解。然后，计算在 $x\\in\\mathbb{R}$ 上权重的空间梯度（在一维情况下即为导数）的最大幅值，并表示为 $L$ 的函数。\n\n你的最终答案必须是关于 $L$ 的单个闭式解析表达式。如果使用物理单位，请以反米（$\\mathrm{m}^{-1}$）报告梯度幅值。最终方框内的答案不应包含单位。无需四舍五入。",
            "solution": "问题陈述是适定的，有科学依据，并为构建 $C^1$ 单位分解提供了一套完整且一致的要求。这是多尺度建模领域的一个标准问题。因此，该问题是有效的，我们着手进行求解。\n\n任务是为 $x \\in \\mathbb{R}$ 构建一对权重函数 $w_{\\mathrm{A}}(x)$ 和 $w_{\\mathrm{C}}(x)$，使其在握手区域 $[0, L]$ 上满足一组混合属性。此构建将基于 $[0, L]$ 上的一个平滑的“升余弦”斜坡函数 $s(x)$。\n\n首先，我们在区间 $[0, L]$ 上构建斜坡函数 $s(x)$。问题要求 $s(x)$ 满足四个条件：$s(0)=0$、$s(L)=1$、$s'(0)=0$ 和 $s'(L)=0$。一个“升余弦”函数的形式为 $A \\cos(kx) + B$。为了满足边界条件，我们需要一个在该区间上平滑过渡的函数。一个合适的形式是 $s(x) = A\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)$。这一选择的动机在于余弦的自变量 $\\frac{\\pi x}{L}$ 将区间 $[0, L]$ 映射到 $[0, \\pi]$，即余弦函数的半个周期。\n\n我们来用 $s(x)$ 的条件检验这个形式：\n我们提出 $s(x) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)$。\n1.  在 $x=0$ 处：$s(0) = \\frac{1}{2}\\left(1 - \\cos(0)\\right) = \\frac{1}{2}(1 - 1) = 0$。此条件满足。\n2.  在 $x=L$ 处：$s(L) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi L}{L}\\right)\\right) = \\frac{1}{2}(1 - \\cos(\\pi)) = \\frac{1}{2}(1 - (-1)) = 1$。此条件满足。\n\n现在，我们检查导数条件。$s(x)$ 关于 $x$ 的一阶导数是：\n$$ s'(x) = \\frac{d}{dx} \\left[ \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) \\right] = \\frac{1}{2} \\left( \\sin\\left(\\frac{\\pi x}{L}\\right) \\cdot \\frac{\\pi}{L} \\right) = \\frac{\\pi}{2L} \\sin\\left(\\frac{\\pi x}{L}\\right) $$\n3.  在 $x=0$ 处：$s'(0) = \\frac{\\pi}{2L} \\sin(0) = 0$。此条件满足。\n4.  在 $x=L$ 处：$s'(L) = \\frac{\\pi}{2L} \\sin(\\pi) = 0$。此条件满足。\n因此，函数 $s(x) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)$ 就是正确的“升余弦”斜坡函数。\n\n接下来，我们使用 $s(x)$ 为所有 $x \\in \\mathbb{R}$ 定义权重函数 $w_{\\mathrm{A}}(x)$ 和 $w_{\\mathrm{C}}(x)$。函数 $w_{\\mathrm{C}}(x)$ 应从 $0$ 增加到 $1$，而 $w_{\\mathrm{A}}(x)$ 应从 $1$ 减小到 $0$。我们可以直接将在握手区域内的 $w_{\\mathrm{C}}(x)$ 等同于 $s(x)$。单位分解的要求 $w_{\\mathrm{A}}(x) + w_{\\mathrm{C}}(x) = 1$ 则定义了 $w_{\\mathrm{A}}(x) = 1 - w_{\\mathrm{C}}(x)$。\n完整的分段定义如下：\n$$ w_{\\mathrm{C}}(x) = \\begin{cases} 0  \\text{if } x \\le 0 \\\\ \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)  \\text{if } 0  x  L \\\\ 1  \\text{if } x \\ge L \\end{cases} $$\n$$ w_{\\mathrm{A}}(x) = 1 - w_{\\mathrm{C}}(x) = \\begin{cases} 1  \\text{if } x \\le 0 \\\\ 1 - \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)  \\text{if } 0  x  L \\\\ 0  \\text{if } x \\ge L \\end{cases} $$\n\n现在，我们必须证明这对函数是 $C^1$ 的，并构成一个有效的单位分解。\n1.  **单位分解**：根据构造，对所有 $x \\in \\mathbb{R}$ 都有 $w_{\\mathrm{A}}(x) + w_{\\mathrm{C}}(x) = 1$。对于 $x \\le 0$（$1+0=1$）、$x \\ge L$（$0+1=1$）以及 $0  x  L$（$(1-s(x)) + s(x) = 1$），这一点都成立。\n2.  **非负性**：对于 $x \\in (0, L)$，余弦的自变量 $\\frac{\\pi x}{L}$ 在 $(0, \\pi)$ 内。在此范围内，$-1 \\le \\cos(\\frac{\\pi x}{L}) \\le 1$。\n    -   $w_{\\mathrm{C}}(x) = \\frac{1}{2}(1 - \\cos(\\frac{\\pi x}{L}))$。由于 $\\cos(\\cdot) \\le 1$，所以 $w_{\\mathrm{C}}(x) \\ge 0$。\n    -   $w_{\\mathrm{A}}(x) = \\frac{1}{2}(1 + \\cos(\\frac{\\pi x}{L}))$。由于 $\\cos(\\cdot) \\ge -1$，所以 $w_{\\mathrm{A}}(x) \\ge 0$。\n    在区间 $(0, L)$ 之外，函数值为 $0$ 或 $1$，均为非负。\n3.  **$C^1$ 连续性**：如果一个函数及其一阶导数都是连续的，则该函数是 $C^1$ 的。我们只需要检查分段定义边界点 $x=0$ 和 $x=L$ 处的连续性。我们分析 $w_{\\mathrm{C}}(x)$；$w_{\\mathrm{A}}(x)$ 的结果可随之得出，因为 $w_{\\mathrm{A}}(x) = 1 - w_{\\mathrm{C}}(x)$ 且 $w'_{\\mathrm{A}}(x) = -w'_{\\mathrm{C}}(x)$。\n    -   在 $x=0$ 处的连续性：\n        -   $\\lim_{x \\to 0^-} w_{\\mathrm{C}}(x) = 0$。\n        -   $w_{\\mathrm{C}}(0^+) = \\lim_{x \\to 0^+} \\frac{1}{2}(1 - \\cos(\\frac{\\pi x}{L})) = \\frac{1}{2}(1-1) = 0$。\n        -   函数在 $x=0$ 处是连续的。\n    -   在 $x=L$ 处的连续性：\n        -   $w_{\\mathrm{C}}(L^-) = \\lim_{x \\to L^-} \\frac{1}{2}(1 - \\cos(\\frac{\\pi x}{L})) = \\frac{1}{2}(1 - \\cos(\\pi)) = \\frac{1}{2}(1 - (-1)) = 1$。\n        -   $\\lim_{x \\to L^+} w_{\\mathrm{C}}(x) = 1$。\n        -   函数在 $x=L$ 处是连续的。\n    -   对于 $x \\in (0,L)$，导数为 $w'_{\\mathrm{C}}(x) = \\frac{\\pi}{2L} \\sin(\\frac{\\pi x}{L})$；对于 $x \\notin [0,L]$，导数为 $w'_{\\mathrm{C}}(x)=0$。\n    -   导数在 $x=0$ 处的连续性：\n        -   $\\lim_{x \\to 0^-} w'_{\\mathrm{C}}(x) = 0$。\n        -   $\\lim_{x \\to 0^+} w'_{\\mathrm{C}}(x) = \\lim_{x \\to 0^+} \\frac{\\pi}{2L} \\sin(\\frac{\\pi x}{L}) = \\frac{\\pi}{2L} \\sin(0) = 0$。\n        -   导数在 $x=0$ 处是连续的。\n    -   导数在 $x=L$ 处的连续性：\n        -   $\\lim_{x \\to L^-} w'_{\\mathrm{C}}(x) = \\lim_{x \\to L^-} \\frac{\\pi}{2L} \\sin(\\frac{\\pi x}{L}) = \\frac{\\pi}{2L} \\sin(\\pi) = 0$。\n        -   $\\lim_{x \\to L^+} w'_{\\mathrm{C}}(x) = 0$。\n        -   导数在 $x=L$ 处是连续的。\n    由于 $w_{\\mathrm{C}}(x)$ 和 $w'_{\\mathrm{C}}(x)$ 在 $\\mathbb{R}$ 上都是连续的，所以 $w_{\\mathrm{C}}(x)$ 是一个 $C^1$ 函数。同理，$w_{\\mathrm{A}}(x)$ 也是。所有条件均已满足。\n\n最后，我们计算权重空间梯度的最大幅值。$w_{\\mathrm{A}}(x)$ 和 $w_{\\mathrm{C}}(x)$ 的梯度仅在区间 $(0, L)$ 内非零。\n$ w'_{\\mathrm{A}}(x) = -\\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right) $\n$ w'_{\\mathrm{C}}(x) = \\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right) $\n梯度的幅值是相同的：\n$$ |w'_{\\mathrm{A}}(x)| = |w'_{\\mathrm{C}}(x)| = \\left|\\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right)\\right| $$\n对于 $x \\in (0, L)$，自变量 $\\frac{\\pi x}{L} \\in (0, \\pi)$，在此区间内正弦函数是非负的。因此，我们可以去掉绝对值符号：\n$$ |w'_{\\mathrm{A}}(x)| = |w'_{\\mathrm{C}}(x)| = \\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right) $$\n为了找到最大幅值，我们需要找到这个表达式在 $x \\in (0, L)$ 上的最大值。常数因子是 $\\frac{\\pi}{2L}$。$\\sin(\\theta)$ 的最大值是 $1$，此时 $\\theta = \\frac{\\pi}{2}$。\n将正弦函数的自变量设为 $\\frac{\\pi}{2}$：\n$$ \\frac{\\pi x}{L} = \\frac{\\pi}{2} \\implies x = \\frac{L}{2} $$\n这个 $x$ 的值在区间 $(0, L)$ 内。在这一点，梯度幅值达到其最大值：\n$$ \\max_{x \\in \\mathbb{R}} |w'_{\\mathrm{A}}(x)| = \\max_{x \\in \\mathbb{R}} |w'_{\\mathrm{C}}(x)| = \\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi (L/2)}{L}\\right) = \\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi}{2}\\right) = \\frac{\\pi}{2L} \\cdot 1 = \\frac{\\pi}{2L} $$\n权重的空间梯度的最大幅值，表示为 $L$ 的函数，是 $\\frac{\\pi}{2L}$。",
            "answer": "$$\\boxed{\\frac{\\pi}{2L}}$$"
        },
        {
            "introduction": "单位分解函数告诉我们*在何处*进行耦合，但我们还需要定义两个模型中的自由度*如何*相互关联。本练习将一个连续的运动学条件（例如通过卷积核 $K$ 建立的位移关系 $u_{f} = K \\ast u_{c}$）转化为一组线性代数方程，这正是计算机模拟所需的具体形式。通过这个实践，你将理解抽象的耦合思想是如何转变为求解器中的具体矩阵算子的。",
            "id": "3819480",
            "problem": "考虑在一个公共物理区间上，一个细尺度模型和一个粗尺度模型之间的一维并行多尺度耦合，其中存在一个重叠（握手）区域，在该区域内施加了运动学桥接关系。设细网格的节点坐标为 $x_{i} = i h_{f}$，其索引为 $i \\in \\mathcal{I}_{f}$；粗网格的节点坐标为 $X_{j} = j h_{c}$，其索引为 $j \\in \\mathcal{J}_{c}$，其中 $h_{c} = m h_{f}$，$m \\geq 2$ 为一固定整数。分别用 $\\mathcal{I}_{o} \\subset \\mathcal{I}_{f}$ 和 $\\mathcal{J}_{o} \\subset \\mathcal{J}_{c}$ 表示位于重叠区域内的细尺度节点和粗尺度节点的索引集合。细尺度位移样本被收集在向量 $u_{f} \\in \\mathbb{R}^{n_{f}}$ 中，粗尺度位移样本被收集在向量 $u_{c} \\in \\mathbb{R}^{n_{c}}$ 中，其中 $n_{f} = |\\mathcal{I}_{f}|$，$n_{c} = |\\mathcal{J}_{c}|$。\n\n假设在握手区域中，连续運動學橋接關係是卷积约束 $u_{f}(x) = (K \\ast u_{c})(x)$，适用于重叠区域内的 $x$。其中 $K$ 是一个紧支集可积核，且满足 $\\int_{\\mathbb{R}} K(\\xi)\\,\\mathrm{d}\\xi = 1$。设离散核权重在粗网格偏移量上定义为 $K[r]$，其中整数 $r \\in \\{-R, \\ldots, R\\}$，$R \\in \\mathbb{N}$ 为某个有限数，这代表了连续卷积的一致求积/离散化。对于每个细尺度索引 $i \\in \\mathcal{I}_{o}$，令 $j(i) \\in \\mathcal{J}_{c}$ 表示在索引空间中位于 $x_{i}$ 处或最接近 $x_{i}$ 的粗尺度节点的索引（为具体起见，取 $j(i) = \\lfloor i/m \\rfloor$）。\n\n从卷积的定义及其黎曼和离散化出发，推导在节点值层面上的离散桥接约束，该约束对所有 $i \\in \\mathcal{I}_{o}$ 强制执行 $u_{f}[i] = \\sum_{r=-R}^{R} K[r]\\,u_{c}[\\,j(i)+r\\,]$，并以线性代数形式表示。引入重叠选择矩阵 $S_{o}^{f} \\in \\mathbb{R}^{n_{o} \\times n_{f}}$，该矩阵提取 $u_{f}$ 中索引在 $\\mathcal{I}_{o}$ 内的分量，其中 $n_{o} = |\\mathcal{I}_{o}|$。然后构建一个带状类托普利茨矩阵 $\\mathcal{T}_{o}(K) \\in \\mathbb{R}^{n_{o} \\times n_{c}}$，该矩阵表示从粗尺度自由度到细尺度重叠位置的离散卷积。\n\n您的推导必须：\n- 从连续卷积 $(K \\ast u_{c})(x) = \\int_{\\mathbb{R}} K(x-y)\\,u_{c}(y)\\,\\mathrm{d}y$ 和粗网格上的一致离散化开始。\n- 证明通过 $j(i)$ 将细尺度索引映射到粗尺度索引的合理性，以及截断到 $K$ 的紧支集的合理性。\n- 将约束组合成一个作用于拼接向量 $\\begin{bmatrix} u_{f} \\\\ u_{c} \\end{bmatrix}$ 的单个分块算子。\n\n给出分块约束算子 $B(K) \\in \\mathbb{R}^{n_{o} \\times (n_{f}+n_{c})}$ 的单一闭式矩阵表达式作为您的最终答案，其形式为矩阵卷积，使得 $B(K)\\begin{bmatrix} u_{f} \\\\ u_{c} \\end{bmatrix}$ 等于重叠区域中的离散约束残差向量。请勿包含单位。最终答案必须是单一解析表达式，而非方程或不等式。",
            "solution": "问题陈述是有效的。它在多尺度计算力学领域有科学依据，是适定的，并为唯一的推导提供了足够的信息，且以客观、正式的语言表述。我们可以开始求解。\n\n目标是推导在一维重叠区域中耦合细尺度模型和粗尺度模型的一组离散运动学桥接约束的矩阵表示。最终输出应为一个分块矩阵算子 $B(K)$，使得约束残差向量由 $B(K)\\begin{bmatrix} u_{f} \\\\ u_{c} \\end{bmatrix}$ 给出。\n\n连续桥接关系以卷积约束的形式给出，适用于握手区域中的任何位置 $x$：\n$$u_{f}(x) = (K \\ast u_{c})(x) = \\int_{\\mathbb{R}} K(x-y)\\,u_{c}(y)\\,\\mathrm{d}y$$\n此处，$u_{f}(x)$ 和 $u_{c}(y)$ 是连续位移场，核 $K$ 是一个满足一致性条件 $\\int_{\\mathbb{R}} K(\\xi)\\,\\mathrm{d}\\xi = 1$ 的紧支集可积函数。\n\n问题在于如何离散化此关系。粗尺度场 $u_{c}(y)$ 仅通过其在离散点 $X_j = j h_c$（其中 $j \\in \\mathcal{J}_c$）处的节点值 $u_c[j]$ 而得知。离散化卷积积分的一个标准方法是采用基于粗网格节点的求积法则。将积分近似为粗网格点上的加权和可得：\n$$u_{f}(x) \\approx \\sum_{j \\in \\mathcal{J}_c} w_j K(x-X_j) u_c[j]$$\n其中 $w_j$ 是求积权重。对于均匀网格，一个简单的选择是节点间距，即 $w_j = h_c$。\n\n问题给出了在每个位于 $x_i = i h_f$ 的细尺度节点 $i \\in \\mathcal{I}_o$ 处的离散约束的显式形式：\n$$u_{f}[i] = \\sum_{r=-R}^{R} K[r]\\,u_{c}[\\,j(i)+r\\,]$$\n该方程是特定“一致求积/离散化”方案的结果。索引映射 $j(i) = \\lfloor i/m \\rfloor = \\lfloor (i h_f) / h_c \\rfloor = \\lfloor x_i/h_c \\rfloor$ 确定了紧邻细尺度节点 $x_i$ 左侧（或与其共处一地）的粗尺度节点或单元边界的索引。对相对索引 $r \\in \\{-R, \\ldots, R\\}$ 的求和反映了连续核 $K$ 的紧支集特性，这意味着一个细尺度值 $u_f[i]$ 仅取决于局部邻域内的粗尺度值。离散权重 $K[r]$ 假定是给定的，并封装了核 $K$ 和积分测度的离散化。为与常数场保持一致（即精确再现常數位移场），这些权重必须满足 $\\sum_{r=-R}^{R} K[r] = 1$，这是对 $K$ 的积分条件的离散模拟。\n\n我们的任务是为所有 $i \\in \\mathcal{I}_o$ 将这些约束组合成一个单一的矩阵方程。对于单个细尺度节点 $i$ 的约束可以写成一个必须为零的残差 $c_i$：\n$$c_i = u_f[i] - \\sum_{r=-R}^{R} K[r]\\,u_{c}[\\,j(i)+r\\,] = 0$$\n令 $c_o$ 为所有 $i \\in \\mathcal{I}_o$ 的这些残差组成的向量，其中 $n_o = |\\mathcal{I}_o|$ 是重叠区域中的细尺度节点数。我们寻求一个分块约束算子 $B(K) \\in \\mathbb{R}^{n_{o} \\times (n_{f}+n_{c})}$，使得 $c_o = B(K) \\begin{bmatrix} u_{f} \\\\ u_{c} \\end{bmatrix}$。\n\n算子 $B(K)$ 可以根据其对 $u_f \\in \\mathbb{R}^{n_f}$ 和 $u_c \\in \\mathbb{R}^{n_c}$ 的作用进行分块：\n$$B(K) = \\begin{bmatrix} B_f  B_c \\end{bmatrix}$$\n其中 $B_f \\in \\mathbb{R}^{n_o \\times n_f}$ 且 $B_c \\in \\mathbb{R}^{n_o \\times n_c}$。完整的残差系统则为 $c_o = B_f u_f + B_c u_c$。\n\n首先，我们确定分块 $B_f$。残差向量 $c_o$ 中依赖于 $u_f$ 的项就是重叠区域中的细尺度位移向量 $[u_f[i]]_{i \\in \\mathcal{I}_o}$。问题正是为此定义了重叠选择矩阵 $S_o^f \\in \\mathbb{R}^{n_o \\times n_f}$：它提取 $u_f$ 中对应于 $\\mathcal{I}_o$ 中索引的分量。因此，残差向量的这一部分是 $S_o^f u_f$。这意味着：\n$$B_f = S_o^f$$\n\n接着，我们确定分块 $B_c$。残差向量 $c_o$ 中依赖于 $u_c$ 的项是 $[-\\sum_{r=-R}^{R} K[r]\\,u_{c}[\\,j(i)+r\\,]]_{i \\in \\mathcal{I}_o}$。我们可以将这部分残差写为 $- \\mathcal{T}_o(K) u_c$，其中 $\\mathcal{T}_o(K) \\in \\mathbb{R}^{n_o \\times n_c}$ 是执行离散卷积的矩阵。这意味着：\n$$B_c = -\\mathcal{T}_o(K)$$\n我们必须构建这个矩阵 $\\mathcal{T}_o(K)$。设 $\\mathcal{T}_o(K)$ 的行由 $\\mathcal{I}_o$ 中细尺度索引的一个有序枚举 $k = 1, \\dots, n_o$（记作 $i_k$）来索引。列由粗尺度节点索引 $j \\in \\mathcal{J}_c$（比如 $j=1, \\dots, n_c$）来索引。元素 $(\\mathcal{T}_o(K))_{kj}$ 是第 $k$ 个求和中 $u_c[j]$ 的系数，该求和对应于细尺度节点 $i_k$。乘积 $\\mathcal{T}_o(K) u_c$ 的第 $k$ 行是：\n$$(\\mathcal{T}_o(K) u_c)_k = \\sum_{j=1}^{n_c} (\\mathcal{T}_o(K))_{kj} u_c[j] = \\sum_{r=-R}^{R} K[r]\\,u_{c}[\\,j(i_k)+r\\,]$$\n通过比较这两个求和，我们发现元素 $(\\mathcal{T}_o(K))_{kj}$ 仅在列索引 $j$ 与第 $k$ 行模板中的某个粗尺度节点索引匹配时才非零，即 $j = j(i_k) + r$ 对于某个 $r \\in \\{-R, \\ldots, R\\}$ 成立。如果满足此条件，$u_c[j]$ 的系数为 $K[r] = K[j-j(i_k)]$。因此，该矩阵的元素定义为：\n$$(\\mathcal{T}_o(K))_{kj} = \\begin{cases} K[j - j(i_k)]  \\text{if } |j - j(i_k)| \\le R \\\\ 0  \\text{otherwise} \\end{cases}$$\n这个矩阵是带状的，因为每一行 $k$ 最多有 $2R+1$ 个非零元素，集中在列 $j(i_k)$ 周围。它之所以是“类托普利茨”矩阵，是因为虽然每一行都是核模板 $K[r]$ 的一个平移版本，但从一行到下一行的平移量不是恒定的，而是由阶梯函数 $j(i_k) = \\lfloor i_k / m \\rfloor$ 决定的。\n\n组合这些分块，通过拼接 $B_f$ 和 $B_c$ 形成完整的约束算子 $B(K)$：\n$$B(K) = \\begin{bmatrix} S_o^f  -\\mathcal{T}_o(K) \\end{bmatrix}$$\n这个算子 $B(K) \\in \\mathbb{R}^{n_{o} \\times (n_{f}+n_{c})}$ 作用于拼接位移向量 $\\begin{bmatrix} u_{f} \\\\ u_{c} \\end{bmatrix}$，从而产生重叠区域中的约束残差向量。",
            "answer": "$$\n\\boxed{\n\\begin{bmatrix}\nS_o^f  -\\mathcal{T}_o(K)\n\\end{bmatrix}\n}\n$$"
        },
        {
            "introduction": "即使有了平滑的混合函数和明确的约束，简单的耦合方案也可能在握手区域内无意中产生或消耗能量（或质量），导致不符合物理规律的模拟结果。本练习通过一个简化模型，演示了这种“通量泄漏”是如何发生的，并指导你设计一个校正项 $\\phi(x)$ 来恢复基本的守恒定律 $\\frac{dJ}{dx} = 0$。这突出了在多尺度建模中确保物理一致性的极端重要性。",
            "id": "3819446",
            "problem": "在一个连续介质求解器和细尺度求解器的一维并行耦合中，两个模型在由区间 $\\left[0,L\\right]$ 定义的握手区域上重叠。令 $u_{c}(x)$ 表示重叠区域中的粗尺度（连续介质）场，令 $u_{f}(x)$ 表示细尺度场。假设两者都是由重叠区域外部的稳态驱动引起的线性函数：\n- $u_{c}(x) = u_{0} + g_{c}\\,x$，\n- $u_{f}(x) = v_{0} + g_{f}\\,x$，\n其中 $u_{0}$、$v_{0}$、$g_{c}$ 和 $g_{f}$ 是常数。设本构关系为 $J(x) = -k\\,\\frac{du}{dx}$，其中常数 $k0$，表示质量通量或动量通量。在稳态下，精确守恒要求在握手区域内 $\\frac{dJ}{dx} = 0$。\n\n考虑握手区域中的朴素混合场，\n$$\nu_{b}(x) = w(x)\\,u_{f}(x) + \\left(1 - w(x)\\right)\\,u_{c}(x),\n$$\n其中标准线性权重为 $w(x) = \\frac{x}{L}$。将跨握手区域的泄漏定义为重叠区域左右两端通量的净不匹配，\n$$\n\\Lambda \\equiv J_{b}(L^{-}) - J_{b}(0^{+}),\n$$\n其中 $J_{b}(x) = -k\\,\\frac{du_{b}}{dx}(x)$ 是从朴素混合场获得的通量。\n\n仅从上述定义和稳态守恒定律出发，首先计算泄漏 $\\Lambda$（用 $k$、$g_{c}$ 和 $g_{f}$ 表示）。\n\n然后，设计一个在 $\\left[0,L\\right]$ 上有支撑的标量校正核 $\\phi(x)$，使得校正场\n$$\n\\tilde{u}(x) = u_{b}(x) + \\phi(x)\n$$\n在握手区域内具有恒定通量，即对于所有 $x \\in (0,L)$，$\\frac{d}{dx}\\left(-k\\,\\frac{d\\tilde{u}}{dx}\\right) = 0$。施加端点约束 $\\phi(0) = 0$ 和 $\\phi(L) = 0$，以使校正不改变握手区域边界处的混合值。\n\n对于给定的朴素线性权重 $w(x)=\\frac{x}{L}$，请以单个闭式解析表达式的形式提供校正核 $\\phi(x)$ 的最终答案。无需数值近似，最终表达式中不应包含任何单位。",
            "solution": "用户希望我解决一个多尺度模型握手区域中的问题。\n\n### 步骤1：提取已知条件\n- **区域**：由区间 $\\left[0,L\\right]$ 定义的一维握手区域。\n- **粗尺度场**：$u_{c}(x) = u_{0} + g_{c}\\,x$。\n- **细尺度场**：$u_{f}(x) = v_{0} + g_{f}\\,x$。\n- **常数**：$u_{0}$、$v_{0}$、$g_{c}$、$g_{f}$、$L$。\n- **本构关系**：通量 $J(x) = -k\\,\\frac{du}{dx}$，其中 $k0$ 是一个常数。\n- **守恒定律**：在稳态下，$\\frac{dJ}{dx} = 0$。\n- **混合场**：$u_{b}(x) = w(x)\\,u_{f}(x) + \\left(1 - w(x)\\right)\\,u_{c}(x)$。\n- **权重函数**：$w(x) = \\frac{x}{L}$。\n- **泄漏定义**：$\\Lambda \\equiv J_{b}(L^{-}) - J_{b}(0^{+})$，其中 $J_{b}(x) = -k\\,\\frac{du_{b}}{dx}(x)$。\n- **校正场**：$\\tilde{u}(x) = u_{b}(x) + \\phi(x)$。\n- **校正条件**：与 $\\tilde{u}(x)$ 相关的通量必须是恒定的，即对于 $x \\in (0,L)$，$\\frac{d}{dx}\\left(-k\\,\\frac{d\\tilde{u}}{dx}\\right) = 0$。\n- **校正约束**：$\\phi(0) = 0$ 且 $\\phi(L) = 0$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在多尺度建模和数值分析这一成熟领域具有科学依据，专门解决了并行耦合方案重叠区域中的“伪力”或伪源问题。其公式基于连续介质力学（守恒定律、本构关系）的标准原理。该问题是适定的，所有变量、函数和条件都得到了清晰、客观的定义。它在数学上是自洽的，不包含任何矛盾或模糊之处。语言精确且无偏见。没有违反科学原理，没有缺失信息，其结构导向一个唯一且有意义的解。该问题是一个有效且可形式化的应用数学练习。\n\n### 步骤3：结论与行动\n问题是有效的。我将继续进行求解。\n\n求解需要两部分：首先，计算泄漏 $\\Lambda$；其次，推导校正核 $\\phi(x)$。\n\n**第一部分：计算泄漏 $\\Lambda$**\n\n首先，我们通过代入给定的 $u_{c}(x)$、$u_{f}(x)$ 和 $w(x)$ 的形式来表示混合场 $u_{b}(x)$：\n$$\nu_{b}(x) = \\frac{x}{L} (v_{0} + g_{f}\\,x) + \\left(1 - \\frac{x}{L}\\right) (u_{0} + g_{c}\\,x)\n$$\n为了求出通量 $J_{b}(x)$，我们必须先计算导数 $\\frac{du_{b}}{dx}$。我们展开 $u_{b}(x)$ 的表达式：\n$$\nu_{b}(x) = \\frac{v_{0}x}{L} + \\frac{g_{f}x^2}{L} + u_{0} + g_{c}x - \\frac{u_{0}x}{L} - \\frac{g_{c}x^2}{L}\n$$\n按 x 的幂次合并同类项：\n$$\nu_{b}(x) = u_{0} + \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right)x + \\left(\\frac{g_{f} - g_{c}}{L}\\right)x^2\n$$\n现在，我们对 x 求导：\n$$\n\\frac{du_{b}}{dx} = \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) + 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)x\n$$\n通量 $J_{b}(x)$ 由 $J_{b}(x) = -k\\,\\frac{du_{b}}{dx}$ 给出：\n$$\nJ_{b}(x) = -k \\left[ \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) + 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)x \\right]\n$$\n泄漏 $\\Lambda$ 定义为 $J_{b}(L) - J_{b}(0)$。我们计算 $J_{b}(x)$ 在端点 $x=0$ 和 $x=L$ 的值：\n在 $x=0$ 处：\n$$\nJ_{b}(0) = -k \\left( \\frac{v_{0} - u_{0}}{L} + g_{c} \\right)\n$$\n在 $x=L$ 处：\n$$\nJ_{b}(L) = -k \\left[ \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) + 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)L \\right] = -k \\left[ \\frac{v_{0} - u_{0}}{L} + g_{c} + 2(g_{f} - g_{c}) \\right]\n$$\n现在，我们计算差值 $\\Lambda = J_{b}(L) - J_{b}(0)$：\n$$\n\\Lambda = -k \\left[ \\frac{v_{0} - u_{0}}{L} + g_{c} + 2(g_{f} - g_{c}) \\right] - \\left(-k \\left[ \\frac{v_{0} - u_{0}}{L} + g_{c} \\right]\\right)\n$$\n$$\n\\Lambda = -k \\left[ \\frac{v_{0} - u_{0}}{L} + g_{c} + 2g_{f} - 2g_{c} - \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) \\right]\n$$\n$$\n\\Lambda = -k \\left[ 2g_{f} - 2g_{c} \\right] = -2k(g_{f} - g_{c})\n$$\n因此，泄漏为 $\\Lambda = 2k(g_{c} - g_{f})$。这个非零泄漏取决于细尺度场和粗尺度场梯度的不匹配，表明朴素混合方案违反了守恒定律。\n\n**第二部分：推导校正核 $\\phi(x)$**\n\n校正场为 $\\tilde{u}(x) = u_{b}(x) + \\phi(x)$。问题要求与 $\\tilde{u}(x)$ 相关的通量在握手区域内是恒定的。通量为 $\\tilde{J}(x) = -k \\frac{d\\tilde{u}}{dx}$。恒定通量的条件等价于守恒定律 $\\frac{d\\tilde{J}}{dx}=0$。\n$$\n\\frac{d}{dx} \\left(-k \\frac{d\\tilde{u}}{dx}\\right) = 0\n$$\n由于 k 是非零常数，这简化为关于 $\\tilde{u}(x)$ 的泊松方程：\n$$\n\\frac{d^2\\tilde{u}}{dx^2} = 0\n$$\n代入 $\\tilde{u}(x) = u_{b}(x) + \\phi(x)$：\n$$\n\\frac{d^2}{dx^2} \\left[ u_{b}(x) + \\phi(x) \\right] = 0 \\implies \\frac{d^2u_{b}}{dx^2} + \\frac{d^2\\phi}{dx^2} = 0\n$$\n这给了我们一个关于校正核 $\\phi(x)$ 的微分方程：\n$$\n\\frac{d^2\\phi}{dx^2} = - \\frac{d^2u_{b}}{dx^2}\n$$\n我们已经求出了 $u_b(x)$ 的一阶导数。我们再次求导以求得二阶导数：\n$$\n\\frac{d^2u_{b}}{dx^2} = \\frac{d}{dx} \\left[ \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) + 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)x \\right] = 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)\n$$\n因此，$\\phi(x)$ 的微分方程为：\n$$\n\\frac{d^2\\phi}{dx^2} = -2\\left(\\frac{g_{f} - g_{c}}{L}\\right) = 2\\left(\\frac{g_{c} - g_{f}}{L}\\right)\n$$\n为求解此常微分方程，我们对 x 积分两次。为简洁起见，令 $A = 2\\left(\\frac{g_{c} - g_{f}}{L}\\right)$。\n$$\n\\frac{d^2\\phi}{dx^2} = A\n$$\n积分一次得到：\n$$\n\\frac{d\\phi}{dx} = Ax + C_1\n$$\n其中 $C_1$ 是一个积分常数。再次积分得到 $\\phi(x)$ 的通解：\n$$\n\\phi(x) = \\frac{1}{2}Ax^2 + C_1x + C_2\n$$\n其中 $C_2$ 是第二个积分常数。我们使用端点约束 $\\phi(0)=0$ 和 $\\phi(L)=0$ 来确定 $C_1$ 和 $C_2$。\n\n应用 $\\phi(0)=0$：\n$$\n\\phi(0) = \\frac{1}{2}A(0)^2 + C_1(0) + C_2 = 0 \\implies C_2 = 0\n$$\n解简化为 $\\phi(x) = \\frac{1}{2}Ax^2 + C_1x$。\n\n应用 $\\phi(L)=0$：\n$$\n\\phi(L) = \\frac{1}{2}AL^2 + C_1L = 0\n$$\n由于 $L \\neq 0$，我们可以除以 $L$：\n$$\n\\frac{1}{2}AL + C_1 = 0 \\implies C_1 = -\\frac{1}{2}AL\n$$\n现在我们将常数 $C_1$ 和 $C_2$ 代回 $\\phi(x)$ 的表达式中：\n$$\n\\phi(x) = \\frac{1}{2}Ax^2 - \\frac{1}{2}ALx = \\frac{A}{2} (x^2 - Lx)\n$$\n最后，我们代回 A 的表达式 $A = 2\\left(\\frac{g_{c} - g_{f}}{L}\\right)$：\n$$\n\\phi(x) = \\frac{1}{2} \\left[2\\left(\\frac{g_{c} - g_{f}}{L}\\right)\\right] (x^2 - Lx)\n$$\n$$\n\\phi(x) = \\frac{g_{c} - g_{f}}{L} (x^2 - Lx)\n$$\n这就是所求的校正核，它能确保校正场具有恒定的通量，同时满足在握手区域边界处为零的条件。",
            "answer": "$$\\boxed{\\frac{g_c - g_f}{L}(x^2 - Lx)}$$"
        }
    ]
}