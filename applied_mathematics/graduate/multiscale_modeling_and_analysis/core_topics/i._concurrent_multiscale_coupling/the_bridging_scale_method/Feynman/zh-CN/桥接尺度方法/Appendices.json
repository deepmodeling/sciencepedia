{
    "hands_on_practices": [
        {
            "introduction": "桥接尺度方法 (Bridging Scale Method, BSM) 的核心原则之一是确保粗尺度模型能够准确地反映底层细尺度物理规律。本练习将通过一个一维原子链的简化模型，具体展示如何实现这一目标。您将从基本的原子间相互作用和虚功原理出发，推导出等效的宏观连续介质应力，并将其与经典的柯西-玻恩定则 (Cauchy-Born rule) 进行比较 。这个过程不仅验证了BSM框架的自洽性，也为理解微观力学行为如何涌现为宏观本构关系提供了坚实的数学基础。",
            "id": "3816505",
            "problem": "考虑一个无限长的一维原子链，其在参考构型下具有均匀的晶格间距 $a_0$，其中每对相邻原子都由一个弹簧常数为 $k$ 的谐和弹簧连接。在跨尺度方法下，将一个参考长度为 $L_0$ 的单个双节点（2节点）线性有限元（FE）嵌入到该链中，使得该单元跨越 $N$ 个键，且 $L_0 = N a_0$。该有限元的节点位移为 $U_1$（左节点）和 $U_2$（右节点），单元内部的位移场采用与双节点形函数相容的线性插值，从而在单元内产生一个恒定的变形梯度 $F = 1 + \\frac{U_2 - U_1}{L_0}$。\n\n在原子尺度上，一个当前长度为 $r$ 的键的能量由谐和弹簧能量 $E_b = \\frac{1}{2} k (r - a_0)^2$ 给出。跨尺度方法将粗化（连续介质）应力定义为这样一个量：当它用于连续介质内虚功计算时，在到有限元试探空间的投影下，能够再现原子尺度的内虚功。具体来说，令 $P$ 表示（标量）第一 Piola-Kirchhoff 应力，令 $\\delta W^{\\text{cont}}$ 和 $\\delta W^{\\text{atom}}$ 分别表示在与有限元插值相容的容许虚位移场下，单元上的连续介质内虚功和原子尺度内虚功。跨尺度方法要求内虚功等效，即对于任何此类虚变分，都要求 $\\delta W^{\\text{cont}} = \\delta W^{\\text{atom}}$。\n\n从上述基本定义出发，仅使用诸如弹簧的胡克定律和内虚功的定义等基本法则，推导通过投影传递到双节点有限元的粗化应力 $P$。然后，对于此一维链，根据 Cauchy-Born (CB) 理论，独立地构建单位参考长度的连续介质能量密度 $W(F)$，并计算相应的第一 Piola-Kirchhoff 应力 $P^{\\text{CB}} = \\frac{dW}{dF}$。验证从投影方法获得的应力等于 Cauchy-Born 应力。\n\n将您的最终答案表示为粗化应力 $P$ 关于 $U_1$, $U_2$, $L_0$, $k$ 和 $a_0$ 的单个闭式解析表达式。无需进行数值计算。最终答案必须是单个符号表达式。最终方框内的表达式中不要包含单位。",
            "solution": "在尝试提供解答之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：一个无限长的一维原子链。\n- **参考构型**：均匀晶格间距 $a_0$。\n- **原子间相互作用**：相邻原子由常数为 $k$ 的谐和弹簧连接。一个当前长度为 $r$ 的键的能量为 $E_b = \\frac{1}{2} k (r - a_0)^2$。\n- **粗尺度模型**：一个单个双节点（2节点）线性有限元（FE）。\n- **有限元单元属性**：参考长度 $L_0$，跨越 $N$ 个键，使得 $L_0 = N a_0$。\n- **有限元节点变量**：节点位移为 $U_1$（左节点）和 $U_2$（右节点）。\n- **有限元插值**：单元内部的位移场是线性插值，产生一个恒定的变形梯度 $F = 1 + \\frac{U_2 - U_1}{L_0}$。\n- **跨尺度原理**：粗化应力 $P$（第一 Piola-Kirchhoff）通过对所有与有限元插值相容的容许虚位移，令连续介质内虚功 $\\delta W^{\\text{cont}}$ 与原子尺度内虚功 $\\delta W^{\\text{atom}}$ 相等来确定，即 $\\delta W^{\\text{cont}} = \\delta W^{\\text{atom}}$。\n- **任务**：\n    1. 使用跨尺度虚功等效性推导粗化应力 $P$。\n    2. 独立推导 Cauchy-Born 应力 $P^{\\text{CB}} = \\frac{dW}{dF}$，其中 $W(F)$ 是单位参考长度的连续介质能量密度。\n    3. 验证 $P = P^{\\text{CB}}$。\n    4. 将 $P$ 的最终答案用 $U_1$、$U_2$、$L_0$、$k$ 和 $a_0$ 表示。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在连续介质力学和多尺度固体力学的成熟理论中有坚实的基础。谐和势、线性有限元的使用、虚功概念、第一 Piola-Kirchhoff 应力、跨尺度方法（准连续介质方法的一种形式）以及 Cauchy-Born 法则都是该领域的标准和基本概念。\n- **适定性**：该问题是基于清晰和形式化定义的推导。它要求在特定的理想条件（谐和晶格，线性插值）下，证明两种多尺度方法之间的一个已知的一致性结果。所提供的信息足以进行推导并得出一个唯一的解析表达式。\n- **客观性**：问题陈述使用了精确、客观和形式化的科学语言。没有主观或模糊的术语。\n- **完整性和一致性**：该问题是自洽的。所有必要的定义（原子能量、有限元插值、虚功等效性）都已提供。设置中没有矛盾。\n- **真实性和可行性**：一维谐和链模型是固态物理和力学中用于理论发展的标准模型系统，尽管它是一个简化的模型。作为一阶近似，它在物理上是合理的。\n- **结构**：问题结构清晰且非平凡。它要求严格应用连续介质力学和原子尺度力学的第一性原理，以论证多尺度建模中的一个关键概念。\n\n### 步骤3：结论与行动\n问题陈述在科学上是合理的、适定的和完整的。它是**有效的**。将提供完整的解答。\n\n### 粗化应力的推导与验证\n\n推导过程按要求分三部分进行：首先使用跨尺度方法的虚功等效性，其次使用 Cauchy-Born 先验假设，最后比较两个结果。\n\n**1. 通过虚功等效性推导粗化应力 $P$**\n\n跨尺度方法假定在连续介质和原子尺度上的内虚功相等：\n$$\n\\delta W^{\\text{cont}} = \\delta W^{\\text{atom}}\n$$\n\n首先，我们表达连续介质内虚功 $\\delta W^{\\text{cont}}$。对于一个参考长度为 $L_0$、承受第一 Piola-Kirchhoff 应力 $P$ 的一维物体，其内虚功由下式给出：\n$$\n\\delta W^{\\text{cont}} = \\int_{0}^{L_0} P \\, \\delta F \\, dX\n$$\n其中 $\\delta F$ 是变形梯度的变分。问题陈述指出，有限元插值是线性的，这给出了一个恒定的变形梯度 $F = 1 + \\frac{U_2 - U_1}{L_0}$。由于 $F$ 在整个单元中是恒定的，应力 $P(F)$ 也是恒定的。那么 $\\delta F$ 的变分是：\n$$\n\\delta F = \\delta \\left(1 + \\frac{U_2 - U_1}{L_0}\\right) = \\frac{\\delta U_2 - \\delta U_1}{L_0}\n$$\n这个变分在单元上也是恒定的。$\\delta W^{\\text{cont}}$ 的积分简化为：\n$$\n\\delta W^{\\text{cont}} = P \\cdot \\delta F \\cdot L_0 = P \\left(\\frac{\\delta U_2 - \\delta U_1}{L_0}\\right) L_0 = P (\\delta U_2 - \\delta U_1)\n$$\n\n接下来，我们表达原子尺度内虚功 $\\delta W^{\\text{atom}}$。这是单元内原子的总势能的变分。该单元跨越 $N$ 个键，连接着 $N+1$ 个原子，索引从 $j=0$ 到 $j=N$。设原子 $j$ 的参考位置为 $X_j = j a_0$。原子 $j$ 的位移 $u_j$ 由有限元形函数决定：\n$$\nu_j = u(X_j) = U_1 \\left(1 - \\frac{X_j}{L_0}\\right) + U_2 \\left(\\frac{X_j}{L_0}\\right)\n$$\n代入 $X_j = j a_0$ 和 $L_0 = N a_0$：\n$$\nu_j = U_1 \\left(1 - \\frac{j a_0}{N a_0}\\right) + U_2 \\left(\\frac{j a_0}{N a_0}\\right) = U_1 \\left(1 - \\frac{j}{N}\\right) + U_2 \\left(\\frac{j}{N}\\right)\n$$\n原子 $j$ 和原子 $j+1$ 之间键的当前长度 $r_j$ 是：\n$$\nr_j = (X_{j+1} + u_{j+1}) - (X_j + u_j) = (X_{j+1} - X_j) + (u_{j+1} - u_j) = a_0 + (u_{j+1} - u_j)\n$$\n位移差为：\n$$\nu_{j+1} - u_j = \\left[ U_1 \\left(1 - \\frac{j+1}{N}\\right) + U_2 \\left(\\frac{j+1}{N}\\right) \\right] - \\left[ U_1 \\left(1 - \\frac{j}{N}\\right) + U_2 \\left(\\frac{j}{N}\\right) \\right] = U_1\\left(-\\frac{1}{N}\\right) + U_2\\left(\\frac{1}{N}\\right) = \\frac{U_2 - U_1}{N}\n$$\n关键在于，由于位移场是线性的，这个差值对于单元内的每个键都是恒定的。因此，所有的键都有相同的当前长度 $r$：\n$$\nr = a_0 + \\frac{U_2 - U_1}{N}\n$$\n单个键的能量是 $E_b = \\frac{1}{2} k (r - a_0)^2$。代入 $r$ 的表达式：\n$$\nE_b = \\frac{1}{2} k \\left( \\left(a_0 + \\frac{U_2 - U_1}{N}\\right) - a_0 \\right)^2 = \\frac{1}{2} k \\left(\\frac{U_2 - U_1}{N}\\right)^2\n$$\n单元中 $N$ 个键的总能量 $E_{\\text{total}}$ 是：\n$$\nE_{\\text{total}} = \\sum_{j=0}^{N-1} E_b = N \\cdot E_b = N \\frac{1}{2} k \\left(\\frac{U_2 - U_1}{N}\\right)^2 = \\frac{k}{2N} (U_2 - U_1)^2\n$$\n原子尺度虚功是这个总能量相对于节点位移的变分：\n$$\n\\delta W^{\\text{atom}} = \\delta E_{\\text{total}} = \\frac{\\partial E_{\\text{total}}}{\\partial U_1} \\delta U_1 + \\frac{\\partial E_{\\text{total}}}{\\partial U_2} \\delta U_2\n$$\n计算偏导数：\n$$\n\\frac{\\partial E_{\\text{total}}}{\\partial U_1} = \\frac{k}{2N} \\cdot 2(U_2 - U_1) \\cdot (-1) = -\\frac{k}{N} (U_2 - U_1)\n$$\n$$\n\\frac{\\partial E_{\\text{total}}}{\\partial U_2} = \\frac{k}{2N} \\cdot 2(U_2 - U_1) \\cdot (1) = \\frac{k}{N} (U_2 - U_1)\n$$\n将这些代入 $\\delta W^{\\text{atom}}$ 的表达式中：\n$$\n\\delta W^{\\text{atom}} = \\frac{k}{N}(U_2 - U_1) \\delta U_2 - \\frac{k}{N}(U_2 - U_1) \\delta U_1 = \\frac{k}{N}(U_2 - U_1) (\\delta U_2 - \\delta U_1)\n$$\n现在，我们强制虚功等效，$\\delta W^{\\text{cont}} = \\delta W^{\\text{atom}}$：\n$$\nP (\\delta U_2 - \\delta U_1) = \\frac{k}{N}(U_2 - U_1) (\\delta U_2 - \\delta U_1)\n$$\n由于该等式必须对任何容许的虚位移场（即，对任何 $\\delta U_1, \\delta U_2$）都成立，我们可以得出结论，项 $(\\delta U_2 - \\delta U_1)$ 的系数必须相等。这就得出了粗化应力 $P$ 的表达式：\n$$\nP = \\frac{k}{N} (U_2 - U_1)\n$$\n为了用要求的变量表示，我们代入 $N = L_0/a_0$：\n$$\nP = \\frac{k}{L_0/a_0} (U_2 - U_1) = \\frac{k a_0}{L_0} (U_2 - U_1)\n$$\n\n**2. Cauchy-Born 应力 $P^{\\text{CB}}$ 的推导**\n\nCauchy-Born (CB) 理论假定，晶格的变形局部地遵循宏观变形梯度 $F$。对于一维链，一个参考长度为 $a_0$ 的键变形后的当前长度 $r$ 由下式给出：\n$$\nr = F a_0\n$$\n储存在这个单键中的应变能是：\n$$\nE_b = \\frac{1}{2} k (r - a_0)^2 = \\frac{1}{2} k (F a_0 - a_0)^2 = \\frac{1}{2} k a_0^2 (F - 1)^2\n$$\nCB 应变能密度 $W(F)$ 定义为单位参考体积的应变能。在一维情况下，这是单位参考长度的能量。与一个键相关联的参考长度是 $a_0$。\n$$\nW(F) = \\frac{E_b}{a_0} = \\frac{\\frac{1}{2} k a_0^2 (F - 1)^2}{a_0} = \\frac{1}{2} k a_0 (F - 1)^2\n$$\n第一 Piola-Kirchhoff 应力 $P^{\\text{CB}}$ 与变形梯度 $F$ 热力学共轭，由应变能密度对 $F$ 的导数给出：\n$$\nP^{\\text{CB}} = \\frac{dW}{dF} = \\frac{d}{dF} \\left[ \\frac{1}{2} k a_0 (F - 1)^2 \\right] = \\frac{1}{2} k a_0 \\cdot 2(F - 1) \\cdot 1 = k a_0 (F - 1)\n$$\n\n**3. 验证**\n\n为了验证来自跨尺度投影的应力等于 Cauchy-Born 应力，我们将 $P^{\\text{CB}}$ 用有限元节点位移来表示。我们将给定的变形梯度表达式 $F = 1 + \\frac{U_2 - U_1}{L_0}$ 代入 $P^{\\text{CB}}$ 的方程中：\n$$\nP^{\\text{CB}} = k a_0 \\left( \\left(1 + \\frac{U_2 - U_1}{L_0}\\right) - 1 \\right) = k a_0 \\left(\\frac{U_2 - U_1}{L_0}\\right) = \\frac{k a_0}{L_0} (U_2 - U_1)\n$$\n将此结果与通过虚功等效性得到的结果进行比较：\n$$\nP = \\frac{k a_0}{L_0} (U_2 - U_1)\n$$\n我们发现 $P = P^{\\text{CB}}$。验证成功。这个结果表明，对于谐和晶格和位移场的线性插值，跨尺度方法能精确地再现 Cauchy-Born 本构律。粗化应力 $P$ 的最终表达式是：\n$$\nP = \\frac{k a_0}{L_0} (U_2 - U_1)\n$$\n该表达式仅依赖于所要求的变量 $U_1$、$U_2$、$L_0$、$k$ 和 $a_0$。",
            "answer": "$$\n\\boxed{\\frac{k a_0}{L_0}(U_2-U_1)}\n$$"
        },
        {
            "introduction": "在多尺度耦合中，一个常见的陷阱是在原子/连续介质界面处产生非物理的“幽灵力”(ghost forces)，这会严重污染模拟结果的准确性。本练习旨在通过一个动手编程实验，让您亲手搭建一个数值“补丁测试”(patch test) 来诊断这种现象 。您将对比一种简化的“朴素”耦合方案和一种理论上正确的耦合方案，在均匀应变条件下计算原子受力。通过这个过程，您将直观地看到不恰当的耦合如何在界面处催生幽灵力，并验证一个构造良好的耦合方法能够成功地消除它们，从而加深对多尺度模型一致性重要性的理解。",
            "id": "3816510",
            "problem": "考虑一个一维原子链模型，该模型在跨尺度桥接方法（BSM）的双区域耦合设置中作为细观尺度的表示。该链由 $N$ 个原子组成，参考间距为 $a_0$，具有刚度为 $k$ 的线性成对最近邻相互作用，并受到以应变 $\\varepsilon$ 为特征的均匀变形。在均匀变形下，原子位置为 $x_i = i a_0 (1+\\varepsilon)$，其中 $i \\in \\{0,1,\\dots,N-1\\}$。相互作用由谐波对势 $\\phi(r) = \\tfrac{1}{2}k(r-a_0)^2$ 定义，在全原子链中，内部原子 $i$（$1 \\le i \\le N-2$）上的平衡力由 $F_i = \\dfrac{\\partial}{\\partial x_i} \\sum_j \\phi(|x_{j+1}-x_j|)$ 给出，对于最近邻相互作用，该公式简化为\n$$\nF_i = k\\left[(x_{i+1}-x_i - a_0) - (x_i - x_{i-1} - a_0)\\right].\n$$\n这体现了静态状态下牛顿第二定律的平衡条件。\n\n在索引 $m$ 处定义一个耦合界面，使得 $i \\le m$ 的原子被视为原子区域，而 $i \\ge m+1$ 的原子被视为连续介质区域。一种朴素耦合（旨在表示一种非桥接的、不一致的界面处理方式）省略了跨越界面的键，即忽略了原子 $m$ 和 $m+1$ 之间的对相互作用。在这种朴素模型中，所有内部原子 $i$ 的内力计算如上，但跨界面键的贡献被移除，因此原子 $m$ 不包含来自右邻原子的贡献，原子 $m+1$ 不包含来自左邻原子的贡献。这种省略模拟了鬼力的一个典型来源。\n\n相比之下，一个正确构建的 BSM 耦合旨在确保能量的一致性，并在均匀变形下消除鬼力。对于本问题，通过确保跨界面键被精确计算一次来模拟正确构建的耦合，从而产生与全原子链相同的离散力公式。这种理想化的表示捕捉了均匀应变下正确跨尺度耦合的诊断特征：在数值容差范围内，内力应为零。\n\n您的任务是实现以下数值实验来检测鬼力：\n- 对原子链施加均匀变形 $x_i = i a_0 (1+\\varepsilon)$。\n- 计算朴素耦合（省略界面键）和正确构建的耦合（界面键计算一次）的内力分布 $\\{F_i\\}_{i=1}^{N-2}$。\n- 使用检测阈值 $\\tau$ 来分类鬼力：任何满足 $|F_i| > \\tau$ 的内部原子 $i$ 都被标记为存在鬼力。\n\n假设使用无量纲单位（即取 $a_0 = 1$ 和 $k = 1$），并使用十进制阈值 $\\tau = 10^{-12}$。本问题不涉及角度。跨尺度桥接方法（BSM）通常采用宽度为 $w$ 的重叠区域和混合函数来确保一致性；在测试用例中包含 $w$ 作为参数，以验证在这种简化的一维设置中，在均匀变形下，正确构建的耦合消除鬼力的效果与 $w$ 无关。\n\n实现一个程序，对于每个测试用例，返回一个列表，其中包含：\n- 朴素耦合中的最大绝对内力，以浮点数表示。\n- 正确耦合中的最大绝对内力，以浮点数表示。\n- 一个布尔值，指示在朴素耦合中是否检测到鬼力（如果任何 $|F_i| > \\tau$ 则为真）。\n- 一个布尔值，指示在正确耦合中是否检测到鬼力（如果任何 $|F_i| > \\tau$ 则为真）。\n- 朴素耦合中 $|F_i| > \\tau$ 的内部原子索引 $i$ 的列表。\n- 正确耦合中 $|F_i| > \\tau$ 的内部原子索引 $i$ 的列表。\n\n测试套件参数（每个测试用例是一个元组 $(N,\\varepsilon,m,w)$）：\n- 用例 1：$(50, 0.05, 25, 10)$ — 具有中等应变和中心界面的典型原子链。\n- 用例 2：$(50, 0.0, 25, 10)$ — 零应变作为边界条件测试。\n- 用例 3：$(10, 0.08, 5, 1)$ — 短链和最小重叠宽度。\n- 用例 4：$(101, 0.1, 50, 20)$ — 奇数尺寸链和较大应变。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是按上述顺序排列的子列表（例如，$[\\,[\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$）。无需外部输入；将测试套件硬编码在程序中。",
            "solution": "该问题要求实现一个数值实验，以在一维（1D）原子链的多尺度模型中检测“鬼力”。鬼力是在原子区域和连续介质区域之间的界面处，因两者之间的耦合不一致而产生的虚假的、非物理的力。该实验将一种被设计为不一致的“朴素”耦合与一种能准确表示底层物理的“正确”耦合进行比较。\n\n该模型的基础是一个由 $N$ 个原子组成的一维链，其参考（无应变）间距为 $a_0$。最近邻原子之间的相互作用由谐波势 $\\phi(r) = \\tfrac{1}{2}k(r-a_0)^2$ 描述，其中 $r$ 是原子间距，$k$ 是刚度。原子 $i$ 上的力由总势能 $U = \\sum_{j} \\phi(|x_{j+1}-x_j|)$ 通过 $F_i = -\\partial U/\\partial x_i$ 推导得出。对于一个内部原子 $i$（即 $1 \\le i \\le N-2$），这产生了离散力定律：\n$$\nF_i = k\\left[(x_{i+1}-x_i - a_0) - (x_i - x_{i-1} - a_0)\\right]\n$$\n该表达式表示原子 $i$ 因其与右邻原子 ($i+1$) 和左邻原子 ($i-1$) 的相互作用而受到的合力。\n\n原子链受到均匀应变 $\\varepsilon$ 的作用，导致原子位置为 $x_i = i a_0 (1+\\varepsilon)$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。我们在原子 $m$ 处定义的界面上，分析了两种不同耦合方案下此变形所产生的力。\n\n首先，我们分析“正确构建的耦合”。这种耦合被定义为是一致的，意味着它能正确计算跨界面的力。在这个理想化的问题中，这是通过对所有内部原子使用上述完整的原子级力定律来建模的。让我们将位置 $x_i = i a_0 (1+\\varepsilon)$ 代入力表达式中。相邻原子之间的距离是均匀的：\n$$\nx_{i+1} - x_i = (i+1) a_0 (1+\\varepsilon) - i a_0 (1+\\varepsilon) = a_0(1+\\varepsilon)\n$$\n因此，任何内部原子 $i$ 上的力为：\n$$\nF_i = k\\left[ (a_0(1+\\varepsilon) - a_0) - (a_0(1+\\varepsilon) - a_0) \\right] = k [ a_0\\varepsilon - a_0\\varepsilon ] = 0\n$$\n这个结果是基础性的。对于均匀应变，完美晶格中的内部原子上没有净力。这相当于连续介质力学中的一个陈述：均匀应变场产生均匀应力场，且没有内部体力。一个正确制定的多尺度方法必须能再现这种行为；这被称为“斑块检验”（patch test）。因此，对于正确的耦合，我们预期所有内力都为零，直到数值浮点精度为止。\n\n接下来，我们分析“朴素耦合”。该方案通过简单地省略原子 $m$ 和原子 $m+1$ 之间的相互作用来模拟不一致的界面。这意味着项 $\\phi(|x_{m+1}-x_m|)$ 从总能量中被移除。因此，原子 $m$ 和原子 $m+1$ 的力计算被改变。\n- 对于原子 $i=m$：来自其右邻原子（$m+1$）的力贡献缺失。唯一剩下的贡献来自其左邻原子（$m-1$），导致 $F_m = -k(x_m - x_{m-1} - a_0)$。代入位置可得：\n$$\nF_m = -k(a_0(1+\\varepsilon) - a_0) = -k a_0 \\varepsilon\n$$\n- 对于原子 $i=m+1$：来自其左邻原子（$m$）的力贡献缺失。唯一剩下的贡献来自其右邻原子（$m+2$），导致 $F_{m+1} = k(x_{m+2} - x_{m+1} - a_0)$。代入位置可得：\n$$\nF_{m+1} = k(a_0(1+\\varepsilon) - a_0) = k a_0 \\varepsilon\n$$\n- 对于所有其他内部原子（$i \\neq m, i \\neq m+1$），标准公式适用，力为零。\n\n非零力 $F_m = -k a_0 \\varepsilon$ 和 $F_{m+1} = k a_0 \\varepsilon$ 就是“鬼力”。它们是不一致耦合的产物，不代表任何真实的物理现象。它们局限在界面处。应变 $\\varepsilon$ 越大，鬼力就越大。\n\n数值实现将按以下步骤进行。对于每个测试用例 $(N, \\varepsilon, m, w)$，我们设置无量纲参数 $a_0=1$ 和 $k=1$。重叠宽度参数 $w$ 在概念上与 BSM 中更复杂的混合函数相关，但在解决这个理想化问题时并未用于计算，从而证明对于均匀应变，完美耦合的结果与此类参数无关。\n1.  生成原子位置数组 $x_i = i(1+\\varepsilon)$。\n2.  计算正确耦合的内力 $\\{F_i\\}_{i=1}^{N-2}$。根据我们的分析，这些力在数值上应接近于零。矢量化计算为 $F_i = x_{i+1} - 2x_i + x_{i-1}$。\n3.  计算朴素耦合的内力。除了在 $i=m$ 和 $i=m+1$ 处（其中 $F_m = -\\varepsilon$ 和 $F_{m+1} = \\varepsilon$），其他地方的力均为零。\n4.  对于两种力分布，找出所有内部原子中的最大绝对力。\n5.  将这些最大值与阈值 $\\tau = 10^{-12}$ 进行比较，以确定是否存在鬼力。\n6.  识别出 $|F_i| > \\tau$ 的内部原子的具体索引 $i$。\n\n这个过程将定量地证明，朴素耦合在界面处产生了显著的鬼力（与 $\\varepsilon$ 成正比），而正确的耦合则正确地得到零力，通过了一致性检验。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a numerical experiment to detect ghost forces in a 1D multiscale model\n    by comparing a naive and a proper coupling scheme under uniform strain.\n    \"\"\"\n    test_cases = [\n        # (N, epsilon, m, w)\n        (50, 0.05, 25, 10),\n        (50, 0.0, 25, 10),\n        (10, 0.08, 5, 1),\n        (101, 0.1, 50, 20),\n    ]\n\n    a0 = 1.0  # Reference spacing\n    k = 1.0   # Interaction stiffness\n    tau = 1.0e-12  # Ghost force detection threshold\n\n    results = []\n\n    for N, epsilon, m, w in test_cases:\n        # Generate atomic positions under uniform deformation\n        atom_indices = np.arange(N)\n        x = atom_indices * a0 * (1.0 + epsilon)\n        \n        # Interior atom indices are from 1 to N-2\n        interior_indices = range(1, N - 1)\n\n        # --- Proper Coupling Calculation ---\n        # Forces are calculated using the full atomistic formula for all interior atoms.\n        # F_i = k * [(x_{i+1} - x_i - a0) - (x_i - x_{i-1} - a0)]\n        # For uniform strain, this simplifies to F_i = k * (x_{i+1} - 2*x_i + x_{i-1})\n        F_proper = np.zeros(N)\n        if N > 2:\n            F_proper[1:N-1] = k * (x[2:N] - 2 * x[1:N-1] + x[0:N-2])\n\n        # --- Naive Coupling Calculation ---\n        # The bond between atoms m and m+1 is omitted.\n        F_naive = np.zeros(N)\n        # F_m arises only from bond (m-1, m)\n        if m in interior_indices:\n            F_naive[m] = -k * (x[m] - x[m-1] - a0)\n        \n        # F_{m+1} arises only from bond (m+1, m+2)\n        if m + 1 in interior_indices:\n            F_naive[m+1] = k * (x[m+2] - x[m+1] - a0)\n\n        # --- Analysis of Interior Forces ---\n        F_proper_int = F_proper[1:N-1]\n        F_naive_int = F_naive[1:N-1]\n\n        # 1. Maximum absolute interior force in the naive coupling\n        max_abs_force_naive = np.max(np.abs(F_naive_int)) if len(F_naive_int) > 0 else 0.0\n\n        # 2. Maximum absolute interior force in the proper coupling\n        max_abs_force_proper = np.max(np.abs(F_proper_int)) if len(F_proper_int) > 0 else 0.0\n\n        # 3. Boolean indicating ghost forces in the naive coupling\n        ghosts_detected_naive = max_abs_force_naive > tau\n\n        # 4. Boolean indicating ghost forces in the proper coupling\n        ghosts_detected_proper = max_abs_force_proper > tau\n        \n        # 5. List of interior indices with ghost forces for naive coupling\n        # The '+ 1' converts from the slice's 0-based index to the chain's 1-based index\n        ghost_indices_naive = (np.where(np.abs(F_naive_int) > tau)[0] + 1).tolist()\n        \n        # 6. List of interior indices with ghost forces for proper coupling\n        ghost_indices_proper = (np.where(np.abs(F_proper_int) > tau)[0] + 1).tolist()\n\n        case_result = [\n            float(max_abs_force_naive),\n            float(max_abs_force_proper),\n            ghosts_detected_naive,\n            ghosts_detected_proper,\n            ghost_indices_naive,\n            ghost_indices_proper\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在理解了能量一致性原则并诊断了潜在的耦合问题之后，最后一步便是将整个物理模型转化为一个可解的数学系统。本练习将指导您使用拉格朗日乘子法 (method of Lagrange multipliers) 这一强大的约束优化工具，来构建一个完整的BSM耦合系统的线性方程组 。通过推导描述该系统的分块矩阵，您将深入了解BSM模拟的计算架构，看清粗尺度能量 $\\frac{1}{2}u_c^{\\top} K u_c$、细尺度能量 $\\frac{1}{2}u_f^{\\top} H u_f$ 以及尺度间耦合约束 $u = u_c + u_f$ 是如何被整合进一个统一的代数框架中求解的。",
            "id": "3816545",
            "problem": "考虑一种跨尺度方法，该方法在一个具有重叠支撑域的区域上耦合一个粗尺度有限元 (FE) 模型和一个细尺度原子模型。设粗尺度弹性势能由对称半正定刚度矩阵 $K \\in \\mathbb{R}^{n \\times n}$ 表示，作用于粗尺度位移 $u_c \\in \\mathbb{R}^{n}$；细尺度谐波近似由对称半正定 Hessian 矩阵 $H \\in \\mathbb{R}^{n \\times n}$ 表示，作用于细尺度位移 $u_f \\in \\mathbb{R}^{n}$。物理位移由 $u \\in \\mathbb{R}^{n}$ 表示，并受跨尺度分解 $u = u_c + u_f$ 的约束。为防止在重叠区域中重复计算粗尺度模式，对于给定的线性算子 $Q \\in \\mathbb{R}^{m \\times n}$，施加正交性约束 $Q u = 0$。\n\n假设存在一个作用于物理位移的给定外力向量 $f \\in \\mathbb{R}^{n}$，并将待最小化的总能量定义为\n$$\nE(u_c,u_f) = \\frac{1}{2} u_c^{\\top} K u_c + \\frac{1}{2} u_f^{\\top} H u_f - f^{\\top} (u_c + u_f).\n$$\n针对约束 $u - u_c - u_f = 0$ 和 $Q u = 0$，分别引入拉格朗日乘子 $\\lambda \\in \\mathbb{R}^{n}$ 和 $\\mu \\in \\mathbb{R}^{m}$。构建增广未知向量 $U = (u_c^{\\top}, u_f^{\\top}, u^{\\top}, \\lambda^{\\top}, \\mu^{\\top})^{\\top}$。\n\n从经典力学和线性弹性力学中的约束最小化原理出发，推导一阶最优性 (Karush–Kuhn–Tucker) 条件，并将它们组合成一个关于 $U$ 的单一耦合线性系统。以 $K$、$H$、$Q$、$n \\times n$ 单位矩阵 $I$ 以及适当尺寸的零算子表示该耦合线性系统的显式分块系数矩阵，作为你的最终答案。你的最终答案必须是该分块矩阵的单一闭式解析表达式。不要包含任何数值。不要包含单位。不要提供右端向量或任何方程；只提供分块系数矩阵本身作为你的最终答案。",
            "solution": "问题陈述经审查有效。它提出了一个在计算力学和多尺度分析领域内适定的、有科学依据的客观问题。任务是使用拉格朗日乘子法，为一个约束能量最小化问题推导其控制线性系统。\n\n该问题要求最小化总能量泛函\n$$\nE(u_c, u_f) = \\frac{1}{2} u_c^{\\top} K u_c + \\frac{1}{2} u_f^{\\top} H u_f - f^{\\top} (u_c + u_f)\n$$\n受两个线性等式约束：\n1. 跨尺度分解：$u - u_c - u_f = 0$。\n2. 正交性约束：$Q u = 0$。\n\n为求解此约束优化问题，我们使用拉格朗日乘子 $\\lambda \\in \\mathbb{R}^{n}$ 和 $\\mu \\in \\mathbb{R}^{m}$，通过约束来增广能量泛函，从而构建拉格朗日函数 $\\mathcal{L}$。拉格朗日函数 $\\mathcal{L}$ 是主变量 $u_c$, $u_f$, $u$ 和乘子 $\\lambda$, $\\mu$ 的函数：\n$$\n\\mathcal{L}(u_c, u_f, u, \\lambda, \\mu) = E(u_c, u_f) + \\lambda^{\\top}(u - u_c - u_f) + \\mu^{\\top}(Q u)\n$$\n代入能量 $E(u_c, u_f)$ 的表达式，我们得到：\n$$\n\\mathcal{L}(u_c, u_f, u, \\lambda, \\mu) = \\frac{1}{2} u_c^{\\top} K u_c + \\frac{1}{2} u_f^{\\top} H u_f - f^{\\top} u_c - f^{\\top} u_f + \\lambda^{\\top} u - \\lambda^{\\top} u_c - \\lambda^{\\top} u_f + \\mu^{\\top} Q u\n$$\n最小化的一阶必要条件 (Karush–Kuhn–Tucker 或 KKT 条件) 是通过要求拉格朗日函数关于其每个变量的梯度为零向量来找到的。这将产生一个线性方程组。\n\n1.  **关于粗尺度位移 $u_c$ 的平稳性**：\n    我们计算 $\\mathcal{L}$ 关于 $u_c$ 的偏导数并令其为零。使用矩阵微积分恒等式 $\\nabla_x(\\frac{1}{2}x^{\\top}Ax) = Ax$ (对于对称矩阵 $A$) 和 $\\nabla_x(b^{\\top}x) = b$，我们得到：\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial u_c} = K u_c - f - \\lambda = 0\n    $$\n\n2.  **关于细尺度位移 $u_f$ 的平稳性**：\n    类似地，我们计算 $\\mathcal{L}$ 关于 $u_f$ 的偏导数：\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial u_f} = H u_f - f - \\lambda = 0\n    $$\n\n3.  **关于物理位移 $u$ 的平稳性**：\n    $\\mathcal{L}$ 关于 $u$ 的偏导数涉及含有 $\\lambda$ 和 $\\mu$ 的项：\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial u} = \\lambda + Q^{\\top}\\mu = 0\n    $$\n\n4.  **关于乘子 $\\lambda$ 的平稳性**：\n    关于拉格朗日乘子 $\\lambda$ 的偏导数恢复了第一个约束方程：\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = u - u_c - u_f = 0\n    $$\n\n5.  **关于乘子 $\\mu$ 的平稳性**：\n    关于拉格朗日乘子 $\\mu$ 的偏导数恢复了第二个约束方程：\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\mu} = Q u = 0\n    $$\n这五个向量方程构成一个耦合线性系统。我们可以将它们组合成形如 $\\mathcal{A} U = R$ 的单一分块矩阵方程，其中 $U = (u_c^{\\top}, u_f^{\\top}, u^{\\top}, \\lambda^{\\top}, \\mu^{\\top})^{\\top}$ 是增广未知向量，$\\mathcal{A}$ 是分块系数矩阵。为构建 $\\mathcal{A}$，我们排列这些方程，使得对应于 $U$ 各分量的项按列对齐。\n\n方程重排如下：\n(1) $K u_c + 0 \\cdot u_f + 0 \\cdot u - I \\lambda + 0 \\cdot \\mu = f$\n(2) $0 \\cdot u_c + H u_f + 0 \\cdot u - I \\lambda + 0 \\cdot \\mu = f$\n(3) $0 \\cdot u_c + 0 \\cdot u_f + 0 \\cdot u + I \\lambda + Q^{\\top} \\mu = 0$\n(4) $-I u_c - I u_f + I u + 0 \\cdot \\lambda + 0 \\cdot \\mu = 0$\n(5) $0 \\cdot u_c + 0 \\cdot u_f + Q u + 0 \\cdot \\lambda + 0 \\cdot \\mu = 0$\n\n此处，$I$ 是 $n \\times n$ 单位矩阵，$0$ 表示由分块结构的上下文确定的适当维度的零矩阵。因此，分块系数矩阵 $\\mathcal{A}$ 是根据每个方程中 $u_c$, $u_f$, $u$, $\\lambda$ 和 $\\mu$ 的系数逐行构建的。\n\n第一个分块行来自方程 (1)。\n第二个分块行来自方程 (2)。\n第三个分块行来自方程 (3)。\n第四个分块行来自方程 (4)。\n第五个分块行来自方程 (5)。\n\n这个组合过程得到以下分块矩阵：\n$$\n\\mathcal{A} =\n\\begin{pmatrix}\nK  & 0 & 0 & -I & 0 \\\\\n0 & H & 0 & -I & 0 \\\\\n0 & 0 & 0 & I & Q^{\\top} \\\\\n-I & -I & I & 0 & 0 \\\\\n0 & 0 & Q & 0 & 0\n\\end{pmatrix}\n$$\n这就是该耦合线性系统的显式分块系数矩阵，用给定的算子 $K$、$H$、$Q$、单位算子 $I$ 和零算子 $0$ 表示。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nK  & 0 & 0 & -I & 0 \\\\\n0 & H & 0 & -I & 0 \\\\\n0 & 0 & 0 & I & Q^{\\top} \\\\\n-I & -I & I & 0 & 0 \\\\\n0 & 0 & Q & 0 & 0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}