{
    "hands_on_practices": [
        {
            "introduction": "The local Quasicontinuum (QC) method derives its efficiency from the Cauchy-Born rule, which approximates the energy of a region by assuming the lattice deforms uniformly according to the macroscopic deformation gradient. This approximation, however, is fundamentally local and renders the model blind to discrete atomic features, such as point defects, that are smaller than the continuum mesh size. This practice  provides a foundational exercise in quantifying the error of the local QC method by calculating the so-called \"ghost force\"—a spurious, non-zero force that arises at a defect site even when the lattice is under a uniform strain that should correspond to equilibrium.",
            "id": "3775793",
            "problem": "Consider a one-dimensional chain of $N+1$ atoms with reference positions $X_i = i a$ for $i = 0, 1, \\dots, N$, where $a$ is the reference lattice spacing. The deformed positions are given by $y_i = (1+E) X_i$, where $E$ is a prescribed macroscopic strain. The atoms interact via nearest-neighbor harmonic springs with stiffness $k$ and rest length $a$, except for a single localized defect at the bond connecting atoms $m$ and $m+1$, where the rest length is $a + \\delta a$. Assume $1 \\le m \\le N-1$ so that both adjacent bonds exist. The chain is free of external body forces. \n\nThe Local Quasicontinuum (QC) method assumes the Cauchy-Born rule to derive a continuum energy density from the atomistic model, and uses a piecewise-linear displacement field on a coarse mesh of spacing $h$ to compute internal nodal forces. In this local approximation, the first Piola stress depends only on the local deformation gradient and not on nonlocal discrete features such as isolated defects that are smaller than the mesh size. \n\nYour task is to compute the error in the local QC prediction of the internal force at the defect atom indexed by $m$ by comparing:\n- the exact atomistic net force at atom $m$, obtained directly from the pairwise spring forces in the deformed configuration with the defective bond, and\n- the local QC predicted internal nodal force at the location of atom $m$, obtained from the continuum stress associated with the Cauchy-Born homogenization under the same macroscopic deformation and coarse mesh of size $h$.\n\nUse the following base principles:\n- Hooke’s law for a harmonic spring with rest length $r_0$: the force magnitude along the bond is proportional to the extension $r - r_0$, with proportionality constant $k$, and acts along the bond direction. In one dimension, the force on atom $i$ due to neighbor $i+1$ is equal to $-k \\left( (y_{i+1} - y_i) - r_0 \\right)$ and the force due to neighbor $i-1$ is equal to $+k \\left( (y_i - y_{i-1}) - r_0 \\right)$.\n- The Cauchy-Born rule for deriving a continuum energy density in one dimension from a nearest-neighbor harmonic chain with uniform rest length $a$ and stiffness $k$, and the computation of internal nodal forces in a piecewise-linear finite element discretization of spacing $h$ under a uniform deformation gradient.\n\nDefine the error magnitude as $e = \\left| f_m^{\\mathrm{A}} - f_m^{\\mathrm{QC}} \\right|$, where $f_m^{\\mathrm{A}}$ is the exact atomistic net force on atom $m$, and $f_m^{\\mathrm{QC}}$ is the local QC predicted internal nodal force at the position corresponding to atom $m$ under the same macroscopic deformation and mesh size $h$. Express the final error values in newtons, as floating-point decimals.\n\nImplement a program that computes $e$ for each of the following test cases. Each test case is specified by the tuple $(N, a, k, E, m, \\delta a, h)$:\n- Test case $1$: $(200, 2 \\times 10^{-10}, 30, 0.01, 100, 5 \\times 10^{-12}, 1 \\times 10^{-8})$.\n- Test case $2$: $(50, 1 \\times 10^{-10}, 100, 0.0, 25, 0, 5 \\times 10^{-9})$.\n- Test case $3$: $(100, 1.5 \\times 10^{-10}, 5, -0.02, 60, -1 \\times 10^{-12}, 1 \\times 10^{-9})$.\n- Test case $4$: $(1000, 1 \\times 10^{-10}, 1000, 0.005, 500, 2 \\times 10^{-12}, 5 \\times 10^{-8})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4]$), where each $r_i$ is the error magnitude $e$ in newtons corresponding to the $i$-th test case. No additional text should be printed.",
            "solution": "The problem statement has been validated and is determined to be scientifically grounded, well-posed, and self-contained. The provided data and conditions are sufficient and consistent for deriving a unique, meaningful solution.\n\nThe objective is to compute the error magnitude $e = |f_m^{\\mathrm{A}} - f_m^{\\mathrm{QC}}|$ between the exact atomistic force $f_m^{\\mathrm{A}}$ on atom $m$ and the force $f_m^{\\mathrm{QC}}$ predicted by the local Quasicontinuum (QC) method at the same location. The system is a one-dimensional atomic chain with a single bond defect, subjected to a uniform macroscopic strain.\n\nWe will compute the two forces, $f_m^{\\mathrm{A}}$ and $f_m^{\\mathrm{QC}}$, separately and then find the magnitude of their difference.\n\n**1. Calculation of the Exact Atomistic Force ($f_m^{\\mathrm{A}}$)**\n\nThe net force on an atom is the sum of the forces exerted on it by its nearest neighbors. For atom $m$, located at position $y_m$, the net force $f_m^{\\mathrm{A}}$ is the sum of the force from atom $m-1$ and the force from atom $m+1$.\n\nThe force exerted on atom $i$ by atom $j$ in a harmonic spring model is given by $F_{i \\leftarrow j} = -\\nabla_{y_i} U_{ij}$, where $U_{ij} = \\frac{1}{2} k \\left( (y_j - y_i) - r_0 \\right)^2$ is the potential energy of the bond between them. This yields a force directed along the bond. We can express the net force on atom $m$ as:\n$$\nf_m^{\\mathrm{A}} = F_{m \\leftarrow m+1} + F_{m \\leftarrow m-1}\n$$\nThe force from the neighbor at $m+1$ is $F_{m \\leftarrow m+1} = -\\frac{\\partial}{\\partial y_m} \\left( \\frac{1}{2} k \\left( (y_{m+1} - y_m) - r_{m,m+1} \\right)^2 \\right) = k \\left( (y_{m+1} - y_m) - r_{m,m+1} \\right)$.\nThe force from the neighbor at $m-1$ is $F_{m \\leftarrow m-1} = -\\frac{\\partial}{\\partial y_m} \\left( \\frac{1}{2} k \\left( (y_m - y_{m-1}) - r_{m-1,m} \\right)^2 \\right) = -k \\left( (y_m - y_{m-1}) - r_{m-1,m} \\right)$.\n\nSumming these gives the total force on atom $m$:\n$$\nf_m^{\\mathrm{A}} = k \\left( (y_{m+1} - y_m) - r_{m,m+1} \\right) - k \\left( (y_m - y_{m-1}) - r_{m-1,m} \\right)\n$$\n\nThe problem states that the deformed positions are prescribed as $y_i = (1+E) X_i = (1+E) i a$. Therefore, the distance between any two adjacent atoms in the deformed configuration is uniform:\n$$\ny_{i+1} - y_i = (1+E)(i+1)a - (1+E)ia = (1+E)a\n$$\nThis holds for both the $(m-1, m)$ and $(m, m+1)$ bonds.\n\nThe bond between atoms $m-1$ and $m$ is a regular bond, so its rest length is $r_{m-1,m} = a$. The bond between atoms $m$ and $m+1$ is the defective bond, with rest length $r_{m,m+1} = a + \\delta a$.\n\nSubstituting these expressions into the force equation:\n$$\nf_m^{\\mathrm{A}} = k \\left( (1+E)a - (a + \\delta a) \\right) - k \\left( (1+E)a - a \\right)\n$$\nSimplifying the terms in the parentheses:\n$$\nf_m^{\\mathrm{A}} = k \\left( a + Ea - a - \\delta a \\right) - k \\left( a + Ea - a \\right)\n$$\n$$\nf_m^{\\mathrm{A}} = k \\left( Ea - \\delta a \\right) - k \\left( Ea \\right)\n$$\n$$\nf_m^{\\mathrm{A}} = kEa - k\\delta a - kEa\n$$\nThis simplifies to a remarkably concise result for the exact atomistic force at the defect site:\n$$\nf_m^{\\mathrm{A}} = -k \\delta a\n$$\nThis non-zero force, often termed a \"ghost force\" in QC literature, arises because the prescribed uniform deformation is not an equilibrium state for the defective atomic chain.\n\n**2. Calculation of the Local Quasicontinuum Force ($f_m^{\\mathrm{QC}}$)**\n\nThe local QC method is founded on the Cauchy-Born rule, which postulates that the macroscopic deformation gradient at a point in the continuum applies locally to the underlying atomic lattice. This rule is used to derive a continuum strain energy density function $\\phi(F)$ from the atomistic potential, where $F$ is the deformation gradient. Crucially, in its local formulation, the QC method constructs this continuum model based on a *perfect, defect-free* reference lattice. It is inherently blind to localized defects, such as the single modified bond, that are smaller than the coarse-graining length scale $h$.\n\nFor a 1D chain with uniform bond stiffness $k$ and rest length $a$, the strain energy of a single bond deformed by a gradient $F$ is $U_{\\text{bond}} = \\frac{1}{2} k (Fa - a)^2$. The strain energy density (energy per unit reference length) is thus:\n$$\n\\phi(F) = \\frac{U_{\\text{bond}}}{a} = \\frac{k}{2a} (Fa - a)^2 = \\frac{ka}{2} (F-1)^2\n$$\nThe First Piola-Kirchhoff stress $P$ is the derivative of the energy density with respect to the deformation gradient:\n$$\nP(F) = \\frac{d\\phi}{dF} = ka(F-1)\n$$\nThe problem specifies a uniform macroscopic deformation, $y(X) = (1+E)X$. This corresponds to a constant deformation gradient $F = \\frac{dy}{dX} = 1+E$ everywhere in the continuum. The resulting stress in the QC model is therefore also uniform:\n$$\nP = ka((1+E) - 1) = kaE\n$$\nThe internal nodal force in a piecewise-linear finite element discretization is computed from the divergence of the stress. For any internal node in a 1D mesh under a constant stress field $P$ and with no body forces, the net internal force is zero. This is because the force contribution from the element to the left ($+P$) is exactly cancelled by the force contribution from the element to the right ($-P$). Since the atom $m$ is located in the interior of the chain ($1 \\le m \\le N-1$), the corresponding point in the continuum model is an internal point. Therefore, the predicted QC force is zero:\n$$\nf_m^{\\mathrm{QC}} = 0\n$$\n\n**3. Error Calculation**\n\nThe error magnitude $e$ is the absolute difference between the atomistic and QC forces:\n$$\ne = \\left| f_m^{\\mathrm{A}} - f_m^{\\mathrm{QC}} \\right|\n$$\nSubstituting the derived expressions for the forces:\n$$\ne = \\left| -k \\delta a - 0 \\right| = \\left| -k \\delta a \\right|\n$$\nThus, the final expression for the error magnitude is:\n$$\ne = |k \\delta a|\n$$\nThis result demonstrates that the error of the local QC method at the site of a bond defect is directly proportional to the bond stiffness $k$ and the magnitude of the defect in the rest length $\\delta a$. Notably, the error is independent of the chain length $N$, the lattice spacing $a$, the applied strain $E$, the defect location $m$, and the QC mesh size $h$. We now apply this formula to the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the error in the local QC prediction of the internal force at a defect atom.\n    The error is defined as e = |f_m^A - f_m^QC|, where f_m^A is the exact atomistic force\n    and f_m^QC is the local QC predicted force.\n\n    The derivation shows:\n    1. The exact atomistic force at the defect atom m is f_m^A = -k * delta_a.\n    2. The local QC force f_m^QC is 0 because it assumes a perfect lattice and sees a uniform\n       deformation gradient, resulting in zero net force at any internal node.\n    3. The error magnitude is e = |-k * delta_a - 0| = |k * delta_a|.\n\n    This error depends only on the spring stiffness k and the defect size delta_a, and is\n    independent of N, a, E, m, and h.\n    \"\"\"\n    \n    # Each test case is a tuple: (N, a, k, E, m, delta_a, h)\n    # N: total number of atoms is N+1\n    # a: reference lattice spacing (m)\n    # k: spring stiffness (N/m)\n    # E: macroscopic strain (dimensionless)\n    # m: index of the first atom in the defective bond (m, m+1)\n    # delta_a: change in rest length for the defective bond (m)\n    # h: coarse QC mesh spacing (m)\n    test_cases = [\n        (200, 2e-10, 30, 0.01, 100, 5e-12, 1e-8),\n        (50, 1e-10, 100, 0.0, 25, 0, 5e-9),\n        (100, 1.5e-10, 5, -0.02, 60, -1e-12, 1e-9),\n        (1000, 1e-10, 1000, 0.005, 500, 2e-12, 5e-8),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the parameters for clarity, though only k and delta_a are needed.\n        _N, _a, k, _E, _m, delta_a, _h = case\n        \n        # Calculate the error magnitude based on the derived formula e = |k * delta_a|.\n        # The result is in Newtons.\n        error = abs(k * delta_a)\n        \n        results.append(error)\n\n    # Format the final output as a comma-separated list in brackets,\n    # ensuring floating-point representation.\n    formatted_results = [f\"{res:.1e}\" if res != 0 else \"0.0\" for res in results]\n    # The problem asks for floating-point decimals. Using a more general format.\n    final_output_list = []\n    for res in results:\n        # Use a representation that avoids scientific notation for small numbers if possible\n        # but defaults to it for very small/large.\n        if res == 0.0:\n            final_output_list.append(\"0.0\")\n        else:\n            # A simple `str(res)` is sufficient to meet the \"floating-point decimal\" requirement.\n            final_output_list.append(str(res))\n            \n    print(f\"[{','.join(final_output_list)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "A critical component of any QC simulation is the interface between the fully atomistic and the coarse-grained continuum regions. Ghost forces are notoriously problematic at these interfaces, arising from the mismatch between the explicit atomistic forces on one side and the homogenized continuum stress on the other. This exercise  explores this issue directly by comparing a purely local interface treatment with a nonlocal \"bridging\" approach, where interactions crossing the interface are explicitly retained up to a certain range. You will derive and quantify how the magnitude of the ghost force depends on the range of atomic interactions and the size of this bridging region.",
            "id": "3775817",
            "problem": "Consider a one-dimensional crystalline chain with lattice spacing $a$ and atoms indexed by integers $i \\in \\mathbb{Z}$. The reference positions are $x_i = i a$, and we consider a uniform strain characterized by a displacement field $u_i = \\varepsilon x_i$ with strain parameter $\\varepsilon$ (dimensionless). The atoms interact via finite-range harmonic pair potentials up to an interaction range measured in neighbor shells $m = 1, 2, \\dots, M$, where the extension of the bond between atoms $i$ and $i+m$ is $(x_{i+m} + u_{i+m}) - (x_i + u_i) - m a$, and the pair contribution is governed by stiffness coefficients $k_m > 0$ that may depend on $m$.\n\nThe fully atomistic model on an infinite chain in uniform strain produces zero net internal force at each atom due to symmetry. In a Quasi-Continuum (QC) coupling, we partition the domain into an atomistic region and a continuum region, with an interface at a representative atom (denote it by $i = 0$ without loss of generality). In the local QC coupling, the continuum region is represented by a Cauchy-Born stress $\\sigma$ transmitted as a traction at the interface, rather than by explicit nonlocal bonds. In the nonlocal QC coupling, we introduce a bridging width $h$ (a physical length, equal to a multiple of the lattice spacing) near the interface on the continuum side where cross-interface bonds of range less than or equal to $h$ are retained atomistically, while longer-range bonds are replaced by continuum traction. The interaction range in physical units is $R = M a$.\n\nUsing only the following fundamental base:\n- Harmonic pair interaction energy for a bond of range $m$: the energy is quadratic in the bond extension with stiffness $k_m$.\n- The Cauchy-Born rule for a one-dimensional chain under uniform strain: the continuum energy density is obtained by summing the atomistic bond energies per unit length, and the first Piola stress $\\sigma$ is the derivative of the energy density with respect to strain.\n\nDefine the ghost force magnitude at the interface as the absolute value of the net residual force experienced by the interface atom under the imposed uniform strain when using the respective QC coupling. This residual arises because the continuum traction does not generally equal the discrete sum of missing cross-interface bond forces.\n\nYour tasks:\n1. For the local QC coupling, derive and implement a computation of the ghost force magnitude at the interface atom as a function of $a$, $\\varepsilon$, and $\\{k_m\\}_{m=1}^M$. Report the ghost force in nondimensional units.\n2. For the nonlocal QC coupling with bridging width $h$, derive and implement the ghost force magnitude at the interface atom as a function of $a$, $\\varepsilon$, $\\{k_m\\}_{m=1}^M$, and $h$. Report the ghost force in nondimensional units.\n3. Show how the ghost force magnitudes vary with interaction range $R$ (through $M$) and with element size (taken here as the bridging width $h$).\n\nTest Suite and Output Specification:\n- Use the following test cases, each specified by $(a, \\varepsilon, k\\_list, h)$ where $k\\_list$ is the list $\\{k_m\\}_{m=1}^M$:\n    1. $(a = 1.0, \\varepsilon = 0.01, k\\_list = [1.0, 0.5, 0.25, 0.125], h = 1.0)$ representing a decaying stiffness over $M = 4$ neighbor shells with a bridging width equal to one lattice spacing.\n    2. $(a = 1.0, \\varepsilon = 0.02, k\\_list = [2.0], h = 0.0)$ representing nearest-neighbor interaction ($M = 1$) and no bridging (pure local QC).\n    3. $(a = 0.5, \\varepsilon = 0.01, k\\_list = [1.0, 1.0, 1.0, 1.0, 1.0], h = 0.0)$ representing five neighbor shells with uniform stiffness and no bridging.\n    4. $(a = 1.0, \\varepsilon = 0.03, k\\_list = [1.0, 1.0, 1.0], h = 3.0)$ representing three neighbor shells with uniform stiffness and bridging width equal to three lattice spacings (which fully covers the interaction range).\n- For each test case, compute two quantities: the local QC ghost force magnitude and the nonlocal QC ghost force magnitude. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a two-element list $[G\\_{\\mathrm{local}}, G\\_{\\mathrm{nonlocal}}]$ for the corresponding test case (e.g., $\\texttt{[[v11,v12],[v21,v22],...]}$).\n\nAll reported forces must be given in nondimensional units. No angles are involved. Fractions or decimals are acceptable; do not use percentage signs anywhere in the output.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of multiscale modeling, specifically the Quasi-Continuum (QC) method. It is well-posed, providing all necessary definitions, constants, and boundary conditions to derive a unique solution. The language is objective and the requirements are formalizable into a solvable mathematical and computational problem.\n\nWe begin by deriving the expression for the ghost force at the interface between an atomistic and a continuum region. The system is a one-dimensional chain of atoms with lattice spacing $a$. The atoms interact via harmonic pair potentials up to a range of $M$ neighbor shells, with stiffness coefficients $k_m > 0$ for the $m$-th neighbor interaction. A uniform strain $\\varepsilon$ is applied, resulting in a displacement field $u_i = \\varepsilon x_i = \\varepsilon i a$ for an atom at reference position $x_i = i a$.\n\nThe current position of atom $i$ is $y_i = x_i + u_i = i a (1+\\varepsilon)$. The change in length (extension) of a bond between atom $i$ and atom $i+m$ is:\n$$ \\Delta L_m = y_{i+m} - y_i - m a = (i+m)a(1+\\varepsilon) - ia(1+\\varepsilon) - m a = m a \\varepsilon $$\nThe potential energy stored in this bond is given by the harmonic potential:\n$$ U_m = \\frac{1}{2} k_m (\\Delta L_m)^2 = \\frac{1}{2} k_m (m a \\varepsilon)^2 $$\nThe force exerted on atom $i$ by atom $j = i+m$ is $f_{i \\leftarrow j} = -\\frac{\\partial U_m}{\\partial y_i}$. The total potential energy involving $y_i$ is $U_{total} = \\dots + \\frac{1}{2} k_m(y_{i+m} - y_i - ma)^2 + \\frac{1}{2} k_m(y_i - y_{i-m} - ma)^2 + \\dots$.\nThe force on atom $i$ from atom $i+m$ is $f_{i \\leftarrow i+m} = k_m(y_{i+m} - y_i - ma) = k_m (ma\\varepsilon)$. This is a force in the positive direction.\nThe force on atom $i$ from atom $i-m$ is $f_{i \\leftarrow i-m} = -k_m(y_i - y_{i-m} - ma) = -k_m (ma\\varepsilon)$. This is a force in the negative direction.\nIn an infinite, fully atomistic chain, the total force on any atom $i$ must be zero due to symmetry. We verify this for atom $i=0$:\n$$ F_0^{\\text{full}} = \\sum_{m=1}^{M} (f_{0 \\leftarrow m} + f_{0 \\leftarrow -m}) = \\sum_{m=1}^{M} (k_m(ma\\varepsilon) - k_m(ma\\varepsilon)) = 0 $$\nThis balanced state is our reference. A ghost force arises when the QC approximation breaks this balance.\n\nNext, we derive the first Piola-Kirchhoff stress $\\sigma$ using the Cauchy-Born rule. The strain energy density $W(\\varepsilon)$ is the energy per unit reference length. In a 1D chain, this is the energy per atom divided by the lattice spacing $a$.\n$$ W(\\varepsilon) = \\frac{1}{a} \\left( \\frac{1}{2} \\sum_{m=1}^{M} (\\text{Energy of bonds to the right}) + \\frac{1}{2} \\sum_{m=1}^{M} (\\text{Energy of bonds to the left}) \\right) $$\nDue to symmetry, this simplifies to:\n$$ W(\\varepsilon) = \\frac{1}{a} \\sum_{m=1}^{M} U_m = \\frac{1}{a} \\sum_{m=1}^{M} \\frac{1}{2} k_m (m a \\varepsilon)^2 = \\frac{a \\varepsilon^2}{2} \\sum_{m=1}^{M} m^2 k_m $$\nThe stress is the derivative of the energy density with respect to strain:\n$$ \\sigma = \\frac{\\partial W}{\\partial \\varepsilon} = a \\varepsilon \\sum_{m=1}^{M} m^2 k_m $$\nThis stress represents the force transmitted by a continuum region that replaces part of the atomistic chain.\n\nFor the local QC coupling, the domain is partitioned at atom $i=0$. The region $i \\le 0$ is atomistic, and the region $i > 0$ is replaced by a continuum. The force on the interface atom $i=0$ is the sum of forces from its atomistic neighbors ($i<0$) and the traction from the continuum.\nThe force from the atomistic neighbors ($i<0$) is:\n$$ F_{\\text{left}} = \\sum_{m=1}^{M} f_{0 \\leftarrow -m} = \\sum_{m=1}^{M} -k_m(ma\\varepsilon) = -a \\varepsilon \\sum_{m=1}^{M} m k_m $$\nThe continuum exerts a traction equal to the Cauchy-Born stress $\\sigma$:\n$$ F_{\\text{right}} = \\sigma = a \\varepsilon \\sum_{m=1}^{M} m^2 k_m $$\nThe net residual force on atom $0$, which is the ghost force $F_{\\text{ghost}}^{\\text{local}}$, is the sum of these forces:\n$$ F_{\\text{ghost}}^{\\text{local}} = F_{\\text{left}} + F_{\\text{right}} = -a \\varepsilon \\sum_{m=1}^{M} m k_m + a \\varepsilon \\sum_{m=1}^{M} m^2 k_m = a \\varepsilon \\sum_{m=1}^{M} k_m (m^2 - m) $$\nThe magnitude of the local QC ghost force is therefore:\n$$ G_{\\text{local}} = |a \\varepsilon| \\sum_{m=1}^{M} k_m m(m-1) $$\nNote that for the nearest-neighbor interaction ($m=1$), the term $m(m-1)$ is zero, resulting in a zero ghost force.\n\nFor the nonlocal QC coupling, a bridging region of width $h$ is introduced. Cross-interface bonds with interaction range $ma \\le h$ are retained explicitly. Let $m_{\\text{bridge}} = \\lfloor h/a \\rfloor$ be the largest integer neighbor shell index whose interactions are fully inside the bridging region.\nThe force on atom $i=0$ is now composed of three parts:\n1.  Force from atomistic neighbors at $i<0$: $F_{\\text{left}} = -a \\varepsilon \\sum_{m=1}^{M} m k_m$.\n2.  Explicitly modeled forces from neighbors at $i>0$ for which $ma \\le h$ (i.e., $m \\le m_{\\text{bridge}}$): $F_{\\text{right, explicit}} = \\sum_{m=1}^{m_{\\text{bridge}}} f_{0 \\leftarrow m} = a \\varepsilon \\sum_{m=1}^{m_{\\text{bridge}}} m k_m$.\n3.  A continuum traction that replaces the long-range bonds for which $ma > h$ (i.e., $m > m_{\\text{bridge}}$). The stress for this traction, $\\sigma_{\\text{long}}$, is derived from an energy density that only includes these long-range bonds:\n    $$ W_{\\text{long}}(\\varepsilon) = \\frac{a \\varepsilon^2}{2} \\sum_{m=m_{\\text{bridge}}+1}^{M} m^2 k_m \\implies \\sigma_{\\text{long}} = a \\varepsilon \\sum_{m=m_{\\text{bridge}}+1}^{M} m^2 k_m $$\nThe nonlocal ghost force is the sum of these contributions:\n$$ F_{\\text{ghost}}^{\\text{nonlocal}} = F_{\\text{left}} + F_{\\text{right, explicit}} + \\sigma_{\\text{long}} $$\n$$ F_{\\text{ghost}}^{\\text{nonlocal}} = \\left(-a \\varepsilon \\sum_{m=1}^{M} m k_m\\right) + \\left(a \\varepsilon \\sum_{m=1}^{m_{\\text{bridge}}} m k_m\\right) + \\left(a \\varepsilon \\sum_{m=m_{\\text{bridge}}+1}^{M} m^2 k_m\\right) $$\nBy splitting the first sum at $m_{\\text{bridge}}$:\n$$ F_{\\text{ghost}}^{\\text{nonlocal}} = a \\varepsilon \\left[ \\left(-\\sum_{m=1}^{m_{\\text{bridge}}} m k_m - \\sum_{m=m_{\\text{bridge}}+1}^{M} m k_m\\right) + \\sum_{m=1}^{m_{\\text{bridge}}} m k_m + \\sum_{m=m_{\\text{bridge}}+1}^{M} m^2 k_m \\right] $$\n$$ F_{\\text{ghost}}^{\\text{nonlocal}} = a \\varepsilon \\left[ -\\sum_{m=m_{\\text{bridge}}+1}^{M} m k_m + \\sum_{m=m_{\\text{bridge}}+1}^{M} m^2 k_m \\right] = a \\varepsilon \\sum_{m=m_{\\text{bridge}}+1}^{M} k_m (m^2 - m) $$\nThe magnitude of the nonlocal QC ghost force is:\n$$ G_{\\text{nonlocal}} = |a \\varepsilon| \\sum_{m=m_{\\text{bridge}}+1}^{M} k_m m(m-1) \\quad \\text{where} \\quad m_{\\text{bridge}} = \\lfloor h/a \\rfloor $$\nThis formulation correctly captures the behavior with respect to the interaction range $R=Ma$ and the bridging width $h$. The local ghost force $G_{\\text{local}}$ generally increases with $M$ as more long-range bonds contribute to the force/stress mismatch. The nonlocal ghost force $G_{\\text{nonlocal}}$ decreases as the bridging width $h$ increases, because more bonds are treated explicitly, reducing the summation range. If $h \\ge Ma$, then $m_{\\text{bridge}} \\ge M$, the sum becomes empty, and $G_{\\text{nonlocal}} = 0$, correctly reflecting that no approximation is made and the atomistic force balance is recovered. The local QC case is recovered by setting $h=0$, which gives $m_{\\text{bridge}}=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for local and nonlocal QC ghost forces for a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, epsilon, k_list, h)\n    test_cases = [\n        (1.0, 0.01, [1.0, 0.5, 0.25, 0.125], 1.0),\n        (1.0, 0.02, [2.0], 0.0),\n        (0.5, 0.01, [1.0, 1.0, 1.0, 1.0, 1.0], 0.0),\n        (1.0, 0.03, [1.0, 1.0, 1.0], 3.0),\n    ]\n\n    results = []\n    for a, eps, k_list, h in test_cases:\n        # Maximum neighbor shell index M\n        M = len(k_list)\n        \n        # Pre-calculate the common factor |a * epsilon|\n        abs_a_eps = abs(a * eps)\n\n        # --- Local QC Ghost Force Calculation ---\n        # G_local = |a*eps| * sum_{m=1 to M} [k_m * m * (m-1)]\n        local_sum = 0.0\n        for m_idx, k_m in enumerate(k_list):\n            m = m_idx + 1  # m is 1-based index for neighbor shell\n            local_sum += k_m * m * (m - 1)\n        G_local = abs_a_eps * local_sum\n\n        # --- Nonlocal QC Ghost Force Calculation ---\n        # m_bridge is the largest integer m such that m*a <= h\n        # This is equivalent to m <= h/a, so m_bridge = floor(h/a)\n        if a == 0:\n            m_bridge = float('inf') if h >= 0 else 0\n        else:\n            m_bridge = int(np.floor(h / a))\n        \n        # G_nonlocal = |a*eps| * sum_{m=m_bridge+1 to M} [k_m * m * (m-1)]\n        nonlocal_sum = 0.0\n        # The sum starts from the first neighbor shell NOT covered by the bridging region.\n        # The loop range for m_idx (0-based) must correspond to m (1-based) from m_bridge + 1 to M.\n        # So, m_idx runs from m_bridge to M-1.\n        if m_bridge < M:\n            for m_idx in range(m_bridge, M):\n                 m = m_idx + 1\n                 k_m = k_list[m_idx]\n                 nonlocal_sum += k_m * m * (m - 1)\n        \n        G_nonlocal = abs_a_eps * nonlocal_sum\n        \n        results.append([G_local, G_nonlocal])\n\n    # Final print statement in the exact required format.\n    # Example: [[v11,v12],[v21,v22],...]\n    print(f\"[{','.join([f'[{v1},{v2}]' for v1, v2 in results])}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "The errors introduced by inconsistent local approximations extend beyond spurious forces at equilibrium; they can lead to dangerously incorrect predictions of the stress field under applied loads. When materials have significant long-range interactions, a naive local QC model that truncates these interactions at the interface fails to properly transmit stress. This hands-on practice  guides you through a numerical experiment to demonstrate how this inconsistency creates an artificial stress concentration in the bonds nearest to the interface, a critical modeling artifact that can precipitate premature failure in simulations.",
            "id": "3775806",
            "problem": "Consider a one-dimensional lattice model for a QuasiContinuum (QC) method. QuasiContinuum (QC) refers to multiscale coupling between atomistic and continuum representations. Let there be a chain of $N+1$ atoms with reference positions $X_i = i$ for $i = 0, 1, \\dots, N$, unit spacing, and unknown displacements $u_i$ so that the deformed positions are $Y_i = X_i + u_i$. The interactions are harmonic and include both nearest-neighbor and second-neighbor springs. The nearest-neighbor springs connect atom $i$ to atom $i+1$ with stiffness $k_1$, while the second-neighbor springs connect atom $i$ to atom $i+2$ with stiffness $k_2$. The harmonic pair interaction energy between atoms $i$ and $j$ is given by $E_{ij} = \\frac{1}{2} k_{ij} (u_j - u_i)^2$ where $k_{ij}$ is the appropriate spring stiffness.\n\nThe mixed boundary conditions are: fixed displacement at the left end $u_0 = 0$ (Dirichlet) and applied traction at the right end represented as an external force $T$ applied to atom $N$ (Neumann). All quantities are dimensionless.\n\nDefine two QC models:\n- A \"nonlocal QC\" model that retains both nearest-neighbor and second-neighbor springs throughout the entire chain.\n- A \"local QC\" model that retains nearest-neighbor springs throughout the entire chain but includes second-neighbor springs only within an atomistic subregion $i \\leq M$ (i.e., only for pairs $(i, i+2)$ with $i \\leq M-2$). Second-neighbor springs that cross the interface at $i = M$ are omitted in the local QC model, producing an inconsistent representation of bonds at the interface.\n\nStarting from the principle of minimum potential energy for linear springs and the definition of mixed boundary conditions, you must:\n- Formulate the discrete equilibrium by minimizing the total energy (equivalently solving the linear system obtained from the first-order optimality conditions) for both models.\n- Implement the assembly of the stiffness matrix $K$ for each model using the rule that a harmonic pair between indices $i$ and $j$ contributes $+k$ to the diagonal entries $(i,i)$ and $(j,j)$ and $-k$ to the off-diagonal entries $(i,j)$ and $(j,i)$, and that the external traction is represented by a force vector with entry $f_N = T$ and zeros elsewhere.\n- Enforce the Dirichlet boundary condition $u_0 = 0$ by standard elimination of the constrained degree of freedom.\n\nTo diagnose stress concentration at the interface due to inconsistent bond representation in the local QC model, consider the cut between atoms $M$ and $M+1$. The traction transmitted across this cut equals the sum of tensile forces in all bonds that cross the cut. In one dimension, for the nonlocal QC model, the bonds that cross the cut at $i = M$ are:\n- The nearest-neighbor bond $(M, M+1)$ with force $f_{M,M+1}^{(1)} = k_1 (u_{M+1} - u_M)$,\n- The second-neighbor bond $(M-1, M+1)$ (if $M-1 \\geq 0$) with force $f_{M-1,M+1}^{(2)} = k_2 (u_{M+1} - u_{M-1})$,\n- The second-neighbor bond $(M, M+2)$ (if $M+2 \\leq N$) with force $f_{M,M+2}^{(2)} = k_2 (u_{M+2} - u_M)$.\n\nIn the local QC model, only the nearest-neighbor bond $(M, M+1)$ crosses the cut, because second-neighbor bonds crossing the interface are omitted by construction. Define the interface concentration factor for each model as the ratio of the maximum absolute bond force crossing the cut to the applied traction:\n$$\nC_{\\text{nonlocal}} = \\frac{\\max \\{ |f_{M,M+1}^{(1)}|, |f_{M-1,M+1}^{(2)}| \\text{ if present}, |f_{M,M+2}^{(2)}| \\text{ if present} \\}}{T}, \\quad\nC_{\\text{local}} = \\frac{|f_{M,M+1}^{(1)}|}{T}.\n$$\nDefine the amplification factor as\n$$\nA = \\frac{C_{\\text{local}}}{C_{\\text{nonlocal}}}.\n$$\nA value $A > 1$ indicates stress concentration in the local QC model relative to the nonlocal QC model at the interface.\n\nYour task is to write a complete, runnable program that:\n- Assembles and solves the linear systems for $u$ for each model,\n- Computes the bond forces crossing the interface cut at $i = M$ for each model,\n- Computes $A$ for each of the following test cases.\n\nUse the following test suite of parameters $(N, M, k_1, k_2, T)$:\n- Case $1$: $(N, M, k_1, k_2, T) = (50, 10, 1.0, 0.25, 0.1)$,\n- Case $2$: $(N, M, k_1, k_2, T) = (50, 10, 1.0, 0.0, 0.1)$,\n- Case $3$: $(N, M, k_1, k_2, T) = (20, 1, 1.0, 0.5, 10^{-6})$,\n- Case $4$: $(N, M, k_1, k_2, T) = (10, 8, 1.0, 0.3, 0.2)$,\n- Case $5$: $(N, M, k_1, k_2, T) = (6, 0, 1.0, 0.4, 0.2)$.\n\nAll outputs are dimensionless floats. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), where the entries are the amplification factors $A$ computed for each case in the given order. No additional text should be printed.",
            "solution": "The problem requires an analysis of stress concentration at the interface of a one-dimensional QuasiContinuum (QC) model by comparing a \"local\" and a \"nonlocal\" energy formulation. The analysis proceeds from the fundamental principle of minimum potential energy for a discrete system of atoms connected by harmonic springs.\n\n### 1. Formulation from Principle of Minimum Potential energy\n\nThe system consists of $N+1$ atoms with reference positions $X_i = i$ for $i \\in \\{0, 1, \\dots, N\\}$ and unknown displacements $u_i$. The total potential energy $\\Pi$ of the system is the sum of the stored strain energy $E$ from the springs and the potential of the external forces, $W_{ext}$.\n$$\n\\Pi(\\mathbf{u}) = E(\\mathbf{u}) - W_{ext}(\\mathbf{u})\n$$\nwhere $\\mathbf{u} = (u_0, u_1, \\dots, u_N)^T$ is the vector of all atomic displacements. The strain energy $E$ is the sum of energies of all interacting pairs $(i,j)$:\n$$\nE(\\mathbf{u}) = \\sum_{(i,j) \\in \\mathcal{S}} \\frac{1}{2} k_{ij} (u_j - u_i)^2\n$$\nwhere $\\mathcal{S}$ is the set of all interacting pairs and $k_{ij}$ is the corresponding spring stiffness. The potential of the external forces is given by $W_{ext}(\\mathbf{u}) = \\sum_{i=0}^{N} f_i u_i$. In this problem, a single traction force $T$ is applied at atom $N$, so the external force vector $\\mathbf{f}_{ext}$ has components $(f_{ext})_i = T \\delta_{iN}$, where $\\delta_{iN}$ is the Kronecker delta. Thus, $W_{ext}(\\mathbf{u}) = T u_N$.\n\nThe state of static equilibrium corresponds to a minimum of the total potential energy $\\Pi$. The first-order necessary conditions for a minimum are that the partial derivatives of $\\Pi$ with respect to each free displacement are zero. The displacement $u_0$ is fixed ($u_0=0$), so the free displacements are $u_1, \\dots, u_N$. For $i \\in \\{1, \\dots, N\\}$, the equilibrium equations are:\n$$\n\\frac{\\partial \\Pi}{\\partial u_i} = \\frac{\\partial E}{\\partial u_i} - \\frac{\\partial W_{ext}}{\\partial u_i} = 0\n$$\nThis leads to the system of equations:\n$$\n\\frac{\\partial E}{\\partial u_i} = (f_{ext})_i \\quad \\text{for } i=1, \\dots, N\n$$\nSince the energy $E$ is a quadratic form of the displacements, its derivatives are linear functions of $\\mathbf{u}$. This results in a linear system of equations of the form $\\mathbf{K} \\mathbf{u}_{free} = \\mathbf{f}_{free}$, where $\\mathbf{u}_{free} = (u_1, \\dots, u_N)^T$. The matrix $\\mathbf{K}$ is the stiffness matrix, and its entries are given by $K_{ij} = \\frac{\\partial^2 E}{\\partial u_i \\partial u_j}$ for $i,j \\in \\{1, \\dots, N\\}$. The vector $\\mathbf{f}_{free}$ is the sub-vector of $\\mathbf{f}_{ext}$ corresponding to the free degrees of freedom.\n\n### 2. Stiffness Matrix Assembly\n\nThe stiffness matrix can be assembled by considering the contribution of each spring. A single spring with stiffness $k$ connecting atoms $i$ and $j$ has energy $E_{ij} = \\frac{1}{2}k(u_j-u_i)^2$. Its contribution to the force on atom $i$ is $-\\frac{\\partial E_{ij}}{\\partial u_i} = k(u_j-u_i)$, and on atom $j$ is $-\\frac{\\partial E_{ij}}{\\partial u_j} = k(u_i-u_j)$. This corresponds to adding a $2 \\times 2$ block matrix $\\begin{pmatrix} k & -k \\\\ -k & k \\end{pmatrix}$ to the rows and columns $i, j$ of the global stiffness matrix. This is equivalent to the rule provided: add $k$ to the diagonal elements $K_{ii}$ and $K_{jj}$, and subtract $k$ from the off-diagonal elements $K_{ij}$ and $K_{ji}$.\n\nWe first construct the full $(N+1) \\times (N+1)$ stiffness matrix, $\\mathbf{K}_{full}$, for all degrees of freedom $u_0, \\dots, u_N$.\n\n**Nonlocal QC Model:**\nAll nearest-neighbor ($k_1$) and second-neighbor ($k_2$) interactions are present.\n- For nearest-neighbor springs $(i, i+1)$ with stiffness $k_1$, where $i = 0, \\dots, N-1$:\n  - Add $k_1$ to $K_{full}[i,i]$ and $K_{full}[i+1,i+1]$.\n  - Subtract $k_1$ from $K_{full}[i,i+1]$ and $K_{full}[i+1,i]$.\n- For second-neighbor springs $(i, i+2)$ with stiffness $k_2$, where $i = 0, \\dots, N-2$:\n  - Add $k_2$ to $K_{full}[i,i]$ and $K_{full}[i+2,i+2]$.\n  - Subtract $k_2$ from $K_{full}[i,i+2]$ and $K_{full}[i+2,i]$.\n\n**Local QC Model:**\nNearest-neighbor interactions are present everywhere, but second-neighbor interactions are restricted to the \"atomistic\" region $i \\leq M$.\n- The nearest-neighbor contributions are identical to the nonlocal model.\n- For second-neighbor springs $(i, i+2)$ with stiffness $k_2$, where $i = 0, \\dots, M-2$:\n  - Add $k_2$ to $K_{full}[i,i]$ and $K_{full}[i+2,i+2]$.\n  - Subtract $k_2$ from $K_{full}[i,i+2]$ and $K_{full}[i+2,i]$.\nNote that second-neighbor bonds for which $i > M-2$ are omitted. This includes bonds that would cross the interface at $M$, such as $(M-1, M+1)$ and $(M, M+2)$.\n\n### 3. System Reduction and Solution\n\nThe Dirichlet boundary condition $u_0 = 0$ is enforced by eliminating the first row and column of the full stiffness matrix. The system to be solved for the unknown displacements $\\mathbf{u}_{free} = (u_1, \\dots, u_N)^T$ is:\n$$\n\\mathbf{K} \\mathbf{u}_{free} = \\mathbf{f}_{free}\n$$\nwhere $\\mathbf{K}$ is the $N \\times N$ submatrix of $\\mathbf{K}_{full}$ corresponding to indices $1, \\dots, N$. The force vector $\\mathbf{f}_{free}$ is of size $N$, with its last element equal to $T$ (corresponding to atom $N$) and all other elements equal to zero.\n$$\n\\mathbf{f}_{free} = (0, 0, \\dots, 0, T)^T\n$$\nThis linear system is solved for $\\mathbf{u}_{free}$ for both the local and nonlocal models. The full displacement vector is then constructed as $\\mathbf{u} = (0, u_1, \\dots, u_N)^T$.\n\n### 4. Calculation of Amplification Factor\n\nOnce the displacement field $\\mathbf{u}$ is known for each model, the forces in the bonds crossing the interface cut between atoms $M$ and $M+1$ are computed.\n\n**For the Nonlocal Model:**\nThe displacements $\\mathbf{u}_{\\text{nonlocal}}$ are used. The forces are:\n- $f_{M,M+1}^{(1)} = k_1 (u_{M+1} - u_M)$\n- $f_{M-1,M+1}^{(2)} = k_2 (u_{M+1} - u_{M-1})$, if $M-1 \\geq 0$\n- $f_{M,M+2}^{(2)} = k_2 (u_{M+2} - u_M)$, if $M+2 \\leq N$\nThe interface concentration factor is:\n$$\nC_{\\text{nonlocal}} = \\frac{\\max \\{ |f_{M,M+1}^{(1)}|, |f_{M-1,M+1}^{(2)}|, |f_{M,M+2}^{(2)}| \\}}{T}\n$$\nwhere only the forces for existing bonds are considered in the maximum.\n\n**For the Local Model:**\nThe displacements $\\mathbf{u}_{\\text{local}}$ are used. By construction of the model, only the nearest-neighbor bond crosses the interface:\n- $f_{M,M+1}^{(1)} = k_1 (u_{M+1} - u_M)$\nThe interface concentration factor is:\n$$\nC_{\\text{local}} = \\frac{|f_{M,M+1}^{(1)}|}{T}\n$$\n\nFinally, the amplification factor $A$ is calculated as the ratio:\n$$\nA = \\frac{C_{\\text{local}}}{C_{\\text{nonlocal}}}\n$$\nA value of $A=1$ indicates no relative stress concentration, whereas $A>1$ signifies that the local QC model artifactually concentrates stress at the interface compared to the fully nonlocal (and more physically consistent) model. The case $k_2=0$ serves as a reference where both models are identical, yielding $A=1$. The algorithm is implemented for each test case to compute the corresponding value of $A$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef assemble_stiffness_matrix(N, M, k1, k2, is_nonlocal):\n    \"\"\"\n    Assembles the full (N+1)x(N+1) stiffness matrix.\n    \n    Args:\n        N (int): Number of free atoms. Total atoms are N+1.\n        M (int): Index of the atom at the atomistic/continuum interface.\n        k1 (float): Stiffness of nearest-neighbor springs.\n        k2 (float): Stiffness of second-neighbor springs.\n        is_nonlocal (bool): True for nonlocal model, False for local model.\n        \n    Returns:\n        numpy.ndarray: The (N+1)x(N+1) stiffness matrix.\n    \"\"\"\n    num_dofs = N + 1\n    K_full = np.zeros((num_dofs, num_dofs))\n\n    # Add nearest-neighbor contributions (always present)\n    for i in range(num_dofs - 1):\n        K_full[i, i] += k1\n        K_full[i + 1, i + 1] += k1\n        K_full[i, i + 1] -= k1\n        K_full[i + 1, i] -= k1\n\n    # Add second-neighbor contributions based on model type\n    if k2 > 0:\n        if is_nonlocal:\n            # Nonlocal model: SN springs everywhere\n            limit = num_dofs - 2\n        else:\n            # Local model: SN springs only for i <= M-2\n            limit = M - 2 + 1 # range is exclusive at the end\n        \n        for i in range(limit):\n            if i + 2 < num_dofs:\n                K_full[i, i] += k2\n                K_full[i + 2, i + 2] += k2\n                K_full[i, i + 2] -= k2\n                K_full[i + 2, i] -= k2\n                \n    return K_full\n\ndef solve_displacements(N, M, k1, k2, T, is_nonlocal):\n    \"\"\"\n    Solves for the atomic displacements for a given model.\n    \"\"\"\n    # 1. Assemble the full stiffness matrix\n    K_full = assemble_stiffness_matrix(N, M, k1, k2, is_nonlocal)\n    \n    # 2. Apply Dirichlet boundary condition u_0 = 0 by static condensation\n    # The reduced system is for DOFs 1 to N\n    K_reduced = K_full[1:, 1:]\n    \n    # 3. Create the force vector for the reduced system\n    f_reduced = np.zeros(N)\n    if N > 0:\n        f_reduced[-1] = T\n        \n    # 4. Solve the linear system K_reduced * u_free = f_reduced\n    if N > 0:\n        u_free = np.linalg.solve(K_reduced, f_reduced)\n    else: # N=0 case, only atom 0 exists, u_0=0\n        u_free = np.array([])\n        \n    # 5. Reconstruct the full displacement vector\n    u_full = np.concatenate(([0.0], u_free))\n    \n    return u_full\n\ndef compute_amplification_factor(N, M, k1, k2, T):\n    \"\"\"\n    Computes the amplification factor A for a given set of parameters.\n    \"\"\"\n    # Handle the trivial case where T=0 to avoid division by zero\n    if T == 0.0:\n        return 1.0 # No forces, so no concentration, ratio is 1.\n\n    # --- Nonlocal Model ---\n    u_nonlocal = solve_displacements(N, M, k1, k2, T, is_nonlocal=True)\n    \n    nonlocal_forces = []\n    # Nearest-neighbor force\n    if M + 1 <= N:\n        f1_nl = k1 * (u_nonlocal[M + 1] - u_nonlocal[M])\n        nonlocal_forces.append(abs(f1_nl))\n    \n    # Second-neighbor forces\n    if k2 > 0:\n        # Bond (M-1, M+1)\n        if M - 1 >= 0 and M + 1 <= N:\n            f2_nl_1 = k2 * (u_nonlocal[M + 1] - u_nonlocal[M - 1])\n            nonlocal_forces.append(abs(f2_nl_1))\n        # Bond (M, M+2)\n        if M + 2 <= N:\n            f2_nl_2 = k2 * (u_nonlocal[M + 2] - u_nonlocal[M])\n            nonlocal_forces.append(abs(f2_nl_2))\n    \n    if not nonlocal_forces: # If no bonds cross the cut (e.g., M=N)\n        max_abs_force_nl = 0.0\n    else:\n        max_abs_force_nl = max(nonlocal_forces)\n\n    C_nonlocal = max_abs_force_nl / T\n\n    # --- Local Model ---\n    u_local = solve_displacements(N, M, k1, k2, T, is_nonlocal=False)\n    \n    # Only nearest-neighbor force crosses the cut\n    if M + 1 <= N:\n        f1_l = k1 * (u_local[M + 1] - u_local[M])\n        max_abs_force_l = abs(f1_l)\n    else:\n        max_abs_force_l = 0.0\n\n    C_local = max_abs_force_l / T\n\n    # Special case: If C_nonlocal is zero (or very close), the amplification is ill-defined.\n    # This happens if T > 0 but no forces develop at the interface, which is unlikely for a stable system.\n    # A safe approach is to return 1.0, implying no \"amplification\".\n    if C_nonlocal == 0:\n        return 1.0\n\n    A = C_local / C_nonlocal\n    return A\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, M, k1, k2, T)\n        (50, 10, 1.0, 0.25, 0.1),\n        (50, 10, 1.0, 0.0, 0.1),\n        (20, 1, 1.0, 0.5, 1e-6),\n        (10, 8, 1.0, 0.3, 0.2),\n        (6, 0, 1.0, 0.4, 0.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, M, k1, k2, T = case\n        result = compute_amplification_factor(N, M, k1, k2, T)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}