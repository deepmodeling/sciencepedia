{
    "hands_on_practices": [
        {
            "introduction": "在我们用一个等效的均质模型替代复杂的非均质材料之前，首先必须确保微观和宏观尺度之间存在明确的分离。本练习  提供了一个具体情景，让您练习如何从物理描述中识别微观与宏观特征长度，并计算验证均匀化方法适用性的无量纲参数。这是任何多尺度分析的基石。",
            "id": "3779103",
            "problem": "一根长度为 $L$、具有周期性微观结构的非均质弹性杆，受到一个空间变化的宏观体力作用，该力的特征波长记为 $\\lambda$。杆的非均質刚度由系数 $A(y)$ 建模，该系数在其自变量 $y$ 上是光滑、有界且周期为 1 的。微观非均质性通过标度变换 $y = x / \\ell$ 进入静态平衡的强形式，其中 $\\ell$ 是特征晶粒尺寸。准静态位移场 $u(x)$ 由以下一维椭圆边值问题控制：\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( A\\!\\left(\\frac{x}{\\ell}\\right) \\frac{\\mathrm{d}u(x)}{\\mathrm{d}x} \\right) = f(x),\n$$\n其中 $f(x)$ 是宏观作用力，其空间变化由波长 $\\lambda$ 表征，因此 $f$ 在 $\\lambda$ 量级的距离上发生显著变化。在均匀化理论中，将非均质介质替换为等效均质介质的有效性，取决于是否存在一个小的无量纲参数，该参数表达了微观和宏观长度尺度之间的明确分离。\n\n从该控制方程出发，使用基于宏观波长 $\\lambda$（而非杆长 $L$）的无量纲化方法，推导在此情况下量化微观-宏观尺度分离的合适的小无量纲参数。然后，使用给定数据 $L = 10\\,\\mathrm{mm}$、$\\ell = 10\\,\\mu\\mathrm{m}$ 和外加场的 $\\lambda = 1\\,\\mathrm{mm}$，计算其数值。最后，通过解释所推导参数的量级，评估在尺度分离意义下均匀化的渐近有效性，但对于最终报告的结果，仅提供该无量纲参数的值。\n\n将最终数值四舍五入至四位有效数字。以无量纲数的形式表示答案。",
            "solution": "问题要求推导量化一维非均质弹性杆微观-宏观尺度分离的小无量纲参数，并随后进行数值计算。\n\n杆的静态平衡控制方程如下：\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( A\\!\\left(\\frac{x}{\\ell}\\right) \\frac{\\mathrm{d}u(x)}{\\mathrm{d}x} \\right) = f(x)\n$$\n此处，$x$ 是沿杆长的空间坐标。该问题涉及三个不同的长度尺度：\n1.  微观非均质性的特征尺寸，或晶粒尺寸，$\\ell$。\n2.  宏观体力的特征波长 $\\lambda$，它决定了宏观场（如作用力 $f(x)$ 和产生的位移场 $u(x)$）发生显著变化的长度尺度。\n3.  杆的总长度，$L$。\n\n在均匀化理论中，将非均质介质替换为等效均质介质的可能性依赖于清晰的尺度分离。这在数学上由一个小的无量纲参数表示，通常记为 $\\epsilon$，它是特征微观长度尺度与特征宏观长度尺度的比值。\n\n在本问题中，微观长度尺度明确确定为 $\\ell$。如题所述，宏观长度尺度是所施加载荷的特征波长 $\\lambda$。因此，无量纲参数 $\\epsilon$ 定义为：\n$$\n\\epsilon = \\frac{\\ell}{\\lambda}\n$$\n均匀化有效的条件是该参数必须远小于 1，即 $\\epsilon \\ll 1$。\n\n为了从控制方程中正式推导这一点，我们按照指示，基于宏观长度尺度 $\\lambda$ 进行无量纲化。我们引入一个由下式定义的无量纲空间坐标 $\\bar{x}$：\n$$\n\\bar{x} = \\frac{x}{\\lambda} \\implies x = \\lambda \\bar{x}\n$$\n使用链式法则，关于 $x$ 的导数可以转换为关于 $\\bar{x}$ 的导数：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x} = \\frac{\\mathrm{d}\\bar{x}}{\\mathrm{d}x} \\frac{\\mathrm{d}}{\\mathrm{d}\\bar{x}} = \\frac{1}{\\lambda} \\frac{\\mathrm{d}}{\\mathrm{d}\\bar{x}}\n$$\n接下来，我们考察快速振荡刚度系数 $A(x/\\ell)$ 的自变量。用新的无量纲坐标 $\\bar{x}$ 表示，该自变量变为：\n$$\n\\frac{x}{\\ell} = \\frac{\\lambda \\bar{x}}{\\ell} = \\frac{1}{\\ell/\\lambda} \\bar{x}\n$$\n代入我们的定义 $\\epsilon = \\ell/\\lambda$，自变量为 $\\bar{x}/\\epsilon$。这代表“快”空间变量，相对于“慢”宏观变量 $\\bar{x}$，它快速变化（变化因子为 $1/\\epsilon$）。\n\n将这些变换代入控制微分方程，得到：\n$$\n- \\left( \\frac{1}{\\lambda} \\frac{\\mathrm{d}}{\\mathrm{d}\\bar{x}} \\right) \\left( A\\!\\left(\\frac{\\bar{x}}{\\epsilon}\\right) \\left( \\frac{1}{\\lambda} \\frac{\\mathrm{d}u}{\\mathrm{d}\\bar{x}} \\right) \\right) = f(\\lambda\\bar{x})\n$$\n两边同乘以 $\\lambda^2$ 得到：\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}\\bar{x}} \\left( A\\!\\left(\\frac{\\bar{x}}{\\epsilon}\\right) \\frac{\\mathrm{d}u}{\\mathrm{d}\\bar{x}} \\right) = \\lambda^2 f(\\lambda\\bar{x})\n$$\n这个重标度的方程凸显了问题的双尺度特性。解 $u$ 和右侧的力项在 $\\bar{x}$ 为 1 量级的宏观尺度上变化。相比之下，刚度系数 $A$ 在由快变量 $\\bar{y} = \\bar{x}/\\epsilon$ 控制的微观尺度上变化。参数 $\\epsilon = \\ell/\\lambda$ 正是使这种尺度分离形式化的无量纲量。一个小的 $\\epsilon$ 值表明，在宏观场发生显著变化的距离内，材料属性振荡了许多次，这正是均匀化理论的基本假设。\n\n问题要求使用所提供的数据计算该参数的数值：\n- 微观长度尺度：$\\ell = 10 \\, \\mu\\mathrm{m}$\n- 宏观长度尺度：$\\lambda = 1 \\, \\mathrm{mm}$\n杆的长度 $L = 10 \\, \\mathrm{mm}$ 是问题物理描述的一部分，但计算尺度分离参数 $\\epsilon$ 并不需要它，因为宏观尺度是由作用力定义的，而不是由区域大小定义的。\n\n为了计算无量纲比值 $\\epsilon$，我们首先将长度转换为统一的单位，例如米 (m)：\n$$\n\\ell = 10 \\, \\mu\\mathrm{m} = 10 \\times 10^{-6} \\, \\mathrm{m} = 1 \\times 10^{-5} \\, \\mathrm{m}\n$$\n$$\n\\lambda = 1 \\, \\mathrm{mm} = 1 \\times 10^{-3} \\, \\mathrm{m}\n$$\n现在，我们计算比值：\n$$\n\\epsilon = \\frac{\\ell}{\\lambda} = \\frac{1 \\times 10^{-5} \\, \\mathrm{m}}{1 \\times 10^{-3} \\, \\mathrm{m}} = 1 \\times 10^{-5 - (-3)} = 1 \\times 10^{-2}\n$$\n所以，$\\epsilon = 0.01$。\n\n问题要求将最终数值四舍五入到四位有效数字。\n$$\n\\epsilon = 0.01000\n$$\n用标准科学记数法表示，这是 $1.000 \\times 10^{-2}$。该参数的量级为 $0.01 \\ll 1$，证实了存在显著的尺度分离，因此在这种情况下应用均匀化技术是完全合理的。",
            "answer": "$$\\boxed{1.000 \\times 10^{-2}}$$"
        },
        {
            "introduction": "一旦确认了尺度分离，下一步便是推导等效性能参数。本练习  将引导您完成一个经典层状介质的渐近均匀化形式化过程。您将亲眼见证微观上具有各向同性属性的材料如何在宏观上表现出各向异性行为，并推导出著名的有效电导率算术平均和调和平均公式。",
            "id": "3779116",
            "problem": "考虑一个二维周期性分层介质，其标量传导率场 $A(y)$ 仅依赖于第一个微观尺度坐标 $y_1$，且周期为 $1$。宏观场 $u^{\\varepsilon}(x)$ 在一个有界域中满足椭圆型偏微分方程 (PDE)\n$$\n-\\nabla \\cdot \\big(A\\big(\\tfrac{x}{\\varepsilon}\\big)\\,\\nabla u^{\\varepsilon}(x)\\big) \\;=\\; f(x)\n$$\n该方程具有适当的边界条件，且 $0  \\varepsilon \\ll 1$。假设 $A(y_1)$ 严格为正且足够光滑，以使均匀化方法有效。由于分层结构，预期均匀化模型是各向异性的。\n\n从周期性均匀化的第一性原理以及通过胞元问题建立的相关的微观-宏观耦合出发，为以下特殊情况推导均匀化传导率张量 $A^{\\mathrm{hom}}$\n$$\nA(y_1) \\;=\\; a_0 \\;+\\; \\delta \\,\\sin(2\\pi y_1),\n$$\n其中参数 $a_0 > 0$ 且 $|\\delta|  a_0$。将最终的张量以矩阵形式表示。",
            "solution": "该问题要求推导二维分层介质的均匀化传导率张量 $A^{\\mathrm{hom}}$，其传导率为 $A(y_1) = a_0 + \\delta \\sin(2\\pi y_1)$。控制偏微分方程 (PDE) 为\n$$\n-\\nabla \\cdot \\left(A\\left(\\frac{x}{\\varepsilon}\\right) \\nabla u^{\\varepsilon}(x)\\right) = f(x)\n$$\n其中 $y = x/\\varepsilon$ 表示微观尺度坐标。\n\n我们从解 $u^{\\varepsilon}(x)$ 的标准双尺度渐近展开拟设开始：\n$$\nu^{\\varepsilon}(x) = u_0(x) + \\varepsilon u_1(x, y) + \\varepsilon^2 u_2(x, y) + \\dots\n$$\n其中函数 $u_i(x,y)$ 假定在微观尺度变量 $y$ 上是周期的。梯度算子变换为 $\\nabla \\to \\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y$。将该展开式代入PDE，并合并 $\\varepsilon$ 的同次幂项，得到一个方程层次结构。\n\n根据标准渐近均匀化理论，均匀化张量 $A^{\\mathrm{hom}}$ 的分量由以下公式给出：\n$$\nA^{\\mathrm{hom}}_{ij} = \\left\\langle A(y) \\left(\\delta_{ij} - \\frac{\\partial \\chi_j}{\\partial y_i}\\right) \\right\\rangle_Y = \\int_Y A(y) \\left(\\delta_{ij} - \\frac{\\partial \\chi_j}{\\partial y_i}(y)\\right) dy\n$$\n其中 $\\delta_{ij}$ 是克罗内克δ符号，$\\chi_j(y)$ 是通过求解 $Y$-周期胞元问题得到的修正函数：\n$$\n-\\nabla_y \\cdot (A(y) \\nabla_y \\chi_j(y)) = -\\nabla_y \\cdot (A(y) e_j)\n$$\n在本问题中，传导率 $A(y) = A(y_1)$ 仅依赖于 $y_1$ 坐标。我们来求解胞元问题。\n\n对于 $j=2$，胞元问题是：\n$$\n-\\nabla_y \\cdot (A(y_1) \\nabla_y \\chi_2) = -\\nabla_y \\cdot (A(y_1) e_2) = -\\frac{\\partial}{\\partial y_2}(A(y_1)) = 0\n$$\n一个有效的周期解是 $\\chi_2(y) = 0$。\n\n对于 $j=1$，胞元问题是：\n$$\n-\\nabla_y \\cdot (A(y_1) \\nabla_y \\chi_1) = -\\nabla_y \\cdot (A(y_1) e_1) = -\\frac{d}{d y_1}(A(y_1))\n$$\n由于右端项仅依赖于 $y_1$，我们寻找一个解 $\\chi_1(y) = \\chi_1(y_1)$。方程简化为一个常微分方程。积分一次得到：\n$$\nA(y_1) \\frac{d\\chi_1}{dy_1} = A(y_1) - C_1\n$$\n为了使 $\\chi_1(y_1)$ 是周期的，其导数在周期区间 $[0,1]$ 上的平均值必须为零。这确定了常数 $C_1$ 为 $A$ 的调和平均值：\n$$\nC_1 = \\left(\\int_0^1 \\frac{1}{A(y_1)} dy_1\\right)^{-1} = \\langle A^{-1} \\rangle^{-1}\n$$\n\n现在我们计算 $A^{\\mathrm{hom}}$ 的分量。由于所有函数仅依赖于 $y_1$，在单元胞 $Y=[0,1]^2$ 上的平均简化为在 $[0,1]$ 上的积分。\n$$\nA^{\\mathrm{hom}}_{11} = \\left\\langle A(y_1) \\left(1 - \\frac{d\\chi_1}{dy_1}\\right)\\right\\rangle = \\left\\langle A(y_1) \\left(1 - \\left(1 - \\frac{C_1}{A(y_1)}\\right)\\right)\\right\\rangle = \\langle C_1 \\rangle = C_1 = \\langle A^{-1} \\rangle^{-1}\n$$\n$$\nA^{\\mathrm{hom}}_{22} = \\left\\langle A(y_1) \\left(1 - \\frac{\\partial\\chi_2}{\\partial y_2}\\right)\\right\\rangle = \\langle A(y_1) \\cdot 1 \\rangle = \\int_0^1 A(y_1) dy_1 = \\langle A \\rangle\n$$\n非对角项 $A^{\\mathrm{hom}}_{12}$ 和 $A^{\\mathrm{hom}}_{21}$ 为零，因为 $\\chi_2=0$ 且 $\\chi_1$ 不依赖于 $y_2$。\n所以，均匀化张量是对角的：\n$$\nA^{\\mathrm{hom}} = \\begin{pmatrix} \\langle A^{-1} \\rangle^{-1}  0 \\\\ 0  \\langle A \\rangle \\end{pmatrix}\n$$\n分量 $A^{\\mathrm{hom}}_{11}$ 是 $A(y_1)$ 的调和平均值，而 $A^{\\mathrm{hom}}_{22}$ 是算术平均值。\n\n现在，我们为给定的传导率 $A(y_1) = a_0 + \\delta \\sin(2\\pi y_1)$ 计算这些平均值。\n\n算术平均值为：\n$$\nA^{\\mathrm{hom}}_{22} = \\langle A \\rangle = \\int_0^1 (a_0 + \\delta \\sin(2\\pi y_1)) dy_1 = \\left[ a_0 y_1 - \\frac{\\delta}{2\\pi}\\cos(2\\pi y_1) \\right]_0^1 = a_0\n$$\n调和平均值是倒数的平均值的倒数。首先计算倒数的平均值：\n$$\n\\langle A^{-1} \\rangle = \\int_0^1 \\frac{1}{a_0 + \\delta \\sin(2\\pi y_1)} dy_1\n$$\n令 $t = 2\\pi y_1$，则 $dy_1 = \\frac{dt}{2\\pi}$。积分区间变为 $[0, 2\\pi]$。\n$$\n\\langle A^{-1} \\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{1}{a_0 + \\delta \\sin(t)} dt\n$$\n这是一个标准定积分。对于 $a > |b|$，公式为 $\\int_0^{2\\pi} \\frac{d\\theta}{a+b\\sin\\theta} = \\frac{2\\pi}{\\sqrt{a^2-b^2}}$。这里，$a=a_0$，$b=\\delta$。题目给出了条件 $|\\delta|  a_0$，因此：\n$$\n\\langle A^{-1} \\rangle = \\frac{1}{2\\pi} \\cdot \\frac{2\\pi}{\\sqrt{a_0^2 - \\delta^2}} = \\frac{1}{\\sqrt{a_0^2 - \\delta^2}}\n$$\n因此，调和平均值为：\n$$\nA^{\\mathrm{hom}}_{11} = \\langle A^{-1} \\rangle^{-1} = \\sqrt{a_0^2 - \\delta^2}\n$$\n\n将这些分量组合成矩阵形式，得到最终的均匀化张量：\n$$\nA^{\\mathrm{hom}} = \\begin{pmatrix} \\sqrt{a_0^2 - \\delta^2}  0 \\\\ 0  a_0 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{a_0^{2} - \\delta^{2}}  0 \\\\\n0  a_0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "解析均匀化方法功能强大，但通常局限于周期性结构。最后一个练习  介绍了一种强大的数值技术——多尺度有限元法 (MsFEM)，它将微观信息直接嵌入到粗尺度模拟的基函数中。通过构建这些特殊的基函数并将其结果与均匀化解进行比较，您将深入理解这些先进计算方法如何弥合理论分析与实际工程问题之间的鸿沟。",
            "id": "3779099",
            "problem": "考虑单位区间上的一个一维椭圆边值问题，该问题具有快速振荡的分层电导率，它模拟了一个典型的微观-宏观耦合系统。物理通量由 $j(x) = - a(x/\\varepsilon) u'(x)$ 给出，质量守恒定律要求 $-\\frac{d}{dx}(a(x/\\varepsilon) u'(x)) = f(x)$，其中 $f(x)$ 是一个给定的源项，$\\varepsilon > 0$ 是小尺度周期。假设 $a(y)$ 是周期为1的周期函数，并且在每个周期内是分段常数：在一个周期中，比例为 $\\theta \\in (0,1)$ 的部分上 $a(y) = a_1 > 0$，在剩余的比例为 $1 - \\theta$ 的部分上 $a(y) = a_2 > 0$。设宏观强迫项为 $f(x) = 1$，并施加齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。\n\n您将构建多尺度有限元法 (MsFEM) 的单元级基函数，然后将 MsFEM 近似解与均匀化解进行比较。使用一个包含 $N \\geq 2$ 个单元的均匀粗网格，节点为 $x_j = jh$, $j = 0,1,\\dots,N$，其中 $h = 1/N$。假设粗单元尺寸是微观周期的整数倍，即 $h = k \\varepsilon$（对于某个整数 $k \\geq 1$），因此每个粗单元恰好由 $k$ 个完整的微观周期组成。\n\n任务：\n1.  在单个粗单元 $K = [x_L, x_R]$ 上，通过建立并求解局部问题 $-\\frac{d}{dx}(a(x/\\varepsilon) \\frac{d \\phi_L^K}{dx}) = 0$（在 $K$ 上，边界条件为 $\\phi_L^K(x_L) = 1$ 和 $\\phi_L^K(x_R) = 0$），推导与左端点 $x_L$ 相关的 MsFEM 节点基函数 $\\phi_L^K(x)$。提供以 $1/a$ 在 $K$ 上的积分表示的闭式表达式。\n2.  使用推导出的 $\\phi_L^K(x)$ 和类似的 $\\phi_R^K(x)$，证明单元刚度简化为 $1/a$ 在 $K$ 上的积分的倒数，并得出结论：MsFEM 粗尺度离散化与一个标准线性有限元方法一致，其有效单元电导率为 $a_K^{\\ast} = \\frac{h}{\\int_K \\frac{1}{a(x/\\varepsilon)} \\, dx}$。在 $h = k \\varepsilon$ 和周期性分层的假设下，推断 $a_K^{\\ast}$ 在所有单元上是常数，并且等于调和平均值 $a^{\\ast} = ( \\frac{\\theta}{a_1} + \\frac{1 - \\theta}{a_2} )^{-1}$。\n3.  求解均匀化极限问题 $-\\frac{d}{dx}(a^{\\ast} \\, \\frac{d u_{\\text{hom}}}{dx}) = 1$，边界条件为 $u_{\\text{hom}}(0) = 0$ 和 $u_{\\text{hom}}(1) = 0$，并确定精确的均匀化解 $u_{\\text{hom}}(x)$。\n4.  令 $u_{\\text{MsFEM}}(x)$ 表示在包含 $N$ 个均匀单元的粗网格上的 MsFEM 解。计算 $u_{\\text{MsFEM}}$ 和 $u_{\\text{hom}}$ 之间误差的 $L^2(0,1)$ 范数，即 $\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^2(0,1)}$，并给出最终答案，该答案应是仅用 $a_1$、$a_2$、$\\theta$ 和 $N$ 表示的单个闭式解析表达式。\n\n将最终误差表示为单个解析表达式。无需四舍五入，也无需单位。",
            "solution": "#### 1. MsFEM基函数的推导\n在单元 $K = [x_L, x_R]$ 上，与左节点相关的基函数 $\\phi_L^K(x)$ 满足局部齐次问题：\n$$\n- \\frac{d}{dx}\\left( a\\left(\\frac{x}{\\varepsilon}\\right) \\frac{d \\phi_L^K}{dx} \\right) = 0, \\quad x \\in (x_L, x_R)\n$$\n边界条件为 $\\phi_L^K(x_L) = 1$ 和 $\\phi_L^K(x_R) = 0$。\n对微分方程积分一次得到：\n$$\na\\left(\\frac{x}{\\varepsilon}\\right) \\frac{d \\phi_L^K}{dx} = C_1\n$$\n其中 $C_1$ 是一个积分常数。整理后，对 $x_L$ 到 $x$ 再次积分：\n$$\n\\phi_L^K(x) - \\phi_L^K(x_L) = C_1 \\int_{x_L}^{x} \\frac{1}{a(s/\\varepsilon)} \\, ds\n$$\n应用边界条件 $\\phi_L^K(x_L) = 1$ 和 $\\phi_L^K(x_R) = 0$，我们可以确定 $C_1$：\n$$\n0 = 1 + C_1 \\int_{x_L}^{x_R} \\frac{1}{a(s/\\varepsilon)} \\, ds \\implies C_1 = - \\left( \\int_{x_L}^{x_R} \\frac{1}{a(s/\\varepsilon)} \\, ds \\right)^{-1}\n$$\n将 $C_1$ 代回，得到基函数的闭式表达式：\n$$\n\\phi_L^K(x) = 1 - \\frac{\\int_{x_L}^{x} \\frac{1}{a(s/\\varepsilon)} \\, ds}{\\int_{x_L}^{x_R} \\frac{1}{a(s/\\varepsilon)} \\, ds} = \\frac{\\int_{x}^{x_R} \\frac{1}{a(s/\\varepsilon)} \\, ds}{\\int_{x_L}^{x_R} \\frac{1}{a(s/\\varepsilon)} \\, ds}\n$$\n\n#### 2. 单元刚度和有效电导率\n单元刚度矩阵 $S^K$ 的元素由 $S_{ij}^K = \\int_K a(x/\\varepsilon) \\frac{d\\phi_i^K}{dx} \\frac{d\\phi_j^K}{dx} dx$ 给出。利用上面推导的 $\\frac{d\\phi_L^K}{dx} = C_1/a(x/\\varepsilon)$ 以及对称性 $\\phi_R^K(x) = 1-\\phi_L^K(x)$，我们计算出：\n$$\nS_{LL}^K = \\int_K a\\left(\\frac{x}{\\varepsilon}\\right) \\left(\\frac{d\\phi_L^K}{dx}\\right)^2 dx = \\frac{1}{I_K}\n$$\n其中 $I_K = \\int_K \\frac{1}{a(s/\\varepsilon)} ds$。类似地，$S_{RR}^K = 1/I_K$ 且 $S_{LR}^K = -1/I_K$。\n单元刚度矩阵为 $S^K = \\frac{1}{I_K} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。这与电导率为 $a_K^*$ 的标准线性有限元刚度矩阵 $\\frac{a_K^*}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$ 形式相同。因此，有效电导率为：\n$$\na_K^* = \\frac{h}{I_K} = \\frac{h}{\\int_K \\frac{1}{a(x/\\varepsilon)} dx}\n$$\n由于每个粗单元 $K$ 包含整数个 ($k$) 微观周期 ($h=k\\varepsilon$)，积分 $\\int_K$ 是周期积分的 $k$ 倍。\n$$\n\\int_K \\frac{dx}{a(x/\\varepsilon)} = k \\int_0^\\varepsilon \\frac{dx}{a(x/\\varepsilon)} = k\\varepsilon \\int_0^1 \\frac{dy}{a(y)} = h \\left( \\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2} \\right)\n$$\n因此，有效电导率在所有单元上都是常数，等于调和平均值：\n$$\na_K^* = a^* = \\left( \\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2} \\right)^{-1}\n$$\n\n#### 3. 均匀化解\n均匀化问题为 $-a^* u_{\\text{hom}}''(x) = 1$，边界条件为 $u_{\\text{hom}}(0)=0$ 和 $u_{\\text{hom}}(1)=0$。\n两次积分并应用边界条件，可得精确解：\n$$\nu_{\\text{hom}}(x) = \\frac{x(1-x)}{2a^*}\n$$\n\n#### 4. $L^2$误差计算\n由于MsFEM的刚度矩阵和（在此特定情况下的）载荷向量与均匀化问题的标准FEM离散化结果相同，MsFEM解 $u_{\\text{MsFEM}}(x)$ 是均匀化精确解 $u_{\\text{hom}}(x)$ 在粗网格节点上的分段线性插值。因此，$u_{\\text{MsFEM}}(x_j) = u_{\\text{hom}}(x_j)$。\n误差 $e(x) = u_{\\text{MsFEM}}(x) - u_{\\text{hom}}(x)$ 是二次函数 $u_{\\text{hom}}$ 与其线性插值 $u_{\\text{MsFEM}}$ 之差。在单个单元 $[x_j, x_{j+1}]$ 上，误差的平方积分为：\n$$\n\\int_{x_j}^{x_{j+1}} e(x)^2 dx = \\int_{x_j}^{x_{j+1}} \\left( \\frac{-1}{2a^*} (x-x_j)(x-x_{j+1}) \\right)^2 dx = \\frac{1}{4(a^*)^2} \\frac{h^5}{30}\n$$\n其中 $h=1/N$。总的 $L^2$ 误差平方为所有 $N$ 个单元的误差之和：\n$$\n\\| e \\|_{L^2}^2 = \\sum_{j=0}^{N-1} \\int_{x_j}^{x_{j+1}} e(x)^2 dx = N \\cdot \\frac{1}{120(a^*)^2 N^5} = \\frac{1}{120(a^*)^2 N^4}\n$$\n取平方根得到 $L^2$ 范数：\n$$\n\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^2} = \\frac{1}{\\sqrt{120} a^* N^2} = \\frac{1}{2\\sqrt{30} a^* N^2}\n$$\n代入 $a^*$ 的表达式：\n$$\n\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^2} = \\frac{1}{2\\sqrt{30}N^2} \\left( \\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2} \\right) = \\frac{a_1(1-\\theta) + a_2\\theta}{2\\sqrt{30} N^2 a_1 a_2}\n$$",
            "answer": "$$\n\\boxed{\\frac{a_{1}(1-\\theta) + a_{2}\\theta}{2\\sqrt{30} N^{2} a_{1} a_{2}}}\n$$"
        }
    ]
}