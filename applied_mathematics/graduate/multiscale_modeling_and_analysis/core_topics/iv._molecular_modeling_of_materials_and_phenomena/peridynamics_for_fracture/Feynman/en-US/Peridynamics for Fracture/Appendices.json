{
    "hands_on_practices": [
        {
            "introduction": "To effectively model materials, it is crucial to understand the foundational assumptions and limitations of the chosen framework. This first exercise explores the fundamental differences between bond-based and state-based peridynamic models by examining their constitutive responses under a simple, uniform deformation. By deriving the stress tensor for a simple bond-based model, you will uncover a significant limitation related to the material's Poisson’s ratio, which motivates the development of more general state-based formulations .",
            "id": "3793747",
            "problem": "Consider a three-dimensional infinite, homogeneous, isotropic elastic body modeled using Peridynamics (PD). Let the small-deformation displacement field be generated by a uniform, spatially constant, symmetric small-strain tensor $\\varepsilon$, so that the deformation map is $y(x) = x + \\varepsilon x$. The peridynamic horizon is a sphere of radius $\\delta  0$ centered at each point $x$, and the bond vector is $\\xi = x' - x$ with $|\\xi| = r$ and direction $n = \\xi / r$. Assume the bond-based linear peridynamic pairwise interaction with a constant micro-modulus $c_{0}  0$ supported on the horizon, and the standard small-strain linearization of the scalar bond stretch.\n\n- Using the bond-based formulation, compute the peridynamic internal force density $p_{\\mathrm{BB}}(x)$ for the given uniform strain field and deduce whether it vanishes. Then, using the tensorial moment of peridynamic pairwise forces, define the stress-like second-order tensor\n$$\n\\sigma_{\\mathrm{BB}}(x) = \\frac{1}{2}\\int_{|\\xi| \\le \\delta} f_{\\mathrm{BB}}(x,\\xi) \\otimes \\xi \\,\\mathrm{d}V_{\\xi}\n$$\nand express it in the form $\\sigma_{\\mathrm{BB}} = \\lambda_{\\mathrm{BB}} \\,\\mathrm{tr}(\\varepsilon)\\, I + 2\\,\\mu_{\\mathrm{BB}}\\, \\varepsilon$, identifying the effective Lamé parameters $\\lambda_{\\mathrm{BB}}$ and $\\mu_{\\mathrm{BB}}$ in terms of $c_{0}$ and $\\delta$. Conclude the Poisson’s ratio implied by the bond-based model.\n\n- Using the correspondence (state-based) peridynamic formulation, consider a force state consistent with classical linear elasticity, namely a force state of the form $T_{\\mathrm{SB}}(x,\\xi) = \\omega(|\\xi|)\\, \\sigma \\cdot n$ with a spherically symmetric positive weighting function $\\omega(|\\xi|)$ supported on the horizon (assume $\\omega$ is normalized so that the nonlocal divergence recovers the classical divergence for smooth fields), where $\\sigma = \\lambda\\,\\mathrm{tr}(\\varepsilon)\\,I + 2\\mu\\,\\varepsilon$ is the Cauchy stress of the classical linear elastic solid with given Lamé parameters $\\lambda$ and $\\mu$. Compute the corresponding peridynamic internal force density $p_{\\mathrm{SB}}(x) = \\int_{|\\xi| \\le \\delta} T_{\\mathrm{SB}}(x,\\xi)\\,\\mathrm{d}V_{\\xi}$ for the uniform strain field, and state whether it vanishes. Explain whether the stress predicted by the correspondence model matches the classical Cauchy stress for arbitrary $\\lambda$ and $\\mu$.\n\nYour final answer must be the single numerical value of the Poisson’s ratio predicted by the bond-based peridynamic model in three dimensions with the constant micro-modulus and spherical horizon described above. No rounding is required. No units are to be reported in the final answer.",
            "solution": "The problem statement is evaluated as valid. It is a well-posed theoretical problem in the field of continuum mechanics, specifically peridynamics. The givens are self-contained, scientifically grounded in established theory, and sufficient for deriving the requested quantities.\n\nThe solution proceeds in two parts, addressing the bond-based and state-based peridynamic models as laid out in the problem.\n\n### Part 1: Bond-Based Peridynamics (BB-PD)\n\nThe displacement field is given by $u(x) = \\varepsilon x$, where $\\varepsilon$ is a constant, symmetric, small-strain tensor. The relative displacement vector between two points $x' = x + \\xi$ and $x$ is\n$$\n\\eta = u(x') - u(x) = \\varepsilon x' - \\varepsilon x = \\varepsilon (x' - x) = \\varepsilon \\xi\n$$\nThe bond vector is $\\xi$, with length $r = |\\xi|$ and direction $n = \\xi/r$. The linearized bond stretch $s$ is given by\n$$\ns = \\frac{\\xi \\cdot \\eta}{|\\xi|^2} = \\frac{\\xi \\cdot (\\varepsilon \\xi)}{r^2} = \\frac{\\xi^T \\varepsilon \\xi}{\\xi^T \\xi} = n \\cdot (\\varepsilon n) = n^T \\varepsilon n\n$$\nIn the bond-based model with a constant micro-modulus $c_0  0$, the pairwise force density vector (force per unit volume squared) that the bond $\\xi$ exerts on the material point at $x$ is\n$$\nf_{\\mathrm{BB}}(x, \\xi) = c_0 s \\, n = c_0 (n \\cdot \\varepsilon n) n\n$$\nThis is defined for all bonds within the horizon, i.e., for $|\\xi| \\le \\delta$.\n\n**1. Internal Force Density, $p_{\\mathrm{BB}}(x)$**\n\nThe peridynamic internal force density at point $x$ is the integral of all pairwise force densities acting on $x$ from its neighbors within the horizon $\\mathcal{H}_x = \\{x' : |x'-x| \\le \\delta\\}$.\n$$\np_{\\mathrm{BB}}(x) = \\int_{\\mathcal{H}_x} f_{\\mathrm{BB}}(x, x'-x) \\, \\mathrm{d}V_{x'} = \\int_{|\\xi| \\le \\delta} f_{\\mathrm{BB}}(x, \\xi) \\, \\mathrm{d}V_{\\xi}\n$$\nSubstituting the expression for $f_{\\mathrm{BB}}$:\n$$\np_{\\mathrm{BB}}(x) = \\int_{|\\xi| \\le \\delta} c_0 (n \\cdot \\varepsilon n) n \\, \\mathrm{d}V_{\\xi}\n$$\nSince $\\varepsilon$ and $c_0$ are constant, we can analyze the integral. We use spherical coordinates for $\\xi$, so that $\\mathrm{d}V_{\\xi} = r^2 \\sin\\theta \\mathrm{d}r \\mathrm{d}\\theta \\mathrm{d}\\phi = r^2 \\mathrm{d}r \\mathrm{d}\\Omega$, where $\\mathrm{d}\\Omega$ is the solid angle element.\n$$\np_{\\mathrm{BB}}(x) = c_0 \\int_0^\\delta r^2 \\mathrm{d}r \\int_{\\mathbb{S}^2} (n \\cdot \\varepsilon n) n \\, \\mathrm{d}\\Omega\n$$\nThe integrand of the angular integral, $(n \\cdot \\varepsilon n) n$, is an odd function with respect to the inversion $n \\to -n$. Specifically, $( (-n) \\cdot \\varepsilon (-n) ) (-n) = (n \\cdot \\varepsilon n) (-n) = -(n \\cdot \\varepsilon n) n$. Since the domain of integration $\\mathbb{S}^2$ is symmetric with respect to the origin, the integral of any odd function over this domain is zero.\n$$\n\\int_{\\mathbb{S}^2} (n \\cdot \\varepsilon n) n \\, \\mathrm{d}\\Omega = 0\n$$\nTherefore, the internal force density vanishes for any uniform strain field:\n$$\np_{\\mathrm{BB}}(x) = 0\n$$\n\n**2. Stress-like Tensor, $\\sigma_{\\mathrm{BB}}$, Lamé Parameters, and Poisson's Ratio**\n\nThe stress-like tensor is defined as:\n$$\n\\sigma_{\\mathrm{BB}}(x) = \\frac{1}{2} \\int_{|\\xi| \\le \\delta} f_{\\mathrm{BB}}(x,\\xi) \\otimes \\xi \\, \\mathrm{d}V_{\\xi}\n$$\nSubstituting $f_{\\mathrm{BB}}(x, \\xi) = c_0 (n \\cdot \\varepsilon n) n$ and $\\xi = r n$:\n$$\n\\sigma_{\\mathrm{BB}} = \\frac{1}{2} \\int_{|\\xi| \\le \\delta} c_0 (n \\cdot \\varepsilon n) n \\otimes (rn) \\, \\mathrm{d}V_{\\xi} = \\frac{c_0}{2} \\int_{|\\xi| \\le \\delta} r (n \\cdot \\varepsilon n) (n \\otimes n) \\, \\mathrm{d}V_{\\xi}\n$$\nAgain, switching to spherical coordinates:\n$$\n\\sigma_{\\mathrm{BB}} = \\frac{c_0}{2} \\int_0^\\delta r \\cdot r^2 \\mathrm{d}r \\int_{\\mathbb{S}^2} (n \\cdot \\varepsilon n) (n \\otimes n) \\, \\mathrm{d}\\Omega\n$$\nThe radial integral is $\\int_0^\\delta r^3 \\mathrm{d}r = \\frac{\\delta^4}{4}$.\n$$\n\\sigma_{\\mathrm{BB}} = \\frac{c_0 \\delta^4}{8} \\int_{\\mathbb{S}^2} (n \\cdot \\varepsilon n) (n \\otimes n) \\, \\mathrm{d}\\Omega\n$$\nIn component form, $(\\sigma_{\\mathrm{BB}})_{ij} = \\frac{c_0 \\delta^4}{8} \\int_{\\mathbb{S}^2} \\left( \\sum_{k,l} n_k \\varepsilon_{kl} n_l \\right) n_i n_j \\, \\mathrm{d}\\Omega$. Since $\\varepsilon$ is constant, we can write this as:\n$$\n(\\sigma_{\\mathrm{BB}})_{ij} = \\frac{c_0 \\delta^4}{8} \\sum_{k,l} \\left( \\int_{\\mathbb{S}^2} n_i n_j n_k n_l \\, \\mathrm{d}\\Omega \\right) \\varepsilon_{kl}\n$$\nThe integral defines a fourth-order isotropic tensor. For a three-dimensional space ($D=3$), this integral is known to be:\n$$\n\\int_{\\mathbb{S}^2} n_i n_j n_k n_l \\, \\mathrm{d}\\Omega = \\frac{4\\pi}{15} (\\delta_{ij}\\delta_{kl} + \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\nSubstituting this into the expression for $(\\sigma_{\\mathrm{BB}})_{ij}$:\n$$\n(\\sigma_{\\mathrm{BB}})_{ij} = \\frac{c_0 \\delta^4}{8} \\frac{4\\pi}{15} \\sum_{k,l} (\\delta_{ij}\\delta_{kl} + \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) \\varepsilon_{kl}\n$$\n$$\n(\\sigma_{\\mathrm{BB}})_{ij} = \\frac{\\pi c_0 \\delta^4}{30} \\left( \\delta_{ij} \\sum_{k,l} \\delta_{kl}\\varepsilon_{kl} + \\sum_{k,l} \\delta_{ik}\\delta_{jl}\\varepsilon_{kl} + \\sum_{k,l} \\delta_{il}\\delta_{jk}\\varepsilon_{kl} \\right)\n$$\nUsing the properties of the Kronecker delta and the symmetry of $\\varepsilon$ ($\\varepsilon_{ij}=\\varepsilon_{ji}$):\n$$\n\\sum_{k,l} \\delta_{kl}\\varepsilon_{kl} = \\sum_k \\varepsilon_{kk} = \\mathrm{tr}(\\varepsilon)\n$$\n$$\n\\sum_{k,l} \\delta_{ik}\\delta_{jl}\\varepsilon_{kl} = \\varepsilon_{ij}\n$$\n$$\n\\sum_{k,l} \\delta_{il}\\delta_{jk}\\varepsilon_{kl} = \\varepsilon_{ji} = \\varepsilon_{ij}\n$$\nThus,\n$$\n(\\sigma_{\\mathrm{BB}})_{ij} = \\frac{\\pi c_0 \\delta^4}{30} \\left( \\mathrm{tr}(\\varepsilon) \\delta_{ij} + \\varepsilon_{ij} + \\varepsilon_{ij} \\right) = \\frac{\\pi c_0 \\delta^4}{30} \\left( \\mathrm{tr}(\\varepsilon) \\delta_{ij} + 2\\varepsilon_{ij} \\right)\n$$\nIn tensor notation:\n$$\n\\sigma_{\\mathrm{BB}} = \\frac{\\pi c_0 \\delta^4}{30} (\\mathrm{tr}(\\varepsilon) I + 2\\varepsilon)\n$$\nWe are asked to express this in the form $\\sigma_{\\mathrm{BB}} = \\lambda_{\\mathrm{BB}} \\,\\mathrm{tr}(\\varepsilon)\\, I + 2\\,\\mu_{\\mathrm{BB}}\\, \\varepsilon$. By direct comparison, we identify the effective Lamé parameters:\n$$\n\\lambda_{\\mathrm{BB}} = \\frac{\\pi c_0 \\delta^4}{30}\n$$\n$$\n2\\mu_{\\mathrm{BB}} = 2 \\left( \\frac{\\pi c_0 \\delta^4}{30} \\right) \\implies \\mu_{\\mathrm{BB}} = \\frac{\\pi c_0 \\delta^4}{30}\n$$\nWe find that for this model, $\\lambda_{\\mathrm{BB}} = \\mu_{\\mathrm{BB}}$. The Poisson's ratio $\\nu$ is related to the Lamé parameters by the formula $\\nu = \\frac{\\lambda}{2(\\lambda+\\mu)}$. For the bond-based model, this gives:\n$$\n\\nu_{\\mathrm{BB}} = \\frac{\\lambda_{\\mathrm{BB}}}{2(\\lambda_{\\mathrm{BB}} + \\mu_{\\mathrm{BB}})} = \\frac{\\lambda_{\\mathrm{BB}}}{2(\\lambda_{\\mathrm{BB}} + \\lambda_{\\mathrm{BB}})} = \\frac{\\lambda_{\\mathrm{BB}}}{4\\lambda_{\\mathrm{BB}}} = \\frac{1}{4}\n$$\nThis fixed value of Poisson's ratio is a well-known limitation of the simple bond-based peridynamic model in three dimensions.\n\n### Part 2: State-Based Peridynamics (Correspondence Model)\n\nIn the state-based correspondence model, the force state is given as $T_{\\mathrm{SB}}(x,\\xi) = \\omega(|\\xi|)\\, (\\sigma n)$, where $\\sigma = \\lambda\\,\\mathrm{tr}(\\varepsilon)\\,I + 2\\mu\\,\\varepsilon$ is the classical Cauchy stress for a linear isotropic elastic material with arbitrary Lamé parameters $\\lambda$ and $\\mu$. The strain field $\\varepsilon$ is uniform, so $\\sigma$ is a constant tensor. The function $\\omega(|\\xi|)$ is a positive, spherically symmetric weighting function.\n\n**1. Internal Force Density, $p_{\\mathrm{SB}}(x)$**\n\nThe internal force density is $p_{\\mathrm{SB}}(x) = \\int_{|\\xi| \\le \\delta} T_{\\mathrm{SB}}(x,\\xi)\\,\\mathrm{d}V_{\\xi}$.\n$$\np_{\\mathrm{SB}}(x) = \\int_{|\\xi| \\le \\delta} \\omega(|\\xi|) (\\sigma n) \\,\\mathrm{d}V_{\\xi}\n$$\nSince $\\sigma$ is a constant tensor, it can be moved outside the integral:\n$$\np_{\\mathrm{SB}}(x) = \\sigma \\left( \\int_{|\\xi| \\le \\delta} \\omega(|\\xi|) n \\,\\mathrm{d}V_{\\xi} \\right)\n$$\nWe evaluate the integral term. Using spherical coordinates, $\\mathrm{d}V_{\\xi} = r^2 \\mathrm{d}r \\mathrm{d}\\Omega$.\n$$\n\\int_{|\\xi| \\le \\delta} \\omega(|\\xi|) n \\,\\mathrm{d}V_{\\xi} = \\int_0^\\delta \\omega(r) r^2 \\mathrm{d}r \\int_{\\mathbb{S}^2} n \\, \\mathrm{d}\\Omega\n$$\nThe integral of the direction vector $n$ over the symmetric unit sphere $\\mathbb{S}^2$ is zero: $\\int_{\\mathbb{S}^2} n \\, \\mathrm{d}\\Omega = 0$. Consequently, the entire integral is zero.\n$$\np_{\\mathrm{SB}}(x) = \\sigma \\cdot 0 = 0\n$$\nThe internal force density vanishes for the state-based model with a uniform strain field, just as for the bond-based model.\n\n**2. Correspondence with Classical Stress**\n\nThe problem asks whether the stress predicted by the correspondence model matches the classical Cauchy stress for arbitrary $\\lambda$ and $\\mu$. The answer is yes, by construction. The state-based correspondence model is specifically designed to reproduce the results of classical continuum mechanics for homogeneous deformations. The model takes the classical constitutive law (i.e., the stress $\\sigma$ for a given deformation) as an input to define the peridynamic force state $T_{\\mathrm{SB}}$. The choice $T_{\\mathrm{SB}}(x,\\xi) = \\omega(|\\xi|)\\, \\sigma n$ (coupled with an appropriate normalization of $\\omega(|\\xi|)$) is a formulation that ensures the stress tensor calculated within the peridynamic framework matches the input Cauchy stress $\\sigma$. Therefore, unlike the bond-based model which has an inherent constitutive response leading to a fixed Poisson's ratio, the correspondence model is a framework that can accommodate any classical elastic constitutive law, and thus any physically permissible values of $\\lambda$ and $\\mu$.\n\nThe final answer required is the Poisson's ratio from the bond-based component of the analysis.",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "Peridynamics is an inherently non-local theory, a feature that imparts properties fundamentally distinct from classical local elasticity, especially in dynamic scenarios. This exercise  delves into the dynamic response of a 1D peridynamic solid by guiding you through the derivation of its dispersion relation. Analyzing this relation reveals how the model's internal length scale—the horizon $\\delta$—naturally gives rise to a cutoff frequency for wave propagation, a phenomenon with profound implications for modeling fracture and material behavior at small scales.",
            "id": "3793709",
            "problem": "Consider a homogeneous, infinite, one-dimensional (1D) linear peridynamic solid with mass density $\\rho$ and horizon $\\delta$. The small-strain, bond-based peridynamic equation of motion for the scalar displacement field $u(x,t)$ is defined by the integral balance of linear momentum: for each material point at position $x$, the internal force density equals the nonlocal integral of pairwise interactions over the neighborhood of radius $\\delta$. Assume a micromodulus function $c(\\xi)$ that depends only on the bond vector $\\xi$, with $c(\\xi)$ symmetric and vanishing for $|\\xi|\\delta$. Let the micromodulus be factored as $c(\\xi)=c_{0}\\,\\omega(\\xi)$, where $c_{0}$ is a constant and $\\omega(\\xi)$ is a symmetric, dimensionless kernel. Use the following specific choice of kernel: $\\omega(\\xi)=1$ for $|\\xi|\\leq \\delta$ and $\\omega(\\xi)=0$ for $|\\xi|\\delta$.\n\nStarting from the peridynamic equation of motion and adopting a small-amplitude plane-wave ansatz $u(x,t)=U\\,\\exp\\!\\big(i(kx-\\omega t)\\big)$, where $U$ is a constant amplitude, $k$ is the real wavenumber, and $\\omega$ is the real angular frequency, derive the dispersion relation $\\omega=\\omega(k)$ in closed form.\n\nCalibrate $c_{0}$ by enforcing that, in the long-wavelength limit $k\\to 0$, the peridynamic dispersion recovers the classical elastic bar wave speed based on Young’s modulus $E$, namely $\\omega\\approx k\\sqrt{E/\\rho}$. Express the final dispersion relation $\\omega(k)$ in terms of $E$, $\\rho$, $\\delta$, and $k$.\n\nThen, using your derived expression, explain from first principles why this nonlocal model induces a band-limiting effect at high wavenumbers compared to the classical elastic dispersion relation and determine the finite high-wavenumber limit of $\\omega(k)$. Your final reported answer must be the single closed-form analytic expression for $\\omega(k)$; no rounding is required, and do not include units in the final boxed expression.",
            "solution": "The problem is valid as it is scientifically grounded in the established theory of peridynamics, well-posed with sufficient information for a unique solution, and stated objectively.\n\nThe derivation begins with the one-dimensional, linearized, bond-based peridynamic equation of motion for the displacement field $u(x,t)$ at a material point $x$ and time $t$. Given a mass density $\\rho$ and a micromodulus function $c(\\xi)$, this equation is an integro-differential equation representing the balance of linear momentum:\n$$ \\rho \\frac{\\partial^2 u(x,t)}{\\partial t^2} = \\int_{-\\infty}^{\\infty} c(\\xi) [u(x+\\xi,t) - u(x,t)] \\, d\\xi $$\nThe micromodulus is given as $c(\\xi) = c_0 \\, \\omega(\\xi)$, where $\\omega(\\xi) = 1$ for $|\\xi| \\leq \\delta$ and $\\omega(\\xi)=0$ for $|\\xi|  \\delta$. The parameter $\\delta$ is the horizon. Substituting this form of $c(\\xi)$ simplifies the integral's domain:\n$$ \\rho \\frac{\\partial^2 u(x,t)}{\\partial t^2} = \\int_{-\\delta}^{\\delta} c_0 [u(x+\\xi,t) - u(x,t)] \\, d\\xi $$\nTo find the dispersion relation, we substitute the plane-wave ansatz $u(x,t) = U \\exp(i(kx - \\omega t))$ into the equation of motion. First, we evaluate the left-hand side (LHS):\n$$ \\text{LHS} = \\rho \\frac{\\partial^2}{\\partial t^2} \\left[ U \\exp(i(kx - \\omega t)) \\right] = \\rho U (-i\\omega)^2 \\exp(i(kx - \\omega t)) = -\\rho \\omega^2 U \\exp(i(kx - \\omega t)) $$\nNext, we evaluate the right-hand side (RHS):\n$$ \\text{RHS} = \\int_{-\\delta}^{\\delta} c_0 [U \\exp(i(k(x+\\xi) - \\omega t)) - U \\exp(i(kx - \\omega t))] \\, d\\xi $$\n$$ \\text{RHS} = c_0 U \\exp(i(kx - \\omega t)) \\int_{-\\delta}^{\\delta} [\\exp(ik\\xi) - 1] \\, d\\xi $$\nEquating the LHS and RHS and dividing by the common non-zero term $U \\exp(i(kx - \\omega t))$, we obtain:\n$$ -\\rho \\omega^2 = c_0 \\int_{-\\delta}^{\\delta} [\\exp(ik\\xi) - 1] \\, d\\xi $$\n$$ \\rho \\omega^2 = c_0 \\int_{-\\delta}^{\\delta} [1 - \\exp(ik\\xi)] \\, d\\xi $$\nUsing Euler's formula, $\\exp(ik\\xi) = \\cos(k\\xi) + i\\sin(k\\xi)$, the integral becomes:\n$$ \\rho \\omega^2 = c_0 \\int_{-\\delta}^{\\delta} [1 - \\cos(k\\xi) - i\\sin(k\\xi)] \\, d\\xi $$\nThe integral of the odd function $\\sin(k\\xi)$ over the symmetric interval $[-\\delta, \\delta]$ is zero. The even function $1 - \\cos(k\\xi)$ remains:\n$$ \\rho \\omega^2 = c_0 \\int_{-\\delta}^{\\delta} [1 - \\cos(k\\xi)] \\, d\\xi = 2 c_0 \\int_{0}^{\\delta} [1 - \\cos(k\\xi)] \\, d\\xi $$\nPerforming the integration:\n$$ \\int_{0}^{\\delta} [1 - \\cos(k\\xi)] \\, d\\xi = \\left[ \\xi - \\frac{\\sin(k\\xi)}{k} \\right]_0^\\delta = \\delta - \\frac{\\sin(k\\delta)}{k} $$\nThus, the dispersion relation in terms of the constant $c_0$ is:\n$$ \\rho \\omega^2(k) = 2 c_0 \\left( \\delta - \\frac{\\sin(k\\delta)}{k} \\right) $$\n\nNext, we calibrate the micromodulus constant $c_0$ by matching the behavior of the model in the long-wavelength limit ($k \\to 0$) to that of classical elasticity. The classical dispersion for an elastic bar with Young's modulus $E$ and density $\\rho$ is $\\omega(k) = k \\sqrt{E/\\rho}$, or $\\omega^2(k) = k^2 E/\\rho$.\nTo find the long-wavelength limit of the peridynamic dispersion relation, we use the Taylor series expansion for $\\sin(k\\delta)$ about $k=0$:\n$$ \\sin(k\\delta) = (k\\delta) - \\frac{(k\\delta)^3}{3!} + \\frac{(k\\delta)^5}{5!} - \\dots $$\nSubstituting this into the term in parentheses:\n$$ \\delta - \\frac{\\sin(k\\delta)}{k} = \\delta - \\frac{1}{k}\\left( k\\delta - \\frac{k^3\\delta^3}{6} + O(k^5) \\right) = \\delta - \\left( \\delta - \\frac{k^2\\delta^3}{6} + O(k^4) \\right) = \\frac{k^2\\delta^3}{6} + O(k^4) $$\nIn the limit $k \\to 0$, the dispersion relation becomes:\n$$ \\rho \\omega^2(k) \\approx 2 c_0 \\left( \\frac{k^2\\delta^3}{6} \\right) = \\frac{c_0 \\delta^3}{3} k^2 $$\nEquating this to the classical relation $\\omega^2(k) \\approx k^2 E/\\rho$:\n$$ \\frac{c_0 \\delta^3}{3\\rho} k^2 = \\frac{E}{\\rho} k^2 $$\nThis yields the expression for the calibrated micromodulus constant:\n$$ c_0 = \\frac{3E}{\\delta^3} $$\nNow we substitute this calibrated $c_0$ back into the full peridynamic dispersion relation:\n$$ \\rho \\omega^2(k) = 2 \\left(\\frac{3E}{\\delta^3}\\right) \\left( \\delta - \\frac{\\sin(k\\delta)}{k} \\right) $$\n$$ \\omega^2(k) = \\frac{6E}{\\rho\\delta^3} \\left( \\delta - \\frac{\\sin(k\\delta)}{k} \\right) = \\frac{6E}{\\rho\\delta^2} \\left( 1 - \\frac{\\sin(k\\delta)}{k\\delta} \\right) $$\nTaking the square root (and considering the physical, non-negative frequency), we obtain the final expression for the dispersion relation:\n$$ \\omega(k) = \\sqrt{\\frac{6E}{\\rho\\delta^2} \\left( 1 - \\frac{\\sin(k\\delta)}{k\\delta} \\right)} $$\n\nFinally, we explain the band-limiting effect. The classical dispersion relation $\\omega_{cl}(k) = k \\sqrt{E/\\rho}$ is linear, implying that frequency can increase without bound as the wavenumber $k$ increases. This is a non-physical artifact of the local continuum model, which lacks an intrinsic length scale.\nIn contrast, the peridynamic dispersion relation exhibits a fundamentally different behavior at high wavenumbers. This arises directly from the nonlocal nature of the integral formulation, where interactions occur over a finite distance defined by the horizon $\\delta$. To see this, we examine the limit of $\\omega(k)$ as $k \\to \\infty$:\n$$ \\lim_{k\\to\\infty} \\omega(k) = \\lim_{k\\to\\infty} \\sqrt{\\frac{6E}{\\rho\\delta^2} \\left( 1 - \\frac{\\sin(k\\delta)}{k\\delta} \\right)} $$\nAs $k \\to \\infty$, the term $\\sin(k\\delta)$ remains bounded between $-1$ and $1$, while the denominator $k\\delta$ goes to infinity. Therefore, $\\lim_{k\\to\\infty} \\frac{\\sin(k\\delta)}{k\\delta} = 0$.\nThe limit of the frequency is then:\n$$ \\omega_{max} = \\lim_{k\\to\\infty} \\omega(k) = \\sqrt{\\frac{6E}{\\rho\\delta^2} (1 - 0)} = \\sqrt{\\frac{6E}{\\rho\\delta^2}} $$\nThis shows that the frequency does not grow infinitely but instead asymptotically approaches a finite maximum value, $\\omega_{max}$. This is the band-limiting effect or cutoff frequency. Physically, it means that plane waves with frequencies greater than $\\omega_{max}$ cannot propagate through the medium. This behavior is a direct consequence of the material's internal length scale $\\delta$. For very high wavenumbers, the corresponding wavelength $\\lambda = 2\\pi/k$ becomes much smaller than the horizon $\\delta$. The term $\\exp(ik\\xi)$ in the original integral oscillates very rapidly over the integration domain $[-\\delta, \\delta]$, causing the net force from neighboring particles to average out and saturate. This saturation of the internal force at short wavelengths prevents the wave frequency from increasing indefinitely, thus introducing a natural regularization absent in classical local theory.",
            "answer": "$$\\boxed{\\sqrt{\\frac{6E}{\\rho \\delta^2} \\left( 1 - \\frac{\\sin(k\\delta)}{k\\delta} \\right)}}$$"
        },
        {
            "introduction": "A key test of any computational model for fracture is its ability to accurately simulate dynamic events while respecting fundamental physical laws, such as the conservation of energy. This practice  challenges you to implement a dynamic peridynamic simulation and perform a rigorous verification of its energy balance. You will learn to dissect the system's energy budget into kinetic, potential, and dissipated fracture components, and critically, to quantify numerical errors, ensuring the physical fidelity of your simulation.",
            "id": "3587038",
            "problem": "Consider a one-dimensional bond-based Peridynamic formulation for a uniform bar, discretized into $N$ material points with uniform spacing. The peridynamic equation of motion follows directly from Newton's second law and the pairwise peridynamic force function. Your task is to implement an explicit central-difference time integrator for the microelastic brittle model with irreversible bond breaking, and to perform a rigorous energy balance check including kinetic energy, elastic (pairwise bond) energy, and fracture work accumulated due to broken bonds. Additionally, you must quantify the numerical dissipation attributable to two sources: explicit time integration and stepwise neighbor (bond) updates upon breaking.\n\nFundamental base:\n- Newton's second law: for each material point $i$ with mass $m_i$, the acceleration is given by the net internal peridynamic force, i.e., $m_i \\, \\ddot{y}_i(t) = \\sum_{j \\in \\mathcal{H}_i} f_{ij}(t)$, where $\\mathcal{H}_i$ denotes the set of neighbors of $i$ within the horizon in the reference configuration.\n- Bond-based microelastic brittle peridynamics in one dimension with constant micromodulus $c$ and unit influence function: for a bond between points $i$ and $j$, the reference separation is $r_{0,ij} = x_j - x_i  0$, the current separation is $r_{ij}(t) = y_j(t) - y_i(t)$, and the stretch is $s_{ij}(t) = \\dfrac{r_{ij}(t) - r_{0,ij}}{r_{0,ij}}$. The pairwise scalar force contribution along the bond is $f_{ij}(t) = c \\, s_{ij}(t) \\, V_i V_j$, acting positively on point $i$ and negatively on point $j$, where $V_i$ and $V_j$ are the associated point volumes. A bond irreversibly breaks when $s_{ij}(t) \\ge s_{\\mathrm{crit}}$.\n- Energetics: The kinetic energy is $E_{\\mathrm{kin}}(t) = \\sum_i \\dfrac{1}{2} m_i v_i(t)^2$, with $v_i(t)$ the material point velocity. The elastic energy stored in all unbroken bonds is $E_{\\mathrm{el}}(t) = \\sum_{(i,j) \\in \\mathcal{B}(t)} \\dfrac{1}{2} c \\, r_{0,ij} \\, s_{ij}(t)^2 \\, V_i V_j$, where $\\mathcal{B}(t)$ is the current set of unbroken bonds (each bond counted once). The fracture work accumulated due to broken bonds is $E_{\\mathrm{frac}}(t) = \\sum_{(i,j) \\in \\mathcal{F}(t)} \\dfrac{1}{2} c \\, r_{0,ij} \\, s_{\\mathrm{crit}}^2 \\, V_i V_j$, where $\\mathcal{F}(t)$ is the set of bonds that have broken up to time $t$.\n- Energy balance check: In the absence of external work, the ideal energy balance is $E_{\\mathrm{tot}}(t) = E_{\\mathrm{kin}}(t) + E_{\\mathrm{el}}(t) + E_{\\mathrm{frac}}(t) = \\mathrm{constant}$. Any deviation from constancy is due to numerical artifacts. Define the total numerical dissipation at a given time $t$ as $D_{\\mathrm{tot}}(t) = E_{\\mathrm{tot}}(0) - E_{\\mathrm{tot}}(t)$. When a bond is detected as broken at a discrete update time, the bond stretch may overshoot beyond $s_{\\mathrm{crit}}$; the associated overshoot energy that is not accounted by $E_{\\mathrm{frac}}$ is $D_{\\mathrm{nbr}}(t) = \\sum_{\\text{break events}} \\dfrac{1}{2} c \\, r_{0,ij} \\, \\left( s_{ij}(t)^2 - s_{\\mathrm{crit}}^2 \\right) \\, V_i V_j$, evaluated at the detection time. Attribute this quantity to stepwise neighbor (bond) update dissipation. Then attribute the remainder $D_{\\mathrm{time}}(t) = D_{\\mathrm{tot}}(t) - D_{\\mathrm{nbr}}(t)$ to explicit time integration error.\n\nGeometry and discretization:\n- A uniform one-dimensional bar of length $L$ is discretized into $N$ material points. The reference positions are $x_i = i \\, \\Delta x$ for $i = 0, 1, \\dots, N-1$, with $\\Delta x = L/(N-1)$. The point volume is $V_i = \\Delta x$ for all $i$. The mass of each point is $m_i = \\rho \\, A \\, V_i$, where $A$ is the cross-sectional area and $\\rho$ is the mass density. Use $A = 1$ and $\\rho = 1$ (non-dimensional consistent units).\n- The peridynamic horizon is $h$. The neighbor set in the reference configuration includes all pairs $(i,j)$ with $j  i$ and $x_j - x_i \\le h$. The influence function is unity for all bonds, so there is no additional weighting.\n\nTime integration and bond breaking:\n- Use explicit central difference updates with velocities stored at half time steps: $v_i^{n+\\frac{1}{2}} = v_i^{n-\\frac{1}{2}} + \\dfrac{F_i^n}{m_i} \\, \\Delta t$, and $y_i^{n+1} = y_i^n + v_i^{n+\\frac{1}{2}} \\, \\Delta t$, where $F_i^n$ is the net internal force computed from the unbroken bonds at configuration $y^n$. Initialize with $y_i^0 = x_i$ and $v_i^{\\frac{1}{2}} = v_i^0$ (since $F_i^0 = 0$ for $s_{ij}^0 = 0$).\n- After updating to $y^{n+1}$, detect all bonds with $s_{ij}^{n+1} \\ge s_{\\mathrm{crit}}$. For each such bond, accumulate the fracture work increment $\\Delta E_{\\mathrm{frac}} = \\dfrac{1}{2} c \\, r_{0,ij} \\, s_{\\mathrm{crit}}^2 \\, V_i V_j$, compute the overshoot dissipation increment $\\Delta D_{\\mathrm{nbr}} = \\dfrac{1}{2} c \\, r_{0,ij} \\, \\left( s_{ij}^{n+1}{}^2 - s_{\\mathrm{crit}}^2 \\right) \\, V_i V_j$, and mark the bond as broken so that it contributes no force or elastic energy thereafter. Note that the detection is done at discrete times and no sub-stepping is used; therefore, $\\Delta D_{\\mathrm{nbr}} \\ge 0$ when an overshoot occurs.\n\nInitial conditions:\n- The initial displacements are zero, $y_i^0 = x_i$. The initial velocities are a linear ramp $v_i^0 = v_{\\mathrm{amp}} \\, \\dfrac{x_i}{L}$, producing a uniform stretch rate across all bonds for small times. This choice results in a uniform initial stretch rate $ \\dot{s}_{ij}(0) \\approx \\dfrac{v_{\\mathrm{amp}}}{L}$ for all bonds within the horizon while $s_{ij}$ remains small.\n\nRequired outputs and units:\n- All quantities are non-dimensional (unitless consistent system). No physical unit conversion is required.\n- For each test case, compute at the final simulation time $T$ the following floats: $D_{\\mathrm{tot}}(T)$, $D_{\\mathrm{nbr}}(T)$, and $D_{\\mathrm{time}}(T)$. Additionally, compute the maximum total dissipation magnitude over the entire simulation, $D_{\\max} = \\max_{0 \\le t \\le T} \\left| D_{\\mathrm{tot}}(t) \\right|$, using values sampled at each time step.\n\nTest suite:\nImplement three test cases with the following parameter sets. In all cases, use $N = 101$, $L = 1$, $\\rho = 1$, $A = 1$, horizon $h = 3 \\Delta x$, micromodulus $c = 0.5$, and critical stretch $s_{\\mathrm{crit}} = 0.02$.\n1. Happy path: moderate time step and velocity amplitude, expecting some bond breaking and moderate overshoot.\n   - $\\Delta t = 2.0 \\times 10^{-4}$, $T = 5.0 \\times 10^{-2}$, $v_{\\mathrm{amp}} = 0.5$.\n2. Near-conservative boundary: small time step, expecting very low explicit integration error and reduced overshoot.\n   - $\\Delta t = 5.0 \\times 10^{-5}$, $T = 5.0 \\times 10^{-2}$, $v_{\\mathrm{amp}} = 0.5$.\n3. Edge case: large time step, expecting larger overshoot-induced dissipation and noticeable integration error.\n   - $\\Delta t = 8.0 \\times 10^{-4}$, $T = 5.0 \\times 10^{-2}$, $v_{\\mathrm{amp}} = 0.5$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case yields a list of four floats in order $[D_{\\mathrm{tot}}(T), D_{\\mathrm{nbr}}(T), D_{\\mathrm{time}}(T), D_{\\max}]$. The overall output is thus a list of three such lists, one per test case, e.g., $[[d_{1,\\mathrm{tot}}, d_{1,\\mathrm{nbr}}, d_{1,\\mathrm{time}}, d_{1,\\max}], [d_{2,\\mathrm{tot}}, d_{2,\\mathrm{nbr}}, d_{2,\\mathrm{time}}, d_{2,\\max}], [d_{3,\\mathrm{tot}}, d_{3,\\mathrm{nbr}}, d_{3,\\mathrm{time}}, d_{3,\\max}]]$.",
            "solution": "The problem requires the implementation of a one-dimensional, bond-based peridynamic simulation for a microelastic brittle bar. The objective is to perform a detailed energy balance analysis, quantifying numerical dissipation from two distinct sources: the explicit time integration scheme and the discrete nature of bond-breaking updates.\n\nThis solution begins by discretizing the one-dimensional bar of length $L$ into $N$ material points. The reference position of each point $i$ is $x_i = i \\Delta x$, where $i \\in \\{0, 1, \\dots, N-1\\}$ and the uniform spacing is $\\Delta x = L/(N-1)$. Each point has a volume $V_i = \\Delta x$ and mass $m_i = \\rho A V_i$, where $\\rho$ is the mass density and $A$ is the cross-sectional area. For this problem, we use $\\rho=1$ and $A=1$.\n\nThe peridynamic model is bond-based, meaning that material points interact through pairwise forces within a finite radius called the horizon, $h$. A bond is established between any two points $i$ and $j$ if their initial separation $r_{0,ij} = |x_j - x_i|$ is less than or equal to $h$. For implementation, we consider only pairs where $i  j$, so $r_{0,ij} = x_j - x_i$. This set of bonds is pre-computed and stored. The state of each bond (active or broken) is tracked throughout the simulation.\n\nThe dynamics of the system are governed by Newton's second law for each material point $i$:\n$$m_i \\ddot{y}_i(t) = F_i(t)$$\nwhere $y_i(t)$ is the current position of point $i$ and $F_i(t)$ is the net peridynamic force acting on it. The force is the sum of contributions from all bonds connected to point $i$. Based on the problem's definitions, a bond between points $i$ and $j$ (with $ij$) exerts a force of magnitude $f_{ij} = c \\, s_{ij} \\, V_i V_j$ on point $i$ in the positive direction and on point $j$ in the negative direction, assuming tension ($s_{ij}  0$). The stretch $s_{ij}$ is defined as $s_{ij}(t) = (r_{ij}(t) - r_{0,ij}) / r_{0,ij}$, where $r_{ij}(t) = y_j(t) - y_i(t)$ is the current separation. The net force on a point $k$ is the sum of forces from all bonds it participates in:\n$$F_k(t) = \\sum_{ik, \\text{bond }(i,k)} f_{ik}(t) - \\sum_{jk, \\text{bond } (k,j)} f_{kj}(t)$$\nHere, $f_{ab} = c \\, s_{ab} \\, V_a V_b$. This formulation is consistent with the negative gradient of the provided elastic potential energy, $F_k = -\\partial E_{\\mathrm{el}} / \\partial y_k$.\n\nThe time evolution is simulated using an explicit central-difference (leapfrog) method. Velocities are evaluated at half-integer time steps ($t_{n+1/2}$), while positions are evaluated at integer time steps ($t_n$). The update equations are:\n$$v_i^{n+1/2} = v_i^{n-1/2} + \\frac{F_i^n}{m_i} \\Delta t$$\n$$y_i^{n+1} = y_i^n + v_i^{n+1/2} \\Delta t$$\nwhere the superscript $n$ denotes the time step $t_n = n \\Delta t$. The simulation starts with initial conditions $y_i^0 = x_i$ and an initial velocity profile $v_i^0 = v_{\\mathrm{amp}} x_i / L$. Since the initial forces $F_i^0$ are zero (as $s_{ij}^0 = 0$), the half-step velocity is initialized as $v_i^{1/2} = v_i^0$.\n\nA crucial part of the model is the irreversible breaking of bonds. After each position update to $y^{n+1}$, the stretch $s_{ij}^{n+1}$ of every active bond is checked against a critical stretch, $s_{\\mathrm{crit}}$. If $s_{ij}^{n+1} \\ge s_{\\mathrm{crit}}$, the bond is marked as permanently broken. At this discretely detected moment of failure, two energy quantities are updated:\n1.  The fracture work, $E_{\\mathrm{frac}}$, which represents the energy consumed to create the new fracture surface. It is incremented by $\\Delta E_{\\mathrm{frac}} = \\frac{1}{2} c \\, r_{0,ij} \\, s_{\\mathrm{crit}}^2 \\, V_i V_j$.\n2.  The numerical dissipation due to bond-breaking overshoot, $D_{\\mathrm{nbr}}$. Since the check occurs at discrete time intervals, the stretch at detection, $s_{ij}^{n+1}$, can exceed $s_{\\mathrm{crit}}$. The excess elastic energy released at this moment is unaccounted for by the ideal fracture work and is considered a source of numerical dissipation. It is incremented by $\\Delta D_{\\mathrm{nbr}} = \\frac{1}{2} c \\, r_{0,ij} \\left( (s_{ij}^{n+1})^2 - s_{\\mathrm{crit}}^2 \\right) V_i V_j$.\n\nThe energy balance check requires computing the total energy of the system, $E_{\\mathrm{tot}}(t) = E_{\\mathrm{kin}}(t) + E_{\\mathrm{el}}(t) + E_{\\mathrm{frac}}(t)$, at each time step.\n-   The kinetic energy is $E_{\\mathrm{kin}}(t) = \\sum_i \\frac{1}{2} m_i v_i(t)^2$. To compute the velocity at an integer time step, $v_i^n$, we average the half-step velocities: $v_i^n = \\frac{1}{2}(v_i^{n-1/2} + v_i^{n+1/2})$. This provides a second-order accurate estimate.\n-   The elastic energy stored in all currently active bonds is $E_{\\mathrm{el}}(t_n) = \\sum_{(i,j) \\in \\mathcal{B}(t_n)} \\frac{1}{2} c \\, r_{0,ij} \\, (s_{ij}^n)^2 \\, V_i V_j$.\n-   The accumulated fracture work, $E_{\\mathrm{frac}}$, is the sum of all increments from broken bonds up to time $t$.\n\nThe total numerical dissipation at time $t$ is the deviation from the initial total energy: $D_{\\mathrm{tot}}(t) = E_{\\mathrm{tot}}(0) - E_{\\mathrm{tot}}(t)$. This total dissipation is then decomposed into two parts as per the problem statement: the previously calculated overshoot dissipation $D_{\\mathrm{nbr}}(t)$, and the residual dissipation attributed to the time integration scheme, $D_{\\mathrm{time}}(t) = D_{\\mathrm{tot}}(t) - D_{\\mathrm{nbr}}(t)$. The maximum absolute total dissipation, $D_{\\max} = \\max_{0 \\le t \\le T} |D_{\\mathrm{tot}}(t)|$, is also tracked throughout the simulation.\n\nThe algorithm proceeds by iterating through time steps. In each step $n$, it computes forces $F^n$ from positions $y^n$, updates velocities to $v^{n+1/2}$, calculates energies at $t_n$, updates positions to $y^{n+1}$, and finally checks for and processes any bond failures. This cycle repeats until the final time $T$ is reached. A final energy calculation is performed at time $T$ to obtain the required output values.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the peridynamic simulation for the specified test cases\n    and print the results in the required format.\n    \"\"\"\n\n    def run_simulation(N, L, rho, A, c, scrit, h, dt, T, v_amp):\n        \"\"\"\n        Executes a single peridynamic simulation with a given set of parameters.\n\n        Returns a list of floats: [D_tot(T), D_nbr(T), D_time(T), D_max].\n        \"\"\"\n        # 1. Discretization and Initialization\n        dx = L / (N - 1)\n        m = rho * A * dx\n        V2 = dx * dx  # Pre-calculate V_i * V_j as it's constant\n\n        x = np.linspace(0, L, N, dtype=np.float64)\n        y_n = np.copy(x)\n\n        # Initial velocities\n        v_0 = v_amp * x / L\n        \n        # Central difference scheme uses velocities at half-time steps.\n        # v_n_minus_half represents v^{n-1/2}.\n        # For initialization, v^{1/2} = v^0 since F^0 is zero.\n        v_n_minus_half = np.copy(v_0)\n\n        # 2. Bond Setup\n        bonds = []\n        for i in range(N):\n            for j in range(i + 1, N):\n                dist = x[j] - x[i]\n                if dist = h + 1e-9: # Add tolerance for float comparison\n                    bonds.append({'i': i, 'j': j, 'r0': dist, 'active': True})\n        \n        # 3. Energy Initialization\n        E_frac = 0.0\n        D_nbr = 0.0\n        \n        # Initial kinetic energy at t=0. v(0) = v_0.\n        E_kin_0 = 0.5 * m * np.sum(v_0**2)\n        # Initial elastic and fracture energies are zero.\n        E_tot_0 = E_kin_0\n\n        D_max = 0.0\n        \n        num_steps = int(round(T / dt))\n\n        # 4. Time-stepping Loop\n        for n in range(num_steps):\n            # A. Compute forces F^n from positions y^n\n            F_n = np.zeros(N, dtype=np.float64)\n            s_n_values = {}  # Store stretches s^n for energy calculation\n\n            for k, bond in enumerate(bonds):\n                if bond['active']:\n                    i, j = bond['i'], bond['j']\n                    r_n = y_n[j] - y_n[i]\n                    s_n = (r_n - bond['r0']) / bond['r0']\n                    s_n_values[k] = s_n\n                    \n                    f = c * s_n * V2\n                    F_n[i] += f\n                    F_n[j] -= f\n\n            # B. Update velocities from v^{n-1/2} to v^{n+1/2}\n            v_n_plus_half = v_n_minus_half + (F_n / m) * dt\n\n            # C. Energy calculation at time t_n\n            # v^n = (v^{n-1/2} + v^{n+1/2}) / 2\n            v_n = 0.5 * (v_n_minus_half + v_n_plus_half)\n            E_kin_n = 0.5 * m * np.sum(v_n**2)\n            \n            E_el_n = 0.0\n            for k, bond in enumerate(bonds):\n                if bond['active']:\n                    s_n = s_n_values[k]\n                    E_el_n += 0.5 * c * bond['r0'] * s_n**2 * V2\n\n            E_tot_n = E_kin_n + E_el_n + E_frac\n            D_tot_n = E_tot_0 - E_tot_n\n            D_max = max(D_max, abs(D_tot_n))\n\n            # D. Update positions from y^n to y^{n+1}\n            y_n_plus_1 = y_n + v_n_plus_half * dt\n            \n            # E. Check for bond breaks based on new positions y^{n+1}\n            # The accumulated E_frac, D_nbr will be used in the next step's energy calc\n            for k, bond in enumerate(bonds):\n                if bond['active']:\n                    i, j = bond['i'], bond['j']\n                    r_np1 = y_n_plus_1[j] - y_n_plus_1[i]\n                    s_np1 = (r_np1 - bond['r0']) / bond['r0']\n                    \n                    if s_np1 >= scrit:\n                        bond['active'] = False\n                        \n                        E_frac += 0.5 * c * bond['r0'] * scrit**2 * V2\n                        D_nbr += 0.5 * c * bond['r0'] * (s_np1**2 - scrit**2) * V2\n            \n            # F. Prepare for the next iteration\n            y_n = y_n_plus_1\n            v_n_minus_half = v_n_plus_half\n    \n        # 5. Post-loop: Final calculation at time T\n        # Current state: y_n = y^{N_steps}, v_n_minus_half = v^{N_steps-1/2}\n        \n        # Final force calculation at t_N = T\n        F_N = np.zeros(N, dtype=np.float64)\n        s_N_values = {}\n        for k, bond in enumerate(bonds):\n            if bond['active']:\n                i, j = bond['i'], bond['j']\n                r_N = y_n[j] - y_n[i]\n                s_N = (r_N - bond['r0']) / bond['r0']\n                s_N_values[k] = s_N\n                \n                f = c * s_N * V2\n                F_N[i] += f\n                F_N[j] -= f\n\n        # Final velocity updates to get v at time T\n        v_N_plus_half = v_n_minus_half + (F_N / m) * dt\n        v_N = 0.5 * (v_n_minus_half + v_N_plus_half)\n        \n        # Final energy calculation\n        E_kin_T = 0.5 * m * np.sum(v_N**2)\n        \n        E_el_T = 0.0\n        for k, bond in enumerate(bonds):\n            if bond['active']:\n                s_N = s_N_values[k]\n                E_el_T += 0.5 * c * bond['r0'] * s_N**2 * V2\n\n        # E_frac and D_nbr are their final accumulated values\n        E_tot_T = E_kin_T + E_el_T + E_frac\n        D_tot_T = E_tot_0 - E_tot_T\n        D_time_T = D_tot_T - D_nbr\n        \n        D_max = max(D_max, abs(D_tot_T))\n        \n        return [D_tot_T, D_nbr, D_time_T, D_max]\n\n    # --- Main execution ---\n    # Common parameters\n    N = 101\n    L = 1.0\n    rho = 1.0\n    A = 1.0\n    c = 0.5\n    scrit = 0.02\n    dx = L / (N - 1)\n    h = 3.0 * dx\n    \n    test_cases = [\n        # (dt, T, v_amp)\n        (2.0e-4, 5.0e-2, 0.5), # Case 1: Happy path\n        (5.0e-5, 5.0e-2, 0.5), # Case 2: Near-conservative\n        (8.0e-4, 5.0e-2, 0.5)  # Case 3: Edge case (large dt)\n    ]\n\n    results = []\n    for dt, T, v_amp in test_cases:\n        case_results = run_simulation(N, L, rho, A, c, scrit, h, dt, T, v_amp)\n        results.append(case_results)\n\n    # Format the final output string exactly as required\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}