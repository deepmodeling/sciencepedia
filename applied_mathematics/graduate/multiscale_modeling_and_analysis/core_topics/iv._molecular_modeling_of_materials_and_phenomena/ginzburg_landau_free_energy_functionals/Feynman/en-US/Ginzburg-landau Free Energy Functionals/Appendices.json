{
    "hands_on_practices": [
        {
            "introduction": "The Ginzburg-Landau theory provides a powerful framework for describing phase transitions. This first exercise explores the most fundamental consequence of the theory: the spontaneous emergence of an ordered state below a critical temperature. By minimizing the free energy for a spatially uniform system, you will derive the equilibrium value of the order parameter and calculate the condensation energy, which is the energy gained by transitioning into the ordered phase . This calculation is the cornerstone for understanding phenomena from superconductivity to structural phase transitions.",
            "id": "3812636",
            "problem": "In a coarse-grained multiscale description of a continuous phase transition in a material, the Ginzburg-Landau (GL) free energy density functional for a complex scalar order parameter $\\psi(\\mathbf{r})$ in zero magnetic field can be written, to leading nontrivial order in $|\\psi|$, as\n$$\nf[\\psi] \\;=\\; f_{n} \\;+\\; \\alpha(T)\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4} \\;+\\; \\frac{K}{2}\\,|\\nabla \\psi|^{2},\n$$\nwhere $f_{n}$ is the normal-state free energy density, $\\alpha(T)$ is a real coefficient that changes sign at the critical temperature, $\\beta0$ ensures stability, and $K0$ penalizes spatial variations. Consider the uniform, zero-field case so that $\\nabla \\psi=\\mathbf{0}$. Assume temperatures below the critical temperature such that $\\alpha(T)\\equiv \\alpha0$. Starting only from the variational principle that equilibrium minimizes the free energy with respect to $\\psi$ and its complex conjugate, determine the uniform equilibrium magnitude of the order parameter and evaluate the corresponding free-energy density difference $\\Delta f \\equiv f_{\\mathrm{eq}} - f_{n}$.\n\nExpress your final answer as a single closed-form analytic expression for $\\Delta f$ in terms of $\\alpha$ and $\\beta$. Do not insert any numerical values. No rounding is required and no units should be reported in the final answer.",
            "solution": "The problem is valid as it is scientifically grounded in the established Ginzburg-Landau theory of phase transitions, is well-posed with sufficient and consistent conditions, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe Ginzburg-Landau (GL) free energy density functional is given as:\n$$\nf[\\psi] \\;=\\; f_{n} \\;+\\; \\alpha(T)\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4} \\;+\\; \\frac{K}{2}\\,|\\nabla \\psi|^{2}\n$$\nThe problem specifies the uniform case, where the order parameter $\\psi$ is spatially constant. This implies that its gradient is zero: $\\nabla \\psi = \\mathbf{0}$. The problem also considers temperatures below the critical temperature, such that the coefficient $\\alpha(T)$ is a negative constant, denoted as $\\alpha  0$. Under these conditions, the gradient term vanishes, and the free energy density becomes a function of the magnitude of the order parameter, $|\\psi|$:\n$$\nf(\\psi) \\;=\\; f_{n} \\;+\\; \\alpha\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4}\n$$\nThe order parameter $\\psi$ is a complex scalar, which can be expressed in polar form as $\\psi = \\rho\\,e^{i\\theta}$, where $\\rho = |\\psi| \\ge 0$ is the magnitude and $\\theta$ is the phase. The free energy density expression depends only on the magnitude $\\rho$:\n$$\nf(\\rho) \\;=\\; f_{n} \\;+\\; \\alpha\\,\\rho^{2} \\;+\\; \\frac{\\beta}{2}\\,\\rho^{4}\n$$\nAccording to the variational principle, the system at equilibrium will adopt a state that minimizes this free energy density. To find the minimum, we must find the extrema of $f(\\rho)$ with respect to $\\rho$ and then identify which extremum corresponds to a stable equilibrium (a minimum). We differentiate $f(\\rho)$ with respect to $\\rho$ and set the result to zero:\n$$\n\\frac{df}{d\\rho} \\;=\\; \\frac{d}{d\\rho} \\left( f_{n} \\;+\\; \\alpha\\,\\rho^{2} \\;+\\; \\frac{\\beta}{2}\\,\\rho^{4} \\right) \\;=\\; 2\\alpha\\rho \\;+\\; 2\\beta\\rho^{3}\n$$\nSetting the derivative to zero yields the condition for the extrema:\n$$\n2\\alpha\\rho \\;+\\; 2\\beta\\rho^{3} \\;=\\; 0\n$$\n$$\n2\\rho(\\alpha \\;+\\; \\beta\\rho^{2}) \\;=\\; 0\n$$\nThis equation provides two possible solutions for the equilibrium magnitude $\\rho_{\\mathrm{eq}}$:\n$1$. $\\rho_{\\mathrm{eq}} = 0$. This corresponds to the normal, disordered state where $|\\psi|=0$.\n$2$. $\\alpha + \\beta\\rho_{\\mathrm{eq}}^{2} = 0$, which implies $\\rho_{\\mathrm{eq}}^{2} = -\\frac{\\alpha}{\\beta}$.\n\nSince $\\rho_{\\mathrm{eq}}$ represents a physical magnitude, it must be a real, non-negative number. The problem states that $\\alpha  0$ and $\\beta  0$. Therefore, the ratio $-\\frac{\\alpha}{\\beta}$ is positive, and a real, non-trivial solution for the magnitude exists:\n$$\n\\rho_{\\mathrm{eq}} = \\sqrt{-\\frac{\\alpha}{\\beta}}\n$$\nTo determine which of these two solutions, $\\rho=0$ or $\\rho=\\sqrt{-\\frac{\\alpha}{\\beta}}$, corresponds to a stable equilibrium, we examine the second derivative of the free energy density, $\\frac{d^{2}f}{d\\rho^{2}}$:\n$$\n\\frac{d^{2}f}{d\\rho^{2}} \\;=\\; \\frac{d}{d\\rho} \\left( 2\\alpha\\rho \\;+\\; 2\\beta\\rho^{3} \\right) \\;=\\; 2\\alpha \\;+\\; 6\\beta\\rho^{2}\n$$\nFor the trivial solution $\\rho=0$:\n$$\n\\left. \\frac{d^{2}f}{d\\rho^{2}} \\right|_{\\rho=0} \\;=\\; 2\\alpha\n$$\nSince $\\alpha  0$, the second derivative is negative. This indicates that $\\rho=0$ is a local maximum, representing an unstable equilibrium state.\n\nFor the non-trivial solution $\\rho^{2} = -\\frac{\\alpha}{\\beta}$:\n$$\n\\left. \\frac{d^{2}f}{d\\rho^{2}} \\right|_{\\rho^{2}=-\\alpha/\\beta} \\;=\\; 2\\alpha \\;+\\; 6\\beta\\left(-\\frac{\\alpha}{\\beta}\\right) \\;=\\; 2\\alpha - 6\\alpha \\;=\\; -4\\alpha\n$$\nSince $\\alpha  0$, the second derivative $-4\\alpha$ is positive. This indicates that $\\rho = \\sqrt{-\\frac{\\alpha}{\\beta}}$ corresponds to a local minimum, representing the stable equilibrium state. The equilibrium magnitude of the order parameter is thus $|\\psi|_{\\mathrm{eq}} = \\sqrt{-\\frac{\\alpha}{\\beta}}$.\n\nThe final step is to calculate the free energy density difference $\\Delta f = f_{\\mathrm{eq}} - f_{n}$. We substitute the equilibrium magnitude squared, $|\\psi|_{\\mathrm{eq}}^{2} = -\\frac{\\alpha}{\\beta}$, into the free energy expression to find $f_{\\mathrm{eq}}$:\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;+\\; \\alpha\\,|\\psi|_{\\mathrm{eq}}^{2} \\;+\\; \\frac{\\beta}{2}\\,(|\\psi|_{\\mathrm{eq}}^{2})^{2}\n$$\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;+\\; \\alpha\\left(-\\frac{\\alpha}{\\beta}\\right) \\;+\\; \\frac{\\beta}{2}\\left(-\\frac{\\alpha}{\\beta}\\right)^{2}\n$$\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;-\\; \\frac{\\alpha^{2}}{\\beta} \\;+\\; \\frac{\\beta}{2}\\left(\\frac{\\alpha^{2}}{\\beta^{2}}\\right)\n$$\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;-\\; \\frac{\\alpha^{2}}{\\beta} \\;+\\; \\frac{\\alpha^{2}}{2\\beta}\n$$\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;-\\; \\frac{\\alpha^{2}}{2\\beta}\n$$\nThe required free-energy density difference is then:\n$$\n\\Delta f \\;=\\; f_{\\mathrm{eq}} - f_{n} \\;=\\; \\left(f_{n} \\;-\\; \\frac{\\alpha^{2}}{2\\beta}\\right) - f_{n} \\;=\\; -\\frac{\\alpha^{2}}{2\\beta}\n$$\nThis result, known as the condensation energy density, is negative, confirming that the ordered state is energetically more favorable than the normal state when $\\alpha  0$.",
            "answer": "$$\\boxed{-\\frac{\\alpha^{2}}{2\\beta}}$$"
        },
        {
            "introduction": "While uniform phases are the simplest solutions, many systems exhibit intricate, spatially modulated patterns. This practice delves into the origins of such patterns by analyzing the stability of a simple uniform state against small fluctuations . Using the method of linear stability analysis on a Ginzburg-Landau functional with competing gradient energy terms, you will determine which spatial modes are unstable and identify the characteristic length scale of the emergent pattern. This exercise provides a crucial theoretical tool for predicting microstructures in alloys, block copolymers, and other self-organizing systems.",
            "id": "3812657",
            "problem": "Consider a coarse-grained order-parameter field $\\phi(\\mathbf{x})$ describing a mesoscale phase in a crystalline alloy obtained by systematic coarse-graining from atomistic interactions in multiscale materials simulation. The Ginzburg-Landau free energy functional $F[\\phi]$ is defined on a $d$-dimensional domain of volume $V$ with periodic boundary conditions, and is given by\n$$\nF[\\phi] \\;=\\; \\int_{V} \\left( \\frac{a}{2}\\,\\phi^{2} \\;+\\; \\frac{b}{4}\\,\\phi^{4} \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla \\phi|^{2} \\;+\\; \\frac{\\gamma}{2}\\,(\\nabla^{2}\\phi)^{2} \\right)\\,\\mathrm{d}^{d}x,\n$$\nwhere $a$, $b$, $\\kappa$, and $\\gamma$ are constant material parameters with $b0$ and $\\gamma0$. Assume $\\kappa0$, corresponding to a system that energetically favors modulated structures over uniform gradients at intermediate length scales.\n\nUsing first principles of calculus of variations and definitions of the functional derivative, do the following:\n\n1. Derive the Euler-Lagrange stationarity condition for $F[\\phi]$ and show that a spatially uniform field $\\phi(\\mathbf{x})=\\phi_{0}$ satisfies a local algebraic condition. Identify the uniform solution $\\phi_{0}=0$ as a stationary solution for $a\\ge 0$.\n\n2. Starting from the definition of the second variation, derive the quadratic form that governs the stability of small perturbations $\\psi(\\mathbf{x})$ around the uniform state $\\phi_{0}=0$. You must explicitly use integration by parts under periodic boundary conditions to express the second variation in terms of $\\psi$, its gradients, and Laplacians.\n\n3. Represent $\\psi(\\mathbf{x})$ in a Fourier series consistent with periodic boundary conditions and obtain the spectral (Fourier-space) quadratic coefficient $C(k)$ as a function of the wavenumber magnitude $k=|\\mathbf{k}|$.\n\n4. Using your expression for $C(k)$, define the nondimensional wavenumber $q$ through the length scale $\\ell = \\sqrt{\\gamma/(-\\kappa)}$ by $q = k\\,\\ell$. Determine the value $q_{*}$ that minimizes $C(k)$ over all $k\\ge 0$, which identifies the most unstable mode when instability is present. Provide your final answer for $q_{*}$ as a single number. Since $q$ is dimensionless, you do not need to specify units. Do not round; give the exact value.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and self-contained. It describes a prototypical Ginzburg-Landau model for pattern formation, often referred to as a Swift-Hohenberg-type model, which is a standard topic in theoretical materials science and condensed matter physics. The parameters and conditions, specifically $\\kappa0$ and $\\gamma0$, are physically meaningful as they describe competing interactions that can lead to the formation of modulated structures. The tasks represent a standard linear stability analysis of a uniform state. The problem is therefore valid, and we proceed with a full solution.\n\nThe Ginzburg-Landau free energy functional is given by\n$$\nF[\\phi] \\;=\\; \\int_{V} \\left( \\frac{a}{2}\\,\\phi^{2} \\;+\\; \\frac{b}{4}\\,\\phi^{4} \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla \\phi|^{2} \\;+\\; \\frac{\\gamma}{2}\\,(\\nabla^{2}\\phi)^{2} \\right)\\,\\mathrm{d}^{d}x\n$$\nThe integrand, which we denote as the free energy density $f(\\phi, \\nabla\\phi, \\nabla^2\\phi)$, is\n$$\nf \\;=\\; \\frac{a}{2}\\,\\phi^{2} \\;+\\; \\frac{b}{4}\\,\\phi^{4} \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla \\phi|^{2} \\;+\\; \\frac{\\gamma}{2}\\,(\\nabla^{2}\\phi)^{2}\n$$\n\n1.  **Derivation of the Euler-Lagrange Stationarity Condition**\n\nThe stationarity condition for the functional $F[\\phi]$ is found by setting its first variation, $\\delta F$, to zero.\n$$\n\\delta F \\;=\\; \\int_{V} \\left( \\frac{\\partial f}{\\partial \\phi} \\delta \\phi \\;+\\; \\frac{\\partial f}{\\partial (\\nabla\\phi)} \\cdot \\delta(\\nabla\\phi) \\;+\\; \\frac{\\partial f}{\\partial (\\nabla^2\\phi)} \\delta(\\nabla^2\\phi) \\right)\\,\\mathrm{d}^{d}x \\;=\\; 0\n$$\nThe partial derivatives of the integrand $f$ are:\n$$\n\\frac{\\partial f}{\\partial \\phi} \\;=\\; a\\phi \\;+\\; b\\phi^{3}\n$$\n$$\n\\frac{\\partial f}{\\partial (\\nabla\\phi)} \\;=\\; \\kappa \\nabla\\phi\n$$\n$$\n\\frac{\\partial f}{\\partial (\\nabla^2\\phi)} \\;=\\; \\gamma \\nabla^2\\phi\n$$\nSubstituting these into the expression for $\\delta F$:\n$$\n\\delta F \\;=\\; \\int_{V} \\left( (a\\phi + b\\phi^{3})\\delta\\phi \\;+\\; (\\kappa \\nabla\\phi) \\cdot \\nabla(\\delta\\phi) \\;+\\; (\\gamma \\nabla^2\\phi) \\nabla^2(\\delta\\phi) \\right)\\,\\mathrm{d}^{d}x\n$$\nWe integrate the terms involving derivatives of the variation $\\delta\\phi$ by parts. For the second term, using the vector identity $\\nabla \\cdot (\\mathbf{A} s) = (\\nabla \\cdot \\mathbf{A}) s + \\mathbf{A} \\cdot \\nabla s$ and the divergence theorem, the periodic boundary conditions cause the surface integral to vanish:\n$$\n\\int_{V} (\\kappa \\nabla\\phi) \\cdot \\nabla(\\delta\\phi) \\,\\mathrm{d}^{d}x \\;=\\; \\int_{\\partial V} \\delta\\phi(\\kappa \\nabla\\phi) \\cdot \\mathrm{d}\\mathbf{S} - \\int_{V} \\delta\\phi \\, \\nabla \\cdot (\\kappa \\nabla\\phi) \\,\\mathrm{d}^{d}x \\;=\\; - \\int_{V} \\delta\\phi \\, (\\kappa \\nabla^2\\phi) \\,\\mathrm{d}^{d}x\n$$\nFor the third term, we apply integration by parts twice, with boundary terms vanishing at each step due to periodic conditions:\n$$\n\\int_{V} (\\gamma \\nabla^2\\phi) \\nabla^2(\\delta\\phi) \\,\\mathrm{d}^{d}x \\;=\\; - \\int_{V} \\nabla(\\gamma \\nabla^2\\phi) \\cdot \\nabla(\\delta\\phi) \\,\\mathrm{d}^{d}x \\;=\\; \\int_{V} \\delta\\phi \\, \\nabla^2(\\gamma \\nabla^2\\phi) \\,\\mathrm{d}^{d}x \\;=\\; \\int_{V} \\delta\\phi \\, (\\gamma \\nabla^4\\phi) \\,\\mathrm{d}^{d}x\n$$\nCombining all terms, the first variation becomes:\n$$\n\\delta F \\;=\\; \\int_{V} \\left( a\\phi + b\\phi^{3} - \\kappa\\nabla^2\\phi + \\gamma\\nabla^4\\phi \\right) \\delta\\phi \\,\\mathrm{d}^{d}x\n$$\nSince this must hold for an arbitrary perturbation $\\delta\\phi$, the integrand must be zero. This yields the Euler-Lagrange equation:\n$$\na\\phi + b\\phi^{3} - \\kappa\\nabla^{2}\\phi + \\gamma\\nabla^{4}\\phi \\;=\\; 0\n$$\nFor a spatially uniform field $\\phi(\\mathbf{x}) = \\phi_{0}$, all spatial derivatives vanish ($\\nabla^2\\phi_0 = 0$, $\\nabla^4\\phi_0 = 0$). The Euler-Lagrange equation reduces to a local algebraic condition:\n$$\na\\phi_{0} + b\\phi_{0}^{3} \\;=\\; 0 \\quad \\implies \\quad \\phi_{0}(a + b\\phi_{0}^{2}) \\;=\\; 0\n$$\nThe solutions are $\\phi_{0}=0$ and, if $-a/b \\ge 0$, $\\phi_{0} = \\pm\\sqrt{-a/b}$. Since we are given $b0$, real non-zero solutions exist only if $a0$. For $a \\ge 0$, the only real uniform solution is $\\phi_{0}=0$. Thus, $\\phi_0=0$ is indeed a stationary solution for any $a$, and it is the unique uniform one for $a \\ge 0$.\n\n2.  **Second Variation around $\\phi_{0}=0$**\n\nTo determine the stability of the uniform state $\\phi_0=0$, we examine the second variation of the free energy, $\\delta^2 F$, for a small perturbation $\\psi(\\mathbf{x})$. Let $\\phi(\\mathbf{x}) = \\phi_{0} + \\psi(\\mathbf{x}) = \\psi(\\mathbf{x})$. We substitute this into the functional $F[\\phi]$ and expand, retaining only terms up to quadratic order in $\\psi$ and its derivatives. The constant term $F[0]$ is zero, and the first-order term (first variation) is zero because $\\phi_0=0$ is a stationary point. The fourth-order term $\\frac{b}{4}\\psi^{4}$ is of higher order and is neglected in the quadratic stability analysis.\nThe second variation $\\delta^2 F$ is thus given by the quadratic part of the functional:\n$$\n\\delta^2 F|_0[\\psi] \\;=\\; \\int_{V} \\left( \\frac{a}{2}\\,\\psi^{2} \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\;+\\; \\frac{\\gamma}{2}\\,(\\nabla^{2}\\psi)^{2} \\right)\\,\\mathrm{d}^{d}x\n$$\nThis expression is the quadratic form governing the stability of small perturbations. A factor of $1/2$ is conventionally included. The state $\\phi_0=0$ is stable if $\\delta^2 F|_0[\\psi]  0$ for all non-zero $\\psi$. As requested, we can use integration by parts, as performed in the previous section, to rewrite the derivative terms. This shows the equivalence of the energy form to an operator form:\n$$\n\\int_V \\frac{\\kappa}{2}|\\nabla \\psi|^2 \\,\\mathrm{d}^d x \\;=\\; -\\frac{1}{2} \\int_V \\psi (\\kappa \\nabla^2\\psi) \\,\\mathrm{d}^d x\n$$\n$$\n\\int_V \\frac{\\gamma}{2}(\\nabla^2 \\psi)^2 \\,\\mathrm{d}^d x \\;=\\; \\frac{1}{2} \\int_V \\psi (\\gamma \\nabla^4\\psi) \\,\\mathrm{d}^d x\n$$\nThus, the second variation can be written as an inner product $\\frac{1}{2}\\langle \\psi, \\mathcal{L}\\psi \\rangle$, where $\\mathcal{L}$ is the linear stability operator:\n$$\n\\mathcal{L} \\;=\\; a - \\kappa\\nabla^2 + \\gamma\\nabla^4\n$$\n\n3.  **Spectral Representation and Coefficient $C(k)$**\n\nTo analyze the stability, we decompose the perturbation $\\psi(\\mathbf{x})$ into its Fourier series, which is a basis of eigenfunctions for the linear operator $\\mathcal{L}$ under periodic boundary conditions:\n$$\n\\psi(\\mathbf{x}) \\;=\\; \\sum_{\\mathbf{k}} \\hat{\\psi}_{\\mathbf{k}} e^{i\\mathbf{k}\\cdot\\mathbf{x}}\n$$\nwhere $\\mathbf{k}$ are the wavevectors compatible with the periodic domain, and $\\hat{\\psi}_{\\mathbf{k}}$ are the complex Fourier coefficients satisfying $\\hat{\\psi}_{-\\mathbf{k}} = \\hat{\\psi}_{\\mathbf{k}}^{*}$ since $\\psi(\\mathbf{x})$ is real. We substitute this series into the quadratic form for $\\delta^2 F|_0[\\psi]$. Using Parseval's theorem or by direct substitution and integration, we can express each term in Fourier space:\n$$\n\\int_{V} \\psi^2\\,\\mathrm{d}^d x = V \\sum_{\\mathbf{k}} |\\hat{\\psi}_{\\mathbf{k}}|^2\n$$\n$$\n\\int_{V} |\\nabla\\psi|^2\\,\\mathrm{d}^d x = \\int_{V} \\left( \\sum_{\\mathbf{k}} i\\mathbf{k}\\,\\hat{\\psi}_{\\mathbf{k}} e^{i\\mathbf{k}\\cdot\\mathbf{x}} \\right) \\cdot \\left( \\sum_{\\mathbf{k'}} -i\\mathbf{k'}\\,\\hat{\\psi}_{\\mathbf{k'}}^{*} e^{-i\\mathbf{k'}\\cdot\\mathbf{x}} \\right) \\mathrm{d}^d x = V \\sum_{\\mathbf{k}} k^2 |\\hat{\\psi}_{\\mathbf{k}}|^2\n$$\nwhere $k = |\\mathbf{k}|$.\n$$\n\\int_{V} (\\nabla^2\\psi)^2\\,\\mathrm{d}^d x = \\int_{V} \\left( \\sum_{\\mathbf{k}} (-k^2)\\,\\hat{\\psi}_{\\mathbf{k}} e^{i\\mathbf{k}\\cdot\\mathbf{x}} \\right) \\left( \\sum_{\\mathbf{k'}} (-k'^2)\\,\\hat{\\psi}_{\\mathbf{k'}}^{*} e^{-i\\mathbf{k'}\\cdot\\mathbf{x}} \\right) \\mathrm{d}^d x = V \\sum_{\\mathbf{k}} k^4 |\\hat{\\psi}_{\\mathbf{k}}|^2\n$$\nSubstituting these back into the expression for $\\delta^2 F|_0[\\psi]$ gives:\n$$\n\\delta^2 F|_0[\\psi] \\;=\\; \\frac{V}{2} \\sum_{\\mathbf{k}} \\left( a + \\kappa k^2 + \\gamma k^4 \\right) |\\hat{\\psi}_{\\mathbf{k}}|^2\n$$\nThe stability of the system is determined by the sign of the coefficient of $|\\hat{\\psi}_{\\mathbf{k}}|^2$. This spectral quadratic coefficient, a function of the wavenumber magnitude $k$, is:\n$$\nC(k) \\;=\\; a + \\kappa k^2 + \\gamma k^4\n$$\n\n4.  **Minimization of $C(k)$ and Determination of $q_{*}$**\n\nThe system first becomes unstable to the mode(s) with the wavevector $\\mathbf{k}_*$ for which $C(k)$ is a minimum. To find this minimum, we differentiate $C(k)$ with respect to $k$ and set the result to zero. It is simpler to find the minimum with respect to $x=k^2$, since $k \\ge 0$.\n$$\nC(x) \\;=\\; a + \\kappa x + \\gamma x^2\n$$\n$$\n\\frac{\\mathrm{d}C}{\\mathrm{d}x} \\;=\\; \\kappa + 2\\gamma x \\;=\\; 0 \\quad \\implies \\quad x \\;=\\; -\\frac{\\kappa}{2\\gamma}\n$$\nSince $\\kappa  0$ and $\\gamma  0$, this value of $x$ is positive, so a real $k$ exists. The second derivative $\\frac{\\mathrm{d}^2C}{\\mathrm{d}x^2}=2\\gamma  0$, confirming this is a minimum.\nThe wavenumber $k_*$ that minimizes $C(k)$ is therefore:\n$$\nk_*^2 \\;=\\; -\\frac{\\kappa}{2\\gamma} \\quad \\implies \\quad k_* \\;=\\; \\sqrt{-\\frac{\\kappa}{2\\gamma}}\n$$\nWe are asked to find the corresponding nondimensional wavenumber $q_* = k_* \\ell$, where the characteristic length scale is $\\ell = \\sqrt{\\gamma/(-\\kappa)}$.\nWe substitute the expression for $k_*$ and $\\ell$:\n$$\nq_* \\;=\\; k_* \\ell \\;=\\; \\left(\\sqrt{-\\frac{\\kappa}{2\\gamma}}\\right) \\left(\\sqrt{\\frac{\\gamma}{-\\kappa}}\\right) \\;=\\; \\sqrt{\\left(-\\frac{\\kappa}{2\\gamma}\\right)\\left(\\frac{\\gamma}{-\\kappa}\\right)}\n$$\nThe terms inside the square root simplify:\n$$\nq_* \\;=\\; \\sqrt{\\frac{(-\\kappa)\\gamma}{2\\gamma(-\\kappa)}} \\;=\\; \\sqrt{\\frac{1}{2}}\n$$\nThe value of the nondimensional wavenumber $q_*$ that minimizes $C(k)$ is $\\frac{1}{\\sqrt{2}}$.",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$"
        },
        {
            "introduction": "Analytical solutions to Ginzburg-Landau equations are often limited to simple cases. This computational practice challenges you to bridge theory and simulation by numerically minimizing the free energy for a superconductor in a magnetic field . By implementing a gradient descent algorithm on a discrete grid, you will simulate the response of the superconducting order parameter to an external field and witness the formation of quantized vortices. This exercise provides essential hands-on experience in computational materials science, from implementing gauge-invariant numerical schemes to calculating topological properties of the resulting field configuration.",
            "id": "3766232",
            "problem": "Consider the extreme type-II limit of the Ginzburg-Landau (GL) theory for a two-dimensional superconducting strip, where magnetic field variations due to supercurrents are neglected. In this limit, the vector potential is externally imposed and the GL free energy functional reduces to the following nondimensionalized form on a rectangular domain $\\Omega = [0,L_x] \\times [0,W]$:\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int_{\\Omega} \\left( \\left| (\\nabla - i \\mathbf{A}) \\psi \\right|^2 \\;+\\; \\frac{1}{2} \\left( 1 - |\\psi|^2 \\right)^2 \\right) \\, d^2\\mathbf{r},\n$$\nwhere $\\psi(\\mathbf{r})$ is the complex order parameter, $\\mathbf{A}$ is the vector potential corresponding to a uniform perpendicular magnetic field of nondimensional strength $B$, and all quantities are dimensionless. Use the Landau gauge $\\mathbf{A} = (-B y, 0)$ so that $A_x = -B y$ and $A_y = 0$. Impose periodic boundary conditions along the $x$-direction and the de Gennes (superconductorâ€“insulator) boundary condition along the $y$-direction:\n$$\n\\mathbf{n} \\cdot (\\nabla - i \\mathbf{A}) \\psi \\;=\\; 0 \\quad \\text{on} \\quad y=0 \\quad \\text{and} \\quad y=W,\n$$\nwhere $\\mathbf{n}$ is the outward unit normal. Angles must be treated in radians.\n\nYou must minimize $\\mathcal{F}[\\psi]$ numerically on a uniform discrete grid by gradient flow (steepest descent) starting from a slightly perturbed uniform initial state. Discretize the covariant derivatives with gauge-invariant link variables. On a uniform grid with $N_x$ points in $x$ and $N_y$ points in $y$, spacings $\\Delta x$ and $\\Delta y$ (use $\\Delta x = \\Delta y$), define the forward covariant difference operators:\n$$\nD_x \\psi_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} - \\psi_{i,j}, \\quad U_{x,j} \\;=\\; e^{-i A_x(j) \\Delta x} \\;=\\; e^{i B \\, y_j \\, \\Delta x},\n$$\n$$\nD_y \\psi_{i,j} \\;=\\; \\psi_{i,j+1} - \\psi_{i,j},\n$$\nwith periodic indexing in $i$ and $y_0 = 0$, $y_j = j \\, \\Delta y$. The adjoint operators on the grid yield the gauge-covariant discrete Laplacian components:\n$$\nD_x^\\dagger D_x \\psi_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} + U_{x,j}^\\ast \\, \\psi_{i-1,j} - 2 \\psi_{i,j},\n$$\n$$\nD_y^\\dagger D_y \\psi_{i,j} \\;=\\; \\psi_{i,j+1} + \\psi_{i,j-1} - 2 \\psi_{i,j},\n$$\nwhere the de Gennes boundary condition is enforced by reflection in $y$ so that $\\psi_{i,-1} = \\psi_{i,0}$ and $\\psi_{i,N_y} = \\psi_{i,N_y-1}$. The steepest descent evolution (a nondimensionalized form of the time-dependent GL gradient flow) is\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; - \\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast} \\;=\\; - \\left( D_x^\\dagger D_x \\psi + D_y^\\dagger D_y \\psi - \\left(1 - |\\psi|^2\\right)\\psi \\right),\n$$\nwhich you must discretize explicitly with a time step $\\Delta t$:\n$$\n\\psi^{(n+1)} \\;=\\; \\psi^{(n)} \\;-\\; \\Delta t \\left( D_x^\\dagger D_x \\psi^{(n)} + D_y^\\dagger D_y \\psi^{(n)} - \\left(1 - \\left|\\psi^{(n)}\\right|^2\\right)\\psi^{(n)} \\right).\n$$\n\nTo quantify vortex entry and boundary-induced patterning, compute the total gauge-invariant vorticity after convergence, using gauge-invariant phase differences on links:\n$$\n\\delta\\theta_x(i,j) \\;=\\; \\mathrm{wrap}\\left( \\arg(\\psi_{i+1,j}) - \\arg(\\psi_{i,j}) - \\arg(U_{x,j}) \\right), \\quad \\delta\\theta_y(i,j) \\;=\\; \\mathrm{wrap}\\left( \\arg(\\psi_{i,j+1}) - \\arg(\\psi_{i,j}) \\right),\n$$\nwhere $\\mathrm{wrap}(\\cdot)$ maps angles to $(-\\pi,\\pi]$. The plaquette vorticity (gauge-invariant circulation) is\n$$\n\\omega(i,j) \\;=\\; \\mathrm{wrap}\\left( \\delta\\theta_x(i,j) + \\delta\\theta_y(i+1,j) - \\delta\\theta_x(i,j+1) - \\delta\\theta_y(i,j) \\right),\n$$\nfor $i \\in \\{0,\\dots,N_x-1\\}$ with periodic wrap in $i$ and $j \\in \\{0,\\dots,N_y-2\\}$. The net integer vortex count is then\n$$\nN_v \\;=\\; \\mathrm{round}\\left( \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-2} \\omega(i,j) \\right).\n$$\n\nYour program must implement the above discretization with the following fixed grid and numerical parameters, in dimensionless units:\n- Use $N_x = 24$, $N_y = 12$, $\\Delta x = \\Delta y = 1$.\n- Use an explicit gradient descent with $\\Delta t = 0.05$ and a total of $N_{\\mathrm{iter}} = 400$ iterations per test.\n- Initialize $\\psi$ as $\\psi_{i,j}^{(0)} = 1 + \\epsilon \\, \\eta_{i,j}$ with $\\epsilon = 10^{-2}$ and $\\eta_{i,j}$ a complex Gaussian perturbation with zero mean and unit variance, using a fixed random seed for reproducibility.\n\nTest suite:\n- Case $1$: $B = 0.0000$ (very low field; expected vortex-free).\n- Case $2$: $B = \\frac{2\\pi}{N_x (N_y - 1)} \\approx 0.0238$ (approximately one flux quantum across the strip interior).\n- Case $3$: $B = \\frac{4\\pi}{N_x (N_y - 1)} \\approx 0.0476$ (approximately two flux quanta).\n- Case $4$: $B = \\frac{6\\pi}{N_x (N_y - 1)} \\approx 0.0714$ (approximately three flux quanta).\n- Case $5$ (edge coverage, non-integer flux): $B = \\frac{3\\pi}{N_x (N_y - 1)} \\approx 0.0357$.\n\nFor each case, after minimizing $\\mathcal{F}[\\psi]$, compute $N_v$ as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[n_1,n_2,n_3,n_4,n_5]$, where each $n_k$ is the integer vortex count for the corresponding test case. All quantities are dimensionless; no physical unit conversion is required, and all angles are in radians.",
            "solution": "The problem requires the numerical minimization of a Ginzburg-Landau (GL) free energy functional for a two-dimensional superconducting strip. This is achieved by simulating the gradient flow of the order parameter, $\\psi$, using an explicit time-stepping method on a discrete grid. The primary goal is to compute the number of emergent vortices, $N_v$, for different strengths of an external magnetic field, $B$. The problem is well-posed, scientifically sound, and provides a complete set of instructions for the numerical implementation.\n\nThe Ginzburg-Landau free energy functional on the domain $\\Omega = [0,L_x] \\times [0,W]$ is given by:\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int_{\\Omega} \\left( \\left| (\\nabla - i \\mathbf{A}) \\psi \\right|^2 \\;+\\; \\frac{1}{2} \\left( 1 - |\\psi|^2 \\right)^2 \\right) \\, d^2\\mathbf{r}\n$$\nHere, $\\psi$ is the complex order parameter, and $\\mathbf{A} = (-B y, 0)$ is the vector potential in the Landau gauge for a uniform magnetic field of strength $B$.\n\nThe minimization of $\\mathcal{F}[\\psi]$ is performed using a steepest descent (gradient flow) method. This corresponds to evolving $\\psi$ in fictitious time $t$ according to the time-dependent Ginzburg-Landau equation:\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; - \\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}\n$$\nThe variational derivative $\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}$ is given in the problem statement, leading to the evolution equation:\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; (\\nabla - i \\mathbf{A})^2 \\psi + (1 - |\\psi|^2)\\psi\n$$\nThe term $(\\nabla - i \\mathbf{A})^2 \\psi$ is the gauge-covariant Laplacian. The problem provides a specific, explicit discretization of this equation on a uniform grid, which we will implement.\n\nThe domain is discretized into a grid of size $N_x \\times N_y$ with lattice spacings $\\Delta x = \\Delta y = 1$. The order parameter $\\psi(\\mathbf{r})$ becomes a complex array $\\psi_{i,j}$, where $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$.\n\nThe time evolution is discretized using an explicit forward Euler scheme with a time step $\\Delta t$:\n$$\n\\psi^{(n+1)}_{i,j} \\;=\\; \\psi^{(n)}_{i,j} \\;+\\; \\Delta t \\cdot \\left( \\frac{\\partial \\psi}{\\partial t} \\right)_{i,j}^{(n)}\n$$\nThe discrete form of the right-hand side, representing $-\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}$, is given as:\n$$\n-\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast} \\to (D_x^\\dagger D_x \\psi)_{i,j} + (D_y^\\dagger D_y \\psi)_{i,j} - \\left(1 - |\\psi_{i,j}|^2\\right)\\psi_{i,j}\n$$\nThe discrete gauge-covariant Laplacian components are specified as:\n1.  **x-direction:** To maintain gauge invariance under discretization, a link variable $U_{x,j} = e^{i B y_j \\Delta x}$ is introduced, where $y_j = j \\Delta y$. The Laplacian is:\n    $$\n    (D_x^\\dagger D_x \\psi)_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} + U_{x,j}^\\ast \\, \\psi_{i-1,j} - 2 \\psi_{i,j}\n    $$\n    Periodic boundary conditions are applied in the $x$-direction, so indices $i$ are evaluated modulo $N_x$.\n\n2.  **y-direction:** The vector potential has no component in the $y$-direction ($A_y=0$), so the link variables are unity. The Laplacian is:\n    $$\n    (D_y^\\dagger D_y \\psi)_{i,j} \\;=\\; \\psi_{i,j+1} + \\psi_{i,j-1} - 2 \\psi_{i,j}\n    $$\n    The de Gennes (superconductor-insulator) boundary conditions, $\\partial_y \\psi = 0$ at $y=0$ and $y=W$, are implemented by reflecting the grid: $\\psi_{i,-1} = \\psi_{i,0}$ at the bottom boundary ($j=0$) and $\\psi_{i,N_y} = \\psi_{i,N_y-1}$ at the top boundary ($j=N_y-1$). This simplifies the Laplacian at the boundaries:\n    - At $j=0$: $(D_y^\\dagger D_y \\psi)_{i,0} = \\psi_{i,1} + \\psi_{i,-1} - 2\\psi_{i,0} = \\psi_{i,1} + \\psi_{i,0} - 2\\psi_{i,0} = \\psi_{i,1} - \\psi_{i,0}$.\n    - At $j=N_y-1$: $(D_y^\\dagger D_y \\psi)_{i,N_y-1} = \\psi_{i,N_y} + \\psi_{i,N_y-2} - 2\\psi_{i,N_y-1} = \\psi_{i,N_y-1} + \\psi_{i,N_y-2} - 2\\psi_{i,N_y-1} = \\psi_{i,N_y-2} - \\psi_{i,N_y-1}$.\n\nThe simulation starts from an initial state $\\psi_{i,j}^{(0)} = 1 + \\epsilon \\, \\eta_{i,j}$, where $\\epsilon = 10^{-2}$ is a small perturbation amplitude and $\\eta_{i,j}$ is a complex random number from a Gaussian distribution with zero mean and unit variance. A fixed random seed is used for reproducibility. The system is evolved for $N_{\\mathrm{iter}} = 400$ steps with a time step of $\\Delta t=0.05$.\n\nAfter the simulation converges to a minimum energy state, the number of vortices, $N_v$, is calculated. A vortex is a topological defect where the phase of $\\psi$ changes by a multiple of $2\\pi$ around a closed loop. On the lattice, this is computed by summing the gauge-invariant circulation around each elementary plaquette.\n\nThe gauge-invariant phase differences across links are:\n$$\n\\delta\\theta_x(i,j) = \\mathrm{wrap}\\left( \\arg(\\psi_{i+1,j}) - \\arg(\\psi_{i,j}) - \\arg(U_{x,j}) \\right)\n$$\n$$\n\\delta\\theta_y(i,j) = \\mathrm{wrap}\\left( \\arg(\\psi_{i,j+1}) - \\arg(\\psi_{i,j}) \\right)\n$$\nThe function $\\mathrm{wrap}(\\cdot)$ maps an angle to the interval $(-\\pi, \\pi]$.\nThe plaquette vorticity for the cell with its bottom-left corner at $(i,j)$ is the sum of phase differences around it:\n$$\n\\omega(i,j) = \\mathrm{wrap}\\left( \\delta\\theta_x(i,j) + \\delta\\theta_y(i+1,j) - \\delta\\theta_x(i,j+1) - \\delta\\theta_y(i,j) \\right)\n$$\nThis is calculated for each plaquette, indexed by $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-2\\}$. The total vortex count is the sum of all plaquette vorticities, normalized by $2\\pi$ and rounded to the nearest integer:\n$$\nN_v = \\mathrm{round}\\left( \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-2} \\omega(i,j) \\right)\n$$\nThis procedure is repeated for each value of $B$ specified in the test suite. All calculations use the provided dimensionless parameters: $N_x = 24$, $N_y = 12$, $\\Delta x = \\Delta y = 1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Ginzburg-Landau equation using gradient descent\n    and computes the vortex count for several magnetic field strengths.\n    \"\"\"\n    \n    # Fixed grid and numerical parameters\n    Nx = 24\n    Ny = 12\n    dx = 1.0\n    dy = 1.0\n    dt = 0.05\n    N_iter = 400\n    epsilon = 1e-2\n    \n    # Define test cases for the magnetic field B\n    B_denom = Nx * (Ny - 1)\n    test_cases = [\n        0.0,\n        (2 * np.pi) / B_denom,\n        (4 * np.pi) / B_denom,\n        (6 * np.pi) / B_denom,\n        (3 * np.pi) / B_denom,\n    ]\n\n    results = []\n\n    # Use a fixed random seed for reproducibility\n    np.random.seed(0)\n\n    # Grid coordinates\n    y_coords = np.arange(Ny) * dy\n\n    # Angle wrapping function to map angles to (-pi, pi]\n    def wrap_angle(angles):\n        return (angles + np.pi) % (2 * np.pi) - np.pi\n\n    for B in test_cases:\n        # Initialize the order parameter psi\n        # psi is a complex grid of size (Nx, Ny)\n        noise_real = np.random.randn(Nx, Ny)\n        noise_imag = np.random.randn(Nx, Ny)\n        psi = 1.0 + epsilon * (noise_real + 1j * noise_imag)\n\n        # Pre-compute link variables U_x, which depend only on y\n        # U_x is broadcastable to the shape of psi\n        arg_U_x = (B * y_coords * dx).reshape(1, Ny)\n        U_x = np.exp(1j * arg_U_x)\n        U_x_conj = U_x.conj()\n\n        # Perform gradient descent (explicit Euler time evolution)\n        for _ in range(N_iter):\n            # Calculate the gauge-covariant Laplacian in the x-direction\n            # Periodic boundary conditions are handled by np.roll\n            psi_xp1 = np.roll(psi, -1, axis=0)\n            psi_xm1 = np.roll(psi, 1, axis=0)\n            lap_x = U_x * psi_xp1 + U_x_conj * psi_xm1 - 2.0 * psi\n\n            # Calculate the Laplacian in the y-direction\n            # Enforce de Gennes (Neumann) boundary conditions by reflection\n            # as specified in the problem and solution text\n            lap_y = np.zeros_like(psi)\n            psi_yp1 = np.roll(psi, -1, axis=1)\n            psi_ym1 = np.roll(psi, 1, axis=1)\n            \n            # Interior points\n            lap_y[:, 1:-1] = psi_yp1[:, 1:-1] + psi_ym1[:, 1:-1] - 2.0 * psi[:, 1:-1]\n            # Boundary at y=0 (j=0)\n            lap_y[:, 0] = psi[:, 1] + psi[:, 0] - 2.0 * psi[:, 0]\n            # Boundary at y=W (j=Ny-1)\n            lap_y[:, -1] = psi[:, -1] + psi[:, -2] - 2.0 * psi[:, -1]\n            \n            # Calculate the potential term\n            potential_term = (1.0 - np.abs(psi)**2) * psi\n\n            # Gradient of the free energy functional (RHS of the evolution eq.)\n            # The TDGL equation has a plus sign before the potential term.\n            d_psi_dt = (lap_x + lap_y) + potential_term\n\n            # Update psi using forward Euler step\n            psi += dt * d_psi_dt\n\n        # --- Vortex Counting ---\n        # Calculate gauge-invariant phase differences on links\n        arg_psi = np.angle(psi)\n\n        # Phase difference on horizontal links (size Nx, Ny)\n        d_theta_x = wrap_angle(np.roll(arg_psi, -1, axis=0) - arg_psi - arg_U_x)\n\n        # Phase difference on vertical links (size Nx, Ny-1)\n        # Only defined for links inside the domain\n        d_theta_y = wrap_angle(arg_psi[:, 1:] - arg_psi[:, :-1])\n\n        # Calculate plaquette vorticity (gauge-invariant circulation)\n        # A plaquette (i,j) is bounded by points (i,j), (i+1,j), (i+1,j+1), (i,j+1)\n        # The sum is over i=0..Nx-1 and j=0..Ny-2. Omega has shape (Nx, Ny-1)\n        omega = wrap_angle(\n            d_theta_x[:, :-1] + \n            np.roll(d_theta_y, -1, axis=0) - \n            d_theta_x[:, 1:] - \n            d_theta_y\n        )\n\n        # Sum over all plaquettes and normalize to get the net vortex count\n        total_vorticity = np.sum(omega)\n        Nv = int(np.round(total_vorticity / (2 * np.pi)))\n        results.append(Nv)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}