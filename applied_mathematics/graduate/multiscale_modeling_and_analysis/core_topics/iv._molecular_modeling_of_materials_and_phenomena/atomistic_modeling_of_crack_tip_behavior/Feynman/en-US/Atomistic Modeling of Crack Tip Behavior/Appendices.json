{
    "hands_on_practices": [
        {
            "introduction": "Continuum mechanics predicts an unphysical stress singularity at a crack tip, a theoretical artifact that real materials resolve through atomic-scale processes. This exercise provides a physical resolution by connecting the macroscopic concept of strength to the underlying atomic interactions. By deriving the theoretical brittle strength from a fundamental interatomic potential, you will establish the maximum stress that bonds can sustain, a crucial parameter governing cleavage fracture. ",
            "id": "3734045",
            "problem": "Consider a brittle single-crystal solid in which cleavage occurs by breaking interatomic bonds across a crystallographic plane. Assume the interatomic interaction is well represented by the Morse potential\n$$\nU(r) \\;=\\; D\\left[\\exp\\!\\left(-2\\alpha\\,(r - r_0)\\right) \\;-\\; 2\\,\\exp\\!\\left(-\\alpha\\,(r - r_0)\\right)\\right],\n$$\nwhere $r$ is the instantaneous bond length, $r_0$ is the equilibrium bond length, $D$ is the dissociation energy of a single bond, and $\\alpha$ is a positive range parameter. The theoretical brittle strength is defined here as the maximum cleavage traction sustained by these bonds before unstable separation.\n\nUse the following fundamental bases:\n- The force on a bond follows from Newton’s second law and energy conservation as $F(r) = -\\,\\mathrm{d}U/\\mathrm{d}r$.\n- The curvature of the potential at equilibrium is $k \\equiv \\mathrm{d}^2U/\\mathrm{d}r^2\\big|_{r=r_0}$, which governs the small-strain stiffness of a bond.\n- The macroscopic normal stress across the plane is $\\sigma = n_b\\,F(r)$, where $n_b$ is the number of load-bearing bonds per unit area across the cleavage plane.\n- For small strains, Hooke’s law gives the Young’s modulus $E$ via $\\sigma = E\\,\\varepsilon$, with $\\varepsilon \\approx (r - r_0)/r_0$.\n- The work of complete separation per unit area equals twice the surface energy, $2\\gamma$, which is the area under the traction–separation curve and equals the sum of the energies required to break all bonds per unit area.\n\nStarting from these bases, derive an expression for the theoretical brittle strength $\\sigma_{\\mathrm{th}}$ in terms of the macroscopic parameters $E$, $\\gamma$, and the equilibrium bond length $r_0$. Then, using $E = 200\\,\\mathrm{GPa}$, $\\gamma = 1.5\\,\\mathrm{J/m^2}$, and $r_0 = 0.25\\,\\mathrm{nm}$, compute the numerical value of $\\sigma_{\\mathrm{th}}$. Round your final numerical answer to three significant figures and express it in $\\mathrm{GPa}$.\n\nFinally, briefly assess the relevance of this theoretical brittle strength near an atomistic crack tip, commenting on its role in limiting the near-tip stress field and its implications for bond breaking at the scale of a few lattice spacings. Your assessment should be qualitative and based on the derivation, but it must not alter the requested numerical answer.",
            "solution": "The problem asks for the derivation of an expression for the theoretical brittle strength, $\\sigma_{\\mathrm{th}}$, in terms of macroscopic material properties, and its subsequent numerical calculation. The derivation begins with the provided Morse potential for interatomic interaction.\n\nThe Morse potential is given by:\n$$\nU(r) = D\\left[\\exp\\left(-2\\alpha(r - r_0)\\right) - 2\\exp\\left(-\\alpha(r - r_0)\\right)\\right]\n$$\nwhere $r$ is the interatomic distance, $r_0$ is the equilibrium distance, $D$ is the bond dissociation energy, and $\\alpha$ is a parameter related to the potential's width.\n\nFirst, we derive the interatomic force $F(r)$ by taking the negative gradient of the potential energy $U(r)$:\n$$\nF(r) = -\\frac{\\mathrm{d}U}{\\mathrm{d}r} = -D\\left[-2\\alpha\\exp\\left(-2\\alpha(r - r_0)\\right) - 2(-\\alpha)\\exp\\left(-\\alpha(r - r_0)\\right)\\right]\n$$\n$$\nF(r) = 2\\alpha D \\left[\\exp\\left(-2\\alpha(r - r_0)\\right) - \\exp\\left(-\\alpha(r - r_0)\\right)\\right]\n$$\nFor $r > r_0$ (stretching), this force is attractive (negative). The cleavage traction, $\\sigma$, is the magnitude of this restorative force per unit area. Let $u = r - r_0$ be the bond separation distance. The tensile traction is given by $\\sigma(u) = -n_b F(r_0 + u)$, where $n_b$ is the number of bonds per unit area.\n$$\n\\sigma(u) = -2\\alpha D n_b \\left[\\exp(-2\\alpha u) - \\exp(-\\alpha u)\\right] = 2\\alpha D n_b \\left[\\exp(-\\alpha u) - \\exp(-2\\alpha u)\\right]\n$$\nThe theoretical brittle strength, $\\sigma_{\\mathrm{th}}$, is the maximum value of this traction. To find it, we set the derivative of $\\sigma(u)$ with respect to $u$ to zero:\n$$\n\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}u} = 2\\alpha D n_b \\left[-\\alpha\\exp(-\\alpha u) - (-2\\alpha)\\exp(-2\\alpha u)\\right] = 0\n$$\n$$\n-\\alpha\\exp(-\\alpha u) + 2\\alpha\\exp(-2\\alpha u) = 0\n$$\nSince $\\alpha \\neq 0$, we can divide by it. Let $x = \\exp(-\\alpha u)$. The equation becomes $-x + 2x^2 = 0$, or $x(2x - 1) = 0$. Since $x = \\exp(-\\alpha u)$ cannot be zero for any finite $u$, the solution is $x = 1/2$.\n$$\n\\exp(-\\alpha u_{\\mathrm{max}}) = \\frac{1}{2}\n$$\nThis gives the separation $u_{\\mathrm{max}}$ at which the traction is maximum. Substituting this back into the expression for $\\sigma(u)$:\n$$\n\\sigma_{\\mathrm{th}} = \\sigma(u_{\\mathrm{max}}) = 2\\alpha D n_b \\left[\\left(\\frac{1}{2}\\right) - \\left(\\frac{1}{2}\\right)^2\\right] = 2\\alpha D n_b \\left(\\frac{1}{2} - \\frac{1}{4}\\right) = 2\\alpha D n_b \\left(\\frac{1}{4}\\right)\n$$\n$$\n\\sigma_{\\mathrm{th}} = \\frac{\\alpha D n_b}{2}\n$$\nThis expression contains the microscopic parameters $\\alpha$, $D$, and $n_b$. We must express them in terms of the macroscopic parameters $E$, $\\gamma$, and $r_0$.\n\nFrom the problem statement, the work of complete separation per unit area, $2\\gamma$, is the sum of energies to break all bonds per unit area. This is given by $2\\gamma = n_b D$. Substituting this into the expression for $\\sigma_{\\mathrm{th}}$:\n$$\n\\sigma_{\\mathrm{th}} = \\frac{\\alpha(n_b D)}{2} = \\frac{\\alpha(2\\gamma)}{2} = \\alpha\\gamma\n$$\nNow we need to find an expression for $\\alpha$. This can be done by relating the macroscopic Young's modulus $E$ to the curvature of the interatomic potential at equilibrium.\nFor small strains $\\varepsilon = u/r_0 = (r-r_0)/r_0$, Hooke's law gives $\\sigma = E\\varepsilon = E(r-r_0)/r_0$.\nAtomistically, for small separations $u$, the force can be linearized: $F(r) \\approx F(r_0) + \\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0}(r-r_0)$.\nSince $F(r_0)=0$, we have $F(r) \\approx \\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0}(r-r_0)$.\nThe term $\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0}$ relates to the bond stiffness $k = \\frac{\\mathrm{d}^2U}{\\mathrm{d}r^2}\\big|_{r=r_0} = -\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0}$.\nLet's calculate $k$:\n$$\n\\frac{\\mathrm{d}F}{\\mathrm{d}r} = 2\\alpha D \\left[-2\\alpha\\exp(-2\\alpha(r-r_0)) + \\alpha\\exp(-\\alpha(r-r_0))\\right]\n$$\nAt $r=r_0$:\n$$\n\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\bigg|_{r=r_0} = 2\\alpha D \\left[-2\\alpha + \\alpha\\right] = -2\\alpha^2 D\n$$\nSo, the bond stiffness is $k = -\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0} = 2\\alpha^2 D$.\nThe tensile traction for small separations is $\\sigma(u) = -n_b F(r_0+u) \\approx -n_b \\left(\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0} u\\right) = n_b k u = n_b(2\\alpha^2 D)u$.\nReplacing $u$ with $(r-r_0)$:\n$$\n\\sigma = n_b(2\\alpha^2 D)(r-r_0)\n$$\nEquating the continuum and atomistic expressions for $\\sigma$ in the small-strain limit:\n$$\nE\\frac{(r-r_0)}{r_0} = n_b(2\\alpha^2 D)(r-r_0)\n$$\n$$\n\\frac{E}{r_0} = 2\\alpha^2 n_b D\n$$\nUsing the relation $n_b D = 2\\gamma$:\n$$\n\\frac{E}{r_0} = 2\\alpha^2 (2\\gamma) = 4\\alpha^2\\gamma\n$$\nSolving for $\\alpha$:\n$$\n\\alpha^2 = \\frac{E}{4\\gamma r_0} \\quad \\implies \\quad \\alpha = \\sqrt{\\frac{E}{4\\gamma r_0}} = \\frac{1}{2}\\sqrt{\\frac{E}{\\gamma r_0}}\n$$\nFinally, substitute this expression for $\\alpha$ back into the equation for theoretical strength, $\\sigma_{\\mathrm{th}} = \\alpha\\gamma$:\n$$\n\\sigma_{\\mathrm{th}} = \\left(\\frac{1}{2}\\sqrt{\\frac{E}{\\gamma r_0}}\\right)\\gamma = \\frac{1}{2}\\sqrt{\\frac{E\\gamma^2}{\\gamma r_0}}\n$$\n$$\n\\sigma_{\\mathrm{th}} = \\frac{1}{2}\\sqrt{\\frac{E\\gamma}{r_0}}\n$$\nThis is the desired expression for the theoretical brittle strength.\n\nNow, we compute the numerical value using the provided data: $E = 200\\,\\mathrm{GPa}$, $\\gamma = 1.5\\,\\mathrm{J/m^2}$, and $r_0 = 0.25\\,\\mathrm{nm}$. We must use SI units for consistency.\n$E = 200 \\times 10^9\\,\\mathrm{Pa}$\n$\\gamma = 1.5\\,\\mathrm{J/m^2}$\n$r_0 = 0.25 \\times 10^{-9}\\,\\mathrm{m}$\n\n$$\n\\sigma_{\\mathrm{th}} = \\frac{1}{2}\\sqrt{\\frac{(200 \\times 10^9\\,\\mathrm{Pa}) \\times (1.5\\,\\mathrm{J/m^2})}{0.25 \\times 10^{-9}\\,\\mathrm{m}}}\n$$\nThe argument of the square root is:\n$$\n\\frac{300 \\times 10^9}{0.25 \\times 10^{-9}} \\,\\frac{\\mathrm{Pa} \\cdot \\mathrm{J/m^2}}{\\mathrm{m}} = \\frac{300}{0.25} \\times 10^{18} \\,\\frac{\\mathrm{N/m^2} \\cdot \\mathrm{N\\cdot m/m^2}}{\\mathrm{m}} = 1200 \\times 10^{18} \\,\\frac{\\mathrm{N^2}}{\\mathrm{m^4}} = 1.2 \\times 10^{21}\\,\\mathrm{Pa^2}\n$$\nTaking the square root:\n$$\n\\sqrt{1.2 \\times 10^{21}\\,\\mathrm{Pa^2}} = \\sqrt{12 \\times 10^{20}\\,\\mathrm{Pa^2}} = \\sqrt{12} \\times 10^{10}\\,\\mathrm{Pa} \\approx 3.4641 \\times 10^{10}\\,\\mathrm{Pa}\n$$\nFinally, multiplying by $1/2$:\n$$\n\\sigma_{\\mathrm{th}} = \\frac{1}{2} \\times (3.4641 \\times 10^{10}\\,\\mathrm{Pa}) \\approx 1.73205 \\times 10^{10}\\,\\mathrm{Pa}\n$$\nExpressing the result in Gigapascals (GPa), where $1\\,\\mathrm{GPa} = 10^9\\,\\mathrm{Pa}$:\n$$\n\\sigma_{\\mathrm{th}} \\approx \\frac{1.73205 \\times 10^{10}}{10^9} \\,\\mathrm{GPa} \\approx 17.3205\\,\\mathrm{GPa}\n$$\nRounding to three significant figures, we get $17.3\\,\\mathrm{GPa}$.\n\nThe theoretical brittle strength represents a physical limit on the stress that atomic bonds can sustain. In the context of continuum mechanics, models like Linear Elastic Fracture Mechanics (LEFM) predict an unphysical stress singularity at a sharp crack tip. The concept of a theoretical strength, $\\sigma_{\\mathrm{th}}$, resolves this by providing a natural cutoff. The stress at the very tip of a crack in a real material cannot exceed this value. When the local stress approaches $\\sigma_{\\mathrm{th}}$, the continuum description breaks down, and the material enters a \"fracture process zone\" where discrete atomic-level processes, namely bond stretching and breaking, become dominant. The value $\\sigma_{\\mathrm{th}}$ corresponds to the onset of bond-breaking instability; once this stress is reached, the force required to further separate the atoms decreases, leading to catastrophic failure of the bond and subsequent crack propagation. This entire process is confined to a very small region near the crack tip, typically on the order of a few lattice spacings. Thus, $\\sigma_{\\mathrm{th}}$ is a crucial parameter linking atomistic behavior to macroscopic fracture criteria.",
            "answer": "$$\\boxed{17.3}$$"
        },
        {
            "introduction": "Accurately modeling a small atomistic region requires properly coupling it to the surrounding elastic continuum, a common challenge in multiscale simulation. This practice demonstrates a core technique: applying boundary conditions derived from Linear Elastic Fracture Mechanics (LEFM) to an atomistic system. By constructing these displacement fields and verifying the characteristic near-tip scaling, you will learn a foundational method for realistically loading a crack in a computational model. ",
            "id": "3734046",
            "problem": "You are asked to implement a program that constructs atomistic boundary displacement fields consistent with the continuum Mode I (opening mode) crack solution under plane strain for a given crystal treated as an isotropic elastic solid, and then verifies the near-tip displacement scaling $u \\sim \\sqrt{r}$. The solution must be derived from fundamental principles and then encoded and executed to produce specified outputs for a defined test suite. The program must be self-contained and produce a single line of output in the required format.\n\nThe physical foundation must begin from the following base:\n- Linear elasticity with Hooke’s law relating stress and strain, and the kinematic relation connecting displacement gradients to strain, with small-deformation assumptions.\n- Equilibrium of stresses in the absence of body forces near the crack tip.\n- The near-tip asymptotics of Linear Elastic Fracture Mechanics (LEFM), which state that for a sharp crack in an isotropic elastic medium, the stress intensity factor $K_I$ characterizes the amplitude of the singular near-tip fields and that the displacement field has a square-root dependence on radius $r$ from the crack tip.\n- Plane strain conditions, with effective modulus $E' = E/(1-\\nu^2)$, where $E$ is Young’s modulus and $\\nu$ is Poisson’s ratio, and the Kolosov constant $\\kappa = 3 - 4\\nu$ in plane strain.\n\nYour task is to:\n1. Derive the continuum near-tip displacement field $u_x(r,\\theta)$ and $u_y(r,\\theta)$ for Mode I under plane strain using the above foundations, expressed in polar coordinates $(r,\\theta)$ around the crack tip and converted to Cartesian displacements. From the derivation, show that the displacement magnitude $u(r,\\theta)$ exhibits the scaling $u \\propto \\sqrt{r}$ modulated by an angular function that depends on $\\theta$ and material parameters $E$, $\\nu$, $K_I$.\n2. Construct atomistic boundary nodes as a set of discrete points lying on a family of concentric circular rings (representing boundary atoms around the crack tip) at radii $r_k$ and angles $\\theta_j$. For each such node, apply the derived continuum displacement field to define its boundary displacement. Treat the underlying crystal as an isotropic elastic medium in this construction. Use angles in radians, and compute displacements in meters.\n3. Verify the near-tip displacement scaling by calculating, for each radius $r_k$, the average displacement magnitude $\\overline{u}(r_k)$ over the set of angles $\\theta_j$ (excluding angles arbitrarily close to the crack surfaces at $\\theta = \\pm \\pi$ where branch cuts occur). Perform a log-log regression of $\\overline{u}(r_k)$ versus $r_k$ to estimate the slope $s$. Confirm that $s$ is close to $0.5$.\n\nImplementation instructions:\n- Use the following plan for constructing the atomistic boundary nodes:\n  - For each test case, select radii $\\{r_k\\}$ that are geometrically spaced between a minimum radius $r_{\\min}$ and a maximum radius $r_{\\max}$, where $r_{\\min}$ and $r_{\\max}$ are proportional to a lattice constant $a$.\n  - Select angles $\\{\\theta_j\\}$ uniformly in $[-\\pi, \\pi]$ excluding a small tolerance window of width $\\Delta \\theta$ around $\\theta = \\pm \\pi$ to avoid the crack surfaces, since $u(r,\\theta)$ must be single-valued away from the branch cut.\n  - Assign atomistic boundary displacements to each $(r_k,\\theta_j)$ using your derived continuum field under plane strain.\n\n- Units:\n  - Young’s modulus $E$ must be in Pascals ($\\text{Pa}$).\n  - Poisson’s ratio $\\nu$ is dimensionless.\n  - The Mode I stress intensity factor $K_I$ must be in $\\text{Pa}\\sqrt{\\text{m}}$.\n  - The lattice constant $a$, radii $r_k$, and displacements $u$ must be in meters ($\\text{m}$).\n  - Angles $\\theta$ must be in radians.\n\n- Slope verification:\n  - For each test case, compute the least-squares slope $s$ of $\\log \\overline{u}(r_k)$ versus $\\log r_k$. Also compute a boolean flag $b$ that is true if $|s - 0.5| \\leq \\tau$, where $\\tau$ is a specified tolerance.\n  - Output for all test cases must be aggregated into a single line as a comma-separated list enclosed in square brackets, containing for each test case the slope followed by the boolean (e.g., $[s_1,b_1,s_2,b_2,s_3,b_3]$). The slope is dimensionless and the boolean is either true or false.\n\nTest suite:\nImplement the program for the following three test cases. Use the specified parameters and selections:\n\n- Test case 1 (happy path, typical metallic crystal):\n  - $E = 210\\times 10^9\\ \\text{Pa}$,\n  - $\\nu = 0.30$,\n  - $K_I = 30\\times 10^6\\ \\text{Pa}\\sqrt{\\text{m}}$,\n  - lattice constant $a = 2.5\\times 10^{-10}\\ \\text{m}$,\n  - number of radii $n_r = 12$ logarithmically spaced between $r_{\\min} = 2a$ and $r_{\\max} = 256a$,\n  - number of angles $n_\\theta = 181$ uniformly spaced in $[-\\pi+\\Delta \\theta,\\pi-\\Delta \\theta]$ with $\\Delta \\theta = 0.05$ radians,\n  - tolerance $\\tau = 10^{-10}$ on the slope.\n\n- Test case 2 (near-incompressible isotropic crystal, boundary condition):\n  - $E = 70\\times 10^9\\ \\text{Pa}$,\n  - $\\nu = 0.49$,\n  - $K_I = 10\\times 10^6\\ \\text{Pa}\\sqrt{\\text{m}}$,\n  - lattice constant $a = 2.0\\times 10^{-10}\\ \\text{m}$,\n  - number of radii $n_r = 14$ logarithmically spaced between $r_{\\min} = 3a$ and $r_{\\max} = 512a$,\n  - number of angles $n_\\theta = 241$ uniformly spaced in $[-\\pi+\\Delta \\theta,\\pi-\\Delta \\theta]$ with $\\Delta \\theta = 0.05$ radians,\n  - tolerance $\\tau = 10^{-10}$ on the slope.\n\n- Test case 3 (low Poisson ratio isotropic crystal, edge case):\n  - $E = 130\\times 10^9\\ \\text{Pa}$,\n  - $\\nu = 0.10$,\n  - $K_I = 50\\times 10^6\\ \\text{Pa}\\sqrt{\\text{m}}$,\n  - lattice constant $a = 2.2\\times 10^{-10}\\ \\text{m}$,\n  - number of radii $n_r = 16$ logarithmically spaced between $r_{\\min} = 2a$ and $r_{\\max} = 1024a$,\n  - number of angles $n_\\theta = 121$ uniformly spaced in $[-\\pi+\\Delta \\theta,\\pi-\\Delta \\theta]$ with $\\Delta \\theta = 0.05$ radians,\n  - tolerance $\\tau = 10^{-10}$ on the slope.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[s_1,b_1,s_2,b_2,s_3,b_3]$). Each $s_i$ is a float and each $b_i$ is a boolean. No other output should be printed.",
            "solution": "The problem is deemed valid as it is scientifically grounded in linear elastic fracture mechanics, well-posed with all necessary parameters provided, and objectively formulated. The task is to derive and implement the continuum near-tip displacement field for a Mode I crack under plane strain, apply it to a discrete set of boundary points, and verify the theoretical displacement scaling.\n\n### Part 1: Derivation of the Near-Tip Displacement Field\n\nThe starting point is the standard solution for the near-tip displacement field around a sharp crack in an isotropic, linearly elastic material under Mode I loading conditions. The crack is assumed to lie on the negative $x$-axis, with its tip at the origin of a polar coordinate system $(r, \\theta)$. For plane strain conditions, the displacement components $u_x$ and $u_y$ in Cartesian coordinates are derived from the stress and strain fields.\n\nThe governing relations are:\n1.  **Hooke's Law for Plane Strain**: The strain components ($\\epsilon_{xx}$, $\\epsilon_{yy}$, $\\epsilon_{xy}$) are related to stress components ($\\sigma_{xx}$, $\\sigma_{yy}$, $\\sigma_{xy}$) as:\n    $$ \\epsilon_{xx} = \\frac{1}{E'} (\\sigma_{xx} - \\nu' \\sigma_{yy}) $$\n    $$ \\epsilon_{yy} = \\frac{1}{E'} (\\sigma_{yy} - \\nu' \\sigma_{xx}) $$\n    $$ \\epsilon_{xy} = \\frac{1}{2G} \\sigma_{xy} = \\frac{1+\\nu}{E} \\sigma_{xy} $$\n    For plane strain, the effective modulus is $E' = E/(1-\\nu^2)$ and the effective Poisson's ratio is $\\nu' = \\nu/(1-\\nu)$. However, it is more direct to use the shear modulus $G = E/(2(1+\\nu))$ and the Kolosov constant $\\kappa = 3-4\\nu$.\n\n2.  **Strain-Displacement Relations**: For small deformations, strains are gradients of the displacement vector $\\mathbf{u} = (u_x, u_y)$:\n    $$ \\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x}, \\quad \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y}, \\quad \\epsilon_{xy} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) $$\n\nThe near-tip stress field, characterized by the Mode I stress intensity factor $K_I$, is given by the Williams-Westergaard solution:\n$$ \\sigma_{xx} = \\frac{K_I}{\\sqrt{2\\pi r}} \\cos\\frac{\\theta}{2} \\left(1 - \\sin\\frac{\\theta}{2}\\sin\\frac{3\\theta}{2}\\right) $$\n$$ \\sigma_{yy} = \\frac{K_I}{\\sqrt{2\\pi r}} \\cos\\frac{\\theta}{2} \\left(1 + \\sin\\frac{\\theta}{2}\\sin\\frac{3\\theta}{2}\\right) $$\n$$ \\sigma_{xy} = \\frac{K_I}{\\sqrt{2\\pi r}} \\sin\\frac{\\theta}{2}\\cos\\frac{\\theta}{2}\\cos\\frac{3\\theta}{2} $$\n\nBy substituting these stress expressions into Hooke's law and integrating the strain-displacement relations, one obtains the displacement field. Standard derivations in fracture mechanics literature yield the displacement components in Cartesian coordinates as functions of polar coordinates $(r, \\theta)$. For plane strain, a common and convenient form is:\n$$ u_x(r, \\theta) = \\frac{K_I}{G} \\sqrt{\\frac{r}{2\\pi}} \\cos\\frac{\\theta}{2} \\left( \\frac{\\kappa - 1}{2} + \\sin^2\\frac{\\theta}{2} \\right) $$\n$$ u_y(r, \\theta) = \\frac{K_I}{G} \\sqrt{\\frac{r}{2\\pi}} \\sin\\frac{\\theta}{2} \\left( \\frac{\\kappa + 1}{2} - \\cos^2\\frac{\\theta}{2} \\right) $$\nwhere $G = E/(2(1+\\nu))$ is the shear modulus and $\\kappa = 3-4\\nu$ is the Kolosov constant for plane strain, as specified.\n\nTo implement these formulas using the provided material constants $E$ and $\\nu$, we substitute the expressions for $G$ and $\\kappa$:\n$$ \\frac{1}{G} = \\frac{2(1+\\nu)}{E} $$\n$$ \\frac{\\kappa-1}{2} = \\frac{(3-4\\nu)-1}{2} = 1-2\\nu $$\n$$ \\frac{\\kappa+1}{2} = \\frac{(3-4\\nu)+1}{2} = 2-2\\nu $$\n\nSubstituting these back into the displacement equations gives the final form used for computation:\n$$ u_x(r, \\theta) = \\frac{2K_I(1+\\nu)}{E} \\sqrt{\\frac{r}{2\\pi}} \\cos\\frac{\\theta}{2} \\left( 1 - 2\\nu + \\sin^2\\frac{\\theta}{2} \\right) $$\n$$ u_y(r, \\theta) = \\frac{2K_I(1+\\nu)}{E} \\sqrt{\\frac{r}{2\\pi}} \\sin\\frac{\\theta}{2} \\left( 2 - 2\\nu - \\cos^2\\frac{\\theta}{2} \\right) $$\n\nThese equations explicitly show that both $u_x$ and $u_y$ are proportional to $\\sqrt{r}$. Consequently, the magnitude of the displacement vector, $u(r, \\theta) = \\sqrt{u_x(r, \\theta)^2 + u_y(r, \\theta)^2}$, must also be proportional to $\\sqrt{r}$:\n$$ u(r, \\theta) = \\sqrt{r} \\cdot F(K_I, E, \\nu, \\theta) $$\nwhere $F$ encapsulates all other terms. This confirms the theoretical scaling $u \\propto \\sqrt{r}$.\n\n### Part 2: Algorithmic Construction and Verification\n\nThe numerical procedure to verify this scaling relationship involves several steps:\n1.  **Node Generation**: For each test case, a set of discrete points (nodes) is generated.\n    - The radii $\\{r_k\\}_{k=1}^{n_r}$ are logarithmically (geometrically) spaced between a specified $r_{\\min}$ and $r_{\\max}$, which are defined relative to the lattice constant $a$.\n    - The angles $\\{\\theta_j\\}_{j=1}^{n_\\theta}$ are uniformly spaced in the interval $[-\\pi + \\Delta\\theta, \\pi - \\Delta\\theta]$ to avoid the mathematical singularity and multi-valuedness on the crack surface (branch cut at $\\theta=\\pm\\pi$).\n\n2.  **Displacement Calculation**: For each node at $(r_k, \\theta_j)$, the Cartesian displacement components $(u_x, u_y)$ are computed using the derived formulas. The magnitude of the displacement, $u_{kj} = \\sqrt{u_x(r_k, \\theta_j)^2 + u_y(r_k, \\theta_j)^2}$, is then calculated.\n\n3.  **Averaging**: For each radius $r_k$, the displacement magnitudes are averaged over all angles $\\theta_j$ to obtain a single representative displacement magnitude $\\overline{u}(r_k)$:\n    $$ \\overline{u}(r_k) = \\frac{1}{n_{\\theta}} \\sum_{j=1}^{n_{\\theta}} u_{kj} $$\n    This averaging smooths out the angular dependence, resulting in a cleaner power-law relationship between $\\overline{u}$ and $r$.\n\n4.  **Scaling Verification via Regression**: The relationship $\\overline{u}(r) \\approx C \\cdot r^{0.5}$ implies a linear relationship in a log-log plot: $\\log(\\overline{u}(r)) \\approx 0.5 \\log(r) + \\log(C)$. To verify this, we perform a linear least-squares regression on the set of points $\\{(\\log r_k, \\log \\overline{u}(r_k))\\}_{k=1}^{n_r}$.\n    - The slope $s$ of the regression line is calculated using the formula:\n      $$ s = \\frac{n_r \\sum(\\log r_k \\log \\overline{u}_k) - (\\sum \\log r_k)(\\sum \\log \\overline{u}_k)}{n_r \\sum(\\log r_k)^2 - (\\sum \\log r_k)^2} $$\n    - The theoretical expectation is $s=0.5$. The computed slope is compared against this value. A boolean flag $b$ is set to true if the absolute difference $|s - 0.5|$ is within a given tolerance $\\tau$. This validates both the underlying theory and its numerical implementation.\n\nThis procedure is systematically applied to each test case provided in the problem statement.\n```python\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the crack tip displacement problem for a suite of test cases.\n\n    This function iterates through predefined test cases, each specifying material\n    properties (E, nu), fracture toughness (K_I), and geometric parameters for\n    constructing a set of atomistic boundary nodes. For each case, it:\n    1. Derives the continuum displacement field for a Mode I crack under plane strain.\n    2. Applies these displacements to nodes arranged on concentric circles.\n    3. Calculates the average displacement magnitude at each radius.\n    4. Performs a log-log linear regression of average displacement vs. radius\n       to find the slope, verifying the theoretical u ~ sqrt(r) scaling.\n    5. Compares the resulting slope to the theoretical value of 0.5.\n    \n    The results (slope and a boolean verification flag) for all test cases\n    are aggregated and printed in a single formatted line.\n    \"\"\"\n    test_cases = [\n        {\n            \"E\": 210e9, \"nu\": 0.30, \"K_I\": 30e6, \"a\": 2.5e-10,\n            \"n_r\": 12, \"r_min_factor\": 2, \"r_max_factor\": 256,\n            \"n_theta\": 181, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n        {\n            \"E\": 70e9, \"nu\": 0.49, \"K_I\": 10e6, \"a\": 2.0e-10,\n            \"n_r\": 14, \"r_min_factor\": 3, \"r_max_factor\": 512,\n            \"n_theta\": 241, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n        {\n            \"E\": 130e9, \"nu\": 0.10, \"K_I\": 50e6, \"a\": 2.2e-10,\n            \"n_r\": 16, \"r_min_factor\": 2, \"r_max_factor\": 1024,\n            \"n_theta\": 121, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n        K_I = case[\"K_I\"]\n        a = case[\"a\"]\n        n_r = case[\"n_r\"]\n        r_min = case[\"r_min_factor\"] * a\n        r_max = case[\"r_max_factor\"] * a\n        n_theta = case[\"n_theta\"]\n        delta_theta = case[\"delta_theta\"]\n        tau = case[\"tau\"]\n\n        # 1. Generate node coordinates\n        r_vals = np.logspace(np.log10(r_min), np.log10(r_max), num=n_r)\n        theta_vals = np.linspace(-np.pi + delta_theta, np.pi - delta_theta, num=n_theta)\n\n        # 2. Calculate displacements and average magnitudes\n        avg_u_vals = []\n        for r in r_vals:\n            # Vectorized calculation over all theta values for a given r\n            cos_theta_half = np.cos(theta_vals / 2.0)\n            sin_theta_half = np.sin(theta_vals / 2.0)\n\n            # Prefactor in displacement equations\n            prefactor = (2.0 * K_I * (1.0 + nu) / E) * np.sqrt(r / (2.0 * np.pi))\n            \n            # Displacement component u_x\n            term_x = 1.0 - 2.0 * nu + sin_theta_half**2\n            u_x = prefactor * cos_theta_half * term_x\n            \n            # Displacement component u_y\n            term_y = 2.0 - 2.0 * nu - cos_theta_half**2\n            u_y = prefactor * sin_theta_half * term_y\n\n            # Magnitude of displacement vector\n            u_mag = np.sqrt(u_x**2 + u_y**2)\n            \n            # Average magnitude over all angles\n            avg_u = np.mean(u_mag)\n            avg_u_vals.append(avg_u)\n\n        # 3. Perform log-log regression\n        log_r = np.log(r_vals)\n        log_u = np.log(np.array(avg_u_vals))\n        \n        # Using scipy.stats.linregress for robustness and clarity\n        regression_result = stats.linregress(log_r, log_u)\n        slope = regression_result.slope\n\n        # 4. Verify slope against theoretical value 0.5\n        is_valid_scaling = abs(slope - 0.5) = tau\n        \n        results.append(f\"{slope:.12f}\")\n        results.append(str(is_valid_scaling).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```",
            "answer": "```python\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the crack tip displacement problem for a suite of test cases.\n\n    This function iterates through predefined test cases, each specifying material\n    properties (E, nu), fracture toughness (K_I), and geometric parameters for\n    constructing a set of atomistic boundary nodes. For each case, it:\n    1. Derives the continuum displacement field for a Mode I crack under plane strain.\n    2. Applies these displacements to nodes arranged on concentric circles.\n    3. Calculates the average displacement magnitude at each radius.\n    4. Performs a log-log linear regression of average displacement vs. radius\n       to find the slope, verifying the theoretical u ~ sqrt(r) scaling.\n    5. Compares the resulting slope to the theoretical value of 0.5.\n    \n    The results (slope and a boolean verification flag) for all test cases\n    are aggregated and printed in a single formatted line.\n    \"\"\"\n    test_cases = [\n        {\n            \"E\": 210e9, \"nu\": 0.30, \"K_I\": 30e6, \"a\": 2.5e-10,\n            \"n_r\": 12, \"r_min_factor\": 2, \"r_max_factor\": 256,\n            \"n_theta\": 181, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n        {\n            \"E\": 70e9, \"nu\": 0.49, \"K_I\": 10e6, \"a\": 2.0e-10,\n            \"n_r\": 14, \"r_min_factor\": 3, \"r_max_factor\": 512,\n            \"n_theta\": 241, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n        {\n            \"E\": 130e9, \"nu\": 0.10, \"K_I\": 50e6, \"a\": 2.2e-10,\n            \"n_r\": 16, \"r_min_factor\": 2, \"r_max_factor\": 1024,\n            \"n_theta\": 121, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n        K_I = case[\"K_I\"]\n        a = case[\"a\"]\n        n_r = case[\"n_r\"]\n        r_min = case[\"r_min_factor\"] * a\n        r_max = case[\"r_max_factor\"] * a\n        n_theta = case[\"n_theta\"]\n        delta_theta = case[\"delta_theta\"]\n        tau = case[\"tau\"]\n\n        # 1. Generate node coordinates\n        r_vals = np.logspace(np.log10(r_min), np.log10(r_max), num=n_r)\n        theta_vals = np.linspace(-np.pi + delta_theta, np.pi - delta_theta, num=n_theta)\n\n        # 2. Calculate displacements and average magnitudes\n        avg_u_vals = []\n        for r in r_vals:\n            # Vectorized calculation over all theta values for a given r\n            cos_theta_half = np.cos(theta_vals / 2.0)\n            sin_theta_half = np.sin(theta_vals / 2.0)\n\n            # Prefactor in displacement equations\n            prefactor = (2.0 * K_I * (1.0 + nu) / E) * np.sqrt(r / (2.0 * np.pi))\n            \n            # Displacement component u_x\n            term_x = 1.0 - 2.0 * nu + sin_theta_half**2\n            u_x = prefactor * cos_theta_half * term_x\n            \n            # Displacement component u_y\n            term_y = 2.0 - 2.0 * nu - cos_theta_half**2\n            u_y = prefactor * sin_theta_half * term_y\n\n            # Magnitude of displacement vector\n            u_mag = np.sqrt(u_x**2 + u_y**2)\n            \n            # Average magnitude over all angles\n            avg_u = np.mean(u_mag)\n            avg_u_vals.append(avg_u)\n\n        # 3. Perform log-log regression\n        log_r = np.log(r_vals)\n        log_u = np.log(np.array(avg_u_vals))\n        \n        # Using scipy.stats.linregress for robustness and clarity\n        regression_result = stats.linregress(log_r, log_u)\n        slope = regression_result.slope\n\n        # 4. Verify slope against theoretical value 0.5\n        is_valid_scaling = abs(slope - 0.5) = tau\n        \n        results.append(f\"{slope:.12f}\")\n        results.append(str(is_valid_scaling).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A material's response to the intense stress at a crack tip is a competition between brittle cleavage (bond breaking) and ductile deformation (plastic flow). This exercise explores the fundamental mechanism of ductility: dislocation emission. You will apply the Schmid law to a given near-tip stress state to predict which crystallographic slip system will activate, providing insight into the critical process that determines a material's toughness. ",
            "id": "3734017",
            "problem": "Design and implement a complete, runnable program that models dislocation emission at an atomistic scale in a simplified two-dimensional crystalline lattice near a crack tip. The goal is to determine, for a given near-tip stress state, whether a dislocation is emitted and, if so, to compute the measurable quantities needed to validate theory: the Burgers vector, the slip plane, and the emission angle. The program must adhere to a principle-based derivation rooted in fundamental physical laws and well-tested formulas, and it must produce a single-line output aggregating results for a provided test suite.\n\nThe modeling context is as follows. A brittle crack lies along the $x$-axis, with its tip at the origin. The material is represented by a two-dimensional triangular lattice, which approximates the atomic arrangement in a close-packed plane. The lattice admits three primary slip directions corresponding to nearest-neighbor vectors:\n- $ \\mathbf{s}_0 = [1, 0] $ (direction at $0^\\circ$ to the crack line),\n- $ \\mathbf{s}_1 = \\left[\\tfrac{1}{2}, \\tfrac{\\sqrt{3}}{2}\\right] $ (direction at $60^\\circ$),\n- $ \\mathbf{s}_2 = \\left[-\\tfrac{1}{2}, \\tfrac{\\sqrt{3}}{2}\\right] $ (direction at $120^\\circ$).\n\nFor each slip direction $\\mathbf{s}$, the corresponding slip plane normal is defined by $\\mathbf{n} = [-s_y, s_x]$, which follows from the geometric definition of a plane normal in two dimensions and ensures $\\mathbf{s} \\cdot \\mathbf{n} = 0$. Dislocation emission is modeled via a criterion based on the resolved shear stress $\\tau$ on the slip system, computed from the local stress tensor $\\boldsymbol{\\sigma}$ and the pair $(\\mathbf{s}, \\mathbf{n})$ using $\\tau = \\mathbf{s}^T \\boldsymbol{\\sigma} \\mathbf{n}$. This aligns with the Schmid law and the Peach–Koehler force description for edge dislocations, which state that the shear traction on the slip system controls emission. If $|\\tau|$ exceeds or equals a critical threshold $\\tau_c$ (the lattice shear strength), emission is deemed to occur on the slip system with the largest $|\\tau|$.\n\nWhen emission occurs, the program shall report:\n- the emission angle $\\theta_{\\text{emit}}$ between the crack line (the $x$-axis) and the selected slip direction $\\mathbf{s}$, computed via $\\theta_{\\text{emit}} = \\operatorname{atan2}(s_y, s_x)$ in degrees,\n- the Burgers vector $\\mathbf{b}$ components, modeled for a nearest-neighbor slip as $\\mathbf{b} = a \\, \\mathbf{s}$, where $a$ is the lattice spacing (nearest-neighbor spacing) in Angstroms,\n- the slip plane normal angle $\\theta_{\\text{plane}}$ in degrees, computed via $\\theta_{\\text{plane}} = \\operatorname{atan2}(n_y, n_x)$.\n\nTo connect with atomistic measurement, the program must internally implement a discrete Burgers circuit measurement: given a displacement field $\\mathbf{u}(\\mathbf{x})$ that exhibits a discontinuity across the slip plane, $\\mathbf{u}(\\mathbf{x}) = H(\\mathbf{n} \\cdot \\mathbf{x}) \\, \\mathbf{b}$, where $H(\\cdot)$ is the Heaviside step function, the Burgers vector is computed via the closure failure $\\oint_{\\mathcal{C}} d\\mathbf{u}$, with $\\mathcal{C}$ a loop encircling the crack tip. This measurement must be used internally to validate that the emitted $\\mathbf{b}$ is consistent with the topological definition of a dislocation.\n\nFundamental base for derivation:\n- Newton’s Second Law of Motion ($\\mathbf{F} = m \\mathbf{a}$) underpins Molecular Dynamics (MD), but in this problem we employ a quasi-static approximation near the crack tip where emission is governed by the maximum resolved shear stress criterion, a well-tested approach grounded in continuum elasticity.\n- Linear elasticity near the crack tip provides a stress field $\\boldsymbol{\\sigma}$, but to avoid over-specified formulas, the stress tensor is provided as an input to the algorithm, reflecting a local state at a small radius ahead of the tip.\n- The resolved shear stress $\\tau = \\mathbf{s}^T \\boldsymbol{\\sigma} \\mathbf{n}$ determines dislocation nucleation. This maps the continuum stress field to atomistic slip systems through the Schmid law.\n- The Burgers vector $\\mathbf{b}$ is measured as the closure failure of the displacement field around a loop, $\\mathbf{b} = \\oint_{\\mathcal{C}} d\\mathbf{u}$, consistent with the standard definition in crystallography.\n\nUnits and output specification:\n- Stress tensor components $\\sigma_{xx}$, $\\sigma_{yy}$, and $\\sigma_{xy}$ must be interpreted in megapascal (MPa).\n- The lattice spacing $a$ must be interpreted in Angstroms.\n- Angles must be reported in degrees.\n- The program must output, for each test case, a list $[\\text{flag}, \\theta_{\\text{emit}}, b_x, b_y, \\theta_{\\text{plane}}]$, where $\\text{flag}$ is $1$ if emission occurs and $0$ otherwise; $\\theta_{\\text{emit}}$ is the emission angle in degrees; $(b_x, b_y)$ are the Burgers vector components in Angstroms; and $\\theta_{\\text{plane}}$ is the slip plane normal angle in degrees. If no emission occurs, output $\\theta_{\\text{emit}} = -1$, $b_x = 0$, $b_y = 0$, and $\\theta_{\\text{plane}} = -1$. Angles must be rounded to three decimal places, and Burgers vector components must be rounded to four decimal places.\n\nTest suite:\nProvide the following test cases to assess the algorithm’s coverage and robustness.\n\n- Case $1$ (happy path, emission on a nonzero angle slip system):\n    $$ \\boldsymbol{\\sigma} = \\begin{bmatrix} 150  20 \\\\ 20  10 \\end{bmatrix} \\text{ MPa}, $$\n    - $a = 2.5$ Angstroms,\n    - $\\tau_c = 60$ MPa.\n    Expected behavior: a slip system not aligned with the crack line ($60^\\circ$) should activate because of the dominant normal stress component projected onto the slip plane.\n\n- Case $2$ (no emission, below threshold):\n    $$ \\boldsymbol{\\sigma} = \\begin{bmatrix} 10  40 \\\\ 40  10 \\end{bmatrix} \\text{ MPa}, $$\n    - $a = 2.0$ Angstroms,\n    - $\\tau_c = 50$ MPa.\n    Expected behavior: $\\max |\\tau|$ is less than $\\tau_c$, thus no emission.\n\n- Case $3$ (boundary case, equality with threshold):\n    $$ \\boldsymbol{\\sigma} = \\begin{bmatrix} 30  80 \\\\ 80  30 \\end{bmatrix} \\text{ MPa}, $$\n    - $a = 1.8$ Angstroms,\n    - $\\tau_c = 80$ MPa.\n    Expected behavior: $\\max |\\tau| = \\tau_c$, emission at the slip system aligned with the crack line.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the form $[\\text{flag}, \\theta_{\\text{emit}}, b_x, b_y, \\theta_{\\text{plane}}]$. For example, the output must look like $[[\\dots],[\\dots],[\\dots]]$ for the three provided cases, and it must include the specified rounding and units interpretation.",
            "solution": "The problem is to design a program that models dislocation emission from a crack tip in a two-dimensional triangular crystalline lattice. The model must be based on fundamental physical principles, specifically the Schmid law, which relates the continuum stress state to discrete crystallographic slip. The program will determine if a dislocation is emitted and, if so, compute its characteristic properties: Burgers vector, slip plane, and emission angle.\n\nThe validation of the problem statement confirms that it is scientifically grounded, well-posed, and contains all necessary information to construct a unique and meaningful solution. The model, though simplified, correctly employs principles from solid mechanics and materials science, such as the concept of resolved shear stress and the crystallographic definition of a dislocation. The provided test cases are consistent with the physical model described.\n\nThe procedural design follows a direct implementation of the physical model.\n\nFirst, we define the geometry of potential slip in the two-dimensional triangular lattice. The problem specifies three primary slip systems. A slip system is defined by a pair of vectors: the slip direction $\\mathbf{s}$ and the slip plane normal $\\mathbf{n}$. For the given lattice, these are:\n- Slip System $0$: corresponding to slip at an angle of $0^\\circ$ relative to the crack line (the $x$-axis).\n  - Slip direction: $\\mathbf{s}_0 = [1, 0]^T$\n  - Slip plane normal: $\\mathbf{n}_0 = [0, 1]^T$\n- Slip System $1$: corresponding to slip at an angle of $60^\\circ$.\n  - Slip direction: $\\mathbf{s}_1 = [\\frac{1}{2}, \\frac{\\sqrt{3}}{2}]^T$\n  - Slip plane normal: $\\mathbf{n}_1 = [-\\frac{\\sqrt{3}}{2}, \\frac{1}{2}]^T$\n- Slip System $2$: corresponding to slip at an angle of $120^\\circ$.\n  - Slip direction: $\\mathbf{s}_2 = [-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}]^T$\n  - Slip plane normal: $\\mathbf{n}_2 = [-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}]^T$\n\nThe core of the model is the criterion for dislocation emission, which is based on the resolved shear stress, $\\tau$. This scalar quantity represents the component of the traction vector acting on the slip plane, projected onto the slip direction. For a given stress tensor $\\boldsymbol{\\sigma}$, the resolved shear stress is calculated by the formula:\n$$ \\tau = \\mathbf{n}^T \\boldsymbol{\\sigma} \\mathbf{s} $$\nNote that since the stress tensor $\\boldsymbol{\\sigma} = \\begin{bmatrix} \\sigma_{xx}  \\sigma_{xy} \\\\ \\sigma_{xy}  \\sigma_{yy} \\end{bmatrix}$ is symmetric, $\\mathbf{n}^T \\boldsymbol{\\sigma} \\mathbf{s} = (\\mathbf{n}^T \\boldsymbol{\\sigma} \\mathbf{s})^T = \\mathbf{s}^T \\boldsymbol{\\sigma}^T \\mathbf{n} = \\mathbf{s}^T \\boldsymbol{\\sigma} \\mathbf{n}$, so the order of vectors in the product is interchangeable. Let's use the expression from the problem, $\\tau = \\mathbf{s}^T \\boldsymbol{\\sigma} \\mathbf{n}$.\n\nThe algorithm proceeds as follows for each test case, characterized by an input stress tensor $\\boldsymbol{\\sigma}$, a lattice spacing $a$, and a critical resolved shear stress $\\tau_c$:\n1.  Calculate the resolved shear stress $\\tau_i$ for each of the three slip systems, $i \\in \\{0, 1, 2\\}$, using the provided stress tensor $\\boldsymbol{\\sigma}$.\n    - $\\tau_0 = \\mathbf{s}_0^T \\boldsymbol{\\sigma} \\mathbf{n}_0 = \\sigma_{xy}$\n    - $\\tau_1 = \\mathbf{s}_1^T \\boldsymbol{\\sigma} \\mathbf{n}_1 = \\frac{\\sqrt{3}}{4}(\\sigma_{yy} - \\sigma_{xx}) - \\frac{1}{2}\\sigma_{xy}$\n    - $\\tau_2 = \\mathbf{s}_2^T \\boldsymbol{\\sigma} \\mathbf{n}_2 = -\\frac{\\sqrt{3}}{4}(\\sigma_{yy} - \\sigma_{xx}) - \\frac{1}{2}\\sigma_{xy}$\n2.  Determine the slip system that experiences the highest magnitude of resolved shear stress. We find the index $k$ such that $|\\tau_k| = \\max(|\\tau_0|, |\\tau_1|, |\\tau_2|)$. If there is a tie, the system with the smallest index is chosen.\n3.  Apply the emission criterion: compare the maximum absolute resolved shear stress $|\\tau_k|$ with the critical threshold $\\tau_c$.\n    - If $|\\tau_k| \\ge \\tau_c$, dislocation emission occurs on slip system $k$.\n    - If $|\\tau_k|  \\tau_c$, the stress is insufficient to cause emission.\n\nIf emission occurs, the following quantities are computed for the winning slip system $k$:\n- A flag is set to $1$.\n- The emission angle, $\\theta_{\\text{emit}}$, is the angle of the slip direction $\\mathbf{s}_k$ with respect to the positive $x$-axis. It is calculated as $\\theta_{\\text{emit}} = \\operatorname{atan2}(s_{ky}, s_{kx})$, converted to degrees, and rounded to $3$ decimal places.\n- The Burgers vector, $\\mathbf{b}$, represents the magnitude and direction of the lattice distortion. It is defined as $\\mathbf{b} = a \\cdot \\mathbf{s}_k$. The components $b_x$ and $b_y$ are given in Angstroms and rounded to $4$ decimal places.\n- The slip plane normal angle, $\\theta_{\\text{plane}}$, is the angle of the slip plane normal $\\mathbf{n}_k$ with respect to the positive $x$-axis. It is calculated as $\\theta_{\\text{plane}} = \\operatorname{atan2}(n_{ky}, n_{kx})$, converted to degrees, and rounded to $3$ decimal places.\n- The final output for the case is the list $[1, \\theta_{\\text{emit}}, b_x, b_y, \\theta_{\\text{plane}}]$.\n\nIf no emission occurs:\n- The flag is set to $0$.\n- The placeholder values specified in the problem are used: $\\theta_{\\text{emit}} = -1$, $b_x = 0$, $b_y = 0$, and $\\theta_{\\text{plane}} = -1$.\n- The final output for the case is the list $[0, -1, 0, 0, -1]$.\n\nThe conceptual validation of the Burgers vector $\\mathbf{b}$ via the integral $\\mathbf{b} = \\oint_{\\mathcal{C}} d\\mathbf{u}$ is a statement of theoretical consistency, confirming that the model's output $\\mathbf{b} = a \\mathbf{s}$ corresponds to the topological definition of a dislocation. This principle justifies the model but is not an explicit computational step in the algorithm, as the displacement field $\\mathbf{u}(\\mathbf{x})$ is not an input. The algorithm directly computes $\\mathbf{b}$ from the winning slip system.\n\nThe entire process is encapsulated in a program that iterates through the provided test suite, calculates the result for each case, and formats the aggregated results into a single output line as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the dislocation emission problem for the given test suite.\n    \"\"\"\n\n    # Define the three primary slip systems (s, n) for a 2D triangular lattice.\n    # s: slip direction, n: slip plane normal\n    sqrt3_2 = np.sqrt(3) / 2.0\n    slip_systems = [\n        {'s': np.array([1.0, 0.0]), 'n': np.array([0.0, 1.0])},\n        {'s': np.array([0.5, sqrt3_2]), 'n': np.array([-sqrt3_2, 0.5])},\n        {'s': np.array([-0.5, sqrt3_2]), 'n': np.array([-sqrt3_2, -0.5])}\n    ]\n\n    # Test suite provided in the problem statement.\n    test_cases = [\n        # Case 1: Emission on a 60-degree slip system\n        {\n            \"sigma\": np.array([[150.0, 20.0], [20.0, 10.0]]),\n            \"a\": 2.5,\n            \"tau_c\": 60.0\n        },\n        # Case 2: No emission, below threshold\n        {\n            \"sigma\": np.array([[10.0, 40.0], [40.0, 10.0]]),\n            \"a\": 2.0,\n            \"tau_c\": 50.0\n        },\n        # Case 3: Boundary case, emission on the 0-degree slip system\n        {\n            \"sigma\": np.array([[30.0, 80.0], [80.0, 30.0]]),\n            \"a\": 1.8,\n            \"tau_c\": 80.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_emission(case[\"sigma\"], case[\"a\"], case[\"tau_c\"], slip_systems)\n        results.append(result)\n    \n    # Format the final output string as a list of lists.\n    # e.g., [[1, 60.000, ...], [0, -1, ...]] without extra spaces.\n    str_results = []\n    for res in results:\n        # Format numbers to the specified precision for the string representation\n        # and handle the integer flag and -1 values.\n        if res[0] == 1:\n            str_res = (f\"[{res[0]},\"\n                       f\"{res[1]:.3f},\"\n                       f\"{res[2]:.4f},\"\n                       f\"{res[3]:.4f},\"\n                       f\"{res[4]:.3f}]\")\n        else: # No emission case\n            str_res = f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]}]\"\n        str_results.append(str_res)\n\n    final_output = f\"[{','.join(str_results)}]\"\n    print(final_output)\n\ndef calculate_emission(sigma, a, tau_c, slip_systems):\n    \"\"\"\n    Calculates dislocation emission based on the resolved shear stress criterion.\n\n    Args:\n        sigma (np.ndarray): The 2x2 stress tensor in MPa.\n        a (float): The lattice spacing in Angstroms.\n        tau_c (float): The critical resolved shear stress in MPa.\n        slip_systems (list): A list of dictionaries, each defining a slip system.\n\n    Returns:\n        list: A list containing [flag, theta_emit, b_x, b_y, theta_plane].\n    \"\"\"\n    \n    taus = []\n    for system in slip_systems:\n        s = system['s']\n        n = system['n']\n        # tau = s^T * sigma * n\n        tau = s.T @ sigma @ n\n        taus.append(tau)\n    \n    taus_abs = np.abs(taus)\n    max_tau_abs = np.max(taus_abs)\n    # Get the index of the first occurrence of the maximum value\n    winner_idx = np.argmax(taus_abs)\n\n    # Check emission criterion\n    if max_tau_abs >= tau_c:\n        flag = 1\n        \n        # Get properties of the winning slip system\n        winning_system = slip_systems[winner_idx]\n        s_winner = winning_system['s']\n        n_winner = winning_system['n']\n        \n        # Calculate emission angle in degrees\n        theta_emit = np.degrees(np.arctan2(s_winner[1], s_winner[0]))\n        \n        # Calculate Burgers vector components in Angstroms\n        b = a * s_winner\n        b_x, b_y = b[0], b[1]\n        \n        # Calculate slip plane normal angle in degrees\n        theta_plane = np.degrees(np.arctan2(n_winner[1], n_winner[0]))\n        \n        # Round to specified precision\n        return [\n            flag, \n            round(theta_emit, 3), \n            round(b_x, 4), \n            round(b_y, 4), \n            round(theta_plane, 3)\n        ]\n    else:\n        # No emission\n        flag = 0\n        return [flag, -1, 0.0, 0.0, -1]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}