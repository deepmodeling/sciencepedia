{
    "hands_on_practices": [
        {
            "introduction": "大涡模拟（LES）的核心思想是通过空间滤波将流场分解为大尺度（可解）和小尺度（亚格子）结构。为了深刻理解这一过程，我们必须首先掌握滤波操作本身在数学上的效应。本练习将引导你通过推导一种常用滤波器——“高帽”滤波器——在谱空间中的传递函数，并将其衰减特性与其他滤波器进行比较，从而从根本上揭示LES中尺度分离的本质 。",
            "id": "3773910",
            "problem": "在不可压缩湍流的大涡模拟 (LES) 和亚网格尺度 (SGS) 建模的背景下，空间滤波被用来分离已解析和未解析的尺度。考虑一个一维、线性、位移不变的滤波器，其核函数为 $G_{\\Delta}(x)$，且被归一化以满足 $\\int_{-\\infty}^{\\infty} G_{\\Delta}(x)\\,dx = 1$。滤波后的场由卷积给出：$\\bar{u}(x) = \\int_{-\\infty}^{\\infty} G_{\\Delta}(r)\\,u(x-r)\\,dr$。谱传递函数 $\\widehat{G}_{\\Delta}(k)$ 定义为 $G_{\\Delta}(x)$ 的傅里叶变换，其约定为 $\\widehat{f}(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-\\mathrm{i} k x)\\,dx$，波数 $k$ 处的衰减为 $A(k) = |\\widehat{G}_{\\Delta}(k)|$。\n\n考虑三种典型的滤波器，它们都与一个特征滤波宽度 $\\Delta$ 相关联：\n- 顶帽（箱式）滤波器，其核函数 $G_{\\Delta}^{\\mathrm{TH}}(x)$ 在宽度为 $\\Delta$ 的区间上为常数，在其他地方为零。\n- 高斯滤波器 $G_{\\Delta}^{\\mathrm{G}}(x)$，其标准差 $\\sigma$ 的选择使其二阶矩与顶帽滤波器的二阶矩相匹配。\n- 尖锐谱截断滤波器 $G_{\\Delta}^{\\mathrm{CO}}(x)$，其在傅里叶空间中定义为一个在有限频带内为常数谱传递函数、带外为零的函数，截断点的选择使其满足 $k_{c}\\Delta = \\pi$。\n\n令无量纲波数为 $\\xi = k \\Delta$。从上述定义出发，推导顶帽滤波器的谱传递函数 $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k)$，并用 $\\xi$ 表示。然后，利用指定的匹配条件和截断定义，分别写出高斯滤波器和尖锐谱截断滤波器的相应衰减函数 $A_{\\mathrm{G}}(\\xi)$ 和 $A_{\\mathrm{CO}}(\\xi)$，并比较它们作为 $\\xi$ 的函数的衰减行为（特别是在 $\\xi \\approx \\pi/2$ 附近），过程中不作任何非物理性假设。\n\n你的最终答案应为顶帽滤波器谱传递函数 $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}$ 的一个单一闭式解析表达式，且纯粹用 $\\xi$ 表示。",
            "solution": "问题陈述已被评估并确定为有效。它在科学上基于流体动力学中大涡模拟 (LES) 的既定理论，问题提法良好，信息充分且一致，并以客观、正式的语言表达。所有定义和要求条件在该领域内均为标准。因此，我们可以着手求解。\n\n该问题要求推导一维顶帽滤波器的谱传递函数，并随后与等效的高斯滤波器和尖锐谱截断滤波器的衰减函数进行比较。\n\n首先，我们定义顶帽（或箱式）滤波器 $G_{\\Delta}^{\\mathrm{TH}}(x)$ 的核函数。它被定义为一个在宽度为 $\\Delta$ 的区间上为常数，在其他地方为零的函数。为对称起见，我们将此区间中心设在 $x=0$。归一化条件 $\\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = 1$ 决定了该常数的值。设该常数为 $C$。那么，\n$$\n\\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} C\\,dx = C \\cdot \\Delta = 1\n$$\n这得到 $C = 1/\\Delta$。因此，滤波器核函数为：\n$$\nG_{\\Delta}^{\\mathrm{TH}}(x) =\n\\begin{cases}\n\\frac{1}{\\Delta}  \\text{if } |x| \\le \\frac{\\Delta}{2} \\\\\n0  \\text{if } |x|  \\frac{\\Delta}{2}\n\\end{cases}\n$$\n谱传递函数 $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k)$ 是核函数 $G_{\\Delta}^{\\mathrm{TH}}(x)$ 的傅里叶变换。使用所提供的傅里叶变换定义 $\\widehat{f}(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-\\mathrm{i} k x)\\,dx$，我们计算：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,\\exp(-\\mathrm{i} k x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} \\frac{1}{\\Delta} \\exp(-\\mathrm{i} k x)\\,dx\n$$\n执行积分：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\frac{1}{\\Delta} \\left[ \\frac{\\exp(-\\mathrm{i} k x)}{-\\mathrm{i} k} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{-\\mathrm{i} k \\Delta} \\left( \\exp\\left(-\\mathrm{i} k \\frac{\\Delta}{2}\\right) - \\exp\\left(\\mathrm{i} k \\frac{\\Delta}{2}\\right) \\right)\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta)}{2\\mathrm{i}}$，我们可以简化该表达式：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\frac{1}{k \\Delta} \\left( \\frac{\\exp\\left(\\mathrm{i} k \\frac{\\Delta}{2}\\right) - \\exp\\left(-\\mathrm{i} k \\frac{\\Delta}{2}\\right)}{\\mathrm{i}} \\right) = \\frac{2 \\sin\\left(k \\frac{\\Delta}{2}\\right)}{k \\Delta} = \\frac{\\sin\\left(\\frac{k\\Delta}{2}\\right)}{\\frac{k\\Delta}{2}}\n$$\n这就是 sinc 函数，$\\mathrm{sinc}(z) = \\frac{\\sin(z)}{z}$。问题要求结果用无量纲波数 $\\xi = k \\Delta$ 来表示。将 $k\\Delta = \\xi$ 代入我们的结果，得到顶帽传递函数的最终表达式：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(\\xi) = \\frac{\\sin\\left(\\frac{\\xi}{2}\\right)}{\\frac{\\xi}{2}}\n$$\n此函数是实数，所以其衰减为 $A_{\\mathrm{TH}}(\\xi) = |\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(\\xi)| = \\left|\\frac{\\sin(\\xi/2)}{\\xi/2}\\right|$。\n\n接下来，我们推导高斯滤波器的衰减函数 $A_{\\mathrm{G}}(\\xi)$。高斯滤波器核函数为 $G_{\\Delta}^{\\mathrm{G}}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp(-\\frac{x^2}{2\\sigma^2})$。其标准差 $\\sigma$ 是通过将其二阶矩 $M_2^{\\mathrm{G}} = \\int_{-\\infty}^{\\infty} x^2 G_{\\Delta}^{\\mathrm{G}}(x)\\,dx = \\sigma^2$ 与顶帽滤波器的二阶矩相匹配来指定的。顶帽滤波器的二阶矩为：\n$$\nM_2^{\\mathrm{TH}} = \\int_{-\\infty}^{\\infty} x^2 G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} x^2 \\frac{1}{\\Delta}\\,dx = \\frac{1}{\\Delta} \\left[ \\frac{x^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right) = \\frac{2\\Delta^3}{24\\Delta} = \\frac{\\Delta^2}{12}\n$$\n令二阶矩相等，得到 $\\sigma^2 = \\frac{\\Delta^2}{12}$。高斯函数的傅里叶变换是另一个高斯函数：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{G}}(k) = \\exp\\left(-\\frac{k^2 \\sigma^2}{2}\\right)\n$$\n代入 $\\sigma^2 = \\frac{\\Delta^2}{12}$：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{G}}(k) = \\exp\\left(-\\frac{k^2 \\Delta^2}{24}\\right)\n$$\n用 $\\xi = k\\Delta$ 表示，衰减函数 $A_{\\mathrm{G}}(\\xi) = |\\widehat{G}_{\\Delta}^{\\mathrm{G}}(\\xi)|$ 变为：\n$$\nA_{\\mathrm{G}}(\\xi) = \\exp\\left(-\\frac{\\xi^2}{24}\\right)\n$$\n最后，我们考虑尖锐谱截断滤波器。它在傅里叶空间中定义：在波数达到截断值 $k_c$ 之前，其谱传递函数为常数，超过该值则为零。归一化条件 $\\int G(x)dx=1$ 意味着 $\\widehat{G}(0)=1$，因此常数值为 $1$。截断点由 $k_c \\Delta = \\pi$ 设定，即 $k_c = \\pi/\\Delta$。因此，传递函数为：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{CO}}(k) =\n\\begin{cases}\n1  \\text{if } |k| \\le k_c = \\frac{\\pi}{\\Delta} \\\\\n0  \\text{if } |k|  k_c = \\frac{\\pi}{\\Delta}\n\\end{cases}\n$$\n条件 $|k| \\le \\frac{\\pi}{\\Delta}$ 等价于 $|k\\Delta| \\le \\pi$，即 $|\\xi| \\le \\pi$。因此，衰减函数是波数空间中的一个矩形函数：\n$$\nA_{\\mathrm{CO}}(\\xi) =\n\\begin{cases}\n1  \\text{if } |\\xi| \\le \\pi \\\\\n0  \\text{if } |\\xi|  \\pi\n\\end{cases}\n$$\n现在，我们比较衰减行为。对于小波数（$\\xi \\to 0$），我们可以使用泰勒级数展开：\n$A_{\\mathrm{TH}}(\\xi) = \\frac{\\sin(\\xi/2)}{\\xi/2} \\approx \\frac{\\xi/2 - (\\xi/2)^3/6}{\\xi/2} = 1 - \\frac{\\xi^2}{24} + \\mathcal{O}(\\xi^4)$.\n$A_{\\mathrm{G}}(\\xi) = \\exp(-\\xi^2/24) \\approx 1 - \\frac{\\xi^2}{24} + \\mathcal{O}(\\xi^4)$.\n$A_{\\mathrm{CO}}(\\xi) = 1$ for $\\xi \\le \\pi$.\n对于大尺度（小 $\\xi$），顶帽滤波器和高斯滤波器的衰减在主导阶上是等效的，这是匹配它们二阶矩的直接结果。\n\n在特定的无量纲波数 $\\xi = \\pi/2$ 处：\n$A_{\\mathrm{TH}}(\\pi/2) = \\frac{\\sin(\\pi/4)}{\\pi/4} = \\frac{\\sqrt{2}/2}{\\pi/4} = \\frac{2\\sqrt{2}}{\\pi} \\approx 0.9003$。\n$A_{\\mathrm{G}}(\\pi/2) = \\exp(-(\\pi/2)^2/24) = \\exp(-\\pi^2/96) \\approx 0.9023$。\n$A_{\\mathrm{CO}}(\\pi/2) = 1$。\n此时，顶帽滤波器和高斯滤波器的衰减非常相似，而尖锐谱截断滤波器则完全没有衰减信号。\n\n从定性上看，尖锐谱截断滤波器是最“理想”的低通滤波器，因为它完全移除了所有 $\\xi  \\pi$ 的模态，并完美保留了所有 $\\xi  \\pi$ 的模态。然而，它在物理空间中的核函数是非局域的 sinc 函数，这对于实际的 LES 来说是有问题的。高斯滤波器具有在物理空间和谱空间中都具备局域性的理想特性，从而对高波数提供平滑、单调的衰减。顶帽滤波器在物理空间中是局域的，但其传递函数存在振荡（旁瓣），这可能在经过零点后将能量重新引入到更高波数，这种现象称为频谱泄漏。这一点很明显，因为 $A_{\\mathrm{TH}}(\\xi)$ 在 $\\xi/2 = \\pi$ 时，即 $\\xi=2\\pi$ 时，首次达到零。",
            "answer": "$$\n\\boxed{\\frac{\\sin\\left(\\frac{\\xi}{2}\\right)}{\\frac{\\xi}{2}}}\n$$"
        },
        {
            "introduction": "在理论分析中，滤波器宽度 $\\Delta$ 通常被视为一个简单的标量。然而，在真实的计算流体动力学（CFD）模拟中，计算网格往往是各向异性的，即在不同方向上具有不同的分辨率。本练习将理论与实践相结合，探讨如何在各向异性网格上定义滤波器宽度，并量化不同定义方式对Smagorinsky亚格子模型预测的涡粘性系数 $\\nu_t$ 的影响 。通过这个练习，你将深入理解计算网格的几何特性如何直接影响亚格子模型的行为。",
            "id": "3773899",
            "problem": "在不可压缩流的大涡模拟（LES）中，使用 Smagorinsky 类型的亚格子尺度闭合，考虑一个局部各向异性的网格，其在笛卡尔坐标方向上的网格间距分别为 $\\Delta_x$、$\\Delta_y$ 和 $\\Delta_z$。在某一点，已解算的应变率张量 $S_{ij}$ 已知为\n$$\nS \\;=\\;\n\\begin{pmatrix}\n25  25  0 \\\\\n25  -25  0 \\\\\n0  0  0\n\\end{pmatrix}\n\\;\\text{s}^{-1},\n$$\n该张量是对称且无迹的，与不可压缩性一致。设各向异性网格间距为\n$$\n\\Delta_x \\;=\\; 3.0 \\times 10^{-3}\\ \\text{m},\\quad\n\\Delta_y \\;=\\; 1.0 \\times 10^{-3}\\ \\text{m},\\quad\n\\Delta_z \\;=\\; 0.5 \\times 10^{-3}\\ \\text{m}.\n$$\n\n在 Smagorinsky 闭合中，考虑两种选择滤波宽度的方法：\n\n- 各向同性选择：$\\Delta_{\\text{iso}} \\equiv (\\Delta_x \\Delta_y \\Delta_z)^{1/3}$。\n\n- 方向特定选择：定义单位向量 $\\boldsymbol{n}_{\\max}$ 为主拉伸方向（即与 $S_{ij}$ 的最大特征值相关联的特征向量）。方向特定的滤波宽度是沿 $\\boldsymbol{n}_{\\max}$ 方向解析的有效网格间距：\n$$\n\\Delta_{\\text{dir}} \\;\\equiv\\; \\Delta(\\boldsymbol{n}_{\\max}) \\;=\\; \\sqrt{n_x^2\\,\\Delta_x^2 \\;+\\; n_y^2\\,\\Delta_y^2 \\;+\\; n_z^2\\,\\Delta_z^2},\n$$\n其中 $(n_x,n_y,n_z)$ 是 $\\boldsymbol{n}_{\\max}$ 的分量。\n\n在经典的 Smagorinsky 闭合模型下，亚格子涡粘性与所选滤波宽度的平方乘以已解算应变率的范数成正比。仅使用这一事实，计算无量纲比率\n$$\nr \\;\\equiv\\; \\frac{\\nu_t^{\\text{(iso)}}}{\\nu_t^{\\text{(dir)}}}\n$$\n在给定点的值。将您的答案四舍五入到四位有效数字。最终答案是无量纲的，请勿包含单位。",
            "solution": "首先验证问题，以确保其具有科学依据、适定且客观。\n\n**1. 提取已知条件：**\n- 在某一点的已解算应变率张量为 $S = \\begin{pmatrix} 25  25  0 \\\\ 25  -25  0 \\\\ 0  0  0 \\end{pmatrix} \\, \\text{s}^{-1}$。\n- 网格间距为 $\\Delta_x = 3.0 \\times 10^{-3} \\, \\text{m}$，$\\Delta_y = 1.0 \\times 10^{-3} \\, \\text{m}$ 和 $\\Delta_z = 0.5 \\times 10^{-3} \\, \\text{m}$。\n- 各向同性滤波宽度定义为 $\\Delta_{\\text{iso}} = (\\Delta_x \\Delta_y \\Delta_z)^{1/3}$。\n- 方向特定滤波宽度为 $\\Delta_{\\text{dir}} = \\sqrt{n_x^2 \\Delta_x^2 + n_y^2 \\Delta_y^2 + n_z^2 \\Delta_z^2}$，其中 $\\boldsymbol{n}_{\\max} = (n_x, n_y, n_z)$ 是 $S$ 对应其最大特征值的单位特征向量。\n- 亚格子涡粘性 $\\nu_t$ 与滤波宽度 $\\Delta$ 的平方和应变率的范数成正比，即 $\\nu_t \\propto \\Delta^2 |S|$。\n- 目标是计算比率 $r = \\nu_t^{\\text{(iso)}} / \\nu_t^{\\text{(dir)}}$。\n\n**2. 验证：**\n该问题设置在计算流体动力学的标准技术——大涡模拟（LES）的背景下。Smagorinsky 模型是一种基础的亚格子尺度闭合。所提供的应变率张量 $S$ 是对称的（$S_{ij}=S_{ji}$）且无迹的（$25 - 25 + 0 = 0$），这与不可压缩流的物理特性一致。各向同性和各向异性滤波宽度的定义是在各向异性网格上进行 LES 时使用的标准且具有物理意义的构造。所有必要信息都已提供，问题在数学上和科学上都是适定的。没有矛盾、歧义或事实错误。该问题被认为是有效的。\n\n**3. 求解推导：**\nSmagorinsky 模型中的亚格子涡粘性由 $\\nu_t = (C_S \\Delta)^2 |S|$ 给出，其中 $C_S$ 是 Smagorinsky 常数，$\\Delta$ 是滤波宽度，而 $|S| = \\sqrt{2 S_{ij} S_{ij}}$ 是应变率张量的大小。问题陈述了一个比例关系，我们可以写成 $\\nu_t = C \\Delta^2 |S|$，其中 $C$ 是某个常数。\n\n对于两种不同的滤波宽度选择，我们有：\n- 各向同性选择：$\\nu_t^{\\text{(iso)}} = C \\Delta_{\\text{iso}}^2 |S|$。\n- 方向特定选择：$\\nu_t^{\\text{(dir)}} = C \\Delta_{\\text{dir}}^2 |S|$。\n\n因此，比率 $r$ 为：\n$$ r = \\frac{\\nu_t^{\\text{(iso)}}}{\\nu_t^{\\text{(dir)}}} = \\frac{C \\Delta_{\\text{iso}}^2 |S|}{C \\Delta_{\\text{dir}}^2 |S|} = \\left(\\frac{\\Delta_{\\text{iso}}}{\\Delta_{\\text{dir}}}\\right)^2 = \\frac{\\Delta_{\\text{iso}}^2}{\\Delta_{\\text{dir}}^2} $$\n问题简化为计算每种滤波宽度的平方。\n\n首先，我们计算 $\\Delta_{\\text{iso}}^2$：\n$$ \\Delta_{\\text{iso}}^2 = \\left( (\\Delta_x \\Delta_y \\Delta_z)^{1/3} \\right)^2 = (\\Delta_x \\Delta_y \\Delta_z)^{2/3} $$\n代入给定值：\n$$ \\Delta_x \\Delta_y \\Delta_z = (3.0 \\times 10^{-3}) (1.0 \\times 10^{-3}) (0.5 \\times 10^{-3}) \\, \\text{m}^3 = 1.5 \\times 10^{-9} \\, \\text{m}^3 $$\n$$ \\Delta_{\\text{iso}}^2 = (1.5 \\times 10^{-9})^{2/3} \\, \\text{m}^2 = (1.5)^{2/3} \\times 10^{-6} \\, \\text{m}^2 $$\n\n接下来，我们计算 $\\Delta_{\\text{dir}}^2$。这需要找到主拉伸方向 $\\boldsymbol{n}_{\\max}$，即与 $S$ 的最大特征值相对应的特征向量。我们通过求解特征方程 $\\det(S - \\lambda I) = 0$ 来找到特征值 $\\lambda$。\n$$ S - \\lambda I = \\begin{pmatrix} 25 - \\lambda  25  0 \\\\ 25  -25 - \\lambda  0 \\\\ 0  0  -\\lambda \\end{pmatrix} $$\n$$ \\det(S - \\lambda I) = (-\\lambda) \\left[ (25 - \\lambda)(-25 - \\lambda) - (25)^2 \\right] = (-\\lambda) \\left[ -625 + \\lambda^2 - 625 \\right] = (-\\lambda) (\\lambda^2 - 1250) = 0 $$\n特征值为 $\\lambda_1 = 0$，$\\lambda_2 = \\sqrt{1250}$ 和 $\\lambda_3 = -\\sqrt{1250}$。\n由于 $\\sqrt{1250} = \\sqrt{625 \\times 2} = 25\\sqrt{2}$，特征值为 $0$、$25\\sqrt{2}$ 和 $-25\\sqrt{2}$。最大特征值为 $\\lambda_{\\max} = 25\\sqrt{2}$。\n\n现在，我们通过求解 $(S - \\lambda_{\\max} I)\\boldsymbol{v} = 0$ 来找到相应的特征向量 $\\boldsymbol{v} = (v_x, v_y, v_z)^T$：\n$$ \\begin{pmatrix} 25 - 25\\sqrt{2}  25  0 \\\\ 25  -25 - 25\\sqrt{2}  0 \\\\ 0  0  -25\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\\\ v_z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n第三行给出 $-25\\sqrt{2} \\, v_z = 0$，所以 $v_z = 0$。\n第一行给出 $(25 - 25\\sqrt{2})v_x + 25v_y = 0$，可简化为 $(1 - \\sqrt{2})v_x + v_y = 0$，或 $v_y = (\\sqrt{2} - 1)v_x$。\n因此，特征向量与 $(1, \\sqrt{2}-1, 0)^T$ 成比例。为了找到单位向量 $\\boldsymbol{n}_{\\max} = (n_x, n_y, n_z)^T$，我们对该向量进行归一化。其模的平方为 $1^2 + (\\sqrt{2}-1)^2 + 0^2 = 1 + (2 - 2\\sqrt{2} + 1) = 4 - 2\\sqrt{2}$。\n单位向量的分量本身不是必需的，只需要它们的平方：\n$$ n_x^2 = \\frac{1^2}{4 - 2\\sqrt{2}} = \\frac{1}{2(2-\\sqrt{2})} = \\frac{2+\\sqrt{2}}{2(2-\\sqrt{2})(2+\\sqrt{2})} = \\frac{2+\\sqrt{2}}{2(4-2)} = \\frac{2+\\sqrt{2}}{4} $$\n$$ n_y^2 = \\frac{(\\sqrt{2}-1)^2}{4 - 2\\sqrt{2}} = \\frac{3-2\\sqrt{2}}{2(2-\\sqrt{2})} = \\frac{(3-2\\sqrt{2})(2+\\sqrt{2})}{2(4-2)} = \\frac{6+3\\sqrt{2}-4\\sqrt{2}-4}{4} = \\frac{2-\\sqrt{2}}{4} $$\n$$ n_z^2 = 0 $$\n作为检验，$n_x^2 + n_y^2 + n_z^2 = \\frac{2+\\sqrt{2}}{4} + \\frac{2-\\sqrt{2}}{4} + 0 = \\frac{4}{4} = 1$。\n\n现在，我们使用其定义来计算 $\\Delta_{\\text{dir}}^2$：\n$$ \\Delta_{\\text{dir}}^2 = n_x^2 \\Delta_x^2 + n_y^2 \\Delta_y^2 + n_z^2 \\Delta_z^2 $$\n网格间距的平方为：\n$$ \\Delta_x^2 = (3.0 \\times 10^{-3})^2 = 9.0 \\times 10^{-6} \\, \\text{m}^2 $$\n$$ \\Delta_y^2 = (1.0 \\times 10^{-3})^2 = 1.0 \\times 10^{-6} \\, \\text{m}^2 $$\n$$ \\Delta_z^2 = (0.5 \\times 10^{-3})^2 = 0.25 \\times 10^{-6} \\, \\text{m}^2 $$\n代入这些值和 $n_i^2$ 的值：\n$$ \\Delta_{\\text{dir}}^2 = \\left(\\frac{2+\\sqrt{2}}{4}\\right)(9.0 \\times 10^{-6}) + \\left(\\frac{2-\\sqrt{2}}{4}\\right)(1.0 \\times 10^{-6}) + 0 $$\n$$ \\Delta_{\\text{dir}}^2 = \\frac{10^{-6}}{4} \\left[ (2+\\sqrt{2}) \\cdot 9.0 + (2-\\sqrt{2}) \\cdot 1.0 \\right] $$\n$$ \\Delta_{\\text{dir}}^2 = \\frac{10^{-6}}{4} \\left[ 18 + 9\\sqrt{2} + 2 - \\sqrt{2} \\right] = \\frac{10^{-6}}{4} \\left[ 20 + 8\\sqrt{2} \\right] $$\n$$ \\Delta_{\\text{dir}}^2 = (5 + 2\\sqrt{2}) \\times 10^{-6} \\, \\text{m}^2 $$\n\n最后，我们计算无量纲比率 $r$：\n$$ r = \\frac{\\Delta_{\\text{iso}}^2}{\\Delta_{\\text{dir}}^2} = \\frac{(1.5)^{2/3} \\times 10^{-6}}{(5 + 2\\sqrt{2}) \\times 10^{-6}} = \\frac{(1.5)^{2/3}}{5 + 2\\sqrt{2}} $$\n现在，我们对这个表达式进行数值计算：\n$$ \\sqrt{2} \\approx 1.41421356 $$\n$$ 1.5^{2/3} \\approx 1.31037070 $$\n$$ r \\approx \\frac{1.31037070}{5 + 2(1.41421356)} = \\frac{1.31037070}{5 + 2.82842712} = \\frac{1.31037070}{7.82842712} \\approx 0.16738304 $$\n将结果四舍五入到四位有效数字，得到 $0.1674$。",
            "answer": "$$\\boxed{0.1674}$$"
        },
        {
            "introduction": "在许多工程和环境流动问题中，固体壁面附近区域的流动行为至关重要。然而，近壁区也恰恰是大涡模拟面临的最大挑战之一，其根源在于空间滤波操作与微分操作在边界附近不可交换。本练习通过一个简化的近壁流动剖面，让你从第一性原理出发，解析推导这种“交换误差”如何导致可解尺度场在壁面处的剪切应力被错误预测 。完成此练习将使你明白为何标准的亚格子模型在近壁区会失效，以及为何发展精确的壁模型对大涡模拟至关重要。",
            "id": "3773928",
            "problem": "考虑一个用于多尺度建模和分析的大涡模拟 (LES) 中的典型近壁构型：在 $y=0$ 处有一个光滑、不可渗透、无滑移壁面的不可压缩湍流，计算域限制在 $y \\ge 0$。假设在壁面紧邻区域，未滤波的流向速度剖面是线性的，$u(y) = S y$，其中 $S  0$ 是一个恒定的壁面法向剪切率。滤波后的速度场由与一个核函数的空间卷积定义，该卷积在壁面处受到几何截断，并在可及域上进行重新归一化以保持单位质量，\n$$\n\\bar{u}(y) \\equiv \\frac{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,u(\\eta)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}, \\quad y \\ge 0,\n$$\n其中，在没有边界的情况下，$G$ 是 $\\mathbb{R}$ 上的一个对称、非负、单位质量的核函数。将分析两种核函数：\n- 宽度为 $\\Delta  0$ 的对称顶帽核函数，\n$$\nG_{T}(r) = \\begin{cases}\n\\frac{1}{\\Delta},  |r| \\le \\frac{\\Delta}{2}, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n- 标准差为 $\\sigma  0$ 的高斯核函数，\n$$\nG_{G}(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right).\n$$\n\n从上述滤波器定义和线性剖面 $u(y)=Sy$ 出发，为每种核函数推导 $\\bar{u}(y)$ 的闭合形式表达式，仔细考虑壁面截断 ($\\eta \\ge 0$) 和分母中的重新归一化。使用这些表达式，计算壁面处的已解壁面法向梯度，\n$$\n\\left.\\frac{d \\bar{u}}{dy}\\right|_{y=0^{+}},\n$$\n对于每种核函数。从第一性原理出发，不使用任何快捷公式，解释边界截断如何相对于未滤波剪切 $S$ 修改已解梯度，并将此修改与近壁亚格子尺度 (SGS) 建模联系起来。\n\n将顶帽核函数和高斯核函数在 $y=0^{+}$ 处的最终已解壁面法向梯度分别以单个解析行向量的形式给出（用 $S$ 表示）。不需要进行数值四舍五入，最终的方框表达式内不应包含单位。",
            "solution": "该问题提法恰当且科学上合理，其基础是近固体边界大涡模拟 (LES) 的典范公式。我们将进行形式化推导。\n\n对于一维剖面 $u(y)$，滤波后的速度 $\\bar{u}(y)$ 由一个卷积积分定义，在 $y=0$ 处存在壁面的情况下，该积分被截断并重新归一化：\n$$\n\\bar{u}(y) = \\frac{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,u(\\eta)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}, \\quad y \\ge 0\n$$\n给定线性速度剖面 $u(y) = Sy$（其中 $S  0$），我们可以将滤波后的速度表示为：\n$$\n\\bar{u}(y) = \\frac{N(y)}{D(y)} = \\frac{S \\displaystyle \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}\n$$\n我们需要计算壁面处的已解壁面法向梯度，$\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}}$。使用商法则求导：\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = \\frac{N'(0)D(0) - N(0)D'(0)}{[D(0)]^2}\n$$\n其中撇号表示对 $y$ 的求导，并且求值是在 $y \\to 0^{+}$ 时进行的。\n\n我们首先推导所涉及各项的通用表达式。分母是 $D(y) = \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta$。令 $s = \\eta - y$，则 $d\\eta = ds$。积分限变为 $[-y, \\infty)$。\n$$\nD(y) = \\int_{-y}^{\\infty} G(s)\\,ds\n$$\n在 $y=0$ 处，由于 $G$ 是 $\\mathbb{R}$ 上的对称、单位质量核函数，我们有 $D(0) = \\int_{0}^{\\infty} G(s)\\,ds = \\frac{1}{2}\\int_{-\\infty}^{\\infty} G(s)\\,ds = \\frac{1}{2}$。\n使用莱布尼茨积分法则，$D(y)$ 的导数是：\n$$\nD'(y) = \\frac{d}{dy}\\int_{-y}^{\\infty} G(s)\\,ds = -G(-y)\\frac{d(-y)}{dy} = G(-y)\n$$\n由于 $G$ 是对称的，$G(-y) = G(y)$，所以 $D'(y) = G(y)$。在壁面处，$D'(0) = G(0)$。\n\n分子是 $N(y) = S \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta$。\n其导数是 $N'(y) = \\frac{d}{dy} \\left( S \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta \\right)$。\n利用性质 $\\frac{\\partial}{\\partial y}G(\\eta-y) = -\\frac{\\partial}{\\partial \\eta}G(\\eta-y)$，我们可以写出：\n$$\nN'(y) = S \\int_{0}^{\\infty} \\eta \\left(-\\frac{\\partial}{\\partial \\eta}G(\\eta-y)\\right) \\,d\\eta\n$$\n使用分部积分法，令 $f(\\eta)=\\eta$ 和 $dg = -\\frac{\\partial}{\\partial\\eta}G(\\eta-y)d\\eta$，因此 $df = d\\eta$ 且 $g = -G(\\eta-y)$：\n$$\nN'(y) = S \\left( [-\\eta G(\\eta-y)]_{0}^{\\infty} - \\int_{0}^{\\infty} (-G(\\eta-y))\\,d\\eta \\right)\n$$\n边界项 $[-\\eta G(\\eta-y)]$ 在 $\\eta=0$ 时因 $\\eta$ 因子而消失，在 $\\eta \\to \\infty$ 时因顶帽核函数和高斯核函数衰减足够快而消失。这剩下：\n$$\nN'(y) = S \\int_{0}^{\\infty} G(\\eta-y) \\,d\\eta = S D(y)\n$$\n在壁面处，$N'(0) = S D(0) = S/2$。\n最后，壁面处的分子是 $N(0) = S \\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta$。\n\n将这些通用结果代入 $y=0^{+}$ 处的梯度表达式中：\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = \\frac{(S/2)(1/2) - (S \\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta) G(0)}{(1/2)^2} = \\frac{S/4 - S\\,G(0)\\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta}{1/4}\n$$\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = S - 4S\\,G(0)\\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta\n$$\n这个通用公式允许对每种核函数进行系统性计算。\n\n**1. 顶帽核函数 ($G_T$)**\n核函数为 $G_T(r) = \\frac{1}{\\Delta}$ (当 $|r| \\le \\frac{\\Delta}{2}$) 且在其他情况下为 $0$。\n我们计算所需的分量：\n- $G_T(0) = \\frac{1}{\\Delta}$。\n- 积分项为：\n$$\n\\int_{0}^{\\infty} \\eta G_T(\\eta)\\,d\\eta = \\int_{0}^{\\Delta/2} \\eta \\frac{1}{\\Delta}\\,d\\eta = \\frac{1}{\\Delta} \\left[\\frac{\\eta^2}{2}\\right]_{0}^{\\Delta/2} = \\frac{1}{\\Delta} \\frac{(\\Delta/2)^2}{2} = \\frac{\\Delta}{8}\n$$\n代入梯度的通用公式中：\n$$\n\\left.\\frac{d\\bar{u}_T}{dy}\\right|_{y=0^{+}} = S - 4S \\left(\\frac{1}{\\Delta}\\right) \\left(\\frac{\\Delta}{8}\\right) = S - \\frac{4S}{8} = S - \\frac{S}{2} = \\frac{S}{2}\n$$\n\n**2. 高斯核函数 ($G_G$)**\n核函数为 $G_G(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp(-r^{2}/(2\\sigma^{2}))$。\n我们计算分量：\n- $G_G(0) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}$。\n- 积分项为：\n$$\n\\int_{0}^{\\infty} \\eta G_G(\\eta)\\,d\\eta = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\int_{0}^{\\infty} \\eta \\exp\\left(-\\frac{\\eta^2}{2\\sigma^2}\\right)\\,d\\eta\n$$\n使用换元法 $v = \\eta^2/(2\\sigma^2)$，因此 $dv = \\eta/\\sigma^2\\,d\\eta$，所以 $\\eta\\,d\\eta = \\sigma^2\\,dv$：\n$$\n\\int_{0}^{\\infty} \\eta G_G(\\eta)\\,d\\eta = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\int_{0}^{\\infty} \\exp(-v) (\\sigma^2\\,dv) = \\frac{\\sigma}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} \\exp(-v)\\,dv = \\frac{\\sigma}{\\sqrt{2\\pi}} [-\\exp(-v)]_{0}^{\\infty} = \\frac{\\sigma}{\\sqrt{2\\pi}}\n$$\n代入梯度的通用公式中：\n$$\n\\left.\\frac{d\\bar{u}_G}{dy}\\right|_{y=0^{+}} = S - 4S \\left(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\right) \\left(\\frac{\\sigma}{\\sqrt{2\\pi}}\\right) = S - \\frac{4S}{2\\pi} = S\\left(1 - \\frac{2}{\\pi}\\right)\n$$\n\n**解释以及与SGS建模的联系**\n壁面处未滤波的速度梯度是 $\\left.\\frac{du}{dy}\\right|_{y=0} = S$。我们的推导表明，对于顶帽核函数和高斯核函数，壁面处的已解梯度均小于 $S$：$\\frac{S}{2}  S$ 且 $S(1 - 2/\\pi) \\approx 0.363S  S$。\n\n这种减小是在函数定义域被截断的边界附近应用空间滤波器的直接数学结果。在靠近壁面的点 $y$ 处，滤波核函数 $G(\\eta-y)$ 的部分支撑域位于非物理区域 $\\eta  0$。滤波器定义正确地将积分限制在物理域 $\\eta \\ge 0$ 内，并对滤波器权重进行重新归一化。\n\n让我们考虑壁面本身的滤波速度 $\\bar{u}(0)$。未滤波的速度是 $u(0)=0$。然而，滤波过程对 $\\eta  0$ 的 $u(\\eta)=S\\eta$ 值进行平均。由于所有这些值都是正的，得到的平均值 $\\bar{u}(0)$ 也是正的。这在无滑移壁面上为已解场产生了一个人为的“滑移速度”。例如，对于顶帽核函数，$\\bar{u}_T(0) = S\\Delta/4  0$。\n\n因为滤波剖面 $\\bar{u}(y)$ 在 $y=0$ 处从一个正值开始，并且当 $y$ 远大于滤波器宽度时，最终必须与未滤波剖面 $u(y)$ 相匹配，所以其初始斜率必须小于 $S$。滤波操作将壁面附近的速度值“向上拉”，使剖面变得平坦。滤波梯度与真实梯度之间的这种差异通常被称为“交换误差”，因为在边界附近，求导和滤波操作不可交换：$\\frac{d\\bar{u}}{dy} \\neq \\overline{(\\frac{du}{dy})}$。\n\n这对亚格子尺度 (SGS) 建模具有关键意义。壁面处的总剪切应力为 $\\tau_w = \\mu \\left.\\frac{du}{dy}\\right|_{y=0} = \\mu S$。在 LES 框架中，该应力必须表示为已解黏性应力和 SGS 应力之和：\n$$\n\\tau_w = \\mu \\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} + \\tau_{sgs}|_{y=0}\n$$\n由于我们的分析表明 $\\mu \\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}}  \\mu S$，因此必须有 $\\tau_{sgs}|_{y=0}  0$。SGS 模型必须提供由于滤波操作本身而从已解场中“丢失”的那部分剪切应力。对于高斯核函数，壁面处所需的 SGS 应力为 $\\tau_{sgs}|_{y=0} = \\mu S - \\mu S(1-2/\\pi) = \\mu S (2/\\pi)$。这表明，任何旨在一直用到壁面的 SGS 模型都必须构建为能够解释这种滤波伪影，而这正是 LES 中壁面模型所要解决的根本挑战。\n\n**最终答案计算**\n顶帽核函数和高斯核函数在 $y=0^{+}$ 处的已解壁面法向梯度分别为 $\\frac{S}{2}$ 和 $S(1 - \\frac{2}{\\pi})$。这些将以单个解析行向量的形式提供。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{S}{2}  S\\left(1 - \\frac{2}{\\pi}\\right) \\end{pmatrix}}\n$$"
        }
    ]
}