{
    "hands_on_practices": [
        {
            "introduction": "The mathematical operation at the heart of Large-Eddy Simulation (LES) is spatial filtering, which separates the flow into large, resolved eddies and small, modeled subgrid-scale (SGS) motions. A filter's effect is most clearly characterized by its transfer function, which reveals how it attenuates turbulent fluctuations at each spatial wavenumber. This exercise () provides essential practice in deriving the transfer function for the ubiquitous top-hat filter and comparing its spectral properties to other key filter types, building crucial intuition for how the choice of filter impacts the resolved flow field.",
            "id": "3773910",
            "problem": "In the context of Large-Eddy Simulation (LES) and subgrid-scale (SGS) modeling for incompressible turbulent flows, spatial filtering is used to separate resolved and unresolved scales. Consider a one-dimensional, linear, shift-invariant filter with a kernel $G_{\\Delta}(x)$ that is normalized so that $\\int_{-\\infty}^{\\infty} G_{\\Delta}(x)\\,dx = 1$. The filtered field is given by the convolution $\\bar{u}(x) = \\int_{-\\infty}^{\\infty} G_{\\Delta}(r)\\,u(x-r)\\,dr$. The spectral transfer function $\\widehat{G}_{\\Delta}(k)$ is defined as the Fourier transform of $G_{\\Delta}(x)$ under the convention $\\widehat{f}(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-\\mathrm{i} k x)\\,dx$, and the attenuation at wavenumber $k$ is $A(k) = |\\widehat{G}_{\\Delta}(k)|$.\n\nThree prototypical filters are considered, all associated with a characteristic filter width $\\Delta$:\n- A top-hat (box) filter with kernel $G_{\\Delta}^{\\mathrm{TH}}(x)$ that is constant on an interval of width $\\Delta$ and zero elsewhere.\n- A Gaussian filter $G_{\\Delta}^{\\mathrm{G}}(x)$ whose standard deviation $\\sigma$ is chosen so that its second moment matches that of the top-hat filter.\n- A sharp spectral cutoff filter $G_{\\Delta}^{\\mathrm{CO}}(x)$ defined in Fourier space by a constant spectral transfer function over a finite band and zero outside, with cutoff chosen so that $k_{c}\\Delta = \\pi$.\n\nLet the nondimensional wavenumber be $\\xi = k \\Delta$. Starting from the above definitions, derive the spectral transfer function $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k)$ of the top-hat filter in terms of $\\xi$. Then, using the specified matching and definition of the cutoff, write the corresponding attenuation functions $A_{\\mathrm{G}}(\\xi)$ and $A_{\\mathrm{CO}}(\\xi)$ for the Gaussian and sharp cutoff filters, respectively, and compare their attenuation behavior as a function of $\\xi$ (in particular near $\\xi \\approx \\pi/2$) without resorting to any unphysical assumptions.\n\nYour final answer should be a single closed-form analytic expression for the top-hat filter spectral transfer function $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}$ expressed purely in terms of $\\xi$.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in the established theory of Large-Eddy Simulation (LES) for fluid dynamics, is well-posed with sufficient and consistent information, and is expressed in objective, formal language. All definitions and required conditions are standard within the field. We may therefore proceed with the solution.\n\nThe problem requires the derivation of the spectral transfer function for a one-dimensional top-hat filter, and a subsequent comparison with the attenuation functions of equivalent Gaussian and sharp spectral cutoff filters.\n\nFirst, we define the kernel of the top-hat (or box) filter, $G_{\\Delta}^{\\mathrm{TH}}(x)$. It is defined as a function that is constant over an interval of width $\\Delta$ and zero elsewhere. For symmetry, we center this interval at $x=0$. The normalization condition $\\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = 1$ dictates the constant value. Let the constant be $C$. Then,\n$$\n\\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} C\\,dx = C \\cdot \\Delta = 1\n$$\nThis gives $C = 1/\\Delta$. The filter kernel is thus:\n$$\nG_{\\Delta}^{\\mathrm{TH}}(x) =\n\\begin{cases}\n\\frac{1}{\\Delta}  \\text{if } |x| \\le \\frac{\\Delta}{2} \\\\\n0  \\text{if } |x|  \\frac{\\Delta}{2}\n\\end{cases}\n$$\nThe spectral transfer function, $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k)$, is the Fourier transform of the kernel $G_{\\Delta}^{\\mathrm{TH}}(x)$. Using the provided definition of the Fourier transform, $\\widehat{f}(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-\\mathrm{i} k x)\\,dx$, we compute:\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,\\exp(-\\mathrm{i} k x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} \\frac{1}{\\Delta} \\exp(-\\mathrm{i} k x)\\,dx\n$$\nPerforming the integration:\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\frac{1}{\\Delta} \\left[ \\frac{\\exp(-\\mathrm{i} k x)}{-\\mathrm{i} k} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{-\\mathrm{i} k \\Delta} \\left( \\exp\\left(-\\mathrm{i} k \\frac{\\Delta}{2}\\right) - \\exp\\left(\\mathrm{i} k \\frac{\\Delta}{2}\\right) \\right)\n$$\nUsing the Euler identity $\\sin(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta)}{2\\mathrm{i}}$, we can simplify the expression:\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\frac{1}{k \\Delta} \\left( \\frac{\\exp\\left(\\mathrm{i} k \\frac{\\Delta}{2}\\right) - \\exp\\left(-\\mathrm{i} k \\frac{\\Delta}{2}\\right)}{\\mathrm{i}} \\right) = \\frac{2 \\sin\\left(k \\frac{\\Delta}{2}\\right)}{k \\Delta} = \\frac{\\sin\\left(\\frac{k\\Delta}{2}\\right)}{\\frac{k\\Delta}{2}}\n$$\nThis is the sinc function, $\\mathrm{sinc}(z) = \\frac{\\sin(z)}{z}$. The problem requires the result to be expressed in terms of the nondimensional wavenumber $\\xi = k \\Delta$. Substituting $k\\Delta = \\xi$ into our result yields the final expression for the top-hat transfer function:\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(\\xi) = \\frac{\\sin\\left(\\frac{\\xi}{2}\\right)}{\\frac{\\xi}{2}}\n$$\nThis function is real, so its attenuation is $A_{\\mathrm{TH}}(\\xi) = |\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(\\xi)| = \\left|\\frac{\\sin(\\xi/2)}{\\xi/2}\\right|$.\n\nNext, we derive the attenuation function for the Gaussian filter, $A_{\\mathrm{G}}(\\xi)$. The Gaussian filter kernel is $G_{\\Delta}^{\\mathrm{G}}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp(-\\frac{x^2}{2\\sigma^2})$. Its standard deviation $\\sigma$ is specified by matching its second moment, $M_2^{\\mathrm{G}} = \\int_{-\\infty}^{\\infty} x^2 G_{\\Delta}^{\\mathrm{G}}(x)\\,dx = \\sigma^2$, to that of the top-hat filter. The second moment of the top-hat filter is:\n$$\nM_2^{\\mathrm{TH}} = \\int_{-\\infty}^{\\infty} x^2 G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} x^2 \\frac{1}{\\Delta}\\,dx = \\frac{1}{\\Delta} \\left[ \\frac{x^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right) = \\frac{2\\Delta^3}{24\\Delta} = \\frac{\\Delta^2}{12}\n$$\nEquating the second moments gives $\\sigma^2 = \\frac{\\Delta^2}{12}$. The Fourier transform of a Gaussian function is another Gaussian function:\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{G}}(k) = \\exp\\left(-\\frac{k^2 \\sigma^2}{2}\\right)\n$$\nSubstituting $\\sigma^2 = \\frac{\\Delta^2}{12}$:\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{G}}(k) = \\exp\\left(-\\frac{k^2 \\Delta^2}{24}\\right)\n$$\nIn terms of $\\xi = k\\Delta$, the attenuation function $A_{\\mathrm{G}}(\\xi) = |\\widehat{G}_{\\Delta}^{\\mathrm{G}}(\\xi)|$ becomes:\n$$\nA_{\\mathrm{G}}(\\xi) = \\exp\\left(-\\frac{\\xi^2}{24}\\right)\n$$\nFinally, we consider the sharp spectral cutoff filter. It is defined in Fourier space by a constant spectral transfer function for wavenumbers up to a cutoff $k_c$, and zero beyond. The normalization condition $\\int G(x)dx=1$ implies $\\widehat{G}(0)=1$, so the constant value is $1$. The cutoff is set by $k_c \\Delta = \\pi$, or $k_c = \\pi/\\Delta$. Thus, the transfer function is:\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{CO}}(k) =\n\\begin{cases}\n1  \\text{if } |k| \\le k_c = \\frac{\\pi}{\\Delta} \\\\\n0  \\text{if } |k|  k_c = \\frac{\\pi}{\\Delta}\n\\end{cases}\n$$\nThe condition $|k| \\le \\frac{\\pi}{\\Delta}$ is equivalent to $|k\\Delta| \\le \\pi$, or $|\\xi| \\le \\pi$. The attenuation function is therefore a rectangular function in wavenumber space:\n$$\nA_{\\mathrm{CO}}(\\xi) =\n\\begin{cases}\n1  \\text{if } |\\xi| \\le \\pi \\\\\n0  \\text{if } |\\xi|  \\pi\n\\end{cases}\n$$\nNow, we compare the attenuation behaviors. For small wavenumbers ($\\xi \\to 0$), we can use Taylor series expansions:\n$A_{\\mathrm{TH}}(\\xi) = \\frac{\\sin(\\xi/2)}{\\xi/2} \\approx \\frac{\\xi/2 - (\\xi/2)^3/6}{\\xi/2} = 1 - \\frac{\\xi^2}{24} + \\mathcal{O}(\\xi^4)$.\n$A_{\\mathrm{G}}(\\xi) = \\exp(-\\xi^2/24) \\approx 1 - \\frac{\\xi^2}{24} + \\mathcal{O}(\\xi^4)$.\n$A_{\\mathrm{CO}}(\\xi) = 1$ for $\\xi \\le \\pi$.\nThe equivalence of the leading-order attenuation for the top-hat and Gaussian filters for large scales (small $\\xi$) is a direct consequence of matching their second moments.\n\nAt the specific nondimensional wavenumber $\\xi = \\pi/2$:\n$A_{\\mathrm{TH}}(\\pi/2) = \\frac{\\sin(\\pi/4)}{\\pi/4} = \\frac{\\sqrt{2}/2}{\\pi/4} = \\frac{2\\sqrt{2}}{\\pi} \\approx 0.9003$.\n$A_{\\mathrm{G}}(\\pi/2) = \\exp(-(\\pi/2)^2/24) = \\exp(-\\pi^2/96) \\approx 0.9023$.\n$A_{\\mathrm{CO}}(\\pi/2) = 1$.\nThe attenuation of the top-hat and Gaussian filters are very similar at this point, while the sharp cutoff filter has not attenuated the signal at all.\n\nQualitatively, the sharp cutoff filter is the most \"ideal\" low-pass filter, as it completely removes all modes with $\\xi  \\pi$ and perfectly preserves all modes with $\\xi  \\pi$. However, its kernel in physical space is the non-local sinc function, which is problematic for practical LES. The Gaussian filter has the desirable property of being localized in both physical and spectral space, providing a smooth, monotonic attenuation of high wavenumbers. The top-hat filter is localized in physical space but its transfer function has oscillations (side lobes), which can re-introduce energy at higher wavenumbers after passing through zero, a phenomenon known as spectral leakage. This is evident as $A_{\\mathrm{TH}}(\\xi)$ first reaches zero at $\\xi/2 = \\pi$, i.e., $\\xi=2\\pi$.",
            "answer": "$$\n\\boxed{\\frac{\\sin\\left(\\frac{\\xi}{2}\\right)}{\\frac{\\xi}{2}}}\n$$"
        },
        {
            "introduction": "While the theoretical properties of filters are often studied in infinite domains, practical simulations almost always involve boundaries. When a spatial filter is applied near a solid wall, the necessary truncation of the filter kernel introduces mathematical artifacts that have profound physical consequences for the simulation. This practice () explores this critical issue by analyzing a canonical near-wall velocity profile, demonstrating how the filtering operation itself creates a discrepancy between the resolved velocity gradient and the true gradient, thereby revealing the fundamental need for wall modeling in LES.",
            "id": "3773928",
            "problem": "Consider a canonical near-wall configuration for Large-Eddy Simulation (LES) in multiscale modeling and analysis: an incompressible turbulent flow over a smooth, impermeable, no-slip wall at $y=0$, with the computational domain restricted to $y \\ge 0$. Assume that, in the immediate vicinity of the wall, the unfiltered streamwise velocity profile is linear, $u(y) = S y$, where $S  0$ is a constant wall-normal shear rate. The filtered velocity field is defined by a spatial convolution with a kernel, subject to geometric truncation at the wall and renormalization to preserve unit mass on the accessible domain,\n$$\n\\bar{u}(y) \\equiv \\frac{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,u(\\eta)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}, \\quad y \\ge 0,\n$$\nwhere $G$ is a symmetric, nonnegative, unit-mass kernel on $\\mathbb{R}$ in the absence of boundaries. Two kernels are to be analyzed:\n- A symmetric top-hat kernel of width $\\Delta  0$,\n$$\nG_{T}(r) = \\begin{cases}\n\\frac{1}{\\Delta},  |r| \\le \\frac{\\Delta}{2}, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n- A Gaussian kernel of standard deviation $\\sigma  0$,\n$$\nG_{G}(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right).\n$$\n\nStarting from the filter definition above and the linear profile $u(y)=Sy$, derive closed-form expressions for $\\bar{u}(y)$ for each kernel, carefully accounting for the wall truncation ($\\eta \\ge 0$) and the renormalization in the denominator. Using those expressions, compute the resolved wall-normal gradient at the wall,\n$$\n\\left.\\frac{d \\bar{u}}{dy}\\right|_{y=0^{+}},\n$$\nfor each kernel. Explain, from first principles and without invoking any shortcut formulas, how boundary truncation modifies the resolved gradient relative to the unfiltered shear $S$, and connect this modification to subgrid-scale (SGS) modeling near walls.\n\nProvide the final resolved wall-normal gradients at $y=0^{+}$ for the top-hat and Gaussian kernels, respectively, as a single analytic row vector in terms of $S$. No numerical rounding is required, and no units should be written inside the final boxed expression.",
            "solution": "The problem is well-posed and scientifically sound, grounded in the canonical formulation of Large-Eddy Simulation (LES) near solid boundaries. We shall proceed with a formal derivation.\n\nThe filtered velocity $\\bar{u}(y)$ for a one-dimensional profile $u(y)$ is defined by a convolution integral, which in the presence of a wall at $y=0$ is truncated and renormalized:\n$$\n\\bar{u}(y) = \\frac{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,u(\\eta)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}, \\quad y \\ge 0\n$$\nGiven the linear velocity profile $u(y) = Sy$ for $S  0$, we can express the filtered velocity as:\n$$\n\\bar{u}(y) = \\frac{N(y)}{D(y)} = \\frac{S \\displaystyle \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}\n$$\nWe are asked to compute the resolved wall-normal gradient at the wall, $\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}}$. Using the quotient rule for differentiation:\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = \\frac{N'(0)D(0) - N(0)D'(0)}{[D(0)]^2}\n$$\nwhere primes denote differentiation with respect to $y$, and the evaluation is taken as $y \\to 0^{+}$.\n\nWe first derive general expressions for the terms involved. The denominator is $D(y) = \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta$. Let $s = \\eta - y$, so $d\\eta = ds$. The integration limits become $[\\-y, \\infty)$.\n$$\nD(y) = \\int_{-y}^{\\infty} G(s)\\,ds\n$$\nAt $y=0$, since $G$ is a symmetric, unit-mass kernel on $\\mathbb{R}$, we have $D(0) = \\int_{0}^{\\infty} G(s)\\,ds = \\frac{1}{2}\\int_{-\\infty}^{\\infty} G(s)\\,ds = \\frac{1}{2}$.\nUsing the Leibniz integral rule, the derivative of $D(y)$ is:\n$$\nD'(y) = \\frac{d}{dy}\\int_{-y}^{\\infty} G(s)\\,ds = -G(-y)\\frac{d(-y)}{dy} = G(-y)\n$$\nSince $G$ is symmetric, $G(-y) = G(y)$, so $D'(y) = G(y)$. At the wall, $D'(0) = G(0)$.\n\nThe numerator is $N(y) = S \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta$.\nIts derivative is $N'(y) = \\frac{d}{dy} \\left( S \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta \\right)$.\nUsing the property that $\\frac{\\partial}{\\partial y}G(\\eta-y) = -\\frac{\\partial}{\\partial \\eta}G(\\eta-y)$, we can write:\n$$\nN'(y) = S \\int_{0}^{\\infty} \\eta \\left(-\\frac{\\partial}{\\partial \\eta}G(\\eta-y)\\right) \\,d\\eta\n$$\nIntegrating by parts with $f(\\eta)=\\eta$ and $dg = -\\frac{\\partial}{\\partial\\eta}G(\\eta-y)d\\eta$, so $df = d\\eta$ and $g = -G(\\eta-y)$:\n$$\nN'(y) = S \\left( [-\\eta G(\\eta-y)]_{0}^{\\infty} - \\int_{0}^{\\infty} (-G(\\eta-y))\\,d\\eta \\right)\n$$\nThe boundary term $[-\\eta G(\\eta-y)]$ vanishes at $\\eta=0$ because of the $\\eta$ factor and at $\\eta \\to \\infty$ because kernels like the top-hat and Gaussian decay sufficiently fast. This leaves:\n$$\nN'(y) = S \\int_{0}^{\\infty} G(\\eta-y) \\,d\\eta = S D(y)\n$$\nAt the wall, $N'(0) = S D(0) = S/2$.\nFinally, the numerator at the wall is $N(0) = S \\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta$.\n\nSubstituting these general results into the expression for the gradient at $y=0^{+}$:\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = \\frac{(S/2)(1/2) - (S \\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta) G(0)}{(1/2)^2} = \\frac{S/4 - S\\,G(0)\\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta}{1/4}\n$$\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = S - 4S\\,G(0)\\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta\n$$\nThis general formula allows for a systematic calculation for each kernel.\n\n**1. Top-Hat Kernel ($G_T$)**\nThe kernel is $G_T(r) = \\frac{1}{\\Delta}$ for $|r| \\le \\frac{\\Delta}{2}$ and $0$ otherwise.\nWe evaluate the required components:\n- $G_T(0) = \\frac{1}{\\Delta}$.\n- The integral term is:\n$$\n\\int_{0}^{\\infty} \\eta G_T(\\eta)\\,d\\eta = \\int_{0}^{\\Delta/2} \\eta \\frac{1}{\\Delta}\\,d\\eta = \\frac{1}{\\Delta} \\left[\\frac{\\eta^2}{2}\\right]_{0}^{\\Delta/2} = \\frac{1}{\\Delta} \\frac{(\\Delta/2)^2}{2} = \\frac{\\Delta}{8}\n$$\nSubstituting into the general formula for the gradient:\n$$\n\\left.\\frac{d\\bar{u}_T}{dy}\\right|_{y=0^{+}} = S - 4S \\left(\\frac{1}{\\Delta}\\right) \\left(\\frac{\\Delta}{8}\\right) = S - \\frac{4S}{8} = S - \\frac{S}{2} = \\frac{S}{2}\n$$\n\n**2. Gaussian Kernel ($G_G$)**\nThe kernel is $G_G(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp(-r^{2}/(2\\sigma^{2}))$.\nWe evaluate the components:\n- $G_G(0) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}$.\n- The integral term is:\n$$\n\\int_{0}^{\\infty} \\eta G_G(\\eta)\\,d\\eta = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\int_{0}^{\\infty} \\eta \\exp\\left(-\\frac{\\eta^2}{2\\sigma^2}\\right)\\,d\\eta\n$$\nUsing the substitution $v = \\eta^2/(2\\sigma^2)$, for which $dv = \\eta/\\sigma^2\\,d\\eta$, so $\\eta\\,d\\eta = \\sigma^2\\,dv$:\n$$\n\\int_{0}^{\\infty} \\eta G_G(\\eta)\\,d\\eta = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\int_{0}^{\\infty} \\exp(-v) (\\sigma^2\\,dv) = \\frac{\\sigma}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} \\exp(-v)\\,dv = \\frac{\\sigma}{\\sqrt{2\\pi}} [-\\exp(-v)]_{0}^{\\infty} = \\frac{\\sigma}{\\sqrt{2\\pi}}\n$$\nSubstituting into the general formula for the gradient:\n$$\n\\left.\\frac{d\\bar{u}_G}{dy}\\right|_{y=0^{+}} = S - 4S \\left(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\right) \\left(\\frac{\\sigma}{\\sqrt{2\\pi}}\\right) = S - \\frac{4S}{2\\pi} = S\\left(1 - \\frac{2}{\\pi}\\right)\n$$\n\n**Explanation and Connection to SGS Modeling**\nThe unfiltered velocity gradient at the wall is $\\left.\\frac{du}{dy}\\right|_{y=0} = S$. Our derivations show that for both the top-hat and Gaussian kernels, the resolved gradient at the wall is less than $S$: $\\frac{S}{2}  S$ and $S(1 - 2/\\pi) \\approx 0.363S  S$.\n\nThis reduction is a direct mathematical consequence of applying a spatial filter near a boundary where the domain of the function is truncated. At a point $y$ near the wall, the filter kernel $G(\\eta-y)$ has part of its support in the non-physical region $\\eta  0$. The filter definition correctly restricts the integration to the physical domain $\\eta \\ge 0$ and renormalizes the filter weight.\n\nLet's consider the filtered velocity at the wall itself, $\\bar{u}(0)$. The unfiltered velocity is $u(0)=0$. However, the filtering process averages values of $u(\\eta)=S\\eta$ for $\\eta  0$. Since all these values are positive, the resulting average $\\bar{u}(0)$ is also positive. This creates an artificial \"slip velocity\" for the resolved field at the no-slip wall. For example, for the top-hat kernel, $\\bar{u}_T(0) = S\\Delta/4  0$.\n\nBecause the filtered profile $\\bar{u}(y)$ starts at a positive value at $y=0$ and must eventually match the unfiltered profile $u(y)$ for $y$ large compared to the filter width, its initial slope must be smaller than $S$. The filtering operation \"pulls\" the velocity values near the wall upward, flattening the profile. This discrepancy between the filtered gradient and the true gradient is often referred to as a \"commutation error,\" as the operations of differentiation and filtering do not commute near a boundary: $\\frac{d\\bar{u}}{dy} \\neq \\overline{(\\frac{du}{dy})}$.\n\nThis has a critical implication for subgrid-scale (SGS) modeling. The total shear stress at the wall is $\\tau_w = \\mu \\left.\\frac{du}{dy}\\right|_{y=0} = \\mu S$. In an LES framework, this stress must be represented as the sum of the resolved viscous stress and the SGS stress:\n$$\n\\tau_w = \\mu \\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} + \\tau_{sgs}|_{y=0}\n$$\nSince our analysis shows that $\\mu \\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}}  \\mu S$, it is necessary that $\\tau_{sgs}|_{y=0}  0$. The SGS model must provide the \"missing\" part of the shear stress that is lost from the resolved field by the filtering operation itself. For the Gaussian kernel, the required SGS stress at the wall is $\\tau_{sgs}|_{y=0} = \\mu S - \\mu S(1-2/\\pi) = \\mu S (2/\\pi)$. This demonstrates that any SGS model intended for use down to the wall must be constructed to account for this filtering artifact, which is the fundamental challenge addressed by wall-modeling in LES.\n\n**Final Answer Calculation**\nThe resolved wall-normal gradients at $y=0^{+}$ for the top-hat and Gaussian kernels are $\\frac{S}{2}$ and $S(1 - \\frac{2}{\\pi})$, respectively. These are to be provided as a single analytic row vector.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{S}{2}  S\\left(1 - \\frac{2}{\\pi}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A key practical challenge in implementing LES is adapting the single filter-width parameter, $\\Delta$, used in many subgrid-scale models to the anisotropic grid cells common in computational fluid dynamics. The method chosen to define $\\Delta$ from the directional grid spacings ($\\Delta_x$, $\\Delta_y$, $\\Delta_z$) is not arbitrary; it directly controls the magnitude of the modeled eddy viscosity and thus the dissipation of energy. This exercise () provides a concrete scenario to quantify the significant difference between a simple isotropic definition and a more physically-informed, direction-dependent filter scale, highlighting the sensitivity of SGS models to their implementation details.",
            "id": "3773899",
            "problem": "In Large-Eddy Simulation (LES) of an incompressible flow using a subgrid-scale closure of Smagorinsky type, consider a locally anisotropic mesh with grid spacings $\\Delta_x$, $\\Delta_y$, and $\\Delta_z$ in the Cartesian directions. At a point, the resolved strain-rate tensor $S_{ij}$ is known to be\n$$\nS \\;=\\;\n\\begin{pmatrix}\n25  25  0 \\\\\n25  -25  0 \\\\\n0  0  0\n\\end{pmatrix}\n\\;\\text{s}^{-1},\n$$\nwhich is symmetric and trace-free, consistent with incompressibility. Let the anisotropic grid spacings be\n$$\n\\Delta_x \\;=\\; 3.0 \\times 10^{-3}\\ \\text{m},\\quad\n\\Delta_y \\;=\\; 1.0 \\times 10^{-3}\\ \\text{m},\\quad\n\\Delta_z \\;=\\; 0.5 \\times 10^{-3}\\ \\text{m}.\n$$\n\nTwo ways of choosing the filter width in the Smagorinsky closure are considered:\n\n- Isotropic choice: $\\Delta_{\\text{iso}} \\equiv (\\Delta_x \\Delta_y \\Delta_z)^{1/3}$.\n\n- Direction-specific choice: define the unit vector $\\boldsymbol{n}_{\\max}$ as the principal extensional direction (the eigenvector of $S_{ij}$ associated with the largest eigenvalue). The direction-specific filter width is the effective grid spacing resolved along $\\boldsymbol{n}_{\\max}$:\n$$\n\\Delta_{\\text{dir}} \\;\\equiv\\; \\Delta(\\boldsymbol{n}_{\\max}) \\;=\\; \\sqrt{n_x^2\\,\\Delta_x^2 \\;+\\; n_y^2\\,\\Delta_y^2 \\;+\\; n_z^2\\,\\Delta_z^2},\n$$\nwhere $(n_x,n_y,n_z)$ are the components of $\\boldsymbol{n}_{\\max}$.\n\nUnder the classical Smagorinsky closure, the subgrid eddy viscosity is proportional to the square of the chosen filter width times a norm of the resolved strain rate. Using only this fact, compute the dimensionless ratio\n$$\nr \\;\\equiv\\; \\frac{\\nu_t^{\\text{(iso)}}}{\\nu_t^{\\text{(dir)}}}\n$$\nat the given point. Round your answer to four significant figures. The final answer is dimensionless; do not include units.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**1. Extraction of Givens:**\n- The resolved strain-rate tensor at a point is $S = \\begin{pmatrix} 25  25  0 \\\\ 25  -25  0 \\\\ 0  0  0 \\end{pmatrix} \\, \\text{s}^{-1}$.\n- The grid spacings are $\\Delta_x = 3.0 \\times 10^{-3} \\, \\text{m}$, $\\Delta_y = 1.0 \\times 10^{-3} \\, \\text{m}$, and $\\Delta_z = 0.5 \\times 10^{-3} \\, \\text{m}$.\n- The isotropic filter width is defined as $\\Delta_{\\text{iso}} = (\\Delta_x \\Delta_y \\Delta_z)^{1/3}$.\n- The direction-specific filter width is $\\Delta_{\\text{dir}} = \\sqrt{n_x^2 \\Delta_x^2 + n_y^2 \\Delta_y^2 + n_z^2 \\Delta_z^2}$, where $\\boldsymbol{n}_{\\max} = (n_x, n_y, n_z)$ is the unit eigenvector of $S$ corresponding to its largest eigenvalue.\n- The subgrid eddy viscosity $\\nu_t$ is proportional to the square of the filter width $\\Delta$ and a norm of the strain rate, i.e., $\\nu_t \\propto \\Delta^2 |S|$.\n- The objective is to compute the ratio $r = \\nu_t^{\\text{(iso)}} / \\nu_t^{\\text{(dir)}}$.\n\n**2. Validation:**\nThe problem is set in the context of Large-Eddy Simulation (LES), a standard technique in computational fluid dynamics. The Smagorinsky model is a foundational subgrid-scale closure. The provided strain-rate tensor $S$ is symmetric ($S_{ij}=S_{ji}$) and trace-free ($25 - 25 + 0 = 0$), consistent with the physics of incompressible flow. The definitions for the isotropic and anisotropic filter widths are standard and physically meaningful constructs used in LES on anisotropic grids. All necessary information is provided, and the problem is mathematically and scientifically well-posed. There are no contradictions, ambiguities, or factual errors. The problem is deemed valid.\n\n**3. Solution Derivation:**\nThe subgrid eddy viscosity in the Smagorinsky model is given by $\\nu_t = (C_S \\Delta)^2 |S|$, where $C_S$ is the Smagorinsky constant, $\\Delta$ is the filter width, and $|S| = \\sqrt{2 S_{ij} S_{ij}}$ is the magnitude of the strain-rate tensor. The problem states a proportionality, which we can write as $\\nu_t = C \\Delta^2 |S|$ where $C$ is some constant.\n\nFor the two different choices of filter width, we have:\n- Isotropic choice: $\\nu_t^{\\text{(iso)}} = C \\Delta_{\\text{iso}}^2 |S|$.\n- Direction-specific choice: $\\nu_t^{\\text{(dir)}} = C \\Delta_{\\text{dir}}^2 |S|$.\n\nThe ratio $r$ is therefore:\n$$ r = \\frac{\\nu_t^{\\text{(iso)}}}{\\nu_t^{\\text{(dir)}}} = \\frac{C \\Delta_{\\text{iso}}^2 |S|}{C \\Delta_{\\text{dir}}^2 |S|} = \\left(\\frac{\\Delta_{\\text{iso}}}{\\Delta_{\\text{dir}}}\\right)^2 = \\frac{\\Delta_{\\text{iso}}^2}{\\Delta_{\\text{dir}}^2} $$\nThe problem reduces to computing the square of each filter width.\n\nFirst, we calculate $\\Delta_{\\text{iso}}^2$:\n$$ \\Delta_{\\text{iso}}^2 = \\left( (\\Delta_x \\Delta_y \\Delta_z)^{1/3} \\right)^2 = (\\Delta_x \\Delta_y \\Delta_z)^{2/3} $$\nSubstituting the given values:\n$$ \\Delta_x \\Delta_y \\Delta_z = (3.0 \\times 10^{-3}) (1.0 \\times 10^{-3}) (0.5 \\times 10^{-3}) \\, \\text{m}^3 = 1.5 \\times 10^{-9} \\, \\text{m}^3 $$\n$$ \\Delta_{\\text{iso}}^2 = (1.5 \\times 10^{-9})^{2/3} \\, \\text{m}^2 = (1.5)^{2/3} \\times 10^{-6} \\, \\text{m}^2 $$\n\nNext, we calculate $\\Delta_{\\text{dir}}^2$. This requires finding the principal extensional direction $\\boldsymbol{n}_{\\max}$, which is the eigenvector corresponding to the largest eigenvalue of $S$. We find the eigenvalues $\\lambda$ by solving the characteristic equation $\\det(S - \\lambda I) = 0$.\n$$ S - \\lambda I = \\begin{pmatrix} 25 - \\lambda  25  0 \\\\ 25  -25 - \\lambda  0 \\\\ 0  0  -\\lambda \\end{pmatrix} $$\n$$ \\det(S - \\lambda I) = (-\\lambda) \\left[ (25 - \\lambda)(-25 - \\lambda) - (25)^2 \\right] = (-\\lambda) \\left[ -625 + \\lambda^2 - 625 \\right] = (-\\lambda) (\\lambda^2 - 1250) = 0 $$\nThe eigenvalues are $\\lambda_1 = 0$, $\\lambda_2 = \\sqrt{1250}$, and $\\lambda_3 = -\\sqrt{1250}$.\nSince $\\sqrt{1250} = \\sqrt{625 \\times 2} = 25\\sqrt{2}$, the eigenvalues are $0$, $25\\sqrt{2}$, and $-25\\sqrt{2}$. The largest eigenvalue is $\\lambda_{\\max} = 25\\sqrt{2}$.\n\nNow, we find the corresponding eigenvector $\\boldsymbol{v} = (v_x, v_y, v_z)^T$ by solving $(S - \\lambda_{\\max} I)\\boldsymbol{v} = 0$:\n$$ \\begin{pmatrix} 25 - 25\\sqrt{2}  25  0 \\\\ 25  -25 - 25\\sqrt{2}  0 \\\\ 0  0  -25\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\\\ v_z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nThe third row gives $-25\\sqrt{2} \\, v_z = 0$, so $v_z = 0$.\nThe first row gives $(25 - 25\\sqrt{2})v_x + 25v_y = 0$, which simplifies to $(1 - \\sqrt{2})v_x + v_y = 0$, or $v_y = (\\sqrt{2} - 1)v_x$.\nThe eigenvector is thus proportional to $(1, \\sqrt{2}-1, 0)^T$. To find the unit vector $\\boldsymbol{n}_{\\max} = (n_x, n_y, n_z)^T$, we normalize this vector. The squared magnitude is $1^2 + (\\sqrt{2}-1)^2 + 0^2 = 1 + (2 - 2\\sqrt{2} + 1) = 4 - 2\\sqrt{2}$.\nThe components of the unit vector are not needed directly, only their squares:\n$$ n_x^2 = \\frac{1^2}{4 - 2\\sqrt{2}} = \\frac{1}{2(2-\\sqrt{2})} = \\frac{2+\\sqrt{2}}{2(2-\\sqrt{2})(2+\\sqrt{2})} = \\frac{2+\\sqrt{2}}{2(4-2)} = \\frac{2+\\sqrt{2}}{4} $$\n$$ n_y^2 = \\frac{(\\sqrt{2}-1)^2}{4 - 2\\sqrt{2}} = \\frac{3-2\\sqrt{2}}{2(2-\\sqrt{2})} = \\frac{(3-2\\sqrt{2})(2+\\sqrt{2})}{2(4-2)} = \\frac{6+3\\sqrt{2}-4\\sqrt{2}-4}{4} = \\frac{2-\\sqrt{2}}{4} $$\n$$ n_z^2 = 0 $$\nAs a check, $n_x^2 + n_y^2 + n_z^2 = \\frac{2+\\sqrt{2}}{4} + \\frac{2-\\sqrt{2}}{4} + 0 = \\frac{4}{4} = 1$.\n\nNow, we compute $\\Delta_{\\text{dir}}^2$ using its definition:\n$$ \\Delta_{\\text{dir}}^2 = n_x^2 \\Delta_x^2 + n_y^2 \\Delta_y^2 + n_z^2 \\Delta_z^2 $$\nThe squared grid spacings are:\n$$ \\Delta_x^2 = (3.0 \\times 10^{-3})^2 = 9.0 \\times 10^{-6} \\, \\text{m}^2 $$\n$$ \\Delta_y^2 = (1.0 \\times 10^{-3})^2 = 1.0 \\times 10^{-6} \\, \\text{m}^2 $$\n$$ \\Delta_z^2 = (0.5 \\times 10^{-3})^2 = 0.25 \\times 10^{-6} \\, \\text{m}^2 $$\nSubstituting these and the values for $n_i^2$:\n$$ \\Delta_{\\text{dir}}^2 = \\left(\\frac{2+\\sqrt{2}}{4}\\right)(9.0 \\times 10^{-6}) + \\left(\\frac{2-\\sqrt{2}}{4}\\right)(1.0 \\times 10^{-6}) + 0 $$\n$$ \\Delta_{\\text{dir}}^2 = \\frac{10^{-6}}{4} \\left[ (2+\\sqrt{2}) \\cdot 9.0 + (2-\\sqrt{2}) \\cdot 1.0 \\right] $$\n$$ \\Delta_{\\text{dir}}^2 = \\frac{10^{-6}}{4} \\left[ 18 + 9\\sqrt{2} + 2 - \\sqrt{2} \\right] = \\frac{10^{-6}}{4} \\left[ 20 + 8\\sqrt{2} \\right] $$\n$$ \\Delta_{\\text{dir}}^2 = (5 + 2\\sqrt{2}) \\times 10^{-6} \\, \\text{m}^2 $$\n\nFinally, we compute the dimensionless ratio $r$:\n$$ r = \\frac{\\Delta_{\\text{iso}}^2}{\\Delta_{\\text{dir}}^2} = \\frac{(1.5)^{2/3} \\times 10^{-6}}{(5 + 2\\sqrt{2}) \\times 10^{-6}} = \\frac{(1.5)^{2/3}}{5 + 2\\sqrt{2}} $$\nNow, we evaluate this expression numerically:\n$$ \\sqrt{2} \\approx 1.41421356 $$\n$$ 1.5^{2/3} \\approx 1.31037070 $$\n$$ r \\approx \\frac{1.31037070}{5 + 2(1.41421356)} = \\frac{1.31037070}{5 + 2.82842712} = \\frac{1.31037070}{7.82842712} \\approx 0.16738304 $$\nRounding the result to four significant figures gives $0.1674$.",
            "answer": "$$\\boxed{0.1674}$$"
        }
    ]
}