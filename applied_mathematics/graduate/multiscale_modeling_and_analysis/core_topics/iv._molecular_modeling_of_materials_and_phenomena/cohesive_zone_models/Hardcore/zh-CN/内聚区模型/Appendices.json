{
    "hands_on_practices": [
        {
            "introduction": "要理解内聚区模型，第一步是掌握其数学形式与其所代表的物理属性之间的关系。这里的核心概念是，断裂能$G_c$（衡量材料韧性的一个指标）由牵引力-分离位移曲线的形状直接决定。本练习  旨在通过推导一个广泛应用的指数型内聚律的基本关系，提供实践经验，从而阐明内聚强度 $\\sigma_{c}$ 和特征长度 $\\delta_{c}$ 在定义峰值应力和断裂过程总耗散能方面的各自作用。",
            "id": "2544708",
            "problem": "在纯张开（I型）模式下分层问题的二维有限元法（FEM）分析中，一个零厚度内聚界面通过法线方向上的标量牵引力-分离位移法则进行建模。设牵引力是法向位移跳跃的函数，记为 $t(\\delta)$，其中 $\\delta \\ge 0$ 是张开位移。假设界面初始完好，且牵引力-分离位移关系由下式给出\n$$\nt(\\delta) = \\sigma_{c}\\,\\exp\\!\\left(-\\frac{\\delta}{\\delta_{c}}\\right),\n$$\n其中 $\\sigma_{c} > 0$ 是一个量纲为应力的材料强度参数，$\\delta_{c} > 0$ 是一个量纲为长度的材料长度尺度参数。单位面积的分离总功，也称为临界能量释放率或断裂能，（在I型模式下）定义为牵引力-分离位移曲线下的面积：\n$$\nG_{c} \\equiv \\int_{0}^{\\infty} t(\\delta)\\, \\mathrm{d}\\delta.\n$$\n\n从单位面积的机械功定义为牵引力对张开位移的积分出发，并仅使用给定的 $t(\\delta)$ 函数形式，以参数 $\\sigma_{c}$ 和 $\\delta_{c}$ 的形式计算 $G_{c}$ 的闭合解。\n\n然后，在同一建模框架内，与内聚单元的牛顿线性化相关的一致切向刚度定义为 $k_{t}(\\delta) \\equiv \\mathrm{d}t/\\mathrm{d}\\delta$。使用上面的 $t(\\delta)$，以符号形式确定 $k_{t}(0)$（用 $\\sigma_{c}$ 和 $\\delta_{c}$ 表示），并利用功共轭和能量正则化的第一性原理，简要解释 $\\sigma_{c}$ 和 $\\delta_{c}$ 在控制峰值牵引力、软化长度尺度和断裂能方面各自扮演的不同角色。你最终报告的答案必须仅为 $G_{c}$ 的闭合形式表达式，以符号表示，无需数值代入。",
            "solution": "首先对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 背景是纯I型模式下分层问题的二维有限元法（FEM）分析。\n- 内聚界面为零厚度。\n- 牵引力-分离位移法则由 $t(\\delta) = \\sigma_{c}\\,\\exp(-\\frac{\\delta}{\\delta_{c}})$ 给出，其中法向张开位移 $\\delta \\ge 0$。\n- $\\sigma_{c} > 0$ 是一个材料强度参数（应力）。\n- $\\delta_{c} > 0$ 是一个材料长度尺度参数（长度）。\n- 临界能量释放率或断裂能定义为 $G_{c} \\equiv \\int_{0}^{\\infty} t(\\delta)\\, \\mathrm{d}\\delta$。\n- 一致切向刚度定义为 $k_{t}(\\delta) \\equiv \\mathrm{d}t/\\mathrm{d}\\delta$。\n- 任务是：\n    1. 以 $\\sigma_{c}$ 和 $\\delta_{c}$ 的形式计算 $G_{c}$ 的闭合解。\n    2. 以符号形式确定 $k_{t}(0)$。\n    3. 解释 $\\sigma_{c}$ 和 $\\delta_{c}$ 的不同作用。\n    4. 最终答案必须仅为 $G_{c}$ 的表达式。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学基础**：该问题在科学上是合理的。它描述了一个指数型内聚区模型，这是计算断裂力学中用于模拟材料失效和分层的标准且广泛使用的本构律。断裂能（$G_{c}$）和切向刚度（$k_{t}$）的定义是该领域的基础。\n- **适定性**：该问题是适定的。$t(\\delta)$ 的函数形式定义良好，$G_{c}$ 的积分是收敛的。$k_{t}$ 的导数也定义良好。存在唯一且有意义的解。\n- **客观性**：该问题以精确、客观和标准的科学术语陈述。它没有歧义和主观陈述。\n- **完整性和一致性**：该问题是自洽的，提供了进行所需推导和分析的所有必要信息和定义。没有矛盾之处。\n\n**第3步：结论与行动**\n问题有效。将提供严谨的解答。\n\n第一个任务是计算断裂能 $G_{c}$，其定义为单位面积的分离总功。从给定的定义出发：\n$$\nG_{c} = \\int_{0}^{\\infty} t(\\delta)\\, \\mathrm{d}\\delta\n$$\n我们代入给定的指数型牵引力-分离位移法则 $t(\\delta) = \\sigma_{c}\\,\\exp(-\\frac{\\delta}{\\delta_{c}})$：\n$$\nG_{c} = \\int_{0}^{\\infty} \\sigma_{c}\\,\\exp\\left(-\\frac{\\delta}{\\delta_{c}}\\right)\\, \\mathrm{d}\\delta\n$$\n参数 $\\sigma_{c}$ 相对于积分变量 $\\delta$ 是一个常数，因此可以移到积分号外面：\n$$\nG_{c} = \\sigma_{c} \\int_{0}^{\\infty} \\exp\\left(-\\frac{\\delta}{\\delta_{c}}\\right)\\, \\mathrm{d}\\delta\n$$\n我们现在计算这个瑕积分。$\\exp(-a\\delta)$ 关于 $\\delta$ 的反导数是 $-\\frac{1}{a}\\exp(-a\\delta)$。在我们的例子中，常数 $a = \\frac{1}{\\delta_{c}}$。因此，计算过程如下：\n$$\nG_{c} = \\sigma_{c} \\left[ -\\delta_{c} \\exp\\left(-\\frac{\\delta}{\\delta_{c}}\\right) \\right]_{0}^{\\infty}\n$$\n我们在积分上下限 $\\delta \\to \\infty$ 和 $\\delta = 0$ 处计算表达式的值：\n$$\nG_{c} = \\sigma_{c} \\left( \\lim_{\\delta \\to \\infty} \\left[ -\\delta_{c} \\exp\\left(-\\frac{\\delta}{\\delta_{c}}\\right) \\right] - \\left[ -\\delta_{c} \\exp\\left(-\\frac{0}{\\delta_{c}}\\right) \\right] \\right)\n$$\n当 $\\delta \\to \\infty$ 时，项 $\\exp(-\\frac{\\delta}{\\delta_{c}})$ 趋近于 $0$。当 $\\delta = 0$ 时，项 $\\exp(0)$ 等于 $1$。\n$$\nG_{c} = \\sigma_{c} \\left( 0 - (-\\delta_{c} \\cdot 1) \\right)\n$$\n这化简为断裂能的最终表达式：\n$$\nG_{c} = \\sigma_{c} \\delta_{c}\n$$\n接下来，我们确定初始一致切向刚度 $k_{t}(0)$。刚度定义为牵引力对分离位移的导数：\n$$\nk_{t}(\\delta) = \\frac{\\mathrm{d}t}{\\mathrm{d}\\delta} = \\frac{\\mathrm{d}}{\\mathrm{d}\\delta} \\left[ \\sigma_{c}\\,\\exp\\left(-\\frac{\\delta}{\\delta_{c}}\\right) \\right]\n$$\n应用微分链式法则，我们得到：\n$$\nk_{t}(\\delta) = \\sigma_{c} \\cdot \\exp\\left(-\\frac{\\delta}{\\delta_{c}}\\right) \\cdot \\left(-\\frac{1}{\\delta_{c}}\\right) = -\\frac{\\sigma_{c}}{\\delta_{c}} \\exp\\left(-\\frac{\\delta}{\\delta_{c}}\\right)\n$$\n为了求得初始刚度，我们在 $\\delta = 0$ 处计算该表达式的值：\n$$\nk_{t}(0) = -\\frac{\\sigma_{c}}{\\delta_{c}} \\exp(0) = -\\frac{\\sigma_{c}}{\\delta_{c}}\n$$\n最后，我们解释参数 $\\sigma_{c}$ 和 $\\delta_{c}$ 的物理作用。\n参数 $\\sigma_{c}$ 代表界面的内聚强度。通过计算零分离位移处的牵引力 $t(0) = \\sigma_{c}\\exp(0) = \\sigma_{c}$ 可以明显看出这一点。由于对于所有 $\\delta \\ge 0$，都有 $\\exp(-\\delta/\\delta_{c}) \\le 1$，因此 $t(0)$ 是界面能承受的最大牵引力。因此，$\\sigma_{c}$ 决定了引发失效所需的峰值应力。它的作用是设定功共轭对 $(t, \\delta)$ 中类力物理量的大小。\n\n参数 $\\delta_{c}$ 是一个控制界面软化行为的特征长度尺度。它决定了随着分离位移 $\\delta$ 的增加，牵引力下降的速度。较小的 $\\delta_{c}$ 对应于牵引力的更快衰减，从而导致更脆性的失效模式，这也反映在更负的初始刚度 $k_{t}(0) = -\\sigma_c/\\delta_c$ 上。较大的 $\\delta_{c}$ 意味着较慢的衰减，代表了更具延性或更渐进的失效过程。\n\n根据功的第一性原理，能量是类力物理量对类位移物理量的积分。在这里，单位面积的断裂能 $G_{c}$ 的量纲是 $(\\text{力}/\\text{面积})\\times\\text{长度}$，即 能量/面积。推导出的结果 $G_{c} = \\sigma_{c} \\delta_{c}$ 直接证明了这种关系。断裂能——一种衡量材料韧性的指标——是材料强度（$\\sigma_{c}$）与其特征失效长度尺度（$\\delta_{c}$）的乘积。这种内聚模型框架可作为一种能量正则化方案，用于处理线性弹性断裂力学所预测的应力奇点问题，它用一个由有限强度 $\\sigma_{c}$ 在以 $\\delta_{c}$ 为特征的有限分离范围内作用的、有物理动机的失效过程来代替该奇点。这确保了耗散的能量是有限的且等于 $G_c$。",
            "answer": "$$\\boxed{\\sigma_{c} \\delta_{c}}$$"
        },
        {
            "introduction": "超越简单的唯象曲线，我们可以从更严谨的连续介质损伤力学 (continuum damage mechanics, CDM) 框架出发来构建内聚模型。这种方法将宏观的牵引力-分离位移响应与一个内部损伤变量的演化联系起来，整个过程由一个热力学势（亥姆霍兹自由能）控制。热力学一致性要求分离功必须等于损伤过程所耗散的能量。本练习  要求您为双线性内聚律证明这一致性，通过从两个不同角度——积分损伤驱动力和计算牵引力-分离位移曲线下的面积——推导耗散能，您将对现代内聚模型的热力学基础有更深刻的理解。",
            "id": "3744453",
            "problem": "一个标量 I 型黏性界面通过一个内部损伤变量 $d \\in [0,1]$ 进行建模，该变量会降低刚度，其中 $d=0$ 代表未损伤的界面，$d=1$ 代表完全失效。设分离量为 $\\delta \\ge 0$，牵引力为 $T$。假设单位面积的亥姆霍兹自由能为\n$$\n\\psi(\\delta,d) = (1-d)\\,\\frac{1}{2}\\,k\\,\\delta^{2},\n$$\n其中 $k0$ 是一个恒定的罚刚度。根据标准的热力学共轭关系，牵引力和损伤驱动力（损伤的能量释放率）定义为\n$$\nT = \\frac{\\partial \\psi}{\\partial \\delta}, \\qquad Y = -\\frac{\\partial \\psi}{\\partial d},\n$$\n在每次求导中，保持其他自变量不变。假设通过损伤实现的宏观牵引力-分离量关系是一个双线性（三角形）软化法则，其峰值牵引力为 $\\hat{\\sigma}$（在分离量为 $\\delta_{p}0$ 时达到），并在分离量为 $\\delta_{f}\\delta_{p}$ 时完全脱聚：\n$$\nT_{\\text{tar}}(\\delta) = \n\\begin{cases}\nk\\,\\delta,  0 \\le \\delta \\le \\delta_{p}, \\\\\n\\hat{\\sigma}\\,\\dfrac{\\delta_{f}-\\delta}{\\delta_{f}-\\delta_{p}},  \\delta_{p}  \\delta \\le \\delta_{f}, \\\\\n0,  \\delta > \\delta_{f},\n\\end{cases}\n$$\n其中 $\\hat{\\sigma} = k\\,\\delta_{p}$。在软化分支 $\\delta \\in (\\delta_{p},\\delta_{f}]$ 上，内部变量 $d$ 的演化使得本构牵引力 $T(\\delta,d)$ 等于目标牵引力 $T_{\\text{tar}}(\\delta)$。\n\n从这些定义出发，并且不引用任何未经证明的结果，完成以下任务：\n\n1. 从 $\\psi(\\delta,d)$ 推导出 $T(\\delta,d)$ 和 $Y(\\delta)$。\n2. 在软化分支上，施加 $T(\\delta,d)=T_{\\text{tar}}(\\delta)$ 条件，并消去 $\\delta$，以获得沿失效路径上 $Y$ 作为 $d$ 的显式函数，即对于 $d \\in [0,1]$ 的 $Y=Y(d)$。\n3. 通过损伤功计算完全失效过程中单位面积上耗散的总能量\n$$\nG_{\\text{diss}}=\\int_{0}^{1} Y(d)\\,\\mathrm{d}d.\n$$\n4. 独立地，计算牵引力-分离量曲线下的面积，\n$$\nG_{\\text{area}}=\\int_{0}^{\\delta_{f}} T_{\\text{tar}}(\\delta)\\,\\mathrm{d}\\delta,\n$$\n并证明 $G_{\\text{diss}}=G_{\\text{area}}$。\n5. 使用数值参数 $k=5\\times 10^{12}$（单位 $\\mathrm{N}\\,\\mathrm{m}^{-3}$），$\\delta_{p}=1.8\\times 10^{-6}$（单位 $\\mathrm{m}$）和 $\\delta_{f}=2.3\\times 10^{-5}$（单位 $\\mathrm{m}$）计算该共同值。\n\n将最终的数值能量以 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 单位面积的亥姆霍兹自由能：$\\psi(\\delta,d) = (1-d)\\,\\frac{1}{2}\\,k\\,\\delta^{2}$，其中 $d \\in [0,1]$ 是内部损伤变量，$\\delta \\ge 0$ 是分离量，$k>0$ 是一个恒定的罚刚度。\n- 热力学共轭量：牵引力 $T = \\frac{\\partial \\psi}{\\partial \\delta}$ 和损伤驱动力 $Y = -\\frac{\\partial \\psi}{\\partial d}$。\n- 目标牵引力-分离量关系：\n$$\nT_{\\text{tar}}(\\delta) = \n\\begin{cases}\nk\\,\\delta,  0 \\le \\delta \\le \\delta_{p},\\\\\n\\hat{\\sigma}\\,\\dfrac{\\delta_{f}-\\delta}{\\delta_{f}-\\delta_{p}},  \\delta_{p}  \\delta \\le \\delta_{f},\\\\\n0,  \\delta > \\delta_{f}.\n\\end{cases}\n$$\n- 峰值牵引力定义：$\\hat{\\sigma} = k\\,\\delta_{p}$。\n- 软化分支上的条件：对于 $\\delta \\in (\\delta_{p},\\delta_{f}]$，$T(\\delta,d) = T_{\\text{tar}}(\\delta)$。\n- 数值参数：$k=5\\times 10^{12}\\,\\mathrm{N}\\,\\mathrm{m}^{-3}$，$\\delta_{p}=1.8\\times 10^{-6}\\,\\mathrm{m}$，$\\delta_{f}=2.3\\times 10^{-5}\\,\\mathrm{m}$。\n- 任务：\n  1. 从 $\\psi(\\delta,d)$ 推导出 $T(\\delta,d)$ 和 $Y(\\delta)$。\n  2. 在软化路径上推导出 $Y=Y(d)$。\n  3. 计算耗散能 $G_{\\text{diss}}=\\int_{0}^{1} Y(d)\\,\\mathrm{d}d$。\n  4. 计算曲线下面积 $G_{\\text{area}}=\\int_{0}^{\\delta_{f}} T_{\\text{tar}}(\\delta)\\,\\mathrm{d}\\delta$。\n  5. 证明 $G_{\\text{diss}}=G_{\\text{area}}$ 并计算其数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是连续介质损伤力学和黏性区带模型中的标准提法。其热力学框架（亥姆霍兹自由能，共轭力）是基础性的。该问题是适定的，提供了所有必要的函数、参数和关系以求得唯一解。语言客观而精确。问题是自洽且内部一致的。因此，该问题被认定为有效。\n\n### 步骤 3：结论与行动\n问题有效。将提供解答。\n\n**1. 牵引力和损伤驱动力的推导**\n\n给定单位面积的亥姆霍兹自由能 $\\psi(\\delta,d) = (1-d)\\,\\frac{1}{2}\\,k\\,\\delta^{2}$，我们通过所定义的偏微分来计算牵引力 $T$ 和损伤驱动力 $Y$。\n\n牵引力 $T$ 是 $\\psi$ 对分离量 $\\delta$ 的导数：\n$$\nT(\\delta,d) = \\frac{\\partial \\psi}{\\partial \\delta} = \\frac{\\partial}{\\partial \\delta}\\left[(1-d)\\,\\frac{1}{2}\\,k\\,\\delta^{2}\\right] = (1-d)\\,k\\,\\delta.\n$$\n损伤驱动力 $Y$ 是 $\\psi$ 对损伤 $d$ 的导数的相反数：\n$$\nY(\\delta) = -\\frac{\\partial \\psi}{\\partial d} = -\\frac{\\partial}{\\partial d}\\left[(1-d)\\,\\frac{1}{2}\\,k\\,\\delta^{2}\\right] = -\\left(-\\frac{1}{2}\\,k\\,\\delta^{2}\\right) = \\frac{1}{2}\\,k\\,\\delta^{2}.\n$$\n注意，$Y$ 是 $\\delta$ 的显式函数，但不是 $d$ 的显式函数。\n\n**2. 损伤驱动力作为损伤的函数**\n\n在软化分支上，其中 $\\delta \\in (\\delta_{p}, \\delta_{f}]$，损伤的演化使得本构牵引力与目标牵引力相匹配：$T(\\delta,d)=T_{\\text{tar}}(\\delta)$。\n$$\n(1-d)\\,k\\,\\delta = \\hat{\\sigma}\\,\\frac{\\delta_{f}-\\delta}{\\delta_{f}-\\delta_{p}}.\n$$\n代入给定关系 $\\hat{\\sigma} = k\\,\\delta_{p}$：\n$$\n(1-d)\\,k\\,\\delta = k\\,\\delta_{p}\\,\\frac{\\delta_{f}-\\delta}{\\delta_{f}-\\delta_{p}}.\n$$\n由于 $\\delta > \\delta_p > 0$ 且 $k>0$，我们可以除以 $k$：\n$$\n(1-d)\\,\\delta = \\delta_{p}\\,\\frac{\\delta_{f}-\\delta}{\\delta_{f}-\\delta_{p}}.\n$$\n为了求出作为 $d$ 的函数的 $Y$，我们必须首先将 $\\delta$ 表示为 $d$ 的函数。我们重排方程以解出 $\\delta$：\n$$\n(1-d)\\,\\delta\\,(\\delta_{f}-\\delta_{p}) = \\delta_{p}\\,(\\delta_{f}-\\delta)\n$$\n$$\n(1-d)\\,\\delta\\,\\delta_{f} - (1-d)\\,\\delta\\,\\delta_{p} = \\delta_{p}\\,\\delta_{f} - \\delta_{p}\\,\\delta\n$$\n$$\n\\delta \\left[ (1-d)\\,\\delta_{f} - (1-d)\\,\\delta_{p} + \\delta_{p} \\right] = \\delta_{p}\\,\\delta_{f}\n$$\n$$\n\\delta \\left[ (1-d)\\,\\delta_{f} - \\delta_{p} + d\\,\\delta_{p} + \\delta_{p} \\right] = \\delta_{p}\\,\\delta_{f}\n$$\n$$\n\\delta \\left[ (1-d)\\,\\delta_{f} + d\\,\\delta_{p} \\right] = \\delta_{p}\\,\\delta_{f}\n$$\n$$\n\\delta(d) = \\frac{\\delta_{p}\\,\\delta_{f}}{(1-d)\\,\\delta_{f} + d\\,\\delta_{p}}.\n$$\n损伤过程随着 $\\delta$ 从 $\\delta_p$ 增加到 $\\delta_f$ 而发生。在 $\\delta=\\delta_p$ 时，牵引力为 $T = k\\delta_p = (1-d)k\\delta_p$，这意味着 $d=0$。在 $\\delta=\\delta_f$ 时，牵引力为 $T=0=(1-d)k\\delta_f$，这意味着 $d=1$。因此，沿此路径，损伤变量 $d$ 的范围是 $[0,1]$。\n\n将 $\\delta(d)$ 代入 $Y$ 的表达式中：\n$$\nY(d) = \\frac{1}{2}\\,k\\,\\left[\\delta(d)\\right]^{2} = \\frac{1}{2}\\,k\\,\\left( \\frac{\\delta_{p}\\,\\delta_{f}}{(1-d)\\,\\delta_{f} + d\\,\\delta_{p}} \\right)^2.\n$$\n\n**3. 总耗散能的计算**\n\n单位面积的总耗散能 $G_{\\text{diss}}$ 是损伤驱动力 $Y(d)$ 在从 $d=0$ 到 $d=1$ 的整个损伤过程中的积分：\n$$\nG_{\\text{diss}} = \\int_{0}^{1} Y(d)\\,\\mathrm{d}d = \\int_{0}^{1} \\frac{1}{2}\\,k\\,\\frac{(\\delta_{p}\\,\\delta_{f})^2}{((1-d)\\,\\delta_{f} + d\\,\\delta_{p})^2}\\,\\mathrm{d}d.\n$$\n为了计算这个积分，我们使用换元法。令 $u = (1-d)\\,\\delta_{f} + d\\,\\delta_{p} = \\delta_{f} + d(\\delta_{p}-\\delta_{f})$。微分为 $\\mathrm{d}u = (\\delta_{p}-\\delta_{f})\\,\\mathrm{d}d$。积分上下限对于 $d$ 是从 $d=0$ 到 $d=1$，对于 $u$ 则是从 $u=\\delta_{f}$ 到 $u=\\delta_{p}$。\n$$\nG_{\\text{diss}} = \\frac{1}{2}\\,k\\,(\\delta_{p}\\,\\delta_{f})^2 \\int_{\\delta_{f}}^{\\delta_{p}} \\frac{1}{u^2}\\,\\frac{\\mathrm{d}u}{\\delta_{p}-\\delta_{f}}\n$$\n$$\nG_{\\text{diss}} = \\frac{k\\,(\\delta_{p}\\,\\delta_{f})^2}{2(\\delta_{p}-\\delta_{f})} \\int_{\\delta_{f}}^{\\delta_{p}} u^{-2}\\,\\mathrm{d}u = \\frac{k\\,(\\delta_{p}\\,\\delta_{f})^2}{2(\\delta_{p}-\\delta_{f})} \\left[ -\\frac{1}{u} \\right]_{\\delta_{f}}^{\\delta_{p}}\n$$\n$$\nG_{\\text{diss}} = \\frac{k\\,(\\delta_{p}\\,\\delta_{f})^2}{2(\\delta_{p}-\\delta_{f})} \\left( -\\frac{1}{\\delta_{p}} - \\left(-\\frac{1}{\\delta_{f}}\\right) \\right) = \\frac{k\\,(\\delta_{p}\\,\\delta_{f})^2}{2(\\delta_{p}-\\delta_{f})} \\left( \\frac{1}{\\delta_{f}} - \\frac{1}{\\delta_{p}} \\right)\n$$\n$$\nG_{\\text{diss}} = \\frac{k\\,(\\delta_{p}\\,\\delta_{f})^2}{2(\\delta_{p}-\\delta_{f})} \\left( \\frac{\\delta_{p}-\\delta_{f}}{\\delta_{p}\\,\\delta_{f}} \\right)\n$$\n消去项 $(\\delta_{p}-\\delta_{f})$ 以及一个因子 $\\delta_{p}\\,\\delta_{f}$：\n$$\nG_{\\text{diss}} = \\frac{1}{2}\\,k\\,\\delta_{p}\\,\\delta_{f}.\n$$\n\n**4. 牵引力-分离量曲线下面积的计算**\n\n单位面积能量 $G_{\\text{area}}$ 通过对目标牵引力-分离量关系 $T_{\\text{tar}}(\\delta)$ 从 $\\delta=0$ 到 $\\delta=\\delta_f$ 积分计算得出。该积分必须分为两部分：从 $0$ 到 $\\delta_p$ 的线弹性加载部分，以及从 $\\delta_p$ 到 $\\delta_f$ 的线性软化部分。\n$$\nG_{\\text{area}} = \\int_{0}^{\\delta_{f}} T_{\\text{tar}}(\\delta)\\,\\mathrm{d}\\delta = \\int_{0}^{\\delta_{p}} k\\,\\delta\\,\\mathrm{d}\\delta + \\int_{\\delta_{p}}^{\\delta_{f}} \\hat{\\sigma}\\,\\frac{\\delta_{f}-\\delta}{\\delta_{f}-\\delta_{p}}\\,\\mathrm{d}\\delta.\n$$\n第一个积分（第一个三角形的面积）是：\n$$\n\\int_{0}^{\\delta_{p}} k\\,\\delta\\,\\mathrm{d}\\delta = \\left[\\frac{1}{2}\\,k\\,\\delta^2\\right]_{0}^{\\delta_{p}} = \\frac{1}{2}\\,k\\,\\delta_{p}^2.\n$$\n第二个积分（第二个三角形的面积）是：\n$$\n\\int_{\\delta_{p}}^{\\delta_{f}} \\hat{\\sigma}\\,\\frac{\\delta_{f}-\\delta}{\\delta_{f}-\\delta_{p}}\\,\\mathrm{d}\\delta = \\frac{\\hat{\\sigma}}{\\delta_{f}-\\delta_{p}} \\left[\\delta_{f}\\delta - \\frac{1}{2}\\delta^2\\right]_{\\delta_{p}}^{\\delta_{f}}\n$$\n$$\n= \\frac{\\hat{\\sigma}}{\\delta_{f}-\\delta_{p}} \\left[ \\left(\\delta_{f}^2 - \\frac{1}{2}\\delta_{f}^2\\right) - \\left(\\delta_{f}\\delta_{p} - \\frac{1}{2}\\delta_{p}^2\\right) \\right]\n$$\n$$\n= \\frac{\\hat{\\sigma}}{\\delta_{f}-\\delta_{p}} \\left[ \\frac{1}{2}\\delta_{f}^2 - \\delta_{f}\\delta_{p} + \\frac{1}{2}\\delta_{p}^2 \\right] = \\frac{\\hat{\\sigma}}{\\delta_{f}-\\delta_{p}} \\left[ \\frac{1}{2}(\\delta_{f}-\\delta_{p})^2 \\right] = \\frac{1}{2}\\,\\hat{\\sigma}\\,(\\delta_{f}-\\delta_{p}).\n$$\n总面积是两部分之和：\n$$\nG_{\\text{area}} = \\frac{1}{2}\\,k\\,\\delta_{p}^2 + \\frac{1}{2}\\,\\hat{\\sigma}\\,(\\delta_{f}-\\delta_{p}).\n$$\n使用 $\\hat{\\sigma} = k\\,\\delta_{p}$：\n$$\nG_{\\text{area}} = \\frac{1}{2}\\,\\hat{\\sigma}\\,\\delta_{p} + \\frac{1}{2}\\,\\hat{\\sigma}\\,(\\delta_{f}-\\delta_{p}) = \\frac{1}{2}\\,\\hat{\\sigma}\\,(\\delta_{p} + \\delta_{f} - \\delta_{p}) = \\frac{1}{2}\\,\\hat{\\sigma}\\,\\delta_{f}.\n$$\n将 $\\hat{\\sigma} = k\\,\\delta_{p}$ 代入此结果：\n$$\nG_{\\text{area}} = \\frac{1}{2}\\,k\\,\\delta_{p}\\,\\delta_{f}.\n$$\n将此结果与步骤3的结果进行比较，我们成功证明了 $G_{\\text{diss}} = G_{\\text{area}}$。这一等式证实了模型的热力学一致性，即内部损伤过程耗散的能量恰好等于分离功（断裂能）。\n\n**5. 数值计算**\n\n能量的共同值为 $G = \\frac{1}{2}\\,k\\,\\delta_{p}\\,\\delta_{f}$。我们代入给定的数值：\n$k=5\\times 10^{12}\\,\\mathrm{N}\\,\\mathrm{m}^{-3}$\n$\\delta_{p}=1.8\\times 10^{-6}\\,\\mathrm{m}$\n$\\delta_{f}=2.3\\times 10^{-5}\\,\\mathrm{m}$\n\n$$\nG = \\frac{1}{2} \\times (5 \\times 10^{12}\\,\\mathrm{N}\\,\\mathrm{m}^{-3}) \\times (1.8 \\times 10^{-6}\\,\\mathrm{m}) \\times (2.3 \\times 10^{-5}\\,\\mathrm{m})\n$$\n$$\nG = \\frac{1}{2} \\times 5 \\times 1.8 \\times 2.3 \\times 10^{12-6-5} \\, \\mathrm{N}\\,\\mathrm{m}^{-1}\n$$\n$$\nG = (2.5 \\times 1.8 \\times 2.3) \\times 10^{1} \\, \\mathrm{J}\\,\\mathrm{m}^{-2} \\quad (\\text{因为 } 1\\,\\mathrm{N}\\,\\mathrm{m}^{-1} = 1\\,\\mathrm{J}\\,\\mathrm{m}^{-2})\n$$\n$$\nG = (4.5 \\times 2.3) \\times 10^{1} \\, \\mathrm{J}\\,\\mathrm{m}^{-2}\n$$\n$$\nG = 10.35 \\times 10^{1} \\, \\mathrm{J}\\,\\mathrm{m}^{-2}\n$$\n$$\nG = 103.5 \\, \\mathrm{J}\\,\\mathrm{m}^{-2}\n$$\n结果为 $103.5$，已满足四位有效数字的要求。",
            "answer": "$$\n\\boxed{103.5}\n$$"
        },
        {
            "introduction": "为了在模拟中使用内聚模型，我们必须将连续的本构方程转化为离散的数值算法。对于率无关的关联模型，这通常通过“弹性预测-非弹性修正”格式来完成，该格式在数学上与计算塑性力学中使用的算法相似。这个高级练习  将引导您推导矢量形式内聚律的“径向回归”算法。通过实施该算法并证明其与经典塑性更新的等效性，您将掌握一种核心的计算技术，并理解在基本本构层面上断裂与塑性理论之间的深刻联系。",
            "id": "3744443",
            "problem": "考虑一个维度为 $m$ 的向量形式的、相关的、率无关的内聚区模型，其中分离跳跃为 $\\boldsymbol{\\delta} \\in \\mathbb{R}^m$，内禀非弹性（滑移）分离为 $\\boldsymbol{q} \\in \\mathbb{R}^m$，面力为 $\\boldsymbol{t} \\in \\mathbb{R}^m$。假设各向同性罚刚度为 $\\mathbf{K} = k \\mathbf{I}$ (其中 $k  0$)，储存自由能为\n$$\n\\psi(\\boldsymbol{\\delta},\\boldsymbol{q}) = \\tfrac{1}{2} (\\boldsymbol{\\delta}-\\boldsymbol{q})^{\\top} \\mathbf{K} (\\boldsymbol{\\delta}-\\boldsymbol{q}) = \\tfrac{1}{2} k \\lVert \\boldsymbol{\\delta} - \\boldsymbol{q} \\rVert^2,\n$$\n热力学面力为 $\\boldsymbol{t} = \\partial \\psi / \\partial \\boldsymbol{\\delta} = k(\\boldsymbol{\\delta}-\\boldsymbol{q})$，以及一个类屈服起始函数\n$$\nf(\\boldsymbol{t}) = \\lVert \\boldsymbol{t} \\rVert - \\sigma_c \\le 0,\n$$\n其中内聚强度为 $\\sigma_c  0$。令耗散是率无关和相关的，其流动法则由 Karush-Kuhn-Tucker (KKT) 条件和法向性所支配：\n$$\n\\dot{\\boldsymbol{q}} = \\lambda \\, \\frac{\\partial f}{\\partial \\boldsymbol{t}} = \\lambda \\, \\frac{\\boldsymbol{t}}{\\lVert \\boldsymbol{t} \\rVert}, \\quad \\lambda \\ge 0, \\quad f(\\boldsymbol{t}) \\le 0, \\quad \\lambda f(\\boldsymbol{t}) = 0.\n$$\n您的任务是：\n\n1) 从这些原理和定义出发，推导一个从时间步 $n$到 $n+1$ 的类返回映射更新，该更新在给定 $(\\boldsymbol{\\delta}_{n+1}, \\boldsymbol{q}_n)$ 的情况下，计算出具有以下结构的 $(\\boldsymbol{t}_{n+1}, \\boldsymbol{q}_{n+1}, \\Delta \\lambda)$：\n- 一个弹性预测量 $\\boldsymbol{t}^{\\text{tr}} = k(\\boldsymbol{\\delta}_{n+1} - \\boldsymbol{q}_n)$ 和一个试探屈服值 $f^{\\text{tr}} = \\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert - \\sigma_c$。\n- 一个检查：如果 $f^{\\text{tr}} \\le 0$，则 $\\boldsymbol{t}_{n+1} = \\boldsymbol{t}^{\\text{tr}}$，$\\boldsymbol{q}_{n+1} = \\boldsymbol{q}_n$，$\\Delta \\lambda = 0$（弹性）。\n- 否则，进行类塑性修正，使得更新后的面力位于曲面 $f(\\boldsymbol{t}_{n+1}) = 0$ 上，且流动方向与 $f$ 正交，从而得到 $\\Delta \\lambda$ 的闭式解，并具有类似于径向返回的方向性特性：$\\boldsymbol{t}_{n+1}$ 与 $\\boldsymbol{t}^{\\text{tr}}$ 共线。\n\n2) 通过显式推导证明，对于各向同性 $\\mathbf{K} = k \\mathbf{I}$ 和指定的 $f$，当进行如下映射时：$\\boldsymbol{\\delta} \\leftrightarrow$ 类应变向量，$\\boldsymbol{q} \\leftrightarrow$ 类塑性应变向量，以及 $\\boldsymbol{t} \\leftrightarrow$ 类应力向量，其中 $k$ 作为标量弹性模量，$\\sigma_c$ 作为屈服半径，非弹性修正与基于范数的理想弹塑性更新（例如向量代理模型中的偏应力第二不变量 (J2) 模型）中所使用的经典径向返回算法一致。总结出用 $(k, \\sigma_c, \\boldsymbol{\\delta}_{n+1}, \\boldsymbol{q}_n)$ 表示的 $(\\boldsymbol{t}_{n+1}, \\boldsymbol{q}_{n+1}, \\Delta \\lambda)$ 的显式公式。\n\n3) 实现一个程序，为下述每个测试用例计算以下两项内容：\n- 使用您推导的类返回映射算法计算的内聚更新 $(\\boldsymbol{t}_{n+1}^{\\text{coh}}, \\boldsymbol{q}_{n+1}^{\\text{coh}}, \\Delta \\lambda^{\\text{coh}})$，以及\n- 一个由相同方程定义但被解释为具有相同参数 $(k,\\sigma_c)$ 的应力-应变模型的抽象塑性径向返回 $(\\boldsymbol{s}_{n+1}^{\\text{plas}}, \\boldsymbol{\\varepsilon}_{n+1}^{p,\\text{plas}}, \\Delta \\gamma^{\\text{plas}})$。\n\n通过验证每个测试中 $\\boldsymbol{t}_{n+1}^{\\text{coh}}$ 等于 $\\boldsymbol{s}_{n+1}^{\\text{plas}}$，$\\boldsymbol{q}_{n+1}^{\\text{coh}}$ 等于 $\\boldsymbol{\\varepsilon}_{n+1}^{p,\\text{plas}}$，以及 $\\Delta \\lambda^{\\text{coh}}$ 等于 $\\Delta \\gamma^{\\text{plas}}$ (在指定的绝对容差 $\\tau = 10^{-10}$ 内)，来证明其等价性。\n\n所有量均为无量纲，因此不需要物理单位。不涉及角度。不涉及百分比。\n\n使用 $m = 2$ 和以下测试套件，公共参数为 $k = 1000$ 和 $\\sigma_c = 5$：\n- 测试 1：$\\boldsymbol{\\delta}_{n+1} = [0.01, 0.0]$, $\\boldsymbol{q}_n = [0.0, 0.0]$。\n- 测试 2：$\\boldsymbol{\\delta}_{n+1} = [0.003, 0.002]$, $\\boldsymbol{q}_n = [0.0, 0.0]$。\n- 测试 3：$\\boldsymbol{\\delta}_{n+1} = [0.005, 0.0]$, $\\boldsymbol{q}_n = [0.0, 0.0]$。\n- 测试 4：$\\boldsymbol{\\delta}_{n+1} = [0.0, 0.0]$, $\\boldsymbol{q}_n = [-0.006, 0.0]$。\n- 测试 5：$\\boldsymbol{\\delta}_{n+1} = [0.002, -0.002]$, $\\boldsymbol{q}_n = [0.002, -0.002]$。\n- 测试 6：$\\boldsymbol{\\delta}_{n+1} = [0.02, 0.03]$, $\\boldsymbol{q}_n = [0.001, -0.002]$。\n\n对于每个测试，让程序计算三个布尔检查：\n- $b_t$: $\\boldsymbol{t}_{n+1}^{\\text{coh}}$ 是否在 $\\tau$ 范围内等于 $\\boldsymbol{s}_{n+1}^{\\text{plas}}$。\n- $b_q$: $\\boldsymbol{q}_{n+1}^{\\text{coh}}$ 是否在 $\\tau$ 范围内等于 $\\boldsymbol{\\varepsilon}_{n+1}^{p,\\text{plas}}$。\n- $b_\\lambda$: $\\Delta \\lambda^{\\text{coh}}$ 是否在 $\\tau$ 范围内等于 $\\Delta \\gamma^{\\text{plas}}$。\n\n将它们聚合成每个测试的单个布尔值 $b_{\\text{test}} = b_t \\wedge b_q \\wedge b_\\lambda$。\n\n最终输出格式：您的程序应生成一行输出，其中包含测试 1 到 6 的 $b_{\\text{test}}$ 列表，格式为用方括号括起来的逗号分隔列表，例如 \"[True,False,True,True,True,False]\"。",
            "solution": "该问题要求对一个率无关、相关的内聚区模型（CZM）推导、分析并实现一个返回映射算法。推导将基于所给定的第一性原理进行，并证明其与塑性力学中经典径向返回算法的等价性。\n\n**1. 内聚更新算法的推导**\n\n内聚模型的控制方程已经给出。我们考虑从时间 $t_n$ 到 $t_{n+1}$ 的一个离散时间步。需要确定的量是状态变量 $(\\boldsymbol{t}_{n+1}, \\boldsymbol{q}_{n+1})$ 和积分塑性乘子 $\\Delta \\lambda$，而已知量为第 $n$ 步的状态（特别是 $\\boldsymbol{q}_n$）和第 $n+1$ 步给定的分离 $\\boldsymbol{\\delta}_{n+1}$。\n\n内部变量 $\\boldsymbol{q}$ 的演化由流动法则 $\\dot{\\boldsymbol{q}} = \\lambda \\, \\partial f / \\partial \\boldsymbol{t}$ 控制。我们采用隐式后向欧拉时间积分格式，该格式因其无条件稳定性而成为求解率无关问题的标准方法。离散化的流动法则是：\n$$\n\\boldsymbol{q}_{n+1} - \\boldsymbol{q}_n = \\Delta \\lambda \\, \\left. \\frac{\\partial f}{\\partial \\boldsymbol{t}} \\right|_{n+1}\n$$\n其中 $\\Delta\\lambda = \\int_{t_n}^{t_{n+1}} \\lambda(t') dt'$。对于给定的屈服函数 $f(\\boldsymbol{t}) = \\lVert \\boldsymbol{t} \\rVert - \\sigma_c$，其梯度为 $\\partial f / \\partial \\boldsymbol{t} = \\boldsymbol{t} / \\lVert \\boldsymbol{t} \\rVert$。在第 $n+1$ 步需要求解的方程组由离散的 KKT 条件组成：\n$$\n\\begin{align}\n\\boldsymbol{t}_{n+1} = k(\\boldsymbol{\\delta}_{n+1} - \\boldsymbol{q}_{n+1}) \\quad \\text{(本构关系)} \\\\\n\\boldsymbol{q}_{n+1} = \\boldsymbol{q}_n + \\Delta \\lambda \\frac{\\boldsymbol{t}_{n+1}}{\\lVert \\boldsymbol{t}_{n+1} \\rVert} \\quad \\text{(流动法则)} \\\\\nf(\\boldsymbol{t}_{n+1}) = \\lVert \\boldsymbol{t}_{n+1} \\rVert - \\sigma_c \\le 0 \\quad \\text{(容许性)} \\\\\n\\Delta \\lambda \\ge 0 \\quad \\text{(不可逆性)} \\\\\n\\Delta \\lambda \\, f(\\boldsymbol{t}_{n+1}) = 0 \\quad \\text{(互补性)}\n\\end{align}\n$$\n该系统使用弹性预测-修正格式进行求解。\n\n**弹性预测步：**\n我们首先假设该步是纯弹性的，这对应于内部变量没有演化，即 $\\Delta \\lambda = 0$。这会产生一个试探状态。\n试探内部变量被冻结：$\\boldsymbol{q}^{\\text{tr}} = \\boldsymbol{q}_n$。\n然后使用本构关系计算试探面力 $\\boldsymbol{t}^{\\text{tr}}$：\n$$\n\\boldsymbol{t}^{\\text{tr}} = k(\\boldsymbol{\\delta}_{n+1} - \\boldsymbol{q}_n)\n$$\n接着，我们通过计算屈服函数来检查这个试探面力是否位于弹性域内部或其边界上：\n$$\nf^{\\text{tr}} = f(\\boldsymbol{t}^{\\text{tr}}) = \\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert - \\sigma_c\n$$\n\n**情况 A：弹性更新**\n如果 $f^{\\text{tr}} \\le 0$，则试探状态是容许的。弹性假设成立，不需要修正。更新后的状态即为试探状态：\n$$\n\\boldsymbol{t}_{n+1} = \\boldsymbol{t}^{\\text{tr}} \\\\\n\\boldsymbol{q}_{n+1} = \\boldsymbol{q}_n \\\\\n\\Delta \\lambda = 0\n$$\n这些值满足所有的 KKT 条件。\n\n**情况 B：非弹性修正步**\n如果 $f^{\\text{tr}}  0$，则试探状态是不可容许的，违反了屈服条件。弹性假设是错误的，这意味着必须发生非弹性滑移，因此 $\\Delta \\lambda  0$。互补条件 $\\Delta \\lambda f(\\boldsymbol{t}_{n+1}) = 0$ 于是规定了最终状态必须位于屈服面上，即 $f(\\boldsymbol{t}_{n+1}) = 0$。这是一致性条件：\n$$\n\\lVert \\boldsymbol{t}_{n+1} \\rVert = \\sigma_c\n$$\n为了找到修正后的状态，我们将流动法则代入本构关系中：\n$$\n\\boldsymbol{t}_{n+1} = k \\left( \\boldsymbol{\\delta}_{n+1} - \\left( \\boldsymbol{q}_n + \\Delta \\lambda \\frac{\\boldsymbol{t}_{n+1}}{\\lVert \\boldsymbol{t}_{n+1} \\rVert} \\right) \\right)\n$$\n整理并识别出试探面力 $\\boldsymbol{t}^{\\text{tr}} = k(\\boldsymbol{\\delta}_{n+1} - \\boldsymbol{q}_n)$，并使用一致性条件 $\\lVert \\boldsymbol{t}_{n+1} \\rVert = \\sigma_c$，我们得到：\n$$\n\\boldsymbol{t}_{n+1} = \\boldsymbol{t}^{\\text{tr}} - k \\frac{\\Delta \\lambda}{\\sigma_c} \\boldsymbol{t}_{n+1}\n$$\n解出 $\\boldsymbol{t}_{n+1}$：\n$$\n\\boldsymbol{t}_{n+1} \\left( 1 + \\frac{k \\Delta \\lambda}{\\sigma_c} \\right) = \\boldsymbol{t}^{\\text{tr}} \\implies \\boldsymbol{t}_{n+1} = \\frac{1}{1 + k \\Delta \\lambda / \\sigma_c} \\boldsymbol{t}^{\\text{tr}}\n$$\n此方程揭示了一个关键属性：更新后的面力向量 $\\boldsymbol{t}_{n+1}$ 与试探面力向量 $\\boldsymbol{t}^{\\text{tr}}$ 共线。这意味着它们共享相同的单位方向向量：\n$$\n\\frac{\\boldsymbol{t}_{n+1}}{\\lVert \\boldsymbol{t}_{n+1} \\rVert} = \\frac{\\boldsymbol{t}^{\\text{tr}}}{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert}\n$$\n现在我们可以通过对 $\\boldsymbol{t}_{n+1}$ 的表达式取欧几里得范数来求解未知数 $\\Delta \\lambda$：\n$$\n\\lVert \\boldsymbol{t}_{n+1} \\rVert = \\frac{1}{1 + k \\Delta \\lambda / \\sigma_c} \\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert\n$$\n代入 $\\lVert \\boldsymbol{t}_{n+1} \\rVert = \\sigma_c$：\n$$\n\\sigma_c = \\frac{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert}{1 + k \\Delta \\lambda / \\sigma_c}\n$$\n整理以解出 $\\Delta \\lambda$：\n$$\n1 + \\frac{k \\Delta \\lambda}{\\sigma_c} = \\frac{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert}{\\sigma_c} \\implies \\frac{k \\Delta \\lambda}{\\sigma_c} = \\frac{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert - \\sigma_c}{\\sigma_c}\n$$\n这得出了关于一致性参数的闭式表达式：\n$$\n\\Delta \\lambda = \\frac{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert - \\sigma_c}{k} = \\frac{f^{\\text{tr}}}{k}\n$$\n由于这种情况对应于 $f^{\\text{tr}}  0$，我们有 $\\Delta \\lambda  0$，这与 KKT 条件一致。\n\n在确定了 $\\Delta \\lambda$ 后，最终更新的状态变量为：\n$$\n\\begin{align}\n\\boldsymbol{t}_{n+1} = \\sigma_c \\frac{\\boldsymbol{t}^{\\text{tr}}}{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert} \\\\\n\\boldsymbol{q}_{n+1} = \\boldsymbol{q}_n + \\Delta \\lambda \\frac{\\boldsymbol{t}_{n+1}}{\\lVert \\boldsymbol{t}_{n+1} \\rVert} = \\boldsymbol{q}_n + \\Delta \\lambda \\frac{\\boldsymbol{t}^{\\text{tr}}}{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert} \\\\\n= \\boldsymbol{q}_n + \\frac{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert - \\sigma_c}{k} \\frac{\\boldsymbol{t}^{\\text{tr}}}{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert}\n\\end{align}\n$$\n$\\boldsymbol{t}_{n+1}$ 的更新是将 $\\boldsymbol{t}^{\\text{tr}}$ 沿径向投影回屈服面上，因此得名“径向返回”。\n\n**2. 与塑性力学径向返回算法的等价性**\n\n问题要求证明该算法在数学上与一个简单的向量值理想弹塑性模型的经典径向返回方法完全相同。让我们通过映射变量来建立这种类比关系：\n- 内聚面力 $\\boldsymbol{t} \\leftrightarrow$ 类应力向量 $\\boldsymbol{s}$\n- 内聚分离 $\\boldsymbol{\\delta} \\leftrightarrow$ 类应变向量 $\\boldsymbol{\\varepsilon}$\n- 内聚内部变量 $\\boldsymbol{q} \\leftrightarrow$ 类塑性应变向量 $\\boldsymbol{\\varepsilon}^p$\n- 罚刚度 $k \\leftrightarrow$ 弹性模量 $E$\n- 内聚强度 $\\sigma_c \\leftrightarrow$ 屈服强度 $\\sigma_Y$\n\n塑性模型的方程组是：\n- 应变加法分解：$\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p$\n- 线性弹性定律：$\\boldsymbol{s} = E \\boldsymbol{\\varepsilon}^e = E(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^p)$\n- 屈服函数：$g(\\boldsymbol{s}) = \\lVert \\boldsymbol{s} \\rVert - \\sigma_Y \\le 0$\n- 相关联流动法则：$\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\gamma} \\frac{\\partial g}{\\partial \\boldsymbol{s}} = \\dot{\\gamma} \\frac{\\boldsymbol{s}}{\\lVert \\boldsymbol{s} \\rVert}$\n- KKT 条件：$\\dot{\\gamma} \\ge 0$, $g(\\boldsymbol{s}) \\le 0$, $\\dot{\\gamma} g(\\boldsymbol{s}) = 0$\n\n遵循完全相同的推导逻辑（后向欧拉离散化、弹性预测、塑性修正）：\n- 试探应力：$\\boldsymbol{s}^{\\text{tr}} = E(\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_n)$\n- 试探屈服值：$g^{\\text{tr}} = \\lVert \\boldsymbol{s}^{\\text{tr}} \\rVert - \\sigma_Y$\n- 如果 $g^{\\text{tr}}  0$，塑性修正得到：\n  - 塑性一致性参数：$\\Delta \\gamma = \\frac{\\lVert \\boldsymbol{s}^{\\text{tr}} \\rVert - \\sigma_Y}{E}$\n  - 更新后的应力：$\\boldsymbol{s}_{n+1} = \\sigma_Y \\frac{\\boldsymbol{s}^{\\text{tr}}}{\\lVert \\boldsymbol{s}^{\\text{tr}} \\rVert}$\n  - 更新后的塑性应变：$\\boldsymbol{\\varepsilon}^p_{n+1} = \\boldsymbol{\\varepsilon}^p_n + \\Delta \\gamma \\frac{\\boldsymbol{s}^{\\text{tr}}}{\\lVert \\boldsymbol{s}^{\\text{tr}} \\rVert}$\n\n通过直接比较并应用变量映射，内聚模型的更新方程 $(\\boldsymbol{t}_{n+1}, \\boldsymbol{q}_{n+1}, \\Delta \\lambda)$ 与塑性模型的更新方程 $(\\boldsymbol{s}_{n+1}, \\boldsymbol{\\varepsilon}^p_{n+1}, \\Delta \\gamma)$ 在形式上是完全相同的。此推导明确地证实了这种等价性。\n\n**3. 数值算法总结**\n\n对于一个给定的测试用例，其参数为 $(k, \\sigma_c)$，状态为 $(\\boldsymbol{\\delta}_{n+1}, \\boldsymbol{q}_n)$，更新按以下步骤计算：\n1. 计算试探面力：$\\boldsymbol{t}^{\\text{tr}} = k(\\boldsymbol{\\delta}_{n+1} - \\boldsymbol{q}_n)$。\n2. 计算试探面力的范数：$\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert$。\n3. 如果 $\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert \\le \\sigma_c$：\n    - 该步为弹性步。\n    - $\\boldsymbol{t}_{n+1} = \\boldsymbol{t}^{\\text{tr}}$。\n    - $\\boldsymbol{q}_{n+1} = \\boldsymbol{q}_n$。\n    - $\\Delta \\lambda = 0$。\n4. 如果 $\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert  \\sigma_c$：\n    - 该步为非弹性步。\n    - 计算乘子增量：$\\Delta \\lambda = (\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert - \\sigma_c) / k$。\n    - 通过径向返回计算更新后的面力：$\\boldsymbol{t}_{n+1} = \\sigma_c \\frac{\\boldsymbol{t}^{\\text{tr}}}{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert}$。\n    - 计算更新后的内部变量：$\\boldsymbol{q}_{n+1} = \\boldsymbol{q}_n + \\Delta \\lambda \\frac{\\boldsymbol{t}^{\\text{tr}}}{\\lVert \\boldsymbol{t}^{\\text{tr}} \\rVert}$。\n5. 返回 $(\\boldsymbol{t}_{n+1}, \\boldsymbol{q}_{n+1}, \\Delta \\lambda)$。\n\n将实现此算法以运行指定的测试用例，并验证上述的形式等价性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef radial_return(delta_np1: np.ndarray, q_n: np.ndarray, k: float, sigma_c: float):\n    \"\"\"\n    Computes the updated state for a rate-independent, associative cohesive law\n    using a radial return algorithm. The same algorithm applies to a simple\n    elastic-perfectly plastic model under a variable mapping.\n\n    Args:\n        delta_np1 (np.ndarray): The separation vector at step n+1. (Maps to total strain)\n        q_n (np.ndarray): The internal variable vector at step n. (Maps to plastic strain)\n        k (float): The penalty stiffness. (Maps to elastic modulus)\n        sigma_c (float): The cohesive strength. (Maps to yield strength)\n\n    Returns:\n        tuple[np.ndarray, np.ndarray, float]: A tuple containing:\n            - t_np1 (np.ndarray): Updated traction vector at n+1. (Maps to stress)\n            - q_np1 (np.ndarray): Updated internal variable at n+1. (Maps to plastic strain)\n            - delta_lambda (float): Increment of the consistency parameter. (Maps to plastic multiplier)\n    \"\"\"\n    # 1. Elastic predictor step\n    # Compute trial traction (or trial stress)\n    t_tr = k * (delta_np1 - q_n)\n\n    # Compute norm of trial traction\n    norm_t_tr = np.linalg.norm(t_tr)\n\n    # 2. Check yield condition\n    f_tr = norm_t_tr - sigma_c\n\n    if f_tr = 0:\n        # Case A: Elastic step (or on yield surface without loading)\n        t_np1 = t_tr\n        q_np1 = q_n\n        delta_lambda = 0.0\n    else:\n        # Case B: Inelastic/Plastic step\n        # Compute the consistency parameter (plastic multiplier)\n        delta_lambda = f_tr / k\n\n        # The direction of return is given by the trial traction.\n        # Handle the theoretical case of norm_t_tr being zero, although unreachable if f_tr > 0.\n        if norm_t_tr > 1e-16: # A small tolerance for floating point safety\n            n_tr = t_tr / norm_t_tr\n        else:\n            # This branch should not be reachable in a plastic step.\n            n_tr = np.zeros_like(t_tr)\n\n        # Compute the updated traction (stress) via radial return\n        t_np1 = sigma_c * n_tr\n        \n        # Compute the updated internal variable (plastic strain)\n        q_np1 = q_n + delta_lambda * n_tr\n\n    return t_np1, q_np1, delta_lambda\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and verify the equivalence between the\n    cohesive model update and the abstract plasticity radial return.\n    \"\"\"\n    # Common parameters for all test cases\n    k = 1000.0\n    sigma_c = 5.0\n    tolerance = 1e-10\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (delta_np1, q_n)\n        (np.array([0.01, 0.0]), np.array([0.0, 0.0])),    # Test 1\n        (np.array([0.003, 0.002]), np.array([0.0, 0.0])), # Test 2\n        (np.array([0.005, 0.0]), np.array([0.0, 0.0])),   # Test 3\n        (np.array([0.0, 0.0]), np.array([-0.006, 0.0])),  # Test 4\n        (np.array([0.002, -0.002]), np.array([0.002, -0.002])), # Test 5\n        (np.array([0.02, 0.03]), np.array([0.001, -0.002])), # Test 6\n    ]\n\n    results = []\n    for delta_np1, q_n in test_cases:\n        # 1. Compute cohesive update\n        t_coh, q_coh, dl_coh = radial_return(delta_np1, q_n, k, sigma_c)\n\n        # 2. Compute abstract plasticity update with identical parameters\n        # The mapping is: delta -> epsilon, q -> epsilon_p, k -> E, sigma_c -> sigma_Y\n        epsilon_np1 = delta_np1\n        epsilon_p_n = q_n\n        E = k\n        sigma_Y = sigma_c\n        s_plas, ep_plas, dg_plas = radial_return(epsilon_np1, epsilon_p_n, E, sigma_Y)\n\n        # 3. Perform comparisons with the specified absolute tolerance\n        # rtol=0 ensures only the absolute tolerance is used for comparison\n        b_t = np.allclose(t_coh, s_plas, atol=tolerance, rtol=0)\n        b_q = np.allclose(q_coh, ep_plas, atol=tolerance, rtol=0)\n        b_lambda = np.allclose(dl_coh, dg_plas, atol=tolerance, rtol=0)\n\n        # 4. Aggregate boolean checks for the current test case\n        b_test = b_t and b_q and b_lambda\n        results.append(b_test)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}