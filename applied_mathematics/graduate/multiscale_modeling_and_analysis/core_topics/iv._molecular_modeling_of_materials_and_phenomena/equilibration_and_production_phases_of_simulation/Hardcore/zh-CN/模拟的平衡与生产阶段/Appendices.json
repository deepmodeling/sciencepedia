{
    "hands_on_practices": [
        {
            "introduction": "任何模拟的关键第一步都是平衡阶段，在这一阶段，系统从一个人工的初始构型演化到其自然的统计平衡态。一个核心的实践问题是：这个‘预烧’（burn-in）期应该持续多久？本练习  通过将所需的预烧时长与系统的内禀弛豫时间 $\\tau$ 联系起来，推导出一个被广泛使用的经验法则，从而为这个问题提供了一个定量的解答。",
            "id": "3755212",
            "problem": "在一个将细尺度动力学与粗粒度描述耦合的分层多尺度模拟中，假设相空间动力学引导出一个遍历的马尔可夫过程，该过程具有谱隙，确保了向唯一平稳平衡态的指数收敛。设在一个初始的平衡（预烧）阶段和随后的生产阶段中，监测一个标量诊断可观测量 $A(t)$。将平衡均值表示为 $\\mu$，平衡标准差表示为 $\\sigma$，弛豫时间表示为 $\\tau$，弛豫时间定义为控制期望值收敛的最慢模式的衰减特征时间尺度。在近平衡和遍历性下的线性响应条件下，假设平均偏差 $\\Delta(t) \\equiv \\mathbb{E}[A(t)] - \\mu$ 在时间尺度 $\\tau$ 上指数收缩。已知初始条件的选择使得 $|\\Delta(0)| \\leq \\sigma$。设计预烧时长 $t_{b}$ 作为弛豫时间的倍数，$t_{b} = m \\tau$，使得在预烧结束时的残余平均偏差满足 $|\\Delta(t_{b})| \\leq \\alpha \\sigma$，其中 $\\alpha = 0.01$，这是高等研究生实践中可忽略偏差的常规阈值。\n\n仅使用所述假设和指数收敛性质，确定满足要求的最小经验倍数 $m$。只报告无量纲倍数 $m$（而不是 $t_{b}$），并将您的答案四舍五入到一位有效数字。",
            "solution": "首先验证问题，以确保其是适定的、有科学依据且无歧义的。\n\n**步骤 1：提取已知条件**\n- 系统动力学由一个具有谱隙的遍历马尔可夫过程描述，这意味着向唯一的平稳平衡态指数收敛。\n- 一个标量可观测量表示为 $A(t)$。\n- 可观测量在平衡态的均值为 $\\mu$。\n- 平衡标准差为 $\\sigma$。\n- 弛豫时间为 $\\tau$。\n- 平均偏差定义为 $\\Delta(t) \\equiv \\mathbb{E}[A(t)] - \\mu$。\n- 假设平均偏差在时间尺度 $\\tau$ 上指数收缩：$\\Delta(t) \\propto \\exp(-t/\\tau)$。\n- 初始条件满足 $|\\Delta(0)| \\leq \\sigma$。\n- 预烧时长设为 $t_{b} = m \\tau$，其中 $m$ 是一个无量纲倍数。\n- 预烧结束的目标条件是残余平均偏差必须满足 $|\\Delta(t_{b})| \\leq \\alpha \\sigma$。\n- 可忽略偏差的阈值给定为 $\\alpha = 0.01$。\n\n**步骤 2：验证**\n- **科学依据**：该问题很好地基于统计力学和计算物理的原理，特别是马尔可夫过程理论及其在分子模拟中的应用。遍历性、弛豫时间、平衡以及由谱隙引起的指数收敛等概念都是标准且基本合理的。\n- **适定性**：该问题是适定的。它提供了一个明确的目标（确定最小的 $m$）、一组数学假设和足够的数据来得出唯一的解。\n- **客观性**：该问题以该领域常见的精确、客观和定量的术语陈述。\n\n**步骤 3：结论**\n问题有效。我们可以继续求解。\n\n**求解推导**\n问题陈述了平均偏差 $\\Delta(t)$ 在时间尺度 $\\tau$ 上指数收缩。这种物理行为在数学上表示为：\n$$\n\\Delta(t) = \\Delta(0) \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n我们关心的是偏差的大小，所以我们考虑其绝对值：\n$$\n|\\Delta(t)| = |\\Delta(0)| \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n问题给出了初始偏差的上限：$|\\Delta(0)| \\leq \\sigma$。为了保证对于任何有效的初始状态都能满足最终条件，我们必须考虑最坏情况，即对应于最大可能的初始偏差。因此，我们的计算基于 $|\\Delta(0)| = \\sigma$ 的情况。这导致了在任意时间 $t$ 偏差的上限：\n$$\n|\\Delta(t)| \\leq \\sigma \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n预烧阶段的持续时间为 $t_b$，定义为弛豫时间 $\\tau$ 的倍数 $m$：\n$$\nt_b = m\\tau\n$$\n将 $t = t_b$ 代入偏差大小的不等式中，我们得到预烧阶段结束时残余偏差的上限：\n$$\n|\\Delta(t_b)| \\leq \\sigma \\exp\\left(-\\frac{m\\tau}{\\tau}\\right) = \\sigma \\exp(-m)\n$$\n设计要求是，这个残余偏差不得大于平衡标准差 $\\sigma$ 的一个分数 $\\alpha$：\n$$\n|\\Delta(t_b)| \\leq \\alpha \\sigma\n$$\n为确保满足此条件， $|\\Delta(t_b)|$ 的上限必须小于或等于所需的阈值 $\\alpha \\sigma$。这就建立了以下不等式：\n$$\n\\sigma \\exp(-m) \\leq \\alpha \\sigma\n$$\n由于对于一个非平凡的可观测量，标准差 $\\sigma$ 必须为正（如果 $\\sigma = 0$，则该可观测量为常数，并且已经处于平衡状态），我们可以在不等式两边同时除以 $\\sigma$ 而不改变不等式的方向：\n$$\n\\exp(-m) \\leq \\alpha\n$$\n为了解出 $m$，我们对两边取自然对数。由于自然对数是一个单调递增函数，不等式的方向保持不变：\n$$\n\\ln(\\exp(-m)) \\leq \\ln(\\alpha)\n$$\n$$\n-m \\leq \\ln(\\alpha)\n$$\n两边乘以 $-1$ 会反转不等号的方向：\n$$\nm \\geq -\\ln(\\alpha)\n$$\n问题要求满足此条件的最小倍数 $m$。这对应于最小值，由等式给出：\n$$\nm = -\\ln(\\alpha)\n$$\n我们已知 $\\alpha = 0.01$。将此值代入 $m$ 的方程中：\n$$\nm = -\\ln(0.01) = -\\ln(10^{-2})\n$$\n使用对数性质 $\\ln(x^y) = y \\ln(x)$，我们得到：\n$$\nm = -(-2)\\ln(10) = 2\\ln(10)\n$$\n现在，我们计算数值。10 的自然对数约等于 $\\ln(10) \\approx 2.302585$。\n$$\nm \\approx 2 \\times 2.302585 = 4.60517\n$$\n问题要求将答案四舍五入到一位有效数字。第一位有效数字是 $4$。下一位数字是 $6$，大于或等于 $5$，所以我们将第一位数字向上取整。\n$$\nm \\approx 5\n$$\n因此，一个常见的经验法则是，预烧期应大约是系统最长弛豫时间的 $5$ 倍，以确保系统性偏差已衰减到系统自然涨落尺度的大约 $1\\%$。",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "一旦系统达到平衡，我们便进入生产阶段来收集数据。然而，模拟中连续的样本通常是相互关联的，而非独立的，这使得误差分析变得复杂。本练习  深入探讨了这一问题的理论核心，引导您推导样本均值方差的公式，并揭示积分自相关时间 $\\tau_{\\mathrm{int},A}$ 在其中的核心作用。",
            "id": "3755133",
            "problem": "在一个多尺度体系的分子模拟中，我们监测一个单一的可观测量 $A(t)$。在舍弃了初始的平衡时间 $t_{\\mathrm{eq}}$ 后，后续的生产轨迹被假定为平稳且遍历的。该可观测量以均匀的步长 $\\Delta t$ 被采样，生成离散序列 $\\{A_i\\}_{i=1}^{N}$，其中 $A_i \\equiv A(t_{\\mathrm{eq}} + i\\,\\Delta t)$。令样本均值为 $\\bar{A} \\equiv \\frac{1}{N}\\sum_{i=1}^{N} A_i$，总体方差为 $\\sigma_A^2 \\equiv \\mathrm{Var}(A_i)$（假定为有限值）。定义自协方差函数 $C_A(k) \\equiv \\mathrm{Cov}(A_i, A_{i+k})$ 和归一化自相关函数 $\\rho_A(k) \\equiv \\frac{C_A(k)}{\\sigma_A^2}$，其中 $k$ 为整数延迟。当序列绝对可和时，积分自相关时间 (IAT) 以采样步长为单位定义为 $\\tau_{\\mathrm{int},A} \\equiv \\frac{1}{2} + \\sum_{k=1}^{\\infty} \\rho_A(k)$。\n\n仅从这些定义以及生产阶段的平稳性和遍历性假设出发：\n1. 推导 $\\mathrm{Var}(\\bar{A})$ 关于 $N$、$\\sigma_A^2$ 和 $\\tau_{\\mathrm{int},A}$ 的领头阶渐近表达式，该表达式在 $N$ 远大于相关范围时有效。你的推导必须从 $\\bar{A}$、$C_A(k)$ 和 $\\rho_A(k)$ 的定义开始，并且必须展示积分自相关时间是如何从用于计算 $\\mathrm{Var}(\\bar{A})$ 的协方差求和中产生的。\n2. 假设生产阶段的归一化自相关函数可以很好地由单指数衰减 $\\rho_A(k) = \\exp\\!\\big(-k\\,\\Delta t/\\tau_c\\big)$ 近似，其中采样步长 $\\Delta t = 5\\,\\mathrm{fs}$，相关时间 $\\tau_c = 250\\,\\mathrm{fs}$。对于一个包含 $N = 2.0 \\times 10^{5}$ 个样本、$\\sigma_A^2 = 1.6\\,u_A^2$ 的生产数据集，计算 $\\tau_{\\mathrm{int},A}$ 以采样步长为单位的闭式表达式，然后计算你的领头阶表达式预测的 $\\mathrm{Var}(\\bar{A})$ 的数值。将你最终的数值答案四舍五入到四位有效数字。最终的方差以 $u_A^2$ 为单位表示。\n3. 解释一种基于统计学原理的策略，用于在平衡后从有限长度的生产数据中估计 $\\tau_{\\mathrm{int},A}$，包括如何选择截断窗口以及如何验证平稳性假设。你的解释应基于标准的时间序列原理，并且必须在不使用任何捷径公式的情况下，论证偏差-方差权衡。\n\n只有第 $2$ 部分要求的最终数值将作为最终答案进行评分。然而，要获得该解题的满分，需要在第 $1$ 和第 $3$ 部分给出正确的推导和合理的论证。",
            "solution": "此问题被评估为有效，因为它在科学上基于分子模拟数据的统计分析，问题陈述清晰，提供了所有必要信息，并以客观、正式的语言表达，没有矛盾或歧义。\n\n### 第 1 部分：样本均值方差的推导\n\n我们被要求推导 $\\mathrm{Var}(\\bar{A})$ 的领头阶渐近表达式。我们从样本均值 $\\bar{A}$ 的定义开始：\n$$\n\\bar{A} \\equiv \\frac{1}{N}\\sum_{i=1}^{N} A_i\n$$\n样本均值的方差由下式给出：\n$$\n\\mathrm{Var}(\\bar{A}) = \\mathrm{Var}\\left(\\frac{1}{N}\\sum_{i=1}^{N} A_i\\right)\n$$\n使用方差的性质 $\\mathrm{Var}(c X) = c^2 \\mathrm{Var}(X)$，我们可以将常数 $\\frac{1}{N}$ 因子提出来：\n$$\n\\mathrm{Var}(\\bar{A}) = \\frac{1}{N^2} \\mathrm{Var}\\left(\\sum_{i=1}^{N} A_i\\right)\n$$\n随机变量之和的方差是其协方差矩阵中所有元素的总和：\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{N} A_i\\right) = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathrm{Cov}(A_i, A_j)\n$$\n问题指出生产轨迹是平稳的。这意味着协方差 $\\mathrm{Cov}(A_i, A_j)$ 仅取决于样本之间的时间延迟 $k = j-i$。我们使用给定的自协方差函数定义 $C_A(k) \\equiv \\mathrm{Cov}(A_i, A_{i+k})$。因此，$\\mathrm{Cov}(A_i, A_j) = C_A(j-i)$。将此代入二重和中得到：\n$$\n\\mathrm{Var}(\\bar{A}) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} C_A(j-i)\n$$\n为了计算这个二重和，我们将求和指标从 $(i,j)$ 更改为 $(i,k)$，其中 $k=j-i$。对于一个固定的延迟 $k$，我们计算和中序对 $(i,j)$ 的数量。对于给定的延迟 $k$，项数为 $N-|k|$，其中 $k \\in \\{-(N-1), \\dots, (N-1)\\}$。因此，二重和可以重写为关于延迟 $k$ 的单重和：\n$$\n\\sum_{i=1}^{N} \\sum_{j=1}^{N} C_A(j-i) = \\sum_{k=-(N-1)}^{N-1} (N-|k|) C_A(k)\n$$\n将此代回 $\\mathrm{Var}(\\bar{A})$ 的表达式中：\n$$\n\\mathrm{Var}(\\bar{A}) = \\frac{1}{N^2} \\sum_{k=-(N-1)}^{N-1} (N-|k|) C_A(k) = \\frac{1}{N} \\sum_{k=-(N-1)}^{N-1} \\left(1-\\frac{|k|}{N}\\right) C_A(k)\n$$\n我们被要求得到一个对大 $N$ 有效的领头阶渐近表达式，具体来说是当 $N$ 远大于可观测量的相关范围时。相关范围是 $C_A(k)$ 显著不为零的延迟 $k$ 的尺度。对于远大于此范围的延迟 $|k|$，$C_A(k) \\approx 0$。因为 $N$ 很大，对于相关范围内的所有 $k$，$\\frac{|k|}{N}$ 项是可忽略的。因此，我们可以近似 $\\left(1-\\frac{|k|}{N}\\right) \\approx 1$。此外，由于 $C_A(k)$ 对于延迟 $|k| \\ll N$ 衰减到零，我们可以将求和的极限扩展到 $\\pm\\infty$，而误差可忽略不计。这产生了渐近表达式：\n$$\n\\mathrm{Var}(\\bar{A}) \\approx \\frac{1}{N} \\sum_{k=-\\infty}^{\\infty} C_A(k)\n$$\n自协方差函数是对称的，$C_A(k) = C_A(-k)$。我们可以将和分解为：\n$$\n\\sum_{k=-\\infty}^{\\infty} C_A(k) = C_A(0) + \\sum_{k=1}^{\\infty} C_A(k) + \\sum_{k=-\\infty}^{-1} C_A(k) = C_A(0) + 2\\sum_{k=1}^{\\infty} C_A(k)\n$$\n根据定义，$C_A(0) = \\mathrm{Var}(A_i) = \\sigma_A^2$。我们代入这个以及归一化自相关函数的定义 $\\rho_A(k) = C_A(k)/\\sigma_A^2$：\n$$\n\\mathrm{Var}(\\bar{A}) \\approx \\frac{\\sigma_A^2}{N} \\left(\\rho_A(0) + 2\\sum_{k=1}^{\\infty} \\rho_A(k)\\right)\n$$\n由于 $\\rho_A(0) = C_A(0)/\\sigma_A^2 = 1$，表达式变为：\n$$\n\\mathrm{Var}(\\bar{A}) \\approx \\frac{\\sigma_A^2}{N} \\left(1 + 2\\sum_{k=1}^{\\infty} \\rho_A(k)\\right)\n$$\n最后，我们引入积分自相关时间 (IAT)，给定为 $\\tau_{\\mathrm{int},A} \\equiv \\frac{1}{2} + \\sum_{k=1}^{\\infty} \\rho_A(k)$。从此定义中，我们可以将求和部分表示为 $2\\sum_{k=1}^{\\infty} \\rho_A(k) = 2\\left(\\tau_{\\mathrm{int},A} - \\frac{1}{2}\\right) = 2\\tau_{\\mathrm{int},A} - 1$。将此代入 $\\mathrm{Var}(\\bar{A})$ 的表达式中得到：\n$$\n\\mathrm{Var}(\\bar{A}) \\approx \\frac{\\sigma_A^2}{N} \\left(1 + (2\\tau_{\\mathrm{int},A} - 1)\\right) = \\frac{\\sigma_A^2}{N} (2\\tau_{\\mathrm{int},A})\n$$\n这就是所求的领头阶渐近表达式：\n$$\n\\mathrm{Var}(\\bar{A}) \\approx \\frac{2 \\sigma_A^2 \\tau_{\\mathrm{int},A}}{N}\n$$\n\n### 第 2 部分：数值计算\n\n首先，我们根据给定的自相关函数单指数衰减模型 $\\rho_A(k) = \\exp(-k\\,\\Delta t/\\tau_c)$，求出 $\\tau_{\\mathrm{int},A}$ 的闭式表达式。\n使用 $\\tau_{\\mathrm{int},A}$ 的定义：\n$$\n\\tau_{\\mathrm{int},A} = \\frac{1}{2} + \\sum_{k=1}^{\\infty} \\rho_A(k) = \\frac{1}{2} + \\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{k\\,\\Delta t}{\\tau_c}\\right)\n$$\n该求和是一个几何级数 $\\sum_{k=1}^{\\infty} r^k$，其比值为 $r = \\exp(-\\Delta t/\\tau_c)$。该级数的和是 $\\frac{r}{1-r}$。代入 $r$ 的表达式：\n$$\n\\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{k\\,\\Delta t}{\\tau_c}\\right) = \\frac{\\exp(-\\Delta t/\\tau_c)}{1 - \\exp(-\\Delta t/\\tau_c)} = \\frac{1}{\\exp(\\Delta t/\\tau_c) - 1}\n$$\n所以，$\\tau_{\\mathrm{int},A}$ 的闭式表达式为：\n$$\n\\tau_{\\mathrm{int},A} = \\frac{1}{2} + \\frac{1}{\\exp(\\Delta t/\\tau_c) - 1}\n$$\n这可以用双曲函数重写为 $\\tau_{\\mathrm{int},A} = \\frac{1}{2}\\coth\\left(\\frac{\\Delta t}{2\\tau_c}\\right)$。\n\n接下来，我们计算数值。给定的参数是：\n$\\Delta t = 5\\,\\mathrm{fs}$\n$\\tau_c = 250\\,\\mathrm{fs}$\n$N = 2.0 \\times 10^{5}$\n$\\sigma_A^2 = 1.6\\,u_A^2$\n\n指数的参数是 $\\frac{\\Delta t}{\\tau_c} = \\frac{5}{250} = 0.02$。\n我们计算 $\\tau_{\\mathrm{int},A}$：\n$$\n\\tau_{\\mathrm{int},A} = \\frac{1}{2} + \\frac{1}{\\exp(0.02) - 1} \\approx 0.5 + \\frac{1}{1.02020134 - 1} = 0.5 + \\frac{1}{0.02020134} \\approx 0.5 + 49.501667 \\approx 50.001667\n$$\n现在，我们使用第 1 部分推导的公式计算 $\\mathrm{Var}(\\bar{A})$：\n$$\n\\mathrm{Var}(\\bar{A}) = \\frac{2 \\sigma_A^2 \\tau_{\\mathrm{int},A}}{N} = \\frac{2 \\times (1.6\\,u_A^2) \\times (50.001667)}{2.0 \\times 10^{5}}\n$$\n$$\n\\mathrm{Var}(\\bar{A}) = \\frac{1.6 \\times 50.001667}{10^5} \\,u_A^2 = \\frac{80.002667}{10^5} \\,u_A^2 = 8.0002667 \\times 10^{-4} \\,u_A^2\n$$\n将最终数值四舍五入到四位有效数字，我们得到 $8.000 \\times 10^{-4}$。\n\n### 第 3 部分：从有限数据估计 IAT 的策略\n\n从有限长度的生产数据集 $\\{A_i\\}_{i=1}^N$ 估计积分自相关时间 $\\tau_{\\mathrm{int},A}$，需要一个谨慎且基于统计学原理的方法。\n\n1.  **平稳性验证**：在进行任何分析之前，必须检查生产阶段是平稳的这一假设。一个常见的实用方法是将整个时间序列分成少数几个大的、大小相等的块（例如，3到5个块）。计算每个块内可观测量 $A$ 的均值和方差。如果各块的均值和方差在统计上彼此相似（即，它们围绕全局均值和方差波动，没有任何系统性的漂移或趋势），则认为平稳性假设在实践中是合理的。绘制数据的移动平均图也可以为趋势提供视觉检查。\n\n2.  **估计自相关函数 (ACF)**：对于延迟 $k$，样本自协方差函数 $\\hat{C}_A(k)$ 从数据中估计：\n    $$\n    \\hat{C}_A(k) = \\frac{1}{N-k} \\sum_{i=1}^{N-k} (A_i - \\bar{A})(A_{i+k} - \\bar{A})\n    $$\n    其中 $\\bar{A}$ 是整个数据集的样本均值。然后样本 ACF 是 $\\hat{\\rho}_A(k) = \\hat{C}_A(k) / \\hat{C}_A(0)$。\n\n3.  **偏差-方差权衡与截断**：一个朴素的估计 $\\tau_{\\mathrm{int},A}$ 的尝试，即通过将其估计的 ACF 求和至最大可能延迟 $N-1$，即 $\\hat{\\tau}_{\\mathrm{int},A} = \\frac{1}{2} + \\sum_{k=1}^{N-1} \\hat{\\rho}_A(k)$，是有缺陷的。估计量 $\\hat{\\rho}_A(k)$ 的统计不确定性（方差）随着延迟 $k$ 的增加而增加，因为可用于其计算的数据对 $(N-k)$ 减少了。对于大的 $k$，$\\hat{\\rho}_A(k)$ 主要由噪声主导。将这些噪声项相加会给 $\\tau_{\\mathrm{int},A}$ 的估计增加显著的方差，阻止了和的收敛。\n\n    为了处理这个问题，求和必须在一个有限的窗口大小 $W \\ll N-1$ 处截断：\n    $$\n    \\hat{\\tau}_{\\mathrm{int},A}(W) = \\frac{1}{2} + \\sum_{k=1}^{W} \\hat{\\rho}_A(k)\n    $$\n    选择 $W$ 涉及到一个关键的**偏差-方差权衡**：\n    *   **小 $W$**：如果 $W$ 太小，求和在真实的 ACF 衰减到零之前就被截断了。这会引入一个系统误差（偏差），通常是对 $\\tau_{\\mathrm{int},A}$ 的低估，因为 ACF 的正尾部被排除了。\n    *   **大 $W$**：如果 $W$ 太大，求和会包括来自大延迟的噪声估计 $\\hat{\\rho}_A(k)$，这会增加最终估计 $\\hat{\\tau}_{\\mathrm{int},A}$ 的统计误差（方差）。\n\n4.  **选择 $W$ 的原则性策略**：一个稳健的策略是分析 $\\hat{\\tau}_{\\mathrm{int},A}(W)$ 作为截断窗口 $W$ 的函数的行为。可以绘制 $\\hat{\\tau}_{\\mathrm{int},A}(W)$ 对 $W$ 的图。\n    *   对于小的 $W$，随着更多正相关项的加入，$\\hat{\\tau}_{\\mathrm{int},A}(W)$ 将会增加。\n    *   理想情况下，曲线将达到一个平台区，其中 $\\hat{\\tau}_{\\mathrm{int},A}(W)$ 变得相对恒定。这是因为对于超出真实相关时间的延迟 $k$，真实的 $\\rho_A(k)$ 接近于零，所以增加更多的项不应该显著改变和。\n    *   对于非常大的 $W$，噪声占主导地位，$\\hat{\\tau}_{\\mathrm{int},A}(W)$ 的图像将变得不稳定，并且常常向上漂移。\n    *   $\\tau_{\\mathrm{int},A}$ 的最终估计的一个好选择是在这个平台区内 $\\hat{\\tau}_{\\mathrm{int},A}(W)$ 的值。\n\n    一个自洽的标准是选择 $W$ 是所估计的 $\\tau_{\\mathrm{int},A}$ 自身的几倍大，例如，选择 $W$ 使得 $W \\ge c \\cdot \\hat{\\tau}_{\\mathrm{int},A}(W)$，其中因子 $c$ 约为 $5-6$。可以迭代找到满足此条件的 $W$。这确保了求和窗口足够大，以捕捉相关的完整衰减，根据定义，这发生在 $\\tau_{\\mathrm{int},A}$ 的时间尺度上。这个过程通过在提供有意义信号而不被统计噪声淹没的情况下扩展求和，系统地平衡了权衡。",
            "answer": "$$\n\\boxed{8.000 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "掌握了误差分析的理论基础后，我们现在可以解决模拟实践中的两个关键问题：我们当前的数据集包含了多少独立信息？以及我们必须运行多长时间的模拟才能达到预期的精度？本问题  将理论付诸实践，要求您计算有效非相关样本数，并确定为达到特定统计目标所需的生产阶段运行长度。",
            "id": "3755144",
            "problem": "对一个粗粒化流体的可观测量 $A$ 进行分子动力学 (MD) 模拟，在每个积分步进行离散时间采样。在丢弃初始的平衡段以消除瞬态行为后，收集了长度为 $N$ 步的生产轨迹。假设生产轨迹是一个具有有限积分自相关时间的平稳、遍历过程，因此相关数据的中心极限定理适用。\n\n从生产轨迹中，估计出 $A$ 的经验方差为 $\\sigma_{A}^{2} = 0.64$ (单位为 $A$ 的平方)，以步为单位计算的 $A$ 的积分自相关时间为 $\\tau_{\\mathrm{int},A} = 1200$。生产步数为 $N = 2.0 \\times 10^{6}$。你可以假设采样间隔等于一步，并且积分自相关时间仅在生产阶段计算。\n\n仅使用平稳相关时间序列的第一性原理，推导生产轨迹中包含的有效非相关样本数，然后确定所需的最小总生产轨迹长度（以步为单位），以保证样本均值 $\\bar{A}$ 的标准误差小于或等于目标绝对精度 $\\delta_{\\mathrm{target}} = 0.02$（单位为 $A$）。将模拟长度表示为步数。以精确值的形式提供两个答案；不要四舍五入。最终答案应按顺序报告当前存在的有效非相关样本数和所需的最小生产长度（分别以样本数/步数表示）。",
            "solution": "该问题是适定的，有科学依据，并包含了得到唯一解所需的所有信息。这是分子模拟数据统计分析中的一个标准问题。\n\n求解需要两步计算：首先，计算现有生产轨迹中的有效非相关样本数；其次，计算为达到样本均值的指定精度所需的新轨迹的最小长度。\n\n设 $A_i$ 是可观测量 $A$ 在模拟步骤 $i$ 的值。生产轨迹由 $N$ 个这样的值 $\\{A_1, A_2, \\dots, A_N\\}$ 组成。该可观测量的样本均值由下式给出：\n$$ \\bar{A} = \\frac{1}{N} \\sum_{i=1}^{N} A_i $$\n对于一个平稳时间序列，该样本均值的方差 $\\sigma^2(\\bar{A})$ 根据第一性原理给出：\n$$ \\sigma^2(\\bar{A}) = \\text{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} A_i\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\text{Cov}(A_i, A_j) $$\n对于平稳过程，协方差 $\\text{Cov}(A_i, A_j)$ 仅取决于时间延迟 $k = |i-j|$，并且可以表示为 $\\text{Cov}(A_i, A_j) = \\sigma_A^2 C(k)$，其中 $\\sigma_A^2$ 是可观测量 $A$ 的真实方差，$C(k)$ 是延迟为 $k$ 时的归一化自相关函数。均值的方差变为：\n$$ \\sigma^2(\\bar{A}) = \\frac{\\sigma_A^2}{N^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} C(|i-j|) $$\n通过对延迟 $k$ 的求和重新索引，该表达式可以写成：\n$$ \\sigma^2(\\bar{A}) = \\frac{\\sigma_A^2}{N} \\left[ 1 + 2 \\sum_{k=1}^{N-1} \\left(1 - \\frac{k}{N}\\right) C(k) \\right] $$\n对于远大于相关性衰减特征时间的轨迹长度 $N$，该表达式可以很好地近似为：\n$$ \\sigma^2(\\bar{A}) \\approx \\frac{\\sigma_A^2}{N} \\left[ 1 + 2 \\sum_{k=1}^{\\infty} C(k) \\right] $$\n项 $s_A = 1 + 2 \\sum_{k=1}^{\\infty} C(k)$ 被称为可观测量 $A$ 的统计不等效性。它量化了与一个独立样本等效的相关样本的数量。\n因此，均值的方差可以写成：\n$$ \\sigma^2(\\bar{A}) \\approx s_A \\frac{\\sigma_A^2}{N} $$\n有效非相关样本数 $N_{\\text{eff}}$ 的定义使得均值的方差具有独立样本的形式 $\\sigma^2(\\bar{A}) = \\sigma_A^2 / N_{\\text{eff}}$。通过比较，我们发现关系式：\n$$ N_{\\text{eff}} = \\frac{N}{s_A} $$\n问题给出了积分自相关时间 $\\tau_{\\mathrm{int},A}$。根据分子模拟数据分析中的标准惯例，统计不等效性 $s_A$ 和 $\\tau_{\\mathrm{int},A}$ 之间的关系由 $s_A = 2\\tau_{\\mathrm{int},A}$ 给出。这个定义植根于自相关时间的实际计算和用于估计误差的方式。\n因此，有效样本数为：\n$$ N_{\\text{eff}} = \\frac{N}{2 \\tau_{\\mathrm{int},A}} $$\n使用给定的值：$N = 2.0 \\times 10^6$ 和 $\\tau_{\\mathrm{int},A} = 1200$。\n$$ N_{\\text{eff}} = \\frac{2.0 \\times 10^6}{2 \\times 1200} = \\frac{2.0 \\times 10^6}{2400} = \\frac{2000000}{2400} = \\frac{20000}{24} = \\frac{2500}{3} $$\n这是答案的第一部分。由于问题要求精确值，我们将其保留为分数形式。\n\n对于问题的第二部分，我们需要找到最小生产轨迹长度，称之为 $N_{\\text{new}}$，以确保样本均值的标准误差 $\\sigma(\\bar{A})$ 小于或等于目标精度 $\\delta_{\\text{target}} = 0.02$。\n标准误差是均值方差的平方根。条件是 $\\sigma(\\bar{A}) \\le \\delta_{\\text{target}}$，这等价于 $\\sigma^2(\\bar{A}) \\le \\delta_{\\text{target}}^2$。\n对于长度为 $N_{\\text{new}}$ 的轨迹，使用我们关于均值方差的表达式：\n$$ \\sigma^2(\\bar{A}) = \\frac{s_A \\sigma_A^2}{N_{\\text{new}}} = \\frac{2 \\tau_{\\mathrm{int},A} \\sigma_A^2}{N_{\\text{new}}} $$\n我们必须满足不等式：\n$$ \\frac{2 \\tau_{\\mathrm{int},A} \\sigma_A^2}{N_{\\text{new}}} \\le \\delta_{\\text{target}}^2 $$\n这假设系统的内在属性 $\\sigma_A^2$ 和 $\\tau_{\\mathrm{int},A}$ 与模拟长度无关，这是平稳过程的一个标准假设。最小长度 $N_{\\text{new}}$ 在等式成立时获得：\n$$ N_{\\text{new}} = \\frac{2 \\tau_{\\mathrm{int},A} \\sigma_A^2}{\\delta_{\\text{target}}^2} $$\n给定 $\\sigma_A^2 = 0.64$，$\\tau_{\\mathrm{int},A} = 1200$，以及 $\\delta_{\\text{target}} = 0.02$。\n代入这些值：\n$$ N_{\\text{new}} = \\frac{2 \\times 1200 \\times 0.64}{(0.02)^2} = \\frac{2400 \\times 0.64}{0.0004} $$\n$$ N_{\\text{new}} = \\frac{1536}{4 \\times 10^{-4}} = 384 \\times 10^4 = 3,840,000 $$\n因此，需要最少 $3,840,000$ 步来达到目标精度。\n\n要求的两个值是有效样本数 $N_{\\text{eff}} = \\frac{2500}{3}$ 和所需的最小轨迹长度 $N_{\\text{new}} = 3,840,000$ 步。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2500}{3} & 3840000\n\\end{pmatrix}\n}\n$$"
        }
    ]
}