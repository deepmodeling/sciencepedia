{
    "hands_on_practices": [
        {
            "introduction": "The foundation of many continuum models derived from agent-based systems is the diffusion equation. This exercise provides a direct and fundamental link between the microscopic world of individual agent jumps and the macroscopic world of smooth density evolution. By analyzing the mean-square displacement of a single agent, we will derive the diffusion coefficient $D$ for two distinct microscopic timing protocols, revealing how this crucial macroscopic parameter is determined by the underlying statistics of the random walk .",
            "id": "3732099",
            "problem": "Consider a $1$-dimensional agent-based model in continuous space in which each agent executes independent, identically distributed jumps of the form $\\varepsilon \\,\\xi$, where $\\varepsilon>0$ is a small length scale and $\\xi$ is a scalar random variable with $\\mathbb{E}[\\xi]=0$ and $\\operatorname{Var}(\\xi)=\\sigma^{2}\\in(0,\\infty)$. Two distinct microscopic update mechanisms are used:\n\n$($i$)$ Continuous-time updates: each agent is equipped with an independent Poisson clock of rate $\\lambda>0$. When an agent’s clock rings, it instantaneously performs a jump of size $\\varepsilon \\,\\xi$, with successive $\\xi$’s independent of one another and of the clocks.\n\n$($ii$)$ Discrete-time updates: each agent updates synchronously at times $t=n\\,\\Delta t$ for $n\\in\\mathbb{N}$, with fixed time step $\\Delta t>0$. At each update, the agent performs a jump of size $\\varepsilon \\,\\xi$, with successive $\\xi$’s independent of one another.\n\nAssume a large population of independent agents whose empirical density admits, under the standard diffusive macroscopic scaling $\\varepsilon\\to 0$ and over finite macroscopic times, a deterministic continuum limit governed by a diffusion equation of the form $\\partial_{t}\\rho=D\\,\\partial_{xx}\\rho$ with a constant macroscopic diffusion coefficient $D$.\n\nUsing only fundamental definitions for independent increments, properties of Poisson processes, and the defining property of diffusion that the macroscopic mean-square displacement grows linearly in time as $\\mathbb{E}\\!\\left[(X(t)-X(0))^{2}\\right]\\sim 2\\,D\\,t$, derive the analytic expression of the diffusion coefficient $D$ in terms of $\\varepsilon$, $\\sigma^{2}$, and the update parameters for each mechanism. Express your final answer as a row matrix $(D_{\\mathrm{ct}},\\,D_{\\mathrm{dt}})$, where $D_{\\mathrm{ct}}$ corresponds to the continuous-time Poisson-clock case and $D_{\\mathrm{dt}}$ to the discrete-time update case. No rounding is required. Do not include units in your final boxed answer.",
            "solution": "The problem asks for the derivation of the macroscopic diffusion coefficient $D$ for two different microscopic agent-based models. The derivation will be based on the fundamental relationship between the mean-square displacement (MSD) of a particle undergoing a random walk and the diffusion coefficient, which for a $1$-dimensional system is given by $\\mathbb{E}[(X(t)-X(0))^2] \\sim 2Dt$ for large times $t$. We will calculate the MSD for a single agent in each case and extract the corresponding expression for $D$.\n\nLet $X(t)$ be the position of a single agent at time $t$. We can set the initial position to be $X(0)=0$ without loss of generality. The position at a later time $t$ is the sum of all jumps that have occurred up to that time. Let $N(t)$ be the number of jumps that have occurred by time $t$. The $i$-th jump is a random variable $J_i = \\varepsilon \\xi_i$, where $\\xi_i$ are independent, identically distributed (i.i.d.) random variables with mean $\\mathbb{E}[\\xi_i]=0$ and variance $\\operatorname{Var}(\\xi_i)=\\sigma^2$.\n\nThe position at time $t$ is given by:\n$$X(t) = \\sum_{i=1}^{N(t)} J_i$$\nWe need to calculate the MSD, which is $\\mathbb{E}[X(t)^2]$ since $X(0)=0$.\n\nFirst, let's determine the statistical properties of a single jump $J_i$.\nThe mean of a jump is:\n$$\\mathbb{E}[J_i] = \\mathbb{E}[\\varepsilon \\xi_i] = \\varepsilon \\mathbb{E}[\\xi_i] = \\varepsilon \\cdot 0 = 0$$\nThe mean of the square of a jump is related to its variance:\n$$\\mathbb{E}[J_i^2] = \\operatorname{Var}(J_i) + (\\mathbb{E}[J_i])^2$$\nThe variance of a jump is:\n$$\\operatorname{Var}(J_i) = \\operatorname{Var}(\\varepsilon \\xi_i) = \\varepsilon^2 \\operatorname{Var}(\\xi_i) = \\varepsilon^2 \\sigma^2$$\nTherefore, the mean of the square of a jump is:\n$$\\mathbb{E}[J_i^2] = \\varepsilon^2 \\sigma^2 + 0^2 = \\varepsilon^2 \\sigma^2$$\n\nNow we compute the MSD, $\\mathbb{E}[X(t)^2]$, using the law of total expectation by conditioning on the number of jumps $N(t)$.\n$$\\mathbb{E}[X(t)^2] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\left(\\sum_{i=1}^{N(t)} J_i\\right)^2 \\middle| N(t) \\right] \\right]$$\nLet's evaluate the inner expectation for a fixed number of jumps, $N(t)=n$.\n$$\\mathbb{E}\\left[ \\left(\\sum_{i=1}^{n} J_i\\right)^2 \\right] = \\mathbb{E}\\left[ \\sum_{i=1}^{n} J_i^2 + \\sum_{i \\neq j}^{n} J_i J_j \\right] = \\sum_{i=1}^{n} \\mathbb{E}[J_i^2] + \\sum_{i \\neq j}^{n} \\mathbb{E}[J_i J_j]$$\nSince the successive jumps $J_i$ are independent and have zero mean, for $i \\neq j$:\n$$\\mathbb{E}[J_i J_j] = \\mathbb{E}[J_i] \\mathbb{E}[J_j] = 0 \\cdot 0 = 0$$\nThus, the sum of cross-terms vanishes. The expression simplifies to:\n$$\\mathbb{E}\\left[ \\left(\\sum_{i=1}^{n} J_i\\right)^2 \\right] = \\sum_{i=1}^{n} \\mathbb{E}[J_i^2] = \\sum_{i=1}^{n} \\varepsilon^2 \\sigma^2 = n \\varepsilon^2 \\sigma^2$$\nSubstituting this back into the law of total expectation:\n$$\\mathbb{E}[X(t)^2] = \\mathbb{E}[N(t) \\varepsilon^2 \\sigma^2] = \\varepsilon^2 \\sigma^2 \\mathbb{E}[N(t)]$$\nThe problem now reduces to finding the expected number of jumps, $\\mathbb{E}[N(t)]$, for each of the two update mechanisms.\n\n$($i$)$ Continuous-time updates (Poisson clock):\nIn this case, the number of jumps $N(t)$ that an agent performs by time $t$ follows a Poisson process with rate $\\lambda$. The number of events in a time interval of length $t$ is a Poisson-distributed random variable with parameter $\\lambda t$.\n$$N(t) \\sim \\text{Poisson}(\\lambda t)$$\nThe expected value of a Poisson random variable with parameter $\\mu$ is $\\mu$. Therefore, the expected number of jumps is:\n$$\\mathbb{E}[N(t)] = \\lambda t$$\nSubstituting this into our MSD formula:\n$$\\mathbb{E}[X(t)^2] = \\varepsilon^2 \\sigma^2 (\\lambda t) = (\\lambda \\varepsilon^2 \\sigma^2) t$$\nWe match this result with the macroscopic diffusion law $\\mathbb{E}[X(t)^2] = 2 D_{\\mathrm{ct}} t$.\n$$2 D_{\\mathrm{ct}} t = \\lambda \\varepsilon^2 \\sigma^2 t$$\nSolving for the diffusion coefficient $D_{\\mathrm{ct}}$ gives:\n$$D_{\\mathrm{ct}} = \\frac{1}{2} \\lambda \\varepsilon^2 \\sigma^2$$\n\n$($ii$)$ Discrete-time updates (synchronous):\nHere, jumps occur deterministically at times $t_n = n \\Delta t$ for $n \\in \\mathbb{N}$. For a given macroscopic time $t$, the number of jumps that have occurred is the number of update steps completed by time $t$. This number is given by the floor function:\n$$N(t) = \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\nIn this model, for a fixed time $t$, $N(t)$ is not a random variable. Therefore, its expectation is simply its value:\n$$\\mathbb{E}[N(t)] = N(t) = \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\nThe MSD is then:\n$$\\mathbb{E}[X(t)^2] = \\varepsilon^2 \\sigma^2 \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\nThe problem states that the system is observed over finite macroscopic times, which implies that $t$ is large compared to the microscopic time step $\\Delta t$, i.e., $t \\gg \\Delta t$. In this regime, we can approximate the floor function by its argument:\n$$\\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor \\approx \\frac{t}{\\Delta t}$$\nThis approximation becomes exact in the limit defining the linear growth of the MSD.\nTherefore, for large $t$:\n$$\\mathbb{E}[X(t)^2] \\sim \\varepsilon^2 \\sigma^2 \\frac{t}{\\Delta t} = \\left(\\frac{\\varepsilon^2 \\sigma^2}{\\Delta t}\\right) t$$\nWe match this asymptotic behavior with the macroscopic law $\\mathbb{E}[X(t)^2] \\sim 2 D_{\\mathrm{dt}} t$.\n$$2 D_{\\mathrm{dt}} t = \\frac{\\varepsilon^2 \\sigma^2}{\\Delta t} t$$\nSolving for the diffusion coefficient $D_{\\mathrm{dt}}$ gives:\n$$D_{\\mathrm{dt}} = \\frac{\\varepsilon^2 \\sigma^2}{2 \\Delta t}$$\n\nThe final answer is the row matrix $(D_{\\mathrm{ct}}, D_{\\mathrm{dt}})$ containing the two derived expressions.\n$D_{\\mathrm{ct}} = \\frac{1}{2} \\lambda \\varepsilon^2 \\sigma^2$\n$D_{\\mathrm{dt}} = \\frac{\\varepsilon^2 \\sigma^2}{2 \\Delta t}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} \\lambda \\varepsilon^{2} \\sigma^{2} & \\frac{\\varepsilon^{2} \\sigma^{2}}{2 \\Delta t}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While pure diffusion describes random, unbiased motion, many systems exhibit a directional preference, leading to macroscopic advection. This practice demonstrates how to derive an advection-diffusion equation by introducing a weak spatial bias into an agent's jump probabilities. Starting from the discrete master equation, we will employ a systematic Taylor expansion under the appropriate parabolic scaling to uncover the continuum limit, explicitly connecting the microscopic bias to the resulting macroscopic drift velocity .",
            "id": "3732081",
            "problem": "Consider a one-dimensional agent-based model on a lattice with mesh size $\\epsilon > 0$, where at each discrete time step of duration $\\epsilon^{2}$ an agent at position $x$ jumps to $x+\\epsilon$ with probability $p_{+}(x)$ and to $x-\\epsilon$ with probability $p_{-}(x)$. Suppose the jump probabilities encode a weak bias of order $O(\\epsilon)$:\n$$\np_{+}(x) = \\frac{1}{2} + \\epsilon \\beta(x), \\qquad p_{-}(x) = \\frac{1}{2} - \\epsilon \\beta(x),\n$$\nwhere $\\beta(x)$ is a smooth, bounded function of $x$ and for all sufficiently small $\\epsilon$ the probabilities remain in $[0,1]$. Let $\\rho^{\\epsilon}(x,t)$ denote the expected number density of agents at lattice site $x$ and time $t$. Assume the initial density is smooth on the macroscopic scale and that the agent motion is independent and identically distributed across agents.\n\nStarting from the discrete conservation (master) equation for $\\rho^{\\epsilon}(x,t)$ and using the parabolic scaling where space increments are $O(\\epsilon)$ and time increments are $O(\\epsilon^{2})$, derive the continuum limit as $\\epsilon \\to 0$ and obtain the advection-diffusion Partial Differential Equation (PDE) for the macroscopic density $\\rho(x,t)$ in the form\n$$\n\\partial_{t} \\rho(x,t) + \\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big) = D\\,\\partial_{xx} \\rho(x,t),\n$$\nwith constant diffusion coefficient $D$. Determine the effective drift function $v(x)$ explicitly in terms of $\\beta(x)$.\n\nYour final answer must be a single closed-form analytic expression for $v(x)$ with no units.",
            "solution": "The problem requires the derivation of a macroscopic advection-diffusion equation from a microscopic agent-based model on a one-dimensional lattice. The derivation proceeds by first writing the master equation for the agent density, then performing a Taylor expansion under a parabolic scaling, and finally taking the continuum limit.\n\nLet $\\rho^{\\epsilon}(x,t)$ be the expected number density of agents at a lattice site $x$ at time $t$. The lattice spacing is $\\epsilon$ and the discrete time step is $\\Delta t = \\epsilon^2$. An agent at site $y$ jumps to $y+\\epsilon$ with probability $p_{+}(y)$ and to $y-\\epsilon$ with probability $p_{-}(y)$. The probabilities are given as $p_{+}(y) = \\frac{1}{2} + \\epsilon \\beta(y)$ and $p_{-}(y) = \\frac{1}{2} - \\epsilon \\beta(y)$. We note that $p_{+}(y) + p_{-}(y) = 1$, which means an agent always jumps to a neighboring site and never stays put.\n\nThe master equation for the density $\\rho^{\\epsilon}(x,t)$ describes the conservation of agents. The change in density at site $x$ over one time step is the net result of agents jumping in from neighboring sites minus the agents jumping out from site $x$.\n$$\n\\rho^{\\epsilon}(x, t+\\epsilon^2) - \\rho^{\\epsilon}(x, t) = \\rho^{\\epsilon}(x-\\epsilon, t) p_{+}(x-\\epsilon) + \\rho^{\\epsilon}(x+\\epsilon, t) p_{-}(x+\\epsilon) - \\rho^{\\epsilon}(x, t) \\left( p_{+}(x) + p_{-}(x) \\right)\n$$\nSince $p_{+}(x) + p_{-}(x) = 1$, the master equation simplifies to:\n$$\n\\rho^{\\epsilon}(x, t+\\epsilon^2) - \\rho^{\\epsilon}(x, t) = \\rho^{\\epsilon}(x-\\epsilon, t) p_{+}(x-\\epsilon) + \\rho^{\\epsilon}(x+\\epsilon, t) p_{-}(x+\\epsilon) - \\rho^{\\epsilon}(x, t)\n$$\nTo find the continuum limit as $\\epsilon \\to 0$, we assume that $\\rho^{\\epsilon}(x,t)$ converges to a smooth function $\\rho(x,t)$. We can then perform a Taylor series expansion of all terms in the master equation around the point $(x,t)$.\n\nThe left-hand side (LHS) of the equation is expanded in time:\n$$\n\\rho(x, t+\\epsilon^2) - \\rho(x, t) = \\left( \\rho + \\epsilon^2 \\partial_t \\rho + O(\\epsilon^4) \\right) - \\rho = \\epsilon^2 \\partial_t \\rho + O(\\epsilon^4)\n$$\nwhere $\\rho$ and its derivatives are evaluated at $(x,t)$.\n\nThe right-hand side (RHS) involves expansions in space for both the density $\\rho$ and the probability functions $\\beta(x)$.\nFirst, we expand the density function $\\rho(x \\pm \\epsilon, t)$:\n$$\n\\rho(x \\pm \\epsilon, t) = \\rho \\pm \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho \\pm \\frac{\\epsilon^3}{6} \\partial_{xxx} \\rho + O(\\epsilon^4)\n$$\nNext, we expand the probability functions. The function $\\beta(x)$ is assumed to be smooth.\n$p_{+}(x-\\epsilon) = \\frac{1}{2} + \\epsilon \\beta(x-\\epsilon) = \\frac{1}{2} + \\epsilon \\left(\\beta - \\epsilon \\beta' + \\frac{\\epsilon^2}{2}\\beta'' - \\dots\\right) = \\frac{1}{2} + \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)$\n$p_{-}(x+\\epsilon) = \\frac{1}{2} - \\epsilon \\beta(x+\\epsilon) = \\frac{1}{2} - \\epsilon \\left(\\beta + \\epsilon \\beta' + \\frac{\\epsilon^2}{2}\\beta'' + \\dots\\right) = \\frac{1}{2} - \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)$\nHere, $\\beta$ and its derivatives $\\beta', \\beta'', \\dots$ are evaluated at $x$.\n\nNow we expand the products on the RHS:\nThe first term is $\\rho(x-\\epsilon, t) p_{+}(x-\\epsilon)$:\n$$\n\\left(\\rho - \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho + O(\\epsilon^3)\\right) \\left(\\frac{1}{2} + \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)\\right)\n$$\n$$\n= \\frac{1}{2}\\rho - \\frac{\\epsilon}{2}\\partial_x\\rho + \\frac{\\epsilon^2}{4}\\partial_{xx}\\rho + \\epsilon\\beta\\rho - \\epsilon^2\\beta\\partial_x\\rho - \\epsilon^2\\beta'\\rho + O(\\epsilon^3)\n$$\nThe second term is $\\rho(x+\\epsilon, t) p_{-}(x+\\epsilon)$:\n$$\n\\left(\\rho + \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho + O(\\epsilon^3)\\right) \\left(\\frac{1}{2} - \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)\\right)\n$$\n$$\n= \\frac{1}{2}\\rho + \\frac{\\epsilon}{2}\\partial_x\\rho + \\frac{\\epsilon^2}{4}\\partial_{xx}\\rho - \\epsilon\\beta\\rho - \\epsilon^2\\beta\\partial_x\\rho - \\epsilon^2\\beta'\\rho + O(\\epsilon^3)\n$$\nSumming these two terms, we collect powers of $\\epsilon$:\n- Terms of order $\\epsilon^0$: $\\frac{1}{2}\\rho + \\frac{1}{2}\\rho = \\rho$.\n- Terms of order $\\epsilon^1$: $(-\\frac{1}{2}\\partial_x\\rho + \\beta\\rho) + (\\frac{1}{2}\\partial_x\\rho - \\beta\\rho) = 0$.\n- Terms of order $\\epsilon^2$: $(\\frac{1}{4}\\partial_{xx}\\rho - \\beta\\partial_x\\rho - \\beta'\\rho) + (\\frac{1}{4}\\partial_{xx}\\rho - \\beta\\partial_x\\rho - \\beta'\\rho) = \\frac{1}{2}\\partial_{xx}\\rho - 2\\beta\\partial_x\\rho - 2\\beta'\\rho$.\n\nSo, the sum is $\\rho + \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\beta\\partial_x\\rho - 2\\beta'\\rho \\right) + O(\\epsilon^3)$.\nThe RHS of the master equation is this sum minus $\\rho(x,t)$:\n$$\n\\text{RHS} = \\rho + \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2(\\beta\\partial_x\\rho + \\beta'\\rho) \\right) + O(\\epsilon^3) - \\rho = \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) \\right) + O(\\epsilon^3)\n$$\nA more careful analysis shows that all terms of order $\\epsilon^3$ also vanish, making the residual $O(\\epsilon^4)$.\n\nEquating the LHS and RHS expansions:\n$$\n\\epsilon^2 \\partial_t \\rho + O(\\epsilon^4) = \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) \\right) + O(\\epsilon^4)\n$$\nDividing the entire equation by $\\epsilon^2$:\n$$\n\\partial_t \\rho + O(\\epsilon^2) = \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) + O(\\epsilon^2)\n$$\nIn the limit as $\\epsilon \\to 0$, we obtain the continuum partial differential equation (PDE):\n$$\n\\partial_t \\rho(x,t) = \\frac{1}{2}\\partial_{xx}\\rho(x,t) - 2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big)\n$$\nTo match the target form given in the problem statement, we rearrange this equation:\n$$\n\\partial_t \\rho(x,t) + 2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big) = \\frac{1}{2}\\partial_{xx}\\rho(x,t)\n$$\nThe target PDE is:\n$$\n\\partial_{t} \\rho(x,t) + \\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big) = D\\,\\partial_{xx} \\rho(x,t)\n$$\nBy comparing our derived PDE with the target form, we can identify the constant diffusion coefficient $D$ and the effective drift function $v(x)$.\nWe find that the diffusion coefficient is $D = \\frac{1}{2}$.\nThe advection term is identified by comparing $\\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big)$ with $2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big)$. This implies:\n$$\nv(x)\\rho(x,t) = 2\\beta(x)\\rho(x,t)\n$$\nSince this equality must hold for any arbitrary density profile $\\rho(x,t)$, we can conclude that the functions themselves must be equal:\n$$\nv(x) = 2\\beta(x)\n$$\nThis is the expression for the effective drift function in terms of the bias function $\\beta(x)$.",
            "answer": "$$\n\\boxed{2\\beta(x)}\n$$"
        },
        {
            "introduction": "A continuum description is incomplete without appropriate boundary conditions, which encode the system's interaction with its environment. This advanced exercise focuses on the critical step of deriving these macroscopic conditions from the microscopic rules governing agents at a domain's edge. By analyzing a scenario involving both reflection and absorption at a boundary, we will see how these agent-level behaviors systematically translate into a general Robin-type boundary condition, bridging the gap between discrete rules and continuum fields .",
            "id": "3732031",
            "problem": "Consider a one-dimensional half-line domain $x \\in [0,\\infty)$ populated by indistinguishable agents performing a Continuous-Time Random Walk (CTRW). The spatial lattice spacing is $\\Delta x > 0$, and each agent at an interior lattice site $i \\geq 1$ jumps to the neighboring sites $i-1$ or $i+1$ with equal rates $\\nu/2$, where $\\nu > 0$ is the total jump rate. Let $\\rho_i(t)$ denote the expected agent number density at site $i$ at time $t$, and let the continuum density be $\\rho(x,t)$ at position $x$ and time $t$. Assume the standard diffusive scaling limit holds, yielding the diffusion equation in the interior with diffusion coefficient $D = \\nu \\Delta x^2 / 2$.\n\nAt the boundary site $i=0$ (corresponding to $x=0$), impose the following agent-level rule to model reflection and absorption:\n- All attempted jumps from $i=0$ to the exterior ($i=-1$) are deterministically reflected into the domain to $i=1$ (reflection).\n- Independently of jumps, agents at $i=0$ are absorbed (removed from the system) with a constant killing rate $\\alpha > 0$ per unit time (absorption).\n\nThus, from $i=0$ there is both rightward transport into $i=1$ with rate $\\nu/2$ and absorption with rate $\\alpha$. Let $J(x,t)$ denote the continuum probability flux, defined by $J(x,t) = -D\\,\\partial_x \\rho(x,t)$.\n\nStarting from the master equation at the lattice level, derive the continuum boundary condition at $x=0$ in terms of $\\rho(0,t)$ and $J(0,t)$, by asymptotically matching the lattice boundary dynamics to the continuum field via a Taylor expansion $\\rho(\\Delta x,t) = \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t) + \\mathcal{O}(\\Delta x^2)$. Show that the resulting macroscopic boundary condition is of Robin type, where the outward flux at $x=0$ is proportional to the boundary density, and identify the proportionality coefficient as an analytic expression in the microscopic parameters.\n\nIn your derivation, explicitly justify:\n- How the interior diffusion equation arises from the CTRW and the identification $D = \\nu \\Delta x^2 / 2$.\n- How the lattice boundary equation for $\\rho_0(t)$, together with a quasi-steady boundary-layer approximation, yields a relation between $\\partial_x \\rho(0,t)$ and $\\rho(0,t)$.\n- How this relation translates to a Robin boundary condition connecting $J(0,t)$ and $\\rho(0,t)$, and how the Neumann (perfect reflection) and Dirichlet (perfect absorption) limits emerge as $\\alpha \\to 0$ and $\\alpha \\to \\infty$, respectively.\n\nAnswer specification:\n- Provide as your final answer only the analytic expression for the Robin boundary coefficient $\\kappa$ in terms of the microscopic parameters, without any additional text.\n- For unit consistency, $\\kappa$ must be expressed in meters per second if the underlying units are seconds for time and meters for length; however, do not include units in the final boxed answer.\n- No numerical evaluation or rounding is required.",
            "solution": "We begin with the Continuous-Time Random Walk (CTRW) on a one-dimensional lattice with spacing $\\Delta x$ and total jump rate $\\nu$. At interior sites $i \\geq 1$, the master equation for the expected density $\\rho_i(t)$ is\n$$\n\\frac{d}{dt}\\rho_i(t) \\;=\\; \\frac{\\nu}{2}\\,\\rho_{i+1}(t) \\;-\\; \\nu\\,\\rho_i(t) \\;+\\; \\frac{\\nu}{2}\\,\\rho_{i-1}(t) \\;=\\; \\frac{\\nu}{2}\\left(\\rho_{i+1}(t) - 2\\,\\rho_i(t) + \\rho_{i-1}(t)\\right).\n$$\nIntroducing the continuum density $\\rho(x,t)$ with $x = i\\,\\Delta x$, and expanding $\\rho_{i\\pm 1}(t)$ via Taylor series,\n$$\n\\rho_{i\\pm 1}(t) \\;=\\; \\rho(x,t) \\pm \\Delta x\\,\\partial_x \\rho(x,t) + \\frac{\\Delta x^2}{2}\\,\\partial_{xx} \\rho(x,t) + \\mathcal{O}(\\Delta x^3),\n$$\nwe obtain to leading order\n$$\n\\frac{d}{dt}\\rho(x,t) \\;=\\; \\frac{\\nu}{2}\\left(\\Delta x^2\\,\\partial_{xx} \\rho(x,t)\\right) \\;+\\; \\mathcal{O}(\\Delta x^3).\n$$\nTaking the diffusive scaling limit and neglecting higher-order terms leads to the diffusion equation\n$$\n\\partial_t \\rho(x,t) \\;=\\; D\\,\\partial_{xx} \\rho(x,t), \\quad \\text{with} \\quad D \\;=\\; \\frac{\\nu\\,\\Delta x^2}{2}.\n$$\n\nWe next analyze the boundary dynamics at $i=0$. By the stated rule, attempts to jump out of the domain are reflected to $i=1$, so the only transport coupling at $i=0$ is between $i=0$ and $i=1$, and there is independent absorption at $i=0$ with rate $\\alpha$. The master equation at the boundary site is\n$$\n\\frac{d}{dt}\\rho_0(t) \\;=\\; \\frac{\\nu}{2}\\,\\rho_1(t) \\;-\\; \\frac{\\nu}{2}\\,\\rho_0(t) \\;-\\; \\alpha\\,\\rho_0(t).\n$$\nThe first term $\\frac{\\nu}{2}\\rho_1(t)$ represents inflow from $i=1$ to $i=0$, the second term $\\frac{\\nu}{2}\\rho_0(t)$ represents outflow from $i=0$ to $i=1$, and the last term $\\alpha \\rho_0(t)$ is the absorption at $i=0$. To connect to the continuum description, we identify $\\rho_0(t) \\approx \\rho(0,t)$ and $\\rho_1(t) \\approx \\rho(\\Delta x,t)$ and invoke a Taylor expansion about $x=0$:\n$$\n\\rho(\\Delta x,t) \\;=\\; \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t) + \\mathcal{O}(\\Delta x^2).\n$$\n\nWe now invoke a quasi-steady approximation for the boundary site, justified when the boundary layer relaxes on a timescale that is fast compared to the macroscopic evolution. Setting $\\frac{d}{dt}\\rho_0(t) \\approx 0$ and substituting $\\rho_1(t) \\approx \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t)$ yields\n$$\n0 \\;=\\; \\frac{\\nu}{2}\\left[\\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t)\\right] \\;-\\; \\frac{\\nu}{2}\\,\\rho(0,t) \\;-\\; \\alpha\\,\\rho(0,t),\n$$\nwhich simplifies to\n$$\n\\frac{\\nu}{2}\\,\\Delta x\\,\\partial_x \\rho(0,t) \\;=\\; \\alpha\\,\\rho(0,t).\n$$\nHence we obtain the boundary relation\n$$\n\\partial_x \\rho(0,t) \\;=\\; \\frac{2\\,\\alpha}{\\nu\\,\\Delta x}\\,\\rho(0,t).\n$$\n\nThe continuum flux is defined by $J(x,t) = -D\\,\\partial_x \\rho(x,t)$. Evaluating at $x=0$ and substituting the boundary relation, we find\n$$\nJ(0,t) \\;=\\; -D\\,\\partial_x \\rho(0,t) \\;=\\; -\\left(\\frac{\\nu\\,\\Delta x^2}{2}\\right)\\left(\\frac{2\\,\\alpha}{\\nu\\,\\Delta x}\\right)\\rho(0,t) \\;=\\; -\\alpha\\,\\Delta x\\,\\rho(0,t).\n$$\nInterpreting $J(0,t)$ as positive in the $+x$ direction, the outward normal at $x=0$ points toward decreasing $x$, so the outward flux is $-J(0,t)$. Therefore, the macroscopic boundary condition takes the Robin form\n$$\n\\text{(outward flux at } x=0)\\;=\\; \\kappa\\,\\rho(0,t), \\quad \\text{with} \\quad \\kappa \\;=\\; \\alpha\\,\\Delta x.\n$$\nDimensional consistency holds: $\\alpha$ has dimensions of inverse time, $\\Delta x$ has dimensions of length, and hence $\\kappa$ has dimensions of length per time.\n\nFinally, we confirm the limiting cases:\n- Perfect reflection corresponds to $\\alpha \\to 0$, giving $\\kappa \\to 0$, i.e., zero outward flux, which is the Neumann condition $J(0,t) = 0$.\n- Perfect absorption corresponds to $\\alpha \\to \\infty$, giving $\\kappa \\to \\infty$, which enforces $\\rho(0,t) \\to 0$ to keep the flux finite, i.e., the Dirichlet condition $\\rho(0,t) = 0$.\n\nThus, the Robin coefficient connecting agent-level absorption at the boundary to the macroscopic flux-density relation is identified as\n$$\n\\kappa \\;=\\; \\alpha\\,\\Delta x.\n$$\nPer the problem specification, this quantity should be reported in meters per second if time is measured in seconds and length in meters; no units are to be included in the final boxed answer.",
            "answer": "$$\\boxed{\\alpha\\,\\Delta x}$$"
        }
    ]
}