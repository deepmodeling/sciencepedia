{
    "hands_on_practices": [
        {
            "introduction": "从理论到实践的第一步，是从最基础的智能体随机游走模型中推导出宏观扩散方程。这个练习将带你深入了解如何将单个智能体的微观跳跃行为（如跳跃步长和频率）与宏观扩散系数$D$直接联系起来。通过分析两种常见的微观更新机制——连续时间泊松过程和离散时间同步更新——你将掌握从第一性原理出发，量化随机运动如何产生扩散现象的核心技能。",
            "id": "3732099",
            "problem": "考虑一个连续空间中的一维基于智能体的模型，其中每个智能体执行形式为 $\\varepsilon \\,\\xi$ 的独立同分布的跳跃，其中 $\\varepsilon>0$ 是一个小尺度长度，$\\xi$ 是一个标量随机变量，满足 $\\mathbb{E}[\\xi]=0$ 和 $\\operatorname{Var}(\\xi)=\\sigma^{2}\\in(0,\\infty)$。使用了两种不同的微观更新机制：\n\n$($i$)$ 连续时间更新：每个智能体都配备一个速率为 $\\lambda>0$ 的独立泊松时钟。当智能体的时钟响起时，它会瞬时进行一次大小为 $\\varepsilon \\,\\xi$ 的跳跃，且连续的 $\\xi$ 彼此独立，也与时钟无关。\n\n$($ii$)$ 离散时间更新：每个智能体在时间 $t=n\\,\\Delta t$（$n\\in\\mathbb{N}$）同步更新，时间步长 $\\Delta t>0$ 固定。每次更新时，智能体进行一次大小为 $\\varepsilon \\,\\xi$ 的跳跃，且连续的 $\\xi$ 彼此独立。\n\n假设存在一个由大量独立智能体组成的群体，其经验密度在标准的扩散宏观标度 $\\varepsilon\\to 0$ 下，并在有限的宏观时间内，存在一个确定性连续统极限。该极限由形式为 $\\partial_{t}\\rho=D\\,\\partial_{xx}\\rho$ 的扩散方程所描述，其中 $D$ 是一个恒定的宏观扩散系数。\n\n仅使用独立增量的基本定义、泊松过程的性质，以及扩散的定义性质——即宏观均方位移随时间线性增长，$\\mathbb{E}\\!\\left[(X(t)-X(0))^{2}\\right]\\sim 2\\,D\\,t$，推导每种机制下扩散系数 $D$ 关于 $\\varepsilon$、$\\sigma^{2}$ 和更新参数的解析表达式。将您的最终答案表示为一个行矩阵 $(D_{\\mathrm{ct}},\\,D_{\\mathrm{dt}})$，其中 $D_{\\mathrm{ct}}$ 对应于连续时间泊松时钟的情况，$D_{\\mathrm{dt}}$ 对应于离散时间更新的情况。无需四舍五入。在最终的方框答案中不要包含单位。",
            "solution": "该问题要求推导两种不同微观基于智能体的模型中的宏观扩散系数 $D$。推导将基于进行随机游走的粒子的均方位移（MSD）与扩散系数之间的基本关系，对于一维系统，该关系在大时间 $t$ 下由 $\\mathbb{E}[(X(t)-X(0))^2] \\sim 2Dt$ 给出。我们将分别计算每种情况下单个智能体的MSD，并从中提取 $D$ 的相应表达式。\n\n设 $X(t)$ 是单个智能体在时间 $t$ 的位置。不失一般性，我们可以设定初始位置为 $X(0)=0$。在稍后的时间 $t$，其位置是截至该时间发生的所有跳跃的总和。设 $N(t)$ 是到时间 $t$ 为止发生的跳跃次数。第 $i$ 次跳跃是一个随机变量 $J_i = \\varepsilon \\xi_i$，其中 $\\xi_i$ 是独立同分布（i.i.d.）的随机变量，其均值为 $\\mathbb{E}[\\xi_i]=0$，方差为 $\\operatorname{Var}(\\xi_i)=\\sigma^2$。\n\n在时间 $t$ 的位置由下式给出：\n$$X(t) = \\sum_{i=1}^{N(t)} J_i$$\n我们需要计算MSD，由于 $X(0)=0$，即为 $\\mathbb{E}[X(t)^2]$。\n\n首先，让我们确定单次跳跃 $J_i$ 的统计特性。\n一次跳跃的均值为：\n$$\\mathbb{E}[J_i] = \\mathbb{E}[\\varepsilon \\xi_i] = \\varepsilon \\mathbb{E}[\\xi_i] = \\varepsilon \\cdot 0 = 0$$\n一次跳跃的平方的均值与其方差有关：\n$$\\mathbb{E}[J_i^2] = \\operatorname{Var}(J_i) + (\\mathbb{E}[J_i])^2$$\n一次跳跃的方差为：\n$$\\operatorname{Var}(J_i) = \\operatorname{Var}(\\varepsilon \\xi_i) = \\varepsilon^2 \\operatorname{Var}(\\xi_i) = \\varepsilon^2 \\sigma^2$$\n因此，一次跳跃的平方的均值为：\n$$\\mathbb{E}[J_i^2] = \\varepsilon^2 \\sigma^2 + 0^2 = \\varepsilon^2 \\sigma^2$$\n\n现在我们使用全期望定律，通过以跳跃次数 $N(t)$为条件来计算MSD，即 $\\mathbb{E}[X(t)^2]$。\n$$\\mathbb{E}[X(t)^2] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\left(\\sum_{i=1}^{N(t)} J_i\\right)^2 \\middle| N(t) \\right] \\right]$$\n让我们计算对于固定跳跃次数 $N(t)=n$ 时的内层期望。\n$$\\mathbb{E}\\left[ \\left(\\sum_{i=1}^{n} J_i\\right)^2 \\right] = \\mathbb{E}\\left[ \\sum_{i=1}^{n} J_i^2 + \\sum_{i \\neq j}^{n} J_i J_j \\right] = \\sum_{i=1}^{n} \\mathbb{E}[J_i^2] + \\sum_{i \\neq j}^{n} \\mathbb{E}[J_i J_j]$$\n由于连续的跳跃 $J_i$ 是独立的且均值为零，对于 $i \\neq j$：\n$$\\mathbb{E}[J_i J_j] = \\mathbb{E}[J_i] \\mathbb{E}[J_j] = 0 \\cdot 0 = 0$$\n因此，交叉项之和为零。表达式简化为：\n$$\\mathbb{E}\\left[ \\left(\\sum_{i=1}^{n} J_i\\right)^2 \\right] = \\sum_{i=1}^{n} \\mathbb{E}[J_i^2] = \\sum_{i=1}^{n} \\varepsilon^2 \\sigma^2 = n \\varepsilon^2 \\sigma^2$$\n这个结果被称为沃尔德恒等式，它成立的原因是跳跃是独立同分布的，并且跳跃次数 $n$ 是一个停时（在所考虑的两种情况下都成立）。\n\n将此结果代回全期望定律：\n$$\\mathbb{E}[X(t)^2] = \\mathbb{E}[N(t) \\varepsilon^2 \\sigma^2] = \\varepsilon^2 \\sigma^2 \\mathbb{E}[N(t)]$$\n问题现在简化为为两种更新机制中的每一种找到期望的跳跃次数 $\\mathbb{E}[N(t)]$。\n\n$($i$)$ 连续时间更新（泊松时钟）：\n在这种情况下，一个智能体到时间 $t$ 为止执行的跳跃次数 $N(t)$ 服从速率为 $\\lambda$ 的泊松过程。长度为 $t$ 的时间区间内的事件数是一个参数为 $\\lambda t$ 的泊松分布随机变量。\n$$N(t) \\sim \\text{Poisson}(\\lambda t)$$\n参数为 $\\mu$ 的泊松随机变量的期望值为 $\\mu$。因此，期望的跳跃次数是：\n$$\\mathbb{E}[N(t)] = \\lambda t$$\n将此代入我们的MSD公式：\n$$\\mathbb{E}[X(t)^2] = \\varepsilon^2 \\sigma^2 (\\lambda t) = (\\lambda \\varepsilon^2 \\sigma^2) t$$\n我们将此结果与宏观扩散定律 $\\mathbb{E}[X(t)^2] = 2 D_{\\mathrm{ct}} t$ 进行匹配。\n$$2 D_{\\mathrm{ct}} t = \\lambda \\varepsilon^2 \\sigma^2 t$$\n求解扩散系数 $D_{\\mathrm{ct}}$ 得：\n$$D_{\\mathrm{ct}} = \\frac{1}{2} \\lambda \\varepsilon^2 \\sigma^2$$\n\n$($ii$)$ 离散时间更新（同步）：\n此处，跳跃在时间 $t_n = n \\Delta t$（$n \\in \\mathbb{N}$）确定性地发生。对于给定的宏观时间 $t$，已发生的跳跃次数是到时间 $t$ 为止完成的更新步数。该次数由向下取整函数给出：\n$$N(t) = \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\n在这个模型中，对于固定的时间 $t$，$N(t)$ 不是一个随机变量。因此，它的期望就是它的值：\n$$\\mathbb{E}[N(t)] = N(t) = \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\n于是MSD为：\n$$\\mathbb{E}[X(t)^2] = \\varepsilon^2 \\sigma^2 \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\n问题陈述该系统是在有限的宏观时间内观察的，这意味着 $t$ 相对于微观时间步长 $\\Delta t$ 很大，即 $t \\gg \\Delta t$。在这种情况下，我们可以用其自变量来近似向下取整函数：\n$$\\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor \\approx \\frac{t}{\\Delta t}$$\n在定义MSD线性增长的极限中，这种近似是精确的。因此，对于大的 $t$：\n$$\\mathbb{E}[X(t)^2] \\sim \\varepsilon^2 \\sigma^2 \\frac{t}{\\Delta t} = \\left(\\frac{\\varepsilon^2 \\sigma^2}{\\Delta t}\\right) t$$\n我们将此渐近行为与宏观定律 $\\mathbb{E}[X(t)^2] \\sim 2 D_{\\mathrm{dt}} t$ 进行匹配。\n$$2 D_{\\mathrm{dt}} t = \\frac{\\varepsilon^2 \\sigma^2}{\\Delta t} t$$\n求解扩散系数 $D_{\\mathrm{dt}}$ 得：\n$$D_{\\mathrm{dt}} = \\frac{\\varepsilon^2 \\sigma^2}{2 \\Delta t}$$\n\n最终答案是包含两个推导出的表达式的行矩阵 $(D_{\\mathrm{ct}}, D_{\\mathrm{dt}})$。\n$D_{\\mathrm{ct}} = \\frac{1}{2} \\lambda \\varepsilon^2 \\sigma^2$\n$D_{\\mathrm{dt}} = \\frac{\\varepsilon^2 \\sigma^2}{2 \\Delta t}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} \\lambda \\varepsilon^{2} \\sigma^{2}  \\frac{\\varepsilon^{2} \\sigma^{2}}{2 \\Delta t}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了纯扩散过程之后，我们来考虑一个更普遍的情形：当智能体的运动存在微弱的系统性偏好时会发生什么？本练习通过在智能体的跳跃概率中引入一个微小的偏置，来推导出一个包含平流（或漂移）项的宏观方程。你将通过泰勒展开技术，亲身体验如何从底层的非对称随机游走中涌现出描述定向运动的平流-扩散偏微分方程，这对于模拟趋化性或对外部场的响应等现象至关重要。",
            "id": "3732081",
            "problem": "考虑一个一维基于智能体的模型，该模型建立在网格尺寸为 $\\epsilon  0$ 的格子上，在每个持续时间为 $\\epsilon^{2}$ 的离散时间步长，位于位置 $x$ 的智能体以概率 $p_{+}(x)$ 跳到 $x+\\epsilon$，以概率 $p_{-}(x)$ 跳到 $x-\\epsilon$。假设跳跃概率包含一个 $O(\\epsilon)$ 阶的弱偏差：\n$$\np_{+}(x) = \\frac{1}{2} + \\epsilon \\beta(x), \\qquad p_{-}(x) = \\frac{1}{2} - \\epsilon \\beta(x),\n$$\n其中 $\\beta(x)$ 是 $x$ 的一个光滑有界函数，并且对于所有足够小的 $\\epsilon$，概率保持在 $[0,1]$ 区间内。令 $\\rho^{\\epsilon}(x,t)$ 表示在格点 $x$ 和时间 $t$ 的智能体的期望数密度。假设初始密度在宏观尺度上是光滑的，并且智能体的运动在所有智能体之间是独立同分布的。\n\n从 $\\rho^{\\epsilon}(x,t)$ 的离散守恒（主）方程出发，并使用空间增量为 $O(\\epsilon)$、时间增量为 $O(\\epsilon^{2})$ 的抛物线标度，推导当 $\\epsilon \\to 0$ 时的连续极限，并得到宏观密度 $\\rho(x,t)$ 的平流-扩散偏微分方程（PDE），其形式为\n$$\n\\partial_{t} \\rho(x,t) + \\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big) = D\\,\\partial_{xx} \\rho(x,t),\n$$\n其中扩散系数 $D$ 为常数。请明确地用 $\\beta(x)$ 表示有效的漂移函数 $v(x)$。\n\n你的最终答案必须是 $v(x)$ 的一个单一的、没有单位的闭式解析表达式。",
            "solution": "该问题要求从一维格子上的微观基于智能体的模型推导宏观平流-扩散方程。推导过程首先是写出智能体密度的主方程，然后进行抛物线标度下的泰勒展开，最后取连续极限。\n\n令 $\\rho^{\\epsilon}(x,t)$ 为在格点 $x$ 和时间 $t$ 的智能体的期望数密度。格子间距为 $\\epsilon$，离散时间步长为 $\\Delta t = \\epsilon^2$。位于位置 $y$ 的智能体以概率 $p_{+}(y)$ 跳到 $y+\\epsilon$，以概率 $p_{-}(y)$ 跳到 $y-\\epsilon$。概率由 $p_{+}(y) = \\frac{1}{2} + \\epsilon \\beta(y)$ 和 $p_{-}(y) = \\frac{1}{2} - \\epsilon \\beta(y)$ 给出。我们注意到 $p_{+}(y) + p_{-}(y) = 1$，这意味着智能体总是跳到相邻的位置，从不原地不动。\n\n密度 $\\rho^{\\epsilon}(x,t)$ 的主方程描述了智能体的守恒。在一个时间步长内，位置 $x$ 的密度变化是智能体从相邻位置跳入减去从位置 $x$ 跳出的净结果。\n$$\n\\rho^{\\epsilon}(x, t+\\epsilon^2) - \\rho^{\\epsilon}(x, t) = \\rho^{\\epsilon}(x-\\epsilon, t) p_{+}(x-\\epsilon) + \\rho^{\\epsilon}(x+\\epsilon, t) p_{-}(x+\\epsilon) - \\rho^{\\epsilon}(x, t) \\left( p_{+}(x) + p_{-}(x) \\right)\n$$\n由于 $p_{+}(x) + p_{-}(x) = 1$，主方程简化为：\n$$\n\\rho^{\\epsilon}(x, t+\\epsilon^2) - \\rho^{\\epsilon}(x, t) = \\rho^{\\epsilon}(x-\\epsilon, t) p_{+}(x-\\epsilon) + \\rho^{\\epsilon}(x+\\epsilon, t) p_{-}(x+\\epsilon) - \\rho^{\\epsilon}(x, t)\n$$\n为了找到当 $\\epsilon \\to 0$ 时的连续极限，我们假设 $\\rho^{\\epsilon}(x,t)$ 收敛到一个光滑函数 $\\rho(x,t)$。然后我们可以在点 $(x,t)$ 周围对主方程中的所有项进行泰勒级数展开。\n\n方程的左侧（LHS）按时间展开：\n$$\n\\rho(x, t+\\epsilon^2) - \\rho(x, t) = \\left( \\rho + \\epsilon^2 \\partial_t \\rho + O(\\epsilon^4) \\right) - \\rho = \\epsilon^2 \\partial_t \\rho + O(\\epsilon^4)\n$$\n其中 $\\rho$ 及其导数在 $(x,t)$ 处求值。\n\n右侧（RHS）涉及对密度 $\\rho$ 和概率函数 $\\beta(x)$ 的空间展开。\n首先，我们展开密度函数 $\\rho(x \\pm \\epsilon, t)$：\n$$\n\\rho(x \\pm \\epsilon, t) = \\rho \\pm \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho \\pm \\frac{\\epsilon^3}{6} \\partial_{xxx} \\rho + O(\\epsilon^4)\n$$\n接下来，我们展开概率函数。假设函数 $\\beta(x)$ 是光滑的。\n$p_{+}(x-\\epsilon) = \\frac{1}{2} + \\epsilon \\beta(x-\\epsilon) = \\frac{1}{2} + \\epsilon \\left(\\beta - \\epsilon \\beta' + \\frac{\\epsilon^2}{2}\\beta'' - \\dots\\right) = \\frac{1}{2} + \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)$\n$p_{-}(x+\\epsilon) = \\frac{1}{2} - \\epsilon \\beta(x+\\epsilon) = \\frac{1}{2} - \\epsilon \\left(\\beta + \\epsilon \\beta' + \\frac{\\epsilon^2}{2}\\beta'' + \\dots\\right) = \\frac{1}{2} - \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)$\n这里，$\\beta$ 及其导数 $\\beta', \\beta'', \\dots$ 在 $x$ 处求值。\n\n现在我们展开 RHS 上的乘积：\n第一项是 $\\rho(x-\\epsilon, t) p_{+}(x-\\epsilon)$：\n$$\n\\left(\\rho - \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho + O(\\epsilon^3)\\right) \\left(\\frac{1}{2} + \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)\\right)\n$$\n$$\n= \\frac{1}{2}\\rho - \\frac{\\epsilon}{2}\\partial_x\\rho + \\frac{\\epsilon^2}{4}\\partial_{xx}\\rho + \\epsilon\\beta\\rho - \\epsilon^2\\beta\\partial_x\\rho - \\epsilon^2\\beta'\\rho + O(\\epsilon^3)\n$$\n第二项是 $\\rho(x+\\epsilon, t) p_{-}(x+\\epsilon)$：\n$$\n\\left(\\rho + \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho + O(\\epsilon^3)\\right) \\left(\\frac{1}{2} - \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)\\right)\n$$\n$$\n= \\frac{1}{2}\\rho + \\frac{\\epsilon}{2}\\partial_x\\rho + \\frac{\\epsilon^2}{4}\\partial_{xx}\\rho - \\epsilon\\beta\\rho - \\epsilon^2\\beta\\partial_x\\rho - \\epsilon^2\\beta'\\rho + O(\\epsilon^3)\n$$\n将这两项相加，我们收集 $\\epsilon$ 的幂次：\n- $\\epsilon^0$ 阶项：$\\frac{1}{2}\\rho + \\frac{1}{2}\\rho = \\rho$。\n- $\\epsilon^1$ 阶项：$(-\\frac{1}{2}\\partial_x\\rho + \\beta\\rho) + (\\frac{1}{2}\\partial_x\\rho - \\beta\\rho) = 0$。\n- $\\epsilon^2$ 阶项：$(\\frac{1}{4}\\partial_{xx}\\rho - \\beta\\partial_x\\rho - \\beta'\\rho) + (\\frac{1}{4}\\partial_{xx}\\rho - \\beta\\partial_x\\rho - \\beta'\\rho) = \\frac{1}{2}\\partial_{xx}\\rho - 2\\beta\\partial_x\\rho - 2\\beta'\\rho$。\n\n所以，和为 $\\rho + \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\beta\\partial_x\\rho - 2\\beta'\\rho \\right) + O(\\epsilon^3)$。\n主方程的 RHS 是这个和减去 $\\rho(x,t)$：\n$$\n\\text{RHS} = \\rho + \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2(\\beta\\partial_x\\rho + \\beta'\\rho) \\right) + O(\\epsilon^3) - \\rho = \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) \\right) + O(\\epsilon^3)\n$$\n更仔细的分析表明，所有 $\\epsilon^3$ 阶的项也都消失了，使得余项为 $O(\\epsilon^4)$。\n\n将 LHS 和 RHS 的展开式相等：\n$$\n\\epsilon^2 \\partial_t \\rho + O(\\epsilon^4) = \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) \\right) + O(\\epsilon^4)\n$$\n将整个方程除以 $\\epsilon^2$：\n$$\n\\partial_t \\rho + O(\\epsilon^2) = \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) + O(\\epsilon^2)\n$$\n在极限 $\\epsilon \\to 0$ 下，我们得到连续偏微分方程（PDE）：\n$$\n\\partial_t \\rho(x,t) = \\frac{1}{2}\\partial_{xx}\\rho(x,t) - 2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big)\n$$\n为了匹配问题陈述中给出的目标形式，我们重新排列这个方程：\n$$\n\\partial_t \\rho(x,t) + 2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big) = \\frac{1}{2}\\partial_{xx}\\rho(x,t)\n$$\n目标 PDE 是：\n$$\n\\partial_{t} \\rho(x,t) + \\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big) = D\\,\\partial_{xx} \\rho(x,t)\n$$\n通过将我们推导的 PDE 与目标形式进行比较，我们可以确定常数扩散系数 $D$ 和有效漂移函数 $v(x)$。\n我们发现扩散系数为 $D = \\frac{1}{2}$。\n平流项通过比较 $\\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big)$ 和 $2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big)$ 来确定。这意味着：\n$$\nv(x)\\rho(x,t) = 2\\beta(x)\\rho(x,t)\n$$\n由于这个等式必须对任意密度分布 $\\rho(x,t)$ 都成立，我们可以得出结论，函数本身必须相等：\n$$\nv(x) = 2\\beta(x)\n$$\n这就是有效漂移函数用偏差函数 $\\beta(x)$ 表示的表达式。",
            "answer": "$$\n\\boxed{2\\beta(x)}\n$$"
        },
        {
            "introduction": "真实的物理系统总是有边界的，而智能体在边界上的行为会深刻影响整个系统的宏观动力学。这个压轴练习将探讨一个关键问题：如何将智能体在区域边界的微观规则（如反射或吸收）转化为连续介质模型的宏观边界条件。你将从晶格上的主方程出发，推导出一个通用的罗宾（Robin）型边界条件，并理解它如何统一地描述了完全反射（诺伊曼，Neumann）和完全吸收（狄利克雷，Dirichlet）这两种极限情况。",
            "id": "3732031",
            "problem": "考虑一个一维半线区域 $x \\in [0,\\infty)$，其中分布着进行连续时间随机游走（CTRW）的不可区分的粒子。空间晶格间距为 $\\Delta x  0$，每个位于内部晶格点 $i \\geq 1$ 的粒子以相等的速率 $\\nu/2$ 跳跃到相邻的格点 $i-1$ 或 $i+1$，其中 $\\nu  0$ 是总跳跃速率。令 $\\rho_i(t)$ 表示在时刻 $t$ 格点 $i$ 上的期望粒子数密度，令 $\\rho(x,t)$ 表示在位置 $x$ 和时刻 $t$ 的连续密度。假设标准的扩散标度极限成立，从而在内部区域得到扩散方程，其扩散系数为 $D = \\nu \\Delta x^2 / 2$。\n\n在边界格点 $i=0$（对应于 $x=0$）处，施加以下粒子层面的规则来模拟反射和吸收：\n- 所有从 $i=0$ 到外部（$i=-1$）的尝试跳跃都被确定性地反射回区域内，到达 $i=1$（反射）。\n- 与跳跃无关，位于 $i=0$ 的粒子以恒定的杀除率 $\\alpha  0$（单位时间）被吸收（从系统中移除）（吸收）。\n\n因此，从 $i=0$ 出发，既有以速率 $\\nu/2$ 向右输运到 $i=1$ 的过程，也有以速率 $\\alpha$ 被吸收的过程。令 $J(x,t)$ 表示连续概率流，定义为 $J(x,t) = -D\\,\\partial_x \\rho(x,t)$。\n\n从晶格层面的主方程出发，通过泰勒展开 $\\rho(\\Delta x,t) = \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t) + \\mathcal{O}(\\Delta x^2)$，将晶格边界动力学与连续场进行渐近匹配，从而推导出以 $\\rho(0,t)$ 和 $J(0,t)$ 表示的在 $x=0$ 处的连续边界条件。证明所得到的宏观边界条件是 Robin 型的，即在 $x=0$ 处的向外通量与边界密度成正比，并确定该比例系数作为微观参数的解析表达式。\n\n在您的推导中，明确论证：\n- 内部扩散方程如何从 CTRW 和关系式 $D = \\nu \\Delta x^2 / 2$ 中产生。\n- 针对 $\\rho_0(t)$ 的晶格边界方程，如何结合准稳态边界层近似，得到 $\\partial_x \\rho(0,t)$ 与 $\\rho(0,t)$ 之间的关系。\n- 这个关系如何转化为连接 $J(0,t)$ 和 $\\rho(0,t)$ 的 Robin 边界条件，以及当 $\\alpha \\to 0$ 和 $\\alpha \\to \\infty$ 时，诺伊曼（Neumann，完美反射）和狄利克雷（Dirichlet，完美吸收）极限如何出现。\n\n答案规格：\n- 最终答案只提供 Robin 边界系数 $\\kappa$ 关于微观参数的解析表达式，不含任何额外文本。\n- 为保证单位一致性，如果时间的基本单位是秒，长度的基本单位是米，则 $\\kappa$ 必须以米/秒表示；但是，最终的方框答案中不要包含单位。\n- 无需进行数值计算或四舍五入。",
            "solution": "我们从一维晶格上的连续时间随机游走（CTRW）开始，其晶格间距为 $\\Delta x$，总跳跃速率为 $\\nu$。在内部格点 $i \\geq 1$ 处，期望密度 $\\rho_i(t)$ 的主方程为\n$$\n\\frac{d}{dt}\\rho_i(t) \\;=\\; \\frac{\\nu}{2}\\,\\rho_{i+1}(t) \\;-\\; \\nu\\,\\rho_i(t) \\;+\\; \\frac{\\nu}{2}\\,\\rho_{i-1}(t) \\;=\\; \\frac{\\nu}{2}\\left(\\rho_{i+1}(t) - 2\\,\\rho_i(t) + \\rho_{i-1}(t)\\right).\n$$\n引入连续密度 $\\rho(x,t)$，其中 $x = i\\,\\Delta x$，并通过泰勒级数展开 $\\rho_{i\\pm 1}(t)$，\n$$\n\\rho_{i\\pm 1}(t) \\;=\\; \\rho(x,t) \\pm \\Delta x\\,\\partial_x \\rho(x,t) + \\frac{\\Delta x^2}{2}\\,\\partial_{xx} \\rho(x,t) + \\mathcal{O}(\\Delta x^3),\n$$\n我们得到一阶主导项\n$$\n\\frac{d}{dt}\\rho(x,t) \\;=\\; \\frac{\\nu}{2}\\left(\\Delta x^2\\,\\partial_{xx} \\rho(x,t)\\right) \\;+\\; \\mathcal{O}(\\Delta x^3).\n$$\n取扩散标度极限并忽略高阶项，可得扩散方程\n$$\n\\partial_t \\rho(x,t) \\;=\\; D\\,\\partial_{xx} \\rho(x,t), \\quad \\text{其中} \\quad D \\;=\\; \\frac{\\nu\\,\\Delta x^2}{2}.\n$$\n\n接下来我们分析在 $i=0$ 处的边界动力学。根据所述规则，尝试跳出区域的粒子被反射到 $i=1$，因此在 $i=0$ 处唯一的输运耦合发生在 $i=0$ 和 $i=1$ 之间，并且在 $i=0$ 处存在以速率 $\\alpha$ 发生的独立吸收。边界格点的主方程是\n$$\n\\frac{d}{dt}\\rho_0(t) \\;=\\; \\frac{\\nu}{2}\\,\\rho_1(t) \\;-\\; \\frac{\\nu}{2}\\,\\rho_0(t) \\;-\\; \\alpha\\,\\rho_0(t).\n$$\n第一项 $\\frac{\\nu}{2}\\rho_1(t)$ 表示从 $i=1$ 到 $i=0$ 的流入，第二项 $\\frac{\\nu}{2}\\rho_0(t)$ 表示从 $i=0$ 到 $i=1$ 的流出，最后一项 $\\alpha \\rho_0(t)$ 是在 $i=0$ 处的吸收。为了与连续描述联系起来，我们认定 $\\rho_0(t) \\approx \\rho(0,t)$ 和 $\\rho_1(t) \\approx \\rho(\\Delta x,t)$，并应用关于 $x=0$ 的泰勒展开：\n$$\n\\rho(\\Delta x,t) \\;=\\; \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t) + \\mathcal{O}(\\Delta x^2).\n$$\n\n我们现在对边界格点采用准稳态近似，当边界层的弛豫时间尺度远快于宏观演化时，这种近似是合理的。令 $\\frac{d}{dt}\\rho_0(t) \\approx 0$ 并代入 $\\rho_1(t) \\approx \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t)$，得到\n$$\n0 \\;=\\; \\frac{\\nu}{2}\\left[\\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t)\\right] \\;-\\; \\frac{\\nu}{2}\\,\\rho(0,t) \\;-\\; \\alpha\\,\\rho(0,t),\n$$\n化简为\n$$\n\\frac{\\nu}{2}\\,\\Delta x\\,\\partial_x \\rho(0,t) \\;=\\; \\alpha\\,\\rho(0,t).\n$$\n因此我们得到边界关系\n$$\n\\partial_x \\rho(0,t) \\;=\\; \\frac{2\\,\\alpha}{\\nu\\,\\Delta x}\\,\\rho(0,t).\n$$\n\n连续通量定义为 $J(x,t) = -D\\,\\partial_x \\rho(x,t)$。在 $x=0$ 处求值并代入边界关系，我们发现\n$$\nJ(0,t) \\;=\\; -D\\,\\partial_x \\rho(0,t) \\;=\\; -\\left(\\frac{\\nu\\,\\Delta x^2}{2}\\right)\\left(\\frac{2\\,\\alpha}{\\nu\\,\\Delta x}\\right)\\rho(0,t) \\;=\\; -\\alpha\\,\\Delta x\\,\\rho(0,t).\n$$\n将 $J(0,t)$ 解释为 $+x$ 方向为正，则在 $x=0$ 处的外法线指向 $x$ 减小的方向，因此向外通量为 $-J(0,t)$。因此，宏观边界条件呈 Robin 型\n$$\n\\text{(在 } x=0 \\text{ 处的向外通量)}\\;=\\; \\kappa\\,\\rho(0,t), \\quad \\text{其中} \\quad \\kappa \\;=\\; \\alpha\\,\\Delta x.\n$$\n量纲一致性成立：$\\alpha$ 的量纲是时间的倒数，$\\Delta x$ 的量纲是长度，因此 $\\kappa$ 的量纲是长度每时间。\n\n最后，我们验证极限情况：\n- 完美反射对应于 $\\alpha \\to 0$，得到 $\\kappa \\to 0$，即零向外通量，这是诺伊曼（Neumann）条件 $J(0,t) = 0$。\n- 完美吸收对应于 $\\alpha \\to \\infty$，得到 $\\kappa \\to \\infty$，为保持通量有限，这要求 $\\rho(0,t) \\to 0$，即狄利克雷（Dirichlet）条件 $\\rho(0,t) = 0$。\n\n因此，将边界处粒子层面的吸收与宏观通量-密度关系联系起来的 Robin 系数被确定为\n$$\n\\kappa \\;=\\; \\alpha\\,\\Delta x.\n$$\n根据问题说明，如果时间以秒为单位，长度以米为单位，则该量应以米/秒报告；最终的方框答案中不应包含单位。",
            "answer": "$$\\boxed{\\alpha\\,\\Delta x}$$"
        }
    ]
}