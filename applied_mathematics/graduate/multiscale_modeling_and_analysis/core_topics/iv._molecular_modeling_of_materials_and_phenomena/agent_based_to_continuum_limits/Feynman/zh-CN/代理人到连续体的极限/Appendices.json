{
    "hands_on_practices": [
        {
            "introduction": "从微观尺度上智能体的随机运动过渡到宏观尺度上的连续模型，最基本的一步是理解扩散现象的起源。本练习将指导您从第一性原理出发，推导宏观扩散系数，揭示其如何依赖于微观层面的跳跃频率和跳跃大小的方差。通过这个实践 ，您将掌握连接这两个尺度的关键数学工具——均方根位移。",
            "id": "3732099",
            "problem": "考虑一个在连续空间中的$1$维基于智能体的模型，其中每个智能体执行形式为 $\\varepsilon \\,\\xi$ 的独立同分布跳跃，$\\varepsilon>0$ 是一个小长度尺度，$\\xi$ 是一个标量随机变量，其期望为 $\\mathbb{E}[\\xi]=0$，方差为 $\\operatorname{Var}(\\xi)=\\sigma^{2}\\in(0,\\infty)$。使用了两种不同的微观更新机制：\n\n$($i$)$ 连续时间更新：每个智能体都配备一个速率为 $\\lambda>0$ 的独立泊松时钟。当智能体的时钟响起时，它会瞬间进行一次大小为 $\\varepsilon \\,\\xi$ 的跳跃，历次的 $\\xi$ 相互独立，且与时钟无关。\n\n$($ii$)$ 离散时间更新：每个智能体在时间 $t=n\\,\\Delta t$（$n\\in\\mathbb{N}$）同步更新，时间步长 $\\Delta t>0$ 是固定的。在每次更新时，智能体进行一次大小为 $\\varepsilon \\,\\xi$ 的跳跃，历次的 $\\xi$ 相互独立。\n\n假设有一个由大量独立智能体组成的群体，其经验密度在标准的扩散宏观标度 $\\varepsilon\\to 0$ 下，并在有限的宏观时间内，存在一个确定性的连续谱极限，该极限由形式为 $\\partial_{t}\\rho=D\\,\\partial_{xx}\\rho$ 的扩散方程所支配，其中 $D$ 是一个恒定的宏观扩散系数。\n\n仅使用独立增量的基本定义、泊松过程的性质，以及宏观均方排移随时间线性增长（$\\mathbb{E}\\!\\left[(X(t)-X(0))^{2}\\right]\\sim 2\\,D\\,t$）的扩散定义属性，推导出每种机制下扩散系数 $D$ 的解析表达式，该表达式应以 $\\varepsilon$、$\\sigma^{2}$ 和更新参数表示。将您的最终答案表示为行矩阵 $(D_{\\mathrm{ct}},\\,D_{\\mathrm{dt}})$，其中 $D_{\\mathrm{ct}}$ 对应连续时间泊松时钟情况，$D_{\\mathrm{dt}}$ 对应离散时间更新情况。无需四舍五入。在最终的方框答案中不要包含单位。",
            "solution": "问题要求针对两种不同的微观基于智能体的模型，推导其宏观扩散系数 $D$。推导将基于进行随机游走的粒子的均方排移 (MSD) 与扩散系数之间的基本关系，对于一维系统，当时间 $t$ 很大时，该关系由 $\\mathbb{E}[(X(t)-X(0))^2] \\sim 2Dt$ 给出。我们将分别计算每种情况下单个智能体的 MSD，并从中提取出对应的 $D$ 的表达式。\n\n设 $X(t)$ 为单个智能体在时间 $t$ 的位置。不失一般性，我们可以设定初始位置为 $X(0)=0$。在之后的某个时间 $t$ 的位置是到该时间为止发生的所有跳跃的总和。设 $N(t)$ 是到时间 $t$ 为止发生的跳跃次数。第 $i$ 次跳跃是一个随机变量 $J_i = \\varepsilon \\xi_i$，其中 $\\xi_i$ 是独立同分布 (i.i.d.) 的随机变量，其均值为 $\\mathbb{E}[\\xi_i]=0$，方差为 $\\operatorname{Var}(\\xi_i)=\\sigma^2$。\n\n时间 $t$ 的位置由下式给出：\n$$X(t) = \\sum_{i=1}^{N(t)} J_i$$\n我们需要计算 MSD，由于 $X(0)=0$，即为 $\\mathbb{E}[X(t)^2]$。\n\n首先，我们来确定单次跳跃 $J_i$ 的统计特性。\n一次跳跃的均值为：\n$$\\mathbb{E}[J_i] = \\mathbb{E}[\\varepsilon \\xi_i] = \\varepsilon \\mathbb{E}[\\xi_i] = \\varepsilon \\cdot 0 = 0$$\n一次跳跃的平方的均值与其方差有关：\n$$\\mathbb{E}[J_i^2] = \\operatorname{Var}(J_i) + (\\mathbb{E}[J_i])^2$$\n一次跳跃的方差为：\n$$\\operatorname{Var}(J_i) = \\operatorname{Var}(\\varepsilon \\xi_i) = \\varepsilon^2 \\operatorname{Var}(\\xi_i) = \\varepsilon^2 \\sigma^2$$\n因此，一次跳跃的平方的均值为：\n$$\\mathbb{E}[J_i^2] = \\varepsilon^2 \\sigma^2 + 0^2 = \\varepsilon^2 \\sigma^2$$\n\n现在我们使用全期望定律，通过以跳跃次数 $N(t)$ 为条件来计算 MSD, $\\mathbb{E}[X(t)^2]$。\n$$\\mathbb{E}[X(t)^2] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\left(\\sum_{i=1}^{N(t)} J_i\\right)^2 \\middle| N(t) \\right] \\right]$$\n让我们计算对于固定的跳跃次数 $N(t)=n$ 时的内层期望。\n$$\\mathbb{E}\\left[ \\left(\\sum_{i=1}^{n} J_i\\right)^2 \\right] = \\mathbb{E}\\left[ \\sum_{i=1}^{n} J_i^2 + \\sum_{i \\neq j}^{n} J_i J_j \\right] = \\sum_{i=1}^{n} \\mathbb{E}[J_i^2] + \\sum_{i \\neq j}^{n} \\mathbb{E}[J_i J_j]$$\n由于历次跳跃 $J_i$ 是独立的且均值为零，对于 $i \\neq j$：\n$$\\mathbb{E}[J_i J_j] = \\mathbb{E}[J_i] \\mathbb{E}[J_j] = 0 \\cdot 0 = 0$$\n因此，交叉项的和为零。表达式简化为：\n$$\\mathbb{E}\\left[ \\left(\\sum_{i=1}^{n} J_i\\right)^2 \\right] = \\sum_{i=1}^{n} \\mathbb{E}[J_i^2] = \\sum_{i=1}^{n} \\varepsilon^2 \\sigma^2 = n \\varepsilon^2 \\sigma^2$$\n这个结果，即瓦尔德等式，之所以成立是因为跳跃是独立同分布的，且跳跃次数 $n$ 是一个停时（这在所考虑的两种情况中都成立）。\n\n将此代回全期望定律：\n$$\\mathbb{E}[X(t)^2] = \\mathbb{E}[N(t) \\varepsilon^2 \\sigma^2] = \\varepsilon^2 \\sigma^2 \\mathbb{E}[N(t)]$$\n问题现在简化为为两种更新机制中的每一种找到预期的跳跃次数 $\\mathbb{E}[N(t)]$。\n\n$($i$)$ 连续时间更新（泊松时钟）：\n在这种情况下，智能体到时间 $t$ 为止执行的跳跃次数 $N(t)$ 服从速率为 $\\lambda$ 的泊松过程。长度为 $t$ 的时间间隔内的事件数是一个参数为 $\\lambda t$ 的泊松分布随机变量。\n$$N(t) \\sim \\text{Poisson}(\\lambda t)$$\n参数为 $\\mu$ 的泊松随机变量的期望值为 $\\mu$。因此，预期的跳跃次数为：\n$$\\mathbb{E}[N(t)] = \\lambda t$$\n将此代入我们的 MSD 公式：\n$$\\mathbb{E}[X(t)^2] = \\varepsilon^2 \\sigma^2 (\\lambda t) = (\\lambda \\varepsilon^2 \\sigma^2) t$$\n我们将此结果与宏观扩散定律 $\\mathbb{E}[X(t)^2] = 2 D_{\\mathrm{ct}} t$ 进行匹配。\n$$2 D_{\\mathrm{ct}} t = \\lambda \\varepsilon^2 \\sigma^2 t$$\n求解扩散系数 $D_{\\mathrm{ct}}$ 可得：\n$$D_{\\mathrm{ct}} = \\frac{1}{2} \\lambda \\varepsilon^2 \\sigma^2$$\n\n$($ii$)$ 离散时间更新（同步）：\n在这里，跳跃确定性地发生在时间 $t_n = n \\Delta t$（$n \\in \\mathbb{N}$）。对于给定的宏观时间 $t$，已发生的跳跃次数是到时间 $t$ 为止已完成的更新步数。这个数字由底函数给出：\n$$N(t) = \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\n在这个模型中，对于固定的时间 $t$，$N(t)$ 不是一个随机变量。因此，它的期望就是它的值本身：\n$$\\mathbb{E}[N(t)] = N(t) = \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\n那么 MSD 为：\n$$\\mathbb{E}[X(t)^2] = \\varepsilon^2 \\sigma^2 \\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor$$\n问题陈述中提到，系统是在有限的宏观时间内被观察的，这意味着 $t$ 与微观时间步长 $\\Delta t$ 相比很大，即 $t \\gg \\Delta t$。在这种情况下，我们可以用其自变量来近似底函数：\n$$\\left\\lfloor \\frac{t}{\\Delta t} \\right\\rfloor \\approx \\frac{t}{\\Delta t}$$\n在定义 MSD 线性增长的极限中，这个近似变得精确。\n因此，对于大的 $t$：\n$$\\mathbb{E}[X(t)^2] \\sim \\varepsilon^2 \\sigma^2 \\frac{t}{\\Delta t} = \\left(\\frac{\\varepsilon^2 \\sigma^2}{\\Delta t}\\right) t$$\n我们将此渐近行为与宏观定律 $\\mathbb{E}[X(t)^2] \\sim 2 D_{\\mathrm{dt}} t$ 进行匹配。\n$$2 D_{\\mathrm{dt}} t = \\frac{\\varepsilon^2 \\sigma^2}{\\Delta t} t$$\n求解扩散系数 $D_{\\mathrm{dt}}$ 可得：\n$$D_{\\mathrm{dt}} = \\frac{\\varepsilon^2 \\sigma^2}{2 \\Delta t}$$\n\n最终答案是包含两个推导出的表达式的行矩阵 $(D_{\\mathrm{ct}}, D_{\\mathrm{dt}})$。\n$D_{\\mathrm{ct}} = \\frac{1}{2} \\lambda \\varepsilon^2 \\sigma^2$\n$D_{\\mathrm{dt}} = \\frac{\\varepsilon^2 \\sigma^2}{2 \\Delta t}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} \\lambda \\varepsilon^{2} \\sigma^{2}  \\frac{\\varepsilon^{2} \\sigma^{2}}{2 \\Delta t}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在基本的扩散模型之上，我们常常需要考虑外部力或内部偏好导致的方向性运动。本练习引入了一个微小的微观跳跃偏差，并展示了它如何在宏观尺度上涌现为平流项。通过处理这个问题 ，您将学会使用泰勒展开作为一种强大的技术，从离散的主方程中推导出包含平流和扩散的连续偏微分方程。",
            "id": "3732081",
            "problem": "考虑一个一维格点上的代理基模型，其网格尺寸为 $\\epsilon  0$。在每个持续时间为 $\\epsilon^{2}$ 的离散时间步长中，位于位置 $x$ 的一个代理以概率 $p_{+}(x)$ 跳跃到 $x+\\epsilon$，以概率 $p_{-}(x)$ 跳跃到 $x-\\epsilon$。假设跳跃概率包含一个 $O(\\epsilon)$ 阶的弱偏置：\n$$\np_{+}(x) = \\frac{1}{2} + \\epsilon \\beta(x), \\qquad p_{-}(x) = \\frac{1}{2} - \\epsilon \\beta(x),\n$$\n其中 $\\beta(x)$ 是一个关于 $x$ 的光滑有界函数，并且对于所有足够小的 $\\epsilon$，概率值保持在 $[0,1]$ 区间内。令 $\\rho^{\\epsilon}(x,t)$ 表示在时间 $t$、格点位置 $x$ 处代理的期望数密度。假设初始密度在宏观尺度上是光滑的，并且各个代理的运动是相互独立且同分布的。\n\n从 $\\rho^{\\epsilon}(x,t)$ 的离散守恒（主）方程出发，并使用空间增量为 $O(\\epsilon)$、时间增量为 $O(\\epsilon^{2})$ 的抛物线标度，推导当 $\\epsilon \\to 0$ 时的连续极限，从而得到宏观密度 $\\rho(x,t)$ 的对流-扩散偏微分方程 (PDE)，其形式为\n$$\n\\partial_{t} \\rho(x,t) + \\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big) = D\\,\\partial_{xx} \\rho(x,t),\n$$\n其中 $D$ 为常数扩散系数。请用 $\\beta(x)$ 明确地确定有效漂移函数 $v(x)$。\n\n你的最终答案必须是 $v(x)$ 的一个无单位的单一闭式解析表达式。",
            "solution": "该问题要求从一个一维格点上的微观代理基模型推导出宏观的对流-扩散方程。推导过程首先是写出代理密度的主方程，然后进行抛物线标度下的泰勒展开，最后取连续极限。\n\n令 $\\rho^{\\epsilon}(x,t)$ 为在时间 $t$、格点位置 $x$ 处代理的期望数密度。格点间距为 $\\epsilon$，离散时间步长为 $\\Delta t = \\epsilon^2$。位于位置 $y$ 的代理以概率 $p_{+}(y)$ 跳跃到 $y+\\epsilon$，以概率 $p_{-}(y)$ 跳跃到 $y-\\epsilon$。给定的概率为 $p_{+}(y) = \\frac{1}{2} + \\epsilon \\beta(y)$ 和 $p_{-}(y) = \\frac{1}{2} - \\epsilon \\beta(y)$。我们注意到 $p_{+}(y) + p_{-}(y) = 1$，这意味着代理总是跳跃到相邻位置，从不原地不动。\n\n密度 $\\rho^{\\epsilon}(x,t)$ 的主方程描述了代理的守恒。在一个时间步长内，位置 $x$ 处密度的变化是代理从相邻位置跳入减去从位置 $x$ 跳出的净结果。\n$$\n\\rho^{\\epsilon}(x, t+\\epsilon^2) - \\rho^{\\epsilon}(x, t) = \\rho^{\\epsilon}(x-\\epsilon, t) p_{+}(x-\\epsilon) + \\rho^{\\epsilon}(x+\\epsilon, t) p_{-}(x+\\epsilon) - \\rho^{\\epsilon}(x, t) \\left( p_{+}(x) + p_{-}(x) \\right)\n$$\n由于 $p_{+}(x) + p_{-}(x) = 1$，主方程简化为：\n$$\n\\rho^{\\epsilon}(x, t+\\epsilon^2) - \\rho^{\\epsilon}(x, t) = \\rho^{\\epsilon}(x-\\epsilon, t) p_{+}(x-\\epsilon) + \\rho^{\\epsilon}(x+\\epsilon, t) p_{-}(x+\\epsilon) - \\rho^{\\epsilon}(x, t)\n$$\n为了找到 $\\epsilon \\to 0$ 时的连续极限，我们假设 $\\rho^{\\epsilon}(x,t)$ 收敛到一个光滑函数 $\\rho(x,t)$。然后我们可以对主方程中的所有项在点 $(x,t)$ 附近进行泰勒级数展开。\n\n方程的左侧 (LHS) 对时间进行展开：\n$$\n\\rho(x, t+\\epsilon^2) - \\rho(x, t) = \\left( \\rho + \\epsilon^2 \\partial_t \\rho + O(\\epsilon^4) \\right) - \\rho = \\epsilon^2 \\partial_t \\rho + O(\\epsilon^4)\n$$\n其中 $\\rho$ 及其导数均在 $(x,t)$ 处取值。\n\n右侧 (RHS) 涉及对密度 $\\rho$ 和概率函数 $\\beta(x)$ 的空间展开。\n首先，我们展开密度函数 $\\rho(x \\pm \\epsilon, t)$：\n$$\n\\rho(x \\pm \\epsilon, t) = \\rho \\pm \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho \\pm \\frac{\\epsilon^3}{6} \\partial_{xxx} \\rho + O(\\epsilon^4)\n$$\n接着，我们展开概率函数。函数 $\\beta(x)$ 假设是光滑的。\n$p_{+}(x-\\epsilon) = \\frac{1}{2} + \\epsilon \\beta(x-\\epsilon) = \\frac{1}{2} + \\epsilon \\left(\\beta - \\epsilon \\beta' + \\frac{\\epsilon^2}{2}\\beta'' - \\dots\\right) = \\frac{1}{2} + \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)$\n$p_{-}(x+\\epsilon) = \\frac{1}{2} - \\epsilon \\beta(x+\\epsilon) = \\frac{1}{2} - \\epsilon \\left(\\beta + \\epsilon \\beta' + \\frac{\\epsilon^2}{2}\\beta'' + \\dots\\right) = \\frac{1}{2} - \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)$\n这里，$\\beta$ 及其导数 $\\beta', \\beta'', \\dots$ 均在 $x$ 处取值。\n\n现在我们展开 RHS 上的乘积项：\n第一项是 $\\rho(x-\\epsilon, t) p_{+}(x-\\epsilon)$：\n$$\n\\left(\\rho - \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho + O(\\epsilon^3)\\right) \\left(\\frac{1}{2} + \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)\\right)\n$$\n$$\n= \\frac{1}{2}\\rho - \\frac{\\epsilon}{2}\\partial_x\\rho + \\frac{\\epsilon^2}{4}\\partial_{xx}\\rho + \\epsilon\\beta\\rho - \\epsilon^2\\beta\\partial_x\\rho - \\epsilon^2\\beta'\\rho + O(\\epsilon^3)\n$$\n第二项是 $\\rho(x+\\epsilon, t) p_{-}(x+\\epsilon)$：\n$$\n\\left(\\rho + \\epsilon \\partial_x \\rho + \\frac{\\epsilon^2}{2} \\partial_{xx} \\rho + O(\\epsilon^3)\\right) \\left(\\frac{1}{2} - \\epsilon\\beta - \\epsilon^2\\beta' + O(\\epsilon^3)\\right)\n$$\n$$\n= \\frac{1}{2}\\rho + \\frac{\\epsilon}{2}\\partial_x\\rho + \\frac{\\epsilon^2}{4}\\partial_{xx}\\rho - \\epsilon\\beta\\rho - \\epsilon^2\\beta\\partial_x\\rho - \\epsilon^2\\beta'\\rho + O(\\epsilon^3)\n$$\n将这两项相加，我们收集 $\\epsilon$ 的各次幂项：\n- $\\epsilon^0$ 阶的项：$\\frac{1}{2}\\rho + \\frac{1}{2}\\rho = \\rho$。\n- $\\epsilon^1$ 阶的项：$(-\\frac{1}{2}\\partial_x\\rho + \\beta\\rho) + (\\frac{1}{2}\\partial_x\\rho - \\beta\\rho) = 0$。\n- $\\epsilon^2$ 阶的项：$(\\frac{1}{4}\\partial_{xx}\\rho - \\beta\\partial_x\\rho - \\beta'\\rho) + (\\frac{1}{4}\\partial_{xx}\\rho - \\beta\\partial_x\\rho - \\beta'\\rho) = \\frac{1}{2}\\partial_{xx}\\rho - 2\\beta\\partial_x\\rho - 2\\beta'\\rho$。\n\n所以，和为 $\\rho + \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\beta\\partial_x\\rho - 2\\beta'\\rho \\right) + O(\\epsilon^3)$。\n主方程的 RHS 是这个和减去 $\\rho(x,t)$：\n$$\n\\text{RHS} = \\rho + \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2(\\beta\\partial_x\\rho + \\beta'\\rho) \\right) + O(\\epsilon^3) - \\rho = \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) \\right) + O(\\epsilon^3)\n$$\n更仔细的分析表明，所有 $\\epsilon^3$ 阶的项也都消失了，使得残差项为 $O(\\epsilon^4)$。\n\n令 LHS 和 RHS 的展开式相等：\n$$\n\\epsilon^2 \\partial_t \\rho + O(\\epsilon^4) = \\epsilon^2 \\left( \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) \\right) + O(\\epsilon^4)\n$$\n将整个方程除以 $\\epsilon^2$：\n$$\n\\partial_t \\rho + O(\\epsilon^2) = \\frac{1}{2}\\partial_{xx}\\rho - 2\\partial_x(\\beta\\rho) + O(\\epsilon^2)\n$$\n在 $\\epsilon \\to 0$ 的极限情况下，我们得到连续偏微分方程 (PDE)：\n$$\n\\partial_t \\rho(x,t) = \\frac{1}{2}\\partial_{xx}\\rho(x,t) - 2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big)\n$$\n为了匹配问题陈述中给出的目标形式，我们重排这个方程：\n$$\n\\partial_t \\rho(x,t) + 2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big) = \\frac{1}{2}\\partial_{xx}\\rho(x,t)\n$$\n目标 PDE 为：\n$$\n\\partial_{t} \\rho(x,t) + \\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big) = D\\,\\partial_{xx} \\rho(x,t)\n$$\n通过将我们推导出的 PDE 与目标形式进行比较，我们可以确定常数扩散系数 $D$ 和有效漂移函数 $v(x)$。\n我们发现扩散系数为 $D = \\frac{1}{2}$。\n对流项通过比较 $\\partial_{x}\\!\\big(v(x)\\,\\rho(x,t)\\big)$ 和 $2\\partial_x\\big(\\beta(x)\\rho(x,t)\\big)$ 来确定。这意味着：\n$$\nv(x)\\rho(x,t) = 2\\beta(x)\\rho(x,t)\n$$\n由于该等式必须对任意密度分布 $\\rho(x,t)$ 都成立，我们可以得出结论，函数本身必须相等：\n$$\nv(x) = 2\\beta(x)\n$$\n这就是用偏置函数 $\\beta(x)$ 表示的有效漂移函数的表达式。",
            "answer": "$$\n\\boxed{2\\beta(x)}\n$$"
        },
        {
            "introduction": "一个完整的连续模型不仅需要控制方程，还需要在区域边界上施加恰当的条件。本练习探讨了宏观边界条件如何从智能体与边界的微观相互作用中产生，例如反射和吸收。解决这个问题  将帮助您理解像诺伊曼（Neumann）或罗宾（Robin）这样的边界条件并非凭空设定，而是微观动力学在宏观尺度上的直接体现。",
            "id": "3732031",
            "problem": "考虑一个一维半线区域 $x \\in [0,\\infty)$，其中充满了不可区分的粒子，这些粒子在进行连续时间随机游走（CTRW）。空间晶格间距为 $\\Delta x  0$，每个位于内部晶格点 $i \\geq 1$ 的粒子以相等的速率 $\\nu/2$ 跳跃到相邻的格点 $i-1$ 或 $i+1$，其中 $\\nu  0$ 是总跳跃速率。令 $\\rho_i(t)$ 表示在 $t$ 时刻格点 $i$ 处的期望粒子数密度，令 $\\rho(x,t)$ 表示在 $t$ 时刻位置 $x$ 处的连续密度。假设标准的扩散标度极限成立，从而在内部区域得到扩散方程，其扩散系数为 $D = \\nu \\Delta x^2 / 2$。\n\n在边界格点 $i=0$（对应于 $x=0$）处，施加以下粒子层面的规则来模拟反射和吸收：\n- 所有从 $i=0$ 到外部（$i=-1$）的尝试跳跃都被确定性地反射回区域内的 $i=1$ 处（反射）。\n- 与跳跃无关，位于 $i=0$ 的粒子以恒定的消失速率 $\\alpha  0$（单位时间）被吸收（从系统中移除）（吸收）。\n\n因此，在 $i=0$ 处，既有以速率 $\\nu/2$ 向右输运到 $i=1$ 的过程，也有以速率 $\\alpha$ 的吸收过程。令 $J(x,t)$ 表示连续概率流，定义为 $J(x,t) = -D\\,\\partial_x \\rho(x,t)$。\n\n从晶格层面的主方程出发，通过泰勒展开 $\\rho(\\Delta x,t) = \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t) + \\mathcal{O}(\\Delta x^2)$ 将晶格边界动力学与连续场进行渐近匹配，推导出在 $x=0$ 处的连续边界条件，该条件用 $\\rho(0,t)$ 和 $J(0,t)$ 表示。证明所得到的宏观边界条件是罗宾（Robin）型的，其中在 $x=0$ 处的向外通量与边界密度成正比，并确定该比例系数，将其表示为微观参数的解析表达式。\n\n在您的推导中，请明确论证：\n- 内部扩散方程是如何从CTRW以及通过辨识 $D = \\nu \\Delta x^2 / 2$ 得到的。\n- 关于 $\\rho_0(t)$ 的晶格边界方程，如何与准稳态边界层近似相结合，从而得到 $\\partial_x \\rho(0,t)$ 与 $\\rho(0,t)$ 之间的关系。\n- 这个关系如何转化为连接 $J(0,t)$ 和 $\\rho(0,t)$ 的罗宾边界条件，以及当 $\\alpha \\to 0$ 和 $\\alpha \\to \\infty$ 时，诺伊曼（Neumann）（完美反射）和狄利克雷（Dirichlet）（完美吸收）极限是如何出现的。\n\n答案规格：\n- 最终答案只提供罗宾边界系数 $\\kappa$ 的解析表达式（用微观参数表示），不含任何额外文字。\n- 为保证单位一致性，如果时间的基本单位是秒，长度的基本单位是米，那么 $\\kappa$ 必须以米/秒表示；但是，最终的方框答案中不要包含单位。\n- 无需进行数值计算或四舍五入。",
            "solution": "我们从一个一维晶格上的连续时间随机游走（CTRW）开始，其晶格间距为 $\\Delta x$，总跳跃速率为 $\\nu$。在内部格点 $i \\geq 1$ 处，期望密度 $\\rho_i(t)$ 的主方程为\n$$\n\\frac{d}{dt}\\rho_i(t) \\;=\\; \\frac{\\nu}{2}\\,\\rho_{i+1}(t) \\;-\\; \\nu\\,\\rho_i(t) \\;+\\; \\frac{\\nu}{2}\\,\\rho_{i-1}(t) \\;=\\; \\frac{\\nu}{2}\\left(\\rho_{i+1}(t) - 2\\,\\rho_i(t) + \\rho_{i-1}(t)\\right).\n$$\n引入连续密度 $\\rho(x,t)$，其中 $x = i\\,\\Delta x$，并通过泰勒级数展开 $\\rho_{i\\pm 1}(t)$，\n$$\n\\rho_{i\\pm 1}(t) \\;=\\; \\rho(x,t) \\pm \\Delta x\\,\\partial_x \\rho(x,t) + \\frac{\\Delta x^2}{2}\\,\\partial_{xx} \\rho(x,t) + \\mathcal{O}(\\Delta x^3),\n$$\n我们得到一阶主导项\n$$\n\\frac{d}{dt}\\rho(x,t) \\;=\\; \\frac{\\nu}{2}\\left(\\Delta x^2\\,\\partial_{xx} \\rho(x,t)\\right) \\;+\\; \\mathcal{O}(\\Delta x^3).\n$$\n取扩散标度极限并忽略高阶项，可得到扩散方程\n$$\n\\partial_t \\rho(x,t) \\;=\\; D\\,\\partial_{xx} \\rho(x,t), \\quad \\text{其中} \\quad D \\;=\\; \\frac{\\nu\\,\\Delta x^2}{2}.\n$$\n\n接下来我们分析 $i=0$ 处的边界动力学。根据所述规则，尝试跳出区域的粒子被反射到 $i=1$，因此在 $i=0$ 处唯一的输运耦合发生在 $i=0$ 和 $i=1$ 之间，并且在 $i=0$ 处存在以速率 $\\alpha$ 发生的独立吸收。边界格点处的主方程是\n$$\n\\frac{d}{dt}\\rho_0(t) \\;=\\; \\frac{\\nu}{2}\\,\\rho_1(t) \\;-\\; \\frac{\\nu}{2}\\,\\rho_0(t) \\;-\\; \\alpha\\,\\rho_0(t).\n$$\n第一项 $\\frac{\\nu}{2}\\rho_1(t)$ 代表从 $i=1$ 流入 $i=0$，第二项 $\\frac{\\nu}{2}\\rho_0(t)$ 代表从 $i=0$ 流出到 $i=1$，最后一项 $\\alpha \\rho_0(t)$ 是在 $i=0$ 处的吸收。为了与连续描述联系起来，我们认定 $\\rho_0(t) \\approx \\rho(0,t)$ 和 $\\rho_1(t) \\approx \\rho(\\Delta x,t)$，并引用关于 $x=0$ 的泰勒展开：\n$$\n\\rho(\\Delta x,t) \\;=\\; \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t) + \\mathcal{O}(\\Delta x^2).\n$$\n\n现在我们对边界格点使用准稳态近似，当边界层的弛豫时间尺度远快于宏观演化时，这种近似是合理的。设 $\\frac{d}{dt}\\rho_0(t) \\approx 0$ 并代入 $\\rho_1(t) \\approx \\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t)$，得到\n$$\n0 \\;=\\; \\frac{\\nu}{2}\\left[\\rho(0,t) + \\Delta x\\,\\partial_x \\rho(0,t)\\right] \\;-\\; \\frac{\\nu}{2}\\,\\rho(0,t) \\;-\\; \\alpha\\,\\rho(0,t),\n$$\n化简后得到\n$$\n\\frac{\\nu}{2}\\,\\Delta x\\,\\partial_x \\rho(0,t) \\;=\\; \\alpha\\,\\rho(0,t).\n$$\n因此我们得到边界关系\n$$\n\\partial_x \\rho(0,t) \\;=\\; \\frac{2\\,\\alpha}{\\nu\\,\\Delta x}\\,\\rho(0,t).\n$$\n\n连续通量定义为 $J(x,t) = -D\\,\\partial_x \\rho(x,t)$。在 $x=0$ 处求值并代入边界关系，我们发现\n$$\nJ(0,t) \\;=\\; -D\\,\\partial_x \\rho(0,t) \\;=\\; -\\left(\\frac{\\nu\\,\\Delta x^2}{2}\\right)\\left(\\frac{2\\,\\alpha}{\\nu\\,\\Delta x}\\right)\\rho(0,t) \\;=\\; -\\alpha\\,\\Delta x\\,\\rho(0,t).\n$$\n将 $J(0,t)$ 解释为在 $+x$ 方向上为正，在 $x=0$ 处的外法线指向 $x$ 减小的方向，因此向外通量为 $-J(0,t)$。因此，宏观边界条件呈罗宾形式\n$$\n\\text{(在 } x=0 \\text{ 处的向外通量)}\\;=\\; \\kappa\\,\\rho(0,t), \\quad \\text{其中} \\quad \\kappa \\;=\\; \\alpha\\,\\Delta x.\n$$\n量纲一致性成立：$\\alpha$ 的量纲是时间的倒数，$\\Delta x$ 的量纲是长度，因此 $\\kappa$ 的量纲是长度每时间。\n\n最后，我们验证极限情况：\n- 完美反射对应于 $\\alpha \\to 0$，得到 $\\kappa \\to 0$，即向外通量为零，这是诺伊曼条件 $J(0,t) = 0$。\n- 完美吸收对应于 $\\alpha \\to \\infty$，得到 $\\kappa \\to \\infty$，这要求 $\\rho(0,t) \\to 0$ 以保持通量有限，即狄利克雷条件 $\\rho(0,t) = 0$。\n\n因此，连接边界处粒子层面吸收与宏观通量-密度关系的罗宾系数被确定为\n$$\n\\kappa \\;=\\; \\alpha\\,\\Delta x.\n$$\n根据问题说明，如果时间以秒为单位，长度以米为单位，则该量应以米/秒报告；最终的方框答案中不应包含单位。",
            "answer": "$$\\boxed{\\alpha\\,\\Delta x}$$"
        }
    ]
}