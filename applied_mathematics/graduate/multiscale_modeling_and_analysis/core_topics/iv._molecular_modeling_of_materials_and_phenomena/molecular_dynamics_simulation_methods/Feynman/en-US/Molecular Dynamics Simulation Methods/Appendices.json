{
    "hands_on_practices": [
        {
            "introduction": "At the heart of every molecular dynamics simulation is a numerical integrator that advances particle positions and velocities. The choice of the integration time step, $\\Delta t$, is critical; if it is too large, the simulation will become numerically unstable. This foundational exercise guides you through a linear stability analysis of the velocity Verlet algorithm, the workhorse of MD, to determine the maximum stable time step for a harmonic oscillator, which serves as a proxy for the fastest vibrational modes in any molecular system .",
            "id": "3782502",
            "problem": "In Molecular Dynamics (MD), the velocities and positions of particles are advanced in time using time-integration schemes derived from Newton’s second law. Consider a single particle of mass $m$ confined to one spatial dimension and subject to a harmonic force $F(x)=-kx$, so that its equation of motion is $m\\,\\ddot{x}=-kx$. This linear oscillator models small-amplitude vibrations near a stable equilibrium and is a standard surrogate for analyzing timestep stability in explicit integrators used in multiscale modeling.\n\nStarting from Newton’s second law and the definition of acceleration $a(x) = \\ddot{x} = F(x)/m$, adopt the standard velocity Verlet algorithm, which advances positions and velocities over a timestep $\\Delta t$ via one position update using the current velocity and acceleration, followed by a velocity update that uses the average of the current and next-step accelerations. For the harmonic oscillator, the acceleration is $a(x)=-\\omega^{2}x$ with $\\omega=\\sqrt{k/m}$.\n\n1. Derive, in closed form, the single-step linear update that maps the state $(x_{n},v_{n})$ at time $t_{n}$ to $(x_{n+1},v_{n+1})$ at time $t_{n+1}=t_{n}+\\Delta t$ under velocity Verlet. Write this mapping as an amplification matrix $A(\\omega,\\Delta t)$ acting on the state vector, that is,\n   $$\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A(\\omega,\\Delta t)\\,\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}.$$\n\n2. Using the eigenvalues of $A(\\omega,\\Delta t)$, analyze the linear stability of the scheme. Impose the condition that the amplification factors have magnitude less than or equal to $1$ (no exponential growth), and determine the maximum stable timestep $\\Delta t_{\\max}$ as a function of $\\omega$.\n\nExpress your final answer for $\\Delta t_{\\max}$ as a closed-form analytic expression in terms of $\\omega$. Do not substitute numerical values and do not include units in your final answer. If you choose to evaluate $\\Delta t_{\\max}$ numerically for a particular $\\omega$ for your own verification, express time in seconds and round to four significant figures.",
            "solution": "The problem requires the derivation of the one-step update matrix for the velocity Verlet algorithm applied to a simple harmonic oscillator, followed by a linear stability analysis to determine the maximum stable timestep.\n\nThe equation of motion for the one-dimensional harmonic oscillator is given by $m\\ddot{x} = -kx$, where $m$ is the mass, $x$ is the position, and $k$ is the spring constant. The acceleration is $a(x) = \\ddot{x} = -\\frac{k}{m}x$. By defining the angular frequency $\\omega = \\sqrt{k/m}$, the acceleration can be written as $a(x) = -\\omega^2 x$.\n\nThe velocity Verlet algorithm consists of two main steps for advancing the state from time $t_n$ to $t_{n+1} = t_n + \\Delta t$:\n1. Position update: $$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2} a_n (\\Delta t)^2$$\n2. Velocity update: $$v_{n+1} = v_n + \\frac{1}{2}(a_n + a_{n+1})\\Delta t$$\nHere, $(x_n, v_n)$ is the state at time $t_n$, $\\Delta t$ is the timestep, and $a_n = a(x_n)$ and $a_{n+1} = a(x_{n+1})$ are the accelerations at the current and next timesteps, respectively.\n\n**Part 1: Derivation of the Update Matrix $A(\\omega, \\Delta t)$**\n\nWe substitute the specific acceleration for the harmonic oscillator, $a_n = -\\omega^2 x_n$ and $a_{n+1} = -\\omega^2 x_{n+1}$, into the algorithm's equations.\n\nThe position update becomes:\n$$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2}(-\\omega^2 x_n)(\\Delta t)^2$$\nRearranging to group terms of $x_n$ and $v_n$:\n$$x_{n+1} = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n$$\nThis equation provides the first row of the amplification matrix $A$.\n\nThe velocity update is:\n$$v_{n+1} = v_n + \\frac{1}{2}(-\\omega^2 x_n - \\omega^2 x_{n+1}) \\Delta t$$\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t (x_n + x_{n+1})$$\nTo express $v_{n+1}$ solely in terms of the state at time $t_n$, $(x_n, v_n)$, we substitute the expression for $x_{n+1}$ that we just derived:\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t \\left[x_n + \\left( \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n \\right) \\right]$$\nCollecting terms for $x_n$ and $v_n$ inside the brackets:\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t \\left[ \\left(2 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n \\right]$$\nDistributing the factor $-\\frac{1}{2}\\omega^2 \\Delta t$:\n$$v_{n+1} = v_n - \\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) x_n - \\frac{1}{2}\\omega^2 (\\Delta t)^2 v_n$$\nFinally, grouping the terms for $x_n$ and $v_n$:\n$$v_{n+1} = - \\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) x_n + \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right)v_n$$\nThis equation provides the second row of the matrix $A$.\n\nCombining these two results into the matrix equation $\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$, we identify the amplification matrix $A$ as:\n$$A(\\omega, \\Delta t) = \\begin{pmatrix} 1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 & \\Delta t \\\\ -\\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) & 1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\end{pmatrix}$$\n\n**Part 2: Stability Analysis**\n\nThe stability of the numerical scheme is determined by the eigenvalues, $\\lambda$, of the amplification matrix $A$. The scheme is stable if and only if all eigenvalues have a magnitude less than or equal to $1$, i.e., $|\\lambda| \\le 1$. The eigenvalues are the roots of the characteristic equation $\\det(A - \\lambda I) = 0$, which can be written as $\\lambda^2 - \\text{Tr}(A)\\lambda + \\det(A) = 0$.\n\nFirst, we compute the trace and determinant of $A$.\nThe trace is the sum of the diagonal elements:\n$$\\text{Tr}(A) = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) + \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) = 2 - \\omega^2 (\\Delta t)^2$$\nThe determinant is:\n$$\\det(A) = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right)^2 - (\\Delta t) \\left(-\\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)\\right)$$\n$$\\det(A) = \\left(1 - \\omega^2 (\\Delta t)^2 + \\frac{1}{4}\\omega^4 (\\Delta t)^4\\right) + \\omega^2 (\\Delta t)^2 \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)$$\n$$\\det(A) = 1 - \\omega^2 (\\Delta t)^2 + \\frac{1}{4}\\omega^4 (\\Delta t)^4 + \\omega^2 (\\Delta t)^2 - \\frac{1}{4}\\omega^4 (\\Delta t)^4 = 1$$\nThe property $\\det(A)=1$ confirms that the velocity Verlet algorithm is a symplectic integrator, which conserves phase-space volume for Hamiltonian systems.\n\nThe characteristic equation for the eigenvalues is:\n$$\\lambda^2 - \\left(2 - \\omega^2 (\\Delta t)^2\\right)\\lambda + 1 = 0$$\nUsing the quadratic formula to solve for $\\lambda$:\n$$\\lambda = \\frac{(2 - \\omega^2 (\\Delta t)^2) \\pm \\sqrt{(2 - \\omega^2 (\\Delta t)^2)^2 - 4}}{2}$$\n$$\\lambda = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) \\pm \\sqrt{\\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right)^2 - 1}$$\nLet's define a dimensionless parameter $s = \\omega \\Delta t$. The expression for the eigenvalues becomes:\n$$\\lambda = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{\\left(1 - \\frac{s^2}{2}\\right)^2 - 1} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{1 - s^2 + \\frac{s^4}{4} - 1} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{\\frac{s^4}{4} - s^2}$$\n\nThe nature of the eigenvalues depends on the sign of the discriminant $D = \\frac{s^4}{4} - s^2 = s^2\\left(\\frac{s^2}{4} - 1\\right)$.\n\nCase 1: Stable Regime ($s^2 < 4$, or $|\\omega \\Delta t| < 2$).\nThe discriminant is negative, so the eigenvalues are a complex conjugate pair.\n$$|\\lambda|^2 = \\left(1 - \\frac{s^2}{2}\\right)^2 - \\left(\\frac{s^4}{4} - s^2\\right) = 1 - s^2 + \\frac{s^4}{4} - \\frac{s^4}{4} + s^2 = 1$$\nThus, for $|\\omega \\Delta t| < 2$, the eigenvalues lie on the unit circle ($|\\lambda|=1$), and the algorithm is stable. The solution does not grow or decay in amplitude, correctly modeling the energy conservation of the oscillator.\n\nCase 2: Stability Boundary ($s^2 = 4$, or $|\\omega \\Delta t| = 2$).\nThe discriminant is zero, resulting in a repeated real eigenvalue:\n$$\\lambda = 1 - \\frac{s^2}{2} = 1 - \\frac{4}{2} = -1$$\nThe magnitude is $|\\lambda| = 1$, so the scheme is marginally stable.\n\nCase 3: Unstable Regime ($s^2 > 4$, or $|\\omega \\Delta t| > 2$).\nThe discriminant is positive, so the eigenvalues are real and distinct:\n$$\\lambda_{\\pm} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{s^2\\left(\\frac{s^2}{4} - 1\\right)}$$\nSince $\\det(A) = \\lambda_+\\lambda_- = 1$, one eigenvalue must have a magnitude greater than $1$ and the other less than $1$. For $s^2 > 4$, the term $1 - \\frac{s^2}{2}$ is less than $-1$. The eigenvalue $\\lambda_- = (1 - s^2/2) - \\sqrt{...}$ will therefore be a real number with magnitude greater than $1$. This leads to exponential growth of the solution, so the scheme is unstable.\n\nThe condition for linear stability, $|\\lambda| \\le 1$, is satisfied if and only if $s^2 \\le 4$. Since $\\omega > 0$ and $\\Delta t > 0$, this is equivalent to $\\omega \\Delta t \\le 2$.\n\nThe maximum stable timestep, $\\Delta t_{\\max}$, corresponds to the equality:\n$$\\omega \\Delta t_{\\max} = 2$$\nSolving for $\\Delta t_{\\max}$ gives:\n$$\\Delta t_{\\max} = \\frac{2}{\\omega}$$\nThis is the stability limit for the velocity Verlet algorithm applied to the simple harmonic oscillator.",
            "answer": "$$\\boxed{\\frac{2}{\\omega}}$$"
        },
        {
            "introduction": "To increase the stable time step, it is common practice to constrain the fastest degrees of freedom, such as covalent bond lengths. However, the numerical algorithms used to enforce these constraints, like SHAKE or RATTLE, operate with a finite tolerance, which can itself introduce spurious high-frequency oscillations. This insightful practice models the effect of a constraint tolerance $\\tau$ as a very stiff harmonic spring, allowing you to derive the new stability limit it imposes and thereby understand the delicate interplay between physical constraints and numerical artifacts .",
            "id": "3782515",
            "problem": "Consider a simple constrained Molecular Dynamics (MD) system consisting of two identical atoms of mass $m$ in three-dimensional space whose interatomic distance is constrained to a fixed value $r_{0}$ by a holonomic constraint. The constraint is enforced with a position-level iterative corrector akin to SHAKE and a velocity-level corrector akin to RATTLE, but in practice the corrector is terminated when the residual bond-length violation magnitude $\\delta r = |\\mathbf{r}_{2} - \\mathbf{r}_{1}| - r_{0}$ satisfies $|\\delta r| \\leq \\tau$, where $\\tau$ is a prescribed tolerance. Assume that near the constrained manifold, the leading-order effect of terminating the constraint iterations at tolerance $\\tau$ can be modeled by augmenting the Hamiltonian with a small harmonic penalty potential $V_{p} = \\frac{1}{2}\\,\\kappa\\,(\\delta r)^{2}$ that acts only along the constrained bond direction, thereby replacing the ideal constraint with a stiff but finite restoring force.\n\nStarting only from:\n- Newton’s second law (force equals mass times acceleration),\n- the definition of holonomic constraints and the relative coordinate for a two-particle system,\n- and the equipartition theorem of statistical mechanics at temperature $T$, which states that for a quadratic degree of freedom the mean thermal energy is $\\frac{1}{2} k_{B} T$, where $k_{B}$ is the Boltzmann constant,\n\ndo the following:\n1. Derive, in terms of $m$, $k_{B}$, $T$, and $\\tau$, the effective angular frequency $\\omega_{\\text{eff}}$ of the spurious vibrational mode introduced by the finite constraint tolerance $\\tau$, by identifying the appropriate effective mass associated with the bond-length coordinate and choosing $\\kappa$ so that the thermal root-mean-square amplitude of $\\delta r$ equals $\\tau$.\n2. Using the linear stability condition for the velocity-Verlet (Störmer–Verlet) integration of a one-dimensional harmonic oscillator, derive the largest stable time step $h_{\\max}$ in terms of $m$, $k_{B}$, $T$, and $\\tau$.\n\nExpress the final answer as a single closed-form analytic expression for $h_{\\max}$. No numerical values are provided, and no rounding is required. Do not include units in your final boxed expression.",
            "solution": "The solution is developed in two parts as requested by the problem statement.\n\n**Part 1: Derivation of the effective angular frequency $\\omega_{\\text{eff}}$**\n\nWe begin by analyzing the dynamics of the two-particle system. Let the position vectors of the two atoms be $\\mathbf{r}_{1}$ and $\\mathbf{r}_{2}$. The total kinetic energy of the system is given by:\n$$\nK = \\frac{1}{2} m |\\dot{\\mathbf{r}}_{1}|^2 + \\frac{1}{2} m |\\dot{\\mathbf{r}}_{2}|^2\n$$\nIt is advantageous to transform to center-of-mass and relative coordinates. The center-of-mass vector $\\mathbf{R}$ and the relative position vector $\\mathbf{r}$ are defined as:\n$$\n\\mathbf{R} = \\frac{\\mathbf{r}_{1} + \\mathbf{r}_{2}}{2}, \\quad \\mathbf{r} = \\mathbf{r}_{2} - \\mathbf{r}_{1}\n$$\nInverting these relations, we have $\\mathbf{r}_{1} = \\mathbf{R} - \\frac{1}{2}\\mathbf{r}$ and $\\mathbf{r}_{2} = \\mathbf{R} + \\frac{1}{2}\\mathbf{r}$. The corresponding velocities are $\\dot{\\mathbf{r}}_{1} = \\dot{\\mathbf{R}} - \\frac{1}{2}\\dot{\\mathbf{r}}$ and $\\dot{\\mathbf{r}}_{2} = \\dot{\\mathbf{R}} + \\frac{1}{2}\\dot{\\mathbf{r}}$. Substituting these into the kinetic energy expression:\n$$\nK = \\frac{1}{2} m \\left|\\dot{\\mathbf{R}} - \\frac{1}{2}\\dot{\\mathbf{r}}\\right|^2 + \\frac{1}{2} m \\left|\\dot{\\mathbf{R}} + \\frac{1}{2}\\dot{\\mathbf{r}}\\right|^2\n$$\n$$\nK = \\frac{1}{2} m \\left( |\\dot{\\mathbf{R}}|^2 - \\dot{\\mathbf{R}} \\cdot \\dot{\\mathbf{r}} + \\frac{1}{4}|\\dot{\\mathbf{r}}|^2 \\right) + \\frac{1}{2} m \\left( |\\dot{\\mathbf{R}}|^2 + \\dot{\\mathbf{R}} \\cdot \\dot{\\mathbf{r}} + \\frac{1}{4}|\\dot{\\mathbf{r}}|^2 \\right)\n$$\n$$\nK = \\frac{1}{2} (2m) |\\dot{\\mathbf{R}}|^2 + \\frac{1}{2} \\left(\\frac{m}{2}\\right) |\\dot{\\mathbf{r}}|^2\n$$\nThe kinetic energy separates into a term for the center-of-mass motion with total mass $M = 2m$ and a term for the relative motion with a reduced mass $\\mu = \\frac{m \\cdot m}{m + m} = \\frac{m}{2}$.\n\nThe problem states that the effect of the imperfect constraint is modeled by a potential $V_{p} = \\frac{1}{2}\\kappa (\\delta r)^2$, where $\\delta r = |\\mathbf{r}| - r_{0}$. This potential acts along the bond direction. The force associated with this potential is $F = -\\frac{d V_p}{d(\\delta r)} = -\\kappa(\\delta r)$. Since $\\delta r$ represents the displacement from equilibrium for the relative coordinate's magnitude, the equation of motion for this small displacement is that of a simple harmonic oscillator:\n$$\n\\mu \\frac{d^2(\\delta r)}{dt^2} = -\\kappa (\\delta r)\n$$\nThe angular frequency $\\omega$ of a harmonic oscillator described by $\\mu \\ddot{x} = -kx$ is given by $\\omega^2 = k/\\mu$. In our case, the mass is the reduced mass $\\mu = m/2$ and the spring constant is $\\kappa$. Therefore, the effective angular frequency $\\omega_{\\text{eff}}$ of the spurious vibrational mode is given by:\n$$\n\\omega_{\\text{eff}}^2 = \\frac{\\kappa}{\\mu} = \\frac{\\kappa}{m/2} = \\frac{2\\kappa}{m}\n$$\nTo find $\\omega_{\\text{eff}}$, we must first determine $\\kappa$. The problem instructs us to use the equipartition theorem and the condition that the RMS amplitude of $\\delta r$ is $\\tau$. The potential energy $V_p = \\frac{1}{2}\\kappa (\\delta r)^2$ is a quadratic function of the coordinate $\\delta r$. According to the equipartition theorem, the average thermal energy stored in this potential mode at temperature $T$ is:\n$$\n\\langle V_p \\rangle = \\frac{1}{2} k_{B} T\n$$\nSubstituting the expression for $V_p$:\n$$\n\\left\\langle \\frac{1}{2}\\kappa (\\delta r)^2 \\right\\rangle = \\frac{1}{2} \\kappa \\langle (\\delta r)^2 \\rangle = \\frac{1}{2} k_{B} T\n$$\nThis gives $\\kappa \\langle (\\delta r)^2 \\rangle = k_{B} T$.\nThe root-mean-square (RMS) amplitude of $\\delta r$ is defined as $\\sqrt{\\langle (\\delta r)^2 \\rangle}$. We are given that this RMS value equals the tolerance $\\tau$.\n$$\n\\sqrt{\\langle (\\delta r)^2 \\rangle} = \\tau \\implies \\langle (\\delta r)^2 \\rangle = \\tau^2\n$$\nSubstituting this into the equation for $\\kappa$:\n$$\n\\kappa \\tau^2 = k_{B} T \\implies \\kappa = \\frac{k_{B} T}{\\tau^2}\n$$\nNow we can find $\\omega_{\\text{eff}}$\n$$\n\\omega_{\\text{eff}}^2 = \\frac{2\\kappa}{m} = \\frac{2}{m} \\left( \\frac{k_{B} T}{\\tau^2} \\right) = \\frac{2 k_{B} T}{m \\tau^2}\n$$\nTaking the square root gives the effective angular frequency:\n$$\n\\omega_{\\text{eff}} = \\sqrt{\\frac{2 k_{B} T}{m \\tau^2}} = \\frac{1}{\\tau} \\sqrt{\\frac{2 k_{B} T}{m}}\n$$\n\n**Part 2: Derivation of the maximum stable time step $h_{\\max}$**\n\nThe stability of a numerical integration scheme is limited by the highest frequency present in the system. In this model, the spurious high-frequency mode with frequency $\\omega_{\\text{eff}}$ is the limiting factor. The problem specifies using the linear stability condition for the velocity-Verlet integration of a one-dimensional harmonic oscillator. For an oscillator with equation of motion $\\ddot{x} = -\\omega^2 x$, the velocity-Verlet algorithm is stable if and only if the time step $h$ satisfies the condition:\n$$\n\\omega h \\leq 2\n$$\nThe maximum stable time step $h_{\\max}$ is therefore given by the equality:\n$$\nh_{\\max} = \\frac{2}{\\omega}\n$$\nApplying this to our system, the relevant frequency is $\\omega = \\omega_{\\text{eff}}$.\n$$\nh_{\\max} = \\frac{2}{\\omega_{\\text{eff}}}\n$$\nSubstituting the expression for $\\omega_{\\text{eff}}$ derived in Part 1:\n$$\nh_{\\max} = \\frac{2}{\\frac{1}{\\tau} \\sqrt{\\frac{2 k_{B} T}{m}}} = 2 \\tau \\sqrt{\\frac{m}{2 k_{B} T}}\n$$\nWe can simplify this expression by moving the factor of $2$ inside the square root:\n$$\nh_{\\max} = \\tau \\sqrt{\\frac{4m}{2 k_{B} T}} = \\tau \\sqrt{\\frac{2m}{k_{B} T}}\n$$\nThis is the final expression for the largest stable time step.",
            "answer": "$$\\boxed{\\tau\\sqrt{\\frac{2m}{k_{B}T}}}$$"
        },
        {
            "introduction": "Faithful MD simulations must not only be stable but must also respect fundamental conservation laws, such as the conservation of energy in a microcanonical (NVE) ensemble. A major challenge is the computationally necessary truncation of long-range non-bonded forces, which can introduce artifacts that violate energy conservation. This problem requires you to reason through the consequences of two popular truncation methods, the shifted-potential and shifted-force schemes, on energy drift, pressure, and local structure, providing critical practical knowledge for setting up robust and physically meaningful simulations .",
            "id": "3782540",
            "problem": "Consider a bulk fluid of particles interacting via the Lennard-Jones potential $u(r) = 4\\epsilon\\left[\\left(\\dfrac{\\sigma}{r}\\right)^{12} - \\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right]$ under periodic boundary conditions. A Molecular Dynamics (MD) simulation in the Number, Volume, Energy (NVE) ensemble is carried out using the velocity-Verlet integrator with reduced density $\\rho^{*} = \\rho\\sigma^{3} = 0.85$, reduced temperature $T^{*} = k_{B}T/\\epsilon = 1.2$, reduced time step $\\Delta t^{*} = \\Delta t\\sqrt{\\epsilon/m}/\\sigma = 0.005$, and a spherical cutoff $r_{c} = 2.5\\sigma$.\n\nTwo truncation schemes for the pair interaction are considered:\n\n- Shifted-potential (SP): the potential is modified to $u_{\\mathrm{SP}}(r) = u(r) - u(r_{c})$ for $r < r_{c}$ and $u_{\\mathrm{SP}}(r) = 0$ for $r \\ge r_{c}$, with the force $f_{\\mathrm{SP}}(r) = -\\dfrac{du}{dr}$ for $r < r_{c}$ and $f_{\\mathrm{SP}}(r) = 0$ for $r \\ge r_{c}$.\n- Shifted-force (SF): the force is modified to $f_{\\mathrm{SF}}(r) = -\\dfrac{du}{dr} - \\left.-\\dfrac{du}{dr}\\right|_{r = r_{c}}$ for $r < r_{c}$ and $f_{\\mathrm{SF}}(r) = 0$ for $r \\ge r_{c}$, with a corresponding potential $u_{\\mathrm{SF}}(r)$ chosen so that $f_{\\mathrm{SF}}(r) = -\\dfrac{du_{\\mathrm{SF}}}{dr}$ and $u_{\\mathrm{SF}}(r_{c}) = 0$.\n\nStarting from Newton’s second law $m\\dfrac{d^{2}\\mathbf{r}_{i}}{dt^{2}} = \\sum_{j \\ne i}\\mathbf{f}_{ij}$, the definition of conservative force $\\mathbf{f}_{ij} = -\\nabla u(r_{ij})$, and the expression for the virial pressure $P = \\rho k_{B}T + \\dfrac{1}{3V}\\sum_{i<j}\\mathbf{r}_{ij}\\cdot\\mathbf{f}_{ij}$, reason about how the discontinuity or continuity of the force at $r_{c}$ impacts numerical energy conservation in the NVE dynamics and the virial pressure. Also consider the Radial Distribution Function (RDF), defined as $g(r) = \\dfrac{1}{4\\pi r^{2}\\rho N}\\left\\langle\\sum_{i\\ne j}\\delta(r - r_{ij})\\right\\rangle$, as a structural property, and assess how the two schemes affect $g(r)$ at short distances $r \\ll r_{c}$ versus near the cutoff $r \\lesssim r_{c}$.\n\nAssume that for the state point specified, the Lennard-Jones force at the cutoff is weakly attractive, i.e., $\\left.-\\dfrac{du}{dr}\\right|_{r = r_{c}} < 0$, and that $g(r)$ is close to $1$ for $r$ in a narrow shell just below $r_{c}$. Answer the following multiple-choice question by selecting the option that most accurately captures the expected quantitative trends in energy conservation and structural and thermodynamic properties under the given conditions.\n\nWhich of the following statements is most consistent with first-principles reasoning and typical magnitudes for the specified setup?\n\nA. In the NVE simulation at $r_{c} = 2.5\\sigma$ and $\\Delta t^{*} = 0.005$, the shifted-force scheme yields an order-of-magnitude smaller energy drift per particle compared to the shifted-potential scheme because the force is continuous at $r_{c}$. The shifted-force scheme produces a slightly higher virial pressure, by approximately $2\\%$ to $5\\%$, and changes in $g(r)$ at short distances $r < 1.5\\sigma$ are negligible (less than $1\\%$), with only minor deviations near $r \\lesssim r_{c}$.\n\nB. The shifted-potential scheme conserves total energy exactly in discrete time because the potential is continuous, while the shifted-force scheme exhibits larger energy drift due to its modified potential; both schemes produce identical virial pressure for $r_{c} = 2.5\\sigma$.\n\nC. Both truncation schemes yield zero energy drift in the thermodynamic limit for any $\\Delta t^{*} > 0$, but the shifted-force scheme significantly distorts the Radial Distribution Function (RDF) $g(r)$ over the entire range $r < r_{c}$, with deviations exceeding $10\\%$.\n\nD. Enforcing $f(r_{c}) = 0$ via the shifted-force scheme eliminates the need for long-range tail corrections to the pressure and energy; the shifted-potential scheme requires such corrections. For the chosen parameters, the energy drift is practically identical for both schemes.\n\nSelect the single best option.",
            "solution": "### Analysis of Truncation Schemes\n\nThe core of the problem lies in understanding the consequences of the continuity of the potential and its derivatives at the cutoff radius $r_c$.\n\n**1. Energy Conservation**\n\nIn an NVE simulation, the total energy $E = K + U$ should be conserved. Numerical integrators like velocity-Verlet conserve a nearby \"shadow Hamiltonian\" very well, provided the potential energy function is sufficiently smooth. The quality of energy conservation is critically dependent on the continuity of the force, $\\mathbf{f}(r) = -\\nabla u(r)$.\n\n-   **Shifted-Potential (SP) Scheme:** The potential is defined as $u_{\\mathrm{SP}}(r) = u(r) - u(r_c)$ for $r < r_c$ and $0$ otherwise. It is continuous at $r_c$ since $u_{\\mathrm{SP}}(r_c) = u(r_c) - u(r_c) = 0$. However, the force is given by $f_{\\mathrm{SP}}(r) = -\\frac{du}{dr}$ for $r < r_c$ and $0$ for $r \\ge r_c$. Since the LJ force $f(r_c) = -\\frac{du}{dr}|_{r=r_c}$ is non-zero (and attractive, per the problem statement), there is a discontinuity in the force at $r_c$: $\\lim_{r\\to r_c^-} f_{\\mathrm{SP}}(r) = f(r_c) \\neq 0 = \\lim_{r\\to r_c^+} f_{\\mathrm{SP}}(r)$. This force discontinuity introduces impulse-like errors when particles cross the cutoff radius, leading to a systematic violation of energy conservation. The total energy exhibits a noticeable, often linear, drift over time.\n\n-   **Shifted-Force (SF) Scheme:** The force is defined as $f_{\\mathrm{SF}}(r) = f(r) - f(r_c)$ for $r < r_c$ and $0$ otherwise. By construction, the force is continuous at $r_c$: $\\lim_{r\\to r_c^-} f_{\\mathrm{SF}}(r) = f(r_c) - f(r_c) = 0$, which matches the force for $r \\ge r_c$. Because the force is continuous, the velocity-Verlet integrator conserves the energy of the modified system (governed by the SF potential) very well. The energy will show small fluctuations around a constant value with a very small drift, typically orders of magnitude smaller than in the SP case for the same time step $\\Delta t$.\n\n**Conclusion on Energy Conservation:** The SF scheme provides vastly superior energy conservation compared to the SP scheme due to its continuous force at the cutoff.\n\n**2. Virial Pressure**\n\nThe pressure is calculated using the virial theorem, $P = \\rho k_{B}T + W$, where $W = \\frac{1}{3V}\\langle \\sum_{i<j} \\mathbf{r}_{ij} \\cdot \\mathbf{f}_{ij} \\rangle$ is the internal virial. The force $\\mathbf{f}_{ij}$ is the one used in the simulation.\n\n-   $P_{\\mathrm{SP}}$ uses the force $\\mathbf{f}_{\\mathrm{SP}}$.\n-   $P_{\\mathrm{SF}}$ uses the force $\\mathbf{f}_{\\mathrm{SF}}$.\n\nFor $r < r_c$, $\\mathbf{f}_{\\mathrm{SF}}(\\mathbf{r}) = \\mathbf{f}_{\\mathrm{SP}}(\\mathbf{r}) - \\mathbf{f}(r_c)$, where $\\mathbf{f}(r_c)$ is a vector with magnitude $f(r_c)$ parallel to $\\mathbf{r}$. The difference in the virial terms is therefore related to the extra term in the SF force. Assuming the structural differences ($g_{\\mathrm{SP}}(r)$ vs $g_{\\mathrm{SF}}(r)$) are minor, the primary difference in pressure comes from the explicit force modification.\n$$ P_{\\mathrm{SF}} - P_{\\mathrm{SP}} \\approx \\frac{1}{3V} \\left\\langle \\sum_{i<j, r_{ij}<r_c} \\mathbf{r}_{ij} \\cdot (\\mathbf{f}_{\\mathrm{SP}} - \\mathbf{f}(r_c)) - \\mathbf{r}_{ij} \\cdot \\mathbf{f}_{\\mathrm{SP}} \\right\\rangle $$\n$$ P_{\\mathrm{SF}} - P_{\\mathrm{SP}} \\approx -\\frac{1}{3V} \\left\\langle \\sum_{i<j, r_{ij}<r_c} \\mathbf{r}_{ij} \\cdot \\mathbf{f}(r_c) \\right\\rangle = -\\frac{f(r_c)}{3V} \\left\\langle \\sum_{i<j, r_{ij}<r_c} r_{ij} \\right\\rangle $$\nThe problem states that the force is attractive, so $f(r_c) < 0$. The sum $\\sum r_{ij}$ is always positive. Therefore, the term $-\\frac{f(r_c)}{3V} \\langle \\sum r_{ij} \\rangle$ is positive. This implies $P_{\\mathrm{SF}} > P_{\\mathrm{SP}}$. The SF scheme yields a higher pressure than the SP scheme.\n\n**3. Radial Distribution Function ($g(r)$)**\n\nThe structure, described by $g(r)$, depends on the pair potential $u(r)$ via the Boltzmann factor $\\exp(-u(r)/k_B T)$.\nThe SP scheme uses a potential $u_{\\mathrm{SP}}(r) = u(r) - u(r_c)$ which for $r < r_c$ only differs from the true LJ potential by a constant. Since forces are derived from potential *gradients*, the forces for $r<r_c$ are identical to the unmodified LJ forces. Thus, $g_{\\mathrm{SP}}(r)$ should be very close to the true $g(r)$ of an LJ system for $r<r_c$.\nThe SF scheme uses a potential $u_{\\mathrm{SF}}(r)$ which can be found by integrating the force:\n$$ u_{\\mathrm{SF}}(r) = u(r) - u(r_c) - (r-r_c)f(r_c) = u_{\\mathrm{SP}}(r) - (r-r_c)f(r_c) $$\nThe difference $\\Delta u(r) = u_{\\mathrm{SF}}(r) - u_{\\mathrm{SP}}(r) = -(r-r_c)f(r_c)$. Since $r < r_c$ and $f(r_c) < 0$, the perturbation $\\Delta u(r)$ is positive. According to perturbation theory, $g_{\\mathrm{SF}}(r) \\approx g_{\\mathrm{SP}}(r) \\exp(-\\Delta u(r)/k_B T)$. This means $g_{\\mathrm{SF}}(r)$ will be slightly suppressed compared to $g_{\\mathrm{SP}}(r)$ for $r < r_c$. The perturbation is a linear ramp, which is a small modification compared to the LJ potential itself, especially at short distances where the LJ potential is large. The potential perturbation $\\Delta u(r)$ is on the order of a few percent of $k_BT$, so the resulting change in $g(r)$ is expected to be small, likely a few percent, and not a major distortion.\n\n### Evaluation of Options\n\n**A. In the NVE simulation at $r_{c} = 2.5\\sigma$ and $\\Delta t^{*} = 0.005$, the shifted-force scheme yields an order-of-magnitude smaller energy drift per particle compared to the shifted-potential scheme because the force is continuous at $r_{c}$. The shifted-force scheme produces a slightly higher virial pressure, by approximately $2\\%$ to $5\\%$, and changes in $g(r)$ at short distances $r < 1.5\\sigma$ are negligible (less than $1\\%$), with only minor deviations near $r \\lesssim r_{c}$.**\n-   **Energy Drift:** The reasoning and conclusion are correct. The SF scheme is known for superior energy conservation.\n-   **Virial Pressure:** The direction of the change ($P_{\\mathrm{SF}} > P_{\\mathrm{SP}}$) is correct. The magnitude of \"$2\\%$ to $5\\%$\" is a plausible \"slight\" increase.\n-   **$g(r)$:** The statement that changes are small and most prominent near the cutoff is correct. The distortion is minor.\n-   **Overall:** This statement captures the key physical trends accurately.\n\n**B. The shifted-potential scheme conserves total energy exactly in discrete time because the potential is continuous, while the shifted-force scheme exhibits larger energy drift due to its modified potential; both schemes produce identical virial pressure for $r_{c} = 2.5\\sigma$.**\n-   This is incorrect. Energy conservation relies on force continuity. The SP scheme has poor energy conservation. The pressures will not be identical.\n\n**C. Both truncation schemes yield zero energy drift in the thermodynamic limit for any $\\Delta t^{*} > 0$, but the shifted-force scheme significantly distorts the Radial Distribution Function (RDF) $g(r)$ over the entire range $r < r_{c}$, with deviations exceeding $10\\%$.**\n-   This is incorrect. The thermodynamic limit does not eliminate numerical integration errors. The distortion of the RDF by the SF scheme is known to be minor.\n\n**D. Enforcing $f(r_{c}) = 0$ via the shifted-force scheme eliminates the need for long-range tail corrections to the pressure and energy; the shifted-potential scheme requires such corrections. For the chosen parameters, the energy drift is practically identical for both schemes.**\n-   This is incorrect. The energy drift is significantly different.\n\n### Final Conclusion\n\nOption A provides the most accurate physical description of the comparison. It correctly identifies the key differences in energy conservation, pressure, and structure.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}