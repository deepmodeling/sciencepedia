{
    "hands_on_practices": [
        {
            "introduction": "The velocity Verlet algorithm is the workhorse of molecular dynamics, but its stability is conditional. This exercise  provides a crucial first-principles analysis of this stability by examining the simplest relevant model: the harmonic oscillator. By deriving the integrator's amplification matrix, you will determine the absolute maximum time step, a result that governs the choice of integration parameters in all MD simulations.",
            "id": "3782502",
            "problem": "In Molecular Dynamics (MD), the velocities and positions of particles are advanced in time using time-integration schemes derived from Newton’s second law. Consider a single particle of mass $m$ confined to one spatial dimension and subject to a harmonic force $F(x)=-kx$, so that its equation of motion is $m\\,\\ddot{x}=-kx$. This linear oscillator models small-amplitude vibrations near a stable equilibrium and is a standard surrogate for analyzing timestep stability in explicit integrators used in multiscale modeling.\n\nStarting from Newton’s second law and the definition of acceleration $a(x) = \\ddot{x} = F(x)/m$, adopt the standard velocity Verlet algorithm, which advances positions and velocities over a timestep $\\Delta t$ via one position update using the current velocity and acceleration, followed by a velocity update that uses the average of the current and next-step accelerations. For the harmonic oscillator, the acceleration is $a(x)=-\\omega^{2}x$ with $\\omega=\\sqrt{k/m}$.\n\n1. Derive, in closed form, the single-step linear update that maps the state $(x_{n},v_{n})$ at time $t_{n}$ to $(x_{n+1},v_{n+1})$ at time $t_{n+1}=t_{n}+\\Delta t$ under velocity Verlet. Write this mapping as an amplification matrix $A(\\omega,\\Delta t)$ acting on the state vector, that is,\n   $$\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A(\\omega,\\Delta t)\\,\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}.$$\n\n2. Using the eigenvalues of $A(\\omega,\\Delta t)$, analyze the linear stability of the scheme. Impose the condition that the amplification factors have magnitude less than or equal to $1$ (no exponential growth), and determine the maximum stable timestep $\\Delta t_{\\max}$ as a function of $\\omega$.\n\nExpress your final answer for $\\Delta t_{\\max}$ as a closed-form analytic expression in terms of $\\omega$. Do not substitute numerical values and do not include units in your final answer. If you choose to evaluate $\\Delta t_{\\max}$ numerically for a particular $\\omega$ for your own verification, express time in seconds and round to four significant figures.",
            "solution": "The problem requires the derivation of the one-step update matrix for the velocity Verlet algorithm applied to a simple harmonic oscillator, followed by a linear stability analysis to determine the maximum stable timestep.\n\nThe equation of motion for the one-dimensional harmonic oscillator is given by $m\\ddot{x} = -kx$, where $m$ is the mass, $x$ is the position, and $k$ is the spring constant. The acceleration is $a(x) = \\ddot{x} = -\\frac{k}{m}x$. By defining the angular frequency $\\omega = \\sqrt{k/m}$, the acceleration can be written as $a(x) = -\\omega^2 x$.\n\nThe velocity Verlet algorithm consists of two main steps for advancing the state from time $t_n$ to $t_{n+1} = t_n + \\Delta t$:\n1. Position update: $$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2} a_n (\\Delta t)^2$$\n2. Velocity update: $$v_{n+1} = v_n + \\frac{1}{2}(a_n + a_{n+1})\\Delta t$$\nHere, $(x_n, v_n)$ is the state at time $t_n$, $\\Delta t$ is the timestep, and $a_n = a(x_n)$ and $a_{n+1} = a(x_{n+1})$ are the accelerations at the current and next timesteps, respectively.\n\n**Part 1: Derivation of the Update Matrix $A(\\omega, \\Delta t)$**\n\nWe substitute the specific acceleration for the harmonic oscillator, $a_n = -\\omega^2 x_n$ and $a_{n+1} = -\\omega^2 x_{n+1}$, into the algorithm's equations.\n\nThe position update becomes:\n$$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2}(-\\omega^2 x_n)(\\Delta t)^2$$\nRearranging to group terms of $x_n$ and $v_n$:\n$$x_{n+1} = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n$$\nThis equation provides the first row of the amplification matrix $A$.\n\nThe velocity update is:\n$$v_{n+1} = v_n + \\frac{1}{2}(-\\omega^2 x_n - \\omega^2 x_{n+1}) \\Delta t$$\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t (x_n + x_{n+1})$$\nTo express $v_{n+1}$ solely in terms of the state at time $t_n$, $(x_n, v_n)$, we substitute the expression for $x_{n+1}$ that we just derived:\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t \\left[x_n + \\left( \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n \\right) \\right]$$\nCollecting terms for $x_n$ and $v_n$ inside the brackets:\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t \\left[ \\left(2 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n \\right]$$\nDistributing the factor $-\\frac{1}{2}\\omega^2 \\Delta t$:\n$$v_{n+1} = v_n - \\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) x_n - \\frac{1}{2}\\omega^2 (\\Delta t)^2 v_n$$\nFinally, grouping the terms for $x_n$ and $v_n$:\n$$v_{n+1} = - \\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) x_n + \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right)v_n$$\nThis equation provides the second row of the matrix $A$.\n\nCombining these two results into the matrix equation $\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$, we identify the amplification matrix $A$ as:\n$$A(\\omega, \\Delta t) = \\begin{pmatrix} 1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 & \\Delta t \\\\ -\\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) & 1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\end{pmatrix}$$\n\n**Part 2: Stability Analysis**\n\nThe stability of the numerical scheme is determined by the eigenvalues, $\\lambda$, of the amplification matrix $A$. The scheme is stable if and only if all eigenvalues have a magnitude less than or equal to $1$, i.e., $|\\lambda| \\le 1$. The eigenvalues are the roots of the characteristic equation $\\det(A - \\lambda I) = 0$, which can be written as $\\lambda^2 - \\text{Tr}(A)\\lambda + \\det(A) = 0$.\n\nFirst, we compute the trace and determinant of $A$.\nThe trace is the sum of the diagonal elements:\n$$\\text{Tr}(A) = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) + \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) = 2 - \\omega^2 (\\Delta t)^2$$\nThe determinant is:\n$$\\det(A) = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right)^2 - (\\Delta t) \\left(-\\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)\\right)$$\n$$\\det(A) = \\left(1 - \\omega^2 (\\Delta t)^2 + \\frac{1}{4}\\omega^4 (\\Delta t)^4\\right) + \\omega^2 (\\Delta t)^2 \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)$$\n$$\\det(A) = 1 - \\omega^2 (\\Delta t)^2 + \\frac{1}{4}\\omega^4 (\\Delta t)^4 + \\omega^2 (\\Delta t)^2 - \\frac{1}{4}\\omega^4 (\\Delta t)^4 = 1$$\nThe property $\\det(A)=1$ confirms that the velocity Verlet algorithm is a symplectic integrator, which conserves phase-space volume for Hamiltonian systems.\n\nThe characteristic equation for the eigenvalues is:\n$$\\lambda^2 - \\left(2 - \\omega^2 (\\Delta t)^2\\right)\\lambda + 1 = 0$$\nUsing the quadratic formula to solve for $\\lambda$:\n$$\\lambda = \\frac{(2 - \\omega^2 (\\Delta t)^2) \\pm \\sqrt{(2 - \\omega^2 (\\Delta t)^2)^2 - 4}}{2}$$\n$$\\lambda = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) \\pm \\sqrt{\\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right)^2 - 1}$$\nLet's define a dimensionless parameter $s = \\omega \\Delta t$. The expression for the eigenvalues becomes:\n$$\\lambda = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{\\left(1 - \\frac{s^2}{2}\\right)^2 - 1} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{1 - s^2 + \\frac{s^4}{4} - 1} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{\\frac{s^4}{4} - s^2}$$\n\nThe nature of the eigenvalues depends on the sign of the discriminant $D = \\frac{s^4}{4} - s^2 = s^2\\left(\\frac{s^2}{4} - 1\\right)$.\n\nCase 1: Stable Regime ($s^2 < 4$, or $|\\omega \\Delta t| < 2$).\nThe discriminant is negative, so the eigenvalues are a complex conjugate pair.\n$$|\\lambda|^2 = \\left(1 - \\frac{s^2}{2}\\right)^2 - \\left(\\frac{s^4}{4} - s^2\\right) = 1 - s^2 + \\frac{s^4}{4} - \\frac{s^4}{4} + s^2 = 1$$\nThus, for $|\\omega \\Delta t| < 2$, the eigenvalues lie on the unit circle ($|\\lambda|=1$), and the algorithm is stable. The solution does not grow or decay in amplitude, correctly modeling the energy conservation of the oscillator.\n\nCase 2: Stability Boundary ($s^2 = 4$, or $|\\omega \\Delta t| = 2$).\nThe discriminant is zero, resulting in a repeated real eigenvalue:\n$$\\lambda = 1 - \\frac{s^2}{2} = 1 - \\frac{4}{2} = -1$$\nThe magnitude is $|\\lambda| = 1$, so the scheme is marginally stable.\n\nCase 3: Unstable Regime ($s^2 > 4$, or $|\\omega \\Delta t| > 2$).\nThe discriminant is positive, so the eigenvalues are real and distinct:\n$$\\lambda_{\\pm} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{s^2\\left(\\frac{s^2}{4} - 1\\right)}$$\nSince $\\det(A) = \\lambda_+\\lambda_- = 1$, one eigenvalue must have a magnitude greater than $1$ and the other less than $1$. For $s^2 > 4$, the term $1 - \\frac{s^2}{2}$ is less than $-1$. The eigenvalue $\\lambda_- = (1 - s^2/2) - \\sqrt{...}$ will therefore be a real number with magnitude greater than $1$. This leads to exponential growth of the solution, so the scheme is unstable.\n\nThe condition for linear stability, $|\\lambda| \\le 1$, is satisfied if and only if $s^2 \\le 4$. Since $\\omega > 0$ and $\\Delta t > 0$, this is equivalent to $\\omega \\Delta t \\le 2$.\n\nThe maximum stable timestep, $\\Delta t_{\\max}$, corresponds to the equality:\n$$\\omega \\Delta t_{\\max} = 2$$\nSolving for $\\Delta t_{\\max}$ gives:\n$$\\Delta t_{\\max} = \\frac{2}{\\omega}$$\nThis is the stability limit for the velocity Verlet algorithm applied to the simple harmonic oscillator.",
            "answer": "$$\\boxed{\\frac{2}{\\omega}}$$"
        },
        {
            "introduction": "To increase the time step, we often constrain the fastest motions, such as bond vibrations. This practice  explores the subtle but profound consequences of enforcing these constraints with a finite numerical tolerance. By modeling the imperfectly constrained bond as a stiff spring, you will uncover how numerical methods can introduce high-frequency \"ghost\" modes that, in turn, limit the very time step we sought to increase.",
            "id": "3782515",
            "problem": "Consider a simple constrained Molecular Dynamics (MD) system consisting of two identical atoms of mass $m$ in three-dimensional space whose interatomic distance is constrained to a fixed value $r_{0}$ by a holonomic constraint. The constraint is enforced with a position-level iterative corrector akin to SHAKE and a velocity-level corrector akin to RATTLE, but in practice the corrector is terminated when the residual bond-length violation magnitude $\\delta r = |\\mathbf{r}_{2} - \\mathbf{r}_{1}| - r_{0}$ satisfies $|\\delta r| \\leq \\tau$, where $\\tau$ is a prescribed tolerance. Assume that near the constrained manifold, the leading-order effect of terminating the constraint iterations at tolerance $\\tau$ can be modeled by augmenting the Hamiltonian with a small harmonic penalty potential $V_{p} = \\frac{1}{2}\\,\\kappa\\,(\\delta r)^{2}$ that acts only along the constrained bond direction, thereby replacing the ideal constraint with a stiff but finite restoring force.\n\nStarting only from:\n- Newton’s second law (force equals mass times acceleration),\n- the definition of holonomic constraints and the relative coordinate for a two-particle system,\n- and the equipartition theorem of statistical mechanics at temperature $T$, which states that for a quadratic degree of freedom the mean thermal energy is $\\frac{1}{2} k_{B} T$, where $k_{B}$ is the Boltzmann constant,\n\ndo the following:\n1. Derive, in terms of $m$, $k_{B}$, $T$, and $\\tau$, the effective angular frequency $\\omega_{\\text{eff}}$ of the spurious vibrational mode introduced by the finite constraint tolerance $\\tau$, by identifying the appropriate effective mass associated with the bond-length coordinate and choosing $\\kappa$ so that the thermal root-mean-square amplitude of $\\delta r$ equals $\\tau$.\n2. Using the linear stability condition for the velocity-Verlet (Störmer–Verlet) integration of a one-dimensional harmonic oscillator, derive the largest stable time step $h_{\\max}$ in terms of $m$, $k_{B}$, $T$, and $\\tau$.\n\nExpress the final answer as a single closed-form analytic expression for $h_{\\max}$. No numerical values are provided, and no rounding is required. Do not include units in your final boxed expression.",
            "solution": "The solution is developed in two parts as requested by the problem statement.\n\n**Part 1: Derivation of the effective angular frequency $\\omega_{\\text{eff}}$**\n\nWe begin by analyzing the dynamics of the two-particle system. Let the position vectors of the two atoms be $\\mathbf{r}_{1}$ and $\\mathbf{r}_{2}$. The total kinetic energy of the system is given by:\n$$\nK = \\frac{1}{2} m |\\dot{\\mathbf{r}}_{1}|^2 + \\frac{1}{2} m |\\dot{\\mathbf{r}}_{2}|^2\n$$\nIt is advantageous to transform to center-of-mass and relative coordinates. The center-of-mass vector $\\mathbf{R}$ and the relative position vector $\\mathbf{r}$ are defined as:\n$$\n\\mathbf{R} = \\frac{\\mathbf{r}_{1} + \\mathbf{r}_{2}}{2}, \\quad \\mathbf{r} = \\mathbf{r}_{2} - \\mathbf{r}_{1}\n$$\nInverting these relations, we have $\\mathbf{r}_{1} = \\mathbf{R} - \\frac{1}{2}\\mathbf{r}$ and $\\mathbf{r}_{2} = \\mathbf{R} + \\frac{1}{2}\\mathbf{r}$. The corresponding velocities are $\\dot{\\mathbf{r}}_{1} = \\dot{\\mathbf{R}} - \\frac{1}{2}\\dot{\\mathbf{r}}$ and $\\dot{\\mathbf{r}}_{2} = \\dot{\\mathbf{R}} + \\frac{1}{2}\\dot{\\mathbf{r}}$. Substituting these into the kinetic energy expression:\n$$\nK = \\frac{1}{2} m \\left|\\dot{\\mathbf{R}} - \\frac{1}{2}\\dot{\\mathbf{r}}\\right|^2 + \\frac{1}{2} m \\left|\\dot{\\mathbf{R}} + \\frac{1}{2}\\dot{\\mathbf{r}}\\right|^2\n$$\n$$\nK = \\frac{1}{2} m \\left( |\\dot{\\mathbf{R}}|^2 - \\dot{\\mathbf{R}} \\cdot \\dot{\\mathbf{r}} + \\frac{1}{4}|\\dot{\\mathbf{r}}|^2 \\right) + \\frac{1}{2} m \\left( |\\dot{\\mathbf{R}}|^2 + \\dot{\\mathbf{R}} \\cdot \\dot{\\mathbf{r}} + \\frac{1}{4}|\\dot{\\mathbf{r}}|^2 \\right)\n$$\n$$\nK = \\frac{1}{2} (2m) |\\dot{\\mathbf{R}}|^2 + \\frac{1}{2} \\left(\\frac{m}{2}\\right) |\\dot{\\mathbf{r}}|^2\n$$\nThe kinetic energy separates into a term for the center-of-mass motion with total mass $M = 2m$ and a term for the relative motion with a reduced mass $\\mu = \\frac{m \\cdot m}{m + m} = \\frac{m}{2}$.\n\nThe problem states that the effect of the imperfect constraint is modeled by a potential $V_{p} = \\frac{1}{2}\\kappa (\\delta r)^2$, where $\\delta r = |\\mathbf{r}| - r_{0}$. This potential acts along the bond direction. The force associated with this potential is $F = -\\frac{d V_p}{d(\\delta r)} = -\\kappa(\\delta r)$. Since $\\delta r$ represents the displacement from equilibrium for the relative coordinate's magnitude, the equation of motion for this small displacement is that of a simple harmonic oscillator:\n$$\n\\mu \\frac{d^2(\\delta r)}{dt^2} = -\\kappa (\\delta r)\n$$\nThe angular frequency $\\omega$ of a harmonic oscillator described by $\\mu \\ddot{x} = -kx$ is given by $\\omega^2 = k/\\mu$. In our case, the mass is the reduced mass $\\mu = m/2$ and the spring constant is $\\kappa$. Therefore, the effective angular frequency $\\omega_{\\text{eff}}$ of the spurious vibrational mode is given by:\n$$\n\\omega_{\\text{eff}}^2 = \\frac{\\kappa}{\\mu} = \\frac{\\kappa}{m/2} = \\frac{2\\kappa}{m}\n$$\nTo find $\\omega_{\\text{eff}}$, we must first determine $\\kappa$. The problem instructs us to use the equipartition theorem and the condition that the RMS amplitude of $\\delta r$ is $\\tau$. The potential energy $V_p = \\frac{1}{2}\\kappa (\\delta r)^2$ is a quadratic function of the coordinate $\\delta r$. According to the equipartition theorem, the average thermal energy stored in this potential mode at temperature $T$ is:\n$$\n\\langle V_p \\rangle = \\frac{1}{2} k_{B} T\n$$\nSubstituting the expression for $V_p$:\n$$\n\\left\\langle \\frac{1}{2}\\kappa (\\delta r)^2 \\right\\rangle = \\frac{1}{2} \\kappa \\langle (\\delta r)^2 \\rangle = \\frac{1}{2} k_{B} T\n$$\nThis gives $\\kappa \\langle (\\delta r)^2 \\rangle = k_{B} T$.\nThe root-mean-square (RMS) amplitude of $\\delta r$ is defined as $\\sqrt{\\langle (\\delta r)^2 \\rangle}$. We are given that this RMS value equals the tolerance $\\tau$.\n$$\n\\sqrt{\\langle (\\delta r)^2 \\rangle} = \\tau \\implies \\langle (\\delta r)^2 \\rangle = \\tau^2\n$$\nSubstituting this into the equation for $\\kappa$:\n$$\n\\kappa \\tau^2 = k_{B} T \\implies \\kappa = \\frac{k_{B} T}{\\tau^2}\n$$\nNow we can find $\\omega_{\\text{eff}}$\n$$\n\\omega_{\\text{eff}}^2 = \\frac{2\\kappa}{m} = \\frac{2}{m} \\left( \\frac{k_{B} T}{\\tau^2} \\right) = \\frac{2 k_{B} T}{m \\tau^2}\n$$\nTaking the square root gives the effective angular frequency:\n$$\n\\omega_{\\text{eff}} = \\sqrt{\\frac{2 k_{B} T}{m \\tau^2}} = \\frac{1}{\\tau} \\sqrt{\\frac{2 k_{B} T}{m}}\n$$\n\n**Part 2: Derivation of the maximum stable time step $h_{\\max}$**\n\nThe stability of a numerical integration scheme is limited by the highest frequency present in the system. In this model, the spurious high-frequency mode with frequency $\\omega_{\\text{eff}}$ is the limiting factor. The problem specifies using the linear stability condition for the velocity-Verlet integration of a one-dimensional harmonic oscillator. For an oscillator with equation of motion $\\ddot{x} = -\\omega^2 x$, the velocity-Verlet algorithm is stable if and only if the time step $h$ satisfies the condition:\n$$\n\\omega h \\leq 2\n$$\nThe maximum stable time step $h_{\\max}$ is therefore given by the equality:\n$$\nh_{\\max} = \\frac{2}{\\omega}\n$$\nApplying this to our system, the relevant frequency is $\\omega = \\omega_{\\text{eff}}$.\n$$\nh_{\\max} = \\frac{2}{\\omega_{\\text{eff}}}\n$$\nSubstituting the expression for $\\omega_{\\text{eff}}$ derived in Part 1:\n$$\nh_{\\max} = \\frac{2}{\\frac{1}{\\tau} \\sqrt{\\frac{2 k_{B} T}{m}}} = 2 \\tau \\sqrt{\\frac{m}{2 k_{B} T}}\n$$\nWe can simplify this expression by moving the factor of $2$ inside the square root:\n$$\nh_{\\max} = \\tau \\sqrt{\\frac{4m}{2 k_{B} T}} = \\tau \\sqrt{\\frac{2m}{k_{B} T}}\n$$\nThis is the final expression for the largest stable time step.",
            "answer": "$$\\boxed{\\tau\\sqrt{\\frac{2m}{k_{B}T}}}$$"
        },
        {
            "introduction": "Molecular systems are characterized by a hierarchy of timescales, from fast bond vibrations to slower collective motions. This exercise  demonstrates how to exploit this hierarchy to accelerate simulations using the Reference System Propagator Algorithm (RESPA). You will design a multiple-time-step schedule based on a realistic decomposition of forces and calculate the resulting computational speedup, a key skill in modern high-performance biomolecular simulation.",
            "id": "3782508",
            "problem": "Consider a solvated biomolecular system evolved using Molecular Dynamics (MD). The atomic motion obeys Newton’s second law $m_i \\,\\mathrm{d}^2 \\mathbf{r}_i/\\mathrm{d}t^2 = \\mathbf{F}_i$, where the total force on atom $i$ is decomposed as $\\mathbf{F}_i = \\mathbf{F}_{i}^{\\text{bond}} + \\mathbf{F}_{i}^{\\text{short}} + \\mathbf{F}_{i}^{\\text{long}}$. Here, $\\mathbf{F}_{i}^{\\text{bond}}$ aggregates bonded interactions (covalent bond stretching, angle bending, and torsional terms), $\\mathbf{F}_{i}^{\\text{short}}$ aggregates short-range nonbonded interactions (Lennard–Jones and real-space Coulomb with a spherical cutoff and smooth switching), and $\\mathbf{F}_{i}^{\\text{long}}$ aggregates long-range electrostatics computed by Particle Mesh Ewald (PME). You will design a multiple time step integrator using the Reference System Propagator Algorithm (RESPA) based on this force partitioning and estimate the computational speedup relative to a single time step Verlet scheme.\n\nPropose the following scientifically realistic partitioning and assignment of time steps:\n- Bonded forces $\\mathbf{F}^{\\text{bond}}$: covalent bonds, angles, and torsions. Assign these to the finest inner time step $\\Delta t_b = 1\\,\\mathrm{fs}$.\n- Short-range nonbonded forces $\\mathbf{F}^{\\text{short}}$: Lennard–Jones and direct-space Coulomb up to cutoff $r_c = 1.0\\,\\mathrm{nm}$ with a smooth switching function starting at $r_s = 0.9\\,\\mathrm{nm}$. Assign these to an intermediate time step $\\Delta t_s = 2\\,\\mathrm{fs}$.\n- Long-range electrostatics $\\mathbf{F}^{\\text{long}}$: PME reciprocal-space components with a grid spacing of $0.12\\,\\mathrm{nm}$ and fourth-order B-spline interpolation. Assign these to the outer time step $\\Delta t_\\ell = 6\\,\\mathrm{fs}$.\n\nAssume a baseline single time step Verlet integrator uses $\\Delta t_0 = 2\\,\\mathrm{fs}$ and evaluates all three force categories every step. For a representative solvated biomolecule of approximately $N \\approx 10^5$ atoms, suppose measured wall-clock costs per force evaluation are:\n- Bonded force evaluation cost $C_b = 0.4\\,\\mathrm{ms}$,\n- Short-range force evaluation cost $C_s = 2.5\\,\\mathrm{ms}$,\n- Long-range PME force evaluation cost $C_\\ell = 8.0\\,\\mathrm{ms}$.\n\nStarting from first principles of time discretization under force splitting, derive the speedup obtained by the above RESPA schedule relative to the baseline single time step scheme for simulating a fixed physical time $T$. Your final answer should be the dimensionless speedup factor, rounded to three significant figures. Express the final answer as a dimensionless number.",
            "solution": "The objective is to compute the speedup factor, $S$, which is defined as the ratio of the total computational cost of the baseline single time step scheme to the total cost of the RESPA multiple time step scheme for simulating an identical fixed physical time, $T$.\n$$ S = \\frac{\\text{Cost}_{\\text{baseline}}}{\\text{Cost}_{\\text{RESPA}}} $$\n\nFirst, we will formulate the total cost for the baseline scheme. The baseline integrator uses a single time step $\\Delta t_0$. To simulate a total time $T$, the number of required steps is $N_0 = T / \\Delta t_0$. In each step, all three force components are evaluated. Therefore, the cost per step is $C_{\\text{step},0} = C_b + C_s + C_\\ell$.\nThe total cost for the baseline simulation is the number of steps multiplied by the cost per step:\n$$ \\text{Cost}_{\\text{baseline}} = N_0 \\cdot C_{\\text{step},0} = \\frac{T}{\\Delta t_0} (C_b + C_s + C_\\ell) $$\n\nNext, we formulate the total cost for the RESPA scheme. The RESPA algorithm is structured around the slowest-varying force, which is updated at the outermost time step, $\\Delta t_\\ell$. To simulate the total time $T$, the total number of outermost steps is $N_\\ell = T / \\Delta t_\\ell$. We need to calculate the total computational work performed within one such outer step of duration $\\Delta t_\\ell$.\n\nWithin one outer step of duration $\\Delta t_\\ell$:\n1.  The long-range force, $\\mathbf{F}^{\\text{long}}$, is evaluated once. The cost incurred is $1 \\cdot C_\\ell$.\n2.  The short-range force, $\\mathbf{F}^{\\text{short}}$, is evaluated at every intermediate time step, $\\Delta t_s$. The number of short-range force evaluations within one outer step is $n_s = \\Delta t_\\ell / \\Delta t_s$. The cost incurred is $n_s \\cdot C_s = (\\Delta t_\\ell / \\Delta t_s) \\cdot C_s$.\n3.  The bonded force, $\\mathbf{F}^{\\text{bond}}$, is evaluated at every innermost time step, $\\Delta t_b$. The number of bonded force evaluations within one outer step is $n_b = \\Delta t_\\ell / \\Delta t_b$. The cost incurred is $n_b \\cdot C_b = (\\Delta t_\\ell / \\Delta t_b) \\cdot C_b$.\n\nThe total cost for a single outer RESPA step of duration $\\Delta t_\\ell$ is the sum of these costs:\n$$ C_{\\text{step,RESPA}} = C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b $$\nThe total cost for the RESPA simulation is the number of outer steps multiplied by this cost per outer step:\n$$ \\text{Cost}_{\\text{RESPA}} = N_\\ell \\cdot C_{\\text{step,RESPA}} = \\frac{T}{\\Delta t_\\ell} \\left( C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b \\right) $$\n\nNow we can write the expression for the speedup $S$:\n$$ S = \\frac{\\frac{T}{\\Delta t_0} (C_b + C_s + C_\\ell)}{\\frac{T}{\\Delta t_\\ell} \\left( C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b \\right)} $$\nThe total simulation time $T$ cancels, yielding the general formula for speedup in this context:\n$$ S = \\frac{\\Delta t_\\ell}{\\Delta t_0} \\cdot \\frac{C_b + C_s + C_\\ell}{C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b} $$\n\nWe now substitute the given numerical values into this expression.\n- Time steps: $\\Delta t_0 = 2\\,\\mathrm{fs}$, $\\Delta t_b = 1\\,\\mathrm{fs}$, $\\Delta t_s = 2\\,\\mathrm{fs}$, $\\Delta t_\\ell = 6\\,\\mathrm{fs}$.\n- Costs: $C_b = 0.4\\,\\mathrm{ms}$, $C_s = 2.5\\,\\mathrm{ms}$, $C_\\ell = 8.0\\,\\mathrm{ms}$.\n\nFirst, calculate the numerator term representing the cost per step of the baseline simulation:\n$$ C_{\\text{baseline\\_per\\_step}} = C_b + C_s + C_\\ell = 0.4\\,\\mathrm{ms} + 2.5\\,\\mathrm{ms} + 8.0\\,\\mathrm{ms} = 10.9\\,\\mathrm{ms} $$\n\nNext, calculate the denominator term representing the total cost over a single outer loop of the RESPA integrator.\nThe number of short-range evaluations per outer step is $n_s = \\Delta t_\\ell / \\Delta t_s = 6\\,\\mathrm{fs} / 2\\,\\mathrm{fs} = 3$.\nThe number of bonded evaluations per outer step is $n_b = \\Delta t_\\ell / \\Delta t_b = 6\\,\\mathrm{fs} / 1\\,\\mathrm{fs} = 6$.\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 1 \\cdot C_\\ell + n_s \\cdot C_s + n_b \\cdot C_b $$\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 1 \\cdot (8.0\\,\\mathrm{ms}) + 3 \\cdot (2.5\\,\\mathrm{ms}) + 6 \\cdot (0.4\\,\\mathrm{ms}) $$\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 8.0\\,\\mathrm{ms} + 7.5\\,\\mathrm{ms} + 2.4\\,\\mathrm{ms} = 17.9\\,\\mathrm{ms} $$\n\nFinally, calculate the speedup $S$. It is equivalent to comparing the cost to run the baseline for time $\\Delta t_\\ell$ versus the cost to run RESPA for time $\\Delta t_\\ell$.\nThe number of baseline steps in a duration of $\\Delta t_\\ell$ is $\\Delta t_\\ell / \\Delta t_0 = 6\\,\\mathrm{fs} / 2\\,\\mathrm{fs} = 3$.\nThe cost of the baseline method over a period $\\Delta t_\\ell$ is $3 \\cdot C_{\\text{baseline\\_per\\_step}} = 3 \\cdot 10.9\\,\\mathrm{ms} = 32.7\\,\\mathrm{ms}$.\nThe cost of the RESPA method over a period $\\Delta t_\\ell$ is $C_{\\text{RESPA\\_per\\_outer\\_step}} = 17.9\\,\\mathrm{ms}$.\nThe speedup is the ratio of these costs:\n$$ S = \\frac{3 \\cdot (C_b + C_s + C_\\ell)}{1 \\cdot C_\\ell + n_s \\cdot C_s + n_b \\cdot C_b} = \\frac{3 \\cdot (10.9\\,\\mathrm{ms})}{17.9\\,\\mathrm{ms}} = \\frac{32.7}{17.9} $$\n$$ S \\approx 1.8268156... $$\nThe problem requires the answer to be rounded to three significant figures.\n$$ S \\approx 1.83 $$\n\nThe dimensionless speedup factor is approximately $1.83$. This indicates that the RESPA scheme is about $83\\%$ faster than the baseline single time step scheme for this particular system and set of parameters.",
            "answer": "$$\n\\boxed{1.83}\n$$"
        }
    ]
}