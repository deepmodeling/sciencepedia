{
    "hands_on_practices": [
        {
            "introduction": "分子动力学通过离散的时间步长来模拟粒子运动，而时间步长 $\\Delta t$ 的选择至关重要。如果步长过大，积分过程会发散，导致模拟崩溃。本练习通过分析最简单的振动系统——谐振子——来探究这一基本限制。通过推导速度Verlet算法的稳定性条件，你将亲手揭示为何系统中最高频率的运动（通常是化学键的振动）决定了模拟所能采用的最大时间步长 。",
            "id": "3782502",
            "problem": "在分子动力学 (MD) 中，粒子的速度和位置通过由牛顿第二定律推导出的时间积分方案在时间上进行推进。考虑一个质量为 $m$ 的单个粒子，被限制在一个空间维度上，并受到谐波力 $F(x)=-kx$ 的作用，因此其运动方程为 $m\\,\\ddot{x}=-kx$。该线性振子模拟了稳定平衡点附近的小振幅振动，是在多尺度建模中用于分析显式积分器时间步稳定性的标准替代模型。\n\n从牛顿第二定律和加速度的定义 $a(x) = \\ddot{x} = F(x)/m$ 出发，采用标准的速度Verlet算法。该算法通过一个时间步长 $\\Delta t$ 来推进位置和速度，其过程是：首先使用当前的速度和加速度进行一次位置更新，然后使用当前和下一步加速度的平均值进行一次速度更新。对于谐振子，加速度为 $a(x)=-\\omega^{2}x$，其中 $\\omega=\\sqrt{k/m}$。\n\n1. 在速度Verlet算法下，推导将时间 $t_{n}$ 的状态 $(x_{n},v_{n})$ 映射到时间 $t_{n+1}=t_{n}+\\Delta t$ 的状态 $(x_{n+1},v_{n+1})$ 的单步线性更新的闭合形式。将此映射写成作用于状态向量的放大矩阵 $A(\\omega,\\Delta t)$ 的形式，即：\n   $$\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A(\\omega,\\Delta t)\\,\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}.$$\n\n2. 使用 $A(\\omega,\\Delta t)$ 的特征值，分析该方案的线性稳定性。施加放大因子的模长小于或等于 $1$（无指数增长）的条件，并确定最大稳定时间步长 $\\Delta t_{\\max}$ 作为 $\\omega$ 的函数。\n\n请用关于 $\\omega$ 的闭式解析表达式来表示 $\\Delta t_{\\max}$ 的最终答案。不要代入数值，最终答案中也不要包含单位。如果您为了自行验证而选择对特定的 $\\omega$ 进行 $\\Delta t_{\\max}$ 的数值计算，请以秒为单位表示时间，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导应用于简谐振子的速度Verlet算法的单步更新矩阵，然后进行线性稳定性分析以确定最大稳定时间步长。\n\n一维谐振子的运动方程为 $m\\ddot{x} = -kx$，其中 $m$ 是质量，$x$ 是位置，$k$ 是弹簧常数。加速度为 $a(x) = \\ddot{x} = -\\frac{k}{m}x$。通过定义角频率 $\\omega = \\sqrt{k/m}$，加速度可以写成 $a(x) = -\\omega^2 x$。\n\n速度Verlet算法包含将状态从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$ 的两个主要步骤：\n1. 位置更新： $$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2} a_n (\\Delta t)^2$$\n2. 速度更新： $$v_{n+1} = v_n + \\frac{1}{2}(a_n + a_{n+1})\\Delta t$$\n这里，$(x_n, v_n)$ 是在时间 $t_n$ 的状态，$\\Delta t$ 是时间步长，$a_n = a(x_n)$ 和 $a_{n+1} = a(x_{n+1})$ 分别是当前和下一个时间步的加速度。\n\n**第1部分：推导更新矩阵 $A(\\omega, \\Delta t)$**\n\n我们将谐振子的特定加速度 $a_n = -\\omega^2 x_n$ 和 $a_{n+1} = -\\omega^2 x_{n+1}$ 代入算法的方程中。\n\n位置更新变为：\n$$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2}(-\\omega^2 x_n)(\\Delta t)^2$$\n重新整理以组合 $x_n$ 和 $v_n$ 的项：\n$$x_{n+1} = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n$$\n该方程提供了放大矩阵 $A$ 的第一行。\n\n速度更新为：\n$$v_{n+1} = v_n + \\frac{1}{2}(-\\omega^2 x_n - \\omega^2 x_{n+1}) \\Delta t$$\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t (x_n + x_{n+1})$$\n为了仅用时间 $t_n$ 的状态 $(x_n, v_n)$ 来表示 $v_{n+1}$，我们代入刚刚推导出的 $x_{n+1}$ 的表达式：\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t \\left[x_n + \\left( \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n \\right) \\right]$$\n合并方括号内 $x_n$ 和 $v_n$ 的项：\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t \\left[ \\left(2 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n \\right]$$\n分配因子 $-\\frac{1}{2}\\omega^2 \\Delta t$：\n$$v_{n+1} = v_n - \\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) x_n - \\frac{1}{2}\\omega^2 (\\Delta t)^2 v_n$$\n最后，组合 $x_n$ 和 $v_n$ 的项：\n$$v_{n+1} = - \\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) x_n + \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right)v_n$$\n该方程提供了矩阵 $A$ 的第二行。\n\n将这两个结果合并到矩阵方程 $\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$ 中，我们确定放大矩阵 $A$ 为：\n$$A(\\omega, \\Delta t) = \\begin{pmatrix} 1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2  \\Delta t \\\\ -\\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)  1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\end{pmatrix}$$\n\n**第2部分：稳定性分析**\n\n数值方案的稳定性由放大矩阵 $A$ 的特征值 $\\lambda$ 决定。当且仅当所有特征值的模长小于或等于 $1$ (即 $|\\lambda| \\le 1$) 时，该方案是稳定的。特征值是特征方程 $\\det(A - \\lambda I) = 0$ 的根，该方程可以写成 $\\lambda^2 - \\text{Tr}(A)\\lambda + \\det(A) = 0$。\n\n首先，我们计算 $A$ 的迹和行列式。\n迹是主对角线元素的和：\n$$\\text{Tr}(A) = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) + \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) = 2 - \\omega^2 (\\Delta t)^2$$\n行列式为：\n$$\\det(A) = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right)^2 - (\\Delta t) \\left(-\\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)\\right)$$\n$$\\det(A) = \\left(1 - \\omega^2 (\\Delta t)^2 + \\frac{1}{4}\\omega^4 (\\Delta t)^4\\right) + \\omega^2 (\\Delta t)^2 \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)$$\n$$\\det(A) = 1 - \\omega^2 (\\Delta t)^2 + \\frac{1}{4}\\omega^4 (\\Delta t)^4 + \\omega^2 (\\Delta t)^2 - \\frac{1}{4}\\omega^4 (\\Delta t)^4 = 1$$\n$\\det(A)=1$ 这个性质证实了速度Verlet算法是一个辛积分器，它对于哈密顿系统能够保持相空间体积守恒。\n\n特征值的特征方程为：\n$$\\lambda^2 - \\left(2 - \\omega^2 (\\Delta t)^2\\right)\\lambda + 1 = 0$$\n使用二次求根公式求解 $\\lambda$：\n$$\\lambda = \\frac{(2 - \\omega^2 (\\Delta t)^2) \\pm \\sqrt{(2 - \\omega^2 (\\Delta t)^2)^2 - 4}}{2}$$\n$$\\lambda = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) \\pm \\sqrt{\\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right)^2 - 1}$$\n我们定义一个无量纲参数 $s = \\omega \\Delta t$。特征值的表达式变为：\n$$\\lambda = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{\\left(1 - \\frac{s^2}{2}\\right)^2 - 1} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{1 - s^2 + \\frac{s^4}{4} - 1} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{\\frac{s^4}{4} - s^2}$$\n\n特征值的性质取决于判别式 $D = \\frac{s^4}{4} - s^2 = s^2\\left(\\frac{s^2}{4} - 1\\right)$ 的符号。\n\n情况1：稳定区域 ($s^2  4$，或 $|\\omega \\Delta t|  2$)。\n判别式为负，因此特征值为一对共轭复数。\n$$|\\lambda|^2 = \\left(1 - \\frac{s^2}{2}\\right)^2 - \\left(\\frac{s^4}{4} - s^2\\right) = 1 - s^2 + \\frac{s^4}{4} - \\frac{s^4}{4} + s^2 = 1$$\n因此，对于 $|\\omega \\Delta t|  2$，特征值位于单位圆上 ($|\\lambda|=1$)，算法是稳定的。解的振幅不会增长或衰减，正确地模拟了振子的能量守恒。\n\n情况2：稳定性边界 ($s^2 = 4$，或 $|\\omega \\Delta t| = 2$)。\n判别式为零，得到一个重复的实数特征值：\n$$\\lambda = 1 - \\frac{s^2}{2} = 1 - \\frac{4}{2} = -1$$\n模长为 $|\\lambda| = 1$，因此该方案是临界稳定的。\n\n情况3：不稳定区域 ($s^2  4$，或 $|\\omega \\Delta t|  2$)。\n判别式为正，因此特征值为两个不相等的实数：\n$$\\lambda_{\\pm} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{s^2\\left(\\frac{s^2}{4} - 1\\right)}$$\n由于 $\\det(A) = \\lambda_+\\lambda_- = 1$，一个特征值的模长必须大于 $1$，另一个则小于 $1$。对于 $s^2  4$，$1 - \\frac{s^2}{2}$ 这一项小于 $-1$。因此，特征值 $\\lambda_- = (1 - s^2/2) - \\sqrt{...}$ 将是一个模长大于 $1$ 的实数。这会导致解的指数增长，因此该方案是不稳定的。\n\n线性稳定性的条件 $|\\lambda| \\le 1$ 当且仅当 $s^2 \\le 4$ 时满足。由于 $\\omega  0$ 且 $\\Delta t  0$，这等价于 $\\omega \\Delta t \\le 2$。\n\n最大稳定时间步长 $\\Delta t_{\\max}$ 对应于等式成立的情况：\n$$\\omega \\Delta t_{\\max} = 2$$\n求解 $\\Delta t_{\\max}$ 得：\n$$\\Delta t_{\\max} = \\frac{2}{\\omega}$$\n这就是应用于简谐振子的速度Verlet算法的稳定性极限。",
            "answer": "$$\\boxed{\\frac{2}{\\omega}}$$"
        },
        {
            "introduction": "理解了如何随时间演化系统后，我们必须精确定义控制粒子相互作用的力，这正是“力场”的核心任务。本练习将深入探讨力场中的一个关键组成部分：二面角势能。你将学习如何从势能函数中推导出广义力矩和原子间作用力，更重要的是，你将探索像分子对称性这样的物理原理如何对势能函数的数学形式施加严格的约束，从而确保我们的模型能够反映真实世界的物理化学性质 。",
            "id": "3782507",
            "problem": "考虑一个由标记为 $1$-$2$-$3$-$4$ 的四个原子定义的扭转，其在分子动力学 (MD) 模拟中围绕键 $2$-$3$ 的二面角为 $\\phi$。扭转能被建模为一个傅里叶级数 $U(\\phi)=\\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(n\\phi-\\delta_n\\right)\\right]$，其中 $k_n$ 是振幅参数，$\\delta_n$ 是相位偏移。从“力是势能的负梯度”以及“与广义坐标共轭的广义扭矩是能量对该坐标的负偏导数”这两个原理出发，推导广义扭转扭矩，并用此扭矩和二面角对每个原子位置的几何导数来表示原子力。你不需要显式计算几何导数。然后，分析周期性和对称性如何约束傅里叶系数：假设扭转势在绕 $2$-$3$ 键旋转 $2\\pi/3$ 时物理上不变，即 $U(\\phi+2\\pi/3)=U(\\phi)$，并且在交换原子 $1$ 和 $4$ 的平面上反射时也不变，即 $U(-\\phi)=U(\\phi)$。从这些约束中，推断出哪些谐波 $n$ 可以出现，以及对相位 $\\delta_n$ 有何限制。提供基于周期函数和对称性性质的清晰推理。将你的最终答案表示为广义扭转扭矩 $\\tau(\\phi)$ 作为 $\\phi$、$k_n$ 和 $\\delta_n$ 的函数的闭式解析表达式。不需要进行数值计算，也不需要四舍五入。最终答案应该是一个单一的表达式。",
            "solution": "**第 1 部分：广义扭矩和原子力的推导**\n\n与二面角 $\\phi$ 共轭的广义扭矩 $\\tau(\\phi)$ 定义为势能 $U(\\phi)$ 对 $\\phi$ 的负偏导数。\n$$\n\\tau(\\phi) = -\\frac{\\partial U(\\phi)}{\\partial \\phi}\n$$\n给定势能函数：\n$$\nU(\\phi) = \\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(n\\phi-\\delta_n\\right)\\right]\n$$\n我们计算关于 $\\phi$ 的导数。和的导数是导数的和。\n$$\n\\frac{\\partial U(\\phi)}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} \\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(n\\phi-\\delta_n\\right)\\right] = \\sum_{n=1}^{N} k_n \\frac{\\partial}{\\partial \\phi}\\left[1+\\cos\\left(n\\phi-\\delta_n\\right)\\right]\n$$\n对余弦项应用链式法则，其中 $\\frac{d}{dx}\\cos(u) = -\\sin(u)\\frac{du}{dx}$：\n$$\n\\frac{\\partial}{\\partial \\phi}\\left[\\cos\\left(n\\phi-\\delta_n\\right)\\right] = -\\sin\\left(n\\phi-\\delta_n\\right) \\cdot \\frac{\\partial}{\\partial \\phi}(n\\phi-\\delta_n) = -n\\sin\\left(n\\phi-\\delta_n\\right)\n$$\n将此代回 $U(\\phi)$ 导数的表达式中：\n$$\n\\frac{\\partial U(\\phi)}{\\partial \\phi} = \\sum_{n=1}^{N} k_n \\left[0 - n\\sin\\left(n\\phi-\\delta_n\\right)\\right] = -\\sum_{n=1}^{N} n k_n \\sin\\left(n\\phi-\\delta_n\\right)\n$$\n因此，广义扭矩为：\n$$\n\\tau(\\phi) = - \\left(-\\sum_{n=1}^{N} n k_n \\sin\\left(n\\phi-\\delta_n\\right)\\right) = \\sum_{n=1}^{N} n k_n \\sin\\left(n\\phi-\\delta_n\\right)\n$$\n接下来，我们表示每个原子 $i$（其中 $i \\in \\{1, 2, 3, 4\\}$）上的力 $\\vec{F}_i$。力是势能相对于原子位置向量 $\\vec{r}_i$ 的负梯度。\n$$\n\\vec{F}_i = -\\nabla_i U = -\\frac{\\partial U}{\\partial \\vec{r}_i}\n$$\n由于势 $U$ 是 $\\phi$ 的函数，而 $\\phi$ 又取决于四个原子的位置，$U = U(\\phi(\\vec{r}_1, \\vec{r}_2, \\vec{r}_3, \\vec{r}_4))$，我们使用链式法则：\n$$\n\\vec{F}_i = -\\frac{\\partial U}{\\partial \\phi} \\frac{\\partial \\phi}{\\partial \\vec{r}_i}\n$$\n认识到 $\\tau(\\phi) = -\\frac{\\partial U}{\\partial \\phi}$，我们可以用广义扭矩和二面角的几何导数来表示原子 $i$ 上的力：\n$$\n\\vec{F}_i = \\tau(\\phi) \\frac{\\partial \\phi}{\\partial \\vec{r}_i}\n$$\n这个表达式将作用在二面角上的广义扭矩与构成原子的笛卡尔力联系起来。对于任何不属于该扭转的原子 $j$（即 $j \\notin \\{1, 2, 3, 4\\}$），来自此势的力为 $\\vec{F}_j = \\vec{0}$。\n\n**第 2 部分：对称性约束分析**\n\n我们现在分析给定的两个对称性约束如何限制谐波指数 $n$ 和相位移 $\\delta_n$ 的允许值。\n\n第一个约束：旋转不变性，$U(\\phi + \\frac{2\\pi}{3}) = U(\\phi)$。\n$$\n\\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(n\\left(\\phi+\\frac{2\\pi}{3}\\right)-\\delta_n\\right)\\right] = \\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(n\\phi-\\delta_n\\right)\\right]\n$$\n这对所有 $\\phi$ 都必须成立。根据傅里叶级数系数的唯一性，这个等式必须对和中的每一项单独成立（对于任何 $k_n \\neq 0$ 的 $n$）：\n$$\n\\cos\\left(n\\phi - \\delta_n + \\frac{2n\\pi}{3}\\right) = \\cos\\left(n\\phi - \\delta_n\\right)\n$$\n余弦函数 $\\cos(x)$ 的周期为 $2\\pi$。对于 $\\cos(A) = \\cos(B)$，我们必须有 $A = \\pm B + 2\\pi m$，其中 $m$ 是某个整数。\n1. 如果 $n\\phi - \\delta_n + \\frac{2n\\pi}{3} = n\\phi - \\delta_n + 2\\pi m$，那么 $\\frac{2n\\pi}{3} = 2\\pi m$，简化为 $n = 3m$。这意味着 $n$ 必须是 $3$ 的倍数。\n2. 如果 $n\\phi - \\delta_n + \\frac{2n\\pi}{3} = -(n\\phi - \\delta_n) + 2\\pi m$，那么 $2n\\phi - 2\\delta_n + \\frac{2n\\pi}{3} = 2\\pi m$。这个方程必须对所有 $\\phi$ 值成立，这是不可能的，除非 $n=0$。然而，$U(\\phi)$ 的求和从 $n=1$ 开始。\n因此，唯一的可能性是 $n$ 必须是 $3$ 的整数倍。允许的谐波为 $n = 3, 6, 9, \\dots$。\n\n第二个约束：反射不变性，$U(-\\phi) = U(\\phi)$。这表示势是 $\\phi$ 的偶函数。\n$$\n\\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(n(-\\phi)-\\delta_n\\right)\\right] = \\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(n\\phi-\\delta_n\\right)\\right]\n$$\n使用恒等式 $\\cos(-x) = \\cos(x)$，左边变为：\n$$\n\\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(-(n\\phi+\\delta_n)\\right)\\right] = \\sum_{n=1}^{N} k_n\\left[1+\\cos\\left(n\\phi+\\delta_n\\right)\\right]\n$$\n对每个 $n$（其中 $k_n \\neq 0$）的项进行等价：\n$$\n\\cos\\left(n\\phi+\\delta_n\\right) = \\cos\\left(n\\phi-\\delta_n\\right)\n$$\n使用余弦和差恒等式：\n$$\n\\cos(n\\phi)\\cos(\\delta_n) - \\sin(n\\phi)\\sin(\\delta_n) = \\cos(n\\phi)\\cos(\\delta_n) + \\sin(n\\phi)\\sin(\\delta_n)\n$$\n这简化为：\n$$\n-2\\sin(n\\phi)\\sin(\\delta_n) = 0\n$$\n因为这对所有 $\\phi$ 都必须成立，并且对于 $n \\ge 1$，$\\sin(n\\phi)$ 不恒为零，我们必须有：\n$$\n\\sin(\\delta_n) = 0\n$$\n这意味着 $\\delta_n = m\\pi$，其中 $m$ 是任意整数。这将相位移限制为 $\\pi$ 的整数倍。实际上，这意味着 $\\delta_n$ 可以是 $0$ 或 $\\pi$，因为其他整数倍是多余的（例如，$\\cos(x-2\\pi)=\\cos(x)$ 和 $\\cos(x-3\\pi)=\\cos(x-\\pi)$）。\n\n总之，为使势具有指定的对称性，只能存在 $n$ 是 $3$ 的倍数的傅里叶项，并且它们的相位移 $\\delta_n$ 必须是 $0$ 或 $\\pi$。\n\n所要求的最终答案是广义扭转扭矩 $\\tau(\\phi)$ 的闭式解析表达式。这个表达式是在第 1 部分中，在应用对称性约束之前，从势 $U(\\phi)$ 的一般形式推导出来的。对称性分析是问题要求的一个独立部分。因此，报告的是扭矩的最一般表达式。",
            "answer": "$$\n\\boxed{\\sum_{n=1}^{N} n k_n \\sin\\left(n\\phi - \\delta_n\\right)}\n$$"
        },
        {
            "introduction": "第一个练习揭示了系统中的快速振动（如键伸缩）要求我们使用非常小的时间步长，这大大增加了计算成本。然而，系统中的许多力（如长程静电力）变化得要慢得多。本练习将介绍参考系统传播算法（RESPA），这是一种利用不同力在时间尺度上分离的强大技术。通过以不同的频率计算不同类型的力，RESPA可以显著加速模拟，本练习将指导你估算这种多时间步方法所带来的实际性能提升 。",
            "id": "3782508",
            "problem": "考虑一个使用分子动力学 (MD) 演化的溶剂化生物分子系统。原子运动遵循牛顿第二定律 $m_i \\,\\mathrm{d}^2 \\mathbf{r}_i/\\mathrm{d}t^2 = \\mathbf{F}_i$，其中作用在原子 $i$ 上的总力分解为 $\\mathbf{F}_i = \\mathbf{F}_{i}^{\\text{bond}} + \\mathbf{F}_{i}^{\\text{short}} + \\mathbf{F}_{i}^{\\text{long}}$。在这里，$\\mathbf{F}_{i}^{\\text{bond}}$ 聚合了成键相互作用（共价键伸缩、键角弯曲和扭转项），$\\mathbf{F}_{i}^{\\text{short}}$ 聚合了短程非键相互作用（Lennard-Jones 和带有球形截断与平滑切换的实空间库仑相互作用），而 $\\mathbf{F}_{i}^{\\text{long}}$ 聚合了通过粒子网格埃瓦尔德（PME; Particle Mesh Ewald）计算的长程静电相互作用。您将基于这种力划分，使用参考系统传播算法（RESPA; Reference System Propagator Algorithm）设计一个多时间步积分器，并估计其相对于单时间步Verlet方案的计算加速比。\n\n提出以下科学上真实的划分和时间步长分配：\n- 成键力 $\\mathbf{F}^{\\text{bond}}$：共价键、键角和扭转。将它们分配给最精细的内层时间步长 $\\Delta t_b = 1\\,\\mathrm{fs}$。\n- 短程非键力 $\\mathbf{F}^{\\text{short}}$：Lennard-Jones 和截断距离为 $r_c = 1.0\\,\\mathrm{nm}$、平滑切换函数起始于 $r_s = 0.9\\,\\mathrm{nm}$ 的直接空间库仑力。将它们分配给一个中间时间步长 $\\Delta t_s = 2\\,\\mathrm{fs}$。\n- 长程静电力 $\\mathbf{F}^{\\text{long}}$：PME 倒易空间分量，网格间距为 $0.12\\,\\mathrm{nm}$，采用四阶B样条插值。将它们分配给外层时间步长 $\\Delta t_\\ell = 6\\,\\mathrm{fs}$。\n\n假设一个基准的单时间步Verlet积分器使用 $\\Delta t_0 = 2\\,\\mathrm{fs}$，并且在每一步都计算所有三类力。对于一个约有 $N \\approx 10^5$ 个原子的典型溶剂化生物分子，假设每次力评估的实测挂钟时间成本如下：\n- 成键力评估成本 $C_b = 0.4\\,\\mathrm{ms}$，\n- 短程力评估成本 $C_s = 2.5\\,\\mathrm{ms}$，\n- 长程PME力评估成本 $C_\\ell = 8.0\\,\\mathrm{ms}$。\n\n从力分解下的时间离散化的第一性原理出发，推导上述RESPA方案相对于基准单时间步方案在模拟固定物理时间 $T$ 时所获得的加速比。您的最终答案应该是无量纲的加速比，四舍五入到三位有效数字。请将最终答案表示为一个无量纲数。",
            "solution": "目标是计算加速比 $S$，其定义为在模拟相同的固定物理时间 $T$ 时，基准单时间步方案的总计算成本与RESPA多时间步方案的总计算成本之比。\n$$ S = \\frac{\\text{Cost}_{\\text{baseline}}}{\\text{Cost}_{\\text{RESPA}}} $$\n\n首先，我们构建基准方案的总成本。基准积分器使用单一时间步长 $\\Delta t_0$。要模拟总时间 $T$，所需的步数是 $N_0 = T / \\Delta t_0$。在每一步中，所有三个力分量都会被计算。因此，每步的成本是 $C_{\\text{step},0} = C_b + C_s + C_\\ell$。\n基准模拟的总成本是步数乘以每步的成本：\n$$ \\text{Cost}_{\\text{baseline}} = N_0 \\cdot C_{\\text{step},0} = \\frac{T}{\\Delta t_0} (C_b + C_s + C_\\ell) $$\n\n接下来，我们构建RESPA方案的总成本。RESPA算法围绕变化最慢的力构建，该力在最外层时间步长 $\\Delta t_\\ell$ 进行更新。要模拟总时间 $T$，最外层步骤的总数是 $N_\\ell = T / \\Delta t_\\ell$。我们需要计算在这样一个持续时间为 $\\Delta t_\\ell$ 的外层步骤内执行的总计算功。\n\n在持续时间为 $\\Delta t_\\ell$ 的一个外层步骤内：\n1.  长程力 $\\mathbf{F}^{\\text{long}}$ 被评估一次。产生的成本是 $1 \\cdot C_\\ell$。\n2.  短程力 $\\mathbf{F}^{\\text{short}}$ 在每个中间时间步长 $\\Delta t_s$ 被评估。一个外层步骤内的短程力评估次数是 $n_s = \\Delta t_\\ell / \\Delta t_s$。产生的成本是 $n_s \\cdot C_s = (\\Delta t_\\ell / \\Delta t_s) \\cdot C_s$。\n3.  成键力 $\\mathbf{F}^{\\text{bond}}$ 在每个最内层时间步长 $\\Delta t_b$ 被评估。一个外层步骤内的成键力评估次数是 $n_b = \\Delta t_\\ell / \\Delta t_b$。产生的成本是 $n_b \\cdot C_b = (\\Delta t_\\ell / \\Delta t_b) \\cdot C_b$。\n\n持续时间为 $\\Delta t_\\ell$ 的单个RESPA外层步骤的总成本是这些成本的总和：\n$$ C_{\\text{step,RESPA}} = C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b $$\nRESPA模拟的总成本是最外层步数乘以每个外层步骤的成本：\n$$ \\text{Cost}_{\\text{RESPA}} = N_\\ell \\cdot C_{\\text{step,RESPA}} = \\frac{T}{\\Delta t_\\ell} \\left( C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b \\right) $$\n\n现在我们可以写出加速比 $S$ 的表达式：\n$$ S = \\frac{\\frac{T}{\\Delta t_0} (C_b + C_s + C_\\ell)}{\\frac{T}{\\Delta t_\\ell} \\left( C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b \\right)} $$\n总模拟时间 $T$ 被消去，得到在这种情况下加速比的通用公式：\n$$ S = \\frac{\\Delta t_\\ell}{\\Delta t_0} \\cdot \\frac{C_b + C_s + C_\\ell}{C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b} $$\n\n我们现在将给定的数值代入此表达式。\n- 时间步长：$\\Delta t_0 = 2\\,\\mathrm{fs}$，$\\Delta t_b = 1\\,\\mathrm{fs}$，$\\Delta t_s = 2\\,\\mathrm{fs}$，$\\Delta t_\\ell = 6\\,\\mathrm{fs}$。\n- 成本：$C_b = 0.4\\,\\mathrm{ms}$， $C_s = 2.5\\,\\mathrm{ms}$， $C_\\ell = 8.0\\,\\mathrm{ms}$。\n\n首先，计算代表基准模拟每步成本的分子项：\n$$ C_{\\text{baseline\\_per\\_step}} = C_b + C_s + C_\\ell = 0.4\\,\\mathrm{ms} + 2.5\\,\\mathrm{ms} + 8.0\\,\\mathrm{ms} = 10.9\\,\\mathrm{ms} $$\n\n接下来，计算代表RESPA积分器单个外循环总成本的分母项。\n每个外层步骤的短程评估次数为 $n_s = \\Delta t_\\ell / \\Delta t_s = 6\\,\\mathrm{fs} / 2\\,\\mathrm{fs} = 3$。\n每个外层步骤的成键评估次数为 $n_b = \\Delta t_\\ell / \\Delta t_b = 6\\,\\mathrm{fs} / 1\\,\\mathrm{fs} = 6$。\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 1 \\cdot C_\\ell + n_s \\cdot C_s + n_b \\cdot C_b $$\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 1 \\cdot (8.0\\,\\mathrm{ms}) + 3 \\cdot (2.5\\,\\mathrm{ms}) + 6 \\cdot (0.4\\,\\mathrm{ms}) $$\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 8.0\\,\\mathrm{ms} + 7.5\\,\\mathrm{ms} + 2.4\\,\\mathrm{ms} = 17.9\\,\\mathrm{ms} $$\n\n最后，计算加速比 $S$。这等同于比较运行基准方案时间 $\\Delta t_\\ell$ 的成本与运行RESPA方案时间 $\\Delta t_\\ell$ 的成本。\n在持续时间 $\\Delta t_\\ell$ 内的基准步数是 $\\Delta t_\\ell / \\Delta t_0 = 6\\,\\mathrm{fs} / 2\\,\\mathrm{fs} = 3$。\n基准方法在时间段 $\\Delta t_\\ell$ 内的成本是 $3 \\cdot C_{\\text{baseline\\_per\\_step}} = 3 \\cdot 10.9\\,\\mathrm{ms} = 32.7\\,\\mathrm{ms}$。\nRESPA方法在时间段 $\\Delta t_\\ell$ 内的成本是 $C_{\\text{RESPA\\_per\\_outer\\_step}} = 17.9\\,\\mathrm{ms}$。\n加速比是这些成本的比率：\n$$ S = \\frac{3 \\cdot (C_b + C_s + C_\\ell)}{1 \\cdot C_\\ell + n_s \\cdot C_s + n_b \\cdot C_b} = \\frac{3 \\cdot (10.9\\,\\mathrm{ms})}{17.9\\,\\mathrm{ms}} = \\frac{32.7}{17.9} $$\n$$ S \\approx 1.8268156... $$\n问题要求答案四舍五入到三位有效数字。\n$$ S \\approx 1.83 $$\n\n无量纲加速比约为 $1.83$。这表明对于这个特定的系统和参数集，RESPA方案比基准单时间步方案快大约 $83\\%$。",
            "answer": "$$\n\\boxed{1.83}\n$$"
        }
    ]
}