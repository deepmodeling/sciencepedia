{
    "hands_on_practices": [
        {
            "introduction": "Mori-Tanaka模型是估算复合材料有效弹性性能的经典有效介质理论之一，尤其适用于描述分散的夹杂物嵌入连续基体相的微观结构。该方法通过考虑夹杂物之间的相互作用（通过平均基体应变场来近似），提供了超越简单混合律的精确预测。本练习旨在通过一个具体的算例，让学习者亲手应用Mori-Tanaka公式计算含球形夹杂物的两相复合材料的有效体积模量 $K^{\\text{eff}}$ 和剪切模量 $G^{\\text{eff}}$，从而加深对微观结构参数如何影响宏观力学响应的理解 。",
            "id": "3752653",
            "problem": "考虑一种处于有效介质理论 (EMT) 范畴内的两相各向同性复合材料，它由体积分数为 $\\phi$ 的球形夹杂物相 $i$ 嵌入到连续基体相 $m$ 中组成。各相是线弹性且各向同性的，其特征为体积模量 $K$ 和剪切模量 $G$，其应力-应变关系写作 $\\boldsymbol{\\sigma} = 3 K \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I} + 2 G \\, \\text{dev}(\\boldsymbol{\\varepsilon})$，其中 $\\boldsymbol{\\sigma}$ 是应力张量，$\\boldsymbol{\\varepsilon}$ 是应变张量，$\\boldsymbol{I}$ 是单位张量，$\\text{tr}(\\cdot)$ 表示迹，$\\text{dev}(\\cdot)$ 表示偏量部分。从各向同性线弹性的基本框架和 Eshelby 关于球形夹杂物在均匀远场载荷作用下的夹杂物结果出发，使用 Mori–Tanaka 均质化假设（其中夹杂物承受基体的平均场）来推导复合材料的有效体积模量 $K^{\\text{eff}}$ 和有效剪切模量 $G^{\\text{eff}}$ 的闭合形式表达式。然后，对于体积分数 $\\phi = 0.1$、相模量为 $K_i = 120$ GPa, $G_i = 50$ GPa 的球形夹杂物，以及基体模量为 $K_m = 80$ GPa, $G_m = 30$ GPa 的情况，计算这些表达式的值。将每个模量四舍五入到四位有效数字，并以吉帕斯卡 (GPa) 表示最终值。以数对 $\\left(K^{\\text{eff}}, G^{\\text{eff}}\\right)$ 的形式给出最终答案。",
            "solution": "该问题要求确定一种两相各向同性复合材料的有效体积模量 $K^{\\text{eff}}$ 和有效剪切模量 $G^{\\text{eff}}$。该复合材料由体积分数为 $\\phi$ 的球形夹杂物相 $i$ 嵌入到连续基体相 $m$ 中组成。两相都由各向同性线弹性描述。推导将基于 Mori–Tanaka 均质化方案。\n\nMori–Tanaka 方法是一种有效介质理论，它通过假设每个夹杂物的行为都像单个夹杂物嵌入在承受基体相平均应变场的无限大基体中一样，来考虑夹杂物之间的相互作用。对于具有球形夹杂物的两相复合材料，该方法为有效模量提供了闭合形式的表达式。当基体是较柔顺的相时，这些表达式等同于 Hashin–Shtrikman 界。\n\n根据用于球形夹杂物的 Mori–Tanaka 模型，有效体积模量 $K^{\\text{eff}}$ 和有效剪切模量 $G^{\\text{eff}}$ 的控制方程为：\n$$\nK^{\\text{eff}} = K_m + \\frac{\\phi (K_i - K_m)}{1 + (1-\\phi) \\frac{K_i - K_m}{K_m + \\frac{4}{3}G_m}}\n$$\n$$\nG^{\\text{eff}} = G_m + \\frac{\\phi (G_i - G_m)}{1 + (1-\\phi) \\frac{G_i - G_m}{G_m + H_m}}\n$$\n其中 $K_m$ 和 $G_m$ 是基体的体积模量和剪切模量，$K_i$ 和 $G_i$ 是夹杂物的模量，$\\phi$ 是夹杂物的体积分数，而 $H_m$ 是一个与基体性质相关的辅助模量：\n$$\nH_m = G_m \\frac{9K_m + 8G_m}{6(K_m + 2G_m)}\n$$\n我们给定了以下数值：\n- 体积分数：$\\phi = 0.1$\n- 夹杂物相模量：$K_i = 120 \\, \\text{GPa}$，$G_i = 50 \\, \\text{GPa}$\n- 基体相模量：$K_m = 80 \\, \\text{GPa}$，$G_m = 30 \\, \\text{GPa}$\n\n首先，我们计算有效体积模量 $K^{\\text{eff}}$。\n让我们计算 $K^{\\text{eff}}$ 公式所需的各项。\n体积模量之差为 $K_i - K_m = 120 \\, \\text{GPa} - 80 \\, \\text{GPa} = 40 \\, \\text{GPa}$。\n分母项 $K_m + \\frac{4}{3}G_m$ 为：\n$$\nK_m + \\frac{4}{3}G_m = 80 \\, \\text{GPa} + \\frac{4}{3} (30 \\, \\text{GPa}) = 80 \\, \\text{GPa} + 40 \\, \\text{GPa} = 120 \\, \\text{GPa}\n$$\n现在，将这些代入 $K^{\\text{eff}}$ 的方程中：\n$$\nK^{\\text{eff}} = 80 + \\frac{0.1 \\times 40}{1 + (1-0.1) \\frac{40}{120}}\n$$\n$$\nK^{\\text{eff}} = 80 + \\frac{4}{1 + 0.9 \\times \\frac{1}{3}}\n$$\n$$\nK^{\\text{eff}} = 80 + \\frac{4}{1 + 0.3} = 80 + \\frac{4}{1.3} = 80 + \\frac{40}{13}\n$$\n数值上，这等于：\n$$\nK^{\\text{eff}} \\approx 80 + 3.076923... = 83.076923... \\, \\text{GPa}\n$$\n四舍五入到四位有效数字，我们得到 $K^{\\text{eff}} = 83.08 \\, \\text{GPa}$。\n\n接下来，我们计算有效剪切模量 $G^{\\text{eff}}$。\n首先，我们必须计算辅助模量 $H_m$：\n$$\nH_m = (30) \\frac{9(80) + 8(30)}{6(80 + 2(30))} = 30 \\frac{720 + 240}{6(80 + 60)} = 30 \\frac{960}{6(140)} = 30 \\frac{960}{840}\n$$\n$$\nH_m = 30 \\frac{96}{84} = 30 \\frac{8 \\times 12}{7 \\times 12} = 30 \\frac{8}{7} = \\frac{240}{7} \\, \\text{GPa}\n$$\n现在我们计算项 $G_m + H_m$：\n$$\nG_m + H_m = 30 + \\frac{240}{7} = \\frac{210 + 240}{7} = \\frac{450}{7} \\, \\text{GPa}\n$$\n剪切模量之差为 $G_i - G_m = 50 \\, \\text{GPa} - 30 \\, \\text{GPa} = 20 \\, \\text{GPa}$。\n将这些代入 $G^{\\text{eff}}$ 的方程中：\n$$\nG^{\\text{eff}} = 30 + \\frac{0.1 \\times 20}{1 + (1-0.1) \\frac{20}{450/7}}\n$$\n$$\nG^{\\text{eff}} = 30 + \\frac{2}{1 + (0.9) \\frac{20 \\times 7}{450}} = 30 + \\frac{2}{1 + \\frac{9}{10} \\frac{140}{450}} = 30 + \\frac{2}{1 + \\frac{9}{10} \\frac{14}{45}}\n$$\n$$\nG^{\\text{eff}} = 30 + \\frac{2}{1 + \\frac{1}{10} \\frac{14}{5}} = 30 + \\frac{2}{1 + \\frac{14}{50}} = 30 + \\frac{2}{1 + \\frac{7}{25}}\n$$\n$$\nG^{\\text{eff}} = 30 + \\frac{2}{\\frac{32}{25}} = 30 + \\frac{2 \\times 25}{32} = 30 + \\frac{50}{32} = 30 + \\frac{25}{16}\n$$\n数值上，这等于：\n$$\nG^{\\text{eff}} = 30 + 1.5625 = 31.5625 \\, \\text{GPa}\n$$\n四舍五入到四位有效数字，我们得到 $G^{\\text{eff}} = 31.56 \\, \\text{GPa}$。\n\n因此，有效体积模量和剪切模量约等于 $K^{\\text{eff}} = 83.08 \\, \\text{GPa}$ 和 $G^{\\text{eff}} = 31.56 \\, \\text{GPa}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n83.08 & 31.56\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "有效介质理论不仅能估算材料属性，还能揭示材料行为中的临界现象。Bruggeman模型作为一种对称的自洽方法，能够有效地描述相畴随机混合的复合材料，并预测逾渗行为。本练习将引导你分析Bruggeman模型在一个极限情况下的表现——即当一个相变为完美绝缘体时——来推导导电相的临界体积分数 $\\phi_{c}$ 。通过这个过程，你将能更好地理解逾渗阈值的物理意义，以及平均场理论在描述相变现象时的洞察力与局限性。",
            "id": "3752737",
            "problem": "考虑一种在三维空间中，由随机分散、无相互作用的球形域组成的统计各向同性、宏观均匀的两相复合材料。相$1$的标量电导率为$\\,\\sigma_{1}\\,$，占据的体积分数为$\\,\\phi\\,$；相$2$的标量电导率为$\\,\\sigma_{2}\\,$，占据的体积分数为$\\,1-\\phi\\,$. 假设两相在远小于任何宏观测量尺度的尺度上充分混合，且微观结构缺乏长程相关性。\n\n使用Bruggeman有效介质近似 (EMA) 所基于的自洽原理，将该复合材料建模为一个电导率为$\\,\\sigma_{e}\\,$的等效连续介质，使得当任一相的球形夹杂物嵌入此等效连续介质中时，系综平均的超额极化为零。在准静态机制下处理此导电问题，其中局部场遵循稳态连续性定律$\\,\\nabla\\cdot\\mathbf{J}=0\\,$，本构关系为$\\,\\mathbf{J}=\\sigma\\,\\mathbf{E}\\,$，且$\\,\\mathbf{E}=-\\nabla V\\,$，其中$\\,V\\,$是电势。\n\n在极限情况$\\,\\sigma_{2}\\to 0\\,$（即相$2$变为完全绝缘体）下，确定在球形夹杂物的Bruggeman EMA框架内，等效电导率$\\,\\sigma_{e}\\,$从零过渡到非零时所预测的临界体积分数$\\,\\phi_{c}\\,$。你的最终结果必须是一个精确的分数。然后，用文字简要解释该预测如何与三维空间中由球体形成的连通团簇的既有连续渗流阈值进行定性比较。最终答案中不需要进行数值比较。将最终的$\\,\\phi_{c}\\,$表示为一个无单位的分数；无需四舍五入。",
            "solution": "物理背景是一个处于稳态的两相导体。电场$\\,\\mathbf{E}\\,$和电流密度$\\,\\mathbf{J}\\,$遵循$\\,\\mathbf{J}=\\sigma\\,\\mathbf{E}\\,$和$\\,\\nabla\\cdot\\mathbf{J}=0\\,$，这意味着对于电势$\\,V\\,$有$\\,\\nabla\\cdot(\\sigma\\,\\nabla V)=0\\,$. 对于一个电导率为$\\,\\sigma_{i}\\,$的球形夹杂物，嵌入在电导率为$\\,\\sigma_{e}\\,$的均匀基体中并受到一个均匀外加电场$\\,\\mathbf{E}_{0}\\,$的作用，$\\,\\nabla\\cdot(\\sigma\\,\\nabla V)=0\\,$的经典边值问题解（在界面处$\\,V\\,$和法向电流连续）产生一个偶极响应，其极化率正比于对比因子\n$$\n\\frac{\\sigma_{i}-\\sigma_{e}}{\\sigma_{i}+2\\,\\sigma_{e}}\\,,\n$$\n其中几何因子$\\,2\\,$源于球体在三维空间中的退极化特性。这个结果是经典静电学和稳恒传导中一个经过充分检验的公式，可以通过求解具有适当界面条件的拉普拉斯方程得到。\n\nBruggeman有效介质近似 (EMA) 施加了一个自洽条件：将每一相都视作嵌入在有效介质中的夹杂物，计算其极化，然后按体积分数加权求和，结果为零。对于球形夹杂物的二元混合物，这得到了关于等效电导率$\\,\\sigma_{e}\\,$的隐式方程：\n$$\n\\phi\\,\\frac{\\sigma_{1}-\\sigma_{e}}{\\sigma_{1}+2\\,\\sigma_{e}}+(1-\\phi)\\,\\frac{\\sigma_{2}-\\sigma_{e}}{\\sigma_{2}+2\\,\\sigma_{e}}=0\\,.\n$$\n我们需要分析$\\,\\sigma_{2}\\to 0\\,$的极限情况，此时相$2$变为完全绝缘体。在该极限下，第二项化简为\n$$\n\\frac{\\sigma_{2}-\\sigma_{e}}{\\sigma_{2}+2\\,\\sigma_{e}}\\xrightarrow{\\ \\sigma_{2}\\to 0\\ }\\frac{0-\\sigma_{e}}{0+2\\,\\sigma_{e}}=-\\frac{1}{2}\\,,\n$$\n前提是$\\,\\sigma_{e}>0\\,$. 然而，在导电开始时，等效电导率本身从上方趋近于零。EMA预测的渗流阈值对应于存在非零$\\,\\sigma_{e}\\,$解的最小$\\,\\phi\\,$值。因此，我们在$\\,\\sigma_{2}=0\\,$和$\\,\\sigma_{e}\\to 0^{+}\\,$的极限机制下分析EMA方程。\n\n将$\\,\\sigma_{2}=0\\,$代入EMA方程，得到\n$$\n\\phi\\,\\frac{\\sigma_{1}-\\sigma_{e}}{\\sigma_{1}+2\\,\\sigma_{e}}+(1-\\phi)\\,\\frac{0-\\sigma_{e}}{0+2\\,\\sigma_{e}}=0\n\\quad\\Longrightarrow\\quad\n\\phi\\,\\frac{\\sigma_{1}-\\sigma_{e}}{\\sigma_{1}+2\\,\\sigma_{e}}-\\frac{1-\\phi}{2}=0\\,.\n$$\n为了找到$\\,\\sigma_{e}\\,$首次变为非零时的临界体积分数$\\,\\phi_{c}\\,$，我们计算$\\,\\sigma_{e}\\to 0^{+}\\,$时的极限。在此极限下，\n$$\n\\frac{\\sigma_{1}-\\sigma_{e}}{\\sigma_{1}+2\\,\\sigma_{e}}\\xrightarrow{\\ \\sigma_{e}\\to 0^{+}\\ }1\\,,\n$$\n于是方程简化为\n$$\n\\phi - \\frac{1-\\phi}{2} = 0\\,.\n$$\n求解$\\,\\phi\\,$，\n$$\n2\\,\\phi - (1-\\phi)=0\n\\quad\\Longrightarrow\\quad\n3\\,\\phi - 1=0\n\\quad\\Longrightarrow\\quad\n\\phi_{c}=\\frac{1}{3}\\,.\n$$\n\n因此，对于三维空间中的各向同性球形夹杂物，当另一相完全绝缘时，Bruggeman EMA预测的临界导电相体积分数为$\\,\\phi_{c}=\\frac{1}{3}\\,$. 关于球体的连续渗流阈值，从随机几何图和布尔模型的理论可知，在三维空间中，由球体的连通并集形成贯穿团簇的临界点发生在体积分数略低于$\\,\\frac{1}{3}\\,$时，这反映了平均场理论中被忽略的空间涨落和聚集效应的影响。因此，Bruggeman EMA的预测值$\\,\\phi_{c}=\\frac{1}{3}\\,$在定性上高估了三维空间中球形连通性的连续渗流阈值，这与其平均场特性是一致的。",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        },
        {
            "introduction": "当复合材料的微观结构非常复杂，难以用解析模型描述时，基于均匀化理论的数值方法便成为不可或缺的工具。本练习旨在介绍如何通过有限元方法 (FEM) 求解周期性单胞问题，从而计算材料的有效属性。你将为一个经典的二维棋盘格导热问题编写程序，实现周期性边界条件下的数值求解，并计算其等效热导率 $K^{\\text{hom}}_{xx}$ 。这项实践将理论与计算紧密结合，是掌握现代多尺度建模技术的关键一步。",
            "id": "3752740",
            "problem": "您必须编写一个完整、可运行的程序，用于计算具有棋盘格式电导率分布的二维周期性晶胞在$x$方向上的均质化热导率，记为$K^{\\text{hom}}_{xx}$。该程序必须基于有效的物理定律，采用带有周期性边界条件的有限元法来求解周期性晶胞问题。所有数学量，包括变量、函数和数字，都必须用LaTeX书写。\n\n其基本依据是由傅里叶定律 (Fourier's law) 和能量守恒定律控制的稳态热传导。设晶胞为$Y = [0,1]^2$，坐标为$\\mathbf{x} = (x,y)$。局部热通量为$\\mathbf{q}(\\mathbf{x}) = -k(\\mathbf{x}) \\nabla T(\\mathbf{x})$，热量守恒要求在$Y$中$\\nabla \\cdot \\mathbf{q}(\\mathbf{x}) = 0$。热导率$k(\\mathbf{x})$以$Y$为周期。当在$x$方向施加宏观温度梯度时，微观温度可以分解为一个线性的宏观部分和一个周期性的波动部分。必须求解周期性修正问题以确定等效响应。\n\n晶胞$Y$包含一个$2\\times 2$的棋盘格图案，其分段常数热导率$k(\\mathbf{x}) \\in \\{k_1, k_2\\}$由奇偶规则定义：如果$\\lfloor 2x \\rfloor + \\lfloor 2y \\rfloor$为偶数，则$k(\\mathbf{x}) = k_1$，否则$k(\\mathbf{x}) = k_2$。在主要场景中，取$k_1 = 5$和$k_2 = 1$，单位均为$\\text{W}/(\\text{m}\\cdot\\text{K})$。\n\n您的程序必须：\n- 使用结构化网格将$Y$离散化，该网格在$x$方向有$N_x$个划分，在$y$方向有$N_y$个划分，并剖分为三角形（每个矩形两个）。\n- 通过识别$Y$相对边界上的自由度来施加周期性边界条件。\n- 求解与$x$方向单位宏观梯度相关联的周期性修正问题。波动场必须是周期性的，并且在相差一个加性常数的情况下是唯一的；通过将一个代表性自由度固定为零来消除零空间。\n- 将$K^{\\text{hom}}_{xx}$计算为在$x$方向单位宏观梯度作用下，$x$方向的平均通量响应。\n- 将所有输出表示为浮点数，代表以$\\text{W}/(\\text{m}\\cdot\\text{K})$为单位的热导率。\n\n设计您的程序，使其针对以下测试套件产生单行输出，结果为包含在方括号中的逗号分隔列表。每个测试用例提供$(N_x, N_y, k_1, k_2)$：\n- 带对比度的常规分辨率路径：$(40, 40, 5, 1)$。\n- 带对比度的粗糙分辨率（边界条件压力测试）：$(8, 8, 5, 1)$。\n- 均匀介质一致性检查：$(20, 20, 1, 1)$。\n- 高对比度情况：$(40, 40, 100, 1)$。\n\n您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[r_1,r_2,r_3,r_4]$），其中每个$r_i$是一个以$\\text{W}/(\\text{m}\\cdot\\text{K})$为单位的浮点数。不应打印任何额外文本。",
            "solution": "用户提供了一个科学上合理且适定的问题。任务是计算具有棋盘格微结构的二维周期性复合材料的等效热导率$K^{\\text{hom}}_{xx}$。这将通过使用有限元法（FEM）数值求解相关的周期性晶胞问题来完成。\n\n该问题基于周期性介质的均质化理论。复合材料中的稳态热传导由傅里叶定律 (Fourier's law) $\\mathbf{q}(\\mathbf{x}) = -k(\\mathbf{x}) \\nabla T(\\mathbf{x})$和能量守恒定律$\\nabla \\cdot \\mathbf{q}(\\mathbf{x}) = 0$所控制。材料的热导率$k(\\mathbf{x})$相对于晶胞$Y = [0,1]^2$是周期性的。\n\n均质化理论的核心是基于一个小参数$\\epsilon$（代表微观结构长度尺度与宏观长度尺度之比）对温度场$T$进行渐近展开。温度场近似为$T(\\mathbf{x}) \\approx T_{\\text{macro}}(\\mathbf{x}) + \\epsilon T_1(\\mathbf{x}, \\mathbf{y})$，其中$\\mathbf{x}$是宏观坐标，$\\mathbf{y} = \\mathbf{x}/\\epsilon$是晶胞$Y$内的微观坐标。宏观温度场假定为线性变化，$T_{\\text{macro}}(\\mathbf{x}) = \\mathbf{E} \\cdot \\mathbf{x}$，由一个恒定的宏观温度梯度$\\mathbf{E}$驱动。一阶修正项$T_1$以$T_1 = -\\chi_k(\\mathbf{y}) E_k$的形式寻找，其中$\\mathbf{\\chi}(\\mathbf{y})$是一个由$Y$-周期函数组成的向量，称为修正场。\n\n为了找到等效电导率分量$K^{\\text{hom}}_{xx}$，我们在$x$方向上施加一个单位宏观梯度，即$\\mathbf{E} = \\mathbf{e}_1 = (1, 0)^T$。此时微观温度为$T(\\mathbf{y}) \\approx y_1 - \\chi_1(\\mathbf{y})$，其中$y_1$是微观坐标向量$\\mathbf{y}$的第一个分量。将此代入控制方程$\\nabla \\cdot (k \\nabla T) = 0$，得到修正函数$\\chi_1(\\mathbf{y})$的晶胞问题：\n$$\n-\\nabla_{\\mathbf{y}} \\cdot \\left( k(\\mathbf{y}) \\nabla_{\\mathbf{y}} \\chi_1(\\mathbf{y}) \\right) = -\\nabla_{\\mathbf{y}} \\cdot \\left( k(\\mathbf{y}) \\mathbf{e}_1 \\right)\n$$\n该方程需要在晶胞$Y$上的周期性边界条件下求解$\\chi_1(\\mathbf{y})$。\n\n下一步是推导晶胞问题的变分或弱形式，这是有限元法的基础。我们将方程乘以一个周期性测试函数$v(\\mathbf{y}) \\in H^1_{\\text{per}}(Y)$，并在域$Y$上积分。应用散度定理并利用函数的周期性，我们得到弱形式：寻找$\\chi_1 \\in H^1_{\\text{per}}(Y)$，使得对于所有$v \\in H^1_{\\text{per}}(Y)$，\n$$\n\\int_Y k(\\mathbf{y}) \\nabla v(\\mathbf{y}) \\cdot \\nabla \\chi_1(\\mathbf{y}) \\, d\\mathbf{y} = \\int_Y k(\\mathbf{y}) \\nabla v(\\mathbf{y}) \\cdot \\mathbf{e}_1 \\, d\\mathbf{y}\n$$\n\n我们将域$Y$离散化为线性三角形单元网格。在每个单元内，修正场$\\chi_1$被近似为节点基函数$N_j(\\mathbf{y})$的线性组合，即$\\chi_1^h(\\mathbf{y}) = \\sum_j u_j N_j(\\mathbf{y})$，其中$u_j$是$\\chi_1$的未知节点值。将此近似代入弱形式，得到一个线性代数方程组$\\mathbf{K} \\mathbf{u} = \\mathbf{f}$，其中：\n- 刚度矩阵$\\mathbf{K}$的项为$K_{ij} = \\int_Y k(\\mathbf{y}) \\nabla N_i \\cdot \\nabla N_j \\, d\\mathbf{y}$。\n- 力向量$\\mathbf{f}$的项为$f_i = \\int_Y k(\\mathbf{y}) \\nabla N_i \\cdot \\mathbf{e}_1 \\, d\\mathbf{y}$。\n- 向量$\\mathbf{u}$包含$\\chi_1$的未知节点值。\n\n积分是通过对网格中每个单元$e$的贡献求和来计算的。对于一个面积为$A_e$且热导率为常数$k_e$的线性三角形单元，单元刚度矩阵和力向量是使用单元上基函数的常数梯度来计算的。\n\n周期性边界条件通过识别晶胞相对边界上的自由度（DoF）来施加。对于一个$(N_x+1) \\times (N_y+1)$节点的网格，这将唯一自由度的数量减少到$N_x N_y$。全局矩阵$\\mathbf{K}$和$\\mathbf{f}$在这个简化的自由度空间中进行组装。\n\n所得矩阵$\\mathbf{K}$是奇异的，因为常数函数在其零空间中（即，对于任意常数$C$，$\\chi_1 + C$也是一个解）。为了获得唯一解，我们必须通过固定某一点的$\\chi_1$值来消除这个零空间。我们通过修改线性系统来强制$\\chi_1(\\mathbf{0}) = 0$，例如，将矩阵$\\mathbf{K}$中对应的行和列设置为零（对角线上为1），并将$\\mathbf{f}$中对应的项设置为零。\n\n一旦找到修正场$\\chi_1$的节点值$\\mathbf{u}$，就可以计算均质化热导率$K^{\\text{hom}}_{xx}$。它被定义为响应于单位宏观梯度$\\mathbf{e}_1$时，$x$方向上的体积平均热通量。\n$$\nK^{\\text{hom}}_{xx} = \\langle q_x \\rangle = \\frac{1}{|Y|} \\int_Y -k(\\mathbf{y}) (\\nabla T)_x \\,d\\mathbf{y} = \\int_Y k(\\mathbf{y}) \\left(1 - \\frac{\\partial \\chi_1}{\\partial y_1}\\right) d\\mathbf{y}\n$$\n因为$|Y|=1$。在数值上，这个积分是通过对每个单元的贡献求和来计算的，使用已解出的节点值$\\mathbf{u}$来确定离散场$\\chi_1^h$的梯度。\n\n特定的热导率分布是在$Y=[0,1]^2$上的一个$2 \\times 2$棋盘格图案，由$k(\\mathbf{x}) = k_1$（如果$\\lfloor 2x \\rfloor + \\lfloor 2y \\rfloor$为偶数）和$k(\\mathbf{x}) = k_2$（否则）定义。单元热导率$k_e$通过在单元形心处评估此函数来确定。对于这种特定的微结构，存在一个解析解：$K^{\\text{hom}}_{xx} = \\sqrt{k_1 k_2}$。这为验证数值实现的正确性提供了一个宝贵的基准。在均匀介质的情况下（$k_1=k_2=k$），修正场$\\chi_1$恒为零，该公式正确地得出$K^{\\text{hom}}_{xx} = k$。\n\n程序将实现这整个过程，从网格生成和矩阵组装到求解线性系统，并为每个指定的测试用例对结果进行后处理。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef compute_khom(Nx, Ny, k1, k2):\n    \"\"\"\n    Computes the homogenized thermal conductivity K_hom_xx for a checkerboard unit cell.\n\n    Args:\n        Nx (int): Number of grid divisions in the x-direction.\n        Ny (int): Number of grid divisions in the y-direction.\n        k1 (float): Thermal conductivity of the first material.\n        k2 (float): Thermal conductivity of the second material.\n\n    Returns:\n        float: The computed homogenized conductivity K_hom_xx.\n    \"\"\"\n    \n    # 1. Mesh Generation\n    num_nodes = (Nx + 1) * (Ny + 1)\n    nodes = np.array([[i / Nx, j / Ny] for j in range(Ny + 1) for i in range(Nx + 1)])\n    \n    elements = []\n    for i in range(Nx):\n        for j in range(Ny):\n            n1 = i * (Ny + 1) + j\n            n2 = (i + 1) * (Ny + 1) + j\n            n3 = (i + 1) * (Ny + 1) + (j + 1)\n            n4 = i * (Ny + 1) + (j + 1)\n            # Split rectangle into two triangles consistently\n            elements.append((n1, n2, n3))\n            elements.append((n1, n3, n4))\n    \n    # 2. DOF Mapping for Periodic Boundary Conditions\n    num_dofs = Nx * Ny\n    dof_map = np.zeros(num_nodes, dtype=int)\n    for i in range(Nx + 1):\n        for j in range(Ny + 1):\n            global_idx = i * (Ny + 1) + j\n            mapped_idx = (i % Nx) * Ny + (j % Ny)\n            dof_map[global_idx] = mapped_idx\n            \n    # 3. Assembly of Stiffness Matrix K and Force Vector f\n    K = lil_matrix((num_dofs, num_dofs), dtype=float)\n    f = np.zeros(num_dofs, dtype=float)\n    \n    element_conductivities = []\n    B_matrices = {} # Cache B matrices to avoid recomputing\n\n    for el_nodes in elements:\n        node_coords = nodes[list(el_nodes)]\n        \n        # Element geometry\n        A_matrix = np.ones((3, 3))\n        A_matrix[:, :2] = node_coords\n        area = 0.5 * np.linalg.det(A_matrix)\n        \n        # Gradients of basis functions (B matrix)\n        # grad(N) = B, where B is a 2x3 matrix\n        B = np.zeros((2, 3))\n        B[0, 0] = node_coords[1, 1] - node_coords[2, 1]\n        B[0, 1] = node_coords[2, 1] - node_coords[0, 1]\n        B[0, 2] = node_coords[0, 1] - node_coords[1, 1]\n        B[1, 0] = node_coords[2, 0] - node_coords[1, 0]\n        B[1, 1] = node_coords[0, 0] - node_coords[2, 0]\n        B[1, 2] = node_coords[1, 0] - node_coords[0, 0]\n        B /= (2 * area)\n        B_matrices[el_nodes] = B\n        \n        # Conductivity at element centroid\n        centroid = np.mean(node_coords, axis=0)\n        # Corrected parity check for 2x2 board\n        parity = np.floor(2 * centroid[0]) + np.floor(2 * centroid[1])\n        k_e = k1 if int(parity) % 2 == 0 else k2\n        element_conductivities.append(k_e)\n        \n        # Element stiffness matrix and force vector\n        K_e = k_e * area * (B.T @ B)\n        f_e = k_e * area * (B.T @ np.array([1, 0]))\n        \n        # Assemble into global system using DOF map\n        p_indices = dof_map[list(el_nodes)]\n        for r_local, r_global in enumerate(p_indices):\n            f[r_global] += f_e[r_local]\n            for c_local, c_global in enumerate(p_indices):\n                K[r_global, c_global] += K_e[r_local, c_local]\n\n    # 4. Enforce Uniqueness (u[0]=0)\n    # The degree of freedom corresponding to the origin (0,0) is at mapped index 0.\n    K = K.tocsr()\n    K[0, :] = 0\n    K[:, 0] = 0\n    K[0, 0] = 1.0\n    f[0] = 0.0\n\n    # 5. Solve the Linear System\n    u_mapped = spsolve(K, f)\n    \n    # Reconstruct the full solution vector\n    u_full = u_mapped[dof_map]\n\n    # 6. Compute Homogenized Conductivity\n    Khom_xx = 0.0\n    for idx, el_nodes in enumerate(elements):\n        node_coords = nodes[list(el_nodes)]\n        A_matrix_area = np.ones((3,3))\n        A_matrix_area[:,:2] = node_coords\n        area = 0.5 * np.linalg.det(A_matrix_area)\n        k_e = element_conductivities[idx]\n        B = B_matrices[el_nodes]\n        \n        u_element = u_full[list(el_nodes)]\n        \n        # d(chi)/dx inside the element\n        dchi_dx = B[0, :] @ u_element\n        \n        # Contribution to the homogenized property\n        Khom_xx += k_e * area * (1 - dchi_dx)\n        \n    return Khom_xx\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nx, Ny, k1, k2)\n        (40, 40, 5, 1),\n        (8, 8, 5, 1),\n        (20, 20, 1, 1),\n        (40, 40, 100, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny, k1, k2 = case\n        result = compute_khom(Nx, Ny, k1, k2)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}