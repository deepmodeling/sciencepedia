{
    "hands_on_practices": [
        {
            "introduction": "在无方程方法中，一个核心挑战是确保宏观估计不受快速、未平衡的微观动力学的污染。本练习利用一个简化的线性模型，清晰地、解析地展示了这种污染是如何作为时间导数估计中的偏差出现的。通过明确推导偏差项，我们可以深入了解为何“愈合”阶段对于该方法的准确性至关重要。",
            "id": "3817569",
            "problem": "考虑一个具有两个分量的微观系统，一个慢分量和一个快分量，分别表示为 $s(t)$ 和 $f(t)$，它们根据一个线性常微分方程 (ODE) 模型演化\n$$\n\\frac{d s}{d t} = \\lambda_{s} s, \\qquad \\frac{d f}{d t} = \\lambda_{f} f,\n$$\n其中 $\\lambda_{s}$ 和 $\\lambda_{f}$ 是满足 $|\\lambda_{f}| \\gg |\\lambda_{s}|$ 和 $\\lambda_{f}  0$ 的实常数。在无方程方法 (Equation-Free Approach, EFA) 中使用的粗观测量定义为\n$$\ny(t) = s(t) + \\beta f(t),\n$$\n其中 $\\beta$ 是一个固定的实数混合参数。设 $Y_{0}$ 为目标粗观测量值。提升算子通过选择以下方式构造一个一致的微观初始条件\n$$\ns(0) = Y_{0} - \\beta a, \\qquad f(0) = a,\n$$\n其中 $a$ 是一个实数参数，用于量化由提升引入的初始快分量失配的大小。这个选择确保了 $y(0) = Y_{0}$。\n\n在 EFA 中，在用持续时间为 $\\delta  0$（$\\delta \\ll 1$）的短时微观爆发来估计粗时间导数之前，允许经过一段愈合时间 $\\tau_{h}  0$ 来衰减快速瞬态。粗有限差分估计计算如下\n$$\nD_{\\mathrm{est}}(\\tau_{h}, \\delta) = \\frac{y(\\tau_{h} + \\delta) - y(\\tau_{h})}{\\delta}.\n$$\n设 $D_{\\mathrm{est}}^{0}(\\tau_{h}, \\delta)$ 表示在提升没有引入快分量失配（即 $a=0$）的情况下将获得的相同有限差分估计。\n\n从上述定义和 ODE 动力学出发，推导因愈合时间不足而产生的偏差的一个精确的闭式解析表达式，\n$$\nB(\\tau_{h}, \\delta) = D_{\\mathrm{est}}(\\tau_{h}, \\delta) - D_{\\mathrm{est}}^{0}(\\tau_{h}, \\delta),\n$$\n该表达式是关于 $\\tau_{h}$、$\\delta$、$\\lambda_{s}$、$\\lambda_{f}$、$\\beta$ 和 $a$ 的函数。请将您的最终答案表示为单个简化的解析表达式。不需要进行数值计算。最终答案中不要包含单位。",
            "solution": "该问题要求推导在一个无方程方法 (EFA) 模拟中，由初始快分量失配导致的偏差 $B(\\tau_{h}, \\delta)$ 的一个精确闭式表达式。该偏差定义为有快分量失配（$a \\neq 0$）时的粗时间导数估计值与没有快分量失配（$a=0$）时的估计值之差。\n\n第一步是求出微观分量 $s(t)$ 和 $f(t)$ 的显式时间演化。控制常微分方程 (ODE) 如下所示：\n$$\n\\frac{d s}{d t} = \\lambda_{s} s, \\qquad \\frac{d f}{d t} = \\lambda_{f} f\n$$\n这些是一阶线性齐次常微分方程，其解是时间 $t$ 的指数函数：\n$$\ns(t) = s(0) \\exp(\\lambda_{s} t)\n$$\n$$\nf(t) = f(0) \\exp(\\lambda_{f} t)\n$$\n其中 $s(0)$ 和 $f(0)$ 是在 $t=0$ 时的初始条件。\n\n问题指明了由提升算子为目标粗观测量值 $Y_{0}$ 和大小为 $a$ 的快分量失配所构造的初始条件：\n$$\ns(0) = Y_{0} - \\beta a\n$$\n$$\nf(0) = a\n$$\n将这些初始条件代入常微分方程的解中，我们得到系统在任意时间 $t \\ge 0$ 的状态：\n$$\ns(t) = (Y_{0} - \\beta a) \\exp(\\lambda_{s} t)\n$$\n$$\nf(t) = a \\exp(\\lambda_{f} t)\n$$\n粗观测量 $y(t)$ 定义为微观分量的线性组合：\n$$\ny(t) = s(t) + \\beta f(t)\n$$\n代入 $s(t)$ 和 $f(t)$ 的表达式，得到粗观测量的时间演化：\n$$\ny(t) = (Y_{0} - \\beta a) \\exp(\\lambda_{s} t) + \\beta \\left( a \\exp(\\lambda_{f} t) \\right) = (Y_{0} - \\beta a) \\exp(\\lambda_{s} t) + \\beta a \\exp(\\lambda_{f} t)\n$$\n问题将粗时间导数的有限差分估计定义为：\n$$\nD_{\\mathrm{est}}(\\tau_{h}, \\delta) = \\frac{y(\\tau_{h} + \\delta) - y(\\tau_{h})}{\\delta}\n$$\n其中 $\\tau_{h}$ 是愈合时间，$\\delta$ 是微观模拟爆发的持续时间。为了计算这个值，我们计算 $y(t)$ 在 $t=\\tau_h$ 和 $t=\\tau_h+\\delta$ 时的值：\n$$\ny(\\tau_{h}) = (Y_{0} - \\beta a) \\exp(\\lambda_{s} \\tau_{h}) + \\beta a \\exp(\\lambda_{f} \\tau_{h})\n$$\n$$\ny(\\tau_{h} + \\delta) = (Y_{0} - \\beta a) \\exp(\\lambda_{s} (\\tau_{h} + \\delta)) + \\beta a \\exp(\\lambda_{f} (\\tau_{h} + \\delta))\n$$\n差值 $y(\\tau_{h} + \\delta) - y(\\tau_{h})$ 为：\n$$\ny(\\tau_{h} + \\delta) - y(\\tau_{h}) = \\left[ (Y_{0} - \\beta a) \\exp(\\lambda_{s} (\\tau_{h} + \\delta)) + \\beta a \\exp(\\lambda_{f} (\\tau_{h} + \\delta)) \\right] - \\left[ (Y_{0} - \\beta a) \\exp(\\lambda_{s} \\tau_{h}) + \\beta a \\exp(\\lambda_{f} \\tau_{h}) \\right]\n$$\n将具有相同系数的项组合在一起：\n$$\ny(\\tau_{h} + \\delta) - y(\\tau_{h}) = (Y_{0} - \\beta a) \\left[ \\exp(\\lambda_{s} (\\tau_{h} + \\delta)) - \\exp(\\lambda_{s} \\tau_{h}) \\right] + \\beta a \\left[ \\exp(\\lambda_{f} (\\tau_{h} + \\delta)) - \\exp(\\lambda_{f} \\tau_{h}) \\right]\n$$\n提出公因式 $\\exp(\\lambda_s \\tau_h)$ 和 $\\exp(\\lambda_f \\tau_h)$：\n$$\ny(\\tau_{h} + \\delta) - y(\\tau_{h}) = (Y_{0} - \\beta a) \\exp(\\lambda_{s} \\tau_{h}) \\left[ \\exp(\\lambda_{s} \\delta) - 1 \\right] + \\beta a \\exp(\\lambda_{f} \\tau_{h}) \\left[ \\exp(\\lambda_{f} \\delta) - 1 \\right]\n$$\n除以 $\\delta$ 得到 $D_{\\mathrm{est}}(\\tau_{h}, \\delta)$ 的完整表达式：\n$$\nD_{\\mathrm{est}}(\\tau_{h}, \\delta) = \\frac{1}{\\delta} \\left( (Y_{0} - \\beta a) \\exp(\\lambda_{s} \\tau_{h}) \\left[ \\exp(\\lambda_{s} \\delta) - 1 \\right] + \\beta a \\exp(\\lambda_{f} \\tau_{h}) \\left[ \\exp(\\lambda_{f} \\delta) - 1 \\right] \\right)\n$$\n接下来，我们确定 $D_{\\mathrm{est}}^{0}(\\tau_{h}, \\delta)$，这是在没有快分量失配（即 $a=0$）情况下的估计值。我们可以通过在 $D_{\\mathrm{est}}(\\tau_{h}, \\delta)$ 的表达式中令 $a=0$ 来得到这个值：\n$$\nD_{\\mathrm{est}}^{0}(\\tau_{h}, \\delta) = \\frac{1}{\\delta} \\left( (Y_{0} - \\beta \\cdot 0) \\exp(\\lambda_{s} \\tau_{h}) \\left[ \\exp(\\lambda_{s} \\delta) - 1 \\right] + \\beta \\cdot 0 \\cdot \\exp(\\lambda_{f} \\tau_{h}) \\left[ \\exp(\\lambda_{f} \\delta) - 1 \\right] \\right)\n$$\n$$\nD_{\\mathrm{est}}^{0}(\\tau_{h}, \\delta) = \\frac{1}{\\delta} \\left( Y_{0} \\exp(\\lambda_{s} \\tau_{h}) \\left[ \\exp(\\lambda_{s} \\delta) - 1 \\right] \\right)\n$$\n最后，我们通过从 $D_{\\mathrm{est}}(\\tau_{h}, \\delta)$ 中减去 $D_{\\mathrm{est}}^{0}(\\tau_{h}, \\delta)$ 来计算偏差 $B(\\tau_{h}, \\delta)$：\n$$\nB(\\tau_{h}, \\delta) = D_{\\mathrm{est}}(\\tau_{h}, \\delta) - D_{\\mathrm{est}}^{0}(\\tau_{h}, \\delta)\n$$\n$$\nB(\\tau_{h}, \\delta) = \\frac{1}{\\delta} \\left( (Y_{0} - \\beta a) \\exp(\\lambda_{s} \\tau_{h}) \\left[ \\exp(\\lambda_{s} \\delta) - 1 \\right] + \\beta a \\exp(\\lambda_{f} \\tau_{h}) \\left[ \\exp(\\lambda_{f} \\delta) - 1 \\right] \\right) - \\frac{1}{\\delta} \\left( Y_{0} \\exp(\\lambda_{s} \\tau_{h}) \\left[ \\exp(\\lambda_{s} \\delta) - 1 \\right] \\right)\n$$\n我们可以合并这些项：\n$$\nB(\\tau_{h}, \\delta) = \\frac{1}{\\delta} \\left( Y_{0} \\exp(\\lambda_{s} \\tau_{h})[\\exp(\\lambda_{s} \\delta)-1] - \\beta a \\exp(\\lambda_{s} \\tau_{h})[\\exp(\\lambda_{s} \\delta)-1] + \\beta a \\exp(\\lambda_{f} \\tau_{h})[\\exp(\\lambda_{f} \\delta)-1] - Y_{0} \\exp(\\lambda_{s} \\tau_{h})[\\exp(\\lambda_{s} \\delta)-1] \\right)\n$$\n包含 $Y_0$ 的项相互抵消，剩下：\n$$\nB(\\tau_{h}, \\delta) = \\frac{1}{\\delta} \\left( - \\beta a \\exp(\\lambda_{s} \\tau_{h})[\\exp(\\lambda_{s} \\delta)-1] + \\beta a \\exp(\\lambda_{f} \\tau_{h})[\\exp(\\lambda_{f} \\delta)-1] \\right)\n$$\n提出公因式 $\\frac{\\beta a}{\\delta}$：\n$$\nB(\\tau_{h}, \\delta) = \\frac{\\beta a}{\\delta} \\left( \\exp(\\lambda_{f} \\tau_{h})[\\exp(\\lambda_{f} \\delta)-1] - \\exp(\\lambda_{s} \\tau_{h})[\\exp(\\lambda_{s} \\delta)-1] \\right)\n$$\n这就是偏差作为指定参数函数的最终、精确的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\beta a}{\\delta} \\left[ \\exp(\\lambda_f \\tau_h) \\left( \\exp(\\lambda_f \\delta) - 1 \\right) - \\exp(\\lambda_s \\tau_h) \\left( \\exp(\\lambda_s \\delta) - 1 \\right) \\right]}\n$$"
        },
        {
            "introduction": "除了系统偏差，无方程方法的估计值还会受到统计波动的影响，特别是当底层微观模型是随机的时。这个练习探讨了如何管理这种统计不确定性。我们将应用基本的统计学原理，来确定需要多少个模拟复本来以期望的精度水平估计一个宏观量（例如时间导数），从而将抽象概念转化为具体的计算设计。",
            "id": "3817524",
            "problem": "考虑用于多尺度建模的无方程方法 (Equation-Free Approach, EFA)，其中粗观测量 $u$ 通过由微观模拟器的短时脉冲构建的粗时间步进器进行演化。在给定的粗观状态 $u_{0}$ 下，假设您通过独立的微观脉冲有限差分估计值的系综平均来估计粗时间导数 $\\dot{u}(u_{0})$。具体来说，对于每个复现 $i$，您执行提升操作，将其映射到一个一致的微观状态，将微观模型演化一小段时间 $\\delta t$，再限制到粗观测量，从而形成单个复现的导数估计值 $d^{(i)} = \\big(u^{(i)}(\\delta t) - u_{0}\\big)/\\delta t$。粗导数估计量是在 $M$ 个具有有限方差的独立同分布 (i.i.d.) 复现上计算的样本均值 $\\hat{D}_{M} = \\frac{1}{M}\\sum_{i=1}^{M} d^{(i)}$。\n\n通过在相同的 $u_{0}$ 和 $\\delta t$ 下对 $M_{0}$ 个 i.i.d. 复现进行的预实验，您已计算出单个复现导数估计值 $\\{d^{(i)}\\}$ 的样本方差为 $s_{0}^{2} = 6.25$。假设复现之间相互独立，并且在工作点处 $d^{(i)}$ 的方差为常数。\n\n您希望选择一个足够大的系综大小 $M$，使得在置信水平 $1-\\alpha = 0.95$ 下，导数均值 $\\mathbb{E}[d^{(i)}]$ 的双边置信区间 (CI) 的半宽不大于指定的容差 $\\varepsilon = 0.5$。请使用预实验方差 $s_{0}^{2}$ 作为方差的代理值，确定达到此目标半宽的最小整数系综大小 $M$。将您的最终答案表示为单个数字。除整数要求外，无需进行其他舍入。",
            "solution": "该问题要求确定最小的整数系综大小 $M$，以确保粗时间导数均值的双边置信区间的半宽不大于指定的容差 $\\varepsilon$。\n\n真实导数均值 $\\mu = \\mathbb{E}[d^{(i)}]$ 的估计量是 $M$ 个独立同分布 (i.i.d.) 复现的样本均值，由下式给出：\n$$\n\\hat{D}_{M} = \\frac{1}{M}\\sum_{i=1}^{M} d^{(i)}\n$$\n单个导数估计值 $d^{(i)}$ 是均值为 $\\mu$、方差为有限值 $\\sigma^2$ 的随机变量。由于复现是独立同分布的，样本均值 $\\hat{D}_{M}$ 的方差为：\n$$\n\\text{Var}(\\hat{D}_{M}) = \\text{Var}\\left(\\frac{1}{M}\\sum_{i=1}^{M} d^{(i)}\\right) = \\frac{1}{M^2}\\sum_{i=1}^{M}\\text{Var}(d^{(i)}) = \\frac{1}{M^2}(M\\sigma^2) = \\frac{\\sigma^2}{M}\n$$\n该估计量的标准差，即均值的标准误，为 $\\text{SE} = \\frac{\\sigma}{\\sqrt{M}}$。\n\n根据中心极限定理，对于足够大的样本量 $M$，样本均值 $\\hat{D}_{M}$ 的分布可以用均值为 $\\mu$、方差为 $\\sigma^2/M$ 的正态分布来近似。标准化变量 $Z = \\frac{\\hat{D}_{M} - \\mu}{\\sigma/\\sqrt{M}}$ 服从标准正态分布 $\\mathcal{N}(0,1)$。\n\n在置信水平 $1-\\alpha$ 下，均值 $\\mu$ 的双边置信区间 (CI) 是基于枢轴量 $Z$ 构建的。该区间由以下概率陈述定义：\n$$\nP\\left(-z_{\\alpha/2} \\le \\frac{\\hat{D}_{M} - \\mu}{\\sigma/\\sqrt{M}} \\le z_{\\alpha/2}\\right) \\approx 1-\\alpha\n$$\n其中 $z_{\\alpha/2}$ 是标准正态分布的临界值，使得 $P(Z  z_{\\alpha/2}) = \\alpha/2$。重新整理不等式以分离出 $\\mu$，可得到置信区间：\n$$\n\\left[ \\hat{D}_{M} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{M}}, \\quad \\hat{D}_{M} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{M}} \\right]\n$$\n此置信区间的半宽是指从区间中心 $\\hat{D}_{M}$ 到任一端点的距离。它由下式给出：\n$$\nW = z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{M}}\n$$\n问题要求此半宽不大于指定的容差 $\\varepsilon$。因此，我们必须满足不等式：\n$$\nz_{\\alpha/2} \\frac{\\sigma}{\\sqrt{M}} \\le \\varepsilon\n$$\n我们需要求解满足此条件的最小整数 $M$。对不等式进行整理以求解 $M$：\n$$\n\\sqrt{M} \\ge \\frac{z_{\\alpha/2} \\sigma}{\\varepsilon}\n$$\n$$\nM \\ge \\left(\\frac{z_{\\alpha/2} \\sigma}{\\varepsilon}\\right)^2\n$$\n问题指定了以下值：\n1.  置信水平为 $1-\\alpha = 0.95$。这意味着 $\\alpha = 0.05$，且 $\\alpha/2 = 0.025$。来自标准正态分布的相应临界值为 $z_{0.025}$，即累积分布函数值为 $1 - 0.025 = 0.975$ 时的值。这个标准值为 $z_{0.025} \\approx 1.96$。\n2.  半宽的容差为 $\\varepsilon = 0.5$。\n3.  单个复现估计值的方差 $\\sigma^2$ 是未知的。但是，题目要求我们使用预实验得到的样本方差 $s_{0}^{2} = 6.25$ 作为真实方差 $\\sigma^2$ 的代理值。因此，我们设 $\\sigma^2 = 6.25$。相应的标准差为 $\\sigma = \\sqrt{6.25} = 2.5$。\n\n将这些值代入关于 $M$ 的不等式中：\n$$\nM \\ge \\left(\\frac{1.96 \\times 2.5}{0.5}\\right)^2\n$$\n我们计算右侧表达式的值：\n$$\nM \\ge \\left(\\frac{4.9}{0.5}\\right)^2\n$$\n$$\nM \\ge (9.8)^2\n$$\n$$\nM \\ge 96.04\n$$\n由于系综大小 $M$ 必须是整数，我们必须选择大于或等于 $96.04$ 的最小整数。这通过对计算值向上取整来实现：\n$$\nM = \\lceil 96.04 \\rceil = 97\n$$\n因此，要达到期望的精度，所需的最小整数系综大小为 $97$。",
            "answer": "$$\n\\boxed{97}\n$$"
        },
        {
            "introduction": "本最终练习将估计和不确定性的概念综合到一个完整的验证工作流程中，这是任何建模研究中的关键一步。我们将应用无方程方法来研究复杂系统中一个常见的问题：估计稳定状态之间稀有过渡事件的速率。本练习涉及使用来自多个短时微观模拟的统计数据来预测平均首次穿越时间（MFPT），然后将此预测与来自直接、长时间模拟的结果进行严格比较。",
            "id": "3817568",
            "problem": "考虑一个多尺度随机系统，使用无方程 (Equation-Free, EF) 方法对其进行双盆粗粒化描述分析。EF 方法通过从与粗粒化盆地一致的适当准备的微观状态开始，执行大量短时、独立的微观模拟（微爆发），然后将结果限制在粗粒化可观测量上，来估计粗粒化转变速率。假设盆地 $A$ 和 $B$ 之间的粗粒化动力学可以近似为一个连续时间马尔可夫跳跃过程，其从盆地 $A$ 到盆地 $B$ 的转变速率为 $k_{A \\to B}$，从盆地 $B$ 到盆地 $A$ 的转变速率为 $k_{B \\to A}$。对于这样一个无记忆过程，从一个盆地转变出去的等待时间呈指数分布。\n\n对于两个方向，给定在微爆发中累积的总暴露时间内观测到的转变计数。令 $N$ 表示在给定方向上观测到的转变次数，$T$ 表示在该源盆地中的总暴露时间。在转变是齐次泊松过程的假设下，计数 $N$ 服从泊松分布，其均值为 $\\mu = k \\, T$，其中 $k$ 是该方向的真实转变速率。速率的一个无偏估计量是 $\\hat{k} = N/T$。可以使用卡方分布（chi-square distribution）得到泊松均值 $\\mu$ 在置信水平 $1 - \\alpha$ 下的双侧置信区间：\n$$\n\\mu_{\\text{low}} = \\frac{1}{2} \\chi^2_{\\alpha/2, \\, 2N}, \\quad \\mu_{\\text{high}} = \\frac{1}{2} \\chi^2_{1 - \\alpha/2, \\, 2(N+1)},\n$$\n约定当 $N = 0$ 时，使用 $\\mu_{\\text{low}} = 0$ 和 $\\mu_{\\text{high}} = \\frac{1}{2} \\chi^2_{1 - \\alpha/2, \\, 2}$。\n将其转换为速率 $k$ 的置信区间可得\n$$\nk_{\\text{low}} = \\frac{\\mu_{\\text{low}}}{T}, \\quad k_{\\text{high}} = \\frac{\\mu_{\\text{high}}}{T}.\n$$\n由于从源盆地出发的平均首次穿越时间 (Mean First Passage Time, MFPT) 等于指数等待时间的期望值，因此离开一个盆地朝向另一个盆地方向的 MFPT 为\n$$\n\\text{MFPT} = \\frac{1}{k}.\n$$\n因此，由速率区间导出的预测 MFPT 置信区间为\n$$\n\\text{MFPT}_{\\text{low}} = \\frac{1}{k_{\\text{high}}}, \\quad \\text{MFPT}_{\\text{high}} =\n\\begin{cases}\n\\frac{1}{k_{\\text{low}}},  \\text{if } k_{\\text{low}}  0, \\\\\n+\\infty,  \\text{if } k_{\\text{low}} = 0.\n\\end{cases}\n$$\n\n同时，您也获得了直接长时间微观模拟得到的 MFPT 结果，报告为样本均值、样本标准差和样本大小。假设样本是方差有限的独立同分布样本，可以使用学生t分布 (Student’s t-distribution) 构建平均 MFPT 在置信水平 $1 - \\alpha$ 下的双侧置信区间：\n$$\n\\overline{M} \\pm t_{1 - \\alpha/2, \\, \\nu} \\, \\frac{S}{\\sqrt{m}},\n$$\n其中 $\\overline{M}$ 是样本平均 MFPT，$S$ 是样本标准差，$m$ 是样本大小，$\\nu = m - 1$ 是自由度。\n\n验证标准：对于每个方向，如果 EF 预测的 MFPT 置信区间与直接长时间微观模拟的 MFPT 置信区间有非空交集，则声明验证成功。换言之，如果 $[\\text{MFPT}_{\\text{low}}, \\text{MFPT}_{\\text{high}}] \\cap [M_{\\text{obs,low}}, M_{\\text{obs,high}}] \\neq \\emptyset$。\n\n所有时间都以秒为单位计算，所有速率都以秒的倒数为单位。角度单位不适用。不要使用百分比；置信水平由小数形式的 $\\alpha$ 指定。\n\n您的任务是实现一个程序，为下面的每个测试用例计算两个布尔值，分别表示验证标准对于 $A \\to B$ 和 $B \\to A$ 是否成立。您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目是该测试用例的一个双元素布尔值列表，顺序为 $[ \\text{valid}_{A \\to B}, \\text{valid}_{B \\to A} ]$。\n\n对于泊松速率区间和 t-区间，均使用置信水平为 $1 - \\alpha = 0.95$ 的置信区间。测试套件如下：\n\n- 测试用例 1 (中等，平衡):\n  - $A \\to B$：$N = 105$，$T = 1000.0$ s，观测到的长时间微观模拟 MFPT 均值 $\\overline{M} = 9.8$ s，样本标准差 $S = 3.0$ s，样本大小 $m = 200$。\n  - $B \\to A$：$N = 190$，$T = 1000.0$ s，观测到的长时间微观模拟 MFPT 均值 $\\overline{M} = 5.3$ s，样本标准差 $S = 2.0$ s，样本大小 $m = 200$。\n\n- 测试用例 2 (稀有事件，宽区间):\n  - $A \\to B$：$N = 5$，$T = 1000.0$ s，观测到的长时间微观模拟 MFPT 均值 $\\overline{M} = 220.0$ s，样本标准差 $S = 80.0$ s，样本大小 $m = 50$。\n  - $B \\to A$：$N = 12$，$T = 1000.0$ s，观测到的长时间微观模拟 MFPT 均值 $\\overline{M} = 90.0$ s，样本标准差 $S = 40.0$ s，样本大小 $m = 50$。\n\n- 测试用例 3 (零计数边界情况和非对称速率):\n  - $A \\to B$：$N = 0$，$T = 500.0$ s，观测到的长时间微观模拟 MFPT 均值 $\\overline{M} = 250.0$ s，样本标准差 $S = 120.0$ s，样本大小 $m = 20$。\n  - $B \\to A$：$N = 50$，$T = 500.0$ s，观测到的长时间微观模拟 MFPT 均值 $\\overline{M} = 11.0$ s，样本标准差 $S = 4.0$ s，样本大小 $m = 100$。\n\n- 测试用例 4 (高速率，窄区间):\n  - $A \\to B$：$N = 900$，$T = 1000.0$ s，观测到的长时间微观模拟 MFPT 均值 $\\overline{M} = 1.05$ s，样本标准差 $S = 0.30$ s，样本大小 $m = 200$。\n  - $B \\to A$：$N = 1100$，$T = 1000.0$ s，观测到的长时间微观模拟 MFPT 均值 $\\overline{M} = 0.95$ s，样本标准差 $S = 0.25$ s，样本大小 $m = 200$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例由一个双元素布尔值列表 $[ \\text{valid}_{A \\to B}, \\text{valid}_{B \\to A} ]$ 表示。例如，输出格式应类似于 $[[\\text{true},\\text{false}],[\\text{true},\\text{true}],\\dots]$，但使用 Python 的布尔值大小写且不含省略号。",
            "solution": "该问题经评估有效。它在科学上是合理的、良定的和客观的，基于统计力学和概率论的既定原则。所有为获得唯一解所必需的数据和定义均已提供。因此，我们可以着手求解。\n\n核心任务是根据直接长时间微观模拟的结果，验证从无方程 (EF) 方法推导出的粗粒化模型。验证标准是两种不同方法计算出的平均首次穿越时间 (MFPT) 的置信区间存在非空交集。这将针对多个测试用例，在 $A \\to B$ 和 $B \\to A$ 两个转变方向上进行。所有计算都将使用 $1 - \\alpha = 0.95$ 的置信水平，这意味着 $\\alpha = 0.05$。\n\n每个测试用例中每个转变方向的总体步骤包括三个主要部分：\n1.  计算 EF 粗粒化模型预测的 MFPT 的 $95\\%$ 置信区间。\n2.  计算从直接长时间模拟中获得的 MFPT 的 $95\\%$ 置信区间。\n3.  检查这两个区间是否重叠。\n\n让我们详细说明每个步骤的计算过程。\n\n**步骤 1：无方程方法预测的 MFPT 置信区间**\n\nEF 方法提供了在总暴露时间 $T$ 内的转变计数 $N$。这些数据用于构建底层转变速率 $k$ 的置信区间，然后将其转换为 MFPT 的区间。\n\n首先，我们确定底层泊松过程均值 $\\mu = kT$ 的 $95\\%$ 置信区间，计数 $N$ 被假定为该过程的一个样本。$\\mu$ 的置信区间由 $[\\mu_{\\text{low}}, \\mu_{\\text{high}}]$ 给出，使用卡方 ($\\chi^2$) 分布计算。公式如下：\n$$\n\\mu_{\\text{low}} = \\frac{1}{2} \\chi^2_{\\alpha/2, \\, 2N}\n$$\n$$\n\\mu_{\\text{high}} = \\frac{1}{2} \\chi^2_{1 - \\alpha/2, \\, 2(N+1)}\n$$\n其中 $\\chi^2_{p, \\nu}$ 是卡方分布对于概率 $p$ 和 $\\nu$ 自由度的分位数函数（逆累积分布函数）。当 $\\alpha = 0.05$ 时，我们使用概率 $p = \\alpha/2 = 0.025$ 和 $p = 1 - \\alpha/2 = 0.975$。\n\n当 $N=0$ 时会出现一个特殊情况。在这种情况下，观测到零事件不允许我们为速率建立一个非零的下界。公式调整如下：\n$$\n\\mu_{\\text{low}} = 0 \\quad (\\text{for } N=0)\n$$\n$$\n\\mu_{\\text{high}} = \\frac{1}{2} \\chi^2_{1 - \\alpha/2, \\, 2} \\quad (\\text{for } N=0)\n$$\n\n其次，我们将 $\\mu$ 的置信区间通过除以总暴露时间 $T$ 转换为速率 $k$ 的置信区间：\n$$\nk_{\\text{low}} = \\frac{\\mu_{\\text{low}}}{T}\n$$\n$$\nk_{\\text{high}} = \\frac{\\mu_{\\text{high}}}{T}\n$$\n\n第三，我们计算 MFPT 的置信区间。由于 $\\text{MFPT} = 1/k$，从速率区间 $[k_{\\text{low}}, k_{\\text{high}}]$ 到 MFPT 区间 $[\\text{MFPT}_{\\text{low}}, \\text{MFPT}_{\\text{high}}]$ 的映射是一个求逆运算，这会反转边界：\n$$\n\\text{MFPT}_{\\text{low}} = \\frac{1}{k_{\\text{high}}}\n$$\n$$\n\\text{MFPT}_{\\text{high}} = \\frac{1}{k_{\\text{low}}}\n$$\n如果 $N=0$，那么 $k_{\\text{low}}=0$，MFPT 的上界变为无穷大，这反映了我们无法排除任意长的等待时间：\n$$\n\\text{MFPT}_{\\text{high}} = +\\infty \\quad (\\text{for } N=0)\n$$\n\n**步骤 2：直接模拟的 MFPT 置信区间**\n\n直接长时间模拟提供了一组 MFPT 值的样本，由样本均值 $\\overline{M}$、样本标准差 $S$ 和样本大小 $m$ 概括。假设样本是独立同分布的，中心।।极限定理允许我们使用学生t分布 (Student's t-distribution) 为真实平均 MFPT 构建一个置信区间。\n\n$95\\%$ 置信区间由以下公式给出：\n$$\n[M_{\\text{obs,low}}, M_{\\text{obs,high}}] = \\overline{M} \\pm t_{1 - \\alpha/2, \\, \\nu} \\frac{S}{\\sqrt{m}}\n$$\n其中 $\\nu = m - 1$ 是自由度，$t_{p, \\nu}$ 是学生t分布对于概率 $p$ 的分位数函数。当 $\\alpha = 0.05$ 时，我们使用 $p = 1 - \\alpha/2 = 0.975$。项 $S/\\sqrt{m}$ 是均值的标准误差。\n\n**步骤 3：通过区间交集进行验证**\n\n如果两个置信区间有非空交集，则声明验证成功。设 EF 预测的区间为 $I_{EF} = [\\text{MFPT}_{\\text{low}}, \\text{MFPT}_{\\text{high}}]$，直接模拟的区间为 $I_{Sim} = [M_{\\text{obs,low}}, M_{\\text{obs,high}}]$。当且仅当每个区间的下界小于或等于另一个区间的上界时，交集为非空。即：\n$$\n\\text{MFPT}_{\\text{low}} \\le M_{\\text{obs,high}} \\quad \\text{and} \\quad M_{\\text{obs,low}} \\le \\text{MFPT}_{\\text{high}}\n$$\n对于每个测试用例中的每个方向（$A \\to B$ 和 $B \\to A$），都将评估此条件，从而产生一对布尔值。然后将这些结果汇总成指定的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2, t\n\ndef solve():\n    \"\"\"\n    Computes validation results for Equation-Free model predictions against\n    direct simulation data for several test cases.\n    \"\"\"\n    # Confidence level alpha\n    alpha = 0.05\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing data for A-B and B-A transitions.\n    # Format: ((N, T, M_bar, S, m), (N, T, M_bar, S, m))\n    test_cases = [\n        # Test case 1 (moderate, balanced)\n        (\n            {'N': 105, 'T': 1000.0, 'M_bar': 9.8, 'S': 3.0, 'm': 200},  # A - B\n            {'N': 190, 'T': 1000.0, 'M_bar': 5.3, 'S': 2.0, 'm': 200}   # B - A\n        ),\n        # Test case 2 (rare events, wide intervals)\n        (\n            {'N': 5, 'T': 1000.0, 'M_bar': 220.0, 'S': 80.0, 'm': 50},  # A - B\n            {'N': 12, 'T': 1000.0, 'M_bar': 90.0, 'S': 40.0, 'm': 50}   # B - A\n        ),\n        # Test case 3 (zero-count edge case and asymmetric rates)\n        (\n            {'N': 0, 'T': 500.0, 'M_bar': 250.0, 'S': 120.0, 'm': 20},  # A - B\n            {'N': 50, 'T': 500.0, 'M_bar': 11.0, 'S': 4.0, 'm': 100}   # B - A\n        ),\n        # Test case 4 (high-rate, narrow intervals)\n        (\n            {'N': 900, 'T': 1000.0, 'M_bar': 1.05, 'S': 0.30, 'm': 200}, # A - B\n            {'N': 1100, 'T': 1000.0, 'M_bar': 0.95, 'S': 0.25, 'm': 200} # B - A\n        )\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = []\n        for direction_data in case:\n            is_valid = validate_direction(alpha=alpha, **direction_data)\n            case_results.append(is_valid)\n        results.append(case_results)\n\n    # Format the final output string to match the required format.\n    # Example: [[True,False],[True,True]]\n    final_output = str(results).replace(' ', '')\n    print(final_output)\n\ndef validate_direction(N, T, M_bar, S, m, alpha):\n    \"\"\"\n    Performs validation for a single transition direction by checking for\n    overlap between EF-predicted and direct simulation MFPT confidence intervals.\n\n    Args:\n        N (int): Number of observed transitions.\n        T (float): Total exposure time.\n        M_bar (float): Sample mean MFPT from long simulations.\n        S (float): Sample standard deviation of MFPT.\n        m (int): Sample size for long simulations.\n        alpha (float): Significance level for confidence intervals.\n\n    Returns:\n        bool: True if validation is successful (intervals overlap), False otherwise.\n    \"\"\"\n    # Step 1: Calculate the EF-predicted MFPT Confidence Interval\n    alpha_half = alpha / 2.0\n\n    if N == 0:\n        mu_low = 0.0\n        # For N=0, df_high is 2*(0+1) = 2\n        df_high = 2\n        mu_high = 0.5 * chi2.ppf(1 - alpha_half, df_high)\n    else:\n        df_low = 2 * N\n        df_high = 2 * (N + 1)\n        mu_low = 0.5 * chi2.ppf(alpha_half, df_low)\n        mu_high = 0.5 * chi2.ppf(1 - alpha_half, df_high)\n        \n    k_low = mu_low / T\n    k_high = mu_high / T\n\n    mfpt_ef_low = 1.0 / k_high\n    mfpt_ef_high = 1.0 / k_low if k_low > 0 else np.inf\n\n    # Step 2: Calculate the Direct Simulation MFPT Confidence Interval\n    nu = m - 1\n    t_crit = t.ppf(1 - alpha_half, nu)\n    margin_of_error = t_crit * S / np.sqrt(m)\n    \n    mfpt_sim_low = M_bar - margin_of_error\n    mfpt_sim_high = M_bar + margin_of_error\n    \n    # Step 3: Perform the Validation Check (Interval Intersection)\n    overlap = (mfpt_ef_low = mfpt_sim_high) and (mfpt_sim_low = mfpt_ef_high)\n    \n    return overlap\n\nsolve()\n```"
        }
    ]
}