{
    "hands_on_practices": [
        {
            "introduction": "在应用平均法时，我们有时会发现慢变量的主导漂移项在平均后消失了。这个练习从一个更深刻的结构性视角揭示了这一现象背后的原因，引入了“上边缘” (coboundary) 的概念。通过证明如果慢变量的动力学可以表示为快流场下的一个李导数，那么其平均效应将精确为零，你将对平均原理获得超越纯粹计算的理解 。",
            "id": "3734750",
            "problem": "考虑圆环 $\\mathbb{T}=\\mathbb{R}/(2\\pi\\mathbb{Z})$ 上的一个快慢常微分方程（ODE）系统，该系统包含一个快相 $y_{\\varepsilon}(t)\\in\\mathbb{T}$ 和一个慢变量 $x_{\\varepsilon}(t)\\in\\mathbb{R}$：\n$$\n\\dot{x}_{\\varepsilon}(t)=f\\bigl(x_{\\varepsilon}(t),y_{\\varepsilon}(t)\\bigr),\\qquad \\dot{y}_{\\varepsilon}(t)=\\frac{1}{\\varepsilon}\\,b\\bigl(y_{\\varepsilon}(t)\\bigr),\n$$\n其中 $\\varepsilon\\in(0,1]$ 很小，且 $b:\\mathbb{T}\\to\\mathbb{R}$ 是一个在 $\\mathbb{T}$ 上处处严格为正的光滑函数。令 $\\mathcal{L}_{b}$ 表示沿快向量场 $b$ 的李导数，即对于一个光滑函数 $g:\\mathbb{R}\\times\\mathbb{T}\\to\\mathbb{R}$，若其关于第二个参数是 $2\\pi$-周期的，则\n$$\n\\mathcal{L}_{b} g(x,y):=\\partial_{y}g(x,y)\\,b(y).\n$$\n假设 $f$ 是一个相对于快流的上边缘，即对于某个这样的函数 $g$，有 $f(x,y)=\\mathcal{L}_{b} g(x,y)$。仅使用链式法则、李导数的定义以及由 $\\dot{y}=b(y)$ 生成的 $\\mathbb{T}$ 上的快流存在一个相对于勒贝格测度绝对连续的唯一光滑不变概率测度这一事实，完成以下任务：\n\n1. 从基本原理出发，证明慢变量的平均漂移为零，具体来说，即证明平均向量场\n$$\n\\bar{f}(x):=\\int_{\\mathbb{T}} f(x,y)\\,\\mu(\\mathrm{d}y)\n$$\n对所有 $x\\in\\mathbb{R}$ 都等于 $0$，其中 $\\mu$ 是快流的不变概率测度。\n\n2. 特化为具有恒定速度 $b(y)=\\omega$（给定常数 $\\omega>0$）的显式快流，因此有 $\\dot{y}_{\\varepsilon}(t)=\\omega/\\varepsilon$。选择与 $x$ 无关的 $g$，令 $g(y)=\\sin(y)$，从而定义 $f(x,y):=\\mathcal{L}_{b}g(x,y)=\\omega\\cos(y)$。在初始条件 $x_{\\varepsilon}(0)=x_{0}$ 和 $y_{\\varepsilon}(0)=y_{0}$ 下，计算在任意最终时刻 $T>0$ 时 $x_{\\varepsilon}(T)$ 的精确表达式，用 $x_{0}$、$y_{0}$、$\\omega$、$\\varepsilon$ 和 $T$ 表示。将最终结果表示为单一的闭式解析表达式。无需四舍五入，也不涉及物理单位。角度在 $\\mathbb{T}$ 上应被视为无量纲（弧度）。",
            "solution": "该问题是适定的，有科学依据，并包含足够的信息以得到唯一解。\n\n**第一部分：消失的平均漂移**\n\n我们的任务是证明对于所有 $x \\in \\mathbb{R}$，平均向量场 $\\bar{f}(x)$ 都为零，其中\n$$\n\\bar{f}(x) := \\int_{\\mathbb{T}} f(x,y)\\,\\mu(\\mathrm{d}y).\n$$\n问题陈述 $f(x,y)$ 是一个上边缘，意味着对于某个光滑且关于第二个参数是 $2\\pi$-周期的函数 $g$，有 $f(x,y) = \\mathcal{L}_b g(x,y) = \\partial_{y}g(x,y) b(y)$。测度 $\\mu$ 是由向量场 $b(y)$ 生成的圆环 $\\mathbb{T} = \\mathbb{R}/(2\\pi\\mathbb{Z})$ 上快流的唯一光滑不变概率测度。此快流的控制方程是 $\\dot{y} = b(y)$。\n\n测度 $\\mu$ 关于由 $b(y)$ 生成的流 $\\phi_t$ 的不变性意味着，对于 $\\mathbb{T}$ 上的任意光滑、$2\\pi$-周期的检验函数 $h(y)$，函数 $h$ 对 $\\mu$ 的积分沿流是常数。即，\n$$\n\\int_{\\mathbb{T}} h(\\phi_t(y))\\,\\mu(\\mathrm{d}y) = \\int_{\\mathbb{T}} h(y)\\,\\mu(\\mathrm{d}y) \\quad \\text{对所有 } t \\in \\mathbb{R}.\n$$\n由于右侧是常数，左侧对时间的导数必须为零。我们对 $t$ 求导并在 $t=0$ 处取值：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\bigg|_{t=0} \\int_{\\mathbb{T}} h(\\phi_t(y))\\,\\mu(\\mathrm{d}y) = 0.\n$$\n对于光滑函数，我们可以交换微分和积分的顺序：\n$$\n\\int_{\\mathbb{T}} \\left( \\frac{\\mathrm{d}}{\\mathrm{d}t}\\bigg|_{t=0} h(\\phi_t(y)) \\right) \\mu(\\mathrm{d}y) = 0.\n$$\n使用链式法则，积分内的导数是\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\bigg|_{t=0} h(\\phi_t(y)) = \\partial_y h(y) \\cdot \\frac{\\mathrm{d}\\phi_t(y)}{\\mathrm{d}t}\\bigg|_{t=0}.\n$$\n根据流的定义，$\\frac{\\mathrm{d}\\phi_t(y)}{\\mathrm{d}t} = b(\\phi_t(y))$，所以在 $t=0$ 时，这给出 $\\frac{\\mathrm{d}\\phi_t(y)}{\\mathrm{d}t}\\big|_{t=0} = b(\\phi_0(y)) = b(y)$。\n因此，积分内的表达式变为\n$$\n\\partial_y h(y) \\, b(y) = \\mathcal{L}_b h(y),\n$$\n即函数 $h$ 沿向量场 $b$ 的李导数。\n因此，不变测度 $\\mu$ 的一个基本性质是，任何光滑的 $2\\pi$-周期函数的李导数的积分为零：\n$$\n\\int_{\\mathbb{T}} \\mathcal{L}_b h(y)\\,\\mu(\\mathrm{d}y) = 0.\n$$\n现在，我们应用这个性质来计算 $\\bar{f}(x)$。我们将上边缘条件 $f(x,y) = \\mathcal{L}_b g(x,y)$ 代入 $\\bar{f}(x)$ 的定义中：\n$$\n\\bar{f}(x) = \\int_{\\mathbb{T}} \\mathcal{L}_b g(x,y)\\,\\mu(\\mathrm{d}y).\n$$\n对于任意固定的 $x \\in \\mathbb{R}$，函数 $y \\mapsto g(x,y)$ 是 $\\mathbb{T}$ 上的一个光滑、$2\\pi$-周期的函数。我们用 $g_x(y) = g(x,y)$ 表示这个函数。那么被积函数就是 $\\mathcal{L}_b g_x(y)$。\n基于上面推导出的普遍性质（取 $h=g_x$），我们有\n$$\n\\bar{f}(x) = \\int_{\\mathbb{T}} \\mathcal{L}_b g_x(y)\\,\\mu(\\mathrm{d}y) = 0.\n$$\n这对所有 $x \\in \\mathbb{R}$ 都成立，从而完成了证明。\n\n**第二部分：一个特定情况的精确解**\n\n给定特定系统：\n$$\n\\dot{x}_{\\varepsilon}(t) = \\omega\\cos\\bigl(y_{\\varepsilon}(t)\\bigr), \\qquad \\dot{y}_{\\varepsilon}(t) = \\frac{\\omega}{\\varepsilon},\n$$\n初始条件为 $x_{\\varepsilon}(0) = x_0$ 和 $y_{\\varepsilon}(0) = y_0$。我们需要求出在时刻 $T > 0$ 时 $x_{\\varepsilon}(T)$ 的精确表达式。\n\n首先，我们求解快变量 $y_{\\varepsilon}(t)$ 的方程。这是一个简单的线性常微分方程。\n$$\n\\frac{\\mathrm{d}y_{\\varepsilon}}{\\mathrm{d}t} = \\frac{\\omega}{\\varepsilon}.\n$$\n对时间从 $0$ 到 $t$ 进行积分，得到：\n$$\n\\int_{y_{\\varepsilon}(0)}^{y_{\\varepsilon}(t)} \\mathrm{d}y = \\int_0^t \\frac{\\omega}{\\varepsilon} \\mathrm{d}\\tau.\n$$\n$$\ny_{\\varepsilon}(t) - y_0 = \\frac{\\omega}{\\varepsilon}t.\n$$\n因此，快变量的解是：\n$$\ny_{\\varepsilon}(t) = y_0 + \\frac{\\omega t}{\\varepsilon}.\n$$\n接下来，我们将此解代入慢变量 $x_{\\varepsilon}(t)$ 的方程中：\n$$\n\\frac{\\mathrm{d}x_{\\varepsilon}}{\\mathrm{d}t} = \\omega\\cos\\left(y_0 + \\frac{\\omega t}{\\varepsilon}\\right).\n$$\n为了求 $x_{\\varepsilon}(T)$，我们将此方程从 $t=0$ 积分到 $t=T$：\n$$\n\\int_{x_{\\varepsilon}(0)}^{x_{\\varepsilon}(T)} \\mathrm{d}x = \\int_0^T \\omega\\cos\\left(y_0 + \\frac{\\omega t}{\\varepsilon}\\right)\\mathrm{d}t.\n$$\n$$\nx_{\\varepsilon}(T) - x_{\\varepsilon}(0) = \\omega \\int_0^T \\cos\\left(y_0 + \\frac{\\omega t}{\\varepsilon}\\right)\\mathrm{d}t.\n$$\n我们计算右侧的积分：\n$$\n\\int_0^T \\cos\\left(y_0 + \\frac{\\omega t}{\\varepsilon}\\right)\\mathrm{d}t = \\left[ \\frac{\\varepsilon}{\\omega}\\sin\\left(y_0 + \\frac{\\omega t}{\\varepsilon}\\right) \\right]_{t=0}^{t=T}.\n$$\n$$\n= \\frac{\\varepsilon}{\\omega} \\left( \\sin\\left(y_0 + \\frac{\\omega T}{\\varepsilon}\\right) - \\sin\\left(y_0\\right) \\right).\n$$\n将此结果代回到 $x_{\\varepsilon}(T)$ 的方程中：\n$$\nx_{\\varepsilon}(T) - x_0 = \\omega \\left[ \\frac{\\varepsilon}{\\omega} \\left( \\sin\\left(y_0 + \\frac{\\omega T}{\\varepsilon}\\right) - \\sin(y_0) \\right) \\right].\n$$\n$$\nx_{\\varepsilon}(T) - x_0 = \\varepsilon \\left( \\sin\\left(y_0 + \\frac{\\omega T}{\\varepsilon}\\right) - \\sin(y_0) \\right).\n$$\n最后，解出 $x_{\\varepsilon}(T)$，我们得到精确的闭式表达式：\n$$\nx_{\\varepsilon}(T) = x_0 + \\varepsilon \\left( \\sin\\left(y_0 + \\frac{\\omega T}{\\varepsilon}\\right) - \\sin(y_0) \\right).\n$$",
            "answer": "$$\\boxed{x_0 + \\varepsilon \\left(\\sin\\left(y_0 + \\frac{\\omega T}{\\varepsilon}\\right) - \\sin(y_0)\\right)}$$"
        },
        {
            "introduction": "在理解了平均漂移可能消失的深层原因后，掌握处理那些漂移不为零或需要考虑高阶效应的系统至关重要。本练习要求你从第一性原理出发，通过近恒等变换，系统地进行二阶平均计算。通过这个经典案例，你将亲身体会到快变量动力学中的微小项如何能在二阶上对慢变量动力学产生关键的非振荡性修正，这对于精确捕捉系统的长期演化行为是必不可少的 。",
            "id": "3734761",
            "problem": "考虑一个关于径向振幅 $r(t)$ 和快相 $\\theta(t)$ 的二维自治动力系统，\n$$\n\\dot{r} \\;=\\; \\epsilon\\,\\alpha\\,r \\;+\\; \\epsilon\\,\\beta\\,r\\,\\cos\\theta, \n\\qquad\n\\dot{\\theta} \\;=\\; \\omega \\;+\\; \\epsilon\\,\\gamma\\,\\sin\\theta,\n$$\n其中 $\\epsilon>0$ 是一个小参数，$\\omega\\neq 0$ 是一个恒定的快频率，$\\alpha,\\beta,\\gamma$ 是有界常数。所有角度都以弧度为单位。目标是推导慢振幅 $R(t)$ 和修正快相 $\\Theta(t)$ 的平均动力学，直至并包括 $\\epsilon^{2}$ 阶项。\n\n从快慢系统的平均法第一性原理出发：快相 $\\,\\theta\\,$ 在诸如 $\\cos\\theta$ 和 $\\sin\\theta$ 的项中产生 $\\mathcal{O}(1)$ 的振荡，通过使用一个在快相上周期性的近恒等变量变换，在快运动的一个周期内消除对快相的主要振荡依赖，从而获得平均（有效）慢动力学。通过引入一个近恒等变换来系统地进行，该变换去除 $\\mathcal{O}(\\epsilon)$ 阶的振荡项，然后计算 $\\mathcal{O}(\\epsilon^{2})$ 阶的剩余平均漂移。\n\n假设系统足够光滑，使得所有展开和平均都是合理的，并保持所有常数为符号形式。不要使用任何现成的快捷公式。推导 $(R,\\Theta)$ 的平均系统，其右侧表达式精确到并包括 $\\epsilon^{2}$ 阶项。\n\n将您的最终答案以平均系统 $(\\dot{R},\\dot{\\Theta})$ 右侧表达式对的形式提供，表示为一个按 $(\\dot{R},\\dot{\\Theta})$ 顺序排列的两元行矩阵。不需要进行数值取整。",
            "solution": "用户希望我解决这个问题。\n\n### 第一步：提取已知条件\n问题陈述提供了以下信息：\n- 一个关于径向振幅 $r(t)$ 和快相 $\\theta(t)$ 的二维自治动力系统：\n$$\n\\dot{r} \\;=\\; \\epsilon\\,\\alpha\\,r \\;+\\; \\epsilon\\,\\beta\\,r\\,\\cos\\theta \\\\\n\\dot{\\theta} \\;=\\; \\omega \\;+\\; \\epsilon\\,\\gamma\\,\\sin\\theta\n$$\n- 参数和变量：\n  - $\\epsilon > 0$ 是一个小参数。\n  - $\\omega \\neq 0$ 是一个恒定的快频率。\n  - $\\alpha, \\beta, \\gamma$ 是有界常数。\n  - $r(t)$ 是径向振幅。\n  - $\\theta(t)$ 是快相，以弧度为单位。\n- 目标是推导慢振幅 $R(t)$ 和修正快相 $\\Theta(t)$ 的平均动力学，直至并包括 $\\epsilon^2$ 阶项。\n- 推导必须从平均法的第一性原理出发，使用近恒等变量变换。\n- 禁止使用快捷公式。\n- $(\\dot{R}, \\dot{\\Theta})$ 的平均系统应精确到 $\\mathcal{O}(\\epsilon^2)$。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了一个标准的快慢动力系统，常用于模拟具有慢振幅和频率调制的振荡器。通过近恒等变换的平均法是动力系统微扰理论的基石。该问题牢固地建立在公认的数学物理原理之上。\n2.  **适定性**：该问题是适定的。方程已给出，参数已定义，任务是应用一个标准的、定义明确的数学过程来推导结果。条件 $\\omega \\neq 0$ 确保了涉及除以 $\\omega$ 的平均过程是良定义的。\n3.  **客观性**：该问题以精确的数学语言陈述，没有任何主观或模棱两可的术语。\n\n### 第三步：结论与行动\n该问题是有效的。它是动力系统理论中一个标准的、适定的问题。我将继续进行求解。\n\n问题要求从第一性原理推导一个平均系统，直至 $\\epsilon^2$ 阶。我们给定的快慢系统是：\n$$\n\\dot{r} = \\epsilon(\\alpha r + \\beta r \\cos\\theta) \\\\\n\\dot{\\theta} = \\omega + \\epsilon \\gamma \\sin\\theta\n$$\n这里，$\\theta$ 是快变量，因为 $\\dot{\\theta} = \\mathcal{O}(1)$；$r$ 是慢变量，因为 $\\dot{r} = \\mathcal{O}(\\epsilon)$。\n\n我们引入一个到新变量的近恒等变换，即由平均方程控制的慢振幅 $R(t)$ 和快相 $\\Theta(t)$。该变换定义为 $\\epsilon$ 的级数展开：\n$$\nr(t) = R(t) + \\epsilon u_1(R, \\Theta) + \\epsilon^2 u_2(R, \\Theta) + \\mathcal{O}(\\epsilon^3) \\\\\n\\theta(t) = \\Theta(t) + \\epsilon a_1(R, \\Theta) + \\epsilon^2 a_2(R, \\Theta) + \\mathcal{O}(\\epsilon^3)\n$$\n函数 $u_1, u_2, a_1, a_2$ 被选择为关于 $\\Theta$ 的周期函数，且均值为零，以吸收振荡动力学。$R$ 和 $\\Theta$ 的平均系统将具有以下形式：\n$$\n\\dot{R} = \\epsilon F_1(R) + \\epsilon^2 F_2(R) + \\mathcal{O}(\\epsilon^3) \\\\\n\\dot{\\Theta} = \\omega + \\epsilon G_1(R) + \\epsilon^2 G_2(R) + \\mathcal{O}(\\epsilon^3)\n$$\n其中 $F_1, F_2, G_1, G_2$ 仅是 $R$ 的函数，不依赖于快相 $\\Theta$。\n\n首先，我们通过对变换关于时间 $t$ 求导，用新变量表示 $\\dot{r}$ 和 $\\dot{\\theta}$：\n$$\n\\dot{r} = \\frac{\\partial r}{\\partial R}\\dot{R} + \\frac{\\partial r}{\\partial \\Theta}\\dot{\\Theta} = (1 + \\epsilon \\frac{\\partial u_1}{\\partial R})\\dot{R} + (\\epsilon \\frac{\\partial u_1}{\\partial \\Theta})\\dot{\\Theta} + \\mathcal{O}(\\epsilon^2) \\\\\n\\dot{\\theta} = \\frac{\\partial \\theta}{\\partial R}\\dot{R} + \\frac{\\partial \\theta}{\\partial \\Theta}\\dot{\\Theta} = (\\epsilon \\frac{\\partial a_1}{\\partial R})\\dot{R} + (1 + \\epsilon \\frac{\\partial a_1}{\\partial \\Theta})\\dot{\\Theta} + \\mathcal{O}(\\epsilon^2)\n$$\n代入 $\\dot{R}$ 和 $\\dot{\\Theta}$ 的展开式：\n$$\n\\dot{r} = (1 + \\mathcal{O}(\\epsilon))(\\epsilon F_1 + \\epsilon^2 F_2) + (\\epsilon \\frac{\\partial u_1}{\\partial \\Theta})(\\omega + \\epsilon G_1) + \\mathcal{O}(\\epsilon^3) \\\\\n\\dot{r} = \\epsilon F_1 + \\epsilon \\omega \\frac{\\partial u_1}{\\partial \\Theta} + \\epsilon^2 \\left(F_2 + \\frac{\\partial u_1}{\\partial R} F_1 + \\frac{\\partial u_1}{\\partial \\Theta} G_1 + \\omega \\frac{\\partial u_2}{\\partial \\Theta}\\right) + \\mathcal{O}(\\epsilon^3)\n$$\n$$\n\\dot{\\theta} = (\\mathcal{O}(\\epsilon))(\\mathcal{O}(\\epsilon)) + (1 + \\epsilon \\frac{\\partial a_1}{\\partial \\Theta})(\\omega + \\epsilon G_1 + \\epsilon^2 G_2) + \\mathcal{O}(\\epsilon^3) \\\\\n\\dot{\\theta} = \\omega + \\epsilon (G_1 + \\omega \\frac{\\partial a_1}{\\partial \\Theta}) + \\epsilon^2 \\left(G_2 + \\frac{\\partial a_1}{\\partial \\Theta} G_1 + \\omega \\frac{\\partial a_2}{\\partial \\Theta}\\right) + \\mathcal{O}(\\epsilon^3)\n$$\n注意，涉及 $\\frac{\\partial u_2}{\\partial R}$ 和 $\\frac{\\partial a_2}{\\partial R}$ 并与 $\\dot{R}$ 相乘的项是 $\\mathcal{O}(\\epsilon^3)$。对于 $\\dot{r}$ 的展开，$\\omega \\frac{\\partial u_2}{\\partial \\Theta}$ 项来自变换的 $u_2$ 部分。对 $\\dot{r}$ 更仔细地展开到 $\\mathcal{O}(\\epsilon^2)$ 阶为：\n$\\dot{r} = \\frac{d}{dt}(R+\\epsilon u_1+\\epsilon^2 u_2) = \\dot{R} + \\epsilon(\\frac{\\partial u_1}{\\partial R}\\dot{R} + \\frac{\\partial u_1}{\\partial \\Theta}\\dot{\\Theta}) + \\epsilon^2(\\frac{\\partial u_2}{\\partial R}\\dot{R} + \\frac{\\partial u_2}{\\partial \\Theta}\\dot{\\Theta}) + \\dots$\n$=(\\epsilon F_1+\\epsilon^2 F_2) + \\epsilon(\\frac{\\partial u_1}{\\partial R}\\epsilon F_1 + \\frac{\\partial u_1}{\\partial \\Theta}(\\omega+\\epsilon G_1)) + \\epsilon^2(\\frac{\\partial u_2}{\\partial \\Theta}\\omega) + \\mathcal{O}(\\epsilon^3)$\n$= \\epsilon F_1 + \\epsilon \\omega \\frac{\\partial u_1}{\\partial \\Theta} + \\epsilon^2(F_2 + \\frac{\\partial u_1}{\\partial R}F_1 + \\frac{\\partial u_1}{\\partial \\Theta}G_1 + \\omega \\frac{\\partial u_2}{\\partial \\Theta}) + \\mathcal{O}(\\epsilon^3)$。表达式是正确的。\n\n接下来，我们在 $(R, \\Theta)$ 周围将原始系统右侧（RHS）按 $\\epsilon$ 的幂次展开：\n对于 $\\dot{r}$：\n$$\n\\epsilon(\\alpha r + \\beta r \\cos\\theta) = \\epsilon[\\alpha(R+\\epsilon u_1) + \\beta(R+\\epsilon u_1)\\cos(\\Theta+\\epsilon a_1)] + \\mathcal{O}(\\epsilon^3) \\\\\n= \\epsilon[\\alpha R + \\epsilon \\alpha u_1 + \\beta R(\\cos\\Theta - \\epsilon a_1 \\sin\\Theta) + \\epsilon \\beta u_1 \\cos\\Theta] + \\mathcal{O}(\\epsilon^3) \\\\\n= \\epsilon(\\alpha R + \\beta R \\cos\\Theta) + \\epsilon^2(\\alpha u_1 + \\beta u_1 \\cos\\Theta - \\beta R a_1 \\sin\\Theta) + \\mathcal{O}(\\epsilon^3)\n$$\n对于 $\\dot{\\theta}$：\n$$\n\\omega + \\epsilon\\gamma\\sin\\theta = \\omega + \\epsilon\\gamma\\sin(\\Theta+\\epsilon a_1) + \\mathcal{O}(\\epsilon^3) \\\\\n= \\omega + \\epsilon\\gamma(\\sin\\Theta + \\epsilon a_1 \\cos\\Theta) + \\mathcal{O}(\\epsilon^3) \\\\\n= \\omega + \\epsilon\\gamma\\sin\\Theta + \\epsilon^2 \\gamma a_1 \\cos\\Theta + \\mathcal{O}(\\epsilon^3)\n$$\n\n现在我们匹配 $\\epsilon$ 幂次的系数。\n**$\\epsilon$ 阶方程：**\n通过比较 $\\mathcal{O}(\\epsilon)$ 项，我们得到：\n对于 $r$: $F_1 + \\omega \\frac{\\partial u_1}{\\partial \\Theta} = \\alpha R + \\beta R \\cos\\Theta$\n对于 $\\theta$: $G_1 + \\omega \\frac{\\partial a_1}{\\partial \\Theta} = \\gamma \\sin\\Theta$\n\n为了找到平均方程，我们将这些方程在一个周期 $[0, 2\\pi]$ 上对 $\\Theta$ 取平均。函数 $f(\\Theta)$ 的平均值为 $\\langle f \\rangle = \\frac{1}{2\\pi}\\int_0^{2\\pi} f(\\Theta) d\\Theta$。由于要求 $u_1$ 和 $a_1$ 是周期的，我们有 $\\langle \\frac{\\partial u_1}{\\partial \\Theta} \\rangle = 0$ 和 $\\langle \\frac{\\partial a_1}{\\partial \\Theta} \\rangle = 0$。$F_1$ 和 $G_1$ 与 $\\Theta$ 无关，因此 $\\langle F_1 \\rangle = F_1$ 且 $\\langle G_1 \\rangle = G_1$。\n$$\nF_1 = \\langle \\alpha R + \\beta R \\cos\\Theta \\rangle = \\alpha R + \\beta R \\langle \\cos\\Theta \\rangle = \\alpha R \\\\\nG_1 = \\langle \\gamma \\sin\\Theta \\rangle = \\gamma \\langle \\sin\\Theta \\rangle = 0\n$$\n现在我们求振荡部分 $u_1$ 和 $a_1$。\n$$\n\\omega \\frac{\\partial u_1}{\\partial \\Theta} = (\\alpha R + \\beta R \\cos\\Theta) - F_1 = \\beta R \\cos\\Theta \\implies u_1(R, \\Theta) = \\frac{\\beta R}{\\omega} \\sin\\Theta \\\\\n\\omega \\frac{\\partial a_1}{\\partial \\Theta} = \\gamma \\sin\\Theta - G_1 = \\gamma \\sin\\Theta \\implies a_1(R, \\Theta) = -\\frac{\\gamma}{\\omega} \\cos\\Theta\n$$\n我们选择积分常数为零，以确保 $\\langle u_1 \\rangle = 0$ 和 $\\langle a_1 \\rangle = 0$。\n\n**$\\epsilon^2$ 阶方程：**\n通过比较 $\\mathcal{O}(\\epsilon^2)$ 项，我们得到：\n对于 $r$: $F_2 + \\frac{\\partial u_1}{\\partial R}F_1 + \\frac{\\partial u_1}{\\partial \\Theta}G_1 + \\omega \\frac{\\partial u_2}{\\partial \\Theta} = \\alpha u_1 + \\beta u_1 \\cos\\Theta - \\beta R a_1 \\sin\\Theta$\n对于 $\\theta$: $G_2 + \\frac{\\partial a_1}{\\partial \\Theta}G_1 + \\omega \\frac{\\partial a_2}{\\partial \\Theta} = \\gamma a_1 \\cos\\Theta$ (由于 $\\frac{\\partial a_1}{\\partial R}=0$，项 $\\frac{\\partial a_1}{\\partial R}F_1$ 不存在)。\n\n我们通过重新整理并对 $r$ 的方程取平均来求 $F_2$：\n$$\n\\omega \\frac{\\partial u_2}{\\partial \\Theta} + F_2 = \\alpha u_1 + \\beta u_1 \\cos\\Theta - \\beta R a_1 \\sin\\Theta - \\frac{\\partial u_1}{\\partial R}F_1 - \\frac{\\partial u_1}{\\partial \\Theta}G_1\n$$\n对 $\\Theta$ 取平均得到 $F_2$：\n$$\nF_2 = \\left\\langle \\alpha u_1 + \\beta u_1 \\cos\\Theta - \\beta R a_1 \\sin\\Theta - \\frac{\\partial u_1}{\\partial R}F_1 - \\frac{\\partial u_1}{\\partial \\Theta}G_1 \\right\\rangle\n$$\n代入已知表达式：\n$F_1 = \\alpha R$, $G_1 = 0$, $u_1 = \\frac{\\beta R}{\\omega} \\sin\\Theta$, $a_1 = -\\frac{\\gamma}{\\omega} \\cos\\Theta$。以及 $\\frac{\\partial u_1}{\\partial R} = \\frac{\\beta}{\\omega} \\sin\\Theta$。\n$$\nF_2 = \\left\\langle \\alpha \\left(\\frac{\\beta R}{\\omega} \\sin\\Theta\\right) + \\beta \\left(\\frac{\\beta R}{\\omega} \\sin\\Theta\\right) \\cos\\Theta - \\beta R \\left(-\\frac{\\gamma}{\\omega} \\cos\\Theta\\right) \\sin\\Theta - \\left(\\frac{\\beta}{\\omega} \\sin\\Theta\\right)(\\alpha R) - 0 \\right\\rangle\n$$\n$$\nF_2 = \\left\\langle \\frac{\\alpha\\beta R}{\\omega}\\sin\\Theta + \\frac{\\beta^2 R}{\\omega}\\sin\\Theta\\cos\\Theta + \\frac{\\beta\\gamma R}{\\omega}\\sin\\Theta\\cos\\Theta - \\frac{\\alpha\\beta R}{\\omega}\\sin\\Theta \\right\\rangle\n$$\n$$\nF_2 = \\left\\langle \\frac{\\beta(\\beta+\\gamma)R}{\\omega}\\sin\\Theta\\cos\\Theta \\right\\rangle = \\frac{\\beta(\\beta+\\gamma)R}{2\\omega} \\langle \\sin(2\\Theta) \\rangle\n$$\n由于 $\\langle\\sin(2\\Theta)\\rangle=0$，我们发现 $F_2 = 0$。\n\n现在我们通过重新整理并对 $\\theta$ 的方程取平均来求 $G_2$：\n$$\n\\omega \\frac{\\partial a_2}{\\partial \\Theta} + G_2 = \\gamma a_1 \\cos\\Theta - \\frac{\\partial a_1}{\\partial \\Theta}G_1\n$$\n由于 $G_1 = 0$，最后一项消失了。\n$$\n\\omega \\frac{\\partial a_2}{\\partial \\Theta} + G_2 = \\gamma a_1 \\cos\\Theta\n$$\n对 $\\Theta$ 取平均得到 $G_2$：\n$$\nG_2 = \\langle \\gamma a_1 \\cos\\Theta \\rangle\n$$\n代入 $a_1 = -\\frac{\\gamma}{\\omega} \\cos\\Theta$：\n$$\nG_2 = \\left\\langle \\gamma \\left(-\\frac{\\gamma}{\\omega} \\cos\\Theta\\right) \\cos\\Theta \\right\\rangle = -\\frac{\\gamma^2}{\\omega} \\langle \\cos^2\\Theta \\rangle\n$$\n使用恒等式 $\\langle\\cos^2\\Theta\\rangle = \\frac{1}{2}$：\n$$\nG_2 = -\\frac{\\gamma^2}{2\\omega}\n$$\n\n**组装平均系统：**\n我们已经找到了平均系统直至 $\\epsilon^2$ 阶的系数：\n- $F_1 = \\alpha R$, $F_2 = 0$\n- $G_1 = 0$, $G_2 = -\\frac{\\gamma^2}{2\\omega}$\n\n因此，平均系统为：\n$$\n\\dot{R} = \\epsilon F_1 + \\epsilon^2 F_2 + \\mathcal{O}(\\epsilon^3) = \\epsilon \\alpha R + \\mathcal{O}(\\epsilon^3)\n$$\n$$\n\\dot{\\Theta} = \\omega + \\epsilon G_1 + \\epsilon^2 G_2 + \\mathcal{O}(\\epsilon^3) = \\omega - \\epsilon^2 \\frac{\\gamma^2}{2\\omega} + \\mathcal{O}(\\epsilon^3)\n$$\n平均系统右侧的表达式，精确到并包括 $\\epsilon^2$ 阶项，为：\n对于 $\\dot{R}$：$\\epsilon \\alpha R$\n对于 $\\dot{\\Theta}$：$\\omega - \\frac{\\epsilon^2 \\gamma^2}{2\\omega}$\n\n最终答案是这两个表达式的组合。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\epsilon \\alpha R & \\omega - \\frac{\\epsilon^2 \\gamma^2}{2\\omega} \\end{pmatrix} } $$"
        },
        {
            "introduction": "平均法不仅是抽象的数学工具，它在分析现实物理系统中也扮演着核心角色。本练习将平均法应用于著名的参量激励杜芬 (Duffing) 振子，这是非线性动力学中的一个基石模型。通过此练习，你将学会如何推导振子慢变振幅和相位的演化方程，从而揭示参数共振等关键物理现象的内在机制，并掌握在物理学和工程学中广泛应用的复振幅方法 。",
            "id": "3734768",
            "problem": "考虑一个带有小的周期性参量激励的无量纲杜芬 (Duffing) 振子，\n$$\n\\ddot{x} + x + \\varepsilon\\left(\\delta\\,x + \\beta\\,x^{3} + \\gamma \\cos(2 t)\\,x\\right) = 0,\n$$\n其中 $x(t)$ 是位移，$t$ 是快时间，$\\varepsilon$ 满足 $0 < \\varepsilon \\ll 1$，$\\delta$、$\\beta$、$\\gamma$ 是固定的实数参数。项 $\\gamma \\cos(2 t)\\,x$ 表示频率为 $2$ 的小参量激励，该频率接近线性振子的主参量共振频率。引入慢时间 $T=\\varepsilon t$，并通过与范式理论意义上消除非共振谐波一致的近恒等变换执行平均化。将解用缓变复振幅 $a(T)$ 表示为\n$$\nx(t) = a(T)\\exp(i t) + \\overline{a(T)}\\exp(-i t),\n$$\n然后通过 $a(T) = \\frac{R(T)}{2}\\exp\\big(i\\theta(T)\\big)$ 引入极坐标变量，其中 $R(T)>0$ 是慢振幅，$\\theta(T)$ 是慢相位。在 $\\varepsilon$ 的一阶上进行一致的计算，并且仅假设快慢系统的平均法和近恒等变换的基本定义，推导出平均化慢动力学。作为最终答案，报告出现在慢振幅方程 $R'(T) = F(R,\\theta)$ 中的平均漂移项 $F(R,\\theta)$ 的单个闭式表达式，其中撇号表示 $\\frac{d}{dT}$。只需提供表达式 $F(R,\\theta)$（不要写出方程），并且不要引入除上述声明之外的任何额外假设。无需四舍五入，不涉及单位。将所有中间和最终公式用 LaTeX 表示。",
            "solution": "该问题要求推导一个参量激励杜芬振子振幅的平均慢流方程。该系统由以下二阶常微分方程描述：\n$$\n\\ddot{x} + x + \\varepsilon\\left(\\delta\\,x + \\beta\\,x^{3} + \\gamma \\cos(2 t)\\,x\\right) = 0\n$$\n其中 $0 < \\varepsilon \\ll 1$。给定快时间 $t$ 和慢时间 $T = \\varepsilon t$。解的形式为 $x(t) = a(T)\\exp(i t) + \\overline{a(T)}\\exp(-i t)$，其中 $a(T)$ 是一个缓变复振幅。\n\n我们将使用多尺度法。我们形式上将 $t$ 和 $T$ 视为独立变量，并将解按 $\\varepsilon$ 的幂次展开：\n$$\nx(t) = x_0(t, T) + \\varepsilon x_1(t, T) + \\mathcal{O}(\\varepsilon^2)\n$$\n时间导数变换如下：\n$$\n\\frac{d}{dt} = \\frac{\\partial}{\\partial t} + \\varepsilon \\frac{\\partial}{\\partial T}\n$$\n$$\n\\frac{d^2}{dt^2} = \\left(\\frac{\\partial}{\\partial t} + \\varepsilon \\frac{\\partial}{\\partial T}\\right)^2 = \\frac{\\partial^2}{\\partial t^2} + 2\\varepsilon \\frac{\\partial^2}{\\partial t \\partial T} + \\varepsilon^2 \\frac{\\partial^2}{\\partial T^2}\n$$\n将这些代入原方程，并按 $\\varepsilon$ 的幂次收集各项：\n\n在 $\\mathcal{O}(\\varepsilon^0)$ 阶：\n$$\n\\frac{\\partial^2 x_0}{\\partial t^2} + x_0 = 0\n$$\n该方程的通解为：\n$$\nx_0(t, T) = a(T)\\exp(i t) + \\overline{a(T)}\\exp(-i t)\n$$\n这与问题陈述中给出的形式相符。这里，$a(T)$ 是慢时间 $T$ 的一个任意函数，将在下一阶确定。\n\n在 $\\mathcal{O}(\\varepsilon^1)$ 阶：\n$$\n\\frac{\\partial^2 x_1}{\\partial t^2} + x_1 = -2\\frac{\\partial^2 x_0}{\\partial t \\partial T} - \\left(\\delta\\,x_0 + \\beta\\,x_0^{3} + \\gamma \\cos(2 t)\\,x_0\\right)\n$$\n这是一个关于 $x_1$ 的受迫线性振子方程。为确保展开式的一致有效性，我们必须消除右侧的久期项（在 $t$ 上无界增长的项）。久期项源于与齐次算子的自然频率共振的策动项，即与 $\\exp(it)$ 或 $\\exp(-it)$ 成比例的项。\n\n首先，我们计算包含混合偏导数的项：\n$$\n\\frac{\\partial x_0}{\\partial t} = i a(T)\\exp(i t) - i \\overline{a(T)}\\exp(-i t)\n$$\n$$\n\\frac{\\partial^2 x_0}{\\partial t \\partial T} = i \\frac{da}{dT}\\exp(i t) - i \\frac{d\\overline{a}}{dT}\\exp(-i t) = i a'(T)\\exp(i t) - i \\overline{a'}(T)\\exp(-i t)\n$$\n所以，右侧的第一项是：\n$$\n-2\\frac{\\partial^2 x_0}{\\partial t \\partial T} = -2i a'(T)\\exp(i t) + 2i \\overline{a'}(T)\\exp(-i t)\n$$\n接下来，我们展开非线性和参量项，将 $a(T)$ 和 $\\overline{a(T)}$ 视为关于快时间 $t$ 的常数，并找出共振分量。\n\n1.  项 $\\delta x_0$：\n    $$\n    \\delta x_0 = \\delta \\left(a\\exp(it) + \\overline{a}\\exp(-it)\\right)\n    $$\n    与 $\\exp(it)$ 成比例的项是 $\\delta a\\exp(it)$。\n\n2.  项 $\\beta x_0^3$：\n    $$\n    x_0^3 = \\left(a\\exp(it) + \\overline{a}\\exp(-it)\\right)^3 = a^3\\exp(3it) + 3a^2\\overline{a}\\exp(it) + 3a\\overline{a}^2\\exp(-it) + \\overline{a}^3\\exp(-3it)\n    $$\n    与 $\\exp(it)$ 成比例的项是 $3\\beta |a|^2 a \\exp(it)$。\n\n3.  项 $\\gamma \\cos(2t) x_0$：\n    我们使用 $\\cos(2t) = \\frac{1}{2}(\\exp(2it) + \\exp(-2it))$。\n    $$\n    \\gamma \\cos(2t) x_0 = \\frac{\\gamma}{2}\\left(\\exp(2it) + \\exp(-2it)\\right)\\left(a\\exp(it) + \\overline{a}\\exp(-it)\\right)\n    $$\n    $$\n    = \\frac{\\gamma}{2}\\left(a\\exp(3it) + \\overline{a}\\exp(it) + a\\exp(-it) + \\overline{a}\\exp(-3it)\\right)\n    $$\n    与 $\\exp(it)$ 成比例的项是 $\\frac{\\gamma}{2}\\overline{a}\\exp(it)$。\n\n可解性条件要求 $x_1$ 方程右侧所有 $\\exp(it)$ 的系数之和必须为零。\n$$\n-2i a'(T) - \\delta a(T) - 3\\beta a(T)|a(T)|^2 - \\frac{\\gamma}{2}\\overline{a(T)} = 0\n$$\n解出 $a'(T)$：\n$$\n-2i a'(T) = \\delta a + 3\\beta a|a|^2 + \\frac{\\gamma}{2}\\overline{a}\n$$\n$$\na'(T) = \\frac{i}{2}\\left(\\delta a + 3\\beta a|a|^2 + \\frac{\\gamma}{2}\\overline{a}\\right)\n$$\n这就是复振幅 $a(T)$ 的平均方程。\n\n现在，我们引入极坐标表示 $a(T) = \\frac{R(T)}{2}\\exp(i\\theta(T))$。我们需要找到 $R'(T)$ 的方程。我们对 $a(T)$ 关于 $T$ 求导：\n$$\na'(T) = \\frac{R'(T)}{2}\\exp(i\\theta(T)) + i\\frac{R(T)\\theta'(T)}{2}\\exp(i\\theta(T)) = \\left(\\frac{R'}{2} + i\\frac{R\\theta'}{2}\\right)\\exp(i\\theta)\n$$\n我们将极坐标形式代入 $a'(T)$ 的平均方程中：\n$$\na'(T) = \\frac{i}{2}\\left[\\delta \\frac{R}{2}\\exp(i\\theta) + 3\\beta \\left(\\frac{R}{2}\\right)^3\\exp(i\\theta) + \\frac{\\gamma}{2}\\frac{R}{2}\\exp(-i\\theta)\\right]\n$$\n$$\na'(T) = \\frac{i}{2}\\left[\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8}\\right)\\exp(i\\theta) + \\frac{\\gamma R}{4}\\exp(-i\\theta)\\right]\n$$\n令两个 $a'(T)$ 的表达式相等：\n$$\n\\left(\\frac{R'}{2} + i\\frac{R\\theta'}{2}\\right)\\exp(i\\theta) = \\frac{i}{2}\\left[\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8}\\right)\\exp(i\\theta) + \\frac{\\gamma R}{4}\\exp(-i\\theta)\\right]\n$$\n两边同乘以 $2\\exp(-i\\theta)$：\n$$\nR' + iR\\theta' = i\\left[\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8}\\right) + \\frac{\\gamma R}{4}\\exp(-2i\\theta)\\right]\n$$\n现在，展开 $\\exp(-2i\\theta) = \\cos(2\\theta) - i\\sin(2\\theta)$：\n$$\nR' + iR\\theta' = i\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8} + \\frac{\\gamma R}{4}\\cos(2\\theta)\\right) - i^2\\frac{\\gamma R}{4}\\sin(2\\theta)\n$$\n$$\nR' + iR\\theta' = \\frac{\\gamma R}{4}\\sin(2\\theta) + i\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8} + \\frac{\\gamma R}{4}\\cos(2\\theta)\\right)\n$$\n令实部和虚部分别相等，得到 $R(T)$ 和 $\\theta(T)$ 的平均方程：\n$$\nR'(T) = \\frac{\\gamma R}{4}\\sin(2\\theta)\n$$\n$$\nR\\theta'(T) = \\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8} + \\frac{\\gamma R}{4}\\cos(2\\theta)\n$$\n问题要求给出方程 $R'(T) = F(R, \\theta)$ 中的表达式 $F(R, \\theta)$。根据我们的推导，这个表达式是：\n$$\nF(R, \\theta) = \\frac{\\gamma R}{4}\\sin(2\\theta)\n$$\n这个结果在物理上是一致的，因为振幅动力学（能量注入或耗散）由参量激励项 $\\gamma$ 及其与振子的相位关系 $2\\theta$ 控制，而失谐项 $\\delta$ 和非线性项 $\\beta$ 主要影响振荡频率，这体现在 $\\theta'$ 中。\n\n最终表达式为 $\\frac{\\gamma R}{4}\\sin(2\\theta)$。",
            "answer": "$$\\boxed{\\frac{\\gamma R}{4}\\sin(2\\theta)}$$"
        }
    ]
}