{
    "hands_on_practices": [
        {
            "introduction": "这项练习是深入理解平均法的基础。虽然一阶平均能够捕捉主要的漂移项，但高阶项往往揭示了微小而重要的物理效应，例如非线性频移。通过从第一性原理推导截至二阶的平均动力学 ，你将练习如何系统地应用近恒等变换，并熟练掌握微扰理论的核心技巧。",
            "id": "3734761",
            "problem": "考虑一个关于径向振幅 $r(t)$ 和快相 $\\theta(t)$ 的二维自治动力系统，\n$$\n\\dot{r} \\;=\\; \\epsilon\\,\\alpha\\,r \\;+\\; \\epsilon\\,\\beta\\,r\\,\\cos\\theta, \n\\qquad\n\\dot{\\theta} \\;=\\; \\omega \\;+\\; \\epsilon\\,\\gamma\\,\\sin\\theta,\n$$\n其中 $\\epsilon  0$ 是一个小参数，$\\omega\\neq 0$ 是一个恒定的快频率，$\\alpha,\\beta,\\gamma$ 是有界常数。所有角度均以弧度为单位。目标是推导慢振幅 $R(t)$ 和修正快相 $\\Theta(t)$ 的平均动力学，结果需精确到 $\\epsilon^2$ 阶项（含 $\\epsilon^2$ 阶项）。\n\n从快慢系统的平均法第一性原理出发：快相 $\\,\\theta\\,$ 在 $\\cos\\theta$ 和 $\\sin\\theta$ 等项中产生 $\\mathcal{O}(1)$ 阶的振荡，而平均（有效）慢动力学是通过使用一个在快相上周期性的近恒等变量变换，在快运动的一个周期内消除对快相的主要振荡依赖性来获得的。通过引入一个消除 $\\mathcal{O}(\\epsilon)$ 阶振荡项的近恒等变换来系统地进行推导，然后计算 $\\mathcal{O}(\\epsilon^2)$ 阶的剩余平均漂移。\n\n假设系统具有足够的光滑性，以保证所有展开和平均都是合理的，并将所有常数保持为符号形式。不要使用任何现成的快捷公式。推导 $(R,\\Theta)$ 的平均系统，其右侧表达式应精确到 $\\epsilon^2$ 阶项（含 $\\epsilon^2$ 阶项）。\n\n将平均系统 $(\\dot{R},\\dot{\\Theta})$ 的右侧表达式对作为最终答案，表示为 $(\\dot{R},\\dot{\\Theta})$ 顺序的双元素行矩阵。无需进行数值舍入。",
            "solution": "用户希望我解决这个问题。\n\n### 第 1 步：提取已知条件\n问题陈述提供了以下信息：\n- 一个关于径向振幅 $r(t)$ 和快相 $\\theta(t)$ 的二维自治动力系统：\n$$\n\\dot{r} \\;=\\; \\epsilon\\,\\alpha\\,r \\;+\\; \\epsilon\\,\\beta\\,r\\,\\cos\\theta \\\\\n\\dot{\\theta} \\;=\\; \\omega \\;+\\; \\epsilon\\,\\gamma\\,\\sin\\theta\n$$\n- 参数和变量：\n  - $\\epsilon > 0$ 是一个小参数。\n  - $\\omega \\neq 0$ 是一个恒定的快频率。\n  - $\\alpha, \\beta, \\gamma$ 是有界常数。\n  - $r(t)$ 是径向振幅。\n  - $\\theta(t)$ 是快相，以弧度为单位。\n- 目标是推导慢振幅 $R(t)$ 和修正快相 $\\Theta(t)$ 的平均动力学，结果需精确到 $\\epsilon^2$ 阶项（含 $\\epsilon^2$ 阶项）。\n- 推导必须从平均法的第一性原理出发，使用近恒等变量变换。\n- 禁止使用快捷公式。\n- $(\\dot{R}, \\dot{\\Theta})$ 的平均系统应精确到 $\\mathcal{O}(\\epsilon^2)$。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了一个标准的快慢动力系统，常用于为具有慢振幅和频率调制的振荡器建模。通过近恒等变换进行平均的方法是动力系统摄动理论的基石。该问题牢固地植根于既定的数学物理原理。\n2.  **适定性**：该问题是适定的。给出了方程，定义了参数，任务是应用一个标准的、明确定义的数学程序来推导结果。条件 $\\omega \\neq 0$ 确保了涉及除以 $\\omega$ 的平均过程是明确定义的。\n3.  **客观性**：该问题以精确的数学语言陈述，没有任何主观或模棱两可的术语。\n\n### 第 3 步：结论与行动\n该问题是有效的。它是动力系统理论中一个标准的、适定的问题。我将继续进行求解。\n\n问题要求从第一性原理出发，推导一个精确到 $\\epsilon^2$ 阶的平均系统。我们被给定了快慢系统：\n$$\n\\dot{r} = \\epsilon(\\alpha r + \\beta r \\cos\\theta) \\\\\n\\dot{\\theta} = \\omega + \\epsilon \\gamma \\sin\\theta\n$$\n此处，$\\theta$ 是快变量，因为 $\\dot{\\theta} = \\mathcal{O}(1)$，而 $r$ 是慢变量，因为 $\\dot{r} = \\mathcal{O}(\\epsilon)$。\n\n我们引入一个到新变量的近恒等变换，即一个由平均方程控制的慢振幅 $R(t)$ 和一个快相 $\\Theta(t)$。该变换被定义为 $\\epsilon$ 的级数展开：\n$$\nr(t) = R(t) + \\epsilon u_1(R, \\Theta) + \\epsilon^2 u_2(R, \\Theta) + \\mathcal{O}(\\epsilon^3) \\\\\n\\theta(t) = \\Theta(t) + \\epsilon a_1(R, \\Theta) + \\epsilon^2 a_2(R, \\Theta) + \\mathcal{O}(\\epsilon^3)\n$$\n函数 $u_1, u_2, a_1, a_2$ 被选为 $\\Theta$ 的周期函数且均值为零，以吸收振荡动力学。$R$ 和 $\\Theta$ 的平均系统将具有以下形式：\n$$\n\\dot{R} = \\epsilon F_1(R) + \\epsilon^2 F_2(R) + \\mathcal{O}(\\epsilon^3) \\\\\n\\dot{\\Theta} = \\omega + \\epsilon G_1(R) + \\epsilon^2 G_2(R) + \\mathcal{O}(\\epsilon^3)\n$$\n其中 $F_1, F_2, G_1, G_2$ 仅是 $R$ 的函数，不依赖于快相 $\\Theta$。\n\n首先，我们通过对变换关于时间 $t$ 求导，用新变量表示 $\\dot{r}$ 和 $\\dot{\\theta}$：\n$$\n\\dot{r} = \\frac{\\partial r}{\\partial R}\\dot{R} + \\frac{\\partial r}{\\partial \\Theta}\\dot{\\Theta} = (1 + \\epsilon \\frac{\\partial u_1}{\\partial R})\\dot{R} + (\\epsilon \\frac{\\partial u_1}{\\partial \\Theta})\\dot{\\Theta} + \\mathcal{O}(\\epsilon^2) \\\\\n\\dot{\\theta} = \\frac{\\partial \\theta}{\\partial R}\\dot{R} + \\frac{\\partial \\theta}{\\partial \\Theta}\\dot{\\Theta} = (\\epsilon \\frac{\\partial a_1}{\\partial R})\\dot{R} + (1 + \\epsilon \\frac{\\partial a_1}{\\partial \\Theta})\\dot{\\Theta} + \\mathcal{O}(\\epsilon^2)\n$$\n代入 $\\dot{R}$ 和 $\\dot{\\Theta}$ 的展开式：\n$$\n\\dot{r} = (1 + \\mathcal{O}(\\epsilon))(\\epsilon F_1 + \\epsilon^2 F_2) + (\\epsilon \\frac{\\partial u_1}{\\partial \\Theta})(\\omega + \\epsilon G_1) + \\mathcal{O}(\\epsilon^3) \\\\\n\\dot{r} = \\epsilon F_1 + \\epsilon \\omega \\frac{\\partial u_1}{\\partial \\Theta} + \\epsilon^2 \\left(F_2 + \\frac{\\partial u_1}{\\partial R} F_1 + \\frac{\\partial u_1}{\\partial \\Theta} G_1 + \\omega \\frac{\\partial u_2}{\\partial \\Theta}\\right) + \\mathcal{O}(\\epsilon^3)\n$$\n$$\n\\dot{\\theta} = (\\mathcal{O}(\\epsilon))(\\mathcal{O}(\\epsilon)) + (1 + \\epsilon \\frac{\\partial a_1}{\\partial \\Theta})(\\omega + \\epsilon G_1 + \\epsilon^2 G_2) + \\mathcal{O}(\\epsilon^3) \\\\\n\\dot{\\theta} = \\omega + \\epsilon (G_1 + \\omega \\frac{\\partial a_1}{\\partial \\Theta}) + \\epsilon^2 \\left(G_2 + \\frac{\\partial a_1}{\\partial \\Theta} G_1 + \\omega \\frac{\\partial a_2}{\\partial \\Theta}\\right) + \\mathcal{O}(\\epsilon^3)\n$$\n注意，包含 $\\frac{\\partial u_2}{\\partial R}$ 和 $\\frac{\\partial a_2}{\\partial R}$ 并与 $\\dot{R}$ 相乘的项是 $\\mathcal{O}(\\epsilon^3)$ 阶的。对于 $\\dot{r}$ 的展开式，项 $\\omega \\frac{\\partial u_2}{\\partial \\Theta}$ 来自变换的 $u_2$ 部分。一个更仔细的 $\\dot{r}$ 到 $\\mathcal{O}(\\epsilon^2)$ 阶的展开是：\n$\\dot{r} = \\frac{d}{dt}(R+\\epsilon u_1+\\epsilon^2 u_2) = \\dot{R} + \\epsilon(\\frac{\\partial u_1}{\\partial R}\\dot{R} + \\frac{\\partial u_1}{\\partial \\Theta}\\dot{\\Theta}) + \\epsilon^2(\\frac{\\partial u_2}{\\partial R}\\dot{R} + \\frac{\\partial u_2}{\\partial \\Theta}\\dot{\\Theta}) + \\dots$\n$=(\\epsilon F_1+\\epsilon^2 F_2) + \\epsilon(\\frac{\\partial u_1}{\\partial R}\\epsilon F_1 + \\frac{\\partial u_1}{\\partial \\Theta}(\\omega+\\epsilon G_1)) + \\epsilon^2(\\frac{\\partial u_2}{\\partial \\Theta}\\omega) + \\mathcal{O}(\\epsilon^3)$\n$= \\epsilon F_1 + \\epsilon \\omega \\frac{\\partial u_1}{\\partial \\Theta} + \\epsilon^2(F_2 + \\frac{\\partial u_1}{\\partial R}F_1 + \\frac{\\partial u_1}{\\partial \\Theta}G_1 + \\omega \\frac{\\partial u_2}{\\partial \\Theta}) + \\mathcal{O}(\\epsilon^3)$。表达式是正确的。\n\n接下来，我们在 $(R, \\Theta)$ 周围将原系统的右侧 (RHS) 展开为 $\\epsilon$ 的幂级数：\n对 $\\dot{r}$：\n$$\n\\epsilon(\\alpha r + \\beta r \\cos\\theta) = \\epsilon[\\alpha(R+\\epsilon u_1) + \\beta(R+\\epsilon u_1)\\cos(\\Theta+\\epsilon a_1)] + \\mathcal{O}(\\epsilon^3) \\\\\n= \\epsilon[\\alpha R + \\epsilon \\alpha u_1 + \\beta R(\\cos\\Theta - \\epsilon a_1 \\sin\\Theta) + \\epsilon \\beta u_1 \\cos\\Theta] + \\mathcal{O}(\\epsilon^3) \\\\\n= \\epsilon(\\alpha R + \\beta R \\cos\\Theta) + \\epsilon^2(\\alpha u_1 + \\beta u_1 \\cos\\Theta - \\beta R a_1 \\sin\\Theta) + \\mathcal{O}(\\epsilon^3)\n$$\n对 $\\dot{\\theta}$：\n$$\n\\omega + \\epsilon\\gamma\\sin\\theta = \\omega + \\epsilon\\gamma\\sin(\\Theta+\\epsilon a_1) + \\mathcal{O}(\\epsilon^3) \\\\\n= \\omega + \\epsilon\\gamma(\\sin\\Theta + \\epsilon a_1 \\cos\\Theta) + \\mathcal{O}(\\epsilon^3) \\\\\n= \\omega + \\epsilon\\gamma\\sin\\Theta + \\epsilon^2 \\gamma a_1 \\cos\\Theta + \\mathcal{O}(\\epsilon^3)\n$$\n\n现在我们匹配 $\\epsilon$ 幂的系数。\n**$\\epsilon$ 阶方程：**\n通过比较 $\\mathcal{O}(\\epsilon)$ 阶项，我们得到：\n对 $r$：$F_1 + \\omega \\frac{\\partial u_1}{\\partial \\Theta} = \\alpha R + \\beta R \\cos\\Theta$\n对 $\\theta$：$G_1 + \\omega \\frac{\\partial a_1}{\\partial \\Theta} = \\gamma \\sin\\Theta$\n\n为了找到平均方程，我们对这些方程关于 $\\Theta$ 在一个周期 $[0, 2\\pi]$ 上取平均。函数 $f(\\Theta)$ 的平均值为 $\\langle f \\rangle = \\frac{1}{2\\pi}\\int_0^{2\\pi} f(\\Theta) d\\Theta$。由于 $u_1$ 和 $a_1$ 被要求是周期性的，我们有 $\\langle \\frac{\\partial u_1}{\\partial \\Theta} \\rangle = 0$ 和 $\\langle \\frac{\\partial a_1}{\\partial \\Theta} \\rangle = 0$。$F_1$ 和 $G_1$ 与 $\\Theta$ 无关，因此 $\\langle F_1 \\rangle = F_1$ 且 $\\langle G_1 \\rangle = G_1$。\n$$\nF_1 = \\langle \\alpha R + \\beta R \\cos\\Theta \\rangle = \\alpha R + \\beta R \\langle \\cos\\Theta \\rangle = \\alpha R \\\\\nG_1 = \\langle \\gamma \\sin\\Theta \\rangle = \\gamma \\langle \\sin\\Theta \\rangle = 0\n$$\n现在我们求振荡部分 $u_1$ 和 $a_1$。\n$$\n\\omega \\frac{\\partial u_1}{\\partial \\Theta} = (\\alpha R + \\beta R \\cos\\Theta) - F_1 = \\beta R \\cos\\Theta \\implies u_1(R, \\Theta) = \\frac{\\beta R}{\\omega} \\sin\\Theta \\\\\n\\omega \\frac{\\partial a_1}{\\partial \\Theta} = \\gamma \\sin\\Theta - G_1 = \\gamma \\sin\\Theta \\implies a_1(R, \\Theta) = -\\frac{\\gamma}{\\omega} \\cos\\Theta\n$$\n我们选择积分常数为零以确保 $\\langle u_1 \\rangle = 0$ 和 $\\langle a_1 \\rangle = 0$。\n\n**$\\epsilon^2$ 阶方程：**\n通过比较 $\\mathcal{O}(\\epsilon^2)$ 阶项，我们得到：\n对 $r$：$F_2 + \\frac{\\partial u_1}{\\partial R}F_1 + \\frac{\\partial u_1}{\\partial \\Theta}G_1 + \\omega \\frac{\\partial u_2}{\\partial \\Theta} = \\alpha u_1 + \\beta u_1 \\cos\\Theta - \\beta R a_1 \\sin\\Theta$\n对 $\\theta$：$G_2 + \\frac{\\partial a_1}{\\partial \\Theta}G_1 + \\omega \\frac{\\partial a_2}{\\partial \\Theta} = \\gamma a_1 \\cos\\Theta$（由于 $\\frac{\\partial a_1}{\\partial R}=0$，项 $\\frac{\\partial a_1}{\\partial R}F_1$ 不存在）。\n\n让我们通过重新排列并对 $r$ 的方程进行平均来求 $F_2$：\n$$\n\\omega \\frac{\\partial u_2}{\\partial \\Theta} + F_2 = \\alpha u_1 + \\beta u_1 \\cos\\Theta - \\beta R a_1 \\sin\\Theta - \\frac{\\partial u_1}{\\partial R}F_1 - \\frac{\\partial u_1}{\\partial \\Theta}G_1\n$$\n对 $\\Theta$ 取平均得到 $F_2$：\n$$\nF_2 = \\left\\langle \\alpha u_1 + \\beta u_1 \\cos\\Theta - \\beta R a_1 \\sin\\Theta - \\frac{\\partial u_1}{\\partial R}F_1 - \\frac{\\partial u_1}{\\partial \\Theta}G_1 \\right\\rangle\n$$\n代入已知表达式：\n$F_1 = \\alpha R$, $G_1 = 0$, $u_1 = \\frac{\\beta R}{\\omega} \\sin\\Theta$, $a_1 = -\\frac{\\gamma}{\\omega} \\cos\\Theta$。以及 $\\frac{\\partial u_1}{\\partial R} = \\frac{\\beta}{\\omega} \\sin\\Theta$。\n$$\nF_2 = \\left\\langle \\alpha \\left(\\frac{\\beta R}{\\omega} \\sin\\Theta\\right) + \\beta \\left(\\frac{\\beta R}{\\omega} \\sin\\Theta\\right) \\cos\\Theta - \\beta R \\left(-\\frac{\\gamma}{\\omega} \\cos\\Theta\\right) \\sin\\Theta - \\left(\\frac{\\beta}{\\omega} \\sin\\Theta\\right)(\\alpha R) - 0 \\right\\rangle\n$$\n$$\nF_2 = \\left\\langle \\frac{\\alpha\\beta R}{\\omega}\\sin\\Theta + \\frac{\\beta^2 R}{\\omega}\\sin\\Theta\\cos\\Theta + \\frac{\\beta\\gamma R}{\\omega}\\sin\\Theta\\cos\\Theta - \\frac{\\alpha\\beta R}{\\omega}\\sin\\Theta \\right\\rangle\n$$\n$$\nF_2 = \\left\\langle \\frac{\\beta(\\beta+\\gamma)R}{\\omega}\\sin\\Theta\\cos\\Theta \\right\\rangle = \\frac{\\beta(\\beta+\\gamma)R}{2\\omega} \\langle \\sin(2\\Theta) \\rangle\n$$\n由于 $\\langle\\sin(2\\Theta)\\rangle=0$，我们发现 $F_2 = 0$。\n\n现在让我们通过重新排列并对 $\\theta$ 的方程进行平均来求 $G_2$：\n$$\n\\omega \\frac{\\partial a_2}{\\partial \\Theta} + G_2 = \\gamma a_1 \\cos\\Theta - \\frac{\\partial a_1}{\\partial \\Theta}G_1\n$$\n由于 $G_1 = 0$，最后一项消失。\n$$\n\\omega \\frac{\\partial a_2}{\\partial \\Theta} + G_2 = \\gamma a_1 \\cos\\Theta\n$$\n对 $\\Theta$ 取平均得到 $G_2$：\n$$\nG_2 = \\langle \\gamma a_1 \\cos\\Theta \\rangle\n$$\n代入 $a_1 = -\\frac{\\gamma}{\\omega} \\cos\\Theta$：\n$$\nG_2 = \\left\\langle \\gamma \\left(-\\frac{\\gamma}{\\omega} \\cos\\Theta\\right) \\cos\\Theta \\right\\rangle = -\\frac{\\gamma^2}{\\omega} \\langle \\cos^2\\Theta \\rangle\n$$\n使用恒等式 $\\langle\\cos^2\\Theta\\rangle = \\frac{1}{2}$：\n$$\nG_2 = -\\frac{\\gamma^2}{2\\omega}\n$$\n\n**组合平均系统：**\n我们已经找到了平均系统直到 $\\epsilon^2$ 阶的系数：\n- $F_1 = \\alpha R$, $F_2 = 0$\n- $G_1 = 0$, $G_2 = -\\frac{\\gamma^2}{2\\omega}$\n\n因此，平均系统为：\n$$\n\\dot{R} = \\epsilon F_1 + \\epsilon^2 F_2 + \\mathcal{O}(\\epsilon^3) = \\epsilon \\alpha R + \\mathcal{O}(\\epsilon^3)\n$$\n$$\n\\dot{\\Theta} = \\omega + \\epsilon G_1 + \\epsilon^2 G_2 + \\mathcal{O}(\\epsilon^3) = \\omega - \\epsilon^2 \\frac{\\gamma^2}{2\\omega} + \\mathcal{O}(\\epsilon^3)\n$$\n平均系统右侧的表达式，精确到 $\\epsilon^2$ 阶项（含 $\\epsilon^2$ 阶项），为：\n对 $\\dot{R}$：$\\epsilon \\alpha R$\n对 $\\dot{\\Theta}$：$\\omega - \\frac{\\epsilon^2 \\gamma^2}{2\\omega}$\n\n最终答案是这两个表达式组成的对。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\epsilon \\alpha R,  \\omega - \\frac{\\epsilon^2 \\gamma^2}{2\\omega} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在掌握了核心计算之后，我们将把平均法应用于非线性动力学中的一个经典问题：参数驱动的 Duffing 振子 。这个练习展示了该方法如何帮助我们推导出简化的“慢变振幅方程”，这些方程控制着系统在共振点附近的能量和相位演化。掌握这种应用对于分析从机械振动到电子电路等各种现实世界中的振荡现象至关重要。",
            "id": "3734768",
            "problem": "考虑一个带有小的周期性参量策动的无量纲杜芬振子，\n$$\n\\ddot{x} + x + \\varepsilon\\left(\\delta\\,x + \\beta\\,x^{3} + \\gamma \\cos(2 t)\\,x\\right) = 0,\n$$\n其中 $x(t)$ 是位移，$t$ 是快时间，$\\varepsilon$ 满足 $0  \\varepsilon \\ll 1$，并且 $\\delta$、$\\beta$、$\\gamma$ 是固定的实参数。项 $\\gamma \\cos(2 t)\\,x$ 表示频率为 $2$ 的小参量调制，接近线性振子的主参量共振。引入慢时间 $T=\\varepsilon t$，并通过与范式理论意义上消除非共振谐波相一致的近恒等变换来进行平均。将解用慢变复振幅 $a(T)$ 表示为\n$$\nx(t) = a(T)\\exp(i t) + \\overline{a(T)}\\exp(-i t),\n$$\n然后通过 $a(T) = \\frac{R(T)}{2}\\exp\\big(i\\theta(T)\\big)$ 引入极坐标变量，其中 $R(T)0$ 是慢振幅，$\\theta(T)$ 是慢相位。在 $\\varepsilon$ 的一阶上进行一致性计算，并仅假设快慢系统的平均法和近恒等变换的基本定义，推导平均后的慢动力学。作为最终答案，报告出现在慢振幅方程 $R'(T) = F(R,\\theta)$ 中的平均漂移项 $F(R,\\theta)$ 的单个闭式表达式，其中撇号表示 $\\frac{d}{dT}$。只需提供表达式 $F(R,\\theta)$（不要写出方程），并且不要引入除上述声明之外的任何额外假设。不需要四舍五入，也不涉及单位。用 LaTeX 表示所有中间和最终公式。",
            "solution": "该问题要求推导参量策动杜芬振子振幅的平均慢流方程。该系统由以下二阶常微分方程描述：\n$$\n\\ddot{x} + x + \\varepsilon\\left(\\delta\\,x + \\beta\\,x^{3} + \\gamma \\cos(2 t)\\,x\\right) = 0\n$$\n其中 $0  \\varepsilon \\ll 1$。我们已知快时间 $t$ 和慢时间 $T = \\varepsilon t$。解的形式为 $x(t) = a(T)\\exp(i t) + \\overline{a(T)}\\exp(-i t)$，其中 $a(T)$ 是一个慢变复振幅。\n\n我们将使用多尺度法。我们形式上将 $t$ 和 $T$ 视为独立变量，并将解按 $\\varepsilon$ 的幂次展开：\n$$\nx(t) = x_0(t, T) + \\varepsilon x_1(t, T) + \\mathcal{O}(\\varepsilon^2)\n$$\n时间导数变换如下：\n$$\n\\frac{d}{dt} = \\frac{\\partial}{\\partial t} + \\varepsilon \\frac{\\partial}{\\partial T}\n$$\n$$\n\\frac{d^2}{dt^2} = \\left(\\frac{\\partial}{\\partial t} + \\varepsilon \\frac{\\partial}{\\partial T}\\right)^2 = \\frac{\\partial^2}{\\partial t^2} + 2\\varepsilon \\frac{\\partial^2}{\\partial t \\partial T} + \\varepsilon^2 \\frac{\\partial^2}{\\partial T^2}\n$$\n将这些代入原方程，并按 $\\varepsilon$ 的幂次收集各项：\n\n在 $\\mathcal{O}(\\varepsilon^0)$ 阶：\n$$\n\\frac{\\partial^2 x_0}{\\partial t^2} + x_0 = 0\n$$\n该方程的通解为：\n$$\nx_0(t, T) = a(T)\\exp(i t) + \\overline{a(T)}\\exp(-i t)\n$$\n这与问题陈述中给出的形式相符。这里，$a(T)$ 是慢时间 $T$ 的一个任意函数，将在下一阶确定。\n\n在 $\\mathcal{O}(\\varepsilon^1)$ 阶：\n$$\n\\frac{\\partial^2 x_1}{\\partial t^2} + x_1 = -2\\frac{\\partial^2 x_0}{\\partial t \\partial T} - \\left(\\delta\\,x_0 + \\beta\\,x_0^{3} + \\gamma \\cos(2 t)\\,x_0\\right)\n$$\n这是一个关于 $x_1$ 的受迫线性振子方程。为确保展开式的一致有效性，我们必须消除右侧的久期项（即在 $t$ 上无界增长的项）。久期项源于与齐次算子的自然频率共振的策动项，即与 $\\exp(it)$ 或 $\\exp(-it)$ 成正比的项。\n\n首先，我们计算包含混合偏导数的项：\n$$\n\\frac{\\partial x_0}{\\partial t} = i a(T)\\exp(i t) - i \\overline{a(T)}\\exp(-i t)\n$$\n$$\n\\frac{\\partial^2 x_0}{\\partial t \\partial T} = i \\frac{da}{dT}\\exp(i t) - i \\frac{d\\overline{a}}{dT}\\exp(-i t) = i a'(T)\\exp(i t) - i \\overline{a'}(T)\\exp(-i t)\n$$\n因此，右侧的第一项是：\n$$\n-2\\frac{\\partial^2 x_0}{\\partial t \\partial T} = -2i a'(T)\\exp(i t) + 2i \\overline{a'}(T)\\exp(-i t)\n$$\n接下来，我们展开非线性和参量项，将 $a(T)$ 和 $\\overline{a(T)}$ 视为关于快时间 $t$ 的常数，并识别出共振分量。\n\n1.  项 $\\delta x_0$：\n    $$\n    \\delta x_0 = \\delta \\left(a\\exp(it) + \\overline{a}\\exp(-it)\\right)\n    $$\n    与 $\\exp(it)$ 成正比的项是 $\\delta a\\exp(it)$。\n\n2.  项 $\\beta x_0^3$：\n    $$\n    x_0^3 = \\left(a\\exp(it) + \\overline{a}\\exp(-it)\\right)^3 = a^3\\exp(3it) + 3a^2\\overline{a}\\exp(it) + 3a\\overline{a}^2\\exp(-it) + \\overline{a}^3\\exp(-3it)\n    $$\n    $x_0^3$ 中与 $\\exp(it)$ 成正比的项是 $3a^2\\overline{a}\\exp(it)$。\n\n3.  项 $\\gamma \\cos(2t) x_0$：\n    我们使用 $\\cos(2t) = \\frac{1}{2}(\\exp(2it) + \\exp(-2it))$。\n    $$\n    \\gamma \\cos(2t) x_0 = \\frac{\\gamma}{2}\\left(\\exp(2it) + \\exp(-2it)\\right)\\left(a\\exp(it) + \\overline{a}\\exp(-it)\\right)\n    $$\n    $$\n    = \\frac{\\gamma}{2}\\left(a\\exp(3it) + \\overline{a}\\exp(it) + a\\exp(-it) + \\overline{a}\\exp(-3it)\\right)\n    $$\n    与 $\\exp(it)$ 成正比的项是 $\\frac{\\gamma}{2}\\overline{a}\\exp(it)$。\n\n可解性条件要求 $x_1$ 方程右侧所有 $\\exp(it)$ 的系数之和必须为零。\n$$\n-2i a'(T) - \\delta a(T) - 3\\beta a(T)^2\\overline{a(T)} - \\frac{\\gamma}{2}\\overline{a(T)} = 0\n$$\n解出 $a'(T)$：\n$$\n-2i a'(T) = \\delta a + 3\\beta a^2\\overline{a} + \\frac{\\gamma}{2}\\overline{a}\n$$\n$$\na'(T) = \\frac{i}{2}\\left(\\delta a + 3\\beta a|a|^2 + \\frac{\\gamma}{2}\\overline{a}\\right)\n$$\n这是复振幅 $a(T)$ 的平均方程。\n\n现在，我们引入极坐标表示 $a(T) = \\frac{R(T)}{2}\\exp(i\\theta(T))$。我们需要找到 $R'(T)$ 的方程。我们将 $a(T)$ 对 $T$ 求导：\n$$\na'(T) = \\frac{R'(T)}{2}\\exp(i\\theta(T)) + i\\frac{R(T)\\theta'(T)}{2}\\exp(i\\theta(T)) = \\left(\\frac{R'}{2} + i\\frac{R\\theta'}{2}\\right)\\exp(i\\theta)\n$$\n我们将极坐标形式代入 $a'(T)$ 的平均方程中：\n$$\na'(T) = \\frac{i}{2}\\left[\\delta \\frac{R}{2}\\exp(i\\theta) + 3\\beta \\left(\\frac{R}{2}\\right)^3\\exp(i\\theta) + \\frac{\\gamma}{2}\\frac{R}{2}\\exp(-i\\theta)\\right]\n$$\n$$\na'(T) = \\frac{i}{2}\\left[\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8}\\right)\\exp(i\\theta) + \\frac{\\gamma R}{4}\\exp(-i\\theta)\\right]\n$$\n令 $a'(T)$ 的两个表达式相等：\n$$\n\\left(\\frac{R'}{2} + i\\frac{R\\theta'}{2}\\right)\\exp(i\\theta) = \\frac{i}{2}\\left[\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8}\\right)\\exp(i\\theta) + \\frac{\\gamma R}{4}\\exp(-i\\theta)\\right]\n$$\n两边同乘以 $2\\exp(-i\\theta)$：\n$$\nR' + iR\\theta' = i\\left[\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8}\\right) + \\frac{\\gamma R}{4}\\exp(-2i\\theta)\\right]\n$$\n现在，展开 $\\exp(-2i\\theta) = \\cos(2\\theta) - i\\sin(2\\theta)$：\n$$\nR' + iR\\theta' = i\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8} + \\frac{\\gamma R}{4}\\cos(2\\theta)\\right) - i^2\\frac{\\gamma R}{4}\\sin(2\\theta)\n$$\n$$\nR' + iR\\theta' = \\frac{\\gamma R}{4}\\sin(2\\theta) + i\\left(\\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8} + \\frac{\\gamma R}{4}\\cos(2\\theta)\\right)\n$$\n令实部和虚部分别相等，得到 $R(T)$ 和 $\\theta(T)$ 的平均方程：\n$$\nR'(T) = \\frac{\\gamma R}{4}\\sin(2\\theta)\n$$\n$$\nR\\theta'(T) = \\frac{\\delta R}{2} + \\frac{3\\beta R^3}{8} + \\frac{\\gamma R}{4}\\cos(2\\theta)\n$$\n问题要求方程 $R'(T) = F(R, \\theta)$ 中的表达式 $F(R, \\theta)$。根据我们的推导，它就是：\n$$\nF(R, \\theta) = \\frac{\\gamma R}{4}\\sin(2\\theta)\n$$\n这个结果在物理上是一致的，因为振幅动力学（能量注入或耗散）由参量策动项 $\\gamma$ 及其与振子的相位关系 $2\\theta$ 决定，而失谐 $\\delta$ 和非线性 $\\beta$ 主要影响振荡频率，这体现在 $\\theta'$ 中。\n\n最终表达式为 $\\frac{\\gamma R}{4}\\sin(2\\theta)$。",
            "answer": "$$\\boxed{\\frac{\\gamma R}{4}\\sin(2\\theta)}$$"
        },
        {
            "introduction": "对于许多复杂系统，解析解是不可行的，这使得数值模拟成为一个必不可少的工具。本练习进入计算领域，探索一种称为“射影积分法”的强大技术，用于高效模拟具有广泛分离时间尺度的系统 。你将分析这种多尺度方法的数值稳定性，这是一个关键的考量，它突显了在快慢动力学的实际建模中所面临的挑战和所需的精密解决方案。",
            "id": "3734756",
            "problem": "考虑由以下常微分方程（ODE）对给出的快慢线性系统：\n$$\\frac{dx}{dt} = -\\frac{\\alpha}{\\epsilon}\\left(x - y\\right), \\qquad \\frac{dy}{dt} = -\\beta y + \\gamma,$$\n其中 $\\alpha  0$，$\\beta \\ge 0$，$\\gamma \\in \\mathbb{R}$，且 $0  \\epsilon \\ll 1$ 量化了时间尺度的分离。变量 $x$ 以快速率 $-\\alpha/\\epsilon$ 快速弛豫到 $y$，而 $y$ 缓慢演化。令 $u = x - y$ 表示对慢流形的快偏差。\n\n您将使用以下结构实现一个投影积分方案。从时间 $t_n$ 的状态 $(x_n, y_n)$ 开始，对完整系统应用 $K$ 个大小为 $\\Delta t$ 的显式欧拉微步，以获得状态 $(x_n^{(k)}, y_n^{(k)})$，其中 $k = 1, \\dots, K$。然后，使用最后两个微步状态来估计向量时间导数，如下所示：\n$$s = \\frac{1}{\\Delta t}\\Big(\\begin{bmatrix}x_n^{(K)} \\\\ y_n^{(K)}\\end{bmatrix} - \\begin{bmatrix}x_n^{(K-1)} \\\\ y_n^{(K-1)}\\end{bmatrix}\\Big)。$$\n执行一个长度为 $M \\Delta t$ 的投影宏更新：\n$$\\begin{bmatrix}x_{n+1} \\\\ y_{n+1}\\end{bmatrix} = \\begin{bmatrix}x_n^{(K)} \\\\ y_n^{(K)}\\end{bmatrix} + M \\Delta t\\, s,$$\n其中 $M \\ge 0$ 是一个整数。\n\n为进行快分量的稳定性分析，请使用快模式的标量线性测试问题：\n$$\\frac{du}{dt} = \\lambda_f u, \\quad \\text{其中} \\quad \\lambda_f = -\\frac{\\alpha}{\\epsilon},$$\n并定义 $z = \\lambda_f \\Delta t$。假设快模式的显式欧拉微积分器是稳定的，这要求 $-2  z  0$。通过组合 $K$ 个微步以及随后的上述定义的投影宏更新，从第一性原理推导在一个投影积分周期内乘以 $u$ 的单周期标量放大因子 $G(z, K, M)$。然后，用 $z$、$K$ 和 $M$ 表示在一个投影周期内快模式稳定性的充分必要条件。\n\n您的程序必须：\n- 为完整的 $(x,y)$ 系统实现上述投影积分方案。\n- 在给定 $(\\alpha, \\epsilon, \\Delta t, K)$ 且 $-2  z  0$ 的情况下，使用您的解析结果，在代码中推导闭式快模式放大因子 $G(z, K, M)$ 以及对容许的 $M$ 的导出约束。\n- 对于下面测试套件中的每个参数集，计算最大非负整数宏投影因子 $M_{\\max}$，使得快模式稳定性成立，即 $|G(z, K, M)| \\le 1$。如果微积分器不稳定（即 $z \\notin (-2, 0)$），则该测试用例返回 $-1$。\n\n使用以下参数集测试套件，每个集指定为 $(\\alpha, \\epsilon, \\Delta t, K)$：\n- 测试 $1$：$(10.0, 0.01, 0.0005, 3)$\n- 测试 $2$：$(10.0, 0.01, 0.0019, 2)$\n- 测试 $3$：$(5.0, 0.02, 0.0008, 3)$\n- 测试 $4$：$(1.0, 1.0, 0.01, 5)$\n- 测试 $5$：$(10.0, 0.01, 0.003, 3)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与测试套件相同，其中每个条目是为该测试用例计算的整数 $M_{\\max}$。对于微步不稳定的情况，返回 $-1$。例如，一个有效的输出格式是 $[m_1,m_2,m_3,m_4,m_5]$，其中每个 $m_i$ 都是整数。",
            "solution": "问题陈述已经过验证，并被确定为是合理的。它在科学上植根于刚性常微分方程的数值分析，特别是投影积分的应用。该问题是适定的，提供了推导稳定性限制条件和计算所需值的所有必要信息。术语是标准的，设置是一致的。\n\n问题的核心是确定投影积分方案应用于快慢系统时的稳定性。我们通过考虑快模式 $u$ 的标量线性测试问题来分析这一点，$u$ 代表对慢流形的偏离。这个快模式的演化由以下公式决定：\n$$\n\\frac{du}{dt} = \\lambda_f u, \\quad \\text{其中} \\quad \\lambda_f = -\\frac{\\alpha}{\\epsilon}\n$$\n这里，$\\alpha > 0$ 且 $0  \\epsilon \\ll 1$，所以 $\\lambda_f$ 是一个大的负数。\n\n数值方案包括三个阶段，我们逐步分析以找到单周期放大因子 $G(z, K, M)$，使得 $u_{n+1} = G(z, K, M) u_n$。令 $z = \\lambda_f \\Delta t$，其中 $\\Delta t$ 是微步时间步长。显式欧拉微积分器的稳定性要求 $-2  z  0$。\n\n**步骤1：显式欧拉微积分**\n\n我们从时间 $t_n$ 的值 $u_n$ 开始。我们采用 $K$ 个大小为 $\\Delta t$ 的显式欧拉微步。一步的更新规则是：\n$$\nu^{(k+1)} = u^{(k)} + \\Delta t (\\lambda_f u^{(k)}) = (1 + \\lambda_f \\Delta t) u^{(k)} = (1 + z) u^{(k)}\n$$\n从 $u^{(0)} = u_n$ 开始，经过 $k$ 步后，状态为：\n$$\nu_n^{(k)} = (1+z)^k u_n\n$$\n对于后续步骤，我们将需要经过 $K-1$ 和 $K$ 个微步后的状态：\n$$\nu_n^{(K-1)} = (1+z)^{K-1} u_n\n$$\n$$\nu_n^{(K)} = (1+z)^K u_n\n$$\n\n**步骤2：导数估计**\n\n时间导数使用最后两个微步状态的有限差分来估计：\n$$\ns_u = \\frac{u_n^{(K)} - u_n^{(K-1)}}{\\Delta t}\n$$\n代入步骤1中的表达式：\n$$\ns_u = \\frac{(1+z)^K u_n - (1+z)^{K-1} u_n}{\\Delta t} = \\frac{u_n}{\\Delta t} (1+z)^{K-1} ((1+z) - 1) = \\frac{u_n}{\\Delta t} (1+z)^{K-1} z\n$$\n因为 $z = \\lambda_f \\Delta t$，我们有 $z/\\Delta t = \\lambda_f$。因此，估计的导数是：\n$$\ns_u = \\lambda_f (1+z)^{K-1} u_n\n$$\n\n**步骤3：投影宏更新**\n\n最终状态 $u_{n+1}$ 是通过使用估计的导数 $s_u$ 将状态 $u_n^{(K)}$ 在时间上向前投影一个时长为 $M \\Delta t$ 来计算的：\n$$\nu_{n+1} = u_n^{(K)} + M \\Delta t \\, s_u\n$$\n代入 $u_n^{(K)}$ 和 $s_u$ 的表达式：\n$$\nu_{n+1} = (1+z)^K u_n + M \\Delta t \\left( \\lambda_f (1+z)^{K-1} u_n \\right)\n$$\n再次使用 $z = \\lambda_f \\Delta t$：\n$$\nu_{n+1} = (1+z)^K u_n + M z (1+z)^{K-1} u_n\n$$\n提出因子 $u_n$：\n$$\nu_{n+1} = \\left[ (1+z)^K + M z (1+z)^{K-1} \\right] u_n\n$$\n\n**步骤4：放大因子与稳定性分析**\n\n括号中的项是单周期标量放大因子 $G(z, K, M)$：\n$$\nG(z, K, M) = (1+z)^K + M z (1+z)^{K-1} = (1+z)^{K-1}[(1+z) + Mz]\n$$\n$$\nG(z, K, M) = (1+z)^{K-1}[1 + (M+1)z]\n$$\n为了使投影积分方案对快模式稳定，此放大因子的幅度必须不大于1：\n$$\n|G(z, K, M)| \\le 1 \\quad \\implies \\quad |(1+z)^{K-1}[1 + (M+1)z]| \\le 1\n$$\n$$\n|(1+z)^{K-1}| \\cdot |1 + (M+1)z| \\le 1\n$$\n问题假设微积分器是稳定的，即 $-2  z  0$，这意味着 $|1+z|  1$。这允许我们重排不等式：\n$$\n|1 + (M+1)z| \\le \\frac{1}{|(1+z)^{K-1}|} = |1+z|^{-(K-1)}\n$$\n这个不等式可以展开为关于项 $(M+1)z$ 的一对线性不等式：\n$$\n-|1+z|^{-(K-1)} \\le 1 + (M+1)z \\le |1+z|^{-(K-1)}\n$$\n我们需要解出最大非负整数 $M$。我们分离出包含 $M$ 的项：\n$$\n-1 -|1+z|^{-(K-1)} \\le (M+1)z \\le -1 + |1+z|^{-(K-1)}\n$$\n由于 $z  0$，除以 $z$ 会反转不等号：\n$$\n\\frac{-1 + |1+z|^{-(K-1)}}{z} \\le M+1 \\le \\frac{-1 -|1+z|^{-(K-1)}}{z}\n$$\n对于任何非负的 M，M 的下界都得到满足，因为该条件导致 M 大于一个负数。因此我们关注 M 的上界：\n$$\nM+1 \\le \\frac{-1 - |1+z|^{-(K-1)}}{z}\n$$\n$$\nM \\le \\frac{-1 - |1+z|^{-(K-1)}}{z} - 1\n$$\n令此上界为 $M_{upper}$。满足此条件的最大非负整数 $M$（记为 $M_{\\max}$）是 $M_{upper}$ 的向下取整。对于 $z \\in (-2, 0)$ 和 $K \\ge 2$，此上界是非负的。\n$$\nM_{\\max} = \\left\\lfloor \\frac{-1 - |1+z|^{-(K-1)}}{z} - 1 \\right\\rfloor\n$$\n对每个测试用例实施此公式。如果违反了微积分器稳定性的初始条件（$z \\notin (-2, 0)$），则结果为 $-1$。\n\n程序的算法是：\n1.  对于每个测试集 $(\\alpha, \\epsilon, \\Delta t, K)$，计算 $z = -\\frac{\\alpha}{\\epsilon}\\Delta t$。\n2.  如果 $z \\le -2$ 或 $z \\ge 0$，则微积分器不稳定。此情况的结果为 $-1$。\n3.  否则，计算 $M_{upper} = \\frac{-1 - |1+z|^{-(K-1)}}{z} - 1$。\n4.  结果 $M_{\\max}$ 是 $M_{upper}$ 的整数部分，对于非负值，这对应于向下取整操作。\n5.  将所有测试用例的结果收集到一个列表中。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum stable macro projection factor M_max for a projective\n    integration scheme applied to a fast-slow linear system.\n    \"\"\"\n    \n    # Test suite of parameter sets: (alpha, epsilon, delta_t, K)\n    test_cases = [\n        (10.0, 0.01, 0.0005, 3),  # Test 1\n        (10.0, 0.01, 0.0019, 2),  # Test 2\n        (5.0, 0.02, 0.0008, 3),   # Test 3\n        (1.0, 1.0, 0.01, 5),      # Test 4\n        (10.0, 0.01, 0.003, 3),   # Test 5\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        alpha, epsilon, delta_t, K = case\n        \n        # Calculate the fast eigenvalue and the stability parameter z\n        lambda_f = -alpha / epsilon\n        z = lambda_f * delta_t\n        \n        # Check for micro-integrator stability. Explicit Euler for u' = lambda_f * u\n        # is stable if and only if z = lambda_f * delta_t is in (-2, 0).\n        if z = -2.0 or z = 0:\n            results.append(-1)\n            continue\n            \n        # The derivation for the derivative estimate s requires at least two microstates,\n        # implying K = 2. All test cases satisfy this.\n\n        # Derive the upper bound for M based on the stability condition |G(z, K, M)| = 1.\n        # The amplification factor is G(z, K, M) = (1+z)^(K-1) * (1 + (M+1)z).\n        # The stability condition leads to M_upper = (-1 - |1+z|^-(K-1)) / z - 1.\n        \n        # Use numpy for robust floating-point operations.\n        abs_1_plus_z = np.abs(1.0 + z)\n        \n        # The term |1+z|^-(K-1)\n        term_power = np.power(abs_1_plus_z, -(K - 1))\n        \n        # The upper bound for M\n        M_upper = (-1.0 - term_power) / z - 1.0\n        \n        # M_max is the largest non-negative integer less than or equal to M_upper.\n        # For z in (-2, 0) and K = 2, M_upper is non-negative, so taking the\n        # integer part is equivalent to the floor function.\n        M_max = int(M_upper)\n        \n        results.append(M_max)\n        \n    # Print the results in the specified format: [m1,m2,m3,m4,m5]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}