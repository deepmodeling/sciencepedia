{
    "hands_on_practices": [
        {
            "introduction": "A fundamental principle in signal processing is the conservation of energy between a signal's domain (e.g., time) and its frequency domain, a concept formalized by Plancherel's theorem. This exercise provides a concrete verification of this theorem for a simple, yet highly instructive, signal: the rectangular pulse. By independently calculating the signal's energy in both domains, you will not only confirm the theorem but also gain insight into how a sharp, localized feature in time—the discontinuity—distributes energy across the entire frequency spectrum, motivating the need for more localized analysis tools .",
            "id": "3769760",
            "problem": "Consider the function $f:\\mathbb{R}\\to\\mathbb{C}$ defined by $f(t)=\\chi_{[0,1]}(t)$, where $\\chi_{[0,1]}$ denotes the indicator function of the interval $[0,1]$. Work within the space $L^{2}(\\mathbb{R})$ endowed with the standard Lebesgue measure. Use the unitary angular-frequency convention for the Fourier transform, namely\n$$F(\\omega)=\\mathcal{F}\\{f\\}(\\omega)=\\frac{1}{\\sqrt{2\\pi}}\\int_{-\\infty}^{\\infty}f(t)\\exp(-\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}t,$$\nand the $L^{2}$-norm definition\n$$\\|g\\|_{2}^{2}=\\int_{-\\infty}^{\\infty}|g(x)|^{2}\\,\\mathrm{d}x.$$\nStarting from these definitions and standard facts of real and complex analysis, do the following:\n- Compute the exact value of $\\|f\\|_{2}^{2}$.\n- Derive an explicit formula for $F(\\omega)$ and then compute the exact value of $\\|F\\|_{2}^{2}=\\int_{-\\infty}^{\\infty}|F(\\omega)|^{2}\\,\\mathrm{d}\\omega$ by direct evaluation of the integral, without invoking energy-equality theorems.\n- Use your results to verify the numerical equality predicted by the Plancherel theorem for this specific $f$, and provide a brief interpretation of how the energy of $f$ is distributed across frequency scales in $|F(\\omega)|^{2}$, commenting on low-frequency dominance versus high-frequency decay due to discontinuities.\n\nReport your final answer as the ordered pair $\\big(\\|f\\|_{2}^{2},\\,\\|F\\|_{2}^{2}\\big)$. No rounding is required, and no physical units are involved.",
            "solution": "We begin from core definitions: the function $f(t)=\\chi_{[0,1]}(t)$ is in $L^{2}(\\mathbb{R})$, and the $L^{2}$-norm is defined by\n$$\\|f\\|_{2}^{2}=\\int_{-\\infty}^{\\infty}|f(t)|^{2}\\,\\mathrm{d}t.$$\nBecause $|f(t)|^{2}=1$ for $t\\in[0,1]$ and $|f(t)|^{2}=0$ otherwise, we find\n$$\\|f\\|_{2}^{2}=\\int_{0}^{1}1\\,\\mathrm{d}t=1.$$\n\nNext, we compute the Fourier transform using the unitary angular-frequency convention:\n$$F(\\omega)=\\frac{1}{\\sqrt{2\\pi}}\\int_{-\\infty}^{\\infty}f(t)\\exp(-\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}t=\\frac{1}{\\sqrt{2\\pi}}\\int_{0}^{1}\\exp(-\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}t.$$\nEvaluating the integral gives\n$$F(\\omega)=\\frac{1}{\\sqrt{2\\pi}}\\left[\\frac{\\exp(-\\mathrm{i}\\,\\omega t)}{-\\mathrm{i}\\,\\omega}\\right]_{t=0}^{t=1}=\\frac{1}{\\sqrt{2\\pi}}\\cdot\\frac{1-\\exp(-\\mathrm{i}\\,\\omega)}{\\mathrm{i}\\,\\omega}.$$\nWe now compute the squared magnitude $|F(\\omega)|^{2}$:\n$$|F(\\omega)|^{2}=\\frac{1}{2\\pi}\\left|\\frac{1-\\exp(-\\mathrm{i}\\,\\omega)}{\\mathrm{i}\\,\\omega}\\right|^{2}=\\frac{1}{2\\pi}\\cdot\\frac{|1-\\exp(-\\mathrm{i}\\,\\omega)|^{2}}{\\omega^{2}}.$$\nNote that\n$$|1-\\exp(-\\mathrm{i}\\,\\omega)|^{2}=(1-\\cos\\omega)^{2}+(\\sin\\omega)^{2}=2-2\\cos\\omega=4\\sin^{2}\\!\\left(\\frac{\\omega}{2}\\right),$$\nso\n$$|F(\\omega)|^{2}=\\frac{1}{2\\pi}\\cdot\\frac{4\\sin^{2}\\!\\left(\\frac{\\omega}{2}\\right)}{\\omega^{2}}.$$\nTherefore,\n$$\\|F\\|_{2}^{2}=\\int_{-\\infty}^{\\infty}|F(\\omega)|^{2}\\,\\mathrm{d}\\omega=\\int_{-\\infty}^{\\infty}\\frac{1}{2\\pi}\\cdot\\frac{4\\sin^{2}\\!\\left(\\frac{\\omega}{2}\\right)}{\\omega^{2}}\\,\\mathrm{d}\\omega.$$\nMake the change of variables $\\omega=2x$ so that $\\mathrm{d}\\omega=2\\,\\mathrm{d}x$. The integrand transforms as follows:\n$$\\frac{4\\sin^{2}\\!\\left(\\frac{\\omega}{2}\\right)}{\\omega^{2}}=\\frac{4\\sin^{2}(x)}{(2x)^{2}}=\\frac{\\sin^{2}(x)}{x^{2}}.$$\nThus,\n$$\\|F\\|_{2}^{2}=\\int_{-\\infty}^{\\infty}\\frac{1}{2\\pi}\\cdot\\frac{4\\sin^{2}\\!\\left(\\frac{\\omega}{2}\\right)}{\\omega^{2}}\\,\\mathrm{d}\\omega=\\int_{-\\infty}^{\\infty}\\frac{1}{2\\pi}\\cdot\\frac{\\sin^{2}(x)}{x^{2}}\\cdot 2\\,\\mathrm{d}x=\\frac{1}{\\pi}\\int_{-\\infty}^{\\infty}\\frac{\\sin^{2}(x)}{x^{2}}\\,\\mathrm{d}x.$$\nWe now evaluate the remaining integral. A standard, well-tested integral from Fourier analysis and contour integration is\n$$\\int_{0}^{\\infty}\\frac{\\sin(ax)}{x}\\,\\mathrm{d}x=\\frac{\\pi}{2}\\quad\\text{for}\\quad a>0.$$\nDefine\n$$I(a)=\\int_{-\\infty}^{\\infty}\\frac{1-\\cos(ax)}{x^{2}}\\,\\mathrm{d}x.$$\nDifferentiating $I(a)$ with respect to $a$ under the integral sign (justified by dominated convergence for $a>0$), we obtain\n$$I'(a)=\\int_{-\\infty}^{\\infty}\\frac{\\sin(ax)}{x}\\,\\mathrm{d}x=2\\int_{0}^{\\infty}\\frac{\\sin(ax)}{x}\\,\\mathrm{d}x=\\pi.$$\nSince $I(0)=0$, integrating $I'(a)=\\pi$ yields $I(a)=\\pi a$ for $a\\geq 0$. Using the trigonometric identity $\\sin^{2}(x)=\\frac{1-\\cos(2x)}{2}$ gives\n$$\\int_{-\\infty}^{\\infty}\\frac{\\sin^{2}(x)}{x^{2}}\\,\\mathrm{d}x=\\frac{1}{2}\\int_{-\\infty}^{\\infty}\\frac{1-\\cos(2x)}{x^{2}}\\,\\mathrm{d}x=\\frac{1}{2}I(2)=\\frac{1}{2}\\cdot\\pi\\cdot 2=\\pi.$$\nTherefore,\n$$\\|F\\|_{2}^{2}=\\frac{1}{\\pi}\\cdot\\pi=1.$$\n\nWe have computed $\\|f\\|_{2}^{2}=1$ and $\\|F\\|_{2}^{2}=1$, verifying the numerical equality anticipated by the Plancherel theorem under the unitary angular-frequency convention.\n\nFor multiscale interpretation, observe that the spectral energy density $|F(\\omega)|^{2}$ takes the form\n$$|F(\\omega)|^{2}=\\frac{1}{2\\pi}\\cdot\\frac{4\\sin^{2}\\!\\left(\\frac{\\omega}{2}\\right)}{\\omega^{2}},$$\nwhich is an even function of $\\omega$ exhibiting an envelope that decays like $\\omega^{-2}$ modulated by oscillations from $\\sin^{2}(\\omega/2)$. This reflects that a discontinuity in $f$ at $t=0$ and $t=1$ injects energy across a continuum of frequency scales, with dominance at low frequencies due to the $\\omega^{-2}$ decay. The oscillatory sidelobes encode the finite support and sharp edges, characteristic of multiscale mixing: substantial energy at coarse scales (small $|\\omega|$) and progressively diminishing contributions at finer scales (large $|\\omega|$), consistent with the scale-spreading effect of abrupt transitions.",
            "answer": "$$\\boxed{\\begin{pmatrix}1 & 1\\end{pmatrix}}$$"
        },
        {
            "introduction": "While the Fourier transform provides a global frequency perspective, it struggles to pinpoint localized events. The Continuous Wavelet Transform (CWT) overcomes this limitation by analyzing a signal at different scales and locations simultaneously. This practice delves into the core strength of wavelet analysis: singularity detection. By computing the CWT of a step function, you will see firsthand how the transform's coefficients encode the precise location, strength, and nature of a discontinuity, demonstrating the \"mathematical microscope\" power of wavelets .",
            "id": "3769738",
            "problem": "Consider multiscale analysis of a one-dimensional signal that is piecewise smooth with a localized singularity. Let the signal be modeled as a jump of strength $S \\in \\mathbb{R}$ at location $x_{0} \\in \\mathbb{R}$, namely $f(x) = S\\,H(x - x_{0})$, where $H$ denotes the Heaviside step function defined by $H(x) = 0$ for $x < 0$ and $H(x) = 1$ for $x \\ge 0$. Use the Continuous Wavelet Transform (CWT) of $f$ with the first derivative of a Gaussian as the mother wavelet,\n$$\n\\psi(x) = -x\\,\\exp\\!\\left(-\\frac{x^{2}}{2}\\right),\n$$\nand the standard CWT definition\n$$\nW_{f}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} f(x)\\,\\psi\\!\\left(\\frac{x-b}{a}\\right)\\,dx,\n$$\nfor scale $a > 0$ and location $b \\in \\mathbb{R}$. Starting from these fundamental definitions, derive the exact analytical expression for $W_{f}(a,b)$, and explain how the coefficient behavior as a function of $a$ and $b$ encodes both the singularity’s location and its strength. Provide your final answer as a single closed-form analytic expression for $W_{f}(a,b)$.",
            "solution": "The Continuous Wavelet Transform (CWT) of the function $f(x)$ with the wavelet $\\psi(x)$ is given by:\n$$\nW_{f}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} f(x)\\,\\psi\\!\\left(\\frac{x-b}{a}\\right)\\,dx\n$$\nWe are given the signal $f(x) = S\\,H(x - x_{0})$, where $S$ is the strength of the jump and $x_{0}$ is its location. The Heaviside function $H(x - x_{0})$ is equal to $0$ for $x < x_{0}$ and $1$ for $x \\ge x_{0}$. We substitute $f(x)$ into the CWT definition:\n$$\nW_{f}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} S\\,H(x - x_{0})\\,\\psi\\!\\left(\\frac{x-b}{a}\\right)\\,dx\n$$\nDue to the property of the Heaviside function, the integrand is non-zero only for $x \\ge x_{0}$. This changes the lower limit of integration from $-\\infty$ to $x_{0}$:\n$$\nW_{f}(a,b) = \\frac{S}{\\sqrt{a}} \\int_{x_{0}}^{\\infty} \\psi\\!\\left(\\frac{x-b}{a}\\right)\\,dx\n$$\nNext, we substitute the expression for the mother wavelet, $\\psi(x) = -x\\,\\exp\\!\\left(-\\frac{x^{2}}{2}\\right)$:\n$$\nW_{f}(a,b) = \\frac{S}{\\sqrt{a}} \\int_{x_{0}}^{\\infty} \\left[-\\left(\\frac{x-b}{a}\\right)\\exp\\!\\left(-\\frac{1}{2}\\left(\\frac{x-b}{a}\\right)^{2}\\right)\\right]\\,dx\n$$\nTo evaluate this integral, we perform a change of variables. Let $u = \\frac{x-b}{a}$. Then, the differential is $du = \\frac{1}{a}dx$, which implies $dx = a\\,du$. The limits of integration must also be transformed:\n- As $x \\to x_{0}$, the new lower limit is $u = \\frac{x_{0}-b}{a}$.\n- As $x \\to \\infty$, the new upper limit is $u \\to \\infty$.\n\nSubstituting these into the integral gives:\n$$\nW_{f}(a,b) = \\frac{S}{\\sqrt{a}} \\int_{\\frac{x_{0}-b}{a}}^{\\infty} \\left[-u\\,\\exp\\!\\left(-\\frac{u^{2}}{2}\\right)\\right]\\,(a\\,du)\n$$\nThe factor of $a$ in the differential $a\\,du$ combines with the pre-factor $\\frac{S}{\\sqrt{a}}$:\n$$\nW_{f}(a,b) = S\\sqrt{a} \\int_{\\frac{x_{0}-b}{a}}^{\\infty} -u\\,\\exp\\!\\left(-\\frac{u^{2}}{2}\\right)\\,du\n$$\nThe integrand, $-u\\,\\exp\\!\\left(-\\frac{u^{2}}{2}\\right)$, is the exact derivative of the function $\\exp\\!\\left(-\\frac{u^{2}}{2}\\right)$, since $\\frac{d}{du}\\exp\\!\\left(-\\frac{u^{2}}{2}\\right) = \\exp\\!\\left(-\\frac{u^{2}}{2}\\right) \\cdot (-u)$. Therefore, we can find the antiderivative and evaluate the definite integral:\n$$\n\\int -u\\,\\exp\\!\\left(-\\frac{u^{2}}{2}\\right)\\,du = \\exp\\!\\left(-\\frac{u^{2}}{2}\\right)\n$$\nEvaluating this at the limits of integration:\n$$\n\\left[\\exp\\!\\left(-\\frac{u^{2}}{2}\\right)\\right]_{\\frac{x_{0}-b}{a}}^{\\infty} = \\lim_{u\\to\\infty} \\exp\\!\\left(-\\frac{u^{2}}{2}\\right) - \\exp\\!\\left(-\\frac{1}{2}\\left(\\frac{x_{0}-b}{a}\\right)^{2}\\right)\n$$\nThe limit as $u \\to \\infty$ is $0$. Thus, the integral evaluates to:\n$$\n0 - \\exp\\!\\left(-\\frac{(x_{0}-b)^{2}}{2a^{2}}\\right) = -\\exp\\!\\left(-\\frac{(b-x_{0})^{2}}{2a^{2}}\\right)\n$$\nFinally, multiplying by the pre-factor $S\\sqrt{a}$, we obtain the exact analytical expression for the CWT coefficients:\n$$\nW_{f}(a,b) = -S\\sqrt{a}\\,\\exp\\!\\left(-\\frac{(b-x_{0})^{2}}{2a^{2}}\\right)\n$$\nThis expression reveals how the CWT coefficients encode the properties of the singularity:\n1.  **Strength Encoding**: The coefficient $W_{f}(a,b)$ is directly proportional to the jump strength $S$. The sign of the coefficient is opposite to the sign of the jump.\n2.  **Location Encoding**: For any fixed scale $a > 0$, the magnitude of the transform, $|W_{f}(a,b)| = |S|\\sqrt{a}\\,\\exp\\!\\left(-\\frac{(b-x_{0})^{2}}{2a^{2}}\\right)$, is a Gaussian function of the position parameter $b$. This Gaussian is centered at $b=x_{0}$. Therefore, the location of the singularity $x_{0}$ can be identified by finding the value of $b$ for which the wavelet coefficient magnitude is maximum. These maxima occur along the line $b=x_{0}$ in the scale-space plane $(a,b)$.\n3.  **Scale Behavior**: The maximum amplitude of the transform at the singularity, $|W_{f}(a,x_{0})| = |S|\\sqrt{a}$, is proportional to $\\sqrt{a}$. This behavior, where the modulus maxima decay to zero as $a \\to 0$, is characteristic of a step discontinuity. Different types of singularities (e.g., a Dirac delta) exhibit different power-law dependencies on the scale $a$, allowing for singularity classification.",
            "answer": "$$\\boxed{-S\\sqrt{a}\\exp\\!\\left(-\\frac{(b-x_{0})^{2}}{2a^{2}}\\right)}$$"
        },
        {
            "introduction": "Building on the analysis of one-dimensional singularities, we now advance to the more complex world of two-dimensional signals, such as images, where singularities manifest as edges and corners. Standard wavelets are isotropic and less effective at characterizing the orientation of such features. This computational exercise introduces directional wavelets to numerically approximate the wavefront set, a powerful mathematical object that describes not only the location but also the orientation of singularities. By implementing this analysis, you will connect integral transform theory to practical image processing and the foundations of modern transforms like shearlets .",
            "id": "3769709",
            "problem": "Consider functions on the plane modeled as tempered distributions. The wavefront set of a tempered distribution, denoted by $\\mathrm{WF}(f)$, is defined as the set of pairs $(x_0,\\xi_0)$ with $x_0 \\in \\mathbb{R}^2$ and $\\xi_0 \\in \\mathbb{R}^2 \\setminus \\{0\\}$ such that $f$ fails to be microlocally smooth at $x_0$ in the cotangent direction $\\xi_0$. Equivalently, $f$ is microlocally smooth at $(x_0,\\xi_0)$ if there exists a $C^\\infty$ cutoff $\\chi$ supported near $x_0$ with $\\chi(x_0)=1$ and a conic neighborhood $\\Gamma$ of $\\xi_0$ in frequency space such that the Fourier transform $\\widehat{\\chi f}(\\xi)$ decays faster than any power of $\\lVert \\xi \\rVert$ as $\\lVert \\xi \\rVert \\to \\infty$ for $\\xi \\in \\Gamma$. \n\nDirectional wavelet transforms constitute integral transforms that can recover $\\mathrm{WF}(f)$ by detecting the directional non-decay of localized coefficients across scales. A directional continuous wavelet transform (Continuous Wavelet Transform (CWT)) of $f:\\mathbb{R}^2 \\to \\mathbb{R}$ with a mother wavelet $\\psi:\\mathbb{R}^2 \\to \\mathbb{R}$ (assumed to have zero mean) is defined by\n$$\nW_f(a,\\theta,b) \\;=\\; \\int_{\\mathbb{R}^2} f(x)\\, \\psi_{a,\\theta,b}(x)\\, dx,\n$$\nwhere the analyzing wavelet is given by\n$$\n\\psi_{a,\\theta,b}(x) \\;=\\; a^{-2}\\, \\psi\\!\\left( R_{-\\theta}\\frac{x-b}{a} \\right),\n$$\nwith $a>0$ the scale, $\\theta \\in [0,\\pi)$ the orientation angle, $b \\in \\mathbb{R}^2$ the spatial location, and $R_{-\\theta}$ the rotation matrix by angle $-\\theta$. When $\\psi$ is chosen as a first directional derivative of a Gaussian, the transform emphasizes discontinuities whose normal direction aligns with $\\theta$ and whose strength persists as $a \\to 0$.\n\nYour task is to design and implement a program that approximates the directional wavelet coefficients for selected scales and orientations using discrete convolutions with rotated first-derivative-of-Gaussian filters and uses these coefficients to infer the angular component of $\\mathrm{WF}(f)$ localized near a specified point. Specifically:\n\n- Use the mother wavelet $\\psi(x) = \\nabla G_\\sigma(x) \\cdot n(\\theta)$ where $G_\\sigma(x)$ is the isotropic Gaussian $G_\\sigma(x) = \\frac{1}{2\\pi \\sigma^2} \\exp\\!\\left(-\\frac{\\lVert x \\rVert^2}{2\\sigma^2}\\right)$, $\\nabla G_\\sigma$ is its gradient, and $n(\\theta) = (\\cos\\theta,\\sin\\theta)$ is the unit vector indicating the detection direction. This yields a directional first-derivative-of-Gaussian wavelet. The discrete rotated and scaled filters must be $L^2$-normalized (unit energy) to enable fair comparison across scales and orientations.\n\n- Approximate the coefficients $W_f(a,\\theta,b)$ by discrete convolution $(f * \\psi_{a,\\theta})(b)$ evaluated across the image grid, for a finite set of scales $a \\in \\{a_1,a_2\\}$ and orientations $\\theta \\in \\Theta$, and then aggregate the absolute values across scales by taking the pointwise maximum over scales for each orientation.\n\n- Localize at the point $b_0=(0,0)$ by evaluating the maximum coefficient magnitude within a square window of radius proportional to the largest scale around the discrete grid location corresponding to $b_0$.\n\n- Decide which orientations belong to the angular component of $\\mathrm{WF}(f)$ at $b_0$ by thresholding the orientation-wise localized maxima at a fraction of the global maximum across orientations. If the global maximum magnitude is below a small noise floor $\\varepsilon$, declare no detected singular directions (return an empty list).\n\nFormally, implement the following steps:\n1. Construct a square grid of size $N \\times N$ with $N$ an even integer, representing the domain $[-1,1]\\times[-1,1]$ sampled uniformly.\n2. Define the following functions on the grid:\n   - Case A (corner singularity): $f_A(x,y) = H(x)\\, H(y)$, where $H$ is the Heaviside step function. This represents the indicator function of the first quadrant and exhibits a corner singularity at $(0,0)$ and edge singularities along $x=0$ and $y=0$.\n   - Case B (smooth baseline): $f_B(x,y) = 1$, a constant function, which is smooth everywhere.\n   - Case C (single edge): $f_C(x,y) = H(x)$, the indicator of the right half-plane, which exhibits an edge singularity along $x=0$ but no corner at $(0,0)$.\n3. Use two scales $a_1$ and $a_2$ corresponding to Gaussian standard deviations $\\sigma_1$ and $\\sigma_2$ in pixels, and the orientation set $\\Theta=\\{0, \\pi/8, \\pi/4, 3\\pi/8, \\pi/2\\}$.\n4. For each test case function $f \\in \\{f_A,f_B,f_C\\}$, for each $\\theta \\in \\Theta$, compute the convolution with the directional wavelet at scales $\\sigma_1$ and $\\sigma_2$, take the absolute value and then the maximum across scales to form an orientation response map. Around the grid center corresponding to $(0,0)$, extract the maximum magnitude in a square window whose half-width is $3\\max(\\sigma_1,\\sigma_2)$ pixels.\n5. For each test case, compute the global maximum across orientations of the localized maxima. If this global maximum is below $\\varepsilon$, output an empty list for that test case. Otherwise, use a threshold fraction $\\tau$ of the global maximum and select all orientations $\\theta$ whose localized maxima are at least $\\tau$ times the global maximum. The reported angles must be in radians and rounded to three decimal places.\n\nParameter values (test suite):\n- Grid size: $N=256$.\n- Scales (in pixels): $\\sigma_1=1.5$, $\\sigma_2=3.0$.\n- Orientations: $\\Theta=\\{0, \\pi/8, \\pi/4, 3\\pi/8, \\pi/2\\}$.\n- Threshold fraction: $\\tau=0.6$.\n- Noise floor: $\\varepsilon=10^{-3}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is a list of the selected angles in radians rounded to three decimal places. For example, the format should be like $[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,]$ with no spaces after commas. The angle unit must be radians.\n\nThe expected logical outcomes are:\n- For Case A, the dominant detected orientations should correspond to the conormal directions of the edges meeting at the corner, i.e., near $0$ and $\\pi/2$ radians.\n- For Case B, no orientations should be selected (empty list) due to the vanishing response of zero-mean wavelets on constants.\n- For Case C, the dominant detected orientation should be near $0$ radians, corresponding to the normal direction of the vertical edge at $x=0$.\n\nYour implementation must be self-contained, perform all computations numerically, and adhere to the specified output format. No physical units other than the angle unit apply here; angles must be expressed in radians as specified.",
            "solution": "The problem requires the design and implementation of a numerical method to approximate the angular component of the wavefront set $\\mathrm{WF}(f)$ for given functions $f$ on $\\mathbb{R}^2$. The wavefront set characterizes the locations and directions of singularities of a distribution. The core idea is that the coefficients of a directional continuous wavelet transform (CWT) will exhibit large magnitudes at locations and orientations corresponding to the elements of $\\mathrm{WF}(f)$. We will implement a discrete version of this principle using convolution with specifically designed filters.\n\nThe process is structured as follows:\n1.  Generation of discrete directional wavelet kernels.\n2.  Discretization of the test functions on a computational grid.\n3.  Computation of wavelet coefficients via 2D convolution.\n4.  Aggregation of coefficients across scales and localization around the point of interest.\n5.  Thresholding of the resulting orientation-dependent magnitudes to identify significant directions.\n\n**1. Wavelet Kernel Design and Discretization**\n\nThe problem specifies a mother wavelet related to the directional derivative of a Gaussian. For a given orientation angle $\\theta$, the analyzing wavelet is constructed by applying the directional derivative operator $\\frac{\\partial}{\\partial n(\\theta)} = \\nabla \\cdot n(\\theta)$ to an isotropic Gaussian $G_\\sigma(x) = \\frac{1}{2\\pi \\sigma^2} \\exp(-\\frac{\\lVert x \\rVert^2}{2\\sigma^2})$, where $n(\\theta) = (\\cos\\theta, \\sin\\theta)$ is the direction vector.\nThe wavelet function for a given scale $\\sigma$ and orientation $\\theta$ is therefore:\n$$\n\\psi_{\\sigma,\\theta}(x) = \\nabla G_\\sigma(x) \\cdot n(\\theta)\n$$\nThe gradient of the Gaussian is $\\nabla G_\\sigma(x) = -\\frac{x}{\\sigma^2} G_\\sigma(x)$. Substituting this, we obtain:\n$$\n\\psi_{\\sigma,\\theta}(x) = -\\frac{x \\cdot n(\\theta)}{\\sigma^2} G_\\sigma(x) = -\\frac{x_1 \\cos\\theta + x_2 \\sin\\theta}{\\sigma^2} \\frac{1}{2\\pi \\sigma^2} \\exp\\left(-\\frac{x_1^2+x_2^2}{2\\sigma^2}\\right)\n$$\nThis function has a zero mean, $\\int_{\\mathbb{R}^2} \\psi_{\\sigma,\\theta}(x) dx = 0$, making it sensitive to changes in the signal rather than its mean value.\n\nFor numerical computation, we create discrete kernels by sampling this continuous function $\\psi_{\\sigma,\\theta}(x)$ on a grid. A suitable kernel size must be chosen to capture the significant part of the function, which decays rapidly due to the Gaussian term. We use a square grid for the kernel of size $(2K+1) \\times (2K+1)$, where the half-width $K$ is set to $K = \\lceil 3 \\max(\\sigma_1, \\sigma_2) \\rceil = \\lceil 3 \\times 3.0 \\rceil = 9$ pixels. The kernel grid coordinates $(i, j)$ range from $-K$ to $K$.\n\nA crucial step is the normalization of these discrete kernels. To ensure a fair comparison of wavelet responses across different scales ($\\sigma_1=1.5$ and $\\sigma_2=3.0$), the energy of the discrete kernels must be equalized. We enforce a unit $L^2$-norm for each kernel $K$:\n$$\nK_{\\text{norm}}[i,j] = \\frac{K[i,j]}{\\sqrt{\\sum_{p,q} (K[p,q])^2}}\n$$\nThis step is critical for the subsequent aggregation across scales.\n\n**2. Signal Discretization**\n\nThe continuous functions $f_A, f_B, f_C$ are sampled on a $N \\times N$ grid with $N=256$, representing the spatial domain $[-1,1] \\times [-1,1]$. The grid points $(x_i, y_j)$ are defined with pixel centers, such that the origin $(0,0)$ lies on the boundary between grid cells. For $i,j \\in \\{0, 1, \\dots, N-1\\}$, the coordinates are:\n$$\nx_i = \\frac{2}{N}(i - \\frac{N}{2} + 0.5), \\quad y_j = \\frac{2}{N}(j - \\frac{N}{2} + 0.5)\n$$\nThe test functions are then defined on this grid:\n-   Case A (corner): $f_A[i,j] = H(x_i)H(y_j)$\n-   Case B (constant): $f_B[i,j] = 1$\n-   Case C (edge): $f_C[i,j] = H(x_i)$\nwhere $H(z)=1$ for $z \\ge 0$ and $H(z)=0$ for $z < 0$.\n\n**3. Convolution and Multiscale Aggregation**\n\nThe continuous wavelet transform is approximated by a discrete 2D convolution. For each test function $f$ and each orientation $\\theta \\in \\Theta = \\{0, \\pi/8, \\pi/4, 3\\pi/8, \\pi/2\\}$, we compute the convolutions with the normalized kernels for scales $\\sigma_1=1.5$ and $\\sigma_2=3.0$:\n$$\nC_1(\\theta) = f * K_{\\sigma_1, \\theta} \\quad \\text{and} \\quad C_2(\\theta) = f * K_{\\sigma_2, \\theta}\n$$\nThe wavelet transform detects singularities by their persistent response across scales. We combine the information from the two scales by taking the pointwise maximum of the absolute values of the convolution outputs. This creates a single orientation response map for each $\\theta$:\n$$\nM(\\theta)[i,j] = \\max(|C_1(\\theta)[i,j]|, |C_2(\\theta)[i,j]|)\n$$\n\n**4. Localization**\n\nWe are interested in the singularities at the origin $b_0=(0,0)$. In our discrete setup, this corresponds to the center of the grid. We analyze the behavior of the response maps $M(\\theta)$ in a neighborhood of the center. A square window of half-width $W = \\text{round}(3 \\max(\\sigma_1, \\sigma_2)) = 9$ pixels is defined around the central grid location $(N/2, N/2)$. For each orientation $\\theta$, we find the maximum response magnitude within this window, yielding a single value $L(\\theta)$:\n$$\nL(\\theta) = \\max_{(i,j) \\in \\text{window}} M(\\theta)[i,j]\n$$\nThe set of values $\\{L(\\theta) \\mid \\theta \\in \\Theta\\}$ represents the strength of the singularity at the origin as a function of direction.\n\n**5. Thresholding and decision**\n\nFinally, to determine which orientations belong to the wavefront set, we apply a thresholding rule. First, we find the global maximum response across all tested orientations, $L_{\\text{max}} = \\max_{\\theta \\in \\Theta} L(\\theta)$.\n\n-   If $L_{\\text{max}}$ is below a noise floor $\\varepsilon=10^{-3}$, we conclude that there are no significant singularities, which is expected for smooth functions like $f_B$. The output is an empty list.\n-   Otherwise, we identify all orientations whose response $L(\\theta)$ is a significant fraction of the global maximum. An orientation $\\theta$ is considered significant if its response meets the criterion $L(\\theta) \\ge \\tau \\cdot L_{\\text{max}}$, where the threshold fraction is given as $\\tau=0.6$.\n\nThe selected angles are then collected for each test case and reported in radians, rounded to three decimal places. This procedure provides a numerical estimate of the conormal directions associated with singularities at the origin, effectively approximating the angular component of $\\mathrm{WF}(f)$ at $b_0$. For a feature oriented along a curve, the wavelet's directional derivative provides the strongest response when it is aligned with the normal to that curve. Thus, the detected angles $\\theta$ directly correspond to the conormal directions $\\xi_0$ in the wavefront set pairs $(x_0, \\xi_0)$.",
            "answer": "```python\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Approximates the angular component of the wavefront set for test functions\n    using directional wavelet transforms.\n    \"\"\"\n    \n    # Parameters provided in the problem statement\n    N = 256\n    SIGMAS = [1.5, 3.0]\n    # Orientations theta in radians\n    ORIENTATIONS = np.array([0.0, np.pi/8, np.pi/4, 3*np.pi/8, np.pi/2])\n    # Threshold fraction\n    TAU = 0.6\n    # Noise floor\n    EPSILON = 1e-3\n\n    # Derived parameters for kernel and window size\n    WINDOW_HALF_WIDTH = int(round(3 * max(SIGMAS)))\n    KERNEL_HALF_WIDTH = int(np.ceil(3 * max(SIGMAS)))\n\n    def create_l2_normalized_doga_kernel(sigma, theta):\n        \"\"\"\n        Creates a discrete, L2-normalized directional first-derivative-of-Gaussian kernel.\n        The wavelet is psi(x) = nabla(G_sigma(x)) . n(theta).\n        \"\"\"\n        size = 2 * KERNEL_HALF_WIDTH + 1\n        y, x = np.mgrid[-KERNEL_HALF_WIDTH:KERNEL_HALF_WIDTH+1, -KERNEL_HALF_WIDTH:KERNEL_HALF_WIDTH+1]\n        \n        # Isotropic Gaussian component G_sigma(x)\n        gauss_comp = (1 / (2 * np.pi * sigma**2)) * np.exp(-(x**2 + y**2) / (2 * sigma**2))\n        \n        # Directional derivative component: - (x.n(theta)) / sigma^2\n        dir_derivative_comp = -(x * np.cos(theta) + y * np.sin(theta)) / (sigma**2)\n        \n        kernel = dir_derivative_comp * gauss_comp\n        \n        # L2-normalization of the discrete kernel to ensure unit energy\n        norm = np.sqrt(np.sum(kernel**2))\n        if norm > 1e-9: # Avoid division by zero\n            kernel /= norm\n            \n        return kernel\n\n    # 1. Construct the grid representing the domain [-1, 1] x [-1, 1]\n    # The origin (0,0) is located at the boundary between pixels for an even N\n    dx = 2.0 / N\n    coords = dx * (np.arange(N) - N / 2 + 0.5)\n    x_grid, y_grid = np.meshgrid(coords, coords)\n\n    # 2. Define the functions on the grid\n    # Heaviside function H(z) is 1 if z >= 0, 0 otherwise\n    # Case A: Corner singularity f_A(x,y) = H(x)H(y)\n    f_A = (x_grid >= 0).astype(float) * (y_grid >= 0).astype(float)\n    \n    # Case B: Smooth baseline f_B(x,y) = 1\n    f_B = np.ones((N, N), dtype=float)\n    \n    # Case C: Single edge f_C(x,y) = H(x)\n    f_C = (x_grid >= 0).astype(float)\n\n    test_cases = [f_A, f_B, f_C]\n    all_results = []\n\n    for f_case in test_cases:\n        case_oriented_maxima = []\n        for theta in ORIENTATIONS:\n            # 3. For each orientation, compute convolutions at two scales\n            kernel1 = create_l2_normalized_doga_kernel(SIGMAS[0], theta)\n            kernel2 = create_l2_normalized_doga_kernel(SIGMAS[1], theta)\n            \n            conv1 = signal.convolve2d(f_case, kernel1, mode='same', boundary='symm')\n            conv2 = signal.convolve2d(f_case, kernel2, mode='same', boundary='symm')\n            \n            # Aggregate across scales by taking pointwise maximum of absolute values\n            response_map = np.maximum(np.abs(conv1), np.abs(conv2))\n            \n            # 4. Localize at the center (0,0)\n            center_y, center_x = N // 2, N // 2\n            W = WINDOW_HALF_WIDTH\n            window = response_map[center_y - W : center_y + W + 1, center_x - W : center_x + W + 1]\n            \n            local_max = np.max(window)\n            case_oriented_maxima.append(local_max)\n\n        # 5. Thresholding to decide which orientations are significant\n        case_oriented_maxima = np.array(case_oriented_maxima)\n        global_max = np.max(case_oriented_maxima) if case_oriented_maxima.size > 0 else 0.0\n        \n        detected_angles = []\n        if global_max >= EPSILON:\n            threshold = TAU * global_max\n            # Find indices of orientations that meet the threshold\n            significant_indices = np.where(case_oriented_maxima >= threshold)[0]\n            # Get the angles and round them\n            detected_angles = [round(angle, 3) for angle in ORIENTATIONS[significant_indices]]\n        \n        all_results.append(detected_angles)\n\n    # Format the final output string as per the requirements\n    case_results_str = []\n    for res_list in all_results:\n        inner_str = f\"[{','.join(map(str, res_list))}]\"\n        case_results_str.append(inner_str)\n    \n    print(f\"[{','.join(case_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}