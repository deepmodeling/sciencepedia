{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a concrete foundation for understanding residual-free bubbles by solving the local problem from first principles . For a one-dimensional advection-diffusion-reaction operator, you will explicitly construct the element's Green's function, which acts as the inverse of the differential operator on the local domain. This practice demonstrates how the bubble function can be formally defined as a convolution of the residual with this Green's function, providing a direct link between the operator, the residual it must cancel, and the resulting bubble shape.",
            "id": "3804185",
            "problem": "Consider the one-dimensional advection–diffusion–reaction operator with constant coefficients on the open element $K=(0,h)$,\n$$\n\\mathcal{L} u := -\\mu\\,\\frac{\\mathrm{d}^{2}u}{\\mathrm{d}x^{2}} + \\alpha\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x} + \\gamma\\,u,\n$$\nwhere $\\mu>0$, $\\alpha\\in\\mathbb{R}$, and $\\gamma>0$. The Residual-Free Bubble (RFB) method seeks an element bubble $b_{K}$ that annihilates a given element residual $R$ by solving the local boundary value problem\n$$\n\\mathcal{L} b_{K} = R \\quad \\text{in } K, \\qquad b_{K}(0)=0, \\quad b_{K}(h)=0,\n$$\nwith $R$ constant on $K$. The element Green’s function $G_{K}(x,\\xi)$ for $\\mathcal{L}$ on $K$ is defined by\n$$\n\\mathcal{L}_{x} G_{K}(x,\\xi) = \\delta(x-\\xi), \\qquad G_{K}(0,\\xi)=0, \\quad G_{K}(h,\\xi)=0,\n$$\nwhere $\\delta$ is the Dirac distribution and $\\mathcal{L}_{x}$ indicates that $\\mathcal{L}$ acts with respect to the spatial variable $x$.\n\nStarting from the fundamental laws of linear differential operators and distribution theory, and using only the constant-coefficient structure of $\\mathcal{L}$, derive an explicit expression for the element Green’s function $G_{K}(x,\\xi)$. Then, define the RFB bubble as the convolution\n$$\nb_{K}(x) := \\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi,\n$$\nand validate it against the constant residual by proving it solves the local boundary value problem above. Finally, compute $b_{K}(x)$ in closed form. Express all exponential functions using $\\exp(\\cdot)$, and define any auxiliary quantities you introduce. If you require a piecewise representation, you may use the Heaviside step function $H(s)$ with the convention $H(s)=1$ for $s>0$ and $H(s)=0$ for $s\\le 0$.\n\nYour final answer must be a single analytical expression or, if multiple expressions are necessary, present them as a single row matrix using the $\\mathrm{pmatrix}$ environment. No numerical evaluation is required.",
            "solution": "We begin with the constant-coefficient second-order operator\n$$\n\\mathcal{L} u := -\\mu\\,u'' + \\alpha\\,u' + \\gamma\\,u,\n$$\nwith $\\mu>0$, $\\alpha\\in\\mathbb{R}$, and $\\gamma>0$ on $K=(0,h)$. The element Green’s function $G_{K}(x,\\xi)$ is defined to satisfy\n$$\n\\mathcal{L}_{x} G_{K}(x,\\xi) = \\delta(x-\\xi), \\qquad G_{K}(0,\\xi)=0, \\quad G_{K}(h,\\xi)=0.\n$$\nFor $x\\neq \\xi$, $G_{K}(\\cdot,\\xi)$ satisfies the homogeneous equation\n$$\n-\\mu\\,y'' + \\alpha\\,y' + \\gamma\\,y = 0,\n$$\nwhose characteristic equation is\n$$\n-\\mu r^{2} + \\alpha r + \\gamma = 0 \\quad \\Longleftrightarrow \\quad \\mu r^{2} - \\alpha r - \\gamma = 0.\n$$\nThe two distinct real roots (since $\\alpha^{2}+4\\mu\\gamma>0$) are\n$$\nr_{1} := \\frac{\\alpha + \\sqrt{\\alpha^{2}+4\\mu\\gamma}}{2\\mu}, \\qquad r_{2} := \\frac{\\alpha - \\sqrt{\\alpha^{2}+4\\mu\\gamma}}{2\\mu}.\n$$\nA convenient pair of homogeneous solutions that enforce the Dirichlet boundary conditions at the element endpoints are\n$$\n\\varphi(x) := \\exp(r_{1}x) - \\exp(r_{2}x), \\qquad \\psi(x) := \\exp(r_{1}x)\\exp(-r_{1}h) - \\exp(r_{2}x)\\exp(-r_{2}h),\n$$\nwhich satisfy $\\varphi(0)=0$ and $\\psi(h)=0$. The Green’s function is constructed piecewise by matching continuity and the jump condition in the first derivative at $x=\\xi$ implied by the Dirac distribution. Specifically, continuity requires\n$$\n\\lim_{x\\to \\xi^{-}}G_{K}(x,\\xi) = \\lim_{x\\to \\xi^{+}}G_{K}(x,\\xi),\n$$\nand integrating $\\mathcal{L}_{x}G_{K}(x,\\xi)=\\delta(x-\\xi)$ over a small interval around $\\xi$ yields the jump condition\n$$\n-\\mu\\left(\\frac{\\partial G_{K}}{\\partial x}(\\xi^{+},\\xi) - \\frac{\\partial G_{K}}{\\partial x}(\\xi^{-},\\xi)\\right) = 1.\n$$\nA standard construction in terms of $\\varphi$ and $\\psi$ gives\n$$\nG_{K}(x,\\xi) =\n\\begin{cases}\nA(\\xi)\\,\\varphi(x), & x<\\xi,\\\n$$4pt]\nB(\\xi)\\,\\psi(x), & x>\\xi,\n\\end{cases}\n$$\nwith $A(\\xi)$ and $B(\\xi)$ chosen to enforce continuity and the jump. Solving for $A(\\xi)$ and $B(\\xi)$ using the Wronskian at $x=\\xi$,\n$$\nW(\\varphi,\\psi)(\\xi) := \\varphi(\\xi)\\psi'(\\xi) - \\varphi'(\\xi)\\psi(\\xi),\n$$\nwe obtain\n$$\nA(\\xi) = -\\frac{\\psi(\\xi)}{\\mu\\,W(\\varphi,\\psi)(\\xi)}, \\qquad B(\\xi) = -\\frac{\\varphi(\\xi)}{\\mu\\,W(\\varphi,\\psi)(\\xi)}.\n$$\nWe compute $W(\\varphi,\\psi)(\\xi)$ explicitly. Denote $A_{1}:=\\exp(r_{1}\\xi)$ and $A_{2}:=\\exp(r_{2}\\xi)$ for brevity. Then\n$$\n\\varphi(\\xi) = A_{1}-A_{2}, \\quad \\varphi'(\\xi) = r_{1}A_{1} - r_{2}A_{2}, \\quad\n\\psi(\\xi) = A_{1}\\exp(-r_{1}h) - A_{2}\\exp(-r_{2}h), \\quad \\psi'(\\xi) = r_{1}A_{1}\\exp(-r_{1}h) - r_{2}A_{2}\\exp(-r_{2}h).\n$$\nA direct calculation gives\n$$\nW(\\varphi,\\psi)(\\xi) = (r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big).\n$$\nTherefore,\n$$\nG_{K}(x,\\xi) =\n-\\frac{1}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big)}\n\\begin{cases}\n\\psi(\\xi)\\,\\varphi(x), & x<\\xi,\\\n$$4pt]\n\\varphi(\\xi)\\,\\psi(x), & x>\\xi.\n\\end{cases}\n$$\nTo present $G_{K}$ as a single expression, we use the Heaviside step function $H(s)$, with $H(s)=1$ for $s>0$ and $H(s)=0$ otherwise:\n$$\nG_{K}(x,\\xi) =\n-\\frac{\\psi(\\xi)\\,\\varphi(x)\\,H(\\xi-x) + \\varphi(\\xi)\\,\\psi(x)\\,H(x-\\xi)}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big)}.\n$$\n\nWe now define the bubble via convolution with the constant residual $R$:\n$$\nb_{K}(x) := \\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi.\n$$\nValidation that $b_{K}$ solves the local problem follows directly from the defining properties of $G_{K}$. In the distributional sense,\n$$\n\\mathcal{L} b_{K}(x) = \\mathcal{L}\\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi = \\int_{0}^{h} \\mathcal{L}_{x} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi = \\int_{0}^{h} \\delta(x-\\xi)\\,R\\,\\mathrm{d}\\xi = R,\n$$\nand since $G_{K}(0,\\xi)=G_{K}(h,\\xi)=0$ for all $\\xi$, we have $b_{K}(0)=b_{K}(h)=0$. Thus $b_{K}$ satisfies\n$$\n-\\mu\\,b_{K}'' + \\alpha\\,b_{K}' + \\gamma\\,b_{K} = R, \\qquad b_{K}(0)=b_{K}(h)=0.\n$$\nBecause $\\gamma>0$ and $\\mu>0$, the boundary value problem has a unique solution; hence the convoluted bubble is the unique bubble that annihilates the constant residual.\n\nWe now compute $b_{K}(x)$ in closed form by solving the ordinary differential equation directly. A particular solution for the constant right-hand side $R$ is $b_{p}(x)\\equiv R/\\gamma$. The general homogeneous solution is $b_{h}(x)=C_{1}\\exp(r_{1}x)+C_{2}\\exp(r_{2}x)$. Therefore\n$$\nb_{K}(x) = C_{1}\\exp(r_{1}x) + C_{2}\\exp(r_{2}x) + \\frac{R}{\\gamma}.\n$$\nImposing $b_{K}(0)=0$ and $b_{K}(h)=0$ yields\n$$\nC_{1}+C_{2} = -\\frac{R}{\\gamma}, \\qquad C_{1}\\exp(r_{1}h) + C_{2}\\exp(r_{2}h) = -\\frac{R}{\\gamma}.\n$$\nSolving these two linear equations for $C_{1}$ and $C_{2}$ gives\n$$\nC_{1} = \\frac{R}{\\gamma}\\,\\frac{\\exp(r_{2}h)-1}{\\exp(r_{1}h)-\\exp(r_{2}h)}, \\qquad\nC_{2} = \\frac{R}{\\gamma}\\,\\frac{1-\\exp(r_{1}h)}{\\exp(r_{1}h)-\\exp(r_{2}h)}.\n$$\nThus the closed-form bubble is\n$$\nb_{K}(x) = \\frac{R}{\\gamma}\\left[ 1 + \\frac{\\big(\\exp(r_{2}h)-1\\big)\\exp(r_{1}x) + \\big(1-\\exp(r_{1}h)\\big)\\exp(r_{2}x)}{\\exp(r_{1}h)-\\exp(r_{2}h)} \\right].\n$$\nBy uniqueness, this expression coincides with the convolution $b_{K}(x)=\\int_{0}^{h}G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi$. This completes the explicit computation of $G_{K}$ and the validation and closed-form computation of the residual-free bubble $b_{K}$ for a constant residual on $K=(0,h)$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{\\big(\\exp(r_{1}\\xi)\\exp(-r_{1}h)-\\exp(r_{2}\\xi)\\exp(-r_{2}h)\\big)\\big(\\exp(r_{1}x)-\\exp(r_{2}x)\\big)\\,H(\\xi-x)\\;+\\;\\big(\\exp(r_{1}\\xi)-\\exp(r_{2}\\xi)\\big)\\big(\\exp(r_{1}x)\\exp(-r_{1}h)-\\exp(r_{2}x)\\exp(-r_{2}h)\\big)\\,H(x-\\xi)}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h)-\\exp(-r_{1}h)\\big)} \\;\\; & \\;\\; \\dfrac{R}{\\gamma}\\left[ 1 + \\dfrac{\\big(\\exp(r_{2}h)-1\\big)\\exp(r_{1}x) + \\big(1-\\exp(r_{1}h)\\big)\\exp(r_{2}x)}{\\exp(r_{1}h)-\\exp(r_{2}h)} \\right]\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "Moving from a direct 1D solution, this practice explores a more general method applicable to higher dimensions and complex geometries . We will consider a pure diffusion problem on a two-dimensional triangular element and derive the bubble function using a spectral decomposition. This approach reveals the bubble as a series expansion in the eigenfunctions of the Dirichlet Laplacian, illustrating how the bubble's structure is intrinsically linked to the harmonic modes of the element's domain.",
            "id": "3804200",
            "problem": "Consider a two-dimensional bounded triangular element $K \\subset \\mathbb{R}^{2}$ with Lipschitz boundary $\\partial K$. In residual-free bubble enrichment for multiscale modeling and analysis, the interior bubble $b_{K}$ is defined as the unique function satisfying the local Dirichlet problem\n$$\n-\\epsilon \\Delta b_{K} = r_{K} \\quad \\text{in } K, \\qquad b_{K} = 0 \\quad \\text{on } \\partial K,\n$$\nwhere $\\epsilon > 0$ is the diffusion coefficient and $r_{K} \\in L^{2}(K)$ is the elementwise residual in the case of vanishing advection $\\boldsymbol{\\beta} = \\boldsymbol{0}$. Let $\\{ \\phi_{n} \\}_{n=1}^{\\infty}$ be a complete orthonormal set in $L^{2}(K)$ consisting of the Dirichlet Laplacian eigenfunctions on the triangle, that is, each $\\phi_{n}$ satisfies\n$$\n-\\Delta \\phi_{n} = \\lambda_{n} \\phi_{n} \\quad \\text{in } K, \\qquad \\phi_{n} = 0 \\quad \\text{on } \\partial K,\n$$\nwith eigenvalues $\\{ \\lambda_{n} \\}_{n=1}^{\\infty}$ such that $\\lambda_{n} > 0$ for all $n$, and $\\{ \\phi_{n} \\}_{n=1}^{\\infty}$ is orthonormal in $L^{2}(K)$ with respect to the standard inner product\n$$\n(u,v)_{L^{2}(K)} := \\int_{K} u(x) v(x) \\, \\mathrm{d}x.\n$$\nStarting from the fundamental properties of the self-adjoint, positive definite Dirichlet Laplacian $-\\Delta$ on $K$, and employing only well-tested facts from spectral theory and the calculus of variations, derive the closed-form expression for $b_{K}(x)$ in terms of the triangle’s harmonic basis $\\{ \\phi_{n} \\}$ and the residual $r_{K}$. Your final answer must be a single analytic expression for $b_{K}(x)$ and should not include any unspecified constants. No numerical approximation is required; provide the exact series representation.",
            "solution": "The objective is to find the closed-form series representation for the bubble function $b_K(x)$ in terms of the given orthonormal basis $\\{\\phi_n\\}_{n=1}^{\\infty}$.\n\nThe set of functions $\\{\\phi_{n}\\}_{n=1}^{\\infty}$ forms a complete orthonormal basis for the Hilbert space $L^{2}(K)$. Therefore, any function $f \\in L^{2}(K)$ can be uniquely represented by its Fourier series expansion with respect to this basis.\n\nFirst, we expand the residual function $r_{K} \\in L^{2}(K)$ in this basis:\n$$ r_{K}(x) = \\sum_{m=1}^{\\infty} c_{m} \\phi_{m}(x) $$\nThe coefficients $c_m$ are determined by taking the inner product of $r_K$ with each basis function $\\phi_{m}$, exploiting the orthonormality of the basis:\n$$ c_{m} = (r_{K}, \\phi_{m})_{L^{2}(K)} = \\int_{K} r_{K}(x) \\phi_{m}(x) \\, \\mathrm{d}x $$\n\nNext, we seek a solution $b_K(x)$ for the given Dirichlet problem. Since the solution $b_K$ must satisfy the homogeneous boundary condition $b_K = 0$ on $\\partial K$, and all basis functions $\\phi_n$ also satisfy this condition, it is natural to represent $b_K$ as a series in this basis. We assume the solution takes the form:\n$$ b_{K}(x) = \\sum_{n=1}^{\\infty} a_{n} \\phi_{n}(x) $$\nwhere the coefficients $a_n$ are to be determined.\n\nWe substitute these series representations for $b_K$ and $r_K$ into the governing partial differential equation, $-\\epsilon \\Delta b_{K} = r_{K}$:\n$$ -\\epsilon \\Delta \\left( \\sum_{n=1}^{\\infty} a_{n} \\phi_{n}(x) \\right) = \\sum_{m=1}^{\\infty} c_{m} \\phi_{m}(x) $$\n\nAssuming sufficient regularity to interchange the differential operator and the summation, we apply the Laplacian to each term in the series for $b_K$:\n$$ \\sum_{n=1}^{\\infty} a_{n} (-\\epsilon \\Delta \\phi_{n}(x)) = \\sum_{m=1}^{\\infty} c_{m} \\phi_{m}(x) $$\n\nWe now use the defining property of the eigenfunctions $\\phi_n$, which is $-\\Delta \\phi_{n} = \\lambda_{n} \\phi_{n}$:\n$$ \\sum_{n=1}^{\\infty} a_{n} (\\epsilon \\lambda_{n} \\phi_{n}(x)) = \\sum_{m=1}^{\\infty} c_{m} \\phi_{m}(x) $$\n\nThis equation represents the equality of two functions in $L^2(K)$, both expressed in the same orthonormal basis. Due to the uniqueness of such expansions, the coefficients of corresponding basis functions must be equal. To show this formally, we take the $L^2(K)$ inner product of both sides with an arbitrary basis function $\\phi_k(x)$:\n$$ \\left( \\sum_{n=1}^{\\infty} \\epsilon \\lambda_{n} a_{n} \\phi_{n}, \\phi_{k} \\right)_{L^{2}(K)} = \\left( \\sum_{m=1}^{\\infty} c_{m} \\phi_{m}, \\phi_{k} \\right)_{L^{2}(K)} $$\n\nBy the linearity of the inner product:\n$$ \\sum_{n=1}^{\\infty} \\epsilon \\lambda_{n} a_{n} (\\phi_{n}, \\phi_{k})_{L^{2}(K)} = \\sum_{m=1}^{\\infty} c_{m} (\\phi_{m}, \\phi_{k})_{L^{2}(K)} $$\n\nUsing the orthonormality property $(\\phi_i, \\phi_j)_{L^{2}(K)} = \\delta_{ij}$:\n$$ \\sum_{n=1}^{\\infty} \\epsilon \\lambda_{n} a_{n} \\delta_{nk} = \\sum_{m=1}^{\\infty} c_{m} \\delta_{mk} $$\n\nThe sums collapse, as only the terms where $n=k$ on the left side and $m=k$ on the right side are non-zero:\n$$ \\epsilon \\lambda_{k} a_{k} = c_{k} $$\n\nWe can now solve for the unknown coefficient $a_k$. Since $\\epsilon > 0$ and $\\lambda_k > 0$ for all $k \\geq 1$, the term $\\epsilon \\lambda_k$ is never zero.\n$$ a_{k} = \\frac{c_{k}}{\\epsilon \\lambda_{k}} $$\n\nSubstituting the expression for $c_k = (r_K, \\phi_k)_{L^{2}(K)}$:\n$$ a_{k} = \\frac{(r_{K}, \\phi_{k})_{L^{2}(K)}}{\\epsilon \\lambda_{k}} $$\n\nFinally, we substitute this expression for the coefficients back into the series expansion for $b_K(x)$. Changing the index from $k$ to $n$ for notational consistency yields the final expression for the bubble function:\n$$ b_{K}(x) = \\sum_{n=1}^{\\infty} a_{n} \\phi_{n}(x) = \\sum_{n=1}^{\\infty} \\frac{(r_{K}, \\phi_{n})_{L^{2}(K)}}{\\epsilon \\lambda_{n}} \\phi_{n}(x) $$\nThis is the closed-form series solution for $b_K(x)$ in terms of the specified basis and residual.",
            "answer": "$$\n\\boxed{\nb_{K}(x) = \\sum_{n=1}^{\\infty} \\frac{(r_{K}, \\phi_{n})_{L^{2}(K)}}{\\epsilon \\lambda_{n}} \\phi_{n}(x)\n}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap from the continuous PDE formulation to the discrete algebraic system used in finite element analysis . We will analyze the block structure of the stiffness matrix that arises when a finite element space is enriched with bubble functions. By performing static condensation to eliminate the bubble unknowns, you will derive the resulting stabilization matrix, revealing precisely how the influence of the subgrid scales is mathematically transferred to the coarse-scale equations.",
            "id": "3804219",
            "problem": "Consider a single finite element $T \\subset \\mathbb{R}^{d}$ on which the scalar advection–diffusion–reaction boundary value problem is posed: find $u$ such that $-\\nabla \\cdot (\\kappa \\nabla u) + \\boldsymbol{\\beta} \\cdot \\nabla u + \\sigma u = f$ in $T$ and $u$ agrees with a prescribed trace on $\\partial T$. Here, $\\kappa \\in \\mathbb{R}^{+}$ is the isotropic diffusion coefficient, $\\boldsymbol{\\beta} \\in \\mathbb{R}^{d}$ is the advection velocity, and $\\sigma \\in \\mathbb{R}$ is the reaction coefficient. Let the standard Galerkin variational bilinear form on $T$ be $a(w,v) = \\int_{T} \\kappa \\nabla w \\cdot \\nabla v \\,\\mathrm{d}x + \\int_{T} (\\boldsymbol{\\beta} \\cdot \\nabla w) v \\,\\mathrm{d}x + \\int_{T} \\sigma w v \\,\\mathrm{d}x$ with linear functional $\\ell(v) = \\int_{T} f v \\,\\mathrm{d}x$.\n\nAugment the coarse finite element space $V_{c}$ (spanned locally on $T$ by shape functions $\\{\\phi_{i}\\}_{i=1}^{n_{c}}$ that may be nonzero on $\\partial T$) with a bubble subscale space $V_{b}$ (spanned on $T$ by interior bubble basis functions $\\{b_{\\alpha}\\}_{\\alpha=1}^{n_{b}}$ that vanish on $\\partial T$), forming $V_{h} = V_{c} \\oplus V_{b}$. The element-level algebraic system in block form for trial coefficients $(\\boldsymbol{u}_{c}, \\boldsymbol{u}_{b}) \\in \\mathbb{R}^{n_{c}} \\times \\mathbb{R}^{n_{b}}$ and test weights $(\\boldsymbol{v}_{c}, \\boldsymbol{v}_{b}) \\in \\mathbb{R}^{n_{c}} \\times \\mathbb{R}^{n_{b}}$ is given by\n$$\n\\begin{pmatrix}\nK_{cc} & K_{cb} \\\\\nK_{bc} & K_{bb}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{u}_{c} \\\\\n\\boldsymbol{u}_{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\boldsymbol{f}_{c} \\\\\n\\boldsymbol{f}_{b}\n\\end{pmatrix},\n$$\nwhere $K_{cc} \\in \\mathbb{R}^{n_{c} \\times n_{c}}$, $K_{cb} \\in \\mathbb{R}^{n_{c} \\times n_{b}}$, $K_{bc} \\in \\mathbb{R}^{n_{b} \\times n_{c}}$, $K_{bb} \\in \\mathbb{R}^{n_{b} \\times n_{b}}$, and $\\boldsymbol{f}_{c} \\in \\mathbb{R}^{n_{c}}$, $\\boldsymbol{f}_{b} \\in \\mathbb{R}^{n_{b}}$ are defined by the bilinear and linear forms $a(\\cdot,\\cdot)$ and $\\ell(\\cdot)$ with respect to $(V_{c}, V_{b})$.\n\nAssume the bubble stiffness matrix $K_{bb}$ is invertible and consider the Residual-Free Bubble (RFB) choice in which bubble unknowns are determined locally so that the interior residual vanishes. Perform exact static condensation of the bubble unknowns and define the condensed coarse-scale stiffness on $T$ as $K_{cc}^{\\mathrm{cond}} = K_{cc} + S$, where $S \\in \\mathbb{R}^{n_{c} \\times n_{c}}$ is the stabilization block induced by eliminating the bubble unknowns. Let $\\boldsymbol{p}_{i} \\in \\mathbb{R}^{n_{b}}$ denote the $i$-th column-vector coupling of $K_{cb}^{\\top}$ with the coarse basis $\\phi_{i}$, i.e., $\\boldsymbol{p}_{i} = (K_{cb})_{i,:}^{\\top}$, and let $\\boldsymbol{g}_{j} \\in \\mathbb{R}^{n_{b}}$ denote the $j$-th column of $K_{bc}$, i.e., $\\boldsymbol{g}_{j} = (K_{bc})_{:,j}$.\n\nDerive a closed-form analytic expression for the stabilization block $S$ in matrix form in terms of $K_{bb}$, $K_{cb}$, and $K_{bc}$, and equivalently in component form using the coupling vectors $\\boldsymbol{p}_{i}$ and $\\boldsymbol{g}_{j}$. Your final answer must be a single symbolic expression for $S$.",
            "solution": "The problem requires the derivation of the stabilization block $S$ that arises from the static condensation of bubble unknowns. We begin with the provided element-level algebraic system in block form:\n$$\n\\begin{pmatrix}\nK_{cc} & K_{cb} \\\\\nK_{bc} & K_{bb}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{u}_{c} \\\\\n\\boldsymbol{u}_{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\boldsymbol{f}_{c} \\\\\n\\boldsymbol{f}_{b}\n\\end{pmatrix}\n$$\nThis block system consists of two matrix equations:\n1. $K_{cc} \\boldsymbol{u}_{c} + K_{cb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{c}$\n2. $K_{bc} \\boldsymbol{u}_{c} + K_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b}$\n\nThe second equation, $K_{bc} \\boldsymbol{u}_{c} + K_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b}$, represents the weak form of the PDE residual projected onto the bubble space $V_b$. The \"Residual-Free Bubble\" approach, in this context, entails solving this equation to determine the bubble coefficient vector $\\boldsymbol{u}_{b}$ in terms of the coarse-scale unknowns $\\boldsymbol{u}_{c}$ and the bubble-projected right-hand side $\\boldsymbol{f}_{b}$.\n\nWe rearrange the second equation to solve for $\\boldsymbol{u}_{b}$:\n$$\nK_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c}\n$$\nThe problem states that the bubble stiffness matrix $K_{bb}$ is invertible. Therefore, we can pre-multiply by its inverse, $K_{bb}^{-1}$, to obtain an explicit expression for $\\boldsymbol{u}_{b}$:\n$$\n\\boldsymbol{u}_{b} = K_{bb}^{-1} (\\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c})\n$$\nThis expression defines the bubble unknowns entirely in terms of coarse-scale quantities on the element $T$. The process of eliminating the bubble unknowns in this manner is known as static condensation.\n\nNext, we substitute this expression for $\\boldsymbol{u}_{b}$ back into the first equation of the block system, $K_{cc} \\boldsymbol{u}_{c} + K_{cb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{c}$:\n$$\nK_{cc} \\boldsymbol{u}_{c} + K_{cb} \\left( K_{bb}^{-1} (\\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c}) \\right) = \\boldsymbol{f}_{c}\n$$\nWe distribute the term $K_{cb}$ and rearrange the equation to gather all terms involving the coarse-scale unknowns $\\boldsymbol{u}_{c}$ on the left-hand side and all other terms (the modified force vector) on the right-hand side:\n$$\nK_{cc} \\boldsymbol{u}_{c} + K_{cb} K_{bb}^{-1} \\boldsymbol{f}_{b} - K_{cb} K_{bb}^{-1} K_{bc} \\boldsymbol{u}_{c} = \\boldsymbol{f}_{c}\n$$\n$$\n(K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}) \\boldsymbol{u}_{c} = \\boldsymbol{f}_{c} - K_{cb} K_{bb}^{-1} \\boldsymbol{f}_{b}\n$$\nThis equation is the condensed system for the coarse-scale unknowns $\\boldsymbol{u}_{c}$. The matrix multiplying $\\boldsymbol{u}_{c}$ on the left-hand side is the condensed coarse-scale stiffness matrix, denoted as $K_{cc}^{\\mathrm{cond}}$.\n$$\nK_{cc}^{\\mathrm{cond}} = K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}\n$$\nThe problem defines the condensed stiffness as $K_{cc}^{\\mathrm{cond}} = K_{cc} + S$, where $S$ is the stabilization block. By comparing our derived result with this definition, we can identify $S$:\n$$\nK_{cc} + S = K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}\n$$\nSubtracting $K_{cc}$ from both sides yields the expression for the stabilization block in matrix form:\n$$\nS = - K_{cb} K_{bb}^{-1} K_{bc}\n$$\nThis is the required expression for $S$ in matrix form.\n\nTo find the expression in component form, we consider the $(i,j)$-th entry of the matrix $S$, denoted $S_{ij}$. This entry is obtained by multiplying the $i$-th row of $-K_{cb}$, the matrix $K_{bb}^{-1}$, and the $j$-th column of $K_{bc}$.\nThe problem defines:\n- $\\boldsymbol{p}_{i} = (K_{cb})_{i,:}^{\\top}$: the $i$-th column of $K_{cb}^{\\top}$. This implies that the $i$-th row of $K_{cb}$ is $\\boldsymbol{p}_{i}^{\\top}$.\n- $\\boldsymbol{g}_{j} = (K_{bc})_{:,j}$: the $j$-th column of $K_{bc}$.\n\nUsing these definitions, we can write the component $S_{ij}$ as:\n$$\nS_{ij} = - (\\boldsymbol{p}_{i}^{\\top}) (K_{bb}^{-1}) (\\boldsymbol{g}_{j})\n$$\nwhere $\\boldsymbol{p}_{i}^{\\top}$ is a $1 \\times n_b$ row vector, $K_{bb}^{-1}$ is an $n_b \\times n_b$ matrix, and $\\boldsymbol{g}_{j}$ is an $n_b \\times 1$ column vector. The product yields a scalar value, as expected for a matrix component.\n\nThe question asks for a single symbolic expression for $S$. The matrix form is the most direct and standard representation.",
            "answer": "$$\n\\boxed{- K_{cb} K_{bb}^{-1} K_{bc}}\n$$"
        }
    ]
}