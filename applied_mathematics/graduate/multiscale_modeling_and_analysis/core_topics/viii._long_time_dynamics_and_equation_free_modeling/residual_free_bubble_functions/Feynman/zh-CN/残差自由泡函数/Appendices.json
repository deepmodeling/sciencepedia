{
    "hands_on_practices": [
        {
            "introduction": "第一个练习是构建理解的基础。我们将在一维最简单的设置（所有系数和残差均为常数）下，显式计算一个无残差气泡函数。通过将基于格林函数的抽象定义与求解常微分方程得到的具体解联系起来，该练习旨在巩固核心概念。",
            "id": "3804185",
            "problem": "考虑在开单元 $K=(0,h)$ 上的具有常系数的一维对流-扩散-反应算子\n$$\n\\mathcal{L} u := -\\mu\\,\\frac{\\mathrm{d}^{2}u}{\\mathrm{d}x^{2}} + \\alpha\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x} + \\gamma\\,u,\n$$\n其中 $\\mu>0$，$\\alpha\\in\\mathbb{R}$ 且 $\\gamma>0$。无残差气泡 (Residual-Free Bubble, RFB) 方法寻求一个单元气泡 $b_{K}$，通过求解局部边值问题来消除给定的单元残差 $R$\n$$\n\\mathcal{L} b_{K} = R \\quad \\text{在 } K \\text{ 中}, \\qquad b_{K}(0)=0, \\quad b_{K}(h)=0,\n$$\n其中 $R$ 在 $K$ 上为常数。单元 $K$ 上 $\\mathcal{L}$ 的单元格林函数 $G_{K}(x,\\xi)$ 定义为\n$$\n\\mathcal{L}_{x} G_{K}(x,\\xi) = \\delta(x-\\xi), \\qquad G_{K}(0,\\xi)=0, \\quad G_{K}(h,\\xi)=0,\n$$\n其中 $\\delta$ 是狄拉克分布，$\\mathcal{L}_{x}$ 表示 $\\mathcal{L}$ 作用于空间变量 $x$。\n\n从线性微分算子和分布理论的基本法则出发，并仅利用 $\\mathcal{L}$ 的常系数结构，推导单元格林函数 $G_{K}(x,\\xi)$ 的显式表达式。然后，将 RFB 气泡定义为卷积\n$$\nb_{K}(x) := \\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi,\n$$\n并通过证明它能解上述局部边值问题，来验证其对于常数残差的有效性。最后，计算 $b_{K}(x)$ 的闭式解。所有指数函数使用 $\\exp(\\cdot)$ 表示，并定义您引入的任何辅助量。如果您需要分段表示，可以使用亥维赛德阶跃函数 $H(s)$，约定当 $s>0$ 时 $H(s)=1$，当 $s\\le 0$ 时 $H(s)=0$。\n\n您的最终答案必须是单个解析表达式，或者如果需要多个表达式，请使用 $\\mathrm{pmatrix}$ 环境将其表示为单行矩阵。不需要进行数值计算。",
            "solution": "我们从常系数二阶算子开始\n$$\n\\mathcal{L} u := -\\mu\\,u'' + \\alpha\\,u' + \\gamma\\,u,\n$$\n其中 $\\mu>0$，$\\alpha\\in\\mathbb{R}$ 且 $\\gamma>0$ 在 $K=(0,h)$上。单元格林函数 $G_{K}(x,\\xi)$ 定义为满足\n$$\n\\mathcal{L}_{x} G_{K}(x,\\xi) = \\delta(x-\\xi), \\qquad G_{K}(0,\\xi)=0, \\quad G_{K}(h,\\xi)=0.\n$$\n对于 $x\\neq \\xi$，$G_{K}(\\cdot,\\xi)$ 满足齐次方程\n$$\n-\\mu\\,y'' + \\alpha\\,y' + \\gamma\\,y = 0,\n$$\n其特征方程为\n$$\n-\\mu r^{2} + \\alpha r + \\gamma = 0 \\quad \\Longleftrightarrow \\quad \\mu r^{2} - \\alpha r - \\gamma = 0.\n$$\n两个不同的实根（因为 $\\alpha^{2}+4\\mu\\gamma>0$）是\n$$\nr_{1} := \\frac{\\alpha + \\sqrt{\\alpha^{2}+4\\mu\\gamma}}{2\\mu}, \\qquad r_{2} := \\frac{\\alpha - \\sqrt{\\alpha^{2}+4\\mu\\gamma}}{2\\mu}.\n$$\n一对方便的、满足单元端点处狄利克雷边界条件的齐次解是\n$$\n\\varphi(x) := \\exp(r_{1}x) - \\exp(r_{2}x), \\qquad \\psi(x) := \\exp(r_{1}x)\\exp(-r_{1}h) - \\exp(r_{2}x)\\exp(-r_{2}h),\n$$\n它们满足 $\\varphi(0)=0$ 和 $\\psi(h)=0$。格林函数是通过在 $x=\\xi$ 处匹配连续性以及由狄拉克分布所隐含的一阶导数跳跃条件来分段构造的。具体来说，连续性要求\n$$\n\\lim_{x\\to \\xi^{-}}G_{K}(x,\\xi) = \\lim_{x\\to \\xi^{+}}G_{K}(x,\\xi),\n$$\n将 $\\mathcal{L}_{x}G_{K}(x,\\xi)=\\delta(x-\\xi)$ 在 $\\xi$ 附近的一个小区间上积分，得到跳跃条件\n$$\n-\\mu\\left(\\frac{\\partial G_{K}}{\\partial x}(\\xi^{+},\\xi) - \\frac{\\partial G_{K}}{\\partial x}(\\xi^{-},\\xi)\\right) = 1.\n$$\n一个标准的、用 $\\varphi$ 和 $\\psi$ 表示的构造给出\n$$\nG_{K}(x,\\xi) =\n\\begin{cases}\nA(\\xi)\\,\\varphi(x),  x  \\xi, \\\\\nB(\\xi)\\,\\psi(x),  x > \\xi,\n\\end{cases}\n$$\n其中选择 $A(\\xi)$ 和 $B(\\xi)$ 以满足连续性和跳跃条件。利用在 $x=\\xi$ 处的朗斯基行列式\n$$\nW(\\varphi,\\psi)(\\xi) := \\varphi(\\xi)\\psi'(\\xi) - \\varphi'(\\xi)\\psi(\\xi),\n$$\n求解 $A(\\xi)$ 和 $B(\\xi)$，我们得到\n$$\nA(\\xi) = -\\frac{\\psi(\\xi)}{\\mu\\,W(\\varphi,\\psi)(\\xi)}, \\qquad B(\\xi) = -\\frac{\\varphi(\\xi)}{\\mu\\,W(\\varphi,\\psi)(\\xi)}.\n$$\n我们显式地计算 $W(\\varphi,\\psi)(\\xi)$。为简洁起见，记 $A_{1}:=\\exp(r_{1}\\xi)$ 和 $A_{2}:=\\exp(r_{2}\\xi)$。那么\n$$\n\\varphi(\\xi) = A_{1}-A_{2}, \\quad \\varphi'(\\xi) = r_{1}A_{1} - r_{2}A_{2}, \\quad\n\\psi(\\xi) = A_{1}\\exp(-r_{1}h) - A_{2}\\exp(-r_{2}h), \\quad \\psi'(\\xi) = r_{1}A_{1}\\exp(-r_{1}h) - r_{2}A_{2}\\exp(-r_{2}h).\n$$\n直接计算可得\n$$\nW(\\varphi,\\psi)(\\xi) = (r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big).\n$$\n因此，\n$$\nG_{K}(x,\\xi) =\n-\\frac{1}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big)}\n\\begin{cases}\n\\psi(\\xi)\\,\\varphi(x),  x  \\xi, \\\\\n\\varphi(\\xi)\\,\\psi(x),  x > \\xi.\n\\end{cases}\n$$\n为了将 $G_{K}$ 表示为单个表达式，我们使用亥维赛德阶跃函数 $H(s)$，其中当 $s0$ 时 $H(s)=1$，否则 $H(s)=0$：\n$$\nG_{K}(x,\\xi) =\n-\\frac{\\psi(\\xi)\\,\\varphi(x)\\,H(\\xi-x) + \\varphi(\\xi)\\,\\psi(x)\\,H(x-\\xi)}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big)}.\n$$\n\n现在我们通过与常数残差 $R$ 的卷积来定义气泡：\n$$\nb_{K}(x) := \\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi.\n$$\n验证 $b_{K}$ 能解局部问题是 $G_{K}$ 定义属性的直接推论。在分布意义下，\n$$\n\\mathcal{L} b_{K}(x) = \\mathcal{L}\\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi = \\int_{0}^{h} \\mathcal{L}_{x} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi = \\int_{0}^{h} \\delta(x-\\xi)\\,R\\,\\mathrm{d}\\xi = R,\n$$\n并且由于对所有 $\\xi$ 都有 $G_{K}(0,\\xi)=G_{K}(h,\\xi)=0$，我们得到 $b_{K}(0)=b_{K}(h)=0$。因此 $b_{K}$ 满足\n$$\n-\\mu\\,b_{K}'' + \\alpha\\,b_{K}' + \\gamma\\,b_{K} = R, \\qquad b_{K}(0)=b_{K}(h)=0.\n$$\n因为 $\\gamma0$ 且 $\\mu0$，该边值问题有唯一解；因此该卷积气泡是消除常数残差的唯一气泡。\n\n现在我们通过直接求解常微分方程来计算 $b_{K}(x)$ 的闭式解。对于常数右端项 $R$，一个特解是 $b_{p}(x)\\equiv R/\\gamma$。通用的齐次解是 $b_{h}(x)=C_{1}\\exp(r_{1}x)+C_{2}\\exp(r_{2}x)$。因此\n$$\nb_{K}(x) = C_{1}\\exp(r_{1}x) + C_{2}\\exp(r_{2}x) + \\frac{R}{\\gamma}.\n$$\n施加 $b_{K}(0)=0$ 和 $b_{K}(h)=0$ 可得\n$$\nC_{1}+C_{2} = -\\frac{R}{\\gamma}, \\qquad C_{1}\\exp(r_{1}h) + C_{2}\\exp(r_{2}h) = -\\frac{R}{\\gamma}.\n$$\n求解这两个关于 $C_{1}$ 和 $C_{2}$ 的线性方程组可得\n$$\nC_{1} = \\frac{R}{\\gamma}\\,\\frac{\\exp(r_{2}h)-1}{\\exp(r_{1}h)-\\exp(r_{2}h)}, \\qquad\nC_{2} = \\frac{R}{\\gamma}\\,\\frac{1-\\exp(r_{1}h)}{\\exp(r_{1}h)-\\exp(r_{2}h)}.\n$$\n因此，闭式解的气泡是\n$$\nb_{K}(x) = \\frac{R}{\\gamma}\\left[ 1 + \\frac{\\big(\\exp(r_{2}h)-1\\big)\\exp(r_{1}x) + \\big(1-\\exp(r_{1}h)\\big)\\exp(r_{2}x)}{\\exp(r_{1}h)-\\exp(r_{2}h)} \\right].\n$$\n根据唯一性，这个表达式与卷积 $b_{K}(x)=\\int_{0}^{h}G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi$ 一致。这就完成了在 $K=(0,h)$ 上对常数残差的单元格林函数 $G_{K}$ 的显式计算，以及无残差气泡 $b_{K}$ 的验证和闭式解计算。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{\\big(\\exp(r_{1}\\xi)\\exp(-r_{1}h)-\\exp(r_{2}\\xi)\\exp(-r_{2}h)\\big)\\big(\\exp(r_{1}x)-\\exp(r_{2}x)\\big)\\,H(\\xi-x)\\;+\\;\\big(\\exp(r_{1}\\xi)-\\exp(r_{2}\\xi)\\big)\\big(\\exp(r_{1}x)\\exp(-r_{1}h)-\\exp(r_{2}x)\\exp(-r_{2}h)\\big)\\,H(x-\\xi)}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h)-\\exp(-r_{1}h)\\big)} \\;\\;  \\;\\; \\dfrac{R}{\\gamma}\\left[ 1 + \\dfrac{\\big(\\exp(r_{2}h)-1\\big)\\exp(r_{1}x) + \\big(1-\\exp(r_{1}h)\\big)\\exp(r_{2}x)}{\\exp(r_{1}h)-\\exp(r_{2}h)} \\right]\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "在基础案例之上，这个练习引入了一个更贴近实际的非恒定残差。主要目标是推导对流扩散问题的气泡函数，更重要的是，诠释其解析形式。通过分析解对佩克莱数（Péclet number）的依赖关系，您将深入理解气泡函数如何自动调整其形状以捕捉对流主导情况下的边界层等尖锐梯度。",
            "id": "3804226",
            "problem": "考虑一维稳态对流扩散模型，定义在有限元（单元）$K = (0,h)$上，其对流系数为 $\\beta \\in \\mathbb{R}\\setminus\\{0\\}$，扩散系数为 $\\varepsilon  0$，且无反应项。在无残差气泡 (RFB) 方法中，单元 $K$ 上的局部气泡 $b_K(x)$ 被定义为一个子尺度问题的解，该问题旨在消除 $K$ 内部的粗尺度残差，同时在 $K$ 的边界上值为零。假设限制在 $K$ 上的粗尺度残差是一个仿射函数 $r_K(x) = a x + b$，其中 $a,b \\in \\mathbb{R}$ 为常数。因此，RFB 局部问题为：求解 $b_K(x)$ 使得\n$$\n-\\varepsilon\\, b_K''(x) + \\beta\\, b_K'(x) = r_K(x) \\quad \\text{for } x \\in (0,h), \\qquad b_K(0)=0,\\quad b_K(h)=0,\n$$\n其中 $\\sigma=0$（无反应）。\n\n从控制算子的定义和无残差气泡子问题的定义出发，推导唯一解 $b_K(x)$ 关于 $a$、$b$、$\\varepsilon$、$\\beta$、$h$ 和 $x$ 的闭式表达式。在推导过程中，为了记法清晰，您可以暂时将残差的截距 $b$ 重命名为 $\\beta_0$，以避免与气泡 $b_K(x)$ 混淆。然后，解释 $b_K(x)$ 的函数形式如何反映 RFB 方法在不同单元佩克莱数 $\\mathrm{Pe}_K = \\beta h/\\varepsilon$ 值下捕捉单元内部梯度的能力。\n\n您的最终答案必须是 $b_K(x)$ 的单一闭式解析表达式，不得进行四舍五入。不需要单位。",
            "solution": "该问题是求解以下二阶常系数线性非齐次常微分方程 (ODE)：\n$$\n-\\varepsilon\\, b_K''(x) + \\beta\\, b_K'(x) = a x + b\n$$\n满足边界条件 $b_K(0)=0$ 和 $b_K(h)=0$。通解 $b_K(x)$ 是齐次解 $b_h(x)$ 和一个特解 $b_p(x)$ 的和。\n\n**1. 齐次解**\n\n齐次方程为 $-\\varepsilon\\, b_h''(x) + \\beta\\, b_h'(x) = 0$。其特征方程为 $-\\varepsilon \\lambda^2 + \\beta \\lambda = 0$，根为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\beta/\\varepsilon$。因此，齐次解为：\n$$\nb_h(x) = C_1 + C_2 \\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right)\n$$\n\n**2. 特解**\n\n由于右端项是线性多项式 $ax+b$ 且 $\\lambda_1=0$ 是一个特征根，我们寻求一个形如 $b_p(x) = K x^2 + M x$ 的特解。将其代入原方程：\n$$\n-\\varepsilon (2K) + \\beta (2Kx + M) = a x + b\n$$\n$$\n(2\\beta K)x + (\\beta M - 2\\varepsilon K) = a x + b\n$$\n通过比较系数，我们得到 $K = \\frac{a}{2\\beta}$ 和 $M = \\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}$。因此，特解为：\n$$\nb_p(x) = \\frac{a}{2\\beta}x^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x\n$$\n\n**3. 通解与边界条件的应用**\n\n通解是 $b_K(x) = b_h(x) + b_p(x)$ 的和：\n$$\nb_K(x) = C_1 + C_2 \\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right) + \\frac{a}{2\\beta}x^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x\n$$\n应用边界条件 $b_K(0)=0$ 可得 $C_1 + C_2 = 0 \\implies C_1 = -C_2$。于是：\n$$\nb_K(x) = C_2\\left(\\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right) - 1\\right) + \\frac{a}{2\\beta}x^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x\n$$\n应用边界条件 $b_K(h)=0$ 来求解 $C_2$：\n$$\nC_2 = - \\frac{\\frac{a}{2\\beta}h^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}\n$$\n将 $C_2$ 代回，得到最终的闭式解：\n$$\nb_K(x) = \\left[ \\frac{a}{2\\beta}x^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x \\right] - \\left[ \\frac{a}{2\\beta}h^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h \\right] \\frac{\\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right) - 1}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}\n$$\n\n### 根据单元佩克莱数的解释\n\n单元佩克莱数 $\\mathrm{Pe}_K = \\frac{\\beta h}{\\varepsilon}$ 是一个无量纲量，它比较了单元 $K$ 内对流速率与扩散速率。$b_K(x)$ 的函数形式揭示了 RFB 方法如何适应不同的物理区域。\n\n**1. 对流主导区域 ($|\\mathrm{Pe}_K| \\gg 1$)：**\n当对流主导时，指数项 $\\exp(\\mathrm{Pe}_K)$ 变得非常大（如果 $\\beta0$）。此时，气泡函数 $b_K(x)$ 会自动形成一个急剧的内部梯度（一个边界层），以在单个单元内捕捉解的多尺度特性。例如，如果 $\\beta  0$，流动方向从左到右。边界层形成于流出边界 $x=h$ 附近，其厚度为 $\\mathcal{O}(\\varepsilon/\\beta)$。该边界层精确地捕捉了由强对流引起的尖锐梯度，从而稳定了数值解。\n\n**2. 扩散主导区域 ($|\\mathrm{Pe}_K| \\ll 1$)：**\n当扩散主导时，$\\mathrm{Pe}_K$ 很小。利用泰勒近似 $\\exp(z) \\approx 1+z$，指数之比近似为 $\\frac{\\exp(\\frac{\\beta x}{\\varepsilon}) - 1}{\\exp(\\frac{\\beta h}{\\varepsilon}) - 1} \\approx \\frac{x}{h}$。解 $b_K(x)$ 趋向于一个更平滑、更对称的二次或三次多项式剖面，这是纯扩散问题解的特征。在这种情况下，气泡捕捉的子网格信息分布在整个单元上，而不是集中在一个狭窄的层中。\n\n总之，无残差气泡 $b_K(x)$ 的解析形式内在地包含了多项式和指数函数的组合，使其能够根据局部单元佩克莱数的值，将其形状从一个宽泛的、类似扩散的剖面自动调整为一个带有边界层的、尖锐的、对流主导的剖面。这种自适应行为是 RFB 方法在多尺度建模中有效性的基石。",
            "answer": "$$\n\\boxed{\\left[ \\frac{a x^2}{2\\beta} + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x \\right] - \\left[ \\frac{a h^2}{2\\beta} + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h \\right] \\frac{\\exp\\left(\\frac{\\beta x}{\\varepsilon}\\right) - 1}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}}\n$$"
        },
        {
            "introduction": "最后的这个练习旨在连接气泡函数的连续理论与其在有限元方法中的实际应用。通过对分块矩阵系统执行静态凝聚，您将推导出消除气泡自由度后产生的稳定项。这个练习揭示了用气泡函数丰富解空间的抽象概念，是如何直接转化为对粗尺度刚度矩阵的具体、可计算的修正。",
            "id": "3804219",
            "problem": "考虑单个有限元 $T \\subset \\mathbb{R}^{d}$，其上设定了标量对流-扩散-反应边值问题：求 $u$ 使得在 $T$ 中有 $-\\nabla \\cdot (\\kappa \\nabla u) + \\boldsymbol{\\beta} \\cdot \\nabla u + \\sigma u = f$，且 $u$ 与 $\\partial T$ 上给定的迹相符。这里，$\\kappa \\in \\mathbb{R}^{+}$ 是各向同性扩散系数，$\\boldsymbol{\\beta} \\in \\mathbb{R}^{d}$ 是对流速度，$\\sigma \\in \\mathbb{R}$ 是反应系数。设 $T$ 上的标准 Galerkin 变分双线性形式为 $a(w,v) = \\int_{T} \\kappa \\nabla w \\cdot \\nabla v \\,\\mathrm{d}x + \\int_{T} (\\boldsymbol{\\beta} \\cdot \\nabla w) v \\,\\mathrm{d}x + \\int_{T} \\sigma w v \\,\\mathrm{d}x$，线性泛函为 $\\ell(v) = \\int_{T} f v \\,\\mathrm{d}x$。\n\n用一个气泡子尺度空间 $V_{b}$（在 $T$ 上由在 $\\partial T$ 上为零的内部气泡基函数 $\\{b_{\\alpha}\\}_{\\alpha=1}^{n_{b}}$ 张成）来扩充粗有限元空间 $V_{c}$（在 $T$ 上局部地由在 $\\partial T$ 上可以非零的形函数 $\\{\\phi_{i}\\}_{i=1}^{n_{c}}$ 张成），形成 $V_{h} = V_{c} \\oplus V_{b}$。对于试探系数 $(\\boldsymbol{u}_{c}, \\boldsymbol{u}_{b}) \\in \\mathbb{R}^{n_{c}} \\times \\mathbb{R}^{n_{b}}$ 和检验权重 $(\\boldsymbol{v}_{c}, \\boldsymbol{v}_{b}) \\in \\mathbb{R}^{n_{c}} \\times \\mathbb{R}^{n_{b}}$，单元级的分块形式代数系统由下式给出\n$$\n\\begin{pmatrix}\nK_{cc}  K_{cb} \\\\\nK_{bc}  K_{bb}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{u}_{c} \\\\\n\\boldsymbol{u}_{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\boldsymbol{f}_{c} \\\\\n\\boldsymbol{f}_{b}\n\\end{pmatrix},\n$$\n其中 $K_{cc} \\in \\mathbb{R}^{n_{c} \\times n_{c}}$，$K_{cb} \\in \\mathbb{R}^{n_{c} \\times n_{b}}$，$K_{bc} \\in \\mathbb{R}^{n_{b} \\times n_{c}}$，$K_{bb} \\in \\mathbb{R}^{n_{b} \\times n_{b}}$，以及 $\\boldsymbol{f}_{c} \\in \\mathbb{R}^{n_{c}}$，$\\boldsymbol{f}_{b} \\in \\mathbb{R}^{n_{b}}$ 由双线性形式 $a(\\cdot,\\cdot)$ 和线性形式 $\\ell(\\cdot)$ 关于 $(V_{c}, V_{b})$ 定义。\n\n假设气泡刚度矩阵 $K_{bb}$ 是可逆的，并考虑无残差气泡 (RFB) 的选择，其中气泡未知数在局部确定，使得内部残差为零。对气泡未知数进行精确静态凝聚，并将 $T$ 上的凝聚粗尺度刚度定义为 $K_{cc}^{\\mathrm{cond}} = K_{cc} + S$，其中 $S \\in \\mathbb{R}^{n_{c} \\times n_{c}}$ 是通过消除气泡未知数而产生的稳定化块。令 $\\boldsymbol{p}_{i} \\in \\mathbb{R}^{n_{b}}$ 表示 $K_{cb}^{\\top}$ 与粗糙基 $\\phi_{i}$ 的第 $i$ 个列向量耦合，即 $\\boldsymbol{p}_{i} = (K_{cb})_{i,:}^{\\top}$，令 $\\boldsymbol{g}_{j} \\in \\mathbb{R}^{n_{b}}$ 表示 $K_{bc}$ 的第 $j$ 列，即 $\\boldsymbol{g}_{j} = (K_{bc})_{:,j}$。\n\n推导稳定化块 $S$ 的一个闭式解析表达式，以矩阵形式表示为 $K_{bb}$、$K_{cb}$ 和 $K_{bc}$ 的函数，并等价地使用耦合向量 $\\boldsymbol{p}_{i}$ 和 $\\boldsymbol{g}_{j}$ 以分量形式表示。你的最终答案必须是 $S$ 的单个符号表达式。",
            "solution": "该问题要求推导由气泡未知数的静态凝聚产生的稳定化块 $S$。我们从所提供的单元级分块形式代数系统开始：\n$$\n\\begin{pmatrix}\nK_{cc}  K_{cb} \\\\\nK_{bc}  K_{bb}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{u}_{c} \\\\\n\\boldsymbol{u}_{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\boldsymbol{f}_{c} \\\\\n\\boldsymbol{f}_{b}\n\\end{pmatrix}\n$$\n该系统可展开为两个矩阵方程：\n1. $K_{cc} \\boldsymbol{u}_{c} + K_{cb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{c}$\n2. $K_{bc} \\boldsymbol{u}_{c} + K_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b}$\n\n我们从第二个方程求解气泡系数向量 $\\boldsymbol{u}_{b}$。该方程表示了投影到气泡空间 $V_b$ 上的偏微分方程残差的弱形式。根据无残差气泡方法的精神，我们求解该方程以确定气泡。\n$$\nK_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c}\n$$\n根据假设，$K_{bb}$ 是可逆的。因此，我们可以通过左乘其逆矩阵 $K_{bb}^{-1}$ 来获得 $\\boldsymbol{u}_{b}$ 的显式表达式：\n$$\n\\boldsymbol{u}_{b} = K_{bb}^{-1} (\\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c})\n$$\n这个过程称为静态凝聚。接下来，我们将 $\\boldsymbol{u}_{b}$ 的这个表达式代回到第一个方程中，以消除气泡未知数：\n$$\nK_{cc} \\boldsymbol{u}_{c} + K_{cb} \\left( K_{bb}^{-1} (\\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c}) \\right) = \\boldsymbol{f}_{c}\n$$\n展开并重新整理方程，将所有与粗尺度未知数 $\\boldsymbol{u}_{c}$ 相关的项放在左侧：\n$$\nK_{cc} \\boldsymbol{u}_{c} + K_{cb} K_{bb}^{-1} \\boldsymbol{f}_{b} - K_{cb} K_{bb}^{-1} K_{bc} \\boldsymbol{u}_{c} = \\boldsymbol{f}_{c}\n$$\n$$\n(K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}) \\boldsymbol{u}_{c} = \\boldsymbol{f}_{c} - K_{cb} K_{bb}^{-1} \\boldsymbol{f}_{b}\n$$\n该方程是只涉及粗尺度未知数 $\\boldsymbol{u}_{c}$ 的凝聚系统。左侧的矩阵是凝聚的粗尺度刚度矩阵，记为 $K_{cc}^{\\mathrm{cond}}$。\n$$\nK_{cc}^{\\mathrm{cond}} = K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}\n$$\n问题将此凝聚刚度定义为 $K_{cc}^{\\mathrm{cond}} = K_{cc} + S$，其中 $S$ 是稳定化块。通过比较可得：\n$$\nK_{cc} + S = K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}\n$$\n因此，稳定化块的矩阵形式表达式为：\n$$\nS = - K_{cb} K_{bb}^{-1} K_{bc}\n$$\n这就是所要求的 $S$ 的矩阵形式表达式。\n\n为了找到分量形式的表达式，我们考虑 $S$ 的第 $(i,j)$ 个元素 $S_{ij}$。它是由 $-K_{cb}$ 的第 $i$ 行、矩阵 $K_{bb}^{-1}$ 和 $K_{bc}$ 的第 $j$ 列相乘得到的。根据问题定义， $K_{cb}$ 的第 $i$ 行为 $\\boldsymbol{p}_{i}^{\\top}$，$K_{bc}$ 的第 $j$ 列为 $\\boldsymbol{g}_{j}$。因此，分量 $S_{ij}$ 可以写为：\n$$\nS_{ij} = - \\boldsymbol{p}_{i}^{\\top} K_{bb}^{-1} \\boldsymbol{g}_{j}\n$$\n其中 $\\boldsymbol{p}_{i}^{\\top}$ 是 $1 \\times n_b$ 的行向量，$K_{bb}^{-1}$ 是 $n_b \\times n_b$ 的矩阵，$\\boldsymbol{g}_{j}$ 是 $n_b \\times 1$ 的列向量，其乘积为一个标量。",
            "answer": "$$\n\\boxed{- K_{cb} K_{bb}^{-1} K_{bc}}\n$$"
        }
    ]
}