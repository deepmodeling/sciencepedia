{
    "hands_on_practices": [
        {
            "introduction": "理解无残差气泡函数的第一步是掌握其基本构造。本练习将探讨最基础的一维常系数平流-扩散-反应问题，其中气泡函数是对一个由常数残差驱动的局部边值问题的精确解。通过推导格林函数并直接求解微分方程，您将能够验证这两种方法得到相同的闭合解，从而深入理解气泡函数的定义及其与算子基本解的关系 。",
            "id": "3804185",
            "problem": "考虑开单元 $K=(0,h)$ 上的常系数一维平流-扩散-反应算子，\n$$\n\\mathcal{L} u := -\\mu\\,\\frac{\\mathrm{d}^{2}u}{\\mathrm{d}x^{2}} + \\alpha\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x} + \\gamma\\,u,\n$$\n其中 $\\mu>0$，$\\alpha\\in\\mathbb{R}$ 且 $\\gamma>0$。无残差气泡 (RFB) 方法旨在通过求解局部边值问题，寻找一个能够消除给定单元残差 $R$ 的单元气泡 $b_{K}$：\n$$\n\\mathcal{L} b_{K} = R \\quad \\text{在 } K \\text{ 内}, \\qquad b_{K}(0)=0, \\quad b_{K}(h)=0,\n$$\n其中 $R$ 在 $K$ 上为常数。在 $K$ 上，算子 $\\mathcal{L}$ 的单元格林函数 $G_{K}(x,\\xi)$ 定义为\n$$\n\\mathcal{L}_{x} G_{K}(x,\\xi) = \\delta(x-\\xi), \\qquad G_{K}(0,\\xi)=0, \\quad G_{K}(h,\\xi)=0,\n$$\n其中 $\\delta$ 是狄拉克分布，$\\mathcal{L}_{x}$ 表示 $\\mathcal{L}$ 作用于空间变量 $x$。\n\n从线性微分算子和分布理论的基本定律出发，并仅利用 $\\mathcal{L}$ 的常系数结构，推导单元格林函数 $G_{K}(x,\\xi)$ 的显式表达式。然后，将 RFB 气泡定义为卷积\n$$\nb_{K}(x) := \\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi,\n$$\n并通过证明它能解上述局部边值问题来验证其对于常数残差的有效性。最后，以闭合形式计算 $b_{K}(x)$。所有指数函数均使用 $\\exp(\\cdot)$ 表示，并定义您引入的任何辅助量。如果需要分段表示，您可以使用亥维赛德阶跃函数 $H(s)$，约定当 $s>0$ 时 $H(s)=1$，当 $s\\le 0$ 时 $H(s)=0$。\n\n您的最终答案必须是单个解析表达式，如果需要多个表达式，请使用 $\\mathrm{pmatrix}$ 环境将其表示为单行矩阵。无需进行数值计算。",
            "solution": "我们从常系数二阶算子开始\n$$\n\\mathcal{L} u := -\\mu\\,u'' + \\alpha\\,u' + \\gamma\\,u,\n$$\n其中在 $K=(0,h)$ 上 $\\mu>0$，$\\alpha\\in\\mathbb{R}$ 且 $\\gamma>0$。单元格林函数 $G_{K}(x,\\xi)$ 定义为满足\n$$\n\\mathcal{L}_{x} G_{K}(x,\\xi) = \\delta(x-\\xi), \\qquad G_{K}(0,\\xi)=0, \\quad G_{K}(h,\\xi)=0.\n$$\n对于 $x\\neq \\xi$，$G_{K}(\\cdot,\\xi)$ 满足齐次方程\n$$\n-\\mu\\,y'' + \\alpha\\,y' + \\gamma\\,y = 0,\n$$\n其特征方程为\n$$\n-\\mu r^{2} + \\alpha r + \\gamma = 0 \\quad \\Longleftrightarrow \\quad \\mu r^{2} - \\alpha r - \\gamma = 0.\n$$\n两个不同的实根（因为 $\\alpha^{2}+4\\mu\\gamma>0$）是\n$$\nr_{1} := \\frac{\\alpha + \\sqrt{\\alpha^{2}+4\\mu\\gamma}}{2\\mu}, \\qquad r_{2} := \\frac{\\alpha - \\sqrt{\\alpha^{2}+4\\mu\\gamma}}{2\\mu}.\n$$\n一组能够满足单元端点处狄利克雷边界条件的方便的齐次解是\n$$\n\\varphi(x) := \\exp(r_{1}x) - \\exp(r_{2}x), \\qquad \\psi(x) := \\exp(r_{1}x)\\exp(-r_{1}h) - \\exp(r_{2}x)\\exp(-r_{2}h),\n$$\n它们满足 $\\varphi(0)=0$ 和 $\\psi(h)=0$。格林函数通过匹配连续性以及由狄拉克分布所蕴含的在 $x=\\xi$ 处一阶导数的跳跃条件来分段构造。具体来说，连续性要求\n$$\n\\lim_{x\\to \\xi^{-}}G_{K}(x,\\xi) = \\lim_{x\\to \\xi^{+}}G_{K}(x,\\xi),\n$$\n并将 $\\mathcal{L}_{x}G_{K}(x,\\xi)=\\delta(x-\\xi)$ 在 $\\xi$ 附近的一个小区间上积分，得到跳跃条件\n$$\n-\\mu\\left(\\frac{\\partial G_{K}}{\\partial x}(\\xi^{+},\\xi) - \\frac{\\partial G_{K}}{\\partial x}(\\xi^{-},\\xi)\\right) = 1.\n$$\n一个用 $\\varphi$ 和 $\\psi$ 表示的标准构造给出\n$$\nG_{K}(x,\\xi) =\n\\begin{cases}\nA(\\xi)\\,\\varphi(x), & x  \\xi, \\\\\nB(\\xi)\\,\\psi(x),  x > \\xi,\n\\end{cases}\n$$\n其中选择 $A(\\xi)$ 和 $B(\\xi)$ 以满足连续性和跳跃条件。使用在 $x=\\xi$ 处的朗斯基行列式求解 $A(\\xi)$ 和 $B(\\xi)$，\n$$\nW(\\varphi,\\psi)(\\xi) := \\varphi(\\xi)\\psi'(\\xi) - \\varphi'(\\xi)\\psi(\\xi),\n$$\n我们得到\n$$\nA(\\xi) = -\\frac{\\psi(\\xi)}{\\mu\\,W(\\varphi,\\psi)(\\xi)}, \\qquad B(\\xi) = -\\frac{\\varphi(\\xi)}{\\mu\\,W(\\varphi,\\psi)(\\xi)}.\n$$\n我们显式地计算 $W(\\varphi,\\psi)(\\xi)$。为简洁起见，记 $A_{1}:=\\exp(r_{1}\\xi)$ 和 $A_{2}:=\\exp(r_{2}\\xi)$。那么\n$$\n\\varphi(\\xi) = A_{1}-A_{2}, \\quad \\varphi'(\\xi) = r_{1}A_{1} - r_{2}A_{2}, \\quad\n\\psi(\\xi) = A_{1}\\exp(-r_{1}h) - A_{2}\\exp(-r_{2}h), \\quad \\psi'(\\xi) = r_{1}A_{1}\\exp(-r_{1}h) - r_{2}A_{2}\\exp(-r_{2}h).\n$$\n直接计算可得\n$$\nW(\\varphi,\\psi)(\\xi) = (r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big).\n$$\n因此，\n$$\nG_{K}(x,\\xi) =\n-\\frac{1}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big)}\n\\begin{cases}\n\\psi(\\xi)\\,\\varphi(x),  x  \\xi, \\\\\n\\varphi(\\xi)\\,\\psi(x),  x > \\xi.\n\\end{cases}\n$$\n为了将 $G_{K}$ 表示为单个表达式，我们使用亥维赛德阶跃函数 $H(s)$，其中当 $s0$ 时 $H(s)=1$，否则 $H(s)=0$：\n$$\nG_{K}(x,\\xi) =\n-\\frac{\\psi(\\xi)\\,\\varphi(x)\\,H(\\xi-x) + \\varphi(\\xi)\\,\\psi(x)\\,H(x-\\xi)}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big)}.\n$$\n\n现在我们通过与常数残差 $R$ 的卷积来定义气泡：\n$$\nb_{K}(x) := \\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi.\n$$\n验证 $b_{K}$ 能解局部问题可以直接从 $G_{K}$ 的定义性质得出。在分布意义下，\n$$\n\\mathcal{L} b_{K}(x) = \\mathcal{L}\\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi = \\int_{0}^{h} \\mathcal{L}_{x} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi = \\int_{0}^{h} \\delta(x-\\xi)\\,R\\,\\mathrm{d}\\xi = R,\n$$\n并且由于对所有 $\\xi$ 都有 $G_{K}(0,\\xi)=G_{K}(h,\\xi)=0$，我们有 $b_{K}(0)=b_{K}(h)=0$。因此 $b_{K}$ 满足\n$$\n-\\mu\\,b_{K}'' + \\alpha\\,b_{K}' + \\gamma\\,b_{K} = R, \\qquad b_{K}(0)=b_{K}(h)=0.\n$$\n因为 $\\gamma0$ 且 $\\mu0$，该边值问题有唯一解；因此，卷积得到的气泡是消除常数残差的唯一气泡。\n\n现在我们通过直接求解常微分方程来以闭合形式计算 $b_{K}(x)$。对于常数右端项 $R$ 的一个特解是 $b_{p}(x)\\equiv R/\\gamma$。齐次通解是 $b_{h}(x)=C_{1}\\exp(r_{1}x)+C_{2}\\exp(r_{2}x)$。因此\n$$\nb_{K}(x) = C_{1}\\exp(r_{1}x) + C_{2}\\exp(r_{2}x) + \\frac{R}{\\gamma}.\n$$\n施加 $b_{K}(0)=0$ 和 $b_{K}(h)=0$ 得到\n$$\nC_{1}+C_{2} = -\\frac{R}{\\gamma}, \\qquad C_{1}\\exp(r_{1}h) + C_{2}\\exp(r_{2}h) = -\\frac{R}{\\gamma}.\n$$\n求解这两个关于 $C_{1}$ 和 $C_{2}$ 的线性方程组得到\n$$\nC_{1} = \\frac{R}{\\gamma}\\,\\frac{\\exp(r_{2}h)-1}{\\exp(r_{1}h)-\\exp(r_{2}h)}, \\qquad\nC_{2} = \\frac{R}{\\gamma}\\,\\frac{1-\\exp(r_{1}h)}{\\exp(r_{1}h)-\\exp(r_{2}h)}.\n$$\n因此，闭合形式的气泡是\n$$\nb_{K}(x) = \\frac{R}{\\gamma}\\left[ 1 + \\frac{\\big(\\exp(r_{2}h)-1\\big)\\exp(r_{1}x) + \\big(1-\\exp(r_{1}h)\\big)\\exp(r_{2}x)}{\\exp(r_{1}h)-\\exp(r_{2}h)} \\right].\n$$\n根据唯一性，此表达式与卷积 $b_{K}(x)=\\int_{0}^{h}G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi$ 相吻合。这完成了对 $K=(0,h)$ 上常数残差的 $G_{K}$ 的显式计算，以及对无残差气泡 $b_{K}$ 的验证和闭合形式计算。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{\\big(\\exp(r_{1}\\xi)\\exp(-r_{1}h)-\\exp(r_{2}\\xi)\\exp(-r_{2}h)\\big)\\big(\\exp(r_{1}x)-\\exp(r_{2}x)\\big)\\,H(\\xi-x)\\;+\\;\\big(\\exp(r_{1}\\xi)-\\exp(r_{2}\\xi)\\big)\\big(\\exp(r_{1}x)\\exp(-r_{1}h)-\\exp(r_{2}x)\\exp(-r_{2}h)\\big)\\,H(x-\\xi)}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h)-\\exp(-r_{1}h)\\big)}  \\dfrac{R}{\\gamma}\\left[ 1 + \\dfrac{\\big(\\exp(r_{2}h)-1\\big)\\exp(r_{1}x) + \\big(1-\\exp(r_{1}h)\\big)\\exp(r_{2}x)}{\\exp(r_{1}h)-\\exp(r_{2}h)} \\right]\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了基本构造之后，我们来探究气泡函数在更真实场景下的行为，即当残差不再是常数时。气泡函数的形状并非一成不变，它会根据局部物理特性自适应调整，这些特性由对比平流和扩散相对强度的单元佩克莱数（Péclet number）$Pe_K$ 来表征。通过求解由线性残差驱动的气泡函数，本练习将揭示无残差气泡方法的核心优势：在平流主导的情况下，它能够自动在单元内部形成捕捉边界层所需的陡峭梯度 。",
            "id": "3804226",
            "problem": "考虑一维稳态平流-扩散模型，该模型定义在有限元（单元）$K = (0,h)$上，其中平流系数为$\\beta \\in \\mathbb{R}\\setminus\\{0\\}$，扩散系数为$\\varepsilon  0$，无反应项。在无残差气泡 (RFB) 方法中，单元$K$上的局部气泡$b_K(x)$被定义为子尺度问题的解，该解抵消了$K$内部的粗尺度残差，并在$K$的边界上为零。假设限制在$K$上的粗尺度残差是仿射函数$r_K(x) = a x + b$，其中$a,b \\in \\mathbb{R}$是常数。因此，RFB 局部问题是：求解$b_K(x)$，使得\n$$\n-\\varepsilon\\, b_K''(x) + \\beta\\, b_K'(x) = r_K(x) \\quad \\text{for } x \\in (0,h), \\qquad b_K(0)=0,\\quad b_K(h)=0,\n$$\n其中$\\sigma=0$（无反应）。\n\n从控制算子定义和无残差气泡子问题的定义出发，推导唯一解$b_K(x)$关于$a$、$b$、$\\varepsilon$、$\\beta$、$h$和$x$的闭式表达式。在您的推导过程中，为了符号清晰，您可以暂时将残差的截距$b$重命名为$\\beta_0$，以避免与气泡$b_K(x)$混淆。然后，解释$b_K(x)$的函数形式如何反映 RFB 方法在不同单元Péclet数$\\mathrm{Pe}_K = \\beta h/\\varepsilon$下捕捉单元内部梯度的能力。\n\n您的最终答案必须是$b_K(x)$的单一闭式解析表达式，不得进行四舍五入。无需单位。",
            "solution": "该问题是求解以下二阶线性非齐次常系数常微分方程 (ODE)：\n$$\n-\\varepsilon\\, b_K''(x) + \\beta\\, b_K'(x) = a x + b\n$$\n其边界条件为 $b_K(0)=0$ 和 $b_K(h)=0$。通解 $b_K(x)$ 是齐次解 $b_h(x)$ 和一个特解 $b_p(x)$ 的和。\n\n**1. 齐次解**\n齐次方程为 $-\\varepsilon\\, b_h''(x) + \\beta\\, b_h'(x) = 0$。其特征方程为 $-\\varepsilon \\lambda^2 + \\beta \\lambda = 0$，解得特征根为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\beta/\\varepsilon$。因此，齐次通解是：\n$$\nb_h(x) = C_1 + C_2 \\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right)\n$$\n其中 $C_1$ 和 $C_2$ 是任意常数。\n\n**2. 特解**\n由于右端项是线性多项式 $ax+b$，且 $\\lambda_1=0$ 是一个特征根，我们寻求形式为 $b_p(x) = K x^2 + M x$ 的特解。其导数为 $b_p'(x) = 2Kx + M$ 和 $b_p''(x) = 2K$。代入ODE得到：\n$$\n-\\varepsilon (2K) + \\beta (2Kx + M) = a x + b \\implies (2\\beta K)x + (\\beta M - 2\\varepsilon K) = a x + b\n$$\n通过匹配 $x$ 的同次幂系数，可得 $2\\beta K = a$ 和 $\\beta M - 2\\varepsilon K = b$。由于 $\\beta \\neq 0$，我们解得 $K = \\frac{a}{2\\beta}$ 和 $M = \\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}$。因此，特解为：\n$$\nb_p(x) = \\frac{a}{2\\beta}x^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x\n$$\n\n**3. 通解与边界条件**\n通解为 $b_K(x) = C_1 + C_2 \\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right) + b_p(x)$。应用边界条件 $b_K(0)=0$ 得到：\n$$\nC_1 + C_2 \\exp(0) + 0 = 0 \\implies C_1 = -C_2\n$$\n因此，$b_K(x) = C_2\\left(\\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right) - 1\\right) + b_p(x)$。应用边界条件 $b_K(h)=0$ 得到：\n$$\nC_2\\left(\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1\\right) + \\frac{a}{2\\beta}h^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h = 0\n$$\n求解 $C_2$：\n$$\nC_2 = - \\frac{\\frac{a}{2\\beta}h^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}\n$$\n将 $C_2$ 代回，得到最终的闭式解：\n$$\nb_K(x) = \\left[ \\frac{a}{2\\beta}x^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x \\right] - \\left[ \\frac{a}{2\\beta}h^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h \\right] \\frac{\\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right) - 1}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}\n$$\n\n### 关于单元Péclet数的解释\n单元Péclet数 $\\mathrm{Pe}_K = \\frac{\\beta h}{\\varepsilon}$ 是一个无量纲数，它比较了单元内平流与扩散的相对强度。$b_K(x)$ 的函数形式揭示了 RFB 方法的自适应性。\n\n当平流主导时（$|\\mathrm{Pe}_K| \\gg 1$），指数项 $\\exp(\\frac{\\beta x}{\\varepsilon})$ 的行为会主导解的形态。如果 $\\beta  0$，解会在流出边界 $x=h$ 附近形成一个厚度为 $\\mathcal{O}(\\varepsilon/\\beta)$ 的边界层，以满足 $b_K(h)=0$ 的条件。如果 $\\beta  0$，边界层则形成于 $x=0$ 处。这表明气泡函数自动地在需要的地方产生陡峭的梯度来捕捉细尺度特征。\n\n当扩散主导时（$|\\mathrm{Pe}_K| \\ll 1$），指数项之比 $\\frac{\\exp(\\beta x/\\varepsilon) - 1}{\\exp(\\beta h/\\varepsilon) - 1}$ 近似于线性函数 $\\frac{x}{h}$。解 $b_K(x)$ 趋向于一个更平滑、更对称的轮廓，这是纯扩散问题的典型特征。\n\n总之，无残差气泡 $b_K(x)$ 的解析形式内在地包含了使其能够根据局部单元Péclet数的值，自适应地调整其形状的数学结构，从一个宽泛的、类似扩散的轮廓调整为一个带有边界层的、尖锐的、平流主导的轮廓。这种自适应行为是 RFB 方法有效性的基石。",
            "answer": "$$\n\\boxed{\\left[ \\frac{a x^2}{2\\beta} + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x \\right] - \\left[ \\frac{a h^2}{2\\beta} + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h \\right] \\frac{\\exp\\left(\\frac{\\beta x}{\\varepsilon}\\right) - 1}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}}\n$$"
        },
        {
            "introduction": "理解了连续气泡函数之后，最后一步是探究它如何在代数层面修正数值格式。在有限元方法中，子尺度气泡空间的作用可以被“静态凝聚”到仅包含粗尺度未知量的主系统中，从而形成一个修正后的稳定系统。这个过程展示了如何将子网格信息有效地融入粗尺度计算中，而无需显式求解气泡未知量。本练习将引导您推导这一过程，将连续的偏微分方程理论与实际的有限元实现联系起来，展示气泡函数如何具体地产生一个可计算的稳定化矩阵项 。",
            "id": "3804219",
            "problem": "考虑单个有限元 $T \\subset \\mathbb{R}^{d}$，在其上建立标量对流-扩散-反应边值问题：求 $u$ 使得在 $T$ 中有 $-\\nabla \\cdot (\\kappa \\nabla u) + \\boldsymbol{\\beta} \\cdot \\nabla u + \\sigma u = f$，且 $u$ 与 $\\partial T$ 上的给定迹相符。此处，$\\kappa \\in \\mathbb{R}^{+}$ 是各向同性扩散系数，$\\boldsymbol{\\beta} \\in \\mathbb{R}^{d}$ 是对流速度，$\\sigma \\in \\mathbb{R}$ 是反应系数。设 $T$ 上的标准 Galerkin 变分双线性形式为 $a(w,v) = \\int_{T} \\kappa \\nabla w \\cdot \\nabla v \\,\\mathrm{d}x + \\int_{T} (\\boldsymbol{\\beta} \\cdot \\nabla w) v \\,\\mathrm{d}x + \\int_{T} \\sigma w v \\,\\mathrm{d}x$，线性泛函为 $\\ell(v) = \\int_{T} f v \\,\\mathrm{d}x$。\n\n用一个气泡子尺度空间 $V_{b}$（由在 $T$ 上张成且在 $\\partial T$ 上为零的内部气泡基函数 $\\{b_{\\alpha}\\}_{\\alpha=1}^{n_{b}}$ 构成）来增强粗尺度有限元空间 $V_{c}$（由在 $T$ 上局部张成且在 $\\partial T$ 上可以非零的形函数 $\\{\\phi_{i}\\}_{i=1}^{n_{c}}$ 构成），形成 $V_{h} = V_{c} \\oplus V_{b}$。对于试探系数 $(\\boldsymbol{u}_{c}, \\boldsymbol{u}_{b}) \\in \\mathbb{R}^{n_{c}} \\times \\mathbb{R}^{n_{b}}$ 和测试权重 $(\\boldsymbol{v}_{c}, \\boldsymbol{v}_{b}) \\in \\mathbb{R}^{n_{c}} \\times \\mathbb{R}^{n_{b}}$，单元级的分块代数系统由下式给出\n$$\n\\begin{pmatrix}\nK_{cc}  K_{cb} \\\\\nK_{bc}  K_{bb}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{u}_{c} \\\\\n\\boldsymbol{u}_{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\boldsymbol{f}_{c} \\\\\n\\boldsymbol{f}_{b}\n\\end{pmatrix},\n$$\n其中 $K_{cc} \\in \\mathbb{R}^{n_{c} \\times n_{c}}$，$K_{cb} \\in \\mathbb{R}^{n_{c} \\times n_{b}}$，$K_{bc} \\in \\mathbb{R}^{n_{b} \\times n_{c}}$，$K_{bb} \\in \\mathbb{R}^{n_{b} \\times n_{b}}$，以及 $\\boldsymbol{f}_{c} \\in \\mathbb{R}^{n_{c}}$，$\\boldsymbol{f}_{b} \\in \\mathbb{R}^{n_{b}}$ 是根据双线性和线性形式 $a(\\cdot,\\cdot)$ 与 $\\ell(\\cdot)$ 相对于 $(V_{c}, V_{b})$ 定义的。\n\n假设气泡刚度矩阵 $K_{bb}$ 可逆，并考虑无残差气泡 (Residual-Free Bubble, RFB) 的选择，其中气泡未知量在局部确定，以使内部残差为零。对气泡未知量进行精确的静态凝聚，并将 $T$ 上的凝聚粗尺度刚度定义为 $K_{cc}^{\\mathrm{cond}} = K_{cc} + S$，其中 $S \\in \\mathbb{R}^{n_{c} \\times n_{c}}$ 是通过消除气泡未知量而产生的稳定化块。设 $\\boldsymbol{p}_{i} \\in \\mathbb{R}^{n_{b}}$ 表示 $K_{cb}^{\\top}$ 与粗尺度基 $\\phi_{i}$ 的第 i 个列向量耦合，即 $\\boldsymbol{p}_{i} = (K_{cb})_{i,:}^{\\top}$；并设 $\\boldsymbol{g}_{j} \\in \\mathbb{R}^{n_{b}}$ 表示 $K_{bc}$ 的第 j 列，即 $\\boldsymbol{g}_{j} = (K_{bc})_{:,j}$。\n\n推导稳定化块 $S$ 的闭式解析表达式，该表达式以矩阵形式用 $K_{bb}$、$K_{cb}$ 和 $K_{bc}$ 表示，并等价地使用耦合向量 $\\boldsymbol{p}_{i}$ 和 $\\boldsymbol{g}_{j}$ 以分量形式表示。最终答案必须是 $S$ 的单个符号表达式。",
            "solution": "该问题要求推导由气泡未知量的静态凝聚产生的稳定化块 $S$。我们从给定的单元级分块代数系统开始：\n$$\n\\begin{pmatrix}\nK_{cc}  K_{cb} \\\\\nK_{bc}  K_{bb}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{u}_{c} \\\\\n\\boldsymbol{u}_{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\boldsymbol{f}_{c} \\\\\n\\boldsymbol{f}_{b}\n\\end{pmatrix}\n$$\n该分块系统由两个矩阵方程组成：\n1. $K_{cc} \\boldsymbol{u}_{c} + K_{cb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{c}$\n2. $K_{bc} \\boldsymbol{u}_{c} + K_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b}$\n\n“无残差气泡”方法的核心在于解第二个方程，以根据粗尺度未知量 $\\boldsymbol{u}_{c}$ 和右端项 $\\boldsymbol{f}_{b}$ 来确定气泡系数向量 $\\boldsymbol{u}_{b}$。我们重排第二个方程以求解 $\\boldsymbol{u}_{b}$：\n$$\nK_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c}\n$$\n由于气泡刚度矩阵 $K_{bb}$ 是可逆的，我们可以通过左乘其逆矩阵 $K_{bb}^{-1}$ 来获得 $\\boldsymbol{u}_{b}$ 的显式表达式：\n$$\n\\boldsymbol{u}_{b} = K_{bb}^{-1} (\\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c})\n$$\n这个过程称为静态凝聚。接下来，我们将 $\\boldsymbol{u}_{b}$ 的这个表达式代回到分块系统的第一个方程中：\n$$\nK_{cc} \\boldsymbol{u}_{c} + K_{cb} \\left( K_{bb}^{-1} (\\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c}) \\right) = \\boldsymbol{f}_{c}\n$$\n我们将所有涉及粗尺度未知量 $\\boldsymbol{u}_{c}$ 的项收集到左侧：\n$$\nK_{cc} \\boldsymbol{u}_{c} - K_{cb} K_{bb}^{-1} K_{bc} \\boldsymbol{u}_{c} = \\boldsymbol{f}_{c} - K_{cb} K_{bb}^{-1} \\boldsymbol{f}_{b}\n$$\n$$\n(K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}) \\boldsymbol{u}_{c} = \\boldsymbol{f}_{c} - K_{cb} K_{bb}^{-1} \\boldsymbol{f}_{b}\n$$\n这个方程是针对粗尺度未知量 $\\boldsymbol{u}_{c}$ 的凝聚系统。左侧的矩阵是凝聚的粗尺度刚度矩阵，记作 $K_{cc}^{\\mathrm{cond}}$：\n$$\nK_{cc}^{\\mathrm{cond}} = K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}\n$$\n问题将凝聚刚度定义为 $K_{cc}^{\\mathrm{cond}} = K_{cc} + S$，其中 $S$ 是稳定化块。通过将我们推导的结果与此定义进行比较，可以确定 $S$：\n$$\nK_{cc} + S = K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}\n$$\n从两侧减去 $K_{cc}$ 得到稳定化块的矩阵形式表达式：\n$$\nS = - K_{cb} K_{bb}^{-1} K_{bc}\n$$\n这是所要求的 $S$ 的矩阵形式表达式。\n在分量形式下，矩阵 $S$ 的第 $(i,j)$ 个元素 $S_{ij}$ 是 $-K_{cb}$ 的第 i 行（即 $\\boldsymbol{p}_{i}^{\\top}$）、矩阵 $K_{bb}^{-1}$ 和 $K_{bc}$ 的第 j 列（即 $\\boldsymbol{g}_{j}$）的乘积：\n$$\nS_{ij} = - \\boldsymbol{p}_{i}^{\\top} K_{bb}^{-1} \\boldsymbol{g}_{j}\n$$\n因此，稳定化块代表了通过气泡空间进行的粗尺度间耦合。",
            "answer": "$$\n\\boxed{- K_{cb} K_{bb}^{-1} K_{bc}}\n$$"
        }
    ]
}