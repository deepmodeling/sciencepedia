{
    "hands_on_practices": [
        {
            "introduction": "Jarzynski等式 (Jarzynski equality) 是一个深刻的结论，但其力量源于统计力学的基本原理。为了真正理解该恒等式，从第一性原理出发进行推导是至关重要的第一步。本练习  将通过两个典型的物理模型——经典谐振子和量子双能级系统——来指导您完成这一过程，帮助您深入理解功 $W$ 的指数平均值 $\\langle \\exp(-\\beta W) \\rangle$ 与自由能变化 $\\Delta F$ 之间的内在联系。",
            "id": "3772099",
            "problem": "考虑两个典型系统，在时间 $t=0$ 时经历瞬时参数淬火。每个系统初始时都处于温度为 $T$ 的正则平衡系综中，其逆温度为 $\\beta = 1/(k_{B} T)$，其中 $k_{B}$ 是玻尔兹曼常数。在两种情况下，定义淬火过程对系统所做的功 $W$ 为淬火瞬间微观态上哈密顿量的变化量，并定义无量纲量 $Q \\equiv -\\ln \\left\\langle \\exp(-\\beta W) \\right\\rangle$，其中 $\\langle \\cdot \\rangle$ 表示对初始条件和测量结果的适当系综平均。您的任务是从第一性原理出发，基于正则系综以及功和亥姆霍兹自由能的定义，推导 $Q$ 的解析表达式，过程中不得使用任何现成公式。将两个结果以单行矩阵 $[Q_{\\mathrm{ho}},\\, Q_{\\mathrm{tls}}]$ 的形式报告，其中 $Q_{\\mathrm{ho}}$ 对应谐振子，$Q_{\\mathrm{tls}}$ 对应两能级系统。最终答案必须仅用符号参数表示，并且在最终的方框答案中不包含单位。\n\n系统 A (经典谐振子): 哈密顿量为 $H(x,p;k)=\\frac{p^{2}}{2m} + \\frac{1}{2} k x^{2}$，描述一个质量为 $m$、弹簧常数为 $k$ 的粒子。系统初始时在温度 $T$ 下与弹簧常数 $k_{0}$ 处于平衡态。在 $t=0$ 时，弹簧常数从 $k_{0}$ 突然淬火至 $k_{1}$，而相空间点 $(x,p)$ 在淬火瞬间保持不变。使用初始分布的正则系综和瞬时功的定义，计算 $Q_{\\mathrm{ho}}$。\n\n系统 B (量子两能级系统): 哈密顿量 $H(\\epsilon)$ 有两个能量本征值 $E_{0}(\\epsilon)=0$ 和 $E_{1}(\\epsilon)=\\epsilon$，其中 $\\epsilon \\ge 0$。系统初始时在温度 $T$ 下与参数 $\\epsilon_{0}$ 处于平衡态。在 $t=0$ 时，$\\epsilon$ 从 $\\epsilon_{0}$ 突然淬火至 $\\epsilon_{1}$。采用标准的投影能量测量来定义功：在淬火前瞬间测量能量，然后在淬火后瞬间再次测量，瞬时淬火意味着状态在淬火期间不发生变化。在此方案下，如果系统初始处于基态，则功 $W=0$；如果初始处于激发态，则功 $W=\\epsilon_{1}-\\epsilon_{0}$。使用能量本征态上的初始正则分布，计算 $Q_{\\mathrm{tls}}$。\n\n答案规格：\n- 为每个 $Q$ 提供一个用上述参数表示的解析表达式。\n- 将您的两个答案一起以单行矩阵 $[Q_{\\mathrm{ho}},\\, Q_{\\mathrm{tls}}]$ 的形式报告。\n- 最终答案必须是无量纲的。请勿在最终的方框答案中包含单位。",
            "solution": "问题要求计算两个经历瞬时参数淬火的系统的无量纲量 $Q \\equiv -\\ln \\left\\langle \\exp(-\\beta W) \\right\\rangle$。每个系统的初始状态都是逆温度为 $\\beta = 1/(k_{B} T)$ 的正则平衡系综。尖括号 $\\langle \\cdot \\rangle$ 表示对初始正则分布的平均。我们将为每个系统从第一性原理出发进行计算。基本方法是评估功的指数项的系综平均值 $\\left\\langle \\exp(-\\beta W) \\right\\rangle$。\n\n对于一个具有初始哈密顿量 $H_0$ 和相应初始平衡概率分布 $\\rho_0$ 的一般系统，一个量 $A$ 的平均值在经典情况下由 $\\langle A \\rangle = \\int A \\rho_0 d\\Gamma$ 给出，在量子情况下由 $\\langle A \\rangle = \\mathrm{Tr}(\\rho_0 A)$ 给出，其中 $\\rho_0 = \\exp(-\\beta H_0)/Z_0$ 且 $Z_0$ 是初始配分函数。功 $W$ 是非平衡过程中系统状态的函数。\n\n需要计算的量是 $Q = -\\ln \\left\\langle \\exp(-\\beta W) \\right\\rangle$。我们可以将平均值表示为：\n$$\n\\left\\langle \\exp(-\\beta W) \\right\\rangle = \\frac{1}{Z_0} \\int \\exp(-\\beta H_0) \\exp(-\\beta W) d\\Gamma \\quad \\text{(经典情况)}\n$$\n$$\n\\left\\langle \\exp(-\\beta W) \\right\\rangle = \\mathrm{Tr}\\left( \\frac{\\exp(-\\beta H_0)}{Z_0} \\exp(-\\beta \\hat{W}) \\right) \\quad \\text{(量子情况, 功作为算符)}\n$$\n我们接下来分别分析每个系统。\n\n首先，考虑系统 A，即经典谐振子。\n初始哈密顿量为 $H_0(x,p) = \\frac{p^{2}}{2m} + \\frac{1}{2} k_{0} x^{2}$。系统初始时与该哈密顿量处于热平衡状态。\n在时间 $t=0$ 时，弹簧常数从 $k_0$ 淬火至 $k_1$。末态哈密顿量为 $H_1(x,p) = \\frac{p^{2}}{2m} + \\frac{1}{2} k_{1} x^{2}$。\n在此瞬时淬火过程中所做的功 $W$ 是在相空间点 $(x,p)$ 处（该点在淬火期间保持不变）计算的哈密顿量的变化：\n$$\nW(x,p) = H_1(x,p) - H_0(x,p) = \\left(\\frac{p^{2}}{2m} + \\frac{1}{2} k_{1} x^{2}\\right) - \\left(\\frac{p^{2}}{2m} + \\frac{1}{2} k_{0} x^{2}\\right) = \\frac{1}{2}(k_1 - k_0)x^2\n$$\n初始状态由正则概率密度 $\\rho_0(x,p) = \\frac{1}{Z_0} \\exp(-\\beta H_0(x,p))$ 描述，其中 $Z_0$ 是初始配分函数。我们计算 $\\exp(-\\beta W)$ 的系综平均值：\n$$\n\\left\\langle \\exp(-\\beta W) \\right\\rangle = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\rho_0(x,p) \\exp(-\\beta W(x,p)) \\,dx\\,dp\n$$\n$$\n= \\frac{1}{Z_0} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(-\\beta H_0(x,p)) \\exp(-\\beta [H_1(x,p) - H_0(x,p)]) \\,dx\\,dp\n$$\n指数中包含 $H_0$ 的项相互抵消：\n$$\n= \\frac{1}{Z_0} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(-\\beta H_1(x,p)) \\,dx\\,dp\n$$\n根据定义，该积分是对应于末态哈密顿量 $H_1$ 的配分函数 $Z_1$。因此，我们得到关系式 $\\left\\langle \\exp(-\\beta W) \\right\\rangle = \\frac{Z_1}{Z_0}$。\n现在，我们必须计算配分函数 $Z_0$ 和 $Z_1$。对于一维单个粒子，经典配分函数由对玻尔兹曼因子的相空间积分给出（我们忽略普朗克常数因子 $1/h$，因为它将在比率中被抵消）：\n$$\nZ_k = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\frac{p^2}{2m}\\right) dp \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\frac{1}{2} k x^2\\right) dx\n$$\n这些是形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$ 的标准高斯积分。\n动量积分是 $\\sqrt{\\frac{2m\\pi}{\\beta}}$。\n位置积分是 $\\sqrt{\\frac{2\\pi}{\\beta k}}$。\n所以，对于给定的弹簧常数 $k$，配分函数为：\n$$\nZ_k = \\sqrt{\\frac{2m\\pi}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta k}} = \\frac{2\\pi\\sqrt{m}}{\\beta\\sqrt{k}}\n$$\n使用这个通用形式，我们求出 $Z_0$ 和 $Z_1$：\n$$\nZ_0 = \\frac{2\\pi\\sqrt{m}}{\\beta\\sqrt{k_0}} \\quad \\text{和} \\quad Z_1 = \\frac{2\\pi\\sqrt{m}}{\\beta\\sqrt{k_1}}\n$$\n比值为：\n$$\n\\frac{Z_1}{Z_0} = \\frac{2\\pi\\sqrt{m}/(\\beta\\sqrt{k_1})}{2\\pi\\sqrt{m}/(\\beta\\sqrt{k_0})} = \\frac{\\sqrt{k_0}}{\\sqrt{k_1}} = \\sqrt{\\frac{k_0}{k_1}}\n$$\n最后，我们计算 $Q_{\\mathrm{ho}}$：\n$$\nQ_{\\mathrm{ho}} = -\\ln \\left\\langle \\exp(-\\beta W) \\right\\rangle = -\\ln\\left(\\frac{Z_1}{Z_0}\\right) = -\\ln\\left(\\sqrt{\\frac{k_0}{k_1}}\\right) = \\ln\\left(\\left(\\frac{k_0}{k_1}\\right)^{-1/2}\\right) = \\ln\\left(\\left(\\frac{k_1}{k_0}\\right)^{1/2}\\right) = \\frac{1}{2} \\ln\\left(\\frac{k_1}{k_0}\\right)\n$$\n这个结果也可以与亥姆霍兹自由能的变化 $\\Delta F = F_1 - F_0$ 联系起来。由于 $F = -k_B T \\ln Z = - (1/\\beta) \\ln Z$（在相差一个常数的情况下），我们有 $\\beta \\Delta F = -\\ln(Z_1/Z_0) = Q_{\\mathrm{ho}}$，这证实了我们计算的一致性。\n\n接下来，我们考虑系统 B，即量子两能级系统。\n初始哈密顿量 $H_0$ 的能量本征值为 $E_{0,0}=0$ 和 $E_{0,1}=\\epsilon_0$。初始配分函数为：\n$$\nZ_0 = \\sum_{n=0}^{1} \\exp(-\\beta E_{0,n}) = \\exp(0) + \\exp(-\\beta \\epsilon_0) = 1 + \\exp(-\\beta \\epsilon_0)\n$$\n系统初始时处于两个能量本征态的热混合态中。根据玻尔兹曼分布，系统处于基态 ($|\\psi_0\\rangle$) 和激发态 ($|\\psi_1\\rangle$) 的概率分别为：\n$$\nP_0 = \\frac{\\exp(-\\beta E_{0,0})}{Z_0} = \\frac{1}{Z_0} = \\frac{1}{1 + \\exp(-\\beta \\epsilon_0)}\n$$\n$$\nP_1 = \\frac{\\exp(-\\beta E_{0,1})}{Z_0} = \\frac{\\exp(-\\beta \\epsilon_0)}{Z_0} = \\frac{\\exp(-\\beta \\epsilon_0)}{1 + \\exp(-\\beta \\epsilon_0)}\n$$\n参数 $\\epsilon$ 从 $\\epsilon_0$ 淬火至 $\\epsilon_1$。根据两点测量方案，对每个初始状态所做的功 $W$ 如下。如果系统初始处于基态，则 $W_0=0$。如果系统初始处于激发态，则 $W_1 = \\epsilon_1 - \\epsilon_0$。系综平均 $\\left\\langle \\exp(-\\beta W) \\right\\rangle$ 是对这些测量结果的平均，并由初始概率加权：\n$$\n\\left\\langle \\exp(-\\beta W) \\right\\rangle = \\sum_{i=0}^{1} P_i \\exp(-\\beta W_i) = P_0 \\exp(-\\beta W_0) + P_1 \\exp(-\\beta W_1)\n$$\n代入概率和功的值：\n$$\n\\left\\langle \\exp(-\\beta W) \\right\\rangle = \\left(\\frac{1}{Z_0}\\right) \\exp(0) + \\left(\\frac{\\exp(-\\beta \\epsilon_0)}{Z_0}\\right) \\exp(-\\beta(\\epsilon_1 - \\epsilon_0))\n$$\n$$\n= \\frac{1}{Z_0} \\left[ 1 + \\exp(-\\beta \\epsilon_0) \\exp(-\\beta\\epsilon_1) \\exp(\\beta\\epsilon_0) \\right]\n$$\n$$\n= \\frac{1}{Z_0} [1 + \\exp(-\\beta \\epsilon_1)]\n$$\n末态哈密顿量 $H_1$ 的本征值为 $E_{1,0}=0$ 和 $E_{1,1}=\\epsilon_1$。相应的配分函数为 $Z_1 = 1 + \\exp(-\\beta \\epsilon_1)$。因此，我们再次得到关系式：\n$$\n\\left\\langle \\exp(-\\beta W) \\right\\rangle = \\frac{Z_1}{Z_0} = \\frac{1 + \\exp(-\\beta \\epsilon_1)}{1 + \\exp(-\\beta \\epsilon_0)}\n$$\n现在我们可以计算 $Q_{\\mathrm{tls}}$：\n$$\nQ_{\\mathrm{tls}} = -\\ln \\left\\langle \\exp(-\\beta W) \\right\\rangle = -\\ln\\left(\\frac{1 + \\exp(-\\beta \\epsilon_1)}{1 + \\exp(-\\beta \\epsilon_0)}\\right) = \\ln\\left(\\left(\\frac{1 + \\exp(-\\beta \\epsilon_1)}{1 + \\exp(-\\beta \\epsilon_0)}\\right)^{-1}\\right)\n$$\n$$\nQ_{\\mathrm{tls}} = \\ln\\left(\\frac{1 + \\exp(-\\beta \\epsilon_0)}{1 + \\exp(-\\beta \\epsilon_1)}\\right)\n$$\n与谐振子的情况类似，这个量等于 $\\beta \\Delta F = \\beta(F_1 - F_0)$。\n\n根据要求，将 $Q_{\\mathrm{ho}}$ 和 $Q_{\\mathrm{tls}}$ 的两个结果合并为一个单行矩阵。\n$$\n[Q_{\\mathrm{ho}},\\, Q_{\\mathrm{tls}}] = \\begin{pmatrix} \\frac{1}{2}\\ln\\left(\\frac{k_1}{k_0}\\right)  \\ln\\left(\\frac{1 + \\exp(-\\beta \\epsilon_0)}{1 + \\exp(-\\beta \\epsilon_1)}\\right) \\end{pmatrix}\n$$\n这些表达式是无量纲的，并且只用指定的符号参数表示。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\ln\\left(\\frac{k_1}{k_0}\\right)  \\ln\\left(\\frac{1 + \\exp(-\\beta \\epsilon_0)}{1 + \\exp(-\\beta \\epsilon_1)}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了Jarzynski等式的推导后，下一个关键步骤是辨析与其相关的常见误区，其中最主要的一点便是混淆单次测量的功与系综平均。本练习  提出了一个思想实验，一个研究小组声称在单次分子拉伸实验中观测到 $W \\lt \\Delta F$，并以此断言热力学第二定律被违背。通过分析这一谬误，您将巩固对系综平均重要性的理解，并学会区分随机涨落与宏观定律的适用范围。",
            "id": "2391896",
            "problem": "一个研究RNA发夹结构的研究小组使用光镊拉伸方案来估算在温度$T$下的平衡折叠自由能差$\\Delta F$。他们引用了Jarzynski等式 (JE)，其表述为\n$$\\left\\langle e^{-\\beta W}\\right\\rangle = e^{-\\beta \\Delta F},$$\n其中$\\beta = \\left(k_{\\mathrm{B}} T\\right)^{-1}$，$W$是在非平衡拉伸过程中所做的功。在拉伸方案的单次实现中，他们测量到的功值$W$小于一个独立报道的$\\Delta F$的平衡估计值。然后，他们声称这违反了热力学第二定律，其依据是他们所谓的JE的“非平均形式”，即对于每条轨迹都有$e^{-\\beta W} = e^{-\\beta \\Delta F}$，他们将其解释为$W = \\Delta F$对每条轨迹都成立。基于第一性原理，下列哪些评论正确地解释了为什么他们的说法是毫无根据的？选择所有适用的选项。\n\nA. Jarzynski等式要求对大量从正则平衡开始并遵循相同方案的重复实验进行系综平均$\\langle \\cdot \\rangle$；将$e^{-\\beta W} = e^{-\\beta \\Delta F}$应用于单条轨迹不是JE的有效用法，因此观测到的$W  \\Delta F$并不意味着任何违规。\n\nB. 在此背景下，热力学第二定律的相关表述是$\\langle W \\rangle \\ge \\Delta F$，而不是每次实现都有$W \\ge \\Delta F$；因此，由于涨落，单次试验中出现$W  \\Delta F$是可能的，且不违反热力学定律。\n\nC. 功$W$是一个依赖于拉伸方案的路径依赖量，而自由能差$\\Delta F$是一个态函数；任何声称$W$必须逐条轨迹地等于$\\Delta F$的说法都与这一根本区别相矛盾。\n\nD. Crooks涨落定理保证了单条正向轨迹和单条时间反演轨迹足以精确确定$\\Delta F$；因此，单次试验的观察结果决定性地支持了违规的结论。\n\nE. 对于小$W$值，用其线性近似$1 - \\beta W$替换$e^{-\\beta W}$是合理的，并得出每次实现都有$W = \\Delta F$的结论；因此，在小功极限下，这种违规是真实存在的。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 研究对象：一个RNA发夹结构。\n- 实验技术：光镊拉伸方案。\n- 待估算量：平衡折叠自由能差，$\\Delta F$。\n- 温度：$T$。\n- 引用的物理定律：Jarzynski等式 (JE)，表述为$\\left\\langle e^{-\\beta W}\\right\\rangle = e^{-\\beta \\Delta F}$。\n- $\\beta$的定义：$\\beta = \\left(k_{\\mathrm{B}} T\\right)^{-1}$。\n- $W$的定义：在非平衡拉伸过程中所做的功。\n- 实验观察：协议的单次实现产生一个功值$W$，使得$W  \\Delta F$，其中$\\Delta F$是一个先前已知的值。\n- 提出的主张：这一观察构成了对热力学第二定律的违反。\n- 主张的理由：一个假定的JE“非平均形式”，$e^{-\\beta W} = e^{-\\beta \\Delta F}$，被解释为$W = \\Delta F$对每一条轨迹都成立。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题设置在单分子生物物理学和非平衡统计力学的背景下，这些都是成熟的科学领域。Jarzynski等式是该领域的一个基本定理。实验设置（对RNA使用光镊）是标准的。所描述的场景——观察到功的涨落，其中单次功的测量值小于自由能差——是一个已知且预期的现象。假设的研究小组提出的主张在科学上是不正确的，但问题要求评论这个具体的不正确主张。因此，该问题的设定作为一项理解力测试在科学上是合理的。\n- **问题明确**：问题是明确的。它要求对一个有缺陷的论点提出正确的科学评论。在选项中存在一组唯一的正确评论。\n- **客观性**：问题以客观的术语描述了一个假设的场景和一个有缺陷的结论。它不包含主观或基于意见的陈述。\n\n**步骤3：结论与行动**\n问题陈述有效。它呈现了一个清晰、有科学依据的场景，并就统计力学的基本原理提出了一个定义明确的问题。可以继续进行求解过程。\n\n该研究小组提出的主张存在根本性缺陷，源于对Jarzynski等式及其与热力学第二定律关系的误解。让我们从第一性原理来分析这一点。\n\nJarzynski等式表述为：\n$$\n\\left\\langle e^{-\\beta W}\\right\\rangle = e^{-\\beta \\Delta F}\n$$\n在这里，关键要素是系综平均，用尖括号$\\langle \\cdot \\rangle$表示。这个平均是对无限次实验进行的，每次实验都始于一个与温度为$T$的热浴处于热平衡的系统，并对其实施完全相同的非平衡功过程方案。功$W$是一个随机变量；其数值在每次实验实现中都会波动。该恒等式将这个波动的功的指数平均值与一个热力学态函数——自由能差$\\Delta F$的指数联系起来。\n\n断言$e^{-\\beta W} = e^{-\\beta \\Delta F}$对每条轨迹都成立是一个严重的误解。这意味着对于每一次实现，$W = \\Delta F$都成立，但这只在准静态（无限慢，可逆）过程的理想化极限下才成立。对于任何有限时间的非平衡过程，都会存在耗散，功$W$将根据某个概率分布$P(W)$进行分布。\n\nJarzynski等式的一个直接推论是适用于此类过程的热力学第二定律。我们使用Jensen不等式，该不等式指出，对于任何凸函数$\\phi(x)$，都有$\\langle \\phi(x) \\rangle \\ge \\phi(\\langle x \\rangle)$。指数函数$\\phi(x) = e^x$是凸函数。将此应用于变量为$-\\beta W$的Jarzynski等式：\n$$\n\\left\\langle e^{-\\beta W}\\right\\rangle \\ge e^{\\langle -\\beta W \\rangle}\n$$\n在左侧使用Jarzynski等式，在右侧使用平均的线性性质：\n$$\ne^{-\\beta \\Delta F} \\ge e^{-\\beta \\langle W \\rangle}\n$$\n因为指数函数是单调递增的，我们可以对两边取自然对数而不改变不等号的方向：\n$$\n-\\beta \\Delta F \\ge -\\beta \\langle W \\rangle\n$$\n乘以$-1$并回顾$\\beta = (k_{\\mathrm{B}} T)^{-1}  0$，我们必须反转不等号：\n$$\n\\Delta F \\le \\langle W \\rangle \\quad \\text{或} \\quad \\langle W \\rangle \\ge \\Delta F\n$$\n这是在此背景下第二定律的正确表述。它指出，对系统所做的*平均*功必须大于或等于自由能差。它并不约束单条轨迹的功$W$。事实上，要使Jarzynski等式成立，*必须*存在$W  \\Delta F$的轨迹。如果对于所有轨迹都有$W \\ge \\Delta F$，那么对于所有的$W$都有$e^{-\\beta W} \\le e^{-\\beta \\Delta F}$。取平均会得到$\\langle e^{-\\beta W} \\rangle \\le e^{-\\beta \\Delta F}$，其中等号只能在所有轨迹都是非耗散的（$W = \\Delta F$），即在可逆极限下成立。对于任何不可逆过程，我们会发现$\\langle e^{-\\beta W} \\rangle  e^{-\\beta \\Delta F}$，这违反了Jarzynski等式。因此，观察到$W  \\Delta F$并不是对第二定律的违反；这是小系统中功的统计性质的一个必然特征。\n\n现在我们评估每个选项。\n\n**A. Jarzynski等式要求对大量从正则平衡开始并遵循相同方案的重复实验进行系综平均$\\langle \\cdot \\rangle$；将$e^{-\\beta W} = e^{-\\beta \\Delta F}$应用于单条轨迹不是JE的有效用法，因此观测到的$W  \\Delta F$并不意味着任何违规。**\n这个陈述是对应用Jarzynski等式要求的精确而准确的描述。它正确地指出了研究人员推理中的核心错误：将系综平均与单轨迹值混淆。它正确地得出结论，这种误用使其关于热力学违规的主张无效。\n**结论：正确**\n\n**B. 在此背景下，热力学第二定律的相关表述是$\\langle W \\rangle \\ge \\Delta F$，而不是每次实现都有$W \\ge \\Delta F$；因此，由于涨落，单次试验中出现$W  \\Delta F$是可能的，且不违反热力学定律。**\n这个陈述正确地阐述了从Jarzynski等式推导出的第二定律不等式。它强调了对平均功$\\langle W \\rangle$的约束与单轨迹功$W$的涨落性质之间的区别。它正确地将观察到$W  \\Delta F$归因于统计涨落，并正确地得出结论，这不违反热力学。\n**结论：正确**\n\n**C. 功$W$是一个依赖于拉伸方案的路径依赖量，而自由能差$\\Delta F$是一个态函数；任何声称$W$必须逐条轨迹地等于$\\Delta F$的说法都与这一根本区别相矛盾。**\n这个评论基于热力学的基本定义。功是由两个状态之间所经过的过程路径定义的。自由能是一个态函数，意味着其变化仅取决于初始和最终状态，而不取决于它们之间的路径。研究人员关于$W = \\Delta F$对每条路径都成立的错误假设，错误地暗示了功是一个态函数。这是一个基本的概念错误。\n**结论：正确**\n\n**D. Crooks涨落定理保证了单条正向轨迹和单条时间反演轨迹足以精确确定$\\Delta F$；因此，单次试验的观察结果决定性地支持了违规的结论。**\n这个陈述完全曲解了Crooks涨落定理。该定理将正向过程的功的整个概率分布$P_F(W)$与时间反演过程的概率分布$P_R(W')$联系起来：$P_F(W)/P_R(-W) = \\exp[\\beta(W - \\Delta F)]$。人们不能仅从一个正向和一个反向轨迹的两个功值就“精确地”确定$\\Delta F$。这样的估计会受到巨大的统计噪声的影响。该定理需要对分布进行采样，这意味着需要许多轨迹。因此，得出的结论是毫无根据的。\n**结论：不正确**\n\n**E. 对于小$W$值，用其线性近似$1 - \\beta W$替换$e^{-\\beta W}$是合理的，并得出每次实现都有$W = \\Delta F$的结论；因此，在小功极限下，这种违规是真实存在的。**\n这个论证在数学上是有缺陷的。近似是在系综平均内部应用的：$\\langle e^{-\\beta W} \\rangle \\approx \\langle 1 - \\beta W \\rangle = 1 - \\beta \\langle W \\rangle$。Jarzynski恒等式于是变为$1 - \\beta \\langle W \\rangle \\approx e^{-\\beta \\Delta F}$。如果我们也对右边进行近似，$1 - \\beta \\langle W \\rangle \\approx 1 - \\beta \\Delta F$，这简化为$\\langle W \\rangle \\approx \\Delta F$。该近似得出的结论是关于*平均*功的，而不是关于“每次实现”的功。声称该近似导致每条轨迹$W = \\Delta F$是错误的，因此其结论没有根据。\n**结论：不正确**",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "理论的最终价值在于应用。本练习  将引导您从理论走向实践，模拟计算科学家在研究中面临的真实情境。您将获得一组通过非平衡拉伸模拟产生的功的数据，您的任务是应用Jarzynski等式来计算平衡态下的自由能差 $\\Delta A$。这个实践不仅要求您实现Jarzynski估计量，还挑战您处理计算过程中的数值稳定性问题，这是将理论转化为可靠科学工具的关键一步。",
            "id": "2462968",
            "problem": "给定一个展开小肽的非平衡拉伸功值的多个独立实现，这些值是通过在分子动力学 (MD) 中多次重复一个时间依赖的驱动协议获得的。每次实现都从绝对温度为 $T$ 的正则系综中采样的初始状态开始，并根据预设的控制参数方案，在确定性的、微观可逆的动力学下进行。在这些条件下，存在一个精确的关系，它将不可逆功函数的正则系综平均值与初始和最终控制参数值对应的平衡态亥姆霍兹自由能差联系起来。您的任务是利用此关系，从有限的拉伸功样本中恢复可逆亥姆霍兹自由能变化。\n\n您可以假设的基本原理：\n- 系统初始处于温度为 $T$ 的正则系综中，因此初始相空间密度正比于 $\\exp(-\\beta H)$，其中 $\\beta = 1/(k_\\mathrm{B} T)$，$H$ 是哈密顿量。\n- 微观动力学是确定性的，并保持相空间体积。\n- 当能量以每摩尔为单位报告时，逆温度的摩尔形式为 $\\beta = 1/(R T)$，其中 $R$ 是摩尔气体常数。\n\n定义和要求：\n- 令 $R$ 表示摩尔气体常数，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。使用 $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 对于每个测试用例，给定一个温度 $T$（单位 K）和一个包含 $N$ 个独立功值的列表 $\\{W_i\\}_{i=1}^N$（单位 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$）。每个 $W_i$ 是在驱动协议的单条非平衡轨迹上对系统所做的总机械功。\n- 仅使用上述基本原理，从集合 $\\{W_i\\}_{i=1}^N$ 和 $T$ 中推导出可逆亥姆霍兹自由能差 $\\Delta A$ 的合适估计量，然后实现该估计量的数值稳定计算，以避免在计算指数时发生浮点溢出或下溢。您必须通过变换计算来确保数值稳定性，从而不直接生成非常小或非常大的中间指数（例如，通过在求和前对指数进行移位）。\n- 报告 $\\Delta A$，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，并四舍五入到 $3$ 位小数。\n\n测试套件：\n计算以下五个案例的 $\\Delta A$。所有能量都必须视为摩尔量。\n- 案例 1：$T = 300.0\\ \\mathrm{K}$，$W = [12.0,\\ 13.5,\\ 11.2,\\ 14.1]\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 案例 2：$T = 300.0\\ \\mathrm{K}$，$W = [5.0,\\ 5.0,\\ 5.0]\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 案例 3：$T = 350.0\\ \\mathrm{K}$，$W = [20.0,\\ 30.0,\\ 15.0,\\ 25.0,\\ 40.0,\\ 10.0]\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 案例 4：$T = 100.0\\ \\mathrm{K}$，$W = [2.0,\\ 3.0,\\ 4.0,\\ 5.0]\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 案例 5：$T = 300.0\\ \\mathrm{K}$，$W = [18.0,\\ 19.0,\\ 17.0,\\ 5.0]\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按案例 1 到 5 的顺序包含五个 $\\Delta A$ 值，每个值都以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位，并四舍五入到 3 位小数。例如，符合所需格式的输出行形式为 $[\\Delta A_1,\\Delta A_2,\\Delta A_3,\\Delta A_4,\\Delta A_5]$，其中每个 $\\Delta A_i$ 是一个四舍五入到 3 位小数的浮点数。",
            "solution": "该问题要求从一组有限的非平衡功测量值 $\\{W_i\\}$ 中，推导并实现平衡亥姆霍兹自由能差 $\\Delta A$ 的估计量。所提供的物理基础——初始正则系综以及确定性的、保持体积的动力学——正是 Jarzynski 等式的精确基础，也就是问题陈述中提到的那个精确关系。\n\n我们首先陈述这个基本关系。Jarzynski 等式将非平衡过程中对系统所做的功 $W$ 与控制参数初始值和最终值对应的平衡态之间的自由能差 $\\Delta A$ 联系起来。该等式表示为：\n$$\n\\langle e^{-\\beta W} \\rangle = e^{-\\beta \\Delta A}\n$$\n在此，$\\beta$ 是逆温度。对于指定的摩尔能量，$\\beta = 1/(R T)$，其中 $R$ 是摩尔气体常数，$T$ 是绝对温度。尖括号 $\\langle \\dots \\rangle$ 表示对无限多个轨迹的系综平均，每个轨迹都从初始状态的正则平衡分布中抽取的构型开始。\n\n为了求得 $\\Delta A$，我们对 Jarzynski 等式两边取自然对数：\n$$\n\\ln(\\langle e^{-\\beta W} \\rangle) = -\\beta \\Delta A\n$$\n解出 $\\Delta A$ 可得：\n$$\n\\Delta A = -\\frac{1}{\\beta} \\ln(\\langle e^{-\\beta W} \\rangle)\n$$\n在任何实际应用中，例如计算实验，我们只能获得 $N$ 个独立功值的有限样本 $\\{W_i\\}_{i=1}^N$。因此，系综平均 $\\langle e^{-\\beta W} \\rangle$ 必须通过样本均值来估计：\n$$\n\\langle e^{-\\beta W} \\rangle \\approx \\frac{1}{N} \\sum_{i=1}^N e^{-\\beta W_i}\n$$\n将此样本均值代入 $\\Delta A$ 的表达式，得到从有限数据集中计算自由能差的实用估计量：\n$$\n\\Delta A \\approx -\\frac{1}{\\beta} \\ln\\left(\\frac{1}{N} \\sum_{i=1}^N e^{-\\beta W_i}\\right)\n$$\n使用 $\\beta = 1/(R T)$，估计量关于给定量的最终表达式为：\n$$\n\\Delta A = -R T \\ln\\left(\\frac{1}{N} \\sum_{i=1}^N e^{-W_i / (R T)}\\right)\n$$\n\n接下来的关键任务是确保此计算的数值稳定性。计算涉及指数和 $\\sum_i e^{-W_i / (R T)}$。如果参数 $-W_i / (R T)$ 是大的正数，其指数运算可能导致浮点溢出。相反，大的负参数会导致下溢，虽然没有那么灾难性，但仍可能导致精度损失。为了防止这种情况，我们采用一种标准的代数操作，通常称为 log-sum-exp 技巧。\n\n令 $x_i = -W_i / (R T)$。我们希望鲁棒地计算 $\\ln\\left(\\sum_i e^{x_i}\\right)$。令 $x_{\\max} = \\max_i\\{x_i\\}$。我们可以从和式中提出因子 $e^{x_{\\max}}$：\n$$\n\\sum_{i=1}^N e^{x_i} = \\sum_{i=1}^N e^{x_i - x_{\\max} + x_{\\max}} = e^{x_{\\max}} \\sum_{i=1}^N e^{x_i - x_{\\max}}\n$$\n然后，该和的对数变为：\n$$\n\\ln\\left(\\sum_{i=1}^N e^{x_i}\\right) = \\ln\\left(e^{x_{\\max}} \\sum_{i=1}^N e^{x_i - x_{\\max}}\\right) = x_{\\max} + \\ln\\left(\\sum_{i=1}^N e^{x_i - x_{\\max}}\\right)\n$$\n在我们的情境中，$x_{\\max} = \\max_i\\{-W_i / (R T)\\} = -(\\min_i\\{W_i\\}) / (R T) = -W_{\\min} / (R T)$，其中 $W_{\\min}$ 是样本中的最小功值。新和式中的指数为 $(x_i - x_{\\max}) = -(W_i - W_{\\min})/(R T)$。由于对所有 $i$ 都有 $W_i \\ge W_{\\min}$，这些指数都是非正的。和式中的最大值为 $e^0 = 1$，这完全避免了溢出。\n\n将此稳定化的形式代入我们的 $\\Delta A$ 估计量中：\n$$\n\\Delta A = -R T \\left[ \\ln\\left(\\frac{1}{N}\\right) + \\ln\\left(\\sum_{i=1}^N e^{-W_i / (R T)}\\right) \\right]\n$$\n$$\n\\Delta A = -R T \\left[ -\\ln(N) + \\left( -\\frac{W_{\\min}}{R T} + \\ln\\left(\\sum_{i=1}^N e^{-(W_i - W_{\\min})/(RT)}\\right) \\right) \\right]\n$$\n简化此表达式得到最终的、数值稳定的实现公式：\n$$\n\\Delta A = R T \\ln(N) + W_{\\min} - R T \\ln\\left(\\sum_{i=1}^N e^{-(W_i - W_{\\min})/(RT)}\\right)\n$$\n或者，更紧凑地表示为：\n$$\n\\Delta A = W_{\\min} - R T \\left[ \\ln\\left(\\sum_{i=1}^N e^{-(W_i - W_{\\min})/(RT)}\\right) - \\ln(N) \\right]\n$$\n这就是要实现的算法。对于每个测试用例，我们将计算摩尔热能的倒数 $1/(RT)$，找到样本数 $N$ 和最小功 $W_{\\min}$，计算移位指数的和，并如上所示组合这些项来求得 $\\Delta A$。结果必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位报告，并四舍五入到 3 位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Helmholtz free energy difference Delta A from non-equilibrium\n    work measurements using the Jarzynski equality, with numerical stabilization.\n    \"\"\"\n    \n    # Define the molar gas constant in kJ mol^-1 K^-1\n    R = 8.314462618e-3\n\n    test_cases = [\n        {'T': 300.0, 'W': [12.0, 13.5, 11.2, 14.1]},\n        {'T': 300.0, 'W': [5.0, 5.0, 5.0]},\n        {'T': 350.0, 'W': [20.0, 30.0, 15.0, 25.0, 40.0, 10.0]},\n        {'T': 100.0, 'W': [2.0, 3.0, 4.0, 5.0]},\n        {'T': 300.0, 'W': [18.0, 19.0, 17.0, 5.0]}\n    ]\n\n    def calculate_delta_a(T, W_values, R_const):\n        \"\"\"\n        Computes Delta A for a single test case using a numerically stable formula.\n\n        Args:\n            T (float): Absolute temperature in Kelvin.\n            W_values (list of float): List of work values in kJ/mol.\n            R_const (float): Molar gas constant in kJ mol^-1 K^-1.\n\n        Returns:\n            float: The calculated Helmholtz free energy difference Delta A.\n        \"\"\"\n        N = len(W_values)\n        if N == 0:\n            return 0.0 # Or handle as an error case\n\n        # Convert to numpy array for efficient operations\n        W = np.array(W_values)\n        \n        RT = R_const * T\n        \n        # If all work values are identical, Delta A is simply that work value.\n        # This also avoids potential log(0) if N=1.\n        if np.all(W == W[0]):\n            return W[0]\n\n        # Find the minimum work value for the shifting factor\n        W_min = np.min(W)\n        \n        # Calculate shifted, unitless exponents: -(W_i - W_min) / (RT)\n        # The exponents are guaranteed to be = 0, preventing overflow.\n        shifted_exponents = -(W - W_min) / RT\n        \n        # Calculate the sum of exponentials\n        sum_of_exponentials = np.sum(np.exp(shifted_exponents))\n        \n        # Calculate Delta A using the numerically stable formula:\n        # Delta_A = W_min - RT * [ln(sum(exp(-(W_i-W_min)/RT))) - ln(N)]\n        log_term = np.log(sum_of_exponentials) - np.log(N)\n        delta_A = W_min - RT * log_term\n        \n        return delta_A\n\n    results = []\n    for case in test_cases:\n        T = case['T']\n        W = case['W']\n        delta_A = calculate_delta_a(T, W, R)\n        results.append(delta_A)\n    \n    # Format results to 3 decimal places and create the final output string\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}