{
    "hands_on_practices": [
        {
            "introduction": "王-Landau抽样的一个核心特点是它能高效地计算出相对态密度 $\\tilde{g}(E)$，但在没有进一步处理的情况下，这个结果在整个能量谱上仅在相差一个全局乘法常数的意义下是准确的。为了计算自由能等绝对的热力学量，我们必须将这个相对态密度归一化为绝对态密度 $g(E)$。本练习将指导您完成这一关键的数据后处理步骤，通过利用一个已知的参考点（例如，通过对称性确定的系统基态简并度）来校准整个态密度函数 。",
            "id": "3832190",
            "problem": "考虑一个用于多尺度建模的有限离散能量系统，其中必须计算精确的绝对热力学势以耦合微观和介观描述。微正则态密度 $g(E)$ 定义为能量为 $E$ 的微观态的确切数量。Wang-Landau 抽样 (WLS) 在能量空间中构造一个随机游走，并迭代地优化对 $\\ln g(E)$ 的估计，以使访问能量的直方图变得平坦。在一个有限系统中，已知 Wang-Landau 抽样的输出在 $g(E)$ 上精确到一个全局乘法常数（等效于在 $\\ln g(E)$ 上精确到一个加法常数）。\n\n给定一个有限系统的三个能级 $E_0  E_1  E_2$ 的 Wang-Landau 抽样估计值 $\\ln \\tilde{g}(E)$。已知的基态多重性（简并度）为 $g(E_0) = d_0$，这是从对称性独立确定的。假设玻尔兹曼常数 $k_{\\mathrm{B}}$ 设为 $1$，且能量以一致的单位报告。提供的数据如下：\n- 基态的已知简并度：在 $E_0$ 处 $d_0 = 2$。\n- Wang-Landau 抽样输出：$\\ln \\tilde{g}(E_0) = \\ln 5$, $\\ln \\tilde{g}(E_1) = \\ln 25$, $\\ln \\tilde{g}(E_2) = \\ln 50$。\n- 能量：$E_0 = -6$, $E_1 = -2$, $E_2 = 0$。\n- 考虑在逆温度 $\\beta = 1$ 下的正则系综。\n\n仅使用第一性原理以及微正则态密度和正则配分函数的核心定义，解释如何利用参考能量 $E_0$ 处的已知简并度，从 Wang-Landau 抽样估计值中获得 $g(E)$ 的绝对归一化。然后，在给定数据上演示该归一化过程，并计算在 $\\beta=1$ 时对应的正则配分函数 $Z(\\beta)$。\n\n哪个选项正确地描述了归一化原理，并为给定数据提供了正确的归一化 $g(E)$ 值和正则配分函数？\n\nA. 通过对所有能量上的 $\\tilde{g}(E)$ 进行单一的全局重新标度，强制使归一化后的 $g(E)$ 在 $E_0$ 处与已知简并度匹配。这得到 $g(E) = c\\,\\tilde{g}(E)$，其中选择 $c$ 以满足 $g(E_0) = d_0$。对于给定数据，$c = \\dfrac{2}{5}$，因此 $g(E_0) = 2$, $g(E_1) = 10$, $g(E_2) = 20$，并且在 $\\beta = 1$ 时的正则配分函数为 $Z(1) = 2\\,e^{6} + 10\\,e^{2} + 20$。\n\nB. 通过对 $g(E)$ 添加一个常数来校正 Wang-Landau 抽样估计，使得 $g(E_0)$ 等于已知简并度，即 $g(E) = \\tilde{g}(E) + \\left(d_0 - \\tilde{g}(E_0)\\right)$。对于给定数据，这得到 $g(E_0) = 2$, $g(E_1) = 22$, $g(E_2) = 47$，并且 $Z(1) = 2\\,e^{6} + 22\\,e^{2} + 47$。\n\nC. 通过减去 $\\left(\\ln d_0 - \\ln \\tilde{g}(E_0)\\right)$ 来归一化 $\\ln \\tilde{g}(E)$，以获得 $\\ln g(E) = \\ln \\tilde{g}(E) - \\left(\\ln d_0 - \\ln \\tilde{g}(E_0)\\right)$。对于给定数据，这产生 $g(E_0) = \\dfrac{25}{2}$, $g(E_1) = \\dfrac{125}{2}$, $g(E_2) = \\dfrac{250}{2}$，并且 $Z(1) = \\dfrac{25}{2}\\,e^{6} + \\dfrac{125}{2}\\,e^{2} + \\dfrac{250}{2}$。\n\nD. 通过 $g_{\\mathrm{prob}}(E) = \\dfrac{\\tilde{g}(E)}{\\sum_{E'} \\tilde{g}(E')}$ 将 $\\tilde{g}(E)$ 转换为概率，并用这些概率来定义配分函数为 $Z(\\beta) = \\sum_{E} g_{\\mathrm{prob}}(E)\\,e^{-\\beta E}$。对于给定数据，$\\sum_{E'} \\tilde{g}(E') = 80$，因此 $g_{\\mathrm{prob}}(E_0) = \\dfrac{5}{80}$, $g_{\\mathrm{prob}}(E_1) = \\dfrac{25}{80}$, $g_{\\mathrm{prob}}(E_2) = \\dfrac{50}{80}$，并且 $Z(1) = \\dfrac{5}{80}\\,e^{6} + \\dfrac{25}{80}\\,e^{2} + \\dfrac{50}{80}$。",
            "solution": "从微正则态密度 $g(E)$ 的定义开始，它是在能量 $E$ 上的微观态的确切计数。在一个有限系统中，对于离散能级 $E$，$g(E)$ 是一个整数值函数。Wang-Landau 抽样 (WLS) 在能量中进行随机游走，并更新态密度的对数估计量，以使能量直方图变得平坦。WLS 估计量的标准性质是它能恢复相对态密度，但不能恢复其绝对标度，即它确定 $\\ln g(E)$ 时会带有一个附加常数。因此，估计值 $\\tilde{g}(E)$ 与真实的 $g(E)$ 通过一个未知的乘法常数成正比，所以存在一个常数 $c  0$ 使得\n$$\ng(E) = c\\,\\tilde{g}(E), \\quad \\text{等效于} \\quad \\ln g(E) = \\ln \\tilde{g}(E) + \\ln c.\n$$\n\n为了固定绝对标度，我们使用一个在参考能量 $E_{\\mathrm{ref}}$ （此处为基态 $E_0$）处的已知简并度，这通常可以从对称性或在有限系统中的精确计数得到。施加条件 $g(E_{\\mathrm{ref}}) = d_{\\mathrm{ref}}$ 可以确定该常数：\n$$\nc = \\frac{d_{\\mathrm{ref}}}{\\tilde{g}(E_{\\mathrm{ref}})}, \\quad \\text{或} \\quad \\ln c = \\ln d_{\\mathrm{ref}} - \\ln \\tilde{g}(E_{\\mathrm{ref}}).\n$$\n这确保了在所有能量上对 $g(E)$ 进行一致的全局归一化。值得注意的是，在正则系综中，概率\n$$\np(E) = \\frac{g(E) \\, e^{-\\beta E}}{Z(\\beta)}, \\quad Z(\\beta) = \\sum_{E} g(E) \\, e^{-\\beta E},\n$$\n在全局重新标度 $g(E) \\to c\\,g(E)$ 下是不变的，因为分子和分母都按比例 $c$ 缩放。然而，诸如自由能 $F(\\beta) = -\\beta^{-1} \\ln Z(\\beta)$ 之类的绝对量依赖于绝对归一化，这在组合来自不同子系统或尺度的贡献时，是多尺度耦合所必需的。\n\n将归一化应用于给定数据。Wang-Landau 抽样输出为\n$$\n\\ln \\tilde{g}(E_0) = \\ln 5, \\quad \\ln \\tilde{g}(E_1) = \\ln 25, \\quad \\ln \\tilde{g}(E_2) = \\ln 50,\n$$\n所以\n$$\n\\tilde{g}(E_0) = 5, \\quad \\tilde{g}(E_1) = 25, \\quad \\tilde{g}(E_2) = 50.\n$$\n已知在 $E_0$ 处 $d_0 = 2$，我们设定\n$$\nc = \\frac{d_0}{\\tilde{g}(E_0)} = \\frac{2}{5}.\n$$\n因此，归一化后的态密度为\n$$\ng(E_0) = c\\,\\tilde{g}(E_0) = \\frac{2}{5}\\cdot 5 = 2, \\quad\ng(E_1) = c\\,\\tilde{g}(E_1) = \\frac{2}{5}\\cdot 25 = 10, \\quad\ng(E_2) = c\\,\\tilde{g}(E_2) = \\frac{2}{5}\\cdot 50 = 20.\n$$\n在逆温度 $\\beta = 1$ 时，正则配分函数为\n$$\nZ(1) = \\sum_{i=0}^{2} g(E_i)\\, e^{- E_i} = g(E_0)\\, e^{-(-6)} + g(E_1)\\, e^{-(-2)} + g(E_2)\\, e^{-0} = 2\\,e^{6} + 10\\,e^{2} + 20.\n$$\n这个过程将 Wang-Landau 抽样估计与已知的基态多重性对齐，从而得到一个适用于计算自由能和进行多尺度耦合的绝对归一化。\n\n逐个选项分析：\n\n- 选项 A：它正确地陈述了原理，即 Wang-Landau 抽样估计通过一个单一的全局乘法常数进行归一化，该常数被选择以匹配参考能量下的已知简并度。它计算出 $c = 2/5$，得到 $g(E_0) = 2$, $g(E_1) = 10$, $g(E_2) = 20$，以及正确的配分函数 $Z(1) = 2\\,e^{6} + 10\\,e^{2} + 20$。结论 — 正确。\n\n- 选项 B：它错误地对 $g(E)$ 应用了加法校正，而不是乘法缩放。量 $g(E)$ 是态的计数，Wang-Landau 抽样误差表现为全局乘法因子，而不是加法偏移。因此，所提出的 $g(E)$ 值和配分函数是错误的。结论 — 错误。\n\n- 选项 C：它建议通过减去 $\\left(\\ln d_0 - \\ln \\tilde{g}(E_0)\\right)$ 来调整 $\\ln \\tilde{g}(E)$，即 $\\ln g(E) = \\ln \\tilde{g}(E) - \\left(\\ln d_0 - \\ln \\tilde{g}(E_0)\\right) = \\ln \\tilde{g}(E) - \\ln(2/5)$，这意味着 $g(E) = \\tilde{g}(E)\\cdot (5/2)$。这里的符号是错误的；正确的平移应为 $\\ln g(E) = \\ln \\tilde{g}(E) + \\left(\\ln d_0 - \\ln \\tilde{g}(E_0)\\right)$，对应于 $g(E) = \\tilde{g}(E)\\cdot (2/5)$。按选项 C 所写，它得出 $g(E_0) = 25/2 \\neq 2$，因此未能满足归一化要求。结论 — 错误。\n\n- 选项 D：它通过除以总和将 $\\tilde{g}(E)$ 转换为概率，然后在配分函数中用这些概率代替态密度。这将微正则密度与归一化的概率测度混为一谈，并产生了一个非物理的 $Z(\\beta)$，它依赖于概率的任意归一化，而不是绝对简并度。正则配分函数必须由绝对的 $g(E)$ 计算，而不是能级的归一化概率。结论 — 错误。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "许多复杂的物理现象，例如相变，并不能仅仅通过能量来完全描述，而是需要同时考虑一个或多个序参数。因此，我们需要将态密度的概念从一维的能量空间 $g(E)$ 扩展到多维的宏观状态空间，例如能量和磁矩的联合态密度 $g(E, M)$。这个动手编程练习  将通过为一个小型伊辛模型进行精确枚举来构建其精确的 $g(E, M)$，这不仅清晰地展示了王-Landau模拟旨在估算的目标，而且还演示了如何利用得到的态密度通过“重加权”技术来计算系统在任意温度下的物理性质。",
            "id": "3832210",
            "problem": "考虑一个在 $L \\times L$ 晶格上的二维方形伊辛模型，该模型具有周期性边界条件，自旋 $s_{i} \\in \\{-1,+1\\}$，最近邻耦合设为1，因此所有量都是无量纲的。设构型的能量由标准的最近邻伊辛哈密顿量 $E(\\mathbf{s}) = -\\sum_{\\langle i,j\\rangle} s_{i} s_{j}$ 给出，其中求和是对每个无序的最近邻键恰好进行一次；磁化强度为 $M(\\mathbf{s}) = \\sum_{i=1}^{L^2} s_{i}$。联合态密度 $g(E,M)$ 计算能量为 $E$、磁化强度为 $M$ 的构型数量。\n\n您的任务是本着王-Landau (WL) 采样的精神，构建 $g(E,M)$ 的联合采样方法，为离散宏观态 $(E,M)$ 指定一个适当的分箱方案，然后使用此联合态密度通过重加权方法，在逆温度 $\\beta$ 下获得正则磁化分布 $P_{\\beta}(M)$。您必须实现一个程序，对于较小的 $L$，通过精确枚举来构建 $g(E,M)$，该过程使用与联合 WL 模拟中相同的 $(E,M)$ 分箱方案，然后通过对 $g(E,M)$ 进行正则重加权来计算 $P_{\\beta}(M)$。\n\n仅从基本定义和经过充分检验的事实出发；不要使用任何跳过接受准则或重加权推导的快捷公式。具体来说，您必须：\n- 陈述在宏观态 $(E,M)$ 上进行联合 WL 采样的目标稳态分布，该分布会在 $(E,M)$ 空间中产生平坦的直方图，并由此推导出一个对于构型空间中对称的单自旋翻转提议的 Metropolis-Hastings 接受准则。\n- 为该离散伊辛系统证明一个用于联合 WL 采样的适当的 $(E,M)$ 分箱方案的合理性，并为精确枚举实现相同的分箱方案，以构建作为各分箱整数计数的 $g(E,M)$。\n- 仅使用正则系综的定义，解释如何通过重加权从 $g(E,M)$ 获得 $P_{\\beta}(M)$，包括正确的归一化。\n\n然后实现一个独立的程序，该程序：\n- 对于给定的 $L$，枚举所有自旋构型，并根据上述模型定义，为观察到的每个不同能量和每个不同磁化强度使用一个分箱来构建精确的联合态密度 $g(E,M)$。\n- 对于给定的逆温度 $\\beta$，仅使用正则权重对 $g(E,M)$ 进行重加权并进行适当归一化，以计算正则磁化分布 $P_{\\beta}(M)$。\n- 为一个小型测试套件从 $P_{\\beta}(M)$ 计算所要求的标量统计数据。\n\n使用以下参数值测试套件来检验不同的区域和边界情况：\n- 测试 1 (边界情况，无限温度)：$L=2$，$\\beta=0$。计算 $P_{\\beta}(M)$ 并返回在 $M=0$ 处的值。\n- 测试 2 (中等温度)：$L=2$，$\\beta=1$。计算每自旋的平均绝对磁化强度，即 $\\langle |m| \\rangle$，其中 $m = M/L^2$。\n- 测试 3 (二维伊辛模型的临界区附近)：$L=3$，$\\beta=0.44068679350977147$。计算 $P_{\\beta}(M)$ 并返回在 $M=0$ 处的值。\n\n在给定定义下，所有能量、磁化强度和逆温度都是无量纲的，因此不需要进行物理单位转换。不涉及角度。每个请求的答案必须是一个实数。您的程序应生成单行输出，其中包含测试 1-3 的结果，格式为方括号括起来的逗号分隔列表，每个浮点数四舍五入到六位小数，顺序如上所述，即 $[r_1,r_2,r_3]$，其中 $r_1$ 对应测试 1，$r_2$ 对应测试 2，$r_3$ 对应测试 3。",
            "solution": "该问题要求为分析二维伊辛模型提供理论阐述和计算实现。该分析涉及推导联合王-Landau采样的关键方面、为宏观态指定分箱方案、解释正则重加权过程，并最终为小型晶格实现精确枚举以计算特定的物理量。\n\n该系统定义在一个具有周期性边界条件的 $L \\times L$ 方形晶格上。每个格点 $i$ 上的自旋为 $s_i \\in \\{-1, +1\\}$。总自旋数为 $N=L^2$。一个构型 $\\mathbf{s} = (s_1, \\dots, s_N)$ 的能量由最近邻伊辛哈密顿量 $E(\\mathbf{s}) = -\\sum_{\\langle i,j\\rangle} s_{i} s_{j}$ 给出，其中耦合常数设为1，求和遍及所有唯一的最近邻对。磁化强度为 $M(\\mathbf{s}) = \\sum_{i=1}^{N} s_{i}$。\n\n该问题是有效的，因为它在科学上基于统计力学原理，问题陈述清晰，提供了所有必要信息，并且其表述是客观的。\n\n### 1. 联合王-Landau采样与接受准则\n\n王-Landau (WL) 采样的目标是获得态密度 (DOS) 的估计值，在本例中是联合态密度 $g(E,M)$，它计算每个宏观态 $(E,M)$ 对应的微观构型数量。WL 算法在宏观态空间中进行随机行走，旨在在所有访问过的态 $(E,M)$ 上产生一个平坦的直方图。这是通过以与态密度成反比的概率对微观态进行采样来实现的。\n\n因此，一个微观态 $\\mathbf{s}$ 的目标稳态分布为 $\\pi(\\mathbf{s}) \\propto 1/g(E(\\mathbf{s}), M(\\mathbf{s}))$。随机行走通过提议从构型 $\\mathbf{s}$ 移动到一个新构型 $\\mathbf{s}'$ 来进行。问题指定了单自旋翻转的提议机制。翻转单个自旋是一个对称操作：通过翻转特定自旋从 $\\mathbf{s}$ 提议移动到 $\\mathbf{s}'$ 的概率与通过翻转相同自旋从 $\\mathbf{s}'$ 提议反向移动到 $\\mathbf{s}$ 的概率相同。因此，提议概率分布是对称的，$p(\\mathbf{s} \\to \\mathbf{s}') = p(\\mathbf{s}' \\to \\mathbf{s})$。\n\n在对称提议下，Metropolis-Hastings 接受概率 $A(\\mathbf{s} \\to \\mathbf{s}')$ 简化为 Metropolis 准则：\n$$A(\\mathbf{s} \\to \\mathbf{s}') = \\min\\left(1, \\frac{\\pi(\\mathbf{s}')}{\\pi(\\mathbf{s})}\\right)$$\n设 $\\mathbf{s}$ 的宏观态为 $(E,M)$，$\\mathbf{s}'$ 的宏观态为 $(E',M')$。代入我们的目标分布，我们得到：\n$$A((E,M) \\to (E',M')) = \\min\\left(1, \\frac{1/g(E',M')}{1/g(E,M)}\\right) = \\min\\left(1, \\frac{g(E,M)}{g(E',M')}\\right)$$\n在实践中，WL 算法通过迭代来建立 $g(E,M)$ 的估计，通常是通过处理其对数 $\\ln g(E,M)$。接受概率则计算为：\n$$A((E,M) \\to (E',M')) = \\min\\left(1, \\exp[\\ln g(E,M) - \\ln g(E',M')]\\right)$$\n每当一个宏观态被访问时，其对应的 $\\ln g$ 值会通过加上一个修正因子来更新，该修正因子会逐渐减小以精化 DOS 的估计。\n\n### 2. 宏观变量 $(E,M)$ 的分箱方案\n\n对于指定的伊辛模型，能量 $E$ 和磁化强度 $M$ 都是离散量。\n\n**磁化强度 ($M$)**: 总磁化强度为 $M = \\sum_{i=1}^{L^2} s_i$。设值为 $+1$ 的自旋数量为 $N_{up}$，值为 $-1$ 的自旋数量为 $N_{down}$。则 $N_{up} + N_{down} = L^2$ 且 $M = N_{up} - N_{down}$。代入 $N_{down} = L^2 - N_{up}$，我们发现 $M = 2N_{up} - L^2$。由于 $N_{up}$ 可以是从 $0$ 到 $L^2$ 的任意整数，因此 $M$ 的可能值为 $-L^2, -L^2+2, \\dots, L^2-2, L^2$。磁化强度值是以 $\\Delta M = 2$ 为步长的整数。\n\n**能量 ($E$)**: 能量为 $E = -\\sum_{\\langle i,j \\rangle} s_i s_j$。在一个具有周期性边界条件的 $L \\times L$ 晶格上，有 $2L^2$ 个最近邻键。每一项 $s_i s_j$ 的值是 $+1$ 或 $-1$。因此能量是一个整数。可以证明，对于单自旋翻转，能量变化 $\\Delta E$ 总是 $4$ 的倍数。因此，对于给定的晶格，所有可及的能级都以 $4$ 的整数倍分隔。\n\n鉴于 $E$ 和 $M$ 都取离散且间隔分明的值，最自然且最准确的分箱方案是为系统可以实现的每个不同配对 $(E,M)$ 使用一个分箱。这种离散分箱避免了使用更宽分箱时可能出现的信息损失。对于精确枚举的任务，这对应于创建一个映射或字典，其中每个键都是一个观察到的唯一 $(E,M)$ 元组。\n\n### 3. 从 $g(E,M)$ 到 $P_{\\beta}(M)$ 的正则重加权\n\n包含在态密度 $g(E,M)$ 中的微正则信息与在逆温度 $\\beta = 1/(k_B T)$ 下的正则系综属性之间的联系是通过配分函数 $Z$ 建立的。\n\n在正则系综中，微观态 $\\mathbf{s}$ 的概率由 $P(\\mathbf{s}) = \\frac{e^{-\\beta E(\\mathbf{s})}}{Z}$ 给出。配分函数 $Z$ 是对所有微观态的求和：\n$$Z = \\sum_{\\mathbf{s}} e^{-\\beta E(\\mathbf{s})}$$\n我们可以通过首先将所有共享相同宏观态 $(E,M)$ 的微观态分组来重构此求和。这些态的数量恰好是联合态密度 $g(E,M)$。\n$$Z = \\sum_{E,M} \\sum_{\\substack{\\mathbf{s} \\text{ s.t.} \\\\ E(\\mathbf{s})=E, M(\\mathbf{s})=M}} e^{-\\beta E} = \\sum_{E,M} g(E,M) e^{-\\beta E}$$\n观察到特定宏观态 $(E,M)$ 的概率是属于它的所有微观态概率的总和：\n$$P_{\\beta}(E,M) = \\frac{g(E,M) e^{-\\beta E}}{Z}$$\n为了获得正则磁化分布 $P_{\\beta}(M)$，我们将此联合概率分布对所有可能的能量值 $E$ 进行边缘化：\n$$P_{\\beta}(M) = \\sum_{E} P_{\\beta}(E,M) = \\sum_{E} \\frac{g(E,M) e^{-\\beta E}}{Z}$$\n因此，从已知的 $g(E,M)$ 计算 $P_{\\beta}(M)$ 的过程如下：\n1.  计算配分函数 $Z(\\beta) = \\sum_{E,M} g(E,M) e^{-\\beta E}$。求和遍及所有 $g(E,M)0$ 的 $(E,M)$ 对。\n2.  对于每个可能的磁化强度值 $M_k$，计算未归一化的概率 $\\tilde{P}_{\\beta}(M_k) = \\sum_{E} g(E,M_k) e^{-\\beta E}$，其中求和遍及所有与 $M_k$ 相关的能量 $E$。\n3.  归一化后的概率为 $P_{\\beta}(M_k) = \\frac{\\tilde{P}_{\\beta}(M_k)}{Z(\\beta)}$。\n\n### 4. 通过精确枚举实现\n\n对于小尺寸晶格，例如 $L=2$ 和 $L=3$，精确枚举所有 $2^{L^2}$ 种可能的自旋构型是可行的。实现过程如下：\n1.  初始化一个空字典 `g_EM`，用于存储联合态密度 $g(E,M)$。\n2.  遍历从 $0$ 到 $2^{L^2}-1$ 的所有整数。每个整数的二进制表示映射到一个唯一的自旋构型（例如，比特 $0 \\to s=-1$，比特 $1 \\to s=+1$）。\n3.  对于每个构型，计算其总能量 $E$ 和总磁化强度 $M$。在周期性边界条件下，能量的计算可以通过将每个自旋与其“右侧”和“下方”邻居的乘积求和来高效实现，这样可以确保每个键只计算一次：$E = -\\sum_{i=0}^{L-1}\\sum_{j=0}^{L-1} s_{i,j}(s_{(i+1)\\%L, j} + s_{i,(j+1)\\%L})$。\n4.  将计算出的 $(E,M)$ 对作为 `g_EM` 字典中的键，并增加其值（计数）。\n5.  一旦处理完所有 $2^{L^2}$ 个构型，`g_EM` 就包含了精确的联合态密度。\n6.  使用 `g_EM` 字典和第 3 部分中的重加权公式，为任意给定的 $\\beta$ 计算配分函数 $Z$ 和概率分布 $P_{\\beta}(M)$。\n7.  最后，从得到的 $P_{\\beta}(M)$ 分布中计算所要求的统计量，例如点概率 $P_{\\beta}(M=M_0)$ 或期望值，如 $\\langle |m| \\rangle = \\sum_M |M/L^2| P_{\\beta}(M)$。\n此过程为给定的有限系统提供了精确解，可作为诸如王-Landau采样等随机方法的基准。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by enumerating states for small Ising models,\n    calculating the joint density of states g(E,M), and then using\n    canonical reweighting to find properties at given temperatures.\n    \"\"\"\n    test_cases = [\n        # (L, beta, statistic_type)\n        (2, 0.0, \"P(M=0)\"),\n        (2, 1.0, \"|m|>\"),\n        (3, 0.44068679350977147, \"P(M=0)\")\n    ]\n\n    results = []\n\n    for L, beta, stat_type in test_cases:\n        N = L * L\n        \n        # 1. Enumerate configurations to get the exact joint DOS g(E,M)\n        # g_em is a dictionary mapping (E, M) tuples to their counts.\n        g_em = {}\n        num_configs = 1  N  # This is 2**N\n\n        for i in range(num_configs):\n            # Generate spin configuration from integer i\n            # bit 0 -> spin -1, bit 1 -> spin +1\n            spins_1d = np.array([1 if (i >> k)  1 else -1 for k in range(N)])\n            spins_2d = spins_1d.reshape((L, L))\n            \n            # Calculate Magnetization M\n            M = np.sum(spins_1d)\n            \n            # Calculate Energy E with periodic boundary conditions.\n            # Summing interaction of each spin with its 'right' and 'down'\n            # neighbor counts each bond exactly once.\n            # np.roll(..., -1, ...) shifts elements to the left/up, so\n            # s_grid[i,j] is multiplied by s_grid[i+1,j] and s_grid[i,j+1]\n            E = -np.sum(spins_2d * (np.roll(spins_2d, -1, axis=0) + \n                                   np.roll(spins_2d, -1, axis=1)))\n\n            # Store in g(E,M) dictionary, using integer keys\n            key = (int(E), int(M))\n            g_em[key] = g_em.get(key, 0) + 1\n\n        # 2. Reweight from g(E,M) to get the canonical distribution P_beta(M)\n        # Find the set of all unique magnetization values\n        M_values = sorted(list(set(m for e, m in g_em.keys())))\n        \n        # Calculate unnormalized probabilities and the partition function Z\n        P_M_unnormalized = {m: 0.0 for m in M_values}\n        Z = 0.0\n\n        for (E, M), count in g_em.items():\n            # Use np.longdouble for precision with large exponentials\n            boltzmann_factor = np.exp(np.longdouble(-beta * E))\n            term = count * boltzmann_factor\n            P_M_unnormalized[M] += term\n            Z += term\n\n        # Normalize to get P_beta(M)\n        if Z == 0.0:\n            # This case should not be reached for finite beta\n            P_M = {m: 0.0 for m in M_values}\n        else:\n            P_M = {m: p / Z for m, p in P_M_unnormalized.items()}\n\n        # 3. Compute the requested statistic\n        if stat_type == \"P(M=0)\":\n            # P_beta(M=0)\n            result = P_M.get(0, 0.0)\n        elif stat_type == \"|m|>\":\n            # |m|> = |M/L^2|>\n            mean_abs_M = sum(abs(m) * p for m, p in P_M.items())\n            result = mean_abs_M / N\n        else:\n            raise ValueError(\"Unknown statistic type\")\n\n        results.append(result)\n\n    # Final print statement in the exact required format\n    final_results_str = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(final_results_str)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "当应用于能量范围极宽或存在深邃能量谷（即高自由能垒）的复杂系统时，单个王-Landau随机行走过程可能会被困住，导致收敛极其缓慢。为了解决这个难题，一种被称为窗口化或并行王-Landau抽样的“分而治之”策略被广泛采用，它将总能量范围划分为多个重叠的窗口，并在每个窗口内独立运行模拟。本练习  聚焦于该策略中最关键的挑战：如何以统计上稳健的方式将从各个窗口获得的相对对数态密度“拼接”成一个全局一致的函数，这对于将王-Landau方法应用于前沿研究中的大规模问题至关重要。",
            "id": "5305881",
            "problem": "考虑一个经典的多体系统，其微观态由能量变量 $E$ 标记，该变量在一个覆盖区间 $[E_{\\min},E_{\\max}]$ 的离散网格 $\\{E_i\\}_{i=1}^{M}$ 上取值。态密度 (DOS) $g(E)$ 统计了能量为 $E$ 时的微观态数量，而在逆温度 $\\beta$ 下的正则配分函数为 $Z(\\beta)=\\sum_{i=1}^{M} g(E_i)\\,\\mathrm{e}^{-\\beta E_i}$。在王-Landau (WL) 态密度采样中，采样过程在能量空间中进行随机行走，同时迭代地修改一个估计量 $\\hat g(E)$，以在 $E$ 上获得一个平直的直方图；一旦直方图根据所选标准足够平直，就减小修正因子，并继续此过程直至收敛。由于在一个受限的能量区域内，WL 估计量仅能确定到一个乘法常数，因此在一个子区域内的对数 $\\ln \\hat g(E)$ 仅能确定到一个加法常数。\n\n为了使大型系统中的计算易于处理，可将能量范围划分为 $K$ 个重叠的窗口 $W_k=[E_k^{-},E_k^{+}]$，使得 $E_1^{-}=E_{\\min}$，$E_K^{+}=E_{\\max}$，并且每个窗口 $k$ 与其相邻窗口的重叠部分非空：$O_{k,k+1}=W_k\\cap W_{k+1}=[E_k^{+}-\\Delta,\\,E_{k+1}^{-}+\\Delta]$，其中 $\\Delta0$。在每个窗口 $W_k$ 中，执行仅限于 $W_k$ 范围内的王-Landau (WL) 采样（使用一种能防止边缘访问产生偏差的边界处理方法），以获得对于 $E\\in W_k$ 的估计量 $\\ln \\hat g_k(E)$。假设对于每个离散能量 $E\\in W_k$，WL 估计量给出 $\\ln \\hat g_k(E)=\\ln g(E)+c_k+\\epsilon_k(E)$，其中 $c_k$ 是一个未知的、与窗口相关的加法常数，而 $\\epsilon_k(E)$ 是一个零均值误差，其方差为 $\\sigma_k^2(E)$，近似为高斯分布，并且在不同窗口间不相关。目标是将这些窗口内的估计值合并成一个在 $[E_{\\min},E_{\\max}]$ 上的单一全局估计 $\\ln \\hat g(E)$，并使其偏差最小化且不确定性得到量化。\n\n以下哪种程序是一种统计上一致的方法，用于将能量范围划分为窗口，在每个窗口中运行 WL 算法，并在重叠区域拼接所得的 $\\ln \\hat g_k(E)$ 以获得全局的 $\\ln \\hat g(E)$？\n\nA. 选择具有显著重叠的窗口（例如，重叠宽度大于典型的局域能量空间相关长度），使用反射边界将 WL 随机行走限制在每个窗口内以避免边界引起的偏差，并对每个窗口内的能量直方图要求严格的平直度标准。在每个重叠区 $O_{k,k+1}$ 中，通过最小化加权平方差之和 $\\sum_{E\\in O_{k,k+1}} w(E)\\left[\\ln \\hat g_k(E)-\\ln \\hat g_{k+1}(E)+c_k-c_{k+1}\\right]^2$ 来确定加法常数 $c_k$，其中权重为 $w(E)=\\left[\\sigma_k^2(E)+\\sigma_{k+1}^2(E)\\right]^{-1}$，并通过设置 $c_1=0$ 或施加归一化来固定全局规范。然后，在重叠区通过逆方差加权平均，在非重叠区通过唯一可用的窗口估计来构建全局的 $\\ln \\hat g(E)$。\n\nB. 使用非重叠窗口以避免冗余采样，并通过拒绝任何跨越窗口边界的提议移动来限制 WL 随机行走。在拼接时，通过匹配 $E_k^{+}$ 处的单个边界值来设置 $c_k$，即选择 $c_{k+1}$ 使得 $\\ln \\hat g_k(E_k^{+})+c_k=\\ln \\hat g_{k+1}(E_k^{+})+c_{k+1}$，然后直接连接窗口估计值，不再进行平均。\n\nC. 采用重叠窗口，但不是对齐 $\\ln \\hat g_k(E)$，而是通过对 $\\mathrm{d}\\ln \\hat g_k(E)/\\mathrm{d}E$ 的估计值拟合一个平滑函数，来强制微正则逆温度 $\\beta_{\\mathrm{micro}}(E)=\\mathrm{d}\\ln g(E)/\\mathrm{d}E$ 在重叠区的连续性，并调整拼接后的 $\\ln \\hat g(E)$ 以使其导数连续。依赖全局多项式平滑来设置跨窗口的加法常数。\n\nD. 通过要求每个窗口上的积分态密度等于一个共同的值来确定窗口常数 $c_k$，即对所有 $k$ 强制 $\\sum_{E\\in W_k} \\mathrm{e}^{\\ln \\hat g_k(E)+c_k} = \\text{constant}$，从而使各窗口的归一化相等。在重叠区使用等权重平均，并拒绝边界移动以防止边缘效应。\n\nE. 在重叠窗口中，通过在每个重叠区匹配单一固定逆温度 $\\beta^\\star$ 下的正则能量概率分布 $P_k(E;\\beta)=\\mathrm{e}^{\\ln \\hat g_k(E)+c_k-\\beta E}/Z_k(\\beta)$ 来估计 $c_k$，即选择常数使得对于所有 $E\\in O_{k,k+1}$ 都有 $P_k(E;\\beta^\\star)=P_{k+1}(E;\\beta^\\star)$，并使用这些常数来定义全局的 $\\ln \\hat g(E)$。\n\n选择所有正确的选项，并提供一个基于态密度估计、统计加权和王-Landau 采样的第一性原理的理由。你的推理应涉及窗口设计、边界处理、加法常数的估计、考虑方差的拼接，以及为什么其他程序可能会引入偏差或无法控制不确定性。",
            "solution": "用户要求对问题陈述进行批判性验证，然后给出详细的解决方案并对所提供的选项进行评估。\n\n**问题验证**\n\n**第一步：提取已知条件**\n-   系统：一个经典的多体系统。\n-   能量变量：$E$，在一个区间 $[E_{\\min},E_{\\max}]$ 内的离散网格 $\\{E_i\\}_{i=1}^{M}$ 上取值。\n-   态密度 (DOS)：$g(E)$。\n-   正则配分函数：在逆温度 $\\beta$ 下，$Z(\\beta)=\\sum_{i=1}^{M} g(E_i)\\,\\mathrm{e}^{-\\beta E_i}$。\n-   方法：王-Landau (WL) 采样。\n-   WL 估计量性质：在一个受限的能量区域内，$\\ln \\hat g(E)$ 仅能确定到一个加法常数。\n-   分窗：能量范围被划分为 $K$ 个重叠窗口 $W_k=[E_k^{-},E_k^{+}]$，对于 $k=1, \\dots, K$。\n-   窗口设置：$E_1^{-}=E_{\\min}$，$E_K^{+}=E_{\\max}$。\n-   重叠区域：$O_{k,k+1}=W_k\\cap W_{k+1}=[E_k^{+}-\\Delta,\\,E_{k+1}^{-}+\\Delta]$，其中 $\\Delta0$。\n-   窗口估计模型：对于 $E\\in W_k$，WL 估计量为 $\\ln \\hat g_k(E)=\\ln g(E)+c_k+\\epsilon_k(E)$。\n-   模型参数：$c_k$ 是一个未知的、与窗口相关的加法常数。$\\epsilon_k(E)$ 是一个零均值误差，近似为高斯分布，方差为 $\\sigma_k^2(E)$，并且在不同窗口间不相关。\n-   目标：将窗口估计 $\\ln \\hat g_k(E)$ 合并成一个在 $[E_{\\min},E_{\\max}]$ 上的单一全局估计 $\\ln \\hat g(E)$，并使其偏差最小化且不确定性得到量化。\n-   问题：在所提供的选项中，找出统计上一致的程序。\n\n**第二步：使用提取的已知条件进行验证**\n根据所需标准对问题陈述进行评估：\n-   **科学基础**：是。该问题牢固地建立在计算统计物理学领域。王-Landau 采样、态密度、用于并行化的分窗技术以及拼接结果的统计挑战都是该领域中标准且成熟的概念。所提供的估计量误差的统计模型是分析此类模拟结果时使用的标准且适当的简化。\n-   **定义明确**：是。该问题提供了一个明确的目标（从部分估计中获得全局态密度估计）和一个清晰的数据统计模型。问题要求找到一种“统计上一致的”程序，这在统计学中是一个明确定义的目标，需要一种方法论上合理且能最小化偏差和方差的方法。\n-   **客观性**：是。语言正式、精确，没有主观、模糊或基于观点的陈述。它使用了标准的科学术语。\n\n没有可识别的缺陷。该问题不违反科学原理，是可形式化的，是自洽的，并描述了计算物理学中一个现实且重要的任务。\n\n**第三步：结论与行动**\n问题是**有效的**。开始进行求解。\n\n**推导与选项分析**\n\n问题的核心是确定窗口对数态密度估计量 $\\ln \\hat g_k(E)$ 之间未知的相对加法常数。所提供的模型是 $\\ln \\hat g_k(E) = \\ln g(E) + c_k + \\epsilon_k(E)$，其中 $c_k$ 是窗口 $k$ 的未知偏差，$\\epsilon_k(E)$ 是一个零均值噪声项，其方差为 $\\sigma_k^2(E)$。\n\n找到相对常数的关键在于重叠区域 $O_{k,k+1}$，在这些区域中，我们对同一个真实的底层函数 $\\ln g(E)$ 有两个独立的估计。对于任何能量 $E \\in O_{k,k+1}$，我们有：\n$$ \\ln \\hat g_k(E) = \\ln g(E) + c_k + \\epsilon_k(E) $$\n$$ \\ln \\hat g_{k+1}(E) = \\ln g(E) + c_{k+1} + \\epsilon_{k+1}(E) $$\n将这两个方程相减，可以消去未知的真实值 $\\ln g(E)$：\n$$ \\ln \\hat g_k(E) - \\ln \\hat g_{k+1}(E) = (c_k - c_{k+1}) + (\\epsilon_k(E) - \\epsilon_{k+1}(E)) $$\n令 $Y(E) = \\ln \\hat g_k(E) - \\ln \\hat g_{k+1}(E)$ 为我们的测量值，令 $\\delta_{k,k+1} = c_k - c_{k+1}$ 为我们想要估计的未知参数。该方程的形式为 $Y(E) = \\delta_{k,k+1} + \\eta(E)$，其中误差项为 $\\eta(E) = \\epsilon_k(E) - \\epsilon_{k+1}(E)$。由于 $\\epsilon_k(E)$ 和 $\\epsilon_{k+1}(E)$ 是独立的且均值为零，所以 $\\eta(E)$ 的均值为 $E[\\eta(E)] = 0$。其方差为 $\\text{Var}(\\eta(E)) = \\text{Var}(\\epsilon_k(E)) + \\text{Var}(\\epsilon_{k+1}(E)) = \\sigma_k^2(E) + \\sigma_{k+1}^2(E)$。\n\n对于重叠区域 $O_{k,k+1}$ 中的每个 $E$，我们有多个测量值 $Y(E)$ 来估计单个常数 $\\delta_{k,k+1}$。根据 Gauss-Markov 定理，$\\delta_{k,k+1}$ 的最佳线性无偏估计 (BLUE) 是通过最小化加权残差平方和得到的，其中权重是每次测量的方差的倒数。这对应于一个加权最小二乘拟合。需要最小化的函数是：\n$$ S(\\delta_{k,k+1}) = \\sum_{E \\in O_{k,k+1}} \\frac{1}{\\sigma_k^2(E) + \\sigma_{k+1}^2(E)} \\left( Y(E) - \\delta_{k,k+1} \\right)^2 $$\n$$ S(\\delta_{k,k+1}) = \\sum_{E \\in O_{k,k+1}} \\frac{1}{\\sigma_k^2(E) + \\sigma_{k+1}^2(E)} \\left( (\\ln \\hat g_k(E) - \\ln \\hat g_{k+1}(E)) - (c_k - c_{k+1}) \\right)^2 $$\n这个过程可以最优地确定相对偏移量。为了确定常数 $c_k$ 的绝对值，必须施加一个全局约束，例如将一个常数设为零（例如，$c_1=0$，这是一种规范选择）或应用某种全局归一化。\n\n一旦确定了常数，重叠区域中 $\\ln g(E)$ 的最佳估计是对齐后的估计值的逆方差加权平均。在仅属于窗口 $W_k$ 的非重叠区域中，最佳估计就是该窗口的对齐后估计。整个过程在统计上是稳健的，并最优地利用了可用的数据和误差模型。\n\n现在我们根据这些原则评估每个选项。\n\n**A. 选择具有显著重叠的窗口（例如，重叠宽度大于典型的局域能量空间相关长度），使用反射边界将 WL 随机行走限制在每个窗口内以避免边界引起的偏差，并对每个窗口内的能量直方图要求严格的平直度标准。在每个重叠区 $O_{k,k+1}$ 中，通过最小化加权平方差之和 $\\sum_{E\\in O_{k,k+1}} w(E)\\left[\\ln \\hat g_k(E)-\\ln \\hat g_{k+1}(E)+c_k-c_{k+1}\\right]^2$ 来确定加法常数 $c_k$，其中权重为 $w(E)=\\left[\\sigma_k^2(E)+\\sigma_{k+1}^2(E)\\right]^{-1}$，并通过设置 $c_1=0$ 或施加归一化来固定全局规范。然后，在重叠区通过逆方差加权平均，在非重叠区通过唯一可用的窗口估计来构建全局的 $\\ln \\hat g(E)$。**\n\n该选项描述了上面推导出的统计最优过程。\n-   它正确地指出了需要显著的重叠以为匹配提供良好的统计基础。\n-   它指定了反射边界，这是一种处理窗口边缘的有效方法，不会引入简单拒绝方案特有的偏差。\n-   它提议通过最小化加权平方差之和来找到常数。需要最小化的表达式是 $\\sum w(E)[(\\ln \\hat g_k(E)-\\ln \\hat g_{k+1}(E))-(c_{k+1}-c_k)]^2$，这与用于估计差值 $c_{k+1}-c_k$ 的加权最小二乘法公式完全匹配。\n-   它使用了正确的逆方差权重 $w(E)=\\left[\\sigma_k^2(E)+\\sigma_{k+1}^2(E)\\right]^{-1}$。\n-   它正确地指出了需要进行规范固定（例如，$c_1=0$）。\n-   它采用最优的逆方差加权平均来合并重叠区域中的数据。\n每一步在统计上都是合理的，并与最佳实践一致。\n**结论：正确**\n\n**B. 使用非重叠窗口以避免冗余采样，并通过拒绝任何跨越窗口边界的提议移动来限制 WL 随机行走。在拼接时，通过匹配 $E_k^{+}$ 处的单个边界值来设置 $c_k$，即选择 $c_{k+1}$ 使得 $\\ln \\hat g_k(E_k^{+})+c_k=\\ln \\hat g_{k+1}(E_k^{+})+c_{k+1}$，然后直接连接窗口估计值，不再进行平均。**\n\n该选项存在严重缺陷。\n-   非重叠窗口无法对相对常数进行稳健的统计确定。没有冗余数据区域可以用来平均以减少噪声。\n-   匹配仅基于边界处的一个有噪声的数据点 $\\ln \\hat g_k(E_k^{+})$。这在统计上是脆弱的，极易受到涨落的影响。\n-   已知在边界处拒绝移动会引入系统性偏差。被阻止离开某个区域的随机行走会过度采样边界处的状态，从而人为地增加其估计的态密度。\n**结论：不正确**\n\n**C. 采用重叠窗口，但不是对齐 $\\ln \\hat g_k(E)$，而是通过对 $\\mathrm{d}\\ln \\hat g_k(E)/\\mathrm{d}E$ 的估计值拟合一个平滑函数，来强制微正则逆温度 $\\beta_{\\mathrm{micro}}(E)=\\mathrm{d}\\ln g(E)/\\mathrm{d}E$ 在重叠区的连续性，并调整拼接后的 $\\ln \\hat g(E)$ 以使其导数连续。依赖全局多项式平滑来设置跨窗口的加法常数。**\n\n该选项基于一个物理上正确的原则，但提出的实现方法有缺陷。\n-   对数态密度的导数 $\\beta_{\\mathrm{micro}}(E)$ 确实应该是连续的。然而，对有噪声的数据（如 $\\ln \\hat g_k(E)$）进行数值微分会显著放大噪声。与使用更平滑的积分数据 $\\ln \\hat g_k(E)$ 相比，基于这些高度噪声化的导数估计的过程在统计上是不稳定的。\n-   关键在于，常数 $c_k$ 是加法性的：$\\ln \\hat g_k(E) = \\ln g(E) + c_k + \\epsilon_k(E)$。其导数为 $\\mathrm{d}\\ln\\hat g_k(E)/\\mathrm{d}E = \\mathrm{d}\\ln g(E)/\\mathrm{d}E + \\mathrm{d}\\epsilon_k(E)/\\mathrm{d}E$。常数 $c_k$ 消失了。因此，强制导数的连续性*不能*用来确定 $c_k$ 的相对值。该陈述声称此过程“设置加法常数”是不正确的。人们仍然必须对得到的 $\\beta(E)$ 进行积分并固定积分常数，这又回到了最初匹配函数值的问题。\n**结论：不正确**\n\n**D. 通过要求每个窗口上的积分态密度等于一个共同的值来确定窗口常数 $c_k$，即对所有 $k$ 强制 $\\sum_{E\\in W_k} \\mathrm{e}^{\\ln \\hat g_k(E)+c_k} = \\text{constant}$，从而使各窗口的归一化相等。在重叠区使用等权重平均，并拒绝边界移动以防止边缘效应。**\n\n该选项基于一个没有物理依据的假设。\n-   其核心前提是强制对所有窗口 $k$ 满足 $\\int_{W_k} g(E) dE = \\text{constant}$。对于多体系统，态密度 $g(E)$ 通常随能量超指数增长。位于较高能量的窗口将比位于较低能量的窗口包含多出几个数量级的状态。强制要求所有窗口的积分态密度相等违反了底层物理学，并将引入严重的系统误差。\n-   它提议在重叠区使用等权重平均，这在统计上是次优的，因为它忽略了数据的异方差性（方差不相等）。\n-   它提议拒绝边界移动，正如对选项 B 的说明，这会引入偏差。\n**结论：不正确**\n\n**E. 在重叠窗口中，通过在每个重叠区匹配单一固定逆温度 $\\beta^\\star$ 下的正则能量概率分布 $P_k(E;\\beta)=\\mathrm{e}^{\\ln \\hat g_k(E)+c_k-\\beta E}/Z_k(\\beta)$ 来估计 $c_k$，即选择常数使得对于所有 $E\\in O_{k,k+1}$ 都有 $P_k(E;\\beta^\\star)=P_{k+1}(E;\\beta^\\star)$，并使用这些常数来定义全局的 $\\ln \\hat g(E)$。**\n\n该选项描述了一个在数学上无法实现其所述目标的过程。在温度 $\\beta^\\star$ 下，窗口 $k$ 中的概率分布，使用所提供的估计量为：\n$$ P_k(E;\\beta^\\star) = \\frac{\\mathrm{e}^{\\ln \\hat g_k(E)+c_k-\\beta^\\star E}}{Z_k(\\beta^\\star)} $$\n配分函数 $Z_k(\\beta^\\star)$ 是归一化常数，通过对窗口 $W_k$ 内的所有状态求和计算得出：\n$$ Z_k(\\beta^\\star) = \\sum_{E' \\in W_k} \\mathrm{e}^{\\ln \\hat g_k(E')+c_k-\\beta^\\star E'} = \\mathrm{e}^{c_k} \\sum_{E' \\in W_k} \\mathrm{e}^{\\ln \\hat g_k(E')-\\beta^\\star E'} $$\n将此代入 $P_k(E;\\beta^\\star)$ 的表达式中：\n$$ P_k(E;\\beta^\\star) = \\frac{\\mathrm{e}^{c_k} \\mathrm{e}^{\\ln \\hat g_k(E)-\\beta^\\star E}}{\\mathrm{e}^{c_k} \\sum_{E' \\in W_k} \\mathrm{e}^{\\ln \\hat g_k(E')-\\beta^\\star E'}} = \\frac{\\mathrm{e}^{\\ln \\hat g_k(E)-\\beta^\\star E}}{\\sum_{E' \\in W_k} \\mathrm{e}^{\\ln \\hat g_k(E')-\\beta^\\star E'}} $$\n常数 $c_k$ 从归一化概率分布 $P_k$ 的表达式中完全抵消了。同样的情况也适用于 $P_{k+1}$。因此，条件 $P_k(E;\\beta^\\star)=P_{k+1}(E;\\beta^\\star)$ 是一个不包含未知常数 $c_k$ 和 $c_{k+1}$ 的方程。因此，不可能通过解这个方程来求出它们。这个程序构思不当。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}