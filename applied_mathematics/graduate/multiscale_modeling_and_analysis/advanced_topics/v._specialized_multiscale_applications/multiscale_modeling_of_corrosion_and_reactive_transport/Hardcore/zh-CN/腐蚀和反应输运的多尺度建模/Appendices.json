{
    "hands_on_practices": [
        {
            "introduction": "点蚀是一种极具破坏性的局部腐蚀形式，其动力学往往由传质过程控制。本练习将演示如何通过求解电解液中反应物的稳态扩散方程来建立腐蚀坑的生长模型。这是一个经典的移动边界问题，其几何形状的演化速率与扩散通量直接耦合，掌握该模型对于理解和预测局部腐蚀的发展至关重要。",
            "id": "3785096",
            "problem": "考虑金属基底在水性电解质中发生腐蚀，形成一个单一的、轴对称的半球形腐蚀坑，其半径 $R(t)$ 随时间变化，蚀刻在基底上。假设溶解过程完全由电解质中单一氧化反应物种 $A$ 的传输所控制，该物种在远离腐蚀坑处的体相浓度为 $c_{\\infty}$。物种 $A$ 的摩尔扩散系数为 $D$，其在电解质中的浓度场 $c(\\mathbf{x})$ 在微观尺度上由无均相反应的准稳态扩散控制，因此浓度在腐蚀坑外部的电解质区域内满足拉普拉斯方程 $\\nabla^{2} c = 0$。腐蚀坑表面是完全反应性的，因此在金属-电解质界面处 $A$ 的浓度为 $c = 0$；腐蚀坑外的平面基底是不可渗透的（反射性的），因此其上的法向扩散通量为零；且当 $|\\mathbf{x}| \\to \\infty$ 时，$c \\to c_{\\infty}$。\n\n设物种 $A$ 在腐蚀坑表面被消耗，其化学计量系数为 $\\nu$（每摩尔金属溶解消耗 $\\nu$ 摩尔的 $A$）。设金属的摩尔体积为 $\\Omega$，并假设在移动的溶解前沿处存在局部微观尺度的质量守恒，因此法向界面速度 $v_{n}$ 等于摩尔体积乘以单位面积上金属的摩尔溶解速率。采用菲克扩散定律作为扩散的本构描述，$\\mathbf{J} = - D \\nabla c$，其中 $\\mathbf{J}$ 是 $A$ 的摩尔通量。\n\n将半球形腐蚀坑建模为一个位于平面反射基底上方的半空间电解质中、半径为 $R(t)$ 的半球。将浓度问题视为轴对称问题，并援引科学实在论来证明准稳态假设和半空间反射条件的合理性。\n\n从控制方程 $\\nabla^{2} c = 0$、上述边界条件、菲克定律以及界面质量守恒关系出发，推导腐蚀坑半径 $R(t)$ 作为时间函数的闭式表达式，给定初始半径 $R(0) = R_{0}$。你的最终答案必须是关于 $R_{0}$、$D$、$c_{\\infty}$、$\\nu$、$\\Omega$ 和 $t$ 的单个闭式解析表达式。不需要进行数值计算，也不应进行四舍五入。明确地表示出最终的半径-时间定律 $R(t)$。",
            "solution": "该问题要求推导在扩散控制生长条件下，半球形腐蚀坑随时间变化的半径 $R(t)$。求解过程首先在准稳态假设下求解反应物种的浓度场，然后计算到达腐蚀坑表面的反应物通量，将此通量与腐蚀坑的生长速率关联起来，最后对得到的半径微分方程进行积分。\n\n电解质中反应物种 $A$ 的浓度场 $c(\\mathbf{x})$ 由准稳态扩散方程控制，即拉普拉斯方程：\n$$\n\\nabla^{2} c = 0\n$$\n边界条件为：\n$1$. 在半径为 $R(t)$ 的半球形腐蚀坑表面上，$c=0$。\n$2$. 在腐蚀坑外的平面基底上，法向扩散通量为零。\n$3$. 远离腐蚀坑处，$c \\to c_{\\infty}$。\n\n处理无限大绝缘平面上的半球形汇的几何形状，最好的方法是使用镜像法。该问题等效于求解无限、无限制介质中一个半径为 $R$ 的完整球形汇周围的浓度场，其中球体表面的浓度为 $c=0$，远离球体处的浓度为 $c=c_{\\infty}$。根据对称性，完整球体问题的浓度场在对应于原问题中基底平面的赤道平面上，其法向梯度分量为零。通量矢量 $\\mathbf{J} = -D \\nabla c$ 与梯度 $\\nabla c$ 平行。梯度矢量在各处都垂直于等浓度面。对于球对称问题，等浓度面是与汇同心的球面，梯度是纯径向的。因此，通量也是纯径向的。基底平面（比如 $z=0$ 平面）的法向量是 $\\hat{\\mathbf{k}}$。此平面上的法向通量分量是 $\\mathbf{J} \\cdot \\hat{\\mathbf{k}}$。对于 $z=0$ 平面上远离原点的任意点，径向矢量 $\\mathbf{r}$ 与 $\\hat{\\mathbf{k}}$ 垂直，因此通量 $\\mathbf{J}$ 也与 $\\hat{\\mathbf{k}}$ 垂直。这就满足了基底上的零通量（反射）边界条件 $\\mathbf{J} \\cdot \\hat{\\mathbf{n}} = 0$。\n\n对于等效的完整球体问题，我们采用球坐标系 $(r, \\theta, \\phi)$。由于边界条件的球对称性，浓度 $c$ 将仅是径向距离 $r$ 的函数，即 $c=c(r)$。拉普拉斯方程简化为：\n$$\n\\frac{1}{r^{2}} \\frac{d}{dr} \\left( r^{2} \\frac{dc}{dr} \\right) = 0\n$$\n对该方程积分两次，得到通解：\n$$\nc(r) = A + \\frac{B}{r}\n$$\n其中 $A$ 和 $B$ 是积分常数。我们使用完整球体问题的边界条件来确定这些常数：\n$1$. 在无穷远处，当 $r \\to \\infty$ 时，$c \\to c_{\\infty}$。这得出 $c_{\\infty} = A + 0$，所以 $A = c_{\\infty}$。\n$2$. 在球体表面，当 $r=R(t)$ 时，$c=0$。对于给定的时间瞬间 $t$，$R(t)$ 被视为一个固定的半径 $R$。所以，$0 = A + \\frac{B}{R} = c_{\\infty} + \\frac{B}{R}$，这得出 $B = -c_{\\infty}R$。\n\n将常数 $A$ 和 $B$ 代回通解，我们得到腐蚀坑周围（对于 $r \\geq R(t)$）的准稳态浓度场：\n$$\nc(r) = c_{\\infty} \\left( 1 - \\frac{R(t)}{r} \\right)\n$$\n\n接下来，我们使用菲克定律 $\\mathbf{J} = -D \\nabla c$ 计算进入腐蚀坑表面的物种 $A$ 的摩尔通量。浓度场的梯度为：\n$$\n\\nabla c = \\frac{dc}{dr} \\hat{\\mathbf{r}} = \\frac{d}{dr} \\left[ c_{\\infty} \\left( 1 - \\frac{R}{r} \\right) \\right] \\hat{\\mathbf{r}} = \\frac{c_{\\infty}R}{r^{2}} \\hat{\\mathbf{r}}\n$$\n通量矢量则为：\n$$\n\\mathbf{J} = -D \\frac{c_{\\infty}R}{r^{2}} \\hat{\\mathbf{r}}\n$$\n负号表示通量方向向内，指向腐蚀坑中心，这与物种 $A$ 在表面被消耗的情况相符。在腐蚀坑表面单位面积上 $A$ 的消耗速率 $J_{n}$，是在 $r=R(t)$ 处计算的通量大小：\n$$\nJ_{n} = |\\mathbf{J}|_{r=R} = \\left| -D \\frac{c_{\\infty}R}{R^{2}} \\hat{\\mathbf{r}} \\right| = \\frac{D c_{\\infty}}{R}\n$$\n\n问题陈述，法向界面速度 $v_{n}$ 等于金属的摩尔体积 $\\Omega$ 乘以单位面积上金属的摩尔溶解速率。界面速度是腐蚀坑半径的变化率，$v_{n} = \\frac{dR}{dt}$。金属的摩尔溶解速率通过化学计量系数 $\\nu$ 与物种 $A$ 的消耗速率相关联，$\\nu$ 定义为每摩尔金属溶解所消耗的 $A$ 的摩尔数。因此，单位面积上金属的摩尔溶解速率为 $\\frac{J_{n}}{\\nu}$。界面根据质量守恒关系移动：\n$$\nv_{n} = \\frac{dR}{dt} = \\Omega \\left( \\frac{J_{n}}{\\nu} \\right)\n$$\n代入推导出的 $J_{n}$ 表达式：\n$$\n\\frac{dR}{dt} = \\frac{\\Omega}{\\nu} \\left( \\frac{D c_{\\infty}}{R} \\right)\n$$\n这是一个关于 $R(t)$ 的一阶常微分方程。它可以通过分离变量法求解：\n$$\nR \\, dR = \\left( \\frac{\\Omega D c_{\\infty}}{\\nu} \\right) dt\n$$\n我们将此方程从初始条件（时间 $t=0$ 时 $R(0) = R_{0}$）积分到时间 $t$ 时的 $R(t)$：\n$$\n\\int_{R_{0}}^{R(t)} R' \\, dR' = \\int_{0}^{t} \\frac{\\Omega D c_{\\infty}}{\\nu} \\, dt'\n$$\n执行积分得到：\n$$\n\\left[ \\frac{(R')^{2}}{2} \\right]_{R_{0}}^{R(t)} = \\left( \\frac{\\Omega D c_{\\infty}}{\\nu} \\right) [t']_{0}^{t}\n$$\n$$\n\\frac{R(t)^{2}}{2} - \\frac{R_{0}^{2}}{2} = \\frac{\\Omega D c_{\\infty}}{\\nu} t\n$$\n现在，我们求解 $R(t)^{2}$：\n$$\nR(t)^{2} = R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu}\n$$\n对两边取平方根，得到腐蚀坑半径作为时间函数的最终表达式。由于半径必须是正值，我们取正根：\n$$\nR(t) = \\left( R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu} \\right)^{1/2}\n$$\n这就是在扩散控制条件下，腐蚀坑半径演化的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\left(R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu}\\right)^{1/2}}\n$$"
        },
        {
            "introduction": "腐蚀过程通常会生成多孔的产物层，其内部的输运过程会显著影响整体反应。本练习从外部输运问题过渡到内部限制问题，探讨了在这种多孔结构中，化学反应和扩散之间的相互作用如何决定宏观腐蚀速率。通过这个练习，你将掌握泰勒模量（Thiele modulus）$ \\phi $和有效因子（effectiveness factor）$ \\eta $这两个核心概念，它们是量化多孔介质中反应-扩散耦合效应的关键。",
            "id": "3785100",
            "problem": "一个半径为 $R$ 的球形多孔腐蚀产物颗粒浸在一个水系电解质中，其中含有一种氧化性物质，其本体浓度为 $c_{\\infty}$。该氧化性物质通过孔隙网络扩散，其有效扩散系数为 $D$，并被固体的溶解反应所消耗，单位孔隙体积的反应速率由一级定律 $r(c)=k\\,c$ 描述，其中 $k$ 是本征一级速率常数，$c(r)$ 是径向位置 $r$ 处氧化性物质的浓度。假设稳态、等温条件、均匀孔隙率以及可忽略的外部传质阻力，因此 $c(R)=c_{s}$，其中表面浓度 $c_{s}$ 等于 $c_{\\infty}$。当本征动力学相对于传输较慢时，该过程代表了孔隙尺度下溶解限制的腐蚀，但内部扩散-反应平衡仍能影响宏观腐蚀速率。\n\n从 Fick 定律和物种连续性方程出发，建立球对称条件下关于 $c(r)$ 的控制偏微分方程 (PDE)。使用特征长度 $L$ 对该 PDE 进行无量纲化，并说明比较反应与扩散的无量纲数组是如何自然产生的。根据材料和几何参数定义 Thiele 模数。\n\n然后，求解 $c(r)$ 的边值问题，并推导颗粒上积分的总 volumetric reaction rate（体积反应速率）的表达式。将溶解限制腐蚀的有效因子 $\\eta$ 定义为实际积分速率与假设整个颗粒都处于表面浓度 $c_{s}$ 时的速率之比，并获得 $\\eta$ 作为 Thiele 模数的函数的封闭形式表达式。\n\n将您的最终答案表示为有效因子关于 Thiele 模数的单个封闭形式解析表达式。最终表达式无需四舍五入，也不应包含单位。",
            "solution": "该问题陈述是传递现象和化学反应工程中一个有效且适定的问题，具体涉及多孔介质中的扩散和反应。它具有科学依据，内部一致，并包含推导唯一且有意义的解所需的所有信息。因此，我们可以开始求解。\n\n稳态下控制物种浓度的基本原理是物种连续性方程。对于被反应消耗的物种，表示为：\n$$\n\\nabla \\cdot \\mathbf{J} + \\mathcal{R} = 0\n$$\n其中 $\\mathbf{J}$ 是物种的摩尔通量矢量，$\\mathcal{R}$ 是体积消耗速率。\n\n由扩散引起的摩尔通量由 Fick 第一定律描述：\n$$\n\\mathbf{J} = -D \\nabla c\n$$\n其中 $D$ 是有效扩散系数，$c$ 是物种浓度。\n\n问题陈述指出，单位孔隙体积的消耗速率为 $r(c) = k\\,c$。在多孔介质的背景下，连续性方程应用于包含固体和孔隙空间的控制体积。因此，单位介质总体积的消耗速率 $\\mathcal{R}$ 是单位孔隙体积的速率乘以孔隙率 $\\epsilon$。然而，该领域的标准做法是定义一个有效速率常数，为简单起见，我们也用 $k$ 表示，它描述了单位总体积的速率。因此，我们设 $\\mathcal{R} = k c$。\n\n将 Fick 定律和反应速率代入连续性方程，我们得到：\n$$\n\\nabla \\cdot (-D \\nabla c) + k c = 0\n$$\n假设有效扩散系数 $D$ 是常数，这简化为：\n$$\n-D \\nabla^2 c + k c = 0 \\implies \\nabla^2 c = \\frac{k}{D} c\n$$\n对于球对称系统，其中浓度 $c$ 仅取决于径向位置 $r$，拉普拉斯算子 $\\nabla^2$ 由下式给出：\n$$\n\\nabla^2 c(r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right)\n$$\n因此，浓度分布 $c(r)$ 的控制常微分方程 (ODE) 是：\n$$\n\\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) = \\frac{k}{D} c\n$$\n这可以展开为：\n$$\n\\frac{d^2c}{dr^2} + \\frac{2}{r} \\frac{dc}{dr} - \\frac{k}{D} c = 0\n$$\n为使该方程无量纲化，我们引入一个特征长度，对于球体来说，自然是其半径 $L=R$。我们定义无量纲半径 $\\rho$ 和无量纲浓度 $\\psi$：\n$$\n\\rho = \\frac{r}{R}, \\quad \\psi = \\frac{c}{c_s}\n$$\n其中 $c_s = c_{\\infty}$ 是颗粒表面的浓度。导数转换为：\n$$\n\\frac{dc}{dr} = \\frac{c_s}{R} \\frac{d\\psi}{d\\rho}, \\quad \\frac{d^2c}{dr^2} = \\frac{c_s}{R^2} \\frac{d^2\\psi}{d\\rho^2}\n$$\n将这些代入控制 ODE 得到：\n$$\n\\frac{c_s}{R^2} \\frac{d^2\\psi}{d\\rho^2} + \\frac{2}{\\rho R} \\left(\\frac{c_s}{R} \\frac{d\\psi}{d\\rho}\\right) - \\frac{k}{D} (c_s \\psi) = 0\n$$\n两边同除以 $c_s/R^2$ 得到无量纲 ODE：\n$$\n\\frac{d^2\\psi}{d\\rho^2} + \\frac{2}{\\rho} \\frac{d\\psi}{d\\rho} - \\left(\\frac{k R^2}{D}\\right) \\psi = 0\n$$\n一个无量纲数组自然产生，通常定义为 Thiele 模数 $\\phi$ 的平方。Thiele 模数定义为：\n$$\n\\phi = R \\sqrt{\\frac{k}{D}}\n$$\n该模数比较了反应的特征速率 ($k c_s R^3$) 与扩散的特征速率 ($D c_s R$)。大的 $\\phi$ 表示反应相对于扩散很快，导致颗粒内出现显著的浓度梯度。相反，小的 $\\phi$ 表示扩散相对于反应很快，导致几乎均匀的浓度分布。\n\n无量纲问题现在是一个边值问题 (BVP)：\n$$\n\\frac{d^2\\psi}{d\\rho^2} + \\frac{2}{\\rho} \\frac{d\\psi}{d\\rho} - \\phi^2 \\psi = 0\n$$\n边界条件为：\n1. 在表面（$r=R$，因此 $\\rho=1$）：$c(R) = c_s$，这意味着 $\\psi(1) = 1$。\n2. 在中心（$r=0$，因此 $\\rho=0$）：由于对称性，浓度梯度必须为零，$\\frac{dc}{dr}|_{r=0} = 0$，这意味着 $\\frac{d\\psi}{d\\rho}|_{\\rho=0} = 0$。一个等效的条件是浓度在中心必须是有限的。\n\n为了求解这个 ODE，我们使用代换 $\\psi(\\rho) = \\frac{u(\\rho)}{\\rho}$。$\\psi$ 的导数是：\n$$\n\\frac{d\\psi}{d\\rho} = \\frac{u'}{\\rho} - \\frac{u}{\\rho^2}, \\quad \\frac{d^2\\psi}{d\\rho^2} = \\frac{u''}{\\rho} - \\frac{2u'}{\\rho^2} + \\frac{2u}{\\rho^3}\n$$\n将这些代入无量纲 ODE 将其简化为：\n$$\n\\frac{d^2u}{d\\rho^2} - \\phi^2 u = 0\n$$\n$u(\\rho)$ 的通解是 $u(\\rho) = A \\cosh(\\phi \\rho) + B \\sinh(\\phi \\rho)$。因此，$\\psi(\\rho)$ 的解是：\n$$\n\\psi(\\rho) = \\frac{A \\cosh(\\phi \\rho) + B \\sinh(\\phi \\rho)}{\\rho}\n$$\n应用 $\\rho=0$ 处的边界条件：为了使 $\\psi(0)$ 有限，我们必须有 $A=0$，因为 $\\lim_{\\rho\\to 0} \\frac{\\cosh(\\phi \\rho)}{\\rho} \\to \\infty$。因此，解的形式为 $\\psi(\\rho) = B \\frac{\\sinh(\\phi \\rho)}{\\rho}$。\n应用 $\\rho=1$ 处的边界条件：$\\psi(1) = 1$，这给出 $1 = B \\frac{\\sinh(\\phi)}{1}$，所以 $B = \\frac{1}{\\sinh(\\phi)}$。\n无量纲浓度分布是：\n$$\n\\psi(\\rho) = \\frac{\\sinh(\\phi \\rho)}{\\rho \\sinh(\\phi)}\n$$\n有量纲的浓度分布是 $c(r) = c_s \\frac{\\sinh(\\phi r/R)}{(r/R) \\sinh(\\phi)}$。\n\n接下来，我们通过对颗粒体积 $V$ 上的局部速率进行积分来计算总体积反应速率 $W_{actual}$：\n$$\nW_{actual} = \\int_{V} k c(r) dV = \\int_{0}^{R} k c(r) (4\\pi r^2) dr\n$$\n$$\nW_{actual} = 4\\pi k \\int_{0}^{R} \\left(c_s \\frac{\\sinh(\\phi r/R)}{(r/R) \\sinh(\\phi)}\\right) r^2 dr = \\frac{4\\pi k c_s R}{\\sinh(\\phi)} \\int_{0}^{R} r \\sinh(\\phi r/R) dr\n$$\n可以使用分部积分法求解该积分，得到：\n$$\n\\int_{0}^{R} r \\sinh(\\phi r/R) dr = \\frac{R^2}{\\phi^2} [\\phi \\cosh(\\phi) - \\sinh(\\phi)]\n$$\n将此结果代回 $W_{actual}$ 的表达式中：\n$$\nW_{actual} = \\frac{4\\pi k c_s R}{\\sinh(\\phi)} \\frac{R^2}{\\phi^2} (\\phi \\cosh(\\phi) - \\sinh(\\phi)) = \\frac{4\\pi k c_s R^3}{\\phi^2} \\left(\\phi \\frac{\\cosh(\\phi)}{\\sinh(\\phi)} - 1\\right)\n$$\n$$\nW_{actual} = \\frac{4\\pi k c_s R^3}{\\phi^2} (\\phi \\coth(\\phi) - 1)\n$$\n问题将有效因子 $\\eta$ 定义为实际速率与假设整个颗粒处于表面浓度 $c_s$ 时的假设速率之比。这个最大可能速率 $W_{max}$ 是：\n$$\nW_{max} = k c_s V = k c_s \\left(\\frac{4}{3}\\pi R^3\\right)\n$$\n因此，有效因子 $\\eta$ 是：\n$$\n\\eta = \\frac{W_{actual}}{W_{max}} = \\frac{\\frac{4\\pi k c_s R^3}{\\phi^2} (\\phi \\coth(\\phi) - 1)}{k c_s \\frac{4}{3}\\pi R^3}\n$$\n简化表达式，我们得到：\n$$\n\\eta = \\frac{3}{\\phi^2} (\\phi \\coth(\\phi) - 1)\n$$\n这是球形颗粒中一级反应的有效因子关于 Thiele 模数 $\\phi$ 的封闭形式表达式。",
            "answer": "$$\\boxed{\\frac{3}{\\phi^2} \\left( \\phi \\coth(\\phi) - 1 \\right)}$$"
        },
        {
            "introduction": "宏观模型中的反应速率等参数并非凭空而来，而是源于微观尺度的原子事件。本练习将展示如何将连续介质模型与底层的原子级过程联系起来，通过使用动力学蒙特卡洛（KMC）这一强大的原子尺度模拟技术，从粒子随机跳跃的基本原理出发，推导出宏观溶解速率。这为你提供了一次真正的多尺度链接实践，让你从根本上理解宏观参数的物理起源。",
            "id": "3785135",
            "problem": "要求您通过计算平均首过时间 (MFPT) 并将其与宏观通量相关联，从微观动力学蒙特卡洛 (KMC) 模型中推导并实现一个粗粒化溶解反应速率。该微观模型是在一个代表反应性表面段的一维晶格上，单个空位的连续时间随机行走。该晶格由 $N$ 个标记为 $1$ 到 $N$ 的内部格点，以及两个标记为 $0$ 和 $N+1$ 的边界格点组成。空位以速率 $k_h$ (单位：每秒) 在最近邻之间跳跃。在每个边界格点，空位可以以速率 $k_h$ 返回内部，或者以速率 $k_d$ (单位：每秒) 触发溶解事件 (被宏观汇吸收)。一次溶解事件对应于一个表面原子从固相中移除并进入溶液相。\n\n使用的基本原理：\n- 动力学蒙特卡洛 (KMC) 动力学被建模为在一个带有吸收汇的瞬态有限状态空间上的连续时间马尔可夫链 (CTMC)。瞬态的无穷小生成元矩阵 $\\mathbf{Q}$ 通过化学主方程 $\\mathrm{d}\\mathbf{p}(t)/\\mathrm{d}t = \\mathbf{p}(t)\\mathbf{Q}$ 控制概率向量 $\\mathbf{p}(t)$ 的演化。\n- 对于一个 CTMC，到达吸收态的平均首过时间 (MFPT) 向量 $\\mathbf{t}$ 满足线性系统 $\\mathbf{Q}\\,\\mathbf{t} = -\\mathbf{1}$，其中 $\\mathbf{1}$ 是一个全一向量。前提是瞬态集合包含所有非吸收态，并且总吸收速率为正。\n- 粗粒化单位格点反应速率 $k_{\\mathrm{eff}}$ (单位：每秒) 与 MFPT 通过 $k_{\\mathrm{eff}} = 1/\\langle \\tau \\rangle$ 相关，其中 $\\langle \\tau \\rangle$ 是在引入单个空位时，对微观状态的初始分布进行平均的 MFPT。\n- 宏观摩尔通量 $J$ (单位：摩尔每平方米每秒) 可以通过将单位格点事件频率乘以活性位点密度，并使用阿伏伽德罗常数将原子数转换为摩尔数来获得。\n\n微观模型规范：\n- 状态和跃迁：\n  - 内部状态为 $i \\in \\{1,2,\\dots,N\\}$。从每个 $i$ 出发，向 $i-1$ 和 $i+1$ 的跃迁速率均为 $k_h$。\n  - 边界状态为 $0$ 和 $N+1$。从每个边界出发，向其相邻的内部状态的跃迁速率为 $k_h$，向吸收汇的跃迁速率为 $k_d$。吸收汇不包含在瞬态状态空间中。\n- 瞬态 $\\{0,1,2,\\dots,N,N+1\\}$ 上的生成元 $\\mathbf{Q}$：\n  - 对于内部 $i \\in \\{1,\\dots,N\\}$: $Q_{i,i} = -2k_h$, $Q_{i,i-1} = k_h$, $Q_{i,i+1} = k_h$。\n  - 对于边界 $0$: $Q_{0,0} = -(k_h + k_d)$, $Q_{0,1} = k_h$。\n  - 对于边界 $N+1$: $Q_{N+1,N+1} = -(k_h + k_d)$, $Q_{N+1,N} = k_h$。\n- MFPT 的初始微观分布：在内部格点上均匀分布，即对于 $i \\in \\{1,\\dots,N\\}$ 有 $p_0(i) = 1/N$，而 $p_0(0) = p_0(N+1) = 0$。\n- MFPT 计算：求解 $\\mathbf{Q}\\,\\mathbf{t} = -\\mathbf{1}$ 得到 $\\mathbf{t}$，然后计算 $\\langle \\tau \\rangle = \\sum_{i} p_0(i)\\,t_i$。\n- 粗粒化量：\n  - 单位格点溶解速率：$k_{\\mathrm{eff}} = 1/\\langle \\tau \\rangle$，单位为每秒。\n  - 摩尔通量：$J = S \\, k_{\\mathrm{eff}} / N_A$，单位为摩尔每平方米每秒，其中 $S$ 是活性位点密度，单位为位点每平方米，$N_A$ 是阿伏伽德罗常数。\n\n物理常数和单位：\n- 使用阿伏伽德罗常数 $N_A = 6.02214076 \\times 10^{23}$ 每摩尔。\n- 将 $k_h$ 和 $k_d$ 以每秒表示，$S$ 以位点每平方米表示，$k_{\\mathrm{eff}}$ 以每秒表示，$J$ 以摩尔每平方米每秒表示。\n- 本问题不涉及任何角度。\n\n您的任务：\n- 实现一个程序，该程序构建 $\\mathbf{Q}$，求解 $\\mathbf{t}$，计算 $\\langle \\tau \\rangle$，然后为每个测试用例返回 $k_{\\mathrm{eff}}$ 和 $J$。\n- 数值输出要求：对于每个测试用例，输出一个对 $[k_{\\mathrm{eff}}, J]$，两个值均格式化为浮点数。\n\n测试套件：\n- 案例 A (一般情况)：$N = 10$，$k_h = 1.0 \\times 10^{6}$ 每秒，$k_d = 1.0 \\times 10^{5}$ 每秒，$S = 1.0 \\times 10^{16}$ 位点每平方米。\n- 案例 B (反应限制)：$N = 10$，$k_h = 1.0 \\times 10^{6}$ 每秒，$k_d = 1.0 \\times 10^{2}$ 每秒，$S = 1.0 \\times 10^{16}$ 位点每平方米。\n- 案例 C (输运限制)：$N = 100$，$k_h = 1.0 \\times 10^{4}$ 每秒，$k_d = 1.0 \\times 10^{8}$ 每秒，$S = 5.0 \\times 10^{15}$ 位点每平方米。\n- 案例 D (边界情况)：$N = 1$，$k_h = 1.0 \\times 10^{5}$ 每秒，$k_d = 1.0 \\times 10^{5}$ 每秒，$S = 1.0 \\times 10^{16}$ 位点每平方米。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素都是一个形式为 $[k_{\\mathrm{eff}},J]$ 的双元素列表，按给定顺序对应于各个测试用例。例如，输出应类似于 $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$，不含任何附加文本。在打印表示中，将每个浮点数四舍五入到六位有效数字。",
            "solution": "对问题陈述进行了严格审查，并确认其有效。它基于统计力学和随机过程的原理，特别是连续时间马尔可夫链 (CTMC) 的理论，具有科学依据。该问题是良定的，提供了所有必要的参数、常数以及对微观模型的完整、自洽的描述。任务是以计算方式将此模型形式化，这是多尺度建模中一个标准且有意义的练习。不存在任何歧义、矛盾或不科学的前提。\n\n解决方案通过实施所提供的理论框架来推进。问题的核心是计算引入到反应表面上的空位到达溶解事件的平均时间，并由此推导出宏观反应速率和通量。这通过以下步骤完成。\n\n首先，我们将系统建模为 CTMC。空位位置的状态空间 $\\mathcal{S}$ 由 $N+2$ 个瞬态组成，标记为 $\\{0, 1, \\dots, N, N+1\\}$。状态 $i \\in \\{1, \\dots, N\\}$ 是内部格点，而状态 $0$ 和 $N+1$ 是边界格点。溶解被视为从边界格点到吸收汇状态的跃迁，该吸收汇状态不包含在瞬态状态空间 $\\mathcal{S}$ 中。\n\n其次，我们为瞬态构建无穷小生成元矩阵 $\\mathbf{Q}$。这个 $(N+2) \\times (N+2)$ 的矩阵编码了 $\\mathcal{S}$ 中状态之间的跃迁速率。$i \\neq j$ 的元素 $Q_{ij}$ 表示从状态 $i$到状态 $j$ 的跃迁速率，而对角元素 $Q_{ii}$ 是从状态 $i$ 传出的速率总和的负值，包括向吸收汇的跃迁。根据问题描述，$\\mathbf{Q}$ 的非零元素为：\n- 对于边界状态 $i=0$:\n  $$ Q_{0,0} = -(k_h + k_d), \\quad Q_{0,1} = k_h $$\n- 对于内部状态 $i \\in \\{1, \\dots, N\\}$:\n  $$ Q_{i,i-1} = k_h, \\quad Q_{i,i} = -2k_h, \\quad Q_{i,i+1} = k_h $$\n- 对于边界状态 $i=N+1$:\n  $$ Q_{N+1,N} = k_h, \\quad Q_{N+1,N+1} = -(k_h + k_d) $$\n$\\mathbf{Q}$ 的所有其他元素均为 $0$。\n\n第三，我们计算到达吸收态的平均首过时间 (MFPT)。设 $\\mathbf{t}$ 是一个大小为 $N+2$ 的列向量，其中每个元素 $t_i$ 是在过程从状态 $i$ 开始的情况下，到达吸收汇的期望时间。该向量 $\\mathbf{t}$ 是以下线性方程组的解：\n$$ \\mathbf{Q} \\mathbf{t} = -\\mathbf{1} $$\n其中 $\\mathbf{1}$ 是一个相同维度的全一列向量。该系统可以使用标准的数值线性代数技术求解。\n\n第四，我们根据指定的空位初始分布，计算平均 MFPT，记为 $\\langle \\tau \\rangle$。空位以均匀概率被引入到 $N$ 个内部格点上。因此，初始概率向量 $\\mathbf{p}_0$ 由 $i \\in \\{1, \\dots, N\\}$ 时 $p_0(i) = 1/N$ 和 $i \\in \\{0, N+1\\}$ 时 $p_0(i) = 0$ 给出。平均 MFPT 是 MFPTs $t_i$ 关于此初始分布的期望值：\n$$ \\langle \\tau \\rangle = \\sum_{i=0}^{N+1} p_0(i) t_i = \\frac{1}{N} \\sum_{i=1}^{N} t_i $$\n\n第五，我们推导粗粒化量。有效单位格点溶解速率 $k_{\\mathrm{eff}}$ 是引入空位后发生溶解事件所需平均时间的倒数。\n$$ k_{\\mathrm{eff}} = \\frac{1}{\\langle \\tau \\rangle} $$\n该速率的单位是每秒 (s⁻¹)。宏观摩尔通量 $J$ 代表单位面积单位时间内溶解的物质的摩尔数。它是通过将 $k_{\\mathrm{eff}}$ 按活性位点密度 $S$进行缩放，并使用阿伏伽德罗常数 $N_A = 6.02214076 \\times 10^{23}$ mol⁻¹ 将基于粒子的速率转换为摩尔速率而得到的。\n$$ J = \\frac{S \\cdot k_{\\mathrm{eff}}}{N_A} $$\n$J$ 的单位是 mol m⁻² s⁻¹。\n\n对于每个测试用例，计算算法按以下步骤进行：\n1.  定义参数 $N$、$k_h$、$k_d$ 和 $S$。\n2.  如上所述，构建 $(N+2) \\times (N+2)$ 矩阵 $\\mathbf{Q}$。\n3.  定义大小为 $N+2$ 的列向量 $\\mathbf{b} = -\\mathbf{1}$。\n4.  求解线性系统 $\\mathbf{Q} \\mathbf{t} = \\mathbf{b}$ 以得到 MFPT 向量 $\\mathbf{t}$。\n5.  通过对解向量的元素 $t_1$ 到 $t_N$ 求平均值来计算 $\\langle \\tau \\rangle$。\n6.  计算 $k_{\\mathrm{eff}} = 1/\\langle \\tau \\rangle$。\n7.  计算 $J = S \\cdot k_{\\mathrm{eff}} / N_A$。\n8.  存储对 $[k_{\\mathrm{eff}}, J]$ 以用于最终输出。\n该程序应用于所提供的四个测试用例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all specified test cases and prints the results.\n    \"\"\"\n\n    # Physical constant\n    NA = 6.02214076e23  # Avogadro's number in per mole\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (general)\n        {'N': 10, 'kh': 1.0e6, 'kd': 1.0e5, 'S': 1.0e16},\n        # Case B (reaction-limited)\n        {'N': 10, 'kh': 1.0e6, 'kd': 1.0e2, 'S': 1.0e16},\n        # Case C (transport-limited)\n        {'N': 100, 'kh': 1.0e4, 'kd': 1.0e8, 'S': 5.0e15},\n        # Case D (boundary case)\n        {'N': 1, 'kh': 1.0e5, 'kd': 1.0e5, 'S': 1.0e16},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_flux(**case)\n        results.append(result)\n\n    # Format the final output string as specified\n    results_str = [f\"[{res[0]:.6g},{res[1]:.6g}]\" for res in results]\n    print(f\"[{','.join(results_str)}]\")\n\ndef calculate_flux(N, kh, kd, S):\n    \"\"\"\n    Calculates the effective rate and molar flux for a single test case.\n\n    Args:\n        N (int): Number of interior lattice sites.\n        kh (float): Hopping rate between nearest neighbors (per second).\n        kd (float): Dissolution rate at boundaries (per second).\n        S (float): Active site density (sites per square meter).\n\n    Returns:\n        A list containing [k_eff, J].\n    \"\"\"\n    # Total number of transient states in the CTMC model is N interior + 2 boundary\n    num_states = N + 2\n\n    # Initialize the infinitesimal generator matrix Q\n    Q = np.zeros((num_states, num_states))\n\n    # --- Construct the Q matrix ---\n\n    # Row 0: boundary state at index 0\n    Q[0, 0] = -(kh + kd)\n    Q[0, 1] = kh\n\n    # Rows 1 to N: interior states\n    for i in range(1, N + 1):\n        Q[i, i] = -2.0 * kh\n        Q[i, i-1] = kh\n        Q[i, i+1] = kh\n\n    # Row N+1: boundary state at index N+1\n    Q[N + 1, N + 1] = -(kh + kd)\n    Q[N + 1, N] = kh\n    \n    # --- Solve for Mean First-Passage Time (MFPT) ---\n\n    # The system to solve is Q * t = -1\n    # where t is the vector of MFPTs starting from each state.\n    b = -np.ones(num_states)\n    \n    # Solve the linear system for t\n    t = np.linalg.solve(Q, b)\n    \n    # --- Calculate average MFPT and coarse-grained quantities ---\n\n    # The initial distribution is uniform over the N interior sites {1, ..., N}.\n    # We need to average the MFPTs for these starting states.\n    # The indices in the t vector corresponding to these states are 1 to N.\n    mean_tau = np.mean(t[1 : N + 1])\n    \n    # The effective per-site dissolution rate is the inverse of the average MFPT.\n    k_eff = 1.0 / mean_tau\n    \n    # NA (Avogadro's number)\n    NA = 6.02214076e23\n\n    # The macroscopic molar flux J.\n    J = (S * k_eff) / NA\n    \n    return [k_eff, J]\n\nsolve()\n```"
        }
    ]
}