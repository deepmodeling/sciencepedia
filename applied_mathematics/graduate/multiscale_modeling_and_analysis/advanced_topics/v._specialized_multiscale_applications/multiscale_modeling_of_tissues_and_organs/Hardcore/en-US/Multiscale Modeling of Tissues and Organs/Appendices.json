{
    "hands_on_practices": [
        {
            "introduction": "Before embarking on the construction of a complex multiscale model, a crucial first step is to quantify the separation between the scales of interest. This exercise introduces the fundamental dimensionless scale-separation parameter, $\\epsilon$, derived from the characteristic lengths of the microstructure and the overall organ. By calculating $\\epsilon$ for a hypothetical scenario of organ perfusion, you will practice the foundational analysis required to justify the use of powerful theoretical frameworks like homogenization. ",
            "id": "3786773",
            "problem": "Consider oxygen transport within a perfused organ whose capillary bed can be idealized as a periodic microstructure with characteristic spacing (period) $\\ell_{\\text{cap}}$ embedded in a macroscale tissue domain of characteristic length $\\ell_{\\text{organ}}$. Let $c(\\mathbf{x},t)$ denote the oxygen concentration in the extravascular space. At the microscale, in the tissue domain between capillaries, oxygen follows local mass conservation and Fickian diffusion, with perfusive exchange at capillary walls acting as localized sinks. The foundational starting point is the local conservation of mass combined with Fick’s law: $\\partial_t c + \\nabla \\cdot \\mathbf{j} = r$, where $\\mathbf{j} = -D \\nabla c$ and $D$ is the diffusion coefficient, and $r$ accounts for reaction and exchange with the microvasculature on its surfaces. The capillary geometry repeats with characteristic length $\\ell_{\\text{cap}}$, whereas macroscale variation of organ-level fields occurs over $\\ell_{\\text{organ}}$.\n\nBy introducing a macroscale coordinate $\\mathbf{X} = \\mathbf{x}/\\ell_{\\text{organ}}$ and an independent microscale coordinate $\\mathbf{Y} = \\mathbf{x}/\\ell_{\\text{cap}}$ for a multiple-scale description, a small, dimensionless scale-separation parameter $\\epsilon$ emerges that compares the microstructural and organ scales. Using only this fundamental base, identify $\\epsilon$ in terms of $\\ell_{\\text{cap}}$ and $\\ell_{\\text{organ}}$, then compute its value for $\\ell_{\\text{organ}} = 10\\,\\text{cm}$ and $\\ell_{\\text{cap}} = 50\\,\\mu\\text{m}$. Express your final numerical value in scientific notation. Finally, based solely on the magnitude of $\\epsilon$ and the principle that asymptotic homogenization presumes $\\epsilon \\to 0$ to justify replacing the microvascular network by an effective perfusion representation, assess whether homogenization is justified for perfusion modeling in this setting. Provide your reasoning in words. The final reported answer must be only the numerical value of $\\epsilon$ (dimensionless) in scientific notation.",
            "solution": "We start from the fundamental statement of local mass conservation for a solute with Fickian diffusion in the extravascular space, $\\partial_t c + \\nabla \\cdot \\mathbf{j} = r$, where $\\mathbf{j} = -D \\nabla c$ and $r$ represents sources and sinks due to reaction and exchange at capillary walls. The capillary geometry is periodic with characteristic spacing $\\ell_{\\text{cap}}$, while organ-level fields vary over a macroscale $\\ell_{\\text{organ}}$.\n\nTo expose the relevant scale-separation parameter, we nondimensionalize space with both a macroscale and a microscale coordinate. Define the macroscale coordinate $\\mathbf{X} = \\mathbf{x} / \\ell_{\\text{organ}}$ and the microscale coordinate $\\mathbf{Y} = \\mathbf{x} / \\ell_{\\text{cap}}$. In the method of multiple scales, $c$ is regarded as a function of both variables, $c(\\mathbf{x},t) \\mapsto c(\\mathbf{X},\\mathbf{Y},t)$, and the gradient operator splits according to\n$$\n\\nabla = \\frac{\\partial}{\\partial \\mathbf{x}} = \\frac{\\partial \\mathbf{X}}{\\partial \\mathbf{x}} \\cdot \\nabla_{\\mathbf{X}} + \\frac{\\partial \\mathbf{Y}}{\\partial \\mathbf{x}} \\cdot \\nabla_{\\mathbf{Y}} = \\frac{1}{\\ell_{\\text{organ}}} \\nabla_{\\mathbf{X}} + \\frac{1}{\\ell_{\\text{cap}}} \\nabla_{\\mathbf{Y}}.\n$$\nFactoring $1/\\ell_{\\text{organ}}$ yields\n$$\n\\nabla = \\frac{1}{\\ell_{\\text{organ}}} \\left( \\nabla_{\\mathbf{X}} + \\frac{\\ell_{\\text{organ}}}{\\ell_{\\text{cap}}} \\nabla_{\\mathbf{Y}} \\right) = \\frac{1}{\\ell_{\\text{organ}}} \\left( \\nabla_{\\mathbf{X}} + \\frac{1}{\\epsilon} \\nabla_{\\mathbf{Y}} \\right),\n$$\nwhere the dimensionless small parameter is identified as\n$$\n\\epsilon = \\frac{\\ell_{\\text{cap}}}{\\ell_{\\text{organ}}}.\n$$\nThis parameter measures the relative scale separation between microstructure and macrostructure. Homogenization theory assumes $\\epsilon \\to 0$ to justify replacing the explicit microstructure by effective, averaged coefficients (e.g., an effective perfusion term) at the organ scale.\n\nWe now compute $\\epsilon$ from the given data. Convert the lengths to consistent units:\n$$\n\\ell_{\\text{organ}} = 10\\,\\text{cm} = 10 \\times 10^{-2}\\,\\text{m} = 10^{-1}\\,\\text{m},\n$$\n$$\n\\ell_{\\text{cap}} = 50\\,\\mu\\text{m} = 50 \\times 10^{-6}\\,\\text{m} = 5 \\times 10^{-5}\\,\\text{m}.\n$$\nTherefore,\n$$\n\\epsilon = \\frac{\\ell_{\\text{cap}}}{\\ell_{\\text{organ}}} = \\frac{5 \\times 10^{-5}}{10^{-1}} = 5 \\times 10^{-4}.\n$$\n\nAssessment of homogenization validity: Asymptotic homogenization relies on a clear separation of scales, mathematically corresponding to $\\epsilon \\ll 1$. Here, $\\epsilon = 5 \\times 10^{-4}$, which is much less than $1$. Equivalently, the number of microstructural repeats across the organ is $\\ell_{\\text{organ}}/\\ell_{\\text{cap}} = 1/\\epsilon = 2000$, indicating many periodic cells across the organ length and a strong scale separation. Under these conditions, and assuming no other competing small or large parameters negate scale separation (for example, extremely thin boundary layers that span the organ scale), homogenization is justified for representing the capillary-scale perfusion by an effective, continuum perfusion model at the organ scale.\n\nThe required final answer is the numerical value of $\\epsilon$ in scientific notation; the qualitative assessment is included here for completeness but does not appear in the final boxed answer.",
            "answer": "$$\\boxed{5 \\times 10^{-4}}$$"
        },
        {
            "introduction": "The unique mechanical behavior of many biological tissues is governed by their composite microstructure, particularly the arrangement of reinforcing collagen fibers. This practice delves into the continuum mechanics of soft tissue hyperelasticity, applying the renowned Holzapfel-Ogden constitutive model to compute the Cauchy stress resulting from a prescribed deformation. You will gain hands-on experience in deriving stress from a strain-energy function and evaluating its components, a core skill that connects microstructural features to macroscopic mechanical response. ",
            "id": "3786738",
            "problem": "Consider a fiber-reinforced, incompressible hyperelastic tissue modeled by the Holzapfel–Ogden (HO) constitutive model. Let the deformation gradient be \n$$\\mathbf{F} = \\mathrm{diag}(\\lambda, \\lambda^{-1}, 1),$$\nwith $\\lambda = 1.1$, so that the Jacobian $J = \\det(\\mathbf{F}) = 1$. The two preferred fiber directions in the reference configuration are given by\n$$\\mathbf{a}_{0}^{(1)} = \\begin{pmatrix}\\cos\\theta \\\\ \\sin\\theta \\\\ 0\\end{pmatrix}, \\quad \\mathbf{a}_{0}^{(2)} = \\begin{pmatrix}\\cos\\theta \\\\ -\\sin\\theta \\\\ 0\\end{pmatrix},$$\nwith $\\theta = 30$ degrees. The right Cauchy–Green deformation tensor is $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$. The strain-energy function is\n$$W = \\frac{\\mu}{2}\\left(I_{1}-3\\right) + \\sum_{i=1}^{2} \\frac{k_{1}}{2 k_{2}}\\left[\\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) - 1\\right],$$\nwhere $I_{1} = \\mathrm{tr}(\\mathbf{C})$ and $I_{4}^{(i)} = \\mathbf{a}_{0}^{(i)} \\cdot \\mathbf{C} \\cdot \\mathbf{a}_{0}^{(i)}$. Assume both fiber families are in extension for the given deformation. The material parameters are $\\mu = 10\\,\\mathrm{kPa}$, $k_{1} = 2\\,\\mathrm{kPa}$, and $k_{2} = 80$. \n\nStarting from the definitions of the Cauchy stress for an incompressible hyperelastic material and the provided strain-energy function, derive the expression for the fiber contribution to the Cauchy stress tensor along a single fiber family. Then, evaluate the scalar component of the fiber contribution to the Cauchy stress along the current fiber direction of the first family, defined as \n$$s^{(1)} = \\widehat{\\mathbf{m}}^{(1)} \\cdot \\boldsymbol{\\sigma}_{\\mathrm{fib}}^{(1)} \\cdot \\widehat{\\mathbf{m}}^{(1)},$$\nwhere $\\mathbf{m}^{(1)} = \\mathbf{F}\\mathbf{a}_{0}^{(1)}$ and $\\widehat{\\mathbf{m}}^{(1)} = \\mathbf{m}^{(1)}/\\|\\mathbf{m}^{(1)}\\|$. Express the final answer in $\\mathrm{kPa}$ and round your result to four significant figures. State clearly how the fiber stretch contributes to the stress along the preferred directions in your derivation. Use degrees for angles in all trigonometric functions.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in continuum mechanics and constitutive modeling of soft tissues, well-posed with sufficient information for a unique solution, and objectively formulated.\n\nThe solution proceeds in two parts. First, we derive the general expression for the fiber contribution to the Cauchy stress. Second, we evaluate the specific scalar component requested.\n\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}$ for an incompressible hyperelastic material is given by\n$$ \\boldsymbol{\\sigma} = -p\\mathbf{I} + \\mathbf{F} \\mathbf{S} \\mathbf{F}^{\\mathsf{T}} $$\nwhere $p$ is the hydrostatic pressure, $\\mathbf{I}$ is the identity tensor, $\\mathbf{F}$ is the deformation gradient, and $\\mathbf{S}$ is the second Piola-Kirchhoff stress tensor. $\\mathbf{S}$ is derived from the strain-energy function $W$ with respect to the right Cauchy-Green deformation tensor $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ as $\\mathbf{S} = 2 \\frac{\\partial W}{\\partial \\mathbf{C}}$.\n\nThe provided strain-energy function is\n$$ W = W_{\\mathrm{iso}}(I_1) + W_{\\mathrm{aniso}}(I_4^{(1)}, I_4^{(2)}) = \\frac{\\mu}{2}\\left(I_{1}-3\\right) + \\sum_{i=1}^{2} \\frac{k_{1}}{2 k_{2}}\\left[\\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) - 1\\right] $$\nThe problem asks for the fiber contribution to the Cauchy stress, which arises from the anisotropic part of the strain energy, $W_{\\mathrm{aniso}}$. The contribution from a single fiber family $i$ is denoted $W_{\\mathrm{fib}}^{(i)}$:\n$$ W_{\\mathrm{fib}}^{(i)} = \\frac{k_{1}}{2 k_{2}}\\left[\\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) - 1\\right] $$\nThe fiber contribution to the second Piola-Kirchhoff stress, $\\mathbf{S}_{\\mathrm{fib}}^{(i)}$, is found by differentiating $W_{\\mathrm{fib}}^{(i)}$ with respect to $\\mathbf{C}$:\n$$ \\mathbf{S}_{\\mathrm{fib}}^{(i)} = 2 \\frac{\\partial W_{\\mathrm{fib}}^{(i)}}{\\partial \\mathbf{C}} $$\nUsing the chain rule, this becomes\n$$ \\mathbf{S}_{\\mathrm{fib}}^{(i)} = 2 \\frac{\\partial W_{\\mathrm{fib}}^{(i)}}{\\partial I_{4}^{(i)}} \\frac{\\partial I_{4}^{(i)}}{\\partial \\mathbf{C}} $$\nThe derivative of the fourth invariant $I_{4}^{(i)} = \\mathbf{a}_{0}^{(i)} \\cdot \\mathbf{C} \\cdot \\mathbf{a}_{0}^{(i)}$ with respect to $\\mathbf{C}$ is the tensor product $\\mathbf{a}_{0}^{(i)} \\otimes \\mathbf{a}_{0}^{(i)}$. The derivative of $W_{\\mathrm{fib}}^{(i)}$ with respect to $I_{4}^{(i)}$ is:\n$$ \\frac{\\partial W_{\\mathrm{fib}}^{(i)}}{\\partial I_{4}^{(i)}} = \\frac{k_{1}}{2 k_{2}} \\left[ \\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) \\cdot \\left( 2k_{2} (I_{4}^{(i)} - 1) \\right) \\right] = k_{1} \\left(I_{4}^{(i)} - 1\\right) \\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) $$\nCombining these results, the fiber contribution to the second Piola-Kirchhoff stress is:\n$$ \\mathbf{S}_{\\mathrm{fib}}^{(i)} = 2 k_{1} \\left(I_{4}^{(i)} - 1\\right) \\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) (\\mathbf{a}_{0}^{(i)} \\otimes \\mathbf{a}_{0}^{(i)}) $$\nThe corresponding fiber contribution to the Cauchy stress, $\\boldsymbol{\\sigma}_{\\mathrm{fib}}^{(i)}$, is obtained by pushing forward $\\mathbf{S}_{\\mathrm{fib}}^{(i)}$ to the current configuration. For an incompressible material, the Jacobian $J = \\det(\\mathbf{F}) = 1$.\n$$ \\boldsymbol{\\sigma}_{\\mathrm{fib}}^{(i)} = \\mathbf{F} \\mathbf{S}_{\\mathrm{fib}}^{(i)} \\mathbf{F}^{\\mathsf{T}} = \\mathbf{F} \\left[ 2 k_{1} \\left(I_{4}^{(i)} - 1\\right) \\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) (\\mathbf{a}_{0}^{(i)} \\otimes \\mathbf{a}_{0}^{(i)}) \\right] \\mathbf{F}^{\\mathsf{T}} $$\n$$ \\boldsymbol{\\sigma}_{\\mathrm{fib}}^{(i)} = 2 k_{1} \\left(I_{4}^{(i)} - 1\\right) \\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) (\\mathbf{F}\\mathbf{a}_{0}^{(i)}) \\otimes (\\mathbf{F}\\mathbf{a}_{0}^{(i)}) $$\nLet the vector representing the fiber direction in the current configuration be $\\mathbf{m}^{(i)} = \\mathbf{F}\\mathbf{a}_{0}^{(i)}$. The derived expression for the fiber contribution to the Cauchy stress is:\n$$ \\boldsymbol{\\sigma}_{\\mathrm{fib}}^{(i)} = 2 k_{1} \\left(I_{4}^{(i)} - 1\\right) \\exp\\left(k_{2}\\left(I_{4}^{(i)} - 1\\right)^{2}\\right) (\\mathbf{m}^{(i)} \\otimes \\mathbf{m}^{(i)}) $$\nThe physical meaning of this expression is that the stress contribution from a fiber family acts purely as a tensile stress along the current direction of the fibers, $\\mathbf{m}^{(i)}$. The magnitude of this stress depends on the fiber stretch via the invariant $I_{4}^{(i)}$, which is the square of the stretch of the fiber. The exponential term provides the characteristic nonlinear stiffening behavior of biological tissues: as the fiber stretch increases, the stress increases very rapidly.\n\nNext, we evaluate the scalar component of the fiber contribution to the Cauchy stress along the current fiber direction of the first family ($i=1$):\n$$ s^{(1)} = \\widehat{\\mathbf{m}}^{(1)} \\cdot \\boldsymbol{\\sigma}_{\\mathrm{fib}}^{(1)} \\cdot \\widehat{\\mathbf{m}}^{(1)} $$\nwhere $\\widehat{\\mathbf{m}}^{(1)} = \\mathbf{m}^{(1)}/\\|\\mathbf{m}^{(1)}\\|$. Substituting the expression for $\\boldsymbol{\\sigma}_{\\mathrm{fib}}^{(1)}$:\n$$ s^{(1)} = \\widehat{\\mathbf{m}}^{(1)} \\cdot \\left[ 2 k_{1} \\left(I_{4}^{(1)} - 1\\right) \\exp\\left(k_{2}\\left(I_{4}^{(1)} - 1\\right)^{2}\\right) (\\mathbf{m}^{(1)} \\otimes \\mathbf{m}^{(1)}) \\right] \\cdot \\widehat{\\mathbf{m}}^{(1)} $$\nThe scalar pre-factor can be pulled out:\n$$ s^{(1)} = \\left( 2 k_{1} \\left(I_{4}^{(1)} - 1\\right) \\exp\\left(k_{2}\\left(I_{4}^{(1)} - 1\\right)^{2}\\right) \\right) \\left[ \\widehat{\\mathbf{m}}^{(1)} \\cdot (\\mathbf{m}^{(1)} \\otimes \\mathbf{m}^{(1)}) \\cdot \\widehat{\\mathbf{m}}^{(1)} \\right] $$\nThe term in brackets simplifies as:\n$$ \\widehat{\\mathbf{m}}^{(1)} \\cdot (\\mathbf{m}^{(1)} \\otimes \\mathbf{m}^{(1)}) \\cdot \\widehat{\\mathbf{m}}^{(1)} = (\\widehat{\\mathbf{m}}^{(1)} \\cdot \\mathbf{m}^{(1)}) (\\mathbf{m}^{(1)} \\cdot \\widehat{\\mathbf{m}}^{(1)}) = \\|\\mathbf{m}^{(1)}\\| \\|\\mathbf{m}^{(1)}\\| = \\|\\mathbf{m}^{(1)}\\|^2 $$\nRecall the definition of the invariant $I_{4}^{(1)}$:\n$$ I_{4}^{(1)} = \\mathbf{a}_{0}^{(1)} \\cdot \\mathbf{C} \\cdot \\mathbf{a}_{0}^{(1)} = \\mathbf{a}_{0}^{(1)} \\cdot (\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}) \\cdot \\mathbf{a}_{0}^{(1)} = (\\mathbf{F}\\mathbf{a}_{0}^{(1)}) \\cdot (\\mathbf{F}\\mathbf{a}_{0}^{(1)}) = \\mathbf{m}^{(1)} \\cdot \\mathbf{m}^{(1)} = \\|\\mathbf{m}^{(1)}\\|^2 $$\nThus, the bracketed term is simply $I_{4}^{(1)}$. The expression for $s^{(1)}$ simplifies to:\n$$ s^{(1)} = 2 k_{1} I_{4}^{(1)} \\left(I_{4}^{(1)} - 1\\right) \\exp\\left(k_{2}\\left(I_{4}^{(1)} - 1\\right)^{2}\\right) $$\nNow, we perform the numerical evaluation. The given parameters are:\n$$ \\lambda = 1.1, \\quad \\theta = 30^{\\circ}, \\quad k_{1} = 2\\,\\mathrm{kPa}, \\quad k_{2} = 80 $$\nThe deformation gradient and the right Cauchy-Green tensor are:\n$$ \\mathbf{F} = \\begin{pmatrix} 1.1 & 0 & 0 \\\\ 0 & 1.1^{-1} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F} = \\mathbf{F}^2 = \\begin{pmatrix} 1.1^2 & 0 & 0 \\\\ 0 & 1.1^{-2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1.21 & 0 & 0 \\\\ 0 & 1/1.21 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\nThe initial fiber direction vector for the first family is:\n$$ \\mathbf{a}_{0}^{(1)} = \\begin{pmatrix}\\cos(30^{\\circ}) \\\\ \\sin(30^{\\circ}) \\\\ 0\\end{pmatrix} = \\begin{pmatrix}\\frac{\\sqrt{3}}{2} \\\\ \\frac{1}{2} \\\\ 0\\end{pmatrix} $$\nWe calculate the invariant $I_{4}^{(1)}$:\n$$ I_{4}^{(1)} = (\\mathbf{a}_{0}^{(1)})^{\\mathsf{T}} \\mathbf{C} \\mathbf{a}_{0}^{(1)} = 1.21 \\cos^2(30^{\\circ}) + \\frac{1}{1.21} \\sin^2(30^{\\circ}) $$\n$$ I_{4}^{(1)} = 1.21 \\left(\\frac{3}{4}\\right) + \\frac{1}{1.21} \\left(\\frac{1}{4}\\right) = 1.21 \\times 0.75 + \\frac{1}{1.21} \\times 0.25 $$\n$$ I_{4}^{(1)} = 0.9075 + 0.82644628... \\times 0.25 = 0.9075 + 0.20661157... $$\n$$ I_{4}^{(1)} = 1.11411157... $$\nNow we compute the terms needed for $s^{(1)}$:\n$$ I_{4}^{(1)} - 1 = 0.11411157... $$\n$$ \\left(I_{4}^{(1)} - 1\\right)^{2} = 0.01302145... $$\n$$ k_{2}\\left(I_{4}^{(1)} - 1\\right)^{2} = 80 \\times 0.01302145... = 1.041716... $$\n$$ \\exp\\left(k_{2}\\left(I_{4}^{(1)} - 1\\right)^{2}\\right) = \\exp(1.041716...) = 2.8340706... $$\nFinally, we substitute all values into the expression for $s^{(1)}$:\n$$ s^{(1)} = 2 (2\\,\\mathrm{kPa}) (1.11411157...) (0.11411157...) (2.8340706...) $$\n$$ s^{(1)} = 1.4412435... \\,\\mathrm{kPa} $$\nRounding the result to four significant figures as requested:\n$$ s^{(1)} \\approx 1.441\\,\\mathrm{kPa} $$",
            "answer": "$$\\boxed{1.441}$$"
        },
        {
            "introduction": "Physiological functions like muscle contraction emerge from a sophisticated interplay of events occurring at molecular, subcellular, and cellular levels. This computational exercise guides you through building a model that couples subcellular calcium dynamics and molecular crossbridge kinetics with sarcomere-level myofilament geometry. By implementing and running a simulation to predict an isometric force twitch, you will learn how to integrate dynamic processes across different scales into a cohesive computational framework and analyze the resulting emergent behavior. ",
            "id": "3786731",
            "problem": "You are asked to design and implement a computational model for the isometric twitch force time course of a muscle fiber using a minimal multiscale formulation that couples subcellular calcium dynamics and crossbridge activation with sarcomere-level myofilament overlap geometry. The model must be derived from fundamental principles and implemented as a complete, runnable program. The goal is to compute the force time course for a set of test cases and quantify the role of sarcomere length. All calculations and outputs must be in purely mathematical terms and fully specified, without relying on external data sources.\n\nStart from the following well-tested and widely accepted bases:\n- Subcellular binding kinetics modeled by mass-action laws and ordinary differential equations (ODEs).\n- Myofilament overlap geometry modeled as interval overlap in a half-sarcomere.\n- Isometric force proportional to the fraction of cycling crossbridges and geometric overlap.\n\nDefine the calcium transient in micromolar units as a difference of exponentials:\n$$\nC(t) = C_{\\mathrm{rest}} + A\\left(e^{-t/\\tau_d} - e^{-t/\\tau_r}\\right),\n$$\nfor $t \\ge 0$, where $C_{\\mathrm{rest}}$ is the resting calcium concentration in $\\mu\\mathrm{M}$, $A$ is the stimulus amplitude in $\\mu\\mathrm{M}$, $\\tau_r$ is the rise time constant in $\\mathrm{s}$, and $\\tau_d$ is the decay time constant in $\\mathrm{s}$.\n\nModel the fraction of activated crossbridges $a(t)$ by a single-compartment binding kinetics ODE:\n$$\n\\frac{da}{dt} = k_{\\mathrm{on}}\\,C(t)\\,\\big(1 - a(t)\\big) - k_{\\mathrm{off}}\\,a(t),\n$$\nwith $a(0) = 0$, where $k_{\\mathrm{on}}$ is the on-rate in $(\\mu\\mathrm{M}\\cdot \\mathrm{s})^{-1}$ and $k_{\\mathrm{off}}$ is the off-rate in $\\mathrm{s}^{-1}$.\n\nDerive the geometric overlap fraction $\\phi$ as a function of sarcomere length $SL$ (in $\\mu\\mathrm{m}$) using half-sarcomere interval intersection. Consider a half-sarcomere of length $\\ell = SL/2$ with an actin filament interval $[0, L_a]$ and a myosin binding-capable interval $[\\ell - L_m,\\, \\ell - B]$, where $L_a$ is the thin filament length, $L_m$ is the myosin half-filament length, and $B$ is the half bare-zone length. The geometric overlap length is the intersection length of these intervals:\n$$\nL_{\\mathrm{overlap}}(SL) = \\max\\left(0,\\, \\min\\big(L_a,\\, \\ell - B\\big) - \\max\\big(0,\\, \\ell - L_m\\big)\\right),\n$$\nand the normalized overlap fraction is\n$$\n\\phi(SL) = \\frac{L_{\\mathrm{overlap}}(SL)}{L_m - B},\n$$\nclipped to $[0,1]$.\n\nAssume a dimensionless specific isometric force proportional to the activated crossbridge fraction and the overlap:\n$$\nF(t) = F_0\\,\\phi(SL)\\,a(t),\n$$\nwith $F_0 = 1$.\n\nUse the following fixed model parameters, which are scientifically plausible:\n- $C_{\\mathrm{rest}} = 0.05$ $\\mu\\mathrm{M}$.\n- $k_{\\mathrm{on}} = 20.0$ $(\\mu\\mathrm{M}\\cdot \\mathrm{s})^{-1}$.\n- $k_{\\mathrm{off}} = 50.0$ $\\mathrm{s}^{-1}$.\n- $L_a = 1.2$ $\\mu\\mathrm{m}$.\n- $L_m = 0.8$ $\\mu\\mathrm{m}$.\n- $B = 0.05$ $\\mu\\mathrm{m}$.\n- $F_0 = 1$ (dimensionless).\n\nNumerically integrate the ordinary differential equation for $a(t)$ from $t = 0$ to $t = T_{\\mathrm{end}}$ using a fixed time step $dt$, where $T_{\\mathrm{end}}$ must be chosen large enough to capture the peak of $F(t)$. Your program should use $dt = 0.0001$ $\\mathrm{s}$ and select $T_{\\mathrm{end}} = \\max\\big(1.0,\\,5\\,\\tau_d\\big)$ $\\mathrm{s}$ for each test case. Use a stable integration method such as fourth-order Runge–Kutta.\n\nFor each test case, compute:\n- The peak force $F_{\\mathrm{peak}} = \\max_t F(t)$ (dimensionless).\n- The time-to-peak $t_{\\mathrm{peak}}$ in seconds, defined as the earliest time at which $F(t)$ attains $F_{\\mathrm{peak}}$.\n\nUnits and reporting:\n- Length parameters $SL$, $L_a$, $L_m$, and $B$ must be treated in $\\mu\\mathrm{m}$.\n- Calcium-related parameters $C_{\\mathrm{rest}}$ and $A$ must be treated in $\\mu\\mathrm{M}$.\n- Time-related values must be treated in $\\mathrm{s}$.\n- Output the two computed quantities for each test case as floats rounded to six decimal places.\n\nTest suite:\nImplement your program to evaluate the following five test cases, each specified as $(SL, A, \\tau_r, \\tau_d)$:\n1. $(2.2, 0.5, 0.02, 0.2)$: a typical case near optimal overlap (happy path).\n2. $(1.4, 0.5, 0.02, 0.2)$: a short sarcomere length reducing overlap.\n3. $(2.8, 0.5, 0.02, 0.2)$: a long sarcomere length reducing overlap.\n4. $(2.2, 0.2, 0.02, 0.2)$: lower calcium amplitude at optimal overlap.\n5. $(2.2, 0.5, 0.02, 0.5)$: prolonged calcium decay at optimal overlap.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist $[F_{\\mathrm{peak}}, t_{\\mathrm{peak}}]$ rounded to six decimal places. For example:\n$$\n[[f_1,t_1],[f_2,t_2],[f_3,t_3],[f_4,t_4],[f_5,t_5]]\n$$\nwith no spaces in the printed string.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded, mathematically well-posed, self-contained, and free of contradictions or ambiguities. It presents a standard, albeit simplified, multiscale model of muscle contraction that is amenable to computational solution. We will proceed to develop the solution in a structured manner, detailing each component of the model and the numerical method for its resolution.\n\nThe model couples three distinct scales:\n1.  **Tissue/Fiber-Level Geometry**: The sarcomere length ($SL$) dictates the potential for myofilament interaction.\n2.  **Subcellular Dynamics**: A prescribed calcium transient ($C(t)$) drives the system.\n3.  **Molecular Kinetics**: The binding of calcium to regulatory proteins and subsequent crossbridge activation ($a(t)$) are modeled with mass-action kinetics.\n\nThe final output, isometric force ($F(t)$), integrates information from all three scales.\n\n**1. Geometric Overlap Model: The Length-Tension Relationship**\n\nThe force-generating capacity of a sarcomere is fundamentally limited by the physical overlap between the actin (thin) and myosin (thick) filaments. We model this based on the geometry of a half-sarcomere.\n\nGiven the fixed parameters: thin filament length $L_a = 1.2\\,\\mu\\mathrm{m}$, myosin half-filament length $L_m = 0.8\\,\\mu\\mathrm{m}$, and myosin bare-zone half-length $B = 0.05\\,\\mu\\mathrm{m}$. The half-sarcomere length is $\\ell = SL/2$.\n\nWe define two intervals within the half-sarcomere coordinate system, which spans from the Z-disk (at coordinate $0$) to the M-line (at coordinate $\\ell$):\n- The actin filament occupies the interval $[0, L_a]$.\n- The region on the myosin filament containing crossbridges available for binding occupies the interval $[\\ell - L_m, \\ell - B]$.\n\nThe length of overlap, $L_{\\mathrm{overlap}}$, is the length of the intersection of these two intervals. The intersection of two intervals $[x_1, x_2]$ and $[y_1, y_2]$ has a length given by $\\max(0, \\min(x_2, y_2) - \\max(x_1, y_1))$. Applying this formula yields the specified equation:\n$$\nL_{\\mathrm{overlap}}(SL) = \\max\\left(0,\\, \\min\\big(L_a,\\, \\ell - B\\big) - \\max\\big(0,\\, \\ell - L_m\\big)\\right)\n$$\nwhere $\\ell = SL/2$.\n\nThe normalized overlap fraction, $\\phi(SL)$, represents the proportion of the crossbridge-bearing region of the myosin filament that is overlapped by actin. The total length of this region is $L_m - B$. Therefore, the normalized fraction is:\n$$\n\\phi(SL) = \\frac{L_{\\mathrm{overlap}}(SL)}{L_m - B}\n$$\nAs per the problem, this value is clipped to the range $[0, 1]$, although the geometric formulation ensures it naturally falls within this range. For a given sarcomere length $SL$, $\\phi(SL)$ is a constant that scales the maximum possible force.\n\n**2. Calcium Transient and Crossbridge Activation Kinetics**\n\nThe activation of contraction is initiated by a transient increase in the intracellular calcium concentration, $C(t)$. This is modeled phenomenologically as a difference of two exponential functions:\n$$\nC(t) = C_{\\mathrm{rest}} + A\\left(e^{-t/\\tau_d} - e^{-t/\\tau_r}\\right)\n$$\nwhere $C_{\\mathrm{rest}} = 0.05\\,\\mu\\mathrm{M}$ is the basal concentration, $A$ is the amplitude of the stimulus-evoked calcium release, and $\\tau_r$ and $\\tau_d$ are the time constants for the rise and decay phases of the transient, respectively.\n\nThis calcium concentration, $C(t)$, drives the binding of crossbridges. We model the fraction of activated crossbridges, $a(t)$, using a first-order ordinary differential equation (ODE) based on mass-action kinetics:\n$$\n\\frac{da}{dt} = k_{\\mathrm{on}}\\,C(t)\\,\\big(1 - a(t)\\big) - k_{\\mathrm{off}}\\,a(t)\n$$\nThis equation describes the net rate of change of the activated fraction $a(t)$ as a balance between an activation process and a deactivation process. The activation term, $k_{\\mathrm{on}}\\,C(t)\\,\\big(1 - a(t)\\big)$, is proportional to the calcium concentration $C(t)$ and the fraction of available (non-activated) crossbridges, $1-a(t)$. The deactivation term, $k_{\\mathrm{off}}\\,a(t)$, is a first-order decay process proportional to the currently activated fraction $a(t)$. The rate constants are given as $k_{\\mathrm{on}} = 20.0\\,(\\mu\\mathrm{M}\\cdot\\mathrm{s})^{-1}$ and $k_{\\mathrm{off}} = 50.0\\,\\mathrm{s}^{-1}$. The initial condition is that no crossbridges are active at time $t=0$, so $a(0) = 0$.\n\n**3. Total Isometric Force**\n\nThe instantaneous isometric force, $F(t)$, is modeled as being directly proportional to both the geometric overlap fraction $\\phi(SL)$ and the fraction of activated crossbridges $a(t)$.\n$$\nF(t) = F_0\\,\\phi(SL)\\,a(t)\n$$\nThe parameter $F_0=1$ establishes a dimensionless force scale, making the peak force equal to the product of the peak crossbridge activation and the geometric overlap factor.\n\n**4. Numerical Solution**\n\nThe ODE for $a(t)$ does not have a simple closed-form solution due to the time-varying coefficient $C(t)$. Therefore, a numerical solution is required. As specified, we will implement the fourth-order Runge-Kutta (RK4) method with a fixed time step of $dt = 0.0001\\,\\mathrm{s}$.\n\nThe ODE can be written in the form $\\frac{da}{dt} = f(t, a)$, where:\n$$\nf(t, a) = k_{\\mathrm{on}}\\,C(t)\\,\\big(1 - a\\big) - k_{\\mathrm{off}}\\,a\n$$\nThe RK4 algorithm advances the solution from time $t_i$ to $t_{i+1} = t_i + dt$ as follows:\n$$\na(t_{i+1}) = a(t_i) + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)dt\n$$\nwhere the slopes are calculated as:\n\\begin{align*}\nk_1 &= f(t_i, a(t_i)) \\\\\nk_2 &= f\\left(t_i + \\frac{dt}{2}, a(t_i) + \\frac{k_1 dt}{2}\\right) \\\\\nk_3 &= f\\left(t_i + \\frac{dt}{2}, a(t_i) + \\frac{k_2 dt}{2}\\right) \\\\\nk_4 &= f\\left(t_i + dt, a(t_i) + k_3 dt\\right)\n\\end{align*}\nThis process is initiated with $a_0 = a(0) = 0$ and is iterated for the duration of the simulation, from $t=0$ to $T_{\\mathrm{end}} = \\max\\big(1.0\\,\\mathrm{s},\\,5\\,\\tau_d\\big)$.\n\n**5. Analysis and Implementation Plan**\n\nFor each of the five test cases provided, the following computational procedure will be executed:\n1.  Parse the test case parameters: $SL$, $A$, $\\tau_r$, and $\\tau_d$.\n2.  Calculate the constant geometric overlap factor $\\phi(SL)$ using the provided filament lengths.\n3.  Determine the simulation end time $T_{\\mathrm{end}}$.\n4.  Initialize a time array from $0$ to $T_{\\mathrm{end}}$ with step $dt$, and an array to store the force values $F(t)$.\n5.  Set the initial condition $a(0)=0$.\n6.  Loop through each time step:\n    a. Use the RK4 algorithm to compute $a(t_{i+1})$ from $a(t_i)$.\n    b. Calculate the force $F(t_{i+1}) = F_0 \\phi(SL) a(t_{i+1})$.\n    c. Store the computed force value.\n7.  After the simulation loop completes, analyze the stored force time series $F(t)$ to find its maximum value, $F_{\\mathrm{peak}}$, and the first time at which this maximum occurs, $t_{\\mathrm{peak}}$.\n8.  Store the pair $[F_{\\mathrm{peak}}, t_{\\mathrm{peak}}]$ for the current test case.\n9.  After processing all test cases, format the collected results into the specified string format, ensuring all numerical values are rounded to six decimal places.\nThis procedure will be encapsulated in a single Python program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the isometric twitch force time course for a muscle fiber\n    based on a minimal multiscale model.\n    \"\"\"\n\n    # Fixed model parameters\n    C_rest = 0.05  # muM\n    k_on = 20.0    # (muM*s)^-1\n    k_off = 50.0   # s^-1\n    L_a = 1.2      # mu m\n    L_m = 0.8      # mu m\n    B = 0.05       # mu m\n    F_0 = 1.0      # dimensionless\n\n    # Numerical integration parameters\n    dt = 0.0001    # s\n\n    # Test suite: (SL, A, tau_r, tau_d)\n    test_cases = [\n        (2.2, 0.5, 0.02, 0.2),  # Case 1: Optimal overlap, typical stimulus\n        (1.4, 0.5, 0.02, 0.2),  # Case 2: Short sarcomere\n        (2.8, 0.5, 0.02, 0.2),  # Case 3: Long sarcomere\n        (2.2, 0.2, 0.02, 0.2),  # Case 4: Lower calcium amplitude\n        (2.2, 0.5, 0.02, 0.5),  # Case 5: Prolonged calcium decay\n    ]\n\n    # List to store results for all test cases\n    all_results = []\n\n    def get_overlap_fraction(SL, L_a, L_m, B):\n        \"\"\"\n        Calculates the normalized geometric overlap fraction phi(SL).\n        \"\"\"\n        ell = SL / 2.0\n        # Myosin binding interval: [ell - L_m, ell - B]\n        # Actin interval: [0, L_a]\n        \n        # Intersection length calculation\n        # L_overlap = max(0, min(L_a, ell - B) - max(0, ell - L_m))\n        # numpy.maximum and numpy.minimum are used for element-wise operations if needed,\n        # but here the inputs are scalars.\n        max_term = np.maximum(0.0, ell - L_m)\n        min_term = np.minimum(L_a, ell - B)\n        L_overlap = np.maximum(0.0, min_term - max_term)\n\n        # Denominator for normalization is the length of myosin binding sites\n        myosin_binding_length = L_m - B\n        \n        if myosin_binding_length <= 0:\n            return 0.0\n            \n        phi = L_overlap / myosin_binding_length\n        return np.clip(phi, 0.0, 1.0)\n\n    # ODE function da/dt = f(t, a)\n    def f_ode(t, a, A, tau_r, tau_d):\n        \"\"\"\n        Defines the right-hand side of the crossbridge activation ODE.\n        \"\"\"\n        C_t = C_rest + A * (np.exp(-t / tau_d) - np.exp(-t / tau_r))\n        return k_on * C_t * (1.0 - a) - k_off * a\n\n    for case in test_cases:\n        SL, A, tau_r, tau_d = case\n\n        # 1. Calculate constant geometric overlap fraction\n        phi = get_overlap_fraction(SL, L_a, L_m, B)\n\n        # 2. Determine simulation time\n        T_end = max(1.0, 5.0 * tau_d)\n        time_steps = np.arange(0, T_end, dt)\n        \n        # 3. Initialize arrays and variables\n        a = 0.0  # Initial fraction of activated crossbridges\n        force_history = np.zeros_like(time_steps)\n\n        # 4. Perform numerical integration using RK4\n        for i, t in enumerate(time_steps):\n            # Calculate current force and store it\n            force_history[i] = F_0 * phi * a\n            \n            # RK4 steps to find next 'a'\n            k1 = f_ode(t, a, A, tau_r, tau_d)\n            k2 = f_ode(t + 0.5 * dt, a + 0.5 * k1 * dt, A, tau_r, tau_d)\n            k3 = f_ode(t + 0.5 * dt, a + 0.5 * k2 * dt, A, tau_r, tau_d)\n            k4 = f_ode(t + dt, a + k3 * dt, A, tau_r, tau_d)\n            \n            a = a + (k1 + 2.0 * k2 + 2.0 * k3 + k4) / 6.0 * dt\n            # Ensure 'a' stays within physical bounds [0, 1]\n            a = np.clip(a, 0.0, 1.0)\n            \n        # 5. Find peak force and time-to-peak after simulation\n        if len(force_history) > 0:\n            peak_force_index = np.argmax(force_history)\n            F_peak = force_history[peak_force_index]\n            t_peak = time_steps[peak_force_index]\n        else: # Handle case of zero-length simulation\n            F_peak = 0.0\n            t_peak = 0.0\n\n        all_results.append([F_peak, t_peak])\n\n    # 6. Format and print the final output\n    formatted_pairs = []\n    for F_peak, t_peak in all_results:\n        formatted_pairs.append(f\"[{F_peak:.6f},{t_peak:.6f}]\")\n    \n    print(f\"[{','.join(formatted_pairs)}]\")\n\nsolve()\n```"
        }
    ]
}