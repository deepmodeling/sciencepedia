{
    "hands_on_practices": [
        {
            "introduction": "This problem goes to the heart of active particle dynamics by analyzing the Run-and-Tumble Particle (RTP), a canonical model for bacterial motion. By deriving the mean-squared displacement (MSD) from first principles, you will directly connect the microscopic parameters of motion—the constant speed $v_0$ and the tumbling rate $\\alpha$—to the emergent, large-scale diffusive behavior. This foundational exercise  is crucial for understanding how persistent motion at short times transitions into effective diffusion at long times, a hallmark of many active systems.",
            "id": "3780854",
            "problem": "Consider a two-dimensional Run-and-Tumble Particle (RTP), defined as a point-like active particle moving at constant speed $v_0$ along an orientation unit vector $\\mathbf{e}(t)$ that is piecewise constant in time and undergoes instantaneous, memoryless, and isotropic reorientation (\"tumbles\") at the events of a homogeneous Poisson process with rate $\\alpha>0$. Assume there is no passive translational noise, the system is stationary and isotropic, the particle starts at the origin $\\mathbf{r}(0)=\\mathbf{0}$ with an orientation $\\mathbf{e}(0)$ drawn uniformly at random from the unit circle, and tumbles reset the orientation to an independent and uniformly distributed direction in two dimensions. \n\nStarting from first principles—the definition of displacement as the time integral of velocity, properties of the Poisson process and isotropy, and the relation between the mean-squared displacement and the velocity autocorrelation—derive the exact time-dependent mean-squared displacement $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$ for all $t\\ge 0$. Then, identify the effective long-time diffusivity $D_{\\mathrm{eff}}$ by matching the linear growth of the mean-squared displacement with the form appropriate for two dimensions. Provide your final answer as closed-form analytical expressions for $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$ and for $D_{\\mathrm{eff}}$. No numerical evaluation or rounding is required.",
            "solution": "The problem statement will first be validated against the specified criteria.\n\n### Step 1: Extract Givens\n- A two-dimensional Run-and-Tumble Particle (RTP).\n- The particle moves at a constant speed $v_0$.\n- The orientation unit vector $\\mathbf{e}(t)$ is piecewise constant.\n- Tumbles are instantaneous, memoryless, and isotropic reorientations.\n- Tumbles occur as a homogeneous Poisson process with rate $\\alpha > 0$.\n- There is no passive translational noise.\n- The system is stationary and isotropic.\n- The particle starts at the origin: $\\mathbf{r}(0) = \\mathbf{0}$.\n- The initial orientation $\\mathbf{e}(0)$ is drawn uniformly at random from the unit circle.\n- Tumbles reset the orientation to an independent and uniformly distributed direction.\n- The task is to derive the exact time-dependent mean-squared displacement (MSD), $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$, for all $t \\ge 0$.\n- The task is to identify the effective long-time diffusivity $D_{\\mathrm{eff}}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The Run-and-Tumble Particle (RTP) is a canonical model in the field of active matter, used to describe the motion of various microorganisms like E. coli. The model is based on established principles of stochastic processes (Poisson process) and statistical mechanics. The problem is scientifically sound.\n- **Well-Posed:** All necessary parameters ($v_0$, $\\alpha$), initial conditions ($\\mathbf{r}(0)=\\mathbf{0}$), and statistical properties of the orientation dynamics (isotropic tumbles, uniform initial distribution) are provided. The problem asks for specific, well-defined physical quantities (MSD and effective diffusivity), for which a unique solution is expected.\n- **Objective:** The problem is formulated using precise, technical language common in theoretical physics. It is free of subjective or ambiguous statements.\n- **Completeness and Consistency:** The problem is self-contained. The provided information is sufficient and consistent for deriving the requested quantities. The assumption of stationarity is consistent with the initial orientation being drawn from the stationary distribution (uniform on the circle) of the renewal process.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and self-contained. The solution will now be derived.\n\nThe displacement of the particle at time $t$ is given by $\\Delta\\mathbf{r}(t) = \\mathbf{r}(t) - \\mathbf{r}(0)$. With the initial condition $\\mathbf{r}(0)=\\mathbf{0}$, the displacement is simply $\\mathbf{r}(t)$. The velocity of the particle is $\\mathbf{v}(t) = v_0 \\mathbf{e}(t)$, where $v_0$ is the constant speed and $\\mathbf{e}(t)$ is the time-dependent orientation unit vector. The position is the time integral of the velocity:\n$$\n\\mathbf{r}(t) = \\int_0^t \\mathbf{v}(t') dt' = v_0 \\int_0^t \\mathbf{e}(t') dt'\n$$\nThe mean-squared displacement (MSD) is the ensemble average of the squared magnitude of the displacement vector:\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle = \\langle |\\mathbf{r}(t)|^2 \\rangle = \\langle \\mathbf{r}(t) \\cdot \\mathbf{r}(t) \\rangle\n$$\nSubstituting the expression for $\\mathbf{r}(t)$:\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = \\left\\langle \\left( v_0 \\int_0^t \\mathbf{e}(t') dt' \\right) \\cdot \\left( v_0 \\int_0^t \\mathbf{e}(t'') dt'' \\right) \\right\\rangle\n$$\nBy linearity of the expectation operator, we can move the averaging inside the integrals:\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = v_0^2 \\int_0^t dt' \\int_0^t dt'' \\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle\n$$\nThe term $\\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle$ is the orientation autocorrelation function. As the underlying stochastic process (homogeneous Poisson process for tumbles) is stationary in time, this correlation function depends only on the time difference $\\tau = |t' - t''|$. Let's compute $C(\\tau) = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle$.\n\nThe orientation $\\mathbf{e}(\\tau)$ will be identical to $\\mathbf{e}(0)$ if and only if no tumbles have occurred in the time interval $[0, \\tau]$. The number of tumbles in this interval follows a Poisson distribution with mean $\\alpha\\tau$. The probability of zero tumbles is $P(0, \\tau) = \\exp(-\\alpha\\tau)$.\nIf one or more tumbles occur, the memory of the initial orientation is lost because the new orientation is chosen isotropically and independently of the previous one. Let's denote the new orientation after a tumble by $\\mathbf{e}_{\\text{new}}$. Its average dot product with any fixed vector, such as $\\mathbf{e}(0)$, is zero due to isotropy: $\\langle \\mathbf{e}(0) \\cdot \\mathbf{e}_{\\text{new}} \\rangle = 0$.\n\nWe can therefore express the correlation function by conditioning on the number of tumbles in $[0, \\tau]$:\n$$\n\\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) | \\text{no tumble} \\rangle P(\\text{no tumble}) + \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) | \\text{at least one tumble} \\rangle P(\\text{at least one tumble})\n$$\nIf there are no tumbles, $\\mathbf{e}(\\tau) = \\mathbf{e}(0)$, so $\\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) = |\\mathbf{e}(0)|^2 = 1$. The probability of this is $\\exp(-\\alpha\\tau)$.\nIf there is at least one tumble, the orientation at time $\\tau$ is independent of $\\mathbf{e}(0)$, so the expectation of the dot product is $0$.\nThus, the orientation autocorrelation function is:\n$$\nC(\\tau) = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle = (1) \\cdot \\exp(-\\alpha\\tau) + (0) \\cdot (1 - \\exp(-\\alpha\\tau)) = \\exp(-\\alpha\\tau)\n$$\nSo, $\\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle = \\exp(-\\alpha|t' - t''|)$.\n\nNow we return to the MSD integral:\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = v_0^2 \\int_0^t dt' \\int_0^t dt'' \\exp(-\\alpha|t' - t''|)\n$$\nWe can split the square domain of integration $t', t'' \\in [0, t]$ into two triangles: one where $t' > t''$ and one where $t'' > t'$. By symmetry, the integrals over these two regions are equal.\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = 2 v_0^2 \\int_0^t dt' \\int_0^{t'} dt'' \\exp(-\\alpha(t' - t''))\n$$\nFirst, we evaluate the inner integral with respect to $t''$:\n$$\n\\int_0^{t'} \\exp(-\\alpha(t' - t'')) dt'' = \\exp(-\\alpha t') \\int_0^{t'} \\exp(\\alpha t'') dt'' = \\exp(-\\alpha t') \\left[ \\frac{1}{\\alpha} \\exp(\\alpha t'') \\right]_0^{t'}\n$$\n$$\n= \\frac{\\exp(-\\alpha t')}{\\alpha} (\\exp(\\alpha t') - \\exp(0)) = \\frac{1}{\\alpha}(1 - \\exp(-\\alpha t'))\n$$\nNext, we evaluate the outer integral with respect to $t'$:\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = 2 v_0^2 \\int_0^t \\frac{1}{\\alpha}(1 - \\exp(-\\alpha t')) dt' = \\frac{2v_0^2}{\\alpha} \\int_0^t (1 - \\exp(-\\alpha t')) dt'\n$$\n$$\n= \\frac{2v_0^2}{\\alpha} \\left[ t' - \\left(-\\frac{1}{\\alpha}\\right)\\exp(-\\alpha t') \\right]_0^t = \\frac{2v_0^2}{\\alpha} \\left[ t' + \\frac{1}{\\alpha}\\exp(-\\alpha t') \\right]_0^t\n$$\n$$\n= \\frac{2v_0^2}{\\alpha} \\left( \\left(t + \\frac{1}{\\alpha}\\exp(-\\alpha t)\\right) - \\left(0 + \\frac{1}{\\alpha}\\exp(0)\\right) \\right) = \\frac{2v_0^2}{\\alpha} \\left( t + \\frac{1}{\\alpha}(\\exp(-\\alpha t) - 1) \\right)\n$$\nRearranging this gives the final expression for the MSD:\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle = \\frac{2v_0^2}{\\alpha^2}(\\alpha t - 1 + \\exp(-\\alpha t))\n$$\nTo find the effective long-time diffusivity $D_{\\mathrm{eff}}$, we examine the behavior of the MSD as $t \\to \\infty$. In this limit, the $\\exp(-\\alpha t)$ term vanishes:\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle \\sim \\frac{2v_0^2}{\\alpha^2}(\\alpha t - 1) = \\frac{2v_0^2}{\\alpha}t - \\frac{2v_0^2}{\\alpha^2} \\quad \\text{for } t \\to \\infty\n$$\nThe long-time behavior is linear in $t$, which is characteristic of diffusive motion. For diffusion in $d$ dimensions, the MSD takes the form $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle \\sim 2d D_{\\mathrm{eff}} t$. In our case, the dimension is $d=2$. Therefore, we match the leading-order term with $4D_{\\mathrm{eff}}t$:\n$$\n4 D_{\\mathrm{eff}} t = \\frac{2v_0^2}{\\alpha} t\n$$\nSolving for $D_{\\mathrm{eff}}$ yields:\n$$\nD_{\\mathrm{eff}} = \\frac{2v_0^2}{4\\alpha} = \\frac{v_0^2}{2\\alpha}\n$$\nThe two required quantities have been derived from first principles.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2v_0^2}{\\alpha^2} (\\alpha t - 1 + \\exp(-\\alpha t)) & \\frac{v_0^2}{2\\alpha} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While exact solutions are enlightening, much of active matter theory relies on powerful approximation schemes, and it is critical to understand their domains of validity. Here, we explore the Unified Colored Noise Approximation (UCNA) for simplifying the dynamics of Active Ornstein-Uhlenbeck Particles (AOUPs). This practice  is a two-part challenge: first, you will derive the analytical conditions under which the UCNA breaks down, linking its failure to the curvature of the confining potential, and then you will write a program to numerically observe this breakdown, gaining invaluable experience in testing the limits of a theoretical approximation.",
            "id": "3780830",
            "problem": "Consider a one-dimensional population of Active Ornstein–Uhlenbeck Particles (AOUPs) whose configuration coordinate $x(t)$ obeys the overdamped dynamics $\\dot{x}(t) = -\\mu \\, U'(x(t)) + \\eta(t)$, where $U(x)$ is a deterministic potential, $\\mu$ is a mobility, and $\\eta(t)$ is an Ornstein–Uhlenbeck colored noise of correlation time $\\tau$ and intensity $D$ defined by the stochastic differential equation $\\tau \\, \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\, \\xi(t)$, with $\\xi(t)$ a zero-mean delta-correlated Gaussian white noise. The Unified Colored Noise Approximation (UCNA) seeks an effective description in terms of a transformed drift and diffusion by adiabatically eliminating the fast colored noise and mapping the dynamics to a multiplicative-noise form. In one dimension, the UCNA introduces a Jacobian determinant for the change of variables and curvature-driven corrections in the effective drift that depend on the second derivative of the potential. In nonconvex or multistable potentials, these corrections can lead to breakdown conditions signaled by the sign of the Jacobian determinant and singularities in the effective drift.\n\nStarting from the AOUP equations and the definitions above as the fundamental base, derive the one-dimensional UCNA expressions for the effective drift and the Jacobian determinant in terms of the potential curvature. Explain why nonconvex regions (where $U''(x)  0$) can invalidate the approximation, and identify the precise mathematical condition that signals breakdown. Then implement a program to examine the breakdown of UCNA in several potentials by evaluating the Jacobian determinant $J(x)$ and curvature corrections in the effective drift over a specified domain.\n\nAll quantities are dimensionless; angles must be treated in radians.\n\nYour program must:\n- Use the derived one-dimensional UCNA expressions to compute, on a uniform grid of $N=10001$ points over the specified domain, the following for each test case:\n    1. A boolean validity flag indicating whether the Jacobian determinant is strictly positive everywhere on the domain, i.e., whether $\\min_{x} J(x) > 0$.\n    2. The minimum value of the Jacobian determinant, i.e., $\\min_{x} J(x)$.\n    3. The integer count of grid points at which $J(x) \\le 0$.\n    4. The maximum absolute curvature correction magnitude $\\max_{x} |\\kappa(x)|$, where $\\kappa(x)$ is the curvature correction parameter defined by your derivation.\n    5. The maximum absolute deviation of the effective drift multiplier from unity, computed as $\\max_{x: J(x) > 0} | m(x) - 1 |$ where $m(x)$ is the multiplicative correction factor in the effective drift that you derive. This quantity must be computed only over points where $J(x) > 0$.\n- Aggregate the results for all test cases into a single line of output containing a list of lists in the exact format: $[[\\text{valid}_1,\\min J_1,\\text{count}_1,\\max|\\kappa|_1,\\max|m-1|_1],\\ldots]$, where each inner list corresponds to one test case in the order provided below.\n\nTest suite (angles in radians, all parameters dimensionless):\n- Case 1 (convex reference): $U(x) = \\frac{k}{2} x^2$, with $k = 1$, domain $x \\in [-5,5]$, $\\mu = 1$, $\\tau = 0.1$.\n- Case 2 (double-well boundary): $U(x) = \\frac{a}{4} x^4 - \\frac{b}{2} x^2$, with $a = 1$, $b = 2$, domain $x \\in [-2,2]$, $\\mu = 1$, $\\tau = 0.5$.\n- Case 3 (double-well breakdown): $U(x) = \\frac{a}{4} x^4 - \\frac{b}{2} x^2$, with $a = 1$, $b = 2$, domain $x \\in [-2,2]$, $\\mu = 1$, $\\tau = 0.8$.\n- Case 4 (periodic convex regime): $U(x) = V_0 (1 - \\cos(q x))$, with $V_0 = 1$, $q = 2$, domain $x \\in [-\\pi,\\pi]$, $\\mu = 1$, $\\tau = 0.2$.\n- Case 5 (periodic breakdown regime): $U(x) = V_0 (1 - \\cos(q x))$, with $V_0 = 1$, $q = 2$, domain $x \\in [-\\pi,\\pi]$, $\\mu = 1$, $\\tau = 0.6$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets as follows: $[[\\text{valid}_1,\\min J_1,\\text{count}_1,\\max|\\kappa|_1,\\max|m-1|_1],[\\text{valid}_2,\\min J_2,\\text{count}_2,\\max|\\kappa|_2,\\max|m-1|_2],\\ldots]$.",
            "solution": "The problem requires the derivation of the one-dimensional Unified Colored Noise Approximation (UCNA) expressions for an Active Ornstein-Uhlenbeck Particle (AOUP) and the implementation of a program to analyze the breakdown of this approximation for several potentials.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\nThe physical system is a one-dimensional AOUP with position $x(t)$ governed by the following system of stochastic differential equations (SDEs):\n- Dynamics of position: $ \\dot{x}(t) = -\\mu \\, U'(x(t)) + \\eta(t) $\n- Dynamics of active noise: $ \\tau \\, \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\, \\xi(t) $\n\nThe parameters are:\n- $U(x)$: A deterministic potential.\n- $\\mu$: A mobility constant.\n- $\\eta(t)$: An Ornstein-Uhlenbeck (OU) colored noise process.\n- $\\tau$: The correlation time of the OU noise.\n- $D$: The intensity of the OU noise.\n- $\\xi(t)$: A zero-mean, delta-correlated Gaussian white noise, i.e., $\\langle \\xi(t) \\rangle = 0$ and $\\langle \\xi(t) \\xi(s) \\rangle = \\delta(t-s)$.\n\nNumerical and programming requirements:\n- Grid points: $N=10001$ over a specified domain.\n- Test cases are provided with specific potentials $U(x)$, domains, and parameters $\\mu, \\tau$. All quantities are dimensionless.\n- The program must compute and output a list of lists containing five quantities for each test case:\n    1. Boolean validity flag: $\\min_{x} J(x) > 0$.\n    2. Minimum Jacobian value: $\\min_{x} J(x)$.\n    3. Integer count of grid points where $J(x) \\le 0$.\n    4. Maximum absolute curvature correction magnitude: $\\max_{x} |\\kappa(x)|$.\n    5. Maximum absolute deviation of the effective drift multiplier: $\\max_{x: J(x) > 0} |m(x) - 1|$.\n\n**1.2. Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem describes a standard model in statistical physics for active matter (AOUPs). The UCNA is a well-established theoretical tool used to approximate the dynamics of such systems. The governing equations and concepts are rooted in fundamental principles of stochastic processes and non-equilibrium statistical mechanics. The problem is scientifically sound.\n- **Well-Posed:** The problem is clearly defined. The derivation is a standard procedure in the field, and the numerical task is specified with all necessary parameters, domains, and output formats. A unique and meaningful solution exists.\n- **Objective:** The language is precise, technical, and free of bias or subjective claims.\n\n**1.3. Verdict and Action**\n\nThe problem is valid. It is a well-defined task in computational statistical physics that involves both theoretical derivation and numerical implementation.\n\n### Step 2: Derivation of UCNA Expressions and Breakdown Condition\n\nThe Unified Colored Noise Approximation (UCNA) is a technique for adiabatically eliminating a \"fast\" colored noise variable from a system of SDEs to obtain an effective one-dimensional Fokker-Planck or Langevin equation. The starting point is the coupled system for the AOUP:\n$$\n\\dot{x}(t) = -\\mu U'(x) + \\eta(t) \\quad \\text{(1)}\n$$\n$$\n\\tau \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\xi(t) \\quad \\text{(2)}\n$$\nThis system describes the motion of a particle subject to a potential force $F(x) = -\\mu U'(x)$ and an active force $\\eta(t)$ which is itself a stochastic process with a finite memory time $\\tau$.\n\nThe UCNA provides an approximate description valid for small but non-zero $\\tau$. Under this approximation, the dynamics of $x(t)$ can be described by an effective Stratonovich Langevin equation:\n$$\n\\dot{x}(t) = v_{eff}(x) + \\sqrt{2 D_{eff}(x)} \\, \\zeta(t)\n$$\nwhere $\\zeta(t)$ is a unit-intensity Gaussian white noise. The effective drift $v_{eff}(x)$ and effective diffusion coefficient $D_{eff}(x)$ encapsulate the influence of the colored noise.\n\nThe standard result of the UCNA applied to the system (1)-(2) yields the following expressions for the effective drift and diffusion. Let us define the drift term in equation (1) as $f(x) = -\\mu U'(x)$. Its derivative is $f'(x) = -\\mu U''(x)$. The UCNA provides the effective drift as:\n$$\nv_{eff}(x) = \\frac{f(x)}{1 + \\tau f'(x)} = \\frac{-\\mu U'(x)}{1 - \\tau \\mu U''(x)}\n$$\nThis expression is inconsistent with current literature on AOUPs. A more careful derivation, for example, via projection operator methods or a change of variables as detailed in works by Maggi et al. (2015) and Sharma  Brader (2017) for this specific AOUP model, gives the correct sign in the denominator. The resulting effective drift is:\n$$\nv_{eff}(x) = \\frac{-\\mu U'(x)}{1 + \\tau \\mu U''(x)}\n$$\nThe problem asks to identify several terms from this expression.\n\n**Jacobian Determinant, $J(x)$:**\nThe denominator of this expression, $J(x)$, arises from the Jacobian of the coordinate transformation used in the derivation of the UCNA. It is given by:\n$$\nJ(x) = 1 + \\tau \\mu U''(x)\n$$\n\n**Curvature Correction Parameter, $\\kappa(x)$:**\nThe term $\\tau \\mu U''(x)$ introduces a dependence on the local curvature of the potential, $U''(x)$. We define this as the curvature correction parameter:\n$$\n\\kappa(x) = \\tau \\mu U''(x)\n$$\nWith this definition, the Jacobian is simply $J(x) = 1 + \\kappa(x)$.\n\n**Effective Drift and Multiplicative Factor, $m(x)$:**\nThe effective drift can be rewritten to highlight the modification to the original drift:\n$$\nv_{eff}(x) = \\left( \\frac{1}{1 + \\tau \\mu U''(x)} \\right) (-\\mu U'(x)) = m(x) \\cdot (-\\mu U'(x))\n$$\nHere, $m(x)$ is the multiplicative correction factor:\n$$\nm(x) = \\frac{1}{J(x)} = \\frac{1}{1 + \\tau \\mu U''(x)}\n$$\n\n**Breakdown of the UCNA:**\nThe UCNA is an approximation based on a coordinate transformation that remains well-behaved. The approximation breaks down if the Jacobian determinant, $J(x)$, becomes zero or negative. This is the mathematical condition signalling breakdown:\n$$\nJ(x) \\le 0 \\quad \\Leftrightarrow \\quad 1 + \\tau \\mu U''(x) \\le 0\n$$\nThis can be rearranged to $\\tau \\mu U''(x) \\le -1$. Since $\\tau$ and $\\mu$ are positive constants, this inequality can only be satisfied if $U''(x)$ is negative. A region where $U''(x)  0$ is a **nonconvex** region of the potential (e.g., the region between the two wells of a double-well potential).\n\nIn convex regions where $U''(x) \\ge 0$, the curvature term $\\kappa(x) = \\tau \\mu U''(x)$ is non-negative, so the Jacobian $J(x) = 1 + \\kappa(x)$ is always greater than or equal to 1. In these regions, the UCNA is always well-defined.\n\nBreakdown occurs specifically in nonconvex regions where the negative curvature is sufficiently large, i.e., $U''(x) \\le -1/(\\tau \\mu)$. At points where $J(x) \\to 0$, the effective drift $v_{eff}(x)$ and the effective diffusion coefficient $D_{eff}(x) = D\\tau/J(x)^2$ both diverge. These singularities signal the failure of the adiabatic elimination procedure, as the particle dynamics can no longer be described by a simple effective potential landscape.\n\n### Step 3: Numerical Implementation\n\nThe program will implement the derived formulas to analyze the UCNA for the five given test cases. For each case, we will:\n1.  Define the potential $U(x)$ and its second derivative $U''(x)$.\n2.  Create a uniform grid of $N=10001$ points for the variable $x$ over the specified domain.\n3.  Calculate $U''(x)$ on this grid.\n4.  Compute the curvature correction parameter $\\kappa(x) = \\tau \\mu U''(x)$.\n5.  Compute the Jacobian $J(x) = 1 + \\kappa(x)$.\n6.  From $J(x)$ and $\\kappa(x)$, calculate the five required quantities:\n    - $\\min_{x} J(x) > 0$\n    - $\\min_{x} J(x)$\n    - The number of grid points where $J(x) \\le 0$\n    - $\\max_{x} |\\kappa(x)|$\n    - $\\max_{x: J(x) > 0} |m(x) - 1|$, where $m(x)=1/J(x)$.\n\nThe results will be collected and printed in the specified format. The code is designed to be self-contained and directly executable.",
            "answer": "```python\nimport numpy as np\n\ndef analyze_ucna(potential_func, domain, params):\n    \"\"\"\n    Analyzes the breakdown of UCNA for a given potential.\n\n    Args:\n        potential_func (callable): A function that takes x and potential parameters,\n                                  and returns the second derivative U''(x).\n        domain (tuple): A tuple (x_min, x_max) for the analysis domain.\n        params (dict): A dictionary containing parameters for the potential,\n                       as well as mu and tau.\n\n    Returns:\n        list: A list containing the five required analysis results.\n              [validity_flag, min_J, count_J_le_0, max_abs_kappa, max_abs_m_minus_1]\n    \"\"\"\n    N = 10001\n    x_min, x_max = domain\n    x_grid = np.linspace(x_min, x_max, N)\n\n    mu = params['mu']\n    tau = params['tau']\n\n    # Calculate U''(x) on the grid\n    U_double_prime = potential_func(x_grid, params)\n\n    # 1. Curvature correction parameter kappa(x)\n    kappa = tau * mu * U_double_prime\n\n    # 2. Jacobian determinant J(x)\n    J = 1 + kappa\n\n    # 3. Multiplicative factor m(x)\n    # Use np.divide with a where clause to avoid division by zero warnings.\n    # The result for J=0 will be infinity, which is handled later.\n    m = np.divide(1.0, J, where=(J != 0))\n\n    # --- Compute the five required quantities ---\n\n    # Quantity 1: validity_flag\n    min_J = np.min(J)\n    validity_flag = min_J  0\n\n    # Quantity 2: min_J\n    # Already computed as min_J\n\n    # Quantity 3: count_J_le_0\n    count_J_le_0 = np.sum(J = 0)\n\n    # Quantity 4: max_abs_kappa\n    max_abs_kappa = np.max(np.abs(kappa))\n\n    # Quantity 5: max_abs_m_minus_1\n    valid_J_mask = J  0\n    if np.any(valid_J_mask):\n        m_valid = m[valid_J_mask]\n        max_abs_m_minus_1 = np.max(np.abs(m_valid - 1))\n    else:\n        # If J is non-positive everywhere, there are no valid points.\n        # This case is unlikely for the given problems but is handled for robustness.\n        # The deviation is infinite in principle.\n        max_abs_m_minus_1 = float('inf')\n\n    return [validity_flag, min_J, int(count_J_le_0), max_abs_kappa, max_abs_m_minus_1]\n\n# --- Potential Function Definitions ---\n\ndef U_quadratic_d2(x, params):\n    \"\"\"Second derivative of U(x) = k/2 * x^2\"\"\"\n    k = params['k']\n    return k * np.ones_like(x)\n\ndef U_double_well_d2(x, params):\n    \"\"\"Second derivative of U(x) = a/4 * x^4 - b/2 * x^2\"\"\"\n    a = params['a']\n    b = params['b']\n    return 3 * a * x**2 - b\n\ndef U_periodic_d2(x, params):\n    \"\"\"Second derivative of U(x) = V0 * (1 - cos(q*x))\"\"\"\n    V0 = params['V0']\n    q = params['q']\n    return V0 * q**2 * np.cos(q * x)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"potential_func\": U_quadratic_d2,\n            \"domain\": (-5.0, 5.0),\n            \"params\": {'k': 1.0, 'mu': 1.0, 'tau': 0.1}\n        },\n        {\n            \"potential_func\": U_double_well_d2,\n            \"domain\": (-2.0, 2.0),\n            \"params\": {'a': 1.0, 'b': 2.0, 'mu': 1.0, 'tau': 0.5}\n        },\n        {\n            \"potential_func\": U_double_well_d2,\n            \"domain\": (-2.0, 2.0),\n            \"params\": {'a': 1.0, 'b': 2.0, 'mu': 1.0, 'tau': 0.8}\n        },\n        {\n            \"potential_func\": U_periodic_d2,\n            \"domain\": (-np.pi, np.pi),\n            \"params\": {'V0': 1.0, 'q': 2.0, 'mu': 1.0, 'tau': 0.2}\n        },\n        {\n            \"potential_func\": U_periodic_d2,\n            \"domain\": (-np.pi, np.pi),\n            \"params\": {'V0': 1.0, 'q': 2.0, 'mu': 1.0, 'tau': 0.6}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_ucna(case[\"potential_func\"], case[\"domain\"], case[\"params\"])\n        results.append(result)\n\n    # Format the output string exactly as required\n    # Convert each inner list to a string\n    inner_lists_str = [f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]}]\" for res in results]\n    # Join them into a single string\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from analytical theory to computational practice requires careful consideration of numerical methods, as a naive implementation can introduce significant artifacts. In this exercise , you will first quantify the errors introduced by the standard Euler-Maruyama method for simulating an Active Brownian Particle (ABP) in a harmonic potential. You will then design and implement a more sophisticated integration scheme that correctly captures the particle's passive equilibrium behavior, learning a vital skill for developing robust and accurate simulations of active matter.",
            "id": "3780795",
            "problem": "Consider a two-dimensional Active Brownian Particle (ABP) with position $\\mathbf{x}(t) \\in \\mathbb{R}^2$ and orientation angle $\\theta(t) \\in \\mathbb{R}$, whose dynamics are modeled by the overdamped Langevin equation with self-propulsion and rotational noise. The fundamental base is the overdamped force balance and the Einstein relation for translational diffusion. Specifically, assume the following:\n- The overdamped translational dynamics are given by\n$$\n\\frac{d\\mathbf{x}}{dt} \\;=\\; -\\mu \\nabla U(\\mathbf{x}) \\;+\\; v_0 \\mathbf{n}(\\theta) \\;+\\; \\sqrt{2 D_t} \\,\\boldsymbol{\\xi}(t),\n$$\nwhere $\\mu$ is the mobility, $U(\\mathbf{x})$ is the potential, $v_0$ is the self-propulsion speed, $\\mathbf{n}(\\theta) = (\\cos\\theta, \\sin\\theta)$, $D_t$ is the translational diffusion coefficient, and $\\boldsymbol{\\xi}(t)$ is standard Gaussian white noise in two dimensions. The Einstein relation holds: $D_t = \\mu k_{\\mathrm{B}} T$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the temperature.\n- The rotational dynamics are given by\n$$\n\\frac{d\\theta}{dt} \\;=\\; \\sqrt{2 D_r} \\,\\eta(t),\n$$\nwhere $D_r$ is the rotational diffusion coefficient and $\\eta(t)$ is standard Gaussian white noise. Angles must be treated in radians.\n\nIn the passive limit $v_0 \\to 0$, the ABP reduces to an overdamped Brownian particle in the potential $U(\\mathbf{x})$. For the specific and scientifically consistent case $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$ (harmonic trap of stiffness $k$), the continuous-time stationary distribution is the Boltzmann distribution with a Gaussian covariance that satisfies $\\mathrm{Var}[x_i] = \\frac{k_{\\mathrm{B}} T}{k}$ for each Cartesian component $x_i$. This equilibrium follows from the fluctuation-dissipation balance and the linearity of the overdamped Langevin equation in a harmonic potential.\n\nTask:\n1. Starting from the above fundamental base and definitions, analyze the discretization errors introduced by the Euler–Maruyama method when applied to the ABP. Focus on the passive limit $v_0 \\to 0$ with the harmonic potential $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$, and derive the stationary variance of a single Cartesian component produced by the discrete-time Euler–Maruyama scheme as a function of the time step $\\Delta t$, the stiffness $k$, and the mobility $\\mu$. Express your result in terms of the relaxation rate $\\lambda = \\mu k$ and the translational diffusion coefficient $D_t = \\mu k_{\\mathrm{B}} T$.\n2. Design a time-discrete numerical scheme for the ABP that, for the harmonic potential $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$, reproduces the correct passive equilibrium in the limit $v_0 \\to 0$ for any finite time step $\\Delta t$. The scheme must be physically and mathematically sound, and must be derived from the exact solution of the linear passive dynamics combined with a consistent treatment of the active drift over a single time step. State clearly how the orientation is updated (the angle unit must be radians) and how the self-propulsion contribution is approximated within a single time step so that the passive limit is preserved.\n3. Implement a program that computes quantitative measures comparing the Euler–Maruyama scheme and your designed scheme in the passive limit. Use the following test suite, all in two dimensions, with dimensionless parameters:\n   - Translational mobility $\\mu = 1$, temperature such that $k_{\\mathrm{B}} T = 1$, hence $D_t = 1$.\n   - Harmonic stiffness $k = 1$, hence relaxation rate $\\lambda = 1$.\n   - Rotational diffusion coefficient $D_r = 2$.\n   - Time steps $\\Delta t \\in \\{0.01, 0.5, 1.9\\}$.\n   - Passive limit enforced exactly by setting $v_0 = 0$.\n   For each $\\Delta t$, compute:\n   - The relative stationary variance bias of a single Cartesian component under Euler–Maruyama in the passive limit, defined as\n   $$\n   \\varepsilon_{\\mathrm{EM}}(\\Delta t) \\;=\\; \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1,\n   $$\n   where $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k}$ is the equilibrium variance and $\\mathrm{Var}_{\\mathrm{EM}}$ is the stationary variance produced by Euler–Maruyama at time step $\\Delta t$.\n   - The corresponding relative stationary variance bias for your designed scheme, $\\varepsilon_{\\mathrm{scheme}}(\\Delta t)$, under the same conditions.\n   Additionally, include a free-diffusion edge case to test another facet of the discretization in the absence of confinement:\n   - Set $k = 0$ while keeping $\\mu = 1$, $k_{\\mathrm{B}} T = 1$, hence $D_t = 1$, and consider a single time step $\\Delta t = 1$ with $v_0 = 0$. Compute the ratio of the mean-squared displacement per step to its theoretical value $4 D_t \\Delta t$ in two dimensions for both Euler–Maruyama and your designed scheme, i.e., $r_{\\mathrm{EM}} = \\frac{\\mathrm{MSD}_{\\mathrm{EM}}}{4 D_t \\Delta t}$ and $r_{\\mathrm{scheme}} = \\frac{\\mathrm{MSD}_{\\mathrm{scheme}}}{4 D_t \\Delta t}$.\n4. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as follows for the above test suite:\n   $$\n   [\\varepsilon_{\\mathrm{EM}}(0.01), \\varepsilon_{\\mathrm{scheme}}(0.01), \\varepsilon_{\\mathrm{EM}}(0.5), \\varepsilon_{\\mathrm{scheme}}(0.5), \\varepsilon_{\\mathrm{EM}}(1.9), \\varepsilon_{\\mathrm{scheme}}(1.9), r_{\\mathrm{EM}}, r_{\\mathrm{scheme}}].\n   $$\nAll angles must be treated in radians. All outputs must be dimensionless numbers. No percentages are allowed; use decimal numbers.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- An Active Brownian Particle (ABP) in two dimensions with position $\\mathbf{x}(t) \\in \\mathbb{R}^2$ and orientation $\\theta(t) \\in \\mathbb{R}$.\n- Translational dynamics: $\\frac{d\\mathbf{x}}{dt} = -\\mu \\nabla U(\\mathbf{x}) + v_0 \\mathbf{n}(\\theta) + \\sqrt{2 D_t} \\,\\boldsymbol{\\xi}(t)$, where $\\mu$ is mobility, $U(\\mathbf{x})$ is a potential, $v_0$ is self-propulsion speed, $\\mathbf{n}(\\theta) = (\\cos\\theta, \\sin\\theta)$, $D_t$ is the translational diffusion coefficient, and $\\boldsymbol{\\xi}(t)$ is 2D standard Gaussian white noise.\n- Rotational dynamics: $\\frac{d\\theta}{dt} = \\sqrt{2 D_r} \\,\\eta(t)$, where $D_r$ is the rotational diffusion coefficient and $\\eta(t)$ is standard Gaussian white noise.\n- Einstein relation: $D_t = \\mu k_{\\mathrm{B}} T$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is temperature.\n- A specific potential is given: a harmonic trap $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$ with stiffness $k$.\n- For this potential, the equilibrium variance in the passive limit ($v_0 \\to 0$) is stated as $\\mathrm{Var}[x_i] = \\frac{k_{\\mathrm{B}} T}{k}$ for each Cartesian component.\n- The relaxation rate is defined as $\\lambda = \\mu k$.\n- Task 1: Derive the stationary variance of a single Cartesian component for the Euler–Maruyama scheme in the passive limit with the harmonic potential, as a function of $\\Delta t$, $k$, and $\\mu$ (or $\\lambda$ and $D_t$).\n- Task 2: Design a time-discrete numerical scheme that reproduces the correct passive equilibrium variance for any finite $\\Delta t > 0$.\n- Task 3: Implement a program to compute specific quantitative measures for given parameters:\n    - Parameters: $\\mu = 1$, $k_{\\mathrm{B}} T = 1$ ($D_t = 1$), $k = 1$ ($\\lambda = 1$), $D_r = 2$, $v_0 = 0$.\n    - Time steps for harmonic trap: $\\Delta t \\in \\{0.01, 0.5, 1.9\\}$.\n    - Quantities: Relative variance bias $\\varepsilon_{\\mathrm{EM}}(\\Delta t) = \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1$ and $\\varepsilon_{\\mathrm{scheme}}(\\Delta t)$ for the designed scheme.\n    - Free-diffusion edge case: $k = 0$, $\\Delta t = 1$.\n    - Quantities: MSD ratio $r = \\frac{\\mathrm{MSD}}{4 D_t \\Delta t}$ for both schemes.\n- Task 4: The program output must be a single line: `[$\\varepsilon_{\\mathrm{EM}}(0.01), \\varepsilon_{\\mathrm{scheme}}(0.01), \\varepsilon_{\\mathrm{EM}}(0.5), \\varepsilon_{\\mathrm{scheme}}(0.5), \\varepsilon_{\\mathrm{EM}}(1.9), \\varepsilon_{\\mathrm{scheme}}(1.9), r_{\\mathrm{EM}}, r_{\\mathrm{scheme}}$]`.\n- All angles are in radians.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded:** The problem is firmly rooted in statistical mechanics, specifically the theory of stochastic processes (Langevin equations) and their numerical integration, which is a standard and fundamental topic in computational physics and multiscale modeling. The model of an Active Brownian Particle is a canonical model in the field of active matter.\n- **Well-Posed:** The problem provides all necessary definitions, equations, and parameters. The tasks are specified with mathematical precision, leading to a unique and meaningful set of analytical and numerical results.\n- **Objective:** The problem is stated using formal, objective scientific language, free from ambiguity or subjective claims.\n\nThe problem does not exhibit any of the invalidity flaws. It is a scientifically sound, well-posed, and formalizable exercise in a relevant subfield of computational science.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution\n\nThe solution is presented in three parts, corresponding to the tasks defined in the problem statement.\n\n#### Part 1: Stationary Variance of the Euler–Maruyama Scheme\n\nWe consider the passive limit ($v_0 \\to 0$) in the harmonic potential $U(\\mathbf{x}) = \\frac{k}{2} \\|\\mathbf{x}\\|^2$. The force is $\\mathbf{F} = -\\nabla U(\\mathbf{x}) = -k\\mathbf{x}$. The Langevin equation for the position $\\mathbf{x}$ becomes:\n$$\n\\frac{d\\mathbf{x}}{dt} = -\\mu k \\mathbf{x} + \\sqrt{2 D_t} \\boldsymbol{\\xi}(t)\n$$\nThis vector equation decouples into two identical, independent equations for the Cartesian components $x$ and $y$. Let's analyze one component, $x(t)$:\n$$\n\\frac{dx}{dt} = -\\lambda x + \\sqrt{2 D_t} \\xi_x(t)\n$$\nwhere $\\lambda = \\mu k$ is the relaxation rate and $\\xi_x(t)$ is a one-dimensional standard Gaussian white noise. This is an Ornstein-Uhlenbeck process.\n\nThe Euler–Maruyama discretization of this stochastic differential equation with a time step $\\Delta t$ is:\n$$\nx_{n+1} = x_n - \\lambda x_n \\Delta t + \\sqrt{2 D_t \\Delta t} \\mathcal{N}_n\n$$\nwhere $\\mathcal{N}_n$ is a random number drawn from a standard normal distribution $\\mathcal{N}(0, 1)$. We can rewrite this as:\n$$\nx_{n+1} = (1 - \\lambda \\Delta t) x_n + \\sqrt{2 D_t \\Delta t} \\mathcal{N}_n\n$$\nTo find the stationary variance, $\\mathrm{Var}_{\\mathrm{EM}}$, we assume the process has reached a stationary state, such that $\\mathrm{Var}[x_{n+1}] = \\mathrm{Var}[x_n] = \\mathrm{Var}_{\\mathrm{EM}}$. The mean is $\\mathrm{E}[x_n] = 0$.\nTaking the variance of both sides and using the fact that $x_n$ and the noise term $\\mathcal{N}_n$ are independent:\n$$\n\\mathrm{Var}[x_{n+1}] = \\mathrm{Var}[(1 - \\lambda \\Delta t) x_n] + \\mathrm{Var}[\\sqrt{2 D_t \\Delta t} \\mathcal{N}_n]\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = (1 - \\lambda \\Delta t)^2 \\mathrm{Var}[x_n] + (2 D_t \\Delta t) \\mathrm{Var}[\\mathcal{N}_n]\n$$\nSince $\\mathrm{Var}[\\mathcal{N}_n] = 1$ and $\\mathrm{Var}[x_n] = \\mathrm{Var}_{\\mathrm{EM}}$:\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = (1 - \\lambda \\Delta t)^2 \\mathrm{Var}_{\\mathrm{EM}} + 2 D_t \\Delta t\n$$\nSolving for $\\mathrm{Var}_{\\mathrm{EM}}$:\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 1 - (1 - \\lambda \\Delta t)^2 \\right] = 2 D_t \\Delta t\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 1 - (1 - 2\\lambda \\Delta t + \\lambda^2 \\Delta t^2) \\right] = 2 D_t \\Delta t\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 2\\lambda \\Delta t - \\lambda^2 \\Delta t^2 \\right] = 2 D_t \\Delta t\n$$\nAssuming $\\Delta t > 0$, we can divide by $\\Delta t$:\n$$\n\\mathrm{Var}_{\\mathrm{EM}} (2\\lambda - \\lambda^2 \\Delta t) = 2 D_t\n$$\nThis gives the stationary variance produced by the Euler–Maruyama scheme:\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = \\frac{2 D_t}{2\\lambda - \\lambda^2 \\Delta t} = \\frac{D_t}{\\lambda (1 - \\frac{\\lambda \\Delta t}{2})}\n$$\nThe scheme is stable only for $1 - \\frac{\\lambda \\Delta t}{2} > 0$, i.e., $\\Delta t  2/\\lambda$.\nThe exact equilibrium variance is $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k}$. Using the given relations $D_t = \\mu k_{\\mathrm{B}} T$ and $\\lambda = \\mu k$, we can write $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{D_t/\\mu}{\\lambda/\\mu} = \\frac{D_t}{\\lambda}$.\nThus, the variance from the Euler-Maruyama scheme is $\\mathrm{Var}_{\\mathrm{EM}} = \\frac{\\mathrm{Var}_{\\mathrm{eq}}}{1 - \\frac{\\lambda \\Delta t}{2}}$.\n\n#### Part 2: Design of a Corrected Scheme\nTo design a scheme that preserves the correct passive equilibrium for any finite $\\Delta t$, we use the exact solution of the linear Ornstein-Uhlenbeck process over one time step. The formal solution to $dx = -\\lambda x dt + \\sqrt{2 D_t} dW_t$ from time $t$ to $t+\\Delta t$ is:\n$$\nx(t+\\Delta t) = x(t) e^{-\\lambda \\Delta t} + \\int_t^{t+\\Delta t} e^{-\\lambda(t+\\Delta t - s)} \\sqrt{2 D_t} dW_s\n$$\nThe integral term represents a Gaussian random variable with mean $0$ and variance given by the Itō isometry:\n$$\n\\mathrm{Var}_{\\mathrm{noise}} = \\int_t^{t+\\Delta t} \\left( e^{-\\lambda(t+\\Delta t - s)} \\sqrt{2 D_t} \\right)^2 ds = 2 D_t \\int_t^{t+\\Delta t} e^{-2\\lambda(t+\\Delta t - s)} ds\n$$\nPerforming the integral yields:\n$$\n\\mathrm{Var}_{\\mathrm{noise}} = 2 D_t \\left[ \\frac{e^{-2\\lambda(t+\\Delta t - s)}}{2\\lambda} \\right]_t^{t+\\Delta t} = \\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})\n$$\nThis leads to an exact update rule for the passive particle in the harmonic trap:\n$$\n\\mathbf{x}_{n+1} = \\mathbf{x}_n e^{-\\lambda \\Delta t} + \\sqrt{\\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})} \\boldsymbol{\\mathcal{N}}_n\n$$\nwhere $\\boldsymbol{\\mathcal{N}}_n$ is a $2$-dimensional standard normal random vector. By construction, the stationary variance of this scheme is exactly $\\frac{D_t}{\\lambda} = \\mathrm{Var}_{\\mathrm{eq}}$ for any $\\Delta t > 0$.\n\nTo incorporate the active self-propulsion term $v_0 \\mathbf{n}(\\theta)$, we must consistently integrate it over the time step. The full equation is $d\\mathbf{x} = (-\\lambda\\mathbf{x} + v_0\\mathbf{n}(\\theta(t)))dt + \\sqrt{2 D_t} d\\mathbf{W}_t$. Using an integrating factor approach, the active drift contribution over a step $\\Delta t$ can be approximated by assuming the orientation $\\theta$ is constant, $\\theta(s) \\approx \\theta_n$, for $s \\in [t_n, t_{n+1}]$. The integrated term is:\n$$\n\\int_{t_n}^{t_{n+1}} e^{-\\lambda(t_{n+1}-s)} v_0 \\mathbf{n}(\\theta_n) ds = v_0 \\mathbf{n}(\\theta_n) \\int_{0}^{\\Delta t} e^{-\\lambda u} du = \\frac{v_0}{\\lambda} (1 - e^{-\\lambda \\Delta t}) \\mathbf{n}(\\theta_n)\n$$\nThe orientation itself evolves by pure rotational diffusion, for which the Euler-Maruyama update is exact:\n$$\n\\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\zeta_n\n$$\nwhere $\\zeta_n \\sim\\mathcal{N}(0,1)$.\n\nThus, the proposed scheme is:\n1.  Update orientation: $\\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\zeta_n$\n2.  Update position:\n    $$\n    \\mathbf{x}_{n+1} = \\mathbf{x}_n e^{-\\lambda \\Delta t} + \\frac{v_0}{\\lambda} (1 - e^{-\\lambda \\Delta t}) \\mathbf{n}(\\theta_n) + \\sqrt{\\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})} \\boldsymbol{\\mathcal{N}}_n\n    $$\nThis scheme correctly reduces to the passive equilibrium for $v_0 \\to 0$ for all $\\Delta t > 0$, and in the limit $\\lambda \\to 0$ (free diffusion), it correctly recovers the standard Euler-Maruyama scheme for ABPs.\n\n#### Part 3: Calculation of Quantitative Measures\n\nWe now compute the requested quantities using the derived formulas with the provided dimensionless parameters.\n\n**A. Harmonic Trap Cases** ($\\mu=1, k_{\\mathrm{B}}T=1, k=1 \\implies D_t=1, \\lambda=1$)\nThe equilibrium variance is $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k} = \\frac{1}{1} = 1$.\n\n- For $\\Delta t = 0.01$:\n    - $\\varepsilon_{\\mathrm{EM}}(0.01) = \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = \\frac{1}{1 - \\frac{\\lambda \\Delta t}{2}} - 1 = \\frac{1}{1 - \\frac{1 \\cdot 0.01}{2}} - 1 = \\frac{1}{0.995} - 1 = \\frac{0.005}{0.995} \\approx 0.0050251$\n    - $\\varepsilon_{\\mathrm{scheme}}(0.01) = \\frac{\\mathrm{Var}_{\\mathrm{scheme}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = \\frac{\\mathrm{Var}_{\\mathrm{eq}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = 0$\n\n- For $\\Delta t = 0.5$:\n    - $\\varepsilon_{\\mathrm{EM}}(0.5) = \\frac{1}{1 - \\frac{1 \\cdot 0.5}{2}} - 1 = \\frac{1}{0.75} - 1 = \\frac{1}{3} \\approx 0.333333$\n    - $\\varepsilon_{\\mathrm{scheme}}(0.5) = 0$\n\n- For $\\Delta t = 1.9$:\n    - $\\varepsilon_{\\mathrm{EM}}(1.9) = \\frac{1}{1 - \\frac{1 \\cdot 1.9}{2}} - 1 = \\frac{1}{1 - 0.95} - 1 = \\frac{1}{0.05} - 1 = 20 - 1 = 19$\n    - $\\varepsilon_{\\mathrm{scheme}}(1.9) = 0$\n\n**B. Free Diffusion Edge Case** ($k=0 \\implies \\lambda=0$; also $\\mu=1, k_{\\mathrm{B}}T=1, \\Delta t=1, v_0=0$)\nThe dynamics are $d\\mathbf{x} = \\sqrt{2 D_t} d\\mathbf{W}_t$. The theoretical Mean-Squared Displacement (MSD) in $2$ dimensions is $\\mathrm{MSD}_{\\mathrm{theory}} = 4 D_t \\Delta t$. With $D_t=1$ and $\\Delta t=1$, this is $\\mathrm{MSD}_{\\mathrm{theory}} = 4$.\n\n- For Euler–Maruyama: The scheme for $k=0$ is $\\mathbf{x}_{n+1} = \\mathbf{x}_n + \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_n$. The displacement in one step is $\\Delta\\mathbf{x} = \\mathbf{x}_{1} - \\mathbf{x}_{0} = \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_0$.\n    - The MSD is $\\mathrm{MSD}_{\\mathrm{EM}} = \\langle \\|\\Delta\\mathbf{x}\\|^2 \\rangle = \\langle (\\sqrt{2 D_t \\Delta t})^2 \\|\\boldsymbol{\\mathcal{N}}_0\\|^2 \\rangle = 2 D_t \\Delta t \\langle \\mathcal{N}_x^2 + \\mathcal{N}_y^2 \\rangle$.\n    - Since $\\langle\\mathcal{N}_x^2\\rangle = \\langle\\mathcal{N}_y^2\\rangle = 1$, we get $\\mathrm{MSD}_{\\mathrm{EM}} = 2 D_t \\Delta t (1+1) = 4 D_t \\Delta t$.\n    - The ratio is $r_{\\mathrm{EM}} = \\frac{\\mathrm{MSD}_{\\mathrm{EM}}}{\\mathrm{MSD}_{\\mathrm{theory}}} = \\frac{4 D_t \\Delta t}{4 D_t \\Delta t} = 1$.\n\n- For the designed scheme: We must take the limit as $\\lambda \\to 0$.\n    - The drift factor is $e^{-\\lambda \\Delta t} \\approx 1 - \\lambda \\Delta t$.\n    - The variance of the noise term is $\\frac{D_t}{\\lambda}(1 - e^{-2\\lambda\\Delta t}) \\approx \\frac{D_t}{\\lambda}(1 - (1 - 2\\lambda\\Delta t)) = 2 D_t \\Delta t$.\n    - In the limit $\\lambda=0$, the scheme becomes $\\mathbf{x}_{n+1} = \\mathbf{x}_n + \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_n$, which is identical to the Euler-Maruyama scheme for this case.\n    - Therefore, $\\mathrm{MSD}_{\\mathrm{scheme}} = 4 D_t \\Delta t$ and the ratio is $r_{\\mathrm{scheme}} = 1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes quantitative measures comparing the Euler-Maruyama scheme and\n    a corrected scheme for Active Brownian Particle dynamics in a passive limit.\n    \"\"\"\n\n    # Define test cases based on the problem statement.\n    # The parameters are dimensionless.\n    # Case 1-3: Harmonic Trap (k=1) with varying time steps.\n    # Case 4: Free Diffusion (k=0).\n    test_cases = [\n        # (mu, k_B*T, k, dt)\n        (1.0, 1.0, 1.0, 0.01),\n        (1.0, 1.0, 1.0, 0.5),\n        (1.0, 1.0, 1.0, 1.9),\n        (1.0, 1.0, 0.0, 1.0)\n    ]\n\n    results = []\n\n    # Process harmonic trap cases\n    for i in range(3):\n        mu, k_B_T, k, dt = test_cases[i]\n        \n        # Calculate derived parameters\n        D_t = mu * k_B_T\n        lambda_val = mu * k\n        \n        # Equilibrium variance (analytical)\n        # Var_eq = k_B_T / k, but here lambda_val and D_t are more direct.\n        # Var_eq = D_t / lambda_val\n        \n        # --- Euler-Maruyama Bias ---\n        # Formula derived as: eps_EM = (lambda * dt / 2) / (1 - lambda * dt / 2)\n        # This is Var_EM / Var_eq - 1, where Var_EM is stationary variance of EM.\n        denominator = 1.0 - lambda_val * dt / 2.0\n        \n        # The scheme is stable only if the denominator is positive.\n        if denominator = 0:\n            # Stationary variance diverges, so bias is infinite\n            eps_em = float('inf')  \n        else:\n            eps_em = (lambda_val * dt / 2.0) / denominator\n        results.append(eps_em)\n\n        # --- Designed Scheme Bias ---\n        # The designed scheme reproduces the correct equilibrium variance for any dt  0.\n        # Thus, its stationary variance is Var_eq, and the bias is 0.\n        eps_scheme = 0.0\n        results.append(eps_scheme)\n\n    # Process free diffusion case\n    mu, k_B_T, k, dt = test_cases[3]\n    D_t = mu * k_B_T\n    \n    # Theoretical Mean-Squared Displacement in 2D\n    msd_theory = 4.0 * D_t * dt\n\n    # --- Euler-Maruyama MSD Ratio ---\n    # For k=0, the EM scheme gives MSD_EM = 4 * D_t * dt.\n    msd_em = 4.0 * D_t * dt\n    r_em = msd_em / msd_theory\n    results.append(r_em)\n\n    # --- Designed Scheme MSD Ratio ---\n    # In the limit k - 0 (lambda - 0), the designed scheme reduces\n    # to the Euler-Maruyama scheme.\n    # Therefore, it also gives MSD_scheme = 4 * D_t * dt.\n    msd_scheme = 4.0 * D_t * dt\n    r_scheme = msd_scheme / msd_theory\n    results.append(r_scheme)\n    \n    # Final print statement in the exact required format.\n    # The map(str, ...) ensures float representation without trailing zeros for integers.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}