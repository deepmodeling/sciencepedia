{
    "hands_on_practices": [
        {
            "introduction": "The quantitative description of any grain boundary begins with its geometry. This is fundamentally defined by the misorientation, which is the rotation that maps the crystal lattice of one grain onto its neighbor, an element of the special orthogonal group $\\mathrm{SO}(3)$. This practice  guides you through a first-principles derivation of the rotation matrix, the mathematical operator that performs this transformation. Successfully completing this exercise is essential for building a solid foundation in the kinematics of crystalline materials and for calculating key grain boundary parameters.",
            "id": "3781543",
            "problem": "In three-dimensional crystal kinematics, a rigid rotation is represented by a matrix in the Special Orthogonal group (SO(3)), i.e., real orthogonal matrices with determinant equal to $+1$. Consider a unit axis $\\hat{n} \\in \\mathbb{R}^{3}$ and an angle $\\theta \\in \\mathbb{R}$. An orientation of a grain relative to a fixed sample frame is represented by a matrix $R \\in \\mathrm{SO}(3)$, and the orientation of a grain boundary is characterized by the misorientation between two grains with orientations $R_{1}$ and $R_{2}$.\n\n1) Starting only from the facts that (i) a rigid rotation preserves the Euclidean inner product, (ii) the infinitesimal generator of a rotation about axis $\\hat{n}$ is a real skew-symmetric matrix $[\\hat{n}]_{\\times}$ satisfying $[\\hat{n}]_{\\times}\\, \\mathbf{v} = \\hat{n} \\times \\mathbf{v}$ for any $\\mathbf{v} \\in \\mathbb{R}^{3}$, and (iii) a finite rotation by angle $\\theta$ about $\\hat{n}$ is obtained by the matrix exponential of $\\theta[\\hat{n}]_{\\times}$, derive a closed-form expression for the rotation matrix $R(\\hat{n},\\theta)$ in terms of $\\hat{n}$ and $\\theta$.\n\n2) Define the misorientation operator $M$ mapping the crystal frame of grain $1$ to that of grain $2$ in the sample frame, and express $M$ in terms of $R_{1}$ and $R_{2}$, assuming both are in $\\mathrm{SO}(3)$. Then, using only invariants of $M$ under change of basis, derive an expression for the misorientation angle $\\theta_{\\mathrm{mis}}$ in terms of $M$.\n\n3) Consider a bicrystal in which grain $1$ has orientation $R_{1} = I$ (the $3 \\times 3$ identity) and grain $2$ has orientation $R_{2} = R(\\hat{n},\\theta)$ with $\\hat{n} = \\frac{1}{\\sqrt{3}}(1,1,1)^{\\top}$ and $\\theta = \\frac{\\pi}{3}$. Using your results from parts (1) and (2), compute the misorientation angle $\\theta_{\\mathrm{mis}}$ for this bicrystal. Provide the exact value in radians.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. The provided information is sufficient and consistent for deriving a unique solution.\n\n### Part 1: Derivation of the Rotation Matrix\n\nWe are asked to derive a closed-form expression for the rotation matrix $R(\\hat{n},\\theta)$ starting from its definition as the matrix exponential of an infinitesimal generator.\nThe infinitesimal generator of a rotation about a unit axis $\\hat{n} \\in \\mathbb{R}^3$ is the skew-symmetric matrix $[\\hat{n}]_{\\times}$ whose action on a vector $\\mathbf{v} \\in \\mathbb{R}^3$ is given by the cross product: $[\\hat{n}]_{\\times} \\mathbf{v} = \\hat{n} \\times \\mathbf{v}$.\nA finite rotation by an angle $\\theta$ about $\\hat{n}$ is given by\n$$\nR(\\hat{n},\\theta) = \\exp(\\theta [\\hat{n}]_{\\times})\n$$\nTo find a closed-form expression, we use the Taylor series expansion of the matrix exponential. Let $K = [\\hat{n}]_{\\times}$.\n$$\nR(\\hat{n},\\theta) = \\exp(\\theta K) = \\sum_{k=0}^{\\infty} \\frac{(\\theta K)^k}{k!} = I + \\theta K + \\frac{\\theta^2}{2!} K^2 + \\frac{\\theta^3}{3!} K^3 + \\dots\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix. We need to find a recurrence relation for the powers of $K$.\nThe action of $K^2$ on a vector $\\mathbf{v}$ is:\n$$\nK^2 \\mathbf{v} = [\\hat{n}]_{\\times}([\\hat{n}]_{\\times} \\mathbf{v}) = \\hat{n} \\times (\\hat{n} \\times \\mathbf{v})\n$$\nUsing the vector triple product identity $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = (\\mathbf{a} \\cdot \\mathbf{c})\\mathbf{b} - (\\mathbf{a} \\cdot \\mathbf{b})\\mathbf{c}$, we have:\n$$\nK^2 \\mathbf{v} = (\\hat{n} \\cdot \\mathbf{v})\\hat{n} - (\\hat{n} \\cdot \\hat{n})\\mathbf{v}\n$$\nSince $\\hat{n}$ is a unit vector, $\\hat{n} \\cdot \\hat{n} = \\|\\hat{n}\\|^2 = 1$. The term $(\\hat{n} \\cdot \\mathbf{v})\\hat{n}$ can be written in matrix form as $(\\hat{n} \\otimes \\hat{n})\\mathbf{v}$, where $\\hat{n} \\otimes \\hat{n} = \\hat{n}\\hat{n}^{\\top}$ is the outer product.\n$$\nK^2 \\mathbf{v} = (\\hat{n} \\otimes \\hat{n})\\mathbf{v} - I\\mathbf{v} = (\\hat{n}\\hat{n}^{\\top} - I)\\mathbf{v}\n$$\nSince this holds for any $\\mathbf{v}$, the matrix $K^2$ is given by:\n$$\nK^2 = \\hat{n}\\hat{n}^{\\top} - I\n$$\nNow, we compute $K^3$:\n$$\nK^3 = K \\cdot K^2 = [\\hat{n}]_{\\times}(\\hat{n}\\hat{n}^{\\top} - I) = [\\hat{n}]_{\\times}(\\hat{n}\\hat{n}^{\\top}) - [\\hat{n}]_{\\times}\n$$\nThe action of the first term on a vector $\\mathbf{v}$ is $[\\hat{n}]_{\\times}(\\hat{n}\\hat{n}^{\\top}\\mathbf{v}) = \\hat{n} \\times ((\\hat{n}\\cdot\\mathbf{v})\\hat{n})$. Since the cross product of a vector with itself is zero ($\\hat{n} \\times \\hat{n} = \\mathbf{0}$), this term is the zero matrix. Thus,\n$$\nK^3 = -[\\hat{n}]_{\\times} = -K\n$$\nThis establishes a simple recurrence for the powers of $K$: $K^4 = -K^2$, $K^5 = K$, and so on. We can now substitute this into the Taylor series:\n$$\n\\exp(\\theta K) = I + \\theta K + \\frac{\\theta^2}{2!} K^2 - \\frac{\\theta^3}{3!} K - \\frac{\\theta^4}{4!} K^2 + \\frac{\\theta^5}{5!} K + \\dots\n$$\nGrouping terms by the matrices $I$, $K$, and $K^2$:\n$$\n\\exp(\\theta K) = I + \\left(\\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - \\dots\\right)K + \\left(\\frac{\\theta^2}{2!} - \\frac{\\theta^4}{4!} + \\frac{\\theta^6}{6!} - \\dots\\right)K^2\n$$\nWe recognize the Taylor series for sine and cosine:\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - \\dots\n$$\n$$\n1 - \\cos(\\theta) = 1 - \\left(1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - \\dots\\right) = \\frac{\\theta^2}{2!} - \\frac{\\theta^4}{4!} + \\dots\n$$\nSubstituting these series into the expression for $\\exp(\\theta K)$ yields Rodrigues' rotation formula:\n$$\nR(\\hat{n},\\theta) = I + \\sin(\\theta)[\\hat{n}]_{\\times} + (1 - \\cos(\\theta))[\\hat{n}]_{\\times}^2\n$$\n\n### Part 2: Misorientation Angle\n\nThe orientation of grain $1$, $R_1 \\in \\mathrm{SO}(3)$, maps a vector from the crystal frame of grain $1$ ($\\mathbf{x}_{c1}$) to the sample frame ($\\mathbf{x}_s$): $\\mathbf{x}_s = R_1 \\mathbf{x}_{c1}$.\nSimilarly, for grain $2$: $\\mathbf{x}_s = R_2 \\mathbf{x}_{c2}$.\nThe misorientation operator $M$ maps the crystal frame of grain $1$ to that of grain $2$, meaning $\\mathbf{x}_{c2} = M\\mathbf{x}_{c1}$.\nBy equating the expressions for $\\mathbf{x}_s$, we have $R_1 \\mathbf{x}_{c1} = R_2 \\mathbf{x}_{c2}$. Substituting the expression for $\\mathbf{x}_{c2}$:\n$$\nR_1 \\mathbf{x}_{c1} = R_2 (M \\mathbf{x}_{c1}) = (R_2 M) \\mathbf{x}_{c1}\n$$\nThis equation must hold for all vectors $\\mathbf{x}_{c1}$, which implies $R_1 = R_2 M$. We can solve for $M$ by left-multiplying by $R_2^{-1}$. Since $R_2 \\in \\mathrm{SO}(3)$, its inverse is its transpose, $R_2^{-1} = R_2^{\\top}$.\n$$\nM = R_2^{-1} R_1 = R_2^{\\top} R_1\n$$\nAs the product of two matrices in $\\mathrm{SO}(3)$, $M$ is also a rotation matrix in $\\mathrm{SO}(3)$. Thus, it can be represented by a misorientation axis $\\hat{n}_{\\mathrm{mis}}$ and a misorientation angle $\\theta_{\\mathrm{mis}}$.\n\nTo find an expression for $\\theta_{\\mathrm{mis}}$ using invariants of $M$, we consider the trace of $M$, which is invariant under any change of basis ($ \\mathrm{tr}(P^{-1}MP) = \\mathrm{tr}(M) $). We relate the trace of a general rotation matrix $R(\\hat{n},\\theta)$ to its angle $\\theta$. Using the result from Part 1:\n$$\n\\mathrm{tr}(R(\\hat{n},\\theta)) = \\mathrm{tr}(I + \\sin(\\theta)[\\hat{n}]_{\\times} + (1 - \\cos(\\theta))[\\hat{n}]_{\\times}^2)\n$$\nUsing the linearity of the trace operator:\n$$\n\\mathrm{tr}(R) = \\mathrm{tr}(I) + \\sin(\\theta)\\mathrm{tr}([\\hat{n}]_{\\times}) + (1 - \\cos(\\theta))\\mathrm{tr}([\\hat{n}]_{\\times}^2)\n$$\nThe trace of the identity matrix in $3$ dimensions is $\\mathrm{tr}(I) = 3$. The trace of any skew-symmetric matrix, such as $[\\hat{n}]_{\\times}$, is zero. For the trace of $[\\hat{n}]_{\\times}^2$, we use $K^2 = \\hat{n}\\hat{n}^{\\top} - I$:\n$$\n\\mathrm{tr}([\\hat{n}]_{\\times}^2) = \\mathrm{tr}(\\hat{n}\\hat{n}^{\\top} - I) = \\mathrm{tr}(\\hat{n}\\hat{n}^{\\top}) - \\mathrm{tr}(I)\n$$\nThe trace of the outer product $\\hat{n}\\hat{n}^{\\top}$ is $\\mathrm{tr}(\\hat{n}\\hat{n}^{\\top}) = \\hat{n}^{\\top}\\hat{n} = \\|\\hat{n}\\|^2 = 1$.\nSo, $\\mathrm{tr}([\\hat{n}]_{\\times}^2) = 1 - 3 = -2$.\nSubstituting these values back into the trace expression for $R$:\n$$\n\\mathrm{tr}(R) = 3 + \\sin(\\theta)(0) + (1 - \\cos(\\theta))(-2) = 3 - 2 + 2\\cos(\\theta) = 1 + 2\\cos(\\theta)\n$$\nApplying this general result to the misorientation matrix $M$:\n$$\n\\mathrm{tr}(M) = 1 + 2\\cos(\\theta_{\\mathrm{mis}})\n$$\nSolving for $\\theta_{\\mathrm{mis}}$:\n$$\n\\cos(\\theta_{\\mathrm{mis}}) = \\frac{\\mathrm{tr}(M) - 1}{2}\n$$\nBy convention, the misorientation angle is the minimum positive angle required for the transformation, which lies in the interval $[0, \\pi]$. The arccosine function returns a value in this range.\n$$\n\\theta_{\\mathrm{mis}} = \\arccos\\left(\\frac{\\mathrm{tr}(M) - 1}{2}\\right)\n$$\n\n### Part 3: Calculation for a Specific Bicrystal\n\nWe are given a bicrystal with grain orientations:\n$R_1 = I$\n$R_2 = R(\\hat{n},\\theta)$ where $\\hat{n} = \\frac{1}{\\sqrt{3}}(1,1,1)^{\\top}$ and $\\theta = \\frac{\\pi}{3}$.\n\nUsing the result from Part 2, the misorientation matrix $M$ is:\n$$\nM = R_2^{\\top} R_1 = (R(\\hat{n},\\theta))^{\\top} I = (R(\\hat{n},\\theta))^{\\top}\n$$\nThe transpose of a rotation matrix $R(\\hat{n},\\theta)$ is equivalent to a rotation about the same axis by the negative of the angle, i.e., $R(\\hat{n},-\\theta)$.\n$$\nM = R(\\hat{n},-\\theta)\n$$\nWe need to find the misorientation angle $\\theta_{\\mathrm{mis}}$ corresponding to the rotation matrix $M$. We can use the trace formula derived in Part 2:\n$$\n\\theta_{\\mathrm{mis}} = \\arccos\\left(\\frac{\\mathrm{tr}(M) - 1}{2}\\right)\n$$\nLet's first compute the trace of $M$.\n$$\n\\mathrm{tr}(M) = \\mathrm{tr}(R(\\hat{n},-\\theta))\n$$\nUsing the general formula $\\mathrm{tr}(R) = 1 + 2\\cos(\\theta_{\\text{rot}})$ with the rotation angle $\\theta_{\\text{rot}} = -\\theta$:\n$$\n\\mathrm{tr}(M) = 1 + 2\\cos(-\\theta) = 1 + 2\\cos(\\theta)\n$$\nNow, we substitute this into the expression for $\\theta_{\\mathrm{mis}}$:\n$$\n\\theta_{\\mathrm{mis}} = \\arccos\\left(\\frac{(1 + 2\\cos(\\theta)) - 1}{2}\\right) = \\arccos\\left(\\frac{2\\cos(\\theta)}{2}\\right) = \\arccos(\\cos(\\theta))\n$$\nWe are given $\\theta = \\frac{\\pi}{3}$.\n$$\n\\theta_{\\mathrm{mis}} = \\arccos\\left(\\cos\\left(\\frac{\\pi}{3}\\right)\\right)\n$$\nThe range of the arccosine function is $[0, \\pi]$. Since $\\frac{\\pi}{3}$ lies within this range, $\\arccos(\\cos(\\frac{\\pi}{3}))$ evaluates directly to $\\frac{\\pi}{3}$.\nTherefore, the misorientation angle is:\n$$\n\\theta_{\\mathrm{mis}} = \\frac{\\pi}{3} \\text{ radians}\n$$\nIn this specific case where one grain is aligned with the sample frame ($R_1 = I$), the misorientation is simply the rotation that defines the second grain's orientation. The misorientation angle is the angle of that rotation, provided it is taken as the smallest positive angle.",
            "answer": "$$\\boxed{\\frac{\\pi}{3}}$$"
        },
        {
            "introduction": "Beyond geometry, the physical properties of grain boundaries, such as their resistance to fracture, are of paramount importance. The Cohesive Zone Model (CZM) provides a powerful framework for modeling decohesion at interfaces by postulating a relationship between the traction across the interface and its separation. This exercise  challenges you to construct a physically-motivated traction–separation law and use it to derive the work of separation, a measure of interface toughness. This practice bridges the gap between the constitutive behavior of an interface and its macroscopic mechanical response.",
            "id": "3781475",
            "problem": "Consider a symmetric high-angle grain boundary in a crystalline solid under Mode I (opening) loading. In a Cohesive Zone Model (CZM), the grain boundary is represented by a cohesive interface whose response is characterized by a traction–separation law relating the normal traction $T(\\delta)$ to the interfacial opening displacement $\\delta$. Assume the following physically motivated constraints are satisfied:\n\n- The interface is initially intact and stress-free under zero separation, so $T(0)=0$.\n- Complete decohesion occurs at a critical separation $\\delta_c$ with zero traction, so $T(\\delta_c)=0$.\n- The traction increases monotonically from $\\delta=0$ to a unique maximum $T_c$ at a mid-separation due to symmetry, then decreases monotonically to zero at $\\delta=\\delta_c$.\n- The traction is smooth at the maximum so that the derivative vanishes there.\n\nModel the normalized shape of the traction–separation law by the minimal-degree polynomial $f(x)$ in the nondimensional separation $x=\\delta/\\delta_c$ that satisfies the symmetry requirement that the maximum occurs at $x=1/2$, and the constraints\n$$\nf(0)=0, \\quad f(1)=0, \\quad f\\!\\left(\\tfrac{1}{2}\\right)=1, \\quad f'\\!\\left(\\tfrac{1}{2}\\right)=0.\n$$\nDefine $T(\\delta)$ for $0\\le\\delta\\le\\delta_c$ by $T(\\delta)=T_c\\,f(\\delta/\\delta_c)$ with the above $f$. Using continuum thermodynamics, the work of separation $W$ is the reversible work needed to separate the interface from $\\delta=0$ to $\\delta=\\delta_c$, given by the area under the traction–separation curve,\n$$\nW=\\int_{0}^{\\delta_c} T(\\delta)\\, d\\delta.\n$$\nDerive $f(x)$ from the stated constraints and compute $W$ in closed form in terms of $T_c$ and $\\delta_c$. Express the final answer as an analytic expression. No numerical approximation or rounding is required.",
            "solution": "The problem statement is evaluated to be valid as it is scientifically grounded in the principles of continuum mechanics and fracture mechanics, specifically the Cohesive Zone Model (CZM). The problem is well-posed, providing a sufficient number of constraints to uniquely determine the minimal-degree polynomial for the traction-separation law. The language is objective and the setup is self-contained and consistent.\n\nThe task is to first derive the normalized traction-separation law, $f(x)$, and then use it to compute the work of separation, $W$.\n\nLet the normalized separation be $x = \\delta/\\delta_c$. The problem requires finding the minimal-degree polynomial $f(x)$ that satisfies the following four conditions:\n1.  $f(0) = 0$\n2.  $f(1) = 0$\n3.  $f(\\frac{1}{2}) = 1$\n4.  $f'(\\frac{1}{2}) = 0$\n\nFour independent constraints are sufficient to uniquely determine the coefficients of a cubic polynomial. Let us assume the polynomial is of the form $f(x) = ax^3 + bx^2 + cx + d$. Its derivative is $f'(x) = 3ax^2 + 2bx + c$.\n\nWe apply the given constraints to determine the coefficients $a$, $b$, $c$, and $d$.\n\nConstraint 1: $f(0) = 0$.\nSubstituting $x=0$ into the polynomial gives:\n$a(0)^3 + b(0)^2 + c(0) + d = 0 \\implies d = 0$.\nThe polynomial is thus at most a cubic of the form $f(x) = ax^3 + bx^2 + cx$.\n\nConstraint 2: $f(1) = 0$.\nSubstituting $x=1$:\n$a(1)^3 + b(1)^2 + c(1) = 0 \\implies a + b + c = 0$. (Eq. 1)\n\nConstraint 3: $f(\\frac{1}{2}) = 1$.\nSubstituting $x = 1/2$:\n$a(\\frac{1}{2})^3 + b(\\frac{1}{2})^2 + c(\\frac{1}{2}) = 1 \\implies \\frac{a}{8} + \\frac{b}{4} + \\frac{c}{2} = 1$.\nMultiplying by $8$ to clear the denominators yields:\n$a + 2b + 4c = 8$. (Eq. 2)\n\nConstraint 4: $f'(\\frac{1}{2}) = 0$.\nSubstituting $x = 1/2$ into the derivative $f'(x)$:\n$3a(\\frac{1}{2})^2 + 2b(\\frac{1}{2}) + c = 0 \\implies \\frac{3a}{4} + b + c = 0$.\nMultiplying by $4$ gives:\n$3a + 4b + 4c = 0$. (Eq. 3)\n\nWe now have a system of three linear equations for the three unknowns $a$, $b$, and $c$:\n(1) $a + b + c = 0$\n(2) $a + 2b + 4c = 8$\n(3) $3a + 4b + 4c = 0$\n\nFrom (Eq. 1), we can write $c = -a - b$. Substituting this into (Eq. 2) and (Eq. 3):\nSubstituting into (Eq. 2):\n$a + 2b + 4(-a - b) = 8 \\implies a + 2b - 4a - 4b = 8 \\implies -3a - 2b = 8$. (Eq. 4)\n\nSubstituting into (Eq. 3):\n$3a + 4b + 4(-a - b) = 0 \\implies 3a + 4b - 4a - 4b = 0 \\implies -a = 0 \\implies a = 0$.\n\nNow that we have $a=0$, we substitute this back into (Eq. 4):\n$-3(0) - 2b = 8 \\implies -2b = 8 \\implies b = -4$.\n\nFinally, we find $c$ using (Eq. 1):\n$c = -a - b = -(0) - (-4) = 4$.\n\nThe coefficients are $a=0$, $b=-4$, $c=4$, and $d=0$.\nThe polynomial is $f(x) = 0 \\cdot x^3 - 4x^2 + 4x = -4x^2 + 4x$.\nThis shows that the minimal-degree polynomial satisfying the constraints is in fact a quadratic, not a cubic. The polynomial can be written as $f(x) = 4x(1-x)$.\n\nNext, we calculate the work of separation, $W$, defined as:\n$$\nW = \\int_{0}^{\\delta_c} T(\\delta) \\, d\\delta\n$$\nGiven that $T(\\delta) = T_c f(\\delta/\\delta_c)$, we substitute this into the integral:\n$$\nW = \\int_{0}^{\\delta_c} T_c f\\left(\\frac{\\delta}{\\delta_c}\\right) \\, d\\delta\n$$\nTo simplify the integral, we perform a change of variables. Let $x = \\delta/\\delta_c$. Then $\\delta = x\\delta_c$, and the differential becomes $d\\delta = \\delta_c dx$. The limits of integration also change: when $\\delta=0$, $x=0$, and when $\\delta=\\delta_c$, $x=1$.\nThe expression for $W$ becomes:\n$$\nW = \\int_{0}^{1} T_c f(x) \\, (\\delta_c dx)\n$$\nSince $T_c$ and $\\delta_c$ are constants, they can be factored out of the integral:\n$$\nW = T_c \\delta_c \\int_{0}^{1} f(x) \\, dx\n$$\nNow, we substitute the derived polynomial $f(x) = -4x^2 + 4x$:\n$$\nW = T_c \\delta_c \\int_{0}^{1} (-4x^2 + 4x) \\, dx\n$$\nWe evaluate the definite integral:\n$$\n\\int_{0}^{1} (-4x^2 + 4x) \\, dx = \\left[ -4\\frac{x^3}{3} + 4\\frac{x^2}{2} \\right]_{0}^{1} = \\left[ -\\frac{4}{3}x^3 + 2x^2 \\right]_{0}^{1}\n$$\nEvaluating at the limits:\n$$\n\\left( -\\frac{4}{3}(1)^3 + 2(1)^2 \\right) - \\left( -\\frac{4}{3}(0)^3 + 2(0)^2 \\right) = \\left( -\\frac{4}{3} + 2 \\right) - (0) = \\frac{6}{3} - \\frac{4}{3} = \\frac{2}{3}\n$$\nSubstituting this result back into the expression for $W$:\n$$\nW = T_c \\delta_c \\left( \\frac{2}{3} \\right)\n$$\nThus, the work of separation is given by the expression $W = \\frac{2}{3} T_c \\delta_c$.",
            "answer": "$$\\boxed{\\frac{2}{3} T_c \\delta_c}$$"
        },
        {
            "introduction": "To predict the evolution of a complex network of grains, we turn to powerful computational tools like the phase-field method. These models describe a polycrystal using a set of continuous order parameter fields, $\\eta_i$, with the system's evolution driven by the minimization of a total free energy functional. This hands-on problem  takes you to the heart of the model, asking you to derive the thermodynamic forces that arise from the grain boundary interaction terms. This exercise is crucial for understanding how misorientation-dependent energies are implemented in modern simulation software to govern microstructural dynamics.",
            "id": "3781560",
            "problem": "Consider a multiphase-field representation of a polycrystal in which each grain is identified by a scalar order parameter $ \\eta_i \\in [0,1] $, where $ \\eta_i \\approx 1 $ inside grain $ i $ and $ \\eta_i \\approx 0 $ outside it. The total free energy functional is assumed to take the generic form\n$$\nF[\\{\\eta_i\\}] \\;=\\; \\int_{\\Omega} \\left( \\sum_i \\left[ W\\,\\eta_i^2(1-\\eta_i)^2 \\;+\\; \\kappa\\,|\\nabla \\eta_i|^2 \\right] \\;+\\; \\sum_{ij} \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 \\right)\\, dV,\n$$\nwhere $ W0 $ sets the height of the double-well potential, $ \\kappa0 $ is the gradient penalty coefficient, and $ \\gamma_{ij} $ is a grain boundary energy density coefficient that controls the interaction penalty between order parameters $ \\eta_i $ and $ \\eta_j $. The misorientation-dependent interaction energy is defined by\n$$\n\\gamma_{ij} \\;=\\; \\gamma_0 \\left[ 1 \\;-\\; \\alpha \\,\\cos\\!\\left(\\theta_{ij}\\right) \\right],\n$$\nwhere $ \\gamma_00 $ is a reference energy density, $ \\alpha \\in [0,1] $ parameterizes the strength of angular dependence, and $ \\theta_{ij} \\in [0,\\pi] $ is the misorientation angle between grains $ i $ and $ j $. All quantities are to be treated as nondimensional, and angles must be in radians.\n\nStarting from the calculus of variations applied to the functional $ F $, and using only fundamental definitions (e.g., the definition of a functional derivative and standard differentiation rules), derive the local contribution of the interaction term $ \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 $ to the variational derivatives $ \\delta F / \\delta \\eta_i $ and $ \\delta F / \\delta \\eta_j $ at a point where $ \\eta_i $ and $ \\eta_j $ are non-spatially varying scalars. Explain clearly how the misorientation dependence $ \\gamma_{ij} = \\gamma_0\\,[1-\\alpha\\cos(\\theta_{ij})] $ enters these derivatives.\n\nThen, implement a program that computes, for a given set of parameters $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) $, the following four quantities at a point:\n- $ \\gamma_{ij} $,\n- the local interaction energy density $ f_{\\mathrm{int}} = \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 $,\n- the interaction-term contribution to the variational derivative with respect to $ \\eta_i $, i.e., $ \\left(\\delta F / \\delta \\eta_i\\right)_{\\mathrm{int}} $,\n- the interaction-term contribution to the variational derivative with respect to $ \\eta_j $, i.e., $ \\left(\\delta F / \\delta \\eta_j\\right)_{\\mathrm{int}} $.\n\nYour implementation must treat all quantities as nondimensional. Angles must be interpreted in radians. The program must evaluate these four quantities for each of the following test cases, which together constitute the test suite:\n- Case $ 1 $ (general): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,\\pi/3,\\,1.0,\\,0.5) $.\n- Case $ 2 $ (boundary angle $ \\theta_{ij}=0 $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,0,\\,1.0,\\,0.5) $.\n- Case $ 3 $ (boundary angle $ \\theta_{ij}=\\pi $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,\\pi,\\,1.0,\\,0.5) $.\n- Case $ 4 $ (no angular dependence $ \\alpha=0 $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,\\pi/4,\\,1.0,\\,0.0) $.\n- Case $ 5 $ (vanishing interaction due to $ \\eta_j=0 $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.0,\\,\\pi/3,\\,1.0,\\,0.5) $.\n- Case $ 6 $ (maximal dependence $ \\alpha=1 $ at $ \\theta_{ij}=0 $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,0,\\,1.0,\\,1.0) $.\n\nThe required final output format is a single line containing a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of four nondimensional floats in the order $ [\\gamma_{ij},\\,f_{\\mathrm{int}},\\,(\\delta F/\\delta \\eta_i)_{\\mathrm{int}},\\,(\\delta F/\\delta \\eta_j)_{\\mathrm{int}}] $. For example, the line must look like $ [[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],\\dots] $ with no additional text. Angles must be treated in radians, and all outputs must be nondimensional floats.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary data and definitions for deriving the requested quantities and implementing the computations are provided. The problem is a standard exercise in the calculus of variations as applied to phase-field models, a core topic in computational materials science and multiscale modeling.\n\nThe derivation proceeds as follows.\n\nThe total free energy functional $F[\\{\\eta_i\\}]$ is given by the volume integral of a free energy density, $f$:\n$$\nF[\\{\\eta_i\\}] \\;=\\; \\int_{\\Omega} f(\\{\\eta_k\\}, \\{\\nabla \\eta_k\\}) \\, dV\n$$\nwhere the free energy density $f$ is:\n$$\nf \\;=\\; \\sum_k \\left[ W\\,\\eta_k^2(1-\\eta_k)^2 \\;+\\; \\kappa\\,|\\nabla \\eta_k|^2 \\right] \\;+\\; \\sum_{kl} \\gamma_{kl}\\,\\eta_k^2\\,\\eta_l^2\n$$\nThe problem concerns the local contribution of a single pairwise interaction term, which we can denote as $f_{\\mathrm{int}, ij} = \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2$. This term is part of the sum $\\sum_{kl} \\gamma_{kl}\\,\\eta_k^2\\,\\eta_l^2$.\n\nThe variational derivative of the functional $F$ with respect to a field $\\eta_i$ is defined by the Euler-Lagrange equation:\n$$\n\\frac{\\delta F}{\\delta \\eta_i} \\;=\\; \\frac{\\partial f}{\\partial \\eta_i} - \\nabla \\cdot \\left( \\frac{\\partial f}{\\partial (\\nabla \\eta_i)} \\right)\n$$\nThe problem specifies that we are to find the \"local contribution\" at a point where the fields $\\eta_i$ and $\\eta_j$ are \"non-spatially varying scalars\". This simplification implies that all spatial derivatives, such as $\\nabla \\eta_i$, are zero. Consequently, the divergence term $\\nabla \\cdot (\\dots)$ in the Euler-Lagrange equation vanishes. The local contribution to the variational derivative is thus reduced to the partial derivative of the relevant term in the free energy density $f$.\n\nWe are tasked with finding the contribution of the specific interaction term $f_{\\mathrm{int}, ij} = \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2$ to the variational derivatives with respect to $\\eta_i$ and $\\eta_j$. Let's denote these contributions as $(\\delta F / \\delta \\eta_i)_{\\mathrm{int}}$ and $(\\delta F / \\delta \\eta_j)_{\\mathrm{int}}$.\n\nTo find the contribution to the derivative with respect to $\\eta_i$, we compute the partial derivative of $f_{\\mathrm{int}, ij}$ with respect to $\\eta_i$, treating all other variables ($\\eta_j$, $\\gamma_{ij}$) as independent of $\\eta_i$.\n$$\n\\left(\\frac{\\delta F}{\\delta \\eta_i}\\right)_{\\mathrm{int}} \\;=\\; \\frac{\\partial}{\\partial \\eta_i} (f_{\\mathrm{int}, ij}) \\;=\\; \\frac{\\partial}{\\partial \\eta_i} \\left( \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 \\right)\n$$\nUsing the power rule for differentiation, we get:\n$$\n\\left(\\frac{\\delta F}{\\delta \\eta_i}\\right)_{\\mathrm{int}} \\;=\\; \\gamma_{ij}\\,(2\\eta_i)\\,\\eta_j^2 \\;=\\; 2\\,\\gamma_{ij}\\,\\eta_i\\,\\eta_j^2\n$$\nSimilarly, to find the contribution to the derivative with respect to $\\eta_j$, we compute the partial derivative of $f_{\\mathrm{int}, ij}$ with respect to $\\eta_j$, treating $\\eta_i$ and $\\gamma_{ij}$ as independent of $\\eta_j$.\n$$\n\\left(\\frac{\\delta F}{\\delta \\eta_j}\\right)_{\\mathrm{int}} \\;=\\; \\frac{\\partial}{\\partial \\eta_j} (f_{\\mathrm{int}, ij}) \\;=\\; \\frac{\\partial}{\\partial \\eta_j} \\left( \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 \\right)\n$$\nThis gives:\n$$\n\\left(\\frac{\\delta F}{\\delta \\eta_j}\\right)_{\\mathrm{int}} \\;=\\; \\gamma_{ij}\\,\\eta_i^2\\,(2\\eta_j) \\;=\\; 2\\,\\gamma_{ij}\\,\\eta_i^2\\,\\eta_j\n$$\nThe problem also defines the misorientation-dependent interaction energy coefficient $\\gamma_{ij}$ as:\n$$\n\\gamma_{ij} \\;=\\; \\gamma_0 \\left[ 1 \\;-\\; \\alpha \\,\\cos\\!\\left(\\theta_{ij}\\right) \\right]\n$$\nThis expression shows how the misorientation angle $\\theta_{ij}$ and the anisotropy parameter $\\alpha$ determine the value of $\\gamma_{ij}$. This value then directly scales the local interaction energy density $f_{\\mathrm{int}, ij}$ and, consequently, its derivatives with respect to the order parameters. A change in $\\theta_{ij}$ or $\\alpha$ alters $\\gamma_{ij}$, which in turn linearly modifies the magnitude of the interaction penalty and the resulting thermodynamic forces driving the system's evolution.\n\nIn summary, for a given set of parameters $(\\eta_i, \\eta_j, \\theta_{ij}, \\gamma_0, \\alpha)$, the four quantities to be computed are:\n1.  The interaction energy coefficient: $\\gamma_{ij} = \\gamma_0 \\left[ 1 - \\alpha \\cos(\\theta_{ij}) \\right]$\n2.  The local interaction energy density: $f_{\\mathrm{int}} = \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2$\n3.  The interaction contribution to the variational derivative w.r.t. $\\eta_i$: $(\\delta F / \\delta \\eta_i)_{\\mathrm{int}} = 2\\,\\gamma_{ij}\\,\\eta_i\\,\\eta_j^2$\n4.  The interaction contribution to the variational derivative w.r.t. $\\eta_j$: $(\\delta F / \\delta \\eta_j)_{\\mathrm{int}} = 2\\,\\gamma_{ij}\\,\\eta_i^2\\,\\eta_j$\n\nThese are the formulae to be implemented in the program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes grain boundary interaction quantities for a set of test cases\n    based on a multi-phase-field model.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': np.pi/3, 'gamma_0': 1.0, 'alpha': 0.5},\n        # Case 2 (boundary angle theta_ij=0)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': 0, 'gamma_0': 1.0, 'alpha': 0.5},\n        # Case 3 (boundary angle theta_ij=pi)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': np.pi, 'gamma_0': 1.0, 'alpha': 0.5},\n        # Case 4 (no angular dependence alpha=0)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': np.pi/4, 'gamma_0': 1.0, 'alpha': 0.0},\n        # Case 5 (vanishing interaction due to eta_j=0)\n        {'eta_i': 0.6, 'eta_j': 0.0, 'theta_ij': np.pi/3, 'gamma_0': 1.0, 'alpha': 0.5},\n        # Case 6 (maximal dependence alpha=1 at theta_ij=0)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': 0, 'gamma_0': 1.0, 'alpha': 1.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        eta_i = case['eta_i']\n        eta_j = case['eta_j']\n        theta_ij = case['theta_ij']\n        gamma_0 = case['gamma_0']\n        alpha = case['alpha']\n\n        # 1. Calculate the interaction energy coefficient gamma_ij\n        gamma_ij = gamma_0 * (1 - alpha * np.cos(theta_ij))\n\n        # 2. Calculate the local interaction energy density f_int\n        f_int = gamma_ij * eta_i**2 * eta_j**2\n\n        # 3. Calculate the interaction-term contribution to the variational derivative w.r.t. eta_i\n        dF_deta_i_int = 2 * gamma_ij * eta_i * eta_j**2\n\n        # 4. Calculate the interaction-term contribution to the variational derivative w.r.t. eta_j\n        dF_deta_j_int = 2 * gamma_ij * eta_i**2 * eta_j\n\n        results.append([gamma_ij, f_int, dF_deta_i_int, dF_deta_j_int])\n\n    # Format the output string to match the required format precisely, with no spaces in the lists.\n    # e.g., [[x1,y1,z1,w1],[x2,y2,z2,w2],...]\n    formatted_case_results = []\n    for res_list in results:\n        # Create a string for each inner list like \"[v1,v2,v3,v4]\"\n        inner_list_str = f\"[{','.join(map(str, res_list))}]\"\n        formatted_case_results.append(inner_list_str)\n\n    # Join all case strings with commas and enclose in the outermost brackets\n    final_output_string = f\"[{','.join(formatted_case_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}