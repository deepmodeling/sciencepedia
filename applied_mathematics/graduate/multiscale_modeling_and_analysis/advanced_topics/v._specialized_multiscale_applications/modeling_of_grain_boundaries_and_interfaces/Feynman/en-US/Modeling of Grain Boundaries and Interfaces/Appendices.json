{
    "hands_on_practices": [
        {
            "introduction": "The starting point for any quantitative model of a grain boundary is a precise mathematical description of the misorientation between the adjacent crystal lattices. This exercise will guide you through the derivation of the fundamental tools used to represent these crystallographic rotations. By deriving the rotation matrix from first principles and using it to find the misorientation angle, you will gain a deeper command of the kinematic language essential for describing and modeling grain boundary geometry .",
            "id": "3781543",
            "problem": "In three-dimensional crystal kinematics, a rigid rotation is represented by a matrix in the Special Orthogonal group ($SO(3)$), i.e., real orthogonal matrices with determinant equal to $+1$. Consider a unit axis $\\hat{n} \\in \\mathbb{R}^{3}$ and an angle $\\theta \\in \\mathbb{R}$. An orientation of a grain relative to a fixed sample frame is represented by a matrix $R \\in \\mathrm{SO}(3)$, and the orientation of a grain boundary is characterized by the misorientation between two grains with orientations $R_{1}$ and $R_{2}$.\n\n1) Starting only from the facts that (i) a rigid rotation preserves the Euclidean inner product, (ii) the infinitesimal generator of a rotation about axis $\\hat{n}$ is a real skew-symmetric matrix $[\\hat{n}]_{\\times}$ satisfying $[\\hat{n}]_{\\times}\\, \\mathbf{v} = \\hat{n} \\times \\mathbf{v}$ for any $\\mathbf{v} \\in \\mathbb{R}^{3}$, and (iii) a finite rotation by angle $\\theta$ about $\\hat{n}$ is obtained by the matrix exponential of $\\theta[\\hat{n}]_{\\times}$, derive a closed-form expression for the rotation matrix $R(\\hat{n},\\theta)$ in terms of $\\hat{n}$ and $\\theta$.\n\n2) Define the misorientation operator $M$ mapping the crystal frame of grain $1$ to that of grain $2$ in the sample frame, and express $M$ in terms of $R_{1}$ and $R_{2}$, assuming both are in $\\mathrm{SO}(3)$. Then, using only invariants of $M$ under change of basis, derive an expression for the misorientation angle $\\theta_{\\mathrm{mis}}$ in terms of $M$.\n\n3) Consider a bicrystal in which grain $1$ has orientation $R_{1} = I$ (the $3 \\times 3$ identity) and grain $2$ has orientation $R_{2} = R(\\hat{n},\\theta)$ with $\\hat{n} = \\frac{1}{\\sqrt{3}}(1,1,1)^{\\top}$ and $\\theta = \\frac{\\pi}{3}$. Using your results from parts (1) and (2), compute the misorientation angle $\\theta_{\\mathrm{mis}}$ for this bicrystal. Provide the exact value in radians.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. The provided information is sufficient and consistent for deriving a unique solution.\n\n### Part 1: Derivation of the Rotation Matrix\n\nWe are asked to derive a closed-form expression for the rotation matrix $R(\\hat{n},\\theta)$ starting from its definition as the matrix exponential of an infinitesimal generator.\nThe infinitesimal generator of a rotation about a unit axis $\\hat{n} \\in \\mathbb{R}^3$ is the skew-symmetric matrix $[\\hat{n}]_{\\times}$ whose action on a vector $\\mathbf{v} \\in \\mathbb{R}^3$ is given by the cross product: $[\\hat{n}]_{\\times} \\mathbf{v} = \\hat{n} \\times \\mathbf{v}$.\nA finite rotation by an angle $\\theta$ about $\\hat{n}$ is given by\n$$\nR(\\hat{n},\\theta) = \\exp(\\theta [\\hat{n}]_{\\times})\n$$\nTo find a closed-form expression, we use the Taylor series expansion of the matrix exponential. Let $K = [\\hat{n}]_{\\times}$.\n$$\nR(\\hat{n},\\theta) = \\exp(\\theta K) = \\sum_{k=0}^{\\infty} \\frac{(\\theta K)^k}{k!} = I + \\theta K + \\frac{\\theta^2}{2!} K^2 + \\frac{\\theta^3}{3!} K^3 + \\dots\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix. We need to find a recurrence relation for the powers of $K$.\nThe action of $K^2$ on a vector $\\mathbf{v}$ is:\n$$\nK^2 \\mathbf{v} = [\\hat{n}]_{\\times}([\\hat{n}]_{\\times} \\mathbf{v}) = \\hat{n} \\times (\\hat{n} \\times \\mathbf{v})\n$$\nUsing the vector triple product identity $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = (\\mathbf{a} \\cdot \\mathbf{c})\\mathbf{b} - (\\mathbf{a} \\cdot \\mathbf{b})\\mathbf{c}$, we have:\n$$\nK^2 \\mathbf{v} = (\\hat{n} \\cdot \\mathbf{v})\\hat{n} - (\\hat{n} \\cdot \\hat{n})\\mathbf{v}\n$$\nSince $\\hat{n}$ is a unit vector, $\\hat{n} \\cdot \\hat{n} = \\|\\hat{n}\\|^2 = 1$. The term $(\\hat{n} \\cdot \\mathbf{v})\\hat{n}$ can be written in matrix form as $(\\hat{n} \\otimes \\hat{n})\\mathbf{v}$, where $\\hat{n} \\otimes \\hat{n} = \\hat{n}\\hat{n}^{\\top}$ is the outer product.\n$$\nK^2 \\mathbf{v} = (\\hat{n} \\otimes \\hat{n})\\mathbf{v} - I\\mathbf{v} = (\\hat{n}\\hat{n}^{\\top} - I)\\mathbf{v}\n$$\nSince this holds for any $\\mathbf{v}$, the matrix $K^2$ is given by:\n$$\nK^2 = \\hat{n}\\hat{n}^{\\top} - I\n$$\nNow, we compute $K^3$:\n$$\nK^3 = K \\cdot K^2 = [\\hat{n}]_{\\times}(\\hat{n}\\hat{n}^{\\top} - I) = [\\hat{n}]_{\\times}(\\hat{n}\\hat{n}^{\\top}) - [\\hat{n}]_{\\times}\n$$\nThe action of the first term on a vector $\\mathbf{v}$ is $[\\hat{n}]_{\\times}(\\hat{n}\\hat{n}^{\\top}\\mathbf{v}) = \\hat{n} \\times ((\\hat{n}\\cdot\\mathbf{v})\\hat{n})$. Since the cross product of a vector with itself is zero ($\\hat{n} \\times \\hat{n} = \\mathbf{0}$), this term is the zero matrix. Thus,\n$$\nK^3 = -[\\hat{n}]_{\\times} = -K\n$$\nThis establishes a simple recurrence for the powers of $K$: $K^4 = -K^2$, $K^5 = K$, and so on. We can now substitute this into the Taylor series:\n$$\n\\exp(\\theta K) = I + \\theta K + \\frac{\\theta^2}{2!} K^2 - \\frac{\\theta^3}{3!} K - \\frac{\\theta^4}{4!} K^2 + \\frac{\\theta^5}{5!} K + \\dots\n$$\nGrouping terms by the matrices $I$, $K$, and $K^2$:\n$$\n\\exp(\\theta K) = I + \\left(\\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - \\dots\\right)K + \\left(\\frac{\\theta^2}{2!} - \\frac{\\theta^4}{4!} + \\frac{\\theta^6}{6!} - \\dots\\right)K^2\n$$\nWe recognize the Taylor series for sine and cosine:\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - \\dots\n$$\n$$\n1 - \\cos(\\theta) = 1 - \\left(1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - \\dots\\right) = \\frac{\\theta^2}{2!} - \\frac{\\theta^4}{4!} + \\dots\n$$\nSubstituting these series into the expression for $\\exp(\\theta K)$ yields Rodrigues' rotation formula:\n$$\nR(\\hat{n},\\theta) = I + \\sin(\\theta)[\\hat{n}]_{\\times} + (1 - \\cos(\\theta))[\\hat{n}]_{\\times}^2\n$$\n\n### Part 2: Misorientation Angle\n\nThe orientation of grain $1$, $R_1 \\in \\mathrm{SO}(3)$, maps a vector from the crystal frame of grain $1$ ($\\mathbf{x}_{c1}$) to the sample frame ($\\mathbf{x}_s$): $\\mathbf{x}_s = R_1 \\mathbf{x}_{c1}$.\nSimilarly, for grain $2$: $\\mathbf{x}_s = R_2 \\mathbf{x}_{c2}$.\nThe misorientation operator $M$ maps the crystal frame of grain $1$ to that of grain $2$, meaning $\\mathbf{x}_{c2} = M\\mathbf{x}_{c1}$.\nBy equating the expressions for $\\mathbf{x}_s$, we have $R_1 \\mathbf{x}_{c1} = R_2 \\mathbf{x}_{c2}$. Substituting the expression for $\\mathbf{x}_{c2}$:\n$$\nR_1 \\mathbf{x}_{c1} = R_2 (M \\mathbf{x}_{c1}) = (R_2 M) \\mathbf{x}_{c1}\n$$\nThis equation must hold for all vectors $\\mathbf{x}_{c1}$, which implies $R_1 = R_2 M$. We can solve for $M$ by left-multiplying by $R_2^{-1}$. Since $R_2 \\in \\mathrm{SO}(3)$, its inverse is its transpose, $R_2^{-1} = R_2^{\\top}$.\n$$\nM = R_2^{-1} R_1 = R_2^{\\top} R_1\n$$\nAs the product of two matrices in $\\mathrm{SO}(3)$, $M$ is also a rotation matrix in $\\mathrm{SO}(3)$. Thus, it can be represented by a misorientation axis $\\hat{n}_{\\mathrm{mis}}$ and a misorientation angle $\\theta_{\\mathrm{mis}}$.\n\nTo find an expression for $\\theta_{\\mathrm{mis}}$ using invariants of $M$, we consider the trace of $M$, which is invariant under any change of basis ($ \\mathrm{tr}(P^{-1}MP) = \\mathrm{tr}(M) $). We relate the trace of a general rotation matrix $R(\\hat{n},\\theta)$ to its angle $\\theta$. Using the result from Part 1:\n$$\n\\mathrm{tr}(R(\\hat{n},\\theta)) = \\mathrm{tr}(I + \\sin(\\theta)[\\hat{n}]_{\\times} + (1 - \\cos(\\theta))[\\hat{n}]_{\\times}^2)\n$$\nUsing the linearity of the trace operator:\n$$\n\\mathrm{tr}(R) = \\mathrm{tr}(I) + \\sin(\\theta)\\mathrm{tr}([\\hat{n}]_{\\times}) + (1 - \\cos(\\theta))\\mathrm{tr}([\\hat{n}]_{\\times}^2)\n$$\nThe trace of the identity matrix in $3$ dimensions is $\\mathrm{tr}(I) = 3$. The trace of any skew-symmetric matrix, such as $[\\hat{n}]_{\\times}$, is zero. For the trace of $[\\hat{n}]_{\\times}^2$, we use $K^2 = \\hat{n}\\hat{n}^{\\top} - I$:\n$$\n\\mathrm{tr}([\\hat{n}]_{\\times}^2) = \\mathrm{tr}(\\hat{n}\\hat{n}^{\\top} - I) = \\mathrm{tr}(\\hat{n}\\hat{n}^{\\top}) - \\mathrm{tr}(I)\n$$\nThe trace of the outer product $\\hat{n}\\hat{n}^{\\top}$ is $\\mathrm{tr}(\\hat{n}\\hat{n}^{\\top}) = \\hat{n}^{\\top}\\hat{n} = \\|\\hat{n}\\|^2 = 1$.\nSo, $\\mathrm{tr}([\\hat{n}]_{\\times}^2) = 1 - 3 = -2$.\nSubstituting these values back into the trace expression for $R$:\n$$\n\\mathrm{tr}(R) = 3 + \\sin(\\theta)(0) + (1 - \\cos(\\theta))(-2) = 3 - 2 + 2\\cos(\\theta) = 1 + 2\\cos(\\theta)\n$$\nApplying this general result to the misorientation matrix $M$:\n$$\n\\mathrm{tr}(M) = 1 + 2\\cos(\\theta_{\\mathrm{mis}})\n$$\nSolving for $\\theta_{\\mathrm{mis}}$:\n$$\n\\cos(\\theta_{\\mathrm{mis}}) = \\frac{\\mathrm{tr}(M) - 1}{2}\n$$\nBy convention, the misorientation angle is the minimum positive angle required for the transformation, which lies in the interval $[0, \\pi]$. The arccosine function returns a value in this range.\n$$\n\\theta_{\\mathrm{mis}} = \\arccos\\left(\\frac{\\mathrm{tr}(M) - 1}{2}\\right)\n$$\n\n### Part 3: Calculation for a Specific Bicrystal\n\nWe are given a bicrystal with grain orientations:\n$R_1 = I$\n$R_2 = R(\\hat{n},\\theta)$ where $\\hat{n} = \\frac{1}{\\sqrt{3}}(1,1,1)^{\\top}$ and $\\theta = \\frac{\\pi}{3}$.\n\nUsing the result from Part 2, the misorientation matrix $M$ is:\n$$\nM = R_2^{\\top} R_1 = (R(\\hat{n},\\theta))^{\\top} I = (R(\\hat{n},\\theta))^{\\top}\n$$\nThe transpose of a rotation matrix $R(\\hat{n},\\theta)$ is equivalent to a rotation about the same axis by the negative of the angle, i.e., $R(\\hat{n},-\\theta)$.\n$$\nM = R(\\hat{n},-\\theta)\n$$\nWe need to find the misorientation angle $\\theta_{\\mathrm{mis}}$ corresponding to the rotation matrix $M$. We can use the trace formula derived in Part 2:\n$$\n\\theta_{\\mathrm{mis}} = \\arccos\\left(\\frac{\\mathrm{tr}(M) - 1}{2}\\right)\n$$\nLet's first compute the trace of $M$.\n$$\n\\mathrm{tr}(M) = \\mathrm{tr}(R(\\hat{n},-\\theta))\n$$\nUsing the general formula $\\mathrm{tr}(R) = 1 + 2\\cos(\\theta_{\\text{rot}})$ with the rotation angle $\\theta_{\\text{rot}} = -\\theta$:\n$$\n\\mathrm{tr}(M) = 1 + 2\\cos(-\\theta) = 1 + 2\\cos(\\theta)\n$$\nNow, we substitute this into the expression for $\\theta_{\\mathrm{mis}}$:\n$$\n\\theta_{\\mathrm{mis}} = \\arccos\\left(\\frac{(1 + 2\\cos(\\theta)) - 1}{2}\\right) = \\arccos\\left(\\frac{2\\cos(\\theta)}{2}\\right) = \\arccos(\\cos(\\theta))\n$$\nWe are given $\\theta = \\frac{\\pi}{3}$.\n$$\n\\theta_{\\mathrm{mis}} = \\arccos\\left(\\cos\\left(\\frac{\\pi}{3}\\right)\\right)\n$$\nThe range of the arccosine function is $[0, \\pi]$. Since $\\frac{\\pi}{3}$ lies within this range, $\\arccos(\\cos(\\frac{\\pi}{3}))$ evaluates directly to $\\frac{\\pi}{3}$.\nTherefore, the misorientation angle is:\n$$\n\\theta_{\\mathrm{mis}} = \\frac{\\pi}{3} \\text{ radians}\n$$\nIn this specific case where one grain is aligned with the sample frame ($R_1 = I$), the misorientation is simply the rotation that defines the second grain's orientation. The misorientation angle is the angle of that rotation, provided it is taken as the smallest positive angle.",
            "answer": "$$\\boxed{\\frac{\\pi}{3}}$$"
        },
        {
            "introduction": "The physical properties of grain boundaries, most notably their energy, are often anisotropic, meaning they depend on the boundary's crystallographic orientation. This practice explores how anisotropic line energy causes the angles at a triple junction to deviate from the simple isotropic $120^{\\circ}$ configuration. Mastering this connection between fundamental thermodynamics and observable microstructural features is crucial for predicting equilibrium grain shapes .",
            "id": "3781515",
            "problem": "In two-dimensional (2D) equilibrium, three interfaces meeting at a triple junction obey the generalized vector force balance that accounts for interfacial energy anisotropy. Consider three interfaces with anisotropic line energy per unit length given by $\\gamma(\\alpha) = \\gamma_{0}\\big(1+\\epsilon \\cos(4\\alpha)\\big)$, where $\\alpha$ is the interface inclination measured from the $x$-axis, $\\gamma_{0}>0$ is a constant, and $0<\\epsilon\\ll 1$ is the fourfold anisotropy strength. Assume the junction configuration is symmetric about the $x$-axis, with interface orientations $\\alpha_{1}=0$, $\\alpha_{2}=\\theta$, $\\alpha_{3}=-\\theta$, and define the deviation from the isotropic equal-angle configuration by $\\delta \\equiv \\theta - 2\\pi/3$. \n\nStarting from the generalized equilibrium condition at a triple junction, which states that the sum of Cahn–Hoffman vectors $\\boldsymbol{\\xi}(\\alpha) = \\gamma(\\alpha)\\,\\mathbf{t}(\\alpha) + \\gamma'(\\alpha)\\,\\mathbf{n}(\\alpha)$ vanishes at the junction, where $\\mathbf{t}(\\alpha)=(\\cos\\alpha,\\sin\\alpha)$ and $\\mathbf{n}(\\alpha)=(-\\sin\\alpha,\\cos\\alpha)$, and $\\gamma'(\\alpha)=\\mathrm{d}\\gamma/\\mathrm{d}\\alpha$, answer the following:\n\n1. Determine, from first principles, the condition under which the triple junction deviates from the isotropic equal-angle configuration $120^{\\circ}$. Your answer should be stated in terms of the anisotropy and its angular derivative evaluated at the interface orientations, and you should also state the stability requirement on the surface stiffness $\\tilde{\\gamma}(\\alpha) \\equiv \\gamma(\\alpha)+\\gamma''(\\alpha)$ that precludes missing orientations.\n\n2. Linearize the equilibrium condition to first order in $\\epsilon$ and $\\delta$ (neglecting terms of order $\\epsilon\\,\\delta$ and higher) to obtain a closed-form expression for $\\delta$ in terms of $\\epsilon$ and universal constants. \n\n3. Using your first-order result, evaluate the deviation $\\delta$ for $\\epsilon = 0.04$. Express the final deviation in radians and round your answer to $4$ significant figures.",
            "solution": "The problem asks for an analysis of a symmetric triple junction with anisotropic interface energy. The analysis proceeds in three parts: establishing the general equilibrium condition, linearizing it for small anisotropy, and calculating a specific deviation.\n\nThe fundamental equilibrium condition at a triple junction is that the vector sum of the Cahn–Hoffman vectors, $\\boldsymbol{\\xi}$, for each interface vanishes. The Cahn–Hoffman vector is defined as $\\boldsymbol{\\xi}(\\alpha) = \\gamma(\\alpha)\\,\\mathbf{t}(\\alpha) + \\gamma'(\\alpha)\\,\\mathbf{n}(\\alpha)$, where $\\gamma(\\alpha)$ is the orientation-dependent line energy, $\\gamma'(\\alpha) = \\mathrm{d}\\gamma/\\mathrm{d}\\alpha$, and $\\mathbf{t}(\\alpha)=(\\cos\\alpha,\\sin\\alpha)$ and $\\mathbf{n}(\\alpha)=(-\\sin\\alpha,\\cos\\alpha)$ are the tangential and normal unit vectors to the interface, respectively.\n\nThe components of the Cahn–Hoffman vector are:\n$\\xi_x(\\alpha) = \\gamma(\\alpha)\\cos\\alpha - \\gamma'(\\alpha)\\sin\\alpha$\n$\\xi_y(\\alpha) = \\gamma(\\alpha)\\sin\\alpha + \\gamma'(\\alpha)\\cos\\alpha$\n\nThe three interfaces have orientations $\\alpha_1=0$, $\\alpha_2=\\theta$, and $\\alpha_3=-\\theta$. The equilibrium condition is $\\boldsymbol{\\xi}(\\alpha_1) + \\boldsymbol{\\xi}(\\alpha_2) + \\boldsymbol{\\xi}(\\alpha_3) = \\mathbf{0}$. We analyze the sum of the components.\n\nFor the $y$-component: $\\sum_{i=1}^{3} \\xi_y(\\alpha_i) = \\xi_y(0) + \\xi_y(\\theta) + \\xi_y(-\\theta) = 0$.\n$\\xi_y(0) = \\gamma(0)\\sin(0) + \\gamma'(0)\\cos(0) = \\gamma'(0)$.\nThe line energy is given as $\\gamma(\\alpha) = \\gamma_{0}\\big(1+\\epsilon \\cos(4\\alpha)\\big)$, which is an even function of $\\alpha$. Its derivative, $\\gamma'(\\alpha) = -4\\gamma_0\\epsilon\\sin(4\\alpha)$, is an odd function. Therefore, $\\gamma'(0)=0$.\n$\\xi_y(\\theta) = \\gamma(\\theta)\\sin\\theta + \\gamma'(\\theta)\\cos\\theta$.\n$\\xi_y(-\\theta) = \\gamma(-\\theta)\\sin(-\\theta) + \\gamma'(-\\theta)\\cos(-\\theta)$. Since $\\gamma$ is even and $\\gamma'$ is odd, $\\gamma(-\\theta) = \\gamma(\\theta)$ and $\\gamma'(-\\theta) = -\\gamma'(\\theta)$.\n$\\xi_y(-\\theta) = \\gamma(\\theta)(-\\sin\\theta) - \\gamma'(\\theta)\\cos\\theta = -[\\gamma(\\theta)\\sin\\theta + \\gamma'(\\theta)\\cos\\theta] = -\\xi_y(\\theta)$.\nThe sum of the $y$-components is $\\gamma'(0) + \\xi_y(\\theta) - \\xi_y(\\theta) = 0$. This confirms that the $y$-component of the force balance is automatically satisfied by the specified symmetry of the junction configuration and the even form of $\\gamma(\\alpha)$.\n\nFor the $x$-component: $\\sum_{i=1}^{3} \\xi_x(\\alpha_i) = \\xi_x(0) + \\xi_x(\\theta) + \\xi_x(-\\theta) = 0$.\n$\\xi_x(0) = \\gamma(0)\\cos(0) - \\gamma'(0)\\sin(0) = \\gamma(0)$.\n$\\xi_x(\\theta) = \\gamma(\\theta)\\cos\\theta - \\gamma'(\\theta)\\sin\\theta$.\n$\\xi_x(-\\theta) = \\gamma(-\\theta)\\cos(-\\theta) - \\gamma'(-\\theta)\\sin(-\\theta) = \\gamma(\\theta)\\cos\\theta - (-\\gamma'(\\theta))(-\\sin\\theta) = \\gamma(\\theta)\\cos\\theta - \\gamma'(\\theta)\\sin\\theta$.\nThe sum of the $x$-components gives the non-trivial equilibrium condition:\n$$ \\gamma(0) + 2\\left[ \\gamma(\\theta)\\cos\\theta - \\gamma'(\\theta)\\sin\\theta \\right] = 0 $$\n\n**Part 1: Condition for Deviation and Stability**\n\nIn the isotropic case, $\\gamma(\\alpha)$ is a constant, so $\\gamma'(\\alpha)=0$. The equilibrium condition simplifies to $\\gamma + 2\\gamma\\cos\\theta = 0$, which gives $\\cos\\theta = -1/2$, so $\\theta = 2\\pi/3$ radians ($120^\\circ$). This is the equal-angle configuration.\nThe triple junction deviates from this isotropic configuration if $\\theta=2\\pi/3$ is not a solution to the anisotropic equilibrium equation. We test this by substituting $\\theta=2\\pi/3$ into the equation:\n$$ \\gamma(0) + 2\\left[ \\gamma(2\\pi/3)\\cos(2\\pi/3) - \\gamma'(2\\pi/3)\\sin(2\\pi/3) \\right] = 0 $$\n$$ \\gamma(0) + 2\\left[ \\gamma(2\\pi/3)(-\\frac{1}{2}) - \\gamma'(2\\pi/3)(\\frac{\\sqrt{3}}{2}) \\right] = 0 $$\n$$ \\gamma(0) - \\gamma(2\\pi/3) - \\sqrt{3}\\gamma'(2\\pi/3) = 0 $$\nTherefore, the triple junction angle $\\theta$ will deviate from the isotropic value $2\\pi/3$ if this condition is not met, i.e., if $\\gamma(0) - \\gamma(2\\pi/3) - \\sqrt{3}\\gamma'(2\\pi/3) \\neq 0$.\n\nThe stability requirement that precludes missing orientations in the equilibrium shape (as per the Wulff construction) is that the surface stiffness, $\\tilde{\\gamma}(\\alpha) \\equiv \\gamma(\\alpha) + \\gamma''(\\alpha)$, must be positive for all orientations $\\alpha$. If $\\tilde{\\gamma}(\\alpha) < 0$ for any range of $\\alpha$, those orientations are unstable and will not be observed. Thus, the condition is $\\tilde{\\gamma}(\\alpha) > 0$.\n\n**Part 2: Linearization and Expression for $\\delta$**\n\nWe are asked to find an expression for the deviation $\\delta \\equiv \\theta - 2\\pi/3$ by linearizing the equilibrium condition to first order in $\\epsilon$ and $\\delta$. We start from the equilibrium equation:\n$$ \\gamma(0) + 2\\left[ \\gamma(\\theta)\\cos\\theta - \\gamma'(\\theta)\\sin\\theta \\right] = 0 $$\nWe substitute $\\theta = 2\\pi/3 + \\delta$ and expand all terms, retaining only terms up to first order in $\\epsilon$ and $\\delta$, and neglecting products such as $\\epsilon\\delta$.\n\nThe energy function and its derivative are:\n$\\gamma(\\alpha) = \\gamma_0(1+\\epsilon\\cos(4\\alpha))$\n$\\gamma'(\\alpha) = -4\\gamma_0\\epsilon\\sin(4\\alpha)$\n\nFirst, we evaluate $\\gamma(0)$:\n$\\gamma(0) = \\gamma_0(1+\\epsilon\\cos(0)) = \\gamma_0(1+\\epsilon)$.\n\nNext, we expand the terms dependent on $\\theta$:\n$\\cos\\theta = \\cos(2\\pi/3+\\delta) = \\cos(2\\pi/3)\\cos\\delta - \\sin(2\\pi/3)\\sin\\delta \\approx (-1/2)(1) - (\\sqrt{3}/2)(\\delta) = -1/2 - \\frac{\\sqrt{3}}{2}\\delta$.\n$\\sin\\theta = \\sin(2\\pi/3+\\delta) = \\sin(2\\pi/3)\\cos\\delta + \\cos(2\\pi/3)\\sin\\delta \\approx (\\sqrt{3}/2)(1) + (-1/2)(\\delta) = \\frac{\\sqrt{3}}{2} - \\frac{1}{2}\\delta$.\n\nNow we expand $\\gamma(\\theta)$ and $\\gamma'(\\theta)$:\n$\\gamma(\\theta) = \\gamma_0(1+\\epsilon\\cos(4(2\\pi/3+\\delta))) = \\gamma_0(1+\\epsilon\\cos(8\\pi/3+4\\delta))$.\n$\\cos(8\\pi/3+4\\delta) = \\cos(2\\pi/3+4\\delta) \\approx \\cos(2\\pi/3) = -1/2$.\nSo, $\\gamma(\\theta) \\approx \\gamma_0(1 - \\epsilon/2)$.\n\n$\\gamma'(\\theta) = -4\\gamma_0\\epsilon\\sin(4(2\\pi/3+\\delta)) = -4\\gamma_0\\epsilon\\sin(8\\pi/3+4\\delta)$.\n$\\sin(8\\pi/3+4\\delta) = \\sin(2\\pi/3+4\\delta) \\approx \\sin(2\\pi/3) = \\sqrt{3}/2$.\nSo, $\\gamma'(\\theta) \\approx -4\\gamma_0\\epsilon(\\sqrt{3}/2) = -2\\sqrt{3}\\gamma_0\\epsilon$.\n\nNow we substitute these approximations into the term inside the brackets of the main equation:\n$\\gamma(\\theta)\\cos\\theta - \\gamma'(\\theta)\\sin\\theta \\approx \\gamma_0(1-\\epsilon/2)(-1/2 - \\frac{\\sqrt{3}}{2}\\delta) - (-2\\sqrt{3}\\gamma_0\\epsilon)(\\sqrt{3}/2 - \\frac{1}{2}\\delta)$.\nExpanding and keeping terms up to first order:\n$\\approx \\gamma_0(-1/2 - \\frac{\\sqrt{3}}{2}\\delta + \\epsilon/4) - \\gamma_0(-3\\epsilon)$. (We dropped $\\epsilon\\delta$ terms).\n$\\approx \\gamma_0(-1/2 - \\frac{\\sqrt{3}}{2}\\delta + \\epsilon/4 + 3\\epsilon) = \\gamma_0(-1/2 - \\frac{\\sqrt{3}}{2}\\delta + \\frac{13}{4}\\epsilon)$.\n\nFinally, substitute this back into the full equilibrium equation:\n$\\gamma_0(1+\\epsilon) + 2\\left[\\gamma_0(-1/2 - \\frac{\\sqrt{3}}{2}\\delta + \\frac{13}{4}\\epsilon)\\right] = 0$.\nDividing by $\\gamma_0$ (which is non-zero):\n$1+\\epsilon + 2(-1/2 - \\frac{\\sqrt{3}}{2}\\delta + \\frac{13}{4}\\epsilon) = 0$.\n$1+\\epsilon - 1 - \\sqrt{3}\\delta + \\frac{13}{2}\\epsilon = 0$.\n$-\\sqrt{3}\\delta + (1 + \\frac{13}{2})\\epsilon = 0$.\n$-\\sqrt{3}\\delta + \\frac{15}{2}\\epsilon = 0$.\nSolving for $\\delta$:\n$$ \\delta = \\frac{15}{2\\sqrt{3}}\\epsilon = \\frac{15\\sqrt{3}}{6}\\epsilon = \\frac{5\\sqrt{3}}{2}\\epsilon $$\nThis is the required closed-form expression for $\\delta$.\n\n**Part 3: Numerical Evaluation**\n\nUsing the first-order result from Part 2, we evaluate the deviation $\\delta$ for $\\epsilon = 0.04$.\n$$ \\delta = \\frac{5\\sqrt{3}}{2}(0.04) = 5\\sqrt{3}(0.02) = 0.1\\sqrt{3} $$\nNow, we calculate the numerical value of this expression. Using $\\sqrt{3} \\approx 1.7320508...$:\n$$ \\delta \\approx 0.1 \\times 1.7320508... = 0.17320508... $$\nThe problem requires rounding the answer to $4$ significant figures.\n$$ \\delta \\approx 0.1732 $$\nThe deviation is given in radians, which is the natural unit for angles in these derivations.\nThe stability condition requires the stiffness $\\tilde{\\gamma}(\\alpha) = \\gamma_0(1 - 15\\epsilon\\cos(4\\alpha))$ to be positive. This holds if $15\\epsilon  1$, i.e., $\\epsilon  1/15 \\approx 0.0667$. The value $\\epsilon=0.04$ satisfies this condition, confirming the physical validity of the setup.",
            "answer": "$$\\boxed{0.1732}$$"
        },
        {
            "introduction": "To simulate the complex evolution of polycrystalline microstructures, computational methods like the phase-field model are indispensable. A key task in developing such models is to correctly incorporate realistic, orientation-dependent grain boundary energies into the system's free energy functional. This exercise provides hands-on experience with the variational calculus at the heart of phase-field modeling, demonstrating how misorientation-dependent energy terms translate into the thermodynamic forces that drive grain boundary dynamics .",
            "id": "3781560",
            "problem": "Consider a multiphase-field representation of a polycrystal in which each grain is identified by a scalar order parameter $ \\eta_i \\in [0,1] $, where $ \\eta_i \\approx 1 $ inside grain $ i $ and $ \\eta_i \\approx 0 $ outside it. The total free energy functional is assumed to take the generic form\n$$\nF[\\{\\eta_i\\}] \\;=\\; \\int_{\\Omega} \\left( \\sum_i \\left[ W\\,\\eta_i^2(1-\\eta_i)^2 \\;+\\; \\kappa\\,|\\nabla \\eta_i|^2 \\right] \\;+\\; \\sum_{ij} \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 \\right)\\, dV,\n$$\nwhere $ W0 $ sets the height of the double-well potential, $ \\kappa0 $ is the gradient penalty coefficient, and $ \\gamma_{ij} $ is a grain boundary energy density coefficient that controls the interaction penalty between order parameters $ \\eta_i $ and $ \\eta_j $. The misorientation-dependent interaction energy is defined by\n$$\n\\gamma_{ij} \\;=\\; \\gamma_0 \\left[ 1 \\;-\\; \\alpha \\,\\cos\\left(\\theta_{ij}\\right) \\right],\n$$\nwhere $ \\gamma_00 $ is a reference energy density, $ \\alpha \\in [0,1] $ parameterizes the strength of angular dependence, and $ \\theta_{ij} \\in [0,\\pi] $ is the misorientation angle between grains $ i $ and $ j $. All quantities are to be treated as nondimensional, and angles must be in radians.\n\nStarting from the calculus of variations applied to the functional $ F $, and using only fundamental definitions (e.g., the definition of a functional derivative and standard differentiation rules), derive the local contribution of the interaction term $ \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 $ to the variational derivatives $ \\delta F / \\delta \\eta_i $ and $ \\delta F / \\delta \\eta_j $ at a point where $ \\eta_i $ and $ \\eta_j $ are non-spatially varying scalars. Explain clearly how the misorientation dependence $ \\gamma_{ij} = \\gamma_0\\,[1-\\alpha\\cos(\\theta_{ij})] $ enters these derivatives.\n\nThen, implement a program that computes, for a given set of parameters $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) $, the following four quantities at a point:\n- $ \\gamma_{ij} $,\n- the local interaction energy density $ f_{\\mathrm{int}} = \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 $,\n- the interaction-term contribution to the variational derivative with respect to $ \\eta_i $, i.e., $ (\\delta F / \\delta \\eta_i)_{\\mathrm{int}} $,\n- the interaction-term contribution to the variational derivative with respect to $ \\eta_j $, i.e., $ (\\delta F / \\delta \\eta_j)_{\\mathrm{int}} $.\n\nYour implementation must treat all quantities as nondimensional. Angles must be interpreted in radians. The program must evaluate these four quantities for each of the following test cases, which together constitute the test suite:\n- Case $ 1 $ (general): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,\\pi/3,\\,1.0,\\,0.5) $.\n- Case $ 2 $ (boundary angle $ \\theta_{ij}=0 $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,0,\\,1.0,\\,0.5) $.\n- Case $ 3 $ (boundary angle $ \\theta_{ij}=\\pi $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,\\pi,\\,1.0,\\,0.5) $.\n- Case $ 4 $ (no angular dependence $ \\alpha=0 $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,\\pi/4,\\,1.0,\\,0.0) $.\n- Case $ 5 $ (vanishing interaction due to $ \\eta_j=0 $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.0,\\,\\pi/3,\\,1.0,\\,0.5) $.\n- Case $ 6 $ (maximal dependence $ \\alpha=1 $ at $ \\theta_{ij}=0 $): $ (\\eta_i,\\eta_j,\\theta_{ij},\\gamma_0,\\alpha) = (0.6,\\,0.4,\\,0,\\,1.0,\\,1.0) $.\n\nThe required final output format is a single line containing a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of four nondimensional floats in the order $ [\\gamma_{ij},\\,f_{\\mathrm{int}},\\,(\\delta F/\\delta \\eta_i)_{\\mathrm{int}},\\,(\\delta F/\\delta \\eta_j)_{\\mathrm{int}}] $. For example, the line must look like `[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],...]` with no additional text. Angles must be treated in radians, and all outputs must be nondimensional floats.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary data and definitions for deriving the requested quantities and implementing the computations are provided. The problem is a standard exercise in the calculus of variations as applied to phase-field models, a core topic in computational materials science and multiscale modeling.\n\nThe derivation proceeds as follows.\n\nThe total free energy functional $F[\\{\\eta_i\\}]$ is given by the volume integral of a free energy density, $f$:\n$$\nF[\\{\\eta_i\\}] \\;=\\; \\int_{\\Omega} f(\\{\\eta_k\\}, \\{\\nabla \\eta_k\\}) \\, dV\n$$\nwhere the free energy density $f$ is:\n$$\nf \\;=\\; \\sum_k \\left[ W\\,\\eta_k^2(1-\\eta_k)^2 \\;+\\; \\kappa\\,|\\nabla \\eta_k|^2 \\right] \\;+\\; \\sum_{kl} \\gamma_{kl}\\,\\eta_k^2\\,\\eta_l^2\n$$\nThe problem concerns the local contribution of a single pairwise interaction term, which we can denote as $f_{\\mathrm{int}, ij} = \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2$. This term is part of the sum $\\sum_{kl} \\gamma_{kl}\\,\\eta_k^2\\,\\eta_l^2$.\n\nThe variational derivative of the functional $F$ with respect to a field $\\eta_i$ is defined by the Euler-Lagrange equation:\n$$\n\\frac{\\delta F}{\\delta \\eta_i} \\;=\\; \\frac{\\partial f}{\\partial \\eta_i} - \\nabla \\cdot \\left( \\frac{\\partial f}{\\partial (\\nabla \\eta_i)} \\right)\n$$\nThe problem specifies that we are to find the \"local contribution\" at a point where the fields $\\eta_i$ and $\\eta_j$ are \"non-spatially varying scalars\". This simplification implies that all spatial derivatives, such as $\\nabla \\eta_i$, are zero. Consequently, the divergence term $\\nabla \\cdot (\\dots)$ in the Euler-Lagrange equation vanishes. The local contribution to the variational derivative is thus reduced to the partial derivative of the relevant term in the free energy density $f$.\n\nWe are tasked with finding the contribution of the specific interaction term $f_{\\mathrm{int}, ij} = \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2$ to the variational derivatives with respect to $\\eta_i$ and $\\eta_j$. Let's denote these contributions as $(\\delta F / \\delta \\eta_i)_{\\mathrm{int}}$ and $(\\delta F / \\delta \\eta_j)_{\\mathrm{int}}$.\n\nTo find the contribution to the derivative with respect to $\\eta_i$, we compute the partial derivative of $f_{\\mathrm{int}, ij}$ with respect to $\\eta_i$, treating all other variables ($\\eta_j$, $\\gamma_{ij}$) as independent of $\\eta_i$.\n$$\n\\left(\\frac{\\delta F}{\\delta \\eta_i}\\right)_{\\mathrm{int}} \\;=\\; \\frac{\\partial}{\\partial \\eta_i} (f_{\\mathrm{int}, ij}) \\;=\\; \\frac{\\partial}{\\partial \\eta_i} \\left( \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 \\right)\n$$\nUsing the power rule for differentiation, we get:\n$$\n\\left(\\frac{\\delta F}{\\delta \\eta_i}\\right)_{\\mathrm{int}} \\;=\\; \\gamma_{ij}\\,(2\\eta_i)\\,\\eta_j^2 \\;=\\; 2\\,\\gamma_{ij}\\,\\eta_i\\,\\eta_j^2\n$$\nSimilarly, to find the contribution to the derivative with respect to $\\eta_j$, we compute the partial derivative of $f_{\\mathrm{int}, ij}$ with respect to $\\eta_j$, treating $\\eta_i$ and $\\gamma_{ij}$ as independent of $\\eta_j$.\n$$\n\\left(\\frac{\\delta F}{\\delta \\eta_j}\\right)_{\\mathrm{int}} \\;=\\; \\frac{\\partial}{\\partial \\eta_j} (f_{\\mathrm{int}, ij}) \\;=\\; \\frac{\\partial}{\\partial \\eta_j} \\left( \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2 \\right)\n$$\nThis gives:\n$$\n\\left(\\frac{\\delta F}{\\delta \\eta_j}\\right)_{\\mathrm{int}} \\;=\\; \\gamma_{ij}\\,\\eta_i^2\\,(2\\eta_j) \\;=\\; 2\\,\\gamma_{ij}\\,\\eta_i^2\\,\\eta_j\n$$\nThe problem also defines the misorientation-dependent interaction energy coefficient $\\gamma_{ij}$ as:\n$$\n\\gamma_{ij} \\;=\\; \\gamma_0 \\left[ 1 \\;-\\; \\alpha \\,\\cos\\!\\left(\\theta_{ij}\\right) \\right]\n$$\nThis expression shows how the misorientation angle $\\theta_{ij}$ and the anisotropy parameter $\\alpha$ determine the value of $\\gamma_{ij}$. This value then directly scales the local interaction energy density $f_{\\mathrm{int}, ij}$ and, consequently, its derivatives with respect to the order parameters. A change in $\\theta_{ij}$ or $\\alpha$ alters $\\gamma_{ij}$, which in turn linearly modifies the magnitude of the interaction penalty and the resulting thermodynamic forces driving the system's evolution.\n\nIn summary, for a given set of parameters $(\\eta_i, \\eta_j, \\theta_{ij}, \\gamma_0, \\alpha)$, the four quantities to be computed are:\n1.  The interaction energy coefficient: $\\gamma_{ij} = \\gamma_0 \\left[ 1 - \\alpha \\cos(\\theta_{ij}) \\right]$\n2.  The local interaction energy density: $f_{\\mathrm{int}} = \\gamma_{ij}\\,\\eta_i^2\\,\\eta_j^2$\n3.  The interaction contribution to the variational derivative w.r.t. $\\eta_i$: $(\\delta F / \\delta \\eta_i)_{\\mathrm{int}} = 2\\,\\gamma_{ij}\\,\\eta_i\\,\\eta_j^2$\n4.  The interaction contribution to the variational derivative w.r.t. $\\eta_j$: $(\\delta F / \\delta \\eta_j)_{\\mathrm{int}} = 2\\,\\gamma_{ij}\\,\\eta_i^2\\,\\eta_j$\n\nThese are the formulae to be implemented in the program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes grain boundary interaction quantities for a set of test cases\n    based on a multi-phase-field model.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': np.pi/3, 'gamma_0': 1.0, 'alpha': 0.5},\n        # Case 2 (boundary angle theta_ij=0)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': 0, 'gamma_0': 1.0, 'alpha': 0.5},\n        # Case 3 (boundary angle theta_ij=pi)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': np.pi, 'gamma_0': 1.0, 'alpha': 0.5},\n        # Case 4 (no angular dependence alpha=0)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': np.pi/4, 'gamma_0': 1.0, 'alpha': 0.0},\n        # Case 5 (vanishing interaction due to eta_j=0)\n        {'eta_i': 0.6, 'eta_j': 0.0, 'theta_ij': np.pi/3, 'gamma_0': 1.0, 'alpha': 0.5},\n        # Case 6 (maximal dependence alpha=1 at theta_ij=0)\n        {'eta_i': 0.6, 'eta_j': 0.4, 'theta_ij': 0, 'gamma_0': 1.0, 'alpha': 1.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        eta_i = case['eta_i']\n        eta_j = case['eta_j']\n        theta_ij = case['theta_ij']\n        gamma_0 = case['gamma_0']\n        alpha = case['alpha']\n\n        # 1. Calculate the interaction energy coefficient gamma_ij\n        gamma_ij = gamma_0 * (1 - alpha * np.cos(theta_ij))\n\n        # 2. Calculate the local interaction energy density f_int\n        f_int = gamma_ij * eta_i**2 * eta_j**2\n\n        # 3. Calculate the interaction-term contribution to the variational derivative w.r.t. eta_i\n        dF_deta_i_int = 2 * gamma_ij * eta_i * eta_j**2\n\n        # 4. Calculate the interaction-term contribution to the variational derivative w.r.t. eta_j\n        dF_deta_j_int = 2 * gamma_ij * eta_i**2 * eta_j\n\n        results.append([gamma_ij, f_int, dF_deta_i_int, dF_deta_j_int])\n\n    # Format the output string to match the required format precisely, with no spaces in the lists.\n    # e.g., [[x1,y1,z1,w1],[x2,y2,z2,w2],...]\n    formatted_case_results = []\n    for res_list in results:\n        # Create a string for each inner list like \"[v1,v2,v3,v4]\"\n        inner_list_str = f\"[{','.join(map(str, res_list))}]\"\n        formatted_case_results.append(inner_list_str)\n\n    # Join all case strings with commas and enclose in the outermost brackets\n    final_output_string = f\"[{','.join(formatted_case_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}